{"sha": "8f1b829ed295b4b834cd8fde9f3aa84932b86942", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OGYxYjgyOWVkMjk1YjRiODM0Y2Q4ZmRlOWYzYWE4NDkzMmI4Njk0Mg==", "commit": {"author": {"name": "Daniel Jacobowitz", "email": "drow@false.org", "date": "1999-08-05T07:17:35Z"}, "committer": {"name": "Jeff Law", "email": "law@gcc.gnu.org", "date": "1999-08-05T07:17:35Z"}, "message": "rs6000.c (current_file_function_operand): Return zero for weak functions.\n\n\n        * rs6000.c (current_file_function_operand): Return zero for\n        weak functions.\n        (rs6000_encode_section_info): Do not set SYMBOL_REF_FLAG for\n        weak symbols.\n        * rs6000.h (ENCODE_SECTION_NIFO): Do not set SYMBOL_REF_FLAG\n        for weak symbols.\n\nFrom-SVN: r28527", "tree": {"sha": "cab50d4a841c3716129a7bbe0fa64f03dd0fc598", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/cab50d4a841c3716129a7bbe0fa64f03dd0fc598"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8f1b829ed295b4b834cd8fde9f3aa84932b86942", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8f1b829ed295b4b834cd8fde9f3aa84932b86942", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8f1b829ed295b4b834cd8fde9f3aa84932b86942", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8f1b829ed295b4b834cd8fde9f3aa84932b86942/comments", "author": null, "committer": null, "parents": [{"sha": "906fb125a14fba63516ed295b779546f1ea6e631", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/906fb125a14fba63516ed295b779546f1ea6e631", "html_url": "https://github.com/Rust-GCC/gccrs/commit/906fb125a14fba63516ed295b779546f1ea6e631"}], "stats": {"total": 22, "additions": 17, "deletions": 5}, "files": [{"sha": "94bd0c9dc98ce2e0ec5adeb9bb90ac6084a338df", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8f1b829ed295b4b834cd8fde9f3aa84932b86942/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8f1b829ed295b4b834cd8fde9f3aa84932b86942/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=8f1b829ed295b4b834cd8fde9f3aa84932b86942", "patch": "@@ -1,3 +1,12 @@\n+Thu Aug  5 01:14:13 1999  Daniel Jacobowitz <drow@false.org>\n+\n+\t* rs6000.c (current_file_function_operand): Return zero for\n+\tweak functions.\n+\t(rs6000_encode_section_info): Do not set SYMBOL_REF_FLAG for\n+\tweak symbols.\n+\t* rs6000.h (ENCODE_SECTION_NIFO): Do not set SYMBOL_REF_FLAG\n+\tfor weak symbols.\n+\n Thu Aug  5 00:56:30 1999  Geoffrey Keating   <geoffk@cygnus.com>\n \n \t* rs6000.c (rs6000_stack_info): For ABI_V4/ABI_SOLARIS -fpic, always"}, {"sha": "b3b6fa21015dafab4db65ee568b9aa5f86a0833b", "filename": "gcc/config/rs6000/rs6000.c", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8f1b829ed295b4b834cd8fde9f3aa84932b86942/gcc%2Fconfig%2Frs6000%2Frs6000.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8f1b829ed295b4b834cd8fde9f3aa84932b86942/gcc%2Fconfig%2Frs6000%2Frs6000.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.c?ref=8f1b829ed295b4b834cd8fde9f3aa84932b86942", "patch": "@@ -1117,7 +1117,7 @@ call_operand (op, mode)\n \n \n /* Return 1 if the operand is a SYMBOL_REF for a function known to be in\n-   this file.  */\n+   this file and the function is not weakly defined. */\n \n int\n current_file_function_operand (op, mode)\n@@ -1126,7 +1126,8 @@ current_file_function_operand (op, mode)\n {\n   return (GET_CODE (op) == SYMBOL_REF\n \t  && (SYMBOL_REF_FLAG (op)\n-\t      || op == XEXP (DECL_RTL (current_function_decl), 0)));\n+\t      || (op == XEXP (DECL_RTL (current_function_decl), 0)\n+\t          && !DECL_WEAK (current_function_decl))));\n }\n \n \n@@ -5900,7 +5901,8 @@ rs6000_encode_section_info (decl)\n   if (TREE_CODE (decl) == FUNCTION_DECL)\n     {\n       rtx sym_ref = XEXP (DECL_RTL (decl), 0);\n-      if (TREE_ASM_WRITTEN (decl) || ! TREE_PUBLIC (decl))\n+      if ((TREE_ASM_WRITTEN (decl) || ! TREE_PUBLIC (decl))\n+          && !DECL_WEAK (decl))\n \tSYMBOL_REF_FLAG (sym_ref) = 1;\n \n       if (DEFAULT_ABI == ABI_AIX || DEFAULT_ABI == ABI_NT)"}, {"sha": "3a86ec194e60123424ec1da184da179c621ea3b2", "filename": "gcc/config/rs6000/rs6000.h", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8f1b829ed295b4b834cd8fde9f3aa84932b86942/gcc%2Fconfig%2Frs6000%2Frs6000.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8f1b829ed295b4b834cd8fde9f3aa84932b86942/gcc%2Fconfig%2Frs6000%2Frs6000.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.h?ref=8f1b829ed295b4b834cd8fde9f3aa84932b86942", "patch": "@@ -2555,11 +2555,12 @@ extern int rs6000_trunc_used;\n /* If we are referencing a function that is static or is known to be\n    in this file, make the SYMBOL_REF special.  We can use this to indicate\n    that we can branch to this function without emitting a no-op after the\n-   call.  */\n+   call.  Do not set this flag if the function is weakly defined. */\n \n #define ENCODE_SECTION_INFO(DECL)  \\\n   if (TREE_CODE (DECL) == FUNCTION_DECL\t\t\t\\\n-      && (TREE_ASM_WRITTEN (DECL) || ! TREE_PUBLIC (DECL))) \\\n+      && (TREE_ASM_WRITTEN (DECL) || ! TREE_PUBLIC (DECL)) \\\n+      && !DECL_WEAK (DECL)) \\\n     SYMBOL_REF_FLAG (XEXP (DECL_RTL (DECL), 0)) = 1;\n \n /* Indicate that jump tables go in the text section.  */"}]}