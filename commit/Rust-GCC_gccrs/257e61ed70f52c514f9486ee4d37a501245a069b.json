{"sha": "257e61ed70f52c514f9486ee4d37a501245a069b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjU3ZTYxZWQ3MGY1MmM1MTRmOTQ4NmVlNGQzN2E1MDEyNDVhMDY5Yg==", "commit": {"author": {"name": "Richard Stallman", "email": "rms@gnu.org", "date": "1993-05-01T04:09:06Z"}, "committer": {"name": "Richard Stallman", "email": "rms@gnu.org", "date": "1993-05-01T04:09:06Z"}, "message": "(truthvalue_conversion): Specific error message when the \"truthvalue\" of a struct...\n\n(truthvalue_conversion):  Specific error message when the\n\"truthvalue\" of a struct, union, or array type operand is needed.\n\nFrom-SVN: r4293", "tree": {"sha": "257410d7731912b96b1b811c9043fc4aafa93b55", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/257410d7731912b96b1b811c9043fc4aafa93b55"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/257e61ed70f52c514f9486ee4d37a501245a069b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/257e61ed70f52c514f9486ee4d37a501245a069b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/257e61ed70f52c514f9486ee4d37a501245a069b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/257e61ed70f52c514f9486ee4d37a501245a069b/comments", "author": null, "committer": null, "parents": [{"sha": "5f0abdc3ca190343317ef72988e0d49743a34c60", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5f0abdc3ca190343317ef72988e0d49743a34c60", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5f0abdc3ca190343317ef72988e0d49743a34c60"}], "stats": {"total": 23, "additions": 23, "deletions": 0}, "files": [{"sha": "f4a966e880a264ba7df9930a8421a7fe05d3e9e6", "filename": "gcc/c-common.c", "status": "modified", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/257e61ed70f52c514f9486ee4d37a501245a069b/gcc%2Fc-common.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/257e61ed70f52c514f9486ee4d37a501245a069b/gcc%2Fc-common.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-common.c?ref=257e61ed70f52c514f9486ee4d37a501245a069b", "patch": "@@ -955,6 +955,29 @@ truthvalue_conversion (expr)\n {\n   register enum tree_code code;\n \n+  if (TREE_CODE (expr) == ERROR_MARK)\n+    return expr;\n+\n+  /* These really should return error_mark_node after 2.4 is stable.\n+     But not all callers handle ERROR_MARK properly.  */\n+  switch (TREE_CODE (TREE_TYPE (expr)))\n+    {\n+    case RECORD_TYPE:\n+      error (\"struct type value used where scalar is required\");\n+      return integer_zero_node;\n+\n+    case UNION_TYPE:\n+      error (\"union type value used where scalar is required\");\n+      return integer_zero_node;\n+\n+    case ARRAY_TYPE:\n+      error (\"array type value used where scalar is required\");\n+      return integer_zero_node;\n+\n+    default:\n+      break;\n+    }\n+\n   switch (TREE_CODE (expr))\n     {\n       /* It is simpler and generates better code to have only TRUTH_*_EXPR"}]}