{"sha": "f373d4c761d558910774264f085e117f6c8cf791", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjM3M2Q0Yzc2MWQ1NTg5MTA3NzQyNjRmMDg1ZTExN2Y2YzhjZjc5MQ==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2002-09-05T07:54:26Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2002-09-05T07:54:26Z"}, "message": "ctype_members.cc (ctype<wchar_t>::do_widen(char)): Switch to _M_c_locale_ctype around btowc call.\n\n\t* config/locale/gnu/ctype_members.cc (ctype<wchar_t>::do_widen(char)):\n\tSwitch to _M_c_locale_ctype around btowc call.\n\t(ctype<wchar_t>::do_widen(const char*, const char *, wchar_t*)):\n\tSwitch to _M_c_locale_ctype around mbsrtowcs call.\n\t(ctype<wchar_t>::do_narrow(char)): Switch to _M_c_locale_ctype around\n\twctob call.\n\t(ctype<wchar_t>::do_narrow(const char*, const char *, wchar_t*)):\n\tSwitch to _M_c_locale_ctype around wcsrtombs call.\n\nFrom-SVN: r56841", "tree": {"sha": "163734e49b1723c47f849e3c8f087a7547741975", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/163734e49b1723c47f849e3c8f087a7547741975"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f373d4c761d558910774264f085e117f6c8cf791", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f373d4c761d558910774264f085e117f6c8cf791", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f373d4c761d558910774264f085e117f6c8cf791", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f373d4c761d558910774264f085e117f6c8cf791/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "9a6d20712ba05d64e03f7252c5b145494ce7937e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9a6d20712ba05d64e03f7252c5b145494ce7937e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9a6d20712ba05d64e03f7252c5b145494ce7937e"}], "stats": {"total": 42, "additions": 40, "deletions": 2}, "files": [{"sha": "f96da8b649406eee036382944f71a10d7764b155", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f373d4c761d558910774264f085e117f6c8cf791/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f373d4c761d558910774264f085e117f6c8cf791/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=f373d4c761d558910774264f085e117f6c8cf791", "patch": "@@ -1,3 +1,14 @@\n+2002-09-05  Jakub Jelinek  <jakub@redhat.com>\n+\n+\t* config/locale/gnu/ctype_members.cc (ctype<wchar_t>::do_widen(char)):\n+\tSwitch to _M_c_locale_ctype around btowc call.\n+\t(ctype<wchar_t>::do_widen(const char*, const char *, wchar_t*)):\n+\tSwitch to _M_c_locale_ctype around mbsrtowcs call.\n+\t(ctype<wchar_t>::do_narrow(char)): Switch to _M_c_locale_ctype around\n+\twctob call.\n+\t(ctype<wchar_t>::do_narrow(const char*, const char *, wchar_t*)):\n+\tSwitch to _M_c_locale_ctype around wcsrtombs call.\n+\n 2002-09-05  Jakub Jelinek  <jakub@redhat.com>\n \n \t* config/locale/gnu/monetary_members.cc"}, {"sha": "db1e356d038127be553918e4042e912a3ddc864d", "filename": "libstdc++-v3/config/locale/gnu/ctype_members.cc", "status": "modified", "additions": 29, "deletions": 2, "changes": 31, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f373d4c761d558910774264f085e117f6c8cf791/libstdc%2B%2B-v3%2Fconfig%2Flocale%2Fgnu%2Fctype_members.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f373d4c761d558910774264f085e117f6c8cf791/libstdc%2B%2B-v3%2Fconfig%2Flocale%2Fgnu%2Fctype_members.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fconfig%2Flocale%2Fgnu%2Fctype_members.cc?ref=f373d4c761d558910774264f085e117f6c8cf791", "patch": "@@ -166,23 +166,44 @@ namespace std\n   wchar_t\n   ctype<wchar_t>::\n   do_widen(char __c) const\n-  { return btowc(__c); }\n-  \n+  {\n+#if __GLIBC__ > 2 || (__GLIBC__ == 2 && __GLIBC_MINOR__ > 2)\n+    __c_locale __old = __uselocale(_M_c_locale_ctype);\n+#endif\n+    wchar_t __ret = btowc(__c);\n+#if __GLIBC__ > 2 || (__GLIBC__ == 2 && __GLIBC_MINOR__ > 2)\n+    __uselocale(__old);\n+#endif\n+    return __ret;\n+  }\n+\n   const char* \n   ctype<wchar_t>::\n   do_widen(const char* __lo, const char* __hi, wchar_t* __dest) const\n   {\n+#if __GLIBC__ > 2 || (__GLIBC__ == 2 && __GLIBC_MINOR__ > 2)\n+    __c_locale __old = __uselocale(_M_c_locale_ctype);\n+#endif\n     mbstate_t __state;\n     memset(static_cast<void*>(&__state), 0, sizeof(mbstate_t));\n     mbsrtowcs(__dest, &__lo, __hi - __lo, &__state);\n+#if __GLIBC__ > 2 || (__GLIBC__ == 2 && __GLIBC_MINOR__ > 2)\n+    __uselocale(__old);\n+#endif\n     return __hi;\n   }\n \n   char\n   ctype<wchar_t>::\n   do_narrow(wchar_t __wc, char __dfault) const\n   { \n+#if __GLIBC__ > 2 || (__GLIBC__ == 2 && __GLIBC_MINOR__ > 2)\n+    __c_locale __old = __uselocale(_M_c_locale_ctype);\n+#endif\n     int __c = wctob(__wc);\n+#if __GLIBC__ > 2 || (__GLIBC__ == 2 && __GLIBC_MINOR__ > 2)\n+    __uselocale(__old);\n+#endif\n     return (__c == EOF ? __dfault : static_cast<char>(__c)); \n   }\n \n@@ -191,6 +212,9 @@ namespace std\n   do_narrow(const wchar_t* __lo, const wchar_t* __hi, char __dfault, \n \t    char* __dest) const\n   {\n+#if __GLIBC__ > 2 || (__GLIBC__ == 2 && __GLIBC_MINOR__ > 2)\n+    __c_locale __old = __uselocale(_M_c_locale_ctype);\n+#endif\n     size_t __offset = 0;\n     while (true)\n       {\n@@ -208,6 +232,9 @@ namespace std\n \telse\n \t  break;\n       }\n+#if __GLIBC__ > 2 || (__GLIBC__ == 2 && __GLIBC_MINOR__ > 2)\n+    __uselocale(__old);\n+#endif\n     return __hi;\n   }\n #endif //  _GLIBCPP_USE_WCHAR_T"}]}