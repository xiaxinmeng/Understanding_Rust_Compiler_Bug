{"sha": "a50790d1cad989184d0b77e20c60bf38de3c08a4", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTUwNzkwZDFjYWQ5ODkxODRkMGI3N2UyMGM2MGJmMzhkZTNjMDhhNA==", "commit": {"author": {"name": "Javier Miranda", "email": "miranda@adacore.com", "date": "2009-07-23T09:27:18Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2009-07-23T09:27:18Z"}, "message": "sinfo.ads (Is_Scil_Node, [...]): Add missing documentation.\n\n2009-07-23  Javier Miranda  <miranda@adacore.com>\n\n\t* sinfo.ads (Is_Scil_Node, Scil_Nkind, Scil_Related_Node,\n\tScil_Target_Prim, N_Has_Entity): Add missing documentation.\n\t* exp_disp.ads (Scil_Node_Kind): Ditto.\n\t* exp_disp.adb (Make_DT, Make_Tags): Ditto.\n\t* exp_ch3.adb (Build_Init_Procedure): Ditto.\n\nFrom-SVN: r149982", "tree": {"sha": "1d1960c9c88b3c37e8c4daf3cfb7506f04d68771", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1d1960c9c88b3c37e8c4daf3cfb7506f04d68771"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a50790d1cad989184d0b77e20c60bf38de3c08a4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a50790d1cad989184d0b77e20c60bf38de3c08a4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a50790d1cad989184d0b77e20c60bf38de3c08a4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a50790d1cad989184d0b77e20c60bf38de3c08a4/comments", "author": {"login": "miranda-adacore", "id": 54413934, "node_id": "MDQ6VXNlcjU0NDEzOTM0", "avatar_url": "https://avatars.githubusercontent.com/u/54413934?v=4", "gravatar_id": "", "url": "https://api.github.com/users/miranda-adacore", "html_url": "https://github.com/miranda-adacore", "followers_url": "https://api.github.com/users/miranda-adacore/followers", "following_url": "https://api.github.com/users/miranda-adacore/following{/other_user}", "gists_url": "https://api.github.com/users/miranda-adacore/gists{/gist_id}", "starred_url": "https://api.github.com/users/miranda-adacore/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/miranda-adacore/subscriptions", "organizations_url": "https://api.github.com/users/miranda-adacore/orgs", "repos_url": "https://api.github.com/users/miranda-adacore/repos", "events_url": "https://api.github.com/users/miranda-adacore/events{/privacy}", "received_events_url": "https://api.github.com/users/miranda-adacore/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "7205254be85f07852b41fa0a92f6667a4ecaca8c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7205254be85f07852b41fa0a92f6667a4ecaca8c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7205254be85f07852b41fa0a92f6667a4ecaca8c"}], "stats": {"total": 98, "additions": 79, "deletions": 19}, "files": [{"sha": "8a119acc165b9f363c43a3b43afa304bb72416ba", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a50790d1cad989184d0b77e20c60bf38de3c08a4/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a50790d1cad989184d0b77e20c60bf38de3c08a4/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=a50790d1cad989184d0b77e20c60bf38de3c08a4", "patch": "@@ -1,3 +1,11 @@\n+2009-07-23  Javier Miranda  <miranda@adacore.com>\n+\n+\t* sinfo.ads (Is_Scil_Node, Scil_Nkind, Scil_Related_Node,\n+\tScil_Target_Prim, N_Has_Entity): Add missing documentation.\n+\t* exp_disp.ads (Scil_Node_Kind): Ditto.\n+\t* exp_disp.adb (Make_DT, Make_Tags): Ditto.\n+\t* exp_ch3.adb (Build_Init_Procedure): Ditto.\n+\n 2009-07-23  Javier Miranda  <miranda@adacore.com>\n \n \t* einfo.adb (Component_Type): Add missing assertion."}, {"sha": "51dccfb5078df6a10ffe0b06d47218118386b143", "filename": "gcc/ada/exp_ch3.adb", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a50790d1cad989184d0b77e20c60bf38de3c08a4/gcc%2Fada%2Fexp_ch3.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a50790d1cad989184d0b77e20c60bf38de3c08a4/gcc%2Fada%2Fexp_ch3.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fexp_ch3.adb?ref=a50790d1cad989184d0b77e20c60bf38de3c08a4", "patch": "@@ -1409,8 +1409,8 @@ package body Exp_Ch3 is\n \n       if (Is_Null_Init_Proc (Proc) and then not Init_Or_Norm_Scalars)\n         or else Is_Value_Type (Typ)\n-        or else ((Is_Array_Type (Typ) or else Is_String_Type (Typ))\n-                    and then Is_Value_Type (Component_Type (Typ)))\n+        or else\n+          (Is_Array_Type (Typ) and then Is_Value_Type (Component_Type (Typ)))\n       then\n          return Empty_List;\n       end if;\n@@ -2323,7 +2323,8 @@ package body Exp_Ch3 is\n                   New_Reference_To\n                     (Node (First_Elmt (Access_Disp_Table (Rec_Type))), Loc)));\n \n-            --  Following code needs a comment ???\n+            --  Generate the SCIL node associated with the initialization of\n+            --  the tag component.\n \n             if Generate_SCIL then\n                Prepend_To (Init_Tags_List,"}, {"sha": "104b1c013dee29cff2dddc55e037d051011a2d85", "filename": "gcc/ada/exp_disp.adb", "status": "modified", "additions": 18, "deletions": 8, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a50790d1cad989184d0b77e20c60bf38de3c08a4/gcc%2Fada%2Fexp_disp.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a50790d1cad989184d0b77e20c60bf38de3c08a4/gcc%2Fada%2Fexp_disp.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fexp_disp.adb?ref=a50790d1cad989184d0b77e20c60bf38de3c08a4", "patch": "@@ -643,7 +643,7 @@ package body Exp_Disp is\n          Typ := Non_Limited_View (Typ);\n       end if;\n \n-      --  Comment needed ???\n+      --  Generate the SCIL node of this dispatching call\n \n       if Generate_SCIL then\n          Insert_Action (Call_Node,\n@@ -4243,7 +4243,8 @@ package body Exp_Disp is\n                   New_Reference_To\n                     (RTE (RE_No_Dispatch_Table_Wrapper), Loc)));\n \n-            --  Comment needed ???\n+            --  Generate a SCIL node for the previous object declaration\n+            --  because it has a null dispatch table.\n \n             if Generate_SCIL then\n                Insert_Before (Last (Result),\n@@ -4279,6 +4280,9 @@ package body Exp_Disp is\n                             (RTE_Record_Component (RE_NDT_Prims_Ptr), Loc)),\n                       Attribute_Name => Name_Address))));\n \n+            --  Generate the SCIL node for the previous object declaration\n+            --  because it has a tag initialization.\n+\n             if Generate_SCIL then\n                Insert_Before (Last (Result),\n                  New_Scil_Node\n@@ -4316,7 +4320,8 @@ package body Exp_Disp is\n                     Constraint => Make_Index_Or_Discriminant_Constraint (Loc,\n                                     Constraints => DT_Constr_List))));\n \n-            --  Comment needed ???\n+            --  Generate the SCIL node for the previous object declaration\n+            --  because it contains a dispatch table.\n \n             if Generate_SCIL then\n                Insert_Before (Last (Result),\n@@ -4352,7 +4357,8 @@ package body Exp_Disp is\n                             (RTE_Record_Component (RE_Prims_Ptr), Loc)),\n                       Attribute_Name => Name_Address))));\n \n-            --  Comment needed ???\n+            --  Generate the SCIL node for the previous object declaration\n+            --  because it has a tag initialization.\n \n             if Generate_SCIL then\n                Insert_Before (Last (Result),\n@@ -5130,7 +5136,8 @@ package body Exp_Disp is\n                 Expression => Make_Aggregate (Loc,\n                   Expressions => DT_Aggr_List)));\n \n-            --  Comment needed ???\n+            --  Generate the SCIL node for the previous object declaration\n+            --  because it has a null dispatch table.\n \n             if Generate_SCIL then\n                Insert_Before (Last (Result),\n@@ -5446,7 +5453,8 @@ package body Exp_Disp is\n                 Expression => Make_Aggregate (Loc,\n                   Expressions => DT_Aggr_List)));\n \n-            --  Comment needed ???\n+            --  Generate the SCIL node for the previous object declaration\n+            --  because it contains a dispatch table.\n \n             if Generate_SCIL then\n                Insert_Before (Last (Result),\n@@ -6146,7 +6154,8 @@ package body Exp_Disp is\n                             (RTE_Record_Component (RE_Prims_Ptr), Loc)),\n                       Attribute_Name => Name_Address))));\n \n-            --  Comment needed ???\n+            --  Generate the SCIL node for the previous object declaration\n+            --  because it has a tag initialization.\n \n             if Generate_SCIL then\n                Insert_Before (Last (Result),\n@@ -6191,7 +6200,8 @@ package body Exp_Disp is\n                             (RTE_Record_Component (RE_NDT_Prims_Ptr), Loc)),\n                       Attribute_Name => Name_Address))));\n \n-            --  Comment needed ???\n+            --  Generate the SCIL node for the previous object declaration\n+            --  because it has a tag initialization.\n \n             if Generate_SCIL then\n                Insert_Before (Last (Result),"}, {"sha": "e02cca769953ea59487f34afa99b7945e6e5a12b", "filename": "gcc/ada/exp_disp.ads", "status": "modified", "additions": 18, "deletions": 1, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a50790d1cad989184d0b77e20c60bf38de3c08a4/gcc%2Fada%2Fexp_disp.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a50790d1cad989184d0b77e20c60bf38de3c08a4/gcc%2Fada%2Fexp_disp.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fexp_disp.ads?ref=a50790d1cad989184d0b77e20c60bf38de3c08a4", "patch": "@@ -34,7 +34,24 @@ package Exp_Disp is\n    -- SCIL Node Type Definition --\n    -------------------------------\n \n-   --  Comment required! ??? What is this type???\n+   --  SCIL nodes are a special kind of nodes added to the tree when the\n+   --  CodePeer mode is active. They are stored in the tree as special\n+   --  N_Null_Statement nodes that have extra attributes. The information\n+   --  available through these extra attributes relies on the kind of SCIL\n+   --  node. The SCIL node kind is stored in the Scil_Nkind attribute of\n+   --  the N_Null_Statement node. The kind of SCIL nodes generated by the\n+   --  frontend are the following:\n+\n+   --    IP_Tag_Init: Scil node of tag component initialization.\n+\n+   --    Dispatching_Call: Scil node of dispatching call. Used by the\n+   --      CodePeer backend to locate nodes associated with dispatching\n+   --      calls.\n+\n+   --    Dispatching_Table_Object_Init: Scil node of object declaration\n+   --      containing a dispatch table.\n+\n+   --    Dispatching_Table_Tag_Init: Scil node of tag initialization.\n \n    type Scil_Node_Kind is\n      (Unused,"}, {"sha": "9d42a510be2cf07a775f70d216d8277244ef6ad4", "filename": "gcc/ada/sinfo.ads", "status": "modified", "additions": 31, "deletions": 7, "changes": 38, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a50790d1cad989184d0b77e20c60bf38de3c08a4/gcc%2Fada%2Fsinfo.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a50790d1cad989184d0b77e20c60bf38de3c08a4/gcc%2Fada%2Fsinfo.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsinfo.ads?ref=a50790d1cad989184d0b77e20c60bf38de3c08a4", "patch": "@@ -1251,6 +1251,15 @@ package Sinfo is\n    --    handler to make sure that the associated protected object is unlocked\n    --    when the subprogram completes.\n \n+   --  Is_Scil_Node (Flag4-Sem)\n+   --    Present in N_Null_Statement nodes. Set to indicate that it is a SCIL\n+   --    node. Scil nodes are special nodes that help the CodePeer backend\n+   --    locating nodes that require special processing. In order to minimize\n+   --    the impact on the compiler and ASIS, and also to maximize flexibility\n+   --    when adding SCIl nodes to the tree, instead of adding new kind of\n+   --    nodes, SCIL nodes are added to the tree as N_Null_Statement nodes on\n+   --    which this attribute is set.\n+\n    --  Is_Static_Coextension (Flag14-Sem)\n    --    Present in N_Allocator nodes. Set if the allocator is a coextension\n    --    of an object allocated on the stack rather than the heap.\n@@ -1589,6 +1598,19 @@ package Sinfo is\n    --    are the result of expansion of rounded fixed-point divide, conversion\n    --    and multiplication operations.\n \n+   --  Scil_Nkind (Uint3-Sem)\n+   --    Present in N_Null_Statement nodes that are Scil nodes. Used to\n+   --    indicate the kind of SCIL node (see scil node kinds in exp_disp.ads).\n+\n+   --  Scil_Related_Node (Node1-Sem)\n+   --    Present in N_Null_Statement nodes that are Scil nodes. Used to\n+   --    reference a tree node that requires special processing in the\n+   --    CodePeer backend.\n+\n+   --  Scil_Target_Prim (Node2-Sem)\n+   --    Present in N_Null_Statement nodes. Used to reference the tagged type\n+   --    primitive associated with the SCIL node.\n+\n    --  Scope (Node3-Sem)\n    --    Present in defining identifiers, defining character literals and\n    --    defining operator symbols (i.e. in all entities). The entities of a\n@@ -3842,11 +3864,9 @@ package Sinfo is\n       --  Entity (Node4-Sem)\n       --  Scil_Target_Prim (Node2-Sem)\n \n-      --  What are the above Scil fields for, and what has this got to do with\n-      --  null statements. MAJOR MISSING DOC HERE ??? All -Sem fields must be\n-      --  individually documented in the list of -Sem fields at the start of\n-      --  Sinfo, and we sure need significant documentation here explaining\n-      --  what on earth is going on with null statements!\n+      --  Note that in SCIL nodes (N_Null_Statement nodes with Is_Scil_Node\n+      --  set to True), Entity references the tagged type associated with\n+      --  the SCIL node.\n \n       ----------------\n       -- 5.1  Label --\n@@ -7240,8 +7260,6 @@ package Sinfo is\n       N_Goto_Statement,\n       N_Loop_Statement,\n       N_Null_Statement,\n-      --  N_Null_Statement now has an Entity field, but is not in N_Has_Entity.\n-      --  Either fix this, or document this peculiar irregularity ???\n       N_Raise_Statement,\n       N_Requeue_Statement,\n       N_Return_Statement, -- renamed as N_Simple_Return_Statement below\n@@ -7413,6 +7431,12 @@ package Sinfo is\n    --  Nodes that have Entity fields\n    --  Warning: DOES NOT INCLUDE N_Freeze_Entity!\n \n+   --  Warning: DOES NOT INCLUDE N_Null_Assignment because it not always\n+   --  available. The Entity attribute is only available in Scil nodes\n+   --  (that is, N_Null_Assignment nodes that have Is_Scil_Node set to true).\n+   --  Processing such nodes never requires testing if the node is in\n+   --  N_Has_Entity node kind.\n+\n    subtype N_Has_Etype is Node_Kind range\n      N_Error ..\n      N_Subtype_Indication;"}]}