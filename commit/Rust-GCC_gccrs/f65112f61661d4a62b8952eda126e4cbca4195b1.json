{"sha": "f65112f61661d4a62b8952eda126e4cbca4195b1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjY1MTEyZjYxNjYxZDRhNjJiODk1MmVkYTEyNmU0Y2JjYTQxOTViMQ==", "commit": {"author": {"name": "Andre Vieira", "email": "andre.simoesdiasvieira@arm.com", "date": "2019-03-08T17:29:02Z"}, "committer": {"name": "Andre Vieira", "email": "avieira@gcc.gnu.org", "date": "2019-03-08T17:29:02Z"}, "message": "[GCC, Arm] Fix availability of FP16-FP64 conversion instructions\n\n\nvcvtb.f16.f64 and vcvtb.f64.f16 were being made available even for FPUs that do\nnot support double precision.  This patch fixes that.\n\ngcc/ChangeLog:\n2019-03-08  Andre Vieira  <andre.simoesdiasvieira@arm.com>\n\n\t* config/arm/arm.h (TARGET_FP16_TO_DOUBLE): Add TARGET_VFP_DOUBLE\n\trequirement.\n\ngcc/testsuite/ChangeLog:\n2019-03-08  Andre Vieira  <andre.simoesdiasvieira@arm.com>\n\n\t* gcc.target/arm/f16_f64_conv_no_dp.c: New test.\n\nFrom-SVN: r269499", "tree": {"sha": "886eb00f3274962305c3c1290189a45c573d4a67", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/886eb00f3274962305c3c1290189a45c573d4a67"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f65112f61661d4a62b8952eda126e4cbca4195b1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f65112f61661d4a62b8952eda126e4cbca4195b1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f65112f61661d4a62b8952eda126e4cbca4195b1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f65112f61661d4a62b8952eda126e4cbca4195b1/comments", "author": {"login": "avieira-arm", "id": 68072104, "node_id": "MDQ6VXNlcjY4MDcyMTA0", "avatar_url": "https://avatars.githubusercontent.com/u/68072104?v=4", "gravatar_id": "", "url": "https://api.github.com/users/avieira-arm", "html_url": "https://github.com/avieira-arm", "followers_url": "https://api.github.com/users/avieira-arm/followers", "following_url": "https://api.github.com/users/avieira-arm/following{/other_user}", "gists_url": "https://api.github.com/users/avieira-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/avieira-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/avieira-arm/subscriptions", "organizations_url": "https://api.github.com/users/avieira-arm/orgs", "repos_url": "https://api.github.com/users/avieira-arm/repos", "events_url": "https://api.github.com/users/avieira-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/avieira-arm/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "9a53d503a433b3ca0c4e312e9ebea5f1b344efed", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9a53d503a433b3ca0c4e312e9ebea5f1b344efed", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9a53d503a433b3ca0c4e312e9ebea5f1b344efed"}], "stats": {"total": 26, "additions": 25, "deletions": 1}, "files": [{"sha": "ad486b4d862bc556ec356289a55dacbe0a33e167", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f65112f61661d4a62b8952eda126e4cbca4195b1/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f65112f61661d4a62b8952eda126e4cbca4195b1/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=f65112f61661d4a62b8952eda126e4cbca4195b1", "patch": "@@ -1,3 +1,8 @@\n+2019-03-08  Andre Vieira  <andre.simoesdiasvieira@arm.com>\n+\n+\t* config/arm/arm.h (TARGET_FP16_TO_DOUBLE): Add TARGET_VFP_DOUBLE\n+\trequirement.\n+\n 2019-03-08  Uro\u0161 Bizjak  <ubizjak@gmail.com>\n \n \tPR target/68924"}, {"sha": "7adafead0f20832467b873f53d298a2e1a25ab0a", "filename": "gcc/config/arm/arm.h", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f65112f61661d4a62b8952eda126e4cbca4195b1/gcc%2Fconfig%2Farm%2Farm.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f65112f61661d4a62b8952eda126e4cbca4195b1/gcc%2Fconfig%2Farm%2Farm.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Farm.h?ref=f65112f61661d4a62b8952eda126e4cbca4195b1", "patch": "@@ -195,7 +195,7 @@ extern tree arm_fp16_type_node;\n /* FPU supports converting between HFmode and DFmode in a single hardware\n    step.  */\n #define TARGET_FP16_TO_DOUBLE\t\t\t\t\t\t\\\n-  (TARGET_HARD_FLOAT && (TARGET_FP16 && TARGET_VFP5))\n+  (TARGET_HARD_FLOAT && TARGET_FP16 && TARGET_VFP5 && TARGET_VFP_DOUBLE)\n \n /* FPU supports fused-multiply-add operations.  */\n #define TARGET_FMA (bitmap_bit_p (arm_active_target.isa, isa_bit_vfpv4))"}, {"sha": "13b91c7965ca0d84d61170488c87cbe62382eb04", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f65112f61661d4a62b8952eda126e4cbca4195b1/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f65112f61661d4a62b8952eda126e4cbca4195b1/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=f65112f61661d4a62b8952eda126e4cbca4195b1", "patch": "@@ -1,3 +1,7 @@\n+2019-03-08  Andre Vieira  <andre.simoesdiasvieira@arm.com>\n+\n+\t* gcc.target/arm/f16_f64_conv_no_dp.c: New test.\n+\n 2019-03-08  Uro\u0161 Bizjak  <ubizjak@gmail.com>\n \n \tPR target/68924"}, {"sha": "99b62a8ffd5de5c61c08980a067d8fc08cb24b11", "filename": "gcc/testsuite/gcc.target/arm/f16_f64_conv_no_dp.c", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f65112f61661d4a62b8952eda126e4cbca4195b1/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Ff16_f64_conv_no_dp.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f65112f61661d4a62b8952eda126e4cbca4195b1/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Ff16_f64_conv_no_dp.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Ff16_f64_conv_no_dp.c?ref=f65112f61661d4a62b8952eda126e4cbca4195b1", "patch": "@@ -0,0 +1,15 @@\n+/* { dg-do compile } */\n+/* { dg-skip-if \"do not override fpu\" { *-*-* } { \"-mfpu=*\" } { \"-mfpu=fpv5-sp-d16\" } } */\n+/* { dg-skip-if \"do not disable fpu\" { *-*-* } { \"-mfloat-abi=soft\" } { * } } */\n+/* { dg-skip-if \"do not override fp16-format\" { *-*-* } { \"-mfp16-format=*\" } { \"-mfp16-format=ieee\" } } */\n+/* { dg-options \"-O1 -mfpu=fpv5-sp-d16 -mfloat-abi=hard -mfp16-format=ieee\" } */\n+\n+__fp16 foo (double a)\n+{\n+  return a;\n+}\n+\n+double bar (__fp16 a)\n+{\n+  return a;\n+}"}]}