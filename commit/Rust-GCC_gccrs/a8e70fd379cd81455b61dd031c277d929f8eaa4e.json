{"sha": "a8e70fd379cd81455b61dd031c277d929f8eaa4e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YThlNzBmZDM3OWNkODE0NTViNjFkZDAzMWMyNzdkOTI5ZjhlYWE0ZQ==", "commit": {"author": {"name": "Robin Dapp", "email": "rdapp@linux.vnet.ibm.com", "date": "2017-04-03T10:54:38Z"}, "committer": {"name": "Andreas Krebbel", "email": "krebbel@gcc.gnu.org", "date": "2017-04-03T10:54:38Z"}, "message": "Fix s390 testcase vcond-shift\n\nThis patch fixes the vcond shift testcase that failed since setting\nPARAM_MIN_VECT_LOOP_BOUND in the s390 backend.\n\ngcc/testsuite/ChangeLog:\n\n2017-04-03  Robin Dapp  <rdapp@linux.vnet.ibm.com>\n\n\t* gcc.target/s390/vector/vcond-shift.c (foo, foo2, foo3, baz, baf)\n\t(bal): Increase iteration count and assume alignment.\n\nFrom-SVN: r246644", "tree": {"sha": "fc8121b9d1542e7899b5e78d9c1cb476784250f3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/fc8121b9d1542e7899b5e78d9c1cb476784250f3"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a8e70fd379cd81455b61dd031c277d929f8eaa4e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a8e70fd379cd81455b61dd031c277d929f8eaa4e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a8e70fd379cd81455b61dd031c277d929f8eaa4e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a8e70fd379cd81455b61dd031c277d929f8eaa4e/comments", "author": {"login": "rdapp1", "id": 22046046, "node_id": "MDQ6VXNlcjIyMDQ2MDQ2", "avatar_url": "https://avatars.githubusercontent.com/u/22046046?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rdapp1", "html_url": "https://github.com/rdapp1", "followers_url": "https://api.github.com/users/rdapp1/followers", "following_url": "https://api.github.com/users/rdapp1/following{/other_user}", "gists_url": "https://api.github.com/users/rdapp1/gists{/gist_id}", "starred_url": "https://api.github.com/users/rdapp1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rdapp1/subscriptions", "organizations_url": "https://api.github.com/users/rdapp1/orgs", "repos_url": "https://api.github.com/users/rdapp1/repos", "events_url": "https://api.github.com/users/rdapp1/events{/privacy}", "received_events_url": "https://api.github.com/users/rdapp1/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "e006186611558bd377d9d4880ebdec7b3e011657", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e006186611558bd377d9d4880ebdec7b3e011657", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e006186611558bd377d9d4880ebdec7b3e011657"}], "stats": {"total": 39, "additions": 28, "deletions": 11}, "files": [{"sha": "c353008f277afcd6552719762a29e1132e6b284a", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a8e70fd379cd81455b61dd031c277d929f8eaa4e/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a8e70fd379cd81455b61dd031c277d929f8eaa4e/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=a8e70fd379cd81455b61dd031c277d929f8eaa4e", "patch": "@@ -1,3 +1,8 @@\n+2017-04-03  Robin Dapp  <rdapp@linux.vnet.ibm.com>\n+\n+\t* gcc.target/s390/vector/vcond-shift.c (foo, foo2, foo3, baz, baf)\n+\t(bal): Increase iteration count and assume alignment.\n+\n 2017-04-03  Bin Cheng  <bin.cheng@arm.com>\n \n \t* gcc.dg/tree-ssa/pr71347.c: Add predcom and drop XFAILs."}, {"sha": "cc40153bb270c92ba58fc725c226576731f6531e", "filename": "gcc/testsuite/gcc.target/s390/vector/vcond-shift.c", "status": "modified", "additions": 23, "deletions": 11, "changes": 34, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a8e70fd379cd81455b61dd031c277d929f8eaa4e/gcc%2Ftestsuite%2Fgcc.target%2Fs390%2Fvector%2Fvcond-shift.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a8e70fd379cd81455b61dd031c277d929f8eaa4e/gcc%2Ftestsuite%2Fgcc.target%2Fs390%2Fvector%2Fvcond-shift.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fs390%2Fvector%2Fvcond-shift.c?ref=a8e70fd379cd81455b61dd031c277d929f8eaa4e", "patch": "@@ -11,51 +11,63 @@\n /* { dg-final { scan-assembler \"vesrlh\\t%v.?,%v.?,15\" } } */\n /* { dg-final { scan-assembler \"vesrlb\\t%v.?,%v.?,7\" } } */\n \n-#define SZ 4\n-#define SZ2 8\n-#define SZ3 16\n+#define SZ 8\n+#define SZ2 16\n+#define SZ3 32\n \n void foo(int *w)\n {\n   int i;\n-  /* Should expand to (w + (w < 0 ? 1 : 0)) >> 1\n-     which in turn should get simplified to (w + (w >> 31)) >> 1.  */\n+  int *ww = __builtin_assume_aligned (w, 8);\n+\n+  /* Should expand to (ww + (ww < 0 ? 1 : 0)) >> 1\n+     which in turn should get simplified to (ww + (ww >> 31)) >> 1.  */\n   for (i = 0; i < SZ; i++)\n-    w[i] = w[i] / 2;\n+    ww[i] = ww[i] / 2;\n }\n \n void foo2(short *w)\n {\n   int i;\n+  short *ww = __builtin_assume_aligned (w, 8);\n+\n   for (i = 0; i < SZ2; i++)\n-    w[i] = w[i] / 2;\n+    ww[i] = ww[i] / 2;\n }\n \n \n void foo3(signed char *w)\n {\n   int i;\n+  signed char *ww = __builtin_assume_aligned (w, 8);\n+\n   for (i = 0; i < SZ3; i++)\n-    w[i] = w[i] / 2;\n+    ww[i] = ww[i] / 2;\n }\n \n int baz(int *x)\n {\n   int i;\n+  int *xx = __builtin_assume_aligned (x, 8);\n+\n   for (i = 0; i < SZ; i++)\n-    x[i] = x[i] < 0 ? -1 : 0;\n+    xx[i] = xx[i] < 0 ? -1 : 0;\n }\n \n int baf(short *x)\n {\n   int i;\n+  short *xx = __builtin_assume_aligned (x, 8);\n+\n   for (i = 0; i < SZ2; i++)\n-    x[i] = x[i] >= 0 ? 0 : 1;\n+    xx[i] = xx[i] >= 0 ? 0 : 1;\n }\n \n int bal(signed char *x)\n {\n   int i;\n+  signed char *xx = __builtin_assume_aligned (x, 8);\n+\n   for (i = 0; i < SZ3; i++)\n-    x[i] = x[i] >= 0 ? 0 : -1;\n+    xx[i] = xx[i] >= 0 ? 0 : -1;\n }"}]}