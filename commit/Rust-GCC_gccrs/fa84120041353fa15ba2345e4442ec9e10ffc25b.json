{"sha": "fa84120041353fa15ba2345e4442ec9e10ffc25b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZmE4NDEyMDA0MTM1M2ZhMTViYTIzNDVlNDQ0MmVjOWUxMGZmYzI1Yg==", "commit": {"author": {"name": "Tobias Schl\u00fcter", "email": "tobias.schlueter@physik.uni-muenchen.de", "date": "2004-06-21T22:22:32Z"}, "committer": {"name": "Tobias Schl\u00fcter", "email": "tobi@gcc.gnu.org", "date": "2004-06-21T22:22:32Z"}, "message": "re PR fortran/15511 (Warning about truncated lines does not follow the standard gcc error message format)\n\nPR fortran/15511\n* scanner.c (load_line): Don't truncate preprocessor lines.\nReformat error message.\n(preprocessor_line): Issue warning in case of malformed\npreprocessor line.\n\nFrom-SVN: r83455", "tree": {"sha": "b7d5e1b4fab9f3c7d2ba14953873091dcc16e31a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b7d5e1b4fab9f3c7d2ba14953873091dcc16e31a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/fa84120041353fa15ba2345e4442ec9e10ffc25b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fa84120041353fa15ba2345e4442ec9e10ffc25b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fa84120041353fa15ba2345e4442ec9e10ffc25b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fa84120041353fa15ba2345e4442ec9e10ffc25b/comments", "author": {"login": "TobiSchluter", "id": 11887541, "node_id": "MDQ6VXNlcjExODg3NTQx", "avatar_url": "https://avatars.githubusercontent.com/u/11887541?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TobiSchluter", "html_url": "https://github.com/TobiSchluter", "followers_url": "https://api.github.com/users/TobiSchluter/followers", "following_url": "https://api.github.com/users/TobiSchluter/following{/other_user}", "gists_url": "https://api.github.com/users/TobiSchluter/gists{/gist_id}", "starred_url": "https://api.github.com/users/TobiSchluter/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TobiSchluter/subscriptions", "organizations_url": "https://api.github.com/users/TobiSchluter/orgs", "repos_url": "https://api.github.com/users/TobiSchluter/repos", "events_url": "https://api.github.com/users/TobiSchluter/events{/privacy}", "received_events_url": "https://api.github.com/users/TobiSchluter/received_events", "type": "User", "site_admin": false}, "committer": {"login": "TobiSchluter", "id": 11887541, "node_id": "MDQ6VXNlcjExODg3NTQx", "avatar_url": "https://avatars.githubusercontent.com/u/11887541?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TobiSchluter", "html_url": "https://github.com/TobiSchluter", "followers_url": "https://api.github.com/users/TobiSchluter/followers", "following_url": "https://api.github.com/users/TobiSchluter/following{/other_user}", "gists_url": "https://api.github.com/users/TobiSchluter/gists{/gist_id}", "starred_url": "https://api.github.com/users/TobiSchluter/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TobiSchluter/subscriptions", "organizations_url": "https://api.github.com/users/TobiSchluter/orgs", "repos_url": "https://api.github.com/users/TobiSchluter/repos", "events_url": "https://api.github.com/users/TobiSchluter/events{/privacy}", "received_events_url": "https://api.github.com/users/TobiSchluter/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6263a8f6a597b54898d4865420e61c6368f67080", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6263a8f6a597b54898d4865420e61c6368f67080", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6263a8f6a597b54898d4865420e61c6368f67080"}], "stats": {"total": 46, "additions": 35, "deletions": 11}, "files": [{"sha": "41c9a90a78086d50078bd019e4b884f408af6290", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fa84120041353fa15ba2345e4442ec9e10ffc25b/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fa84120041353fa15ba2345e4442ec9e10ffc25b/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=fa84120041353fa15ba2345e4442ec9e10ffc25b", "patch": "@@ -1,3 +1,11 @@\n+2004-06-21  Tobias Schlueter  <tobias.schlueter@physik.uni-muenchen.de\n+\n+\tPR fortran/15511\n+\t* scanner.c (load_line): Don't truncate preprocessor lines.\n+\tReformat error message.\n+\t(preprocessor_line): Issue warning in case of malformed\n+\tpreprocessor line. \n+\n 2004-06-21  Tobias Schlueter  <tobias.schlueter@physik.uni-muenchen.de>\n \n \t* resolve.c (resolve_symbol): Add comment in function body."}, {"sha": "8b8f0b0295e1138fdbf40108ad63d5558a3277a1", "filename": "gcc/fortran/scanner.c", "status": "modified", "additions": 27, "deletions": 11, "changes": 38, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fa84120041353fa15ba2345e4442ec9e10ffc25b/gcc%2Ffortran%2Fscanner.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fa84120041353fa15ba2345e4442ec9e10ffc25b/gcc%2Ffortran%2Fscanner.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fscanner.c?ref=fa84120041353fa15ba2345e4442ec9e10ffc25b", "patch": "@@ -679,14 +679,21 @@ gfc_gobble_whitespace (void)\n static void\n load_line (FILE * input, char *buffer, char *filename, int linenum)\n {\n-  int c, maxlen, i, trunc_flag;\n+  int c, maxlen, i, trunc_flag, preprocessor_flag;\n \n   maxlen = (gfc_current_form == FORM_FREE) \n     ? 132 \n     : gfc_option.fixed_line_length;\n \n   i = 0;\n \n+  preprocessor_flag = 0;\n+  c = fgetc (input);\n+  if (c == '#')\n+    /* Don't truncate preprocessor lines.  */\n+    preprocessor_flag = 1;\n+  ungetc (c, input);\n+\n   for (;;)\n     {\n       c = fgetc (input);\n@@ -722,7 +729,7 @@ load_line (FILE * input, char *buffer, char *filename, int linenum)\n       *buffer++ = c;\n       i++;\n \n-      if (i >= maxlen)\n+      if (i >= maxlen && !preprocessor_flag)\n \t{\t\t\t/* Truncate the rest of the line.  */\n \t  trunc_flag = 1;\n \n@@ -736,8 +743,8 @@ load_line (FILE * input, char *buffer, char *filename, int linenum)\n \t\t  && trunc_flag\n \t\t  && !gfc_is_whitespace (c))\n \t\t{\n-\t\t  gfc_warning_now (\"Line %d of %s is being truncated\",\n-\t\t\t\t   linenum, filename);\n+\t\t  gfc_warning_now (\"%s:%d: Line is being truncated\",\n+\t\t\t\t   filename, linenum);\n \t\t  trunc_flag = 0;\n \t\t}\n \t    }\n@@ -789,19 +796,21 @@ preprocessor_line (char *c)\n     c++;\n \n   if (*c < '0' || *c > '9')\n-    {\n-      gfc_warning_now (\"%s:%d Unknown preprocessor directive\", \n-\t\t       current_file->filename, current_file->line);\n-      current_file->line++;\n-      return;\n-    }\n+    goto bad_cpp_line;\n \n   line = atoi (c);\n \n-  c = strchr (c, ' ') + 2; /* Skip space and quote.  */\n+  c = strchr (c, ' '); \n+  if (c == NULL)\n+    /* Something we don't understand has happened.  */\n+    goto bad_cpp_line;\n+  c += 2;     /* Skip space and quote.  */\n   filename = c;\n \n   c = strchr (c, '\"'); /* Make filename end at quote.  */\n+  if (c == NULL)\n+    /* Preprocessor line has no closing quote.  */\n+    goto bad_cpp_line;\n   *c++ = '\\0';\n \n   /* Get flags.  */\n@@ -846,6 +855,13 @@ preprocessor_line (char *c)\n       current_file->filename = gfc_getmem (strlen (filename) + 1);\n       strcpy (current_file->filename, filename);\n     }\n+\n+  return;\n+\n+ bad_cpp_line:\n+  gfc_warning_now (\"%s:%d: Unknown preprocessor directive\", \n+\t\t   current_file->filename, current_file->line);\n+  current_file->line++;\n }\n \n "}]}