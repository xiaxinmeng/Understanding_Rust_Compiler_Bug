{"sha": "53e5ace2e9b7a1c48d5ca0cd1d66215e89075ee8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTNlNWFjZTJlOWI3YTFjNDhkNWNhMGNkMWQ2NjIxNWU4OTA3NWVlOA==", "commit": {"author": {"name": "Renlin Li", "email": "renlin.li@arm.com", "date": "2014-04-22T14:35:33Z"}, "committer": {"name": "Marcus Shawcroft", "email": "mshawcroft@gcc.gnu.org", "date": "2014-04-22T14:35:33Z"}, "message": "[AArch64] Fix aarch64_initial_elimination_offset calculation.\n\nThis patch fixes the elimination offset calculation.  This is a latent\nbug hidden by the frame alignment calculation.\n\n\nCo-Authored-By: Jiong Wang <jiong.wang@arm.com>\n\nFrom-SVN: r209636", "tree": {"sha": "5c81b5ac3453d7973a1b293942e52f72a79f1552", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5c81b5ac3453d7973a1b293942e52f72a79f1552"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/53e5ace2e9b7a1c48d5ca0cd1d66215e89075ee8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/53e5ace2e9b7a1c48d5ca0cd1d66215e89075ee8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/53e5ace2e9b7a1c48d5ca0cd1d66215e89075ee8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/53e5ace2e9b7a1c48d5ca0cd1d66215e89075ee8/comments", "author": null, "committer": null, "parents": [{"sha": "78c29983f2d170312a9c4543a0a04fa559e6e095", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/78c29983f2d170312a9c4543a0a04fa559e6e095", "html_url": "https://github.com/Rust-GCC/gccrs/commit/78c29983f2d170312a9c4543a0a04fa559e6e095"}], "stats": {"total": 15, "additions": 8, "deletions": 7}, "files": [{"sha": "2c46cc497014f6b11a36b2288375e0c0bb02422e", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/53e5ace2e9b7a1c48d5ca0cd1d66215e89075ee8/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/53e5ace2e9b7a1c48d5ca0cd1d66215e89075ee8/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=53e5ace2e9b7a1c48d5ca0cd1d66215e89075ee8", "patch": "@@ -1,3 +1,10 @@\n+2014-04-22  Renlin  <renlin.li@arm.com>\n+\t    Jiong Wang  <jiong.wang@arm.com>\n+\n+\t* config/aarch64/aarch64.h (aarch64_frame): Delete \"fp_lr_offset\".\n+\t* config/aarch64/aarch64.c (aarch64_layout_frame)\n+\t(aarch64_initial_elimination_offset): Likewise.\n+\n 2014-04-22  Marcus Shawcroft  <marcus.shawcroft@arm.com>\n \n \t* config/aarch64/aarch64.c (aarch64_initial_elimination_offset):"}, {"sha": "51a8a7dbc830060ff781c7f2cc0b510902256e25", "filename": "gcc/config/aarch64/aarch64.c", "status": "modified", "additions": 1, "deletions": 6, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/53e5ace2e9b7a1c48d5ca0cd1d66215e89075ee8/gcc%2Fconfig%2Faarch64%2Faarch64.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/53e5ace2e9b7a1c48d5ca0cd1d66215e89075ee8/gcc%2Fconfig%2Faarch64%2Faarch64.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Faarch64%2Faarch64.c?ref=53e5ace2e9b7a1c48d5ca0cd1d66215e89075ee8", "patch": "@@ -1713,8 +1713,6 @@ aarch64_layout_frame (void)\n   if (reload_completed && cfun->machine->frame.laid_out)\n     return;\n \n-  cfun->machine->frame.fp_lr_offset = 0;\n-\n   /* First mark all the registers that really need to be saved...  */\n   for (regno = R0_REGNUM; regno <= R30_REGNUM; regno++)\n     cfun->machine->frame.reg_offset[regno] = -1;\n@@ -1764,14 +1762,12 @@ aarch64_layout_frame (void)\n     {\n       cfun->machine->frame.reg_offset[R29_REGNUM] = offset;\n       offset += UNITS_PER_WORD;\n-      cfun->machine->frame.fp_lr_offset = UNITS_PER_WORD;\n     }\n \n   if (cfun->machine->frame.reg_offset[R30_REGNUM] != -1)\n     {\n       cfun->machine->frame.reg_offset[R30_REGNUM] = offset;\n       offset += UNITS_PER_WORD;\n-      cfun->machine->frame.fp_lr_offset += UNITS_PER_WORD;\n     }\n \n   cfun->machine->frame.padding0 =\n@@ -4165,8 +4161,7 @@ aarch64_initial_elimination_offset (unsigned from, unsigned to)\n \t{\n \t  HOST_WIDE_INT elim = crtl->outgoing_args_size\n \t    + cfun->machine->frame.saved_regs_size\n-\t    + get_frame_size ()\n-\t    - cfun->machine->frame.fp_lr_offset;\n+\t    + get_frame_size ();\n \t  elim = AARCH64_ROUND_UP (elim, STACK_BOUNDARY / BITS_PER_UNIT);\n \t  return elim;\n \t}"}, {"sha": "b87473b3df5b24756176f5ddd36bca9448e1b75f", "filename": "gcc/config/aarch64/aarch64.h", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/53e5ace2e9b7a1c48d5ca0cd1d66215e89075ee8/gcc%2Fconfig%2Faarch64%2Faarch64.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/53e5ace2e9b7a1c48d5ca0cd1d66215e89075ee8/gcc%2Fconfig%2Faarch64%2Faarch64.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Faarch64%2Faarch64.h?ref=53e5ace2e9b7a1c48d5ca0cd1d66215e89075ee8", "patch": "@@ -520,7 +520,6 @@ struct GTY (()) aarch64_frame\n      been saved.  */\n   HOST_WIDE_INT padding0;\n   HOST_WIDE_INT hardfp_offset;\t/* HARD_FRAME_POINTER_REGNUM */\n-  HOST_WIDE_INT fp_lr_offset;\t/* Space needed for saving fp and/or lr */\n \n   bool laid_out;\n };"}]}