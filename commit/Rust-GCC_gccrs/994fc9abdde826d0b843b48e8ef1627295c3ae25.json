{"sha": "994fc9abdde826d0b843b48e8ef1627295c3ae25", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTk0ZmM5YWJkZGU4MjZkMGI4NDNiNDhlOGVmMTYyNzI5NWMzYWUyNQ==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2010-08-20T18:49:46Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2010-08-20T18:49:46Z"}, "message": "re PR middle-end/44974 (Function with attribute noreturn omits a call to another function with noreturn)\n\n\tPR middle-end/44974\n\t* builtins.c (expand_builtin): Don't optimize away\n\tcalls to DECL_LOOPING_CONST_OR_PURE_P builtins.\n\n\t* gcc.dg/pr44974.c: New test.\n\nFrom-SVN: r163415", "tree": {"sha": "641b172aeb3419f87090129ab841a2d5ae3ff2ef", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/641b172aeb3419f87090129ab841a2d5ae3ff2ef"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/994fc9abdde826d0b843b48e8ef1627295c3ae25", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/994fc9abdde826d0b843b48e8ef1627295c3ae25", "html_url": "https://github.com/Rust-GCC/gccrs/commit/994fc9abdde826d0b843b48e8ef1627295c3ae25", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/994fc9abdde826d0b843b48e8ef1627295c3ae25/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "6c33409079616051a31b9c7546d22dc59a44f24e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6c33409079616051a31b9c7546d22dc59a44f24e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6c33409079616051a31b9c7546d22dc59a44f24e"}], "stats": {"total": 35, "additions": 34, "deletions": 1}, "files": [{"sha": "1cfd27ef8fd1ddfadc238a3936375dc4c0176024", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/994fc9abdde826d0b843b48e8ef1627295c3ae25/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/994fc9abdde826d0b843b48e8ef1627295c3ae25/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=994fc9abdde826d0b843b48e8ef1627295c3ae25", "patch": "@@ -1,3 +1,9 @@\n+2010-08-20  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR middle-end/44974\n+\t* builtins.c (expand_builtin): Don't optimize away\n+\tcalls to DECL_LOOPING_CONST_OR_PURE_P builtins.\n+\n 2010-08-20  Uros Bizjak  <ubizjak@gmail.com>\n \n \t* config/i386/i386.md (ashift RSP splitter): Remove splitter."}, {"sha": "e8974e1bbc225a67534bca9327436f59dcaeb9a9", "filename": "gcc/builtins.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/994fc9abdde826d0b843b48e8ef1627295c3ae25/gcc%2Fbuiltins.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/994fc9abdde826d0b843b48e8ef1627295c3ae25/gcc%2Fbuiltins.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fbuiltins.c?ref=994fc9abdde826d0b843b48e8ef1627295c3ae25", "patch": "@@ -5770,7 +5770,8 @@ expand_builtin (tree exp, rtx target, rtx subtarget, enum machine_mode mode,\n      none of its arguments are volatile, we can avoid expanding the\n      built-in call and just evaluate the arguments for side-effects.  */\n   if (target == const0_rtx\n-      && (DECL_PURE_P (fndecl) || TREE_READONLY (fndecl)))\n+      && (DECL_PURE_P (fndecl) || TREE_READONLY (fndecl))\n+      && !DECL_LOOPING_CONST_OR_PURE_P (fndecl))\n     {\n       bool volatilep = false;\n       tree arg;"}, {"sha": "358033100158f72988f5a187e18213c04822f04e", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/994fc9abdde826d0b843b48e8ef1627295c3ae25/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/994fc9abdde826d0b843b48e8ef1627295c3ae25/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=994fc9abdde826d0b843b48e8ef1627295c3ae25", "patch": "@@ -1,5 +1,8 @@\n 2010-08-20  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR middle-end/44974\n+\t* gcc.dg/pr44974.c: New test.\n+\n \tPR rtl-optimization/45353\n \t* gcc.dg/pr45353.c: New test.\n "}, {"sha": "14e43ece3c2dbfd33e71b73503e1c3d26ef62ff5", "filename": "gcc/testsuite/gcc.dg/pr44974.c", "status": "added", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/994fc9abdde826d0b843b48e8ef1627295c3ae25/gcc%2Ftestsuite%2Fgcc.dg%2Fpr44974.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/994fc9abdde826d0b843b48e8ef1627295c3ae25/gcc%2Ftestsuite%2Fgcc.dg%2Fpr44974.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr44974.c?ref=994fc9abdde826d0b843b48e8ef1627295c3ae25", "patch": "@@ -0,0 +1,23 @@\n+/* PR middle-end/44974 */\n+/* { dg-do compile } */\n+/* { dg-options \"-O -fno-optimize-sibling-calls\" } */\n+\n+extern void foo (int status) __attribute__ ((__noreturn__));\n+extern void bar (int status) __attribute__ ((__noreturn__));\n+extern void _Exit (int status) __attribute__ ((__noreturn__));\n+\n+void\n+foo (int status)\n+{\n+  _Exit (status);\n+}\n+\n+void\n+_Exit (int status)\n+{\n+  bar (status);\n+}\n+\n+/* { dg-final { scan-assembler \"call\\[^\\n\\]*_Exit\" { target i?86-*-* x86_64-*-* ia64-*-* sparc*-*-* } } } */\n+/* { dg-final { scan-assembler \"bl\\[^\\n\\]*_Exit\" { target powerpc*-*-* } } } */\n+/* { dg-final { scan-assembler \"brasl\\[^\\n\\]*_Exit\" { target { s390*-*-* && lp64 } } } } */"}]}