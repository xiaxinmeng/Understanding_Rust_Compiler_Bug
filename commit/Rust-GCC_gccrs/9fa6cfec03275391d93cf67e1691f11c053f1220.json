{"sha": "9fa6cfec03275391d93cf67e1691f11c053f1220", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWZhNmNmZWMwMzI3NTM5MWQ5M2NmNjdlMTY5MWYxMWMwNTNmMTIyMA==", "commit": {"author": {"name": "Tobias Burnus", "email": "burnus@net-b.de", "date": "2007-09-22T14:20:57Z"}, "committer": {"name": "Tobias Burnus", "email": "burnus@gcc.gnu.org", "date": "2007-09-22T14:20:57Z"}, "message": "re PR fortran/33445 (Diagnose \"!$OMP&\" as an error in free format unless it is a continuation line)\n\n2007-09-22  Tobias Burnus  <burnus@net-b.de>\n\n        PR fortran/33445\n        * scanner.c (skip_free_comments): Warn if !$OMP& is used\n        if no OpenMP directive is to be continued.\n\n2007-09-22  Tobias Burnus  <burnus@net-b.de>\n\n        PR fortran/33445\n        * gfortran.dg/gomp/free-2.f90: New.\n        * gfortran.dg/gomp/appendix-a/a.31.1.f90: Add missing &.\n        * gfortran.dg/gomp/omp_parse1.f90: Add dg-warning.\n\nFrom-SVN: r128670", "tree": {"sha": "ca7d1c74fc1a4a59a83a6080cb466e3998beb348", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ca7d1c74fc1a4a59a83a6080cb466e3998beb348"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9fa6cfec03275391d93cf67e1691f11c053f1220", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9fa6cfec03275391d93cf67e1691f11c053f1220", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9fa6cfec03275391d93cf67e1691f11c053f1220", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9fa6cfec03275391d93cf67e1691f11c053f1220/comments", "author": {"login": "tob2", "id": 264461, "node_id": "MDQ6VXNlcjI2NDQ2MQ==", "avatar_url": "https://avatars.githubusercontent.com/u/264461?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tob2", "html_url": "https://github.com/tob2", "followers_url": "https://api.github.com/users/tob2/followers", "following_url": "https://api.github.com/users/tob2/following{/other_user}", "gists_url": "https://api.github.com/users/tob2/gists{/gist_id}", "starred_url": "https://api.github.com/users/tob2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tob2/subscriptions", "organizations_url": "https://api.github.com/users/tob2/orgs", "repos_url": "https://api.github.com/users/tob2/repos", "events_url": "https://api.github.com/users/tob2/events{/privacy}", "received_events_url": "https://api.github.com/users/tob2/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "b235734c763af862a2606225d7aefd9990847edd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b235734c763af862a2606225d7aefd9990847edd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b235734c763af862a2606225d7aefd9990847edd"}], "stats": {"total": 56, "additions": 45, "deletions": 11}, "files": [{"sha": "f683ea3c7f69b129151dab988b0e7ab601963262", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9fa6cfec03275391d93cf67e1691f11c053f1220/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9fa6cfec03275391d93cf67e1691f11c053f1220/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=9fa6cfec03275391d93cf67e1691f11c053f1220", "patch": "@@ -1,3 +1,9 @@\n+2007-09-22  Tobias Burnus  <burnus@net-b.de>\n+\n+\tPR fortran/33445\n+\t* scanner.c (skip_free_comments): Warn if !$OMP& is used\n+\tif no OpenMP directive is to be continued.\n+\n 2007-09-21  Paul Thomas  <pault@gcc.gnu.org>\n \n \t*trans-expr.c (gfc_trans_pointer_assignment): Convert array"}, {"sha": "fe7d213ae0bbde0fe830d1d0919d99fa39e1ba45", "filename": "gcc/fortran/scanner.c", "status": "modified", "additions": 16, "deletions": 9, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9fa6cfec03275391d93cf67e1691f11c053f1220/gcc%2Ffortran%2Fscanner.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9fa6cfec03275391d93cf67e1691f11c053f1220/gcc%2Ffortran%2Fscanner.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fscanner.c?ref=9fa6cfec03275391d93cf67e1691f11c053f1220", "patch": "@@ -417,18 +417,25 @@ skip_free_comments (void)\n \t\t  if (c == 'o' || c == 'O')\n \t\t    {\n \t\t      if (((c = next_char ()) == 'm' || c == 'M')\n-\t\t\t  && ((c = next_char ()) == 'p' || c == 'P')\n-\t\t\t  && ((c = next_char ()) == ' ' || continue_flag))\n+\t\t\t  && ((c = next_char ()) == 'p' || c == 'P'))\n \t\t\t{\n-\t\t\t  while (gfc_is_whitespace (c))\n-\t\t\t    c = next_char ();\n-\t\t\t  if (c != '\\n' && c != '!')\n+\t\t\t  if ((c = next_char ()) == ' ' || continue_flag)\n \t\t\t    {\n-\t\t\t      openmp_flag = 1;\n-\t\t\t      openmp_locus = old_loc;\n-\t\t\t      gfc_current_locus = start;\n-\t\t\t      return false;\n+\t\t\t      while (gfc_is_whitespace (c))\n+\t\t\t\tc = next_char ();\n+\t\t\t      if (c != '\\n' && c != '!')\n+\t\t\t\t{\n+\t\t\t\t  openmp_flag = 1;\n+\t\t\t\t  openmp_locus = old_loc;\n+\t\t\t\t  gfc_current_locus = start;\n+\t\t\t\t  return false;\n+\t\t\t\t}\n \t\t\t    }\n+\t\t\t  else\n+\t\t\t    gfc_warning_now (\"!$OMP at %C starts a commented \"\n+\t\t\t\t\t     \"line as it neither is followed \"\n+\t\t\t\t\t     \"by a space nor is a \"\n+\t\t\t\t\t     \"continuation line\");\n \t\t\t}\n \t\t      gfc_current_locus = old_loc;\n \t\t      next_char ();"}, {"sha": "96387b225d1939cfa8ed46bcfacf345e362a44b8", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9fa6cfec03275391d93cf67e1691f11c053f1220/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9fa6cfec03275391d93cf67e1691f11c053f1220/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=9fa6cfec03275391d93cf67e1691f11c053f1220", "patch": "@@ -1,3 +1,10 @@\n+2007-09-22  Tobias Burnus  <burnus@net-b.de>\n+\n+\tPR fortran/33445\n+\t* gfortran.dg/gomp/free-2.f90: New.\n+\t* gfortran.dg/gomp/appendix-a/a.31.1.f90: Add missing &.\n+\t* gfortran.dg/gomp/omp_parse1.f90: Add dg-warning.\n+\n 2007-09-22  Uros Bizjak  <ubizjak@gmail.com>\n \n \t* gcc.target/i386/sse5-hadduX.c: Remove target selector."}, {"sha": "7459897ebbdac5e4189146563dc09d4877aee302", "filename": "gcc/testsuite/gfortran.dg/gomp/appendix-a/a.31.1.f90", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9fa6cfec03275391d93cf67e1691f11c053f1220/gcc%2Ftestsuite%2Fgfortran.dg%2Fgomp%2Fappendix-a%2Fa.31.1.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9fa6cfec03275391d93cf67e1691f11c053f1220/gcc%2Ftestsuite%2Fgfortran.dg%2Fgomp%2Fappendix-a%2Fa.31.1.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fgomp%2Fappendix-a%2Fa.31.1.f90?ref=9fa6cfec03275391d93cf67e1691f11c053f1220", "patch": "@@ -3,7 +3,7 @@\n       SUBROUTINE A31_1(A, B, X, Y, N)\n         INTEGER N\n         REAL X(*), Y(*), A, B\n-!$OMP PARALLEL DO PRIVATE(I) SHARED(X, N) REDUCTION(+:A)\n+!$OMP PARALLEL DO PRIVATE(I) SHARED(X, N) REDUCTION(+:A) &\n !$OMP& REDUCTION(MIN:B)\n         DO I=1,N\n            A = A + X(I)"}, {"sha": "60bac66b849f5df4b7310e03f48cc32fe3385137", "filename": "gcc/testsuite/gfortran.dg/gomp/free-2.f90", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9fa6cfec03275391d93cf67e1691f11c053f1220/gcc%2Ftestsuite%2Fgfortran.dg%2Fgomp%2Ffree-2.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9fa6cfec03275391d93cf67e1691f11c053f1220/gcc%2Ftestsuite%2Fgfortran.dg%2Fgomp%2Ffree-2.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fgomp%2Ffree-2.f90?ref=9fa6cfec03275391d93cf67e1691f11c053f1220", "patch": "@@ -0,0 +1,14 @@\n+! { dg-do compile }\n+!\n+! PR fortran/33445\n+!\n+!$OMP&foo ! { dg-warning \"starts a commented line\" }\n+!\n+!$OMP parallel \n+!$OMP& default(shared) ! { dg-warning \"starts a commented line\" }\n+!$OMP end parallel\n+!\n+!$OMP parallel \n+!$OMP+ default(shared) ! { dg-warning \"starts a commented line\" }\n+!$OMP end parallel\n+       end"}, {"sha": "d4137cd11ec2f375a3efb38af7ed7b76d3f6309c", "filename": "gcc/testsuite/gfortran.dg/gomp/omp_parse1.f90", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9fa6cfec03275391d93cf67e1691f11c053f1220/gcc%2Ftestsuite%2Fgfortran.dg%2Fgomp%2Fomp_parse1.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9fa6cfec03275391d93cf67e1691f11c053f1220/gcc%2Ftestsuite%2Fgfortran.dg%2Fgomp%2Fomp_parse1.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fgomp%2Fomp_parse1.f90?ref=9fa6cfec03275391d93cf67e1691f11c053f1220", "patch": "@@ -17,7 +17,7 @@\n ! Non-continuation !$omp must be followed by space, and my reading\n ! doesn't seem to allow tab there.  So such lines should be completely\n ! ignored.\n-!$omp\tstrange\n+!$omp\tstrange  !  { dg-warning \"starts a commented line\" }\n end\n \n ! { dg-final { scan-tree-dump-times \"pragma omp parallel\" 3 \"omplower\" } }"}]}