{"sha": "73075e06b7591dacd413e2e9a944d9fe6722dde9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzMwNzVlMDZiNzU5MWRhY2Q0MTNlMmU5YTk0NGQ5ZmU2NzIyZGRlOQ==", "commit": {"author": {"name": "Paolo Carlini", "email": "paolo.carlini@oracle.com", "date": "2019-01-09T08:52:38Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2019-01-09T08:52:38Z"}, "message": "decl.c (grok_reference_init): Improve error location.\n\n/cp\n2019-01-08  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\t* decl.c (grok_reference_init): Improve error location.\n\t(grokdeclarator): Likewise, improve two locations.\n\n/testsuite\n2019-01-08  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\t* g++.dg/diagnostic/constexpr2.C: New.\n\t* g++.dg/diagnostic/ref3.C: Likewise.\n\nFrom-SVN: r267756", "tree": {"sha": "3280ad692033296f7b65c3472f7de5c8831ef08d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3280ad692033296f7b65c3472f7de5c8831ef08d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/73075e06b7591dacd413e2e9a944d9fe6722dde9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/73075e06b7591dacd413e2e9a944d9fe6722dde9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/73075e06b7591dacd413e2e9a944d9fe6722dde9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/73075e06b7591dacd413e2e9a944d9fe6722dde9/comments", "author": null, "committer": null, "parents": [{"sha": "0ac6a741dda62dbc1c19738aa7dd21d8efc996f5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0ac6a741dda62dbc1c19738aa7dd21d8efc996f5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0ac6a741dda62dbc1c19738aa7dd21d8efc996f5"}], "stats": {"total": 32, "additions": 27, "deletions": 5}, "files": [{"sha": "3167b49b6e026007196e0a52588faef02fc052e2", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/73075e06b7591dacd413e2e9a944d9fe6722dde9/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/73075e06b7591dacd413e2e9a944d9fe6722dde9/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=73075e06b7591dacd413e2e9a944d9fe6722dde9", "patch": "@@ -1,3 +1,8 @@\n+2019-01-08  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\t* decl.c (grok_reference_init): Improve error location.\n+\t(grokdeclarator): Likewise, improve two locations.\n+\n 2019-01-08  Marek Polacek  <polacek@redhat.com>\n \n \tPR c++/88538 - braced-init-list in template-argument-list."}, {"sha": "267303e0b7060440821a9cca4622703f81c00d28", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 8, "deletions": 5, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/73075e06b7591dacd413e2e9a944d9fe6722dde9/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/73075e06b7591dacd413e2e9a944d9fe6722dde9/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=73075e06b7591dacd413e2e9a944d9fe6722dde9", "patch": "@@ -5357,7 +5357,8 @@ grok_reference_init (tree decl, tree type, tree init, int flags)\n       if ((DECL_LANG_SPECIFIC (decl) == 0\n \t   || DECL_IN_AGGR_P (decl) == 0)\n \t  && ! DECL_THIS_EXTERN (decl))\n-\terror (\"%qD declared as reference but not initialized\", decl);\n+\terror_at (DECL_SOURCE_LOCATION (decl),\n+\t\t  \"%qD declared as reference but not initialized\", decl);\n       return NULL_TREE;\n     }\n \n@@ -12517,8 +12518,9 @@ grokdeclarator (const cp_declarator *declarator,\n \t\t\t    unqualified_id);\n \t\telse if (constexpr_p && !initialized)\n \t\t  {\n-\t\t    error (\"%<constexpr%> static data member %qD must have an \"\n-\t\t\t   \"initializer\", decl);\n+\t\t    error_at (DECL_SOURCE_LOCATION (decl),\n+\t\t\t      \"%<constexpr%> static data member %qD must \"\n+\t\t\t      \"have an initializer\", decl);\n \t\t    constexpr_p = false;\n \t\t  }\n \n@@ -12756,8 +12758,9 @@ grokdeclarator (const cp_declarator *declarator,\n \t  }\n \telse if (constexpr_p && DECL_EXTERNAL (decl))\n \t  {\n-\t    error (\"declaration of %<constexpr%> variable %qD \"\n-\t\t   \"is not a definition\", decl);\n+\t    error_at (DECL_SOURCE_LOCATION (decl),\n+\t\t      \"declaration of %<constexpr%> variable %qD \"\n+\t\t      \"is not a definition\", decl);\n \t    constexpr_p = false;\n \t  }\n "}, {"sha": "47b6116845ffd49a1f569cf3bd325d10f421c0ea", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/73075e06b7591dacd413e2e9a944d9fe6722dde9/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/73075e06b7591dacd413e2e9a944d9fe6722dde9/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=73075e06b7591dacd413e2e9a944d9fe6722dde9", "patch": "@@ -1,3 +1,8 @@\n+2019-01-08  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\t* g++.dg/diagnostic/constexpr2.C: New.\n+\t* g++.dg/diagnostic/ref3.C: Likewise.\n+\n 2019-01-08  Marek Polacek  <polacek@redhat.com>\n \n \tPR c++/88538 - braced-init-list in template-argument-list."}, {"sha": "7afb5a23bdffdd1fb2b9084edd83be4448950ac1", "filename": "gcc/testsuite/g++.dg/diagnostic/constexpr2.C", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/73075e06b7591dacd413e2e9a944d9fe6722dde9/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdiagnostic%2Fconstexpr2.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/73075e06b7591dacd413e2e9a944d9fe6722dde9/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdiagnostic%2Fconstexpr2.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdiagnostic%2Fconstexpr2.C?ref=73075e06b7591dacd413e2e9a944d9fe6722dde9", "patch": "@@ -0,0 +1,8 @@\n+// { dg-do compile { target c++11 } }\n+\n+extern constexpr int i __attribute__((unused));  // { dg-error \"22:declaration of .constexpr. variable .i.\" }\n+\n+struct S\n+{\n+  constexpr static int i __attribute__((unused));  // { dg-error \"24:.constexpr. static data member .i.\" }\n+};"}, {"sha": "f43f5a3f6d5313cbcb8c80f69a3c90f8b538b48d", "filename": "gcc/testsuite/g++.dg/diagnostic/ref3.C", "status": "added", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/73075e06b7591dacd413e2e9a944d9fe6722dde9/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdiagnostic%2Fref3.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/73075e06b7591dacd413e2e9a944d9fe6722dde9/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdiagnostic%2Fref3.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdiagnostic%2Fref3.C?ref=73075e06b7591dacd413e2e9a944d9fe6722dde9", "patch": "@@ -0,0 +1 @@\n+int& i __attribute__((unused));  // { dg-error \"6:.i. declared as reference\" }"}]}