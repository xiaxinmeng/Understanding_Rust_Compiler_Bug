{"sha": "cd077efd33fc56016b9bea8f30964fb93a40ff3a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Y2QwNzdlZmQzM2ZjNTYwMTZiOWJlYThmMzA5NjRmYjkzYTQwZmYzYQ==", "commit": {"author": {"name": "Pascal Obry", "email": "obry@adacore.com", "date": "2014-07-18T10:57:47Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2014-07-18T10:57:47Z"}, "message": "a-textio.adb, [...]: Use C_Streams Default_Text.\n\n2014-07-18  Pascal Obry  <obry@adacore.com>\n\n\t* a-textio.adb, a-witeio.adb, a-ztexio.adb: Use C_Streams Default_Text.\n\t* i-cstrea.ads (Content_Encoding): Moved here, add convention C.\n\t* s-ficobl.ads (Content_Encoding): Moved to C_Streams.\n\t* s-fileio.adb (Open): Adjust to use Content_Encoding from C_Streams.\n\nFrom-SVN: r212811", "tree": {"sha": "948305f1acf26a8531b54d326b0c4ae0fcb653ff", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/948305f1acf26a8531b54d326b0c4ae0fcb653ff"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/cd077efd33fc56016b9bea8f30964fb93a40ff3a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cd077efd33fc56016b9bea8f30964fb93a40ff3a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cd077efd33fc56016b9bea8f30964fb93a40ff3a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cd077efd33fc56016b9bea8f30964fb93a40ff3a/comments", "author": {"login": "TurboGit", "id": 467069, "node_id": "MDQ6VXNlcjQ2NzA2OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/467069?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TurboGit", "html_url": "https://github.com/TurboGit", "followers_url": "https://api.github.com/users/TurboGit/followers", "following_url": "https://api.github.com/users/TurboGit/following{/other_user}", "gists_url": "https://api.github.com/users/TurboGit/gists{/gist_id}", "starred_url": "https://api.github.com/users/TurboGit/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TurboGit/subscriptions", "organizations_url": "https://api.github.com/users/TurboGit/orgs", "repos_url": "https://api.github.com/users/TurboGit/repos", "events_url": "https://api.github.com/users/TurboGit/events{/privacy}", "received_events_url": "https://api.github.com/users/TurboGit/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "18f2c4608d3bd85f19aef3068357f1c8fbe098b5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/18f2c4608d3bd85f19aef3068357f1c8fbe098b5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/18f2c4608d3bd85f19aef3068357f1c8fbe098b5"}], "stats": {"total": 92, "additions": 45, "deletions": 47}, "files": [{"sha": "55e0b3f39b18b9bedead79adc1cd972c7f6cf58c", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cd077efd33fc56016b9bea8f30964fb93a40ff3a/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cd077efd33fc56016b9bea8f30964fb93a40ff3a/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=cd077efd33fc56016b9bea8f30964fb93a40ff3a", "patch": "@@ -1,3 +1,10 @@\n+2014-07-18  Pascal Obry  <obry@adacore.com>\n+\n+\t* a-textio.adb, a-witeio.adb, a-ztexio.adb: Use C_Streams Default_Text.\n+\t* i-cstrea.ads (Content_Encoding): Moved here, add convention C.\n+\t* s-ficobl.ads (Content_Encoding): Moved to C_Streams.\n+\t* s-fileio.adb (Open): Adjust to use Content_Encoding from C_Streams.\n+\n 2014-07-18  Pascal Obry  <obry@adacore.com>\n \n \t* a-textio.adb: Rename Is_Text_File to Text_Encoding."}, {"sha": "2ebec616c6d838f877d9292eef86195515b61750", "filename": "gcc/ada/a-textio.adb", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cd077efd33fc56016b9bea8f30964fb93a40ff3a/gcc%2Fada%2Fa-textio.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cd077efd33fc56016b9bea8f30964fb93a40ff3a/gcc%2Fada%2Fa-textio.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fa-textio.adb?ref=cd077efd33fc56016b9bea8f30964fb93a40ff3a", "patch": "@@ -921,7 +921,7 @@ package body Ada.Text_IO is\n       Standard_Err.Is_Regular_File   := is_regular_file (fileno (stderr)) /= 0;\n       Standard_Err.Is_Temporary_File := False;\n       Standard_Err.Is_System_File    := True;\n-      Standard_Err.Text_Encoding     := FCB.Default_Text;\n+      Standard_Err.Text_Encoding     := Default_Text;\n       Standard_Err.Access_Method     := 'T';\n       Standard_Err.Self              := Standard_Err;\n       Standard_Err.WC_Method         := Default_WCEM;\n@@ -933,7 +933,7 @@ package body Ada.Text_IO is\n       Standard_In.Is_Regular_File    := is_regular_file (fileno (stdin)) /= 0;\n       Standard_In.Is_Temporary_File  := False;\n       Standard_In.Is_System_File     := True;\n-      Standard_In.Text_Encoding      := FCB.Default_Text;\n+      Standard_In.Text_Encoding      := Default_Text;\n       Standard_In.Access_Method      := 'T';\n       Standard_In.Self               := Standard_In;\n       Standard_In.WC_Method          := Default_WCEM;\n@@ -945,7 +945,7 @@ package body Ada.Text_IO is\n       Standard_Out.Is_Regular_File   := is_regular_file (fileno (stdout)) /= 0;\n       Standard_Out.Is_Temporary_File := False;\n       Standard_Out.Is_System_File    := True;\n-      Standard_Out.Text_Encoding     := FCB.Default_Text;\n+      Standard_Out.Text_Encoding     := Default_Text;\n       Standard_Out.Access_Method     := 'T';\n       Standard_Out.Self              := Standard_Out;\n       Standard_Out.WC_Method         := Default_WCEM;"}, {"sha": "6e2ccf536373ef9732644a946db319ff9c575e2f", "filename": "gcc/ada/a-witeio.adb", "status": "modified", "additions": 5, "deletions": 9, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cd077efd33fc56016b9bea8f30964fb93a40ff3a/gcc%2Fada%2Fa-witeio.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cd077efd33fc56016b9bea8f30964fb93a40ff3a/gcc%2Fada%2Fa-witeio.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fa-witeio.adb?ref=cd077efd33fc56016b9bea8f30964fb93a40ff3a", "patch": "@@ -892,7 +892,7 @@ package body Ada.Wide_Text_IO is\n       Standard_Err.Is_Regular_File   := is_regular_file (fileno (stderr)) /= 0;\n       Standard_Err.Is_Temporary_File := False;\n       Standard_Err.Is_System_File    := True;\n-      Standard_Err.Text_Encoding     := FCB.Default_Text;\n+      Standard_Err.Text_Encoding     := Default_Text;\n       Standard_Err.Access_Method     := 'T';\n       Standard_Err.Self              := Standard_Err;\n       Standard_Err.WC_Method         := Default_WCEM;\n@@ -904,7 +904,7 @@ package body Ada.Wide_Text_IO is\n       Standard_In.Is_Regular_File    := is_regular_file (fileno (stdin)) /= 0;\n       Standard_In.Is_Temporary_File  := False;\n       Standard_In.Is_System_File     := True;\n-      Standard_In.Text_Encoding      := FCB.Default_Text;\n+      Standard_In.Text_Encoding      := Default_Text;\n       Standard_In.Access_Method      := 'T';\n       Standard_In.Self               := Standard_In;\n       Standard_In.WC_Method          := Default_WCEM;\n@@ -916,7 +916,7 @@ package body Ada.Wide_Text_IO is\n       Standard_Out.Is_Regular_File   := is_regular_file (fileno (stdout)) /= 0;\n       Standard_Out.Is_Temporary_File := False;\n       Standard_Out.Is_System_File    := True;\n-      Standard_Out.Text_Encoding     := FCB.Default_Text;\n+      Standard_Out.Text_Encoding     := Default_Text;\n       Standard_Out.Access_Method     := 'T';\n       Standard_Out.Self              := Standard_Out;\n       Standard_Out.WC_Method         := Default_WCEM;\n@@ -1227,8 +1227,6 @@ package body Ada.Wide_Text_IO is\n      (File : File_Type;\n       Item : Wide_Character)\n    is\n-      use type FCB.Content_Encoding;\n-\n       wide_text_translation_required : Boolean;\n       for wide_text_translation_required'Size use Character'Size;\n       pragma Import (C, wide_text_translation_required,\n@@ -1259,11 +1257,9 @@ package body Ada.Wide_Text_IO is\n       FIO.Check_Write_Status (AP (File));\n \n       if wide_text_translation_required\n-        or else File.Text_Encoding /= FCB.Default_Text\n+        or else File.Text_Encoding /= Default_Text\n       then\n-         set_mode\n-           (fileno (File.Stream),\n-            FCB.Text_Content_Encoding'Pos (File.Text_Encoding));\n+         set_mode (fileno (File.Stream), File.Text_Encoding);\n          Discard := fputwc (Wide_Character'Pos (Item), File.Stream);\n       else\n          WC_Out (Item, File.WC_Method);"}, {"sha": "6102942a384974d78794f4156ea02f5a3eb195fc", "filename": "gcc/ada/a-ztexio.adb", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cd077efd33fc56016b9bea8f30964fb93a40ff3a/gcc%2Fada%2Fa-ztexio.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cd077efd33fc56016b9bea8f30964fb93a40ff3a/gcc%2Fada%2Fa-ztexio.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fa-ztexio.adb?ref=cd077efd33fc56016b9bea8f30964fb93a40ff3a", "patch": "@@ -892,7 +892,7 @@ package body Ada.Wide_Wide_Text_IO is\n       Standard_Err.Is_Regular_File   := is_regular_file (fileno (stderr)) /= 0;\n       Standard_Err.Is_Temporary_File := False;\n       Standard_Err.Is_System_File    := True;\n-      Standard_Err.Text_Encoding     := FCB.Default_Text;\n+      Standard_Err.Text_Encoding     := Default_Text;\n       Standard_Err.Access_Method     := 'T';\n       Standard_Err.Self              := Standard_Err;\n       Standard_Err.WC_Method         := Default_WCEM;\n@@ -904,7 +904,7 @@ package body Ada.Wide_Wide_Text_IO is\n       Standard_In.Is_Regular_File    := is_regular_file (fileno (stdin)) /= 0;\n       Standard_In.Is_Temporary_File  := False;\n       Standard_In.Is_System_File     := True;\n-      Standard_In.Text_Encoding      := FCB.Default_Text;\n+      Standard_In.Text_Encoding      := Default_Text;\n       Standard_In.Access_Method      := 'T';\n       Standard_In.Self               := Standard_In;\n       Standard_In.WC_Method          := Default_WCEM;\n@@ -916,7 +916,7 @@ package body Ada.Wide_Wide_Text_IO is\n       Standard_Out.Is_Regular_File   := is_regular_file (fileno (stdout)) /= 0;\n       Standard_Out.Is_Temporary_File := False;\n       Standard_Out.Is_System_File    := True;\n-      Standard_Out.Text_Encoding     := FCB.Default_Text;\n+      Standard_Out.Text_Encoding     := Default_Text;\n       Standard_Out.Access_Method     := 'T';\n       Standard_Out.Self              := Standard_Out;\n       Standard_Out.WC_Method         := Default_WCEM;"}, {"sha": "674aa02276b87dc33577b93ba4c2f7dc5fa62e47", "filename": "gcc/ada/i-cstrea.ads", "status": "modified", "additions": 25, "deletions": 11, "changes": 36, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cd077efd33fc56016b9bea8f30964fb93a40ff3a/gcc%2Fada%2Fi-cstrea.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cd077efd33fc56016b9bea8f30964fb93a40ff3a/gcc%2Fada%2Fi-cstrea.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fi-cstrea.ads?ref=cd077efd33fc56016b9bea8f30964fb93a40ff3a", "patch": "@@ -228,17 +228,31 @@ package Interfaces.C_Streams is\n    --  versa. These functions have no effect if text_translation_required is\n    --  false (e.g. in normal unix mode). Use fileno to get a stream handle.\n \n-   procedure set_mode (handle : int; Mode : int);\n-   --  As above but can set the handle to any mode. On Windows this can be used\n-   --  to have proper 16-bit wide-string output on the console for example. The\n-   --  mode value corresponds to Content_Encoding'Pos:\n-   --     0 = binary, equivalent to set_binary_mode\n-   --     1 = default mode, as set by the GNAT_CCS_ENCODING or equivalent to 2\n-   --     2 = text, equivalent to set_text_mode\n-   --     3 = u8text, set encoding to Unicode UTF-8\n-   --     4 = wide-text, set encoding to Unicode\n-   --     5 = u16text, set encoding to Unicode UTF-16\n-   --  Wouldn't it be better to use an enumeration type here???\n+   type Content_Encoding is (None, Default_Text, Text, U8text, Wtext, U16text);\n+   for Content_Encoding use (0,    1,            2,    3,      4,     5);\n+   pragma Convention (C, Content_Encoding);\n+   --  Content_Encoding describes the text encoding for file content:\n+   --    None         : No text encoding, this file is treated as a binary file\n+   --    Default_Text : A text file but not from Text_Translation form string\n+   --                   In this mode we are eventually using the system-wide\n+   --                   translation if activated.\n+   --    Text         : Text encoding activated\n+   --    Wtext        : Unicode mode\n+   --    U16text      : Unicode UTF-16 encoding\n+   --    U8text       : Unicode UTF-8 encoding\n+   --\n+   --  This encoding is system dependent and only used on Windows systems.\n+   --\n+   --  Note that modifications to Content_Encoding must be synchronized\n+   --  with sysdep.c:__gnat_set_mode.\n+\n+   subtype Text_Content_Encoding\n+     is Content_Encoding range Default_Text .. U16text;\n+\n+   procedure set_mode (handle : int; Mode : Content_Encoding);\n+   --  As above but can set the handle to any mode.\n+   --  On Windows this can be used to have proper 16-bit wide-string output\n+   --  on the console for example.\n \n    ----------------------------\n    -- Full Path Name support --"}, {"sha": "047bacac570b57df3facecde183b9a5a6874ccc0", "filename": "gcc/ada/s-ficobl.ads", "status": "modified", "additions": 1, "deletions": 20, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cd077efd33fc56016b9bea8f30964fb93a40ff3a/gcc%2Fada%2Fs-ficobl.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cd077efd33fc56016b9bea8f30964fb93a40ff3a/gcc%2Fada%2Fs-ficobl.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fs-ficobl.ads?ref=cd077efd33fc56016b9bea8f30964fb93a40ff3a", "patch": "@@ -78,25 +78,6 @@ package System.File_Control_Block is\n    --  stream with the semantics specified in the RM for file sharing. All\n    --  files opened with \"shared=no\" will have their own stream.\n \n-   type Content_Encoding is (None, Default_Text, Text, U8text, Wtext, U16text);\n-   --  Described the text encoding for file content:\n-   --    None         : No text encoding, this file is treated as a binary file\n-   --    Default_Text : A text file but not from Text_Translation form string\n-   --                   In this mode we are eventually using the system-wide\n-   --                   translation if activated.\n-   --    Text         : Text encoding activated\n-   --    Wtext        : Unicode mode\n-   --    U16text      : Unicode UTF-16 encoding\n-   --    U8text       : Unicode UTF-8 encoding\n-   --\n-   --  This encoding is system dependent and only used on Windows systems.\n-   --\n-   --  Note that modifications to Content_Encoding must be synchronized\n-   --  with sysdep.c:__gnat_set_mode.\n-\n-   subtype Text_Content_Encoding\n-     is Content_Encoding range Default_Text .. U16text;\n-\n    type AFCB is tagged;\n    type AFCB_Ptr is access all AFCB'Class;\n \n@@ -135,7 +116,7 @@ package System.File_Control_Block is\n       Is_System_File : Boolean;\n       --  A flag set only for system files (stdin, stdout, stderr)\n \n-      Text_Encoding : Content_Encoding;\n+      Text_Encoding : Interfaces.C_Streams.Content_Encoding;\n       --  A flag set to describe file content encoding\n \n       Shared_Status : Shared_Status_Type;"}, {"sha": "8a9c9c10c53b906cb97fc3efc08dc191c5ce9097", "filename": "gcc/ada/s-fileio.adb", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cd077efd33fc56016b9bea8f30964fb93a40ff3a/gcc%2Fada%2Fs-fileio.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cd077efd33fc56016b9bea8f30964fb93a40ff3a/gcc%2Fada%2Fs-fileio.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fs-fileio.adb?ref=cd077efd33fc56016b9bea8f30964fb93a40ff3a", "patch": "@@ -1063,7 +1063,7 @@ package body System.File_IO is\n             elsif Formstr (V1 .. V2) = \"text\"\n               or else Formstr (V1 .. V2) = \"yes\"\n             then\n-               Text_Encoding := File_Control_Block.Text;\n+               Text_Encoding := Interfaces.C_Streams.Text;\n             elsif Formstr (V1 .. V2) = \"wtext\" then\n                Text_Encoding := Wtext;\n             elsif Formstr (V1 .. V2) = \"u8text\" then"}]}