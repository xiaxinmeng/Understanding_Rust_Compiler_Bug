{"sha": "b799a4819ae2c4002ca86c339ac6a2a1fb840bdf", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Yjc5OWE0ODE5YWUyYzQwMDJjYTg2YzMzOWFjNmEyYTFmYjg0MGJkZg==", "commit": {"author": {"name": "Alan Modra", "email": "amodra@gmail.com", "date": "2016-07-14T04:26:36Z"}, "committer": {"name": "Alan Modra", "email": "amodra@gcc.gnu.org", "date": "2016-07-14T04:26:36Z"}, "message": "[RS6000] -mno-vsx should force -mno-power9-dform\n\n\tPR target/71733\ngcc/\n\t* config/rs6000/rs6000.c (rs6000_option_override_internal): Deal\n\twith p9_vector override before power9-dform override.\ngcc/testsuite/\n\t* gcc.target/powerpc/p9-novsx.c: New.\n\nFrom-SVN: r238326", "tree": {"sha": "5c44e46fad4af99b65e3e5ff19692a6f488f7312", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5c44e46fad4af99b65e3e5ff19692a6f488f7312"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b799a4819ae2c4002ca86c339ac6a2a1fb840bdf", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b799a4819ae2c4002ca86c339ac6a2a1fb840bdf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b799a4819ae2c4002ca86c339ac6a2a1fb840bdf", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b799a4819ae2c4002ca86c339ac6a2a1fb840bdf/comments", "author": {"login": "amodra", "id": 6006325, "node_id": "MDQ6VXNlcjYwMDYzMjU=", "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4", "gravatar_id": "", "url": "https://api.github.com/users/amodra", "html_url": "https://github.com/amodra", "followers_url": "https://api.github.com/users/amodra/followers", "following_url": "https://api.github.com/users/amodra/following{/other_user}", "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}", "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/amodra/subscriptions", "organizations_url": "https://api.github.com/users/amodra/orgs", "repos_url": "https://api.github.com/users/amodra/repos", "events_url": "https://api.github.com/users/amodra/events{/privacy}", "received_events_url": "https://api.github.com/users/amodra/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "f63ba78ce6d50bf627dd18018179eb03bf89716f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f63ba78ce6d50bf627dd18018179eb03bf89716f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f63ba78ce6d50bf627dd18018179eb03bf89716f"}], "stats": {"total": 48, "additions": 40, "deletions": 8}, "files": [{"sha": "a1cf7424d9dfa6feaa759aee1ed98549cfa081f9", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b799a4819ae2c4002ca86c339ac6a2a1fb840bdf/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b799a4819ae2c4002ca86c339ac6a2a1fb840bdf/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=b799a4819ae2c4002ca86c339ac6a2a1fb840bdf", "patch": "@@ -1,3 +1,9 @@\n+2016-07-14  Alan Modra  <amodra@gmail.com>\n+\n+\tPR target/71733\n+\t* config/rs6000/rs6000.c (rs6000_option_override_internal): Deal\n+\twith p9_vector override before power9-dform override.\n+\n 2016-07-13  Andi Kleen  <ak@linux.intel.com>\n \n \t* value-prof.c (gimple_value_profile_transformations): Don't run"}, {"sha": "63655b1d267a86bd0facfec8dfc250bd30be89af", "filename": "gcc/config/rs6000/rs6000.c", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b799a4819ae2c4002ca86c339ac6a2a1fb840bdf/gcc%2Fconfig%2Frs6000%2Frs6000.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b799a4819ae2c4002ca86c339ac6a2a1fb840bdf/gcc%2Fconfig%2Frs6000%2Frs6000.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.c?ref=b799a4819ae2c4002ca86c339ac6a2a1fb840bdf", "patch": "@@ -4256,6 +4256,14 @@ rs6000_option_override_internal (bool global_init_p)\n       && !(rs6000_isa_flags_explicit & OPTION_MASK_TOC_FUSION))\n     rs6000_isa_flags |= OPTION_MASK_TOC_FUSION;\n \n+  /* ISA 3.0 vector instructions include ISA 2.07.  */\n+  if (TARGET_P9_VECTOR && !TARGET_P8_VECTOR)\n+    {\n+      if (rs6000_isa_flags_explicit & OPTION_MASK_P8_VECTOR)\n+\terror (\"-mpower9-vector requires -mpower8-vector\");\n+      rs6000_isa_flags &= ~OPTION_MASK_P9_VECTOR;\n+    }\n+\n   /* -mpower9-dform turns on both -mpower9-dform-scalar and\n       -mpower9-dform-vector.  */\n   if (TARGET_P9_DFORM_BOTH > 0)\n@@ -4298,14 +4306,6 @@ rs6000_option_override_internal (bool global_init_p)\n       rs6000_isa_flags &= ~OPTION_MASK_P9_DFORM_SCALAR;\n     }\n \n-  /* ISA 3.0 vector instructions include ISA 2.07.  */\n-  if (TARGET_P9_VECTOR && !TARGET_P8_VECTOR)\n-    {\n-      if (rs6000_isa_flags_explicit & OPTION_MASK_P8_VECTOR)\n-\terror (\"-mpower9-vector requires -mpower8-vector\");\n-      rs6000_isa_flags &= ~OPTION_MASK_P9_VECTOR;\n-    }\n-\n   /* There have been bugs with -mvsx-timode that don't show up with -mlra,\n      but do show up with -mno-lra.  Given -mlra will become the default once\n      PR 69847 is fixed, turn off the options with problems by default if"}, {"sha": "4591803c5fac69f6880113dc041b1f6bd0a1b35a", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b799a4819ae2c4002ca86c339ac6a2a1fb840bdf/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b799a4819ae2c4002ca86c339ac6a2a1fb840bdf/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=b799a4819ae2c4002ca86c339ac6a2a1fb840bdf", "patch": "@@ -1,3 +1,8 @@\n+2016-07-14  Alan Modra  <amodra@gmail.com>\n+\n+\tPR target/71733\n+\t* gcc.target/powerpc/p9-novsx.c: New.\n+\n 2016-07-13  Andi Kleen  <ak@linux.intel.com>\n \n \t* g++.dg/tree-prof/indir-call-prof.C: Basic fixes for autofdo."}, {"sha": "7e410307dd22b5996e8e116b5d1809d904a26678", "filename": "gcc/testsuite/gcc.target/powerpc/p9-novsx.c", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b799a4819ae2c4002ca86c339ac6a2a1fb840bdf/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fp9-novsx.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b799a4819ae2c4002ca86c339ac6a2a1fb840bdf/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fp9-novsx.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fp9-novsx.c?ref=b799a4819ae2c4002ca86c339ac6a2a1fb840bdf", "patch": "@@ -0,0 +1,21 @@\n+/* { dg-do compile } */\n+/* { dg-skip-if \"do not override -mcpu\" { powerpc*-*-* } { \"-mcpu=*\" } { \"-mcpu=power9\" } } */\n+/* { dg-options \"-mcpu=power9 -mno-vsx -O1\" } */\n+/* { dg-require-effective-target powerpc_altivec_ok } */\n+/* { dg-final { scan-assembler-times \"lvx %?v?2,%?r?3\" 1 } } */\n+/* { dg-final { scan-assembler-times \"stvx %?v?2,%?r?3\" 1 } } */\n+\n+/* PR target/71733.  */\n+typedef __attribute__ ((altivec(vector__), aligned(16))) unsigned char vec_t;\n+\n+vec_t\n+f1 (vec_t *dst)\n+{\n+  return dst[1];\n+}\n+\n+void\n+f2 (vec_t *dst, vec_t src)\n+{\n+  dst[1] = src;\n+}"}]}