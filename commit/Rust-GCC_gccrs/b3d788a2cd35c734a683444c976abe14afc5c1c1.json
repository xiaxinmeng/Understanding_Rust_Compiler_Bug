{"sha": "b3d788a2cd35c734a683444c976abe14afc5c1c1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjNkNzg4YTJjZDM1YzczNGE2ODM0NDRjOTc2YWJlMTRhZmM1YzFjMQ==", "commit": {"author": {"name": "David Malcolm", "email": "dmalcolm@redhat.com", "date": "2020-02-21T15:50:16Z"}, "committer": {"name": "David Malcolm", "email": "dmalcolm@redhat.com", "date": "2020-02-24T23:31:07Z"}, "message": "analyzer: disable the \"taint\" checker by default\n\nPR analyzer/93032 tracks a false negative where we fail to report\nFILE * leaks within zlib/contrib/minizip/mztools.c.\n\nThe underlying issue is a combinatorial explosion of states within the\nexploded graph.  In particular, the state of the \"taint\" checker is\nexploding, leading to the analyzer bailing out.\n\nI have a patch kit under construction that fixes the state explosion\nissue enough for the \"file\" checker to report the leaks, but doing so\nrequires disabling the \"taint\" checker.  Given that the latter is more\nof a proof-of-concept, this patch disables it by default, to stop it\nbreaking the other checkers.\n\ngcc/analyzer/ChangeLog:\n\tPR analyzer/93032\n\t* sm.cc (make_checkers): Require the \"taint\" checker to be\n\texplicitly enabled.\n\ngcc/ChangeLog:\n\tPR analyzer/93032\n\t* doc/invoke.texi (-Wnanalyzer-tainted-array-index): Note that\n\t-fanalyzer-checker=taint is also required.\n\t(-fanalyzer-checker=): Note that providing this option enables the\n\tgiven checker, and doing so may be required for checkers that are\n\tdisabled by default.\n\ngcc/testsuite/ChangeLog:\n\tPR analyzer/93032\n\t* gcc.dg/analyzer/pr93382.c: Add \"-fanalyzer-checker=taint\".\n\t* gcc.dg/analyzer/taint-1.c: Likewise.", "tree": {"sha": "9a80941ec6fca09563085b88e97d534efe7a7e39", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9a80941ec6fca09563085b88e97d534efe7a7e39"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b3d788a2cd35c734a683444c976abe14afc5c1c1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b3d788a2cd35c734a683444c976abe14afc5c1c1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b3d788a2cd35c734a683444c976abe14afc5c1c1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b3d788a2cd35c734a683444c976abe14afc5c1c1/comments", "author": {"login": "davidmalcolm", "id": 1553248, "node_id": "MDQ6VXNlcjE1NTMyNDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1553248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidmalcolm", "html_url": "https://github.com/davidmalcolm", "followers_url": "https://api.github.com/users/davidmalcolm/followers", "following_url": "https://api.github.com/users/davidmalcolm/following{/other_user}", "gists_url": "https://api.github.com/users/davidmalcolm/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidmalcolm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidmalcolm/subscriptions", "organizations_url": "https://api.github.com/users/davidmalcolm/orgs", "repos_url": "https://api.github.com/users/davidmalcolm/repos", "events_url": "https://api.github.com/users/davidmalcolm/events{/privacy}", "received_events_url": "https://api.github.com/users/davidmalcolm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "davidmalcolm", "id": 1553248, "node_id": "MDQ6VXNlcjE1NTMyNDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1553248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidmalcolm", "html_url": "https://github.com/davidmalcolm", "followers_url": "https://api.github.com/users/davidmalcolm/followers", "following_url": "https://api.github.com/users/davidmalcolm/following{/other_user}", "gists_url": "https://api.github.com/users/davidmalcolm/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidmalcolm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidmalcolm/subscriptions", "organizations_url": "https://api.github.com/users/davidmalcolm/orgs", "repos_url": "https://api.github.com/users/davidmalcolm/repos", "events_url": "https://api.github.com/users/davidmalcolm/events{/privacy}", "received_events_url": "https://api.github.com/users/davidmalcolm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3a25f345d1fbe2de8c12cae84b0c7d2a76c0b78e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3a25f345d1fbe2de8c12cae84b0c7d2a76c0b78e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3a25f345d1fbe2de8c12cae84b0c7d2a76c0b78e"}], "stats": {"total": 42, "additions": 38, "deletions": 4}, "files": [{"sha": "13f0356c9aecc035938663a9b33e8089b61d2e34", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b3d788a2cd35c734a683444c976abe14afc5c1c1/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b3d788a2cd35c734a683444c976abe14afc5c1c1/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=b3d788a2cd35c734a683444c976abe14afc5c1c1", "patch": "@@ -1,3 +1,12 @@\n+2020-02-24  David Malcolm  <dmalcolm@redhat.com>\n+\n+\tPR analyzer/93032\n+\t* doc/invoke.texi (-Wnanalyzer-tainted-array-index): Note that\n+\t-fanalyzer-checker=taint is also required.\n+\t(-fanalyzer-checker=): Note that providing this option enables the\n+\tgiven checker, and doing so may be required for checkers that are\n+\tdisabled by default.\n+\n 2020-02-24  David Malcolm  <dmalcolm@redhat.com>\n \n \t* doc/invoke.texi (-fanalyzer-verbosity=): \"2\" only shows"}, {"sha": "7511c2dc92f540702f10a06ea021dff8154e0857", "filename": "gcc/analyzer/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b3d788a2cd35c734a683444c976abe14afc5c1c1/gcc%2Fanalyzer%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b3d788a2cd35c734a683444c976abe14afc5c1c1/gcc%2Fanalyzer%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fanalyzer%2FChangeLog?ref=b3d788a2cd35c734a683444c976abe14afc5c1c1", "patch": "@@ -1,3 +1,9 @@\n+2020-02-24  David Malcolm  <dmalcolm@redhat.com>\n+\n+\tPR analyzer/93032\n+\t* sm.cc (make_checkers): Require the \"taint\" checker to be\n+\texplicitly enabled.\n+\n 2020-02-24  David Malcolm  <dmalcolm@redhat.com>\n \n \tPR analyzer/93899"}, {"sha": "b1f156fecc9af8b67ef20fcdfe5c0f052f791790", "filename": "gcc/analyzer/sm.cc", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b3d788a2cd35c734a683444c976abe14afc5c1c1/gcc%2Fanalyzer%2Fsm.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b3d788a2cd35c734a683444c976abe14afc5c1c1/gcc%2Fanalyzer%2Fsm.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fanalyzer%2Fsm.cc?ref=b3d788a2cd35c734a683444c976abe14afc5c1c1", "patch": "@@ -111,7 +111,10 @@ make_checkers (auto_delete_vec <state_machine> &out, logger *logger)\n {\n   out.safe_push (make_malloc_state_machine (logger));\n   out.safe_push (make_fileptr_state_machine (logger));\n-  out.safe_push (make_taint_state_machine (logger));\n+  /* The \"taint\" checker must be explicitly enabled (as it currently\n+     leads to state explosions that stop the other checkers working).  */\n+  if (flag_analyzer_checker)\n+    out.safe_push (make_taint_state_machine (logger));\n   out.safe_push (make_sensitive_state_machine (logger));\n   out.safe_push (make_signal_state_machine (logger));\n "}, {"sha": "208500c767906ce2309dfb8ebf742b81946b889e", "filename": "gcc/doc/invoke.texi", "status": "modified", "additions": 9, "deletions": 3, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b3d788a2cd35c734a683444c976abe14afc5c1c1/gcc%2Fdoc%2Finvoke.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b3d788a2cd35c734a683444c976abe14afc5c1c1/gcc%2Fdoc%2Finvoke.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdoc%2Finvoke.texi?ref=b3d788a2cd35c734a683444c976abe14afc5c1c1", "patch": "@@ -6629,8 +6629,9 @@ no longer exists, and likely lead to a crash (or worse).\n @item -Wno-analyzer-tainted-array-index\n @opindex Wanalyzer-tainted-array-index\n @opindex Wno-analyzer-tainted-array-index\n-This warning requires @option{-fanalyzer}, which enables it; use\n-@option{-Wno-analyzer-tainted-array-index} to disable it.\n+This warning requires both @option{-fanalyzer} and\n+@option{-fanalyzer-checker=taint} to enable it;\n+use @option{-Wno-analyzer-tainted-array-index} to disable it.\n \n This diagnostic warns for paths through the code in which a value\n that could be under an attacker's control is used as the index\n@@ -8436,7 +8437,12 @@ call site, and that are sufficiently complicated (as per\n \n @item -fanalyzer-checker=@var{name}\n @opindex fanalyzer-checker\n-Restrict the analyzer to run just the named checker.\n+Restrict the analyzer to run just the named checker, and enable it.\n+\n+Some checkers are disabled by default (even with @option{-fanalyzer}),\n+such as the @code{taint} checker that implements\n+@option{-Wanalyzer-tainted-array-index}, and this option is required\n+to enable them.\n \n @item -fanalyzer-fine-grained\n @opindex fanalyzer-fine-grained"}, {"sha": "fa451c6d4d531ded52a75080febfa94675242f7a", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b3d788a2cd35c734a683444c976abe14afc5c1c1/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b3d788a2cd35c734a683444c976abe14afc5c1c1/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=b3d788a2cd35c734a683444c976abe14afc5c1c1", "patch": "@@ -1,3 +1,9 @@\n+2020-02-24  David Malcolm  <dmalcolm@redhat.com>\n+\n+\tPR analyzer/93032\n+\t* gcc.dg/analyzer/pr93382.c: Add \"-fanalyzer-checker=taint\".\n+\t* gcc.dg/analyzer/taint-1.c: Likewise.\n+\n 2020-02-24  David Malcolm  <dmalcolm@redhat.com>\n \n \tPR analyzer/93899"}, {"sha": "dae32f5a2bb6540b7941578c13e890c43864ef75", "filename": "gcc/testsuite/gcc.dg/analyzer/pr93382.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b3d788a2cd35c734a683444c976abe14afc5c1c1/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fpr93382.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b3d788a2cd35c734a683444c976abe14afc5c1c1/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fpr93382.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fpr93382.c?ref=b3d788a2cd35c734a683444c976abe14afc5c1c1", "patch": "@@ -1,3 +1,5 @@\n+/* { dg-additional-options \"-fanalyzer-checker=taint\" } */\n+\n typedef __SIZE_TYPE__ size_t;\n \n int idx;"}, {"sha": "549e2660284ce23683fdb2b24b7d2185e679fc6e", "filename": "gcc/testsuite/gcc.dg/analyzer/taint-1.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b3d788a2cd35c734a683444c976abe14afc5c1c1/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ftaint-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b3d788a2cd35c734a683444c976abe14afc5c1c1/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ftaint-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ftaint-1.c?ref=b3d788a2cd35c734a683444c976abe14afc5c1c1", "patch": "@@ -1,3 +1,5 @@\n+/* { dg-additional-options \"-fanalyzer-checker=taint\" } */\n+\n #include <stdio.h>\n #include <stdlib.h>\n #include <string.h>"}]}