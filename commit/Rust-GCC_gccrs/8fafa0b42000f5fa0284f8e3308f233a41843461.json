{"sha": "8fafa0b42000f5fa0284f8e3308f233a41843461", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OGZhZmEwYjQyMDAwZjVmYTAyODRmOGUzMzA4ZjIzM2E0MTg0MzQ2MQ==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2019-08-19T08:37:28Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "pmderodat@gcc.gnu.org", "date": "2019-08-19T08:37:28Z"}, "message": "[Ada] Fix bogus compilation error with Elaborate_Body and -gnatN\n\nThis fixes a bogus compilation error when a unit with SPARK_Mode\ncontaining a pragma Elaborate_Body is with-ed by a generic unit\ncontaining an inlined subprogram, and front-end inlining is enabled.\n\n2019-08-19  Eric Botcazou  <ebotcazou@adacore.com>\n\ngcc/ada/\n\n\t* sem_prag.adb (Is_Before_First_Decl): Deal with rewritten\n\tpragmas.\n\ngcc/testsuite/\n\n\t* gnat.dg/elab8.adb, gnat.dg/elab8_gen.adb,\n\tgnat.dg/elab8_gen.ads, gnat.dg/elab8_pkg.adb,\n\tgnat.dg/elab8_pkg.ads: New testcase.\n\nFrom-SVN: r274664", "tree": {"sha": "ce45a4edde11db39c89e24ba0f81d0fe935e479e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ce45a4edde11db39c89e24ba0f81d0fe935e479e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8fafa0b42000f5fa0284f8e3308f233a41843461", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8fafa0b42000f5fa0284f8e3308f233a41843461", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8fafa0b42000f5fa0284f8e3308f233a41843461", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8fafa0b42000f5fa0284f8e3308f233a41843461/comments", "author": null, "committer": null, "parents": [{"sha": "bfa6962fc25e2e24b3a5299095e933f9b57bb6e0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bfa6962fc25e2e24b3a5299095e933f9b57bb6e0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bfa6962fc25e2e24b3a5299095e933f9b57bb6e0"}], "stats": {"total": 58, "additions": 56, "deletions": 2}, "files": [{"sha": "f01e411b037bf19725f8fa0b0a5755362e9f4037", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8fafa0b42000f5fa0284f8e3308f233a41843461/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8fafa0b42000f5fa0284f8e3308f233a41843461/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=8fafa0b42000f5fa0284f8e3308f233a41843461", "patch": "@@ -1,3 +1,8 @@\n+2019-08-19  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* sem_prag.adb (Is_Before_First_Decl): Deal with rewritten\n+\tpragmas.\n+\n 2019-08-19  Bob Duff  <duff@adacore.com>\n \n \t* sem_warn.adb (Warn_On_Unreferenced_Entity): Suppress warning"}, {"sha": "993a419df090e6a3f4691334b6011b9642e84ed6", "filename": "gcc/ada/sem_prag.adb", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8fafa0b42000f5fa0284f8e3308f233a41843461/gcc%2Fada%2Fsem_prag.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8fafa0b42000f5fa0284f8e3308f233a41843461/gcc%2Fada%2Fsem_prag.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_prag.adb?ref=8fafa0b42000f5fa0284f8e3308f233a41843461", "patch": "@@ -7146,10 +7146,11 @@ package body Sem_Prag is\n          Item : Node_Id := First (Decls);\n \n       begin\n-         --  Only other pragmas can come before this pragma\n+         --  Only other pragmas can come before this pragma, but they might\n+         --  have been rewritten so check the original node.\n \n          loop\n-            if No (Item) or else Nkind (Item) /= N_Pragma then\n+            if No (Item) or else Nkind (Original_Node (Item)) /= N_Pragma then\n                return False;\n \n             elsif Item = Pragma_Node then"}, {"sha": "f20c466ffadebe0a0505baaa5741655df2f0ec96", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8fafa0b42000f5fa0284f8e3308f233a41843461/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8fafa0b42000f5fa0284f8e3308f233a41843461/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=8fafa0b42000f5fa0284f8e3308f233a41843461", "patch": "@@ -1,3 +1,9 @@\n+2019-08-19  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* gnat.dg/elab8.adb, gnat.dg/elab8_gen.adb,\n+\tgnat.dg/elab8_gen.ads, gnat.dg/elab8_pkg.adb,\n+\tgnat.dg/elab8_pkg.ads: New testcase.\n+\n 2019-08-19  Bob Duff  <duff@adacore.com>\n \n \t* gnat.dg/warn29.adb, gnat.dg/warn29.ads: New testcase."}, {"sha": "a54ba9d53f8c0c66393da07e7a1c49065357b460", "filename": "gcc/testsuite/gnat.dg/elab8.adb", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8fafa0b42000f5fa0284f8e3308f233a41843461/gcc%2Ftestsuite%2Fgnat.dg%2Felab8.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8fafa0b42000f5fa0284f8e3308f233a41843461/gcc%2Ftestsuite%2Fgnat.dg%2Felab8.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Felab8.adb?ref=8fafa0b42000f5fa0284f8e3308f233a41843461", "patch": "@@ -0,0 +1,12 @@\n+--  { dg-do compile }\n+--  { dg-options \"-gnatN\" }\n+\n+with Elab8_Gen;\n+\n+procedure Elab8 is\n+\n+  package My_G is new Elab8_Gen  (Integer);\n+\n+begin\n+  My_G.Compare (0, 1);\n+end;"}, {"sha": "fbb09b91f3c80f2cbd743268ca8496536f4adf31", "filename": "gcc/testsuite/gnat.dg/elab8_gen.adb", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8fafa0b42000f5fa0284f8e3308f233a41843461/gcc%2Ftestsuite%2Fgnat.dg%2Felab8_gen.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8fafa0b42000f5fa0284f8e3308f233a41843461/gcc%2Ftestsuite%2Fgnat.dg%2Felab8_gen.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Felab8_gen.adb?ref=8fafa0b42000f5fa0284f8e3308f233a41843461", "patch": "@@ -0,0 +1,12 @@\n+with Elab8_Pkg;\n+\n+package body Elab8_Gen is\n+\n+  procedure Compare (Arg1, Arg2 : T) is\n+  begin\n+    if Arg1 = Arg2 then\n+      raise Program_Error;\n+    end if;\n+  end;\n+\n+end Elab8_Gen;"}, {"sha": "8125407c45bf34fd504b128c81eb80ac2805c555", "filename": "gcc/testsuite/gnat.dg/elab8_gen.ads", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8fafa0b42000f5fa0284f8e3308f233a41843461/gcc%2Ftestsuite%2Fgnat.dg%2Felab8_gen.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8fafa0b42000f5fa0284f8e3308f233a41843461/gcc%2Ftestsuite%2Fgnat.dg%2Felab8_gen.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Felab8_gen.ads?ref=8fafa0b42000f5fa0284f8e3308f233a41843461", "patch": "@@ -0,0 +1,8 @@\n+generic\n+  type T is private;\n+package Elab8_Gen is\n+\n+  procedure Compare (Arg1, Arg2 : T);\n+  pragma Inline (Compare);\n+\n+end Elab8_Gen;"}, {"sha": "451d4e434c3678e0764e67d4dccac061754120b5", "filename": "gcc/testsuite/gnat.dg/elab8_pkg.adb", "status": "added", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8fafa0b42000f5fa0284f8e3308f233a41843461/gcc%2Ftestsuite%2Fgnat.dg%2Felab8_pkg.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8fafa0b42000f5fa0284f8e3308f233a41843461/gcc%2Ftestsuite%2Fgnat.dg%2Felab8_pkg.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Felab8_pkg.adb?ref=8fafa0b42000f5fa0284f8e3308f233a41843461", "patch": "@@ -0,0 +1,5 @@\n+package body Elab8_Pkg is\n+\n+  procedure Dummy is null;\n+\n+end Elab8_Pkg;"}, {"sha": "8bf46036a366838a2edc2b4abafc9195f789058d", "filename": "gcc/testsuite/gnat.dg/elab8_pkg.ads", "status": "added", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8fafa0b42000f5fa0284f8e3308f233a41843461/gcc%2Ftestsuite%2Fgnat.dg%2Felab8_pkg.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8fafa0b42000f5fa0284f8e3308f233a41843461/gcc%2Ftestsuite%2Fgnat.dg%2Felab8_pkg.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Felab8_pkg.ads?ref=8fafa0b42000f5fa0284f8e3308f233a41843461", "patch": "@@ -0,0 +1,5 @@\n+package Elab8_Pkg with SPARK_Mode is\n+\n+  pragma Elaborate_Body;\n+\n+end Elab8_Pkg;"}]}