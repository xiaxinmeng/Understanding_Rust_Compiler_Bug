{"sha": "75d053df7271cc0f841d3790196a14c896214bb4", "node_id": "C_kwDOANBUbNoAKDc1ZDA1M2RmNzI3MWNjMGY4NDFkMzc5MDE5NmExNGM4OTYyMTRiYjQ", "commit": {"author": {"name": "Aldy Hernandez", "email": "aldyh@redhat.com", "date": "2021-10-01T10:27:55Z"}, "committer": {"name": "Aldy Hernandez", "email": "aldyh@redhat.com", "date": "2021-10-01T12:43:54Z"}, "message": "Remove shadowed oracle field.\n\nThe m_oracle field in the path solver was shadowing the base class.\nThis was causing subtle problems while calculating outgoing edges\nbetween blocks, because the query object being passed did not have an\noracle set.\n\nThis should further improve our solving ability.\n\nTested on x86-64 Linux.\n\ngcc/ChangeLog:\n\n\t* gimple-range-path.cc (path_range_query::compute_ranges): Use\n\tget_path_oracle.\n\t* gimple-range-path.h (class path_range_query): Remove shadowed\n\tm_oracle field.\n\t(path_range_query::get_path_oracle): New.", "tree": {"sha": "aafef2d2c632979e9e61bd7be383816cf857098e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/aafef2d2c632979e9e61bd7be383816cf857098e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/75d053df7271cc0f841d3790196a14c896214bb4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/75d053df7271cc0f841d3790196a14c896214bb4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/75d053df7271cc0f841d3790196a14c896214bb4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/75d053df7271cc0f841d3790196a14c896214bb4/comments", "author": {"login": "aldyh", "id": 12937877, "node_id": "MDQ6VXNlcjEyOTM3ODc3", "avatar_url": "https://avatars.githubusercontent.com/u/12937877?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aldyh", "html_url": "https://github.com/aldyh", "followers_url": "https://api.github.com/users/aldyh/followers", "following_url": "https://api.github.com/users/aldyh/following{/other_user}", "gists_url": "https://api.github.com/users/aldyh/gists{/gist_id}", "starred_url": "https://api.github.com/users/aldyh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aldyh/subscriptions", "organizations_url": "https://api.github.com/users/aldyh/orgs", "repos_url": "https://api.github.com/users/aldyh/repos", "events_url": "https://api.github.com/users/aldyh/events{/privacy}", "received_events_url": "https://api.github.com/users/aldyh/received_events", "type": "User", "site_admin": false}, "committer": {"login": "aldyh", "id": 12937877, "node_id": "MDQ6VXNlcjEyOTM3ODc3", "avatar_url": "https://avatars.githubusercontent.com/u/12937877?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aldyh", "html_url": "https://github.com/aldyh", "followers_url": "https://api.github.com/users/aldyh/followers", "following_url": "https://api.github.com/users/aldyh/following{/other_user}", "gists_url": "https://api.github.com/users/aldyh/gists{/gist_id}", "starred_url": "https://api.github.com/users/aldyh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aldyh/subscriptions", "organizations_url": "https://api.github.com/users/aldyh/orgs", "repos_url": "https://api.github.com/users/aldyh/repos", "events_url": "https://api.github.com/users/aldyh/events{/privacy}", "received_events_url": "https://api.github.com/users/aldyh/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9c1a633d96926357155d4702b66f8a0ec856a81f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9c1a633d96926357155d4702b66f8a0ec856a81f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9c1a633d96926357155d4702b66f8a0ec856a81f"}], "stats": {"total": 5, "additions": 2, "deletions": 3}, "files": [{"sha": "422abfddb8f4199959035f451304cb6cbac4edd2", "filename": "gcc/gimple-range-path.cc", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/75d053df7271cc0f841d3790196a14c896214bb4/gcc%2Fgimple-range-path.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/75d053df7271cc0f841d3790196a14c896214bb4/gcc%2Fgimple-range-path.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgimple-range-path.cc?ref=75d053df7271cc0f841d3790196a14c896214bb4", "patch": "@@ -480,7 +480,7 @@ path_range_query::compute_ranges (const vec<basic_block> &path,\n   if (m_resolve)\n     {\n       add_copies_to_imports ();\n-      m_oracle->reset_path ();\n+      get_path_oracle ()->reset_path ();\n       compute_relations (path);\n     }\n "}, {"sha": "5f4e73a594938ff1b84aadb8839569d09d03592b", "filename": "gcc/gimple-range-path.h", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/75d053df7271cc0f841d3790196a14c896214bb4/gcc%2Fgimple-range-path.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/75d053df7271cc0f841d3790196a14c896214bb4/gcc%2Fgimple-range-path.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgimple-range-path.h?ref=75d053df7271cc0f841d3790196a14c896214bb4", "patch": "@@ -38,14 +38,14 @@ class path_range_query : public range_query\n   bool range_of_expr (irange &r, tree name, gimple * = NULL) override;\n   bool range_of_stmt (irange &r, gimple *, tree name = NULL) override;\n   bool unreachable_path_p ();\n-  path_oracle *oracle () { return m_oracle; }\n   void dump (FILE *) override;\n   void debug ();\n \n private:\n   bool internal_range_of_expr (irange &r, tree name, gimple *);\n   bool defined_outside_path (tree name);\n   void range_on_path_entry (irange &r, tree name);\n+  path_oracle *get_path_oracle () { return (path_oracle *)m_oracle; }\n \n   // Cache manipulation.\n   void set_cache (const irange &r, tree name);\n@@ -85,7 +85,6 @@ class path_range_query : public range_query\n   auto_bitmap m_imports;\n   gimple_ranger &m_ranger;\n   non_null_ref m_non_null;\n-  path_oracle *m_oracle;\n \n   // Current path position.\n   unsigned m_pos;"}]}