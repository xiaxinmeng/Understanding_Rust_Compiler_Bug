{"sha": "7a06d606a6a5d81acae07c94490217c55278476b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2EwNmQ2MDZhNmE1ZDgxYWNhZTA3Yzk0NDkwMjE3YzU1Mjc4NDc2Yg==", "commit": {"author": {"name": "Richard Kenner", "email": "kenner@vlsi1.ultra.nyu.edu", "date": "2003-10-10T19:21:12Z"}, "committer": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "2003-10-10T19:21:12Z"}, "message": "stor-layout.c (compute_record_mode): Don't force BLKmode if field is zero-length BLKmode.\n\n\t* stor-layout.c (compute_record_mode): Don't force BLKmode if\n\tfield is zero-length BLKmode.\n\t* expr.c (expand_expr, case COMPONENT_REF): Handle case of BLKmode\n\tzero-size references.\n\nFrom-SVN: r72311", "tree": {"sha": "7722b6ab3f8762ae29f0ecc9ce017162d94cdd55", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7722b6ab3f8762ae29f0ecc9ce017162d94cdd55"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7a06d606a6a5d81acae07c94490217c55278476b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7a06d606a6a5d81acae07c94490217c55278476b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7a06d606a6a5d81acae07c94490217c55278476b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7a06d606a6a5d81acae07c94490217c55278476b/comments", "author": null, "committer": null, "parents": [{"sha": "892c9f1f53581abe563e6e0183fbc05936d10e95", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/892c9f1f53581abe563e6e0183fbc05936d10e95", "html_url": "https://github.com/Rust-GCC/gccrs/commit/892c9f1f53581abe563e6e0183fbc05936d10e95"}], "stats": {"total": 23, "additions": 17, "deletions": 6}, "files": [{"sha": "8f659510653ac04098184ecf3f3a2ac0e2be5dbf", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7a06d606a6a5d81acae07c94490217c55278476b/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7a06d606a6a5d81acae07c94490217c55278476b/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=7a06d606a6a5d81acae07c94490217c55278476b", "patch": "@@ -1,5 +1,10 @@\n 2003-10-10  Richard Kenner  <kenner@vlsi1.ultra.nyu.edu>\n \n+\t* stor-layout.c (compute_record_mode): Don't force BLKmode if\n+\tfield is zero-length BLKmode.\n+\t* expr.c (expand_expr, case COMPONENT_REF): Handle case of BLKmode\n+\tzero-size references.\n+\n \t* combine.c (distribute_links): Properly test for REG being set.\n \n \t* config/alpha/alpha.c (alpha_expand_block_mode): Don't use"}, {"sha": "54bff3f5be2c59b368223f1c9a4e1c11168b2c6a", "filename": "gcc/expr.c", "status": "modified", "additions": 9, "deletions": 5, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7a06d606a6a5d81acae07c94490217c55278476b/gcc%2Fexpr.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7a06d606a6a5d81acae07c94490217c55278476b/gcc%2Fexpr.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fexpr.c?ref=7a06d606a6a5d81acae07c94490217c55278476b", "patch": "@@ -7223,18 +7223,22 @@ expand_expr (tree exp, rtx target, enum machine_mode tmode,\n \n \t    if (ext_mode == BLKmode)\n \t      {\n+\t\tif (target == 0)\n+\t\t  target = assign_temp (type, 0, 1, 1);\n+\n+\t\tif (bitsize == 0)\n+\t\t  return target;\n+\n \t\t/* In this case, BITPOS must start at a byte boundary and\n \t\t   TARGET, if specified, must be a MEM.  */\n \t\tif (GET_CODE (op0) != MEM\n \t\t    || (target != 0 && GET_CODE (target) != MEM)\n \t\t    || bitpos % BITS_PER_UNIT != 0)\n \t\t  abort ();\n \n-\t\top0 = adjust_address (op0, VOIDmode, bitpos / BITS_PER_UNIT);\n-\t\tif (target == 0)\n-\t\t  target = assign_temp (type, 0, 1, 1);\n-\n-\t\temit_block_move (target, op0,\n+\t\temit_block_move (target,\n+\t\t\t\t adjust_address (op0, VOIDmode,\n+\t\t\t\t\t\t bitpos / BITS_PER_UNIT),\n \t\t\t\t GEN_INT ((bitsize + BITS_PER_UNIT - 1)\n \t\t\t\t\t  / BITS_PER_UNIT),\n \t\t\t\t (modifier == EXPAND_STACK_PARM"}, {"sha": "a7ffd4cb6d838f921a89070de720c0a18b6813a7", "filename": "gcc/stor-layout.c", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7a06d606a6a5d81acae07c94490217c55278476b/gcc%2Fstor-layout.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7a06d606a6a5d81acae07c94490217c55278476b/gcc%2Fstor-layout.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fstor-layout.c?ref=7a06d606a6a5d81acae07c94490217c55278476b", "patch": "@@ -1318,7 +1318,9 @@ compute_record_mode (tree type)\n \n       if (TREE_CODE (TREE_TYPE (field)) == ERROR_MARK\n \t  || (TYPE_MODE (TREE_TYPE (field)) == BLKmode\n-\t      && ! TYPE_NO_FORCE_BLK (TREE_TYPE (field)))\n+\t      && ! TYPE_NO_FORCE_BLK (TREE_TYPE (field))\n+\t      && !(TYPE_SIZE (TREE_TYPE (field)) != 0\n+\t\t   && integer_zerop (TYPE_SIZE (TREE_TYPE (field)))))\n \t  || ! host_integerp (bit_position (field), 1)\n \t  || DECL_SIZE (field) == 0\n \t  || ! host_integerp (DECL_SIZE (field), 1))"}]}