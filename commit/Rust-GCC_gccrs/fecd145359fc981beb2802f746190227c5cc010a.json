{"sha": "fecd145359fc981beb2802f746190227c5cc010a", "node_id": "C_kwDOANBUbNoAKGZlY2QxNDUzNTlmYzk4MWJlYjI4MDJmNzQ2MTkwMjI3YzVjYzAxMGE", "commit": {"author": {"name": "Jan Hubicka", "email": "hubicka@ucw.cz", "date": "2021-10-14T13:48:01Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@ucw.cz", "date": "2021-10-14T13:48:01Z"}, "message": "Fix ICE in insert_access.\n\ngcc/ChangeLog:\n\n\tPR ipa/102557\n\t* ipa-modref-tree.h (modref_access_node::update2):\n\tAlso check that parm_offset is unchanged.\n\t(modref_ref_node::insert_access): Fix updating of\n\tparameter.", "tree": {"sha": "7cce736513c6c30f5575f25272550c3c33c23452", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7cce736513c6c30f5575f25272550c3c33c23452"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/fecd145359fc981beb2802f746190227c5cc010a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fecd145359fc981beb2802f746190227c5cc010a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fecd145359fc981beb2802f746190227c5cc010a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fecd145359fc981beb2802f746190227c5cc010a/comments", "author": null, "committer": null, "parents": [{"sha": "27dea0b42c773a53817960d006160642892fe145", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/27dea0b42c773a53817960d006160642892fe145", "html_url": "https://github.com/Rust-GCC/gccrs/commit/27dea0b42c773a53817960d006160642892fe145"}], "stats": {"total": 16, "additions": 8, "deletions": 8}, "files": [{"sha": "9976e489697e5db1578021b591faaec2a116e8ac", "filename": "gcc/ipa-modref-tree.h", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fecd145359fc981beb2802f746190227c5cc010a/gcc%2Fipa-modref-tree.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fecd145359fc981beb2802f746190227c5cc010a/gcc%2Fipa-modref-tree.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-modref-tree.h?ref=fecd145359fc981beb2802f746190227c5cc010a", "patch": "@@ -148,7 +148,8 @@ struct GTY(()) modref_access_node\n \t       poly_int64 offset1, poly_int64 size1, poly_int64 max_size1,\n \t       bool record_adjustments)\n     {\n-      if (known_eq (offset, offset1)\n+      if (known_eq (parm_offset, parm_offset1)\n+\t  && known_eq (offset, offset1)\n \t  && known_eq (size, size1)\n \t  && known_eq (max_size, max_size1))\n \treturn;\n@@ -404,13 +405,9 @@ struct GTY(()) modref_access_node\n \tnew_max_size = max_size2;\n       else\n \t{\n-\t  max_size2 = max_size2 + offset2 - offset1;\n-\t  if (known_le (max_size, max_size2))\n-\t    new_max_size = max_size2;\n-\t  else if (known_le (max_size2, max_size))\n-\t    new_max_size = max_size;\n-\t  else\n-\t    gcc_unreachable ();\n+\t  new_max_size = max_size2 + offset2 - offset1;\n+\t  if (known_le (new_max_size, max_size1))\n+\t    new_max_size = max_size1;\n \t}\n \n       update (parm_offset1, offset1,\n@@ -577,6 +574,9 @@ struct GTY((user)) modref_ref_node\n \t  }\n \t(*accesses)[best1].forced_merge (best2 < 0 ? a : (*accesses)[best2],\n \t\t\t\t\t record_adjustments);\n+\t/* Check that merging indeed merged ranges.  */\n+\tgcc_checking_assert ((*accesses)[best1].contains\n+\t\t\t\t (best2 < 0 ? a : (*accesses)[best2]));\n \tif (!(*accesses)[best1].useful_p ())\n \t  {\n \t    collapse ();"}]}