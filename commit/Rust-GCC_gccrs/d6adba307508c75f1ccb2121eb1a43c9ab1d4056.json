{"sha": "d6adba307508c75f1ccb2121eb1a43c9ab1d4056", "node_id": "C_kwDOANBUbNoAKGQ2YWRiYTMwNzUwOGM3NWYxY2NiMjEyMWViMWE0M2M5YWIxZDQwNTY", "commit": {"author": {"name": "Thomas Schwinge", "email": "thomas@codesourcery.com", "date": "2022-04-06T09:31:45Z"}, "committer": {"name": "Thomas Schwinge", "email": "thomas@codesourcery.com", "date": "2022-05-11T12:24:55Z"}, "message": "libgomp GCN plugin: Clean up unused references to system-provided HSA Runtime library\n\nThis is only active if GCC is 'configure'd with '--with-hsa-runtime=[...]' or\n'--with-hsa-runtime-include=[...]', '--with-hsa-runtime-lib=[...]' -- which\nnobody really is doing, as far as I can tell.\n\nOriginally changed for the libgomp HSA plugin in\ncommit b8d89b03db5f212919e4571671ebb4f5f8b1e19d (r242749)\n\"Remove build dependence on HSA run-time\", and later propagated into the GCN\nplugin, these are no longer built against system-provided HSA Runtime library.\nInstead, unconditionally built against the GCC-shipped 'include/hsa*.h' header\nfiles, and at run time does 'dlopen(\"libhsa-runtime64.so.1\")'.  It thus doesn't\nmake sense to consider references to system-provided HSA Runtime library during\nlibgomp GCN plugin build.\n\n\tlibgomp/\n\t* plugin/configfrag.ac (HSA_RUNTIME_CPPFLAGS)\n\t(HSA_RUNTIME_LDFLAGS): Remove.\n\t* configure: Regenerate.", "tree": {"sha": "8c40961cd8a27ab0afeac6bd150d542b5603fd54", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8c40961cd8a27ab0afeac6bd150d542b5603fd54"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d6adba307508c75f1ccb2121eb1a43c9ab1d4056", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d6adba307508c75f1ccb2121eb1a43c9ab1d4056", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d6adba307508c75f1ccb2121eb1a43c9ab1d4056", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d6adba307508c75f1ccb2121eb1a43c9ab1d4056/comments", "author": {"login": "tschwinge", "id": 21753, "node_id": "MDQ6VXNlcjIxNzUz", "avatar_url": "https://avatars.githubusercontent.com/u/21753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tschwinge", "html_url": "https://github.com/tschwinge", "followers_url": "https://api.github.com/users/tschwinge/followers", "following_url": "https://api.github.com/users/tschwinge/following{/other_user}", "gists_url": "https://api.github.com/users/tschwinge/gists{/gist_id}", "starred_url": "https://api.github.com/users/tschwinge/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tschwinge/subscriptions", "organizations_url": "https://api.github.com/users/tschwinge/orgs", "repos_url": "https://api.github.com/users/tschwinge/repos", "events_url": "https://api.github.com/users/tschwinge/events{/privacy}", "received_events_url": "https://api.github.com/users/tschwinge/received_events", "type": "User", "site_admin": false}, "committer": {"login": "tschwinge", "id": 21753, "node_id": "MDQ6VXNlcjIxNzUz", "avatar_url": "https://avatars.githubusercontent.com/u/21753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tschwinge", "html_url": "https://github.com/tschwinge", "followers_url": "https://api.github.com/users/tschwinge/followers", "following_url": "https://api.github.com/users/tschwinge/following{/other_user}", "gists_url": "https://api.github.com/users/tschwinge/gists{/gist_id}", "starred_url": "https://api.github.com/users/tschwinge/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tschwinge/subscriptions", "organizations_url": "https://api.github.com/users/tschwinge/orgs", "repos_url": "https://api.github.com/users/tschwinge/repos", "events_url": "https://api.github.com/users/tschwinge/events{/privacy}", "received_events_url": "https://api.github.com/users/tschwinge/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2e309a4eff80e55b53d32d26926a2a94eabfea21", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2e309a4eff80e55b53d32d26926a2a94eabfea21", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2e309a4eff80e55b53d32d26926a2a94eabfea21"}], "stats": {"total": 20, "additions": 0, "deletions": 20}, "files": [{"sha": "cf1d1fbe195d7bcd4e9e2b680b4203baad9493bf", "filename": "libgomp/configure", "status": "modified", "additions": 0, "deletions": 10, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d6adba307508c75f1ccb2121eb1a43c9ab1d4056/libgomp%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d6adba307508c75f1ccb2121eb1a43c9ab1d4056/libgomp%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Fconfigure?ref=d6adba307508c75f1ccb2121eb1a43c9ab1d4056", "patch": "@@ -15244,8 +15244,6 @@ HSA_RUNTIME_INCLUDE=\n HSA_RUNTIME_LIB=\n \n \n-HSA_RUNTIME_CPPFLAGS=\n-HSA_RUNTIME_LDFLAGS=\n \n \n # Check whether --with-hsa-runtime was given.\n@@ -15275,12 +15273,6 @@ fi\n if test \"x$with_hsa_runtime_lib\" != x; then\n   HSA_RUNTIME_LIB=$with_hsa_runtime_lib\n fi\n-if test \"x$HSA_RUNTIME_INCLUDE\" != x; then\n-  HSA_RUNTIME_CPPFLAGS=-I$HSA_RUNTIME_INCLUDE\n-fi\n-if test \"x$HSA_RUNTIME_LIB\" != x; then\n-  HSA_RUNTIME_LDFLAGS=-L$HSA_RUNTIME_LIB\n-fi\n \n PLUGIN_GCN=0\n PLUGIN_GCN_CPPFLAGS=\n@@ -15389,8 +15381,6 @@ rm -f core conftest.err conftest.$ac_objext \\\n \t      *)\n \t\ttgt_plugin=gcn\n \t\tPLUGIN_GCN=$tgt\n-\t\tPLUGIN_GCN_CPPFLAGS=$HSA_RUNTIME_CPPFLAGS\n-\t\tPLUGIN_GCN_LDFLAGS=\"$HSA_RUNTIME_LDFLAGS\"\n \t\tPLUGIN_GCN_LIBS=\"-ldl\"\n \t\tPLUGIN_GCN=1\n \t\t;;"}, {"sha": "52c3da09b43d48b422d26ec28eff80ae934ebdb5", "filename": "libgomp/plugin/configfrag.ac", "status": "modified", "additions": 0, "deletions": 10, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d6adba307508c75f1ccb2121eb1a43c9ab1d4056/libgomp%2Fplugin%2Fconfigfrag.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d6adba307508c75f1ccb2121eb1a43c9ab1d4056/libgomp%2Fplugin%2Fconfigfrag.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Fplugin%2Fconfigfrag.ac?ref=d6adba307508c75f1ccb2121eb1a43c9ab1d4056", "patch": "@@ -97,8 +97,6 @@ HSA_RUNTIME_INCLUDE=\n HSA_RUNTIME_LIB=\n AC_SUBST(HSA_RUNTIME_INCLUDE)\n AC_SUBST(HSA_RUNTIME_LIB)\n-HSA_RUNTIME_CPPFLAGS=\n-HSA_RUNTIME_LDFLAGS=\n \n AC_ARG_WITH(hsa-runtime,\n \t[AS_HELP_STRING([--with-hsa-runtime=PATH],\n@@ -121,12 +119,6 @@ fi\n if test \"x$with_hsa_runtime_lib\" != x; then\n   HSA_RUNTIME_LIB=$with_hsa_runtime_lib\n fi\n-if test \"x$HSA_RUNTIME_INCLUDE\" != x; then\n-  HSA_RUNTIME_CPPFLAGS=-I$HSA_RUNTIME_INCLUDE\n-fi\n-if test \"x$HSA_RUNTIME_LIB\" != x; then\n-  HSA_RUNTIME_LDFLAGS=-L$HSA_RUNTIME_LIB\n-fi\n \n PLUGIN_GCN=0\n PLUGIN_GCN_CPPFLAGS=\n@@ -224,8 +216,6 @@ if test x\"$enable_offload_targets\" != x; then\n \t      *)\n \t\ttgt_plugin=gcn\n \t\tPLUGIN_GCN=$tgt\n-\t\tPLUGIN_GCN_CPPFLAGS=$HSA_RUNTIME_CPPFLAGS\n-\t\tPLUGIN_GCN_LDFLAGS=\"$HSA_RUNTIME_LDFLAGS\"\n \t\tPLUGIN_GCN_LIBS=\"-ldl\"\n \t\tPLUGIN_GCN=1\n \t\t;;"}]}