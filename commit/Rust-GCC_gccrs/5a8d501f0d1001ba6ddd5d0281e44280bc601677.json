{"sha": "5a8d501f0d1001ba6ddd5d0281e44280bc601677", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NWE4ZDUwMWYwZDEwMDFiYTZkZGQ1ZDAyODFlNDQyODBiYzYwMTY3Nw==", "commit": {"author": {"name": "Jan Hubicka", "email": "hubicka@ucw.cz", "date": "2017-05-07T22:21:05Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2017-05-07T22:21:05Z"}, "message": "ipa-inline-analysis.c (estimate_function_body_sizes): Recompute body size unconditionally.\n\n\t* ipa-inline-analysis.c (estimate_function_body_sizes): Recompute\n\tbody size unconditionally.\n\nFrom-SVN: r247729", "tree": {"sha": "9d6d61555951280c39630b7cebef03115728ea8d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9d6d61555951280c39630b7cebef03115728ea8d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5a8d501f0d1001ba6ddd5d0281e44280bc601677", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5a8d501f0d1001ba6ddd5d0281e44280bc601677", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5a8d501f0d1001ba6ddd5d0281e44280bc601677", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5a8d501f0d1001ba6ddd5d0281e44280bc601677/comments", "author": null, "committer": null, "parents": [{"sha": "d4a5c4ebc77ba62f22a360c78a03d0b54c43a2a9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d4a5c4ebc77ba62f22a360c78a03d0b54c43a2a9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d4a5c4ebc77ba62f22a360c78a03d0b54c43a2a9"}], "stats": {"total": 19, "additions": 13, "deletions": 6}, "files": [{"sha": "2f1de244a5ecc743289af90d50b2c140b97f8c52", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5a8d501f0d1001ba6ddd5d0281e44280bc601677/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5a8d501f0d1001ba6ddd5d0281e44280bc601677/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=5a8d501f0d1001ba6ddd5d0281e44280bc601677", "patch": "@@ -1,3 +1,8 @@\n+2017-05-05  Jan Hubicka  <hubicka@ucw.cz>\n+\n+\t* ipa-inline-analysis.c (estimate_function_body_sizes): Recompute\n+\tbody size unconditionally.\n+\n 2017-05-07  Jeff Law  <law@redhat.com>\n \n \tRevert:"}, {"sha": "d44191ade00d0f573406f17ec7b3305b58a522d7", "filename": "gcc/ipa-inline-analysis.c", "status": "modified", "additions": 8, "deletions": 6, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5a8d501f0d1001ba6ddd5d0281e44280bc601677/gcc%2Fipa-inline-analysis.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5a8d501f0d1001ba6ddd5d0281e44280bc601677/gcc%2Fipa-inline-analysis.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-inline-analysis.c?ref=5a8d501f0d1001ba6ddd5d0281e44280bc601677", "patch": "@@ -2994,6 +2994,7 @@ estimate_function_body_sizes (struct cgraph_node *node, bool early)\n   inline_summaries->get (node)->self_size = size;\n   nonconstant_names.release ();\n   ipa_release_body_info (&fbi);\n+  inline_update_overall_summary (node);\n   if (opt_for_fn (node->decl, optimize))\n     {\n       if (!early)\n@@ -3119,12 +3120,13 @@ compute_inline_parameters (struct cgraph_node *node, bool early)\n   info->size = info->self_size;\n   info->stack_frame_offset = 0;\n   info->estimated_stack_size = info->estimated_self_stack_size;\n-  if (flag_checking)\n-    {\n-      inline_update_overall_summary (node);\n-      gcc_assert (!(info->time - info->self_time).to_int ()\n-\t\t  && info->size == info->self_size);\n-    }\n+\n+  /* Code above should compute exactly the same result as\n+     inline_update_overall_summary but because computation happens in\n+     different order the roundoff errors result in slight changes.  */\n+  inline_update_overall_summary (node);\n+  gcc_assert (!(info->time - info->self_time).to_int ()\n+\t      && info->size == info->self_size);\n }\n \n "}]}