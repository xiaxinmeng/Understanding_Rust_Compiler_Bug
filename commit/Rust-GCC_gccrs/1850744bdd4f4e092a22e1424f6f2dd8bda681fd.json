{"sha": "1850744bdd4f4e092a22e1424f6f2dd8bda681fd", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTg1MDc0NGJkZDRmNGUwOTJhMjJlMTQyNGY2ZjJkZDhiZGE2ODFmZA==", "commit": {"author": {"name": "Andreas Tobler", "email": "a.tobler@schweiz.org", "date": "2007-03-23T19:25:19Z"}, "committer": {"name": "Andreas Tobler", "email": "andreast@gcc.gnu.org", "date": "2007-03-23T19:25:19Z"}, "message": "libgomp.exp (libgomp_init): Add -shared-libgcc for *-*-darwin*.\n\n2007-03-23  Andreas Tobler  <a.tobler@schweiz.org>\n\n\t* testsuite/lib/libgomp.exp (libgomp_init): Add -shared-libgcc for\n\t*-*-darwin*.\n\t* testsuite/libgomp.c++/c++.exp: Look for shared libstdc++ library\n\tand use it if found.\n\nFrom-SVN: r123162", "tree": {"sha": "dbb5e839cddaaac02bf54e9eb8aec18d32f52593", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/dbb5e839cddaaac02bf54e9eb8aec18d32f52593"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1850744bdd4f4e092a22e1424f6f2dd8bda681fd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1850744bdd4f4e092a22e1424f6f2dd8bda681fd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1850744bdd4f4e092a22e1424f6f2dd8bda681fd", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1850744bdd4f4e092a22e1424f6f2dd8bda681fd/comments", "author": null, "committer": null, "parents": [{"sha": "b737d953fda13f9bed028c72f84486ab81498717", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b737d953fda13f9bed028c72f84486ab81498717", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b737d953fda13f9bed028c72f84486ab81498717"}], "stats": {"total": 38, "additions": 33, "deletions": 5}, "files": [{"sha": "bcfa440fc19b9e7f622d61d87ed035589b23fd91", "filename": "libgomp/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1850744bdd4f4e092a22e1424f6f2dd8bda681fd/libgomp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1850744bdd4f4e092a22e1424f6f2dd8bda681fd/libgomp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2FChangeLog?ref=1850744bdd4f4e092a22e1424f6f2dd8bda681fd", "patch": "@@ -1,3 +1,10 @@\n+2007-03-23  Andreas Tobler  <a.tobler@schweiz.org>\n+\n+\t* testsuite/lib/libgomp.exp (libgomp_init): Add -shared-libgcc for\n+\t*-*-darwin*.\n+\t* testsuite/libgomp.c++/c++.exp: Look for shared libstdc++ library\n+\tand use it if found.\n+\n 2007-03-18  Uros Bizjak  <ubizjak@gmail.com>\n \n \t* testsuite/config/default.exp: New file."}, {"sha": "2e9f9d8a72643b954c87d3f61c4a81eeee16747d", "filename": "libgomp/testsuite/lib/libgomp.exp", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1850744bdd4f4e092a22e1424f6f2dd8bda681fd/libgomp%2Ftestsuite%2Flib%2Flibgomp.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1850744bdd4f4e092a22e1424f6f2dd8bda681fd/libgomp%2Ftestsuite%2Flib%2Flibgomp.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Ftestsuite%2Flib%2Flibgomp.exp?ref=1850744bdd4f4e092a22e1424f6f2dd8bda681fd", "patch": "@@ -124,6 +124,11 @@ proc libgomp_init { args } {\n \t && [check_effective_target_ilp32] } {\n \tlappend ALWAYS_CFLAGS \"additional_flags=-march=i486\"\n     }\n+\n+    if [istarget *-*-darwin*] {\n+\tlappend ALWAYS_CFLAGS \"additional_flags=-shared-libgcc\"\n+    }\n+\n     if [istarget sparc*-*-*] {\n \tlappend ALWAYS_CFLAGS \"additional_flags=-mcpu=v9\"\n     }"}, {"sha": "213ce029ec7dcb4ce85ae6b15a2bc6d00de56a05", "filename": "libgomp/testsuite/libgomp.c++/c++.exp", "status": "modified", "additions": 21, "deletions": 5, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1850744bdd4f4e092a22e1424f6f2dd8bda681fd/libgomp%2Ftestsuite%2Flibgomp.c%2B%2B%2Fc%2B%2B.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1850744bdd4f4e092a22e1424f6f2dd8bda681fd/libgomp%2Ftestsuite%2Flibgomp.c%2B%2B%2Fc%2B%2B.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Ftestsuite%2Flibgomp.c%2B%2B%2Fc%2B%2B.exp?ref=1850744bdd4f4e092a22e1424f6f2dd8bda681fd", "patch": "@@ -1,14 +1,30 @@\n-set lang_library_path\t\"../libstdc++-v3/src/.libs\"\n-set lang_test_file\t\"${lang_library_path}/libstdc++.a\"\n-set lang_link_flags\t\"-lstdc++\"\n-\n load_lib libgomp-dg.exp\n \n+global shlib_ext\n+\n+set shlib_ext [get_shlib_extension]\n+set lang_link_flags \"-lstdc++\"\n+set lang_test_file_found 0\n+set lang_library_path \"../libstdc++-v3/src/.libs\"\n+\n # Initialize dg.\n dg-init\n \n-if [file exists \"${blddir}/${lang_test_file}\"] {\n+set blddir [lookfor_file [get_multilibs] libgomp]\n+\n+# Look for a static libstdc++ first.\n+if [file exists \"${blddir}/${lang_library_path}/libstdc++.a\"] {\n+    set lang_test_file \"${lang_library_path}/libstdc++.a\"\n+    set lang_test_file_found 1\n+# We may have a shared only build, so look for a shared libstdc++.\n+} elseif [file exists \"${blddir}/${lang_library_path}/libstdc++.${shlib_ext}\"] {\n+    set lang_test_file \"${lang_library_path}/libstdc++.${shlib_ext}\"\n+    set lang_test_file_found 1\n+} else {\n+    puts \"No libstdc++ library found, will not execute c++ tests\"\n+}\n \n+if { $lang_test_file_found } {\n     # Gather a list of all tests.\n     set tests [lsort [glob -nocomplain $srcdir/$subdir/*.C]]\n "}]}