{"sha": "04be6ff5a8e2709d4b474375a65c0868258abdcd", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDRiZTZmZjVhOGUyNzA5ZDRiNDc0Mzc1YTY1YzA4NjgyNThhYmRjZA==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2008-12-29T18:25:19Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2008-12-29T18:25:19Z"}, "message": "re PR middle-end/36191 (can't use complex in a eh region if non-call-exceptions is enabled)\n\n\tPR c++/36191\n\t* tree-complex.c (expand_complex_libcall): Call\n\tmaybe_clean_or_replace_eh_stmt and gimple_purge_dead_eh_edges\n\tinstead of passing true as 3rd argument to gsi_replace.\n\n\t* g++.dg/torture/pr36191.C: New test.\n\nFrom-SVN: r142950", "tree": {"sha": "d72f82cac0cb96faec875085d1d3a9b6077f8ae7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d72f82cac0cb96faec875085d1d3a9b6077f8ae7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/04be6ff5a8e2709d4b474375a65c0868258abdcd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/04be6ff5a8e2709d4b474375a65c0868258abdcd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/04be6ff5a8e2709d4b474375a65c0868258abdcd", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/04be6ff5a8e2709d4b474375a65c0868258abdcd/comments", "author": null, "committer": null, "parents": [{"sha": "67d0afe9011dfe0e010113694e4577451855075a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/67d0afe9011dfe0e010113694e4577451855075a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/67d0afe9011dfe0e010113694e4577451855075a"}], "stats": {"total": 41, "additions": 36, "deletions": 5}, "files": [{"sha": "00dcec7a4fb6ef31afd98507953e8380e8415c67", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/04be6ff5a8e2709d4b474375a65c0868258abdcd/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/04be6ff5a8e2709d4b474375a65c0868258abdcd/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=04be6ff5a8e2709d4b474375a65c0868258abdcd", "patch": "@@ -1,4 +1,11 @@\n-2008-12-28 Uros Bizjak <ubizjak@gmail.com>\n+2008-12-29  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR c++/36191\n+\t* tree-complex.c (expand_complex_libcall): Call\n+\tmaybe_clean_or_replace_eh_stmt and gimple_purge_dead_eh_edges\n+\tinstead of passing true as 3rd argument to gsi_replace.\n+\n+2008-12-28  Uros Bizjak  <ubizjak@gmail.com>\n \n \tPR middle-end/38652\n \t* dse.c: Include target.h."}, {"sha": "27649f02a8013570eb7f401047bdbc251799a9b8", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/04be6ff5a8e2709d4b474375a65c0868258abdcd/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/04be6ff5a8e2709d4b474375a65c0868258abdcd/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=04be6ff5a8e2709d4b474375a65c0868258abdcd", "patch": "@@ -1,3 +1,8 @@\n+2008-12-29  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR c++/36191\n+\t* g++.dg/torture/pr36191.C: New test.\n+\n 2008-12-15  Hariharan Sandanagobalane <hariharan@picochip.com>\n \n \t* gcc.c-torture/execute/builtins/fprintf.x: Disable test for"}, {"sha": "18051cedf7ac060139d5fb41a122d03c442ed12a", "filename": "gcc/testsuite/g++.dg/torture/pr36191.C", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/04be6ff5a8e2709d4b474375a65c0868258abdcd/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftorture%2Fpr36191.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/04be6ff5a8e2709d4b474375a65c0868258abdcd/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftorture%2Fpr36191.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftorture%2Fpr36191.C?ref=04be6ff5a8e2709d4b474375a65c0868258abdcd", "patch": "@@ -0,0 +1,16 @@\n+// PR c++/36191\n+// { dg-do compile }\n+// { dg-options \"-fnon-call-exceptions\" }\n+\n+__complex__ double\n+foo (__complex__ double x, double y)\n+{\n+  try\n+    {\n+      return x / y;\n+    }\n+  catch (char *s)\n+    {\n+      return x;\n+    }\n+}"}, {"sha": "c7a7ad48f6e687eb3314622b63c82d3fbe697708", "filename": "gcc/tree-complex.c", "status": "modified", "additions": 7, "deletions": 4, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/04be6ff5a8e2709d4b474375a65c0868258abdcd/gcc%2Ftree-complex.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/04be6ff5a8e2709d4b474375a65c0868258abdcd/gcc%2Ftree-complex.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-complex.c?ref=04be6ff5a8e2709d4b474375a65c0868258abdcd", "patch": "@@ -953,10 +953,10 @@ expand_complex_libcall (gimple_stmt_iterator *gsi, tree ar, tree ai,\n   enum machine_mode mode;\n   enum built_in_function bcode;\n   tree fn, type, lhs;\n-  gimple stmt;\n+  gimple old_stmt, stmt;\n \n-  stmt = gsi_stmt (*gsi);\n-  lhs = gimple_assign_lhs (stmt);\n+  old_stmt = gsi_stmt (*gsi);\n+  lhs = gimple_assign_lhs (old_stmt);\n   type = TREE_TYPE (lhs);\n \n   mode = TYPE_MODE (type);\n@@ -973,7 +973,10 @@ expand_complex_libcall (gimple_stmt_iterator *gsi, tree ar, tree ai,\n   stmt = gimple_build_call (fn, 4, ar, ai, br, bi);\n   gimple_call_set_lhs (stmt, lhs);\n   update_stmt (stmt);\n-  gsi_replace (gsi, stmt, true);\n+  gsi_replace (gsi, stmt, false);\n+\n+  if (maybe_clean_or_replace_eh_stmt (old_stmt, stmt))\n+    gimple_purge_dead_eh_edges (gsi_bb (*gsi));\n \n   if (gimple_in_ssa_p (cfun))\n     {"}]}