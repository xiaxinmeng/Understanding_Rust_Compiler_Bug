{"sha": "9df0ff5f219b9e93d007f42939a6449ce2521cf5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWRmMGZmNWYyMTliOWU5M2QwMDdmNDI5MzlhNjQ0OWNlMjUyMWNmNQ==", "commit": {"author": {"name": "Iain Sandoe", "email": "iain@sandoe.co.uk", "date": "2020-05-30T16:03:40Z"}, "committer": {"name": "Iain Sandoe", "email": "iain@sandoe.co.uk", "date": "2020-05-30T18:08:36Z"}, "message": "coroutines: Fix unused value found by static analysis.\n\nThis fixes up the zero-initialization of the coro frame pointer\nto avoid an unused assigned value, spotted by Martin Liska with\nstatic analysis.\n\ngcc/cp/ChangeLog:\n\n\t* coroutines.cc (morph_fn_to_coro): Revise initialization\n\tof the frame pointer to avoid an unused value.", "tree": {"sha": "5bbf62f7cac2d83aff6c4457647783b157182015", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5bbf62f7cac2d83aff6c4457647783b157182015"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9df0ff5f219b9e93d007f42939a6449ce2521cf5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9df0ff5f219b9e93d007f42939a6449ce2521cf5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9df0ff5f219b9e93d007f42939a6449ce2521cf5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9df0ff5f219b9e93d007f42939a6449ce2521cf5/comments", "author": {"login": "iains", "id": 4039407, "node_id": "MDQ6VXNlcjQwMzk0MDc=", "avatar_url": "https://avatars.githubusercontent.com/u/4039407?v=4", "gravatar_id": "", "url": "https://api.github.com/users/iains", "html_url": "https://github.com/iains", "followers_url": "https://api.github.com/users/iains/followers", "following_url": "https://api.github.com/users/iains/following{/other_user}", "gists_url": "https://api.github.com/users/iains/gists{/gist_id}", "starred_url": "https://api.github.com/users/iains/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/iains/subscriptions", "organizations_url": "https://api.github.com/users/iains/orgs", "repos_url": "https://api.github.com/users/iains/repos", "events_url": "https://api.github.com/users/iains/events{/privacy}", "received_events_url": "https://api.github.com/users/iains/received_events", "type": "User", "site_admin": false}, "committer": {"login": "iains", "id": 4039407, "node_id": "MDQ6VXNlcjQwMzk0MDc=", "avatar_url": "https://avatars.githubusercontent.com/u/4039407?v=4", "gravatar_id": "", "url": "https://api.github.com/users/iains", "html_url": "https://github.com/iains", "followers_url": "https://api.github.com/users/iains/followers", "following_url": "https://api.github.com/users/iains/following{/other_user}", "gists_url": "https://api.github.com/users/iains/gists{/gist_id}", "starred_url": "https://api.github.com/users/iains/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/iains/subscriptions", "organizations_url": "https://api.github.com/users/iains/orgs", "repos_url": "https://api.github.com/users/iains/repos", "events_url": "https://api.github.com/users/iains/events{/privacy}", "received_events_url": "https://api.github.com/users/iains/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "05e4db63d044ee235d2fbfab8b0bb9fbdfb18315", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/05e4db63d044ee235d2fbfab8b0bb9fbdfb18315", "html_url": "https://github.com/Rust-GCC/gccrs/commit/05e4db63d044ee235d2fbfab8b0bb9fbdfb18315"}], "stats": {"total": 8, "additions": 3, "deletions": 5}, "files": [{"sha": "c4df488ac020891f1c2230f4bb7cc9232522f706", "filename": "gcc/cp/coroutines.cc", "status": "modified", "additions": 3, "deletions": 5, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9df0ff5f219b9e93d007f42939a6449ce2521cf5/gcc%2Fcp%2Fcoroutines.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9df0ff5f219b9e93d007f42939a6449ce2521cf5/gcc%2Fcp%2Fcoroutines.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fcoroutines.cc?ref=9df0ff5f219b9e93d007f42939a6449ce2521cf5", "patch": "@@ -3889,11 +3889,9 @@ morph_fn_to_coro (tree orig, tree *resumer, tree *destroyer)\n   /* The decl_expr for the coro frame pointer, initialize to zero so that we\n      can pass it to the IFN_CO_FRAME (since there's no way to pass a type,\n      directly apparently).  This avoids a \"used uninitialized\" warning.  */\n-  tree r = build_stmt (fn_start, DECL_EXPR, coro_fp);\n   tree zeroinit = build1 (CONVERT_EXPR, coro_frame_ptr, integer_zero_node);\n-  r = build2 (INIT_EXPR, TREE_TYPE (coro_fp), coro_fp, zeroinit);\n-  r = coro_build_cvt_void_expr_stmt (r, fn_start);\n-  add_stmt (r);\n+  DECL_INITIAL (coro_fp) = zeroinit;\n+  add_decl_expr (coro_fp);\n \n   /* The CO_FRAME internal function is a mechanism to allow the middle end\n      to adjust the allocation in response to optimisations.  We provide the\n@@ -4047,7 +4045,7 @@ morph_fn_to_coro (tree orig, tree *resumer, tree *destroyer)\n     }\n \n   tree allocated = build1 (CONVERT_EXPR, coro_frame_ptr, new_fn);\n-  r = build2 (INIT_EXPR, TREE_TYPE (coro_fp), coro_fp, allocated);\n+  tree r = build2 (INIT_EXPR, TREE_TYPE (coro_fp), coro_fp, allocated);\n   r = coro_build_cvt_void_expr_stmt (r, fn_start);\n   add_stmt (r);\n "}]}