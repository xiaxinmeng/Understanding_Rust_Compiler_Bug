{"sha": "38acc41d6d761b635123eefa93743b9139debbae", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzhhY2M0MWQ2ZDc2MWI2MzUxMjNlZWZhOTM3NDNiOTEzOWRlYmJhZQ==", "commit": {"author": {"name": "Steve Kargl", "email": "kargl@gcc.gnu.org", "date": "2020-04-20T11:21:38Z"}, "committer": {"name": "Thomas K\u00f6nig", "email": "tkoenig@gcc.gnu.org", "date": "2020-04-20T11:21:38Z"}, "message": "PR 91800 - reject Hollerith constants as type initializer.\n\n2020-04-20  Steve Kargl  <kargl@gcc.gnu.org>\n\tThomas Koenig  <tkoenig@gcc.gnu.org>\n\n\tPR fortran/91800\n\t* decl.c (variable_decl): Reject Hollerith constants as type\n\tinitializer.\n\n2020-04-20  Steve Kargl  <kargl@gcc.gnu.org>\n\tThomas Koenig  <tkoenig@gcc.gnu.org>\n\n\tPR fortran/91800\n\t* gfortran.dg/hollerith_9.f90: New test.", "tree": {"sha": "9a7ea2c6e1a9b415250b040b5bd0573b4613df55", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9a7ea2c6e1a9b415250b040b5bd0573b4613df55"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/38acc41d6d761b635123eefa93743b9139debbae", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/38acc41d6d761b635123eefa93743b9139debbae", "html_url": "https://github.com/Rust-GCC/gccrs/commit/38acc41d6d761b635123eefa93743b9139debbae", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/38acc41d6d761b635123eefa93743b9139debbae/comments", "author": null, "committer": null, "parents": [{"sha": "85d8c05a02bf7d1b256f806582a11e3fd8970a32", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/85d8c05a02bf7d1b256f806582a11e3fd8970a32", "html_url": "https://github.com/Rust-GCC/gccrs/commit/85d8c05a02bf7d1b256f806582a11e3fd8970a32"}], "stats": {"total": 29, "additions": 29, "deletions": 0}, "files": [{"sha": "2671c1aa38115ec9941943b22e3bb9e7ef42b37d", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/38acc41d6d761b635123eefa93743b9139debbae/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/38acc41d6d761b635123eefa93743b9139debbae/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=38acc41d6d761b635123eefa93743b9139debbae", "patch": "@@ -1,3 +1,10 @@\n+2020-04-20  Steve Kargl  <kargl@gcc.gnu.org>\n+\tThomas Koenig  <tkoenig@gcc.gnu.org>\n+\n+\tPR fortran/91800\n+\t* decl.c (variable_decl): Reject Hollerith constants as type\n+\tinitializer.\n+\n 2020-04-19  Thomas Koenig  <tkoenig@gcc.gnu.org>\n \n \tPR fortran/93500"}, {"sha": "d650407da4186025dd24bb99a17eefe14f6d8be4", "filename": "gcc/fortran/decl.c", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/38acc41d6d761b635123eefa93743b9139debbae/gcc%2Ffortran%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/38acc41d6d761b635123eefa93743b9139debbae/gcc%2Ffortran%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fdecl.c?ref=38acc41d6d761b635123eefa93743b9139debbae", "patch": "@@ -2903,6 +2903,15 @@ variable_decl (int elem)\n       goto cleanup;\n     }\n \n+  if (gfc_current_state () == COMP_DERIVED\n+      && initializer && initializer->ts.type == BT_HOLLERITH)\n+    {\n+      gfc_error (\"Initialization of structure component with a HOLLERITH \"\n+\t\t \"constant at %L is not allowed\", &initializer->where);\n+      m = MATCH_ERROR;\n+      goto cleanup;\n+    }\n+\n   if (gfc_current_state () == COMP_DERIVED\n       && gfc_current_block ()->attr.pdt_template)\n     {"}, {"sha": "f8dba65ff9fed384c389e55adb8e2a1bbe79e310", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/38acc41d6d761b635123eefa93743b9139debbae/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/38acc41d6d761b635123eefa93743b9139debbae/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=38acc41d6d761b635123eefa93743b9139debbae", "patch": "@@ -1,3 +1,9 @@\n+2020-04-20  Steve Kargl  <kargl@gcc.gnu.org>\n+\tThomas Koenig  <tkoenig@gcc.gnu.org>\n+\n+\tPR fortran/91800\n+\t* gfortran.dg/hollerith_9.f90: New test.\n+\n 2020-04-19  David Edelsohn  <dje.gcc@gmail.com>\n \n \t* g++.dg/debug/dwarf2/pr85550.C: Skip AIX."}, {"sha": "cfa16209e93b277e9992d1fa67d7a8be64ecd71b", "filename": "gcc/testsuite/gfortran.dg/hollerith_9.f90", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/38acc41d6d761b635123eefa93743b9139debbae/gcc%2Ftestsuite%2Fgfortran.dg%2Fhollerith_9.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/38acc41d6d761b635123eefa93743b9139debbae/gcc%2Ftestsuite%2Fgfortran.dg%2Fhollerith_9.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fhollerith_9.f90?ref=38acc41d6d761b635123eefa93743b9139debbae", "patch": "@@ -0,0 +1,7 @@\n+! { dg-do compile }\n+! PR 91800 - this used to cause an ICE.\n+module m\n+   type t(n) ! { dg-error \"does not have a component corresponding to parameter\" }\n+      integer, len :: n = 4habcd ! { dg-error \"Initialization of structure component with a HOLLERITH constant\" }\n+   end type\n+end"}]}