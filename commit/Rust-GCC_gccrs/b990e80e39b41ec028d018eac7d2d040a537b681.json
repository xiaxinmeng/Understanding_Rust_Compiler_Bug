{"sha": "b990e80e39b41ec028d018eac7d2d040a537b681", "node_id": "C_kwDOANBUbNoAKGI5OTBlODBlMzliNDFlYzAyOGQwMThlYWM3ZDJkMDQwYTUzN2I2ODE", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2023-01-06T09:52:34Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2023-01-06T09:52:34Z"}, "message": "testsuite: Add testcases from PR108292 and PR108308\n\nThese PRs were for now fixed by reversion of the r13-4977\npatch, but so that the problems don't reappear during stage 1,\nI'm adding testcase coverage from those PRs.\n\n2023-01-06  Jakub Jelinek  <jakub@redhat.com>\n\n\tPR target/108292\n\tPR target/108308\n\t* gcc.c-torture/execute/pr108292.c: New test.\n\t* gcc.target/i386/pr108292.c: New test.\n\t* gcc.dg/pr108308.c: New test.", "tree": {"sha": "9f031424675f8219e6a929dc6cc3fce8c749b230", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9f031424675f8219e6a929dc6cc3fce8c749b230"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b990e80e39b41ec028d018eac7d2d040a537b681", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b990e80e39b41ec028d018eac7d2d040a537b681", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b990e80e39b41ec028d018eac7d2d040a537b681", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b990e80e39b41ec028d018eac7d2d040a537b681/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5977d14a6081184ba10a671585e553e1e9ac0112", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5977d14a6081184ba10a671585e553e1e9ac0112", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5977d14a6081184ba10a671585e553e1e9ac0112"}], "stats": {"total": 72, "additions": 72, "deletions": 0}, "files": [{"sha": "665724d3dcc05a1b84bf02b2700239788445a5c0", "filename": "gcc/testsuite/gcc.c-torture/execute/pr108292.c", "status": "added", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b990e80e39b41ec028d018eac7d2d040a537b681/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fpr108292.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b990e80e39b41ec028d018eac7d2d040a537b681/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fpr108292.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fpr108292.c?ref=b990e80e39b41ec028d018eac7d2d040a537b681", "patch": "@@ -0,0 +1,18 @@\n+/* PR target/108292 */\n+\n+typedef unsigned V __attribute__((__vector_size__ (64)));\n+\n+V x;\n+\n+int\n+main ()\n+{\n+  if (sizeof (unsigned) * __CHAR_BIT__ != 32)\n+    return 0;\n+  __builtin_sub_overflow (0, 6, &x[5]);\n+  x >>= ((V){} != x) & 31;\n+  for (unsigned i = 0; i < 16; i++)\n+    if (x[i] != (i == 5))\n+      __builtin_abort ();\n+  return 0;\n+}"}, {"sha": "c22762690acb84d1f6ca391524b34ccb3fe0cc63", "filename": "gcc/testsuite/gcc.dg/pr108308.c", "status": "added", "additions": 39, "deletions": 0, "changes": 39, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b990e80e39b41ec028d018eac7d2d040a537b681/gcc%2Ftestsuite%2Fgcc.dg%2Fpr108308.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b990e80e39b41ec028d018eac7d2d040a537b681/gcc%2Ftestsuite%2Fgcc.dg%2Fpr108308.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr108308.c?ref=b990e80e39b41ec028d018eac7d2d040a537b681", "patch": "@@ -0,0 +1,39 @@\n+/* PR target/108308 */\n+/* { dg-do run { target { ilp32 || lp64 } } } */\n+/* { dg-options \"-Os -fno-tree-ccp\" } */\n+\n+int a = 1, *d = &a, f = 2766708631, h;\n+unsigned b = -1, c, e, g;\n+\n+static void\n+foo (int j)\n+{\n+  if (a)\n+    {\n+      c = ~c;\n+      while (e)\n+\tj = 0;\n+      goto k;\n+    }\n+l:\n+  h = 1;\n+k:\n+  *d = (!j) | 80;\n+  int m = ~(~(-1 / b) | (a ^ 1)), n = ~(~g / (11 >> m)), o = -1 / n;\n+  if (f)\n+    {\n+      b = 9518150474215344 ^ ~f;\n+      f = 0;\n+      if (c)\n+\tgoto l;\n+      if (o)\n+\tgoto k;\n+    }\n+}\n+\n+int\n+main ()\n+{\n+  foo (1);\n+  return 0;\n+}"}, {"sha": "a28a6439599fd5ead901d31daefd3fede7e318b7", "filename": "gcc/testsuite/gcc.target/i386/pr108292.c", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b990e80e39b41ec028d018eac7d2d040a537b681/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr108292.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b990e80e39b41ec028d018eac7d2d040a537b681/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr108292.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr108292.c?ref=b990e80e39b41ec028d018eac7d2d040a537b681", "patch": "@@ -0,0 +1,15 @@\n+/* PR target/108292 */\n+/* { dg-do compile } */\n+/* { dg-options \"-Ofast -march=alderlake\" } */\n+\n+extern void foo (float *);\n+\n+extern int x;\n+\n+int\n+bar (void)\n+{\n+  float y;\n+  foo (&y);\n+  return y > x ? 1 : 2;\n+}"}]}