{"sha": "fb1d2a2ef2e47ce0be934d008c6231e00c7d7f86", "node_id": "C_kwDOANBUbNoAKGZiMWQyYTJlZjJlNDdjZTBiZTkzNGQwMDhjNjIzMWUwMGM3ZDdmODY", "commit": {"author": {"name": "Philip Herron", "email": "philip.herron@embecosm.com", "date": "2021-10-22T12:45:21Z"}, "committer": {"name": "Philip Herron", "email": "philip.herron@embecosm.com", "date": "2021-10-22T12:45:21Z"}, "message": "Cleanup IR symbol names in gimple\n\nWhen we have generic code the full as_string is too verbose for symbol\nnames. This changes the ir_symbol_names to become the name of the types\nnot the full debug as_string version.\n\nFixes #745", "tree": {"sha": "d6b932d3bc229a020d16642f8c5cd1e16718dc54", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d6b932d3bc229a020d16642f8c5cd1e16718dc54"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/fb1d2a2ef2e47ce0be934d008c6231e00c7d7f86", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fb1d2a2ef2e47ce0be934d008c6231e00c7d7f86", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fb1d2a2ef2e47ce0be934d008c6231e00c7d7f86", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fb1d2a2ef2e47ce0be934d008c6231e00c7d7f86/comments", "author": {"login": "philberty", "id": 84585, "node_id": "MDQ6VXNlcjg0NTg1", "avatar_url": "https://avatars.githubusercontent.com/u/84585?v=4", "gravatar_id": "", "url": "https://api.github.com/users/philberty", "html_url": "https://github.com/philberty", "followers_url": "https://api.github.com/users/philberty/followers", "following_url": "https://api.github.com/users/philberty/following{/other_user}", "gists_url": "https://api.github.com/users/philberty/gists{/gist_id}", "starred_url": "https://api.github.com/users/philberty/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/philberty/subscriptions", "organizations_url": "https://api.github.com/users/philberty/orgs", "repos_url": "https://api.github.com/users/philberty/repos", "events_url": "https://api.github.com/users/philberty/events{/privacy}", "received_events_url": "https://api.github.com/users/philberty/received_events", "type": "User", "site_admin": false}, "committer": {"login": "philberty", "id": 84585, "node_id": "MDQ6VXNlcjg0NTg1", "avatar_url": "https://avatars.githubusercontent.com/u/84585?v=4", "gravatar_id": "", "url": "https://api.github.com/users/philberty", "html_url": "https://github.com/philberty", "followers_url": "https://api.github.com/users/philberty/followers", "following_url": "https://api.github.com/users/philberty/following{/other_user}", "gists_url": "https://api.github.com/users/philberty/gists{/gist_id}", "starred_url": "https://api.github.com/users/philberty/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/philberty/subscriptions", "organizations_url": "https://api.github.com/users/philberty/orgs", "repos_url": "https://api.github.com/users/philberty/repos", "events_url": "https://api.github.com/users/philberty/events{/privacy}", "received_events_url": "https://api.github.com/users/philberty/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8e6c5a32b6e2c1ade6f1a835be2c2a26788db544", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8e6c5a32b6e2c1ade6f1a835be2c2a26788db544", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8e6c5a32b6e2c1ade6f1a835be2c2a26788db544"}], "stats": {"total": 18, "additions": 16, "deletions": 2}, "files": [{"sha": "96a06e69c23d202a8a73c09ae29a361f13d4b07c", "filename": "gcc/rust/typecheck/rust-tyty.cc", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fb1d2a2ef2e47ce0be934d008c6231e00c7d7f86/gcc%2Frust%2Ftypecheck%2Frust-tyty.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fb1d2a2ef2e47ce0be934d008c6231e00c7d7f86/gcc%2Frust%2Ftypecheck%2Frust-tyty.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Frust%2Ftypecheck%2Frust-tyty.cc?ref=fb1d2a2ef2e47ce0be934d008c6231e00c7d7f86", "patch": "@@ -1982,6 +1982,20 @@ ParamType::as_string () const\n   return lookup->as_string ();\n }\n \n+std::string\n+ParamType::get_name () const\n+{\n+  if (get_ref () == get_ty_ref ())\n+    return get_symbol ();\n+\n+  auto context = Resolver::TypeCheckContext::get ();\n+  BaseType *lookup = nullptr;\n+  bool ok = context->lookup_type (get_ty_ref (), &lookup);\n+  rust_assert (ok);\n+\n+  return lookup->get_name ();\n+}\n+\n BaseType *\n ParamType::unify (BaseType *other)\n {"}, {"sha": "be80f77ace42aaca8f17d2b831848907158add0b", "filename": "gcc/rust/typecheck/rust-tyty.h", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fb1d2a2ef2e47ce0be934d008c6231e00c7d7f86/gcc%2Frust%2Ftypecheck%2Frust-tyty.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fb1d2a2ef2e47ce0be934d008c6231e00c7d7f86/gcc%2Frust%2Ftypecheck%2Frust-tyty.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Frust%2Ftypecheck%2Frust-tyty.h?ref=fb1d2a2ef2e47ce0be934d008c6231e00c7d7f86", "patch": "@@ -545,7 +545,7 @@ class ParamType : public BaseType\n \n   BaseType *resolve () const;\n \n-  std::string get_name () const override final { return as_string (); }\n+  std::string get_name () const override final;\n \n   bool is_equal (const BaseType &other) const override;\n \n@@ -680,7 +680,7 @@ class SubstitutionParamMapping\n     : generic (other.generic), param (other.param)\n   {}\n \n-  std::string as_string () const { return param->as_string (); }\n+  std::string as_string () const { return param->get_name (); }\n \n   bool fill_param_ty (BaseType &type, Location locus);\n "}]}