{"sha": "bd1aa4f4af8e71e13acbda112860cdd2045817ee", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmQxYWE0ZjRhZjhlNzFlMTNhY2JkYTExMjg2MGNkZDIwNDU4MTdlZQ==", "commit": {"author": {"name": "Sevak Sargsyan", "email": "sevak.sargsyan@ispras.ru", "date": "2011-09-13T16:21:38Z"}, "committer": {"name": "Alexander Monakov", "email": "amonakov@gcc.gnu.org", "date": "2011-09-13T16:21:38Z"}, "message": "neon.md (neon_vabd<mode>_2, [...]): New define_insn patterns for combine.\n\n2011-09-13  Sevak Sargsyan <sevak.sargsyan@ispras.ru>\n\n\t* config/arm/neon.md (neon_vabd<mode>_2, neon_vabd<mode>_3): New\n\tdefine_insn patterns for combine.\n\n\t* gcc.target/arm/neon-combine-sub-abs-into-vabd.c: New test.\n\nFrom-SVN: r178817", "tree": {"sha": "12d8ffa0150dae34b9300e9cfde42d98d735dd7d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/12d8ffa0150dae34b9300e9cfde42d98d735dd7d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bd1aa4f4af8e71e13acbda112860cdd2045817ee", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bd1aa4f4af8e71e13acbda112860cdd2045817ee", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bd1aa4f4af8e71e13acbda112860cdd2045817ee", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bd1aa4f4af8e71e13acbda112860cdd2045817ee/comments", "author": null, "committer": null, "parents": [{"sha": "29b7399adf8fc5764f919ab9d94525fb7cbe08a9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/29b7399adf8fc5764f919ab9d94525fb7cbe08a9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/29b7399adf8fc5764f919ab9d94525fb7cbe08a9"}], "stats": {"total": 88, "additions": 88, "deletions": 0}, "files": [{"sha": "2670db856095c943bf23f7b1c206a4fd437efb9a", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bd1aa4f4af8e71e13acbda112860cdd2045817ee/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bd1aa4f4af8e71e13acbda112860cdd2045817ee/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=bd1aa4f4af8e71e13acbda112860cdd2045817ee", "patch": "@@ -1,3 +1,8 @@\n+2011-09-13  Sevak Sargsyan <sevak.sargsyan@ispras.ru>\n+\n+\t* config/arm/neon.md (neon_vabd<mode>_2, neon_vabd<mode>_3): New\n+\tdefine_insn patterns for combine.\n+\n 2011-09-13  Giuseppe Scrivano  <gscrivano@gnu.org>\n \n \t* reorg.c: Always define make_return_insns."}, {"sha": "b70c7af98f3c024c6ecc82305c92b09b71c89045", "filename": "gcc/config/arm/neon.md", "status": "modified", "additions": 29, "deletions": 0, "changes": 29, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bd1aa4f4af8e71e13acbda112860cdd2045817ee/gcc%2Fconfig%2Farm%2Fneon.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bd1aa4f4af8e71e13acbda112860cdd2045817ee/gcc%2Fconfig%2Farm%2Fneon.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Fneon.md?ref=bd1aa4f4af8e71e13acbda112860cdd2045817ee", "patch": "@@ -5665,3 +5665,32 @@\n   emit_insn (gen_neon_vec_pack_trunc_<V_double> (operands[0], tempreg));\n   DONE;\n })\n+\n+(define_insn \"neon_vabd<mode>_2\"\n+ [(set (match_operand:VDQ 0 \"s_register_operand\" \"=w\")\n+       (abs:VDQ (minus:VDQ (match_operand:VDQ 1 \"s_register_operand\" \"w\")\n+                           (match_operand:VDQ 2 \"s_register_operand\" \"w\"))))]\n+ \"TARGET_NEON && (!<Is_float_mode> || flag_unsafe_math_optimizations)\"\n+ \"vabd.<V_s_elem> %<V_reg>0, %<V_reg>1, %<V_reg>2\"\n+ [(set (attr \"neon_type\")\n+       (if_then_else (ne (symbol_ref \"<Is_float_mode>\") (const_int 0))\n+                     (if_then_else (ne (symbol_ref \"<Is_d_reg>\") (const_int 0))\n+                                   (const_string \"neon_fp_vadd_ddd_vabs_dd\")\n+                                   (const_string \"neon_fp_vadd_qqq_vabs_qq\"))\n+                     (const_string \"neon_int_5\")))]\n+)\n+\n+(define_insn \"neon_vabd<mode>_3\"\n+ [(set (match_operand:VDQ 0 \"s_register_operand\" \"=w\")\n+       (abs:VDQ (unspec:VDQ [(match_operand:VDQ 1 \"s_register_operand\" \"w\")\n+                             (match_operand:VDQ 2 \"s_register_operand\" \"w\")]\n+                 UNSPEC_VSUB)))]\n+ \"TARGET_NEON && (!<Is_float_mode> || flag_unsafe_math_optimizations)\"\n+ \"vabd.<V_if_elem> %<V_reg>0, %<V_reg>1, %<V_reg>2\"\n+ [(set (attr \"neon_type\")\n+       (if_then_else (ne (symbol_ref \"<Is_float_mode>\") (const_int 0))\n+                     (if_then_else (ne (symbol_ref \"<Is_d_reg>\") (const_int 0))\n+                                   (const_string \"neon_fp_vadd_ddd_vabs_dd\")\n+                                   (const_string \"neon_fp_vadd_qqq_vabs_qq\"))\n+                     (const_string \"neon_int_5\")))]\n+)"}, {"sha": "6fe55977ce41dd85aff8e2e9375e51b8052272cd", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bd1aa4f4af8e71e13acbda112860cdd2045817ee/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bd1aa4f4af8e71e13acbda112860cdd2045817ee/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=bd1aa4f4af8e71e13acbda112860cdd2045817ee", "patch": "@@ -1,3 +1,7 @@\n+2011-09-13  Sevak Sargsyan <sevak.sargsyan@ispras.ru>\n+\n+\t* gcc.target/arm/neon-combine-sub-abs-into-vabd.c: New test.\n+\n 2011-09-13  Dodji Seketeli  <dodji@redhat.com>\n \n \tPR c++/48320"}, {"sha": "ad6ba755e64864c25d71f24ced6f97ccab644565", "filename": "gcc/testsuite/gcc.target/arm/neon-combine-sub-abs-into-vabd.c", "status": "added", "additions": 50, "deletions": 0, "changes": 50, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bd1aa4f4af8e71e13acbda112860cdd2045817ee/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fneon-combine-sub-abs-into-vabd.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bd1aa4f4af8e71e13acbda112860cdd2045817ee/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fneon-combine-sub-abs-into-vabd.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fneon-combine-sub-abs-into-vabd.c?ref=bd1aa4f4af8e71e13acbda112860cdd2045817ee", "patch": "@@ -0,0 +1,50 @@\n+/* { dg-do compile } */\n+/* { dg-require-effective-target arm_neon_ok } */\n+/* { dg-options \"-O2 -funsafe-math-optimizations\" } */\n+/* { dg-add-options arm_neon } */\n+\n+#include <arm_neon.h>\n+float32x2_t f_sub_abs_to_vabd_32()\n+{\n+  float32x2_t val1 = vdup_n_f32 (10);\n+  float32x2_t val2 = vdup_n_f32 (30);\n+  float32x2_t sres = vsub_f32(val1, val2);\n+  float32x2_t res = vabs_f32 (sres);\n+\n+  return res;\n+}\n+/* { dg-final { scan-assembler \"vabd\\.f32\" } }*/\n+\n+#include <arm_neon.h>\n+int8x8_t sub_abs_to_vabd_8()\n+{\n+  int8x8_t val1 = vdup_n_s8 (10);\n+  int8x8_t val2 = vdup_n_s8 (30);\n+  int8x8_t sres = vsub_s8(val1, val2);\n+  int8x8_t res = vabs_s8 (sres);\n+\n+  return res;\n+}\n+/* { dg-final { scan-assembler \"vabd\\.s8\" } }*/\n+\n+int16x4_t sub_abs_to_vabd_16()\n+{\n+  int16x4_t val1 = vdup_n_s16 (10);\n+  int16x4_t val2 = vdup_n_s16 (30);\n+  int16x4_t sres = vsub_s16(val1, val2);\n+  int16x4_t res = vabs_s16 (sres);\n+\n+  return res;\n+}\n+/* { dg-final { scan-assembler \"vabd\\.s16\" } }*/\n+\n+int32x2_t sub_abs_to_vabd_32()\n+{\n+  int32x2_t val1 = vdup_n_s32 (10);\n+  int32x2_t val2 = vdup_n_s32 (30);\n+  int32x2_t sres = vsub_s32(val1, val2);\n+  int32x2_t res = vabs_s32 (sres);\n+\n+   return res;\n+}\n+/* { dg-final { scan-assembler \"vabd\\.s32\" } }*/"}]}