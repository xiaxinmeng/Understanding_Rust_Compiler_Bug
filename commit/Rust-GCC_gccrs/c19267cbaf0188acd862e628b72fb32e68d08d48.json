{"sha": "c19267cbaf0188acd862e628b72fb32e68d08d48", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzE5MjY3Y2JhZjAxODhhY2Q4NjJlNjI4YjcyZmIzMmU2OGQwOGQ0OA==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@redhat.com", "date": "2012-03-21T04:04:39Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "2012-03-21T04:04:39Z"}, "message": "mangle.c (write_type): Handle 'auto'.\n\ngcc/cp/\n\t* mangle.c (write_type): Handle 'auto'.\n\t* init.c (build_new): Don't do auto deduction where it might\n\taffect template mangling.\nlibiberty/\n\t* cp-demangle.c (cplus_demangle_type): Handle 'auto'.\n\nFrom-SVN: r185595", "tree": {"sha": "d78ec393143f330e334e0d1388fbcd7568ca8b93", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d78ec393143f330e334e0d1388fbcd7568ca8b93"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c19267cbaf0188acd862e628b72fb32e68d08d48", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c19267cbaf0188acd862e628b72fb32e68d08d48", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c19267cbaf0188acd862e628b72fb32e68d08d48", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c19267cbaf0188acd862e628b72fb32e68d08d48/comments", "author": {"login": "jicama", "id": 266146, "node_id": "MDQ6VXNlcjI2NjE0Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/266146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jicama", "html_url": "https://github.com/jicama", "followers_url": "https://api.github.com/users/jicama/followers", "following_url": "https://api.github.com/users/jicama/following{/other_user}", "gists_url": "https://api.github.com/users/jicama/gists{/gist_id}", "starred_url": "https://api.github.com/users/jicama/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jicama/subscriptions", "organizations_url": "https://api.github.com/users/jicama/orgs", "repos_url": "https://api.github.com/users/jicama/repos", "events_url": "https://api.github.com/users/jicama/events{/privacy}", "received_events_url": "https://api.github.com/users/jicama/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "f17dd5dad399612fb6be1ad666fdb43ff97f8418", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f17dd5dad399612fb6be1ad666fdb43ff97f8418", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f17dd5dad399612fb6be1ad666fdb43ff97f8418"}], "stats": {"total": 43, "additions": 42, "deletions": 1}, "files": [{"sha": "8dcc4462d04959165fc36a2b544c5991cda74652", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c19267cbaf0188acd862e628b72fb32e68d08d48/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c19267cbaf0188acd862e628b72fb32e68d08d48/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=c19267cbaf0188acd862e628b72fb32e68d08d48", "patch": "@@ -1,5 +1,9 @@\n 2012-03-20  Jason Merrill  <jason@redhat.com>\n \n+\t* mangle.c (write_type): Handle 'auto'.\n+\t* init.c (build_new): Don't do auto deduction where it might\n+\taffect template mangling.\n+\n \tPR c++/52510\n \t* decl.c (reshape_init_class): Handle repeated reshaping.\n \t* search.c (lookup_field_1): Add sanity check."}, {"sha": "bcb5ab7a23bece4a0d36cf265837a567b696eecf", "filename": "gcc/cp/init.c", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c19267cbaf0188acd862e628b72fb32e68d08d48/gcc%2Fcp%2Finit.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c19267cbaf0188acd862e628b72fb32e68d08d48/gcc%2Fcp%2Finit.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Finit.c?ref=c19267cbaf0188acd862e628b72fb32e68d08d48", "patch": "@@ -2774,7 +2774,9 @@ build_new (VEC(tree,gc) **placement, tree type, tree nelts,\n   if (type == error_mark_node)\n     return error_mark_node;\n \n-  if (nelts == NULL_TREE && VEC_length (tree, *init) == 1)\n+  if (nelts == NULL_TREE && VEC_length (tree, *init) == 1\n+      /* Don't do auto deduction where it might affect mangling.  */\n+      && (!processing_template_decl || at_function_scope_p ()))\n     {\n       tree auto_node = type_uses_auto (type);\n       if (auto_node)"}, {"sha": "1536828a32cbfc3ff89a51bb373769ca2744c355", "filename": "gcc/cp/mangle.c", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c19267cbaf0188acd862e628b72fb32e68d08d48/gcc%2Fcp%2Fmangle.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c19267cbaf0188acd862e628b72fb32e68d08d48/gcc%2Fcp%2Fmangle.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fmangle.c?ref=c19267cbaf0188acd862e628b72fb32e68d08d48", "patch": "@@ -1933,6 +1933,13 @@ write_type (tree type)\n \t      break;\n \n \t    case TEMPLATE_TYPE_PARM:\n+\t      if (is_auto (type))\n+\t\t{\n+\t\t  write_identifier (\"Da\");\n+\t\t  ++is_builtin_type;\n+\t\t  break;\n+\t\t}\n+\t      /* else fall through.  */\n \t    case TEMPLATE_PARM_INDEX:\n \t      write_template_param (type);\n \t      break;"}, {"sha": "71f1fe7ed773fd6af94a6352d9a21fe8757fcdfe", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c19267cbaf0188acd862e628b72fb32e68d08d48/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c19267cbaf0188acd862e628b72fb32e68d08d48/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=c19267cbaf0188acd862e628b72fb32e68d08d48", "patch": "@@ -1,3 +1,7 @@\n+2012-03-20  Jason Merrill  <jason@redhat.com>\n+\n+\t* g++.dg/cpp0x/auto32.C: New.\n+\n 2012-03-20  Georg-Johann Lay  <avr@gjlay.de>\n \n \tPR testsuite/52641"}, {"sha": "2aad34e40ac8e2db9fc13d756dcf6f6be3b65c6c", "filename": "gcc/testsuite/g++.dg/cpp0x/auto32.C", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c19267cbaf0188acd862e628b72fb32e68d08d48/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fauto32.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c19267cbaf0188acd862e628b72fb32e68d08d48/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fauto32.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fauto32.C?ref=c19267cbaf0188acd862e628b72fb32e68d08d48", "patch": "@@ -0,0 +1,9 @@\n+// { dg-do compile { target c++11 } }\n+\n+// { dg-final { scan-assembler \"_Z1fIiEDTnw_Dapifp_EET_\" } }\n+template <class T> auto f(T t) -> decltype (new auto(t));\n+\n+int main()\n+{\n+  f(1);\n+}"}, {"sha": "add9ff9d1a7cdb1f78f79e8d6849a6560ee8f19a", "filename": "libiberty/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c19267cbaf0188acd862e628b72fb32e68d08d48/libiberty%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c19267cbaf0188acd862e628b72fb32e68d08d48/libiberty%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libiberty%2FChangeLog?ref=c19267cbaf0188acd862e628b72fb32e68d08d48", "patch": "@@ -1,3 +1,7 @@\n+2012-03-20  Jason Merrill  <jason@redhat.com>\n+\n+\t* cp-demangle.c (cplus_demangle_type): Handle 'auto'.\n+\n 2012-03-07  Jason Merrill  <jason@redhat.com>\n \n \t* cp-demangle.c (cplus_demangle_operators): Add li."}, {"sha": "d95b56c71a9cae2bb3b9842c28885ca8173b9a20", "filename": "libiberty/cp-demangle.c", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c19267cbaf0188acd862e628b72fb32e68d08d48/libiberty%2Fcp-demangle.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c19267cbaf0188acd862e628b72fb32e68d08d48/libiberty%2Fcp-demangle.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libiberty%2Fcp-demangle.c?ref=c19267cbaf0188acd862e628b72fb32e68d08d48", "patch": "@@ -2270,6 +2270,11 @@ cplus_demangle_type (struct d_info *di)\n \t\t\t     cplus_demangle_type (di), NULL);\n \t  can_subst = 1;\n \t  break;\n+\n+\tcase 'a':\n+\t  /* auto */\n+\t  ret = d_make_name (di, \"auto\", 4);\n+\t  break;\n \t  \n \tcase 'f':\n \t  /* 32-bit decimal floating point */"}, {"sha": "d489692f0b646ece74615ce0ad6c30c6aab84cc9", "filename": "libiberty/testsuite/demangle-expected", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c19267cbaf0188acd862e628b72fb32e68d08d48/libiberty%2Ftestsuite%2Fdemangle-expected", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c19267cbaf0188acd862e628b72fb32e68d08d48/libiberty%2Ftestsuite%2Fdemangle-expected", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libiberty%2Ftestsuite%2Fdemangle-expected?ref=c19267cbaf0188acd862e628b72fb32e68d08d48", "patch": "@@ -4075,6 +4075,12 @@ decltype (new int{}) f1<int>(int)\n --format=gnu-v3\n _Zli2_wPKc\n operator\"\" _w(char const*)\n+--format=gnu-v3\n+_Z1fIiEDTnw_Dapifp_EET_\n+decltype (new auto({parm#1})) f<int>(int)\n+--format=gnu-v3\n+_Z1fIiERDaRKT_S1_\n+auto& f<int>(int const&, int)\n #\n # Ada (GNAT) tests.\n #"}]}