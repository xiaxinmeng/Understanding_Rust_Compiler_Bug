{"sha": "63e2552f6ccb9508ad61a3d7852a3ed6c782047c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjNlMjU1MmY2Y2NiOTUwOGFkNjFhM2Q3ODUyYTNlZDZjNzgyMDQ3Yw==", "commit": {"author": {"name": "Zack Weinberg", "email": "zackw@panix.com", "date": "2006-01-23T15:16:00Z"}, "committer": {"name": "Zack Weinberg", "email": "zack@gcc.gnu.org", "date": "2006-01-23T15:16:00Z"}, "message": "r110128@banpei: zack | 2006-01-22 14:50:42 -0800\n\n r110128@banpei:  zack | 2006-01-22 14:50:42 -0800\n \t* genautomata.c (output_reserved_units_table): Emit nothing if\n \tdescription->query_units_num is zero.  Remove extra blank line.\n \t(output_cpu_unit_reservation_p): Short circuit\n \tif description->query_units_num is zero.\n\nFrom-SVN: r110124", "tree": {"sha": "a7e6d4019c5a69944e5aa5a48c2abedf1ad6a515", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a7e6d4019c5a69944e5aa5a48c2abedf1ad6a515"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/63e2552f6ccb9508ad61a3d7852a3ed6c782047c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/63e2552f6ccb9508ad61a3d7852a3ed6c782047c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/63e2552f6ccb9508ad61a3d7852a3ed6c782047c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/63e2552f6ccb9508ad61a3d7852a3ed6c782047c/comments", "author": {"login": "zackw", "id": 325899, "node_id": "MDQ6VXNlcjMyNTg5OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/325899?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zackw", "html_url": "https://github.com/zackw", "followers_url": "https://api.github.com/users/zackw/followers", "following_url": "https://api.github.com/users/zackw/following{/other_user}", "gists_url": "https://api.github.com/users/zackw/gists{/gist_id}", "starred_url": "https://api.github.com/users/zackw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zackw/subscriptions", "organizations_url": "https://api.github.com/users/zackw/orgs", "repos_url": "https://api.github.com/users/zackw/repos", "events_url": "https://api.github.com/users/zackw/events{/privacy}", "received_events_url": "https://api.github.com/users/zackw/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "8c94f366afaac439750606fe3cb7b52207afa6e4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8c94f366afaac439750606fe3cb7b52207afa6e4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8c94f366afaac439750606fe3cb7b52207afa6e4"}], "stats": {"total": 40, "additions": 25, "deletions": 15}, "files": [{"sha": "d453d59fe551ab8e9af766b60c2b1dce9782b2b2", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/63e2552f6ccb9508ad61a3d7852a3ed6c782047c/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/63e2552f6ccb9508ad61a3d7852a3ed6c782047c/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=63e2552f6ccb9508ad61a3d7852a3ed6c782047c", "patch": "@@ -1,3 +1,10 @@\n+2006-01-22  Zack Weinberg  <zackw@panix.com>\n+\n+\t* genautomata.c (output_reserved_units_table): Emit nothing if\n+\tdescription->query_units_num is zero.  Remove extra blank line.\n+\t(output_cpu_unit_reservation_p): Short circuit\n+\tif description->query_units_num is zero.\n+\n 2006-01-22  Zack Weinberg  <zackw@panix.com>\n \n \t* genattrtab.c: Don't include genattrtab.h.  Define ATTR_NONE"}, {"sha": "14165d6c3dbb786cf69db2e15bf4de31fd2b604d", "filename": "gcc/genautomata.c", "status": "modified", "additions": 18, "deletions": 15, "changes": 33, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/63e2552f6ccb9508ad61a3d7852a3ed6c782047c/gcc%2Fgenautomata.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/63e2552f6ccb9508ad61a3d7852a3ed6c782047c/gcc%2Fgenautomata.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgenautomata.c?ref=63e2552f6ccb9508ad61a3d7852a3ed6c782047c", "patch": "@@ -7533,6 +7533,9 @@ output_reserved_units_table (automaton_t automaton)\n   size_t n;\n   int i;\n \n+  if (description->query_units_num == 0)\n+    return;\n+\n   /* Create vect of pointers to states.  */\n   output_states_vect = 0;\n   pass_states (automaton, add_states_vect_el);\n@@ -7568,8 +7571,7 @@ output_reserved_units_table (automaton_t automaton)\n   output_reserved_units_table_name (output_file, automaton);\n   fprintf (output_file, \"[] = {\\n\");\n   output_vect (reserved_units_table);\n-  fprintf (output_file, \"};\\n\");\n-  fprintf (output_file, \"\\n#endif /* #if %s */\\n\\n\",\n+  fprintf (output_file, \"};\\n#endif /* #if %s */\\n\\n\",\n \t   CPU_UNITS_QUERY_MACRO_NAME);\n \n   VEC_free (state_t,heap, output_states_vect);\n@@ -8316,19 +8318,20 @@ output_cpu_unit_reservation_p (void)\n   fprintf (output_file, \"{\\n  gcc_assert (%s >= 0 && %s < %d);\\n\",\n \t   CPU_CODE_PARAMETER_NAME, CPU_CODE_PARAMETER_NAME,\n \t   description->query_units_num);\n-  for (automaton = description->first_automaton;\n-       automaton != NULL;\n-       automaton = automaton->next_automaton)\n-    {\n-      fprintf (output_file, \"  if ((\");\n-      output_reserved_units_table_name (output_file, automaton);\n-      fprintf (output_file, \" [((struct %s *) %s)->\", CHIP_NAME, STATE_NAME);\n-      output_chip_member_name (output_file, automaton);\n-      fprintf (output_file, \" * %d + %s / 8] >> (%s %% 8)) & 1)\\n\",\n-\t       (description->query_units_num + 7) / 8,\n-\t       CPU_CODE_PARAMETER_NAME, CPU_CODE_PARAMETER_NAME);\n-      fprintf (output_file, \"    return 1;\\n\");\n-    }\n+  if (description->query_units_num > 0)\n+    for (automaton = description->first_automaton;\n+\t automaton != NULL;\n+\t automaton = automaton->next_automaton)\n+      {\n+\tfprintf (output_file, \"  if ((\");\n+\toutput_reserved_units_table_name (output_file, automaton);\n+\tfprintf (output_file, \" [((struct %s *) %s)->\", CHIP_NAME, STATE_NAME);\n+\toutput_chip_member_name (output_file, automaton);\n+\tfprintf (output_file, \" * %d + %s / 8] >> (%s %% 8)) & 1)\\n\",\n+\t\t (description->query_units_num + 7) / 8,\n+\t\t CPU_CODE_PARAMETER_NAME, CPU_CODE_PARAMETER_NAME);\n+\tfprintf (output_file, \"    return 1;\\n\");\n+      }\n   fprintf (output_file, \"  return 0;\\n}\\n\\n\");\n }\n "}]}