{"sha": "c4487c3be84e0b892aeb61f30435638c6d94a8ab", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzQ0ODdjM2JlODRlMGI4OTJhZWI2MWYzMDQzNTYzOGM2ZDk0YThhYg==", "commit": {"author": {"name": "Bob Duff", "email": "duff@adacore.com", "date": "2019-07-03T08:14:38Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "pmderodat@gcc.gnu.org", "date": "2019-07-03T08:14:38Z"}, "message": "[Ada] Style check for mixed-case identifiers\n\nThis patch implements a new switch, -gnatyD, enables a style check that\nrequires defining identifiers to be in mixed case.\n\n2019-07-03  Bob Duff  <duff@adacore.com>\n\ngcc/ada/\n\n\t* par-ch3.adb (P_Defining_Identifier): Call\n\tCheck_Defining_Identifier_Casing.\n\t* style.ads, styleg.ads, styleg.adb\n\t(Check_Defining_Identifier_Casing): New procedure to check for\n\tmixed-case defining identifiers.\n\t* stylesw.ads, stylesw.adb (Style_Check_Mixed_Case_Decls): New\n\tflag for checking for mixed-case defining identifiers.\n\t* doc/gnat_ugn/building_executable_programs_with_gnat.rst:\n\tDocument new feature.\n\t* gnat_ugn.texi: Regenerate.\n\nFrom-SVN: r272972", "tree": {"sha": "d92325f60a440a1745affa95115da988cb79db44", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d92325f60a440a1745affa95115da988cb79db44"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c4487c3be84e0b892aeb61f30435638c6d94a8ab", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c4487c3be84e0b892aeb61f30435638c6d94a8ab", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c4487c3be84e0b892aeb61f30435638c6d94a8ab", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c4487c3be84e0b892aeb61f30435638c6d94a8ab/comments", "author": {"login": "bobduff", "id": 29099567, "node_id": "MDQ6VXNlcjI5MDk5NTY3", "avatar_url": "https://avatars.githubusercontent.com/u/29099567?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bobduff", "html_url": "https://github.com/bobduff", "followers_url": "https://api.github.com/users/bobduff/followers", "following_url": "https://api.github.com/users/bobduff/following{/other_user}", "gists_url": "https://api.github.com/users/bobduff/gists{/gist_id}", "starred_url": "https://api.github.com/users/bobduff/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bobduff/subscriptions", "organizations_url": "https://api.github.com/users/bobduff/orgs", "repos_url": "https://api.github.com/users/bobduff/repos", "events_url": "https://api.github.com/users/bobduff/events{/privacy}", "received_events_url": "https://api.github.com/users/bobduff/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "bf4f18bded58c7710276877ea8648b12ac3088be", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bf4f18bded58c7710276877ea8648b12ac3088be", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bf4f18bded58c7710276877ea8648b12ac3088be"}], "stats": {"total": 85, "additions": 84, "deletions": 1}, "files": [{"sha": "750100e90621cdfea1a108c0cf9ce3cc3e6f79d8", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c4487c3be84e0b892aeb61f30435638c6d94a8ab/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c4487c3be84e0b892aeb61f30435638c6d94a8ab/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=c4487c3be84e0b892aeb61f30435638c6d94a8ab", "patch": "@@ -1,3 +1,16 @@\n+2019-07-03  Bob Duff  <duff@adacore.com>\n+\n+\t* par-ch3.adb (P_Defining_Identifier): Call\n+\tCheck_Defining_Identifier_Casing.\n+\t* style.ads, styleg.ads, styleg.adb\n+\t(Check_Defining_Identifier_Casing): New procedure to check for\n+\tmixed-case defining identifiers.\n+\t* stylesw.ads, stylesw.adb (Style_Check_Mixed_Case_Decls): New\n+\tflag for checking for mixed-case defining identifiers.\n+\t* doc/gnat_ugn/building_executable_programs_with_gnat.rst:\n+\tDocument new feature.\n+\t* gnat_ugn.texi: Regenerate.\n+\n 2019-07-03  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* doc/gnat_ugn/building_executable_programs_with_gnat.rst"}, {"sha": "57c3fe1573b0511067368549693472feef820997", "filename": "gcc/ada/doc/gnat_ugn/building_executable_programs_with_gnat.rst", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c4487c3be84e0b892aeb61f30435638c6d94a8ab/gcc%2Fada%2Fdoc%2Fgnat_ugn%2Fbuilding_executable_programs_with_gnat.rst", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c4487c3be84e0b892aeb61f30435638c6d94a8ab/gcc%2Fada%2Fdoc%2Fgnat_ugn%2Fbuilding_executable_programs_with_gnat.rst", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fdoc%2Fgnat_ugn%2Fbuilding_executable_programs_with_gnat.rst?ref=c4487c3be84e0b892aeb61f30435638c6d94a8ab", "patch": "@@ -4690,6 +4690,16 @@ checks to be performed. The following checks are defined:\n   allowed).\n \n \n+.. index:: -gnatyD (gcc)\n+\n+:switch:`-gnatyD`\n+  *Check declared identifiers in mixed case.*\n+\n+  Declared identifiers must be in mixed case, as in\n+  This_Is_An_Identifier. Use -gnatyr in addition to ensure\n+  that references match declarations.\n+\n+\n .. index:: -gnatye (gcc)\n \n :switch:`-gnatye`"}, {"sha": "7371a76ae3113135f06da2bbb53a184fec0ec068", "filename": "gcc/ada/gnat_ugn.texi", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c4487c3be84e0b892aeb61f30435638c6d94a8ab/gcc%2Fada%2Fgnat_ugn.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c4487c3be84e0b892aeb61f30435638c6d94a8ab/gcc%2Fada%2Fgnat_ugn.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgnat_ugn.texi?ref=c4487c3be84e0b892aeb61f30435638c6d94a8ab", "patch": "@@ -13515,6 +13515,20 @@ character (in particular the DOS line terminator sequence CR/LF is not\n allowed).\n @end table\n \n+@geindex -gnatyD (gcc)\n+\n+\n+@table @asis\n+\n+@item @code{-gnatyD}\n+\n+@emph{Check declared identifiers in mixed case.}\n+\n+Declared identifiers must be in mixed case, as in\n+This_Is_An_Identifier. Use -gnatyr in addition to ensure\n+that references match declarations.\n+@end table\n+\n @geindex -gnatye (gcc)\n \n "}, {"sha": "aff14ed18b5f551a63e68a1a20b09ba83ce72a99", "filename": "gcc/ada/par-ch3.adb", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c4487c3be84e0b892aeb61f30435638c6d94a8ab/gcc%2Fada%2Fpar-ch3.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c4487c3be84e0b892aeb61f30435638c6d94a8ab/gcc%2Fada%2Fpar-ch3.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fpar-ch3.adb?ref=c4487c3be84e0b892aeb61f30435638c6d94a8ab", "patch": "@@ -228,8 +228,12 @@ package body Ch3 is\n          raise Error_Resync;\n       end if;\n \n+      if Style_Check then\n+         Style.Check_Defining_Identifier_Casing;\n+      end if;\n+\n       Ident_Node := Token_Node;\n-      Scan; -- past the reserved identifier\n+      Scan; -- past the identifier\n \n       --  If we already have a defining identifier, clean it out and make\n       --  a new clean identifier. This situation arises in some error cases"}, {"sha": "0e75389e3677429bec1bb392d927a255afd99962", "filename": "gcc/ada/style.ads", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c4487c3be84e0b892aeb61f30435638c6d94a8ab/gcc%2Fada%2Fstyle.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c4487c3be84e0b892aeb61f30435638c6d94a8ab/gcc%2Fada%2Fstyle.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fstyle.ads?ref=c4487c3be84e0b892aeb61f30435638c6d94a8ab", "patch": "@@ -125,6 +125,9 @@ package Style is\n    --  Called with Scan_Ptr pointing to the first minus sign of a comment.\n    --  Intended for checking any specific rules for comment placement/format.\n \n+   procedure Check_Defining_Identifier_Casing\n+     renames Style_Inst.Check_Defining_Identifier_Casing;\n+\n    procedure Check_Dot_Dot\n      renames Style_Inst.Check_Dot_Dot;\n    --  Called after scanning out dot dot to check spacing\n@@ -219,4 +222,5 @@ package Style is\n    --  lower case letters. On entry Token_Ptr points to the keyword token.\n    --  This is not used for keywords appearing as attribute designators,\n    --  where instead Check_Attribute_Name (True) is called.\n+\n end Style;"}, {"sha": "fc2364b43f378a637ad58fe42803eab4d9b70d01", "filename": "gcc/ada/styleg.adb", "status": "modified", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c4487c3be84e0b892aeb61f30435638c6d94a8ab/gcc%2Fada%2Fstyleg.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c4487c3be84e0b892aeb61f30435638c6d94a8ab/gcc%2Fada%2Fstyleg.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fstyleg.adb?ref=c4487c3be84e0b892aeb61f30435638c6d94a8ab", "patch": "@@ -610,6 +610,27 @@ package body Styleg is\n       end if;\n    end Check_Comment;\n \n+   --------------------------------------\n+   -- Check_Defining_Identifier_Casing --\n+   --------------------------------------\n+\n+   procedure Check_Defining_Identifier_Casing is\n+   begin\n+      if Style_Check_Mixed_Case_Decls then\n+         case Determine_Token_Casing is\n+            when All_Upper_Case | All_Lower_Case =>\n+               Error_Msg_SC -- CODEFIX\n+                 (\"(style) bad capitalization, mixed case required\");\n+\n+            --  The Unknown case is something like A_B_C, which is both all\n+            --  caps and mixed case.\n+\n+            when Mixed_Case | Unknown =>\n+               null; -- OK\n+         end case;\n+      end if;\n+   end Check_Defining_Identifier_Casing;\n+\n    -------------------\n    -- Check_Dot_Dot --\n    -------------------"}, {"sha": "f176c0282a17aa17ac9f8458898c477686293da0", "filename": "gcc/ada/styleg.ads", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c4487c3be84e0b892aeb61f30435638c6d94a8ab/gcc%2Fada%2Fstyleg.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c4487c3be84e0b892aeb61f30435638c6d94a8ab/gcc%2Fada%2Fstyleg.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fstyleg.ads?ref=c4487c3be84e0b892aeb61f30435638c6d94a8ab", "patch": "@@ -91,6 +91,11 @@ package Styleg is\n    --  Called with Scan_Ptr pointing to the first minus sign of a comment.\n    --  Intended for checking any specific rules for comment placement/format.\n \n+   procedure Check_Defining_Identifier_Casing;\n+   --  The current token is an identifier that will be a defining\n+   --  identifier. Check that it is mixed case, if the appropriate\n+   --  switch is set.\n+\n    procedure Check_Dot_Dot;\n    --  Called after scanning out dot dot to check spacing\n "}, {"sha": "929e2d7d9bdebd883a9b6a5bae38d13612e850ac", "filename": "gcc/ada/stylesw.adb", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c4487c3be84e0b892aeb61f30435638c6d94a8ab/gcc%2Fada%2Fstylesw.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c4487c3be84e0b892aeb61f30435638c6d94a8ab/gcc%2Fada%2Fstylesw.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fstylesw.adb?ref=c4487c3be84e0b892aeb61f30435638c6d94a8ab", "patch": "@@ -79,6 +79,7 @@ package body Stylesw is\n       Style_Check_Boolean_And_Or        := False;\n       Style_Check_Comments              := False;\n       Style_Check_DOS_Line_Terminator   := False;\n+      Style_Check_Mixed_Case_Decls      := False;\n       Style_Check_End_Labels            := False;\n       Style_Check_Form_Feeds            := False;\n       Style_Check_Horizontal_Tabs       := False;\n@@ -168,6 +169,7 @@ package body Stylesw is\n       end if;\n \n       Add ('d', Style_Check_DOS_Line_Terminator);\n+      Add ('D', Style_Check_Mixed_Case_Decls);\n       Add ('e', Style_Check_End_Labels);\n       Add ('f', Style_Check_Form_Feeds);\n       Add ('h', Style_Check_Horizontal_Tabs);\n@@ -336,6 +338,9 @@ package body Stylesw is\n             when 'd' =>\n                Style_Check_DOS_Line_Terminator   := True;\n \n+            when 'D' =>\n+               Style_Check_Mixed_Case_Decls      := True;\n+\n             when 'e' =>\n                Style_Check_End_Labels            := True;\n \n@@ -503,6 +508,9 @@ package body Stylesw is\n             when 'd' =>\n                Style_Check_DOS_Line_Terminator   := False;\n \n+            when 'D' =>\n+               Style_Check_Mixed_Case_Decls      := False;\n+\n             when 'e' =>\n                Style_Check_End_Labels            := False;\n "}, {"sha": "de1f92d125503d17c0d78b56ccf5672605716218", "filename": "gcc/ada/stylesw.ads", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c4487c3be84e0b892aeb61f30435638c6d94a8ab/gcc%2Fada%2Fstylesw.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c4487c3be84e0b892aeb61f30435638c6d94a8ab/gcc%2Fada%2Fstylesw.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fstylesw.ads?ref=c4487c3be84e0b892aeb61f30435638c6d94a8ab", "patch": "@@ -113,6 +113,10 @@ package Stylesw is\n    --  the line terminator must be a single LF, without an associated CR (e.g.\n    --  DOS line terminator sequence CR/LF not allowed).\n \n+   Style_Check_Mixed_Case_Decls : Boolean := False;\n+   --  This can be set True by using the -gnatyD switch. If it is True, then\n+   --  declared identifiers must be in Mixed_Case.\n+\n    Style_Check_End_Labels : Boolean := False;\n    --  This can be set True by using the -gnatye switch. If it is True, then\n    --  optional END labels must always be present."}]}