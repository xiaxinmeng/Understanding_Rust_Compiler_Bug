{"sha": "32d1c3dd1d63399cca20567fb35d1ff90e30b655", "node_id": "C_kwDOANBUbNoAKDMyZDFjM2RkMWQ2MzM5OWNjYTIwNTY3ZmIzNWQxZmY5MGUzMGI2NTU", "commit": {"author": {"name": "Gaius Mulley", "email": "gaiusmod2@gmail.com", "date": "2023-01-27T16:38:29Z"}, "committer": {"name": "Gaius Mulley", "email": "gaiusmod2@gmail.com", "date": "2023-01-27T16:38:29Z"}, "message": "Tidy up to declarations allowing files to be built by gm2\n\nThis patch adds missing declarations in export qualified lists\nand fixes comparisons of an address type against NIL.\nThese changes allow make m2/stage2/cc1gm2 to succeed when in\nmaintainer mode.\n\ngcc/m2/ChangeLog:\n\n\t* gm2-compiler/M2Options.def: Export GetMQ, SetMQ.\n\t* gm2-compiler/M2Preprocess.mod: (MakeSaveTempsFileName):\n\tTest NewDir against NIL.  Test Dumpdir against NIL.\n\tTest GetMD () against NIL.  Test GetMMD () against NIL.\n\tTest GetMQ () against NIL.  Test GetObj () against NIL.\n\tTest tempfile against NIL.\n\t* gm2-compiler/P2SymBuild.def: Export\n\tBuildNoReturnAttribute.\n\nSigned-off-by: Gaius Mulley <gaiusmod2@gmail.com>", "tree": {"sha": "81c393a9668e9f1f9f7ec0da67788e904ed52d1f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/81c393a9668e9f1f9f7ec0da67788e904ed52d1f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/32d1c3dd1d63399cca20567fb35d1ff90e30b655", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/32d1c3dd1d63399cca20567fb35d1ff90e30b655", "html_url": "https://github.com/Rust-GCC/gccrs/commit/32d1c3dd1d63399cca20567fb35d1ff90e30b655", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/32d1c3dd1d63399cca20567fb35d1ff90e30b655/comments", "author": null, "committer": null, "parents": [{"sha": "def6e12e3488557dde9665db620ca53f9424713e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/def6e12e3488557dde9665db620ca53f9424713e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/def6e12e3488557dde9665db620ca53f9424713e"}], "stats": {"total": 20, "additions": 11, "deletions": 9}, "files": [{"sha": "dd2698430057fb7879e0da4ec32d6c27d65dc763", "filename": "gcc/m2/gm2-compiler/M2Options.def", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/32d1c3dd1d63399cca20567fb35d1ff90e30b655/gcc%2Fm2%2Fgm2-compiler%2FM2Options.def", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/32d1c3dd1d63399cca20567fb35d1ff90e30b655/gcc%2Fm2%2Fgm2-compiler%2FM2Options.def", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fm2%2Fgm2-compiler%2FM2Options.def?ref=32d1c3dd1d63399cca20567fb35d1ff90e30b655", "patch": "@@ -93,7 +93,8 @@ EXPORT QUALIFIED SetReturnCheck, SetNilCheck, SetCaseCheck,\n                  SetScaffoldMain, ScaffoldMain,\n                  SetRuntimeModuleOverride, GetRuntimeModuleOverride,\n                  SetGenModuleList, GetGenModuleFilename, SharedFlag,\n-                 SetB, GetB, SetMD, GetMD, SetMMD, GetMMD, SetObj, GetObj ;\n+                 SetB, GetB, SetMD, GetMD, SetMMD, GetMMD, SetObj, GetObj,\n+                 GetMQ, SetMQ ;\n \n \n VAR"}, {"sha": "d63db35f93898dcc1e61e3ff11074851227620d9", "filename": "gcc/m2/gm2-compiler/M2Preprocess.mod", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/32d1c3dd1d63399cca20567fb35d1ff90e30b655/gcc%2Fm2%2Fgm2-compiler%2FM2Preprocess.mod", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/32d1c3dd1d63399cca20567fb35d1ff90e30b655/gcc%2Fm2%2Fgm2-compiler%2FM2Preprocess.mod", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fm2%2Fgm2-compiler%2FM2Preprocess.mod?ref=32d1c3dd1d63399cca20567fb35d1ff90e30b655", "patch": "@@ -134,7 +134,7 @@ PROCEDURE MakeSaveTempsFileName (filename: String) : String ;\n VAR\n    NewName,\n    DumpDir,\n-   NewDir: String ;\n+   NewDir : String ;\n BEGIN\n    NewName := ConCat (GetFileName (filename), InitString ('.m2i')) ;\n    NewDir := GetSaveTempsDir () ;\n@@ -146,7 +146,7 @@ BEGIN\n       fprintf1 (StdOut, \" DumpDir: %s\\n\", DumpDir)\n    END ;\n *)\n-   IF (NewDir AND EqualArray (NewDir, 'obj')) AND DumpDir\n+   IF (NewDir#NIL) AND EqualArray (NewDir, 'obj') AND (DumpDir#NIL)\n    THEN\n       RETURN Dup (ConCat (DumpDir, NewName))\n    ELSE\n@@ -181,20 +181,20 @@ BEGIN\n       (* We support MD and MMD for the main file only, at present.  *)\n       IF isMain OR PPonly\n       THEN\n-         IF GetMD ()\n+         IF GetMD () # NIL\n          THEN\n             tempfile := ConCat( Mark (InitString(' -MD ')),\n                                 InitStringCharStar (GetMD ()))\n-         ELSIF GetMMD ()\n+         ELSIF GetMMD () # NIL\n          THEN\n             tempfile := ConCat( Mark (InitString(' -MMD ')),\n                                 InitStringCharStar (GetMMD ()))\n          END ;\n-         IF tempfile\n+         IF tempfile#NIL\n          THEN\n             commandLine := ConCat (Dup (commandLine), Dup (tempfile)) ;\n             (* We can only add MQ if we already have an MD/MMD.  *)\n-            IF GetMQ ()\n+            IF GetMQ () # NIL\n             THEN\n                tempfile := ConCat( Mark (InitString(' -MQ ')),\n                                  InitStringCharStar (GetMQ ())) ;\n@@ -207,7 +207,7 @@ BEGIN\n       tempfile := NIL ;\n       IF PPonly\n       THEN\n-         IF GetObj()\n+         IF GetObj () # NIL\n          THEN\n            tempfile := InitStringCharStar (GetObj ())\n          END ;\n@@ -218,7 +218,7 @@ BEGIN\n          tempfile := InitStringCharStar (make_temp_file (KeyToCharStar (MakeKey('.m2i'))))\n       END ;\n       commandLine := ConCat (ConCatChar (Dup (commandLine), ' '), filename) ;\n-      IF tempfile\n+      IF tempfile # NIL\n       THEN\n          commandLine := ConCat (ConCat (Dup (commandLine),\n                                         Mark (InitString(' -o '))), tempfile) ;"}, {"sha": "d5dd9feb25c0162aacc26ee68fbbba3a4ff84c7a", "filename": "gcc/m2/gm2-compiler/P2SymBuild.def", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/32d1c3dd1d63399cca20567fb35d1ff90e30b655/gcc%2Fm2%2Fgm2-compiler%2FP2SymBuild.def", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/32d1c3dd1d63399cca20567fb35d1ff90e30b655/gcc%2Fm2%2Fgm2-compiler%2FP2SymBuild.def", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fm2%2Fgm2-compiler%2FP2SymBuild.def?ref=32d1c3dd1d63399cca20567fb35d1ff90e30b655", "patch": "@@ -61,6 +61,7 @@ EXPORT QUALIFIED P2StartBuildDefModule,\n                  BuildOptArg,\n                  StartBuildProcedure,\n                  EndBuildProcedure,\n+                 BuildNoReturnAttribute,\n                  BuildFunction,\n                  BuildOptFunction,\n                  BuildPointerType,"}]}