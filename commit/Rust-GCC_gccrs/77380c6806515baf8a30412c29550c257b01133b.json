{"sha": "77380c6806515baf8a30412c29550c257b01133b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzczODBjNjgwNjUxNWJhZjhhMzA0MTJjMjk1NTBjMjU3YjAxMTMzYg==", "commit": {"author": {"name": "Tom Tromey", "email": "tom@tromey.com", "date": "2021-04-29T00:44:48Z"}, "committer": {"name": "Tom Tromey", "email": "tom@tromey.com", "date": "2021-05-06T14:51:28Z"}, "message": "libiberty: add htab_eq_string\n\nThe libiberty hash table includes a helper function for strings, but\nno equality function.  Consequently, this equality function has been\nreimplemented a number of times in both the gcc and binutils-gdb\nsource trees.  This patch adds the function to the libiberty hash\ntable, as a step toward the goal of removing all the copies.\n\nOne change to gcc is included here.  Normally I would have put this in\nthe next patch, but gensupport.c used the most natural name for its\nreimplementation of this function, and this can't coexist with the\nextern function in libiberty.\n\ninclude\n\n\t* hashtab.h (htab_eq_string): Declare.\n\nlibiberty\n\n\t* hashtab.c (htab_eq_string): New function.\n\ngcc\n\n\t* gensupport.c (htab_eq_string): Remove.", "tree": {"sha": "64da23212825d86de5c67fac7e7897a3f9fe1d77", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/64da23212825d86de5c67fac7e7897a3f9fe1d77"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/77380c6806515baf8a30412c29550c257b01133b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/77380c6806515baf8a30412c29550c257b01133b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/77380c6806515baf8a30412c29550c257b01133b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/77380c6806515baf8a30412c29550c257b01133b/comments", "author": {"login": "tromey", "id": 1557670, "node_id": "MDQ6VXNlcjE1NTc2NzA=", "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tromey", "html_url": "https://github.com/tromey", "followers_url": "https://api.github.com/users/tromey/followers", "following_url": "https://api.github.com/users/tromey/following{/other_user}", "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}", "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tromey/subscriptions", "organizations_url": "https://api.github.com/users/tromey/orgs", "repos_url": "https://api.github.com/users/tromey/repos", "events_url": "https://api.github.com/users/tromey/events{/privacy}", "received_events_url": "https://api.github.com/users/tromey/received_events", "type": "User", "site_admin": false}, "committer": {"login": "tromey", "id": 1557670, "node_id": "MDQ6VXNlcjE1NTc2NzA=", "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tromey", "html_url": "https://github.com/tromey", "followers_url": "https://api.github.com/users/tromey/followers", "following_url": "https://api.github.com/users/tromey/following{/other_user}", "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}", "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tromey/subscriptions", "organizations_url": "https://api.github.com/users/tromey/orgs", "repos_url": "https://api.github.com/users/tromey/repos", "events_url": "https://api.github.com/users/tromey/events{/privacy}", "received_events_url": "https://api.github.com/users/tromey/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e69ac0203725fb8da83a1cc88d32191b7a0b2c0c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e69ac0203725fb8da83a1cc88d32191b7a0b2c0c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e69ac0203725fb8da83a1cc88d32191b7a0b2c0c"}], "stats": {"total": 18, "additions": 10, "deletions": 8}, "files": [{"sha": "e1ca06dbc1ec1463c990ec28da407eb8fa07529c", "filename": "gcc/gensupport.c", "status": "modified", "additions": 0, "deletions": 8, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/77380c6806515baf8a30412c29550c257b01133b/gcc%2Fgensupport.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/77380c6806515baf8a30412c29550c257b01133b/gcc%2Fgensupport.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgensupport.c?ref=77380c6806515baf8a30412c29550c257b01133b", "patch": "@@ -2322,14 +2322,6 @@ gen_reader::handle_unknown_directive (file_location loc, const char *rtx_name)\n     process_rtx (x, loc);\n }\n \n-/* Comparison function for the mnemonic hash table.  */\n-\n-static int\n-htab_eq_string (const void *s1, const void *s2)\n-{\n-  return strcmp ((const char*)s1, (const char*)s2) == 0;\n-}\n-\n /* Add mnemonic STR with length LEN to the mnemonic hash table\n    MNEMONIC_HTAB.  A trailing zero end character is appended to STR\n    and a permanent heap copy of STR is created.  */"}, {"sha": "77c5eec7905515e1da6dce423d41d9b6cf37b525", "filename": "include/hashtab.h", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/77380c6806515baf8a30412c29550c257b01133b/include%2Fhashtab.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/77380c6806515baf8a30412c29550c257b01133b/include%2Fhashtab.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/include%2Fhashtab.h?ref=77380c6806515baf8a30412c29550c257b01133b", "patch": "@@ -192,6 +192,9 @@ extern htab_eq htab_eq_pointer;\n /* A hash function for null-terminated strings.  */\n extern hashval_t htab_hash_string (const void *);\n \n+/* An equality function for null-terminated strings.  */\n+extern int htab_eq_string (const void *, const void *);\n+\n /* An iterative hash function for arbitrary data.  */\n extern hashval_t iterative_hash (const void *, size_t, hashval_t);\n /* Shorthand for hashing something with an intrinsic size.  */"}, {"sha": "7c424e8f6cc1f11c62560d6db5a38dead4e266ea", "filename": "libiberty/hashtab.c", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/77380c6806515baf8a30412c29550c257b01133b/libiberty%2Fhashtab.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/77380c6806515baf8a30412c29550c257b01133b/libiberty%2Fhashtab.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libiberty%2Fhashtab.c?ref=77380c6806515baf8a30412c29550c257b01133b", "patch": "@@ -841,6 +841,13 @@ htab_hash_string (const PTR p)\n   return r;\n }\n \n+/* An equality function for null-terminated strings.  */\n+int\n+htab_eq_string (const void *a, const void *b)\n+{\n+  return strcmp ((const char *) a, (const char *) b) == 0;\n+}\n+\n /* DERIVED FROM:\n --------------------------------------------------------------------\n lookup2.c, by Bob Jenkins, December 1996, Public Domain."}]}