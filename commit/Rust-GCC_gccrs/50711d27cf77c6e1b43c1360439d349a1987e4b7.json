{"sha": "50711d27cf77c6e1b43c1360439d349a1987e4b7", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTA3MTFkMjdjZjc3YzZlMWI0M2MxMzYwNDM5ZDM0OWExOTg3ZTRiNw==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@libertysurf.fr", "date": "2004-07-08T16:39:10Z"}, "committer": {"name": "Eric Botcazou", "email": "ebotcazou@gcc.gnu.org", "date": "2004-07-08T16:39:10Z"}, "message": "sparc.md (UNSPECV_GOTO_V9): Delete.\n\n\t* config/sparc/sparc.md (UNSPECV_GOTO_V9): Delete.\n\t(arch attribute): Delete.\n\t(current_function_calls_alloca attribute): Rename into calls_alloca.\n\t(calls_eh_return): New attribute.\n\t(leaf_function): Likewise.\n\t(length attribute): Fix formula for sibcalls.\n\t(return insn): Correctly compute the 'length' attribute.\n\t(do_builtin_setjmp_setup): Adjust use of current_function_calls_alloca.\n\nFrom-SVN: r84299", "tree": {"sha": "f764d02c5d27527166f4053f220b40e485b0c530", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f764d02c5d27527166f4053f220b40e485b0c530"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/50711d27cf77c6e1b43c1360439d349a1987e4b7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/50711d27cf77c6e1b43c1360439d349a1987e4b7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/50711d27cf77c6e1b43c1360439d349a1987e4b7", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/50711d27cf77c6e1b43c1360439d349a1987e4b7/comments", "author": {"login": "ebotcazou", "id": 48091907, "node_id": "MDQ6VXNlcjQ4MDkxOTA3", "avatar_url": "https://avatars.githubusercontent.com/u/48091907?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ebotcazou", "html_url": "https://github.com/ebotcazou", "followers_url": "https://api.github.com/users/ebotcazou/followers", "following_url": "https://api.github.com/users/ebotcazou/following{/other_user}", "gists_url": "https://api.github.com/users/ebotcazou/gists{/gist_id}", "starred_url": "https://api.github.com/users/ebotcazou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ebotcazou/subscriptions", "organizations_url": "https://api.github.com/users/ebotcazou/orgs", "repos_url": "https://api.github.com/users/ebotcazou/repos", "events_url": "https://api.github.com/users/ebotcazou/events{/privacy}", "received_events_url": "https://api.github.com/users/ebotcazou/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "cd7097527ee51b1bef879ef53505dff0673c98ba", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cd7097527ee51b1bef879ef53505dff0673c98ba", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cd7097527ee51b1bef879ef53505dff0673c98ba"}], "stats": {"total": 70, "additions": 53, "deletions": 17}, "files": [{"sha": "da392fd3325d32c1ed9986fb899b5139c4d0fef4", "filename": "gcc/ChangeLog", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/50711d27cf77c6e1b43c1360439d349a1987e4b7/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/50711d27cf77c6e1b43c1360439d349a1987e4b7/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=50711d27cf77c6e1b43c1360439d349a1987e4b7", "patch": "@@ -1,3 +1,14 @@\n+2004-07-08  Eric Botcazou  <ebotcazou@libertysurf.fr>\n+\n+\t* config/sparc/sparc.md (UNSPECV_GOTO_V9): Delete.\n+\t(arch attribute): Delete.\n+\t(current_function_calls_alloca attribute): Rename into calls_alloca.\n+\t(calls_eh_return): New attribute.\n+\t(leaf_function): Likewise.\n+\t(length attribute): Fix formula for sibcalls.\n+\t(return insn): Correctly compute the 'length' attribute.\n+\t(do_builtin_setjmp_setup): Adjust use of current_function_calls_alloca.\n+\n 2004-07-08  Richard Henderson  <rth@redhat.com>\n \n \t* tree-cfg.c (make_exit_edges): Use get_call_expr_in."}, {"sha": "bccb4eab8e262b494916cb98b2b8abfdd111aba9", "filename": "gcc/config/sparc/sparc.md", "status": "modified", "additions": 42, "deletions": 17, "changes": 59, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/50711d27cf77c6e1b43c1360439d349a1987e4b7/gcc%2Fconfig%2Fsparc%2Fsparc.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/50711d27cf77c6e1b43c1360439d349a1987e4b7/gcc%2Fconfig%2Fsparc%2Fsparc.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fsparc%2Fsparc.md?ref=50711d27cf77c6e1b43c1360439d349a1987e4b7", "patch": "@@ -51,7 +51,6 @@\n   [(UNSPECV_BLOCKAGE\t\t0)\n    (UNSPECV_FLUSHW\t\t1)\n    (UNSPECV_GOTO\t\t2)\n-   (UNSPECV_GOTO_V9\t\t3)\n    (UNSPECV_FLUSH\t\t4)\n    (UNSPECV_SETJMP\t\t5)\n    (UNSPECV_SAVEW\t\t6)\n@@ -88,14 +87,7 @@\n \t (symbol_ref \"TARGET_SPARCLET\") (const_string \"sparclet\")]\n \t(const_string \"v7\"))))\n \n-;; Architecture size.\n-(define_attr \"arch\" \"arch32bit,arch64bit\"\n- (const\n-  (cond [(symbol_ref \"TARGET_ARCH64\") (const_string \"arch64bit\")]\n-\t(const_string \"arch32bit\"))))\n-\n ;; Insn type.\n-\n (define_attr \"type\"\n   \"ialu,compare,shift,\n    load,sload,store,\n@@ -113,27 +105,42 @@\n    multi,savew,flushw,iflush,trap\"\n   (const_string \"ialu\"))\n \n-;; true if branch/call has empty delay slot and will emit a nop in it\n+;; True if branch/call has empty delay slot and will emit a nop in it\n (define_attr \"empty_delay_slot\" \"false,true\"\n   (symbol_ref \"empty_delay_slot (insn)\"))\n \n-(define_attr \"branch_type\" \"none,icc,fcc,reg\" (const_string \"none\"))\n+(define_attr \"branch_type\" \"none,icc,fcc,reg\"\n+  (const_string \"none\"))\n \n (define_attr \"pic\" \"false,true\"\n   (symbol_ref \"flag_pic != 0\"))\n \n-(define_attr \"current_function_calls_alloca\" \"false,true\"\n+(define_attr \"calls_alloca\" \"false,true\"\n   (symbol_ref \"current_function_calls_alloca != 0\"))\n \n+(define_attr \"calls_eh_return\" \"false,true\"\n+   (symbol_ref \"current_function_calls_eh_return !=0 \"))\n+   \n+(define_attr \"leaf_function\" \"false,true\"\n+  (symbol_ref \"current_function_uses_only_leaf_regs != 0\"))\n+\n (define_attr \"delayed_branch\" \"false,true\"\n   (symbol_ref \"flag_delayed_branch != 0\"))\n \n ;; Length (in # of insns).\n (define_attr \"length\" \"\"\n-  (cond [(eq_attr \"type\" \"uncond_branch,call,sibcall\")\n+  (cond [(eq_attr \"type\" \"uncond_branch,call\")\n \t   (if_then_else (eq_attr \"empty_delay_slot\" \"true\")\n \t     (const_int 2)\n \t     (const_int 1))\n+\t (eq_attr \"type\" \"sibcall\")\n+\t   (if_then_else (eq_attr \"leaf_function\" \"true\")\n+\t     (if_then_else (eq_attr \"empty_delay_slot\" \"true\")\n+\t       (const_int 3)\n+\t       (const_int 2))\n+\t     (if_then_else (eq_attr \"empty_delay_slot\" \"true\")\n+\t       (const_int 2)\n+\t       (const_int 1)))\n \t (eq_attr \"branch_type\" \"icc\")\n \t   (if_then_else (match_operand 0 \"noov_compare64_op\" \"\")\n \t     (if_then_else (lt (pc) (match_dup 1))\n@@ -197,17 +204,18 @@\n \t ] (const_int 1)))\n \n ;; FP precision.\n-(define_attr \"fptype\" \"single,double\" (const_string \"single\"))\n+(define_attr \"fptype\" \"single,double\"\n+  (const_string \"single\"))\n \n ;; UltraSPARC-III integer load type.\n-(define_attr \"us3load_type\" \"2cycle,3cycle\" (const_string \"2cycle\"))\n+(define_attr \"us3load_type\" \"2cycle,3cycle\"\n+  (const_string \"2cycle\"))\n \n (define_asm_attributes\n   [(set_attr \"length\" \"2\")\n    (set_attr \"type\" \"multi\")])\n \n ;; Attributes for instruction and branch scheduling\n-\n (define_attr \"tls_call_delay\" \"false,true\"\n   (symbol_ref \"tls_call_delay (insn)\"))\n \n@@ -7699,7 +7707,24 @@\n   \"\"\n   \"* return output_return (insn);\"\n   [(set_attr \"type\" \"return\")\n-   (set_attr \"length\" \"2\")])\n+   (set (attr \"length\")\n+\t(if_then_else (eq_attr \"leaf_function\" \"true\")\n+\t\t      (if_then_else (eq_attr \"empty_delay_slot\" \"true\")\n+\t\t\t\t    (const_int 2)\n+\t\t\t\t    (const_int 1))\n+\t\t      (if_then_else (eq_attr \"calls_eh_return\" \"true\")\n+\t\t\t\t    (if_then_else (eq_attr \"delayed_branch\" \"true\")\n+\t\t\t\t\t\t  (if_then_else (eq_attr \"isa\" \"v9\")\n+\t\t\t\t\t\t\t\t(const_int 2)\n+\t\t\t\t\t\t\t\t(const_int 3))\n+\t\t\t\t\t\t  (if_then_else (eq_attr \"isa\" \"v9\")\n+\t\t\t\t\t\t\t\t(const_int 3)\n+\t\t\t\t\t\t\t\t(const_int 4)))\n+\t\t\t\t    (if_then_else (eq_attr \"empty_delay_slot\" \"true\")\n+\t\t\t\t\t\t  (if_then_else (eq_attr \"delayed_branch\" \"true\")\n+\t\t\t\t\t\t\t\t(const_int 2)\n+\t\t\t\t\t\t\t\t(const_int 3))\n+\t\t\t\t\t\t  (const_int 1)))))])\n \n ;; UNSPEC_VOLATILE is considered to use and clobber all hard registers and\n ;; all of memory.  This blocks insns from being moved across this point.\n@@ -7889,7 +7914,7 @@\n }\n   [(set_attr \"type\" \"multi\")\n    (set (attr \"length\")\n-        (cond [(eq_attr \"current_function_calls_alloca\" \"false\")\n+        (cond [(eq_attr \"calls_alloca\" \"false\")\n                  (const_int 0)\n                (eq_attr \"isa\" \"!v9\")\n                  (const_int 1)"}]}