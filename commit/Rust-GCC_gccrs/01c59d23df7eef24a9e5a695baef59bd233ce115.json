{"sha": "01c59d23df7eef24a9e5a695baef59bd233ce115", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDFjNTlkMjNkZjdlZWYyNGE5ZTVhNjk1YmFlZjU5YmQyMzNjZTExNQ==", "commit": {"author": {"name": "Richard Guenther", "email": "rguenther@suse.de", "date": "2012-08-07T14:16:11Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2012-08-07T14:16:11Z"}, "message": "tree-dfa.c (set_ssa_default_def): Clear the SSA_NAME_DEFAULT_DEF bit of the old name when we clear the slot.\n\n2012-08-07  Richard Guenther  <rguenther@suse.de>\n\n\t* tree-dfa.c (set_ssa_default_def): Clear the SSA_NAME_DEFAULT_DEF\n\tbit of the old name when we clear the slot.\n\t* tree-ssa-live.c (remove_unused_locals): Release any default\n\tdef associated with an unused var.\n\t* tree-ssa-copy.c (may_propagate_copy_into_asm): Always return true.\n\nFrom-SVN: r190201", "tree": {"sha": "39a6a8bb8b9c76f26ebb0675ce99e03139c76b3f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/39a6a8bb8b9c76f26ebb0675ce99e03139c76b3f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/01c59d23df7eef24a9e5a695baef59bd233ce115", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/01c59d23df7eef24a9e5a695baef59bd233ce115", "html_url": "https://github.com/Rust-GCC/gccrs/commit/01c59d23df7eef24a9e5a695baef59bd233ce115", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/01c59d23df7eef24a9e5a695baef59bd233ce115/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "5f33a4fc3ebcee4a661ed760d037ecfdbb00cfc5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5f33a4fc3ebcee4a661ed760d037ecfdbb00cfc5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5f33a4fc3ebcee4a661ed760d037ecfdbb00cfc5"}], "stats": {"total": 29, "additions": 22, "deletions": 7}, "files": [{"sha": "09103dab98d604a26a55e6cfca1775fe4d0347f5", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/01c59d23df7eef24a9e5a695baef59bd233ce115/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/01c59d23df7eef24a9e5a695baef59bd233ce115/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=01c59d23df7eef24a9e5a695baef59bd233ce115", "patch": "@@ -1,3 +1,11 @@\n+2012-08-07  Richard Guenther  <rguenther@suse.de>\n+\n+\t* tree-dfa.c (set_ssa_default_def): Clear the SSA_NAME_DEFAULT_DEF\n+\tbit of the old name when we clear the slot.\n+\t* tree-ssa-live.c (remove_unused_locals): Release any default\n+\tdef associated with an unused var.\n+\t* tree-ssa-copy.c (may_propagate_copy_into_asm): Always return true.\n+\n 2012-08-07  Richard Guenther  <rguenther@suse.de>\n \n \t* tree-into-ssa.c (rewrite_stmt): Remove clobbers for variables"}, {"sha": "5342f1973a411fcd7681a543bb9c81bd90c9aebb", "filename": "gcc/tree-dfa.c", "status": "modified", "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/01c59d23df7eef24a9e5a695baef59bd233ce115/gcc%2Ftree-dfa.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/01c59d23df7eef24a9e5a695baef59bd233ce115/gcc%2Ftree-dfa.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-dfa.c?ref=01c59d23df7eef24a9e5a695baef59bd233ce115", "patch": "@@ -336,7 +336,10 @@ set_ssa_default_def (struct function *fn, tree var, tree def)\n       loc = htab_find_slot_with_hash (DEFAULT_DEFS (fn), &in,\n \t\t\t\t      DECL_UID (var), NO_INSERT);\n       if (*loc)\n-\thtab_clear_slot (DEFAULT_DEFS (fn), loc);\n+\t{\n+\t  SSA_NAME_IS_DEFAULT_DEF (*(tree *)loc) = false;\n+\t  htab_clear_slot (DEFAULT_DEFS (fn), loc);\n+\t}\n       return;\n     }\n   gcc_assert (TREE_CODE (def) == SSA_NAME && SSA_NAME_VAR (def) == var);\n@@ -349,7 +352,7 @@ set_ssa_default_def (struct function *fn, tree var, tree def)\n \n    /* Mark DEF as the default definition for VAR.  */\n   *(tree *) loc = def;\n-   SSA_NAME_IS_DEFAULT_DEF (def) = true;\n+  SSA_NAME_IS_DEFAULT_DEF (def) = true;\n }\n \n /* Retrieve or create a default definition for VAR.  */"}, {"sha": "c5fe156ce9ae6853c03a175540a68c2ee1b8660b", "filename": "gcc/tree-ssa-copy.c", "status": "modified", "additions": 2, "deletions": 5, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/01c59d23df7eef24a9e5a695baef59bd233ce115/gcc%2Ftree-ssa-copy.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/01c59d23df7eef24a9e5a695baef59bd233ce115/gcc%2Ftree-ssa-copy.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-copy.c?ref=01c59d23df7eef24a9e5a695baef59bd233ce115", "patch": "@@ -137,12 +137,9 @@ may_propagate_copy_into_stmt (gimple dest, tree orig)\n /* Similarly, but we know that we're propagating into an ASM_EXPR.  */\n \n bool\n-may_propagate_copy_into_asm (tree dest)\n+may_propagate_copy_into_asm (tree dest ATTRIBUTE_UNUSED)\n {\n-  /* Hard register operands of asms are special.  Do not bypass.  */\n-  return !(TREE_CODE (dest) == SSA_NAME\n-\t   && TREE_CODE (SSA_NAME_VAR (dest)) == VAR_DECL\n-\t   && DECL_HARD_REGISTER (SSA_NAME_VAR (dest)));\n+  return true;\n }\n \n "}, {"sha": "3edda1e378e1cca44beaee56887580bc6a9e0faa", "filename": "gcc/tree-ssa-live.c", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/01c59d23df7eef24a9e5a695baef59bd233ce115/gcc%2Ftree-ssa-live.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/01c59d23df7eef24a9e5a695baef59bd233ce115/gcc%2Ftree-ssa-live.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-live.c?ref=01c59d23df7eef24a9e5a695baef59bd233ce115", "patch": "@@ -798,9 +798,16 @@ remove_unused_locals (void)\n \t{\n \t  if (!is_used_p (var))\n \t    {\n+\t      tree def;\n \t      if (cfun->nonlocal_goto_save_area\n \t\t  && TREE_OPERAND (cfun->nonlocal_goto_save_area, 0) == var)\n \t\tcfun->nonlocal_goto_save_area = NULL;\n+\t      /* Release any default def associated with var.  */\n+\t      if ((def = ssa_default_def (cfun, var)) != NULL_TREE)\n+\t\t{\n+\t\t  set_ssa_default_def (cfun, var, NULL_TREE);\n+\t\t  release_ssa_name (def);\n+\t\t}\n \t      continue;\n \t    }\n \t}"}]}