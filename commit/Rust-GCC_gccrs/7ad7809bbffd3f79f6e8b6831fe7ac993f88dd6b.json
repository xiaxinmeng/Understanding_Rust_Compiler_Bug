{"sha": "7ad7809bbffd3f79f6e8b6831fe7ac993f88dd6b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2FkNzgwOWJiZmZkM2Y3OWY2ZThiNjgzMWZlN2FjOTkzZjg4ZGQ2Yg==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2009-01-06T20:41:52Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2009-01-06T20:41:52Z"}, "message": "re PR rtl-optimization/38722 (Revision 143027 causes ICE in find_decomposable_subregs)\n\n\tPR rtl-optimization/38722\n\t* combine.c (try_combine): Don't modify PATTERN (i3) and notes\n\ttoo early, only set a flag and modify after last possible\n\tundo_all point.\n\n\t* gfortran.dg/pr38722.f90: New test.\n\nFrom-SVN: r143132", "tree": {"sha": "e4aa7573a7e175a551cecb80d7c655a3680ee0ad", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e4aa7573a7e175a551cecb80d7c655a3680ee0ad"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7ad7809bbffd3f79f6e8b6831fe7ac993f88dd6b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7ad7809bbffd3f79f6e8b6831fe7ac993f88dd6b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7ad7809bbffd3f79f6e8b6831fe7ac993f88dd6b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7ad7809bbffd3f79f6e8b6831fe7ac993f88dd6b/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "fc7e95540999408dda59f94fdbdb96ee40ca185e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fc7e95540999408dda59f94fdbdb96ee40ca185e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fc7e95540999408dda59f94fdbdb96ee40ca185e"}], "stats": {"total": 72, "additions": 63, "deletions": 9}, "files": [{"sha": "8dafe634ff398e67246ccce70d3abd2ce50296ee", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7ad7809bbffd3f79f6e8b6831fe7ac993f88dd6b/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7ad7809bbffd3f79f6e8b6831fe7ac993f88dd6b/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=7ad7809bbffd3f79f6e8b6831fe7ac993f88dd6b", "patch": "@@ -1,3 +1,10 @@\n+2009-01-06  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR rtl-optimization/38722\n+\t* combine.c (try_combine): Don't modify PATTERN (i3) and notes\n+\ttoo early, only set a flag and modify after last possible\n+\tundo_all point.\n+\n 2009-01-06  Janis Johnson  <janis187@us.ibm.com>\n \n \tPR c/34252"}, {"sha": "0198342a9cc4f9a6f3d5c5fcc9b975dd0e91e2f3", "filename": "gcc/combine.c", "status": "modified", "additions": 13, "deletions": 9, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7ad7809bbffd3f79f6e8b6831fe7ac993f88dd6b/gcc%2Fcombine.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7ad7809bbffd3f79f6e8b6831fe7ac993f88dd6b/gcc%2Fcombine.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcombine.c?ref=7ad7809bbffd3f79f6e8b6831fe7ac993f88dd6b", "patch": "@@ -1,6 +1,6 @@\n /* Optimize by combining instructions for GNU compiler.\n    Copyright (C) 1987, 1988, 1992, 1993, 1994, 1995, 1996, 1997, 1998,\n-   1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008\n+   1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009\n    Free Software Foundation, Inc.\n \n This file is part of GCC.\n@@ -2208,6 +2208,7 @@ try_combine (rtx i3, rtx i2, rtx i1, int *new_direct_jump_p)\n   /* Notes that I1, I2 or I3 is a MULT operation.  */\n   int have_mult = 0;\n   int swap_i2i3 = 0;\n+  int changed_i3_dest = 0;\n \n   int maxreg;\n   rtx temp;\n@@ -2895,14 +2896,7 @@ try_combine (rtx i3, rtx i2, rtx i1, int *new_direct_jump_p)\n \t  insn_code_number = recog_for_combine (&newpat, i3, &new_i3_notes);\n \n \t  if (insn_code_number >= 0)\n-\t    {\n-\t      /* If we will be able to accept this, we have made a\n-\t\t change to the destination of I3.  This requires us to\n-\t\t do a few adjustments.  */\n-\n-\t      PATTERN (i3) = newpat;\n-\t      adjust_for_new_dest (i3);\n-\t    }\n+\t    changed_i3_dest = 1;\n \t}\n     }\n \n@@ -3375,6 +3369,16 @@ try_combine (rtx i3, rtx i2, rtx i1, int *new_direct_jump_p)\n       return 0;\n     }\n \n+  /* If we will be able to accept this, we have made a\n+     change to the destination of I3.  This requires us to\n+     do a few adjustments.  */\n+\n+  if (changed_i3_dest)\n+    {\n+      PATTERN (i3) = newpat;\n+      adjust_for_new_dest (i3);\n+    }\n+\n   /* We now know that we can do this combination.  Merge the insns and\n      update the status of registers and LOG_LINKS.  */\n "}, {"sha": "5d7c49dd6eac5f5c46ee2bd5ef968146c635ab7e", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7ad7809bbffd3f79f6e8b6831fe7ac993f88dd6b/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7ad7809bbffd3f79f6e8b6831fe7ac993f88dd6b/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=7ad7809bbffd3f79f6e8b6831fe7ac993f88dd6b", "patch": "@@ -1,3 +1,8 @@\n+2009-01-06  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR rtl-optimization/38722\n+\t* gfortran.dg/pr38722.f90: New test.\n+\n 2009-01-06  Janis Johnson  <janis187@us.ibm.com>\n \n \tPR c/34252"}, {"sha": "7a4f63e869c081cbd7e1085d3e2354fd84d7bbca", "filename": "gcc/testsuite/gfortran.dg/pr38722.f90", "status": "added", "additions": 38, "deletions": 0, "changes": 38, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7ad7809bbffd3f79f6e8b6831fe7ac993f88dd6b/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr38722.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7ad7809bbffd3f79f6e8b6831fe7ac993f88dd6b/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr38722.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr38722.f90?ref=7ad7809bbffd3f79f6e8b6831fe7ac993f88dd6b", "patch": "@@ -0,0 +1,38 @@\n+! PR rtl-optimization/38722\n+! { dg-do compile }\n+! { dg-options \"-O1\" }\n+SUBROUTINE foo(x, n, ga, gc, vr)\n+  TYPE pt\n+    DOUBLE PRECISION, DIMENSION (:, :, :), POINTER :: cr\n+  END TYPE pt\n+  TYPE pu\n+    TYPE(pt), POINTER :: pw\n+  END TYPE pu\n+  LOGICAL, INTENT(in) :: x, ga, gc\n+  INTEGER :: i, n\n+  LOGICAL :: dd, ep, fe\n+  TYPE(pu) :: vr\n+  TYPE(pu), DIMENSION(:), POINTER :: v\n+  IF (.NOT. fe) THEN\n+     IF (ga) THEN\n+        CALL bar (dd, ep, gc)\n+     END IF\n+     IF (x .AND. .NOT. ga) THEN\n+        IF (gc) THEN\n+          DO i=1,n\n+            CALL baz (v(i), x, gc)\n+            v(i)%pw%cr = 1.0\n+          END DO\n+          DO i=1,n\n+             IF (ep) THEN\n+                IF (dd) THEN\n+                   IF (i==1) THEN\n+                      v(i)%pw%cr=v(i)%pw%cr + vr%pw%cr\n+                   ENDIF\n+                END IF\n+             END IF\n+          END DO\n+        END IF\n+     ENDIF\n+  END IF\n+END SUBROUTINE foo"}]}