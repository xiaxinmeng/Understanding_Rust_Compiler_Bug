{"sha": "2b536806afcb297162fdc44e04cbf6f2c21e66aa", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MmI1MzY4MDZhZmNiMjk3MTYyZmRjNDRlMDRjYmY2ZjJjMjFlNjZhYQ==", "commit": {"author": {"name": "Douglas Gregor", "email": "doug.gregor@gmail.com", "date": "2007-10-26T17:53:56Z"}, "committer": {"name": "Doug Gregor", "email": "dgregor@gcc.gnu.org", "date": "2007-10-26T17:53:56Z"}, "message": "re PR c++/33839 (ICE with decltype)\n\n2007-10-26  Douglas Gregor  <doug.gregor@gmail.com>\n\n\tPR c++/33839\n\t* parser.c (cp_parser_decltype): Return ERROR_MARK_NODE if we\n\tdon't see the leading '('. Only lookup names if we get an\n\tIDENTIFIER_NODE.\n\n2007-10-26  Douglas Gregor  <doug.gregor@gmail.com>\n\n\t* g++.dg/cpp0x/pr33839.C: New.\n\nFrom-SVN: r129656", "tree": {"sha": "a3ebc65c79de58f41f9284753147b993bb695f98", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a3ebc65c79de58f41f9284753147b993bb695f98"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2b536806afcb297162fdc44e04cbf6f2c21e66aa", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2b536806afcb297162fdc44e04cbf6f2c21e66aa", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2b536806afcb297162fdc44e04cbf6f2c21e66aa", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2b536806afcb297162fdc44e04cbf6f2c21e66aa/comments", "author": {"login": "DougGregor", "id": 989428, "node_id": "MDQ6VXNlcjk4OTQyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/989428?v=4", "gravatar_id": "", "url": "https://api.github.com/users/DougGregor", "html_url": "https://github.com/DougGregor", "followers_url": "https://api.github.com/users/DougGregor/followers", "following_url": "https://api.github.com/users/DougGregor/following{/other_user}", "gists_url": "https://api.github.com/users/DougGregor/gists{/gist_id}", "starred_url": "https://api.github.com/users/DougGregor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/DougGregor/subscriptions", "organizations_url": "https://api.github.com/users/DougGregor/orgs", "repos_url": "https://api.github.com/users/DougGregor/repos", "events_url": "https://api.github.com/users/DougGregor/events{/privacy}", "received_events_url": "https://api.github.com/users/DougGregor/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "3f28024c07613ff04305839df0cfb1c098572d2e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3f28024c07613ff04305839df0cfb1c098572d2e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3f28024c07613ff04305839df0cfb1c098572d2e"}], "stats": {"total": 39, "additions": 30, "deletions": 9}, "files": [{"sha": "191836d5da6559d9d67f8e29e75740cceffcfb96", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2b536806afcb297162fdc44e04cbf6f2c21e66aa/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2b536806afcb297162fdc44e04cbf6f2c21e66aa/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=2b536806afcb297162fdc44e04cbf6f2c21e66aa", "patch": "@@ -1,3 +1,10 @@\n+2007-10-26  Douglas Gregor  <doug.gregor@gmail.com>\n+\n+\tPR c++/33839\n+\t* parser.c (cp_parser_decltype): Return ERROR_MARK_NODE if we\n+\tdon't see the leading '('. Only lookup names if we get an\n+\tIDENTIFIER_NODE.\n+\n 2007-10-26  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR c++/33744"}, {"sha": "2b73a85aaf7ca97075e8ae2428caad1a4ae8be5d", "filename": "gcc/cp/parser.c", "status": "modified", "additions": 11, "deletions": 9, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2b536806afcb297162fdc44e04cbf6f2c21e66aa/gcc%2Fcp%2Fparser.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2b536806afcb297162fdc44e04cbf6f2c21e66aa/gcc%2Fcp%2Fparser.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fparser.c?ref=2b536806afcb297162fdc44e04cbf6f2c21e66aa", "patch": "@@ -8464,7 +8464,8 @@ cp_parser_decltype (cp_parser *parser)\n   ++skip_evaluation;\n \n   /* Parse the opening `('.  */\n-  cp_parser_require (parser, CPP_OPEN_PAREN, \"`('\");\n+  if (!cp_parser_require (parser, CPP_OPEN_PAREN, \"`('\"))\n+    return error_mark_node;\n   \n   /* First, try parsing an id-expression.  */\n   cp_parser_parse_tentatively (parser);\n@@ -8482,14 +8483,15 @@ cp_parser_decltype (cp_parser *parser)\n       cp_id_kind idk;\n       const char *error_msg;\n \n-      /* Lookup the name we got back from the id-expression.  */\n-      expr = cp_parser_lookup_name (parser, expr,\n-                                    none_type,\n-                                    /*is_template=*/false,\n-                                    /*is_namespace=*/false,\n-                                    /*check_dependency=*/true,\n-                                    /*ambiguous_decls=*/NULL);\n-      \n+      if (TREE_CODE (expr) == IDENTIFIER_NODE)\n+\t/* Lookup the name we got back from the id-expression.  */\n+\texpr = cp_parser_lookup_name (parser, expr,\n+\t\t\t\t      none_type,\n+\t\t\t\t      /*is_template=*/false,\n+\t\t\t\t      /*is_namespace=*/false,\n+\t\t\t\t      /*check_dependency=*/true,\n+\t\t\t\t      /*ambiguous_decls=*/NULL);\n+\n       if (expr \n           && expr != error_mark_node\n           && TREE_CODE (expr) != TEMPLATE_ID_EXPR"}, {"sha": "1257d0b1348b96d3080308aba1ca6953e3947816", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2b536806afcb297162fdc44e04cbf6f2c21e66aa/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2b536806afcb297162fdc44e04cbf6f2c21e66aa/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=2b536806afcb297162fdc44e04cbf6f2c21e66aa", "patch": "@@ -1,3 +1,7 @@\n+2007-10-26  Douglas Gregor  <doug.gregor@gmail.com>\n+\n+\t* g++.dg/cpp0x/pr33839.C: New.\n+\t\n 2007-10-26  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR c++/33744"}, {"sha": "4111d6ccfc06c3d232bc9583059d73ce8558df74", "filename": "gcc/testsuite/g++.dg/cpp0x/pr33839.C", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2b536806afcb297162fdc44e04cbf6f2c21e66aa/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fpr33839.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2b536806afcb297162fdc44e04cbf6f2c21e66aa/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fpr33839.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fpr33839.C?ref=2b536806afcb297162fdc44e04cbf6f2c21e66aa", "patch": "@@ -0,0 +1,8 @@\n+// { dg-options -std=c++0x }\n+template<int> struct A;\n+\n+void foo()\n+{\n+  __decltype A<0>; // { dg-error \"invalid declarator\" }\n+  __decltype (A<0>); // { dg-error \"must be an expression\" }\n+}"}]}