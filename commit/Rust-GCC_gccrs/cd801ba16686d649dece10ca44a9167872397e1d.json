{"sha": "cd801ba16686d649dece10ca44a9167872397e1d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Y2Q4MDFiYTE2Njg2ZDY0OWRlY2UxMGNhNDRhOTE2Nzg3MjM5N2UxZA==", "commit": {"author": {"name": "Richard Henderson", "email": "rth@redhat.com", "date": "2004-12-19T21:08:33Z"}, "committer": {"name": "Richard Henderson", "email": "rth@gcc.gnu.org", "date": "2004-12-19T21:08:33Z"}, "message": "re PR tree-optimization/18067 (ICE at loc_descriptor_from_tree_1 in dwarf2out.c (VLA) with const int.)\n\n        PR 18067\n        * stor-layout.c (variable_size): Force creation of a SAVE_EXPR.\n\nFrom-SVN: r92389", "tree": {"sha": "6527e524281c131665bd6c6a7f833615dee15251", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6527e524281c131665bd6c6a7f833615dee15251"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/cd801ba16686d649dece10ca44a9167872397e1d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cd801ba16686d649dece10ca44a9167872397e1d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cd801ba16686d649dece10ca44a9167872397e1d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cd801ba16686d649dece10ca44a9167872397e1d/comments", "author": null, "committer": null, "parents": [{"sha": "199db659d0af9e43608fee9862ede41658f2ca52", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/199db659d0af9e43608fee9862ede41658f2ca52", "html_url": "https://github.com/Rust-GCC/gccrs/commit/199db659d0af9e43608fee9862ede41658f2ca52"}], "stats": {"total": 23, "additions": 22, "deletions": 1}, "files": [{"sha": "cf2c8f5aac66d418773621b3146b03c607293237", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cd801ba16686d649dece10ca44a9167872397e1d/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cd801ba16686d649dece10ca44a9167872397e1d/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=cd801ba16686d649dece10ca44a9167872397e1d", "patch": "@@ -1,3 +1,8 @@\n+2004-12-19  Richard Henderson  <rth@redhat.com>\n+\n+\tPR 18067\n+\t* stor-layout.c (variable_size): Force creation of a SAVE_EXPR.\n+\n 2003-12-19  Steven Bosscher  <stevenb@suse.de>\n \n \t* config/i386/i386.c (ix86_split_to_parts): Use an array with"}, {"sha": "7069ad9b2eca0c6825eeae160fedc01411cac04f", "filename": "gcc/stor-layout.c", "status": "modified", "additions": 9, "deletions": 1, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cd801ba16686d649dece10ca44a9167872397e1d/gcc%2Fstor-layout.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cd801ba16686d649dece10ca44a9167872397e1d/gcc%2Fstor-layout.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fstor-layout.c?ref=cd801ba16686d649dece10ca44a9167872397e1d", "patch": "@@ -125,11 +125,19 @@ variable_size (tree size)\n      just return SIZE unchanged.  Likewise for self-referential sizes and\n      constant sizes.  */\n   if (TREE_CONSTANT (size)\n+      || TREE_CODE (size) == SAVE_EXPR\n       || lang_hooks.decls.global_bindings_p () < 0\n       || CONTAINS_PLACEHOLDER_P (size))\n     return size;\n \n-  size = save_expr (size);\n+  /* Force creation of a SAVE_EXPR.  This solves (1) code duplication \n+     problems between parent and nested functions that occasionally can't\n+     be cleaned up because of portions of the expression escaping the\n+     parent function via the FRAME object, and (2) tree sharing problems\n+     between the type system and the gimple code, which can leak SSA_NAME\n+     objects into e.g. TYPE_SIZE, which cause heartburn when emitting\n+     debug information.  */\n+  size = build1 (SAVE_EXPR, TREE_TYPE (size), size);\n \n   /* If an array with a variable number of elements is declared, and\n      the elements require destruction, we will emit a cleanup for the"}, {"sha": "6a62bb95b1780604b59a446f6d0ddd2a409a6191", "filename": "gcc/testsuite/gcc.dg/debug/20041219-1.c", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cd801ba16686d649dece10ca44a9167872397e1d/gcc%2Ftestsuite%2Fgcc.dg%2Fdebug%2F20041219-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cd801ba16686d649dece10ca44a9167872397e1d/gcc%2Ftestsuite%2Fgcc.dg%2Fdebug%2F20041219-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fdebug%2F20041219-1.c?ref=cd801ba16686d649dece10ca44a9167872397e1d", "patch": "@@ -0,0 +1,8 @@\n+/* PR 18067 */\n+/* { dg-do compile } */\n+\n+void foo(int i)\n+{\n+    const int j=i+1;\n+    int a[1][j*j];\n+}"}]}