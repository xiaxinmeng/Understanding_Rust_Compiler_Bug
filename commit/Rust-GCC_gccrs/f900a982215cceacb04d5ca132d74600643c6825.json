{"sha": "f900a982215cceacb04d5ca132d74600643c6825", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjkwMGE5ODIyMTVjY2VhY2IwNGQ1Y2ExMzJkNzQ2MDA2NDNjNjgyNQ==", "commit": {"author": {"name": "Maciej W. Rozycki", "email": "macro@codesourcery.com", "date": "2013-07-16T23:04:52Z"}, "committer": {"name": "Maciej W. Rozycki", "email": "macro@gcc.gnu.org", "date": "2013-07-16T23:04:52Z"}, "message": "mips.h (ISA_HAS_FP4): Correct formatting.\n\n\t* config/mips/mips.h (ISA_HAS_FP4): Correct formatting.\n\t(ISA_HAS_FP_MADD4_MSUB4): Also enable for ISA_MIPS32R2.\n\t(ISA_HAS_NMADD4_NMSUB4): Remove the MODE argument; rewrite in\n\tterms of ISA_HAS_FP4, and also enable for ISA_MIPS32R2.\n\t(ISA_HAS_NMADD3_NMSUB3): Remove the MODE argument.\n\t* config/mips/mips.c (mips_rtx_costs) <PLUS>: Check for\n\tISA_HAS_FP_MADD4_MSUB4 || ISA_HAS_FP_MADD3_MSUB3 rather than\n\tISA_HAS_FP4.\n\t<MINUS, NEG>: Update according to changes to ISA_HAS_NMADD4_NMSUB4\n\tand ISA_HAS_NMADD3_NMSUB3.\n\t* config/mips/mips.md (nmadd4<mode>, nmadd3<mode>): Likewise.\n\t(nmadd4<mode>_fastmath, nmadd3<mode>_fastmath): Likewise.\n\t(nmsub4<mode>, nmsub3<mode>): Likewise.\n\t(nmsub4<mode>_fastmath, nmsub3<mode>_fastmath): Likewise.\n\nFrom-SVN: r200993", "tree": {"sha": "167cecd09ff37445a4d264225c61eece48c58074", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/167cecd09ff37445a4d264225c61eece48c58074"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f900a982215cceacb04d5ca132d74600643c6825", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f900a982215cceacb04d5ca132d74600643c6825", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f900a982215cceacb04d5ca132d74600643c6825", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f900a982215cceacb04d5ca132d74600643c6825/comments", "author": null, "committer": null, "parents": [{"sha": "d4ed27eb7f674fe64d9134a2713729be8e38eebd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d4ed27eb7f674fe64d9134a2713729be8e38eebd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d4ed27eb7f674fe64d9134a2713729be8e38eebd"}], "stats": {"total": 55, "additions": 34, "deletions": 21}, "files": [{"sha": "b4f628753b4d60304c34349c3048007d2dfcaac5", "filename": "gcc/ChangeLog", "status": "modified", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f900a982215cceacb04d5ca132d74600643c6825/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f900a982215cceacb04d5ca132d74600643c6825/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=f900a982215cceacb04d5ca132d74600643c6825", "patch": "@@ -1,3 +1,20 @@\n+2013-07-16  Maciej W. Rozycki  <macro@codesourcery.com>\n+\n+\t* config/mips/mips.h (ISA_HAS_FP4): Correct formatting.\n+\t(ISA_HAS_FP_MADD4_MSUB4): Also enable for ISA_MIPS32R2.\n+\t(ISA_HAS_NMADD4_NMSUB4): Remove the MODE argument; rewrite in\n+\tterms of ISA_HAS_FP4, and also enable for ISA_MIPS32R2.\n+\t(ISA_HAS_NMADD3_NMSUB3): Remove the MODE argument.\n+\t* config/mips/mips.c (mips_rtx_costs) <PLUS>: Check for\n+\tISA_HAS_FP_MADD4_MSUB4 || ISA_HAS_FP_MADD3_MSUB3 rather than\n+\tISA_HAS_FP4.\n+\t<MINUS, NEG>: Update according to changes to ISA_HAS_NMADD4_NMSUB4\n+\tand ISA_HAS_NMADD3_NMSUB3.\n+\t* config/mips/mips.md (nmadd4<mode>, nmadd3<mode>): Likewise.\n+\t(nmadd4<mode>_fastmath, nmadd3<mode>_fastmath): Likewise.\n+\t(nmsub4<mode>, nmsub3<mode>): Likewise.\n+\t(nmsub4<mode>_fastmath, nmsub3<mode>_fastmath): Likewise.\n+\n 2013-07-16  Maciej W. Rozycki  <macro@codesourcery.com>\n \n \t* config/mips/mips.h (ISA_HAS_NMADD4_NMSUB4): Remove"}, {"sha": "e95bdd88d4a07e6217aab793f403c25b87f74734", "filename": "gcc/config/mips/mips.c", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f900a982215cceacb04d5ca132d74600643c6825/gcc%2Fconfig%2Fmips%2Fmips.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f900a982215cceacb04d5ca132d74600643c6825/gcc%2Fconfig%2Fmips%2Fmips.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.c?ref=f900a982215cceacb04d5ca132d74600643c6825", "patch": "@@ -3857,7 +3857,7 @@ mips_rtx_costs (rtx x, int code, int outer_code, int opno ATTRIBUTE_UNUSED,\n \n     case MINUS:\n       if (float_mode_p\n-\t  && (ISA_HAS_NMADD4_NMSUB4 (mode) || ISA_HAS_NMADD3_NMSUB3 (mode))\n+\t  && (ISA_HAS_NMADD4_NMSUB4 || ISA_HAS_NMADD3_NMSUB3)\n \t  && TARGET_FUSED_MADD\n \t  && !HONOR_NANS (mode)\n \t  && !HONOR_SIGNED_ZEROS (mode))\n@@ -3890,7 +3890,7 @@ mips_rtx_costs (rtx x, int code, int outer_code, int opno ATTRIBUTE_UNUSED,\n \t{\n \t  /* If this is part of a MADD or MSUB, treat the PLUS as\n \t     being free.  */\n-\t  if (ISA_HAS_FP4\n+\t  if ((ISA_HAS_FP_MADD4_MSUB4 || ISA_HAS_FP_MADD3_MSUB3)\n \t      && TARGET_FUSED_MADD\n \t      && GET_CODE (XEXP (x, 0)) == MULT)\n \t    *total = 0;\n@@ -3909,7 +3909,7 @@ mips_rtx_costs (rtx x, int code, int outer_code, int opno ATTRIBUTE_UNUSED,\n \n     case NEG:\n       if (float_mode_p\n-\t  && (ISA_HAS_NMADD4_NMSUB4 (mode) || ISA_HAS_NMADD3_NMSUB3 (mode))\n+\t  && (ISA_HAS_NMADD4_NMSUB4 || ISA_HAS_NMADD3_NMSUB3)\n \t  && TARGET_FUSED_MADD\n \t  && !HONOR_NANS (mode)\n \t  && HONOR_SIGNED_ZEROS (mode))"}, {"sha": "007f598c658f2426ffe1e73e985c0444c2a0549c", "filename": "gcc/config/mips/mips.h", "status": "modified", "additions": 6, "deletions": 10, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f900a982215cceacb04d5ca132d74600643c6825/gcc%2Fconfig%2Fmips%2Fmips.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f900a982215cceacb04d5ca132d74600643c6825/gcc%2Fconfig%2Fmips%2Fmips.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.h?ref=f900a982215cceacb04d5ca132d74600643c6825", "patch": "@@ -873,7 +873,7 @@ struct mips_cpu_info {\n    FP madd and msub instructions, and the FP recip and recip sqrt\n    instructions.  */\n #define ISA_HAS_FP4\t\t((ISA_MIPS4\t\t\t\t\\\n-\t\t\t\t  || (ISA_MIPS32R2 && TARGET_FLOAT64)   \\\n+\t\t\t\t  || (ISA_MIPS32R2 && TARGET_FLOAT64)\t\\\n \t\t\t\t  || ISA_MIPS64\t\t\t\t\\\n \t\t\t\t  || ISA_MIPS64R2)\t\t\t\\\n \t\t\t\t && !TARGET_MIPS16)\n@@ -895,24 +895,20 @@ struct mips_cpu_info {\n #define GENERATE_MADD_MSUB\t(TARGET_IMADD && !TARGET_MIPS16)\n \n /* ISA has floating-point madd and msub instructions 'd = a * b [+-] c'.  */\n-#define ISA_HAS_FP_MADD4_MSUB4  ISA_HAS_FP4\n+#define ISA_HAS_FP_MADD4_MSUB4  (ISA_HAS_FP4\t\t\t\t\\\n+\t\t\t\t || (ISA_MIPS32R2 && !TARGET_MIPS16))\n \n /* ISA has floating-point madd and msub instructions 'c = a * b [+-] c'.  */\n #define ISA_HAS_FP_MADD3_MSUB3  TARGET_LOONGSON_2EF\n \n /* ISA has floating-point nmadd and nmsub instructions\n    'd = -((a * b) [+-] c)'.  */\n-#define ISA_HAS_NMADD4_NMSUB4(MODE)\t\t\t\t\t\\\n-\t\t\t\t((ISA_MIPS4\t\t\t\t\\\n-\t\t\t\t  || (ISA_MIPS32R2 && (MODE) == V2SFmode) \\\n-\t\t\t\t  || ISA_MIPS64\t\t\t\t\\\n-\t\t\t\t  || ISA_MIPS64R2)\t\t\t\\\n-\t\t\t\t && !TARGET_MIPS16)\n+#define ISA_HAS_NMADD4_NMSUB4\t(ISA_HAS_FP4\t\t\t\t\\\n+\t\t\t\t || (ISA_MIPS32R2 && !TARGET_MIPS16))\n \n /* ISA has floating-point nmadd and nmsub instructions\n    'c = -((a * b) [+-] c)'.  */\n-#define ISA_HAS_NMADD3_NMSUB3(MODE)\t\t\t\t\t\\\n-                                TARGET_LOONGSON_2EF\n+#define ISA_HAS_NMADD3_NMSUB3\tTARGET_LOONGSON_2EF\n \n /* ISA has count leading zeroes/ones instruction (not implemented).  */\n #define ISA_HAS_CLZ_CLO\t\t((ISA_MIPS32\t\t\t\t\\"}, {"sha": "ca79a31e29ac9f67ab8bf78e4bc30eba1a2ac0ef", "filename": "gcc/config/mips/mips.md", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f900a982215cceacb04d5ca132d74600643c6825/gcc%2Fconfig%2Fmips%2Fmips.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f900a982215cceacb04d5ca132d74600643c6825/gcc%2Fconfig%2Fmips%2Fmips.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.md?ref=f900a982215cceacb04d5ca132d74600643c6825", "patch": "@@ -2367,7 +2367,7 @@\n \t\t   (mult:ANYF (match_operand:ANYF 1 \"register_operand\" \"f\")\n \t\t\t      (match_operand:ANYF 2 \"register_operand\" \"f\"))\n \t\t   (match_operand:ANYF 3 \"register_operand\" \"f\"))))]\n-  \"ISA_HAS_NMADD4_NMSUB4 (<MODE>mode)\n+  \"ISA_HAS_NMADD4_NMSUB4\n    && TARGET_FUSED_MADD\n    && HONOR_SIGNED_ZEROS (<MODE>mode)\n    && !HONOR_NANS (<MODE>mode)\"\n@@ -2382,7 +2382,7 @@\n \t\t   (mult:ANYF (match_operand:ANYF 1 \"register_operand\" \"f\")\n \t\t\t      (match_operand:ANYF 2 \"register_operand\" \"f\"))\n \t\t   (match_operand:ANYF 3 \"register_operand\" \"0\"))))]\n-  \"ISA_HAS_NMADD3_NMSUB3 (<MODE>mode)\n+  \"ISA_HAS_NMADD3_NMSUB3\n    && TARGET_FUSED_MADD\n    && HONOR_SIGNED_ZEROS (<MODE>mode)\n    && !HONOR_NANS (<MODE>mode)\"\n@@ -2397,7 +2397,7 @@\n \t (mult:ANYF (neg:ANYF (match_operand:ANYF 1 \"register_operand\" \"f\"))\n \t\t    (match_operand:ANYF 2 \"register_operand\" \"f\"))\n \t (match_operand:ANYF 3 \"register_operand\" \"f\")))]\n-  \"ISA_HAS_NMADD4_NMSUB4 (<MODE>mode)\n+  \"ISA_HAS_NMADD4_NMSUB4\n    && TARGET_FUSED_MADD\n    && !HONOR_SIGNED_ZEROS (<MODE>mode)\n    && !HONOR_NANS (<MODE>mode)\"\n@@ -2412,7 +2412,7 @@\n \t (mult:ANYF (neg:ANYF (match_operand:ANYF 1 \"register_operand\" \"f\"))\n \t\t    (match_operand:ANYF 2 \"register_operand\" \"f\"))\n \t (match_operand:ANYF 3 \"register_operand\" \"0\")))]\n-  \"ISA_HAS_NMADD3_NMSUB3 (<MODE>mode)\n+  \"ISA_HAS_NMADD3_NMSUB3\n    && TARGET_FUSED_MADD\n    && !HONOR_SIGNED_ZEROS (<MODE>mode)\n    && !HONOR_NANS (<MODE>mode)\"\n@@ -2427,7 +2427,7 @@\n \t\t   (mult:ANYF (match_operand:ANYF 2 \"register_operand\" \"f\")\n \t\t\t      (match_operand:ANYF 3 \"register_operand\" \"f\"))\n \t\t   (match_operand:ANYF 1 \"register_operand\" \"f\"))))]\n-  \"ISA_HAS_NMADD4_NMSUB4 (<MODE>mode)\n+  \"ISA_HAS_NMADD4_NMSUB4\n    && TARGET_FUSED_MADD\n    && HONOR_SIGNED_ZEROS (<MODE>mode)\n    && !HONOR_NANS (<MODE>mode)\"\n@@ -2442,7 +2442,7 @@\n \t\t   (mult:ANYF (match_operand:ANYF 2 \"register_operand\" \"f\")\n \t\t\t      (match_operand:ANYF 3 \"register_operand\" \"f\"))\n \t\t   (match_operand:ANYF 1 \"register_operand\" \"0\"))))]\n-  \"ISA_HAS_NMADD3_NMSUB3 (<MODE>mode)\n+  \"ISA_HAS_NMADD3_NMSUB3\n    && TARGET_FUSED_MADD\n    && HONOR_SIGNED_ZEROS (<MODE>mode)\n    && !HONOR_NANS (<MODE>mode)\"\n@@ -2457,7 +2457,7 @@\n \t (match_operand:ANYF 1 \"register_operand\" \"f\")\n \t (mult:ANYF (match_operand:ANYF 2 \"register_operand\" \"f\")\n \t\t    (match_operand:ANYF 3 \"register_operand\" \"f\"))))]\n-  \"ISA_HAS_NMADD4_NMSUB4 (<MODE>mode)\n+  \"ISA_HAS_NMADD4_NMSUB4\n    && TARGET_FUSED_MADD\n    && !HONOR_SIGNED_ZEROS (<MODE>mode)\n    && !HONOR_NANS (<MODE>mode)\"\n@@ -2472,7 +2472,7 @@\n \t (match_operand:ANYF 1 \"register_operand\" \"f\")\n \t (mult:ANYF (match_operand:ANYF 2 \"register_operand\" \"f\")\n \t\t    (match_operand:ANYF 3 \"register_operand\" \"0\"))))]\n-  \"ISA_HAS_NMADD3_NMSUB3 (<MODE>mode)\n+  \"ISA_HAS_NMADD3_NMSUB3\n    && TARGET_FUSED_MADD\n    && !HONOR_SIGNED_ZEROS (<MODE>mode)\n    && !HONOR_NANS (<MODE>mode)\""}]}