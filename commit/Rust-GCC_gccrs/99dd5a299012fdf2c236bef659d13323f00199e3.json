{"sha": "99dd5a299012fdf2c236bef659d13323f00199e3", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTlkZDVhMjk5MDEyZmRmMmMyMzZiZWY2NTlkMTMzMjNmMDAxOTllMw==", "commit": {"author": {"name": "Mikael Morin", "email": "mikael@gcc.gnu.org", "date": "2011-11-03T22:10:25Z"}, "committer": {"name": "Mikael Morin", "email": "mikael@gcc.gnu.org", "date": "2011-11-03T22:10:25Z"}, "message": "trans.h (struct gfc_ss, [...]): Move member struct gfc_ss::data::scalar into newly created union...\n\n\t* trans.h (struct gfc_ss, struct gfc_ss_info): Move member struct\n\tgfc_ss::data::scalar into newly created union gfc_ss_info::data,\n\tand rename subfield expr to value.\n\t* trans-array.c (gfc_add_loop_ss_code, gfc_conv_array_index_offset,\n\tgfc_conv_expr_descriptor): Update reference chains.\n\t* trans-const.c (gfc_conv_constant): Ditto.\n\t* trans-expr.c (gfc_conv_expr): Ditto.\n\nFrom-SVN: r180870", "tree": {"sha": "d8a32fbcba1fbace247eca6d8b5f47cd2780b1a0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d8a32fbcba1fbace247eca6d8b5f47cd2780b1a0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/99dd5a299012fdf2c236bef659d13323f00199e3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/99dd5a299012fdf2c236bef659d13323f00199e3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/99dd5a299012fdf2c236bef659d13323f00199e3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/99dd5a299012fdf2c236bef659d13323f00199e3/comments", "author": null, "committer": null, "parents": [{"sha": "a0add3be3e216ad8e7cbf02c684b70c13928500b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a0add3be3e216ad8e7cbf02c684b70c13928500b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a0add3be3e216ad8e7cbf02c684b70c13928500b"}], "stats": {"total": 40, "additions": 27, "deletions": 13}, "files": [{"sha": "f10419a6b62622febc3282c01357373505938c7f", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/99dd5a299012fdf2c236bef659d13323f00199e3/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/99dd5a299012fdf2c236bef659d13323f00199e3/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=99dd5a299012fdf2c236bef659d13323f00199e3", "patch": "@@ -1,3 +1,13 @@\n+2011-11-03  Mikael Morin  <mikael@gcc.gnu.org>\n+\n+\t* trans.h (struct gfc_ss, struct gfc_ss_info): Move member struct\n+\tgfc_ss::data::scalar into newly created union gfc_ss_info::data,\n+\tand rename subfield expr to value.\n+\t* trans-array.c (gfc_add_loop_ss_code, gfc_conv_array_index_offset,\n+\tgfc_conv_expr_descriptor): Update reference chains.\n+\t* trans-const.c (gfc_conv_constant): Ditto.\n+\t* trans-expr.c (gfc_conv_expr): Ditto.\n+\n 2011-11-03  Mikael Morin  <mikael@gcc.gnu.org>\n \n \t* trans.h (struct gfc_ss, struct gfc_ss_info): Move field"}, {"sha": "eef0f097f2aa30ce1bc46d21bcbccaa3a983fb62", "filename": "gcc/fortran/trans-array.c", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/99dd5a299012fdf2c236bef659d13323f00199e3/gcc%2Ffortran%2Ftrans-array.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/99dd5a299012fdf2c236bef659d13323f00199e3/gcc%2Ffortran%2Ftrans-array.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-array.c?ref=99dd5a299012fdf2c236bef659d13323f00199e3", "patch": "@@ -2208,7 +2208,7 @@ gfc_add_loop_ss_code (gfc_loopinfo * loop, gfc_ss * ss, bool subscript,\n \t  else\n \t    gfc_add_block_to_block (&loop->post, &se.post);\n \n-\t  ss->data.scalar.expr = se.expr;\n+\t  ss_info->data.scalar.value = se.expr;\n \t  ss_info->string_length = se.string_length;\n \t  break;\n \n@@ -2220,7 +2220,7 @@ gfc_add_loop_ss_code (gfc_loopinfo * loop, gfc_ss * ss, bool subscript,\n \t  gfc_add_block_to_block (&loop->pre, &se.pre);\n \t  gfc_add_block_to_block (&loop->post, &se.post);\n \n-\t  ss->data.scalar.expr = gfc_evaluate_now (se.expr, &loop->pre);\n+\t  ss_info->data.scalar.value = gfc_evaluate_now (se.expr, &loop->pre);\n \t  ss_info->string_length = se.string_length;\n \t  break;\n \n@@ -2571,7 +2571,7 @@ conv_array_index_offset (gfc_se * se, gfc_ss * ss, int dim, int i,\n \t  gcc_assert (info->subscript[dim]\n \t\t      && info->subscript[dim]->info->type == GFC_SS_SCALAR);\n \t  /* We've already translated this value outside the loop.  */\n-\t  index = info->subscript[dim]->data.scalar.expr;\n+\t  index = info->subscript[dim]->info->data.scalar.value;\n \n \t  index = trans_array_bound_check (se, ss, index, dim, &ar->where,\n \t\t\t\t\t   ar->as->type != AS_ASSUMED_SIZE\n@@ -6134,7 +6134,7 @@ gfc_conv_expr_descriptor (gfc_se * se, gfc_expr * expr, gfc_ss * ss)\n \t    {\n \t      gcc_assert (info->subscript[n]\n \t\t\t  && info->subscript[n]->info->type == GFC_SS_SCALAR);\n-\t      start = info->subscript[n]->data.scalar.expr;\n+\t      start = info->subscript[n]->info->data.scalar.value;\n \t    }\n \t  else\n \t    {"}, {"sha": "fa820ef10de0d7ab2c0f3ed820dcf26b796da527", "filename": "gcc/fortran/trans-const.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/99dd5a299012fdf2c236bef659d13323f00199e3/gcc%2Ffortran%2Ftrans-const.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/99dd5a299012fdf2c236bef659d13323f00199e3/gcc%2Ffortran%2Ftrans-const.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-const.c?ref=99dd5a299012fdf2c236bef659d13323f00199e3", "patch": "@@ -392,7 +392,7 @@ gfc_conv_constant (gfc_se * se, gfc_expr * expr)\n       gcc_assert (ss_info->type == GFC_SS_SCALAR);\n       gcc_assert (ss_info->expr == expr);\n \n-      se->expr = se->ss->data.scalar.expr;\n+      se->expr = ss_info->data.scalar.value;\n       se->string_length = ss_info->string_length;\n       gfc_advance_se_ss_chain (se);\n       return;"}, {"sha": "55853f19d2b8671a8ba1a6b89656ee4b74b0cd5e", "filename": "gcc/fortran/trans-expr.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/99dd5a299012fdf2c236bef659d13323f00199e3/gcc%2Ffortran%2Ftrans-expr.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/99dd5a299012fdf2c236bef659d13323f00199e3/gcc%2Ffortran%2Ftrans-expr.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-expr.c?ref=99dd5a299012fdf2c236bef659d13323f00199e3", "patch": "@@ -4840,7 +4840,7 @@ gfc_conv_expr (gfc_se * se, gfc_expr * expr)\n       ss_info = ss->info;\n       /* Substitute a scalar expression evaluated outside the scalarization\n          loop.  */\n-      se->expr = se->ss->data.scalar.expr;\n+      se->expr = ss_info->data.scalar.value;\n       if (ss_info->type == GFC_SS_REFERENCE)\n \tse->expr = gfc_build_addr_expr (NULL_TREE, se->expr);\n       se->string_length = ss_info->string_length;"}, {"sha": "567e5a343f1b4f0f2c388c9bb0f639acbcc1cbce", "filename": "gcc/fortran/trans.h", "status": "modified", "additions": 11, "deletions": 7, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/99dd5a299012fdf2c236bef659d13323f00199e3/gcc%2Ffortran%2Ftrans.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/99dd5a299012fdf2c236bef659d13323f00199e3/gcc%2Ffortran%2Ftrans.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans.h?ref=99dd5a299012fdf2c236bef659d13323f00199e3", "patch": "@@ -188,6 +188,17 @@ typedef struct gfc_ss_info\n   gfc_ss_type type;\n   gfc_expr *expr;\n   tree string_length;\n+\n+  union\n+  {\n+    /* If type is GFC_SS_SCALAR or GFC_SS_REFERENCE.  */\n+    struct\n+    {\n+      tree value;\n+    }\n+    scalar;\n+  }\n+  data;\n }\n gfc_ss_info;\n \n@@ -208,13 +219,6 @@ typedef struct gfc_ss\n \n   union\n   {\n-    /* If type is GFC_SS_SCALAR or GFC_SS_REFERENCE.  */\n-    struct\n-    {\n-      tree expr;\n-    }\n-    scalar;\n-\n     /* GFC_SS_TEMP.  */\n     struct\n     {"}]}