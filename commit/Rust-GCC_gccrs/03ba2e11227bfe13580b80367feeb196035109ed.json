{"sha": "03ba2e11227bfe13580b80367feeb196035109ed", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDNiYTJlMTEyMjdiZmUxMzU4MGI4MDM2N2ZlZWIxOTYwMzUxMDllZA==", "commit": {"author": {"name": "Paolo Carlini", "email": "pcarlini@suse.de", "date": "2007-09-05T09:31:54Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2007-09-05T09:31:54Z"}, "message": "PR c++/29731 (again)\n\n/cp\n2007-09-05  Paolo Carlini  <pcarlini@suse.de>\n\n\tPR c++/29731 (again)\n\t* parser.c (cp_parser_primary_expression): Return error_mark_node\n\twhen a statement-expression is found in a template-argument list.\n\n/testsuite\n2007-09-05  Paolo Carlini  <pcarlini@suse.de>\n\n\tPR c++/29731\n\t* g++.dg/parse/template24.C: New.\n\nFrom-SVN: r128124", "tree": {"sha": "a4b2a503b33ca25b6844be28fa7c9c65eac6f811", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a4b2a503b33ca25b6844be28fa7c9c65eac6f811"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/03ba2e11227bfe13580b80367feeb196035109ed", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/03ba2e11227bfe13580b80367feeb196035109ed", "html_url": "https://github.com/Rust-GCC/gccrs/commit/03ba2e11227bfe13580b80367feeb196035109ed", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/03ba2e11227bfe13580b80367feeb196035109ed/comments", "author": null, "committer": null, "parents": [{"sha": "50e47dba16df43b6d45849e364cce6963950d3ce", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/50e47dba16df43b6d45849e364cce6963950d3ce", "html_url": "https://github.com/Rust-GCC/gccrs/commit/50e47dba16df43b6d45849e364cce6963950d3ce"}], "stats": {"total": 25, "additions": 23, "deletions": 2}, "files": [{"sha": "2d261e7381b0e80f1477179bb5db2053bf0e6787", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/03ba2e11227bfe13580b80367feeb196035109ed/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/03ba2e11227bfe13580b80367feeb196035109ed/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=03ba2e11227bfe13580b80367feeb196035109ed", "patch": "@@ -1,3 +1,9 @@\n+2007-09-05  Paolo Carlini  <pcarlini@suse.de>\n+\n+\tPR c++/29731 (again)\n+\t* parser.c (cp_parser_primary_expression): Return error_mark_node\n+\twhen a statement-expression is found in a template-argument list.\n+\n 2007-09-04  Jason Merrill  <jason@redhat.com>\n \n \tPR c++/31419"}, {"sha": "9f967177351d2423df95275ac5394cd5ab0d232c", "filename": "gcc/cp/parser.c", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/03ba2e11227bfe13580b80367feeb196035109ed/gcc%2Fcp%2Fparser.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/03ba2e11227bfe13580b80367feeb196035109ed/gcc%2Fcp%2Fparser.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fparser.c?ref=03ba2e11227bfe13580b80367feeb196035109ed", "patch": "@@ -3166,9 +3166,11 @@ cp_parser_primary_expression (cp_parser *parser,\n \t\t int i = ({ int j = 3; j + 1; });\n \n \t       at class or namespace scope.  */\n-\t    if (!parser->in_function_body)\n+\t    if (!parser->in_function_body\n+\t\t|| parser->in_template_argument_list_p)\n \t      {\n-\t\terror (\"statement-expressions are allowed only inside functions\");\n+\t\terror (\"statement-expressions are not allowed outside \"\n+\t\t       \"functions nor in template-argument lists\");\n \t\tcp_parser_skip_to_end_of_block_or_statement (parser);\n \t\texpr = error_mark_node;\n \t      }"}, {"sha": "aa4306bcb41eff9fa7f1799e5dfaa860ab33ea55", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/03ba2e11227bfe13580b80367feeb196035109ed/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/03ba2e11227bfe13580b80367feeb196035109ed/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=03ba2e11227bfe13580b80367feeb196035109ed", "patch": "@@ -1,3 +1,8 @@\n+2007-09-05  Paolo Carlini  <pcarlini@suse.de>\n+\n+\tPR c++/29731\n+\t* g++.dg/parse/template24.C: New.\n+\n 2007-09-04  Andrew Pinski  <andrew_pinski@playstation.sony.com>\n \n \t* g++.dg/other/spu2vmx-1.C: New test."}, {"sha": "33d9d4cfd5a4a95a41deded823ad53017e9de8c2", "filename": "gcc/testsuite/g++.dg/parse/template24.C", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/03ba2e11227bfe13580b80367feeb196035109ed/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Ftemplate24.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/03ba2e11227bfe13580b80367feeb196035109ed/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Ftemplate24.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Ftemplate24.C?ref=03ba2e11227bfe13580b80367feeb196035109ed", "patch": "@@ -0,0 +1,8 @@\n+/* PR c++/29731. This used to ICE in uses_template_parms. */\n+\n+template<int> struct A {};\n+\n+void foo()\n+{\n+  A<({})> a; /* { dg-error \"forbids braced-groups within expressions|statement-expressions|template argument 1 is invalid|invalid type\" } */\n+}"}]}