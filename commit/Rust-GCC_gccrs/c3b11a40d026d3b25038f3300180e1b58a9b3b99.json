{"sha": "c3b11a40d026d3b25038f3300180e1b58a9b3b99", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzNiMTFhNDBkMDI2ZDNiMjUwMzhmMzMwMDE4MGUxYjU4YTliM2I5OQ==", "commit": {"author": {"name": "Richard Henderson", "email": "rth@redhat.com", "date": "2006-06-14T15:20:01Z"}, "committer": {"name": "Richard Henderson", "email": "rth@gcc.gnu.org", "date": "2006-06-14T15:20:01Z"}, "message": "re PR libgomp/28008 (build failure due to PTHREAD_STACK_MIN not being declared)\n\n\tPR libgomp/28008\n        * env.c (initialize_env): Avoid using PTHREAD_STACK_MIN when\n        undefined.  Use GOMP_STACKSIZE not OMP_STACKSIZE for environment.\n\nFrom-SVN: r114643", "tree": {"sha": "8a20396d0e9f20b4f1bedc45a3b8705cd1c7a576", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8a20396d0e9f20b4f1bedc45a3b8705cd1c7a576"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c3b11a40d026d3b25038f3300180e1b58a9b3b99", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c3b11a40d026d3b25038f3300180e1b58a9b3b99", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c3b11a40d026d3b25038f3300180e1b58a9b3b99", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c3b11a40d026d3b25038f3300180e1b58a9b3b99/comments", "author": null, "committer": null, "parents": [{"sha": "184f4c5647deb9430279f508fe507084cf06193a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/184f4c5647deb9430279f508fe507084cf06193a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/184f4c5647deb9430279f508fe507084cf06193a"}], "stats": {"total": 32, "additions": 22, "deletions": 10}, "files": [{"sha": "fc12d41bd72d6b0283570e490316417a2647e260", "filename": "libgomp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c3b11a40d026d3b25038f3300180e1b58a9b3b99/libgomp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c3b11a40d026d3b25038f3300180e1b58a9b3b99/libgomp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2FChangeLog?ref=c3b11a40d026d3b25038f3300180e1b58a9b3b99", "patch": "@@ -1,3 +1,9 @@\n+2006-06-14  Richard Henderson  <rth@redhat.com>\n+\n+\tPR libgomp/28008\n+\t* env.c (initialize_env): Avoid using PTHREAD_STACK_MIN when\n+\tundefined.  Use GOMP_STACKSIZE not OMP_STACKSIZE for environment.\n+\n 2006-06-09  Richard Henderson  <rth@redhat.com>\n \n \t* env.c (gomp_nthreads_var): Change to unsigned long."}, {"sha": "c86ebc6d8559c2b27066624c255c5faa90ca8f93", "filename": "libgomp/env.c", "status": "modified", "additions": 16, "deletions": 10, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c3b11a40d026d3b25038f3300180e1b58a9b3b99/libgomp%2Fenv.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c3b11a40d026d3b25038f3300180e1b58a9b3b99/libgomp%2Fenv.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Fenv.c?ref=c3b11a40d026d3b25038f3300180e1b58a9b3b99", "patch": "@@ -166,21 +166,27 @@ initialize_env (void)\n   pthread_attr_init (&gomp_thread_attr);\n   pthread_attr_setdetachstate (&gomp_thread_attr, PTHREAD_CREATE_DETACHED);\n \n-  if (parse_unsigned_long (\"OMP_STACKSIZE\", &stacksize))\n+  if (parse_unsigned_long (\"GOMP_STACKSIZE\", &stacksize))\n     {\n+      int err;\n+\n       stacksize *= 1024;\n-      if (stacksize < PTHREAD_STACK_MIN)\n-\tgomp_error (\"Stack size less than minimum of %luk\",\n-\t\t    PTHREAD_STACK_MIN / 1024ul\n-\t\t    + (PTHREAD_STACK_MIN % 1024 != 0));\n-      else\n+      err = pthread_attr_setstacksize (&gomp_thread_attr, stacksize);\n+\n+#ifdef PTHREAD_STACK_MIN\n+      if (err == EINVAL)\n \t{\n-\t  int err = pthread_attr_setstacksize (&gomp_thread_attr, stacksize);\n-\t  if (err == EINVAL)\n+\t  if (stacksize < PTHREAD_STACK_MIN)\n+\t    gomp_error (\"Stack size less than minimum of %luk\",\n+\t\t\tPTHREAD_STACK_MIN / 1024ul\n+\t\t\t+ (PTHREAD_STACK_MIN % 1024 != 0));\n+\t  else\n \t    gomp_error (\"Stack size larger than system limit\");\n-\t  else if (err != 0)\n-\t    gomp_error (\"Stack size change failed: %s\", strerror (err));\n \t}\n+      else\n+#endif\n+      if (err != 0)\n+\tgomp_error (\"Stack size change failed: %s\", strerror (err));\n     }\n }\n "}]}