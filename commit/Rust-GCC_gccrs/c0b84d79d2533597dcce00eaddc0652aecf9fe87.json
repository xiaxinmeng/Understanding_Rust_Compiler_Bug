{"sha": "c0b84d79d2533597dcce00eaddc0652aecf9fe87", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzBiODRkNzlkMjUzMzU5N2RjY2UwMGVhZGRjMDY1MmFlY2Y5ZmU4Nw==", "commit": {"author": {"name": "Vadim Egorov", "email": "egorovv@mailandnews.com", "date": "2000-05-09T07:19:14Z"}, "committer": {"name": "Benjamin Kosnik", "email": "bkoz@gcc.gnu.org", "date": "2000-05-09T07:19:14Z"}, "message": "streambuf.tcc (basic_streambuf::xsgetn): Fix uflow case.\n\n\n2000-05-09  Vadim Egorov  <egorovv@mailandnews.com>\n\t    Benjamin Kosnik  <bkoz@gnu.org>\n\t    Nathan Myers  <ncm@cantrip.org>\n\t    Dietmar Kuehl  <dietmar_kuehl@yahoo.com>\n\n        * bits/streambuf.tcc (basic_streambuf::xsgetn): Fix uflow case.\n\t(basic_streambuf::xsputn): Make consistent.\n\t* testsuite/27_io/filebuf.cc: Add tests.\n\nCo-Authored-By: Benjamin Kosnik <bkoz@gnu.org>\nCo-Authored-By: Dietmar Kuehl <dietmar_kuehl@yahoo.com>\nCo-Authored-By: Nathan Myers <ncm@cantrip.org>\n\nFrom-SVN: r33794", "tree": {"sha": "680d5729f6fb38d313b6e014e2964216f72074de", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/680d5729f6fb38d313b6e014e2964216f72074de"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c0b84d79d2533597dcce00eaddc0652aecf9fe87", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c0b84d79d2533597dcce00eaddc0652aecf9fe87", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c0b84d79d2533597dcce00eaddc0652aecf9fe87", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c0b84d79d2533597dcce00eaddc0652aecf9fe87/comments", "author": null, "committer": null, "parents": [{"sha": "6b6c1201e6e9a1ff43c6871810881a1776c99c0c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6b6c1201e6e9a1ff43c6871810881a1776c99c0c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6b6c1201e6e9a1ff43c6871810881a1776c99c0c"}], "stats": {"total": 48, "additions": 39, "deletions": 9}, "files": [{"sha": "9bc18456baafeaa8603c98c772ab235777e5e075", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0b84d79d2533597dcce00eaddc0652aecf9fe87/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0b84d79d2533597dcce00eaddc0652aecf9fe87/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=c0b84d79d2533597dcce00eaddc0652aecf9fe87", "patch": "@@ -1,3 +1,12 @@\n+2000-05-03  Vadim Egorov  <egorovv@mailandnews.com>\n+\t    Benjamin Kosnik  <bkoz@gnu.org>\n+\t    Nathan Myers  <ncm@cantrip.org>\n+\t    Dietmar Kuehl  <dietmar_kuehl@yahoo.com> \n+\n+        * bits/streambuf.tcc (basic_streambuf::xsgetn): Fix uflow case.\n+\t(basic_streambuf::xsputn): Make consistent.\n+\t* testsuite/27_io/filebuf.cc: Add tests.\n+\t\n 2000-05-08  Steven King  <sxking@uswest.net>\n \n         * bits/char_traits.h: use wchar_t utility functions for"}, {"sha": "45eb332f9a71ec6a0fc120e68baba04c51c37bb4", "filename": "libstdc++-v3/bits/streambuf.tcc", "status": "modified", "additions": 10, "deletions": 8, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0b84d79d2533597dcce00eaddc0652aecf9fe87/libstdc%2B%2B-v3%2Fbits%2Fstreambuf.tcc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0b84d79d2533597dcce00eaddc0652aecf9fe87/libstdc%2B%2B-v3%2Fbits%2Fstreambuf.tcc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fbits%2Fstreambuf.tcc?ref=c0b84d79d2533597dcce00eaddc0652aecf9fe87", "patch": "@@ -1,6 +1,6 @@\n // Stream buffer classes -*- C++ -*-\n \n-// Copyright (C) 1997-1999 Free Software Foundation, Inc.\n+// Copyright (C) 1997-1999, 2000 Free Software Foundation, Inc.\n //\n // This file is part of the GNU ISO C++ Library.  This library is free\n // software; you can redistribute it and/or modify it under the\n@@ -145,10 +145,12 @@ namespace std {\n \t      \n \t      if (__retval != __n)\n \t\t{\n-\t\t  if (this->uflow() != traits_type::eof())\n-\t\t    ++__retval;\n-\t\t  else\n-\t\t    break;\n+\t\t  int_type __c = this->uflow();  \n+\t\t  if (traits_type::eq_int_type(__c, traits_type::eof()))\n+                    break;\n+\n+\t\t  traits_type::assign(*__s++, traits_type::to_char_type(__c));\n+                  ++__retval;\n \t\t}\n \t    }\n \t}\n@@ -175,9 +177,9 @@ namespace std {\n \t      bool __testout = _M_mode & ios_base::out;\n \t      if (!(__testput && __testout))\n \t\t{\n-\t\t  char_type __c = *__s;\n-\t\t  char_type __overfc = this->overflow(__c);\n-\t\t  if (__c == __overfc)\n+\t\t  int_type __c = traits_type::to_int_type(*__s);\n+\t\t  int_type __overfc = this->overflow(__c);\n+\t\t  if (traits_type::eq_int_type(__c, __overfc))\n \t\t    {\n \t\t      ++__retval;\n \t\t      ++__s;"}, {"sha": "40e6cc6a1ab1ee7b1b0682466e969ab464d6870c", "filename": "libstdc++-v3/testsuite/27_io/filebuf.cc", "status": "modified", "additions": 20, "deletions": 1, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0b84d79d2533597dcce00eaddc0652aecf9fe87/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Ffilebuf.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0b84d79d2533597dcce00eaddc0652aecf9fe87/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Ffilebuf.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Ffilebuf.cc?ref=c0b84d79d2533597dcce00eaddc0652aecf9fe87", "patch": "@@ -503,12 +503,31 @@ bool test03() {\n   return test;\n }\n \n+bool test04()\n+{\n+  using namespace std;\n+  typedef istream::int_type\tint_type;\n+\n+  bool test = true;\n+  ifstream ifs(name_02);\n+  char buffer[] = \"xxxxxxxxxx\";\n+  int_type len1 = ifs.rdbuf()->sgetn(buffer, sizeof(buffer));\n+  test &= len1 == sizeof(buffer);\n+  test &= buffer[0] == 'a';\n \n-int main() {\n+#ifdef DEBUG_ASSERT\n+  assert(test);\n+#endif\n+  return test;\n+}\n+\n+int main() \n+{\n   test00();\n   test01();\n   test02();\n   test03();\n+  test04();\n \n   return 0;\n }"}]}