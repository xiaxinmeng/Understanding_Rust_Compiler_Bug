{"sha": "d4b0a294694a145aa33a25d1f923f4085b8f7d99", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDRiMGEyOTQ2OTRhMTQ1YWEzM2EyNWQxZjkyM2Y0MDg1YjhmN2Q5OQ==", "commit": {"author": {"name": "Piotr Trojanek", "email": "trojanek@adacore.com", "date": "2021-01-01T23:51:21Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "derodat@adacore.com", "date": "2021-05-04T09:17:29Z"}, "message": "[Ada] Fix inconsistent handling of character set control switches\n\ngcc/ada/\n\n\t* csets.adb (Initialize): Refactor into CASE statement; raise\n\texception on unsupported code of character set (it will be\n\tgently rejected earlier when scanning command line switches).\n\t* switch-b.adb (Scan_Binder_Switches): Refactor into a\n\tmembership expression; add missing '9' choice; reorder as\n\tdescribed by GNAT UG, section 4.3.11.\n\t* switch-c.adb (Scan_Front_End_Switches): Refactor into a\n\tmembership expression and reorder as above.\n\t* doc/gnat_ugn/building_executable_programs_with_gnat.rst\n\t(gnatic): Mention '5' as an allowed value for \"c\".\n\t* gnat_ugn.texi: Regenerate.", "tree": {"sha": "255d19fc97528d34027860dabd117c0291addec9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/255d19fc97528d34027860dabd117c0291addec9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d4b0a294694a145aa33a25d1f923f4085b8f7d99", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d4b0a294694a145aa33a25d1f923f4085b8f7d99", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d4b0a294694a145aa33a25d1f923f4085b8f7d99", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d4b0a294694a145aa33a25d1f923f4085b8f7d99/comments", "author": {"login": "ptroja", "id": 161602, "node_id": "MDQ6VXNlcjE2MTYwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/161602?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ptroja", "html_url": "https://github.com/ptroja", "followers_url": "https://api.github.com/users/ptroja/followers", "following_url": "https://api.github.com/users/ptroja/following{/other_user}", "gists_url": "https://api.github.com/users/ptroja/gists{/gist_id}", "starred_url": "https://api.github.com/users/ptroja/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ptroja/subscriptions", "organizations_url": "https://api.github.com/users/ptroja/orgs", "repos_url": "https://api.github.com/users/ptroja/repos", "events_url": "https://api.github.com/users/ptroja/events{/privacy}", "received_events_url": "https://api.github.com/users/ptroja/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pmderodat", "id": 758452, "node_id": "MDQ6VXNlcjc1ODQ1Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/758452?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pmderodat", "html_url": "https://github.com/pmderodat", "followers_url": "https://api.github.com/users/pmderodat/followers", "following_url": "https://api.github.com/users/pmderodat/following{/other_user}", "gists_url": "https://api.github.com/users/pmderodat/gists{/gist_id}", "starred_url": "https://api.github.com/users/pmderodat/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pmderodat/subscriptions", "organizations_url": "https://api.github.com/users/pmderodat/orgs", "repos_url": "https://api.github.com/users/pmderodat/repos", "events_url": "https://api.github.com/users/pmderodat/events{/privacy}", "received_events_url": "https://api.github.com/users/pmderodat/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b65d9aff59bdaa77578de0666077fdf671a020bc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b65d9aff59bdaa77578de0666077fdf671a020bc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b65d9aff59bdaa77578de0666077fdf671a020bc"}], "stats": {"total": 71, "additions": 30, "deletions": 41}, "files": [{"sha": "29a15920998f4ba8176cc060ad779bfef825964c", "filename": "gcc/ada/csets.adb", "status": "modified", "additions": 25, "deletions": 23, "changes": 48, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d4b0a294694a145aa33a25d1f923f4085b8f7d99/gcc%2Fada%2Fcsets.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d4b0a294694a145aa33a25d1f923f4085b8f7d99/gcc%2Fada%2Fcsets.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fcsets.adb?ref=d4b0a294694a145aa33a25d1f923f4085b8f7d99", "patch": "@@ -1091,38 +1091,40 @@ package body Csets is\n    begin\n       --  Set Fold_Upper table from source code indication\n \n-      if Identifier_Character_Set = '1'\n-        or else Identifier_Character_Set = 'w'\n-      then\n-         Fold_Upper := Fold_Latin_1;\n+      case Identifier_Character_Set is\n+         when '1' | 'w' =>\n+            Fold_Upper := Fold_Latin_1;\n \n-      elsif Identifier_Character_Set = '2' then\n-         Fold_Upper := Fold_Latin_2;\n+         when '2' =>\n+            Fold_Upper := Fold_Latin_2;\n \n-      elsif Identifier_Character_Set = '3' then\n-         Fold_Upper := Fold_Latin_3;\n+         when '3' =>\n+            Fold_Upper := Fold_Latin_3;\n \n-      elsif Identifier_Character_Set = '4' then\n-         Fold_Upper := Fold_Latin_4;\n+         when '4' =>\n+            Fold_Upper := Fold_Latin_4;\n \n-      elsif Identifier_Character_Set = '5' then\n-         Fold_Upper := Fold_Cyrillic;\n+         when '5' =>\n+            Fold_Upper := Fold_Cyrillic;\n \n-      elsif Identifier_Character_Set = 'p' then\n-         Fold_Upper := Fold_IBM_PC_437;\n+         when '9' =>\n+            Fold_Upper := Fold_Latin_9;\n \n-      elsif Identifier_Character_Set = '8' then\n-         Fold_Upper := Fold_IBM_PC_850;\n+         when 'p' =>\n+            Fold_Upper := Fold_IBM_PC_437;\n \n-      elsif Identifier_Character_Set = '9' then\n-         Fold_Upper := Fold_Latin_9;\n+         when '8' =>\n+            Fold_Upper := Fold_IBM_PC_850;\n \n-      elsif Identifier_Character_Set = 'f' then\n-         Fold_Upper := Fold_Full_Upper_Half;\n+         when 'f' =>\n+            Fold_Upper := Fold_Full_Upper_Half;\n \n-      else -- Identifier_Character_Set = 'n'\n-         Fold_Upper := Fold_No_Upper_Half;\n-      end if;\n+         when 'n' =>\n+            Fold_Upper := Fold_No_Upper_Half;\n+\n+         when others =>\n+            raise Program_Error;\n+      end case;\n \n       --  Use Fold_Upper table to compute Fold_Lower table\n "}, {"sha": "91fae31c4e89ed1e86f7d52de375e1934c01bf8a", "filename": "gcc/ada/doc/gnat_ugn/building_executable_programs_with_gnat.rst", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d4b0a294694a145aa33a25d1f923f4085b8f7d99/gcc%2Fada%2Fdoc%2Fgnat_ugn%2Fbuilding_executable_programs_with_gnat.rst", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d4b0a294694a145aa33a25d1f923f4085b8f7d99/gcc%2Fada%2Fdoc%2Fgnat_ugn%2Fbuilding_executable_programs_with_gnat.rst", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fdoc%2Fgnat_ugn%2Fbuilding_executable_programs_with_gnat.rst?ref=d4b0a294694a145aa33a25d1f923f4085b8f7d99", "patch": "@@ -1896,7 +1896,7 @@ Alphabetical List of All Switches\n .. index:: -gnati  (gcc)\n \n :switch:`-gnati{c}`\n-  Identifier character set (``c`` = 1/2/3/4/8/9/p/f/n/w).\n+  Identifier character set (``c`` = 1/2/3/4/5/9/p/8/f/n/w).\n   For details of the possible selections for ``c``,\n   see :ref:`Character_Set_Control`.\n "}, {"sha": "559231415d496c2af54219e579c2571c42190443", "filename": "gcc/ada/gnat_ugn.texi", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d4b0a294694a145aa33a25d1f923f4085b8f7d99/gcc%2Fada%2Fgnat_ugn.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d4b0a294694a145aa33a25d1f923f4085b8f7d99/gcc%2Fada%2Fgnat_ugn.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgnat_ugn.texi?ref=d4b0a294694a145aa33a25d1f923f4085b8f7d99", "patch": "@@ -21,7 +21,7 @@\n \n @copying\n @quotation\n-GNAT User's Guide for Native Platforms , Dec 11, 2020\n+GNAT User's Guide for Native Platforms , Apr 12, 2021\n \n AdaCore\n \n@@ -9462,7 +9462,7 @@ For further details see @ref{f,,Elaboration Order Handling in GNAT}.\n \n @item @code{-gnati@emph{c}}\n \n-Identifier character set (@code{c} = 1/2/3/4/8/9/p/f/n/w).\n+Identifier character set (@code{c} = 1/2/3/4/5/9/p/8/f/n/w).\n For details of the possible selections for @code{c},\n see @ref{31,,Character Set Control}.\n @end table"}, {"sha": "a7359789e5aa156e03d7a2ae9a49d04cfd765921", "filename": "gcc/ada/switch-b.adb", "status": "modified", "additions": 1, "deletions": 7, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d4b0a294694a145aa33a25d1f923f4085b8f7d99/gcc%2Fada%2Fswitch-b.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d4b0a294694a145aa33a25d1f923f4085b8f7d99/gcc%2Fada%2Fswitch-b.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fswitch-b.adb?ref=d4b0a294694a145aa33a25d1f923f4085b8f7d99", "patch": "@@ -369,13 +369,7 @@ package body Switch.B is\n             Ptr := Ptr + 1;\n             C := Switch_Chars (Ptr);\n \n-            if C in '1' .. '5'\n-              or else C = '8'\n-              or else C = 'p'\n-              or else C = 'f'\n-              or else C = 'n'\n-              or else C = 'w'\n-            then\n+            if C in '1' .. '5' | '9' | 'p' | '8' | 'f' | 'n' | 'w' then\n                Identifier_Character_Set := C;\n                Ptr := Ptr + 1;\n             else"}, {"sha": "b97e0d6e55389f976f1ae9b5c25dd2df7112587b", "filename": "gcc/ada/switch-c.adb", "status": "modified", "additions": 1, "deletions": 8, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d4b0a294694a145aa33a25d1f923f4085b8f7d99/gcc%2Fada%2Fswitch-c.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d4b0a294694a145aa33a25d1f923f4085b8f7d99/gcc%2Fada%2Fswitch-c.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fswitch-c.adb?ref=d4b0a294694a145aa33a25d1f923f4085b8f7d99", "patch": "@@ -929,14 +929,7 @@ package body Switch.C is\n                Ptr := Ptr + 1;\n                C := Switch_Chars (Ptr);\n \n-               if C in '1' .. '5'\n-                 or else C = '8'\n-                 or else C = '9'\n-                 or else C = 'p'\n-                 or else C = 'f'\n-                 or else C = 'n'\n-                 or else C = 'w'\n-               then\n+               if C in '1' .. '5' | '8' | 'p' | '9' | 'f' | 'n' | 'w' then\n                   Identifier_Character_Set := C;\n                   Ptr := Ptr + 1;\n "}]}