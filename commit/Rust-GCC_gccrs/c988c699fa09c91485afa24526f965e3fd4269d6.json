{"sha": "c988c699fa09c91485afa24526f965e3fd4269d6", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Yzk4OGM2OTlmYTA5YzkxNDg1YWZhMjQ1MjZmOTY1ZTNmZDQyNjlkNg==", "commit": {"author": {"name": "Steven G. Kargl", "email": "kargl@gcc.gnu.org", "date": "2019-10-11T17:41:29Z"}, "committer": {"name": "Steven G. Kargl", "email": "kargl@gcc.gnu.org", "date": "2019-10-11T17:41:29Z"}, "message": "re PR fortran/92019 (ICE in find_inquiry_ref, at expr.c:1790)\n\n2019-10-11  Steven G. Kargl  <kargl@gcc.gnu.org>\n\n\tPR fortran/92019\n\t* array.c (match_subscript): BOZ cannot be an array subscript.\n \n \n2019-10-11  Steven G. Kargl  <kargl@gcc.gnu.org>\n\n\tPR fortran/92019\n\t* gfortran.dg/pr92019.f90: New test.\n\nFrom-SVN: r276897", "tree": {"sha": "fc6d165dafb5b3e327bb75cb55969d6c0b3b1cff", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/fc6d165dafb5b3e327bb75cb55969d6c0b3b1cff"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c988c699fa09c91485afa24526f965e3fd4269d6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c988c699fa09c91485afa24526f965e3fd4269d6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c988c699fa09c91485afa24526f965e3fd4269d6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c988c699fa09c91485afa24526f965e3fd4269d6/comments", "author": null, "committer": null, "parents": [{"sha": "fe2bc27cdb6d572da0163d77e787ba644b400753", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fe2bc27cdb6d572da0163d77e787ba644b400753", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fe2bc27cdb6d572da0163d77e787ba644b400753"}], "stats": {"total": 40, "additions": 39, "deletions": 1}, "files": [{"sha": "47b20614cd7643e88380ebfef2768b74617ef82b", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c988c699fa09c91485afa24526f965e3fd4269d6/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c988c699fa09c91485afa24526f965e3fd4269d6/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=c988c699fa09c91485afa24526f965e3fd4269d6", "patch": "@@ -1,3 +1,8 @@\n+2019-10-11  Steven G. Kargl  <kargl@gcc.gnu.org>\n+\n+\tPR fortran/92019\n+\t* array.c (match_subscript): BOZ cannot be an array subscript.\n+\n 2019-10-11  Tobias Burnus  <tobias@codesourcery.com>\n \n \tPR fortran/92050"}, {"sha": "cbeece44ecf3f11185b2034c4364063c87e63d35", "filename": "gcc/fortran/array.c", "status": "modified", "additions": 20, "deletions": 1, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c988c699fa09c91485afa24526f965e3fd4269d6/gcc%2Ffortran%2Farray.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c988c699fa09c91485afa24526f965e3fd4269d6/gcc%2Ffortran%2Farray.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Farray.c?ref=c988c699fa09c91485afa24526f965e3fd4269d6", "patch": "@@ -66,6 +66,7 @@ match_subscript (gfc_array_ref *ar, int init, bool match_star)\n   match m = MATCH_ERROR;\n   bool star = false;\n   int i;\n+  bool saw_boz = false;\n \n   i = ar->dimen + ar->codimen;\n \n@@ -91,6 +92,12 @@ match_subscript (gfc_array_ref *ar, int init, bool match_star)\n   else if (!star)\n     m = gfc_match_expr (&ar->start[i]);\n \n+  if (ar->start[i] && ar->start[i]->ts.type == BT_BOZ)\n+    {\n+      gfc_error (\"Invalid BOZ literal constant used in subscript at %C\");\n+      saw_boz = true;\n+    }\n+\n   if (m == MATCH_NO)\n     gfc_error (\"Expected array subscript at %C\");\n   if (m != MATCH_YES)\n@@ -117,6 +124,12 @@ match_subscript (gfc_array_ref *ar, int init, bool match_star)\n   else\n     m = gfc_match_expr (&ar->end[i]);\n \n+  if (ar->end[i] && ar->end[i]->ts.type == BT_BOZ)\n+    {\n+      gfc_error (\"Invalid BOZ literal constant used in subscript at %C\");\n+      saw_boz = true;\n+    }\n+\n   if (m == MATCH_ERROR)\n     return MATCH_ERROR;\n \n@@ -132,6 +145,12 @@ match_subscript (gfc_array_ref *ar, int init, bool match_star)\n       m = init ? gfc_match_init_expr (&ar->stride[i])\n \t       : gfc_match_expr (&ar->stride[i]);\n \n+      if (ar->stride[i] && ar->stride[i]->ts.type == BT_BOZ)\n+\t{\n+\t  gfc_error (\"Invalid BOZ literal constant used in subscript at %C\");\n+\t  saw_boz = true;\n+\t}\n+\n       if (m == MATCH_NO)\n \tgfc_error (\"Expected array subscript stride at %C\");\n       if (m != MATCH_YES)\n@@ -142,7 +161,7 @@ match_subscript (gfc_array_ref *ar, int init, bool match_star)\n   if (star)\n     ar->dimen_type[i] = DIMEN_STAR;\n \n-  return MATCH_YES;\n+  return (saw_boz ? MATCH_ERROR : MATCH_YES);\n }\n \n "}, {"sha": "6c6a077259f54ed914f73a92ad8b35aa37e8cce6", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c988c699fa09c91485afa24526f965e3fd4269d6/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c988c699fa09c91485afa24526f965e3fd4269d6/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=c988c699fa09c91485afa24526f965e3fd4269d6", "patch": "@@ -1,3 +1,8 @@\n+2019-10-11  Steven G. Kargl  <kargl@gcc.gnu.org>\n+\n+\tPR fortran/92019\n+\t* gfortran.dg/pr92019.f90: New test.\n+\n 2019-10-11  Joseph Myers  <joseph@codesourcery.com>\n \n \t* gcc.dg/dfp/c11-keywords-1.c, gcc.dg/dfp/c11-keywords-2.c,"}, {"sha": "488774ba82f641de554165f63f50418e83313536", "filename": "gcc/testsuite/gfortran.dg/pr92019.f90", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c988c699fa09c91485afa24526f965e3fd4269d6/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr92019.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c988c699fa09c91485afa24526f965e3fd4269d6/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr92019.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr92019.f90?ref=c988c699fa09c91485afa24526f965e3fd4269d6", "patch": "@@ -0,0 +1,9 @@\n+! { dg-do compile }\n+! PR fortran/92019\n+program foo\n+  integer :: a(4) = [1, 2, 3, 4]\n+  print *, a(z'1')            ! { dg-error \"Invalid BOZ literal constant\" }\n+  print *, a(1:z'3')          ! { dg-error \"Invalid BOZ literal constant\" }\n+  print *, a(1:2:z'2')        ! { dg-error \"Invalid BOZ literal constant\" }\n+  print *, a([z'2',z'1'])     ! { dg-error \"cannot appear in an array constructor\" }\n+end program foo"}]}