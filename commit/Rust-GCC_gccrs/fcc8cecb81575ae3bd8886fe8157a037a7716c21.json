{"sha": "fcc8cecb81575ae3bd8886fe8157a037a7716c21", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZmNjOGNlY2I4MTU3NWFlM2JkODg4NmZlODE1N2EwMzdhNzcxNmMyMQ==", "commit": {"author": {"name": "Tom Tromey", "email": "tromey@redhat.com", "date": "2003-05-03T00:35:06Z"}, "committer": {"name": "Tom Tromey", "email": "tromey@gcc.gnu.org", "date": "2003-05-03T00:35:06Z"}, "message": "re PR java/10459 (ICE with certain expressions as 3rd clause of for loop)\n\n\tPR java/10459:\n\t* parse.y (finish_for_loop): Do nothing if update expression is a\n\tEXPR_WFL_NODE wrapping nothing.\n\t(java_complete_lhs) <COMPOUND_EXPR>: Likewise.\n\nFrom-SVN: r66411", "tree": {"sha": "838c4b462be1965ca1ec669a6e685e99e218174a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/838c4b462be1965ca1ec669a6e685e99e218174a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/fcc8cecb81575ae3bd8886fe8157a037a7716c21", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fcc8cecb81575ae3bd8886fe8157a037a7716c21", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fcc8cecb81575ae3bd8886fe8157a037a7716c21", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fcc8cecb81575ae3bd8886fe8157a037a7716c21/comments", "author": null, "committer": null, "parents": [{"sha": "a6f1f688a61cfe868d78ffddd633bc9aa120ab1d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a6f1f688a61cfe868d78ffddd633bc9aa120ab1d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a6f1f688a61cfe868d78ffddd633bc9aa120ab1d"}], "stats": {"total": 28, "additions": 21, "deletions": 7}, "files": [{"sha": "02e5075be53d06be31398adfdef5fc5a2caf6555", "filename": "gcc/java/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fcc8cecb81575ae3bd8886fe8157a037a7716c21/gcc%2Fjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fcc8cecb81575ae3bd8886fe8157a037a7716c21/gcc%2Fjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2FChangeLog?ref=fcc8cecb81575ae3bd8886fe8157a037a7716c21", "patch": "@@ -1,3 +1,10 @@\n+2003-05-01  Tom Tromey  <tromey@redhat.com>\n+\n+\tPR java/10459:\n+\t* parse.y (finish_for_loop): Do nothing if update expression is a\n+\tEXPR_WFL_NODE wrapping nothing.\n+\t(java_complete_lhs) <COMPOUND_EXPR>: Likewise.\n+\n 2003-05-02  Nathan Sidwell  <nathan@codesourcery.com>\n \n \t* lex.h (input_lineno): Remove declaration."}, {"sha": "49fbc9162c08fca3fb0066c46812977992bdef01", "filename": "gcc/java/parse.y", "status": "modified", "additions": 14, "deletions": 7, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fcc8cecb81575ae3bd8886fe8157a037a7716c21/gcc%2Fjava%2Fparse.y", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fcc8cecb81575ae3bd8886fe8157a037a7716c21/gcc%2Fjava%2Fparse.y", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2Fparse.y?ref=fcc8cecb81575ae3bd8886fe8157a037a7716c21", "patch": "@@ -11771,7 +11771,9 @@ java_complete_lhs (tree node)\n \t      nn = wfl_op2;\n \t      if (TREE_CODE (nn) == EXPR_WITH_FILE_LOCATION)\n \t\tnn = EXPR_WFL_NODE (nn);\n-\t      if (TREE_CODE (nn) != EXIT_EXPR)\n+\t      /* NN can be NULL_TREE exactly when UPDATE is, in\n+\t\t finish_for_loop.  */\n+\t      if (nn != NULL_TREE && TREE_CODE (nn) != EXIT_EXPR)\n \t\t{\n \t\t  SET_WFL_OPERATOR (wfl_operator, node, wfl_op2);\n \t\t  if (SUPPRESS_UNREACHABLE_ERROR (nn))\n@@ -14928,12 +14930,17 @@ finish_for_loop (int location, tree condition, tree update, tree body)\n       tree up2 = update;\n       if (TREE_CODE (up2) == EXPR_WITH_FILE_LOCATION)\n \tup2 = EXPR_WFL_NODE (up2);\n-      /* Try to detect constraint violations.  These would be\n-\t programming errors somewhere.  */\n-      if (! IS_EXPR_CODE_CLASS (TREE_CODE_CLASS (TREE_CODE (up2)))\n-\t  || TREE_CODE (up2) == LOOP_EXPR)\n-\tabort ();\n-      SUPPRESS_UNREACHABLE_ERROR (up2) = 1;\n+      /* It is possible for the update expression to be an\n+\t EXPR_WFL_NODE wrapping nothing.  */\n+      if (up2 != NULL_TREE && up2 != empty_stmt_node)\n+\t{\n+\t  /* Try to detect constraint violations.  These would be\n+\t     programming errors somewhere.  */\n+\t  if (! IS_EXPR_CODE_CLASS (TREE_CODE_CLASS (TREE_CODE (up2)))\n+\t      || TREE_CODE (up2) == LOOP_EXPR)\n+\t    abort ();\n+\t  SUPPRESS_UNREACHABLE_ERROR (up2) = 1;\n+\t}\n     }\n   LOOP_EXPR_BODY_UPDATE_BLOCK (LOOP_EXPR_BODY (loop)) = update;\n   return loop;"}]}