{"sha": "0e8f29daae817560fa28935f23150307abee8f43", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MGU4ZjI5ZGFhZTgxNzU2MGZhMjg5MzVmMjMxNTAzMDdhYmVlOGY0Mw==", "commit": {"author": {"name": "Martin Liska", "email": "mliska@suse.cz", "date": "2018-05-29T12:11:21Z"}, "committer": {"name": "Martin Liska", "email": "marxin@gcc.gnu.org", "date": "2018-05-29T12:11:21Z"}, "message": "libgcov: report about a different timestamp (PR gcov-profile/85759).\n\n2018-05-29  Martin Liska  <mliska@suse.cz>\n\n        PR gcov-profile/85759\n\t* doc/gcov.texi: Document GCOV_ERROR_FILE and GCOV_EXIT_AT_ERROR\n\tenv variables.\n2018-05-29  Martin Liska  <mliska@suse.cz>\n\n        PR gcov-profile/85759\n\t* libgcov-driver-system.c (gcov_error): Introduce usage of\n        GCOV_EXIT_AT_ERROR env. variable.\n\t* libgcov-driver.c (merge_one_data): Print error that we\n        overwrite a gcov file with a different timestamp.\n\nFrom-SVN: r260895", "tree": {"sha": "dae6fb571218c28f4bd4fc966f8b044443aebbc7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/dae6fb571218c28f4bd4fc966f8b044443aebbc7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0e8f29daae817560fa28935f23150307abee8f43", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0e8f29daae817560fa28935f23150307abee8f43", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0e8f29daae817560fa28935f23150307abee8f43", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0e8f29daae817560fa28935f23150307abee8f43/comments", "author": {"login": "marxin", "id": 2658545, "node_id": "MDQ6VXNlcjI2NTg1NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/2658545?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marxin", "html_url": "https://github.com/marxin", "followers_url": "https://api.github.com/users/marxin/followers", "following_url": "https://api.github.com/users/marxin/following{/other_user}", "gists_url": "https://api.github.com/users/marxin/gists{/gist_id}", "starred_url": "https://api.github.com/users/marxin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marxin/subscriptions", "organizations_url": "https://api.github.com/users/marxin/orgs", "repos_url": "https://api.github.com/users/marxin/repos", "events_url": "https://api.github.com/users/marxin/events{/privacy}", "received_events_url": "https://api.github.com/users/marxin/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "e379122d1f078d230514ff862c4f9053c2898af4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e379122d1f078d230514ff862c4f9053c2898af4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e379122d1f078d230514ff862c4f9053c2898af4"}], "stats": {"total": 40, "additions": 37, "deletions": 3}, "files": [{"sha": "b70c037273194451e6872f3d987fe7cd85001609", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0e8f29daae817560fa28935f23150307abee8f43/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0e8f29daae817560fa28935f23150307abee8f43/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=0e8f29daae817560fa28935f23150307abee8f43", "patch": "@@ -1,3 +1,9 @@\n+2018-05-29  Martin Liska  <mliska@suse.cz>\n+\n+        PR gcov-profile/85759\n+\t* doc/gcov.texi: Document GCOV_ERROR_FILE and GCOV_EXIT_AT_ERROR\n+\tenv variables.\n+\n 2018-05-29  Jakub Jelinek  <jakub@redhat.com>\n \n \t* tree-cfg.c (verify_gimple_assign_unary): Add checking for"}, {"sha": "1cdca118b45fa055082db9a148104a6c3ab6abd7", "filename": "gcc/doc/gcov.texi", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0e8f29daae817560fa28935f23150307abee8f43/gcc%2Fdoc%2Fgcov.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0e8f29daae817560fa28935f23150307abee8f43/gcc%2Fdoc%2Fgcov.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdoc%2Fgcov.texi?ref=0e8f29daae817560fa28935f23150307abee8f43", "patch": "@@ -801,6 +801,14 @@ as well as handlers registered with @code{atexit}.\n If an executable loads a dynamic shared object via dlopen functionality,\n @option{-Wl,--dynamic-list-data} is needed to dump all profile data.\n \n+Profiling run-time library reports various errors related to profile\n+manipulation and profile saving.  Errors are printed into standard error output\n+or @samp{GCOV_ERROR_FILE} file, if environment variable is used.\n+In order to terminate immediately after an errors occurs\n+set @samp{GCOV_EXIT_AT_ERROR} environment variable.\n+That can help users to find profile clashing which leads\n+to a misleading profile.\n+\n @c man end\n \n @node Gcov Data Files"}, {"sha": "7394b1fe341b28d1791e47e7a717c9f842e5e1ec", "filename": "libgcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0e8f29daae817560fa28935f23150307abee8f43/libgcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0e8f29daae817560fa28935f23150307abee8f43/libgcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgcc%2FChangeLog?ref=0e8f29daae817560fa28935f23150307abee8f43", "patch": "@@ -1,3 +1,11 @@\n+2018-05-29  Martin Liska  <mliska@suse.cz>\n+\n+        PR gcov-profile/85759\n+\t* libgcov-driver-system.c (gcov_error): Introduce usage of\n+        GCOV_EXIT_AT_ERROR env. variable.\n+\t* libgcov-driver.c (merge_one_data): Print error that we\n+        overwrite a gcov file with a different timestamp.\n+\n 2018-05-23  Kalamatee  <kalamatee@gmail.com>\n \n \t* config/m68k/lb1sf68.S (Laddsf$nf): Fix sign bit handling in"}, {"sha": "bf125869dc08c64363156534a74c1b23e81e8f27", "filename": "libgcc/libgcov-driver-system.c", "status": "modified", "additions": 9, "deletions": 1, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0e8f29daae817560fa28935f23150307abee8f43/libgcc%2Flibgcov-driver-system.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0e8f29daae817560fa28935f23150307abee8f43/libgcc%2Flibgcov-driver-system.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgcc%2Flibgcov-driver-system.c?ref=0e8f29daae817560fa28935f23150307abee8f43", "patch": "@@ -62,8 +62,16 @@ gcov_error (const char *fmt, ...)\n   va_list argp;\n \n   va_start (argp, fmt);\n-  ret = vfprintf (get_gcov_error_file (), fmt, argp);\n+  FILE *f = get_gcov_error_file ();\n+  ret = vfprintf (f, fmt, argp);\n   va_end (argp);\n+\n+  if (getenv (\"GCOV_EXIT_AT_ERROR\"))\n+    {\n+      fprintf (f, \"profiling:exiting after an error\\n\");\n+      exit (1);\n+    }\n+\n   return ret;\n }\n "}, {"sha": "610356383f1541461ebd7ca545f11667d2824963", "filename": "libgcc/libgcov-driver.c", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0e8f29daae817560fa28935f23150307abee8f43/libgcc%2Flibgcov-driver.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0e8f29daae817560fa28935f23150307abee8f43/libgcc%2Flibgcov-driver.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgcc%2Flibgcov-driver.c?ref=0e8f29daae817560fa28935f23150307abee8f43", "patch": "@@ -372,8 +372,12 @@ merge_one_data (const char *filename,\n \n   length = gcov_read_unsigned ();\n   if (length != gi_ptr->stamp)\n-    /* Read from a different compilation. Overwrite the file.  */\n-    return 0;\n+    {\n+      /* Read from a different compilation.  Overwrite the file.  */\n+      gcov_error (\"profiling:%s:overwriting an existing profile data \"\n+\t\t  \"with a different timestamp\\n\", filename);\n+      return 0;\n+    }\n \n   /* Look for program summary.  */\n   for (f_ix = 0;;)"}]}