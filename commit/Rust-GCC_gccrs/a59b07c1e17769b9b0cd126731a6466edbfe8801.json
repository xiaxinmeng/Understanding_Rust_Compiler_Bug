{"sha": "a59b07c1e17769b9b0cd126731a6466edbfe8801", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTU5YjA3YzFlMTc3NjliOWIwY2QxMjY3MzFhNjQ2NmVkYmZlODgwMQ==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2018-01-30T15:58:22Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2018-01-30T15:58:22Z"}, "message": "re PR tree-optimization/84111 (Compile time hog w/ -O2)\n\n\tPR tree-optimization/84111\n\t* tree-ssa-loop-ivcanon.c (tree_unroll_loops_completely_1): Skip\n\tinner loops added during recursion, as they don't have up-to-date\n\tSSA form.\n\n\t* gcc.c-torture/compile/pr84111.c: New test.\n\nFrom-SVN: r257188", "tree": {"sha": "b4c5d497b845046df4408d08e8f0aa3e99dbada9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b4c5d497b845046df4408d08e8f0aa3e99dbada9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a59b07c1e17769b9b0cd126731a6466edbfe8801", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a59b07c1e17769b9b0cd126731a6466edbfe8801", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a59b07c1e17769b9b0cd126731a6466edbfe8801", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a59b07c1e17769b9b0cd126731a6466edbfe8801/comments", "author": null, "committer": null, "parents": [{"sha": "9efd61f83b1bf59a4a20fe8d116ddd6bc402dd07", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9efd61f83b1bf59a4a20fe8d116ddd6bc402dd07", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9efd61f83b1bf59a4a20fe8d116ddd6bc402dd07"}], "stats": {"total": 58, "additions": 53, "deletions": 5}, "files": [{"sha": "0d2e8d53139bf5fee5676aa9b9591faba8bc0ea4", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a59b07c1e17769b9b0cd126731a6466edbfe8801/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a59b07c1e17769b9b0cd126731a6466edbfe8801/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=a59b07c1e17769b9b0cd126731a6466edbfe8801", "patch": "@@ -1,3 +1,11 @@\n+2018-01-30  Richard Biener  <rguenther@suse.de>\n+\t    Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR tree-optimization/84111\n+\t* tree-ssa-loop-ivcanon.c (tree_unroll_loops_completely_1): Skip\n+\tinner loops added during recursion, as they don't have up-to-date\n+\tSSA form.\n+\n 2018-01-30  Jan Hubicka  <hubicka@ucw.cz>\n \n \tPR ipa/81360"}, {"sha": "c348529ea9bcc1d4c1acc72423e61afb3f85659d", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a59b07c1e17769b9b0cd126731a6466edbfe8801/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a59b07c1e17769b9b0cd126731a6466edbfe8801/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=a59b07c1e17769b9b0cd126731a6466edbfe8801", "patch": "@@ -1,3 +1,8 @@\n+2018-01-30  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR tree-optimization/84111\n+\t* gcc.c-torture/compile/pr84111.c: New test.\n+\n 2018-01-30  Jan Hubicka  <hubicka@ucw.cz>\n \n \tPR ipa/83179"}, {"sha": "51f598fa2df98ef32ad66fdfdd83350b1c44bd36", "filename": "gcc/testsuite/gcc.c-torture/compile/pr84111.c", "status": "added", "additions": 31, "deletions": 0, "changes": 31, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a59b07c1e17769b9b0cd126731a6466edbfe8801/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fpr84111.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a59b07c1e17769b9b0cd126731a6466edbfe8801/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fpr84111.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fpr84111.c?ref=a59b07c1e17769b9b0cd126731a6466edbfe8801", "patch": "@@ -0,0 +1,31 @@\n+/* PR tree-optimization/84111 */\n+\n+void\n+foo (int x, int y, int z)\n+{\n+  int a = 0;\n+  int *b = &x;\n+\n+  while (a < 1)\n+    {\n+      int c = y;\n+      *b = x;\n+ lab:\n+      for (a = 0; a < 36; ++a)\n+        {\n+          *b = 0;\n+          if (x != 0)\n+            y = 0;\n+          while (c < 1)\n+\t    ;\n+        }\n+    }\n+  if (z < 33)\n+    {\n+      b = (int *) 0;\n+      ++y;\n+      ++z;\n+      if (x / *b != 0)\n+        goto lab;\n+    }\n+}"}, {"sha": "24bf60eaa49291c57d5271babdabbc1d62e89c9d", "filename": "gcc/tree-ssa-loop-ivcanon.c", "status": "modified", "additions": 9, "deletions": 5, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a59b07c1e17769b9b0cd126731a6466edbfe8801/gcc%2Ftree-ssa-loop-ivcanon.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a59b07c1e17769b9b0cd126731a6466edbfe8801/gcc%2Ftree-ssa-loop-ivcanon.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-loop-ivcanon.c?ref=a59b07c1e17769b9b0cd126731a6466edbfe8801", "patch": "@@ -1373,13 +1373,17 @@ tree_unroll_loops_completely_1 (bool may_increase_size, bool unroll_outer,\n   bool changed = false;\n   struct loop *inner;\n   enum unroll_level ul;\n+  unsigned num = number_of_loops (cfun);\n \n-  /* Process inner loops first.  */\n+  /* Process inner loops first.  Don't walk loops added by the recursive\n+     calls because SSA form is not up-to-date.  They can be handled in the\n+     next iteration.  */\n   for (inner = loop->inner; inner != NULL; inner = inner->next)\n-    changed |= tree_unroll_loops_completely_1 (may_increase_size,\n-\t\t\t\t\t       unroll_outer, father_bbs,\n-\t\t\t\t\t       inner);\n- \n+    if ((unsigned) inner->num < num)\n+      changed |= tree_unroll_loops_completely_1 (may_increase_size,\n+\t\t\t\t\t\t unroll_outer, father_bbs,\n+\t\t\t\t\t\t inner);\n+\n   /* If we changed an inner loop we cannot process outer loops in this\n      iteration because SSA form is not up-to-date.  Continue with\n      siblings of outer loops instead.  */"}]}