{"sha": "1db0418ae570eff510bb0c52cb5dbed54320d5a4", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWRiMDQxOGFlNTcwZWZmNTEwYmIwYzUyY2I1ZGJlZDU0MzIwZDVhNA==", "commit": {"author": {"name": "Gabriel Dos Reis", "email": "gdr@integrable-solutions.net", "date": "2003-05-20T06:52:11Z"}, "committer": {"name": "Gabriel Dos Reis", "email": "gdr@gcc.gnu.org", "date": "2003-05-20T06:52:11Z"}, "message": "re PR libstdc++/10689 (pow(std::complex(0),1/3) returns (nan, nan) instead of 0.)\n\n\tPR libstdc++/10689\n\t* include/std/std_complex.h (pow): Tidy\n\nFrom-SVN: r66989", "tree": {"sha": "ea744e6750ac1694c4136ebf05f2ad62dad71e22", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ea744e6750ac1694c4136ebf05f2ad62dad71e22"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1db0418ae570eff510bb0c52cb5dbed54320d5a4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1db0418ae570eff510bb0c52cb5dbed54320d5a4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1db0418ae570eff510bb0c52cb5dbed54320d5a4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1db0418ae570eff510bb0c52cb5dbed54320d5a4/comments", "author": {"login": "cxx-undef", "id": 5528103, "node_id": "MDQ6VXNlcjU1MjgxMDM=", "avatar_url": "https://avatars.githubusercontent.com/u/5528103?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cxx-undef", "html_url": "https://github.com/cxx-undef", "followers_url": "https://api.github.com/users/cxx-undef/followers", "following_url": "https://api.github.com/users/cxx-undef/following{/other_user}", "gists_url": "https://api.github.com/users/cxx-undef/gists{/gist_id}", "starred_url": "https://api.github.com/users/cxx-undef/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cxx-undef/subscriptions", "organizations_url": "https://api.github.com/users/cxx-undef/orgs", "repos_url": "https://api.github.com/users/cxx-undef/repos", "events_url": "https://api.github.com/users/cxx-undef/events{/privacy}", "received_events_url": "https://api.github.com/users/cxx-undef/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "29ad6d3f115bd906b1611092453ab48a4653d0c9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/29ad6d3f115bd906b1611092453ab48a4653d0c9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/29ad6d3f115bd906b1611092453ab48a4653d0c9"}], "stats": {"total": 33, "additions": 29, "deletions": 4}, "files": [{"sha": "6f3c11083b02a5c7aac3089ef9bfdc4091abe2c1", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1db0418ae570eff510bb0c52cb5dbed54320d5a4/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1db0418ae570eff510bb0c52cb5dbed54320d5a4/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=1db0418ae570eff510bb0c52cb5dbed54320d5a4", "patch": "@@ -1,3 +1,8 @@\n+2003-05-20  Gabriel Dos Reis <gdr@integrable-solutions.net>\n+\n+\tPR libstdc++/10689\n+\t* include/std/std_complex.h (pow): Tidy.\n+\t\n 2003-05-19  Paolo Carlini  <pcarlini@unitus.it>\n \n \t* testsuite/27_io/basic_filebuf/close/char/4.cc: New file, testing"}, {"sha": "e943f5edcee09386982854b47f674ff766ece3e4", "filename": "libstdc++-v3/include/std/std_complex.h", "status": "modified", "additions": 10, "deletions": 4, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1db0418ae570eff510bb0c52cb5dbed54320d5a4/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fstd_complex.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1db0418ae570eff510bb0c52cb5dbed54320d5a4/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fstd_complex.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fstd_complex.h?ref=1db0418ae570eff510bb0c52cb5dbed54320d5a4", "patch": "@@ -565,24 +565,30 @@ namespace std\n     }\n \n   template<typename _Tp>\n-    inline complex<_Tp>\n+    complex<_Tp>\n     pow(const complex<_Tp>& __x, const _Tp& __y)\n     {\n-      return exp(__y * log(__x));\n+      if (__x.imag() == _Tp())\n+        return pow(__x.real(), __y);\n+\n+      complex<_Tp> __t = log(__x);\n+      return polar(exp(__y * __t.real()), __y * __t.imag());\n     }\n \n   template<typename _Tp>\n     inline complex<_Tp>\n     pow(const complex<_Tp>& __x, const complex<_Tp>& __y)\n     {\n-      return exp(__y * log(__x));\n+      return __x == _Tp() ? _Tp() : exp(__y * log(__x));\n     }\n \n   template<typename _Tp>\n     inline complex<_Tp>\n     pow(const _Tp& __x, const complex<_Tp>& __y)\n     {\n-      return exp(__y * log(__x));\n+      return __x == _Tp()\n+        ? _Tp()\n+        : polar(pow(__x, __y.real()), __y.imag() * log(__x));\n     }\n \n   // 26.2.3  complex specializations"}, {"sha": "c3f8479828dcc6d40d225e967ff0d843e9d4efe7", "filename": "libstdc++-v3/testsuite/26_numerics/complex/pow.C", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1db0418ae570eff510bb0c52cb5dbed54320d5a4/libstdc%2B%2B-v3%2Ftestsuite%2F26_numerics%2Fcomplex%2Fpow.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1db0418ae570eff510bb0c52cb5dbed54320d5a4/libstdc%2B%2B-v3%2Ftestsuite%2F26_numerics%2Fcomplex%2Fpow.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F26_numerics%2Fcomplex%2Fpow.C?ref=1db0418ae570eff510bb0c52cb5dbed54320d5a4", "patch": "@@ -0,0 +1,14 @@\n+// PR libbstdc++/10689\n+// Origin: Daniel.Levine@jhuaph.edu\n+\n+#include <complex>\n+#include <testsuite_hooks.h>\n+\n+int main()\n+{\n+   std::complex<double> z(0, 1) ;\n+\n+   VERIFY(pow(z, 1.0/3.0) == 0.0);\n+\n+   return 0;\n+}"}]}