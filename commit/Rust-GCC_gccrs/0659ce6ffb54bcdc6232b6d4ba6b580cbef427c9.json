{"sha": "0659ce6ffb54bcdc6232b6d4ba6b580cbef427c9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDY1OWNlNmZmYjU0YmNkYzYyMzJiNmQ0YmE2YjU4MGNiZWY0MjdjOQ==", "commit": {"author": {"name": "James Greenhalgh", "email": "james.greenhalgh@arm.com", "date": "2013-04-29T10:17:51Z"}, "committer": {"name": "James Greenhalgh", "email": "jgreenhalgh@gcc.gnu.org", "date": "2013-04-29T10:17:51Z"}, "message": "[AArch64] Map frint intrinsics to standard pattern names directly.\n\ngcc/\n\t* config/aarch64/aarch64-builtins.c\n\t(aarch64_builtin_vectorized_function): Fold to standard pattern names.\n\t* config/aarch64/aarch64-simd-builtins.def (frintn): New.\n\t(frintz): Rename to...\n\t(btrunc): ...this.\n\t(frintp): Rename to...\n\t(ceil): ...this.\n\t(frintm): Rename to...\n\t(floor): ...this.\n\t(frinti): Rename to...\n\t(nearbyint): ...this.\n\t(frintx): Rename to...\n\t(rint): ...this.\n\t(frinta): Rename to...\n\t(round): ...this.\n\t* config/aarch64/aarch64-simd.md\n\t(aarch64_frint<frint_suffix><mode>): Delete.\n\t(<frint_pattern><mode>2): Convert to insn.\n\t* config/aarch64/aarch64.md (unspec): Add UNSPEC_FRINTN.\n\t* config/aarch64/iterators.md (FRINT): Add UNSPEC_FRINTN.\n\t(frint_pattern): Likewise.\n\t(frint_suffix): Likewise.\n\nFrom-SVN: r198394", "tree": {"sha": "6c0c8582aab543508b3368c97dad442bcd4c379d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6c0c8582aab543508b3368c97dad442bcd4c379d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0659ce6ffb54bcdc6232b6d4ba6b580cbef427c9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0659ce6ffb54bcdc6232b6d4ba6b580cbef427c9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0659ce6ffb54bcdc6232b6d4ba6b580cbef427c9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0659ce6ffb54bcdc6232b6d4ba6b580cbef427c9/comments", "author": {"login": "jgreenhalgh-arm", "id": 6104025, "node_id": "MDQ6VXNlcjYxMDQwMjU=", "avatar_url": "https://avatars.githubusercontent.com/u/6104025?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jgreenhalgh-arm", "html_url": "https://github.com/jgreenhalgh-arm", "followers_url": "https://api.github.com/users/jgreenhalgh-arm/followers", "following_url": "https://api.github.com/users/jgreenhalgh-arm/following{/other_user}", "gists_url": "https://api.github.com/users/jgreenhalgh-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/jgreenhalgh-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jgreenhalgh-arm/subscriptions", "organizations_url": "https://api.github.com/users/jgreenhalgh-arm/orgs", "repos_url": "https://api.github.com/users/jgreenhalgh-arm/repos", "events_url": "https://api.github.com/users/jgreenhalgh-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/jgreenhalgh-arm/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "ea78906a44deed40a23a5ef2362310e4d116c798", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ea78906a44deed40a23a5ef2362310e4d116c798", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ea78906a44deed40a23a5ef2362310e4d116c798"}], "stats": {"total": 73, "additions": 48, "deletions": 25}, "files": [{"sha": "ae2878240020d7787d00cfdcbb665891437388c8", "filename": "gcc/ChangeLog", "status": "modified", "additions": 25, "deletions": 0, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0659ce6ffb54bcdc6232b6d4ba6b580cbef427c9/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0659ce6ffb54bcdc6232b6d4ba6b580cbef427c9/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=0659ce6ffb54bcdc6232b6d4ba6b580cbef427c9", "patch": "@@ -1,3 +1,28 @@\n+2013-04-29  James Greenhalgh  <james.greenhalgh@arm.com>\n+\n+\t* config/aarch64/aarch64-builtins.c\n+\t(aarch64_builtin_vectorized_function): Fold to standard pattern names.\n+\t* config/aarch64/aarch64-simd-builtins.def (frintn): New.\n+\t(frintz): Rename to...\n+\t(btrunc): ...this.\n+\t(frintp): Rename to...\n+\t(ceil): ...this.\n+\t(frintm): Rename to...\n+\t(floor): ...this.\n+\t(frinti): Rename to...\n+\t(nearbyint): ...this.\n+\t(frintx): Rename to...\n+\t(rint): ...this.\n+\t(frinta): Rename to...\n+\t(round): ...this.\n+\t* config/aarch64/aarch64-simd.md\n+\t(aarch64_frint<frint_suffix><mode>): Delete.\n+\t(<frint_pattern><mode>2): Convert to insn.\n+\t* config/aarch64/aarch64.md (unspec): Add UNSPEC_FRINTN.\n+\t* config/aarch64/iterators.md (FRINT): Add UNSPEC_FRINTN.\n+\t(frint_pattern): Likewise.\n+\t(frint_suffix): Likewise.\n+\n 2013-04-29  Richard Biener  <rguenther@suse.de>\n \n \tPR tree-optimization/57081"}, {"sha": "08bfe01aa82e6674e22fd589f26b613f9be1a2e7", "filename": "gcc/config/aarch64/aarch64-builtins.c", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0659ce6ffb54bcdc6232b6d4ba6b580cbef427c9/gcc%2Fconfig%2Faarch64%2Faarch64-builtins.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0659ce6ffb54bcdc6232b6d4ba6b580cbef427c9/gcc%2Fconfig%2Faarch64%2Faarch64-builtins.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Faarch64%2Faarch64-builtins.c?ref=0659ce6ffb54bcdc6232b6d4ba6b580cbef427c9", "patch": "@@ -1224,19 +1224,19 @@ aarch64_builtin_vectorized_function (tree fndecl, tree type_out, tree type_in)\n    && in_mode == N##Fmode && in_n == C)\n \tcase BUILT_IN_FLOOR:\n \tcase BUILT_IN_FLOORF:\n-\t  return AARCH64_FIND_FRINT_VARIANT (frintm);\n+\t  return AARCH64_FIND_FRINT_VARIANT (floor);\n \tcase BUILT_IN_CEIL:\n \tcase BUILT_IN_CEILF:\n-\t  return AARCH64_FIND_FRINT_VARIANT (frintp);\n+\t  return AARCH64_FIND_FRINT_VARIANT (ceil);\n \tcase BUILT_IN_TRUNC:\n \tcase BUILT_IN_TRUNCF:\n-\t  return AARCH64_FIND_FRINT_VARIANT (frintz);\n+\t  return AARCH64_FIND_FRINT_VARIANT (btrunc);\n \tcase BUILT_IN_ROUND:\n \tcase BUILT_IN_ROUNDF:\n-\t  return AARCH64_FIND_FRINT_VARIANT (frinta);\n+\t  return AARCH64_FIND_FRINT_VARIANT (round);\n \tcase BUILT_IN_NEARBYINT:\n \tcase BUILT_IN_NEARBYINTF:\n-\t  return AARCH64_FIND_FRINT_VARIANT (frinti);\n+\t  return AARCH64_FIND_FRINT_VARIANT (nearbyint);\n \tcase BUILT_IN_SQRT:\n \tcase BUILT_IN_SQRTF:\n \t  return AARCH64_FIND_FRINT_VARIANT (sqrt);"}, {"sha": "6b414663c659ab41c398e2cd543ecad07300135e", "filename": "gcc/config/aarch64/aarch64-simd-builtins.def", "status": "modified", "additions": 8, "deletions": 7, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0659ce6ffb54bcdc6232b6d4ba6b580cbef427c9/gcc%2Fconfig%2Faarch64%2Faarch64-simd-builtins.def", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0659ce6ffb54bcdc6232b6d4ba6b580cbef427c9/gcc%2Fconfig%2Faarch64%2Faarch64-simd-builtins.def", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Faarch64%2Faarch64-simd-builtins.def?ref=0659ce6ffb54bcdc6232b6d4ba6b580cbef427c9", "patch": "@@ -247,13 +247,14 @@\n   BUILTIN_VDQ_BHSI (BINOP, umax, 3)\n   BUILTIN_VDQ_BHSI (BINOP, umin, 3)\n \n-  /* Implemented by aarch64_frint<frint_suffix><mode>.  */\n-  BUILTIN_VDQF (UNOP, frintz, 0)\n-  BUILTIN_VDQF (UNOP, frintp, 0)\n-  BUILTIN_VDQF (UNOP, frintm, 0)\n-  BUILTIN_VDQF (UNOP, frinti, 0)\n-  BUILTIN_VDQF (UNOP, frintx, 0)\n-  BUILTIN_VDQF (UNOP, frinta, 0)\n+  /* Implemented by <frint_pattern><mode>2.  */\n+  BUILTIN_VDQF (UNOP, btrunc, 2)\n+  BUILTIN_VDQF (UNOP, ceil, 2)\n+  BUILTIN_VDQF (UNOP, floor, 2)\n+  BUILTIN_VDQF (UNOP, nearbyint, 2)\n+  BUILTIN_VDQF (UNOP, rint, 2)\n+  BUILTIN_VDQF (UNOP, round, 2)\n+  BUILTIN_VDQF (UNOP, frintn, 2)\n \n   /* Implemented by aarch64_fcvt<frint_suffix><su><mode>.  */\n   BUILTIN_VDQF (UNOP, fcvtzs, 0)"}, {"sha": "5f14cc617100f9eb15df974a647e8262b1367ec2", "filename": "gcc/config/aarch64/aarch64-simd.md", "status": "modified", "additions": 3, "deletions": 10, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0659ce6ffb54bcdc6232b6d4ba6b580cbef427c9/gcc%2Fconfig%2Faarch64%2Faarch64-simd.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0659ce6ffb54bcdc6232b6d4ba6b580cbef427c9/gcc%2Fconfig%2Faarch64%2Faarch64-simd.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Faarch64%2Faarch64-simd.md?ref=0659ce6ffb54bcdc6232b6d4ba6b580cbef427c9", "patch": "@@ -1232,7 +1232,9 @@\n    (set_attr \"simd_mode\" \"<MODE>\")]\n )\n \n-(define_insn \"aarch64_frint<frint_suffix><mode>\"\n+;; Vector versions of the floating-point frint patterns.\n+;; Expands to btrunc, ceil, floor, nearbyint, rint, round.\n+(define_insn \"<frint_pattern><mode>2\"\n   [(set (match_operand:VDQF 0 \"register_operand\" \"=w\")\n \t(unspec:VDQF [(match_operand:VDQF 1 \"register_operand\" \"w\")]\n \t\t      FRINT))]\n@@ -1242,15 +1244,6 @@\n    (set_attr \"simd_mode\" \"<MODE>\")]\n )\n \n-;; Vector versions of the floating-point frint patterns.\n-;; Expands to btrunc, ceil, floor, nearbyint, rint, round.\n-(define_expand \"<frint_pattern><mode>2\"\n-  [(set (match_operand:VDQF 0 \"register_operand\")\n-\t(unspec:VDQF [(match_operand:VDQF 1 \"register_operand\")]\n-\t\t      FRINT))]\n-  \"TARGET_SIMD\"\n-  {})\n-\n (define_insn \"aarch64_fcvt<frint_suffix><su><mode>\"\n   [(set (match_operand:<FCVT_TARGET> 0 \"register_operand\" \"=w\")\n \t(FIXUORS:<FCVT_TARGET> (unspec:<FCVT_TARGET>"}, {"sha": "963c9cad52f1f72f90d8e672b940e9f602410c64", "filename": "gcc/config/aarch64/aarch64.md", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0659ce6ffb54bcdc6232b6d4ba6b580cbef427c9/gcc%2Fconfig%2Faarch64%2Faarch64.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0659ce6ffb54bcdc6232b6d4ba6b580cbef427c9/gcc%2Fconfig%2Faarch64%2Faarch64.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Faarch64%2Faarch64.md?ref=0659ce6ffb54bcdc6232b6d4ba6b580cbef427c9", "patch": "@@ -74,6 +74,7 @@\n     UNSPEC_FRINTA\n     UNSPEC_FRINTI\n     UNSPEC_FRINTM\n+    UNSPEC_FRINTN\n     UNSPEC_FRINTP\n     UNSPEC_FRINTX\n     UNSPEC_FRINTZ"}, {"sha": "a2ad8664868b3f071ad10fcddd772e7bce6f3f1a", "filename": "gcc/config/aarch64/iterators.md", "status": "modified", "additions": 6, "deletions": 3, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0659ce6ffb54bcdc6232b6d4ba6b580cbef427c9/gcc%2Fconfig%2Faarch64%2Fiterators.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0659ce6ffb54bcdc6232b6d4ba6b580cbef427c9/gcc%2Fconfig%2Faarch64%2Fiterators.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Faarch64%2Fiterators.md?ref=0659ce6ffb54bcdc6232b6d4ba6b580cbef427c9", "patch": "@@ -692,7 +692,8 @@\n \t\t\t      UNSPEC_UZP1 UNSPEC_UZP2])\n \n (define_int_iterator FRINT [UNSPEC_FRINTZ UNSPEC_FRINTP UNSPEC_FRINTM\n-\t\t\t     UNSPEC_FRINTI UNSPEC_FRINTX UNSPEC_FRINTA])\n+\t\t\t     UNSPEC_FRINTN UNSPEC_FRINTI UNSPEC_FRINTX\n+\t\t\t     UNSPEC_FRINTA])\n \n (define_int_iterator FCVT [UNSPEC_FRINTZ UNSPEC_FRINTP UNSPEC_FRINTM\n \t\t\t    UNSPEC_FRINTA])\n@@ -787,12 +788,14 @@\n \t\t\t\t(UNSPEC_FRINTM \"floor\")\n \t\t\t\t(UNSPEC_FRINTI \"nearbyint\")\n \t\t\t\t(UNSPEC_FRINTX \"rint\")\n-\t\t\t\t(UNSPEC_FRINTA \"round\")])\n+\t\t\t\t(UNSPEC_FRINTA \"round\")\n+\t\t\t\t(UNSPEC_FRINTN \"frintn\")])\n \n ;; frint suffix for floating-point rounding instructions.\n (define_int_attr frint_suffix [(UNSPEC_FRINTZ \"z\") (UNSPEC_FRINTP \"p\")\n \t\t\t       (UNSPEC_FRINTM \"m\") (UNSPEC_FRINTI \"i\")\n-\t\t\t       (UNSPEC_FRINTX \"x\") (UNSPEC_FRINTA \"a\")])\n+\t\t\t       (UNSPEC_FRINTX \"x\") (UNSPEC_FRINTA \"a\")\n+\t\t\t       (UNSPEC_FRINTN \"n\")])\n \n (define_int_attr fcvt_pattern [(UNSPEC_FRINTZ \"btrunc\") (UNSPEC_FRINTA \"round\")\n \t\t\t       (UNSPEC_FRINTP \"ceil\") (UNSPEC_FRINTM \"floor\")])"}]}