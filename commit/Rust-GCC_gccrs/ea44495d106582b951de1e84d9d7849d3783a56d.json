{"sha": "ea44495d106582b951de1e84d9d7849d3783a56d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWE0NDQ5NWQxMDY1ODJiOTUxZGUxZTg0ZDlkNzg0OWQzNzgzYTU2ZA==", "commit": {"author": {"name": "Richard Sandiford", "email": "richard.sandiford@linaro.org", "date": "2017-09-22T17:04:51Z"}, "committer": {"name": "Richard Sandiford", "email": "rsandifo@gcc.gnu.org", "date": "2017-09-22T17:04:51Z"}, "message": "PR82289: Computing peeling costs for irrelevant drs\n\nThis PR shows that we weren't filtering out irrelevant stmts in\nvect_get_peeling_costs_all_drs (unlike related loops in which\nwe iterate over all datarefs).\n\n2017-09-22  Richard Sandiford  <richard.sandiford@linaro.org>\n\ngcc/\n\tPR tree-optimization/82289\n\t* tree-vect-data-refs.c (vect_get_peeling_costs_all_drs): Check\n\tSTMT_VINFO_RELEVANT_P.\n\ngcc/testsuite/\n\tPR tree-optimization/82289\n\t* gcc.dg/vect/pr82289.c: New test.\n\nFrom-SVN: r253103", "tree": {"sha": "b076f5f5fcdbd91d3cf64c00f6c18bb983605c16", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b076f5f5fcdbd91d3cf64c00f6c18bb983605c16"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ea44495d106582b951de1e84d9d7849d3783a56d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ea44495d106582b951de1e84d9d7849d3783a56d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ea44495d106582b951de1e84d9d7849d3783a56d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ea44495d106582b951de1e84d9d7849d3783a56d/comments", "author": null, "committer": null, "parents": [{"sha": "597fdf45ede583ca1e88ce9f2923673b1238cdf8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/597fdf45ede583ca1e88ce9f2923673b1238cdf8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/597fdf45ede583ca1e88ce9f2923673b1238cdf8"}], "stats": {"total": 42, "additions": 42, "deletions": 0}, "files": [{"sha": "02a5b7eb26d42e7aa578c6c4ff5f4191c2e00b02", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ea44495d106582b951de1e84d9d7849d3783a56d/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ea44495d106582b951de1e84d9d7849d3783a56d/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=ea44495d106582b951de1e84d9d7849d3783a56d", "patch": "@@ -1,3 +1,9 @@\n+2017-09-22  Richard Sandiford  <richard.sandiford@linaro.org>\n+\n+\tPR tree-optimization/82289\n+\t* tree-vect-data-refs.c (vect_get_peeling_costs_all_drs): Check\n+\tSTMT_VINFO_RELEVANT_P.\n+\n 2017-09-22  Richard Sandiford  <richard.sandiford@linaro.org>\n \t    Alan Hayward  <alan.hayward@arm.com>\n \t    David Sherwood  <david.sherwood@arm.com>"}, {"sha": "54723c2c71ba8ff6575f33c1dc49c72112961377", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ea44495d106582b951de1e84d9d7849d3783a56d/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ea44495d106582b951de1e84d9d7849d3783a56d/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=ea44495d106582b951de1e84d9d7849d3783a56d", "patch": "@@ -1,3 +1,8 @@\n+2017-09-22  Richard Sandiford  <richard.sandiford@linaro.org>\n+\n+\tPR tree-optimization/82289\n+\t* gcc.dg/vect/pr82289.c: New test.\n+\n 2017-09-22  Richard Sandiford  <richard.sandiford@linaro.org>\n \t    Alan Hayward  <alan.hayward@arm.com>\n \t    David Sherwood  <david.sherwood@arm.com>"}, {"sha": "ae3001f306f2f69764a000090d2a4382a0b30270", "filename": "gcc/testsuite/gcc.dg/vect/pr82289.c", "status": "added", "additions": 28, "deletions": 0, "changes": 28, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ea44495d106582b951de1e84d9d7849d3783a56d/gcc%2Ftestsuite%2Fgcc.dg%2Fvect%2Fpr82289.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ea44495d106582b951de1e84d9d7849d3783a56d/gcc%2Ftestsuite%2Fgcc.dg%2Fvect%2Fpr82289.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fvect%2Fpr82289.c?ref=ea44495d106582b951de1e84d9d7849d3783a56d", "patch": "@@ -0,0 +1,28 @@\n+/* { dg-do compile } */\n+\n+int a, b, c, *d, *f[1];\n+\n+void fn1 (int *j)\n+{\n+  int e, g, h = 1;\n+  for (; e; e++)\n+    {\n+      if (g > 0)\n+        {\n+          d = j;\n+          return;\n+        }\n+      if (!h)\n+        while (g)\n+          ;\n+      while (h < 1)\n+        if (a)\n+          {\n+            fn1 (&h);\n+            h = 0;\n+          }\n+      f[e] = &c;\n+    }\n+  while (1)\n+    ;\n+}"}, {"sha": "c4314a0e2d823aa5b30d23d2133ae0161115583a", "filename": "gcc/tree-vect-data-refs.c", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ea44495d106582b951de1e84d9d7849d3783a56d/gcc%2Ftree-vect-data-refs.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ea44495d106582b951de1e84d9d7849d3783a56d/gcc%2Ftree-vect-data-refs.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-vect-data-refs.c?ref=ea44495d106582b951de1e84d9d7849d3783a56d", "patch": "@@ -1326,6 +1326,9 @@ vect_get_peeling_costs_all_drs (vec<data_reference_p> datarefs,\n     {\n       gimple *stmt = DR_STMT (dr);\n       stmt_vec_info stmt_info = vinfo_for_stmt (stmt);\n+      if (!STMT_VINFO_RELEVANT_P (stmt_info))\n+\tcontinue;\n+\n       /* For interleaving, only the alignment of the first access\n          matters.  */\n       if (STMT_VINFO_GROUPED_ACCESS (stmt_info)"}]}