{"sha": "b13547d821af5c24195fe58e040654992c589d86", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjEzNTQ3ZDgyMWFmNWMyNDE5NWZlNThlMDQwNjU0OTkyYzU4OWQ4Ng==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2017-11-22T20:49:56Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2017-11-22T20:49:56Z"}, "message": "re PR libgomp/83106 (libgomp/target.c:2671:2: error: \u2018strncat\u2019 specified bound 5 equals source length [-Werror=stringop-overflow=])\n\n\tPR libgomp/83106\n\t* target.c (gomp_target_init): Compute lengths just once and\n\tuse them in both malloc size and subsequent copying.\n\nFrom-SVN: r255080", "tree": {"sha": "8ea2827a50906a3b8399ed3ba709172ba205d005", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8ea2827a50906a3b8399ed3ba709172ba205d005"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b13547d821af5c24195fe58e040654992c589d86", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b13547d821af5c24195fe58e040654992c589d86", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b13547d821af5c24195fe58e040654992c589d86", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b13547d821af5c24195fe58e040654992c589d86/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "217e4393f7540b4f32c4eafbe3ffeceeb063eb30", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/217e4393f7540b4f32c4eafbe3ffeceeb063eb30", "html_url": "https://github.com/Rust-GCC/gccrs/commit/217e4393f7540b4f32c4eafbe3ffeceeb063eb30"}], "stats": {"total": 20, "additions": 15, "deletions": 5}, "files": [{"sha": "9999b060234ee8136b7b5c47d6cd9ea17af23d87", "filename": "libgomp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b13547d821af5c24195fe58e040654992c589d86/libgomp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b13547d821af5c24195fe58e040654992c589d86/libgomp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2FChangeLog?ref=b13547d821af5c24195fe58e040654992c589d86", "patch": "@@ -1,3 +1,9 @@\n+2017-11-22  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR libgomp/83106\n+\t* target.c (gomp_target_init): Compute lengths just once and\n+\tuse them in both malloc size and subsequent copying.\n+\n 2017-11-17  Igor Tsimbalist  <igor.v.tsimbalist@intel.com>\n \n \t* configure.ac: Set CET_FLAGS, update XCFLAGS and FCFLAGS."}, {"sha": "4c0f4fc9041ae3f3dfa5686800bc853eac732e75", "filename": "libgomp/target.c", "status": "modified", "additions": 9, "deletions": 5, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b13547d821af5c24195fe58e040654992c589d86/libgomp%2Ftarget.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b13547d821af5c24195fe58e040654992c589d86/libgomp%2Ftarget.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Ftarget.c?ref=b13547d821af5c24195fe58e040654992c589d86", "patch": "@@ -2656,20 +2656,24 @@ gomp_target_init (void)\n     do\n       {\n \tstruct gomp_device_descr current_device;\n+\tsize_t prefix_len, suffix_len, cur_len;\n \n \tnext = strchr (cur, ',');\n \n-\tplugin_name = (char *) malloc (1 + (next ? next - cur : strlen (cur))\n-\t\t\t\t       + strlen (prefix) + strlen (suffix));\n+\tprefix_len = strlen (prefix);\n+\tcur_len = next ? next - cur : strlen (cur);\n+\tsuffix_len = strlen (suffix);\n+\n+\tplugin_name = (char *) malloc (prefix_len + cur_len + suffix_len + 1);\n \tif (!plugin_name)\n \t  {\n \t    num_devices = 0;\n \t    break;\n \t  }\n \n-\tstrcpy (plugin_name, prefix);\n-\tstrncat (plugin_name, cur, next ? next - cur : strlen (cur));\n-\tstrcat (plugin_name, suffix);\n+\tmemcpy (plugin_name, prefix, prefix_len);\n+\tmemcpy (plugin_name + prefix_len, cur, cur_len);\n+\tmemcpy (plugin_name + prefix_len + cur_len, suffix, suffix_len + 1);\n \n \tif (gomp_load_plugin_for_device (&current_device, plugin_name))\n \t  {"}]}