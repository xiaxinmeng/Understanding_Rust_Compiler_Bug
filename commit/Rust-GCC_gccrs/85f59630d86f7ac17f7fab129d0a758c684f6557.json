{"sha": "85f59630d86f7ac17f7fab129d0a758c684f6557", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODVmNTk2MzBkODZmN2FjMTdmN2ZhYjEyOWQwYTc1OGM2ODRmNjU1Nw==", "commit": {"author": {"name": "Kelley Cook", "email": "kcook@gcc.gnu.org", "date": "2004-09-23T01:21:50Z"}, "committer": {"name": "R. Kelley Cook", "email": "kcook@gcc.gnu.org", "date": "2004-09-23T01:21:50Z"}, "message": "config.guess: New upstream version\n\n2004-09-23  Kelley Cook  <kcook@gcc.gnu.org>\n\n\t* config.guess: New upstream version\n\t* compile, depcomp, install-sh, ylwrap: Likewise.\n\nFrom-SVN: r87914", "tree": {"sha": "0ce5b0ac94a126a4b9e01591de64ca22f7c57216", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0ce5b0ac94a126a4b9e01591de64ca22f7c57216"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/85f59630d86f7ac17f7fab129d0a758c684f6557", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/85f59630d86f7ac17f7fab129d0a758c684f6557", "html_url": "https://github.com/Rust-GCC/gccrs/commit/85f59630d86f7ac17f7fab129d0a758c684f6557", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/85f59630d86f7ac17f7fab129d0a758c684f6557/comments", "author": null, "committer": null, "parents": [{"sha": "5b7a26f6962ead3d6f407551d73bbf5f5d645498", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5b7a26f6962ead3d6f407551d73bbf5f5d645498", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5b7a26f6962ead3d6f407551d73bbf5f5d645498"}], "stats": {"total": 573, "additions": 370, "deletions": 203}, "files": [{"sha": "4c331f7e5763b0eaec37945ecf0550b8737cc6f7", "filename": "ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/85f59630d86f7ac17f7fab129d0a758c684f6557/ChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/85f59630d86f7ac17f7fab129d0a758c684f6557/ChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/ChangeLog?ref=85f59630d86f7ac17f7fab129d0a758c684f6557", "patch": "@@ -1,3 +1,8 @@\n+2004-09-23  Kelley Cook  <kcook@gcc.gnu.org>\n+\n+\t* config.guess: New upstream version\n+\t* compile, depcomp, install-sh, ylwrap: Likewise.\n+\n 2004-09-19  Roger Sayle  <roger@eyesopen.com>\n \n \t* config/mh-x86omitfp: New host makefile fragment.  Add"}, {"sha": "80b645b015f3cbee717fd38ca22e857c8cd70830", "filename": "compile", "status": "modified", "additions": 44, "deletions": 40, "changes": 84, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/85f59630d86f7ac17f7fab129d0a758c684f6557/compile", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/85f59630d86f7ac17f7fab129d0a758c684f6557/compile", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/compile?ref=85f59630d86f7ac17f7fab129d0a758c684f6557", "patch": "@@ -1,9 +1,9 @@\n #! /bin/sh\n # Wrapper for compilers which do not understand `-c -o'.\n \n-scriptversion=2003-11-09.00\n+scriptversion=2004-09-10.20\n \n-# Copyright (C) 1999, 2000, 2003 Free Software Foundation, Inc.\n+# Copyright (C) 1999, 2000, 2003, 2004 Free Software Foundation, Inc.\n # Written by Tom Tromey <tromey@cygnus.com>.\n #\n # This program is free software; you can redistribute it and/or modify\n@@ -55,37 +55,41 @@ EOF\n     ;;\n esac\n \n-\n-prog=$1\n-shift\n-\n ofile=\n cfile=\n-args=\n-while test $# -gt 0; do\n-  case \"$1\" in\n-    -o)\n-      # configure might choose to run compile as `compile cc -o foo foo.c'.\n-      # So we do something ugly here.\n-      ofile=$2\n-      shift\n-      case \"$ofile\" in\n-\t*.o | *.obj)\n-\t  ;;\n-\t*)\n-\t  args=\"$args -o $ofile\"\n-\t  ofile=\n-\t  ;;\n-      esac\n-       ;;\n-    *.c)\n-      cfile=$1\n-      args=\"$args $1\"\n-      ;;\n-    *)\n-      args=\"$args $1\"\n-      ;;\n-  esac\n+eat=\n+\n+for arg\n+do\n+  if test -n \"$eat\"; then\n+    eat=\n+  else\n+    case $1 in\n+      -o)\n+\t# configure might choose to run compile as `compile cc -o foo foo.c'.\n+\t# So we strip `-o arg' only if arg is an object.\n+\teat=1\n+\tcase $2 in\n+\t  *.o | *.obj)\n+\t    ofile=$2\n+\t    ;;\n+\t  *)\n+\t    set x \"$@\" -o \"$2\"\n+\t    shift\n+\t    ;;\n+\tesac\n+\t;;\n+      *.c)\n+\tcfile=$1\n+\tset x \"$@\" \"$1\"\n+\tshift\n+\t;;\n+      *)\n+\tset x \"$@\" \"$1\"\n+\tshift\n+\t;;\n+    esac\n+  fi\n   shift\n done\n \n@@ -95,36 +99,36 @@ if test -z \"$ofile\" || test -z \"$cfile\"; then\n   # normal compilation that the losing compiler can handle.  If no\n   # `.c' file was seen then we are probably linking.  That is also\n   # ok.\n-  exec \"$prog\" $args\n+  exec \"$@\"\n fi\n \n # Name of file we expect compiler to create.\n-cofile=`echo $cfile | sed -e 's|^.*/||' -e 's/\\.c$/.o/'`\n+cofile=`echo \"$cfile\" | sed -e 's|^.*/||' -e 's/\\.c$/.o/'`\n \n # Create the lock directory.\n # Note: use `[/.-]' here to ensure that we don't use the same name\n # that we are using for the .o file.  Also, base the name on the expected\n # object file name, since that is what matters with a parallel build.\n-lockdir=`echo $cofile | sed -e 's|[/.-]|_|g'`.d\n+lockdir=`echo \"$cofile\" | sed -e 's|[/.-]|_|g'`.d\n while true; do\n-  if mkdir $lockdir > /dev/null 2>&1; then\n+  if mkdir \"$lockdir\" >/dev/null 2>&1; then\n     break\n   fi\n   sleep 1\n done\n # FIXME: race condition here if user kills between mkdir and trap.\n-trap \"rmdir $lockdir; exit 1\" 1 2 15\n+trap \"rmdir '$lockdir'; exit 1\" 1 2 15\n \n # Run the compile.\n-\"$prog\" $args\n-status=$?\n+\"$@\"\n+ret=$?\n \n if test -f \"$cofile\"; then\n   mv \"$cofile\" \"$ofile\"\n fi\n \n-rmdir $lockdir\n-exit $status\n+rmdir \"$lockdir\"\n+exit $ret\n \n # Local Variables:\n # mode: shell-script"}, {"sha": "7d0185e019ed6b83bca92431ff478d7e19b0037e", "filename": "config.guess", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/85f59630d86f7ac17f7fab129d0a758c684f6557/config.guess", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/85f59630d86f7ac17f7fab129d0a758c684f6557/config.guess", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/config.guess?ref=85f59630d86f7ac17f7fab129d0a758c684f6557", "patch": "@@ -3,7 +3,7 @@\n #   Copyright (C) 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999,\n #   2000, 2001, 2002, 2003, 2004 Free Software Foundation, Inc.\n \n-timestamp='2004-08-29'\n+timestamp='2004-09-07'\n \n # This file is free software; you can redistribute it and/or modify it\n # under the terms of the GNU General Public License as published by\n@@ -827,6 +827,9 @@ EOF\n     crisv32:Linux:*:*)\n \techo crisv32-axis-linux-gnu\n \texit 0 ;;\n+    frv:Linux:*:*)\n+    \techo frv-unknown-linux-gnu\n+\texit 0 ;;\n     ia64:Linux:*:*)\n \techo ${UNAME_MACHINE}-unknown-linux-gnu\n \texit 0 ;;"}, {"sha": "11e2d3bfe1cffc0cfc75109ac2ab67c6fbb26feb", "filename": "depcomp", "status": "modified", "additions": 77, "deletions": 27, "changes": 104, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/85f59630d86f7ac17f7fab129d0a758c684f6557/depcomp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/85f59630d86f7ac17f7fab129d0a758c684f6557/depcomp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/depcomp?ref=85f59630d86f7ac17f7fab129d0a758c684f6557", "patch": "@@ -1,7 +1,9 @@\n #! /bin/sh\n-\n # depcomp - compile a program generating dependencies as side-effects\n-# Copyright 1999, 2000 Free Software Foundation, Inc.\n+\n+scriptversion=2004-05-31.23\n+\n+# Copyright (C) 1999, 2000, 2003, 2004 Free Software Foundation, Inc.\n \n # This program is free software; you can redistribute it and/or modify\n # it under the terms of the GNU General Public License as published by\n@@ -25,22 +27,45 @@\n \n # Originally written by Alexandre Oliva <oliva@dcc.unicamp.br>.\n \n+case $1 in\n+  '')\n+     echo \"$0: No command.  Try \\`$0 --help' for more information.\" 1>&2\n+     exit 1;\n+     ;;\n+  -h | --h*)\n+    cat <<\\EOF\n+Usage: depcomp [--help] [--version] PROGRAM [ARGS]\n+\n+Run PROGRAMS ARGS to compile a file, generating dependencies\n+as side-effects.\n+\n+Environment variables:\n+  depmode     Dependency tracking mode.\n+  source      Source file read by `PROGRAMS ARGS'.\n+  object      Object file output by `PROGRAMS ARGS'.\n+  DEPDIR      directory where to store dependencies.\n+  depfile     Dependency file to output.\n+  tmpdepfile  Temporary file to use when outputing dependencies.\n+  libtool     Whether libtool is used (yes/no).\n+\n+Report bugs to <bug-automake@gnu.org>.\n+EOF\n+    exit 0\n+    ;;\n+  -v | --v*)\n+    echo \"depcomp $scriptversion\"\n+    exit 0\n+    ;;\n+esac\n+\n if test -z \"$depmode\" || test -z \"$source\" || test -z \"$object\"; then\n   echo \"depcomp: Variables source, object and depmode must be set\" 1>&2\n   exit 1\n fi\n-# `libtool' can also be set to `yes' or `no'.\n-\n-if test -z \"$depfile\"; then\n-   base=`echo \"$object\" | sed -e 's,^.*/,,' -e 's,\\.\\([^.]*\\)$,.P\\1,'`\n-   dir=`echo \"$object\" | sed 's,/.*$,/,'`\n-   if test \"$dir\" = \"$object\"; then\n-      dir=\n-   fi\n-   # FIXME: should be _deps on DOS.\n-   depfile=\"$dir.deps/$base\"\n-fi\n \n+# Dependencies for sub/bar.o or sub/bar.obj go into sub/.deps/bar.Po.\n+depfile=${depfile-`echo \"$object\" |\n+  sed 's|[^\\\\/]*$|'${DEPDIR-.deps}'/&|;s|\\.\\([^.]*\\)$|.P\\1|;s|Pobj$|Po|'`}\n tmpdepfile=${tmpdepfile-`echo \"$depfile\" | sed 's/\\.\\([^.]*\\)$/.T\\1/'`}\n \n rm -f \"$tmpdepfile\"\n@@ -172,26 +197,33 @@ sgi)\n \n aix)\n   # The C for AIX Compiler uses -M and outputs the dependencies\n-  # in a .u file.  This file always lives in the current directory.\n-  # Also, the AIX compiler puts `$object:' at the start of each line;\n-  # $object doesn't have directory information.\n-  stripped=`echo \"$object\" | sed -e 's,^.*/,,' -e 's/\\(.*\\)\\..*$/\\1/'`\n+  # in a .u file.  In older versions, this file always lives in the\n+  # current directory.  Also, the AIX compiler puts `$object:' at the\n+  # start of each line; $object doesn't have directory information.\n+  # Version 6 uses the directory in both cases.\n+  stripped=`echo \"$object\" | sed 's/\\(.*\\)\\..*$/\\1/'`\n   tmpdepfile=\"$stripped.u\"\n-  outname=\"$stripped.o\"\n   if test \"$libtool\" = yes; then\n     \"$@\" -Wc,-M\n   else\n     \"$@\" -M\n   fi\n-\n   stat=$?\n+\n+  if test -f \"$tmpdepfile\"; then :\n+  else\n+    stripped=`echo \"$stripped\" | sed 's,^.*/,,'`\n+    tmpdepfile=\"$stripped.u\"\n+  fi\n+\n   if test $stat -eq 0; then :\n   else\n     rm -f \"$tmpdepfile\"\n     exit $stat\n   fi\n \n   if test -f \"$tmpdepfile\"; then\n+    outname=\"$stripped.o\"\n     # Each line is of the form `foo.o: dependent.h'.\n     # Do two passes, one to just change these to\n     # `$object: dependent.h' and one to simply `dependent.h:'.\n@@ -255,31 +287,40 @@ tru64)\n    base=`echo \"$object\" | sed -e 's|^.*/||' -e 's/\\.o$//' -e 's/\\.lo$//'`\n \n    if test \"$libtool\" = yes; then\n+      # Dependencies are output in .lo.d with libtool 1.4.\n+      # With libtool 1.5 they are output both in $dir.libs/$base.o.d\n+      # and in $dir.libs/$base.o.d and $dir$base.o.d.  We process the\n+      # latter, because the former will be cleaned when $dir.libs is\n+      # erased.\n       tmpdepfile1=\"$dir.libs/$base.lo.d\"\n-      tmpdepfile2=\"$dir.libs/$base.d\"\n+      tmpdepfile2=\"$dir$base.o.d\"\n+      tmpdepfile3=\"$dir.libs/$base.d\"\n       \"$@\" -Wc,-MD\n    else\n       tmpdepfile1=\"$dir$base.o.d\"\n       tmpdepfile2=\"$dir$base.d\"\n+      tmpdepfile3=\"$dir$base.d\"\n       \"$@\" -MD\n    fi\n \n    stat=$?\n    if test $stat -eq 0; then :\n    else\n-      rm -f \"$tmpdepfile1\" \"$tmpdepfile2\"\n+      rm -f \"$tmpdepfile1\" \"$tmpdepfile2\" \"$tmpdepfile3\"\n       exit $stat\n    fi\n \n    if test -f \"$tmpdepfile1\"; then\n       tmpdepfile=\"$tmpdepfile1\"\n-   else\n+   elif test -f \"$tmpdepfile2\"; then\n       tmpdepfile=\"$tmpdepfile2\"\n+   else\n+      tmpdepfile=\"$tmpdepfile3\"\n    fi\n    if test -f \"$tmpdepfile\"; then\n       sed -e \"s,^.*\\.[a-z]*:,$object:,\" < \"$tmpdepfile\" > \"$depfile\"\n-      # That's a space and a tab in the [].\n-      sed -e 's,^.*\\.[a-z]*:[ \t]*,,' -e 's,$,:,' < \"$tmpdepfile\" >> \"$depfile\"\n+      # That's a tab and a space in the [].\n+      sed -e 's,^.*\\.[a-z]*:[\t ]*,,' -e 's,$,:,' < \"$tmpdepfile\" >> \"$depfile\"\n    else\n       echo \"#dummy\" > \"$depfile\"\n    fi\n@@ -292,7 +333,7 @@ tru64)\n \n dashmstdout)\n   # Important note: in order to support this mode, a compiler *must*\n-  # always write the proprocessed file to stdout, regardless of -o.\n+  # always write the preprocessed file to stdout, regardless of -o.\n   \"$@\" || exit $?\n \n   # Remove the call to Libtool.\n@@ -388,7 +429,7 @@ makedepend)\n \n cpp)\n   # Important note: in order to support this mode, a compiler *must*\n-  # always write the proprocessed file to stdout.\n+  # always write the preprocessed file to stdout.\n   \"$@\" || exit $?\n \n   # Remove the call to Libtool.\n@@ -430,7 +471,7 @@ cpp)\n \n msvisualcpp)\n   # Important note: in order to support this mode, a compiler *must*\n-  # always write the proprocessed file to stdout, regardless of -o,\n+  # always write the preprocessed file to stdout, regardless of -o,\n   # because we must use -o when running libtool.\n   \"$@\" || exit $?\n   IFS=\" \"\n@@ -470,3 +511,12 @@ none)\n esac\n \n exit 0\n+\n+# Local Variables:\n+# mode: shell-script\n+# sh-indentation: 2\n+# eval: (add-hook 'write-file-hooks 'time-stamp)\n+# time-stamp-start: \"scriptversion=\"\n+# time-stamp-format: \"%:y-%02m-%02d.%02H\"\n+# time-stamp-end: \"$\"\n+# End:"}, {"sha": "dd97db7aa1cae9655149aad9d21c6cf42476c0da", "filename": "install-sh", "status": "modified", "additions": 70, "deletions": 64, "changes": 134, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/85f59630d86f7ac17f7fab129d0a758c684f6557/install-sh", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/85f59630d86f7ac17f7fab129d0a758c684f6557/install-sh", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/install-sh?ref=85f59630d86f7ac17f7fab129d0a758c684f6557", "patch": "@@ -1,7 +1,7 @@\n #!/bin/sh\n # install - install a program, script, or datafile\n \n-scriptversion=2004-02-15.20\n+scriptversion=2004-09-10.20\n \n # This originates from X11R5 (mit/util/scripts/install.sh), which was\n # later released in X11R6 (xc/config/util/install.sh) with the\n@@ -58,9 +58,6 @@ stripprog=\"${STRIPPROG-strip}\"\n rmprog=\"${RMPROG-rm}\"\n mkdirprog=\"${MKDIRPROG-mkdir}\"\n \n-transformbasename=\n-transform_arg=\n-instcmd=\"$mvprog\"\n chmodcmd=\"$chmodprog 0755\"\n chowncmd=\n chgrpcmd=\n@@ -70,23 +67,27 @@ mvcmd=\"$mvprog\"\n src=\n dst=\n dir_arg=\n+dstarg=\n+no_target_directory=\n \n-usage=\"Usage: $0 [OPTION]... SRCFILE DSTFILE\n+usage=\"Usage: $0 [OPTION]... [-T] SRCFILE DSTFILE\n    or: $0 [OPTION]... SRCFILES... DIRECTORY\n-   or: $0 -d DIRECTORIES...\n+   or: $0 [OPTION]... -t DIRECTORY SRCFILES...\n+   or: $0 [OPTION]... -d DIRECTORIES...\n \n-In the first form, install SRCFILE to DSTFILE, removing SRCFILE by default.\n-In the second, create the directory path DIR.\n+In the 1st form, copy SRCFILE to DSTFILE.\n+In the 2nd and 3rd, copy all SRCFILES to DIRECTORY.\n+In the 4th, create DIRECTORIES.\n \n Options:\n--b=TRANSFORMBASENAME\n--c         copy source (using $cpprog) instead of moving (using $mvprog).\n+-c         (ignored)\n -d         create directories instead of installing files.\n--g GROUP   $chgrp installed files to GROUP.\n--m MODE    $chmod installed files to MODE.\n--o USER    $chown installed files to USER.\n--s         strip installed files (using $stripprog).\n--t=TRANSFORM\n+-g GROUP   $chgrpprog installed files to GROUP.\n+-m MODE    $chmodprog installed files to MODE.\n+-o USER    $chownprog installed files to USER.\n+-s         $stripprog installed files.\n+-t DIRECTORY  install into DIRECTORY.\n+-T         report an error if DSTFILE is a directory.\n --help     display this help and exit.\n --version  display version info and exit.\n \n@@ -96,12 +97,7 @@ Environment variables override the default commands:\n \n while test -n \"$1\"; do\n   case $1 in\n-    -b=*) transformbasename=`echo $1 | sed 's/-b=//'`\n-        shift\n-        continue;;\n-\n-    -c) instcmd=$cpprog\n-        shift\n+    -c) shift\n         continue;;\n \n     -d) dir_arg=true\n@@ -129,14 +125,20 @@ while test -n \"$1\"; do\n         shift\n         continue;;\n \n-    -t=*) transformarg=`echo $1 | sed 's/-t=//'`\n-        shift\n-        continue;;\n+    -t) dstarg=$2\n+\tshift\n+\tshift\n+\tcontinue;;\n+\n+    -T) no_target_directory=true\n+\tshift\n+\tcontinue;;\n \n     --version) echo \"$0 $scriptversion\"; exit 0;;\n \n     *)  # When -d is used, all remaining arguments are directories to create.\n-\ttest -n \"$dir_arg\" && break\n+\t# When -t is used, the destination is already specified.\n+\ttest -n \"$dir_arg$dstarg\" && break\n         # Otherwise, the last argument is the destination.  Remove it from $@.\n \tfor arg\n \tdo\n@@ -174,13 +176,13 @@ do\n     src=\n \n     if test -d \"$dst\"; then\n-      instcmd=:\n+      mkdircmd=:\n       chmodcmd=\n     else\n-      instcmd=$mkdirprog\n+      mkdircmd=$mkdirprog\n     fi\n   else\n-    # Waiting for this to be detected by the \"$instcmd $src $dsttmp\" command\n+    # Waiting for this to be detected by the \"$cpprog $src $dsttmp\" command\n     # might cause directories to be created, which would be especially bad\n     # if $src (and thus $dsttmp) contains '*'.\n     if test ! -f \"$src\" && test ! -d \"$src\"; then\n@@ -202,6 +204,10 @@ do\n     # If destination is a directory, append the input filename; won't work\n     # if double slashes aren't ignored.\n     if test -d \"$dst\"; then\n+      if test -n \"$no_target_directory\"; then\n+\techo \"$0: $dstarg: Is a directory\" >&2\n+\texit 1\n+      fi\n       dst=$dst/`basename \"$src\"`\n     fi\n   fi\n@@ -229,77 +235,77 @@ do\n       pathcomp=$pathcomp$1\n       shift\n       if test ! -d \"$pathcomp\"; then\n-        $mkdirprog \"$pathcomp\" || lasterr=$?\n+        $mkdirprog \"$pathcomp\"\n \t# mkdir can fail with a `File exist' error in case several\n \t# install-sh are creating the directory concurrently.  This\n \t# is OK.\n-\ttest ! -d \"$pathcomp\" && { (exit ${lasterr-1}); exit; }\n+\ttest -d \"$pathcomp\" || exit\n       fi\n       pathcomp=$pathcomp/\n     done\n   fi\n \n   if test -n \"$dir_arg\"; then\n-    $doit $instcmd \"$dst\" \\\n+    $doit $mkdircmd \"$dst\" \\\n       && { test -z \"$chowncmd\" || $doit $chowncmd \"$dst\"; } \\\n       && { test -z \"$chgrpcmd\" || $doit $chgrpcmd \"$dst\"; } \\\n       && { test -z \"$stripcmd\" || $doit $stripcmd \"$dst\"; } \\\n       && { test -z \"$chmodcmd\" || $doit $chmodcmd \"$dst\"; }\n \n   else\n-    # If we're going to rename the final executable, determine the name now.\n-    if test -z \"$transformarg\"; then\n-      dstfile=`basename \"$dst\"`\n-    else\n-      dstfile=`basename \"$dst\" $transformbasename \\\n-               | sed $transformarg`$transformbasename\n-    fi\n-\n-    # don't allow the sed command to completely eliminate the filename.\n-    test -z \"$dstfile\" && dstfile=`basename \"$dst\"`\n+    dstfile=`basename \"$dst\"`\n \n     # Make a couple of temp file names in the proper directory.\n     dsttmp=$dstdir/_inst.$$_\n     rmtmp=$dstdir/_rm.$$_\n \n     # Trap to clean up those temp files at exit.\n-    trap 'status=$?; rm -f \"$dsttmp\" \"$rmtmp\" && exit $status' 0\n+    trap 'ret=$?; rm -f \"$dsttmp\" \"$rmtmp\" && exit $ret' 0\n     trap '(exit $?); exit' 1 2 13 15\n \n-    # Move or copy the file name to the temp name\n-    $doit $instcmd \"$src\" \"$dsttmp\" &&\n+    # Copy the file name to the temp name.\n+    $doit $cpprog \"$src\" \"$dsttmp\" &&\n \n     # and set any options; do chmod last to preserve setuid bits.\n     #\n     # If any of these fail, we abort the whole thing.  If we want to\n     # ignore errors from any of these, just make sure not to ignore\n-    # errors from the above \"$doit $instcmd $src $dsttmp\" command.\n+    # errors from the above \"$doit $cpprog $src $dsttmp\" command.\n     #\n     { test -z \"$chowncmd\" || $doit $chowncmd \"$dsttmp\"; } \\\n       && { test -z \"$chgrpcmd\" || $doit $chgrpcmd \"$dsttmp\"; } \\\n       && { test -z \"$stripcmd\" || $doit $stripcmd \"$dsttmp\"; } \\\n       && { test -z \"$chmodcmd\" || $doit $chmodcmd \"$dsttmp\"; } &&\n \n-    # Now remove or move aside any old file at destination location.  We\n-    # try this two ways since rm can't unlink itself on some systems and\n-    # the destination file might be busy for other reasons.  In this case,\n-    # the final cleanup might fail but the new file should still install\n-    # successfully.\n-    {\n-      if test -f \"$dstdir/$dstfile\"; then\n-        $doit $rmcmd -f \"$dstdir/$dstfile\" 2>/dev/null \\\n-        || $doit $mvcmd -f \"$dstdir/$dstfile\" \"$rmtmp\" 2>/dev/null \\\n-        || {\n-\t  echo \"$0: cannot unlink or rename $dstdir/$dstfile\" >&2\n-\t  (exit 1); exit\n-        }\n-      else\n-        :\n-      fi\n-    } &&\n-\n     # Now rename the file to the real destination.\n-    $doit $mvcmd \"$dsttmp\" \"$dstdir/$dstfile\"\n+    { $doit $mvcmd -f \"$dsttmp\" \"$dstdir/$dstfile\" 2>/dev/null \\\n+      || {\n+\t   # The rename failed, perhaps because mv can't rename something else\n+\t   # to itself, or perhaps because mv is so ancient that it does not\n+\t   # support -f.\n+\n+\t   # Now remove or move aside any old file at destination location.\n+\t   # We try this two ways since rm can't unlink itself on some\n+\t   # systems and the destination file might be busy for other\n+\t   # reasons.  In this case, the final cleanup might fail but the new\n+\t   # file should still install successfully.\n+\t   {\n+\t     if test -f \"$dstdir/$dstfile\"; then\n+\t       $doit $rmcmd -f \"$dstdir/$dstfile\" 2>/dev/null \\\n+\t       || $doit $mvcmd -f \"$dstdir/$dstfile\" \"$rmtmp\" 2>/dev/null \\\n+\t       || {\n+\t\t echo \"$0: cannot unlink or rename $dstdir/$dstfile\" >&2\n+\t\t (exit 1); exit\n+\t       }\n+\t     else\n+\t       :\n+\t     fi\n+\t   } &&\n+\n+\t   # Now rename the file to the real destination.\n+\t   $doit $mvcmd \"$dsttmp\" \"$dstdir/$dstfile\"\n+\t }\n+    }\n   fi || { (exit 1); exit; }\n done\n "}, {"sha": "e66a95b603fad3fba1924914158cac45ee3c8a00", "filename": "ylwrap", "status": "modified", "additions": 170, "deletions": 71, "changes": 241, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/85f59630d86f7ac17f7fab129d0a758c684f6557/ylwrap", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/85f59630d86f7ac17f7fab129d0a758c684f6557/ylwrap", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/ylwrap?ref=85f59630d86f7ac17f7fab129d0a758c684f6557", "patch": "@@ -1,6 +1,11 @@\n #! /bin/sh\n # ylwrap - wrapper for lex/yacc invocations.\n-# Copyright (C) 1996, 1997 Free Software Foundation, Inc.\n+\n+scriptversion=2004-09-10.20\n+\n+# Copyright (C) 1996, 1997, 1998, 1999, 2001, 2002, 2003, 2004\n+#   Free Software Foundation, Inc.\n+#\n # Written by Tom Tromey <tromey@cygnus.com>.\n #\n # This program is free software; you can redistribute it and/or modify\n@@ -17,107 +22,201 @@\n # along with this program; if not, write to the Free Software\n # Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.\n \n-# Usage:\n-#     ylwrap PROGRAM INPUT [OUTPUT DESIRED]... -- [ARGS]...\n-# * PROGRAM is program to run.\n-# * INPUT is the input file\n-# * OUTPUT is file PROG generates\n-# * DESIRED is file we actually want\n-# * ARGS are passed to PROG\n-# Any number of OUTPUT,DESIRED pairs may be used.\n+# As a special exception to the GNU General Public License, if you\n+# distribute this file as part of a program that contains a\n+# configuration script generated by Autoconf, you may include it under\n+# the same distribution terms that you use for the rest of that program.\n \n-# The program to run.\n-prog=\"$1\"\n-shift\n-# Make any relative path in $prog absolute.\n-case \"$prog\" in\n- /* | [A-Za-z]:\\\\*) ;;\n- */*) prog=\"`pwd`/$prog\" ;;\n+# This file is maintained in Automake, please report\n+# bugs to <bug-automake@gnu.org> or send patches to\n+# <automake-patches@gnu.org>.\n+\n+case \"$1\" in\n+  '')\n+    echo \"$0: No files given.  Try \\`$0 --help' for more information.\" 1>&2\n+    exit 1\n+    ;;\n+  --basedir)\n+    basedir=$2\n+    shift 2\n+    ;;\n+  -h|--h*)\n+    cat <<\\EOF\n+Usage: ylwrap [--help|--version] INPUT [OUTPUT DESIRED]... -- PROGRAM [ARGS]...\n+\n+Wrapper for lex/yacc invocations, renaming files as desired.\n+\n+  INPUT is the input file\n+  OUTPUT is one file PROG generates\n+  DESIRED is the file we actually want instead of OUTPUT\n+  PROGRAM is program to run\n+  ARGS are passed to PROG\n+\n+Any number of OUTPUT,DESIRED pairs may be used.\n+\n+Report bugs to <bug-automake@gnu.org>.\n+EOF\n+    exit 0\n+    ;;\n+  -v|--v*)\n+    echo \"ylwrap $scriptversion\"\n+    exit 0\n+    ;;\n esac\n \n+\n # The input.\n input=\"$1\"\n shift\n case \"$input\" in\n- /* | [A-Za-z]:\\\\*)\n+  [\\\\/]* | ?:[\\\\/]*)\n     # Absolute path; do nothing.\n     ;;\n- *)\n-    # Relative path.  Make it absolute.  Why?  Because otherwise any\n-    # debugging info in the generated file will point to the wrong\n-    # place.  This is really gross.\n+  *)\n+    # Relative path.  Make it absolute.\n     input=\"`pwd`/$input\"\n     ;;\n esac\n \n-# We don't want to use the absolute path if the input in the current\n-# directory like when making a tar ball.\n-input_base=`echo $input | sed -e 's|.*/||'`\n-if test -f $input_base && cmp $input_base $input >/dev/null 2>&1; then\n-  input=$input_base\n-fi\n-\n pairlist=\n while test \"$#\" -ne 0; do\n-   if test \"$1\" = \"--\"; then\n-      shift\n-      break\n-   fi\n-   pairlist=\"$pairlist $1\"\n-   shift\n+  if test \"$1\" = \"--\"; then\n+    shift\n+    break\n+  fi\n+  pairlist=\"$pairlist $1\"\n+  shift\n done\n \n+# The program to run.\n+prog=\"$1\"\n+shift\n+# Make any relative path in $prog absolute.\n+case \"$prog\" in\n+  [\\\\/]* | ?:[\\\\/]*) ;;\n+  *[\\\\/]*) prog=\"`pwd`/$prog\" ;;\n+esac\n+\n # FIXME: add hostname here for parallel makes that run commands on\n # other machines.  But that might take us over the 14-char limit.\n dirname=ylwrap$$\n trap \"cd `pwd`; rm -rf $dirname > /dev/null 2>&1\" 1 2 3 15\n mkdir $dirname || exit 1\n \n cd $dirname\n-case \"$input\" in\n- /* | [A-Za-z]:\\\\*)\n-    # Absolute path; do nothing.\n-    ;;\n- *)\n-    # Make a symbolic link, hard link or hardcopy.\n-    ln -s ../\"$input\" . > /dev/null 2>&1 || ln ../\"$input\" . > /dev/null 2>&1 || cp ../\"$input\" .\n-    ;;\n+\n+case $# in\n+  0) $prog \"$input\" ;;\n+  *) $prog \"$@\" \"$input\" ;;\n esac\n-$prog ${1+\"$@\"} \"$input\"\n-status=$?\n-\n-if test $status -eq 0; then\n-   set X $pairlist\n-   shift\n-   first=yes\n-   while test \"$#\" -ne 0; do\n-      if test -f \"$1\"; then\n-         # If $2 is an absolute path name, then just use that,\n-         # otherwise prepend `../'.\n-         case \"$2\" in\n-\t   /* | [A-Za-z]:\\\\*) target=\"$2\";;\n-\t   *) target=\"../$2\";;\n-\t esac\n-\t mv \"$1\" \"$target\" || status=$?\n+ret=$?\n+\n+if test $ret -eq 0; then\n+  set X $pairlist\n+  shift\n+  first=yes\n+  # Since DOS filename conventions don't allow two dots,\n+  # the DOS version of Bison writes out y_tab.c instead of y.tab.c\n+  # and y_tab.h instead of y.tab.h. Test to see if this is the case.\n+  y_tab_nodot=\"no\"\n+  if test -f y_tab.c || test -f y_tab.h; then\n+    y_tab_nodot=\"yes\"\n+  fi\n+\n+  # The directory holding the input.\n+  input_dir=`echo \"$input\" | sed -e 's,\\([\\\\/]\\)[^\\\\/]*$,\\1,'`\n+  # Quote $INPUT_DIR so we can use it in a regexp.\n+  # FIXME: really we should care about more than `.' and `\\'.\n+  input_rx=`echo \"$input_dir\" | sed 's,\\\\\\\\,\\\\\\\\\\\\\\\\,g;s,\\\\.,\\\\\\\\.,g'`\n+\n+  while test \"$#\" -ne 0; do\n+    from=\"$1\"\n+    # Handle y_tab.c and y_tab.h output by DOS\n+    if test $y_tab_nodot = \"yes\"; then\n+      if test $from = \"y.tab.c\"; then\n+    \tfrom=\"y_tab.c\"\n       else\n-\t # A missing file is only an error for the first file.  This\n-\t # is a blatant hack to let us support using \"yacc -d\".  If -d\n-\t # is not specified, we don't want an error when the header\n-\t # file is \"missing\".\n-\t if test $first = yes; then\n-\t    status=1\n-\t fi\n+    \tif test $from = \"y.tab.h\"; then\n+    \t  from=\"y_tab.h\"\n+    \tfi\n+      fi\n+    fi\n+    if test -f \"$from\"; then\n+      # If $2 is an absolute path name, then just use that,\n+      # otherwise prepend `../'.\n+      case \"$2\" in\n+    \t[\\\\/]* | ?:[\\\\/]*) target=\"$2\";;\n+    \t*) target=\"../$2\";;\n+      esac\n+\n+      # We do not want to overwrite a header file if it hasn't\n+      # changed.  This avoid useless recompilations.  However the\n+      # parser itself (the first file) should always be updated,\n+      # because it is the destination of the .y.c rule in the\n+      # Makefile.  Divert the output of all other files to a temporary\n+      # file so we can compare them to existing versions.\n+      if test $first = no; then\n+\trealtarget=\"$target\"\n+\ttarget=\"tmp-`echo $target | sed s/.*[\\\\/]//g`\"\n       fi\n-      shift\n-      shift\n-      first=no\n-   done\n+      # Edit out `#line' or `#' directives.\n+      #\n+      # We don't want the resulting debug information to point at\n+      # an absolute srcdir; it is better for it to just mention the\n+      # .y file with no path.\n+      #\n+      # We want to use the real output file name, not yy.lex.c for\n+      # instance.\n+      #\n+      # We want the include guards to be adjusted too.\n+      FROM=`echo \"$from\" | sed \\\n+            -e 'y/abcdefghijklmnopqrstuvwxyz/ABCDEFGHIJKLMNOPQRSTUVWXYZ/'\\\n+            -e 's/[^ABCDEFGHIJKLMNOPQRSTUVWXYZ]/_/g'`\n+      TARGET=`echo \"$2\" | sed \\\n+            -e 'y/abcdefghijklmnopqrstuvwxyz/ABCDEFGHIJKLMNOPQRSTUVWXYZ/'\\\n+            -e 's/[^ABCDEFGHIJKLMNOPQRSTUVWXYZ]/_/g'`\n+\n+      sed -e \"/^#/!b\" -e \"s,$input_rx,,\" -e \"s,$from,$2,\" \\\n+          -e \"s,$FROM,$TARGET,\" \"$from\" >\"$target\" || ret=$?\n+\n+      # Check whether header files must be updated.\n+      if test $first = no; then\n+\tif test -f \"$realtarget\" && cmp -s \"$realtarget\" \"$target\"; then\n+\t  echo \"$2\" is unchanged\n+\t  rm -f \"$target\"\n+\telse\n+          echo updating \"$2\"\n+          mv -f \"$target\" \"$realtarget\"\n+        fi\n+      fi\n+    else\n+      # A missing file is only an error for the first file.  This\n+      # is a blatant hack to let us support using \"yacc -d\".  If -d\n+      # is not specified, we don't want an error when the header\n+      # file is \"missing\".\n+      if test $first = yes; then\n+        ret=1\n+      fi\n+    fi\n+    shift\n+    shift\n+    first=no\n+  done\n else\n-   status=$?\n+  ret=$?\n fi\n \n # Remove the directory.\n cd ..\n rm -rf $dirname\n \n-exit $status\n+exit $ret\n+\n+# Local Variables:\n+# mode: shell-script\n+# sh-indentation: 2\n+# eval: (add-hook 'write-file-hooks 'time-stamp)\n+# time-stamp-start: \"scriptversion=\"\n+# time-stamp-format: \"%:y-%02m-%02d.%02H\"\n+# time-stamp-end: \"$\"\n+# End:"}]}