{"sha": "5fdbceff85d56d29b79bb5746930e6d7af861c65", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NWZkYmNlZmY4NWQ1NmQyOWI3OWJiNTc0NjkzMGU2ZDdhZjg2MWM2NQ==", "commit": {"author": {"name": "Paolo Carlini", "email": "paolo.carlini@oracle.com", "date": "2013-03-06T23:47:20Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2013-03-06T23:47:20Z"}, "message": "re PR c++/56534 (ICE Segfault on invalid code in check_elaborated_type_specifier)\n\n/cp\n2013-03-06  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/56534\n\t* parser.c (cp_parser_elaborated_type_specifier): Don't call\n\tcheck_elaborated_type_specifier when TREE_CODE (decl) != TYPE_DECL.\n\t* decl.c (check_elaborated_type_specifier): Tidy.\n\n/testsuite\n2013-03-06  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/56534\n\t* g++.dg/template/crash115.C: New.\n\nFrom-SVN: r196513", "tree": {"sha": "0c8a0ee97b630221c3b32fa66c872104b84b5292", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0c8a0ee97b630221c3b32fa66c872104b84b5292"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5fdbceff85d56d29b79bb5746930e6d7af861c65", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5fdbceff85d56d29b79bb5746930e6d7af861c65", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5fdbceff85d56d29b79bb5746930e6d7af861c65", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5fdbceff85d56d29b79bb5746930e6d7af861c65/comments", "author": null, "committer": null, "parents": [{"sha": "01a454df84558c04c49d5f4e31c55cd4267df2bc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/01a454df84558c04c49d5f4e31c55cd4267df2bc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/01a454df84558c04c49d5f4e31c55cd4267df2bc"}], "stats": {"total": 28, "additions": 21, "deletions": 7}, "files": [{"sha": "49e0f51bdec708016c31217dc975e3142e1013c0", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5fdbceff85d56d29b79bb5746930e6d7af861c65/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5fdbceff85d56d29b79bb5746930e6d7af861c65/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=5fdbceff85d56d29b79bb5746930e6d7af861c65", "patch": "@@ -1,3 +1,10 @@\n+2013-03-06  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/56534\n+\t* parser.c (cp_parser_elaborated_type_specifier): Don't call\n+\tcheck_elaborated_type_specifier when TREE_CODE (decl) != TYPE_DECL.\n+\t* decl.c (check_elaborated_type_specifier): Tidy.\n+\n 2013-03-06  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR c++/56543"}, {"sha": "150e8662a5e28ba192aafaf6fb2fcec213135d6a", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5fdbceff85d56d29b79bb5746930e6d7af861c65/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5fdbceff85d56d29b79bb5746930e6d7af861c65/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=5fdbceff85d56d29b79bb5746930e6d7af861c65", "patch": "@@ -11712,9 +11712,6 @@ check_elaborated_type_specifier (enum tag_types tag_code,\n {\n   tree type;\n \n-  if (decl == error_mark_node)\n-    return error_mark_node;\n-\n   /* In the case of:\n \n        struct S { struct S *p; };"}, {"sha": "ff4faa32d3c79d6538566cc5f4cc7b9c730c1b3d", "filename": "gcc/cp/parser.c", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5fdbceff85d56d29b79bb5746930e6d7af861c65/gcc%2Fcp%2Fparser.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5fdbceff85d56d29b79bb5746930e6d7af861c65/gcc%2Fcp%2Fparser.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fparser.c?ref=5fdbceff85d56d29b79bb5746930e6d7af861c65", "patch": "@@ -14248,12 +14248,14 @@ cp_parser_elaborated_type_specifier (cp_parser* parser,\n \t\t\t\t   typename_type,\n \t\t\t\t   /*complain=*/tf_error);\n       /* If the `typename' keyword is in effect and DECL is not a type\n-\t decl. Then type is non existant.   */\n+\t decl, then type is non existent.   */\n       else if (tag_type == typename_type && TREE_CODE (decl) != TYPE_DECL)\n-        type = NULL_TREE; \n-      else \n-\ttype = check_elaborated_type_specifier (tag_type, decl,\n+        ; \n+      else if (TREE_CODE (decl) == TYPE_DECL)\n+        type = check_elaborated_type_specifier (tag_type, decl,\n \t\t\t\t\t\t/*allow_template_p=*/true);\n+      else if (decl == error_mark_node)\n+\ttype = error_mark_node; \n     }\n \n   if (!type)"}, {"sha": "1979d3247268545027d4afcf40b967abe9a616a2", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5fdbceff85d56d29b79bb5746930e6d7af861c65/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5fdbceff85d56d29b79bb5746930e6d7af861c65/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=5fdbceff85d56d29b79bb5746930e6d7af861c65", "patch": "@@ -1,3 +1,8 @@\n+2013-03-06  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/56534\n+\t* g++.dg/template/crash115.C: New.\n+\n 2013-03-06  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR tree-optimization/56539"}, {"sha": "5c9f525cd64704e751ceddb0ba952b1d4dbcb4ba", "filename": "gcc/testsuite/g++.dg/template/crash115.C", "status": "added", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5fdbceff85d56d29b79bb5746930e6d7af861c65/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fcrash115.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5fdbceff85d56d29b79bb5746930e6d7af861c65/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fcrash115.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fcrash115.C?ref=5fdbceff85d56d29b79bb5746930e6d7af861c65", "patch": "@@ -0,0 +1,3 @@\n+// PR c++/56534\n+\n+template < struct template rebind < > // { dg-error \"expected\" }"}]}