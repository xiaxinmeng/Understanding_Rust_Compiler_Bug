{"sha": "c0f645750c9a137136860fdf91a76b92b847263f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzBmNjQ1NzUwYzlhMTM3MTM2ODYwZmRmOTFhNzZiOTJiODQ3MjYzZg==", "commit": {"author": {"name": "Uros Bizjak", "email": "ubizjak@gmail.com", "date": "2009-01-07T21:56:32Z"}, "committer": {"name": "Uros Bizjak", "email": "uros@gcc.gnu.org", "date": "2009-01-07T21:56:32Z"}, "message": "re PR target/38706 (../../../../src/libstdc++-v3/src/strstream.cc:419: internal compiler error: Segmentation fault)\n\n\tPR target/38706\n\t* config/alpha/alpha.c (alpha_end_function): For TARGET_ABI_OSF, call\n\tfree_after_compilation when outputting a thunk.\n\t(alpha_output_mi_thunk_osf): Assert that we are processing a thunk.\n\tDo not call free_after_compilation here.\n\ntestsuite/ChangeLog:\n\n\tPR target/38706\n\t* g++.dg/other/pr38706.C: New test.\n\nFrom-SVN: r143167", "tree": {"sha": "c3b1ef3c45c9ca0c20d5f73c60e16b7cd471ee81", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c3b1ef3c45c9ca0c20d5f73c60e16b7cd471ee81"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c0f645750c9a137136860fdf91a76b92b847263f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c0f645750c9a137136860fdf91a76b92b847263f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c0f645750c9a137136860fdf91a76b92b847263f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c0f645750c9a137136860fdf91a76b92b847263f/comments", "author": {"login": "ubizjak", "id": 55479990, "node_id": "MDQ6VXNlcjU1NDc5OTkw", "avatar_url": "https://avatars.githubusercontent.com/u/55479990?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ubizjak", "html_url": "https://github.com/ubizjak", "followers_url": "https://api.github.com/users/ubizjak/followers", "following_url": "https://api.github.com/users/ubizjak/following{/other_user}", "gists_url": "https://api.github.com/users/ubizjak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ubizjak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ubizjak/subscriptions", "organizations_url": "https://api.github.com/users/ubizjak/orgs", "repos_url": "https://api.github.com/users/ubizjak/repos", "events_url": "https://api.github.com/users/ubizjak/events{/privacy}", "received_events_url": "https://api.github.com/users/ubizjak/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "ffaf1e05dd024cc57a21cea23722e0e37e5d8ebb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ffaf1e05dd024cc57a21cea23722e0e37e5d8ebb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ffaf1e05dd024cc57a21cea23722e0e37e5d8ebb"}], "stats": {"total": 44, "additions": 41, "deletions": 3}, "files": [{"sha": "92ffefea476b778be814efb3820cdc0d6db9bea2", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0f645750c9a137136860fdf91a76b92b847263f/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0f645750c9a137136860fdf91a76b92b847263f/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=c0f645750c9a137136860fdf91a76b92b847263f", "patch": "@@ -1,7 +1,14 @@\n+2009-01-07  Uros Bizjak  <ubizjak@gmail.com>\n+\n+\tPR target/38706\n+\t* config/alpha/alpha.c (alpha_end_function): For TARGET_ABI_OSF, call\n+\tfree_after_compilation when outputting a thunk.\n+\t(alpha_output_mi_thunk_osf): Assert that we are processing a thunk.\n+\tDo not call free_after_compilation here.\n+\n 2009-01-07  Uros Bizjak  <ubizjak@gmail.com>\n \n \t* config/i386/i386.c (ix86_target_string): Use ARRAY_SIZE.\n-\t(ix86_target_string): Ditto.\n \t(ix86_valid_target_attribute_inner_p): Ditto.\n \n 2009-01-07  Jan Sjodin  <jan.sjodin@amd.com>"}, {"sha": "9c79f8883fc52f5a40d4d597b1916bf6000054d2", "filename": "gcc/config/alpha/alpha.c", "status": "modified", "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0f645750c9a137136860fdf91a76b92b847263f/gcc%2Fconfig%2Falpha%2Falpha.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0f645750c9a137136860fdf91a76b92b847263f/gcc%2Fconfig%2Falpha%2Falpha.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Falpha%2Falpha.c?ref=c0f645750c9a137136860fdf91a76b92b847263f", "patch": "@@ -1,6 +1,7 @@\n /* Subroutines used for code generation on the DEC Alpha.\n    Copyright (C) 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001,\n-   2002, 2003, 2004, 2005, 2006, 2007, 2008 Free Software Foundation, Inc.\n+   2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009\n+   Free Software Foundation, Inc.\n    Contributed by Richard Kenner (kenner@vlsi1.ultra.nyu.edu)\n \n This file is part of GCC.\n@@ -8272,6 +8273,11 @@ alpha_end_function (FILE *file, const char *fnname, tree decl ATTRIBUTE_UNUSED)\n   if (GET_CODE (insn) == CALL_INSN)\n     output_asm_insn (get_insn_template (CODE_FOR_nop, NULL), NULL);\n \n+#if TARGET_ABI_OSF\n+  if (crtl->is_thunk)\n+    free_after_compilation (cfun);\n+#endif\n+\n #if TARGET_ABI_OPEN_VMS\n   alpha_write_linkage (file, fnname, decl);\n #endif\n@@ -8311,6 +8317,8 @@ alpha_output_mi_thunk_osf (FILE *file, tree thunk_fndecl ATTRIBUTE_UNUSED,\n   HOST_WIDE_INT hi, lo;\n   rtx this_rtx, insn, funexp;\n \n+  gcc_assert (crtl->is_thunk);\n+\n   /* We always require a valid GP.  */\n   emit_insn (gen_prologue_ldgp ());\n   emit_note (NOTE_INSN_PROLOGUE_END);\n@@ -8392,7 +8400,6 @@ alpha_output_mi_thunk_osf (FILE *file, tree thunk_fndecl ATTRIBUTE_UNUSED,\n   final_start_function (insn, file, 1);\n   final (insn, file, 1);\n   final_end_function ();\n-  free_after_compilation (cfun);\n }\n #endif /* TARGET_ABI_OSF */\n \f"}, {"sha": "e0fb09524d236da9cb0c07265c6b67bb06201d4c", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0f645750c9a137136860fdf91a76b92b847263f/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0f645750c9a137136860fdf91a76b92b847263f/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=c0f645750c9a137136860fdf91a76b92b847263f", "patch": "@@ -1,3 +1,8 @@\n+2009-01-07  Uros Bizjak  <ubizjak@gmail.com>\n+\n+\tPR target/38706\n+\t* g++.dg/other/pr38706.C: New test.\n+\n 2009-01-07  Jason Merrill  <jason@redhat.com>\n \n \t* g++.dg/cpp0x/variadic92.C: New test."}, {"sha": "ec10d90ba6951c2d2015d2572fe5774147224c49", "filename": "gcc/testsuite/g++.dg/other/pr38706.C", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0f645750c9a137136860fdf91a76b92b847263f/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fpr38706.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0f645750c9a137136860fdf91a76b92b847263f/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fpr38706.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fpr38706.C?ref=c0f645750c9a137136860fdf91a76b92b847263f", "patch": "@@ -0,0 +1,19 @@\n+// PR target/38706\n+// { dg-do compile }\n+// { dg-options \"-O2\" }\n+\n+class ios_base\n+{\n+public:\n+  virtual ~ios_base ();\n+\n+};\n+\n+class istrstream:virtual public ios_base\n+{\n+public:\n+  virtual ~istrstream ();\n+\n+};\n+\n+istrstream::~istrstream () {}"}]}