{"sha": "de59bd27dc73cf020973905b969171455d6e4bf2", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZGU1OWJkMjdkYzczY2YwMjA5NzM5MDViOTY5MTcxNDU1ZDZlNGJmMg==", "commit": {"author": {"name": "Paolo Carlini", "email": "pcarlini@unitus.it", "date": "2003-02-18T23:26:32Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2003-02-18T23:26:32Z"}, "message": "std_sstream.h (str()): the size of the current string may be different from the initial one whenever...\n\n2003-02-18  Paolo Carlini  <pcarlini@unitus.it>\n\n\t* include/std/std_sstream.h (str()): the size of the\n\tcurrent string may be different from the initial one\n\twhenever _M_out_end > _M_out_beg.\n\t* testsuite/27_io/stringbuf_members.cc (test07): Add.\n\nFrom-SVN: r63066", "tree": {"sha": "31433e473479468cebb7c703dca648eaaf19825c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/31433e473479468cebb7c703dca648eaaf19825c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/de59bd27dc73cf020973905b969171455d6e4bf2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/de59bd27dc73cf020973905b969171455d6e4bf2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/de59bd27dc73cf020973905b969171455d6e4bf2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/de59bd27dc73cf020973905b969171455d6e4bf2/comments", "author": null, "committer": null, "parents": [{"sha": "fcc11c35b7a9806514c40d3fdf329c8dff44efaf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fcc11c35b7a9806514c40d3fdf329c8dff44efaf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fcc11c35b7a9806514c40d3fdf329c8dff44efaf"}], "stats": {"total": 38, "additions": 36, "deletions": 2}, "files": [{"sha": "7860617c0123cfe67bab4d95e1d0d0dbcaa53243", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/de59bd27dc73cf020973905b969171455d6e4bf2/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/de59bd27dc73cf020973905b969171455d6e4bf2/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=de59bd27dc73cf020973905b969171455d6e4bf2", "patch": "@@ -1,3 +1,10 @@\n+2003-02-18  Paolo Carlini  <pcarlini@unitus.it>\n+\n+\t* include/std/std_sstream.h (str()): the size of the\n+\tcurrent string may be different from the initial one\n+\twhenever _M_out_end > _M_out_beg.\n+\t* testsuite/27_io/stringbuf_members.cc (test07): Add.\n+\n 2003-02-18  Paolo Carlini  <pcarlini@unitus.it>\n \n \tPR libstdc++/9582"}, {"sha": "268478f3339bc547763767b39d7294dc8041147b", "filename": "libstdc++-v3/include/std/std_sstream.h", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/de59bd27dc73cf020973905b969171455d6e4bf2/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fstd_sstream.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/de59bd27dc73cf020973905b969171455d6e4bf2/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fstd_sstream.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fstd_sstream.h?ref=de59bd27dc73cf020973905b969171455d6e4bf2", "patch": "@@ -140,7 +140,7 @@ namespace std\n \t    // _M_string, and may not be the correct size of the\n \t    // current stringbuf internal buffer.\n \t    __size_type __len = _M_string.size();\n-\t    if (this->_M_out_cur > this->_M_out_beg)\n+\t    if (this->_M_out_end > this->_M_out_beg)\n \t      __len = std::max(__size_type(this->_M_out_end \n \t\t\t\t\t   - this->_M_out_beg), __len);\n \t    return __string_type(this->_M_out_beg, this->_M_out_beg + __len);"}, {"sha": "5e4933018908365d039640204ce7ee7816d340b6", "filename": "libstdc++-v3/testsuite/27_io/stringbuf_members.cc", "status": "modified", "additions": 28, "deletions": 1, "changes": 29, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/de59bd27dc73cf020973905b969171455d6e4bf2/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Fstringbuf_members.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/de59bd27dc73cf020973905b969171455d6e4bf2/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Fstringbuf_members.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Fstringbuf_members.cc?ref=de59bd27dc73cf020973905b969171455d6e4bf2", "patch": "@@ -1,6 +1,6 @@\n // 981208 bkoz test functionality of basic_stringbuf for char_type == char\n \n-// Copyright (C) 1997, 1998, 1999, 2000, 2001, 2002\n+// Copyright (C) 1997, 1998, 1999, 2000, 2001, 2002, 2003\n // Free Software Foundation, Inc.\n //\n // This file is part of the GNU ISO C++ Library.  This library is free\n@@ -473,6 +473,32 @@ bool test06()\n   return test;\n }\n \n+// http://gcc.gnu.org/ml/libstdc++/2003-02/msg00269.html\n+// Growing and then seeking to ios_base::beg triggered a bug in str(),\n+// which didn't notice the grow.\n+bool test07()\n+{\n+  bool test = true;\n+\n+  std::stringbuf strb_01;\n+  strb_01.sputc('s');\n+  strb_01.pubseekoff(0, std::ios_base::beg);\n+  VERIFY( strb_01.str() == \"s\" );\n+\n+  std::string str(\"strivi,\");\n+  std::stringbuf strb_02(str);\n+  strb_02.pubseekoff(0, std::ios_base::end);\n+  strb_02.sputn(\" no better!\", 11);\n+  strb_02.pubseekoff(0, std::ios_base::beg);\n+  VERIFY( strb_02.str() == \"strivi, no better!\" );\n+\n+#ifdef DEBUG_ASSERT\n+  assert(test);\n+#endif\n+\n+  return test;\n+}\n+\n int main()\n {\n   test01();\n@@ -481,6 +507,7 @@ int main()\n   test04();\n   test05();\n   test06();\n+  test07();\n \n   return 0;\n }"}]}