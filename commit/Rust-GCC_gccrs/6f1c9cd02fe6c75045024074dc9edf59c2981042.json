{"sha": "6f1c9cd02fe6c75045024074dc9edf59c2981042", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NmYxYzljZDAyZmU2Yzc1MDQ1MDI0MDc0ZGM5ZWRmNTljMjk4MTA0Mg==", "commit": {"author": {"name": "Sebastian Pop", "email": "sebpop@gmail.com", "date": "2007-06-21T17:06:05Z"}, "committer": {"name": "Sebastian Pop", "email": "spop@gcc.gnu.org", "date": "2007-06-21T17:06:05Z"}, "message": "re PR tree-optimization/19590 (IVs with the same evolution not eliminated)\n\n\tPR tree-optimization/19590\n\t* tree-vrp.c (adjust_range_with_scev): Set the range when the result\n\tof scev is a constant.\n\t* gcc/testsuite/gcc.dg/tree-ssa/pr19590.c: New.\n\nFrom-SVN: r125925", "tree": {"sha": "414e7e5e598d92016ed799bc6cc85640717125a5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/414e7e5e598d92016ed799bc6cc85640717125a5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6f1c9cd02fe6c75045024074dc9edf59c2981042", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6f1c9cd02fe6c75045024074dc9edf59c2981042", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6f1c9cd02fe6c75045024074dc9edf59c2981042", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6f1c9cd02fe6c75045024074dc9edf59c2981042/comments", "author": {"login": "sebpop", "id": 568397, "node_id": "MDQ6VXNlcjU2ODM5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/568397?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sebpop", "html_url": "https://github.com/sebpop", "followers_url": "https://api.github.com/users/sebpop/followers", "following_url": "https://api.github.com/users/sebpop/following{/other_user}", "gists_url": "https://api.github.com/users/sebpop/gists{/gist_id}", "starred_url": "https://api.github.com/users/sebpop/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sebpop/subscriptions", "organizations_url": "https://api.github.com/users/sebpop/orgs", "repos_url": "https://api.github.com/users/sebpop/repos", "events_url": "https://api.github.com/users/sebpop/events{/privacy}", "received_events_url": "https://api.github.com/users/sebpop/received_events", "type": "User", "site_admin": false}, "committer": {"login": "sebpop", "id": 568397, "node_id": "MDQ6VXNlcjU2ODM5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/568397?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sebpop", "html_url": "https://github.com/sebpop", "followers_url": "https://api.github.com/users/sebpop/followers", "following_url": "https://api.github.com/users/sebpop/following{/other_user}", "gists_url": "https://api.github.com/users/sebpop/gists{/gist_id}", "starred_url": "https://api.github.com/users/sebpop/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sebpop/subscriptions", "organizations_url": "https://api.github.com/users/sebpop/orgs", "repos_url": "https://api.github.com/users/sebpop/repos", "events_url": "https://api.github.com/users/sebpop/events{/privacy}", "received_events_url": "https://api.github.com/users/sebpop/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e44e043cb31d2cbac67dde6e529fd0fd804f384c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e44e043cb31d2cbac67dde6e529fd0fd804f384c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e44e043cb31d2cbac67dde6e529fd0fd804f384c"}], "stats": {"total": 52, "additions": 52, "deletions": 0}, "files": [{"sha": "17997e9309b4fef9c79e3f1439611f110d8ca335", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6f1c9cd02fe6c75045024074dc9edf59c2981042/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6f1c9cd02fe6c75045024074dc9edf59c2981042/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=6f1c9cd02fe6c75045024074dc9edf59c2981042", "patch": "@@ -1,3 +1,10 @@\n+2007-06-21  Sebastian Pop  <sebpop@gmail.com>\n+\n+\tPR tree-optimization/19590\n+\t* tree-vrp.c (adjust_range_with_scev): Set the range when the result\n+\tof scev is a constant.\n+\t* gcc/testsuite/gcc.dg/tree-ssa/pr19590.c: New.\n+\n 2007-06-21  Kenneth Zadeck <zadeck@naturalbridge.com>\n \n         * df-problems.c (df_note_bb_compute): Made computation of live"}, {"sha": "1be1119dac0b3d1d46c0b1d7a51dddbaa8d0ec1e", "filename": "gcc/testsuite/gcc.dg/tree-ssa/pr19590.c", "status": "added", "additions": 37, "deletions": 0, "changes": 37, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6f1c9cd02fe6c75045024074dc9edf59c2981042/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fpr19590.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6f1c9cd02fe6c75045024074dc9edf59c2981042/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fpr19590.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fpr19590.c?ref=6f1c9cd02fe6c75045024074dc9edf59c2981042", "patch": "@@ -0,0 +1,37 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -fdump-tree-ivopts\" } */\n+\n+void vnum_test8(int *data) \n+{ \n+  int i; \n+  int stop = data[3]; \n+  int m = data[4]; \n+  int n = m; \n+  for (i=1; i<stop; i++) { \n+    int k = data[2]; \n+    data[k] = 2; \n+    data[0] = m - n; \n+    k = data[1]; \n+    m = m + k; \n+    n = n + k; \n+  } \n+} \n+\n+/* Using the SCEV analysis, this loop should be transformed to:\n+\n+   | void vnum_result8(int *data) \n+   |{ \n+   |  int i; \n+   |  int stop = data[3]; \n+   |  for (i=1; i<stop; i++) { \n+   |    int k = data[2]; \n+   |    data[k] = 2; \n+   |    data[0] = 0; \n+   |  } \n+   |}\n+\n+*/\n+\n+/* { dg-final { scan-tree-dump-times \"= 0;\" 1 \"ivopts\"} } */\n+/* { dg-final { scan-tree-dump-times \"= 2;\" 1 \"ivopts\"} } */\n+/* { dg-final { cleanup-tree-dump \"ivopts\" } }  */"}, {"sha": "06931f1f74d8cec0f7a42c9629f6aae97e89198b", "filename": "gcc/tree-vrp.c", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6f1c9cd02fe6c75045024074dc9edf59c2981042/gcc%2Ftree-vrp.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6f1c9cd02fe6c75045024074dc9edf59c2981042/gcc%2Ftree-vrp.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-vrp.c?ref=6f1c9cd02fe6c75045024074dc9edf59c2981042", "patch": "@@ -2638,6 +2638,14 @@ adjust_range_with_scev (value_range_t *vr, struct loop *loop, tree stmt,\n     return;\n \n   chrec = instantiate_parameters (loop, analyze_scalar_evolution (loop, var));\n+\n+  /* Like in PR19590, scev can return a constant function.  */\n+  if (is_gimple_min_invariant (chrec))\n+    {\n+      set_value_range (vr, VR_RANGE, chrec, chrec, vr->equiv);\n+      return;\n+    }\n+\n   if (TREE_CODE (chrec) != POLYNOMIAL_CHREC)\n     return;\n "}]}