{"sha": "7c7688c76a78e3f65ffe82dfbc32975700d54392", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2M3Njg4Yzc2YTc4ZTNmNjVmZmU4MmRmYmMzMjk3NTcwMGQ1NDM5Mg==", "commit": {"author": {"name": "Brent Verner", "email": "brent@rcfile.org", "date": "2000-10-06T07:12:32Z"}, "committer": {"name": "Benjamin Kosnik", "email": "bkoz@gcc.gnu.org", "date": "2000-10-06T07:12:32Z"}, "message": "istream.tcc: Removed test for _M_gcount < in_avail()...\n\n\n\n2000-10-05  Brent Verner  <brent@rcfile.org>\n\n        * bits/istream.tcc [basic_istream::get(basic_streambuf&)]: Removed\n\ttest for _M_gcount < in_avail(), as in_avail() only reports info\n\tfor current buffer, causing method to return at end of buffer.\n\t* testsuite/27_io/istream_unformatted.cc [test07()]: New test.\n\t* testsuite/27_io/istream_unformatted-3.txt: New file.\n\t* testsuite/27_io/istream_unformatted-3.tst: New file.\n\nFrom-SVN: r36752", "tree": {"sha": "ece36af1dbd3a89b2d2aff500fbf18dc45ecc247", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ece36af1dbd3a89b2d2aff500fbf18dc45ecc247"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7c7688c76a78e3f65ffe82dfbc32975700d54392", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7c7688c76a78e3f65ffe82dfbc32975700d54392", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7c7688c76a78e3f65ffe82dfbc32975700d54392", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7c7688c76a78e3f65ffe82dfbc32975700d54392/comments", "author": null, "committer": null, "parents": [{"sha": "3a1ed6a1d1b6271763b131731f2d19463bfbe813", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3a1ed6a1d1b6271763b131731f2d19463bfbe813", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3a1ed6a1d1b6271763b131731f2d19463bfbe813"}], "stats": {"total": 31, "additions": 26, "deletions": 5}, "files": [{"sha": "1c42630b5ebc9e89fcae628950f47b80314fe4bb", "filename": "libstdc++-v3/include/bits/istream.tcc", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7c7688c76a78e3f65ffe82dfbc32975700d54392/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fistream.tcc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7c7688c76a78e3f65ffe82dfbc32975700d54392/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fistream.tcc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fistream.tcc?ref=7c7688c76a78e3f65ffe82dfbc32975700d54392", "patch": "@@ -588,11 +588,10 @@ namespace std {\n \t    bool __testdelim = __c == __idelim;\n \t    bool __testeof =  __c == __eof;\n \t    bool __testput = true;\n-\t    streamsize __n = __this_sb->in_avail();\n \n-\t    while (_M_gcount <= __n && !__testeof && !__testdelim \n+\t    while (!__testeof && !__testdelim \n \t\t   && (__testput = __sb.sputc(traits_type::to_char_type(__c)) \n-\t\t                   != __eof))\n+\t\t       != __eof))\n \t      {\n \t\t++_M_gcount;\n \t\t__c = __this_sb->sbumpc();"}, {"sha": "d34e5784b85b99bed92472faa077bb98db20fce9", "filename": "libstdc++-v3/testsuite/27_io/istream_unformatted.cc", "status": "modified", "additions": 24, "deletions": 2, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7c7688c76a78e3f65ffe82dfbc32975700d54392/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Fistream_unformatted.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7c7688c76a78e3f65ffe82dfbc32975700d54392/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Fistream_unformatted.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Fistream_unformatted.cc?ref=7c7688c76a78e3f65ffe82dfbc32975700d54392", "patch": "@@ -452,7 +452,28 @@ test06()\n   return 0;\n }\n \n-\n+// bug reported by bgarcia@laurelnetworks.com\n+// http://sources.redhat.com/ml/libstdc++-prs/2000-q3/msg00041.html\n+int\n+test07()\n+{\n+  const char* tfn = \"testsuite/istream_unformatted-3.txt\";\n+  std::ifstream infile;\n+  infile.open(tfn);\n+  VERIFY( infile );\n+  while (infile)\n+    {\n+      std::string line;\n+      std::ostringstream line_ss;\n+      while (infile.peek() == '\\n')\n+\tinfile.get();\n+      infile.get(*(line_ss.rdbuf()));\n+      line = line_ss.str();\n+      VERIFY( line == \"1234567890\" || line == \"\" );\n+    }\n+  return 0;\n+}\n+ \n int \n main()\n {\n@@ -462,7 +483,8 @@ main()\n   test04();\n   test05();\n   test06();\n-  \n+  test07();\n+\n   return 0;\n }\n "}]}