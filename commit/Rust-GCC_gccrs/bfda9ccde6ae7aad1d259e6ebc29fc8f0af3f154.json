{"sha": "bfda9ccde6ae7aad1d259e6ebc29fc8f0af3f154", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmZkYTljY2RlNmFlN2FhZDFkMjU5ZTZlYmMyOWZjOGYwYWYzZjE1NA==", "commit": {"author": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2017-04-25T09:25:55Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2017-04-25T09:25:55Z"}, "message": "Code clean ups.\n\nFrom-SVN: r247158", "tree": {"sha": "620d0169e185f5c58d7e2fb05ea77b9573cb7c52", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/620d0169e185f5c58d7e2fb05ea77b9573cb7c52"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bfda9ccde6ae7aad1d259e6ebc29fc8f0af3f154", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bfda9ccde6ae7aad1d259e6ebc29fc8f0af3f154", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bfda9ccde6ae7aad1d259e6ebc29fc8f0af3f154", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bfda9ccde6ae7aad1d259e6ebc29fc8f0af3f154/comments", "author": null, "committer": null, "parents": [{"sha": "ded462b0dea5615ac36e1256caffa5f2c7f5f1b8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ded462b0dea5615ac36e1256caffa5f2c7f5f1b8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ded462b0dea5615ac36e1256caffa5f2c7f5f1b8"}], "stats": {"total": 29, "additions": 25, "deletions": 4}, "files": [{"sha": "eb6443b8d56d977368fc43d55b8ea0737c7f2d96", "filename": "gcc/ada/contracts.adb", "status": "modified", "additions": 25, "deletions": 4, "changes": 29, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bfda9ccde6ae7aad1d259e6ebc29fc8f0af3f154/gcc%2Fada%2Fcontracts.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bfda9ccde6ae7aad1d259e6ebc29fc8f0af3f154/gcc%2Fada%2Fcontracts.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fcontracts.adb?ref=bfda9ccde6ae7aad1d259e6ebc29fc8f0af3f154", "patch": "@@ -2025,12 +2025,33 @@ package body Contracts is\n                   return False;\n \n                --  Determine whether the subprogram is declared in the visible\n-               --  declarations of the package containing the type.\n+               --  declarations of the package containing the type, or in the\n+               --  visible declaration of a child unit of that package.\n \n                else\n-                  return List_Containing (Subp_Decl) =\n-                    Visible_Declarations\n-                      (Specification (Unit_Declaration_Node (Scope (Typ))));\n+                  declare\n+                     Decls      : constant List_Id   :=\n+                                    List_Containing (Subp_Decl);\n+                     Subp_Scope : constant Entity_Id :=\n+                                    Scope (Defining_Entity (Subp_Decl));\n+                     Typ_Scope  : constant Entity_Id := Scope (Typ);\n+\n+                  begin\n+                     return\n+                       Decls = Visible_Declarations\n+                           (Specification (Unit_Declaration_Node (Typ_Scope)))\n+\n+                         or else\n+                           (Ekind (Subp_Scope) = E_Package\n+                             and then Typ_Scope /= Subp_Scope\n+                             and then Is_Child_Unit (Subp_Scope)\n+                             and then\n+                               Is_Ancestor_Package (Typ_Scope, Subp_Scope)\n+                             and then\n+                               Decls = Visible_Declarations\n+                                 (Specification\n+                                   (Unit_Declaration_Node (Subp_Scope))));\n+                  end;\n                end if;\n             end Has_Public_Visibility_Of_Subprogram;\n "}]}