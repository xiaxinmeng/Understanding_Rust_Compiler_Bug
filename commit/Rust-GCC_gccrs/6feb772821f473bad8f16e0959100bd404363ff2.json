{"sha": "6feb772821f473bad8f16e0959100bd404363ff2", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NmZlYjc3MjgyMWY0NzNiYWQ4ZjE2ZTA5NTkxMDBiZDQwNDM2M2ZmMg==", "commit": {"author": {"name": "Zack Weinberg", "email": "zack@wolery.cumb.org", "date": "2000-03-13T00:10:13Z"}, "committer": {"name": "Zack Weinberg", "email": "zack@gcc.gnu.org", "date": "2000-03-13T00:10:13Z"}, "message": "cpphash.c: Don't include version.h.\n\n \t* cpphash.c: Don't include version.h.\n\t(special_symbol) [case T_VERSION]: Look for the string in\n\thp->value.cpval; don't use version_string.\n\t* cppinit.c (initialize_builtins): Set hp->value.cpval for\n\t__VERSION__ to version_string.\n\t* Makefile.in (cpphash.o): Update deps.\n\nFrom-SVN: r32499", "tree": {"sha": "8e461958ce7225c47f8f03c091b7a7d2ef297653", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8e461958ce7225c47f8f03c091b7a7d2ef297653"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6feb772821f473bad8f16e0959100bd404363ff2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6feb772821f473bad8f16e0959100bd404363ff2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6feb772821f473bad8f16e0959100bd404363ff2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6feb772821f473bad8f16e0959100bd404363ff2/comments", "author": null, "committer": null, "parents": [{"sha": "d35364d13e14ba0eea541a77484c716f1cf82195", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d35364d13e14ba0eea541a77484c716f1cf82195", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d35364d13e14ba0eea541a77484c716f1cf82195"}], "stats": {"total": 31, "additions": 23, "deletions": 8}, "files": [{"sha": "658d7762ef9a3f4b34bc12d1ad3152215f05d6d5", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6feb772821f473bad8f16e0959100bd404363ff2/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6feb772821f473bad8f16e0959100bd404363ff2/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=6feb772821f473bad8f16e0959100bd404363ff2", "patch": "@@ -1,3 +1,12 @@\n+2000-03-12  Zack Weinberg  <zack@wolery.cumb.org>\n+\n+ \t* cpphash.c: Don't include version.h.\n+\t(special_symbol) [case T_VERSION]: Look for the string in\n+\thp->value.cpval; don't use version_string.\n+\t* cppinit.c (initialize_builtins): Set hp->value.cpval for\n+\t__VERSION__ to version_string.\n+\t* Makefile.in (cpphash.o): Update deps.\n+\n 2000-03-12  Zack Weinberg  <zack@wolery.cumb.org>\n \n \tConvert cpplib to use libiberty/hashtab.c."}, {"sha": "9fff80b6ec34d3b04e8348e4017d35c075475987", "filename": "gcc/Makefile.in", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6feb772821f473bad8f16e0959100bd404363ff2/gcc%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6feb772821f473bad8f16e0959100bd404363ff2/gcc%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FMakefile.in?ref=6feb772821f473bad8f16e0959100bd404363ff2", "patch": "@@ -2049,7 +2049,7 @@ cppulp.o:   cppulp.c   $(CONFIG_H) system.h output.h\n cpperror.o: cpperror.c $(CONFIG_H) $(LIBCPP_DEPS)\n cppexp.o:   cppexp.c   $(CONFIG_H) $(LIBCPP_DEPS)\n cppfiles.o: cppfiles.c $(CONFIG_H) $(LIBCPP_DEPS) $(HASHTAB_H)\n-cpphash.o:  cpphash.c  $(CONFIG_H) $(LIBCPP_DEPS) $(HASHTAB_H) version.h\n+cpphash.o:  cpphash.c  $(CONFIG_H) $(LIBCPP_DEPS) $(HASHTAB_H)\n cpplib.o:   cpplib.c   $(CONFIG_H) $(LIBCPP_DEPS) $(HASHTAB_H) mkdeps.h\n \n cppinit.o:  cppinit.c  $(CONFIG_H) $(LIBCPP_DEPS) $(HASHTAB_H) mkdeps.h \\"}, {"sha": "3d48e8c5193a869978a0d4186cd7bf5d53dae4a6", "filename": "gcc/cpphash.c", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6feb772821f473bad8f16e0959100bd404363ff2/gcc%2Fcpphash.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6feb772821f473bad8f16e0959100bd404363ff2/gcc%2Fcpphash.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcpphash.c?ref=6feb772821f473bad8f16e0959100bd404363ff2", "patch": "@@ -28,7 +28,6 @@ Foundation, 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.\n #include \"cpplib.h\"\n #include \"cpphash.h\"\n #include \"hashtab.h\"\n-#include \"version.h\"\n #undef abort\n \n static unsigned int hash_HASHNODE PARAMS ((const void *));\n@@ -876,10 +875,10 @@ special_symbol (hp, pfile)\n       }\n \n     case T_VERSION:\n-      len = strlen (version_string);\n+      len = strlen (hp->value.cpval);\n       CPP_RESERVE (pfile, 3 + len);\n       CPP_PUTC_Q (pfile, '\"');\n-      CPP_PUTS_Q (pfile, version_string, len);\n+      CPP_PUTS_Q (pfile, hp->value.cpval, len);\n       CPP_PUTC_Q (pfile, '\"');\n       CPP_NUL_TERMINATE_Q (pfile);\n       return;"}, {"sha": "0eb2a298dff19d7f2f2127803ea16c5a7248599e", "filename": "gcc/cppinit.c", "status": "modified", "additions": 11, "deletions": 4, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6feb772821f473bad8f16e0959100bd404363ff2/gcc%2Fcppinit.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6feb772821f473bad8f16e0959100bd404363ff2/gcc%2Fcppinit.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcppinit.c?ref=6feb772821f473bad8f16e0959100bd404363ff2", "patch": "@@ -608,7 +608,8 @@ struct builtin\n };\n #define DUMP 0x01\n #define STDC 0x02\n-#define ULP  0x10\n+#define VERS 0x04\n+#define ULP  0x08\n \n static const struct builtin builtin_array[] =\n {\n@@ -618,7 +619,7 @@ static const struct builtin builtin_array[] =\n   { \"__BASE_FILE__\",\t\t0, T_BASE_FILE,\t\t0    },\n   { \"__LINE__\",\t\t\t0, T_SPECLINE,\t\t0    },\n   { \"__INCLUDE_LEVEL__\",\t0, T_INCLUDE_LEVEL,\t0    },\n-  { \"__VERSION__\",\t\t0, T_VERSION,\t\tDUMP },\n+  { \"__VERSION__\",\t\t0, T_VERSION,\t\tDUMP|VERS },\n   { \"__STDC__\",\t\t\t0, T_STDC,\t\tDUMP|STDC },\n \n   { \"__USER_LABEL_PREFIX__\",\t0,\t\t T_CONST, ULP  },\n@@ -651,9 +652,14 @@ initialize_builtins (pfile)\n       if ((b->flags & STDC) && CPP_TRADITIONAL (pfile))\n \tcontinue;\n \n-      val = (b->flags & ULP) ? user_label_prefix : b->value;\n-      len = strlen (b->name);\n+      if (b->flags & ULP)\n+\tval = user_label_prefix;\n+      else if (b->flags & VERS)\n+\tval = version_string;\n+      else\n+\tval = b->value;\n \n+      len = strlen (b->name);\n       hp = _cpp_make_hashnode (b->name, len, b->type, -1);\n       hp->value.cpval = val;\n       *(htab_find_slot (pfile->hashtab, (void *)hp, 1)) = hp;\n@@ -665,6 +671,7 @@ initialize_builtins (pfile)\n }\n #undef DUMP\n #undef STDC\n+#undef VERS\n #undef ULP\n \n /* Another subroutine of cpp_start_read.  This one sets up to do"}]}