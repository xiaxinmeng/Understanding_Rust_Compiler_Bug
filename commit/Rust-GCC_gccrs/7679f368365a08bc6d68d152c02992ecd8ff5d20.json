{"sha": "7679f368365a08bc6d68d152c02992ecd8ff5d20", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzY3OWYzNjgzNjVhMDhiYzZkNjhkMTUyYzAyOTkyZWNkOGZmNWQyMA==", "commit": {"author": {"name": "Tom Tromey", "email": "tromey@redhat.com", "date": "2007-01-31T17:11:11Z"}, "committer": {"name": "Tom Tromey", "email": "tromey@gcc.gnu.org", "date": "2007-01-31T17:11:11Z"}, "message": "re PR libgcj/30606 (natVMURLConnection.cc:21: error: 'magic_t' does not name a typet name a type)\n\n\tPR libgcj/30606:\n\t* configure, include/config.h.in: Rebuilt.\n\t* configure.ac: Check for magic_t in magic.h.\n\t* java/net/natVMURLConnection.cc: Use HAVE_MAGIC_T.\n\nFrom-SVN: r121425", "tree": {"sha": "8977e5f87f304a27fa54d1bcb814e71783beeaf1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8977e5f87f304a27fa54d1bcb814e71783beeaf1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7679f368365a08bc6d68d152c02992ecd8ff5d20", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7679f368365a08bc6d68d152c02992ecd8ff5d20", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7679f368365a08bc6d68d152c02992ecd8ff5d20", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7679f368365a08bc6d68d152c02992ecd8ff5d20/comments", "author": null, "committer": null, "parents": [{"sha": "8de15ffc9d9c4526bccc9f594edc8d8fdc57f83a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8de15ffc9d9c4526bccc9f594edc8d8fdc57f83a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8de15ffc9d9c4526bccc9f594edc8d8fdc57f83a"}], "stats": {"total": 96, "additions": 90, "deletions": 6}, "files": [{"sha": "2e6853713568540136ddc7de33e6b6cab686a6bb", "filename": "libjava/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7679f368365a08bc6d68d152c02992ecd8ff5d20/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7679f368365a08bc6d68d152c02992ecd8ff5d20/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=7679f368365a08bc6d68d152c02992ecd8ff5d20", "patch": "@@ -1,3 +1,10 @@\n+2007-01-31  Tom Tromey  <tromey@redhat.com>\n+\n+\tPR libgcj/30606:\n+\t* configure, include/config.h.in: Rebuilt.\n+\t* configure.ac: Check for magic_t in magic.h.\n+\t* java/net/natVMURLConnection.cc: Use HAVE_MAGIC_T.\n+\n 2007-01-30  Tom Tromey  <tromey@redhat.com>\n \n \t* Makefile.in: Rebuilt."}, {"sha": "0e87e5c2483a352f0032696321fdb65e94635551", "filename": "libjava/configure", "status": "modified", "additions": 69, "deletions": 0, "changes": 69, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7679f368365a08bc6d68d152c02992ecd8ff5d20/libjava%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7679f368365a08bc6d68d152c02992ecd8ff5d20/libjava%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fconfigure?ref=7679f368365a08bc6d68d152c02992ecd8ff5d20", "patch": "@@ -15768,6 +15768,75 @@ _ACEOF\n \n fi\n \n+echo \"$as_me:$LINENO: checking for magic_t\" >&5\n+echo $ECHO_N \"checking for magic_t... $ECHO_C\" >&6\n+if test \"${ac_cv_type_magic_t+set}\" = set; then\n+  echo $ECHO_N \"(cached) $ECHO_C\" >&6\n+else\n+  cat >conftest.$ac_ext <<_ACEOF\n+/* confdefs.h.  */\n+_ACEOF\n+cat confdefs.h >>conftest.$ac_ext\n+cat >>conftest.$ac_ext <<_ACEOF\n+/* end confdefs.h.  */\n+\n+#ifdef HAVE_MAGIC_H\n+#include <magic.h>\n+#endif\n+\n+int\n+main ()\n+{\n+if ((magic_t *) 0)\n+  return 0;\n+if (sizeof (magic_t))\n+  return 0;\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+rm -f conftest.$ac_objext\n+if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n+  (eval $ac_compile) 2>conftest.er1\n+  ac_status=$?\n+  grep -v '^ *+' conftest.er1 >conftest.err\n+  rm -f conftest.er1\n+  cat conftest.err >&5\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); } &&\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; } &&\n+\t { ac_try='test -s conftest.$ac_objext'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; }; then\n+  ac_cv_type_magic_t=yes\n+else\n+  echo \"$as_me: failed program was:\" >&5\n+sed 's/^/| /' conftest.$ac_ext >&5\n+\n+ac_cv_type_magic_t=no\n+fi\n+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext\n+fi\n+echo \"$as_me:$LINENO: result: $ac_cv_type_magic_t\" >&5\n+echo \"${ECHO_T}$ac_cv_type_magic_t\" >&6\n+if test $ac_cv_type_magic_t = yes; then\n+\n+\n+cat >>confdefs.h <<\\_ACEOF\n+#define HAVE_MAGIC_T 1\n+_ACEOF\n+\n+fi\n+\n \n echo \"$as_me:$LINENO: checking for in_addr_t\" >&5\n echo $ECHO_N \"checking for in_addr_t... $ECHO_C\" >&6"}, {"sha": "a3a9d80a2b1a5dd2339291421ff9493738987810", "filename": "libjava/configure.ac", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7679f368365a08bc6d68d152c02992ecd8ff5d20/libjava%2Fconfigure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7679f368365a08bc6d68d152c02992ecd8ff5d20/libjava%2Fconfigure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fconfigure.ac?ref=7679f368365a08bc6d68d152c02992ecd8ff5d20", "patch": "@@ -1383,6 +1383,11 @@ AC_CHECK_HEADERS(inttypes.h, [\n AC_HEADER_SYS_WAIT\n \n AC_CHECK_TYPE([ssize_t], [int])\n+AC_CHECK_TYPE([magic_t], [\n+    AC_DEFINE(HAVE_MAGIC_T, 1, [Define if magic.h declares magic_t])], [], [\n+#ifdef HAVE_MAGIC_H\n+#include <magic.h>\n+#endif])\n \n AC_MSG_CHECKING([for in_addr_t])\n AC_COMPILE_IFELSE([AC_LANG_PROGRAM([[#include <sys/types.h>"}, {"sha": "a4e013d735f7ce3f61606048d3e1bfe15b77f687", "filename": "libjava/include/config.h.in", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7679f368365a08bc6d68d152c02992ecd8ff5d20/libjava%2Finclude%2Fconfig.h.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7679f368365a08bc6d68d152c02992ecd8ff5d20/libjava%2Finclude%2Fconfig.h.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Finclude%2Fconfig.h.in?ref=7679f368365a08bc6d68d152c02992ecd8ff5d20", "patch": "@@ -187,6 +187,9 @@\n /* Define to 1 if you have the <magic.h> header file. */\n #undef HAVE_MAGIC_H\n \n+/* Define if magic.h declares magic_t */\n+#undef HAVE_MAGIC_T\n+\n /* Define to 1 if you have the `memcpy' function. */\n #undef HAVE_MEMCPY\n "}, {"sha": "a683fc6fdafc407c474badd41c0f7d622e7a3278", "filename": "libjava/java/net/natVMURLConnection.cc", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7679f368365a08bc6d68d152c02992ecd8ff5d20/libjava%2Fjava%2Fnet%2FnatVMURLConnection.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7679f368365a08bc6d68d152c02992ecd8ff5d20/libjava%2Fjava%2Fnet%2FnatVMURLConnection.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjava%2Fnet%2FnatVMURLConnection.cc?ref=7679f368365a08bc6d68d152c02992ecd8ff5d20", "patch": "@@ -13,7 +13,7 @@ details.  */\n #include <java/lang/UnsupportedOperationException.h>\n #include <stdio.h>\n \n-#if defined (HAVE_MAGIC_H) && defined (USE_LTDL)\n+#if defined (HAVE_MAGIC_T) && defined (HAVE_MAGIC_H) && defined (USE_LTDL)\n \n #include <magic.h>\n #include <ltdl.h>\n@@ -26,12 +26,12 @@ static void (*p_magic_close)(magic_t cookie);\n static const char * (*p_magic_buffer) (magic_t cookie, const void *buffer,\n \t\t\t\t       size_t length);\n \n-#endif /* HAVE_MAGIC_H && defined (USE_LTDL) */\n+#endif /* HAVE_MAGIC_T && HAVE_MAGIC_H && defined (USE_LTDL) */\n \n void\n java::net::VMURLConnection::init ()\n {\n-#if defined (HAVE_MAGIC_H) && defined (USE_LTDL)\n+#if defined (HAVE_MAGIC_T) && defined (HAVE_MAGIC_H) && defined (USE_LTDL)\n   lt_dlhandle handle = lt_dlopenext (\"libmagic.so\");\n   if (!handle)\n     return;\n@@ -57,14 +57,14 @@ java::net::VMURLConnection::init ()\n       p_magic_close (cookie);\n       cookie = (magic_t) NULL;\n     }\n-#endif /* HAVE_MAGIC_H  && defined (USE_LTDL) */\n+#endif /* HAVE_MAGIC_T && HAVE_MAGIC_H  && defined (USE_LTDL) */\n }\n \n ::java::lang::String *\n java::net::VMURLConnection::guessContentTypeFromBuffer (jbyteArray bytes,\n \t\t\t\t\t\t\tjint valid)\n {\n-#if defined (HAVE_MAGIC_H) && defined (USE_LTDL)\n+#if defined (HAVE_MAGIC_T) && defined (HAVE_MAGIC_H) && defined (USE_LTDL)\n   const char *result;\n \n   if (cookie == (magic_t) NULL)\n@@ -77,5 +77,5 @@ java::net::VMURLConnection::guessContentTypeFromBuffer (jbyteArray bytes,\n   return _Jv_NewStringUTF (result);\n #else\n   return NULL;\n-#endif /* HAVE_MAGIC_H  && defined (USE_LTDL) */\n+#endif /* HAVE_MAGIC_T && HAVE_MAGIC_H  && defined (USE_LTDL) */\n }"}]}