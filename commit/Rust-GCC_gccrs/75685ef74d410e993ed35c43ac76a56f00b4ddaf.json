{"sha": "75685ef74d410e993ed35c43ac76a56f00b4ddaf", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzU2ODVlZjc0ZDQxMGU5OTNlZDM1YzQzYWM3NmE1NmYwMGI0ZGRhZg==", "commit": {"author": {"name": "Pascal Obry", "email": "obry@adacore.com", "date": "2012-02-08T09:31:12Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2012-02-08T09:31:12Z"}, "message": "prj.adb (Compute_All_Imported_Projects): Use new For_Project_And_Aggregated_Context to ensure proper context is used for...\n\n2012-02-08  Pascal Obry  <obry@adacore.com>\n\n\t* prj.adb (Compute_All_Imported_Projects): Use new\n\tFor_Project_And_Aggregated_Context to ensure proper context is\n\tused for encapsulated aggregate libraries.\n\t* prj-proc.adb (Recursive_Process): Call\n\tProcess_Aggregated_Projects earlier to ensure that all dependent\n\tprojects are set with the proper encapsulated status.\n\n2012-02-08  Pascal Obry  <obry@adacore.com>\n\n\t* s-os_lib.adb (Normalize_Arguments): Properly escape last \\ in null\n\tterminated string.\n\nFrom-SVN: r183999", "tree": {"sha": "60c3c2395d7e64a87e526596d8d75bab4c8b2e02", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/60c3c2395d7e64a87e526596d8d75bab4c8b2e02"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/75685ef74d410e993ed35c43ac76a56f00b4ddaf", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/75685ef74d410e993ed35c43ac76a56f00b4ddaf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/75685ef74d410e993ed35c43ac76a56f00b4ddaf", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/75685ef74d410e993ed35c43ac76a56f00b4ddaf/comments", "author": {"login": "TurboGit", "id": 467069, "node_id": "MDQ6VXNlcjQ2NzA2OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/467069?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TurboGit", "html_url": "https://github.com/TurboGit", "followers_url": "https://api.github.com/users/TurboGit/followers", "following_url": "https://api.github.com/users/TurboGit/following{/other_user}", "gists_url": "https://api.github.com/users/TurboGit/gists{/gist_id}", "starred_url": "https://api.github.com/users/TurboGit/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TurboGit/subscriptions", "organizations_url": "https://api.github.com/users/TurboGit/orgs", "repos_url": "https://api.github.com/users/TurboGit/repos", "events_url": "https://api.github.com/users/TurboGit/events{/privacy}", "received_events_url": "https://api.github.com/users/TurboGit/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "8364925760fe4705c121c975fca117d26ac81aea", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8364925760fe4705c121c975fca117d26ac81aea", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8364925760fe4705c121c975fca117d26ac81aea"}], "stats": {"total": 53, "additions": 42, "deletions": 11}, "files": [{"sha": "4d0daf497530e43bdbe2e17b9d4af3709b7c534e", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/75685ef74d410e993ed35c43ac76a56f00b4ddaf/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/75685ef74d410e993ed35c43ac76a56f00b4ddaf/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=75685ef74d410e993ed35c43ac76a56f00b4ddaf", "patch": "@@ -1,3 +1,17 @@\n+2012-02-08  Pascal Obry  <obry@adacore.com>\n+\n+\t* prj.adb (Compute_All_Imported_Projects): Use new\n+\tFor_Project_And_Aggregated_Context to ensure proper context is\n+\tused for encapsulated aggregate libraries.\n+\t* prj-proc.adb (Recursive_Process): Call\n+\tProcess_Aggregated_Projects earlier to ensure that all dependent\n+\tprojects are set with the proper encapsulated status.\n+\n+2012-02-08  Pascal Obry  <obry@adacore.com>\n+\n+\t* s-os_lib.adb (Normalize_Arguments): Properly escape last \\ in null\n+\tterminated string.\n+\n 2012-02-08  Pascal Obry  <obry@adacore.com>\n \n \t* prj.ads, prj.adb (For_Project_And_Aggregated_Context): New"}, {"sha": "1d5c7738e5205c09b90f150a461ee08a0a7251be", "filename": "gcc/ada/prj-proc.adb", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/75685ef74d410e993ed35c43ac76a56f00b4ddaf/gcc%2Fada%2Fprj-proc.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/75685ef74d410e993ed35c43ac76a56f00b4ddaf/gcc%2Fada%2Fprj-proc.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-proc.adb?ref=75685ef74d410e993ed35c43ac76a56f00b4ddaf", "patch": "@@ -2908,6 +2908,10 @@ package body Prj.Proc is\n \n             Process_Imported_Projects (Imported, Limited_With => True);\n \n+            if Err_Vars.Total_Errors_Detected = 0 then\n+               Process_Aggregated_Projects;\n+            end if;\n+\n             --  At this point (after Process_Declarative_Items) we have the\n             --  attribute values set, we can backtrace In_Tree.Project and\n             --  set the From_Encapsulated_Library status.\n@@ -2935,7 +2939,6 @@ package body Prj.Proc is\n                end if;\n \n                if Err_Vars.Total_Errors_Detected = 0 then\n-                  Process_Aggregated_Projects;\n \n                   --  For an aggregate library we add the aggregated projects\n                   --  as imported ones. This is necessary to give visibility"}, {"sha": "f9cc7398cc0a1e50990bab6e2631fd6dfe47515d", "filename": "gcc/ada/prj.adb", "status": "modified", "additions": 8, "deletions": 4, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/75685ef74d410e993ed35c43ac76a56f00b4ddaf/gcc%2Fada%2Fprj.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/75685ef74d410e993ed35c43ac76a56f00b4ddaf/gcc%2Fada%2Fprj.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj.adb?ref=75685ef74d410e993ed35c43ac76a56f00b4ddaf", "patch": "@@ -1476,7 +1476,8 @@ package body Prj is\n    is\n       procedure Analyze_Tree\n         (Local_Root : Project_Id;\n-         Local_Tree : Project_Tree_Ref);\n+         Local_Tree : Project_Tree_Ref;\n+         Context    : Project_Context);\n       --  Process Project and all its aggregated project to analyze their own\n       --  imported projects.\n \n@@ -1486,7 +1487,8 @@ package body Prj is\n \n       procedure Analyze_Tree\n         (Local_Root : Project_Id;\n-         Local_Tree : Project_Tree_Ref)\n+         Local_Tree : Project_Tree_Ref;\n+         Context    : Project_Context)\n       is\n          pragma Unreferenced (Local_Root);\n \n@@ -1540,7 +1542,9 @@ package body Prj is\n                Project.All_Imported_Projects :=\n                  new Project_List_Element'\n                    (Project               => Prj2,\n-                    From_Encapsulated_Lib => Context.From_Encapsulated_Lib,\n+                    From_Encapsulated_Lib =>\n+                      Context.From_Encapsulated_Lib\n+                        or else Analyze_Tree.Context.From_Encapsulated_Lib,\n                     Next                  => Project.All_Imported_Projects);\n             end if;\n          end Recursive_Add;\n@@ -1564,7 +1568,7 @@ package body Prj is\n       end Analyze_Tree;\n \n       procedure For_Aggregates is\n-        new For_Project_And_Aggregated (Analyze_Tree);\n+        new For_Project_And_Aggregated_Context (Analyze_Tree);\n \n    --  Start of processing for Compute_All_Imported_Projects\n "}, {"sha": "993cc8c5959305fc3f93bc1bffd8bb885c62f428", "filename": "gcc/ada/s-os_lib.adb", "status": "modified", "additions": 16, "deletions": 6, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/75685ef74d410e993ed35c43ac76a56f00b4ddaf/gcc%2Fada%2Fs-os_lib.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/75685ef74d410e993ed35c43ac76a56f00b4ddaf/gcc%2Fada%2Fs-os_lib.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fs-os_lib.adb?ref=75685ef74d410e993ed35c43ac76a56f00b4ddaf", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 B o d y                                  --\n --                                                                          --\n---                     Copyright (C) 1995-2010, AdaCore                     --\n+--                     Copyright (C) 1995-2012, AdaCore                     --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -31,12 +31,12 @@\n \n pragma Compiler_Unit;\n \n-with System.Case_Util;\n-with System.CRTL;\n-with System.Soft_Links;\n with Ada.Unchecked_Conversion;\n with Ada.Unchecked_Deallocation;\n with System; use System;\n+with System.Case_Util;\n+with System.CRTL;\n+with System.Soft_Links;\n \n package body System.OS_Lib is\n \n@@ -1703,6 +1703,16 @@ package body System.OS_Lib is\n                --  If null terminated string, put the quote before\n \n                if Res (J) = ASCII.NUL then\n+\n+                  --  If the string ends with \\, double it\n+\n+                  if Res (J - 1) = '\\' then\n+                     Res (J) := '\\';\n+                     J := J + 1;\n+                  end if;\n+\n+                  --  Then adds the quote and the NUL character\n+\n                   Res (J) := '\"';\n                   J := J + 1;\n                   Res (J) := ASCII.NUL;\n@@ -2131,8 +2141,8 @@ package body System.OS_Lib is\n             Start := Last;\n             loop\n                Start := Start - 1;\n-               exit when Start < 1 or else\n-                 Path_Buffer (Start) = Directory_Separator;\n+               exit when Start < 1\n+                 or else Path_Buffer (Start) = Directory_Separator;\n             end loop;\n \n             if Start <= 1 then"}]}