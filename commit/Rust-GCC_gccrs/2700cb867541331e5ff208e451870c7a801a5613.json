{"sha": "2700cb867541331e5ff208e451870c7a801a5613", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjcwMGNiODY3NTQxMzMxZTVmZjIwOGU0NTE4NzBjN2E4MDFhNTYxMw==", "commit": {"author": {"name": "Andrew Pinski", "email": "andrew_pinski@playstation.sony.com", "date": "2008-09-17T21:39:13Z"}, "committer": {"name": "Andrew Pinski", "email": "pinskia@gcc.gnu.org", "date": "2008-09-17T21:39:13Z"}, "message": "re PR objc/37460 (NeXT runtime ICEs)\n\n2008-09-17  Andrew Pinski  <andrew_pinski@playstation.sony.com>\n\n        * tree.c (get_callee_fndecl): Don't call the language hook.\n        * langhooks.h (lang_hooks): Remove lang_get_callee_fndecl.\n        * langhooks-def.h (LANG_HOOKS_GET_CALLEE_FNDECL): Kill.\n        (LANG_HOOKS_INITIALIZER): Remove LANG_HOOKS_GET_CALLEE_FNDECL.\n\n\n2008-09-17  Andrew Pinski  <andrew_pinski@playstation.sony.com>\n\n        PR objc/37460\n        * objc-lang.c (LANG_HOOKS_GET_CALLEE_FNDECL): Don't define.\n        * objc-act.h (objc_get_callee_fndecl): Remove prototype.\n        * objc-act.c (objc_get_callee_fndecl): Kill.\n\n2008-09-17  Andrew Pinski  <andrew_pinski@playstation.sony.com>\n\n        * lang.c (LANG_HOOKS_GET_CALLEE_FNDECL): Don't define.\n        (java_get_callee_fndecl): Kill.\n\n2008-09-17  Andrew Pinski  <andrew_pinski@playstation.sony.com>\n\n        PR objc/37460\n        * objcp-lang.c (LANG_HOOKS_GET_CALLEE_FNDECL): Don't define.\n\nFrom-SVN: r140430", "tree": {"sha": "6cb176666db53c6b4190270715556b7607696332", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6cb176666db53c6b4190270715556b7607696332"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2700cb867541331e5ff208e451870c7a801a5613", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2700cb867541331e5ff208e451870c7a801a5613", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2700cb867541331e5ff208e451870c7a801a5613", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2700cb867541331e5ff208e451870c7a801a5613/comments", "author": null, "committer": null, "parents": [{"sha": "6847a7549cc909ebb292eeb6b549ca4faf013874", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6847a7549cc909ebb292eeb6b549ca4faf013874", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6847a7549cc909ebb292eeb6b549ca4faf013874"}], "stats": {"total": 114, "additions": 26, "deletions": 88}, "files": [{"sha": "468c60446f446ced47b35fbe9522f1b2eb6ac3c9", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2700cb867541331e5ff208e451870c7a801a5613/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2700cb867541331e5ff208e451870c7a801a5613/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=2700cb867541331e5ff208e451870c7a801a5613", "patch": "@@ -1,3 +1,10 @@\n+2008-09-17  Andrew Pinski  <andrew_pinski@playstation.sony.com>\n+\n+\t* tree.c (get_callee_fndecl): Don't call the language hook.\n+\t* langhooks.h (lang_hooks): Remove lang_get_callee_fndecl.\n+\t* langhooks-def.h (LANG_HOOKS_GET_CALLEE_FNDECL): Kill.\n+\t(LANG_HOOKS_INITIALIZER): Remove LANG_HOOKS_GET_CALLEE_FNDECL.\n+\n 2008-09-17  Jakub Jelinek  <jakub@redhat.com>\n \n \t* tree.c (protected_set_expr_location): Don't unnecessarily"}, {"sha": "e7b6263741605464efb42e42b3de18ef04929588", "filename": "gcc/java/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2700cb867541331e5ff208e451870c7a801a5613/gcc%2Fjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2700cb867541331e5ff208e451870c7a801a5613/gcc%2Fjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2FChangeLog?ref=2700cb867541331e5ff208e451870c7a801a5613", "patch": "@@ -1,3 +1,8 @@\n+2008-09-17  Andrew Pinski  <andrew_pinski@playstation.sony.com>\n+\n+\t* lang.c (LANG_HOOKS_GET_CALLEE_FNDECL): Don't define.\n+\t(java_get_callee_fndecl): Kill.\n+\n 2008-09-17  Jan Hubicka  <jh@suse.cz>\n \n \tPR c++/18071"}, {"sha": "2a962c04736df2e7edf4b129c020ce5fcaa33e9b", "filename": "gcc/java/lang.c", "status": "modified", "additions": 0, "deletions": 54, "changes": 54, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2700cb867541331e5ff208e451870c7a801a5613/gcc%2Fjava%2Flang.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2700cb867541331e5ff208e451870c7a801a5613/gcc%2Fjava%2Flang.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2Flang.c?ref=2700cb867541331e5ff208e451870c7a801a5613", "patch": "@@ -61,7 +61,6 @@ static int inline_init_test_initialization (void * *, void *);\n static bool java_dump_tree (void *, tree);\n static void dump_compound_expr (dump_info_p, tree);\n static bool java_decl_ok_for_sibcall (const_tree);\n-static tree java_get_callee_fndecl (const_tree);\n \n static enum classify_record java_classify_record (tree type);\n \n@@ -156,9 +155,6 @@ struct language_function GTY(())\n #undef LANG_HOOKS_DECL_OK_FOR_SIBCALL\n #define LANG_HOOKS_DECL_OK_FOR_SIBCALL java_decl_ok_for_sibcall\n \n-#undef LANG_HOOKS_GET_CALLEE_FNDECL\n-#define LANG_HOOKS_GET_CALLEE_FNDECL java_get_callee_fndecl\n-\n #undef LANG_HOOKS_SET_DECL_ASSEMBLER_NAME\n #define LANG_HOOKS_SET_DECL_ASSEMBLER_NAME java_mangle_decl\n \n@@ -848,56 +844,6 @@ java_decl_ok_for_sibcall (const_tree decl)\n           && !DECL_UNINLINABLE (decl));\n }\n \n-/* Given a call_expr, try to figure out what its target might be.  In\n-   the case of an indirection via the atable, search for the decl.  If\n-   the decl is external, we return NULL.  If we don't, the optimizer\n-   will replace the indirection with a direct call, which undoes the\n-   purpose of the atable indirection.  */\n-static tree\n-java_get_callee_fndecl (const_tree call_expr)\n-{\n-  tree method, table, element, atable_methods;\n-\n-  HOST_WIDE_INT index;\n-\n-  /* FIXME: This is disabled because we end up passing calls through\n-     the PLT, and we do NOT want to do that.  */\n-  return NULL;\n-\n-  if (TREE_CODE (call_expr) != CALL_EXPR)\n-    return NULL;\n-  method = CALL_EXPR_FN (call_expr);\n-  STRIP_NOPS (method);\n-  if (TREE_CODE (method) != ARRAY_REF)\n-    return NULL;\n-  table = TREE_OPERAND (method, 0);\n-  if (! DECL_LANG_SPECIFIC(table)\n-      || !DECL_OWNER (table)\n-      || TYPE_ATABLE_DECL (DECL_OWNER (table)) != table)\n-    return NULL;\n-\n-  atable_methods = TYPE_ATABLE_METHODS (DECL_OWNER (table));\n-  index = TREE_INT_CST_LOW (TREE_OPERAND (method, 1));\n-\n-  /* FIXME: Replace this for loop with a hash table lookup.  */\n-  for (element = atable_methods; element; element = TREE_CHAIN (element))\n-    {\n-      if (index == 1)\n-\t{\n-\t  tree purpose = TREE_PURPOSE (element);\n-\t  if (TREE_CODE (purpose) == FUNCTION_DECL\n-\t      && ! DECL_EXTERNAL (purpose))\n-\t    return purpose;\n-\t  else\n-\t    return NULL;\n-\t}\n-      --index;\n-    }\n-\n-  return NULL;\n-}\n-\n-\n static enum classify_record\n java_classify_record (tree type)\n {"}, {"sha": "996e2f209a6c885894fa496aff981e5ef7420982", "filename": "gcc/langhooks-def.h", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2700cb867541331e5ff208e451870c7a801a5613/gcc%2Flanghooks-def.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2700cb867541331e5ff208e451870c7a801a5613/gcc%2Flanghooks-def.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flanghooks-def.h?ref=2700cb867541331e5ff208e451870c7a801a5613", "patch": "@@ -105,7 +105,6 @@ extern void lhd_omp_firstprivatize_type_sizes (struct gimplify_omp_ctx *,\n #define LANG_HOOKS_PRINT_ERROR_FUNCTION lhd_print_error_function\n #define LANG_HOOKS_DECL_PRINTABLE_NAME\tlhd_decl_printable_name\n #define LANG_HOOKS_DWARF_NAME\t\tlhd_dwarf_name\n-#define LANG_HOOKS_GET_CALLEE_FNDECL\tlhd_return_null_const_tree\n #define LANG_HOOKS_EXPR_SIZE\t\tlhd_expr_size\n #define LANG_HOOKS_TREE_SIZE\t\tlhd_tree_size\n #define LANG_HOOKS_TYPES_COMPATIBLE_P\tlhd_types_compatible_p\n@@ -255,7 +254,6 @@ extern tree lhd_make_node (enum tree_code);\n   LANG_HOOKS_DECL_PRINTABLE_NAME, \\\n   LANG_HOOKS_DWARF_NAME, \\\n   LANG_HOOKS_TYPES_COMPATIBLE_P, \\\n-  LANG_HOOKS_GET_CALLEE_FNDECL, \\\n   LANG_HOOKS_PRINT_ERROR_FUNCTION, \\\n   LANG_HOOKS_EXPR_SIZE, \\\n   LANG_HOOKS_TO_TARGET_CHARSET, \\"}, {"sha": "752ad99501f805ed318feb806ac9c562b22062e9", "filename": "gcc/langhooks.h", "status": "modified", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2700cb867541331e5ff208e451870c7a801a5613/gcc%2Flanghooks.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2700cb867541331e5ff208e451870c7a801a5613/gcc%2Flanghooks.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flanghooks.h?ref=2700cb867541331e5ff208e451870c7a801a5613", "patch": "@@ -354,9 +354,6 @@ struct lang_hooks\n      in contexts where erroneously returning 0 causes problems.  */\n   int (*types_compatible_p) (tree x, tree y);\n \n-  /* Given a CALL_EXPR, return a function decl that is its target.  */\n-  tree (*lang_get_callee_fndecl) (const_tree);\n-\n   /* Called by report_error_function to print out function name.  */\n   void (*print_error_function) (struct diagnostic_context *, const char *,\n \t\t\t\tstruct diagnostic_info *);"}, {"sha": "039ad3b1bf0722fd6b225c517f38a449c23c7704", "filename": "gcc/objc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2700cb867541331e5ff208e451870c7a801a5613/gcc%2Fobjc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2700cb867541331e5ff208e451870c7a801a5613/gcc%2Fobjc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fobjc%2FChangeLog?ref=2700cb867541331e5ff208e451870c7a801a5613", "patch": "@@ -1,3 +1,10 @@\n+2008-09-17  Andrew Pinski  <andrew_pinski@playstation.sony.com>\n+\n+\tPR objc/37460\n+\t* objc-lang.c (LANG_HOOKS_GET_CALLEE_FNDECL): Don't define.\n+\t* objc-act.h (objc_get_callee_fndecl): Remove prototype.\n+\t* objc-act.c (objc_get_callee_fndecl): Kill.\n+\n 2008-09-17  Jan Hubicka  <jh@suse.cz>\n \n \tPR c++/18071"}, {"sha": "837f3cf5c0b72c502524334e57aca02ce673ec14", "filename": "gcc/objc/objc-act.c", "status": "modified", "additions": 0, "deletions": 21, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2700cb867541331e5ff208e451870c7a801a5613/gcc%2Fobjc%2Fobjc-act.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2700cb867541331e5ff208e451870c7a801a5613/gcc%2Fobjc%2Fobjc-act.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fobjc%2Fobjc-act.c?ref=2700cb867541331e5ff208e451870c7a801a5613", "patch": "@@ -9510,25 +9510,4 @@ objc_gimplify_expr (tree *expr_p, gimple_seq *pre_p, gimple_seq *post_p)\n #endif\n }\n \n-/* Given a CALL expression, find the function being called.  The ObjC\n-   version looks for the OBJ_TYPE_REF_EXPR which is used for objc_msgSend.  */\n-\n-tree\n-objc_get_callee_fndecl (const_tree call_expr)\n-{\n-  tree addr = CALL_EXPR_FN (call_expr);\n-  if (TREE_CODE (addr) != OBJ_TYPE_REF)\n-    return 0;\n-\n-  addr = OBJ_TYPE_REF_EXPR (addr);\n-\n-  /* If the address is just `&f' for some function `f', then we know\n-     that `f' is being called.  */\n-  if (TREE_CODE (addr) == ADDR_EXPR\n-      && TREE_CODE (TREE_OPERAND (addr, 0)) == FUNCTION_DECL)\n-    return TREE_OPERAND (addr, 0);\n-\n-  return 0;\n-}\n-\n #include \"gt-objc-objc-act.h\""}, {"sha": "6c6b227bd6b7afab2f142c2f9bb060d624dfcde6", "filename": "gcc/objc/objc-act.h", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2700cb867541331e5ff208e451870c7a801a5613/gcc%2Fobjc%2Fobjc-act.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2700cb867541331e5ff208e451870c7a801a5613/gcc%2Fobjc%2Fobjc-act.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fobjc%2Fobjc-act.h?ref=2700cb867541331e5ff208e451870c7a801a5613", "patch": "@@ -29,7 +29,6 @@ along with GCC; see the file COPYING3.  If not see\n \n bool objc_init (void);\n const char *objc_printable_name (tree, int);\n-tree objc_get_callee_fndecl (const_tree);\n void objc_finish_file (void);\n tree objc_fold_obj_type_ref (tree, tree);\n enum gimplify_status objc_gimplify_expr (tree *, gimple_seq *, gimple_seq *);"}, {"sha": "37c785c6ac45cae937e5c805cc6b66360acb69e9", "filename": "gcc/objc/objc-lang.c", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2700cb867541331e5ff208e451870c7a801a5613/gcc%2Fobjc%2Fobjc-lang.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2700cb867541331e5ff208e451870c7a801a5613/gcc%2Fobjc%2Fobjc-lang.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fobjc%2Fobjc-lang.c?ref=2700cb867541331e5ff208e451870c7a801a5613", "patch": "@@ -48,8 +48,6 @@ static void objc_init_ts (void);\n #define LANG_HOOKS_DECL_PRINTABLE_NAME objc_printable_name\n #undef LANG_HOOKS_GIMPLIFY_EXPR \n #define LANG_HOOKS_GIMPLIFY_EXPR objc_gimplify_expr\n-#undef LANG_HOOKS_GET_CALLEE_FNDECL\n-#define LANG_HOOKS_GET_CALLEE_FNDECL\tobjc_get_callee_fndecl\n #undef LANG_HOOKS_INIT_TS\n #define LANG_HOOKS_INIT_TS objc_init_ts\n "}, {"sha": "b296480f4953f37a420157bc942cbfe825658a81", "filename": "gcc/objcp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2700cb867541331e5ff208e451870c7a801a5613/gcc%2Fobjcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2700cb867541331e5ff208e451870c7a801a5613/gcc%2Fobjcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fobjcp%2FChangeLog?ref=2700cb867541331e5ff208e451870c7a801a5613", "patch": "@@ -1,3 +1,8 @@\n+2008-09-17  Andrew Pinski  <andrew_pinski@playstation.sony.com>\n+\n+\tPR objc/37460\n+\t* objcp-lang.c (LANG_HOOKS_GET_CALLEE_FNDECL): Don't define.\n+\n 2008-04-03  Tom Tromey  <tromey@redhat.com>\n \n \t* Make-lang.in (obj-c++_OBJS): New variable."}, {"sha": "ab3206a25ad07a857f7c1fcc0465638b90aae490", "filename": "gcc/objcp/objcp-lang.c", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2700cb867541331e5ff208e451870c7a801a5613/gcc%2Fobjcp%2Fobjcp-lang.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2700cb867541331e5ff208e451870c7a801a5613/gcc%2Fobjcp%2Fobjcp-lang.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fobjcp%2Fobjcp-lang.c?ref=2700cb867541331e5ff208e451870c7a801a5613", "patch": "@@ -48,8 +48,6 @@ static void objcxx_init_ts (void);\n #define LANG_HOOKS_DECL_PRINTABLE_NAME\tobjc_printable_name\n #undef LANG_HOOKS_GIMPLIFY_EXPR \n #define LANG_HOOKS_GIMPLIFY_EXPR objc_gimplify_expr\n-#undef LANG_HOOKS_GET_CALLEE_FNDECL\n-#define LANG_HOOKS_GET_CALLEE_FNDECL\tobjc_get_callee_fndecl\n #undef LANG_HOOKS_INIT_TS\n #define LANG_HOOKS_INIT_TS objcxx_init_ts\n "}, {"sha": "3d2f3e1fe3d154246dceb8e5d4ec4b4f2f37b8bd", "filename": "gcc/tree.c", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2700cb867541331e5ff208e451870c7a801a5613/gcc%2Ftree.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2700cb867541331e5ff208e451870c7a801a5613/gcc%2Ftree.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree.c?ref=2700cb867541331e5ff208e451870c7a801a5613", "patch": "@@ -6770,9 +6770,8 @@ get_callee_fndecl (const_tree call)\n       && TREE_CODE (TREE_OPERAND (addr, 0)) == FUNCTION_DECL)\n     return TREE_OPERAND (addr, 0);\n \n-  /* We couldn't figure out what was being called.  Maybe the front\n-     end has some idea.  */\n-  return lang_hooks.lang_get_callee_fndecl (call);\n+  /* We couldn't figure out what was being called.  */\n+  return NULL_TREE;\n }\n \n /* Print debugging information about tree nodes generated during the compile,"}]}