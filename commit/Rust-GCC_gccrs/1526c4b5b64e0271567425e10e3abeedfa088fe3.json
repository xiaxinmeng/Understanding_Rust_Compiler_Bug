{"sha": "1526c4b5b64e0271567425e10e3abeedfa088fe3", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTUyNmM0YjViNjRlMDI3MTU2NzQyNWUxMGUzYWJlZWRmYTA4OGZlMw==", "commit": {"author": {"name": "Jerry DeLisle", "email": "jvdelisle@gcc.gnu.org", "date": "2006-10-14T15:06:34Z"}, "committer": {"name": "Jerry DeLisle", "email": "jvdelisle@gcc.gnu.org", "date": "2006-10-14T15:06:34Z"}, "message": "re PR fortran/19261 (continuation character illegal as first non-blank character in statement)\n\n2006-10-14  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n\n\tPR fortran/19261\n\t* scanner.c (load_line): Add checks for illegal use of '&' and issue\n\twarnings.  Issue errors with -pedantic.\n\nFrom-SVN: r117733", "tree": {"sha": "ebc27fcef1e38502ee94bc9157b5b2672fd2cc1e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ebc27fcef1e38502ee94bc9157b5b2672fd2cc1e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1526c4b5b64e0271567425e10e3abeedfa088fe3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1526c4b5b64e0271567425e10e3abeedfa088fe3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1526c4b5b64e0271567425e10e3abeedfa088fe3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1526c4b5b64e0271567425e10e3abeedfa088fe3/comments", "author": null, "committer": null, "parents": [{"sha": "467f18f389215fd82103477340905ea8b9638d07", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/467f18f389215fd82103477340905ea8b9638d07", "html_url": "https://github.com/Rust-GCC/gccrs/commit/467f18f389215fd82103477340905ea8b9638d07"}], "stats": {"total": 50, "additions": 45, "deletions": 5}, "files": [{"sha": "005320b4cb17a5a4505451eadcff394f96b672a4", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1526c4b5b64e0271567425e10e3abeedfa088fe3/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1526c4b5b64e0271567425e10e3abeedfa088fe3/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=1526c4b5b64e0271567425e10e3abeedfa088fe3", "patch": "@@ -1,3 +1,9 @@\n+2006-10-14  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n+\n+\tPR fortran/19261\n+\t* scanner.c (load_line): Add checks for illegal use of '&' and issue\n+\twarnings.  Issue errors with -pedantic.\n+\n 2006-10-14 Paul Thomas <pault@gcc.gnu.org>\n \n \tPR fortran/29371"}, {"sha": "9d0ba2a492be7d4dfff157b72350dfbfe0bde3a8", "filename": "gcc/fortran/scanner.c", "status": "modified", "additions": 39, "deletions": 5, "changes": 44, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1526c4b5b64e0271567425e10e3abeedfa088fe3/gcc%2Ffortran%2Fscanner.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1526c4b5b64e0271567425e10e3abeedfa088fe3/gcc%2Ffortran%2Fscanner.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fscanner.c?ref=1526c4b5b64e0271567425e10e3abeedfa088fe3", "patch": "@@ -940,14 +940,19 @@ gfc_gobble_whitespace (void)\n    In fixed mode, we expand a tab that occurs within the statement\n    label region to expand to spaces that leave the next character in\n    the source region.\n-   load_line returns whether the line was truncated.  */\n+   load_line returns whether the line was truncated.\n+\n+   NOTE: The error machinery isn't available at this point, so we can't\n+\t easily report line and column numbers consistent with other \n+\t parts of gfortran.  */\n \n static int\n load_line (FILE * input, char **pbuf, int *pbuflen)\n {\n   static int linenum = 0, current_line = 1;\n   int c, maxlen, i, preprocessor_flag, buflen = *pbuflen;\n   int trunc_flag = 0, seen_comment = 0;\n+  int seen_printable = 0, seen_ampersand = 0;\n   char *buffer;\n \n   /* Determine the maximum allowed line length.\n@@ -999,7 +1004,20 @@ load_line (FILE * input, char **pbuf, int *pbuflen)\n       if (c == EOF)\n \tbreak;\n       if (c == '\\n')\n-\tbreak;\n+\t{\n+\t  /* Check for illegal use of ampersand. See F95 Standard 3.3.1.3.  */\n+\t  if (gfc_current_form == FORM_FREE \n+\t\t&& !seen_printable && seen_ampersand)\n+\t    {\n+\t      if (pedantic)\n+\t\tgfc_error_now\n+\t\t  (\"'&' not allowed by itself in line %d\", current_line);\n+\t      else\n+\t\tgfc_warning_now\n+\t\t  (\"'&' not allowed by itself in line %d\", current_line);\n+\t    }\n+\t  break;\n+\t}\n \n       if (c == '\\r')\n \tcontinue;\t\t/* Gobble characters.  */\n@@ -1013,16 +1031,32 @@ load_line (FILE * input, char **pbuf, int *pbuflen)\n \t  break;\n \t}\n \n+      /* Check for illegal use of ampersand. See F95 Standard 3.3.1.3.  */\n+      if (c == '&')\n+\tseen_ampersand = 1;\n+\n+      if ((c != ' ' && c != '&' && c != '!') || (c == '!' && !seen_ampersand))\n+\tseen_printable = 1;\n+      \n+      if (gfc_current_form == FORM_FREE \n+\t    && c == '!' && !seen_printable && seen_ampersand)\n+\t{\n+\t  if (pedantic)\n+\t    gfc_error_now (\n+\t      \"'&' not allowed by itself with comment in line %d\", current_line);\n+\t  else\n+\t    gfc_warning_now (\n+\t      \"'&' not allowed by itself with comment in line %d\", current_line);\n+\t  seen_printable = 1;\n+\t}\n+\n       /* Is this a fixed-form comment?  */\n       if (gfc_current_form == FORM_FIXED && i == 0\n \t  && (c == '*' || c == 'c' || c == 'd'))\n \tseen_comment = 1;\n \n       if (gfc_current_form == FORM_FIXED && c == '\\t' && i <= 6)\n \t{\n-\t  /* The error machinery isn't available at this point, so we can't\n-\t     easily report line and column numbers consistent with other \n-\t     parts of gfortran.  */\n \t  if (!gfc_option.warn_tabs && seen_comment == 0\n \t      && current_line != linenum)\n \t    {"}]}