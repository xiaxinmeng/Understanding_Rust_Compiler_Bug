{"sha": "8d2c5b6101426f036bec7940aa29bf7bb8c4abc9", "node_id": "C_kwDOANBUbNoAKDhkMmM1YjYxMDE0MjZmMDM2YmVjNzk0MGFhMjliZjdiYjhjNGFiYzk", "commit": {"author": {"name": "Gaius Mulley", "email": "gaiusmod2@gmail.com", "date": "2023-02-03T16:35:22Z"}, "committer": {"name": "Gaius Mulley", "email": "gaiusmod2@gmail.com", "date": "2023-02-03T16:35:22Z"}, "message": "[modula-2] Bugfix to allow html doc build and simplify target dir creation\n\nThis patch allows the m2 html documentation to be built.\nIt also simplifies all calls to $(mkinstalldirs) using $(@D) in\ngcc/m2/Make-lang.in.\n\ngcc/ChangeLog:\n\n\t* doc/gm2.texi (Internals): Remove from menu.\n\t(Using): Comment out ifnohtml conditional.\n\t(Documentation): Use gcc url.\n\t(License): Node simplified.\n\t(Copying): New node.  Include gpl_v3_without_node.\n\t(Contributing): Node simplified.\n\t(Internals): Commented out.\n\t(Libraries): Node simplified.\n\t(Indices): Ditto.\n\t(Contents): Ditto.\n\t(Functions): Ditto.\n\ngcc/m2/ChangeLog:\n\n\t* Make-lang.in (TEXISRC): Remove m2/images/gnu.eps.\n\t(RSTSRC): Remove m2/images/gnu.eps.\n\t(doc/m2.dvi): Add $(objdir)/m2/images/gnu.eps.\n\t(doc/m2.pdf): Add $(objdir)/m2/images/gnu.eps.\n\t(M2_PDFFILES): New definition.\n\t(m2.install-pdf): New rule.\n\t(m2.pod): Add $(objdir)/m2/images/gnu.eps.\n\t(m2.info): Add $(objdir)/m2/images/gnu.eps.\n\t(m2.html): New rule.\n\t(m2/gpl_v3_without_node.texi): New rule.\n\t(plugin/m2rte$(soext)): Simplify mkinstalldirs.\n\t(cc1gm2$(exeext)): Ditto.\n\t(m2/stage1/cc1gm2$(exeext)): Ditto.\n\t(m2/gm2-gcc/%.o): Ditto.\n\t(m2/gm2-gcc/rtegraph.o): Ditto.\n\t(m2/gm2-gcc/$(SRC_PREFIX)%.h): Ditto.\n\t(m2/mc-boot/$(SRC_PREFIX)%.o):Ditto.\n\t(m2/mc-boot-ch/$(SRC_PREFIX)%.o): Ditto.\n\t(m2/mc-boot/main.o): Ditto.\n\t(m2/gm2-libs-boot/%.o):\tDitto.\n\t(m2/gm2-libs-boot/$(SRC_PREFIX)%.h): Ditto.\n\t(m2/gm2-libs-boot/RTcodummy.o): Ditto.\n\t(m2/gm2-libs-boot/wrapc.o): Ditto.\n\t(m2/gm2-libs-boot/M2LINK.o): Ditto.\n\t(m2/gm2-libs-boot/UnixArgs.o): Ditto.\n\t(m2/gm2-libs-boot/choosetemp.o): Ditto.\n\t(m2/gm2-libs-boot/errno.o): Ditto.\n\t(m2/gm2-libs-boot/dtoa.o): Ditto.\n\t(m2/gm2-libs-boot/ldtoa.o): Ditto.\n\t(m2/gm2-libs-boot/termios.o): Ditto.\n\t(m2/gm2-libs-boot/SysExceptions.o): Ditto.\n\t(m2/gm2-libs-boot/SysStorage.o): Ditto.\n\t(m2/gm2-compiler-boot/M2GCCDeclare.o): Ditto.\n\t(m2/gm2-compiler-boot/M2Error.o): Ditto.\n\t(m2/gm2-compiler-boot/%.o): Ditto.\n\t(m2/gm2-compiler-boot/$(SRC_PREFIX)%.h): Ditto.\n\t(m2/gm2-compiler-boot/m2flex.o): Ditto.\n\t(m2/gm2-compiler/m2flex.c): Ditto.\n\t(m2/gm2-libiberty/$(SRC_PREFIX)%.h): Ditto.\n\t(m2/gm2-compiler/%.o): Ditto.\n\t(m2/gm2-compiler/m2flex.o): Ditto.\n\t(m2/gm2-compiler/%.o): Ditto.\n\t(m2/gm2-libs-iso/%.o): Ditto.\n\t(m2/gm2-libs/gm2-libs-host.h): Ditto.\n\t($(objdir)/m2/gm2-libs-min/SYSTEM.def): Ditto.\n\t($(objdir)/m2/gm2-libs/SYSTEM.def): Ditto.\n\t($(objdir)/m2/gm2-libs-iso/SYSTEM.def):\tDitto.\n\t($(objdir)/m2/gm2-libs-coroutines/SYSTEM.def): Ditto.\n\t(m2/gm2-compiler/gm2.a): Ditto.\n\t(m2/gm2-libs-boot/libgm2.a): Ditto.\n\t(m2/gm2-compiler-boot/gm2.a): Ditto.\n\t(m2/boot-bin/mklink$(exeext)): Ditto.\n\t(m2/gm2-compiler-boot/$(SRC_PREFIX)%.h): Ditto.\n\t(m2/gm2-compiler/%.mod): Ditto.\n\t(m2/gm2-compiler-boot/%.mod): Ditto.\n\t(m2/pge-boot/%.o): Ditto.\n\nSigned-off-by: Gaius Mulley <gaiusmod2@gmail.com>", "tree": {"sha": "0f50bea8a02fb3ea5e630237f6f254369508d0f3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0f50bea8a02fb3ea5e630237f6f254369508d0f3"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8d2c5b6101426f036bec7940aa29bf7bb8c4abc9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8d2c5b6101426f036bec7940aa29bf7bb8c4abc9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8d2c5b6101426f036bec7940aa29bf7bb8c4abc9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8d2c5b6101426f036bec7940aa29bf7bb8c4abc9/comments", "author": null, "committer": null, "parents": [{"sha": "c9aef107ce697f58a34734d82f8d2514405c9be0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c9aef107ce697f58a34734d82f8d2514405c9be0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c9aef107ce697f58a34734d82f8d2514405c9be0"}], "stats": {"total": 183, "additions": 102, "deletions": 81}, "files": [{"sha": "5b1858bfa508b94cede9e5fbb7427cf342536036", "filename": "gcc/doc/gm2.texi", "status": "modified", "additions": 15, "deletions": 15, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8d2c5b6101426f036bec7940aa29bf7bb8c4abc9/gcc%2Fdoc%2Fgm2.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8d2c5b6101426f036bec7940aa29bf7bb8c4abc9/gcc%2Fdoc%2Fgm2.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdoc%2Fgm2.texi?ref=8d2c5b6101426f036bec7940aa29bf7bb8c4abc9", "patch": "@@ -73,7 +73,7 @@ Boston, MA 02110-1301, USA@*\n * License::          License of GNU Modula-2\n * Copying::          GNU Public License V3.\n * Contributing::     Contributing to GNU Modula-2\n-* Internals::        GNU Modula-2 internals.\n+@c * Internals::        GNU Modula-2 internals.\n * EBNF::             EBNF of GNU Modula-2\n * Libraries::        PIM and ISO library definitions.\n * Indices::          Document and function indices.\n@@ -243,7 +243,7 @@ such as the AVR and the ARM).\n * Built-ins::             Accessing GNU Modula-2 Built-ins.\n * The PIM system module:: SYSTEM data types and procedures.\n * The ISO system module:: SYSTEM data types, procedures and run time.\n-@ifnothtml\n+@c @ifnothtml\n @c omit these nodes if generating gm2 webpage as these are hand written.\n * Release map:: Release map.\n * Documentation:: Placeholder for how to access the documentation online.\n@@ -253,7 +253,7 @@ such as the AVR and the ARM).\n * FAQ:: Frequently asked questions.\n * Community:: How to join the community.\n * Other languages:: Other languages for GCC.\n-@end ifnothtml\n+@c @end ifnothtml\n @end menu\n \n This document contains the user and design issues relevant to the\n@@ -2658,7 +2658,7 @@ you wish to see something different please email\n @section Documentation\n \n The GNU Modula-2 documentation is available on line\n-@url{https://www.nongnu.org/gm2/homepage.html,at the gm2 homepage}\n+@url{https://gcc.gnu.org/onlinedocs}\n or in the pdf, info, html file format.\n \n @node Regression tests, Limitations, Documentation, Using\n@@ -2746,7 +2746,7 @@ The mailing list contents can be viewed\n These exist and can be found on the frontends web page on the\n @uref{http://gcc.gnu.org/frontends.html, gcc web site}.\n \n-@node License, Copying, Using, Top\n+@node License, , ,\n @section License of GNU Modula-2\n \n GNU Modula-2 is free software, the compiler is held under the GPL v3\n@@ -2766,10 +2766,10 @@ see the files COPYING3 and COPYING.RUNTIME respectively.  If not, see\n More information on how these licenses work is available\n @uref{http://www.gnu.org/licenses/licenses.html} on the GNU web site.\n \n-@c Copying node is inside the gpl_v3.texi\n-@include gpl_v3.texi\n+@node Copying, , ,\n+@include gpl_v3_without_node.texi\n \n-@node Contributing, Internals, Copying, Top\n+@node Contributing, , ,\n @section Contributing to GNU Modula-2\n \n Please do and please read the GNU Emacs info under\n@@ -2788,12 +2788,12 @@ coding.  The mailing list may be subscribed via a web interface\n \n Many thanks and enjoy your coding!\n \n-@node Internals, EBNF, Contributing, Top\n+@c @node Internals, , ,\n \n-This section is still being written.\n+@c This section is still being written.\n @c @include gm2-internals.texi\n \n-@node EBNF, Libraries, Internals, Top\n+@node EBNF, , ,\n @chapter EBNF of GNU Modula-2\n \n This chapter contains the EBNF of GNU Modula-2.  This grammar currently\n@@ -2807,14 +2807,14 @@ phase.\n \n @include m2/gm2-ebnf.texi\n \n-@node Libraries, Indices, EBNF, Top\n+@node Libraries, , ,\n @chapter PIM and ISO library definitions\n \n This chapter contains M2F, PIM and ISO libraries.\n \n @include m2/gm2-libs.texi\n \n-@node Indices, , Libraries, Top\n+@node Indices, , ,\n @section Indices\n \n @ifhtml\n@@ -2823,11 +2823,11 @@ This chapter contains M2F, PIM and ISO libraries.\n * Functions::   Function, constants, types, ebnf indices.\n @end menu\n \n-@node Contents, Functions, ,\n+@node Contents, , ,\n @section Section and subsections\n @printindex cp\n \n-@node Functions, , Contents,\n+@node Functions, , ,\n @section Function, constants, types, ebnf indices.\n @end ifhtml\n "}, {"sha": "d1d02a0d78e0b0977acdcb45e49a9b885fb84927", "filename": "gcc/m2/Make-lang.in", "status": "modified", "additions": 87, "deletions": 66, "changes": 153, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8d2c5b6101426f036bec7940aa29bf7bb8c4abc9/gcc%2Fm2%2FMake-lang.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8d2c5b6101426f036bec7940aa29bf7bb8c4abc9/gcc%2Fm2%2FMake-lang.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fm2%2FMake-lang.in?ref=8d2c5b6101426f036bec7940aa29bf7bb8c4abc9", "patch": "@@ -41,16 +41,15 @@ else\n   PLUGINLDFLAGS += -nodefaultlibs\n endif\n \n-TEXISRC = $(objdir)/m2/images/gnu.eps \\\n-          $(srcdir)/doc/gm2.texi \\\n+TEXISRC = $(srcdir)/doc/gm2.texi \\\n           m2/gm2-libs.texi \\\n           m2/gm2-ebnf.texi \\\n           m2/SYSTEM-pim.texi \\\n           m2/SYSTEM-iso.texi \\\n-          m2/Builtins.texi\n+          m2/Builtins.texi \\\n+          m2/gpl_v3_without_node.texi\n \n-RSTSRC = $(objdir)/m2/images/gnu.eps \\\n-          $(srcdir)/doc/gm2.texi \\\n+RSTSRC =  $(srcdir)/doc/gm2.texi \\\n           m2/gm2-libs.rst \\\n           m2/gm2-ebnf.rst \\\n           m2/SYSTEM-pim.rst \\\n@@ -142,43 +141,62 @@ $(DESTDIR)$(man1dir)/$(GM2_INSTALL_NAME)$(man1ext): doc/m2.1 installdirs\n \n m2.dvi: doc/m2.dvi\n \n-doc/m2.dvi: $(TEXISRC)\n+doc/m2.dvi: $(TEXISRC) $(objdir)/m2/images/gnu.eps\n \t$(TEXI2DVI) -c -I $(objdir)/m2 -I $(srcdir)/doc/include -o $@ $(srcdir)/doc/gm2.texi\n \n doc/m2.ps: doc/m2.dvi\n \tdvips -o $@ $<\n \n m2.pdf: doc/m2.pdf\n \n-doc/m2.pdf: $(TEXISRC)\n+doc/m2.pdf: $(TEXISRC) $(objdir)/m2/images/gnu.eps\n \t$(TEXI2PDF) -I $(objdir)/m2 -I $(srcdir)/doc/include $(srcdir)/doc/gm2.texi -o $@\n \n+M2_PDFFILES = doc/m2.pdf\n+\n+m2.install-pdf: $(M2_PDFFILES)\n+\t@$(NORMAL_INSTALL)\n+\ttest -z \"$(pdfdir)/gcc\" || $(mkinstalldirs) \"$(DESTDIR)$(pdfdir)/gcc\"\n+\t@list='$(M2_PDFFILES)'; for p in $$list; do \\\n+\t  if test -f \"$$p\"; then d=; else d=\"$(srcdir)/\"; fi; \\\n+\t  f=$(pdf__strip_dir) \\\n+\t  echo \" $(INSTALL_DATA) '$$d$$p' '$(DESTDIR)$(pdfdir)/gcc/$$f'\"; \\\n+\t  $(INSTALL_DATA) \"$$d$$p\" \"$(DESTDIR)$(pdfdir)/gcc/$$f\"; \\\n+\tdone\n+\n .INTERMEDIATE: m2.pod\n \n-m2.pod: $(TEXISRC)\n+m2.pod: $(TEXISRC) $(objdir)/m2/images/gnu.eps\n \t-$(TEXI2POD) -I $(objdir)/m2 -D m2 < $< > $@\n \n-doc/m2.info: $(TEXISRC)\n+doc/m2.info: $(TEXISRC) $(objdir)/m2/images/gnu.eps\n \tif test \"x$(BUILD_INFO)\" = xinfo; then \\\n \t  rm -f doc/m2.info*; \\\n           $(MAKEINFO) -I$(objdir)/m2 -I$(srcdir)/doc/include \\\n                       -o $@ $(srcdir)/doc/gm2.texi ; \\\n \telse true; fi\n \n $(objdir)/m2/images/gnu.eps: $(srcdir)/m2/images/gnupng\n-\t-test -d m2/images || $(mkinstalldirs) m2/images\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \tcp $(srcdir)/m2/images/gnu.eps $@\n \n+m2.html: $(build_htmldir)/m2/index.html\n+\n+$(build_htmldir)/m2/index.html: $(TEXISRC) $(objdir)/m2/images/gnu.eps\n+\t$(mkinstalldirs) $(@D)\n+\trm -f $(@D)/*\n+\t$(TEXI2HTML) -I $(objdir)/m2 -I $(srcdir)/m2 -I $(gcc_docdir)/include -o $(@D) $<\n+\n # gm2-libs.texi\n \n m2/gm2-libs.texi: gm2-libs.texi-check; @true\n \n ifeq ($(HAVE_PYTHON),yes)\n gm2-libs.texi-check: m2/SYSTEM-pim.texi m2/SYSTEM-iso.texi m2/Builtins.texi \\\n                      $(objdir)/m2/gm2-libs-coroutines/SYSTEM.def\n-\ttest -d m2/gm2-libs-log || $(mkinstalldirs) m2/gm2-libs-log\n-\ttest -d m2/gm2-libs-iso || $(mkinstalldirs) m2/gm2-libs-iso\n-\ttest -d m2/gm2-libs || $(mkinstalldirs) m2/gm2-libs\n+\t-test -d m2/gm2-libs-log || $(mkinstalldirs) m2/gm2-libs-log\n+\t-test -d m2/gm2-libs-iso || $(mkinstalldirs) m2/gm2-libs-iso\n+\t-test -d m2/gm2-libs || $(mkinstalldirs) m2/gm2-libs\n \t$(PYTHON) $(srcdir)/m2/tools-src/def2doc.py -t -uLibraries -s$(srcdir)/m2 -b$(objdir)/m2 -o $(objdir)/m2/gm2-libs.texi\n else\n gm2-libs.texi-check:\n@@ -295,6 +313,9 @@ Builtins.rst-check:  m2/gm2-libs/Builtins.def\n endif\n \t$(STAMP) Builtins.rst-check\n \n+m2/gpl_v3_without_node.texi: doc/include/gpl_v3.texi\n+\tgrep -v \"^@node\" $< > $@\n+\n # Stage hooks:\n # The toplevel makefile has already created stage?/m2 at this point.\n \n@@ -388,7 +409,7 @@ override PLUGINCFLAGS := $(filter-out -mdynamic-no-pic,$(PLUGINCFLAGS))\n \n plugin/m2rte$(soext): $(srcdir)/m2/plugin/m2rte.cc $(GCC_HEADER_DEPENDENCIES_FOR_M2) \\\n         insn-attr-common.h insn-flags.h $(generated_files)\n-\t-test -d plugin || $(mkinstalldirs) plugin\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t$(PLUGINCC) $(PLUGINCFLAGS) -fno-rtti -I. -I$(srcdir) $(INCINTL) -I$(srcdir)/m2 -I$(srcdir)/m2/gm2-gcc -I$(srcdir)/../include -I$(srcdir)/../libcpp/include -Wall $(GMPINC) -Wno-literal-suffix -fPIC -c -o plugin/m2rte.o $(srcdir)/m2/plugin/m2rte.cc\n \t$(PLUGINCC) $(PLUGINCFLAGS) $(PLUGINLDFLAGS) $(PLUGINLIBS) $(LIBINTL) -fno-rtti plugin/m2rte.o -shared -o $@\n \n@@ -496,7 +517,7 @@ cc1gm2$(exeext): m2/stage1/cc1gm2$(exeext) $(m2.prev)\n m2/stage2/cc1gm2$(exeext): m2/stage1/cc1gm2$(exeext) m2/gm2-compiler/m2flex.o $(P) \\\n                             $(GM2_C_OBJS) $(BACKEND) $(LIBDEPS) $(GM2_LIBS) \\\n                             m2/gm2-gcc/rtegraph.o plugin/m2rte$(soext) m2/gm2-libs-boot/M2LINK.o\n-\t-test -d m2/stage2 || $(mkinstalldirs) m2/stage2\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t@$(call LINK_PROGRESS,$(INDEX.m2),start)\n \t+$(LLINKER) $(ALL_CFLAGS) $(LDFLAGS) -o $@ $(GM2_C_OBJS) m2/gm2-compiler/m2flex.o \\\n                             attribs.o \\\n@@ -511,7 +532,7 @@ m2/stage1/cc1gm2$(exeext): gm2$(exeext) m2/gm2-compiler-boot/m2flex.o \\\n                             m2/gm2-gcc/rtegraph.o plugin/m2rte$(soext) \\\n                             m2/gm2-libs-boot/M2LINK.o \\\n                             $(m2.prev)\n-\t-test -d m2/stage1 || $(mkinstalldirs) m2/stage1\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t@$(call LINK_PROGRESS,$(INDEX.m2),start)\n \t+$(LLINKER) $(ALL_CFLAGS) $(LDFLAGS) -o $@ $(GM2_C_OBJS) m2/gm2-compiler-boot/m2flex.o \\\n                             attribs.o \\\n@@ -529,15 +550,15 @@ GCC_HEADER_DEPENDENCIES_FOR_M2 = $(BUILD-BOOT-H) $(TIMEVAR_H) m2/gm2config.h $(C\n         $(generated_files) insn-attr-common.h\n \n m2/gm2-gcc/%.o: $(srcdir)/m2/gm2-gcc/%.cc $(GCC_HEADER_DEPENDENCIES_FOR_M2)\n-\t-test -d m2/gm2-gcc || $(mkinstalldirs) m2/gm2-gcc\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t$(COMPILER) -c -g $(ALL_COMPILERFLAGS) \\\n              $(ALL_CPPFLAGS) $(INCLUDES) $< $(OUTPUT_OPTION)\n \n m2/gm2-gcc/m2configure.o: $(srcdir)/m2/gm2-gcc/m2configure.cc \\\n                $(SYSTEM_H) $(GCC_H) $(CONFIG_H) \\\n                m2/gm2config.h $(TARGET_H) $(PLUGIN_HEADERS) \\\n                $(generated_files) $(C_TREE_H) insn-attr-common.h\n-\t-test -d m2/gm2-gcc || $(mkinstalldirs) m2/gm2-gcc\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t$(COMPILER) $(ALL_COMPILERFLAGS) $(ALL_CPPFLAGS) $(INCLUDES) \\\n          $(DRIVER_DEFINES) \\\n \t\t-DLIBSUBDIR=\\\"$(libsubdir)\\\" \\\n@@ -559,7 +580,7 @@ m2/m2pp.o : $(srcdir)/m2/m2pp.cc $(GCC_HEADER_DEPENDENCIES_FOR_M2)\n \n m2/gm2-gcc/rtegraph.o: $(srcdir)/m2/gm2-gcc/rtegraph.cc $(GCC_HEADER_DEPENDENCIES_FOR_M2) \\\n                        gt-m2-rtegraph.h\n-\t-test -d m2/gm2-gcc || $(mkinstalldirs) m2/gm2-gcc\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t$(COMPILER) -c -g $(GM2GCC) $(ALL_COMPILERFLAGS) \\\n             $(ALL_CPPFLAGS) $(INCLUDES) $< $(OUTPUT_OPTION)\n \n@@ -568,7 +589,7 @@ c-family/m2pp.o : $(srcdir)/m2/m2pp.cc $(GCC_HEADER_DEPENDENCIES_FOR_M2)\n             $(ALL_CPPFLAGS) $(INCLUDES) $< $(OUTPUT_OPTION)\n \n m2/gm2-gcc/$(SRC_PREFIX)%.h: $(srcdir)/m2/gm2-gcc/%.def $(MCDEPS)\n-\t-test -d m2/gm2-gcc || $(mkinstalldirs) m2/gm2-gcc\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t$(MC) -o=$@ $(srcdir)/m2/gm2-gcc/$*.def\n \n # The following tables define the source files which are translated into C using mc\n@@ -1326,19 +1347,19 @@ m2/boot-bin/mc$(exeext): $(BUILD-MC-BOOT-O) $(BUILD-MC-INTERFACE-O) \\\n          mcflex.o m2/gm2-libs-boot/RTcodummy.o -lm\n \n m2/mc-boot/$(SRC_PREFIX)%.o: m2/mc-boot/$(SRC_PREFIX)%.c m2/gm2-libs/gm2-libs-host.h\n-\t-test -d m2/mc-boot || $(mkinstalldirs) m2/mc-boot\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t$(CXX) -g -c -I. -I$(srcdir)/m2/mc-boot-ch -I$(srcdir)/m2/mc-boot -I$(srcdir)/../include -I$(srcdir) $(INCLUDES) $< -o $@\n \n m2/mc-boot-ch/$(SRC_PREFIX)%.o: m2/mc-boot-ch/$(SRC_PREFIX)%.c m2/gm2-libs/gm2-libs-host.h\n-\t-test -d m2/mc-boot-ch || $(mkinstalldirs) m2/mc-boot-ch\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t$(CXX) -DHAVE_CONFIG_H -g -c -I. -Im2/gm2-libs -I$(srcdir)/../include -I$(srcdir) $(INCLUDES) -Im2/gm2-libs $< -o $@\n \n m2/mc-boot-ch/$(SRC_PREFIX)%.o: m2/mc-boot-ch/$(SRC_PREFIX)%.cc m2/gm2-libs/gm2-libs-host.h\n-\t-test -d m2/mc-boot-ch || $(mkinstalldirs) m2/mc-boot-ch\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t$(CXX) -DHAVE_CONFIG_H -g -c -I. -Im2/gm2-libs -I$(srcdir)/../include -I$(srcdir) $(INCLUDES) -Im2/gm2-libs $< -o $@\n \n m2/mc-boot/main.o: $(M2LINK) $(srcdir)/m2/init/mcinit\n-\t-test -d m2/mc-boot || $(mkinstalldirs) m2/mc-boot\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \tunset CC ; $(M2LINK) -s --langc++ --exit --name m2/mc-boot/main.c $(srcdir)/m2/init/mcinit\n \t$(CXX) -g -c -I. -I$(srcdir)/../include -I$(srcdir) $(INCLUDES) m2/mc-boot/main.c -o $@\n \n@@ -1349,152 +1370,152 @@ mcflex.c: $(srcdir)/m2/mc/mc.flex\n \tflex -t $< > $@\n \n m2/gm2-libs-boot/%.o: $(srcdir)/m2/gm2-libs-boot/%.mod $(MCDEPS) $(BUILD-BOOT-H)\n-\t-test -d m2/gm2-libs-boot || $(mkinstalldirs) m2/gm2-libs-boot\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t$(MC) -o=m2/gm2-libs-boot/$*.c $(srcdir)/m2/gm2-libs-boot/$*.mod\n \t$(COMPILER) -c -DIN_GCC $(CFLAGS) $(MCINCLUDES) m2/gm2-libs-boot/$*.c -o $@\n \n m2/gm2-libs-boot/%.o: $(srcdir)/m2/gm2-libs/%.mod $(MCDEPS) $(BUILD-BOOT-H)\n-\t-test -d m2/gm2-libs-boot || $(mkinstalldirs) m2/gm2-libs-boot\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t$(MC) -o=m2/gm2-libs-boot/$*.c $(srcdir)/m2/gm2-libs/$*.mod\n \t$(COMPILER) -c -DIN_GCC $(CFLAGS) -I$(srcdir)/m2 -Im2 -I. -Im2/gm2-libs-boot $(MCINCLUDES) $(INCLUDES) m2/gm2-libs-boot/$*.c -o $@\n \n m2/gm2-libs-boot/$(SRC_PREFIX)%.h: $(srcdir)/m2/gm2-libs/%.def $(MCDEPS)\n-\t-test -d m2/gm2-libs-boot || $(mkinstalldirs) m2/gm2-libs-boot\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t$(MC) -o=$@ $(srcdir)/m2/gm2-libs/$*.def\n \n m2/gm2-libs-boot/RTcodummy.o: $(srcdir)/m2/gm2-libs-ch/RTcodummy.c m2/gm2-libs/gm2-libs-host.h\n-\t-test -d m2/gm2-libs-boot || $(mkinstalldirs) m2/gm2-libs-boot\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t$(CXX) -c -DIN_GCC $(CFLAGS) -Im2/gm2-libs -I$(srcdir)/m2 -Im2 -I. -Im2/gm2-libs-boot $(INCLUDES) $< -o $@\n \n m2/gm2-libs-boot/RTintdummy.o: $(srcdir)/m2/gm2-libs-ch/RTintdummy.c m2/gm2-libs/gm2-libs-host.h\n-\t-test -d m2/gm2-libs-boot || $(mkinstalldirs) m2/gm2-libs-boot\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t$(CXX) -c -DIN_GCC $(CFLAGS) -Im2/gm2-libs -I$(srcdir)/m2 -Im2 -I. -Im2/gm2-libs-boot $(INCLUDES) $< -o $@\n \n m2/gm2-libs-boot/wrapc.o: $(srcdir)/m2/gm2-libs-ch/wrapc.c m2/gm2-libs-boot/$(SRC_PREFIX)wrapc.h m2/gm2-libs/gm2-libs-host.h\n-\t-test -d m2/gm2-libs-boot || $(mkinstalldirs) m2/gm2-libs-boot\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t$(CXX) -c -DHAVE_CONFIG_H $(CFLAGS) -Im2/gm2-libs -I$(srcdir)/m2 -Im2 -I. -Im2/gm2-libs-boot -Im2/gm2-libs $(INCLUDES) $< -o $@\n \n m2/gm2-libs-boot/M2LINK.o: $(srcdir)/m2/gm2-libs-ch/M2LINK.c m2/gm2-libs-boot/$(SRC_PREFIX)M2LINK.h m2/gm2-libs/gm2-libs-host.h\n-\t-test -d m2/gm2-libs-boot || $(mkinstalldirs) m2/gm2-libs-boot\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t$(CXX) -c -DHAVE_CONFIG_H $(CFLAGS) -Im2/gm2-libs -I$(srcdir)/m2 -Im2 -I. -Im2/gm2-libs-boot -Im2/gm2-libs $(INCLUDES) $< -o $@\n \n m2/gm2-libs-boot/UnixArgs.o: $(srcdir)/m2/gm2-libs-ch/UnixArgs.cc m2/gm2-libs-boot/$(SRC_PREFIX)UnixArgs.h m2/gm2-libs/gm2-libs-host.h\n-\t-test -d m2/gm2-libs-boot || $(mkinstalldirs) m2/gm2-libs-boot\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t$(CXX) -c -DIN_GCC $(CFLAGS) -Im2/gm2-libs -I$(srcdir)/m2 -Im2 -I. -Im2/gm2-libs-boot $(INCLUDES) $< -o $@\n \n m2/gm2-libs-boot/choosetemp.o: m2/gm2-libs-ch/choosetemp.c m2/gm2-libiberty/Gchoosetemp.h m2/gm2-libs/gm2-libs-host.h\n-\t-test -d m2/gm2-libs-boot || $(mkinstalldirs) m2/gm2-libs-boot\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t$(CXX) -c $(CFLAGS) -Im2/gm2-libs -I$(srcdir)/m2 -Im2 -I. -Im2/gm2-libs-boot -Im2/gm2-libiberty -I$(srcdir)/m2/gm2-libiberty/ $(INCLUDES) $< -o $@\n \n m2/gm2-libs-boot/errno.o: $(srcdir)/m2/gm2-libs-ch/errno.c m2/gm2-libs-boot/$(SRC_PREFIX)errno.h m2/gm2-libs/gm2-libs-host.h\n-\t-test -d m2/gm2-libs-boot || $(mkinstalldirs) m2/gm2-libs-boot\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t$(CXX) -c $(CFLAGS) -Im2/gm2-libs -I$(srcdir)/m2 -Im2 -I. -Im2/gm2-libs-boot $(INCLUDES) $< -o $@\n \n m2/gm2-libs-boot/dtoa.o: $(srcdir)/m2/gm2-libs-ch/dtoa.cc m2/gm2-libs/gm2-libs-host.h\n-\t-test -d m2/gm2-libs-boot || $(mkinstalldirs) m2/gm2-libs-boot\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t$(CXX) -c $(CFLAGS) -Im2/gm2-libs -I$(srcdir)/m2 -Im2 -I. -Im2/gm2-libs-boot $(INCLUDES) $< -o $@\n \n m2/gm2-libs-boot/ldtoa.o: $(srcdir)/m2/gm2-libs-ch/ldtoa.cc m2/gm2-libs/gm2-libs-host.h\n-\t-test -d m2/gm2-libs-boot || $(mkinstalldirs) m2/gm2-libs-boot\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t$(CXX) -c $(CFLAGS) -Im2/gm2-libs -I$(srcdir)/m2 -Im2 -I. -Im2/gm2-libs-boot $(INCLUDES) $< -o $@\n \n m2/gm2-libs-boot/termios.o: $(srcdir)/m2/gm2-libs-ch/termios.c $(BUILD-LIBS-BOOT-H) m2/gm2-libs/gm2-libs-host.h\n-\t-test -d m2/gm2-libs-boot || $(mkinstalldirs) m2/gm2-libs-boot\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t$(CXX) -c $(CFLAGS) -Im2/gm2-libs -I$(srcdir)/m2 -Im2 -I. -Im2/gm2-libs-boot $(INCLUDES) $< -o $@\n \n m2/gm2-libs-boot/SysExceptions.o: $(srcdir)/m2/gm2-libs-ch/SysExceptions.c \\\n                                   m2/gm2-libs-boot/$(SRC_PREFIX)SysExceptions.h m2/gm2-libs/gm2-libs-host.h\n-\t-test -d m2/gm2-libs-boot || $(mkinstalldirs) m2/gm2-libs-boot\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t$(CXX) -c $(CFLAGS) -Im2/gm2-libs -I$(srcdir)/m2 -Im2 -I. -Im2/gm2-libs-boot $(INCLUDES) $< -o $@\n \n m2/gm2-libs-boot/SysStorage.o: $(srcdir)/m2/gm2-libs/SysStorage.mod $(MCDEPS) $(BUILD-BOOT-H)\n-\t-test -d m2/gm2-libs-boot || $(mkinstalldirs) m2/gm2-libs-boot\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t$(MC) -o=m2/gm2-libs-boot/SysStorage.c $(srcdir)/m2/gm2-libs/SysStorage.mod\n \t$(COMPILER) -DIN_GCC -c $(CFLAGS) \\\n           -I$(srcdir)/m2 -Im2 -I. -Im2/gm2-libs-boot $(MCINCLUDES) $(INCLUDES) \\\n           m2/gm2-libs-boot/SysStorage.c -o m2/gm2-libs-boot/SysStorage.o\n \n m2/gm2-compiler-boot/M2GCCDeclare.o: $(srcdir)/m2/gm2-compiler/M2GCCDeclare.mod $(MCDEPS) $(BUILD-BOOT-H)\n-\t-test -d m2/gm2-compiler-boot || $(mkinstalldirs) m2/gm2-compiler-boot\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t$(MC) --extended-opaque -o=m2/gm2-compiler-boot/M2GCCDeclare.c $<\n \t$(COMPILER) -c $(ALL_COMPILERFLAGS) $(ALL_CPPFLAGS) $(GM2GCC) \\\n             -I. -I$(srcdir)/../include -I$(srcdir) \\\n             -I. -Im2/gm2-libs-boot -Im2/gm2-compiler-boot \\\n             -I$(srcdir)/m2/gm2-libiberty $(MCINCLUDES) $(INCLUDES) m2/gm2-compiler-boot/M2GCCDeclare.c -o $@\n \n m2/gm2-compiler-boot/M2Error.o: $(srcdir)/m2/gm2-compiler/M2Error.mod $(MCDEPS) $(BUILD-BOOT-H)\n-\t-test -d m2/gm2-compiler-boot || $(mkinstalldirs) m2/gm2-compiler-boot\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t$(MC) --extended-opaque -o=m2/gm2-compiler-boot/M2Error.c $<\n \t$(COMPILER) -c $(ALL_COMPILERFLAGS) $(ALL_CPPFLAGS) $(GM2GCC) \\\n             -I. -I$(srcdir)/../include -I$(srcdir) \\\n             -I. -Im2/gm2-libs-boot -Im2/gm2-compiler-boot \\\n             -I$(srcdir)/m2/gm2-libiberty $(MCINCLUDES) $(INCLUDES) m2/gm2-compiler-boot/M2Error.c -o $@\n \n m2/gm2-compiler-boot/%.o: $(srcdir)/m2/gm2-compiler/%.mod $(BUILD-BOOT-H) $(MCDEPS) $(BUILD-BOOT-H)\n-\t-test -d m2/gm2-compiler-boot || $(mkinstalldirs) m2/gm2-compiler-boot\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t$(MC) -o=m2/gm2-compiler-boot/$*.c $(srcdir)/m2/gm2-compiler/$*.mod\n \t$(COMPILER) -c $(ALL_COMPILERFLAGS) $(ALL_CPPFLAGS) $(GM2GCC) \\\n             -I. -I$(srcdir)/../include -I$(srcdir) \\\n             -I. -Im2/gm2-libs-boot -Im2/gm2-compiler-boot -Im2/gm2-libiberty \\\n             -I$(srcdir)/m2/gm2-libiberty $(MCINCLUDES) $(INCLUDES) m2/gm2-compiler-boot/$*.c -o $@\n \n m2/gm2-compiler-boot/%.o: m2/gm2-compiler-boot/%.mod $(MCDEPS) $(BUILD-BOOT-H)\n-\t-test -d m2/gm2-compiler-boot || $(mkinstalldirs) m2/gm2-compiler-boot\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t$(MC) -o=m2/gm2-compiler-boot/$*.c m2/gm2-compiler-boot/$*.mod\n \t$(COMPILER) -c $(ALL_COMPILERFLAGS) $(ALL_CPPFLAGS) $(GM2GCC) \\\n             -I. -I$(srcdir)/../include -I$(srcdir) \\\n             -I. -Im2/gm2-libs-boot -Im2/gm2-compiler-boot \\\n             -I$(srcdir)/m2/gm2-libiberty $(MCINCLUDES) $(INCLUDES) m2/gm2-compiler-boot/$*.c -o $@\n \n m2/gm2-compiler-boot/$(SRC_PREFIX)%.h: $(srcdir)/m2/gm2-compiler/%.def $(MCDEPS)\n-\t-test -d m2/gm2-compiler-boot || $(mkinstalldirs) m2/gm2-compiler-boot\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t$(MC) -o=$@ $(srcdir)/m2/gm2-compiler/$*.def\n \n m2/gm2-compiler-boot/m2flex.o: m2/gm2-compiler/m2flex.c $(BUILD-BOOT-H) $(TIMEVAR_H) \\\n         $(BUILD-LIBS-BOOT-H)  m2/gm2-compiler-boot/$(SRC_PREFIX)NameKey.h \\\n         $(CONFIG_H) m2/gm2config.h $(TARGET_H) $(PLUGIN_HEADERS)\n-\t-test -d m2/gm2-compiler-boot || $(mkinstalldirs) m2/gm2-compiler-boot\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t$(COMPILER) -c -g $(ALL_COMPILERFLAGS) $(ALL_CPPFLAGS) $(INCLUDES) \\\n           $(GM2GCC) $(INCLUDES) -I$(srcdir)/m2 \\\n           -Im2 -Im2/gm2-compiler-boot -Im2/gm2-libs-boot $< -o $@\n \n m2/gm2-compiler/m2flex.c: $(srcdir)/m2/m2.flex $(TIMEVAR_H) insn-attr-common.h\n-\t-test -d m2/gm2-compiler || $(mkinstalldirs) m2/gm2-compiler\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \tflex -t $< | sed -e 's/ malloc/ xmalloc/' | sed -e 's/ realloc/ xrealloc/' > $@\n \n m2/gm2-libiberty/$(SRC_PREFIX)%.h: $(srcdir)/m2/gm2-libiberty/%.def $(MCDEPS)\n-\t-test -d m2/gm2-libiberty || $(mkinstalldirs) m2/gm2-libiberty\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t$(MC) -o=$@ $(srcdir)/m2/gm2-libiberty/$*.def\n \n # The rules to build objects in gm2-compiler and gm2-libs directories.\n \n m2/gm2-compiler/%.o: $(srcdir)/m2/gm2-compiler/%.mod\n-\t-test -d m2/gm2-compiler || $(mkinstalldirs) m2/gm2-compiler\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t$(GM2_1) $(GM2_FLAGS) -c -I$(srcdir)/m2/gm2-compiler -I$(srcdir)/m2/gm2-libs -I$(srcdir)/m2/gm2-gcc -I$(srcdir)/m2/gm2-libiberty $< -o $@\n \n m2/gm2-compiler/m2flex.o: m2/gm2-compiler/m2flex.c m2/gm2-libs/gm2-libs-host.h $(TIMEVAR_H)\n-\t-test -d m2/gm2-compiler || $(mkinstalldirs) m2/gm2-compiler\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t$(COMPILER) -c -g $(ALL_COMPILERFLAGS) $(ALL_CPPFLAGS) $(INCLUDES) \\\n           $(GM2GCC) -Im2/gm2-compiler-boot -Im2/gm2-libs-boot $< -o $@\n \n m2/gm2-compiler/%.o: m2/gm2-compiler/%.mod\n-\t-test -d m2/gm2-compiler || $(mkinstalldirs) m2/gm2-compiler\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t$(GM2_1) $(GM2_FLAGS) -c -I$(srcdir)/m2/gm2-compiler -I$(srcdir)/m2/gm2-libs -I$(srcdir)/m2/gm2-gcc -I$(srcdir)/m2/gm2-libiberty $< -o $@\n \n m2/gm2-libs-iso/%.o: $(srcdir)/m2/gm2-libs-iso/%.c m2/gm2-libs/gm2-libs-host.h\n-\t-test -d m2/gm2-libs-iso || $(mkinstalldirs) m2/gm2-libs-iso\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t$(CXX) -DBUILD_GM2_LIBS_TARGET -DBUILD_GM2_LIBS -c $(CFLAGS) -Im2/gm2-libs -I$(srcdir)/m2 -Im2/gm2-libs-boot $(INCLUDES) $< -o $@\n \n m2/gm2-libs-iso/%.o: $(srcdir)/m2/gm2-libs-iso/%.mod\n-\t-test -d m2/gm2-libs-iso || $(mkinstalldirs) m2/gm2-libs-iso\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t$(GM2_1) $(GM2_ISO_FLAGS) -c -B./ -Im2/gm2-libs-iso:$(srcdir)/m2/gm2-libs-iso -I$(srcdir)/m2/gm2-libs $< -o $@\n \n \n # We build the cc1gm2$(exeext) from the boot stage and then proceed to build it\n # again using itself.\n \n m2/gm2-libs/gm2-libs-host.h:\n-\t-test -d m2/gm2-libs || $(mkinstalldirs) m2/gm2-libs\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \techo \"Configuring to build libraries using native compiler\" ; \\\n         NEW_SRCDIR=`${srcdir}/m2/tools-src/calcpath ../../ ${srcdir} m2/gm2-libs` ; \\\n         export NEW_SRCDIR ; \\\n@@ -1529,15 +1550,15 @@ m2/gm2config.aci:\n         fi\n \n $(objdir)/m2/gm2-libs-min/SYSTEM.def: $(GM2_PROG_DEP)\n-\t-test -d m2/gm2-libs-min || $(mkinstalldirs) m2/gm2-libs-min\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t$(SHELL) $(srcdir)/m2/tools-src/makeSystem -fpim \\\n              $(srcdir)/m2/gm2-libs-min/SYSTEM.def \\\n              $(srcdir)/m2/gm2-libs-min/SYSTEM.mod \\\n              -I$(srcdir)/m2/gm2-libs-min -I$(srcdir)/m2/gm2-libs \\\n              \"$(GM2_FOR_TARGET)\" $@\n \n $(objdir)/m2/gm2-libs/SYSTEM.def: $(GM2_PROG_DEP)\n-\t-test -d m2/gm2-libs || $(mkinstalldirs) m2/gm2-libs\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \techo \"GM2_FOR_TARGET $(GM2_FOR_TARGET)\"\n \techo \"GCC_FOR_TARGET $(GCC_FOR_TARGET)\"\n \t$(SHELL) $(srcdir)/m2/tools-src/makeSystem -fpim \\\n@@ -1547,15 +1568,15 @@ $(objdir)/m2/gm2-libs/SYSTEM.def: $(GM2_PROG_DEP)\n              \"$(GM2_FOR_TARGET)\" $@\n \n $(objdir)/m2/gm2-libs-iso/SYSTEM.def: $(GM2_PROG_DEP)\n-\t-test -d m2/gm2-libs-iso || $(mkinstalldirs) m2/gm2-libs-iso\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t$(SHELL) $(srcdir)/m2/tools-src/makeSystem -fiso \\\n              $(srcdir)/m2/gm2-libs-iso/SYSTEM.def \\\n              $(srcdir)/m2/gm2-libs-iso/SYSTEM.mod \\\n              -I$(srcdir)/m2/gm2-libs-iso -I$(srcdir)/m2/gm2-libs \\\n              \"$(GM2_FOR_TARGET)\" $@\n \n $(objdir)/m2/gm2-libs-coroutines/SYSTEM.def: $(GM2_PROG_DEP)\n-\t-test -d m2/gm2-libs-coroutines || $(mkinstalldirs) m2/gm2-libs-coroutines\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t$(SHELL) $(srcdir)/m2/tools-src/makeSystem -fpim \\\n              $(srcdir)/m2/gm2-libs-coroutines/SYSTEM.def \\\n              $(srcdir)/m2/gm2-libs-coroutines/SYSTEM.mod \\\n@@ -1567,41 +1588,41 @@ build-compiler: $(GM2-COMP-MODS:%.mod=m2/gm2-compiler/%.o) \\\n                 m2/gm2-compiler/m2flex.o\n \n m2/gm2-compiler/gm2.a: build-compiler gm2$(exeext)\n-\t-test -d m2/gm2-compiler || $(mkinstalldirs) m2/gm2-compiler\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t$(AR_FOR_TARGET) cr $@ $(GM2-COMP-MODS:%.mod=m2/gm2-compiler/%.o) \\\n                     $(GM2-AUTO-MODS:%.mod=m2/gm2-compiler/%.o)\n \t$(RANLIB) $@\n \n m2/gm2-libs-boot/libgm2.a: m2/boot-bin/mc$(exeext) $(BUILD-LIBS-BOOT)\n-\t-test -d m2/gm2-libs-boot || $(mkinstalldirs) m2/gm2-libs-boot\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t$(AR) cr $@ $(GM2-LIBS-BOOT-MODS:%.mod=m2/gm2-libs-boot/%.o) \\\n                     $(GM2-LIBS-BOOT-CC:%.cc=m2/gm2-libs-boot/%.o) \\\n                     $(GM2-LIBS-BOOT-C:%.c=m2/gm2-libs-boot/%.o)\n \t$(RANLIB) $@\n \n m2/gm2-compiler-boot/gm2.a: m2/boot-bin/mc$(exeext) m2/boot-bin/mklink$(exeext) \\\n                          $(BUILD-LIBS-BOOT) $(BUILD-COMPILER-BOOT)\n-\t-test -d m2/gm2-compiler || $(mkinstalldirs) m2/gm2-compiler\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t$(AR) cr $@ $(GM2-COMP-BOOT-MODS:%.mod=m2/gm2-compiler-boot/%.o) \\\n                     $(GM2-AUTO-MODS:%.mod=m2/gm2-compiler-boot/%.o)\n \t$(RANLIB) $@\n \n m2/gm2-compiler-boot/gm2.a: m2/boot-bin/mc$(exeext)\n \n m2/boot-bin/mklink$(exeext): $(srcdir)/m2/tools-src/mklink.c\n-\t-test -d m2/boot-bin || $(mkinstalldirs) m2/boot-bin\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t$(CXX) $(CFLAGS) -I$(srcdir)/m2 -Im2/gm2-libs-boot -Im2/gm2-compiler-boot -I$(srcdir)/m2/mc-boot-ch $(INCLUDES) $< -o $@\n \n m2/gm2-compiler-boot/$(SRC_PREFIX)%.h: $(srcdir)/m2/gm2-compiler-boot/%.def $(MCDEPS)\n-\t-test -d m2/gm2-compiler-boot || $(mkinstalldirs) m2/gm2-compiler-boot\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t$(MC) --quiet -o=$@ $(srcdir)/m2/gm2-compiler-boot/$*.def\n \n m2/gm2-compiler/%.mod: $(srcdir)/m2/gm2-compiler/%.bnf $(PGE)\n-\t-test -d m2/gm2-compiler || $(mkinstalldirs) m2/gm2-compiler\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t$(PGE) -k -l $< -o $@\n \n m2/gm2-compiler-boot/%.mod: $(srcdir)/m2/gm2-compiler/%.bnf $(PGE)\n-\t-test -d m2/gm2-compiler-boot || $(mkinstalldirs) m2/gm2-compiler-boot\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t$(PGE) -k -l $< -o $@\n \n check-m2: check-gm2\n@@ -1670,11 +1691,11 @@ ifeq ($(M2_MAINTAINER),yes)\n include m2/Make-maintainer\n else\n m2/pge-boot/%.o: m2/pge-boot/%.c m2/gm2-libs/gm2-libs-host.h m2/gm2config.h\n-\t-test -d m2/pge-boot ||$(mkinstalldirs) m2/pge-boot\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t$(CXX) $(INCLUDES) -I$(srcdir)/m2/pge-boot -Im2/gm2-libs -g -c $< -o $@\n \n m2/pge-boot/%.o: m2/pge-boot/%.cc m2/gm2-libs/gm2-libs-host.h m2/gm2config.h\n-\t-test -d m2/pge-boot || $(mkinstalldirs) m2/pge-boot\n+\t-test -d $(@D) || $(mkinstalldirs) $(@D)\n \t$(CXX) $(INCLUDES) -I$(srcdir)/m2/pge-boot -Im2/gm2-libs -g -c $< -o $@\n \n $(PGE): $(BUILD-PGE-O)"}]}