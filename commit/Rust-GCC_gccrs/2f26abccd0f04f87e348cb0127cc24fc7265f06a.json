{"sha": "2f26abccd0f04f87e348cb0127cc24fc7265f06a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MmYyNmFiY2NkMGYwNGY4N2UzNDhjYjAxMjdjYzI0ZmM3MjY1ZjA2YQ==", "commit": {"author": {"name": "Bob Duff", "email": "duff@adacore.com", "date": "2019-10-10T15:23:08Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "pmderodat@gcc.gnu.org", "date": "2019-10-10T15:23:08Z"}, "message": "[Ada] Replace in Ordered_Maps gets tampering failure\n\n2019-10-10  Bob Duff  <duff@adacore.com>\n\ngcc/ada/\n\n\t* libgnat/a-cbdlli.adb, libgnat/a-cbhama.adb,\n\tlibgnat/a-cbhase.adb, libgnat/a-cbmutr.adb,\n\tlibgnat/a-cborma.adb, libgnat/a-cborse.adb,\n\tlibgnat/a-cdlili.adb, libgnat/a-cidlli.adb,\n\tlibgnat/a-cihama.adb, libgnat/a-cihase.adb,\n\tlibgnat/a-cimutr.adb, libgnat/a-ciorma.adb,\n\tlibgnat/a-ciorse.adb, libgnat/a-cobove.adb,\n\tlibgnat/a-cohama.adb, libgnat/a-cohase.adb,\n\tlibgnat/a-coinve.adb, libgnat/a-comutr.adb,\n\tlibgnat/a-conhel.adb, libgnat/a-convec.adb,\n\tlibgnat/a-coorma.adb, libgnat/a-coorse.adb (Reference,\n\tConstant_Reference): Use Busy instead of Lock, so we forbid\n\ttampering with cursors, rather than tampering with elements.\n\nFrom-SVN: r276813", "tree": {"sha": "afd78d8c1adee62fbb28d8d105c091e1def96139", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/afd78d8c1adee62fbb28d8d105c091e1def96139"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2f26abccd0f04f87e348cb0127cc24fc7265f06a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2f26abccd0f04f87e348cb0127cc24fc7265f06a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2f26abccd0f04f87e348cb0127cc24fc7265f06a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2f26abccd0f04f87e348cb0127cc24fc7265f06a/comments", "author": {"login": "bobduff", "id": 29099567, "node_id": "MDQ6VXNlcjI5MDk5NTY3", "avatar_url": "https://avatars.githubusercontent.com/u/29099567?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bobduff", "html_url": "https://github.com/bobduff", "followers_url": "https://api.github.com/users/bobduff/followers", "following_url": "https://api.github.com/users/bobduff/following{/other_user}", "gists_url": "https://api.github.com/users/bobduff/gists{/gist_id}", "starred_url": "https://api.github.com/users/bobduff/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bobduff/subscriptions", "organizations_url": "https://api.github.com/users/bobduff/orgs", "repos_url": "https://api.github.com/users/bobduff/repos", "events_url": "https://api.github.com/users/bobduff/events{/privacy}", "received_events_url": "https://api.github.com/users/bobduff/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "c223b7646bff69adeea080fdddc499b30179efec", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c223b7646bff69adeea080fdddc499b30179efec", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c223b7646bff69adeea080fdddc499b30179efec"}], "stats": {"total": 209, "additions": 109, "deletions": 100}, "files": [{"sha": "745c7b57b164762310fe15aa99233c4b35758fce", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 14, "deletions": 5, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f26abccd0f04f87e348cb0127cc24fc7265f06a/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f26abccd0f04f87e348cb0127cc24fc7265f06a/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=2f26abccd0f04f87e348cb0127cc24fc7265f06a", "patch": "@@ -1,6 +1,15 @@\n-2019-10-10  Ed Schonberg  <schonberg@adacore.com>\n+2019-10-10  Bob Duff  <duff@adacore.com>\n \n-\t* sem_cat.adb (Set_Categorization_From_Pragma): Do not modify\n-\tany visibility settings if there are no compilation_unit pragmas\n-\tfollowing the package declaration. Add comments for future\n-\tcleanup.\n\\ No newline at end of file\n+\t* libgnat/a-cbdlli.adb, libgnat/a-cbhama.adb,\n+\tlibgnat/a-cbhase.adb, libgnat/a-cbmutr.adb,\n+\tlibgnat/a-cborma.adb, libgnat/a-cborse.adb,\n+\tlibgnat/a-cdlili.adb, libgnat/a-cidlli.adb,\n+\tlibgnat/a-cihama.adb, libgnat/a-cihase.adb,\n+\tlibgnat/a-cimutr.adb, libgnat/a-ciorma.adb,\n+\tlibgnat/a-ciorse.adb, libgnat/a-cobove.adb,\n+\tlibgnat/a-cohama.adb, libgnat/a-cohase.adb,\n+\tlibgnat/a-coinve.adb, libgnat/a-comutr.adb,\n+\tlibgnat/a-conhel.adb, libgnat/a-convec.adb,\n+\tlibgnat/a-coorma.adb, libgnat/a-coorse.adb (Reference,\n+\tConstant_Reference): Use Busy instead of Lock, so we forbid\n+\ttampering with cursors, rather than tampering with elements.\n\\ No newline at end of file"}, {"sha": "9a2282b2d8553a5f48d7ee24fa3dff534fab47da", "filename": "gcc/ada/libgnat/a-cbdlli.adb", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f26abccd0f04f87e348cb0127cc24fc7265f06a/gcc%2Fada%2Flibgnat%2Fa-cbdlli.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f26abccd0f04f87e348cb0127cc24fc7265f06a/gcc%2Fada%2Flibgnat%2Fa-cbdlli.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flibgnat%2Fa-cbdlli.adb?ref=2f26abccd0f04f87e348cb0127cc24fc7265f06a", "patch": "@@ -304,7 +304,7 @@ package body Ada.Containers.Bounded_Doubly_Linked_Lists is\n            (Element => N.Element'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Constant_Reference;\n@@ -1448,7 +1448,7 @@ package body Ada.Containers.Bounded_Doubly_Linked_Lists is\n       TC : constant Tamper_Counts_Access := Container.TC'Unrestricted_Access;\n    begin\n       return R : constant Reference_Control_Type := (Controlled with TC) do\n-         Lock (TC.all);\n+         Busy (TC.all);\n       end return;\n    end Pseudo_Reference;\n \n@@ -1564,7 +1564,7 @@ package body Ada.Containers.Bounded_Doubly_Linked_Lists is\n            (Element => N.Element'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Reference;"}, {"sha": "d5cc8206222be7b42c74961b28dbbf6b2bcc4b85", "filename": "gcc/ada/libgnat/a-cbhama.adb", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f26abccd0f04f87e348cb0127cc24fc7265f06a/gcc%2Fada%2Flibgnat%2Fa-cbhama.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f26abccd0f04f87e348cb0127cc24fc7265f06a/gcc%2Fada%2Flibgnat%2Fa-cbhama.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flibgnat%2Fa-cbhama.adb?ref=2f26abccd0f04f87e348cb0127cc24fc7265f06a", "patch": "@@ -213,7 +213,7 @@ package body Ada.Containers.Bounded_Hashed_Maps is\n            (Element => N.Element'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Constant_Reference;\n@@ -239,7 +239,7 @@ package body Ada.Containers.Bounded_Hashed_Maps is\n            (Element => N.Element'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Constant_Reference;\n@@ -853,7 +853,7 @@ package body Ada.Containers.Bounded_Hashed_Maps is\n         Container.TC'Unrestricted_Access;\n    begin\n       return R : constant Reference_Control_Type := (Controlled with TC) do\n-         Lock (TC.all);\n+         Busy (TC.all);\n       end return;\n    end Pseudo_Reference;\n \n@@ -987,7 +987,7 @@ package body Ada.Containers.Bounded_Hashed_Maps is\n            (Element => N.Element'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Reference;\n@@ -1012,7 +1012,7 @@ package body Ada.Containers.Bounded_Hashed_Maps is\n            (Element => N.Element'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Reference;"}, {"sha": "1fa2c21c00d81519e2c3599b9cbd4adeda4ef106", "filename": "gcc/ada/libgnat/a-cbhase.adb", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f26abccd0f04f87e348cb0127cc24fc7265f06a/gcc%2Fada%2Flibgnat%2Fa-cbhase.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f26abccd0f04f87e348cb0127cc24fc7265f06a/gcc%2Fada%2Flibgnat%2Fa-cbhase.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flibgnat%2Fa-cbhase.adb?ref=2f26abccd0f04f87e348cb0127cc24fc7265f06a", "patch": "@@ -231,7 +231,7 @@ package body Ada.Containers.Bounded_Hashed_Sets is\n            (Element => N.Element'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Constant_Reference;\n@@ -1077,7 +1077,7 @@ package body Ada.Containers.Bounded_Hashed_Sets is\n         Container.TC'Unrestricted_Access;\n    begin\n       return R : constant Reference_Control_Type := (Controlled with TC) do\n-         Lock (TC.all);\n+         Busy (TC.all);\n       end return;\n    end Pseudo_Reference;\n \n@@ -1606,7 +1606,7 @@ package body Ada.Containers.Bounded_Hashed_Sets is\n               (Element => N.Element'Access,\n                Control => (Controlled with TC))\n             do\n-               Lock (TC.all);\n+               Busy (TC.all);\n             end return;\n          end;\n       end Constant_Reference;\n@@ -1787,7 +1787,7 @@ package body Ada.Containers.Bounded_Hashed_Sets is\n                      Old_Pos  => Position,\n                      Old_Hash => Hash (Key (Position))))\n             do\n-               Lock (Container.TC);\n+               Busy (Container.TC);\n             end return;\n          end;\n       end Reference_Preserving_Key;\n@@ -1816,7 +1816,7 @@ package body Ada.Containers.Bounded_Hashed_Sets is\n                     Old_Pos => P,\n                     Old_Hash => Hash (Key)))\n             do\n-               Lock (Container.TC);\n+               Busy (Container.TC);\n             end return;\n          end;\n       end Reference_Preserving_Key;"}, {"sha": "ad9edaaa142567691775d495cd05798cfe55f4fc", "filename": "gcc/ada/libgnat/a-cbmutr.adb", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f26abccd0f04f87e348cb0127cc24fc7265f06a/gcc%2Fada%2Flibgnat%2Fa-cbmutr.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f26abccd0f04f87e348cb0127cc24fc7265f06a/gcc%2Fada%2Flibgnat%2Fa-cbmutr.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flibgnat%2Fa-cbmutr.adb?ref=2f26abccd0f04f87e348cb0127cc24fc7265f06a", "patch": "@@ -600,7 +600,7 @@ package body Ada.Containers.Bounded_Multiway_Trees is\n            (Element => Container.Elements (Position.Node)'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Constant_Reference;\n@@ -2291,7 +2291,7 @@ package body Ada.Containers.Bounded_Multiway_Trees is\n       TC : constant Tamper_Counts_Access := Container.TC'Unrestricted_Access;\n    begin\n       return R : constant Reference_Control_Type := (Controlled with TC) do\n-         Lock (TC.all);\n+         Busy (TC.all);\n       end return;\n    end Pseudo_Reference;\n \n@@ -2490,7 +2490,7 @@ package body Ada.Containers.Bounded_Multiway_Trees is\n            (Element => Container.Elements (Position.Node)'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Reference;"}, {"sha": "005bca5d0c2ca1ddbcef78667933b7fe208fade0", "filename": "gcc/ada/libgnat/a-cborma.adb", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f26abccd0f04f87e348cb0127cc24fc7265f06a/gcc%2Fada%2Flibgnat%2Fa-cborma.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f26abccd0f04f87e348cb0127cc24fc7265f06a/gcc%2Fada%2Flibgnat%2Fa-cborma.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flibgnat%2Fa-cborma.adb?ref=2f26abccd0f04f87e348cb0127cc24fc7265f06a", "patch": "@@ -420,7 +420,7 @@ package body Ada.Containers.Bounded_Ordered_Maps is\n            (Element => N.Element'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Constant_Reference;\n@@ -445,7 +445,7 @@ package body Ada.Containers.Bounded_Ordered_Maps is\n            (Element => N.Element'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Constant_Reference;\n@@ -1256,7 +1256,7 @@ package body Ada.Containers.Bounded_Ordered_Maps is\n         Container.TC'Unrestricted_Access;\n    begin\n       return R : constant Reference_Control_Type := (Controlled with TC) do\n-         Lock (TC.all);\n+         Busy (TC.all);\n       end return;\n    end Pseudo_Reference;\n \n@@ -1376,7 +1376,7 @@ package body Ada.Containers.Bounded_Ordered_Maps is\n            (Element => N.Element'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Reference;\n@@ -1401,7 +1401,7 @@ package body Ada.Containers.Bounded_Ordered_Maps is\n            (Element => N.Element'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Reference;"}, {"sha": "b55304810b986ecf3ec6d646f13652707b426fb8", "filename": "gcc/ada/libgnat/a-cborse.adb", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f26abccd0f04f87e348cb0127cc24fc7265f06a/gcc%2Fada%2Flibgnat%2Fa-cborse.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f26abccd0f04f87e348cb0127cc24fc7265f06a/gcc%2Fada%2Flibgnat%2Fa-cborse.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flibgnat%2Fa-cborse.adb?ref=2f26abccd0f04f87e348cb0127cc24fc7265f06a", "patch": "@@ -420,7 +420,7 @@ package body Ada.Containers.Bounded_Ordered_Sets is\n            (Element => N.Element'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Constant_Reference;\n@@ -741,7 +741,7 @@ package body Ada.Containers.Bounded_Ordered_Sets is\n               (Element => N.Element'Access,\n                Control => (Controlled with TC))\n             do\n-               Lock (TC.all);\n+               Busy (TC.all);\n             end return;\n          end;\n       end Constant_Reference;\n@@ -937,7 +937,7 @@ package body Ada.Containers.Bounded_Ordered_Sets is\n                               Pos       => Position,\n                               Old_Key   => new Key_Type'(Key (Position))))\n             do\n-               Lock (Container.TC);\n+               Busy (Container.TC);\n             end return;\n          end;\n       end Reference_Preserving_Key;\n@@ -965,7 +965,7 @@ package body Ada.Containers.Bounded_Ordered_Sets is\n                                Pos      => Find (Container, Key),\n                                Old_Key  => new Key_Type'(Key)))\n             do\n-               Lock (Container.TC);\n+               Busy (Container.TC);\n             end return;\n          end;\n       end Reference_Preserving_Key;\n@@ -1598,7 +1598,7 @@ package body Ada.Containers.Bounded_Ordered_Sets is\n         Container.TC'Unrestricted_Access;\n    begin\n       return R : constant Reference_Control_Type := (Controlled with TC) do\n-         Lock (TC.all);\n+         Busy (TC.all);\n       end return;\n    end Pseudo_Reference;\n "}, {"sha": "949fb0f5dac1b63d2dc0f562da2c04346b70416a", "filename": "gcc/ada/libgnat/a-cdlili.adb", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f26abccd0f04f87e348cb0127cc24fc7265f06a/gcc%2Fada%2Flibgnat%2Fa-cdlili.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f26abccd0f04f87e348cb0127cc24fc7265f06a/gcc%2Fada%2Flibgnat%2Fa-cdlili.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flibgnat%2Fa-cdlili.adb?ref=2f26abccd0f04f87e348cb0127cc24fc7265f06a", "patch": "@@ -255,7 +255,7 @@ package body Ada.Containers.Doubly_Linked_Lists is\n            (Element => Position.Node.Element'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Constant_Reference;\n@@ -1226,7 +1226,7 @@ package body Ada.Containers.Doubly_Linked_Lists is\n       TC : constant Tamper_Counts_Access := Container.TC'Unrestricted_Access;\n    begin\n       return R : constant Reference_Control_Type := (Controlled with TC) do\n-         Lock (TC.all);\n+         Busy (TC.all);\n       end return;\n    end Pseudo_Reference;\n \n@@ -1357,7 +1357,7 @@ package body Ada.Containers.Doubly_Linked_Lists is\n            (Element => Position.Node.Element'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Reference;"}, {"sha": "65e4c10fceefc6a2af6629dafdf82e3b1443a838", "filename": "gcc/ada/libgnat/a-cidlli.adb", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f26abccd0f04f87e348cb0127cc24fc7265f06a/gcc%2Fada%2Flibgnat%2Fa-cidlli.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f26abccd0f04f87e348cb0127cc24fc7265f06a/gcc%2Fada%2Flibgnat%2Fa-cidlli.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flibgnat%2Fa-cidlli.adb?ref=2f26abccd0f04f87e348cb0127cc24fc7265f06a", "patch": "@@ -280,7 +280,7 @@ package body Ada.Containers.Indefinite_Doubly_Linked_Lists is\n            (Element => Position.Node.Element,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Constant_Reference;\n@@ -1263,7 +1263,7 @@ package body Ada.Containers.Indefinite_Doubly_Linked_Lists is\n       TC : constant Tamper_Counts_Access := Container.TC'Unrestricted_Access;\n    begin\n       return R : constant Reference_Control_Type := (Controlled with TC) do\n-         Lock (TC.all);\n+         Busy (TC.all);\n       end return;\n    end Pseudo_Reference;\n \n@@ -1405,7 +1405,7 @@ package body Ada.Containers.Indefinite_Doubly_Linked_Lists is\n            (Element => Position.Node.Element,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Reference;"}, {"sha": "b33246d3546928850ee0be42972217e0d8b315e2", "filename": "gcc/ada/libgnat/a-cihama.adb", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f26abccd0f04f87e348cb0127cc24fc7265f06a/gcc%2Fada%2Flibgnat%2Fa-cihama.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f26abccd0f04f87e348cb0127cc24fc7265f06a/gcc%2Fada%2Flibgnat%2Fa-cihama.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flibgnat%2Fa-cihama.adb?ref=2f26abccd0f04f87e348cb0127cc24fc7265f06a", "patch": "@@ -220,7 +220,7 @@ package body Ada.Containers.Indefinite_Hashed_Maps is\n            (Element => Position.Node.Element.all'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Constant_Reference;\n@@ -249,7 +249,7 @@ package body Ada.Containers.Indefinite_Hashed_Maps is\n            (Element => Node.Element.all'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Constant_Reference;\n@@ -911,7 +911,7 @@ package body Ada.Containers.Indefinite_Hashed_Maps is\n         Container.HT.TC'Unrestricted_Access;\n    begin\n       return R : constant Reference_Control_Type := (Controlled with TC) do\n-         Lock (TC.all);\n+         Busy (TC.all);\n       end return;\n    end Pseudo_Reference;\n \n@@ -1057,7 +1057,7 @@ package body Ada.Containers.Indefinite_Hashed_Maps is\n            (Element => Position.Node.Element.all'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Reference;\n@@ -1086,7 +1086,7 @@ package body Ada.Containers.Indefinite_Hashed_Maps is\n            (Element => Node.Element.all'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Reference;"}, {"sha": "bec48d06e6fafdb7d840835ce5002a453e2bd900", "filename": "gcc/ada/libgnat/a-cihase.adb", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f26abccd0f04f87e348cb0127cc24fc7265f06a/gcc%2Fada%2Flibgnat%2Fa-cihase.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f26abccd0f04f87e348cb0127cc24fc7265f06a/gcc%2Fada%2Flibgnat%2Fa-cihase.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flibgnat%2Fa-cihase.adb?ref=2f26abccd0f04f87e348cb0127cc24fc7265f06a", "patch": "@@ -239,7 +239,7 @@ package body Ada.Containers.Indefinite_Hashed_Sets is\n            (Element => Position.Node.Element.all'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Constant_Reference;\n@@ -1229,7 +1229,7 @@ package body Ada.Containers.Indefinite_Hashed_Sets is\n         Container.HT.TC'Unrestricted_Access;\n    begin\n       return R : constant Reference_Control_Type := (Controlled with TC) do\n-         Lock (TC.all);\n+         Busy (TC.all);\n       end return;\n    end Pseudo_Reference;\n \n@@ -2044,7 +2044,7 @@ package body Ada.Containers.Indefinite_Hashed_Sets is\n               (Element => Node.Element.all'Access,\n                Control => (Controlled with TC))\n             do\n-               Lock (TC.all);\n+               Busy (TC.all);\n             end return;\n          end;\n       end Constant_Reference;\n@@ -2232,7 +2232,7 @@ package body Ada.Containers.Indefinite_Hashed_Sets is\n                               Old_Pos   => Position,\n                               Old_Hash  => Hash (Key (Position))))\n             do\n-               Lock (HT.TC);\n+               Busy (HT.TC);\n             end return;\n          end;\n       end Reference_Preserving_Key;\n@@ -2266,7 +2266,7 @@ package body Ada.Containers.Indefinite_Hashed_Sets is\n                               Old_Pos   => P,\n                               Old_Hash  => Hash (Key)))\n             do\n-               Lock (HT.TC);\n+               Busy (HT.TC);\n             end return;\n          end;\n       end Reference_Preserving_Key;"}, {"sha": "c5cf22120966ab3b2e0e8b0a1c0252e83b9e2669", "filename": "gcc/ada/libgnat/a-cimutr.adb", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f26abccd0f04f87e348cb0127cc24fc7265f06a/gcc%2Fada%2Flibgnat%2Fa-cimutr.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f26abccd0f04f87e348cb0127cc24fc7265f06a/gcc%2Fada%2Flibgnat%2Fa-cimutr.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flibgnat%2Fa-cimutr.adb?ref=2f26abccd0f04f87e348cb0127cc24fc7265f06a", "patch": "@@ -488,7 +488,7 @@ package body Ada.Containers.Indefinite_Multiway_Trees is\n            (Element => Position.Node.Element.all'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Constant_Reference;\n@@ -1847,7 +1847,7 @@ package body Ada.Containers.Indefinite_Multiway_Trees is\n       TC : constant Tamper_Counts_Access := Container.TC'Unrestricted_Access;\n    begin\n       return R : constant Reference_Control_Type := (Controlled with TC) do\n-         Lock (TC.all);\n+         Busy (TC.all);\n       end return;\n    end Pseudo_Reference;\n \n@@ -2044,7 +2044,7 @@ package body Ada.Containers.Indefinite_Multiway_Trees is\n            (Element => Position.Node.Element.all'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Reference;"}, {"sha": "818a2ae0f60b56a7379d9c7f5624d05f892b7af7", "filename": "gcc/ada/libgnat/a-ciorma.adb", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f26abccd0f04f87e348cb0127cc24fc7265f06a/gcc%2Fada%2Flibgnat%2Fa-ciorma.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f26abccd0f04f87e348cb0127cc24fc7265f06a/gcc%2Fada%2Flibgnat%2Fa-ciorma.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flibgnat%2Fa-ciorma.adb?ref=2f26abccd0f04f87e348cb0127cc24fc7265f06a", "patch": "@@ -374,7 +374,7 @@ package body Ada.Containers.Indefinite_Ordered_Maps is\n            (Element => Position.Node.Element.all'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Constant_Reference;\n@@ -402,7 +402,7 @@ package body Ada.Containers.Indefinite_Ordered_Maps is\n            (Element => Node.Element.all'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Constant_Reference;\n@@ -1250,7 +1250,7 @@ package body Ada.Containers.Indefinite_Ordered_Maps is\n         Container.Tree.TC'Unrestricted_Access;\n    begin\n       return R : constant Reference_Control_Type := (Controlled with TC) do\n-         Lock (TC.all);\n+         Busy (TC.all);\n       end return;\n    end Pseudo_Reference;\n \n@@ -1387,7 +1387,7 @@ package body Ada.Containers.Indefinite_Ordered_Maps is\n            (Element => Position.Node.Element.all'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Reference;\n@@ -1415,7 +1415,7 @@ package body Ada.Containers.Indefinite_Ordered_Maps is\n            (Element => Node.Element.all'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Reference;"}, {"sha": "7cc7dca87cd3b2622e4e164215d9b7c70ed1e061", "filename": "gcc/ada/libgnat/a-ciorse.adb", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f26abccd0f04f87e348cb0127cc24fc7265f06a/gcc%2Fada%2Flibgnat%2Fa-ciorse.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f26abccd0f04f87e348cb0127cc24fc7265f06a/gcc%2Fada%2Flibgnat%2Fa-ciorse.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flibgnat%2Fa-ciorse.adb?ref=2f26abccd0f04f87e348cb0127cc24fc7265f06a", "patch": "@@ -394,7 +394,7 @@ package body Ada.Containers.Indefinite_Ordered_Sets is\n            (Element => Position.Node.Element.all'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Constant_Reference;\n@@ -788,7 +788,7 @@ package body Ada.Containers.Indefinite_Ordered_Sets is\n               (Element => Node.Element.all'Access,\n                Control => (Controlled with TC))\n             do\n-               Lock (TC.all);\n+               Busy (TC.all);\n             end return;\n          end;\n       end Constant_Reference;\n@@ -1017,7 +1017,7 @@ package body Ada.Containers.Indefinite_Ordered_Sets is\n                     Pos       => Position,\n                     Old_Key   => new Key_Type'(Key (Position))))\n          do\n-               Lock (Tree.TC);\n+               Busy (Tree.TC);\n             end return;\n          end;\n       end Reference_Preserving_Key;\n@@ -1049,7 +1049,7 @@ package body Ada.Containers.Indefinite_Ordered_Sets is\n                     Pos       => Find (Container, Key),\n                     Old_Key   => new Key_Type'(Key)))\n             do\n-               Lock (Tree.TC);\n+               Busy (Tree.TC);\n             end return;\n          end;\n       end Reference_Preserving_Key;\n@@ -1688,7 +1688,7 @@ package body Ada.Containers.Indefinite_Ordered_Sets is\n         Container.Tree.TC'Unrestricted_Access;\n    begin\n       return R : constant Reference_Control_Type := (Controlled with TC) do\n-         Lock (TC.all);\n+         Busy (TC.all);\n       end return;\n    end Pseudo_Reference;\n "}, {"sha": "75087949af8a86c06b4b619a9e2a333918a04b16", "filename": "gcc/ada/libgnat/a-cobove.adb", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f26abccd0f04f87e348cb0127cc24fc7265f06a/gcc%2Fada%2Flibgnat%2Fa-cobove.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f26abccd0f04f87e348cb0127cc24fc7265f06a/gcc%2Fada%2Flibgnat%2Fa-cobove.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flibgnat%2Fa-cobove.adb?ref=2f26abccd0f04f87e348cb0127cc24fc7265f06a", "patch": "@@ -402,7 +402,7 @@ package body Ada.Containers.Bounded_Vectors is\n            (Element => A (J)'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Constant_Reference;\n@@ -426,7 +426,7 @@ package body Ada.Containers.Bounded_Vectors is\n            (Element => A (J)'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Constant_Reference;\n@@ -2067,7 +2067,7 @@ package body Ada.Containers.Bounded_Vectors is\n       TC : constant Tamper_Counts_Access := Container.TC'Unrestricted_Access;\n    begin\n       return R : constant Reference_Control_Type := (Controlled with TC) do\n-         Lock (TC.all);\n+         Busy (TC.all);\n       end return;\n    end Pseudo_Reference;\n \n@@ -2183,7 +2183,7 @@ package body Ada.Containers.Bounded_Vectors is\n            (Element => A (J)'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Reference;\n@@ -2207,7 +2207,7 @@ package body Ada.Containers.Bounded_Vectors is\n            (Element => A (J)'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Reference;"}, {"sha": "e7da0204af880715e656bdc6deefc5770c4607a2", "filename": "gcc/ada/libgnat/a-cohama.adb", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f26abccd0f04f87e348cb0127cc24fc7265f06a/gcc%2Fada%2Flibgnat%2Fa-cohama.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f26abccd0f04f87e348cb0127cc24fc7265f06a/gcc%2Fada%2Flibgnat%2Fa-cohama.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flibgnat%2Fa-cohama.adb?ref=2f26abccd0f04f87e348cb0127cc24fc7265f06a", "patch": "@@ -213,7 +213,7 @@ package body Ada.Containers.Hashed_Maps is\n            (Element => Position.Node.Element'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Constant_Reference;\n@@ -238,7 +238,7 @@ package body Ada.Containers.Hashed_Maps is\n            (Element => Node.Element'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Constant_Reference;\n@@ -836,7 +836,7 @@ package body Ada.Containers.Hashed_Maps is\n         Container.HT.TC'Unrestricted_Access;\n    begin\n       return R : constant Reference_Control_Type := (Controlled with TC) do\n-         Lock (TC.all);\n+         Busy (TC.all);\n       end return;\n    end Pseudo_Reference;\n \n@@ -937,7 +937,7 @@ package body Ada.Containers.Hashed_Maps is\n            (Element => Position.Node.Element'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Reference;\n@@ -962,7 +962,7 @@ package body Ada.Containers.Hashed_Maps is\n            (Element => Node.Element'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Reference;"}, {"sha": "61ebf87d2f1130b2676369bd18ca92d4e6ab460e", "filename": "gcc/ada/libgnat/a-cohase.adb", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f26abccd0f04f87e348cb0127cc24fc7265f06a/gcc%2Fada%2Flibgnat%2Fa-cohase.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f26abccd0f04f87e348cb0127cc24fc7265f06a/gcc%2Fada%2Flibgnat%2Fa-cohase.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flibgnat%2Fa-cohase.adb?ref=2f26abccd0f04f87e348cb0127cc24fc7265f06a", "patch": "@@ -223,7 +223,7 @@ package body Ada.Containers.Hashed_Sets is\n            (Element => Position.Node.Element'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Constant_Reference;\n@@ -1119,7 +1119,7 @@ package body Ada.Containers.Hashed_Sets is\n         Container.HT.TC'Unrestricted_Access;\n    begin\n       return R : constant Reference_Control_Type := (Controlled with TC) do\n-         Lock (TC.all);\n+         Busy (TC.all);\n       end return;\n    end Pseudo_Reference;\n \n@@ -1839,7 +1839,7 @@ package body Ada.Containers.Hashed_Sets is\n               (Element => Node.Element'Access,\n                Control => (Controlled with TC))\n             do\n-               Lock (TC.all);\n+               Busy (TC.all);\n             end return;\n          end;\n       end Constant_Reference;\n@@ -2025,7 +2025,7 @@ package body Ada.Containers.Hashed_Sets is\n                               Old_Pos  => Position,\n                               Old_Hash => Hash (Key (Position))))\n             do\n-               Lock (HT.TC);\n+               Busy (HT.TC);\n             end return;\n          end;\n       end Reference_Preserving_Key;\n@@ -2055,7 +2055,7 @@ package body Ada.Containers.Hashed_Sets is\n                               Old_Pos  => P,\n                               Old_Hash => Hash (Key)))\n             do\n-               Lock (HT.TC);\n+               Busy (HT.TC);\n             end return;\n          end;\n       end Reference_Preserving_Key;"}, {"sha": "0dfe1c63e892095391e220d22706a5022f0e597e", "filename": "gcc/ada/libgnat/a-coinve.adb", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f26abccd0f04f87e348cb0127cc24fc7265f06a/gcc%2Fada%2Flibgnat%2Fa-coinve.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f26abccd0f04f87e348cb0127cc24fc7265f06a/gcc%2Fada%2Flibgnat%2Fa-coinve.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flibgnat%2Fa-coinve.adb?ref=2f26abccd0f04f87e348cb0127cc24fc7265f06a", "patch": "@@ -324,7 +324,7 @@ package body Ada.Containers.Indefinite_Vectors is\n            (Element => Container.Elements.EA (Position.Index),\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Constant_Reference;\n@@ -348,7 +348,7 @@ package body Ada.Containers.Indefinite_Vectors is\n            (Element => Container.Elements.EA (Index),\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Constant_Reference;\n@@ -2586,7 +2586,7 @@ package body Ada.Containers.Indefinite_Vectors is\n       TC : constant Tamper_Counts_Access := Container.TC'Unrestricted_Access;\n    begin\n       return R : constant Reference_Control_Type := (Controlled with TC) do\n-         Lock (TC.all);\n+         Busy (TC.all);\n       end return;\n    end Pseudo_Reference;\n \n@@ -2718,7 +2718,7 @@ package body Ada.Containers.Indefinite_Vectors is\n            (Element => Container.Elements.EA (Position.Index),\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Reference;\n@@ -2742,7 +2742,7 @@ package body Ada.Containers.Indefinite_Vectors is\n            (Element => Container.Elements.EA (Index),\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Reference;"}, {"sha": "9e6a00e8e3ba4fb2b3a2aa66bdf52ee06de2c3f1", "filename": "gcc/ada/libgnat/a-comutr.adb", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f26abccd0f04f87e348cb0127cc24fc7265f06a/gcc%2Fada%2Flibgnat%2Fa-comutr.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f26abccd0f04f87e348cb0127cc24fc7265f06a/gcc%2Fada%2Flibgnat%2Fa-comutr.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flibgnat%2Fa-comutr.adb?ref=2f26abccd0f04f87e348cb0127cc24fc7265f06a", "patch": "@@ -469,7 +469,7 @@ package body Ada.Containers.Multiway_Trees is\n            (Element => Position.Node.Element'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Constant_Reference;\n@@ -1830,7 +1830,7 @@ package body Ada.Containers.Multiway_Trees is\n       TC : constant Tamper_Counts_Access := Container.TC'Unrestricted_Access;\n    begin\n       return R : constant Reference_Control_Type := (Controlled with TC) do\n-         Lock (TC.all);\n+         Busy (TC.all);\n       end return;\n    end Pseudo_Reference;\n \n@@ -2023,7 +2023,7 @@ package body Ada.Containers.Multiway_Trees is\n            (Element => Position.Node.Element'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Reference;"}, {"sha": "06af0dabf7e63fe16e26cc2602275b03576d80ac", "filename": "gcc/ada/libgnat/a-conhel.adb", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f26abccd0f04f87e348cb0127cc24fc7265f06a/gcc%2Fada%2Flibgnat%2Fa-conhel.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f26abccd0f04f87e348cb0127cc24fc7265f06a/gcc%2Fada%2Flibgnat%2Fa-conhel.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flibgnat%2Fa-conhel.adb?ref=2f26abccd0f04f87e348cb0127cc24fc7265f06a", "patch": "@@ -38,7 +38,7 @@ package body Ada.Containers.Helpers is\n       procedure Adjust (Control : in out Reference_Control_Type) is\n       begin\n          if Control.T_Counts /= null then\n-            Lock (Control.T_Counts.all);\n+            Busy (Control.T_Counts.all);\n          end if;\n       end Adjust;\n \n@@ -60,7 +60,7 @@ package body Ada.Containers.Helpers is\n       procedure Finalize (Control : in out Reference_Control_Type) is\n       begin\n          if Control.T_Counts /= null then\n-            Unlock (Control.T_Counts.all);\n+            Unbusy (Control.T_Counts.all);\n             Control.T_Counts := null;\n          end if;\n       end Finalize;"}, {"sha": "f5e2eb4228736026e37037b57fb6343c893b0f9b", "filename": "gcc/ada/libgnat/a-convec.adb", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f26abccd0f04f87e348cb0127cc24fc7265f06a/gcc%2Fada%2Flibgnat%2Fa-convec.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f26abccd0f04f87e348cb0127cc24fc7265f06a/gcc%2Fada%2Flibgnat%2Fa-convec.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flibgnat%2Fa-convec.adb?ref=2f26abccd0f04f87e348cb0127cc24fc7265f06a", "patch": "@@ -294,7 +294,7 @@ package body Ada.Containers.Vectors is\n            (Element => Container.Elements.EA (Position.Index)'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Constant_Reference;\n@@ -316,7 +316,7 @@ package body Ada.Containers.Vectors is\n            (Element => Container.Elements.EA (Index)'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Constant_Reference;\n@@ -2293,7 +2293,7 @@ package body Ada.Containers.Vectors is\n       TC : constant Tamper_Counts_Access := Container.TC'Unrestricted_Access;\n    begin\n       return R : constant Reference_Control_Type := (Controlled with TC) do\n-         Lock (TC.all);\n+         Busy (TC.all);\n       end return;\n    end Pseudo_Reference;\n \n@@ -2409,7 +2409,7 @@ package body Ada.Containers.Vectors is\n            (Element => Container.Elements.EA (Position.Index)'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Reference;\n@@ -2431,7 +2431,7 @@ package body Ada.Containers.Vectors is\n            (Element => Container.Elements.EA (Index)'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Reference;"}, {"sha": "e49ae902476365e28cae825acae6363602ebbae4", "filename": "gcc/ada/libgnat/a-coorma.adb", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f26abccd0f04f87e348cb0127cc24fc7265f06a/gcc%2Fada%2Flibgnat%2Fa-coorma.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f26abccd0f04f87e348cb0127cc24fc7265f06a/gcc%2Fada%2Flibgnat%2Fa-coorma.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flibgnat%2Fa-coorma.adb?ref=2f26abccd0f04f87e348cb0127cc24fc7265f06a", "patch": "@@ -336,7 +336,7 @@ package body Ada.Containers.Ordered_Maps is\n            (Element => Position.Node.Element'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Constant_Reference;\n@@ -361,7 +361,7 @@ package body Ada.Containers.Ordered_Maps is\n            (Element => Node.Element'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Constant_Reference;\n@@ -1180,7 +1180,7 @@ package body Ada.Containers.Ordered_Maps is\n         Container.Tree.TC'Unrestricted_Access;\n    begin\n       return R : constant Reference_Control_Type := (Controlled with TC) do\n-         Lock (TC.all);\n+         Busy (TC.all);\n       end return;\n    end Pseudo_Reference;\n \n@@ -1307,7 +1307,7 @@ package body Ada.Containers.Ordered_Maps is\n            (Element => Position.Node.Element'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Reference;\n@@ -1332,7 +1332,7 @@ package body Ada.Containers.Ordered_Maps is\n            (Element => Node.Element'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Reference;"}, {"sha": "d2f8a58f91075245f0805c2c87e3ff079ff082d5", "filename": "gcc/ada/libgnat/a-coorse.adb", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f26abccd0f04f87e348cb0127cc24fc7265f06a/gcc%2Fada%2Flibgnat%2Fa-coorse.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f26abccd0f04f87e348cb0127cc24fc7265f06a/gcc%2Fada%2Flibgnat%2Fa-coorse.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flibgnat%2Fa-coorse.adb?ref=2f26abccd0f04f87e348cb0127cc24fc7265f06a", "patch": "@@ -349,7 +349,7 @@ package body Ada.Containers.Ordered_Sets is\n            (Element => Position.Node.Element'Access,\n             Control => (Controlled with TC))\n          do\n-            Lock (TC.all);\n+            Busy (TC.all);\n          end return;\n       end;\n    end Constant_Reference;\n@@ -706,7 +706,7 @@ package body Ada.Containers.Ordered_Sets is\n               (Element => Node.Element'Access,\n                Control => (Controlled with TC))\n             do\n-               Lock (TC.all);\n+               Busy (TC.all);\n             end return;\n          end;\n       end Constant_Reference;\n@@ -903,7 +903,7 @@ package body Ada.Containers.Ordered_Sets is\n                      Pos       => Position,\n                      Old_Key   => new Key_Type'(Key (Position))))\n             do\n-               Lock (Tree.TC);\n+               Busy (Tree.TC);\n             end return;\n          end;\n       end Reference_Preserving_Key;\n@@ -931,7 +931,7 @@ package body Ada.Containers.Ordered_Sets is\n                      Pos       => Find (Container, Key),\n                      Old_Key   => new Key_Type'(Key)))\n             do\n-               Lock (Tree.TC);\n+               Busy (Tree.TC);\n             end return;\n          end;\n       end Reference_Preserving_Key;\n@@ -1550,7 +1550,7 @@ package body Ada.Containers.Ordered_Sets is\n         Container.Tree.TC'Unrestricted_Access;\n    begin\n       return R : constant Reference_Control_Type := (Controlled with TC) do\n-         Lock (TC.all);\n+         Busy (TC.all);\n       end return;\n    end Pseudo_Reference;\n "}]}