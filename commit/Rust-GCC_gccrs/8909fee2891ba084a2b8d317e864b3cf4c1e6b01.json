{"sha": "8909fee2891ba084a2b8d317e864b3cf4c1e6b01", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODkwOWZlZTI4OTFiYTA4NGEyYjhkMzE3ZTg2NGIzY2Y0YzFlNmIwMQ==", "commit": {"author": {"name": "Steven G. Kargl", "email": "kargl@gcc.gnu.org", "date": "2018-05-24T22:28:33Z"}, "committer": {"name": "Steven G. Kargl", "email": "kargl@gcc.gnu.org", "date": "2018-05-24T22:28:33Z"}, "message": "re PR fortran/85895 (ICE in gfc_conv_array_ref, at fortran/trans-array.c:3518)\n\n2018-05-24  Steven G. Kargl  <kargl@gcc.gnu.org>\n\n\tPR fortran/85895\n\t* resolve.c (resolve_sync): Resolve expression before checking for\n\tan error.\n\n2018-05-24  Steven G. Kargl  <kargl@gcc.gnu.org>\n\n\tPR fortran/85895\n\n\t* gfortran.dg/coarray_3.f90: Fix invalid testcase.\n\t* gfortran.dg/pr85895.f90: New test.\n\nFrom-SVN: r260696", "tree": {"sha": "99d3fcbc18670b7c850e4d99d0aa38634368171a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/99d3fcbc18670b7c850e4d99d0aa38634368171a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8909fee2891ba084a2b8d317e864b3cf4c1e6b01", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8909fee2891ba084a2b8d317e864b3cf4c1e6b01", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8909fee2891ba084a2b8d317e864b3cf4c1e6b01", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8909fee2891ba084a2b8d317e864b3cf4c1e6b01/comments", "author": null, "committer": null, "parents": [{"sha": "91294f1e4f26a737ea8f747bb410d28a36ce0285", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/91294f1e4f26a737ea8f747bb410d28a36ce0285", "html_url": "https://github.com/Rust-GCC/gccrs/commit/91294f1e4f26a737ea8f747bb410d28a36ce0285"}], "stats": {"total": 34, "additions": 33, "deletions": 1}, "files": [{"sha": "a65470c4447bed812b4de4ca425b543715eb42d1", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8909fee2891ba084a2b8d317e864b3cf4c1e6b01/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8909fee2891ba084a2b8d317e864b3cf4c1e6b01/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=8909fee2891ba084a2b8d317e864b3cf4c1e6b01", "patch": "@@ -1,3 +1,9 @@\n+2018-05-24  Steven G. Kargl  <kargl@gcc.gnu.org>\n+\n+\tPR fortran/85895\n+\t* resolve.c (resolve_sync): Resolve expression before checking for\n+\tan error.\n+\n 2018-05-22  Janus Weil  <janus@gcc.gnu.org>\n \n \tPR fortran/85841"}, {"sha": "a53253ea88b2b7e950eb8414e99288215fa6910f", "filename": "gcc/fortran/resolve.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8909fee2891ba084a2b8d317e864b3cf4c1e6b01/gcc%2Ffortran%2Fresolve.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8909fee2891ba084a2b8d317e864b3cf4c1e6b01/gcc%2Ffortran%2Fresolve.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fresolve.c?ref=8909fee2891ba084a2b8d317e864b3cf4c1e6b01", "patch": "@@ -9527,13 +9527,15 @@ resolve_sync (gfc_code *code)\n     }\n \n   /* Check STAT.  */\n+  gfc_resolve_expr (code->expr2);\n   if (code->expr2\n       && (code->expr2->ts.type != BT_INTEGER || code->expr2->rank != 0\n \t  || code->expr2->expr_type != EXPR_VARIABLE))\n     gfc_error (\"STAT= argument at %L must be a scalar INTEGER variable\",\n \t       &code->expr2->where);\n \n   /* Check ERRMSG.  */\n+  gfc_resolve_expr (code->expr3);\n   if (code->expr3\n       && (code->expr3->ts.type != BT_CHARACTER || code->expr3->rank != 0\n \t  || code->expr3->expr_type != EXPR_VARIABLE))"}, {"sha": "707db425ec5062b299af98126569e9a3391c64c4", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8909fee2891ba084a2b8d317e864b3cf4c1e6b01/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8909fee2891ba084a2b8d317e864b3cf4c1e6b01/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=8909fee2891ba084a2b8d317e864b3cf4c1e6b01", "patch": "@@ -1,3 +1,10 @@\n+2018-05-24  Steven G. Kargl  <kargl@gcc.gnu.org>\n+\n+\tPR fortran/85895\n+\n+\t* gfortran.dg/coarray_3.f90: Fix invalid testcase.\n+\t* gfortran.dg/pr85895.f90: New test.\n+\n 2018-05-24  Uros Bizjak  <ubizjak@gmail.com>\n \n \t* gcc.target/i386/avx512f-vcvtusi2sd64-1.c: Update scan string."}, {"sha": "d152ce1b2bdcb023aa28e8b94eb78e831fc0f402", "filename": "gcc/testsuite/gfortran.dg/coarray_3.f90", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8909fee2891ba084a2b8d317e864b3cf4c1e6b01/gcc%2Ftestsuite%2Fgfortran.dg%2Fcoarray_3.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8909fee2891ba084a2b8d317e864b3cf4c1e6b01/gcc%2Ftestsuite%2Fgfortran.dg%2Fcoarray_3.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fcoarray_3.f90?ref=8909fee2891ba084a2b8d317e864b3cf4c1e6b01", "patch": "@@ -13,7 +13,7 @@\n \n sync all (stat=1) ! { dg-error \"Syntax error in SYNC ALL\" }\n sync all ( stat = n,stat=k) ! { dg-error \"Redundant STAT\" }\n-sync memory (errmsg=str)\n+sync memory (errmsg=str) ! { dg-error \"must be a scalar CHARACTER variable\" }\n sync memory (errmsg=n) ! { dg-error \"must be a scalar CHARACTER variable\" }\n sync images (*, stat=1.0) ! { dg-error \"Syntax error in SYNC IMAGES\" }\n sync images (-1) ! { dg-error \"must between 1 and num_images\" }"}, {"sha": "184266e5ec8b6dba615d8530a6e7a2f9cf7a8609", "filename": "gcc/testsuite/gfortran.dg/pr85895.f90", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8909fee2891ba084a2b8d317e864b3cf4c1e6b01/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr85895.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8909fee2891ba084a2b8d317e864b3cf4c1e6b01/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr85895.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr85895.f90?ref=8909fee2891ba084a2b8d317e864b3cf4c1e6b01", "patch": "@@ -0,0 +1,17 @@\n+! { dg-do compile }\n+! { dg-options \"-fcoarray=lib\" }\n+! PR fortran/85895\n+subroutine p\n+   character(80) :: c(2)\n+   sync memory (errmsg=c)        ! { dg-error \"scalar CHARACTER variable\" }\n+end subroutine p\n+\n+subroutine q\n+   character(80) :: c(2)\n+   sync memory (errmsg=c(1:2))   ! { dg-error \"scalar CHARACTER variable\" }\n+end subroutine q\n+\n+subroutine r\n+   character(80) :: c(2)\n+   sync memory (errmsg=c(1))\n+end subroutine r"}]}