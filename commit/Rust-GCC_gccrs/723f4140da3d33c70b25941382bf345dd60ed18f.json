{"sha": "723f4140da3d33c70b25941382bf345dd60ed18f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzIzZjQxNDBkYTNkMzNjNzBiMjU5NDEzODJiZjM0NWRkNjBlZDE4Zg==", "commit": {"author": {"name": "Tom de Vries", "email": "tom@codesourcery.com", "date": "2017-05-01T14:15:33Z"}, "committer": {"name": "Tom de Vries", "email": "vries@gcc.gnu.org", "date": "2017-05-01T14:15:33Z"}, "message": "Add and use effective target rdrand\n\n2017-05-01  Tom de Vries  <tom@codesourcery.com>\n\n\tPR testsuite/65941\n\t* lib/target-supports.exp (check_effective_target_rdrand): New proc.\n\t* g++.dg/other/pr59492.C: Require effective target rdrand.\n\nFrom-SVN: r247438", "tree": {"sha": "30e1b9452e5171de6a857174c8f05a7f4681bb22", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/30e1b9452e5171de6a857174c8f05a7f4681bb22"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/723f4140da3d33c70b25941382bf345dd60ed18f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/723f4140da3d33c70b25941382bf345dd60ed18f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/723f4140da3d33c70b25941382bf345dd60ed18f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/723f4140da3d33c70b25941382bf345dd60ed18f/comments", "author": null, "committer": null, "parents": [{"sha": "dd03444ba5ad4ac3f5476084c2028851b5c94cca", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dd03444ba5ad4ac3f5476084c2028851b5c94cca", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dd03444ba5ad4ac3f5476084c2028851b5c94cca"}], "stats": {"total": 21, "additions": 21, "deletions": 0}, "files": [{"sha": "f1c61a668c5422613de8fc715f01276e90c3e9b1", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/723f4140da3d33c70b25941382bf345dd60ed18f/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/723f4140da3d33c70b25941382bf345dd60ed18f/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=723f4140da3d33c70b25941382bf345dd60ed18f", "patch": "@@ -1,3 +1,9 @@\n+2017-05-01  Tom de Vries  <tom@codesourcery.com>\n+\n+\tPR testsuite/65941\n+\t* lib/target-supports.exp (check_effective_target_rdrand): New proc.\n+\t* g++.dg/other/pr59492.C: Require effective target rdrand.\n+\n 2017-04-29  Volker Reichelt  <v.reichelt@netcologne.de>\n \n \t* g++.dg/diagnostic/member-decl-1.C: New test."}, {"sha": "92694ae6dde23099bca4bb2ebad1d65a98a4e789", "filename": "gcc/testsuite/g++.dg/other/pr59492.C", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/723f4140da3d33c70b25941382bf345dd60ed18f/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fpr59492.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/723f4140da3d33c70b25941382bf345dd60ed18f/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fpr59492.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fpr59492.C?ref=723f4140da3d33c70b25941382bf345dd60ed18f", "patch": "@@ -2,6 +2,7 @@\n // { dg-options \"-mx32 -fPIC\" }\n // { dg-require-ifunc \"\" }\n // { dg-require-effective-target maybe_x32 }\n+// { dg-require-effective-target rdrand }\n \n void\n __throw_runtime_error(const char*) __attribute__((__noreturn__));"}, {"sha": "83e7f2670e6279f3c293cbda8692686724c67c24", "filename": "gcc/testsuite/lib/target-supports.exp", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/723f4140da3d33c70b25941382bf345dd60ed18f/gcc%2Ftestsuite%2Flib%2Ftarget-supports.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/723f4140da3d33c70b25941382bf345dd60ed18f/gcc%2Ftestsuite%2Flib%2Ftarget-supports.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Flib%2Ftarget-supports.exp?ref=723f4140da3d33c70b25941382bf345dd60ed18f", "patch": "@@ -8296,6 +8296,20 @@ proc check_effective_target_store_merge { } {\n     return 0\n }\n \n+# Return 1 if we're able to assemble rdrand\n+\n+proc check_effective_target_rdrand { } {\n+    return [check_no_compiler_messages_nocache rdrand object {\n+\tunsigned int\n+\t__foo(void)\n+\t{\n+\t    unsigned int val;\n+\t    __builtin_ia32_rdrand32_step(&val);\n+\t    return val;\n+\t}\n+    } \"-mrdrnd\" ]\n+}\n+\n # Return 1 if the target supports coprocessor instructions: cdp, ldc, stc, mcr and\n # mrc.\n proc check_effective_target_arm_coproc1_ok_nocache { } {"}]}