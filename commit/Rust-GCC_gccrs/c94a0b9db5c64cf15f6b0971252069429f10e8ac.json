{"sha": "c94a0b9db5c64cf15f6b0971252069429f10e8ac", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Yzk0YTBiOWRiNWM2NGNmMTVmNmIwOTcxMjUyMDY5NDI5ZjEwZThhYw==", "commit": {"author": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2010-01-26T14:02:25Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2010-01-26T14:02:25Z"}, "message": "[multiple changes]\n\n2010-01-26  Thomas Quinot  <quinot@adacore.com>\n\n\t* gnat_ugn.texi: Adjust documentation of -gnatz switches.\n\t* usage.adb: Replace line for -gnatz with two lines for -gnatzc and\n\t-gnatzr.\n\n2010-01-26  Vincent Celier  <celier@adacore.com>\n\n\t* prj-attr.adb: Add new attribute Library_Install_Name_Option\n\tReplace attribute Run_Path_Origin_Supported with Run_Path_Origin\n\t* prj-nmsc.adb (Process_Project_Level_Simple_Attributes): Process\n\tattributes Run_Path_Option and Library_Install_Name_Option.\n\t* prj.ads (Project_Configuration): Replace component\n\tRun_Path_Origin_Supported with component Run_Path_Origin. Add new\n\tcomponent Library_Install_Name_Option.\n\t* snames.ads-tmpl: Add new standard name Library_Install_Name_Option\n\tReplace Run_Path_Origin_Supported with Run_Path_Origin\n\n2010-01-26  Ed Schonberg  <schonberg@adacore.com>\n\n\t* sem_ch8.adb (Use_One_Package): Within an instance, an actual package\n\tis not hidden by a homograph declared in another actual package.\n\nFrom-SVN: r156248", "tree": {"sha": "59c491e0f19bb78d378921368031f1c50cd5dae0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/59c491e0f19bb78d378921368031f1c50cd5dae0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c94a0b9db5c64cf15f6b0971252069429f10e8ac", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c94a0b9db5c64cf15f6b0971252069429f10e8ac", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c94a0b9db5c64cf15f6b0971252069429f10e8ac", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c94a0b9db5c64cf15f6b0971252069429f10e8ac/comments", "author": null, "committer": null, "parents": [{"sha": "65564d08a267dbc7f56c069161b7cd44ffe84164", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/65564d08a267dbc7f56c069161b7cd44ffe84164", "html_url": "https://github.com/Rust-GCC/gccrs/commit/65564d08a267dbc7f56c069161b7cd44ffe84164"}], "stats": {"total": 109, "additions": 79, "deletions": 30}, "files": [{"sha": "3cc8b528c7c4ceedf018c812dad34ca83da6b5e6", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c94a0b9db5c64cf15f6b0971252069429f10e8ac/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c94a0b9db5c64cf15f6b0971252069429f10e8ac/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=c94a0b9db5c64cf15f6b0971252069429f10e8ac", "patch": "@@ -1,3 +1,26 @@\n+2010-01-26  Thomas Quinot  <quinot@adacore.com>\n+\n+\t* gnat_ugn.texi: Adjust documentation of -gnatz switches.\n+\t* usage.adb: Replace line for -gnatz with two lines for -gnatzc and\n+\t-gnatzr.\n+\n+2010-01-26  Vincent Celier  <celier@adacore.com>\n+\n+\t* prj-attr.adb: Add new attribute Library_Install_Name_Option\n+\tReplace attribute Run_Path_Origin_Supported with Run_Path_Origin\n+\t* prj-nmsc.adb (Process_Project_Level_Simple_Attributes): Process\n+\tattributes Run_Path_Option and Library_Install_Name_Option.\n+\t* prj.ads (Project_Configuration): Replace component\n+\tRun_Path_Origin_Supported with component Run_Path_Origin. Add new\n+\tcomponent Library_Install_Name_Option.\n+\t* snames.ads-tmpl: Add new standard name Library_Install_Name_Option\n+\tReplace Run_Path_Origin_Supported with Run_Path_Origin\n+\n+2010-01-26  Ed Schonberg  <schonberg@adacore.com>\n+\n+\t* sem_ch8.adb (Use_One_Package): Within an instance, an actual package\n+\tis not hidden by a homograph declared in another actual package.\n+\n 2010-01-26  Robert Dewar  <dewar@adacore.com>\n \n \t* par_sco.adb (Traverse_Declarations_Or_Statements): Only generate"}, {"sha": "9d35f8ec9086d8ae933eb99f8a57bfc6b5a6a616", "filename": "gcc/ada/gnat_ugn.texi", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c94a0b9db5c64cf15f6b0971252069429f10e8ac/gcc%2Fada%2Fgnat_ugn.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c94a0b9db5c64cf15f6b0971252069429f10e8ac/gcc%2Fada%2Fgnat_ugn.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgnat_ugn.texi?ref=c94a0b9db5c64cf15f6b0971252069429f10e8ac", "patch": "@@ -4572,8 +4572,9 @@ first in the string.\n \n @item\n The switches\n-@option{^-gnatz^/DISTRIBUTION_STUBS^}, @option{-gnatzc}, and @option{-gnatzr}\n-may not be combined with any other switches.\n+^^@option{/DISTRIBUTION_STUBS=},^\n+@option{-gnatzc} and @option{-gnatzr} may not be combined with any other\n+switches, and only one of them may appear in the command line.\n \n @ifclear vms\n @item"}, {"sha": "d143a504a8450436d907ab05523b84467958cfa1", "filename": "gcc/ada/prj-attr.adb", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c94a0b9db5c64cf15f6b0971252069429f10e8ac/gcc%2Fada%2Fprj-attr.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c94a0b9db5c64cf15f6b0971252069429f10e8ac/gcc%2Fada%2Fprj-attr.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-attr.adb?ref=c94a0b9db5c64cf15f6b0971252069429f10e8ac", "patch": "@@ -112,7 +112,7 @@ package body Prj.Attr is\n \n    \"SVdefault_language#\" &\n    \"LVrun_path_option#\" &\n-   \"SVrun_path_origin_supported#\" &\n+   \"SVrun_path_origin#\" &\n    \"SVseparate_run_path_options#\" &\n    \"Satoolchain_version#\" &\n    \"Satoolchain_description#\" &\n@@ -142,6 +142,7 @@ package body Prj.Attr is\n    \"SVlibrary_auto_init_supported#\" &\n    \"LVshared_library_minimum_switches#\" &\n    \"LVlibrary_version_switches#\" &\n+   \"SVlibrary_install_name_option#\" &\n    \"Saruntime_library_dir#\" &\n    \"Saruntime_source_dir#\" &\n "}, {"sha": "ca6a732ac76955075c517b08a11d5886fdb93918", "filename": "gcc/ada/prj-nmsc.adb", "status": "modified", "additions": 15, "deletions": 15, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c94a0b9db5c64cf15f6b0971252069429f10e8ac/gcc%2Fada%2Fprj-nmsc.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c94a0b9db5c64cf15f6b0971252069429f10e8ac/gcc%2Fada%2Fprj-nmsc.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-nmsc.adb?ref=c94a0b9db5c64cf15f6b0971252069429f10e8ac", "patch": "@@ -2093,21 +2093,21 @@ package body Prj.Nmsc is\n                           In_Tree   => Data.Tree);\n                   end if;\n \n-               elsif Attribute.Name = Name_Run_Path_Origin_Supported then\n-                  declare\n-                     pragma Unsuppress (All_Checks);\n-                  begin\n-                     Project.Config.Run_Path_Origin_Supported :=\n-                       Boolean'Value (Get_Name_String (Attribute.Value.Value));\n-                  exception\n-                     when Constraint_Error =>\n-                        Error_Msg\n-                          (Data.Flags,\n-                           \"invalid value \"\"\" &\n-                           Get_Name_String (Attribute.Value.Value) &\n-                           \"\"\" for Run_Path_Origin_Supported\",\n-                           Attribute.Value.Location, Project);\n-                  end;\n+               elsif Attribute.Name = Name_Run_Path_Origin then\n+                  Get_Name_String (Attribute.Value.Value);\n+\n+                  if Name_Len = 0 then\n+                     Error_Msg\n+                       (Data.Flags,\n+                        \"run path origin cannot be empty\",\n+                        Attribute.Value.Location, Project);\n+                  end if;\n+\n+                  Project.Config.Run_Path_Origin := Attribute.Value.Value;\n+\n+               elsif Attribute.Name = Name_Library_Install_Name_Option then\n+                  Project.Config.Library_Install_Name_Option :=\n+                    Attribute.Value.Value;\n \n                elsif Attribute.Name = Name_Separate_Run_Path_Options then\n                   declare"}, {"sha": "353138d2dafe9a2b8837e195867a25fcd6712d29", "filename": "gcc/ada/prj.ads", "status": "modified", "additions": 10, "deletions": 4, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c94a0b9db5c64cf15f6b0971252069429f10e8ac/gcc%2Fada%2Fprj.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c94a0b9db5c64cf15f6b0971252069429f10e8ac/gcc%2Fada%2Fprj.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj.ads?ref=c94a0b9db5c64cf15f6b0971252069429f10e8ac", "patch": "@@ -906,9 +906,14 @@ package Prj is\n       --  The option to use when linking to specify the path where to look for\n       --  libraries.\n \n-      Run_Path_Origin_Supported : Boolean := False;\n-      --  Specify if the run path option support $ORIGIN to indicate paths\n-      --  reative to the directory of the executable.\n+      Run_Path_Origin : Name_Id := No_Name;\n+      --  Specify the string (such as \"$ORIGIN\") to indicate paths relative to\n+      --  the directory of the executable in the run path option.\n+\n+      Library_Install_Name_Option : Name_Id := No_Name;\n+      --  When this is not an empty list, this option, followed by the single\n+      --  name of the shared library file is used when linking a shared\n+      --  library.\n \n       Separate_Run_Path_Options : Boolean := False;\n       --  True if each directory needs to be specified in a separate run path\n@@ -1021,7 +1026,8 @@ package Prj is\n    Default_Project_Config : constant Project_Configuration :=\n                               (Target                        => No_Name,\n                                Run_Path_Option               => No_Name_List,\n-                               Run_Path_Origin_Supported     => False,\n+                               Run_Path_Origin               => No_Name,\n+                               Library_Install_Name_Option   => No_Name,\n                                Separate_Run_Path_Options     => False,\n                                Executable_Suffix             => No_Name,\n                                Linker                        => No_Path,"}, {"sha": "a25d1d6ab54c1d5591de35193bd84978b8c45441", "filename": "gcc/ada/sem_ch8.adb", "status": "modified", "additions": 16, "deletions": 4, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c94a0b9db5c64cf15f6b0971252069429f10e8ac/gcc%2Fada%2Fsem_ch8.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c94a0b9db5c64cf15f6b0971252069429f10e8ac/gcc%2Fada%2Fsem_ch8.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch8.adb?ref=c94a0b9db5c64cf15f6b0971252069429f10e8ac", "patch": "@@ -7162,7 +7162,11 @@ package body Sem_Ch8 is\n                --  we compare the scope depth of its scope with that of the\n                --  current instance. However, a generic actual of a subprogram\n                --  instance is declared in the wrapper package but will not be\n-               --  hidden by a use-visible entity.\n+               --  hidden by a use-visible entity. Similarly, a generic actual\n+               --  will not be hidden by an entity declared in another generic\n+               --  actual, which can only have been use-visible in the generic.\n+               --  Is this condition complete, and can the following complex\n+               --  test be simplified ???\n \n                --  If Id is called Standard, the predefined package with the\n                --  same name is in the homonym chain. It has to be ignored\n@@ -7177,9 +7181,17 @@ package body Sem_Ch8 is\n                  and then (Scope (Prev) /= Standard_Standard\n                             or else Sloc (Prev) > Standard_Location)\n                then\n-                  Set_Is_Potentially_Use_Visible (Id);\n-                  Set_Is_Immediately_Visible (Prev, False);\n-                  Append_Elmt (Prev, Hidden_By_Use_Clause (N));\n+                  if Ekind (Prev) = E_Package\n+                    and then Present (Associated_Formal_Package (Prev))\n+                    and then Present (Associated_Formal_Package (P))\n+                  then\n+                     null;\n+\n+                  else\n+                     Set_Is_Potentially_Use_Visible (Id);\n+                     Set_Is_Immediately_Visible (Prev, False);\n+                     Append_Elmt (Prev, Hidden_By_Use_Clause (N));\n+                  end if;\n                end if;\n \n             --  A user-defined operator is not use-visible if the predefined"}, {"sha": "d906caf52d232d2ee6f600f255e3f48b55d3d334", "filename": "gcc/ada/snames.ads-tmpl", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c94a0b9db5c64cf15f6b0971252069429f10e8ac/gcc%2Fada%2Fsnames.ads-tmpl", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c94a0b9db5c64cf15f6b0971252069429f10e8ac/gcc%2Fada%2Fsnames.ads-tmpl", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsnames.ads-tmpl?ref=c94a0b9db5c64cf15f6b0971252069429f10e8ac", "patch": "@@ -1080,6 +1080,7 @@ package Snames is\n    Name_Library_Builder                  : constant Name_Id := N + $;\n    Name_Library_Dir                      : constant Name_Id := N + $;\n    Name_Library_GCC                      : constant Name_Id := N + $;\n+   Name_Library_Install_Name_Option      : constant Name_Id := N + $;\n    Name_Library_Interface                : constant Name_Id := N + $;\n    Name_Library_Kind                     : constant Name_Id := N + $;\n    Name_Library_Name                     : constant Name_Id := N + $;\n@@ -1130,7 +1131,7 @@ package Snames is\n    Name_Roots                            : constant Name_Id := N + $; --  GPR\n    Name_Required_Switches                : constant Name_Id := N + $;\n    Name_Run_Path_Option                  : constant Name_Id := N + $;\n-   Name_Run_Path_Origin_Supported        : constant Name_Id := N + $;\n+   Name_Run_Path_Origin                  : constant Name_Id := N + $;\n    Name_Separate_Run_Path_Options        : constant Name_Id := N + $;\n    Name_Shared_Library_Minimum_Switches  : constant Name_Id := N + $;\n    Name_Shared_Library_Prefix            : constant Name_Id := N + $;"}, {"sha": "1840ade33b744598722c47a9ead9d0bca84d971d", "filename": "gcc/ada/usage.adb", "status": "modified", "additions": 8, "deletions": 3, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c94a0b9db5c64cf15f6b0971252069429f10e8ac/gcc%2Fada%2Fusage.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c94a0b9db5c64cf15f6b0971252069429f10e8ac/gcc%2Fada%2Fusage.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fusage.adb?ref=c94a0b9db5c64cf15f6b0971252069429f10e8ac", "patch": "@@ -563,10 +563,15 @@ begin\n    Write_Switch_Char (\"yN\");\n    Write_Line (\"Cancel all previously set style checks\");\n \n-   --  Lines for -gnatz switch\n+   --  Lines for -gnatzc switch\n \n-   Write_Switch_Char (\"z\");\n-   Write_Line (\"Distribution stub generation (r/c for receiver/caller stubs)\");\n+   Write_Switch_Char (\"zc\");\n+   Write_Line (\"Distribution stub generation for caller stubs\");\n+\n+   --  Lines for -gnatzr switch\n+\n+   Write_Switch_Char (\"zr\");\n+   Write_Line (\"Distribution stub generation for receiver stubs\");\n \n    --  Line for -gnat83 switch\n "}]}