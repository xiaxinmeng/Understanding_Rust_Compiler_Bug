{"sha": "dd2cc6dc8f4d3cad4affbbe5a52f8fc27ba09a61", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZGQyY2M2ZGM4ZjRkM2NhZDRhZmZiYmU1YTUyZjhmYzI3YmEwOWE2MQ==", "commit": {"author": {"name": "Nathanael Nerode", "email": "neroden@gcc.gnu.org", "date": "2003-11-19T18:48:53Z"}, "committer": {"name": "Nathanael Nerode", "email": "neroden@gcc.gnu.org", "date": "2003-11-19T18:48:53Z"}, "message": "cpptrad.c (_cpp_scan_out_logical_line): Improve test for whether directive begins at the beginning of a line.\n\n\t* cpptrad.c (_cpp_scan_out_logical_line): Improve test for\n\twhether directive begins at the beginning of a line.\n\n\t(testsuite)\n\t* gcc.dg/cpp/trad/xwin1.c: New test case.\n\nFrom-SVN: r73740", "tree": {"sha": "9d929780fb0ff894cb0d344e4982b7cfd958f43c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9d929780fb0ff894cb0d344e4982b7cfd958f43c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/dd2cc6dc8f4d3cad4affbbe5a52f8fc27ba09a61", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dd2cc6dc8f4d3cad4affbbe5a52f8fc27ba09a61", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dd2cc6dc8f4d3cad4affbbe5a52f8fc27ba09a61", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dd2cc6dc8f4d3cad4affbbe5a52f8fc27ba09a61/comments", "author": null, "committer": null, "parents": [{"sha": "09c557200827e64caca503b1b31c3e74fb225dc8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/09c557200827e64caca503b1b31c3e74fb225dc8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/09c557200827e64caca503b1b31c3e74fb225dc8"}], "stats": {"total": 28, "additions": 27, "deletions": 1}, "files": [{"sha": "0b4e2872d91d2864feabcc92b10a79673e04b60d", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dd2cc6dc8f4d3cad4affbbe5a52f8fc27ba09a61/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dd2cc6dc8f4d3cad4affbbe5a52f8fc27ba09a61/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=dd2cc6dc8f4d3cad4affbbe5a52f8fc27ba09a61", "patch": "@@ -1,3 +1,8 @@\n+2003-11-19  Nathanael Nerode  <neroden@gcc.gnu.org>\n+\n+\t* cpptrad.c (_cpp_scan_out_logical_line): Improve test for\n+\twhether directive begins at the beginning of a line.\n+\n 2003-11-19  Richard Sandiford  <rsandifo@redhat.com>\n \n \t* config/frv/frv.c (frv_init_libfuncs): Correct ufix_optab entries."}, {"sha": "6da19cc41ec980e4ac9c61188b2e8374ed09c6ba", "filename": "gcc/cpptrad.c", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dd2cc6dc8f4d3cad4affbbe5a52f8fc27ba09a61/gcc%2Fcpptrad.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dd2cc6dc8f4d3cad4affbbe5a52f8fc27ba09a61/gcc%2Fcpptrad.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcpptrad.c?ref=dd2cc6dc8f4d3cad4affbbe5a52f8fc27ba09a61", "patch": "@@ -350,6 +350,7 @@ _cpp_scan_out_logical_line (cpp_reader *pfile, cpp_macro *macro)\n   unsigned int c, paren_depth = 0, quote;\n   enum ls lex_state = ls_none;\n   bool header_ok;\n+  const uchar *start_of_input_line;\n \n   fmacro.buff = NULL;\n \n@@ -359,6 +360,9 @@ _cpp_scan_out_logical_line (cpp_reader *pfile, cpp_macro *macro)\n   RLIMIT (pfile->context) = pfile->buffer->rlimit;\n   pfile->out.cur = pfile->out.base;\n   pfile->out.first_line = pfile->line;\n+  /* start_of_input_line is needed to make sure that directives really,\n+     really start at the first character of the line. */\n+  start_of_input_line = pfile->buffer->cur;\n  new_context:\n   context = pfile->context;\n   cur = CUR (context);\n@@ -581,7 +585,7 @@ _cpp_scan_out_logical_line (cpp_reader *pfile, cpp_macro *macro)\n \t  break;\n \n \tcase '#':\n-\t  if (out - 1 == pfile->out.base\n+\t  if (cur - 1 == start_of_input_line\n \t      /* A '#' from a macro doesn't start a directive.  */\n \t      && !pfile->context->prev\n \t      && !pfile->state.in_directive)"}, {"sha": "fdfcc6ebdcb81269616d90c19935e138ac195a07", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dd2cc6dc8f4d3cad4affbbe5a52f8fc27ba09a61/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dd2cc6dc8f4d3cad4affbbe5a52f8fc27ba09a61/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=dd2cc6dc8f4d3cad4affbbe5a52f8fc27ba09a61", "patch": "@@ -1,3 +1,7 @@\n+2003-11-19  Nathanael Nerode  <neroden@gcc.gnu.org>\n+\n+\t* gcc.dg/cpp/trad/xwin1.c: New test case.\n+\n 2003-11-19  Andreas Tobler  <a.tobler@schweiz.ch>\n \n \t* g++.dg/compat/compat.exp: Add DYLD_LIBRARY_PATH for darwin."}, {"sha": "21220d1db683ed8a2b18c500687068f69a6f3ac2", "filename": "gcc/testsuite/gcc.dg/cpp/trad/xwin1.c", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dd2cc6dc8f4d3cad4affbbe5a52f8fc27ba09a61/gcc%2Ftestsuite%2Fgcc.dg%2Fcpp%2Ftrad%2Fxwin1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dd2cc6dc8f4d3cad4affbbe5a52f8fc27ba09a61/gcc%2Ftestsuite%2Fgcc.dg%2Fcpp%2Ftrad%2Fxwin1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fcpp%2Ftrad%2Fxwin1.c?ref=dd2cc6dc8f4d3cad4affbbe5a52f8fc27ba09a61", "patch": "@@ -0,0 +1,13 @@\n+/* XWindows (as of 4.3) does some pretty strange things with cpp.\n+   This tests one of them; the leading comments are supposed to be\n+   eaten by the preprocessor; but the 'directives' after them are\n+   supposed to be retained as text, not processed, so that imake's cpp\n+   can be run on the output!\n+   { dg-do preprocess }\n+*/\n+\n+/**/#if 0\n+passed\n+/**/#endif\n+\n+/* { dg-final { scan-file xwin1.i \"(^|\\n)#if 0\" } } */"}]}