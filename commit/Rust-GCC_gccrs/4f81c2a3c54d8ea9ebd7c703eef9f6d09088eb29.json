{"sha": "4f81c2a3c54d8ea9ebd7c703eef9f6d09088eb29", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NGY4MWMyYTNjNTRkOGVhOWViZDdjNzAzZWVmOWY2ZDA5MDg4ZWIyOQ==", "commit": {"author": {"name": "Steven G. Kargl", "email": "kargl@gcc.gnu.org", "date": "2019-08-17T14:23:10Z"}, "committer": {"name": "Steven G. Kargl", "email": "kargl@gcc.gnu.org", "date": "2019-08-17T14:23:10Z"}, "message": "re PR fortran/91471 (f951: internal compiler error: gfc_variable_attr(): Bad array reference)\n\n2019-08-17  Steven G. Kargl  <kargl@gcc.gnu.org>\n\n\tPR fortran/91471\n\t* primary.c (gfc_variable_attr): Remove a gfc_internal_error(),\n\twhich cannot be reached by conforming Fortran code, but seems to\n\tbe reachable from nonconforming Fortran code.  Treat the AR_UNKNOWN\n\tcase as a no-op.\n\n2019-08-17  Steven G. Kargl  <kargl@gcc.gnu.org>\n\n\tPR fortran/91471\n\t* gfortran.dg/pr91471.f90: New test.\n\nFrom-SVN: r274603", "tree": {"sha": "ed13385cd80efbcefdd9826bfb5250862c4a9815", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ed13385cd80efbcefdd9826bfb5250862c4a9815"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4f81c2a3c54d8ea9ebd7c703eef9f6d09088eb29", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4f81c2a3c54d8ea9ebd7c703eef9f6d09088eb29", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4f81c2a3c54d8ea9ebd7c703eef9f6d09088eb29", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4f81c2a3c54d8ea9ebd7c703eef9f6d09088eb29/comments", "author": null, "committer": null, "parents": [{"sha": "1e67491a0db526fa3137cf6576dde13cd785d364", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1e67491a0db526fa3137cf6576dde13cd785d364", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1e67491a0db526fa3137cf6576dde13cd785d364"}], "stats": {"total": 37, "additions": 31, "deletions": 6}, "files": [{"sha": "130c3df2e46103ae0c0a6707bfa7477f5c9c807b", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4f81c2a3c54d8ea9ebd7c703eef9f6d09088eb29/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4f81c2a3c54d8ea9ebd7c703eef9f6d09088eb29/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=4f81c2a3c54d8ea9ebd7c703eef9f6d09088eb29", "patch": "@@ -1,3 +1,11 @@\n+2019-08-17  Steven G. Kargl  <kargl@gcc.gnu.org>\n+\n+\tPR fortran/91471\n+\t* primary.c (gfc_variable_attr): Remove a gfc_internal_error(),\n+\twhich cannot be reached by conforming Fortran code, but seems to\n+\tbe reachable from nonconforming Fortran code.  Treat the AR_UNKNOWN\n+\tcase as a no-op.\n+\n 2019-08-17  Janne Blomqvist  <jb@gcc.gnu.org>\n \n \tPR fortran/68401"}, {"sha": "a33a7972f130ad6e2f136bae1c015388ed113ee2", "filename": "gcc/fortran/primary.c", "status": "modified", "additions": 4, "deletions": 6, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4f81c2a3c54d8ea9ebd7c703eef9f6d09088eb29/gcc%2Ffortran%2Fprimary.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4f81c2a3c54d8ea9ebd7c703eef9f6d09088eb29/gcc%2Ffortran%2Fprimary.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fprimary.c?ref=4f81c2a3c54d8ea9ebd7c703eef9f6d09088eb29", "patch": "@@ -2597,12 +2597,10 @@ gfc_variable_attr (gfc_expr *expr, gfc_typespec *ts)\n \t    break;\n \n \t  case AR_UNKNOWN:\n-\t    /* If any of start, end or stride is not integer, there will\n-\t       already have been an error issued.  */\n-\t    int errors;\n-\t    gfc_get_errors (NULL, &errors);\n-\t    if (errors == 0)\n-\t      gfc_internal_error (\"gfc_variable_attr(): Bad array reference\");\n+\t    /* For standard conforming code, AR_UNKNOWN should not happen.\n+\t       For nonconforming code, gfortran can end up here.  Treat it \n+\t       as a no-op.  */\n+\t    break;\n \t  }\n \n \tbreak;"}, {"sha": "0a2bbc17473f8aeb5aaef1a0d6d38d322ce73a0a", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4f81c2a3c54d8ea9ebd7c703eef9f6d09088eb29/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4f81c2a3c54d8ea9ebd7c703eef9f6d09088eb29/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=4f81c2a3c54d8ea9ebd7c703eef9f6d09088eb29", "patch": "@@ -1,3 +1,8 @@\n+2019-08-17  Steven G. Kargl  <kargl@gcc.gnu.org>\n+\n+\tPR fortran/91471\n+\t* gfortran.dg/pr91471.f90: New test.\n+\n 2019-08-16  Marek Polacek  <polacek@redhat.com>\n \n \tPR c++/85827"}, {"sha": "fa798444c1df518a075f7f88e8c1f7aae81dc46a", "filename": "gcc/testsuite/gfortran.dg/pr91471.f90", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4f81c2a3c54d8ea9ebd7c703eef9f6d09088eb29/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr91471.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4f81c2a3c54d8ea9ebd7c703eef9f6d09088eb29/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr91471.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr91471.f90?ref=4f81c2a3c54d8ea9ebd7c703eef9f6d09088eb29", "patch": "@@ -0,0 +1,14 @@\n+! { dg-do compile }\n+! PR fortran/91471\n+! Code contributed by Sameeran Joshi <SameeranJayant dot Joshi at amd dot com>\n+!\n+! This invalid code (x(1) is referenced, but never set) caused an ICE due\n+! to hitting a gfc_internal_error() in primary.c (gfc_variable_attr).  The\n+! fix is to remove that gfc_internal_error().\n+! \n+program dynamic\n+   implicit none\n+   integer, dimension(:), allocatable :: x\n+   allocate(x(1))\n+   stop x(1)\n+end program dynamic"}]}