{"sha": "27fb09b78e186d3d0173ee42cfc0af6801c2a9e2", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjdmYjA5Yjc4ZTE4NmQzZDAxNzNlZTQyY2ZjMGFmNjgwMWMyYTllMg==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@redhat.com", "date": "2008-12-03T19:22:08Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "2008-12-03T19:22:08Z"}, "message": "re PR c++/38380 (explicitly defaulted constructors vs. empty direct initialization)\n\n        PR c++/38380\n        * decl.c (grokdeclarator): Only set DECL_NONCONVERTING_P\n        on explicit constructors.\n        * pt.c (tsubst_copy_and_build) [CONSTRUCTOR]: Propagate\n        CONSTRUCTOR_IS_DIRECT_INIT.\n\nFrom-SVN: r142404", "tree": {"sha": "8cd5b380bdc43051a74bfd205672a42e6737f609", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8cd5b380bdc43051a74bfd205672a42e6737f609"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/27fb09b78e186d3d0173ee42cfc0af6801c2a9e2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/27fb09b78e186d3d0173ee42cfc0af6801c2a9e2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/27fb09b78e186d3d0173ee42cfc0af6801c2a9e2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/27fb09b78e186d3d0173ee42cfc0af6801c2a9e2/comments", "author": {"login": "jicama", "id": 266146, "node_id": "MDQ6VXNlcjI2NjE0Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/266146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jicama", "html_url": "https://github.com/jicama", "followers_url": "https://api.github.com/users/jicama/followers", "following_url": "https://api.github.com/users/jicama/following{/other_user}", "gists_url": "https://api.github.com/users/jicama/gists{/gist_id}", "starred_url": "https://api.github.com/users/jicama/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jicama/subscriptions", "organizations_url": "https://api.github.com/users/jicama/orgs", "repos_url": "https://api.github.com/users/jicama/repos", "events_url": "https://api.github.com/users/jicama/events{/privacy}", "received_events_url": "https://api.github.com/users/jicama/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "6efe1abf4c1fa501ed14b8d70a9c3f63df46102c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6efe1abf4c1fa501ed14b8d70a9c3f63df46102c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6efe1abf4c1fa501ed14b8d70a9c3f63df46102c"}], "stats": {"total": 84, "additions": 72, "deletions": 12}, "files": [{"sha": "4987ca48687bd63285167dee9984dc3cd912deec", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/27fb09b78e186d3d0173ee42cfc0af6801c2a9e2/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/27fb09b78e186d3d0173ee42cfc0af6801c2a9e2/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=27fb09b78e186d3d0173ee42cfc0af6801c2a9e2", "patch": "@@ -1,3 +1,11 @@\n+2008-12-03  Jason Merrill  <jason@redhat.com>\n+\n+\tPR c++/38380\n+\t* decl.c (grokdeclarator): Only set DECL_NONCONVERTING_P\n+\ton explicit constructors.\n+\t* pt.c (tsubst_copy_and_build) [CONSTRUCTOR]: Propagate\n+\tCONSTRUCTOR_IS_DIRECT_INIT.\n+\n 2008-12-02  Jason Merrill  <jason@redhat.com>\n \n \tPR c++/35782, c++/37860"}, {"sha": "87144324272e96eeeedfbd17e95587cfdc8475a7", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 0, "deletions": 9, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/27fb09b78e186d3d0173ee42cfc0af6801c2a9e2/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/27fb09b78e186d3d0173ee42cfc0af6801c2a9e2/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=27fb09b78e186d3d0173ee42cfc0af6801c2a9e2", "patch": "@@ -9099,15 +9099,6 @@ grokdeclarator (const cp_declarator *declarator,\n \t       is called a converting constructor.  */\n \t    if (explicitp == 2)\n \t      DECL_NONCONVERTING_P (decl) = 1;\n-\t    else if (DECL_CONSTRUCTOR_P (decl))\n-\t      {\n-\t\t/* A constructor with no parms is not a conversion.\n-\t\t   Ignore any compiler-added parms.  */\n-\t\ttree arg_types = FUNCTION_FIRST_USER_PARMTYPE (decl);\n-\n-\t\tif (arg_types == void_list_node)\n-\t\t  DECL_NONCONVERTING_P (decl) = 1;\n-\t      }\n \t  }\n \telse if (TREE_CODE (type) == METHOD_TYPE)\n \t  {"}, {"sha": "db81942eb00e7df890e27fd074a9a5bef4173832", "filename": "gcc/cp/pt.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/27fb09b78e186d3d0173ee42cfc0af6801c2a9e2/gcc%2Fcp%2Fpt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/27fb09b78e186d3d0173ee42cfc0af6801c2a9e2/gcc%2Fcp%2Fpt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fpt.c?ref=27fb09b78e186d3d0173ee42cfc0af6801c2a9e2", "patch": "@@ -11612,6 +11612,7 @@ tsubst_copy_and_build (tree t,\n           }\n \n \tr = build_constructor (init_list_type_node, n);\n+\tCONSTRUCTOR_IS_DIRECT_INIT (r) = CONSTRUCTOR_IS_DIRECT_INIT (t);\n \n \tif (TREE_HAS_CONSTRUCTOR (t))\n \t  return finish_compound_literal (type, r);"}, {"sha": "4a574ebdb1698b1fc58c25222a2f7d65182265e0", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/27fb09b78e186d3d0173ee42cfc0af6801c2a9e2/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/27fb09b78e186d3d0173ee42cfc0af6801c2a9e2/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=27fb09b78e186d3d0173ee42cfc0af6801c2a9e2", "patch": "@@ -1,3 +1,10 @@\n+2008-12-03  Jason Merrill  <jason@redhat.com>\n+\n+\tPR c++/38380\n+\t* g++.dg/cpp0x/initlist10.C: New test.\n+\t* g++.old-deja/g++.eh/ctor1.C: Default ctor is a candidate too.\n+\t* g++.dg/tc1/dr152.C: Likewise.\n+\n 2008-12-03  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR middle-end/38360"}, {"sha": "bf955f513e33d98605d5206145128e48e0ff80d6", "filename": "gcc/testsuite/g++.dg/cpp0x/initlist10.C", "status": "added", "additions": 53, "deletions": 0, "changes": 53, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/27fb09b78e186d3d0173ee42cfc0af6801c2a9e2/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Finitlist10.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/27fb09b78e186d3d0173ee42cfc0af6801c2a9e2/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Finitlist10.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Finitlist10.C?ref=27fb09b78e186d3d0173ee42cfc0af6801c2a9e2", "patch": "@@ -0,0 +1,53 @@\n+// PR c++/38380\n+// { dg-options \"-std=gnu++0x\" }\n+\n+namespace std\n+{\n+ struct atomic_bool\n+  {\n+    bool _M_i;\n+\n+    atomic_bool() = default;\n+    ~atomic_bool() = default;\n+    atomic_bool(const atomic_bool&) = delete;\n+    atomic_bool& operator=(const atomic_bool&) = delete;\n+\n+    explicit atomic_bool(bool __i) { _M_i = __i; }\n+\n+    operator bool() const volatile\n+    { return true; }\n+  };\n+}\n+\n+namespace __gnu_test\n+{\n+  struct direct_list_initializable\n+  {\n+    template<typename _Ttype, typename _Tvalue>\n+      void \n+      operator()()\n+      {\n+        struct _Concept\n+        {\n+          void __constraint()\n+          { \n+            _Ttype __v1 = { }; // default ctor\n+            _Ttype __v2 { __a };  // single-argument ctor\n+          }\n+\n+          _Tvalue __a;\n+        };\n+\n+        void (_Concept::*__x)() __attribute__((unused))\n+          = &_Concept::__constraint;\n+      }\n+  };\n+}\n+\n+int main()\n+{\n+  __gnu_test::direct_list_initializable test;\n+\n+  test.operator()<std::atomic_bool, bool>();\n+  return 0;\n+}"}, {"sha": "cac7aacc0ebc2417c1a49d4bc99f0f32f4385f03", "filename": "gcc/testsuite/g++.dg/tc1/dr152.C", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/27fb09b78e186d3d0173ee42cfc0af6801c2a9e2/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftc1%2Fdr152.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/27fb09b78e186d3d0173ee42cfc0af6801c2a9e2/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftc1%2Fdr152.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftc1%2Fdr152.C?ref=27fb09b78e186d3d0173ee42cfc0af6801c2a9e2", "patch": "@@ -4,7 +4,7 @@\n \n namespace N1 {\n   struct X {\n-    X();\n+    X();\t\t\t// { dg-message \"candidate\" }\n     explicit X(const X&);\n   };\n   void f(X);\n@@ -19,7 +19,7 @@ namespace N1 {\n namespace N2 {\n   template <class T>\n   struct X {\n-    X();\n+    X();\t\t\t// { dg-message \"candidate\" }\n     explicit X(const X&);\n   };\n "}, {"sha": "1cd71c4d82a422752651c6b772dde06fba903ebc", "filename": "gcc/testsuite/g++.old-deja/g++.eh/ctor1.C", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/27fb09b78e186d3d0173ee42cfc0af6801c2a9e2/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.eh%2Fctor1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/27fb09b78e186d3d0173ee42cfc0af6801c2a9e2/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.eh%2Fctor1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.eh%2Fctor1.C?ref=27fb09b78e186d3d0173ee42cfc0af6801c2a9e2", "patch": "@@ -1,7 +1,7 @@\n // { dg-do assemble  }\n struct A\n {\n-  A();\n+  A();\t\t\t\t// { dg-message \"\" } candidate\n   A(A&);\t\t\t// { dg-message \"candidates\" } referenced below\n };\n "}]}