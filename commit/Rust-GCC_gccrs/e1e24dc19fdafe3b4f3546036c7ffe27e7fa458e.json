{"sha": "e1e24dc19fdafe3b4f3546036c7ffe27e7fa458e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTFlMjRkYzE5ZmRhZmUzYjRmMzU0NjAzNmM3ZmZlMjdlN2ZhNDU4ZQ==", "commit": {"author": {"name": "Paul Thomas", "email": "pault@gcc.gnu.org", "date": "2007-03-08T09:09:38Z"}, "committer": {"name": "Paul Thomas", "email": "pault@gcc.gnu.org", "date": "2007-03-08T09:09:38Z"}, "message": "re PR fortran/31011 ([4.2 and 4.1 only] Incorrect error: parameter array sections)\n\n2007-03-08 Paul Thomas <pault@gcc.gnu.org>\n\n\tPR fortran/31011\n\t* expr.c (find_array_section): Correct arithmetic for section\n\tsize.\n\n2007-03-08 Paul Thomas <pault@gcc.gnu.org>\n\n\tPR fortran/31011\n\t* gfortran.dg/parameter_array_section_2.f90: New test.\n\nFrom-SVN: r122689", "tree": {"sha": "4cb8e99c383163f57a3dbf5b820f948d8303dd4e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4cb8e99c383163f57a3dbf5b820f948d8303dd4e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e1e24dc19fdafe3b4f3546036c7ffe27e7fa458e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e1e24dc19fdafe3b4f3546036c7ffe27e7fa458e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e1e24dc19fdafe3b4f3546036c7ffe27e7fa458e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e1e24dc19fdafe3b4f3546036c7ffe27e7fa458e/comments", "author": null, "committer": null, "parents": [{"sha": "1916c916caf5b22b43ba62974586ffbd3b89b406", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1916c916caf5b22b43ba62974586ffbd3b89b406", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1916c916caf5b22b43ba62974586ffbd3b89b406"}], "stats": {"total": 28, "additions": 26, "deletions": 2}, "files": [{"sha": "987bc50d53975afd8a15f31b950e9d23e699a7f6", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e1e24dc19fdafe3b4f3546036c7ffe27e7fa458e/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e1e24dc19fdafe3b4f3546036c7ffe27e7fa458e/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=e1e24dc19fdafe3b4f3546036c7ffe27e7fa458e", "patch": "@@ -1,3 +1,9 @@\n+2007-03-08  Paul Thomas  <pault@gcc.gnu.org>\r\n+\r\n+\tPR fortran/31011\r\n+\t* expr.c (find_array_section): Correct arithmetic for section\r\n+\tsize.\r\n+\r\n 2007-03-07  Brooks Moses  <brooks.moses@codesourcery.com>\n \n \t* iresolve.c (gfc_resolve_ishftc): Correct s_kind value."}, {"sha": "06f4d20ef45c970bf5d88dcd287ae8032158a905", "filename": "gcc/fortran/expr.c", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e1e24dc19fdafe3b4f3546036c7ffe27e7fa458e/gcc%2Ffortran%2Fexpr.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e1e24dc19fdafe3b4f3546036c7ffe27e7fa458e/gcc%2Ffortran%2Fexpr.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fexpr.c?ref=e1e24dc19fdafe3b4f3546036c7ffe27e7fa458e", "patch": "@@ -1137,8 +1137,7 @@ find_array_section (gfc_expr *expr, gfc_ref *ref)\n \t    }\n \n \t  /* Calculate the number of elements and the shape.  */\n-\t  mpz_abs (tmp_mpz, stride[d]);\n-\t  mpz_div (tmp_mpz, stride[d], tmp_mpz);\n+\t  mpz_set (tmp_mpz, stride[d]);\n \t  mpz_add (tmp_mpz, end[d], tmp_mpz);\n \t  mpz_sub (tmp_mpz, tmp_mpz, ctr[d]);\n \t  mpz_div (tmp_mpz, tmp_mpz, stride[d]);"}, {"sha": "6267c8ad8fd3fdab1c500bc3a9f26d726d499b59", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e1e24dc19fdafe3b4f3546036c7ffe27e7fa458e/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e1e24dc19fdafe3b4f3546036c7ffe27e7fa458e/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=e1e24dc19fdafe3b4f3546036c7ffe27e7fa458e", "patch": "@@ -1,3 +1,8 @@\n+2007-03-08  Paul Thomas  <pault@gcc.gnu.org>\r\n+\r\n+\tPR fortran/31011\r\n+\t* gfortran.dg/parameter_array_section_2.f90: New test.\r\n+\n 2007-03-08  Volker Reichelt  <reichelt@netcologne.de>\n \n \tPR c++/30852"}, {"sha": "aa212c050fa96ca5f0913b8ea30b24fc7c5a7a5a", "filename": "gcc/testsuite/gfortran.dg/parameter_array_section_2.f90", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e1e24dc19fdafe3b4f3546036c7ffe27e7fa458e/gcc%2Ftestsuite%2Fgfortran.dg%2Fparameter_array_section_2.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e1e24dc19fdafe3b4f3546036c7ffe27e7fa458e/gcc%2Ftestsuite%2Fgfortran.dg%2Fparameter_array_section_2.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fparameter_array_section_2.f90?ref=e1e24dc19fdafe3b4f3546036c7ffe27e7fa458e", "patch": "@@ -0,0 +1,14 @@\n+! { dg-do run }\n+! { dg-options \"-O\" }\n+! Test the fix for PR31011 in which the length of the array sections\n+! with stride other than unity were incorrectly calculated.\n+!\n+! Contributed by <terry@chem.gu.se>\n+!\n+program PotentialMatrix\n+ implicit none\n+ real(kind=8),dimension(2),parameter::v2=(/1,2/)\n+ real(kind=8),dimension(4),parameter::v4=(/1,2,3,4/)\n+ if (any (v2*v4(1:3:2) .ne. (/1,6/))) call abort ()\n+ if (any (v2*v4(3:1:-2) .ne. (/3,2/))) call abort ()\n+end"}]}