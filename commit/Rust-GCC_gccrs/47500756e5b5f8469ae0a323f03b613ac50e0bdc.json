{"sha": "47500756e5b5f8469ae0a323f03b613ac50e0bdc", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDc1MDA3NTZlNWI1Zjg0NjlhZTBhMzIzZjAzYjYxM2FjNTBlMGJkYw==", "commit": {"author": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2013-08-30T08:11:41Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2013-08-30T08:11:41Z"}, "message": "* tree.c (set_call_expr_flags): Fix handling of TM_PURE.\n\nFrom-SVN: r202098", "tree": {"sha": "fc647f8a81a976e0d62bf7a102c25fff3ed64626", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/fc647f8a81a976e0d62bf7a102c25fff3ed64626"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/47500756e5b5f8469ae0a323f03b613ac50e0bdc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/47500756e5b5f8469ae0a323f03b613ac50e0bdc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/47500756e5b5f8469ae0a323f03b613ac50e0bdc", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/47500756e5b5f8469ae0a323f03b613ac50e0bdc/comments", "author": null, "committer": null, "parents": [{"sha": "6e8dad054f8de5c33f3837c84b4f4be57e83e7da", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6e8dad054f8de5c33f3837c84b4f4be57e83e7da", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6e8dad054f8de5c33f3837c84b4f4be57e83e7da"}], "stats": {"total": 12, "additions": 9, "deletions": 3}, "files": [{"sha": "171988a5c5aaecf775fdb890501acfbcf2487343", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/47500756e5b5f8469ae0a323f03b613ac50e0bdc/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/47500756e5b5f8469ae0a323f03b613ac50e0bdc/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=47500756e5b5f8469ae0a323f03b613ac50e0bdc", "patch": "@@ -1,3 +1,7 @@\n+2013-08-29  Jan Hubicka  <jh@suse.cz>\n+\n+\t* tree.c (set_call_expr_flags): Fix handling of TM_PURE.\n+\n 2013-08-30  Richard Biener  <rguenther@suse.de>\n \n \tPR tree-optimization/58228"}, {"sha": "5ed0d1deff55c63591c4b5c0f25283308dadb968", "filename": "gcc/tree.c", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/47500756e5b5f8469ae0a323f03b613ac50e0bdc/gcc%2Ftree.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/47500756e5b5f8469ae0a323f03b613ac50e0bdc/gcc%2Ftree.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree.c?ref=47500756e5b5f8469ae0a323f03b613ac50e0bdc", "patch": "@@ -9794,7 +9794,10 @@ build_common_tree_nodes (bool signed_char, bool short_double)\n   }\n }\n \n-/* Modify DECL for given flags.  */\n+/* Modify DECL for given flags.\n+   TM_PURE attribute is set only on types, so the function will modify\n+   DECL's type when ECF_TM_PURE is used.  */\n+\n void\n set_call_expr_flags (tree decl, int flags)\n {\n@@ -9818,8 +9821,7 @@ set_call_expr_flags (tree decl, int flags)\n     DECL_ATTRIBUTES (decl) = tree_cons (get_identifier (\"leaf\"),\n \t\t\t\t\tNULL, DECL_ATTRIBUTES (decl));\n   if ((flags & ECF_TM_PURE) && flag_tm)\n-    DECL_ATTRIBUTES (decl) = tree_cons (get_identifier (\"transaction_pure\"),\n-\t\t\t\t\tNULL, DECL_ATTRIBUTES (decl));\n+    apply_tm_attr (decl, get_identifier (\"transaction_pure\"));\n   /* Looping const or pure is implied by noreturn.\n      There is currently no way to declare looping const or looping pure alone.  */\n   gcc_assert (!(flags & ECF_LOOPING_CONST_OR_PURE)"}]}