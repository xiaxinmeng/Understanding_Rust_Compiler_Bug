{"sha": "a79db151ccd666c3c5e47454f52ee316fd766aad", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTc5ZGIxNTFjY2Q2NjZjM2M1ZTQ3NDU0ZjUyZWUzMTZmZDc2NmFhZA==", "commit": {"author": {"name": "Segher Boessenkool", "email": "segher@kernel.crashing.org", "date": "2018-08-16T19:42:36Z"}, "committer": {"name": "Segher Boessenkool", "email": "segher@gcc.gnu.org", "date": "2018-08-16T19:42:36Z"}, "message": "rs6000: Remove \"length 4\" from branch insns\n\nNow that it is the default for branch insns like for all other insns,\nwe don't need to set it explicitly so often anymore.\n\n\n\t* config/rs6000/altivec.md: Don't set length attribute to the default\n\tvalue, for branch instructions.\n\t* config/rs6000/darwin.md: Ditto.\n\t* config/rs6000/rs6000.md: Ditto.\n\nFrom-SVN: r263602", "tree": {"sha": "b424169f441655a13f8c99f922cebf019e1c261e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b424169f441655a13f8c99f922cebf019e1c261e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a79db151ccd666c3c5e47454f52ee316fd766aad", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a79db151ccd666c3c5e47454f52ee316fd766aad", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a79db151ccd666c3c5e47454f52ee316fd766aad", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a79db151ccd666c3c5e47454f52ee316fd766aad/comments", "author": {"login": "segher", "id": 417629, "node_id": "MDQ6VXNlcjQxNzYyOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/417629?v=4", "gravatar_id": "", "url": "https://api.github.com/users/segher", "html_url": "https://github.com/segher", "followers_url": "https://api.github.com/users/segher/followers", "following_url": "https://api.github.com/users/segher/following{/other_user}", "gists_url": "https://api.github.com/users/segher/gists{/gist_id}", "starred_url": "https://api.github.com/users/segher/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/segher/subscriptions", "organizations_url": "https://api.github.com/users/segher/orgs", "repos_url": "https://api.github.com/users/segher/repos", "events_url": "https://api.github.com/users/segher/events{/privacy}", "received_events_url": "https://api.github.com/users/segher/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "cdce4d18f9688b22580930b155206b1ff19ce497", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cdce4d18f9688b22580930b155206b1ff19ce497", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cdce4d18f9688b22580930b155206b1ff19ce497"}], "stats": {"total": 108, "additions": 40, "deletions": 68}, "files": [{"sha": "19f675d307111751c83a604d03f348835bd3a8af", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a79db151ccd666c3c5e47454f52ee316fd766aad/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a79db151ccd666c3c5e47454f52ee316fd766aad/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=a79db151ccd666c3c5e47454f52ee316fd766aad", "patch": "@@ -1,3 +1,10 @@\n+2018-08-16  Segher Boessenkool  <segher@kernel.crashing.org>\n+\n+\t* config/rs6000/altivec.md: Don't set length attribute to the default\n+\tvalue, for branch instructions.\n+\t* config/rs6000/darwin.md: Ditto.\n+\t* config/rs6000/rs6000.md: Ditto.\n+\n 2018-08-16  Segher Boessenkool  <segher@kernel.crashing.org>\n \n \t* config/rs6000/rs6000.md (length): Always define as const_int 4."}, {"sha": "1af96877424f9d43a6293f1e1c06e6ebb0818f86", "filename": "gcc/config/rs6000/altivec.md", "status": "modified", "additions": 5, "deletions": 10, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a79db151ccd666c3c5e47454f52ee316fd766aad/gcc%2Fconfig%2Frs6000%2Faltivec.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a79db151ccd666c3c5e47454f52ee316fd766aad/gcc%2Fconfig%2Frs6000%2Faltivec.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Faltivec.md?ref=a79db151ccd666c3c5e47454f52ee316fd766aad", "patch": "@@ -413,8 +413,7 @@\n                    (use (match_operand:SI 1 \"call_operand\" \"s\"))])]\n  \"TARGET_MACHO && (DEFAULT_ABI == ABI_DARWIN) && TARGET_32BIT\"         \n  \"bl %z1\"\n-  [(set_attr \"type\" \"branch\")\n-   (set_attr \"length\" \"4\")])\n+  [(set_attr \"type\" \"branch\")])\n \n (define_insn \"*restore_world\"\n  [(match_parallel 0 \"restore_world_operation\"\n@@ -441,8 +440,7 @@\n \t   (match_operand:V4SI 4 \"altivec_register_operand\" \"v\"))])]\n   \"TARGET_ALTIVEC\"\n   \"bl %1\"\n-  [(set_attr \"type\" \"branch\")\n-   (set_attr \"length\" \"4\")])\n+  [(set_attr \"type\" \"branch\")])\n \n (define_insn \"*save_vregs_<mode>_r12\"\n   [(match_parallel 0 \"any_parallel_operand\"\n@@ -455,8 +453,7 @@\n \t   (match_operand:V4SI 4 \"altivec_register_operand\" \"v\"))])]\n   \"TARGET_ALTIVEC\"\n   \"bl %1\"\n-  [(set_attr \"type\" \"branch\")\n-   (set_attr \"length\" \"4\")])\n+  [(set_attr \"type\" \"branch\")])\n \n (define_insn \"*restore_vregs_<mode>_r11\"\n   [(match_parallel 0 \"any_parallel_operand\"\n@@ -469,8 +466,7 @@\n \t\t\t     (match_operand:P 4 \"short_cint_operand\" \"I\"))))])]\n   \"TARGET_ALTIVEC\"\n   \"bl %1\"\n-  [(set_attr \"type\" \"branch\")\n-   (set_attr \"length\" \"4\")])\n+  [(set_attr \"type\" \"branch\")])\n \n (define_insn \"*restore_vregs_<mode>_r12\"\n   [(match_parallel 0 \"any_parallel_operand\"\n@@ -483,8 +479,7 @@\n \t\t\t     (match_operand:P 4 \"short_cint_operand\" \"I\"))))])]\n   \"TARGET_ALTIVEC\"\n   \"bl %1\"\n-  [(set_attr \"type\" \"branch\")\n-   (set_attr \"length\" \"4\")])\n+  [(set_attr \"type\" \"branch\")])\n \n ;; Simple binary operations.\n "}, {"sha": "7c429a5e18095bc5378bdf16c896db2ce2d6e033", "filename": "gcc/config/rs6000/darwin.md", "status": "modified", "additions": 4, "deletions": 8, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a79db151ccd666c3c5e47454f52ee316fd766aad/gcc%2Fconfig%2Frs6000%2Fdarwin.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a79db151ccd666c3c5e47454f52ee316fd766aad/gcc%2Fconfig%2Frs6000%2Fdarwin.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Fdarwin.md?ref=a79db151ccd666c3c5e47454f52ee316fd766aad", "patch": "@@ -263,8 +263,7 @@ You should have received a copy of the GNU General Public License\n   return \"bcl 20,31,%0\\n%0:\";\n }\n   [(set_attr \"type\" \"branch\")\n-   (set_attr \"cannot_copy\" \"yes\")\n-   (set_attr \"length\" \"4\")])\n+   (set_attr \"cannot_copy\" \"yes\")])\n \n (define_insn \"load_macho_picbase_di\"\n   [(set (reg:DI LR_REGNO)\n@@ -280,8 +279,7 @@ You should have received a copy of the GNU General Public License\n   return \"bcl 20,31,%0\\n%0:\";\n }\n   [(set_attr \"type\" \"branch\")\n-   (set_attr \"cannot_copy\" \"yes\")\n-   (set_attr \"length\" \"4\")])\n+   (set_attr \"cannot_copy\" \"yes\")])\n \n (define_expand \"macho_correct_pic\"\n   [(set (match_operand 0 \"\")\n@@ -416,8 +414,7 @@ You should have received a copy of the GNU General Public License\n     return \"bcl 20,31,%0\\n%0:\";\n }\n   [(set_attr \"type\" \"branch\")\n-   (set_attr \"cannot_copy\" \"yes\")\n-   (set_attr \"length\" \"4\")])\n+   (set_attr \"cannot_copy\" \"yes\")])\n \n (define_insn \"reload_macho_picbase_di\"\n   [(set (reg:DI LR_REGNO)\n@@ -440,8 +437,7 @@ You should have received a copy of the GNU General Public License\n     return \"bcl 20,31,%0\\n%0:\";\n }\n   [(set_attr \"type\" \"branch\")\n-   (set_attr \"cannot_copy\" \"yes\")\n-   (set_attr \"length\" \"4\")])\n+   (set_attr \"cannot_copy\" \"yes\")])\n \n ;; We need to restore the PIC register, at the site of nonlocal label.\n "}, {"sha": "c066baeeecca1848af9a4c913d3d4e2e5805b2c3", "filename": "gcc/config/rs6000/rs6000.md", "status": "modified", "additions": 24, "deletions": 50, "changes": 74, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a79db151ccd666c3c5e47454f52ee316fd766aad/gcc%2Fconfig%2Frs6000%2Frs6000.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a79db151ccd666c3c5e47454f52ee316fd766aad/gcc%2Fconfig%2Frs6000%2Frs6000.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.md?ref=a79db151ccd666c3c5e47454f52ee316fd766aad", "patch": "@@ -9450,8 +9450,7 @@\n     }\n   return \"bl %z1(%3@tlsgd)\";\n }\n-  [(set_attr \"type\" \"branch\")\n-   (set_attr \"length\" \"4\")])\n+  [(set_attr \"type\" \"branch\")])\n \n (define_insn_and_split \"tls_ld_aix<TLSmode:tls_abi_suffix>\"\n   [(set (match_operand:TLSmode 0 \"gpc_reg_operand\" \"=b\")\n@@ -9584,8 +9583,7 @@\n     }\n   return \"bl %z1(%&@tlsld)\";\n }\n-  [(set_attr \"type\" \"branch\")\n-   (set_attr \"length\" \"4\")])\n+  [(set_attr \"type\" \"branch\")])\n \n (define_insn \"tls_dtprel_<TLSmode:tls_abi_suffix>\"\n   [(set (match_operand:TLSmode 0 \"gpc_reg_operand\" \"=r\")\n@@ -10028,8 +10026,7 @@\n \t(unspec:SI [(const_int 0)] UNSPEC_TOC))]\n   \"DEFAULT_ABI == ABI_V4 && flag_pic == 1 && TARGET_32BIT\"\n   \"bl _GLOBAL_OFFSET_TABLE_@local-4\"\n-  [(set_attr \"type\" \"branch\")\n-   (set_attr \"length\" \"4\")])\n+  [(set_attr \"type\" \"branch\")])\n \n (define_expand \"load_toc_v4_PIC_1\"\n   [(parallel [(set (reg:SI LR_REGNO)\n@@ -10047,7 +10044,6 @@\n    && (flag_pic == 2 || (flag_pic && TARGET_SECURE_PLT))\"\n   \"bcl 20,31,%0\\n%0:\"\n   [(set_attr \"type\" \"branch\")\n-   (set_attr \"length\" \"4\")\n    (set_attr \"cannot_copy\" \"yes\")])\n \n (define_insn \"load_toc_v4_PIC_1_476\"\n@@ -10065,7 +10061,6 @@\n   return templ;\n }\n   [(set_attr \"type\" \"branch\")\n-   (set_attr \"length\" \"4\")\n    (set_attr \"cannot_copy\" \"yes\")])\n \n (define_expand \"load_toc_v4_PIC_1b\"\n@@ -10649,8 +10644,7 @@\n    (clobber (reg:P LR_REGNO))]\n   \"DEFAULT_ABI == ABI_AIX || DEFAULT_ABI == ABI_ELFv2\"\n   \"bl %z0\"\n-  [(set_attr \"type\" \"branch\")\n-   (set_attr \"length\" \"4\")])\n+  [(set_attr \"type\" \"branch\")])\n \n (define_insn \"*call_value_local_aix<mode>\"\n   [(set (match_operand 0 \"\" \"\")\n@@ -10659,8 +10653,7 @@\n    (clobber (reg:P LR_REGNO))]\n   \"DEFAULT_ABI == ABI_AIX || DEFAULT_ABI == ABI_ELFv2\"\n   \"bl %z1\"\n-  [(set_attr \"type\" \"branch\")\n-   (set_attr \"length\" \"4\")])\n+  [(set_attr \"type\" \"branch\")])\n \n ;; Call to AIX abi function which may be in another module.\n ;; Restore the TOC pointer (r2) after the call.\n@@ -11043,8 +11036,7 @@\n   \"@\n    b %z0\n    b%T0\"\n-  [(set_attr \"type\" \"branch\")\n-   (set_attr \"length\" \"4\")])\n+  [(set_attr \"type\" \"branch\")])\n \n (define_insn \"*sibcall_value_aix<mode>\"\n   [(set (match_operand 0 \"\" \"\")\n@@ -11055,8 +11047,7 @@\n   \"@\n    b %z1\n    b%T1\"\n-  [(set_attr \"type\" \"branch\")\n-   (set_attr \"length\" \"4\")])\n+  [(set_attr \"type\" \"branch\")])\n \n (define_expand \"sibcall_epilogue\"\n   [(use (const_int 0))]\n@@ -12985,8 +12976,7 @@\n \t\t\t (match_operand:P 3 \"gpc_reg_operand\" \"r\"))])]\n   \"\"\n   \"bl %1\"\n-  [(set_attr \"type\" \"branch\")\n-   (set_attr \"length\" \"4\")])\n+  [(set_attr \"type\" \"branch\")])\n \n (define_insn \"*save_gpregs_<mode>_r12\"\n   [(match_parallel 0 \"any_parallel_operand\"\n@@ -12997,8 +12987,7 @@\n \t\t\t (match_operand:P 3 \"gpc_reg_operand\" \"r\"))])]\n   \"\"\n   \"bl %1\"\n-  [(set_attr \"type\" \"branch\")\n-   (set_attr \"length\" \"4\")])\n+  [(set_attr \"type\" \"branch\")])\n \n (define_insn \"*save_gpregs_<mode>_r1\"\n   [(match_parallel 0 \"any_parallel_operand\"\n@@ -13009,8 +12998,7 @@\n \t\t\t (match_operand:P 3 \"gpc_reg_operand\" \"r\"))])]\n   \"\"\n   \"bl %1\"\n-  [(set_attr \"type\" \"branch\")\n-   (set_attr \"length\" \"4\")])\n+  [(set_attr \"type\" \"branch\")])\n \n (define_insn \"*save_fpregs_<mode>_r11\"\n   [(match_parallel 0 \"any_parallel_operand\"\n@@ -13021,8 +13009,7 @@\n \t\t\t (match_operand:DF 3 \"gpc_reg_operand\" \"d\"))])]\n   \"\"\n   \"bl %1\"\n-  [(set_attr \"type\" \"branch\")\n-   (set_attr \"length\" \"4\")])\n+  [(set_attr \"type\" \"branch\")])\n \n (define_insn \"*save_fpregs_<mode>_r12\"\n   [(match_parallel 0 \"any_parallel_operand\"\n@@ -13033,8 +13020,7 @@\n \t\t\t (match_operand:DF 3 \"gpc_reg_operand\" \"d\"))])]\n   \"\"\n   \"bl %1\"\n-  [(set_attr \"type\" \"branch\")\n-   (set_attr \"length\" \"4\")])\n+  [(set_attr \"type\" \"branch\")])\n \n (define_insn \"*save_fpregs_<mode>_r1\"\n   [(match_parallel 0 \"any_parallel_operand\"\n@@ -13045,8 +13031,7 @@\n \t\t\t (match_operand:DF 3 \"gpc_reg_operand\" \"d\"))])]\n   \"\"\n   \"bl %1\"\n-  [(set_attr \"type\" \"branch\")\n-   (set_attr \"length\" \"4\")])\n+  [(set_attr \"type\" \"branch\")])\n \n ; This is to explain that changes to the stack pointer should\n ; not be moved over loads from or stores to stack memory.\n@@ -13163,8 +13148,7 @@\n \t\t\t(match_operand:P 3 \"memory_operand\" \"m\"))])]\n  \"\"\n  \"bl %1\"\n- [(set_attr \"type\" \"branch\")\n-  (set_attr \"length\" \"4\")])\n+ [(set_attr \"type\" \"branch\")])\n \n (define_insn \"*restore_gpregs_<mode>_r12\"\n  [(match_parallel 0 \"any_parallel_operand\"\n@@ -13175,8 +13159,7 @@\n \t\t\t(match_operand:P 3 \"memory_operand\" \"m\"))])]\n  \"\"\n  \"bl %1\"\n- [(set_attr \"type\" \"branch\")\n-  (set_attr \"length\" \"4\")])\n+ [(set_attr \"type\" \"branch\")])\n \n (define_insn \"*restore_gpregs_<mode>_r1\"\n  [(match_parallel 0 \"any_parallel_operand\"\n@@ -13187,8 +13170,7 @@\n \t\t\t(match_operand:P 3 \"memory_operand\" \"m\"))])]\n  \"\"\n  \"bl %1\"\n- [(set_attr \"type\" \"branch\")\n-  (set_attr \"length\" \"4\")])\n+ [(set_attr \"type\" \"branch\")])\n \n (define_insn \"*return_and_restore_gpregs_<mode>_r11\"\n  [(match_parallel 0 \"any_parallel_operand\"\n@@ -13200,8 +13182,7 @@\n \t\t\t(match_operand:P 3 \"memory_operand\" \"m\"))])]\n  \"\"\n  \"b %1\"\n- [(set_attr \"type\" \"branch\")\n-  (set_attr \"length\" \"4\")])\n+ [(set_attr \"type\" \"branch\")])\n \n (define_insn \"*return_and_restore_gpregs_<mode>_r12\"\n  [(match_parallel 0 \"any_parallel_operand\"\n@@ -13213,8 +13194,7 @@\n \t\t\t(match_operand:P 3 \"memory_operand\" \"m\"))])]\n  \"\"\n  \"b %1\"\n- [(set_attr \"type\" \"branch\")\n-  (set_attr \"length\" \"4\")])\n+ [(set_attr \"type\" \"branch\")])\n \n (define_insn \"*return_and_restore_gpregs_<mode>_r1\"\n  [(match_parallel 0 \"any_parallel_operand\"\n@@ -13226,8 +13206,7 @@\n \t\t\t(match_operand:P 3 \"memory_operand\" \"m\"))])]\n  \"\"\n  \"b %1\"\n- [(set_attr \"type\" \"branch\")\n-  (set_attr \"length\" \"4\")])\n+ [(set_attr \"type\" \"branch\")])\n \n (define_insn \"*return_and_restore_fpregs_<mode>_r11\"\n  [(match_parallel 0 \"any_parallel_operand\"\n@@ -13239,8 +13218,7 @@\n \t\t\t(match_operand:DF 3 \"memory_operand\" \"m\"))])]\n  \"\"\n  \"b %1\"\n- [(set_attr \"type\" \"branch\")\n-  (set_attr \"length\" \"4\")])\n+ [(set_attr \"type\" \"branch\")])\n \n (define_insn \"*return_and_restore_fpregs_<mode>_r12\"\n  [(match_parallel 0 \"any_parallel_operand\"\n@@ -13252,8 +13230,7 @@\n \t\t\t(match_operand:DF 3 \"memory_operand\" \"m\"))])]\n  \"\"\n  \"b %1\"\n- [(set_attr \"type\" \"branch\")\n-  (set_attr \"length\" \"4\")])\n+ [(set_attr \"type\" \"branch\")])\n \n (define_insn \"*return_and_restore_fpregs_<mode>_r1\"\n  [(match_parallel 0 \"any_parallel_operand\"\n@@ -13265,8 +13242,7 @@\n \t\t\t(match_operand:DF 3 \"memory_operand\" \"m\"))])]\n  \"\"\n  \"b %1\"\n- [(set_attr \"type\" \"branch\")\n-  (set_attr \"length\" \"4\")])\n+ [(set_attr \"type\" \"branch\")])\n \n (define_insn \"*return_and_restore_fpregs_aix_<mode>_r11\"\n  [(match_parallel 0 \"any_parallel_operand\"\n@@ -13277,8 +13253,7 @@\n \t\t\t(match_operand:DF 3 \"memory_operand\" \"m\"))])]\n  \"\"\n  \"b %1\"\n- [(set_attr \"type\" \"branch\")\n-  (set_attr \"length\" \"4\")])\n+ [(set_attr \"type\" \"branch\")])\n \n (define_insn \"*return_and_restore_fpregs_aix_<mode>_r1\"\n  [(match_parallel 0 \"any_parallel_operand\"\n@@ -13289,8 +13264,7 @@\n \t\t\t(match_operand:DF 3 \"memory_operand\" \"m\"))])]\n  \"\"\n  \"b %1\"\n- [(set_attr \"type\" \"branch\")\n-  (set_attr \"length\" \"4\")])\n+ [(set_attr \"type\" \"branch\")])\n \n ; This is used in compiling the unwind routines.\n (define_expand \"eh_return\""}]}