{"sha": "eacb16dc798d06acfb9741a2496584ab0728257a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWFjYjE2ZGM3OThkMDZhY2ZiOTc0MWEyNDk2NTg0YWIwNzI4MjU3YQ==", "commit": {"author": {"name": "David Malcolm", "email": "dmalcolm@redhat.com", "date": "2018-06-28T20:24:49Z"}, "committer": {"name": "David Malcolm", "email": "dmalcolm@gcc.gnu.org", "date": "2018-06-28T20:24:49Z"}, "message": "C++: less verbose error-recovery for version conflict markers\n\ngcc/cp/ChangeLog:\n\t* parser.c (cp_parser_error_1): After issuing a conflict marker\n\terror, consume tokens until the end of the source line.\n\ngcc/testsuite/ChangeLog:\n\t* g++.dg/conflict-markers-2.C: New test.\n\nFrom-SVN: r262232", "tree": {"sha": "608e9506c05b1ab10f75647e2a1b246d7aa00777", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/608e9506c05b1ab10f75647e2a1b246d7aa00777"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/eacb16dc798d06acfb9741a2496584ab0728257a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/eacb16dc798d06acfb9741a2496584ab0728257a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/eacb16dc798d06acfb9741a2496584ab0728257a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/eacb16dc798d06acfb9741a2496584ab0728257a/comments", "author": {"login": "davidmalcolm", "id": 1553248, "node_id": "MDQ6VXNlcjE1NTMyNDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1553248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidmalcolm", "html_url": "https://github.com/davidmalcolm", "followers_url": "https://api.github.com/users/davidmalcolm/followers", "following_url": "https://api.github.com/users/davidmalcolm/following{/other_user}", "gists_url": "https://api.github.com/users/davidmalcolm/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidmalcolm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidmalcolm/subscriptions", "organizations_url": "https://api.github.com/users/davidmalcolm/orgs", "repos_url": "https://api.github.com/users/davidmalcolm/repos", "events_url": "https://api.github.com/users/davidmalcolm/events{/privacy}", "received_events_url": "https://api.github.com/users/davidmalcolm/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "b8be1451289da4dfd69673b768bdc0e901a0fcef", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b8be1451289da4dfd69673b768bdc0e901a0fcef", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b8be1451289da4dfd69673b768bdc0e901a0fcef"}], "stats": {"total": 36, "additions": 36, "deletions": 0}, "files": [{"sha": "906f0b41678d4b978a231d5e537c443018876fbc", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eacb16dc798d06acfb9741a2496584ab0728257a/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eacb16dc798d06acfb9741a2496584ab0728257a/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=eacb16dc798d06acfb9741a2496584ab0728257a", "patch": "@@ -1,3 +1,8 @@\n+2018-06-28  David Malcolm  <dmalcolm@redhat.com>\n+\n+\t* parser.c (cp_parser_error_1): After issuing a conflict marker\n+\terror, consume tokens until the end of the source line.\n+\n 2018-06-28  Jason Merrill  <jason@redhat.com>\n \n \tPR c++/86342 - -Wdeprecated-copy and system headers."}, {"sha": "a076de146e6c4e7ab5db159171fcaaf8278b245c", "filename": "gcc/cp/parser.c", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eacb16dc798d06acfb9741a2496584ab0728257a/gcc%2Fcp%2Fparser.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eacb16dc798d06acfb9741a2496584ab0728257a/gcc%2Fcp%2Fparser.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fparser.c?ref=eacb16dc798d06acfb9741a2496584ab0728257a", "patch": "@@ -2862,6 +2862,20 @@ cp_parser_error_1 (cp_parser* parser, const char* gmsgid,\n       if (cp_lexer_peek_conflict_marker (parser->lexer, token->type, &loc))\n \t{\n \t  error_at (loc, \"version control conflict marker in file\");\n+\t  expanded_location token_exploc = expand_location (token->location);\n+\t  /* Consume tokens until the end of the source line.  */\n+\t  while (1)\n+\t    {\n+\t      cp_lexer_consume_token (parser->lexer);\n+\t      cp_token *next = cp_lexer_peek_token (parser->lexer);\n+\t      if (next == NULL)\n+\t\tbreak;\n+\t      expanded_location next_exploc = expand_location (next->location);\n+\t      if (next_exploc.file != token_exploc.file)\n+\t\tbreak;\n+\t      if (next_exploc.line != token_exploc.line)\n+\t\tbreak;\n+\t    }\n \t  return;\n \t}\n     }"}, {"sha": "4fc38207184fdb3f09e526a122c56d11056d8160", "filename": "gcc/testsuite/g++.dg/conflict-markers-2.C", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eacb16dc798d06acfb9741a2496584ab0728257a/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fconflict-markers-2.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eacb16dc798d06acfb9741a2496584ab0728257a/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fconflict-markers-2.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fconflict-markers-2.C?ref=eacb16dc798d06acfb9741a2496584ab0728257a", "patch": "@@ -0,0 +1,17 @@\n+// { dg-do compile { target c++11 } }\n+\n+extern void f1 (void);\n+extern void f2 (void);\n+extern void f3 (void);\n+extern void f4 (void);\n+\n+void test ()\n+{\n+  f1 ();\n+<<<<<<< HEAD // { dg-error \"conflict marker\" }\n+  f2 ();\n+======= // { dg-error \"conflict marker\" }\n+  f3 ();\n+>>>>>>> 252be53... Some commit message // { dg-error \"conflict marker\" }\n+  f4 ();\n+}"}]}