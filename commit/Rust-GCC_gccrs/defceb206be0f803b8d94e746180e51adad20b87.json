{"sha": "defceb206be0f803b8d94e746180e51adad20b87", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZGVmY2ViMjA2YmUwZjgwM2I4ZDk0ZTc0NjE4MGU1MWFkYWQyMGI4Nw==", "commit": {"author": {"name": "Marek Polacek", "email": "polacek@redhat.com", "date": "2020-09-21T17:24:25Z"}, "committer": {"name": "Marek Polacek", "email": "polacek@redhat.com", "date": "2020-09-21T22:13:37Z"}, "message": "c++: DR 1722: Make lambda to function pointer conv noexcept [PR90583]\n\nDR 1722 clarifies that the conversion function from lambda to pointer to\nfunction should be noexcept(true).\n\ngcc/cp/ChangeLog:\n\n\tPR c++/90583\n\tDR 1722\n\t* lambda.c (maybe_add_lambda_conv_op): Mark the conversion function\n\tas noexcept.\n\ngcc/testsuite/ChangeLog:\n\n\tPR c++/90583\n\tDR 1722\n\t* g++.dg/cpp0x/lambda/lambda-conv14.C: New test.", "tree": {"sha": "872c615b9b5569c3385d9a387c50266f47ac214b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/872c615b9b5569c3385d9a387c50266f47ac214b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/defceb206be0f803b8d94e746180e51adad20b87", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/defceb206be0f803b8d94e746180e51adad20b87", "html_url": "https://github.com/Rust-GCC/gccrs/commit/defceb206be0f803b8d94e746180e51adad20b87", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/defceb206be0f803b8d94e746180e51adad20b87/comments", "author": {"login": "mpolacek", "id": 10496300, "node_id": "MDQ6VXNlcjEwNDk2MzAw", "avatar_url": "https://avatars.githubusercontent.com/u/10496300?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mpolacek", "html_url": "https://github.com/mpolacek", "followers_url": "https://api.github.com/users/mpolacek/followers", "following_url": "https://api.github.com/users/mpolacek/following{/other_user}", "gists_url": "https://api.github.com/users/mpolacek/gists{/gist_id}", "starred_url": "https://api.github.com/users/mpolacek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mpolacek/subscriptions", "organizations_url": "https://api.github.com/users/mpolacek/orgs", "repos_url": "https://api.github.com/users/mpolacek/repos", "events_url": "https://api.github.com/users/mpolacek/events{/privacy}", "received_events_url": "https://api.github.com/users/mpolacek/received_events", "type": "User", "site_admin": false}, "committer": {"login": "mpolacek", "id": 10496300, "node_id": "MDQ6VXNlcjEwNDk2MzAw", "avatar_url": "https://avatars.githubusercontent.com/u/10496300?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mpolacek", "html_url": "https://github.com/mpolacek", "followers_url": "https://api.github.com/users/mpolacek/followers", "following_url": "https://api.github.com/users/mpolacek/following{/other_user}", "gists_url": "https://api.github.com/users/mpolacek/gists{/gist_id}", "starred_url": "https://api.github.com/users/mpolacek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mpolacek/subscriptions", "organizations_url": "https://api.github.com/users/mpolacek/orgs", "repos_url": "https://api.github.com/users/mpolacek/repos", "events_url": "https://api.github.com/users/mpolacek/events{/privacy}", "received_events_url": "https://api.github.com/users/mpolacek/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7029dfa38b663d20e0de40395fcd45a2845e2f71", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7029dfa38b663d20e0de40395fcd45a2845e2f71", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7029dfa38b663d20e0de40395fcd45a2845e2f71"}], "stats": {"total": 12, "additions": 12, "deletions": 0}, "files": [{"sha": "7fccccc6e14ea634f963549786882cc907c8c5b1", "filename": "gcc/cp/lambda.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/defceb206be0f803b8d94e746180e51adad20b87/gcc%2Fcp%2Flambda.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/defceb206be0f803b8d94e746180e51adad20b87/gcc%2Fcp%2Flambda.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Flambda.c?ref=defceb206be0f803b8d94e746180e51adad20b87", "patch": "@@ -1189,6 +1189,8 @@ maybe_add_lambda_conv_op (tree type)\n   tree name = make_conv_op_name (rettype);\n   tree thistype = cp_build_qualified_type (type, TYPE_QUAL_CONST);\n   tree fntype = build_method_type_directly (thistype, rettype, void_list_node);\n+  /* DR 1722: The conversion function should be noexcept.  */\n+  fntype = build_exception_variant (fntype, noexcept_true_spec);\n   tree convfn = build_lang_decl (FUNCTION_DECL, name, fntype);\n   SET_DECL_LANGUAGE (convfn, lang_cplusplus);\n   tree fn = convfn;"}, {"sha": "869e0d51d2b5c27e1468c558ee76a3050d6d4e1c", "filename": "gcc/testsuite/g++.dg/cpp0x/lambda/lambda-conv14.C", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/defceb206be0f803b8d94e746180e51adad20b87/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Flambda%2Flambda-conv14.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/defceb206be0f803b8d94e746180e51adad20b87/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Flambda%2Flambda-conv14.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Flambda%2Flambda-conv14.C?ref=defceb206be0f803b8d94e746180e51adad20b87", "patch": "@@ -0,0 +1,10 @@\n+// PR c++/90583\n+// DR 1722: Lambda to function pointer conversion should be noexcept.\n+// { dg-do compile { target c++11 } }\n+\n+void\n+foo ()\n+{\n+  auto l = [](int){ return 42; };\n+  static_assert(noexcept((int (*)(int))(l)), \"\");\n+}"}]}