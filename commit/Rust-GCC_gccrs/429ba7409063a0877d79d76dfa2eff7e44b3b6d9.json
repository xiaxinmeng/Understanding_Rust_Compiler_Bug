{"sha": "429ba7409063a0877d79d76dfa2eff7e44b3b6d9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDI5YmE3NDA5MDYzYTA4NzdkNzlkNzZkZmEyZWZmN2U0NGIzYjZkOQ==", "commit": {"author": {"name": "Sebastian Pop", "email": "sebastian.pop@amd.com", "date": "2010-02-06T17:40:45Z"}, "committer": {"name": "Sebastian Pop", "email": "spop@gcc.gnu.org", "date": "2010-02-06T17:40:45Z"}, "message": "Cleanup build relation.\n\n2010-01-20  Sebastian Pop  <sebastian.pop@amd.com>\n\n\t* graphite-dependences.c (build_pairwise_constraint): Renamed\n\tppl_build_relation.  Moved...\n\t(dr_equality_constraints): Use ppl_build_relation.\n\t(build_pairwise_scheduling_equality): Same.\n\t(build_pairwise_scheduling_inequality): Same.\n\t* graphite-ppl.c (ppl_build_relation): ...here.\n\t* graphite-ppl.h (ppl_build_relation): Declared.\n\nFrom-SVN: r156541", "tree": {"sha": "3425083970cfd744fa61a946981fcaa6ccfbc37c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3425083970cfd744fa61a946981fcaa6ccfbc37c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/429ba7409063a0877d79d76dfa2eff7e44b3b6d9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/429ba7409063a0877d79d76dfa2eff7e44b3b6d9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/429ba7409063a0877d79d76dfa2eff7e44b3b6d9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/429ba7409063a0877d79d76dfa2eff7e44b3b6d9/comments", "author": null, "committer": {"login": "sebpop", "id": 568397, "node_id": "MDQ6VXNlcjU2ODM5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/568397?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sebpop", "html_url": "https://github.com/sebpop", "followers_url": "https://api.github.com/users/sebpop/followers", "following_url": "https://api.github.com/users/sebpop/following{/other_user}", "gists_url": "https://api.github.com/users/sebpop/gists{/gist_id}", "starred_url": "https://api.github.com/users/sebpop/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sebpop/subscriptions", "organizations_url": "https://api.github.com/users/sebpop/orgs", "repos_url": "https://api.github.com/users/sebpop/repos", "events_url": "https://api.github.com/users/sebpop/events{/privacy}", "received_events_url": "https://api.github.com/users/sebpop/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "26bda00088e819ebd7d90b562d21c33ffd6a97a5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/26bda00088e819ebd7d90b562d21c33ffd6a97a5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/26bda00088e819ebd7d90b562d21c33ffd6a97a5"}], "stats": {"total": 144, "additions": 66, "deletions": 78}, "files": [{"sha": "fbfe742db023459bdf6393f0cc8d719438c4413f", "filename": "gcc/ChangeLog.graphite", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/429ba7409063a0877d79d76dfa2eff7e44b3b6d9/gcc%2FChangeLog.graphite", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/429ba7409063a0877d79d76dfa2eff7e44b3b6d9/gcc%2FChangeLog.graphite", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog.graphite?ref=429ba7409063a0877d79d76dfa2eff7e44b3b6d9", "patch": "@@ -1,3 +1,13 @@\n+2010-01-20  Sebastian Pop  <sebastian.pop@amd.com>\n+\n+\t* graphite-dependences.c (build_pairwise_constraint): Renamed\n+\tppl_build_relation.  Moved...\n+\t(dr_equality_constraints): Use ppl_build_relation.\n+\t(build_pairwise_scheduling_equality): Same.\n+\t(build_pairwise_scheduling_inequality): Same.\n+\t* graphite-ppl.c (ppl_build_relation): ...here.\n+\t* graphite-ppl.h (ppl_build_relation): Declared.\n+\n 2010-01-14  Sebastian Pop  <sebastian.pop@amd.com>\n \n \tPR middle-end/42681"}, {"sha": "d2c67f36a2f9c29854df62f52e9b32761db6d93d", "filename": "gcc/graphite-dependences.c", "status": "modified", "additions": 14, "deletions": 78, "changes": 92, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/429ba7409063a0877d79d76dfa2eff7e44b3b6d9/gcc%2Fgraphite-dependences.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/429ba7409063a0877d79d76dfa2eff7e44b3b6d9/gcc%2Fgraphite-dependences.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgraphite-dependences.c?ref=429ba7409063a0877d79d76dfa2eff7e44b3b6d9", "patch": "@@ -190,93 +190,29 @@ map_dr_into_dep_poly (graphite_dim_t dim,\n   return res;\n }\n \n-/* Builds a constraints of the form \"POS1 - POS2 CSTR_TYPE C\" */\n-\n-static ppl_Constraint_t\n-build_pairwise_constraint (graphite_dim_t dim,\n-\t\t           graphite_dim_t pos1, graphite_dim_t pos2,\n-\t\t\t   int c, enum ppl_enum_Constraint_Type cstr_type)\n-{\n-  ppl_Linear_Expression_t expr;\n-  ppl_Constraint_t cstr;\n-  ppl_Coefficient_t coef;\n-  Value v, v_op, v_c;\n-\n-  value_init (v);\n-  value_init (v_op);\n-  value_init (v_c);\n-\n-  value_set_si (v, 1);\n-  value_set_si (v_op, -1);\n-  value_set_si (v_c, c);\n-\n-  ppl_new_Coefficient (&coef);\n-  ppl_new_Linear_Expression_with_dimension (&expr, dim);\n-\n-  ppl_assign_Coefficient_from_mpz_t (coef, v);\n-  ppl_Linear_Expression_add_to_coefficient (expr, pos1, coef);\n-  ppl_assign_Coefficient_from_mpz_t (coef, v_op);\n-  ppl_Linear_Expression_add_to_coefficient (expr, pos2, coef);\n-  ppl_assign_Coefficient_from_mpz_t (coef, v_c);\n-  ppl_Linear_Expression_add_to_inhomogeneous (expr, coef);\n-\n-  ppl_new_Constraint (&cstr, expr, cstr_type);\n-\n-  ppl_delete_Linear_Expression (expr);\n-  ppl_delete_Coefficient (coef);\n-  value_clear (v);\n-  value_clear (v_op);\n-  value_clear (v_c);\n-\n-  return cstr;\n-}\n-\n /* Builds subscript equality constraints.  */\n \n static ppl_Pointset_Powerset_C_Polyhedron_t\n dr_equality_constraints (graphite_dim_t dim,\n \t\t         graphite_dim_t pos, graphite_dim_t nb_subscripts)\n {\n-  ppl_Polyhedron_t subscript_equalities;\n+  ppl_Polyhedron_t eqs;\n   ppl_Pointset_Powerset_C_Polyhedron_t res;\n-  Value v, v_op;\n   graphite_dim_t i;\n \n-  value_init (v);\n-  value_init (v_op);\n-  value_set_si (v, 1);\n-  value_set_si (v_op, -1);\n+  ppl_new_C_Polyhedron_from_space_dimension (&eqs, dim, 0);\n \n-  ppl_new_C_Polyhedron_from_space_dimension (&subscript_equalities, dim, 0);\n   for (i = 0; i < nb_subscripts; i++)\n     {\n-      ppl_Linear_Expression_t expr;\n-      ppl_Constraint_t cstr;\n-      ppl_Coefficient_t coef;\n-\n-      ppl_new_Coefficient (&coef);\n-      ppl_new_Linear_Expression_with_dimension (&expr, dim);\n-\n-      ppl_assign_Coefficient_from_mpz_t (coef, v);\n-      ppl_Linear_Expression_add_to_coefficient (expr, pos + i, coef);\n-      ppl_assign_Coefficient_from_mpz_t (coef, v_op);\n-      ppl_Linear_Expression_add_to_coefficient (expr, pos + i + nb_subscripts,\n-\t\t\t\t\t\tcoef);\n-\n-      ppl_new_Constraint (&cstr, expr, PPL_CONSTRAINT_TYPE_EQUAL);\n-      ppl_Polyhedron_add_constraint (subscript_equalities, cstr);\n-\n-      ppl_delete_Linear_Expression (expr);\n+      ppl_Constraint_t cstr\n+\t= ppl_build_relation (dim, pos + i, pos + i + nb_subscripts,\n+\t\t\t      0, PPL_CONSTRAINT_TYPE_EQUAL);\n+      ppl_Polyhedron_add_constraint (eqs, cstr);\n       ppl_delete_Constraint (cstr);\n-      ppl_delete_Coefficient (coef);\n     }\n \n-  ppl_new_Pointset_Powerset_C_Polyhedron_from_C_Polyhedron\n-    (&res, subscript_equalities);\n-  value_clear (v);\n-  value_clear (v_op);\n-  ppl_delete_Polyhedron (subscript_equalities);\n-\n+  ppl_new_Pointset_Powerset_C_Polyhedron_from_C_Polyhedron (&res, eqs);\n+  ppl_delete_Polyhedron (eqs);\n   return res;\n }\n \n@@ -292,8 +228,8 @@ build_pairwise_scheduling_equality (graphite_dim_t dim,\n \n   ppl_new_C_Polyhedron_from_space_dimension (&equalities, dim, 0);\n \n-  cstr = build_pairwise_constraint (dim, pos, pos + offset, 0,\n-\t\t\t\t    PPL_CONSTRAINT_TYPE_EQUAL);\n+  cstr = ppl_build_relation (dim, pos, pos + offset, 0,\n+\t\t\t     PPL_CONSTRAINT_TYPE_EQUAL);\n   ppl_Polyhedron_add_constraint (equalities, cstr);\n   ppl_delete_Constraint (cstr);\n \n@@ -317,11 +253,11 @@ build_pairwise_scheduling_inequality (graphite_dim_t dim,\n   ppl_new_C_Polyhedron_from_space_dimension (&equalities, dim, 0);\n \n   if (direction)\n-    cstr = build_pairwise_constraint (dim, pos, pos + offset, -1,\n-\t\t\t\t      PPL_CONSTRAINT_TYPE_GREATER_OR_EQUAL);\n+    cstr = ppl_build_relation (dim, pos, pos + offset, -1,\n+\t\t\t       PPL_CONSTRAINT_TYPE_GREATER_OR_EQUAL);\n   else\n-    cstr = build_pairwise_constraint (dim, pos, pos + offset, 1,\n-\t\t\t\t      PPL_CONSTRAINT_TYPE_LESS_OR_EQUAL);\n+    cstr = ppl_build_relation (dim, pos, pos + offset, 1,\n+\t\t\t       PPL_CONSTRAINT_TYPE_LESS_OR_EQUAL);\n \n   ppl_Polyhedron_add_constraint (equalities, cstr);\n   ppl_delete_Constraint (cstr);"}, {"sha": "38faebd6bebcd2336edc18647324c87f2093f54c", "filename": "gcc/graphite-ppl.c", "status": "modified", "additions": 40, "deletions": 0, "changes": 40, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/429ba7409063a0877d79d76dfa2eff7e44b3b6d9/gcc%2Fgraphite-ppl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/429ba7409063a0877d79d76dfa2eff7e44b3b6d9/gcc%2Fgraphite-ppl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgraphite-ppl.c?ref=429ba7409063a0877d79d76dfa2eff7e44b3b6d9", "patch": "@@ -700,5 +700,45 @@ ppl_min_for_le_polyhedron (ppl_Polyhedron_t pol,\n   ppl_delete_Coefficient (denom);\n }\n \n+/* Builds a constraint in dimension DIM relating dimensions POS1 to\n+   POS2 as \"POS1 - POS2 CSTR_TYPE C\" */\n+\n+ppl_Constraint_t\n+ppl_build_relation (int dim, int pos1, int pos2, int c,\n+\t\t    enum ppl_enum_Constraint_Type cstr_type)\n+{\n+  ppl_Linear_Expression_t expr;\n+  ppl_Constraint_t cstr;\n+  ppl_Coefficient_t coef;\n+  Value v, v_op, v_c;\n+\n+  value_init (v);\n+  value_init (v_op);\n+  value_init (v_c);\n+\n+  value_set_si (v, 1);\n+  value_set_si (v_op, -1);\n+  value_set_si (v_c, c);\n+\n+  ppl_new_Coefficient (&coef);\n+  ppl_new_Linear_Expression_with_dimension (&expr, dim);\n+\n+  ppl_assign_Coefficient_from_mpz_t (coef, v);\n+  ppl_Linear_Expression_add_to_coefficient (expr, pos1, coef);\n+  ppl_assign_Coefficient_from_mpz_t (coef, v_op);\n+  ppl_Linear_Expression_add_to_coefficient (expr, pos2, coef);\n+  ppl_assign_Coefficient_from_mpz_t (coef, v_c);\n+  ppl_Linear_Expression_add_to_inhomogeneous (expr, coef);\n+\n+  ppl_new_Constraint (&cstr, expr, cstr_type);\n+\n+  ppl_delete_Linear_Expression (expr);\n+  ppl_delete_Coefficient (coef);\n+  value_clear (v);\n+  value_clear (v_op);\n+  value_clear (v_c);\n+\n+  return cstr;\n+}\n \n #endif"}, {"sha": "488ad6f80222163b8192e1f764c66ef75604ceea", "filename": "gcc/graphite-ppl.h", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/429ba7409063a0877d79d76dfa2eff7e44b3b6d9/gcc%2Fgraphite-ppl.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/429ba7409063a0877d79d76dfa2eff7e44b3b6d9/gcc%2Fgraphite-ppl.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgraphite-ppl.h?ref=429ba7409063a0877d79d76dfa2eff7e44b3b6d9", "patch": "@@ -50,6 +50,8 @@ void ppl_max_for_le_pointset (ppl_Pointset_Powerset_C_Polyhedron_t,\n                               ppl_Linear_Expression_t, Value);\n void ppl_min_for_le_polyhedron (ppl_Polyhedron_t, ppl_Linear_Expression_t,\n \t\t\t\tValue);\n+ppl_Constraint_t ppl_build_relation (int, int, int, int,\n+\t\t\t\t     enum ppl_enum_Constraint_Type);\n \n /* Assigns to RES the value of the INTEGER_CST T.  */\n "}]}