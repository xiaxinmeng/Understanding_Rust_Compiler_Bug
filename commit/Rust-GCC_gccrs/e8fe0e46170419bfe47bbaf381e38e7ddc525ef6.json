{"sha": "e8fe0e46170419bfe47bbaf381e38e7ddc525ef6", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZThmZTBlNDYxNzA0MTliZmU0N2JiYWYzODFlMzhlN2RkYzUyNWVmNg==", "commit": {"author": {"name": "Kaz Kojima", "email": "kkojima@gcc.gnu.org", "date": "2016-11-19T13:59:47Z"}, "committer": {"name": "Kaz Kojima", "email": "kkojima@gcc.gnu.org", "date": "2016-11-19T13:59:47Z"}, "message": "re PR target/78426 (wrong code with strncmp on SH)\n\n\tPR target/78426\n\t* config/sh/sh-mem.cc (sh_expand_cmpnstr): Use copy_to_mode_reg\n\tinstead of force_reg.\n\t(sh_expand_setmem): Likewise.\n\nFrom-SVN: r242622", "tree": {"sha": "104c3168dfae8aed6ed2e6f9059e1610d3949759", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/104c3168dfae8aed6ed2e6f9059e1610d3949759"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e8fe0e46170419bfe47bbaf381e38e7ddc525ef6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e8fe0e46170419bfe47bbaf381e38e7ddc525ef6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e8fe0e46170419bfe47bbaf381e38e7ddc525ef6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e8fe0e46170419bfe47bbaf381e38e7ddc525ef6/comments", "author": null, "committer": null, "parents": [{"sha": "0333b8d06de3c9ac38360e351f89c87ccac23fcc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0333b8d06de3c9ac38360e351f89c87ccac23fcc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0333b8d06de3c9ac38360e351f89c87ccac23fcc"}], "stats": {"total": 13, "additions": 10, "deletions": 3}, "files": [{"sha": "fd09a79049435ea9545367884bb9fd36335aa8b1", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e8fe0e46170419bfe47bbaf381e38e7ddc525ef6/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e8fe0e46170419bfe47bbaf381e38e7ddc525ef6/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=e8fe0e46170419bfe47bbaf381e38e7ddc525ef6", "patch": "@@ -1,3 +1,10 @@\n+2016-11-19  Kaz Kojima  <kkojima@gcc.gnu.org>\n+\n+\tPR target/78426\n+\t* config/sh/sh-mem.cc (sh_expand_cmpnstr): Use copy_to_mode_reg\n+\tinstead of force_reg.\n+\t(sh_expand_setmem): Likewise.\n+\n 2016-11-19  Krister Walfridsson  <krister.walfridsson@gmail.com>\n \n \t* config.gcc (*-*-netbsd): Set use_gcc_stdint=wrap."}, {"sha": "f91afa5064f70bd114dc4cc383be35acb124ddc7", "filename": "gcc/config/sh/sh-mem.cc", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e8fe0e46170419bfe47bbaf381e38e7ddc525ef6/gcc%2Fconfig%2Fsh%2Fsh-mem.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e8fe0e46170419bfe47bbaf381e38e7ddc525ef6/gcc%2Fconfig%2Fsh%2Fsh-mem.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fsh%2Fsh-mem.cc?ref=e8fe0e46170419bfe47bbaf381e38e7ddc525ef6", "patch": "@@ -347,7 +347,7 @@ sh_expand_cmpnstr (rtx *operands)\n   rtx_code_label *L_loop_byte = gen_label_rtx ();\n   rtx_code_label *L_end_loop_byte = gen_label_rtx ();\n \n-  rtx len = force_reg (SImode, operands[3]);\n+  rtx len = copy_to_mode_reg (SImode, operands[3]);\n   int constp = CONST_INT_P (operands[3]);\n \n   const unsigned int addr1_alignment = MEM_ALIGN (operands[1]) / BITS_PER_UNIT;\n@@ -672,9 +672,9 @@ sh_expand_setmem (rtx *operands)\n   rtx_insn *jump;\n   rtx dest = copy_rtx (operands[0]);\n   rtx dest_addr = copy_addr_to_reg (XEXP (dest, 0));\n-  rtx val = force_reg (SImode, operands[2]);\n+  rtx val = copy_to_mode_reg (SImode, operands[2]);\n   int align = INTVAL (operands[3]);\n-  rtx len = force_reg (SImode, operands[1]);\n+  rtx len = copy_to_mode_reg (SImode, operands[1]);\n \n   if (! CONST_INT_P (operands[1]))\n     return;"}]}