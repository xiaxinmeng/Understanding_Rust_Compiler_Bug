{"sha": "6d199d3c08ec25787b76154a5d324d63561bccde", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NmQxOTlkM2MwOGVjMjU3ODdiNzYxNTRhNWQzMjRkNjM1NjFiY2NkZQ==", "commit": {"author": {"name": "Paolo Carlini", "email": "paolo.carlini@oracle.com", "date": "2012-05-25T23:40:10Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2012-05-25T23:40:10Z"}, "message": "re PR c++/32054 (Storage classes on anonymous unions in classes)\n\n/cp\n2012-05-25  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/32054\n\t* parser.c (cp_parser_member_declaration): A storage class is not\n\tallowed in a declaration of an anonymous aggregate in a class scope.\n\n/testsuite\n2012-05-25  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/32054\n\t* g++.dg/other/anon-union3.C: New.\n\nFrom-SVN: r187902", "tree": {"sha": "a736b7bb0c69555be936b4eecea2f0e52228b0c8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a736b7bb0c69555be936b4eecea2f0e52228b0c8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6d199d3c08ec25787b76154a5d324d63561bccde", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6d199d3c08ec25787b76154a5d324d63561bccde", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6d199d3c08ec25787b76154a5d324d63561bccde", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6d199d3c08ec25787b76154a5d324d63561bccde/comments", "author": null, "committer": null, "parents": [{"sha": "d4dc840de43342b24006974f7899d127235adcba", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d4dc840de43342b24006974f7899d127235adcba", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d4dc840de43342b24006974f7899d127235adcba"}], "stats": {"total": 42, "additions": 42, "deletions": 0}, "files": [{"sha": "75c9e2563a5fc6605ae2ce50dde5470add717189", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6d199d3c08ec25787b76154a5d324d63561bccde/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6d199d3c08ec25787b76154a5d324d63561bccde/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=6d199d3c08ec25787b76154a5d324d63561bccde", "patch": "@@ -1,3 +1,9 @@\n+2012-05-25  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/32054\n+\t* parser.c (cp_parser_member_declaration): A storage class is not\n+\tallowed in a declaration of an anonymous aggregate in a class scope.\n+\n 2012-05-24  Uros Bizjak  <ubizjak@gmail.com>\n \n \tPR obj-c++/53441"}, {"sha": "9fd8c84d923a556b184b7cc6d595c44490d13338", "filename": "gcc/cp/parser.c", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6d199d3c08ec25787b76154a5d324d63561bccde/gcc%2Fcp%2Fparser.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6d199d3c08ec25787b76154a5d324d63561bccde/gcc%2Fcp%2Fparser.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fparser.c?ref=6d199d3c08ec25787b76154a5d324d63561bccde", "patch": "@@ -18910,6 +18910,12 @@ cp_parser_member_declaration (cp_parser* parser)\n \t     particular type), as opposed to a nested class.  */\n \t  else if (ANON_AGGR_TYPE_P (type))\n \t    {\n+\t      /* C++11 9.5/6.  */\n+\t      if (decl_specifiers.storage_class != sc_none)\n+\t\terror_at (decl_spec_token_start->location,\n+\t\t\t  \"a storage class on an anonymous aggregate \"\n+\t\t\t  \"in class scope is not allowed\");\n+\n \t      /* Remove constructors and such from TYPE, now that we\n \t\t know it is an anonymous aggregate.  */\n \t      fixup_anonymous_aggr (type);"}, {"sha": "b873c67b4dc219b76253905259bd90036f32fc84", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6d199d3c08ec25787b76154a5d324d63561bccde/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6d199d3c08ec25787b76154a5d324d63561bccde/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=6d199d3c08ec25787b76154a5d324d63561bccde", "patch": "@@ -1,3 +1,8 @@\n+2012-05-25  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/32054\n+\t* g++.dg/other/anon-union3.C: New.\n+\n 2012-05-25  Ian Lance Taylor  <iant@google.com>\n \n \t* gcc.dg/split-6.c: New test."}, {"sha": "e65ee948a3b8ac00500c9531a091c9e3c2d20cfe", "filename": "gcc/testsuite/g++.dg/other/anon-union3.C", "status": "added", "additions": 25, "deletions": 0, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6d199d3c08ec25787b76154a5d324d63561bccde/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fanon-union3.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6d199d3c08ec25787b76154a5d324d63561bccde/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fanon-union3.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fanon-union3.C?ref=6d199d3c08ec25787b76154a5d324d63561bccde", "patch": "@@ -0,0 +1,25 @@\n+// PR c++/32054\n+\n+class C\n+{\n+  auto union      // { dg-error \"storage class\" \"\" { target c++98 } }\n+    {\n+      int a;\n+    };            // { dg-error \"multiple|specified\" \"\" { target c++11 } }\n+  register union  // { dg-error \"storage class\" }\n+    {\n+      int b;\n+    };\n+  static union    // { dg-error \"storage class\" }\n+    {\n+      int c;\n+    };\n+  extern union    // { dg-error \"storage class\" }\n+    {\n+      int d;\n+    };\n+  mutable union   // { dg-error \"storage class\" }\n+    {\n+      int e;\n+    };\n+};"}]}