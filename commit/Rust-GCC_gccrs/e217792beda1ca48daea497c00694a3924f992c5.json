{"sha": "e217792beda1ca48daea497c00694a3924f992c5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTIxNzc5MmJlZGExY2E0OGRhZWE0OTdjMDA2OTRhMzkyNGY5OTJjNQ==", "commit": {"author": {"name": "Nikolai Merinov", "email": "n.merinov@inango-systems.com", "date": "2018-11-07T21:02:27Z"}, "committer": {"name": "Jeff Law", "email": "law@gcc.gnu.org", "date": "2018-11-07T21:02:27Z"}, "message": "common.opt: Add -Wattribute-warning.\n\n         * common.opt: Add -Wattribute-warning.\n         * doc/invoke.texi: Add documentation for -Wno-attribute-warning.\n         * expr.c (expand_expr_real_1): Add new attribute to warning_at\n         call to allow user configure behavior of \"warning\" attribute.\n\n         * gcc.dg/Wno-attribute-warning.c: New test.\n\nFrom-SVN: r265891", "tree": {"sha": "a9b3a57a076c540e02affb6a305a3f52f651f185", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a9b3a57a076c540e02affb6a305a3f52f651f185"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e217792beda1ca48daea497c00694a3924f992c5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e217792beda1ca48daea497c00694a3924f992c5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e217792beda1ca48daea497c00694a3924f992c5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e217792beda1ca48daea497c00694a3924f992c5/comments", "author": {"login": "nmerinov", "id": 61517861, "node_id": "MDQ6VXNlcjYxNTE3ODYx", "avatar_url": "https://avatars.githubusercontent.com/u/61517861?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nmerinov", "html_url": "https://github.com/nmerinov", "followers_url": "https://api.github.com/users/nmerinov/followers", "following_url": "https://api.github.com/users/nmerinov/following{/other_user}", "gists_url": "https://api.github.com/users/nmerinov/gists{/gist_id}", "starred_url": "https://api.github.com/users/nmerinov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nmerinov/subscriptions", "organizations_url": "https://api.github.com/users/nmerinov/orgs", "repos_url": "https://api.github.com/users/nmerinov/repos", "events_url": "https://api.github.com/users/nmerinov/events{/privacy}", "received_events_url": "https://api.github.com/users/nmerinov/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "285556b5599bc180ad7a7ba1bb5f226b558ab32d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/285556b5599bc180ad7a7ba1bb5f226b558ab32d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/285556b5599bc180ad7a7ba1bb5f226b558ab32d"}], "stats": {"total": 36, "additions": 35, "deletions": 1}, "files": [{"sha": "966f0cba0da6c4a9a3af71275b9e8cb42a07a096", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e217792beda1ca48daea497c00694a3924f992c5/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e217792beda1ca48daea497c00694a3924f992c5/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=e217792beda1ca48daea497c00694a3924f992c5", "patch": "@@ -1,3 +1,10 @@\n+2018-11-17  Nikolai Merinov <n.merinov@inango-systems.com>\n+\n+         * common.opt: Add -Wattribute-warning.\n+         * doc/invoke.texi: Add documentation for -Wno-attribute-warning.\n+         * expr.c (expand_expr_real_1): Add new attribute to warning_at\n+         call to allow user configure behavior of \"warning\" attribute.\n+\n 2018-11-07  Segher Boessenkool  <segher@kernel.crashing.org>\n \n \t* target.def: Put @: after every vs., e.g., and i.e. where it is"}, {"sha": "5a5d33205a4602869602fd79a9bde0002ecd20ca", "filename": "gcc/common.opt", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e217792beda1ca48daea497c00694a3924f992c5/gcc%2Fcommon.opt", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e217792beda1ca48daea497c00694a3924f992c5/gcc%2Fcommon.opt", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcommon.opt?ref=e217792beda1ca48daea497c00694a3924f992c5", "patch": "@@ -571,6 +571,10 @@ Wcpp\n Common Var(warn_cpp) Init(1) Warning\n Warn when a #warning directive is encountered.\n \n+Wattribute-warning\n+Common Var(warn_attribute_warning) Init(1) Warning\n+Warn about uses of __attribute__((warning)) declarations.\n+\n Wdeprecated-declarations\n Common Var(warn_deprecated_decl) Init(1) Warning\n Warn about uses of __attribute__((deprecated)) declarations."}, {"sha": "cead538f9fff9539137cb4c12c67fca2b8f48bdb", "filename": "gcc/doc/invoke.texi", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e217792beda1ca48daea497c00694a3924f992c5/gcc%2Fdoc%2Finvoke.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e217792beda1ca48daea497c00694a3924f992c5/gcc%2Fdoc%2Finvoke.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdoc%2Finvoke.texi?ref=e217792beda1ca48daea497c00694a3924f992c5", "patch": "@@ -292,6 +292,7 @@ Objective-C and Objective-C++ Dialects}.\n -Wclobbered  -Wcomment  -Wconditionally-supported @gol\n -Wconversion  -Wcoverage-mismatch  -Wno-cpp  -Wdangling-else  -Wdate-time @gol\n -Wdelete-incomplete @gol\n+-Wno-attribute-warning @gol\n -Wno-deprecated  -Wno-deprecated-declarations  -Wno-designated-init @gol\n -Wdisabled-optimization @gol\n -Wno-discarded-qualifiers  -Wno-discarded-array-qualifiers @gol\n@@ -6978,6 +6979,15 @@ confused with the digit 0, and so is not the default, but may be\n useful as a local coding convention if the programming environment \n cannot be fixed to display these characters distinctly.\n \n+@item -Wno-attribute-warning\n+@opindex Wno-attribute-warning\n+@opindex Wattribute-warning\n+Do not warn about usage of functions (@pxref{Function Attributes})\n+declared with @code{warning} attribute.  By default, this warning is\n+enabled.  @option{-Wno-attribute-warning} can be used to disable the\n+warning or @option{-Wno-error=attribute-warning} can be used to\n+disable the error when compiled with @option{-Werror} flag.\n+\n @item -Wno-deprecated\n @opindex Wno-deprecated\n @opindex Wdeprecated"}, {"sha": "6341c5a0bdb6539f93006ca4197cec12f80c65a5", "filename": "gcc/expr.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e217792beda1ca48daea497c00694a3924f992c5/gcc%2Fexpr.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e217792beda1ca48daea497c00694a3924f992c5/gcc%2Fexpr.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fexpr.c?ref=e217792beda1ca48daea497c00694a3924f992c5", "patch": "@@ -10930,7 +10930,8 @@ expand_expr_real_1 (tree exp, rtx target, machine_mode tmode,\n \t\t\t\t\t DECL_ATTRIBUTES (fndecl))) != NULL)\n \t  {\n \t    const char *ident = lang_hooks.decl_printable_name (fndecl, 1);\n-\t    warning_at (tree_nonartificial_location (exp), 0,\n+\t    warning_at (tree_nonartificial_location (exp),\n+\t\t\tOPT_Wattribute_warning,\n \t\t\t\"%Kcall to %qs declared with attribute warning: %s\",\n \t\t\texp, identifier_to_locale (ident),\n \t\t\tTREE_STRING_POINTER (TREE_VALUE (TREE_VALUE (attr))));"}, {"sha": "689d7a7f11b91712ccf4aa0b3c5afb02934a9693", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e217792beda1ca48daea497c00694a3924f992c5/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e217792beda1ca48daea497c00694a3924f992c5/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=e217792beda1ca48daea497c00694a3924f992c5", "patch": "@@ -1,3 +1,7 @@\n+2018-11-17  Nikolai Merinov <n.merinov@inango-systems.com>\n+\n+         * gcc.dg/Wno-attribute-warning.c: New test.\n+\n 2018-11-07  Nathan Sidwell  <nathan@acm.org>\n \n \tPR c++/87904"}, {"sha": "2475304757488141ebf78567b0886262e3432aff", "filename": "gcc/testsuite/gcc.dg/Wno-attribute-warning.c", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e217792beda1ca48daea497c00694a3924f992c5/gcc%2Ftestsuite%2Fgcc.dg%2FWno-attribute-warning.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e217792beda1ca48daea497c00694a3924f992c5/gcc%2Ftestsuite%2Fgcc.dg%2FWno-attribute-warning.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2FWno-attribute-warning.c?ref=e217792beda1ca48daea497c00694a3924f992c5", "patch": "@@ -0,0 +1,8 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-Werror -Wno-error=attribute-warning\" } */\n+\n+int f1(void) __attribute__ ((warning(\"Please avoid f1\")));\n+int func1(void)\n+{\n+  return f1(); /* { dg-warning \"'f1' declared with attribute warning: Please avoid f1\" } */\n+}"}]}