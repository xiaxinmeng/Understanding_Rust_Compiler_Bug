{"sha": "8b87bb9624085b39ceb1596aeeebdf6f297bea04", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OGI4N2JiOTYyNDA4NWIzOWNlYjE1OTZhZWVlYmRmNmYyOTdiZWEwNA==", "commit": {"author": {"name": "Nathanael Nerode", "email": "neroden@gcc.gnu.org", "date": "2003-05-18T15:43:44Z"}, "committer": {"name": "Nathanael Nerode", "email": "neroden@gcc.gnu.org", "date": "2003-05-18T15:43:44Z"}, "message": "<top level>\n\n<top level>\n\t* configure.in: Switch more things to use maybe dependencies.\n\tRearrange a little.  Use GCC_TOPLEV_SUBDIRS.\n\t* configure: Regenerate.\n\t* Makefile.tpl: Switch more things to use maybe dependencies.\n\t* Makefile.in: Regenerate.\n\n<config>\n\t* config/acx.m4: Introduce _GCC_TOPLEV_NONCANONICAL_BUILD,\n\t_GCC_TOPLEV_NONCANOICAL_HOST, _GCC_TOPLEV_NONCANONICAL_TARGET,\n\tGCC_TOPLEV_SUBDIRS.\n\nFrom-SVN: r66932", "tree": {"sha": "db8e7befe958950af2cbd76c5c101b956a8399d0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/db8e7befe958950af2cbd76c5c101b956a8399d0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8b87bb9624085b39ceb1596aeeebdf6f297bea04", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8b87bb9624085b39ceb1596aeeebdf6f297bea04", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8b87bb9624085b39ceb1596aeeebdf6f297bea04", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8b87bb9624085b39ceb1596aeeebdf6f297bea04/comments", "author": null, "committer": null, "parents": [{"sha": "31ac6c9d4f9db4722754083e2e00fd256ed90b28", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/31ac6c9d4f9db4722754083e2e00fd256ed90b28", "html_url": "https://github.com/Rust-GCC/gccrs/commit/31ac6c9d4f9db4722754083e2e00fd256ed90b28"}], "stats": {"total": 728, "additions": 547, "deletions": 181}, "files": [{"sha": "64750abea87b680f61922b3fa5664f4251b4d3a4", "filename": "ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8b87bb9624085b39ceb1596aeeebdf6f297bea04/ChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8b87bb9624085b39ceb1596aeeebdf6f297bea04/ChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/ChangeLog?ref=8b87bb9624085b39ceb1596aeeebdf6f297bea04", "patch": "@@ -1,3 +1,11 @@\n+2003-05-18  Nathanael Nerode  <neroden@gcc.gnu.org>\n+\n+\t* configure.in: Switch more things to use maybe dependencies.\n+\tRearrange a little.  Use GCC_TOPLEV_SUBDIRS.\n+\t* configure: Regenerate.\n+\t* Makefile.tpl: Switch more things to use maybe dependencies.\n+\t* Makefile.in: Regenerate.\n+\n 2003-05-16  Andreas Schwab  <schwab@suse.de>\n \n \t* Makefile.tpl (install-opcodes): Define."}, {"sha": "d90b1aeac14ecb948d39d6e50abe0c2f86640ca1", "filename": "Makefile.in", "status": "modified", "additions": 257, "deletions": 13, "changes": 270, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8b87bb9624085b39ceb1596aeeebdf6f297bea04/Makefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8b87bb9624085b39ceb1596aeeebdf6f297bea04/Makefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/Makefile.in?ref=8b87bb9624085b39ceb1596aeeebdf6f297bea04", "patch": "@@ -551,8 +551,90 @@ EXTRA_GCC_FLAGS = \\\n \n GCC_FLAGS_TO_PASS = $(BASE_FLAGS_TO_PASS) $(EXTRA_GCC_FLAGS)\n \n-configure-host: @configure_host_modules@\n-configure-target: @configure_target_modules@\n+.PHONY: configure-host\n+configure-host: maybe-configure-gcc  \\\n+    maybe-configure-ash \\\n+    maybe-configure-autoconf \\\n+    maybe-configure-automake \\\n+    maybe-configure-bash \\\n+    maybe-configure-bfd \\\n+    maybe-configure-opcodes \\\n+    maybe-configure-binutils \\\n+    maybe-configure-bison \\\n+    maybe-configure-byacc \\\n+    maybe-configure-bzip2 \\\n+    maybe-configure-dejagnu \\\n+    maybe-configure-diff \\\n+    maybe-configure-dosutils \\\n+    maybe-configure-etc \\\n+    maybe-configure-fastjar \\\n+    maybe-configure-fileutils \\\n+    maybe-configure-findutils \\\n+    maybe-configure-find \\\n+    maybe-configure-flex \\\n+    maybe-configure-gas \\\n+    maybe-configure-gawk \\\n+    maybe-configure-gettext \\\n+    maybe-configure-gnuserv \\\n+    maybe-configure-gprof \\\n+    maybe-configure-gzip \\\n+    maybe-configure-hello \\\n+    maybe-configure-indent \\\n+    maybe-configure-intl \\\n+    maybe-configure-tcl \\\n+    maybe-configure-itcl \\\n+    maybe-configure-ld \\\n+    maybe-configure-libgui \\\n+    maybe-configure-libiberty \\\n+    maybe-configure-libtool \\\n+    maybe-configure-m4 \\\n+    maybe-configure-make \\\n+    maybe-configure-mmalloc \\\n+    maybe-configure-patch \\\n+    maybe-configure-perl \\\n+    maybe-configure-prms \\\n+    maybe-configure-rcs \\\n+    maybe-configure-readline \\\n+    maybe-configure-release \\\n+    maybe-configure-recode \\\n+    maybe-configure-sed \\\n+    maybe-configure-send-pr \\\n+    maybe-configure-shellutils \\\n+    maybe-configure-sid \\\n+    maybe-configure-sim \\\n+    maybe-configure-tar \\\n+    maybe-configure-texinfo \\\n+    maybe-configure-textutils \\\n+    maybe-configure-time \\\n+    maybe-configure-uudecode \\\n+    maybe-configure-wdiff \\\n+    maybe-configure-zip \\\n+    maybe-configure-zlib \\\n+    maybe-configure-gdb \\\n+    maybe-configure-expect \\\n+    maybe-configure-guile \\\n+    maybe-configure-tk \\\n+    maybe-configure-tix \\\n+    maybe-configure-libtermcap \\\n+    maybe-configure-utils\n+.PHONY: configure-target\n+configure-target:  \\\n+    maybe-configure-target-libstdc++-v3 \\\n+    maybe-configure-target-newlib \\\n+    maybe-configure-target-libf2c \\\n+    maybe-configure-target-libobjc \\\n+    maybe-configure-target-libtermcap \\\n+    maybe-configure-target-winsup \\\n+    maybe-configure-target-libgloss \\\n+    maybe-configure-target-libiberty \\\n+    maybe-configure-target-gperf \\\n+    maybe-configure-target-examples \\\n+    maybe-configure-target-libffi \\\n+    maybe-configure-target-libjava \\\n+    maybe-configure-target-zlib \\\n+    maybe-configure-target-boehm-gc \\\n+    maybe-configure-target-qthreads \\\n+    maybe-configure-target-rda\n \n # This is a list of the targets for which we can do a clean-{target}.\n CLEAN_MODULES = \\\n@@ -642,14 +724,93 @@ CLEAN_X11_MODULES = \\\n \tclean-tix \n \n # The target built for a native build.\n-# This list only includes modules actually being configured and built.\n .PHONY: all.normal\n-all.normal: @all_build_modules@ \\\n-\t@all_host_modules@ \\\n-\t@all_target_modules@\n-\n-all-host: @all_host_modules@\n-all-target: @all_target_modules@\n+all.normal: @all_build_modules@ all-host all-target\n+\n+.PHONY: all-host\n+all-host: maybe-all-gcc  \\\n+    maybe-all-ash \\\n+    maybe-all-autoconf \\\n+    maybe-all-automake \\\n+    maybe-all-bash \\\n+    maybe-all-bfd \\\n+    maybe-all-opcodes \\\n+    maybe-all-binutils \\\n+    maybe-all-bison \\\n+    maybe-all-byacc \\\n+    maybe-all-bzip2 \\\n+    maybe-all-dejagnu \\\n+    maybe-all-diff \\\n+    maybe-all-dosutils \\\n+    maybe-all-etc \\\n+    maybe-all-fastjar \\\n+    maybe-all-fileutils \\\n+    maybe-all-findutils \\\n+    maybe-all-find \\\n+    maybe-all-flex \\\n+    maybe-all-gas \\\n+    maybe-all-gawk \\\n+    maybe-all-gettext \\\n+    maybe-all-gnuserv \\\n+    maybe-all-gprof \\\n+    maybe-all-gzip \\\n+    maybe-all-hello \\\n+    maybe-all-indent \\\n+    maybe-all-intl \\\n+    maybe-all-tcl \\\n+    maybe-all-itcl \\\n+    maybe-all-ld \\\n+    maybe-all-libgui \\\n+    maybe-all-libiberty \\\n+    maybe-all-libtool \\\n+    maybe-all-m4 \\\n+    maybe-all-make \\\n+    maybe-all-mmalloc \\\n+    maybe-all-patch \\\n+    maybe-all-perl \\\n+    maybe-all-prms \\\n+    maybe-all-rcs \\\n+    maybe-all-readline \\\n+    maybe-all-release \\\n+    maybe-all-recode \\\n+    maybe-all-sed \\\n+    maybe-all-send-pr \\\n+    maybe-all-shellutils \\\n+    maybe-all-sid \\\n+    maybe-all-sim \\\n+    maybe-all-tar \\\n+    maybe-all-texinfo \\\n+    maybe-all-textutils \\\n+    maybe-all-time \\\n+    maybe-all-uudecode \\\n+    maybe-all-wdiff \\\n+    maybe-all-zip \\\n+    maybe-all-zlib \\\n+    maybe-all-gdb \\\n+    maybe-all-expect \\\n+    maybe-all-guile \\\n+    maybe-all-tk \\\n+    maybe-all-tix \\\n+    maybe-all-libtermcap \\\n+    maybe-all-utils\n+.PHONY: all-target\n+all-target:  \\\n+    maybe-all-target-libstdc++-v3 \\\n+    maybe-all-target-newlib \\\n+    maybe-all-target-libf2c \\\n+    maybe-all-target-libobjc \\\n+    maybe-all-target-libtermcap \\\n+    maybe-all-target-winsup \\\n+    maybe-all-target-libgloss \\\n+    maybe-all-target-libiberty \\\n+    maybe-all-target-gperf \\\n+    maybe-all-target-examples \\\n+    maybe-all-target-libffi \\\n+    maybe-all-target-libjava \\\n+    maybe-all-target-zlib \\\n+    maybe-all-target-boehm-gc \\\n+    maybe-all-target-qthreads \\\n+    maybe-all-target-rda\n \n # Do a target for all the subdirectories.  A ``make do-X'' will do a\n # ``make X'' in all subdirectories (because, in general, there is a\n@@ -1197,9 +1358,92 @@ mail-report-with-warnings.log: warning.log\n # Installation targets.\n \n .PHONY: install uninstall\n-install: installdirs @install_host_modules@ @install_target_modules@\n-\n-install-target: @install_target_modules@\n+install: installdirs install-host install-target\n+\n+.PHONY: install-host\n+install-host: maybe-install-gcc  \\\n+    maybe-install-ash \\\n+    maybe-install-autoconf \\\n+    maybe-install-automake \\\n+    maybe-install-bash \\\n+    maybe-install-bfd \\\n+    maybe-install-opcodes \\\n+    maybe-install-binutils \\\n+    maybe-install-bison \\\n+    maybe-install-byacc \\\n+    maybe-install-bzip2 \\\n+    maybe-install-dejagnu \\\n+    maybe-install-diff \\\n+    maybe-install-dosutils \\\n+    maybe-install-etc \\\n+    maybe-install-fastjar \\\n+    maybe-install-fileutils \\\n+    maybe-install-findutils \\\n+    maybe-install-find \\\n+    maybe-install-flex \\\n+    maybe-install-gas \\\n+    maybe-install-gawk \\\n+    maybe-install-gettext \\\n+    maybe-install-gnuserv \\\n+    maybe-install-gprof \\\n+    maybe-install-gzip \\\n+    maybe-install-hello \\\n+    maybe-install-indent \\\n+    maybe-install-intl \\\n+    maybe-install-tcl \\\n+    maybe-install-itcl \\\n+    maybe-install-ld \\\n+    maybe-install-libgui \\\n+    maybe-install-libiberty \\\n+    maybe-install-libtool \\\n+    maybe-install-m4 \\\n+    maybe-install-make \\\n+    maybe-install-mmalloc \\\n+    maybe-install-patch \\\n+    maybe-install-perl \\\n+    maybe-install-prms \\\n+    maybe-install-rcs \\\n+    maybe-install-readline \\\n+    maybe-install-release \\\n+    maybe-install-recode \\\n+    maybe-install-sed \\\n+    maybe-install-send-pr \\\n+    maybe-install-shellutils \\\n+    maybe-install-sid \\\n+    maybe-install-sim \\\n+    maybe-install-tar \\\n+    maybe-install-texinfo \\\n+    maybe-install-textutils \\\n+    maybe-install-time \\\n+    maybe-install-uudecode \\\n+    maybe-install-wdiff \\\n+    maybe-install-zip \\\n+    maybe-install-zlib \\\n+    maybe-install-gdb \\\n+    maybe-install-expect \\\n+    maybe-install-guile \\\n+    maybe-install-tk \\\n+    maybe-install-tix \\\n+    maybe-install-libtermcap \\\n+    maybe-install-utils\n+.PHONY: install-target\n+install-target:  \\\n+    maybe-install-target-libstdc++-v3 \\\n+    maybe-install-target-newlib \\\n+    maybe-install-target-libf2c \\\n+    maybe-install-target-libobjc \\\n+    maybe-install-target-libtermcap \\\n+    maybe-install-target-winsup \\\n+    maybe-install-target-libgloss \\\n+    maybe-install-target-libiberty \\\n+    maybe-install-target-gperf \\\n+    maybe-install-target-examples \\\n+    maybe-install-target-libffi \\\n+    maybe-install-target-libjava \\\n+    maybe-install-target-zlib \\\n+    maybe-install-target-boehm-gc \\\n+    maybe-install-target-qthreads \\\n+    maybe-install-target-rda\n \n uninstall:\n \t@echo \"the uninstall target is not supported in this tree\"\n@@ -1219,7 +1463,7 @@ install.all: install-no-fixedincludes\n # the fixed header files.\n .PHONY: install-no-fixedincludes\n install-no-fixedincludes: installdirs @install_host_modules_nogcc@ \\\n-\t@install_target_modules@ gcc-no-fixedincludes\n+\tinstall-target gcc-no-fixedincludes\n \n ### other supporting targets\n "}, {"sha": "419bf42b58b682689b6828689428c47f2d5a5898", "filename": "Makefile.tpl", "status": "modified", "additions": 35, "deletions": 13, "changes": 48, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8b87bb9624085b39ceb1596aeeebdf6f297bea04/Makefile.tpl", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8b87bb9624085b39ceb1596aeeebdf6f297bea04/Makefile.tpl", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/Makefile.tpl?ref=8b87bb9624085b39ceb1596aeeebdf6f297bea04", "patch": "@@ -554,8 +554,16 @@ EXTRA_GCC_FLAGS = \\\n \n GCC_FLAGS_TO_PASS = $(BASE_FLAGS_TO_PASS) $(EXTRA_GCC_FLAGS)\n \n-configure-host: @configure_host_modules@\n-configure-target: @configure_target_modules@\n+.PHONY: configure-host\n+configure-host: maybe-configure-gcc [+\n+  FOR host_modules +] \\\n+    maybe-configure-[+module+][+\n+  ENDFOR host_modules +]\n+.PHONY: configure-target\n+configure-target: [+\n+  FOR target_modules +] \\\n+    maybe-configure-target-[+module+][+\n+  ENDFOR target_modules +]\n \n # This is a list of the targets for which we can do a clean-{target}.\n CLEAN_MODULES =[+\n@@ -578,14 +586,19 @@ CLEAN_X11_MODULES = [+ FOR host_modules +][+ IF with_x +]\\\n \tclean-[+module+] [+ ENDIF with_x +][+ ENDFOR host_modules +]\n \n # The target built for a native build.\n-# This list only includes modules actually being configured and built.\n .PHONY: all.normal\n-all.normal: @all_build_modules@ \\\n-\t@all_host_modules@ \\\n-\t@all_target_modules@\n-\n-all-host: @all_host_modules@\n-all-target: @all_target_modules@\n+all.normal: @all_build_modules@ all-host all-target\n+\n+.PHONY: all-host\n+all-host: maybe-all-gcc [+\n+  FOR host_modules +] \\\n+    maybe-all-[+module+][+\n+  ENDFOR host_modules +]\n+.PHONY: all-target\n+all-target: [+\n+  FOR target_modules +] \\\n+    maybe-all-target-[+module+][+\n+  ENDFOR target_modules +]\n \n # Do a target for all the subdirectories.  A ``make do-X'' will do a\n # ``make X'' in all subdirectories (because, in general, there is a\n@@ -757,9 +770,18 @@ mail-report-with-warnings.log: warning.log\n # Installation targets.\n \n .PHONY: install uninstall\n-install: installdirs @install_host_modules@ @install_target_modules@\n-\n-install-target: @install_target_modules@\n+install: installdirs install-host install-target\n+\n+.PHONY: install-host\n+install-host: maybe-install-gcc [+\n+  FOR host_modules +] \\\n+    maybe-install-[+module+][+\n+  ENDFOR host_modules +]\n+.PHONY: install-target\n+install-target: [+\n+  FOR target_modules +] \\\n+    maybe-install-target-[+module+][+\n+  ENDFOR target_modules +]\n \n uninstall:\n \t@echo \"the uninstall target is not supported in this tree\"\n@@ -779,7 +801,7 @@ install.all: install-no-fixedincludes\n # the fixed header files.\n .PHONY: install-no-fixedincludes\n install-no-fixedincludes: installdirs @install_host_modules_nogcc@ \\\n-\t@install_target_modules@ gcc-no-fixedincludes\n+\tinstall-target gcc-no-fixedincludes\n \n ### other supporting targets\n "}, {"sha": "c34635d7c10fdeca0d09682be1c8639c331f9619", "filename": "config/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8b87bb9624085b39ceb1596aeeebdf6f297bea04/config%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8b87bb9624085b39ceb1596aeeebdf6f297bea04/config%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/config%2FChangeLog?ref=8b87bb9624085b39ceb1596aeeebdf6f297bea04", "patch": "@@ -1,3 +1,9 @@\n+2003-05-18  Nathanael Nerode  <neroden@gcc.gnu.org>\n+\n+\t* config/acx.m4: Introduce _GCC_TOPLEV_NONCANONICAL_BUILD,\n+\t_GCC_TOPLEV_NONCANOICAL_HOST, _GCC_TOPLEV_NONCANONICAL_TARGET,\n+\tGCC_TOPLEV_SUBDIRS.\n+\n 2003-03-04  Nathanael Nerode  <neroden@gcc.gnu.org>\n \n \t* mh-dgux: Delete."}, {"sha": "ea5cb07dcabbbdeccc10f9c12ad872352d19dd01", "filename": "config/acx.m4", "status": "modified", "additions": 61, "deletions": 0, "changes": 61, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8b87bb9624085b39ceb1596aeeebdf6f297bea04/config%2Facx.m4", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8b87bb9624085b39ceb1596aeeebdf6f297bea04/config%2Facx.m4", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/config%2Facx.m4?ref=8b87bb9624085b39ceb1596aeeebdf6f297bea04", "patch": "@@ -1,6 +1,67 @@\n # Autoconf M4 include file defining utility macros for complex Canadian\n # cross builds.\n \n+dnl ####\n+dnl # _GCC_TOPLEV_NONCANONICAL_BUILD\n+dnl # $build_alias or canonical $build if blank.\n+dnl # Used when we would use $build_alias, but empty is not OK.\n+AC_DEFUN([_GCC_TOPLEV_NONCANONICAL_BUILD],\n+[AC_REQUIRE([AC_CANONICAL_BUILD]) []dnl\n+case ${build_alias} in\n+  \"\") build_noncanonical=${build} ;;\n+  *) build_noncanonical=${build_alias} ;;\n+esac\n+]) []dnl # _GCC_TOPLEV_NONCANONICAL_BUILD\n+\n+dnl ####\n+dnl # _GCC_TOPLEV_NONCANONICAL_HOST\n+dnl # $host_alias, or $build_noncanonical if blank.\n+dnl # Used when we would use $host_alias, but empty is not OK.\n+AC_DEFUN([_GCC_TOPLEV_NONCANONICAL_HOST],\n+[AC_REQUIRE([_GCC_TOPLEV_NONCANONICAL_BUILD]) []dnl\n+case ${host_alias} in\n+  \"\") host_noncanonical=${build_noncanonical} ;;\n+  *) host_noncanonical=${host_alias} ;;\n+esac\n+]) []dnl # _GCC_TOPLEV_NONCANONICAL_HOST\n+\n+dnl ####\n+dnl # _GCC_TOPLEV_NONCANONICAL_TARGET\n+dnl # $target_alias or $host_noncanonical if blank.\n+dnl # Used when we would use $target_alias, but empty is not OK.\n+AC_DEFUN([_GCC_TOPLEV_NONCANONICAL_TARGET],\n+[AC_REQUIRE([_GCC_TOPLEV_NONCANONICAL_HOST]) []dnl\n+case ${target_alias} in\n+  \"\") target_noncanonical=${host_noncanonical} ;;\n+  *) target_noncanonical=${target_alias} ;;\n+esac\n+]) []dnl # _GCC_TOPLEV_NONCANONICAL_TARGET\n+\n+dnl ####\n+dnl # GCC_TOPLEV_SUBDIRS\n+dnl # GCC & friends build 'build', 'host', and 'target' tools.  These must\n+dnl # be separated into three well-known subdirectories of the build directory:\n+dnl # build_subdir, host_subdir, and target_subdir.  The values are determined\n+dnl # here so that they can (theoretically) be changed in the future.  They\n+dnl # were previously reproduced across many different files.\n+dnl #\n+dnl # This logic really amounts to very little with autoconf 2.13; it will\n+dnl # amount to a lot more with autoconf 2.5x.\n+AC_DEFUN([GCC_TOPLEV_SUBDIRS],\n+[AC_REQUIRE([_GCC_TOPLEV_NONCANONICAL_TARGET]) []dnl\n+AC_REQUIRE([_GCC_TOPLEV_NONCANONICAL_BUILD]) []dnl\n+# Prefix 'build-' so this never conflicts with target_subdir.\n+build_subdir=\"build-${build_noncanonical}\"\n+# Not really a subdirectory, but here for completeness.\n+host_subdir=.\n+# No prefix.\n+target_subdir=${target_noncanonical}\n+AC_SUBST([build_subdir]) []dnl\n+AC_SUBST([host_subdir]) []dnl\n+AC_SUBST([target_subdir]) []dnl\n+]) []dnl # GCC_TOPLEV_SUBDIRS\n+\n+\n ####\n # _NCN_TOOL_PREFIXES:  Some stuff that oughtta be done in AC_CANONICAL_SYSTEM \n # or AC_INIT."}, {"sha": "ed7c7ac1787c7c37037008472ca13b0879cc487a", "filename": "configure", "status": "modified", "additions": 121, "deletions": 98, "changes": 219, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8b87bb9624085b39ceb1596aeeebdf6f297bea04/configure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8b87bb9624085b39ceb1596aeeebdf6f297bea04/configure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/configure?ref=8b87bb9624085b39ceb1596aeeebdf6f297bea04", "patch": "@@ -661,6 +661,11 @@ test \"$program_transform_name\" = \"\" && program_transform_name=\"s,x,x,\"\n # Autoconf M4 include file defining utility macros for complex Canadian\n # cross builds.\n \n+ \n+ \n+ \n+ \n+\n ####\n # _NCN_TOOL_PREFIXES:  Some stuff that oughtta be done in AC_CANONICAL_SYSTEM \n # or AC_INIT.\n@@ -824,6 +829,16 @@ target_tools=\"target-examples target-groff target-gperf target-rda\"\n configdirs=`echo ${host_libs} ${host_tools}`\n target_configdirs=`echo ${target_libs} ${target_tools}`\n \n+# Only make build modules if build != host.\n+# This should be done more generally, but at the moment it doesn't matter.\n+if test ${host_alias} != ${build_alias} ; then\n+  # This is the only build module.\n+  build_modules=libiberty\n+else\n+  build_modules=\n+fi\n+\n+\n ################################################################################\n \n srcname=\"gnu development package\"\n@@ -839,9 +854,29 @@ else\n   is_cross_compiler=yes\n fi\t\n \n-# We always want to use the same name for this directory, so that dejagnu\n-# can reliably find it.\n-target_subdir=${target_alias}\n+# Find the build and target subdirs.\n+ case ${build_alias} in\n+  \"\") build_noncanonical=${build} ;;\n+  *) build_noncanonical=${build_alias} ;;\n+esac\n+\n+ case ${host_alias} in\n+  \"\") host_noncanonical=${build_noncanonical} ;;\n+  *) host_noncanonical=${host_alias} ;;\n+esac\n+\n+ case ${target_alias} in\n+  \"\") target_noncanonical=${host_noncanonical} ;;\n+  *) target_noncanonical=${target_alias} ;;\n+esac\n+\n+  # Prefix 'build-' so this never conflicts with target_subdir.\n+build_subdir=\"build-${build_noncanonical}\"\n+# Not really a subdirectory, but here for completeness.\n+host_subdir=.\n+# No prefix.\n+target_subdir=${target_noncanonical}\n+   \n \n if test ! -d ${target_subdir} ; then\n   if mkdir ${target_subdir} ; then true\n@@ -851,9 +886,6 @@ if test ! -d ${target_subdir} ; then\n   fi\n fi\n \n-build_prefix=build-\n-build_subdir=${build_prefix}${build_alias}\n-\n if test x\"${build_alias}\" != x\"${host}\" ; then\n   if test ! -d ${build_subdir} ; then\n     if mkdir ${build_subdir} ; then true\n@@ -2264,59 +2296,27 @@ esac\n target_configdirs=`echo \"${target_configdirs}\" | sed -e 's/target-//g'`\n \n # This is the final value for target_configdirs.  configdirs already\n-# has its final value.  It's time to create some lists of valid targets.\n-\n-# While at that, we remove Makefiles if we were started for recursive\n-# configuration, such that the top-level Makefile reconfigures them,\n-# like we used to do when configure itself was recursive.\n+# has its final value, as does build_modules.  It's time to create some \n+# lists of valid targets.\n \n all_build_modules=\n configure_build_modules=\n-# Only make build modules if build != host.\n-# This should be done more generally, but at the moment it doesn't matter.\n-if test ${host_alias} != ${build_alias} ; then\n-  for module in libiberty ; do\n-    all_build_modules=all-build-${module}\n-    configure_build_modules=configure-build-${module}\n-    if test -z \"${no_recursion}\" \\\n-       && test -f ${build_subdir}/${module}/Makefile; then\n-      echo 1>&2 \"*** removing ${build_subdir}/${module}/Makefile to force reconfigure\"\n-      rm -f ${build_subdir}/${module}/Makefile\n-    fi\n-  done\n-fi\n+for module in ${build_modules} ; do\n+  all_build_modules=all-build-${module}\n+  configure_build_modules=configure-build-${module}\n+done\n \n-all_host_modules=\n check_host_modules=\n install_host_modules=\n-configure_host_modules=\n for module in ${configdirs} ; do\n-  all_host_modules=\"${all_host_modules} all-${module}\"\n   check_host_modules=\"${check_host_modules} check-${module}\"\n   install_host_modules=\"${install_host_modules} install-${module}\"\n-  configure_host_modules=\"${configure_host_modules} configure-${module}\"\n-  if test -z \"${no_recursion}\" \\\n-     && test -f ${module}/Makefile; then\n-    echo 1>&2 \"*** removing ${module}/Makefile to force reconfigure\"\n-    rm -f ${module}/Makefile\n-  fi\n done\n install_host_modules_nogcc=`echo \"${install_host_modules}\" | sed -e 's/install-gcc//g'`\n \n-all_target_modules=\n check_target_modules=\n-install_target_modules=\n-configure_target_modules=\n for module in ${target_configdirs} ; do\n-  all_target_modules=\"${all_target_modules} all-target-${module}\"\n   check_target_modules=\"${check_target_modules} check-target-${module}\"\n-  install_target_modules=\"${install_target_modules} install-target-${module}\"\n-  configure_target_modules=\"${configure_target_modules} configure-target-${module}\"\n-  if test -z \"${no_recursion}\" \\\n-     && test -f ${target_subdir}/${module}/Makefile; then\n-    echo 1>&2 \"*** removing ${target_subdir}/${module}/Makefile to force reconfigure\"\n-    rm -f ${target_subdir}/${module}/Makefile\n-  fi\n done\n \n # Determine whether gdb needs tk/tcl or not.\n@@ -2346,13 +2346,49 @@ case \"$enable_gdbtk\" in\n esac\n \n # Create the 'maybe dependencies'.  This uses a temporary file.\n+\n+# While at that, we remove Makefiles if we were started for recursive\n+# configuration, so that the top-level Makefile reconfigures them,\n+# like we used to do when configure itself was recursive.\n rm -f maybedep.tmp\n echo '# maybedep.tmp' > maybedep.tmp\n-for item in ${all_build_modules} ${all_host_modules} ${all_target_modules} \\\n-\t${install_host_modules} ${install_target_modules} \\\n-\t${configure_build_modules} ${configure_host_modules} ${configure_target_modules} \\\n-\t; do\n-  echo \"maybe-${item}: ${item}\" >> maybedep.tmp\n+\n+# Make-targets which may need maybe dependencies.\n+mts=\"configure all install\"\n+\n+# Loop over modules and make-targets.\n+for module in ${build_modules} ; do\n+  if test -z \"${no_recursion}\" \\\n+     && test -f ${build_subdir}/${module}/Makefile; then\n+    echo 1>&2 \"*** removing ${build_subdir}/${module}/Makefile to force reconfigure\"\n+    rm -f ${build_subdir}/${module}/Makefile\n+  fi\n+  for mt in ${mts} ; do\n+    case ${mt} in\n+      install) ;; # No installing build modules.\n+      *) echo \"maybe-${mt}-build-${module}: ${mt}-build-${module}\" >> maybedep.tmp ;;\n+    esac\n+  done\n+done\n+for module in ${configdirs} ; do\n+  if test -z \"${no_recursion}\" \\\n+     && test -f ${module}/Makefile; then\n+    echo 1>&2 \"*** removing ${module}/Makefile to force reconfigure\"\n+    rm -f ${module}/Makefile\n+  fi\n+  for mt in ${mts} ; do\n+    echo \"maybe-${mt}-${module}: ${mt}-${module}\" >> maybedep.tmp\n+  done\n+done\n+for module in ${target_configdirs} ; do\n+  if test -z \"${no_recursion}\" \\\n+     && test -f ${target_subdir}/${module}/Makefile; then\n+    echo 1>&2 \"*** removing ${target_subdir}/${module}/Makefile to force reconfigure\"\n+    rm -f ${target_subdir}/${module}/Makefile\n+  fi\n+  for mt in ${mts} ; do\n+    echo \"maybe-${mt}-target-${module}: ${mt}-target-${module}\" >> maybedep.tmp\n+  done\n done\n maybe_dependencies=maybedep.tmp\n \n@@ -2642,25 +2678,17 @@ ospace_frag=${srcdir}/${ospace_frag}\n \n \n \n-\n # Host module lists & subconfigure args.\n \n \n \n \n \n-\n-\n-\n # Target module lists & subconfigure args.\n \n \n \n \n-\n-\n-\n-\n # Build tools.\n \n \n@@ -2679,7 +2707,7 @@ test -n \"$target_alias\" && ncn_target_tool_prefix=$target_alias-\n   # Extract the first word of \"${ncn_tool_prefix}ar\", so it can be a program name with args.\n set dummy ${ncn_tool_prefix}ar; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:2683: checking for $ac_word\" >&5\n+echo \"configure:2711: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_AR'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -2712,7 +2740,7 @@ if test -z \"$ac_cv_prog_AR\" ; then\n     # Extract the first word of \"ar\", so it can be a program name with args.\n set dummy ar; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:2716: checking for $ac_word\" >&5\n+echo \"configure:2744: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_ncn_cv_AR'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -2751,7 +2779,7 @@ fi\n   # Extract the first word of \"${ncn_tool_prefix}as\", so it can be a program name with args.\n set dummy ${ncn_tool_prefix}as; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:2755: checking for $ac_word\" >&5\n+echo \"configure:2783: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_AS'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -2784,7 +2812,7 @@ if test -z \"$ac_cv_prog_AS\" ; then\n     # Extract the first word of \"as\", so it can be a program name with args.\n set dummy as; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:2788: checking for $ac_word\" >&5\n+echo \"configure:2816: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_ncn_cv_AS'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -2823,7 +2851,7 @@ fi\n   # Extract the first word of \"${ncn_tool_prefix}dlltool\", so it can be a program name with args.\n set dummy ${ncn_tool_prefix}dlltool; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:2827: checking for $ac_word\" >&5\n+echo \"configure:2855: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_DLLTOOL'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -2856,7 +2884,7 @@ if test -z \"$ac_cv_prog_DLLTOOL\" ; then\n     # Extract the first word of \"dlltool\", so it can be a program name with args.\n set dummy dlltool; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:2860: checking for $ac_word\" >&5\n+echo \"configure:2888: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_ncn_cv_DLLTOOL'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -2895,7 +2923,7 @@ fi\n   # Extract the first word of \"${ncn_tool_prefix}ld\", so it can be a program name with args.\n set dummy ${ncn_tool_prefix}ld; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:2899: checking for $ac_word\" >&5\n+echo \"configure:2927: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_LD'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -2928,7 +2956,7 @@ if test -z \"$ac_cv_prog_LD\" ; then\n     # Extract the first word of \"ld\", so it can be a program name with args.\n set dummy ld; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:2932: checking for $ac_word\" >&5\n+echo \"configure:2960: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_ncn_cv_LD'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -2967,7 +2995,7 @@ fi\n   # Extract the first word of \"${ncn_tool_prefix}nm\", so it can be a program name with args.\n set dummy ${ncn_tool_prefix}nm; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:2971: checking for $ac_word\" >&5\n+echo \"configure:2999: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_NM'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -3000,7 +3028,7 @@ if test -z \"$ac_cv_prog_NM\" ; then\n     # Extract the first word of \"nm\", so it can be a program name with args.\n set dummy nm; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:3004: checking for $ac_word\" >&5\n+echo \"configure:3032: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_ncn_cv_NM'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -3039,7 +3067,7 @@ fi\n   # Extract the first word of \"${ncn_tool_prefix}ranlib\", so it can be a program name with args.\n set dummy ${ncn_tool_prefix}ranlib; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:3043: checking for $ac_word\" >&5\n+echo \"configure:3071: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_RANLIB'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -3072,7 +3100,7 @@ if test -z \"$ac_cv_prog_RANLIB\" ; then\n     # Extract the first word of \"ranlib\", so it can be a program name with args.\n set dummy ranlib; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:3076: checking for $ac_word\" >&5\n+echo \"configure:3104: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_ncn_cv_RANLIB'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -3111,7 +3139,7 @@ fi\n   # Extract the first word of \"${ncn_tool_prefix}windres\", so it can be a program name with args.\n set dummy ${ncn_tool_prefix}windres; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:3115: checking for $ac_word\" >&5\n+echo \"configure:3143: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_WINDRES'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -3144,7 +3172,7 @@ if test -z \"$ac_cv_prog_WINDRES\" ; then\n     # Extract the first word of \"windres\", so it can be a program name with args.\n set dummy windres; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:3148: checking for $ac_word\" >&5\n+echo \"configure:3176: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_ncn_cv_WINDRES'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -3183,7 +3211,7 @@ fi\n   # Extract the first word of \"${ncn_tool_prefix}objcopy\", so it can be a program name with args.\n set dummy ${ncn_tool_prefix}objcopy; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:3187: checking for $ac_word\" >&5\n+echo \"configure:3215: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_OBJCOPY'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -3216,7 +3244,7 @@ if test -z \"$ac_cv_prog_OBJCOPY\" ; then\n     # Extract the first word of \"objcopy\", so it can be a program name with args.\n set dummy objcopy; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:3220: checking for $ac_word\" >&5\n+echo \"configure:3248: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_ncn_cv_OBJCOPY'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -3255,7 +3283,7 @@ fi\n   # Extract the first word of \"${ncn_tool_prefix}objdump\", so it can be a program name with args.\n set dummy ${ncn_tool_prefix}objdump; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:3259: checking for $ac_word\" >&5\n+echo \"configure:3287: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_OBJDUMP'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -3288,7 +3316,7 @@ if test -z \"$ac_cv_prog_OBJDUMP\" ; then\n     # Extract the first word of \"objdump\", so it can be a program name with args.\n set dummy objdump; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:3292: checking for $ac_word\" >&5\n+echo \"configure:3320: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_ncn_cv_OBJDUMP'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -3336,7 +3364,7 @@ fi\n   # Extract the first word of \"${ncn_target_tool_prefix}ar\", so it can be a program name with args.\n set dummy ${ncn_target_tool_prefix}ar; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:3340: checking for $ac_word\" >&5\n+echo \"configure:3368: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_AR_FOR_TARGET'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -3369,7 +3397,7 @@ if test -z \"$ac_cv_prog_AR_FOR_TARGET\" ; then\n     # Extract the first word of \"ar\", so it can be a program name with args.\n set dummy ar; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:3373: checking for $ac_word\" >&5\n+echo \"configure:3401: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_ncn_cv_AR_FOR_TARGET'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -3408,7 +3436,7 @@ fi\n   # Extract the first word of \"${ncn_target_tool_prefix}as\", so it can be a program name with args.\n set dummy ${ncn_target_tool_prefix}as; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:3412: checking for $ac_word\" >&5\n+echo \"configure:3440: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_AS_FOR_TARGET'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -3441,7 +3469,7 @@ if test -z \"$ac_cv_prog_AS_FOR_TARGET\" ; then\n     # Extract the first word of \"as\", so it can be a program name with args.\n set dummy as; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:3445: checking for $ac_word\" >&5\n+echo \"configure:3473: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_ncn_cv_AS_FOR_TARGET'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -3480,7 +3508,7 @@ fi\n   # Extract the first word of \"${ncn_target_tool_prefix}dlltool\", so it can be a program name with args.\n set dummy ${ncn_target_tool_prefix}dlltool; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:3484: checking for $ac_word\" >&5\n+echo \"configure:3512: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_DLLTOOL_FOR_TARGET'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -3513,7 +3541,7 @@ if test -z \"$ac_cv_prog_DLLTOOL_FOR_TARGET\" ; then\n     # Extract the first word of \"dlltool\", so it can be a program name with args.\n set dummy dlltool; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:3517: checking for $ac_word\" >&5\n+echo \"configure:3545: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_ncn_cv_DLLTOOL_FOR_TARGET'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -3552,7 +3580,7 @@ fi\n   # Extract the first word of \"${ncn_target_tool_prefix}ld\", so it can be a program name with args.\n set dummy ${ncn_target_tool_prefix}ld; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:3556: checking for $ac_word\" >&5\n+echo \"configure:3584: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_LD_FOR_TARGET'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -3585,7 +3613,7 @@ if test -z \"$ac_cv_prog_LD_FOR_TARGET\" ; then\n     # Extract the first word of \"ld\", so it can be a program name with args.\n set dummy ld; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:3589: checking for $ac_word\" >&5\n+echo \"configure:3617: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_ncn_cv_LD_FOR_TARGET'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -3624,7 +3652,7 @@ fi\n   # Extract the first word of \"${ncn_target_tool_prefix}nm\", so it can be a program name with args.\n set dummy ${ncn_target_tool_prefix}nm; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:3628: checking for $ac_word\" >&5\n+echo \"configure:3656: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_NM_FOR_TARGET'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -3657,7 +3685,7 @@ if test -z \"$ac_cv_prog_NM_FOR_TARGET\" ; then\n     # Extract the first word of \"nm\", so it can be a program name with args.\n set dummy nm; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:3661: checking for $ac_word\" >&5\n+echo \"configure:3689: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_ncn_cv_NM_FOR_TARGET'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -3696,7 +3724,7 @@ fi\n   # Extract the first word of \"${ncn_target_tool_prefix}ranlib\", so it can be a program name with args.\n set dummy ${ncn_target_tool_prefix}ranlib; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:3700: checking for $ac_word\" >&5\n+echo \"configure:3728: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_RANLIB_FOR_TARGET'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -3729,7 +3757,7 @@ if test -z \"$ac_cv_prog_RANLIB_FOR_TARGET\" ; then\n     # Extract the first word of \"ranlib\", so it can be a program name with args.\n set dummy ranlib; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:3733: checking for $ac_word\" >&5\n+echo \"configure:3761: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_ncn_cv_RANLIB_FOR_TARGET'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -3768,7 +3796,7 @@ fi\n   # Extract the first word of \"${ncn_target_tool_prefix}windres\", so it can be a program name with args.\n set dummy ${ncn_target_tool_prefix}windres; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:3772: checking for $ac_word\" >&5\n+echo \"configure:3800: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_WINDRES_FOR_TARGET'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -3801,7 +3829,7 @@ if test -z \"$ac_cv_prog_WINDRES_FOR_TARGET\" ; then\n     # Extract the first word of \"windres\", so it can be a program name with args.\n set dummy windres; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:3805: checking for $ac_word\" >&5\n+echo \"configure:3833: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_ncn_cv_WINDRES_FOR_TARGET'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -3868,7 +3896,7 @@ RANLIB_FOR_TARGET=${RANLIB_FOR_TARGET}${extra_ranlibflags_for_target}\n NM_FOR_TARGET=${NM_FOR_TARGET}${extra_nmflags_for_target}\n \n echo $ac_n \"checking whether to enable maintainer-specific portions of Makefiles\"\"... $ac_c\" 1>&6\n-echo \"configure:3872: checking whether to enable maintainer-specific portions of Makefiles\" >&5\n+echo \"configure:3900: checking whether to enable maintainer-specific portions of Makefiles\" >&5\n # Check whether --enable-maintainer-mode or --disable-maintainer-mode was given.\n if test \"${enable_maintainer_mode+set}\" = set; then\n   enableval=\"$enable_maintainer_mode\"\n@@ -4049,6 +4077,9 @@ s%@build_cpu@%$build_cpu%g\n s%@build_vendor@%$build_vendor%g\n s%@build_os@%$build_os%g\n s%@TOPLEVEL_CONFIGURE_ARGUMENTS@%$TOPLEVEL_CONFIGURE_ARGUMENTS%g\n+s%@build_subdir@%$build_subdir%g\n+s%@host_subdir@%$host_subdir%g\n+s%@target_subdir@%$target_subdir%g\n /@maybe_dependencies@/r $maybe_dependencies\n s%@maybe_dependencies@%%g\n /@serialization_dependencies@/r $serialization_dependencies\n@@ -4073,24 +4104,16 @@ s%@build_tooldir@%$build_tooldir%g\n s%@GDB_TK@%$GDB_TK%g\n s%@gxx_include_dir@%$gxx_include_dir%g\n s%@libstdcxx_incdir@%$libstdcxx_incdir%g\n-s%@build_subdir@%$build_subdir%g\n s%@build_configargs@%$build_configargs%g\n s%@configure_build_modules@%$configure_build_modules%g\n s%@all_build_modules@%$all_build_modules%g\n s%@host_configargs@%$host_configargs%g\n s%@configdirs@%$configdirs%g\n-s%@configure_host_modules@%$configure_host_modules%g\n-s%@all_host_modules@%$all_host_modules%g\n s%@check_host_modules@%$check_host_modules%g\n-s%@install_host_modules@%$install_host_modules%g\n s%@install_host_modules_nogcc@%$install_host_modules_nogcc%g\n-s%@target_subdir@%$target_subdir%g\n s%@target_configargs@%$target_configargs%g\n s%@target_configdirs@%$target_configdirs%g\n-s%@configure_target_modules@%$configure_target_modules%g\n-s%@all_target_modules@%$all_target_modules%g\n s%@check_target_modules@%$check_target_modules%g\n-s%@install_target_modules@%$install_target_modules%g\n s%@BISON@%$BISON%g\n s%@CC_FOR_BUILD@%$CC_FOR_BUILD%g\n s%@LEX@%$LEX%g"}, {"sha": "f6fd0783bda8ed0527e44d0f58bc64d80242be9f", "filename": "configure.in", "status": "modified", "additions": 59, "deletions": 57, "changes": 116, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8b87bb9624085b39ceb1596aeeebdf6f297bea04/configure.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8b87bb9624085b39ceb1596aeeebdf6f297bea04/configure.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/configure.in?ref=8b87bb9624085b39ceb1596aeeebdf6f297bea04", "patch": "@@ -164,6 +164,16 @@ target_tools=\"target-examples target-groff target-gperf target-rda\"\n configdirs=`echo ${host_libs} ${host_tools}`\n target_configdirs=`echo ${target_libs} ${target_tools}`\n \n+# Only make build modules if build != host.\n+# This should be done more generally, but at the moment it doesn't matter.\n+if test ${host_alias} != ${build_alias} ; then\n+  # This is the only build module.\n+  build_modules=libiberty\n+else\n+  build_modules=\n+fi\n+\n+\n ################################################################################\n \n srcname=\"gnu development package\"\n@@ -179,9 +189,8 @@ else\n   is_cross_compiler=yes\n fi\t\n \n-# We always want to use the same name for this directory, so that dejagnu\n-# can reliably find it.\n-target_subdir=${target_alias}\n+# Find the build and target subdirs.\n+GCC_TOPLEV_SUBDIRS\n \n if test ! -d ${target_subdir} ; then\n   if mkdir ${target_subdir} ; then true\n@@ -191,9 +200,6 @@ if test ! -d ${target_subdir} ; then\n   fi\n fi\n \n-build_prefix=build-\n-build_subdir=${build_prefix}${build_alias}\n-\n if test x\"${build_alias}\" != x\"${host}\" ; then\n   if test ! -d ${build_subdir} ; then\n     if mkdir ${build_subdir} ; then true\n@@ -1604,59 +1610,27 @@ esac\n target_configdirs=`echo \"${target_configdirs}\" | sed -e 's/target-//g'`\n \n # This is the final value for target_configdirs.  configdirs already\n-# has its final value.  It's time to create some lists of valid targets.\n-\n-# While at that, we remove Makefiles if we were started for recursive\n-# configuration, such that the top-level Makefile reconfigures them,\n-# like we used to do when configure itself was recursive.\n+# has its final value, as does build_modules.  It's time to create some \n+# lists of valid targets.\n \n all_build_modules=\n configure_build_modules=\n-# Only make build modules if build != host.\n-# This should be done more generally, but at the moment it doesn't matter.\n-if test ${host_alias} != ${build_alias} ; then\n-  for module in libiberty ; do\n-    all_build_modules=all-build-${module}\n-    configure_build_modules=configure-build-${module}\n-    if test -z \"${no_recursion}\" \\\n-       && test -f ${build_subdir}/${module}/Makefile; then\n-      echo 1>&2 \"*** removing ${build_subdir}/${module}/Makefile to force reconfigure\"\n-      rm -f ${build_subdir}/${module}/Makefile\n-    fi\n-  done\n-fi\n+for module in ${build_modules} ; do\n+  all_build_modules=all-build-${module}\n+  configure_build_modules=configure-build-${module}\n+done\n \n-all_host_modules=\n check_host_modules=\n install_host_modules=\n-configure_host_modules=\n for module in ${configdirs} ; do\n-  all_host_modules=\"${all_host_modules} all-${module}\"\n   check_host_modules=\"${check_host_modules} check-${module}\"\n   install_host_modules=\"${install_host_modules} install-${module}\"\n-  configure_host_modules=\"${configure_host_modules} configure-${module}\"\n-  if test -z \"${no_recursion}\" \\\n-     && test -f ${module}/Makefile; then\n-    echo 1>&2 \"*** removing ${module}/Makefile to force reconfigure\"\n-    rm -f ${module}/Makefile\n-  fi\n done\n install_host_modules_nogcc=`echo \"${install_host_modules}\" | sed -e 's/install-gcc//g'`\n \n-all_target_modules=\n check_target_modules=\n-install_target_modules=\n-configure_target_modules=\n for module in ${target_configdirs} ; do\n-  all_target_modules=\"${all_target_modules} all-target-${module}\"\n   check_target_modules=\"${check_target_modules} check-target-${module}\"\n-  install_target_modules=\"${install_target_modules} install-target-${module}\"\n-  configure_target_modules=\"${configure_target_modules} configure-target-${module}\"\n-  if test -z \"${no_recursion}\" \\\n-     && test -f ${target_subdir}/${module}/Makefile; then\n-    echo 1>&2 \"*** removing ${target_subdir}/${module}/Makefile to force reconfigure\"\n-    rm -f ${target_subdir}/${module}/Makefile\n-  fi\n done\n \n # Determine whether gdb needs tk/tcl or not.\n@@ -1686,13 +1660,49 @@ case \"$enable_gdbtk\" in\n esac\n \n # Create the 'maybe dependencies'.  This uses a temporary file.\n+\n+# While at that, we remove Makefiles if we were started for recursive\n+# configuration, so that the top-level Makefile reconfigures them,\n+# like we used to do when configure itself was recursive.\n rm -f maybedep.tmp\n echo '# maybedep.tmp' > maybedep.tmp\n-for item in ${all_build_modules} ${all_host_modules} ${all_target_modules} \\\n-\t${install_host_modules} ${install_target_modules} \\\n-\t${configure_build_modules} ${configure_host_modules} ${configure_target_modules} \\\n-\t; do\n-  echo \"maybe-${item}: ${item}\" >> maybedep.tmp\n+\n+# Make-targets which may need maybe dependencies.\n+mts=\"configure all install\"\n+\n+# Loop over modules and make-targets.\n+for module in ${build_modules} ; do\n+  if test -z \"${no_recursion}\" \\\n+     && test -f ${build_subdir}/${module}/Makefile; then\n+    echo 1>&2 \"*** removing ${build_subdir}/${module}/Makefile to force reconfigure\"\n+    rm -f ${build_subdir}/${module}/Makefile\n+  fi\n+  for mt in ${mts} ; do\n+    case ${mt} in\n+      install) ;; # No installing build modules.\n+      *) echo \"maybe-${mt}-build-${module}: ${mt}-build-${module}\" >> maybedep.tmp ;;\n+    esac\n+  done\n+done\n+for module in ${configdirs} ; do\n+  if test -z \"${no_recursion}\" \\\n+     && test -f ${module}/Makefile; then\n+    echo 1>&2 \"*** removing ${module}/Makefile to force reconfigure\"\n+    rm -f ${module}/Makefile\n+  fi\n+  for mt in ${mts} ; do\n+    echo \"maybe-${mt}-${module}: ${mt}-${module}\" >> maybedep.tmp\n+  done\n+done\n+for module in ${target_configdirs} ; do\n+  if test -z \"${no_recursion}\" \\\n+     && test -f ${target_subdir}/${module}/Makefile; then\n+    echo 1>&2 \"*** removing ${target_subdir}/${module}/Makefile to force reconfigure\"\n+    rm -f ${target_subdir}/${module}/Makefile\n+  fi\n+  for mt in ${mts} ; do\n+    echo \"maybe-${mt}-target-${module}: ${mt}-target-${module}\" >> maybedep.tmp\n+  done\n done\n maybe_dependencies=maybedep.tmp\n AC_SUBST_FILE(maybe_dependencies)\n@@ -1977,28 +1987,20 @@ AC_SUBST(gxx_include_dir)\n AC_SUBST(libstdcxx_incdir)\n \n # Build module lists & subconfigure args.\n-AC_SUBST(build_subdir)\n AC_SUBST(build_configargs)\n AC_SUBST(configure_build_modules)\n AC_SUBST(all_build_modules)\n \n # Host module lists & subconfigure args.\n AC_SUBST(host_configargs)\n AC_SUBST(configdirs)\n-AC_SUBST(configure_host_modules)\n-AC_SUBST(all_host_modules)\n AC_SUBST(check_host_modules)\n-AC_SUBST(install_host_modules)\n AC_SUBST(install_host_modules_nogcc)\n \n # Target module lists & subconfigure args.\n-AC_SUBST(target_subdir)\n AC_SUBST(target_configargs)\n AC_SUBST(target_configdirs)\n-AC_SUBST(configure_target_modules)\n-AC_SUBST(all_target_modules)\n AC_SUBST(check_target_modules)\n-AC_SUBST(install_target_modules)\n \n # Build tools.\n AC_SUBST(BISON)"}]}