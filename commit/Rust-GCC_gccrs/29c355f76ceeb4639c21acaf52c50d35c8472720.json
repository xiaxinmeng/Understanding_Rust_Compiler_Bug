{"sha": "29c355f76ceeb4639c21acaf52c50d35c8472720", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjljMzU1Zjc2Y2VlYjQ2MzljMjFhY2FmNTJjNTBkMzVjODQ3MjcyMA==", "commit": {"author": {"name": "Thomas Schwinge", "email": "thomas@codesourcery.com", "date": "2021-08-19T13:14:51Z"}, "committer": {"name": "Thomas Schwinge", "email": "thomas@codesourcery.com", "date": "2021-08-23T15:46:08Z"}, "message": "Add 'libgomp.c/address-space-1.c'\n\nIntel MIC (emulated) offloading execution failure remains to be analyzed.\n\n\tlibgomp/\n\t* testsuite/libgomp.c/address-space-1.c: New file.\n\nCo-authored-by: Jakub Jelinek <jakub@redhat.com>", "tree": {"sha": "8e6851efb3619bd4a22d2250cd01ec032987a32b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8e6851efb3619bd4a22d2250cd01ec032987a32b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/29c355f76ceeb4639c21acaf52c50d35c8472720", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/29c355f76ceeb4639c21acaf52c50d35c8472720", "html_url": "https://github.com/Rust-GCC/gccrs/commit/29c355f76ceeb4639c21acaf52c50d35c8472720", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/29c355f76ceeb4639c21acaf52c50d35c8472720/comments", "author": {"login": "tschwinge", "id": 21753, "node_id": "MDQ6VXNlcjIxNzUz", "avatar_url": "https://avatars.githubusercontent.com/u/21753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tschwinge", "html_url": "https://github.com/tschwinge", "followers_url": "https://api.github.com/users/tschwinge/followers", "following_url": "https://api.github.com/users/tschwinge/following{/other_user}", "gists_url": "https://api.github.com/users/tschwinge/gists{/gist_id}", "starred_url": "https://api.github.com/users/tschwinge/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tschwinge/subscriptions", "organizations_url": "https://api.github.com/users/tschwinge/orgs", "repos_url": "https://api.github.com/users/tschwinge/repos", "events_url": "https://api.github.com/users/tschwinge/events{/privacy}", "received_events_url": "https://api.github.com/users/tschwinge/received_events", "type": "User", "site_admin": false}, "committer": {"login": "tschwinge", "id": 21753, "node_id": "MDQ6VXNlcjIxNzUz", "avatar_url": "https://avatars.githubusercontent.com/u/21753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tschwinge", "html_url": "https://github.com/tschwinge", "followers_url": "https://api.github.com/users/tschwinge/followers", "following_url": "https://api.github.com/users/tschwinge/following{/other_user}", "gists_url": "https://api.github.com/users/tschwinge/gists{/gist_id}", "starred_url": "https://api.github.com/users/tschwinge/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tschwinge/subscriptions", "organizations_url": "https://api.github.com/users/tschwinge/orgs", "repos_url": "https://api.github.com/users/tschwinge/repos", "events_url": "https://api.github.com/users/tschwinge/events{/privacy}", "received_events_url": "https://api.github.com/users/tschwinge/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "bb75b22aba254e8ff144db27b1c8b4804bad73bb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bb75b22aba254e8ff144db27b1c8b4804bad73bb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bb75b22aba254e8ff144db27b1c8b4804bad73bb"}], "stats": {"total": 28, "additions": 28, "deletions": 0}, "files": [{"sha": "6ad57deec42a119c09f43aca7b93f5a247f7c5e5", "filename": "libgomp/testsuite/libgomp.c/address-space-1.c", "status": "added", "additions": 28, "deletions": 0, "changes": 28, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/29c355f76ceeb4639c21acaf52c50d35c8472720/libgomp%2Ftestsuite%2Flibgomp.c%2Faddress-space-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/29c355f76ceeb4639c21acaf52c50d35c8472720/libgomp%2Ftestsuite%2Flibgomp.c%2Faddress-space-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Ftestsuite%2Flibgomp.c%2Faddress-space-1.c?ref=29c355f76ceeb4639c21acaf52c50d35c8472720", "patch": "@@ -0,0 +1,28 @@\n+/* Verify OMP instances of variables with address space.  */\n+\n+/* { dg-do run { target i?86-*-* x86_64-*-* } } */\n+/* { dg-require-effective-target offload_device_nonshared_as } */\n+\n+/* With Intel MIC (emulated) offloading:\n+       offload error: process on the device 0 unexpectedly exited with code 0\n+   { dg-xfail-run-if TODO { offload_device_intel_mic } } */\n+\n+#include <assert.h>\n+\n+int __seg_fs a;\n+\n+int\n+main (void)\n+{\n+  // a = 123; // SIGSEGV\n+  int b;\n+#pragma omp target map(alloc: a) map(from: b)\n+  {\n+    a = 321; // no SIGSEGV (given 'offload_device_nonshared_as')\n+    asm volatile (\"\" : : \"g\" (&a) : \"memory\");\n+    b = a;\n+  }\n+  assert (b == 321);\n+\n+  return 0;\n+}"}]}