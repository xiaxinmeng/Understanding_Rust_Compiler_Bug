{"sha": "93302a249147f4260a9f3ab1c7f9a30a268b42c1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTMzMDJhMjQ5MTQ3ZjQyNjBhOWYzYWIxYzdmOWEzMGEyNjhiNDJjMQ==", "commit": {"author": {"name": "Janus Weil", "email": "janus@gcc.gnu.org", "date": "2011-02-14T11:59:53Z"}, "committer": {"name": "Janus Weil", "email": "janus@gcc.gnu.org", "date": "2011-02-14T11:59:53Z"}, "message": "re PR fortran/47349 (missing warning: Actual argument contains too few elements)\n\n2011-02-14  Janus Weil  <janus@gcc.gnu.org>\n\n\tPR fortran/47349\n\t* interface.c (get_expr_storage_size): Handle derived-type components.\n\n\n2011-02-14  Janus Weil  <janus@gcc.gnu.org>\n\n\tPR fortran/47349\n\t* gfortran.dg/argument_checking_18.f90: New.\n\nFrom-SVN: r170125", "tree": {"sha": "172e199312149686d90adfedcad99c359adb92f4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/172e199312149686d90adfedcad99c359adb92f4"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/93302a249147f4260a9f3ab1c7f9a30a268b42c1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/93302a249147f4260a9f3ab1c7f9a30a268b42c1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/93302a249147f4260a9f3ab1c7f9a30a268b42c1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/93302a249147f4260a9f3ab1c7f9a30a268b42c1/comments", "author": {"login": "janusw", "id": 484108, "node_id": "MDQ6VXNlcjQ4NDEwOA==", "avatar_url": "https://avatars.githubusercontent.com/u/484108?v=4", "gravatar_id": "", "url": "https://api.github.com/users/janusw", "html_url": "https://github.com/janusw", "followers_url": "https://api.github.com/users/janusw/followers", "following_url": "https://api.github.com/users/janusw/following{/other_user}", "gists_url": "https://api.github.com/users/janusw/gists{/gist_id}", "starred_url": "https://api.github.com/users/janusw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/janusw/subscriptions", "organizations_url": "https://api.github.com/users/janusw/orgs", "repos_url": "https://api.github.com/users/janusw/repos", "events_url": "https://api.github.com/users/janusw/events{/privacy}", "received_events_url": "https://api.github.com/users/janusw/received_events", "type": "User", "site_admin": false}, "committer": {"login": "janusw", "id": 484108, "node_id": "MDQ6VXNlcjQ4NDEwOA==", "avatar_url": "https://avatars.githubusercontent.com/u/484108?v=4", "gravatar_id": "", "url": "https://api.github.com/users/janusw", "html_url": "https://github.com/janusw", "followers_url": "https://api.github.com/users/janusw/followers", "following_url": "https://api.github.com/users/janusw/following{/other_user}", "gists_url": "https://api.github.com/users/janusw/gists{/gist_id}", "starred_url": "https://api.github.com/users/janusw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/janusw/subscriptions", "organizations_url": "https://api.github.com/users/janusw/orgs", "repos_url": "https://api.github.com/users/janusw/repos", "events_url": "https://api.github.com/users/janusw/events{/privacy}", "received_events_url": "https://api.github.com/users/janusw/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "75eec5b611f82b23445fad973847b5ec8b62fbae", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/75eec5b611f82b23445fad973847b5ec8b62fbae", "html_url": "https://github.com/Rust-GCC/gccrs/commit/75eec5b611f82b23445fad973847b5ec8b62fbae"}], "stats": {"total": 54, "additions": 48, "deletions": 6}, "files": [{"sha": "9bf2eb0af0f1186d1d9b5f5871ddec9a84b9a48b", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/93302a249147f4260a9f3ab1c7f9a30a268b42c1/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/93302a249147f4260a9f3ab1c7f9a30a268b42c1/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=93302a249147f4260a9f3ab1c7f9a30a268b42c1", "patch": "@@ -1,3 +1,8 @@\n+2011-02-14  Janus Weil  <janus@gcc.gnu.org>\n+\n+\tPR fortran/47349\n+\t* interface.c (get_expr_storage_size): Handle derived-type components.\n+\n 2011-02-13  Tobias Burnus  <burnus@net-b.de>\n \n \tPR fortran/47569"}, {"sha": "071eed951edd1640f06ad7c5c7f69dc09ef66bd6", "filename": "gcc/fortran/interface.c", "status": "modified", "additions": 4, "deletions": 6, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/93302a249147f4260a9f3ab1c7f9a30a268b42c1/gcc%2Ffortran%2Finterface.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/93302a249147f4260a9f3ab1c7f9a30a268b42c1/gcc%2Ffortran%2Finterface.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Finterface.c?ref=93302a249147f4260a9f3ab1c7f9a30a268b42c1", "patch": "@@ -1910,7 +1910,7 @@ get_expr_storage_size (gfc_expr *e)\n       else if (ref->type == REF_ARRAY && ref->u.ar.type == AR_ELEMENT\n \t       && e->expr_type == EXPR_VARIABLE)\n \t{\n-\t  if (e->symtree->n.sym->as->type == AS_ASSUMED_SHAPE\n+\t  if (ref->u.ar.as->type == AS_ASSUMED_SHAPE\n \t      || e->symtree->n.sym->attr.pointer)\n \t    {\n \t      elements = 1;\n@@ -1939,8 +1939,6 @@ get_expr_storage_size (gfc_expr *e)\n \t\t\t- mpz_get_si (ref->u.ar.as->lower[i]->value.integer));\n \t    }\n         }\n-      else\n-\treturn 0;\n     }\n \n   if (substrlen)\n@@ -2130,9 +2128,9 @@ compare_actual_formal (gfc_actual_arglist **ap, gfc_formal_arglist *formal,\n \n       actual_size = get_expr_storage_size (a->expr);\n       formal_size = get_sym_storage_size (f->sym);\n-      if (actual_size != 0\n-\t    && actual_size < formal_size\n-\t    && a->expr->ts.type != BT_PROCEDURE)\n+      if (actual_size != 0 && actual_size < formal_size\n+\t  && a->expr->ts.type != BT_PROCEDURE\n+\t  && f->sym->attr.flavor != FL_PROCEDURE)\n \t{\n \t  if (a->expr->ts.type == BT_CHARACTER && !f->sym->as && where)\n \t    gfc_warning (\"Character length of actual argument shorter \""}, {"sha": "1952af98e583190bca04fdeded8232e8f9306faf", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/93302a249147f4260a9f3ab1c7f9a30a268b42c1/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/93302a249147f4260a9f3ab1c7f9a30a268b42c1/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=93302a249147f4260a9f3ab1c7f9a30a268b42c1", "patch": "@@ -1,3 +1,8 @@\n+2011-02-14  Janus Weil  <janus@gcc.gnu.org>\n+\n+\tPR fortran/47349\n+\t* gfortran.dg/argument_checking_18.f90: New.\n+\n 2011-02-13  Tobias Burnus  <burnus@net-b.de>\n \n \t* gfortran.dg/argument_checking_13.f90: Update dg-error."}, {"sha": "dd95b6197b02688bc9cd6986981c42bd0048e7f6", "filename": "gcc/testsuite/gfortran.dg/argument_checking_18.f90", "status": "added", "additions": 34, "deletions": 0, "changes": 34, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/93302a249147f4260a9f3ab1c7f9a30a268b42c1/gcc%2Ftestsuite%2Fgfortran.dg%2Fargument_checking_18.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/93302a249147f4260a9f3ab1c7f9a30a268b42c1/gcc%2Ftestsuite%2Fgfortran.dg%2Fargument_checking_18.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fargument_checking_18.f90?ref=93302a249147f4260a9f3ab1c7f9a30a268b42c1", "patch": "@@ -0,0 +1,34 @@\n+! { dg-do compile }\n+!\n+! PR 47349: missing warning: Actual argument contains too few elements\n+!\n+! Contributed by Janus Weil <janus@gcc.gnu.org>\n+\n+ implicit none\n+ type t\n+    integer :: j(3)\n+ end type t\n+\n+ type(t) :: tt\n+ integer :: i(3) = (/ 1,2,3 /)\n+\n+ tt%j = i\n+\n+ call sub1 (i)     ! { dg-warning \"Actual argument contains too few elements\" }\n+ call sub1 (tt%j)  ! { dg-warning \"Actual argument contains too few elements\" }\n+ call sub2 (i)     ! { dg-error \"Rank mismatch in argument\" }\n+ call sub2 (tt%j)  ! { dg-error \"Rank mismatch in argument\" }\n+\n+contains\n+\n+  subroutine sub1(i)\n+    integer, dimension(1:3,1:3) :: i\n+    print *,\"sub1:\",i\n+  end subroutine\n+\n+  subroutine sub2(i)\n+    integer, dimension(:,:) :: i\n+    print *,\"sub2:\",i\n+  end subroutine\n+\n+end"}]}