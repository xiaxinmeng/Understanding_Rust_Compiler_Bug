{"sha": "33fc9dc962db960bde7473ef392ad3f9b4701ced", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzNmYzlkYzk2MmRiOTYwYmRlNzQ3M2VmMzkyYWQzZjliNDcwMWNlZA==", "commit": {"author": {"name": "Thomas Schwinge", "email": "thomas@codesourcery.com", "date": "2019-03-21T19:44:34Z"}, "committer": {"name": "Thomas Schwinge", "email": "tschwinge@gcc.gnu.org", "date": "2019-03-21T19:44:34Z"}, "message": "[testsuite, Fortran] Provide 'dg-compile-aux-modules' in 'gfortran.dg/goacc/goacc.exp'\n\n..., as yet another copy from 'gfortran.dg/dg.exp', which there are a few\nalready.\n\n\tgcc/testsuite/\n\t* gfortran.dg/goacc/goacc.exp (dg-compile-aux-modules): New proc.\n\nFrom-SVN: r269854", "tree": {"sha": "e3369c2fa8a93745373a59608d210589549274a5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e3369c2fa8a93745373a59608d210589549274a5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/33fc9dc962db960bde7473ef392ad3f9b4701ced", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/33fc9dc962db960bde7473ef392ad3f9b4701ced", "html_url": "https://github.com/Rust-GCC/gccrs/commit/33fc9dc962db960bde7473ef392ad3f9b4701ced", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/33fc9dc962db960bde7473ef392ad3f9b4701ced/comments", "author": {"login": "tschwinge", "id": 21753, "node_id": "MDQ6VXNlcjIxNzUz", "avatar_url": "https://avatars.githubusercontent.com/u/21753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tschwinge", "html_url": "https://github.com/tschwinge", "followers_url": "https://api.github.com/users/tschwinge/followers", "following_url": "https://api.github.com/users/tschwinge/following{/other_user}", "gists_url": "https://api.github.com/users/tschwinge/gists{/gist_id}", "starred_url": "https://api.github.com/users/tschwinge/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tschwinge/subscriptions", "organizations_url": "https://api.github.com/users/tschwinge/orgs", "repos_url": "https://api.github.com/users/tschwinge/repos", "events_url": "https://api.github.com/users/tschwinge/events{/privacy}", "received_events_url": "https://api.github.com/users/tschwinge/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "a77457430eb50bff3bb071e3eb0e7c88056d373f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a77457430eb50bff3bb071e3eb0e7c88056d373f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a77457430eb50bff3bb071e3eb0e7c88056d373f"}], "stats": {"total": 27, "additions": 27, "deletions": 0}, "files": [{"sha": "1f2f3eba6f40431c000289b10616285b258e2681", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/33fc9dc962db960bde7473ef392ad3f9b4701ced/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/33fc9dc962db960bde7473ef392ad3f9b4701ced/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=33fc9dc962db960bde7473ef392ad3f9b4701ced", "patch": "@@ -1,5 +1,7 @@\n 2019-03-21  Thomas Schwinge  <thomas@codesourcery.com>\n \n+\t* gfortran.dg/goacc/goacc.exp (dg-compile-aux-modules): New proc.\n+\n \tPR fortran/56408\n \t* gcc.target/powerpc/ppc-fortran/ppc-fortran.exp\n \t(dg-compile-aux-modules): Fix diagnostic."}, {"sha": "1b093f6d41f5ec382697b754dee6291596bedc74", "filename": "gcc/testsuite/gfortran.dg/goacc/goacc.exp", "status": "modified", "additions": 25, "deletions": 0, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/33fc9dc962db960bde7473ef392ad3f9b4701ced/gcc%2Ftestsuite%2Fgfortran.dg%2Fgoacc%2Fgoacc.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/33fc9dc962db960bde7473ef392ad3f9b4701ced/gcc%2Ftestsuite%2Fgfortran.dg%2Fgoacc%2Fgoacc.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fgoacc%2Fgoacc.exp?ref=33fc9dc962db960bde7473ef392ad3f9b4701ced", "patch": "@@ -28,6 +28,31 @@ if ![check_effective_target_fopenacc] {\n # Initialize `dg'.\n dg-init\n \n+global gfortran_test_path\n+global gfortran_aux_module_flags\n+set gfortran_test_path $srcdir/$subdir\n+set gfortran_aux_module_flags \"-fopenacc\"\n+proc dg-compile-aux-modules { args } {\n+    global gfortran_test_path\n+    global gfortran_aux_module_flags\n+    if { [llength $args] != 2 } {\n+\terror \"dg-compile-aux-modules: needs one argument\"\n+\treturn\n+    }\n+\n+    set level [info level]\n+    if { [info procs dg-save-unknown] != [list] } {\n+\trename dg-save-unknown dg-save-unknown-level-$level\n+    }\n+\n+    dg-test $gfortran_test_path/[lindex $args 1] \"\" $gfortran_aux_module_flags\n+    # cleanup-modules is intentionally not invoked here.\n+\n+    if { [info procs dg-save-unknown-level-$level] != [list] } {\n+\trename dg-save-unknown-level-$level dg-save-unknown\n+    }\n+}\n+\n # Main loop.\n gfortran-dg-runtest [lsort \\\n        [find $srcdir/$subdir *.\\[fF\\]{,90,95,03,08} ] ] \"\" \"-fopenacc\""}]}