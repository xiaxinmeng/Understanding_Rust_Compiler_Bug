{"sha": "bff26ac162772313d3d9b8ce952b5a0846e26878", "node_id": "C_kwDOANBUbNoAKGJmZjI2YWMxNjI3NzIzMTNkM2Q5YjhjZTk1MmI1YTA4NDZlMjY4Nzg", "commit": {"author": {"name": "Arsen Arsenovi\u0107", "email": "arsen@aarsen.me", "date": "2023-04-04T17:25:09Z"}, "committer": {"name": "Arsen Arsenovi\u0107", "email": "arsen@aarsen.me", "date": "2023-04-05T16:45:14Z"}, "message": "libstdc++: Downgrade DEBUG to ASSERTIONS when !HOSTED\n\nSupporting the debug mode in freestanding is a non-trivial job, so\ninstead, as a best-effort, enable assertions, which are light and easy.\n\nlibstdc++-v3/ChangeLog:\n\n\t* include/bits/c++config: When __STDC_HOSTED__ is zero,\n\tdisable _GLIBCXX_DEBUG and, if it was set, enable\n\t_GLIBCXX_ASSERTIONS.\n\t* testsuite/lib/libstdc++.exp (check_v3_target_debug_mode):\n\tInclude <bits/c++config.h> when determining whether debug is\n\tset, in order to inherit the logic from above", "tree": {"sha": "754e0a573fd17701fe8a933277e8462063231908", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/754e0a573fd17701fe8a933277e8462063231908"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bff26ac162772313d3d9b8ce952b5a0846e26878", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niNUEABYKAH0WIQT+4rPRE/wAoxYtYGFSwpQwHqLEkwUCZC2lm18UgAAAAAAuAChp\nc3N1ZXItZnByQG5vdGF0aW9ucy5vcGVucGdwLmZpZnRoaG9yc2VtYW4ubmV0RkVF\nMkIzRDExM0ZDMDBBMzE2MkQ2MDYxNTJDMjk0MzAxRUEyQzQ5MwAKCRBSwpQwHqLE\nk8YkAQDrKLT5XgrbPpJ0x8gYmWABH5vwFKUzSQcpp8uZ3tw9HwD/aH6PCoLZklpK\ny5JtjK7RIm8bTAJimaIqT8mW0d8M8A8=\n=Hpb5\n-----END PGP SIGNATURE-----", "payload": "tree 754e0a573fd17701fe8a933277e8462063231908\nparent 6f0d67b912900009bff5018bd58e17ea1db1de69\nauthor Arsen Arsenovi\u0107 <arsen@aarsen.me> 1680629109 +0200\ncommitter Arsen Arsenovi\u0107 <arsen@aarsen.me> 1680713114 +0200\n\nlibstdc++: Downgrade DEBUG to ASSERTIONS when !HOSTED\n\nSupporting the debug mode in freestanding is a non-trivial job, so\ninstead, as a best-effort, enable assertions, which are light and easy.\n\nlibstdc++-v3/ChangeLog:\n\n\t* include/bits/c++config: When __STDC_HOSTED__ is zero,\n\tdisable _GLIBCXX_DEBUG and, if it was set, enable\n\t_GLIBCXX_ASSERTIONS.\n\t* testsuite/lib/libstdc++.exp (check_v3_target_debug_mode):\n\tInclude <bits/c++config.h> when determining whether debug is\n\tset, in order to inherit the logic from above\n"}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bff26ac162772313d3d9b8ce952b5a0846e26878", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bff26ac162772313d3d9b8ce952b5a0846e26878", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bff26ac162772313d3d9b8ce952b5a0846e26878/comments", "author": {"login": "ArsenArsen", "id": 7805050, "node_id": "MDQ6VXNlcjc4MDUwNTA=", "avatar_url": "https://avatars.githubusercontent.com/u/7805050?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ArsenArsen", "html_url": "https://github.com/ArsenArsen", "followers_url": "https://api.github.com/users/ArsenArsen/followers", "following_url": "https://api.github.com/users/ArsenArsen/following{/other_user}", "gists_url": "https://api.github.com/users/ArsenArsen/gists{/gist_id}", "starred_url": "https://api.github.com/users/ArsenArsen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ArsenArsen/subscriptions", "organizations_url": "https://api.github.com/users/ArsenArsen/orgs", "repos_url": "https://api.github.com/users/ArsenArsen/repos", "events_url": "https://api.github.com/users/ArsenArsen/events{/privacy}", "received_events_url": "https://api.github.com/users/ArsenArsen/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ArsenArsen", "id": 7805050, "node_id": "MDQ6VXNlcjc4MDUwNTA=", "avatar_url": "https://avatars.githubusercontent.com/u/7805050?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ArsenArsen", "html_url": "https://github.com/ArsenArsen", "followers_url": "https://api.github.com/users/ArsenArsen/followers", "following_url": "https://api.github.com/users/ArsenArsen/following{/other_user}", "gists_url": "https://api.github.com/users/ArsenArsen/gists{/gist_id}", "starred_url": "https://api.github.com/users/ArsenArsen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ArsenArsen/subscriptions", "organizations_url": "https://api.github.com/users/ArsenArsen/orgs", "repos_url": "https://api.github.com/users/ArsenArsen/repos", "events_url": "https://api.github.com/users/ArsenArsen/events{/privacy}", "received_events_url": "https://api.github.com/users/ArsenArsen/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6f0d67b912900009bff5018bd58e17ea1db1de69", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6f0d67b912900009bff5018bd58e17ea1db1de69", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6f0d67b912900009bff5018bd58e17ea1db1de69"}], "stats": {"total": 8, "additions": 8, "deletions": 0}, "files": [{"sha": "13892787e095c9810a616399658d0d98de6338e9", "filename": "libstdc++-v3/include/bits/c++config", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bff26ac162772313d3d9b8ce952b5a0846e26878/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fc%2B%2Bconfig", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bff26ac162772313d3d9b8ce952b5a0846e26878/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fc%2B%2Bconfig", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fc%2B%2Bconfig?ref=bff26ac162772313d3d9b8ce952b5a0846e26878", "patch": "@@ -397,6 +397,13 @@ _GLIBCXX_END_NAMESPACE_VERSION\n # define _GLIBCXX_END_INLINE_ABI_NAMESPACE(X)   } // inline namespace X\n #endif\n \n+// In the case that we don't have a hosted environment, we can't provide the\n+// debugging mode.  Instead, we do our best and downgrade to assertions.\n+#if defined(_GLIBCXX_DEBUG) && !__STDC_HOSTED__\n+#undef _GLIBCXX_DEBUG\n+#define _GLIBCXX_ASSERTIONS 1\n+#endif\n+\n // Inline namespaces for special modes: debug, parallel.\n #if defined(_GLIBCXX_DEBUG) || defined(_GLIBCXX_PARALLEL)\n namespace std"}, {"sha": "490abd108fada7ab91a553bfc0f85770c74004bb", "filename": "libstdc++-v3/testsuite/lib/libstdc++.exp", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bff26ac162772313d3d9b8ce952b5a0846e26878/libstdc%2B%2B-v3%2Ftestsuite%2Flib%2Flibstdc%2B%2B.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bff26ac162772313d3d9b8ce952b5a0846e26878/libstdc%2B%2B-v3%2Ftestsuite%2Flib%2Flibstdc%2B%2B.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2Flib%2Flibstdc%2B%2B.exp?ref=bff26ac162772313d3d9b8ce952b5a0846e26878", "patch": "@@ -1007,6 +1007,7 @@ proc check_v3_target_debug_mode { } {\n     global cxxflags\n     return [check_v3_target_prop_cached et_debug_mode {\n \tset code \"\n+\t#include <bits/c++config.h>\n \t#if ! defined _GLIBCXX_DEBUG\n \t# error no debug mode\n \t#endif"}]}