{"sha": "176a3386885f99654139a2222144b57471a2aee6", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTc2YTMzODY4ODVmOTk2NTQxMzlhMjIyMjE0NGI1NzQ3MWEyYWVlNg==", "commit": {"author": {"name": "Olga Makhotina", "email": "olga.makhotina@intel.com", "date": "2018-04-16T11:23:55Z"}, "committer": {"name": "Julia Koval", "email": "jkoval@gcc.gnu.org", "date": "2018-04-16T11:23:55Z"}, "message": "Fixed g++.dg/ext/mv16.C with -march=native.\n\ngcc/\n\tPR target/84331\n\t* gcc/config.gcc: Support \"skylake\".\n\t* gcc/config/i386/i386-c.c (ix86_target_macros_internal): Handle\n\tPROCESSOR_SKYLAKE.\n\t* gcc/config/i386/i386.c (m_SKYLAKE): Define.\n\t(processor_target_table): Add \"skylake\".\n\t(ix86_option_override_internal): Add \"skylake\".\n\t(get_builtin_code_for_version): Handle PROCESSOR_SKYLAKE,\n\tPROCESSOR_CANNONLAKE.\n\t(get_builtin_code_for_version): Fix priority for\n\tPROCESSOR_ICELAKE_CLIENT, PROCESSOR_ICELAKE_SERVER,\n\tPROCESSOR_SKYLAKE-AVX512.\n\t* gcc/config/i386/i386.h (processor_costs): Define TARGET_SKYLAKE.\n\t(processor_type): Add PROCESSOR_SKYLAKE.\n\ngcc/testsuite/\n\tPR target/84331\n\t* gcc/testsuite/gcc.target/i386/funcspec-56.inc: Test arch=skylake.\n\nFrom-SVN: r259399", "tree": {"sha": "3a65dbafe9bb9e8ad72810c58503bb4686c743c9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3a65dbafe9bb9e8ad72810c58503bb4686c743c9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/176a3386885f99654139a2222144b57471a2aee6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/176a3386885f99654139a2222144b57471a2aee6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/176a3386885f99654139a2222144b57471a2aee6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/176a3386885f99654139a2222144b57471a2aee6/comments", "author": {"login": "Djilka", "id": 6038217, "node_id": "MDQ6VXNlcjYwMzgyMTc=", "avatar_url": "https://avatars.githubusercontent.com/u/6038217?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Djilka", "html_url": "https://github.com/Djilka", "followers_url": "https://api.github.com/users/Djilka/followers", "following_url": "https://api.github.com/users/Djilka/following{/other_user}", "gists_url": "https://api.github.com/users/Djilka/gists{/gist_id}", "starred_url": "https://api.github.com/users/Djilka/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Djilka/subscriptions", "organizations_url": "https://api.github.com/users/Djilka/orgs", "repos_url": "https://api.github.com/users/Djilka/repos", "events_url": "https://api.github.com/users/Djilka/events{/privacy}", "received_events_url": "https://api.github.com/users/Djilka/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "a57f99ba1c8f5ece013b9a2cae954338a492764a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a57f99ba1c8f5ece013b9a2cae954338a492764a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a57f99ba1c8f5ece013b9a2cae954338a492764a"}], "stats": {"total": 66, "additions": 52, "deletions": 14}, "files": [{"sha": "8cc7a6b8167e812465a595ecc2ba3507cb004994", "filename": "gcc/ChangeLog", "status": "modified", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/176a3386885f99654139a2222144b57471a2aee6/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/176a3386885f99654139a2222144b57471a2aee6/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=176a3386885f99654139a2222144b57471a2aee6", "patch": "@@ -1,3 +1,20 @@\n+2018-04-16  Olga Makhotina  <olga.makhotina@intel.com>\n+\n+\tPR target/84331\n+\t* gcc/config.gcc: Support \"skylake\".\n+\t* gcc/config/i386/i386-c.c (ix86_target_macros_internal): Handle\n+\tPROCESSOR_SKYLAKE.\n+\t* gcc/config/i386/i386.c (m_SKYLAKE): Define.\n+\t(processor_target_table): Add \"skylake\".\n+\t(ix86_option_override_internal): Add \"skylake\".\n+\t(get_builtin_code_for_version): Handle PROCESSOR_SKYLAKE,\n+\tPROCESSOR_CANNONLAKE.\n+\t(get_builtin_code_for_version): Fix priority for\n+\tPROCESSOR_ICELAKE_CLIENT, PROCESSOR_ICELAKE_SERVER,\n+\tPROCESSOR_SKYLAKE-AVX512.\n+\t* gcc/config/i386/i386.h (processor_costs): Define TARGET_SKYLAKE.\n+\t(processor_type): Add PROCESSOR_SKYLAKE.\n+\t\n 2018-04-16  Paolo Carlini  <paolo.carlini@oracle.com>\n \t    Jason Merrill  <jason@redhat.com>\n "}, {"sha": "787d8f40e4ad17bb37e8555d77e077f49c17e838", "filename": "gcc/config.gcc", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/176a3386885f99654139a2222144b57471a2aee6/gcc%2Fconfig.gcc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/176a3386885f99654139a2222144b57471a2aee6/gcc%2Fconfig.gcc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig.gcc?ref=176a3386885f99654139a2222144b57471a2aee6", "patch": "@@ -637,7 +637,7 @@ x86_64_archs=\"amdfam10 athlon64 athlon64-sse3 barcelona bdver1 bdver2 \\\n bdver3 bdver4 znver1 btver1 btver2 k8 k8-sse3 opteron opteron-sse3 nocona \\\n core2 corei7 corei7-avx core-avx-i core-avx2 atom slm nehalem westmere \\\n sandybridge ivybridge haswell broadwell bonnell silvermont knl knm \\\n-skylake-avx512 cannonlake icelake-client icelake-server x86-64 native\"\n+skylake-avx512 cannonlake icelake-client icelake-server skylake x86-64 native\"\n \n # Additional x86 processors supported by --with-cpu=.  Each processor\n # MUST be separated by exactly one space."}, {"sha": "2e0e9f66c9e65defbcebb2cfea8e3986e6063365", "filename": "gcc/config/i386/i386-c.c", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/176a3386885f99654139a2222144b57471a2aee6/gcc%2Fconfig%2Fi386%2Fi386-c.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/176a3386885f99654139a2222144b57471a2aee6/gcc%2Fconfig%2Fi386%2Fi386-c.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386-c.c?ref=176a3386885f99654139a2222144b57471a2aee6", "patch": "@@ -182,6 +182,10 @@ ix86_target_macros_internal (HOST_WIDE_INT isa_flag,\n       def_or_undef (parse_in, \"__knm\");\n       def_or_undef (parse_in, \"__knm__\");\n       break;\n+    case PROCESSOR_SKYLAKE:\n+      def_or_undef (parse_in, \"__skylake\");\n+      def_or_undef (parse_in, \"__skylake__\");\n+      break;\n     case PROCESSOR_SKYLAKE_AVX512:\n       def_or_undef (parse_in, \"__skylake_avx512\");\n       def_or_undef (parse_in, \"__skylake_avx512__\");\n@@ -313,6 +317,9 @@ ix86_target_macros_internal (HOST_WIDE_INT isa_flag,\n     case PROCESSOR_KNM:\n       def_or_undef (parse_in, \"__tune_knm__\");\n       break;\n+    case PROCESSOR_SKYLAKE:\n+      def_or_undef (parse_in, \"__tune_skylake__\");\n+      break;\n     case PROCESSOR_SKYLAKE_AVX512:\n       def_or_undef (parse_in, \"__tune_skylake_avx512__\");\n       break;"}, {"sha": "b62fdad992794584926548f8f11d5cd2c1a2500d", "filename": "gcc/config/i386/i386.c", "status": "modified", "additions": 19, "deletions": 13, "changes": 32, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/176a3386885f99654139a2222144b57471a2aee6/gcc%2Fconfig%2Fi386%2Fi386.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/176a3386885f99654139a2222144b57471a2aee6/gcc%2Fconfig%2Fi386%2Fi386.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386.c?ref=176a3386885f99654139a2222144b57471a2aee6", "patch": "@@ -144,6 +144,7 @@ const struct processor_costs *ix86_cost = NULL;\n #define m_SILVERMONT (HOST_WIDE_INT_1U<<PROCESSOR_SILVERMONT)\n #define m_KNL (HOST_WIDE_INT_1U<<PROCESSOR_KNL)\n #define m_KNM (HOST_WIDE_INT_1U<<PROCESSOR_KNM)\n+#define m_SKYLAKE (HOST_WIDE_INT_1U<<PROCESSOR_SKYLAKE)\n #define m_SKYLAKE_AVX512 (HOST_WIDE_INT_1U<<PROCESSOR_SKYLAKE_AVX512)\n #define m_CANNONLAKE (HOST_WIDE_INT_1U<<PROCESSOR_CANNONLAKE)\n #define m_ICELAKE_CLIENT (HOST_WIDE_INT_1U<<PROCESSOR_ICELAKE_CLIENT)\n@@ -859,6 +860,7 @@ static const struct ptt processor_target_table[PROCESSOR_max] =\n   {\"silvermont\", &slm_cost, 16, 15, 16, 7, 16},\n   {\"knl\", &slm_cost, 16, 15, 16, 7, 16},\n   {\"knm\", &slm_cost, 16, 15, 16, 7, 16},\n+  {\"skylake\", &skylake_cost, 16, 10, 16, 10, 16},\n   {\"skylake-avx512\", &skylake_cost, 16, 10, 16, 10, 16},\n   {\"cannonlake\", &skylake_cost, 16, 10, 16, 10, 16},\n   {\"icelake-client\", &skylake_cost, 16, 10, 16, 10, 16},\n@@ -3544,10 +3546,10 @@ ix86_option_override_internal (bool main_args_p,\n       {\"haswell\", PROCESSOR_HASWELL, CPU_HASWELL, PTA_HASWELL},\n       {\"core-avx2\", PROCESSOR_HASWELL, CPU_HASWELL, PTA_HASWELL},\n       {\"broadwell\", PROCESSOR_HASWELL, CPU_HASWELL, PTA_BROADWELL},\n-      {\"skylake\", PROCESSOR_HASWELL, CPU_HASWELL, PTA_SKYLAKE},\n+      {\"skylake\", PROCESSOR_SKYLAKE, CPU_HASWELL, PTA_SKYLAKE},\n       {\"skylake-avx512\", PROCESSOR_SKYLAKE_AVX512, CPU_HASWELL,\n         PTA_SKYLAKE_AVX512},\n-      {\"cannonlake\", PROCESSOR_SKYLAKE_AVX512, CPU_HASWELL, PTA_CANNONLAKE},\n+      {\"cannonlake\", PROCESSOR_CANNONLAKE, CPU_HASWELL, PTA_CANNONLAKE},\n       {\"icelake-client\", PROCESSOR_ICELAKE_CLIENT, CPU_HASWELL,\n \tPTA_ICELAKE_CLIENT},\n       {\"icelake-server\", PROCESSOR_ICELAKE_SERVER, CPU_HASWELL,\n@@ -32369,27 +32371,31 @@ get_builtin_code_for_version (tree decl, tree *predicate_list)\n \t      priority = P_PROC_AVX;\n \t      break;\n \t    case PROCESSOR_HASWELL:\n-\t    case PROCESSOR_SKYLAKE_AVX512:\n-\t      if (new_target->x_ix86_isa_flags\n-\t\t\t& OPTION_MASK_ISA_AVX512VBMI)\n-\t\targ_str = \"cannonlake\";\n-\t      else if (new_target->x_ix86_isa_flags & OPTION_MASK_ISA_AVX512VL)\n-\t        arg_str = \"skylake-avx512\";\n-\t      else if (new_target->x_ix86_isa_flags & OPTION_MASK_ISA_XSAVES)\n-\t        arg_str = \"skylake\";\n-\t      else if (new_target->x_ix86_isa_flags & OPTION_MASK_ISA_ADX)\n+\t      if (new_target->x_ix86_isa_flags & OPTION_MASK_ISA_ADX)\n \t\targ_str = \"broadwell\";\n \t      else\n \t\targ_str = \"haswell\";\n \t      priority = P_PROC_AVX2;\n \t      break;\n+\t    case PROCESSOR_SKYLAKE:\n+\t      arg_str = \"skylake\";\n+\t      priority = P_PROC_AVX2;\n+\t      break;\n+\t    case PROCESSOR_SKYLAKE_AVX512:\n+\t      arg_str = \"skylake-avx512\";\n+\t      priority = P_PROC_AVX512F;\n+\t      break;\n+\t    case PROCESSOR_CANNONLAKE:\n+\t      arg_str = \"cannonlake\";\n+\t      priority = P_PROC_AVX512F;\n+\t      break;\n \t    case PROCESSOR_ICELAKE_CLIENT:\n \t      arg_str = \"icelake-client\";\n-\t      priority = P_PROC_AVX2;\n+\t      priority = P_PROC_AVX512F;\n \t      break;\n \t    case PROCESSOR_ICELAKE_SERVER:\n \t      arg_str = \"icelake-server\";\n-\t      priority = P_PROC_AVX2;\n+\t      priority = P_PROC_AVX512F;\n \t      break;\n \t    case PROCESSOR_BONNELL:\n \t      arg_str = \"bonnell\";"}, {"sha": "c9f19b66dcad785c517604d840a0e5f6d83cb29a", "filename": "gcc/config/i386/i386.h", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/176a3386885f99654139a2222144b57471a2aee6/gcc%2Fconfig%2Fi386%2Fi386.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/176a3386885f99654139a2222144b57471a2aee6/gcc%2Fconfig%2Fi386%2Fi386.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386.h?ref=176a3386885f99654139a2222144b57471a2aee6", "patch": "@@ -385,6 +385,7 @@ extern const struct processor_costs ix86_size_cost;\n #define TARGET_SILVERMONT (ix86_tune == PROCESSOR_SILVERMONT)\n #define TARGET_KNL (ix86_tune == PROCESSOR_KNL)\n #define TARGET_KNM (ix86_tune == PROCESSOR_KNM)\n+#define TARGET_SKYLAKE (ix86_tune == PROCESSOR_SKYLAKE)\n #define TARGET_SKYLAKE_AVX512 (ix86_tune == PROCESSOR_SKYLAKE_AVX512)\n #define TARGET_CANNONLAKE (ix86_tune == PROCESSOR_CANNONLAKE)\n #define TARGET_ICELAKE_CLIENT (ix86_tune == PROCESSOR_ICELAKE_CLIENT)\n@@ -2267,6 +2268,7 @@ enum processor_type\n   PROCESSOR_SILVERMONT,\n   PROCESSOR_KNL,\n   PROCESSOR_KNM,\n+  PROCESSOR_SKYLAKE,\n   PROCESSOR_SKYLAKE_AVX512,\n   PROCESSOR_CANNONLAKE,\n   PROCESSOR_ICELAKE_CLIENT,"}, {"sha": "1aa8476339e3420596005db9b6fd58fc0549614e", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/176a3386885f99654139a2222144b57471a2aee6/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/176a3386885f99654139a2222144b57471a2aee6/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=176a3386885f99654139a2222144b57471a2aee6", "patch": "@@ -1,3 +1,8 @@\n+2018-04-16  Olga Makhotina  <olga.makhotina@intel.com>\n+\n+\tPR target/84331\n+\t* gcc/testsuite/gcc.target/i386/funcspec-56.inc: Test arch=skylake.\n+\n 2018-04-16  Paolo Carlini  <paolo.carlini@oracle.com>\n \t    Jason Merrill  <jason@redhat.com>\n "}, {"sha": "4636631d5f09ae58311cd0f202a31e212a858cf3", "filename": "gcc/testsuite/gcc.target/i386/funcspec-56.inc", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/176a3386885f99654139a2222144b57471a2aee6/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Ffuncspec-56.inc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/176a3386885f99654139a2222144b57471a2aee6/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Ffuncspec-56.inc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Ffuncspec-56.inc?ref=176a3386885f99654139a2222144b57471a2aee6", "patch": "@@ -143,6 +143,7 @@ extern void test_arch_corei7_avx (void)\t\t__attribute__((__target__(\"arch=corei7-\n extern void test_arch_core_avx2 (void)\t\t__attribute__((__target__(\"arch=core-avx2\")));\n extern void test_arch_knl (void)\t\t__attribute__((__target__(\"arch=knl\")));\n extern void test_arch_knm (void)\t\t__attribute__((__target__(\"arch=knm\")));\n+extern void test_arch_skylake (void)\t\t__attribute__((__target__(\"arch=skylake\")));\n extern void test_arch_skylake_avx512 (void)\t__attribute__((__target__(\"arch=skylake-avx512\")));\n extern void test_arch_cannonlake (void)\t\t__attribute__((__target__(\"arch=cannonlake\")));\n extern void test_arch_icelake_client (void)\t__attribute__((__target__(\"arch=icelake-client\")));"}]}