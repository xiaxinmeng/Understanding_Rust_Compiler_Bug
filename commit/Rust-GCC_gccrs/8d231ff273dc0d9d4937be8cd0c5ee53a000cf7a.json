{"sha": "8d231ff273dc0d9d4937be8cd0c5ee53a000cf7a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OGQyMzFmZjI3M2RjMGQ5ZDQ5MzdiZThjZDBjNWVlNTNhMDAwY2Y3YQ==", "commit": {"author": {"name": "Tobias Burnus", "email": "burnus@net-b.de", "date": "2011-06-05T21:11:46Z"}, "committer": {"name": "Tobias Burnus", "email": "burnus@gcc.gnu.org", "date": "2011-06-05T21:11:46Z"}, "message": "re PR fortran/49255 (-fcheck=pointer diagnoses too much: Passing NULL pointer to OPTIONAL argument)\n\n2011-06-05  Tobias Burnus  <burnus@net-b.de>\n\n        PR fortran/49255\n        * trans-expr.c (gfc_conv_procedure_call): Fix -fcheck=pointer\n        for F2008.\n\n2011-06-05  Tobias Burnus  <burnus@net-b.de>\n\n        PR fortran/49255\n        * gfortran.dg/pointer_check_9.f90: New.\n        * gfortran.dg/pointer_check_10.f90: New.\n\nFrom-SVN: r174663", "tree": {"sha": "8b459bf11bf34751da79a5ac42ef725dd5a22f4c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8b459bf11bf34751da79a5ac42ef725dd5a22f4c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8d231ff273dc0d9d4937be8cd0c5ee53a000cf7a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8d231ff273dc0d9d4937be8cd0c5ee53a000cf7a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8d231ff273dc0d9d4937be8cd0c5ee53a000cf7a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8d231ff273dc0d9d4937be8cd0c5ee53a000cf7a/comments", "author": {"login": "tob2", "id": 264461, "node_id": "MDQ6VXNlcjI2NDQ2MQ==", "avatar_url": "https://avatars.githubusercontent.com/u/264461?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tob2", "html_url": "https://github.com/tob2", "followers_url": "https://api.github.com/users/tob2/followers", "following_url": "https://api.github.com/users/tob2/following{/other_user}", "gists_url": "https://api.github.com/users/tob2/gists{/gist_id}", "starred_url": "https://api.github.com/users/tob2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tob2/subscriptions", "organizations_url": "https://api.github.com/users/tob2/orgs", "repos_url": "https://api.github.com/users/tob2/repos", "events_url": "https://api.github.com/users/tob2/events{/privacy}", "received_events_url": "https://api.github.com/users/tob2/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "e8f79869d7d78364931e69665b9c8f876fa1bb73", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e8f79869d7d78364931e69665b9c8f876fa1bb73", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e8f79869d7d78364931e69665b9c8f876fa1bb73"}], "stats": {"total": 49, "additions": 49, "deletions": 0}, "files": [{"sha": "af16e578341246a7eed528330a96ba40d4815229", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8d231ff273dc0d9d4937be8cd0c5ee53a000cf7a/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8d231ff273dc0d9d4937be8cd0c5ee53a000cf7a/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=8d231ff273dc0d9d4937be8cd0c5ee53a000cf7a", "patch": "@@ -1,3 +1,9 @@\n+2011-06-05  Tobias Burnus  <burnus@net-b.de>\n+\n+\tPR fortran/49255\n+\t* trans-expr.c (gfc_conv_procedure_call): Fix -fcheck=pointer\n+\tfor F2008.\n+\n 2011-06-05  Andreas Schmidt  <andreas.schmidt.42@gmx.net>\n \tThomas Koenig  <tkoenig@gcc.gnu.org>\n "}, {"sha": "da4af1ae28d3a0f6e648878c665c0f6ddefc3cfd", "filename": "gcc/fortran/trans-expr.c", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8d231ff273dc0d9d4937be8cd0c5ee53a000cf7a/gcc%2Ffortran%2Ftrans-expr.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8d231ff273dc0d9d4937be8cd0c5ee53a000cf7a/gcc%2Ffortran%2Ftrans-expr.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-expr.c?ref=8d231ff273dc0d9d4937be8cd0c5ee53a000cf7a", "patch": "@@ -3269,6 +3269,12 @@ gfc_conv_procedure_call (gfc_se * se, gfc_symbol * sym,\n \t  else\n \t    goto end_pointer_check;\n \n+\t  /*  In Fortran 2008 it's allowed to pass a NULL pointer/nonallocated\n+\t      allocatable to an optional dummy, cf. 12.5.2.12.  */\n+\t  if (fsym != NULL && fsym->attr.optional && !attr.proc_pointer\n+\t      && (gfc_option.allow_std & GFC_STD_F2008) != 0)\n+\t    goto end_pointer_check;\n+\n           if (attr.optional)\n \t    {\n               /* If the actual argument is an optional pointer/allocatable and"}, {"sha": "9973272542130a912cb4ec2b2639cba4b97f405b", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8d231ff273dc0d9d4937be8cd0c5ee53a000cf7a/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8d231ff273dc0d9d4937be8cd0c5ee53a000cf7a/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=8d231ff273dc0d9d4937be8cd0c5ee53a000cf7a", "patch": "@@ -1,3 +1,9 @@\n+2011-06-05  Tobias Burnus  <burnus@net-b.de>\n+\n+\tPR fortran/49255\n+\t* trans-expr.c (gfc_conv_procedure_call): Fix -fcheck=pointer\n+\tfor F2008.\n+\n 2011-06-05  Nicola Pero  <nicola.pero@meta-innovation.com>\n \n \tPR testsuite/49287"}, {"sha": "642f0a08b219199dc2baf6eb17f04226fe4844c9", "filename": "gcc/testsuite/gfortran.dg/pointer_check_10.f90", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8d231ff273dc0d9d4937be8cd0c5ee53a000cf7a/gcc%2Ftestsuite%2Fgfortran.dg%2Fpointer_check_10.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8d231ff273dc0d9d4937be8cd0c5ee53a000cf7a/gcc%2Ftestsuite%2Fgfortran.dg%2Fpointer_check_10.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpointer_check_10.f90?ref=8d231ff273dc0d9d4937be8cd0c5ee53a000cf7a", "patch": "@@ -0,0 +1,16 @@\n+! { dg-do run }\n+! { dg-options \"-fcheck=all -std=f2003 -fall-intrinsics\" }\n+! { dg-shouldfail \"Pointer actual argument 'ptr' is not associated\" }\n+!\n+! PR fortran/49255\n+!\n+! Valid F2008, invalid F95/F2003.\n+!\n+integer,pointer :: ptr => null()\n+call foo (ptr)\n+contains\n+  subroutine foo (x)\n+    integer, optional :: x\n+    if (present (x)) call abort ()\n+  end subroutine foo\n+end"}, {"sha": "d42ba64d78b33e833ffc7cb593dfd1b04f8865c8", "filename": "gcc/testsuite/gfortran.dg/pointer_check_9.f90", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8d231ff273dc0d9d4937be8cd0c5ee53a000cf7a/gcc%2Ftestsuite%2Fgfortran.dg%2Fpointer_check_9.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8d231ff273dc0d9d4937be8cd0c5ee53a000cf7a/gcc%2Ftestsuite%2Fgfortran.dg%2Fpointer_check_9.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpointer_check_9.f90?ref=8d231ff273dc0d9d4937be8cd0c5ee53a000cf7a", "patch": "@@ -0,0 +1,15 @@\n+! { dg-do run }\n+! { dg-options \"-fcheck=all -std=f2008 -fall-intrinsics\" }\n+!\n+! PR fortran/49255\n+!\n+! Valid F2008, invalid F95/F2003.\n+!\n+integer,pointer :: ptr => null()\n+call foo (ptr)\n+contains\n+  subroutine foo (x)\n+    integer, optional :: x\n+    if (present (x)) call abort ()\n+  end subroutine foo\n+end"}]}