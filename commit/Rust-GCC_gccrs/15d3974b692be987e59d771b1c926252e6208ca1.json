{"sha": "15d3974b692be987e59d771b1c926252e6208ca1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTVkMzk3NGI2OTJiZTk4N2U1OWQ3NzFiMWM5MjYyNTJlNjIwOGNhMQ==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2018-02-28T18:38:19Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2018-02-28T18:38:19Z"}, "message": "gimple-ssa-warn-restrict.c (maybe_diag_overlap): Use warning_n instead of warning_at with conditional singular and plural...\n\n\t* gimple-ssa-warn-restrict.c (maybe_diag_overlap): Use warning_n\n\tinstead of warning_at with conditional singular and plural messages\n\twhere possible.\n\nFrom-SVN: r258078", "tree": {"sha": "eca3683b703e6f83abacf8530de8b9b247909c11", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/eca3683b703e6f83abacf8530de8b9b247909c11"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/15d3974b692be987e59d771b1c926252e6208ca1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/15d3974b692be987e59d771b1c926252e6208ca1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/15d3974b692be987e59d771b1c926252e6208ca1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/15d3974b692be987e59d771b1c926252e6208ca1/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "be583c04a448ef4e97065fd0f5b7f6c5e40e41fb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/be583c04a448ef4e97065fd0f5b7f6c5e40e41fb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/be583c04a448ef4e97065fd0f5b7f6c5e40e41fb"}], "stats": {"total": 176, "additions": 84, "deletions": 92}, "files": [{"sha": "c80f71a1de0b1342f9e3d46874b424a6adfa23bf", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/15d3974b692be987e59d771b1c926252e6208ca1/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/15d3974b692be987e59d771b1c926252e6208ca1/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=15d3974b692be987e59d771b1c926252e6208ca1", "patch": "@@ -1,5 +1,9 @@\n 2018-02-28  Jakub Jelinek  <jakub@redhat.com>\n \n+\t* gimple-ssa-warn-restrict.c (maybe_diag_overlap): Use warning_n\n+\tinstead of warning_at with conditional singular and plural messages\n+\twhere possible.\n+\n \tPR target/52991\n \t* stor-layout.c (update_alignment_for_field): For\n \ttargetm.ms_bitfield_layout_p (rli->t), if !is_bitfield"}, {"sha": "df775062758fcd355f96afac8e433266120a5629", "filename": "gcc/gimple-ssa-warn-restrict.c", "status": "modified", "additions": 80, "deletions": 92, "changes": 172, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/15d3974b692be987e59d771b1c926252e6208ca1/gcc%2Fgimple-ssa-warn-restrict.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/15d3974b692be987e59d771b1c926252e6208ca1/gcc%2Fgimple-ssa-warn-restrict.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgimple-ssa-warn-restrict.c?ref=15d3974b692be987e59d771b1c926252e6208ca1", "patch": "@@ -1399,42 +1399,38 @@ maybe_diag_overlap (location_t loc, gcall *call, builtin_access &acs)\n \t\t\tcall, func, sizrange[0],\n \t\t\toffstr[0], offstr[1], ovlsiz[0], offstr[2]);\n \t  else if (ovlsiz[1] >= 0 && ovlsiz[1] < maxobjsize.to_shwi ())\n-\t    warning_at (loc, OPT_Wrestrict,\n-\t\t\tsizrange[0] == 1\n-\t\t\t? G_(\"%G%qD accessing %wu byte at offsets %s \"\n-\t\t\t     \"and %s overlaps between %wu and %wu bytes \"\n-\t\t\t     \"at offset %s\")\n-\t\t\t: G_(\"%G%qD accessing %wu bytes at offsets %s \"\n-\t\t\t     \"and %s overlaps between %wu and %wu bytes \"\n-\t\t\t     \"at offset %s\"),\n-\t\t\tcall, func, sizrange[0],\n-\t\t\toffstr[0], offstr[1], ovlsiz[0], ovlsiz[1],\n-\t\t\toffstr[2]);\n+\t    warning_n (loc, OPT_Wrestrict, sizrange[0],\n+\t\t       \"%G%qD accessing %wu byte at offsets %s \"\n+\t\t       \"and %s overlaps between %wu and %wu bytes \"\n+\t\t       \"at offset %s\",\n+\t\t       \"%G%qD accessing %wu bytes at offsets %s \"\n+\t\t       \"and %s overlaps between %wu and %wu bytes \"\n+\t\t       \"at offset %s\",\n+\t\t       call, func, sizrange[0], offstr[0], offstr[1],\n+\t\t       ovlsiz[0], ovlsiz[1], offstr[2]);\n \t  else\n-\t    warning_at (loc, OPT_Wrestrict,\n-\t\t\tsizrange[0] == 1\n-\t\t\t? G_(\"%G%qD accessing %wu byte at offsets %s and \"\n-\t\t\t     \"%s overlaps %wu or more bytes at offset %s\")\n-\t\t\t: G_(\"%G%qD accessing %wu bytes at offsets %s and \"\n-\t\t\t     \"%s overlaps %wu or more bytes at offset %s\"),\n-\t\t\tcall, func, sizrange[0],\n-\t\t\toffstr[0], offstr[1], ovlsiz[0], offstr[2]);\n+\t    warning_n (loc, OPT_Wrestrict, sizrange[0],\n+\t\t       \"%G%qD accessing %wu byte at offsets %s and \"\n+\t\t       \"%s overlaps %wu or more bytes at offset %s\",\n+\t\t       \"%G%qD accessing %wu bytes at offsets %s and \"\n+\t\t       \"%s overlaps %wu or more bytes at offset %s\",\n+\t\t       call, func, sizrange[0],\n+\t\t       offstr[0], offstr[1], ovlsiz[0], offstr[2]);\n \t  return true;\n \t}\n \n       if (sizrange[1] >= 0 && sizrange[1] < maxobjsize.to_shwi ())\n \t{\n \t  if (ovlsiz[0] == ovlsiz[1])\n-\t    warning_at (loc, OPT_Wrestrict,\n-\t\t\tovlsiz[0] == 1\n-\t\t\t? G_(\"%G%qD accessing between %wu and %wu bytes \"\n-\t\t\t     \"at offsets %s and %s overlaps %wu byte at \"\n-\t\t\t     \"offset %s\")\n-\t\t\t: G_(\"%G%qD accessing between %wu and %wu bytes \"\n-\t\t\t     \"at offsets %s and %s overlaps %wu bytes \"\n-\t\t\t     \"at offset %s\"),\n-\t\t\tcall, func, sizrange[0], sizrange[1],\n-\t\t\toffstr[0], offstr[1], ovlsiz[0], offstr[2]);\n+\t    warning_n (loc, OPT_Wrestrict, ovlsiz[0],\n+\t\t       \"%G%qD accessing between %wu and %wu bytes \"\n+\t\t       \"at offsets %s and %s overlaps %wu byte at \"\n+\t\t       \"offset %s\",\n+\t\t       \"%G%qD accessing between %wu and %wu bytes \"\n+\t\t       \"at offsets %s and %s overlaps %wu bytes \"\n+\t\t       \"at offset %s\",\n+\t\t       call, func, sizrange[0], sizrange[1],\n+\t\t       offstr[0], offstr[1], ovlsiz[0], offstr[2]);\n \t  else if (ovlsiz[1] >= 0 && ovlsiz[1] < maxobjsize.to_shwi ())\n \t    warning_at (loc, OPT_Wrestrict,\n \t\t\t\"%G%qD accessing between %wu and %wu bytes at \"\n@@ -1457,14 +1453,13 @@ maybe_diag_overlap (location_t loc, gcall *call, builtin_access &acs)\n \tovlsiz[1] = maxobjsize.to_shwi ();\n \n       if (ovlsiz[0] == ovlsiz[1])\n-\twarning_at (loc, OPT_Wrestrict,\n-\t\t    ovlsiz[0] == 1\n-\t\t    ? G_(\"%G%qD accessing %wu or more bytes at offsets \"\n-\t\t\t \"%s and %s overlaps %wu byte at offset %s\")\n-\t\t    :  G_(\"%G%qD accessing %wu or more bytes at offsets \"\n-\t\t\t  \"%s and %s overlaps %wu bytes at offset %s\"),\n-\t\t    call, func, sizrange[0], offstr[0], offstr[1],\n-\t\t    ovlsiz[0], offstr[2]);\n+\twarning_n (loc, OPT_Wrestrict, ovlsiz[0],\n+\t\t   \"%G%qD accessing %wu or more bytes at offsets \"\n+\t\t   \"%s and %s overlaps %wu byte at offset %s\",\n+\t\t   \"%G%qD accessing %wu or more bytes at offsets \"\n+\t\t   \"%s and %s overlaps %wu bytes at offset %s\",\n+\t\t   call, func, sizrange[0], offstr[0], offstr[1],\n+\t\t   ovlsiz[0], offstr[2]);\n       else if (ovlsiz[1] >= 0 && ovlsiz[1] < maxobjsize.to_shwi ())\n \twarning_at (loc, OPT_Wrestrict,\n \t\t    \"%G%qD accessing %wu or more bytes at offsets %s \"\n@@ -1501,77 +1496,70 @@ maybe_diag_overlap (location_t loc, gcall *call, builtin_access &acs)\n       if (ovlsiz[1] == 1)\n \t{\n \t  if (open_range)\n-\t    warning_at (loc, OPT_Wrestrict,\n-\t\t\tsizrange[1] == 1\n-\t\t\t? G_(\"%G%qD accessing %wu byte may overlap \"\n-\t\t\t     \"%wu byte\")\n-\t\t\t: G_(\"%G%qD accessing %wu bytes may overlap \"\n-\t\t\t     \"%wu byte\"),\n-\t\t\tcall, func, sizrange[1], ovlsiz[1]);\n+\t    warning_n (loc, OPT_Wrestrict, sizrange[1],\n+\t\t       \"%G%qD accessing %wu byte may overlap \"\n+\t\t       \"%wu byte\",\n+\t\t       \"%G%qD accessing %wu bytes may overlap \"\n+\t\t       \"%wu byte\",\n+\t\t       call, func, sizrange[1], ovlsiz[1]);\n \t  else\n-\t    warning_at (loc, OPT_Wrestrict,\n-\t\t\tsizrange[1] == 1\n-\t\t\t? G_(\"%G%qD accessing %wu byte at offsets %s \"\n-\t\t\t     \"and %s may overlap %wu byte at offset %s\")\n-\t\t\t: G_(\"%G%qD accessing %wu bytes at offsets %s \"\n-\t\t\t     \"and %s may overlap %wu byte at offset %s\"),\n-\t\t\tcall, func, sizrange[1], offstr[0], offstr[1],\n-\t\t\tovlsiz[1], offstr[2]);\n+\t    warning_n (loc, OPT_Wrestrict, sizrange[1],\n+\t\t       \"%G%qD accessing %wu byte at offsets %s \"\n+\t\t       \"and %s may overlap %wu byte at offset %s\",\n+\t\t       \"%G%qD accessing %wu bytes at offsets %s \"\n+\t\t       \"and %s may overlap %wu byte at offset %s\",\n+\t\t       call, func, sizrange[1], offstr[0], offstr[1],\n+\t\t       ovlsiz[1], offstr[2]);\n \t  return true;\n \t}\n \n       if (open_range)\n-\twarning_at (loc, OPT_Wrestrict,\n-\t\t    sizrange[1] == 1\n-\t\t    ? G_(\"%G%qD accessing %wu byte may overlap \"\n-\t\t\t \"up to %wu bytes\")\n-\t\t    : G_(\"%G%qD accessing %wu bytes may overlap \"\n-\t\t\t \"up to %wu bytes\"),\n-\t\t    call, func, sizrange[1], ovlsiz[1]);\n+\twarning_n (loc, OPT_Wrestrict, sizrange[1],\n+\t\t   \"%G%qD accessing %wu byte may overlap \"\n+\t\t   \"up to %wu bytes\",\n+\t\t   \"%G%qD accessing %wu bytes may overlap \"\n+\t\t   \"up to %wu bytes\",\n+\t\t   call, func, sizrange[1], ovlsiz[1]);\n       else\n-\twarning_at (loc, OPT_Wrestrict,\n-\t\t    sizrange[1] == 1\n-\t\t    ? G_(\"%G%qD accessing %wu byte at offsets %s and \"\n-\t\t\t \"%s may overlap up to %wu bytes at offset %s\")\n-\t\t    : G_(\"%G%qD accessing %wu bytes at offsets %s and \"\n-\t\t\t \"%s may overlap up to %wu bytes at offset %s\"),\n-\t\t    call, func, sizrange[1], offstr[0], offstr[1],\n-\t\t    ovlsiz[1], offstr[2]);\n+\twarning_n (loc, OPT_Wrestrict, sizrange[1],\n+\t\t   \"%G%qD accessing %wu byte at offsets %s and \"\n+\t\t   \"%s may overlap up to %wu bytes at offset %s\",\n+\t\t   \"%G%qD accessing %wu bytes at offsets %s and \"\n+\t\t   \"%s may overlap up to %wu bytes at offset %s\",\n+\t\t   call, func, sizrange[1], offstr[0], offstr[1],\n+\t\t   ovlsiz[1], offstr[2]);\n       return true;\n     }\n \n   if (sizrange[1] >= 0 && sizrange[1] < maxobjsize.to_shwi ())\n     {\n       if (open_range)\n-\twarning_at (loc, OPT_Wrestrict,\n-\t\t    ovlsiz[1] == 1\n-\t\t    ? G_(\"%G%qD accessing between %wu and %wu bytes \"\n-\t\t\t \"may overlap %wu byte\")\n-\t\t    : G_(\"%G%qD accessing between %wu and %wu bytes \"\n-\t\t\t \"may overlap up to %wu bytes\"),\n-\t\t    call, func, sizrange[0], sizrange[1], ovlsiz[1]);\n+\twarning_n (loc, OPT_Wrestrict, ovlsiz[1],\n+\t\t   \"%G%qD accessing between %wu and %wu bytes \"\n+\t\t   \"may overlap %wu byte\",\n+\t\t   \"%G%qD accessing between %wu and %wu bytes \"\n+\t\t   \"may overlap up to %wu bytes\",\n+\t\t   call, func, sizrange[0], sizrange[1], ovlsiz[1]);\n       else\n-\twarning_at (loc, OPT_Wrestrict,\n-\t\t    ovlsiz[1] == 1\n-\t\t    ? G_(\"%G%qD accessing between %wu and %wu bytes \"\n-\t\t\t \"at offsets %s and %s may overlap %wu byte \"\n-\t\t\t \"at offset %s\")\n-\t\t    : G_(\"%G%qD accessing between %wu and %wu bytes \"\n-\t\t\t \"at offsets %s and %s may overlap up to %wu \"\n-\t\t\t \"bytes at offset %s\"),\n-\t\t    call, func, sizrange[0], sizrange[1],\n-\t\t    offstr[0], offstr[1], ovlsiz[1], offstr[2]);\n+\twarning_n (loc, OPT_Wrestrict, ovlsiz[1],\n+\t\t   \"%G%qD accessing between %wu and %wu bytes \"\n+\t\t   \"at offsets %s and %s may overlap %wu byte \"\n+\t\t   \"at offset %s\",\n+\t\t   \"%G%qD accessing between %wu and %wu bytes \"\n+\t\t   \"at offsets %s and %s may overlap up to %wu \"\n+\t\t   \"bytes at offset %s\",\n+\t\t   call, func, sizrange[0], sizrange[1],\n+\t\t   offstr[0], offstr[1], ovlsiz[1], offstr[2]);\n       return true;\n     }\n \n-  warning_at (loc, OPT_Wrestrict,\n-\t      ovlsiz[1] == 1\n-\t      ? G_(\"%G%qD accessing %wu or more bytes at offsets %s \"\n-\t\t   \"and %s may overlap %wu byte at offset %s\")\n-\t      : G_(\"%G%qD accessing %wu or more bytes at offsets %s \"\n-\t\t   \"and %s may overlap up to %wu bytes at offset %s\"),\n-\t      call, func, sizrange[0], offstr[0], offstr[1],\n-\t      ovlsiz[1], offstr[2]);\n+  warning_n (loc, OPT_Wrestrict, ovlsiz[1],\n+\t     \"%G%qD accessing %wu or more bytes at offsets %s \"\n+\t     \"and %s may overlap %wu byte at offset %s\",\n+\t     \"%G%qD accessing %wu or more bytes at offsets %s \"\n+\t     \"and %s may overlap up to %wu bytes at offset %s\",\n+\t     call, func, sizrange[0], offstr[0], offstr[1],\n+\t     ovlsiz[1], offstr[2]);\n \n   return true;\n }"}]}