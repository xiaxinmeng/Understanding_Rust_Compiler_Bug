{"sha": "a207780f9b958e8cf857858a658dbe9db6b68347", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTIwNzc4MGY5Yjk1OGU4Y2Y4NTc4NThhNjU4ZGJlOWRiNmI2ODM0Nw==", "commit": {"author": {"name": "Volker Reichelt", "email": "reichelt@igpm.rwth-aachen.de", "date": "2005-07-12T16:07:38Z"}, "committer": {"name": "Nathan Sidwell", "email": "nathan@gcc.gnu.org", "date": "2005-07-12T16:07:38Z"}, "message": "re PR c++/20172 (Invalid non-type template parameters not diagnosed)\n\ncp:\n\tPR c++/20172\n\t* pt.c (tsubst_template_parms): Check for invalid non-type\n\tparameters.\ntestsuite:\n\tPR c++/20172\n\t* g++.dg/template/nontype12.C : New test.\n\nCo-Authored-By: Nathan Sidwell <nathan@codesourcery.com>\n\nFrom-SVN: r101928", "tree": {"sha": "47a081bcd8d674465343a3cedc9e1de828548dc5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/47a081bcd8d674465343a3cedc9e1de828548dc5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a207780f9b958e8cf857858a658dbe9db6b68347", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a207780f9b958e8cf857858a658dbe9db6b68347", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a207780f9b958e8cf857858a658dbe9db6b68347", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a207780f9b958e8cf857858a658dbe9db6b68347/comments", "author": null, "committer": null, "parents": [{"sha": "cac50d9410d1c110fdaacaecfaef840e3c42e1a5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cac50d9410d1c110fdaacaecfaef840e3c42e1a5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cac50d9410d1c110fdaacaecfaef840e3c42e1a5"}], "stats": {"total": 50, "additions": 50, "deletions": 0}, "files": [{"sha": "80a28022417d62f2c0c593671f7f02a1aef655fa", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a207780f9b958e8cf857858a658dbe9db6b68347/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a207780f9b958e8cf857858a658dbe9db6b68347/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=a207780f9b958e8cf857858a658dbe9db6b68347", "patch": "@@ -1,3 +1,10 @@\n+2005-07-12  Volker Reichelt  <reichelt@igpm.rwth-aachen.de>\n+\t    Nathan Sidwell  <nathan@codesourcery.com>\n+\n+\tPR c++/20172\n+\t* pt.c (tsubst_template_parms): Check for invalid non-type\n+\tparameters.\n+\n 2005-07-09  Andrew Pinski  <pinskia@physics.uc.edu>\n \n \t* cp-lang.c (shadowed_var_for_decl, decl_shadowed_for_var_lookup,"}, {"sha": "bbf3bf9bb34eefd9d52136b01cb953d5c20ef0ec", "filename": "gcc/cp/pt.c", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a207780f9b958e8cf857858a658dbe9db6b68347/gcc%2Fcp%2Fpt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a207780f9b958e8cf857858a658dbe9db6b68347/gcc%2Fcp%2Fpt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fpt.c?ref=a207780f9b958e8cf857858a658dbe9db6b68347", "patch": "@@ -5987,6 +5987,9 @@ tsubst_template_parms (tree parms, tree args, tsubst_flags_t complain)\n \t  tree parm_decl = TREE_VALUE (tuple);\n \n \t  parm_decl = tsubst (parm_decl, args, complain, NULL_TREE);\n+\t  if (TREE_CODE (parm_decl) == PARM_DECL\n+\t      && invalid_nontype_parm_type_p (TREE_TYPE (parm_decl), complain))\n+\t    parm_decl = error_mark_node;\n \t  default_value = tsubst_template_arg (default_value, args,\n \t\t\t\t\t       complain, NULL_TREE);\n "}, {"sha": "6502977bb18b9a17e65f11851ad41917ac89ed30", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a207780f9b958e8cf857858a658dbe9db6b68347/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a207780f9b958e8cf857858a658dbe9db6b68347/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=a207780f9b958e8cf857858a658dbe9db6b68347", "patch": "@@ -1,3 +1,8 @@\n+2005-07-12  Volker Reichelt  <reichelt@igpm.rwth-aachen.de>\n+\n+\tPR c++/20172\n+\t* g++.dg/template/nontype12.C : New test.\n+\n 2005-07-12  Zdenek Dvorak  <dvorakz@suse.cz>\n \n \t* gcc.dg/tree-ssa/loop-10.c: New test."}, {"sha": "0200e870b956f0a170e9478a1dd8c09738aba228", "filename": "gcc/testsuite/g++.dg/template/nontype12.C", "status": "added", "additions": 35, "deletions": 0, "changes": 35, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a207780f9b958e8cf857858a658dbe9db6b68347/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fnontype12.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a207780f9b958e8cf857858a658dbe9db6b68347/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fnontype12.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fnontype12.C?ref=a207780f9b958e8cf857858a658dbe9db6b68347", "patch": "@@ -0,0 +1,35 @@\n+// PR c++/20172\n+// Origin: Volker Reichelt <reichelt@igpm.rwth-aachen.de>\n+\n+template<typename T> struct A\n+{\n+  template<T> int foo();                        // { dg-error \"double\" }\n+  template<template<T> class> int bar();        // { dg-error \"double\" }\n+  template<T> struct X;                         // { dg-error \"double\" }\n+};\n+\n+A<char>   a1;\n+A<double> a2;                                   // { dg-error \"instantiated\" }\n+\n+template<typename T> struct B\n+{\n+  template<double> int foo();                   // { dg-error \"double\" }\n+  template<template<double> class> int bar();   // { dg-error \"double\" }\n+  template<double> struct X;                    // { dg-error \"double\" }\n+};\n+\n+template<void> int foo();                       // { dg-error \"void\" }\n+template<template<void> class> int bar();       // { dg-error \"void\" }\n+template<void> struct X;                        // { dg-error \"void\" }\n+\n+template<typename T> struct C\n+{\n+  template<T> int foo();                        // { dg-error \"double\" }\n+};\n+\n+template<typename T> int baz(T) { C<T> c; }     // { dg-error \"instantiated\" }\n+\n+void foobar()\n+{\n+  baz(1.2);                                     // { dg-error \"instantiated\" }\n+}"}]}