{"sha": "5f546e16b7ebff030c8d8f933b99378ce2a271c8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NWY1NDZlMTZiN2ViZmYwMzBjOGQ4ZjkzM2I5OTM3OGNlMmEyNzFjOA==", "commit": {"author": {"name": "Paolo Carlini", "email": "paolo.carlini@oracle.com", "date": "2013-10-29T15:20:10Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2013-10-29T15:20:10Z"}, "message": "re PR c++/58888 ([c++11] Rejects-valid: static member with auto and initializer)\n\n/cp\n2013-10-29  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/58888\n\t* decl2.c (grokfield): Handle auto like NSDMI.\n\n/testsuite\n2013-10-29  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/58888\n\t* g++.dg/cpp0x/auto40.C: New.\n\t* g++.dg/other/warning1.C: Adjust.\n\nFrom-SVN: r204164", "tree": {"sha": "5b4ea0b9c44c8b813d9b7d20214ee330daa029f2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5b4ea0b9c44c8b813d9b7d20214ee330daa029f2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5f546e16b7ebff030c8d8f933b99378ce2a271c8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5f546e16b7ebff030c8d8f933b99378ce2a271c8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5f546e16b7ebff030c8d8f933b99378ce2a271c8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5f546e16b7ebff030c8d8f933b99378ce2a271c8/comments", "author": null, "committer": null, "parents": [{"sha": "72a6cdded16108660cf4fd20b9195004768a4a5a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/72a6cdded16108660cf4fd20b9195004768a4a5a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/72a6cdded16108660cf4fd20b9195004768a4a5a"}], "stats": {"total": 46, "additions": 24, "deletions": 22}, "files": [{"sha": "99f14e0ce8098601329fd871e12a03734e583778", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5f546e16b7ebff030c8d8f933b99378ce2a271c8/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5f546e16b7ebff030c8d8f933b99378ce2a271c8/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=5f546e16b7ebff030c8d8f933b99378ce2a271c8", "patch": "@@ -1,3 +1,8 @@\n+2013-10-29  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/58888\n+\t* decl2.c (grokfield): Handle auto like NSDMI.\n+\n 2013-10-25  Paolo Carlini  <paolo.carlini@oracle.com>\n \n \tPR c++/58878"}, {"sha": "266884952569a0abe0f078ffa87f7034fb5c4d94", "filename": "gcc/cp/decl2.c", "status": "modified", "additions": 0, "deletions": 20, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5f546e16b7ebff030c8d8f933b99378ce2a271c8/gcc%2Fcp%2Fdecl2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5f546e16b7ebff030c8d8f933b99378ce2a271c8/gcc%2Fcp%2Fdecl2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl2.c?ref=5f546e16b7ebff030c8d8f933b99378ce2a271c8", "patch": "@@ -955,26 +955,6 @@ grokfield (const cp_declarator *declarator,\n \t/* C++11 NSDMI, keep going.  */;\n       else if (!VAR_P (value))\n \tgcc_unreachable ();\n-      else if (!processing_template_decl)\n-\t{\n-\t  if (TREE_CODE (init) == CONSTRUCTOR)\n-\t    init = digest_init (TREE_TYPE (value), init, tf_warning_or_error);\n-\t  init = maybe_constant_init (init);\n-\n-\t  if (init != error_mark_node && !TREE_CONSTANT (init))\n-\t    {\n-\t      /* We can allow references to things that are effectively\n-\t\t static, since references are initialized with the\n-\t\t address.  */\n-\t      if (TREE_CODE (TREE_TYPE (value)) != REFERENCE_TYPE\n-\t\t  || (TREE_STATIC (init) == 0\n-\t\t      && (!DECL_P (init) || DECL_EXTERNAL (init) == 0)))\n-\t\t{\n-\t\t  error (\"field initializer is not constant\");\n-\t\t  init = error_mark_node;\n-\t\t}\n-\t    }\n-\t}\n     }\n \n   if (processing_template_decl && VAR_OR_FUNCTION_DECL_P (value))"}, {"sha": "357939e9dd4ba6f799e6259ff8d3798f75e32364", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5f546e16b7ebff030c8d8f933b99378ce2a271c8/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5f546e16b7ebff030c8d8f933b99378ce2a271c8/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=5f546e16b7ebff030c8d8f933b99378ce2a271c8", "patch": "@@ -1,3 +1,9 @@\n+2013-10-29  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/58888\n+\t* g++.dg/cpp0x/auto40.C: New.\n+\t* g++.dg/other/warning1.C: Adjust.\n+\n 2013-10-29  Richard Biener  <rguenther@suse.de>\n \n \t* gcc.dg/torture/restrict-2.c: New testcase."}, {"sha": "287191e591047c429859f7399a1657415a0eb47d", "filename": "gcc/testsuite/g++.dg/cpp0x/auto40.C", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5f546e16b7ebff030c8d8f933b99378ce2a271c8/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fauto40.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5f546e16b7ebff030c8d8f933b99378ce2a271c8/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fauto40.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fauto40.C?ref=5f546e16b7ebff030c8d8f933b99378ce2a271c8", "patch": "@@ -0,0 +1,11 @@\n+// PR c++/58888\n+// { dg-do compile { target c++11 } }\n+\n+#include <initializer_list>\n+\n+struct A\n+{\n+  static constexpr auto b{1.0};\n+};\n+\n+constexpr decltype(A::b) A::b;"}, {"sha": "a23d0ca6cba561c95f7be9c864d61630871bf25f", "filename": "gcc/testsuite/g++.dg/other/warning1.C", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5f546e16b7ebff030c8d8f933b99378ce2a271c8/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fwarning1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5f546e16b7ebff030c8d8f933b99378ce2a271c8/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fwarning1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fwarning1.C?ref=5f546e16b7ebff030c8d8f933b99378ce2a271c8", "patch": "@@ -7,8 +7,8 @@ extern \"C\" int printf(const char *, ...);\n \n struct S\n {\n-  static const float inf = 1.0f / 0.0f; // { dg-warning \"1.0|float|initializ\" }\n-  static const float nan = 0.0f / 0.0f; // { dg-warning \"0.0|float|initializ\" }\n+  static const float inf = 1.0f / 0.0f; // { dg-error \"1.0|float|initializ\" }\n+  static const float nan = 0.0f / 0.0f; // { dg-error \"0.0|float|initializ\" }\n };\n \n int main()"}]}