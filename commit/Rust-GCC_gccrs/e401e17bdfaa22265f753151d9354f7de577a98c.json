{"sha": "e401e17bdfaa22265f753151d9354f7de577a98c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTQwMWUxN2JkZmFhMjIyNjVmNzUzMTUxZDkzNTRmN2RlNTc3YTk4Yw==", "commit": {"author": {"name": "Thomas Quinot", "email": "quinot@adacore.com", "date": "2008-05-23T13:29:02Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2008-05-23T13:29:02Z"}, "message": "2008-05-23  Thomas Quinot  <quinot@adacore.com>\n\n\t* s-os_lib.adb:\n\t(copy_File): Do not open destination file if source file is unreadable.\n\nFrom-SVN: r135805", "tree": {"sha": "854259bd976214ac710b93b279badb63f5dcc42e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/854259bd976214ac710b93b279badb63f5dcc42e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e401e17bdfaa22265f753151d9354f7de577a98c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e401e17bdfaa22265f753151d9354f7de577a98c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e401e17bdfaa22265f753151d9354f7de577a98c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e401e17bdfaa22265f753151d9354f7de577a98c/comments", "author": null, "committer": null, "parents": [{"sha": "d313a1b6bc336a4061de1c19e9903daa125a6561", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d313a1b6bc336a4061de1c19e9903daa125a6561", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d313a1b6bc336a4061de1c19e9903daa125a6561"}], "stats": {"total": 16, "additions": 13, "deletions": 3}, "files": [{"sha": "5655b3c0d7c2b0a9810d9f379d12194f8ee896d6", "filename": "gcc/ada/s-os_lib.adb", "status": "modified", "additions": 13, "deletions": 3, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e401e17bdfaa22265f753151d9354f7de577a98c/gcc%2Fada%2Fs-os_lib.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e401e17bdfaa22265f753151d9354f7de577a98c/gcc%2Fada%2Fs-os_lib.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fs-os_lib.adb?ref=e401e17bdfaa22265f753151d9354f7de577a98c", "patch": "@@ -452,7 +452,13 @@ package body System.OS_Lib is\n \n       begin\n          From := Open_Read (Name, Binary);\n-         To   := Create_File (To_Name, Binary);\n+\n+         --  Do not clobber destination file if source file could not be opened\n+\n+         if From /= Invalid_FD then\n+            To := Create_File (To_Name, Binary);\n+         end if;\n+\n          Copy (From, To);\n \n          --  Copy attributes\n@@ -545,10 +551,14 @@ package body System.OS_Lib is\n             if Is_Regular_File (Pathname) then\n \n                --  Append mode and destination file exists, append data at the\n-               --  end of Pathname.\n+               --  end of Pathname. But if we fail to open source file, do not\n+               --  touch destination file at all.\n \n                From := Open_Read (Name, Binary);\n-               To   := Open_Read_Write (Pathname, Binary);\n+               if From /= Invalid_FD then\n+                  To := Open_Read_Write (Pathname, Binary);\n+               end if;\n+\n                Lseek (To, 0, Seek_End);\n \n                Copy (From, To);"}]}