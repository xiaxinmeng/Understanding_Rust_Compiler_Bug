{"sha": "6916d6104ff448f07130597473356334c3d73501", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjkxNmQ2MTA0ZmY0NDhmMDcxMzA1OTc0NzMzNTYzMzRjM2Q3MzUwMQ==", "commit": {"author": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2017-06-14T13:37:48Z"}, "committer": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2017-06-14T13:37:48Z"}, "message": "compiler: remove \"DIR/../\" when joining relative import path\n    \n    Otherwise if DIR does not exist, the path does not work. This matches\n    what the gc cmd/compile tool does, because it calls path.Join.\n    \n    The test for this is the cmd/go tests, to be added in a follow-up CL.\n    \n    Reviewed-on: https://go-review.googlesource.com/45691\n\nFrom-SVN: r249194", "tree": {"sha": "284721011965de05fde468a68fead07b9739d32e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/284721011965de05fde468a68fead07b9739d32e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6916d6104ff448f07130597473356334c3d73501", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6916d6104ff448f07130597473356334c3d73501", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6916d6104ff448f07130597473356334c3d73501", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6916d6104ff448f07130597473356334c3d73501/comments", "author": null, "committer": null, "parents": [{"sha": "26fda5f59aa242dcf11cf4dd7ef837c635c02673", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/26fda5f59aa242dcf11cf4dd7ef837c635c02673", "html_url": "https://github.com/Rust-GCC/gccrs/commit/26fda5f59aa242dcf11cf4dd7ef837c635c02673"}], "stats": {"total": 21, "additions": 20, "deletions": 1}, "files": [{"sha": "4365d6e3b2ee45fef571a15a8853ad2ea40d848c", "filename": "gcc/go/gofrontend/MERGE", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6916d6104ff448f07130597473356334c3d73501/gcc%2Fgo%2Fgofrontend%2FMERGE", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6916d6104ff448f07130597473356334c3d73501/gcc%2Fgo%2Fgofrontend%2FMERGE", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgo%2Fgofrontend%2FMERGE?ref=6916d6104ff448f07130597473356334c3d73501", "patch": "@@ -1,4 +1,4 @@\n-be5fa26b2b1b5d0755bc1c7ce25f3aa26bea9d9c\n+c0840d5826abb713487b2d8a04ab249764b21010\n \n The first line of this file holds the git revision number of the last\n merge done from the gofrontend repository."}, {"sha": "20b077f7f9985e6436cdada24df66986f18ac727", "filename": "gcc/go/gofrontend/import.cc", "status": "modified", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6916d6104ff448f07130597473356334c3d73501/gcc%2Fgo%2Fgofrontend%2Fimport.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6916d6104ff448f07130597473356334c3d73501/gcc%2Fgo%2Fgofrontend%2Fimport.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgo%2Fgofrontend%2Fimport.cc?ref=6916d6104ff448f07130597473356334c3d73501", "patch": "@@ -82,6 +82,25 @@ Import::open_package(const std::string& filename, Location location,\n \t  // A special case.\n \t  fn = relative_import_path;\n \t}\n+      else if (fn[0] == '.' && fn[1] == '.'\n+\t       && (fn[2] == '\\0' || IS_DIR_SEPARATOR(fn[2])))\n+\t{\n+\t  // We are going to join relative_import_path and fn, and it\n+\t  // will look like DIR/../PATH.  But DIR does not necessarily\n+\t  // exist in this case, and if it doesn't the use of .. will\n+\t  // fail although it shouldn't.  The gc compiler uses\n+\t  // path.Join here, which cleans up the .., so we need to do\n+\t  // the same.\n+\t  size_t index;\n+\t  for (index = relative_import_path.length() - 1;\n+\t       index > 0 && !IS_DIR_SEPARATOR(relative_import_path[index]);\n+\t       index--)\n+\t    ;\n+\t  if (index > 0)\n+\t    fn = relative_import_path.substr(0, index) + fn.substr(2);\n+\t  else\n+\t    fn = relative_import_path + '/' + fn;\n+\t}\n       else\n \tfn = relative_import_path + '/' + fn;\n       is_local = false;"}]}