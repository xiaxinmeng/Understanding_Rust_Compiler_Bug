{"sha": "afcc28b2f12eef886df971bee0adc62f284655e7", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWZjYzI4YjJmMTJlZWY4ODZkZjk3MWJlZTBhZGM2MmYyODQ2NTVlNw==", "commit": {"author": {"name": "Richard Stallman", "email": "rms@gnu.org", "date": "1993-05-17T17:46:45Z"}, "committer": {"name": "Richard Stallman", "email": "rms@gnu.org", "date": "1993-05-17T17:46:45Z"}, "message": "(INITIALIZE_TRAMPOLINE): Pass both the starting and ending\naddresses of the trampoline to the cacheflush pattern.\n\nFrom-SVN: r4484", "tree": {"sha": "ddd0a59274c3d75972a0b9218f8056a926f4fe35", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ddd0a59274c3d75972a0b9218f8056a926f4fe35"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/afcc28b2f12eef886df971bee0adc62f284655e7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/afcc28b2f12eef886df971bee0adc62f284655e7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/afcc28b2f12eef886df971bee0adc62f284655e7", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/afcc28b2f12eef886df971bee0adc62f284655e7/comments", "author": null, "committer": null, "parents": [{"sha": "a144eb959b27ae60f99129c74cf643844a65bf79", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a144eb959b27ae60f99129c74cf643844a65bf79", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a144eb959b27ae60f99129c74cf643844a65bf79"}], "stats": {"total": 24, "additions": 15, "deletions": 9}, "files": [{"sha": "ef9e305970bcb94c344b16a320e2836a934d39b5", "filename": "gcc/config/pa/pa.h", "status": "modified", "additions": 15, "deletions": 9, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/afcc28b2f12eef886df971bee0adc62f284655e7/gcc%2Fconfig%2Fpa%2Fpa.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/afcc28b2f12eef886df971bee0adc62f284655e7/gcc%2Fconfig%2Fpa%2Fpa.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fpa%2Fpa.h?ref=afcc28b2f12eef886df971bee0adc62f284655e7", "patch": "@@ -979,8 +979,13 @@ extern union tree_node *current_function_decl;\n }\n \n /* Length in units of the trampoline for entering a nested function.\n-   If this grows to > 32 bytes, then you must update the flushcache\n-   pattern in pa.md.  */\n+\n+   Flush the cache entries corresponding to the first and last addresses\n+   of the trampoline.  This is necessary as the trampoline may cross two\n+   cache lines.  \n+\n+   If the trampoline ever grows to > 32 bytes, then it will become\n+   necessary to hack on the cacheflush pattern in pa.md.  */\n \n #define TRAMPOLINE_SIZE (5 * 4)\n \n@@ -993,16 +998,17 @@ extern union tree_node *current_function_decl;\n \n #define INITIALIZE_TRAMPOLINE(TRAMP, FNADDR, CXT) \\\n {\t\t\t\t\t\t\t\t\\\n-  rtx addr, mem;\t\t\t\t\t\t\\\n+  rtx start_addr, end_addr, mem;\t\t\t\t\\\n \t\t\t\t\t\t\t\t\\\n-  addr = memory_address (Pmode, plus_constant ((TRAMP), 12));\t\\\n-  emit_move_insn (gen_rtx (MEM, Pmode, addr), (FNADDR));\t\\\n-  addr = memory_address (Pmode, plus_constant ((TRAMP), 16));\t\\\n-  emit_move_insn (gen_rtx (MEM, Pmode, addr), (CXT));\t\t\\\n+  start_addr = memory_address (Pmode, plus_constant ((TRAMP), 12));\\\n+  emit_move_insn (gen_rtx (MEM, Pmode, start_addr), (FNADDR));\t\\\n+  start_addr = memory_address (Pmode, plus_constant ((TRAMP), 16));\\\n+  emit_move_insn (gen_rtx (MEM, Pmode, start_addr), (CXT));\t\\\n   /* fdc and fic only use registers for the address to flush,\t\\\n      they do not accept integer displacements.  */ \t\t\\\n-  addr = force_reg (SImode, (TRAMP));\t\t\t\t\\\n-  emit_insn (gen_cacheflush (addr));\t\t\t\t\\\n+  start_addr = force_reg (SImode, (TRAMP));\t\t\t\\\n+  end_addr = force_reg (SImode, plus_constant (start_addr, TRAMPOLINE_SIZE));\\\n+  emit_insn (gen_cacheflush (start_addr, end_addr));\t\t\\\n }\n \n /* Emit code for a call to builtin_saveregs.  We must emit USE insns which"}]}