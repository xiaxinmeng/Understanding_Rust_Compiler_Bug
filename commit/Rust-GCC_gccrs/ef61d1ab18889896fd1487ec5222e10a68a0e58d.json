{"sha": "ef61d1ab18889896fd1487ec5222e10a68a0e58d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWY2MWQxYWIxODg4OTg5NmZkMTQ4N2VjNTIyMmUxMGE2OGEwZTU4ZA==", "commit": {"author": {"name": "Andreas Krebbel", "email": "krebbel@linux.vnet.ibm.com", "date": "2018-01-19T22:16:30Z"}, "committer": {"name": "Vladimir Makarov", "email": "vmakarov@gcc.gnu.org", "date": "2018-01-19T22:16:30Z"}, "message": "re PR rtl-optimization/83147 (LRA inheritance undo on multiple sets problem)\n\n2018-01-19  Andreas Krebbel  <krebbel@linux.vnet.ibm.com>\n\n\tPR rtl-optimization/83147\n\t* lra-constraints.c (remove_inheritance_pseudos): Use\n\tlra_substitute_pseudo_within_insn.\n\nFrom-SVN: r256902", "tree": {"sha": "a2c73240cfed9ec25243981abee10f4b164ece87", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a2c73240cfed9ec25243981abee10f4b164ece87"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ef61d1ab18889896fd1487ec5222e10a68a0e58d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ef61d1ab18889896fd1487ec5222e10a68a0e58d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ef61d1ab18889896fd1487ec5222e10a68a0e58d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ef61d1ab18889896fd1487ec5222e10a68a0e58d/comments", "author": null, "committer": null, "parents": [{"sha": "dba99244eaddee9153c1ae605861014f55a30f70", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dba99244eaddee9153c1ae605861014f55a30f70", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dba99244eaddee9153c1ae605861014f55a30f70"}], "stats": {"total": 16, "additions": 12, "deletions": 4}, "files": [{"sha": "8bffc6627d71dd95871b0e3b104f062b4d81b8ab", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ef61d1ab18889896fd1487ec5222e10a68a0e58d/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ef61d1ab18889896fd1487ec5222e10a68a0e58d/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=ef61d1ab18889896fd1487ec5222e10a68a0e58d", "patch": "@@ -1,3 +1,9 @@\n+2018-01-19  Andreas Krebbel  <krebbel@linux.vnet.ibm.com>\n+\n+\tPR rtl-optimization/83147\n+\t* lra-constraints.c (remove_inheritance_pseudos): Use\n+\tlra_substitute_pseudo_within_insn.\n+\n 2018-01-19  Tom de Vries  <tom@codesourcery.com>\n \t    Cesar Philippidis  <cesar@codesourcery.com>\n "}, {"sha": "64ee2fec3c55920ed1ab4c4f6687af4288b0ae45", "filename": "gcc/lra-constraints.c", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ef61d1ab18889896fd1487ec5222e10a68a0e58d/gcc%2Flra-constraints.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ef61d1ab18889896fd1487ec5222e10a68a0e58d/gcc%2Flra-constraints.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flra-constraints.c?ref=ef61d1ab18889896fd1487ec5222e10a68a0e58d", "patch": "@@ -6719,10 +6719,12 @@ remove_inheritance_pseudos (bitmap remove_pseudos)\n \t\t    {\n \t\t      lra_assert (GET_MODE (SET_SRC (prev_set))\n \t\t\t\t  == GET_MODE (regno_reg_rtx[sregno]));\n-\t\t      if (GET_CODE (SET_SRC (set)) == SUBREG)\n-\t\t\tSUBREG_REG (SET_SRC (set)) = SET_SRC (prev_set);\n-\t\t      else\n-\t\t\tSET_SRC (set) = SET_SRC (prev_set);\n+\t\t      /* Although we have a single set, the insn can\n+\t\t\t contain more one sregno register occurrence\n+\t\t\t as a source.  Change all occurrences.  */\n+\t\t      lra_substitute_pseudo_within_insn (curr_insn, sregno,\n+\t\t\t\t\t\t\t SET_SRC (prev_set),\n+\t\t\t\t\t\t\t false);\n \t\t      /* As we are finishing with processing the insn\n \t\t\t here, check the destination too as it might\n \t\t\t inheritance pseudo for another pseudo.  */"}]}