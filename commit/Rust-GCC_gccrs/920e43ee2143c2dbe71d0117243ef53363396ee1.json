{"sha": "920e43ee2143c2dbe71d0117243ef53363396ee1", "node_id": "C_kwDOANBUbNoAKDkyMGU0M2VlMjE0M2MyZGJlNzFkMDExNzI0M2VmNTMzNjMzOTZlZTE", "commit": {"author": {"name": "Piotr Trojanek", "email": "trojanek@adacore.com", "date": "2021-07-22T13:33:16Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "derodat@adacore.com", "date": "2021-09-22T15:01:47Z"}, "message": "[Ada] Add Package_Body helper routine to be used in GNATprove\n\ngcc/ada/\n\n\t* sem_aux.adb, sem_aux.ads (Package_Body): Moved from GNATprove.\n\t* sem_elab.adb (Spec_And_Body_From_Entity): Refine type of parameter.", "tree": {"sha": "121191ea7281051ca8e3c336af9167a456e3ca51", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/121191ea7281051ca8e3c336af9167a456e3ca51"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/920e43ee2143c2dbe71d0117243ef53363396ee1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/920e43ee2143c2dbe71d0117243ef53363396ee1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/920e43ee2143c2dbe71d0117243ef53363396ee1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/920e43ee2143c2dbe71d0117243ef53363396ee1/comments", "author": {"login": "ptroja", "id": 161602, "node_id": "MDQ6VXNlcjE2MTYwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/161602?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ptroja", "html_url": "https://github.com/ptroja", "followers_url": "https://api.github.com/users/ptroja/followers", "following_url": "https://api.github.com/users/ptroja/following{/other_user}", "gists_url": "https://api.github.com/users/ptroja/gists{/gist_id}", "starred_url": "https://api.github.com/users/ptroja/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ptroja/subscriptions", "organizations_url": "https://api.github.com/users/ptroja/orgs", "repos_url": "https://api.github.com/users/ptroja/repos", "events_url": "https://api.github.com/users/ptroja/events{/privacy}", "received_events_url": "https://api.github.com/users/ptroja/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pmderodat", "id": 758452, "node_id": "MDQ6VXNlcjc1ODQ1Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/758452?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pmderodat", "html_url": "https://github.com/pmderodat", "followers_url": "https://api.github.com/users/pmderodat/followers", "following_url": "https://api.github.com/users/pmderodat/following{/other_user}", "gists_url": "https://api.github.com/users/pmderodat/gists{/gist_id}", "starred_url": "https://api.github.com/users/pmderodat/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pmderodat/subscriptions", "organizations_url": "https://api.github.com/users/pmderodat/orgs", "repos_url": "https://api.github.com/users/pmderodat/repos", "events_url": "https://api.github.com/users/pmderodat/events{/privacy}", "received_events_url": "https://api.github.com/users/pmderodat/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f4f6c18d9f739df6f1cf8aedbc2a0c4b3c0248fa", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f4f6c18d9f739df6f1cf8aedbc2a0c4b3c0248fa", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f4f6c18d9f739df6f1cf8aedbc2a0c4b3c0248fa"}], "stats": {"total": 33, "additions": 31, "deletions": 2}, "files": [{"sha": "dcced7e40e657d4ade9232ccbdee0ca5876bb804", "filename": "gcc/ada/sem_aux.adb", "status": "modified", "additions": 25, "deletions": 0, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/920e43ee2143c2dbe71d0117243ef53363396ee1/gcc%2Fada%2Fsem_aux.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/920e43ee2143c2dbe71d0117243ef53363396ee1/gcc%2Fada%2Fsem_aux.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_aux.adb?ref=920e43ee2143c2dbe71d0117243ef53363396ee1", "patch": "@@ -1401,6 +1401,31 @@ package body Sem_Aux is\n                   and then Has_Discriminants (Typ));\n    end Object_Type_Has_Constrained_Partial_View;\n \n+   ------------------\n+   -- Package_Body --\n+   ------------------\n+\n+   function Package_Body (E : Entity_Id) return Node_Id is\n+      Body_Decl : Node_Id;\n+      Body_Id   : constant Opt_E_Package_Body_Id :=\n+        Corresponding_Body (Package_Spec (E));\n+\n+   begin\n+      if Present (Body_Id) then\n+         Body_Decl := Parent (Body_Id);\n+\n+         if Nkind (Body_Decl) = N_Defining_Program_Unit_Name then\n+            Body_Decl := Parent (Body_Decl);\n+         end if;\n+\n+         pragma Assert (Nkind (Body_Decl) = N_Package_Body);\n+\n+         return Body_Decl;\n+      else\n+         return Empty;\n+      end if;\n+   end Package_Body;\n+\n    ------------------\n    -- Package_Spec --\n    ------------------"}, {"sha": "3adaee416b26fb0d30309a80a91fa84991bb4c9c", "filename": "gcc/ada/sem_aux.ads", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/920e43ee2143c2dbe71d0117243ef53363396ee1/gcc%2Fada%2Fsem_aux.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/920e43ee2143c2dbe71d0117243ef53363396ee1/gcc%2Fada%2Fsem_aux.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_aux.ads?ref=920e43ee2143c2dbe71d0117243ef53363396ee1", "patch": "@@ -377,6 +377,10 @@ package Sem_Aux is\n    --  derived type, and the subtype is not an unconstrained array subtype\n    --  (RM 3.3(23.10/3)).\n \n+   function Package_Body (E : Entity_Id) return Node_Id;\n+   --  Given an entity for a package, return the corresponding package body, if\n+   --  any, or else Empty.\n+\n    function Package_Spec (E : Entity_Id) return Node_Id;\n    --  Given an entity for a package spec, return the corresponding package\n    --  spec if any, or else Empty."}, {"sha": "7635ae180d28973bdd3ad751877d10e73d7a506b", "filename": "gcc/ada/sem_elab.adb", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/920e43ee2143c2dbe71d0117243ef53363396ee1/gcc%2Fada%2Fsem_elab.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/920e43ee2143c2dbe71d0117243ef53363396ee1/gcc%2Fada%2Fsem_elab.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_elab.adb?ref=920e43ee2143c2dbe71d0117243ef53363396ee1", "patch": "@@ -2070,7 +2070,7 @@ package body Sem_Elab is\n    --  Change the status of the elaboration phase of the compiler to Status\n \n    procedure Spec_And_Body_From_Entity\n-     (Id        : Node_Id;\n+     (Id        : Entity_Id;\n       Spec_Decl : out Node_Id;\n       Body_Decl : out Node_Id);\n    pragma Inline (Spec_And_Body_From_Entity);\n@@ -15835,7 +15835,7 @@ package body Sem_Elab is\n    -------------------------------\n \n    procedure Spec_And_Body_From_Entity\n-     (Id        : Node_Id;\n+     (Id        : Entity_Id;\n       Spec_Decl : out Node_Id;\n       Body_Decl : out Node_Id)\n    is"}]}