{"sha": "e6c5817dca87ebafda02ea2cb7abaf7e00db74a5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTZjNTgxN2RjYTg3ZWJhZmRhMDJlYTJjYjdhYmFmN2UwMGRiNzRhNQ==", "commit": {"author": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2012-02-10T14:07:44Z"}, "committer": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2012-02-10T14:07:44Z"}, "message": "libgo/configure: Fixes for Solaris 8 and cross-compilation.\n\nFrom Rainer Orth.\n\nFrom-SVN: r184092", "tree": {"sha": "feda6ef2eb4bb1b1f94d43d9714629032ff78cf1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/feda6ef2eb4bb1b1f94d43d9714629032ff78cf1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e6c5817dca87ebafda02ea2cb7abaf7e00db74a5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e6c5817dca87ebafda02ea2cb7abaf7e00db74a5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e6c5817dca87ebafda02ea2cb7abaf7e00db74a5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e6c5817dca87ebafda02ea2cb7abaf7e00db74a5/comments", "author": null, "committer": null, "parents": [{"sha": "0f3b7e9a446183d8b27c7907d97f542be53eda90", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0f3b7e9a446183d8b27c7907d97f542be53eda90", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0f3b7e9a446183d8b27c7907d97f542be53eda90"}], "stats": {"total": 66, "additions": 58, "deletions": 8}, "files": [{"sha": "afbb9ee9c5371883d7adcea707122f0a704cd6f4", "filename": "libgo/config.h.in", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e6c5817dca87ebafda02ea2cb7abaf7e00db74a5/libgo%2Fconfig.h.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e6c5817dca87ebafda02ea2cb7abaf7e00db74a5/libgo%2Fconfig.h.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgo%2Fconfig.h.in?ref=e6c5817dca87ebafda02ea2cb7abaf7e00db74a5", "patch": "@@ -198,6 +198,9 @@\n /* Define if setcontext clobbers TLS variables */\n #undef SETCONTEXT_CLOBBERS_TLS\n \n+/* The size of `void *', as computed by sizeof. */\n+#undef SIZEOF_VOID_P\n+\n /* Define to 1 if you have the ANSI C header files. */\n #undef STDC_HEADERS\n "}, {"sha": "6bb35a657289c44f7dbdafc8acc20f875f57646f", "filename": "libgo/configure", "status": "modified", "additions": 44, "deletions": 4, "changes": 48, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e6c5817dca87ebafda02ea2cb7abaf7e00db74a5/libgo%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e6c5817dca87ebafda02ea2cb7abaf7e00db74a5/libgo%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgo%2Fconfigure?ref=e6c5817dca87ebafda02ea2cb7abaf7e00db74a5", "patch": "@@ -14818,12 +14818,51 @@ $as_echo_n \"checking whether setcontext clobbers TLS variables... \" >&6; }\n if test \"${libgo_cv_lib_setcontext_clobbers_tls+set}\" = set; then :\n   $as_echo_n \"(cached) \" >&6\n else\n-  LIBS_hold=\"$LIBS\"\n+  CFLAGS_hold=\"$CFLAGS\"\n+CFLAGS=\"$PTHREAD_CFLAGS\"\n+LIBS_hold=\"$LIBS\"\n LIBS=\"$LIBS $PTHREAD_LIBS\"\n+# The cast to long int works around a bug in the HP C Compiler\n+# version HP92453-01 B.11.11.23709.GP, which incorrectly rejects\n+# declarations like `int a3[[(sizeof (unsigned char)) >= 0]];'.\n+# This bug is HP SR number 8606223364.\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: checking size of void *\" >&5\n+$as_echo_n \"checking size of void *... \" >&6; }\n+if test \"${ac_cv_sizeof_void_p+set}\" = set; then :\n+  $as_echo_n \"(cached) \" >&6\n+else\n+  if ac_fn_c_compute_int \"$LINENO\" \"(long int) (sizeof (void *))\" \"ac_cv_sizeof_void_p\"        \"$ac_includes_default\"; then :\n+\n+else\n+  if test \"$ac_cv_type_void_p\" = yes; then\n+     { { $as_echo \"$as_me:${as_lineno-$LINENO}: error: in \\`$ac_pwd':\" >&5\n+$as_echo \"$as_me: error: in \\`$ac_pwd':\" >&2;}\n+{ as_fn_set_status 77\n+as_fn_error \"cannot compute sizeof (void *)\n+See \\`config.log' for more details.\" \"$LINENO\" 5; }; }\n+   else\n+     ac_cv_sizeof_void_p=0\n+   fi\n+fi\n+\n+fi\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $ac_cv_sizeof_void_p\" >&5\n+$as_echo \"$ac_cv_sizeof_void_p\" >&6; }\n+\n+\n+\n+cat >>confdefs.h <<_ACEOF\n+#define SIZEOF_VOID_P $ac_cv_sizeof_void_p\n+_ACEOF\n+\n+\n+as_fn_arith $ac_cv_sizeof_void_p \\* 8 && ptr_type_size=$as_val\n if test \"$cross_compiling\" = yes; then :\n-  case \"$target\" in\n-  x86_64*-*-solaris2.10) libgo_cv_lib_setcontext_clobbers_tls=yes ;;\n-  *) libgo_cv_lib_setcontext_clobbers_tls=no ;;\n+  case \"$target:$ptr_type_size\" in\n+  i?86-*-solaris2.1[01]:64 | x86_64*-*-solaris2.1[01]:64)\n+    libgo_cv_lib_setcontext_clobbers_tls=yes ;;\n+  *)\n+    libgo_cv_lib_setcontext_clobbers_tls=no ;;\n  esac\n \n else\n@@ -14900,6 +14939,7 @@ rm -f core *.core core.conftest.* gmon.out bb.out conftest$ac_exeext \\\n   conftest.$ac_objext conftest.beam conftest.$ac_ext\n fi\n \n+CFLAGS=\"$CFLAGS_hold\"\n LIBS=\"$LIBS_hold\"\n \n fi"}, {"sha": "9c8478de74fd9c757e1712adfafe2b574dc7eaa6", "filename": "libgo/configure.ac", "status": "modified", "additions": 11, "deletions": 4, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e6c5817dca87ebafda02ea2cb7abaf7e00db74a5/libgo%2Fconfigure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e6c5817dca87ebafda02ea2cb7abaf7e00db74a5/libgo%2Fconfigure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgo%2Fconfigure.ac?ref=e6c5817dca87ebafda02ea2cb7abaf7e00db74a5", "patch": "@@ -584,8 +584,12 @@ fi\n dnl See whether setcontext changes the value of TLS variables.\n AC_CACHE_CHECK([whether setcontext clobbers TLS variables],\n [libgo_cv_lib_setcontext_clobbers_tls],\n-[LIBS_hold=\"$LIBS\"\n+[CFLAGS_hold=\"$CFLAGS\"\n+CFLAGS=\"$PTHREAD_CFLAGS\"\n+LIBS_hold=\"$LIBS\"\n LIBS=\"$LIBS $PTHREAD_LIBS\"\n+AC_CHECK_SIZEOF([void *])\n+AS_VAR_ARITH([ptr_type_size], [$ac_cv_sizeof_void_p \\* 8])\n AC_RUN_IFELSE(\n   [AC_LANG_SOURCE([\n #include <pthread.h>\n@@ -650,11 +654,14 @@ main ()\n ])],\n [libgo_cv_lib_setcontext_clobbers_tls=no],\n [libgo_cv_lib_setcontext_clobbers_tls=yes],\n-[case \"$target\" in\n-  x86_64*-*-solaris2.10) libgo_cv_lib_setcontext_clobbers_tls=yes ;;\n-  *) libgo_cv_lib_setcontext_clobbers_tls=no ;;\n+[case \"$target:$ptr_type_size\" in\n+  i?86-*-solaris2.1[[01]]:64 | x86_64*-*-solaris2.1[[01]]:64)\n+    libgo_cv_lib_setcontext_clobbers_tls=yes ;;\n+  *)\n+    libgo_cv_lib_setcontext_clobbers_tls=no ;;\n  esac\n ])\n+CFLAGS=\"$CFLAGS_hold\"\n LIBS=\"$LIBS_hold\"\n ])\n if test \"$libgo_cv_lib_setcontext_clobbers_tls\" = \"yes\"; then"}]}