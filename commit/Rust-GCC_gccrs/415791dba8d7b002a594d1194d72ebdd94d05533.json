{"sha": "415791dba8d7b002a594d1194d72ebdd94d05533", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDE1NzkxZGJhOGQ3YjAwMmE1OTRkMTE5NGQ3MmViZGQ5NGQwNTUzMw==", "commit": {"author": {"name": "Tom Tromey", "email": "tromey@redhat.com", "date": "2001-12-12T20:58:41Z"}, "committer": {"name": "Tom Tromey", "email": "tromey@gcc.gnu.org", "date": "2001-12-12T20:58:41Z"}, "message": "* jni.cc (call): Synchronize if required.\n\nFrom-SVN: r47949", "tree": {"sha": "583afb8fe11597ee27d6684ffdba15b2342474b8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/583afb8fe11597ee27d6684ffdba15b2342474b8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/415791dba8d7b002a594d1194d72ebdd94d05533", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/415791dba8d7b002a594d1194d72ebdd94d05533", "html_url": "https://github.com/Rust-GCC/gccrs/commit/415791dba8d7b002a594d1194d72ebdd94d05533", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/415791dba8d7b002a594d1194d72ebdd94d05533/comments", "author": null, "committer": null, "parents": [{"sha": "242f4945ac36aa5c3f6aecbd7e0420a1c9f73fb5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/242f4945ac36aa5c3f6aecbd7e0420a1c9f73fb5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/242f4945ac36aa5c3f6aecbd7e0420a1c9f73fb5"}], "stats": {"total": 16, "additions": 16, "deletions": 0}, "files": [{"sha": "d41ff8d712eee260dbebc1aeb6e1cbfb26ef4f3d", "filename": "libjava/ChangeLog", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/415791dba8d7b002a594d1194d72ebdd94d05533/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/415791dba8d7b002a594d1194d72ebdd94d05533/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=415791dba8d7b002a594d1194d72ebdd94d05533", "patch": "@@ -1,5 +1,7 @@\n 2001-12-12  Tom Tromey  <tromey@redhat.com>\n \n+\t* jni.cc (call): Synchronize if required.\n+\n \t* gij.cc (main): Clarify --help output.\n \n \t* gnu/gcj/runtime/StringBuffer.java"}, {"sha": "1dd299f3aa961ae4e088751e0a9d1d04e86440bf", "filename": "libjava/jni.cc", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/415791dba8d7b002a594d1194d72ebdd94d05533/libjava%2Fjni.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/415791dba8d7b002a594d1194d72ebdd94d05533/libjava%2Fjni.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjni.cc?ref=415791dba8d7b002a594d1194d72ebdd94d05533", "patch": "@@ -2066,13 +2066,27 @@ _Jv_JNIMethod::call (ffi_cif *, void *ret, ffi_raw *args, void *__this)\n   if ((_this->self->accflags & java::lang::reflect::Modifier::STATIC))\n     real_args[offset++].ptr = _this->defining_class;\n \n+  // In libgcj, the callee synchronizes.\n+  jobject sync = NULL;\n+  if ((_this->self->accflags & java::lang::reflect::Modifier::SYNCHRONIZED))\n+    {\n+      if ((_this->self->accflags & java::lang::reflect::Modifier::STATIC))\n+\tsync = _this->defining_class;\n+      else\n+\tsync = (jobject) args[0].ptr;\n+      _Jv_MonitorEnter (sync);\n+    }\n+\n   // Copy over passed-in arguments.\n   memcpy (&real_args[offset], args, _this->args_raw_size);\n \n   // The actual call to the JNI function.\n   ffi_raw_call (&_this->jni_cif, (void (*)()) _this->function,\n \t\tret, real_args);\n \n+  if (sync != NULL)\n+    _Jv_MonitorExit (sync);\n+\n   _Jv_JNI_PopSystemFrame (env);\n }\n "}]}