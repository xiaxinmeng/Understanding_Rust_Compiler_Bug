{"sha": "fe62197bedacea53202fd27fbc3e69c577eac692", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZmU2MjE5N2JlZGFjZWE1MzIwMmZkMjdmYmMzZTY5YzU3N2VhYzY5Mg==", "commit": {"author": {"name": "Uros Bizjak", "email": "ubizjak@gmail.com", "date": "2009-08-23T12:14:26Z"}, "committer": {"name": "Uros Bizjak", "email": "uros@gcc.gnu.org", "date": "2009-08-23T12:14:26Z"}, "message": "re PR target/40718 (Invalid code produced with -foptimize-sibling-calls)\n\n\tPR target/40718\n\t* config/i386/i386.c (*call_pop_1): Disable for sibling calls.\n\t(*call_value_pop_1): Ditto.\n\t(*sibcall_pop_1): New insn pattern.\n\t(*sibcall_value_pop_1): Ditto.\n\nFrom-SVN: r151029", "tree": {"sha": "8c745f6a7ed37db1f270bfdaf83380706b6a6937", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8c745f6a7ed37db1f270bfdaf83380706b6a6937"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/fe62197bedacea53202fd27fbc3e69c577eac692", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fe62197bedacea53202fd27fbc3e69c577eac692", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fe62197bedacea53202fd27fbc3e69c577eac692", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fe62197bedacea53202fd27fbc3e69c577eac692/comments", "author": {"login": "ubizjak", "id": 55479990, "node_id": "MDQ6VXNlcjU1NDc5OTkw", "avatar_url": "https://avatars.githubusercontent.com/u/55479990?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ubizjak", "html_url": "https://github.com/ubizjak", "followers_url": "https://api.github.com/users/ubizjak/followers", "following_url": "https://api.github.com/users/ubizjak/following{/other_user}", "gists_url": "https://api.github.com/users/ubizjak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ubizjak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ubizjak/subscriptions", "organizations_url": "https://api.github.com/users/ubizjak/orgs", "repos_url": "https://api.github.com/users/ubizjak/repos", "events_url": "https://api.github.com/users/ubizjak/events{/privacy}", "received_events_url": "https://api.github.com/users/ubizjak/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "8c40d061eca6c784a919c666e363cac4116874cc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8c40d061eca6c784a919c666e363cac4116874cc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8c40d061eca6c784a919c666e363cac4116874cc"}], "stats": {"total": 28, "additions": 17, "deletions": 11}, "files": [{"sha": "10333a94ff27a05da6efe0128721fe755358ce56", "filename": "gcc/ChangeLog", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fe62197bedacea53202fd27fbc3e69c577eac692/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fe62197bedacea53202fd27fbc3e69c577eac692/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=fe62197bedacea53202fd27fbc3e69c577eac692", "patch": "@@ -2,7 +2,9 @@\n \n \tPR target/40718\n \t* config/i386/i386.c (*call_pop_1): Disable for sibling calls.\n+\t(*call_value_pop_1): Ditto.\n \t(*sibcall_pop_1): New insn pattern.\n+\t(*sibcall_value_pop_1): Ditto.\n \n 2009-08-23  Alan Modra  <amodra@bigpond.net.au>\n "}, {"sha": "0735d5e9b89d52766876a3700ae0bde0cdb6b17d", "filename": "gcc/config/i386/i386.md", "status": "modified", "additions": 15, "deletions": 11, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fe62197bedacea53202fd27fbc3e69c577eac692/gcc%2Fconfig%2Fi386%2Fi386.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fe62197bedacea53202fd27fbc3e69c577eac692/gcc%2Fconfig%2Fi386%2Fi386.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386.md?ref=fe62197bedacea53202fd27fbc3e69c577eac692", "patch": "@@ -22095,22 +22095,26 @@\n \t      (match_operand:SI 2 \"\" \"\")))\n    (set (reg:SI SP_REG) (plus:SI (reg:SI SP_REG)\n \t\t\t    (match_operand:SI 3 \"immediate_operand\" \"i\")))]\n-  \"!TARGET_64BIT\"\n+  \"!SIBLING_CALL_P (insn) && !TARGET_64BIT\"\n {\n   if (constant_call_address_operand (operands[1], Pmode))\n-    {\n-      if (SIBLING_CALL_P (insn))\n-\treturn \"jmp\\t%P1\";\n-      else\n-\treturn \"call\\t%P1\";\n-    }\n-  if (SIBLING_CALL_P (insn))\n-    return \"jmp\\t%A1\";\n-  else\n-    return \"call\\t%A1\";\n+    return \"call\\t%P1\";\n+  return \"call\\t%A1\";\n }\n   [(set_attr \"type\" \"callv\")])\n \n+(define_insn \"*sibcall_value_pop_1\"\n+  [(set (match_operand 0 \"\" \"\")\n+\t(call (mem:QI (match_operand:SI 1 \"call_insn_operand\" \"s,U\"))\n+\t      (match_operand:SI 2 \"\" \"\")))\n+   (set (reg:SI SP_REG) (plus:SI (reg:SI SP_REG)\n+\t\t\t    (match_operand:SI 3 \"immediate_operand\" \"i,i\")))]\n+  \"SIBLING_CALL_P (insn) && !TARGET_64BIT\"\n+  \"@\n+   jmp\\t%P1\n+   jmp\\t%A1\"\n+  [(set_attr \"type\" \"callv\")])\n+\n (define_insn \"*call_value_0\"\n   [(set (match_operand 0 \"\" \"\")\n \t(call (mem:QI (match_operand:SI 1 \"constant_call_address_operand\" \"\"))"}]}