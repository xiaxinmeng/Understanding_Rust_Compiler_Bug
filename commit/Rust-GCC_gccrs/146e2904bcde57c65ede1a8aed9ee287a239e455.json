{"sha": "146e2904bcde57c65ede1a8aed9ee287a239e455", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTQ2ZTI5MDRiY2RlNTdjNjVlZGUxYThhZWQ5ZWUyODdhMjM5ZTQ1NQ==", "commit": {"author": {"name": "Bryce McKinlay", "email": "mckinlay@redhat.com", "date": "2005-05-19T22:24:26Z"}, "committer": {"name": "Bryce McKinlay", "email": "bryce@gcc.gnu.org", "date": "2005-05-19T22:24:26Z"}, "message": "natClassLoader.cc (_Jv_NewClass): Use _Jv_RegisterInitiatingLoader to register array classes, not _Jv_RegisterClass.\n\n\t* java/lang/natClassLoader.cc (_Jv_NewClass): Use\n\t_Jv_RegisterInitiatingLoader to register array classes, not\n\t_Jv_RegisterClass.\n\t(_Jv_RegisterInitiatingLoader): Give up if called very early during\n\tbootstrapping. Add a FIXME to handle this case better.\n\nFrom-SVN: r99993", "tree": {"sha": "64f08909c66f04266d262394dfb5d7e7b59c1059", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/64f08909c66f04266d262394dfb5d7e7b59c1059"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/146e2904bcde57c65ede1a8aed9ee287a239e455", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/146e2904bcde57c65ede1a8aed9ee287a239e455", "html_url": "https://github.com/Rust-GCC/gccrs/commit/146e2904bcde57c65ede1a8aed9ee287a239e455", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/146e2904bcde57c65ede1a8aed9ee287a239e455/comments", "author": null, "committer": null, "parents": [{"sha": "cabf1447768975541f44ad4ad3cc1ab3edfb0901", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cabf1447768975541f44ad4ad3cc1ab3edfb0901", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cabf1447768975541f44ad4ad3cc1ab3edfb0901"}], "stats": {"total": 18, "additions": 17, "deletions": 1}, "files": [{"sha": "738b017e5f0d9d32a3562046d3581fe6c1f31080", "filename": "libjava/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/146e2904bcde57c65ede1a8aed9ee287a239e455/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/146e2904bcde57c65ede1a8aed9ee287a239e455/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=146e2904bcde57c65ede1a8aed9ee287a239e455", "patch": "@@ -1,3 +1,11 @@\n+2005-05-19  Bryce McKinlay  <mckinlay@redhat.com>\n+\n+\t* java/lang/natClassLoader.cc (_Jv_NewClass): Use\n+\t_Jv_RegisterInitiatingLoader to register array classes, not \n+\t_Jv_RegisterClass.\n+\t(_Jv_RegisterInitiatingLoader): Give up if called very early during\n+\tbootstrapping. Add a FIXME to handle this case better.\n+\n 2005-05-19  Bryce McKinlay  <mckinlay@redhat.com>\n \n \t* Makefile.am (libgcj0_convenience_la): Removed. Don't build a libgcj"}, {"sha": "fb3515b5a78914b12715b99cadf70c933c890f9e", "filename": "libjava/java/lang/natClassLoader.cc", "status": "modified", "additions": 9, "deletions": 1, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/146e2904bcde57c65ede1a8aed9ee287a239e455/libjava%2Fjava%2Flang%2FnatClassLoader.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/146e2904bcde57c65ede1a8aed9ee287a239e455/libjava%2Fjava%2Flang%2FnatClassLoader.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjava%2Flang%2FnatClassLoader.cc?ref=146e2904bcde57c65ede1a8aed9ee287a239e455", "patch": "@@ -127,6 +127,14 @@ _Jv_RegisterInitiatingLoader (jclass klass, java::lang::ClassLoader *loader)\n {\n   if (! loader)\n     loader = java::lang::VMClassLoader::bootLoader;\n+  if (! loader)\n+    {\n+      // Very early in the bootstrap process, the Bootstrap classloader may \n+      // not exist yet.\n+      // FIXME: We could maintain a list of these and come back and register\n+      // them later.\n+      return;\n+    }\n   loader->loadedClasses->put(klass->name->toString(), klass);\n }\n \n@@ -346,7 +354,7 @@ _Jv_NewClass (_Jv_Utf8Const *name, jclass superclass,\n   ret->superclass = superclass;\n   ret->loader = loader;\n \n-  _Jv_RegisterClass (ret);\n+  _Jv_RegisterInitiatingLoader (ret, loader);\n \n   return ret;\n }"}]}