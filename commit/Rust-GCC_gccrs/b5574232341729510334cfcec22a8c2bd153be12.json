{"sha": "b5574232341729510334cfcec22a8c2bd153be12", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjU1NzQyMzIzNDE3Mjk1MTAzMzRjZmNlYzIyYThjMmJkMTUzYmUxMg==", "commit": {"author": {"name": "Vidya Praveen", "email": "vidyapraveen@arm.com", "date": "2013-05-23T13:36:41Z"}, "committer": {"name": "Marcus Shawcroft", "email": "mshawcroft@gcc.gnu.org", "date": "2013-05-23T13:36:41Z"}, "message": "[AArch64] Support for CLZ\n\n2013-05-23  Vidya Praveen <vidyapraveen@arm.com>\n\n        * config/aarch64/aarch64-simd.md (clzv4si2): Support for CLZ\n          instruction (AdvSIMD).\n        * config/aarch64/aarch64-builtins.c\n          (aarch64_builtin_vectorized_function): Handler for BUILT_IN_CLZ.\n        * config/aarch64/aarch-simd-builtins.def: Entry for CLZ.\n\nFrom-SVN: r199254", "tree": {"sha": "17079e07f2a36d146c0d09185076b4f50d991ee9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/17079e07f2a36d146c0d09185076b4f50d991ee9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b5574232341729510334cfcec22a8c2bd153be12", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b5574232341729510334cfcec22a8c2bd153be12", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b5574232341729510334cfcec22a8c2bd153be12", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b5574232341729510334cfcec22a8c2bd153be12/comments", "author": {"login": "vparm", "id": 63807973, "node_id": "MDQ6VXNlcjYzODA3OTcz", "avatar_url": "https://avatars.githubusercontent.com/u/63807973?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vparm", "html_url": "https://github.com/vparm", "followers_url": "https://api.github.com/users/vparm/followers", "following_url": "https://api.github.com/users/vparm/following{/other_user}", "gists_url": "https://api.github.com/users/vparm/gists{/gist_id}", "starred_url": "https://api.github.com/users/vparm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vparm/subscriptions", "organizations_url": "https://api.github.com/users/vparm/orgs", "repos_url": "https://api.github.com/users/vparm/repos", "events_url": "https://api.github.com/users/vparm/events{/privacy}", "received_events_url": "https://api.github.com/users/vparm/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "7d2fb5244ba6c3c48222327e8ebc6883fa5c819e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7d2fb5244ba6c3c48222327e8ebc6883fa5c819e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7d2fb5244ba6c3c48222327e8ebc6883fa5c819e"}], "stats": {"total": 67, "additions": 67, "deletions": 0}, "files": [{"sha": "bee52a405a5985f1b3c713c2fddab41c8660539d", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b5574232341729510334cfcec22a8c2bd153be12/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b5574232341729510334cfcec22a8c2bd153be12/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=b5574232341729510334cfcec22a8c2bd153be12", "patch": "@@ -1,3 +1,11 @@\n+2013-05-23  Vidya Praveen <vidyapraveen@arm.com>\n+\n+\t* config/aarch64/aarch64-simd.md (clzv4si2): Support for CLZ\n+\tinstruction (AdvSIMD).\n+\t* config/aarch64/aarch64-builtins.c\n+\t(aarch64_builtin_vectorized_function): Handler for BUILT_IN_CLZ.\n+\t* config/aarch64/aarch-simd-builtins.def: Entry for CLZ.\n+\n 2013-05-22  Martin Jambor  <mjambor@suse.cz>\n \n \tPR middle-end/57347"}, {"sha": "2a0e5fdc39134cc562c8178e7161a25cc5754dc7", "filename": "gcc/config/aarch64/aarch64-builtins.c", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b5574232341729510334cfcec22a8c2bd153be12/gcc%2Fconfig%2Faarch64%2Faarch64-builtins.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b5574232341729510334cfcec22a8c2bd153be12/gcc%2Fconfig%2Faarch64%2Faarch64-builtins.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Faarch64%2Faarch64-builtins.c?ref=b5574232341729510334cfcec22a8c2bd153be12", "patch": "@@ -1244,6 +1244,16 @@ aarch64_builtin_vectorized_function (tree fndecl, tree type_out, tree type_in)\n \tcase BUILT_IN_SQRTF:\n \t  return AARCH64_FIND_FRINT_VARIANT (sqrt);\n #undef AARCH64_CHECK_BUILTIN_MODE\n+#define AARCH64_CHECK_BUILTIN_MODE(C, N) \\\n+  (out_mode == SImode && out_n == C \\\n+   && in_mode == N##Imode && in_n == C)\n+        case BUILT_IN_CLZ:\n+          {\n+            if (AARCH64_CHECK_BUILTIN_MODE (4, S))\n+              return aarch64_builtin_decls[AARCH64_SIMD_BUILTIN_clzv4si];\n+            return NULL_TREE;\n+          }\n+#undef AARCH64_CHECK_BUILTIN_MODE\n #define AARCH64_CHECK_BUILTIN_MODE(C, N) \\\n   (out_mode == N##Imode && out_n == C \\\n    && in_mode == N##Fmode && in_n == C)"}, {"sha": "5134f9674bda99e64cf350f7c8d4fd7abbd7ff7a", "filename": "gcc/config/aarch64/aarch64-simd-builtins.def", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b5574232341729510334cfcec22a8c2bd153be12/gcc%2Fconfig%2Faarch64%2Faarch64-simd-builtins.def", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b5574232341729510334cfcec22a8c2bd153be12/gcc%2Fconfig%2Faarch64%2Faarch64-simd-builtins.def", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Faarch64%2Faarch64-simd-builtins.def?ref=b5574232341729510334cfcec22a8c2bd153be12", "patch": "@@ -49,6 +49,7 @@\n   BUILTIN_VDQF (UNOP, sqrt, 2)\n   BUILTIN_VD_BHSI (BINOP, addp, 0)\n   VAR1 (UNOP, addp, 0, di)\n+  VAR1 (UNOP, clz, 2, v4si)\n \n   BUILTIN_VD_RE (REINTERP, reinterpretdi, 0)\n   BUILTIN_VDC (REINTERP, reinterpretv8qi, 0)"}, {"sha": "04fbdbd58371d707743143e753a967c2ff41517f", "filename": "gcc/config/aarch64/aarch64-simd.md", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b5574232341729510334cfcec22a8c2bd153be12/gcc%2Fconfig%2Faarch64%2Faarch64-simd.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b5574232341729510334cfcec22a8c2bd153be12/gcc%2Fconfig%2Faarch64%2Faarch64-simd.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Faarch64%2Faarch64-simd.md?ref=b5574232341729510334cfcec22a8c2bd153be12", "patch": "@@ -1611,6 +1611,15 @@\n   DONE;\n })\n \n+(define_insn \"clz<mode>2\"\n+ [(set (match_operand:VDQ_BHSI 0 \"register_operand\" \"=w\")\n+       (clz:VDQ_BHSI (match_operand:VDQ_BHSI 1 \"register_operand\" \"w\")))]\n+ \"TARGET_SIMD\"\n+ \"clz\\\\t%0.<Vtype>, %1.<Vtype>\"\n+ [(set_attr \"simd_type\" \"simd_cls\")\n+  (set_attr \"simd_mode\" \"<MODE>\")]\n+)\n+\n ;; 'across lanes' max and min ops.\n \n (define_insn \"reduc_<maxmin_uns>_<mode>\""}, {"sha": "50bb19bbd3e7fb0bc8fd16129fb43c72e57170f7", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b5574232341729510334cfcec22a8c2bd153be12/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b5574232341729510334cfcec22a8c2bd153be12/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=b5574232341729510334cfcec22a8c2bd153be12", "patch": "@@ -1,3 +1,7 @@\n+2013-05-23  Vidya Praveen <vidyapraveen@arm.com>\n+\n+\t* gcc.target/aarch64/vect-clz.c: New file.\n+\n 2013-05-22  Martin Jambor  <mjambor@suse.cz>\n \n \tPR middle-end/57347"}, {"sha": "8f1fe7090570dc564c2dfc5eb40b19397f572135", "filename": "gcc/testsuite/gcc.target/aarch64/vect-clz.c", "status": "added", "additions": 35, "deletions": 0, "changes": 35, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b5574232341729510334cfcec22a8c2bd153be12/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fvect-clz.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b5574232341729510334cfcec22a8c2bd153be12/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fvect-clz.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fvect-clz.c?ref=b5574232341729510334cfcec22a8c2bd153be12", "patch": "@@ -0,0 +1,35 @@\n+/* { dg-do run } */\n+/* { dg-options \"-O3 -save-temps -fno-inline\" } */\n+\n+extern void abort ();\n+\n+void\n+count_lz_v4si (unsigned *__restrict a, int *__restrict b)\n+{\n+  int i;\n+\n+  for (i = 0; i < 4; i++)\n+    b[i] = __builtin_clz (a[i]);\n+}\n+\n+/* { dg-final { scan-assembler \"clz\\tv\\[0-9\\]+\\.4s\" } } */\n+\n+int\n+main ()\n+{\n+  unsigned int x[4] = { 0x0, 0xFFFF, 0x1FFFF, 0xFFFFFFFF };\n+  int r[4] = { 32, 16, 15, 0 };\n+  int d[4], i;\n+\n+  count_lz_v4si (x, d);\n+\n+  for (i = 0; i < 4; i++)\n+    {\n+      if (d[i] != r[i])\n+\tabort ();\n+    }\n+\n+  return 0;\n+}\n+\n+/* { dg-final { cleanup-saved-temps } } */"}]}