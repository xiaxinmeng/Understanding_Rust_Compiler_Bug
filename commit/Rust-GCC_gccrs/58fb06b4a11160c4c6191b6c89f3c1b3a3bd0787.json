{"sha": "58fb06b4a11160c4c6191b6c89f3c1b3a3bd0787", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NThmYjA2YjRhMTExNjBjNGM2MTkxYjZjODlmM2MxYjNhM2JkMDc4Nw==", "commit": {"author": {"name": "Nathan Sidwell", "email": "nathan@codesourcery.com", "date": "2005-06-02T09:09:48Z"}, "committer": {"name": "Nathan Sidwell", "email": "nathan@gcc.gnu.org", "date": "2005-06-02T09:09:48Z"}, "message": "re PR c++/20350 (extern template and struct initializer and specification for a static variable)\n\ncp:\n\tPR c++/20350\n\t* decl.c (duplicate_decls): Copy all of DECL_USE_TEMPLATE.\ntestsuite:\n\tPR c++/20350\n\t* g++.dg/template/spec24.C: New.\n\nFrom-SVN: r100486", "tree": {"sha": "3bef40413e1c02198cbe7dcb8919b06a068781fb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3bef40413e1c02198cbe7dcb8919b06a068781fb"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/58fb06b4a11160c4c6191b6c89f3c1b3a3bd0787", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/58fb06b4a11160c4c6191b6c89f3c1b3a3bd0787", "html_url": "https://github.com/Rust-GCC/gccrs/commit/58fb06b4a11160c4c6191b6c89f3c1b3a3bd0787", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/58fb06b4a11160c4c6191b6c89f3c1b3a3bd0787/comments", "author": null, "committer": null, "parents": [{"sha": "ccb4e87e83e9f1e21ba9c79ce21f2d31dcf16a51", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ccb4e87e83e9f1e21ba9c79ce21f2d31dcf16a51", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ccb4e87e83e9f1e21ba9c79ce21f2d31dcf16a51"}], "stats": {"total": 43, "additions": 36, "deletions": 7}, "files": [{"sha": "1314bcfbc99941ac8b740c101ebda9ce38913302", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/58fb06b4a11160c4c6191b6c89f3c1b3a3bd0787/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/58fb06b4a11160c4c6191b6c89f3c1b3a3bd0787/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=58fb06b4a11160c4c6191b6c89f3c1b3a3bd0787", "patch": "@@ -1,5 +1,8 @@\n 2005-06-02  Nathan Sidwell  <nathan@codesourcery.com>\n \n+\tPR c++/20350\n+\t* decl.c (duplicate_decls): Copy all of DECL_USE_TEMPLATE.\n+\n \tPR c++/21151\n \t* name-lookup.c (pushtag): Push local class even in a template.\n "}, {"sha": "83bd6fc9324fc0945a31842ef487f0e5d10a1917", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 8, "deletions": 7, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/58fb06b4a11160c4c6191b6c89f3c1b3a3bd0787/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/58fb06b4a11160c4c6191b6c89f3c1b3a3bd0787/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=58fb06b4a11160c4c6191b6c89f3c1b3a3bd0787", "patch": "@@ -1672,13 +1672,14 @@ duplicate_decls (tree newdecl, tree olddecl)\n       DECL_COMDAT (newdecl) |= DECL_COMDAT (olddecl);\n       DECL_TEMPLATE_INSTANTIATED (newdecl)\n \t|= DECL_TEMPLATE_INSTANTIATED (olddecl);\n-      /* If the OLDDECL is an implicit instantiation, then the NEWDECL\n-\t must be too.  But, it may not yet be marked as such if the\n-\t caller has created NEWDECL, but has not yet figured out that\n-\t it is a redeclaration.  */\n-      if (DECL_IMPLICIT_INSTANTIATION (olddecl)\n-\t  && !DECL_USE_TEMPLATE (newdecl))\n-\tSET_DECL_IMPLICIT_INSTANTIATION (newdecl);\n+      \n+      /* If the OLDDECL is an instantiation and/or specialization,\n+\t then the NEWDECL must be too.  But, it may not yet be marked\n+\t as such if the caller has created NEWDECL, but has not yet\n+\t figured out that it is a redeclaration.  */\n+      if (!DECL_USE_TEMPLATE (newdecl))\n+\tDECL_USE_TEMPLATE (newdecl) = DECL_USE_TEMPLATE (olddecl);\n+      \n       /* Don't really know how much of the language-specific\n \t values we should copy from old to new.  */\n       DECL_IN_AGGR_P (newdecl) = DECL_IN_AGGR_P (olddecl);"}, {"sha": "47359036e3ada03670f3d204b7f69217190d6e7c", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/58fb06b4a11160c4c6191b6c89f3c1b3a3bd0787/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/58fb06b4a11160c4c6191b6c89f3c1b3a3bd0787/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=58fb06b4a11160c4c6191b6c89f3c1b3a3bd0787", "patch": "@@ -1,5 +1,8 @@\n 2005-06-02  Nathan Sidwell  <nathan@codesourcery.com>\n \n+\tPR c++/20350\n+\t* g++.dg/template/spec24.C: New.\n+\n \tPR c++/21151\n \t* g++.dg/pch/local-1.C: New.\n \t* g++.dg/pch/local-1.Hs: New."}, {"sha": "08848952e53a0849daac88610c58a054f809a36c", "filename": "gcc/testsuite/g++.dg/template/spec24.C", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/58fb06b4a11160c4c6191b6c89f3c1b3a3bd0787/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fspec24.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/58fb06b4a11160c4c6191b6c89f3c1b3a3bd0787/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fspec24.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fspec24.C?ref=58fb06b4a11160c4c6191b6c89f3c1b3a3bd0787", "patch": "@@ -0,0 +1,22 @@\n+// Copyright (C) 2005 Free Software Foundation, Inc.\n+// Contributed by Nathan Sidwell 1 June 2005 <nathan@codesourcery.com>\n+\n+// PR 20350: ICE on member specialization with later initialization\n+// Origin: Carlo Wood carlo@gcc.gnu.org\n+\n+template <int i> struct Mutex\n+{\n+  static int mutex;\n+};\n+\n+template <int i>\n+int Mutex<i>::mutex = {1};\n+\n+template <> int Mutex<0>::mutex;\n+template <> int Mutex<0>::mutex = 0;\n+\n+void g()\n+{\n+  Mutex<0>::mutex = 0;\n+}\n+"}]}