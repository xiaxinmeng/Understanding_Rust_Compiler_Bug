{"sha": "b91bc3493e27d85f69ec4374db5b50656974573f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjkxYmMzNDkzZTI3ZDg1ZjY5ZWM0Mzc0ZGI1YjUwNjU2OTc0NTczZg==", "commit": {"author": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2008-09-06T17:10:00Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2008-09-06T17:10:00Z"}, "message": "re PR tree-optimization/14703 (Inadequate optimization of inline templated functions, infinite loop in ipa-reference and memory hog)\n\n\tPR tree-optimization/14703\n\t* tree-ssa-live.c (remove_unused_scope_block_p): Remove ignored declarations.\n\t* passes.c (init_optimization_passes): Recompute inline parameters.\n\t* g++.dg/tree-ssa-pr14703.C: New testcase.\n\nFrom-SVN: r140068", "tree": {"sha": "3bfbb5a00dd14576ae24698df640f819605cdc0d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3bfbb5a00dd14576ae24698df640f819605cdc0d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b91bc3493e27d85f69ec4374db5b50656974573f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b91bc3493e27d85f69ec4374db5b50656974573f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b91bc3493e27d85f69ec4374db5b50656974573f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b91bc3493e27d85f69ec4374db5b50656974573f/comments", "author": null, "committer": null, "parents": [{"sha": "7a687b22659e54dfc9a6354b08b850d63bfd14c0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7a687b22659e54dfc9a6354b08b850d63bfd14c0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7a687b22659e54dfc9a6354b08b850d63bfd14c0"}], "stats": {"total": 67, "additions": 67, "deletions": 0}, "files": [{"sha": "ead7b5a701c494960f5400f5dd6cf670061f30b8", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b91bc3493e27d85f69ec4374db5b50656974573f/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b91bc3493e27d85f69ec4374db5b50656974573f/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=b91bc3493e27d85f69ec4374db5b50656974573f", "patch": "@@ -1,3 +1,9 @@\n+2008-09-06  Jan Hubicka  <jh@suse.cz>\n+\n+\tPR tree-optimization/14703\n+\t* tree-ssa-live.c (remove_unused_scope_block_p): Remove ignored declarations.\n+\t* passes.c (init_optimization_passes): Recompute inline parameters.\n+\n 2008-09-06  Richard Sandiford  <rdsandiford@googlemail.com>\n \n \t* config/mips/mips.c (mips_function_ok_for_sibcall): Check for"}, {"sha": "69d484b0226f1121a30b0f912ce24e437db8936f", "filename": "gcc/passes.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b91bc3493e27d85f69ec4374db5b50656974573f/gcc%2Fpasses.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b91bc3493e27d85f69ec4374db5b50656974573f/gcc%2Fpasses.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fpasses.c?ref=b91bc3493e27d85f69ec4374db5b50656974573f", "patch": "@@ -565,6 +565,7 @@ init_optimization_passes (void)\n \t}\n       NEXT_PASS (pass_release_ssa_names);\n       NEXT_PASS (pass_rebuild_cgraph_edges);\n+      NEXT_PASS (pass_inline_parameters);\n     }\n   NEXT_PASS (pass_ipa_increase_alignment);\n   NEXT_PASS (pass_ipa_matrix_reorg);"}, {"sha": "3185f30b73b496bba744d162ad4008e512c05736", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b91bc3493e27d85f69ec4374db5b50656974573f/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b91bc3493e27d85f69ec4374db5b50656974573f/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=b91bc3493e27d85f69ec4374db5b50656974573f", "patch": "@@ -1,3 +1,7 @@\n+2008-09-06  Jan Hubicka  <jh@suse.cz>\n+\n+\t* g++.dg/tree-ssa-pr14703.C: New testcase.\n+\n 2008-09-06  Tobias Burnus  <burnus@net-b.de>\n \n \tPR fortran/36153"}, {"sha": "58705277ec553f220a3ca30f18ae55356a3f7b07", "filename": "gcc/testsuite/g++.dg/tree-ssa/pr14703.C", "status": "added", "additions": 49, "deletions": 0, "changes": 49, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b91bc3493e27d85f69ec4374db5b50656974573f/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftree-ssa%2Fpr14703.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b91bc3493e27d85f69ec4374db5b50656974573f/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftree-ssa%2Fpr14703.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftree-ssa%2Fpr14703.C?ref=b91bc3493e27d85f69ec4374db5b50656974573f", "patch": "@@ -0,0 +1,49 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -fdump-tree-optimized -fno-ipa-reference\" } */\n+#include <iostream>\n+\n+namespace {\n+template <unsigned long long L> class fib {\n+ public:\n+   static const unsigned long long value = fib<L - 1>::value + fib<L - 2>::value;\n+};\n+\n+template <> class fib<0> {\n+ public:\n+   static const unsigned long long value = 1;\n+};\n+\n+template <> class fib<1> {\n+ public:\n+   static const unsigned long long value = 1;\n+};\n+\n+template<unsigned long long L> inline unsigned long long fibconst()\n+{\n+   return fibconst<L - 1>() + fibconst<L - 2>();\n+}\n+\n+template <> inline unsigned long long fibconst<0>()\n+{\n+   return 1ull;\n+}\n+\n+template <> inline unsigned long long fibconst<1>()\n+{\n+   return 1ull;\n+}\n+\n+template <> inline unsigned long long fibconst<2>()\n+{\n+   return 2ull;\n+}\n+\n+}\n+\n+int main()\n+{\n+   ::std::cerr << \"fib<90>::value == \" << fib<90>::value << \"\\n\";\n+   ::std::cerr << \"fibcst<90>() == \" << fibconst<90>() << \"\\n\";\n+}\n+// { dg-final { scan-tree-dump-not \"fibconst\" \"optimized\" } }\n+// { dg-final { cleanup-tree-dump \"optimized\" } }"}, {"sha": "859c0c7427de1b7855c16b6cb03b9007917b9328", "filename": "gcc/tree-ssa-live.c", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b91bc3493e27d85f69ec4374db5b50656974573f/gcc%2Ftree-ssa-live.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b91bc3493e27d85f69ec4374db5b50656974573f/gcc%2Ftree-ssa-live.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-live.c?ref=b91bc3493e27d85f69ec4374db5b50656974573f", "patch": "@@ -489,6 +489,13 @@ remove_unused_scope_block_p (tree scope)\n       if (TREE_CODE (*t) == FUNCTION_DECL)\n \tunused = false;\n \n+      /* Remove everything we don't generate debug info for.  */\n+      else if (DECL_IGNORED_P (*t))\n+\t{\n+\t  *t = TREE_CHAIN (*t);\n+\t  next = t;\n+\t}\n+\n       /* When we are outputting debug info, we usually want to output\n \t info about optimized-out variables in the scope blocks.\n \t Exception are the scope blocks not containing any instructions"}]}