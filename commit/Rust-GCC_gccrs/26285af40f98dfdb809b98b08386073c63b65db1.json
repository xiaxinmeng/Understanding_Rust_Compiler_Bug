{"sha": "26285af40f98dfdb809b98b08386073c63b65db1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjYyODVhZjQwZjk4ZGZkYjgwOWI5OGIwODM4NjA3M2M2M2I2NWRiMQ==", "commit": {"author": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2020-11-15T14:10:22Z"}, "committer": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2020-11-15T14:10:22Z"}, "message": "Mare return to clear EAF_UNUSED flag.\n\ngcc/ChangeLog:\n\t* ipa-modref.c (analyze_ssa_name_flags): Make return to clear\n\tEAF_UNUSED flag.\n\ngcc/testsuite/ChangeLog:\n\t* gcc.c-torture/execute/pr97836.c: New test.", "tree": {"sha": "ac280fe6d1d81b16c828e96aa28b39d96bd40d31", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ac280fe6d1d81b16c828e96aa28b39d96bd40d31"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/26285af40f98dfdb809b98b08386073c63b65db1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/26285af40f98dfdb809b98b08386073c63b65db1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/26285af40f98dfdb809b98b08386073c63b65db1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/26285af40f98dfdb809b98b08386073c63b65db1/comments", "author": null, "committer": null, "parents": [{"sha": "faab61b585a8b4a42454f085dd6b7815992a98f5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/faab61b585a8b4a42454f085dd6b7815992a98f5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/faab61b585a8b4a42454f085dd6b7815992a98f5"}], "stats": {"total": 23, "additions": 21, "deletions": 2}, "files": [{"sha": "4a43c50aa661c218acd3fa47c562ea89508d8b2a", "filename": "gcc/ipa-modref.c", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/26285af40f98dfdb809b98b08386073c63b65db1/gcc%2Fipa-modref.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/26285af40f98dfdb809b98b08386073c63b65db1/gcc%2Fipa-modref.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-modref.c?ref=26285af40f98dfdb809b98b08386073c63b65db1", "patch": "@@ -1224,10 +1224,12 @@ analyze_ssa_name_flags (tree name, vec<unsigned char> &known_flags, int depth)\n \t  print_gimple_stmt (dump_file, use_stmt, 0);\n \t}\n \n-      /* Gimple return may load the return value.  */\n+      /* Gimple return may load the return value.\n+\t Returning name counts as an use by tree-ssa-structalias.c  */\n       if (greturn *ret = dyn_cast <greturn *> (use_stmt))\n \t{\n-\t  if (memory_access_to (gimple_return_retval (ret), name))\n+\t  if (memory_access_to (gimple_return_retval (ret), name)\n+\t      || name == gimple_return_retval (ret))\n \t    flags &= ~EAF_UNUSED;\n \t}\n       /* Account for LHS store, arg loads and flags from callee function.  */"}, {"sha": "4585e1fc69d27ac7c3b66e3396b0b99c6a086d3d", "filename": "gcc/testsuite/gcc.c-torture/execute/pr97836.c", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/26285af40f98dfdb809b98b08386073c63b65db1/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fpr97836.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/26285af40f98dfdb809b98b08386073c63b65db1/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fpr97836.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fpr97836.c?ref=26285af40f98dfdb809b98b08386073c63b65db1", "patch": "@@ -0,0 +1,17 @@\n+int a;\n+\n+int b(int c) { return 0; }\n+\n+static int *d(int *e) {\n+  if (a) {\n+    a = a && b(*e);\n+  }\n+  return e;\n+}\n+\n+int main() {\n+  int f;\n+  if (d(&f) != &f)\n+    __builtin_abort();\n+  return 0;\n+}"}]}