{"sha": "da71e18caeb8bcc6c85c7785c137ee0f99516fb4", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZGE3MWUxOGNhZWI4YmNjNmM4NWM3Nzg1YzEzN2VlMGY5OTUxNmZiNA==", "commit": {"author": {"name": "Mark Mitchell", "email": "mark@codesourcery.com", "date": "2006-06-17T01:11:34Z"}, "committer": {"name": "Mark Mitchell", "email": "mmitchel@gcc.gnu.org", "date": "2006-06-17T01:11:34Z"}, "message": "re PR c++/28016 (emitting template constant)\n\n\tPR c++/28016\n\t* decl.c (cp_finsh_decl): Do not emit uninstantiated static data\n\tmembers.\n\tPR c++/28016\n\t* g++.dg/template/static26.C: New test.\n\nFrom-SVN: r114739", "tree": {"sha": "28e7fb3f20c1c3914005cd91aa051226755c2675", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/28e7fb3f20c1c3914005cd91aa051226755c2675"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/da71e18caeb8bcc6c85c7785c137ee0f99516fb4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/da71e18caeb8bcc6c85c7785c137ee0f99516fb4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/da71e18caeb8bcc6c85c7785c137ee0f99516fb4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/da71e18caeb8bcc6c85c7785c137ee0f99516fb4/comments", "author": null, "committer": null, "parents": [{"sha": "18defd42d7eb850af6646a270a4753b9d5f18aaf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/18defd42d7eb850af6646a270a4753b9d5f18aaf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/18defd42d7eb850af6646a270a4753b9d5f18aaf"}], "stats": {"total": 34, "additions": 26, "deletions": 8}, "files": [{"sha": "2cbadcfd11f44ef58a03285fb60c4b4f75f530aa", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/da71e18caeb8bcc6c85c7785c137ee0f99516fb4/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/da71e18caeb8bcc6c85c7785c137ee0f99516fb4/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=da71e18caeb8bcc6c85c7785c137ee0f99516fb4", "patch": "@@ -1,5 +1,9 @@\n 2006-06-16  Mark Mitchell  <mark@codesourcery.com>\n \n+\tPR c++/28016\n+\t* decl.c (cp_finsh_decl): Do not emit uninstantiated static data\n+\tmembers.\n+\n \tPR c++/27979\n \t* call.c (standard_conversion): Strip cv-qualifiers from bitfield\n \ttypes."}, {"sha": "c80111145bd8dbdb7e5c647fe37ca60aac3adf62", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 9, "deletions": 8, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/da71e18caeb8bcc6c85c7785c137ee0f99516fb4/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/da71e18caeb8bcc6c85c7785c137ee0f99516fb4/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=da71e18caeb8bcc6c85c7785c137ee0f99516fb4", "patch": "@@ -5207,16 +5207,17 @@ cp_finish_decl (tree decl, tree init, bool init_const_expr_p,\n   if (at_function_scope_p ())\n     add_decl_expr (decl);\n \n-  if (TREE_CODE (decl) == VAR_DECL)\n-    layout_var_decl (decl);\n-\n-  /* Output the assembler code and/or RTL code for variables and functions,\n-     unless the type is an undefined structure or union.\n-     If not, it will get done when the type is completed.  */\n-  if (TREE_CODE (decl) == VAR_DECL || TREE_CODE (decl) == FUNCTION_DECL)\n+  /* Let the middle end know about variables and functions -- but not\n+     static data members in uninstantiated class templates.  */\n+  if (!saved_processing_template_decl\n+      && (TREE_CODE (decl) == VAR_DECL \n+\t  || TREE_CODE (decl) == FUNCTION_DECL))\n     {\n       if (TREE_CODE (decl) == VAR_DECL)\n-\tmaybe_commonize_var (decl);\n+\t{\n+\t  layout_var_decl (decl);\n+\t  maybe_commonize_var (decl);\n+\t}\n \n       make_rtl_for_nonlocal_decl (decl, init, asmspec);\n "}, {"sha": "fe2b7e8b39839a18f4a1121422523a77f96fd11d", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/da71e18caeb8bcc6c85c7785c137ee0f99516fb4/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/da71e18caeb8bcc6c85c7785c137ee0f99516fb4/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=da71e18caeb8bcc6c85c7785c137ee0f99516fb4", "patch": "@@ -1,5 +1,8 @@\n 2006-06-16  Mark Mitchell  <mark@codesourcery.com>\n \n+\tPR c++/28016\n+\t* g++.dg/template/static26.C: New test.\n+\n \tPR c++/27979\n \t* g++.dg/expr/bitfield2.C: New test. \n "}, {"sha": "095248bace4dde079fa230fdeb955fdf6fdb8fe5", "filename": "gcc/testsuite/g++.dg/template/static26.C", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/da71e18caeb8bcc6c85c7785c137ee0f99516fb4/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fstatic26.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/da71e18caeb8bcc6c85c7785c137ee0f99516fb4/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fstatic26.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fstatic26.C?ref=da71e18caeb8bcc6c85c7785c137ee0f99516fb4", "patch": "@@ -0,0 +1,10 @@\n+// PR c++/28016\n+// { dg-final { scan-assembler-not \"computed\" } }\n+\n+template<class T1, class T2>\n+struct scalar_divides_assign {\n+  static const bool computed ;\n+};\n+\n+template<class T1, class T2>\n+const bool scalar_divides_assign<T1,T2>::computed = true;"}]}