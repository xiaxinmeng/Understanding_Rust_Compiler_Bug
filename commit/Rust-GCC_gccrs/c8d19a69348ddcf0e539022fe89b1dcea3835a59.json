{"sha": "c8d19a69348ddcf0e539022fe89b1dcea3835a59", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzhkMTlhNjkzNDhkZGNmMGU1MzkwMjJmZTg5YjFkY2VhMzgzNWE1OQ==", "commit": {"author": {"name": "David Malcolm", "email": "dmalcolm@redhat.com", "date": "2014-12-01T17:22:19Z"}, "committer": {"name": "David Malcolm", "email": "dmalcolm@gcc.gnu.org", "date": "2014-12-01T17:22:19Z"}, "message": "PR jit/63854: Fix leak within jit-builtins.c\n\ngcc/jit/ChangeLog:\n\tPR jit/63854\n\t* jit-builtins.c\n\t(gcc::jit::recording::builtins_manager::make_fn_type): Call the\n\tcontext's new_function_type method, rather than directly creating\n\ta function_type instance.\n\t* jit-recording.c\n\t(gcc::jit::recording::context::new_function_type): New method,\n\tadapted from part of...\n\t(gcc::jit::recording::context::new_function_ptr_type): ...this.\n\tUpdate to call new_function_type.\n\t* jit-recording.h\n\t(gcc::jit::recording::context::new_function_type): New method.\n\nFrom-SVN: r218231", "tree": {"sha": "990760a012debff08c2e3175f91ef5fd8c611529", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/990760a012debff08c2e3175f91ef5fd8c611529"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c8d19a69348ddcf0e539022fe89b1dcea3835a59", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c8d19a69348ddcf0e539022fe89b1dcea3835a59", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c8d19a69348ddcf0e539022fe89b1dcea3835a59", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c8d19a69348ddcf0e539022fe89b1dcea3835a59/comments", "author": {"login": "davidmalcolm", "id": 1553248, "node_id": "MDQ6VXNlcjE1NTMyNDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1553248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidmalcolm", "html_url": "https://github.com/davidmalcolm", "followers_url": "https://api.github.com/users/davidmalcolm/followers", "following_url": "https://api.github.com/users/davidmalcolm/following{/other_user}", "gists_url": "https://api.github.com/users/davidmalcolm/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidmalcolm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidmalcolm/subscriptions", "organizations_url": "https://api.github.com/users/davidmalcolm/orgs", "repos_url": "https://api.github.com/users/davidmalcolm/repos", "events_url": "https://api.github.com/users/davidmalcolm/events{/privacy}", "received_events_url": "https://api.github.com/users/davidmalcolm/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "9370adeb9da5071af3685adbd697784bdd349cc9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9370adeb9da5071af3685adbd697784bdd349cc9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9370adeb9da5071af3685adbd697784bdd349cc9"}], "stats": {"total": 63, "additions": 51, "deletions": 12}, "files": [{"sha": "c103eb2045c9b4fb9ed69b4bdee1c5f067884129", "filename": "gcc/jit/ChangeLog", "status": "modified", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c8d19a69348ddcf0e539022fe89b1dcea3835a59/gcc%2Fjit%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c8d19a69348ddcf0e539022fe89b1dcea3835a59/gcc%2Fjit%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjit%2FChangeLog?ref=c8d19a69348ddcf0e539022fe89b1dcea3835a59", "patch": "@@ -1,3 +1,18 @@\n+2014-12-01  David Malcolm  <dmalcolm@redhat.com>\n+\n+\tPR jit/63854\n+\t* jit-builtins.c\n+\t(gcc::jit::recording::builtins_manager::make_fn_type): Call the\n+\tcontext's new_function_type method, rather than directly creating\n+\ta function_type instance.\n+\t* jit-recording.c\n+\t(gcc::jit::recording::context::new_function_type): New method,\n+\tadapted from part of...\n+\t(gcc::jit::recording::context::new_function_ptr_type): ...this.\n+\tUpdate to call new_function_type.\n+\t* jit-recording.h\n+\t(gcc::jit::recording::context::new_function_type): New method.\n+\n 2014-12-01  David Malcolm  <dmalcolm@redhat.com>\n \n \tPR jit/63969"}, {"sha": "49d37d8f73ab7a03d43f94aa8c498efe90c90323", "filename": "gcc/jit/jit-builtins.c", "status": "modified", "additions": 4, "deletions": 5, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c8d19a69348ddcf0e539022fe89b1dcea3835a59/gcc%2Fjit%2Fjit-builtins.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c8d19a69348ddcf0e539022fe89b1dcea3835a59/gcc%2Fjit%2Fjit-builtins.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjit%2Fjit-builtins.c?ref=c8d19a69348ddcf0e539022fe89b1dcea3835a59", "patch": "@@ -398,11 +398,10 @@ builtins_manager::make_fn_type (enum jit_builtin_type,\n   if (!return_type)\n     goto error;\n \n-  result = new function_type (m_ctxt,\n-\t\t\t      return_type,\n-\t\t\t      num_args,\n-\t\t\t      param_types,\n-\t\t\t      is_variadic);\n+  result = m_ctxt->new_function_type (return_type,\n+\t\t\t\t      num_args,\n+\t\t\t\t      param_types,\n+\t\t\t\t      is_variadic);\n \n  error:\n   delete[] param_types;"}, {"sha": "32bf03455291056cdbce331f6d452e6e254da9f7", "filename": "gcc/jit/jit-recording.c", "status": "modified", "additions": 26, "deletions": 7, "changes": 33, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c8d19a69348ddcf0e539022fe89b1dcea3835a59/gcc%2Fjit%2Fjit-recording.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c8d19a69348ddcf0e539022fe89b1dcea3835a59/gcc%2Fjit%2Fjit-recording.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjit%2Fjit-recording.c?ref=c8d19a69348ddcf0e539022fe89b1dcea3835a59", "patch": "@@ -492,6 +492,27 @@ recording::context::new_union_type (recording::location *loc,\n   return result;\n }\n \n+/* Create a recording::function_type instance and add it to this context's\n+   list of mementos.\n+\n+   Used by new_function_ptr_type and by builtins_manager::make_fn_type.  */\n+\n+recording::function_type *\n+recording::context::new_function_type (recording::type *return_type,\n+\t\t\t\t       int num_params,\n+\t\t\t\t       recording::type **param_types,\n+\t\t\t\t       int is_variadic)\n+{\n+  recording::function_type *fn_type\n+    = new function_type (this,\n+\t\t\t return_type,\n+\t\t\t num_params,\n+\t\t\t param_types,\n+\t\t\t is_variadic);\n+  record (fn_type);\n+  return fn_type;\n+}\n+\n /* Create a recording::type instance and add it to this context's list\n    of mementos.\n \n@@ -505,13 +526,11 @@ recording::context::new_function_ptr_type (recording::location *, /* unused loc\n \t\t\t\t\t   recording::type **param_types,\n \t\t\t\t\t   int is_variadic)\n {\n-  recording::function_type *fn_type =\n-    new function_type (this,\n-\t\t       return_type,\n-\t\t       num_params,\n-\t\t       param_types,\n-\t\t       is_variadic);\n-  record (fn_type);\n+  recording::function_type *fn_type\n+    = new_function_type (return_type,\n+\t\t\t num_params,\n+\t\t\t param_types,\n+\t\t\t is_variadic);\n \n   /* Return a pointer-type to the the function type.  */\n   return fn_type->get_pointer ();"}, {"sha": "9b2cfc67f3c882af6dfc56d4f12f6eb82173e792", "filename": "gcc/jit/jit-recording.h", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c8d19a69348ddcf0e539022fe89b1dcea3835a59/gcc%2Fjit%2Fjit-recording.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c8d19a69348ddcf0e539022fe89b1dcea3835a59/gcc%2Fjit%2Fjit-recording.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjit%2Fjit-recording.h?ref=c8d19a69348ddcf0e539022fe89b1dcea3835a59", "patch": "@@ -88,6 +88,12 @@ class context\n   new_union_type (location *loc,\n \t\t  const char *name);\n \n+  function_type *\n+  new_function_type (type *return_type,\n+\t\t     int num_params,\n+\t\t     type **param_types,\n+\t\t     int is_variadic);\n+\n   type *\n   new_function_ptr_type (location *loc,\n \t\t\t type *return_type,"}]}