{"sha": "f5a7af7d1740aa9ab00bc3ce07099b0627485859", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjVhN2FmN2QxNzQwYWE5YWIwMGJjM2NlMDcwOTliMDYyNzQ4NTg1OQ==", "commit": {"author": {"name": "Martin Jambor", "email": "mjambor@suse.cz", "date": "2010-11-10T12:52:27Z"}, "committer": {"name": "Martin Jambor", "email": "jamborm@gcc.gnu.org", "date": "2010-11-10T12:52:27Z"}, "message": "re PR tree-optimization/46351 (incorrect scalarization (2))\n\n2010-11-10  Martin Jambor  <mjambor@suse.cz>\n\n\tPR tree-optimization/46351\n\tPR tree-optimization/46377\n\t* tree-sra.c (type_internals_preclude_sra_p): Disqualify types with\n\taggregate bit-fields.\n\n\t* testsuite/gnat.dg/opt10.adb: New file.\n\t* testsuite/gnat.dg/opt10_pkg.ads: Likewise.\n\t* testsuite/gnat.dg/opt11.adb: Likewise.\n\t* testsuite/gnat.dg/opt11.ads: Likewise.\n\nFrom-SVN: r166535", "tree": {"sha": "6a13859190b80983b87e28b30fb5d6a3348396f1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6a13859190b80983b87e28b30fb5d6a3348396f1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f5a7af7d1740aa9ab00bc3ce07099b0627485859", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f5a7af7d1740aa9ab00bc3ce07099b0627485859", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f5a7af7d1740aa9ab00bc3ce07099b0627485859", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f5a7af7d1740aa9ab00bc3ce07099b0627485859/comments", "author": {"login": "jamborm", "id": 2180070, "node_id": "MDQ6VXNlcjIxODAwNzA=", "avatar_url": "https://avatars.githubusercontent.com/u/2180070?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jamborm", "html_url": "https://github.com/jamborm", "followers_url": "https://api.github.com/users/jamborm/followers", "following_url": "https://api.github.com/users/jamborm/following{/other_user}", "gists_url": "https://api.github.com/users/jamborm/gists{/gist_id}", "starred_url": "https://api.github.com/users/jamborm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jamborm/subscriptions", "organizations_url": "https://api.github.com/users/jamborm/orgs", "repos_url": "https://api.github.com/users/jamborm/repos", "events_url": "https://api.github.com/users/jamborm/events{/privacy}", "received_events_url": "https://api.github.com/users/jamborm/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "2be55a2540b291312898ad5500d20b7b64ba012c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2be55a2540b291312898ad5500d20b7b64ba012c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2be55a2540b291312898ad5500d20b7b64ba012c"}], "stats": {"total": 88, "additions": 87, "deletions": 1}, "files": [{"sha": "c14885e1aec6999d880dc91eb75191fcb044412f", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f5a7af7d1740aa9ab00bc3ce07099b0627485859/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f5a7af7d1740aa9ab00bc3ce07099b0627485859/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=f5a7af7d1740aa9ab00bc3ce07099b0627485859", "patch": "@@ -1,3 +1,10 @@\n+2010-11-10  Martin Jambor  <mjambor@suse.cz>\n+\n+\tPR tree-optimization/46351\n+\tPR tree-optimization/46377\n+\t* tree-sra.c (type_internals_preclude_sra_p): Disqualify types with\n+\taggregate bit-fields.\n+\n 2010-11-10  Joseph Myers  <joseph@codesourcery.com>\n \n \t* doc/tm.texi.in (TARGET_OPTION_TRANSLATE_TABLE): Remove."}, {"sha": "0345145900460060aaf798e6d2618d6776d92106", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f5a7af7d1740aa9ab00bc3ce07099b0627485859/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f5a7af7d1740aa9ab00bc3ce07099b0627485859/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=f5a7af7d1740aa9ab00bc3ce07099b0627485859", "patch": "@@ -1,3 +1,12 @@\n+2010-11-10  Martin Jambor  <mjambor@suse.cz>\n+\n+\tPR tree-optimization/46351\n+\tPR tree-optimization/46377\n+\t* gnat.dg/opt10.adb: New file.\n+\t* gnat.dg/opt10_pkg.ads: Likewise.\n+\t* gnat.dg/opt11.adb: Likewise.\n+\t* gnat.dg/opt11.ads: Likewise.\n+\n 2010-11-10  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* gnat.dg/boolean_conv.adb: New test."}, {"sha": "cb3cb0db3676c653fc0d4b2af1c72af37c408aee", "filename": "gcc/testsuite/gnat.dg/opt10.adb", "status": "added", "additions": 26, "deletions": 0, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f5a7af7d1740aa9ab00bc3ce07099b0627485859/gcc%2Ftestsuite%2Fgnat.dg%2Fopt10.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f5a7af7d1740aa9ab00bc3ce07099b0627485859/gcc%2Ftestsuite%2Fgnat.dg%2Fopt10.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fopt10.adb?ref=f5a7af7d1740aa9ab00bc3ce07099b0627485859", "patch": "@@ -0,0 +1,26 @@\n+-- { dg-do compile }\n+-- { dg-options \"-O2 }\n+\n+with Opt10_Pkg; use Opt10_Pkg;\n+\n+procedure Opt10 is\n+\n+   procedure Compare_Rep_Data (MA, MB : Rep_Message) is\n+   begin\n+      if MA.Data /= MB.Data then\n+         raise Program_Error;\n+      end if;\n+   end;\n+\n+   procedure Check_Rep_For (Bit : Boolean) is\n+      MA, MB : Rep_Message;\n+   begin\n+      Safe_Assign (MA, Bit);\n+      Safe_Assign (MB, Bit);\n+      Compare_Rep_Data (MA, MB);\n+   end;\n+\n+begin\n+   Check_Rep_For (Bit => False);\n+end;\n+"}, {"sha": "8df6dca173da5a97666cbaee8cb53e0fc16e3cc8", "filename": "gcc/testsuite/gnat.dg/opt10_pkg.ads", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f5a7af7d1740aa9ab00bc3ce07099b0627485859/gcc%2Ftestsuite%2Fgnat.dg%2Fopt10_pkg.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f5a7af7d1740aa9ab00bc3ce07099b0627485859/gcc%2Ftestsuite%2Fgnat.dg%2Fopt10_pkg.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fopt10_pkg.ads?ref=f5a7af7d1740aa9ab00bc3ce07099b0627485859", "patch": "@@ -0,0 +1,14 @@\n+package Opt10_Pkg is\n+\n+   type Rep_Message is record\n+      Bit : Boolean;\n+      Data : String (1 .. 4);\n+   end record;\n+   for Rep_Message use record\n+      Bit  at 0 range 0 .. 0;\n+      Data at 0 range 1 .. 32;\n+   end record;\n+\n+   procedure Safe_Assign (M : in out Rep_Message; Bit : Boolean);\n+\n+end;"}, {"sha": "dca4804ceee98d7123e6816a2e3753ee075f302a", "filename": "gcc/testsuite/gnat.dg/opt11.adb", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f5a7af7d1740aa9ab00bc3ce07099b0627485859/gcc%2Ftestsuite%2Fgnat.dg%2Fopt11.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f5a7af7d1740aa9ab00bc3ce07099b0627485859/gcc%2Ftestsuite%2Fgnat.dg%2Fopt11.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fopt11.adb?ref=f5a7af7d1740aa9ab00bc3ce07099b0627485859", "patch": "@@ -0,0 +1,12 @@\n+-- { dg-compile }\n+-- { dg-options \"-O\" }\n+\n+package body Opt11 is\n+\n+   procedure Proc is\n+      R : Rec;\n+   begin\n+      R := (others => <>);\n+   end;\n+\n+end Opt11;"}, {"sha": "983bf264302d6a5133e70a93650797016726ddd6", "filename": "gcc/testsuite/gnat.dg/opt11.ads", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f5a7af7d1740aa9ab00bc3ce07099b0627485859/gcc%2Ftestsuite%2Fgnat.dg%2Fopt11.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f5a7af7d1740aa9ab00bc3ce07099b0627485859/gcc%2Ftestsuite%2Fgnat.dg%2Fopt11.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fopt11.ads?ref=f5a7af7d1740aa9ab00bc3ce07099b0627485859", "patch": "@@ -0,0 +1,17 @@\n+package Opt11 is\n+\n+   type String_Ptr is access constant String;\n+\n+   type Form_Type is (Qualified, Unqualified);\n+\n+   type Rec is record\n+      N1, N2, N3 : Natural;\n+      Fixed : String_Ptr;\n+      Form : Form_Type;\n+      Is_Local : Boolean := True;\n+   end record;\n+   pragma Pack (Rec);\n+\n+   procedure Proc;\n+\n+end Opt11;"}, {"sha": "be1b45e6b9ca0db20b068dbf9eab5dc757c9f2eb", "filename": "gcc/tree-sra.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f5a7af7d1740aa9ab00bc3ce07099b0627485859/gcc%2Ftree-sra.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f5a7af7d1740aa9ab00bc3ce07099b0627485859/gcc%2Ftree-sra.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-sra.c?ref=f5a7af7d1740aa9ab00bc3ce07099b0627485859", "patch": "@@ -653,7 +653,8 @@ type_internals_preclude_sra_p (tree type)\n \t    if (TREE_THIS_VOLATILE (fld)\n \t\t|| !DECL_FIELD_OFFSET (fld) || !DECL_SIZE (fld)\n \t\t|| !host_integerp (DECL_FIELD_OFFSET (fld), 1)\n-\t\t|| !host_integerp (DECL_SIZE (fld), 1))\n+\t\t|| !host_integerp (DECL_SIZE (fld), 1)\n+\t\t|| (DECL_BIT_FIELD (fld) && AGGREGATE_TYPE_P (ft)))\n \t      return true;\n \n \t    if (AGGREGATE_TYPE_P (ft)"}]}