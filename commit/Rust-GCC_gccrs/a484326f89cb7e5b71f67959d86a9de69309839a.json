{"sha": "a484326f89cb7e5b71f67959d86a9de69309839a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTQ4NDMyNmY4OWNiN2U1YjcxZjY3OTU5ZDg2YTlkZTY5MzA5ODM5YQ==", "commit": {"author": {"name": "Paolo Carlini", "email": "pcarlini@suse.de", "date": "2006-10-09T18:04:18Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2006-10-09T18:04:18Z"}, "message": "PR libstdc++/28277 (partial: __add_grouping)\n\n2006-10-09  Paolo Carlini  <pcarlini@suse.de>\n\n\tPR libstdc++/28277 (partial: __add_grouping)\n\t* include/bits/locale_facets.tcc (__add_grouping<>(_CharT*, _CharT,\n\tconst char*, size_t, const _CharT*, const _CharT*)): Rewrite in\n\tnon-recursive form.\n\nFrom-SVN: r117581", "tree": {"sha": "d42e04b5261647f911ed3c32db81cfe0582b7b02", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d42e04b5261647f911ed3c32db81cfe0582b7b02"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a484326f89cb7e5b71f67959d86a9de69309839a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a484326f89cb7e5b71f67959d86a9de69309839a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a484326f89cb7e5b71f67959d86a9de69309839a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a484326f89cb7e5b71f67959d86a9de69309839a/comments", "author": null, "committer": null, "parents": [{"sha": "a98d4769d5d5449e3ed3a524143b37e6c8a045ec", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a98d4769d5d5449e3ed3a524143b37e6c8a045ec", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a98d4769d5d5449e3ed3a524143b37e6c8a045ec"}], "stats": {"total": 41, "additions": 31, "deletions": 10}, "files": [{"sha": "f9123f136f1c1228771c6ce7d45e00897cd43495", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a484326f89cb7e5b71f67959d86a9de69309839a/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a484326f89cb7e5b71f67959d86a9de69309839a/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=a484326f89cb7e5b71f67959d86a9de69309839a", "patch": "@@ -1,3 +1,10 @@\n+2006-10-09  Paolo Carlini  <pcarlini@suse.de>\n+\n+\tPR libstdc++/28277 (partial: __add_grouping)\n+\t* include/bits/locale_facets.tcc (__add_grouping<>(_CharT*, _CharT,\n+\tconst char*, size_t, const _CharT*, const _CharT*)): Rewrite in\n+\tnon-recursive form.\n+\n 2006-10-09  Paolo Carlini  <pcarlini@suse.de>\n \n \tPR libstdc++/28277 (partial: money_put bits)"}, {"sha": "49c64a11add0f15cc81ea8dbb4030996c7dc0143", "filename": "libstdc++-v3/include/bits/locale_facets.tcc", "status": "modified", "additions": 24, "deletions": 10, "changes": 34, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a484326f89cb7e5b71f67959d86a9de69309839a/libstdc%2B%2B-v3%2Finclude%2Fbits%2Flocale_facets.tcc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a484326f89cb7e5b71f67959d86a9de69309839a/libstdc%2B%2B-v3%2Finclude%2Fbits%2Flocale_facets.tcc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Flocale_facets.tcc?ref=a484326f89cb7e5b71f67959d86a9de69309839a", "patch": "@@ -2590,19 +2590,33 @@ _GLIBCXX_END_LDBL_NAMESPACE\n \t\t   const char* __gbeg, size_t __gsize,\n \t\t   const _CharT* __first, const _CharT* __last)\n     {\n-      if (__last - __first > *__gbeg\n-\t  && static_cast<signed char>(*__gbeg) > 0)\n+      size_t __idx = 0;\n+      size_t __ctr = 0;\n+\n+      while (__last - __first > __gbeg[__idx]\n+\t     && static_cast<signed char>(__gbeg[__idx]) > 0)\n \t{\n-\t  const bool __bump = __gsize != 1;\n-\t  __s = std::__add_grouping(__s,  __sep, __gbeg + __bump,\n-\t\t\t\t    __gsize - __bump, __first,\n-\t\t\t\t    __last - *__gbeg);\n-\t  __first = __last - *__gbeg;\n-\t  *__s++ = __sep;\n+\t  __last -= __gbeg[__idx];\n+\t  __idx < __gsize - 1 ? ++__idx : ++__ctr;\n \t}\n-      do\n+\n+      while (__first != __last)\n \t*__s++ = *__first++;\n-      while (__first != __last);\n+\n+      while (__ctr--)\n+\t{\n+\t  *__s++ = __sep;\t  \n+\t  for (char __i = __gbeg[__idx]; __i > 0; --__i)\n+\t    *__s++ = *__first++;\n+\t}\n+\n+      while (__idx--)\n+\t{\n+\t  *__s++ = __sep;\t  \n+\t  for (char __i = __gbeg[__idx]; __i > 0; --__i)\n+\t    *__s++ = *__first++;\n+\t}\n+\n       return __s;\n     }\n "}]}