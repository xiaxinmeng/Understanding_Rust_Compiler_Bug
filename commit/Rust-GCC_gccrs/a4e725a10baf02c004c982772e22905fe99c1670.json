{"sha": "a4e725a10baf02c004c982772e22905fe99c1670", "node_id": "C_kwDOANBUbNoAKGE0ZTcyNWExMGJhZjAyYzAwNGM5ODI3NzJlMjI5MDVmZTk5YzE2NzA", "commit": {"author": {"name": "Stefan Schulze Frielinghaus", "email": "stefansf@linux.ibm.com", "date": "2023-01-24T19:23:07Z"}, "committer": {"name": "Stefan Schulze Frielinghaus", "email": "stefansf@linux.ibm.com", "date": "2023-01-24T19:23:07Z"}, "message": "IBM zSystems: Fix TARGET_D_CPU_VERSIONS\n\nIn the context of D the interpretation of S390, S390X, and SystemZ is a\nbit fuzzy.  The wording S390X was wrongly deprecated in favour of\nSystemZ by commit\nhttps://github.com/dlang/dlang.org/commit/3b50a4c3faf01c32234d0ef8be5f82915a61c23f\nThus, SystemZ is used for 64-bit targets, now, and S390 for 31-bit\ntargets.  However, in TARGET_D_CPU_VERSIONS depending on TARGET_ZARCH we\nset the CPU version to SystemZ.  This is also the case if compiled for\n31-bit targets leading to the following error:\n\nlibphobos/libdruntime/core/sys/posix/sys/stat.d:967:13: error: static assert:  '96u == 144u' is false\n  967 |             static assert(stat_t.sizeof == 144);\n      |             ^\n\nThus in order to keep this patch simple I went for keeping SystemZ for\n64-bit targets and S390, as usual, for 31-bit targets and dropped the\ndistinction between ESA and z/Architecture.\n\ngcc/ChangeLog:\n\n\t* config/s390/s390-d.cc (s390_d_target_versions): Fix detection\n\tof CPU version.", "tree": {"sha": "feebb88c13ba48b0cbeadb8a328d3ded3982a08b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/feebb88c13ba48b0cbeadb8a328d3ded3982a08b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a4e725a10baf02c004c982772e22905fe99c1670", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a4e725a10baf02c004c982772e22905fe99c1670", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a4e725a10baf02c004c982772e22905fe99c1670", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a4e725a10baf02c004c982772e22905fe99c1670/comments", "author": {"login": "stefan-sf-ibm", "id": 73470131, "node_id": "MDQ6VXNlcjczNDcwMTMx", "avatar_url": "https://avatars.githubusercontent.com/u/73470131?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stefan-sf-ibm", "html_url": "https://github.com/stefan-sf-ibm", "followers_url": "https://api.github.com/users/stefan-sf-ibm/followers", "following_url": "https://api.github.com/users/stefan-sf-ibm/following{/other_user}", "gists_url": "https://api.github.com/users/stefan-sf-ibm/gists{/gist_id}", "starred_url": "https://api.github.com/users/stefan-sf-ibm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stefan-sf-ibm/subscriptions", "organizations_url": "https://api.github.com/users/stefan-sf-ibm/orgs", "repos_url": "https://api.github.com/users/stefan-sf-ibm/repos", "events_url": "https://api.github.com/users/stefan-sf-ibm/events{/privacy}", "received_events_url": "https://api.github.com/users/stefan-sf-ibm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "stefan-sf-ibm", "id": 73470131, "node_id": "MDQ6VXNlcjczNDcwMTMx", "avatar_url": "https://avatars.githubusercontent.com/u/73470131?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stefan-sf-ibm", "html_url": "https://github.com/stefan-sf-ibm", "followers_url": "https://api.github.com/users/stefan-sf-ibm/followers", "following_url": "https://api.github.com/users/stefan-sf-ibm/following{/other_user}", "gists_url": "https://api.github.com/users/stefan-sf-ibm/gists{/gist_id}", "starred_url": "https://api.github.com/users/stefan-sf-ibm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stefan-sf-ibm/subscriptions", "organizations_url": "https://api.github.com/users/stefan-sf-ibm/orgs", "repos_url": "https://api.github.com/users/stefan-sf-ibm/repos", "events_url": "https://api.github.com/users/stefan-sf-ibm/events{/privacy}", "received_events_url": "https://api.github.com/users/stefan-sf-ibm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "96fd01679011379d6da0777e435078212c6bb325", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/96fd01679011379d6da0777e435078212c6bb325", "html_url": "https://github.com/Rust-GCC/gccrs/commit/96fd01679011379d6da0777e435078212c6bb325"}], "stats": {"total": 9, "additions": 5, "deletions": 4}, "files": [{"sha": "6e9c80f7283307a1e52bcb70cb55272d3ef20e90", "filename": "gcc/config/s390/s390-d.cc", "status": "modified", "additions": 5, "deletions": 4, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a4e725a10baf02c004c982772e22905fe99c1670/gcc%2Fconfig%2Fs390%2Fs390-d.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a4e725a10baf02c004c982772e22905fe99c1670/gcc%2Fconfig%2Fs390%2Fs390-d.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fs390%2Fs390-d.cc?ref=a4e725a10baf02c004c982772e22905fe99c1670", "patch": "@@ -30,10 +30,11 @@ along with GCC; see the file COPYING3.  If not see\n void\n s390_d_target_versions (void)\n {\n-  if (TARGET_ZARCH)\n-    d_add_builtin_version (\"SystemZ\");\n-  else if (TARGET_64BIT)\n-    d_add_builtin_version (\"S390X\");\n+  if (TARGET_64BIT)\n+    {\n+      d_add_builtin_version (\"S390X\");\n+      d_add_builtin_version (\"SystemZ\");\n+    }\n   else\n     d_add_builtin_version (\"S390\");\n "}]}