{"sha": "6bcb6ed5a44b6f271891246ef7ae568bfdc14e9c", "node_id": "C_kwDOANBUbNoAKDZiY2I2ZWQ1YTQ0YjZmMjcxODkxMjQ2ZWY3YWU1NjhiZmRjMTRlOWM", "commit": {"author": {"name": "Matthias Kretz", "email": "m.kretz@gsi.de", "date": "2021-12-15T08:45:06Z"}, "committer": {"name": "Matthias Kretz", "email": "m.kretz@gsi.de", "date": "2021-12-19T20:07:23Z"}, "message": "c++: don't ICE on NAMESPACE_DECL inside FUNCTION_DECL\n\nCode like\n  void swap() {\n    namespace __variant = __detail::__variant;\n    ...\n  }\ncreate a NAMESPACE_DECL where the CP_DECL_CONTEXT is a FUNCTION_DECL.\nDECL_TEMPLATE_INFO fails on NAMESPACE_DECL and therefore must be handled\nfirst in the assertion.\n\nSigned-off-by: Matthias Kretz <m.kretz@gsi.de>\n\ngcc/cp/ChangeLog:\n\n\t* module.cc (trees_out::get_merge_kind): NAMESPACE_DECLs also\n\tcannot have a DECL_TEMPLATE_INFO.", "tree": {"sha": "525a5ac903a33c59ed940ff9077179f820cbbd68", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/525a5ac903a33c59ed940ff9077179f820cbbd68"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6bcb6ed5a44b6f271891246ef7ae568bfdc14e9c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6bcb6ed5a44b6f271891246ef7ae568bfdc14e9c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6bcb6ed5a44b6f271891246ef7ae568bfdc14e9c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6bcb6ed5a44b6f271891246ef7ae568bfdc14e9c/comments", "author": {"login": "mattkretz", "id": 3306474, "node_id": "MDQ6VXNlcjMzMDY0NzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3306474?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mattkretz", "html_url": "https://github.com/mattkretz", "followers_url": "https://api.github.com/users/mattkretz/followers", "following_url": "https://api.github.com/users/mattkretz/following{/other_user}", "gists_url": "https://api.github.com/users/mattkretz/gists{/gist_id}", "starred_url": "https://api.github.com/users/mattkretz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mattkretz/subscriptions", "organizations_url": "https://api.github.com/users/mattkretz/orgs", "repos_url": "https://api.github.com/users/mattkretz/repos", "events_url": "https://api.github.com/users/mattkretz/events{/privacy}", "received_events_url": "https://api.github.com/users/mattkretz/received_events", "type": "User", "site_admin": false}, "committer": {"login": "mattkretz", "id": 3306474, "node_id": "MDQ6VXNlcjMzMDY0NzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3306474?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mattkretz", "html_url": "https://github.com/mattkretz", "followers_url": "https://api.github.com/users/mattkretz/followers", "following_url": "https://api.github.com/users/mattkretz/following{/other_user}", "gists_url": "https://api.github.com/users/mattkretz/gists{/gist_id}", "starred_url": "https://api.github.com/users/mattkretz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mattkretz/subscriptions", "organizations_url": "https://api.github.com/users/mattkretz/orgs", "repos_url": "https://api.github.com/users/mattkretz/repos", "events_url": "https://api.github.com/users/mattkretz/events{/privacy}", "received_events_url": "https://api.github.com/users/mattkretz/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "89cf57ea35d1e0a0b818997c737ac70b7310d9d9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/89cf57ea35d1e0a0b818997c737ac70b7310d9d9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/89cf57ea35d1e0a0b818997c737ac70b7310d9d9"}], "stats": {"total": 5, "additions": 3, "deletions": 2}, "files": [{"sha": "8451e3dcc9062ac4d0b8a736401f2a142a2265bb", "filename": "gcc/cp/module.cc", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6bcb6ed5a44b6f271891246ef7ae568bfdc14e9c/gcc%2Fcp%2Fmodule.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6bcb6ed5a44b6f271891246ef7ae568bfdc14e9c/gcc%2Fcp%2Fmodule.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fmodule.cc?ref=6bcb6ed5a44b6f271891246ef7ae568bfdc14e9c", "patch": "@@ -10067,9 +10067,10 @@ trees_out::get_merge_kind (tree decl, depset *dep)\n       tree ctx = CP_DECL_CONTEXT (decl);\n       if (TREE_CODE (ctx) == FUNCTION_DECL)\n \t{\n-\t  /* USING_DECLs cannot have DECL_TEMPLATE_INFO -- this isn't\n-\t     permitting them to have one.   */\n+\t  /* USING_DECLs and NAMESPACE_DECLs cannot have DECL_TEMPLATE_INFO --\n+\t     this isn't permitting them to have one.   */\n \t  gcc_checking_assert (TREE_CODE (decl) == USING_DECL\n+\t\t\t       || TREE_CODE (decl) == NAMESPACE_DECL\n \t\t\t       || !DECL_LANG_SPECIFIC (decl)\n \t\t\t       || !DECL_TEMPLATE_INFO (decl));\n "}]}