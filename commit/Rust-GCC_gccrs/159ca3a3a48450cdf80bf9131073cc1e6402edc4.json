{"sha": "159ca3a3a48450cdf80bf9131073cc1e6402edc4", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTU5Y2EzYTNhNDg0NTBjZGY4MGJmOTEzMTA3M2NjMWU2NDAyZWRjNA==", "commit": {"author": {"name": "Andrew Pinski", "email": "pinskia@physics.uc.edu", "date": "2003-06-02T18:38:32Z"}, "committer": {"name": "Benjamin Kosnik", "email": "bkoz@gcc.gnu.org", "date": "2003-06-02T18:38:32Z"}, "message": "re PR libstdc++/9815 (atomicity.h - fails to compile with -O3 -masm=intel)\n\n\n2003-06-02  Andrew Pinski  <pinskia@physics.uc.edu>\n\n\tPR libstdc++/9815\n\t* config/cpu/i386/atomicity.h (__exchange_and_add): add intel\n\tasm case to asm.\n\t* config/cpu/i486/atomicity.h (__exchange_and_add): Likewise.\n\t(__atomic_add): likewise.\n\nFrom-SVN: r67343", "tree": {"sha": "e79df46115727918a39143461314e30e19239fc1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e79df46115727918a39143461314e30e19239fc1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/159ca3a3a48450cdf80bf9131073cc1e6402edc4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/159ca3a3a48450cdf80bf9131073cc1e6402edc4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/159ca3a3a48450cdf80bf9131073cc1e6402edc4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/159ca3a3a48450cdf80bf9131073cc1e6402edc4/comments", "author": null, "committer": null, "parents": [{"sha": "62929dd980996e79b9e4668b31c4a7fa48b0bef7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/62929dd980996e79b9e4668b31c4a7fa48b0bef7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/62929dd980996e79b9e4668b31c4a7fa48b0bef7"}], "stats": {"total": 17, "additions": 13, "deletions": 4}, "files": [{"sha": "0848e64d020d349b5cca6ed80552d80546f70430", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 10, "deletions": 1, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/159ca3a3a48450cdf80bf9131073cc1e6402edc4/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/159ca3a3a48450cdf80bf9131073cc1e6402edc4/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=159ca3a3a48450cdf80bf9131073cc1e6402edc4", "patch": "@@ -1,3 +1,11 @@\n+2003-06-02  Andrew Pinski  <pinskia@physics.uc.edu>\n+\n+\tPR libstdc++/9815\n+\t* config/cpu/i386/atomicity.h (__exchange_and_add): add intel\n+\tasm case to asm.\n+\t* config/cpu/i486/atomicity.h (__exchange_and_add): Likewise.\n+\t(__atomic_add): likewise.\n+\t\n 2003-06-02  Paolo Carlini  <pcarlini@unitus.it>\n \n \t* include/bits/sstream.tcc (pbackfail): Minor clean up and\n@@ -86,7 +94,8 @@\n \n 2003-05-27  Jonathan Wakely  <redi@gcc.gnu.org>\n \n-\t* include/std/std_istream.h, include/std/std_ostream.h: Typo in comment.\n+\t* include/std/std_istream.h, include/std/std_ostream.h: Typo in\n+\tcomment.\n \n 2003-05-26  Benjamin Kosnik  <bkoz@redhat.com>\n "}, {"sha": "d619dbb99ced8f0e2539e1205ef40fbb9ef6d291", "filename": "libstdc++-v3/config/cpu/i386/atomicity.h", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/159ca3a3a48450cdf80bf9131073cc1e6402edc4/libstdc%2B%2B-v3%2Fconfig%2Fcpu%2Fi386%2Fatomicity.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/159ca3a3a48450cdf80bf9131073cc1e6402edc4/libstdc%2B%2B-v3%2Fconfig%2Fcpu%2Fi386%2Fatomicity.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fconfig%2Fcpu%2Fi386%2Fatomicity.h?ref=159ca3a3a48450cdf80bf9131073cc1e6402edc4", "patch": "@@ -51,7 +51,7 @@ __exchange_and_add (volatile _Atomic_word *__mem, int __val)\n \n   /* obtain the atomic exchange/add spin lock */\n   do {\n-    __asm__ __volatile__ (\"xchgl %0,%1\"\n+    __asm__ __volatile__ (\"xchg{l} {%0,%1|%1,%0}\"\n \t\t\t  : \"+m\" (__Atomicity_lock<0>::_S_atomicity_lock),\n \t\t\t    \"+r\" (__tmp));\n   } while (__tmp);"}, {"sha": "7c65fab678e60e5a75e3f973f0a34562ac6a8890", "filename": "libstdc++-v3/config/cpu/i486/atomicity.h", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/159ca3a3a48450cdf80bf9131073cc1e6402edc4/libstdc%2B%2B-v3%2Fconfig%2Fcpu%2Fi486%2Fatomicity.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/159ca3a3a48450cdf80bf9131073cc1e6402edc4/libstdc%2B%2B-v3%2Fconfig%2Fcpu%2Fi486%2Fatomicity.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fconfig%2Fcpu%2Fi486%2Fatomicity.h?ref=159ca3a3a48450cdf80bf9131073cc1e6402edc4", "patch": "@@ -37,7 +37,7 @@ __attribute__ ((__unused__))\n __exchange_and_add (volatile _Atomic_word *__mem, int __val)\n {\n   register _Atomic_word __result;\n-  __asm__ __volatile__ (\"lock; xaddl %0,%1\"\n+  __asm__ __volatile__ (\"lock; xadd{l} {%0,%1|%1,%0}\"\n \t\t\t: \"=r\" (__result), \"+m\" (*__mem) \n                         : \"0\" (__val)\n                         : \"memory\");\n@@ -48,7 +48,7 @@ static inline void\n __attribute__ ((__unused__))\n __atomic_add (volatile _Atomic_word* __mem, int __val)\n {\n-  __asm__ __volatile__ (\"lock; addl %1,%0\"\n+  __asm__ __volatile__ (\"lock; add{l} {%1,%0|%0,%1}\"\n \t\t\t: \"+m\" (*__mem) : \"ir\" (__val) : \"memory\");\n }\n "}]}