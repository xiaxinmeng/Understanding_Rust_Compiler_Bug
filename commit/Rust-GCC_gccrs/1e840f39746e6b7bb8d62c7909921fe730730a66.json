{"sha": "1e840f39746e6b7bb8d62c7909921fe730730a66", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWU4NDBmMzk3NDZlNmI3YmI4ZDYyYzc5MDk5MjFmZTczMDczMGE2Ng==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2016-03-02T06:58:05Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2016-03-02T06:58:05Z"}, "message": "re PR middle-end/70025 (Miscompilation of gc-7.4.2 on s390x starting with r227382)\n\n\tPR middle-end/70025\n\t* gcc.dg/torture/pr70025.c: New test.\n\nFrom-SVN: r233889", "tree": {"sha": "1ac93e281cf0ef25d06d96adef5f06fbfd3e3885", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1ac93e281cf0ef25d06d96adef5f06fbfd3e3885"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1e840f39746e6b7bb8d62c7909921fe730730a66", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1e840f39746e6b7bb8d62c7909921fe730730a66", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1e840f39746e6b7bb8d62c7909921fe730730a66", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1e840f39746e6b7bb8d62c7909921fe730730a66/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "bca002411e0eac07225863fb6237dff6f84d091b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bca002411e0eac07225863fb6237dff6f84d091b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bca002411e0eac07225863fb6237dff6f84d091b"}], "stats": {"total": 86, "additions": 86, "deletions": 0}, "files": [{"sha": "321c87e27873f1f8a288d2adb71a3f55418b503f", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1e840f39746e6b7bb8d62c7909921fe730730a66/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1e840f39746e6b7bb8d62c7909921fe730730a66/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=1e840f39746e6b7bb8d62c7909921fe730730a66", "patch": "@@ -1,3 +1,8 @@\n+2016-03-02  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR middle-end/70025\n+\t* gcc.dg/torture/pr70025.c: New test.\n+\n 2016-03-02  Venkataramanan Kumar  <venkataramanan.kumar@amd.com>\n \n \tPR tree-optimization/68621"}, {"sha": "dafae0b777e46daaf3a142605195259d67cf92dd", "filename": "gcc/testsuite/gcc.dg/torture/pr70025.c", "status": "added", "additions": 81, "deletions": 0, "changes": 81, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1e840f39746e6b7bb8d62c7909921fe730730a66/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr70025.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1e840f39746e6b7bb8d62c7909921fe730730a66/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr70025.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr70025.c?ref=1e840f39746e6b7bb8d62c7909921fe730730a66", "patch": "@@ -0,0 +1,81 @@\n+/* PR middle-end/70025 */\n+/* { dg-do run } */\n+/* { dg-additional-options \"-mtune=z10\" { target s390*-*-* } } */\n+\n+typedef char (*F) (unsigned long, void *);\n+typedef union { struct A { char a1, a2, a3, a4; unsigned long a5; F a6; void *a7; } b; char c[1]; } B;\n+struct C { const char *c1; unsigned long c2; };\n+typedef struct D { unsigned long d1; int d2; const char *d3; unsigned long d4, d5; struct C d6[49]; char d7[8]; } E[1];\n+\n+__attribute__ ((noinline, noclone))\n+void foo (register E p)\n+{\n+  asm volatile (\"\" : : \"r\" (p) : \"memory\");\n+}\n+\n+__attribute__ ((noinline, noclone))\n+void bar (register E p)\n+{\n+  register unsigned long k = p[0].d1 + 1;\n+  register struct C *l = &p[0].d6[p[0].d2];\n+  register const char *m = l->c1;\n+  p[0].d1 = k;\n+  if (*m == '\\0')\n+    {\n+      register struct A *f = &((B *) m)->b;\n+      register unsigned long n = l->c2;\n+      register unsigned long o = n + f->a5;\n+      if (k < o)\n+\t{\n+\t  register unsigned long i;\n+\t  register unsigned long q = k + 8;\n+\t  register F a6 = f->a6;\n+\t  register void *a7 = f->a7;\n+\t  if (q > o)\n+\t    q = o;\n+\t  for (i = k; i < q; i++)\n+\t    p[0].d7[i - k] = (*a6) (i - n, a7);\n+\t  p[0].d4 = k;\n+\t  p[0].d3 = p[0].d7;\n+\t  p[0].d5 = q;\n+\t  return;\n+\t}\n+    }\n+  while (p[0].d2 > 0 && l[0].c2 != l[-1].c2)\n+    {\n+      p[0].d2--;\n+      l--;\n+    }\n+  if (p[0].d2 == 0)\n+    {\n+      p[0].d2 = 0x55555555;\n+      return;\n+    }\n+  p[0].d2--;\n+  foo (p);\n+}\n+\n+char\n+baz (unsigned long i, void *j)\n+{\n+  if (j != 0)\n+    __builtin_abort ();\n+  return (char) i;\n+}\n+\n+int\n+main ()\n+{\n+  struct D p;\n+  struct A f;\n+  __builtin_memset (&f, 0, sizeof (f));\n+  f.a2 = 4;\n+  f.a5 = 13;\n+  f.a6 = baz;\n+  __builtin_memset (&p, 0, sizeof (p));\n+  p.d6[0].c1 = (const char *) &f;\n+  bar (&p);\n+  if (p.d4 != 1 || p.d5 != 9 || p.d3 != p.d7)\n+    __builtin_abort ();\n+  return 0;\n+}"}]}