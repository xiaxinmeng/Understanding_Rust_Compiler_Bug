{"sha": "d7f41b2d87214f6e014f3091a2956f0170a8b41e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDdmNDFiMmQ4NzIxNGY2ZTAxNGYzMDkxYTI5NTZmMDE3MGE4YjQxZQ==", "commit": {"author": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2012-08-06T08:32:05Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2012-08-06T08:32:05Z"}, "message": "[multiple changes]\n\n2012-08-06  Yannick Moy  <moy@adacore.com>\n\n\t* sem_ch4.adb (Analyze_Selected_Component): Issue an error in\n\tAlfa mode for component not present.\n\n2012-08-06  Thomas Quinot  <quinot@adacore.com>\n\n\t* exp_ch7.adb (Insert_Actions_In_Scope_Around): Do not\n\tuse a renaming of Scope_Stack.Table (Scope_Stack.Last), as\n\tProcess_Transient_Object may introduce new scopes and cause\n\tScope_Stack.Table to be reallocated.\n\nFrom-SVN: r190167", "tree": {"sha": "12975f2e3a8b23ed0c0213b9a2ad7b12d75829b4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/12975f2e3a8b23ed0c0213b9a2ad7b12d75829b4"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d7f41b2d87214f6e014f3091a2956f0170a8b41e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d7f41b2d87214f6e014f3091a2956f0170a8b41e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d7f41b2d87214f6e014f3091a2956f0170a8b41e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d7f41b2d87214f6e014f3091a2956f0170a8b41e/comments", "author": null, "committer": null, "parents": [{"sha": "3217f71e44777466c8aab40ddd22d0ed3ca5ce3d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3217f71e44777466c8aab40ddd22d0ed3ca5ce3d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3217f71e44777466c8aab40ddd22d0ed3ca5ce3d"}], "stats": {"total": 48, "additions": 39, "deletions": 9}, "files": [{"sha": "e75adb756a4d1be54d7d361f2be19e42d84710fe", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d7f41b2d87214f6e014f3091a2956f0170a8b41e/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d7f41b2d87214f6e014f3091a2956f0170a8b41e/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=d7f41b2d87214f6e014f3091a2956f0170a8b41e", "patch": "@@ -1,3 +1,15 @@\n+2012-08-06  Yannick Moy  <moy@adacore.com>\n+\n+\t* sem_ch4.adb (Analyze_Selected_Component): Issue an error in\n+\tAlfa mode for component not present.\n+\n+2012-08-06  Thomas Quinot  <quinot@adacore.com>\n+\n+\t* exp_ch7.adb (Insert_Actions_In_Scope_Around): Do not\n+\tuse a renaming of Scope_Stack.Table (Scope_Stack.Last), as\n+\tProcess_Transient_Object may introduce new scopes and cause\n+\tScope_Stack.Table to be reallocated.\n+\n 2012-08-06  Robert Dewar  <dewar@adacore.com>\n \n \t* exp_util.adb, switch-c.adb, inline.ads, sem_ch10.adb, types.ads,"}, {"sha": "725cd2ac4b6f88a16098a99d280a6166f5b85201", "filename": "gcc/ada/exp_ch7.adb", "status": "modified", "additions": 11, "deletions": 5, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d7f41b2d87214f6e014f3091a2956f0170a8b41e/gcc%2Fada%2Fexp_ch7.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d7f41b2d87214f6e014f3091a2956f0170a8b41e/gcc%2Fada%2Fexp_ch7.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fexp_ch7.adb?ref=d7f41b2d87214f6e014f3091a2956f0170a8b41e", "patch": "@@ -4345,9 +4345,13 @@ package body Exp_Ch7 is\n    ------------------------------------\n \n    procedure Insert_Actions_In_Scope_Around (N : Node_Id) is\n-      SE     : Scope_Stack_Entry renames Scope_Stack.Table (Scope_Stack.Last);\n-      After  : List_Id renames SE.Actions_To_Be_Wrapped_After;\n-      Before : List_Id renames SE.Actions_To_Be_Wrapped_Before;\n+      After  : constant List_Id :=\n+        Scope_Stack.Table (Scope_Stack.Last).Actions_To_Be_Wrapped_After;\n+      Before : constant List_Id :=\n+        Scope_Stack.Table (Scope_Stack.Last).Actions_To_Be_Wrapped_Before;\n+      --  Note: We used to use renamings of Scope_Stack.Table (Scope_Stack.\n+      --  Last), but this was incorrect as Process_Transient_Object may\n+      --  introduce new scopes and cause a reallocation of Scope_Stack.Table.\n \n       procedure Process_Transient_Objects\n         (First_Object : Node_Id;\n@@ -4694,11 +4698,13 @@ package body Exp_Ch7 is\n          --  Reset the action lists\n \n          if Present (Before) then\n-            Before := No_List;\n+            Scope_Stack.Table (Scope_Stack.Last).\n+              Actions_To_Be_Wrapped_Before := No_List;\n          end if;\n \n          if Present (After) then\n-            After := No_List;\n+            Scope_Stack.Table (Scope_Stack.Last).\n+              Actions_To_Be_Wrapped_After := No_List;\n          end if;\n       end;\n    end Insert_Actions_In_Scope_Around;"}, {"sha": "557d61624b7135aebac1e5322c693849282df121", "filename": "gcc/ada/sem_ch4.adb", "status": "modified", "additions": 16, "deletions": 4, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d7f41b2d87214f6e014f3091a2956f0170a8b41e/gcc%2Fada%2Fsem_ch4.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d7f41b2d87214f6e014f3091a2956f0170a8b41e/gcc%2Fada%2Fsem_ch4.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch4.adb?ref=d7f41b2d87214f6e014f3091a2956f0170a8b41e", "patch": "@@ -4343,10 +4343,22 @@ package body Sem_Ch4 is\n                      --  Emit appropriate message. Gigi will replace the\n                      --  node subsequently with the appropriate Raise.\n \n-                     Apply_Compile_Time_Constraint_Error\n-                       (N, \"component not present in }?\",\n-                        CE_Discriminant_Check_Failed,\n-                        Ent => Prefix_Type, Rep => False);\n+                     --  In Alfa mode, this is an made into an error to\n+                     --  simplify the treatment of the formal verification\n+                     --  backend.\n+\n+                     if Alfa_Mode then\n+                        Apply_Compile_Time_Constraint_Error\n+                          (N, \"component not present in }\",\n+                           CE_Discriminant_Check_Failed,\n+                           Ent => Prefix_Type, Rep => False);\n+                     else\n+                        Apply_Compile_Time_Constraint_Error\n+                          (N, \"component not present in }?\",\n+                           CE_Discriminant_Check_Failed,\n+                           Ent => Prefix_Type, Rep => False);\n+                     end if;\n+\n                      Set_Raises_Constraint_Error (N);\n                      return;\n                   end if;"}]}