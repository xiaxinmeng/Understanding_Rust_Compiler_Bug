{"sha": "5828d725742962a7e74a0707bdc5d82c78be7b3f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTgyOGQ3MjU3NDI5NjJhN2U3NGEwNzA3YmRjNWQ4MmM3OGJlN2IzZg==", "commit": {"author": {"name": "Richard Henderson", "email": "rth@cygnus.com", "date": "2000-05-28T12:31:40Z"}, "committer": {"name": "Richard Henderson", "email": "rth@gcc.gnu.org", "date": "2000-05-28T12:31:40Z"}, "message": "function.c (diddle_return_value): A pcc-style struct return returns a pointer.\n\n        * function.c (diddle_return_value): A pcc-style struct return\n        returns a pointer.\n\nFrom-SVN: r34230", "tree": {"sha": "8259d933168057d7c20100edea0e2f03c1405468", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8259d933168057d7c20100edea0e2f03c1405468"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5828d725742962a7e74a0707bdc5d82c78be7b3f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5828d725742962a7e74a0707bdc5d82c78be7b3f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5828d725742962a7e74a0707bdc5d82c78be7b3f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5828d725742962a7e74a0707bdc5d82c78be7b3f/comments", "author": null, "committer": null, "parents": [{"sha": "6745c1b9dd0edeeb6d1f1ea2f3285fe58ff7f91f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6745c1b9dd0edeeb6d1f1ea2f3285fe58ff7f91f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6745c1b9dd0edeeb6d1f1ea2f3285fe58ff7f91f"}], "stats": {"total": 21, "additions": 19, "deletions": 2}, "files": [{"sha": "01ef6afac328516765ff5d12f838312074b2040b", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5828d725742962a7e74a0707bdc5d82c78be7b3f/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5828d725742962a7e74a0707bdc5d82c78be7b3f/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=5828d725742962a7e74a0707bdc5d82c78be7b3f", "patch": "@@ -1,3 +1,8 @@\n+2000-05-28  Richard Henderson  <rth@cygnus.com>\n+\n+\t* function.c (diddle_return_value): A pcc-style struct return\n+\treturns a pointer.\n+\n 2000-05-27  Zack Weinberg  <zack@wolery.cumb.org>\n \n \t* cppfiles.c: Read files in, using mmap if possible, then"}, {"sha": "07f58d56dbf790475a9b122de3dfcce8a0cc8997", "filename": "gcc/function.c", "status": "modified", "additions": 14, "deletions": 2, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5828d725742962a7e74a0707bdc5d82c78be7b3f/gcc%2Ffunction.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5828d725742962a7e74a0707bdc5d82c78be7b3f/gcc%2Ffunction.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffunction.c?ref=5828d725742962a7e74a0707bdc5d82c78be7b3f", "patch": "@@ -6319,14 +6319,25 @@ diddle_return_value (doit, arg)\n      void *arg;\n {\n   rtx outgoing = current_function_return_rtx;\n+  int pcc;\n \n   if (! outgoing)\n     return;\n \n-  if (GET_CODE (outgoing) == REG\n-      && REGNO (outgoing) >= FIRST_PSEUDO_REGISTER)\n+  pcc = (current_function_returns_struct\n+         || current_function_returns_pcc_struct);\n+\n+  if ((GET_CODE (outgoing) == REG\n+       && REGNO (outgoing) >= FIRST_PSEUDO_REGISTER)\n+      || pcc)\n     {\n       tree type = TREE_TYPE (DECL_RESULT (current_function_decl));\n+\n+      /* A PCC-style return returns a pointer to the memory in which\n+\t the structure is stored.  */\n+      if (pcc)\n+\ttype = build_pointer_type (type);\n+\n #ifdef FUNCTION_OUTGOING_VALUE\n       outgoing = FUNCTION_OUTGOING_VALUE (type, current_function_decl);\n #else\n@@ -6337,6 +6348,7 @@ diddle_return_value (doit, arg)\n       if (GET_MODE (outgoing) == BLKmode)\n \tPUT_MODE (outgoing,\n \t\t  GET_MODE (DECL_RTL (DECL_RESULT (current_function_decl))));\n+      REG_FUNCTION_VALUE_P (outgoing) = 1;\n     }\n \n   if (GET_CODE (outgoing) == REG)"}]}