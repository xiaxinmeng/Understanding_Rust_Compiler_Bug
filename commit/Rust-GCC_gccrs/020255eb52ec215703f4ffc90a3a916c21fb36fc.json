{"sha": "020255eb52ec215703f4ffc90a3a916c21fb36fc", "node_id": "C_kwDOANBUbNoAKDAyMDI1NWViNTJlYzIxNTcwM2Y0ZmZjOTBhM2E5MTZjMjFmYjM2ZmM", "commit": {"author": {"name": "Hans-Peter Nilsson", "email": "hp@axis.com", "date": "2023-03-10T18:08:53Z"}, "committer": {"name": "Hans-Peter Nilsson", "email": "hp@bitrange.com", "date": "2023-03-10T22:48:22Z"}, "message": "testsuite: Tweak check_fork_available for CRIS\n\nThis takes care of the failing gcc.dg/torture/ftrapv-1.c and\n-ftrapv-2.c for cris-elf.\n\nFor simplicity, assume simulators are the GNU simulator (in the gdb\nrepo).  But cris-elf is newlib, so a newlib target forking?  Yes: the\nI/O, etc. interface to the simulator uses the Linux/CRIS ABI.\n\n\t* lib/target-supports.exp (check_fork_available): Don't signal\n\ttrue for CRIS running on a simulator.", "tree": {"sha": "fde54ef200db2073d76b1b80ca9e85cdf4bf54ee", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/fde54ef200db2073d76b1b80ca9e85cdf4bf54ee"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/020255eb52ec215703f4ffc90a3a916c21fb36fc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/020255eb52ec215703f4ffc90a3a916c21fb36fc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/020255eb52ec215703f4ffc90a3a916c21fb36fc", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/020255eb52ec215703f4ffc90a3a916c21fb36fc/comments", "author": {"login": "hpataxisdotcom", "id": 80339731, "node_id": "MDQ6VXNlcjgwMzM5NzMx", "avatar_url": "https://avatars.githubusercontent.com/u/80339731?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hpataxisdotcom", "html_url": "https://github.com/hpataxisdotcom", "followers_url": "https://api.github.com/users/hpataxisdotcom/followers", "following_url": "https://api.github.com/users/hpataxisdotcom/following{/other_user}", "gists_url": "https://api.github.com/users/hpataxisdotcom/gists{/gist_id}", "starred_url": "https://api.github.com/users/hpataxisdotcom/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hpataxisdotcom/subscriptions", "organizations_url": "https://api.github.com/users/hpataxisdotcom/orgs", "repos_url": "https://api.github.com/users/hpataxisdotcom/repos", "events_url": "https://api.github.com/users/hpataxisdotcom/events{/privacy}", "received_events_url": "https://api.github.com/users/hpataxisdotcom/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "88bcd4e5678260bfd60c6cbc7ecb63b8aeafd20e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/88bcd4e5678260bfd60c6cbc7ecb63b8aeafd20e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/88bcd4e5678260bfd60c6cbc7ecb63b8aeafd20e"}], "stats": {"total": 6, "additions": 6, "deletions": 0}, "files": [{"sha": "84ac737152313fb8004762a7fb89ea021fc2adde", "filename": "gcc/testsuite/lib/target-supports.exp", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/020255eb52ec215703f4ffc90a3a916c21fb36fc/gcc%2Ftestsuite%2Flib%2Ftarget-supports.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/020255eb52ec215703f4ffc90a3a916c21fb36fc/gcc%2Ftestsuite%2Flib%2Ftarget-supports.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Flib%2Ftarget-supports.exp?ref=020255eb52ec215703f4ffc90a3a916c21fb36fc", "patch": "@@ -2880,6 +2880,12 @@ proc check_fork_available {} {\n \t# tell as we're doing partial links for kernel modules.\n \treturn 0\n      }    \n+    if { [istarget cris-*-*] } {\n+\t# Compiling and linking works, and an executable running e.g.\n+\t# gcc.dg/torture/ftrapv-1.c works on now-historical hardware,\n+\t# but the GNU simulator emits an error for the fork syscall.\n+\treturn [check_effective_target_hw]\n+    }\n     return [check_function_available \"fork\"]\n }\n "}]}