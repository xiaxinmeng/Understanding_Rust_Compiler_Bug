{"sha": "d08677c11dc4b43cc8bab862d1c986563897ce3f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDA4Njc3YzExZGM0YjQzY2M4YmFiODYyZDFjOTg2NTYzODk3Y2UzZg==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2021-01-22T21:38:31Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2021-01-22T21:38:31Z"}, "message": "testsuite: Fix sse2-andnpd-1.c and sse-andnps-1.c testscases on powerpc\n\nOn Mon, Sep 21, 2020 at 10:12:20AM +0200, Richard Biener wrote:\n> On Mon, 21 Sep 2020, Jan Hubicka wrote:\n> > these testcases now fails because they contains an invalid type puning\n> > that happens via const VALUE_TYPE *v pointer. Since the check function\n> > is noinline, modref is needed to trigger the wrong code.\n> > I think it is easiest to fix it by no-strict-aliasing.\n> >\n> > Regtested x86_64-linux, OK?\n>\n> OK.\n>\n> >     * gcc.target/i386/m128-check.h: Add no-strict aliasing to\n> >     CHECK_EXP macro.\n> >\n> > diff --git a/gcc/testsuite/gcc.target/i386/m128-check.h b/gcc/testsuite/gcc.target/i386/m128-check.h\n> > index 48b23328539..6f414b07be7 100644\n> > --- a/gcc/testsuite/gcc.target/i386/m128-check.h\n> > +++ b/gcc/testsuite/gcc.target/i386/m128-check.h\n> > @@ -78,6 +78,7 @@ typedef union\n> >\n> >  #define CHECK_EXP(UINON_TYPE, VALUE_TYPE, FMT)             \\\n> >  static int                                         \\\n> > +__attribute__((optimize (\"no-strict-aliasing\")))   \\\n> >  __attribute__((noinline, unused))                  \\\n> >  check_##UINON_TYPE (UINON_TYPE u, const VALUE_TYPE *v)     \\\n> >  {                                                  \\\n\nOn powerpc64le the tests suffer from the exact same issue.\n\n2021-01-22  Jakub Jelinek  <jakub@redhat.com>\n\n\t* gcc.target/powerpc/m128-check.h (check_##UINON_TYPE): Add\n\toptimize (\"no-strict-aliasing\") attribute.", "tree": {"sha": "c12886e730605a6175f5f931ac8d514bf86fb66b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c12886e730605a6175f5f931ac8d514bf86fb66b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d08677c11dc4b43cc8bab862d1c986563897ce3f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d08677c11dc4b43cc8bab862d1c986563897ce3f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d08677c11dc4b43cc8bab862d1c986563897ce3f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d08677c11dc4b43cc8bab862d1c986563897ce3f/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b485fa167ef35c8facbd7c21cb86fd1abc77efcf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b485fa167ef35c8facbd7c21cb86fd1abc77efcf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b485fa167ef35c8facbd7c21cb86fd1abc77efcf"}], "stats": {"total": 1, "additions": 1, "deletions": 0}, "files": [{"sha": "3df96524d955f1186dd8300e80094aa5a9cdb3d9", "filename": "gcc/testsuite/gcc.target/powerpc/m128-check.h", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d08677c11dc4b43cc8bab862d1c986563897ce3f/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fm128-check.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d08677c11dc4b43cc8bab862d1c986563897ce3f/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fm128-check.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fm128-check.h?ref=d08677c11dc4b43cc8bab862d1c986563897ce3f", "patch": "@@ -85,6 +85,7 @@ typedef union\n \n #define CHECK_EXP(UINON_TYPE, VALUE_TYPE, FMT)\t\t\\\n static int\t\t\t\t\t\t\\\n+__attribute__((optimize (\"no-strict-aliasing\")))\t\\\n __attribute__((noinline, unused))\t\t\t\\\n check_##UINON_TYPE (UINON_TYPE u, const VALUE_TYPE *v)\t\\\n {\t\t\t\t\t\t\t\\"}]}