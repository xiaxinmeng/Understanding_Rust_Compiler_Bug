{"sha": "b55f96db06a8706fbdb2c19f627bc05d6b15dadf", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjU1Zjk2ZGIwNmE4NzA2ZmJkYjJjMTlmNjI3YmMwNWQ2YjE1ZGFkZg==", "commit": {"author": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1996-04-15T11:46:28Z"}, "committer": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1996-04-15T11:46:28Z"}, "message": "(find_dead_or_set_registers): Only kill spill regs after label made\nbefore jump2.\n\nFrom-SVN: r11778", "tree": {"sha": "14758be275794bdcc1ecc1bcd52f7fe7cbde4dc9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/14758be275794bdcc1ecc1bcd52f7fe7cbde4dc9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b55f96db06a8706fbdb2c19f627bc05d6b15dadf", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b55f96db06a8706fbdb2c19f627bc05d6b15dadf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b55f96db06a8706fbdb2c19f627bc05d6b15dadf", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b55f96db06a8706fbdb2c19f627bc05d6b15dadf/comments", "author": null, "committer": null, "parents": [{"sha": "bf8b4985abe198142d29a1f570f489ac2de29a2d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bf8b4985abe198142d29a1f570f489ac2de29a2d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bf8b4985abe198142d29a1f570f489ac2de29a2d"}], "stats": {"total": 17, "additions": 12, "deletions": 5}, "files": [{"sha": "11e5fc7c1ae4d224975a575b64636475fb486cd1", "filename": "gcc/reorg.c", "status": "modified", "additions": 12, "deletions": 5, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b55f96db06a8706fbdb2c19f627bc05d6b15dadf/gcc%2Freorg.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b55f96db06a8706fbdb2c19f627bc05d6b15dadf/gcc%2Freorg.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Freorg.c?ref=b55f96db06a8706fbdb2c19f627bc05d6b15dadf", "patch": "@@ -133,6 +133,10 @@ Boston, MA 02111-1307, USA.  */\n /* Import list of registers used as spill regs from reload.  */\n extern HARD_REG_SET used_spill_regs;\n \n+/* Import highest label used in function at end of reload.  */\n+extern int max_label_num_after_reload;\n+\n+\n #ifdef DELAY_SLOTS\n \n #define obstack_chunk_alloc xmalloc\n@@ -2468,11 +2472,14 @@ find_dead_or_set_registers (target, res, jump_target, jump_count, set, needed)\n \t  AND_COMPL_HARD_REG_SET (res->regs, pending_dead_regs);\n \t  CLEAR_HARD_REG_SET (pending_dead_regs);\n \n-\t  /* All spill registers are dead at a label, so kill all of the\n-\t     ones that aren't needed also.  */\n-\t  COPY_HARD_REG_SET (scratch, used_spill_regs);\n-\t  AND_COMPL_HARD_REG_SET (scratch, needed.regs);\n-\t  AND_COMPL_HARD_REG_SET (res->regs, scratch);\n+\t  if (CODE_LABEL_NUMBER (insn) < max_label_num_after_reload)\n+\t    {\n+\t      /* All spill registers are dead at a label, so kill all of the\n+\t\t ones that aren't needed also.  */\n+\t      COPY_HARD_REG_SET (scratch, used_spill_regs);\n+\t      AND_COMPL_HARD_REG_SET (scratch, needed.regs);\n+\t      AND_COMPL_HARD_REG_SET (res->regs, scratch);\n+\t    }\n \t  continue;\n \n \tcase BARRIER:"}]}