{"sha": "0bfd099c35ab5e03bb51dcd237ba5fb82b500b86", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MGJmZDA5OWMzNWFiNWUwM2JiNTFkY2QyMzdiYTVmYjgyYjUwMGI4Ng==", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2016-10-12T14:37:53Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2016-10-12T14:37:53Z"}, "message": "re PR debug/77947 (ICE with -g and -O2 in strip_naming_typedef)\n\n2016-10-12  Richard Biener  <rguenther@suse.de>\n\n\tPR debug/77947\n\t* cgraphunit.c (analyze_functions): Preserve cgraph nodes\n\tfunction context.\n\n\t* g++.dg/torture/pr77947.C: New testcase.\n\nFrom-SVN: r241053", "tree": {"sha": "3df218c47dcb17cac62dbd5519e6d2e34b1c7b59", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3df218c47dcb17cac62dbd5519e6d2e34b1c7b59"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0bfd099c35ab5e03bb51dcd237ba5fb82b500b86", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0bfd099c35ab5e03bb51dcd237ba5fb82b500b86", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0bfd099c35ab5e03bb51dcd237ba5fb82b500b86", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0bfd099c35ab5e03bb51dcd237ba5fb82b500b86/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "05f1a54316f9516defe5ab54e0be66b1821596a1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/05f1a54316f9516defe5ab54e0be66b1821596a1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/05f1a54316f9516defe5ab54e0be66b1821596a1"}], "stats": {"total": 53, "additions": 50, "deletions": 3}, "files": [{"sha": "3fb6a77068b80a1d851ad2e934f652b93d1e6577", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0bfd099c35ab5e03bb51dcd237ba5fb82b500b86/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0bfd099c35ab5e03bb51dcd237ba5fb82b500b86/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=0bfd099c35ab5e03bb51dcd237ba5fb82b500b86", "patch": "@@ -1,3 +1,9 @@\n+2016-10-12  Richard Biener  <rguenther@suse.de>\n+\n+\tPR debug/77947\n+\t* cgraphunit.c (analyze_functions): Preserve cgraph nodes\n+\tfunction context.\n+\n 2016-10-12  Thomas Schwinge  <thomas@codesourcery.com>\n \n \t* lto-streamer.c: Fix LTO_STREAMER_DEBUG build."}, {"sha": "4fa518d27c63ded2dcd348d0825951f09f2dea2d", "filename": "gcc/cgraphunit.c", "status": "modified", "additions": 10, "deletions": 3, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0bfd099c35ab5e03bb51dcd237ba5fb82b500b86/gcc%2Fcgraphunit.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0bfd099c35ab5e03bb51dcd237ba5fb82b500b86/gcc%2Fcgraphunit.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcgraphunit.c?ref=0bfd099c35ab5e03bb51dcd237ba5fb82b500b86", "patch": "@@ -1117,15 +1117,22 @@ analyze_functions (bool first_time)\n \t\t}\n \n \t      /* If decl is a clone of an abstract function,\n-\t      mark that abstract function so that we don't release its body.\n-\t      The DECL_INITIAL() of that abstract function declaration\n-\t      will be later needed to output debug info.  */\n+\t\t mark that abstract function so that we don't release its body.\n+\t\t The DECL_INITIAL() of that abstract function declaration\n+\t\t will be later needed to output debug info.  */\n \t      if (DECL_ABSTRACT_ORIGIN (decl))\n \t\t{\n \t\t  cgraph_node *origin_node\n \t\t    = cgraph_node::get_create (DECL_ABSTRACT_ORIGIN (decl));\n \t\t  origin_node->used_as_abstract_origin = true;\n \t\t}\n+\t      /* Preserve a functions function context node.  It will\n+\t\t later be needed to output debug info.  */\n+\t      if (tree fn = decl_function_context (decl))\n+\t\t{\n+\t\t  cgraph_node *origin_node = cgraph_node::get_create (fn);\n+\t\t  enqueue_node (origin_node);\n+\t\t}\n \t    }\n \t  else\n \t    {"}, {"sha": "10a8e35b8bf5de87de5734098922a34391a2c1fe", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0bfd099c35ab5e03bb51dcd237ba5fb82b500b86/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0bfd099c35ab5e03bb51dcd237ba5fb82b500b86/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=0bfd099c35ab5e03bb51dcd237ba5fb82b500b86", "patch": "@@ -1,3 +1,8 @@\n+2016-10-12  Richard Biener  <rguenther@suse.de>\n+\n+\tPR debug/77947\n+\t* g++.dg/torture/pr77947.C: New testcase.\n+\n 2016-10-12  Pierre-Marie de Rodat  <derodat@adacore.com>\n \n \t* gnat.dg/debug8.adb: New testcase."}, {"sha": "3c8a24a16c6e80b4da4c0b1aa6c514611e8c6a26", "filename": "gcc/testsuite/g++.dg/torture/pr77947.C", "status": "added", "additions": 29, "deletions": 0, "changes": 29, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0bfd099c35ab5e03bb51dcd237ba5fb82b500b86/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftorture%2Fpr77947.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0bfd099c35ab5e03bb51dcd237ba5fb82b500b86/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftorture%2Fpr77947.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftorture%2Fpr77947.C?ref=0bfd099c35ab5e03bb51dcd237ba5fb82b500b86", "patch": "@@ -0,0 +1,29 @@\n+// { dg-do compile }\n+// { dg-additional-options \"-g\" }\n+\n+class A\n+{\n+public:\n+  virtual bool m_fn1 () const = 0;\n+};\n+class B\n+{\n+  const A *m_fn2 () const;\n+};\n+inline const A *\n+B::m_fn2 () const\n+{\n+  class C : A\n+  {\n+    bool\n+    m_fn1 () const\n+    {\n+    }\n+    C () {}\n+  };\n+}\n+void\n+fn1 (A &p1)\n+{\n+  p1.m_fn1 ();\n+}"}]}