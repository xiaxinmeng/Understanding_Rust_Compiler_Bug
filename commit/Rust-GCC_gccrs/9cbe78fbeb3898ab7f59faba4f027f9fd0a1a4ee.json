{"sha": "9cbe78fbeb3898ab7f59faba4f027f9fd0a1a4ee", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWNiZTc4ZmJlYjM4OThhYjdmNTlmYWJhNGYwMjdmOWZkMGExYTRlZQ==", "commit": {"author": {"name": "Joseph Myers", "email": "jsm@polyomino.org.uk", "date": "2004-08-03T22:09:13Z"}, "committer": {"name": "Joseph Myers", "email": "jsm28@gcc.gnu.org", "date": "2004-08-03T22:09:13Z"}, "message": "c-decl.c (implicitly_declare): Diagnose incompatible implicit declarations.\n\n\t* c-decl.c (implicitly_declare): Diagnose incompatible implicit\n\tdeclarations.\n\ntestsuite:\n\t* gcc.dg/redecl-5.c: New test.\n\t* gcc.dg/format/attr-6.c: Expect warning for implicit declaration\n\tof scanf.\n\nFrom-SVN: r85509", "tree": {"sha": "a534cd9d6e051f107ee4ae8faa1e824cf9bddaeb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a534cd9d6e051f107ee4ae8faa1e824cf9bddaeb"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9cbe78fbeb3898ab7f59faba4f027f9fd0a1a4ee", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9cbe78fbeb3898ab7f59faba4f027f9fd0a1a4ee", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9cbe78fbeb3898ab7f59faba4f027f9fd0a1a4ee", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9cbe78fbeb3898ab7f59faba4f027f9fd0a1a4ee/comments", "author": {"login": "jsm28", "id": 10537793, "node_id": "MDQ6VXNlcjEwNTM3Nzkz", "avatar_url": "https://avatars.githubusercontent.com/u/10537793?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsm28", "html_url": "https://github.com/jsm28", "followers_url": "https://api.github.com/users/jsm28/followers", "following_url": "https://api.github.com/users/jsm28/following{/other_user}", "gists_url": "https://api.github.com/users/jsm28/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsm28/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsm28/subscriptions", "organizations_url": "https://api.github.com/users/jsm28/orgs", "repos_url": "https://api.github.com/users/jsm28/repos", "events_url": "https://api.github.com/users/jsm28/events{/privacy}", "received_events_url": "https://api.github.com/users/jsm28/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jsm28", "id": 10537793, "node_id": "MDQ6VXNlcjEwNTM3Nzkz", "avatar_url": "https://avatars.githubusercontent.com/u/10537793?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsm28", "html_url": "https://github.com/jsm28", "followers_url": "https://api.github.com/users/jsm28/followers", "following_url": "https://api.github.com/users/jsm28/following{/other_user}", "gists_url": "https://api.github.com/users/jsm28/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsm28/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsm28/subscriptions", "organizations_url": "https://api.github.com/users/jsm28/orgs", "repos_url": "https://api.github.com/users/jsm28/repos", "events_url": "https://api.github.com/users/jsm28/events{/privacy}", "received_events_url": "https://api.github.com/users/jsm28/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2e847896896e3283a0551eeb46b4d3c3c8211d2a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2e847896896e3283a0551eeb46b4d3c3c8211d2a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2e847896896e3283a0551eeb46b4d3c3c8211d2a"}], "stats": {"total": 48, "additions": 48, "deletions": 0}, "files": [{"sha": "14c2b37a537f49daa6b3718ed70d572d7aa4d722", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9cbe78fbeb3898ab7f59faba4f027f9fd0a1a4ee/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9cbe78fbeb3898ab7f59faba4f027f9fd0a1a4ee/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=9cbe78fbeb3898ab7f59faba4f027f9fd0a1a4ee", "patch": "@@ -1,3 +1,8 @@\n+2004-08-03  Joseph S. Myers  <jsm@polyomino.org.uk>\n+\n+\t* c-decl.c (implicitly_declare): Diagnose incompatible implicit\n+\tdeclarations.\n+\n 2004-08-03  Mike Stump  <mrs@apple.com>\n \n \t* config/darwin-c.c: Don't search in \"/Local/Library/Frameworks\""}, {"sha": "cbdafbb48e13325a2411cdf83a53a71ac67cd7ef", "filename": "gcc/c-decl.c", "status": "modified", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9cbe78fbeb3898ab7f59faba4f027f9fd0a1a4ee/gcc%2Fc-decl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9cbe78fbeb3898ab7f59faba4f027f9fd0a1a4ee/gcc%2Fc-decl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-decl.c?ref=9cbe78fbeb3898ab7f59faba4f027f9fd0a1a4ee", "patch": "@@ -2082,6 +2082,23 @@ implicitly_declare (tree functionid)\n \t      implicit_decl_warning (functionid, decl);\n \t      C_DECL_IMPLICIT (decl) = 1;\n \t    }\n+\t  if (DECL_BUILT_IN (decl))\n+\t    {\n+\t      if (!comptypes (default_function_type, TREE_TYPE (decl)))\n+\t\t{\n+\t\t  warning (\"incompatible implicit declaration of built-in\"\n+\t\t\t   \" function %qD\", decl);\n+\t\t}\n+\t    }\n+\t  else\n+\t    {\n+\t      if (!comptypes (default_function_type, TREE_TYPE (decl)))\n+\t\t{\n+\t\t  error (\"incompatible implicit declaration of function %qD\",\n+\t\t\t decl);\n+\t\t  locate_old_decl (decl, error);\n+\t\t}\n+\t    }\n \t  bind (functionid, decl, current_scope,\n \t\t/*invisible=*/false, /*nested=*/true);\n \t  return decl;"}, {"sha": "f5d0e36b49db90489c99d683fcad2c1d91d485ca", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9cbe78fbeb3898ab7f59faba4f027f9fd0a1a4ee/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9cbe78fbeb3898ab7f59faba4f027f9fd0a1a4ee/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=9cbe78fbeb3898ab7f59faba4f027f9fd0a1a4ee", "patch": "@@ -1,3 +1,9 @@\n+2004-08-03  Joseph S. Myers  <jsm@polyomino.org.uk>\n+\n+\t* gcc.dg/redecl-5.c: New test.\n+\t* gcc.dg/format/attr-6.c: Expect warning for implicit declaration\n+\tof scanf.\n+\n 2004-08-03  Roger Sayle  <roger@eyesopen.com>\n \n \tPR middle-end/16790"}, {"sha": "0f683223d783aa06b6d9c99d128cb1c309dd8e21", "filename": "gcc/testsuite/gcc.dg/format/attr-6.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9cbe78fbeb3898ab7f59faba4f027f9fd0a1a4ee/gcc%2Ftestsuite%2Fgcc.dg%2Fformat%2Fattr-6.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9cbe78fbeb3898ab7f59faba4f027f9fd0a1a4ee/gcc%2Ftestsuite%2Fgcc.dg%2Fformat%2Fattr-6.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fformat%2Fattr-6.c?ref=9cbe78fbeb3898ab7f59faba4f027f9fd0a1a4ee", "patch": "@@ -18,4 +18,5 @@ void\n foo (const char *s, int *p)\n {\n   scanf(\"%ld\", p); /* { dg-warning \"format\" \"implicit scanf\" } */\n+  /* { dg-warning \"implicit\" \"implicit decl warning\" { target *-*-* } 20 } */\n }"}, {"sha": "a689295bb8573f1309e5933ae781b8138f70d0a4", "filename": "gcc/testsuite/gcc.dg/redecl-5.c", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9cbe78fbeb3898ab7f59faba4f027f9fd0a1a4ee/gcc%2Ftestsuite%2Fgcc.dg%2Fredecl-5.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9cbe78fbeb3898ab7f59faba4f027f9fd0a1a4ee/gcc%2Ftestsuite%2Fgcc.dg%2Fredecl-5.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fredecl-5.c?ref=9cbe78fbeb3898ab7f59faba4f027f9fd0a1a4ee", "patch": "@@ -0,0 +1,19 @@\n+/* Test for multiple declarations and composite types.  Diagnosis of\n+   incompatible implicit declaration.  */\n+/* Origin: Joseph Myers <jsm@polyomino.org.uk> */\n+/* { dg-do compile } */\n+/* { dg-options \"-std=c89\" } */\n+\n+void\n+f (void)\n+{\n+  long z(); /* { dg-error \"previous implicit declaration\" } */\n+}\n+\n+void\n+g (void)\n+{\n+  z(); /* { dg-error \"incompatible\" } */\n+  labs(1); /* { dg-warning \"incompatible\" } */\n+  printf(\"x\"); /* { dg-warning \"incompatible\" } */\n+}"}]}