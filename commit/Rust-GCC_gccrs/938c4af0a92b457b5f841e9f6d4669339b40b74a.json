{"sha": "938c4af0a92b457b5f841e9f6d4669339b40b74a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTM4YzRhZjBhOTJiNDU3YjVmODQxZTlmNmQ0NjY5MzM5YjQwYjc0YQ==", "commit": {"author": {"name": "Andrey Turetskiy", "email": "andrey.turetskiy@intel.com", "date": "2015-09-04T08:56:28Z"}, "committer": {"name": "Kirill Yukhin", "email": "kyukhin@gcc.gnu.org", "date": "2015-09-04T08:56:28Z"}, "message": "avx512f-scatter-1.c: New.\n\n\ngcc/testsuite/\n\t* gcc.target/i386/avx512f-scatter-1.c: New.\n\t* gcc.target/i386/avx512f-scatter-2.c: Ditto.\n\t* gcc.target/i386/avx512f-scatter-3.c: Ditto.\n\nCo-Authored-By: Kirill Yukhin <kirill.yukhin@intel.com>\nCo-Authored-By: Petr Murzin <petr.murzin@intel.com>\n\nFrom-SVN: r227483", "tree": {"sha": "e1ab3683b7a51963e0a77ed85697b52b1c4e9e6f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e1ab3683b7a51963e0a77ed85697b52b1c4e9e6f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/938c4af0a92b457b5f841e9f6d4669339b40b74a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/938c4af0a92b457b5f841e9f6d4669339b40b74a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/938c4af0a92b457b5f841e9f6d4669339b40b74a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/938c4af0a92b457b5f841e9f6d4669339b40b74a/comments", "author": null, "committer": null, "parents": [{"sha": "624dcfd62ba91e683a3cf6adc09a586d556757dc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/624dcfd62ba91e683a3cf6adc09a586d556757dc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/624dcfd62ba91e683a3cf6adc09a586d556757dc"}], "stats": {"total": 479, "additions": 479, "deletions": 0}, "files": [{"sha": "8b444ab39782a7656f09df4a718902c36b29be5c", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/938c4af0a92b457b5f841e9f6d4669339b40b74a/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/938c4af0a92b457b5f841e9f6d4669339b40b74a/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=938c4af0a92b457b5f841e9f6d4669339b40b74a", "patch": "@@ -1,3 +1,11 @@\n+2015-09-04  Andrey Turetskiy  <andrey.turetskiy@intel.com>\n+\t    Petr Murzin  <petr.murzin@intel.com>\n+\t    Kirill Yukhin <kirill.yukhin@intel.com>\n+\n+\t* gcc.target/i386/avx512f-scatter-1.c: New.\n+\t* gcc.target/i386/avx512f-scatter-2.c: Ditto.\n+\t* gcc.target/i386/avx512f-scatter-3.c: Ditto.\n+\n 2015-09-04  Janne Blomqvist  <jb@gcc.gnu.org>\n \n \t* gfortran.dg/read_dir.f90: Delete empty directory when closing"}, {"sha": "575f3bfa70c65b00c8a21a85070073262bffe915", "filename": "gcc/testsuite/gcc.target/i386/avx512f-scatter-1.c", "status": "added", "additions": 218, "deletions": 0, "changes": 218, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/938c4af0a92b457b5f841e9f6d4669339b40b74a/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Favx512f-scatter-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/938c4af0a92b457b5f841e9f6d4669339b40b74a/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Favx512f-scatter-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Favx512f-scatter-1.c?ref=938c4af0a92b457b5f841e9f6d4669339b40b74a", "patch": "@@ -0,0 +1,218 @@\n+/* { dg-do run } */\n+/* { dg-require-effective-target avx512f } */\n+/* { dg-options \"-O3 -mavx512f\" } */\n+\n+#define AVX512F\n+\n+#include \"avx512f-check.h\"\n+\n+#define N 1024\n+float vf1[N], vf2[2*N+16];\n+double vd1[N], vd2[2*N+16];\n+int vi1[N], vi2[2*N+16], k[N];\n+long vl1[N], vl2[2*N+16], l[N];\n+\n+__attribute__((noinline, noclone)) void\n+f1 (void)\n+{\n+  int i;\n+  for (i = 0; i < N; i++)\n+    vf2[k[i]] = vf1[i];\n+}\n+\n+__attribute__((noinline, noclone)) void\n+f2 (void)\n+{\n+  int i;\n+  for (i = 0; i < N; i++)\n+    vi2[k[i]] = vi1[i];\n+}\n+\n+__attribute__((noinline, noclone)) void\n+f3 (int x)\n+{\n+  int i;\n+  for (i = 0; i < N; i++)\n+    vf2[k[i] + x] = vf1[i];\n+}\n+\n+__attribute__((noinline, noclone)) void\n+f4 (int x)\n+{\n+  int i;\n+  for (i = 0; i < N; i++)\n+    vi2[k[i] + x] = vi1[i];\n+}\n+\n+__attribute__((noinline, noclone)) void\n+f5 (void)\n+{\n+  int i;\n+  for (i = 0; i < N; i++)\n+    vd2[k[i]] = vd1[i];\n+}\n+\n+__attribute__((noinline, noclone)) void\n+f6 (void)\n+{\n+  int i;\n+  for (i = 0; i < N; i++)\n+    vl2[k[i]] = vl1[i];\n+}\n+\n+__attribute__((noinline, noclone)) void\n+f7 (int x)\n+{\n+  int i;\n+  for (i = 0; i < N; i++)\n+    vd2[k[i] + x] = vd1[i];\n+}\n+\n+__attribute__((noinline, noclone)) void\n+f8 (int x)\n+{\n+  int i;\n+  for (i = 0; i < N; i++)\n+    vl2[k[i] + x] = vl1[i];\n+}\n+\n+__attribute__((noinline, noclone)) void\n+f9 (void)\n+{\n+  int i;\n+  for (i = 0; i < N; i++)\n+    vf2[l[i]] = vf1[i];\n+}\n+\n+__attribute__((noinline, noclone)) void\n+f10 (void)\n+{\n+  int i;\n+  for (i = 0; i < N; i++)\n+    vi2[l[i]] = vi1[i];\n+}\n+\n+__attribute__((noinline, noclone)) void\n+f11 (long x)\n+{\n+  int i;\n+  for (i = 0; i < N; i++)\n+    vf2[l[i] + x] = vf1[i];\n+}\n+\n+__attribute__((noinline, noclone)) void\n+f12 (long x)\n+{\n+  int i;\n+  for (i = 0; i < N; i++)\n+    vi2[l[i] + x] = vi1[i];\n+}\n+\n+__attribute__((noinline, noclone)) void\n+f13 (void)\n+{\n+  int i;\n+  for (i = 0; i < N; i++)\n+    vd2[l[i]] = vd1[i];\n+}\n+\n+__attribute__((noinline, noclone)) void\n+f14 (void)\n+{\n+  int i;\n+  for (i = 0; i < N; i++)\n+    vl2[l[i]] = vl1[i];\n+}\n+\n+__attribute__((noinline, noclone)) void\n+f15 (long x)\n+{\n+  int i;\n+  for (i = 0; i < N; i++)\n+    vd2[l[i] + x] = vd1[i];\n+}\n+\n+__attribute__((noinline, noclone)) void\n+f16 (long x)\n+{\n+  int i;\n+  for (i = 0; i < N; i++)\n+    vl2[l[i] + x] = vl1[i];\n+}\n+\n+static void\n+avx512f_test (void)\n+{\n+  int i;\n+\n+  for (i = 0; i < N; i++)\n+    {\n+      asm (\"\");\n+      vf1[i] = 17.0f + i;\n+      vd1[i] = 19.0 + i;\n+      vi1[i] = 21 + i;\n+      vl1[i] = 23L + i;\n+    }\n+  for (i = 0; i < N; i++)\n+    {\n+      asm (\"\");\n+      k[i] = (i % 2) ? (N / 2 + i) : (N / 2 - i / 2);\n+      l[i] = 2 * i + i % 2;\n+    }\n+\n+  f1 ();\n+  f2 ();\n+  for (i = 0; i < N; i++)\n+    if (vf2[(i % 2) ? (N / 2 + i) : (N / 2 - i / 2)] != i + 17\n+\t|| vi2[(i % 2) ? (N / 2 + i) : (N / 2 - i / 2)] != i + 21)\n+      abort ();\n+\n+  f3 (12);\n+  f4 (14);\n+  for (i = 0; i < N; i++)\n+    if (vf2[((i % 2) ? (N / 2 + i) : (N / 2 - i / 2)) + 12] != i + 17\n+\t|| vi2[((i % 2) ? (N / 2 + i) : (N / 2 - i / 2)) + 14] != i + 21)\n+      abort ();\n+\n+  f5 ();\n+  f6 ();\n+  for (i = 0; i < N; i++)\n+    if (vd2[(i % 2) ? (N / 2 + i) : (N / 2 - i / 2)] != i + 19\n+\t|| vl2[(i % 2) ? (N / 2 + i) : (N / 2 - i / 2)] != i + 23)\n+      abort ();\n+\n+  f7 (7);\n+  f8 (9);\n+  for (i = 0; i < N; i++)\n+    if (vd2[((i % 2) ? (N / 2 + i) : (N / 2 - i / 2)) + 7] != i + 19\n+\t|| vl2[((i % 2) ? (N / 2 + i) : (N / 2 - i / 2)) + 9] != i + 23)\n+      abort ();\n+\n+  f9 ();\n+  f10 ();\n+  for (i = 0; i < N; i++)\n+    if (vf2[2 * i + i % 2] != i + 17\n+\t|| vi2[2 * i + i % 2] != i + 21)\n+      abort ();\n+\n+  f11 (2);\n+  f12 (4);\n+  for (i = 0; i < N; i++)\n+    if (vf2[2 * i + i % 2 + 2] != i + 17\n+\t|| vi2[2 * i + i % 2 + 4] != i + 21)\n+      abort ();\n+\n+  f13 ();\n+  f14 ();\n+  for (i = 0; i < N; i++)\n+    if (vd2[2 * i + i % 2] != i + 19\n+\t|| vl2[2 * i + i % 2] != i + 23)\n+      abort ();\n+\n+  f15 (13);\n+  f16 (15);\n+  for (i = 0; i < N; i++)\n+    if (vd2[2 * i + i % 2 + 13] != i + 19\n+\t|| vl2[2 * i + i % 2 + 15] != i + 23)\n+      abort ();\n+}"}, {"sha": "c59ce234f177820f06be60146910650a3d98b1e5", "filename": "gcc/testsuite/gcc.target/i386/avx512f-scatter-2.c", "status": "added", "additions": 217, "deletions": 0, "changes": 217, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/938c4af0a92b457b5f841e9f6d4669339b40b74a/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Favx512f-scatter-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/938c4af0a92b457b5f841e9f6d4669339b40b74a/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Favx512f-scatter-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Favx512f-scatter-2.c?ref=938c4af0a92b457b5f841e9f6d4669339b40b74a", "patch": "@@ -0,0 +1,217 @@\n+/* { dg-do run } */\n+/* { dg-require-effective-target avx512f } */\n+/* { dg-options \"-O3 -mavx512f\" } */\n+\n+#define AVX512F\n+\n+#include \"avx512f-check.h\"\n+\n+#define N 1024\n+float vf1[N], vf2[2*N+16];\n+double vd1[N], vd2[2*N+16];\n+int k[N];\n+long l[N];\n+short n[2*N+16];\n+\n+__attribute__((noinline, noclone)) void\n+f1 (void)\n+{\n+  int i;\n+  for (i = 0; i < N; i++)\n+    vf2[k[i]] = vf1[i];\n+}\n+\n+__attribute__((noinline, noclone)) void\n+f2 (void)\n+{\n+  int i;\n+  for (i = 0; i < N; i++)\n+    n[k[i]] = (int) vf1[i];\n+}\n+\n+__attribute__((noinline, noclone)) void\n+f3 (int x)\n+{\n+  int i;\n+  for (i = 0; i < N; i++)\n+    vf2[k[i] + x] = vf1[i];\n+}\n+\n+__attribute__((noinline, noclone)) void\n+f4 (int x)\n+{\n+  int i;\n+  for (i = 0; i < N; i++)\n+    n[k[i] + x] = (int) vf1[i];\n+}\n+\n+__attribute__((noinline, noclone)) void\n+f5 (void)\n+{\n+  int i;\n+  for (i = 0; i < N; i++)\n+    vd2[k[i]] = vd1[i];\n+}\n+\n+__attribute__((noinline, noclone)) void\n+f6 (void)\n+{\n+  int i;\n+  for (i = 0; i < N; i++)\n+    n[k[i]] = (int) vd1[i];\n+}\n+\n+__attribute__((noinline, noclone)) void\n+f7 (int x)\n+{\n+  int i;\n+  for (i = 0; i < N; i++)\n+    vd2[k[i] + x] = vd1[i];\n+}\n+\n+__attribute__((noinline, noclone)) void\n+f8 (int x)\n+{\n+  int i;\n+  for (i = 0; i < N; i++)\n+    n[k[i] + x] = vd1[i];\n+}\n+\n+__attribute__((noinline, noclone)) void\n+f9 (void)\n+{\n+  int i;\n+  for (i = 0; i < N; i++)\n+    vf2[l[i]] = vf1[i];\n+}\n+\n+__attribute__((noinline, noclone)) void\n+f10 (void)\n+{\n+  int i;\n+  for (i = 0; i < N; i++)\n+    n[l[i]] = (int) vf1[i];\n+}\n+\n+__attribute__((noinline, noclone)) void\n+f11 (long x)\n+{\n+  int i;\n+  for (i = 0; i < N; i++)\n+    vf2[l[i] + x] = vf1[i];\n+}\n+\n+__attribute__((noinline, noclone)) void\n+f12 (long x)\n+{\n+  int i;\n+  for (i = 0; i < N; i++)\n+    n[l[i] + x] = (int) vf1[i];\n+}\n+\n+__attribute__((noinline, noclone)) void\n+f13 (void)\n+{\n+  int i;\n+  for (i = 0; i < N; i++)\n+    vd2[l[i]] = vd1[i];\n+}\n+\n+__attribute__((noinline, noclone)) void\n+f14 (void)\n+{\n+  int i;\n+  for (i = 0; i < N; i++)\n+    n[l[i]] = (int) vd1[i];\n+}\n+\n+__attribute__((noinline, noclone)) void\n+f15 (long x)\n+{\n+  int i;\n+  for (i = 0; i < N; i++)\n+    vd2[l[i] + x] = vd1[i];\n+}\n+\n+__attribute__((noinline, noclone)) void\n+f16 (long x)\n+{\n+  int i;\n+  for (i = 0; i < N; i++)\n+    n[l[i] + x] = (int) vd1[i];\n+}\n+\n+static void\n+avx512f_test (void)\n+{\n+  int i;\n+\n+  for (i = 0; i < N; i++)\n+    {\n+      asm (\"\");\n+      vf1[i] = 17.0f + i;\n+      vd1[i] = 19.0 + i;\n+    }\n+  for (i = 0; i < N; i++)\n+    {\n+      asm (\"\");\n+      k[i] = (i % 2) ? (N / 2 + i) : (N / 2 - i / 2);\n+      l[i] = 2 * i + i % 2;\n+    }\n+\n+  f1 ();\n+  f2 ();\n+  for (i = 0; i < N; i++)\n+    if (vf2[(i % 2) ? (N / 2 + i) : (N / 2 - i / 2)] != i + 17\n+\t|| n[(i % 2) ? (N / 2 + i) : (N / 2 - i / 2)] != i + 17)\n+      abort ();\n+\n+  f3 (12);\n+  f4 (14);\n+  for (i = 0; i < N; i++)\n+    if (vf2[((i % 2) ? (N / 2 + i) : (N / 2 - i / 2)) + 12] != i + 17\n+\t|| n[((i % 2) ? (N / 2 + i) : (N / 2 - i / 2)) + 14] != i + 17)\n+      abort ();\n+\n+  f5 ();\n+  f6 ();\n+  for (i = 0; i < N; i++)\n+    if (vd2[(i % 2) ? (N / 2 + i) : (N / 2 - i / 2)] != i + 19\n+\t|| n[(i % 2) ? (N / 2 + i) : (N / 2 - i / 2)] != i + 19)\n+      abort ();\n+\n+  f7 (7);\n+  f8 (9);\n+  for (i = 0; i < N; i++)\n+    if (vd2[((i % 2) ? (N / 2 + i) : (N / 2 - i / 2)) + 7] != i + 19\n+\t|| n[((i % 2) ? (N / 2 + i) : (N / 2 - i / 2)) + 9] != i + 19)\n+      abort ();\n+\n+  f9 ();\n+  f10 ();\n+  for (i = 0; i < N; i++)\n+    if (vf2[2 * i + i % 2] != i + 17\n+\t|| n[2 * i + i % 2] != i + 17)\n+      abort ();\n+\n+  f11 (2);\n+  f12 (4);\n+  for (i = 0; i < N; i++)\n+    if (vf2[2 * i + i % 2 + 2] != i + 17\n+\t|| n[2 * i + i % 2 + 4] != i + 17)\n+      abort ();\n+\n+  f13 ();\n+  f14 ();\n+  for (i = 0; i < N; i++)\n+    if (vd2[2 * i + i % 2] != i + 19\n+\t|| n[2 * i + i % 2] != i + 19)\n+      abort ();\n+\n+  f15 (13);\n+  f16 (15);\n+  for (i = 0; i < N; i++)\n+    if (vd2[2 * i + i % 2 + 13] != i + 19\n+\t|| n[2 * i + i % 2 + 15] != i + 19)\n+      abort ();\n+}"}, {"sha": "37137fd268a3ba5fabae33a32ac528389c1cd410", "filename": "gcc/testsuite/gcc.target/i386/avx512f-scatter-3.c", "status": "added", "additions": 36, "deletions": 0, "changes": 36, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/938c4af0a92b457b5f841e9f6d4669339b40b74a/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Favx512f-scatter-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/938c4af0a92b457b5f841e9f6d4669339b40b74a/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Favx512f-scatter-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Favx512f-scatter-3.c?ref=938c4af0a92b457b5f841e9f6d4669339b40b74a", "patch": "@@ -0,0 +1,36 @@\n+/* { dg-do run } */\n+/* { dg-require-effective-target avx512f } */\n+/* { dg-options \"-O3 -mavx512f\" } */\n+\n+#define AVX512F\n+\n+#include \"avx512f-check.h\"\n+\n+#define N 1024\n+int a[N], b[N];\n+\n+__attribute__((noinline, noclone)) void\n+foo (float *__restrict p, float *__restrict q,\n+     int s1, int s2, int s3)\n+{\n+  int i;\n+  for (i = 0; i < (N / 8); i++)\n+    p[a[i] * s1 + b[i] * s2 + s3] = q[i];\n+}\n+\n+static void\n+avx512f_test (void)\n+{\n+  int i;\n+  float c[N], d[N];\n+  for (i = 0; i < N; i++)\n+    {\n+      a[i] = (i * 7) & (N / 8 - 1);\n+      b[i] = (i * 13) & (N / 8 - 1);\n+      c[i] = 179.13 + i;\n+    }\n+  foo (d, c, 3, 2, 4);\n+  for (i = 0; i < (N / 8); i++)\n+    if (d[a[i] * 3 + b[i] * 2 + 4] != (float) (179.13 + i))\n+      abort ();\n+}"}]}