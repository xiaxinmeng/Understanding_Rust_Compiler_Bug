{"sha": "ca5c3ef417b37ef662d627ee9f1d5c8a3a31b6ff", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Y2E1YzNlZjQxN2IzN2VmNjYyZDYyN2VlOWYxZDVjOGEzYTMxYjZmZg==", "commit": {"author": {"name": "Jim Wilson", "email": "wilson@gcc.gnu.org", "date": "1993-07-21T21:44:07Z"}, "committer": {"name": "Jim Wilson", "email": "wilson@gcc.gnu.org", "date": "1993-07-21T21:44:07Z"}, "message": "(nonlocal_label_list): New variable.\n\n(combine_instructions): Set it.\n(try_combine, distribute_links): CALL_INSN terminates a basic\nblock if nonlocal_label_list is set.\n\nFrom-SVN: r4960", "tree": {"sha": "b8faa69d54c38647e14273d8c3eea898a4ceef25", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b8faa69d54c38647e14273d8c3eea898a4ceef25"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ca5c3ef417b37ef662d627ee9f1d5c8a3a31b6ff", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ca5c3ef417b37ef662d627ee9f1d5c8a3a31b6ff", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ca5c3ef417b37ef662d627ee9f1d5c8a3a31b6ff", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ca5c3ef417b37ef662d627ee9f1d5c8a3a31b6ff/comments", "author": null, "committer": null, "parents": [{"sha": "6630a026139d10eba9665ba784b99d1cf03fe321", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6630a026139d10eba9665ba784b99d1cf03fe321", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6630a026139d10eba9665ba784b99d1cf03fe321"}], "stats": {"total": 15, "additions": 14, "deletions": 1}, "files": [{"sha": "fa18f29a134da4741f81a93cf150ec34ad1d75ec", "filename": "gcc/combine.c", "status": "modified", "additions": 14, "deletions": 1, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ca5c3ef417b37ef662d627ee9f1d5c8a3a31b6ff/gcc%2Fcombine.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ca5c3ef417b37ef662d627ee9f1d5c8a3a31b6ff/gcc%2Fcombine.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcombine.c?ref=ca5c3ef417b37ef662d627ee9f1d5c8a3a31b6ff", "patch": "@@ -187,6 +187,11 @@ static int subst_low_cuid;\n    structures.  */\n \n static int previous_num_undos;\n+\n+/* This is non-zero if there exists at least one nonlocal_label in the\n+   current function.  This affects how basic block structure is determined.  */\n+\n+static rtx nonlocal_label_list;\n \f\n /* The next group of arrays allows the recording of the last value assigned\n    to (hard or pseudo) register n.  We use this information to see if a\n@@ -527,6 +532,8 @@ combine_instructions (f, nregs)\n \n   setup_incoming_promotions ();\n \n+  nonlocal_label_list = nonlocal_label_rtx_list ();\n+\n   for (insn = f; insn; insn = next ? next : NEXT_INSN (insn))\n     {\n       next = 0;\n@@ -1875,6 +1882,8 @@ try_combine (i3, i2, i1)\n \n \t  for (insn = NEXT_INSN (i3);\n \t       insn && GET_CODE (insn) != CODE_LABEL\n+\t       && (GET_CODE (PREV_INSN (insn)) != CALL_INSN\n+\t\t   || nonlocal_label_list == 0)\n \t       && GET_CODE (PREV_INSN (insn)) != JUMP_INSN;\n \t       insn = NEXT_INSN (insn))\n \t    {\n@@ -2047,7 +2056,9 @@ try_combine (i3, i2, i1)\n \t\t      XEXP (link, 0) = i3;\n \n \t\tif (GET_CODE (insn) == CODE_LABEL\n-\t\t    || GET_CODE (insn) == JUMP_INSN)\n+\t\t    || GET_CODE (insn) == JUMP_INSN\n+\t\t    || (GET_CODE (PREV_INSN (insn)) == CALL_INSN\n+\t\t\t&& nonlocal_label_list != 0))\n \t\t  break;\n \t      }\n \t  }\n@@ -10037,6 +10048,8 @@ distribute_links (links)\n \n       for (insn = NEXT_INSN (XEXP (link, 0));\n \t   (insn && GET_CODE (insn) != CODE_LABEL\n+\t    && (GET_CODE (PREV_INSN (insn)) != CALL_INSN\n+\t\t|| nonlocal_label_list == 0)\n \t    && GET_CODE (PREV_INSN (insn)) != JUMP_INSN);\n \t   insn = NEXT_INSN (insn))\n \tif (GET_RTX_CLASS (GET_CODE (insn)) == 'i'"}]}