{"sha": "963ddbd50fbb62666384ea56cfc7e06753f9bb6d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTYzZGRiZDUwZmJiNjI2NjYzODRlYTU2Y2ZjN2UwNjc1M2Y5YmI2ZA==", "commit": {"author": {"name": "Per Bothner", "email": "per@bothner.com", "date": "2004-07-19T18:29:31Z"}, "committer": {"name": "Per Bothner", "email": "bothner@gcc.gnu.org", "date": "2004-07-19T18:29:31Z"}, "message": "Print -verbose:message on \"loading\", not initialization.\n\n\t* java/lang/Class.h (JV_STATE_LOADED, JV_STATE_COMPILED):  Swap order.\n\t* defineclass.cc (_Jv_ClassReader::parse):  Print message if\n\tgcj::verbose_class_flag.\n\t* java/lang/natClass.cc (initializeClass):  Don't print message here.\n\t* java/lang/natClassLoader.cc (_Jv_WaitForState):  If state was\n\t_JV_STATE_COMPILED, set to JV_STATE_LOADED and may print message.\n\t(_Jv_PrepareCompiledClass):  Likewise.\n\nFrom-SVN: r84926", "tree": {"sha": "597d2c3053a8c38dbe90a83d42c5d5788337fa93", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/597d2c3053a8c38dbe90a83d42c5d5788337fa93"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/963ddbd50fbb62666384ea56cfc7e06753f9bb6d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/963ddbd50fbb62666384ea56cfc7e06753f9bb6d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/963ddbd50fbb62666384ea56cfc7e06753f9bb6d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/963ddbd50fbb62666384ea56cfc7e06753f9bb6d/comments", "author": {"login": "PerBothner", "id": 10293361, "node_id": "MDQ6VXNlcjEwMjkzMzYx", "avatar_url": "https://avatars.githubusercontent.com/u/10293361?v=4", "gravatar_id": "", "url": "https://api.github.com/users/PerBothner", "html_url": "https://github.com/PerBothner", "followers_url": "https://api.github.com/users/PerBothner/followers", "following_url": "https://api.github.com/users/PerBothner/following{/other_user}", "gists_url": "https://api.github.com/users/PerBothner/gists{/gist_id}", "starred_url": "https://api.github.com/users/PerBothner/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/PerBothner/subscriptions", "organizations_url": "https://api.github.com/users/PerBothner/orgs", "repos_url": "https://api.github.com/users/PerBothner/repos", "events_url": "https://api.github.com/users/PerBothner/events{/privacy}", "received_events_url": "https://api.github.com/users/PerBothner/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "b06f03362fe56b4a81a506f6c7fc6a5bf721d905", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b06f03362fe56b4a81a506f6c7fc6a5bf721d905", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b06f03362fe56b4a81a506f6c7fc6a5bf721d905"}], "stats": {"total": 34, "additions": 27, "deletions": 7}, "files": [{"sha": "8f7edb16cf4acfb849b840db2f39dcf77dfecf97", "filename": "libjava/ChangeLog", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/963ddbd50fbb62666384ea56cfc7e06753f9bb6d/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/963ddbd50fbb62666384ea56cfc7e06753f9bb6d/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=963ddbd50fbb62666384ea56cfc7e06753f9bb6d", "patch": "@@ -1,3 +1,14 @@\n+2004-07-19  Per Bothner  <per@bothner.com>\n+\n+\tPrint -verbose:message on \"loading\", not initialization.\n+\t* java/lang/Class.h (JV_STATE_LOADED, JV_STATE_COMPILED):  Swap order.\n+\t* defineclass.cc (_Jv_ClassReader::parse):  Print message if\n+\tgcj::verbose_class_flag.\n+\t* java/lang/natClass.cc (initializeClass):  Don't print message here.\n+\t* java/lang/natClassLoader.cc (_Jv_WaitForState):  If state was\n+\t_JV_STATE_COMPILED, set to JV_STATE_LOADED and may print message.\n+\t(_Jv_PrepareCompiledClass):  Likewise.\n+\n 2004-07-18  Matthias Klose  <doko@debian.org>\n \n \t* configure.in: Substitute target_noncanonical."}, {"sha": "0648ad98287ad4b0871b7e59a3815e1e53884c99", "filename": "libjava/defineclass.cc", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/963ddbd50fbb62666384ea56cfc7e06753f9bb6d/libjava%2Fdefineclass.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/963ddbd50fbb62666384ea56cfc7e06753f9bb6d/libjava%2Fdefineclass.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fdefineclass.cc?ref=963ddbd50fbb62666384ea56cfc7e06753f9bb6d", "patch": "@@ -336,6 +336,8 @@ _Jv_ClassReader::parse ()\n \n   // tell everyone we're done.\n   def->state = JV_STATE_LOADED;\n+  if (gcj::verbose_class_flag)\n+    fprintf (stderr, \"[Loaded (bytecode) %s]\\n\", (const char*)(def->name->data));\n   def->notifyAll ();\n \n }"}, {"sha": "de00c2eb2fb8710ad04c24a174b409b5bbf019db", "filename": "libjava/java/lang/Class.h", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/963ddbd50fbb62666384ea56cfc7e06753f9bb6d/libjava%2Fjava%2Flang%2FClass.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/963ddbd50fbb62666384ea56cfc7e06753f9bb6d/libjava%2Fjava%2Flang%2FClass.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjava%2Flang%2FClass.h?ref=963ddbd50fbb62666384ea56cfc7e06753f9bb6d", "patch": "@@ -39,10 +39,9 @@ enum\n \n   JV_STATE_PRELOADING = 1,\t// Can do _Jv_FindClass.\n   JV_STATE_LOADING = 3,\t\t// Has super installed.\n-  JV_STATE_LOADED = 5,\t\t// Is complete.\n-    \n-  JV_STATE_COMPILED = 6,\t// This was a compiled class.\n+  JV_STATE_COMPILED = 5,\t// This was a compiled class.\n \n+  JV_STATE_LOADED = 6,\t\t// Is complete.\n   JV_STATE_PREPARED = 7,\t// Layout & static init done.\n   JV_STATE_LINKED = 9,\t\t// Strings interned.\n "}, {"sha": "1b1a32d1babd1ad3893608fea36ee8690b198d93", "filename": "libjava/java/lang/natClass.cc", "status": "modified", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/963ddbd50fbb62666384ea56cfc7e06753f9bb6d/libjava%2Fjava%2Flang%2FnatClass.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/963ddbd50fbb62666384ea56cfc7e06753f9bb6d/libjava%2Fjava%2Flang%2FnatClass.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjava%2Flang%2FnatClass.cc?ref=963ddbd50fbb62666384ea56cfc7e06753f9bb6d", "patch": "@@ -831,9 +831,6 @@ java::lang::Class::initializeClass (void)\n       throw except;\n     }\n \n-  if (gcj::verbose_class_flag)\n-    fprintf (stderr, \"[Loaded %s]\\n\", (const char*)(name->data));\n-\n   _Jv_MonitorEnter (this);\n   state = JV_STATE_DONE;\n   notifyAll ();"}, {"sha": "b38c2db16258f06113483cd65835a3be2e75fde9", "filename": "libjava/java/lang/natClassLoader.cc", "status": "modified", "additions": 12, "deletions": 1, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/963ddbd50fbb62666384ea56cfc7e06753f9bb6d/libjava%2Fjava%2Flang%2FnatClassLoader.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/963ddbd50fbb62666384ea56cfc7e06753f9bb6d/libjava%2Fjava%2Flang%2FnatClassLoader.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjava%2Flang%2FnatClassLoader.cc?ref=963ddbd50fbb62666384ea56cfc7e06753f9bb6d", "patch": "@@ -48,6 +48,12 @@ _Jv_WaitForState (jclass klass, int state)\n   \n   _Jv_MonitorEnter (klass) ;\n \n+  if (klass->state == JV_STATE_COMPILED)\n+    {\n+      klass->state = JV_STATE_LOADED;\n+      if (gcj::verbose_class_flag)\n+\tfprintf (stderr, \"[Loaded (pre-compiled) %s]\\n\", (const char*)(klass->name->data));\n+    }\n   if (state == JV_STATE_LINKED)\n     {\n       // Must call _Jv_PrepareCompiledClass while holding the class\n@@ -86,7 +92,8 @@ typedef unsigned int uaddr __attribute__ ((mode (pointer)));\n void\n _Jv_PrepareCompiledClass (jclass klass)\n {\n-  if (klass->state >= JV_STATE_LINKED)\n+  jint state = klass->state;\n+  if (state >= JV_STATE_LINKED)\n     return;\n \n   // Short-circuit, so that mutually dependent classes are ok.\n@@ -173,6 +180,10 @@ _Jv_PrepareCompiledClass (jclass klass)\n   if (klass->isInterface ())\n     _Jv_LayoutInterfaceMethods (klass);\n \n+  if (state == JV_STATE_COMPILED && gcj::verbose_class_flag)\n+    fprintf (stderr, \"[Loaded (pre-compiled) %s]\\n\",\n+\t     (const char*)(klass->name->data));\n+\n   klass->notifyAll ();\n \n   _Jv_PushClass (klass);"}]}