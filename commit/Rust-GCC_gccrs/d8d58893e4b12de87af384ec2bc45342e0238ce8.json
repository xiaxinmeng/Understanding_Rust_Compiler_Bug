{"sha": "d8d58893e4b12de87af384ec2bc45342e0238ce8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDhkNTg4OTNlNGIxMmRlODdhZjM4NGVjMmJjNDUzNDJlMDIzOGNlOA==", "commit": {"author": {"name": "Paolo Carlini", "email": "paolo.carlini@oracle.com", "date": "2017-02-02T08:54:55Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2017-02-02T08:54:55Z"}, "message": "re PR c++/69637 (ICE on an invalid bit-field with template name for width)\n\n/cp\n2017-02-02  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/69637\n\t* decl2.c (grokbitfield): In case of error don't set-up DECL_INITIAL\n\tto the width.\n\n/testsuite\n2017-02-02  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/69637\n\t* g++.dg/cpp0x/pr69637-1.C: New.\n\t* g++.dg/cpp0x/pr69637-2.C: Likewise.\n\nFrom-SVN: r245117", "tree": {"sha": "4345a0724bf51384c4f8523ef2aba2ce4496accb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4345a0724bf51384c4f8523ef2aba2ce4496accb"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d8d58893e4b12de87af384ec2bc45342e0238ce8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d8d58893e4b12de87af384ec2bc45342e0238ce8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d8d58893e4b12de87af384ec2bc45342e0238ce8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d8d58893e4b12de87af384ec2bc45342e0238ce8/comments", "author": null, "committer": null, "parents": [{"sha": "521a70a405539df8f0a573091c9ceb46c31be5f5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/521a70a405539df8f0a573091c9ceb46c31be5f5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/521a70a405539df8f0a573091c9ceb46c31be5f5"}], "stats": {"total": 33, "additions": 31, "deletions": 2}, "files": [{"sha": "fbea09af7fc47aaf221eef725b6c91bee41e2c15", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d8d58893e4b12de87af384ec2bc45342e0238ce8/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d8d58893e4b12de87af384ec2bc45342e0238ce8/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=d8d58893e4b12de87af384ec2bc45342e0238ce8", "patch": "@@ -1,3 +1,9 @@\n+2017-02-02  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/69637\n+\t* decl2.c (grokbitfield): In case of error don't set-up DECL_INITIAL\n+\tto the width.\n+\n 2017-01-31  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR c++/79304"}, {"sha": "cecb6a145b707a7bc249f008b699ec8a0b951582", "filename": "gcc/cp/decl2.c", "status": "modified", "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d8d58893e4b12de87af384ec2bc45342e0238ce8/gcc%2Fcp%2Fdecl2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d8d58893e4b12de87af384ec2bc45342e0238ce8/gcc%2Fcp%2Fdecl2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl2.c?ref=d8d58893e4b12de87af384ec2bc45342e0238ce8", "patch": "@@ -1059,8 +1059,11 @@ grokbitfield (const cp_declarator *declarator,\n \t  && !INTEGRAL_OR_UNSCOPED_ENUMERATION_TYPE_P (TREE_TYPE (width)))\n \terror (\"width of bit-field %qD has non-integral type %qT\", value,\n \t       TREE_TYPE (width));\n-      DECL_INITIAL (value) = width;\n-      SET_DECL_C_BIT_FIELD (value);\n+      else\n+\t{\n+\t  DECL_INITIAL (value) = width;\n+\t  SET_DECL_C_BIT_FIELD (value);\n+\t}\n     }\n \n   DECL_IN_AGGR_P (value) = 1;"}, {"sha": "a164883c20417399ce7e9a1e6210d813ff373a6a", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d8d58893e4b12de87af384ec2bc45342e0238ce8/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d8d58893e4b12de87af384ec2bc45342e0238ce8/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=d8d58893e4b12de87af384ec2bc45342e0238ce8", "patch": "@@ -1,3 +1,9 @@\n+2017-02-02  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/69637\n+\t* g++.dg/cpp0x/pr69637-1.C: New.\n+\t* g++.dg/cpp0x/pr69637-2.C: Likewise.\n+\n 2017-02-02  Andreas Krebbel  <krebbel@linux.vnet.ibm.com>\n \n \t* gcc.target/s390/s390.exp: Rename __S390_VX__ to __VX__."}, {"sha": "b8c22ebc8698fdbf2ed8f5359eee3ce29a1740a3", "filename": "gcc/testsuite/g++.dg/cpp0x/pr69637-1.C", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d8d58893e4b12de87af384ec2bc45342e0238ce8/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fpr69637-1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d8d58893e4b12de87af384ec2bc45342e0238ce8/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fpr69637-1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fpr69637-1.C?ref=d8d58893e4b12de87af384ec2bc45342e0238ce8", "patch": "@@ -0,0 +1,8 @@\n+// { dg-do compile { target c++11 } }\n+\n+template <class T>\n+int foo () { return 1; }\n+\n+struct B {\n+    unsigned c: foo;  // { dg-error \"non-integral type\" }\n+};"}, {"sha": "c6523932972f0a16a66fb5de3cfe7b87bae51df8", "filename": "gcc/testsuite/g++.dg/cpp0x/pr69637-2.C", "status": "added", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d8d58893e4b12de87af384ec2bc45342e0238ce8/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fpr69637-2.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d8d58893e4b12de87af384ec2bc45342e0238ce8/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fpr69637-2.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fpr69637-2.C?ref=d8d58893e4b12de87af384ec2bc45342e0238ce8", "patch": "@@ -0,0 +1,6 @@\n+// { dg-do compile { target c++11 } }\n+\n+template <class T, int N>\n+constexpr int foo () { return N; }\n+\n+struct B { unsigned c: foo<int>, 3(); };  // { dg-error \"non-integral type|expected\" }"}]}