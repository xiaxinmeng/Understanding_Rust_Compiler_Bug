{"sha": "620188c9f20847558d91a0fa3be1c04f31e8d646", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjIwMTg4YzlmMjA4NDc1NThkOTFhMGZhM2JlMWMwNGYzMWU4ZDY0Ng==", "commit": {"author": {"name": "Volker Reichelt", "email": "reichelt@igpm.rwth-aachen.de", "date": "2006-05-06T00:40:40Z"}, "committer": {"name": "Volker Reichelt", "email": "reichelt@gcc.gnu.org", "date": "2006-05-06T00:40:40Z"}, "message": "re PR c++/27430 (ICE on array of voids as template parameter)\n\n\tPR c++/27430\n\t* pt.c (process_template_parm): Handle erroneous non-type parameters.\n\n\t* g++.dg/template/void1.C: New test.\n\nFrom-SVN: r113572", "tree": {"sha": "9141fbbecb4d94f135eb91d5b293886fd995b56d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9141fbbecb4d94f135eb91d5b293886fd995b56d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/620188c9f20847558d91a0fa3be1c04f31e8d646", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/620188c9f20847558d91a0fa3be1c04f31e8d646", "html_url": "https://github.com/Rust-GCC/gccrs/commit/620188c9f20847558d91a0fa3be1c04f31e8d646", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/620188c9f20847558d91a0fa3be1c04f31e8d646/comments", "author": null, "committer": null, "parents": [{"sha": "57b529596a083ba3e972a5b452e00b030a6592f5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/57b529596a083ba3e972a5b452e00b030a6592f5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/57b529596a083ba3e972a5b452e00b030a6592f5"}], "stats": {"total": 27, "additions": 21, "deletions": 6}, "files": [{"sha": "2fcb8934171d67cc7c0ceaae2406061fdad3df0f", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/620188c9f20847558d91a0fa3be1c04f31e8d646/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/620188c9f20847558d91a0fa3be1c04f31e8d646/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=620188c9f20847558d91a0fa3be1c04f31e8d646", "patch": "@@ -1,5 +1,8 @@\n 2006-05-06  Volker Reichelt  <reichelt@igpm.rwth-aachen.de>\n \n+\tPR c++/27430\n+\t* pt.c (process_template_parm): Handle erroneous non-type parameters.\n+\n \tPR c++/27423\n \t* typeck.c (convert_for_initialization): Skip erroneous types.\n "}, {"sha": "614de414cc0c3135bfb103f3d409bc68d186cde5", "filename": "gcc/cp/pt.c", "status": "modified", "additions": 11, "deletions": 6, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/620188c9f20847558d91a0fa3be1c04f31e8d646/gcc%2Fcp%2Fpt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/620188c9f20847558d91a0fa3be1c04f31e8d646/gcc%2Fcp%2Fpt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fpt.c?ref=620188c9f20847558d91a0fa3be1c04f31e8d646", "patch": "@@ -2347,18 +2347,23 @@ process_template_parm (tree list, tree next, bool is_non_type)\n \n       SET_DECL_TEMPLATE_PARM_P (parm);\n \n-      /* [temp.param]\n+      if (TREE_TYPE (parm) == error_mark_node)\n+\tTREE_TYPE (parm) = void_type_node;\n+      else\n+      {\n+\t/* [temp.param]\n \n-\t The top-level cv-qualifiers on the template-parameter are\n-\t ignored when determining its type.  */\n-      TREE_TYPE (parm) = TYPE_MAIN_VARIANT (TREE_TYPE (parm));\n+\t   The top-level cv-qualifiers on the template-parameter are\n+\t   ignored when determining its type.  */\n+\tTREE_TYPE (parm) = TYPE_MAIN_VARIANT (TREE_TYPE (parm));\n+\tif (invalid_nontype_parm_type_p (TREE_TYPE (parm), 1))\n+\t  TREE_TYPE (parm) = void_type_node;\n+      }\n \n       /* A template parameter is not modifiable.  */\n       TREE_CONSTANT (parm) = 1;\n       TREE_INVARIANT (parm) = 1;\n       TREE_READONLY (parm) = 1;\n-      if (invalid_nontype_parm_type_p (TREE_TYPE (parm), 1))\n-\tTREE_TYPE (parm) = void_type_node;\n       decl = build_decl (CONST_DECL, DECL_NAME (parm), TREE_TYPE (parm));\n       TREE_CONSTANT (decl) = 1;\n       TREE_INVARIANT (decl) = 1;"}, {"sha": "d259e40353203c212b7c3ee438289e0f84ad86cc", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/620188c9f20847558d91a0fa3be1c04f31e8d646/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/620188c9f20847558d91a0fa3be1c04f31e8d646/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=620188c9f20847558d91a0fa3be1c04f31e8d646", "patch": "@@ -1,5 +1,8 @@\n 2006-05-06  Volker Reichelt  <reichelt@igpm.rwth-aachen.de>\n \n+\tPR c++/27430\n+\t* g++.dg/template/void1.C: New test.\n+\n \tPR c++/27423\n \t* g++.dg/other/void2.C: New test.\n "}, {"sha": "732e9d06ecbc7569d15cc90bcb01d5820721f914", "filename": "gcc/testsuite/g++.dg/template/void1.C", "status": "added", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/620188c9f20847558d91a0fa3be1c04f31e8d646/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fvoid1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/620188c9f20847558d91a0fa3be1c04f31e8d646/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fvoid1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fvoid1.C?ref=620188c9f20847558d91a0fa3be1c04f31e8d646", "patch": "@@ -0,0 +1,4 @@\n+// PR c++/27430\n+// { dg-do compile }\n+\n+template<void[]> struct A;  // { dg-error \"array of void\" }"}]}