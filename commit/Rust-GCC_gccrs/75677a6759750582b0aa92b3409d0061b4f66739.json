{"sha": "75677a6759750582b0aa92b3409d0061b4f66739", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzU2NzdhNjc1OTc1MDU4MmIwYWE5MmIzNDA5ZDAwNjFiNGY2NjczOQ==", "commit": {"author": {"name": "David Malcolm", "email": "dmalcolm@redhat.com", "date": "2014-09-05T13:58:29Z"}, "committer": {"name": "David Malcolm", "email": "dmalcolm@gcc.gnu.org", "date": "2014-09-05T13:58:29Z"}, "message": "Use rtx_jump_table_data in jump.c:delete_related_insns\n\ngcc/ChangeLog\n2014-09-05  David Malcolm  <dmalcolm@redhat.com>\n\n\t* jump.c (delete_related_insns): Introduce a new local \"table\" by\n\treplacing JUMP_TABLE_DATA_P with a dyn_cast, then use the\n\tget_labels method of \"table\" to simplify access to the labels in\n\tthe jump table.\n\nFrom-SVN: r214960", "tree": {"sha": "6cb50cacb39e660c495147b9a1c7f753bf05b947", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6cb50cacb39e660c495147b9a1c7f753bf05b947"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/75677a6759750582b0aa92b3409d0061b4f66739", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/75677a6759750582b0aa92b3409d0061b4f66739", "html_url": "https://github.com/Rust-GCC/gccrs/commit/75677a6759750582b0aa92b3409d0061b4f66739", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/75677a6759750582b0aa92b3409d0061b4f66739/comments", "author": {"login": "davidmalcolm", "id": 1553248, "node_id": "MDQ6VXNlcjE1NTMyNDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1553248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidmalcolm", "html_url": "https://github.com/davidmalcolm", "followers_url": "https://api.github.com/users/davidmalcolm/followers", "following_url": "https://api.github.com/users/davidmalcolm/following{/other_user}", "gists_url": "https://api.github.com/users/davidmalcolm/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidmalcolm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidmalcolm/subscriptions", "organizations_url": "https://api.github.com/users/davidmalcolm/orgs", "repos_url": "https://api.github.com/users/davidmalcolm/repos", "events_url": "https://api.github.com/users/davidmalcolm/events{/privacy}", "received_events_url": "https://api.github.com/users/davidmalcolm/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "35b5c75197e5b3a2d8317b7fdf7c7eb33994f6d0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/35b5c75197e5b3a2d8317b7fdf7c7eb33994f6d0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/35b5c75197e5b3a2d8317b7fdf7c7eb33994f6d0"}], "stats": {"total": 19, "additions": 13, "deletions": 6}, "files": [{"sha": "8c355dca714dea30a6f42aa1186517fcb3d83826", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/75677a6759750582b0aa92b3409d0061b4f66739/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/75677a6759750582b0aa92b3409d0061b4f66739/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=75677a6759750582b0aa92b3409d0061b4f66739", "patch": "@@ -1,3 +1,10 @@\n+2014-09-05  David Malcolm  <dmalcolm@redhat.com>\n+\n+\t* jump.c (delete_related_insns): Introduce a new local \"table\" by\n+\treplacing JUMP_TABLE_DATA_P with a dyn_cast, then use the\n+\tget_labels method of \"table\" to simplify access to the labels in\n+\tthe jump table.\n+\n 2014-09-05  Kyrylo Tkachov  <kyrylo.tkachov@arm.com>\n \n \t* config/arm/cortex-a53.md (cortex_a53_fpalu): Add f_rints, f_rintd,"}, {"sha": "84040da830782918510d26fc2722958fa30c7a81", "filename": "gcc/jump.c", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/75677a6759750582b0aa92b3409d0061b4f66739/gcc%2Fjump.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/75677a6759750582b0aa92b3409d0061b4f66739/gcc%2Fjump.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjump.c?ref=75677a6759750582b0aa92b3409d0061b4f66739", "patch": "@@ -1314,15 +1314,15 @@ delete_related_insns (rtx uncast_insn)\n \n   /* Likewise if we're deleting a dispatch table.  */\n \n-  if (JUMP_TABLE_DATA_P (insn))\n+  if (rtx_jump_table_data *table = dyn_cast <rtx_jump_table_data *> (insn))\n     {\n-      rtx pat = PATTERN (insn);\n-      int i, diff_vec_p = GET_CODE (pat) == ADDR_DIFF_VEC;\n-      int len = XVECLEN (pat, diff_vec_p);\n+      rtvec labels = table->get_labels ();\n+      int i;\n+      int len = GET_NUM_ELEM (labels);\n \n       for (i = 0; i < len; i++)\n-\tif (LABEL_NUSES (XEXP (XVECEXP (pat, diff_vec_p, i), 0)) == 0)\n-\t  delete_related_insns (XEXP (XVECEXP (pat, diff_vec_p, i), 0));\n+\tif (LABEL_NUSES (XEXP (RTVEC_ELT (labels, i), 0)) == 0)\n+\t  delete_related_insns (XEXP (RTVEC_ELT (labels, i), 0));\n       while (next && INSN_DELETED_P (next))\n \tnext = NEXT_INSN (next);\n       return next;"}]}