{"sha": "82893cba4bfeafc80795aa9ddb87a5ca5efae8dc", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODI4OTNjYmE0YmZlYWZjODA3OTVhYTlkZGI4N2E1Y2E1ZWZhZThkYw==", "commit": {"author": {"name": "Richard Guenther", "email": "rguenther@suse.de", "date": "2008-04-28T09:09:19Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2008-04-28T09:09:19Z"}, "message": "re PR tree-optimization/36066 (ICE with -O1 -finline-small-functions -ftree-vrp -funsafe-loop-optimizations)\n\n2008-04-28  Richard Guenther  <rguenther@suse.de>\n\n\tPR tree-optimization/36066\n\t* tree-vrp.c (execute_vrp): Cleanup the CFG only after finalizing\n\tSCEV and loop.\n\n\t* gcc.dg/torture/pr36066.c: New testcase.\n\nFrom-SVN: r134745", "tree": {"sha": "0e9890285b0982c413484fdd593f71255fd1a8f2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0e9890285b0982c413484fdd593f71255fd1a8f2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/82893cba4bfeafc80795aa9ddb87a5ca5efae8dc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/82893cba4bfeafc80795aa9ddb87a5ca5efae8dc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/82893cba4bfeafc80795aa9ddb87a5ca5efae8dc", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/82893cba4bfeafc80795aa9ddb87a5ca5efae8dc/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "e356fac8ab3d8fb47f07fc001e512696e6000a91", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e356fac8ab3d8fb47f07fc001e512696e6000a91", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e356fac8ab3d8fb47f07fc001e512696e6000a91"}], "stats": {"total": 70, "additions": 66, "deletions": 4}, "files": [{"sha": "6d3eec1e864bea4a0f0feb86391c3f4e99ff471f", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/82893cba4bfeafc80795aa9ddb87a5ca5efae8dc/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/82893cba4bfeafc80795aa9ddb87a5ca5efae8dc/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=82893cba4bfeafc80795aa9ddb87a5ca5efae8dc", "patch": "@@ -1,3 +1,9 @@\n+2008-04-28  Richard Guenther  <rguenther@suse.de>\n+\n+\tPR tree-optimization/36066\n+\t* tree-vrp.c (execute_vrp): Cleanup the CFG only after finalizing\n+\tSCEV and loop.\n+\n 2008-04-28  Uros Bizjak  <ubizjak@gmail.com>\n \n \tPR target/36064"}, {"sha": "78d868bd0e25926beeb2c760dde7fdb0230c8e50", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/82893cba4bfeafc80795aa9ddb87a5ca5efae8dc/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/82893cba4bfeafc80795aa9ddb87a5ca5efae8dc/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=82893cba4bfeafc80795aa9ddb87a5ca5efae8dc", "patch": "@@ -1,3 +1,8 @@\n+2008-04-28  Richard Guenther  <rguenther@suse.de>\n+\n+\tPR tree-optimization/36066\n+\t* gcc.dg/torture/pr36066.c: New testcase.\n+\n 2008-04-28  Uros Bizjak  <ubizjak@gmail.com>\n \n \tPR target/36064"}, {"sha": "0e1d1ce3040d9845aaf7d9f744b5f52836f08f45", "filename": "gcc/testsuite/gcc.dg/torture/pr36066.c", "status": "added", "additions": 54, "deletions": 0, "changes": 54, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/82893cba4bfeafc80795aa9ddb87a5ca5efae8dc/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr36066.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/82893cba4bfeafc80795aa9ddb87a5ca5efae8dc/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr36066.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr36066.c?ref=82893cba4bfeafc80795aa9ddb87a5ca5efae8dc", "patch": "@@ -0,0 +1,54 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-funsafe-loop-optimizations -ftree-vrp\" } */\n+\n+typedef int FLAC__int32;\n+typedef int FLAC__bool;\n+typedef struct { } FLAC__Subframe;\n+typedef enum { FLAC__CHANNEL_ASSIGNMENT_INDEPENDENT = 0,  FLAC__CHANNEL_ASSIGNMENT_LEFT_SIDE = 1,  FLAC__CHANNEL_ASSIGNMENT_RIGHT_SIDE = 2,  FLAC__CHANNEL_ASSIGNMENT_MID_SIDE = 3 } FLAC__ChannelAssignment;\n+typedef struct {\n+  struct FLAC__StreamEncoderProtected *protected_;\n+  struct FLAC__StreamEncoderPrivate *private_;\n+} FLAC__StreamEncoder;\n+typedef struct FLAC__StreamEncoderProtected {\n+  FLAC__bool loose_mid_side_stereo;\n+  unsigned channels;\n+  unsigned blocksize;\n+} FLAC__StreamEncoderProtected;\n+typedef struct FLAC__StreamEncoderPrivate {\n+  FLAC__int32 *integer_signal[(8u)];\n+  FLAC__Subframe subframe_workspace_mid_side[2][2];\n+  unsigned best_subframe_mid_side[2];\n+  unsigned loose_mid_side_stereo_frame_count;\n+} FLAC__StreamEncoderPrivate;\n+static void get_wasted_bits_(FLAC__int32 signal[], unsigned samples)\n+{\n+  unsigned i;\n+  FLAC__int32 x = 0;\n+  for(i = 0; i < samples && !(x&1); i++)\n+    x |= signal[i];\n+}\n+FLAC__Subframe * process_subframes_(FLAC__StreamEncoder *encoder, unsigned *bits)\n+{\n+  unsigned channel;\n+  FLAC__Subframe *left_subframe = 0;\n+  FLAC__ChannelAssignment channel_assignment;\n+  for(channel = 0; channel < encoder->protected_->channels; channel++)\n+      get_wasted_bits_(encoder->private_->integer_signal[channel], encoder->protected_->blocksize);\n+  if(encoder->protected_->loose_mid_side_stereo && encoder->private_->loose_mid_side_stereo_frame_count > 0)\n+      channel_assignment = FLAC__CHANNEL_ASSIGNMENT_MID_SIDE;\n+  else {\n+      FLAC__ChannelAssignment ca = (FLAC__ChannelAssignment)1;\n+      unsigned min_bits = bits[0];\n+      for(channel_assignment = (FLAC__ChannelAssignment)0; (int)ca <= 3; ca = (FLAC__ChannelAssignment)((int)ca + 1))\n+\t  if(bits[ca] < min_bits)\n+\t      channel_assignment = ca;\n+  }\n+  switch(channel_assignment) {\n+      case FLAC__CHANNEL_ASSIGNMENT_INDEPENDENT:\n+      case FLAC__CHANNEL_ASSIGNMENT_LEFT_SIDE:\n+      case FLAC__CHANNEL_ASSIGNMENT_RIGHT_SIDE:\n+      case FLAC__CHANNEL_ASSIGNMENT_MID_SIDE:\n+\t  left_subframe = &encoder->private_->subframe_workspace_mid_side[0][encoder->private_->best_subframe_mid_side[0]];\n+  }\n+  return left_subframe;\n+}"}, {"sha": "4b409e46aafef33d721f29c1c3c3c7ba3ee1431c", "filename": "gcc/tree-vrp.c", "status": "modified", "additions": 1, "deletions": 4, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/82893cba4bfeafc80795aa9ddb87a5ca5efae8dc/gcc%2Ftree-vrp.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/82893cba4bfeafc80795aa9ddb87a5ca5efae8dc/gcc%2Ftree-vrp.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-vrp.c?ref=82893cba4bfeafc80795aa9ddb87a5ca5efae8dc", "patch": "@@ -6753,10 +6753,7 @@ execute_vrp (void)\n     SWITCH_LABELS (su->stmt) = su->vec;\n \n   if (VEC_length (edge, to_remove_edges) > 0)\n-    {\n-      free_dominance_info (CDI_DOMINATORS);\n-      cleanup_tree_cfg ();\n-    }\n+    free_dominance_info (CDI_DOMINATORS);\n \n   VEC_free (edge, heap, to_remove_edges);\n   VEC_free (switch_update, heap, to_update_switch_stmts);"}]}