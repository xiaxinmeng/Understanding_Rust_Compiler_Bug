{"sha": "c1b7d28a5987e74232b7f054849f8bd8ccc7e7de", "node_id": "C_kwDOANBUbNoAKGMxYjdkMjhhNTk4N2U3NDIzMmI3ZjA1NDg0OWY4YmQ4Y2NjN2U3ZGU", "commit": {"author": {"name": "David Malcolm", "email": "dmalcolm@redhat.com", "date": "2022-01-07T18:49:28Z"}, "committer": {"name": "David Malcolm", "email": "dmalcolm@redhat.com", "date": "2022-01-08T00:03:28Z"}, "message": "analyzer: add region::is_named_decl_p\n\nThis patch adds a debug function that I've found handy when debugging\na problem with handling the decl \"yy_buffer_stack\" in PR analyzer/103546.\n\ngcc/analyzer/ChangeLog:\n\t* region.cc (region::is_named_decl_p): New.\n\t* region.h (region::is_named_decl_p): New decl.\n\ngcc/ChangeLog:\n\t* doc/analyzer.texi (Other Debugging Techniques): Document\n\tregion::is_named_decl_p.\n\nSigned-off-by: David Malcolm <dmalcolm@redhat.com>", "tree": {"sha": "4bb86b66b24a8b4caaab9154b0ede0cb5a688c75", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4bb86b66b24a8b4caaab9154b0ede0cb5a688c75"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c1b7d28a5987e74232b7f054849f8bd8ccc7e7de", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c1b7d28a5987e74232b7f054849f8bd8ccc7e7de", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c1b7d28a5987e74232b7f054849f8bd8ccc7e7de", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c1b7d28a5987e74232b7f054849f8bd8ccc7e7de/comments", "author": {"login": "davidmalcolm", "id": 1553248, "node_id": "MDQ6VXNlcjE1NTMyNDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1553248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidmalcolm", "html_url": "https://github.com/davidmalcolm", "followers_url": "https://api.github.com/users/davidmalcolm/followers", "following_url": "https://api.github.com/users/davidmalcolm/following{/other_user}", "gists_url": "https://api.github.com/users/davidmalcolm/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidmalcolm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidmalcolm/subscriptions", "organizations_url": "https://api.github.com/users/davidmalcolm/orgs", "repos_url": "https://api.github.com/users/davidmalcolm/repos", "events_url": "https://api.github.com/users/davidmalcolm/events{/privacy}", "received_events_url": "https://api.github.com/users/davidmalcolm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "davidmalcolm", "id": 1553248, "node_id": "MDQ6VXNlcjE1NTMyNDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1553248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidmalcolm", "html_url": "https://github.com/davidmalcolm", "followers_url": "https://api.github.com/users/davidmalcolm/followers", "following_url": "https://api.github.com/users/davidmalcolm/following{/other_user}", "gists_url": "https://api.github.com/users/davidmalcolm/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidmalcolm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidmalcolm/subscriptions", "organizations_url": "https://api.github.com/users/davidmalcolm/orgs", "repos_url": "https://api.github.com/users/davidmalcolm/repos", "events_url": "https://api.github.com/users/davidmalcolm/events{/privacy}", "received_events_url": "https://api.github.com/users/davidmalcolm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6cd51207f5732b5258e883e9030b94c987b6d696", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6cd51207f5732b5258e883e9030b94c987b6d696", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6cd51207f5732b5258e883e9030b94c987b6d696"}], "stats": {"total": 26, "additions": 26, "deletions": 0}, "files": [{"sha": "161e7e1fb10ad7b0ecf4788e185c9754321ec4c3", "filename": "gcc/analyzer/region.cc", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c1b7d28a5987e74232b7f054849f8bd8ccc7e7de/gcc%2Fanalyzer%2Fregion.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c1b7d28a5987e74232b7f054849f8bd8ccc7e7de/gcc%2Fanalyzer%2Fregion.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fanalyzer%2Fregion.cc?ref=c1b7d28a5987e74232b7f054849f8bd8ccc7e7de", "patch": "@@ -638,6 +638,20 @@ region::symbolic_for_unknown_ptr_p () const\n   return false;\n }\n \n+/* Return true if this is a region for a decl with name DECL_NAME.\n+   Intended for use when debugging (for assertions and conditional\n+   breakpoints).  */\n+\n+DEBUG_FUNCTION bool\n+region::is_named_decl_p (const char *decl_name) const\n+{\n+  if (tree decl = maybe_get_decl ())\n+    if (DECL_NAME (decl)\n+\t&& !strcmp (IDENTIFIER_POINTER (DECL_NAME (decl)), decl_name))\n+      return true;\n+  return false;\n+}\n+\n /* region's ctor.  */\n \n region::region (complexity c, unsigned id, const region *parent, tree type)"}, {"sha": "d97bbc1e3f119d68a8e2e888c38179fef3f2ce97", "filename": "gcc/analyzer/region.h", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c1b7d28a5987e74232b7f054849f8bd8ccc7e7de/gcc%2Fanalyzer%2Fregion.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c1b7d28a5987e74232b7f054849f8bd8ccc7e7de/gcc%2Fanalyzer%2Fregion.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fanalyzer%2Fregion.h?ref=c1b7d28a5987e74232b7f054849f8bd8ccc7e7de", "patch": "@@ -189,6 +189,8 @@ class region\n \n   const complexity &get_complexity () const { return m_complexity; }\n \n+  bool is_named_decl_p (const char *decl_name) const;\n+\n  protected:\n   region (complexity c, unsigned id, const region *parent, tree type);\n "}, {"sha": "62faac44d7f267ac623d9359c6c5fb8d947fb263", "filename": "gcc/doc/analyzer.texi", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c1b7d28a5987e74232b7f054849f8bd8ccc7e7de/gcc%2Fdoc%2Fanalyzer.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c1b7d28a5987e74232b7f054849f8bd8ccc7e7de/gcc%2Fdoc%2Fanalyzer.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdoc%2Fanalyzer.texi?ref=c1b7d28a5987e74232b7f054849f8bd8ccc7e7de", "patch": "@@ -545,3 +545,13 @@ and the exploded graph in compressed JSON form.\n One approach when tracking down where a particular bogus state is\n introduced into the @code{exploded_graph} is to add custom code to\n @code{program_state::validate}.\n+\n+The debug function @code{region::is_named_decl_p} can be used when debugging,\n+such as for assertions and conditional breakpoints.  For example, when\n+tracking down a bug in handling a decl called @code{yy_buffer_stack}, I\n+temporarily added a:\n+@smallexample\n+  gcc_assert (!m_base_region->is_named_decl_p (\"yy_buffer_stack\"));\n+@end smallexample\n+to @code{binding_cluster::mark_as_escaped} to trap a point where\n+@code{yy_buffer_stack} was mistakenly being treated as having escaped."}]}