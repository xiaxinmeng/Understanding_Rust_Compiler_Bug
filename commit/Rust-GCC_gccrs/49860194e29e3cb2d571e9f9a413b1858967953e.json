{"sha": "49860194e29e3cb2d571e9f9a413b1858967953e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDk4NjAxOTRlMjllM2NiMmQ1NzFlOWY5YTQxM2IxODU4OTY3OTUzZQ==", "commit": {"author": {"name": "Janus Weil", "email": "janus@gcc.gnu.org", "date": "2011-07-02T11:08:41Z"}, "committer": {"name": "Janus Weil", "email": "janus@gcc.gnu.org", "date": "2011-07-02T11:08:41Z"}, "message": "re PR fortran/49562 ([OOP] assigning value to type-bound function)\n\n2011-07-02  Janus Weil  <janus@gcc.gnu.org>\n\n\tPR fortran/49562\n\t* expr.c (gfc_check_vardef_context): Handle type-bound procedures.\n\n\n2011-07-02  Janus Weil  <janus@gcc.gnu.org>\n\n\tPR fortran/49562\n\t* gfortran.dg/typebound_proc_23.f90: New.\n\nFrom-SVN: r175779", "tree": {"sha": "194e50799fdad51cd3329c541e98334d6d907ca8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/194e50799fdad51cd3329c541e98334d6d907ca8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/49860194e29e3cb2d571e9f9a413b1858967953e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/49860194e29e3cb2d571e9f9a413b1858967953e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/49860194e29e3cb2d571e9f9a413b1858967953e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/49860194e29e3cb2d571e9f9a413b1858967953e/comments", "author": {"login": "janusw", "id": 484108, "node_id": "MDQ6VXNlcjQ4NDEwOA==", "avatar_url": "https://avatars.githubusercontent.com/u/484108?v=4", "gravatar_id": "", "url": "https://api.github.com/users/janusw", "html_url": "https://github.com/janusw", "followers_url": "https://api.github.com/users/janusw/followers", "following_url": "https://api.github.com/users/janusw/following{/other_user}", "gists_url": "https://api.github.com/users/janusw/gists{/gist_id}", "starred_url": "https://api.github.com/users/janusw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/janusw/subscriptions", "organizations_url": "https://api.github.com/users/janusw/orgs", "repos_url": "https://api.github.com/users/janusw/repos", "events_url": "https://api.github.com/users/janusw/events{/privacy}", "received_events_url": "https://api.github.com/users/janusw/received_events", "type": "User", "site_admin": false}, "committer": {"login": "janusw", "id": 484108, "node_id": "MDQ6VXNlcjQ4NDEwOA==", "avatar_url": "https://avatars.githubusercontent.com/u/484108?v=4", "gravatar_id": "", "url": "https://api.github.com/users/janusw", "html_url": "https://github.com/janusw", "followers_url": "https://api.github.com/users/janusw/followers", "following_url": "https://api.github.com/users/janusw/following{/other_user}", "gists_url": "https://api.github.com/users/janusw/gists{/gist_id}", "starred_url": "https://api.github.com/users/janusw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/janusw/subscriptions", "organizations_url": "https://api.github.com/users/janusw/orgs", "repos_url": "https://api.github.com/users/janusw/repos", "events_url": "https://api.github.com/users/janusw/events{/privacy}", "received_events_url": "https://api.github.com/users/janusw/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "fe8ac8e43d54eaaef142de4ce74864bf0eb1c3b3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fe8ac8e43d54eaaef142de4ce74864bf0eb1c3b3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fe8ac8e43d54eaaef142de4ce74864bf0eb1c3b3"}], "stats": {"total": 47, "additions": 44, "deletions": 3}, "files": [{"sha": "e2d5d124dac0024a4e9845daa48968074a9e1d13", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/49860194e29e3cb2d571e9f9a413b1858967953e/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/49860194e29e3cb2d571e9f9a413b1858967953e/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=49860194e29e3cb2d571e9f9a413b1858967953e", "patch": "@@ -1,3 +1,8 @@\n+2011-07-02  Janus Weil  <janus@gcc.gnu.org>\n+\n+\tPR fortran/49562\n+\t* expr.c (gfc_check_vardef_context): Handle type-bound procedures.\n+\n 2011-06-30  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR fortran/49540"}, {"sha": "6dcfda1e53abee8a1b42dad043b5ec42f13e621d", "filename": "gcc/fortran/expr.c", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/49860194e29e3cb2d571e9f9a413b1858967953e/gcc%2Ffortran%2Fexpr.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/49860194e29e3cb2d571e9f9a413b1858967953e/gcc%2Ffortran%2Fexpr.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fexpr.c?ref=49860194e29e3cb2d571e9f9a413b1858967953e", "patch": "@@ -4394,8 +4394,8 @@ gfc_check_vardef_context (gfc_expr* e, bool pointer, bool alloc_obj,\n       sym = e->value.function.esym ? e->value.function.esym : e->symtree->n.sym;\n     }\n \n-  if (!pointer && e->expr_type == EXPR_FUNCTION\n-      && sym->result->attr.pointer)\n+  attr = gfc_expr_attr (e);\n+  if (!pointer && e->expr_type == EXPR_FUNCTION && attr.pointer)\n     {\n       if (!(gfc_option.allow_std & GFC_STD_F2008))\n \t{\n@@ -4432,7 +4432,6 @@ gfc_check_vardef_context (gfc_expr* e, bool pointer, bool alloc_obj,\n \n   /* Find out whether the expr is a pointer; this also means following\n      component references to the last one.  */\n-  attr = gfc_expr_attr (e);\n   is_pointer = (attr.pointer || attr.proc_pointer);\n   if (pointer && !is_pointer)\n     {"}, {"sha": "925423540c80cec3c5ffd45c9663282f5a2215f9", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/49860194e29e3cb2d571e9f9a413b1858967953e/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/49860194e29e3cb2d571e9f9a413b1858967953e/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=49860194e29e3cb2d571e9f9a413b1858967953e", "patch": "@@ -1,3 +1,8 @@\n+2011-07-02  Janus Weil  <janus@gcc.gnu.org>\n+\n+\tPR fortran/49562\n+\t* gfortran.dg/typebound_proc_23.f90: New.\n+\n 2011-07-01  Jonathan Wakely  <jwakely.gcc@gmail.com>\n \n \tPR c++/49605"}, {"sha": "ff682a41b367c0706f918f75015dd79cade17704", "filename": "gcc/testsuite/gfortran.dg/typebound_proc_23.f90", "status": "added", "additions": 32, "deletions": 0, "changes": 32, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/49860194e29e3cb2d571e9f9a413b1858967953e/gcc%2Ftestsuite%2Fgfortran.dg%2Ftypebound_proc_23.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/49860194e29e3cb2d571e9f9a413b1858967953e/gcc%2Ftestsuite%2Fgfortran.dg%2Ftypebound_proc_23.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Ftypebound_proc_23.f90?ref=49860194e29e3cb2d571e9f9a413b1858967953e", "patch": "@@ -0,0 +1,32 @@\n+! { dg-do run }\n+!\n+! PR 49562: [4.6/4.7 Regression] [OOP] assigning value to type-bound function\n+!\n+! Contributed by Hans-Werner Boschmann <boschmann@tp1.physik.uni-siegen.de>\n+\n+module ice\n+  type::ice_type\n+   contains\n+     procedure::ice_func\n+  end type\n+  integer, target :: it = 0\n+contains\n+  function ice_func(this)\n+    integer, pointer :: ice_func\n+    class(ice_type)::this\n+    ice_func => it\n+  end function ice_func\n+  subroutine ice_sub(a)\n+    class(ice_type)::a\n+    a%ice_func() = 1\n+  end subroutine ice_sub\n+end module\n+\n+use ice\n+type(ice_type) :: t\n+if (it/=0) call abort()\n+call ice_sub(t)\n+if (it/=1) call abort()\n+end\n+\n+! { dg-final { cleanup-modules \"ice\" } }"}]}