{"sha": "1e14c7f083611e88101a7842faeb89abdea2a2a8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWUxNGM3ZjA4MzYxMWU4ODEwMWE3ODQyZmFlYjg5YWJkZWEyYTJhOA==", "commit": {"author": {"name": "Gabriel Dos Reis", "email": "gdr@nerim.net", "date": "2002-08-07T00:38:00Z"}, "committer": {"name": "Gabriel Dos Reis", "email": "gdr@gcc.gnu.org", "date": "2002-08-07T00:38:00Z"}, "message": "typeck.c (build_x_unary_op): Handle pointer-to-member.\n\ncp/\n\t* typeck.c (build_x_unary_op): Handle pointer-to-member.\n\ntestsuite/\n\t* g++.dg/README (Subdirectories): Document new subdir expr.\n\t* g++.dg/expr/pmf-1.C: New test.\n\nFrom-SVN: r56082", "tree": {"sha": "1f4411c994c10c25ca5bac05f27ac39713d481b5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1f4411c994c10c25ca5bac05f27ac39713d481b5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1e14c7f083611e88101a7842faeb89abdea2a2a8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1e14c7f083611e88101a7842faeb89abdea2a2a8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1e14c7f083611e88101a7842faeb89abdea2a2a8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1e14c7f083611e88101a7842faeb89abdea2a2a8/comments", "author": null, "committer": null, "parents": [{"sha": "8d3e27d16b03f8d0ac468366502e4672188eabd9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8d3e27d16b03f8d0ac468366502e4672188eabd9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8d3e27d16b03f8d0ac468366502e4672188eabd9"}], "stats": {"total": 48, "additions": 48, "deletions": 0}, "files": [{"sha": "60b6cb239dcf38db1242b630b5db5e60ee272221", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1e14c7f083611e88101a7842faeb89abdea2a2a8/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1e14c7f083611e88101a7842faeb89abdea2a2a8/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=1e14c7f083611e88101a7842faeb89abdea2a2a8", "patch": "@@ -1,3 +1,7 @@\n+2002-08-06  Gabriel Dos Reis  <gdr@nerim.net>\n+\n+\t* typeck.c (build_x_unary_op): Handle pointer-to-member.\n+\n 2002-08-05  Geoffrey Keating  <geoffk@redhat.com>\n \n \t* class.c: Don't include obstack.h."}, {"sha": "399005bc6910f85b1171c58c6fc0523b1820561e", "filename": "gcc/cp/typeck.c", "status": "modified", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1e14c7f083611e88101a7842faeb89abdea2a2a8/gcc%2Fcp%2Ftypeck.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1e14c7f083611e88101a7842faeb89abdea2a2a8/gcc%2Fcp%2Ftypeck.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ftypeck.c?ref=1e14c7f083611e88101a7842faeb89abdea2a2a8", "patch": "@@ -3794,6 +3794,25 @@ build_x_unary_op (code, xarg)\n     }\n   if (code == ADDR_EXPR)\n     {\n+      /*  A pointer to member-function can be formed only by saying\n+\t  &X::mf.  */\n+      if (!flag_ms_extensions && TREE_CODE (TREE_TYPE (xarg)) == METHOD_TYPE\n+\t  && (TREE_CODE (xarg) != OFFSET_REF || !PTRMEM_OK_P (xarg)))\n+\t{\n+\t  if (TREE_CODE (xarg) != OFFSET_REF)\n+\t    {\n+\t      error (\"invalid use of '%E' to form a pointer-to-member-function.  Use a qualified-id.\",\n+\t\t     xarg);\n+\t      return error_mark_node;\n+\t    }\n+\t  else\n+\t    {\n+\t      error (\"parenthesis around '%E' cannot be used to form a pointer-to-member-function\",\n+\t\t     xarg);\n+\t      PTRMEM_OK_P (xarg) = 1;\n+\t    }\n+\t}\n+      \n       if (TREE_CODE (xarg) == OFFSET_REF)\n         {\n           ptrmem = PTRMEM_OK_P (xarg);"}, {"sha": "0acf870252be3731c857d5065cfd77a24b8b40ac", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1e14c7f083611e88101a7842faeb89abdea2a2a8/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1e14c7f083611e88101a7842faeb89abdea2a2a8/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=1e14c7f083611e88101a7842faeb89abdea2a2a8", "patch": "@@ -1,3 +1,8 @@\n+2002-08-07  Gabriel Dos Reis  <gdr@nerim.net>\n+\n+\t* g++.dg/README (Subdirectories): Document new subdir expr.\n+\t* g++.dg/expr/pmf-1.C: New test.\n+\n 2002-08-06  Neil Booth  <neil@daikokuya.co.uk>\n \n \t* gcc.dg/cpp/vararg3.c, gcc.dg/cpp/vararg4.c: New tests."}, {"sha": "073913f2056c5a19697a546e02aaa0a8fe57c131", "filename": "gcc/testsuite/g++.dg/README", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1e14c7f083611e88101a7842faeb89abdea2a2a8/gcc%2Ftestsuite%2Fg%2B%2B.dg%2FREADME", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1e14c7f083611e88101a7842faeb89abdea2a2a8/gcc%2Ftestsuite%2Fg%2B%2B.dg%2FREADME", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2FREADME?ref=1e14c7f083611e88101a7842faeb89abdea2a2a8", "patch": "@@ -2,6 +2,7 @@ Subdirectories:\n \n abi\t Tests for ABI compatibility -- mangling, object layout, etc.\n eh\t Tests for exception handling.\n+expr     Tests for expressions.\n ext\t Tests for GNU language extensions.\n inherit\t Tests for inheritance -- virtual functions, multiple inheritance, etc.\n init\t Tests for initialization semantics, constructors/destructors, etc."}, {"sha": "61457ecbdc65701e09602aa96cabe789a7e8ab03", "filename": "gcc/testsuite/g++.dg/expr/pmf-1.C", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1e14c7f083611e88101a7842faeb89abdea2a2a8/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fexpr%2Fpmf-1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1e14c7f083611e88101a7842faeb89abdea2a2a8/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fexpr%2Fpmf-1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fexpr%2Fpmf-1.C?ref=1e14c7f083611e88101a7842faeb89abdea2a2a8", "patch": "@@ -0,0 +1,19 @@\n+// C++ PR/2521\n+// Copyright (C) 2002 Free Software Foundation\n+// Contributed by Gabriel Dos Reis <gdr@integrable-solutions.net>\n+\n+// { dg-do compile }\n+\n+struct A \n+{\n+  void f();\n+  void foo(void (A::*)(int));       // { dg-error \"candidate\" \"\" }\n+  template<typename T>\n+    void g(T);\n+  void h()\n+  {\n+    void (A::*p)() = &A::f;\n+    void (A::*q)() = &(A::f);       // { dg-error \"parenthesis\" \"\" }\n+    foo(&g<int>);                   // { dg-error \"\" \"\" }\n+  }\n+};"}]}