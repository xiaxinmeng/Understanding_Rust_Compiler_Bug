{"sha": "81646a31577ecfcccac1ccb662012345361aa253", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODE2NDZhMzE1NzdlY2ZjY2NhYzFjY2I2NjIwMTIzNDUzNjFhYTI1Mw==", "commit": {"author": {"name": "Paolo Carlini", "email": "pcarlini@unitus.it", "date": "2002-11-05T23:28:15Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2002-11-05T23:28:15Z"}, "message": "re PR libstdc++/8466 (basic_stringbuf::str(basic_string const&) modifies its argument)\n\n2002-11-05  Paolo Carlini  <pcarlini@unitus.it>\n\n\tPR libstdc++/8466\n\t* include/std/std_sstream.h\n\t(basic_stringbuf::str(const __string_type&)):\n\tCannot use simple assignment since the COW-nature of v3\n\tbasic_string is not taken into account in basic_stringbuf.\n\t* testsuite/27_io/stringstream_members.cc: Add test04 from PR.\n\nFrom-SVN: r58838", "tree": {"sha": "f308c2759f4d62cb03bc1efb4f23c17d1b7bb7f5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f308c2759f4d62cb03bc1efb4f23c17d1b7bb7f5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/81646a31577ecfcccac1ccb662012345361aa253", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/81646a31577ecfcccac1ccb662012345361aa253", "html_url": "https://github.com/Rust-GCC/gccrs/commit/81646a31577ecfcccac1ccb662012345361aa253", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/81646a31577ecfcccac1ccb662012345361aa253/comments", "author": null, "committer": null, "parents": [{"sha": "e9577224cca5c707d48b5b529ff3e9a2dbeffcdb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e9577224cca5c707d48b5b529ff3e9a2dbeffcdb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e9577224cca5c707d48b5b529ff3e9a2dbeffcdb"}], "stats": {"total": 28, "additions": 27, "deletions": 1}, "files": [{"sha": "12ae0f0dbcc8e8ec4d0793e5526b8dc90295bace", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/81646a31577ecfcccac1ccb662012345361aa253/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/81646a31577ecfcccac1ccb662012345361aa253/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=81646a31577ecfcccac1ccb662012345361aa253", "patch": "@@ -1,3 +1,12 @@\n+2002-11-05  Paolo Carlini  <pcarlini@unitus.it>\n+\n+\tPR libstdc++/8466\n+\t* include/std/std_sstream.h\n+\t(basic_stringbuf::str(const __string_type&)):\n+\tCannot use simple assignment since the COW-nature of v3\n+\tbasic_string is not taken into account in basic_stringbuf.\n+\t* testsuite/27_io/stringstream_members.cc: Add test04 from PR.\n+\n 2002-11-05  John David Anglin  <dave@hiauly1.hia.nrc.ca>\n \n \t* configure.target (hppa*): Define cpu_include_dir."}, {"sha": "5eb43d09e599e704b4c451414499b88f4f6e0640", "filename": "libstdc++-v3/include/std/std_sstream.h", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/81646a31577ecfcccac1ccb662012345361aa253/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fstd_sstream.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/81646a31577ecfcccac1ccb662012345361aa253/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fstd_sstream.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fstd_sstream.h?ref=81646a31577ecfcccac1ccb662012345361aa253", "patch": "@@ -105,7 +105,8 @@ namespace std\n       void\n       str(const __string_type& __s)\n       {\n-\t_M_string = __s;\n+\t// Cannot use _M_string = __s, since v3 strings are COW.\n+\t_M_string.assign(__s.c_str(), __s.size());\n \t_M_stringbuf_init(_M_mode);\n       }\n "}, {"sha": "51635f72fd56c7b8b266e5e881fc20d0115a3512", "filename": "libstdc++-v3/testsuite/27_io/stringstream_members.cc", "status": "modified", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/81646a31577ecfcccac1ccb662012345361aa253/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Fstringstream_members.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/81646a31577ecfcccac1ccb662012345361aa253/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Fstringstream_members.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Fstringstream_members.cc?ref=81646a31577ecfcccac1ccb662012345361aa253", "patch": "@@ -177,10 +177,26 @@ test03()\n   std::stringstream ss2(str3, std::ios_base::in|std::ios_base::out);\n }\n \n+// libstdc++/8466\n+void test04()\n+{\n+  bool test = true;\n+\n+  const char* strlit00 = \"orvieto\";\n+  const std::string str00 = strlit00;\n+\n+  std::ostringstream oss;\n+\n+  oss.str(str00);\n+  oss << \"cortona\";\n+  VERIFY( str00 == strlit00 );\n+}\n+\n int main()\n {\n   test01();\n   test02();\n   test03();\n+  test04();\n   return 0;\n }"}]}