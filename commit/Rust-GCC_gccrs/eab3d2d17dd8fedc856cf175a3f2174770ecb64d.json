{"sha": "eab3d2d17dd8fedc856cf175a3f2174770ecb64d", "node_id": "C_kwDOANBUbNoAKGVhYjNkMmQxN2RkOGZlZGM4NTZjZjE3NWEzZjIxNzQ3NzBlY2I2NGQ", "commit": {"author": {"name": "Philipp Tomsich", "email": "philipp.tomsich@vrull.eu", "date": "2021-05-27T15:20:05Z"}, "committer": {"name": "Philipp Tomsich", "email": "philipp.tomsich@vrull.eu", "date": "2022-11-14T19:03:47Z"}, "message": "riscv: bitmanip: add orc.b as an unspec\n\nAs a basis for optimized string functions (e.g., the by-pieces\nimplementations), we need orc.b available.  This adds orc.b as an\nunspec, so we can expand to it.\n\ngcc/ChangeLog:\n\n\t* config/riscv/bitmanip.md (orcb<mode>2): Add orc.b as an\n\t  unspec.\n\t* config/riscv/riscv.md: Add UNSPEC_ORC_B.\n\nSigned-off-by: Philipp Tomsich <philipp.tomsich@vrull.eu>", "tree": {"sha": "8ef9edd57f27faa67aad3d70eb5a56559c0fad25", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8ef9edd57f27faa67aad3d70eb5a56559c0fad25"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/eab3d2d17dd8fedc856cf175a3f2174770ecb64d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/eab3d2d17dd8fedc856cf175a3f2174770ecb64d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/eab3d2d17dd8fedc856cf175a3f2174770ecb64d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/eab3d2d17dd8fedc856cf175a3f2174770ecb64d/comments", "author": {"login": "ptomsich", "id": 14983582, "node_id": "MDQ6VXNlcjE0OTgzNTgy", "avatar_url": "https://avatars.githubusercontent.com/u/14983582?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ptomsich", "html_url": "https://github.com/ptomsich", "followers_url": "https://api.github.com/users/ptomsich/followers", "following_url": "https://api.github.com/users/ptomsich/following{/other_user}", "gists_url": "https://api.github.com/users/ptomsich/gists{/gist_id}", "starred_url": "https://api.github.com/users/ptomsich/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ptomsich/subscriptions", "organizations_url": "https://api.github.com/users/ptomsich/orgs", "repos_url": "https://api.github.com/users/ptomsich/repos", "events_url": "https://api.github.com/users/ptomsich/events{/privacy}", "received_events_url": "https://api.github.com/users/ptomsich/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ptomsich", "id": 14983582, "node_id": "MDQ6VXNlcjE0OTgzNTgy", "avatar_url": "https://avatars.githubusercontent.com/u/14983582?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ptomsich", "html_url": "https://github.com/ptomsich", "followers_url": "https://api.github.com/users/ptomsich/followers", "following_url": "https://api.github.com/users/ptomsich/following{/other_user}", "gists_url": "https://api.github.com/users/ptomsich/gists{/gist_id}", "starred_url": "https://api.github.com/users/ptomsich/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ptomsich/subscriptions", "organizations_url": "https://api.github.com/users/ptomsich/orgs", "repos_url": "https://api.github.com/users/ptomsich/repos", "events_url": "https://api.github.com/users/ptomsich/events{/privacy}", "received_events_url": "https://api.github.com/users/ptomsich/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1d99e09106ad08a1e060a8d3343c123c3c115bcc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1d99e09106ad08a1e060a8d3343c123c3c115bcc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1d99e09106ad08a1e060a8d3343c123c3c115bcc"}], "stats": {"total": 11, "additions": 11, "deletions": 0}, "files": [{"sha": "48c249f2a68d38d30d2748c2723a4387ce770e44", "filename": "gcc/config/riscv/bitmanip.md", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eab3d2d17dd8fedc856cf175a3f2174770ecb64d/gcc%2Fconfig%2Friscv%2Fbitmanip.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eab3d2d17dd8fedc856cf175a3f2174770ecb64d/gcc%2Fconfig%2Friscv%2Fbitmanip.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Friscv%2Fbitmanip.md?ref=eab3d2d17dd8fedc856cf175a3f2174770ecb64d", "patch": "@@ -255,6 +255,14 @@\n   \"rolw\\t%0,%1,%2\"\n   [(set_attr \"type\" \"bitmanip\")])\n \n+;; orc.b (or-combine) is added as an unspec for the benefit of the support\n+;; for optimized string functions (such as strcmp).\n+(define_insn \"orcb<mode>2\"\n+  [(set (match_operand:X 0 \"register_operand\" \"=r\")\n+\t(unspec:X [(match_operand:X 1 \"register_operand\" \"r\")] UNSPEC_ORC_B))]\n+  \"TARGET_ZBB\"\n+  \"orc.b\\t%0,%1\")\n+\n (define_insn \"bswap<mode>2\"\n   [(set (match_operand:X 0 \"register_operand\" \"=r\")\n         (bswap:X (match_operand:X 1 \"register_operand\" \"r\")))]"}, {"sha": "532289dd1786979f4aa144c337d8016cb15c5a59", "filename": "gcc/config/riscv/riscv.md", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eab3d2d17dd8fedc856cf175a3f2174770ecb64d/gcc%2Fconfig%2Friscv%2Friscv.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eab3d2d17dd8fedc856cf175a3f2174770ecb64d/gcc%2Fconfig%2Friscv%2Friscv.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Friscv%2Friscv.md?ref=eab3d2d17dd8fedc856cf175a3f2174770ecb64d", "patch": "@@ -62,6 +62,9 @@\n \n   ;; Stack tie\n   UNSPEC_TIE\n+\n+  ;; OR-COMBINE\n+  UNSPEC_ORC_B\n ])\n \n (define_c_enum \"unspecv\" ["}]}