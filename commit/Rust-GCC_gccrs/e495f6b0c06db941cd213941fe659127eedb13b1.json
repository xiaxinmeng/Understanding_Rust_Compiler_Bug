{"sha": "e495f6b0c06db941cd213941fe659127eedb13b1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTQ5NWY2YjBjMDZkYjk0MWNkMjEzOTQxZmU2NTkxMjdlZWRiMTNiMQ==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@redhat.com", "date": "2011-09-12T18:04:39Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "2011-09-12T18:04:39Z"}, "message": "call.c (initialize_reference): Add flags parm.\n\n\t* call.c (initialize_reference): Add flags parm.\n\t* decl.c (grok_reference_init): Likewise.\n\t(check_initializer): Pass it.\n\t* typeck.c (convert_for_initialization): Likewise.\n\t* cp-tree.h: Adjust.\n\nFrom-SVN: r178788", "tree": {"sha": "f960a2c3ff3a52f0c1bf0c21ceb10130dcedaa70", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f960a2c3ff3a52f0c1bf0c21ceb10130dcedaa70"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e495f6b0c06db941cd213941fe659127eedb13b1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e495f6b0c06db941cd213941fe659127eedb13b1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e495f6b0c06db941cd213941fe659127eedb13b1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e495f6b0c06db941cd213941fe659127eedb13b1/comments", "author": {"login": "jicama", "id": 266146, "node_id": "MDQ6VXNlcjI2NjE0Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/266146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jicama", "html_url": "https://github.com/jicama", "followers_url": "https://api.github.com/users/jicama/followers", "following_url": "https://api.github.com/users/jicama/following{/other_user}", "gists_url": "https://api.github.com/users/jicama/gists{/gist_id}", "starred_url": "https://api.github.com/users/jicama/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jicama/subscriptions", "organizations_url": "https://api.github.com/users/jicama/orgs", "repos_url": "https://api.github.com/users/jicama/repos", "events_url": "https://api.github.com/users/jicama/events{/privacy}", "received_events_url": "https://api.github.com/users/jicama/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "dbbc379eaa586bae7a5f374fb6e294810af2ae80", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dbbc379eaa586bae7a5f374fb6e294810af2ae80", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dbbc379eaa586bae7a5f374fb6e294810af2ae80"}], "stats": {"total": 25, "additions": 17, "deletions": 8}, "files": [{"sha": "476173dbe5ff4870fc9e3d71833e44cfed9bc5d6", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e495f6b0c06db941cd213941fe659127eedb13b1/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e495f6b0c06db941cd213941fe659127eedb13b1/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=e495f6b0c06db941cd213941fe659127eedb13b1", "patch": "@@ -1,5 +1,11 @@\n 2011-09-12  Jason Merrill  <jason@redhat.com>\n \n+\t* call.c (initialize_reference): Add flags parm.\n+\t* decl.c (grok_reference_init): Likewise.\n+\t(check_initializer): Pass it.\n+\t* typeck.c (convert_for_initialization): Likewise.\n+\t* cp-tree.h: Adjust.\n+\n \t* cp-tree.h (LOOKUP_NO_RVAL_BIND): New.\n \t* call.c (conditional_conversion): Use it.\n \t(reference_binding): Fix handling of xvalues."}, {"sha": "7912fad00c1fc34eb20b2fcde6dca3adf6720721", "filename": "gcc/cp/call.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e495f6b0c06db941cd213941fe659127eedb13b1/gcc%2Fcp%2Fcall.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e495f6b0c06db941cd213941fe659127eedb13b1/gcc%2Fcp%2Fcall.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fcall.c?ref=e495f6b0c06db941cd213941fe659127eedb13b1", "patch": "@@ -8717,7 +8717,7 @@ set_up_extended_ref_temp (tree decl, tree expr, tree *cleanup, tree *initp)\n \n tree\n initialize_reference (tree type, tree expr, tree decl, tree *cleanup,\n-\t\t      tsubst_flags_t complain)\n+\t\t      int flags, tsubst_flags_t complain)\n {\n   conversion *conv;\n   void *p;\n@@ -8729,7 +8729,7 @@ initialize_reference (tree type, tree expr, tree decl, tree *cleanup,\n   p = conversion_obstack_alloc (0);\n \n   conv = reference_binding (type, TREE_TYPE (expr), expr, /*c_cast_p=*/false,\n-\t\t\t    LOOKUP_NORMAL);\n+\t\t\t    flags);\n   if (!conv || conv->bad_p)\n     {\n       if (complain & tf_error)"}, {"sha": "12a289571df00d25e07cfbf18f833f79bc646d21", "filename": "gcc/cp/cp-tree.h", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e495f6b0c06db941cd213941fe659127eedb13b1/gcc%2Fcp%2Fcp-tree.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e495f6b0c06db941cd213941fe659127eedb13b1/gcc%2Fcp%2Fcp-tree.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fcp-tree.h?ref=e495f6b0c06db941cd213941fe659127eedb13b1", "patch": "@@ -4757,7 +4757,8 @@ extern tree type_passed_as\t\t\t(tree);\n extern tree convert_for_arg_passing\t\t(tree, tree);\n extern bool is_properly_derived_from\t\t(tree, tree);\n extern tree set_up_extended_ref_temp\t\t(tree, tree, tree *, tree *);\n-extern tree initialize_reference\t\t(tree, tree, tree, tree *, tsubst_flags_t);\n+extern tree initialize_reference\t\t(tree, tree, tree, tree *, int,\n+\t\t\t\t\t\t tsubst_flags_t);\n extern tree make_temporary_var_for_ref_to_temp\t(tree, tree);\n extern tree strip_top_quals\t\t\t(tree);\n extern bool reference_related_p\t\t\t(tree, tree);"}, {"sha": "dc49eb2883ba46bbf3cdc622e511c69f1e7ca9e5", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e495f6b0c06db941cd213941fe659127eedb13b1/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e495f6b0c06db941cd213941fe659127eedb13b1/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=e495f6b0c06db941cd213941fe659127eedb13b1", "patch": "@@ -71,7 +71,7 @@ static void require_complete_types_for_parms (tree);\n static int ambi_op_p (enum tree_code);\n static int unary_op_p (enum tree_code);\n static void push_local_name (tree);\n-static tree grok_reference_init (tree, tree, tree, tree *);\n+static tree grok_reference_init (tree, tree, tree, tree *, int);\n static tree grokvardecl (tree, tree, const cp_decl_specifier_seq *,\n \t\t\t int, int, tree);\n static int check_static_variable_definition (tree, tree);\n@@ -4574,7 +4574,8 @@ start_decl_1 (tree decl, bool initialized)\n    Quotes on semantics can be found in ARM 8.4.3.  */\n \n static tree\n-grok_reference_init (tree decl, tree type, tree init, tree *cleanup)\n+grok_reference_init (tree decl, tree type, tree init, tree *cleanup,\n+\t\t     int flags)\n {\n   tree tmp;\n \n@@ -4603,7 +4604,8 @@ grok_reference_init (tree decl, tree type, tree init, tree *cleanup)\n      DECL_INITIAL for local references (instead assigning to them\n      explicitly); we need to allow the temporary to be initialized\n      first.  */\n-  tmp = initialize_reference (type, init, decl, cleanup, tf_warning_or_error);\n+  tmp = initialize_reference (type, init, decl, cleanup, flags,\n+\t\t\t      tf_warning_or_error);\n   if (DECL_DECLARED_CONSTEXPR_P (decl))\n     {\n       tmp = cxx_constant_value (tmp);\n@@ -5468,7 +5470,7 @@ check_initializer (tree decl, tree init, int flags, tree *cleanup)\n   else if (!init && DECL_REALLY_EXTERN (decl))\n     ;\n   else if (TREE_CODE (type) == REFERENCE_TYPE)\n-    init = grok_reference_init (decl, type, init, cleanup);\n+    init = grok_reference_init (decl, type, init, cleanup, flags);\n   else if (init || type_build_ctor_call (type))\n     {\n       if (!init)"}, {"sha": "ed52f3c4f3f6837496716a637c3ccfa2346f8a92", "filename": "gcc/cp/typeck.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e495f6b0c06db941cd213941fe659127eedb13b1/gcc%2Fcp%2Ftypeck.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e495f6b0c06db941cd213941fe659127eedb13b1/gcc%2Fcp%2Ftypeck.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ftypeck.c?ref=e495f6b0c06db941cd213941fe659127eedb13b1", "patch": "@@ -7510,7 +7510,7 @@ convert_for_initialization (tree exp, tree type, tree rhs, int flags,\n       if (fndecl)\n \tsavew = warningcount, savee = errorcount;\n       rhs = initialize_reference (type, rhs, /*decl=*/NULL_TREE,\n-\t\t\t\t  /*cleanup=*/NULL, complain);\n+\t\t\t\t  /*cleanup=*/NULL, flags, complain);\n       if (fndecl)\n \t{\n \t  if (warningcount > savew)"}]}