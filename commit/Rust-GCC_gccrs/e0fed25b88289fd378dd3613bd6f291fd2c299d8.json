{"sha": "e0fed25b88289fd378dd3613bd6f291fd2c299d8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTBmZWQyNWI4ODI4OWZkMzc4ZGQzNjEzYmQ2ZjI5MWZkMmMyOTlkOA==", "commit": {"author": {"name": "Danny Smith", "email": "dannysmith@users.sourceforge.net", "date": "2004-01-14T07:27:07Z"}, "committer": {"name": "Danny Smith", "email": "dannysmith@gcc.gnu.org", "date": "2004-01-14T07:27:07Z"}, "message": "re PR c++/9021 ([win32] No exports possible when using a class pointer in an union)\n\n\tPR c++/9021\n  \tPR c++/11005\n\t* parser.c (cp_parser_elaborated_type_specifier): Warn about\n\tattributes and discard.\n\t* decl.c (xref_tag): Don't overwite existing attributes with\n\tNULL_TREE.\n\nFrom-SVN: r75846", "tree": {"sha": "52e76df3fdf4e9747586b44ff6071a6df782028c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/52e76df3fdf4e9747586b44ff6071a6df782028c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e0fed25b88289fd378dd3613bd6f291fd2c299d8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e0fed25b88289fd378dd3613bd6f291fd2c299d8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e0fed25b88289fd378dd3613bd6f291fd2c299d8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e0fed25b88289fd378dd3613bd6f291fd2c299d8/comments", "author": null, "committer": null, "parents": [{"sha": "79551a561038fa24ba4cdade1f61529faee366b2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/79551a561038fa24ba4cdade1f61529faee366b2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/79551a561038fa24ba4cdade1f61529faee366b2"}], "stats": {"total": 27, "additions": 24, "deletions": 3}, "files": [{"sha": "a538bf80ad862a2c14ba5379addac8c8d6475219", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e0fed25b88289fd378dd3613bd6f291fd2c299d8/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e0fed25b88289fd378dd3613bd6f291fd2c299d8/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=e0fed25b88289fd378dd3613bd6f291fd2c299d8", "patch": "@@ -1,3 +1,12 @@\n+2004-01-14  Danny Smith  <dannysmith@users,sourceforge.net>\n+\n+\tPR c++/9021\n+  \tPR c++/11005\n+\t* parser.c (cp_parser_elaborated_type_specifier): Warn about\n+\tattributes and discard.\n+\t* decl.c (xref_tag): Don't overwite existing attributes with\n+\tNULL_TREE.\n+\n 2004-01-14  Giovanni Bajo  <giovannibajo@gcc.gnu.org>\n \n \tPR c++/12335"}, {"sha": "625f94b7048ad8a887ebd08f59e9de00c9e685e2", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 10, "deletions": 2, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e0fed25b88289fd378dd3613bd6f291fd2c299d8/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e0fed25b88289fd378dd3613bd6f291fd2c299d8/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=e0fed25b88289fd378dd3613bd6f291fd2c299d8", "patch": "@@ -1,6 +1,6 @@\n /* Process declarations and variables for C++ compiler.\n    Copyright (C) 1988, 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000,\n-   2001, 2002, 2003  Free Software Foundation, Inc.\n+   2001, 2002, 2003, 2004  Free Software Foundation, Inc.\n    Contributed by Michael Tiemann (tiemann@cygnus.com)\n \n This file is part of GCC.\n@@ -9477,7 +9477,15 @@ xref_tag (enum tag_types tag_code, tree name, tree attributes,\n \tredeclare_class_template (t, current_template_parms);\n     }\n \n-  TYPE_ATTRIBUTES (t) = attributes;\n+  /* Add attributes only when defining a class. */\n+  if (attributes)\n+    {\n+      /* The only place that xref_tag is called with non-null\n+\t attributes is in cp_parser_class_head(), when defining a\n+\t class.  */ \n+      my_friendly_assert (TYPE_ATTRIBUTES (t) == NULL_TREE, 20040113);\n+      TYPE_ATTRIBUTES (t) = attributes;\n+    }\n \n   POP_TIMEVAR_AND_RETURN (TV_NAME_LOOKUP, t);\n }"}, {"sha": "db89e4520f98268989069949169b38c4217f2b82", "filename": "gcc/cp/parser.c", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e0fed25b88289fd378dd3613bd6f291fd2c299d8/gcc%2Fcp%2Fparser.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e0fed25b88289fd378dd3613bd6f291fd2c299d8/gcc%2Fcp%2Fparser.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fparser.c?ref=e0fed25b88289fd378dd3613bd6f291fd2c299d8", "patch": "@@ -9065,8 +9065,12 @@ cp_parser_elaborated_type_specifier (cp_parser* parser,\n \t     definition of a new type; a new type can only be declared in a\n \t     declaration context.  */\n \n+ \t  /* Warn about attributes. They are ignored.  */\n+ \t  if (attributes)\n+\t    warning (\"type attributes are honored only at type definition\");\n+\n \t  type = xref_tag (tag_type, identifier, \n-\t\t\t   attributes,\n+\t\t\t   /*attributes=*/NULL_TREE,\n \t\t\t   (is_friend \n \t\t\t    || !is_declaration\n \t\t\t    || cp_lexer_next_token_is_not (parser->lexer, "}]}