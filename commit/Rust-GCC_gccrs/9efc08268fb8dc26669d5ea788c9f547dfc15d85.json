{"sha": "9efc08268fb8dc26669d5ea788c9f547dfc15d85", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWVmYzA4MjY4ZmI4ZGMyNjY2OWQ1ZWE3ODhjOWY1NDdkZmMxNWQ4NQ==", "commit": {"author": {"name": "Tobias Burnus", "email": "burnus@net-b.de", "date": "2013-10-29T21:48:02Z"}, "committer": {"name": "Tobias Burnus", "email": "burnus@gcc.gnu.org", "date": "2013-10-29T21:48:02Z"}, "message": "re PR fortran/44350 (accepts illegal fortran in BLOCK DATA)\n\n2013-10-29  Tobias Burnus  <burnus@net-b.de>\n\n        PR fortran/44350\n        * parse.c (parse_spec): Add C1116 constraint\n        check for BLOCK DATA.\n\n2013-10-29  Tobias Burnus  <burnus@net-b.de>\n\n        PR fortran/44350\n        * gfortran.dg/blockdata_8.f90: New.\n\nFrom-SVN: r204185", "tree": {"sha": "885841ccc07182a6213729cc65527c492aa68529", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/885841ccc07182a6213729cc65527c492aa68529"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9efc08268fb8dc26669d5ea788c9f547dfc15d85", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9efc08268fb8dc26669d5ea788c9f547dfc15d85", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9efc08268fb8dc26669d5ea788c9f547dfc15d85", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9efc08268fb8dc26669d5ea788c9f547dfc15d85/comments", "author": {"login": "tob2", "id": 264461, "node_id": "MDQ6VXNlcjI2NDQ2MQ==", "avatar_url": "https://avatars.githubusercontent.com/u/264461?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tob2", "html_url": "https://github.com/tob2", "followers_url": "https://api.github.com/users/tob2/followers", "following_url": "https://api.github.com/users/tob2/following{/other_user}", "gists_url": "https://api.github.com/users/tob2/gists{/gist_id}", "starred_url": "https://api.github.com/users/tob2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tob2/subscriptions", "organizations_url": "https://api.github.com/users/tob2/orgs", "repos_url": "https://api.github.com/users/tob2/repos", "events_url": "https://api.github.com/users/tob2/events{/privacy}", "received_events_url": "https://api.github.com/users/tob2/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "c8c0f5577d17a5d3a21d56c2745baa99cecac609", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c8c0f5577d17a5d3a21d56c2745baa99cecac609", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c8c0f5577d17a5d3a21d56c2745baa99cecac609"}], "stats": {"total": 86, "additions": 86, "deletions": 0}, "files": [{"sha": "059b7b3528c6413a694e198e6e3662e8ea9ebaae", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9efc08268fb8dc26669d5ea788c9f547dfc15d85/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9efc08268fb8dc26669d5ea788c9f547dfc15d85/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=9efc08268fb8dc26669d5ea788c9f547dfc15d85", "patch": "@@ -1,3 +1,9 @@\n+2013-10-29  Tobias Burnus  <burnus@net-b.de>\n+\n+\tPR fortran/44350\n+\t* parse.c (parse_spec): Add C1116 constraint\n+\tcheck for BLOCK DATA.\n+\n 2013-10-29  Paul Thomas  <pault@gcc.gnu.org>\n \n \tPR fortran/58793"}, {"sha": "e8b988558a82c8d310856bc38c2464251c97a5e1", "filename": "gcc/fortran/parse.c", "status": "modified", "additions": 27, "deletions": 0, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9efc08268fb8dc26669d5ea788c9f547dfc15d85/gcc%2Ffortran%2Fparse.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9efc08268fb8dc26669d5ea788c9f547dfc15d85/gcc%2Ffortran%2Fparse.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fparse.c?ref=9efc08268fb8dc26669d5ea788c9f547dfc15d85", "patch": "@@ -2628,6 +2628,33 @@ parse_spec (gfc_statement st)\n \tdefault:\n \t  break;\n       }\n+  else if (gfc_current_state () == COMP_BLOCK_DATA)\n+    /* Fortran 2008, C1116.  */\n+    switch (st)\n+      {\n+        case ST_DATA_DECL:\n+\tcase ST_COMMON:\n+\tcase ST_DATA:\n+\tcase ST_TYPE:\n+\tcase ST_END_BLOCK_DATA:\n+\tcase ST_ATTR_DECL:\n+\tcase ST_EQUIVALENCE:\n+\tcase ST_PARAMETER:\n+\tcase ST_IMPLICIT:\n+\tcase ST_IMPLICIT_NONE:\n+\tcase ST_DERIVED_DECL:\n+\tcase ST_USE:\n+\t  break;\n+\n+\tcase ST_NONE:\n+\t  break;\n+\t  \n+\tdefault:\n+\t  gfc_error (\"%s statement is not allowed inside of BLOCK DATA at %C\",\n+\t\t     gfc_ascii_statement (st));\n+\t  reject_statement ();\n+\t  break;\n+      }\n   \n   /* If we find a statement that can not be followed by an IMPLICIT statement\n      (and thus we can expect to see none any further), type the function result"}, {"sha": "3dc59126378625d1c490c1804715b1cde60a0b3b", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9efc08268fb8dc26669d5ea788c9f547dfc15d85/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9efc08268fb8dc26669d5ea788c9f547dfc15d85/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=9efc08268fb8dc26669d5ea788c9f547dfc15d85", "patch": "@@ -1,3 +1,8 @@\n+2013-10-29  Tobias Burnus  <burnus@net-b.de>\n+\n+\tPR fortran/44350\n+\t* gfortran.dg/blockdata_8.f90: New.\n+\n 2013-10-29  Paul Thomas  <pault@gcc.gnu.org>\n \n \tPR fortran/58793"}, {"sha": "d3f992564ad7ade2b4b984f5f9c8926938019148", "filename": "gcc/testsuite/gfortran.dg/blockdata_8.f90", "status": "added", "additions": 48, "deletions": 0, "changes": 48, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9efc08268fb8dc26669d5ea788c9f547dfc15d85/gcc%2Ftestsuite%2Fgfortran.dg%2Fblockdata_8.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9efc08268fb8dc26669d5ea788c9f547dfc15d85/gcc%2Ftestsuite%2Fgfortran.dg%2Fblockdata_8.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fblockdata_8.f90?ref=9efc08268fb8dc26669d5ea788c9f547dfc15d85", "patch": "@@ -0,0 +1,48 @@\n+! { dg-do compile }\n+!\n+! PR fortran/44350\n+!\n+! Fortran 2008, C1116 only permits a small subset of statements in BLOCK DATA\n+!\n+! Part of the test case was contributed by Vittorio Zecca\n+!\n+module m\n+end module m\n+\n+BLOCK DATA valid2\n+  use m\n+  implicit integer(a-z)\n+  intrinsic :: sin\n+  common /one/ a, c\n+  bind(C) :: /one/\n+  dimension c(5)\n+  parameter (g = 7)\n+END BLOCK DATA valid2\n+\n+BLOCK DATA valid\n+  use m\n+  implicit none\n+  type t\n+    sequence\n+  end type t\n+  type(t), save :: x\n+  integer  :: y\n+  real :: q\n+  save :: y\n+  dimension :: q(5)\n+!  class(*) :: zz ! See PR fortran/58857\n+!  pointer :: zz\n+  target :: q\n+  volatile y\n+  asynchronous q\n+END BLOCK DATA valid\n+\n+block data invalid\n+      common x\n+      f(x)=x ! { dg-error \"STATEMENT FUNCTION statement is not allowed inside of BLOCK DATA\" }\n+      interface ! { dg-error \"INTERFACE statement is not allowed inside of BLOCK DATA\" }\n+      end interface\n+1     format() ! { dg-error \"FORMAT statement is not allowed inside of BLOCK DATA\" }\n+end block invalid ! { dg-error \"Expecting END BLOCK DATA statement\" }\n+\n+! { dg-error \"Unexpected end of file\" \"\" { target \"*-*-*\" } 0 }"}]}