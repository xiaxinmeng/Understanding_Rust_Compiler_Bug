{"sha": "b25e5572f1262ed0ec4beea19eec15ac28fdf8ed", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjI1ZTU1NzJmMTI2MmVkMGVjNGJlZWExOWVlYzE1YWMyOGZkZjhlZA==", "commit": {"author": {"name": "Marek Polacek", "email": "polacek@redhat.com", "date": "2018-02-06T13:25:54Z"}, "committer": {"name": "Marek Polacek", "email": "mpolacek@gcc.gnu.org", "date": "2018-02-06T13:25:54Z"}, "message": "re PR tree-optimization/84228 (Bogus -Wstringop-truncation warning with -g)\n\n\tPR tree-optimization/84228\n\t* tree-ssa-strlen.c (maybe_diag_stxncpy_trunc): Skip debug statements.\n\n\t* c-c++-common/Wstringop-truncation-3.c: New test.\n\nFrom-SVN: r257411", "tree": {"sha": "82838438bcb773f3e16031fadacb41b656726791", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/82838438bcb773f3e16031fadacb41b656726791"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b25e5572f1262ed0ec4beea19eec15ac28fdf8ed", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b25e5572f1262ed0ec4beea19eec15ac28fdf8ed", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b25e5572f1262ed0ec4beea19eec15ac28fdf8ed", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b25e5572f1262ed0ec4beea19eec15ac28fdf8ed/comments", "author": {"login": "mpolacek", "id": 10496300, "node_id": "MDQ6VXNlcjEwNDk2MzAw", "avatar_url": "https://avatars.githubusercontent.com/u/10496300?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mpolacek", "html_url": "https://github.com/mpolacek", "followers_url": "https://api.github.com/users/mpolacek/followers", "following_url": "https://api.github.com/users/mpolacek/following{/other_user}", "gists_url": "https://api.github.com/users/mpolacek/gists{/gist_id}", "starred_url": "https://api.github.com/users/mpolacek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mpolacek/subscriptions", "organizations_url": "https://api.github.com/users/mpolacek/orgs", "repos_url": "https://api.github.com/users/mpolacek/repos", "events_url": "https://api.github.com/users/mpolacek/events{/privacy}", "received_events_url": "https://api.github.com/users/mpolacek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "d10ac88059a7574f60e25af7b8f1022b25100fdd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d10ac88059a7574f60e25af7b8f1022b25100fdd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d10ac88059a7574f60e25af7b8f1022b25100fdd"}], "stats": {"total": 34, "additions": 33, "deletions": 1}, "files": [{"sha": "c4d8c959ff53415cafafd775ad07c016cb1131bb", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b25e5572f1262ed0ec4beea19eec15ac28fdf8ed/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b25e5572f1262ed0ec4beea19eec15ac28fdf8ed/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=b25e5572f1262ed0ec4beea19eec15ac28fdf8ed", "patch": "@@ -1,3 +1,8 @@\n+2018-02-06  Marek Polacek  <polacek@redhat.com>\n+\n+\tPR tree-optimization/84228\n+\t* tree-ssa-strlen.c (maybe_diag_stxncpy_trunc): Skip debug statements.\n+\n 2018-02-06  Tamar Christina  <tamar.christina@arm.com>\n \n \tPR target/82641"}, {"sha": "e8b123dbb37486f5697c23054c584ae4509e80e1", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b25e5572f1262ed0ec4beea19eec15ac28fdf8ed/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b25e5572f1262ed0ec4beea19eec15ac28fdf8ed/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=b25e5572f1262ed0ec4beea19eec15ac28fdf8ed", "patch": "@@ -1,3 +1,8 @@\n+2018-02-06  Marek Polacek  <polacek@redhat.com>\n+\n+\tPR tree-optimization/84228\n+\t* c-c++-common/Wstringop-truncation-3.c: New test.\n+\n 2018-02-06  Tamar Christina  <tamar.christina@arm.com>\n \n \tPR target/82641"}, {"sha": "ba6b7de094b262d86372fd663141f35fab06d6b4", "filename": "gcc/testsuite/c-c++-common/Wstringop-truncation-3.c", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b25e5572f1262ed0ec4beea19eec15ac28fdf8ed/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2FWstringop-truncation-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b25e5572f1262ed0ec4beea19eec15ac28fdf8ed/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2FWstringop-truncation-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2FWstringop-truncation-3.c?ref=b25e5572f1262ed0ec4beea19eec15ac28fdf8ed", "patch": "@@ -0,0 +1,22 @@\n+/* PR tree-optimization/84228 */\n+/* { dg-do compile } */\n+/* { dg-options \"-Wstringop-truncation -O2 -g\" } */\n+\n+char *strncpy (char *, const char *, __SIZE_TYPE__);\n+struct S\n+{\n+  char arr[64];\n+};\n+\n+int\n+foo (struct S *p1, const char *a)\n+{\n+  int b = 5, c = 6, d = 7;\n+  if (a)\n+    goto err;\n+  strncpy (p1->arr, a, sizeof p1->arr); /* { dg-bogus \"specified bound\" } */\n+  b = 8; c = 9; d = 10;\n+  p1->arr[3] = '\\0';\n+err:\n+  return 0;\n+}"}, {"sha": "f0f6535017b1758a516f60ce4d4b3f8ad68708c6", "filename": "gcc/tree-ssa-strlen.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b25e5572f1262ed0ec4beea19eec15ac28fdf8ed/gcc%2Ftree-ssa-strlen.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b25e5572f1262ed0ec4beea19eec15ac28fdf8ed/gcc%2Ftree-ssa-strlen.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-strlen.c?ref=b25e5572f1262ed0ec4beea19eec15ac28fdf8ed", "patch": "@@ -1849,7 +1849,7 @@ maybe_diag_stxncpy_trunc (gimple_stmt_iterator gsi, tree src, tree cnt)\n \n   /* Look for dst[i] = '\\0'; after the stxncpy() call and if found\n      avoid the truncation warning.  */\n-  gsi_next (&gsi);\n+  gsi_next_nondebug (&gsi);\n   gimple *next_stmt = gsi_stmt (gsi);\n \n   if (!gsi_end_p (gsi) && is_gimple_assign (next_stmt))"}]}