{"sha": "45230a4019ed9f03ea63b3c25c8e4a9b9897dc98", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDUyMzBhNDAxOWVkOWYwM2VhNjNiM2MyNWM4ZTRhOWI5ODk3ZGM5OA==", "commit": {"author": {"name": "Uros Bizjak", "email": "ubizjak@gmail.com", "date": "2019-08-01T18:07:19Z"}, "committer": {"name": "Uros Bizjak", "email": "uros@gcc.gnu.org", "date": "2019-08-01T18:07:19Z"}, "message": "re PR tree-optimization/85693 (Generation of SAD (Sum of Absolute Difference) instruction)\n\n\tPR target/85693\n\t* config/i386/mmx.md (usadv8qi): New expander.\n\ntestsuite/ChangeLog:\n\n\tPR target/85693\n\t* gcc.target/i386/pr85693-1.c: New test.\n\nFrom-SVN: r273981", "tree": {"sha": "846cd19642d4e5d006fdbede5ef27ecfdbf9e693", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/846cd19642d4e5d006fdbede5ef27ecfdbf9e693"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/45230a4019ed9f03ea63b3c25c8e4a9b9897dc98", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/45230a4019ed9f03ea63b3c25c8e4a9b9897dc98", "html_url": "https://github.com/Rust-GCC/gccrs/commit/45230a4019ed9f03ea63b3c25c8e4a9b9897dc98", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/45230a4019ed9f03ea63b3c25c8e4a9b9897dc98/comments", "author": {"login": "ubizjak", "id": 55479990, "node_id": "MDQ6VXNlcjU1NDc5OTkw", "avatar_url": "https://avatars.githubusercontent.com/u/55479990?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ubizjak", "html_url": "https://github.com/ubizjak", "followers_url": "https://api.github.com/users/ubizjak/followers", "following_url": "https://api.github.com/users/ubizjak/following{/other_user}", "gists_url": "https://api.github.com/users/ubizjak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ubizjak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ubizjak/subscriptions", "organizations_url": "https://api.github.com/users/ubizjak/orgs", "repos_url": "https://api.github.com/users/ubizjak/repos", "events_url": "https://api.github.com/users/ubizjak/events{/privacy}", "received_events_url": "https://api.github.com/users/ubizjak/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "ce529ffca708a635f434a99bf082dec2a1ba0446", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ce529ffca708a635f434a99bf082dec2a1ba0446", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ce529ffca708a635f434a99bf082dec2a1ba0446"}], "stats": {"total": 48, "additions": 47, "deletions": 1}, "files": [{"sha": "8efcffaef8a89f85c4b1d15867cade6a15b0a320", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/45230a4019ed9f03ea63b3c25c8e4a9b9897dc98/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/45230a4019ed9f03ea63b3c25c8e4a9b9897dc98/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=45230a4019ed9f03ea63b3c25c8e4a9b9897dc98", "patch": "@@ -1,3 +1,8 @@\n+2019-08-01  Uro\u0161 Bizjak  <ubizjak@gmail.com>\n+\n+\tPR target/85693\n+\t* config/i386/mmx.md (usadv8qi): New expander.\n+\n 2019-08-01  Matthew Beliveau  <mbelivea@redhat.com>\n \n \tPR c++/90590"}, {"sha": "3bbf5e07dcbe24902e99e7a62f1d581c3a2a9626", "filename": "gcc/config/i386/mmx.md", "status": "modified", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/45230a4019ed9f03ea63b3c25c8e4a9b9897dc98/gcc%2Fconfig%2Fi386%2Fmmx.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/45230a4019ed9f03ea63b3c25c8e4a9b9897dc98/gcc%2Fconfig%2Fi386%2Fmmx.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fmmx.md?ref=45230a4019ed9f03ea63b3c25c8e4a9b9897dc98", "patch": "@@ -1970,6 +1970,21 @@\n   DONE;\n })\n \n+(define_expand \"usadv8qi\"\n+  [(match_operand:V2SI 0 \"register_operand\")\n+   (match_operand:V8QI 1 \"register_operand\")\n+   (match_operand:V8QI 2 \"vector_operand\")\n+   (match_operand:V2SI 3 \"vector_operand\")]\n+  \"TARGET_MMX_WITH_SSE\"\n+{\n+  rtx t1 = gen_reg_rtx (V1DImode);\n+  rtx t2 = gen_reg_rtx (V2SImode);\n+  emit_insn (gen_mmx_psadbw (t1, operands[1], operands[2]));\n+  convert_move (t2, t1, 0);\n+  emit_insn (gen_addv2si3 (operands[0], t2, operands[3]));\n+  DONE;\n+})\n+\n (define_insn_and_split \"mmx_pmovmskb\"\n   [(set (match_operand:SI 0 \"register_operand\" \"=r,r\")\n \t(unspec:SI [(match_operand:V8QI 1 \"register_operand\" \"y,x\")]"}, {"sha": "0b4334a8cbdfc82583d4414678f2df183a232deb", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/45230a4019ed9f03ea63b3c25c8e4a9b9897dc98/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/45230a4019ed9f03ea63b3c25c8e4a9b9897dc98/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=45230a4019ed9f03ea63b3c25c8e4a9b9897dc98", "patch": "@@ -1,3 +1,8 @@\n+2019-08-01  Uro\u0161 Bizjak  <ubizjak@gmail.com>\n+\n+\tPR target/85693\n+\t* gcc.target/i386/pr85693-1.c: New test.\n+\n 2019-08-01  Matthew Beliveau  <mbelivea@redhat.com>\n \n \tPR c++/90590"}, {"sha": "b2bf58d9e29be41b0c2692e052f2d127c5419895", "filename": "gcc/testsuite/gcc.target/i386/pr85693-1.c", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/45230a4019ed9f03ea63b3c25c8e4a9b9897dc98/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr85693-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/45230a4019ed9f03ea63b3c25c8e4a9b9897dc98/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr85693-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr85693-1.c?ref=45230a4019ed9f03ea63b3c25c8e4a9b9897dc98", "patch": "@@ -0,0 +1,21 @@\n+/* { dg-do compile { target { ! ia32 } } } */\n+/* { dg-options \"-msse2 -O2 -ftree-vectorize\" } */\n+\n+#define N 8\n+\n+int abs (int);\n+\n+unsigned char pix1[N], pix2[N];\n+\n+int foo (void)\n+{\n+  int i_sum = 0;\n+  int i;\n+\n+  for (i = 0; i < N; i++)\n+    i_sum += abs (pix1[i] - pix2[i]);\n+\n+  return i_sum;\n+}\n+\n+/* { dg-final { scan-assembler \"psadbw\" } } */"}, {"sha": "9843ea527cb69e7bc89e53b6950f3262b9fa65db", "filename": "gcc/testsuite/gcc.target/i386/pr85693.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/45230a4019ed9f03ea63b3c25c8e4a9b9897dc98/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr85693.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/45230a4019ed9f03ea63b3c25c8e4a9b9897dc98/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr85693.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr85693.c?ref=45230a4019ed9f03ea63b3c25c8e4a9b9897dc98", "patch": "@@ -1,4 +1,4 @@\n-/* { dg-do compile }\n+/* { dg-do compile } */\n /* { dg-options \"-msse2 -O2 -ftree-vectorize\" } */\n \n #define N 1024"}]}