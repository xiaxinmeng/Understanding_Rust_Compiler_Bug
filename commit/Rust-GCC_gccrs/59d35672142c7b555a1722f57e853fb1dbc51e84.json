{"sha": "59d35672142c7b555a1722f57e853fb1dbc51e84", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTlkMzU2NzIxNDJjN2I1NTVhMTcyMmY1N2U4NTNmYjFkYmM1MWU4NA==", "commit": {"author": {"name": "Paolo Carlini", "email": "pcarlini@suse.de", "date": "2004-03-19T16:08:15Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2004-03-19T16:08:15Z"}, "message": "re PR libstdc++/14648 (rope is broken (regression))\n\n2004-03-19  Paolo Carlini  <pcarlini@suse.de>\n\n\tPR libstdc++/14648\n\t* include/ext/ropeimpl.h (rope<>::_S_apply_to_pieces): Fix\n\tmemory allocation/deallocation calls.\n\t* testsuite/ext/14648.cc: New.\n\nFrom-SVN: r79687", "tree": {"sha": "de59f8bca611339f02f5f77e8769f5456ca5c239", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/de59f8bca611339f02f5f77e8769f5456ca5c239"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/59d35672142c7b555a1722f57e853fb1dbc51e84", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/59d35672142c7b555a1722f57e853fb1dbc51e84", "html_url": "https://github.com/Rust-GCC/gccrs/commit/59d35672142c7b555a1722f57e853fb1dbc51e84", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/59d35672142c7b555a1722f57e853fb1dbc51e84/comments", "author": null, "committer": null, "parents": [{"sha": "30f3b32b41622bca1828edc4acd0a4849408cf56", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/30f3b32b41622bca1828edc4acd0a4849408cf56", "html_url": "https://github.com/Rust-GCC/gccrs/commit/30f3b32b41622bca1828edc4acd0a4849408cf56"}], "stats": {"total": 53, "additions": 50, "deletions": 3}, "files": [{"sha": "a2dd65e3103199c395c5fb3113ba61468d71a202", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/59d35672142c7b555a1722f57e853fb1dbc51e84/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/59d35672142c7b555a1722f57e853fb1dbc51e84/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=59d35672142c7b555a1722f57e853fb1dbc51e84", "patch": "@@ -1,3 +1,10 @@\n+2004-03-19  Paolo Carlini  <pcarlini@suse.de>\n+\n+\tPR libstdc++/14648\n+\t* include/ext/ropeimpl.h (rope<>::_S_apply_to_pieces): Fix\n+\tmemory allocation/deallocation calls.\n+\t* testsuite/ext/14648.cc: New.\n+\n 2004-03-19  Peter Schmid  <schmid@snake.iap.physik.tu-darmstadt.de>\n \n \tPR libstdc++/14647"}, {"sha": "b4c5f3e29e8d9703ecdf9db27b0f037c8af94a4d", "filename": "libstdc++-v3/include/ext/ropeimpl.h", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/59d35672142c7b555a1722f57e853fb1dbc51e84/libstdc%2B%2B-v3%2Finclude%2Fext%2Fropeimpl.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/59d35672142c7b555a1722f57e853fb1dbc51e84/libstdc%2B%2B-v3%2Finclude%2Fext%2Fropeimpl.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fext%2Fropeimpl.h?ref=59d35672142c7b555a1722f57e853fb1dbc51e84", "patch": "@@ -874,15 +874,15 @@ bool rope<_CharT, _Alloc>::_S_apply_to_pieces(\n \t\tsize_t __len = __end - __begin;\n \t\tbool __result;\n \t\t_CharT* __buffer =\n-\t\t  (_CharT*)_Alloc::allocate(__len * sizeof(_CharT));\n+\t\t  (_CharT*)_Alloc().allocate(__len * sizeof(_CharT));\n \t\ttry {\n \t\t  (*(__f->_M_fn))(__begin, __len, __buffer);\n \t\t  __result = __c(__buffer, __len);\n-                  _Alloc::deallocate(__buffer, __len * sizeof(_CharT));\n+                  _Alloc().deallocate(__buffer, __len * sizeof(_CharT));\n                 }\n \t\tcatch(...)\n \t\t  {\n-\t\t    _Alloc::deallocate(__buffer, __len * sizeof(_CharT));\n+\t\t    _Alloc().deallocate(__buffer, __len * sizeof(_CharT));\n \t\t    __throw_exception_again;\n \t\t  }\n \t\treturn __result;"}, {"sha": "e54e2f87e699e30ebe8e0a413156b74a2bfa68e8", "filename": "libstdc++-v3/testsuite/ext/14648.cc", "status": "added", "additions": 40, "deletions": 0, "changes": 40, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/59d35672142c7b555a1722f57e853fb1dbc51e84/libstdc%2B%2B-v3%2Ftestsuite%2Fext%2F14648.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/59d35672142c7b555a1722f57e853fb1dbc51e84/libstdc%2B%2B-v3%2Ftestsuite%2Fext%2F14648.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2Fext%2F14648.cc?ref=59d35672142c7b555a1722f57e853fb1dbc51e84", "patch": "@@ -0,0 +1,40 @@\n+// Copyright (C) 2004 Free Software Foundation\n+//\n+// This file is part of the GNU ISO C++ Library.  This library is free\n+// software; you can redistribute it and/or modify it under the\n+// terms of the GNU General Public License as published by the\n+// Free Software Foundation; either version 2, or (at your option)\n+// any later version.\n+\n+// This library is distributed in the hope that it will be useful,\n+// but WITHOUT ANY WARRANTY; without even the implied warranty of\n+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+// GNU General Public License for more details.\n+\n+// You should have received a copy of the GNU General Public License along\n+// with this library; see the file COPYING.  If not, write to the Free\n+// Software Foundation, 59 Temple Place - Suite 330, Boston, MA 02111-1307,\n+// USA.\n+\n+#include <iostream>\n+#include <ext/hash_map> \n+#include <ext/rope> \n+\n+// libstdc++/14648\n+void test01() \n+{ \n+  using namespace std; \n+  using namespace __gnu_cxx;\n+\n+  typedef hash_map<char, crope, hash<char>, equal_to<char> > maptype; \n+  maptype m; \n+  m['l'] = \"50\";\n+  m['x'] = \"10\";\n+  cout << \"m['x'] = \" << m['x'] << endl; \n+}  \n+\n+int main()\n+{\n+  test01();\n+  return 0;\n+}"}]}