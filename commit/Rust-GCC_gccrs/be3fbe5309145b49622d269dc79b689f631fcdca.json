{"sha": "be3fbe5309145b49622d269dc79b689f631fcdca", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmUzZmJlNTMwOTE0NWI0OTYyMmQyNjlkYzc5YjY4OWY2MzFmY2RjYQ==", "commit": {"author": {"name": "David Daney", "email": "ddaney@caviumnetworks.com", "date": "2008-12-10T05:08:50Z"}, "committer": {"name": "David Daney", "email": "daney@gcc.gnu.org", "date": "2008-12-10T05:08:50Z"}, "message": "sync.md (sync_<optab>_12): Replace MIPS_SYNC_OP_12_NOT_NOP with MIPS_SYNC_OP_12_AND.\n\n\t* config/mips/sync.md (sync_<optab>_12): Replace\n\tMIPS_SYNC_OP_12_NOT_NOP with MIPS_SYNC_OP_12_AND.\n\t(sync_old_<optab>_12): Remove third paramater to\n\tMIPS_SYNC_OLD_OP_12 macro, replace MIPS_SYNC_OLD_OP_12_NOT_NOP\n\twith MIPS_SYNC_OLD_OP_12_AND.\n\t(sync_new_<optab>_12): Replace MIPS_SYNC_NEW_OP_12_NOT_NOP\n\twith MIPS_SYNC_NEW_OP_12_AND.\n\t(sync_nand_12): Replace MIPS_SYNC_OP_12_NOT_NOT with\n\tMIPS_SYNC_OP_12_XOR, reduce length attribute to 40.\n\t(sync_old_nand_12): Remove third paramater to MIPS_SYNC_OLD_OP_12\n\tmacro, replace MIPS_SYNC_OLD_OP_12_NOT_NOT with\n\tMIPS_SYNC_OLD_OP_12_XOR and reduce length attribute to 40.\n\t(sync_new_nand_12): Replace MIPS_SYNC_NEW_OP_12_NOT_NOT with\n\tMIPS_SYNC_NEW_OP_12_XOR.\n\t* config/mips/mips.h (MIPS_SYNC_OP_12, MIPS_SYNC_OP_12_NOT_NOP,\n\tMIPS_SYNC_OP_12_NOT_NOT,MIPS_SYNC_OLD_OP_12_NOT_NOP,\n\tMIPS_SYNC_OLD_OP_12_NOT_NOT, MIPS_SYNC_NEW_OP_12,\n\tMIPS_SYNC_NEW_OP_12_NOT_NOP, MIPS_SYNC_NEW_OP_12_NOT_NOT,\n\tMIPS_SYNC_NAND, MIPS_SYNC_OLD_NAND, MIPS_SYNC_NEW_NAND): Rewritten\n\tto implement new __sync_nand semantics.\n\t(MIPS_SYNC_OLD_OP_12): Implement new __sync_nand semantics, and\n\tremove third parameter.\n\t(MIPS_SYNC_OLD_OP_12_NOT_NOP_REG,\n\tMIPS_SYNC_OLD_OP_12_NOT_NOT_REG): Removed.\n\t(MIPS_SYNC_OP_12_NOT_NOP): Renamed to MIPS_SYNC_OP_12_AND.\n\t(MIPS_SYNC_OP_12_NOT_NOT): Renamed to MIPS_SYNC_OP_12_XOR.\n\t(MIPS_SYNC_OLD_OP_12_NOT_NOP): Renamed to MIPS_SYNC_OLD_OP_12_AND.\n\t(MIPS_SYNC_OLD_OP_12_NOT_NOT): Renamed to MIPS_SYNC_OLD_OP_12_XOR.\n\t(MIPS_SYNC_NEW_OP_12_NOT_NOP): Renamed to MIPS_SYNC_NEW_OP_12_AND.\n\t(MIPS_SYNC_NEW_OP_12_NOT_NOT): Renamed to MIPS_SYNC_NEW_OP_12_XOR\n\nFrom-SVN: r142638", "tree": {"sha": "28935da509beeedce74bab7527daf863e82de899", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/28935da509beeedce74bab7527daf863e82de899"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/be3fbe5309145b49622d269dc79b689f631fcdca", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/be3fbe5309145b49622d269dc79b689f631fcdca", "html_url": "https://github.com/Rust-GCC/gccrs/commit/be3fbe5309145b49622d269dc79b689f631fcdca", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/be3fbe5309145b49622d269dc79b689f631fcdca/comments", "author": null, "committer": null, "parents": [{"sha": "c34a77fd2f7e1f5585ae7d5f47c6f52f6101461d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c34a77fd2f7e1f5585ae7d5f47c6f52f6101461d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c34a77fd2f7e1f5585ae7d5f47c6f52f6101461d"}], "stats": {"total": 127, "additions": 78, "deletions": 49}, "files": [{"sha": "588ce005412f1c3934bc713a5e0911905fff142d", "filename": "gcc/ChangeLog", "status": "modified", "additions": 33, "deletions": 0, "changes": 33, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/be3fbe5309145b49622d269dc79b689f631fcdca/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/be3fbe5309145b49622d269dc79b689f631fcdca/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=be3fbe5309145b49622d269dc79b689f631fcdca", "patch": "@@ -1,3 +1,36 @@\n+2008-12-09 David Daney <ddaney@caviumnetworks.com>\n+\n+\t* config/mips/sync.md (sync_<optab>_12): Replace\n+\tMIPS_SYNC_OP_12_NOT_NOP with MIPS_SYNC_OP_12_AND.\n+\t(sync_old_<optab>_12): Remove third paramater to\n+\tMIPS_SYNC_OLD_OP_12 macro, replace MIPS_SYNC_OLD_OP_12_NOT_NOP\n+\twith MIPS_SYNC_OLD_OP_12_AND.\n+\t(sync_new_<optab>_12): Replace MIPS_SYNC_NEW_OP_12_NOT_NOP\n+\twith MIPS_SYNC_NEW_OP_12_AND.\n+\t(sync_nand_12): Replace MIPS_SYNC_OP_12_NOT_NOT with\n+\tMIPS_SYNC_OP_12_XOR, reduce length attribute to 40.\n+\t(sync_old_nand_12): Remove third paramater to MIPS_SYNC_OLD_OP_12\n+\tmacro, replace MIPS_SYNC_OLD_OP_12_NOT_NOT with\n+\tMIPS_SYNC_OLD_OP_12_XOR and reduce length attribute to 40.\n+\t(sync_new_nand_12): Replace MIPS_SYNC_NEW_OP_12_NOT_NOT with\n+\tMIPS_SYNC_NEW_OP_12_XOR.\n+\t* config/mips/mips.h (MIPS_SYNC_OP_12, MIPS_SYNC_OP_12_NOT_NOP,\n+\tMIPS_SYNC_OP_12_NOT_NOT,MIPS_SYNC_OLD_OP_12_NOT_NOP,\n+\tMIPS_SYNC_OLD_OP_12_NOT_NOT, MIPS_SYNC_NEW_OP_12,\n+\tMIPS_SYNC_NEW_OP_12_NOT_NOP, MIPS_SYNC_NEW_OP_12_NOT_NOT,\n+\tMIPS_SYNC_NAND, MIPS_SYNC_OLD_NAND, MIPS_SYNC_NEW_NAND): Rewritten\n+\tto implement new __sync_nand semantics.\n+\t(MIPS_SYNC_OLD_OP_12): Implement new __sync_nand semantics, and\n+\tremove third parameter.\n+\t(MIPS_SYNC_OLD_OP_12_NOT_NOP_REG,\n+\tMIPS_SYNC_OLD_OP_12_NOT_NOT_REG): Removed.\n+\t(MIPS_SYNC_OP_12_NOT_NOP): Renamed to MIPS_SYNC_OP_12_AND.\n+\t(MIPS_SYNC_OP_12_NOT_NOT): Renamed to MIPS_SYNC_OP_12_XOR.\n+\t(MIPS_SYNC_OLD_OP_12_NOT_NOP): Renamed to MIPS_SYNC_OLD_OP_12_AND.\n+\t(MIPS_SYNC_OLD_OP_12_NOT_NOT): Renamed to MIPS_SYNC_OLD_OP_12_XOR.\n+\t(MIPS_SYNC_NEW_OP_12_NOT_NOP): Renamed to MIPS_SYNC_NEW_OP_12_AND.\n+\t(MIPS_SYNC_NEW_OP_12_NOT_NOT): Renamed to MIPS_SYNC_NEW_OP_12_XOR\n+\n 2008-12-09  Tobias Grosser  <grosser@fim.uni-passau.de>\n \n \t* graphite.c (graphite_transform_loops): Always call find_transform ()"}, {"sha": "a6444b5f993bdf4fc510bd31f802218f53db3025", "filename": "gcc/config/mips/mips.h", "status": "modified", "additions": 37, "deletions": 39, "changes": 76, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/be3fbe5309145b49622d269dc79b689f631fcdca/gcc%2Fconfig%2Fmips%2Fmips.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/be3fbe5309145b49622d269dc79b689f631fcdca/gcc%2Fconfig%2Fmips%2Fmips.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.h?ref=be3fbe5309145b49622d269dc79b689f631fcdca", "patch": "@@ -3183,24 +3183,25 @@ while (0)\n \n      - Uses scratch register %4.\n \n-    NOT_OP are the optional instructions to do a bit-wise not\n-    operation in conjunction with an AND INSN to generate a sync_nand\n-    operation.  */\n-#define MIPS_SYNC_OP_12(INSN, NOT_OP)\t\t\\\n+    AND_OP is an instruction done after INSN to mask INSN's result\n+    with the mask.  For most operations, this is an AND with the\n+    inclusive mask (%1).  For nand operations -- where the result of\n+    INSN is already correctly masked -- it instead performs a bitwise\n+    not.  */\n+#define MIPS_SYNC_OP_12(INSN, AND_OP)\t\t\\\n   \"%(%<%[%|sync\\n\"\t\t\t\t\\\n   \"1:\\tll\\t%4,%0\\n\"\t\t\t\t\\\n   \"\\tand\\t%@,%4,%2\\n\"\t\t\t\t\\\n-  NOT_OP\t\t\t\t\t\\\n   \"\\t\" INSN \"\\t%4,%4,%z3\\n\"\t\t\t\\\n-  \"\\tand\\t%4,%4,%1\\n\"\t\t\t\t\\\n+  AND_OP\t\t\t\t\t\\\n   \"\\tor\\t%@,%@,%4\\n\"\t\t\t\t\\\n   \"\\tsc\\t%@,%0\\n\"\t\t\t\t\\\n   \"\\tbeq%?\\t%@,%.,1b\\n\"\t\t\t\t\\\n   \"\\tnop\\n\"\t\t\t\t\t\\\n   \"\\tsync%-%]%>%)\"\n \n-#define MIPS_SYNC_OP_12_NOT_NOP \"\"\n-#define MIPS_SYNC_OP_12_NOT_NOT \"\\tnor\\t%4,%4,%.\\n\"\n+#define MIPS_SYNC_OP_12_AND \"\\tand\\t%4,%4,%1\\n\"\n+#define MIPS_SYNC_OP_12_XOR \"\\txor\\t%4,%4,%1\\n\"\n \n /* Return an asm string that atomically:\n \n@@ -3213,29 +3214,25 @@ while (0)\n \n      - Uses scratch register %5.\n \n-    NOT_OP are the optional instructions to do a bit-wise not\n-    operation in conjunction with an AND INSN to generate a sync_nand\n-    operation.\n-\n-    REG is used in conjunction with NOT_OP and is used to select the\n-    register operated on by the INSN.  */\n-#define MIPS_SYNC_OLD_OP_12(INSN, NOT_OP, REG)\t\\\n+    AND_OP is an instruction done after INSN to mask INSN's result\n+    with the mask.  For most operations, this is an AND with the\n+    inclusive mask (%1).  For nand operations -- where the result of\n+    INSN is already correctly masked -- it instead performs a bitwise\n+    not.  */\n+#define MIPS_SYNC_OLD_OP_12(INSN, AND_OP)\t\\\n   \"%(%<%[%|sync\\n\"\t\t\t\t\\\n   \"1:\\tll\\t%0,%1\\n\"\t\t\t\t\\\n   \"\\tand\\t%@,%0,%3\\n\"\t\t\t\t\\\n-  NOT_OP\t\t\t\t\t\\\n-  \"\\t\" INSN \"\\t%5,\" REG \",%z4\\n\"\t\t\\\n-  \"\\tand\\t%5,%5,%2\\n\"\t\t\t\t\\\n+  \"\\t\" INSN \"\\t%5,%0,%z4\\n\"\t\t\t\\\n+  AND_OP\t\t\t\t\t\\\n   \"\\tor\\t%@,%@,%5\\n\"\t\t\t\t\\\n   \"\\tsc\\t%@,%1\\n\"\t\t\t\t\\\n   \"\\tbeq%?\\t%@,%.,1b\\n\"\t\t\t\t\\\n   \"\\tnop\\n\"\t\t\t\t\t\\\n   \"\\tsync%-%]%>%)\"\n \n-#define MIPS_SYNC_OLD_OP_12_NOT_NOP \"\"\n-#define MIPS_SYNC_OLD_OP_12_NOT_NOP_REG \"%0\"\n-#define MIPS_SYNC_OLD_OP_12_NOT_NOT \"\\tnor\\t%5,%0,%.\\n\"\n-#define MIPS_SYNC_OLD_OP_12_NOT_NOT_REG \"%5\"\n+#define MIPS_SYNC_OLD_OP_12_AND \"\\tand\\t%5,%5,%2\\n\"\n+#define MIPS_SYNC_OLD_OP_12_XOR \"\\txor\\t%5,%5,%2\\n\"\n \n /* Return an asm string that atomically:\n \n@@ -3246,24 +3243,25 @@ while (0)\n \n      - Sets %0 to the new value of %1.\n \n-    NOT_OP are the optional instructions to do a bit-wise not\n-    operation in conjunction with an AND INSN to generate a sync_nand\n-    operation.  */\n-#define MIPS_SYNC_NEW_OP_12(INSN, NOT_OP)\t\\\n+    AND_OP is an instruction done after INSN to mask INSN's result\n+    with the mask.  For most operations, this is an AND with the\n+    inclusive mask (%1).  For nand operations -- where the result of\n+    INSN is already correctly masked -- it instead performs a bitwise\n+    not.  */\n+#define MIPS_SYNC_NEW_OP_12(INSN, AND_OP)\t\\\n   \"%(%<%[%|sync\\n\"\t\t\t\t\\\n   \"1:\\tll\\t%0,%1\\n\"\t\t\t\t\\\n   \"\\tand\\t%@,%0,%3\\n\"\t\t\t\t\\\n-  NOT_OP\t\t\t\t\t\\\n   \"\\t\" INSN \"\\t%0,%0,%z4\\n\"\t\t\t\\\n-  \"\\tand\\t%0,%0,%2\\n\"\t\t\t\t\\\n+  AND_OP\t\t\t\t\t\\\n   \"\\tor\\t%@,%@,%0\\n\"\t\t\t\t\\\n   \"\\tsc\\t%@,%1\\n\"\t\t\t\t\\\n   \"\\tbeq%?\\t%@,%.,1b\\n\"\t\t\t\t\\\n   \"\\tnop\\n\"\t\t\t\t\t\\\n   \"\\tsync%-%]%>%)\"\n \n-#define MIPS_SYNC_NEW_OP_12_NOT_NOP \"\"\n-#define MIPS_SYNC_NEW_OP_12_NOT_NOT \"\\tnor\\t%0,%0,%.\\n\"\n+#define MIPS_SYNC_NEW_OP_12_AND \"\\tand\\t%0,%0,%2\\n\"\n+#define MIPS_SYNC_NEW_OP_12_XOR \"\\txor\\t%0,%0,%2\\n\"\n \n /* Return an asm string that atomically:\n \n@@ -3301,24 +3299,24 @@ while (0)\n \n /* Return an asm string that atomically:\n \n-     - Sets memory reference %0 to ~%0 AND %1.\n+     - Sets memory reference %0 to ~(%0 AND %1).\n \n    SUFFIX is the suffix that should be added to \"ll\" and \"sc\"\n    instructions.  INSN is the and instruction needed to and a register\n    with %2.  */\n #define MIPS_SYNC_NAND(SUFFIX, INSN)\t\t\\\n   \"%(%<%[%|sync\\n\"\t\t\t\t\\\n   \"1:\\tll\" SUFFIX \"\\t%@,%0\\n\"\t\t\t\\\n-  \"\\tnor\\t%@,%@,%.\\n\"\t\t\t\t\\\n   \"\\t\" INSN \"\\t%@,%@,%1\\n\"\t\t\t\\\n+  \"\\tnor\\t%@,%@,%.\\n\"\t\t\t\t\\\n   \"\\tsc\" SUFFIX \"\\t%@,%0\\n\"\t\t\t\\\n   \"\\tbeq%?\\t%@,%.,1b\\n\"\t\t\t\t\\\n   \"\\tnop\\n\"\t\t\t\t\t\\\n   \"\\tsync%-%]%>%)\"\n \n /* Return an asm string that atomically:\n \n-     - Sets memory reference %1 to ~%1 AND %2.\n+     - Sets memory reference %1 to ~(%1 AND %2).\n \n      - Sets register %0 to the old value of memory reference %1.\n \n@@ -3328,16 +3326,16 @@ while (0)\n #define MIPS_SYNC_OLD_NAND(SUFFIX, INSN)\t\\\n   \"%(%<%[%|sync\\n\"\t\t\t\t\\\n   \"1:\\tll\" SUFFIX \"\\t%0,%1\\n\"\t\t\t\\\n-  \"\\tnor\\t%@,%0,%.\\n\"\t\t\t\t\\\n-  \"\\t\" INSN \"\\t%@,%@,%2\\n\"\t\t\t\\\n+  \"\\t\" INSN \"\\t%@,%0,%2\\n\"\t\t\t\\\n+  \"\\tnor\\t%@,%@,%.\\n\"\t\t\t\t\\\n   \"\\tsc\" SUFFIX \"\\t%@,%1\\n\"\t\t\t\\\n   \"\\tbeq%?\\t%@,%.,1b\\n\"\t\t\t\t\\\n   \"\\tnop\\n\"\t\t\t\t\t\\\n   \"\\tsync%-%]%>%)\"\n \n /* Return an asm string that atomically:\n \n-     - Sets memory reference %1 to ~%1 AND %2.\n+     - Sets memory reference %1 to ~(%1 AND %2).\n \n      - Sets register %0 to the new value of memory reference %1.\n \n@@ -3347,11 +3345,11 @@ while (0)\n #define MIPS_SYNC_NEW_NAND(SUFFIX, INSN)\t\\\n   \"%(%<%[%|sync\\n\"\t\t\t\t\\\n   \"1:\\tll\" SUFFIX \"\\t%0,%1\\n\"\t\t\t\\\n-  \"\\tnor\\t%0,%0,%.\\n\"\t\t\t\t\\\n-  \"\\t\" INSN \"\\t%@,%0,%2\\n\"\t\t\t\\\n+  \"\\t\" INSN \"\\t%0,%0,%2\\n\"\t\t\t\\\n+  \"\\tnor\\t%@,%0,%.\\n\"\t\t\t\t\\\n   \"\\tsc\" SUFFIX \"\\t%@,%1\\n\"\t\t\t\\\n   \"\\tbeq%?\\t%@,%.,1b%~\\n\"\t\t\t\\\n-  \"\\t\" INSN \"\\t%0,%0,%2\\n\"\t\t\t\\\n+  \"\\tnor\\t%0,%0,%.\\n\"\t\t\t\t\\\n   \"\\tsync%-%]%>%)\"\n \n /* Return an asm string that atomically:"}, {"sha": "f053be65b22320134cc12d3e20ba1b5d1fabee61", "filename": "gcc/config/mips/sync.md", "status": "modified", "additions": 8, "deletions": 10, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/be3fbe5309145b49622d269dc79b689f631fcdca/gcc%2Fconfig%2Fmips%2Fsync.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/be3fbe5309145b49622d269dc79b689f631fcdca/gcc%2Fconfig%2Fmips%2Fsync.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fsync.md?ref=be3fbe5309145b49622d269dc79b689f631fcdca", "patch": "@@ -127,7 +127,7 @@\n   \"GENERATE_LL_SC\"\n {\n     return (mips_output_sync_loop\n-\t    (MIPS_SYNC_OP_12 (\"<insn>\", MIPS_SYNC_OP_12_NOT_NOP)));\n+\t    (MIPS_SYNC_OP_12 (\"<insn>\", MIPS_SYNC_OP_12_AND)));\n }\n   [(set_attr \"length\" \"40\")])\n \n@@ -164,8 +164,7 @@\n   \"GENERATE_LL_SC\"\n {\n     return (mips_output_sync_loop\n-\t    (MIPS_SYNC_OLD_OP_12 (\"<insn>\", MIPS_SYNC_OLD_OP_12_NOT_NOP,\n-\t    \t\t\t  MIPS_SYNC_OLD_OP_12_NOT_NOP_REG)));\n+\t    (MIPS_SYNC_OLD_OP_12 (\"<insn>\", MIPS_SYNC_OLD_OP_12_AND)));\n }\n   [(set_attr \"length\" \"40\")])\n \n@@ -207,7 +206,7 @@\n   \"GENERATE_LL_SC\"\n {\n     return (mips_output_sync_loop\n-\t    (MIPS_SYNC_NEW_OP_12 (\"<insn>\", MIPS_SYNC_NEW_OP_12_NOT_NOP)));\n+\t    (MIPS_SYNC_NEW_OP_12 (\"<insn>\", MIPS_SYNC_NEW_OP_12_AND)));\n }\n   [(set_attr \"length\" \"40\")])\n \n@@ -239,9 +238,9 @@\n   \"GENERATE_LL_SC\"\n {\n     return (mips_output_sync_loop\n-\t    (MIPS_SYNC_OP_12 (\"and\", MIPS_SYNC_OP_12_NOT_NOT)));\n+\t    (MIPS_SYNC_OP_12 (\"and\", MIPS_SYNC_OP_12_XOR)));\n }\n-  [(set_attr \"length\" \"44\")])\n+  [(set_attr \"length\" \"40\")])\n \n (define_expand \"sync_old_nand<mode>\"\n   [(parallel [\n@@ -274,10 +273,9 @@\n   \"GENERATE_LL_SC\"\n {\n     return (mips_output_sync_loop\n-\t    (MIPS_SYNC_OLD_OP_12 (\"and\", MIPS_SYNC_OLD_OP_12_NOT_NOT,\n-\t\t\t\t  MIPS_SYNC_OLD_OP_12_NOT_NOT_REG)));\n+\t    (MIPS_SYNC_OLD_OP_12 (\"and\", MIPS_SYNC_OLD_OP_12_XOR)));\n }\n-  [(set_attr \"length\" \"44\")])\n+  [(set_attr \"length\" \"40\")])\n \n (define_expand \"sync_new_nand<mode>\"\n   [(parallel [\n@@ -315,7 +313,7 @@\n   \"GENERATE_LL_SC\"\n {\n     return (mips_output_sync_loop\n-\t    (MIPS_SYNC_NEW_OP_12 (\"and\", MIPS_SYNC_NEW_OP_12_NOT_NOT)));\n+\t    (MIPS_SYNC_NEW_OP_12 (\"and\", MIPS_SYNC_NEW_OP_12_XOR)));\n }\n   [(set_attr \"length\" \"40\")])\n "}]}