{"sha": "8b60fb432a133613e348278fa9037d70c3243cd3", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OGI2MGZiNDMyYTEzMzYxM2UzNDgyNzhmYTkwMzdkNzBjMzI0M2NkMw==", "commit": {"author": {"name": "Mark Mitchell", "email": "mark@codesourcery.com", "date": "2005-05-27T16:24:59Z"}, "committer": {"name": "Mark Mitchell", "email": "mmitchel@gcc.gnu.org", "date": "2005-05-27T16:24:59Z"}, "message": "test.html: Mention PCH_CXXFLAGS.\n\n\t* docs/html/test.html: Mention PCH_CXXFLAGS.\n\t* testsuite/lib/libstdc++.exp: Set PCH_CXXFLAGS by probing for an\n\tavailable stcd++.h PCH.\n\t* testsuite/libstdc++-dg/normal.exp: Use PCH_CXXFLAGS.\n\nFrom-SVN: r100264", "tree": {"sha": "355b0856e5e30784a14bd6f4f8ad4241c6c5d5e3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/355b0856e5e30784a14bd6f4f8ad4241c6c5d5e3"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8b60fb432a133613e348278fa9037d70c3243cd3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8b60fb432a133613e348278fa9037d70c3243cd3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8b60fb432a133613e348278fa9037d70c3243cd3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8b60fb432a133613e348278fa9037d70c3243cd3/comments", "author": null, "committer": null, "parents": [{"sha": "c71e3d020e25b0c0fb11c60d1ec663387463bd2a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c71e3d020e25b0c0fb11c60d1ec663387463bd2a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c71e3d020e25b0c0fb11c60d1ec663387463bd2a"}], "stats": {"total": 45, "additions": 34, "deletions": 11}, "files": [{"sha": "ab8a1286dd763948e3a4c3f97a47cc74c7cc752b", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8b60fb432a133613e348278fa9037d70c3243cd3/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8b60fb432a133613e348278fa9037d70c3243cd3/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=8b60fb432a133613e348278fa9037d70c3243cd3", "patch": "@@ -1,3 +1,10 @@\n+2005-05-27  Mark Mitchell  <mark@codesourcery.com>\n+\n+\t* docs/html/test.html: Mention PCH_CXXFLAGS.\n+\t* testsuite/lib/libstdc++.exp: Set PCH_CXXFLAGS by probing for an\n+\tavailable stcd++.h PCH.\n+\t* testsuite/libstdc++-dg/normal.exp: Use PCH_CXXFLAGS.\n+\n 2005-05-27  Theodore Papadopoulo  <Theodore.Papadopoulo@sophia.inria.fr>\n \n \t* src/misc-inst.cc: Remove unnecessary included files."}, {"sha": "41e0529e6c69fae6fa47dc13622d24fd788b5147", "filename": "libstdc++-v3/docs/html/test.html", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8b60fb432a133613e348278fa9037d70c3243cd3/libstdc%2B%2B-v3%2Fdocs%2Fhtml%2Ftest.html", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8b60fb432a133613e348278fa9037d70c3243cd3/libstdc%2B%2B-v3%2Fdocs%2Fhtml%2Ftest.html", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fdocs%2Fhtml%2Ftest.html?ref=8b60fb432a133613e348278fa9037d70c3243cd3", "patch": "@@ -427,8 +427,8 @@ <h2><a name=\"new\">How to write a new test case</a></h2>\n \n Example 5: Testing with special command line settings, or without the\n use of pre-compiled headers, in particular the stdc++.h.gch file. Any\n-options here will override the DEFAULT_CXXFLAGS set up in the\n-normal.exp file.\n+options here will override the DEFAULT_CXXFLAGS and PCH_CXXFLAGS set\n+up in the normal.exp file.\n // { dg-options \"-O0\" { target *-*-* } }\n </pre>\n "}, {"sha": "bcae3777e750a8b24e37d04ccd128a5ff1f36cde", "filename": "libstdc++-v3/testsuite/lib/libstdc++.exp", "status": "modified", "additions": 23, "deletions": 8, "changes": 31, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8b60fb432a133613e348278fa9037d70c3243cd3/libstdc%2B%2B-v3%2Ftestsuite%2Flib%2Flibstdc%2B%2B.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8b60fb432a133613e348278fa9037d70c3243cd3/libstdc%2B%2B-v3%2Ftestsuite%2Flib%2Flibstdc%2B%2B.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2Flib%2Flibstdc%2B%2B.exp?ref=8b60fb432a133613e348278fa9037d70c3243cd3", "patch": "@@ -103,14 +103,7 @@ proc libstdc++_init { testfile } {\n     # headers, or without assertions.\n     global DEFAULT_CXXFLAGS\n     if ![info exists DEFAULT_CXXFLAGS] then {\n-\t# Set up includes for stdc++.h.gch, the precompiled header file.\n-\tif { [file exists $flags_file] } {\n-\t    set cxxpchflags [exec sh $flags_file --cxxpchflags]\n-\t} else {\n-\t    set cxxpchflags \"\"\n-\t}\n-\tset DEFAULT_CXXFLAGS \" ${cxxpchflags}\"\n-\n+\tset DEFAULT_CXXFLAGS \"\"\n \t# Host specific goo here.\n \tif { [string match \"powerpc-*-darwin*\" $target_triplet] } {\n \t    append DEFAULT_CXXFLAGS \" -multiply_defined suppress\"\n@@ -195,6 +188,28 @@ proc libstdc++_init { testfile } {\n         }\n     }\n \n+    # If a PCH file is available, use it.  We must delay performing\n+    # this check until $cxx and such have been initialized because we\n+    # perform a test compilation.  (Ideally, gcc --print-file-name would\n+    # list PCH files, but it does not.)\n+    global PCH_CXXFLAGS\n+    if ![info exists PCH_CXXFLAGS] then {\n+\tset src \"config[pid].cc\"\n+\tset f [open $src \"w\"]\n+\tputs $f \"int main () {}\"\n+\tclose $f\n+\n+\tset lines [v3_target_compile $src \"config[pid].o\" object \\\n+\t\t   \"additional_flags=-include additional_flags=bits/stdc++.h\"]\n+\tif {$lines == \"\" } {\n+\t    set PCH_CXXFLAGS \"-include bits/stdc++.h\"\n+\t} else {\n+\t    set PCH_CXXFLAGS \"\"\n+\t}\n+\tfile delete $src\n+\tv3track PCH_CXXFLAGS 2\n+    }\n+\n     libstdc++_maybe_build_wrapper \"${objdir}/testglue.o\"\n }\n "}, {"sha": "9d2f1a63a9a55b47cf557b5a2243134ba059d1ed", "filename": "libstdc++-v3/testsuite/libstdc++-dg/normal.exp", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8b60fb432a133613e348278fa9037d70c3243cd3/libstdc%2B%2B-v3%2Ftestsuite%2Flibstdc%2B%2B-dg%2Fnormal.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8b60fb432a133613e348278fa9037d70c3243cd3/libstdc%2B%2B-v3%2Ftestsuite%2Flibstdc%2B%2B-dg%2Fnormal.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2Flibstdc%2B%2B-dg%2Fnormal.exp?ref=8b60fb432a133613e348278fa9037d70c3243cd3", "patch": "@@ -87,7 +87,8 @@ set tests [lsort $tests]\n \n # Main loop.\n global DEFAULT_CXXFLAGS\n-dg-runtest $tests \"\" $DEFAULT_CXXFLAGS\n+global PCH_CXXFLAGS\n+dg-runtest $tests \"\" \"$DEFAULT_CXXFLAGS $PCH_CXXFLAGS\"\n \n # All done.\n dg-finish"}]}