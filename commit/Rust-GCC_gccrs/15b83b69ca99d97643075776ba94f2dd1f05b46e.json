{"sha": "15b83b69ca99d97643075776ba94f2dd1f05b46e", "node_id": "C_kwDOANBUbNoAKDE1YjgzYjY5Y2E5OWQ5NzY0MzA3NTc3NmJhOTRmMmRkMWYwNWI0NmU", "commit": {"author": {"name": "Kewen Lin", "email": "linkw@linux.ibm.com", "date": "2023-03-08T06:57:21Z"}, "committer": {"name": "Kewen Lin", "email": "linkw@linux.ibm.com", "date": "2023-03-08T06:57:21Z"}, "message": "libgcc, rs6000: Fix bump size for powerpc64 elfv1 ABI [PR108727]\n\nAs PR108727 shows, when cleanup code called by the stack\nunwinder calls function _Unwind_Resume, it goes via plt\nstub like:\n\n   function 00000000.plt_call._Unwind_Resume:\n\n=> 0x0000000010003580 <+0>:     std     r2,40(r1)\n   0x0000000010003584 <+4>:     ld      r12,-31760(r2)\n   0x0000000010003588 <+8>:     mtctr   r12\n   0x000000001000358c <+12>:    ld      r2,-31752(r2)\n   0x0000000010003590 <+16>:    cmpldi  r2,0\n   0x0000000010003594 <+20>:    bnectr+\n   0x0000000010003598 <+24>:    b       0x100031a4\n                                        <_Unwind_Resume@plt>\n\nIt wants to save TOC base (r2) to r1 + 40, but we only\nbump the stack segment by 32 bytes as follows:\n\n   stdu %r29,-32(%r3)\n\nIt means the access is out of the stack segment allocated\nby __generic_morestack, once the touch area isn't writable\nlike this failure shows, it would cause segment fault.\n\nSo fix the bump size with one reasonable value PARAMS.\n\n\tPR libgcc/108727\n\nlibgcc/ChangeLog:\n\n\t* config/rs6000/morestack.S (__morestack): Use PARAMS for new stack\n\tbump size.", "tree": {"sha": "38356a5d8d2b0fd08fbfe8ab77ce8b003ed3e1c8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/38356a5d8d2b0fd08fbfe8ab77ce8b003ed3e1c8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/15b83b69ca99d97643075776ba94f2dd1f05b46e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/15b83b69ca99d97643075776ba94f2dd1f05b46e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/15b83b69ca99d97643075776ba94f2dd1f05b46e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/15b83b69ca99d97643075776ba94f2dd1f05b46e/comments", "author": {"login": "jedilyn", "id": 38515402, "node_id": "MDQ6VXNlcjM4NTE1NDAy", "avatar_url": "https://avatars.githubusercontent.com/u/38515402?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jedilyn", "html_url": "https://github.com/jedilyn", "followers_url": "https://api.github.com/users/jedilyn/followers", "following_url": "https://api.github.com/users/jedilyn/following{/other_user}", "gists_url": "https://api.github.com/users/jedilyn/gists{/gist_id}", "starred_url": "https://api.github.com/users/jedilyn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jedilyn/subscriptions", "organizations_url": "https://api.github.com/users/jedilyn/orgs", "repos_url": "https://api.github.com/users/jedilyn/repos", "events_url": "https://api.github.com/users/jedilyn/events{/privacy}", "received_events_url": "https://api.github.com/users/jedilyn/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jedilyn", "id": 38515402, "node_id": "MDQ6VXNlcjM4NTE1NDAy", "avatar_url": "https://avatars.githubusercontent.com/u/38515402?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jedilyn", "html_url": "https://github.com/jedilyn", "followers_url": "https://api.github.com/users/jedilyn/followers", "following_url": "https://api.github.com/users/jedilyn/following{/other_user}", "gists_url": "https://api.github.com/users/jedilyn/gists{/gist_id}", "starred_url": "https://api.github.com/users/jedilyn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jedilyn/subscriptions", "organizations_url": "https://api.github.com/users/jedilyn/orgs", "repos_url": "https://api.github.com/users/jedilyn/repos", "events_url": "https://api.github.com/users/jedilyn/events{/privacy}", "received_events_url": "https://api.github.com/users/jedilyn/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2a2a159f7bd9d929ce457937f669ed2dd6ebccec", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2a2a159f7bd9d929ce457937f669ed2dd6ebccec", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2a2a159f7bd9d929ce457937f669ed2dd6ebccec"}], "stats": {"total": 4, "additions": 2, "deletions": 2}, "files": [{"sha": "f2fea6abb105b3426f049307d5ed612a0fc728a2", "filename": "libgcc/config/rs6000/morestack.S", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/15b83b69ca99d97643075776ba94f2dd1f05b46e/libgcc%2Fconfig%2Frs6000%2Fmorestack.S", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/15b83b69ca99d97643075776ba94f2dd1f05b46e/libgcc%2Fconfig%2Frs6000%2Fmorestack.S", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgcc%2Fconfig%2Frs6000%2Fmorestack.S?ref=15b83b69ca99d97643075776ba94f2dd1f05b46e", "patch": "@@ -205,12 +205,12 @@ ENTRY0(__morestack)\n \tbl JUMP_TARGET(__generic_morestack)\n \n # Start using new stack\n-\tstdu %r29,-32(%r3)\t\t# back-chain\n+\tstdu %r29,-PARAMS(%r3)\t\t# back-chain\n \tmr %r1,%r3\n \n # Set __private_ss stack guard for the new stack.\n \tld %r12,NEWSTACKSIZE_SAVE(%r29)\t# modified size\n-\taddi %r3,%r3,BACKOFF-32\n+\taddi %r3,%r3,BACKOFF-PARAMS\n \tsub %r3,%r3,%r12\n # Note that a signal frame has $pc pointing at the instruction\n # where the signal occurred.  For something like a timer"}]}