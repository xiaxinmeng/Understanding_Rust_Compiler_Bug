{"sha": "994fb69ac1b7d52348e84a021c07b24e285294d0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTk0ZmI2OWFjMWI3ZDUyMzQ4ZTg0YTAyMWMwN2IyNGUyODUyOTRkMA==", "commit": {"author": {"name": "David Edelsohn", "email": "dje.gcc@gmail.com", "date": "2021-01-18T00:33:04Z"}, "committer": {"name": "David Edelsohn", "email": "dje.gcc@gmail.com", "date": "2021-01-18T04:59:26Z"}, "message": "testsuite: powerpc fold-vec and sse updates.\n\nRecent code generation changes have affected the count of some instructions.\nThis patch updates the instruction count for fold-vec-extract on P7 and P8.\n\nAlso, some of SSE emulation intrinsics only work on LE systems.\n\ngcc/testsuite/ChangeLog:\n\n\t* gcc.target/powerpc/fold-vec-extract-char.p7.c: Adjust addi count.\n\t* gcc.target/powerpc/fold-vec-extract-double.p7.c: Same.\n\t* gcc.target/powerpc/fold-vec-extract-float.p7.c: Same.\n\t* gcc.target/powerpc/fold-vec-extract-float.p8.c: Same.\n\t* gcc.target/powerpc/fold-vec-extract-int.p7.c: Same.\n\t* gcc.target/powerpc/fold-vec-extract-int.p8.c: Same.\n\t* gcc.target/powerpc/fold-vec-extract-short.p7.c: Same.\n\t* gcc.target/powerpc/fold-vec-extract-short.p8.c: Same.\n\t* gcc.target/powerpc/sse-andnps-1.c: Restrict to LE.\n\t* gcc.target/powerpc/sse-movhps-1.c: Restrict to LE.\n\t* gcc.target/powerpc/sse-movlps-1.c: Restrict to LE.\n\t* gcc.target/powerpc/sse2-andnpd-1.c: Restrict to LE.", "tree": {"sha": "428d9db77c326fc904d3c1f2f204166f640109d3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/428d9db77c326fc904d3c1f2f204166f640109d3"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/994fb69ac1b7d52348e84a021c07b24e285294d0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/994fb69ac1b7d52348e84a021c07b24e285294d0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/994fb69ac1b7d52348e84a021c07b24e285294d0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/994fb69ac1b7d52348e84a021c07b24e285294d0/comments", "author": {"login": "edelsohn", "id": 667700, "node_id": "MDQ6VXNlcjY2NzcwMA==", "avatar_url": "https://avatars.githubusercontent.com/u/667700?v=4", "gravatar_id": "", "url": "https://api.github.com/users/edelsohn", "html_url": "https://github.com/edelsohn", "followers_url": "https://api.github.com/users/edelsohn/followers", "following_url": "https://api.github.com/users/edelsohn/following{/other_user}", "gists_url": "https://api.github.com/users/edelsohn/gists{/gist_id}", "starred_url": "https://api.github.com/users/edelsohn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/edelsohn/subscriptions", "organizations_url": "https://api.github.com/users/edelsohn/orgs", "repos_url": "https://api.github.com/users/edelsohn/repos", "events_url": "https://api.github.com/users/edelsohn/events{/privacy}", "received_events_url": "https://api.github.com/users/edelsohn/received_events", "type": "User", "site_admin": false}, "committer": {"login": "edelsohn", "id": 667700, "node_id": "MDQ6VXNlcjY2NzcwMA==", "avatar_url": "https://avatars.githubusercontent.com/u/667700?v=4", "gravatar_id": "", "url": "https://api.github.com/users/edelsohn", "html_url": "https://github.com/edelsohn", "followers_url": "https://api.github.com/users/edelsohn/followers", "following_url": "https://api.github.com/users/edelsohn/following{/other_user}", "gists_url": "https://api.github.com/users/edelsohn/gists{/gist_id}", "starred_url": "https://api.github.com/users/edelsohn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/edelsohn/subscriptions", "organizations_url": "https://api.github.com/users/edelsohn/orgs", "repos_url": "https://api.github.com/users/edelsohn/repos", "events_url": "https://api.github.com/users/edelsohn/events{/privacy}", "received_events_url": "https://api.github.com/users/edelsohn/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4905f4040182b631a0918bb9cdb841520a9fd1de", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4905f4040182b631a0918bb9cdb841520a9fd1de", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4905f4040182b631a0918bb9cdb841520a9fd1de"}], "stats": {"total": 28, "additions": 16, "deletions": 12}, "files": [{"sha": "29a8aa84db2825898945f4545ee0ba60e6d22de8", "filename": "gcc/testsuite/gcc.target/powerpc/fold-vec-extract-char.p7.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/994fb69ac1b7d52348e84a021c07b24e285294d0/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Ffold-vec-extract-char.p7.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/994fb69ac1b7d52348e84a021c07b24e285294d0/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Ffold-vec-extract-char.p7.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Ffold-vec-extract-char.p7.c?ref=994fb69ac1b7d52348e84a021c07b24e285294d0", "patch": "@@ -11,7 +11,7 @@\n /* one extsb (extend sign-bit) instruction generated for each test against\n    unsigned types */\n \n-/* { dg-final { scan-assembler-times {\\maddi\\M} 6 } } */\n+/* { dg-final { scan-assembler-times {\\maddi\\M} 9 } } */\n /* { dg-final { scan-assembler-times {\\mli\\M} 6 } } */\n /* { dg-final { scan-assembler-times {\\mstxvw4x\\M|\\mstvx\\M|\\mstxv\\M} 6 } } */\n /* -m32 target uses rlwinm in place of rldicl. */"}, {"sha": "3cae644b90b71feb250a96481a2fe389db193a7f", "filename": "gcc/testsuite/gcc.target/powerpc/fold-vec-extract-double.p7.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/994fb69ac1b7d52348e84a021c07b24e285294d0/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Ffold-vec-extract-double.p7.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/994fb69ac1b7d52348e84a021c07b24e285294d0/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Ffold-vec-extract-double.p7.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Ffold-vec-extract-double.p7.c?ref=994fb69ac1b7d52348e84a021c07b24e285294d0", "patch": "@@ -13,7 +13,8 @@\n /* { dg-final { scan-assembler-times {\\mxxpermdi\\M} 1 } } */\n /* { dg-final { scan-assembler-times {\\mli\\M} 1 } } */\n /* -m32 target has an 'add' in place of one of the 'addi'. */\n-/* { dg-final { scan-assembler-times {\\maddi\\M|\\madd\\M} 2 } } */\n+/* { dg-final { scan-assembler-times {\\maddi\\M|\\madd\\M} 2 { target lp64 } } } */\n+/* { dg-final { scan-assembler-times {\\maddi\\M|\\madd\\M} 3 { target ilp32 } } } */\n /* -m32 target has a rlwinm in place of a rldic .  */\n /* { dg-final { scan-assembler-times {\\mrldic\\M|\\mrlwinm\\M} 1 } } */\n /* { dg-final { scan-assembler-times {\\mstxvd2x\\M} 1 } } */"}, {"sha": "59a4979457dcb62da969fbef26fb7aec291fb714", "filename": "gcc/testsuite/gcc.target/powerpc/fold-vec-extract-float.p7.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/994fb69ac1b7d52348e84a021c07b24e285294d0/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Ffold-vec-extract-float.p7.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/994fb69ac1b7d52348e84a021c07b24e285294d0/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Ffold-vec-extract-float.p7.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Ffold-vec-extract-float.p7.c?ref=994fb69ac1b7d52348e84a021c07b24e285294d0", "patch": "@@ -12,7 +12,8 @@\n /* { dg-final { scan-assembler-times {\\mxscvspdp\\M} 1 } } */\n /* { dg-final { scan-assembler-times {\\mli\\M} 1 } } */\n /* -m32 as an add in place of an addi. */\n-/* { dg-final { scan-assembler-times {\\maddi\\M|\\madd\\M} 2 } } */\n+/* { dg-final { scan-assembler-times {\\maddi\\M|\\madd\\M} 2 { target lp64 } } } */\n+/* { dg-final { scan-assembler-times {\\maddi\\M|\\madd\\M} 3 { target ilp32 } } } */\n /* { dg-final { scan-assembler-times {\\mstxvd2x\\M|\\mstvx\\M|\\mstxv\\M} 1 } } */\n /* -m32 uses rlwinm in place of rldic */\n /* { dg-final { scan-assembler-times {\\mrldic\\M|\\mrlwinm\\M} 1 } } */"}, {"sha": "4b1d75ee26d0f6eaaeb7d0c53f96c1a5ec40224e", "filename": "gcc/testsuite/gcc.target/powerpc/fold-vec-extract-float.p8.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/994fb69ac1b7d52348e84a021c07b24e285294d0/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Ffold-vec-extract-float.p8.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/994fb69ac1b7d52348e84a021c07b24e285294d0/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Ffold-vec-extract-float.p8.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Ffold-vec-extract-float.p8.c?ref=994fb69ac1b7d52348e84a021c07b24e285294d0", "patch": "@@ -26,7 +26,7 @@\n /* { dg-final { scan-assembler-times {\\mstxvd2x\\M} 1 { target ilp32 } } } */\n /* { dg-final { scan-assembler-times {\\madd\\M} 1 { target ilp32 } } } */\n /* { dg-final { scan-assembler-times {\\mlfs\\M} 1 { target ilp32 } } } */\n-/* { dg-final { scan-assembler-times {\\maddi\\M} 1 { target ilp32 } } } */\n+/* { dg-final { scan-assembler-times {\\maddi\\M} 2 { target ilp32 } } } */\n \n \n #include <altivec.h>"}, {"sha": "3729a1646e9c9d62f28641fe988bf086cfdd1e98", "filename": "gcc/testsuite/gcc.target/powerpc/fold-vec-extract-int.p7.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/994fb69ac1b7d52348e84a021c07b24e285294d0/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Ffold-vec-extract-int.p7.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/994fb69ac1b7d52348e84a021c07b24e285294d0/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Ffold-vec-extract-int.p7.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Ffold-vec-extract-int.p7.c?ref=994fb69ac1b7d52348e84a021c07b24e285294d0", "patch": "@@ -10,7 +10,8 @@\n // P7 variables:  li, addi, stxvw4x, lwa/lwz\n \n /* { dg-final { scan-assembler-times {\\mli\\M} 6 } } */\n-/* { dg-final { scan-assembler-times {\\maddi\\M|\\madd\\M} 9 } } */\n+/* { dg-final { scan-assembler-times {\\maddi\\M|\\madd\\M} 9 { target lp64 } } } */\n+/* { dg-final { scan-assembler-times {\\maddi\\M|\\madd\\M} 12 { target ilp32 } } } */\n /* { dg-final { scan-assembler-times {\\mstxvw4x\\M|\\mstvx\\M|\\mstxv\\M} 6 } } */\n /* { dg-final { scan-assembler-times {\\mrldic\\M|\\mrlwinm\\M} 3 } } */\n /* { dg-final { scan-assembler-times {\\mlwz\\M|\\mlwa\\M|\\mlwzx\\M|\\mlwax\\M} 6 } } */"}, {"sha": "75eaf25943b70b30cd15c17a32c09606079fde4a", "filename": "gcc/testsuite/gcc.target/powerpc/fold-vec-extract-int.p8.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/994fb69ac1b7d52348e84a021c07b24e285294d0/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Ffold-vec-extract-int.p8.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/994fb69ac1b7d52348e84a021c07b24e285294d0/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Ffold-vec-extract-int.p8.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Ffold-vec-extract-int.p8.c?ref=994fb69ac1b7d52348e84a021c07b24e285294d0", "patch": "@@ -30,7 +30,7 @@\n /* { dg-final { scan-assembler-times {\\mstxvw4x\\M} 6 { target ilp32 } } } */\n /* { dg-final { scan-assembler-times {\\madd\\M} 3 { target ilp32 } } } */\n /* { dg-final { scan-assembler-times {\\mlwz\\M} 6 { target ilp32 } } } */\n-/* { dg-final { scan-assembler-times {\\maddi\\M} 6 { target ilp32 } } } */\n+/* { dg-final { scan-assembler-times {\\maddi\\M} 9 { target ilp32 } } } */\n \n \n "}, {"sha": "a495d9f3928faacbe4937f71d2b8d5bc1ce1b984", "filename": "gcc/testsuite/gcc.target/powerpc/fold-vec-extract-short.p7.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/994fb69ac1b7d52348e84a021c07b24e285294d0/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Ffold-vec-extract-short.p7.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/994fb69ac1b7d52348e84a021c07b24e285294d0/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Ffold-vec-extract-short.p7.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Ffold-vec-extract-short.p7.c?ref=994fb69ac1b7d52348e84a021c07b24e285294d0", "patch": "@@ -10,7 +10,8 @@\n // P7 (be) constants:            li, addi,              stxvw4x, lha/lhz\n \n /* { dg-final { scan-assembler-times {\\mli\\M} 6 } } */\n-/* { dg-final { scan-assembler-times {\\maddi\\M|\\madd\\M} 9 } } */\n+/* { dg-final { scan-assembler-times {\\maddi\\M|\\madd\\M} 9 { target lp64 } } } */\n+/* { dg-final { scan-assembler-times {\\maddi\\M|\\madd\\M} 12 { target ilp32 } } } */\n /* { dg-final { scan-assembler-times {\\mrldic\\M|\\mrlwinm\\M} 3 } } */\n /* { dg-final { scan-assembler-times {\\mstxvw4x\\M|\\mstvx\\M} 6 } } */\n /* { dg-final { scan-assembler-times \"lhz|lha|lhzx|lhax\" 6 } } */"}, {"sha": "0ddecb4e4b55d9799ef5890f44af6d818347c29b", "filename": "gcc/testsuite/gcc.target/powerpc/fold-vec-extract-short.p8.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/994fb69ac1b7d52348e84a021c07b24e285294d0/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Ffold-vec-extract-short.p8.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/994fb69ac1b7d52348e84a021c07b24e285294d0/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Ffold-vec-extract-short.p8.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Ffold-vec-extract-short.p8.c?ref=994fb69ac1b7d52348e84a021c07b24e285294d0", "patch": "@@ -32,7 +32,7 @@\n /* add and rlwinm instructions only on the variable tests. */\n /* { dg-final { scan-assembler-times {\\madd\\M} 3 { target ilp32 } } } */\n /* { dg-final { scan-assembler-times \"rlwinm\" 3 { target ilp32 } } } */\n-/* { dg-final { scan-assembler-times {\\maddi\\M} 6 { target ilp32 } } } */\n+/* { dg-final { scan-assembler-times {\\maddi\\M} 9 { target ilp32 } } } */\n /* { dg-final { scan-assembler-times {\\mlha\\M|\\mlhz\\M} 6 { target ilp32 } } } */\n \n "}, {"sha": "3b45ca43496fe5fdf950d2836538f195bfdf2416", "filename": "gcc/testsuite/gcc.target/powerpc/sse-andnps-1.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/994fb69ac1b7d52348e84a021c07b24e285294d0/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fsse-andnps-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/994fb69ac1b7d52348e84a021c07b24e285294d0/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fsse-andnps-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fsse-andnps-1.c?ref=994fb69ac1b7d52348e84a021c07b24e285294d0", "patch": "@@ -1,4 +1,4 @@\n-/* { dg-do run } */\n+/* { dg-do run { target le } } */\n /* { dg-options \"-O3 -mpower8-vector -Wno-psabi\" } */\n /* { dg-require-effective-target p8vector_hw } */\n "}, {"sha": "a0666e51fd345ec2642fea7207974f432c543bec", "filename": "gcc/testsuite/gcc.target/powerpc/sse-movhps-1.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/994fb69ac1b7d52348e84a021c07b24e285294d0/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fsse-movhps-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/994fb69ac1b7d52348e84a021c07b24e285294d0/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fsse-movhps-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fsse-movhps-1.c?ref=994fb69ac1b7d52348e84a021c07b24e285294d0", "patch": "@@ -1,4 +1,4 @@\n-/* { dg-do run } */\n+/* { dg-do run { target le } } */\n /* { dg-options \"-O3 -mpower8-vector -Wno-psabi\" } */\n /* { dg-require-effective-target p8vector_hw } */\n "}, {"sha": "281d49c75a6426f24a064f278c7797ee339f33f4", "filename": "gcc/testsuite/gcc.target/powerpc/sse-movlps-1.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/994fb69ac1b7d52348e84a021c07b24e285294d0/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fsse-movlps-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/994fb69ac1b7d52348e84a021c07b24e285294d0/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fsse-movlps-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fsse-movlps-1.c?ref=994fb69ac1b7d52348e84a021c07b24e285294d0", "patch": "@@ -1,4 +1,4 @@\n-/* { dg-do run } */\n+/* { dg-do run { target le } } */\n /* { dg-options \"-O3 -mpower8-vector -Wno-psabi\" } */\n /* { dg-require-effective-target p8vector_hw } */\n "}, {"sha": "1a0e6cb11d4c4b225e60cff7d31d35d7cb64d551", "filename": "gcc/testsuite/gcc.target/powerpc/sse2-andnpd-1.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/994fb69ac1b7d52348e84a021c07b24e285294d0/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fsse2-andnpd-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/994fb69ac1b7d52348e84a021c07b24e285294d0/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fsse2-andnpd-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fsse2-andnpd-1.c?ref=994fb69ac1b7d52348e84a021c07b24e285294d0", "patch": "@@ -1,4 +1,4 @@\n-/* { dg-do run } */\n+/* { dg-do run { target le } } */\n /* { dg-options \"-O3 -mpower8-vector -Wno-psabi\" } */\n /* { dg-require-effective-target p8vector_hw } */\n "}]}