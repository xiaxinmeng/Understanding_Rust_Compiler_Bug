{"sha": "d89f0ad6225ed957153f92edf50f06890193c32f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDg5ZjBhZDYyMjVlZDk1NzE1M2Y5MmVkZjUwZjA2ODkwMTkzYzMyZg==", "commit": {"author": {"name": "Aaron W. LaFramboise", "email": "aaronavay62@aaronwl.com", "date": "2008-08-31T18:14:25Z"}, "committer": {"name": "Aaron W. LaFramboise", "email": "aaronwl@gcc.gnu.org", "date": "2008-08-31T18:14:25Z"}, "message": "configure.ac (RPATH_ENVVAR): Use PATH on Windows.\n\n2008-08-31  Aaron W. LaFramboise  <aaronavay62@aaronwl.com>\n\n\t<toplevel>\n\t* configure.ac (RPATH_ENVVAR): Use PATH on Windows.\n\t(GCC_SHLIB_SUBDIR): New.\n\t* Makefile.tpl (HOST_LIB_PATH_gcc): Use GCC_SHLIB_SUBDIR.\n\t* configure: Regenerate.\n\t* Makefile.in: Regenerate.\n\n\t<gcc>\n\t* mkmap-flat.awk: Add option pe_dll.\n\t* config/i386/t-cygming (SHLIB_LINK): Support building libgcc_s.\n\t* gcc/config/i386/t-cygwin (SHLIB_LC): Add.\n\t* gcc/config/i386/t-mingw32 (SHLIB_LC): Add.\n\t* config/i386/mingw32.h (SHARED_LIBGCC_UNDEFS_SPEC): New.\n\t(SUBTARGET_EXTRA_SPECS): Use SHARED_LIBGCC_UNDEFS_SPEC.\n\t(LINK_SPEC): Support libgcc_s.\n\t(LIBGCC_SPEC): Support libgcc_s.\n\t(LIBGCC_SONAME): New.\n\n\t<libstdc++-v3>\n\t* acinclude.m4 <enable_symvers>: Don't use symvers on Windows.\n\t* configure: Regenerated.\n\t* Makefile.in: Regenerated.\n\t* src/Makefile.in: Regenerated.\n\t* doc/makefile.in: Regenerated.\n\t* po/Makefile.in: Regenerated.\n\t* libmath/Makefile.in: Regenerated.\n\t* include/Makefile.in: Regenerated.\n\t* libsupc++/Makefile.in: Regenerated.\n\t* testsuite/makefile.in: Regenerated.\n\nFrom-SVN: r139837", "tree": {"sha": "349007eb9608d2d70057524bcd0d030010875820", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/349007eb9608d2d70057524bcd0d030010875820"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d89f0ad6225ed957153f92edf50f06890193c32f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d89f0ad6225ed957153f92edf50f06890193c32f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d89f0ad6225ed957153f92edf50f06890193c32f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d89f0ad6225ed957153f92edf50f06890193c32f/comments", "author": null, "committer": null, "parents": [{"sha": "3e196fa9b9e3d7ce3b23e11f6517a6439506a2bc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3e196fa9b9e3d7ce3b23e11f6517a6439506a2bc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3e196fa9b9e3d7ce3b23e11f6517a6439506a2bc"}], "stats": {"total": 188, "additions": 178, "deletions": 10}, "files": [{"sha": "67175b8c8cce4e8a8036b72f5b04593b7bdc6bb7", "filename": "ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d89f0ad6225ed957153f92edf50f06890193c32f/ChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d89f0ad6225ed957153f92edf50f06890193c32f/ChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/ChangeLog?ref=d89f0ad6225ed957153f92edf50f06890193c32f", "patch": "@@ -1,3 +1,11 @@\n+2008-08-31  Aaron W. LaFramboise  <aaronavay62@aaronwl.com>\n+\n+\t* configure.ac (RPATH_ENVVAR): Use PATH on Windows.\n+\t(GCC_SHLIB_SUBDIR): New.\n+\t* Makefile.tpl (HOST_LIB_PATH_gcc): Use GCC_SHLIB_SUBDIR.\n+\t* configure: Regenerate.\n+\t* Makefile.in: Regenerate.\n+\n 2008-08-30  Gerald Pfeifer  <gerald@pfeifer.com>\n \n \t* MAINTAINERS: Consistently use tabs to separate columns."}, {"sha": "0305d28c9386a682e00cd9da605d7cc9c9a3c60e", "filename": "Makefile.in", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d89f0ad6225ed957153f92edf50f06890193c32f/Makefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d89f0ad6225ed957153f92edf50f06890193c32f/Makefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/Makefile.in?ref=d89f0ad6225ed957153f92edf50f06890193c32f", "patch": "@@ -105,6 +105,11 @@ GDB_NLM_DEPS =\n # the libraries.\n RPATH_ENVVAR = @RPATH_ENVVAR@\n \n+# On targets where RPATH_ENVVAR is PATH, a subdirectory of the GCC build path\n+# is used instead of the directory itself to avoid including built\n+# executables in PATH.\n+GCC_SHLIB_SUBDIR = @GCC_SHLIB_SUBDIR@\n+\n # Build programs are put under this directory.\n BUILD_SUBDIR = @build_subdir@\n # This is set by the configure script to the arguments to use when configuring\n@@ -445,7 +450,7 @@ HOST_LIB_PATH = $(HOST_LIB_PATH_bfd)$(HOST_LIB_PATH_opcodes)$(HOST_LIB_PATH_gmp)\n \n # Define HOST_LIB_PATH_gcc here, for the sake of TARGET_LIB_PATH, ouch\n @if gcc\n-HOST_LIB_PATH_gcc = $$r/$(HOST_SUBDIR)/gcc:$$r/$(HOST_SUBDIR)/prev-gcc:\n+HOST_LIB_PATH_gcc = $$r/$(HOST_SUBDIR)/gcc$(GCC_SHLIB_SUBDIR):$$r/$(HOST_SUBDIR)/prev-gcc$(GCC_SHLIB_SUBDIR):\n @endif gcc\n \n "}, {"sha": "051703eaa889000190bca4e637219ab1cbc16374", "filename": "Makefile.tpl", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d89f0ad6225ed957153f92edf50f06890193c32f/Makefile.tpl", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d89f0ad6225ed957153f92edf50f06890193c32f/Makefile.tpl", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/Makefile.tpl?ref=d89f0ad6225ed957153f92edf50f06890193c32f", "patch": "@@ -108,6 +108,11 @@ GDB_NLM_DEPS =\n # the libraries.\n RPATH_ENVVAR = @RPATH_ENVVAR@\n \n+# On targets where RPATH_ENVVAR is PATH, a subdirectory of the GCC build path\n+# is used instead of the directory itself to avoid including built\n+# executables in PATH.\n+GCC_SHLIB_SUBDIR = @GCC_SHLIB_SUBDIR@\n+\n # Build programs are put under this directory.\n BUILD_SUBDIR = @build_subdir@\n # This is set by the configure script to the arguments to use when configuring\n@@ -440,7 +445,7 @@ HOST_LIB_PATH = [+ FOR host_modules +][+\n \n # Define HOST_LIB_PATH_gcc here, for the sake of TARGET_LIB_PATH, ouch\n @if gcc\n-HOST_LIB_PATH_gcc = $$r/$(HOST_SUBDIR)/gcc:$$r/$(HOST_SUBDIR)/prev-gcc:\n+HOST_LIB_PATH_gcc = $$r/$(HOST_SUBDIR)/gcc$(GCC_SHLIB_SUBDIR):$$r/$(HOST_SUBDIR)/prev-gcc$(GCC_SHLIB_SUBDIR):\n @endif gcc\n \n [+ FOR host_modules +][+ IF lib_path +]"}, {"sha": "1a2bbbca0cc1908290c5e81ea554d1f409891245", "filename": "configure", "status": "modified", "additions": 14, "deletions": 1, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d89f0ad6225ed957153f92edf50f06890193c32f/configure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d89f0ad6225ed957153f92edf50f06890193c32f/configure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/configure?ref=d89f0ad6225ed957153f92edf50f06890193c32f", "patch": "@@ -272,7 +272,7 @@ PACKAGE_STRING=\n PACKAGE_BUGREPORT=\n \n ac_unique_file=\"move-if-change\"\n-ac_subst_vars='SHELL PATH_SEPARATOR PACKAGE_NAME PACKAGE_TARNAME PACKAGE_VERSION PACKAGE_STRING PACKAGE_BUGREPORT exec_prefix prefix program_transform_name bindir sbindir libexecdir datadir sysconfdir sharedstatedir localstatedir libdir includedir oldincludedir infodir mandir build_alias host_alias target_alias DEFS ECHO_C ECHO_N ECHO_T LIBS TOPLEVEL_CONFIGURE_ARGUMENTS build build_cpu build_vendor build_os build_noncanonical host_noncanonical target_noncanonical host host_cpu host_vendor host_os target target_cpu target_vendor target_os INSTALL_PROGRAM INSTALL_SCRIPT INSTALL_DATA LN LN_S build_libsubdir build_subdir host_subdir target_subdir CC CFLAGS LDFLAGS CPPFLAGS ac_ct_CC EXEEXT OBJEXT CXX CXXFLAGS ac_ct_CXX GNATBIND ac_ct_GNATBIND GNATMAKE ac_ct_GNATMAKE do_compare gmplibs gmpinc stage1_languages SYSROOT_CFLAGS_FOR_TARGET DEBUG_PREFIX_CFLAGS_FOR_TARGET CFLAGS_FOR_TARGET CXXFLAGS_FOR_TARGET RPATH_ENVVAR tooldir build_tooldir CONFIGURE_GDB_TK GDB_TK INSTALL_GDB_TK build_configargs build_configdirs host_configargs configdirs target_configargs AR_FOR_BUILD AS_FOR_BUILD CC_FOR_BUILD CFLAGS_FOR_BUILD CXXFLAGS_FOR_BUILD CXX_FOR_BUILD DLLTOOL_FOR_BUILD GCJ_FOR_BUILD GFORTRAN_FOR_BUILD LDFLAGS_FOR_BUILD LD_FOR_BUILD NM_FOR_BUILD RANLIB_FOR_BUILD WINDMC_FOR_BUILD WINDRES_FOR_BUILD config_shell YACC BISON M4 LEX FLEX MAKEINFO EXPECT RUNTEST AR AS DLLTOOL LD LIPO NM RANLIB STRIP WINDRES WINDMC OBJCOPY OBJDUMP CC_FOR_TARGET CXX_FOR_TARGET GCC_FOR_TARGET GCJ_FOR_TARGET GFORTRAN_FOR_TARGET AR_FOR_TARGET AS_FOR_TARGET DLLTOOL_FOR_TARGET LD_FOR_TARGET LIPO_FOR_TARGET NM_FOR_TARGET OBJDUMP_FOR_TARGET RANLIB_FOR_TARGET STRIP_FOR_TARGET WINDRES_FOR_TARGET WINDMC_FOR_TARGET RAW_CXX_FOR_TARGET FLAGS_FOR_TARGET COMPILER_AS_FOR_TARGET COMPILER_LD_FOR_TARGET COMPILER_NM_FOR_TARGET MAINTAINER_MODE_TRUE MAINTAINER_MODE_FALSE MAINT stage1_cflags stage1_checking stage2_werror_flag datarootdir docdir pdfdir htmldir LIBOBJS LTLIBOBJS'\n+ac_subst_vars='SHELL PATH_SEPARATOR PACKAGE_NAME PACKAGE_TARNAME PACKAGE_VERSION PACKAGE_STRING PACKAGE_BUGREPORT exec_prefix prefix program_transform_name bindir sbindir libexecdir datadir sysconfdir sharedstatedir localstatedir libdir includedir oldincludedir infodir mandir build_alias host_alias target_alias DEFS ECHO_C ECHO_N ECHO_T LIBS TOPLEVEL_CONFIGURE_ARGUMENTS build build_cpu build_vendor build_os build_noncanonical host_noncanonical target_noncanonical host host_cpu host_vendor host_os target target_cpu target_vendor target_os INSTALL_PROGRAM INSTALL_SCRIPT INSTALL_DATA LN LN_S build_libsubdir build_subdir host_subdir target_subdir CC CFLAGS LDFLAGS CPPFLAGS ac_ct_CC EXEEXT OBJEXT CXX CXXFLAGS ac_ct_CXX GNATBIND ac_ct_GNATBIND GNATMAKE ac_ct_GNATMAKE do_compare gmplibs gmpinc stage1_languages SYSROOT_CFLAGS_FOR_TARGET DEBUG_PREFIX_CFLAGS_FOR_TARGET CFLAGS_FOR_TARGET CXXFLAGS_FOR_TARGET RPATH_ENVVAR GCC_SHLIB_SUBDIR tooldir build_tooldir CONFIGURE_GDB_TK GDB_TK INSTALL_GDB_TK build_configargs build_configdirs host_configargs configdirs target_configargs AR_FOR_BUILD AS_FOR_BUILD CC_FOR_BUILD CFLAGS_FOR_BUILD CXXFLAGS_FOR_BUILD CXX_FOR_BUILD DLLTOOL_FOR_BUILD GCJ_FOR_BUILD GFORTRAN_FOR_BUILD LDFLAGS_FOR_BUILD LD_FOR_BUILD NM_FOR_BUILD RANLIB_FOR_BUILD WINDMC_FOR_BUILD WINDRES_FOR_BUILD config_shell YACC BISON M4 LEX FLEX MAKEINFO EXPECT RUNTEST AR AS DLLTOOL LD LIPO NM RANLIB STRIP WINDRES WINDMC OBJCOPY OBJDUMP CC_FOR_TARGET CXX_FOR_TARGET GCC_FOR_TARGET GCJ_FOR_TARGET GFORTRAN_FOR_TARGET AR_FOR_TARGET AS_FOR_TARGET DLLTOOL_FOR_TARGET LD_FOR_TARGET LIPO_FOR_TARGET NM_FOR_TARGET OBJDUMP_FOR_TARGET RANLIB_FOR_TARGET STRIP_FOR_TARGET WINDRES_FOR_TARGET WINDMC_FOR_TARGET RAW_CXX_FOR_TARGET FLAGS_FOR_TARGET COMPILER_AS_FOR_TARGET COMPILER_LD_FOR_TARGET COMPILER_NM_FOR_TARGET MAINTAINER_MODE_TRUE MAINTAINER_MODE_FALSE MAINT stage1_cflags stage1_checking stage2_werror_flag datarootdir docdir pdfdir htmldir LIBOBJS LTLIBOBJS'\n ac_subst_files='serialization_dependencies host_makefile_frag target_makefile_frag alphaieee_frag ospace_frag'\n ac_pwd=`pwd`\n \n@@ -5594,12 +5594,23 @@ case \"${host}\" in\n   ;;\n esac\n \n+# Decide which environment variable is used to find dynamic libraries.\n case \"${host}\" in\n   *-*-hpux*) RPATH_ENVVAR=SHLIB_PATH ;;\n   *-*-darwin* | *-*-rhapsody* ) RPATH_ENVVAR=DYLD_LIBRARY_PATH ;;\n+  *-*-mingw* | *-*-cygwin ) RPATH_ENVVAR=PATH ;;\n   *) RPATH_ENVVAR=LD_LIBRARY_PATH ;;\n esac\n \n+# On systems where the dynamic library environment variable is PATH,\n+# gcc/ will put dynamic libraries into a subdirectory to avoid adding\n+# built executables to PATH.\n+if test \"$RPATH_ENVVAR\" = PATH; then\n+  GCC_SHLIB_SUBDIR=/shlib\n+else\n+  GCC_SHLIB_SUBDIR=\n+fi\n+\n # Record target_configdirs and the configure arguments for target and\n # build configuration in Makefile.\n target_configdirs=`echo \"${target_configdirs}\" | sed -e 's/target-//g'`\n@@ -6072,6 +6083,7 @@ done\n \n \n \n+\n # Build module lists & subconfigure args.\n \n \n@@ -12971,6 +12983,7 @@ s,@DEBUG_PREFIX_CFLAGS_FOR_TARGET@,$DEBUG_PREFIX_CFLAGS_FOR_TARGET,;t t\n s,@CFLAGS_FOR_TARGET@,$CFLAGS_FOR_TARGET,;t t\n s,@CXXFLAGS_FOR_TARGET@,$CXXFLAGS_FOR_TARGET,;t t\n s,@RPATH_ENVVAR@,$RPATH_ENVVAR,;t t\n+s,@GCC_SHLIB_SUBDIR@,$GCC_SHLIB_SUBDIR,;t t\n s,@tooldir@,$tooldir,;t t\n s,@build_tooldir@,$build_tooldir,;t t\n s,@CONFIGURE_GDB_TK@,$CONFIGURE_GDB_TK,;t t"}, {"sha": "e9309a6c6dea8da56d6e82df90a2530bd0e45fb8", "filename": "configure.ac", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d89f0ad6225ed957153f92edf50f06890193c32f/configure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d89f0ad6225ed957153f92edf50f06890193c32f/configure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/configure.ac?ref=d89f0ad6225ed957153f92edf50f06890193c32f", "patch": "@@ -2050,12 +2050,23 @@ case \"${host}\" in\n   ;;\n esac\n \n+# Decide which environment variable is used to find dynamic libraries.\n case \"${host}\" in\n   *-*-hpux*) RPATH_ENVVAR=SHLIB_PATH ;;\n   *-*-darwin* | *-*-rhapsody* ) RPATH_ENVVAR=DYLD_LIBRARY_PATH ;;\n+  *-*-mingw* | *-*-cygwin ) RPATH_ENVVAR=PATH ;;\n   *) RPATH_ENVVAR=LD_LIBRARY_PATH ;;\n esac\n \n+# On systems where the dynamic library environment variable is PATH,\n+# gcc/ will put dynamic libraries into a subdirectory to avoid adding\n+# built executables to PATH.\n+if test \"$RPATH_ENVVAR\" = PATH; then\n+  GCC_SHLIB_SUBDIR=/shlib\n+else\n+  GCC_SHLIB_SUBDIR=\n+fi\n+\n # Record target_configdirs and the configure arguments for target and\n # build configuration in Makefile.\n target_configdirs=`echo \"${target_configdirs}\" | sed -e 's/target-//g'`\n@@ -2513,6 +2524,7 @@ AC_SUBST_FILE(ospace_frag)\n \n # Miscellanea: directories, flags, etc.\n AC_SUBST(RPATH_ENVVAR)\n+AC_SUBST(GCC_SHLIB_SUBDIR)\n AC_SUBST(tooldir)\n AC_SUBST(build_tooldir)\n AC_SUBST(CONFIGURE_GDB_TK)"}, {"sha": "7b14a2c442837e6ea093d85f71936f4d407fce5e", "filename": "gcc/ChangeLog", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d89f0ad6225ed957153f92edf50f06890193c32f/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d89f0ad6225ed957153f92edf50f06890193c32f/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=d89f0ad6225ed957153f92edf50f06890193c32f", "patch": "@@ -1,3 +1,15 @@\n+2008-08-31  Aaron W. LaFramboise  <aaronavay62@aaronwl.com>\n+\n+\t* mkmap-flat.awk: Add option pe_dll.\n+\t* config/i386/t-cygming (SHLIB_LINK): Support building libgcc_s.\n+\t* config/i386/t-cygwin (SHLIB_LC): Add.\n+\t* config/i386/t-mingw32 (SHLIB_LC): Add.\n+\t* config/i386/mingw32.h (SHARED_LIBGCC_UNDEFS_SPEC): New.\n+\t(SUBTARGET_EXTRA_SPECS): Use SHARED_LIBGCC_UNDEFS_SPEC.\n+\t(LINK_SPEC): Support libgcc_s.\n+\t(LIBGCC_SPEC): Support libgcc_s.\n+\t(LIBGCC_SONAME): New.\n+\n 2008-08-31  Jan Hubicka  <jh@suse.cz>\n \n \t* predict.c (maybe_hot_bb_p, maybe_hot_edge_p): Previous commit"}, {"sha": "bb5fd7f7e6ec9ee4c1810d2bf384781294ecdb01", "filename": "gcc/config/i386/mingw32.h", "status": "modified", "additions": 21, "deletions": 4, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d89f0ad6225ed957153f92edf50f06890193c32f/gcc%2Fconfig%2Fi386%2Fmingw32.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d89f0ad6225ed957153f92edf50f06890193c32f/gcc%2Fconfig%2Fi386%2Fmingw32.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fmingw32.h?ref=d89f0ad6225ed957153f92edf50f06890193c32f", "patch": "@@ -67,19 +67,33 @@ along with GCC; see the file COPYING3.  If not see\n #define LIB_SPEC \"%{pg:-lgmon} %{mwindows:-lgdi32 -lcomdlg32} \\\n                   -luser32 -lkernel32 -ladvapi32 -lshell32\"\n \n-/* Include in the mingw32 libraries with libgcc */\n-#undef LINK_SPEC\n+/* Weak symbols do not get resolved if using a Windows dll import lib.\n+   Make the unwind registration references strong undefs.  */\n+#if DWARF2_UNWIND_INFO\n+#define SHARED_LIBGCC_UNDEFS_SPEC \\\n+ \"%{shared-libgcc: -u ___register_frame_info -u ___deregister_frame_info}\"\n+#else\n+#define SHARED_LIBGCC_UNDEFS_SPEC \"\"\n+#endif\n+\n+#undef  SUBTARGET_EXTRA_SPECS\n+#define SUBTARGET_EXTRA_SPECS\t\t\t\t\t\t\\\n+  { \"shared_libgcc_undefs\", SHARED_LIBGCC_UNDEFS_SPEC }\n+\n #define LINK_SPEC \"%{mwindows:--subsystem windows} \\\n   %{mconsole:--subsystem console} \\\n   %{shared: %{mdll: %eshared and mdll are not compatible}} \\\n   %{shared: --shared} %{mdll:--dll} \\\n   %{static:-Bstatic} %{!static:-Bdynamic} \\\n-  %{shared|mdll: -e _DllMainCRTStartup@12}\"\n+  %{shared|mdll: -e _DllMainCRTStartup@12 --enable-auto-image-base} \\\n+  %(shared_libgcc_undefs)\"\n \n /* Include in the mingw32 libraries with libgcc */\n #undef LIBGCC_SPEC\n #define LIBGCC_SPEC \\\n-  \"%{mthreads:-lmingwthrd} -lmingw32 -lgcc -lmoldname -lmingwex -lmsvcrt\"\n+  \"-lmingw32 \\\n+   %{shared-libgcc:-lgcc_s} -lgcc \\\n+   -lmoldname -lmingwex -lmsvcrt\"\n \n #undef STARTFILE_SPEC\n #define STARTFILE_SPEC \"%{shared|mdll:dllcrt2%O%s} \\\n@@ -186,3 +200,6 @@ __enable_execute_stack (void *addr)\t\t\t\t\t\\\n #if !TARGET_64BIT\n #define MD_UNWIND_SUPPORT \"config/i386/w32-unwind.h\"\n #endif\n+\n+/* This matches SHLIB_SONAME and SHLIB_SOVERSION in t-cygming. */\n+#define LIBGCC_SONAME \"libgcc_s_1.dll\""}, {"sha": "c6e6cac7811f1f9e34ce27fad0dcadff208cf7c9", "filename": "gcc/config/i386/t-cygming", "status": "modified", "additions": 48, "deletions": 0, "changes": 48, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d89f0ad6225ed957153f92edf50f06890193c32f/gcc%2Fconfig%2Fi386%2Ft-cygming", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d89f0ad6225ed957153f92edf50f06890193c32f/gcc%2Fconfig%2Fi386%2Ft-cygming", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Ft-cygming?ref=d89f0ad6225ed957153f92edf50f06890193c32f", "patch": "@@ -36,3 +36,51 @@ msformat-c.o: $(srcdir)/config/i386/msformat-c.c $(CONFIG_H) $(SYSTEM_H) coretyp\n \t$(srcdir)/config/i386/msformat-c.c\n \n STMP_FIXINC=stmp-fixinc\n+\n+# Build a shared libgcc library for PECOFF with a DEF file\n+# with the GNU linker.\n+#\n+# mkmap-flat.awk is used with the pe_dll option to produce a DEF instead\n+# of an ELF map file.\n+#\n+# Warning: If SHLIB_SOVERSION or SHLIB_SONAME is updated, LIBGCC_SONAME\n+# in mingw32.h must be updated also.\n+\n+SHLIB_EXT = .dll\n+SHLIB_IMPLIB = @shlib_base_name@.a\n+SHLIB_SOVERSION = 1\n+SHLIB_SONAME = @shlib_base_name@_$(SHLIB_SOVERSION)$(SHLIB_EXT)\n+SHLIB_MAP = @shlib_map_file@\n+SHLIB_OBJS = @shlib_objs@\n+SHLIB_DIR = @multilib_dir@/shlib\n+SHLIB_SLIBDIR_QUAL = @shlib_slibdir_qual@\n+SHLIB_LC = -luser32 -lkernel32 -ladvapi32 -lshell32\n+\n+SHLIB_LINK = $(LN_S) $(SHLIB_MAP) $(SHLIB_MAP).def && \\\n+\tif [ ! -d $(SHLIB_DIR) ]; then \\\n+\t\tmkdir $(SHLIB_DIR) \\\n+\telse true; fi && \\\n+\t$(GCC_FOR_TARGET) $(LIBGCC2_CFLAGS) -shared -nodefaultlibs \\\n+\t$(SHLIB_MAP).def \\\n+\t-Wl,--out-implib,$(SHLIB_DIR)/$(SHLIB_IMPLIB).tmp \\\n+\t-o $(SHLIB_DIR)/$(SHLIB_SONAME).tmp @multilib_flags@ \\\n+\t$(SHLIB_OBJS) $(SHLIB_LC) && \\\n+\t$(AR_FOR_TARGET) -r $(SHLIB_DIR)/$(SHLIB_IMPLIB).tmp \\\n+\t\t_chkstk.o _ctors.o gthr-win32.o && \\\n+\tif [ -f $(SHLIB_DIR)/$(SHLIB_SONAME) ]; then \\\n+\t  mv -f $(SHLIB_DIR)/$(SHLIB_SONAME) \\\n+\t\t$(SHLIB_DIR)/$(SHLIB_SONAME).backup; \\\n+\telse true; fi && \\\n+\tmv $(SHLIB_DIR)/$(SHLIB_SONAME).tmp $(SHLIB_DIR)/$(SHLIB_SONAME) && \\\n+\tmv $(SHLIB_DIR)/$(SHLIB_IMPLIB).tmp $(SHLIB_DIR)/$(SHLIB_IMPLIB)\n+# $(slibdir) double quoted to protect it from expansion while building\n+# libgcc.mk.  We want this delayed until actual install time.\n+SHLIB_INSTALL = \\\n+\t$$(mkinstalldirs) $$(DESTDIR)$$(slibdir)$(SHLIB_SLIBDIR_QUAL); \\\n+\t$(INSTALL_PROGRAM) $(SHLIB_DIR)/$(SHLIB_SONAME) \\\n+\t  $$(DESTDIR)$$(bindir)/$(SHLIB_SONAME); \\\n+\t$(INSTALL_DATA) $(SHLIB_DIR)/$(SHLIB_IMPLIB) \\\n+\t  $$(DESTDIR)$$(slibdir)$(SHLIB_SLIBDIR_QUAL)/$(SHLIB_IMPLIB)\n+SHLIB_MKMAP = $(srcdir)/mkmap-flat.awk\n+SHLIB_MKMAP_OPTS = -v pe_dll=1\n+SHLIB_MAPFILES = $(srcdir)/libgcc-std.ver"}, {"sha": "3715c0b450ca43123abf2838db7c8f2bae2cf646", "filename": "gcc/config/i386/t-cygwin", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d89f0ad6225ed957153f92edf50f06890193c32f/gcc%2Fconfig%2Fi386%2Ft-cygwin", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d89f0ad6225ed957153f92edf50f06890193c32f/gcc%2Fconfig%2Fi386%2Ft-cygwin", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Ft-cygwin?ref=d89f0ad6225ed957153f92edf50f06890193c32f", "patch": "@@ -14,3 +14,5 @@ cygwin2.o: $(srcdir)/config/i386/cygwin2.c $(CONFIG_H) $(SYSTEM_H) coretypes.h \\\n \t$(CC) -c $(ALL_CFLAGS) $(ALL_CPPFLAGS) $(INCLUDES) \\\n \t$(srcdir)/config/i386/cygwin2.c\n \n+# Cygwin-specific parts of LIB_SPEC\n+SHLIB_LC += -lcygwin"}, {"sha": "79554e708f4a4bb75f204b15e3c926a7d74d68cf", "filename": "gcc/config/i386/t-mingw32", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d89f0ad6225ed957153f92edf50f06890193c32f/gcc%2Fconfig%2Fi386%2Ft-mingw32", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d89f0ad6225ed957153f92edf50f06890193c32f/gcc%2Fconfig%2Fi386%2Ft-mingw32", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Ft-mingw32?ref=d89f0ad6225ed957153f92edf50f06890193c32f", "patch": "@@ -1,2 +1,5 @@\n # Match SYSTEM_INCLUDE_DIR\n NATIVE_SYSTEM_HEADER_DIR = /mingw/include\n+\n+# MinGW-specific parts of LIB_SPEC\n+SHLIB_LC += -lmingw32 -lmingwex -lmoldname -lmsvcrt"}, {"sha": "4a9a99356d8d7c12e6b225436b8ab6e14146ea00", "filename": "gcc/mkmap-flat.awk", "status": "modified", "additions": 13, "deletions": 1, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d89f0ad6225ed957153f92edf50f06890193c32f/gcc%2Fmkmap-flat.awk", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d89f0ad6225ed957153f92edf50f06890193c32f/gcc%2Fmkmap-flat.awk", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fmkmap-flat.awk?ref=d89f0ad6225ed957153f92edf50f06890193c32f", "patch": "@@ -18,6 +18,11 @@\n # along with GCC; see the file COPYING3.  If not see\n # <http://www.gnu.org/licenses/>.\n \n+# Options:\n+#   \"-v leading_underscore=1\" : Symbols in map need leading underscore.\n+#   \"-v pe_dll=1\"             : Create .DEF file for Windows PECOFF\n+#                               DLL link instead of map file.\n+\n BEGIN {\n   state = \"nm\";\n   excluding = 0;\n@@ -86,7 +91,14 @@ $1 == \"}\" {\n }\n \n END {\n+\n+  if (pe_dll) {\n+    # This matches SHLIB_SONAME in config/i386/t-cygming.\n+    print \"LIBRARY libgcc_s_1.dll\";\n+    print \"EXPORTS\";\n+  }\n+\n   for (sym in export)\n-    if (def[sym])\n+    if (def[sym] || (pe_dll && def[\"_\" sym]))\n       print sym;\n }"}, {"sha": "29adf70c41f2af0d4e0fcc0cfc27ffa2d9057579", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d89f0ad6225ed957153f92edf50f06890193c32f/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d89f0ad6225ed957153f92edf50f06890193c32f/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=d89f0ad6225ed957153f92edf50f06890193c32f", "patch": "@@ -1,3 +1,16 @@\n+2008-08-31  Aaron W. LaFramboise  <aaronavay62@aaronwl.com>\n+\n+\t* acinclude.m4 <enable_symvers>: Don't use symvers on Windows.\n+\t* configure: Regenerated.\n+\t* Makefile.in: Regenerated.\n+\t* src/Makefile.in: Regenerated.\n+\t* doc/Makefile.in: Regenerated.\n+\t* po/Makefile.in: Regenerated.\n+\t* libmath/Makefile.in: Regenerated.\n+\t* include/Makefile.in: Regenerated.\n+\t* libsupc++/Makefile.in: Regenerated.\n+\t* testsuite/Makefile.in: Regenerated.\n+\n 2008-08-29  Mark Mitchell  <mark@codesourcery.com>\n \n \t* testsuite/25_algorithms/nth_element/2.cc: Constrain iterations"}, {"sha": "e1013ef9c24eb5eb6beadfc342f9bc0f1fcea6e6", "filename": "libstdc++-v3/Makefile.in", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d89f0ad6225ed957153f92edf50f06890193c32f/libstdc%2B%2B-v3%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d89f0ad6225ed957153f92edf50f06890193c32f/libstdc%2B%2B-v3%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FMakefile.in?ref=d89f0ad6225ed957153f92edf50f06890193c32f", "patch": "@@ -36,6 +36,7 @@ POST_UNINSTALL = :\n build_triplet = @build@\n host_triplet = @host@\n target_triplet = @target@\n+LIBOBJDIR =\n DIST_COMMON = README $(am__configure_deps) $(srcdir)/../config.guess \\\n \t$(srcdir)/../config.sub $(srcdir)/../install-sh \\\n \t$(srcdir)/../ltmain.sh $(srcdir)/../missing \\"}, {"sha": "279c4f3e1456247f629fa93cbc74d994bcd7d2e1", "filename": "libstdc++-v3/acinclude.m4", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d89f0ad6225ed957153f92edf50f06890193c32f/libstdc%2B%2B-v3%2Facinclude.m4", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d89f0ad6225ed957153f92edf50f06890193c32f/libstdc%2B%2B-v3%2Facinclude.m4", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Facinclude.m4?ref=d89f0ad6225ed957153f92edf50f06890193c32f", "patch": "@@ -2637,7 +2637,12 @@ if test x$enable_symvers = xyes ; then\n     enable_symvers=no\n   else\n     if test $with_gnu_ld = yes ; then\n-      enable_symvers=gnu\n+      case ${target_os} in\n+        cygwin* | pe | mingw32*)\n+          enable_symvers=no ;;\n+        *)\n+          enable_symvers=gnu ;;\n+      esac\n     else\n       case ${target_os} in\n         darwin*)"}, {"sha": "d7e034b9c4dffc19805e82d60252e58a9e2dc58c", "filename": "libstdc++-v3/configure", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d89f0ad6225ed957153f92edf50f06890193c32f/libstdc%2B%2B-v3%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d89f0ad6225ed957153f92edf50f06890193c32f/libstdc%2B%2B-v3%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fconfigure?ref=d89f0ad6225ed957153f92edf50f06890193c32f", "patch": "@@ -106551,7 +106551,12 @@ if test x$enable_symvers = xyes ; then\n     enable_symvers=no\n   else\n     if test $with_gnu_ld = yes ; then\n-      enable_symvers=gnu\n+      case ${target_os} in\n+        cygwin* | pe | mingw32*)\n+          enable_symvers=no ;;\n+        *)\n+          enable_symvers=gnu ;;\n+      esac\n     else\n       case ${target_os} in\n         darwin*)"}, {"sha": "ab2a902e766d9359b87f8c573430805dcd0fde1a", "filename": "libstdc++-v3/doc/Makefile.in", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d89f0ad6225ed957153f92edf50f06890193c32f/libstdc%2B%2B-v3%2Fdoc%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d89f0ad6225ed957153f92edf50f06890193c32f/libstdc%2B%2B-v3%2Fdoc%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fdoc%2FMakefile.in?ref=d89f0ad6225ed957153f92edf50f06890193c32f", "patch": "@@ -36,6 +36,7 @@ POST_UNINSTALL = :\n build_triplet = @build@\n host_triplet = @host@\n target_triplet = @target@\n+LIBOBJDIR =\n DIST_COMMON = $(srcdir)/Makefile.am $(srcdir)/Makefile.in \\\n \t$(top_srcdir)/fragment.am\n subdir = doc"}, {"sha": "81d0cc8063381234a3609cc5132f326565f11fac", "filename": "libstdc++-v3/include/Makefile.in", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d89f0ad6225ed957153f92edf50f06890193c32f/libstdc%2B%2B-v3%2Finclude%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d89f0ad6225ed957153f92edf50f06890193c32f/libstdc%2B%2B-v3%2Finclude%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2FMakefile.in?ref=d89f0ad6225ed957153f92edf50f06890193c32f", "patch": "@@ -36,6 +36,7 @@ POST_UNINSTALL = :\n build_triplet = @build@\n host_triplet = @host@\n target_triplet = @target@\n+LIBOBJDIR =\n DIST_COMMON = $(srcdir)/Makefile.am $(srcdir)/Makefile.in \\\n \t$(top_srcdir)/fragment.am\n subdir = include"}, {"sha": "18dfbcc55591929978dd37d8d173d166c84e334a", "filename": "libstdc++-v3/libmath/Makefile.in", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d89f0ad6225ed957153f92edf50f06890193c32f/libstdc%2B%2B-v3%2Flibmath%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d89f0ad6225ed957153f92edf50f06890193c32f/libstdc%2B%2B-v3%2Flibmath%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Flibmath%2FMakefile.in?ref=d89f0ad6225ed957153f92edf50f06890193c32f", "patch": "@@ -37,6 +37,7 @@ POST_UNINSTALL = :\n build_triplet = @build@\n host_triplet = @host@\n target_triplet = @target@\n+LIBOBJDIR =\n subdir = libmath\n DIST_COMMON = $(srcdir)/Makefile.am $(srcdir)/Makefile.in\n ACLOCAL_M4 = $(top_srcdir)/aclocal.m4"}, {"sha": "5b0a246f820dcaed003016dbacf30e1369aac108", "filename": "libstdc++-v3/libsupc++/Makefile.in", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d89f0ad6225ed957153f92edf50f06890193c32f/libstdc%2B%2B-v3%2Flibsupc%2B%2B%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d89f0ad6225ed957153f92edf50f06890193c32f/libstdc%2B%2B-v3%2Flibsupc%2B%2B%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Flibsupc%2B%2B%2FMakefile.in?ref=d89f0ad6225ed957153f92edf50f06890193c32f", "patch": "@@ -38,6 +38,7 @@ POST_UNINSTALL = :\n build_triplet = @build@\n host_triplet = @host@\n target_triplet = @target@\n+LIBOBJDIR =\n DIST_COMMON = $(glibcxxinstall_HEADERS) $(srcdir)/Makefile.am \\\n \t$(srcdir)/Makefile.in $(top_srcdir)/fragment.am\n subdir = libsupc++"}, {"sha": "408562e7fc60766fac304823b07e7d3b2459f2a0", "filename": "libstdc++-v3/po/Makefile.in", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d89f0ad6225ed957153f92edf50f06890193c32f/libstdc%2B%2B-v3%2Fpo%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d89f0ad6225ed957153f92edf50f06890193c32f/libstdc%2B%2B-v3%2Fpo%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fpo%2FMakefile.in?ref=d89f0ad6225ed957153f92edf50f06890193c32f", "patch": "@@ -36,6 +36,7 @@ POST_UNINSTALL = :\n build_triplet = @build@\n host_triplet = @host@\n target_triplet = @target@\n+LIBOBJDIR =\n DIST_COMMON = $(srcdir)/Makefile.am $(srcdir)/Makefile.in \\\n \t$(top_srcdir)/fragment.am\n subdir = po"}, {"sha": "2f4f3ddae7ad8eeb5b281d2e7aba3f77289c22c1", "filename": "libstdc++-v3/src/Makefile.in", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d89f0ad6225ed957153f92edf50f06890193c32f/libstdc%2B%2B-v3%2Fsrc%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d89f0ad6225ed957153f92edf50f06890193c32f/libstdc%2B%2B-v3%2Fsrc%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fsrc%2FMakefile.in?ref=d89f0ad6225ed957153f92edf50f06890193c32f", "patch": "@@ -37,6 +37,7 @@ POST_UNINSTALL = :\n build_triplet = @build@\n host_triplet = @host@\n target_triplet = @target@\n+LIBOBJDIR =\n DIST_COMMON = $(srcdir)/Makefile.am $(srcdir)/Makefile.in \\\n \t$(top_srcdir)/fragment.am\n subdir = src"}, {"sha": "9e58dfca798cfc84b05427732df72c35d3772984", "filename": "libstdc++-v3/testsuite/Makefile.in", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d89f0ad6225ed957153f92edf50f06890193c32f/libstdc%2B%2B-v3%2Ftestsuite%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d89f0ad6225ed957153f92edf50f06890193c32f/libstdc%2B%2B-v3%2Ftestsuite%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2FMakefile.in?ref=d89f0ad6225ed957153f92edf50f06890193c32f", "patch": "@@ -36,6 +36,7 @@ POST_UNINSTALL = :\n build_triplet = @build@\n host_triplet = @host@\n target_triplet = @target@\n+LIBOBJDIR =\n DIST_COMMON = $(srcdir)/Makefile.am $(srcdir)/Makefile.in \\\n \t$(top_srcdir)/fragment.am\n subdir = testsuite"}]}