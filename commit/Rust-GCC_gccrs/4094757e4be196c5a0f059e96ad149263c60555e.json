{"sha": "4094757e4be196c5a0f059e96ad149263c60555e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDA5NDc1N2U0YmUxOTZjNWEwZjA1OWU5NmFkMTQ5MjYzYzYwNTU1ZQ==", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2014-02-25T08:57:42Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2014-02-25T08:57:42Z"}, "message": "re PR lto/60319 (wrong code (that hangs) by LTO at -Os and above on x86_64-linux-gnu)\n\n2014-02-25  Richard Biener  <rguenther@suse.de>\n\n\tPR lto/60319\n\t* lto-opts.c (lto_write_options): Output non-explicit conservative\n\t-fwrapv, -fno-trapv and -fno-strict-overflow.\n\t* lto-wrapper.c (merge_and_complain): Handle merging those options.\n\t(run_gcc): And pass them through.\n\nFrom-SVN: r208112", "tree": {"sha": "f8e6f541c9aa135dc1f98fca81a46054249d5156", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f8e6f541c9aa135dc1f98fca81a46054249d5156"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4094757e4be196c5a0f059e96ad149263c60555e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4094757e4be196c5a0f059e96ad149263c60555e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4094757e4be196c5a0f059e96ad149263c60555e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4094757e4be196c5a0f059e96ad149263c60555e/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "adbdb8c76e9757634a688b093f6567d67b8b2498", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/adbdb8c76e9757634a688b093f6567d67b8b2498", "html_url": "https://github.com/Rust-GCC/gccrs/commit/adbdb8c76e9757634a688b093f6567d67b8b2498"}], "stats": {"total": 41, "additions": 40, "deletions": 1}, "files": [{"sha": "a7efc6528a6e1e2e62460f29365ec3f14938904e", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4094757e4be196c5a0f059e96ad149263c60555e/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4094757e4be196c5a0f059e96ad149263c60555e/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=4094757e4be196c5a0f059e96ad149263c60555e", "patch": "@@ -1,3 +1,11 @@\n+2014-02-25  Richard Biener  <rguenther@suse.de>\n+\n+\tPR lto/60319\n+\t* lto-opts.c (lto_write_options): Output non-explicit conservative\n+\t-fwrapv, -fno-trapv and -fno-strict-overflow.\n+\t* lto-wrapper.c (merge_and_complain): Handle merging those options.\n+\t(run_gcc): And pass them through.\n+\n 2014-02-25  Andrey Belevantsev  <abel@ispras.ru>\n \t\n \t* sel-sched.c (calculate_new_fences): New parameter ptime."}, {"sha": "06796d62a3eef47860a02d753bbd98ca23001816", "filename": "gcc/lto-opts.c", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4094757e4be196c5a0f059e96ad149263c60555e/gcc%2Flto-opts.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4094757e4be196c5a0f059e96ad149263c60555e/gcc%2Flto-opts.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flto-opts.c?ref=4094757e4be196c5a0f059e96ad149263c60555e", "patch": "@@ -117,6 +117,18 @@ lto_write_options (void)\n       default:\n \tgcc_unreachable ();\n       }\n+  /* We need to merge -f[no-]strict-overflow, -f[no-]wrapv and -f[no-]trapv\n+     conservatively, so stream out their defaults.  */\n+  if (!global_options_set.x_flag_wrapv\n+      && global_options.x_flag_wrapv)\n+    append_to_collect_gcc_options (&temporary_obstack, &first_p, \"-fwrapv\");\n+  if (!global_options_set.x_flag_trapv\n+      && !global_options.x_flag_trapv)\n+    append_to_collect_gcc_options (&temporary_obstack, &first_p, \"-fno-trapv\");\n+  if (!global_options_set.x_flag_strict_overflow\n+      && !global_options.x_flag_strict_overflow)\n+    append_to_collect_gcc_options (&temporary_obstack, &first_p,\n+\t\t\t       \"-fno-strict-overflow\");\n \n   /* Output explicitly passed options.  */\n   for (i = 1; i < save_decoded_options_count; ++i)"}, {"sha": "b17945a2ffea8f7ddd7436a5bfc8fbac42afd1a2", "filename": "gcc/lto-wrapper.c", "status": "modified", "additions": 20, "deletions": 1, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4094757e4be196c5a0f059e96ad149263c60555e/gcc%2Flto-wrapper.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4094757e4be196c5a0f059e96ad149263c60555e/gcc%2Flto-wrapper.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flto-wrapper.c?ref=4094757e4be196c5a0f059e96ad149263c60555e", "patch": "@@ -422,18 +422,34 @@ merge_and_complain (struct cl_decoded_option **decoded_options,\n \t    append_option (decoded_options, decoded_options_count, foption);\n \t  break;\n \n+\tcase OPT_ftrapv:\n+\tcase OPT_fstrict_overflow:\n \tcase OPT_ffp_contract_:\n \t  /* For selected options we can merge conservatively.  */\n \t  for (j = 0; j < *decoded_options_count; ++j)\n \t    if ((*decoded_options)[j].opt_index == foption->opt_index)\n \t      break;\n \t  if (j == *decoded_options_count)\n \t    append_option (decoded_options, decoded_options_count, foption);\n-\t  /* FP_CONTRACT_OFF < FP_CONTRACT_ON < FP_CONTRACT_FAST.  */\n+\t  /* FP_CONTRACT_OFF < FP_CONTRACT_ON < FP_CONTRACT_FAST,\n+\t     -fno-trapv < -ftrapv,\n+\t     -fno-strict-overflow < -fstrict-overflow  */\n \t  else if (foption->value < (*decoded_options)[j].value)\n \t    (*decoded_options)[j] = *foption;\n \t  break;\n \n+\tcase OPT_fwrapv:\n+\t  /* For selected options we can merge conservatively.  */\n+\t  for (j = 0; j < *decoded_options_count; ++j)\n+\t    if ((*decoded_options)[j].opt_index == foption->opt_index)\n+\t      break;\n+\t  if (j == *decoded_options_count)\n+\t    append_option (decoded_options, decoded_options_count, foption);\n+\t  /* -fwrapv > -fno-wrapv.  */\n+\t  else if (foption->value > (*decoded_options)[j].value)\n+\t    (*decoded_options)[j] = *foption;\n+\t  break;\n+\n \tcase OPT_freg_struct_return:\n \tcase OPT_fpcc_struct_return:\n \t  for (j = 0; j < *decoded_options_count; ++j)\n@@ -591,6 +607,9 @@ run_gcc (unsigned argc, char *argv[])\n \tcase OPT_freg_struct_return:\n \tcase OPT_fpcc_struct_return:\n \tcase OPT_ffp_contract_:\n+\tcase OPT_fwrapv:\n+\tcase OPT_ftrapv:\n+\tcase OPT_fstrict_overflow:\n \t  break;\n \n \tdefault:"}]}