{"sha": "c34311917ff87b75ea589afff6868437fc53c001", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzM0MzExOTE3ZmY4N2I3NWVhNTg5YWZmZjY4Njg0MzdmYzUzYzAwMQ==", "commit": {"author": {"name": "Martin Liska", "email": "mliska@suse.cz", "date": "2015-11-09T15:47:01Z"}, "committer": {"name": "Martin Liska", "email": "marxin@gcc.gnu.org", "date": "2015-11-09T15:47:01Z"}, "message": "Fix memory leaks in IPA.\n\n\t* ipa-inline-analysis.c (estimate_function_body_sizes): Call\n\tbody_info release function.\n\t* ipa-prop.c (ipa_release_body_info): New function.\n\t(ipa_analyze_node): Call the function.\n\t(ipa_node_params::~ipa_node_params): Release known_csts.\n\t* ipa-prop.h (ipa_release_body_info): Declare.\n\nFrom-SVN: r230028", "tree": {"sha": "ee35222d10eb23fd0c96ddb2b91ecec097a19a90", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ee35222d10eb23fd0c96ddb2b91ecec097a19a90"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c34311917ff87b75ea589afff6868437fc53c001", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c34311917ff87b75ea589afff6868437fc53c001", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c34311917ff87b75ea589afff6868437fc53c001", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c34311917ff87b75ea589afff6868437fc53c001/comments", "author": {"login": "marxin", "id": 2658545, "node_id": "MDQ6VXNlcjI2NTg1NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/2658545?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marxin", "html_url": "https://github.com/marxin", "followers_url": "https://api.github.com/users/marxin/followers", "following_url": "https://api.github.com/users/marxin/following{/other_user}", "gists_url": "https://api.github.com/users/marxin/gists{/gist_id}", "starred_url": "https://api.github.com/users/marxin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marxin/subscriptions", "organizations_url": "https://api.github.com/users/marxin/orgs", "repos_url": "https://api.github.com/users/marxin/repos", "events_url": "https://api.github.com/users/marxin/events{/privacy}", "received_events_url": "https://api.github.com/users/marxin/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "af121e828eb03233d731b25b590d1f7c5dd2693d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/af121e828eb03233d731b25b590d1f7c5dd2693d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/af121e828eb03233d731b25b590d1f7c5dd2693d"}], "stats": {"total": 33, "additions": 26, "deletions": 7}, "files": [{"sha": "bc9dbf1f4400a22569b4a78d9c21e10d7a40c398", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c34311917ff87b75ea589afff6868437fc53c001/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c34311917ff87b75ea589afff6868437fc53c001/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=c34311917ff87b75ea589afff6868437fc53c001", "patch": "@@ -1,3 +1,12 @@\n+2015-11-09  Martin Liska  <mliska@suse.cz>\n+\n+\t* ipa-inline-analysis.c (estimate_function_body_sizes): Call\n+\tbody_info release function.\n+\t* ipa-prop.c (ipa_release_body_info): New function.\n+\t(ipa_analyze_node): Call the function.\n+\t(ipa_node_params::~ipa_node_params): Release known_csts.\n+\t* ipa-prop.h (ipa_release_body_info): Declare.\n+\n 2015-11-09  Martin Liska  <mliska@suse.cz>\n \n \t* gcc.c (record_temp_file): Release name string."}, {"sha": "8c8b8e3af844621d8041f19794989b36f5de31e5", "filename": "gcc/ipa-inline-analysis.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c34311917ff87b75ea589afff6868437fc53c001/gcc%2Fipa-inline-analysis.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c34311917ff87b75ea589afff6868437fc53c001/gcc%2Fipa-inline-analysis.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-inline-analysis.c?ref=c34311917ff87b75ea589afff6868437fc53c001", "patch": "@@ -2853,7 +2853,7 @@ estimate_function_body_sizes (struct cgraph_node *node, bool early)\n   inline_summaries->get (node)->self_time = time;\n   inline_summaries->get (node)->self_size = size;\n   nonconstant_names.release ();\n-  fbi.bb_infos.release ();\n+  ipa_release_body_info (&fbi);\n   if (opt_for_fn (node->decl, optimize))\n     {\n       if (!early)"}, {"sha": "f379ea73909e21edf89d3b7087c6dee650df548f", "filename": "gcc/ipa-prop.c", "status": "modified", "additions": 15, "deletions": 5, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c34311917ff87b75ea589afff6868437fc53c001/gcc%2Fipa-prop.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c34311917ff87b75ea589afff6868437fc53c001/gcc%2Fipa-prop.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-prop.c?ref=c34311917ff87b75ea589afff6868437fc53c001", "patch": "@@ -2258,6 +2258,19 @@ analysis_dom_walker::before_dom_children (basic_block bb)\n   ipa_compute_jump_functions_for_bb (m_fbi, bb);\n }\n \n+/* Release body info FBI.  */\n+\n+void\n+ipa_release_body_info (struct ipa_func_body_info *fbi)\n+{\n+  int i;\n+  struct ipa_bb_info *bi;\n+\n+  FOR_EACH_VEC_ELT (fbi->bb_infos, i, bi)\n+    free_ipa_bb_info (bi);\n+  fbi->bb_infos.release ();\n+}\n+\n /* Initialize the array describing properties of formal parameters\n    of NODE, analyze their uses and compute jump functions associated\n    with actual arguments of calls from within NODE.  */\n@@ -2313,11 +2326,7 @@ ipa_analyze_node (struct cgraph_node *node)\n \n   analysis_dom_walker (&fbi).walk (ENTRY_BLOCK_PTR_FOR_FN (cfun));\n \n-  int i;\n-  struct ipa_bb_info *bi;\n-  FOR_EACH_VEC_ELT (fbi.bb_infos, i, bi)\n-    free_ipa_bb_info (bi);\n-  fbi.bb_infos.release ();\n+  ipa_release_body_info (&fbi);\n   free_dominance_info (CDI_DOMINATORS);\n   pop_cfun ();\n }\n@@ -3306,6 +3315,7 @@ ipa_node_params::~ipa_node_params ()\n   free (lattices);\n   /* Lattice values and their sources are deallocated with their alocation\n      pool.  */\n+  known_csts.release ();\n   known_contexts.release ();\n \n   lattices = NULL;"}, {"sha": "2fe824d35cf1c78270ebb236c120eff1ef312ae3", "filename": "gcc/ipa-prop.h", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c34311917ff87b75ea589afff6868437fc53c001/gcc%2Fipa-prop.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c34311917ff87b75ea589afff6868437fc53c001/gcc%2Fipa-prop.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-prop.h?ref=c34311917ff87b75ea589afff6868437fc53c001", "patch": "@@ -775,7 +775,7 @@ bool ipa_modify_expr (tree *, bool, ipa_parm_adjustment_vec);\n ipa_parm_adjustment *ipa_get_adjustment_candidate (tree **, bool *,\n \t\t\t\t\t\t   ipa_parm_adjustment_vec,\n \t\t\t\t\t\t   bool);\n-\n+void ipa_release_body_info (struct ipa_func_body_info *);\n \n /* From tree-sra.c:  */\n tree build_ref_for_offset (location_t, tree, HOST_WIDE_INT, bool, tree,"}]}