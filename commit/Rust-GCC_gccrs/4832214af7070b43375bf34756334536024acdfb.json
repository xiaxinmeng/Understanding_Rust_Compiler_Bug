{"sha": "4832214af7070b43375bf34756334536024acdfb", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDgzMjIxNGFmNzA3MGI0MzM3NWJmMzQ3NTYzMzQ1MzYwMjRhY2RmYg==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@redhat.com", "date": "2006-09-01T17:59:41Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "2006-09-01T17:59:41Z"}, "message": "re PR c++/28899 (gimplification failed)\n\n        PR c++/28899\n        * gimplify.c (gimplify_modify_expr_rhs) [BIND_EXPR]: Handle\n        want_value.\n\n        * gimplify.c (voidify_wrapper_expr): Handle null type.\n\nFrom-SVN: r116637", "tree": {"sha": "3c685cb9c8c3dcc588beeaeb56a9d06d2c15b249", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3c685cb9c8c3dcc588beeaeb56a9d06d2c15b249"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4832214af7070b43375bf34756334536024acdfb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4832214af7070b43375bf34756334536024acdfb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4832214af7070b43375bf34756334536024acdfb", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4832214af7070b43375bf34756334536024acdfb/comments", "author": {"login": "jicama", "id": 266146, "node_id": "MDQ6VXNlcjI2NjE0Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/266146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jicama", "html_url": "https://github.com/jicama", "followers_url": "https://api.github.com/users/jicama/followers", "following_url": "https://api.github.com/users/jicama/following{/other_user}", "gists_url": "https://api.github.com/users/jicama/gists{/gist_id}", "starred_url": "https://api.github.com/users/jicama/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jicama/subscriptions", "organizations_url": "https://api.github.com/users/jicama/orgs", "repos_url": "https://api.github.com/users/jicama/repos", "events_url": "https://api.github.com/users/jicama/events{/privacy}", "received_events_url": "https://api.github.com/users/jicama/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "a56913dd3781809746ff00a6f296acee9bfc5b9a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a56913dd3781809746ff00a6f296acee9bfc5b9a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a56913dd3781809746ff00a6f296acee9bfc5b9a"}], "stats": {"total": 37, "additions": 33, "deletions": 4}, "files": [{"sha": "242104b35e7d0ffe44d3bf68b216a42818811a4e", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4832214af7070b43375bf34756334536024acdfb/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4832214af7070b43375bf34756334536024acdfb/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=4832214af7070b43375bf34756334536024acdfb", "patch": "@@ -1,3 +1,11 @@\n+2006-09-01  Jason Merrill  <jason@redhat.com>\n+\n+\tPR c++/28899\n+\t* gimplify.c (gimplify_modify_expr_rhs) [BIND_EXPR]: Handle\n+\twant_value.\n+\n+\t* gimplify.c (voidify_wrapper_expr): Handle null type.\n+\n 2006-09-01  Josh Conner  <jconner@apple.com>\n \n \tPR c++/25505"}, {"sha": "a408c01ae3aaecd1f678774de940493fc933bd99", "filename": "gcc/gimplify.c", "status": "modified", "additions": 17, "deletions": 4, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4832214af7070b43375bf34756334536024acdfb/gcc%2Fgimplify.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4832214af7070b43375bf34756334536024acdfb/gcc%2Fgimplify.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgimplify.c?ref=4832214af7070b43375bf34756334536024acdfb", "patch": "@@ -955,9 +955,9 @@ gimple_build_eh_filter (tree body, tree allowed, tree failure)\n tree\n voidify_wrapper_expr (tree wrapper, tree temp)\n {\n-  if (!VOID_TYPE_P (TREE_TYPE (wrapper)))\n+  tree type = TREE_TYPE (wrapper);\n+  if (type && !VOID_TYPE_P (type))\n     {\n-      tree type = TREE_TYPE (wrapper);\n       tree *p;\n \n       /* Set p to point to the body of the wrapper.  Loop until we find\n@@ -3415,10 +3415,23 @@ gimplify_modify_expr_rhs (tree *expr_p, tree *from_p, tree *to_p, tree *pre_p,\n       case STATEMENT_LIST:\n \t{\n \t  tree wrap = *from_p;\n-\t  tree t = voidify_wrapper_expr (wrap, *expr_p);\n+\t  tree t;\n+\n+\t  ret = gimplify_expr (to_p, pre_p, post_p,\n+\t\t\t       is_gimple_min_lval, fb_lvalue);\n+\t  if (ret != GS_ERROR)\n+\t    ret = GS_OK;\n+\n+\t  t = voidify_wrapper_expr (wrap, *expr_p);\n \t  gcc_assert (t == *expr_p);\n \n-\t  *expr_p = wrap;\n+\t  if (want_value)\n+\t    {\n+\t      gimplify_and_add (wrap, pre_p);\n+\t      *expr_p = unshare_expr (*to_p);\n+\t    }\n+\t  else\n+\t    *expr_p = wrap;\n \t  return GS_OK;\n \t}\n \t"}, {"sha": "4963e10e4cd7d9356d1b32cec05a5adb58a77bbc", "filename": "gcc/testsuite/g++.dg/ext/stmtexpr9.C", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4832214af7070b43375bf34756334536024acdfb/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fstmtexpr9.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4832214af7070b43375bf34756334536024acdfb/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fstmtexpr9.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fstmtexpr9.C?ref=4832214af7070b43375bf34756334536024acdfb", "patch": "@@ -0,0 +1,8 @@\n+// PR c++/28899\n+// { dg-options \"\" }\n+\n+void f()\n+{\n+  unsigned l, l1;\n+  l1 = l = ({ unsigned __v; __v; });\n+}"}]}