{"sha": "0ef63495144395085b1264877e8b11c803376410", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MGVmNjM0OTUxNDQzOTUwODViMTI2NDg3N2U4YjExYzgwMzM3NjQxMA==", "commit": {"author": {"name": "Thomas Koenig", "email": "Thomas.Koenig@online.de", "date": "2005-09-04T20:36:52Z"}, "committer": {"name": "Thomas Koenig", "email": "tkoenig@gcc.gnu.org", "date": "2005-09-04T20:36:52Z"}, "message": "re PR libfortran/23321 (Direct unformatted read beyond EOF cores)\n\n2005-09-04  Thomas Koenig  <Thomas.Koenig@online.de>\n\n\tPR libfortran/23321\n\t* io/transfer.c(data_transfer_init):  Check for a too-large\n\trecord number.  Return if sseek failed.\n\n2005-09-04  Thomas Koenig  <Thomas.Koenig@online.de>\n\n\tPR libfortran/23321\n\t* gfortran.dg/direct_io_4.f90:  New test case.\n\nFrom-SVN: r103835", "tree": {"sha": "980246c419799542558dca9b884df6c9e3881e82", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/980246c419799542558dca9b884df6c9e3881e82"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0ef63495144395085b1264877e8b11c803376410", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0ef63495144395085b1264877e8b11c803376410", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0ef63495144395085b1264877e8b11c803376410", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0ef63495144395085b1264877e8b11c803376410/comments", "author": null, "committer": null, "parents": [{"sha": "ca59f04b870c47814d9d81bff458a85579d46d12", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ca59f04b870c47814d9d81bff458a85579d46d12", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ca59f04b870c47814d9d81bff458a85579d46d12"}], "stats": {"total": 48, "additions": 47, "deletions": 1}, "files": [{"sha": "0988d1cad030bac4b65f7cc1cc91bd2eb9ee316f", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0ef63495144395085b1264877e8b11c803376410/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0ef63495144395085b1264877e8b11c803376410/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=0ef63495144395085b1264877e8b11c803376410", "patch": "@@ -1,3 +1,8 @@\n+2005-09-04  Thomas Koenig  <Thomas.Koenig@online.de>\n+\n+\tPR libfortran/23321\n+\t* gfortran.dg/direct_io_4.f90:  New test case.\n+\n 2005-09-04  Andrew Pinski  <pinskia@physics.uc.edu>\n             Rasmus Hahn  <rassahah@neofonie.de>\n "}, {"sha": "050796735147d6293e8a2932bb31291dbcd2888d", "filename": "gcc/testsuite/gfortran.dg/direct_io_4.f90", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0ef63495144395085b1264877e8b11c803376410/gcc%2Ftestsuite%2Fgfortran.dg%2Fdirect_io_4.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0ef63495144395085b1264877e8b11c803376410/gcc%2Ftestsuite%2Fgfortran.dg%2Fdirect_io_4.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fdirect_io_4.f90?ref=0ef63495144395085b1264877e8b11c803376410", "patch": "@@ -0,0 +1,22 @@\n+! { dg-do run }\n+! PR 23321 : Running off the end of a file was not detected with direct I/O.\n+program main\n+  implicit none\n+  integer(kind=1) :: a, b\n+  integer :: ios, i\n+\n+  a = 42\n+  open (unit=10,status=\"scratch\",recl=1,access=\"direct\")\n+  write(10,rec=1) a\n+\n+  read (10,rec=2, iostat=ios) b\n+  if (ios == 0) call abort\n+\n+  read (10, rec=82641, iostat=ios) b      ! This used to cause a segfault\n+  if (ios == 0) call abort\n+\n+  read(10, rec=1, iostat=ios) b\n+  if (ios /= 0) call abort \n+  if (a /= b) call abort\n+\n+end program main"}, {"sha": "20239792ea4020a28536a9ad733960731f9ddbf7", "filename": "libgfortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0ef63495144395085b1264877e8b11c803376410/libgfortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0ef63495144395085b1264877e8b11c803376410/libgfortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2FChangeLog?ref=0ef63495144395085b1264877e8b11c803376410", "patch": "@@ -1,3 +1,9 @@\n+2005-09-04  Thomas Koenig  <Thomas.Koenig@online.de>\n+\n+\tPR libfortran/23321\n+\t* io/transfer.c(data_transfer_init):  Check for a too-large\n+\trecord number.  Return if sseek failed.\n+\n 2005-09-03  Jakub Jelinek  <jakub@redhat.com>\n \n \t* io/read.c (read_x): Take int argument instead of fnode * and"}, {"sha": "59eb22d3dec1a2c218d227b746f667a8483299d4", "filename": "libgfortran/io/transfer.c", "status": "modified", "additions": 14, "deletions": 1, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0ef63495144395085b1264877e8b11c803376410/libgfortran%2Fio%2Ftransfer.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0ef63495144395085b1264877e8b11c803376410/libgfortran%2Fio%2Ftransfer.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fio%2Ftransfer.c?ref=0ef63495144395085b1264877e8b11c803376410", "patch": "@@ -1160,10 +1160,23 @@ data_transfer_init (int read_flag)\n       if (g.mode == READING && current_unit->mode  == WRITING)\n \t flush(current_unit->s);\n \n+      /* Check whether the record exists to be read.  Only\n+\t a partial record needs to exist.  */\n+\n+      if (g.mode == READING && (ioparm.rec -1)\n+\t  * current_unit->recl >= file_length (current_unit->s))\n+\t{\n+\t  generate_error (ERROR_BAD_OPTION, \"Non-existing record number\");\n+\t  return;\n+\t}\n+\n       /* Position the file.  */\n       if (sseek (current_unit->s,\n \t       (ioparm.rec - 1) * current_unit->recl) == FAILURE)\n-\tgenerate_error (ERROR_OS, NULL);\n+\t{\n+\t  generate_error (ERROR_OS, NULL);\n+\t  return;\n+\t}\n     }\n \n   /* Overwriting an existing sequential file ?"}]}