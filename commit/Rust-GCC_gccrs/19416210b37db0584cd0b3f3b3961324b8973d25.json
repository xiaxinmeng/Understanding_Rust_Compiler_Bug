{"sha": "19416210b37db0584cd0b3f3b3961324b8973d25", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTk0MTYyMTBiMzdkYjA1ODRjZDBiM2YzYjM5NjEzMjRiODk3M2QyNQ==", "commit": {"author": {"name": "Georg-Johann Lay", "email": "avr@gjlay.de", "date": "2018-02-01T15:54:20Z"}, "committer": {"name": "Georg-Johann Lay", "email": "gjl@gcc.gnu.org", "date": "2018-02-01T15:54:20Z"}, "message": "avr.c (avr_option_override): Move disabling of -fdelete-null-pointer-checks to...\n\ngcc/\n\t* config/avr/avr.c (avr_option_override): Move disabling of\n\t-fdelete-null-pointer-checks to...\n\t* common/config/avr/avr-common.c (avr_option_optimization_table):\n\t...here.\ntestsuite/\n\t* gcc.dg/tree-ssa/vrp111.c (dg-options): Add\n\t-fdelete-null-pointer-checks.\n\nFrom-SVN: r257301", "tree": {"sha": "e5bef7116d39c34d03bd7f558e1ced448eb9d1f8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e5bef7116d39c34d03bd7f558e1ced448eb9d1f8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/19416210b37db0584cd0b3f3b3961324b8973d25", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/19416210b37db0584cd0b3f3b3961324b8973d25", "html_url": "https://github.com/Rust-GCC/gccrs/commit/19416210b37db0584cd0b3f3b3961324b8973d25", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/19416210b37db0584cd0b3f3b3961324b8973d25/comments", "author": null, "committer": {"login": "sprintersb", "id": 8905355, "node_id": "MDQ6VXNlcjg5MDUzNTU=", "avatar_url": "https://avatars.githubusercontent.com/u/8905355?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sprintersb", "html_url": "https://github.com/sprintersb", "followers_url": "https://api.github.com/users/sprintersb/followers", "following_url": "https://api.github.com/users/sprintersb/following{/other_user}", "gists_url": "https://api.github.com/users/sprintersb/gists{/gist_id}", "starred_url": "https://api.github.com/users/sprintersb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sprintersb/subscriptions", "organizations_url": "https://api.github.com/users/sprintersb/orgs", "repos_url": "https://api.github.com/users/sprintersb/repos", "events_url": "https://api.github.com/users/sprintersb/events{/privacy}", "received_events_url": "https://api.github.com/users/sprintersb/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4d0bf3e1e184f78d4a2716245aa963aef0e918cf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4d0bf3e1e184f78d4a2716245aa963aef0e918cf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4d0bf3e1e184f78d4a2716245aa963aef0e918cf"}], "stats": {"total": 28, "additions": 19, "deletions": 9}, "files": [{"sha": "4dcc3644f366ebbe8ba28edfae9a481f678b8451", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/19416210b37db0584cd0b3f3b3961324b8973d25/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/19416210b37db0584cd0b3f3b3961324b8973d25/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=19416210b37db0584cd0b3f3b3961324b8973d25", "patch": "@@ -1,3 +1,10 @@\n+2018-02-01  Georg-Johann Lay  <avr@gjlay.de>\n+\n+\t* config/avr/avr.c (avr_option_override): Move disabling of\n+\t-fdelete-null-pointer-checks to...\n+\t* common/config/avr/avr-common.c (avr_option_optimization_table):\n+\t...here.\n+\n 2018-02-01  Richard Sandiford  <richard.sandiford@linaro.org>\n \n \tPR tree-optimization/81635"}, {"sha": "d6293b1192e255d55adb77ae116665010eda4a25", "filename": "gcc/common/config/avr/avr-common.c", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/19416210b37db0584cd0b3f3b3961324b8973d25/gcc%2Fcommon%2Fconfig%2Favr%2Favr-common.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/19416210b37db0584cd0b3f3b3961324b8973d25/gcc%2Fcommon%2Fconfig%2Favr%2Favr-common.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcommon%2Fconfig%2Favr%2Favr-common.c?ref=19416210b37db0584cd0b3f3b3961324b8973d25", "patch": "@@ -27,6 +27,12 @@\n /* Implement TARGET_OPTION_OPTIMIZATION_TABLE.  */\n static const struct default_options avr_option_optimization_table[] =\n   {\n+    // With -fdelete-null-pointer-checks option, the compiler assumes\n+    // that dereferencing of a null pointer would halt the program.\n+    // For AVR this assumption is not true and a program can safely\n+    // dereference null pointers.  Changes made by this option may not\n+    // work properly for AVR.  So disable this option.\n+    { OPT_LEVELS_ALL, OPT_fdelete_null_pointer_checks, NULL, 0 },\n     // The only effect of -fcaller-saves might be that it triggers\n     // a frame without need when it tries to be smart around calls.\n     { OPT_LEVELS_ALL, OPT_fcaller_saves, NULL, 0 },"}, {"sha": "81c35e7fbc2b06bc06cc7fb7406694bbe48860e5", "filename": "gcc/config/avr/avr.c", "status": "modified", "additions": 0, "deletions": 8, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/19416210b37db0584cd0b3f3b3961324b8973d25/gcc%2Fconfig%2Favr%2Favr.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/19416210b37db0584cd0b3f3b3961324b8973d25/gcc%2Fconfig%2Favr%2Favr.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Favr%2Favr.c?ref=19416210b37db0584cd0b3f3b3961324b8973d25", "patch": "@@ -730,14 +730,6 @@ avr_set_core_architecture (void)\n static void\n avr_option_override (void)\n {\n-  /* Disable -fdelete-null-pointer-checks option for AVR target.\n-     This option compiler assumes that dereferencing of a null pointer\n-     would halt the program.  For AVR this assumption is not true and\n-     programs can safely dereference null pointers.  Changes made by this\n-     option may not work properly for AVR.  So disable this option. */\n-\n-  flag_delete_null_pointer_checks = 0;\n-\n   /* caller-save.c looks for call-clobbered hard registers that are assigned\n      to pseudos that cross calls and tries so save-restore them around calls\n      in order to reduce the number of stack slots needed."}, {"sha": "da557b80629b49ae88d14c7b7edf92b1af23a2ce", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/19416210b37db0584cd0b3f3b3961324b8973d25/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/19416210b37db0584cd0b3f3b3961324b8973d25/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=19416210b37db0584cd0b3f3b3961324b8973d25", "patch": "@@ -1,3 +1,8 @@\n+2018-02-01  Georg-Johann Lay  <avr@gjlay.de>\n+\n+\t* gcc.dg/tree-ssa/vrp111.c (dg-options): Add\n+\t-fdelete-null-pointer-checks.\n+\n 2018-02-01  Paolo Carlini  <paolo.carlini@oracle.com>\n \n \tPR c++/83796"}, {"sha": "631442358be2c19c2c2a5350eb4ae252b77d8493", "filename": "gcc/testsuite/gcc.dg/tree-ssa/vrp111.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/19416210b37db0584cd0b3f3b3961324b8973d25/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fvrp111.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/19416210b37db0584cd0b3f3b3961324b8973d25/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fvrp111.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fvrp111.c?ref=19416210b37db0584cd0b3f3b3961324b8973d25", "patch": "@@ -1,5 +1,5 @@\n /* { dg-do compile } */\n-/* { dg-options \"-O2 -fdump-tree-evrp\" } */\n+/* { dg-options \"-O2 -fdump-tree-evrp -fdelete-null-pointer-checks\" } */\n \n void foo (void *p) __attribute__((nonnull(1)));\n "}]}