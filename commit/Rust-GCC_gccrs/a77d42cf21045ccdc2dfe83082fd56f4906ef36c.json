{"sha": "a77d42cf21045ccdc2dfe83082fd56f4906ef36c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTc3ZDQyY2YyMTA0NWNjZGMyZGZlODMwODJmZDU2ZjQ5MDZlZjM2Yw==", "commit": {"author": {"name": "Kaveh R. Ghazi", "email": "ghazi@caip.rutgers.edu", "date": "2006-09-29T19:14:58Z"}, "committer": {"name": "Kaveh Ghazi", "email": "ghazi@gcc.gnu.org", "date": "2006-09-29T19:14:58Z"}, "message": "inclhack.def (solaris_mutex_init_2): Update for Solaris9.\n\n\t* inclhack.def (solaris_mutex_init_2): Update for Solaris9.\n\tPrevent it from running on solaris10 or later.\n\t(solaris_once_init_2): Fix comment.\n\t* tests/base/pthread.h: Update.\n\n\t* fixincl.x: Regenerate.\n\nFrom-SVN: r117310", "tree": {"sha": "a90431ae9f443273785d6aa6f3f715b217aa2583", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a90431ae9f443273785d6aa6f3f715b217aa2583"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a77d42cf21045ccdc2dfe83082fd56f4906ef36c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a77d42cf21045ccdc2dfe83082fd56f4906ef36c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a77d42cf21045ccdc2dfe83082fd56f4906ef36c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a77d42cf21045ccdc2dfe83082fd56f4906ef36c/comments", "author": null, "committer": null, "parents": [{"sha": "504652cb4501b29e69030425430013c5b533bbbf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/504652cb4501b29e69030425430013c5b533bbbf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/504652cb4501b29e69030425430013c5b533bbbf"}], "stats": {"total": 58, "additions": 49, "deletions": 9}, "files": [{"sha": "9bfa5a5e05513ae90db71a1b68c2ab953131516b", "filename": "fixincludes/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a77d42cf21045ccdc2dfe83082fd56f4906ef36c/fixincludes%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a77d42cf21045ccdc2dfe83082fd56f4906ef36c/fixincludes%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/fixincludes%2FChangeLog?ref=a77d42cf21045ccdc2dfe83082fd56f4906ef36c", "patch": "@@ -1,3 +1,12 @@\n+2006-09-29  Kaveh R. Ghazi  <ghazi@caip.rutgers.edu>\n+\n+\t* inclhack.def (solaris_mutex_init_2): Update for Solaris9.\n+\tPrevent it from running on solaris10 or later.\n+\t(solaris_once_init_2): Fix comment.\n+\t* tests/base/pthread.h: Update.\n+\n+\t* fixincl.x: Regenerate.\n+\n 2006-09-27  Kaveh R. Ghazi  <ghazi@caip.rutgers.edu>\n \n \t* inclhack.def (solaris_once_init_2): New fix."}, {"sha": "e9c8b882b58ad3063881c71869120c36207b0545", "filename": "fixincludes/fixincl.x", "status": "modified", "additions": 9, "deletions": 5, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a77d42cf21045ccdc2dfe83082fd56f4906ef36c/fixincludes%2Ffixincl.x", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a77d42cf21045ccdc2dfe83082fd56f4906ef36c/fixincludes%2Ffixincl.x", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/fixincludes%2Ffixincl.x?ref=a77d42cf21045ccdc2dfe83082fd56f4906ef36c", "patch": "@@ -2,11 +2,11 @@\n  * \n  * DO NOT EDIT THIS FILE   (fixincl.x)\n  * \n- * It has been AutoGen-ed  Wednesday September 27, 2006 at 08:16:42 PM EDT\n+ * It has been AutoGen-ed  Thursday September 28, 2006 at 11:06:33 PM EDT\n  * From the definitions    inclhack.def\n  * and the template file   fixincl\n  */\n-/* DO NOT CVS-MERGE THIS FILE, EITHER Wed Sep 27 20:16:42 EDT 2006\n+/* DO NOT CVS-MERGE THIS FILE, EITHER Thu Sep 28 23:06:33 EDT 2006\n  *\n  * You must regenerate it.  Use the ./genfixes script.\n  *\n@@ -5471,7 +5471,10 @@ tSCC zSolaris_Mutex_Init_2List[] =\n /*\n  *  Machine/OS name selection pattern\n  */\n-#define apzSolaris_Mutex_Init_2Machs (const char**)NULL\n+tSCC* apzSolaris_Mutex_Init_2Machs[] = {\n+        \"*-*-solaris2.[0-9]\",\n+        \"*-*-solaris2.[0-9][!0-9]*\",\n+        (const char*)NULL };\n \n /*\n  *  content selection pattern - do fix if pattern found\n@@ -5491,9 +5494,10 @@ static const char* apzSolaris_Mutex_Init_2Patch[] = {\n     \"#if __STDC__ - 0 == 0 && !defined(_NO_LONGLONG)\\n\\\n %0\\n\\\n #else\\n\\\n-%1, {0}}%3\\n\\\n+%1, {0}}%4\\n\\\n #endif\",\n-    \"(^#define[ \\t]+PTHREAD_(MUTEX|COND)_INITIALIZER[ \\t]+\\\\{.*),[ \\t]*0\\\\}(|[ \\t].*)$\",\n+    \"(^#define[ \\t]+PTHREAD_(MUTEX|COND)_INITIALIZER[ \\t]+(|/*.**/[ \\t]*\\\\\\\\\\n\\\n+[ \\t]*)\\\\{.*),[ \\t]*0\\\\}(|[ \\t].*)$\",\n     (char*)NULL };\n \n /* * * * * * * * * * * * * * * * * * * * * * * * * *"}, {"sha": "acef2588c85ad9d092a91a26378623fe79816231", "filename": "fixincludes/inclhack.def", "status": "modified", "additions": 17, "deletions": 4, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a77d42cf21045ccdc2dfe83082fd56f4906ef36c/fixincludes%2Finclhack.def", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a77d42cf21045ccdc2dfe83082fd56f4906ef36c/fixincludes%2Finclhack.def", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/fixincludes%2Finclhack.def?ref=a77d42cf21045ccdc2dfe83082fd56f4906ef36c", "patch": "@@ -2972,18 +2972,31 @@ fix = {\n     hackname = solaris_mutex_init_2;\n     select = '@\\(#\\)pthread.h' \"[ \\t]+1.[0-9]+[ \\t]+[0-9/]+ SMI\";\n     files = pthread.h;\n+    /*\n+     * On Solaris 10, this fix is unnecessary because upad64_t is\n+     * always defined correctly regardless of the definition of the\n+     * __STDC__ macro.  The first \"mach\" pattern matches up to\n+     * solaris9.  The second \"mach\" pattern will not match any two (or\n+     * more) digit solaris version, but it will match e.g. 2.5.1.\n+     */\n+    mach = '*-*-solaris2.[0-9]', '*-*-solaris2.[0-9][!0-9]*';\n     c_fix = format;\n     c_fix_arg = \"#if __STDC__ - 0 == 0 && !defined(_NO_LONGLONG)\\n\"\n                 \"%0\\n\"\n                 \"#else\\n\"\n-                \"%1, {0}}%3\\n\"\n+                \"%1, {0}}%4\\n\"\n                 \"#endif\";\n-    c_fix_arg = \"(^#define[ \\t]+PTHREAD_(MUTEX|COND)_INITIALIZER[ \\t]+\\\\{.*)\"\n+    c_fix_arg = \"(^#define[ \\t]+PTHREAD_(MUTEX|COND)_INITIALIZER[ \\t]+\"\n+                \"(|/\\*.*\\*/[ \\t]*\\\\\\\\\\n[ \\t]*)\\\\{.*)\"\n                 \",[ \\t]*0\\\\}\" \"(|[ \\t].*)$\";\n     test_text =\n     '#ident \"@(#)pthread.h  1.26  98/04/12 SMI\"'\"\\n\"\n     \"#define PTHREAD_MUTEX_INITIALIZER\\t{{{0},0}, {{{0}}}, 0}\\n\"\n-    \"#define PTHREAD_COND_INITIALIZER\\t{{{0}, 0}, 0}\\t/* DEFAULTCV */\";\n+    \"#define PTHREAD_COND_INITIALIZER\\t{{{0}, 0}, 0}\\t/* DEFAULTCV */\\n\"\n+    \"#define\tPTHREAD_MUTEX_INITIALIZER\t\t/* = DEFAULTMUTEX */\t\\\\\\\\\\n\"\n+    \"\t{{0, 0, 0, DEFAULT_TYPE, _MUTEX_MAGIC}, {{{0}}}, 0}\\n\"\n+    \"#define\tPTHREAD_COND_INITIALIZER\t\t/* = DEFAULTCV */\t\\\\\\\\\\n\"\n+    \"\t{{{0, 0, 0, 0}, DEFAULT_TYPE, _COND_MAGIC}, 0}\";\n };\n \n \n@@ -3047,7 +3060,7 @@ fix = {\n     /*\n      * On Solaris 10, this fix is unnecessary because upad64_t is\n      * always defined correctly regardless of the definition of the\n-     * __STDC__ macro.  The first \"match\" pattern matches up to\n+     * __STDC__ macro.  The first \"mach\" pattern matches up to\n      * solaris9.  The second \"mach\" pattern will not match any two (or\n      * more) digit solaris version, but it will match e.g. 2.5.1.\n      */"}, {"sha": "b8366bfe51f2925d623a31ecfc61b96fc2ba2268", "filename": "fixincludes/tests/base/pthread.h", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a77d42cf21045ccdc2dfe83082fd56f4906ef36c/fixincludes%2Ftests%2Fbase%2Fpthread.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a77d42cf21045ccdc2dfe83082fd56f4906ef36c/fixincludes%2Ftests%2Fbase%2Fpthread.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/fixincludes%2Ftests%2Fbase%2Fpthread.h?ref=a77d42cf21045ccdc2dfe83082fd56f4906ef36c", "patch": "@@ -94,6 +94,20 @@ extern int __sigsetjmp (struct __jmp_buf_tag *__env, int __savemask);\n #else\n #define PTHREAD_COND_INITIALIZER\t{{{0}, 0}, {0}}\t/* DEFAULTCV */\n #endif\n+#if __STDC__ - 0 == 0 && !defined(_NO_LONGLONG)\n+#define\tPTHREAD_MUTEX_INITIALIZER\t\t/* = DEFAULTMUTEX */\t\\\n+\t{{0, 0, 0, DEFAULT_TYPE, _MUTEX_MAGIC}, {{{0}}}, 0}\n+#else\n+#define\tPTHREAD_MUTEX_INITIALIZER\t\t/* = DEFAULTMUTEX */\t\\\n+\t{{0, 0, 0, DEFAULT_TYPE, _MUTEX_MAGIC}, {{{0}}}, {0}}\n+#endif\n+#if __STDC__ - 0 == 0 && !defined(_NO_LONGLONG)\n+#define\tPTHREAD_COND_INITIALIZER\t\t/* = DEFAULTCV */\t\\\n+\t{{{0, 0, 0, 0}, DEFAULT_TYPE, _COND_MAGIC}, 0}\n+#else\n+#define\tPTHREAD_COND_INITIALIZER\t\t/* = DEFAULTCV */\t\\\n+\t{{{0, 0, 0, 0}, DEFAULT_TYPE, _COND_MAGIC}, {0}}\n+#endif\n #endif  /* SOLARIS_MUTEX_INIT_2_CHECK */\n \n "}]}