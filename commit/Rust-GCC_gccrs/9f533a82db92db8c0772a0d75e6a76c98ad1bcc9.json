{"sha": "9f533a82db92db8c0772a0d75e6a76c98ad1bcc9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWY1MzNhODJkYjkyZGI4YzA3NzJhMGQ3NWU2YTc2Yzk4YWQxYmNjOQ==", "commit": {"author": {"name": "Jeff Law", "email": "law@redhat.com", "date": "2018-02-17T06:37:22Z"}, "committer": {"name": "Jeff Law", "email": "law@gcc.gnu.org", "date": "2018-02-17T06:37:22Z"}, "message": "rx.c (add_pop_cfi_notes): New function.;\n\n\t* config/rx/rx.c (add_pop_cfi_notes): New function.;\n\t(pop_regs): Use it.\n\nFrom-SVN: r257780", "tree": {"sha": "4b324cb507da5900af1890737dc397edc176789f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4b324cb507da5900af1890737dc397edc176789f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9f533a82db92db8c0772a0d75e6a76c98ad1bcc9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9f533a82db92db8c0772a0d75e6a76c98ad1bcc9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9f533a82db92db8c0772a0d75e6a76c98ad1bcc9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9f533a82db92db8c0772a0d75e6a76c98ad1bcc9/comments", "author": null, "committer": null, "parents": [{"sha": "1d569881592ea86828176843c77eec8f2719e4b2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1d569881592ea86828176843c77eec8f2719e4b2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1d569881592ea86828176843c77eec8f2719e4b2"}], "stats": {"total": 28, "additions": 25, "deletions": 3}, "files": [{"sha": "b47d28213739163cc9d90db9ce0aea1cf0ac1e9c", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9f533a82db92db8c0772a0d75e6a76c98ad1bcc9/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9f533a82db92db8c0772a0d75e6a76c98ad1bcc9/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=9f533a82db92db8c0772a0d75e6a76c98ad1bcc9", "patch": "@@ -1,3 +1,8 @@\n+2018-02-16  Jeff Law  <law@redhat.com>\n+\n+\t* config/rx/rx.c (add_pop_cfi_notes): New function.;\n+\t(pop_regs): Use it.\n+\n 2018-02-16  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR ipa/84425"}, {"sha": "007e052c9a8edecddf3117ee12421acd2a319c59", "filename": "gcc/config/rx/rx.c", "status": "modified", "additions": 20, "deletions": 3, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9f533a82db92db8c0772a0d75e6a76c98ad1bcc9/gcc%2Fconfig%2Frx%2Frx.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9f533a82db92db8c0772a0d75e6a76c98ad1bcc9/gcc%2Fconfig%2Frx%2Frx.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frx%2Frx.c?ref=9f533a82db92db8c0772a0d75e6a76c98ad1bcc9", "patch": "@@ -1644,6 +1644,20 @@ mark_frame_related (rtx insn)\n     }\n }\n \n+/* Create CFI notes for register pops.  */\n+static void\n+add_pop_cfi_notes (rtx_insn *insn, unsigned int high, unsigned int low)\n+{\n+  rtx t = plus_constant (Pmode, stack_pointer_rtx,\n+                        (high - low + 1) * UNITS_PER_WORD);\n+  t = gen_rtx_SET (stack_pointer_rtx, t);\n+  add_reg_note (insn, REG_CFA_ADJUST_CFA, t);\n+  RTX_FRAME_RELATED_P (insn) = 1;\n+  for (unsigned int i = low; i <= high; i++)\n+    add_reg_note (insn, REG_CFA_RESTORE, gen_rtx_REG (word_mode, i));\n+}\n+\n+\n static bool\n ok_for_max_constant (HOST_WIDE_INT val)\n {\n@@ -2029,11 +2043,14 @@ rx_can_use_simple_return (void)\n static void\n pop_regs (unsigned int high, unsigned int low)\n {\n+  rtx_insn *insn;\n   if (high == low)\n-    emit_insn (gen_stack_pop (gen_rtx_REG (SImode, low)));\n+    insn = emit_insn (gen_stack_pop (gen_rtx_REG (SImode, low)));\n   else\n-    emit_insn (gen_stack_popm (GEN_INT (((high - low) + 1) * UNITS_PER_WORD),\n-\t\t\t       gen_rx_popm_vector (low, high)));\n+    insn = emit_insn (gen_stack_popm (GEN_INT (((high - low) + 1)\n+\t\t\t\t\t\t* UNITS_PER_WORD),\n+\t\t\t\t      gen_rx_popm_vector (low, high)));\n+  add_pop_cfi_notes (insn, high, low);\n }\n \n void"}]}