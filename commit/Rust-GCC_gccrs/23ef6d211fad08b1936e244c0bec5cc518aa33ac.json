{"sha": "23ef6d211fad08b1936e244c0bec5cc518aa33ac", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjNlZjZkMjExZmFkMDhiMTkzNmUyNDRjMGJlYzVjYzUxOGFhMzNhYw==", "commit": {"author": {"name": "Ben Elliston", "email": "bje@au.ibm.com", "date": "2008-04-05T03:50:18Z"}, "committer": {"name": "Ben Elliston", "email": "bje@gcc.gnu.org", "date": "2008-04-05T03:50:18Z"}, "message": "tree-cfg.c (need_fake_edge_p): Return false for calls to builtins that return exactly once and do not throw.\n\n\t* tree-cfg.c (need_fake_edge_p): Return false for calls to\n\tbuiltins that return exactly once and do not throw. Cache call to\n\tcall_expr_flags.\n\nFrom-SVN: r133929", "tree": {"sha": "f13f58050775614ea8d63ab5cbedf12b98860b29", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f13f58050775614ea8d63ab5cbedf12b98860b29"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/23ef6d211fad08b1936e244c0bec5cc518aa33ac", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/23ef6d211fad08b1936e244c0bec5cc518aa33ac", "html_url": "https://github.com/Rust-GCC/gccrs/commit/23ef6d211fad08b1936e244c0bec5cc518aa33ac", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/23ef6d211fad08b1936e244c0bec5cc518aa33ac/comments", "author": null, "committer": null, "parents": [{"sha": "c44b856a0b8071c190237763720ee07eaade0050", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c44b856a0b8071c190237763720ee07eaade0050", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c44b856a0b8071c190237763720ee07eaade0050"}], "stats": {"total": 24, "additions": 21, "deletions": 3}, "files": [{"sha": "d12cf3d5f51fcf6de31e3a2c4b120b17b06ce227", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/23ef6d211fad08b1936e244c0bec5cc518aa33ac/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/23ef6d211fad08b1936e244c0bec5cc518aa33ac/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=23ef6d211fad08b1936e244c0bec5cc518aa33ac", "patch": "@@ -1,3 +1,9 @@\n+2008-04-05  Ben Elliston  <bje@au.ibm.com>\n+\n+\t* tree-cfg.c (need_fake_edge_p): Return false for calls to\n+\tbuiltins that return exactly once and do not throw. Cache call to\n+\tcall_expr_flags.\n+\n 2008-04-04 Andy Hutchinson <hutchinsonandy@aim.com>\n \n \tPR rtl-optimization/34916"}, {"sha": "cf2001faae3df1723201cf84b536c664c0038389", "filename": "gcc/tree-cfg.c", "status": "modified", "additions": 15, "deletions": 3, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/23ef6d211fad08b1936e244c0bec5cc518aa33ac/gcc%2Ftree-cfg.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/23ef6d211fad08b1936e244c0bec5cc518aa33ac/gcc%2Ftree-cfg.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-cfg.c?ref=23ef6d211fad08b1936e244c0bec5cc518aa33ac", "patch": "@@ -6420,7 +6420,8 @@ tree_block_ends_with_condjump_p (const_basic_block bb)\n static bool\n need_fake_edge_p (tree t)\n {\n-  tree call;\n+  tree call, fndecl = NULL_TREE;\n+  int call_flags;\n \n   /* NORETURN and LONGJMP calls already have an edge to exit.\n      CONST and PURE calls do not need one.\n@@ -6430,8 +6431,19 @@ need_fake_edge_p (tree t)\n      the counter incrementation code from -fprofile-arcs\n      leads to different results from -fbranch-probabilities.  */\n   call = get_call_expr_in (t);\n-  if (call\n-      && !(call_expr_flags (call) & ECF_NORETURN))\n+  if (call)\n+    {\n+      fndecl = get_callee_fndecl (call);\n+      call_flags = call_expr_flags (call);\n+    }\n+\n+  if (call && fndecl && DECL_BUILT_IN (fndecl)\n+      && (call_flags & ECF_NOTHROW)\n+      && !(call_flags & ECF_NORETURN)\n+      && !(call_flags & ECF_RETURNS_TWICE))\n+   return false;\n+\n+  if (call && !(call_flags & ECF_NORETURN))\n     return true;\n \n   if (TREE_CODE (t) == ASM_EXPR"}]}