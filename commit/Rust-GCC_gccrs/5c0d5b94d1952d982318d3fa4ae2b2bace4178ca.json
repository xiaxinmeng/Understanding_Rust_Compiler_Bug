{"sha": "5c0d5b94d1952d982318d3fa4ae2b2bace4178ca", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NWMwZDViOTRkMTk1MmQ5ODIzMThkM2ZhNGFlMmIyYmFjZTQxNzhjYQ==", "commit": {"author": {"name": "Zack Weinberg", "email": "zack@wolery.cumb.org", "date": "2000-01-19T21:41:04Z"}, "committer": {"name": "Zack Weinberg", "email": "zack@gcc.gnu.org", "date": "2000-01-19T21:41:04Z"}, "message": "Makefile.in: Correct dependencies of fixincl and fixincl.o.\n\n\t* fixinc/Makefile.in: Correct dependencies of fixincl and fixincl.o.\n\t* fixinc/fixfixes.c (IO_use, CTRL_use, IO_defn, CTRL_defn): New fixes.\n\t(fix_char_macro_defines, fix_char_macro_uses): New functions.\n\n\t* fixinc/fixlib.c (is_cxx_header): Do the text scan with a regexp.\n\tRecognize Emacs mode markers also.\n\t* fixinc/fixtests.c (else_endif_label): Fix bug in recognition of\n\tC++ comments in C++ headers.  Call is_cxx_header only if\n\tnecessary.\n\n\t* fixinc/inclhack.def (avoid_bool): Add select for the problem and\n\tbypass for ncurses.\n\t(bsd43_io_macros, io_def_quotes, ioctl_fix_ctrl): Replace with...\n\t(io_def_quotes, io_use_quotes, ctrl_def_quotes, ctrl_use_quotes):\n\t... these, which use the new C fixes.\n\t(math_exception): Escape literal '+' in bypass expression.\n\n\t* fixinc/fixincl.x, fixinc/fixincl.sh, fixinc/inclhack.sh:\n\tRegenerate.\n\nFrom-SVN: r31512", "tree": {"sha": "071d4198056ed723a6710483d992b94bb6261350", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/071d4198056ed723a6710483d992b94bb6261350"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5c0d5b94d1952d982318d3fa4ae2b2bace4178ca", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5c0d5b94d1952d982318d3fa4ae2b2bace4178ca", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5c0d5b94d1952d982318d3fa4ae2b2bace4178ca", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5c0d5b94d1952d982318d3fa4ae2b2bace4178ca/comments", "author": null, "committer": null, "parents": [{"sha": "5170877a059f586a13fe0fea6bb466fddb1a0f28", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5170877a059f586a13fe0fea6bb466fddb1a0f28", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5170877a059f586a13fe0fea6bb466fddb1a0f28"}], "stats": {"total": 908, "additions": 560, "deletions": 348}, "files": [{"sha": "e5f81774a3af291dcd94db59eff60d0b1958b4fe", "filename": "gcc/ChangeLog", "status": "modified", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5c0d5b94d1952d982318d3fa4ae2b2bace4178ca/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5c0d5b94d1952d982318d3fa4ae2b2bace4178ca/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=5c0d5b94d1952d982318d3fa4ae2b2bace4178ca", "patch": "@@ -1,3 +1,25 @@\n+2000-01-19  Zack Weinberg  <zack@wolery.cumb.org>\n+\n+\t* fixinc/Makefile.in: Correct dependencies of fixincl and fixincl.o.\n+\t* fixinc/fixfixes.c (IO_use, CTRL_use, IO_defn, CTRL_defn): New fixes.\n+\t(fix_char_macro_defines, fix_char_macro_uses): New functions.\n+\n+\t* fixinc/fixlib.c (is_cxx_header): Do the text scan with a regexp.\n+\tRecognize Emacs mode markers also.\n+\t* fixinc/fixtests.c (else_endif_label): Fix bug in recognition of\n+\tC++ comments in C++ headers.  Call is_cxx_header only if\n+\tnecessary.\n+\n+\t* fixinc/inclhack.def (avoid_bool): Add select for the problem and\n+\tbypass for ncurses.\n+\t(bsd43_io_macros, io_def_quotes, ioctl_fix_ctrl): Replace with...\n+\t(io_def_quotes, io_use_quotes, ctrl_def_quotes, ctrl_use_quotes):\n+\t... these, which use the new C fixes.\n+\t(math_exception): Escape literal '+' in bypass expression.\n+\n+\t* fixinc/fixincl.x, fixinc/fixincl.sh, fixinc/inclhack.sh:\n+\tRegenerate.\n+\n 2000-01-19  Geoff Keating  <geoffk@cygnus.com>\n \n \t* rtlanal.c (reg_referenced_p): A CLOBBER of a MEM uses any REGs"}, {"sha": "a2448c13a951782cb0041892e525efae8e538549", "filename": "gcc/fixinc/Makefile.in", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5c0d5b94d1952d982318d3fa4ae2b2bace4178ca/gcc%2Ffixinc%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5c0d5b94d1952d982318d3fa4ae2b2bace4178ca/gcc%2Ffixinc%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffixinc%2FMakefile.in?ref=5c0d5b94d1952d982318d3fa4ae2b2bace4178ca", "patch": "@@ -76,7 +76,7 @@ gen : $(SH_TARGET) fixincl.x\n \n $(FIOBJ): $(HDR)\n \n-fixincl: $(FIOBJ) fixfixes fixtests\n+fixincl: $(FIOBJ)\n \t@echo $(CC) -o $@ $(FIOBJ) $(LIBERTY) $(LIB) ; \\\n \tif $(CC) -o $@ $(FIOBJ) $(LIBERTY) $(LIB) ; then : ; else \\\n \trm -f $@ ; (echo \"#! /bin/sh\" ; echo exit 1 ) > $@ ; \\\n@@ -94,7 +94,7 @@ gnu-regex.o: gnu-regex.c\n \t-$(CC) $(CFLAGS) $(FIXINC_DEFS) $(INCLUDES) -DREGEX_MALLOC \\\n \t\t-c $(srcdir)/gnu-regex.c\n \n-fixincl.o : fixincl.x fixincl.c\n+fixincl.o : fixincl.x fixincl.c fixfixes.c fixtests.c\n server.o : server.c server.h\n procopen.o : procopen.c server.h\n "}, {"sha": "33f5f193dbe50aafef0bfb5d727e4a3ba64614ed", "filename": "gcc/fixinc/fixfixes.c", "status": "modified", "additions": 195, "deletions": 1, "changes": 196, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5c0d5b94d1952d982318d3fa4ae2b2bace4178ca/gcc%2Ffixinc%2Ffixfixes.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5c0d5b94d1952d982318d3fa4ae2b2bace4178ca/gcc%2Ffixinc%2Ffixfixes.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffixinc%2Ffixfixes.c?ref=5c0d5b94d1952d982318d3fa4ae2b2bace4178ca", "patch": "@@ -73,7 +73,11 @@ typedef struct {\n \n #define FIXUP_TABLE \\\n   _FT_( \"no_double_slash\",  double_slash_fix ) \\\n-  _FT_( \"else_endif_label\", else_endif_label_fix )\n+  _FT_( \"else_endif_label\", else_endif_label_fix ) \\\n+  _FT_( \"IO_use\",\t    IO_use_fix ) \\\n+  _FT_( \"CTRL_use\",\t    CTRL_use_fix) \\\n+  _FT_( \"IO_defn\",\t    IO_defn_fix ) \\\n+  _FT_( \"CTRL_defn\",\t    CTRL_defn_fix )\n \n \n #define FIX_PROC_HEAD( fix ) \\\n@@ -354,6 +358,196 @@ FIX_PROC_HEAD( else_endif_label_fix )\n   return;\n }\n \n+/* Scan the input file for all occurrences of text like this:\n+\n+   #define TIOCCONS _IO(T, 12)\n+\n+   and change them to read like this:\n+\n+   #define TIOCCONS _IO('T', 12)\n+\n+   which is the required syntax per the C standard.  (The definition of\n+   _IO also has to be tweaked - see below.)  'IO' is actually whatever you\n+   provide in the STR argument.  */\n+void\n+fix_char_macro_uses (text, str)\n+     const char *text;\n+     const char *str;\n+{\n+  /* This regexp looks for a traditional-syntax #define (# in column 1)\n+     of an object-like macro.  */\n+  static const char pat[] =\n+    \"^#[ \\t]*define[ \\t]+[A-Za-z][A-Za-z0-9]*[ \\t]+\";\n+  static regex_t re;\n+\n+  regmatch_t rm[1];\n+  const char *p, *limit;\n+  size_t len = strlen (str);\n+\n+  compile_re (pat, &re, 1, \"macro pattern\", \"fix_char_macro_uses\");\n+\n+  for (p = text;\n+       regexec (&re, p, 1, rm, 0) == 0;\n+       p = limit + 1)\n+    {\n+      /* p + rm[0].rm_eo is the first character of the macro replacement.\n+\t Find the end of the macro replacement, and the STR we were\n+\t sent to look for within the replacement.  */\n+      p += rm[0].rm_eo;\n+      limit = p - 1;\n+      do\n+\t{\n+\t  limit = strchr (limit + 1, '\\n');\n+\t  if (!limit)\n+\t    goto done;\n+\t}\n+      while (limit[-1] == '\\\\');\n+\n+      do\n+\t{\n+\t  if (*p == str[0] && !strncmp (p+1, str+1, len-1))\n+\t    goto found;\n+\t}\n+      while (++p < limit - len);\n+      /* Hit end of line.  */\n+      continue;\n+\n+    found:\n+      /* Found STR on this line.  If the macro needs fixing,\n+\t the next few chars will be whitespace or uppercase,\n+\t then an open paren, then a single letter.  */\n+      while ((isspace (*p) || isupper (*p)) && p < limit) p++;\n+      if (*p++ != '(')\n+\tcontinue;\n+      if (!isalpha (*p))\n+\tcontinue;\n+      if (isalnum (p[1]) || p[1] == '_')\n+\tcontinue;\n+\n+      /* Splat all preceding text into the output buffer,\n+\t quote the character at p, then proceed.  */\n+      fwrite (text, 1, p - text, stdout);\n+      putchar ('\\'');\n+      putchar (*p);\n+      putchar ('\\'');\n+      text = p + 1;\n+    }\n+ done:\n+  fputs (text, stdout);\n+}\n+\n+/* Scan the input file for all occurrences of text like this:\n+\n+   #define _IO(x, y) ('x'<<16+y)\n+\n+   and change them to read like this:\n+\n+   #define _IO(x, y) (x<<16+y)\n+\n+   which is the required syntax per the C standard.  (The uses of _IO\n+   also have to be tweaked - see above.)  'IO' is actually whatever\n+   you provide in the STR argument.  */\n+void\n+fix_char_macro_defines (text, str)\n+     const char *text;\n+     const char *str;\n+{\n+  /* This regexp looks for any traditional-syntax #define (# in column 1).  */\n+  static const char pat[] =\n+    \"^#[ \\t]*define[ \\t]+\";\n+  static regex_t re;\n+\n+  regmatch_t rm[1];\n+  const char *p, *limit;\n+  size_t len = strlen (str);\n+  char arg;\n+\n+  compile_re (pat, &re, 1, \"macro pattern\", \"fix_char_macro_defines\");\n+\n+  for (p = text;\n+       regexec (&re, p, 1, rm, 0) == 0;\n+       p = limit + 1)\n+    {\n+      /* p + rm[0].rm_eo is the first character of the macro name.\n+\t Find the end of the macro replacement, and the STR we were\n+\t sent to look for within the name.  */\n+      p += rm[0].rm_eo;\n+      limit = p - 1;\n+      do\n+\t{\n+\t  limit = strchr (limit + 1, '\\n');\n+\t  if (!limit)\n+\t    goto done;\n+\t}\n+      while (limit[-1] == '\\\\');\n+\n+      do\n+\t{\n+\t  if (*p == str[0] && !strncmp (p+1, str+1, len-1))\n+\t    goto found;\n+\t}\n+      while (isalpha (*p) || isalnum (*p) || *p == '_');\n+      /* Hit end of macro name without finding the string.  */\n+      continue;\n+\n+    found:\n+      /* Found STR in this macro name.  If the macro needs fixing,\n+\t there may be a few uppercase letters, then there will be an\n+\t open paren with _no_ intervening whitespace, and then a\n+\t single letter.  */\n+      while (isupper (*p) && p < limit) p++;\n+      if (*p++ != '(')\n+\tcontinue;\n+      if (!isalpha (*p))\n+\tcontinue;\n+      if (isalnum (p[1]) || p[1] == '_')\n+\tcontinue;\n+\n+      /* The character at P is the one to look for in the following\n+\t text.  */\n+      arg = *p;\n+      p += 2;\n+\n+      while (p < limit)\n+\t{\n+\t  if (p[-1] == '\\'' && p[0] == arg && p[1] == '\\'')\n+\t    {\n+\t      /* Remove the quotes from this use of ARG.  */\n+\t      p--;\n+\t      fwrite (text, 1, p - text, stdout);\n+\t      putchar (arg);\n+\t      p += 3;\n+\t      text = p;\n+\t    }\n+\t  else\n+\t    p++;\n+\t}\n+    }\n+ done:\n+  fputs (text, stdout);\n+}\n+\n+/* The various prefixes on these macros are handled automatically\n+   because the fixers don't care where they start matching.  */\n+FIX_PROC_HEAD( IO_use_fix )\n+{\n+  fix_char_macro_uses (text, \"IO\");\n+}\n+FIX_PROC_HEAD( CTRL_use_fix )\n+{\n+  fix_char_macro_uses (text, \"CTRL\");\n+}\n+\n+FIX_PROC_HEAD( IO_defn_fix )\n+{\n+  fix_char_macro_defines (text, \"IO\");\n+}\n+FIX_PROC_HEAD( CTRL_defn_fix )\n+{\n+  fix_char_macro_defines (text, \"CTRL\");\n+}\n+\n+\n /* = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = =\n \n      test for fix selector"}, {"sha": "9a9bf9fa10e65434e2f081bfff697a6e00260bf4", "filename": "gcc/fixinc/fixincl.sh", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5c0d5b94d1952d982318d3fa4ae2b2bace4178ca/gcc%2Ffixinc%2Ffixincl.sh", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5c0d5b94d1952d982318d3fa4ae2b2bace4178ca/gcc%2Ffixinc%2Ffixincl.sh", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffixinc%2Ffixincl.sh?ref=5c0d5b94d1952d982318d3fa4ae2b2bace4178ca", "patch": "@@ -6,7 +6,7 @@\n # files which are fixed to work correctly with ANSI C and placed in a\n # directory that GNU C will search.\n #\n-# This script contains 112 fixup scripts.\n+# This script contains 113 fixup scripts.\n #\n # See README-fixinc for more information.\n #"}, {"sha": "64d73679d6375622dafbf8aa97410d5998e92fef", "filename": "gcc/fixinc/fixincl.x", "status": "modified", "additions": 197, "deletions": 157, "changes": 354, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5c0d5b94d1952d982318d3fa4ae2b2bace4178ca/gcc%2Ffixinc%2Ffixincl.x", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5c0d5b94d1952d982318d3fa4ae2b2bace4178ca/gcc%2Ffixinc%2Ffixincl.x", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffixinc%2Ffixincl.x?ref=5c0d5b94d1952d982318d3fa4ae2b2bace4178ca", "patch": "@@ -5,7 +5,7 @@\n  * files which are fixed to work correctly with ANSI C and placed in a\n  * directory that GNU C will search.\n  *\n- * This file contains 112 fixup descriptions.\n+ * This file contains 113 fixup descriptions.\n  *\n  * See README-fixinc for more information.\n  *\n@@ -1006,8 +1006,23 @@ tSCC zAvoid_BoolList[] =\n  *  Machine/OS name selection pattern\n  */\n #define apzAvoid_BoolMachs (const char**)NULL\n-#define AVOID_BOOL_TEST_CT  0\n-#define aAvoid_BoolTests   (tTestDesc*)NULL\n+\n+/*\n+ *  content selection pattern - do fix if pattern found\n+ */\n+tSCC zAvoid_BoolSelect0[] =\n+       \"char[ \\t]+bool|bool[ \\t]+char\";\n+\n+/*\n+ *  content bypass pattern - skip fix if pattern found\n+ */\n+tSCC zAvoid_BoolBypass0[] =\n+       \"we must use the C\\\\+\\\\+ compiler's type\";\n+\n+#define    AVOID_BOOL_TEST_CT  2\n+tTestDesc aAvoid_BoolTests[] = {\n+  { TT_NEGREP,   zAvoid_BoolBypass0, (regex_t*)NULL },\n+  { TT_EGREP,    zAvoid_BoolSelect0, (regex_t*)NULL }, };\n \n /*\n  *  Fix Command Arguments for Avoid_Bool\n@@ -1215,45 +1230,11 @@ const char* apzBroken_Assert_StdlibPatch[] = { \"sed\",\n #endif\\n\",\n     (char*)NULL };\n \n-/* * * * * * * * * * * * * * * * * * * * * * * * * *\n- *\n- *  Description of Bsd43_Io_Macros fix\n- */\n-#define BSD43_IO_MACROS_FIXIDX           27\n-tSCC zBsd43_Io_MacrosName[] =\n-     \"Bsd43_Io_Macros\";\n-/*\n- *  File name selection pattern\n- */\n-#define zBsd43_Io_MacrosList (char*)NULL\n-/*\n- *  Machine/OS name selection pattern\n- */\n-#define apzBsd43_Io_MacrosMachs (const char**)NULL\n-\n-/*\n- *  content selection pattern - do fix if pattern found\n- */\n-tSCC zBsd43_Io_MacrosSelect0[] =\n-       \"BSD43__IO\";\n-\n-#define    BSD43_IO_MACROS_TEST_CT  1\n-tTestDesc aBsd43_Io_MacrosTests[] = {\n-  { TT_EGREP,    zBsd43_Io_MacrosSelect0, (regex_t*)NULL }, };\n-\n-/*\n- *  Fix Command Arguments for Bsd43_Io_Macros\n- */\n-const char* apzBsd43_Io_MacrosPatch[] = { \"sed\",\n-    \"-e\", \"/[ \\t]BSD43__IO[A-Z]*[ \\t]*(/s/(\\\\(.\\\\),/('\\\\1',/\",\n-    \"-e\", \"/#[ \\t]*define[ \\t]*[ \\t]BSD43__IO/s/'\\\\([cgx]\\\\)'/\\\\1/g\",\n-    (char*)NULL };\n-\n /* * * * * * * * * * * * * * * * * * * * * * * * * *\n  *\n  *  Description of Dec_Intern_Asm fix\n  */\n-#define DEC_INTERN_ASM_FIXIDX            28\n+#define DEC_INTERN_ASM_FIXIDX            27\n tSCC zDec_Intern_AsmName[] =\n      \"Dec_Intern_Asm\";\n /*\n@@ -1282,7 +1263,7 @@ const char* apzDec_Intern_AsmPatch[] = { \"sed\",\n  *\n  *  Description of No_Double_Slash fix\n  */\n-#define NO_DOUBLE_SLASH_FIXIDX           29\n+#define NO_DOUBLE_SLASH_FIXIDX           28\n tSCC zNo_Double_SlashName[] =\n      \"No_Double_Slash\";\n /*\n@@ -1313,7 +1294,7 @@ const char* apzNo_Double_SlashPatch[] = {\"no_double_slash\",\n  *\n  *  Description of Ecd_Cursor fix\n  */\n-#define ECD_CURSOR_FIXIDX                30\n+#define ECD_CURSOR_FIXIDX                29\n tSCC zEcd_CursorName[] =\n      \"Ecd_Cursor\";\n /*\n@@ -1339,7 +1320,7 @@ const char* apzEcd_CursorPatch[] = { \"sed\",\n  *\n  *  Description of Sco5_Stat_Wrappers fix\n  */\n-#define SCO5_STAT_WRAPPERS_FIXIDX        31\n+#define SCO5_STAT_WRAPPERS_FIXIDX        30\n tSCC zSco5_Stat_WrappersName[] =\n      \"Sco5_Stat_Wrappers\";\n /*\n@@ -1375,7 +1356,7 @@ extern \\\"C\\\"\\\\\\n\\\n  *\n  *  Description of End_Else_Label fix\n  */\n-#define END_ELSE_LABEL_FIXIDX            32\n+#define END_ELSE_LABEL_FIXIDX            31\n tSCC zEnd_Else_LabelName[] =\n      \"End_Else_Label\";\n /*\n@@ -1406,7 +1387,7 @@ const char* apzEnd_Else_LabelPatch[] = {\"else_endif_label\",\n  *\n  *  Description of Hp_Inline fix\n  */\n-#define HP_INLINE_FIXIDX                 33\n+#define HP_INLINE_FIXIDX                 32\n tSCC zHp_InlineName[] =\n      \"Hp_Inline\";\n /*\n@@ -1441,7 +1422,7 @@ const char* apzHp_InlinePatch[] = { \"sed\",\n  *\n  *  Description of Hp_Sysfile fix\n  */\n-#define HP_SYSFILE_FIXIDX                34\n+#define HP_SYSFILE_FIXIDX                33\n tSCC zHp_SysfileName[] =\n      \"Hp_Sysfile\";\n /*\n@@ -1475,7 +1456,7 @@ const char* apzHp_SysfilePatch[] = { \"sed\",\n  *\n  *  Description of Cxx_Unready fix\n  */\n-#define CXX_UNREADY_FIXIDX               35\n+#define CXX_UNREADY_FIXIDX               34\n tSCC zCxx_UnreadyName[] =\n      \"Cxx_Unready\";\n /*\n@@ -1517,7 +1498,7 @@ extern \\\"C\\\" {\\\\\\n\\\n  *\n  *  Description of Hpux_Maxint fix\n  */\n-#define HPUX_MAXINT_FIXIDX               36\n+#define HPUX_MAXINT_FIXIDX               35\n tSCC zHpux_MaxintName[] =\n      \"Hpux_Maxint\";\n /*\n@@ -1546,7 +1527,7 @@ const char* apzHpux_MaxintPatch[] = { \"sed\",\n  *\n  *  Description of Hpux_Systime fix\n  */\n-#define HPUX_SYSTIME_FIXIDX              37\n+#define HPUX_SYSTIME_FIXIDX              36\n tSCC zHpux_SystimeName[] =\n      \"Hpux_Systime\";\n /*\n@@ -1580,7 +1561,7 @@ const char* apzHpux_SystimePatch[] = { \"sed\",\n  *\n  *  Description of Hpux8_Bogus_Inlines fix\n  */\n-#define HPUX8_BOGUS_INLINES_FIXIDX       38\n+#define HPUX8_BOGUS_INLINES_FIXIDX       37\n tSCC zHpux8_Bogus_InlinesName[] =\n      \"Hpux8_Bogus_Inlines\";\n /*\n@@ -1617,7 +1598,7 @@ const char* apzHpux8_Bogus_InlinesPatch[] = { \"sed\",\n  *\n  *  Description of Hpux11_Uint32_C fix\n  */\n-#define HPUX11_UINT32_C_FIXIDX           39\n+#define HPUX11_UINT32_C_FIXIDX           38\n tSCC zHpux11_Uint32_CName[] =\n      \"Hpux11_Uint32_C\";\n /*\n@@ -1651,7 +1632,7 @@ const char* apzHpux11_Uint32_CPatch[] = { \"sed\",\n  *\n  *  Description of Isc_Omits_With_Stdc fix\n  */\n-#define ISC_OMITS_WITH_STDC_FIXIDX       40\n+#define ISC_OMITS_WITH_STDC_FIXIDX       39\n tSCC zIsc_Omits_With_StdcName[] =\n      \"Isc_Omits_With_Stdc\";\n /*\n@@ -1681,6 +1662,38 @@ const char* apzIsc_Omits_With_StdcPatch[] = { \"sed\",\n     \"-e\", \"s/!defined(__STDC__) && !defined(_POSIX_SOURCE)/!defined(_POSIX_SOURCE)/\",\n     (char*)NULL };\n \n+/* * * * * * * * * * * * * * * * * * * * * * * * * *\n+ *\n+ *  Description of Io_Use_Quotes fix\n+ */\n+#define IO_USE_QUOTES_FIXIDX             40\n+tSCC zIo_Use_QuotesName[] =\n+     \"Io_Use_Quotes\";\n+/*\n+ *  File name selection pattern\n+ */\n+#define zIo_Use_QuotesList (char*)NULL\n+/*\n+ *  Machine/OS name selection pattern\n+ */\n+#define apzIo_Use_QuotesMachs (const char**)NULL\n+\n+/*\n+ *  content selection pattern - do fix if pattern found\n+ */\n+tSCC zIo_Use_QuotesSelect0[] =\n+       \"define[ \\t]+[A-Z0-9_]+[ \\t]+[A-Z0-9_]+IO[A-Z]*[ \\t]*\\\\( *[^,']\";\n+\n+#define    IO_USE_QUOTES_TEST_CT  1\n+tTestDesc aIo_Use_QuotesTests[] = {\n+  { TT_EGREP,    zIo_Use_QuotesSelect0, (regex_t*)NULL }, };\n+\n+/*\n+ *  Fix Command Arguments for Io_Use_Quotes\n+ */\n+const char* apzIo_Use_QuotesPatch[] = {\"IO_use\",\n+    (char*)NULL };\n+\n /* * * * * * * * * * * * * * * * * * * * * * * * * *\n  *\n  *  Description of Io_Def_Quotes fix\n@@ -1701,7 +1714,7 @@ tSCC zIo_Def_QuotesName[] =\n  *  content selection pattern - do fix if pattern found\n  */\n tSCC zIo_Def_QuotesSelect0[] =\n-       \"[ \\t]*[ \\t](_|DES)IO[A-Z]*[ \\t]*\\\\( *[^,']\";\n+       \"define[ \\t]+[A-Z0-9_]+IO[A-Z]*\\\\(([a-zA-Z]).*'\\\\1'\";\n \n #define    IO_DEF_QUOTES_TEST_CT  1\n tTestDesc aIo_Def_QuotesTests[] = {\n@@ -1710,56 +1723,78 @@ tTestDesc aIo_Def_QuotesTests[] = {\n /*\n  *  Fix Command Arguments for Io_Def_Quotes\n  */\n-const char* apzIo_Def_QuotesPatch[] = { \"sed\",\n-    \"-e\", \"s/\\\\([ \\t]*[ \\t]_IO[A-Z]*[ \\t]*(\\\\)\\\\([^,']\\\\),/\\\\1'\\\\2',/\",\n-    \"-e\", \"s/\\\\([ \\t]*[ \\t]DESIO[A-Z]*[ \\t]*(\\\\)\\\\([^,']\\\\),/\\\\1'\\\\2',/\",\n-    \"-e\", \"/#[ \\t]*define[ \\t]*[ \\t]_IO/s/'\\\\([cgxtf]\\\\)'/\\\\1/g\",\n-    \"-e\", \"/#[ \\t]*define[ \\t]*[ \\t]DESIOC/s/'\\\\([cdgx]\\\\)'/\\\\1/g\",\n+const char* apzIo_Def_QuotesPatch[] = {\"IO_defn\",\n+    (char*)NULL };\n+\n+/* * * * * * * * * * * * * * * * * * * * * * * * * *\n+ *\n+ *  Description of Ctrl_Use_Quotes fix\n+ */\n+#define CTRL_USE_QUOTES_FIXIDX           42\n+tSCC zCtrl_Use_QuotesName[] =\n+     \"Ctrl_Use_Quotes\";\n+/*\n+ *  File name selection pattern\n+ */\n+#define zCtrl_Use_QuotesList (char*)NULL\n+/*\n+ *  Machine/OS name selection pattern\n+ */\n+#define apzCtrl_Use_QuotesMachs (const char**)NULL\n+\n+/*\n+ *  content selection pattern - do fix if pattern found\n+ */\n+tSCC zCtrl_Use_QuotesSelect0[] =\n+       \"define[ \\t]+[A-Z0-9_]+[ \\t]+[A-Z0-9_]+CTRL[ \\t]*\\\\( *[^,']\";\n+\n+#define    CTRL_USE_QUOTES_TEST_CT  1\n+tTestDesc aCtrl_Use_QuotesTests[] = {\n+  { TT_EGREP,    zCtrl_Use_QuotesSelect0, (regex_t*)NULL }, };\n+\n+/*\n+ *  Fix Command Arguments for Ctrl_Use_Quotes\n+ */\n+const char* apzCtrl_Use_QuotesPatch[] = {\"CTRL_use\",\n     (char*)NULL };\n \n /* * * * * * * * * * * * * * * * * * * * * * * * * *\n  *\n- *  Description of Ioctl_Fix_Ctrl fix\n+ *  Description of Ctrl_Def_Quotes fix\n  */\n-#define IOCTL_FIX_CTRL_FIXIDX            42\n-tSCC zIoctl_Fix_CtrlName[] =\n-     \"Ioctl_Fix_Ctrl\";\n+#define CTRL_DEF_QUOTES_FIXIDX           43\n+tSCC zCtrl_Def_QuotesName[] =\n+     \"Ctrl_Def_Quotes\";\n /*\n  *  File name selection pattern\n  */\n-#define zIoctl_Fix_CtrlList (char*)NULL\n+#define zCtrl_Def_QuotesList (char*)NULL\n /*\n  *  Machine/OS name selection pattern\n  */\n-#define apzIoctl_Fix_CtrlMachs (const char**)NULL\n+#define apzCtrl_Def_QuotesMachs (const char**)NULL\n \n /*\n  *  content selection pattern - do fix if pattern found\n  */\n-tSCC zIoctl_Fix_CtrlSelect0[] =\n-       \"CTRL[ \\t]*\\\\(\";\n+tSCC zCtrl_Def_QuotesSelect0[] =\n+       \"define[ \\t]+[A-Z0-9_]+CTRL\\\\(([a-zA-Z]).*'\\\\1'\";\n \n-#define    IOCTL_FIX_CTRL_TEST_CT  1\n-tTestDesc aIoctl_Fix_CtrlTests[] = {\n-  { TT_EGREP,    zIoctl_Fix_CtrlSelect0, (regex_t*)NULL }, };\n+#define    CTRL_DEF_QUOTES_TEST_CT  1\n+tTestDesc aCtrl_Def_QuotesTests[] = {\n+  { TT_EGREP,    zCtrl_Def_QuotesSelect0, (regex_t*)NULL }, };\n \n /*\n- *  Fix Command Arguments for Ioctl_Fix_Ctrl\n+ *  Fix Command Arguments for Ctrl_Def_Quotes\n  */\n-const char* apzIoctl_Fix_CtrlPatch[] = { \"sed\",\n-    \"-e\", \"/[^A-Z0-9_]CTRL[ \\t]*(/s/\\\\([^']\\\\))/'\\\\1')/\",\n-    \"-e\", \"/[^A-Z0-9]_CTRL[ \\t]*(/s/\\\\([^']\\\\))/'\\\\1')/\",\n-    \"-e\", \"/#[ \\t]*define[ \\t]*[ \\t]CTRL/s/'\\\\([cgx]\\\\)'/\\\\1/g\",\n-    \"-e\", \"/#[ \\t]*define[ \\t]*[ \\t]_CTRL/s/'\\\\([cgx]\\\\)'/\\\\1/g\",\n-    \"-e\", \"/#[ \\t]*define[ \\t]*[ \\t]BSD43_CTRL/s/'\\\\([cgx]\\\\)'/\\\\1/g\",\n-    \"-e\", \"/#[ \\t]*define[ \\t]*[ \\t][_]*ISCTRL/s/'\\\\([cgx]\\\\)'/\\\\1/g\",\n+const char* apzCtrl_Def_QuotesPatch[] = {\"CTRL_defn\",\n     (char*)NULL };\n \n /* * * * * * * * * * * * * * * * * * * * * * * * * *\n  *\n  *  Description of Ip_Missing_Semi fix\n  */\n-#define IP_MISSING_SEMI_FIXIDX           43\n+#define IP_MISSING_SEMI_FIXIDX           44\n tSCC zIp_Missing_SemiName[] =\n      \"Ip_Missing_Semi\";\n /*\n@@ -1793,7 +1828,7 @@ const char* apzIp_Missing_SemiPatch[] = { \"sed\",\n  *\n  *  Description of Irix_Multiline_Cmnt fix\n  */\n-#define IRIX_MULTILINE_CMNT_FIXIDX       44\n+#define IRIX_MULTILINE_CMNT_FIXIDX       45\n tSCC zIrix_Multiline_CmntName[] =\n      \"Irix_Multiline_Cmnt\";\n /*\n@@ -1820,7 +1855,7 @@ const char* apzIrix_Multiline_CmntPatch[] = { \"sed\",\n  *\n  *  Description of Irix_Sockaddr fix\n  */\n-#define IRIX_SOCKADDR_FIXIDX             45\n+#define IRIX_SOCKADDR_FIXIDX             46\n tSCC zIrix_SockaddrName[] =\n      \"Irix_Sockaddr\";\n /*\n@@ -1855,7 +1890,7 @@ struct sockaddr;\\n\",\n  *\n  *  Description of Irix_Struct__File fix\n  */\n-#define IRIX_STRUCT__FILE_FIXIDX         46\n+#define IRIX_STRUCT__FILE_FIXIDX         47\n tSCC zIrix_Struct__FileName[] =\n      \"Irix_Struct__File\";\n /*\n@@ -1882,7 +1917,7 @@ struct __file_s;\\n\",\n  *\n  *  Description of Irix_Asm_Apostrophe fix\n  */\n-#define IRIX_ASM_APOSTROPHE_FIXIDX       47\n+#define IRIX_ASM_APOSTROPHE_FIXIDX       48\n tSCC zIrix_Asm_ApostropheName[] =\n      \"Irix_Asm_Apostrophe\";\n /*\n@@ -1916,7 +1951,7 @@ const char* apzIrix_Asm_ApostrophePatch[] = { \"sed\",\n  *\n  *  Description of Isc_Fmod fix\n  */\n-#define ISC_FMOD_FIXIDX                  48\n+#define ISC_FMOD_FIXIDX                  49\n tSCC zIsc_FmodName[] =\n      \"Isc_Fmod\";\n /*\n@@ -1950,7 +1985,7 @@ const char* apzIsc_FmodPatch[] = { \"sed\",\n  *\n  *  Description of Motorola_Nested fix\n  */\n-#define MOTOROLA_NESTED_FIXIDX           49\n+#define MOTOROLA_NESTED_FIXIDX           50\n tSCC zMotorola_NestedName[] =\n      \"Motorola_Nested\";\n /*\n@@ -1979,7 +2014,7 @@ const char* apzMotorola_NestedPatch[] = { \"sed\",\n  *\n  *  Description of Isc_Sys_Limits fix\n  */\n-#define ISC_SYS_LIMITS_FIXIDX            50\n+#define ISC_SYS_LIMITS_FIXIDX            51\n tSCC zIsc_Sys_LimitsName[] =\n      \"Isc_Sys_Limits\";\n /*\n@@ -2014,7 +2049,7 @@ const char* apzIsc_Sys_LimitsPatch[] = { \"sed\",\n  *\n  *  Description of Kandr_Concat fix\n  */\n-#define KANDR_CONCAT_FIXIDX              51\n+#define KANDR_CONCAT_FIXIDX              52\n tSCC zKandr_ConcatName[] =\n      \"Kandr_Concat\";\n /*\n@@ -2048,7 +2083,7 @@ const char* apzKandr_ConcatPatch[] = { \"sed\",\n  *\n  *  Description of Limits_Ifndefs fix\n  */\n-#define LIMITS_IFNDEFS_FIXIDX            52\n+#define LIMITS_IFNDEFS_FIXIDX            53\n tSCC zLimits_IfndefsName[] =\n      \"Limits_Ifndefs\";\n /*\n@@ -2106,7 +2141,7 @@ const char* apzLimits_IfndefsPatch[] = { \"sed\",\n  *\n  *  Description of Lynx_Void_Int fix\n  */\n-#define LYNX_VOID_INT_FIXIDX             53\n+#define LYNX_VOID_INT_FIXIDX             54\n tSCC zLynx_Void_IntName[] =\n      \"Lynx_Void_Int\";\n /*\n@@ -2140,7 +2175,7 @@ const char* apzLynx_Void_IntPatch[] = { \"sed\",\n  *\n  *  Description of Lynxos_Fcntl_Proto fix\n  */\n-#define LYNXOS_FCNTL_PROTO_FIXIDX        54\n+#define LYNXOS_FCNTL_PROTO_FIXIDX        55\n tSCC zLynxos_Fcntl_ProtoName[] =\n      \"Lynxos_Fcntl_Proto\";\n /*\n@@ -2174,7 +2209,7 @@ const char* apzLynxos_Fcntl_ProtoPatch[] = { \"sed\",\n  *\n  *  Description of M88k_Bad_Hypot_Opt fix\n  */\n-#define M88K_BAD_HYPOT_OPT_FIXIDX        55\n+#define M88K_BAD_HYPOT_OPT_FIXIDX        56\n tSCC zM88k_Bad_Hypot_OptName[] =\n      \"M88k_Bad_Hypot_Opt\";\n /*\n@@ -2215,7 +2250,7 @@ static __inline__ double fake_hypot (x, y)\\\\\\n\\\n  *\n  *  Description of M88k_Bad_S_If fix\n  */\n-#define M88K_BAD_S_IF_FIXIDX             56\n+#define M88K_BAD_S_IF_FIXIDX             57\n tSCC zM88k_Bad_S_IfName[] =\n      \"M88k_Bad_S_If\";\n /*\n@@ -2252,7 +2287,7 @@ const char* apzM88k_Bad_S_IfPatch[] = { \"sed\",\n  *\n  *  Description of M88k_Multi_Incl fix\n  */\n-#define M88K_MULTI_INCL_FIXIDX           57\n+#define M88K_MULTI_INCL_FIXIDX           58\n tSCC zM88k_Multi_InclName[] =\n      \"M88k_Multi_Incl\";\n /*\n@@ -2293,7 +2328,7 @@ const char* apzM88k_Multi_InclPatch[] = { \"sh\", \"-c\",\n  *\n  *  Description of Machine_Name fix\n  */\n-#define MACHINE_NAME_FIXIDX              58\n+#define MACHINE_NAME_FIXIDX              59\n tSCC zMachine_NameName[] =\n      \"Machine_Name\";\n /*\n@@ -2362,7 +2397,7 @@ s/\\\\\\\\+++fixinc_eol+++/\\\\\\\\/g\\n\\\n  *\n  *  Description of Math_Exception fix\n  */\n-#define MATH_EXCEPTION_FIXIDX            59\n+#define MATH_EXCEPTION_FIXIDX            60\n tSCC zMath_ExceptionName[] =\n      \"Math_Exception\";\n /*\n@@ -2385,7 +2420,7 @@ tSCC zMath_ExceptionSelect0[] =\n  *  content bypass pattern - skip fix if pattern found\n  */\n tSCC zMath_ExceptionBypass0[] =\n-       \"We have a problem when using C++\";\n+       \"We have a problem when using C\\\\+\\\\+\";\n \n #define    MATH_EXCEPTION_TEST_CT  2\n tTestDesc aMath_ExceptionTests[] = {\n@@ -2410,7 +2445,7 @@ const char* apzMath_ExceptionPatch[] = { \"sed\",\n  *\n  *  Description of Math_Huge_Val_From_Dbl_Max fix\n  */\n-#define MATH_HUGE_VAL_FROM_DBL_MAX_FIXIDX 60\n+#define MATH_HUGE_VAL_FROM_DBL_MAX_FIXIDX 61\n tSCC zMath_Huge_Val_From_Dbl_MaxName[] =\n      \"Math_Huge_Val_From_Dbl_Max\";\n /*\n@@ -2456,7 +2491,7 @@ const char* apzMath_Huge_Val_From_Dbl_MaxPatch[] = { \"sh\", \"-c\",\n  *\n  *  Description of Math_Huge_Val_Ifndef fix\n  */\n-#define MATH_HUGE_VAL_IFNDEF_FIXIDX      61\n+#define MATH_HUGE_VAL_IFNDEF_FIXIDX      62\n tSCC zMath_Huge_Val_IfndefName[] =\n      \"Math_Huge_Val_Ifndef\";\n /*\n@@ -2493,7 +2528,7 @@ const char* apzMath_Huge_Val_IfndefPatch[] = { \"sed\",\n  *\n  *  Description of Nested_Comment fix\n  */\n-#define NESTED_COMMENT_FIXIDX            62\n+#define NESTED_COMMENT_FIXIDX            63\n tSCC zNested_CommentName[] =\n      \"Nested_Comment\";\n /*\n@@ -2519,7 +2554,7 @@ const char* apzNested_CommentPatch[] = { \"sed\",\n  *\n  *  Description of News_Os_Recursion fix\n  */\n-#define NEWS_OS_RECURSION_FIXIDX         63\n+#define NEWS_OS_RECURSION_FIXIDX         64\n tSCC zNews_Os_RecursionName[] =\n      \"News_Os_Recursion\";\n /*\n@@ -2556,7 +2591,7 @@ const char* apzNews_Os_RecursionPatch[] = { \"sed\",\n  *\n  *  Description of Next_Math_Prefix fix\n  */\n-#define NEXT_MATH_PREFIX_FIXIDX          64\n+#define NEXT_MATH_PREFIX_FIXIDX          65\n tSCC zNext_Math_PrefixName[] =\n      \"Next_Math_Prefix\";\n /*\n@@ -2594,7 +2629,7 @@ const char* apzNext_Math_PrefixPatch[] = { \"sed\",\n  *\n  *  Description of Next_Template fix\n  */\n-#define NEXT_TEMPLATE_FIXIDX             65\n+#define NEXT_TEMPLATE_FIXIDX             66\n tSCC zNext_TemplateName[] =\n      \"Next_Template\";\n /*\n@@ -2629,7 +2664,7 @@ const char* apzNext_TemplatePatch[] = { \"sed\",\n  *\n  *  Description of Next_Volitile fix\n  */\n-#define NEXT_VOLITILE_FIXIDX             66\n+#define NEXT_VOLITILE_FIXIDX             67\n tSCC zNext_VolitileName[] =\n      \"Next_Volitile\";\n /*\n@@ -2664,7 +2699,7 @@ const char* apzNext_VolitilePatch[] = { \"sed\",\n  *\n  *  Description of Next_Wait_Union fix\n  */\n-#define NEXT_WAIT_UNION_FIXIDX           67\n+#define NEXT_WAIT_UNION_FIXIDX           68\n tSCC zNext_Wait_UnionName[] =\n      \"Next_Wait_Union\";\n /*\n@@ -2698,7 +2733,7 @@ const char* apzNext_Wait_UnionPatch[] = { \"sed\",\n  *\n  *  Description of Nodeent_Syntax fix\n  */\n-#define NODEENT_SYNTAX_FIXIDX            68\n+#define NODEENT_SYNTAX_FIXIDX            69\n tSCC zNodeent_SyntaxName[] =\n      \"Nodeent_Syntax\";\n /*\n@@ -2724,7 +2759,7 @@ const char* apzNodeent_SyntaxPatch[] = { \"sed\",\n  *\n  *  Description of Osf_Namespace_A fix\n  */\n-#define OSF_NAMESPACE_A_FIXIDX           69\n+#define OSF_NAMESPACE_A_FIXIDX           70\n tSCC zOsf_Namespace_AName[] =\n      \"Osf_Namespace_A\";\n /*\n@@ -2769,7 +2804,7 @@ const char* apzOsf_Namespace_APatch[] = { \"sed\",\n  *\n  *  Description of Osf_Namespace_B fix\n  */\n-#define OSF_NAMESPACE_B_FIXIDX           70\n+#define OSF_NAMESPACE_B_FIXIDX           71\n tSCC zOsf_Namespace_BName[] =\n      \"Osf_Namespace_B\";\n /*\n@@ -2815,7 +2850,7 @@ typedef __regmatch_t\\tregmatch_t;\\n\",\n  *\n  *  Description of Pthread_Page_Size fix\n  */\n-#define PTHREAD_PAGE_SIZE_FIXIDX         71\n+#define PTHREAD_PAGE_SIZE_FIXIDX         72\n tSCC zPthread_Page_SizeName[] =\n      \"Pthread_Page_Size\";\n /*\n@@ -2849,7 +2884,7 @@ const char* apzPthread_Page_SizePatch[] = { \"sed\",\n  *\n  *  Description of Read_Ret_Type fix\n  */\n-#define READ_RET_TYPE_FIXIDX             72\n+#define READ_RET_TYPE_FIXIDX             73\n tSCC zRead_Ret_TypeName[] =\n      \"Read_Ret_Type\";\n /*\n@@ -2884,7 +2919,7 @@ const char* apzRead_Ret_TypePatch[] = { \"sed\",\n  *\n  *  Description of Rs6000_Double fix\n  */\n-#define RS6000_DOUBLE_FIXIDX             73\n+#define RS6000_DOUBLE_FIXIDX             74\n tSCC zRs6000_DoubleName[] =\n      \"Rs6000_Double\";\n /*\n@@ -2921,7 +2956,7 @@ const char* apzRs6000_DoublePatch[] = { \"sed\",\n  *\n  *  Description of Rs6000_Fchmod fix\n  */\n-#define RS6000_FCHMOD_FIXIDX             74\n+#define RS6000_FCHMOD_FIXIDX             75\n tSCC zRs6000_FchmodName[] =\n      \"Rs6000_Fchmod\";\n /*\n@@ -2955,7 +2990,7 @@ const char* apzRs6000_FchmodPatch[] = { \"sed\",\n  *\n  *  Description of Rs6000_Param fix\n  */\n-#define RS6000_PARAM_FIXIDX              75\n+#define RS6000_PARAM_FIXIDX              76\n tSCC zRs6000_ParamName[] =\n      \"Rs6000_Param\";\n /*\n@@ -2989,7 +3024,7 @@ const char* apzRs6000_ParamPatch[] = { \"sed\",\n  *\n  *  Description of Sony_Include fix\n  */\n-#define SONY_INCLUDE_FIXIDX              76\n+#define SONY_INCLUDE_FIXIDX              77\n tSCC zSony_IncludeName[] =\n      \"Sony_Include\";\n /*\n@@ -3023,7 +3058,7 @@ const char* apzSony_IncludePatch[] = { \"sed\",\n  *\n  *  Description of Statsswtch fix\n  */\n-#define STATSSWTCH_FIXIDX                77\n+#define STATSSWTCH_FIXIDX                78\n tSCC zStatsswtchName[] =\n      \"Statsswtch\";\n /*\n@@ -3057,7 +3092,7 @@ const char* apzStatsswtchPatch[] = { \"sed\",\n  *\n  *  Description of Stdio_Va_List fix\n  */\n-#define STDIO_VA_LIST_FIXIDX             78\n+#define STDIO_VA_LIST_FIXIDX             79\n tSCC zStdio_Va_ListName[] =\n      \"Stdio_Va_List\";\n /*\n@@ -3108,7 +3143,7 @@ const char* apzStdio_Va_ListPatch[] = { \"sh\", \"-c\",\n  *\n  *  Description of Sun_Bogus_Ifdef fix\n  */\n-#define SUN_BOGUS_IFDEF_FIXIDX           79\n+#define SUN_BOGUS_IFDEF_FIXIDX           80\n tSCC zSun_Bogus_IfdefName[] =\n      \"Sun_Bogus_Ifdef\";\n /*\n@@ -3142,7 +3177,7 @@ const char* apzSun_Bogus_IfdefPatch[] = { \"sed\",\n  *\n  *  Description of Sun_Bogus_Ifdef_Sun4c fix\n  */\n-#define SUN_BOGUS_IFDEF_SUN4C_FIXIDX     80\n+#define SUN_BOGUS_IFDEF_SUN4C_FIXIDX     81\n tSCC zSun_Bogus_Ifdef_Sun4cName[] =\n      \"Sun_Bogus_Ifdef_Sun4c\";\n /*\n@@ -3176,7 +3211,7 @@ const char* apzSun_Bogus_Ifdef_Sun4cPatch[] = { \"sed\",\n  *\n  *  Description of Sun_Catmacro fix\n  */\n-#define SUN_CATMACRO_FIXIDX              81\n+#define SUN_CATMACRO_FIXIDX              82\n tSCC zSun_CatmacroName[] =\n      \"Sun_Catmacro\";\n /*\n@@ -3215,7 +3250,7 @@ const char* apzSun_CatmacroPatch[] = { \"sed\",\n  *\n  *  Description of Sun_Malloc fix\n  */\n-#define SUN_MALLOC_FIXIDX                82\n+#define SUN_MALLOC_FIXIDX                83\n tSCC zSun_MallocName[] =\n      \"Sun_Malloc\";\n /*\n@@ -3244,7 +3279,7 @@ const char* apzSun_MallocPatch[] = { \"sed\",\n  *\n  *  Description of Sun_Rusers_Semi fix\n  */\n-#define SUN_RUSERS_SEMI_FIXIDX           83\n+#define SUN_RUSERS_SEMI_FIXIDX           84\n tSCC zSun_Rusers_SemiName[] =\n      \"Sun_Rusers_Semi\";\n /*\n@@ -3278,7 +3313,7 @@ const char* apzSun_Rusers_SemiPatch[] = { \"sed\",\n  *\n  *  Description of Sun_Signal fix\n  */\n-#define SUN_SIGNAL_FIXIDX                84\n+#define SUN_SIGNAL_FIXIDX                85\n tSCC zSun_SignalName[] =\n      \"Sun_Signal\";\n /*\n@@ -3317,7 +3352,7 @@ void\\t(*signal(...))(...);\\\\\\n\\\n  *\n  *  Description of Sun_Auth_Proto fix\n  */\n-#define SUN_AUTH_PROTO_FIXIDX            85\n+#define SUN_AUTH_PROTO_FIXIDX            86\n tSCC zSun_Auth_ProtoName[] =\n      \"Sun_Auth_Proto\";\n /*\n@@ -3356,7 +3391,7 @@ const char* apzSun_Auth_ProtoPatch[] = { \"sed\",\n  *\n  *  Description of Sunos_Matherr_Decl fix\n  */\n-#define SUNOS_MATHERR_DECL_FIXIDX        86\n+#define SUNOS_MATHERR_DECL_FIXIDX        87\n tSCC zSunos_Matherr_DeclName[] =\n      \"Sunos_Matherr_Decl\";\n /*\n@@ -3392,7 +3427,7 @@ struct exception;\\n\",\n  *\n  *  Description of Sunos_Strlen fix\n  */\n-#define SUNOS_STRLEN_FIXIDX              87\n+#define SUNOS_STRLEN_FIXIDX              88\n tSCC zSunos_StrlenName[] =\n      \"Sunos_Strlen\";\n /*\n@@ -3426,7 +3461,7 @@ const char* apzSunos_StrlenPatch[] = { \"sed\",\n  *\n  *  Description of Systypes fix\n  */\n-#define SYSTYPES_FIXIDX                  88\n+#define SYSTYPES_FIXIDX                  89\n tSCC zSystypesName[] =\n      \"Systypes\";\n /*\n@@ -3484,7 +3519,7 @@ typedef __SIZE_TYPE__ size_t;\\\\\\n\\\n  *\n  *  Description of Systypes_For_Aix fix\n  */\n-#define SYSTYPES_FOR_AIX_FIXIDX          89\n+#define SYSTYPES_FOR_AIX_FIXIDX          90\n tSCC zSystypes_For_AixName[] =\n      \"Systypes_For_Aix\";\n /*\n@@ -3529,7 +3564,7 @@ const char* apzSystypes_For_AixPatch[] = { \"sed\",\n  *\n  *  Description of Sysv68_String fix\n  */\n-#define SYSV68_STRING_FIXIDX             90\n+#define SYSV68_STRING_FIXIDX             91\n tSCC zSysv68_StringName[] =\n      \"Sysv68_String\";\n /*\n@@ -3565,7 +3600,7 @@ extern unsigned int\\\\\\n\\\n  *\n  *  Description of Sysz_Stdlib_For_Sun fix\n  */\n-#define SYSZ_STDLIB_FOR_SUN_FIXIDX       91\n+#define SYSZ_STDLIB_FOR_SUN_FIXIDX       92\n tSCC zSysz_Stdlib_For_SunName[] =\n      \"Sysz_Stdlib_For_Sun\";\n /*\n@@ -3602,7 +3637,7 @@ const char* apzSysz_Stdlib_For_SunPatch[] = { \"sed\",\n  *\n  *  Description of Sysz_Stdtypes_For_Sun fix\n  */\n-#define SYSZ_STDTYPES_FOR_SUN_FIXIDX     92\n+#define SYSZ_STDTYPES_FOR_SUN_FIXIDX     93\n tSCC zSysz_Stdtypes_For_SunName[] =\n      \"Sysz_Stdtypes_For_Sun\";\n /*\n@@ -3642,7 +3677,7 @@ const char* apzSysz_Stdtypes_For_SunPatch[] = { \"sed\",\n  *\n  *  Description of Tinfo_Cplusplus fix\n  */\n-#define TINFO_CPLUSPLUS_FIXIDX           93\n+#define TINFO_CPLUSPLUS_FIXIDX           94\n tSCC zTinfo_CplusplusName[] =\n      \"Tinfo_Cplusplus\";\n /*\n@@ -3676,7 +3711,7 @@ const char* apzTinfo_CplusplusPatch[] = { \"sed\",\n  *\n  *  Description of Ultrix_Fix_Fixproto fix\n  */\n-#define ULTRIX_FIX_FIXPROTO_FIXIDX       94\n+#define ULTRIX_FIX_FIXPROTO_FIXIDX       95\n tSCC zUltrix_Fix_FixprotoName[] =\n      \"Ultrix_Fix_Fixproto\";\n /*\n@@ -3711,7 +3746,7 @@ struct utsname;\\n\",\n  *\n  *  Description of Ultrix_Atof_Param fix\n  */\n-#define ULTRIX_ATOF_PARAM_FIXIDX         95\n+#define ULTRIX_ATOF_PARAM_FIXIDX         96\n tSCC zUltrix_Atof_ParamName[] =\n      \"Ultrix_Atof_Param\";\n /*\n@@ -3745,7 +3780,7 @@ const char* apzUltrix_Atof_ParamPatch[] = { \"sed\",\n  *\n  *  Description of Ultrix_Const fix\n  */\n-#define ULTRIX_CONST_FIXIDX              96\n+#define ULTRIX_CONST_FIXIDX              97\n tSCC zUltrix_ConstName[] =\n      \"Ultrix_Const\";\n /*\n@@ -3779,7 +3814,7 @@ const char* apzUltrix_ConstPatch[] = { \"sed\",\n  *\n  *  Description of Ultrix_Ifdef fix\n  */\n-#define ULTRIX_IFDEF_FIXIDX              97\n+#define ULTRIX_IFDEF_FIXIDX              98\n tSCC zUltrix_IfdefName[] =\n      \"Ultrix_Ifdef\";\n /*\n@@ -3813,7 +3848,7 @@ const char* apzUltrix_IfdefPatch[] = { \"sed\",\n  *\n  *  Description of Ultrix_Nested_Cmnt fix\n  */\n-#define ULTRIX_NESTED_CMNT_FIXIDX        98\n+#define ULTRIX_NESTED_CMNT_FIXIDX        99\n tSCC zUltrix_Nested_CmntName[] =\n      \"Ultrix_Nested_Cmnt\";\n /*\n@@ -3839,7 +3874,7 @@ const char* apzUltrix_Nested_CmntPatch[] = { \"sed\",\n  *\n  *  Description of Ultrix_Static fix\n  */\n-#define ULTRIX_STATIC_FIXIDX             99\n+#define ULTRIX_STATIC_FIXIDX             100\n tSCC zUltrix_StaticName[] =\n      \"Ultrix_Static\";\n /*\n@@ -3875,7 +3910,7 @@ const char* apzUltrix_StaticPatch[] = { \"sed\",\n  *\n  *  Description of Undefine_Null fix\n  */\n-#define UNDEFINE_NULL_FIXIDX             100\n+#define UNDEFINE_NULL_FIXIDX             101\n tSCC zUndefine_NullName[] =\n      \"Undefine_Null\";\n /*\n@@ -3916,7 +3951,7 @@ const char* apzUndefine_NullPatch[] = { \"sed\",\n  *\n  *  Description of Unixware7_Byteorder_Fix fix\n  */\n-#define UNIXWARE7_BYTEORDER_FIX_FIXIDX   101\n+#define UNIXWARE7_BYTEORDER_FIX_FIXIDX   102\n tSCC zUnixware7_Byteorder_FixName[] =\n      \"Unixware7_Byteorder_Fix\";\n /*\n@@ -3958,7 +3993,7 @@ const char* apzUnixware7_Byteorder_FixPatch[] = { \"sed\",\n  *\n  *  Description of Va_I960_Macro fix\n  */\n-#define VA_I960_MACRO_FIXIDX             102\n+#define VA_I960_MACRO_FIXIDX             103\n tSCC zVa_I960_MacroName[] =\n      \"Va_I960_Macro\";\n /*\n@@ -3995,7 +4030,7 @@ const char* apzVa_I960_MacroPatch[] = { \"sed\",\n  *\n  *  Description of Void_Null fix\n  */\n-#define VOID_NULL_FIXIDX                 103\n+#define VOID_NULL_FIXIDX                 104\n tSCC zVoid_NullName[] =\n      \"Void_Null\";\n /*\n@@ -4029,7 +4064,7 @@ const char* apzVoid_NullPatch[] = { \"sed\",\n  *\n  *  Description of Vxworks_Gcc_Problem fix\n  */\n-#define VXWORKS_GCC_PROBLEM_FIXIDX       104\n+#define VXWORKS_GCC_PROBLEM_FIXIDX       105\n tSCC zVxworks_Gcc_ProblemName[] =\n      \"Vxworks_Gcc_Problem\";\n /*\n@@ -4078,7 +4113,7 @@ const char* apzVxworks_Gcc_ProblemPatch[] = { \"sed\",\n  *\n  *  Description of Vxworks_Needs_Vxtypes fix\n  */\n-#define VXWORKS_NEEDS_VXTYPES_FIXIDX     105\n+#define VXWORKS_NEEDS_VXTYPES_FIXIDX     106\n tSCC zVxworks_Needs_VxtypesName[] =\n      \"Vxworks_Needs_Vxtypes\";\n /*\n@@ -4112,7 +4147,7 @@ const char* apzVxworks_Needs_VxtypesPatch[] = { \"sed\",\n  *\n  *  Description of Vxworks_Needs_Vxworks fix\n  */\n-#define VXWORKS_NEEDS_VXWORKS_FIXIDX     106\n+#define VXWORKS_NEEDS_VXWORKS_FIXIDX     107\n tSCC zVxworks_Needs_VxworksName[] =\n      \"Vxworks_Needs_Vxworks\";\n /*\n@@ -4160,7 +4195,7 @@ const char* apzVxworks_Needs_VxworksPatch[] = { \"sed\",\n  *\n  *  Description of Vxworks_Time fix\n  */\n-#define VXWORKS_TIME_FIXIDX              107\n+#define VXWORKS_TIME_FIXIDX              108\n tSCC zVxworks_TimeName[] =\n      \"Vxworks_Time\";\n /*\n@@ -4210,7 +4245,7 @@ typedef void (*__gcc_VOIDFUNCPTR) ();\\\\\\n\\\n  *\n  *  Description of X11_Class fix\n  */\n-#define X11_CLASS_FIXIDX                 108\n+#define X11_CLASS_FIXIDX                 109\n tSCC zX11_ClassName[] =\n      \"X11_Class\";\n /*\n@@ -4249,7 +4284,7 @@ const char* apzX11_ClassPatch[] = { \"sed\",\n  *\n  *  Description of X11_Class_Usage fix\n  */\n-#define X11_CLASS_USAGE_FIXIDX           109\n+#define X11_CLASS_USAGE_FIXIDX           110\n tSCC zX11_Class_UsageName[] =\n      \"X11_Class_Usage\";\n /*\n@@ -4283,7 +4318,7 @@ const char* apzX11_Class_UsagePatch[] = { \"sed\",\n  *\n  *  Description of X11_New fix\n  */\n-#define X11_NEW_FIXIDX                   110\n+#define X11_NEW_FIXIDX                   111\n tSCC zX11_NewName[] =\n      \"X11_New\";\n /*\n@@ -4323,7 +4358,7 @@ const char* apzX11_NewPatch[] = { \"sed\",\n  *\n  *  Description of X11_Sprintf fix\n  */\n-#define X11_SPRINTF_FIXIDX               111\n+#define X11_SPRINTF_FIXIDX               112\n tSCC zX11_SprintfName[] =\n      \"X11_Sprintf\";\n /*\n@@ -4359,9 +4394,9 @@ extern char *\\tsprintf();\\\\\\n\\\n  *\n  *  List of all fixes\n  */\n-#define REGEX_COUNT          105\n+#define REGEX_COUNT          108\n #define MACH_LIST_SIZE_LIMIT 279\n-#define FIX_COUNT            112\n+#define FIX_COUNT            113\n \n tFixDesc fixDescList[ FIX_COUNT ] = {\n   {  zAaa_Ki_IfaceName,    zAaa_Ki_IfaceList,\n@@ -4499,11 +4534,6 @@ tFixDesc fixDescList[ FIX_COUNT ] = {\n      BROKEN_ASSERT_STDLIB_TEST_CT, FD_MACH_ONLY,\n      aBroken_Assert_StdlibTests,   apzBroken_Assert_StdlibPatch },\n \n-  {  zBsd43_Io_MacrosName,    zBsd43_Io_MacrosList,\n-     apzBsd43_Io_MacrosMachs, (regex_t*)NULL,\n-     BSD43_IO_MACROS_TEST_CT, FD_MACH_ONLY,\n-     aBsd43_Io_MacrosTests,   apzBsd43_Io_MacrosPatch },\n-\n   {  zDec_Intern_AsmName,    zDec_Intern_AsmList,\n      apzDec_Intern_AsmMachs, (regex_t*)NULL,\n      DEC_INTERN_ASM_TEST_CT, FD_MACH_ONLY,\n@@ -4569,15 +4599,25 @@ tFixDesc fixDescList[ FIX_COUNT ] = {\n      ISC_OMITS_WITH_STDC_TEST_CT, FD_MACH_ONLY,\n      aIsc_Omits_With_StdcTests,   apzIsc_Omits_With_StdcPatch },\n \n+  {  zIo_Use_QuotesName,    zIo_Use_QuotesList,\n+     apzIo_Use_QuotesMachs, (regex_t*)NULL,\n+     IO_USE_QUOTES_TEST_CT, FD_MACH_ONLY | FD_SUBROUTINE,\n+     aIo_Use_QuotesTests,   apzIo_Use_QuotesPatch },\n+\n   {  zIo_Def_QuotesName,    zIo_Def_QuotesList,\n      apzIo_Def_QuotesMachs, (regex_t*)NULL,\n-     IO_DEF_QUOTES_TEST_CT, FD_MACH_ONLY,\n+     IO_DEF_QUOTES_TEST_CT, FD_MACH_ONLY | FD_SUBROUTINE,\n      aIo_Def_QuotesTests,   apzIo_Def_QuotesPatch },\n \n-  {  zIoctl_Fix_CtrlName,    zIoctl_Fix_CtrlList,\n-     apzIoctl_Fix_CtrlMachs, (regex_t*)NULL,\n-     IOCTL_FIX_CTRL_TEST_CT, FD_MACH_ONLY,\n-     aIoctl_Fix_CtrlTests,   apzIoctl_Fix_CtrlPatch },\n+  {  zCtrl_Use_QuotesName,    zCtrl_Use_QuotesList,\n+     apzCtrl_Use_QuotesMachs, (regex_t*)NULL,\n+     CTRL_USE_QUOTES_TEST_CT, FD_MACH_ONLY | FD_SUBROUTINE,\n+     aCtrl_Use_QuotesTests,   apzCtrl_Use_QuotesPatch },\n+\n+  {  zCtrl_Def_QuotesName,    zCtrl_Def_QuotesList,\n+     apzCtrl_Def_QuotesMachs, (regex_t*)NULL,\n+     CTRL_DEF_QUOTES_TEST_CT, FD_MACH_ONLY | FD_SUBROUTINE,\n+     aCtrl_Def_QuotesTests,   apzCtrl_Def_QuotesPatch },\n \n   {  zIp_Missing_SemiName,    zIp_Missing_SemiList,\n      apzIp_Missing_SemiMachs, (regex_t*)NULL,"}, {"sha": "40d2bbb84c317f51a51e56a7e33190d56fbee75b", "filename": "gcc/fixinc/fixlib.c", "status": "modified", "additions": 20, "deletions": 36, "changes": 56, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5c0d5b94d1952d982318d3fa4ae2b2bace4178ca/gcc%2Ffixinc%2Ffixlib.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5c0d5b94d1952d982318d3fa4ae2b2bace4178ca/gcc%2Ffixinc%2Ffixlib.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffixinc%2Ffixlib.c?ref=5c0d5b94d1952d982318d3fa4ae2b2bace4178ca", "patch": "@@ -112,43 +112,27 @@ is_cxx_header (fname, text)\n         }\n     } not_cxx_name:;\n \n-  /* Or it might contain the phrase 'extern \"C++\"' */\n-  for (;;)\n+  /* Or it might contain one of several phrases which indicate C++ code.\n+     Currently recognized are:\n+     extern \"C++\"\n+     -*- (Mode: )? C++ -*-   (emacs mode marker)\n+     template <\n+   */\n     {\n-      tSCC zExtern[]   = \"extern\";\n-      tSCC zExtCxx[]   = \"\\\"C++\\\"\";\n-      tSCC zTemplate[] = \"template\";\n-\n-      switch (*(text++))\n-        {\n-        case 'e':\n-          /*  Check for \"extern \\\"C++\\\"\" */\n-          if (strncmp (text, zExtern+1, sizeof( zExtern )-2) != 0)\n-            break;\n-          text += sizeof( zExtern )-2;\n-          if (! isspace( *(text++)) )\n-            break;\n-          while (isspace( *text ))  text++;\n-          if (strncmp (text, zExtCxx, sizeof (zExtCxx) -1) == 0)\n-            return BOOL_TRUE;\n-          break;\n-\n-        case 't':\n-          /*  Check for \"template<\" */\n-          if (strncmp (text, zTemplate+1, sizeof( zTemplate )-2) != 0)\n-            break;\n-          text += sizeof( zTemplate )-2;\n-          while (isspace( *text ))  text++;\n-          if (*text == '<')\n-            return BOOL_TRUE;\n-          break;\n-\n-        case NUL:\n-          goto text_done;\n-          break;\n-        }\n-    } text_done:;\n-\n+      tSCC cxxpat[] = \"\\\n+extern[ \\t]*\\\"C\\\\+\\\\+\\\"|\\\n+-\\\\*-[ \\t]*([mM]ode:[ \\t]*)?[cC]\\\\+\\\\+[; \\t]*-\\\\*-|\\\n+template[ \\t]*<\";\n+      static regex_t cxxre;\n+      static int compiled;\n+\n+      if (!compiled)\n+\tcompile_re (cxxpat, &cxxre, 0, \"contents check\", \"is_cxx_header\");\n+\n+      if (regexec (&cxxre, text, 0, 0, 0) == 0)\n+\treturn BOOL_TRUE;\n+    }\n+\t\t   \n   return BOOL_FALSE;\n }\n "}, {"sha": "22fea350fd268febd087614366779272d37f30d4", "filename": "gcc/fixinc/fixtests.c", "status": "modified", "additions": 42, "deletions": 58, "changes": 100, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5c0d5b94d1952d982318d3fa4ae2b2bace4178ca/gcc%2Ffixinc%2Ffixtests.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5c0d5b94d1952d982318d3fa4ae2b2bace4178ca/gcc%2Ffixinc%2Ffixtests.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffixinc%2Ffixtests.c?ref=5c0d5b94d1952d982318d3fa4ae2b2bace4178ca", "patch": "@@ -153,9 +153,9 @@ TEST_FOR_FIX_PROC_HEAD( else_endif_label_test )\n   static regex_t label_re;\n \n   char ch;\n-  tCC* pz_next = (char*)NULL;\n+  tCC* pz_next;\n+  tCC* all_text = text;\n   regmatch_t match[2];\n-  t_bool file_is_cxx = is_cxx_header( fname, text );\n \n   /*\n      This routine may be run many times within a single execution.\n@@ -170,20 +170,14 @@ TEST_FOR_FIX_PROC_HEAD( else_endif_label_test )\n \n   for (;;) /* entire file */\n     {\n-      /*\n-        See if we need to advance to the next candidate directive\n-        If the scanning pointer passes over the end of the directive,\n-        then the directive is inside a comment */\n-      if (pz_next < text)\n-        {\n-          if (regexec (&label_re, text, 2, match, 0) != 0)\n-            break;\n-          pz_next = text + match[0].rm_eo;\n-        }\n-\n-      /*\n-        IF the scan pointer has not reached the directive end, ... */\n-      if (pz_next > text)\n+      /* Find the next else or endif in the file.  */\n+      if (regexec (&label_re, text, 2, match, 0) != 0)\n+\tbreak;\n+      pz_next = text + match[0].rm_eo;\n+\n+      /* Scan from where we are up to that position, to make sure\n+\t we didn't find something in a string or comment.  */\n+      while (pz_next > text)\n         {\n           /*\n             Advance the scanning pointer.  If we are at the start\n@@ -209,82 +203,72 @@ TEST_FOR_FIX_PROC_HEAD( else_endif_label_test )\n             case '\\'':\n               text = skip_quote( ch, text );\n               break;\n-            } /* switch (ch) */\n-          continue;\n-        } /* if (still shy of directive end) */\n+            }\n+        }\n+      if (pz_next < text)\n+\tcontinue;\n \n-      /*\n-         The scanning pointer (text) has reached the end of the current\n-         directive under test, then check for bogons here */\n-      for (;;) /* bogon check */\n+      /* We're at the end of a real directive.  Check for bogons here.  */\n+      for (;;)\n         {\n           char ch = *(pz_next++);\n-          if (isspace (ch))\n-            {\n-              if (ch == '\\n')\n-                {\n-                  /*\n-                    It is clean.  No bogons on this directive */\n-                  text = pz_next;\n-                  pz_next = (char*)NULL; /* force a new regex search */\n-                  break;\n-                }\n-              continue;\n-            }\n+\t  switch (ch)\n+\t    {\n+\t    case '\\n':\n+\t      /* It is clean.  No bogons on this directive.  */\n+\t      goto next_directive;\n \n-          switch (ch)\n-            {\n             case '\\\\':\n-              /*\n-                Skip escaped newlines.  Otherwise, we have a bogon */\n+              /* Skip escaped newlines.  Otherwise, we have a bogon.  */\n               if (*pz_next != '\\n')\n                 return APPLY_FIX;\n \n               pz_next++;\n               break;\n \n             case '/':\n-              /*\n-                Skip comments.  Otherwise, we have a bogon */\n-              switch (*pz_next)\n-                {\n-                case '/':\n-                  /* IF we found a \"//\" in a C header, THEN fix it. */\n-                  if (! file_is_cxx)\n+              /* Skip comments.  Otherwise, we have a bogon */\n+\t      switch (*pz_next)\n+\t\t{\n+\t\tcase '/':\n+\t\t  /* // in a C header is a bogon.  */\n+                  if (! is_cxx_header( fname, all_text ))\n                     return APPLY_FIX;\n \n-                  /* C++ header.  Skip to newline and continue. */\n+                  /* C++ comment is allowed in a C++ header.\n+\t\t     Skip to newline and continue. */\n                   pz_next = strchr( pz_next+1, '\\n' );\n                   if (pz_next == (char*)NULL)\n                     return SKIP_FIX;\n                   pz_next++;\n-                  break;\n+                  goto next_directive;\n \n-                case '*':\n+\t\tcase '*':\n                   /* A comment for either C++ or C.  Skip over it. */\n                   pz_next = strstr( pz_next+1, \"*/\" );\n                   if (pz_next == (char*)NULL)\n                     return SKIP_FIX;\n                   pz_next += 2;\n-                  break;\n+\t\t  break;\n \n-                default:\n-                  /* a '/' followed by other junk. */\n-                  return APPLY_FIX;\n-                }\n-              break; /* a C or C++ comment */\n+\t\tdefault:\n+\t\t  return APPLY_FIX;\n+\t\t}\n+\t      break;\n \n             default:\n-              /*\n-                GOTTA BE A BOGON */\n-              return APPLY_FIX;\n+\t      if (!isspace (ch))\n+\t\treturn APPLY_FIX;\n             } /* switch (ch) */\n         } /* for (bogon check loop) */\n+    next_directive:;\n+      text = pz_next;\n     } /* for (entire file) loop */\n \n   return SKIP_FIX;\n }\n \n+\n /* = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = =\n \n      test for fix selector"}, {"sha": "5f804b20cef2f5d210699b88ccad435d2e07ccb3", "filename": "gcc/fixinc/inclhack.def", "status": "modified", "additions": 36, "deletions": 55, "changes": 91, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5c0d5b94d1952d982318d3fa4ae2b2bace4178ca/gcc%2Ffixinc%2Finclhack.def", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5c0d5b94d1952d982318d3fa4ae2b2bace4178ca/gcc%2Ffixinc%2Finclhack.def", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffixinc%2Finclhack.def?ref=5c0d5b94d1952d982318d3fa4ae2b2bace4178ca", "patch": "@@ -631,6 +631,9 @@ fix = {\n     files    = term.h;\n     files    = tinfo.h;\n \n+    select   = \"char[ \\t]+bool|bool[ \\t]+char\";\n+    bypass   = \"we must use the C\\\\+\\\\+ compiler's type\";\n+\n     sed = \"/^#[ \\t]*define[ \\t][ \\t]*bool[ \\t][ \\t]*char[ \\t]*$/i\\\\\\n\"\n                 \"#ifndef __cplusplus\\n\";\n \n@@ -748,21 +751,6 @@ fix = {\n };\n \n \n-/*\n- *  Note that BSD43_* are used on recent MIPS systems.\n- */\n-fix = {\n-    hackname = bsd43_io_macros;\n-    select   = \"BSD43__IO\";\n-    /*\n-     *  Put single quotes aroung the character that appears after '('\n-     *  and before ',', UNLESS it is a 'c' or 'g' or 'x'.\n-     */\n-    sed = \"/[ \\t]BSD43__IO[A-Z]*[ \\t]*(/\"       's/(\\(.\\),/(\\'\\1\\',/';\n-    sed = \"/#[ \\t]*define[ \\t]*[ \\t]BSD43__IO/\" 's/\\'\\([cgx]\\)\\'/\\1/g';\n-};\n-\n-\n /*\n  *  Fix <c_asm.h> on Digital UNIX V4.0:\n  *  It contains a prototype for a DEC C internal asm() function,\n@@ -970,52 +958,45 @@ fix = {\n };\n \n /*\n- *  Fix various _IO* defines, but do *not* quote the characters cgxtf.\n+ *  Fix various macros used to define ioctl numbers.  The traditional\n+ *  syntax was\n+ *  #define _IO(n, x) (('n'<<8)+x)\n+ *  #define TIOCFOO _IO(T, 1)\n+ *  but this does not work with the C standard, which disallows macro\n+ *  expansion inside strings.  We have to rewrite it thus:\n+ *  #define _IO(n, x) ((n<<8)+x)\n+ *  #define TIOCFOO  _IO('T', 1)\n+ *  The select expressions match too much, but the c_fix code is cautious.\n+ *\n+ *  _IO might be: _IO DESIO BSD43__IO with W, R, WR, C, ... suffixes.\n  */\n fix = {\n-    hackname = io_def_quotes;\n-    select = \"[ \\t]*[ \\t](_|DES)IO[A-Z]*[ \\t]*\\\\( *[^,']\";\n-    sed = \"s/\\\\([ \\t]*[ \\t]_IO[A-Z]*[ \\t]*(\\\\)\\\\([^,']\\\\),/\\\\1'\\\\2',/\";\n-    sed = \"s/\\\\([ \\t]*[ \\t]DESIO[A-Z]*[ \\t]*(\\\\)\\\\([^,']\\\\),/\\\\1'\\\\2',/\";\n-    sed = \"/#[ \\t]*define[ \\t]*[ \\t]_IO/\"       \"s/'\\\\([cgxtf]\\\\)'/\\\\1/g\";\n-    sed = \"/#[ \\t]*define[ \\t]*[ \\t]DESIOC/\"    's/\\'\\([cdgx]\\)\\'/\\1/g';\n+    hackname = io_use_quotes;\n+    select = \"define[ \\t]+[A-Z0-9_]+[ \\t]+[A-Z0-9_]+IO[A-Z]*[ \\t]*\\\\( *[^,']\";\n+    c_fix = IO_use;\n };\n \n-\n+fix = {\n+    hackname = io_def_quotes;\n+    select = \"define[ \\t]+[A-Z0-9_]+IO[A-Z]*\\\\(([a-zA-Z]).*'\\\\1'\";\n+    c_fix = IO_defn;\n+};\n+ \n+ \n /*\n- *  Fix CTRL macros\n- *\n- * Basically, what is supposed to be happening is that every\n- * _invocation_ of the \"_CTRL()\" or \"CTRL()\" macros is supposed to have\n- * its argument inserted into single quotes.  We _must_ do this because\n- * ANSI macro substitution rules prohibit looking inside quoted strings\n- * for the substitution names.  A side effect is that the quotes are\n- * inserted in the definitions of those macros as well.  So, the last\n- * several sed expressions are supposed to clean up the definitions, as\n- * long as those definitions are using \"c\", \"g\" or \"x\" as the macro\n- * argument :).  Yuck.\n+ *  Same deal for CTRL() macros.\n+ *  CTRL might be: CTRL _CTRL ISCTRL BSD43_CTRL ...\n  */\n fix = {\n-    hackname = ioctl_fix_ctrl;\n-    select = \"CTRL[ \\t]*\\\\(\";\n-\n-    sed = \"/[^A-Z0-9_]CTRL[ \\t]*(/\"\n-              \"s/\\\\([^']\\\\))/'\\\\1')/\";\n-\n-    sed = \"/[^A-Z0-9]_CTRL[ \\t]*(/\"\n-              \"s/\\\\([^']\\\\))/'\\\\1')/\";\n-\n-    sed = \"/#[ \\t]*define[ \\t]*[ \\t]CTRL/\"\n-              \"s/'\\\\([cgx]\\\\)'/\\\\1/g\";\n-\n-    sed = \"/#[ \\t]*define[ \\t]*[ \\t]_CTRL/\"\n-              \"s/'\\\\([cgx]\\\\)'/\\\\1/g\";\n-\n-    sed = \"/#[ \\t]*define[ \\t]*[ \\t]BSD43_CTRL/\"\n-              \"s/'\\\\([cgx]\\\\)'/\\\\1/g\";\n-\n-    sed = \"/#[ \\t]*define[ \\t]*[ \\t][_]*ISCTRL/\"\n-              \"s/'\\\\([cgx]\\\\)'/\\\\1/g\";\n+    hackname = ctrl_use_quotes;\n+    select = \"define[ \\t]+[A-Z0-9_]+[ \\t]+[A-Z0-9_]+CTRL[ \\t]*\\\\( *[^,']\";\n+    c_fix = CTRL_use;\n+};\n+ \n+fix = {\n+    hackname = ctrl_def_quotes;\n+    select = \"define[ \\t]+[A-Z0-9_]+CTRL\\\\(([a-zA-Z]).*'\\\\1'\";\n+    c_fix = CTRL_defn;\n };\n \n \n@@ -1372,7 +1353,7 @@ fix = {\n     hackname = math_exception;\n     files    = math.h;\n     select   = \"struct exception\";\n-    bypass   = \"We have a problem when using C++\";\n+    bypass   = \"We have a problem when using C\\\\+\\\\+\";\n     sed      = \"/struct exception/i\\\\\\n\"\n                \"#ifdef __cplusplus\\\\\\n\"\n                \"#define exception __math_exception\\\\\\n\""}, {"sha": "c68f2d711158656544189969ec9b2974626761fd", "filename": "gcc/fixinc/inclhack.sh", "status": "modified", "additions": 45, "deletions": 38, "changes": 83, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5c0d5b94d1952d982318d3fa4ae2b2bace4178ca/gcc%2Ffixinc%2Finclhack.sh", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5c0d5b94d1952d982318d3fa4ae2b2bace4178ca/gcc%2Ffixinc%2Finclhack.sh", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffixinc%2Finclhack.sh?ref=5c0d5b94d1952d982318d3fa4ae2b2bace4178ca", "patch": "@@ -6,7 +6,7 @@\n # files which are fixed to work correctly with ANSI C and placed in a\n # directory that GNU C will search.\n #\n-# This script contains 112 fixup scripts.\n+# This script contains 113 fixup scripts.\n #\n # See README-fixinc for more information.\n #\n@@ -1056,6 +1056,10 @@ struct rusage;\n \t./curses_colr/curses.h | \\\n \t./term.h | \\\n \t./tinfo.h )\n+    if ( test -n \"`egrep 'char[ \t]+bool|bool[ \t]+char' ${file}`\"\n+       ) > /dev/null 2>&1 ; then\n+    if ( test -z \"`egrep 'we must use the C\\\\+\\\\+ compiler'\\\\''s type' ${file}`\"\n+       ) > /dev/null 2>&1 ; then\n     fixlist=\"${fixlist}\n       avoid_bool\"\n     if [ ! -r ${DESTFILE} ]\n@@ -1095,6 +1099,8 @@ struct rusage;\n           < $infile > ${DESTDIR}/fixinc.tmp\n     rm -f ${DESTFILE}\n     mv -f ${DESTDIR}/fixinc.tmp ${DESTFILE}\n+    fi # end of bypass 'if'\n+    fi # end of select 'if'\n     ;; # case end for file name test\n     esac\n \n@@ -1226,25 +1232,6 @@ struct rusage;\n     esac\n \n \n-    #\n-    # Fix Bsd43_Io_Macros\n-    #\n-    if ( test -n \"`egrep 'BSD43__IO' ${file}`\"\n-       ) > /dev/null 2>&1 ; then\n-    fixlist=\"${fixlist}\n-      bsd43_io_macros\"\n-    if [ ! -r ${DESTFILE} ]\n-    then infile=${file}\n-    else infile=${DESTFILE} ; fi \n-\n-    sed -e '/[ \t]BSD43__IO[A-Z]*[ \t]*(/s/(\\(.\\),/('\\''\\1'\\'',/' \\\n-        -e '/#[ \t]*define[ \t]*[ \t]BSD43__IO/s/'\\''\\([cgx]\\)'\\''/\\1/g' \\\n-          < $infile > ${DESTDIR}/fixinc.tmp\n-    rm -f ${DESTFILE}\n-    mv -f ${DESTDIR}/fixinc.tmp ${DESTFILE}\n-    fi # end of select 'if'\n-\n-\n     #\n     # Fix Dec_Intern_Asm\n     #\n@@ -1540,45 +1527,65 @@ extern \"C\" {\\\n     esac\n \n \n+    #\n+    # Fix Io_Use_Quotes\n+    #\n+    if ( test -n \"`egrep 'define[ \t]+[A-Z0-9_]+[ \t]+[A-Z0-9_]+IO[A-Z]*[ \t]*\\\\( *[^,'\\\\'']' ${file}`\"\n+       ) > /dev/null 2>&1 ; then\n+    fixlist=\"${fixlist}\n+      io_use_quotes\"\n+    if [ ! -r ${DESTFILE} ]\n+    then infile=${file}\n+    else infile=${DESTFILE} ; fi \n+    ${FIXFIXES} ${file} IO_use < $infile > ${DESTDIR}/fixinc.tmp\n+    rm -f ${DESTFILE}\n+    mv -f ${DESTDIR}/fixinc.tmp ${DESTFILE}\n+    fi # end of select 'if'\n+\n+\n     #\n     # Fix Io_Def_Quotes\n     #\n-    if ( test -n \"`egrep '[ \t]*[ \t](_|DES)IO[A-Z]*[ \t]*\\\\( *[^,'\\\\'']' ${file}`\"\n+    if ( test -n \"`egrep 'define[ \t]+[A-Z0-9_]+IO[A-Z]*\\\\(([a-zA-Z]).*'\\\\''\\\\1'\\\\''' ${file}`\"\n        ) > /dev/null 2>&1 ; then\n     fixlist=\"${fixlist}\n       io_def_quotes\"\n     if [ ! -r ${DESTFILE} ]\n     then infile=${file}\n     else infile=${DESTFILE} ; fi \n-\n-    sed -e 's/\\([ \t]*[ \t]_IO[A-Z]*[ \t]*(\\)\\([^,'\\'']\\),/\\1'\\''\\2'\\'',/' \\\n-        -e 's/\\([ \t]*[ \t]DESIO[A-Z]*[ \t]*(\\)\\([^,'\\'']\\),/\\1'\\''\\2'\\'',/' \\\n-        -e '/#[ \t]*define[ \t]*[ \t]_IO/s/'\\''\\([cgxtf]\\)'\\''/\\1/g' \\\n-        -e '/#[ \t]*define[ \t]*[ \t]DESIOC/s/'\\''\\([cdgx]\\)'\\''/\\1/g' \\\n-          < $infile > ${DESTDIR}/fixinc.tmp\n+    ${FIXFIXES} ${file} IO_defn < $infile > ${DESTDIR}/fixinc.tmp\n     rm -f ${DESTFILE}\n     mv -f ${DESTDIR}/fixinc.tmp ${DESTFILE}\n     fi # end of select 'if'\n \n \n     #\n-    # Fix Ioctl_Fix_Ctrl\n+    # Fix Ctrl_Use_Quotes\n     #\n-    if ( test -n \"`egrep 'CTRL[ \t]*\\\\(' ${file}`\"\n+    if ( test -n \"`egrep 'define[ \t]+[A-Z0-9_]+[ \t]+[A-Z0-9_]+CTRL[ \t]*\\\\( *[^,'\\\\'']' ${file}`\"\n        ) > /dev/null 2>&1 ; then\n     fixlist=\"${fixlist}\n-      ioctl_fix_ctrl\"\n+      ctrl_use_quotes\"\n     if [ ! -r ${DESTFILE} ]\n     then infile=${file}\n     else infile=${DESTFILE} ; fi \n+    ${FIXFIXES} ${file} CTRL_use < $infile > ${DESTDIR}/fixinc.tmp\n+    rm -f ${DESTFILE}\n+    mv -f ${DESTDIR}/fixinc.tmp ${DESTFILE}\n+    fi # end of select 'if'\n \n-    sed -e '/[^A-Z0-9_]CTRL[ \t]*(/s/\\([^'\\'']\\))/'\\''\\1'\\'')/' \\\n-        -e '/[^A-Z0-9]_CTRL[ \t]*(/s/\\([^'\\'']\\))/'\\''\\1'\\'')/' \\\n-        -e '/#[ \t]*define[ \t]*[ \t]CTRL/s/'\\''\\([cgx]\\)'\\''/\\1/g' \\\n-        -e '/#[ \t]*define[ \t]*[ \t]_CTRL/s/'\\''\\([cgx]\\)'\\''/\\1/g' \\\n-        -e '/#[ \t]*define[ \t]*[ \t]BSD43_CTRL/s/'\\''\\([cgx]\\)'\\''/\\1/g' \\\n-        -e '/#[ \t]*define[ \t]*[ \t][_]*ISCTRL/s/'\\''\\([cgx]\\)'\\''/\\1/g' \\\n-          < $infile > ${DESTDIR}/fixinc.tmp\n+\n+    #\n+    # Fix Ctrl_Def_Quotes\n+    #\n+    if ( test -n \"`egrep 'define[ \t]+[A-Z0-9_]+CTRL\\\\(([a-zA-Z]).*'\\\\''\\\\1'\\\\''' ${file}`\"\n+       ) > /dev/null 2>&1 ; then\n+    fixlist=\"${fixlist}\n+      ctrl_def_quotes\"\n+    if [ ! -r ${DESTFILE} ]\n+    then infile=${file}\n+    else infile=${DESTFILE} ; fi \n+    ${FIXFIXES} ${file} CTRL_defn < $infile > ${DESTDIR}/fixinc.tmp\n     rm -f ${DESTFILE}\n     mv -f ${DESTDIR}/fixinc.tmp ${DESTFILE}\n     fi # end of select 'if'\n@@ -2043,7 +2050,7 @@ s/\\\\+++fixinc_eol+++/\\\\/g\n     case \"${file}\" in ./math.h )\n     if ( test -n \"`egrep 'struct exception' ${file}`\"\n        ) > /dev/null 2>&1 ; then\n-    if ( test -z \"`egrep 'We have a problem when using C++' ${file}`\"\n+    if ( test -z \"`egrep 'We have a problem when using C\\\\+\\\\+' ${file}`\"\n        ) > /dev/null 2>&1 ; then\n     fixlist=\"${fixlist}\n       math_exception\""}]}