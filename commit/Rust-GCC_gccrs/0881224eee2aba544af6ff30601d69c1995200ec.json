{"sha": "0881224eee2aba544af6ff30601d69c1995200ec", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDg4MTIyNGVlZTJhYmE1NDRhZjZmZjMwNjAxZDY5YzE5OTUyMDBlYw==", "commit": {"author": {"name": "Tobias Burnus", "email": "burnus@net-b.de", "date": "2013-01-04T21:51:34Z"}, "committer": {"name": "Tobias Burnus", "email": "burnus@gcc.gnu.org", "date": "2013-01-04T21:51:34Z"}, "message": "intrinsic.c (add_functions): New internal intrinsic function GFC_PREFIX (\"stride\").\n\n2013-01-04  Tobias Burnus  <burnus@net-b.de>\n\n        * intrinsic.c (add_functions): New internal intrinsic\n        function GFC_PREFIX (\"stride\").\n        * gfortran.h (gfc_isym_id): Add GFC_ISYM_STRIDE.\n        * intrinsic.h (gfc_resolve_stride): New prototypes.\n        * iresolve.c (gfc_resolve_stride): New function.\n        * trans-intrinsic.c (conv_intrinsic_stride): New static\n        function.\n        (gfc_conv_intrinsic_function): Use it.\n\nFrom-SVN: r194918", "tree": {"sha": "d5979c9b555dd393249623f63e19dec89246793a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d5979c9b555dd393249623f63e19dec89246793a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0881224eee2aba544af6ff30601d69c1995200ec", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0881224eee2aba544af6ff30601d69c1995200ec", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0881224eee2aba544af6ff30601d69c1995200ec", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0881224eee2aba544af6ff30601d69c1995200ec/comments", "author": {"login": "tob2", "id": 264461, "node_id": "MDQ6VXNlcjI2NDQ2MQ==", "avatar_url": "https://avatars.githubusercontent.com/u/264461?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tob2", "html_url": "https://github.com/tob2", "followers_url": "https://api.github.com/users/tob2/followers", "following_url": "https://api.github.com/users/tob2/following{/other_user}", "gists_url": "https://api.github.com/users/tob2/gists{/gist_id}", "starred_url": "https://api.github.com/users/tob2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tob2/subscriptions", "organizations_url": "https://api.github.com/users/tob2/orgs", "repos_url": "https://api.github.com/users/tob2/repos", "events_url": "https://api.github.com/users/tob2/events{/privacy}", "received_events_url": "https://api.github.com/users/tob2/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "94241120154b0a20b40764c56d0d26f3538927ca", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/94241120154b0a20b40764c56d0d26f3538927ca", "html_url": "https://github.com/Rust-GCC/gccrs/commit/94241120154b0a20b40764c56d0d26f3538927ca"}], "stats": {"total": 65, "additions": 65, "deletions": 0}, "files": [{"sha": "6cc5aef59dfbf49f3d9a03f8fdf5f551e1ee65e6", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0881224eee2aba544af6ff30601d69c1995200ec/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0881224eee2aba544af6ff30601d69c1995200ec/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=0881224eee2aba544af6ff30601d69c1995200ec", "patch": "@@ -1,7 +1,20 @@\n+2013-01-04  Tobias Burnus  <burnus@net-b.de>\n+\n+\t* intrinsic.c (add_functions): New internal intrinsic\n+\tfunction GFC_PREFIX (\"stride\").\n+\t* gfortran.h (gfc_isym_id): Add GFC_ISYM_STRIDE.\n+\t* intrinsic.h (gfc_resolve_stride): New prototypes.\n+\t* iresolve.c (gfc_resolve_stride): New function.\n+\t* trans-intrinsic.c (conv_intrinsic_stride): New static\n+\tfunction.\n+\t(gfc_conv_intrinsic_function): Use it.\n+\n 2013-01-04  Tobias Burnus  <burnus@net-b.de>\n \n \t* class.c (gfc_find_intrinsic_vtab): Add _final\n \tcomponent.\n+\t* decl.c (gfc_match_null): Remove superfluous\n+\tvariadic argument to gfc_match.\n \n 2013-01-04  Paul Thomas  <pault@gcc.gnu.org>\n "}, {"sha": "027cab6b356dfc3a13c4b0c6f68cfc6c80248ffe", "filename": "gcc/fortran/gfortran.h", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0881224eee2aba544af6ff30601d69c1995200ec/gcc%2Ffortran%2Fgfortran.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0881224eee2aba544af6ff30601d69c1995200ec/gcc%2Ffortran%2Fgfortran.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fgfortran.h?ref=0881224eee2aba544af6ff30601d69c1995200ec", "patch": "@@ -521,6 +521,7 @@ enum gfc_isym_id\n   GFC_ISYM_SR_KIND,\n   GFC_ISYM_STAT,\n   GFC_ISYM_STORAGE_SIZE,\n+  GFC_ISYM_STRIDE,\n   GFC_ISYM_SUM,\n   GFC_ISYM_SYMLINK,\n   GFC_ISYM_SYMLNK,"}, {"sha": "5f1b8e7f5a2425f861274e245df4b2a5e9dac1e6", "filename": "gcc/fortran/intrinsic.c", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0881224eee2aba544af6ff30601d69c1995200ec/gcc%2Ffortran%2Fintrinsic.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0881224eee2aba544af6ff30601d69c1995200ec/gcc%2Ffortran%2Fintrinsic.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fintrinsic.c?ref=0881224eee2aba544af6ff30601d69c1995200ec", "patch": "@@ -2640,6 +2640,14 @@ add_functions (void)\n \n   make_generic (\"size\", GFC_ISYM_SIZE, GFC_STD_F95);\n \n+  /* Obtain the stride for a given dimensions; to be used only internally.\n+     \"make_from_module\" makes inaccessible for external users.  */\n+  add_sym_2 (GFC_PREFIX (\"stride\"), GFC_ISYM_STRIDE, CLASS_INQUIRY, ACTUAL_NO,\n+\t     BT_INTEGER, gfc_index_integer_kind, GFC_STD_GNU,\n+\t     NULL, NULL, gfc_resolve_stride,\n+\t     ar, BT_REAL, dr, REQUIRED, dm, BT_INTEGER, ii, OPTIONAL);\n+  make_from_module();\n+\n   add_sym_1 (\"sizeof\", GFC_ISYM_SIZEOF, CLASS_IMPURE, ACTUAL_NO, BT_INTEGER, ii,\n \t     GFC_STD_GNU, gfc_check_sizeof, NULL, NULL,\n \t     x, BT_UNKNOWN, 0, REQUIRED);"}, {"sha": "e7b26e5ce0eb44bfadde6c35e5157c50dc103137", "filename": "gcc/fortran/intrinsic.h", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0881224eee2aba544af6ff30601d69c1995200ec/gcc%2Ffortran%2Fintrinsic.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0881224eee2aba544af6ff30601d69c1995200ec/gcc%2Ffortran%2Fintrinsic.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fintrinsic.h?ref=0881224eee2aba544af6ff30601d69c1995200ec", "patch": "@@ -546,6 +546,7 @@ void gfc_resolve_signal (gfc_expr *, gfc_expr *, gfc_expr *);\n void gfc_resolve_sin (gfc_expr *, gfc_expr *);\n void gfc_resolve_sinh (gfc_expr *, gfc_expr *);\n void gfc_resolve_size (gfc_expr *, gfc_expr *, gfc_expr *, gfc_expr *);\n+void gfc_resolve_stride (gfc_expr *, gfc_expr *, gfc_expr *);\n void gfc_resolve_spacing (gfc_expr *, gfc_expr *);\n void gfc_resolve_spread (gfc_expr *, gfc_expr *, gfc_expr *, gfc_expr *);\n void gfc_resolve_sqrt (gfc_expr *, gfc_expr *);"}, {"sha": "160bfe01d8bafaa6100c4c86ef5ffcc4a25721d6", "filename": "gcc/fortran/iresolve.c", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0881224eee2aba544af6ff30601d69c1995200ec/gcc%2Ffortran%2Firesolve.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0881224eee2aba544af6ff30601d69c1995200ec/gcc%2Ffortran%2Firesolve.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Firesolve.c?ref=0881224eee2aba544af6ff30601d69c1995200ec", "patch": "@@ -2313,6 +2313,15 @@ gfc_resolve_size (gfc_expr *f, gfc_expr *array ATTRIBUTE_UNUSED,\n }\n \n \n+void\n+gfc_resolve_stride (gfc_expr *f, gfc_expr *array ATTRIBUTE_UNUSED,\n+\t\t  gfc_expr *dim ATTRIBUTE_UNUSED)\n+{\n+  f->ts.type = BT_INTEGER;\n+  f->ts.kind = gfc_index_integer_kind;\n+}\n+\n+\n void\n gfc_resolve_spacing (gfc_expr *f, gfc_expr *x)\n {"}, {"sha": "e0b5f1130eb562de87a4153e7ca4ba5c9fff72a0", "filename": "gcc/fortran/trans-intrinsic.c", "status": "modified", "additions": 33, "deletions": 0, "changes": 33, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0881224eee2aba544af6ff30601d69c1995200ec/gcc%2Ffortran%2Ftrans-intrinsic.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0881224eee2aba544af6ff30601d69c1995200ec/gcc%2Ffortran%2Ftrans-intrinsic.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-intrinsic.c?ref=0881224eee2aba544af6ff30601d69c1995200ec", "patch": "@@ -1656,6 +1656,35 @@ conv_intrinsic_cobound (gfc_se * se, gfc_expr * expr)\n }\n \n \n+static void\n+conv_intrinsic_stride (gfc_se * se, gfc_expr * expr)\n+{\n+  gfc_actual_arglist *array_arg;\n+  gfc_actual_arglist *dim_arg;\n+  gfc_se argse;\n+  tree desc, tmp;\n+\n+  array_arg = expr->value.function.actual;\n+  dim_arg = array_arg->next;\n+\n+  gcc_assert (array_arg->expr->expr_type == EXPR_VARIABLE);\n+\n+  gfc_init_se (&argse, NULL);\n+  gfc_conv_expr_descriptor (&argse, array_arg->expr);\n+  gfc_add_block_to_block (&se->pre, &argse.pre);\n+  gfc_add_block_to_block (&se->post, &argse.post);\n+  desc = argse.expr;\n+\n+  gcc_assert (dim_arg->expr);\n+  gfc_init_se (&argse, NULL);\n+  gfc_conv_expr_type (&argse, dim_arg->expr, gfc_array_index_type);\n+  gfc_add_block_to_block (&se->pre, &argse.pre);\n+  tmp = fold_build2_loc (input_location, MINUS_EXPR, gfc_array_index_type,\n+\t\t\t argse.expr, gfc_index_one_node);\n+  se->expr = gfc_conv_descriptor_stride_get (desc, tmp);\n+}\n+\n+\n static void\n gfc_conv_intrinsic_abs (gfc_se * se, gfc_expr * expr)\n {\n@@ -6806,6 +6835,10 @@ gfc_conv_intrinsic_function (gfc_se * se, gfc_expr * expr)\n       gfc_conv_intrinsic_spacing (se, expr);\n       break;\n \n+    case GFC_ISYM_STRIDE:\n+      conv_intrinsic_stride (se, expr);\n+      break;\n+\n     case GFC_ISYM_SUM:\n       gfc_conv_intrinsic_arith (se, expr, PLUS_EXPR, false);\n       break;"}]}