{"sha": "1a32490a09a190b47b7c9c8386407505f554dd16", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWEzMjQ5MGEwOWExOTBiNDdiN2M5YzgzODY0MDc1MDVmNTU0ZGQxNg==", "commit": {"author": {"name": "Alexandre Oliva", "email": "aoliva@redhat.com", "date": "2005-04-22T16:57:23Z"}, "committer": {"name": "Alexandre Oliva", "email": "aoliva@gcc.gnu.org", "date": "2005-04-22T16:57:23Z"}, "message": "re PR c++/21087 (ICE in do_nonmember_using_decl)\n\ngcc/cp/ChangeLog:\nPR c++/21087\n* name-lookup.c (push_overloaded_decl): Do not overload with\nnon-duplicate anticipated built-in.\ngcc/testsuite/ChangeLog:\nPR c++/21087\n* g++.dg/lookup/builtin2.C: New test.\n\nFrom-SVN: r98570", "tree": {"sha": "1bc4cc982a0d35c0669178d387acfbefa38e5fa8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1bc4cc982a0d35c0669178d387acfbefa38e5fa8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1a32490a09a190b47b7c9c8386407505f554dd16", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1a32490a09a190b47b7c9c8386407505f554dd16", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1a32490a09a190b47b7c9c8386407505f554dd16", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1a32490a09a190b47b7c9c8386407505f554dd16/comments", "author": null, "committer": null, "parents": [{"sha": "1751a45f796f13558050ff5c10bd2a6e97cb20f6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1751a45f796f13558050ff5c10bd2a6e97cb20f6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1751a45f796f13558050ff5c10bd2a6e97cb20f6"}], "stats": {"total": 37, "additions": 37, "deletions": 0}, "files": [{"sha": "30eb8662ea3de5e69774bfcb05e3ec9c7ade976a", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1a32490a09a190b47b7c9c8386407505f554dd16/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1a32490a09a190b47b7c9c8386407505f554dd16/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=1a32490a09a190b47b7c9c8386407505f554dd16", "patch": "@@ -1,3 +1,9 @@\n+2005-04-22  Alexandre Oliva  <aoliva@redhat.com>\n+\n+\tPR c++/21087\n+\t* name-lookup.c (push_overloaded_decl): Do not overload with\n+\tnon-duplicate anticipated built-in.\n+\n 2005-04-21  Kazu Hirata  <kazu@cs.umass.edu>\n \n \t* cp-tree.h (THROW_NAME, AUTO_VTABLE_NAME, AUTO_TEMP_FORMAT,"}, {"sha": "ce1d5b3b119dfd06298ac797ea8deae2dcb09685", "filename": "gcc/cp/name-lookup.c", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1a32490a09a190b47b7c9c8386407505f554dd16/gcc%2Fcp%2Fname-lookup.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1a32490a09a190b47b7c9c8386407505f554dd16/gcc%2Fcp%2Fname-lookup.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fname-lookup.c?ref=1a32490a09a190b47b7c9c8386407505f554dd16", "patch": "@@ -1883,6 +1883,13 @@ push_overloaded_decl (tree decl, int flags)\n \t      if (duplicate_decls (decl, fn) == fn)\n \t\tPOP_TIMEVAR_AND_RETURN (TV_NAME_LOOKUP, fn);\n \t    }\n+\n+\t  /* We don't overload implicit built-ins.  duplicate_decls()\n+\t     may fail to merge the decls if the new decl is e.g. a\n+\t     template function.  */\n+\t  if (TREE_CODE (old) == FUNCTION_DECL\n+\t      && DECL_ANTICIPATED (old))\n+\t    old = NULL;\n \t}\n       else if (old == error_mark_node)\n \t/* Ignore the undefined symbol marker.  */"}, {"sha": "6b36764aa974c13bedbce0d5a8e601aaeba0962b", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1a32490a09a190b47b7c9c8386407505f554dd16/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1a32490a09a190b47b7c9c8386407505f554dd16/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=1a32490a09a190b47b7c9c8386407505f554dd16", "patch": "@@ -1,3 +1,8 @@\n+2005-04-22  Alexandre Oliva  <aoliva@redhat.com>\n+\n+\tPR c++/21087\n+\t* g++.dg/lookup/builtin2.C: New test.\n+\n 2005-04-22  Joseph S. Myers  <joseph@codesourcery.com>\n \n \t* gcc.dg/weak/weak-13.c: New test."}, {"sha": "be0a6f65d6c0ea3cfa63eb4310e4d1e0c299e5be", "filename": "gcc/testsuite/g++.dg/lookup/builtin2.C", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1a32490a09a190b47b7c9c8386407505f554dd16/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Fbuiltin2.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1a32490a09a190b47b7c9c8386407505f554dd16/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Fbuiltin2.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Fbuiltin2.C?ref=1a32490a09a190b47b7c9c8386407505f554dd16", "patch": "@@ -0,0 +1,19 @@\n+/* { dg-do compile } */\n+\n+/* PR c++/21087 */\n+\n+/* We used to overload the template function with the built-in\n+   declaration, instead of replacing it as we should, and then barf at\n+   the using decl because of a test that none of the overload set\n+   members were anticipated built-ins.  */\n+\n+extern \"C\" signed int toupper(signed int __c) throw();\n+namespace std\n+{\n+  template< typename a > a toupper(a,int){}\n+  using ::toupper;\n+}\n+\n+int f () {\n+  std::toupper((signed int)'a');\n+}"}]}