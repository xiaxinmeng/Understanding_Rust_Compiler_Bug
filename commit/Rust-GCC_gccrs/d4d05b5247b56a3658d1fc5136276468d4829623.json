{"sha": "d4d05b5247b56a3658d1fc5136276468d4829623", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDRkMDViNTI0N2I1NmEzNjU4ZDFmYzUxMzYyNzY0NjhkNDgyOTYyMw==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2012-07-03T07:57:46Z"}, "committer": {"name": "Eric Botcazou", "email": "ebotcazou@gcc.gnu.org", "date": "2012-07-03T07:57:46Z"}, "message": "utils.c (gnat_pushdecl): Set TYPE_CONTEXT for types attached to a TYPE_DECL.\n\n\t* gcc-interface/utils.c (gnat_pushdecl): Set TYPE_CONTEXT for types\n\tattached to a TYPE_DECL.\n\nFrom-SVN: r189195", "tree": {"sha": "aebce448073fa12709ee05c731d52ba40b06e344", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/aebce448073fa12709ee05c731d52ba40b06e344"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d4d05b5247b56a3658d1fc5136276468d4829623", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d4d05b5247b56a3658d1fc5136276468d4829623", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d4d05b5247b56a3658d1fc5136276468d4829623", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d4d05b5247b56a3658d1fc5136276468d4829623/comments", "author": null, "committer": null, "parents": [{"sha": "68a12ef35b38746594c034a71d74dd6d68b775c0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/68a12ef35b38746594c034a71d74dd6d68b775c0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/68a12ef35b38746594c034a71d74dd6d68b775c0"}], "stats": {"total": 12, "additions": 11, "deletions": 1}, "files": [{"sha": "6dd84b588e5286e41ebf085bfdbd2ab4fbf806be", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d4d05b5247b56a3658d1fc5136276468d4829623/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d4d05b5247b56a3658d1fc5136276468d4829623/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=d4d05b5247b56a3658d1fc5136276468d4829623", "patch": "@@ -1,3 +1,8 @@\n+2012-07-03  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* gcc-interface/utils.c (gnat_pushdecl): Set TYPE_CONTEXT for types\n+\tattached to a TYPE_DECL.\n+\n 2012-06-26  Vincent Pucci  <pucci@adacore.com>\n \n \t* exp_ch3.adb (Build_Init_Statements): Don't check the parents"}, {"sha": "923fbd18bedac68ebb94f8c41cd7eacc411dafcc", "filename": "gcc/ada/gcc-interface/utils.c", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d4d05b5247b56a3658d1fc5136276468d4829623/gcc%2Fada%2Fgcc-interface%2Futils.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d4d05b5247b56a3658d1fc5136276468d4829623/gcc%2Fada%2Fgcc-interface%2Futils.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgcc-interface%2Futils.c?ref=d4d05b5247b56a3658d1fc5136276468d4829623", "patch": "@@ -612,6 +612,7 @@ gnat_pushdecl (tree decl, Node_Id gnat_node)\n \t      if (TREE_CODE (t) == POINTER_TYPE)\n \t\tTYPE_NEXT_PTR_TO (t) = tt;\n \t      TYPE_NAME (tt) = DECL_NAME (decl);\n+\t      TYPE_CONTEXT (tt) = DECL_CONTEXT (decl);\n \t      TYPE_STUB_DECL (tt) = TYPE_STUB_DECL (t);\n \t      DECL_ORIGINAL_TYPE (decl) = tt;\n \t    }\n@@ -621,6 +622,7 @@ gnat_pushdecl (tree decl, Node_Id gnat_node)\n \t  /* We need a variant for the placeholder machinery to work.  */\n \t  tree tt = build_variant_type_copy (t);\n \t  TYPE_NAME (tt) = decl;\n+\t  TYPE_CONTEXT (tt) = DECL_CONTEXT (decl);\n \t  TREE_USED (tt) = TREE_USED (t);\n \t  TREE_TYPE (decl) = tt;\n \t  if (DECL_ORIGINAL_TYPE (TYPE_NAME (t)))\n@@ -640,7 +642,10 @@ gnat_pushdecl (tree decl, Node_Id gnat_node)\n       if (t)\n \tfor (t = TYPE_MAIN_VARIANT (t); t; t = TYPE_NEXT_VARIANT (t))\n \t  if (!(TYPE_NAME (t) && TREE_CODE (TYPE_NAME (t)) == TYPE_DECL))\n-\t    TYPE_NAME (t) = decl;\n+\t    {\n+\t      TYPE_NAME (t) = decl;\n+\t      TYPE_CONTEXT (t) = DECL_CONTEXT (decl);\n+\t    }\n     }\n }\n \f"}]}