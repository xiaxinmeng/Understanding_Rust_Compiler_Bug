{"sha": "a4967b8db12d7f2d9b0d80830507f806c4c36e5b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTQ5NjdiOGRiMTJkN2YyZDliMGQ4MDgzMDUwN2Y4MDZjNGMzNmU1Yg==", "commit": {"author": {"name": "Jason Thorpe", "email": "thorpej@wasabisystems.com", "date": "2002-11-26T00:05:07Z"}, "committer": {"name": "Jason Thorpe", "email": "thorpej@gcc.gnu.org", "date": "2002-11-26T00:05:07Z"}, "message": "config.gcc (powerpc-*-netbsd*): Replace \"svr4.h\" with \"netbsd.h netbsd-elf.h\" in tm_file.\n\n* config.gcc (powerpc-*-netbsd*): Replace \"svr4.h\" with\n\"netbsd.h netbsd-elf.h\" in tm_file.  Set tmake_file to\n\"${tmake_file} rs6000/t-netbsd\".\n* config/rs6000/netbsd.h: Rewrite.\n* config/rs6000/t-netbsd: New file.\n\nFrom-SVN: r59479", "tree": {"sha": "66344fe13c49f92ccfb74c0b6a88293f1092c73d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/66344fe13c49f92ccfb74c0b6a88293f1092c73d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a4967b8db12d7f2d9b0d80830507f806c4c36e5b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a4967b8db12d7f2d9b0d80830507f806c4c36e5b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a4967b8db12d7f2d9b0d80830507f806c4c36e5b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a4967b8db12d7f2d9b0d80830507f806c4c36e5b/comments", "author": null, "committer": null, "parents": [{"sha": "c4f6640537ff392ad466a83796e68fb79b512bee", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c4f6640537ff392ad466a83796e68fb79b512bee", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c4f6640537ff392ad466a83796e68fb79b512bee"}], "stats": {"total": 131, "additions": 94, "deletions": 37}, "files": [{"sha": "c0eea411090412c6d11b3e909bb840e75f97c475", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a4967b8db12d7f2d9b0d80830507f806c4c36e5b/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a4967b8db12d7f2d9b0d80830507f806c4c36e5b/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=a4967b8db12d7f2d9b0d80830507f806c4c36e5b", "patch": "@@ -1,3 +1,11 @@\n+2002-11-25  Jason Thorpe  <thorpej@wasabisystems.com>\n+\n+\t* config.gcc (powerpc-*-netbsd*): Replace \"svr4.h\" with\n+\t\"netbsd.h netbsd-elf.h\" in tm_file.  Set tmake_file to\n+\t\"${tmake_file} rs6000/t-netbsd\".\n+\t* config/rs6000/netbsd.h: Rewrite.\n+\t* config/rs6000/t-netbsd: New file.\n+\n 2002-11-25  Kazu Hirata  <kazu@cs.umass.edu>\n \n \t* config/h8300/h8300.md (an anonymous pattern): Relax the"}, {"sha": "0fe9fa720d62aaea15abf9337eb208e1387ba25d", "filename": "gcc/config.gcc", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a4967b8db12d7f2d9b0d80830507f806c4c36e5b/gcc%2Fconfig.gcc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a4967b8db12d7f2d9b0d80830507f806c4c36e5b/gcc%2Fconfig.gcc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig.gcc?ref=a4967b8db12d7f2d9b0d80830507f806c4c36e5b", "patch": "@@ -2001,8 +2001,8 @@ powerpc-*-sysv*)\n \ttmake_file=\"rs6000/t-ppcos rs6000/t-ppccomm\"\n \t;;\n powerpc-*-netbsd*)\n-\ttm_file=\"${tm_file} dbxelf.h elfos.h svr4.h freebsd-spec.h rs6000/sysv4.h rs6000/netbsd.h\"\n-\ttmake_file=\"rs6000/t-ppcos rs6000/t-ppccomm\"\n+\ttm_file=\"${tm_file} dbxelf.h elfos.h netbsd.h netbsd-elf.h freebsd-spec.h rs6000/sysv4.h rs6000/netbsd.h\"\n+\ttmake_file=\"${tmake_file} rs6000/t-netbsd\"\n \t;;\n powerpc-*-chorusos*)\n \txm_defines=POSIX"}, {"sha": "6791a4d6622f2d22e301d37c475c81106008acde", "filename": "gcc/config/rs6000/netbsd.h", "status": "modified", "additions": 42, "deletions": 35, "changes": 77, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a4967b8db12d7f2d9b0d80830507f806c4c36e5b/gcc%2Fconfig%2Frs6000%2Fnetbsd.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a4967b8db12d7f2d9b0d80830507f806c4c36e5b/gcc%2Fconfig%2Frs6000%2Fnetbsd.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Fnetbsd.h?ref=a4967b8db12d7f2d9b0d80830507f806c4c36e5b", "patch": "@@ -1,6 +1,7 @@\n /* Definitions of target machine for GNU compiler,\n    for PowerPC NetBSD systems.\n-   Copyright 2001 Free Software Foundation, Inc.\n+   Copyright 2002 Free Software Foundation, Inc.\n+   Contributed by Wasabi Systems, Inc.\n \n This file is part of GNU CC.\n \n@@ -19,48 +20,54 @@ along with GNU CC; see the file COPYING.  If not, write to\n the Free Software Foundation, 59 Temple Place - Suite 330,\n Boston, MA 02111-1307, USA.  */\n \n-/* Under NetBSD, the normal location of the various *crt*.o files is\n-   the /usr/lib directory [from config/netbsd.h].  */\n+#undef TARGET_OS_CPP_BUILTINS\t/* FIXME: sysv4.h should not define this! */\n+#define TARGET_OS_CPP_BUILTINS()\t\t\\\n+  do\t\t\t\t\t\t\\\n+    {\t\t\t\t\t\t\\\n+      NETBSD_OS_CPP_BUILTINS_ELF();\t\t\\\n+      builtin_define (\"__powerpc__\");\t\t\\\n+      builtin_assert (\"cpu=powerpc\");\t\t\\\n+      builtin_assert (\"machine=powerpc\");\t\\\n+    }\t\t\t\t\t\t\\\n+  while (0)\n \n-#undef STANDARD_STARTFILE_PREFIX\n-#define STANDARD_STARTFILE_PREFIX \"/usr/lib/\"\n+/* Make GCC agree with <machine/ansi.h>.  */\n \n-/* FIXME: Should this macro be treated the same as for the other\n-   spec's?  */\n-/* NOTE: -dc and -dp are equivalent yet NetBSD's CC passes both both!\n-   NetBSD's CC also passes -O1 but we can skip that.  NetBSD explictly\n-   sets ``-e _start'', since LD knows this, skip it.  */\n+#undef SIZE_TYPE\n+#define SIZE_TYPE \"unsigned int\"\n \n-#undef LINK_SHLIB_SPEC\n-#define LINK_SHLIB_SPEC \"\\\n-%{shared:-shared} \\\n-%{!shared: %{static:-dc -dp -static}} \\\n-%{!shared: %{!static:-dc -dp}} \\\n-\"\n+#undef PTRDIFF_TYPE\n+#define PTRDIFF_TYPE \"int\"\n \n-/* Override the defaults.  */\n-#undef LIB_DEFAULT_SPEC\n-#define LIB_DEFAULT_SPEC \"%(lib_netbsd)\"\n+/* Undo the spec mess from sysv4.h, and just define the specs\n+   the way NetBSD systems actually expect.  */\n \n-#undef STARTFILE_DEFAULT_SPEC\n-#define STARTFILE_DEFAULT_SPEC \"%(startfile_netbsd)\"\n+#undef CPP_SPEC\n+#define CPP_SPEC NETBSD_CPP_SPEC\n \n-#undef ENDFILE_DEFAULT_SPEC\n-#define ENDFILE_DEFAULT_SPEC \"%(endfile_netbsd)\"\n+#undef LINK_SPEC\n+#define LINK_SPEC \\\n+  \"%{!msdata=none:%{G*}} %{msdata=none:-G0} \\\n+   %(netbsd_link_spec)\"\n \n-#undef LINK_START_DEFAULT_SPEC\n-#define LINK_START_DEFAULT_SPEC \"%(link_start_netbsd)\"\n+#define NETBSD_ENTRY_POINT \"_start\"\n \n-#undef\tLINK_OS_DEFAULT_SPEC\n-#define LINK_OS_DEFAULT_SPEC \"%(link_os_netbsd)\"\n+#undef STARTFILE_SPEC\n+#define STARTFILE_SPEC NETBSD_STARTFILE_SPEC\n \n-#undef\tCPP_OS_DEFAULT_SPEC\n-#define CPP_OS_DEFAULT_SPEC \"%(cpp_os_netbsd)\"\n+#undef ENDFILE_SPEC\n+#define ENDFILE_SPEC \\\n+  \"crtsavres%O%s %(netbsd_endfile_spec)\"\n \n-#undef TARGET_VERSION\n-#define TARGET_VERSION fprintf (stderr, \" (PowerPC NetBSD/ELF)\");\n+#undef LIB_SPEC\n+#define LIB_SPEC NETBSD_LIB_SPEC\n+\n+#undef SUBTARGET_EXTRA_SPECS\n+#define SUBTARGET_EXTRA_SPECS\t\t\t\t\t\\\n+  { \"netbsd_link_spec\",\t\tNETBSD_LINK_SPEC_ELF },\t\t\\\n+  { \"netbsd_entry_point\",\tNETBSD_ENTRY_POINT },\t\t\\\n+  { \"netbsd_endfile_spec\",\tNETBSD_ENDFILE_SPEC },\n \n-/* Use STABS debugging information by default.  DWARF2 makes a mess of\n-   the 1.5.2 linker.  */\n-#undef  PREFERRED_DEBUGGING_TYPE\n-#define PREFERRED_DEBUGGING_TYPE DBX_DEBUG\n+\n+#undef TARGET_VERSION\n+#define TARGET_VERSION fprintf (stderr, \" (NetBSD/powerpc ELF)\");"}, {"sha": "0cb08e730c066f60bbb70ec70a8294567787e763", "filename": "gcc/config/rs6000/t-netbsd", "status": "added", "additions": 42, "deletions": 0, "changes": 42, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a4967b8db12d7f2d9b0d80830507f806c4c36e5b/gcc%2Fconfig%2Frs6000%2Ft-netbsd", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a4967b8db12d7f2d9b0d80830507f806c4c36e5b/gcc%2Fconfig%2Frs6000%2Ft-netbsd", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Ft-netbsd?ref=a4967b8db12d7f2d9b0d80830507f806c4c36e5b", "patch": "@@ -0,0 +1,42 @@\n+# Support for NetBSD PowerPC ELF targets (SVR4 ABI).\n+\n+LIB2FUNCS_EXTRA = tramp.S\n+\n+tramp.S: $(srcdir)/config/rs6000/tramp.asm\n+\tcat $(srcdir)/config/rs6000/tramp.asm > tramp.S\n+\n+crtsavres.S: $(srcdir)/config/rs6000/crtsavres.asm\n+\tcat $(srcdir)/config/rs6000/crtsavres.asm >crtsavres.S\n+\n+EXTRA_PARTS += crtsavres$(objext)\n+\n+# It is important that crtbegin.o, etc., aren't surprised by stuff in .sdata.\n+CRTSTUFF_T_CFLAGS += -msdata=none\n+CRTSTUFF_T_CFLAGS_S += -msdata=none\n+\n+# Switch synonyms\n+MULTILIB_MATCHES_FLOAT\t= msoft-float=mcpu?401 \\\n+\t\t\t  msoft-float=mcpu?403 \\\n+\t\t\t  msoft-float=mcpu?405 \\\n+\t\t\t  msoft-float=mcpu?ec603e \\\n+\t\t\t  msoft-float=mcpu?801 \\\n+\t\t\t  msoft-float=mcpu?821 \\\n+\t\t\t  msoft-float=mcpu?823 \\\n+\t\t\t  msoft-float=mcpu?860\n+\n+MULTILIB_OPTIONS\t= msoft-float\n+MULTILIB_DIRNAMES\t= soft-float\n+MULTILIB_EXTRA_OPTS\t= fPIC mstrict-align\n+MULTILIB_EXCEPTIONS\t=\n+\n+MULTILIB_MATCHES\t= ${MULTILIB_MATCHES_FLOAT}\n+\n+LIBGCC = stmp-multilib\n+INSTALL_LIBGCC = install-multilib\n+EXTRA_MULTILIB_PARTS = crtbegin$(objext) crtend$(objext) \\\n+  crtbeginS$(objext) crtendS$(objext) crtbeginT$(objext) \\\n+  crtsavres$(objext)\n+\n+$(T)crtsavres$(objext): crtsavres.S\n+\t$(GCC_FOR_TARGET) $(CRTSTUFF_CFLAGS) $(CRTSTUFF_T_CFLAGS) \\\n+\t  -c crtsavres.S -o $(T)crtsavres$(objext)"}]}