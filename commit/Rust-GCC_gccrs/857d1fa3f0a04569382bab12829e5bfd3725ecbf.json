{"sha": "857d1fa3f0a04569382bab12829e5bfd3725ecbf", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODU3ZDFmYTNmMGEwNDU2OTM4MmJhYjEyODI5ZTViZmQzNzI1ZWNiZg==", "commit": {"author": {"name": "Fei Yang", "email": "felix.yang@huawei.com", "date": "2020-04-23T15:08:03Z"}, "committer": {"name": "Richard Sandiford", "email": "richard.sandiford@arm.com", "date": "2020-04-23T15:08:03Z"}, "message": "testsuite: Add extra aarch64 predefine tests\n\nAdd extra testing in the following two tests to make sure CPP predefines\nredefinitions on #pragma works as expected when -mgeneral-regs-only\noption is specified (See PR94678):\ngcc.target/aarch64/pragma_cpp_predefs_2.c\ngcc.target/aarch64/pragma_cpp_predefs_3.c\n\n2020-04-23  Felix Yang  <felix.yang@huawei.com>\n\ngcc/testsuite/\n\tPR target/94678\n\t* gcc.target/aarch64/pragma_cpp_predefs_2.c: Fix typos, pop_pragma ->\n\tpop_options. Add tests for general-regs-only.\n\t* gcc.target/aarch64/pragma_cpp_predefs_3.c: Add tests for\n\tgeneral-regs-only.", "tree": {"sha": "4ab2399a8b1d6ad9e06cd36d2449e0e19455e725", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4ab2399a8b1d6ad9e06cd36d2449e0e19455e725"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/857d1fa3f0a04569382bab12829e5bfd3725ecbf", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/857d1fa3f0a04569382bab12829e5bfd3725ecbf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/857d1fa3f0a04569382bab12829e5bfd3725ecbf", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/857d1fa3f0a04569382bab12829e5bfd3725ecbf/comments", "author": null, "committer": {"login": "rsandifo-arm", "id": 28043039, "node_id": "MDQ6VXNlcjI4MDQzMDM5", "avatar_url": "https://avatars.githubusercontent.com/u/28043039?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rsandifo-arm", "html_url": "https://github.com/rsandifo-arm", "followers_url": "https://api.github.com/users/rsandifo-arm/followers", "following_url": "https://api.github.com/users/rsandifo-arm/following{/other_user}", "gists_url": "https://api.github.com/users/rsandifo-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/rsandifo-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rsandifo-arm/subscriptions", "organizations_url": "https://api.github.com/users/rsandifo-arm/orgs", "repos_url": "https://api.github.com/users/rsandifo-arm/repos", "events_url": "https://api.github.com/users/rsandifo-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/rsandifo-arm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ee9fcee3ec3a124dc3947c73c264bbcda97198df", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ee9fcee3ec3a124dc3947c73c264bbcda97198df", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ee9fcee3ec3a124dc3947c73c264bbcda97198df"}], "stats": {"total": 105, "additions": 103, "deletions": 2}, "files": [{"sha": "4f5f020efce4b1c3591abccc8921f0a652e1fe1f", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/857d1fa3f0a04569382bab12829e5bfd3725ecbf/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/857d1fa3f0a04569382bab12829e5bfd3725ecbf/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=857d1fa3f0a04569382bab12829e5bfd3725ecbf", "patch": "@@ -1,3 +1,11 @@\n+2020-04-23  Felix Yang  <felix.yang@huawei.com>\n+\n+\tPR target/94678\n+\t* gcc.target/aarch64/pragma_cpp_predefs_2.c: Fix typos, pop_pragma ->\n+\tpop_options. Add tests for general-regs-only.\n+\t* gcc.target/aarch64/pragma_cpp_predefs_3.c: Add tests for\n+\tgeneral-regs-only.\n+\n 2020-04-23  Andrew Stubbs  <ams@codesourcery.com>\n \t    Thomas Schwinge  <thomas@codesourcery.com>\n "}, {"sha": "7244359ccfb9cbcbbd8285b050113c004a6af2a6", "filename": "gcc/testsuite/gcc.target/aarch64/pragma_cpp_predefs_2.c", "status": "modified", "additions": 36, "deletions": 2, "changes": 38, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/857d1fa3f0a04569382bab12829e5bfd3725ecbf/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fpragma_cpp_predefs_2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/857d1fa3f0a04569382bab12829e5bfd3725ecbf/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fpragma_cpp_predefs_2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fpragma_cpp_predefs_2.c?ref=857d1fa3f0a04569382bab12829e5bfd3725ecbf", "patch": "@@ -67,7 +67,7 @@\n #ifdef __ARM_FEATURE_SVE_MATMUL_FP64\n #error \"__ARM_FEATURE_SVE_MATMUL_FP64 is defined but should not be!\"\n #endif\n-#pragma GCC pop_pragma\n+#pragma GCC pop_options\n \n #pragma GCC push_options\n #pragma GCC target (\"arch=armv8.2-a+i8mm\")\n@@ -115,7 +115,7 @@\n #ifdef __ARM_FEATURE_SVE_MATMUL_FP64\n #error \"__ARM_FEATURE_SVE_MATMUL_FP64 is defined but should not be!\"\n #endif\n-#pragma GCC pop_pragma\n+#pragma GCC pop_options\n \n #pragma GCC push_options\n #pragma GCC target (\"arch=armv8.2-a+f64mm\")\n@@ -208,6 +208,40 @@\n \n #pragma GCC pop_options\n \n+/* Make sure that general-regs-only works too.  */\n+#pragma GCC push_options\n+#pragma GCC target (\"arch=armv8.2-a+sve+i8mm+f32mm+f64mm\")\n+#ifndef __ARM_FEATURE_SVE\n+#error \"__ARM_FEATURE_SVE is not defined but should be!\"\n+#endif\n+#ifndef __ARM_FEATURE_SVE_MATMUL_INT8\n+#error \"__ARM_FEATURE_SVE_MATMUL_INT8 is not defined but should be!\"\n+#endif\n+#ifndef __ARM_FEATURE_SVE_MATMUL_FP32\n+#error \"__ARM_FEATURE_SVE_MATMUL_FP32 is not defined but should be!\"\n+#endif\n+#ifndef __ARM_FEATURE_SVE_MATMUL_FP64\n+#error \"__ARM_FEATURE_SVE_MATMUL_FP64 is not defined but should be!\"\n+#endif\n+\n+#pragma GCC push_options\n+#pragma GCC target (\"general-regs-only\")\n+#ifdef __ARM_FEATURE_SVE\n+#error \"__ARM_FEATURE_SVE is defined but should not be!\"\n+#endif\n+#ifdef __ARM_FEATURE_SVE_MATMUL_INT8\n+#error \"__ARM_FEATURE_SVE_MATMUL_INT8 is defined but should not be!\"\n+#endif\n+#ifdef __ARM_FEATURE_SVE_MATMUL_FP32\n+#error \"__ARM_FEATURE_SVE_MATMUL_FP32 is defined but should not be!\"\n+#endif\n+#ifdef __ARM_FEATURE_SVE_MATMUL_FP64\n+#error \"__ARM_FEATURE_SVE_MATMUL_FP64 is defined but should not be!\"\n+#endif\n+#pragma GCC pop_options\n+\n+#pragma GCC pop_options\n+\n int\n foo (int a)\n {"}, {"sha": "39128528600f54195f6b092886e8d172317f2877", "filename": "gcc/testsuite/gcc.target/aarch64/pragma_cpp_predefs_3.c", "status": "modified", "additions": 59, "deletions": 0, "changes": 59, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/857d1fa3f0a04569382bab12829e5bfd3725ecbf/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fpragma_cpp_predefs_3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/857d1fa3f0a04569382bab12829e5bfd3725ecbf/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fpragma_cpp_predefs_3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fpragma_cpp_predefs_3.c?ref=857d1fa3f0a04569382bab12829e5bfd3725ecbf", "patch": "@@ -214,6 +214,65 @@\n \n #pragma GCC pop_options\n \n+/* Make sure that general-regs-only works too.  */\n+#pragma GCC push_options\n+#pragma GCC target (\"arch=armv8.5-a+sve2-aes+sve2-bitperm+sve2-sha3+sve2-sm4\")\n+\n+#ifndef __ARM_FEATURE_SVE\n+#error \"__ARM_FEATURE_SVE is not defined but should be!\"\n+#endif\n+\n+#ifndef __ARM_FEATURE_SVE2\n+#error \"__ARM_FEATURE_SVE2 is not defined but should be!\"\n+#endif\n+\n+#ifndef __ARM_FEATURE_SVE2_AES\n+#error \"__ARM_FEATURE_SVE2_AES is not defined but should be!\"\n+#endif\n+\n+#ifndef __ARM_FEATURE_SVE2_BITPERM\n+#error \"__ARM_FEATURE_SVE2_BITPERM is not defined but should be!\"\n+#endif\n+\n+#ifndef __ARM_FEATURE_SVE2_SHA3\n+#error \"__ARM_FEATURE_SVE2_SHA3 is not defined but should be!\"\n+#endif\n+\n+#ifndef __ARM_FEATURE_SVE2_SM4\n+#error \"__ARM_FEATURE_SVE2_SM4 is not defined but should be!\"\n+#endif\n+\n+#pragma GCC push_options\n+#pragma GCC target (\"general-regs-only\")\n+\n+#ifdef __ARM_FEATURE_SVE\n+#error \"__ARM_FEATURE_SVE is defined but should not be!\"\n+#endif\n+\n+#ifdef __ARM_FEATURE_SVE2\n+#error \"__ARM_FEATURE_SVE2 is defined but should not be!\"\n+#endif\n+\n+#ifdef __ARM_FEATURE_SVE2_AES\n+#error \"__ARM_FEATURE_SVE2_AES is defined but should not be!\"\n+#endif\n+\n+#ifdef __ARM_FEATURE_SVE2_BITPERM\n+#error \"__ARM_FEATURE_SVE2_BITPERM is defined but should not be!\"\n+#endif\n+\n+#ifdef __ARM_FEATURE_SVE2_SHA3\n+#error \"__ARM_FEATURE_SVE2_SHA3 is defined but should not be!\"\n+#endif\n+\n+#ifdef __ARM_FEATURE_SVE2_SM4\n+#error \"__ARM_FEATURE_SVE2_SM4 is defined but should not be!\"\n+#endif\n+\n+#pragma GCC pop_options\n+\n+#pragma GCC pop_options\n+\n int\n foo (int a)\n {"}]}