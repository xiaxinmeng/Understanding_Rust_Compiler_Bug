{"sha": "bc9201591d2d677dc21819ff8f11de18983f1f61", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmM5MjAxNTkxZDJkNjc3ZGMyMTgxOWZmOGYxMWRlMTg5ODNmMWY2MQ==", "commit": {"author": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2012-04-24T20:13:12Z"}, "committer": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2012-04-24T20:13:12Z"}, "message": "gotest: Remove race in use of ../testdata.\n\nFrom-SVN: r186781", "tree": {"sha": "74b2e86a24eb0dedc80d2e30ee6beccd38fcaa98", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/74b2e86a24eb0dedc80d2e30ee6beccd38fcaa98"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bc9201591d2d677dc21819ff8f11de18983f1f61", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bc9201591d2d677dc21819ff8f11de18983f1f61", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bc9201591d2d677dc21819ff8f11de18983f1f61", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bc9201591d2d677dc21819ff8f11de18983f1f61/comments", "author": null, "committer": null, "parents": [{"sha": "21e417158cf179bb9aa0ae0ef92afd1a31a65b4b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/21e417158cf179bb9aa0ae0ef92afd1a31a65b4b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/21e417158cf179bb9aa0ae0ef92afd1a31a65b4b"}], "stats": {"total": 30, "additions": 16, "deletions": 14}, "files": [{"sha": "40d32ed3d2dce0a8bd128a6dee3697a4557616c3", "filename": "libgo/testsuite/gotest", "status": "modified", "additions": 16, "deletions": 14, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bc9201591d2d677dc21819ff8f11de18983f1f61/libgo%2Ftestsuite%2Fgotest", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bc9201591d2d677dc21819ff8f11de18983f1f61/libgo%2Ftestsuite%2Fgotest", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgo%2Ftestsuite%2Fgotest?ref=bc9201591d2d677dc21819ff8f11de18983f1f61", "patch": "@@ -136,18 +136,20 @@ rm -rf $DIR\n mkdir $DIR\n \n cd $DIR\n+mkdir test\n+cd test\n \n if test $keep = false; then\n-  trap \"cd ..; rm -rf $DIR\" 0 1 2 3 14 15\n+  trap \"cd ../..; rm -rf $DIR\" 0 1 2 3 14 15\n else\n-  trap \"cd ..; echo Keeping $DIR\" 0 1 2 3 14 15\n+  trap \"cd ../..; echo Keeping $DIR\" 0 1 2 3 14 15\n fi\n \n case \"$srcdir\" in\n \t/*)\n \t\t;;\n \t*)\n-\t\tsrcdir=\"../$srcdir\"\n+\t\tsrcdir=\"../../$srcdir\"\n                 ;;\n esac\n \n@@ -158,7 +160,7 @@ case \"$basedir\" in\n \t/*)\n \t\t;;\n \t*)\n-\t\tbasedir=\"../$basedir\"\n+\t\tbasedir=\"../../$basedir\"\n                 ;;\n esac\n \n@@ -189,10 +191,10 @@ x)\n \t\t\tb=`basename $f`\n \t\t\trm -f $b\n \t\t\tcp $basedir/$f $b\n-\t\t    elif test -f ../$f; then\n+\t\t    elif test -f ../../$f; then\n \t\t\tb=`basename $f`\n \t\t\trm -f $b\n-\t\t\tcp ../$f $b\n+\t\t\tcp ../../$f $b\n \t\t    else\n \t\t\techo \"file $f not found\" 1>&2\n \t\t\texit 1\n@@ -224,10 +226,10 @@ x)\n \t\t\tb=`basename $f`\n \t\t\trm -f $b\n \t\t\tcp $basedir/$f $b\n-\t\t    elif test -f ../$f; then\n+\t\t    elif test -f ../../$f; then\n \t\t\tb=`basename $f`\n \t\t\trm -f $b\n-\t\t\tcp ../$f $b\n+\t\t\tcp ../../$f $b\n \t\t    else\n \t\t\techo \"file $f not found\" 1>&2\n \t\t\texit 1\n@@ -455,27 +457,27 @@ xno)\n \texit $status\n \t;;\n xyes)\n-\trm -rf ../testsuite/*.o\n+\trm -rf ../../testsuite/*.o\n \tfiles=`echo *`\n \tfor f in $files; do\n \t\tif test \"$f\" = \"_obj\" || test \"$f\" = \"_test\"; then\n \t\t\tcontinue\n \t\tfi\n-\t\trm -rf ../testsuite/$f\n+\t\trm -rf ../../testsuite/$f\n \t\tif test -f $f; then\n-\t\t\tcp $f ../testsuite/\n+\t\t\tcp $f ../../testsuite/\n \t\telse\n-\t\t\tln -s ../$DIR/$f ../testsuite/\n+\t\t\tln -s ../$DIR/test/$f ../../testsuite/\n \t\tfi\n \tdone\n-\tcd ../testsuite\n+\tcd ../../testsuite\n \trm -rf _obj _test\n \tmkdir _obj _test\n \tif test \"$testname\" != \"\"; then\n \t    GOTESTNAME=\"$testname\"\n \t    export GOTESTNAME\n \tfi\n-\t$MAKE check RUNTESTFLAGS=\"$RUNTESTFLAGS GOTEST_TMPDIR=$DIR\"\n+\t$MAKE check RUNTESTFLAGS=\"$RUNTESTFLAGS GOTEST_TMPDIR=$DIR/test\"\n \t# Useful when using make check-target-libgo\n \tcat libgo.log >> libgo-all.log\n \tcat libgo.sum >> libgo-all.sum"}]}