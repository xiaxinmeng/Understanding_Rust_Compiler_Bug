{"sha": "8a9c1ae6bfcdfa9a589c6f8f98b6a9b8f495d9e5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OGE5YzFhZTZiZmNkZmE5YTU4OWM2ZjhmOThiNmE5YjhmNDk1ZDllNQ==", "commit": {"author": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2010-06-30T16:51:36Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2010-06-30T16:51:36Z"}, "message": "PR middle-end/PR44706\n\n\tPR middle-end/PR44706\n\t* ipa-split (split_function): Refine conditions when to use DECL_RESULT\n\tto return the value.\n\t* gcc.dg/tree-ssa/ipa-split-4.c: New testcase.\n\nFrom-SVN: r161615", "tree": {"sha": "f361e2a80e7a7827dd9e5ce2c1670aec9d8c2d38", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f361e2a80e7a7827dd9e5ce2c1670aec9d8c2d38"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8a9c1ae6bfcdfa9a589c6f8f98b6a9b8f495d9e5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8a9c1ae6bfcdfa9a589c6f8f98b6a9b8f495d9e5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8a9c1ae6bfcdfa9a589c6f8f98b6a9b8f495d9e5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8a9c1ae6bfcdfa9a589c6f8f98b6a9b8f495d9e5/comments", "author": null, "committer": null, "parents": [{"sha": "8a1561bcd07c8e630f1e7492c364a664dd6f3d69", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8a1561bcd07c8e630f1e7492c364a664dd6f3d69", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8a1561bcd07c8e630f1e7492c364a664dd6f3d69"}], "stats": {"total": 44, "additions": 44, "deletions": 0}, "files": [{"sha": "b19c28998ae299bdc02e6f3981c9c6bd60e437f3", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8a9c1ae6bfcdfa9a589c6f8f98b6a9b8f495d9e5/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8a9c1ae6bfcdfa9a589c6f8f98b6a9b8f495d9e5/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=8a9c1ae6bfcdfa9a589c6f8f98b6a9b8f495d9e5", "patch": "@@ -1,3 +1,9 @@\n+2010-06-30  Jan Hubicka  <jh@suse.cz>\n+\n+\tPR middle-end/PR44706\n+\t* ipa-split (split_function): Refine conditions when to use DECL_RESULT\n+\tto return the value.\n+\n 2010-06-30  Michael Matz  <matz@suse.de>\n \n \tPR bootstrap/44699"}, {"sha": "289a7b38beb804a683fe59b99789086f3edeed2d", "filename": "gcc/ipa-split.c", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8a9c1ae6bfcdfa9a589c6f8f98b6a9b8f495d9e5/gcc%2Fipa-split.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8a9c1ae6bfcdfa9a589c6f8f98b6a9b8f495d9e5/gcc%2Fipa-split.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-split.c?ref=8a9c1ae6bfcdfa9a589c6f8f98b6a9b8f495d9e5", "patch": "@@ -931,6 +931,13 @@ split_function (struct split_point *split_point)\n \t  if (!VOID_TYPE_P (TREE_TYPE (TREE_TYPE (current_function_decl))))\n \t    {\n \t      retval = DECL_RESULT (current_function_decl);\n+\n+\t      /* We use temporary register to hold value when aggregate_value_p\n+\t\t is false.  Similarly for DECL_BY_REFERENCE we must avoid extra\n+\t\t copy.  */\n+\t      if (!aggregate_value_p (retval, TREE_TYPE (current_function_decl))\n+\t\t  && !DECL_BY_REFERENCE (retval))\n+\t\tretval = create_tmp_reg (TREE_TYPE (retval), NULL);\n \t      if (is_gimple_reg (retval))\n \t\tretval = make_ssa_name (retval, call);\n \t      gimple_call_set_lhs (call, retval);"}, {"sha": "d9e9a4025f9399d4006e7de127dbb021345dbce8", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8a9c1ae6bfcdfa9a589c6f8f98b6a9b8f495d9e5/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8a9c1ae6bfcdfa9a589c6f8f98b6a9b8f495d9e5/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=8a9c1ae6bfcdfa9a589c6f8f98b6a9b8f495d9e5", "patch": "@@ -1,3 +1,7 @@\n+2010-06-30  Jan Hubicka  <jh@suse.cz>\n+\n+\t* gcc.dg/tree-ssa/ipa-split-4.c: New testcase.\n+\n 2010-06-30  Michael Matz  <matz@suse.de>\n \n \tPR bootstrap/44699"}, {"sha": "c2c396024997b8733ebe2008c9e2b1e73d439ad3", "filename": "gcc/testsuite/gcc.dg/tree-ssa/ipa-split-4.c", "status": "added", "additions": 27, "deletions": 0, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8a9c1ae6bfcdfa9a589c6f8f98b6a9b8f495d9e5/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fipa-split-4.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8a9c1ae6bfcdfa9a589c6f8f98b6a9b8f495d9e5/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fipa-split-4.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fipa-split-4.c?ref=8a9c1ae6bfcdfa9a589c6f8f98b6a9b8f495d9e5", "patch": "@@ -0,0 +1,27 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O3 -fdump-tree-fnsplit\" } */\n+int make_me_big (void);\n+\n+int\n+split_me (int a)\n+{\n+  if (__builtin_expect(a<10, 1))\n+    {\n+      abort ();\n+    }\n+  else\n+    {\n+      make_me_big ();\n+      make_me_big ();\n+      make_me_big ();\n+      make_me_big ();\n+      return a+1;\n+    }\n+}\n+\n+main()\n+{\n+  return split_me (0)+split_me(1)+split_me(2);\n+}\n+/* { dg-final { scan-tree-dump-times \"Splitting function\" 1 \"fnsplit\"} } */\n+/* { dg-final { cleanup-tree-dump \"fnsplit\" } } */"}]}