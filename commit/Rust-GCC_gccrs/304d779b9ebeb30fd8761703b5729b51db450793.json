{"sha": "304d779b9ebeb30fd8761703b5729b51db450793", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzA0ZDc3OWI5ZWJlYjMwZmQ4NzYxNzAzYjU3MjliNTFkYjQ1MDc5Mw==", "commit": {"author": {"name": "Thomas Koenig", "email": "tkoenig@gcc.gnu.org", "date": "2019-06-08T13:50:42Z"}, "committer": {"name": "Thomas Koenig", "email": "tkoenig@gcc.gnu.org", "date": "2019-06-08T13:50:42Z"}, "message": "re PR fortran/90744 (Bogus length for character temporaries passed to external procedures since r268992)\n\n2019-06-08  Thomas Koenig  <tkoenig@gcc.gnu.org>\n\tTom\u00e1\u0161 Trnka  <trnka@scm.com>\n\n\tPR fortran/90744\n\t* trans-types.c (get_formal_from_actual_arglist): Unset typespec\n\tflags which make no sense for procedures without explicit\n\tinterface.\n\n2019-06-08  Thomas Koenig  <tkoenig@gcc.gnu.org>\n\tTom\u00e1\u0161 Trnka  <trnka@scm.com>\n\n\tPR fortran/90744\n\t* gfortran.dg/deferred_character_33.f90: New test.\n\t* gfortran.dg/deferred_character_33a.f90: New test.\n\nFrom-SVN: r272082", "tree": {"sha": "ead5b78fc9724867061d75a9d207b33ed89eb2ff", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ead5b78fc9724867061d75a9d207b33ed89eb2ff"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/304d779b9ebeb30fd8761703b5729b51db450793", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/304d779b9ebeb30fd8761703b5729b51db450793", "html_url": "https://github.com/Rust-GCC/gccrs/commit/304d779b9ebeb30fd8761703b5729b51db450793", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/304d779b9ebeb30fd8761703b5729b51db450793/comments", "author": null, "committer": null, "parents": [{"sha": "604ba08ab4b3672b8d96f78a781937ad9e43971c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/604ba08ab4b3672b8d96f78a781937ad9e43971c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/604ba08ab4b3672b8d96f78a781937ad9e43971c"}], "stats": {"total": 64, "additions": 63, "deletions": 1}, "files": [{"sha": "20fe2c3824565a263d592442f85527884487a78a", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/304d779b9ebeb30fd8761703b5729b51db450793/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/304d779b9ebeb30fd8761703b5729b51db450793/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=304d779b9ebeb30fd8761703b5729b51db450793", "patch": "@@ -1,3 +1,11 @@\n+2019-06-08  Thomas Koenig  <tkoenig@gcc.gnu.org>\n+\tTom\u00e1\u0161 Trnka  <trnka@scm.com>\n+\n+\tPR fortran/90744\n+\t* trans-types.c (get_formal_from_actual_arglist): Unset typespec\n+\tflags which make no sense for procedures without explicit\n+\tinterface.\n+\n 2019-06-02  Thomas Koenig  <tkoenig@gcc.gnu.org>\n \n \tPR fortran/90539"}, {"sha": "d236f37be6d679fefb121e8adc70014f59650991", "filename": "gcc/fortran/trans-types.c", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/304d779b9ebeb30fd8761703b5729b51db450793/gcc%2Ffortran%2Ftrans-types.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/304d779b9ebeb30fd8761703b5729b51db450793/gcc%2Ffortran%2Ftrans-types.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-types.c?ref=304d779b9ebeb30fd8761703b5729b51db450793", "patch": "@@ -3005,6 +3005,9 @@ get_formal_from_actual_arglist (gfc_symbol *sym, gfc_actual_arglist *actual_args\n \t  else\n \t    {\n \t      s->ts = a->expr->ts;\n+\t      s->ts.deferred = 0;\n+\t      s->ts.is_iso_c = 0;\n+\t      s->ts.is_c_interop = 0;\n \t      s->attr.flavor = FL_VARIABLE;\n \t      if (a->expr->rank > 0)\n \t\t{"}, {"sha": "c7846a4addbd136750230a65583caec9014d4769", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/304d779b9ebeb30fd8761703b5729b51db450793/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/304d779b9ebeb30fd8761703b5729b51db450793/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=304d779b9ebeb30fd8761703b5729b51db450793", "patch": "@@ -1,3 +1,10 @@\n+2019-06-08  Thomas Koenig  <tkoenig@gcc.gnu.org>\n+\tTom\u00e1\u0161 Trnka  <trnka@scm.com>\n+\n+\tPR fortran/90744\n+\t* gfortran.dg/deferred_character_33.f90: New test.\n+\t* gfortran.dg/deferred_character_33a.f90: New test.\n+\n 2019-06-08  Marek Polacek  <polacek@redhat.com>\n \n \tPR c++/77548\n@@ -10,7 +17,7 @@\n \n \t* gcc.target/aarch64/sve/init_1.c: Remove options\n \t-O2 -fno-schedule-insns and instead pass -O.\n-\tUpdate assembly in comments. \n+\tUpdate assembly in comments.\n \t* gcc.target/aarch64/sve/init_2.c: Likewise.\n \t* gcc.target/aarch64/sve/init_3.c: Likewise.\n \t* gcc.target/aarch64/sve/init_4.c: Likewise."}, {"sha": "ec864d83c314195923baf82e9c99f022efc96d15", "filename": "gcc/testsuite/gfortran.dg/deferred_character_33.f90", "status": "added", "additions": 35, "deletions": 0, "changes": 35, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/304d779b9ebeb30fd8761703b5729b51db450793/gcc%2Ftestsuite%2Fgfortran.dg%2Fdeferred_character_33.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/304d779b9ebeb30fd8761703b5729b51db450793/gcc%2Ftestsuite%2Fgfortran.dg%2Fdeferred_character_33.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fdeferred_character_33.f90?ref=304d779b9ebeb30fd8761703b5729b51db450793", "patch": "@@ -0,0 +1,35 @@\n+! { dg-do run }\n+! { dg-additional-sources deferred_character_33a.f90 }\n+! PR fortran/90744 - this used to pass a wrong length\n+! to an external function without a prototype.\n+! Original test case by Tom\u00e1\u0161 Trnka.\n+module StringModule\n+   implicit none\n+\n+contains\n+   function getstr()\n+      character(:), allocatable :: getstr\n+\n+      getstr = 'OK'\n+   end function\n+end module\n+module TestModule\n+   use StringModule\n+   implicit none\n+\n+contains\n+   subroutine DoTest()\n+      if (.false.) then\n+         call convrs('A',getstr())\n+      else\n+         call convrs('B',getstr())\n+      end if\n+   end subroutine\n+end module\n+program external_char_length\n+   use TestModule\n+\n+   implicit none\n+\n+   call DoTest()\n+end program"}, {"sha": "db117cc0b3817f8c23e530ee1d1501ea83efb8ab", "filename": "gcc/testsuite/gfortran.dg/deferred_character_33a.f90", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/304d779b9ebeb30fd8761703b5729b51db450793/gcc%2Ftestsuite%2Fgfortran.dg%2Fdeferred_character_33a.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/304d779b9ebeb30fd8761703b5729b51db450793/gcc%2Ftestsuite%2Fgfortran.dg%2Fdeferred_character_33a.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fdeferred_character_33a.f90?ref=304d779b9ebeb30fd8761703b5729b51db450793", "patch": "@@ -0,0 +1,9 @@\n+! { dg-do compile }\n+subroutine convrs(quanty,fromto)\n+   implicit none\n+\n+   character(*), intent(in) :: quanty,fromto\n+\n+   if (len(fromto) /= 2) stop 1\n+   if (fromto /= 'OK') stop 2\n+end subroutine"}]}