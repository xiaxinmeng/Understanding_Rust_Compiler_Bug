{"sha": "23ffb99e94f8cbd3ac656f5efa3035c00432e6e2", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjNmZmI5OWU5NGY4Y2JkM2FjNjU2ZjVlZmEzMDM1YzAwNDMyZTZlMg==", "commit": {"author": {"name": "Paolo Carlini", "email": "paolo.carlini@oracle.com", "date": "2011-11-30T18:31:30Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2011-11-30T18:31:30Z"}, "message": "re PR c++/51299 ([C++11] erroneous nullptr warning on dynamic cast)\n\n/cp\n2011-11-30  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/51299\n\t* rtti.c (ifnonnull): Use nullptr_node.\n\t(build_dynamic_cast_1): Call cp_truthvalue_conversion instead\n\tof c_common_truthvalue_conversion.\n\n/testsuite\n2011-11-30  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/51299\n\t* g++.dg/warn/Wzero-as-null-pointer-constant-4.C: New.\n\nFrom-SVN: r181854", "tree": {"sha": "c75ad6f57a0a20bf98ff10db1700e24698cdeef7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c75ad6f57a0a20bf98ff10db1700e24698cdeef7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/23ffb99e94f8cbd3ac656f5efa3035c00432e6e2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/23ffb99e94f8cbd3ac656f5efa3035c00432e6e2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/23ffb99e94f8cbd3ac656f5efa3035c00432e6e2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/23ffb99e94f8cbd3ac656f5efa3035c00432e6e2/comments", "author": null, "committer": null, "parents": [{"sha": "2e65f38f1bf1f04c530bfeb6b543f084564eec3d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2e65f38f1bf1f04c530bfeb6b543f084564eec3d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2e65f38f1bf1f04c530bfeb6b543f084564eec3d"}], "stats": {"total": 40, "additions": 37, "deletions": 3}, "files": [{"sha": "42573eff39d3158d95690063a92c6a8a5105e6b9", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/23ffb99e94f8cbd3ac656f5efa3035c00432e6e2/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/23ffb99e94f8cbd3ac656f5efa3035c00432e6e2/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=23ffb99e94f8cbd3ac656f5efa3035c00432e6e2", "patch": "@@ -1,3 +1,10 @@\n+2011-11-30  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/51299\n+\t* rtti.c (ifnonnull): Use nullptr_node.\n+\t(build_dynamic_cast_1): Call cp_truthvalue_conversion instead\n+\tof c_common_truthvalue_conversion.\n+\n 2011-11-24  Paolo Carlini  <paolo.carlini@oracle.com>\n \n \tPR c++/51227"}, {"sha": "4494fddc03ebc3aaaf316648b0e17403458ab602", "filename": "gcc/cp/rtti.c", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/23ffb99e94f8cbd3ac656f5efa3035c00432e6e2/gcc%2Fcp%2Frtti.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/23ffb99e94f8cbd3ac656f5efa3035c00432e6e2/gcc%2Fcp%2Frtti.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Frtti.c?ref=23ffb99e94f8cbd3ac656f5efa3035c00432e6e2", "patch": "@@ -503,8 +503,8 @@ ifnonnull (tree test, tree result)\n {\n   return build3 (COND_EXPR, TREE_TYPE (result),\n \t\t build2 (EQ_EXPR, boolean_type_node, test,\n-\t\t\t cp_convert (TREE_TYPE (test), integer_zero_node)),\n-\t\t cp_convert (TREE_TYPE (result), integer_zero_node),\n+\t\t\t cp_convert (TREE_TYPE (test), nullptr_node)),\n+\t\t cp_convert (TREE_TYPE (result), nullptr_node),\n \t\t result);\n }\n \n@@ -747,7 +747,7 @@ build_dynamic_cast_1 (tree type, tree expr, tsubst_flags_t complain)\n \t      tree neq;\n \n \t      result = save_expr (result);\n-\t      neq = c_common_truthvalue_conversion (input_location, result);\n+\t      neq = cp_truthvalue_conversion (result);\n \t      return cp_convert (type,\n \t\t\t\t build3 (COND_EXPR, TREE_TYPE (result),\n \t\t\t\t\t neq, result, bad));"}, {"sha": "fb13fb53c21494343f7fdedaf8e36c4c8999e88e", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/23ffb99e94f8cbd3ac656f5efa3035c00432e6e2/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/23ffb99e94f8cbd3ac656f5efa3035c00432e6e2/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=23ffb99e94f8cbd3ac656f5efa3035c00432e6e2", "patch": "@@ -1,3 +1,8 @@\n+2011-11-30  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/51299\n+\t* g++.dg/warn/Wzero-as-null-pointer-constant-4.C: New.\n+\n 2011-11-29  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR tree-optimization/51247"}, {"sha": "548caac36e977c1945f600dcd632fdbfeac4396b", "filename": "gcc/testsuite/g++.dg/warn/Wzero-as-null-pointer-constant-4.C", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/23ffb99e94f8cbd3ac656f5efa3035c00432e6e2/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWzero-as-null-pointer-constant-4.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/23ffb99e94f8cbd3ac656f5efa3035c00432e6e2/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWzero-as-null-pointer-constant-4.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWzero-as-null-pointer-constant-4.C?ref=23ffb99e94f8cbd3ac656f5efa3035c00432e6e2", "patch": "@@ -0,0 +1,22 @@\n+// PR c++/51299\n+// { dg-options \"-Wzero-as-null-pointer-constant\" }\n+\n+class Base\n+{\n+  public:\n+  virtual ~Base();\n+};\n+\n+class Derived : public Base\n+{\n+};\n+\n+void foo(Base* b)\n+{\n+  Derived* d = dynamic_cast<Derived*>(b);\n+}\n+\n+void bar(Base& b)\n+{\n+  Derived& d = dynamic_cast<Derived&>(b);\n+}"}]}