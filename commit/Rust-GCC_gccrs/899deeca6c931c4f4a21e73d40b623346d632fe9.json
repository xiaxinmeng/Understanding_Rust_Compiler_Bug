{"sha": "899deeca6c931c4f4a21e73d40b623346d632fe9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODk5ZGVlY2E2YzkzMWM0ZjRhMjFlNzNkNDBiNjIzMzQ2ZDYzMmZlOQ==", "commit": {"author": {"name": "Bryce McKinlay", "email": "mckinlay@redhat.com", "date": "2004-08-02T21:20:46Z"}, "committer": {"name": "Bryce McKinlay", "email": "bryce@gcc.gnu.org", "date": "2004-08-02T21:20:46Z"}, "message": "re PR java/16701 (Error when constant initializer depends on another constant with restricted access)\n\n2004-08-02  Bryce McKinlay  <mckinlay@redhat.com>\n\n\tPR java/16701\n\t* parse.y (fold_constant_for_init): Call resolve_field_access with\n\tcorrect current_class context.\n\n2004-08-02  Bryce McKinlay  <mckinlay@redhat.com>\n\n\t* testsuite/libjava.compile/PR16701.java: New test.\n\nFrom-SVN: r85453", "tree": {"sha": "489c5ba70ebca4a8c68b6e6cfbbc6dd6343b586b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/489c5ba70ebca4a8c68b6e6cfbbc6dd6343b586b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/899deeca6c931c4f4a21e73d40b623346d632fe9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/899deeca6c931c4f4a21e73d40b623346d632fe9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/899deeca6c931c4f4a21e73d40b623346d632fe9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/899deeca6c931c4f4a21e73d40b623346d632fe9/comments", "author": null, "committer": null, "parents": [{"sha": "4c24b21a47dc8d146c8e4699e4b5a593a00fd9a9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4c24b21a47dc8d146c8e4699e4b5a593a00fd9a9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4c24b21a47dc8d146c8e4699e4b5a593a00fd9a9"}], "stats": {"total": 30, "additions": 25, "deletions": 5}, "files": [{"sha": "1cd9315f14b9191eed248a57a79efd7752084faf", "filename": "gcc/java/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/899deeca6c931c4f4a21e73d40b623346d632fe9/gcc%2Fjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/899deeca6c931c4f4a21e73d40b623346d632fe9/gcc%2Fjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2FChangeLog?ref=899deeca6c931c4f4a21e73d40b623346d632fe9", "patch": "@@ -1,3 +1,9 @@\n+2004-08-02  Bryce McKinlay  <mckinlay@redhat.com>\n+\n+\tPR java/16701\n+\t* parse.y (fold_constant_for_init): Call resolve_field_access with\n+\tcorrect current_class context.\n+\n 2004-08-01  Roger Sayle  <roger@eyesopen.com>\n \n \t* decl.c (update_aliases, initialize_local_variable): Replace calls"}, {"sha": "fdff74676498a5ee8ee7136ed7a041583ccea14d", "filename": "gcc/java/parse.y", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/899deeca6c931c4f4a21e73d40b623346d632fe9/gcc%2Fjava%2Fparse.y", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/899deeca6c931c4f4a21e73d40b623346d632fe9/gcc%2Fjava%2Fparse.y", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2Fparse.y?ref=899deeca6c931c4f4a21e73d40b623346d632fe9", "patch": "@@ -15970,16 +15970,16 @@ fold_constant_for_init (tree node, tree context)\n \t    }\n \t  else\n \t    {\n-\t      /* Install the proper context for the field resolution.\n-\t\t The prior context is restored once the name is\n-\t\t properly qualified. */\n+\t      tree r = NULL_TREE;\n+\t      /* Install the proper context for the field resolution.  */\n \t      tree saved_current_class = current_class;\n \t      /* Wait until the USE_COMPONENT_REF re-write.  FIXME. */\n \t      current_class = DECL_CONTEXT (context);\n \t      qualify_ambiguous_name (node);\n+\t      r = resolve_field_access (node, &decl, NULL);\n+\t      /* Restore prior context.  */\n \t      current_class = saved_current_class;\n-\t      if (resolve_field_access (node, &decl, NULL)\n-\t\t  && decl != NULL_TREE)\n+\t      if (r != error_mark_node && decl != NULL_TREE)\n \t\treturn fold_constant_for_init (decl, decl);\n \t      return NULL_TREE;\n \t    }"}, {"sha": "81922f2655cdd74a119ee8d3d02f48ffe0fc2ed8", "filename": "libjava/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/899deeca6c931c4f4a21e73d40b623346d632fe9/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/899deeca6c931c4f4a21e73d40b623346d632fe9/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=899deeca6c931c4f4a21e73d40b623346d632fe9", "patch": "@@ -1,3 +1,7 @@\n+2004-08-02  Bryce McKinlay  <mckinlay@redhat.com>\n+\n+\t* testsuite/libjava.compile/PR16701.java: New test.\n+\n 2004-08-01  Andrew John Hughes  <gnu_andrew@member.fsf.org>\n \n \t* java/util/Collection.java, java/util/List.java,"}, {"sha": "60d459a69c7691fe64d78955fbf677551dd224f1", "filename": "libjava/testsuite/libjava.compile/PR16701.java", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/899deeca6c931c4f4a21e73d40b623346d632fe9/libjava%2Ftestsuite%2Flibjava.compile%2FPR16701.java", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/899deeca6c931c4f4a21e73d40b623346d632fe9/libjava%2Ftestsuite%2Flibjava.compile%2FPR16701.java", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Ftestsuite%2Flibjava.compile%2FPR16701.java?ref=899deeca6c931c4f4a21e73d40b623346d632fe9", "patch": "@@ -0,0 +1,10 @@\n+class Cl\n+{\n+  private static final int CONSTANT1 = 0x001;\n+  public static final int CONSTANT2 = 0x002 >> CONSTANT1;\n+}\n+\n+public class PR16701\n+{\n+  public static final int VALUE = Cl.CONSTANT2;\n+}"}]}