{"sha": "182c2078bca13829deba82c7ce6d999d122cd18b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTgyYzIwNzhiY2ExMzgyOWRlYmE4MmM3Y2U2ZDk5OWQxMjJjZDE4Yg==", "commit": {"author": {"name": "Hans-Peter Nilsson", "email": "hp@axis.com", "date": "2003-02-22T03:21:27Z"}, "committer": {"name": "Hans-Peter Nilsson", "email": "hp@gcc.gnu.org", "date": "2003-02-22T03:21:27Z"}, "message": "* gcc.dg/asmreg-1.c: New test.\n\nFrom-SVN: r63271", "tree": {"sha": "4eb895363b4f8819140db155998cc325d2b8588e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4eb895363b4f8819140db155998cc325d2b8588e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/182c2078bca13829deba82c7ce6d999d122cd18b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/182c2078bca13829deba82c7ce6d999d122cd18b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/182c2078bca13829deba82c7ce6d999d122cd18b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/182c2078bca13829deba82c7ce6d999d122cd18b/comments", "author": {"login": "hpataxisdotcom", "id": 80339731, "node_id": "MDQ6VXNlcjgwMzM5NzMx", "avatar_url": "https://avatars.githubusercontent.com/u/80339731?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hpataxisdotcom", "html_url": "https://github.com/hpataxisdotcom", "followers_url": "https://api.github.com/users/hpataxisdotcom/followers", "following_url": "https://api.github.com/users/hpataxisdotcom/following{/other_user}", "gists_url": "https://api.github.com/users/hpataxisdotcom/gists{/gist_id}", "starred_url": "https://api.github.com/users/hpataxisdotcom/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hpataxisdotcom/subscriptions", "organizations_url": "https://api.github.com/users/hpataxisdotcom/orgs", "repos_url": "https://api.github.com/users/hpataxisdotcom/repos", "events_url": "https://api.github.com/users/hpataxisdotcom/events{/privacy}", "received_events_url": "https://api.github.com/users/hpataxisdotcom/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "5192890754c0137c9a0786630a8f68b60956bcc5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5192890754c0137c9a0786630a8f68b60956bcc5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5192890754c0137c9a0786630a8f68b60956bcc5"}], "stats": {"total": 77, "additions": 77, "deletions": 0}, "files": [{"sha": "72512238ca2e9ad9ed0d0bbbe8a8b8cb2506786b", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/182c2078bca13829deba82c7ce6d999d122cd18b/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/182c2078bca13829deba82c7ce6d999d122cd18b/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=182c2078bca13829deba82c7ce6d999d122cd18b", "patch": "@@ -1,3 +1,7 @@\n+2003-02-22  Hans-Peter Nilsson  <hp@axis.com>\n+\n+\t* gcc.dg/asmreg-1.c: New test.\n+\n 2003-02-21  Mark Mitchell  <mark@codesourcery.com>\n \n \tPR c++/9749"}, {"sha": "a779766d4a698267b6182733c9923d145c472a7f", "filename": "gcc/testsuite/gcc.dg/asmreg-1.c", "status": "added", "additions": 73, "deletions": 0, "changes": 73, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/182c2078bca13829deba82c7ce6d999d122cd18b/gcc%2Ftestsuite%2Fgcc.dg%2Fasmreg-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/182c2078bca13829deba82c7ce6d999d122cd18b/gcc%2Ftestsuite%2Fgcc.dg%2Fasmreg-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fasmreg-1.c?ref=182c2078bca13829deba82c7ce6d999d122cd18b", "patch": "@@ -0,0 +1,73 @@\n+/* { dg-do compile { target cris-*-* } } */\n+/* { dg-options \"-O2\" } */\n+/* { dg-final { scan-assembler \"\\\\\\.ifnc \\\\\\$r9-\\\\\\$r10-\\\\\\$r11-\\\\\\$r12\" } } */\n+\n+/* Sanity check for asm register operands in syscall failed for\n+   cris-axis-linux-gnu due to regmove bug.\n+   Hans-Peter Nilsson <hp@axis.com>.  */\n+\n+extern void lseek64 (int, long long, int);\n+extern int *__errno_location (void);\n+struct dirent64\n+{\n+  long long d_off;\n+  unsigned short int d_reclen;\n+  char d_name[256];\n+};\n+struct kernel_dirent64\n+{   \n+  long long d_off;\n+  unsigned short d_reclen;\n+  char d_name[256];\n+};\n+\n+static inline int __attribute__ ((__always_inline__))\n+__syscall_getdents64 (int fd, unsigned char * dirp, unsigned count)\n+{\n+  register unsigned long __sys_res asm (\"r10\");\n+  register unsigned long __r10 __asm__ (\"r10\") = (unsigned long) fd;\n+  register unsigned long __r11 __asm__ (\"r11\") = (unsigned long) dirp;\n+  register unsigned long __r12 __asm__ (\"r12\") = (unsigned long) count;\n+  register unsigned long __callno asm (\"r9\") = (220);\n+  asm volatile (\".ifnc %1-%0-%3-%4,$r9-$r10-$r11-$r12\\n\\t\"\n+\t\t\".err\\n\\t\"\n+\t\t\".endif\\n\\t\"\n+\t\t\"break 13\"\n+\t\t: \"=r\" (__sys_res)\n+\t\t: \"r\" (__callno), \"0\" (__r10), \"r\" (__r11), \"r\" (__r12)\n+\t\t: \"memory\");\n+  if (__sys_res >= (unsigned long) -4096)\n+    {\n+      (*__errno_location ()) = - __sys_res;\n+      __sys_res = -1;\n+    }\n+  return __sys_res;\n+}\n+\n+int\n+__getdents64 (int fd, char *buf, unsigned nbytes)\n+{   \n+  struct dirent64 *dp;\n+  long long last_offset = -1;\n+  int retval;\n+  struct kernel_dirent64 *skdp, *kdp;\n+  dp = (struct dirent64 *) buf;\n+  skdp = kdp = __builtin_alloca (nbytes);\n+  retval = __syscall_getdents64(fd, (char *)kdp, nbytes);\n+  if (retval == -1)\n+    return -1;\n+  while ((char *) kdp < (char *) skdp + retval)\n+    {\n+      if ((char *) dp > buf + nbytes)\n+\t{\n+\t  lseek64(fd, last_offset, 0);\n+\t  break;\n+\t}\n+      last_offset = kdp->d_off;\n+      __builtin_memcpy (dp->d_name, kdp->d_name, kdp->d_reclen - 10);\n+      dp = (struct dirent64 *) ((char *) dp + sizeof (*dp));\n+      kdp = (struct kernel_dirent64 *) (((char *) kdp) + kdp->d_reclen);\n+    }\n+\n+  return (char *) dp - buf;\n+}"}]}