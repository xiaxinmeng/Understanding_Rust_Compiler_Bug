{"sha": "30253e235699f233b54f0ee147235bdec5759ac8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzAyNTNlMjM1Njk5ZjIzM2I1NGYwZWUxNDcyMzViZGVjNTc1OWFjOA==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2019-02-01T22:54:05Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2019-02-01T22:54:05Z"}, "message": "re PR fortran/83246 (internal compiler error or loader problem might be related to a PARAMETER statement being in a BLOCK)\n\n\tPR fortran/83246\n\tPR fortran/89084\n\t* trans-decl.c (generate_local_decl): Add referenced FL_PARAMETERs\n\tif sym->ns->construct_entities rather than if\n\tsym->ns->parent->code->op == EXEC_BLOCK.\n\n\t* gfortran.dg/pr89084.f90: New test.\n\t* gfortran.dg/lto/pr89084_0.f90: New test.\n\t* gfortran.dg/pr83246.f90: New test.\n\nFrom-SVN: r268462", "tree": {"sha": "2a7a21f6d8995acdeb5367648833f3ee0aeaf51b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2a7a21f6d8995acdeb5367648833f3ee0aeaf51b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/30253e235699f233b54f0ee147235bdec5759ac8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/30253e235699f233b54f0ee147235bdec5759ac8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/30253e235699f233b54f0ee147235bdec5759ac8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/30253e235699f233b54f0ee147235bdec5759ac8/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "d9f0237f70ca25485576e3f8f32d7daee6ab1d50", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d9f0237f70ca25485576e3f8f32d7daee6ab1d50", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d9f0237f70ca25485576e3f8f32d7daee6ab1d50"}], "stats": {"total": 77, "additions": 73, "deletions": 4}, "files": [{"sha": "0a5da36a601041783326281e2423123aa6c40dc5", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/30253e235699f233b54f0ee147235bdec5759ac8/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/30253e235699f233b54f0ee147235bdec5759ac8/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=30253e235699f233b54f0ee147235bdec5759ac8", "patch": "@@ -1,3 +1,11 @@\n+2019-02-01  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR fortran/83246\n+\tPR fortran/89084\n+\t* trans-decl.c (generate_local_decl): Add referenced FL_PARAMETERs\n+\tif sym->ns->construct_entities rather than if\n+\tsym->ns->parent->code->op == EXEC_BLOCK.\n+\n 2019-01-31  Thomas Koenig  <tkoenig@gcc.gnu.org>\n \n \tPR fortran/88669"}, {"sha": "b8f50f74e1a4fe4bdf490b8104fdafc905a15190", "filename": "gcc/fortran/trans-decl.c", "status": "modified", "additions": 1, "deletions": 4, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/30253e235699f233b54f0ee147235bdec5759ac8/gcc%2Ffortran%2Ftrans-decl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/30253e235699f233b54f0ee147235bdec5759ac8/gcc%2Ffortran%2Ftrans-decl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-decl.c?ref=30253e235699f233b54f0ee147235bdec5759ac8", "patch": "@@ -5735,10 +5735,7 @@ generate_local_decl (gfc_symbol * sym)\n \t\t\t  \"imported at %L\", sym->name, &sym->declared_at);\n \t}\n \n-      if (sym->ns\n-\t  && sym->ns->parent\n-\t  && sym->ns->parent->code\n-\t  && sym->ns->parent->code->op == EXEC_BLOCK)\n+      if (sym->ns && sym->ns->construct_entities)\n \t{\n \t  if (sym->attr.referenced)\n \t    gfc_get_symbol_decl (sym);"}, {"sha": "02a4b857e0e8626dcdc5aacac156e1373a8c1a45", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/30253e235699f233b54f0ee147235bdec5759ac8/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/30253e235699f233b54f0ee147235bdec5759ac8/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=30253e235699f233b54f0ee147235bdec5759ac8", "patch": "@@ -1,3 +1,11 @@\n+2019-02-01  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR fortran/83246\n+\tPR fortran/89084\n+\t* gfortran.dg/pr89084.f90: New test.\n+\t* gfortran.dg/lto/pr89084_0.f90: New test.\n+\t* gfortran.dg/pr83246.f90: New test.\n+\n 2019-02-01  Marek Polacek  <polacek@redhat.com>\n \n \tPR c++/88325 - ICE with invalid out-of-line template member definition."}, {"sha": "2c49749da21dacc122748e3ba8d9458bd126a20f", "filename": "gcc/testsuite/gfortran.dg/lto/pr89084_0.f90", "status": "added", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/30253e235699f233b54f0ee147235bdec5759ac8/gcc%2Ftestsuite%2Fgfortran.dg%2Flto%2Fpr89084_0.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/30253e235699f233b54f0ee147235bdec5759ac8/gcc%2Ftestsuite%2Fgfortran.dg%2Flto%2Fpr89084_0.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Flto%2Fpr89084_0.f90?ref=30253e235699f233b54f0ee147235bdec5759ac8", "patch": "@@ -0,0 +1,24 @@\n+! PR fortran/89084\n+! { dg-lto-do link }\n+! { dg-lto-options {{ -O0 -flto }} }\n+\n+integer function foo ()\n+  write (*,*) 'foo'\n+  block\n+    integer, parameter :: idxs(3) = (/ 1, 2, 3 /)\n+    integer :: i\n+    foo = 0\n+    do i = 1, size(idxs)\n+      foo = foo + idxs(i)\n+    enddo\n+  end block\n+end function foo\n+program pr89084\n+  integer :: i\n+  interface\n+    integer function foo ()\n+    end function\n+  end interface\n+  i = foo ()\n+  if (i.ne.6) stop 1\n+end"}, {"sha": "32097e3fd38bb8cbf706494bfc34d80118418a54", "filename": "gcc/testsuite/gfortran.dg/pr83246.f90", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/30253e235699f233b54f0ee147235bdec5759ac8/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr83246.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/30253e235699f233b54f0ee147235bdec5759ac8/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr83246.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr83246.f90?ref=30253e235699f233b54f0ee147235bdec5759ac8", "patch": "@@ -0,0 +1,9 @@\n+! PR fortran/83246\n+! { dg-do link }\n+   program dusty_corner \n+   write(*,*)'BLOCK TESTS' \n+   MAKEDATAP: block\n+   integer,parameter :: scratch(*)=[1,2,3]\n+   write(*,*)scratch\n+   endblock MAKEDATAP\n+   end program dusty_corner"}, {"sha": "3ac6b37999e1716ca438732c8f8c68573c35bc19", "filename": "gcc/testsuite/gfortran.dg/pr89084.f90", "status": "added", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/30253e235699f233b54f0ee147235bdec5759ac8/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr89084.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/30253e235699f233b54f0ee147235bdec5759ac8/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr89084.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr89084.f90?ref=30253e235699f233b54f0ee147235bdec5759ac8", "patch": "@@ -0,0 +1,23 @@\n+! PR fortran/89084\n+! { dg-do run }\n+\n+integer function foo ()\n+  write (*,*) 'foo'\n+  block\n+    integer, parameter :: idxs(3) = (/ 1, 2, 3 /)\n+    integer :: i\n+    foo = 0\n+    do i = 1, size(idxs)\n+      foo = foo + idxs(i)\n+    enddo\n+  end block\n+end function foo\n+program pr89084\n+  integer :: i\n+  interface\n+    integer function foo ()\n+    end function\n+  end interface\n+  i = foo ()\n+  if (i.ne.6) stop 1\n+end"}]}