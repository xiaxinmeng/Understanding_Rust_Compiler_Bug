{"sha": "ffe5d70808b73597acd5b7a249aedefaf2ce8863", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZmZlNWQ3MDgwOGI3MzU5N2FjZDViN2EyNDlhZWRlZmFmMmNlODg2Mw==", "commit": {"author": {"name": "Steven Bosscher", "email": "steven@gcc.gnu.org", "date": "2012-03-26T16:35:59Z"}, "committer": {"name": "Steven Bosscher", "email": "steven@gcc.gnu.org", "date": "2012-03-26T16:35:59Z"}, "message": "varasm.c (assemble_external): Assert this function is only called during or after expanding to RTL.\n\n\t* varasm.c (assemble_external): Assert this function is only called\n\tduring or after expanding to RTL.\n\nFrom-SVN: r185812", "tree": {"sha": "4d8ef73432939ab23974a48757410751072dd8af", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4d8ef73432939ab23974a48757410751072dd8af"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ffe5d70808b73597acd5b7a249aedefaf2ce8863", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ffe5d70808b73597acd5b7a249aedefaf2ce8863", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ffe5d70808b73597acd5b7a249aedefaf2ce8863", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ffe5d70808b73597acd5b7a249aedefaf2ce8863/comments", "author": null, "committer": null, "parents": [{"sha": "0a7d0933455b91fbd94f809335abaf07b2cdf508", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0a7d0933455b91fbd94f809335abaf07b2cdf508", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0a7d0933455b91fbd94f809335abaf07b2cdf508"}], "stats": {"total": 19, "additions": 15, "deletions": 4}, "files": [{"sha": "c1628b73dc5eb14258695893d1a410f12a8a93ee", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ffe5d70808b73597acd5b7a249aedefaf2ce8863/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ffe5d70808b73597acd5b7a249aedefaf2ce8863/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=ffe5d70808b73597acd5b7a249aedefaf2ce8863", "patch": "@@ -1,3 +1,8 @@\n+2012-03-26  Steven Bosscher  <steven@gcc.gnu.org>\n+\n+\t* varasm.c (assemble_external): Assert this function is only called\n+\tduring or after expanding to RTL.\n+\n 2012-03-26  Martin Jambor  <mjambor@suse.cz>\n \n \tPR tree-optimization/50052"}, {"sha": "26f22ddcb1c8dc29eac318b104ae87958ae6cfb1", "filename": "gcc/varasm.c", "status": "modified", "additions": 10, "deletions": 4, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ffe5d70808b73597acd5b7a249aedefaf2ce8863/gcc%2Fvarasm.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ffe5d70808b73597acd5b7a249aedefaf2ce8863/gcc%2Fvarasm.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fvarasm.c?ref=ffe5d70808b73597acd5b7a249aedefaf2ce8863", "patch": "@@ -2166,12 +2166,18 @@ static GTY(()) tree weak_decls;\n void\n assemble_external (tree decl ATTRIBUTE_UNUSED)\n {\n-  /* Because most platforms do not define ASM_OUTPUT_EXTERNAL, the\n-     main body of this code is only rarely exercised.  To provide some\n-     testing, on all platforms, we make sure that the ASM_OUT_FILE is\n-     open.  If it's not, we should not be calling this function.  */\n+  /*  Make sure that the ASM_OUT_FILE is open.\n+      If it's not, we should not be calling this function.  */\n   gcc_assert (asm_out_file);\n \n+  /* This function should only be called if we are expanding, or have\n+     expanded, to RTL.\n+     Ideally, only final.c would be calling this function, but it is\n+     not clear whether that would break things somehow.  See PR 17982\n+     for further discussion.  */\n+  gcc_assert (cgraph_state == CGRAPH_STATE_EXPANSION\n+\t      || cgraph_state == CGRAPH_STATE_FINISHED);\n+\n   if (!DECL_P (decl) || !DECL_EXTERNAL (decl) || !TREE_PUBLIC (decl))\n     return;\n "}]}