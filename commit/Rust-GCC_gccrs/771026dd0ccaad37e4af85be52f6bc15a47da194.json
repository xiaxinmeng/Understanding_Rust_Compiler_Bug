{"sha": "771026dd0ccaad37e4af85be52f6bc15a47da194", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzcxMDI2ZGQwY2NhYWQzN2U0YWY4NWJlNTJmNmJjMTVhNDdkYTE5NA==", "commit": {"author": {"name": "Douglas Gregor", "email": "doug.gregor@gmail.com", "date": "2007-03-28T12:31:37Z"}, "committer": {"name": "Doug Gregor", "email": "dgregor@gcc.gnu.org", "date": "2007-03-28T12:31:37Z"}, "message": "[multiple changes]\n\n2007-03-28 Douglas Gregor <doug.gregor@gmail.com>\n\n\tPR c++/29993\n\t* decl.c (grokdeclarator): Deal with cv-qualified function type\n\ttypedefs in the same way for member and non-member functions.\n\n2007-03-28  Douglas Gregor  <doug.gregor@gmail.com>\n\n\n\tPR c++/29993\n\t* g++.dg/other/cv_func2.C: New.\n\nFrom-SVN: r123294", "tree": {"sha": "ef14ed66fcc9bf60ceb65618d216f1c72fa7413e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ef14ed66fcc9bf60ceb65618d216f1c72fa7413e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/771026dd0ccaad37e4af85be52f6bc15a47da194", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/771026dd0ccaad37e4af85be52f6bc15a47da194", "html_url": "https://github.com/Rust-GCC/gccrs/commit/771026dd0ccaad37e4af85be52f6bc15a47da194", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/771026dd0ccaad37e4af85be52f6bc15a47da194/comments", "author": {"login": "DougGregor", "id": 989428, "node_id": "MDQ6VXNlcjk4OTQyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/989428?v=4", "gravatar_id": "", "url": "https://api.github.com/users/DougGregor", "html_url": "https://github.com/DougGregor", "followers_url": "https://api.github.com/users/DougGregor/followers", "following_url": "https://api.github.com/users/DougGregor/following{/other_user}", "gists_url": "https://api.github.com/users/DougGregor/gists{/gist_id}", "starred_url": "https://api.github.com/users/DougGregor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/DougGregor/subscriptions", "organizations_url": "https://api.github.com/users/DougGregor/orgs", "repos_url": "https://api.github.com/users/DougGregor/repos", "events_url": "https://api.github.com/users/DougGregor/events{/privacy}", "received_events_url": "https://api.github.com/users/DougGregor/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "27a0ce7d429e72c249e8cadd47bbfba127ea1b98", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/27a0ce7d429e72c249e8cadd47bbfba127ea1b98", "html_url": "https://github.com/Rust-GCC/gccrs/commit/27a0ce7d429e72c249e8cadd47bbfba127ea1b98"}], "stats": {"total": 42, "additions": 36, "deletions": 6}, "files": [{"sha": "7541770c57959be6a3bb75ccb27363613e13d51a", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/771026dd0ccaad37e4af85be52f6bc15a47da194/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/771026dd0ccaad37e4af85be52f6bc15a47da194/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=771026dd0ccaad37e4af85be52f6bc15a47da194", "patch": "@@ -1,3 +1,9 @@\n+2007-03-28 Douglas Gregor <doug.gregor@gmail.com>\n+\n+\tPR c++/29993\n+\t* decl.c (grokdeclarator): Deal with cv-qualified function type\n+\ttypedefs in the same way for member and non-member functions.\n+\n 2007-03-26  Dirk Mueller  <dmueller@suse.de>\n \n \t* parser.c (cp_parser_member_declaration): Pedwarn"}, {"sha": "f107bee73ebd4cb156a97c2578f4a780e8942ab8", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/771026dd0ccaad37e4af85be52f6bc15a47da194/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/771026dd0ccaad37e4af85be52f6bc15a47da194/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=771026dd0ccaad37e4af85be52f6bc15a47da194", "patch": "@@ -8029,7 +8029,12 @@ grokdeclarator (const cp_declarator *declarator,\n \t member function of S.  We record the cv-qualification in the\n \t function type.  */\n       if (memfn_quals && TREE_CODE (type) == FUNCTION_TYPE)\n-\ttype = cp_build_qualified_type (type, memfn_quals);\n+        {\n+          type = cp_build_qualified_type (type, memfn_quals);\n+          \n+          /* We have now dealt with these qualifiers.  */\n+          memfn_quals = TYPE_UNQUALIFIED;\n+        }\n \n       if (decl_context == FIELD)\n \tdecl = build_lang_decl (TYPE_DECL, unqualified_id, type);\n@@ -8091,11 +8096,6 @@ grokdeclarator (const cp_declarator *declarator,\n \t     type with external linkage have external linkage.  */\n \t}\n \n-\t/* Any qualifiers on a function type typedef have already been\n-\t   dealt with. */\n-      if (memfn_quals && !ctype && TREE_CODE (type) == FUNCTION_TYPE)\n-\tmemfn_quals = TYPE_UNQUALIFIED;\n-\n       if (signed_p\n \t  || (typedef_decl && C_TYPEDEF_EXPLICITLY_SIGNED (typedef_decl)))\n \tC_TYPEDEF_EXPLICITLY_SIGNED (decl) = 1;"}, {"sha": "442ea61e1c1413f64e9d992c3f8f2ba267b56544", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/771026dd0ccaad37e4af85be52f6bc15a47da194/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/771026dd0ccaad37e4af85be52f6bc15a47da194/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=771026dd0ccaad37e4af85be52f6bc15a47da194", "patch": "@@ -1,3 +1,9 @@\n+2007-03-28  Douglas Gregor  <doug.gregor@gmail.com>\n+\n+\n+\tPR c++/29993\n+\t* g++.dg/other/cv_func2.C: New.\n+\t\n 2007-03-27  Janis Johnson  <janis187@us.ibm.com>\n \n \t* gcc.dg/dfp/func-vararg-alternate.h: New file."}, {"sha": "ffd249fc807e032836e85a58eb301da2400c9bc7", "filename": "gcc/testsuite/g++.dg/other/cv_func2.C", "status": "added", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/771026dd0ccaad37e4af85be52f6bc15a47da194/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fcv_func2.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/771026dd0ccaad37e4af85be52f6bc15a47da194/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fcv_func2.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fcv_func2.C?ref=771026dd0ccaad37e4af85be52f6bc15a47da194", "patch": "@@ -0,0 +1,18 @@\n+typedef int ptr1() const; // no error\n+\n+void foo ()\n+{\n+  typedef int ptr2() const; // no error\n+}\n+\n+class C\n+{\n+    typedef int ptr3() const;  // error\n+\n+    void bar ()\n+      {\n+        typedef int ptr4() const; // no error\n+      }  \n+};\n+\n+void wibble () const { } // { dg-error \"non-member function\" }"}]}