{"sha": "fcddd80e2efd57253335eb33d4e35fb47a4a0e20", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZmNkZGQ4MGUyZWZkNTcyNTMzMzVlYjMzZDRlMzVmYjQ3YTRhMGUyMA==", "commit": {"author": {"name": "Richard Guenther", "email": "rguenther@suse.de", "date": "2012-08-02T09:43:14Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2012-08-02T09:43:14Z"}, "message": "re PR tree-optimization/50672 (ice: verify_ssa failed: no immediate_use list)\n\n2012-08-02  Richard Guenther  <rguenther@suse.de>\n\n\tPR tree-optimization/50672\n\tRevert\n\t2012-08-01  Richard Guenther  <rguenther@suse.de>\n\n\t* tree-ssa-tail-merge.c (release_last_vdef): Remove.\n\t(replace_block_by): Adjust.\n\n\t* g++.dg/torture/pr50672.C: New testcase.\n\nFrom-SVN: r190070", "tree": {"sha": "6eb8077b726a7da082b816374813da18c0ff6f41", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6eb8077b726a7da082b816374813da18c0ff6f41"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/fcddd80e2efd57253335eb33d4e35fb47a4a0e20", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fcddd80e2efd57253335eb33d4e35fb47a4a0e20", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fcddd80e2efd57253335eb33d4e35fb47a4a0e20", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fcddd80e2efd57253335eb33d4e35fb47a4a0e20/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "b6a45605019bfe2fe588961c6959630f8b9deed0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b6a45605019bfe2fe588961c6959630f8b9deed0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b6a45605019bfe2fe588961c6959630f8b9deed0"}], "stats": {"total": 68, "additions": 68, "deletions": 0}, "files": [{"sha": "1f6539ed59718e26154cb0dab85667ed08ae3b87", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fcddd80e2efd57253335eb33d4e35fb47a4a0e20/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fcddd80e2efd57253335eb33d4e35fb47a4a0e20/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=fcddd80e2efd57253335eb33d4e35fb47a4a0e20", "patch": "@@ -1,3 +1,12 @@\n+2012-08-02  Richard Guenther  <rguenther@suse.de>\n+\n+\tPR tree-optimization/50672\n+\tRevert\n+\t2012-08-01  Richard Guenther  <rguenther@suse.de>\n+\n+\t* tree-ssa-tail-merge.c (release_last_vdef): Remove.\n+\t(replace_block_by): Adjust.\n+\n 2012-08-02  Richard Guenther  <rguenther@suse.de>\n \n \t* tree-dfa.c (referenced_var_lookup): Remove."}, {"sha": "3941926ab499e56b8311e57607fd93791ce0e95e", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fcddd80e2efd57253335eb33d4e35fb47a4a0e20/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fcddd80e2efd57253335eb33d4e35fb47a4a0e20/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=fcddd80e2efd57253335eb33d4e35fb47a4a0e20", "patch": "@@ -1,3 +1,8 @@\n+2012-08-02  Richard Guenther  <rguenther@suse.de>\n+\n+\tPR tree-optimization/50672\n+\t* g++.dg/torture/pr50672.C: New testcase.\n+\n 2012-08-02  Janus Weil  <janus@gcc.gnu.org>\n \n \tPR fortran/54147"}, {"sha": "614a35b6c8243f2ad7ffa6e0c25c564c0393ce3c", "filename": "gcc/testsuite/g++.dg/torture/pr50672.C", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fcddd80e2efd57253335eb33d4e35fb47a4a0e20/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftorture%2Fpr50672.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fcddd80e2efd57253335eb33d4e35fb47a4a0e20/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftorture%2Fpr50672.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftorture%2Fpr50672.C?ref=fcddd80e2efd57253335eb33d4e35fb47a4a0e20", "patch": "@@ -0,0 +1,22 @@\n+// { dg-do compile }\n+\n+struct A\n+{\n+  bool isHint();\n+};\n+class B\n+{\n+  void makeLine( int *) const;\n+  void drawLine() const; A* to() const;\n+  void _print() const;\n+};\n+A a;\n+void  B::makeLine(int *p1) const\n+{\n+  if (a.isHint() && to()->isHint()) ;\n+  else {\n+      if (p1) B::drawLine(); else B::_print();\n+      return;\n+  }\n+  if (p1) B::drawLine(); else B::_print();\n+}"}, {"sha": "a2d4633e99344a6bc9298bcb371ec64be6261429", "filename": "gcc/tree-ssa-tail-merge.c", "status": "modified", "additions": 32, "deletions": 0, "changes": 32, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fcddd80e2efd57253335eb33d4e35fb47a4a0e20/gcc%2Ftree-ssa-tail-merge.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fcddd80e2efd57253335eb33d4e35fb47a4a0e20/gcc%2Ftree-ssa-tail-merge.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-tail-merge.c?ref=fcddd80e2efd57253335eb33d4e35fb47a4a0e20", "patch": "@@ -812,6 +812,37 @@ same_succ_flush_bbs (bitmap bbs)\n     same_succ_flush_bb (BASIC_BLOCK (i));\n }\n \n+/* Release the last vdef in BB, either normal or phi result.  */\n+\n+static void\n+release_last_vdef (basic_block bb)\n+{\n+  gimple_stmt_iterator i;\n+\n+  for (i = gsi_last_bb (bb); !gsi_end_p (i); gsi_prev_nondebug (&i))\n+    {\n+      gimple stmt = gsi_stmt (i);\n+      if (gimple_vdef (stmt) == NULL_TREE)\n+\tcontinue;\n+\n+      mark_virtual_operand_for_renaming (gimple_vdef (stmt));\n+      return;\n+    }\n+\n+  for (i = gsi_start_phis (bb); !gsi_end_p (i); gsi_next (&i))\n+    {\n+      gimple phi = gsi_stmt (i);\n+      tree res = gimple_phi_result (phi);\n+\n+      if (is_gimple_reg (res))\n+\tcontinue;\n+\n+      mark_virtual_phi_result_for_renaming (phi);\n+      return;\n+    }\n+  \n+}\n+\n /* For deleted_bb_preds, find bbs with same successors.  */\n \n static void\n@@ -1446,6 +1477,7 @@ replace_block_by (basic_block bb1, basic_block bb2)\n   bb1->frequency = 0;\n \n   /* Do updates that use bb1, before deleting bb1.  */\n+  release_last_vdef (bb1);\n   same_succ_flush_bb (bb1);\n \n   delete_basic_block (bb1);"}]}