{"sha": "c34f4fbcc450474885baede3d5de8dcfcb9f103f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzM0ZjRmYmNjNDUwNDc0ODg1YmFlZGUzZDVkZThkY2ZjYjlmMTAzZg==", "commit": {"author": {"name": "Thomas Schwinge", "email": "thomas@codesourcery.com", "date": "2018-11-30T20:39:08Z"}, "committer": {"name": "Thomas Schwinge", "email": "tschwinge@gcc.gnu.org", "date": "2018-11-30T20:39:08Z"}, "message": "Support multiple OpenACC wait clauses\n\nSupport for this is not explicitly called for in OpenACC 2.6, but given that\nGCC internally decomposes \"wait (1, 2)\" into \"wait (1) wait (2)\" (similar for\nother clauses, too), it's reasonable to also support that syntax in the front\nends -- which happens to already be the case for C, C++, and easy enough to do\nfor Fortran.\n\n\tgcc/fortran/\n\t* openmp.c (gfc_match_omp_clauses): Support multiple OpenACC wait\n\tclauses.\n\tgcc/testsuite/\n\t* c-c++-common/goacc/asyncwait-5.c: New file.\n\t* gfortran.dg/goacc/asyncwait-5.f: Likewise.\n\nFrom-SVN: r266684", "tree": {"sha": "df2b9c7efec72adce3fd92fcb00a3e0eec0d834f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/df2b9c7efec72adce3fd92fcb00a3e0eec0d834f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c34f4fbcc450474885baede3d5de8dcfcb9f103f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c34f4fbcc450474885baede3d5de8dcfcb9f103f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c34f4fbcc450474885baede3d5de8dcfcb9f103f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c34f4fbcc450474885baede3d5de8dcfcb9f103f/comments", "author": {"login": "tschwinge", "id": 21753, "node_id": "MDQ6VXNlcjIxNzUz", "avatar_url": "https://avatars.githubusercontent.com/u/21753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tschwinge", "html_url": "https://github.com/tschwinge", "followers_url": "https://api.github.com/users/tschwinge/followers", "following_url": "https://api.github.com/users/tschwinge/following{/other_user}", "gists_url": "https://api.github.com/users/tschwinge/gists{/gist_id}", "starred_url": "https://api.github.com/users/tschwinge/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tschwinge/subscriptions", "organizations_url": "https://api.github.com/users/tschwinge/orgs", "repos_url": "https://api.github.com/users/tschwinge/repos", "events_url": "https://api.github.com/users/tschwinge/events{/privacy}", "received_events_url": "https://api.github.com/users/tschwinge/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "c223608f542416a5e47685013c680e256a583416", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c223608f542416a5e47685013c680e256a583416", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c223608f542416a5e47685013c680e256a583416"}], "stats": {"total": 38, "additions": 37, "deletions": 1}, "files": [{"sha": "435ecf82f9706a007bc393ca90fafb13aecc952f", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c34f4fbcc450474885baede3d5de8dcfcb9f103f/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c34f4fbcc450474885baede3d5de8dcfcb9f103f/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=c34f4fbcc450474885baede3d5de8dcfcb9f103f", "patch": "@@ -1,3 +1,8 @@\n+2018-11-30  Thomas Schwinge  <thomas@codesourcery.com>\n+\n+\t* openmp.c (gfc_match_omp_clauses): Support multiple OpenACC wait\n+\tclauses.\n+\n 2018-11-27  Martin Liska  <mliska@suse.cz>\n \n \t* decl.c (gfc_match_gcc_builtin): New function."}, {"sha": "e1560c1fe37297cf111627fbbdc81919a7e5dc91", "filename": "gcc/fortran/openmp.c", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c34f4fbcc450474885baede3d5de8dcfcb9f103f/gcc%2Ffortran%2Fopenmp.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c34f4fbcc450474885baede3d5de8dcfcb9f103f/gcc%2Ffortran%2Fopenmp.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fopenmp.c?ref=c34f4fbcc450474885baede3d5de8dcfcb9f103f", "patch": "@@ -1876,7 +1876,6 @@ gfc_match_omp_clauses (gfc_omp_clauses **cp, const omp_mask mask,\n \t  break;\n \tcase 'w':\n \t  if ((mask & OMP_CLAUSE_WAIT)\n-\t      && !c->wait\n \t      && gfc_match (\"wait\") == MATCH_YES)\n \t    {\n \t      c->wait = true;"}, {"sha": "75ca70b4af2829d251f23ca2d94b4f3a71ccca5a", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c34f4fbcc450474885baede3d5de8dcfcb9f103f/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c34f4fbcc450474885baede3d5de8dcfcb9f103f/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=c34f4fbcc450474885baede3d5de8dcfcb9f103f", "patch": "@@ -1,3 +1,8 @@\n+2018-11-30  Thomas Schwinge  <thomas@codesourcery.com>\n+\n+\t* c-c++-common/goacc/asyncwait-5.c: New file.\n+\t* gfortran.dg/goacc/asyncwait-5.f: Likewise.\n+\n 2018-11-30  Peter Bergner  <bergner@linux.ibm.com>\n \n \tPR target/87496"}, {"sha": "fe6f8a0cf2da7f98fac259fbf25f0263a48cfe86", "filename": "gcc/testsuite/c-c++-common/goacc/asyncwait-5.c", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c34f4fbcc450474885baede3d5de8dcfcb9f103f/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fgoacc%2Fasyncwait-5.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c34f4fbcc450474885baede3d5de8dcfcb9f103f/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fgoacc%2Fasyncwait-5.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fgoacc%2Fasyncwait-5.c?ref=c34f4fbcc450474885baede3d5de8dcfcb9f103f", "patch": "@@ -0,0 +1,14 @@\n+/* Multiple OpenACC wait clauses.  */\n+\n+/* { dg-additional-options \"-fdump-tree-original\" } */\n+\n+void f()\n+{\n+#pragma acc parallel async (1) wait (14)\n+  ;\n+  /* { dg-final { scan-tree-dump-times \"(?n)#pragma acc parallel wait\\\\(14\\\\) async\\\\(1\\\\)$\" 1 \"original\" } } */\n+\n+#pragma acc parallel async (2) wait (11, 12) wait (13)\n+  ;\n+  /* { dg-final { scan-tree-dump-times \"(?n)#pragma acc parallel wait\\\\(13\\\\) wait\\\\(12\\\\) wait\\\\(11\\\\) async\\\\(2\\\\)\\$\" 1 \"original\" } } */\n+}"}, {"sha": "59b886343af6af318575031f19130c7063ae069d", "filename": "gcc/testsuite/gfortran.dg/goacc/asyncwait-5.f", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c34f4fbcc450474885baede3d5de8dcfcb9f103f/gcc%2Ftestsuite%2Fgfortran.dg%2Fgoacc%2Fasyncwait-5.f", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c34f4fbcc450474885baede3d5de8dcfcb9f103f/gcc%2Ftestsuite%2Fgfortran.dg%2Fgoacc%2Fasyncwait-5.f", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fgoacc%2Fasyncwait-5.f?ref=c34f4fbcc450474885baede3d5de8dcfcb9f103f", "patch": "@@ -0,0 +1,13 @@\n+! Multiple OpenACC wait clauses.\n+\n+! { dg-additional-options \"-fdump-tree-original\" } \n+\n+!$ACC PARALLEL ASYNC (1) WAIT (14)\n+!$ACC END PARALLEL\n+! { dg-final { scan-tree-dump-times \"(?n)#pragma acc parallel async\\\\(1\\\\) wait\\\\(14\\\\)$\" 1 \"original\" } }\n+\n+!$ACC PARALLEL ASYNC (2) WAIT (11, 12) WAIT(13)\n+!$ACC END PARALLEL\n+! { dg-final { scan-tree-dump-times \"(?n)#pragma acc parallel async\\\\(2\\\\) wait\\\\(11\\\\) wait\\\\(12\\\\) wait\\\\(13\\\\)$\" 1 \"original\" } }\n+\n+      END"}]}