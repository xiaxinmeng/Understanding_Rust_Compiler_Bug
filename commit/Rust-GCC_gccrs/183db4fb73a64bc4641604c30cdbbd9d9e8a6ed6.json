{"sha": "183db4fb73a64bc4641604c30cdbbd9d9e8a6ed6", "node_id": "C_kwDOANBUbNoAKDE4M2RiNGZiNzNhNjRiYzQ2NDE2MDRjMzBjZGJiZDlkOWU4YTZlZDY", "commit": {"author": {"name": "liuhongt", "email": "hongtao.liu@intel.com", "date": "2022-11-17T08:19:31Z"}, "committer": {"name": "liuhongt", "email": "hongtao.liu@intel.com", "date": "2022-11-21T01:05:38Z"}, "message": "define builtins for \"shared\" avxneconvert-avx512bf16vl builtins.\n\nThis should fix incorrect error when call those builtin with\n-mavxneconvert and w/o -mavx512bf16 -mavx512vl.\n\ngcc/ChangeLog:\n\n\t* config/i386/i386-builtins.cc (def_builtin): Handle \"shared\"\n\tavx512bf16vl-avxneconvert builtins.\n\ngcc/testsuite/ChangeLog:\n\n\t* gcc.target/i386/avxneconvert-1.c: New test.", "tree": {"sha": "0a769ce745ae20f457f132f0316e26cfa38462a1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0a769ce745ae20f457f132f0316e26cfa38462a1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/183db4fb73a64bc4641604c30cdbbd9d9e8a6ed6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/183db4fb73a64bc4641604c30cdbbd9d9e8a6ed6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/183db4fb73a64bc4641604c30cdbbd9d9e8a6ed6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/183db4fb73a64bc4641604c30cdbbd9d9e8a6ed6/comments", "author": {"login": "algebra84", "id": 22926165, "node_id": "MDQ6VXNlcjIyOTI2MTY1", "avatar_url": "https://avatars.githubusercontent.com/u/22926165?v=4", "gravatar_id": "", "url": "https://api.github.com/users/algebra84", "html_url": "https://github.com/algebra84", "followers_url": "https://api.github.com/users/algebra84/followers", "following_url": "https://api.github.com/users/algebra84/following{/other_user}", "gists_url": "https://api.github.com/users/algebra84/gists{/gist_id}", "starred_url": "https://api.github.com/users/algebra84/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/algebra84/subscriptions", "organizations_url": "https://api.github.com/users/algebra84/orgs", "repos_url": "https://api.github.com/users/algebra84/repos", "events_url": "https://api.github.com/users/algebra84/events{/privacy}", "received_events_url": "https://api.github.com/users/algebra84/received_events", "type": "User", "site_admin": false}, "committer": {"login": "algebra84", "id": 22926165, "node_id": "MDQ6VXNlcjIyOTI2MTY1", "avatar_url": "https://avatars.githubusercontent.com/u/22926165?v=4", "gravatar_id": "", "url": "https://api.github.com/users/algebra84", "html_url": "https://github.com/algebra84", "followers_url": "https://api.github.com/users/algebra84/followers", "following_url": "https://api.github.com/users/algebra84/following{/other_user}", "gists_url": "https://api.github.com/users/algebra84/gists{/gist_id}", "starred_url": "https://api.github.com/users/algebra84/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/algebra84/subscriptions", "organizations_url": "https://api.github.com/users/algebra84/orgs", "repos_url": "https://api.github.com/users/algebra84/repos", "events_url": "https://api.github.com/users/algebra84/events{/privacy}", "received_events_url": "https://api.github.com/users/algebra84/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "fb98ede8ca007d5f7c1d3208f22b3094e2802702", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fb98ede8ca007d5f7c1d3208f22b3094e2802702", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fb98ede8ca007d5f7c1d3208f22b3094e2802702"}], "stats": {"total": 13, "additions": 13, "deletions": 0}, "files": [{"sha": "eacdf072244e00373391999276fe21ea1d31f4ac", "filename": "gcc/config/i386/i386-builtins.cc", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/183db4fb73a64bc4641604c30cdbbd9d9e8a6ed6/gcc%2Fconfig%2Fi386%2Fi386-builtins.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/183db4fb73a64bc4641604c30cdbbd9d9e8a6ed6/gcc%2Fconfig%2Fi386%2Fi386-builtins.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386-builtins.cc?ref=183db4fb73a64bc4641604c30cdbbd9d9e8a6ed6", "patch": "@@ -285,6 +285,8 @@ def_builtin (HOST_WIDE_INT mask, HOST_WIDE_INT mask2,\n \t     avx512vl exist.  */\n \t  || (mask2 == OPTION_MASK_ISA2_AVXVNNI)\n \t  || (mask2 == OPTION_MASK_ISA2_AVXIFMA)\n+\t  || (mask2 == (OPTION_MASK_ISA2_AVXNECONVERT\n+\t\t\t| OPTION_MASK_ISA2_AVX512BF16))\n \t  || (lang_hooks.builtin_function\n \t      == lang_hooks.builtin_function_ext_scope))\n \t{"}, {"sha": "2bb129c3f724f8f8a928ba230980f783faa2782d", "filename": "gcc/testsuite/gcc.target/i386/avxneconvert-1.c", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/183db4fb73a64bc4641604c30cdbbd9d9e8a6ed6/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Favxneconvert-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/183db4fb73a64bc4641604c30cdbbd9d9e8a6ed6/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Favxneconvert-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Favxneconvert-1.c?ref=183db4fb73a64bc4641604c30cdbbd9d9e8a6ed6", "patch": "@@ -0,0 +1,11 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-mavxneconvert -O2\" } */\n+\n+typedef float v8sf __attribute__((vector_size(32)));\n+typedef __bf16 v8bf __attribute__((vector_size(16)));\n+\n+v8bf\n+foo (v8sf a)\n+{\n+  return __builtin_ia32_cvtneps2bf16_v8sf (a);\n+}"}]}