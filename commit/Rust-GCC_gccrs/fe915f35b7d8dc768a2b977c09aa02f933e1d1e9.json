{"sha": "fe915f35b7d8dc768a2b977c09aa02f933e1d1e9", "node_id": "C_kwDOANBUbNoAKGZlOTE1ZjM1YjdkOGRjNzY4YTJiOTc3YzA5YWEwMmY5MzNlMWQxZTk", "commit": {"author": {"name": "Marek Polacek", "email": "polacek@redhat.com", "date": "2022-08-29T20:54:05Z"}, "committer": {"name": "Marek Polacek", "email": "polacek@redhat.com", "date": "2022-08-30T13:05:29Z"}, "message": "c++: __has_builtin gives the wrong answer [PR106759]\n\nWe've supported __is_nothrow_constructible since r11-4386, but\nnames_builtin_p didn't know about it, so it gave the wrong answer for\n #if __has_builtin(__is_nothrow_constructible)\n ...\n #endif\n\nI've tested all C++-only built-ins and only two were missing.\n\n\tPR c++/106759\n\ngcc/cp/ChangeLog:\n\n\t* cp-objcp-common.cc (names_builtin_p): Handle RID_IS_NOTHROW_ASSIGNABLE\n\tand RID_IS_NOTHROW_CONSTRUCTIBLE.\n\ngcc/testsuite/ChangeLog:\n\n\t* g++.dg/ext/has-builtin-1.C: New test.", "tree": {"sha": "d8a5538a61cc4de4e1ac9e3ff6073d55d9d08ada", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d8a5538a61cc4de4e1ac9e3ff6073d55d9d08ada"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/fe915f35b7d8dc768a2b977c09aa02f933e1d1e9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fe915f35b7d8dc768a2b977c09aa02f933e1d1e9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fe915f35b7d8dc768a2b977c09aa02f933e1d1e9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fe915f35b7d8dc768a2b977c09aa02f933e1d1e9/comments", "author": {"login": "mpolacek", "id": 10496300, "node_id": "MDQ6VXNlcjEwNDk2MzAw", "avatar_url": "https://avatars.githubusercontent.com/u/10496300?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mpolacek", "html_url": "https://github.com/mpolacek", "followers_url": "https://api.github.com/users/mpolacek/followers", "following_url": "https://api.github.com/users/mpolacek/following{/other_user}", "gists_url": "https://api.github.com/users/mpolacek/gists{/gist_id}", "starred_url": "https://api.github.com/users/mpolacek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mpolacek/subscriptions", "organizations_url": "https://api.github.com/users/mpolacek/orgs", "repos_url": "https://api.github.com/users/mpolacek/repos", "events_url": "https://api.github.com/users/mpolacek/events{/privacy}", "received_events_url": "https://api.github.com/users/mpolacek/received_events", "type": "User", "site_admin": false}, "committer": {"login": "mpolacek", "id": 10496300, "node_id": "MDQ6VXNlcjEwNDk2MzAw", "avatar_url": "https://avatars.githubusercontent.com/u/10496300?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mpolacek", "html_url": "https://github.com/mpolacek", "followers_url": "https://api.github.com/users/mpolacek/followers", "following_url": "https://api.github.com/users/mpolacek/following{/other_user}", "gists_url": "https://api.github.com/users/mpolacek/gists{/gist_id}", "starred_url": "https://api.github.com/users/mpolacek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mpolacek/subscriptions", "organizations_url": "https://api.github.com/users/mpolacek/orgs", "repos_url": "https://api.github.com/users/mpolacek/repos", "events_url": "https://api.github.com/users/mpolacek/events{/privacy}", "received_events_url": "https://api.github.com/users/mpolacek/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7e3f18439904bf26eabc658caf843b297a052eb4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7e3f18439904bf26eabc658caf843b297a052eb4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7e3f18439904bf26eabc658caf843b297a052eb4"}], "stats": {"total": 135, "additions": 135, "deletions": 0}, "files": [{"sha": "1ffac08c32f61889650c6eb38844978e63b92040", "filename": "gcc/cp/cp-objcp-common.cc", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fe915f35b7d8dc768a2b977c09aa02f933e1d1e9/gcc%2Fcp%2Fcp-objcp-common.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fe915f35b7d8dc768a2b977c09aa02f933e1d1e9/gcc%2Fcp%2Fcp-objcp-common.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fcp-objcp-common.cc?ref=fe915f35b7d8dc768a2b977c09aa02f933e1d1e9", "patch": "@@ -460,6 +460,8 @@ names_builtin_p (const char *name)\n     case RID_IS_UNION:\n     case RID_IS_ASSIGNABLE:\n     case RID_IS_CONSTRUCTIBLE:\n+    case RID_IS_NOTHROW_ASSIGNABLE:\n+    case RID_IS_NOTHROW_CONSTRUCTIBLE:\n     case RID_UNDERLYING_TYPE:\n     case RID_REF_CONSTRUCTS_FROM_TEMPORARY:\n     case RID_REF_CONVERTS_FROM_TEMPORARY:"}, {"sha": "fe25cb2f669b6a80f0fbcda581a2c67a02396187", "filename": "gcc/testsuite/g++.dg/ext/has-builtin-1.C", "status": "added", "additions": 133, "deletions": 0, "changes": 133, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fe915f35b7d8dc768a2b977c09aa02f933e1d1e9/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fhas-builtin-1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fe915f35b7d8dc768a2b977c09aa02f933e1d1e9/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fhas-builtin-1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fhas-builtin-1.C?ref=fe915f35b7d8dc768a2b977c09aa02f933e1d1e9", "patch": "@@ -0,0 +1,133 @@\n+// PR c++/106759\n+// { dg-do compile }\n+// Verify that __has_builtin gives the correct answer for C++ built-ins.\n+\n+#if !__has_builtin (__builtin_addressof)\n+# error \"__has_builtin (__builtin_addressof) failed\"\n+#endif\n+#if !__has_builtin (__builtin_bit_cast)\n+# error \"__has_builtin (__builtin_bit_cast) failed\"\n+#endif\n+#if !__has_builtin (__builtin_launder)\n+# error \"__has_builtin (__builtin_launder) failed\"\n+#endif\n+#if !__has_builtin (__has_nothrow_assign)\n+# error \"__has_builtin (__has_nothrow_assign) failed\"\n+#endif\n+#if !__has_builtin (__has_nothrow_constructor)\n+# error \"__has_builtin (__has_nothrow_constructor) failed\"\n+#endif\n+#if !__has_builtin (__has_nothrow_copy)\n+# error \"__has_builtin (__has_nothrow_copy) failed\"\n+#endif\n+#if !__has_builtin (__has_trivial_assign)\n+# error \"__has_builtin (__has_trivial_assign) failed\"\n+#endif\n+#if !__has_builtin (__has_trivial_constructor)\n+# error \"__has_builtin (__has_trivial_constructor) failed\"\n+#endif\n+#if !__has_builtin (__has_trivial_copy)\n+# error \"__has_builtin (__has_trivial_copy) failed\"\n+#endif\n+#if !__has_builtin (__has_trivial_destructor)\n+# error \"__has_builtin (__has_trivial_destructor) failed\"\n+#endif\n+#if !__has_builtin (__has_unique_object_representations)\n+# error \"__has_builtin (__has_unique_object_representations) failed\"\n+#endif\n+#if !__has_builtin (__has_virtual_destructor)\n+# error \"__has_builtin (__has_virtual_destructor) failed\"\n+#endif\n+#if !__has_builtin (__is_abstract)\n+# error \"__has_builtin (__is_abstract) failed\"\n+#endif\n+#if !__has_builtin (__is_aggregate)\n+# error \"__has_builtin (__is_aggregate) failed\"\n+#endif\n+#if !__has_builtin (__is_base_of)\n+# error \"__has_builtin (__is_base_of) failed\"\n+#endif\n+#if !__has_builtin (__is_class)\n+# error \"__has_builtin (__is_class) failed\"\n+#endif\n+#if !__has_builtin (__is_empty)\n+# error \"__has_builtin (__is_empty) failed\"\n+#endif\n+#if !__has_builtin (__is_enum)\n+# error \"__has_builtin (__is_enum) failed\"\n+#endif\n+#if !__has_builtin (__is_final)\n+# error \"__has_builtin (__is_final) failed\"\n+#endif\n+#if !__has_builtin (__is_layout_compatible)\n+# error \"__has_builtin (__is_layout_compatible) failed\"\n+#endif\n+#if !__has_builtin (__is_literal_type)\n+# error \"__has_builtin (__is_literal_type) failed\"\n+#endif\n+#if !__has_builtin (__is_pointer_interconvertible_base_of)\n+# error \"__has_builtin (__is_pointer_interconvertible_base_of) failed\"\n+#endif\n+#if !__has_builtin (__is_pod)\n+# error \"__has_builtin (__is_pod) failed\"\n+#endif\n+#if !__has_builtin (__is_polymorphic)\n+# error \"__has_builtin (__is_polymorphic) failed\"\n+#endif\n+#if !__has_builtin (__is_same)\n+# error \"__has_builtin (__is_same) failed\"\n+#endif\n+#if !__has_builtin (__is_same_as)\n+# error \"__has_builtin (__is_same_as) failed\"\n+#endif\n+#if !__has_builtin (__is_standard_layout)\n+# error \"__has_builtin (__is_standard_layout) failed\"\n+#endif\n+#if !__has_builtin (__is_trivial)\n+# error \"__has_builtin (__is_trivial) failed\"\n+#endif\n+#if !__has_builtin (__is_trivially_assignable)\n+# error \"__has_builtin (__is_trivially_assignable) failed\"\n+#endif\n+#if !__has_builtin (__is_trivially_constructible)\n+# error \"__has_builtin (__is_trivially_constructible) failed\"\n+#endif\n+#if !__has_builtin (__is_trivially_copyable)\n+# error \"__has_builtin (__is_trivially_copyable) failed\"\n+#endif\n+#if !__has_builtin (__is_union)\n+# error \"__has_builtin (__is_union) failed\"\n+#endif\n+#if !__has_builtin (__underlying_type)\n+# error \"__has_builtin (__underlying_type) failed\"\n+#endif\n+#if !__has_builtin (__is_assignable)\n+# error \"__has_builtin (__is_assignable) failed\"\n+#endif\n+#if !__has_builtin (__is_constructible)\n+# error \"__has_builtin (__is_constructible) failed\"\n+#endif\n+#if !__has_builtin (__is_nothrow_assignable)\n+# error \"__has_builtin (__is_nothrow_assignable) failed\"\n+#endif\n+#if !__has_builtin (__is_nothrow_constructible)\n+# error \"__has_builtin (__is_nothrow_constructible) failed\"\n+#endif\n+#if !__has_builtin (__reference_constructs_from_temporary)\n+# error \"__has_builtin (__reference_constructs_from_temporary) failed\"\n+#endif\n+#if !__has_builtin (__reference_converts_from_temporary)\n+# error \"__has_builtin (__reference_converts_from_temporary) failed\"\n+#endif\n+#if !__has_builtin (__builtin_is_constant_evaluated)\n+# error \"__has_builtin (__builtin_is_constant_evaluated) failed\"\n+#endif\n+#if !__has_builtin (__builtin_source_location)\n+# error \"__has_builtin (__builtin_source_location) failed\"\n+#endif\n+#if !__has_builtin (__builtin_is_corresponding_member)\n+# error \"__has_builtin (__builtin_is_corresponding_member) failed\"\n+#endif\n+#if !__has_builtin (__builtin_is_pointer_interconvertible_with_class)\n+# error \"__has_builtin (__builtin_is_pointer_interconvertible_with_class) failed\"\n+#endif"}]}