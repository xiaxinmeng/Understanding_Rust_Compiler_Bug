{"sha": "de9b2a969ebc6ebce82331c67c895a0f99b0cc78", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZGU5YjJhOTY5ZWJjNmViY2U4MjMzMWM2N2M4OTVhMGY5OWIwY2M3OA==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2018-05-29T09:39:44Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "pmderodat@gcc.gnu.org", "date": "2018-05-29T09:39:44Z"}, "message": "[Ada] Adjustment of behavior of new -gnatRj switch\n\nThis decouples -gnatRj from the destination, either standard output or file,\nso that it only toggles the format of the representation information.\n\n2018-05-29  Eric Botcazou  <ebotcazou@adacore.com>\n\ngcc/ada/\n\n\t* doc/gnat_ugn/building_executable_programs_with_gnat.rst (Debugging\n\tControl): Adjust description of -gnatRj.\n\t* gnat_ugn.texi: Regenerate.\n\t* opt.ads (List_Representation_Info_To_JSON): Likewise.\n\t* repinfo.adb (List_Rep_Info): Do not automatically create a file\n\tif List_Representation_Info_To_JSON is true.\n\t* switch-c.adb (Scan_Front_End_Switches) <R>: Remove incompatibility\n\tcheck between -gnatRj and -gnatRs.\n\t* usage.adb (Usage): Adjust description of -gnatRj.\n\nFrom-SVN: r260873", "tree": {"sha": "c90bd22413cd1052b8920b6617ad5eb786a55764", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c90bd22413cd1052b8920b6617ad5eb786a55764"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/de9b2a969ebc6ebce82331c67c895a0f99b0cc78", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/de9b2a969ebc6ebce82331c67c895a0f99b0cc78", "html_url": "https://github.com/Rust-GCC/gccrs/commit/de9b2a969ebc6ebce82331c67c895a0f99b0cc78", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/de9b2a969ebc6ebce82331c67c895a0f99b0cc78/comments", "author": null, "committer": null, "parents": [{"sha": "ce09c3c07f3bae669c0152ba4d72a708cfe27d0f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ce09c3c07f3bae669c0152ba4d72a708cfe27d0f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ce09c3c07f3bae669c0152ba4d72a708cfe27d0f"}], "stats": {"total": 88, "additions": 49, "deletions": 39}, "files": [{"sha": "08dfb851a5952c7eb5cef0468d9ff4fdb1f7f6b9", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/de9b2a969ebc6ebce82331c67c895a0f99b0cc78/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/de9b2a969ebc6ebce82331c67c895a0f99b0cc78/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=de9b2a969ebc6ebce82331c67c895a0f99b0cc78", "patch": "@@ -1,3 +1,15 @@\n+2018-05-29  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* doc/gnat_ugn/building_executable_programs_with_gnat.rst (Debugging\n+\tControl): Adjust description of -gnatRj.\n+\t* gnat_ugn.texi: Regenerate.\n+\t* opt.ads (List_Representation_Info_To_JSON): Likewise.\n+\t* repinfo.adb (List_Rep_Info): Do not automatically create a file\n+\tif List_Representation_Info_To_JSON is true.\n+\t* switch-c.adb (Scan_Front_End_Switches) <R>: Remove incompatibility\n+\tcheck between -gnatRj and -gnatRs.\n+\t* usage.adb (Usage): Adjust description of -gnatRj.\n+\n 2018-05-29  Pascal Obry  <obry@adacore.com>\n \n \t* libgnat/s-os_lib.adb (Normalize_Pathname): Fix handling of \"..\" in"}, {"sha": "4800138a6358e63c4fbe56ea8aeac88b8a83f8bf", "filename": "gcc/ada/doc/gnat_ugn/building_executable_programs_with_gnat.rst", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/de9b2a969ebc6ebce82331c67c895a0f99b0cc78/gcc%2Fada%2Fdoc%2Fgnat_ugn%2Fbuilding_executable_programs_with_gnat.rst", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/de9b2a969ebc6ebce82331c67c895a0f99b0cc78/gcc%2Fada%2Fdoc%2Fgnat_ugn%2Fbuilding_executable_programs_with_gnat.rst", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fdoc%2Fgnat_ugn%2Fbuilding_executable_programs_with_gnat.rst?ref=de9b2a969ebc6ebce82331c67c895a0f99b0cc78", "patch": "@@ -5813,16 +5813,16 @@ Debugging Control\n   subprogram conventions and parameter passing mechanisms for all the\n   subprograms are included.\n \n+  If the switch is followed by a ``j`` (e.g., :switch:`-gnatRj`), then\n+  the output is in the JSON data interchange format specified by the\n+  ECMA-404 standard. The semantic description of this JSON output is\n+  available in the specification of the Repinfo unit present in the\n+  compiler sources.\n+\n   If the switch is followed by an ``s`` (e.g., :switch:`-gnatR3s`), then\n   the output is to a file with the name :file:`file.rep` where file is\n-  the name of the corresponding source file.\n-\n-  If the switch is followed by a ``j`` (e.g., :switch:`-gnatR3j`), then\n-  the output is to a file with the name :file:`file.json` where file is\n-  the name of the corresponding source file, and it uses the JSON data\n-  interchange format specified by the ECMA-404 standard. The semantic\n-  description of this JSON output is available in the specification of\n-  the Repinfo unit present in the compiler sources.\n+  the name of the corresponding source file, except if `j`` is also\n+  specified, in which case the file name is :file:`file.json`.\n \n   Note that it is possible for record components to have zero size. In\n   this case, the component clause uses an obvious extension of permitted"}, {"sha": "0b6a408518c3494d24a60b4871aacc8f70292d88", "filename": "gcc/ada/gnat_ugn.texi", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/de9b2a969ebc6ebce82331c67c895a0f99b0cc78/gcc%2Fada%2Fgnat_ugn.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/de9b2a969ebc6ebce82331c67c895a0f99b0cc78/gcc%2Fada%2Fgnat_ugn.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgnat_ugn.texi?ref=de9b2a969ebc6ebce82331c67c895a0f99b0cc78", "patch": "@@ -15041,16 +15041,16 @@ If the switch is followed by an @code{m} (e.g. @code{-gnatRm}), then\n subprogram conventions and parameter passing mechanisms for all the\n subprograms are included.\n \n+If the switch is followed by a @code{j} (e.g., @code{-gnatRj}), then\n+the output is in the JSON data interchange format specified by the\n+ECMA-404 standard. The semantic description of this JSON output is\n+available in the specification of the Repinfo unit present in the\n+compiler sources.\n+\n If the switch is followed by an @code{s} (e.g., @code{-gnatR3s}), then\n the output is to a file with the name @code{file.rep} where file is\n-the name of the corresponding source file.\n-\n-If the switch is followed by a @code{j} (e.g., @code{-gnatR3j}), then\n-the output is to a file with the name @code{file.json} where file is\n-the name of the corresponding source file, and it uses the JSON data\n-interchange format specified by the ECMA-404 standard. The semantic\n-description of this JSON output is available in the specification of\n-the Repinfo unit present in the compiler sources.\n+the name of the corresponding source file, except if @cite{j`} is also\n+specified, in which case the file name is @code{file.json}.\n \n Note that it is possible for record components to have zero size. In\n this case, the component clause uses an obvious extension of permitted"}, {"sha": "7e23d1dfb50c5ce7c29c3dd1ff8b3a9a76df9b2b", "filename": "gcc/ada/opt.ads", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/de9b2a969ebc6ebce82331c67c895a0f99b0cc78/gcc%2Fada%2Fopt.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/de9b2a969ebc6ebce82331c67c895a0f99b0cc78/gcc%2Fada%2Fopt.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fopt.ads?ref=de9b2a969ebc6ebce82331c67c895a0f99b0cc78", "patch": "@@ -1006,8 +1006,7 @@ package Opt is\n    List_Representation_Info_To_JSON : Boolean := False;\n    --  GNAT\n    --  Set true by -gnatRj switch. Causes information from -gnatR/1/2/3/m to be\n-   --  written to file.json (where file is the name of the source file) in the\n-   --  JSON data interchange format.\n+   --  output in the JSON data interchange format.\n \n    List_Representation_Info_Mechanisms : Boolean := False;\n    --  GNAT"}, {"sha": "1a85c8ff90eaba77e8b63da8c8ca7c1b45cec016", "filename": "gcc/ada/repinfo.adb", "status": "modified", "additions": 14, "deletions": 13, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/de9b2a969ebc6ebce82331c67c895a0f99b0cc78/gcc%2Fada%2Frepinfo.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/de9b2a969ebc6ebce82331c67c895a0f99b0cc78/gcc%2Fada%2Frepinfo.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Frepinfo.adb?ref=de9b2a969ebc6ebce82331c67c895a0f99b0cc78", "patch": "@@ -1711,20 +1711,21 @@ package body Repinfo is\n \n                --  Normal case, list to standard output\n \n-               if not List_Representation_Info_To_File\n-                 and then not List_Representation_Info_To_JSON\n-               then\n-                  Write_Eol;\n-                  Write_Str (\"Representation information for unit \");\n-                  Write_Unit_Name (Unit_Name (U));\n-                  Col := Column;\n-                  Write_Eol;\n-\n-                  for J in 1 .. Col - 1 loop\n-                     Write_Char ('-');\n-                  end loop;\n+               if not List_Representation_Info_To_File then\n+                  if not List_Representation_Info_To_JSON then\n+                     Write_Eol;\n+                     Write_Str (\"Representation information for unit \");\n+                     Write_Unit_Name (Unit_Name (U));\n+                     Col := Column;\n+                     Write_Eol;\n+\n+                     for J in 1 .. Col - 1 loop\n+                        Write_Char ('-');\n+                     end loop;\n+\n+                     Write_Eol;\n+                  end if;\n \n-                  Write_Eol;\n                   List_Entities (Cunit_Entity (U), Bytes_Big_Endian);\n \n                --  List representation information to file"}, {"sha": "ab7c2b30c49ff60ed05474fb843cd531204e6643", "filename": "gcc/ada/switch-c.adb", "status": "modified", "additions": 4, "deletions": 6, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/de9b2a969ebc6ebce82331c67c895a0f99b0cc78/gcc%2Fada%2Fswitch-c.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/de9b2a969ebc6ebce82331c67c895a0f99b0cc78/gcc%2Fada%2Fswitch-c.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fswitch-c.adb?ref=de9b2a969ebc6ebce82331c67c895a0f99b0cc78", "patch": "@@ -1227,12 +1227,10 @@ package body Switch.C is\n                   Ptr := Ptr + 1;\n                end loop;\n \n-               if List_Representation_Info_To_JSON then\n-                  if List_Representation_Info_To_File then\n-                     Osint.Fail (\"-gnatRs is incompatible with -gnatRj\");\n-                  elsif List_Representation_Info_Extended then\n-                     Osint.Fail (\"-gnatRe is incompatible with -gnatRj\");\n-                  end if;\n+               if List_Representation_Info_To_JSON\n+                 and then List_Representation_Info_Extended\n+               then\n+                  Osint.Fail (\"-gnatRe is incompatible with -gnatRj\");\n                end if;\n \n             --  -gnats (syntax check only)"}, {"sha": "a065244c110d8473510674f9a044c6cf3e640e12", "filename": "gcc/ada/usage.adb", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/de9b2a969ebc6ebce82331c67c895a0f99b0cc78/gcc%2Fada%2Fusage.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/de9b2a969ebc6ebce82331c67c895a0f99b0cc78/gcc%2Fada%2Fusage.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fusage.adb?ref=de9b2a969ebc6ebce82331c67c895a0f99b0cc78", "patch": "@@ -403,10 +403,10 @@ begin\n    Write_Switch_Char (\"R?\");\n    Write_Line\n      (\"List rep info (?=0/1/2/3/e/m for none/types/all/symbolic/ext/mech)\");\n+   Write_Switch_Char (\"R?j\");\n+   Write_Line (\"List rep info in the JSON data interchange format\");\n    Write_Switch_Char (\"R?s\");\n    Write_Line (\"List rep info to file.rep instead of standard output\");\n-   Write_Switch_Char (\"R?j\");\n-   Write_Line (\"List rep info to file.json instead of standard output\");\n \n    --  Line for -gnats switch\n "}]}