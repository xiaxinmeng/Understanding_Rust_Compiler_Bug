{"sha": "8287dbce7bcb7c6b1a0aa45f05b8c94a25a7c723", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODI4N2RiY2U3YmNiN2M2YjFhMGFhNDVmMDViOGM5NGEyNWE3YzcyMw==", "commit": {"author": {"name": "Ulrich Weigand", "email": "uweigand@de.ibm.com", "date": "2016-03-10T23:58:44Z"}, "committer": {"name": "Ulrich Weigand", "email": "uweigand@gcc.gnu.org", "date": "2016-03-10T23:58:44Z"}, "message": "re PR target/70168 (Wrong code generation in __sync_val_compare_and_swap on PowerPC)\n\n\tPR target/70168\n\t* config/rs6000/rs6000.c (rs6000_expand_atomic_compare_and_swap):\n\tHandle overlapping retval and newval.\n\nFrom-SVN: r234126", "tree": {"sha": "d9aa09cc218ec8431a7dacf1cbd0e7f9df0c44d3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d9aa09cc218ec8431a7dacf1cbd0e7f9df0c44d3"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8287dbce7bcb7c6b1a0aa45f05b8c94a25a7c723", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8287dbce7bcb7c6b1a0aa45f05b8c94a25a7c723", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8287dbce7bcb7c6b1a0aa45f05b8c94a25a7c723", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8287dbce7bcb7c6b1a0aa45f05b8c94a25a7c723/comments", "author": null, "committer": null, "parents": [{"sha": "f6c1032d03cd45af05f427a3b33bc12e88c44c3a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f6c1032d03cd45af05f427a3b33bc12e88c44c3a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f6c1032d03cd45af05f427a3b33bc12e88c44c3a"}], "stats": {"total": 9, "additions": 9, "deletions": 0}, "files": [{"sha": "cc91e84d61b8838cbcfa0cd407efcc42fa932373", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8287dbce7bcb7c6b1a0aa45f05b8c94a25a7c723/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8287dbce7bcb7c6b1a0aa45f05b8c94a25a7c723/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=8287dbce7bcb7c6b1a0aa45f05b8c94a25a7c723", "patch": "@@ -1,3 +1,9 @@\n+2016-03-10  Ulrich Weigand  <Ulrich.Weigand@de.ibm.com>\n+\n+\tPR target/70168\n+\t* config/rs6000/rs6000.c (rs6000_expand_atomic_compare_and_swap):\n+\tHandle overlapping retval and newval.\n+\n 2016-03-10  Nick Clifton  <nickc@redhat.com>\n \n \tPR target/7044"}, {"sha": "fd4b7cc5a7ee32cdc70f42a83fd04414662b3589", "filename": "gcc/config/rs6000/rs6000.c", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8287dbce7bcb7c6b1a0aa45f05b8c94a25a7c723/gcc%2Fconfig%2Frs6000%2Frs6000.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8287dbce7bcb7c6b1a0aa45f05b8c94a25a7c723/gcc%2Fconfig%2Frs6000%2Frs6000.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.c?ref=8287dbce7bcb7c6b1a0aa45f05b8c94a25a7c723", "patch": "@@ -22283,6 +22283,9 @@ rs6000_expand_atomic_compare_and_swap (rtx operands[])\n   if (mode != TImode && !reg_or_short_operand (oldval, mode))\n     oldval = copy_to_mode_reg (mode, oldval);\n \n+  if (reg_overlap_mentioned_p (retval, newval))\n+    newval = copy_to_reg (newval);\n+\n   mem = rs6000_pre_atomic_barrier (mem, mod_s);\n \n   label1 = NULL_RTX;"}]}