{"sha": "2f1bb3ca9170534db2cf2df6cf4ff61a4dd6145b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MmYxYmIzY2E5MTcwNTM0ZGIyY2YyZGY2Y2Y0ZmY2MWE0ZGQ2MTQ1Yg==", "commit": {"author": {"name": "Shiva Chen", "email": "shiva0217@gmail.com", "date": "2018-04-22T08:42:18Z"}, "committer": {"name": "Chung-Ju Wu", "email": "jasonwucj@gcc.gnu.org", "date": "2018-04-22T08:42:18Z"}, "message": "[NDS32] Refine CASE_VECTOR_SHORTEN_MODE to function.\n\ngcc/\n\t* config/nds32/nds32-protos.h (nds32_case_vector_shorten_mode):\n\tDeclare.\n\t* config/nds32/nds32.c (nds32_case_vector_shorten_mode): New function.\n\t* config/nds32/nds32.h (CASE_VECTOR_SHORTEN_MODE): Modify.\n\nCo-Authored-By: Chung-Ju Wu <jasonwucj@gmail.com>\n\nFrom-SVN: r259550", "tree": {"sha": "91e52c3020c6f09fd36314fbb51e8aad4b153d71", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/91e52c3020c6f09fd36314fbb51e8aad4b153d71"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2f1bb3ca9170534db2cf2df6cf4ff61a4dd6145b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2f1bb3ca9170534db2cf2df6cf4ff61a4dd6145b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2f1bb3ca9170534db2cf2df6cf4ff61a4dd6145b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2f1bb3ca9170534db2cf2df6cf4ff61a4dd6145b/comments", "author": {"login": "ShivaChen", "id": 32083954, "node_id": "MDQ6VXNlcjMyMDgzOTU0", "avatar_url": "https://avatars.githubusercontent.com/u/32083954?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ShivaChen", "html_url": "https://github.com/ShivaChen", "followers_url": "https://api.github.com/users/ShivaChen/followers", "following_url": "https://api.github.com/users/ShivaChen/following{/other_user}", "gists_url": "https://api.github.com/users/ShivaChen/gists{/gist_id}", "starred_url": "https://api.github.com/users/ShivaChen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ShivaChen/subscriptions", "organizations_url": "https://api.github.com/users/ShivaChen/orgs", "repos_url": "https://api.github.com/users/ShivaChen/repos", "events_url": "https://api.github.com/users/ShivaChen/events{/privacy}", "received_events_url": "https://api.github.com/users/ShivaChen/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "361292be13045d2ed2812b26bb6c634b60e155df", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/361292be13045d2ed2812b26bb6c634b60e155df", "html_url": "https://github.com/Rust-GCC/gccrs/commit/361292be13045d2ed2812b26bb6c634b60e155df"}], "stats": {"total": 30, "additions": 27, "deletions": 3}, "files": [{"sha": "b32490e3072ceb008da76089199a24f78e59139a", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f1bb3ca9170534db2cf2df6cf4ff61a4dd6145b/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f1bb3ca9170534db2cf2df6cf4ff61a4dd6145b/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=2f1bb3ca9170534db2cf2df6cf4ff61a4dd6145b", "patch": "@@ -1,3 +1,11 @@\n+2018-04-22  Shiva Chen  <shiva0217@gmail.com>\n+\t    Chung-Ju Wu  <jasonwucj@gmail.com>\n+\n+\t* config/nds32/nds32-protos.h (nds32_case_vector_shorten_mode):\n+\tDeclare.\n+\t* config/nds32/nds32.c (nds32_case_vector_shorten_mode): New function.\n+\t* config/nds32/nds32.h (CASE_VECTOR_SHORTEN_MODE): Modify.\n+\n 2018-04-22  Chung-Ju Wu  <jasonwucj@gmail.com>\n \n \t* config/nds32/nds32.c (nds32_compute_stack_frame): Fix wrong value."}, {"sha": "2d68f131fcf49fd1f1a415c4bac7197ef8750abc", "filename": "gcc/config/nds32/nds32-protos.h", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f1bb3ca9170534db2cf2df6cf4ff61a4dd6145b/gcc%2Fconfig%2Fnds32%2Fnds32-protos.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f1bb3ca9170534db2cf2df6cf4ff61a4dd6145b/gcc%2Fconfig%2Fnds32%2Fnds32-protos.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fnds32%2Fnds32-protos.h?ref=2f1bb3ca9170534db2cf2df6cf4ff61a4dd6145b", "patch": "@@ -219,6 +219,7 @@ extern void nds32_expand_constant (machine_mode,\n /* Auxiliary functions to check using return with null epilogue.  */\n \n extern int nds32_can_use_return_insn (void);\n+extern scalar_int_mode nds32_case_vector_shorten_mode (int, int, rtx);\n \n /* Auxiliary functions to decide output alignment or not.  */\n "}, {"sha": "a33567eeff4d22fcef2b135ff37ae4fe6e5343b1", "filename": "gcc/config/nds32/nds32.c", "status": "modified", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f1bb3ca9170534db2cf2df6cf4ff61a4dd6145b/gcc%2Fconfig%2Fnds32%2Fnds32.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f1bb3ca9170534db2cf2df6cf4ff61a4dd6145b/gcc%2Fconfig%2Fnds32%2Fnds32.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fnds32%2Fnds32.c?ref=2f1bb3ca9170534db2cf2df6cf4ff61a4dd6145b", "patch": "@@ -4768,6 +4768,23 @@ nds32_can_use_return_insn (void)\n   return (cfun->machine->naked_p && (cfun->machine->va_args_size == 0));\n }\n \n+scalar_int_mode\n+nds32_case_vector_shorten_mode (int min_offset, int max_offset,\n+\t\t\t\trtx body ATTRIBUTE_UNUSED)\n+{\n+  if (min_offset < 0 || max_offset >= 0x2000)\n+    return SImode;\n+  else\n+    {\n+      /* The jump table maybe need to 2 byte alignment,\n+\t so reserved 1 byte for check max_offset.  */\n+      if (max_offset >= 0xff)\n+\treturn HImode;\n+      else\n+\treturn QImode;\n+    }\n+}\n+\n /* ------------------------------------------------------------------------ */\n \n /* Function to test 333-form for load/store instructions."}, {"sha": "c5d1e27e0eb99f4fed488664b92f82b7a5c04d85", "filename": "gcc/config/nds32/nds32.h", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f1bb3ca9170534db2cf2df6cf4ff61a4dd6145b/gcc%2Fconfig%2Fnds32%2Fnds32.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f1bb3ca9170534db2cf2df6cf4ff61a4dd6145b/gcc%2Fconfig%2Fnds32%2Fnds32.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fnds32%2Fnds32.h?ref=2f1bb3ca9170534db2cf2df6cf4ff61a4dd6145b", "patch": "@@ -1331,9 +1331,7 @@ enum reg_class\n /* Return the preferred mode for and addr_diff_vec when the mininum\n    and maximum offset are known.  */\n #define CASE_VECTOR_SHORTEN_MODE(min_offset, max_offset, body)  \\\n-   ((min_offset < 0 || max_offset >= 0x2000 ) ? SImode          \\\n-   : (max_offset >= 100) ? HImode                               \\\n-   : QImode)\n+  nds32_case_vector_shorten_mode (min_offset, max_offset, body)\n \n /* Generate pc relative jump table when -fpic or -Os.  */\n #define CASE_VECTOR_PC_RELATIVE (flag_pic || optimize_size)"}]}