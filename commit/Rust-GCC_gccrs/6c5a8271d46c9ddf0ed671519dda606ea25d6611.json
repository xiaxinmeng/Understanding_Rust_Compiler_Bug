{"sha": "6c5a8271d46c9ddf0ed671519dda606ea25d6611", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NmM1YTgyNzFkNDZjOWRkZjBlZDY3MTUxOWRkYTYwNmVhMjVkNjYxMQ==", "commit": {"author": {"name": "Tom Tromey", "email": "tromey@redhat.com", "date": "2001-11-15T00:24:38Z"}, "committer": {"name": "Tom Tromey", "email": "tromey@gcc.gnu.org", "date": "2001-11-15T00:24:38Z"}, "message": "verify.cc (class _Jv_BytecodeVerifier): Fixed logic.\n\n\t* verify.cc (class _Jv_BytecodeVerifier) [op_dup2]: Fixed logic.\n\t[op_dup_x2]: Likewise.\n\t[op_dup2_x1]: Likewise.\n\t[op_dup2_x2]: Likewise.\n\t(branch_prepass): Added `op_newarray' case.  Updated unrecognized\n\tinstruction error.\n\t(verify_instructions_0): Updated unrecognized instruction error.\n\nFrom-SVN: r47033", "tree": {"sha": "208a8abdb751404247089309e3921baaa3d1b893", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/208a8abdb751404247089309e3921baaa3d1b893"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6c5a8271d46c9ddf0ed671519dda606ea25d6611", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6c5a8271d46c9ddf0ed671519dda606ea25d6611", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6c5a8271d46c9ddf0ed671519dda606ea25d6611", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6c5a8271d46c9ddf0ed671519dda606ea25d6611/comments", "author": null, "committer": null, "parents": [{"sha": "9da85b163e801cf91924582946b9d0b2fd6ce9d4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9da85b163e801cf91924582946b9d0b2fd6ce9d4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9da85b163e801cf91924582946b9d0b2fd6ce9d4"}], "stats": {"total": 96, "additions": 78, "deletions": 18}, "files": [{"sha": "e8b6e8838d91927c7e542d4ccd736164684e70b5", "filename": "libjava/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6c5a8271d46c9ddf0ed671519dda606ea25d6611/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6c5a8271d46c9ddf0ed671519dda606ea25d6611/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=6c5a8271d46c9ddf0ed671519dda606ea25d6611", "patch": "@@ -1,5 +1,13 @@\n 2001-11-14  Tom Tromey  <tromey@redhat.com>\n \n+\t* verify.cc (class _Jv_BytecodeVerifier) [op_dup2]: Fixed logic.\n+\t[op_dup_x2]: Likewise.\n+\t[op_dup2_x1]: Likewise.\n+\t[op_dup2_x2]: Likewise.\n+\t(branch_prepass): Added `op_newarray' case.  Updated unrecognized\n+\tinstruction error.\n+\t(verify_instructions_0): Updated unrecognized instruction error.\n+\n \t* java/lang/reflect/Constructor.java (toString): Use more\n \tefficient form of Modifier.toString().\n "}, {"sha": "6deb80b08d6f52d8f2777ae48e7ff638b7fe953d", "filename": "libjava/verify.cc", "status": "modified", "additions": 70, "deletions": 18, "changes": 88, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6c5a8271d46c9ddf0ed671519dda606ea25d6611/libjava%2Fverify.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6c5a8271d46c9ddf0ed671519dda606ea25d6611/libjava%2Fverify.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fverify.cc?ref=6c5a8271d46c9ddf0ed671519dda606ea25d6611", "patch": "@@ -1314,6 +1314,7 @@ class _Jv_BytecodeVerifier\n \t  case op_putfield:\n \t  case op_putstatic:\n \t  case op_new:\n+\t  case op_newarray:\n \t  case op_anewarray:\n \t  case op_instanceof:\n \t  case op_checkcast:\n@@ -1402,7 +1403,7 @@ class _Jv_BytecodeVerifier\n \t    break;\n \n \t  default:\n-\t    verify_fail (\"unrecognized instruction\");\n+\t    verify_fail (\"unrecognized instruction in branch_prepass\");\n \t  }\n \n \t// See if any previous branch tried to branch to the middle of\n@@ -1915,39 +1916,90 @@ class _Jv_BytecodeVerifier\n \t  case op_dup_x2:\n \t    {\n \t      type t1 = pop32 ();\n-\t      type t2 = pop32 ();\n-\t      type t3 = pop32 ();\n-\t      push_type (t1);\n-\t      push_type (t3);\n+\t      type t2 = pop_raw ();\n+\t      if (! t2.iswide ())\n+\t\t{\n+\t\t  type t3 = pop32 ();\n+\t\t  push_type (t1);\n+\t\t  push_type (t3);\n+\t\t}\n+\t      else\n+\t\tpush_type (t1);\n \t      push_type (t2);\n \t      push_type (t1);\n \t    }\n \t    break;\n \t  case op_dup2:\n \t    {\n-\t      type t = pop64 ();\n-\t      push_type (t);\n+\t      type t = pop_raw ();\n+\t      if (! t.iswide ())\n+\t\t{\n+\t\t  type t2 = pop32 ();\n+\t\t  push_type (t2);\n+\t\t  push_type (t);\n+\t\t  push_type (t2);\n+\t\t}\n \t      push_type (t);\n \t    }\n \t    break;\n \t  case op_dup2_x1:\n \t    {\n-\t      type t1 = pop64 ();\n-\t      type t2 = pop64 ();\n-\t      push_type (t1);\n+\t      type t1 = pop_raw ();\n+\t      type t2 = pop32 ();\n+\t      if (! t1.iswide ())\n+\t\t{\n+\t\t  type t3 = pop32 ();\n+\t\t  push_type (t2);\n+\t\t  push_type (t1);\n+\t\t  push_type (t3);\n+\t\t}\n+\t      else\n+\t\tpush_type (t1);\n \t      push_type (t2);\n \t      push_type (t1);\n \t    }\n \t    break;\n \t  case op_dup2_x2:\n \t    {\n-\t      type t1 = pop64 ();\n-\t      type t2 = pop64 ();\n-\t      type t3 = pop64 ();\n-\t      push_type (t1);\n-\t      push_type (t3);\n-\t      push_type (t2);\n-\t      push_type (t1);\n+\t      // FIXME\n+\t      type t1 = pop_raw ();\n+\t      if (t1.iswide ())\n+\t\t{\n+\t\t  type t2 = pop_raw ();\n+\t\t  if (t2.iswide ())\n+\t\t    {\n+\t\t      push_type (t1);\n+\t\t      push_type (t2);\n+\t\t    }\n+\t\t  else\n+\t\t    {\n+\t\t      type t3 = pop32 ();\n+\t\t      push_type (t1);\n+\t\t      push_type (t3);\n+\t\t      push_type (t2);\n+\t\t    }\n+\t\t  push_type (t1);\n+\t\t}\n+\t      else\n+\t\t{\n+\t\t  type t2 = pop32 ();\n+\t\t  type t3 = pop_raw ();\n+\t\t  if (t3.iswide ())\n+\t\t    {\n+\t\t      push_type (t2);\n+\t\t      push_type (t1);\n+\t\t    }\n+\t\t  else\n+\t\t    {\n+\t\t      type t4 = pop32 ();\n+\t\t      push_type (t2);\n+\t\t      push_type (t1);\n+\t\t      push_type (t4);\n+\t\t    }\n+\t\t  push_type (t3);\n+\t\t  push_type (t2);\n+\t\t  push_type (t1);\n+\t\t}\n \t    }\n \t    break;\n \t  case op_swap:\n@@ -2385,7 +2437,7 @@ class _Jv_BytecodeVerifier\n \n \t  default:\n \t    // Unrecognized opcode.\n-\t    verify_fail (\"unrecognized instruction\");\n+\t    verify_fail (\"unrecognized instruction in verify_instructions_0\");\n \t  }\n       }\n   }"}]}