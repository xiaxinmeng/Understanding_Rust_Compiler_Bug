{"sha": "5af7e2c2e1949e500d44d78d25f98cd3cfdf3e3c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NWFmN2UyYzJlMTk0OWU1MDBkNDRkNzhkMjVmOThjZDNjZmRmM2UzYw==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2000-06-07T22:27:57Z"}, "committer": {"name": "Zack Weinberg", "email": "zack@gcc.gnu.org", "date": "2000-06-07T22:27:57Z"}, "message": "cpplib.c (do_ifdef, do_ifndef): Don't segfault if parse_ifdef returned NULL.\n\n2000-06-06  Jakub Jelinek  <jakub@redhat.com>\n\n\t* cpplib.c (do_ifdef, do_ifndef): Don't segfault if parse_ifdef\n\treturned NULL.\n\nFrom-SVN: r34448", "tree": {"sha": "f7aa6b7905149647216d26d181d5e60eb5b4e9cf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f7aa6b7905149647216d26d181d5e60eb5b4e9cf"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5af7e2c2e1949e500d44d78d25f98cd3cfdf3e3c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5af7e2c2e1949e500d44d78d25f98cd3cfdf3e3c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5af7e2c2e1949e500d44d78d25f98cd3cfdf3e3c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5af7e2c2e1949e500d44d78d25f98cd3cfdf3e3c/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "69197e7e5ead2bebae71ed62532a9d422222684a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/69197e7e5ead2bebae71ed62532a9d422222684a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/69197e7e5ead2bebae71ed62532a9d422222684a"}], "stats": {"total": 40, "additions": 31, "deletions": 9}, "files": [{"sha": "4aac5bb6f8cc5005ecc5b6fd0b3584dbe155ac4a", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5af7e2c2e1949e500d44d78d25f98cd3cfdf3e3c/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5af7e2c2e1949e500d44d78d25f98cd3cfdf3e3c/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=5af7e2c2e1949e500d44d78d25f98cd3cfdf3e3c", "patch": "@@ -1,3 +1,8 @@\n+2000-06-06  Jakub Jelinek  <jakub@redhat.com>\n+\n+\t* cpplib.c (do_ifdef, do_ifndef): Don't segfault if parse_ifdef\n+\treturned NULL.\n+\n Wed Jun  7 20:34:33 2000  Denis Chertykov  <denisc@overta.ru>\n \n \t* config/avr/avr.c (asm_output_section_name): output section"}, {"sha": "60dfbdd2c27ef9918c109436599fe724d0a95863", "filename": "gcc/cpplib.c", "status": "modified", "additions": 14, "deletions": 9, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5af7e2c2e1949e500d44d78d25f98cd3cfdf3e3c/gcc%2Fcpplib.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5af7e2c2e1949e500d44d78d25f98cd3cfdf3e3c/gcc%2Fcpplib.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcpplib.c?ref=5af7e2c2e1949e500d44d78d25f98cd3cfdf3e3c", "patch": "@@ -1126,10 +1126,13 @@ do_ifdef (pfile)\n {\n   int def = 0;\n   const cpp_hashnode *node = parse_ifdef (pfile, dtable[T_IFDEF].name);\n-  if (node->type == T_POISON)\n-    cpp_error (pfile, \"attempt to use poisoned `%s'\", node->name);\n-  else\n-    def = (node->type != T_VOID);\n+  if (node)\n+    {\n+      if (node->type == T_POISON)\n+\tcpp_error (pfile, \"attempt to use poisoned `%s'\", node->name);\n+      else\n+\tdef = (node->type != T_VOID);\n+    }\n   push_conditional (pfile, !def, T_IFDEF, 0);\n   return 0;\n }\n@@ -1147,11 +1150,13 @@ do_ifndef (pfile)\n \n   start_of_file = pfile->only_seen_white == 2;\n   cmacro = parse_ifdef (pfile, dtable[T_IFNDEF].name);\n-  if (cmacro->type == T_POISON)\n-    cpp_error (pfile, \"attempt to use poisoned `%s'\", cmacro->name);\n-  else\n-    def = (cmacro->type != T_VOID);\n-\n+  if (cmacro)\n+    {\n+      if (cmacro->type == T_POISON)\n+\tcpp_error (pfile, \"attempt to use poisoned `%s'\", cmacro->name);\n+      else\n+\tdef = (cmacro->type != T_VOID);\n+    }\n   push_conditional (pfile, def, T_IFNDEF,\n \t\t    start_of_file ? cmacro : 0);\n   return 0;"}, {"sha": "2eac73b6132d3d6d0322f84f17c25c8bf15bb6c0", "filename": "gcc/testsuite/gcc.dg/cpp-if5.c", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5af7e2c2e1949e500d44d78d25f98cd3cfdf3e3c/gcc%2Ftestsuite%2Fgcc.dg%2Fcpp-if5.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5af7e2c2e1949e500d44d78d25f98cd3cfdf3e3c/gcc%2Ftestsuite%2Fgcc.dg%2Fcpp-if5.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fcpp-if5.c?ref=5af7e2c2e1949e500d44d78d25f98cd3cfdf3e3c", "patch": "@@ -0,0 +1,12 @@\n+/* Regression test: #ifdef 0 should not crash.  Problem noted by\n+   Jakub Jelinek <jakub@redhat.com>.  */\n+/* { dg-do preprocess } */\n+\n+#ifdef 0  /* { dg-error \"with invalid argument\" } */\n+#error not seen\n+#endif\n+\n+#ifndef 0  /* { dg-error \"with invalid argument\" } */\n+#else\n+#error not seen\n+#endif"}]}