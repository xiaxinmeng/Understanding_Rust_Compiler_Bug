{"sha": "353255cd6f48deafcd7e0b0cd5488ec4f82e7c85", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzUzMjU1Y2Q2ZjQ4ZGVhZmNkN2UwYjBjZDU0ODhlYzRmODJlN2M4NQ==", "commit": {"author": {"name": "Jerry DeLisle", "email": "jvdelisle@gcc.gnu.org", "date": "2011-02-27T20:06:10Z"}, "committer": {"name": "Jerry DeLisle", "email": "jvdelisle@gcc.gnu.org", "date": "2011-02-27T20:06:10Z"}, "message": "re PR fortran/47778 (reading two arrays of structures from namelist fails)\n\n2011-02-27  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n\n\tPR libgfortran/47778\n\t* io/list_read.c (namelist_read): Intialize the error string buffere.\n\tIf pprev_nl was used during the previous namelist read and the rank\n\twas zero, reset the pointer to NULL for the next namelist read.\n\nFrom-SVN: r170548", "tree": {"sha": "2d6aff72c8dec42a2cbfc3a0201791ef12bf6b26", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2d6aff72c8dec42a2cbfc3a0201791ef12bf6b26"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/353255cd6f48deafcd7e0b0cd5488ec4f82e7c85", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/353255cd6f48deafcd7e0b0cd5488ec4f82e7c85", "html_url": "https://github.com/Rust-GCC/gccrs/commit/353255cd6f48deafcd7e0b0cd5488ec4f82e7c85", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/353255cd6f48deafcd7e0b0cd5488ec4f82e7c85/comments", "author": null, "committer": null, "parents": [{"sha": "f6b439c98cc246de3e27c45a30ad5877b7ccb958", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f6b439c98cc246de3e27c45a30ad5877b7ccb958", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f6b439c98cc246de3e27c45a30ad5877b7ccb958"}], "stats": {"total": 17, "additions": 17, "deletions": 0}, "files": [{"sha": "800c1490bcbbde98a4210ac692caa5207b9a015d", "filename": "libgfortran/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/353255cd6f48deafcd7e0b0cd5488ec4f82e7c85/libgfortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/353255cd6f48deafcd7e0b0cd5488ec4f82e7c85/libgfortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2FChangeLog?ref=353255cd6f48deafcd7e0b0cd5488ec4f82e7c85", "patch": "@@ -1,3 +1,10 @@\n+2011-02-27  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n+\n+\tPR libgfortran/47778\n+\t* io/list_read.c (namelist_read): Intialize the error string buffere.\n+\tIf pprev_nl was used during the previous namelist read and the rank\n+\twas zero, reset the pointer to NULL for the next namelist read.\n+\n 2011-02-26  Francois-Xavier Coudert  <fxcoudert@gcc.gnu.org>\n \n \tPR libfortran/45165"}, {"sha": "ea232327f48b5f545b36c2fa84ad031a76331c0a", "filename": "libgfortran/io/list_read.c", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/353255cd6f48deafcd7e0b0cd5488ec4f82e7c85/libgfortran%2Fio%2Flist_read.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/353255cd6f48deafcd7e0b0cd5488ec4f82e7c85/libgfortran%2Fio%2Flist_read.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fio%2Flist_read.c?ref=353255cd6f48deafcd7e0b0cd5488ec4f82e7c85", "patch": "@@ -2985,6 +2985,11 @@ namelist_read (st_parameter_dt *dtp)\n {\n   int c;\n   char nml_err_msg[200];\n+\n+  /* Initialize the error string buffer just in case we get an unexpected fail\n+     somewhere and end up at nml_err_ret.  */\n+  strcpy (nml_err_msg, \"Internal namelist read error\");\n+\n   /* Pointer to the previously read object, in case attempt is made to read\n      new object name.  Should this fail, error message can give previous\n      name.  */\n@@ -3058,6 +3063,11 @@ namelist_read (st_parameter_dt *dtp)\n \t    goto nml_err_ret;\n \t  generate_error (&dtp->common, LIBERROR_READ_VALUE, nml_err_msg);\n         }\n+\n+      /* Reset the previous namelist pointer if we know we are not going\n+\t to be doing multiple reads within a single namelist object.  */\n+      if (prev_nl && prev_nl->var_rank == 0)\n+\tprev_nl = NULL;\n     }\n \n   free_saved (dtp);"}]}