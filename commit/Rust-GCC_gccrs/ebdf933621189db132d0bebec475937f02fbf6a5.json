{"sha": "ebdf933621189db132d0bebec475937f02fbf6a5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWJkZjkzMzYyMTE4OWRiMTMyZDBiZWJlYzQ3NTkzN2YwMmZiZjZhNQ==", "commit": {"author": {"name": "Philip Herron", "email": "philip.herron@embecosm.com", "date": "2021-07-15T13:13:49Z"}, "committer": {"name": "Philip Herron", "email": "philip.herron@embecosm.com", "date": "2021-07-15T13:13:49Z"}, "message": "Only error for missing trait items.\n\nSome trait items can be optional such as constants with an expression or\nfunctions with a body. This change only warns when there are non optional\nitems missing.", "tree": {"sha": "616164691fa6ad034d3cc257b519ac8212b06fb5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/616164691fa6ad034d3cc257b519ac8212b06fb5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ebdf933621189db132d0bebec475937f02fbf6a5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ebdf933621189db132d0bebec475937f02fbf6a5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ebdf933621189db132d0bebec475937f02fbf6a5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ebdf933621189db132d0bebec475937f02fbf6a5/comments", "author": {"login": "philberty", "id": 84585, "node_id": "MDQ6VXNlcjg0NTg1", "avatar_url": "https://avatars.githubusercontent.com/u/84585?v=4", "gravatar_id": "", "url": "https://api.github.com/users/philberty", "html_url": "https://github.com/philberty", "followers_url": "https://api.github.com/users/philberty/followers", "following_url": "https://api.github.com/users/philberty/following{/other_user}", "gists_url": "https://api.github.com/users/philberty/gists{/gist_id}", "starred_url": "https://api.github.com/users/philberty/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/philberty/subscriptions", "organizations_url": "https://api.github.com/users/philberty/orgs", "repos_url": "https://api.github.com/users/philberty/repos", "events_url": "https://api.github.com/users/philberty/events{/privacy}", "received_events_url": "https://api.github.com/users/philberty/received_events", "type": "User", "site_admin": false}, "committer": {"login": "philberty", "id": 84585, "node_id": "MDQ6VXNlcjg0NTg1", "avatar_url": "https://avatars.githubusercontent.com/u/84585?v=4", "gravatar_id": "", "url": "https://api.github.com/users/philberty", "html_url": "https://github.com/philberty", "followers_url": "https://api.github.com/users/philberty/followers", "following_url": "https://api.github.com/users/philberty/following{/other_user}", "gists_url": "https://api.github.com/users/philberty/gists{/gist_id}", "starred_url": "https://api.github.com/users/philberty/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/philberty/subscriptions", "organizations_url": "https://api.github.com/users/philberty/orgs", "repos_url": "https://api.github.com/users/philberty/repos", "events_url": "https://api.github.com/users/philberty/events{/privacy}", "received_events_url": "https://api.github.com/users/philberty/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "089e62f33c328afea756ec4b92f5823584b08a3a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/089e62f33c328afea756ec4b92f5823584b08a3a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/089e62f33c328afea756ec4b92f5823584b08a3a"}], "stats": {"total": 29, "additions": 16, "deletions": 13}, "files": [{"sha": "8d770f0e8ec989c7a9e89a720639b7a40bdf2f6a", "filename": "gcc/rust/typecheck/rust-hir-type-check-item.h", "status": "modified", "additions": 16, "deletions": 13, "changes": 29, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ebdf933621189db132d0bebec475937f02fbf6a5/gcc%2Frust%2Ftypecheck%2Frust-hir-type-check-item.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ebdf933621189db132d0bebec475937f02fbf6a5/gcc%2Frust%2Ftypecheck%2Frust-hir-type-check-item.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Frust%2Ftypecheck%2Frust-hir-type-check-item.h?ref=ebdf933621189db132d0bebec475937f02fbf6a5", "patch": "@@ -104,21 +104,24 @@ class TypeCheckItem : public TypeCheckBase\n \t      missing_trait_items.push_back (trait_item_ref);\n \t  }\n \n-\tstd::string missing_items_buf;\n-\tRichLocation r (impl_block.get_locus ());\n-\tfor (size_t i = 0; i < missing_trait_items.size (); i++)\n+\tif (missing_trait_items.size () > 0)\n \t  {\n-\t    bool has_more = (i + 1) < missing_trait_items.size ();\n-\t    const TraitItemReference &missing_trait_item\n-\t      = missing_trait_items.at (i);\n-\t    missing_items_buf\n-\t      += missing_trait_item.get_identifier () + (has_more ? \", \" : \"\");\n-\t    r.add_range (missing_trait_item.get_locus ());\n-\t  }\n+\t    std::string missing_items_buf;\n+\t    RichLocation r (impl_block.get_locus ());\n+\t    for (size_t i = 0; i < missing_trait_items.size (); i++)\n+\t      {\n+\t\tbool has_more = (i + 1) < missing_trait_items.size ();\n+\t\tconst TraitItemReference &missing_trait_item\n+\t\t  = missing_trait_items.at (i);\n+\t\tmissing_items_buf += missing_trait_item.get_identifier ()\n+\t\t\t\t     + (has_more ? \", \" : \"\");\n+\t\tr.add_range (missing_trait_item.get_locus ());\n+\t      }\n \n-\trust_error_at (r, \"missing %s in implementation of trait %<%s%>\",\n-\t\t       missing_items_buf.c_str (),\n-\t\t       trait_reference.get_name ().c_str ());\n+\t    rust_error_at (r, \"missing %s in implementation of trait %<%s%>\",\n+\t\t\t   missing_items_buf.c_str (),\n+\t\t\t   trait_reference.get_name ().c_str ());\n+\t  }\n       }\n   }\n "}]}