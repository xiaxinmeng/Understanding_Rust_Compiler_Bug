{"sha": "fd5c626c681266845dbec0e84836823a5de3a45b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZmQ1YzYyNmM2ODEyNjY4NDVkYmVjMGU4NDgzNjgyM2E1ZGUzYTQ1Yg==", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2018-10-01T13:10:48Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2018-10-01T13:10:48Z"}, "message": "re PR tree-optimization/87465 (Loop removal regression)\n\n2018-10-01  Richard Biener  <rguenther@suse.de>\n\n\tPR tree-optimization/87465\n\t* tree-ssa-loop-ivcanon.c (tree_estimate_loop_size): Fix typo\n\tcausing branch miscounts.\n\n\t* gcc.dg/tree-ssa/cunroll-15.c: New testcase.\n\nFrom-SVN: r264758", "tree": {"sha": "3e60ee6ae49b556bdc32cca73efdca0ec40d09db", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3e60ee6ae49b556bdc32cca73efdca0ec40d09db"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/fd5c626c681266845dbec0e84836823a5de3a45b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fd5c626c681266845dbec0e84836823a5de3a45b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fd5c626c681266845dbec0e84836823a5de3a45b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fd5c626c681266845dbec0e84836823a5de3a45b/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "329130cc40cc7b061690a2e8b416f1798e2fd36a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/329130cc40cc7b061690a2e8b416f1798e2fd36a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/329130cc40cc7b061690a2e8b416f1798e2fd36a"}], "stats": {"total": 37, "additions": 35, "deletions": 2}, "files": [{"sha": "fbe49a9ea587f72f8cecc03332115eabe031c57b", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fd5c626c681266845dbec0e84836823a5de3a45b/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fd5c626c681266845dbec0e84836823a5de3a45b/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=fd5c626c681266845dbec0e84836823a5de3a45b", "patch": "@@ -1,3 +1,9 @@\n+2018-10-01  Richard Biener  <rguenther@suse.de>\n+\n+\tPR tree-optimization/87465\n+\t* tree-ssa-loop-ivcanon.c (tree_estimate_loop_size): Fix typo\n+\tcausing branch miscounts.\n+\n 2018-10-01  Tamar Christina  <tamar.christina@arm.com>\n \n \t* common/config/aarch64/aarch64-common.c (TARGET_OPTION_DEFAULT_PARAM,"}, {"sha": "dced1ea8895592a6a3f4314dd528bdfc9300ac8e", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fd5c626c681266845dbec0e84836823a5de3a45b/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fd5c626c681266845dbec0e84836823a5de3a45b/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=fd5c626c681266845dbec0e84836823a5de3a45b", "patch": "@@ -1,3 +1,8 @@\n+2018-10-01  Richard Biener  <rguenther@suse.de>\n+\n+\tPR tree-optimization/87465\n+\t* gcc.dg/tree-ssa/cunroll-15.c: New testcase.\n+\n 2018-10-01  Tamar Christina  <tamar.christina@arm.com>\n \n \tPR target/86486"}, {"sha": "3fc752aa5482068dcae878d32382eca47b104e49", "filename": "gcc/testsuite/gcc.dg/tree-ssa/cunroll-15.c", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fd5c626c681266845dbec0e84836823a5de3a45b/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fcunroll-15.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fd5c626c681266845dbec0e84836823a5de3a45b/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fcunroll-15.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fcunroll-15.c?ref=fd5c626c681266845dbec0e84836823a5de3a45b", "patch": "@@ -0,0 +1,22 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -funroll-loops -fdump-tree-cunroll-optimized -fdump-tree-optimized\" } */\n+\n+int Test(void)\n+{\n+  int c = 0;\n+  const int in[4] = {4,3,4,4};\n+  for (unsigned i = 0; i < 4; i++) {\n+      for (unsigned j = 0; j < i; j++) {\n+\t  if (in[i] == in[j])\n+\t    break;\n+\t  else \n+\t    ++c;\n+      }\n+  }\n+  return c;\n+}\n+\n+/* { dg-final { scan-tree-dump-times \"optimized:\\[^\\n\\r\\]*completely unrolled\" 2 \"cunroll\" } } */\n+/* When SLP vectorization is enabled the following will fail because DOM\n+   doesn't know how to deal with the vectorized initializer of in.  */\n+/* { dg-final { scan-tree-dump \"return 1;\" \"optimized\" } } */"}, {"sha": "eeae2a8c54af14e58970d1797c92ecc86ac0523c", "filename": "gcc/tree-ssa-loop-ivcanon.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fd5c626c681266845dbec0e84836823a5de3a45b/gcc%2Ftree-ssa-loop-ivcanon.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fd5c626c681266845dbec0e84836823a5de3a45b/gcc%2Ftree-ssa-loop-ivcanon.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-loop-ivcanon.c?ref=fd5c626c681266845dbec0e84836823a5de3a45b", "patch": "@@ -368,8 +368,8 @@ tree_estimate_loop_size (struct loop *loop, edge exit, edge edge_to_cancel,\n \t    size->non_call_stmts_on_hot_path++;\n \t  if (((gimple_code (stmt) == GIMPLE_COND\n \t        && (!constant_after_peeling (gimple_cond_lhs (stmt), stmt, loop)\n-\t\t    || constant_after_peeling (gimple_cond_rhs (stmt), stmt,\n-\t\t\t\t\t       loop)))\n+\t\t    || !constant_after_peeling (gimple_cond_rhs (stmt), stmt,\n+\t\t\t\t\t\tloop)))\n \t       || (gimple_code (stmt) == GIMPLE_SWITCH\n \t\t   && !constant_after_peeling (gimple_switch_index (\n \t\t\t\t\t\t as_a <gswitch *> (stmt)),"}]}