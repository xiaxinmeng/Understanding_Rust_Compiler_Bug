{"sha": "192105b6a2a1f24f974de98c933f372b06c1e06d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTkyMTA1YjZhMmExZjI0Zjk3NGRlOThjOTMzZjM3MmIwNmMxZTA2ZA==", "commit": {"author": {"name": "Martin Sebor", "email": "msebor@redhat.com", "date": "2021-01-17T22:27:08Z"}, "committer": {"name": "Martin Sebor", "email": "msebor@redhat.com", "date": "2021-01-17T22:27:08Z"}, "message": "Avoid assuming SSA_NAME_IDENTIFIER is nonnull.\n\ngcc/c-family/ChangeLog:\n\n\t* c-pretty-print.c (c_pretty_printer::primary_expression): Don't\n\tassume SSA_NAME_IDENTIFIER evaluates to nonzero.", "tree": {"sha": "b1cf8ebe341926e5085e532cde20bb72a601f486", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b1cf8ebe341926e5085e532cde20bb72a601f486"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/192105b6a2a1f24f974de98c933f372b06c1e06d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/192105b6a2a1f24f974de98c933f372b06c1e06d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/192105b6a2a1f24f974de98c933f372b06c1e06d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/192105b6a2a1f24f974de98c933f372b06c1e06d/comments", "author": {"login": "msebor", "id": 381149, "node_id": "MDQ6VXNlcjM4MTE0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/381149?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msebor", "html_url": "https://github.com/msebor", "followers_url": "https://api.github.com/users/msebor/followers", "following_url": "https://api.github.com/users/msebor/following{/other_user}", "gists_url": "https://api.github.com/users/msebor/gists{/gist_id}", "starred_url": "https://api.github.com/users/msebor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msebor/subscriptions", "organizations_url": "https://api.github.com/users/msebor/orgs", "repos_url": "https://api.github.com/users/msebor/repos", "events_url": "https://api.github.com/users/msebor/events{/privacy}", "received_events_url": "https://api.github.com/users/msebor/received_events", "type": "User", "site_admin": false}, "committer": {"login": "msebor", "id": 381149, "node_id": "MDQ6VXNlcjM4MTE0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/381149?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msebor", "html_url": "https://github.com/msebor", "followers_url": "https://api.github.com/users/msebor/followers", "following_url": "https://api.github.com/users/msebor/following{/other_user}", "gists_url": "https://api.github.com/users/msebor/gists{/gist_id}", "starred_url": "https://api.github.com/users/msebor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msebor/subscriptions", "organizations_url": "https://api.github.com/users/msebor/orgs", "repos_url": "https://api.github.com/users/msebor/repos", "events_url": "https://api.github.com/users/msebor/events{/privacy}", "received_events_url": "https://api.github.com/users/msebor/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0f4c8f517b7954e113afb4d5c7212123c8ee2418", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0f4c8f517b7954e113afb4d5c7212123c8ee2418", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0f4c8f517b7954e113afb4d5c7212123c8ee2418"}], "stats": {"total": 27, "additions": 16, "deletions": 11}, "files": [{"sha": "2095d4badf7ac009fa1cbd6ad9d6ce7430aafbe3", "filename": "gcc/c-family/c-pretty-print.c", "status": "modified", "additions": 16, "deletions": 11, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/192105b6a2a1f24f974de98c933f372b06c1e06d/gcc%2Fc-family%2Fc-pretty-print.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/192105b6a2a1f24f974de98c933f372b06c1e06d/gcc%2Fc-family%2Fc-pretty-print.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2Fc-pretty-print.c?ref=192105b6a2a1f24f974de98c933f372b06c1e06d", "patch": "@@ -1340,18 +1340,23 @@ c_pretty_printer::primary_expression (tree e)\n       if (SSA_NAME_VAR (e))\n \t{\n \t  tree var = SSA_NAME_VAR (e);\n-\t  const char *name = IDENTIFIER_POINTER (SSA_NAME_IDENTIFIER (e));\n-\t  const char *dot;\n-\t  if (DECL_ARTIFICIAL (var) && (dot = strchr (name, '.')))\n+\t  if (tree id = SSA_NAME_IDENTIFIER (e))\n \t    {\n-\t      /* Print the name without the . suffix (such as in VLAs).\n-\t\t Use pp_c_identifier so that it can be converted into\n-\t\t the appropriate encoding.  */\n-\t      size_t size = dot - name;\n-\t      char *ident = XALLOCAVEC (char, size + 1);\n-\t      memcpy (ident, name, size);\n-\t      ident[size] = '\\0';\n-\t      pp_c_identifier (this, ident);\n+\t      const char *name = IDENTIFIER_POINTER (id);\n+\t      const char *dot;\n+\t      if (DECL_ARTIFICIAL (var) && (dot = strchr (name, '.')))\n+\t\t{\n+\t\t  /* Print the name without the . suffix (such as in VLAs).\n+\t\t     Use pp_c_identifier so that it can be converted into\n+\t\t     the appropriate encoding.  */\n+\t\t  size_t size = dot - name;\n+\t\t  char *ident = XALLOCAVEC (char, size + 1);\n+\t\t  memcpy (ident, name, size);\n+\t\t  ident[size] = '\\0';\n+\t\t  pp_c_identifier (this, ident);\n+\t\t}\n+\t      else\n+\t\tprimary_expression (var);\n \t    }\n \t  else\n \t    primary_expression (var);"}]}