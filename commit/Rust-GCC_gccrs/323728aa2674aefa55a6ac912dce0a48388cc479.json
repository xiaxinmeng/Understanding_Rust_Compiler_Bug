{"sha": "323728aa2674aefa55a6ac912dce0a48388cc479", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzIzNzI4YWEyNjc0YWVmYTU1YTZhYzkxMmRjZTBhNDgzODhjYzQ3OQ==", "commit": {"author": {"name": "Nathan Sidwell", "email": "nathan@codesourcery.com", "date": "2002-01-02T13:59:10Z"}, "committer": {"name": "Nathan Sidwell", "email": "nathan@gcc.gnu.org", "date": "2002-01-02T13:59:10Z"}, "message": "re PR c++/5089 (-Wold-style-cast warns about cast to void)\n\n\tPR c++/5089\n\t* doc/invoke.texi (-Wold-style-cast): Only warn about non-void casts.\ncp:\n\tPR c++/5089\n\t* decl2.c (reparse_absdcl_as_casts): Don't warn about casts to void.\ntestsuite:\n\t* g++.dg/warn/oldcast1.C: New test.\n\nFrom-SVN: r48472", "tree": {"sha": "b87648e849c6973022e42a9fe133b579e160eec2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b87648e849c6973022e42a9fe133b579e160eec2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/323728aa2674aefa55a6ac912dce0a48388cc479", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/323728aa2674aefa55a6ac912dce0a48388cc479", "html_url": "https://github.com/Rust-GCC/gccrs/commit/323728aa2674aefa55a6ac912dce0a48388cc479", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/323728aa2674aefa55a6ac912dce0a48388cc479/comments", "author": null, "committer": null, "parents": [{"sha": "46c895ac0b9468a53f08e1875b13aca83227ec5d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/46c895ac0b9468a53f08e1875b13aca83227ec5d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/46c895ac0b9468a53f08e1875b13aca83227ec5d"}], "stats": {"total": 41, "additions": 36, "deletions": 5}, "files": [{"sha": "b0b274195fc667ce49a9d2403e3176766464a9c8", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/323728aa2674aefa55a6ac912dce0a48388cc479/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/323728aa2674aefa55a6ac912dce0a48388cc479/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=323728aa2674aefa55a6ac912dce0a48388cc479", "patch": "@@ -1,3 +1,8 @@\n+2002-01-02  Nathan Sidwell  <nathan@codesourcery.com>\n+\n+\tPR c++/5089\n+\t* doc/invoke.texi (-Wold-style-cast): Only warn about non-void casts.\n+\n 2002-01-02  Kazu Hirata  <kazu@hxi.com>\n \n \t* config/h8300/fixunssfsi.c: Update copyright."}, {"sha": "e74dc1542c079a0793856d4749493f12e9f33b19", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/323728aa2674aefa55a6ac912dce0a48388cc479/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/323728aa2674aefa55a6ac912dce0a48388cc479/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=323728aa2674aefa55a6ac912dce0a48388cc479", "patch": "@@ -1,3 +1,8 @@\n+2002-01-02  Nathan Sidwell  <nathan@codesourcery.com>\n+\n+\tPR c++/5089\n+\t* decl2.c (reparse_absdcl_as_casts): Don't warn about casts to void.\n+\n 2002-01-02  Nathan Sidwell  <nathan@codesourcery.com>\n \n \tPR c++/3716"}, {"sha": "04f77c9c00ed06c0843192d6dd005a5bc102b8c1", "filename": "gcc/cp/decl2.c", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/323728aa2674aefa55a6ac912dce0a48388cc479/gcc%2Fcp%2Fdecl2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/323728aa2674aefa55a6ac912dce0a48388cc479/gcc%2Fcp%2Fdecl2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl2.c?ref=323728aa2674aefa55a6ac912dce0a48388cc479", "patch": "@@ -3615,6 +3615,7 @@ reparse_absdcl_as_casts (decl, expr)\n      tree decl, expr;\n {\n   tree type;\n+  int non_void_p = 0;\n   \n   if (TREE_CODE (expr) == CONSTRUCTOR\n       && TREE_TYPE (expr) == 0)\n@@ -3639,11 +3640,13 @@ reparse_absdcl_as_casts (decl, expr)\n     {\n       type = groktypename (TREE_VALUE (CALL_DECLARATOR_PARMS (decl)));\n       decl = TREE_OPERAND (decl, 0);\n+      if (!VOID_TYPE_P (type))\n+\tnon_void_p = 1;\n       expr = build_c_cast (type, expr);\n     }\n \n   if (warn_old_style_cast && ! in_system_header\n-      && current_lang_name != lang_name_c)\n+      && non_void_p && current_lang_name != lang_name_c)\n     warning (\"use of old-style cast\");\n \n   return expr;"}, {"sha": "4a6ed0c4aeda8ed71ab812d56561dd66f69d128d", "filename": "gcc/doc/invoke.texi", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/323728aa2674aefa55a6ac912dce0a48388cc479/gcc%2Fdoc%2Finvoke.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/323728aa2674aefa55a6ac912dce0a48388cc479/gcc%2Fdoc%2Finvoke.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdoc%2Finvoke.texi?ref=323728aa2674aefa55a6ac912dce0a48388cc479", "patch": "@@ -1557,10 +1557,10 @@ but disables the helpful warning.\n \n @item -Wold-style-cast @r{(C++ only)}\n @opindex Wold-style-cast\n-Warn if an old-style (C-style) cast is used within a C++ program.  The\n-new-style casts (@samp{static_cast}, @samp{reinterpret_cast}, and\n-@samp{const_cast}) are less vulnerable to unintended effects, and much\n-easier to grep for.\n+Warn if an old-style (C-style) cast to a non-void type is used within\n+a C++ program.  The new-style casts (@samp{static_cast},\n+@samp{reinterpret_cast}, and @samp{const_cast}) are less vulnerable to\n+unintended effects, and much easier to grep for.\n \n @item -Woverloaded-virtual @r{(C++ only)}\n @opindex Woverloaded-virtual"}, {"sha": "7e2fa439c13b5e1d9129fba8475bb882071002bc", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/323728aa2674aefa55a6ac912dce0a48388cc479/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/323728aa2674aefa55a6ac912dce0a48388cc479/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=323728aa2674aefa55a6ac912dce0a48388cc479", "patch": "@@ -1,5 +1,7 @@\n 2002-01-02  Nathan Sidwell  <nathan@codesourcery.com>\n \n+\t* g++.dg/warn/oldcast1.C: New test.\n+\n \t* g++.dg/template/ptrmem1.C: New test.\n \t* g++.dg/template/ptrmem2.C: New test.\n "}, {"sha": "26c0a5c4d008667f3a015bededf045f9f0366ac1", "filename": "gcc/testsuite/g++.dg/warn/oldcast1.C", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/323728aa2674aefa55a6ac912dce0a48388cc479/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2Foldcast1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/323728aa2674aefa55a6ac912dce0a48388cc479/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2Foldcast1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2Foldcast1.C?ref=323728aa2674aefa55a6ac912dce0a48388cc479", "patch": "@@ -0,0 +1,16 @@\n+// { dg-do compile }\n+// { dg-options \"-ansi -pedantic-errors -Wold-style-cast\" }\n+\n+// Copyright (C) 2001 Free Software Foundation, Inc.\n+// Contributed by Nathan Sidwell 26 Dec 2001 <nathan@codesourcery.com>\n+\n+// PR 5089. old style cast to void should be permitted (think assert)\n+\n+void foo ()\n+{\n+  int i;\n+  float f = (float)i;  // { dg-warning \"use of old-style cast\" \"\" }\n+\n+  (void)i;\n+}\n+"}]}