{"sha": "ee440dd05de292dde12376f8a977d2a4bf22c2c3", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWU0NDBkZDA1ZGUyOTJkZGUxMjM3NmY4YTk3N2QyYTRiZjIyYzJjMw==", "commit": {"author": {"name": "Thomas Koenig", "email": "tkoenig@gcc.gnu.org", "date": "2008-02-02T13:50:55Z"}, "committer": {"name": "Thomas Koenig", "email": "tkoenig@gcc.gnu.org", "date": "2008-02-02T13:50:55Z"}, "message": "re PR libfortran/35001 (shape for negative sizes)\n\n2008-02-02  Thomas Koenig  <tkoenig@gcc.gnu.org>\n\n\tPR libfortran/35001\n\t* m4/shape.m4:  Return 0 for extents <= 0.\n\t* generated/shape_i4.c:  Regenerated.\n\t* generated/shape_i8.c:  Regenerated.\n\t* generated/shape_i16.c:  Regenerated.\n\n2008-02-02  Thomas Koenig  <tkoenig@gcc.gnu.org>\n\n\tPR libfortran/35001\n\t* gfortran.dg/shape_4.f90:  New test.\n\nFixed in regression-only mode by special dispense (see the PR).\n\nFrom-SVN: r132070", "tree": {"sha": "41b636e47d1922843adc517116bfd40c4acb7428", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/41b636e47d1922843adc517116bfd40c4acb7428"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ee440dd05de292dde12376f8a977d2a4bf22c2c3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ee440dd05de292dde12376f8a977d2a4bf22c2c3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ee440dd05de292dde12376f8a977d2a4bf22c2c3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ee440dd05de292dde12376f8a977d2a4bf22c2c3/comments", "author": null, "committer": null, "parents": [{"sha": "27f56cb1f2c371e33b32e1adb1f0f571c1266c41", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/27f56cb1f2c371e33b32e1adb1f0f571c1266c41", "html_url": "https://github.com/Rust-GCC/gccrs/commit/27f56cb1f2c371e33b32e1adb1f0f571c1266c41"}], "stats": {"total": 45, "additions": 37, "deletions": 8}, "files": [{"sha": "06cd1b139edeb48e80657bb53dba4ee91a7a7af3", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ee440dd05de292dde12376f8a977d2a4bf22c2c3/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ee440dd05de292dde12376f8a977d2a4bf22c2c3/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=ee440dd05de292dde12376f8a977d2a4bf22c2c3", "patch": "@@ -1,3 +1,8 @@\n+2008-02-02  Thomas Koenig  <tkoenig@gcc.gnu.org>\n+\n+\tPR libfortran/35001\n+\t* gfortran.dg/shape_4.f90:  New test.\n+\n 2008-02-02  Hans-Peter Nilsson  <hp@axis.com>\n \n \t* gcc.target/cris/torture/pr34773.c: Use __asm__, not asm."}, {"sha": "9275b11b8fd336f6a52b1f691bedc94d8cd08583", "filename": "gcc/testsuite/gfortran.dg/shape_4.f90", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ee440dd05de292dde12376f8a977d2a4bf22c2c3/gcc%2Ftestsuite%2Fgfortran.dg%2Fshape_4.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ee440dd05de292dde12376f8a977d2a4bf22c2c3/gcc%2Ftestsuite%2Fgfortran.dg%2Fshape_4.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fshape_4.f90?ref=ee440dd05de292dde12376f8a977d2a4bf22c2c3", "patch": "@@ -0,0 +1,12 @@\n+! PR 35001 - we need to return 0 for the shapes of\n+! negative extents.  Test case adapted from Tobias Burnus.\n+program main\n+  implicit none\n+  integer :: i,j, a(10,10),res(2)\n+  j = 1\n+  i = 10\n+  res = shape(a(1:1,i:j:1))\n+  if (res(1) /=1 .or. res(2) /= 0) call abort\n+  res = shape(a(1:1,j:i:-1))\n+  if (res(1) /=1 .or. res(2) /= 0) call abort\n+end program main"}, {"sha": "432aa56ee44e0306a4b8c0fbb6a6012ccc1c0a0a", "filename": "libgfortran/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ee440dd05de292dde12376f8a977d2a4bf22c2c3/libgfortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ee440dd05de292dde12376f8a977d2a4bf22c2c3/libgfortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2FChangeLog?ref=ee440dd05de292dde12376f8a977d2a4bf22c2c3", "patch": "@@ -1,3 +1,11 @@\n+2008-02-02  Thomas Koenig  <tkoenig@gcc.gnu.org>\n+\n+\tPR libfortran/35001\n+\t* m4/shape.m4:  Return 0 for extents <= 0.\n+\t* generated/shape_i4.c:  Regenerated.\n+\t* generated/shape_i8.c:  Regenerated.\n+\t* generated/shape_i16.c:  Regenerated.\n+\n 2008-01-27  Thomas Koenig  <tkoenig@gcc.gnu.org>\n \n \tPR libfortran/34980"}, {"sha": "0ab2654bd8ccf06d9f07c2775343e460d338aa5b", "filename": "libgfortran/generated/shape_i16.c", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ee440dd05de292dde12376f8a977d2a4bf22c2c3/libgfortran%2Fgenerated%2Fshape_i16.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ee440dd05de292dde12376f8a977d2a4bf22c2c3/libgfortran%2Fgenerated%2Fshape_i16.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fgenerated%2Fshape_i16.c?ref=ee440dd05de292dde12376f8a977d2a4bf22c2c3", "patch": "@@ -45,6 +45,7 @@ shape_16 (gfc_array_i16 * const restrict ret,\n {\n   int n;\n   index_type stride;\n+  index_type extent;\n \n   stride = ret->dim[0].stride;\n \n@@ -53,8 +54,8 @@ shape_16 (gfc_array_i16 * const restrict ret,\n \n   for (n = 0; n < GFC_DESCRIPTOR_RANK (array); n++)\n     {\n-      ret->data[n * stride] =\n-        array->dim[n].ubound + 1 - array->dim[n].lbound;\n+      extent = array->dim[n].ubound + 1 - array->dim[n].lbound;\n+      ret->data[n * stride] = extent > 0 ? extent : 0 ;\n     }\n }\n "}, {"sha": "64a6fcdb994275eb165f95e2e685d8b0d47e6b31", "filename": "libgfortran/generated/shape_i4.c", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ee440dd05de292dde12376f8a977d2a4bf22c2c3/libgfortran%2Fgenerated%2Fshape_i4.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ee440dd05de292dde12376f8a977d2a4bf22c2c3/libgfortran%2Fgenerated%2Fshape_i4.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fgenerated%2Fshape_i4.c?ref=ee440dd05de292dde12376f8a977d2a4bf22c2c3", "patch": "@@ -45,6 +45,7 @@ shape_4 (gfc_array_i4 * const restrict ret,\n {\n   int n;\n   index_type stride;\n+  index_type extent;\n \n   stride = ret->dim[0].stride;\n \n@@ -53,8 +54,8 @@ shape_4 (gfc_array_i4 * const restrict ret,\n \n   for (n = 0; n < GFC_DESCRIPTOR_RANK (array); n++)\n     {\n-      ret->data[n * stride] =\n-        array->dim[n].ubound + 1 - array->dim[n].lbound;\n+      extent = array->dim[n].ubound + 1 - array->dim[n].lbound;\n+      ret->data[n * stride] = extent > 0 ? extent : 0 ;\n     }\n }\n "}, {"sha": "80bef318b81a2bd1cd782cb6170b2f2f4d789dcd", "filename": "libgfortran/generated/shape_i8.c", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ee440dd05de292dde12376f8a977d2a4bf22c2c3/libgfortran%2Fgenerated%2Fshape_i8.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ee440dd05de292dde12376f8a977d2a4bf22c2c3/libgfortran%2Fgenerated%2Fshape_i8.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fgenerated%2Fshape_i8.c?ref=ee440dd05de292dde12376f8a977d2a4bf22c2c3", "patch": "@@ -45,6 +45,7 @@ shape_8 (gfc_array_i8 * const restrict ret,\n {\n   int n;\n   index_type stride;\n+  index_type extent;\n \n   stride = ret->dim[0].stride;\n \n@@ -53,8 +54,8 @@ shape_8 (gfc_array_i8 * const restrict ret,\n \n   for (n = 0; n < GFC_DESCRIPTOR_RANK (array); n++)\n     {\n-      ret->data[n * stride] =\n-        array->dim[n].ubound + 1 - array->dim[n].lbound;\n+      extent = array->dim[n].ubound + 1 - array->dim[n].lbound;\n+      ret->data[n * stride] = extent > 0 ? extent : 0 ;\n     }\n }\n "}, {"sha": "c783270bec7f54f4fcdf2f1f7d98b43f31e729b7", "filename": "libgfortran/m4/shape.m4", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ee440dd05de292dde12376f8a977d2a4bf22c2c3/libgfortran%2Fm4%2Fshape.m4", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ee440dd05de292dde12376f8a977d2a4bf22c2c3/libgfortran%2Fm4%2Fshape.m4", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fm4%2Fshape.m4?ref=ee440dd05de292dde12376f8a977d2a4bf22c2c3", "patch": "@@ -46,6 +46,7 @@ shape_'rtype_kind` ('rtype` * const restrict ret,\n {\n   int n;\n   index_type stride;\n+  index_type extent;\n \n   stride = ret->dim[0].stride;\n \n@@ -54,8 +55,8 @@ shape_'rtype_kind` ('rtype` * const restrict ret,\n \n   for (n = 0; n < GFC_DESCRIPTOR_RANK (array); n++)\n     {\n-      ret->data[n * stride] =\n-        array->dim[n].ubound + 1 - array->dim[n].lbound;\n+      extent = array->dim[n].ubound + 1 - array->dim[n].lbound;\n+      ret->data[n * stride] = extent > 0 ? extent : 0 ;\n     }\n }\n "}]}