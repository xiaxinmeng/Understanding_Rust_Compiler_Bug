{"sha": "67321dcf21659f2d12d278ce8ef6250bd0eca714", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjczMjFkY2YyMTY1OWYyZDEyZDI3OGNlOGVmNjI1MGJkMGVjYTcxNA==", "commit": {"author": {"name": "Ilya Enkovich", "email": "ilya.enkovich@intel.com", "date": "2015-06-03T11:31:08Z"}, "committer": {"name": "Ilya Enkovich", "email": "ienkovich@gcc.gnu.org", "date": "2015-06-03T11:31:08Z"}, "message": "ipa-chkp.c (chkp_maybe_create_clone): Create alias reference when cloning alias node.\n\ngcc/\n\n\t* ipa-chkp.c (chkp_maybe_create_clone): Create alias\n\treference when cloning alias node.\n\ngcc/testsuite/\n\n\t* gcc.dg/lto/chkp-removed-alias_0.c: New.\n\nFrom-SVN: r224074", "tree": {"sha": "159c20a41fd9ceadaaad8b776d8940570e672050", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/159c20a41fd9ceadaaad8b776d8940570e672050"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/67321dcf21659f2d12d278ce8ef6250bd0eca714", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/67321dcf21659f2d12d278ce8ef6250bd0eca714", "html_url": "https://github.com/Rust-GCC/gccrs/commit/67321dcf21659f2d12d278ce8ef6250bd0eca714", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/67321dcf21659f2d12d278ce8ef6250bd0eca714/comments", "author": {"login": "ienkovich", "id": 18308708, "node_id": "MDQ6VXNlcjE4MzA4NzA4", "avatar_url": "https://avatars.githubusercontent.com/u/18308708?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ienkovich", "html_url": "https://github.com/ienkovich", "followers_url": "https://api.github.com/users/ienkovich/followers", "following_url": "https://api.github.com/users/ienkovich/following{/other_user}", "gists_url": "https://api.github.com/users/ienkovich/gists{/gist_id}", "starred_url": "https://api.github.com/users/ienkovich/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ienkovich/subscriptions", "organizations_url": "https://api.github.com/users/ienkovich/orgs", "repos_url": "https://api.github.com/users/ienkovich/repos", "events_url": "https://api.github.com/users/ienkovich/events{/privacy}", "received_events_url": "https://api.github.com/users/ienkovich/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "b2b43e33298fd62d7348696044e51086a02b0cb2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b2b43e33298fd62d7348696044e51086a02b0cb2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b2b43e33298fd62d7348696044e51086a02b0cb2"}], "stats": {"total": 49, "additions": 42, "deletions": 7}, "files": [{"sha": "d83cf50c7d9d256b32c4e99c451886745d41aa27", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/67321dcf21659f2d12d278ce8ef6250bd0eca714/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/67321dcf21659f2d12d278ce8ef6250bd0eca714/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=67321dcf21659f2d12d278ce8ef6250bd0eca714", "patch": "@@ -1,3 +1,8 @@\n+2015-06-03  Ilya Enkovich  <ilya.enkovich@intel.com>\n+\n+\t* ipa-chkp.c (chkp_maybe_create_clone): Create alias\n+\treference when cloning alias node.\n+\n 2015-06-03  Martin Liska  <mliska@suse.cz>\n \n \t* alloc-pool.h (struct pool_usage): Correct space padding."}, {"sha": "87e21cae83c0b061da7242bce278e05199dc649a", "filename": "gcc/ipa-chkp.c", "status": "modified", "additions": 5, "deletions": 7, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/67321dcf21659f2d12d278ce8ef6250bd0eca714/gcc%2Fipa-chkp.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/67321dcf21659f2d12d278ce8ef6250bd0eca714/gcc%2Fipa-chkp.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-chkp.c?ref=67321dcf21659f2d12d278ce8ef6250bd0eca714", "patch": "@@ -616,12 +616,7 @@ chkp_maybe_create_clone (tree fndecl)\n \n       /* Clone all aliases.  */\n       for (i = 0; node->iterate_direct_aliases (i, ref); i++)\n-\t{\n-\t  struct cgraph_node *alias = dyn_cast <cgraph_node *> (ref->referring);\n-\t  struct cgraph_node *chkp_alias\n-\t    = chkp_maybe_create_clone (alias->decl);\n-\t  chkp_alias->create_reference (clone, IPA_REF_ALIAS, NULL);\n-\t}\n+\tchkp_maybe_create_clone (ref->referring->decl);\n \n       /* Clone all thunks.  */\n       for (e = node->callers; e; e = e->next_caller)\n@@ -645,7 +640,10 @@ chkp_maybe_create_clone (tree fndecl)\n \n \t  ref = node->ref_list.first_reference ();\n \t  if (ref)\n-\t    chkp_maybe_create_clone (ref->referred->decl);\n+\t    {\n+\t      target = chkp_maybe_create_clone (ref->referred->decl);\n+\t      clone->create_reference (target, IPA_REF_ALIAS);\n+\t    }\n \n \t  if (node->alias_target)\n \t    {"}, {"sha": "55672821460d5ca5bb0c69b92681e2747a057f42", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/67321dcf21659f2d12d278ce8ef6250bd0eca714/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/67321dcf21659f2d12d278ce8ef6250bd0eca714/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=67321dcf21659f2d12d278ce8ef6250bd0eca714", "patch": "@@ -1,3 +1,7 @@\n+2015-06-03  Ilya Enkovich  <ilya.enkovich@intel.com>\n+\n+\t* gcc.dg/lto/chkp-removed-alias_0.c: New.\n+\n 2015-06-03  Ilya Enkovich  <ilya.enkovich@intel.com>\n \n \t* gcc.dg/lto/chkp-privatize-1_0.c: New."}, {"sha": "96d728d5122a26478d28616f811e350020df9138", "filename": "gcc/testsuite/gcc.dg/lto/chkp-removed-alias_0.c", "status": "added", "additions": 28, "deletions": 0, "changes": 28, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/67321dcf21659f2d12d278ce8ef6250bd0eca714/gcc%2Ftestsuite%2Fgcc.dg%2Flto%2Fchkp-removed-alias_0.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/67321dcf21659f2d12d278ce8ef6250bd0eca714/gcc%2Ftestsuite%2Fgcc.dg%2Flto%2Fchkp-removed-alias_0.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Flto%2Fchkp-removed-alias_0.c?ref=67321dcf21659f2d12d278ce8ef6250bd0eca714", "patch": "@@ -0,0 +1,28 @@\n+/* { dg-lto-do link } */\n+/* { dg-require-effective-target mpx } */\n+/* { dg-lto-options { { -O2 -flto -flto-partition=max -fcheck-pointer-bounds -mmpx } } } */\n+\n+int test1 (const char *c)\n+{\n+  return c[0] * 2;\n+}\n+\n+int test2 (const char *c)\n+{\n+  return c[1] * 3;\n+}\n+\n+int test1_alias (const char *c) __attribute__ ((alias (\"test1\")));\n+int test2_alias (const char *c) __attribute__ ((alias (\"test2\")));\n+\n+struct S\n+{\n+  int (*fnptr[2]) (const char *);\n+} S;\n+\n+struct S s = {test1_alias, test2_alias};\n+\n+int main (int argc, const char **argv)\n+{\n+  return s.fnptr[argc] (argv[0]);\n+}"}]}