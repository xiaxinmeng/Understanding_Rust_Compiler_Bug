{"sha": "b93d8a3f16bc7582254edf988b14009587fe00a6", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjkzZDhhM2YxNmJjNzU4MjI1NGVkZjk4OGIxNDAwOTU4N2ZlMDBhNg==", "commit": {"author": {"name": "Janus Weil", "email": "janus@gcc.gnu.org", "date": "2016-11-12T09:25:47Z"}, "committer": {"name": "Janus Weil", "email": "janus@gcc.gnu.org", "date": "2016-11-12T09:25:47Z"}, "message": "re PR fortran/77501 ([F03] ICE in gfc_match_generic, at fortran/decl.c:9429)\n\n2016-11-12  Janus Weil  <janus@gcc.gnu.org>\n\n\tPR fortran/77501\n\t* class.c (gfc_find_typebound_intrinsic_op): Remove an unnecessary\n\tassert and nullification.\n\t* decl.c (gfc_match_decl_type_spec): Use gfc_get_tbp_symtree,\n\tfix indentation.\n\t(gfc_match_generic): Remove an unnecessary assert.\n\tUse gfc_get_tbp_symtree to avoid ICE.\n\n2016-11-12  Janus Weil  <janus@gcc.gnu.org>\n\n\tPR fortran/77501\n\t* gfortran.dg/typebound_generic_16.f90: New test.\n\nFrom-SVN: r242335", "tree": {"sha": "a92471f741422298fc072b9fce90e59618cc8d65", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a92471f741422298fc072b9fce90e59618cc8d65"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b93d8a3f16bc7582254edf988b14009587fe00a6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b93d8a3f16bc7582254edf988b14009587fe00a6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b93d8a3f16bc7582254edf988b14009587fe00a6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b93d8a3f16bc7582254edf988b14009587fe00a6/comments", "author": {"login": "janusw", "id": 484108, "node_id": "MDQ6VXNlcjQ4NDEwOA==", "avatar_url": "https://avatars.githubusercontent.com/u/484108?v=4", "gravatar_id": "", "url": "https://api.github.com/users/janusw", "html_url": "https://github.com/janusw", "followers_url": "https://api.github.com/users/janusw/followers", "following_url": "https://api.github.com/users/janusw/following{/other_user}", "gists_url": "https://api.github.com/users/janusw/gists{/gist_id}", "starred_url": "https://api.github.com/users/janusw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/janusw/subscriptions", "organizations_url": "https://api.github.com/users/janusw/orgs", "repos_url": "https://api.github.com/users/janusw/repos", "events_url": "https://api.github.com/users/janusw/events{/privacy}", "received_events_url": "https://api.github.com/users/janusw/received_events", "type": "User", "site_admin": false}, "committer": {"login": "janusw", "id": 484108, "node_id": "MDQ6VXNlcjQ4NDEwOA==", "avatar_url": "https://avatars.githubusercontent.com/u/484108?v=4", "gravatar_id": "", "url": "https://api.github.com/users/janusw", "html_url": "https://github.com/janusw", "followers_url": "https://api.github.com/users/janusw/followers", "following_url": "https://api.github.com/users/janusw/following{/other_user}", "gists_url": "https://api.github.com/users/janusw/gists{/gist_id}", "starred_url": "https://api.github.com/users/janusw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/janusw/subscriptions", "organizations_url": "https://api.github.com/users/janusw/orgs", "repos_url": "https://api.github.com/users/janusw/repos", "events_url": "https://api.github.com/users/janusw/events{/privacy}", "received_events_url": "https://api.github.com/users/janusw/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "330cc73d9838aa51c162f29ed1e5ccf659b440d3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/330cc73d9838aa51c162f29ed1e5ccf659b440d3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/330cc73d9838aa51c162f29ed1e5ccf659b440d3"}], "stats": {"total": 72, "additions": 44, "deletions": 28}, "files": [{"sha": "6e0b654eb0e32125b1fdaef97d803cb38de72c32", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b93d8a3f16bc7582254edf988b14009587fe00a6/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b93d8a3f16bc7582254edf988b14009587fe00a6/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=b93d8a3f16bc7582254edf988b14009587fe00a6", "patch": "@@ -1,3 +1,13 @@\n+2016-11-12  Janus Weil  <janus@gcc.gnu.org>\n+\n+\tPR fortran/77501\n+\t* class.c (gfc_find_typebound_intrinsic_op): Remove an unnecessary\n+\tassert and nullification.\n+\t* decl.c (gfc_match_decl_type_spec): Use gfc_get_tbp_symtree,\n+\tfix indentation.\n+\t(gfc_match_generic): Remove an unnecessary assert.\n+\tUse gfc_get_tbp_symtree to avoid ICE.\n+\n 2016-11-10  Fritz O. Reese <fritzoreese@gmail.com>\n \n \tPR fortran/78277"}, {"sha": "b42ec40578f065868e8a61477b6622a01b7ca722", "filename": "gcc/fortran/class.c", "status": "modified", "additions": 2, "deletions": 11, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b93d8a3f16bc7582254edf988b14009587fe00a6/gcc%2Ffortran%2Fclass.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b93d8a3f16bc7582254edf988b14009587fe00a6/gcc%2Ffortran%2Fclass.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fclass.c?ref=b93d8a3f16bc7582254edf988b14009587fe00a6", "patch": "@@ -2963,15 +2963,6 @@ gfc_find_typebound_intrinsic_op (gfc_symbol* derived, bool* t,\n gfc_symtree*\n gfc_get_tbp_symtree (gfc_symtree **root, const char *name)\n {\n-  gfc_symtree *result;\n-\n-  result = gfc_find_symtree (*root, name);\n-  if (!result)\n-    {\n-      result = gfc_new_symtree (root, name);\n-      gcc_assert (result);\n-      result->n.tb = NULL;\n-    }\n-\n-  return result;\n+  gfc_symtree *result = gfc_find_symtree (*root, name);\n+  return result ? result : gfc_new_symtree (root, name);\n }"}, {"sha": "b17a8aa7da242cde3d0d4f454d4f989115c64bfa", "filename": "gcc/fortran/decl.c", "status": "modified", "additions": 6, "deletions": 17, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b93d8a3f16bc7582254edf988b14009587fe00a6/gcc%2Ffortran%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b93d8a3f16bc7582254edf988b14009587fe00a6/gcc%2Ffortran%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fdecl.c?ref=b93d8a3f16bc7582254edf988b14009587fe00a6", "patch": "@@ -3198,13 +3198,11 @@ gfc_match_decl_type_spec (gfc_typespec *ts, int implicit_flag)\n \t      upe->attr.zero_comp = 1;\n \t      if (!gfc_add_flavor (&upe->attr, FL_DERIVED, NULL,\n \t\t\t\t   &gfc_current_locus))\n-\t  return MATCH_ERROR;\n-\t}\n+\t      return MATCH_ERROR;\n+\t    }\n \t  else\n \t    {\n-\t      st = gfc_find_symtree (gfc_current_ns->sym_root, \"STAR\");\n-\t      if (st == NULL)\n-\t\tst = gfc_new_symtree (&gfc_current_ns->sym_root, \"STAR\");\n+\t      st = gfc_get_tbp_symtree (&gfc_current_ns->sym_root, \"STAR\");\n \t      st->n.sym = upe;\n \t      upe->refs++;\n \t    }\n@@ -9731,14 +9729,7 @@ gfc_match_generic (void)\n \tgfc_symtree* st;\n \n \tst = gfc_find_symtree (is_op ? ns->tb_uop_root : ns->tb_sym_root, name);\n-\tif (st)\n-\t  {\n-\t    tb = st->n.tb;\n-\t    gcc_assert (tb);\n-\t  }\n-\telse\n-\t  tb = NULL;\n-\n+\ttb = st ? st->n.tb : NULL;\n \tbreak;\n       }\n \n@@ -9783,10 +9774,8 @@ gfc_match_generic (void)\n \tcase INTERFACE_USER_OP:\n \t  {\n \t    const bool is_op = (op_type == INTERFACE_USER_OP);\n-\t    gfc_symtree* st;\n-\n-\t    st = gfc_new_symtree (is_op ? &ns->tb_uop_root : &ns->tb_sym_root,\n-\t\t\t\t  name);\n+\t    gfc_symtree* st = gfc_get_tbp_symtree (is_op ? &ns->tb_uop_root :\n+\t\t\t\t\t\t   &ns->tb_sym_root, name);\n \t    gcc_assert (st);\n \t    st->n.tb = tb;\n "}, {"sha": "dc6198a4d24cbc4106a1c3cf637b87dac7173cc9", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b93d8a3f16bc7582254edf988b14009587fe00a6/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b93d8a3f16bc7582254edf988b14009587fe00a6/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=b93d8a3f16bc7582254edf988b14009587fe00a6", "patch": "@@ -1,3 +1,8 @@\n+2016-11-12  Janus Weil  <janus@gcc.gnu.org>\n+\n+\tPR fortran/77501\n+\t* gfortran.dg/typebound_generic_16.f90: New test.\n+\n 2016-11-12  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR c++/71225"}, {"sha": "0043fbb215262e56eccad378ed769cf7dbbf2908", "filename": "gcc/testsuite/gfortran.dg/typebound_generic_16.f90", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b93d8a3f16bc7582254edf988b14009587fe00a6/gcc%2Ftestsuite%2Fgfortran.dg%2Ftypebound_generic_16.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b93d8a3f16bc7582254edf988b14009587fe00a6/gcc%2Ftestsuite%2Fgfortran.dg%2Ftypebound_generic_16.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Ftypebound_generic_16.f90?ref=b93d8a3f16bc7582254edf988b14009587fe00a6", "patch": "@@ -0,0 +1,21 @@\n+! { dg-do compile }\n+!\n+! PR 77501: [F03] ICE in gfc_match_generic, at fortran/decl.c:9429\n+!\n+! Contributed by Gerhard Steinmetz <gerhard.steinmetz.fortran@t-online.de>\n+\n+module m1\n+  type t\n+  contains\n+    generic :: f => g  ! { dg-error \"must target a specific binding\" }\n+    generic :: g => h  ! { dg-error \"Undefined specific binding\" }\n+  end type\n+end\n+\n+module m2\n+  type t\n+  contains\n+    generic :: f => g  ! { dg-error \"must target a specific binding\" }\n+    generic :: g => f  ! { dg-error \"Undefined specific binding\" }\n+  end type\n+end"}]}