{"sha": "9be132116ffa940ced88cd60f5833a96af263937", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWJlMTMyMTE2ZmZhOTQwY2VkODhjZDYwZjU4MzNhOTZhZjI2MzkzNw==", "commit": {"author": {"name": "DJ Delorie", "email": "dj@redhat.com", "date": "2003-05-05T15:25:01Z"}, "committer": {"name": "DJ Delorie", "email": "dj@gcc.gnu.org", "date": "2003-05-05T15:25:01Z"}, "message": "stormy16.md (negsi2): Allocate the pseudos before reload, but defer the split until after.\n\n* config/stormy16/stormy16.md (negsi2): Allocate the pseudos\nbefore reload, but defer the split until after.\n* config/stormy16/stormy16.c (xstormy16_expand_arith): Modify\nto match.\n\nFrom-SVN: r66485", "tree": {"sha": "5d76d6689e2343d7cd7bd4baf6411eed836615c1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5d76d6689e2343d7cd7bd4baf6411eed836615c1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9be132116ffa940ced88cd60f5833a96af263937", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9be132116ffa940ced88cd60f5833a96af263937", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9be132116ffa940ced88cd60f5833a96af263937", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9be132116ffa940ced88cd60f5833a96af263937/comments", "author": null, "committer": null, "parents": [{"sha": "517f33152b70ac5d86d4dbc6e75f6bfabe6b49b7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/517f33152b70ac5d86d4dbc6e75f6bfabe6b49b7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/517f33152b70ac5d86d4dbc6e75f6bfabe6b49b7"}], "stats": {"total": 40, "additions": 26, "deletions": 14}, "files": [{"sha": "5ea7593ccc83e82760e4f92d74de9b6c2949765f", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9be132116ffa940ced88cd60f5833a96af263937/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9be132116ffa940ced88cd60f5833a96af263937/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=9be132116ffa940ced88cd60f5833a96af263937", "patch": "@@ -1,3 +1,10 @@\n+2003-05-05  DJ Delorie  <dj@redhat.com>\n+\n+\t* config/stormy16/stormy16.md (negsi2): Allocate the pseudos\n+\tbefore reload, but defer the split until after.\n+\t* config/stormy16/stormy16.c (xstormy16_expand_arith): Modify\n+\tto match.\n+\n 2003-05-05  David Edelsohn  <edelsohn@gnu.org>\n \n \t* config/rs6000/rs6000.h (ASM_CPU_SPEC): Add 440 support."}, {"sha": "d819981ea9a4537de261f078a8a276cb8e73c0fb", "filename": "gcc/config/stormy16/stormy16.c", "status": "modified", "additions": 3, "deletions": 10, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9be132116ffa940ced88cd60f5833a96af263937/gcc%2Fconfig%2Fstormy16%2Fstormy16.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9be132116ffa940ced88cd60f5833a96af263937/gcc%2Fconfig%2Fstormy16%2Fstormy16.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fstormy16%2Fstormy16.c?ref=9be132116ffa940ced88cd60f5833a96af263937", "patch": "@@ -1873,22 +1873,15 @@ xstormy16_expand_arith (mode, code, dest, src0, src1, carry)\n   int firstloop = 1;\n \n   if (code == NEG)\n-    {\n-      rtx zero_reg = gen_reg_rtx (word_mode);\n-      emit_move_insn (zero_reg, src0);\n-      src0 = zero_reg;\n-    }\n+    emit_move_insn (src0, const0_rtx);\n   \n   for (i = 0; i < num_words; i++)\n     {\n       rtx w_src0, w_src1, w_dest;\n       rtx insn;\n       \n-      if (code == NEG)\n-\tw_src0 = src0;\n-      else\n-\tw_src0 = simplify_gen_subreg (word_mode, src0, mode, \n-\t\t\t\t      i * UNITS_PER_WORD);\n+      w_src0 = simplify_gen_subreg (word_mode, src0, mode, \n+\t\t\t\t    i * UNITS_PER_WORD);\n       w_src1 = simplify_gen_subreg (word_mode, src1, mode, i * UNITS_PER_WORD);\n       w_dest = simplify_gen_subreg (word_mode, dest, mode, i * UNITS_PER_WORD);\n "}, {"sha": "0e52b5377cdfa3e53cde73b8d44e448c2b45e627", "filename": "gcc/config/stormy16/stormy16.md", "status": "modified", "additions": 16, "deletions": 4, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9be132116ffa940ced88cd60f5833a96af263937/gcc%2Fconfig%2Fstormy16%2Fstormy16.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9be132116ffa940ced88cd60f5833a96af263937/gcc%2Fconfig%2Fstormy16%2Fstormy16.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fstormy16%2Fstormy16.md?ref=9be132116ffa940ced88cd60f5833a96af263937", "patch": "@@ -603,11 +603,23 @@\n   [(set_attr \"length\" \"4\")])\n \n (define_expand \"negsi2\"\n-  [(set (match_operand:SI 0 \"register_operand\" \"\")\n-\t(neg:SI (match_operand:SI 1 \"register_operand\" \"\")))]\n+  [(parallel [(set (match_operand:SI 0 \"register_operand\" \"\")\n+\t\t   (neg:SI (match_operand:SI 1 \"register_operand\" \"\")))\n+\t      (clobber (match_scratch:BI 2 \"\"))])]\n+  \"\"\n+  \"{ operands[2] = gen_reg_rtx (HImode);\n+     operands[3] = gen_reg_rtx (BImode); }\")\n+\n+(define_insn_and_split \"*negsi2_internal\"\n+  [(set (match_operand:SI 0 \"register_operand\" \"=&r\")\n+\t(neg:SI (match_operand:SI 1 \"register_operand\" \"r\")))\n+   (clobber (match_scratch:BI 2 \"=y\"))]\n   \"\"\n-  \"{ xstormy16_expand_arith (SImode, NEG, operands[0], const0_rtx,\n-\t\t\t    operands[1], gen_reg_rtx (BImode)); DONE; }\")\n+  \"#\"\n+  \"reload_completed\"\n+  [(pc)]\n+  \"{ xstormy16_expand_arith (SImode, NEG, operands[0], operands[0],\n+\t\t\t    operands[1], operands[2]); DONE; }\")\n \n ;; ::::::::::::::::::::\n ;; ::"}]}