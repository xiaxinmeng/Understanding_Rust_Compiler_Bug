{"sha": "931e6c29a71dfc9923a9a106c112ddfb1bc66112", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTMxZTZjMjlhNzFkZmM5OTIzYTlhMTA2YzExMmRkZmIxYmM2NjExMg==", "commit": {"author": {"name": "Ulrich Weigand", "email": "uweigand@de.ibm.com", "date": "2004-09-26T19:13:38Z"}, "committer": {"name": "Ulrich Weigand", "email": "uweigand@gcc.gnu.org", "date": "2004-09-26T19:13:38Z"}, "message": "builtins.c (get_memory_rtx): Set mem attributes for non-ADDR_EXPR expressions.\n\n\t* builtins.c (get_memory_rtx): Set mem attributes for non-ADDR_EXPR\n\texpressions.  Always clear MEM_SIZE and alias set.\n\nFrom-SVN: r88141", "tree": {"sha": "21b084b994ebe3cbc6197ae46e37bbcce7b16519", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/21b084b994ebe3cbc6197ae46e37bbcce7b16519"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/931e6c29a71dfc9923a9a106c112ddfb1bc66112", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/931e6c29a71dfc9923a9a106c112ddfb1bc66112", "html_url": "https://github.com/Rust-GCC/gccrs/commit/931e6c29a71dfc9923a9a106c112ddfb1bc66112", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/931e6c29a71dfc9923a9a106c112ddfb1bc66112/comments", "author": null, "committer": null, "parents": [{"sha": "3bd2680ed5ffc1442ece7ea37ea0439b8358ac6d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3bd2680ed5ffc1442ece7ea37ea0439b8358ac6d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3bd2680ed5ffc1442ece7ea37ea0439b8358ac6d"}], "stats": {"total": 22, "additions": 16, "deletions": 6}, "files": [{"sha": "718e13116fff34c802b3dc5893f1d572755d43dd", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/931e6c29a71dfc9923a9a106c112ddfb1bc66112/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/931e6c29a71dfc9923a9a106c112ddfb1bc66112/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=931e6c29a71dfc9923a9a106c112ddfb1bc66112", "patch": "@@ -1,3 +1,8 @@\n+2004-09-26  Ulrich Weigand  <uweigand@de.ibm.com>\n+\n+\t* builtins.c (get_memory_rtx): Set mem attributes for non-ADDR_EXPR\n+\texpressions.  Always clear MEM_SIZE and alias set.\n+\n 2004-09-26  Roger Sayle  <roger@eyesopen.com>\n \t    Giovanni Bajo  <giovannibajo@gcc.gnu.org>\n "}, {"sha": "9127f45b6aa58d3528dc7af633f10865e8fcc255", "filename": "gcc/builtins.c", "status": "modified", "additions": 11, "deletions": 6, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/931e6c29a71dfc9923a9a106c112ddfb1bc66112/gcc%2Fbuiltins.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/931e6c29a71dfc9923a9a106c112ddfb1bc66112/gcc%2Fbuiltins.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fbuiltins.c?ref=931e6c29a71dfc9923a9a106c112ddfb1bc66112", "patch": "@@ -990,15 +990,20 @@ get_memory_rtx (tree exp)\n     exp = TREE_OPERAND (exp, 0);\n \n   if (TREE_CODE (exp) == ADDR_EXPR)\n-    {\n-      exp = TREE_OPERAND (exp, 0);\n-      set_mem_attributes (mem, exp, 0);\n-    }\n+    exp = TREE_OPERAND (exp, 0);\n   else if (POINTER_TYPE_P (TREE_TYPE (exp)))\n+    exp = build1 (INDIRECT_REF, TREE_TYPE (TREE_TYPE (exp)), exp);\n+  else\n+    exp = NULL;\n+\n+  /* Honor attributes derived from exp, except for the alias set\n+     (as builtin stringops may alias with anything) and the size\n+     (as stringops may access multiple array elements).  */\n+  if (exp)\n     {\n-      exp = build1 (INDIRECT_REF, TREE_TYPE (TREE_TYPE (exp)), exp);\n-      /* memcpy, memset and other builtin stringops can alias with anything.  */\n+      set_mem_attributes (mem, exp, 0);\n       set_mem_alias_set (mem, 0);\n+      set_mem_size (mem, NULL_RTX);\n     }\n \n   return mem;"}]}