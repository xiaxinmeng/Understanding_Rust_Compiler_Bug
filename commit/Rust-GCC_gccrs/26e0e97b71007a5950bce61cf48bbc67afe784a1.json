{"sha": "26e0e97b71007a5950bce61cf48bbc67afe784a1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjZlMGU5N2I3MTAwN2E1OTUwYmNlNjFjZjQ4YmJjNjdhZmU3ODRhMQ==", "commit": {"author": {"name": "Iain Sandoe", "email": "iain@sandoe.co.uk", "date": "2018-08-22T12:12:46Z"}, "committer": {"name": "Iain Sandoe", "email": "iains@gcc.gnu.org", "date": "2018-08-22T12:12:46Z"}, "message": "Make the gcc-ar,nm, strip tools respond correctly to --help and --version\nwhen there's no plugin built.\n\ngcc/\n\n\tPR other/704\n\t* gcc-ar.c (main): Don\u2019t try to invoke the plug-in if we\u2019re not\n\tbuilding it.\n\nFrom-SVN: r263768", "tree": {"sha": "a84d5da57f63db3d36ad9f2a406b099faa9a399a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a84d5da57f63db3d36ad9f2a406b099faa9a399a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/26e0e97b71007a5950bce61cf48bbc67afe784a1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/26e0e97b71007a5950bce61cf48bbc67afe784a1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/26e0e97b71007a5950bce61cf48bbc67afe784a1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/26e0e97b71007a5950bce61cf48bbc67afe784a1/comments", "author": {"login": "iains", "id": 4039407, "node_id": "MDQ6VXNlcjQwMzk0MDc=", "avatar_url": "https://avatars.githubusercontent.com/u/4039407?v=4", "gravatar_id": "", "url": "https://api.github.com/users/iains", "html_url": "https://github.com/iains", "followers_url": "https://api.github.com/users/iains/followers", "following_url": "https://api.github.com/users/iains/following{/other_user}", "gists_url": "https://api.github.com/users/iains/gists{/gist_id}", "starred_url": "https://api.github.com/users/iains/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/iains/subscriptions", "organizations_url": "https://api.github.com/users/iains/orgs", "repos_url": "https://api.github.com/users/iains/repos", "events_url": "https://api.github.com/users/iains/events{/privacy}", "received_events_url": "https://api.github.com/users/iains/received_events", "type": "User", "site_admin": false}, "committer": {"login": "iains", "id": 4039407, "node_id": "MDQ6VXNlcjQwMzk0MDc=", "avatar_url": "https://avatars.githubusercontent.com/u/4039407?v=4", "gravatar_id": "", "url": "https://api.github.com/users/iains", "html_url": "https://github.com/iains", "followers_url": "https://api.github.com/users/iains/followers", "following_url": "https://api.github.com/users/iains/following{/other_user}", "gists_url": "https://api.github.com/users/iains/gists{/gist_id}", "starred_url": "https://api.github.com/users/iains/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/iains/subscriptions", "organizations_url": "https://api.github.com/users/iains/orgs", "repos_url": "https://api.github.com/users/iains/repos", "events_url": "https://api.github.com/users/iains/events{/privacy}", "received_events_url": "https://api.github.com/users/iains/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7c1dcf501277503dc2983e9257c7779279ae0ca8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7c1dcf501277503dc2983e9257c7779279ae0ca8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7c1dcf501277503dc2983e9257c7779279ae0ca8"}], "stats": {"total": 22, "additions": 20, "deletions": 2}, "files": [{"sha": "b53ed795e3acdd2b8ca17d42e3d7cf26bab1b678", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/26e0e97b71007a5950bce61cf48bbc67afe784a1/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/26e0e97b71007a5950bce61cf48bbc67afe784a1/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=26e0e97b71007a5950bce61cf48bbc67afe784a1", "patch": "@@ -1,3 +1,9 @@\n+2018-08-22  Iain Sandoe  <iain@sandoe.co.uk>\n+\n+\tPR other/704\n+\t* gcc-ar.c (main): Don\u2019t try to invoke the plug-in if we\u2019re not\n+\tbuilding it.\n+\n 2018-08-22  Iain Sandoe  <iain@sandoe.co.uk>\n \n \t* config/darwin10.h (LINK_GCC_C_SEQUENCE_SPEC): Adjust to use the"}, {"sha": "82e0e69ab76c3166c626921ccbb4e3c2bf2527bf", "filename": "gcc/gcc-ar.c", "status": "modified", "additions": 14, "deletions": 2, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/26e0e97b71007a5950bce61cf48bbc67afe784a1/gcc%2Fgcc-ar.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/26e0e97b71007a5950bce61cf48bbc67afe784a1/gcc%2Fgcc-ar.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgcc-ar.c?ref=26e0e97b71007a5950bce61cf48bbc67afe784a1", "patch": "@@ -126,7 +126,9 @@ int\n main (int ac, char **av)\n {\n   const char *exe_name;\n+#if HAVE_LTO_PLUGIN > 0\n   char *plugin;\n+#endif\n   int k, status, err;\n   const char *err_msg;\n   const char **nargv;\n@@ -177,14 +179,15 @@ main (int ac, char **av)\n \t  break;\n \t}\n \n-\n+#if HAVE_LTO_PLUGIN > 0\n   /* Find the GCC LTO plugin */\n   plugin = find_a_file (&target_path, LTOPLUGINSONAME, R_OK);\n   if (!plugin)\n     {\n       fprintf (stderr, \"%s: Cannot find plugin '%s'\\n\", av[0], LTOPLUGINSONAME);\n       exit (1);\n     }\n+#endif\n \n   /* Find the wrapped binutils program.  */\n   exe_name = find_a_file (&target_path, PERSONALITY, X_OK);\n@@ -203,16 +206,25 @@ main (int ac, char **av)\n \t}\n     }\n \n-  /* Create new command line with plugin */\n+  /* Create new command line with plugin - if we have one, otherwise just\n+     copy the command through.  */\n   nargv = XCNEWVEC (const char *, ac + 4);\n   nargv[0] = exe_name;\n+#if HAVE_LTO_PLUGIN > 0\n   nargv[1] = \"--plugin\";\n   nargv[2] = plugin;\n   if (is_ar && av[1] && av[1][0] != '-')\n     av[1] = concat (\"-\", av[1], NULL);\n   for (k = 1; k < ac; k++)\n     nargv[2 + k] = av[k];\n   nargv[2 + k] = NULL;\n+#else\n+  if (is_ar && av[1] && av[1][0] != '-')\n+    av[1] = concat (\"-\", av[1], NULL);\n+  for (k = 1; k < ac; k++)\n+    nargv[k] = av[k];\n+  nargv[k] = NULL;\n+#endif\n \n   /* Run utility */\n   /* ??? the const is misplaced in pex_one's argv? */"}]}