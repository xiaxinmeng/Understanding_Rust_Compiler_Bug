{"sha": "ce914b984f952bfe69b9425a967b0bb4490a2ac0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Y2U5MTRiOTg0Zjk1MmJmZTY5Yjk0MjVhOTY3YjBiYjQ0OTBhMmFjMA==", "commit": {"author": {"name": "Vincent Celier", "email": "celier@adacore.com", "date": "2007-12-19T16:24:17Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2007-12-19T16:24:17Z"}, "message": "prj-attr.adb (Package_Node_Id_Of): Returns Unknown_Package when package is not known\n\n2007-12-19  Vincent Celier  <celier@adacore.com>\n\n\t* prj-attr.adb (Package_Node_Id_Of): Returns Unknown_Package when\n\tpackage is not known\n\n\t* prj-attr.ads (Unknown_Package): New constant\n\tDo not crash when an unknown package is in several projects\n\n\t* prj-dect.adb (Parse_Package_Declaration): Mark an unknown package as\n\tignored\n\n\t* prj-nmsc.adb (Check): Remove obsolete code related to no longer\n\texisting package Language_Processing.\n\nFrom-SVN: r131078", "tree": {"sha": "a44749e3f074425c00c87c4a0ca9db1580651b37", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a44749e3f074425c00c87c4a0ca9db1580651b37"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ce914b984f952bfe69b9425a967b0bb4490a2ac0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ce914b984f952bfe69b9425a967b0bb4490a2ac0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ce914b984f952bfe69b9425a967b0bb4490a2ac0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ce914b984f952bfe69b9425a967b0bb4490a2ac0/comments", "author": {"login": "vcelier", "id": 8888056, "node_id": "MDQ6VXNlcjg4ODgwNTY=", "avatar_url": "https://avatars.githubusercontent.com/u/8888056?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vcelier", "html_url": "https://github.com/vcelier", "followers_url": "https://api.github.com/users/vcelier/followers", "following_url": "https://api.github.com/users/vcelier/following{/other_user}", "gists_url": "https://api.github.com/users/vcelier/gists{/gist_id}", "starred_url": "https://api.github.com/users/vcelier/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vcelier/subscriptions", "organizations_url": "https://api.github.com/users/vcelier/orgs", "repos_url": "https://api.github.com/users/vcelier/repos", "events_url": "https://api.github.com/users/vcelier/events{/privacy}", "received_events_url": "https://api.github.com/users/vcelier/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "1c0ecdd46a9be6db749ad6ce401a243e47597e4a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1c0ecdd46a9be6db749ad6ce401a243e47597e4a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1c0ecdd46a9be6db749ad6ce401a243e47597e4a"}], "stats": {"total": 64, "additions": 25, "deletions": 39}, "files": [{"sha": "0f3fef4a722ed9e29194cbd1e4c79b3843525c16", "filename": "gcc/ada/prj-attr.adb", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ce914b984f952bfe69b9425a967b0bb4490a2ac0/gcc%2Fada%2Fprj-attr.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ce914b984f952bfe69b9425a967b0bb4490a2ac0/gcc%2Fada%2Fprj-attr.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-attr.adb?ref=ce914b984f952bfe69b9425a967b0bb4490a2ac0", "patch": "@@ -602,7 +602,11 @@ package body Prj.Attr is\n    begin\n       for Index in Package_Attributes.First .. Package_Attributes.Last loop\n          if Package_Attributes.Table (Index).Name = Name then\n-            return (Value => Index);\n+            if Package_Attributes.Table (Index).Known then\n+               return (Value => Index);\n+            else\n+               return Unknown_Package;\n+            end if;\n          end if;\n       end loop;\n \n@@ -689,6 +693,7 @@ package body Prj.Attr is\n          Attr_Kind      => Real_Attr_Kind,\n          Read_Only      => False,\n          Next           => First_Attr);\n+\n       Package_Attributes.Table (In_Package.Value).First_Attribute :=\n         Attrs.Last;\n    end Register_New_Attribute;"}, {"sha": "135878e25c23cf407b0de6a7ecbadcccb6d36608", "filename": "gcc/ada/prj-attr.ads", "status": "modified", "additions": 8, "deletions": 5, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ce914b984f952bfe69b9425a967b0bb4490a2ac0/gcc%2Fada%2Fprj-attr.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ce914b984f952bfe69b9425a967b0bb4490a2ac0/gcc%2Fada%2Fprj-attr.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-attr.ads?ref=ce914b984f952bfe69b9425a967b0bb4490a2ac0", "patch": "@@ -171,6 +171,9 @@ package Prj.Attr is\n    Empty_Package : constant Package_Node_Id;\n    --  Default value of Package_Node_Id objects\n \n+   Unknown_Package : constant Package_Node_Id;\n+   --  Value of an unknown package that has been found but is unknown.\n+\n    procedure Register_New_Package (Name : String; Id : out Package_Node_Id);\n    --  Add a new package. Fails if Name (the package name) is empty or is\n    --  already the name of a package, and set Id to Empty_Package,\n@@ -250,11 +253,11 @@ private\n    end record;\n    --  Full declaration of self-initialized private type\n \n-   Empty_Pkg : constant Pkg_Node_Id := Package_Node_Low_Bound;\n-\n-   Empty_Package : constant Package_Node_Id := (Value => Empty_Pkg);\n-\n-   First_Package : constant Pkg_Node_Id := Package_Node_Low_Bound + 1;\n+   Empty_Pkg       : constant Pkg_Node_Id     := Package_Node_Low_Bound;\n+   Empty_Package   : constant Package_Node_Id := (Value => Empty_Pkg);\n+   Unknown_Pkg     : constant Pkg_Node_Id     := Package_Node_High_Bound;\n+   Unknown_Package : constant Package_Node_Id := (Value => Unknown_Pkg);\n+   First_Package   : constant Pkg_Node_Id     := Package_Node_Low_Bound + 1;\n \n    First_Package_Node_Id  : constant Package_Node_Id :=\n                               (Value => First_Package);"}, {"sha": "24c312e70eed0ce1506136a4e455a55812d23b2c", "filename": "gcc/ada/prj-dect.adb", "status": "modified", "additions": 11, "deletions": 4, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ce914b984f952bfe69b9425a967b0bb4490a2ac0/gcc%2Fada%2Fprj-dect.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ce914b984f952bfe69b9425a967b0bb4490a2ac0/gcc%2Fada%2Fprj-dect.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-dect.adb?ref=ce914b984f952bfe69b9425a967b0bb4490a2ac0", "patch": "@@ -981,10 +981,7 @@ package body Prj.Dect is\n \n          Current_Package := Package_Node_Id_Of (Token_Name);\n \n-         if Current_Package  /= Empty_Package then\n-            First_Attribute := First_Attribute_Of (Current_Package);\n-\n-         else\n+         if Current_Package = Empty_Package then\n             if not Quiet_Output then\n                Error_Msg (\"?\"\"\" &\n                           Get_Name_String\n@@ -1001,6 +998,16 @@ package body Prj.Dect is\n             --  Add the unknown package in the list of packages\n \n             Add_Unknown_Package (Token_Name, Current_Package);\n+\n+         elsif Current_Package = Unknown_Package then\n+\n+            --  Set the package declaration to \"ignored\" so that it is not\n+            --  processed by Prj.Proc.Process.\n+\n+            Set_Expression_Kind_Of (Package_Declaration, In_Tree, Ignored);\n+\n+         else\n+            First_Attribute := First_Attribute_Of (Current_Package);\n          end if;\n \n          Set_Package_Id_Of"}, {"sha": "128913b8822386660dd7c0f7ba90851e77289cbb", "filename": "gcc/ada/prj-nmsc.adb", "status": "modified", "additions": 0, "deletions": 29, "changes": 29, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ce914b984f952bfe69b9425a967b0bb4490a2ac0/gcc%2Fada%2Fprj-nmsc.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ce914b984f952bfe69b9425a967b0bb4490a2ac0/gcc%2Fada%2Fprj-nmsc.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-nmsc.adb?ref=ce914b984f952bfe69b9425a967b0bb4490a2ac0", "patch": "@@ -714,8 +714,6 @@ package body Prj.Nmsc is\n    is\n       Data      : Project_Data := In_Tree.Projects.Table (Project);\n       Extending : Boolean := False;\n-      Lang_Proc_Pkg   : Package_Id;\n-      Linker_Name     : Variable_Value;\n \n    begin\n       Nmsc.When_No_Sources := When_No_Sources;\n@@ -840,33 +838,6 @@ package body Prj.Nmsc is\n \n       Get_Mains (Project, In_Tree, Data);\n \n-      --  In multi-language mode, check if there is a linker specified\n-\n-      if Get_Mode = Multi_Language then\n-         Lang_Proc_Pkg :=\n-           Value_Of (Name_Language_Processing, Data.Decl.Packages, In_Tree);\n-\n-         if Lang_Proc_Pkg /= No_Package then\n-            Linker_Name :=\n-              Value_Of\n-                (Variable_Name => Name_Linker,\n-                 In_Variables  =>\n-                   In_Tree.Packages.Table (Lang_Proc_Pkg).Decl.Attributes,\n-                 In_Tree       => In_Tree);\n-\n-            if Linker_Name /= Nil_Variable_Value then\n-               Get_Name_String (Linker_Name.Value);\n-\n-               if Name_Len > 0 then\n-                  --  A non empty linker name was specified\n-\n-                  Data.Linker_Name := File_Name_Type (Linker_Name.Value);\n-\n-               end if;\n-            end if;\n-         end if;\n-      end if;\n-\n       --  Update the project data in the Projects table\n \n       In_Tree.Projects.Table (Project) := Data;"}]}