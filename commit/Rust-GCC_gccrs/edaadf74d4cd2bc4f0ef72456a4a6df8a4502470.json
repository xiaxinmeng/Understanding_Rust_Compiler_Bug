{"sha": "edaadf74d4cd2bc4f0ef72456a4a6df8a4502470", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWRhYWRmNzRkNGNkMmJjNGYwZWY3MjQ1NmE0YTZkZjhhNDUwMjQ3MA==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2010-12-02T14:37:20Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2010-12-02T14:37:20Z"}, "message": "re PR fortran/46753 (ICE: OpenMP - in extract_omp_for_data, at omp-low.c:335)\n\n\tPR fortran/46753\n\t* trans-openmp.c (gfc_trans_omp_do): Use build2_loc instead of\n\tfold_build2_loc for OMP_FOR conditions.\n\n\t* libgomp.fortran/pr46753.f90: New test.\n\nFrom-SVN: r167372", "tree": {"sha": "236b730968c457a7cee43f76f47f16b4b5f2cc97", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/236b730968c457a7cee43f76f47f16b4b5f2cc97"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/edaadf74d4cd2bc4f0ef72456a4a6df8a4502470", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/edaadf74d4cd2bc4f0ef72456a4a6df8a4502470", "html_url": "https://github.com/Rust-GCC/gccrs/commit/edaadf74d4cd2bc4f0ef72456a4a6df8a4502470", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/edaadf74d4cd2bc4f0ef72456a4a6df8a4502470/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "4c698cf891a7d946b64d95ba89d6a0d255f40712", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4c698cf891a7d946b64d95ba89d6a0d255f40712", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4c698cf891a7d946b64d95ba89d6a0d255f40712"}], "stats": {"total": 41, "additions": 34, "deletions": 7}, "files": [{"sha": "8e6319b6a09223deadab401738e0883f90eda523", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/edaadf74d4cd2bc4f0ef72456a4a6df8a4502470/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/edaadf74d4cd2bc4f0ef72456a4a6df8a4502470/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=edaadf74d4cd2bc4f0ef72456a4a6df8a4502470", "patch": "@@ -1,3 +1,9 @@\n+2010-12-02  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR fortran/46753\n+\t* trans-openmp.c (gfc_trans_omp_do): Use build2_loc instead of\n+\tfold_build2_loc for OMP_FOR conditions.\n+\n 2010-11-30  Janne Blomqvist  <jb@gcc.gnu.org>\n \n \tPR fortran/28105"}, {"sha": "a8c861e253edfb2b07c1cd9d146a9d9dc7b396e2", "filename": "gcc/fortran/trans-openmp.c", "status": "modified", "additions": 8, "deletions": 7, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/edaadf74d4cd2bc4f0ef72456a4a6df8a4502470/gcc%2Ffortran%2Ftrans-openmp.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/edaadf74d4cd2bc4f0ef72456a4a6df8a4502470/gcc%2Ffortran%2Ftrans-openmp.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-openmp.c?ref=edaadf74d4cd2bc4f0ef72456a4a6df8a4502470", "patch": "@@ -1262,10 +1262,10 @@ gfc_trans_omp_do (gfc_code *code, stmtblock_t *pblock,\n       if (simple)\n \t{\n \t  TREE_VEC_ELT (init, i) = build2_v (MODIFY_EXPR, dovar, from);\n-\t  TREE_VEC_ELT (cond, i) = fold_build2_loc (input_location, simple > 0\n-\t\t\t\t\t\t    ? LE_EXPR : GE_EXPR,\n-\t\t\t\t\t\t    boolean_type_node, dovar,\n-\t\t\t\t\t\t    to);\n+\t  /* The condition should not be folded.  */\n+\t  TREE_VEC_ELT (cond, i) = build2_loc (input_location, simple > 0\n+\t\t\t\t\t       ? LE_EXPR : GE_EXPR,\n+\t\t\t\t\t       boolean_type_node, dovar, to);\n \t  TREE_VEC_ELT (incr, i) = fold_build2_loc (input_location, PLUS_EXPR,\n \t\t\t\t\t\t    type, dovar, step);\n \t  TREE_VEC_ELT (incr, i) = fold_build2_loc (input_location,\n@@ -1290,9 +1290,10 @@ gfc_trans_omp_do (gfc_code *code, stmtblock_t *pblock,\n \t  count = gfc_create_var (type, \"count\");\n \t  TREE_VEC_ELT (init, i) = build2_v (MODIFY_EXPR, count,\n \t\t\t\t\t     build_int_cst (type, 0));\n-\t  TREE_VEC_ELT (cond, i) = fold_build2_loc (input_location, LT_EXPR,\n-\t\t\t\t\t\t    boolean_type_node,\n-\t\t\t\t\t\t    count, tmp);\n+\t  /* The condition should not be folded.  */\n+\t  TREE_VEC_ELT (cond, i) = build2_loc (input_location, LT_EXPR,\n+\t\t\t\t\t       boolean_type_node,\n+\t\t\t\t\t       count, tmp);\n \t  TREE_VEC_ELT (incr, i) = fold_build2_loc (input_location, PLUS_EXPR,\n \t\t\t\t\t\t    type, count,\n \t\t\t\t\t\t    build_int_cst (type, 1));"}, {"sha": "f59471743f420bcb25c96b3149e1bcef78f7785c", "filename": "libgomp/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/edaadf74d4cd2bc4f0ef72456a4a6df8a4502470/libgomp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/edaadf74d4cd2bc4f0ef72456a4a6df8a4502470/libgomp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2FChangeLog?ref=edaadf74d4cd2bc4f0ef72456a4a6df8a4502470", "patch": "@@ -1,5 +1,8 @@\n 2010-12-02  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR fortran/46753\n+\t* libgomp.fortran/pr46753.f90: New test.\n+\n \tPR libgomp/43706\n \t* env.c (initialize_env): Default to spin count 300000\n \tinstead of 20000000 if neither OMP_WAIT_POLICY nor GOMP_SPINCOUNT"}, {"sha": "f4833abc845ce9427fa88f9cac15ce0e88951568", "filename": "libgomp/testsuite/libgomp.fortran/pr46753.f90", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/edaadf74d4cd2bc4f0ef72456a4a6df8a4502470/libgomp%2Ftestsuite%2Flibgomp.fortran%2Fpr46753.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/edaadf74d4cd2bc4f0ef72456a4a6df8a4502470/libgomp%2Ftestsuite%2Flibgomp.fortran%2Fpr46753.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Ftestsuite%2Flibgomp.fortran%2Fpr46753.f90?ref=edaadf74d4cd2bc4f0ef72456a4a6df8a4502470", "patch": "@@ -0,0 +1,17 @@\n+! PR fortran/46753\n+! { dg-do run }\n+\n+  integer :: i, j\n+  j = 0\n+!$omp parallel do reduction(+:j)\n+  do i = 2147483636, 2147483646\n+    j = j + 1\n+  end do\n+  if (j.ne.11) call abort\n+  j = 0\n+!$omp parallel do reduction(+:j)\n+  do i = -2147483637, -2147483647, -1\n+    j = j + 1\n+  end do\n+  if (j.ne.11) call abort\n+end"}]}