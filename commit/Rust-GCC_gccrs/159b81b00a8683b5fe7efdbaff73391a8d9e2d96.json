{"sha": "159b81b00a8683b5fe7efdbaff73391a8d9e2d96", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTU5YjgxYjAwYTg2ODNiNWZlN2VmZGJhZmY3MzM5MWE4ZDllMmQ5Ng==", "commit": {"author": {"name": "Richard Sandiford", "email": "richard.sandiford@linaro.org", "date": "2011-03-30T15:00:44Z"}, "committer": {"name": "Richard Sandiford", "email": "rsandifo@gcc.gnu.org", "date": "2011-03-30T15:00:44Z"}, "message": "re PR target/47551 (ICE when reloading neon registers from out-of-range offsets)\n\ngcc/\n\tPR target/47551\n\t* config/arm/arm.c (coproc_secondary_reload_class): Handle\n\tstructure modes.  Don't check neon_vector_mem_operand for\n\tvector or structure modes.\n\ngcc/testsuite/\n\tPR target/47551\n\t* gcc.target/arm/neon-modes-2.c: New test.\n\nFrom-SVN: r171730", "tree": {"sha": "4185ae9692965315079941f2fbf556751245f6cc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4185ae9692965315079941f2fbf556751245f6cc"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/159b81b00a8683b5fe7efdbaff73391a8d9e2d96", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/159b81b00a8683b5fe7efdbaff73391a8d9e2d96", "html_url": "https://github.com/Rust-GCC/gccrs/commit/159b81b00a8683b5fe7efdbaff73391a8d9e2d96", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/159b81b00a8683b5fe7efdbaff73391a8d9e2d96/comments", "author": null, "committer": null, "parents": [{"sha": "a6217191562708a588883aefb49cd1a3722e105a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a6217191562708a588883aefb49cd1a3722e105a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a6217191562708a588883aefb49cd1a3722e105a"}], "stats": {"total": 45, "additions": 42, "deletions": 3}, "files": [{"sha": "31a0d1552c955cb4bb84f469e85e97ea7d5ad6e2", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/159b81b00a8683b5fe7efdbaff73391a8d9e2d96/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/159b81b00a8683b5fe7efdbaff73391a8d9e2d96/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=159b81b00a8683b5fe7efdbaff73391a8d9e2d96", "patch": "@@ -1,3 +1,10 @@\n+2011-03-30  Richard Sandiford  <richard.sandiford@linaro.org>\n+\n+\tPR target/47551\n+\t* config/arm/arm.c (coproc_secondary_reload_class): Handle\n+\tstructure modes.  Don't check neon_vector_mem_operand for\n+\tvector or structure modes.\n+\n 2011-03-30  Richard Sandiford  <richard.sandiford@linaro.org>\n \t    Ramana Radhakrishnan  <ramana.radhakrishnan@linaro.org>\n "}, {"sha": "57fe96c9c03c2cab53a6f3ef34950b2716ab9eeb", "filename": "gcc/config/arm/arm.c", "status": "modified", "additions": 6, "deletions": 3, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/159b81b00a8683b5fe7efdbaff73391a8d9e2d96/gcc%2Fconfig%2Farm%2Farm.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/159b81b00a8683b5fe7efdbaff73391a8d9e2d96/gcc%2Fconfig%2Farm%2Farm.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Farm.c?ref=159b81b00a8683b5fe7efdbaff73391a8d9e2d96", "patch": "@@ -9152,11 +9152,14 @@ coproc_secondary_reload_class (enum machine_mode mode, rtx x, bool wb)\n       return GENERAL_REGS;\n     }\n \n+  /* The neon move patterns handle all legitimate vector and struct\n+     addresses.  */\n   if (TARGET_NEON\n+      && MEM_P (x)\n       && (GET_MODE_CLASS (mode) == MODE_VECTOR_INT\n-          || GET_MODE_CLASS (mode) == MODE_VECTOR_FLOAT)\n-      && neon_vector_mem_operand (x, 0))\n-     return NO_REGS;\n+\t  || GET_MODE_CLASS (mode) == MODE_VECTOR_FLOAT\n+\t  || VALID_NEON_STRUCT_MODE (mode)))\n+    return NO_REGS;\n \n   if (arm_coproc_mem_operand (x, wb) || s_register_operand (x, mode))\n     return NO_REGS;"}, {"sha": "be3a9299b3c8b6767a21f8ecfa29fa0aee7bc188", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/159b81b00a8683b5fe7efdbaff73391a8d9e2d96/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/159b81b00a8683b5fe7efdbaff73391a8d9e2d96/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=159b81b00a8683b5fe7efdbaff73391a8d9e2d96", "patch": "@@ -1,3 +1,8 @@\n+2011-03-30  Richard Sandiford  <richard.sandiford@linaro.org>\n+\n+\tPR target/47551\n+\t* gcc.target/arm/neon-modes-2.c: New test.\n+\n 2011-03-30  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR c/48305"}, {"sha": "40f1bba363bf656bf0fac0e4401e47d42319fa60", "filename": "gcc/testsuite/gcc.target/arm/neon-modes-2.c", "status": "added", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/159b81b00a8683b5fe7efdbaff73391a8d9e2d96/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fneon-modes-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/159b81b00a8683b5fe7efdbaff73391a8d9e2d96/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fneon-modes-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fneon-modes-2.c?ref=159b81b00a8683b5fe7efdbaff73391a8d9e2d96", "patch": "@@ -0,0 +1,24 @@\n+/* { dg-do compile } */\n+/* { dg-require-effective-target arm_neon_ok } */\n+/* { dg-options \"-O1\" } */\n+/* { dg-add-options arm_neon } */\n+\n+#include \"arm_neon.h\"\n+\n+#define SETUP(A) x##A = vld3_u32 (ptr + A * 0x20)\n+#define MODIFY(A) x##A = vld3_lane_u32 (ptr + A * 0x20 + 0x10, x##A, 1)\n+#define STORE(A) vst3_u32 (ptr + A * 0x20, x##A)\n+\n+#define MANY(A) A (0), A (1), A (2), A (3), A (4), A (5)\n+\n+void\n+bar (uint32_t *ptr, int y)\n+{\n+  uint32x2x3_t MANY (SETUP);\n+  int *x = __builtin_alloca (y);\n+  int z[0x1000];\n+  foo (x, z);\n+  MANY (MODIFY);\n+  foo (x, z);\n+  MANY (STORE);\n+}"}]}