{"sha": "02cada26e4783b4bfeaf6512a6c22df24d7a25fc", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDJjYWRhMjZlNDc4M2I0YmZlYWY2NTEyYTZjMjJkZjI0ZDdhMjVmYw==", "commit": {"author": {"name": "Martin Liska", "email": "mliska@suse.cz", "date": "2020-07-23T08:39:00Z"}, "committer": {"name": "Martin Liska", "email": "mliska@suse.cz", "date": "2020-07-23T08:43:25Z"}, "message": "gcc-changelog: fix when somebody reverts a backport\n\ncontrib/ChangeLog:\n\n\t* gcc-changelog/git_commit.py: When reverting a backport,\n\twe should print only Revert header.", "tree": {"sha": "a48069d286d29aba58c71b068968a68832d4642b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a48069d286d29aba58c71b068968a68832d4642b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/02cada26e4783b4bfeaf6512a6c22df24d7a25fc", "comment_count": 0, "verification": {"verified": false, "reason": "unknown_key", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQEzBAABCAAdFiEE6I4wzqqylQBfXaRhTcGC3A+nN4UFAl8ZTa0ACgkQTcGC3A+n\nN4VeeAf/aUyVfwrTNHHPFmj9TK9KdG7tkF0Q+ZZlpMOEM3x2l1mcU/Sf+OYflJxz\nHg17D+olrdwF/isSso95eO+ZPqZIcOguP1NmTui4LSiEs3b8goFxqypaIEOqEBVD\nps+uctBnETOgGI4xmELWUyh+cYLzjWvuTAlejue00AmTOCysC6TT3ekR8ra6r39y\n6OUF+eOl+5mchxCbg0siR+paEOa0oq07U7OVyDU6HxfFKqmL8rYJZrNSohPWMq3G\n6kbH/UXAIsYPJoaW2nb5aY6IZRRgdiTeVVukihShWIURuxFTIcUh0RfjdDyJ4JHb\nAj+v3DR7+4k//+MqBRJzlPqHOlb63w==\n=Vr2a\n-----END PGP SIGNATURE-----", "payload": "tree a48069d286d29aba58c71b068968a68832d4642b\nparent 2ca1b6d009b194286c3ec91f9c51cc6b0a475458\nauthor Martin Liska <mliska@suse.cz> 1595493540 +0200\ncommitter Martin Liska <mliska@suse.cz> 1595493805 +0200\n\ngcc-changelog: fix when somebody reverts a backport\n\ncontrib/ChangeLog:\n\n\t* gcc-changelog/git_commit.py: When reverting a backport,\n\twe should print only Revert header.\n"}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/02cada26e4783b4bfeaf6512a6c22df24d7a25fc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/02cada26e4783b4bfeaf6512a6c22df24d7a25fc", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/02cada26e4783b4bfeaf6512a6c22df24d7a25fc/comments", "author": {"login": "marxin", "id": 2658545, "node_id": "MDQ6VXNlcjI2NTg1NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/2658545?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marxin", "html_url": "https://github.com/marxin", "followers_url": "https://api.github.com/users/marxin/followers", "following_url": "https://api.github.com/users/marxin/following{/other_user}", "gists_url": "https://api.github.com/users/marxin/gists{/gist_id}", "starred_url": "https://api.github.com/users/marxin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marxin/subscriptions", "organizations_url": "https://api.github.com/users/marxin/orgs", "repos_url": "https://api.github.com/users/marxin/repos", "events_url": "https://api.github.com/users/marxin/events{/privacy}", "received_events_url": "https://api.github.com/users/marxin/received_events", "type": "User", "site_admin": false}, "committer": {"login": "marxin", "id": 2658545, "node_id": "MDQ6VXNlcjI2NTg1NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/2658545?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marxin", "html_url": "https://github.com/marxin", "followers_url": "https://api.github.com/users/marxin/followers", "following_url": "https://api.github.com/users/marxin/following{/other_user}", "gists_url": "https://api.github.com/users/marxin/gists{/gist_id}", "starred_url": "https://api.github.com/users/marxin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marxin/subscriptions", "organizations_url": "https://api.github.com/users/marxin/orgs", "repos_url": "https://api.github.com/users/marxin/repos", "events_url": "https://api.github.com/users/marxin/events{/privacy}", "received_events_url": "https://api.github.com/users/marxin/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2ca1b6d009b194286c3ec91f9c51cc6b0a475458", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2ca1b6d009b194286c3ec91f9c51cc6b0a475458", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2ca1b6d009b194286c3ec91f9c51cc6b0a475458"}], "stats": {"total": 19, "additions": 10, "deletions": 9}, "files": [{"sha": "5a9cc4c7563a54ff597e27e63557c4023dcb8eaa", "filename": "contrib/gcc-changelog/git_commit.py", "status": "modified", "additions": 10, "deletions": 9, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/02cada26e4783b4bfeaf6512a6c22df24d7a25fc/contrib%2Fgcc-changelog%2Fgit_commit.py", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/02cada26e4783b4bfeaf6512a6c22df24d7a25fc/contrib%2Fgcc-changelog%2Fgit_commit.py", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2Fgcc-changelog%2Fgit_commit.py?ref=02cada26e4783b4bfeaf6512a6c22df24d7a25fc", "patch": "@@ -628,18 +628,18 @@ def to_changelog_entries(self, use_commit_ts=False):\n         for entry in self.changelog_entries:\n             output = ''\n             timestamp = entry.datetime\n-            if self.cherry_pick_commit:\n+            if self.revert_commit:\n+                timestamp = current_timestamp\n+                orig_date = self.original_info.date\n+                current_timestamp = orig_date.strftime(DATE_FORMAT)\n+            elif self.cherry_pick_commit:\n                 info = self.commit_to_info_hook(self.cherry_pick_commit)\n                 # it can happen that it is a cherry-pick for a different\n                 # repository\n                 if info:\n                     timestamp = info.date.strftime(DATE_FORMAT)\n                 else:\n                     timestamp = current_timestamp\n-            elif self.revert_commit:\n-                timestamp = current_timestamp\n-                orig_date = self.original_info.date\n-                current_timestamp = orig_date.strftime(DATE_FORMAT)\n             elif not timestamp or use_commit_ts:\n                 timestamp = current_timestamp\n             authors = entry.authors if entry.authors else [self.info.author]\n@@ -649,12 +649,13 @@ def to_changelog_entries(self, use_commit_ts=False):\n                     authors.append(author)\n \n             if self.cherry_pick_commit or self.revert_commit:\n-                output += self.format_authors_in_changelog([self.info.author],\n+                original_author = self.original_info.author\n+                output += self.format_authors_in_changelog([original_author],\n                                                            current_timestamp)\n-                if self.cherry_pick_commit:\n-                    output += '\\tBackported from master:\\n'\n-                else:\n+                if self.revert_commit:\n                     output += '\\tRevert:\\n'\n+                else:\n+                    output += '\\tBackported from master:\\n'\n                 output += self.format_authors_in_changelog(authors,\n                                                            timestamp, '\\t')\n             else:"}]}