{"sha": "5f7976f65b45c457b57bfc2c55ec845771e0d3c2", "node_id": "C_kwDOANBUbNoAKDVmNzk3NmY2NWI0NWM0NTdiNTdiZmMyYzU1ZWM4NDU3NzFlMGQzYzI", "commit": {"author": {"name": "Patrick Palka", "email": "ppalka@redhat.com", "date": "2021-10-21T16:13:35Z"}, "committer": {"name": "Patrick Palka", "email": "ppalka@redhat.com", "date": "2021-10-21T16:13:35Z"}, "message": "libstdc++: missing constexpr for __[nm]iter_base [PR102358]\n\n\tPR libstdc++/102358\n\nlibstdc++-v3/ChangeLog:\n\n\t* include/bits/stl_iterator.h (__niter_base): Make constexpr\n\tfor C++20.\n\t(__miter_base): Likewise.\n\t* testsuite/25_algorithms/move/constexpr.cc: New test.", "tree": {"sha": "975c5044209326f7bccca48bf28eafbd3b2ce3b5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/975c5044209326f7bccca48bf28eafbd3b2ce3b5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5f7976f65b45c457b57bfc2c55ec845771e0d3c2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5f7976f65b45c457b57bfc2c55ec845771e0d3c2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5f7976f65b45c457b57bfc2c55ec845771e0d3c2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5f7976f65b45c457b57bfc2c55ec845771e0d3c2/comments", "author": null, "committer": null, "parents": [{"sha": "9262ae450d6a57837c58645c2ee66365bbe08338", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9262ae450d6a57837c58645c2ee66365bbe08338", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9262ae450d6a57837c58645c2ee66365bbe08338"}], "stats": {"total": 21, "additions": 21, "deletions": 0}, "files": [{"sha": "f6504ece56080a7b8cd12b5f5f36d9d60827ec8a", "filename": "libstdc++-v3/include/bits/stl_iterator.h", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5f7976f65b45c457b57bfc2c55ec845771e0d3c2/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstl_iterator.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5f7976f65b45c457b57bfc2c55ec845771e0d3c2/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstl_iterator.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstl_iterator.h?ref=5f7976f65b45c457b57bfc2c55ec845771e0d3c2", "patch": "@@ -2472,6 +2472,7 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n   /// @} group iterators\n \n   template<typename _Iterator>\n+    _GLIBCXX20_CONSTEXPR\n     auto\n     __niter_base(move_iterator<_Iterator> __it)\n     -> decltype(make_move_iterator(__niter_base(__it.base())))\n@@ -2485,6 +2486,7 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n     };\n \n   template<typename _Iterator>\n+    _GLIBCXX20_CONSTEXPR\n     auto\n     __miter_base(move_iterator<_Iterator> __it)\n     -> decltype(__miter_base(__it.base()))"}, {"sha": "773c55cfb50164a415159106c0a7c4e832d1dbce", "filename": "libstdc++-v3/testsuite/25_algorithms/move/constexpr.cc", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5f7976f65b45c457b57bfc2c55ec845771e0d3c2/libstdc%2B%2B-v3%2Ftestsuite%2F25_algorithms%2Fmove%2Fconstexpr.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5f7976f65b45c457b57bfc2c55ec845771e0d3c2/libstdc%2B%2B-v3%2Ftestsuite%2F25_algorithms%2Fmove%2Fconstexpr.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F25_algorithms%2Fmove%2Fconstexpr.cc?ref=5f7976f65b45c457b57bfc2c55ec845771e0d3c2", "patch": "@@ -0,0 +1,19 @@\n+// { dg-options \"-std=gnu++20\" }\n+// { dg-do compile { target c++20 } }\n+\n+#include <algorithm>\n+#include <span>\n+\n+constexpr bool\n+test01()\n+{\n+  // PR libstdc++/102358\n+  int x[2] = {1,2}, y[2];\n+  std::span in(x), out(y);\n+  std::move(std::move_iterator(in.begin()), std::move_iterator(in.end()),\n+\t    out.begin());\n+  return std::equal(std::move_iterator(in.begin()), std::move_iterator(in.end()),\n+\t\t    std::move_iterator(out.begin()));\n+}\n+\n+static_assert(test01());"}]}