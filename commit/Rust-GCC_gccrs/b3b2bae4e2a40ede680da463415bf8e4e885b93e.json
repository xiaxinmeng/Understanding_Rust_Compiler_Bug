{"sha": "b3b2bae4e2a40ede680da463415bf8e4e885b93e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjNiMmJhZTRlMmE0MGVkZTY4MGRhNDYzNDE1YmY4ZTRlODg1YjkzZQ==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2016-04-27T13:29:34Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2016-04-27T13:29:34Z"}, "message": "re PR sanitizer/70683 (-fcompare-debug bug with -fsanitize=address)\n\n\tPR sanitizer/70683\n\t* tree-core.h (enum operand_equal_flag): Add OEP_NO_HASH_CHECK.\n\t* fold-const.c (operand_equal_p): If flag_checking and\n\tOEP_NO_HASH_CHECK is not set in flag, recurse with OEP_NO_HASH_CHECK\n\tand if it returns non-zero, assert iterative_hash_expr on both\n\targs is the same.\n\nFrom-SVN: r235507", "tree": {"sha": "0b2a2bd79d40fa89ffbdf39a837fd4e5a09c14ce", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0b2a2bd79d40fa89ffbdf39a837fd4e5a09c14ce"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b3b2bae4e2a40ede680da463415bf8e4e885b93e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b3b2bae4e2a40ede680da463415bf8e4e885b93e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b3b2bae4e2a40ede680da463415bf8e4e885b93e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b3b2bae4e2a40ede680da463415bf8e4e885b93e/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "3c98ff9b1a24246e19da39fce967fe2f88be828e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3c98ff9b1a24246e19da39fce967fe2f88be828e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3c98ff9b1a24246e19da39fce967fe2f88be828e"}], "stats": {"total": 32, "additions": 31, "deletions": 1}, "files": [{"sha": "6d26cb00a95d013e7bac5457fb31ea65a7a723df", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b3b2bae4e2a40ede680da463415bf8e4e885b93e/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b3b2bae4e2a40ede680da463415bf8e4e885b93e/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=b3b2bae4e2a40ede680da463415bf8e4e885b93e", "patch": "@@ -1,3 +1,12 @@\n+2016-04-27  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR sanitizer/70683\n+\t* tree-core.h (enum operand_equal_flag): Add OEP_NO_HASH_CHECK.\n+\t* fold-const.c (operand_equal_p): If flag_checking and\n+\tOEP_NO_HASH_CHECK is not set in flag, recurse with OEP_NO_HASH_CHECK\n+\tand if it returns non-zero, assert iterative_hash_expr on both\n+\targs is the same.\n+\n 2016-04-27  Bernd Schmidt  <bschmidt@redhat.com>\n \n \t* doc/invoke.texi (-frename-registers): Also enabled at -Os."}, {"sha": "7fc23c6c3d52e17d4ed99fb1612eb65ebbc6af8c", "filename": "gcc/fold-const.c", "status": "modified", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b3b2bae4e2a40ede680da463415bf8e4e885b93e/gcc%2Ffold-const.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b3b2bae4e2a40ede680da463415bf8e4e885b93e/gcc%2Ffold-const.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffold-const.c?ref=b3b2bae4e2a40ede680da463415bf8e4e885b93e", "patch": "@@ -2749,6 +2749,25 @@ combine_comparisons (location_t loc,\n int\n operand_equal_p (const_tree arg0, const_tree arg1, unsigned int flags)\n {\n+  /* When checking, verify at the outermost operand_equal_p call that\n+     if operand_equal_p returns non-zero then ARG0 and ARG1 has the same\n+     hash value.  */\n+  if (flag_checking && !(flags & OEP_NO_HASH_CHECK))\n+    {\n+      if (operand_equal_p (arg0, arg1, flags | OEP_NO_HASH_CHECK))\n+\t{\n+\t  inchash::hash hstate0 (0), hstate1 (0);\n+\t  inchash::add_expr (arg0, hstate0, flags);\n+\t  inchash::add_expr (arg1, hstate1, flags);\n+\t  hashval_t h0 = hstate0.end ();\n+\t  hashval_t h1 = hstate1.end ();\n+\t  gcc_assert (h0 == h1);\n+\t  return 1;\n+\t}\n+      else\n+\treturn 0;\n+    }\n+\n   /* If either is ERROR_MARK, they aren't equal.  */\n   if (TREE_CODE (arg0) == ERROR_MARK || TREE_CODE (arg1) == ERROR_MARK\n       || TREE_TYPE (arg0) == error_mark_node"}, {"sha": "6d573d7b6d290874945eff0e18249b0895a84525", "filename": "gcc/tree-core.h", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b3b2bae4e2a40ede680da463415bf8e4e885b93e/gcc%2Ftree-core.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b3b2bae4e2a40ede680da463415bf8e4e885b93e/gcc%2Ftree-core.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-core.h?ref=b3b2bae4e2a40ede680da463415bf8e4e885b93e", "patch": "@@ -765,7 +765,9 @@ enum operand_equal_flag {\n   OEP_ONLY_CONST = 1,\n   OEP_PURE_SAME = 2,\n   OEP_MATCH_SIDE_EFFECTS = 4,\n-  OEP_ADDRESS_OF = 8\n+  OEP_ADDRESS_OF = 8,\n+  /* Internal within operand_equal_p:  */\n+  OEP_NO_HASH_CHECK = 16\n };\n \n /* Enum and arrays used for tree allocation stats."}]}