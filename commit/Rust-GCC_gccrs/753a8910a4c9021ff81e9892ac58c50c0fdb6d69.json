{"sha": "753a8910a4c9021ff81e9892ac58c50c0fdb6d69", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzUzYTg5MTBhNGM5MDIxZmY4MWU5ODkyYWM1OGM1MGMwZmRiNmQ2OQ==", "commit": {"author": {"name": "Patrick Palka", "email": "ppalka@gcc.gnu.org", "date": "2016-03-18T01:23:26Z"}, "committer": {"name": "Patrick Palka", "email": "ppalka@gcc.gnu.org", "date": "2016-03-18T01:23:26Z"}, "message": "Fix PR c++/70218 (illegal access to private field succeeds)\n\ngcc/cp/ChangeLog:\n\n\tPR c++/70218\n\t* parser.c (cp_parser_lambda_expression): Move call to\n\tpop_deferring_access_checks ahead of the call to\n\tcp_parser_end_tentative_firewall.\n\ngcc/testsuite/ChangeLog:\n\n\tPR c++/70218\n\t* g++.dg/cpp0x/lambda/lambda-70218.C: New test.\n\nFrom-SVN: r234316", "tree": {"sha": "6c27e45dd0c7221674892f4c5dac59d16ea73e65", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6c27e45dd0c7221674892f4c5dac59d16ea73e65"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/753a8910a4c9021ff81e9892ac58c50c0fdb6d69", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/753a8910a4c9021ff81e9892ac58c50c0fdb6d69", "html_url": "https://github.com/Rust-GCC/gccrs/commit/753a8910a4c9021ff81e9892ac58c50c0fdb6d69", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/753a8910a4c9021ff81e9892ac58c50c0fdb6d69/comments", "author": null, "committer": null, "parents": [{"sha": "4a8e35b32ce7b8af8719e15ef26fbe2575d16610", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4a8e35b32ce7b8af8719e15ef26fbe2575d16610", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4a8e35b32ce7b8af8719e15ef26fbe2575d16610"}], "stats": {"total": 33, "additions": 31, "deletions": 2}, "files": [{"sha": "764122a30637a26aba8ff29f00da5a4fc1855099", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/753a8910a4c9021ff81e9892ac58c50c0fdb6d69/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/753a8910a4c9021ff81e9892ac58c50c0fdb6d69/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=753a8910a4c9021ff81e9892ac58c50c0fdb6d69", "patch": "@@ -1,3 +1,10 @@\n+2016-03-18  Patrick Palka  <ppalka@gcc.gnu.org>\n+\n+\tPR c++/70218\n+\t* parser.c (cp_parser_lambda_expression): Move call to\n+\tpop_deferring_access_checks ahead of the call to\n+\tcp_parser_end_tentative_firewall.\n+\n 2016-03-17  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR c++/70144"}, {"sha": "7e13c6e74f676e95ff7ff6acf314bbc1739a8d3e", "filename": "gcc/cp/parser.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/753a8910a4c9021ff81e9892ac58c50c0fdb6d69/gcc%2Fcp%2Fparser.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/753a8910a4c9021ff81e9892ac58c50c0fdb6d69/gcc%2Fcp%2Fparser.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fparser.c?ref=753a8910a4c9021ff81e9892ac58c50c0fdb6d69", "patch": "@@ -9781,8 +9781,6 @@ cp_parser_lambda_expression (cp_parser* parser)\n \t= auto_is_implicit_function_template_parm_p;\n   }\n \n-  pop_deferring_access_checks ();\n-\n   /* This field is only used during parsing of the lambda.  */\n   LAMBDA_EXPR_THIS_CAPTURE (lambda_expr) = NULL_TREE;\n \n@@ -9798,6 +9796,8 @@ cp_parser_lambda_expression (cp_parser* parser)\n \n   cp_parser_end_tentative_firewall (parser, start, lambda_expr);\n \n+  pop_deferring_access_checks ();\n+\n   return lambda_expr;\n }\n "}, {"sha": "5f792eee8037e06e48d7028412bc66863cadbf87", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/753a8910a4c9021ff81e9892ac58c50c0fdb6d69/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/753a8910a4c9021ff81e9892ac58c50c0fdb6d69/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=753a8910a4c9021ff81e9892ac58c50c0fdb6d69", "patch": "@@ -1,3 +1,8 @@\n+2016-03-18  Patrick Palka  <ppalka@gcc.gnu.org>\n+\n+\tPR c++/70218\n+\t* g++.dg/cpp0x/lambda/lambda-70218.C: New test.\n+\n 2016-03-17  Marek Polacek  <polacek@redhat.com>\n \n \tPR c/69407"}, {"sha": "ae8cc2f5000e117b6e82a4d76e40441205022811", "filename": "gcc/testsuite/g++.dg/cpp0x/lambda/lambda-70218.C", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/753a8910a4c9021ff81e9892ac58c50c0fdb6d69/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Flambda%2Flambda-70218.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/753a8910a4c9021ff81e9892ac58c50c0fdb6d69/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Flambda%2Flambda-70218.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Flambda%2Flambda-70218.C?ref=753a8910a4c9021ff81e9892ac58c50c0fdb6d69", "patch": "@@ -0,0 +1,17 @@\n+// PR c++/70218\n+// { dg-do compile { target c++11 } }\n+\n+struct X {\n+private:\n+   int i;\n+};\n+\n+struct Y {\n+  Y (int) { }\n+};\n+\n+void\n+foo ()\n+{\n+  Y ([] { X x; x.i = 3; return 0; } ()); // { dg-error \"private\" }\n+}"}]}