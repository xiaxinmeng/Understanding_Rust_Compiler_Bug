{"sha": "c764b8b1be5ae72fd733814be834fe4273386b28", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Yzc2NGI4YjFiZTVhZTcyZmQ3MzM4MTRiZTgzNGZlNDI3MzM4NmIyOA==", "commit": {"author": {"name": "Diego Novillo", "email": "dnovillo@redhat.com", "date": "2005-04-15T16:18:25Z"}, "committer": {"name": "Jeff Law", "email": "law@gcc.gnu.org", "date": "2005-04-15T16:18:25Z"}, "message": "tree-vect-transform.c (vectorizable_store): Mark necessary objects in the vectorized store needing renaming.\n\n\n\t* tree-vect-transform.c (vectorizable_store): Mark necessary\n\tobjects in the vectorized store needing renaming.  Update the\n\tSSA graph for V_MAY_DEF operands in the original store.\n\nFrom-SVN: r98189", "tree": {"sha": "80dbf05a44de9056ffa338d5fc2299cec26a0127", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/80dbf05a44de9056ffa338d5fc2299cec26a0127"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c764b8b1be5ae72fd733814be834fe4273386b28", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c764b8b1be5ae72fd733814be834fe4273386b28", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c764b8b1be5ae72fd733814be834fe4273386b28", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c764b8b1be5ae72fd733814be834fe4273386b28/comments", "author": null, "committer": null, "parents": [{"sha": "f559447165fa63dde8ece816a834b068ba72e2e6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f559447165fa63dde8ece816a834b068ba72e2e6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f559447165fa63dde8ece816a834b068ba72e2e6"}], "stats": {"total": 32, "additions": 17, "deletions": 15}, "files": [{"sha": "e884a571f8edc11853ac85c85250cdbfd5bb18fb", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c764b8b1be5ae72fd733814be834fe4273386b28/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c764b8b1be5ae72fd733814be834fe4273386b28/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=c764b8b1be5ae72fd733814be834fe4273386b28", "patch": "@@ -1,3 +1,9 @@\n+2005-04-15  Diego Novillo  <dnovillo@redhat.com>\n+\n+\t* tree-vect-transform.c (vectorizable_store): Mark necessary\n+\tobjects in the vectorized store needing renaming.  Update the\n+\tSSA graph for V_MAY_DEF operands in the original store.\n+\n 2005-04-14  Daniel Berlin <dberlin@dberlin.org>\n \n \t* tree-ssa-pre.c (compute_avail): It's okay to have"}, {"sha": "e325ef80e423f93568d3660f9ff6aca633c2f49f", "filename": "gcc/tree-vect-transform.c", "status": "modified", "additions": 11, "deletions": 15, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c764b8b1be5ae72fd733814be834fe4273386b28/gcc%2Ftree-vect-transform.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c764b8b1be5ae72fd733814be834fe4273386b28/gcc%2Ftree-vect-transform.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-vect-transform.c?ref=c764b8b1be5ae72fd733814be834fe4273386b28", "patch": "@@ -856,8 +856,8 @@ vectorizable_store (tree stmt, block_stmt_iterator *bsi, tree *vec_stmt)\n   enum machine_mode vec_mode;\n   tree dummy;\n   enum dr_alignment_support alignment_support_cheme;\n-  v_may_def_optype v_may_defs;\n-  int nv_may_defs, i;\n+  ssa_op_iter iter;\n+  tree def;\n \n   /* Is vectorizable store? */\n \n@@ -915,20 +915,16 @@ vectorizable_store (tree stmt, block_stmt_iterator *bsi, tree *vec_stmt)\n   *vec_stmt = build2 (MODIFY_EXPR, vectype, data_ref, vec_oprnd1);\n   vect_finish_stmt_generation (stmt, *vec_stmt, bsi);\n \n-  /* Copy the V_MAY_DEFS representing the aliasing of the original array\n-     element's definition to the vector's definition then update the\n-     defining statement.  The original is being deleted so the same\n-     SSA_NAMEs can be used.  */\n-  copy_virtual_operands (*vec_stmt, stmt);\n-  v_may_defs = STMT_V_MAY_DEF_OPS (*vec_stmt);\n-  nv_may_defs = NUM_V_MAY_DEFS (v_may_defs);\n+  /* Mark all non-SSA variables in the statement for rewriting.  */\n+  mark_new_vars_to_rename (*vec_stmt);\n \t    \n-  for (i = 0; i < nv_may_defs; i++)\n-    {\n-      tree ssa_name = V_MAY_DEF_RESULT (v_may_defs, i);\n-      SSA_NAME_DEF_STMT (ssa_name) = *vec_stmt;\n-    }\n-\n+  /* The new vectorized statement will have better aliasing\n+     information, so some of the virtual definitions of the old\n+     statement will likely disappear from the IL.  Mark them to have\n+     their SSA form updated.  */\n+  FOR_EACH_SSA_TREE_OPERAND (def, stmt, iter, SSA_OP_VMAYDEF)\n+    mark_sym_for_renaming (SSA_NAME_VAR (def));\n+ \n   return true;\n }\n "}]}