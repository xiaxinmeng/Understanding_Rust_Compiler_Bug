{"sha": "556c714b3d1e4350f9b5e747f879cef4775adb93", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTU2YzcxNGIzZDFlNDM1MGY5YjVlNzQ3Zjg3OWNlZjQ3NzVhZGI5Mw==", "commit": {"author": {"name": "Jim Wilson", "email": "wilson@cygnus.com", "date": "1997-12-24T22:54:37Z"}, "committer": {"name": "Jeff Law", "email": "law@gcc.gnu.org", "date": "1997-12-24T22:54:37Z"}, "message": "cse.c (max_insn_uid): New variable.\n\n        * cse.c (max_insn_uid): New variable.\n        (invalidate): Remove CYGNUS LOCAL patch.\n        (cse_around_loop): Use max_insn_uid.\n        (cse_main): Set max_insn_uid.\n\nFrom-SVN: r17231", "tree": {"sha": "02187c7018503772746f089b073241f1d04c5b8e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/02187c7018503772746f089b073241f1d04c5b8e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/556c714b3d1e4350f9b5e747f879cef4775adb93", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/556c714b3d1e4350f9b5e747f879cef4775adb93", "html_url": "https://github.com/Rust-GCC/gccrs/commit/556c714b3d1e4350f9b5e747f879cef4775adb93", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/556c714b3d1e4350f9b5e747f879cef4775adb93/comments", "author": null, "committer": null, "parents": [{"sha": "d9a4ee007b9041817143d1fa761d5f2528818dd0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d9a4ee007b9041817143d1fa761d5f2528818dd0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d9a4ee007b9041817143d1fa761d5f2528818dd0"}], "stats": {"total": 20, "additions": 19, "deletions": 1}, "files": [{"sha": "1926629f190b637c644512a899583d5b96a43551", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/556c714b3d1e4350f9b5e747f879cef4775adb93/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/556c714b3d1e4350f9b5e747f879cef4775adb93/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=556c714b3d1e4350f9b5e747f879cef4775adb93", "patch": "@@ -4,6 +4,11 @@ Wed Dec 24 23:33:17 1997  Jeffrey A Law  (law@cygnus.com)\n \n Wed Dec 24 23:12:14 1997  Jim Wilson  <wilson@cygnus.com>\n \n+\t* cse.c (max_insn_uid): New variable.\n+\t(invalidate): Remove CYGNUS LOCAL patch.\n+\t(cse_around_loop): Use max_insn_uid.\n+\t(cse_main): Set max_insn_uid.\n+\n \t* abi64.h (LONG_MAX_SPEC): Check MIPS_ABI_DEFAULT and TARGET_DEFAULT,\n \tand define __LONG_MAX__ appropriately.  Add support for -mabi=X,\n \t-mlong64, and -mgp{32,64} options."}, {"sha": "ca1b6489445fe652497bdf45c99880ce6e7fbb89", "filename": "gcc/cse.c", "status": "modified", "additions": 14, "deletions": 1, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/556c714b3d1e4350f9b5e747f879cef4775adb93/gcc%2Fcse.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/556c714b3d1e4350f9b5e747f879cef4775adb93/gcc%2Fcse.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcse.c?ref=556c714b3d1e4350f9b5e747f879cef4775adb93", "patch": "@@ -193,6 +193,11 @@ Related expressions:\n \n static int max_reg;\n \n+/* One plus largest instruction UID used in this function at time of\n+   cse_main call.  */\n+\n+static int max_insn_uid;\n+\n /* Length of vectors indexed by quantity number.\n    We know in advance we will not need a quantity number this big.  */\n \n@@ -7798,10 +7803,16 @@ cse_around_loop (loop_start)\n \n      The only thing we do with SET_DEST is invalidate entries, so we\n      can safely process each SET in order.  It is slightly less efficient\n-     to do so, but we only want to handle the most common cases.  */\n+     to do so, but we only want to handle the most common cases.\n+\n+     The gen_move_insn call in cse_set_around_loop may create new pseudos.\n+     These pseudos won't have valid entries in any of the tables indexed\n+     by register number, such as reg_qty.  We avoid out-of-range array\n+     accesses by not processing any instructions created after cse started.  */\n \n   for (insn = NEXT_INSN (loop_start);\n        GET_CODE (insn) != CALL_INSN && GET_CODE (insn) != CODE_LABEL\n+       && INSN_UID (insn) < max_insn_uid\n        && ! (GET_CODE (insn) == NOTE\n \t     && NOTE_LINE_NUMBER (insn) == NOTE_INSN_LOOP_END);\n        insn = NEXT_INSN (insn))\n@@ -8248,6 +8259,8 @@ cse_main (f, nregs, after_loop, file)\n \n   max_reg = nregs;\n \n+  max_insn_uid = get_max_uid ();\n+\n   all_minus_one = (int *) alloca (nregs * sizeof (int));\n   consec_ints = (int *) alloca (nregs * sizeof (int));\n "}]}