{"sha": "d5d4d14e156d91fa4f5490eee269b6fc01b12160", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDVkNGQxNGUxNTZkOTFmYTRmNTQ5MGVlZTI2OWI2ZmMwMWIxMjE2MA==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2011-01-04T22:44:04Z"}, "committer": {"name": "Eric Botcazou", "email": "ebotcazou@gcc.gnu.org", "date": "2011-01-04T22:44:04Z"}, "message": "dwarf2out.c (rtl_for_decl_init): Strip no-op conversions off the initializer.\n\n\t* dwarf2out.c (rtl_for_decl_init): Strip no-op conversions off the\n\tinitializer.  Skip view conversions from aggregate types.\n\nFrom-SVN: r168488", "tree": {"sha": "d3f331d5e4da342751a22707e4ec2414cebc9f72", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d3f331d5e4da342751a22707e4ec2414cebc9f72"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d5d4d14e156d91fa4f5490eee269b6fc01b12160", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d5d4d14e156d91fa4f5490eee269b6fc01b12160", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d5d4d14e156d91fa4f5490eee269b6fc01b12160", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d5d4d14e156d91fa4f5490eee269b6fc01b12160/comments", "author": null, "committer": null, "parents": [{"sha": "5e208e74b37744d823fdf438ee0d0841dfdac055", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5e208e74b37744d823fdf438ee0d0841dfdac055", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5e208e74b37744d823fdf438ee0d0841dfdac055"}], "stats": {"total": 55, "additions": 54, "deletions": 1}, "files": [{"sha": "0b7a977a35723297a1e34ea43486f748ba63b8c1", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d5d4d14e156d91fa4f5490eee269b6fc01b12160/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d5d4d14e156d91fa4f5490eee269b6fc01b12160/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=d5d4d14e156d91fa4f5490eee269b6fc01b12160", "patch": "@@ -1,3 +1,8 @@\n+2011-01-04  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* dwarf2out.c (rtl_for_decl_init): Strip no-op conversions off the\n+\tinitializer.  Skip view conversions from aggregate types.\n+\n 2011-01-04  Kai Tietz  <kai.tietz@onevision.com>\n \n \tPR bootstrap/47055"}, {"sha": "22ee3240a3653c948116e019d0a64938127e77b8", "filename": "gcc/dwarf2out.c", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d5d4d14e156d91fa4f5490eee269b6fc01b12160/gcc%2Fdwarf2out.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d5d4d14e156d91fa4f5490eee269b6fc01b12160/gcc%2Fdwarf2out.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdwarf2out.c?ref=d5d4d14e156d91fa4f5490eee269b6fc01b12160", "patch": "@@ -16526,6 +16526,8 @@ rtl_for_decl_init (tree init, tree type)\n {\n   rtx rtl = NULL_RTX;\n \n+  STRIP_NOPS (init);\n+\n   /* If a variable is initialized with a string constant without embedded\n      zeros, build CONST_STRING.  */\n   if (TREE_CODE (init) == STRING_CST && TREE_CODE (type) == ARRAY_TYPE)\n@@ -16550,7 +16552,10 @@ rtl_for_decl_init (tree init, tree type)\n     }\n   /* Other aggregates, and complex values, could be represented using\n      CONCAT: FIXME!  */\n-  else if (AGGREGATE_TYPE_P (type) || TREE_CODE (type) == COMPLEX_TYPE)\n+  else if (AGGREGATE_TYPE_P (type)\n+\t   || (TREE_CODE (init) == VIEW_CONVERT_EXPR\n+\t       && AGGREGATE_TYPE_P (TREE_TYPE (TREE_OPERAND (init, 0))))\n+\t   || TREE_CODE (type) == COMPLEX_TYPE)\n     ;\n   /* Vectors only work if their mode is supported by the target.\n      FIXME: generic vectors ought to work too.  */"}, {"sha": "7ee893eee2deeaf95546a2304b2a073ef8edca02", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d5d4d14e156d91fa4f5490eee269b6fc01b12160/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d5d4d14e156d91fa4f5490eee269b6fc01b12160/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=d5d4d14e156d91fa4f5490eee269b6fc01b12160", "patch": "@@ -1,3 +1,7 @@\n+2011-01-04  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* gnat.dg/unchecked_convert8.ad[sb]: New test.\n+\n 2011-01-04  Janus Weil  <janus@gcc.gnu.org>\n \n \tPR fortran/46448"}, {"sha": "0b8f8d12d2048e51d1e928f601b647dab94e7fe7", "filename": "gcc/testsuite/gnat.dg/unchecked_convert8.adb", "status": "added", "additions": 34, "deletions": 0, "changes": 34, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d5d4d14e156d91fa4f5490eee269b6fc01b12160/gcc%2Ftestsuite%2Fgnat.dg%2Funchecked_convert8.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d5d4d14e156d91fa4f5490eee269b6fc01b12160/gcc%2Ftestsuite%2Fgnat.dg%2Funchecked_convert8.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Funchecked_convert8.adb?ref=d5d4d14e156d91fa4f5490eee269b6fc01b12160", "patch": "@@ -0,0 +1,34 @@\n+-- { dg-do compile }\n+-- { dg-options \"-g -O\" }\n+\n+with Ada.Unchecked_Conversion;\n+\n+package body Unchecked_Convert8 is\n+\n+   type T1 is range 0 .. 255;\n+\n+   type T2 is\n+      record\n+         A : T1;\n+         B : T1;\n+      end record;\n+\n+   for T2 use\n+      record\n+         A at 0 range 0 .. 7;\n+         B at 1 range 0 .. 7;\n+      end record;\n+\n+   for T2'Size use 16;\n+\n+   type T3 is range 0 .. (2**16 - 1);\n+   for  T3'Size use 16;\n+\n+   function T2_TO_T3 is\n+      new Ada.Unchecked_Conversion (Source => T2, Target => T3);\n+\n+   C : constant T3 := T2_TO_T3 (S => (A => 0, B => 0));\n+\n+   procedure Dummy is begin null; end;\n+\n+end Unchecked_Convert8;"}, {"sha": "3a2857ccb091bce342bac2d6e58d8aa6f03048e9", "filename": "gcc/testsuite/gnat.dg/unchecked_convert8.ads", "status": "added", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d5d4d14e156d91fa4f5490eee269b6fc01b12160/gcc%2Ftestsuite%2Fgnat.dg%2Funchecked_convert8.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d5d4d14e156d91fa4f5490eee269b6fc01b12160/gcc%2Ftestsuite%2Fgnat.dg%2Funchecked_convert8.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Funchecked_convert8.ads?ref=d5d4d14e156d91fa4f5490eee269b6fc01b12160", "patch": "@@ -0,0 +1,5 @@\n+package Unchecked_Convert8 is\n+\n+   procedure Dummy;\n+\n+end Unchecked_Convert8;"}]}