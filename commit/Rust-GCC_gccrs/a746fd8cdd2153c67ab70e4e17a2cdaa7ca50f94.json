{"sha": "a746fd8cdd2153c67ab70e4e17a2cdaa7ca50f94", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTc0NmZkOGNkZDIxNTNjNjdhYjcwZTRlMTdhMmNkYWE3Y2E1MGY5NA==", "commit": {"author": {"name": "Zdenek Dvorak", "email": "dvorakz@suse.cz", "date": "2004-10-07T06:14:15Z"}, "committer": {"name": "Zdenek Dvorak", "email": "rakdver@gcc.gnu.org", "date": "2004-10-07T06:14:15Z"}, "message": "re PR tree-optimization/17806 (compiler error: in verify_loop_structure, at cfgloop.c:1491 , works -O2, breaks with -O3)\n\n\tPR tree-optimization/17806\n\t* cfghooks.c (split_edge): Update IRREDUCIBLE_LOOP flags.\n\t* cfgloopmanip.c (loop_split_edge_with): Updating of IRREDUCIBLE_LOOP\n\tflags moved to split_edge.\n\nFrom-SVN: r88665", "tree": {"sha": "710e59e353d684b5781d79e6d8725a5a5754308b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/710e59e353d684b5781d79e6d8725a5a5754308b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a746fd8cdd2153c67ab70e4e17a2cdaa7ca50f94", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a746fd8cdd2153c67ab70e4e17a2cdaa7ca50f94", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a746fd8cdd2153c67ab70e4e17a2cdaa7ca50f94", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a746fd8cdd2153c67ab70e4e17a2cdaa7ca50f94/comments", "author": null, "committer": null, "parents": [{"sha": "cc67d2fa8036ea5b92e83d97faecd3cb38417b80", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cc67d2fa8036ea5b92e83d97faecd3cb38417b80", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cc67d2fa8036ea5b92e83d97faecd3cb38417b80"}], "stats": {"total": 25, "additions": 16, "deletions": 9}, "files": [{"sha": "541807b98e9a473dc6aa3121e890c82e2443080c", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a746fd8cdd2153c67ab70e4e17a2cdaa7ca50f94/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a746fd8cdd2153c67ab70e4e17a2cdaa7ca50f94/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=a746fd8cdd2153c67ab70e4e17a2cdaa7ca50f94", "patch": "@@ -1,3 +1,10 @@\n+2004-10-07  Zdenek Dvorak  <dvorakz@suse.cz>\n+\n+\tPR tree-optimization/17806\n+\t* cfghooks.c (split_edge): Update IRREDUCIBLE_LOOP flags.\n+\t* cfgloopmanip.c (loop_split_edge_with): Updating of IRREDUCIBLE_LOOP\n+\tflags moved to split_edge.\n+\n 2004-10-07  Eric Botcazou  <ebotcazou@libertysurf.fr>\n \n \tPR middle-end/17285"}, {"sha": "948c2b4c13dc6e2942ec261ff8f71520562f3bff", "filename": "gcc/cfghooks.c", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a746fd8cdd2153c67ab70e4e17a2cdaa7ca50f94/gcc%2Fcfghooks.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a746fd8cdd2153c67ab70e4e17a2cdaa7ca50f94/gcc%2Fcfghooks.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcfghooks.c?ref=a746fd8cdd2153c67ab70e4e17a2cdaa7ca50f94", "patch": "@@ -389,6 +389,7 @@ split_edge (edge e)\n   gcov_type count = e->count;\n   int freq = EDGE_FREQUENCY (e);\n   edge f;\n+  bool irr = (e->flags & EDGE_IRREDUCIBLE_LOOP) != 0;\n \n   if (!cfg_hooks->split_edge)\n     internal_error (\"%s does not support split_edge.\", cfg_hooks->name);\n@@ -399,6 +400,13 @@ split_edge (edge e)\n   EDGE_SUCC (ret, 0)->probability = REG_BR_PROB_BASE;\n   EDGE_SUCC (ret, 0)->count = count;\n \n+  if (irr)\n+    {\n+      ret->flags |= BB_IRREDUCIBLE_LOOP;\n+      EDGE_PRED (ret, 0)->flags |= EDGE_IRREDUCIBLE_LOOP;\n+      EDGE_SUCC (ret, 0)->flags |= EDGE_IRREDUCIBLE_LOOP;\n+    }\n+\n   if (dom_computed[CDI_DOMINATORS])\n     set_immediate_dominator (CDI_DOMINATORS, ret, EDGE_PRED (ret, 0)->src);\n "}, {"sha": "6d47756f5886c000b83efd399e18d6847aedd9b3", "filename": "gcc/cfgloopmanip.c", "status": "modified", "additions": 1, "deletions": 9, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a746fd8cdd2153c67ab70e4e17a2cdaa7ca50f94/gcc%2Fcfgloopmanip.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a746fd8cdd2153c67ab70e4e17a2cdaa7ca50f94/gcc%2Fcfgloopmanip.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcfgloopmanip.c?ref=a746fd8cdd2153c67ab70e4e17a2cdaa7ca50f94", "patch": "@@ -1241,7 +1241,6 @@ loop_split_edge_with (edge e, rtx insns)\n {\n   basic_block src, dest, new_bb;\n   struct loop *loop_c;\n-  edge new_e;\n \n   src = e->src;\n   dest = e->dest;\n@@ -1252,14 +1251,7 @@ loop_split_edge_with (edge e, rtx insns)\n \n   new_bb = split_edge (e);\n   add_bb_to_loop (new_bb, loop_c);\n-  new_bb->flags = insns ? BB_SUPERBLOCK : 0;\n-\n-  new_e = EDGE_SUCC (new_bb, 0);\n-  if (e->flags & EDGE_IRREDUCIBLE_LOOP)\n-    {\n-      new_bb->flags |= BB_IRREDUCIBLE_LOOP;\n-      new_e->flags |= EDGE_IRREDUCIBLE_LOOP;\n-    }\n+  new_bb->flags |= (insns ? BB_SUPERBLOCK : 0);\n \n   if (insns)\n     emit_insn_after (insns, BB_END (new_bb));"}]}