{"sha": "2d23fd23bbb84a6ea87cb8c77699261d6ae8100e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MmQyM2ZkMjNiYmI4NGE2ZWE4N2NiOGM3NzY5OTI2MWQ2YWU4MTAwZQ==", "commit": {"author": {"name": "Olivier Hainque", "email": "hainque@adacore.com", "date": "2020-10-15T17:39:05Z"}, "committer": {"name": "Olivier Hainque", "email": "hainque@adacore.com", "date": "2020-10-16T15:33:35Z"}, "message": "Fix the vxworks crtstuff handling of kernel/rtp variations\n\nThe ports that support RTPs achieve the kernel/rtp compilation\nand link distinction through the multilib mechanism.\n\nThis patch just removes the bogus explicit extraneous\nmaterialization of this distinction in the common VxWorks\nconfiguration files and leaves the rtp specialization all\nto the multilib machinery.\n\n2020-10-15  Olivier Hainque  <hainque@adacore.com>\n\nlibgcc/\n\t* config/t-vxcrtstuff: Remove the -kernel/-rtp specialization.\n\ngcc/\n\t* config/vxworks.h (VX_CRTBEGIN_SPEC): Likewise.", "tree": {"sha": "fdea67b41f9166315db151402c0f5909f20a46b9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/fdea67b41f9166315db151402c0f5909f20a46b9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2d23fd23bbb84a6ea87cb8c77699261d6ae8100e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2d23fd23bbb84a6ea87cb8c77699261d6ae8100e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2d23fd23bbb84a6ea87cb8c77699261d6ae8100e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2d23fd23bbb84a6ea87cb8c77699261d6ae8100e/comments", "author": {"login": "hainque", "id": 18735142, "node_id": "MDQ6VXNlcjE4NzM1MTQy", "avatar_url": "https://avatars.githubusercontent.com/u/18735142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hainque", "html_url": "https://github.com/hainque", "followers_url": "https://api.github.com/users/hainque/followers", "following_url": "https://api.github.com/users/hainque/following{/other_user}", "gists_url": "https://api.github.com/users/hainque/gists{/gist_id}", "starred_url": "https://api.github.com/users/hainque/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hainque/subscriptions", "organizations_url": "https://api.github.com/users/hainque/orgs", "repos_url": "https://api.github.com/users/hainque/repos", "events_url": "https://api.github.com/users/hainque/events{/privacy}", "received_events_url": "https://api.github.com/users/hainque/received_events", "type": "User", "site_admin": false}, "committer": {"login": "hainque", "id": 18735142, "node_id": "MDQ6VXNlcjE4NzM1MTQy", "avatar_url": "https://avatars.githubusercontent.com/u/18735142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hainque", "html_url": "https://github.com/hainque", "followers_url": "https://api.github.com/users/hainque/followers", "following_url": "https://api.github.com/users/hainque/following{/other_user}", "gists_url": "https://api.github.com/users/hainque/gists{/gist_id}", "starred_url": "https://api.github.com/users/hainque/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hainque/subscriptions", "organizations_url": "https://api.github.com/users/hainque/orgs", "repos_url": "https://api.github.com/users/hainque/repos", "events_url": "https://api.github.com/users/hainque/events{/privacy}", "received_events_url": "https://api.github.com/users/hainque/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "57dd4e7bb754db3f2ccdffd031d8f252d0a6d3bb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/57dd4e7bb754db3f2ccdffd031d8f252d0a6d3bb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/57dd4e7bb754db3f2ccdffd031d8f252d0a6d3bb"}], "stats": {"total": 15, "additions": 7, "deletions": 8}, "files": [{"sha": "5b1538085e9ead4b278a55a1908c4653af1721b8", "filename": "gcc/config/vxworks.h", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2d23fd23bbb84a6ea87cb8c77699261d6ae8100e/gcc%2Fconfig%2Fvxworks.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2d23fd23bbb84a6ea87cb8c77699261d6ae8100e/gcc%2Fconfig%2Fvxworks.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fvxworks.h?ref=2d23fd23bbb84a6ea87cb8c77699261d6ae8100e", "patch": "@@ -158,8 +158,7 @@ along with GCC; see the file COPYING3.  If not see\n /* Setup the crtstuff begin/end we might need for dwarf EH registration.  */\n \n #if !defined(CONFIG_SJLJ_EXCEPTIONS) && DWARF2_UNWIND_INFO\n-#define VX_CRTBEGIN_SPEC \\\n- \"%{!mrtp:vx_crtbegin-kernel.o%s} %{mrtp:vx_crtbegin-rtp.o%s}\"\n+#define VX_CRTBEGIN_SPEC \"vx_crtbegin.o%s\"\n #define VX_CRTEND_SPEC \"-l:vx_crtend.o\"\n #else\n #define VX_CRTBEGIN_SPEC \"\""}, {"sha": "ef64951c90389eb73ce37d5462cddf2ac01fb25b", "filename": "libgcc/config/t-vxcrtstuff", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2d23fd23bbb84a6ea87cb8c77699261d6ae8100e/libgcc%2Fconfig%2Ft-vxcrtstuff", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2d23fd23bbb84a6ea87cb8c77699261d6ae8100e/libgcc%2Fconfig%2Ft-vxcrtstuff", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgcc%2Fconfig%2Ft-vxcrtstuff?ref=2d23fd23bbb84a6ea87cb8c77699261d6ae8100e", "patch": "@@ -1,12 +1,12 @@\n-# crtbegin/crtend for VxWorks (DKM or RTP)\n+# crtbegin/crtend for VxWorks\n \n-vx_crtbegin-kernel.o: $(srcdir)/config/vxcrtstuff.c\n+vx_crtbegin.o: $(srcdir)/config/vxcrtstuff.c\n \t$(crt_compile) $(CRTSTUFF_T_CFLAGS) -DCRT_BEGIN -c $<\n \n-vx_crtbegin-rtp.o: $(srcdir)/config/vxcrtstuff.c\n-\t$(crt_compile) $(CRTSTUFF_T_CFLAGS) -DCRT_BEGIN -c $< -mrtp\n-\n vx_crtend.o: $(srcdir)/config/vxcrtstuff.c\n \t$(crt_compile) $(CRTSTUFF_T_CFLAGS) -DCRT_END -c $<\n \n-EXTRA_PARTS += vx_crtbegin-kernel.o vx_crtbegin-rtp.o vx_crtend.o\n+# We do pretty different things for kernel vs rtp modes, all\n+# controlled thanks to __RTP__ and (optional) multilibs.\n+\n+EXTRA_PARTS += vx_crtbegin.o vx_crtend.o"}]}