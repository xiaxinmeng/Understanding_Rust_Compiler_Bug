{"sha": "48eff283138708a8be3d3ed2ad20d34f875abbb8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDhlZmYyODMxMzg3MDhhOGJlM2QzZWQyYWQyMGQzNGY4NzVhYmJiOA==", "commit": {"author": {"name": "Emmanuel Briot", "email": "briot@adacore.com", "date": "2009-08-17T09:42:19Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2009-08-17T09:42:19Z"}, "message": "2009-08-17  Emmanuel Briot  <briot@adacore.com>\n\n\t* prj-part.adb, prj.adb, prj.ads, prj-nmsc.adb, prj-conf.adb\n\t(Processing_Flags.Require_Obj_Dirs): new field, which controls whether\n\tobject directories must be present. In the case of gprclean at least,\n\tthese are optional (if they do not exist there is nothing to clean)\n\nFrom-SVN: r150827", "tree": {"sha": "4728ff516530c2b8bab54862de22026b6598e1e5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4728ff516530c2b8bab54862de22026b6598e1e5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/48eff283138708a8be3d3ed2ad20d34f875abbb8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/48eff283138708a8be3d3ed2ad20d34f875abbb8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/48eff283138708a8be3d3ed2ad20d34f875abbb8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/48eff283138708a8be3d3ed2ad20d34f875abbb8/comments", "author": {"login": "briot", "id": 42402, "node_id": "MDQ6VXNlcjQyNDAy", "avatar_url": "https://avatars.githubusercontent.com/u/42402?v=4", "gravatar_id": "", "url": "https://api.github.com/users/briot", "html_url": "https://github.com/briot", "followers_url": "https://api.github.com/users/briot/followers", "following_url": "https://api.github.com/users/briot/following{/other_user}", "gists_url": "https://api.github.com/users/briot/gists{/gist_id}", "starred_url": "https://api.github.com/users/briot/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/briot/subscriptions", "organizations_url": "https://api.github.com/users/briot/orgs", "repos_url": "https://api.github.com/users/briot/repos", "events_url": "https://api.github.com/users/briot/events{/privacy}", "received_events_url": "https://api.github.com/users/briot/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "88eb6e62fcba2cb0c92194b4a3dbb29c4385ae75", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/88eb6e62fcba2cb0c92194b4a3dbb29c4385ae75", "html_url": "https://github.com/Rust-GCC/gccrs/commit/88eb6e62fcba2cb0c92194b4a3dbb29c4385ae75"}], "stats": {"total": 69, "additions": 58, "deletions": 11}, "files": [{"sha": "879178de1228faf5fd207d4974f324de210f30a8", "filename": "gcc/ada/prj-conf.adb", "status": "modified", "additions": 12, "deletions": 2, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/48eff283138708a8be3d3ed2ad20d34f875abbb8/gcc%2Fada%2Fprj-conf.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/48eff283138708a8be3d3ed2ad20d34f875abbb8/gcc%2Fada%2Fprj-conf.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-conf.adb?ref=48eff283138708a8be3d3ed2ad20d34f875abbb8", "patch": "@@ -29,6 +29,7 @@ with Makeutl;          use Makeutl;\n with MLib.Tgt;\n with Opt;              use Opt;\n with Output;           use Output;\n+with Prj.Err;\n with Prj.Part;\n with Prj.PP;\n with Prj.Proc;         use Prj.Proc;\n@@ -722,8 +723,17 @@ package body Prj.Conf is\n             end if;\n \n             if not Is_Directory (Obj_Dir) then\n-               raise Invalid_Config\n-                 with \"object directory \" & Obj_Dir & \" does not exist\";\n+               case Flags.Require_Obj_Dirs is\n+                  when Error =>\n+                     raise Invalid_Config\n+                       with \"object directory \" & Obj_Dir & \" does not exist\";\n+                  when Warning =>\n+                     Prj.Err.Error_Msg\n+                       (Flags,\n+                        \"?object directory \" & Obj_Dir & \" does not exist\");\n+                  when Silent =>\n+                     null;\n+               end case;\n             end if;\n \n             --  Invoke gprconfig"}, {"sha": "1a0371855c5f2d04824767f00485720604027673", "filename": "gcc/ada/prj-nmsc.adb", "status": "modified", "additions": 15, "deletions": 4, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/48eff283138708a8be3d3ed2ad20d34f875abbb8/gcc%2Fada%2Fprj-nmsc.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/48eff283138708a8be3d3ed2ad20d34f875abbb8/gcc%2Fada%2Fprj-nmsc.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-nmsc.adb?ref=48eff283138708a8be3d3ed2ad20d34f875abbb8", "patch": "@@ -5148,10 +5148,21 @@ package body Prj.Nmsc is\n \n                Err_Vars.Error_Msg_File_1 :=\n                  File_Name_Type (Object_Dir.Value);\n-               Error_Msg\n-                 (Data.Flags,\n-                  \"object directory { not found\",\n-                  Project.Location, Project);\n+\n+               case Data.Flags.Require_Obj_Dirs is\n+                  when Error =>\n+                     Error_Msg\n+                       (Data.Flags,\n+                        \"object directory { not found\",\n+                        Project.Location, Project);\n+                  when Warning =>\n+                     Error_Msg\n+                       (Data.Flags,\n+                        \"?object directory { not found\",\n+                        Project.Location, Project);\n+                  when Silent =>\n+                     null;\n+               end case;\n             end if;\n          end if;\n "}, {"sha": "84e3f6dab7fd37d3e89769b00cb07519fb63886a", "filename": "gcc/ada/prj-part.adb", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/48eff283138708a8be3d3ed2ad20d34f875abbb8/gcc%2Fada%2Fprj-part.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/48eff283138708a8be3d3ed2ad20d34f875abbb8/gcc%2Fada%2Fprj-part.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-part.adb?ref=48eff283138708a8be3d3ed2ad20d34f875abbb8", "patch": "@@ -583,6 +583,10 @@ package body Prj.Part is\n \n          if No (Project) or else Always_Errout_Finalize then\n             Prj.Err.Finalize;\n+\n+            --  Reinitialize to avoid duplicate warnings later on\n+\n+            Prj.Err.Initialize;\n          end if;\n       end;\n "}, {"sha": "2bed1a81dc29a09fbf0a8d235c1567fea2420442", "filename": "gcc/ada/prj.adb", "status": "modified", "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/48eff283138708a8be3d3ed2ad20d34f875abbb8/gcc%2Fada%2Fprj.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/48eff283138708a8be3d3ed2ad20d34f875abbb8/gcc%2Fada%2Fprj.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj.adb?ref=48eff283138708a8be3d3ed2ad20d34f875abbb8", "patch": "@@ -1189,7 +1189,9 @@ package body Prj is\n       Require_Sources_Other_Lang : Boolean := True;\n       Allow_Duplicate_Basenames  : Boolean := True;\n       Compiler_Driver_Mandatory  : Boolean := False;\n-      Error_On_Unknown_Language  : Boolean := True) return Processing_Flags\n+      Error_On_Unknown_Language  : Boolean := True;\n+      Require_Obj_Dirs           : Error_Warning := Error)\n+      return Processing_Flags\n    is\n    begin\n       return Processing_Flags'\n@@ -1198,7 +1200,8 @@ package body Prj is\n          Require_Sources_Other_Lang => Require_Sources_Other_Lang,\n          Allow_Duplicate_Basenames  => Allow_Duplicate_Basenames,\n          Error_On_Unknown_Language  => Error_On_Unknown_Language,\n-         Compiler_Driver_Mandatory  => Compiler_Driver_Mandatory);\n+         Compiler_Driver_Mandatory  => Compiler_Driver_Mandatory,\n+         Require_Obj_Dirs           => Require_Obj_Dirs);\n    end Create_Flags;\n \n begin"}, {"sha": "76eb59aecbb1e7368f032d13499c3a24cb8a6fa8", "filename": "gcc/ada/prj.ads", "status": "modified", "additions": 22, "deletions": 3, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/48eff283138708a8be3d3ed2ad20d34f875abbb8/gcc%2Fada%2Fprj.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/48eff283138708a8be3d3ed2ad20d34f875abbb8/gcc%2Fada%2Fprj.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj.ads?ref=48eff283138708a8be3d3ed2ad20d34f875abbb8", "patch": "@@ -1386,7 +1386,9 @@ package Prj is\n       Require_Sources_Other_Lang : Boolean := True;\n       Allow_Duplicate_Basenames  : Boolean := True;\n       Compiler_Driver_Mandatory  : Boolean := False;\n-      Error_On_Unknown_Language  : Boolean := True) return Processing_Flags;\n+      Error_On_Unknown_Language  : Boolean := True;\n+      Require_Obj_Dirs           : Error_Warning := Error)\n+      return Processing_Flags;\n    --  Function used to create Processing_Flags structure\n    --\n    --  If Allow_Duplicate_Basenames, then files with the same base names are\n@@ -1410,8 +1412,13 @@ package Prj is\n    --\n    --  If Error_On_Unknown_Language is true, an error is displayed if some of\n    --  the source files listed in the project do not match any naming scheme\n+   --\n+   --  If Require_Obj_Dirs is true, then all object directories must exist\n+   --  (possibly after they have been created automatically if the appropriate\n+   --  switches were specified), or an error is raised.\n \n    Gprbuild_Flags : constant Processing_Flags;\n+   Gprclean_Flags : constant Processing_Flags;\n    Gnatmake_Flags : constant Processing_Flags;\n    --  Flags used by the various tools. They all display the error messages\n    --  through Prj.Err.\n@@ -1516,6 +1523,7 @@ private\n       Allow_Duplicate_Basenames  : Boolean;\n       Compiler_Driver_Mandatory  : Boolean;\n       Error_On_Unknown_Language  : Boolean;\n+      Require_Obj_Dirs           : Error_Warning;\n    end record;\n \n    Gprbuild_Flags : constant Processing_Flags :=\n@@ -1524,14 +1532,25 @@ private\n       Require_Sources_Other_Lang => True,\n       Allow_Duplicate_Basenames  => False,\n       Compiler_Driver_Mandatory  => True,\n-      Error_On_Unknown_Language  => True);\n+      Error_On_Unknown_Language  => True,\n+      Require_Obj_Dirs           => Error);\n+\n+   Gprclean_Flags : constant Processing_Flags :=\n+     (Report_Error               => null,\n+      When_No_Sources            => Warning,\n+      Require_Sources_Other_Lang => True,\n+      Allow_Duplicate_Basenames  => False,\n+      Compiler_Driver_Mandatory  => True,\n+      Error_On_Unknown_Language  => True,\n+      Require_Obj_Dirs           => Warning);\n \n    Gnatmake_Flags : constant Processing_Flags :=\n      (Report_Error               => null,\n       When_No_Sources            => Error,\n       Require_Sources_Other_Lang => False,\n       Allow_Duplicate_Basenames  => False,\n       Compiler_Driver_Mandatory  => False,\n-      Error_On_Unknown_Language  => False);\n+      Error_On_Unknown_Language  => False,\n+      Require_Obj_Dirs           => Error);\n \n end Prj;"}]}