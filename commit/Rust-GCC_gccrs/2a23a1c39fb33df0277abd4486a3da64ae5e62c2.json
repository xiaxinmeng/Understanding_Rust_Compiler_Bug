{"sha": "2a23a1c39fb33df0277abd4486a3da64ae5e62c2", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MmEyM2ExYzM5ZmIzM2RmMDI3N2FiZDQ0ODZhM2RhNjRhZTVlNjJjMg==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2019-03-19T19:04:14Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2019-03-19T19:04:14Z"}, "message": "re PR rtl-optimization/89768 (ICE in compare_and_jump_seq at loop-unroll.c:838)\n\n\tPR rtl-optimization/89768\n\t* loop-unroll.c (unroll_loop_constant_iterations): Use gen_int_mode\n\tinstead of GEN_INT.\n\t(unroll_loop_runtime_iterations): Likewise.\n\nFrom-SVN: r269812", "tree": {"sha": "54c3c251350ec1e257162d8ab01537dda078a455", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/54c3c251350ec1e257162d8ab01537dda078a455"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2a23a1c39fb33df0277abd4486a3da64ae5e62c2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2a23a1c39fb33df0277abd4486a3da64ae5e62c2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2a23a1c39fb33df0277abd4486a3da64ae5e62c2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2a23a1c39fb33df0277abd4486a3da64ae5e62c2/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "ea5ac5a69b4b474bb221051e705f98d8599253fa", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ea5ac5a69b4b474bb221051e705f98d8599253fa", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ea5ac5a69b4b474bb221051e705f98d8599253fa"}], "stats": {"total": 15, "additions": 11, "deletions": 4}, "files": [{"sha": "f4b59d7d9ebfe08094816c83436dcc2dc86b1dd3", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2a23a1c39fb33df0277abd4486a3da64ae5e62c2/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2a23a1c39fb33df0277abd4486a3da64ae5e62c2/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=2a23a1c39fb33df0277abd4486a3da64ae5e62c2", "patch": "@@ -1,3 +1,10 @@\n+2019-03-19  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR rtl-optimization/89768\n+\t* loop-unroll.c (unroll_loop_constant_iterations): Use gen_int_mode\n+\tinstead of GEN_INT.\n+\t(unroll_loop_runtime_iterations): Likewise.\n+\n 2019-03-19  Martin Sebor  <msebor@redhat.com>\n \n \tPR tree-optimization/89644"}, {"sha": "1b4c73b61c85855f2f62c3f6a42a283c9a3531f4", "filename": "gcc/loop-unroll.c", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2a23a1c39fb33df0277abd4486a3da64ae5e62c2/gcc%2Floop-unroll.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2a23a1c39fb33df0277abd4486a3da64ae5e62c2/gcc%2Floop-unroll.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Floop-unroll.c?ref=2a23a1c39fb33df0277abd4486a3da64ae5e62c2", "patch": "@@ -652,7 +652,7 @@ unroll_loop_constant_iterations (struct loop *loop)\n   if (loop->any_likely_upper_bound)\n     loop->nb_iterations_likely_upper_bound\n       = wi::udiv_trunc (loop->nb_iterations_likely_upper_bound, max_unroll + 1);\n-  desc->niter_expr = GEN_INT (desc->niter);\n+  desc->niter_expr = gen_int_mode (desc->niter, desc->mode);\n \n   /* Remove the edges.  */\n   FOR_EACH_VEC_ELT (remove_edges, i, e)\n@@ -1020,9 +1020,9 @@ unroll_loop_runtime_iterations (struct loop *loop)\n       preheader = split_edge (loop_preheader_edge (loop));\n       /* Add in count of edge from switch block.  */\n       preheader->count += iter_count;\n-      branch_code = compare_and_jump_seq (copy_rtx (niter), GEN_INT (j), EQ,\n-\t\t\t\t\t  block_label (preheader), p,\n-\t\t\t\t\t  NULL);\n+      branch_code = compare_and_jump_seq (copy_rtx (niter),\n+\t\t\t\t\t  gen_int_mode (j, desc->mode), EQ,\n+\t\t\t\t\t  block_label (preheader), p, NULL);\n \n       /* We rely on the fact that the compare and jump cannot be optimized out,\n \t and hence the cfg we create is correct.  */"}]}