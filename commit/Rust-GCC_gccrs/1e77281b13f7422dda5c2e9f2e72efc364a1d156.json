{"sha": "1e77281b13f7422dda5c2e9f2e72efc364a1d156", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWU3NzI4MWIxM2Y3NDIyZGRhNWMyZTlmMmU3MmVmYzM2NGExZDE1Ng==", "commit": {"author": {"name": "Marek Polacek", "email": "polacek@redhat.com", "date": "2016-04-15T13:15:23Z"}, "committer": {"name": "Marek Polacek", "email": "mpolacek@gcc.gnu.org", "date": "2016-04-15T13:15:23Z"}, "message": "re PR c/70651 (ICE on invalid code on x86_64-linux-gnu in build_va_arg, at c-family/c-common.c:5728)\n\n\tPR c/70651\n\t* c-common.c (build_va_arg): Change two asserts into errors and return\n\terror_mark_node.\n\n\t* c-c++-common/pr70651.c: New test.\n\nFrom-SVN: r235027", "tree": {"sha": "061774906bbfa0c5be9e741fd1174ca837aed154", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/061774906bbfa0c5be9e741fd1174ca837aed154"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1e77281b13f7422dda5c2e9f2e72efc364a1d156", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1e77281b13f7422dda5c2e9f2e72efc364a1d156", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1e77281b13f7422dda5c2e9f2e72efc364a1d156", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1e77281b13f7422dda5c2e9f2e72efc364a1d156/comments", "author": {"login": "mpolacek", "id": 10496300, "node_id": "MDQ6VXNlcjEwNDk2MzAw", "avatar_url": "https://avatars.githubusercontent.com/u/10496300?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mpolacek", "html_url": "https://github.com/mpolacek", "followers_url": "https://api.github.com/users/mpolacek/followers", "following_url": "https://api.github.com/users/mpolacek/following{/other_user}", "gists_url": "https://api.github.com/users/mpolacek/gists{/gist_id}", "starred_url": "https://api.github.com/users/mpolacek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mpolacek/subscriptions", "organizations_url": "https://api.github.com/users/mpolacek/orgs", "repos_url": "https://api.github.com/users/mpolacek/repos", "events_url": "https://api.github.com/users/mpolacek/events{/privacy}", "received_events_url": "https://api.github.com/users/mpolacek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "51dbe4a05d67f3fe09dcd08336024293ef3fbd0c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/51dbe4a05d67f3fe09dcd08336024293ef3fbd0c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/51dbe4a05d67f3fe09dcd08336024293ef3fbd0c"}], "stats": {"total": 34, "additions": 32, "deletions": 2}, "files": [{"sha": "ec79edbaa931788b1e7999e8ff430c5fa6278e82", "filename": "gcc/c-family/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1e77281b13f7422dda5c2e9f2e72efc364a1d156/gcc%2Fc-family%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1e77281b13f7422dda5c2e9f2e72efc364a1d156/gcc%2Fc-family%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2FChangeLog?ref=1e77281b13f7422dda5c2e9f2e72efc364a1d156", "patch": "@@ -1,3 +1,9 @@\n+2016-04-15  Marek Polacek  <polacek@redhat.com>\n+\n+\tPR c/70651\n+\t* c-common.c (build_va_arg): Change two asserts into errors and return\n+\terror_mark_node.\n+\n 2016-04-13  Marek Polacek  <polacek@redhat.com>\n \n \tPR c++/70639"}, {"sha": "f2846bb26e7ce77d6a80e25ca7ae670c7e6eddaa", "filename": "gcc/c-family/c-common.c", "status": "modified", "additions": 12, "deletions": 2, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1e77281b13f7422dda5c2e9f2e72efc364a1d156/gcc%2Fc-family%2Fc-common.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1e77281b13f7422dda5c2e9f2e72efc364a1d156/gcc%2Fc-family%2Fc-common.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2Fc-common.c?ref=1e77281b13f7422dda5c2e9f2e72efc364a1d156", "patch": "@@ -5725,7 +5725,12 @@ build_va_arg (location_t loc, tree expr, tree type)\n       /* Verify that &ap is still recognized as having va_list type.  */\n       tree canon_expr_type\n \t= targetm.canonical_va_list_type (TREE_TYPE (expr));\n-      gcc_assert (canon_expr_type != NULL_TREE);\n+      if (canon_expr_type == NULL_TREE)\n+\t{\n+\t  error_at (loc,\n+\t\t    \"first argument to %<va_arg%> not of type %<va_list%>\");\n+\t  return error_mark_node;\n+\t}\n \n       return build_va_arg_1 (loc, type, expr);\n     }\n@@ -5793,7 +5798,12 @@ build_va_arg (location_t loc, tree expr, tree type)\n       /* Verify that &ap is still recognized as having va_list type.  */\n       tree canon_expr_type\n \t= targetm.canonical_va_list_type (TREE_TYPE (expr));\n-      gcc_assert (canon_expr_type != NULL_TREE);\n+      if (canon_expr_type == NULL_TREE)\n+\t{\n+\t  error_at (loc,\n+\t\t    \"first argument to %<va_arg%> not of type %<va_list%>\");\n+\t  return error_mark_node;\n+\t}\n     }\n   else\n     {"}, {"sha": "9b395d93e9a284392c9f8c19ae37eda5661bd5f3", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1e77281b13f7422dda5c2e9f2e72efc364a1d156/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1e77281b13f7422dda5c2e9f2e72efc364a1d156/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=1e77281b13f7422dda5c2e9f2e72efc364a1d156", "patch": "@@ -1,3 +1,8 @@\n+2016-04-15  Marek Polacek  <polacek@redhat.com>\n+\n+\tPR c/70651\n+\t* c-c++-common/pr70651.c: New test.\n+\n 2016-04-15  Kyrylo Tkachov  <kyrylo.tkachov@arm.com>\n \n \tPR rtl-optimization/70681"}, {"sha": "a91a2d8fc884a96357326a473358c6b8a359bc95", "filename": "gcc/testsuite/c-c++-common/pr70651.c", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1e77281b13f7422dda5c2e9f2e72efc364a1d156/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fpr70651.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1e77281b13f7422dda5c2e9f2e72efc364a1d156/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fpr70651.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fpr70651.c?ref=1e77281b13f7422dda5c2e9f2e72efc364a1d156", "patch": "@@ -0,0 +1,9 @@\n+/* PR c/70651 */\n+/* { dg-do compile } */\n+/* { dg-prune-output \"\\[^\\n\\r\\]*first argument to .va_arg. not of type .va_list.\\[^\\n\\r\\]*\" } */\n+\n+void fn1 ()\n+{\n+  char **a = 0;\n+  __builtin_va_arg (a, char **);\n+}"}]}