{"sha": "844234fb50d86f0e03b6645bf40011d45a8ae65c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODQ0MjM0ZmI1MGQ4NmYwZTAzYjY2NDViZjQwMDExZDQ1YThhZTY1Yw==", "commit": {"author": {"name": "Jerry DeLisle", "email": "jvdelisle@gcc.gnu.org", "date": "2005-12-28T20:58:08Z"}, "committer": {"name": "Jerry DeLisle", "email": "jvdelisle@gcc.gnu.org", "date": "2005-12-28T20:58:08Z"}, "message": "re PR libfortran/25139 (\"Invalid argument\" error on I/O)\n\n2005-12-28  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n\n\tPR libgfortran/25139\n\t* io/unix.c (fd_truncate): Set s->active to zero.\n\tPR libgfortran/25510\n\t* libgfortran.h: Add ERROR_INTERNAL and ERROR_INTERNAL_UNIT.\n\t* runtime/error.c (translate_error): Add messages for new errors.\n\t* io/list_read.c (next_char): Use new errors.\n\t* io/transfer.c (next_record_r) (next_record_w): Use new errors.\n\nFrom-SVN: r109122", "tree": {"sha": "b63a6a30c0af2c94fb6a30da53a4f61a383ada74", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b63a6a30c0af2c94fb6a30da53a4f61a383ada74"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/844234fb50d86f0e03b6645bf40011d45a8ae65c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/844234fb50d86f0e03b6645bf40011d45a8ae65c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/844234fb50d86f0e03b6645bf40011d45a8ae65c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/844234fb50d86f0e03b6645bf40011d45a8ae65c/comments", "author": null, "committer": null, "parents": [{"sha": "ff7417d4c9b74b85cfb17000718b245b2aa96cb5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ff7417d4c9b74b85cfb17000718b245b2aa96cb5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ff7417d4c9b74b85cfb17000718b245b2aa96cb5"}], "stats": {"total": 31, "additions": 27, "deletions": 4}, "files": [{"sha": "d60193afb584072b8f723a4b86ad621125b43cc2", "filename": "libgfortran/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/844234fb50d86f0e03b6645bf40011d45a8ae65c/libgfortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/844234fb50d86f0e03b6645bf40011d45a8ae65c/libgfortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2FChangeLog?ref=844234fb50d86f0e03b6645bf40011d45a8ae65c", "patch": "@@ -1,3 +1,13 @@\n+2005-12-28  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n+\n+\tPR libgfortran/25139\n+\t* io/unix.c (fd_truncate): Set s->active to zero.\n+\tPR libgfortran/25510\n+\t* libgfortran.h: Add ERROR_INTERNAL and ERROR_INTERNAL_UNIT.\n+\t* runtime/error.c (translate_error): Add messages for new errors.\n+\t* io/list_read.c (next_char): Use new errors.\n+\t* io/transfer.c (next_record_r) (next_record_w): Use new errors.\n+\n 2005-12-28  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n \n \tPR libgfortran/25550"}, {"sha": "879cf8f3230a3624616132b9d21ae5e7b3fbd457", "filename": "libgfortran/io/list_read.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/844234fb50d86f0e03b6645bf40011d45a8ae65c/libgfortran%2Fio%2Flist_read.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/844234fb50d86f0e03b6645bf40011d45a8ae65c/libgfortran%2Fio%2Flist_read.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fio%2Flist_read.c?ref=844234fb50d86f0e03b6645bf40011d45a8ae65c", "patch": "@@ -164,7 +164,7 @@ next_char (st_parameter_dt *dtp)\n \t     check for NULL here is cautionary. */\n \t  if (p == NULL)\n \t    {\n-\t      generate_error (&dtp->common, ERROR_OS, NULL);\n+\t      generate_error (&dtp->common, ERROR_INTERNAL_UNIT, NULL);\n \t      return '\\0';\n \t    }\n "}, {"sha": "2c12294398eee993f97c4df18e21d79c26b3c983", "filename": "libgfortran/io/transfer.c", "status": "modified", "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/844234fb50d86f0e03b6645bf40011d45a8ae65c/libgfortran%2Fio%2Ftransfer.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/844234fb50d86f0e03b6645bf40011d45a8ae65c/libgfortran%2Fio%2Ftransfer.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fio%2Ftransfer.c?ref=844234fb50d86f0e03b6645bf40011d45a8ae65c", "patch": "@@ -1702,7 +1702,7 @@ next_record_r (st_parameter_dt *dtp)\n \t      record = record * dtp->u.p.current_unit->recl;\n \t      if (sseek (dtp->u.p.current_unit->s, record) == FAILURE)\n \t\t{\n-\t\t  generate_error (&dtp->common, ERROR_OS, NULL);\n+\t\t  generate_error (&dtp->common, ERROR_INTERNAL_UNIT, NULL);\n \t\t  break;\n \t\t}\n \t      dtp->u.p.current_unit->bytes_left = dtp->u.p.current_unit->recl;\n@@ -1863,7 +1863,10 @@ next_record_w (st_parameter_dt *dtp, int done)\n \t      record = record * dtp->u.p.current_unit->recl;\n \n \t      if (sseek (dtp->u.p.current_unit->s, record) == FAILURE)\n-\t\tgoto io_error;\n+\t\t{\n+\t\t  generate_error (&dtp->common, ERROR_INTERNAL_UNIT, NULL);\n+\t\t  return;\n+\t\t}\n \n \t      dtp->u.p.current_unit->bytes_left = dtp->u.p.current_unit->recl;\n \t    }"}, {"sha": "237f09e99308aa47585cbd7618086a32358a979f", "filename": "libgfortran/io/unix.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/844234fb50d86f0e03b6645bf40011d45a8ae65c/libgfortran%2Fio%2Funix.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/844234fb50d86f0e03b6645bf40011d45a8ae65c/libgfortran%2Fio%2Funix.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fio%2Funix.c?ref=844234fb50d86f0e03b6645bf40011d45a8ae65c", "patch": "@@ -601,7 +601,7 @@ fd_truncate (unix_stream * s)\n     }\n \n   s->physical_offset = s->file_length = s->logical_offset;\n-\n+  s->active = 0;\n   return SUCCESS;\n }\n "}, {"sha": "b64b60b1894be68e8852bb343c94f0b5f6da255c", "filename": "libgfortran/libgfortran.h", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/844234fb50d86f0e03b6645bf40011d45a8ae65c/libgfortran%2Flibgfortran.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/844234fb50d86f0e03b6645bf40011d45a8ae65c/libgfortran%2Flibgfortran.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Flibgfortran.h?ref=844234fb50d86f0e03b6645bf40011d45a8ae65c", "patch": "@@ -407,6 +407,8 @@ typedef enum\n   ERROR_BAD_US,\n   ERROR_READ_VALUE,\n   ERROR_READ_OVERFLOW,\n+  ERROR_INTERNAL,\n+  ERROR_INTERNAL_UNIT,\n   ERROR_LAST\t\t\t/* Not a real error, the last error # + 1.  */\n }\n error_codes;"}, {"sha": "2d3c0689adc226d587705423329d241f44ade146", "filename": "libgfortran/runtime/error.c", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/844234fb50d86f0e03b6645bf40011d45a8ae65c/libgfortran%2Fruntime%2Ferror.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/844234fb50d86f0e03b6645bf40011d45a8ae65c/libgfortran%2Fruntime%2Ferror.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fruntime%2Ferror.c?ref=844234fb50d86f0e03b6645bf40011d45a8ae65c", "patch": "@@ -423,6 +423,14 @@ translate_error (int code)\n       p = \"Numeric overflow on read\";\n       break;\n \n+    case ERROR_INTERNAL:\n+      p = \"Internal error in run-time library\";\n+      break;\n+\n+    case ERROR_INTERNAL_UNIT:\n+      p = \"Internal unit I/O error\";\n+      break;\n+\n     default:\n       p = \"Unknown error code\";\n       break;"}]}