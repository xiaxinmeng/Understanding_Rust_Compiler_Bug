{"sha": "b665081f577d875903570ad64f40278faf0f79a0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjY2NTA4MWY1NzdkODc1OTAzNTcwYWQ2NGY0MDI3OGZhZjBmNzlhMA==", "commit": {"author": {"name": "Richard Sandiford", "email": "richard.sandiford@arm.com", "date": "2020-12-17T00:15:04Z"}, "committer": {"name": "Richard Sandiford", "email": "richard.sandiford@arm.com", "date": "2020-12-17T00:15:04Z"}, "message": "recog: Split out a register_asm_p function\n\nverify_changes has a test for whether a particular hard register\nis a user-defined register asm.  A later patch needs to test the\nsame thing, so this patch splits it out into a helper.\n\ngcc/\n\t* rtl.h (register_asm_p): Declare.\n\t* recog.c (verify_changes): Split out the test for whether\n\ta hard register is a register asm to...\n\t* rtlanal.c (register_asm_p): ...this new function.", "tree": {"sha": "80017d507a06471713351db5993f09d66c359aac", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/80017d507a06471713351db5993f09d66c359aac"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b665081f577d875903570ad64f40278faf0f79a0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b665081f577d875903570ad64f40278faf0f79a0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b665081f577d875903570ad64f40278faf0f79a0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b665081f577d875903570ad64f40278faf0f79a0/comments", "author": {"login": "rsandifo-arm", "id": 28043039, "node_id": "MDQ6VXNlcjI4MDQzMDM5", "avatar_url": "https://avatars.githubusercontent.com/u/28043039?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rsandifo-arm", "html_url": "https://github.com/rsandifo-arm", "followers_url": "https://api.github.com/users/rsandifo-arm/followers", "following_url": "https://api.github.com/users/rsandifo-arm/following{/other_user}", "gists_url": "https://api.github.com/users/rsandifo-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/rsandifo-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rsandifo-arm/subscriptions", "organizations_url": "https://api.github.com/users/rsandifo-arm/orgs", "repos_url": "https://api.github.com/users/rsandifo-arm/repos", "events_url": "https://api.github.com/users/rsandifo-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/rsandifo-arm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "rsandifo-arm", "id": 28043039, "node_id": "MDQ6VXNlcjI4MDQzMDM5", "avatar_url": "https://avatars.githubusercontent.com/u/28043039?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rsandifo-arm", "html_url": "https://github.com/rsandifo-arm", "followers_url": "https://api.github.com/users/rsandifo-arm/followers", "following_url": "https://api.github.com/users/rsandifo-arm/following{/other_user}", "gists_url": "https://api.github.com/users/rsandifo-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/rsandifo-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rsandifo-arm/subscriptions", "organizations_url": "https://api.github.com/users/rsandifo-arm/orgs", "repos_url": "https://api.github.com/users/rsandifo-arm/repos", "events_url": "https://api.github.com/users/rsandifo-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/rsandifo-arm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d6c9781e073c359552d361ad34eb07c6c9231573", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d6c9781e073c359552d361ad34eb07c6c9231573", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d6c9781e073c359552d361ad34eb07c6c9231573"}], "stats": {"total": 18, "additions": 14, "deletions": 4}, "files": [{"sha": "2d934169a81d1f40b7c57dbaa8f91a3cd4ba3ff7", "filename": "gcc/recog.c", "status": "modified", "additions": 1, "deletions": 4, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b665081f577d875903570ad64f40278faf0f79a0/gcc%2Frecog.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b665081f577d875903570ad64f40278faf0f79a0/gcc%2Frecog.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Frecog.c?ref=b665081f577d875903570ad64f40278faf0f79a0", "patch": "@@ -408,10 +408,7 @@ verify_changes (int num)\n \t       changes[i].old\n \t       && REG_P (changes[i].old)\n \t       && asm_noperands (PATTERN (object)) > 0\n-\t       && REG_EXPR (changes[i].old) != NULL_TREE\n-\t       && HAS_DECL_ASSEMBLER_NAME_P (REG_EXPR (changes[i].old))\n-\t       && DECL_ASSEMBLER_NAME_SET_P (REG_EXPR (changes[i].old))\n-\t       && DECL_REGISTER (REG_EXPR (changes[i].old)))\n+\t       && register_asm_p (changes[i].old))\n \t{\n \t  /* Don't allow changes of hard register operands to inline\n \t     assemblies if they have been defined as register asm (\"x\").  */"}, {"sha": "5a1670f295cdf492bfe347f93ec6bcf1cfdb2b7d", "filename": "gcc/rtl.h", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b665081f577d875903570ad64f40278faf0f79a0/gcc%2Frtl.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b665081f577d875903570ad64f40278faf0f79a0/gcc%2Frtl.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Frtl.h?ref=b665081f577d875903570ad64f40278faf0f79a0", "patch": "@@ -3525,6 +3525,7 @@ extern rtx tablejump_casesi_pattern (const rtx_insn *insn);\n extern int computed_jump_p (const rtx_insn *);\n extern bool tls_referenced_p (const_rtx);\n extern bool contains_mem_rtx_p (rtx x);\n+extern bool register_asm_p (const_rtx);\n \n /* Overload for refers_to_regno_p for checking a single register.  */\n inline bool"}, {"sha": "30d5b0c6b7664d3f2ba3e4a686d9507c31fb0219", "filename": "gcc/rtlanal.c", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b665081f577d875903570ad64f40278faf0f79a0/gcc%2Frtlanal.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b665081f577d875903570ad64f40278faf0f79a0/gcc%2Frtlanal.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Frtlanal.c?ref=b665081f577d875903570ad64f40278faf0f79a0", "patch": "@@ -6617,3 +6617,15 @@ add_auto_inc_notes (rtx_insn *insn, rtx x)\n \t  add_auto_inc_notes (insn, XVECEXP (x, i, j));\n     }\n }\n+\n+/* Return true if X is register asm.  */\n+\n+bool\n+register_asm_p (const_rtx x)\n+{\n+  return (REG_P (x)\n+\t  && REG_EXPR (x) != NULL_TREE\n+\t  && HAS_DECL_ASSEMBLER_NAME_P (REG_EXPR (x))\n+\t  && DECL_ASSEMBLER_NAME_SET_P (REG_EXPR (x))\n+\t  && DECL_REGISTER (REG_EXPR (x)));\n+}"}]}