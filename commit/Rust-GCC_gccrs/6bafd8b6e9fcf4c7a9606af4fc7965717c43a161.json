{"sha": "6bafd8b6e9fcf4c7a9606af4fc7965717c43a161", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NmJhZmQ4YjZlOWZjZjRjN2E5NjA2YWY0ZmM3OTY1NzE3YzQzYTE2MQ==", "commit": {"author": {"name": "Alexandre Petit-Bianco", "email": "apbianco@gcc.gnu.org", "date": "1999-12-31T03:06:55Z"}, "committer": {"name": "Alexandre Petit-Bianco", "email": "apbianco@gcc.gnu.org", "date": "1999-12-31T03:06:55Z"}, "message": "expr.c (expand_invoke): Layout the loaded class before attempting to use it.\n\nThu Dec 16 00:09:45 1999  Alexandre Petit-Bianco  <apbianco@cygnus.com>\n\n\t* expr.c (expand_invoke): Layout the loaded class before\n \tattempting to use it.\n\t(expand_java_field_op): Allow final field assignments to take\n \tplace in $finit$.\n\t* typeck.c (convert): Return error_mark_node if expr is null.\n\nFrom-SVN: r31147", "tree": {"sha": "52faca7919eba5ef248d7f7847d7d29304793ca8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/52faca7919eba5ef248d7f7847d7d29304793ca8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6bafd8b6e9fcf4c7a9606af4fc7965717c43a161", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6bafd8b6e9fcf4c7a9606af4fc7965717c43a161", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6bafd8b6e9fcf4c7a9606af4fc7965717c43a161", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6bafd8b6e9fcf4c7a9606af4fc7965717c43a161/comments", "author": null, "committer": null, "parents": [{"sha": "781b0558cfe05d047a2cc0688d94169355818726", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/781b0558cfe05d047a2cc0688d94169355818726", "html_url": "https://github.com/Rust-GCC/gccrs/commit/781b0558cfe05d047a2cc0688d94169355818726"}], "stats": {"total": 28, "additions": 21, "deletions": 7}, "files": [{"sha": "b90c76bfd288e85e8d670b46835e8466be74c4f0", "filename": "gcc/java/ChangeLog", "status": "modified", "additions": 14, "deletions": 6, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6bafd8b6e9fcf4c7a9606af4fc7965717c43a161/gcc%2Fjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6bafd8b6e9fcf4c7a9606af4fc7965717c43a161/gcc%2Fjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2FChangeLog?ref=6bafd8b6e9fcf4c7a9606af4fc7965717c43a161", "patch": "@@ -22,6 +22,20 @@\n \tpatch_throw_statement, check_thrown_exceptions,\n \tpatch_conditional_expr): Likewise.\n \n+1999-12-17  Tom Tromey  <tromey@cygnus.com>\n+\n+\t* gjavah.c (decode_signature_piece): Print \"::\" in JArray<>.  This\n+\tfixes PR gcj/119.\n+\t(process_file): Use `\\n\\' at end of each line in string.\n+\n+Thu Dec 16 00:09:45 1999  Alexandre Petit-Bianco  <apbianco@cygnus.com>\n+\n+\t* expr.c (expand_invoke): Layout the loaded class before\n+ \tattempting to use it.\n+\t(expand_java_field_op): Allow final field assignments to take\n+ \tplace in $finit$.\n+\t* typeck.c (convert): Return error_mark_node if expr is null. \n+\n 1999-12-14  Alexandre Petit-Bianco  <apbianco@cygnus.com>\n \n \t* class.c (class_depth): Return -1 if the class doesn't load\n@@ -47,12 +61,6 @@\n \t* typeck.c (lookup_java_method): Take WFLs in method names into\n \taccount.\n \t\n-1999-12-17  Tom Tromey  <tromey@cygnus.com>\n-\n-\t* gjavah.c (decode_signature_piece): Print \"::\" in JArray<>.  This\n-\tfixes PR gcj/119.\n-\t(process_file): Use `\\n\\' at end of each line in string.\n-\n Tue Dec 14 14:20:16 1999  Per Bothner  <per@bothner.com>\n \n \t* class.c (make_class_data): flag_keep_inline_functions to keep"}, {"sha": "1b8d1a104d0303f07539a7eb6df52e3323853714", "filename": "gcc/java/expr.c", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6bafd8b6e9fcf4c7a9606af4fc7965717c43a161/gcc%2Fjava%2Fexpr.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6bafd8b6e9fcf4c7a9606af4fc7965717c43a161/gcc%2Fjava%2Fexpr.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2Fexpr.c?ref=6bafd8b6e9fcf4c7a9606af4fc7965717c43a161", "patch": "@@ -1645,6 +1645,7 @@ expand_invoke (opcode, method_ref_index, nargs)\n   if (! CLASS_LOADED_P (self_type))\n     {\n       load_class (self_type, 1);\n+      safe_layout_class (self_type);\n       if (TREE_CODE (TYPE_SIZE (self_type)) == ERROR_MARK)\n \tfatal (\"failed to find class '%s'\", self_name);\n     }\n@@ -1816,7 +1817,9 @@ expand_java_field_op (is_static, is_putting, field_ref_index)\n \t    }\n \t  else\n \t    {\n-\t      if (! DECL_CONSTRUCTOR_P (current_function_decl))\n+\t      tree cfndecl_name = DECL_NAME (current_function_decl);\n+\t      if (! DECL_CONSTRUCTOR_P (current_function_decl)\n+\t\t  && (cfndecl_name != finit_identifier_node))\n \t\terror_with_decl (field_decl, \"assignment to final field `%s' \"\n \t\t\t\t \"not in constructor\");\n \t    }"}, {"sha": "c536efdf7f33ce5cb929a7226d59bb5ea600df46", "filename": "gcc/java/typeck.c", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6bafd8b6e9fcf4c7a9606af4fc7965717c43a161/gcc%2Fjava%2Ftypeck.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6bafd8b6e9fcf4c7a9606af4fc7965717c43a161/gcc%2Fjava%2Ftypeck.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2Ftypeck.c?ref=6bafd8b6e9fcf4c7a9606af4fc7965717c43a161", "patch": "@@ -110,6 +110,9 @@ convert (type, expr)\n {\n   register enum tree_code code = TREE_CODE (type);\n \n+  if (!expr)\n+   return error_mark_node;\n+\n   if (do_not_fold)\n     return build1 (NOP_EXPR, type, expr);\n "}]}