{"sha": "423ed4163b160e8fa81758ed53e54c60040f3c0f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDIzZWQ0MTYzYjE2MGU4ZmE4MTc1OGVkNTNlNTRjNjAwNDBmM2MwZg==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2011-03-03T16:09:55Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2011-03-03T16:09:55Z"}, "message": "re PR c/47963 (ICE: tree check: expected tree that contains 'decl common' structure, have 'integer_cst' in is_global_var, at tree-flow-inline.h:599 on invalid code with -fopenmp)\n\n\tPR c/47963\n\t* gimplify.c (omp_add_variable): Only call omp_notice_variable\n\ton TYPE_SIZE_UNIT if it is a DECL.\n\n\t* gcc.dg/gomp/pr47963.c: New test.\n\t* g++.dg/gomp/pr47963.C: New test.\n\nFrom-SVN: r170655", "tree": {"sha": "0f811ce7e5a3fe13add75d303194536c46f30e87", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0f811ce7e5a3fe13add75d303194536c46f30e87"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/423ed4163b160e8fa81758ed53e54c60040f3c0f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/423ed4163b160e8fa81758ed53e54c60040f3c0f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/423ed4163b160e8fa81758ed53e54c60040f3c0f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/423ed4163b160e8fa81758ed53e54c60040f3c0f/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "71f3a3f5171d29dc3625fa7556c5732aa6b26241", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/71f3a3f5171d29dc3625fa7556c5732aa6b26241", "html_url": "https://github.com/Rust-GCC/gccrs/commit/71f3a3f5171d29dc3625fa7556c5732aa6b26241"}], "stats": {"total": 37, "additions": 35, "deletions": 2}, "files": [{"sha": "1273286301b3b2c0de2a9ad827b1ed94d1ded275", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/423ed4163b160e8fa81758ed53e54c60040f3c0f/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/423ed4163b160e8fa81758ed53e54c60040f3c0f/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=423ed4163b160e8fa81758ed53e54c60040f3c0f", "patch": "@@ -1,5 +1,9 @@\n 2011-03-03  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR c/47963\n+\t* gimplify.c (omp_add_variable): Only call omp_notice_variable\n+\ton TYPE_SIZE_UNIT if it is a DECL.\n+\n \tPR debug/47283\n \t* cfgexpand.c (expand_debug_expr) <case MEM_REF>: If MEM_REF\n \tfirst operand is not is_gimple_mem_ref_addr, try to fold it."}, {"sha": "cf9495c919895683c6f69b6806debc7d67fd6100", "filename": "gcc/gimplify.c", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/423ed4163b160e8fa81758ed53e54c60040f3c0f/gcc%2Fgimplify.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/423ed4163b160e8fa81758ed53e54c60040f3c0f/gcc%2Fgimplify.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgimplify.c?ref=423ed4163b160e8fa81758ed53e54c60040f3c0f", "patch": "@@ -1,6 +1,6 @@\n /* Tree lowering pass.  This pass converts the GENERIC functions-as-trees\n    tree representation into the GIMPLE form.\n-   Copyright (C) 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010\n+   Copyright (C) 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011\n    Free Software Foundation, Inc.\n    Major work done by Sebastian Pop <s.pop@laposte.net>,\n    Diego Novillo <dnovillo@redhat.com> and Jason Merrill <jason@redhat.com>.\n@@ -5511,7 +5511,8 @@ omp_add_variable (struct gimplify_omp_ctx *ctx, tree decl, unsigned int flags)\n \t For local variables TYPE_SIZE_UNIT might not be gimplified yet,\n \t in this case omp_notice_variable will be called later\n \t on when it is gimplified.  */\n-      else if (! (flags & GOVD_LOCAL))\n+      else if (! (flags & GOVD_LOCAL)\n+\t       && DECL_P (TYPE_SIZE_UNIT (TREE_TYPE (decl))))\n \tomp_notice_variable (ctx, TYPE_SIZE_UNIT (TREE_TYPE (decl)), true);\n     }\n   else if (lang_hooks.decls.omp_privatize_by_reference (decl))"}, {"sha": "3f7a372fa0a610039d39cb7f4ffe2b82808e35d7", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/423ed4163b160e8fa81758ed53e54c60040f3c0f/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/423ed4163b160e8fa81758ed53e54c60040f3c0f/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=423ed4163b160e8fa81758ed53e54c60040f3c0f", "patch": "@@ -1,3 +1,9 @@\n+2011-03-03  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR c/47963\n+\t* gcc.dg/gomp/pr47963.c: New test.\n+\t* g++.dg/gomp/pr47963.C: New test.\n+\n 2011-03-02  Jason Merrill  <jason@redhat.com>\n \n \t* g++.dg/cpp0x/regress/condition1.C: New."}, {"sha": "7c94e6422a71ad9a6725a2ef9d01f6849d122900", "filename": "gcc/testsuite/g++.dg/gomp/pr47963.C", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/423ed4163b160e8fa81758ed53e54c60040f3c0f/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fgomp%2Fpr47963.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/423ed4163b160e8fa81758ed53e54c60040f3c0f/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fgomp%2Fpr47963.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fgomp%2Fpr47963.C?ref=423ed4163b160e8fa81758ed53e54c60040f3c0f", "patch": "@@ -0,0 +1,11 @@\n+// PR c/47963\n+// { dg-do compile }\n+// { dg-options \"-fopenmp\" }\n+\n+void\n+foo (float n)\n+{\n+  int A[n][n];\t// { dg-error \"has non-integral type\" }\n+#pragma omp parallel private(A)\n+  ;\n+}"}, {"sha": "636a9542c3230799504899947661f36fc916dc25", "filename": "gcc/testsuite/gcc.dg/gomp/pr47963.c", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/423ed4163b160e8fa81758ed53e54c60040f3c0f/gcc%2Ftestsuite%2Fgcc.dg%2Fgomp%2Fpr47963.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/423ed4163b160e8fa81758ed53e54c60040f3c0f/gcc%2Ftestsuite%2Fgcc.dg%2Fgomp%2Fpr47963.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fgomp%2Fpr47963.c?ref=423ed4163b160e8fa81758ed53e54c60040f3c0f", "patch": "@@ -0,0 +1,11 @@\n+/* PR c/47963 */\n+/* { dg-do compile } */\n+/* { dg-options \"-fopenmp\" } */\n+\n+void\n+foo (float n)\n+{\n+  int A[n][n];\t/* { dg-error \"has non-integer type\" } */\n+#pragma omp parallel private(A)\n+  ;\n+}"}]}