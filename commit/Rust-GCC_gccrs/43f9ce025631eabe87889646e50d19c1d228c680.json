{"sha": "43f9ce025631eabe87889646e50d19c1d228c680", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDNmOWNlMDI1NjMxZWFiZTg3ODg5NjQ2ZTUwZDE5YzFkMjI4YzY4MA==", "commit": {"author": {"name": "Gabriel Dos Reis", "email": "gdr@integrable-solutions.net", "date": "2003-09-07T11:59:52Z"}, "committer": {"name": "Gabriel Dos Reis", "email": "gdr@gcc.gnu.org", "date": "2003-09-07T11:59:52Z"}, "message": "* diagnostic.c (warn_deprecated_use): Move to toplev.c\n\nFrom-SVN: r71168", "tree": {"sha": "a13e6b35d663ef787e8ad6315376985896dbd63f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a13e6b35d663ef787e8ad6315376985896dbd63f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/43f9ce025631eabe87889646e50d19c1d228c680", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/43f9ce025631eabe87889646e50d19c1d228c680", "html_url": "https://github.com/Rust-GCC/gccrs/commit/43f9ce025631eabe87889646e50d19c1d228c680", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/43f9ce025631eabe87889646e50d19c1d228c680/comments", "author": {"login": "cxx-undef", "id": 5528103, "node_id": "MDQ6VXNlcjU1MjgxMDM=", "avatar_url": "https://avatars.githubusercontent.com/u/5528103?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cxx-undef", "html_url": "https://github.com/cxx-undef", "followers_url": "https://api.github.com/users/cxx-undef/followers", "following_url": "https://api.github.com/users/cxx-undef/following{/other_user}", "gists_url": "https://api.github.com/users/cxx-undef/gists{/gist_id}", "starred_url": "https://api.github.com/users/cxx-undef/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cxx-undef/subscriptions", "organizations_url": "https://api.github.com/users/cxx-undef/orgs", "repos_url": "https://api.github.com/users/cxx-undef/repos", "events_url": "https://api.github.com/users/cxx-undef/events{/privacy}", "received_events_url": "https://api.github.com/users/cxx-undef/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "c57e159892e138cdb46977dc063d8a3a9aa91281", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c57e159892e138cdb46977dc063d8a3a9aa91281", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c57e159892e138cdb46977dc063d8a3a9aa91281"}], "stats": {"total": 80, "additions": 42, "deletions": 38}, "files": [{"sha": "d545cd847409e002c03f4245585a07b679d4ca68", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/43f9ce025631eabe87889646e50d19c1d228c680/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/43f9ce025631eabe87889646e50d19c1d228c680/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=43f9ce025631eabe87889646e50d19c1d228c680", "patch": "@@ -1,3 +1,7 @@\n+2003-09-07  Gabriel Dos Reis  <gdr@integrable-solutions.net>\n+\n+\t* diagnostic.c (warn_deprecated_use): Move to toplev.c\n+\n 2003-09-07  Gabriel Dos Reis  <gdr@integrable-solutions.net>\n \n \t* langhooks.c (lhd_print_error_function): Move from diagnostic.c."}, {"sha": "3d64b87cfddc5804a01f8c0d613d8b85e0f21072", "filename": "gcc/diagnostic.c", "status": "modified", "additions": 0, "deletions": 38, "changes": 38, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/43f9ce025631eabe87889646e50d19c1d228c680/gcc%2Fdiagnostic.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/43f9ce025631eabe87889646e50d19c1d228c680/gcc%2Fdiagnostic.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdiagnostic.c?ref=43f9ce025631eabe87889646e50d19c1d228c680", "patch": "@@ -550,44 +550,6 @@ fnotice (FILE *file, const char *msgid, ...)\n   va_end (ap);\n }\n \n-/* Warn about a use of an identifier which was marked deprecated.  */\n-void\n-warn_deprecated_use (tree node)\n-{\n-  if (node == 0 || !warn_deprecated_decl)\n-    return;\n-\n-  if (DECL_P (node))\n-    warning (\"`%s' is deprecated (declared at %s:%d)\",\n-\t     IDENTIFIER_POINTER (DECL_NAME (node)),\n-\t     DECL_SOURCE_FILE (node), DECL_SOURCE_LINE (node));\n-  else if (TYPE_P (node))\n-    {\n-      const char *what = NULL;\n-      tree decl = TYPE_STUB_DECL (node);\n-\n-      if (TREE_CODE (TYPE_NAME (node)) == IDENTIFIER_NODE)\n-\twhat = IDENTIFIER_POINTER (TYPE_NAME (node));\n-      else if (TREE_CODE (TYPE_NAME (node)) == TYPE_DECL\n-\t       && DECL_NAME (TYPE_NAME (node)))\n-\twhat = IDENTIFIER_POINTER (DECL_NAME (TYPE_NAME (node)));\n-\n-      if (what)\n-\t{\n-\t  if (decl)\n-\t    warning (\"`%s' is deprecated (declared at %s:%d)\", what,\n-\t\t     DECL_SOURCE_FILE (decl), DECL_SOURCE_LINE (decl));\n-\t  else\n-\t    warning (\"`%s' is deprecated\", what);\n-\t}\n-      else if (decl)\n-\twarning (\"type is deprecated (declared at %s:%d)\",\n-\t\t DECL_SOURCE_FILE (decl), DECL_SOURCE_LINE (decl));\n-      else\n-\twarning (\"type is deprecated\");\n-    }\n-}\n-\n /* Inform the user that an error occurred while trying to report some\n    other error.  This indicates catastrophic internal inconsistencies,\n    so give up now.  But do try to flush out the previous error."}, {"sha": "aa04138ca966a3f5198f4dd30cef086a6dab123f", "filename": "gcc/toplev.c", "status": "modified", "additions": 38, "deletions": 0, "changes": 38, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/43f9ce025631eabe87889646e50d19c1d228c680/gcc%2Ftoplev.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/43f9ce025631eabe87889646e50d19c1d228c680/gcc%2Ftoplev.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftoplev.c?ref=43f9ce025631eabe87889646e50d19c1d228c680", "patch": "@@ -1702,6 +1702,44 @@ check_global_declarations (tree *vec, int len)\n     }\n }\n \n+/* Warn about a use of an identifier which was marked deprecated.  */\n+void\n+warn_deprecated_use (tree node)\n+{\n+  if (node == 0 || !warn_deprecated_decl)\n+    return;\n+\n+  if (DECL_P (node))\n+    warning (\"`%s' is deprecated (declared at %s:%d)\",\n+\t     IDENTIFIER_POINTER (DECL_NAME (node)),\n+\t     DECL_SOURCE_FILE (node), DECL_SOURCE_LINE (node));\n+  else if (TYPE_P (node))\n+    {\n+      const char *what = NULL;\n+      tree decl = TYPE_STUB_DECL (node);\n+\n+      if (TREE_CODE (TYPE_NAME (node)) == IDENTIFIER_NODE)\n+\twhat = IDENTIFIER_POINTER (TYPE_NAME (node));\n+      else if (TREE_CODE (TYPE_NAME (node)) == TYPE_DECL\n+\t       && DECL_NAME (TYPE_NAME (node)))\n+\twhat = IDENTIFIER_POINTER (DECL_NAME (TYPE_NAME (node)));\n+\n+      if (what)\n+\t{\n+\t  if (decl)\n+\t    warning (\"`%s' is deprecated (declared at %s:%d)\", what,\n+\t\t     DECL_SOURCE_FILE (decl), DECL_SOURCE_LINE (decl));\n+\t  else\n+\t    warning (\"`%s' is deprecated\", what);\n+\t}\n+      else if (decl)\n+\twarning (\"type is deprecated (declared at %s:%d)\",\n+\t\t DECL_SOURCE_FILE (decl), DECL_SOURCE_LINE (decl));\n+      else\n+\twarning (\"type is deprecated\");\n+    }\n+}\n+\n /* Save the current INPUT_LOCATION on the top entry in the\n    INPUT_FILE_STACK.  Push a new entry for FILE and LINE, and set the\n    INPUT_LOCATION accordingly.  */"}]}