{"sha": "f50c417a036697eccfad5a1d6ce777246c77635a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjUwYzQxN2EwMzY2OTdlY2NmYWQ1YTFkNmNlNzc3MjQ2Yzc3NjM1YQ==", "commit": {"author": {"name": "Maciej W. Rozycki", "email": "macro@linux-mips.org", "date": "2020-11-20T21:11:22Z"}, "committer": {"name": "Maciej W. Rozycki", "email": "macro@linux-mips.org", "date": "2020-11-20T21:11:22Z"}, "message": "NetBSD/libgcc: Check for TARGET_DL_ITERATE_PHDR in the unwinder\n\nDisable USE_PT_GNU_EH_FRAME frame unwinder support for old OS versions,\nfixing compilation errors:\n\n.../libgcc/unwind-dw2-fde-dip.c:75:21: error: unknown type name 'Elf_Phdr'\n   75 | # define ElfW(type) Elf_##type\n      |                     ^~~~\n.../libgcc/unwind-dw2-fde-dip.c:132:9: note: in expansion of macro 'ElfW'\n  132 |   const ElfW(Phdr) *p_eh_frame_hdr;\n      |         ^~~~\n.../libgcc/unwind-dw2-fde-dip.c:75:21: error: unknown type name 'Elf_Phdr'\n   75 | # define ElfW(type) Elf_##type\n      |                     ^~~~\n.../libgcc/unwind-dw2-fde-dip.c:133:9: note: in expansion of macro 'ElfW'\n  133 |   const ElfW(Phdr) *p_dynamic;\n      |         ^~~~\n.../libgcc/unwind-dw2-fde-dip.c:165:37: warning: 'struct dl_phdr_info' declared inside parameter list will not be visible outside of this definition or declaration\n  165 | _Unwind_IteratePhdrCallback (struct dl_phdr_info *info, size_t size, void *ptr)\n      |                                     ^~~~~~~~~~~~\n[...]\n\nand producing a working cross-compiler at least with VAX/NetBSD 1.6.2.\n\n\tlibgcc/\n\t* unwind-dw2-fde-dip.c [__OpenBSD__ || __NetBSD__]\n\t(USE_PT_GNU_EH_FRAME): Do not define if !TARGET_DL_ITERATE_PHDR.", "tree": {"sha": "9ef1d2bace680c43f0c9a8b6811cfa0fb1c9a185", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9ef1d2bace680c43f0c9a8b6811cfa0fb1c9a185"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f50c417a036697eccfad5a1d6ce777246c77635a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f50c417a036697eccfad5a1d6ce777246c77635a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f50c417a036697eccfad5a1d6ce777246c77635a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f50c417a036697eccfad5a1d6ce777246c77635a/comments", "author": null, "committer": null, "parents": [{"sha": "df90f070378583f295dd972db4400f324752a240", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/df90f070378583f295dd972db4400f324752a240", "html_url": "https://github.com/Rust-GCC/gccrs/commit/df90f070378583f295dd972db4400f324752a240"}], "stats": {"total": 1, "additions": 1, "deletions": 0}, "files": [{"sha": "e60c9fea34ac8dd7fdeb6fcaf124c37cabec0461", "filename": "libgcc/unwind-dw2-fde-dip.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f50c417a036697eccfad5a1d6ce777246c77635a/libgcc%2Funwind-dw2-fde-dip.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f50c417a036697eccfad5a1d6ce777246c77635a/libgcc%2Funwind-dw2-fde-dip.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgcc%2Funwind-dw2-fde-dip.c?ref=f50c417a036697eccfad5a1d6ce777246c77635a", "patch": "@@ -71,6 +71,7 @@\n #endif\n \n #if !defined(inhibit_libc) && defined(HAVE_LD_EH_FRAME_HDR) \\\n+    && defined(TARGET_DL_ITERATE_PHDR) \\\n     && (defined(__OpenBSD__) || defined(__NetBSD__))\n # define ElfW(type) Elf_##type\n # define USE_PT_GNU_EH_FRAME"}]}