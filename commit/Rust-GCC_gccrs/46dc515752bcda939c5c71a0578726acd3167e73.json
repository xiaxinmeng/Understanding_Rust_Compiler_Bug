{"sha": "46dc515752bcda939c5c71a0578726acd3167e73", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDZkYzUxNTc1MmJjZGE5MzljNWM3MWEwNTc4NzI2YWNkMzE2N2U3Mw==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@yorick.cygnus.com", "date": "1998-05-24T16:21:23Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "1998-05-24T16:21:23Z"}, "message": "old-dejagnu.exp: All tests fail if we got an internal compiler error for the line.\n\n\t* lib/old-dejagnu.exp: All tests fail if we got an internal compiler\n\terror for the line.  Don't run multiple tests for the same line.\n\nFrom-SVN: r20028", "tree": {"sha": "ebbe45e05e8e1a28608163bf2165dddb9c3a9802", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ebbe45e05e8e1a28608163bf2165dddb9c3a9802"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/46dc515752bcda939c5c71a0578726acd3167e73", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/46dc515752bcda939c5c71a0578726acd3167e73", "html_url": "https://github.com/Rust-GCC/gccrs/commit/46dc515752bcda939c5c71a0578726acd3167e73", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/46dc515752bcda939c5c71a0578726acd3167e73/comments", "author": null, "committer": null, "parents": [{"sha": "60f06d2f91a13bec192a76b6665dc441692bf924", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/60f06d2f91a13bec192a76b6665dc441692bf924", "html_url": "https://github.com/Rust-GCC/gccrs/commit/60f06d2f91a13bec192a76b6665dc441692bf924"}], "stats": {"total": 22, "additions": 21, "deletions": 1}, "files": [{"sha": "4a6eb05b504e2cb3783a1aa7bc5358f7346e0d77", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/46dc515752bcda939c5c71a0578726acd3167e73/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/46dc515752bcda939c5c71a0578726acd3167e73/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=46dc515752bcda939c5c71a0578726acd3167e73", "patch": "@@ -1,3 +1,8 @@\n+1998-05-24  Jason Merrill  <jason@yorick.cygnus.com>\n+\n+\t* lib/old-dejagnu.exp: All tests fail if we got an internal compiler\n+\terror for the line.  Don't run multiple tests for the same line.\n+\n Sat May 23 23:27:10 1998  Jeffrey A Law  (law@cygnus.com)\n \n \t* gcc.dg/980523-1.c: New test."}, {"sha": "e029b23e00daf07301c19e7d16b167817bc1cfdb", "filename": "gcc/testsuite/lib/old-dejagnu.exp", "status": "modified", "additions": 16, "deletions": 1, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/46dc515752bcda939c5c71a0578726acd3167e73/gcc%2Ftestsuite%2Flib%2Fold-dejagnu.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/46dc515752bcda939c5c71a0578726acd3167e73/gcc%2Ftestsuite%2Flib%2Fold-dejagnu.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Flib%2Fold-dejagnu.exp?ref=46dc515752bcda939c5c71a0578726acd3167e73", "patch": "@@ -409,6 +409,7 @@ proc old-dejagnu { compiler prog cflagsx default_cflags libs } {\n     #send_user \"\\nold_dejagnu.exp: message = :$message:\\n\\n\"\n     #send_user \"\\nold_dejagnu.exp: message length = [llength $message]\\n\\n\"\n \n+    set last_line 0\n     foreach i $message {\n \n \t#send_user \"\\nold_dejagnu.exp: i = :$i:\\n\\n\"\n@@ -417,7 +418,21 @@ proc old-dejagnu { compiler prog cflagsx default_cflags libs } {\n \t# in the source file.  If we find any, success!\n \tset line [lindex $i 0]\n \tset pattern [lindex $i 2]\n-\tif [regsub -all \"(^|\\n)\\[^\\n\\]+:$line:\\[^\\n\\]*\" $comp_output \"\" comp_output] then {\n+\n+\t# Multiple tests one one line don't work, because we remove all \n+\t# messages on the line for the first test.  So skip later ones.\n+\tif { $line == $last_line } {\n+\t    continue\n+\t}\n+\tset last_line $line\n+\n+\t# If we crashed on this line, all tests fail.\n+\tif [regexp \"(^|\\n)\\[^\\n\\]+:$line: Internal compiler error\\[^\\n\\]*\" $comp_output ] {\n+\t    regsub -all \"(^|\\n)\\[^\\n\\]+:$line:\\[^\\n\\]*\" $comp_output \"\" comp_output\n+            set comp_output [string trimleft $comp_output]\n+\t    set ok fail\n+\t    set uhoh fail\n+\t} elseif [regsub -all \"(^|\\n)\\[^\\n\\]+:$line:\\[^\\n\\]*\" $comp_output \"\" comp_output] {\n             set comp_output [string trimleft $comp_output]\n \t    set ok pass\n \t    set uhoh fail"}]}