{"sha": "6f07a7689284a89d25a6e236193fca0b06f8e82e", "node_id": "C_kwDOANBUbNoAKDZmMDdhNzY4OTI4NGE4OWQyNWE2ZTIzNjE5M2ZjYTBiMDZmOGU4MmU", "commit": {"author": {"name": "Arthur Cohen", "email": "arthur.cohen@embecosm.com", "date": "2022-04-26T12:36:55Z"}, "committer": {"name": "Arthur Cohen", "email": "arthur.cohen@embecosm.com", "date": "2022-04-26T14:18:43Z"}, "message": "mappings: Add mappings for SimplePath{Segment}s", "tree": {"sha": "d96e6b8bddd8921afca5fa3bced3fa8e34486873", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d96e6b8bddd8921afca5fa3bced3fa8e34486873"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6f07a7689284a89d25a6e236193fca0b06f8e82e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6f07a7689284a89d25a6e236193fca0b06f8e82e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6f07a7689284a89d25a6e236193fca0b06f8e82e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6f07a7689284a89d25a6e236193fca0b06f8e82e/comments", "author": {"login": "CohenArthur", "id": 43524065, "node_id": "MDQ6VXNlcjQzNTI0MDY1", "avatar_url": "https://avatars.githubusercontent.com/u/43524065?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CohenArthur", "html_url": "https://github.com/CohenArthur", "followers_url": "https://api.github.com/users/CohenArthur/followers", "following_url": "https://api.github.com/users/CohenArthur/following{/other_user}", "gists_url": "https://api.github.com/users/CohenArthur/gists{/gist_id}", "starred_url": "https://api.github.com/users/CohenArthur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CohenArthur/subscriptions", "organizations_url": "https://api.github.com/users/CohenArthur/orgs", "repos_url": "https://api.github.com/users/CohenArthur/repos", "events_url": "https://api.github.com/users/CohenArthur/events{/privacy}", "received_events_url": "https://api.github.com/users/CohenArthur/received_events", "type": "User", "site_admin": false}, "committer": {"login": "CohenArthur", "id": 43524065, "node_id": "MDQ6VXNlcjQzNTI0MDY1", "avatar_url": "https://avatars.githubusercontent.com/u/43524065?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CohenArthur", "html_url": "https://github.com/CohenArthur", "followers_url": "https://api.github.com/users/CohenArthur/followers", "following_url": "https://api.github.com/users/CohenArthur/following{/other_user}", "gists_url": "https://api.github.com/users/CohenArthur/gists{/gist_id}", "starred_url": "https://api.github.com/users/CohenArthur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CohenArthur/subscriptions", "organizations_url": "https://api.github.com/users/CohenArthur/orgs", "repos_url": "https://api.github.com/users/CohenArthur/repos", "events_url": "https://api.github.com/users/CohenArthur/events{/privacy}", "received_events_url": "https://api.github.com/users/CohenArthur/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ab845217887468b500b624f0837023122002c534", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ab845217887468b500b624f0837023122002c534", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ab845217887468b500b624f0837023122002c534"}], "stats": {"total": 61, "additions": 61, "deletions": 0}, "files": [{"sha": "4062ce7e4e25fc3d79c33e72394ebed803c63fd6", "filename": "gcc/rust/util/rust-hir-map.cc", "status": "modified", "additions": 50, "deletions": 0, "changes": 50, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6f07a7689284a89d25a6e236193fca0b06f8e82e/gcc%2Frust%2Futil%2Frust-hir-map.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6f07a7689284a89d25a6e236193fca0b06f8e82e/gcc%2Frust%2Futil%2Frust-hir-map.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Frust%2Futil%2Frust-hir-map.cc?ref=6f07a7689284a89d25a6e236193fca0b06f8e82e", "patch": "@@ -426,6 +426,56 @@ Mappings::lookup_hir_path_expr_seg (CrateNum crateNum, HirId id)\n   return iy->second;\n }\n \n+void\n+Mappings::insert_simple_path_segment (CrateNum crateNum, HirId id,\n+\t\t\t\t      AST::SimplePathSegment *path)\n+{\n+  rust_assert (lookup_simple_path_segment (crateNum, id) == nullptr);\n+\n+  astSimplePathSegmentMappings[crateNum][id] = path;\n+  nodeIdToHirMappings[crateNum][path->get_node_id ()] = id;\n+  insert_location (crateNum, id, path->get_locus ());\n+}\n+\n+AST::SimplePathSegment *\n+Mappings::lookup_simple_path_segment (CrateNum crateNum, HirId id)\n+{\n+  auto it = astSimplePathSegmentMappings.find (crateNum);\n+  if (it == astSimplePathSegmentMappings.end ())\n+    return nullptr;\n+\n+  auto iy = it->second.find (id);\n+  if (iy == it->second.end ())\n+    return nullptr;\n+\n+  return iy->second;\n+}\n+\n+void\n+Mappings::insert_simple_path (CrateNum crateNum, HirId id,\n+\t\t\t      AST::SimplePath *path)\n+{\n+  rust_assert (lookup_simple_path (crateNum, id) == nullptr);\n+\n+  astSimplePathMappings[crateNum][id] = path;\n+  nodeIdToHirMappings[crateNum][path->get_node_id ()] = id;\n+  insert_location (crateNum, id, path->get_locus ());\n+}\n+\n+AST::SimplePath *\n+Mappings::lookup_simple_path (CrateNum crateNum, HirId id)\n+{\n+  auto it = astSimplePathMappings.find (crateNum);\n+  if (it == astSimplePathMappings.end ())\n+    return nullptr;\n+\n+  auto iy = it->second.find (id);\n+  if (iy == it->second.end ())\n+    return nullptr;\n+\n+  return iy->second;\n+}\n+\n void\n Mappings::insert_hir_generic_param (CrateNum crateNum, HirId id,\n \t\t\t\t    HIR::GenericParam *param)"}, {"sha": "19c2f0aae3882690ac7bcb0f61a8d9e6dee0173b", "filename": "gcc/rust/util/rust-hir-map.h", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6f07a7689284a89d25a6e236193fca0b06f8e82e/gcc%2Frust%2Futil%2Frust-hir-map.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6f07a7689284a89d25a6e236193fca0b06f8e82e/gcc%2Frust%2Futil%2Frust-hir-map.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Frust%2Futil%2Frust-hir-map.h?ref=6f07a7689284a89d25a6e236193fca0b06f8e82e", "patch": "@@ -147,6 +147,14 @@ class Mappings\n \t\t\t\t HIR::PathExprSegment *expr);\n   HIR::PathExprSegment *lookup_hir_path_expr_seg (CrateNum crateNum, HirId id);\n \n+  void insert_simple_path_segment (CrateNum crateNum, HirId id,\n+\t\t\t\t   AST::SimplePathSegment *path);\n+  AST::SimplePathSegment *lookup_simple_path_segment (CrateNum crateNum,\n+\t\t\t\t\t\t      HirId id);\n+\n+  void insert_simple_path (CrateNum crateNum, HirId id, AST::SimplePath *path);\n+  AST::SimplePath *lookup_simple_path (CrateNum crateNum, HirId id);\n+\n   void insert_hir_generic_param (CrateNum crateNum, HirId id,\n \t\t\t\t HIR::GenericParam *expr);\n   HIR::GenericParam *lookup_hir_generic_param (CrateNum crateNum, HirId id);\n@@ -330,6 +338,9 @@ class Mappings\n   std::map<CrateNum, std::map<HirId, HIR::TraitItem *>> hirTraitItemMappings;\n   std::map<CrateNum, std::map<HirId, HIR::ExternalItem *>>\n     hirExternItemMappings;\n+  std::map<CrateNum, std::map<HirId, AST::SimplePath *>> astSimplePathMappings;\n+  std::map<CrateNum, std::map<HirId, AST::SimplePathSegment *>>\n+    astSimplePathSegmentMappings;\n   std::map<CrateNum, std::map<HirId, HIR::PathExprSegment *>>\n     hirPathSegMappings;\n   std::map<CrateNum, std::map<HirId, HIR::GenericParam *>>"}]}