{"sha": "49039169f30099ed84696aadd872653b03ecfde3", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDkwMzkxNjlmMzAwOTllZDg0Njk2YWFkZDg3MjY1M2IwM2VjZmRlMw==", "commit": {"author": {"name": "Edward Smith-Rowland", "email": "3dw4rd@verizon.net", "date": "2014-05-21T00:35:29Z"}, "committer": {"name": "Edward Smith-Rowland", "email": "emsr@gcc.gnu.org", "date": "2014-05-21T00:35:29Z"}, "message": "re PR c++/61038 (g++ -E is unusable with UDL strings)\n\ngcc/testsuite/\n\n2014-05-20  Edward Smith-Rowland  <3dw4rd@verizon.net>\n\n\tPR C++/61038\n\t* g++.dg/cpp0x/pr61038.C: New.\n\nlibcpp/\n\n2014-05-20  Edward Smith-Rowland  <3dw4rd@verizon.net>\n\n\tPR C++/61038\n\t* macro.c (stringify_arg (cpp_reader *, macro_arg *)):\n\tCheck for user-defined literal strings and user-defined literal chars\n\tto escape necessary characters.\n\nFrom-SVN: r210666", "tree": {"sha": "a86ac06d461f5c244039fdc4fc80a89810ffe1a3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a86ac06d461f5c244039fdc4fc80a89810ffe1a3"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/49039169f30099ed84696aadd872653b03ecfde3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/49039169f30099ed84696aadd872653b03ecfde3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/49039169f30099ed84696aadd872653b03ecfde3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/49039169f30099ed84696aadd872653b03ecfde3/comments", "author": {"login": "emsr", "id": 1936479, "node_id": "MDQ6VXNlcjE5MzY0Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1936479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/emsr", "html_url": "https://github.com/emsr", "followers_url": "https://api.github.com/users/emsr/followers", "following_url": "https://api.github.com/users/emsr/following{/other_user}", "gists_url": "https://api.github.com/users/emsr/gists{/gist_id}", "starred_url": "https://api.github.com/users/emsr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/emsr/subscriptions", "organizations_url": "https://api.github.com/users/emsr/orgs", "repos_url": "https://api.github.com/users/emsr/repos", "events_url": "https://api.github.com/users/emsr/events{/privacy}", "received_events_url": "https://api.github.com/users/emsr/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "956dd0932cef3c45b49405d3c64c46fc67da12c2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/956dd0932cef3c45b49405d3c64c46fc67da12c2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/956dd0932cef3c45b49405d3c64c46fc67da12c2"}], "stats": {"total": 55, "additions": 55, "deletions": 0}, "files": [{"sha": "142c9fa08a1d46db15bfa65c353fac9ad5382909", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/49039169f30099ed84696aadd872653b03ecfde3/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/49039169f30099ed84696aadd872653b03ecfde3/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=49039169f30099ed84696aadd872653b03ecfde3", "patch": "@@ -1,3 +1,8 @@\n+2014-05-20  Edward Smith-Rowland  <3dw4rd@verizon.net>\n+\n+\tPR C++/61038\n+\t* g++.dg/cpp0x/pr61038.C: New.\n+\n 2014-05-20  Paolo Carlini  <paolo.carlini@oracle.com>\n \n \tPR c++/58753"}, {"sha": "b773000d359159dd3205ade011bb0b3f1e2d5422", "filename": "gcc/testsuite/g++.dg/cpp0x/pr61038.C", "status": "added", "additions": 40, "deletions": 0, "changes": 40, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/49039169f30099ed84696aadd872653b03ecfde3/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fpr61038.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/49039169f30099ed84696aadd872653b03ecfde3/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fpr61038.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fpr61038.C?ref=49039169f30099ed84696aadd872653b03ecfde3", "patch": "@@ -0,0 +1,40 @@\n+// PR c++/61038\n+// { dg-do compile { target c++11 } }\n+\n+#include <cstring>\n+#include <cstdlib>\n+\n+void\n+operator \"\" _s(const char *, unsigned long)\n+{ }\n+\n+void\n+operator \"\" _t(const char)\n+{ }\n+\n+#define QUOTE(s) #s\n+#define QQUOTE(s) QUOTE(s)\n+\n+int\n+main()\n+{\n+  const char *s = QQUOTE(QUOTE(\"hello\"_s));\n+  const char *t = QUOTE(\"\\\"hello\\\"_s\");\n+  if (strcmp(s, t) != 0)\n+    abort();\n+\n+  const char *c = QQUOTE(QUOTE('\"'_t));\n+  const char *d = QUOTE(\"'\\\"'_t\");\n+  if (strcmp(c, d) != 0)\n+    abort();\n+\n+  const char *e = QQUOTE(QUOTE('\\''_t));\n+  const char *f = QUOTE(\"'\\\\''_t\");\n+  if (strcmp(e, f) != 0)\n+    abort();\n+\n+  const char *g = QQUOTE(QUOTE('\\\\'_t));\n+  const char *h = QUOTE(\"'\\\\\\\\'_t\");\n+  if (strcmp(g, h) != 0)\n+    abort();\n+}"}, {"sha": "bb44d3ce5b3229d11f699d0a3b276e7e24568f2e", "filename": "libcpp/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/49039169f30099ed84696aadd872653b03ecfde3/libcpp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/49039169f30099ed84696aadd872653b03ecfde3/libcpp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libcpp%2FChangeLog?ref=49039169f30099ed84696aadd872653b03ecfde3", "patch": "@@ -1,3 +1,10 @@\n+2014-05-20  Edward Smith-Rowland  <3dw4rd@verizon.net>\n+\n+\tPR C++/61038\n+\t* macro.c (stringify_arg (cpp_reader *, macro_arg *)):\n+\tCheck for user-defined literal strings and user-defined literal chars\n+\tto escape necessary characters.\n+\n 2014-05-20  Richard Biener  <rguenther@suse.de>\n \n \t* configure.ac: Copy gcc logic of detecting a 64bit type."}, {"sha": "c3db9a277a34789633a2a34a4097ee27f332a66f", "filename": "libcpp/macro.c", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/49039169f30099ed84696aadd872653b03ecfde3/libcpp%2Fmacro.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/49039169f30099ed84696aadd872653b03ecfde3/libcpp%2Fmacro.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libcpp%2Fmacro.c?ref=49039169f30099ed84696aadd872653b03ecfde3", "patch": "@@ -494,6 +494,9 @@ stringify_arg (cpp_reader *pfile, macro_arg *arg)\n \t\t   || token->type == CPP_STRING16 || token->type == CPP_CHAR16\n \t\t   || token->type == CPP_UTF8STRING);\n \n+      escape_it = escape_it || cpp_userdef_string_p (token->type)\n+\t\t\t    || cpp_userdef_char_p (token->type);\n+\n       /* Room for each char being written in octal, initial space and\n \t final quote and NUL.  */\n       len = cpp_token_len (token);"}]}