{"sha": "165b39415786da06b03b0c802b1d7b1eff826d67", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTY1YjM5NDE1Nzg2ZGEwNmIwM2IwYzgwMmIxZDdiMWVmZjgyNmQ2Nw==", "commit": {"author": {"name": "Richard Stallman", "email": "rms@gnu.org", "date": "1992-08-01T18:11:28Z"}, "committer": {"name": "Richard Stallman", "email": "rms@gnu.org", "date": "1992-08-01T18:11:28Z"}, "message": "Find the links to directories by finding each link and testing it with test.\n\nFrom-SVN: r1740", "tree": {"sha": "58bd21f74aac8f9aaa31fe04e53b2f3429619a4a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/58bd21f74aac8f9aaa31fe04e53b2f3429619a4a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/165b39415786da06b03b0c802b1d7b1eff826d67", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/165b39415786da06b03b0c802b1d7b1eff826d67", "html_url": "https://github.com/Rust-GCC/gccrs/commit/165b39415786da06b03b0c802b1d7b1eff826d67", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/165b39415786da06b03b0c802b1d7b1eff826d67/comments", "author": null, "committer": null, "parents": [{"sha": "e2301a83da536afd6b5d82b748019dd48d9cabc7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e2301a83da536afd6b5d82b748019dd48d9cabc7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e2301a83da536afd6b5d82b748019dd48d9cabc7"}], "stats": {"total": 19, "additions": 17, "deletions": 2}, "files": [{"sha": "8de664e87e31a2ed3114951ae366b0b4cba756fe", "filename": "gcc/fixincludes", "status": "modified", "additions": 17, "deletions": 2, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/165b39415786da06b03b0c802b1d7b1eff826d67/gcc%2Ffixincludes", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/165b39415786da06b03b0c802b1d7b1eff826d67/gcc%2Ffixincludes", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffixincludes?ref=165b39415786da06b03b0c802b1d7b1eff826d67", "patch": "@@ -68,9 +68,24 @@ do\n \tfi\n \n \t# Find all directories under $d, relative to $d, excluding $d itself.\n-        files=\"$files `find $d -type d -print | sed '|/\\.$|d'`\"\n+        files=\"$files `find $d -type d -print | \\\n+\t\t       sed -e '/\\/\\.$/d' -e '/^\\.$/d'`\"\n+\t# Find all links to directories.\n+\t# Using `-exec test -d' in find fails on some systems,\n+\t# and trying to run test via sh fails on others,\n+\t# so this is the simplest alternative left.\n+\t# First find all the links, then test each one.\n+\ttheselinks=\n \t$LINKS && \\\n-\t  newdirs=\"$newdirs `find $d -type l -exec test -d '{}' \\; -print`\"\n+\t  theselinks=`find $d -type l -print`\n+\tfor d1 in $theselinks --dummy--\n+\tdo\n+\t    # If it is a directory, add it to $newdirs\n+\t    if [ -d $d1 ]\n+\t    then\n+\t\tnewdirs=\"$newdirs $d1\"\n+\t    fi\n+\tdone\n     done\n \n     files=\"$files $newdirs\""}]}