{"sha": "8c44fc0f2305f051c9631b4ab3f46417bfe0d644", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OGM0NGZjMGYyMzA1ZjA1MWM5NjMxYjRhYjNmNDY0MTdiZmUwZDY0NA==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2014-10-27T11:19:41Z"}, "committer": {"name": "Eric Botcazou", "email": "ebotcazou@gcc.gnu.org", "date": "2014-10-27T11:19:41Z"}, "message": "decl.c (gnat_to_gnu_entity): Apply special treatment of derived packed array types to constrained subtypes only.\n\n\t* gcc-interface/decl.c (gnat_to_gnu_entity): Apply special treatment\n\tof derived packed array types to constrained subtypes only.\n\nFrom-SVN: r216727", "tree": {"sha": "96a95cb33de3391c4a2f50123941d5368fe48d07", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/96a95cb33de3391c4a2f50123941d5368fe48d07"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8c44fc0f2305f051c9631b4ab3f46417bfe0d644", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8c44fc0f2305f051c9631b4ab3f46417bfe0d644", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8c44fc0f2305f051c9631b4ab3f46417bfe0d644", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8c44fc0f2305f051c9631b4ab3f46417bfe0d644/comments", "author": null, "committer": null, "parents": [{"sha": "33ccc5363ec5994c39048b1aa18e6ae6e35aa2a9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/33ccc5363ec5994c39048b1aa18e6ae6e35aa2a9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/33ccc5363ec5994c39048b1aa18e6ae6e35aa2a9"}], "stats": {"total": 42, "additions": 41, "deletions": 1}, "files": [{"sha": "f8bcb2e97ea223a33025fb5ba098864fb638e580", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8c44fc0f2305f051c9631b4ab3f46417bfe0d644/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8c44fc0f2305f051c9631b4ab3f46417bfe0d644/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=8c44fc0f2305f051c9631b4ab3f46417bfe0d644", "patch": "@@ -1,3 +1,8 @@\n+2014-10-27  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* gcc-interface/decl.c (gnat_to_gnu_entity): Apply special treatment\n+\tof derived packed array types to constrained subtypes only.\n+\n 2014-10-27  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* gcc-interface/decl.c (gnat_to_gnu_entity) <E_Array_Type>: Remove"}, {"sha": "626f09a7b6934d41959a99f7cf431b72aadeb471", "filename": "gcc/ada/gcc-interface/decl.c", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8c44fc0f2305f051c9631b4ab3f46417bfe0d644/gcc%2Fada%2Fgcc-interface%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8c44fc0f2305f051c9631b4ab3f46417bfe0d644/gcc%2Fada%2Fgcc-interface%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgcc-interface%2Fdecl.c?ref=8c44fc0f2305f051c9631b4ab3f46417bfe0d644", "patch": "@@ -5083,8 +5083,10 @@ gnat_to_gnu_entity (Entity_Id gnat_entity, tree gnu_expr, int definition)\n       if (Is_Derived_Type (gnat_entity) && !type_annotate_only)\n \t{\n \t  Entity_Id gnat_parent_type = Underlying_Type (Etype (gnat_entity));\n-\t  /* For packed array subtypes, the implementation type is used.  */\n+\t  /* For constrained packed array subtypes, the implementation type is\n+\t     used instead of the nominal type.  */\n \t  if (kind == E_Array_Subtype\n+\t      && Is_Constrained (gnat_entity)\n \t      && Present (Packed_Array_Impl_Type (gnat_parent_type)))\n \t    gnat_parent_type = Packed_Array_Impl_Type (gnat_parent_type);\n \t  relate_alias_sets (gnu_type, gnat_to_gnu_type (gnat_parent_type),"}, {"sha": "a6e6d03025828199f459555c9647fa08e3de84eb", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8c44fc0f2305f051c9631b4ab3f46417bfe0d644/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8c44fc0f2305f051c9631b4ab3f46417bfe0d644/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=8c44fc0f2305f051c9631b4ab3f46417bfe0d644", "patch": "@@ -1,3 +1,8 @@\n+2014-10-27  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* gnat.dg/specs/pack10.ads: New test.\n+\t* gnat.dg/specs/pack10_pkg.ad[sb]: New helper.\n+\n 2014-10-27  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* gnat.dg/entry_queues2.adb: New test."}, {"sha": "0138e09775ec732f7e65345b072aa95b3efc1079", "filename": "gcc/testsuite/gnat.dg/specs/pack10.ads", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8c44fc0f2305f051c9631b4ab3f46417bfe0d644/gcc%2Ftestsuite%2Fgnat.dg%2Fspecs%2Fpack10.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8c44fc0f2305f051c9631b4ab3f46417bfe0d644/gcc%2Ftestsuite%2Fgnat.dg%2Fspecs%2Fpack10.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fspecs%2Fpack10.ads?ref=8c44fc0f2305f051c9631b4ab3f46417bfe0d644", "patch": "@@ -0,0 +1,14 @@\n+-- { dg-do compile }\n+\n+with Pack10_Pkg; use Pack10_Pkg;\n+\n+package Pack10 is\n+\n+   type Boolean_Vector is array (Positive range <>) of Boolean;\n+\n+   type Packed_Boolean_Vector is new Boolean_Vector;\n+   pragma Pack (Packed_Boolean_Vector);\n+\n+   procedure My_Proc is new Proc (Packed_Boolean_Vector);\n+\n+end Pack10;"}, {"sha": "af81776544af05294926fdd540f50408d66fd3f5", "filename": "gcc/testsuite/gnat.dg/specs/pack10_pkg.adb", "status": "added", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8c44fc0f2305f051c9631b4ab3f46417bfe0d644/gcc%2Ftestsuite%2Fgnat.dg%2Fspecs%2Fpack10_pkg.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8c44fc0f2305f051c9631b4ab3f46417bfe0d644/gcc%2Ftestsuite%2Fgnat.dg%2Fspecs%2Fpack10_pkg.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fspecs%2Fpack10_pkg.adb?ref=8c44fc0f2305f051c9631b4ab3f46417bfe0d644", "patch": "@@ -0,0 +1,5 @@\n+package body Pack10_Pkg is\n+\n+   procedure Proc is begin null; end;\n+\n+end Pack10_Pkg;"}, {"sha": "76d99fbbf37bc4ec30c2dee01b7441f202f01a7f", "filename": "gcc/testsuite/gnat.dg/specs/pack10_pkg.ads", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8c44fc0f2305f051c9631b4ab3f46417bfe0d644/gcc%2Ftestsuite%2Fgnat.dg%2Fspecs%2Fpack10_pkg.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8c44fc0f2305f051c9631b4ab3f46417bfe0d644/gcc%2Ftestsuite%2Fgnat.dg%2Fspecs%2Fpack10_pkg.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fspecs%2Fpack10_pkg.ads?ref=8c44fc0f2305f051c9631b4ab3f46417bfe0d644", "patch": "@@ -0,0 +1,9 @@\n+-- { dg-excess-errors \"cannot generate code\" }\n+\n+package Pack10_Pkg is\n+\n+   generic\n+      type Vector_Type (<>) is private;\n+   procedure Proc;\n+\n+end Pack10_Pkg;"}]}