{"sha": "e30d07de5c89e0f8a4d8304846e21f8e775c9f79", "node_id": "C_kwDOANBUbNoAKGUzMGQwN2RlNWM4OWUwZjhhNGQ4MzA0ODQ2ZTIxZjhlNzc1YzlmNzk", "commit": {"author": {"name": "Arthur Cohen", "email": "arthur.cohen@embecosm.com", "date": "2022-03-17T10:40:42Z"}, "committer": {"name": "Arthur Cohen", "email": "arthur.cohen@embecosm.com", "date": "2022-03-17T12:29:38Z"}, "message": "parser: Handle -fsyntax-only properly\n\nHandle the -fsyntax-only properly from the rust frontend. This flag\nallows checking for syntax and stopping after that, skipping further\npasses of the pipeline.\nThe flag was accepted by the frontend, but was not used anywhere.\n\nCo-authored-by: philberty <philip.herron@embecosm.com>", "tree": {"sha": "b55340fd2dffcb1f21940cf049b11abfd3d77c8b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b55340fd2dffcb1f21940cf049b11abfd3d77c8b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e30d07de5c89e0f8a4d8304846e21f8e775c9f79", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e30d07de5c89e0f8a4d8304846e21f8e775c9f79", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e30d07de5c89e0f8a4d8304846e21f8e775c9f79", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e30d07de5c89e0f8a4d8304846e21f8e775c9f79/comments", "author": {"login": "CohenArthur", "id": 43524065, "node_id": "MDQ6VXNlcjQzNTI0MDY1", "avatar_url": "https://avatars.githubusercontent.com/u/43524065?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CohenArthur", "html_url": "https://github.com/CohenArthur", "followers_url": "https://api.github.com/users/CohenArthur/followers", "following_url": "https://api.github.com/users/CohenArthur/following{/other_user}", "gists_url": "https://api.github.com/users/CohenArthur/gists{/gist_id}", "starred_url": "https://api.github.com/users/CohenArthur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CohenArthur/subscriptions", "organizations_url": "https://api.github.com/users/CohenArthur/orgs", "repos_url": "https://api.github.com/users/CohenArthur/repos", "events_url": "https://api.github.com/users/CohenArthur/events{/privacy}", "received_events_url": "https://api.github.com/users/CohenArthur/received_events", "type": "User", "site_admin": false}, "committer": {"login": "CohenArthur", "id": 43524065, "node_id": "MDQ6VXNlcjQzNTI0MDY1", "avatar_url": "https://avatars.githubusercontent.com/u/43524065?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CohenArthur", "html_url": "https://github.com/CohenArthur", "followers_url": "https://api.github.com/users/CohenArthur/followers", "following_url": "https://api.github.com/users/CohenArthur/following{/other_user}", "gists_url": "https://api.github.com/users/CohenArthur/gists{/gist_id}", "starred_url": "https://api.github.com/users/CohenArthur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CohenArthur/subscriptions", "organizations_url": "https://api.github.com/users/CohenArthur/orgs", "repos_url": "https://api.github.com/users/CohenArthur/repos", "events_url": "https://api.github.com/users/CohenArthur/events{/privacy}", "received_events_url": "https://api.github.com/users/CohenArthur/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2dfc19647774cb26a0f735bda8006068a40cfba0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2dfc19647774cb26a0f735bda8006068a40cfba0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2dfc19647774cb26a0f735bda8006068a40cfba0"}], "stats": {"total": 11, "additions": 11, "deletions": 0}, "files": [{"sha": "96d94b2fbb2f0939a9ed4c1c44a3a201e94deb80", "filename": "gcc/rust/rust-session-manager.cc", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e30d07de5c89e0f8a4d8304846e21f8e775c9f79/gcc%2Frust%2Frust-session-manager.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e30d07de5c89e0f8a4d8304846e21f8e775c9f79/gcc%2Frust%2Frust-session-manager.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Frust%2Frust-session-manager.cc?ref=e30d07de5c89e0f8a4d8304846e21f8e775c9f79", "patch": "@@ -542,6 +542,11 @@ Session::parse_file (const char *filename)\n \n   rust_debug (\"\\033[0;31mSUCCESSFULLY PARSED CRATE \\033[0m\");\n \n+  // If -fsyntax-only was passed, we can just skip the remaining passes.\n+  // Parsing errors are already emitted in `parse_crate()`\n+  if (flag_syntax_only)\n+    return;\n+\n   // register plugins pipeline stage\n   register_plugins (parsed_crate);\n   rust_debug (\"\\033[0;31mSUCCESSFULLY REGISTERED PLUGINS \\033[0m\");"}, {"sha": "cd84907bf842439b652f8479e4aa6a3c7456b0e8", "filename": "gcc/testsuite/rust/compile/syntax-only.rs", "status": "added", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e30d07de5c89e0f8a4d8304846e21f8e775c9f79/gcc%2Ftestsuite%2Frust%2Fcompile%2Fsyntax-only.rs", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e30d07de5c89e0f8a4d8304846e21f8e775c9f79/gcc%2Ftestsuite%2Frust%2Fcompile%2Fsyntax-only.rs", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Frust%2Fcompile%2Fsyntax-only.rs?ref=e30d07de5c89e0f8a4d8304846e21f8e775c9f79", "patch": "@@ -0,0 +1,6 @@\n+// { dg-additional-options \"-fsyntax-only\" }\n+\n+fn main() {\n+    let mut a = 15;\n+    a = true;\n+}"}]}