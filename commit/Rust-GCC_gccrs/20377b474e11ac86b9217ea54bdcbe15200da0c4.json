{"sha": "20377b474e11ac86b9217ea54bdcbe15200da0c4", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjAzNzdiNDc0ZTExYWM4NmI5MjE3ZWE1NGJkY2JlMTUyMDBkYTBjNA==", "commit": {"author": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2008-12-18T13:49:47Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2008-12-18T13:49:47Z"}, "message": "ira-cost.c (copy_cost): Lazilly initialize move_cost if needed.\n\n\t* ira-cost.c (copy_cost): Lazilly initialize move_cost if needed.\n\nCo-Authored-By: Kai Tietz <kai.tietz@onevision.com>\n\nFrom-SVN: r142811", "tree": {"sha": "c329bd49e22904b85730c8f4832ce3aa478c46bb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c329bd49e22904b85730c8f4832ce3aa478c46bb"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/20377b474e11ac86b9217ea54bdcbe15200da0c4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/20377b474e11ac86b9217ea54bdcbe15200da0c4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/20377b474e11ac86b9217ea54bdcbe15200da0c4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/20377b474e11ac86b9217ea54bdcbe15200da0c4/comments", "author": null, "committer": null, "parents": [{"sha": "877a0b76e1f1b0efde5b7e9fe8c88b62b8abdc83", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/877a0b76e1f1b0efde5b7e9fe8c88b62b8abdc83", "html_url": "https://github.com/Rust-GCC/gccrs/commit/877a0b76e1f1b0efde5b7e9fe8c88b62b8abdc83"}], "stats": {"total": 20, "additions": 16, "deletions": 4}, "files": [{"sha": "8c10d1a789b049c6e03379d4cb7ad24f90a40541", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/20377b474e11ac86b9217ea54bdcbe15200da0c4/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/20377b474e11ac86b9217ea54bdcbe15200da0c4/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=20377b474e11ac86b9217ea54bdcbe15200da0c4", "patch": "@@ -1,3 +1,8 @@\n+2008-12-18  Jan Hubicka  <jh@suse.cz>\n+\t    Kai Tietz <kai.tietz@onevision.com>\n+\n+\t* ira-cost.c (copy_cost): Lazilly initialize move_cost if needed.\n+\n 2008-12-18  Jan Hubicka  <jh@suse.cz>\n \t    Kai Tietz <kai.tietz@onevision.com>\n "}, {"sha": "397affd4b1fd71955ef6828f2eb15cffeb40a516", "filename": "gcc/ira-costs.c", "status": "modified", "additions": 11, "deletions": 4, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/20377b474e11ac86b9217ea54bdcbe15200da0c4/gcc%2Fira-costs.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/20377b474e11ac86b9217ea54bdcbe15200da0c4/gcc%2Fira-costs.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fira-costs.c?ref=20377b474e11ac86b9217ea54bdcbe15200da0c4", "patch": "@@ -142,17 +142,24 @@ copy_cost (rtx x, enum machine_mode mode, enum reg_class rclass, bool to_p,\n     ira_init_register_move_cost (mode);\n \n   if (secondary_class != NO_REGS)\n-    return (move_cost[mode][secondary_class][rclass] + sri.extra_cost\n-\t    + copy_cost (x, mode, secondary_class, to_p, &sri));\n+    {\n+      if (!move_cost[mode])\n+        init_move_cost (mode);\n+      return (move_cost[mode][secondary_class][rclass] + sri.extra_cost\n+\t      + copy_cost (x, mode, secondary_class, to_p, &sri));\n+    }\n \n   /* For memory, use the memory move cost, for (hard) registers, use\n      the cost to move between the register classes, and use 2 for\n      everything else (constants).  */\n   if (MEM_P (x) || rclass == NO_REGS)\n     return sri.extra_cost + ira_memory_move_cost[mode][rclass][to_p != 0];\n   else if (REG_P (x))\n-    return\n-      (sri.extra_cost + move_cost[mode][REGNO_REG_CLASS (REGNO (x))][rclass]);\n+    {\n+      if (!move_cost[mode])\n+        init_move_cost (mode);\n+      return (sri.extra_cost + move_cost[mode][REGNO_REG_CLASS (REGNO (x))][rclass]);\n+    }\n   else\n     /* If this is a constant, we may eventually want to call rtx_cost\n        here.  */"}]}