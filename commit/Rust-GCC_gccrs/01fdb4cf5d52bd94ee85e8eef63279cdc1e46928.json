{"sha": "01fdb4cf5d52bd94ee85e8eef63279cdc1e46928", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDFmZGI0Y2Y1ZDUyYmQ5NGVlODVlOGVlZjYzMjc5Y2RjMWU0NjkyOA==", "commit": {"author": {"name": "David Daney", "email": "ddaney@avtrex.com", "date": "2007-09-26T16:45:39Z"}, "committer": {"name": "David Daney", "email": "daney@gcc.gnu.org", "date": "2007-09-26T16:45:39Z"}, "message": "re PR target/33479 (SyncTest Intermittent failing on MIPS)\n\n2007-09-26  David Daney  <ddaney@avtrex.com>\n\n\tPR target/33479\n\t* config/mips/mips.md (sync_compare_and_swap<mode>, sync_old_add<mode>,\n\tsync_new_add<mode>, sync_old_<optab><mode>, sync_new_<optab><mode>,\n\tsync_old_nand<mode>, sync_new_nand<mode>,\n\tsync_lock_test_and_set<mode>): Fix '&' constraint modifiers.\n\tUpdate length attributes.\n\t(sync_add<mode>, sync_sub<mode>, sync_old_sub<mode>,\n\tsync_new_sub<mode>, sync_<optab><mode>, sync_nand<mode>): Update\n\tlength attributes.\n\t* config/mips/mips.h (MIPS_COMPARE_AND_SWAP, MIPS_SYNC_OP,\n\tMIPS_SYNC_OLD_OP, MIPS_SYNC_NEW_OP, MIPS_SYNC_NAND,\n\tMIPS_SYNC_OLD_NAND, MIPS_SYNC_NEW_NAND, MIPS_SYNC_EXCHANGE): Add\n\tpost-loop sync.\n\nFrom-SVN: r128821", "tree": {"sha": "7a23b6594e044fe0df624162614d444065db1ede", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7a23b6594e044fe0df624162614d444065db1ede"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/01fdb4cf5d52bd94ee85e8eef63279cdc1e46928", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/01fdb4cf5d52bd94ee85e8eef63279cdc1e46928", "html_url": "https://github.com/Rust-GCC/gccrs/commit/01fdb4cf5d52bd94ee85e8eef63279cdc1e46928", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/01fdb4cf5d52bd94ee85e8eef63279cdc1e46928/comments", "author": null, "committer": null, "parents": [{"sha": "e2e79a188a4aa19a783c3df89aa9cbd6444777c3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e2e79a188a4aa19a783c3df89aa9cbd6444777c3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e2e79a188a4aa19a783c3df89aa9cbd6444777c3"}], "stats": {"total": 101, "additions": 58, "deletions": 43}, "files": [{"sha": "2147dedb02be6989024a94d60471f58c6241b6e0", "filename": "gcc/ChangeLog", "status": "modified", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/01fdb4cf5d52bd94ee85e8eef63279cdc1e46928/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/01fdb4cf5d52bd94ee85e8eef63279cdc1e46928/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=01fdb4cf5d52bd94ee85e8eef63279cdc1e46928", "patch": "@@ -1,3 +1,19 @@\n+2007-09-26  David Daney  <ddaney@avtrex.com>\n+\n+\tPR target/33479\n+\t* config/mips/mips.md (sync_compare_and_swap<mode>, sync_old_add<mode>,\n+\tsync_new_add<mode>, sync_old_<optab><mode>, sync_new_<optab><mode>,\n+\tsync_old_nand<mode>, sync_new_nand<mode>,\n+\tsync_lock_test_and_set<mode>): Fix '&' constraint modifiers.\n+\tUpdate length attributes.\n+\t(sync_add<mode>, sync_sub<mode>, sync_old_sub<mode>,\n+\tsync_new_sub<mode>, sync_<optab><mode>, sync_nand<mode>): Update\n+\tlength attributes.\n+\t* config/mips/mips.h (MIPS_COMPARE_AND_SWAP, MIPS_SYNC_OP,\n+\tMIPS_SYNC_OLD_OP, MIPS_SYNC_NEW_OP, MIPS_SYNC_NAND,\n+\tMIPS_SYNC_OLD_NAND, MIPS_SYNC_NEW_NAND, MIPS_SYNC_EXCHANGE): Add\n+\tpost-loop sync.\n+\n 2007-09-26  Richard Guenther  <rguenther@suse.de>\n \n \tPR tree-optimization/33563"}, {"sha": "01d851d7f93bbfc32c82725ea5a5f60d5b31d232", "filename": "gcc/config/mips/mips.h", "status": "modified", "additions": 20, "deletions": 21, "changes": 41, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/01fdb4cf5d52bd94ee85e8eef63279cdc1e46928/gcc%2Fconfig%2Fmips%2Fmips.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/01fdb4cf5d52bd94ee85e8eef63279cdc1e46928/gcc%2Fconfig%2Fmips%2Fmips.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.h?ref=01fdb4cf5d52bd94ee85e8eef63279cdc1e46928", "patch": "@@ -2952,11 +2952,10 @@ while (0)\n   \"1:\\tll\" SUFFIX \"\\t%0,%1\\n\"\t\t\t\\\n   \"\\tbne\\t%0,%2,2f\\n\"\t\t\t\t\\\n   \"\\t\" OP \"\\t%@,%3\\n\"\t\t\t\t\\\n-  \"\\tsc\" SUFFIX \"\\t%@,%1\"\t\t\t\\\n-  \"%-\\n\"\t\t\t\t\t\\\n+  \"\\tsc\" SUFFIX \"\\t%@,%1\\n\"\t\t\t\\\n   \"\\tbeq\\t%@,%.,1b\\n\"\t\t\t\t\\\n   \"\\tnop\\n\"\t\t\t\t\t\\\n-  \"2:%]%>%)\"\n+  \"2:\\tsync%-%]%>%)\"\n \n /* Return an asm string that atomically:\n \n@@ -2968,10 +2967,10 @@ while (0)\n   \"%(%<%[%|sync\\n\"\t\t\t\t\\\n   \"1:\\tll\" SUFFIX \"\\t%@,%0\\n\"\t\t\t\\\n   \"\\t\" INSN \"\\t%@,%@,%1\\n\"\t\t\t\\\n-  \"\\tsc\" SUFFIX \"\\t%@,%0\"\t\t\t\\\n-  \"%-\\n\"\t\t\t\t\t\\\n+  \"\\tsc\" SUFFIX \"\\t%@,%0\\n\"\t\t\t\\\n   \"\\tbeq\\t%@,%.,1b\\n\"\t\t\t\t\\\n-  \"\\tnop%]%>%)\"\n+  \"\\tnop\\n\"\t\t\t\t\t\\\n+  \"\\tsync%-%]%>%)\"\n \n /* Return an asm string that atomically:\n \n@@ -2985,10 +2984,10 @@ while (0)\n   \"%(%<%[%|sync\\n\"\t\t\t\t\\\n   \"1:\\tll\" SUFFIX \"\\t%0,%1\\n\"\t\t\t\\\n   \"\\t\" INSN \"\\t%@,%0,%2\\n\"\t\t\t\\\n-  \"\\tsc\" SUFFIX \"\\t%@,%1\"\t\t\t\\\n-  \"%-\\n\"\t\t\t\t\t\\\n+  \"\\tsc\" SUFFIX \"\\t%@,%1\\n\"\t\t\t\\\n   \"\\tbeq\\t%@,%.,1b\\n\"\t\t\t\t\\\n-  \"\\tnop%]%>%)\"\n+  \"\\tnop\\n\"\t\t\t\t\t\\\n+  \"\\tsync%-%]%>%)\"\n \n /* Return an asm string that atomically:\n \n@@ -3002,10 +3001,10 @@ while (0)\n   \"%(%<%[%|sync\\n\"\t\t\t\t\\\n   \"1:\\tll\" SUFFIX \"\\t%0,%1\\n\"\t\t\t\\\n   \"\\t\" INSN \"\\t%@,%0,%2\\n\"\t\t\t\\\n-  \"\\tsc\" SUFFIX \"\\t%@,%1\"\t\t\t\\\n-  \"%-\\n\"\t\t\t\t\t\\\n+  \"\\tsc\" SUFFIX \"\\t%@,%1\\n\"\t\t\t\\\n   \"\\tbeq\\t%@,%.,1b\\n\"\t\t\t\t\\\n-  \"\\t\" INSN \"\\t%0,%0,%2%]%>%)\"\n+  \"\\t\" INSN \"\\t%0,%0,%2\\n\"\t\t\t\\\n+  \"\\tsync%-%]%>%)\"\n \n /* Return an asm string that atomically:\n \n@@ -3019,10 +3018,10 @@ while (0)\n   \"1:\\tll\" SUFFIX \"\\t%@,%0\\n\"\t\t\t\\\n   \"\\tnor\\t%@,%@,%.\\n\"\t\t\t\t\\\n   \"\\t\" INSN \"\\t%@,%@,%1\\n\"\t\t\t\\\n-  \"\\tsc\" SUFFIX \"\\t%@,%0\"\t\t\t\\\n-  \"%-\\n\"\t\t\t\t\t\\\n+  \"\\tsc\" SUFFIX \"\\t%@,%0\\n\"\t\t\t\\\n   \"\\tbeq\\t%@,%.,1b\\n\"\t\t\t\t\\\n-  \"\\tnop%]%>%)\"\n+  \"\\tnop\\n\"\t\t\t\t\t\\\n+  \"\\tsync%-%]%>%)\"\n \n /* Return an asm string that atomically:\n \n@@ -3038,10 +3037,10 @@ while (0)\n   \"1:\\tll\" SUFFIX \"\\t%0,%1\\n\"\t\t\t\\\n   \"\\tnor\\t%@,%0,%.\\n\"\t\t\t\t\\\n   \"\\t\" INSN \"\\t%@,%@,%2\\n\"\t\t\t\\\n-  \"\\tsc\" SUFFIX \"\\t%@,%1\"\t\t\t\\\n-  \"%-\\n\"\t\t\t\t\t\\\n+  \"\\tsc\" SUFFIX \"\\t%@,%1\\n\"\t\t\t\\\n   \"\\tbeq\\t%@,%.,1b\\n\"\t\t\t\t\\\n-  \"\\tnop%]%>%)\"\n+  \"\\tnop\\n\"\t\t\t\t\t\\\n+  \"\\tsync%-%]%>%)\"\n \n /* Return an asm string that atomically:\n \n@@ -3057,10 +3056,10 @@ while (0)\n   \"1:\\tll\" SUFFIX \"\\t%0,%1\\n\"\t\t\t\\\n   \"\\tnor\\t%0,%0,%.\\n\"\t\t\t\t\\\n   \"\\t\" INSN \"\\t%@,%0,%2\\n\"\t\t\t\\\n-  \"\\tsc\" SUFFIX \"\\t%@,%1\"\t\t\t\\\n-  \"%-\\n\"\t\t\t\t\t\\\n+  \"\\tsc\" SUFFIX \"\\t%@,%1\\n\"\t\t\t\\\n   \"\\tbeq\\t%@,%.,1b\\n\"\t\t\t\t\\\n-  \"\\t\" INSN \"\\t%0,%0,%2%]%>%)\"\n+  \"\\t\" INSN \"\\t%0,%0,%2\\n\"\t\t\t\\\n+  \"\\tsync%-%]%>%)\"\n \n /* Return an asm string that atomically:\n "}, {"sha": "d687223c382fbcb0709a49ca7bdc1729d2caae8e", "filename": "gcc/config/mips/mips.md", "status": "modified", "additions": 22, "deletions": 22, "changes": 44, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/01fdb4cf5d52bd94ee85e8eef63279cdc1e46928/gcc%2Fconfig%2Fmips%2Fmips.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/01fdb4cf5d52bd94ee85e8eef63279cdc1e46928/gcc%2Fconfig%2Fmips%2Fmips.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.md?ref=01fdb4cf5d52bd94ee85e8eef63279cdc1e46928", "patch": "@@ -4328,7 +4328,7 @@\n   \"%|sync%-\")\n \n (define_insn \"sync_compare_and_swap<mode>\"\n-  [(set (match_operand:GPR 0 \"register_operand\" \"=&d,d\")\n+  [(set (match_operand:GPR 0 \"register_operand\" \"=&d,&d\")\n \t(match_operand:GPR 1 \"memory_operand\" \"+R,R\"))\n    (set (match_dup 1)\n \t(unspec_volatile:GPR [(match_operand:GPR 2 \"register_operand\" \"d,d\")\n@@ -4341,7 +4341,7 @@\n   else\n     return MIPS_COMPARE_AND_SWAP (\"<d>\", \"move\");\n }\n-  [(set_attr \"length\" \"28\")])\n+  [(set_attr \"length\" \"32\")])\n \n (define_insn \"sync_add<mode>\"\n   [(set (match_operand:GPR 0 \"memory_operand\" \"+R,R\")\n@@ -4356,7 +4356,7 @@\n   else\n     return MIPS_SYNC_OP (\"<d>\", \"<d>addu\");\t\n }\n-  [(set_attr \"length\" \"24\")])\n+  [(set_attr \"length\" \"28\")])\n \n (define_insn \"sync_sub<mode>\"\n   [(set (match_operand:GPR 0 \"memory_operand\" \"+R\")\n@@ -4366,12 +4366,12 @@\n \t UNSPEC_SYNC_OLD_OP))]\n   \"GENERATE_LL_SC\"\n {\n-    return MIPS_SYNC_OP (\"<d>\", \"<d>subu\");\t\n+  return MIPS_SYNC_OP (\"<d>\", \"<d>subu\");\t\n }\n-  [(set_attr \"length\" \"24\")])\n+  [(set_attr \"length\" \"28\")])\n \n (define_insn \"sync_old_add<mode>\"\n-  [(set (match_operand:GPR 0 \"register_operand\" \"=&d,d\")\n+  [(set (match_operand:GPR 0 \"register_operand\" \"=d,&d\")\n \t(match_operand:GPR 1 \"memory_operand\" \"+R,R\"))\n    (set (match_dup 1)\n \t(unspec_volatile:GPR\n@@ -4385,7 +4385,7 @@\n   else\n     return MIPS_SYNC_OLD_OP (\"<d>\", \"<d>addu\");\t\n }\n-  [(set_attr \"length\" \"24\")])\n+  [(set_attr \"length\" \"28\")])\n \n (define_insn \"sync_old_sub<mode>\"\n   [(set (match_operand:GPR 0 \"register_operand\" \"=&d\")\n@@ -4399,10 +4399,10 @@\n {\n   return MIPS_SYNC_OLD_OP (\"<d>\", \"<d>subu\");\t\n }\n-  [(set_attr \"length\" \"24\")])\n+  [(set_attr \"length\" \"28\")])\n \n (define_insn \"sync_new_add<mode>\"\n-  [(set (match_operand:GPR 0 \"register_operand\" \"=&d,d\")\n+  [(set (match_operand:GPR 0 \"register_operand\" \"=d,&d\")\n         (plus:GPR (match_operand:GPR 1 \"memory_operand\" \"+R,R\")\n \t\t  (match_operand:GPR 2 \"arith_operand\" \"I,d\")))\n    (set (match_dup 1)\n@@ -4416,7 +4416,7 @@\n   else\n     return MIPS_SYNC_NEW_OP (\"<d>\", \"<d>addu\");\t\n }\n-  [(set_attr \"length\" \"24\")])\n+  [(set_attr \"length\" \"28\")])\n \n (define_insn \"sync_new_sub<mode>\"\n   [(set (match_operand:GPR 0 \"register_operand\" \"=&d\")\n@@ -4430,7 +4430,7 @@\n {\n   return MIPS_SYNC_NEW_OP (\"<d>\", \"<d>subu\");\t\n }\n-  [(set_attr \"length\" \"24\")])\n+  [(set_attr \"length\" \"28\")])\n \n (define_insn \"sync_<optab><mode>\"\n   [(set (match_operand:GPR 0 \"memory_operand\" \"+R,R\")\n@@ -4445,10 +4445,10 @@\n   else\n     return MIPS_SYNC_OP (\"<d>\", \"<insn>\");\t\n }\n-  [(set_attr \"length\" \"24\")])\n+  [(set_attr \"length\" \"28\")])\n \n (define_insn \"sync_old_<optab><mode>\"\n-  [(set (match_operand:GPR 0 \"register_operand\" \"=&d,d\")\n+  [(set (match_operand:GPR 0 \"register_operand\" \"=d,&d\")\n \t(match_operand:GPR 1 \"memory_operand\" \"+R,R\"))\n    (set (match_dup 1)\n \t(unspec_volatile:GPR\n@@ -4462,10 +4462,10 @@\n   else\n     return MIPS_SYNC_OLD_OP (\"<d>\", \"<insn>\");\t\n }\n-  [(set_attr \"length\" \"24\")])\n+  [(set_attr \"length\" \"28\")])\n \n (define_insn \"sync_new_<optab><mode>\"\n-  [(set (match_operand:GPR 0 \"register_operand\" \"=&d,d\")\n+  [(set (match_operand:GPR 0 \"register_operand\" \"=d,&d\")\n \t(match_operand:GPR 1 \"memory_operand\" \"+R,R\"))\n    (set (match_dup 1)\n \t(unspec_volatile:GPR\n@@ -4479,7 +4479,7 @@\n   else\n     return MIPS_SYNC_NEW_OP (\"<d>\", \"<insn>\");\t\n }\n-  [(set_attr \"length\" \"24\")])\n+  [(set_attr \"length\" \"28\")])\n \n (define_insn \"sync_nand<mode>\"\n   [(set (match_operand:GPR 0 \"memory_operand\" \"+R,R\")\n@@ -4492,10 +4492,10 @@\n   else\n     return MIPS_SYNC_NAND (\"<d>\", \"and\");\t\n }\n-  [(set_attr \"length\" \"28\")])\n+  [(set_attr \"length\" \"32\")])\n \n (define_insn \"sync_old_nand<mode>\"\n-  [(set (match_operand:GPR 0 \"register_operand\" \"=&d,d\")\n+  [(set (match_operand:GPR 0 \"register_operand\" \"=d,&d\")\n \t(match_operand:GPR 1 \"memory_operand\" \"+R,R\"))\n    (set (match_dup 1)\n         (unspec_volatile:GPR [(match_operand:GPR 2 \"uns_arith_operand\" \"K,d\")]\n@@ -4507,10 +4507,10 @@\n   else\n     return MIPS_SYNC_OLD_NAND (\"<d>\", \"and\");\t\n }\n-  [(set_attr \"length\" \"28\")])\n+  [(set_attr \"length\" \"32\")])\n \n (define_insn \"sync_new_nand<mode>\"\n-  [(set (match_operand:GPR 0 \"register_operand\" \"=&d,d\")\n+  [(set (match_operand:GPR 0 \"register_operand\" \"=d,&d\")\n \t(match_operand:GPR 1 \"memory_operand\" \"+R,R\"))\n    (set (match_dup 1)\n \t(unspec_volatile:GPR [(match_operand:GPR 2 \"uns_arith_operand\" \"K,d\")]\n@@ -4522,10 +4522,10 @@\n   else\n     return MIPS_SYNC_NEW_NAND (\"<d>\", \"and\");\t\n }\n-  [(set_attr \"length\" \"28\")])\n+  [(set_attr \"length\" \"32\")])\n \n (define_insn \"sync_lock_test_and_set<mode>\"\n-  [(set (match_operand:GPR 0 \"register_operand\" \"=&d,d\")\n+  [(set (match_operand:GPR 0 \"register_operand\" \"=d,&d\")\n \t(match_operand:GPR 1 \"memory_operand\" \"+R,R\"))\n    (set (match_dup 1)\n \t(unspec_volatile:GPR [(match_operand:GPR 2 \"arith_operand\" \"I,d\")]"}]}