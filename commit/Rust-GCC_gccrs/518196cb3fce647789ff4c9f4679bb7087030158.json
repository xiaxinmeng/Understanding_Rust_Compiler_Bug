{"sha": "518196cb3fce647789ff4c9f4679bb7087030158", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTE4MTk2Y2IzZmNlNjQ3Nzg5ZmY0YzlmNDY3OWJiNzA4NzAzMDE1OA==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2018-09-21T10:11:37Z"}, "committer": {"name": "Eric Botcazou", "email": "ebotcazou@gcc.gnu.org", "date": "2018-09-21T10:11:37Z"}, "message": "c-ada-spec.c: Include diagnostic.h.\n\n\t* c-ada-spec.c: Include diagnostic.h.\n\t(dump_ada_declaration) <RECORD_TYPE>: Issue a warning on packed layout.\n\nFrom-SVN: r264466", "tree": {"sha": "3608fccf597850b0bfea6bd4794ada2f8abe8866", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3608fccf597850b0bfea6bd4794ada2f8abe8866"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/518196cb3fce647789ff4c9f4679bb7087030158", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/518196cb3fce647789ff4c9f4679bb7087030158", "html_url": "https://github.com/Rust-GCC/gccrs/commit/518196cb3fce647789ff4c9f4679bb7087030158", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/518196cb3fce647789ff4c9f4679bb7087030158/comments", "author": null, "committer": null, "parents": [{"sha": "d5d94b80c320319263b0bba3083f8bc80bf6ef4b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d5d94b80c320319263b0bba3083f8bc80bf6ef4b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d5d94b80c320319263b0bba3083f8bc80bf6ef4b"}], "stats": {"total": 30, "additions": 30, "deletions": 0}, "files": [{"sha": "4080bee111dc6d23cf664f2b902afb09ebe0c34e", "filename": "gcc/c-family/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/518196cb3fce647789ff4c9f4679bb7087030158/gcc%2Fc-family%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/518196cb3fce647789ff4c9f4679bb7087030158/gcc%2Fc-family%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2FChangeLog?ref=518196cb3fce647789ff4c9f4679bb7087030158", "patch": "@@ -1,3 +1,8 @@\n+2018-09-21  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* c-ada-spec.c: Include diagnostic.h.\n+\t(dump_ada_declaration) <RECORD_TYPE>: Issue a warning on packed layout.\n+\n 2018-09-19  Marek Polacek  <polacek@redhat.com>\n \n \t* c.opt (Wclass-conversion): New."}, {"sha": "eae741ed6b533aa3ca2e09896f225a4cc785321c", "filename": "gcc/c-family/c-ada-spec.c", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/518196cb3fce647789ff4c9f4679bb7087030158/gcc%2Fc-family%2Fc-ada-spec.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/518196cb3fce647789ff4c9f4679bb7087030158/gcc%2Fc-family%2Fc-ada-spec.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2Fc-ada-spec.c?ref=518196cb3fce647789ff4c9f4679bb7087030158", "patch": "@@ -27,6 +27,7 @@ along with GCC; see the file COPYING3.  If not see\n #include \"c-ada-spec.h\"\n #include \"fold-const.h\"\n #include \"c-pragma.h\"\n+#include \"diagnostic.h\"\n #include \"stringpool.h\"\n #include \"attribs.h\"\n \n@@ -2700,6 +2701,16 @@ dump_ada_declaration (pretty_printer *buffer, tree t, tree type, int spc)\n \t\treturn 1;\n \t      }\n \n+\t    /* ??? Packed record layout is not supported.  */\n+\t    if (TYPE_PACKED (TREE_TYPE (t)))\n+\t      {\n+\t\twarning_at (DECL_SOURCE_LOCATION (t), 0,\n+\t\t\t    \"unsupported record layout\");\n+\t\tpp_string (buffer, \"pragma Compile_Time_Warning (True, \");\n+\t\tpp_string (buffer, \"\\\"probably incorrect record layout\\\");\");\n+\t\tnewline_and_indent (buffer, spc);\n+\t      }\n+\n \t    if (orig && TYPE_NAME (orig))\n \t      pp_string (buffer, \"subtype \");\n \t    else"}, {"sha": "6f338c2e84c5ca6ebcf3fb160a231edfdbb14ca1", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/518196cb3fce647789ff4c9f4679bb7087030158/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/518196cb3fce647789ff4c9f4679bb7087030158/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=518196cb3fce647789ff4c9f4679bb7087030158", "patch": "@@ -1,3 +1,7 @@\n+2018-09-21  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* c-c++-common/dump-ada-spec-14.c: New test.\n+\n 2018-09-21  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* gcc.dg/nested-func-11.c: New test."}, {"sha": "bfdec6181b53300cf2a5f6d3f36c98064c44b82f", "filename": "gcc/testsuite/c-c++-common/dump-ada-spec-14.c", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/518196cb3fce647789ff4c9f4679bb7087030158/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fdump-ada-spec-14.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/518196cb3fce647789ff4c9f4679bb7087030158/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fdump-ada-spec-14.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fdump-ada-spec-14.c?ref=518196cb3fce647789ff4c9f4679bb7087030158", "patch": "@@ -0,0 +1,10 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-fdump-ada-spec\" } */\n+\n+struct __attribute__((packed)) S /* { dg-warning \"unsupported record layout\" } */\n+{\n+  char c;\n+  int  t;\n+};\n+\n+/* { dg-final { cleanup-ada-spec } } */"}]}