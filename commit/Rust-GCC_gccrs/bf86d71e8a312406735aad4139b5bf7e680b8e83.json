{"sha": "bf86d71e8a312406735aad4139b5bf7e680b8e83", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmY4NmQ3MWU4YTMxMjQwNjczNWFhZDQxMzliNWJmN2U2ODBiOGU4Mw==", "commit": {"author": {"name": "Zdenek Dvorak", "email": "rakdver@atrey.karlin.mff.cuni.cz", "date": "2003-12-27T19:51:17Z"}, "committer": {"name": "Zdenek Dvorak", "email": "rakdver@gcc.gnu.org", "date": "2003-12-27T19:51:17Z"}, "message": "re PR rtl-optimization/13159 (FAIL: gcc.c-torture/compile/930621-1.c)\n\n\tPR opt/13159\n\t* cfgloopanal.c (mark_irreducible_loops): Fix the strongly connected\n\tcomponents detection.\n\t* loop-unswitch.c (unswitch_loop): Preserve simple preheaders.\n\n\t* gcc.c-torture/compile/20031227-1.c: New test.\n\nFrom-SVN: r75174", "tree": {"sha": "c1ac3d0e9b92e39c461d328f289b2cec68f64955", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c1ac3d0e9b92e39c461d328f289b2cec68f64955"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bf86d71e8a312406735aad4139b5bf7e680b8e83", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bf86d71e8a312406735aad4139b5bf7e680b8e83", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bf86d71e8a312406735aad4139b5bf7e680b8e83", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bf86d71e8a312406735aad4139b5bf7e680b8e83/comments", "author": null, "committer": null, "parents": [{"sha": "9bd85baa69e57d5363fb9e059cc8f12464ad4379", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9bd85baa69e57d5363fb9e059cc8f12464ad4379", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9bd85baa69e57d5363fb9e059cc8f12464ad4379"}], "stats": {"total": 34, "additions": 33, "deletions": 1}, "files": [{"sha": "cbd6f4b0e61fa6c4ad4dfe91f728537ad4b55de8", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bf86d71e8a312406735aad4139b5bf7e680b8e83/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bf86d71e8a312406735aad4139b5bf7e680b8e83/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=bf86d71e8a312406735aad4139b5bf7e680b8e83", "patch": "@@ -1,3 +1,10 @@\n+2003-12-27  Zdenek Dvorak  <rakdver@atrey.karlin.mff.cuni.cz>\n+\n+\tPR opt/13159\n+\t* cfgloopanal.c (mark_irreducible_loops): Fix the strongly connected\n+\tcomponents detection.\n+\t* loop-unswitch.c (unswitch_loop): Preserve simple preheaders.\n+\n 2003-12-27  Bernardo Innocenti  <bernie@develer.com>\n \n \t* config/m68k/uclinux.h (LIB_SPEC): Add elf2flt magic required for"}, {"sha": "74cebe009196c1e2c5ad9c65df9c4783667abf1d", "filename": "gcc/cfgloopanal.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bf86d71e8a312406735aad4139b5bf7e680b8e83/gcc%2Fcfgloopanal.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bf86d71e8a312406735aad4139b5bf7e680b8e83/gcc%2Fcfgloopanal.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcfgloopanal.c?ref=bf86d71e8a312406735aad4139b5bf7e680b8e83", "patch": "@@ -1247,7 +1247,7 @@ mark_irreducible_loops (struct loops *loops)\n \t           : e->dest->index + 1;\n           if (closed[sidx])\n \t    {\n-\t      if (!closed[mri[sidx]])\n+\t      if (mri[sidx] != -1 && !closed[mri[sidx]])\n \t\t{\n \t\t  if (mr[sidx] < mr[idx])\n \t\t    {"}, {"sha": "25728c2bf62488fc1a4bacc5777fc37d40a28ed1", "filename": "gcc/loop-unswitch.c", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bf86d71e8a312406735aad4139b5bf7e680b8e83/gcc%2Floop-unswitch.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bf86d71e8a312406735aad4139b5bf7e680b8e83/gcc%2Floop-unswitch.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Floop-unswitch.c?ref=bf86d71e8a312406735aad4139b5bf7e680b8e83", "patch": "@@ -402,5 +402,9 @@ unswitch_loop (struct loops *loops, struct loop *loop, basic_block unswitch_on)\n   fix_loop_placement (loop);\n   fix_loop_placement (nloop);\n \n+  /* Preserve the simple loop preheaders.  */\n+  loop_split_edge_with (loop_preheader_edge (loop), NULL_RTX, loops);\n+  loop_split_edge_with (loop_preheader_edge (nloop), NULL_RTX, loops);\n+\n   return nloop;\n }"}, {"sha": "b124d1309817fbea43d850a98f481fa7f941cc27", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bf86d71e8a312406735aad4139b5bf7e680b8e83/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bf86d71e8a312406735aad4139b5bf7e680b8e83/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=bf86d71e8a312406735aad4139b5bf7e680b8e83", "patch": "@@ -1,3 +1,7 @@\n+2003-12-27  Zdenek Dvorak  <rakdver@atrey.karlin.mff.cuni.cz>\n+\n+\t* gcc.c-torture/compile/20031227-1.c: New test.\n+\n 2003-12-23  Mark Mitchell  <mark@codesourcery.com>\n \n \t* g++.dg/bprob/bprob.exp: Load target-supports.exp"}, {"sha": "41597bd18e6c45e1102a65da202bcb7ba53d94dd", "filename": "gcc/testsuite/gcc.c-torture/compile/20031227-1.c", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bf86d71e8a312406735aad4139b5bf7e680b8e83/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2F20031227-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bf86d71e8a312406735aad4139b5bf7e680b8e83/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2F20031227-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2F20031227-1.c?ref=bf86d71e8a312406735aad4139b5bf7e680b8e83", "patch": "@@ -0,0 +1,17 @@\n+/* PR opt/13159 -- test unswitching a loop multiple times.  */\n+\n+void\n+foo (void)\n+{\n+  long j, k, p, g;\n+\n+  while (p)\n+    {\n+      while (k < 0 && j < 0)\n+\t;\n+      if (g)\n+\t;\n+      else if (g)\n+\t;      \n+    }\n+}"}]}