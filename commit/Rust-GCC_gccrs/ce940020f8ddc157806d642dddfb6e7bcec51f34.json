{"sha": "ce940020f8ddc157806d642dddfb6e7bcec51f34", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Y2U5NDAwMjBmOGRkYzE1NzgwNmQ2NDJkZGRmYjZlN2JjZWM1MWYzNA==", "commit": {"author": {"name": "Vladimir Makarov", "email": "vmakarov@redhat.com", "date": "2012-11-27T22:01:14Z"}, "committer": {"name": "Vladimir Makarov", "email": "vmakarov@gcc.gnu.org", "date": "2012-11-27T22:01:14Z"}, "message": "re PR rtl-optimization/55458 (ICE: in assign_by_spills, at lra-assigns.c:1212 with -fPIC -m32 and simple asm volatile)\n\n2012-11-27  Vladimir Makarov  <vmakarov@redhat.com>\n\n\tPR rtl-optimization/55458\n\t* lra-assigns.c: Include rtl-error.h.\n\t(assign_by_spills): Report about asm inpossible constraints.\n\t* Makefile.in (lra-assigns.c): Add $(RTL_ERROR_H).\n\n2012-11-27  Vladimir Makarov  <vmakarov@redhat.com>\n\n\tPR rtl-optimization/55458\n\t* gcc.target/i386/pr55458.c: New test.\n\nFrom-SVN: r193871", "tree": {"sha": "178d780989b410cd7feafda80a457db40e929d5e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/178d780989b410cd7feafda80a457db40e929d5e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ce940020f8ddc157806d642dddfb6e7bcec51f34", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ce940020f8ddc157806d642dddfb6e7bcec51f34", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ce940020f8ddc157806d642dddfb6e7bcec51f34", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ce940020f8ddc157806d642dddfb6e7bcec51f34/comments", "author": {"login": "vnmakarov", "id": 9855671, "node_id": "MDQ6VXNlcjk4NTU2NzE=", "avatar_url": "https://avatars.githubusercontent.com/u/9855671?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vnmakarov", "html_url": "https://github.com/vnmakarov", "followers_url": "https://api.github.com/users/vnmakarov/followers", "following_url": "https://api.github.com/users/vnmakarov/following{/other_user}", "gists_url": "https://api.github.com/users/vnmakarov/gists{/gist_id}", "starred_url": "https://api.github.com/users/vnmakarov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vnmakarov/subscriptions", "organizations_url": "https://api.github.com/users/vnmakarov/orgs", "repos_url": "https://api.github.com/users/vnmakarov/repos", "events_url": "https://api.github.com/users/vnmakarov/events{/privacy}", "received_events_url": "https://api.github.com/users/vnmakarov/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "29f696491ccee2ae80fef5a0cd9decb6a86f1caa", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/29f696491ccee2ae80fef5a0cd9decb6a86f1caa", "html_url": "https://github.com/Rust-GCC/gccrs/commit/29f696491ccee2ae80fef5a0cd9decb6a86f1caa"}], "stats": {"total": 55, "additions": 53, "deletions": 2}, "files": [{"sha": "0d7dc0bb385da48ff33bbf0914be8f383abe150a", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ce940020f8ddc157806d642dddfb6e7bcec51f34/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ce940020f8ddc157806d642dddfb6e7bcec51f34/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=ce940020f8ddc157806d642dddfb6e7bcec51f34", "patch": "@@ -1,3 +1,10 @@\n+2012-11-27  Vladimir Makarov  <vmakarov@redhat.com>\n+\n+\tPR rtl-optimization/55458\n+\t* lra-assigns.c: Include rtl-error.h.\n+\t(assign_by_spills): Report about asm inpossible constraints.\n+\t* Makefile.in (lra-assigns.c): Add $(RTL_ERROR_H).\n+\n 2012-11-27  Paolo Bonzini  <pbonzini@redhat.com>\n \n \tPR rtl-optimization/55489"}, {"sha": "8c78eda61ea47887d890e67d9e7c2feb2d3b8039", "filename": "gcc/Makefile.in", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ce940020f8ddc157806d642dddfb6e7bcec51f34/gcc%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ce940020f8ddc157806d642dddfb6e7bcec51f34/gcc%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FMakefile.in?ref=ce940020f8ddc157806d642dddfb6e7bcec51f34", "patch": "@@ -3261,7 +3261,7 @@ lra.o : lra.c $(CONFIG_H) $(SYSTEM_H) coretypes.h $(TM_H) \\\n    $(FLAGS_H) $(FUNCTION_H) $(EXPR_H) $(BASIC_BLOCK_H) $(TM_P_H) \\\n    $(EXCEPT_H) ira.h $(LRA_INT_H)\n lra-assigns.o : lra-assigns.c $(CONFIG_H) $(SYSTEM_H) coretypes.h \\\n-   $(TM_H) $(RTL_H) $(REGS_H) insn-config.h $(DF_H) \\\n+   $(TM_H) $(RTL_H) $(RTL_ERROR_H) $(REGS_H) insn-config.h $(DF_H) \\\n    $(RECOG_H) output.h $(REGS_H) hard-reg-set.h $(FLAGS_H) $(FUNCTION_H) \\\n    $(EXPR_H) $(BASIC_BLOCK_H) $(TM_P_H) $(EXCEPT_H) ira.h \\\n    rtl-error.h sparseset.h $(LRA_INT_H)"}, {"sha": "8b7dcffb52319334d8d5bdb000aca6a36fe003bf", "filename": "gcc/lra-assigns.c", "status": "modified", "additions": 29, "deletions": 1, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ce940020f8ddc157806d642dddfb6e7bcec51f34/gcc%2Flra-assigns.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ce940020f8ddc157806d642dddfb6e7bcec51f34/gcc%2Flra-assigns.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flra-assigns.c?ref=ce940020f8ddc157806d642dddfb6e7bcec51f34", "patch": "@@ -81,6 +81,7 @@ along with GCC; see the file COPYING3.\tIf not see\n #include \"tm.h\"\n #include \"hard-reg-set.h\"\n #include \"rtl.h\"\n+#include \"rtl-error.h\"\n #include \"tm_p.h\"\n #include \"target.h\"\n #include \"insn-config.h\"\n@@ -1209,7 +1210,34 @@ assign_by_spills (void)\n \t}\n       if (nfails == 0)\n \tbreak;\n-      lra_assert (iter == 0);\n+      if (iter > 0)\n+\t{\n+\t  /* We did not assign hard regs to reload pseudos after two\n+\t     iteration.  It means something is wrong with asm insn\n+\t     constraints.  Report it.  */\n+\t  bool asm_p = false;\n+\t  bitmap_head failed_reload_insns;\n+\n+\t  bitmap_initialize (&failed_reload_insns, &reg_obstack);\n+\t  for (i = 0; i < nfails; i++)\n+\t    bitmap_ior_into (&failed_reload_insns,\n+\t\t\t     &lra_reg_info[sorted_pseudos[i]].insn_bitmap);\n+\t  EXECUTE_IF_SET_IN_BITMAP (&failed_reload_insns, 0, u, bi)\n+\t    {\n+\t      insn = lra_insn_recog_data[u]->insn;\n+\t      if (asm_noperands (PATTERN (insn)) >= 0)\n+\t\t{\n+\t\t  asm_p = true;\n+\t\t  error_for_asm (insn,\n+\t\t\t\t \"%<asm%> operand has impossible constraints\");\n+\t\t  /* Avoid further trouble with this insn.\t*/\n+\t\t  PATTERN (insn) = gen_rtx_USE (VOIDmode, const0_rtx);\n+\t\t  lra_invalidate_insn_data (insn);\n+\t\t}\n+\t    }\n+\t  lra_assert (asm_p);\n+\t  break;\n+\t}\n       /* This is a very rare event.  We can not assign a hard\n \t register to reload pseudo because the hard register was\n \t assigned to another reload pseudo on a previous"}, {"sha": "e065504c0f9bc481e5c206922ab0d427fd379402", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ce940020f8ddc157806d642dddfb6e7bcec51f34/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ce940020f8ddc157806d642dddfb6e7bcec51f34/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=ce940020f8ddc157806d642dddfb6e7bcec51f34", "patch": "@@ -1,3 +1,8 @@\n+2012-11-27  Vladimir Makarov  <vmakarov@redhat.com>\n+\n+\tPR rtl-optimization/55458\n+\t* gcc.target/i386/pr55458.c: New test.\n+\n 2012-11-27  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR tree-optimization/55110"}, {"sha": "07a54adc852420886a25d96ba1936ddab8d4191a", "filename": "gcc/testsuite/gcc.target/i386/pr55458.c", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ce940020f8ddc157806d642dddfb6e7bcec51f34/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr55458.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ce940020f8ddc157806d642dddfb6e7bcec51f34/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr55458.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr55458.c?ref=ce940020f8ddc157806d642dddfb6e7bcec51f34", "patch": "@@ -0,0 +1,11 @@\n+/* { dg-do compile } */\n+/* { dg-require-effective-target ilp32 } */\n+/* { dg-options \"-fPIC\" } */\n+\n+int a, b, c;\n+\n+void\n+foo (void)\n+{\n+  asm volatile (\"\":\"+m\" (a), \"+m\" (b), \"+m\" (c)); /* { dg-error \"operand has impossible constraints\" } */\n+}"}]}