{"sha": "23844fd7306763ee07f27acd6883fd47bc858ec3", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjM4NDRmZDczMDY3NjNlZTA3ZjI3YWNkNjg4M2ZkNDdiYzg1OGVjMw==", "commit": {"author": {"name": "David Malcolm", "email": "dmalcolm@redhat.com", "date": "2014-12-01T18:16:37Z"}, "committer": {"name": "David Malcolm", "email": "dmalcolm@gcc.gnu.org", "date": "2014-12-01T18:16:37Z"}, "message": "jit-builtins.c: Fix segfault on unsupported builtins\n\ngcc/jit/ChangeLog:\n\t* jit-builtins.c\n\t(gcc::jit::recording::builtins_manager::get_builtin_function):\n\tCheck for NULL return from make_builtin_function.\n\t(gcc::jit::recording::builtins_manager::make_builtin_function):\n\tCheck for NULL return from get_type.\n\nFrom-SVN: r218239", "tree": {"sha": "1d2badcdfd4c27a7c730c42dff28bb7ade429644", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1d2badcdfd4c27a7c730c42dff28bb7ade429644"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/23844fd7306763ee07f27acd6883fd47bc858ec3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/23844fd7306763ee07f27acd6883fd47bc858ec3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/23844fd7306763ee07f27acd6883fd47bc858ec3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/23844fd7306763ee07f27acd6883fd47bc858ec3/comments", "author": {"login": "davidmalcolm", "id": 1553248, "node_id": "MDQ6VXNlcjE1NTMyNDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1553248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidmalcolm", "html_url": "https://github.com/davidmalcolm", "followers_url": "https://api.github.com/users/davidmalcolm/followers", "following_url": "https://api.github.com/users/davidmalcolm/following{/other_user}", "gists_url": "https://api.github.com/users/davidmalcolm/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidmalcolm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidmalcolm/subscriptions", "organizations_url": "https://api.github.com/users/davidmalcolm/orgs", "repos_url": "https://api.github.com/users/davidmalcolm/repos", "events_url": "https://api.github.com/users/davidmalcolm/events{/privacy}", "received_events_url": "https://api.github.com/users/davidmalcolm/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "c6760a13178f56f5aea081b0f88fa7695a9daf58", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c6760a13178f56f5aea081b0f88fa7695a9daf58", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c6760a13178f56f5aea081b0f88fa7695a9daf58"}], "stats": {"total": 21, "additions": 18, "deletions": 3}, "files": [{"sha": "042a6f0a9fd92900863551c31f958a14b8a6ed29", "filename": "gcc/jit/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/23844fd7306763ee07f27acd6883fd47bc858ec3/gcc%2Fjit%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/23844fd7306763ee07f27acd6883fd47bc858ec3/gcc%2Fjit%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjit%2FChangeLog?ref=23844fd7306763ee07f27acd6883fd47bc858ec3", "patch": "@@ -1,3 +1,11 @@\n+2014-12-01  David Malcolm  <dmalcolm@redhat.com>\n+\n+\t* jit-builtins.c\n+\t(gcc::jit::recording::builtins_manager::get_builtin_function):\n+\tCheck for NULL return from make_builtin_function.\n+\t(gcc::jit::recording::builtins_manager::make_builtin_function):\n+\tCheck for NULL return from get_type.\n+\n 2014-12-01  David Malcolm  <dmalcolm@redhat.com>\n \n \t* jit-playback.c (gcc::jit::playback::context::compile): Move DSO"}, {"sha": "9063075c221bf3f3ee6d43164437e56fe30bb1bf", "filename": "gcc/jit/jit-builtins.c", "status": "modified", "additions": 10, "deletions": 3, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/23844fd7306763ee07f27acd6883fd47bc858ec3/gcc%2Fjit%2Fjit-builtins.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/23844fd7306763ee07f27acd6883fd47bc858ec3/gcc%2Fjit%2Fjit-builtins.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjit%2Fjit-builtins.c?ref=23844fd7306763ee07f27acd6883fd47bc858ec3", "patch": "@@ -160,8 +160,12 @@ builtins_manager::get_builtin_function (const char *name)\n      the same id on a context give back the same object.  */\n   if (!m_builtin_functions[builtin_id])\n     {\n-      m_builtin_functions[builtin_id] = make_builtin_function (builtin_id);\n-      m_ctxt->record (m_builtin_functions[builtin_id]);\n+      function *fn = make_builtin_function (builtin_id);\n+      if (fn)\n+\t{\n+\t  m_builtin_functions[builtin_id] = fn;\n+\t  m_ctxt->record (fn);\n+\t}\n     }\n \n   return m_builtin_functions[builtin_id];\n@@ -174,7 +178,10 @@ builtins_manager::make_builtin_function (enum built_in_function builtin_id)\n {\n   const struct builtin_data& bd = builtin_data[builtin_id];\n   enum jit_builtin_type type_id = bd.type;\n-  function_type *func_type = get_type (type_id)->as_a_function_type ();\n+  type *t = get_type (type_id);\n+  if (!t)\n+    return NULL;\n+  function_type *func_type = t->as_a_function_type ();\n   if (!func_type)\n     return NULL;\n "}]}