{"sha": "dd30b57d9dbe6b6b2f55b92faf7cff6542e47130", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZGQzMGI1N2Q5ZGJlNmI2YjJmNTViOTJmYWY3Y2ZmNjU0MmU0NzEzMA==", "commit": {"author": {"name": "Nathanael Nerode", "email": "neroden@gcc.gnu.org", "date": "2002-09-29T15:53:23Z"}, "committer": {"name": "Nathanael Nerode", "email": "neroden@gcc.gnu.org", "date": "2002-09-29T15:53:23Z"}, "message": "Makefile.tpl: Make more autoconf-friendly.\n\n2002-09-29  Nathanael Nerode  <neroden@gcc.gnu.org>\n\n\t* Makefile.tpl: Make more autoconf-friendly.\n\t* Makefile.in: Regenerate.\n\t* configure: Make substitution more autoconf-like.\n\nFrom-SVN: r57625", "tree": {"sha": "db1584766355fe42be4bc415de31fc128b63c0c2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/db1584766355fe42be4bc415de31fc128b63c0c2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/dd30b57d9dbe6b6b2f55b92faf7cff6542e47130", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dd30b57d9dbe6b6b2f55b92faf7cff6542e47130", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dd30b57d9dbe6b6b2f55b92faf7cff6542e47130", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dd30b57d9dbe6b6b2f55b92faf7cff6542e47130/comments", "author": null, "committer": null, "parents": [{"sha": "991b659243a67ab870d02a52be36dd63409ed2d9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/991b659243a67ab870d02a52be36dd63409ed2d9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/991b659243a67ab870d02a52be36dd63409ed2d9"}], "stats": {"total": 163, "additions": 58, "deletions": 105}, "files": [{"sha": "94f00c2596d875d00684abf096ceb59a160e990a", "filename": "ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dd30b57d9dbe6b6b2f55b92faf7cff6542e47130/ChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dd30b57d9dbe6b6b2f55b92faf7cff6542e47130/ChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/ChangeLog?ref=dd30b57d9dbe6b6b2f55b92faf7cff6542e47130", "patch": "@@ -1,3 +1,9 @@\n+2002-09-29  Nathanael Nerode  <neroden@gcc.gnu.org>\n+\n+\t* Makefile.tpl: Make more autoconf-friendly.\n+\t* Makefile.in: Regenerate.\n+\t* configure: Make substitution more autoconf-like.\n+\n 2002-09-28  Richard Earnshaw  <rearnsha@arm.com>\n \n \t* configure.in (arm-*-coff, strongarm-*-coff, xscale-*-coff): Use a"}, {"sha": "81c65f986ea4d3b1393f6a0ee97387f27ae7cbe5", "filename": "Makefile.in", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dd30b57d9dbe6b6b2f55b92faf7cff6542e47130/Makefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dd30b57d9dbe6b6b2f55b92faf7cff6542e47130/Makefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/Makefile.in?ref=dd30b57d9dbe6b6b2f55b92faf7cff6542e47130", "patch": "@@ -181,8 +181,7 @@ RUNTEST = `if [ -f $$s/dejagnu/runtest ] ; \\\n CC_FOR_BUILD = $(CC)\n CXX_FOR_BUILD = $(CXX)\n \n-SUBDIRS = \"this is set via configure, don't edit this\"\n-OTHERS = \n+SUBDIRS = @configdirs@\n \n # This is set by the configure script to the list of directories which\n # should be built using the target tools."}, {"sha": "2a423508771e321c1e3140db314cca148f8b45bb", "filename": "Makefile.tpl", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dd30b57d9dbe6b6b2f55b92faf7cff6542e47130/Makefile.tpl", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dd30b57d9dbe6b6b2f55b92faf7cff6542e47130/Makefile.tpl", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/Makefile.tpl?ref=dd30b57d9dbe6b6b2f55b92faf7cff6542e47130", "patch": "@@ -184,8 +184,7 @@ RUNTEST = `if [ -f $$s/dejagnu/runtest ] ; \\\n CC_FOR_BUILD = $(CC)\n CXX_FOR_BUILD = $(CXX)\n \n-SUBDIRS = \"this is set via configure, don't edit this\"\n-OTHERS = \n+SUBDIRS = @configdirs@\n \n # This is set by the configure script to the list of directories which\n # should be built using the target tools."}, {"sha": "3776096bd37495dbc7b0177ebc3e42f65a092d11", "filename": "configure", "status": "modified", "additions": 50, "deletions": 101, "changes": 151, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dd30b57d9dbe6b6b2f55b92faf7cff6542e47130/configure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dd30b57d9dbe6b6b2f55b92faf7cff6542e47130/configure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/configure?ref=dd30b57d9dbe6b6b2f55b92faf7cff6542e47130", "patch": "@@ -85,11 +85,10 @@ site_makefile_frag=\n site_option=\n srcdir=\n srctrigger=\n-subdirs=\n target_alias=NOTARGET\n target_makefile_frag=\n undefs=NOUNDEFS\n-version=\"$Revision: 1.46 $\"\n+version=\"$Revision: 1.47 $\"\n x11=default\n bindir='${exec_prefix}/bin'\n sbindir='${exec_prefix}/sbin'\n@@ -1078,56 +1077,17 @@ then\n   all_build_modules='$(ALL_BUILD_MODULES_LIST)'\n fi\n \n-for subdir in . ${subdirs} ; do\n-\n-    # ${subdir} is relative path from . to the directory we're currently\n-    # configuring.\n-    # ${invsubdir} is inverse of ${subdir), *with* trailing /, if needed.\n-    invsubdir=`echo ${subdir}/ | sed -e 's|\\./||g' -e 's|[^/]*/|../|g'`\n-\n-    ### figure out what to do with srcdir\n-    case \"${srcdir}\" in\n-        \".\")  # no -srcdir option.  We're building in place.\n-                makesrcdir=. ;;\n-        /* | [A-Za-z]:[\\\\/]* ) # absolute path\n-                makesrcdir=`echo ${srcdir}/${subdir} | sed -e 's|/\\.$||'`\n-                ;;\n-        *) # otherwise relative\n-                case \"${subdir}\" in\n-                .) makesrcdir=${srcdir} ;;\n-                *) makesrcdir=${invsubdir}${srcdir}/${subdir} ;;\n-                esac\n-                ;;\n-    esac\n-\n-    if [ \"${subdir}/\" != \"./\" ] ; then\n-        Makefile=${subdir}/Makefile\n-    fi\n-\n-    if [ ! -d ${subdir} ] ; then\n-        if mkdir ${subdir} ; then\n-                true\n-        else\n-                echo '***' \"${progname}: could not make ${PWD=`${PWDCMD-pwd}`}/${subdir}\" 1>&2\n-                exit 1\n-        fi\n-    fi\n-\n     case \"${removing}\" in\n     \"\")\n-        case \"${subdir}\" in\n-        .) ;;\n-        *) eval echo Building in ${subdir} ${redirect} ;;\n-        esac\n \n         # FIXME Should this be done recursively ??? (Useful for e.g. gdbtest)\n         # Set up the list of links to be made.\n         # ${links} is the list of link names, and ${files} is the list of names to link to.\n \n         # Make the links.\n         configlinks=\"${links}\"\n-        if [ -r ${subdir}/config.status ] ; then\n-                mv -f ${subdir}/config.status ${subdir}/config.back\n+        if [ -r ./config.status ] ; then\n+                mv -f ./config.status ./config.back\n         fi\n         while [ -n \"${files}\" ] ; do\n                 # set file to car of files, files to cdr of files\n@@ -1168,14 +1128,14 @@ for subdir in . ${subdirs} ; do\n         # Create a .gdbinit file which runs the one in srcdir\n         # and tells GDB to look there for source files.\n \n-        if [ -r ${srcdir}/${subdir}/.gdbinit ] ; then\n+        if [ -r ${srcdir}/.gdbinit ] ; then\n                 case ${srcdir} in\n                 .) ;;\n-                *) cat > ${subdir}/.gdbinit <<EOF\n+                *) cat > ./.gdbinit <<EOF\n # ${NO_EDIT}\n-dir ${makesrcdir}\n+dir ${srcdir}\n dir .\n-source ${makesrcdir}/.gdbinit\n+source ${srcdir}/.gdbinit\n EOF\n                         ;;\n                 esac\n@@ -1193,103 +1153,103 @@ EOF\n         # the five makefile fragments MUST end up in the resulting Makefile in this order: \n         # package macros, target, host, site, and package rules.\n \n-        if [ -f ${srcdir}/${subdir}/${Makefile_in} ] ; then\n+        if [ -f ${srcdir}/${Makefile_in} ] ; then\n \n             # Conditionalize the makefile for this package from \"Makefile.in\" (or whatever it's called) into Makefile.tem.\n-            rm -f ${subdir}/${Makefile}.tem\n+            rm -f ./${Makefile}.tem\n             case \"${package_makefile_rules_frag}\" in\n-              \"\") cp ${srcdir}/${subdir}/${Makefile_in} ${subdir}/Makefile.tem ;;\n+              \"\") cp ${srcdir}/${Makefile_in} ./Makefile.tem ;;\n               *)\n                       if [ ! -f ${package_makefile_rules_frag} ] ; then\n                               package_makefile_rules_frag=${srcdir}/${package_makefile_rules_frag}\n                       fi\n                       if [ -f ${package_makefile_rules_frag} ] ; then\n-                              sed -e \"/^####/  r ${package_makefile_rules_frag}\" ${srcdir}/${subdir}/${Makefile_in} > ${Makefile}.tem\n+                              sed -e \"/^####/  r ${package_makefile_rules_frag}\" ${srcdir}/${Makefile_in} > ${Makefile}.tem\n                       else\n                               echo '***' Expected package makefile rules fragment \\\"${package_makefile_rules_frag}\\\" 1>&2\n                               echo '***' is missing in ${PWD=`${PWDCMD-pwd}`}. 1>&2\n-                              cp ${srcdir}/${subdir}/${Makefile_in} ${subdir}/Makefile.tem\n+                              cp ${srcdir}/${Makefile_in} ./Makefile.tem\n                       fi\n             esac\n             # working copy now in ${Makefile}.tem\n \n             # Conditionalize for this site.\n             rm -f ${Makefile}\n               case \"${site}\" in\n-              \"\") mv ${subdir}/Makefile.tem ${Makefile} ;;\n+              \"\") mv ./Makefile.tem ${Makefile} ;;\n               *)\n                       site_makefile_frag=${srcdir}/config/ms-${site}\n \n                       if [ -f ${site_makefile_frag} ] ; then\n-                              sed -e \"/^####/  r ${site_makefile_frag}\" ${subdir}/Makefile.tem \\\n+                              sed -e \"/^####/  r ${site_makefile_frag}\" ./Makefile.tem \\\n                                       > ${Makefile}\n                       else\n-                              mv ${subdir}/Makefile.tem ${Makefile}\n+                              mv ./Makefile.tem ${Makefile}\n                               site_makefile_frag=\n                       fi\n                       ;;\n             esac\n             # working copy now in ${Makefile}\n \n             # Conditionalize the makefile for this host.\n-            rm -f ${subdir}/Makefile.tem\n+            rm -f ./Makefile.tem\n             case \"${host_makefile_frag}\" in\n-              \"\") mv ${Makefile} ${subdir}/Makefile.tem ;;\n+              \"\") mv ${Makefile} ./Makefile.tem ;;\n               *)\n                       if [ ! -f ${host_makefile_frag} ] ; then\n                               host_makefile_frag=${srcdir}/${host_makefile_frag}\n                       fi\n                       if [ -f ${host_makefile_frag} ] ; then\n-                              sed -e \"/^####/  r ${host_makefile_frag}\" ${Makefile} > ${subdir}/Makefile.tem\n+                              sed -e \"/^####/  r ${host_makefile_frag}\" ${Makefile} > ./Makefile.tem\n                       else\n                               echo '***' Expected host makefile fragment \\\"${host_makefile_frag}\\\" 1>&2\n                               echo '***' is missing in ${PWD=`${PWDCMD-pwd}`}. 1>&2\n-                              mv ${Makefile} ${subdir}/Makefile.tem\n+                              mv ${Makefile} ./Makefile.tem\n                       fi\n             esac\n-            # working copy now in ${subdir)/Makefile.tem\n+            # working copy now in ./Makefile.tem\n \n             # Conditionalize the makefile for this target.\n             rm -f ${Makefile}\n             case \"${target_makefile_frag}\" in\n-              \"\") mv ${subdir}/Makefile.tem ${Makefile} ;;\n+              \"\") mv ./Makefile.tem ${Makefile} ;;\n               *)\n                       if [ ! -f ${target_makefile_frag} ] ; then\n                               target_makefile_frag=${srcdir}/${target_makefile_frag}\n                       fi\n                       if [ -f ${target_makefile_frag} ] ; then\n-                              sed -e \"/^####/  r ${target_makefile_frag}\" ${subdir}/Makefile.tem > ${Makefile}\n+                              sed -e \"/^####/  r ${target_makefile_frag}\" ./Makefile.tem > ${Makefile}\n                       else\n-                              mv ${subdir}/Makefile.tem ${Makefile}\n+                              mv ./Makefile.tem ${Makefile}\n                               target_makefile_frag=\n                       fi\n                       ;;\n             esac\n             # working copy now in ${Makefile}\n \n             # Emit the default values of this package's macros.\n-            rm -f ${subdir}/Makefile.tem\n+            rm -f ./Makefile.tem\n             case \"${package_makefile_frag}\" in\n-              \"\") mv ${Makefile} ${subdir}/Makefile.tem ;;\n+              \"\") mv ${Makefile} ./Makefile.tem ;;\n               *)\n                       if [ ! -f ${package_makefile_frag} ] ; then\n                               package_makefile_frag=${srcdir}/${package_makefile_frag}\n                       fi\n                       if [ -f ${package_makefile_frag} ] ; then\n-                              sed -e \"/^####/  r ${package_makefile_frag}\" ${Makefile} > ${subdir}/Makefile.tem\n+                              sed -e \"/^####/  r ${package_makefile_frag}\" ${Makefile} > ./Makefile.tem\n                       else\n                               echo '***' Expected package makefile fragment \\\"${package_makefile_rules_frag}\\\" 1>&2\n                               echo '***' is missing in ${PWD=`${PWDCMD-pwd}`}. 1>&2\n-                              mv ${Makefile} ${subdir}/Makefile.tem\n+                              mv ${Makefile} ./Makefile.tem\n                       fi\n             esac\n-            # real copy now in ${subdir}/Makefile.tem\n+            # real copy now in ./Makefile.tem\n \n             # prepend warning about editing, and a bunch of variables.\n             rm -f ${Makefile}\n             cat > ${Makefile} <<EOF\n # ${NO_EDIT}\n-VPATH = ${makesrcdir}\n+VPATH = ${srcdir}\n links = ${configlinks}\n host_alias = ${host_alias}\n host_cpu = ${host_cpu}\n@@ -1316,23 +1276,23 @@ EOF\n             case \"${package_makefile_frag}\" in\n               \"\") ;;\n               /* | [A-Za-z]:[\\\\/]* ) echo package_makefile_frag = ${package_makefile_frag} >>${Makefile} ;;\n-              *)  echo package_makefile_frag = ${invsubdir}${package_makefile_frag} >>${Makefile} ;;\n+              *)  echo package_makefile_frag = ${package_makefile_frag} >>${Makefile} ;;\n             esac\n \n             case \"${target_makefile_frag}\" in\n               \"\") ;;\n               /* | [A-Za-z]:[\\\\/]* ) echo target_makefile_frag = ${target_makefile_frag} >>${Makefile} ;;\n-              *)  echo target_makefile_frag = ${invsubdir}${target_makefile_frag} >>${Makefile} ;;\n+              *)  echo target_makefile_frag = ${target_makefile_frag} >>${Makefile} ;;\n             esac\n \n             case \"${host_makefile_frag}\" in\n               \"\") ;;\n               /* | [A-Za-z]:[\\\\/]* ) echo host_makefile_frag = ${host_makefile_frag} >>${Makefile} ;;\n-              *)  echo host_makefile_frag = ${invsubdir}${host_makefile_frag} >>${Makefile} ;;\n+              *)  echo host_makefile_frag = ${host_makefile_frag} >>${Makefile} ;;\n             esac\n \n             if [ \"${site_makefile_frag}\" != \"\" ] ; then\n-                echo site_makefile_frag = ${invsubdir}${site_makefile_frag} >>${Makefile}\n+                echo site_makefile_frag = ${site_makefile_frag} >>${Makefile}\n             fi \n \n \t    echo enable_shared = ${enable_shared} >> ${Makefile}\n@@ -1352,18 +1312,17 @@ EOF\n \n             # reset prefix, exec_prefix, srcdir, SUBDIRS, NONSUBDIRS,\n             # remove any form feeds.\n-            if [ -z \"${subdirs}\" ]; then\n-                rm -f ${subdir}/Makefile.tm2\n+            if [ -z \"\" ]; then\n+                rm -f ./Makefile.tm2\n                 sedtemp=sed.$$\n                 cat >$sedtemp <<EOF\n-s:^SUBDIRS[ \t]*=.*$:SUBDIRS = ${configdirs}:\n-s:^NONSUBDIRS[ \t]*=.*$:NONSUBDIRS = ${noconfigdirs}:\n+s:@configdirs@:${configdirs}:\n EOF\n                 sed -f $sedtemp \\\n-                    ${subdir}/Makefile.tem > ${subdir}/Makefile.tm2\n+                    ./Makefile.tem > ./Makefile.tm2\n                 rm -f $sedtemp\n-                rm -f ${subdir}/Makefile.tem\n-                mv ${subdir}/Makefile.tm2 ${subdir}/Makefile.tem\n+                rm -f ./Makefile.tem\n+                mv ./Makefile.tm2 ./Makefile.tem\n \t    fi\n \t    sed     -e \"s|@prefix@|${prefix}|\" \\\n                     -e \"s|@exec_prefix@|${exec_prefix}|\" \\\n@@ -1409,15 +1368,15 @@ EOF\n \t\t\ts%^CXXFLAGS[ \t]*=.*$%CXXFLAGS = ${CXXFLAGS}%\n \t\t\t}\" \\\n \t\t    -e \"s|@config_shell@|${config_shell}|\" \\\n-                    -e \"s|@srcdir@|${makesrcdir}|\" \\\n+                    -e \"s|@srcdir@|${srcdir}|\" \\\n                     -e \"s/\f//\" \\\n                     -e \"s:@program_transform_name@:${program_transform_name}:\" \\\n                     -e \"s|@tooldir@|${tooldir}|\" \\\n                     -e \"s|@build_tooldir@|${tooldir}|\" \\\n \t\t    -e \"s:@DEFAULT_YACC@:${DEFAULT_YACC}:\" \\\n \t\t    -e \"s:@DEFAULT_LEX@:${DEFAULT_LEX}:\" \\\n \t\t    -e \"s:@DEFAULT_M4@:${DEFAULT_M4}:\" \\\n-                    ${subdir}/Makefile.tem >> ${Makefile}\n+                    ./Makefile.tem >> ${Makefile}\n   \n \t    sed -e \"s:@GDB_TK@:${GDB_TK}:\" ${Makefile} >${Makefile}.tem\n \t    mv -f ${Makefile}.tem ${Makefile}\n@@ -1441,10 +1400,10 @@ EOF\n             # final copy now in ${Makefile}\n \n         else\n-           echo \"No Makefile.in found in ${srcdir}/${subdir}, unable to configure\" 1>&2\n+           echo \"No Makefile.in found in ${srcdir}, unable to configure\" 1>&2\n         fi\n \n-        rm -f ${subdir}/Makefile.tem\n+        rm -f ./Makefile.tem\n \n         case \"${host_makefile_frag}\" in\n         \"\") using= ;;\n@@ -1477,30 +1436,20 @@ EOF\n         *) ;;\n         esac\n \n-        if [ ${subdir} = . ] ; then\n-            echo \"#!/bin/sh\n-# ${NO_EDIT}\n-# This directory was configured as follows:\n-${progname}\" ${arguments}  \"\n-# ${using}\" > ${subdir}/config.new\n-        else\n-            echo \"#!/bin/sh\n+        echo \"#!/bin/sh\n # ${NO_EDIT}\n # This directory was configured as follows:\n-cd ${invsubdir}\n ${progname}\" ${arguments}  \"\n-# ${using}\" > ${subdir}/config.new\n+# ${using}\" > ./config.new\n+        chmod a+x ./config.new\n+        if [ -r ./config.back ] ; then\n+                mv -f ./config.back ./config.status\n         fi\n-        chmod a+x ${subdir}/config.new\n-        if [ -r ${subdir}/config.back ] ; then\n-                mv -f ${subdir}/config.back ${subdir}/config.status\n-        fi\n-\t${config_shell} ${moveifchange} ${subdir}/config.new ${subdir}/config.status\n+\t${config_shell} ${moveifchange} ./config.new ./config.status\n         ;;\n \n-    *)  rm -f ${Makefile} ${subdir}/config.status ${links} ;;\n+    *)  rm -f ${Makefile} ./config.status ${links} ;;\n     esac\n-done\n \n # If there are subdirectories, then recur.\n if [ -z \"${norecursion}\" ] && [ -n \"${configdirs}\" ] ; then "}]}