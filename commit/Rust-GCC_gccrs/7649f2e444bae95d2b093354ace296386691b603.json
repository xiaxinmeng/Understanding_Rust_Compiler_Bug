{"sha": "7649f2e444bae95d2b093354ace296386691b603", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzY0OWYyZTQ0NGJhZTk1ZDJiMDkzMzU0YWNlMjk2Mzg2NjkxYjYwMw==", "commit": {"author": {"name": "Iain Sandoe", "email": "iain@sandoe.co.uk", "date": "2019-07-25T18:12:03Z"}, "committer": {"name": "Iain Sandoe", "email": "iains@gcc.gnu.org", "date": "2019-07-25T18:12:03Z"}, "message": "[Darwin, testsuite] Address PR91087 - XFAIL parts of pr16855.C.\n\nThe testcase is failing to instrument part of the source because of a bug\nin the ordering of static DTORs.  It seems unlikely that this is generically\nfixable in the toolchain (and given that it's likely to be a dynamic loader\nchange would not be expected to be applied retrospectively to OS versions\nthat are out of support).  To avoid the testsuite noise, xfail the count lines\nthat don't match (we can adjust the xfails as/when the upstream bug is fixed).\n\ndejagnu xfails do not seem to work when embedded in a line like:\n  ~Test (void) { .... /* count(1) { xfail ... } */ }\nthe closing brace seems to confuse the parser.  The solution is to exapnd the\ntext onto three lines.\n\n2019-07-25  Iain Sandoe  <iain@sandoe.co.uk>\n\n\tPR gcov-profile/91087\n\t* g++.dg/gcov/pr16855.C: Xfail the count lines for the DTORs and the\n\t\"final\" line for the failure summaries.  Adjust source layout so that\n\tdejagnu xfail expressions work.\n\nFrom-SVN: r273809", "tree": {"sha": "1b39dc00f63bc83797a7c375ef3e6347d06f2cf3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1b39dc00f63bc83797a7c375ef3e6347d06f2cf3"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7649f2e444bae95d2b093354ace296386691b603", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7649f2e444bae95d2b093354ace296386691b603", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7649f2e444bae95d2b093354ace296386691b603", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7649f2e444bae95d2b093354ace296386691b603/comments", "author": {"login": "iains", "id": 4039407, "node_id": "MDQ6VXNlcjQwMzk0MDc=", "avatar_url": "https://avatars.githubusercontent.com/u/4039407?v=4", "gravatar_id": "", "url": "https://api.github.com/users/iains", "html_url": "https://github.com/iains", "followers_url": "https://api.github.com/users/iains/followers", "following_url": "https://api.github.com/users/iains/following{/other_user}", "gists_url": "https://api.github.com/users/iains/gists{/gist_id}", "starred_url": "https://api.github.com/users/iains/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/iains/subscriptions", "organizations_url": "https://api.github.com/users/iains/orgs", "repos_url": "https://api.github.com/users/iains/repos", "events_url": "https://api.github.com/users/iains/events{/privacy}", "received_events_url": "https://api.github.com/users/iains/received_events", "type": "User", "site_admin": false}, "committer": {"login": "iains", "id": 4039407, "node_id": "MDQ6VXNlcjQwMzk0MDc=", "avatar_url": "https://avatars.githubusercontent.com/u/4039407?v=4", "gravatar_id": "", "url": "https://api.github.com/users/iains", "html_url": "https://github.com/iains", "followers_url": "https://api.github.com/users/iains/followers", "following_url": "https://api.github.com/users/iains/following{/other_user}", "gists_url": "https://api.github.com/users/iains/gists{/gist_id}", "starred_url": "https://api.github.com/users/iains/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/iains/subscriptions", "organizations_url": "https://api.github.com/users/iains/orgs", "repos_url": "https://api.github.com/users/iains/repos", "events_url": "https://api.github.com/users/iains/events{/privacy}", "received_events_url": "https://api.github.com/users/iains/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "40e1ed26774b7b6c24d166489a715aa75843ab36", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/40e1ed26774b7b6c24d166489a715aa75843ab36", "html_url": "https://github.com/Rust-GCC/gccrs/commit/40e1ed26774b7b6c24d166489a715aa75843ab36"}], "stats": {"total": 17, "additions": 14, "deletions": 3}, "files": [{"sha": "6fc49316c8a57d4fda869095887169ef2a3af2a3", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7649f2e444bae95d2b093354ace296386691b603/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7649f2e444bae95d2b093354ace296386691b603/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=7649f2e444bae95d2b093354ace296386691b603", "patch": "@@ -1,3 +1,10 @@\n+2019-07-25  Iain Sandoe  <iain@sandoe.co.uk>\n+\n+\tPR gcov-profile/91087\n+\t* g++.dg/gcov/pr16855.C: Xfail the count lines for the DTORs and the\n+\t\"final\" line for the failure summaries.  Adjust source layout so that\n+\tdejagnu xfail expressions work.\n+\n 2019-07-25  Thomas Koenig  <tkoenig@gcc.gnu.org>\n \n \tPR fortran/65819"}, {"sha": "a68b05cb571c2e25230bf033de4c81176f1d6a84", "filename": "gcc/testsuite/g++.dg/gcov/pr16855.C", "status": "modified", "additions": 7, "deletions": 3, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7649f2e444bae95d2b093354ace296386691b603/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fgcov%2Fpr16855.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7649f2e444bae95d2b093354ace296386691b603/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fgcov%2Fpr16855.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fgcov%2Fpr16855.C?ref=7649f2e444bae95d2b093354ace296386691b603", "patch": "@@ -1,6 +1,8 @@\n /* { dg-options \"-fprofile-arcs -ftest-coverage\" } */\n /* { dg-do run { target native } } */\n \n+/* See PR91087 for information on Darwin xfails. */\n+\n #include <stdlib.h>\n #include <stdio.h>\n \n@@ -18,7 +20,9 @@ class Test\n {\n public:\n   Test (void) { fprintf (stderr, \"In Test::Test\\n\"); /* count(1) */ }\n-  ~Test (void) { fprintf (stderr, \"In Test::~Test\\n\"); /* count(1) */ }\n+  ~Test (void) {\n+   fprintf (stderr, \"In Test::~Test\\n\"); /* count(1) { xfail *-*-darwin* } */\n+  }\n } T1;\n \n void\n@@ -42,7 +46,7 @@ static void __attribute__ ((constructor)) ctor_default ()\n \n static void __attribute__ ((destructor)) dtor_default ()\n {\n-  fprintf (stderr, \"in destructor(())\\n\"); /* count(1) */\n+  fprintf (stderr, \"in destructor(())\\n\"); /* count(1) { xfail *-*-darwin* } */\n }\n \n-/* { dg-final { run-gcov branches { -b pr16855.C } } } */\n+/* { dg-final { run-gcov branches { -b pr16855.C } { xfail *-*-darwin* } } } */"}]}