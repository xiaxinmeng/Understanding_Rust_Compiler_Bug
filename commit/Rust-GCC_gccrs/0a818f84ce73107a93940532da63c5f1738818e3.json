{"sha": "0a818f84ce73107a93940532da63c5f1738818e3", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MGE4MThmODRjZTczMTA3YTkzOTQwNTMyZGE2M2M1ZjE3Mzg4MThlMw==", "commit": {"author": {"name": "Gavin Romig-Koch", "email": "gavin@cygnus.com", "date": "1999-08-13T18:22:59Z"}, "committer": {"name": "Gavin Romig-Koch", "email": "gavin@gcc.gnu.org", "date": "1999-08-13T18:22:59Z"}, "message": "For gcc:\n\n\ttree.c (lang_unsave_expr_now) : New.\n\t(unsave_expr_now): Call lang_unsave_expr_now.\n\ttree.h (lang_unsave_expr_now) : New.\n\nFor gcc/cp:\n\tcp-tree.h (init_cplus_unsave): New.\n\t(cplus_unsave_expr_now): New.\n\tlex.c (init_parse): Call init_cplus_unsave.\n\ttree.c (init_cplus_unsave): New.\n\t(cplus_unsave_expr_now): New.\n\nFrom-SVN: r28705", "tree": {"sha": "42b99d02c99ecd90d6223b6db07d98fd410eaa4e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/42b99d02c99ecd90d6223b6db07d98fd410eaa4e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0a818f84ce73107a93940532da63c5f1738818e3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0a818f84ce73107a93940532da63c5f1738818e3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0a818f84ce73107a93940532da63c5f1738818e3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0a818f84ce73107a93940532da63c5f1738818e3/comments", "author": null, "committer": null, "parents": [{"sha": "e3beae8c3c6ede0f96c0f49f8c456bb22786225c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e3beae8c3c6ede0f96c0f49f8c456bb22786225c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e3beae8c3c6ede0f96c0f49f8c456bb22786225c"}], "stats": {"total": 71, "additions": 70, "deletions": 1}, "files": [{"sha": "eaed9759e8ebe9d79386851413fa520f21ea0cb4", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0a818f84ce73107a93940532da63c5f1738818e3/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0a818f84ce73107a93940532da63c5f1738818e3/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=0a818f84ce73107a93940532da63c5f1738818e3", "patch": "@@ -1,3 +1,9 @@\n+Fri Aug 13 14:18:27 1999  Gavin Romig-Koch  <gavin@cygnus.com>\n+\n+\ttree.c (lang_unsave_expr_now) : New.\n+\t(unsave_expr_now): Call lang_unsave_expr_now.\n+\ttree.h (lang_unsave_expr_now) : New.\n+\n Fri Aug 13 00:49:46 1999  Jason Merrill  <jason@yorick.cygnus.com>\n \n \t* toplev.c (flag_new_exceptions): On by default."}, {"sha": "3653b79b895439fa5ad483635b0abb184a45117a", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0a818f84ce73107a93940532da63c5f1738818e3/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0a818f84ce73107a93940532da63c5f1738818e3/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=0a818f84ce73107a93940532da63c5f1738818e3", "patch": "@@ -1,3 +1,11 @@\n+1999-08-13  Gavin Romig-Koch  <gavin@cygnus.com>\n+\n+\tcp-tree.h (init_cplus_unsave): New.\n+\t(cplus_unsave_expr_now): New.\n+\tlex.c (init_parse): Call init_cplus_unsave.\n+\ttree.c (init_cplus_unsave): New.\n+\t(cplus_unsave_expr_now): New.\n+\n 1999-08-11  Jason Merrill  <jason@yorick.cygnus.com>\n \n \t* lang-options.h: Add -fms-extensions."}, {"sha": "2e58406a77e0735654c47c61a297cb6fbdd208bd", "filename": "gcc/cp/cp-tree.h", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0a818f84ce73107a93940532da63c5f1738818e3/gcc%2Fcp%2Fcp-tree.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0a818f84ce73107a93940532da63c5f1738818e3/gcc%2Fcp%2Fcp-tree.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fcp-tree.h?ref=0a818f84ce73107a93940532da63c5f1738818e3", "patch": "@@ -3350,6 +3350,8 @@ extern int yylex\t\t\t\tPROTO((void));\n extern tree arbitrate_lookup\t\t\tPROTO((tree, tree, tree));\n \n /* in tree.c */\n+extern void init_cplus_unsave\t\t\tPROTO((void));\n+extern tree cplus_unsave_expr_now               PROTO((tree));\n extern int pod_type_p\t\t\t\tPROTO((tree));\n extern void unshare_base_binfos\t\t\tPROTO((tree));\n extern int member_p\t\t\t\tPROTO((tree));"}, {"sha": "a92a4f375a66d372cabb7b89f6fa481ce5c43b28", "filename": "gcc/cp/lex.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0a818f84ce73107a93940532da63c5f1738818e3/gcc%2Fcp%2Flex.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0a818f84ce73107a93940532da63c5f1738818e3/gcc%2Fcp%2Flex.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Flex.c?ref=0a818f84ce73107a93940532da63c5f1738818e3", "patch": "@@ -524,6 +524,7 @@ init_parse (filename)\n   set_identifier_size (sizeof (struct lang_identifier));\n   decl_printable_name = lang_printable_name;\n \n+  init_cplus_unsave ();\n   init_cplus_expand ();\n \n   bcopy (cplus_tree_code_type,"}, {"sha": "a6bbbe00afd87c4cf8813b57d935b47d2c868944", "filename": "gcc/cp/tree.c", "status": "modified", "additions": 38, "deletions": 0, "changes": 38, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0a818f84ce73107a93940532da63c5f1738818e3/gcc%2Fcp%2Ftree.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0a818f84ce73107a93940532da63c5f1738818e3/gcc%2Fcp%2Ftree.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ftree.c?ref=0a818f84ce73107a93940532da63c5f1738818e3", "patch": "@@ -2859,3 +2859,41 @@ make_ptrmem_cst (type, member)\n   return ptrmem_cst;\n }\n \n+/* Initialize unsave for C++. */\n+void\n+init_cplus_unsave ()\n+{\n+  lang_unsave_expr_now = cplus_unsave_expr_now;\n+}\n+\n+/* The C++ version of unsave_expr_now.\n+   See gcc/tree.c:unsave_expr_now for comments. */\n+\n+tree\n+cplus_unsave_expr_now (expr)\n+     tree expr;\n+{\n+  if (expr == NULL)\n+    return expr;\n+\n+  else if (TREE_CODE (expr) == AGGR_INIT_EXPR)\n+    {\n+      unsave_expr_now (TREE_OPERAND (expr,0));\n+      if (TREE_OPERAND (expr, 1)\n+\t  && TREE_CODE (TREE_OPERAND (expr, 1)) == TREE_LIST)\n+\t{\n+\t  tree exp = TREE_OPERAND (expr, 1);\n+\t  while (exp)\n+\t    {\n+\t      unsave_expr_now (TREE_VALUE (exp));\n+\t      exp = TREE_CHAIN (exp);\n+\t    }\n+\t}\n+      unsave_expr_now (TREE_OPERAND (expr,2));\n+      return expr;\n+    }\n+\n+  else\n+    return expr;\n+}\n+"}, {"sha": "2516301ba54028fa57d8600a9f55b44daefcc0d6", "filename": "gcc/tree.c", "status": "modified", "additions": 11, "deletions": 1, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0a818f84ce73107a93940532da63c5f1738818e3/gcc%2Ftree.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0a818f84ce73107a93940532da63c5f1738818e3/gcc%2Ftree.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree.c?ref=0a818f84ce73107a93940532da63c5f1738818e3", "patch": "@@ -269,6 +269,10 @@ static void build_real_from_int_cst_1 PROTO((PTR));\n extern char *mode_name[];\n \n void gcc_obstack_init ();\n+\n+/* If non-null, a language specific helper for unsave_expr_now. */\n+\n+int (*lang_unsave_expr_now) PROTO((tree));\n \f\n /* Init the principal obstacks.  */\n \n@@ -2426,7 +2430,11 @@ first_rtl_op (code)\n }\n \n /* Modify a tree in place so that all the evaluate only once things\n-   are cleared out.  Return the EXPR given.  */\n+   are cleared out.  Return the EXPR given.  \n+\n+   LANG_UNSAVE_EXPR_NOW, if set, is a pointer to a function to handle\n+   language specific nodes.\n+*/\n \n tree\n unsave_expr_now (expr)\n@@ -2473,6 +2481,8 @@ unsave_expr_now (expr)\n       break;\n \n     default:\n+      if (lang_unsave_expr_now)\n+\t(*lang_unsave_expr_now) (expr);\n       break;\n     }\n "}, {"sha": "08d457012107890068f67b66b7f328f57fcfa993", "filename": "gcc/tree.h", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0a818f84ce73107a93940532da63c5f1738818e3/gcc%2Ftree.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0a818f84ce73107a93940532da63c5f1738818e3/gcc%2Ftree.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree.h?ref=0a818f84ce73107a93940532da63c5f1738818e3", "patch": "@@ -1714,6 +1714,10 @@ extern tree unsave_expr\t\t\tPROTO((tree));\n \n extern tree unsave_expr_now\t\tPROTO((tree));\n \n+/* If non-null, a language specific helper for unsave_expr_now. */\n+\n+extern int (*lang_unsave_expr_now)      PROTO((tree));\n+  \n /* Return 1 if EXP contains a PLACEHOLDER_EXPR; i.e., if it represents a size\n    or offset that depends on a field within a record.\n "}]}