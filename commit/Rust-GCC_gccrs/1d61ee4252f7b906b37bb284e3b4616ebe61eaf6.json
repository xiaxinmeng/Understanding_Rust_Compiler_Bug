{"sha": "1d61ee4252f7b906b37bb284e3b4616ebe61eaf6", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWQ2MWVlNDI1MmY3YjkwNmIzN2JiMjg0ZTNiNDYxNmViZTYxZWFmNg==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2012-09-18T13:03:09Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2012-09-18T13:03:09Z"}, "message": "re PR tree-optimization/54610 (FAIL: gcc.dg/tree-ssa/forwprop-22.c (internal compiler error) on x86 AVX targets)\n\n\tPR tree-optimization/54610\n\t* tree-ssa-forwprop.c: Include optabs.h.  Don't include\n\ttree-vectorizer.h.\n\t(simplify_vector_constructor): Don't use vect_gen_perm_mask,\n\tinstead create the mask constant here.\n\t* Makefile.in (tree-ssa-forwprop.o): Depend on $(OPTABS_H).\n\tDon't depend on $(TREE_VECTORIZER_H).\n\n\t* gcc.target/i386/pr54610.c: New test.\n\nFrom-SVN: r191421", "tree": {"sha": "c2579f37de05ea800ee4f7725ecdcacb4e090e03", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c2579f37de05ea800ee4f7725ecdcacb4e090e03"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1d61ee4252f7b906b37bb284e3b4616ebe61eaf6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1d61ee4252f7b906b37bb284e3b4616ebe61eaf6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1d61ee4252f7b906b37bb284e3b4616ebe61eaf6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1d61ee4252f7b906b37bb284e3b4616ebe61eaf6/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "6889a65081852d52914d24abd76f3a227a2929c5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6889a65081852d52914d24abd76f3a227a2929c5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6889a65081852d52914d24abd76f3a227a2929c5"}], "stats": {"total": 39, "additions": 32, "deletions": 7}, "files": [{"sha": "73b828de03f30f415ffe818db44e1ee039bf8a4b", "filename": "gcc/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1d61ee4252f7b906b37bb284e3b4616ebe61eaf6/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1d61ee4252f7b906b37bb284e3b4616ebe61eaf6/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=1d61ee4252f7b906b37bb284e3b4616ebe61eaf6", "patch": "@@ -1,3 +1,13 @@\n+2012-09-18  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR tree-optimization/54610\n+\t* tree-ssa-forwprop.c: Include optabs.h.  Don't include\n+\ttree-vectorizer.h.\n+\t(simplify_vector_constructor): Don't use vect_gen_perm_mask,\n+\tinstead create the mask constant here.\n+\t* Makefile.in (tree-ssa-forwprop.o): Depend on $(OPTABS_H).\n+\tDon't depend on $(TREE_VECTORIZER_H).\n+\n 2012-09-18  Florian Weimer  <fweimer@redhat.com>\n \n \t* Makefile.in (BASIC_BLOCK_H): Add cfg-flags.def."}, {"sha": "d0412b8fca0f23f9dd1db31c20a7c9cf3a581b7d", "filename": "gcc/Makefile.in", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1d61ee4252f7b906b37bb284e3b4616ebe61eaf6/gcc%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1d61ee4252f7b906b37bb284e3b4616ebe61eaf6/gcc%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FMakefile.in?ref=1d61ee4252f7b906b37bb284e3b4616ebe61eaf6", "patch": "@@ -2246,7 +2246,7 @@ tree-ssa-forwprop.o : tree-ssa-forwprop.c $(CONFIG_H) $(SYSTEM_H) coretypes.h \\\n    $(TM_H) $(TREE_H) $(TM_P_H) $(BASIC_BLOCK_H) $(CFGLOOP_H) \\\n    $(TREE_FLOW_H) $(TREE_PASS_H) $(DIAGNOSTIC_H) \\\n    langhooks.h $(FLAGS_H) $(GIMPLE_H) $(GIMPLE_PRETTY_PRINT_H) $(EXPR_H) \\\n-   $(TREE_VECTORIZER_H)\n+   $(OPTABS_H)\n tree-ssa-phiprop.o : tree-ssa-phiprop.c $(CONFIG_H) $(SYSTEM_H) coretypes.h \\\n    $(TM_H) $(TREE_H) $(TM_P_H) $(BASIC_BLOCK_H) \\\n    $(TREE_FLOW_H) $(TREE_PASS_H) $(DIAGNOSTIC_H) \\"}, {"sha": "208a6d23d42f99af10718ce36bf51e03c5f6e12b", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1d61ee4252f7b906b37bb284e3b4616ebe61eaf6/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1d61ee4252f7b906b37bb284e3b4616ebe61eaf6/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=1d61ee4252f7b906b37bb284e3b4616ebe61eaf6", "patch": "@@ -1,3 +1,8 @@\n+2012-09-18  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR tree-optimization/54610\n+\t* gcc.target/i386/pr54610.c: New test.\n+\n 2012-09-17  Jason Merrill  <jason@redhat.com>\n \n \tPR c++/54575"}, {"sha": "a1628327a84afefa0515d63d60af36df702a619d", "filename": "gcc/tree-ssa-forwprop.c", "status": "modified", "additions": 16, "deletions": 6, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1d61ee4252f7b906b37bb284e3b4616ebe61eaf6/gcc%2Ftree-ssa-forwprop.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1d61ee4252f7b906b37bb284e3b4616ebe61eaf6/gcc%2Ftree-ssa-forwprop.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-forwprop.c?ref=1d61ee4252f7b906b37bb284e3b4616ebe61eaf6", "patch": "@@ -33,7 +33,7 @@ along with GCC; see the file COPYING3.  If not see\n #include \"gimple.h\"\n #include \"expr.h\"\n #include \"cfgloop.h\"\n-#include \"tree-vectorizer.h\"\n+#include \"optabs.h\"\n \n /* This pass propagates the RHS of assignment statements into use\n    sites of the LHS of the assignment.  It's basically a specialized\n@@ -2854,14 +2854,24 @@ simplify_vector_constructor (gimple_stmt_iterator *gsi)\n     return false;\n \n   if (maybe_ident)\n-    {\n-      gimple_assign_set_rhs_from_tree (gsi, orig);\n-    }\n+    gimple_assign_set_rhs_from_tree (gsi, orig);\n   else\n     {\n-      op2 = vect_gen_perm_mask (type, sel);\n-      if (!op2)\n+      tree mask_type, *mask_elts;\n+\n+      if (!can_vec_perm_p (TYPE_MODE (type), false, sel))\n+\treturn false;\n+      mask_type\n+\t= build_vector_type (build_nonstandard_integer_type (elem_size, 1),\n+\t\t\t     nelts);\n+      if (GET_MODE_CLASS (TYPE_MODE (mask_type)) != MODE_VECTOR_INT\n+\t  || GET_MODE_SIZE (TYPE_MODE (mask_type))\n+\t     != GET_MODE_SIZE (TYPE_MODE (type)))\n \treturn false;\n+      mask_elts = XALLOCAVEC (tree, nelts);\n+      for (i = 0; i < nelts; i++)\n+\tmask_elts[i] = build_int_cst (TREE_TYPE (mask_type), sel[i]);\n+      op2 = build_vector (mask_type, mask_elts);\n       gimple_assign_set_rhs_with_ops_1 (gsi, VEC_PERM_EXPR, orig, orig, op2);\n     }\n   update_stmt (gsi_stmt (*gsi));"}]}