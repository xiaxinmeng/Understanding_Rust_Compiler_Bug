{"sha": "9a45ffbd122d77a87c49d05b936a9d162625c5d8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWE0NWZmYmQxMjJkNzdhODdjNDlkMDViOTM2YTlkMTYyNjI1YzVkOA==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2017-10-20T07:32:35Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2017-10-20T07:32:35Z"}, "message": "re PR sanitizer/82595 (bootstrap fails in libsanitizer on powerpc64-unknown-linux-gnu)\n\n\tPR sanitizer/82595\n\t* config/gnu-user.h (LIBTSAN_EARLY_SPEC): Add libtsan_preinit.o\n\tfor -fsanitize=thread link of executables.\n\t(LIBLSAN_EARLY_SPEC): Add liblsan_preinit.o for -fsanitize=leak\n\tlink of executables.\n\n\t* lsan/lsan.h (__lsan_init): Add SANITIZER_INTERFACE_ATTRIBUTE.\n\t* lsan/Makefile.am (nodist_toolexeclib_HEADERS): Add\n\tliblsan_preinit.o.\n\t(lsan_files): Remove lsan_preinit.cc.\n\t(liblsan_preinit.o): New rule.\n\t* lsan/Makefile.in: Regenerated.\n\nFrom-SVN: r253925", "tree": {"sha": "5c81a4874ff7da20df3a73e552be535591c93a64", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5c81a4874ff7da20df3a73e552be535591c93a64"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9a45ffbd122d77a87c49d05b936a9d162625c5d8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9a45ffbd122d77a87c49d05b936a9d162625c5d8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9a45ffbd122d77a87c49d05b936a9d162625c5d8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9a45ffbd122d77a87c49d05b936a9d162625c5d8/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "42a764f76f14ce2718d30459dc140d1410ef118e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/42a764f76f14ce2718d30459dc140d1410ef118e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/42a764f76f14ce2718d30459dc140d1410ef118e"}], "stats": {"total": 91, "additions": 71, "deletions": 20}, "files": [{"sha": "f28e70a37766fc1a8b384b14f4aa1ec6df210697", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9a45ffbd122d77a87c49d05b936a9d162625c5d8/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9a45ffbd122d77a87c49d05b936a9d162625c5d8/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=9a45ffbd122d77a87c49d05b936a9d162625c5d8", "patch": "@@ -1,5 +1,11 @@\n 2017-10-20  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR sanitizer/82595\n+\t* config/gnu-user.h (LIBTSAN_EARLY_SPEC): Add libtsan_preinit.o\n+\tfor -fsanitize=thread link of executables.\n+\t(LIBLSAN_EARLY_SPEC): Add liblsan_preinit.o for -fsanitize=leak\n+\tlink of executables.\n+\n \tPR target/82370\n \t* config/i386/sse.md (VI248_AVX2, VI248_AVX512BW, VI248_AVX512BW_2):\n \tNew mode iterators."}, {"sha": "df17b18090696641d23b4bb157a49963e211e31d", "filename": "gcc/config/gnu-user.h", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9a45ffbd122d77a87c49d05b936a9d162625c5d8/gcc%2Fconfig%2Fgnu-user.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9a45ffbd122d77a87c49d05b936a9d162625c5d8/gcc%2Fconfig%2Fgnu-user.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fgnu-user.h?ref=9a45ffbd122d77a87c49d05b936a9d162625c5d8", "patch": "@@ -162,11 +162,13 @@ see the files COPYING3 and COPYING.RUNTIME respectively.  If not, see\n   LD_STATIC_OPTION \" --whole-archive -lasan --no-whole-archive \" \\\n   LD_DYNAMIC_OPTION \"}}%{!static-libasan:-lasan}\"\n #undef LIBTSAN_EARLY_SPEC\n-#define LIBTSAN_EARLY_SPEC \"%{static-libtsan:%{!shared:\" \\\n+#define LIBTSAN_EARLY_SPEC \"%{!shared:libtsan_preinit%O%s} \" \\\n+  \"%{static-libtsan:%{!shared:\" \\\n   LD_STATIC_OPTION \" --whole-archive -ltsan --no-whole-archive \" \\\n   LD_DYNAMIC_OPTION \"}}%{!static-libtsan:-ltsan}\"\n #undef LIBLSAN_EARLY_SPEC\n-#define LIBLSAN_EARLY_SPEC \"%{static-liblsan:%{!shared:\" \\\n+#define LIBLSAN_EARLY_SPEC \"%{!shared:liblsan_preinit%O%s} \" \\\n+  \"%{static-liblsan:%{!shared:\" \\\n   LD_STATIC_OPTION \" --whole-archive -llsan --no-whole-archive \" \\\n   LD_DYNAMIC_OPTION \"}}%{!static-liblsan:-llsan}\"\n #endif"}, {"sha": "63e71317cbfb979af5efb1962270a3c34b440f85", "filename": "libsanitizer/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9a45ffbd122d77a87c49d05b936a9d162625c5d8/libsanitizer%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9a45ffbd122d77a87c49d05b936a9d162625c5d8/libsanitizer%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libsanitizer%2FChangeLog?ref=9a45ffbd122d77a87c49d05b936a9d162625c5d8", "patch": "@@ -1,3 +1,13 @@\n+2017-10-20  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR sanitizer/82595\n+\t* lsan/lsan.h (__lsan_init): Add SANITIZER_INTERFACE_ATTRIBUTE.\n+\t* lsan/Makefile.am (nodist_toolexeclib_HEADERS): Add\n+\tliblsan_preinit.o.\n+\t(lsan_files): Remove lsan_preinit.cc.\n+\t(liblsan_preinit.o): New rule.\n+\t* lsan/Makefile.in: Regenerated.\n+\n 2017-10-19  Jakub Jelinek  <jakub@redhat.com>\n \n \t* All source files: Merge from upstream 315899."}, {"sha": "700d15fce57c3a2fe55cfcf555947010bc7ed0e8", "filename": "libsanitizer/lsan/Makefile.am", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9a45ffbd122d77a87c49d05b936a9d162625c5d8/libsanitizer%2Flsan%2FMakefile.am", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9a45ffbd122d77a87c49d05b936a9d162625c5d8/libsanitizer%2Flsan%2FMakefile.am", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libsanitizer%2Flsan%2FMakefile.am?ref=9a45ffbd122d77a87c49d05b936a9d162625c5d8", "patch": "@@ -12,6 +12,7 @@ ACLOCAL_AMFLAGS = -I m4\n noinst_LTLIBRARIES = libsanitizer_lsan.la\n if LSAN_SUPPORTED\n toolexeclib_LTLIBRARIES = liblsan.la\n+nodist_toolexeclib_HEADERS = liblsan_preinit.o\n endif\n \n sanitizer_lsan_files = \\\n@@ -27,7 +28,6 @@ lsan_files = \\\n \tlsan_malloc_mac.cc \\\n \tlsan_allocator.cc \\\n \tlsan_interceptors.cc \\\n-\tlsan_preinit.cc \\\n \tlsan_thread.cc\n \n libsanitizer_lsan_la_SOURCES = $(sanitizer_lsan_files)\n@@ -40,6 +40,9 @@ endif\n liblsan_la_LIBADD += $(LIBSTDCXX_RAW_CXX_LDFLAGS)\n liblsan_la_LDFLAGS = -version-info `grep -v '^\\#' $(srcdir)/libtool-version` $(link_liblsan)\n \n+liblsan_preinit.o: lsan_preinit.o\n+\tcp $< $@\n+\n # Work around what appears to be a GNU make bug handling MAKEFLAGS\n # values defined in terms of make variables, as is the case for CC and\n # friends when we are called from the top level Makefile."}, {"sha": "85502500728bb14d67a644b663920a5468382b98", "filename": "libsanitizer/lsan/Makefile.in", "status": "modified", "additions": 46, "deletions": 16, "changes": 62, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9a45ffbd122d77a87c49d05b936a9d162625c5d8/libsanitizer%2Flsan%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9a45ffbd122d77a87c49d05b936a9d162625c5d8/libsanitizer%2Flsan%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libsanitizer%2Flsan%2FMakefile.in?ref=9a45ffbd122d77a87c49d05b936a9d162625c5d8", "patch": "@@ -15,6 +15,7 @@\n \n @SET_MAKE@\n \n+\n VPATH = @srcdir@\n am__make_dryrun = \\\n   { \\\n@@ -100,7 +101,8 @@ am__uninstall_files_from_dir = { \\\n     || { echo \" ( cd '$$dir' && rm -f\" $$files \")\"; \\\n          $(am__cd) \"$$dir\" && rm -f $$files; }; \\\n   }\n-am__installdirs = \"$(DESTDIR)$(toolexeclibdir)\"\n+am__installdirs = \"$(DESTDIR)$(toolexeclibdir)\" \\\n+\t\"$(DESTDIR)$(toolexeclibdir)\"\n LTLIBRARIES = $(noinst_LTLIBRARIES) $(toolexeclib_LTLIBRARIES)\n am__DEPENDENCIES_1 =\n liblsan_la_DEPENDENCIES =  \\\n@@ -110,7 +112,7 @@ liblsan_la_DEPENDENCIES =  \\\n am__objects_1 = lsan_common.lo lsan_common_linux.lo lsan_common_mac.lo\n am__objects_2 = $(am__objects_1) lsan.lo lsan_linux.lo lsan_mac.lo \\\n \tlsan_malloc_mac.lo lsan_allocator.lo lsan_interceptors.lo \\\n-\tlsan_preinit.lo lsan_thread.lo\n+\tlsan_thread.lo\n am_liblsan_la_OBJECTS = $(am__objects_2)\n liblsan_la_OBJECTS = $(am_liblsan_la_OBJECTS)\n liblsan_la_LINK = $(LIBTOOL) --tag=CXX $(AM_LIBTOOLFLAGS) \\\n@@ -139,6 +141,7 @@ am__can_run_installinfo = \\\n     n|no|NO) false;; \\\n     *) (install-info --version) >/dev/null 2>&1;; \\\n   esac\n+HEADERS = $(nodist_toolexeclib_HEADERS)\n ETAGS = etags\n CTAGS = ctags\n ACLOCAL = @ACLOCAL@\n@@ -298,6 +301,7 @@ AM_CXXFLAGS = -Wall -W -Wno-unused-parameter -Wwrite-strings -pedantic \\\n ACLOCAL_AMFLAGS = -I m4\n noinst_LTLIBRARIES = libsanitizer_lsan.la\n @LSAN_SUPPORTED_TRUE@toolexeclib_LTLIBRARIES = liblsan.la\n+@LSAN_SUPPORTED_TRUE@nodist_toolexeclib_HEADERS = liblsan_preinit.o\n sanitizer_lsan_files = \\\n \tlsan_common.cc \\\n \tlsan_common_linux.cc \\\n@@ -311,7 +315,6 @@ lsan_files = \\\n \tlsan_malloc_mac.cc \\\n \tlsan_allocator.cc \\\n \tlsan_interceptors.cc \\\n-\tlsan_preinit.cc \\\n \tlsan_thread.cc\n \n libsanitizer_lsan_la_SOURCES = $(sanitizer_lsan_files)\n@@ -456,7 +459,6 @@ distclean-compile:\n @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/lsan_linux.Plo@am__quote@\n @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/lsan_mac.Plo@am__quote@\n @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/lsan_malloc_mac.Plo@am__quote@\n-@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/lsan_preinit.Plo@am__quote@\n @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/lsan_thread.Plo@am__quote@\n \n .cc.o:\n@@ -485,6 +487,27 @@ mostlyclean-libtool:\n \n clean-libtool:\n \t-rm -rf .libs _libs\n+install-nodist_toolexeclibHEADERS: $(nodist_toolexeclib_HEADERS)\n+\t@$(NORMAL_INSTALL)\n+\t@list='$(nodist_toolexeclib_HEADERS)'; test -n \"$(toolexeclibdir)\" || list=; \\\n+\tif test -n \"$$list\"; then \\\n+\t  echo \" $(MKDIR_P) '$(DESTDIR)$(toolexeclibdir)'\"; \\\n+\t  $(MKDIR_P) \"$(DESTDIR)$(toolexeclibdir)\" || exit 1; \\\n+\tfi; \\\n+\tfor p in $$list; do \\\n+\t  if test -f \"$$p\"; then d=; else d=\"$(srcdir)/\"; fi; \\\n+\t  echo \"$$d$$p\"; \\\n+\tdone | $(am__base_list) | \\\n+\twhile read files; do \\\n+\t  echo \" $(INSTALL_HEADER) $$files '$(DESTDIR)$(toolexeclibdir)'\"; \\\n+\t  $(INSTALL_HEADER) $$files \"$(DESTDIR)$(toolexeclibdir)\" || exit $$?; \\\n+\tdone\n+\n+uninstall-nodist_toolexeclibHEADERS:\n+\t@$(NORMAL_UNINSTALL)\n+\t@list='$(nodist_toolexeclib_HEADERS)'; test -n \"$(toolexeclibdir)\" || list=; \\\n+\tfiles=`for p in $$list; do echo $$p; done | sed -e 's|^.*/||'`; \\\n+\tdir='$(DESTDIR)$(toolexeclibdir)'; $(am__uninstall_files_from_dir)\n \n ID: $(HEADERS) $(SOURCES) $(LISP) $(TAGS_FILES)\n \tlist='$(SOURCES) $(HEADERS) $(LISP) $(TAGS_FILES)'; \\\n@@ -539,9 +562,9 @@ distclean-tags:\n \t-rm -f TAGS ID GTAGS GRTAGS GSYMS GPATH tags\n check-am: all-am\n check: check-am\n-all-am: Makefile $(LTLIBRARIES)\n+all-am: Makefile $(LTLIBRARIES) $(HEADERS)\n installdirs:\n-\tfor dir in \"$(DESTDIR)$(toolexeclibdir)\"; do \\\n+\tfor dir in \"$(DESTDIR)$(toolexeclibdir)\" \"$(DESTDIR)$(toolexeclibdir)\"; do \\\n \t  test -z \"$$dir\" || $(MKDIR_P) \"$$dir\"; \\\n \tdone\n install: install-am\n@@ -603,7 +626,8 @@ install-dvi: install-dvi-am\n \n install-dvi-am:\n \n-install-exec-am: install-toolexeclibLTLIBRARIES\n+install-exec-am: install-nodist_toolexeclibHEADERS \\\n+\tinstall-toolexeclibLTLIBRARIES\n \n install-html: install-html-am\n \n@@ -643,7 +667,8 @@ ps: ps-am\n \n ps-am:\n \n-uninstall-am: uninstall-toolexeclibLTLIBRARIES\n+uninstall-am: uninstall-nodist_toolexeclibHEADERS \\\n+\tuninstall-toolexeclibLTLIBRARIES\n \n .MAKE: install-am install-strip\n \n@@ -654,14 +679,19 @@ uninstall-am: uninstall-toolexeclibLTLIBRARIES\n \thtml html-am info info-am install install-am install-data \\\n \tinstall-data-am install-dvi install-dvi-am install-exec \\\n \tinstall-exec-am install-html install-html-am install-info \\\n-\tinstall-info-am install-man install-pdf install-pdf-am \\\n-\tinstall-ps install-ps-am install-strip \\\n-\tinstall-toolexeclibLTLIBRARIES installcheck installcheck-am \\\n-\tinstalldirs maintainer-clean maintainer-clean-generic \\\n-\tmostlyclean mostlyclean-compile mostlyclean-generic \\\n-\tmostlyclean-libtool pdf pdf-am ps ps-am tags uninstall \\\n-\tuninstall-am uninstall-toolexeclibLTLIBRARIES\n-\n+\tinstall-info-am install-man install-nodist_toolexeclibHEADERS \\\n+\tinstall-pdf install-pdf-am install-ps install-ps-am \\\n+\tinstall-strip install-toolexeclibLTLIBRARIES installcheck \\\n+\tinstallcheck-am installdirs maintainer-clean \\\n+\tmaintainer-clean-generic mostlyclean mostlyclean-compile \\\n+\tmostlyclean-generic mostlyclean-libtool pdf pdf-am ps ps-am \\\n+\ttags uninstall uninstall-am \\\n+\tuninstall-nodist_toolexeclibHEADERS \\\n+\tuninstall-toolexeclibLTLIBRARIES\n+\n+\n+liblsan_preinit.o: lsan_preinit.o\n+\tcp $< $@\n \n # Tell versions [3.59,3.63) of GNU make to not export all variables.\n # Otherwise a system limit (for SysV at least) may be exceeded."}, {"sha": "42d4214ed0fda15607b4e417ab03de10e427da86", "filename": "libsanitizer/lsan/lsan.h", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9a45ffbd122d77a87c49d05b936a9d162625c5d8/libsanitizer%2Flsan%2Flsan.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9a45ffbd122d77a87c49d05b936a9d162625c5d8/libsanitizer%2Flsan%2Flsan.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libsanitizer%2Flsan%2Flsan.h?ref=9a45ffbd122d77a87c49d05b936a9d162625c5d8", "patch": "@@ -64,4 +64,4 @@ void GetStackTraceWithPcBpAndContext(__sanitizer::BufferedStackTrace *stack,\n extern bool lsan_inited;\n extern bool lsan_init_is_running;\n \n-extern \"C\" void __lsan_init();\n+extern \"C\" SANITIZER_INTERFACE_ATTRIBUTE void __lsan_init();"}]}