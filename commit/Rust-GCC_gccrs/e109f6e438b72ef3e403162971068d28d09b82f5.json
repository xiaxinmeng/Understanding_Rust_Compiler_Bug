{"sha": "e109f6e438b72ef3e403162971068d28d09b82f5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTEwOWY2ZTQzOGI3MmVmM2U0MDMxNjI5NzEwNjhkMjhkMDliODJmNQ==", "commit": {"author": {"name": "Ian Lance Taylor", "email": "iant@golang.org", "date": "2020-07-10T20:43:09Z"}, "committer": {"name": "Ian Lance Taylor", "email": "iant@golang.org", "date": "2020-07-11T19:41:28Z"}, "message": "compiler: avoid generating unnamed bool type descriptor\n\nWe were generating it in cases where a boolean expression was\nconverted directly to an empty interface type.\n\nFixes golang/go#40152\n\nReviewed-on: https://go-review.googlesource.com/c/gofrontend/+/242002", "tree": {"sha": "8ead189e618f8ef1456c8b02c81de0cc1585d8a6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8ead189e618f8ef1456c8b02c81de0cc1585d8a6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e109f6e438b72ef3e403162971068d28d09b82f5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e109f6e438b72ef3e403162971068d28d09b82f5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e109f6e438b72ef3e403162971068d28d09b82f5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e109f6e438b72ef3e403162971068d28d09b82f5/comments", "author": {"login": "ianlancetaylor", "id": 3194333, "node_id": "MDQ6VXNlcjMxOTQzMzM=", "avatar_url": "https://avatars.githubusercontent.com/u/3194333?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ianlancetaylor", "html_url": "https://github.com/ianlancetaylor", "followers_url": "https://api.github.com/users/ianlancetaylor/followers", "following_url": "https://api.github.com/users/ianlancetaylor/following{/other_user}", "gists_url": "https://api.github.com/users/ianlancetaylor/gists{/gist_id}", "starred_url": "https://api.github.com/users/ianlancetaylor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ianlancetaylor/subscriptions", "organizations_url": "https://api.github.com/users/ianlancetaylor/orgs", "repos_url": "https://api.github.com/users/ianlancetaylor/repos", "events_url": "https://api.github.com/users/ianlancetaylor/events{/privacy}", "received_events_url": "https://api.github.com/users/ianlancetaylor/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ianlancetaylor", "id": 3194333, "node_id": "MDQ6VXNlcjMxOTQzMzM=", "avatar_url": "https://avatars.githubusercontent.com/u/3194333?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ianlancetaylor", "html_url": "https://github.com/ianlancetaylor", "followers_url": "https://api.github.com/users/ianlancetaylor/followers", "following_url": "https://api.github.com/users/ianlancetaylor/following{/other_user}", "gists_url": "https://api.github.com/users/ianlancetaylor/gists{/gist_id}", "starred_url": "https://api.github.com/users/ianlancetaylor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ianlancetaylor/subscriptions", "organizations_url": "https://api.github.com/users/ianlancetaylor/orgs", "repos_url": "https://api.github.com/users/ianlancetaylor/repos", "events_url": "https://api.github.com/users/ianlancetaylor/events{/privacy}", "received_events_url": "https://api.github.com/users/ianlancetaylor/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e7d6d8f9f7b687c8e7438523d7d6f7a539ec7287", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e7d6d8f9f7b687c8e7438523d7d6f7a539ec7287", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e7d6d8f9f7b687c8e7438523d7d6f7a539ec7287"}], "stats": {"total": 22, "additions": 15, "deletions": 7}, "files": [{"sha": "7bec9a8a78e022a81ba9e2a28e5ae2381e423b8d", "filename": "gcc/go/gofrontend/MERGE", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e109f6e438b72ef3e403162971068d28d09b82f5/gcc%2Fgo%2Fgofrontend%2FMERGE", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e109f6e438b72ef3e403162971068d28d09b82f5/gcc%2Fgo%2Fgofrontend%2FMERGE", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgo%2Fgofrontend%2FMERGE?ref=e109f6e438b72ef3e403162971068d28d09b82f5", "patch": "@@ -1,4 +1,4 @@\n-ce70fa16a73e3f162de01deab6b5d17783e6b76b\n+9703ad5fa23ca63062cb403bd12bc7da4d7845bd\n \n The first line of this file holds the git revision number of the last\n merge done from the gofrontend repository."}, {"sha": "327f9403b39d8665342f8d0fa5a348a9e7707bd8", "filename": "gcc/go/gofrontend/expressions.cc", "status": "modified", "additions": 1, "deletions": 4, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e109f6e438b72ef3e403162971068d28d09b82f5/gcc%2Fgo%2Fgofrontend%2Fexpressions.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e109f6e438b72ef3e403162971068d28d09b82f5/gcc%2Fgo%2Fgofrontend%2Fexpressions.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgo%2Fgofrontend%2Fexpressions.cc?ref=e109f6e438b72ef3e403162971068d28d09b82f5", "patch": "@@ -6041,10 +6041,7 @@ Binary_expression::do_lower(Gogo* gogo, Named_object*,\n \t\t\t\t\t\t     &right_nc, location,\n \t\t\t\t\t\t     &result))\n \t      return this;\n-\t    return Expression::make_cast(Type::make_boolean_type(),\n-\t\t\t\t\t Expression::make_boolean(result,\n-\t\t\t\t\t\t\t\t  location),\n-\t\t\t\t\t location);\n+\t    return Expression::make_boolean(result, location);\n \t  }\n \telse\n \t  {"}, {"sha": "c1021e5679c1b53cdecf3d54213025afa7201264", "filename": "gcc/go/gofrontend/gogo.cc", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e109f6e438b72ef3e403162971068d28d09b82f5/gcc%2Fgo%2Fgofrontend%2Fgogo.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e109f6e438b72ef3e403162971068d28d09b82f5/gcc%2Fgo%2Fgofrontend%2Fgogo.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgo%2Fgofrontend%2Fgogo.cc?ref=e109f6e438b72ef3e403162971068d28d09b82f5", "patch": "@@ -3309,7 +3309,11 @@ Remove_deadcode::expression(Expression** pexpr)\n       && be->boolean_constant_value(&bval)\n       && (be->op() == OPERATOR_ANDAND\n           || be->op() == OPERATOR_OROR))\n-    *pexpr = Expression::make_boolean(bval, be->location());\n+    {\n+      *pexpr = Expression::make_boolean(bval, be->location());\n+      Type_context context(NULL, false);\n+      (*pexpr)->determine_type(&context);\n+    }\n   return TRAVERSE_CONTINUE;\n }\n "}, {"sha": "1f0a54502dbad729d1c7d574aa490896c1c6125d", "filename": "gcc/go/gofrontend/names.cc", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e109f6e438b72ef3e403162971068d28d09b82f5/gcc%2Fgo%2Fgofrontend%2Fnames.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e109f6e438b72ef3e403162971068d28d09b82f5/gcc%2Fgo%2Fgofrontend%2Fnames.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgo%2Fgofrontend%2Fnames.cc?ref=e109f6e438b72ef3e403162971068d28d09b82f5", "patch": "@@ -975,7 +975,14 @@ Gogo::type_descriptor_name(const Type* type, Named_type* nt)\n     return \"unsafe.Pointer..d\";\n \n   if (nt == NULL)\n-    return \"type..\" + type->mangled_name(this);\n+    {\n+      // Sanity check: we should never generate a type descriptor for\n+      // an unnamed primitive type.  For those we should always be\n+      // using a named type, like \"int\".\n+      go_assert(!type->is_basic_type());\n+\n+      return \"type..\" + type->mangled_name(this);\n+    }\n \n   std::string ret;\n   Named_object* no = nt->named_object();"}]}