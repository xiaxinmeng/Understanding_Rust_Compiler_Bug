{"sha": "1a47f99c0f033b16594eaabac4e6dbc4c5c58554", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWE0N2Y5OWMwZjAzM2IxNjU5NGVhYWJhYzRlNmRiYzRjNWM1ODU1NA==", "commit": {"author": {"name": "Michael Matz", "email": "matz@gcc.gnu.org", "date": "2012-01-26T13:24:58Z"}, "committer": {"name": "Michael Matz", "email": "matz@gcc.gnu.org", "date": "2012-01-26T13:24:58Z"}, "message": "re PR tree-optimization/48794 (ICE: SIGSEGV in remap_eh_region_nr (tree-inline.c:1194) with -Os -fopenmp -fexceptions -fno-tree-ccp -fno-tree-copy-prop)\n\n\tPR tree-optimization/48794\n\t* tree-eh.c (remove_unreachable_handlers_no_lp): Don't remove\n\tregions referenced from RESX/EH_DISPATCH.\n\ntestsuite/\n\t* gfortran.dg/gomp/pr48794-2.f90: New testcase.\n\nFrom-SVN: r183559", "tree": {"sha": "0e78fd6f3d83e39d28a6a95ef13ede7c57ee9c92", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0e78fd6f3d83e39d28a6a95ef13ede7c57ee9c92"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1a47f99c0f033b16594eaabac4e6dbc4c5c58554", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1a47f99c0f033b16594eaabac4e6dbc4c5c58554", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1a47f99c0f033b16594eaabac4e6dbc4c5c58554", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1a47f99c0f033b16594eaabac4e6dbc4c5c58554/comments", "author": null, "committer": null, "parents": [{"sha": "c0a9d2a12ec96a90e41998f34d036c4281d91797", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c0a9d2a12ec96a90e41998f34d036c4281d91797", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c0a9d2a12ec96a90e41998f34d036c4281d91797"}], "stats": {"total": 57, "additions": 55, "deletions": 2}, "files": [{"sha": "2a45134e7d0a033dbd3a492f973f53093cb7c5b2", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1a47f99c0f033b16594eaabac4e6dbc4c5c58554/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1a47f99c0f033b16594eaabac4e6dbc4c5c58554/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=1a47f99c0f033b16594eaabac4e6dbc4c5c58554", "patch": "@@ -1,3 +1,9 @@\n+2012-01-26  Michael Matz  <matz@suse.de>\n+\n+\tPR tree-optimization/48794\n+\t* tree-eh.c (remove_unreachable_handlers_no_lp): Don't remove\n+\tregions referenced from RESX/EH_DISPATCH.\n+\n 2012-01-26  Andreas Krebbel  <Andreas.Krebbel@de.ibm.com>\n \n \t* config/s390/s390.h: Make BRANCH_COST an option."}, {"sha": "3ff49d77c5e7ec24cf2b30c60936659b6bc9a876", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1a47f99c0f033b16594eaabac4e6dbc4c5c58554/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1a47f99c0f033b16594eaabac4e6dbc4c5c58554/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=1a47f99c0f033b16594eaabac4e6dbc4c5c58554", "patch": "@@ -1,7 +1,12 @@\n+2012-01-26  Michael Matz  <matz@suse.de>\n+\n+\tPR tree-optimization/48794\n+\t* gfortran.dg/gomp/pr48794-2.f90: New testcase.\n+\n 2012-01-26  Andreas Krebbel  <Andreas.Krebbel@de.ibm.com>\n \n \t* gcc.dg/ssa-dom-thread-4.c: Set -mbranch-cost=2 for s390 and\n-          s390x.\n+\ts390x.\n \n 2012-01-26  Andreas Krebbel  <Andreas.Krebbel@de.ibm.com>\n "}, {"sha": "b3f9d3c9cf06dc9e465d4da1090f98b58c46ed8d", "filename": "gcc/testsuite/gfortran.dg/gomp/pr48794-2.f90", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1a47f99c0f033b16594eaabac4e6dbc4c5c58554/gcc%2Ftestsuite%2Fgfortran.dg%2Fgomp%2Fpr48794-2.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1a47f99c0f033b16594eaabac4e6dbc4c5c58554/gcc%2Ftestsuite%2Fgfortran.dg%2Fgomp%2Fpr48794-2.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fgomp%2Fpr48794-2.f90?ref=1a47f99c0f033b16594eaabac4e6dbc4c5c58554", "patch": "@@ -0,0 +1,16 @@\n+! PR tree-optimization/48794\n+! { dg-do compile }\n+! { dg-options \"-Os -fopenmp -fexceptions -fno-tree-ccp -fno-tree-copy-prop\" }\n+\n+  integer, allocatable :: a(:)\n+  integer :: b(48)\n+  logical :: l\n+  if (allocated (a)) then\n+    call abort\n+    call bla(b)\n+  end if\n+!$omp parallel private (a) reduction (.or.:l)\n+  do i = 1, 7\n+  end do\n+!$omp end parallel\n+end"}, {"sha": "2064d51b952df48a11681dc08856fc8bb3cafb57", "filename": "gcc/tree-eh.c", "status": "modified", "additions": 27, "deletions": 1, "changes": 28, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1a47f99c0f033b16594eaabac4e6dbc4c5c58554/gcc%2Ftree-eh.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1a47f99c0f033b16594eaabac4e6dbc4c5c58554/gcc%2Ftree-eh.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-eh.c?ref=1a47f99c0f033b16594eaabac4e6dbc4c5c58554", "patch": "@@ -3617,14 +3617,40 @@ remove_unreachable_handlers_no_lp (void)\n {\n   eh_region r;\n   int i;\n+  sbitmap r_reachable;\n+  basic_block bb;\n+\n+  r_reachable = sbitmap_alloc (VEC_length (eh_region, cfun->eh->region_array));\n+  sbitmap_zero (r_reachable);\n+\n+  FOR_EACH_BB (bb)\n+    {\n+      gimple stmt = last_stmt (bb);\n+      if (stmt)\n+\t/* Avoid removing regions referenced from RESX/EH_DISPATCH.  */\n+\tswitch (gimple_code (stmt))\n+\t  {\n+\t  case GIMPLE_RESX:\n+\t    SET_BIT (r_reachable, gimple_resx_region (stmt));\n+\t    break;\n+\t  case GIMPLE_EH_DISPATCH:\n+\t    SET_BIT (r_reachable, gimple_eh_dispatch_region (stmt));\n+\t    break;\n+\t  default:\n+\t    break;\n+\t  }\n+    }\n \n   for (i = 1; VEC_iterate (eh_region, cfun->eh->region_array, i, r); ++i)\n-    if (r && r->landing_pads == NULL && r->type != ERT_MUST_NOT_THROW)\n+    if (r && r->landing_pads == NULL && r->type != ERT_MUST_NOT_THROW\n+\t&& !TEST_BIT (r_reachable, i))\n       {\n \tif (dump_file)\n \t  fprintf (dump_file, \"Removing unreachable region %d\\n\", i);\n \tremove_eh_handler (r);\n       }\n+\n+  sbitmap_free (r_reachable);\n }\n \n /* Undo critical edge splitting on an EH landing pad.  Earlier, we"}]}