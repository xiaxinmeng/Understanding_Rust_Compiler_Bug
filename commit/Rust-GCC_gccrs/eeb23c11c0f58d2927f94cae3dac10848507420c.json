{"sha": "eeb23c11c0f58d2927f94cae3dac10848507420c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWViMjNjMTFjMGY1OGQyOTI3Zjk0Y2FlM2RhYzEwODQ4NTA3NDIwYw==", "commit": {"author": {"name": "Mark Mitchell", "email": "mark@codesourcery.com", "date": "2003-12-06T04:59:55Z"}, "committer": {"name": "Mark Mitchell", "email": "mmitchel@gcc.gnu.org", "date": "2003-12-06T04:59:55Z"}, "message": "re PR c++/13314 (ICE when omitting template parameter of a sub-class)\n\n\tPR c++/13314\n\t* emit-rtl.c (set_mem_attributes_minus_bitpos): Robustify.\n\n\tPR c++/13314\n\t* parser.c (cp_parser_class_specifier): Match push_scope/pop_scope\n\tcalls.\n\t(cp_parser_class_head): Likewise.\n\n\tPR c++/13314\n\t* g++.dg/template/error7.C: New test.\n\nFrom-SVN: r74359", "tree": {"sha": "d246e242b1f8237a1d1682441733732a069e218f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d246e242b1f8237a1d1682441733732a069e218f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/eeb23c11c0f58d2927f94cae3dac10848507420c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/eeb23c11c0f58d2927f94cae3dac10848507420c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/eeb23c11c0f58d2927f94cae3dac10848507420c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/eeb23c11c0f58d2927f94cae3dac10848507420c/comments", "author": null, "committer": null, "parents": [{"sha": "6a40fb21e1af1dc1eb1df6e4fa92dc3cbac15ac6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6a40fb21e1af1dc1eb1df6e4fa92dc3cbac15ac6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6a40fb21e1af1dc1eb1df6e4fa92dc3cbac15ac6"}], "stats": {"total": 34, "additions": 32, "deletions": 2}, "files": [{"sha": "9cd85d751b6bf27b438f4996fbe4045b1b93a2ee", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eeb23c11c0f58d2927f94cae3dac10848507420c/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eeb23c11c0f58d2927f94cae3dac10848507420c/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=eeb23c11c0f58d2927f94cae3dac10848507420c", "patch": "@@ -1,3 +1,8 @@\n+2003-12-05  Mark Mitchell  <mark@codesourcery.com>\n+\n+\tPR c++/13314\n+\t* emit-rtl.c (set_mem_attributes_minus_bitpos): Robustify.\n+\n 2003-12-05  Andrew Pinski <pinskia@physics.uc.edu>\n \n \tPR driver/13211"}, {"sha": "39dd385d2a6a124b55e4932c20a1bd81aa097671", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eeb23c11c0f58d2927f94cae3dac10848507420c/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eeb23c11c0f58d2927f94cae3dac10848507420c/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=eeb23c11c0f58d2927f94cae3dac10848507420c", "patch": "@@ -1,3 +1,10 @@\n+2003-12-05  Mark Mitchell  <mark@codesourcery.com>\n+\n+\tPR c++/13314\n+\t* parser.c (cp_parser_class_specifier): Match push_scope/pop_scope\n+\tcalls.\n+\t(cp_parser_class_head): Likewise.\n+\n 2003-12-05  Kriang Lerdsuwanakij  <lerdsuwa@users.sourceforge.net>\n \n \tPR c++/13166"}, {"sha": "97d32834d6a1f5bdddb9d90584dac06f7dd96d8a", "filename": "gcc/cp/parser.c", "status": "modified", "additions": 7, "deletions": 2, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eeb23c11c0f58d2927f94cae3dac10848507420c/gcc%2Fcp%2Fparser.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eeb23c11c0f58d2927f94cae3dac10848507420c/gcc%2Fcp%2Fparser.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fparser.c?ref=eeb23c11c0f58d2927f94cae3dac10848507420c", "patch": "@@ -11447,6 +11447,8 @@ cp_parser_class_specifier (cp_parser* parser)\n   parser->num_template_parameter_lists = 0;\n \n   /* Start the class.  */\n+  if (nested_name_specifier_p)\n+    push_scope (CP_DECL_CONTEXT (TYPE_MAIN_DECL (type)));\n   type = begin_class_definition (type);\n   if (type == error_mark_node)\n     /* If the type is erroneous, skip the entire body of the class.  */\n@@ -11737,7 +11739,7 @@ cp_parser_class_head (cp_parser* parser,\n      it is not, try to recover gracefully.  */\n   if (at_namespace_scope_p () \n       && parser->num_template_parameter_lists == 0\n-      && num_templates == 1)\n+      && template_id_p)\n     {\n       error (\"an explicit specialization must be preceded by 'template <>'\");\n       invalid_explicit_specialization_p = true;\n@@ -11836,7 +11838,10 @@ cp_parser_class_head (cp_parser* parser,\n \ttype = push_template_decl (type);\n       type = TREE_TYPE (type);\n       if (nested_name_specifier)\n-\t*nested_name_specifier_p = true;\n+\t{\n+\t  *nested_name_specifier_p = true;\n+\t  pop_scope (nested_name_specifier);\n+\t}\n     }\n   /* Indicate whether this class was declared as a `class' or as a\n      `struct'.  */"}, {"sha": "8be71ae64fb8d7cf909ae469800d67dc790c0208", "filename": "gcc/emit-rtl.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eeb23c11c0f58d2927f94cae3dac10848507420c/gcc%2Femit-rtl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eeb23c11c0f58d2927f94cae3dac10848507420c/gcc%2Femit-rtl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Femit-rtl.c?ref=eeb23c11c0f58d2927f94cae3dac10848507420c", "patch": "@@ -1826,6 +1826,8 @@ set_mem_attributes_minus_bitpos (rtx ref, tree t, int objectp,\n     return;\n \n   type = TYPE_P (t) ? t : TREE_TYPE (t);\n+  if (type == error_mark_node)\n+    return;\n \n   /* If we have already set DECL_RTL = ref, get_alias_set will get the\n      wrong answer, as it assumes that DECL_RTL already has the right alias"}, {"sha": "aba0ad31fdb05d1453760c9281f931871f6fc331", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eeb23c11c0f58d2927f94cae3dac10848507420c/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eeb23c11c0f58d2927f94cae3dac10848507420c/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=eeb23c11c0f58d2927f94cae3dac10848507420c", "patch": "@@ -1,3 +1,8 @@\n+2003-12-05  Mark Mitchell  <mark@codesourcery.com>\n+\n+\tPR c++/13314\n+\t* g++.dg/template/error7.C: New test.\n+\n 2003-12-05  Stuart Menefy <stuart.menefy@st.com>\n             J\"orn Rennecke <joern.rennecke@superh.com>\n "}, {"sha": "3c1a0e1f21b1fd5b1328dd11739f856a46201c6c", "filename": "gcc/testsuite/g++.dg/template/error7.C", "status": "added", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eeb23c11c0f58d2927f94cae3dac10848507420c/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Ferror7.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eeb23c11c0f58d2927f94cae3dac10848507420c/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Ferror7.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Ferror7.C?ref=eeb23c11c0f58d2927f94cae3dac10848507420c", "patch": "@@ -0,0 +1,6 @@\n+// PR c++/13314\n+// { dg-options \"-O2\" }\n+\n+struct A { template <int> struct B; };\n+struct A::B {}; // { dg-error \"\" }\n+A::B<0> b; // { dg-error \"\" }"}]}