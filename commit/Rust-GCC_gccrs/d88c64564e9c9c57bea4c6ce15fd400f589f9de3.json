{"sha": "d88c64564e9c9c57bea4c6ce15fd400f589f9de3", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDg4YzY0NTY0ZTljOWM1N2JlYTRjNmNlMTVmZDQwMGY1ODlmOWRlMw==", "commit": {"author": {"name": "Andreas Tobler", "email": "a.tobler@schweiz.org", "date": "2007-01-19T19:19:35Z"}, "committer": {"name": "Andreas Tobler", "email": "andreast@gcc.gnu.org", "date": "2007-01-19T19:19:35Z"}, "message": "os_dep.c (defined(MPROTECT_VDB) && defined(DARWIN)): Moved recently added defines to include/private/gc_priv.h\n\n2007-01-19  Andreas Tobler  <a.tobler@schweiz.org>\n\n\t* os_dep.c (defined(MPROTECT_VDB) && defined(DARWIN)): Moved recently\n\tadded defines to include/private/gc_priv.h\n\t* darwin_stop_world.c: Removed the above defines.\n\t(catch_exception_raise): Added THREAD_FLD in exc_state for POWERPC too.\n\t* include/private/gc_priv.h: Moved definitions from darwin_stop_world.c\n\tand os_dep.c to here. Fixed THREAD definition fixes for ppc64.\n\nFrom-SVN: r120977", "tree": {"sha": "4eba58acbff072ff079405d890b8da2c4f774d02", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4eba58acbff072ff079405d890b8da2c4f774d02"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d88c64564e9c9c57bea4c6ce15fd400f589f9de3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d88c64564e9c9c57bea4c6ce15fd400f589f9de3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d88c64564e9c9c57bea4c6ce15fd400f589f9de3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d88c64564e9c9c57bea4c6ce15fd400f589f9de3/comments", "author": null, "committer": null, "parents": [{"sha": "67e47f30d0909b366126ac63fa329a71480ecb18", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/67e47f30d0909b366126ac63fa329a71480ecb18", "html_url": "https://github.com/Rust-GCC/gccrs/commit/67e47f30d0909b366126ac63fa329a71480ecb18"}], "stats": {"total": 51, "additions": 26, "deletions": 25}, "files": [{"sha": "74463dc03fdc5cb183fe9e8cb2345b5b8269ec97", "filename": "boehm-gc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d88c64564e9c9c57bea4c6ce15fd400f589f9de3/boehm-gc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d88c64564e9c9c57bea4c6ce15fd400f589f9de3/boehm-gc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/boehm-gc%2FChangeLog?ref=d88c64564e9c9c57bea4c6ce15fd400f589f9de3", "patch": "@@ -1,3 +1,12 @@\n+2007-01-19  Andreas Tobler  <a.tobler@schweiz.org>\n+\n+\t* os_dep.c (defined(MPROTECT_VDB) && defined(DARWIN)): Moved recently\n+\tadded defines to include/private/gc_priv.h\n+\t* darwin_stop_world.c: Removed the above defines.\n+\t(catch_exception_raise): Added THREAD_FLD in exc_state for POWERPC too.\n+\t* include/private/gc_priv.h: Moved definitions from darwin_stop_world.c\n+\tand os_dep.c to here. Fixed THREAD definition fixes for ppc64.\n+\n 2007-01-17  David Daney  <ddaney@avtrex.com>\n \n \t* configure.ac: Don't define NO_SIGSET and NO_DEBUGGING while"}, {"sha": "719b1b02d35ee474f7e4b0d9242c410fa59dc559", "filename": "boehm-gc/darwin_stop_world.c", "status": "modified", "additions": 0, "deletions": 13, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d88c64564e9c9c57bea4c6ce15fd400f589f9de3/boehm-gc%2Fdarwin_stop_world.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d88c64564e9c9c57bea4c6ce15fd400f589f9de3/boehm-gc%2Fdarwin_stop_world.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/boehm-gc%2Fdarwin_stop_world.c?ref=d88c64564e9c9c57bea4c6ce15fd400f589f9de3", "patch": "@@ -20,19 +20,6 @@\n # define PPC_RED_ZONE_SIZE 320\n #endif\n \n-/* Try to work out the right way to access thread state structure members.\n-   The structure has changed its definition in different Darwin versions.  */\n-/* This now defaults to the (older) names without __, thus hopefully    */\n-/* not breaking any existing Makefile.direct builds.                    */\n-#if defined (HAS_PPC_THREAD_STATE___R0) ||\t\\\n-    defined (HAS_PPC_THREAD_STATE64___R0) ||\t\\\n-    defined (HAS_X86_THREAD_STATE32___EAX) ||\t\\\n-    defined (HAS_X86_THREAD_STATE64___RAX)\n-#  define THREAD_FLD(x) __ ## x\n-#else\n-#  define THREAD_FLD(x) x\n-#endif\n-\n typedef struct StackFrame {\n   unsigned long\tsavedSP;\n   unsigned long\tsavedCR;"}, {"sha": "41c75d3bb62c3e60df20b559ffc01ac0f854e2a8", "filename": "boehm-gc/include/private/gc_priv.h", "status": "modified", "additions": 16, "deletions": 2, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d88c64564e9c9c57bea4c6ce15fd400f589f9de3/boehm-gc%2Finclude%2Fprivate%2Fgc_priv.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d88c64564e9c9c57bea4c6ce15fd400f589f9de3/boehm-gc%2Finclude%2Fprivate%2Fgc_priv.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/boehm-gc%2Finclude%2Fprivate%2Fgc_priv.h?ref=d88c64564e9c9c57bea4c6ce15fd400f589f9de3", "patch": "@@ -472,15 +472,17 @@ extern GC_warn_proc GC_current_warn_proc;\n #      if defined(POWERPC)\n #              if CPP_WORDSZ == 32\n #                define GC_THREAD_STATE_T ppc_thread_state_t\n+#\t\t  define GC_MACH_THREAD_STATE PPC_THREAD_STATE\n+#\t\t  define GC_MACH_THREAD_STATE_COUNT PPC_THREAD_STATE_COUNT\n #                define GC_MACH_HEADER mach_header\n #                define GC_MACH_SECTION section\n #              else\n #                define GC_THREAD_STATE_T ppc_thread_state64_t\n+#\t\t  define GC_MACH_THREAD_STATE PPC_THREAD_STATE64\n+#\t\t  define GC_MACH_THREAD_STATE_COUNT PPC_THREAD_STATE64_COUNT\n #                define GC_MACH_HEADER mach_header_64\n #                define GC_MACH_SECTION section_64\n #              endif\n-#              define GC_MACH_THREAD_STATE PPC_THREAD_STATE\n-#              define GC_MACH_THREAD_STATE_COUNT PPC_THREAD_STATE_COUNT\n #      elif defined(I386) || defined(X86_64)\n #              if CPP_WORDSZ == 32\n #                define GC_THREAD_STATE_T x86_thread_state32_t\n@@ -500,6 +502,18 @@ extern GC_warn_proc GC_current_warn_proc;\n #              define GC_MACH_THREAD_STATE MACHINE_THREAD_STATE\n #              define GC_MACH_THREAD_STATE_COUNT MACHINE_THREAD_STATE_COUNT\n #      endif\n+/* Try to work out the right way to access thread state structure members.\n+   The structure has changed its definition in different Darwin versions.\n+   This now defaults to the (older) names without __, thus hopefully,\n+   not breaking any existing Makefile.direct builds.  */\n+#      if defined (HAS_PPC_THREAD_STATE___R0) \\\n+\t || defined (HAS_PPC_THREAD_STATE64___R0) \\\n+\t || defined (HAS_X86_THREAD_STATE32___EAX) \\\n+\t || defined (HAS_X86_THREAD_STATE64___RAX)\n+#        define THREAD_FLD(x) __ ## x\n+#      else\n+#        define THREAD_FLD(x) x\n+#      endif\n #endif\n /*********************************/\n /*                               */"}, {"sha": "3f0f20e834cedda24483ba09fb3d93222b2497af", "filename": "boehm-gc/os_dep.c", "status": "modified", "additions": 1, "deletions": 10, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d88c64564e9c9c57bea4c6ce15fd400f589f9de3/boehm-gc%2Fos_dep.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d88c64564e9c9c57bea4c6ce15fd400f589f9de3/boehm-gc%2Fos_dep.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/boehm-gc%2Fos_dep.c?ref=d88c64564e9c9c57bea4c6ce15fd400f589f9de3", "patch": "@@ -3405,15 +3405,6 @@ extern kern_return_t exception_raise_state_identity(\n \n #define MAX_EXCEPTION_PORTS 16\n \n-#if defined (HAS_PPC_THREAD_STATE___R0) ||\t\\\n-    defined (HAS_PPC_THREAD_STATE64___R0) ||\t\\\n-    defined (HAS_X86_THREAD_STATE32___EAX) ||\t\\\n-    defined (HAS_X86_THREAD_STATE64___RAX)\n-#  define THREAD_FLD(x) __ ## x\n-#else\n-#  define THREAD_FLD(x) x\n-#endif\n-\n static struct {\n     mach_msg_type_number_t count;\n     exception_mask_t      masks[MAX_EXCEPTION_PORTS];\n@@ -3853,7 +3844,7 @@ catch_exception_raise(\n     \n     /* This is the address that caused the fault */\n #if defined(POWERPC)\n-    addr = (char*) exc_state.dar;\n+    addr = (char*) exc_state. THREAD_FLD(dar);\n #elif defined (I386) || defined (X86_64)\n     addr = (char*) exc_state. THREAD_FLD(faultvaddr);\n #else"}]}