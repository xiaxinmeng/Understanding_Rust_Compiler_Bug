{"sha": "9664b89edd5858fc7bda86c077f15adad71d7046", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTY2NGI4OWVkZDU4NThmYzdiZGE4NmMwNzdmMTVhZGFkNzFkNzA0Ng==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@yorick.cygnus.com", "date": "1997-12-13T00:28:00Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "1997-12-13T00:28:00Z"}, "message": "errfn.c (cp_pedwarn, [...]): Replace extern decls with casts.\n\n\t* errfn.c (cp_pedwarn, cp_pedwarn_at, cp_error_at, cp_warning_at):\n\tReplace extern decls with casts.\n\n\t* decl.c (expand_start_early_try_stmts): Don't mess with a sequence.\n\tUpdate last_parm_cleanup_insn.\n\t(store_after_parms): Remove.\n\t* cp-tree.h: Adjust.\n\nFixes eh{39,40}.C\n\nFrom-SVN: r17083", "tree": {"sha": "26b98fad4ccdb8bd2ebc55772ac5bfd8d1357d2f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/26b98fad4ccdb8bd2ebc55772ac5bfd8d1357d2f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9664b89edd5858fc7bda86c077f15adad71d7046", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9664b89edd5858fc7bda86c077f15adad71d7046", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9664b89edd5858fc7bda86c077f15adad71d7046", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9664b89edd5858fc7bda86c077f15adad71d7046/comments", "author": null, "committer": null, "parents": [{"sha": "62189d7d8f8d3b8fa264aa82d3c14185d427a1d7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/62189d7d8f8d3b8fa264aa82d3c14185d427a1d7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/62189d7d8f8d3b8fa264aa82d3c14185d427a1d7"}], "stats": {"total": 66, "additions": 21, "deletions": 45}, "files": [{"sha": "7d1ab25fa9e9c12b63c683804229bad62aa9c9eb", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9664b89edd5858fc7bda86c077f15adad71d7046/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9664b89edd5858fc7bda86c077f15adad71d7046/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=9664b89edd5858fc7bda86c077f15adad71d7046", "patch": "@@ -1,3 +1,13 @@\n+Fri Dec 12 16:09:14 1997  Jason Merrill  <jason@yorick.cygnus.com>\n+\n+\t* errfn.c (cp_pedwarn, cp_pedwarn_at, cp_error_at, cp_warning_at): \n+\tReplace extern decls with casts.\n+\n+\t* decl.c (expand_start_early_try_stmts): Don't mess with a sequence.\n+\tUpdate last_parm_cleanup_insn.\n+\t(store_after_parms): Remove.\n+\t* cp-tree.h: Adjust.\n+\n Thu Dec 11 22:18:37 1997  Jason Merrill  <jason@yorick.cygnus.com>\n \n \t* decl2.c (comdat_linkage): Also set DECL_COMDAT."}, {"sha": "79172c2cfc7dfe031e924f3b7f36f2d4c6c7ddcc", "filename": "gcc/cp/cp-tree.h", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9664b89edd5858fc7bda86c077f15adad71d7046/gcc%2Fcp%2Fcp-tree.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9664b89edd5858fc7bda86c077f15adad71d7046/gcc%2Fcp%2Fcp-tree.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fcp-tree.h?ref=9664b89edd5858fc7bda86c077f15adad71d7046", "patch": "@@ -2085,7 +2085,6 @@ extern tree finish_enum\t\t\t\tPROTO((tree, tree));\n extern tree build_enumerator\t\t\tPROTO((tree, tree));\n extern tree grok_enum_decls\t\t\tPROTO((tree, tree));\n extern int start_function\t\t\tPROTO((tree, tree, tree, int));\n-extern void store_after_parms\t\t\tPROTO((struct rtx_def *));\n extern void expand_start_early_try_stmts\tPROTO((void));\n extern void store_parm_decls\t\t\tPROTO((void));\n extern void store_return_init\t\t\tPROTO((tree, tree));"}, {"sha": "c38445f64c773e4a20fecb69570bf8f1bf709cd9", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 7, "deletions": 36, "changes": 43, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9664b89edd5858fc7bda86c077f15adad71d7046/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9664b89edd5858fc7bda86c077f15adad71d7046/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=9664b89edd5858fc7bda86c077f15adad71d7046", "patch": "@@ -324,8 +324,9 @@ tree dtor_label;\n static rtx last_dtor_insn;\n \n /* In a constructor, the last insn emitted after the start of the\n-   function and the parms, but before the start of the exception\n-   specification.  */\n+   function and the parms, the exception specification and any\n+   function-try-block.  The constructor initializers are emitted after\n+   this insn.  */\n \n static rtx last_parm_cleanup_insn;\n \n@@ -11658,45 +11659,15 @@ start_function (declspecs, declarator, attrs, pre_parsed_p)\n   return 1;\n }\n \f\n-void\n-store_after_parms (insns)\n-     rtx insns;\n-{\n-  rtx x;\n-\n-  for (x = get_insns (); x; x = next_insn (x))\n-    {\n-      if (GET_CODE (x) == NOTE && NOTE_LINE_NUMBER (x) == NOTE_INSN_FUNCTION_BEG)\n-\t{\n-\t  emit_insns_after (insns, x);\n-\t  return;\n-\t}\n-    }\n-#if 0\n-  /* This doesn't work, because the inline output routine doesn't reset\n-     last_parm_insn correctly for get_first_nonparm_insn () to work.  */\n-\n-  last_parm_insn = get_first_nonparm_insn ();\n-  if (last_parm_insn == NULL_RTX)\n-    emit_insns (insns);\n-  else\n-    emit_insns_before (insns,  last_parm_insn);\n-#endif\n-}\n+/* Called after store_parm_decls for a function-try-block.  We need to update\n+   last_parm_cleanup_insn so that the base initializers for a constructor\n+   are run within this block, not before it.  */\n \n void\n expand_start_early_try_stmts ()\n {\n-  rtx insns;\n-  start_sequence ();\n   expand_start_try_stmts ();\n-  insns = get_insns ();\n-  end_sequence ();\n-#if 1\n-  emit_insns_after (insns, get_insns ());\n-#else\n-  store_after_parms (insns);\n-#endif\n+  last_parm_cleanup_insn = get_last_insn ();\n }\n \n /* Store the parameter declarations into the current function declaration."}, {"sha": "63de7b8fea2a1ab55550ad12ecbd3e2fc737d680", "filename": "gcc/cp/errfn.c", "status": "modified", "additions": 4, "deletions": 8, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9664b89edd5858fc7bda86c077f15adad71d7046/gcc%2Fcp%2Ferrfn.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9664b89edd5858fc7bda86c077f15adad71d7046/gcc%2Fcp%2Ferrfn.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ferrfn.c?ref=9664b89edd5858fc7bda86c077f15adad71d7046", "patch": "@@ -177,9 +177,8 @@ cp_pedwarn (format, arglist)\n      char *format;\n      arglist_dcl\n {\n-  extern errorfn pedwarn;\n   if (! cp_silent)\n-    cp_thing (pedwarn, 0, format, arglist);\n+    cp_thing ((errorfn *) pedwarn, 0, format, arglist);\n }\n \n void\n@@ -205,27 +204,24 @@ cp_error_at (format, arglist)\n      char *format;\n      arglist_dcl\n {\n-  extern errorfn error_with_file_and_line;\n   if (! cp_silent)\n-    cp_thing (error_with_file_and_line, 1, format, arglist);\n+    cp_thing ((errorfn *) error_with_file_and_line, 1, format, arglist);\n }\n \n void\n cp_warning_at (format, arglist)\n      char *format;\n      arglist_dcl\n {\n-  extern errorfn warning_with_file_and_line;\n   if (! cp_silent)\n-    cp_thing (warning_with_file_and_line, 1, format, arglist);\n+    cp_thing ((errorfn *) warning_with_file_and_line, 1, format, arglist);\n }\n \n void\n cp_pedwarn_at (format, arglist)\n      char *format;\n      arglist_dcl\n {\n-  extern errorfn pedwarn_with_file_and_line;\n   if (! cp_silent)\n-    cp_thing (pedwarn_with_file_and_line, 1, format, arglist);\n+    cp_thing ((errorfn *) pedwarn_with_file_and_line, 1, format, arglist);\n }"}]}