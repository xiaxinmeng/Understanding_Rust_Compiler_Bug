{"sha": "f373b44d282eca5e494f71ef2ad16f00b0ff1233", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjM3M2I0NGQyODJlY2E1ZTQ5NGY3MWVmMmFkMTZmMDBiMGZmMTIzMw==", "commit": {"author": {"name": "Tom Tromey", "email": "tromey@redhat.com", "date": "2007-11-01T18:20:48Z"}, "committer": {"name": "Tom Tromey", "email": "tromey@gcc.gnu.org", "date": "2007-11-01T18:20:48Z"}, "message": "re PR preprocessor/30805 (Internal compiler error when using \"x##,##__VA_ARGS__\" in macro)\n\nlibcpp\n\tPR preprocessor/30805:\n\t* macro.c (paste_tokens): Handle padding token.\n\t(paste_tokens): Don't abort unless padding has PASTE_LEFT flag.\ngcc/testsuite\n\tPR preprocessor/30805:\n\t* gcc.dg/cpp/pr30805.c: New file.\n\nFrom-SVN: r129827", "tree": {"sha": "d2d010b50cd8299a7b0f4980f1321627be3431c2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d2d010b50cd8299a7b0f4980f1321627be3431c2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f373b44d282eca5e494f71ef2ad16f00b0ff1233", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f373b44d282eca5e494f71ef2ad16f00b0ff1233", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f373b44d282eca5e494f71ef2ad16f00b0ff1233", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f373b44d282eca5e494f71ef2ad16f00b0ff1233/comments", "author": null, "committer": null, "parents": [{"sha": "233a722b41e85a05c88390bea6764e93a1bf92ea", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/233a722b41e85a05c88390bea6764e93a1bf92ea", "html_url": "https://github.com/Rust-GCC/gccrs/commit/233a722b41e85a05c88390bea6764e93a1bf92ea"}], "stats": {"total": 26, "additions": 23, "deletions": 3}, "files": [{"sha": "3d35ba060bdb47a2363cf0b6aab5da87d2e07c44", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f373b44d282eca5e494f71ef2ad16f00b0ff1233/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f373b44d282eca5e494f71ef2ad16f00b0ff1233/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=f373b44d282eca5e494f71ef2ad16f00b0ff1233", "patch": "@@ -1,3 +1,8 @@\n+2007-11-01  Tom Tromey  <tromey@redhat.com>\n+\n+\tPR preprocessor/30805:\n+\t* gcc.dg/cpp/pr30805.c: New file.\n+\n 2007-11-01  Janis Johnson  <janis187@us.ibm.com>\n \n \tPR testsuite/25352"}, {"sha": "4f56a767ac2b4deac97f33eb833eb80ef8da32cd", "filename": "gcc/testsuite/gcc.dg/cpp/pr30805.c", "status": "added", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f373b44d282eca5e494f71ef2ad16f00b0ff1233/gcc%2Ftestsuite%2Fgcc.dg%2Fcpp%2Fpr30805.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f373b44d282eca5e494f71ef2ad16f00b0ff1233/gcc%2Ftestsuite%2Fgcc.dg%2Fcpp%2Fpr30805.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fcpp%2Fpr30805.c?ref=f373b44d282eca5e494f71ef2ad16f00b0ff1233", "patch": "@@ -0,0 +1,5 @@\n+/* PR preprocessor/30805 - ICE while token pasting.  */\n+/* { dg-do preprocess } */\n+\n+#define A(x,...) x##,##__VA_ARGS__\n+A(1)"}, {"sha": "c7cfa174709c3cd5dd881a5e8bc78ff1c1ab5731", "filename": "libcpp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f373b44d282eca5e494f71ef2ad16f00b0ff1233/libcpp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f373b44d282eca5e494f71ef2ad16f00b0ff1233/libcpp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libcpp%2FChangeLog?ref=f373b44d282eca5e494f71ef2ad16f00b0ff1233", "patch": "@@ -1,3 +1,9 @@\n+2007-11-01  Tom Tromey  <tromey@redhat.com>\n+\n+\tPR preprocessor/30805:\n+\t* macro.c (paste_tokens): Handle padding token.\n+\t(paste_tokens): Don't abort unless padding has PASTE_LEFT flag.\n+\n 2007-10-31  Tom Tromey  <tromey@redhat.com>\n \n \tPR preprocessor/30786:"}, {"sha": "f3a4420ae406ac7bc4f47708f0526cb4ec1090b2", "filename": "libcpp/macro.c", "status": "modified", "additions": 7, "deletions": 3, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f373b44d282eca5e494f71ef2ad16f00b0ff1233/libcpp%2Fmacro.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f373b44d282eca5e494f71ef2ad16f00b0ff1233/libcpp%2Fmacro.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libcpp%2Fmacro.c?ref=f373b44d282eca5e494f71ef2ad16f00b0ff1233", "patch": "@@ -451,7 +451,9 @@ paste_tokens (cpp_reader *pfile, const cpp_token **plhs, const cpp_token *rhs)\n      false doesn't work, since we want to clear the PASTE_LEFT flag.  */\n   if ((*plhs)->type == CPP_DIV && rhs->type != CPP_EQ)\n     *end++ = ' ';\n-  end = cpp_spell_token (pfile, rhs, end, false);\n+  /* In one obscure case we might see padding here.  */\n+  if (rhs->type != CPP_PADDING)\n+    end = cpp_spell_token (pfile, rhs, end, false);\n   *end = '\\n';\n \n   cpp_push_buffer (pfile, buf, end - buf, /* from_stage3 */ true);\n@@ -514,8 +516,10 @@ paste_all_tokens (cpp_reader *pfile, const cpp_token *lhs)\n \trhs = *FIRST (context).ptoken++;\n \n       if (rhs->type == CPP_PADDING)\n-\tabort ();\n-\n+\t{\n+\t  if (rhs->flags & PASTE_LEFT)\n+\t    abort ();\n+\t}\n       if (!paste_tokens (pfile, &lhs, rhs))\n \tbreak;\n     }"}]}