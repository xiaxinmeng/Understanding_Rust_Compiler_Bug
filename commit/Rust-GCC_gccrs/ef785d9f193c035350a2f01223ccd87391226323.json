{"sha": "ef785d9f193c035350a2f01223ccd87391226323", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWY3ODVkOWYxOTNjMDM1MzUwYTJmMDEyMjNjY2Q4NzM5MTIyNjMyMw==", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2015-11-10T10:12:13Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2015-11-10T10:12:13Z"}, "message": "tree-vect-data-refs.c (vect_slp_analyze_node_dependences): Handle memory using/clobbering stmts without a STMT_VINFO_DATA_REF conservatively.\n\n2015-11-10  Richard Biener  <rguenther@suse.de>\n\n\t* tree-vect-data-refs.c (vect_slp_analyze_node_dependences):\n\tHandle memory using/clobbering stmts without a STMT_VINFO_DATA_REF\n\tconservatively.\n\nFrom-SVN: r230094", "tree": {"sha": "042b6a7ed561f4faee1df0cbd4d17f0b81ca0d55", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/042b6a7ed561f4faee1df0cbd4d17f0b81ca0d55"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ef785d9f193c035350a2f01223ccd87391226323", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ef785d9f193c035350a2f01223ccd87391226323", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ef785d9f193c035350a2f01223ccd87391226323", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ef785d9f193c035350a2f01223ccd87391226323/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "a6524bba206a001a83e60548007f92c701cd0a86", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a6524bba206a001a83e60548007f92c701cd0a86", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a6524bba206a001a83e60548007f92c701cd0a86"}], "stats": {"total": 29, "additions": 18, "deletions": 11}, "files": [{"sha": "9db12db3a75edeca989cfd6edba3cffa19dca5cd", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ef785d9f193c035350a2f01223ccd87391226323/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ef785d9f193c035350a2f01223ccd87391226323/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=ef785d9f193c035350a2f01223ccd87391226323", "patch": "@@ -1,3 +1,9 @@\n+2015-11-10  Richard Biener  <rguenther@suse.de>\n+\n+\t* tree-vect-data-refs.c (vect_slp_analyze_node_dependences):\n+\tHandle memory using/clobbering stmts without a STMT_VINFO_DATA_REF\n+\tconservatively.\n+\n 2015-11-10  Richard Biener  <rguenther@suse.de>\n \n \tPR tree-optimization/56118"}, {"sha": "77313ec4e1a0cc97adba9873ae243b531d717ff2", "filename": "gcc/tree-vect-data-refs.c", "status": "modified", "additions": 12, "deletions": 11, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ef785d9f193c035350a2f01223ccd87391226323/gcc%2Ftree-vect-data-refs.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ef785d9f193c035350a2f01223ccd87391226323/gcc%2Ftree-vect-data-refs.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-vect-data-refs.c?ref=ef785d9f193c035350a2f01223ccd87391226323", "patch": "@@ -573,21 +573,22 @@ vect_slp_analyze_node_dependences (slp_instance instance, slp_tree node)\n       gimple *access = SLP_TREE_SCALAR_STMTS (node)[k];\n       if (access == last_access)\n \tcontinue;\n-      stmt_vec_info access_stmt_info = vinfo_for_stmt (access);\n-      gimple_stmt_iterator gsi = gsi_for_stmt (access);\n-      gsi_next (&gsi);\n-      for (; gsi_stmt (gsi) != last_access; gsi_next (&gsi))\n+      data_reference *dr_a = STMT_VINFO_DATA_REF (vinfo_for_stmt (access));\n+      for (gimple_stmt_iterator gsi = gsi_for_stmt (access);\n+\t   gsi_stmt (gsi) != last_access; gsi_next (&gsi))\n \t{\n \t  gimple *stmt = gsi_stmt (gsi);\n-\t  stmt_vec_info stmt_info = vinfo_for_stmt (stmt);\n-\t  if (!STMT_VINFO_DATA_REF (stmt_info)\n-\t      || (DR_IS_READ (STMT_VINFO_DATA_REF (stmt_info))\n-\t\t  && DR_IS_READ (STMT_VINFO_DATA_REF (access_stmt_info))))\n+\t  if (! gimple_vuse (stmt)\n+\t      || (DR_IS_READ (dr_a) && ! gimple_vdef (stmt)))\n \t    continue;\n \n-\t  ddr_p ddr = initialize_data_dependence_relation\n-\t      (STMT_VINFO_DATA_REF (access_stmt_info),\n-\t       STMT_VINFO_DATA_REF (stmt_info), vNULL);\n+\t  /* If we couldn't record a (single) data reference for this\n+\t     stmt we have to give up.  */\n+\t  data_reference *dr_b = STMT_VINFO_DATA_REF (vinfo_for_stmt (stmt));\n+\t  if (!dr_b)\n+\t    return false;\n+\n+\t  ddr_p ddr = initialize_data_dependence_relation (dr_a, dr_b, vNULL);\n \t  if (vect_slp_analyze_data_ref_dependence (ddr))\n \t    {\n \t      /* ???  If the dependence analysis failed we can resort to the"}]}