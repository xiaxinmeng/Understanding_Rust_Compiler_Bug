{"sha": "720086cd84423764cfced1dc16b74821a9c3f3b1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzIwMDg2Y2Q4NDQyMzc2NGNmY2VkMWRjMTZiNzQ4MjFhOWMzZjNiMQ==", "commit": {"author": {"name": "David Daney", "email": "ddaney@avtrex.com", "date": "2004-08-18T15:12:32Z"}, "committer": {"name": "David Daney", "email": "daney@gcc.gnu.org", "date": "2004-08-18T15:12:32Z"}, "message": "natPosixProcess.cc (waitForSignal): Use sigsuspend instead of sigwait.\n\n2004-08-18  David Daney  <ddaney@avtrex.com>\n\n\t* java/lang/natPosixProcess.cc (waitForSignal): Use sigsuspend\n\tinstead of sigwait.\n\nFrom-SVN: r86186", "tree": {"sha": "3a0c85672202098b0c107df58f4a4415569c918c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3a0c85672202098b0c107df58f4a4415569c918c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/720086cd84423764cfced1dc16b74821a9c3f3b1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/720086cd84423764cfced1dc16b74821a9c3f3b1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/720086cd84423764cfced1dc16b74821a9c3f3b1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/720086cd84423764cfced1dc16b74821a9c3f3b1/comments", "author": null, "committer": null, "parents": [{"sha": "3a4416fb2a3f4781921f3633526500dccfc748c2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3a4416fb2a3f4781921f3633526500dccfc748c2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3a4416fb2a3f4781921f3633526500dccfc748c2"}], "stats": {"total": 21, "additions": 14, "deletions": 7}, "files": [{"sha": "0fa156d48d5eb973487d91ece2092f515c7297b7", "filename": "libjava/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/720086cd84423764cfced1dc16b74821a9c3f3b1/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/720086cd84423764cfced1dc16b74821a9c3f3b1/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=720086cd84423764cfced1dc16b74821a9c3f3b1", "patch": "@@ -1,3 +1,8 @@\n+2004-08-18  David Daney  <ddaney@avtrex.com>\n+\n+\t* java/lang/natPosixProcess.cc (waitForSignal): Use sigsuspend \n+\tinstead of sigwait.\n+\n 2004-08-17  Michael Koch  <konqueror@gmx.de>\n \n \t* Makefile.am (AM_CXXFLAGS): Reformatted to make it more ease to read."}, {"sha": "a4b87c3a30031135ffeb1e3f1685b045c980c272", "filename": "libjava/java/lang/natPosixProcess.cc", "status": "modified", "additions": 9, "deletions": 7, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/720086cd84423764cfced1dc16b74821a9c3f3b1/libjava%2Fjava%2Flang%2FnatPosixProcess.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/720086cd84423764cfced1dc16b74821a9c3f3b1/libjava%2Fjava%2Flang%2FnatPosixProcess.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjava%2Flang%2FnatPosixProcess.cc?ref=720086cd84423764cfced1dc16b74821a9c3f3b1", "patch": "@@ -130,20 +130,22 @@ java::lang::ConcreteProcess$ProcessManager::waitForSignal ()\n \n   sigset_t mask;\n   // Wait for SIGCHLD\n-  sigemptyset (&mask);\n-  sigaddset (&mask, SIGCHLD);\n+  pthread_sigmask (0, NULL, &mask);\n+  sigdelset (&mask, SIGCHLD);\n+  // Use sigsuspend() instead of sigwait() as sigwait() doesn't play\n+  // nicely with the GC's use of signals.\n+  int c = sigsuspend (&mask);\n \n-  int sig;\n-  int c = sigwait (&mask, &sig);\n-\n-  if (c != 0)\n+  if (c != -1)\n+    goto error;\n+  if (errno != EINTR)\n     goto error;\n \n   // All OK.\n   return;\n \n error:\n-  throw new InternalError (JvNewStringUTF (strerror (c)));\n+  throw new InternalError (JvNewStringUTF (strerror (errno)));\n }\n \n jboolean java::lang::ConcreteProcess$ProcessManager::reap ()"}]}