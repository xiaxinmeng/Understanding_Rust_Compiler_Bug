{"sha": "bdaaa8b70f8e76b2743ee7bafc438e499411753f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmRhYWE4YjcwZjhlNzZiMjc0M2VlN2JhZmM0MzhlNDk5NDExNzUzZg==", "commit": {"author": {"name": "Ville Voutilainen", "email": "ville.voutilainen@gmail.com", "date": "2015-09-21T15:50:30Z"}, "committer": {"name": "Ville Voutilainen", "email": "ville@gcc.gnu.org", "date": "2015-09-21T15:50:30Z"}, "message": "Complete the implementation of N4230, Nested namespace definition.\n\n/c-family\n2015-09-21  Ville Voutilainen  <ville.voutilainen@gmail.com>\n\n\tComplete the implementation of N4230, Nested namespace definition.\n\t* c-cppbuiltin.c: Add __cpp_namespace_attributes and\n\t__cpp_nested_namespace_definitions.\n\n/cp\n2015-09-21  Ville Voutilainen  <ville.voutilainen@gmail.com>\n\n\tComplete the implementation of N4230, Nested namespace definition.\n\t* parser.c (cp_parser_namespace_definition): Support namespace\n\tattributes both before and after the namespace identifier.\n\n/testsuite\n2015-09-21  Ville Voutilainen  <ville.voutilainen@gmail.com>\n\n\tComplete the implementation of N4230, Nested namespace definition.\n\t* g++.dg/cpp1y/feat-cxx11-neg.C: Add tests for C++17 namespace\n\tattributes and nested namespace definitions.\n\t* g++.dg/cpp1y/feat-cxx98-neg.C: Likewise.\n\t* g++.dg/cpp1z/feat-cxx1z.C: Likewise.\n\t* g++.dg/cpp1y/feat-cxx14-neg.C: New.\n\t* g++.dg/cpp1z/namespace-attribs.C: Likewise.\n\t* g++.dg/cpp1z/nested-namespace-def1.C: Add tests for attributes\n\tappearing before the namespace identifier.\n\nFrom-SVN: r227977", "tree": {"sha": "a0c9ebca3ca8e137ea972254b66af70b0fc63155", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a0c9ebca3ca8e137ea972254b66af70b0fc63155"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bdaaa8b70f8e76b2743ee7bafc438e499411753f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bdaaa8b70f8e76b2743ee7bafc438e499411753f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bdaaa8b70f8e76b2743ee7bafc438e499411753f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bdaaa8b70f8e76b2743ee7bafc438e499411753f/comments", "author": {"login": "villevoutilainen", "id": 963599, "node_id": "MDQ6VXNlcjk2MzU5OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/963599?v=4", "gravatar_id": "", "url": "https://api.github.com/users/villevoutilainen", "html_url": "https://github.com/villevoutilainen", "followers_url": "https://api.github.com/users/villevoutilainen/followers", "following_url": "https://api.github.com/users/villevoutilainen/following{/other_user}", "gists_url": "https://api.github.com/users/villevoutilainen/gists{/gist_id}", "starred_url": "https://api.github.com/users/villevoutilainen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/villevoutilainen/subscriptions", "organizations_url": "https://api.github.com/users/villevoutilainen/orgs", "repos_url": "https://api.github.com/users/villevoutilainen/repos", "events_url": "https://api.github.com/users/villevoutilainen/events{/privacy}", "received_events_url": "https://api.github.com/users/villevoutilainen/received_events", "type": "User", "site_admin": false}, "committer": {"login": "villevoutilainen", "id": 963599, "node_id": "MDQ6VXNlcjk2MzU5OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/963599?v=4", "gravatar_id": "", "url": "https://api.github.com/users/villevoutilainen", "html_url": "https://github.com/villevoutilainen", "followers_url": "https://api.github.com/users/villevoutilainen/followers", "following_url": "https://api.github.com/users/villevoutilainen/following{/other_user}", "gists_url": "https://api.github.com/users/villevoutilainen/gists{/gist_id}", "starred_url": "https://api.github.com/users/villevoutilainen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/villevoutilainen/subscriptions", "organizations_url": "https://api.github.com/users/villevoutilainen/orgs", "repos_url": "https://api.github.com/users/villevoutilainen/repos", "events_url": "https://api.github.com/users/villevoutilainen/events{/privacy}", "received_events_url": "https://api.github.com/users/villevoutilainen/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "87b470b3635a5f8aaf9c6d4d21945d06d3379a6b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/87b470b3635a5f8aaf9c6d4d21945d06d3379a6b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/87b470b3635a5f8aaf9c6d4d21945d06d3379a6b"}], "stats": {"total": 101, "additions": 99, "deletions": 2}, "files": [{"sha": "5fa1a727c374d8838a5a3d84ef1e00ada5ba77c9", "filename": "gcc/c-family/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bdaaa8b70f8e76b2743ee7bafc438e499411753f/gcc%2Fc-family%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bdaaa8b70f8e76b2743ee7bafc438e499411753f/gcc%2Fc-family%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2FChangeLog?ref=bdaaa8b70f8e76b2743ee7bafc438e499411753f", "patch": "@@ -1,3 +1,9 @@\n+2015-09-21  Ville Voutilainen  <ville.voutilainen@gmail.com>\n+\n+\tComplete the implementation of N4230, Nested namespace definition.\n+\t* c-cppbuiltin.c: Add __cpp_namespace_attributes and\n+\t__cpp_nested_namespace_definitions.\n+\n 2015-09-18  Manuel L\u00f3pez-Ib\u00e1\u00f1ez  <manu@gcc.gnu.org>\n \n \t* c-pragma.c (handle_pragma_diagnostic): Fix wrong return."}, {"sha": "b222a9f263b1da7106701b5be39a0188c320d3cc", "filename": "gcc/c-family/c-cppbuiltin.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bdaaa8b70f8e76b2743ee7bafc438e499411753f/gcc%2Fc-family%2Fc-cppbuiltin.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bdaaa8b70f8e76b2743ee7bafc438e499411753f/gcc%2Fc-family%2Fc-cppbuiltin.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2Fc-cppbuiltin.c?ref=bdaaa8b70f8e76b2743ee7bafc438e499411753f", "patch": "@@ -870,6 +870,8 @@ c_cpp_builtins (cpp_reader *pfile)\n \t{\n \t  /* Set feature test macros for C++1z.  */\n \t  cpp_define (pfile, \"__cpp_static_assert=201411\");\n+\t  cpp_define (pfile, \"__cpp_namespace_attributes=201411\");\n+\t  cpp_define (pfile, \"__cpp_nested_namespace_definitions=201411\");\n \t}\n       if (flag_concepts)\n \t/* Use a value smaller than the 201507 specified in"}, {"sha": "279d2f1acd4555c0f8b58fc46a89dcabd8ee522f", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bdaaa8b70f8e76b2743ee7bafc438e499411753f/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bdaaa8b70f8e76b2743ee7bafc438e499411753f/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=bdaaa8b70f8e76b2743ee7bafc438e499411753f", "patch": "@@ -1,3 +1,9 @@\n+2015-09-21  Ville Voutilainen  <ville.voutilainen@gmail.com>\n+\n+\tComplete the implementation of N4230, Nested namespace definition.\n+\t* parser.c (cp_parser_namespace_definition): Support namespace\n+\tattributes both before and after the namespace identifier.\n+\n 2015-09-19  Trevor Saunders  <tbsaunde@tbsaunde.org>\n \n \t* cp-gimplify.c (gimplify_must_not_throw_expr): Adjust."}, {"sha": "013418941b11007916d9774279147e97847c3704", "filename": "gcc/cp/parser.c", "status": "modified", "additions": 15, "deletions": 2, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bdaaa8b70f8e76b2743ee7bafc438e499411753f/gcc%2Fcp%2Fparser.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bdaaa8b70f8e76b2743ee7bafc438e499411753f/gcc%2Fcp%2Fparser.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fparser.c?ref=bdaaa8b70f8e76b2743ee7bafc438e499411753f", "patch": "@@ -11645,6 +11645,9 @@ cp_parser_declaration (cp_parser* parser)\n \t       (token2.type == CPP_NAME\n \t\t&& (cp_lexer_peek_nth_token (parser->lexer, 3)->type\n \t\t    != CPP_EQ))\n+               || (token2.type == CPP_OPEN_SQUARE\n+                   && cp_lexer_peek_nth_token (parser->lexer, 3)->type\n+                   == CPP_OPEN_SQUARE)\n \t       /* An unnamed namespace definition.  */\n \t       || token2.type == CPP_OPEN_BRACE\n \t       || token2.keyword == RID_ATTRIBUTE))\n@@ -16969,6 +16972,9 @@ cp_parser_namespace_definition (cp_parser* parser)\n   /* Look for the `namespace' keyword.  */\n   token = cp_parser_require_keyword (parser, RID_NAMESPACE, RT_NAMESPACE);\n \n+  /* Parse any specified attributes before the identifier.  */\n+  attribs = cp_parser_attributes_opt (parser);\n+\n   /* Get the name of the namespace.  We do not attempt to distinguish\n      between an original-namespace-definition and an\n      extension-namespace-definition at this point.  The semantic\n@@ -16978,8 +16984,15 @@ cp_parser_namespace_definition (cp_parser* parser)\n   else\n     identifier = NULL_TREE;\n \n-  /* Parse any specified attributes.  */\n-  attribs = cp_parser_attributes_opt (parser);\n+  /* Parse any specified attributes after the identifier.  */\n+  tree post_ident_attribs = cp_parser_attributes_opt (parser);\n+  if (post_ident_attribs)\n+    {\n+      if (attribs)\n+        attribs = chainon (attribs, post_ident_attribs);\n+      else\n+        attribs = post_ident_attribs;\n+    }\n \n   /* Start the namespace.  */\n   push_namespace (identifier);"}, {"sha": "c65469fef03b257a4977852662717418757993ef", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bdaaa8b70f8e76b2743ee7bafc438e499411753f/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bdaaa8b70f8e76b2743ee7bafc438e499411753f/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=bdaaa8b70f8e76b2743ee7bafc438e499411753f", "patch": "@@ -1,3 +1,15 @@\n+2015-09-21  Ville Voutilainen  <ville.voutilainen@gmail.com>\n+\n+\tComplete the implementation of N4230, Nested namespace definition.\n+\t* g++.dg/cpp1y/feat-cxx11-neg.C: Add tests for C++17 namespace\n+\tattributes and nested namespace definitions.\n+\t* g++.dg/cpp1y/feat-cxx98-neg.C: Likewise.\n+\t* g++.dg/cpp1z/feat-cxx1z.C: Likewise.\n+\t* g++.dg/cpp1y/feat-cxx14-neg.C: New.\n+\t* g++.dg/cpp1z/namespace-attribs.C: Likewise.\n+\t* g++.dg/cpp1z/nested-namespace-def1.C: Add tests for attributes\n+\tappearing before the namespace identifier.\n+\n 2015-09-21  Manuel L\u00f3pez-Ib\u00e1\u00f1ez  <manu@gcc.gnu.org>\n \n \tPR c/66415"}, {"sha": "825d0880f58ff9d37dddf39014fd30236716ede1", "filename": "gcc/testsuite/g++.dg/cpp1y/feat-cxx11-neg.C", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bdaaa8b70f8e76b2743ee7bafc438e499411753f/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1y%2Ffeat-cxx11-neg.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bdaaa8b70f8e76b2743ee7bafc438e499411753f/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1y%2Ffeat-cxx11-neg.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1y%2Ffeat-cxx11-neg.C?ref=bdaaa8b70f8e76b2743ee7bafc438e499411753f", "patch": "@@ -38,6 +38,17 @@\n #  error \"__cpp_sized_deallocation\" // { dg-error \"error\" }\n #endif\n \n+// C++17 features:\n+\n+#ifndef __cpp_namespace_attributes\n+#  error \"__cpp_namespace_attributes\" // { dg-error \"error\" }\n+#endif\n+\n+#ifndef __cpp_nested_namespace_definitions\n+#  error \"__cpp_nested_namespace_definitions\" // { dg-error \"error\" }\n+#endif\n+\n+\n //  Array TS features:\n \n #ifndef __cpp_runtime_arrays"}, {"sha": "221bd3f949bcf5ed6359d2a0a972e357396224db", "filename": "gcc/testsuite/g++.dg/cpp1y/feat-cxx14-neg.C", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bdaaa8b70f8e76b2743ee7bafc438e499411753f/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1y%2Ffeat-cxx14-neg.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bdaaa8b70f8e76b2743ee7bafc438e499411753f/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1y%2Ffeat-cxx14-neg.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1y%2Ffeat-cxx14-neg.C?ref=bdaaa8b70f8e76b2743ee7bafc438e499411753f", "patch": "@@ -0,0 +1,11 @@\n+// { dg-do compile { target c++14 } }\n+\n+// C++17 features:\n+\n+#ifndef __cpp_namespace_attributes\n+#  error \"__cpp_namespace_attributes\" // { dg-error \"error\" }\n+#endif\n+\n+#ifndef __cpp_nested_namespace_definitions\n+#  error \"__cpp_nested_namespace_definitions\" // { dg-error \"error\" }\n+#endif"}, {"sha": "886b3d3df10e651390f84a81e53365d634bfae1d", "filename": "gcc/testsuite/g++.dg/cpp1y/feat-cxx98-neg.C", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bdaaa8b70f8e76b2743ee7bafc438e499411753f/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1y%2Ffeat-cxx98-neg.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bdaaa8b70f8e76b2743ee7bafc438e499411753f/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1y%2Ffeat-cxx98-neg.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1y%2Ffeat-cxx98-neg.C?ref=bdaaa8b70f8e76b2743ee7bafc438e499411753f", "patch": "@@ -113,6 +113,16 @@\n #  error \"__cpp_sized_deallocation\" // { dg-error \"error\" }\n #endif\n \n+// C++17 features:\n+\n+#ifndef __cpp_namespace_attributes\n+#  error \"__cpp_namespace_attributes\" // { dg-error \"error\" }\n+#endif\n+\n+#ifndef __cpp_nested_namespace_definitions\n+#  error \"__cpp_nested_namespace_definitions\" // { dg-error \"error\" }\n+#endif\n+\n //  C++11 attributes:\n \n #ifdef __has_cpp_attribute"}, {"sha": "ead16659b5e5acf8ca0d2b9097bfd138623d45c5", "filename": "gcc/testsuite/g++.dg/cpp1z/feat-cxx1z.C", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bdaaa8b70f8e76b2743ee7bafc438e499411753f/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1z%2Ffeat-cxx1z.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bdaaa8b70f8e76b2743ee7bafc438e499411753f/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1z%2Ffeat-cxx1z.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1z%2Ffeat-cxx1z.C?ref=bdaaa8b70f8e76b2743ee7bafc438e499411753f", "patch": "@@ -6,3 +6,15 @@\n #elif __cpp_static_assert != 201411\n #  error \"__cpp_static_assert != 201411\"\n #endif\n+\n+#ifndef __cpp_namespace_attributes\n+#  error \"__cpp_namespace_attributes\"\n+#elif __cpp_namespace_attributes != 201411\n+#  error \"__cpp_namespace_attributes != 201411\"\n+#endif\n+\n+#ifndef __cpp_nested_namespace_definitions\n+#  error \"__cpp_nested_namespace_definitions\"\n+#elif __cpp_nested_namespace_definitions != 201411\n+#  error \"__cpp_nested_namespace_definitions != 201411\"\n+#endif"}, {"sha": "7dc2173937e61225232f594af9994004c958608b", "filename": "gcc/testsuite/g++.dg/cpp1z/namespace-attribs.C", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bdaaa8b70f8e76b2743ee7bafc438e499411753f/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1z%2Fnamespace-attribs.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bdaaa8b70f8e76b2743ee7bafc438e499411753f/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1z%2Fnamespace-attribs.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1z%2Fnamespace-attribs.C?ref=bdaaa8b70f8e76b2743ee7bafc438e499411753f", "patch": "@@ -0,0 +1,10 @@\n+// { dg-options \"-std=c++1z\" }\n+\n+namespace A __attribute ((visibility (\"default\"))) {}\n+\n+namespace B [[deprecated]] {} // { dg-warning \"ignored\" }\n+\n+namespace __attribute ((visibility (\"default\"))) C {}\n+\n+namespace [[deprecated]] D {} // { dg-warning \"ignored\" }\n+"}, {"sha": "39801742d09d0722cb7ae57b71526fa971a21367", "filename": "gcc/testsuite/g++.dg/cpp1z/nested-namespace-def1.C", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bdaaa8b70f8e76b2743ee7bafc438e499411753f/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1z%2Fnested-namespace-def1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bdaaa8b70f8e76b2743ee7bafc438e499411753f/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1z%2Fnested-namespace-def1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1z%2Fnested-namespace-def1.C?ref=bdaaa8b70f8e76b2743ee7bafc438e499411753f", "patch": "@@ -17,3 +17,7 @@ namespace G __attribute ((visibility (\"default\"))) ::H {} // { dg-error \"cannot\n \n namespace H [[deprecated]] ::I {} // { dg-error \"cannot have attributes|ignored\" }\n \n+namespace __attribute ((visibility (\"default\"))) I::J {} // { dg-error \"cannot have attributes\" }\n+\n+namespace [[deprecated]] J::K {} // { dg-error \"cannot have attributes|ignored\" }\n+"}]}