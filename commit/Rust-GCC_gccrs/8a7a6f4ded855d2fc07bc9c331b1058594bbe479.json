{"sha": "8a7a6f4ded855d2fc07bc9c331b1058594bbe479", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OGE3YTZmNGRlZDg1NWQyZmMwN2JjOWMzMzFiMTA1ODU5NGJiZTQ3OQ==", "commit": {"author": {"name": "Devang Patel", "email": "dpatel@apple.com", "date": "2003-10-06T22:25:19Z"}, "committer": {"name": "Devang Patel", "email": "dpatel@gcc.gnu.org", "date": "2003-10-06T22:25:19Z"}, "message": "Fix -feliminate-dwarf2-dups ICE.\n\n       gcc\n       * dwarf2out.c (is_main_source): Remove variable.\n       (dwarf2out_start_source_file): Do not check is_main_source.\n       Do not reset is_main_source.\n       (dwarf2out_init): Do not initialize is_main_source.\n\n       testsuite\n       * gcc.dg/debug/dwarf2-3.h: New test.\n       * gcc.dg/debug/dwarf2-3.c: New test case for -feliminate-dwarf2-dups.\n\nFrom-SVN: r72166", "tree": {"sha": "3394bf2be8f58b06adeaa9ec44b6beb09ec8665c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3394bf2be8f58b06adeaa9ec44b6beb09ec8665c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8a7a6f4ded855d2fc07bc9c331b1058594bbe479", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8a7a6f4ded855d2fc07bc9c331b1058594bbe479", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8a7a6f4ded855d2fc07bc9c331b1058594bbe479", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8a7a6f4ded855d2fc07bc9c331b1058594bbe479/comments", "author": null, "committer": null, "parents": [{"sha": "9a557707dd303a741f5a329b5b2be232794e11f1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9a557707dd303a741f5a329b5b2be232794e11f1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9a557707dd303a741f5a329b5b2be232794e11f1"}], "stats": {"total": 45, "additions": 35, "deletions": 10}, "files": [{"sha": "6a6dc5d35f17fa25c09165231d4d7e47195b5250", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8a7a6f4ded855d2fc07bc9c331b1058594bbe479/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8a7a6f4ded855d2fc07bc9c331b1058594bbe479/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=8a7a6f4ded855d2fc07bc9c331b1058594bbe479", "patch": "@@ -1,3 +1,10 @@\n+2003-10-06  Devang Patel  <dpatel@apple.com>\n+\n+\t* dwarf2out.c (is_main_source): Remove variable.\n+\t(dwarf2out_start_source_file): Do not check is_main_source.\n+\tDo not reset is_main_source.\n+\t(dwarf2out_init): Do not initialize is_main_source.\n+\t\n 2003-10-06  Rainer Orth  <ro@TechFak.Uni-Bielefeld.DE>\n \n \t* fixinc/inclhack.def (stdio_va_list): Removed _ap fix."}, {"sha": "2642e81ceaeb1b1325412d4352c2684c4dd87151", "filename": "gcc/dwarf2out.c", "status": "modified", "additions": 1, "deletions": 10, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8a7a6f4ded855d2fc07bc9c331b1058594bbe479/gcc%2Fdwarf2out.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8a7a6f4ded855d2fc07bc9c331b1058594bbe479/gcc%2Fdwarf2out.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdwarf2out.c?ref=8a7a6f4ded855d2fc07bc9c331b1058594bbe479", "patch": "@@ -3443,12 +3443,6 @@ static unsigned long next_die_offset;\n /* Record the root of the DIE's built for the current compilation unit.  */\n static GTY(()) dw_die_ref comp_unit_die;\n \n-#ifdef DWARF2_DEBUGGING_INFO\n-/* We need special handling in dwarf2out_start_source_file if it is\n-   first one.  */\n-static int is_main_source;\n-#endif\n-\n /* A list of DIEs with a NULL parent waiting to be relocated.  */\n static GTY(()) limbo_die_node *limbo_die_list;\n \n@@ -12285,7 +12279,7 @@ dwarf2out_source_line (unsigned int line, const char *filename)\n static void\n dwarf2out_start_source_file (unsigned int lineno, const char *filename)\n {\n-  if (flag_eliminate_dwarf2_dups && !is_main_source)\n+  if (flag_eliminate_dwarf2_dups)\n     {\n       /* Record the beginning of the file for break_out_includes.  */\n       dw_die_ref bincl_die;\n@@ -12294,8 +12288,6 @@ dwarf2out_start_source_file (unsigned int lineno, const char *filename)\n       add_AT_string (bincl_die, DW_AT_name, filename);\n     }\n \n-  is_main_source = 0;\n-\n   if (debug_info_level >= DINFO_LEVEL_VERBOSE)\n     {\n       named_section_flags (DEBUG_MACINFO_SECTION, SECTION_DEBUG);\n@@ -12396,7 +12388,6 @@ dwarf2out_init (const char *filename ATTRIBUTE_UNUSED)\n      invoked when the given (base) source file was compiled.  We will fill\n      in this value in dwarf2out_finish.  */\n   comp_unit_die = gen_compile_unit_die (NULL);\n-  is_main_source = 1;\n \n   VARRAY_TREE_INIT (incomplete_types, 64, \"incomplete_types\");\n "}, {"sha": "6c87236fe2e238e7190186a53c8867e7cf6eb8ad", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8a7a6f4ded855d2fc07bc9c331b1058594bbe479/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8a7a6f4ded855d2fc07bc9c331b1058594bbe479/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=8a7a6f4ded855d2fc07bc9c331b1058594bbe479", "patch": "@@ -1,3 +1,8 @@\n+2003-10-06  Devang Patel  <dpatel@apple.com>\n+\n+\t* gcc.dg/debug/dwarf2-3.h: New test.\n+\t* gcc.dg/debug/dwarf2-3.c: New test case for -feliminate-dwarf2-dups.\n+\t\n 2003-10-06  Wolfgang Bangerth  <bangerth@ticam.utexas.edu>\n \n \t* g++.dg/opt/cfg2.C: New test."}, {"sha": "f0c129c60261ace4a1ee844551803d4bf6ea9fa1", "filename": "gcc/testsuite/gcc.dg/debug/dwarf2-3.c", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8a7a6f4ded855d2fc07bc9c331b1058594bbe479/gcc%2Ftestsuite%2Fgcc.dg%2Fdebug%2Fdwarf2-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8a7a6f4ded855d2fc07bc9c331b1058594bbe479/gcc%2Ftestsuite%2Fgcc.dg%2Fdebug%2Fdwarf2-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fdebug%2Fdwarf2-3.c?ref=8a7a6f4ded855d2fc07bc9c331b1058594bbe479", "patch": "@@ -0,0 +1,13 @@\n+/* Test -feliminate-dwarf2-dups */\n+/* Contributed by Devang Patel <dpatel@apple.com> */\n+/* { dg-do compile } */\n+/* { dg-options \"-feliminate-dwarf2-dups\" } */\n+\n+#include \"dwarf2-3.h\"\n+\n+int main()\n+{\n+  struct point p;\n+  p.x = 0;\n+  p.y = 0;\n+}"}, {"sha": "26ad0bace2234dd861dc0f4b2c86601dd039ba25", "filename": "gcc/testsuite/gcc.dg/debug/dwarf2-3.h", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8a7a6f4ded855d2fc07bc9c331b1058594bbe479/gcc%2Ftestsuite%2Fgcc.dg%2Fdebug%2Fdwarf2-3.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8a7a6f4ded855d2fc07bc9c331b1058594bbe479/gcc%2Ftestsuite%2Fgcc.dg%2Fdebug%2Fdwarf2-3.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fdebug%2Fdwarf2-3.h?ref=8a7a6f4ded855d2fc07bc9c331b1058594bbe479", "patch": "@@ -0,0 +1,9 @@\n+/* Test -feliminate-dwarf2-dups */\n+/* Contributed by Devang Patel <dpatel@apple.com> */\n+\n+struct point\n+{\n+  int x;\n+  int y;\n+};\n+"}]}