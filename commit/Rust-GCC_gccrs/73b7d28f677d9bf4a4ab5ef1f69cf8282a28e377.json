{"sha": "73b7d28f677d9bf4a4ab5ef1f69cf8282a28e377", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzNiN2QyOGY2NzdkOWJmNGE0YWI1ZWYxZjY5Y2Y4MjgyYTI4ZTM3Nw==", "commit": {"author": {"name": "Paolo Carlini", "email": "paolo.carlini@oracle.com", "date": "2018-02-01T15:36:04Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2018-02-01T15:36:04Z"}, "message": "re PR c++/83796 (Abstract classes allowed to be instantiated when initialised as default parameter to function or constructor)\n\n/cp\n2018-02-01  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/83796\n\t* call.c (convert_like_real): If w're initializing from {} explicitly\n\tcall abstract_virtuals_error_sfinae.\n\n/testsuite\n2018-02-01  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/83796\n\t* g++.dg/cpp0x/abstract-default1.C: New.\n\nFrom-SVN: r257298", "tree": {"sha": "08eaaa23e6345a60a44473b0b17f23ac9ad82e5b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/08eaaa23e6345a60a44473b0b17f23ac9ad82e5b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/73b7d28f677d9bf4a4ab5ef1f69cf8282a28e377", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/73b7d28f677d9bf4a4ab5ef1f69cf8282a28e377", "html_url": "https://github.com/Rust-GCC/gccrs/commit/73b7d28f677d9bf4a4ab5ef1f69cf8282a28e377", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/73b7d28f677d9bf4a4ab5ef1f69cf8282a28e377/comments", "author": null, "committer": null, "parents": [{"sha": "3ae129323d150621d216fbbcdeebf033ef82416f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3ae129323d150621d216fbbcdeebf033ef82416f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3ae129323d150621d216fbbcdeebf033ef82416f"}], "stats": {"total": 39, "additions": 39, "deletions": 0}, "files": [{"sha": "8fc9042ea012b2a2c9a302a75a0451eecd67d2d1", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/73b7d28f677d9bf4a4ab5ef1f69cf8282a28e377/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/73b7d28f677d9bf4a4ab5ef1f69cf8282a28e377/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=73b7d28f677d9bf4a4ab5ef1f69cf8282a28e377", "patch": "@@ -1,3 +1,9 @@\n+2018-02-01  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/83796\n+\t* call.c (convert_like_real): If w're initializing from {} explicitly\n+\tcall abstract_virtuals_error_sfinae.\n+\n 2018-01-31  Jason Merrill  <jason@redhat.com>\n \t    Jakub Jelinek  <jakub@redhat.com>\n "}, {"sha": "15b723ad2b090c111f49c62a8111e704392673f8", "filename": "gcc/cp/call.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/73b7d28f677d9bf4a4ab5ef1f69cf8282a28e377/gcc%2Fcp%2Fcall.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/73b7d28f677d9bf4a4ab5ef1f69cf8282a28e377/gcc%2Fcp%2Fcall.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fcall.c?ref=73b7d28f677d9bf4a4ab5ef1f69cf8282a28e377", "patch": "@@ -6765,6 +6765,8 @@ convert_like_real (conversion *convs, tree expr, tree fn, int argnum,\n \t    && TYPE_HAS_DEFAULT_CONSTRUCTOR (totype))\n \t  {\n \t    bool direct = CONSTRUCTOR_IS_DIRECT_INIT (expr);\n+\t    if (abstract_virtuals_error_sfinae (NULL_TREE, totype, complain))\n+\t      return error_mark_node;\n \t    expr = build_value_init (totype, complain);\n \t    expr = get_target_expr_sfinae (expr, complain);\n \t    if (expr != error_mark_node)"}, {"sha": "465ae15296a707924995c3ddc0fc8e606d4cff23", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/73b7d28f677d9bf4a4ab5ef1f69cf8282a28e377/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/73b7d28f677d9bf4a4ab5ef1f69cf8282a28e377/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=73b7d28f677d9bf4a4ab5ef1f69cf8282a28e377", "patch": "@@ -1,3 +1,8 @@\n+2018-02-01  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/83796\n+\t* g++.dg/cpp0x/abstract-default1.C: New.\n+\n 2018-02-01  Richard Sandiford  <richard.sandiford@linaro.org>\n \n \tPR tree-optimization/81635"}, {"sha": "e98af766170e84622f73291f781c1d6a171bbc65", "filename": "gcc/testsuite/g++.dg/cpp0x/abstract-default1.C", "status": "added", "additions": 26, "deletions": 0, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/73b7d28f677d9bf4a4ab5ef1f69cf8282a28e377/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fabstract-default1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/73b7d28f677d9bf4a4ab5ef1f69cf8282a28e377/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fabstract-default1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fabstract-default1.C?ref=73b7d28f677d9bf4a4ab5ef1f69cf8282a28e377", "patch": "@@ -0,0 +1,26 @@\n+// PR c++/83796\n+// { dg-do compile { target c++11 } }\n+\n+struct MyAbstractClass\n+{\n+  virtual int foo() const = 0;\n+};\n+\n+struct TestClass\n+{\n+  TestClass(const MyAbstractClass& m = {})  // { dg-error \"abstract type\" }\n+  : value_(m.foo()) {}\n+\n+  int value_;\n+};\n+\n+int TestFunction(const MyAbstractClass& m = {})  // { dg-error \"abstract type\" }\n+{\n+  return m.foo();\n+}\n+\n+int main()\n+{\n+  TestClass testInstance;  // { dg-error \"abstract type\" }\n+  TestFunction();  // { dg-error \"abstract type\" }\n+}"}]}