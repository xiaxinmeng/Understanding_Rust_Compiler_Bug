{"sha": "5a73de5ee915b9eaa24d7b04b703b8bdfea0d754", "node_id": "C_kwDOANBUbNoAKDVhNzNkZTVlZTkxNWI5ZWFhMjRkN2IwNGI3MDNiOGJkZmVhMGQ3NTQ", "commit": {"author": {"name": "Philip Herron", "email": "philip.herron@embecosm.com", "date": "2021-11-22T17:30:31Z"}, "committer": {"name": "Philip Herron", "email": "philip.herron@embecosm.com", "date": "2021-11-22T17:31:20Z"}, "message": "Make mappings as part of the class", "tree": {"sha": "d748fa8c782627aabbef78d6dc63a6f5fdb9db2b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d748fa8c782627aabbef78d6dc63a6f5fdb9db2b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5a73de5ee915b9eaa24d7b04b703b8bdfea0d754", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5a73de5ee915b9eaa24d7b04b703b8bdfea0d754", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5a73de5ee915b9eaa24d7b04b703b8bdfea0d754", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5a73de5ee915b9eaa24d7b04b703b8bdfea0d754/comments", "author": {"login": "philberty", "id": 84585, "node_id": "MDQ6VXNlcjg0NTg1", "avatar_url": "https://avatars.githubusercontent.com/u/84585?v=4", "gravatar_id": "", "url": "https://api.github.com/users/philberty", "html_url": "https://github.com/philberty", "followers_url": "https://api.github.com/users/philberty/followers", "following_url": "https://api.github.com/users/philberty/following{/other_user}", "gists_url": "https://api.github.com/users/philberty/gists{/gist_id}", "starred_url": "https://api.github.com/users/philberty/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/philberty/subscriptions", "organizations_url": "https://api.github.com/users/philberty/orgs", "repos_url": "https://api.github.com/users/philberty/repos", "events_url": "https://api.github.com/users/philberty/events{/privacy}", "received_events_url": "https://api.github.com/users/philberty/received_events", "type": "User", "site_admin": false}, "committer": {"login": "philberty", "id": 84585, "node_id": "MDQ6VXNlcjg0NTg1", "avatar_url": "https://avatars.githubusercontent.com/u/84585?v=4", "gravatar_id": "", "url": "https://api.github.com/users/philberty", "html_url": "https://github.com/philberty", "followers_url": "https://api.github.com/users/philberty/followers", "following_url": "https://api.github.com/users/philberty/following{/other_user}", "gists_url": "https://api.github.com/users/philberty/gists{/gist_id}", "starred_url": "https://api.github.com/users/philberty/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/philberty/subscriptions", "organizations_url": "https://api.github.com/users/philberty/orgs", "repos_url": "https://api.github.com/users/philberty/repos", "events_url": "https://api.github.com/users/philberty/events{/privacy}", "received_events_url": "https://api.github.com/users/philberty/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "76ca8b8dff4837cd5d06480d4ee1f387d3750606", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/76ca8b8dff4837cd5d06480d4ee1f387d3750606", "html_url": "https://github.com/Rust-GCC/gccrs/commit/76ca8b8dff4837cd5d06480d4ee1f387d3750606"}], "stats": {"total": 6, "additions": 3, "deletions": 3}, "files": [{"sha": "f03fe06bc9c2402abe625875d7454203ba781f9b", "filename": "gcc/rust/resolve/rust-name-resolver.h", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5a73de5ee915b9eaa24d7b04b703b8bdfea0d754/gcc%2Frust%2Fresolve%2Frust-name-resolver.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5a73de5ee915b9eaa24d7b04b703b8bdfea0d754/gcc%2Frust%2Fresolve%2Frust-name-resolver.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Frust%2Fresolve%2Frust-name-resolver.h?ref=5a73de5ee915b9eaa24d7b04b703b8bdfea0d754", "patch": "@@ -33,7 +33,8 @@ class Rib\n   // Rust uses local_def_ids assigned by def_collector on the AST\n   // lets use NodeId instead\n   Rib (CrateNum crateNum, NodeId node_id)\n-    : crate_num (crateNum), node_id (node_id)\n+    : crate_num (crateNum), node_id (node_id),\n+      mappings (Analysis::Mappings::get ())\n   {}\n \n   ~Rib () {}\n@@ -59,8 +60,6 @@ class Rib\n     reverse_path_mappings.insert (std::pair<NodeId, CanonicalPath> (id, path));\n     decls_within_rib.insert (std::pair<NodeId, Location> (id, locus));\n     references[id] = {};\n-\n-    auto mappings = Analysis::Mappings::get ();\n     mappings->insert_canonical_path (mappings->get_current_crate (), id, path);\n   }\n \n@@ -155,6 +154,7 @@ class Rib\n   std::map<NodeId, CanonicalPath> reverse_path_mappings;\n   std::map<NodeId, Location> decls_within_rib;\n   std::map<NodeId, std::set<NodeId>> references;\n+  Analysis::Mappings *mappings;\n };\n \n class Scope"}]}