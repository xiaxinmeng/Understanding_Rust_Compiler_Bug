{"sha": "a5858a3dfff043b6693ab4b59ee5a41d3e20bad7", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTU4NThhM2RmZmYwNDNiNjY5M2FiNGI1OWVlNWE0MWQzZTIwYmFkNw==", "commit": {"author": {"name": "Edward Smith-Rowland", "email": "3dw4rd@verizon.net", "date": "2015-03-17T00:50:55Z"}, "committer": {"name": "Edward Smith-Rowland", "email": "emsr@gcc.gnu.org", "date": "2015-03-17T00:50:55Z"}, "message": "re PR c++/64626 (C++14 single quote should not always be a digit separator)\n\n\nlibcpp/\n\n2015-03-16  Edward Smith-Rowland  <3dw4rd@verizon.net>\n\n\tPR c++/64626\n\t* lex.c (lex_number): If a number ends with digit-seps (') skip back\n\tand let lex_string take them.\n\n\ngcc/testsuite/\n\n2015-03-16  Edward Smith-Rowland  <3dw4rd@verizon.net>\n\n\tPR c++/64626\n\tg++.dg/cpp1y/pr64626-1.C: New.\n\tg++.dg/cpp1y/pr64626-2.C: New.\n\tg++.dg/cpp1y/digit-sep-neg.C: Adjust errors and warnings.\n\nFrom-SVN: r221470", "tree": {"sha": "38dfcce3281f3ac2a7852f6219bf0a7d6d8dee9f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/38dfcce3281f3ac2a7852f6219bf0a7d6d8dee9f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a5858a3dfff043b6693ab4b59ee5a41d3e20bad7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a5858a3dfff043b6693ab4b59ee5a41d3e20bad7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a5858a3dfff043b6693ab4b59ee5a41d3e20bad7", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a5858a3dfff043b6693ab4b59ee5a41d3e20bad7/comments", "author": {"login": "emsr", "id": 1936479, "node_id": "MDQ6VXNlcjE5MzY0Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1936479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/emsr", "html_url": "https://github.com/emsr", "followers_url": "https://api.github.com/users/emsr/followers", "following_url": "https://api.github.com/users/emsr/following{/other_user}", "gists_url": "https://api.github.com/users/emsr/gists{/gist_id}", "starred_url": "https://api.github.com/users/emsr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/emsr/subscriptions", "organizations_url": "https://api.github.com/users/emsr/orgs", "repos_url": "https://api.github.com/users/emsr/repos", "events_url": "https://api.github.com/users/emsr/events{/privacy}", "received_events_url": "https://api.github.com/users/emsr/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "ec19b718ba4ebbb6148c3837a1a6f37c4a04bafd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ec19b718ba4ebbb6148c3837a1a6f37c4a04bafd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ec19b718ba4ebbb6148c3837a1a6f37c4a04bafd"}], "stats": {"total": 57, "additions": 54, "deletions": 3}, "files": [{"sha": "c8c54c78819bd9b87730fda2d44a0b0eb4369791", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a5858a3dfff043b6693ab4b59ee5a41d3e20bad7/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a5858a3dfff043b6693ab4b59ee5a41d3e20bad7/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=a5858a3dfff043b6693ab4b59ee5a41d3e20bad7", "patch": "@@ -1,3 +1,10 @@\n+2015-03-16  Edward Smith-Rowland  <3dw4rd@verizon.net>\n+\n+\tPR c++/64626\n+\tg++.dg/cpp1y/pr64626-1.C: New.\n+\tg++.dg/cpp1y/pr64626-2.C: New.\n+\tg++.dg/cpp1y/digit-sep-neg.C: Adjust errors and warnings.\n+\n 2015-03-16  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR tree-optimization/65427"}, {"sha": "54e5ed19cdccc64010e8023ed82a91a7164e7438", "filename": "gcc/testsuite/g++.dg/cpp1y/digit-sep-neg.C", "status": "modified", "additions": 7, "deletions": 3, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a5858a3dfff043b6693ab4b59ee5a41d3e20bad7/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1y%2Fdigit-sep-neg.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a5858a3dfff043b6693ab4b59ee5a41d3e20bad7/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1y%2Fdigit-sep-neg.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1y%2Fdigit-sep-neg.C?ref=a5858a3dfff043b6693ab4b59ee5a41d3e20bad7", "patch": "@@ -10,17 +10,21 @@ main()\n   i = 0004''000'000; // { dg-error \"adjacent digit separators\" }\n   i = 0B1'0'0'0'0'0'0'0'0'0'0'0'0'0'0'0'0'0'0'0'0; // OK\n   i = 0b'0001'0000'0000'0000'0000'0000; // { dg-error \"digit separator after base indicator\" }\n-  i = 0b0001'0000'0000'0000'0000'0000'; // { dg-error \"digit separator outside digit sequence\" }\n+  i = 0b0001'0000'0000'0000'0000'0000'; // { dg-error \"missing terminating\" }\n   unsigned u = 0b0001'0000'0000'0000'0000'0000'U; // { dg-error \"digit separator outside digit sequence\" }\n \n   double d = 0.0;\n   d = 1'.602'176'565e-19; // { dg-error \"digit separator adjacent to decimal point\" }\n   d = 1.'602'176'565e-19; // { dg-error \"digit separator adjacent to decimal point\" }\n   d = 1.602''176'565e-19; // { dg-error \"adjacent digit separators\" }\n   d = 1.602'176'565'e-19; // { dg-error \"digit separator adjacent to exponent\" }\n-  d = 1.602'176'565e'-19; // { dg-error \"digit separator adjacent to exponent\" }\n+  d = 1.602'176'565e'-19; // { dg-error \"missing terminating\" }\n   d = 1.602'176'565e-'19; // { dg-error \"digit separator adjacent to exponent\" }\n   d = 1.602'176'565e-1'9; // OK\n-  d = 1.602'176'565e-19'; // { dg-error \"digit separator outside digit sequence\" }\n+  d = 1.602'176'565e-19'; // { dg-error \"missing terminating\" }\n   float f = 1.602'176'565e-19'F; // { dg-error \"digit separator outside digit sequence\" }\n }\n+\n+// { dg-error \"exponent has no digits\" \"exponent has no digits\" { target *-*-* } 21 }\n+// { dg-error \"expected ';' before\" \"expected ';' before\" { target *-*-* } 14 }\n+// { dg-error \"expected ';' before\" \"expected ';' before\" { target *-*-* } 25 }"}, {"sha": "07af9f0a015f94ed3efcf1fc76610dd8aaad8046", "filename": "gcc/testsuite/g++.dg/cpp1y/pr64626-1.C", "status": "added", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a5858a3dfff043b6693ab4b59ee5a41d3e20bad7/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1y%2Fpr64626-1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a5858a3dfff043b6693ab4b59ee5a41d3e20bad7/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1y%2Fpr64626-1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1y%2Fpr64626-1.C?ref=a5858a3dfff043b6693ab4b59ee5a41d3e20bad7", "patch": "@@ -0,0 +1,20 @@\n+// PR c++/64626\n+// { dg-do compile { target c++14 } }\n+\n+#define STR(s) #s\n+int\n+main()\n+{\n+  int i = 1'2;\n+  const char *s[3]\n+  {\n+    STR(1' '),\n+    STR(..),\n+    STR(%:%),\n+  };\n+}\n+#if 0\n+1' '\n+..\n+%:%\n+#endif"}, {"sha": "62c3546718c987a2156be8ecdc8b0c7291e3c94e", "filename": "gcc/testsuite/g++.dg/cpp1y/pr64626-2.C", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a5858a3dfff043b6693ab4b59ee5a41d3e20bad7/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1y%2Fpr64626-2.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a5858a3dfff043b6693ab4b59ee5a41d3e20bad7/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1y%2Fpr64626-2.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1y%2Fpr64626-2.C?ref=a5858a3dfff043b6693ab4b59ee5a41d3e20bad7", "patch": "@@ -0,0 +1,11 @@\n+// PR c++/64626\n+// { dg-do compile { target c++14 } }\n+\n+0''; // { dg-error \"empty character constant\" }\n+\n+123'''; // { dg-error \"empty character constant\" }\n+\n+// { dg-error \"expected unqualified-id\" \"expected unqualified-id\" { target *-*-* } 4 }\n+\n+// { dg-error \"missing terminating\" \"missing terminating\" { target *-*-* } 6 }\n+// { dg-error \"expected unqualified-id\" \"expected unqualified-id\" { target *-*-* } 6 }"}, {"sha": "c759949528214beaa644f061ed1f9fc9c88cec47", "filename": "libcpp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a5858a3dfff043b6693ab4b59ee5a41d3e20bad7/libcpp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a5858a3dfff043b6693ab4b59ee5a41d3e20bad7/libcpp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libcpp%2FChangeLog?ref=a5858a3dfff043b6693ab4b59ee5a41d3e20bad7", "patch": "@@ -1,3 +1,9 @@\n+2015-03-16  Edward Smith-Rowland  <3dw4rd@verizon.net>\n+\n+\tPR c++/64626\n+\t* lex.c (lex_number): If a number ends with digit-seps (') skip back\n+\tand let lex_string take them.\n+\n 2015-03-02  Markus Trippelsdorf  <markus@trippelsdorf.de>\n \n \tPR target/65261"}, {"sha": "bca56299132bfa8ee13025bed4f753837305dbb9", "filename": "libcpp/lex.c", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a5858a3dfff043b6693ab4b59ee5a41d3e20bad7/libcpp%2Flex.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a5858a3dfff043b6693ab4b59ee5a41d3e20bad7/libcpp%2Flex.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libcpp%2Flex.c?ref=a5858a3dfff043b6693ab4b59ee5a41d3e20bad7", "patch": "@@ -1400,6 +1400,9 @@ lex_number (cpp_reader *pfile, cpp_string *number,\n \t  NORMALIZE_STATE_UPDATE_IDNUM (nst, *cur);\n \t  cur++;\n \t}\n+      /* A number can't end with a digit separator.  */\n+      while (cur > pfile->buffer->cur && DIGIT_SEP (cur[-1]))\n+\t--cur;\n \n       pfile->buffer->cur = cur;\n     }"}]}