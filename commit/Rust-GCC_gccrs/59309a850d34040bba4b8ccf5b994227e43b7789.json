{"sha": "59309a850d34040bba4b8ccf5b994227e43b7789", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTkzMDlhODUwZDM0MDQwYmJhNGI4Y2NmNWI5OTQyMjdlNDNiNzc4OQ==", "commit": {"author": {"name": "Geoff Keating", "email": "geoffk@cygnus.com", "date": "2000-02-14T19:46:02Z"}, "committer": {"name": "Geoffrey Keating", "email": "geoffk@gcc.gnu.org", "date": "2000-02-14T19:46:02Z"}, "message": "collect2.c (main): If we have frames, then we will need to import the frame handling functions.\n\n* collect2.c (main) [COLLECT_EXPORT_LIST]: If we have frames,\nthen we will need to import the frame handling functions.\n(scan_prog_file) [COLLECT_EXPORT_LIST]: We will also need\nto import the frames themselves.\n\nFrom-SVN: r31969", "tree": {"sha": "a775b2cf6195ffd669edfe387ad5512b88cf92b3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a775b2cf6195ffd669edfe387ad5512b88cf92b3"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/59309a850d34040bba4b8ccf5b994227e43b7789", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/59309a850d34040bba4b8ccf5b994227e43b7789", "html_url": "https://github.com/Rust-GCC/gccrs/commit/59309a850d34040bba4b8ccf5b994227e43b7789", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/59309a850d34040bba4b8ccf5b994227e43b7789/comments", "author": null, "committer": null, "parents": [{"sha": "11bdd2ae4efbff02dd7422fb2c5ebe39332f6046", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/11bdd2ae4efbff02dd7422fb2c5ebe39332f6046", "html_url": "https://github.com/Rust-GCC/gccrs/commit/11bdd2ae4efbff02dd7422fb2c5ebe39332f6046"}], "stats": {"total": 35, "additions": 33, "deletions": 2}, "files": [{"sha": "c6de25cbe315b8e4572535d35a39e1c8155a4979", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/59309a850d34040bba4b8ccf5b994227e43b7789/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/59309a850d34040bba4b8ccf5b994227e43b7789/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=59309a850d34040bba4b8ccf5b994227e43b7789", "patch": "@@ -1,3 +1,10 @@\n+2000-02-14  Geoff Keating  <geoffk@cygnus.com>\n+\n+\t* collect2.c (main) [COLLECT_EXPORT_LIST]: If we have frames,\n+\tthen we will need to import the frame handling functions.\n+\t(scan_prog_file) [COLLECT_EXPORT_LIST]: We will also need\n+\tto import the frames themselves.\n+\n Mon Feb 14 13:31:01 2000  Stan Cox  <scox@cygnus.com>\n                           Jason Eckhardt  <jle@cygnus.com>\n "}, {"sha": "e9c9181c15f7d871cefa7b96459202c25581c54a", "filename": "gcc/collect2.c", "status": "modified", "additions": 26, "deletions": 2, "changes": 28, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/59309a850d34040bba4b8ccf5b994227e43b7789/gcc%2Fcollect2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/59309a850d34040bba4b8ccf5b994227e43b7789/gcc%2Fcollect2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcollect2.c?ref=59309a850d34040bba4b8ccf5b994227e43b7789", "patch": "@@ -580,8 +580,10 @@ dump_file (name)\n   fclose (stream);\n }\n \f\n-/* Decide whether the given symbol is:\n-   a constructor (1), a destructor (2), or neither (0).  */\n+/* Decide whether the given symbol is: a constructor (1), a destructor\n+   (2), a routine in a shared object that calls all the constructors\n+   (3) or destructors (4), a DWARF exception-handling table (5), or\n+   nothing special (0).  */\n \n static int\n is_ctor_dtor (s)\n@@ -1279,6 +1281,14 @@ main (argc, argv)\n       scan_prog_file (list->name, PASS_FIRST);\n   }\n \n+  if (frame_tables.number > 0 && shared_obj)\n+    {\n+      /* If there are any frames, then we will need\n+         the frame table handling functions.  */\n+      add_to_list (&imports, \"__register_frame_info_table\");\n+      add_to_list (&imports, \"__deregister_frame_info\");\n+    }\n+\n   if (exports.first)\n     {\n       char *buf = xmalloc (strlen (export_file) + 5);\n@@ -2850,6 +2860,20 @@ scan_prog_file (prog_name, which_pass)\n \t\t\tcase 5:\n \t\t\t  if (! is_shared)\n \t\t\t    add_to_list (&frame_tables, name);\n+#ifdef COLLECT_EXPORT_LIST\n+\t\t\t  if (which_pass == PASS_OBJ)\n+\t\t\t    add_to_list (&exports, name);\n+\t\t\t  /* If we are building an import list, we\n+\t\t\t     should add the symbol to the list.  \n+\t\t\t     We'd like to do it only if the symbol\n+\t\t\t     is not defined, but we can't tell\n+\t\t\t     that here (it is only known whether a symbol\n+\t\t\t     is referenced and not defined, but who\n+\t\t\t     would reference an EH table entry?).  */\n+\t\t\t  else\n+\t\t\t    if (import_flag)\n+\t\t\t      add_to_list (&imports, name);\n+#endif\n \t\t\t  break;\n \n \t\t\tdefault:\t/* not a constructor or destructor */"}]}