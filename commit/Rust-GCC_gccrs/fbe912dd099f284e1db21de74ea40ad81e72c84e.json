{"sha": "fbe912dd099f284e1db21de74ea40ad81e72c84e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZmJlOTEyZGQwOTlmMjg0ZTFkYjIxZGU3NGVhNDBhZDgxZTcyYzg0ZQ==", "commit": {"author": {"name": "Brendan Kehoe", "email": "brendan@gcc.gnu.org", "date": "1996-06-19T19:19:27Z"}, "committer": {"name": "Brendan Kehoe", "email": "brendan@gcc.gnu.org", "date": "1996-06-19T19:19:27Z"}, "message": "toplev.c (flag_keep_static_consts): Define.\n\n        * toplev.c (flag_keep_static_consts): Define.\n        (f_options): Add \"keep-static-consts\" entry.\n        (compile_file): Check it in addition to !optimize for emitting\n        static const variables.\n\nFrom-SVN: r12310", "tree": {"sha": "4c64258057e83e5dfb958636fad0c5e36ec817d1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4c64258057e83e5dfb958636fad0c5e36ec817d1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/fbe912dd099f284e1db21de74ea40ad81e72c84e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fbe912dd099f284e1db21de74ea40ad81e72c84e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fbe912dd099f284e1db21de74ea40ad81e72c84e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fbe912dd099f284e1db21de74ea40ad81e72c84e/comments", "author": null, "committer": null, "parents": [{"sha": "d9ad9b6ca3432147e6846cc862ab813d63e1e097", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d9ad9b6ca3432147e6846cc862ab813d63e1e097", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d9ad9b6ca3432147e6846cc862ab813d63e1e097"}], "stats": {"total": 11, "additions": 9, "deletions": 2}, "files": [{"sha": "37579a5898b8b9bc69360298a4134f32e508ab04", "filename": "gcc/toplev.c", "status": "modified", "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fbe912dd099f284e1db21de74ea40ad81e72c84e/gcc%2Ftoplev.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fbe912dd099f284e1db21de74ea40ad81e72c84e/gcc%2Ftoplev.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftoplev.c?ref=fbe912dd099f284e1db21de74ea40ad81e72c84e", "patch": "@@ -460,6 +460,11 @@ int flag_keep_inline_functions;\n \n int flag_no_inline;\n \n+/* Nonzero means that we should emit static const variables\n+   regardless of whether or not optimization is turned on.  */\n+\n+int flag_keep_static_consts = 1;\n+\n /* Nonzero means we should be saving declaration info into a .X file.  */\n \n int flag_gen_aux_info = 0;\n@@ -575,6 +580,7 @@ struct { char *string; int *variable; int on_value;} f_options[] =\n   {\"inline-functions\", &flag_inline_functions, 1},\n   {\"keep-inline-functions\", &flag_keep_inline_functions, 1},\n   {\"inline\", &flag_no_inline, 0},\n+  {\"keep-static-consts\", &flag_keep_static_consts, 1},\n   {\"syntax-only\", &flag_syntax_only, 1},\n   {\"shared-data\", &flag_shared_data, 1},\n   {\"caller-saves\", &flag_caller_saves, 1},\n@@ -2360,7 +2366,8 @@ compile_file (name)\n \n \t    /* Don't write out static consts, unless we still need them.\n \n-\t       We also keep static consts if not optimizing (for debugging).\n+\t       We also keep static consts if not optimizing (for debugging),\n+\t       unless the user specified -fno-keep-static-consts.\n \t       ??? They might be better written into the debug information.\n \t       This is possible when using DWARF.\n \n@@ -2385,7 +2392,7 @@ compile_file (name)\n \t    if (TREE_CODE (decl) == VAR_DECL && TREE_STATIC (decl)\n \t\t&& (! TREE_READONLY (decl)\n \t\t    || TREE_PUBLIC (decl)\n-\t\t    || !optimize\n+\t\t    || (!optimize && flag_keep_static_consts)\n \t\t    || TREE_SYMBOL_REFERENCED (DECL_ASSEMBLER_NAME (decl))))\n \t      {\n \t\treconsider = 1;"}]}