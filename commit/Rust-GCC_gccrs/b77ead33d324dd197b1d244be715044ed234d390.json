{"sha": "b77ead33d324dd197b1d244be715044ed234d390", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Yjc3ZWFkMzNkMzI0ZGQxOTdiMWQyNDRiZTcxNTA0NGVkMjM0ZDM5MA==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@yorick.cygnus.com", "date": "1998-05-18T03:16:09Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "1998-05-18T03:16:09Z"}, "message": "* decl.c (make_typename_type): Use currently_open_class.\n\nFrom-SVN: r19832", "tree": {"sha": "4bbfd12ef842be2f5f567f7436715b41252ae7c2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4bbfd12ef842be2f5f567f7436715b41252ae7c2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b77ead33d324dd197b1d244be715044ed234d390", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b77ead33d324dd197b1d244be715044ed234d390", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b77ead33d324dd197b1d244be715044ed234d390", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b77ead33d324dd197b1d244be715044ed234d390/comments", "author": null, "committer": null, "parents": [{"sha": "e596622890e8bfbbf407b27bd79d5ba7918d6961", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e596622890e8bfbbf407b27bd79d5ba7918d6961", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e596622890e8bfbbf407b27bd79d5ba7918d6961"}], "stats": {"total": 11, "additions": 8, "deletions": 3}, "files": [{"sha": "6bbfcbf0ceca128e17c791cbaaf667e3c247e13c", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b77ead33d324dd197b1d244be715044ed234d390/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b77ead33d324dd197b1d244be715044ed234d390/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=b77ead33d324dd197b1d244be715044ed234d390", "patch": "@@ -1,5 +1,7 @@\n Mon May 18 03:00:57 1998  Jason Merrill  <jason@yorick.cygnus.com>\n \n+\t* decl.c (make_typename_type): Use currently_open_class.\n+\n \t* class.c (instantiate_type): Don't abort on TREE_NONLOCAL_FLAG.\n \n Mon May 18 01:43:01 1998  Martin v. Loewis  <loewis@informatik.hu-berlin.de>"}, {"sha": "4b728a05a8d7b09627470729ce12b03095db1090", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 6, "deletions": 3, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b77ead33d324dd197b1d244be715044ed234d390/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b77ead33d324dd197b1d244be715044ed234d390/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=b77ead33d324dd197b1d244be715044ed234d390", "patch": "@@ -4619,7 +4619,7 @@ make_typename_type (context, name)\n     my_friendly_abort (2000);\n \n   if (! uses_template_parms (context)\n-      || context == current_class_type)\n+      || currently_open_class (context))\n     {\n       if (TREE_CODE (fullname) == TEMPLATE_ID_EXPR)\n \t{\n@@ -4797,7 +4797,10 @@ lookup_name_real (name, prefer_type, nonclass)\n   locval = classval = NULL_TREE;\n \n   if (!current_binding_level->namespace_p\n-      && IDENTIFIER_LOCAL_VALUE (name))\n+      && IDENTIFIER_LOCAL_VALUE (name)\n+      /* Kludge to avoid infinite recursion with identifier_type_value.  */\n+      && (prefer_type <= 0\n+          || TREE_CODE (IDENTIFIER_LOCAL_VALUE (name)) == TYPE_DECL))\n     locval = IDENTIFIER_LOCAL_VALUE (name);\n \n   /* In C++ class fields are between local and global scope,\n@@ -4908,7 +4911,7 @@ lookup_name_real (name, prefer_type, nonclass)\n \t  || TREE_CODE (val) == TYPE_DECL || prefer_type <= 0)\n \t;\n       /* Caller wants a class-or-namespace-name. */\n-      else if(prefer_type == 1 && TREE_CODE (val) == NAMESPACE_DECL)\n+      else if (prefer_type == 1 && TREE_CODE (val) == NAMESPACE_DECL)\n \t;\n       else if (IDENTIFIER_HAS_TYPE_VALUE (name))\n \tval = TYPE_MAIN_DECL (IDENTIFIER_TYPE_VALUE (name));"}]}