{"sha": "949e47e5767ae98fe1f30b1b632d02fe8f553abe", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTQ5ZTQ3ZTU3NjdhZTk4ZmUxZjMwYjFiNjMyZDAyZmU4ZjU1M2FiZQ==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2012-02-21T09:24:42Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2012-02-21T09:24:42Z"}, "message": "re PR tree-optimization/52318 (ICE: in execute_todo, at passes.c:1748 with -O3 -ftracer -fno-tree-ccp -fno-tree-copy-prop -fno-tree-dce and stpcpy_chk())\n\n\tPR tree-optimization/52318\n\t* gimple-fold.c (gimplify_and_update_call_from_tree): Add\n\tvdef also to non-pure/const call stmts in the sequence.\n\n\t* gcc.dg/pr52318.c: New test.\n\nFrom-SVN: r184428", "tree": {"sha": "ec15c0db9203945d35dffdf34ff7e724e6fd048b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ec15c0db9203945d35dffdf34ff7e724e6fd048b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/949e47e5767ae98fe1f30b1b632d02fe8f553abe", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/949e47e5767ae98fe1f30b1b632d02fe8f553abe", "html_url": "https://github.com/Rust-GCC/gccrs/commit/949e47e5767ae98fe1f30b1b632d02fe8f553abe", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/949e47e5767ae98fe1f30b1b632d02fe8f553abe/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "c2885517fdda8081eca8036dc7715fe9c2c7f5a2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c2885517fdda8081eca8036dc7715fe9c2c7f5a2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c2885517fdda8081eca8036dc7715fe9c2c7f5a2"}], "stats": {"total": 37, "additions": 34, "deletions": 3}, "files": [{"sha": "ea84649ff0a68a9fe188b8668df97a4efafc5774", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/949e47e5767ae98fe1f30b1b632d02fe8f553abe/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/949e47e5767ae98fe1f30b1b632d02fe8f553abe/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=949e47e5767ae98fe1f30b1b632d02fe8f553abe", "patch": "@@ -1,3 +1,9 @@\n+2012-02-21  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR tree-optimization/52318\n+\t* gimple-fold.c (gimplify_and_update_call_from_tree): Add\n+\tvdef also to non-pure/const call stmts in the sequence.\n+\n 2012-02-20  David S. Miller  <davem@davemloft.net>\n \n \t* config/sparc/sparc.md (load_pcrel_sym<P:mode>): Explain why we"}, {"sha": "eae4cbe461525765b7247b1b380d00583698dc7e", "filename": "gcc/gimple-fold.c", "status": "modified", "additions": 6, "deletions": 3, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/949e47e5767ae98fe1f30b1b632d02fe8f553abe/gcc%2Fgimple-fold.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/949e47e5767ae98fe1f30b1b632d02fe8f553abe/gcc%2Fgimple-fold.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgimple-fold.c?ref=949e47e5767ae98fe1f30b1b632d02fe8f553abe", "patch": "@@ -1,5 +1,5 @@\n /* Statement simplification on GIMPLE.\n-   Copyright (C) 2010, 2011 Free Software Foundation, Inc.\n+   Copyright (C) 2010, 2011, 2012 Free Software Foundation, Inc.\n    Split out from tree-ssa-ccp.c.\n \n This file is part of GCC.\n@@ -591,8 +591,11 @@ gimplify_and_update_call_from_tree (gimple_stmt_iterator *si_p, tree expr)\n   for (i = gsi_last (stmts); !gsi_end_p (i); gsi_prev (&i))\n     {\n       new_stmt = gsi_stmt (i);\n-      if (gimple_assign_single_p (new_stmt)\n-\t  && !is_gimple_reg (gimple_assign_lhs (new_stmt)))\n+      if ((gimple_assign_single_p (new_stmt)\n+\t   && !is_gimple_reg (gimple_assign_lhs (new_stmt)))\n+\t  || (is_gimple_call (new_stmt)\n+\t      && (gimple_call_flags (new_stmt)\n+\t\t  & (ECF_NOVOPS | ECF_PURE | ECF_CONST | ECF_NORETURN)) == 0))\n \t{\n \t  tree vdef;\n \t  if (!laststore)"}, {"sha": "2bbb672a3d49aa3ebc12dee716595023196ba675", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/949e47e5767ae98fe1f30b1b632d02fe8f553abe/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/949e47e5767ae98fe1f30b1b632d02fe8f553abe/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=949e47e5767ae98fe1f30b1b632d02fe8f553abe", "patch": "@@ -1,3 +1,8 @@\n+2012-02-21  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR tree-optimization/52318\n+\t* gcc.dg/pr52318.c: New test.\n+\n 2012-02-20  Kai Tietz  <ktietz@redhat.com>\n \n \t* gcc.dg/bf-ms-layout-3.c: New testcase."}, {"sha": "4f367aa1cd4c59a89135b0c4acf79a595e7a086f", "filename": "gcc/testsuite/gcc.dg/pr52318.c", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/949e47e5767ae98fe1f30b1b632d02fe8f553abe/gcc%2Ftestsuite%2Fgcc.dg%2Fpr52318.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/949e47e5767ae98fe1f30b1b632d02fe8f553abe/gcc%2Ftestsuite%2Fgcc.dg%2Fpr52318.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr52318.c?ref=949e47e5767ae98fe1f30b1b632d02fe8f553abe", "patch": "@@ -0,0 +1,17 @@\n+/* PR tree-optimization/52318 */\n+/* { dg-do compile } */\n+/* { dg-options \"-O3 -ftracer -fno-tree-ccp -fno-tree-copy-prop -fno-tree-dce\" } */\n+\n+int c;\n+char *p;\n+\n+void\n+foo (int i)\n+{\n+  char a[2];\n+  char b[20];\n+  p = __builtin___stpcpy_chk (a, \"\", 2);\n+  p = __builtin___stpcpy_chk (&b[16], i ? \"e\" : \"jkl\", 4);\n+  if (c)\n+    foo (i);\n+}"}]}