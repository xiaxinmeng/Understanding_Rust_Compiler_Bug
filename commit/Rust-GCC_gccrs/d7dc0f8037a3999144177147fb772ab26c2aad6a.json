{"sha": "d7dc0f8037a3999144177147fb772ab26c2aad6a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDdkYzBmODAzN2EzOTk5MTQ0MTc3MTQ3ZmI3NzJhYjI2YzJhYWQ2YQ==", "commit": {"author": {"name": "Steven G. Kargl", "email": "kargl@gcc.gnu.org", "date": "2015-11-24T18:58:28Z"}, "committer": {"name": "Steven G. Kargl", "email": "kargl@gcc.gnu.org", "date": "2015-11-24T18:58:28Z"}, "message": "re PR fortran/68486 (187.facerec in SPEC CPU 2000 failed to build)\n\n2015-11-24  Steven G. Kargl  <kargl@gcc.gnu.org>\n\n\tPR fortran/68486\n\t* simplify.c (gfc_simplify_cshift): Allow all EXPR_*.\n\n2015-11-24  Steven G. Kargl  <kargl@gcc.gnu.org>\n\n\tPR fortran/68486\n\t* gfortran.dg/simplify_cshift_3.f90\n\nFrom-SVN: r230832", "tree": {"sha": "79e892d961ed508ee3db9343d1484245acc93b17", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/79e892d961ed508ee3db9343d1484245acc93b17"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d7dc0f8037a3999144177147fb772ab26c2aad6a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d7dc0f8037a3999144177147fb772ab26c2aad6a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d7dc0f8037a3999144177147fb772ab26c2aad6a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d7dc0f8037a3999144177147fb772ab26c2aad6a/comments", "author": null, "committer": null, "parents": [{"sha": "68ea24cb27d43522e597c2005a004c455b55115d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/68ea24cb27d43522e597c2005a004c455b55115d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/68ea24cb27d43522e597c2005a004c455b55115d"}], "stats": {"total": 64, "additions": 47, "deletions": 17}, "files": [{"sha": "adc39bb5b8c0eac19bfe5ae5c05e3da15b0a3128", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d7dc0f8037a3999144177147fb772ab26c2aad6a/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d7dc0f8037a3999144177147fb772ab26c2aad6a/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=d7dc0f8037a3999144177147fb772ab26c2aad6a", "patch": "@@ -1,3 +1,8 @@\n+2015-11-24  Steven G. Kargl  <kargl@gcc.gnu.org>\n+\n+\tPR fortran/68486\n+\t* simplify.c (gfc_simplify_cshift): Allow all EXPR_*.\n+\n 2015-11-22  Steven G. Kargl  <kargl@gcc.gnu.org>\n \n \tPR fortran/68486"}, {"sha": "c699aedc06a5f73f0033e2cba791b30593b8f733", "filename": "gcc/fortran/simplify.c", "status": "modified", "additions": 7, "deletions": 17, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d7dc0f8037a3999144177147fb772ab26c2aad6a/gcc%2Ffortran%2Fsimplify.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d7dc0f8037a3999144177147fb772ab26c2aad6a/gcc%2Ffortran%2Fsimplify.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fsimplify.c?ref=d7dc0f8037a3999144177147fb772ab26c2aad6a", "patch": "@@ -1805,23 +1805,13 @@ gfc_simplify_cshift (gfc_expr *array, gfc_expr *shift, gfc_expr *dim)\n   else\n     dm = 1;\n \n-  /* Copy array into 'a', simplify it, and then test for a constant array.\n-     An unexpected expr_type causes an ICE.   */\n-  switch (array->expr_type)\n-    {\n-      case EXPR_VARIABLE:\n-      case EXPR_ARRAY:\n-      case EXPR_OP:\n-\ta = gfc_copy_expr (array);\n-\tgfc_simplify_expr (a, 0);\n-\tif (!is_constant_array_expr (a))\n-\t  {\n-\t    gfc_free_expr (a);\n-\t    return NULL;\n-\t  }\n-\tbreak;\n-      default:\n-\tgcc_unreachable ();\n+  /* Copy array into 'a', simplify it, and then test for a constant array.  */\n+  a = gfc_copy_expr (array);\n+  gfc_simplify_expr (a, 0);\n+  if (!is_constant_array_expr (a))\n+    {\n+      gfc_free_expr (a);\n+      return NULL;\n     }\n \n   if (a->rank == 1)"}, {"sha": "5c229ceb4f2f2b3d8a6e4fc5d7a8538e3cf1fc82", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d7dc0f8037a3999144177147fb772ab26c2aad6a/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d7dc0f8037a3999144177147fb772ab26c2aad6a/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=d7dc0f8037a3999144177147fb772ab26c2aad6a", "patch": "@@ -1,3 +1,8 @@\n+2015-11-24  Steven G. Kargl  <kargl@gcc.gnu.org>\n+\n+\tPR fortran/68486\n+\t* gfortran.dg/simplify_cshift_3.f90\n+\n 2015-11-24  Paolo Carlini  <paolo.carlini@oracle.com>\n \n \tPR c++/68278"}, {"sha": "204b1239253db7c6c48424f8f96bd148e96d51b7", "filename": "gcc/testsuite/gfortran.dg/pr68227.f90", "status": "added", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d7dc0f8037a3999144177147fb772ab26c2aad6a/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr68227.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d7dc0f8037a3999144177147fb772ab26c2aad6a/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr68227.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr68227.f90?ref=d7dc0f8037a3999144177147fb772ab26c2aad6a", "patch": "@@ -0,0 +1,23 @@\n+! { dg-do compile }\n+! PR fortran/68227\n+! Original code contributed by Gerhard Steinmetz\n+! <gerhard dot steinmetz dot fortran at t-online dot de >\n+!\n+program p\n+\n+   type t\n+   end type\n+\n+   type t2\n+      type(t), pointer :: a\n+   end type\n+\n+   type(t), target :: x\n+   type(t2), pointer :: y(:)\n+   integer :: i\n+   integer :: n = 2\n+\n+   allocate (y(n))\n+   forall (i=1:n) y(i)%a = x\n+\n+end program p"}, {"sha": "26f54c5431f63cecc0ec089efd299a934e6f8f7c", "filename": "gcc/testsuite/gfortran.dg/simplify_cshift_3.f90", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d7dc0f8037a3999144177147fb772ab26c2aad6a/gcc%2Ftestsuite%2Fgfortran.dg%2Fsimplify_cshift_3.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d7dc0f8037a3999144177147fb772ab26c2aad6a/gcc%2Ftestsuite%2Fgfortran.dg%2Fsimplify_cshift_3.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fsimplify_cshift_3.f90?ref=d7dc0f8037a3999144177147fb772ab26c2aad6a", "patch": "@@ -0,0 +1,7 @@\n+! { dg-do compile }\n+subroutine foo ()\n+   real(4), allocatable, save :: tmp (:, :)\n+   real(4), pointer, save :: arr (:, :, :)\n+   integer :: l, m, n\n+   tmp = (cshift(cshift(arr (:,:,l),m,2),n,1))\n+end subroutine foo"}]}