{"sha": "9193542205121e73b434a1b5019f0d7ad26bc021", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTE5MzU0MjIwNTEyMWU3M2I0MzRhMWI1MDE5ZjBkN2FkMjZiYzAyMQ==", "commit": {"author": {"name": "Frank Ch. Eigler", "email": "fche@redhat.com", "date": "2004-05-17T20:34:19Z"}, "committer": {"name": "Frank Ch. Eigler", "email": "fche@gcc.gnu.org", "date": "2004-05-17T20:34:19Z"}, "message": "libmudflap.exp (libmudflap-init): For C++ test cases only...\n\n2004-05-17  Frank Ch. Eigler  <fche@redhat.com>\n\n\t* lib/libmudflap.exp (libmudflap-init): For C++ test cases only,\n\timport some build settings from libstdc++-v3 testsuite_flags.\n\t* .../cfrags.exp, .../c++frags.exp, .../cthfrags.exp: Corresponding\n\tchanges to pass test language.\n\n\t* mf-runtime.c (__mfu_check): Poison the cache with antidote for\n\tquicker mode-nop handling.\n\nFrom-SVN: r81944", "tree": {"sha": "4f4b2d2474d6c9f857a08c14e9b579c55282ce18", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4f4b2d2474d6c9f857a08c14e9b579c55282ce18"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9193542205121e73b434a1b5019f0d7ad26bc021", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9193542205121e73b434a1b5019f0d7ad26bc021", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9193542205121e73b434a1b5019f0d7ad26bc021", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9193542205121e73b434a1b5019f0d7ad26bc021/comments", "author": {"login": "fche", "id": 588885, "node_id": "MDQ6VXNlcjU4ODg4NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/588885?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fche", "html_url": "https://github.com/fche", "followers_url": "https://api.github.com/users/fche/followers", "following_url": "https://api.github.com/users/fche/following{/other_user}", "gists_url": "https://api.github.com/users/fche/gists{/gist_id}", "starred_url": "https://api.github.com/users/fche/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fche/subscriptions", "organizations_url": "https://api.github.com/users/fche/orgs", "repos_url": "https://api.github.com/users/fche/repos", "events_url": "https://api.github.com/users/fche/events{/privacy}", "received_events_url": "https://api.github.com/users/fche/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "66ba7273482a3c56accefba709e0dfe8f8d75824", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/66ba7273482a3c56accefba709e0dfe8f8d75824", "html_url": "https://github.com/Rust-GCC/gccrs/commit/66ba7273482a3c56accefba709e0dfe8f8d75824"}], "stats": {"total": 55, "additions": 43, "deletions": 12}, "files": [{"sha": "4ae37839b8206cea6e4b1d914f2c576a6b66f779", "filename": "libmudflap/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9193542205121e73b434a1b5019f0d7ad26bc021/libmudflap%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9193542205121e73b434a1b5019f0d7ad26bc021/libmudflap%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libmudflap%2FChangeLog?ref=9193542205121e73b434a1b5019f0d7ad26bc021", "patch": "@@ -1,3 +1,13 @@\n+2004-05-17  Frank Ch. Eigler  <fche@redhat.com>\n+\n+\t* lib/libmudflap.exp (libmudflap-init): For C++ test cases only,\n+\timport some build settings from libstdc++-v3 testsuite_flags.\n+\t* .../cfrags.exp, .../c++frags.exp, .../cthfrags.exp: Corresponding\n+\tchanges to pass test language.\n+\n+\t* mf-runtime.c (__mfu_check): Poison the cache with antidote for\n+\tquicker mode-nop handling.\n+\n 2004-03-25  Frank Ch. Eigler  <fche@redhat.com>\n \n \t* mf-impl.h: Added libgcc license header."}, {"sha": "8d5ed8c3665f0150ac4634cfb3039b639158c827", "filename": "libmudflap/mf-runtime.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9193542205121e73b434a1b5019f0d7ad26bc021/libmudflap%2Fmf-runtime.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9193542205121e73b434a1b5019f0d7ad26bc021/libmudflap%2Fmf-runtime.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libmudflap%2Fmf-runtime.c?ref=9193542205121e73b434a1b5019f0d7ad26bc021", "patch": "@@ -737,6 +737,8 @@ void __mfu_check (void *ptr, size_t sz, int type, const char *location)\n   switch (__mf_opts.mudflap_mode)\n     {\n     case mode_nop:\n+      entry->low = MINPTR;\n+      entry->high = MAXPTR;\n       judgement = 1;\n       break;\n "}, {"sha": "4e482ecbcd294b6b2c77b523443a68e7ccd678cf", "filename": "libmudflap/testsuite/lib/libmudflap.exp", "status": "modified", "additions": 28, "deletions": 9, "changes": 37, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9193542205121e73b434a1b5019f0d7ad26bc021/libmudflap%2Ftestsuite%2Flib%2Flibmudflap.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9193542205121e73b434a1b5019f0d7ad26bc021/libmudflap%2Ftestsuite%2Flib%2Flibmudflap.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libmudflap%2Ftestsuite%2Flib%2Flibmudflap.exp?ref=9193542205121e73b434a1b5019f0d7ad26bc021", "patch": "@@ -21,7 +21,7 @@\n load_lib mfdg.exp\n load_lib libgloss.exp\n \n-proc libmudflap-init { compiler } {\n+proc libmudflap-init { language } {\n     global srcdir\n     global outdir\n     global blddir\n@@ -34,9 +34,17 @@ proc libmudflap-init { compiler } {\n     global ld_library_path\n     global tool_root_dir\n \n-    verbose \"libmudflap-init $compiler\"\n+    switch $language {\n+        \"c\" { set cxx [find_gcc] }\n+        \"c++\" { set cxx [find_g++] }\n+        default { error \"bad language code $language\"; return }\n+    }\n+\n+    verbose -log \"libmudflap-init $cxx\"\n \n     set blddir [lookfor_file [get_multilibs] libmudflap]\n+    set cxxblddir [lookfor_file [get_multilibs] libstdc++-v3]\n+    set cxxflags_file \"${cxxblddir}/scripts/testsuite_flags\"\n \n     # By default, we assume we want to run program images.\n     global dg-do-what-default\n@@ -52,7 +60,7 @@ proc libmudflap-init { compiler } {\n \n     set ld_library_path \".\"\n     append ld_library_path \":${gccdir}\"\n-    append ld_library_path \":../../libstdc++-v3/src/.libs\"\n+    append ld_library_path \":${cxxblddir}/src/.libs\"\n     if {[is_remote host] == 0} {\n \tforeach i \"[exec ${gccdir}/xgcc --print-multi-lib]\" {\n \t    set mldir \"\"\n@@ -63,17 +71,28 @@ proc libmudflap-init { compiler } {\n \t    }\n \t    if { [llength [glob -nocomplain ${gccdir}/${mldir}/libgcc_s*.so.*]] == 1 } {\n \t\tappend ld_library_path \":${gccdir}/${mldir}\"\n-\t\tappend ld_library_path \":../../libstdc++-v3/${mldir}/src/.libs\"\n \t    }\n \t}\n     }\n     append ld_library_path \":${blddir}/.libs\"\n-    set cxx $compiler\n-    set libs \"-L../.libs -L../../libstdc++-v3/src/.libs -L../../../gcc\"\n+\n+    set libs \"-L../.libs -L../../../gcc\"\n     set cxxflags \"-ggdb3 -DDEBUG_ASSERT\"\n     set includes \"-I${srcdir} -I..\"\n \n-    verbose \"ld_library_path=$ld_library_path\"\n+    if {$language == \"c++\"} {\n+        if {[file exists $cxxflags_file]} then {\n+            set includes \"${includes} [exec sh $cxxflags_file --build-includes]\"\n+            set cxxflags \"${cxxflags} [exec sh $cxxflags_file --cxxflags]\"\n+            # c++ libs are included by --build-cxx below\n+            set cxx \"[exec sh $cxxflags_file --build-cxx]\"\n+        } else {\n+            lappend libs \"-L../../libstdc++-v3/src/.libs\"\n+            lappend includes \"-I../../libstdc++-v3/include\"\n+        }\n+    }\n+\n+    verbose -log \"ld_library_path=$ld_library_path\"\n     setenv  LD_LIBRARY_PATH     $ld_library_path\n     setenv  SHLIB_PATH          $ld_library_path\n     setenv  LD_LIBRARYN32_PATH  $ld_library_path\n@@ -212,9 +231,9 @@ proc libmudflap-list-sourcefiles { } {\n \tset res {}\n \tforeach w $sfiles {\n \t    if [regexp \"wchar_t\" $w] {\n-\t\tverbose \"element out list is $w\"\n+\t\tverbose -log \"element out list is $w\"\n \t    } else {\n-\t\tverbose \"element in list is $w\"\n+\t\tverbose -log \"element in list is $w\"\n \t\tlappend res $w\n \t    }\n \t}"}, {"sha": "659494b3e00a59ea1f75cea3b0fbe2890dbd5f5e", "filename": "libmudflap/testsuite/libmudflap.c++/c++frags.exp", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9193542205121e73b434a1b5019f0d7ad26bc021/libmudflap%2Ftestsuite%2Flibmudflap.c%2B%2B%2Fc%2B%2Bfrags.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9193542205121e73b434a1b5019f0d7ad26bc021/libmudflap%2Ftestsuite%2Flibmudflap.c%2B%2B%2Fc%2B%2Bfrags.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libmudflap%2Ftestsuite%2Flibmudflap.c%2B%2B%2Fc%2B%2Bfrags.exp?ref=9193542205121e73b434a1b5019f0d7ad26bc021", "patch": "@@ -1,5 +1,5 @@\n \n-libmudflap-init [find_g++]\n+libmudflap-init c++\n \n dg-init\n "}, {"sha": "2d6132bf931f246caa83863b923836483e2f3a02", "filename": "libmudflap/testsuite/libmudflap.c/cfrags.exp", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9193542205121e73b434a1b5019f0d7ad26bc021/libmudflap%2Ftestsuite%2Flibmudflap.c%2Fcfrags.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9193542205121e73b434a1b5019f0d7ad26bc021/libmudflap%2Ftestsuite%2Flibmudflap.c%2Fcfrags.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libmudflap%2Ftestsuite%2Flibmudflap.c%2Fcfrags.exp?ref=9193542205121e73b434a1b5019f0d7ad26bc021", "patch": "@@ -1,5 +1,5 @@\n \n-libmudflap-init [find_gcc]\n+libmudflap-init c\n \n dg-init\n "}, {"sha": "3431965dd625b482c5c8f62282679520c66a03b2", "filename": "libmudflap/testsuite/libmudflap.cth/cthfrags.exp", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9193542205121e73b434a1b5019f0d7ad26bc021/libmudflap%2Ftestsuite%2Flibmudflap.cth%2Fcthfrags.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9193542205121e73b434a1b5019f0d7ad26bc021/libmudflap%2Ftestsuite%2Flibmudflap.cth%2Fcthfrags.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libmudflap%2Ftestsuite%2Flibmudflap.cth%2Fcthfrags.exp?ref=9193542205121e73b434a1b5019f0d7ad26bc021", "patch": "@@ -1,5 +1,5 @@\n \n-libmudflap-init [find_gcc]\n+libmudflap-init c\n \n dg-init\n "}]}