{"sha": "bae7b38cf8a21e068ad5c0bab089dedb78af3346", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmFlN2IzOGNmOGEyMWUwNjhhZDVjMGJhYjA4OWRlZGI3OGFmMzM0Ng==", "commit": {"author": {"name": "Vladimir N. Makarov", "email": "vmakarov@redhat.com", "date": "2020-03-16T20:42:19Z"}, "committer": {"name": "Vladimir N. Makarov", "email": "vmakarov@redhat.com", "date": "2020-03-16T20:42:19Z"}, "message": "Fix PR94185: Do not reuse insn alternative after changing memory subreg.\n\n2020-03-16  Vladimir Makarov  <vmakarov@redhat.com>\n\n\tPR target/94185\n\t* lra-spills.c (remove_pseudos): Do not reuse insn alternative\n\tafter changing memory subreg.\n\n2020-03-16  Vladimir Makarov  <vmakarov@redhat.com>\n\n\tPR target/94185\n\t* g++.target/i386/pr94185.C: New test.", "tree": {"sha": "81528af6fab8dc779f1d3565581128149cb27255", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/81528af6fab8dc779f1d3565581128149cb27255"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bae7b38cf8a21e068ad5c0bab089dedb78af3346", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bae7b38cf8a21e068ad5c0bab089dedb78af3346", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bae7b38cf8a21e068ad5c0bab089dedb78af3346", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bae7b38cf8a21e068ad5c0bab089dedb78af3346/comments", "author": {"login": "vnmakarov", "id": 9855671, "node_id": "MDQ6VXNlcjk4NTU2NzE=", "avatar_url": "https://avatars.githubusercontent.com/u/9855671?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vnmakarov", "html_url": "https://github.com/vnmakarov", "followers_url": "https://api.github.com/users/vnmakarov/followers", "following_url": "https://api.github.com/users/vnmakarov/following{/other_user}", "gists_url": "https://api.github.com/users/vnmakarov/gists{/gist_id}", "starred_url": "https://api.github.com/users/vnmakarov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vnmakarov/subscriptions", "organizations_url": "https://api.github.com/users/vnmakarov/orgs", "repos_url": "https://api.github.com/users/vnmakarov/repos", "events_url": "https://api.github.com/users/vnmakarov/events{/privacy}", "received_events_url": "https://api.github.com/users/vnmakarov/received_events", "type": "User", "site_admin": false}, "committer": {"login": "vnmakarov", "id": 9855671, "node_id": "MDQ6VXNlcjk4NTU2NzE=", "avatar_url": "https://avatars.githubusercontent.com/u/9855671?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vnmakarov", "html_url": "https://github.com/vnmakarov", "followers_url": "https://api.github.com/users/vnmakarov/followers", "following_url": "https://api.github.com/users/vnmakarov/following{/other_user}", "gists_url": "https://api.github.com/users/vnmakarov/gists{/gist_id}", "starred_url": "https://api.github.com/users/vnmakarov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vnmakarov/subscriptions", "organizations_url": "https://api.github.com/users/vnmakarov/orgs", "repos_url": "https://api.github.com/users/vnmakarov/repos", "events_url": "https://api.github.com/users/vnmakarov/events{/privacy}", "received_events_url": "https://api.github.com/users/vnmakarov/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f522810d2b5edb4008afc4a8d003b7e182aa8ba2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f522810d2b5edb4008afc4a8d003b7e182aa8ba2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f522810d2b5edb4008afc4a8d003b7e182aa8ba2"}], "stats": {"total": 56, "additions": 55, "deletions": 1}, "files": [{"sha": "25a27f8070d4f8f32488359b1645a1d7290d026d", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bae7b38cf8a21e068ad5c0bab089dedb78af3346/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bae7b38cf8a21e068ad5c0bab089dedb78af3346/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=bae7b38cf8a21e068ad5c0bab089dedb78af3346", "patch": "@@ -1,3 +1,9 @@\n+2020-03-16  Vladimir Makarov  <vmakarov@redhat.com>\n+\n+\tPR target/94185\n+\t* lra-spills.c (remove_pseudos): Do not reuse insn alternative\n+\tafter changing memory subreg.\n+\n 2020-03-16  Andre Vieira  <andre.simoesdiasvieira@arm.com>\n             Srinath Parvathaneni  <srinath.parvathaneni@arm.com>\n "}, {"sha": "a4b955ac3d405a6f0c42bf4a60ef494236678ff3", "filename": "gcc/lra-spills.c", "status": "modified", "additions": 11, "deletions": 1, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bae7b38cf8a21e068ad5c0bab089dedb78af3346/gcc%2Flra-spills.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bae7b38cf8a21e068ad5c0bab089dedb78af3346/gcc%2Flra-spills.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flra-spills.c?ref=bae7b38cf8a21e068ad5c0bab089dedb78af3346", "patch": "@@ -427,7 +427,17 @@ remove_pseudos (rtx *loc, rtx_insn *insn)\n          and avoid LRA cycling in case of subreg memory reload.  */\n       res = remove_pseudos (&SUBREG_REG (*loc), insn);\n       if (GET_CODE (SUBREG_REG (*loc)) == MEM)\n-\talter_subreg (loc, false);\n+\t{\n+\t  alter_subreg (loc, false);\n+\t  if (GET_CODE (*loc) == MEM)\n+\t    {\n+\t      lra_get_insn_recog_data (insn)->used_insn_alternative = -1;\n+\t      if (lra_dump_file != NULL)\n+\t\tfprintf (lra_dump_file,\n+\t\t\t \"Memory subreg was simplified in in insn #%u\\n\",\n+\t\t\t INSN_UID (insn));\n+\t    }\n+\t}\n       return res;\n     }\n   else if (code == REG && (i = REGNO (*loc)) >= FIRST_PSEUDO_REGISTER"}, {"sha": "3b277cecac3b222602054530449c374625d99fec", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bae7b38cf8a21e068ad5c0bab089dedb78af3346/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bae7b38cf8a21e068ad5c0bab089dedb78af3346/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=bae7b38cf8a21e068ad5c0bab089dedb78af3346", "patch": "@@ -1,3 +1,8 @@\n+2020-03-16  Vladimir Makarov  <vmakarov@redhat.com>\n+\n+\tPR target/94185\n+\t* g++.target/i386/pr94185.C: New test.\n+\n 2020-03-16  Richard Sandiford  <richard.sandiford@arm.com>\n \n \t* gcc.target/aarch64/sve/acle/general-c/sizeless-1.c: Add a test"}, {"sha": "587b7bac6db47c34e57592bccdff960ae9fee8b0", "filename": "gcc/testsuite/g++.target/i386/pr94185.C", "status": "added", "additions": 33, "deletions": 0, "changes": 33, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bae7b38cf8a21e068ad5c0bab089dedb78af3346/gcc%2Ftestsuite%2Fg%2B%2B.target%2Fi386%2Fpr94185.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bae7b38cf8a21e068ad5c0bab089dedb78af3346/gcc%2Ftestsuite%2Fg%2B%2B.target%2Fi386%2Fpr94185.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.target%2Fi386%2Fpr94185.C?ref=bae7b38cf8a21e068ad5c0bab089dedb78af3346", "patch": "@@ -0,0 +1,33 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -fPIE -fstack-protector-strong\" } */\n+\n+struct a {\n+  int b;\n+  int c();\n+  a() : b(c()) {}\n+  ~a();\n+  char *e();\n+};\n+struct f {\n+  void g(int);\n+};\n+struct ar {\n+  int au[256];\n+  f h(int);\n+} bb;\n+a i();\n+a j(int);\n+long k(int, ar);\n+int d;\n+void l(char *, ar m, long n) {\n+  switch (m.au[d])\n+  case 0:\n+    n &= 4294967295;\n+  bb.h(0).g(n);\n+}\n+void o() {\n+  ar bd;\n+  a bh, bi, attrname = j(0) = i();\n+  int be = k(0, bd);\n+  l(attrname.e(), bd, be);\n+}"}]}