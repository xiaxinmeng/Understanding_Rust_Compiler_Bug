{"sha": "4d16a7b7c29ca46e15e7d8d305b9522addbcdc62", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NGQxNmE3YjdjMjljYTQ2ZTE1ZTdkOGQzMDViOTUyMmFkZGJjZGM2Mg==", "commit": {"author": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2008-07-13T20:55:47Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2008-07-13T20:55:47Z"}, "message": "tree.c (decl_assembler_name_equal): Expect assembler name of decl to be mangled too.\n\n\n\t* tree.c (decl_assembler_name_equal): Expect assembler name of decl\n\tto be mangled too.\n\nFrom-SVN: r137756", "tree": {"sha": "7e76dbeb22b728700c3425bdf242521ccdfe4cd8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7e76dbeb22b728700c3425bdf242521ccdfe4cd8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4d16a7b7c29ca46e15e7d8d305b9522addbcdc62", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4d16a7b7c29ca46e15e7d8d305b9522addbcdc62", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4d16a7b7c29ca46e15e7d8d305b9522addbcdc62", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4d16a7b7c29ca46e15e7d8d305b9522addbcdc62/comments", "author": null, "committer": null, "parents": [{"sha": "f4c91e0d876115fe3e6a04d88fc89235127a5390", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f4c91e0d876115fe3e6a04d88fc89235127a5390", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f4c91e0d876115fe3e6a04d88fc89235127a5390"}], "stats": {"total": 40, "additions": 33, "deletions": 7}, "files": [{"sha": "4a98d096ee4283aa1124037d9c8bd1b1d1b235ba", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4d16a7b7c29ca46e15e7d8d305b9522addbcdc62/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4d16a7b7c29ca46e15e7d8d305b9522addbcdc62/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=4d16a7b7c29ca46e15e7d8d305b9522addbcdc62", "patch": "@@ -1,3 +1,8 @@\n+2008-07-13  Jan Hubicka  <jh@suse.cz>\n+\n+\t* tree.c (decl_assembler_name_equal): Expect assembler name of decl\n+\tto be mangled too.\n+\n 2008-07-13  Richard Guenther  <rguenther@suse.de>\n \n \tPR middle-end/36811"}, {"sha": "0bb9fd9367f822d6c78ed2f1a1d068fb24a58d21", "filename": "gcc/tree.c", "status": "modified", "additions": 28, "deletions": 7, "changes": 35, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4d16a7b7c29ca46e15e7d8d305b9522addbcdc62/gcc%2Ftree.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4d16a7b7c29ca46e15e7d8d305b9522addbcdc62/gcc%2Ftree.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree.c?ref=4d16a7b7c29ca46e15e7d8d305b9522addbcdc62", "patch": "@@ -350,32 +350,53 @@ bool\n decl_assembler_name_equal (tree decl, const_tree asmname)\n {\n   tree decl_asmname = DECL_ASSEMBLER_NAME (decl);\n+  const char *decl_str;\n+  const char *asmname_str;\n+  bool test = false;\n \n   if (decl_asmname == asmname)\n     return true;\n \n+  decl_str = IDENTIFIER_POINTER (decl_asmname);\n+  asmname_str = IDENTIFIER_POINTER (asmname);\n+  \n+\n   /* If the target assembler name was set by the user, things are trickier.\n      We have a leading '*' to begin with.  After that, it's arguable what\n      is the correct thing to do with -fleading-underscore.  Arguably, we've\n      historically been doing the wrong thing in assemble_alias by always\n      printing the leading underscore.  Since we're not changing that, make\n      sure user_label_prefix follows the '*' before matching.  */\n-  if (IDENTIFIER_POINTER (decl_asmname)[0] == '*')\n+  if (decl_str[0] == '*')\n     {\n-      const char *decl_str = IDENTIFIER_POINTER (decl_asmname) + 1;\n       size_t ulp_len = strlen (user_label_prefix);\n \n+      decl_str ++;\n+\n       if (ulp_len == 0)\n-\t;\n+\ttest = true;\n       else if (strncmp (decl_str, user_label_prefix, ulp_len) == 0)\n-\tdecl_str += ulp_len;\n+\tdecl_str += ulp_len, test=true;\n       else\n-\treturn false;\n+\tdecl_str --;\n+    }\n+  if (asmname_str[0] == '*')\n+    {\n+      size_t ulp_len = strlen (user_label_prefix);\n \n-      return strcmp (decl_str, IDENTIFIER_POINTER (asmname)) == 0;\n+      asmname_str ++;\n+\n+      if (ulp_len == 0)\n+\ttest = true;\n+      else if (strncmp (asmname_str, user_label_prefix, ulp_len) == 0)\n+\tasmname_str += ulp_len, test=true;\n+      else\n+\tasmname_str --;\n     }\n \n-  return false;\n+  if (!test)\n+    return false;\n+  return strcmp (decl_str, asmname_str) == 0;\n }\n \n /* Hash asmnames ignoring the user specified marks.  */"}]}