{"sha": "03ed2915c2a82c3b03966716bca4380ede36d33c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDNlZDI5MTVjMmE4MmMzYjAzOTY2NzE2YmNhNDM4MGVkZTM2ZDMzYw==", "commit": {"author": {"name": "Uros Bizjak", "email": "ubizjak@gmail.com", "date": "2017-07-10T22:01:06Z"}, "committer": {"name": "Uros Bizjak", "email": "uros@gcc.gnu.org", "date": "2017-07-10T22:01:06Z"}, "message": "re PR target/81375 (unrecognizable insn)\n\n\tPR target/81375\n\t* config/i386/i386.md (divsf3): Add TARGET_SSE to TARGET_SSE_MATH.\n\t(rcpps): Ditto.\n\t(*rsqrtsf2_sse): Ditto.\n\t(rsqrtsf2): Ditto.\n\t(div<mode>3): Macroize insn from divdf3 and divsf3\n\tusing MODEF mode iterator.\n\ntestsuite/ChangeLog:\n\n\tPR target/81375\n\t* gcc.target/i386/pr81375.c: New test.\n\nFrom-SVN: r250107", "tree": {"sha": "88d0eea829b7c6db087037688b723a0253cd1be7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/88d0eea829b7c6db087037688b723a0253cd1be7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/03ed2915c2a82c3b03966716bca4380ede36d33c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/03ed2915c2a82c3b03966716bca4380ede36d33c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/03ed2915c2a82c3b03966716bca4380ede36d33c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/03ed2915c2a82c3b03966716bca4380ede36d33c/comments", "author": {"login": "ubizjak", "id": 55479990, "node_id": "MDQ6VXNlcjU1NDc5OTkw", "avatar_url": "https://avatars.githubusercontent.com/u/55479990?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ubizjak", "html_url": "https://github.com/ubizjak", "followers_url": "https://api.github.com/users/ubizjak/followers", "following_url": "https://api.github.com/users/ubizjak/following{/other_user}", "gists_url": "https://api.github.com/users/ubizjak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ubizjak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ubizjak/subscriptions", "organizations_url": "https://api.github.com/users/ubizjak/orgs", "repos_url": "https://api.github.com/users/ubizjak/repos", "events_url": "https://api.github.com/users/ubizjak/events{/privacy}", "received_events_url": "https://api.github.com/users/ubizjak/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "9c582dbb57486afa5675217dd0cccf3ba5bea4eb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9c582dbb57486afa5675217dd0cccf3ba5bea4eb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9c582dbb57486afa5675217dd0cccf3ba5bea4eb"}], "stats": {"total": 60, "additions": 36, "deletions": 24}, "files": [{"sha": "908e8cad3e81f9fd31c63a9be45945d0d288ae54", "filename": "gcc/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/03ed2915c2a82c3b03966716bca4380ede36d33c/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/03ed2915c2a82c3b03966716bca4380ede36d33c/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=03ed2915c2a82c3b03966716bca4380ede36d33c", "patch": "@@ -1,3 +1,13 @@\n+2017-07-10  Uros Bizjak  <ubizjak@gmail.com>\n+\n+\tPR target/81375\n+\t* config/i386/i386.md (divsf3): Add TARGET_SSE to TARGET_SSE_MATH.\n+\t(rcpps): Ditto.\n+\t(*rsqrtsf2_sse): Ditto.\n+\t(rsqrtsf2): Ditto.\n+\t(div<mode>3): Macroize insn from divdf3 and divsf3\n+\tusing MODEF mode iterator.\n+\n 2017-07-10  Martin Sebor  <msebor@redhat.com>\n \n \tPR tree-optimization/80397"}, {"sha": "4018e6746b696320b2a77d1622e9094fc83ffee4", "filename": "gcc/config/i386/i386.md", "status": "modified", "additions": 13, "deletions": 19, "changes": 32, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/03ed2915c2a82c3b03966716bca4380ede36d33c/gcc%2Fconfig%2Fi386%2Fi386.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/03ed2915c2a82c3b03966716bca4380ede36d33c/gcc%2Fconfig%2Fi386%2Fi386.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386.md?ref=03ed2915c2a82c3b03966716bca4380ede36d33c", "patch": "@@ -5504,7 +5504,7 @@\n (define_expand \"floatunsdisf2\"\n   [(use (match_operand:SF 0 \"register_operand\"))\n    (use (match_operand:DI 1 \"nonimmediate_operand\"))]\n-  \"TARGET_64BIT && TARGET_SSE_MATH\"\n+  \"TARGET_64BIT && TARGET_SSE && TARGET_SSE_MATH\"\n   \"x86_emit_floatuns (operands); DONE;\")\n \n (define_expand \"floatunsdidf2\"\n@@ -7545,21 +7545,15 @@\n \t\t(match_operand:XF 2 \"register_operand\")))]\n   \"TARGET_80387\")\n \n-(define_expand \"divdf3\"\n-  [(set (match_operand:DF 0 \"register_operand\")\n- \t(div:DF (match_operand:DF 1 \"register_operand\")\n- \t\t(match_operand:DF 2 \"nonimmediate_operand\")))]\n-   \"(TARGET_80387 && X87_ENABLE_ARITH (DFmode))\n-    || (TARGET_SSE2 && TARGET_SSE_MATH)\")\n-\n-(define_expand \"divsf3\"\n-  [(set (match_operand:SF 0 \"register_operand\")\n-\t(div:SF (match_operand:SF 1 \"register_operand\")\n-\t\t(match_operand:SF 2 \"nonimmediate_operand\")))]\n-  \"(TARGET_80387 && X87_ENABLE_ARITH (SFmode))\n-    || TARGET_SSE_MATH\"\n+(define_expand \"div<mode>3\"\n+  [(set (match_operand:MODEF 0 \"register_operand\")\n+\t(div:MODEF (match_operand:MODEF 1 \"register_operand\")\n+\t\t   (match_operand:MODEF 2 \"nonimmediate_operand\")))]\n+  \"(TARGET_80387 && X87_ENABLE_ARITH (<MODE>mode))\n+    || (SSE_FLOAT_MODE_P (<MODE>mode) && TARGET_SSE_MATH)\"\n {\n-  if (TARGET_SSE_MATH\n+  if (<MODE>mode == SFmode\n+      && TARGET_SSE && TARGET_SSE_MATH\n       && TARGET_RECIP_DIV\n       && optimize_insn_for_speed_p ()\n       && flag_finite_math_only && !flag_trapping_math\n@@ -14050,7 +14044,7 @@\n   [(set (match_operand:SF 0 \"register_operand\" \"=x\")\n \t(unspec:SF [(match_operand:SF 1 \"nonimmediate_operand\" \"xm\")]\n \t\t   UNSPEC_RCP))]\n-  \"TARGET_SSE_MATH\"\n+  \"TARGET_SSE && TARGET_SSE_MATH\"\n   \"%vrcpss\\t{%1, %d0|%d0, %1}\"\n   [(set_attr \"type\" \"sse\")\n    (set_attr \"atom_sse_attr\" \"rcp\")\n@@ -14352,7 +14346,7 @@\n   [(set (match_operand:SF 0 \"register_operand\" \"=x\")\n \t(unspec:SF [(match_operand:SF 1 \"nonimmediate_operand\" \"xm\")]\n \t\t   UNSPEC_RSQRT))]\n-  \"TARGET_SSE_MATH\"\n+  \"TARGET_SSE && TARGET_SSE_MATH\"\n   \"%vrsqrtss\\t{%1, %d0|%d0, %1}\"\n   [(set_attr \"type\" \"sse\")\n    (set_attr \"atom_sse_attr\" \"rcp\")\n@@ -14364,7 +14358,7 @@\n   [(set (match_operand:SF 0 \"register_operand\")\n \t(unspec:SF [(match_operand:SF 1 \"nonimmediate_operand\")]\n \t\t   UNSPEC_RSQRT))]\n-  \"TARGET_SSE_MATH\"\n+  \"TARGET_SSE && TARGET_SSE_MATH\"\n {\n   ix86_emit_swsqrtsf (operands[0], operands[1], SFmode, 1);\n   DONE;\n@@ -14393,7 +14387,7 @@\n    || (SSE_FLOAT_MODE_P (<MODE>mode) && TARGET_SSE_MATH)\"\n {\n   if (<MODE>mode == SFmode\n-      && TARGET_SSE_MATH\n+      && TARGET_SSE && TARGET_SSE_MATH\n       && TARGET_RECIP_SQRT\n       && !optimize_function_for_size_p (cfun)\n       && flag_finite_math_only && !flag_trapping_math"}, {"sha": "f6dec47d0481c238aedb90d36bc13a0f1158ca58", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/03ed2915c2a82c3b03966716bca4380ede36d33c/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/03ed2915c2a82c3b03966716bca4380ede36d33c/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=03ed2915c2a82c3b03966716bca4380ede36d33c", "patch": "@@ -1,12 +1,12 @@\n+2017-07-10  Uros Bizjak  <ubizjak@gmail.com>\n+\n+\tPR target/81375\n+\t* gcc.target/i386/pr81375.c: New test.\n+\n 2017-07-10  Martin Sebor  <msebor@redhat.com>\n \n \tPR tree-optimization/80397\n \t* gcc.dg/tree-ssa/builtin-sprintf-warn-17.c: New test.\n-diff --git a/gcc/gimple-ssa-sprintf.c b/gcc/gimple-ssa-sprintf.c\n-index 2e62086..d63d5be 100644\n---- a/gcc/gimple-ssa-sprintf.c\n-+++ b/gcc/gimple-ssa-sprintf.c\n-@@ -1249,7 +1249,7 @@ format_integer (const directive &dir, tree arg)\n \n 2017-07-10  Martin Sebor  <msebor@redhat.com>\n "}, {"sha": "256a79df71968c8d67965018c3acd733ee7039fd", "filename": "gcc/testsuite/gcc.target/i386/pr81375.c", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/03ed2915c2a82c3b03966716bca4380ede36d33c/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr81375.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/03ed2915c2a82c3b03966716bca4380ede36d33c/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr81375.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr81375.c?ref=03ed2915c2a82c3b03966716bca4380ede36d33c", "patch": "@@ -0,0 +1,8 @@\n+/* PR target/81375 */\n+/* { dg-do compile { target ia32 } } */\n+/* { dg-options \"-mno-80387 -mno-sse -mfpmath=sse\" } */\n+\n+float foo (float a, float b)\n+{\n+  return a / b;\n+}"}]}