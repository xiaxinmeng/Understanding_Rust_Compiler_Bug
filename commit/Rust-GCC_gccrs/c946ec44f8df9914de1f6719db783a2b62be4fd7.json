{"sha": "c946ec44f8df9914de1f6719db783a2b62be4fd7", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Yzk0NmVjNDRmOGRmOTkxNGRlMWY2NzE5ZGI3ODNhMmI2MmJlNGZkNw==", "commit": {"author": {"name": "Corey Minyard", "email": "minyard@acm.org", "date": "2001-09-05T17:48:18Z"}, "committer": {"name": "Tom Tromey", "email": "tromey@gcc.gnu.org", "date": "2001-09-05T17:48:18Z"}, "message": "natClassLoader.cc: Include VirtualMachineError.h\n\n2001-09-05  Corey Minyard  <minyard@acm.org>\n\t    Tom Tromey  <tromey@redhat.com>\n\n\t* java/lang/natClassLoader.cc: Include VirtualMachineError.h\n\t(_Jv_RegisterClassHookDefault): Throw error if a class is\n\tregistered twice.\n\nCo-Authored-By: Tom Tromey <tromey@redhat.com>\n\nFrom-SVN: r45418", "tree": {"sha": "883d30c25b30bb57d4b45b846e61dc39052a33ec", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/883d30c25b30bb57d4b45b846e61dc39052a33ec"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c946ec44f8df9914de1f6719db783a2b62be4fd7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c946ec44f8df9914de1f6719db783a2b62be4fd7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c946ec44f8df9914de1f6719db783a2b62be4fd7", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c946ec44f8df9914de1f6719db783a2b62be4fd7/comments", "author": {"login": "cminyard", "id": 4389272, "node_id": "MDQ6VXNlcjQzODkyNzI=", "avatar_url": "https://avatars.githubusercontent.com/u/4389272?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cminyard", "html_url": "https://github.com/cminyard", "followers_url": "https://api.github.com/users/cminyard/followers", "following_url": "https://api.github.com/users/cminyard/following{/other_user}", "gists_url": "https://api.github.com/users/cminyard/gists{/gist_id}", "starred_url": "https://api.github.com/users/cminyard/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cminyard/subscriptions", "organizations_url": "https://api.github.com/users/cminyard/orgs", "repos_url": "https://api.github.com/users/cminyard/repos", "events_url": "https://api.github.com/users/cminyard/events{/privacy}", "received_events_url": "https://api.github.com/users/cminyard/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "c1a13c5f88996b26641bde1dbfb7b0e47dccfc51", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c1a13c5f88996b26641bde1dbfb7b0e47dccfc51", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c1a13c5f88996b26641bde1dbfb7b0e47dccfc51"}], "stats": {"total": 24, "additions": 24, "deletions": 0}, "files": [{"sha": "e867cbfcf7b91fc262294067871aa992d9276694", "filename": "libjava/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c946ec44f8df9914de1f6719db783a2b62be4fd7/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c946ec44f8df9914de1f6719db783a2b62be4fd7/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=c946ec44f8df9914de1f6719db783a2b62be4fd7", "patch": "@@ -1,3 +1,10 @@\n+2001-09-05  Corey Minyard  <minyard@acm.org>\n+\t    Tom Tromey  <tromey@redhat.com>\n+\n+\t* java/lang/natClassLoader.cc: Include VirtualMachineError.h\n+\t(_Jv_RegisterClassHookDefault): Throw error if a class is\n+\tregistered twice.\n+\n 2001-09-05  Tom Tromey  <tromey@redhat.com>\n \n \t* java/lang/natSystem.cc (init_properties): Default locale is"}, {"sha": "70dea6db84a89f4a1140bba27c833867fc6226ce", "filename": "libjava/java/lang/natClassLoader.cc", "status": "modified", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c946ec44f8df9914de1f6719db783a2b62be4fd7/libjava%2Fjava%2Flang%2FnatClassLoader.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c946ec44f8df9914de1f6719db783a2b62be4fd7/libjava%2Fjava%2Flang%2FnatClassLoader.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjava%2Flang%2FnatClassLoader.cc?ref=c946ec44f8df9914de1f6719db783a2b62be4fd7", "patch": "@@ -33,6 +33,7 @@ details.  */\n #include <java/lang/ClassNotFoundException.h>\n #include <java/lang/ClassCircularityError.h>\n #include <java/lang/IncompatibleClassChangeError.h>\n+#include <java/lang/VirtualMachineError.h>\n #include <java/lang/reflect/Modifier.h>\n #include <java/lang/Runtime.h>\n #include <java/lang/StringBuffer.h>\n@@ -453,6 +454,22 @@ void\n _Jv_RegisterClassHookDefault (jclass klass)\n {\n   jint hash = HASH_UTF (klass->name);\n+\n+  jclass check_class = loaded_classes[hash];\n+\n+  // If the class is already registered, don't re-register it.\n+  while (check_class != NULL)\n+    {\n+      if (check_class == klass)\n+\t{\n+\t  // If you get this, it means you have the same class in two\n+\t  // different libraries.\n+\t  throw new java::lang::VirtualMachineError (JvNewStringLatin1 (\"class registered twice\"));\n+\t}\n+\n+      check_class = check_class->next;\n+    }\n+\n   klass->next = loaded_classes[hash];\n   loaded_classes[hash] = klass;\n }"}]}