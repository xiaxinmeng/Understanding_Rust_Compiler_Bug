{"sha": "04c90eea0779dd173baa01b96aed683fec326207", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDRjOTBlZWEwNzc5ZGQxNzNiYWEwMWI5NmFlZDY4M2ZlYzMyNjIwNw==", "commit": {"author": {"name": "Devang Patel", "email": "dpatel@apple.com", "date": "2005-02-19T19:48:02Z"}, "committer": {"name": "Devang Patel", "email": "dpatel@gcc.gnu.org", "date": "2005-02-19T19:48:02Z"}, "message": "charset.c (_cpp_convert_input): Check '\\r' before inserting '\\n' at the end.\n\n      * charset.c (_cpp_convert_input): Check '\\r' before inserting\n      '\\n' at the end.\n      * gcc.dg/cpp/mac-eol-at-eof.c: New test.\n\nFrom-SVN: r95289", "tree": {"sha": "374c60752b401e773bee9a1c4325104556d62c52", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/374c60752b401e773bee9a1c4325104556d62c52"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/04c90eea0779dd173baa01b96aed683fec326207", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/04c90eea0779dd173baa01b96aed683fec326207", "html_url": "https://github.com/Rust-GCC/gccrs/commit/04c90eea0779dd173baa01b96aed683fec326207", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/04c90eea0779dd173baa01b96aed683fec326207/comments", "author": null, "committer": null, "parents": [{"sha": "332e7efe7fa434a998aa5634dca6d4f93810f65f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/332e7efe7fa434a998aa5634dca6d4f93810f65f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/332e7efe7fa434a998aa5634dca6d4f93810f65f"}], "stats": {"total": 20, "additions": 19, "deletions": 1}, "files": [{"sha": "8e083a9ac85b6c4e8da451ff9fe12cac6497dc1a", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/04c90eea0779dd173baa01b96aed683fec326207/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/04c90eea0779dd173baa01b96aed683fec326207/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=04c90eea0779dd173baa01b96aed683fec326207", "patch": "@@ -1,3 +1,7 @@\n+2005-02-19  Devang Patel  <dpatel@apple.com>\n+\n+\t* gcc.dg/cpp/mac-eol-at-eof.c: New test.\n+\t\n 2005-02-19  Steven G. Kargl  <kargls@comcast.net>\n \n \t* gfortran.dg/achar_1.f90: New test."}, {"sha": "6b0a279dc7b1dcc41243dedd8800c53bea65abaf", "filename": "gcc/testsuite/gcc.dg/cpp/mac-eol-at-eof.c", "status": "added", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/04c90eea0779dd173baa01b96aed683fec326207/gcc%2Ftestsuite%2Fgcc.dg%2Fcpp%2Fmac-eol-at-eof.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/04c90eea0779dd173baa01b96aed683fec326207/gcc%2Ftestsuite%2Fgcc.dg%2Fcpp%2Fmac-eol-at-eof.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fcpp%2Fmac-eol-at-eof.c?ref=04c90eea0779dd173baa01b96aed683fec326207", "patch": "@@ -0,0 +1 @@\n+/* Test no newline at eof warning when Mac line ending is used*/\r/* { dg-do compile } */\rint main() { return 0; } \r\n\\ No newline at end of file"}, {"sha": "0764fc8e4b306843ad3e147a4a74ca09ba855167", "filename": "libcpp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/04c90eea0779dd173baa01b96aed683fec326207/libcpp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/04c90eea0779dd173baa01b96aed683fec326207/libcpp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libcpp%2FChangeLog?ref=04c90eea0779dd173baa01b96aed683fec326207", "patch": "@@ -1,3 +1,8 @@\n+2005-02-19  Devang Patel  <dpatel@apple.com>\n+\n+\t* charset.c (_cpp_convert_input): Check '\\r' before inserting\n+\t'\\n' at the end.\n+\t\n 2005-02-15  Eric Christopher  <echristo@redhat.com>\n \n \tPR preprocessor/19077"}, {"sha": "37859c52a319a632f8104518d0c8e0b927b2cdd1", "filename": "libcpp/charset.c", "status": "modified", "additions": 9, "deletions": 1, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/04c90eea0779dd173baa01b96aed683fec326207/libcpp%2Fcharset.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/04c90eea0779dd173baa01b96aed683fec326207/libcpp%2Fcharset.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libcpp%2Fcharset.c?ref=04c90eea0779dd173baa01b96aed683fec326207", "patch": "@@ -1405,7 +1405,15 @@ _cpp_convert_input (cpp_reader *pfile, const char *input_charset,\n   if (to.len + 4096 < to.asize || to.len >= to.asize)\n     to.text = xrealloc (to.text, to.len + 1);\n \n-  to.text[to.len] = '\\n';\n+  /* If the file is using old-school Mac line endings (\\r only),\n+     terminate with another \\r, not an \\n, so that we do not mistake\n+     the \\r\\n sequence for a single DOS line ending and erroneously\n+     issue the \"No newline at end of file\" diagnostic.  */\n+  if (to.text[to.len - 1] == '\\r')\n+    to.text[to.len] = '\\r';\n+  else\n+    to.text[to.len] = '\\n';\n+\n   *st_size = to.len;\n   return to.text;\n }"}]}