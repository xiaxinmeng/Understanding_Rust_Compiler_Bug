{"sha": "aee21c6fec52d3a696344c134efd9e3841730ac1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWVlMjFjNmZlYzUyZDNhNjk2MzQ0YzEzNGVmZDllMzg0MTczMGFjMQ==", "commit": {"author": {"name": "Emmanuel Briot", "email": "briot@adacore.com", "date": "2007-12-13T10:43:51Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2007-12-13T10:43:51Z"}, "message": "s-os_lib.ads, [...] (Normalize_Pathname): Do not compute Reference_Dir unless we actually need it.\n\n2007-12-06  Emmanuel Briot  <briot@adacore.com>\n\n\t* s-os_lib.ads, s-os_lib.adb (Normalize_Pathname): Do not compute\n\tReference_Dir unless we actually need it.\n\nFrom-SVN: r130875", "tree": {"sha": "c38fb30d974e308adfd91250aa0581785dc69182", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c38fb30d974e308adfd91250aa0581785dc69182"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/aee21c6fec52d3a696344c134efd9e3841730ac1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/aee21c6fec52d3a696344c134efd9e3841730ac1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/aee21c6fec52d3a696344c134efd9e3841730ac1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/aee21c6fec52d3a696344c134efd9e3841730ac1/comments", "author": {"login": "briot", "id": 42402, "node_id": "MDQ6VXNlcjQyNDAy", "avatar_url": "https://avatars.githubusercontent.com/u/42402?v=4", "gravatar_id": "", "url": "https://api.github.com/users/briot", "html_url": "https://github.com/briot", "followers_url": "https://api.github.com/users/briot/followers", "following_url": "https://api.github.com/users/briot/following{/other_user}", "gists_url": "https://api.github.com/users/briot/gists{/gist_id}", "starred_url": "https://api.github.com/users/briot/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/briot/subscriptions", "organizations_url": "https://api.github.com/users/briot/orgs", "repos_url": "https://api.github.com/users/briot/repos", "events_url": "https://api.github.com/users/briot/events{/privacy}", "received_events_url": "https://api.github.com/users/briot/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "566b591edc6db2d1772b68fd28c47e85eb293dd3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/566b591edc6db2d1772b68fd28c47e85eb293dd3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/566b591edc6db2d1772b68fd28c47e85eb293dd3"}], "stats": {"total": 26, "additions": 15, "deletions": 11}, "files": [{"sha": "7082ff0930c9c795645807217b6b8b6a8fb0f478", "filename": "gcc/ada/s-os_lib.adb", "status": "modified", "additions": 11, "deletions": 8, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aee21c6fec52d3a696344c134efd9e3841730ac1/gcc%2Fada%2Fs-os_lib.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aee21c6fec52d3a696344c134efd9e3841730ac1/gcc%2Fada%2Fs-os_lib.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fs-os_lib.adb?ref=aee21c6fec52d3a696344c134efd9e3841730ac1", "patch": "@@ -1822,9 +1822,6 @@ package body System.OS_Lib is\n          end if;\n       end Get_Directory;\n \n-      Reference_Dir : constant String := Get_Directory (Directory);\n-      --  Current directory name specified\n-\n    --  Start of processing for Normalize_Pathname\n \n    begin\n@@ -1927,12 +1924,18 @@ package body System.OS_Lib is\n          if Last = 1\n            and then not Is_Absolute_Path (Path_Buffer (1 .. End_Path))\n          then\n-            Path_Buffer\n-              (Reference_Dir'Length + 1 .. Reference_Dir'Length + End_Path) :=\n+            declare\n+               Reference_Dir : constant String  := Get_Directory (Directory);\n+               Ref_Dir_Len   : constant Natural := Reference_Dir'Length;\n+               --  Current directory name specified and its length\n+\n+            begin\n+               Path_Buffer (Ref_Dir_Len + 1 .. Ref_Dir_Len + End_Path) :=\n                  Path_Buffer (1 .. End_Path);\n-            End_Path := Reference_Dir'Length + End_Path;\n-            Path_Buffer (1 .. Reference_Dir'Length) := Reference_Dir;\n-            Last := Reference_Dir'Length;\n+               End_Path := Ref_Dir_Len + End_Path;\n+               Path_Buffer (1 .. Ref_Dir_Len) := Reference_Dir;\n+               Last := Ref_Dir_Len;\n+            end;\n          end if;\n \n          Start  := Last + 1;"}, {"sha": "e3c1079df19b12e0b0a6cc447f89ea2bd4dfcdf0", "filename": "gcc/ada/s-os_lib.ads", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aee21c6fec52d3a696344c134efd9e3841730ac1/gcc%2Fada%2Fs-os_lib.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aee21c6fec52d3a696344c134efd9e3841730ac1/gcc%2Fada%2Fs-os_lib.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fs-os_lib.ads?ref=aee21c6fec52d3a696344c134efd9e3841730ac1", "patch": "@@ -507,6 +507,7 @@ package System.OS_Lib is\n    --  directories listed in the environment Path. If the Exec_Name doesn't\n    --  have the executable suffix, it will be appended before the search.\n    --  Otherwise works like Locate_Regular_File below.\n+   --  If the executable is not found, null is returned.\n    --\n    --  Note that this function allocates some memory for the returned value.\n    --  This memory needs to be deallocated after use.\n@@ -654,9 +655,9 @@ package System.OS_Lib is\n    --  (notably Unix systems) a simple file name may also work (if the\n    --  executable can be located in the path).\n    --\n-   --  \"Spawn\" should not be used in tasking applications. Why not??? More\n-   --  documentation would be helpful here ??? Is it really tasking programs,\n-   --  or tasking activity that cause trouble ???\n+   --  \"Spawn\" should be avoided in tasking applications, since there are\n+   --  subtle interactions between creating a process and signals/locks\n+   --  that can cause troubles.\n    --\n    --  Note: Arguments in Args that contain spaces and/or quotes such as\n    --  \"--GCC=gcc -v\" or \"--GCC=\"\"gcc -v\"\"\" are not portable across all"}]}