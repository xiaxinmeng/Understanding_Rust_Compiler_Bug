{"sha": "f74bd71564c24fffa3902e2a133d2141537a67a3", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Zjc0YmQ3MTU2NGMyNGZmZmEzOTAyZTJhMTMzZDIxNDE1MzdhNjdhMw==", "commit": {"author": {"name": "Marcus Shawcroft", "email": "mshawcroft@gcc.gnu.org", "date": "2010-09-03T10:01:44Z"}, "committer": {"name": "Marcus Shawcroft", "email": "mshawcroft@gcc.gnu.org", "date": "2010-09-03T10:01:44Z"}, "message": "linux-atomic.c (__sync_val_compare_and_swap_4): Insert __builtin_expect().\n\n2010-09-03  Marcus Shawcroft  <marcus.shawcroft@arm.com>\n\n\t* config/arm/linux-atomic.c (__sync_val_compare_and_swap_4): Insert __builtin_expect().\n\t(SUBWORD_VAL_CAS): Likewise.\n\nFrom-SVN: r163805", "tree": {"sha": "562ff1a411eb52c7d85adff3dd407e05e3bf5b02", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/562ff1a411eb52c7d85adff3dd407e05e3bf5b02"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f74bd71564c24fffa3902e2a133d2141537a67a3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f74bd71564c24fffa3902e2a133d2141537a67a3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f74bd71564c24fffa3902e2a133d2141537a67a3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f74bd71564c24fffa3902e2a133d2141537a67a3/comments", "author": null, "committer": null, "parents": [{"sha": "a482b1f5f45fbd54fce4098d4e03958d1457a310", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a482b1f5f45fbd54fce4098d4e03958d1457a310", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a482b1f5f45fbd54fce4098d4e03958d1457a310"}], "stats": {"total": 9, "additions": 5, "deletions": 4}, "files": [{"sha": "ddedeb529852d8af0c02524292dcdee53af3291b", "filename": "gcc/config/arm/linux-atomic.c", "status": "modified", "additions": 5, "deletions": 4, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f74bd71564c24fffa3902e2a133d2141537a67a3/gcc%2Fconfig%2Farm%2Flinux-atomic.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f74bd71564c24fffa3902e2a133d2141537a67a3/gcc%2Fconfig%2Farm%2Flinux-atomic.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Flinux-atomic.c?ref=f74bd71564c24fffa3902e2a133d2141537a67a3", "patch": "@@ -155,12 +155,12 @@ __sync_val_compare_and_swap_4 (int *ptr, int oldval, int newval)\n     {\n       actual_oldval = *ptr;\n \n-      if (oldval != actual_oldval)\n+      if (__builtin_expect (oldval != actual_oldval, 0))\n \treturn actual_oldval;\n \n       fail = __kernel_cmpxchg (actual_oldval, newval, ptr);\n   \n-      if (!fail)\n+      if (__builtin_expect (!fail, 1))\n         return oldval;\n     }\n }\n@@ -180,7 +180,8 @@ __sync_val_compare_and_swap_4 (int *ptr, int oldval, int newval)\n       {\t\t\t\t\t\t\t\t\t\\\n \tactual_oldval = *wordptr;\t\t\t\t\t\\\n \t\t\t\t\t\t\t\t\t\\\n-\tif (((actual_oldval & mask) >> shift) != (unsigned int) oldval)\t\\\n+\tif (__builtin_expect (((actual_oldval & mask) >> shift) !=      \\\n+                              (unsigned int) oldval, 0))                \\\n           return (actual_oldval & mask) >> shift;\t\t\t\\\n \t\t\t\t\t\t\t\t\t\\\n \tactual_newval = (actual_oldval & ~mask)\t\t\t\t\\\n@@ -189,7 +190,7 @@ __sync_val_compare_and_swap_4 (int *ptr, int oldval, int newval)\n \tfail = __kernel_cmpxchg (actual_oldval, actual_newval,\t\t\\\n \t\t\t\t wordptr);\t\t\t\t\\\n \t\t\t\t\t\t\t\t\t\\\n-\tif (!fail)\t\t\t\t\t\t\t\\\n+      if (__builtin_expect (!fail, 1))                                  \\\n           return oldval;\t\t\t\t\t\t\\\n       }\t\t\t\t\t\t\t\t\t\\\n   }"}]}