{"sha": "40e2341e427a28fa7d97d6788e381468e8a4b198", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDBlMjM0MWU0MjdhMjhmYTdkOTdkNjc4OGUzODE0NjhlOGE0YjE5OA==", "commit": {"author": {"name": "Tom de Vries", "email": "tom@codesourcery.com", "date": "2015-12-13T12:43:21Z"}, "committer": {"name": "Tom de Vries", "email": "vries@gcc.gnu.org", "date": "2015-12-13T12:43:21Z"}, "message": "Handle sizes and kinds params of GOACC_paralllel in find_func_clobbers\n\n2015-12-13  Tom de Vries  <tom@codesourcery.com>\n\n\t* tree-ssa-structalias.c (find_func_clobbers): Handle sizes and kinds\n\tparameters of GOACC_paralllel.\n\nFrom-SVN: r231595", "tree": {"sha": "343cf385dfee475c1f14ff9efe4bc924428ff305", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/343cf385dfee475c1f14ff9efe4bc924428ff305"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/40e2341e427a28fa7d97d6788e381468e8a4b198", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/40e2341e427a28fa7d97d6788e381468e8a4b198", "html_url": "https://github.com/Rust-GCC/gccrs/commit/40e2341e427a28fa7d97d6788e381468e8a4b198", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/40e2341e427a28fa7d97d6788e381468e8a4b198/comments", "author": null, "committer": null, "parents": [{"sha": "7fa658c2ccdcb482c5060a5cff71b416ae876dbf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7fa658c2ccdcb482c5060a5cff71b416ae876dbf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7fa658c2ccdcb482c5060a5cff71b416ae876dbf"}], "stats": {"total": 21, "additions": 21, "deletions": 0}, "files": [{"sha": "eee44a7cdda871e7651a0099a6e6fb327c963fdd", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/40e2341e427a28fa7d97d6788e381468e8a4b198/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/40e2341e427a28fa7d97d6788e381468e8a4b198/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=40e2341e427a28fa7d97d6788e381468e8a4b198", "patch": "@@ -1,3 +1,8 @@\n+2015-12-13  Tom de Vries  <tom@codesourcery.com>\n+\n+\t* tree-ssa-structalias.c (find_func_clobbers): Handle sizes and kinds\n+\tparameters of GOACC_paralllel.\n+\n 2015-12-10  Jan Hubicka  <hubicka@ucw.cz>\n \n \t* cgraph.c (cgraph_node::get_untransformed_body): Pass compressed"}, {"sha": "b34c955146d0677d76c74481641efe43e7faa6df", "filename": "gcc/tree-ssa-structalias.c", "status": "modified", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/40e2341e427a28fa7d97d6788e381468e8a4b198/gcc%2Ftree-ssa-structalias.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/40e2341e427a28fa7d97d6788e381468e8a4b198/gcc%2Ftree-ssa-structalias.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-structalias.c?ref=40e2341e427a28fa7d97d6788e381468e8a4b198", "patch": "@@ -5089,6 +5089,8 @@ find_func_clobbers (struct function *fn, gimple *origt)\n \t  case BUILT_IN_GOACC_PARALLEL:\n \t    {\n \t      unsigned int fnpos, argpos;\n+\t      unsigned int implicit_use_args[2];\n+\t      unsigned int num_implicit_use_args = 0;\n \t      switch (DECL_FUNCTION_CODE (decl))\n \t\t{\n \t\tcase BUILT_IN_GOMP_PARALLEL:\n@@ -5101,6 +5103,8 @@ find_func_clobbers (struct function *fn, gimple *origt)\n \t\t\t\t\t       sizes, kinds, ...).  */\n \t\t  fnpos = 1;\n \t\t  argpos = 3;\n+\t\t  implicit_use_args[num_implicit_use_args++] = 4;\n+\t\t  implicit_use_args[num_implicit_use_args++] = 5;\n \t\t  break;\n \t\tdefault:\n \t\t  gcc_unreachable ();\n@@ -5121,6 +5125,18 @@ find_func_clobbers (struct function *fn, gimple *origt)\n \t\tprocess_constraint (new_constraint (lhs, *rhsp));\n \t      rhsc.truncate (0);\n \n+\t      /* Handle parameters used by the call, but not used in cfi, as\n+\t\t implicitly used by cfi.  */\n+\t      lhs = get_function_part_constraint (cfi, fi_uses);\n+\t      for (unsigned i = 0; i < num_implicit_use_args; ++i)\n+\t\t{\n+\t\t  tree arg = gimple_call_arg (t, implicit_use_args[i]);\n+\t\t  get_constraint_for (arg, &rhsc);\n+\t\t  FOR_EACH_VEC_ELT (rhsc, j, rhsp)\n+\t\t    process_constraint (new_constraint (lhs, *rhsp));\n+\t\t  rhsc.truncate (0);\n+\t\t}\n+\n \t      /* The caller clobbers what the callee does.  */\n \t      lhs = get_function_part_constraint (fi, fi_clobbers);\n \t      rhs = get_function_part_constraint (cfi, fi_clobbers);"}]}