{"sha": "3146ec83db7e65982776a979b8c75883202a4e90", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzE0NmVjODNkYjdlNjU5ODI3NzZhOTc5YjhjNzU4ODMyMDJhNGU5MA==", "commit": {"author": {"name": "Hongtao Liu", "email": "hongtao.liu@intel.com", "date": "2019-06-06T01:14:04Z"}, "committer": {"name": "Hongtao Liu", "email": "liuhongt@gcc.gnu.org", "date": "2019-06-06T01:14:04Z"}, "message": "sse.md (define_mode_suffix vecmemsuffix): New.\n\ngcc/\n2019-06-05  Hongtao Liu  <hongtao.liu@intel.com>\n\n\t* config/i386/sse.md (define_mode_suffix vecmemsuffix): New.\n\t(define_insn \"avx512dq_fpclass<mode><mask_scalar_merge_name>\"): Enable\n\tmemory operand for it.\n\t(define_insn \"avx512dq_vmfpclass<mode><mask_scalar_merge_name>\"): Ditto.\n\ngcc/testsuite\n2019-06-05  Hongtao Liu  <hongtao.liu@intel.com>\n\n\t* gcc.target/i386/avx512dq-vfpclasspd-1.c: Adjust scan assember\n\tfor {x,y,z} suffix.\n\t* gcc.target/i386/avx512dq-vfpclassps-1.c: Ditto.\n\nFrom-SVN: r271984", "tree": {"sha": "96abe7f08caea0d28203dfff52b95b7a6282b910", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/96abe7f08caea0d28203dfff52b95b7a6282b910"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3146ec83db7e65982776a979b8c75883202a4e90", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3146ec83db7e65982776a979b8c75883202a4e90", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3146ec83db7e65982776a979b8c75883202a4e90", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3146ec83db7e65982776a979b8c75883202a4e90/comments", "author": {"login": "algebra84", "id": 22926165, "node_id": "MDQ6VXNlcjIyOTI2MTY1", "avatar_url": "https://avatars.githubusercontent.com/u/22926165?v=4", "gravatar_id": "", "url": "https://api.github.com/users/algebra84", "html_url": "https://github.com/algebra84", "followers_url": "https://api.github.com/users/algebra84/followers", "following_url": "https://api.github.com/users/algebra84/following{/other_user}", "gists_url": "https://api.github.com/users/algebra84/gists{/gist_id}", "starred_url": "https://api.github.com/users/algebra84/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/algebra84/subscriptions", "organizations_url": "https://api.github.com/users/algebra84/orgs", "repos_url": "https://api.github.com/users/algebra84/repos", "events_url": "https://api.github.com/users/algebra84/events{/privacy}", "received_events_url": "https://api.github.com/users/algebra84/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "269f05ff58289cfdd3a35f0d9afc8e229a98f50e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/269f05ff58289cfdd3a35f0d9afc8e229a98f50e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/269f05ff58289cfdd3a35f0d9afc8e229a98f50e"}], "stats": {"total": 47, "additions": 32, "deletions": 15}, "files": [{"sha": "464982ef4dc200d376d98ec5d7801c7ad0f99aa9", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3146ec83db7e65982776a979b8c75883202a4e90/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3146ec83db7e65982776a979b8c75883202a4e90/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=3146ec83db7e65982776a979b8c75883202a4e90", "patch": "@@ -1,3 +1,10 @@\n+2019-06-05  Hongtao Liu  <hongtao.liu@intel.com>\n+\n+\t* config/i386/sse.md (define_mode_suffix vecmemsuffix): New.\n+\t(define_insn \"avx512dq_fpclass<mode><mask_scalar_merge_name>\"): Enable\n+\tmemory operand for it.\n+\t(define_insn \"avx512dq_vmfpclass<mode><mask_scalar_merge_name>\"): Ditto.\n+\n 2019-06-05  Martin Sebor  <msebor@redhat.com>\n \n \t* config/i386/i386-features.c (ix86_get_function_versions_dispatcher):"}, {"sha": "0997f436b43ac0babce40c9a2aa13b2f46d3fe8c", "filename": "gcc/config/i386/sse.md", "status": "modified", "additions": 7, "deletions": 3, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3146ec83db7e65982776a979b8c75883202a4e90/gcc%2Fconfig%2Fi386%2Fsse.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3146ec83db7e65982776a979b8c75883202a4e90/gcc%2Fconfig%2Fi386%2Fsse.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fsse.md?ref=3146ec83db7e65982776a979b8c75883202a4e90", "patch": "@@ -595,6 +595,10 @@\n (define_mode_attr ssequarterinsnmode\n   [(V16SF \"V4SF\") (V8DF \"V2DF\") (V16SI \"TI\") (V8DI \"TI\")])\n \n+(define_mode_attr vecmemsuffix\n+  [(V16SF \"{z}\") (V8SF \"{y}\") (V4SF \"{x}\")\n+   (V8DF \"{z}\") (V4DF \"{y}\") (V2DF \"{x}\")])\n+\n (define_mode_attr ssedoublemodelower\n   [(V16QI \"v16hi\") (V32QI \"v32hi\") (V64QI \"v64hi\")\n    (V8HI \"v8si\")   (V16HI \"v16si\") (V32HI \"v32si\")\n@@ -21317,11 +21321,11 @@\n (define_insn \"avx512dq_fpclass<mode><mask_scalar_merge_name>\"\n   [(set (match_operand:<avx512fmaskmode> 0 \"register_operand\" \"=k\")\n           (unspec:<avx512fmaskmode>\n-            [(match_operand:VF_AVX512VL 1 \"register_operand\" \"v\")\n+            [(match_operand:VF_AVX512VL 1 \"vector_operand\" \"vm\")\n              (match_operand:QI 2 \"const_0_to_255_operand\" \"n\")]\n              UNSPEC_FPCLASS))]\n    \"TARGET_AVX512DQ\"\n-   \"vfpclass<ssemodesuffix>\\t{%2, %1, %0<mask_scalar_merge_operand3>|%0<mask_scalar_merge_operand3>, %1, %2}\";\n+   \"vfpclass<ssemodesuffix><vecmemsuffix>\\t{%2, %1, %0<mask_scalar_merge_operand3>|%0<mask_scalar_merge_operand3>, %1, %2}\";\n   [(set_attr \"type\" \"sse\")\n    (set_attr \"length_immediate\" \"1\")\n    (set_attr \"prefix\" \"evex\")\n@@ -21331,7 +21335,7 @@\n   [(set (match_operand:<avx512fmaskmode> 0 \"register_operand\" \"=k\")\n \t(and:<avx512fmaskmode>\n \t  (unspec:<avx512fmaskmode>\n-\t    [(match_operand:VF_128 1 \"register_operand\" \"v\")\n+\t    [(match_operand:VF_128 1 \"vector_operand\" \"vm\")\n              (match_operand:QI 2 \"const_0_to_255_operand\" \"n\")]\n \t    UNSPEC_FPCLASS)\n \t  (const_int 1)))]"}, {"sha": "4f58a453387f90be797c08f40f8d9b50c82ba3d2", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3146ec83db7e65982776a979b8c75883202a4e90/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3146ec83db7e65982776a979b8c75883202a4e90/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=3146ec83db7e65982776a979b8c75883202a4e90", "patch": "@@ -1,3 +1,9 @@\n+2019-06-05  Hongtao Liu  <hongtao.liu@intel.com>\n+\n+\t* gcc.target/i386/avx512dq-vfpclasspd-1.c: Adjust scan assember\n+\tfor {x,y,z} suffix.\n+\t* gcc.target/i386/avx512dq-vfpclassps-1.c: Ditto.\n+\n 2019-06-05  Martin Sebor  <msebor@redhat.com>\n \n \t* gcc.dg/format/gcc_diag-11.c: Skip until -Wformat-diag has"}, {"sha": "932f103b3efbe8407ebd7feaf245768c045c4b4e", "filename": "gcc/testsuite/gcc.target/i386/avx512dq-vfpclasspd-1.c", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3146ec83db7e65982776a979b8c75883202a4e90/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Favx512dq-vfpclasspd-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3146ec83db7e65982776a979b8c75883202a4e90/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Favx512dq-vfpclasspd-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Favx512dq-vfpclasspd-1.c?ref=3146ec83db7e65982776a979b8c75883202a4e90", "patch": "@@ -1,11 +1,11 @@\n /* { dg-do compile } */\n /* { dg-options \"-mavx512dq -mavx512vl -O2\" } */\n-/* { dg-final { scan-assembler-times \"vfpclasspd\\[ \\\\t\\]+\\[^\\{\\n\\]*%zmm\\[0-9\\]+\\[^\\n^k\\]*%k\\[0-7\\](?:\\n|\\[ \\\\t\\]+#)\" 1 } } */\n-/* { dg-final { scan-assembler-times \"vfpclasspd\\[ \\\\t\\]+\\[^\\{\\n\\]*%ymm\\[0-9\\]+\\[^\\n^k\\]*%k\\[0-7\\](?:\\n|\\[ \\\\t\\]+#)\" 1 } } */\n-/* { dg-final { scan-assembler-times \"vfpclasspd\\[ \\\\t\\]+\\[^\\{\\n\\]*%xmm\\[0-9\\]+\\[^\\n^k\\]*%k\\[0-7\\](?:\\n|\\[ \\\\t\\]+#)\" 1 } } */\n-/* { dg-final { scan-assembler-times \"vfpclasspd\\[ \\\\t\\]+\\[^\\{\\n\\]*%zmm\\[0-9\\]+\\[^\\n^k\\]*%k\\[0-7\\]\\{%k\\[1-7\\]\\}(?:\\n|\\[ \\\\t\\]+#)\" 1 } } */\n-/* { dg-final { scan-assembler-times \"vfpclasspd\\[ \\\\t\\]+\\[^\\{\\n\\]*%ymm\\[0-9\\]+\\[^\\n^k\\]*%k\\[0-7\\]\\{%k\\[1-7\\]\\}(?:\\n|\\[ \\\\t\\]+#)\" 1 } } */\n-/* { dg-final { scan-assembler-times \"vfpclasspd\\[ \\\\t\\]+\\[^\\{\\n\\]*%xmm\\[0-9\\]+\\[^\\n^k\\]*%k\\[0-7\\]\\{%k\\[1-7\\]\\}(?:\\n|\\[ \\\\t\\]+#)\" 1 } } */\n+/* { dg-final { scan-assembler-times \"vfpclasspdz\\[ \\\\t\\]+\\[^\\{\\n\\]*%zmm\\[0-9\\]+\\[^\\n^k\\]*%k\\[0-7\\](?:\\n|\\[ \\\\t\\]+#)\" 1 } } */\n+/* { dg-final { scan-assembler-times \"vfpclasspdy\\[ \\\\t\\]+\\[^\\{\\n\\]*%ymm\\[0-9\\]+\\[^\\n^k\\]*%k\\[0-7\\](?:\\n|\\[ \\\\t\\]+#)\" 1 } } */\n+/* { dg-final { scan-assembler-times \"vfpclasspdx\\[ \\\\t\\]+\\[^\\{\\n\\]*%xmm\\[0-9\\]+\\[^\\n^k\\]*%k\\[0-7\\](?:\\n|\\[ \\\\t\\]+#)\" 1 } } */\n+/* { dg-final { scan-assembler-times \"vfpclasspdz\\[ \\\\t\\]+\\[^\\{\\n\\]*%zmm\\[0-9\\]+\\[^\\n^k\\]*%k\\[0-7\\]\\{%k\\[1-7\\]\\}(?:\\n|\\[ \\\\t\\]+#)\" 1 } } */\n+/* { dg-final { scan-assembler-times \"vfpclasspdy\\[ \\\\t\\]+\\[^\\{\\n\\]*%ymm\\[0-9\\]+\\[^\\n^k\\]*%k\\[0-7\\]\\{%k\\[1-7\\]\\}(?:\\n|\\[ \\\\t\\]+#)\" 1 } } */\n+/* { dg-final { scan-assembler-times \"vfpclasspdx\\[ \\\\t\\]+\\[^\\{\\n\\]*%xmm\\[0-9\\]+\\[^\\n^k\\]*%k\\[0-7\\]\\{%k\\[1-7\\]\\}(?:\\n|\\[ \\\\t\\]+#)\" 1 } } */\n \n #include <immintrin.h>\n "}, {"sha": "f826e89155cae873550626863cd6cd0fcff9b3e5", "filename": "gcc/testsuite/gcc.target/i386/avx512dq-vfpclassps-1.c", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3146ec83db7e65982776a979b8c75883202a4e90/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Favx512dq-vfpclassps-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3146ec83db7e65982776a979b8c75883202a4e90/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Favx512dq-vfpclassps-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Favx512dq-vfpclassps-1.c?ref=3146ec83db7e65982776a979b8c75883202a4e90", "patch": "@@ -1,11 +1,11 @@\n /* { dg-do compile } */\n /* { dg-options \"-mavx512dq -mavx512vl -O2\" } */\n-/* { dg-final { scan-assembler-times \"vfpclassps\\[ \\\\t\\]+\\[^\\{\\n\\]*%zmm\\[0-9\\]+\\[^\\n^k\\]*%k\\[0-7\\](?:\\n|\\[ \\\\t\\]+#)\" 1 } } */\n-/* { dg-final { scan-assembler-times \"vfpclassps\\[ \\\\t\\]+\\[^\\{\\n\\]*%ymm\\[0-9\\]+\\[^\\n^k\\]*%k\\[0-7\\](?:\\n|\\[ \\\\t\\]+#)\" 1 } } */\n-/* { dg-final { scan-assembler-times \"vfpclassps\\[ \\\\t\\]+\\[^\\{\\n\\]*%xmm\\[0-9\\]+\\[^\\n^k\\]*%k\\[0-7\\](?:\\n|\\[ \\\\t\\]+#)\" 1 } } */\n-/* { dg-final { scan-assembler-times \"vfpclassps\\[ \\\\t\\]+\\[^\\{\\n\\]*%zmm\\[0-9\\]+\\[^\\n^k\\]*%k\\[0-7\\]\\{%k\\[1-7\\]\\}(?:\\n|\\[ \\\\t\\]+#)\" 1 } } */\n-/* { dg-final { scan-assembler-times \"vfpclassps\\[ \\\\t\\]+\\[^\\{\\n\\]*%ymm\\[0-9\\]+\\[^\\n^k\\]*%k\\[0-7\\]\\{%k\\[1-7\\]\\}(?:\\n|\\[ \\\\t\\]+#)\" 1 } } */\n-/* { dg-final { scan-assembler-times \"vfpclassps\\[ \\\\t\\]+\\[^\\{\\n\\]*%xmm\\[0-9\\]+\\[^\\n^k\\]*%k\\[0-7\\]\\{%k\\[1-7\\]\\}(?:\\n|\\[ \\\\t\\]+#)\" 1 } } */\n+/* { dg-final { scan-assembler-times \"vfpclasspsz\\[ \\\\t\\]+\\[^\\{\\n\\]*%zmm\\[0-9\\]+\\[^\\n^k\\]*%k\\[0-7\\](?:\\n|\\[ \\\\t\\]+#)\" 1 } } */\n+/* { dg-final { scan-assembler-times \"vfpclasspsy\\[ \\\\t\\]+\\[^\\{\\n\\]*%ymm\\[0-9\\]+\\[^\\n^k\\]*%k\\[0-7\\](?:\\n|\\[ \\\\t\\]+#)\" 1 } } */\n+/* { dg-final { scan-assembler-times \"vfpclasspsx\\[ \\\\t\\]+\\[^\\{\\n\\]*%xmm\\[0-9\\]+\\[^\\n^k\\]*%k\\[0-7\\](?:\\n|\\[ \\\\t\\]+#)\" 1 } } */\n+/* { dg-final { scan-assembler-times \"vfpclasspsz\\[ \\\\t\\]+\\[^\\{\\n\\]*%zmm\\[0-9\\]+\\[^\\n^k\\]*%k\\[0-7\\]\\{%k\\[1-7\\]\\}(?:\\n|\\[ \\\\t\\]+#)\" 1 } } */\n+/* { dg-final { scan-assembler-times \"vfpclasspsy\\[ \\\\t\\]+\\[^\\{\\n\\]*%ymm\\[0-9\\]+\\[^\\n^k\\]*%k\\[0-7\\]\\{%k\\[1-7\\]\\}(?:\\n|\\[ \\\\t\\]+#)\" 1 } } */\n+/* { dg-final { scan-assembler-times \"vfpclasspsx\\[ \\\\t\\]+\\[^\\{\\n\\]*%xmm\\[0-9\\]+\\[^\\n^k\\]*%k\\[0-7\\]\\{%k\\[1-7\\]\\}(?:\\n|\\[ \\\\t\\]+#)\" 1 } } */\n \n #include <immintrin.h>\n "}]}