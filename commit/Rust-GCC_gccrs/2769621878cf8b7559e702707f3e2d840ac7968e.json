{"sha": "2769621878cf8b7559e702707f3e2d840ac7968e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Mjc2OTYyMTg3OGNmOGI3NTU5ZTcwMjcwN2YzZTJkODQwYWM3OTY4ZQ==", "commit": {"author": {"name": "Thomas Koenig", "email": "tkoenig@gcc.gnu.org", "date": "2008-07-07T19:45:55Z"}, "committer": {"name": "Thomas Koenig", "email": "tkoenig@gcc.gnu.org", "date": "2008-07-07T19:45:55Z"}, "message": "re PR fortran/36670 (Missing compile-time checks on sum and product)\n\n2008-07-07  Thomas Koenig  <tkoenig@gcc.gnu.org>\n\n\tPR fortran/36670\n\t* iresolve.c (gfc_resolve_product):  Set shape of return\n\tvalue from array.\n\t(gfc_resolve_sum):  Likewise.\n\n2008-07-07  Thomas Koenig  <tkoenig@gcc.gnu.org>\n\n\tPR fortran/36670\n\t* gfortran.dg/product_sum_bounds_1.f90:  New test case.\n\nFrom-SVN: r137595", "tree": {"sha": "9f92fb2fe16307444d21c0a7e5e85af8d0429702", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9f92fb2fe16307444d21c0a7e5e85af8d0429702"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2769621878cf8b7559e702707f3e2d840ac7968e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2769621878cf8b7559e702707f3e2d840ac7968e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2769621878cf8b7559e702707f3e2d840ac7968e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2769621878cf8b7559e702707f3e2d840ac7968e/comments", "author": null, "committer": null, "parents": [{"sha": "9ad13e91692eec408fb030c65f947a4065afc7df", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9ad13e91692eec408fb030c65f947a4065afc7df", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9ad13e91692eec408fb030c65f947a4065afc7df"}], "stats": {"total": 22, "additions": 22, "deletions": 0}, "files": [{"sha": "44f61fa245871ccebc02901c0787183ba43c883d", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2769621878cf8b7559e702707f3e2d840ac7968e/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2769621878cf8b7559e702707f3e2d840ac7968e/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=2769621878cf8b7559e702707f3e2d840ac7968e", "patch": "@@ -1,3 +1,10 @@\n+2008-07-07  Thomas Koenig  <tkoenig@gcc.gnu.org>\n+\n+\tPR fortran/36670\n+\t* iresolve.c (gfc_resolve_product):  Set shape of return\n+\tvalue from array.\n+\t(gfc_resolve_sum):  Likewise.\n+\n 2008-07-07  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR middle-end/36726"}, {"sha": "2c804143ba9aa5ee2c794ce2af923fc5664176d7", "filename": "gcc/fortran/iresolve.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2769621878cf8b7559e702707f3e2d840ac7968e/gcc%2Ffortran%2Firesolve.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2769621878cf8b7559e702707f3e2d840ac7968e/gcc%2Ffortran%2Firesolve.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Firesolve.c?ref=2769621878cf8b7559e702707f3e2d840ac7968e", "patch": "@@ -1788,6 +1788,7 @@ gfc_resolve_product (gfc_expr *f, gfc_expr *array, gfc_expr *dim,\n   if (dim != NULL)\n     {\n       f->rank = array->rank - 1;\n+      f->shape = gfc_copy_shape_excluding (array->shape, array->rank, dim);\n       gfc_resolve_dim_arg (dim);\n     }\n \n@@ -2271,6 +2272,7 @@ gfc_resolve_sum (gfc_expr *f, gfc_expr *array, gfc_expr *dim, gfc_expr *mask)\n   if (dim != NULL)\n     {\n       f->rank = array->rank - 1;\n+      f->shape = gfc_copy_shape_excluding (array->shape, array->rank, dim);\n       gfc_resolve_dim_arg (dim);\n     }\n "}, {"sha": "97f1e9bf60c8d2fd9e9530dc2124f6900bf2c269", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2769621878cf8b7559e702707f3e2d840ac7968e/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2769621878cf8b7559e702707f3e2d840ac7968e/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=2769621878cf8b7559e702707f3e2d840ac7968e", "patch": "@@ -1,3 +1,8 @@\n+2008-07-07  Thomas Koenig  <tkoenig@gcc.gnu.org>\n+\n+\tPR fortran/36670\n+\t* gfortran.dg/product_sum_bounds_1.f90:  New test case.\n+\n 2008-07-07  Thomas Koenig  <tkoenig@gcc.gnu.org>\n \n \tPR fortran/36341"}, {"sha": "c6390896c17532083ef0453ce9787d451949a5c0", "filename": "gcc/testsuite/gfortran.dg/product_sum_bounds_1.f90", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2769621878cf8b7559e702707f3e2d840ac7968e/gcc%2Ftestsuite%2Fgfortran.dg%2Fproduct_sum_bounds_1.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2769621878cf8b7559e702707f3e2d840ac7968e/gcc%2Ftestsuite%2Fgfortran.dg%2Fproduct_sum_bounds_1.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fproduct_sum_bounds_1.f90?ref=2769621878cf8b7559e702707f3e2d840ac7968e", "patch": "@@ -0,0 +1,8 @@\n+! { dg-do compile }\n+program main\n+  real, dimension(4,3) :: a\n+  real, dimension(2) :: b\n+  a = 21.\n+  b = product(a,dim=1) ! { dg-error \"Different shape\" }\n+  b = sum(a,dim=2) ! { dg-error \"Different shape\" }\n+end program main"}]}