{"sha": "fb05f2e4ddc9ae051cf205eb7eaa0e0e63cecf6c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZmIwNWYyZTRkZGM5YWUwNTFjZjIwNWViN2VhYTBlMGU2M2NlY2Y2Yw==", "commit": {"author": {"name": "Robert Suchanek", "email": "robert.suchanek@imgtec.com", "date": "2015-05-18T14:32:19Z"}, "committer": {"name": "Robert Suchanek", "email": "rts@gcc.gnu.org", "date": "2015-05-18T14:32:19Z"}, "message": "Fix ICE when both micromips and nomicromips attributes are used.\n\ngcc/ChangeLog:\n\n2015-05-18  Robert Suchanek  <robert.suchanek@imgtec.com>\n\n\t* config/mips/mips.c (micromips_globals): New variable.\n\t(mips_set_compression_mode): Save and reinitialize target-dependent\n\tstate for microMIPS.\n\ngcc/testsuite/ChangeLog:\n\n2015-05-18  Robert Suchanek  <robert.suchanek@imgtec.com>\n\n\t* gcc.target/mips/umips-attr.c: New test.\n\nFrom-SVN: r223294", "tree": {"sha": "5ad0f52e91ee9d4b7f00693f325152c97ccdc41c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5ad0f52e91ee9d4b7f00693f325152c97ccdc41c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/fb05f2e4ddc9ae051cf205eb7eaa0e0e63cecf6c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fb05f2e4ddc9ae051cf205eb7eaa0e0e63cecf6c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fb05f2e4ddc9ae051cf205eb7eaa0e0e63cecf6c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fb05f2e4ddc9ae051cf205eb7eaa0e0e63cecf6c/comments", "author": null, "committer": null, "parents": [{"sha": "7aeb92b4724c0dc16c5322241f8309ddfa3da89f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7aeb92b4724c0dc16c5322241f8309ddfa3da89f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7aeb92b4724c0dc16c5322241f8309ddfa3da89f"}], "stats": {"total": 33, "additions": 33, "deletions": 0}, "files": [{"sha": "27b4d266d2060783223dc6797822ad26328f6431", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fb05f2e4ddc9ae051cf205eb7eaa0e0e63cecf6c/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fb05f2e4ddc9ae051cf205eb7eaa0e0e63cecf6c/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=fb05f2e4ddc9ae051cf205eb7eaa0e0e63cecf6c", "patch": "@@ -1,3 +1,9 @@\n+2015-05-18  Robert Suchanek  <robert.suchanek@imgtec.com>\n+\n+\t* config/mips/mips.c (micromips_globals): New variable.\n+\t(mips_set_compression_mode): Save and reinitialize target-dependent\n+\tstate for microMIPS.\n+\n 2015-05-18  Martin Liska  <mliska@suse.cz>\n \n \t* dbgcnt.def: Add new counter."}, {"sha": "e619baadae880348210b8404ea2ab63d91cac159", "filename": "gcc/config/mips/mips.c", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fb05f2e4ddc9ae051cf205eb7eaa0e0e63cecf6c/gcc%2Fconfig%2Fmips%2Fmips.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fb05f2e4ddc9ae051cf205eb7eaa0e0e63cecf6c/gcc%2Fconfig%2Fmips%2Fmips.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.c?ref=fb05f2e4ddc9ae051cf205eb7eaa0e0e63cecf6c", "patch": "@@ -676,6 +676,9 @@ const char *mips_hi_relocs[NUM_SYMBOL_TYPES];\n /* Target state for MIPS16.  */\n struct target_globals *mips16_globals;\n \n+/* Target state for MICROMIPS.  */\n+struct target_globals *micromips_globals;\n+\n /* Cached value of can_issue_more. This is cached in mips_variable_issue hook\n    and returned from mips_sched_reorder2.  */\n static int cached_can_issue_more;\n@@ -17162,6 +17165,13 @@ mips_set_compression_mode (unsigned int compression_mode)\n       else\n \trestore_target_globals (mips16_globals);\n     }\n+  else if (compression_mode & MASK_MICROMIPS)\n+    {\n+      if (!micromips_globals)\n+\tmicromips_globals = save_target_globals_default_opts ();\n+      else\n+\trestore_target_globals (micromips_globals);\n+    }\n   else\n     restore_target_globals (&default_target_globals);\n "}, {"sha": "5206d883a153a3376b3fc6f5e26b41d33544deb8", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fb05f2e4ddc9ae051cf205eb7eaa0e0e63cecf6c/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fb05f2e4ddc9ae051cf205eb7eaa0e0e63cecf6c/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=fb05f2e4ddc9ae051cf205eb7eaa0e0e63cecf6c", "patch": "@@ -1,3 +1,7 @@\n+2015-05-18  Robert Suchanek  <robert.suchanek@imgtec.com>\n+\n+\t* gcc.target/mips/umips-attr.c: New test.\n+\n 2015-05-17  Uros Bizjak  <ubizjak@gmail.com>\n \n \t* gcc.dg/20150120-1.c (dg-final): Cleanup original tree dump."}, {"sha": "f8c4517c5604279d52dd388699bf347e31495f9a", "filename": "gcc/testsuite/gcc.target/mips/umips-attr.c", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fb05f2e4ddc9ae051cf205eb7eaa0e0e63cecf6c/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fumips-attr.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fb05f2e4ddc9ae051cf205eb7eaa0e0e63cecf6c/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fumips-attr.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fumips-attr.c?ref=fb05f2e4ddc9ae051cf205eb7eaa0e0e63cecf6c", "patch": "@@ -0,0 +1,13 @@\n+/* { dg-options \"(-mmicromips)\" } */\n+\n+int MICROMIPS\n+foo (int a)\n+{\n+  return a;\n+}\n+\n+int NOMICROMIPS\n+foo2 (int a)\n+{\n+  return a;\n+}"}]}