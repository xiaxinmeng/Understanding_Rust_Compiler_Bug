{"sha": "f4d9f129fe9884da7b5f92f919a22157f729c577", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjRkOWYxMjlmZTk4ODRkYTdiNWY5MmY5MTlhMjIxNTdmNzI5YzU3Nw==", "commit": {"author": {"name": "Steve Ellcey", "email": "sje@cup.hp.com", "date": "2009-03-30T16:43:40Z"}, "committer": {"name": "Steve Ellcey", "email": "sje@gcc.gnu.org", "date": "2009-03-30T16:43:40Z"}, "message": "re PR middle-end/38237 (multiple weak directives)\n\n\tPR middle-end/38237\n\t* tree.h (tree_find_value): New declaration.\n\t* tree.c (tree_find_value): New function.\n\t* varasm.c (assemble_external): Avoid duplicate entries on lists.\n\nFrom-SVN: r145303", "tree": {"sha": "7886158a4e7de339c1bddbf1475cbceec18b4327", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7886158a4e7de339c1bddbf1475cbceec18b4327"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f4d9f129fe9884da7b5f92f919a22157f729c577", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f4d9f129fe9884da7b5f92f919a22157f729c577", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f4d9f129fe9884da7b5f92f919a22157f729c577", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f4d9f129fe9884da7b5f92f919a22157f729c577/comments", "author": null, "committer": null, "parents": [{"sha": "be21df036cb6a1d91d0016e6f66889b5ff5e9a5d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/be21df036cb6a1d91d0016e6f66889b5ff5e9a5d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/be21df036cb6a1d91d0016e6f66889b5ff5e9a5d"}], "stats": {"total": 33, "additions": 29, "deletions": 4}, "files": [{"sha": "d1de48d589d8eb1b6e5ee9a9f4f061a926b3564d", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f4d9f129fe9884da7b5f92f919a22157f729c577/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f4d9f129fe9884da7b5f92f919a22157f729c577/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=f4d9f129fe9884da7b5f92f919a22157f729c577", "patch": "@@ -1,3 +1,10 @@\n+2009-03-30  Steve Ellcey  <sje@cup.hp.com>\n+\n+\tPR middle-end/38237\n+\t* tree.h (tree_find_value): New declaration.\n+\t* tree.c (tree_find_value): New function.\n+\t* varasm.c (assemble_external): Avoid duplicate entries on lists.\n+\n 2009-03-30  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR debug/39563"}, {"sha": "bbc52e7fceb35532c2eaf8a36f39311fe1a8e470", "filename": "gcc/tree.c", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f4d9f129fe9884da7b5f92f919a22157f729c577/gcc%2Ftree.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f4d9f129fe9884da7b5f92f919a22157f729c577/gcc%2Ftree.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree.c?ref=f4d9f129fe9884da7b5f92f919a22157f729c577", "patch": "@@ -1802,6 +1802,18 @@ tree_last (tree chain)\n   return chain;\n }\n \n+/* Return the node in a chain of nodes whose value is x, NULL if not found.  */\n+\n+tree\n+tree_find_value (tree chain, tree x)\n+{\n+  tree list;\n+  for (list = chain; list; list = TREE_CHAIN (list))\n+    if (TREE_VALUE (list) == x)\n+\treturn list;\n+  return NULL;\n+}\n+\n /* Reverse the order of elements in the chain T,\n    and return the new head of the chain (old last element).  */\n "}, {"sha": "830852de8b561b0f408ddd490d782dfaa3e2b427", "filename": "gcc/tree.h", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f4d9f129fe9884da7b5f92f919a22157f729c577/gcc%2Ftree.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f4d9f129fe9884da7b5f92f919a22157f729c577/gcc%2Ftree.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree.h?ref=f4d9f129fe9884da7b5f92f919a22157f729c577", "patch": "@@ -4384,6 +4384,10 @@ extern tree tree_cons_stat (tree, tree, tree MEM_STAT_DECL);\n \n extern tree tree_last (tree);\n \n+/* Return the node in a chain whose TREE_VALUE is x, NULL if not found.  */\n+\n+extern tree tree_find_value (tree, tree);\n+\n /* Reverse the order of elements in a chain, and return the new head.  */\n \n extern tree nreverse (tree);"}, {"sha": "9eefb02d8d9b013143bc4144daf630a49d33ed27", "filename": "gcc/varasm.c", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f4d9f129fe9884da7b5f92f919a22157f729c577/gcc%2Fvarasm.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f4d9f129fe9884da7b5f92f919a22157f729c577/gcc%2Fvarasm.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fvarasm.c?ref=f4d9f129fe9884da7b5f92f919a22157f729c577", "patch": "@@ -2315,12 +2315,14 @@ assemble_external (tree decl ATTRIBUTE_UNUSED)\n \t locally emitted, inlined or otherwise not-really-extern, but\n \t for declarations that can be weak, it happens to be\n \t match.  */\n-      && !TREE_STATIC (decl))\n-    weak_decls = tree_cons (NULL, decl, weak_decls);\n+      && !TREE_STATIC (decl)\n+      && tree_find_value (weak_decls, decl) == NULL_TREE)\n+      weak_decls = tree_cons (NULL, decl, weak_decls);\n \n #ifdef ASM_OUTPUT_EXTERNAL\n-  pending_assemble_externals = tree_cons (0, decl,\n-\t\t\t\t\t  pending_assemble_externals);\n+  if (tree_find_value (pending_assemble_externals, decl) == NULL_TREE)\n+    pending_assemble_externals = tree_cons (NULL, decl,\n+\t\t\t\t\t    pending_assemble_externals);\n #endif\n }\n "}]}