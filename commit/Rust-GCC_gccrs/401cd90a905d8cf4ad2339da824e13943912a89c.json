{"sha": "401cd90a905d8cf4ad2339da824e13943912a89c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDAxY2Q5MGE5MDVkOGNmNGFkMjMzOWRhODI0ZTEzOTQzOTEyYTg5Yw==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2005-11-28T07:16:33Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2005-11-28T07:16:33Z"}, "message": "ftell.c (ftell, FTELL_SUB): Add unlock_unit call.\n\n\t* intrinsics/ftell.c (ftell, FTELL_SUB): Add unlock_unit call.\n\t* intrinsics/fget.c (fgetc, fputs): Likewise.\n\t* intrinsics/tty.c (ttynam): Likewise.\n\nFrom-SVN: r107595", "tree": {"sha": "bff7ffdea06ed9c1aad7564d6cf64222f1e7e9ff", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/bff7ffdea06ed9c1aad7564d6cf64222f1e7e9ff"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/401cd90a905d8cf4ad2339da824e13943912a89c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/401cd90a905d8cf4ad2339da824e13943912a89c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/401cd90a905d8cf4ad2339da824e13943912a89c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/401cd90a905d8cf4ad2339da824e13943912a89c/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "07a3df01000ca438d63254fc86a0d8aaf8db6f7d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/07a3df01000ca438d63254fc86a0d8aaf8db6f7d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/07a3df01000ca438d63254fc86a0d8aaf8db6f7d"}], "stats": {"total": 25, "additions": 21, "deletions": 4}, "files": [{"sha": "b874dc57819e08e865531745d1f35ca752c73881", "filename": "libgfortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/401cd90a905d8cf4ad2339da824e13943912a89c/libgfortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/401cd90a905d8cf4ad2339da824e13943912a89c/libgfortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2FChangeLog?ref=401cd90a905d8cf4ad2339da824e13943912a89c", "patch": "@@ -1,3 +1,9 @@\n+2005-11-28  Jakub Jelinek  <jakub@redhat.com>\n+\n+\t* intrinsics/ftell.c (ftell, FTELL_SUB): Add unlock_unit call.\n+\t* intrinsics/fget.c (fgetc, fputs): Likewise.\n+\t* intrinsics/tty.c (ttynam): Likewise.\n+\n 2005-11-27  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n \n \tPR libgfortran/25109"}, {"sha": "5c87ae6c3c11e0db40309b331a8385690bb12851", "filename": "libgfortran/intrinsics/fget.c", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/401cd90a905d8cf4ad2339da824e13943912a89c/libgfortran%2Fintrinsics%2Ffget.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/401cd90a905d8cf4ad2339da824e13943912a89c/libgfortran%2Fintrinsics%2Ffget.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fintrinsics%2Ffget.c?ref=401cd90a905d8cf4ad2339da824e13943912a89c", "patch": "@@ -54,6 +54,7 @@ PREFIX(fgetc) (const int * unit, char * c, gfc_charlen_type c_len)\n   s = 1;\n   memset (c, ' ', c_len);\n   ret = sread (u->s, c, &s);\n+  unlock_unit (u);\n \n   if (ret != 0)\n     return ret;\n@@ -118,13 +119,16 @@ PREFIX(fputc) (const int * unit, char * c,\n \t       gfc_charlen_type c_len __attribute__((unused)))\n {\n   size_t s;\n+  int ret;\n   gfc_unit * u = find_unit (*unit);\n \n   if (u == NULL)\n     return -1;\n \n   s = 1;\n-  return swrite (u->s, c, &s);\n+  ret = swrite (u->s, c, &s);\n+  unlock_unit (u);\n+  return ret;\n }\n \n "}, {"sha": "311f070cd16037b8c0fcd7f8f71b97d3877f3316", "filename": "libgfortran/intrinsics/ftell.c", "status": "modified", "additions": 8, "deletions": 3, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/401cd90a905d8cf4ad2339da824e13943912a89c/libgfortran%2Fintrinsics%2Fftell.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/401cd90a905d8cf4ad2339da824e13943912a89c/libgfortran%2Fintrinsics%2Fftell.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fintrinsics%2Fftell.c?ref=401cd90a905d8cf4ad2339da824e13943912a89c", "patch": "@@ -42,10 +42,12 @@ size_t\n PREFIX(ftell) (int * unit)\n {\n   gfc_unit * u = find_unit (*unit);\n+  size_t ret;\n   if (u == NULL)\n     return ((size_t) -1);\n-  else\n-    return ((size_t) stream_offset (u->s));\n+  ret = (size_t) stream_offset (u->s);\n+  unlock_unit (u);\n+  return ret;\n }\n \n #define FTELL_SUB(kind) \\\n@@ -58,7 +60,10 @@ PREFIX(ftell) (int * unit)\n     if (u == NULL) \\\n       *offset = -1; \\\n     else \\\n-      *offset = stream_offset (u->s); \\\n+      { \\\n+\t*offset = stream_offset (u->s); \\\n+\tunlock_unit (u); \\\n+      } \\\n   }\n \n FTELL_SUB(1)"}, {"sha": "93416f9983c2a9a49aec55e6cd0f28f892297420", "filename": "libgfortran/intrinsics/tty.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/401cd90a905d8cf4ad2339da824e13943912a89c/libgfortran%2Fintrinsics%2Ftty.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/401cd90a905d8cf4ad2339da824e13943912a89c/libgfortran%2Fintrinsics%2Ftty.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fintrinsics%2Ftty.c?ref=401cd90a905d8cf4ad2339da824e13943912a89c", "patch": "@@ -121,8 +121,10 @@ ttynam (char ** name, gfc_charlen_type * name_len, int unit)\n \t{\n \t  *name_len = strlen (*name);\n \t  *name = strdup (*name);\n+\t  unlock_unit (u);\n \t  return;\n \t}\n+      unlock_unit (u);\n     }\n \n   *name_len = 0;"}]}