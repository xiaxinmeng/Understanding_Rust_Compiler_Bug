{"sha": "c134da6b7748136088781e3f19c0f2ced109a4b0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzEzNGRhNmI3NzQ4MTM2MDg4NzgxZTNmMTljMGYyY2VkMTA5YTRiMA==", "commit": {"author": {"name": "Hans-Peter Nilsson", "email": "hp@axis.com", "date": "2002-06-16T18:54:43Z"}, "committer": {"name": "Hans-Peter Nilsson", "email": "hp@gcc.gnu.org", "date": "2002-06-16T18:54:43Z"}, "message": "re PR target/7042 (cris-elf miscompiles line_hints in ghostscript - \"return\" delay slot bug)\n\n\tPR target/7042\n\t* reorg.c (make_return_insns) [DELAY_SLOTS_FOR_EPILOGUE]: Exit\n\tearly if current_function_epilogue_delay_list is non-empty.\n\t* config/cris/cris.md (\"return\"): Add sanity check asserting that\n\tcurrent_function_epilogue_delay_list is empty.\n\nFrom-SVN: r54668", "tree": {"sha": "da9fbd6b307a08f8f2e1193f8f41e1127e4d7848", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/da9fbd6b307a08f8f2e1193f8f41e1127e4d7848"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c134da6b7748136088781e3f19c0f2ced109a4b0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c134da6b7748136088781e3f19c0f2ced109a4b0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c134da6b7748136088781e3f19c0f2ced109a4b0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c134da6b7748136088781e3f19c0f2ced109a4b0/comments", "author": {"login": "hpataxisdotcom", "id": 80339731, "node_id": "MDQ6VXNlcjgwMzM5NzMx", "avatar_url": "https://avatars.githubusercontent.com/u/80339731?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hpataxisdotcom", "html_url": "https://github.com/hpataxisdotcom", "followers_url": "https://api.github.com/users/hpataxisdotcom/followers", "following_url": "https://api.github.com/users/hpataxisdotcom/following{/other_user}", "gists_url": "https://api.github.com/users/hpataxisdotcom/gists{/gist_id}", "starred_url": "https://api.github.com/users/hpataxisdotcom/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hpataxisdotcom/subscriptions", "organizations_url": "https://api.github.com/users/hpataxisdotcom/orgs", "repos_url": "https://api.github.com/users/hpataxisdotcom/repos", "events_url": "https://api.github.com/users/hpataxisdotcom/events{/privacy}", "received_events_url": "https://api.github.com/users/hpataxisdotcom/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "038c79764b247f03fb5dfc2943cc32a8b3e15b6e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/038c79764b247f03fb5dfc2943cc32a8b3e15b6e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/038c79764b247f03fb5dfc2943cc32a8b3e15b6e"}], "stats": {"total": 24, "additions": 24, "deletions": 0}, "files": [{"sha": "eaa6d067c81e548cf92d93da2f295c031946b50b", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c134da6b7748136088781e3f19c0f2ced109a4b0/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c134da6b7748136088781e3f19c0f2ced109a4b0/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=c134da6b7748136088781e3f19c0f2ced109a4b0", "patch": "@@ -1,3 +1,11 @@\n+2002-06-16  Hans-Peter Nilsson  <hp@axis.com>\n+\n+\tPR target/7042\n+\t* reorg.c (make_return_insns) [DELAY_SLOTS_FOR_EPILOGUE]: Exit\n+\tearly if current_function_epilogue_delay_list is non-empty.\n+\t* config/cris/cris.md (\"return\"): Add sanity check asserting that\n+\tcurrent_function_epilogue_delay_list is empty.\n+\n 2002-06-16  Jeff Law <law@redhat.com>\n \n \t* toplev.c (rest_of_compilation): Perform a simpler, less costly"}, {"sha": "c92ec7fd2a4e70a604f25a913dd46a4dc63332d6", "filename": "gcc/config/cris/cris.md", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c134da6b7748136088781e3f19c0f2ced109a4b0/gcc%2Fconfig%2Fcris%2Fcris.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c134da6b7748136088781e3f19c0f2ced109a4b0/gcc%2Fconfig%2Fcris%2Fcris.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fcris%2Fcris.md?ref=c134da6b7748136088781e3f19c0f2ced109a4b0", "patch": "@@ -3394,6 +3394,11 @@\n   /* Just needs to hold a 'movem [sp+],rN'.  */\n   char rd[sizeof (\\\"movem [$sp+],$r99\\\")];\n \n+  /* Try to avoid reorg.c surprises; avoid emitting invalid code, prefer\n+     crashing.  This test would have avoided invalid code for target/7042.  */\n+  if (current_function_epilogue_delay_list != NULL)\n+    abort ();\n+\n   *rd = 0;\n \n   /* Start from the last call-saved register.  We know that we have a"}, {"sha": "2ccde4fdf36fa6d77e3135688cb0a7acbf295a6c", "filename": "gcc/reorg.c", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c134da6b7748136088781e3f19c0f2ced109a4b0/gcc%2Freorg.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c134da6b7748136088781e3f19c0f2ced109a4b0/gcc%2Freorg.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Freorg.c?ref=c134da6b7748136088781e3f19c0f2ced109a4b0", "patch": "@@ -3485,6 +3485,17 @@ make_return_insns (first)\n   rtx real_return_label = end_of_function_label;\n   int slots, i;\n \n+#ifdef DELAY_SLOTS_FOR_EPILOGUE\n+  /* If a previous pass filled delay slots in the epilogue, things get a\n+     bit more complicated, as those filler insns would generally (without\n+     data flow analysis) have to be executed after any existing branch\n+     delay slot filler insns.  It is also unknown whether such a\n+     transformation would actually be profitable.  Note that the existing\n+     code only cares for branches with (some) filled delay slots.  */\n+  if (current_function_epilogue_delay_list != NULL)\n+    return;\n+#endif\n+\n   /* See if there is a RETURN insn in the function other than the one we\n      made for END_OF_FUNCTION_LABEL.  If so, set up anything we can't change\n      into a RETURN to jump to it.  */"}]}