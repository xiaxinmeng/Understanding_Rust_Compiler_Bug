{"sha": "b5c739f9f5969b4803b40467822b0b64e0ecd35e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjVjNzM5ZjlmNTk2OWI0ODAzYjQwNDY3ODIyYjBiNjRlMGVjZDM1ZQ==", "commit": {"author": {"name": "Robert Dewar", "email": "dewar@adacore.com", "date": "2010-08-10T13:50:53Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2010-08-10T13:50:53Z"}, "message": "a-chahan.ads: Add comments on handling of obsolescent entries.\n\n2010-08-10  Robert Dewar  <dewar@adacore.com>\n\n\t* a-chahan.ads: Add comments on handling of obsolescent entries.\n\t* opt.ads: Add Ada_2005 and Ada_2012 renamings for versions.\n\t* restrict.adb (Check_Obsolescent_2005_Entity): New procedure.\n\t* restrict.ads (Check_Obsolescent_2005_Entity): New procedure.\n\t* sem_attr.adb (Analyze_Access_Attribute): Call\n\tCheck_Obsolescent_2005_Entity to check for access to obsolescent\n\tAda.Characters.Handling subprogram.\n\t(Analyze_Attribute, case Class): Applying Class to untagged incomplete\n\ttype is obsolescent in Ada 2005.\n\t(Analyze_Attribute, case Constrained): Better placement of flag when\n\tflagged as obsolescent feature.\n\t(Analyze_Attribute, case Storage_Size): Use with tasks is obsolescent\n\t* sem_ch10.adb (Analyze_With_Clause): With of renamings such as Text_IO\n\tis an obsolescent feature.\n\t* sem_ch11.adb (Analyze_Raise_Statement): Numeric_Error is obsolescent\n\tfeature.\n\t* sem_ch8.adb (Analyze_Subprogram_Renaming): Call\n\tCheck_Obsolescent_2005_Entity to check for renaming obsolete\n\tAda.Characters.Handling subprogram.\n\t* sem_prag.adb (Process_Restrictions_Or_Restriction_Warnings): Check\n\tfor obsolescent restrictions in Ada 2005.\n\t(Analyze_Pragma, case Suppress): Entity arg is obsolescent in Ada 2005\n\t(Analyze_Pragma, case Interface): Interface is obsolescent in Ada 2005\n\t* sem_res.adb (Resolve_Call): Call Check_Obsolescent_2005_Entity to\n\tcheck for obsolescent references to Ada.Characters.Handling subprograms\n\n2010-08-10  Robert Dewar  <dewar@adacore.com>\n\n\t* einfo.adb, einfo.ads: Fix bad -gnatdt output for incomplete type.\n\n2010-08-10  Robert Dewar  <dewar@adacore.com>\n\n\t* errout.ads: Add VMS table entries for 2005, 12, 2012 switches\n\t* par-ch4.adb: Change wording of Ada 2012 messages\n\t* vms_data.ads: Add VMS entries for /2005, /12, /2012\n\nFrom-SVN: r163063", "tree": {"sha": "68d280c8a731b8532d94ecf7f4d3dbceace88a64", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/68d280c8a731b8532d94ecf7f4d3dbceace88a64"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b5c739f9f5969b4803b40467822b0b64e0ecd35e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b5c739f9f5969b4803b40467822b0b64e0ecd35e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b5c739f9f5969b4803b40467822b0b64e0ecd35e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b5c739f9f5969b4803b40467822b0b64e0ecd35e/comments", "author": null, "committer": null, "parents": [{"sha": "d606f1df142db414d00e0089acb76f4d29caf441", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d606f1df142db414d00e0089acb76f4d29caf441", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d606f1df142db414d00e0089acb76f4d29caf441"}], "stats": {"total": 254, "additions": 237, "deletions": 17}, "files": [{"sha": "0b379f6c3ec3f670ec69fdf32108dfe5c9455de0", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 38, "deletions": 0, "changes": 38, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b5c739f9f5969b4803b40467822b0b64e0ecd35e/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b5c739f9f5969b4803b40467822b0b64e0ecd35e/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=b5c739f9f5969b4803b40467822b0b64e0ecd35e", "patch": "@@ -1,3 +1,41 @@\n+2010-08-10  Robert Dewar  <dewar@adacore.com>\n+\n+\t* a-chahan.ads: Add comments on handling of obsolescent entries.\n+\t* opt.ads: Add Ada_2005 and Ada_2012 renamings for versions.\n+\t* restrict.adb (Check_Obsolescent_2005_Entity): New procedure.\n+\t* restrict.ads (Check_Obsolescent_2005_Entity): New procedure.\n+\t* sem_attr.adb (Analyze_Access_Attribute): Call\n+\tCheck_Obsolescent_2005_Entity to check for access to obsolescent\n+\tAda.Characters.Handling subprogram.\n+\t(Analyze_Attribute, case Class): Applying Class to untagged incomplete\n+\ttype is obsolescent in Ada 2005.\n+\t(Analyze_Attribute, case Constrained): Better placement of flag when\n+\tflagged as obsolescent feature.\n+\t(Analyze_Attribute, case Storage_Size): Use with tasks is obsolescent\n+\t* sem_ch10.adb (Analyze_With_Clause): With of renamings such as Text_IO\n+\tis an obsolescent feature.\n+\t* sem_ch11.adb (Analyze_Raise_Statement): Numeric_Error is obsolescent\n+\tfeature.\n+\t* sem_ch8.adb (Analyze_Subprogram_Renaming): Call\n+\tCheck_Obsolescent_2005_Entity to check for renaming obsolete\n+\tAda.Characters.Handling subprogram.\n+\t* sem_prag.adb (Process_Restrictions_Or_Restriction_Warnings): Check\n+\tfor obsolescent restrictions in Ada 2005.\n+\t(Analyze_Pragma, case Suppress): Entity arg is obsolescent in Ada 2005\n+\t(Analyze_Pragma, case Interface): Interface is obsolescent in Ada 2005\n+\t* sem_res.adb (Resolve_Call): Call Check_Obsolescent_2005_Entity to\n+\tcheck for obsolescent references to Ada.Characters.Handling subprograms\n+\n+2010-08-10  Robert Dewar  <dewar@adacore.com>\n+\n+\t* einfo.adb, einfo.ads: Fix bad -gnatdt output for incomplete type.\n+\n+2010-08-10  Robert Dewar  <dewar@adacore.com>\n+\n+\t* errout.ads: Add VMS table entries for 2005, 12, 2012 switches\n+\t* par-ch4.adb: Change wording of Ada 2012 messages\n+\t* vms_data.ads: Add VMS entries for /2005, /12, /2012\n+\n 2010-08-10  Robert Dewar  <dewar@adacore.com>\n \n \t* a-suenco.adb (Convert): Fix bug in UTF-16 to UTF-8 conversion for"}, {"sha": "98f69ba29d07214713e5999ed000a1a41e81e41e", "filename": "gcc/ada/a-chahan.ads", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b5c739f9f5969b4803b40467822b0b64e0ecd35e/gcc%2Fada%2Fa-chahan.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b5c739f9f5969b4803b40467822b0b64e0ecd35e/gcc%2Fada%2Fa-chahan.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fa-chahan.ads?ref=b5c739f9f5969b4803b40467822b0b64e0ecd35e", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 S p e c                                  --\n --                                                                          --\n---          Copyright (C) 1992-2009, Free Software Foundation, Inc.         --\n+--          Copyright (C) 1992-2010, Free Software Foundation, Inc.         --\n --                                                                          --\n -- This specification is derived from the Ada Reference Manual for use with --\n -- GNAT. The copyright notice above, and the license provisions that follow --\n@@ -95,6 +95,9 @@ package Ada.Characters.Handling is\n    --  to use these routines when creating code that is intended to run in\n    --  either Ada 95 or Ada 2005 mode.\n \n+   --  We do however have to flag these if the pragma No_Obsolescent_Features\n+   --  restriction is active (see Restrict.Check_Obsolescent_2005_Entity).\n+\n    function Is_Character (Item : Wide_Character) return Boolean;\n    function Is_String    (Item : Wide_String)    return Boolean;\n \n@@ -108,6 +111,9 @@ package Ada.Characters.Handling is\n    --  to use these routines when creating code that is intended to run in\n    --  either Ada 95 or Ada 2005 mode.\n \n+   --  We do however have to flag these if the pragma No_Obsolescent_Features\n+   --  restriction is active (see Restrict.Check_Obsolescent_2005_Entity).\n+\n    function To_Character\n      (Item       : Wide_Character;\n       Substitute : Character := ' ') return Character;"}, {"sha": "2186428b122c3b4b5b0686a49c0256f3eed036dd", "filename": "gcc/ada/einfo.adb", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b5c739f9f5969b4803b40467822b0b64e0ecd35e/gcc%2Fada%2Feinfo.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b5c739f9f5969b4803b40467822b0b64e0ecd35e/gcc%2Fada%2Feinfo.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Feinfo.adb?ref=b5c739f9f5969b4803b40467822b0b64e0ecd35e", "patch": "@@ -7475,6 +7475,7 @@ package body Einfo is\n             Write_Str (\"Storage_Size_Variable\");\n \n          when Class_Wide_Kind                              |\n+              Incomplete_Kind                              |\n               E_Record_Type                                |\n               E_Record_Subtype                             |\n               Private_Kind                                 =>"}, {"sha": "b1cf28c91c53394ae10abde169131175612447e3", "filename": "gcc/ada/einfo.ads", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b5c739f9f5969b4803b40467822b0b64e0ecd35e/gcc%2Fada%2Feinfo.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b5c739f9f5969b4803b40467822b0b64e0ecd35e/gcc%2Fada%2Feinfo.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Feinfo.ads?ref=b5c739f9f5969b4803b40467822b0b64e0ecd35e", "patch": "@@ -3188,7 +3188,8 @@ package Einfo is\n --       is an error to reference the primitive operations field of a type\n --       that is not tagged). In order to fulfill the C++ ABI, entities of\n --       primitives that come from source must be stored in this list following\n---       their order of occurrence in the sources.\n+--       their order of occurrence in the sources. Also present in incomplete\n+--       types, but in this case the list is always empty.\n \n --    Prival (Node17)\n --       Present in private components of protected types. Refers to the entity"}, {"sha": "4aea9d87d6d55780d6682ec0542e89e0733f8078", "filename": "gcc/ada/errout.ads", "status": "modified", "additions": 14, "deletions": 4, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b5c739f9f5969b4803b40467822b0b64e0ecd35e/gcc%2Fada%2Ferrout.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b5c739f9f5969b4803b40467822b0b64e0ecd35e/gcc%2Fada%2Ferrout.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Ferrout.ads?ref=b5c739f9f5969b4803b40467822b0b64e0ecd35e", "patch": "@@ -376,8 +376,14 @@ package Errout is\n    Gname5 : aliased constant String := \"gnat05\";\n    Vname5 : aliased constant String := \"05\";\n \n-   Gname6 : aliased constant String := \"gnat12\";\n-   Vname6 : aliased constant String := \"12\";\n+   Gname6 : aliased constant String := \"gnat2005\";\n+   Vname6 : aliased constant String := \"2005\";\n+\n+   Gname7 : aliased constant String := \"gnat12\";\n+   Vname7 : aliased constant String := \"12\";\n+\n+   Gname8 : aliased constant String := \"gnat2012\";\n+   Vname8 : aliased constant String := \"2012\";\n \n    type Cstring_Ptr is access constant String;\n \n@@ -387,15 +393,19 @@ package Errout is\n                Gname3'Access,\n                Gname4'Access,\n                Gname5'Access,\n-               Gname6'Access);\n+               Gname6'Access,\n+               Gname7'Access,\n+               Gname8'Access);\n \n    Vnames : array (Nat range <>) of Cstring_Ptr :=\n               (Vname1'Access,\n                Vname2'Access,\n                Vname3'Access,\n                Vname4'Access,\n                Vname5'Access,\n-               Vname6'Access);\n+               Vname6'Access,\n+               Vname7'Access,\n+               Vname8'Access);\n \n    -----------------------------------------------------\n    -- Global Values Used for Error Message Insertions --"}, {"sha": "1ca04ae7cafc77846e2da21fc93b9aa85eb3a956", "filename": "gcc/ada/opt.ads", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b5c739f9f5969b4803b40467822b0b64e0ecd35e/gcc%2Fada%2Fopt.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b5c739f9f5969b4803b40467822b0b64e0ecd35e/gcc%2Fada%2Fopt.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fopt.ads?ref=b5c739f9f5969b4803b40467822b0b64e0ecd35e", "patch": "@@ -68,6 +68,10 @@ package Opt is\n    --  Versions of Ada for Ada_Version below. Note that these are ordered,\n    --  so that tests like Ada_Version >= Ada_95 are legitimate and useful.\n \n+   Ada_2005 : Ada_Version_Type renames Ada_05;\n+   Ada_2012 : Ada_Version_Type renames Ada_12;\n+   --  Renamings with full names (preferred usage)\n+\n    Ada_Version_Default : constant Ada_Version_Type := Ada_05;\n    pragma Warnings (Off, Ada_Version_Default);\n    --  GNAT"}, {"sha": "2b4e6215562f36c7fb4576c1579427f9150dc57e", "filename": "gcc/ada/par-ch4.adb", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b5c739f9f5969b4803b40467822b0b64e0ecd35e/gcc%2Fada%2Fpar-ch4.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b5c739f9f5969b4803b40467822b0b64e0ecd35e/gcc%2Fada%2Fpar-ch4.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fpar-ch4.adb?ref=b5c739f9f5969b4803b40467822b0b64e0ecd35e", "patch": "@@ -2670,7 +2670,7 @@ package body Ch4 is\n    begin\n       if Ada_Version < Ada_12 then\n          Error_Msg_SC (\"|case expression is an Ada 2012 feature\");\n-         Error_Msg_SC (\"\\|use -gnat12 switch to compile this unit\");\n+         Error_Msg_SC (\"\\|unit must be compiled with -gnat2012 switch\");\n       end if;\n \n       Scan; -- past CASE\n@@ -2761,7 +2761,7 @@ package body Ch4 is\n \n       if Token = Tok_If and then Ada_Version < Ada_12 then\n          Error_Msg_SC (\"|conditional expression is an Ada 2012 feature\");\n-         Error_Msg_SC (\"\\|use -gnat12 switch to compile this unit\");\n+         Error_Msg_SC (\"\\|unit must be compiled with -gnat2012 switch\");\n       end if;\n \n       Scan; -- past IF or ELSIF\n@@ -2844,7 +2844,7 @@ package body Ch4 is\n       if Token = Tok_Vertical_Bar then\n          if Ada_Version < Ada_12 then\n             Error_Msg_SC (\"set notation is an Ada 2012 feature\");\n-            Error_Msg_SC (\"\\|use -gnat12 switch to compile this unit\");\n+            Error_Msg_SC (\"\\|unit must be compiled with -gnat2012 switch\");\n          end if;\n \n          Set_Alternatives (N, New_List (Alt));"}, {"sha": "2beae888c6ecf1ee2d6ab879ae9b7a647b8de496", "filename": "gcc/ada/restrict.adb", "status": "modified", "additions": 41, "deletions": 0, "changes": 41, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b5c739f9f5969b4803b40467822b0b64e0ecd35e/gcc%2Fada%2Frestrict.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b5c739f9f5969b4803b40467822b0b64e0ecd35e/gcc%2Fada%2Frestrict.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Frestrict.adb?ref=b5c739f9f5969b4803b40467822b0b64e0ecd35e", "patch": "@@ -34,6 +34,7 @@ with Opt;      use Opt;\n with Sinfo;    use Sinfo;\n with Sinput;   use Sinput;\n with Snames;   use Snames;\n+with Stand;    use Stand;\n with Uname;    use Uname;\n \n package body Restrict is\n@@ -121,6 +122,46 @@ package body Restrict is\n       Check_Restriction (No_Implicit_Heap_Allocations, N);\n    end Check_No_Implicit_Heap_Alloc;\n \n+   -----------------------------------\n+   -- Check_Obsolescent_2005_Entity --\n+   -----------------------------------\n+\n+   procedure Check_Obsolescent_2005_Entity (E : Entity_Id; N : Node_Id) is\n+      function Chars_Is (E : Entity_Id; S : String) return Boolean;\n+      --  Return True iff Chars (E) matches S (given in lower case)\n+\n+      function Chars_Is (E : Entity_Id; S : String) return Boolean is\n+         Nam : constant Name_Id := Chars (E);\n+      begin\n+         if Length_Of_Name (Nam) /= S'Length then\n+            return False;\n+         else\n+            return Get_Name_String (Nam) = S;\n+         end if;\n+      end Chars_Is;\n+\n+   --  Start of processing for Check_Obsolescent_2005_Entity\n+\n+   begin\n+      if Ada_Version >= Ada_2005\n+        and then Restriction_Active (No_Obsolescent_Features)\n+        and then Chars_Is (Scope (E),                 \"handling\")\n+        and then Chars_Is (Scope (Scope (E)),         \"characters\")\n+        and then Chars_Is (Scope (Scope (Scope (E))), \"ada\")\n+        and then Scope (Scope (Scope (Scope (E)))) = Standard_Standard\n+      then\n+         if Chars_Is (E, \"is_character\")      or else\n+            Chars_Is (E, \"is_string\")         or else\n+            Chars_Is (E, \"to_character\")      or else\n+            Chars_Is (E, \"to_string\")         or else\n+            Chars_Is (E, \"to_wide_character\") or else\n+            Chars_Is (E, \"to_wide_string\")\n+         then\n+            Check_Restriction (No_Obsolescent_Features, N);\n+         end if;\n+      end if;\n+   end Check_Obsolescent_2005_Entity;\n+\n    ---------------------------\n    -- Check_Restricted_Unit --\n    ---------------------------"}, {"sha": "a0c5df0b0f9583396924d1692f005ba67ff5c935", "filename": "gcc/ada/restrict.ads", "status": "modified", "additions": 10, "deletions": 1, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b5c739f9f5969b4803b40467822b0b64e0ecd35e/gcc%2Fada%2Frestrict.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b5c739f9f5969b4803b40467822b0b64e0ecd35e/gcc%2Fada%2Frestrict.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Frestrict.ads?ref=b5c739f9f5969b4803b40467822b0b64e0ecd35e", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 S p e c                                  --\n --                                                                          --\n---          Copyright (C) 1992-2008, Free Software Foundation, Inc.         --\n+--          Copyright (C) 1992-2010, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -230,6 +230,15 @@ package Restrict is\n    --  Equivalent to Check_Restriction (No_Implicit_Heap_Allocations, N).\n    --  Provided for easy use by back end, which has to check this restriction.\n \n+   procedure Check_Obsolescent_2005_Entity (E : Entity_Id; N : Node_Id);\n+   --  This routine checks if the entity E is one of the obsolescent entries\n+   --  in Ada.Characters.Handling in Ada 2005 and No_Obsolescent_Features\n+   --  restriction is active. If so an appropriate message is given. N is\n+   --  the node on which the message is to be placed. It's a bit kludgy to\n+   --  have this highly specialized routine rather than some wonderful general\n+   --  mechanism (e.g. a special pragma) to handle this case, but there are\n+   --  only six cases, and it is not worth the effort to do something general.\n+\n    function Cunit_Boolean_Restrictions_Save\n      return Save_Cunit_Boolean_Restrictions;\n    --  This function saves the compilation unit restriction settings, and"}, {"sha": "bbb6a27496763f73b7882315b2a7027ef1583293", "filename": "gcc/ada/sem_attr.adb", "status": "modified", "additions": 28, "deletions": 1, "changes": 29, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b5c739f9f5969b4803b40467822b0b64e0ecd35e/gcc%2Fada%2Fsem_attr.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b5c739f9f5969b4803b40467822b0b64e0ecd35e/gcc%2Fada%2Fsem_attr.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_attr.adb?ref=b5c739f9f5969b4803b40467822b0b64e0ecd35e", "patch": "@@ -584,6 +584,10 @@ package body Sem_Attr is\n \n             Check_For_Eliminated_Subprogram (P, Entity (P));\n \n+            --  Check for obsolescent subprogram reference\n+\n+            Check_Obsolescent_2005_Entity (Entity (P), P);\n+\n             --  Build the appropriate subprogram type\n \n             Build_Access_Subprogram_Type (P);\n@@ -2535,6 +2539,25 @@ package body Sem_Attr is\n          Check_E0;\n          Find_Type (N);\n \n+         --  Applying Class to untagged incomplete type is obsolescent in Ada\n+         --  2005. Note that we can't test Is_Tagged_Type here on P_Type, since\n+         --  this flag gets set by Find_Type in this situation.\n+\n+         if Restriction_Active (No_Obsolescent_Features)\n+           and then Ada_Version >= Ada_2005\n+           and then Ekind (P_Type) = E_Incomplete_Type\n+         then\n+            declare\n+               DN : constant Node_Id := Declaration_Node (P_Type);\n+            begin\n+               if Nkind (DN) = N_Incomplete_Type_Declaration\n+                 and then not Tagged_Present (DN)\n+               then\n+                  Check_Restriction (No_Obsolescent_Features, P);\n+               end if;\n+            end;\n+         end if;\n+\n       ------------------\n       -- Code_Address --\n       ------------------\n@@ -2612,7 +2635,7 @@ package body Sem_Attr is\n          --  Case from RM J.4(2) of constrained applied to private type\n \n          if Is_Entity_Name (P) and then Is_Type (Entity (P)) then\n-            Check_Restriction (No_Obsolescent_Features, N);\n+            Check_Restriction (No_Obsolescent_Features, P);\n \n             if Warn_On_Obsolescent_Feature then\n                Error_Msg_N\n@@ -4197,6 +4220,10 @@ package body Sem_Attr is\n          if Is_Task_Type (P_Type) then\n             Set_Etype (N, Universal_Integer);\n \n+            --  Use with tasks is an obsolescent feature\n+\n+            Check_Restriction (No_Obsolescent_Features, P);\n+\n          elsif Is_Access_Type (P_Type) then\n             if Ekind (P_Type) = E_Access_Subprogram_Type then\n                Error_Attr_P"}, {"sha": "b02cf1491cb9c74eb45385120a7149af970d061e", "filename": "gcc/ada/sem_ch10.adb", "status": "modified", "additions": 26, "deletions": 5, "changes": 31, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b5c739f9f5969b4803b40467822b0b64e0ecd35e/gcc%2Fada%2Fsem_ch10.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b5c739f9f5969b4803b40467822b0b64e0ecd35e/gcc%2Fada%2Fsem_ch10.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch10.adb?ref=b5c739f9f5969b4803b40467822b0b64e0ecd35e", "patch": "@@ -2314,12 +2314,35 @@ package body Sem_Ch10 is\n       --  Set True if the unit currently being compiled is an internal unit\n \n       Save_Style_Check : constant Boolean := Opt.Style_Check;\n-      Save_C_Restrict  : constant Save_Cunit_Boolean_Restrictions :=\n-                           Cunit_Boolean_Restrictions_Save;\n+      Save_C_Restrict  : Save_Cunit_Boolean_Restrictions;\n \n    begin\n       U := Unit (Library_Unit (N));\n \n+      --  If this is an internal unit which is a renaming, then this is a\n+      --  violation of No_Obsolescent_Features.\n+\n+      --  Note: this is not quite right if the user defines one of these units\n+      --  himself, but that's a marginal case, and fixing it is hard ???\n+\n+      if Restriction_Active (No_Obsolescent_Features) then\n+         declare\n+            F : constant File_Name_Type :=\n+                  Unit_File_Name (Get_Source_Unit (U));\n+         begin\n+            if Is_Predefined_File_Name (F, Renamings_Included => True)\n+                 and then not\n+               Is_Predefined_File_Name (F, Renamings_Included => False)\n+            then\n+               Check_Restriction (No_Obsolescent_Features, N);\n+            end if;\n+         end;\n+      end if;\n+\n+      --  Save current restriction set, does not apply to with'ed unit\n+\n+      Save_C_Restrict  := Cunit_Boolean_Restrictions_Save;\n+\n       --  Several actions are skipped for dummy packages (those supplied for\n       --  with's where no matching file could be found). Such packages are\n       --  identified by the Sloc value being set to No_Location.\n@@ -2350,9 +2373,7 @@ package body Sem_Ch10 is\n       --  explicit with'ing of run-time units.\n \n       if Configurable_Run_Time_Mode\n-        and then\n-          Is_Predefined_File_Name\n-            (Unit_File_Name (Get_Source_Unit (Unit (Library_Unit (N)))))\n+        and then Is_Predefined_File_Name (Unit_File_Name (Get_Source_Unit (U)))\n       then\n          Configurable_Run_Time_Mode := False;\n          Semantics (Library_Unit (N));"}, {"sha": "8a4e7f098759053b6d828ba52b51cc7f4eed03bf", "filename": "gcc/ada/sem_ch11.adb", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b5c739f9f5969b4803b40467822b0b64e0ecd35e/gcc%2Fada%2Fsem_ch11.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b5c739f9f5969b4803b40467822b0b64e0ecd35e/gcc%2Fada%2Fsem_ch11.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch11.adb?ref=b5c739f9f5969b4803b40467822b0b64e0ecd35e", "patch": "@@ -538,6 +538,14 @@ package body Sem_Ch11 is\n          end if;\n       end if;\n \n+      --  Check obsolescent use of Numeric_Error\n+\n+      if Exception_Name = Standard_Numeric_Error then\n+         Check_Restriction (No_Obsolescent_Features, Exception_Id);\n+      end if;\n+\n+      --  Kill last assignment indication\n+\n       Kill_Current_Values (Last_Assignment_Only => True);\n    end Analyze_Raise_Statement;\n "}, {"sha": "5ddd96ac6552177d615cce11c9e5bf51b4c3be03", "filename": "gcc/ada/sem_ch8.adb", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b5c739f9f5969b4803b40467822b0b64e0ecd35e/gcc%2Fada%2Fsem_ch8.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b5c739f9f5969b4803b40467822b0b64e0ecd35e/gcc%2Fada%2Fsem_ch8.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch8.adb?ref=b5c739f9f5969b4803b40467822b0b64e0ecd35e", "patch": "@@ -2467,6 +2467,7 @@ package body Sem_Ch8 is\n       end if;\n \n       --  A useful warning, suggested by Ada Bug Finder (Ada-Europe 2005)\n+      --  is to warn if an operator is being renamed as a different operator.\n \n       if Comes_From_Source (N)\n         and then Present (Old_S)\n@@ -2479,6 +2480,10 @@ package body Sem_Ch8 is\n              New_S, Old_S);\n       end if;\n \n+      --  Check for renaming of obsolescent subprogram\n+\n+      Check_Obsolescent_2005_Entity (Entity (Nam), Nam);\n+\n       --  Another warning or some utility: if the new subprogram as the same\n       --  name as the old one, the old one is not hidden by an outer homograph,\n       --  the new one is not a public symbol, and the old one is otherwise"}, {"sha": "c49a20165387cae639c67f7f421bcec96423b19f", "filename": "gcc/ada/sem_prag.adb", "status": "modified", "additions": 27, "deletions": 0, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b5c739f9f5969b4803b40467822b0b64e0ecd35e/gcc%2Fada%2Fsem_prag.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b5c739f9f5969b4803b40467822b0b64e0ecd35e/gcc%2Fada%2Fsem_prag.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_prag.adb?ref=b5c739f9f5969b4803b40467822b0b64e0ecd35e", "patch": "@@ -4430,6 +4430,19 @@ package body Sem_Prag is\n                   Restriction_Warnings (R_Id) := False;\n                end if;\n \n+               --  Check for obsolescent restrictions in Ada 2005 mode\n+\n+               if not Warn\n+                 and then Ada_Version >= Ada_2005\n+                 and then (R_Id = No_Asynchronous_Control\n+                            or else\n+                           R_Id = No_Unchecked_Deallocation\n+                            or else\n+                           R_Id = No_Unchecked_Conversion)\n+               then\n+                  Check_Restriction (No_Obsolescent_Features, N);\n+               end if;\n+\n                --  A very special case that must be processed here: pragma\n                --  Restrictions (No_Exceptions) turns off all run-time\n                --  checking. This is a bit dubious in terms of the formal\n@@ -4621,6 +4634,12 @@ package body Sem_Prag is\n          --  a specified entity (given as the second argument of the pragma)\n \n          else\n+            --  This is obsolescent in Ada 2005 mode\n+\n+            if Ada_Version >= Ada_2005 then\n+               Check_Restriction (No_Obsolescent_Features, Arg2);\n+            end if;\n+\n             Check_Optional_Identifier (Arg2, Name_On);\n             E_Id := Expression (Arg2);\n             Analyze (E_Id);\n@@ -8308,6 +8327,14 @@ package body Sem_Prag is\n             Check_At_Most_N_Arguments  (4);\n             Process_Import_Or_Interface;\n \n+            --  In Ada 2005, the permission to use Interface (a reserved word)\n+            --  as a pragma name is considered an obsolescent feature.\n+\n+            if Ada_Version >= Ada_2005 then\n+               Check_Restriction\n+                 (No_Obsolescent_Features, Pragma_Identifier (N));\n+            end if;\n+\n          --------------------\n          -- Interface_Name --\n          --------------------"}, {"sha": "0917ccecf431842feb7efc7341dc15e8959fe1b1", "filename": "gcc/ada/sem_res.adb", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b5c739f9f5969b4803b40467822b0b64e0ecd35e/gcc%2Fada%2Fsem_res.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b5c739f9f5969b4803b40467822b0b64e0ecd35e/gcc%2Fada%2Fsem_res.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_res.adb?ref=b5c739f9f5969b4803b40467822b0b64e0ecd35e", "patch": "@@ -5250,7 +5250,7 @@ package body Sem_Res is\n                         K : constant Node_Kind := Nkind (Parent (N));\n                      begin\n                         if (K = N_Loop_Statement\n-                            and then Present (Iteration_Scheme (Parent (N))))\n+                             and then Present (Iteration_Scheme (Parent (N))))\n                           or else K = N_If_Statement\n                           or else K = N_Elsif_Part\n                           or else K = N_Case_Statement_Alternative\n@@ -5276,6 +5276,10 @@ package body Sem_Res is\n          end if;\n       end if;\n \n+      --  Check obsolescent reference to Ada.Characters.Handling subprogram\n+\n+      Check_Obsolescent_2005_Entity (Nam, Subp);\n+\n       --  If subprogram name is a predefined operator, it was given in\n       --  functional notation. Replace call node with operator node, so\n       --  that actuals can be resolved appropriately."}, {"sha": "84571bb3bacc890a2699da38c1d29032a39c7da5", "filename": "gcc/ada/vms_data.ads", "status": "modified", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b5c739f9f5969b4803b40467822b0b64e0ecd35e/gcc%2Fada%2Fvms_data.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b5c739f9f5969b4803b40467822b0b64e0ecd35e/gcc%2Fada%2Fvms_data.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fvms_data.ads?ref=b5c739f9f5969b4803b40467822b0b64e0ecd35e", "patch": "@@ -1229,13 +1229,28 @@ package VMS_Data is\n    --\n    --   Allows GNAT to recognize the full range of Ada 2005 constructs.\n \n+   S_GCC_Ada_2005 : aliased constant S := \"/2005 \"                         &\n+                                             \"-gnat2005\";\n+   --        /05 (D)\n+   --\n+   --   Allows GNAT to recognize the full range of Ada 2005 constructs.\n+   --   Equivalent to /05 (/2005 is the preferred usage).\n+\n    S_GCC_Ada_12 : aliased constant S := \"/12 \"                             &\n                                              \"-gnat12\";\n    --        /05 (D)\n    --\n    --   Allows GNAT to recognize all implemented proposed Ada 2012\n    --   extensions. See features file for list of implemented features.\n \n+   S_GCC_Ada_2012 : aliased constant S := \"/2012 \"                         &\n+                                             \"-gnat2012\";\n+   --        /05 (D)\n+   --\n+   --   Allows GNAT to recognize all implemented proposed Ada 2012\n+   --   extensions. See features file for list of implemented features.\n+   --   Equivalent to /12 (/2012 is the preferred usage).\n+\n    S_GCC_Add     : aliased constant S := \"/ADD_PROJECT_SEARCH_DIR=*\"       &\n                                             \"-aP*\";\n    --        /ADD_PROJECT_SEARCH_PATH=(directory[,...])\n@@ -3443,6 +3458,9 @@ package VMS_Data is\n                     (S_GCC_Ada_83  'Access,\n                      S_GCC_Ada_95  'Access,\n                      S_GCC_Ada_05  'Access,\n+                     S_GCC_Ada_2005'Access,\n+                     S_GCC_Ada_12  'Access,\n+                     S_GCC_Ada_2012'Access,\n                      S_GCC_Add     'Access,\n                      S_GCC_Asm     'Access,\n                      S_GCC_AValid  'Access,"}]}