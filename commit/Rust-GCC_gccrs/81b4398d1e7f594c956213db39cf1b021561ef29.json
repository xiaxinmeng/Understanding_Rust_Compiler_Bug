{"sha": "81b4398d1e7f594c956213db39cf1b021561ef29", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODFiNDM5OGQxZTdmNTk0Yzk1NjIxM2RiMzljZjFiMDIxNTYxZWYyOQ==", "commit": {"author": {"name": "Adam Nemet", "email": "anemet@lnxw.com", "date": "2004-05-27T19:08:57Z"}, "committer": {"name": "Adam Nemet", "email": "nemet@gcc.gnu.org", "date": "2004-05-27T19:08:57Z"}, "message": "re PR c++/12883 (destructor of array object not called if no prior instantiation of the template has happened)\n\n\tPR c++/12883\n\t* decl.c (complete_array_type): Set TYPE_NEEDS_CONSTRUCTING and\n\tTYPE_HAS_NONTRIVIAL_DESTRUCTOR based on the underlying type.\n\nFrom-SVN: r82333", "tree": {"sha": "2fd6f5b0ff53e9eef59f5bab9d2fc106c512bc17", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2fd6f5b0ff53e9eef59f5bab9d2fc106c512bc17"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/81b4398d1e7f594c956213db39cf1b021561ef29", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/81b4398d1e7f594c956213db39cf1b021561ef29", "html_url": "https://github.com/Rust-GCC/gccrs/commit/81b4398d1e7f594c956213db39cf1b021561ef29", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/81b4398d1e7f594c956213db39cf1b021561ef29/comments", "author": null, "committer": null, "parents": [{"sha": "30f1bddcb7217576c4b746ca0e84e50e3684cf78", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/30f1bddcb7217576c4b746ca0e84e50e3684cf78", "html_url": "https://github.com/Rust-GCC/gccrs/commit/30f1bddcb7217576c4b746ca0e84e50e3684cf78"}], "stats": {"total": 13, "additions": 13, "deletions": 0}, "files": [{"sha": "92b10d062d0cac1f306020d83054ca9faeb11153", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/81b4398d1e7f594c956213db39cf1b021561ef29/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/81b4398d1e7f594c956213db39cf1b021561ef29/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=81b4398d1e7f594c956213db39cf1b021561ef29", "patch": "@@ -1,3 +1,9 @@\n+2004-05-27  Adam Nemet  <anemet@lnxw.com>\n+\n+\tPR c++/12883\n+\t* decl.c (complete_array_type): Set TYPE_NEEDS_CONSTRUCTING and\n+\tTYPE_HAS_NONTRIVIAL_DESTRUCTOR based on the underlying type.\n+\n 2004-05-24  Geoffrey Keating  <geoffk@apple.com>\n \n \t* method.c (implicitly_declare_fn): Don't call defer_fn; abort"}, {"sha": "8a464beba6870492a41c8f0003e06f277134f481", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/81b4398d1e7f594c956213db39cf1b021561ef29/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/81b4398d1e7f594c956213db39cf1b021561ef29/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=81b4398d1e7f594c956213db39cf1b021561ef29", "patch": "@@ -5337,6 +5337,7 @@ complete_array_type (tree type, tree initial_value, int do_default)\n     {\n       tree itype;\n       tree domain;\n+      tree elt_type;\n \n       domain = build_index_type (maxindex);\n       TYPE_DOMAIN (type) = domain;\n@@ -5354,6 +5355,12 @@ complete_array_type (tree type, tree initial_value, int do_default)\n \t size of the array.  */\n       if (! TYPE_DOMAIN (TYPE_MAIN_VARIANT (type)))\n \tTYPE_DOMAIN (TYPE_MAIN_VARIANT (type)) = domain;\n+\n+      elt_type = TREE_TYPE (type);\n+      TYPE_NEEDS_CONSTRUCTING (type)\n+\t= TYPE_NEEDS_CONSTRUCTING (TYPE_MAIN_VARIANT (elt_type));\n+      TYPE_HAS_NONTRIVIAL_DESTRUCTOR (type)\n+\t= TYPE_HAS_NONTRIVIAL_DESTRUCTOR (TYPE_MAIN_VARIANT (elt_type));      \n     }\n \n   /* Lay out the type now that we can get the real answer.  */"}]}