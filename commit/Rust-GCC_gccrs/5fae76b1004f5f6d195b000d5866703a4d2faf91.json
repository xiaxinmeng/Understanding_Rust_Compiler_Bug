{"sha": "5fae76b1004f5f6d195b000d5866703a4d2faf91", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NWZhZTc2YjEwMDRmNWY2ZDE5NWIwMDBkNTg2NjcwM2E0ZDJmYWY5MQ==", "commit": {"author": {"name": "H.J. Lu", "email": "hjl@gcc.gnu.org", "date": "2009-11-11T20:34:13Z"}, "committer": {"name": "H.J. Lu", "email": "hjl@gcc.gnu.org", "date": "2009-11-11T20:34:13Z"}, "message": "re PR testsuite/42001 (LTO tests fail with non multilib targets (but still not --disable-multilib ))\n\n2009-11-11  H.J. Lu  <hongjiu.lu@intel.com>\n\n\tPR testsuite/42001\n\t* gcc.dg/lto/lto.exp: Pass no-mathlib to lto_init.  Call\n\tlto_finish at the end.\n\n\t* lib/lto.exp (lto_init): Set mathlib to \" \" for no-mathlib.\n\t(lto_finish): New. Restore mathlib.\n\nFrom-SVN: r154104", "tree": {"sha": "a060b88ae1942c97f5cb8f08cd42d53acf451025", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a060b88ae1942c97f5cb8f08cd42d53acf451025"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5fae76b1004f5f6d195b000d5866703a4d2faf91", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5fae76b1004f5f6d195b000d5866703a4d2faf91", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5fae76b1004f5f6d195b000d5866703a4d2faf91", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5fae76b1004f5f6d195b000d5866703a4d2faf91/comments", "author": null, "committer": null, "parents": [{"sha": "a4ecd144bb7cbad8f122f98b2db8a3b6de468361", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a4ecd144bb7cbad8f122f98b2db8a3b6de468361", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a4ecd144bb7cbad8f122f98b2db8a3b6de468361"}], "stats": {"total": 52, "additions": 45, "deletions": 7}, "files": [{"sha": "c0a802e8f9f39db6c44fe6b074ebe86b822e05f5", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 14, "deletions": 5, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5fae76b1004f5f6d195b000d5866703a4d2faf91/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5fae76b1004f5f6d195b000d5866703a4d2faf91/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=5fae76b1004f5f6d195b000d5866703a4d2faf91", "patch": "@@ -1,3 +1,12 @@\n+2009-11-11  H.J. Lu  <hongjiu.lu@intel.com>\n+\n+\tPR testsuite/42001\n+\t* gcc.dg/lto/lto.exp: Pass no-mathlib to lto_init.  Call\n+\tlto_finish at the end.\n+\n+\t* lib/lto.exp (lto_init): Set mathlib to \" \" for no-mathlib.\n+\t(lto_finish): New. Restore mathlib.\n+\n 2009-11-11  Kai Tietz  <kai.tietz@onevision.com>\n \n \t* g++.dg/torture/pushpop_macro.C: New testcase.\n@@ -7,11 +16,11 @@\n \n 2009-11-11  Jon Beniston <jon@beniston.com>\n \n-        * lib/target-supports.exp (check_profiling_available): lm32 target \n-          doesn't support profiling.\n-        * gcc.dg/20020312-2.c: Add lm32 support.\n-        * g++.dg/other/packed1.C: Expect to fail on lm32.        \n-        * g++.old-deja/g++.jason/thunk3.C: Likewise.                 \n+\t* lib/target-supports.exp (check_profiling_available): lm32 target \n+\t  doesn't support profiling.\n+\t* gcc.dg/20020312-2.c: Add lm32 support.\n+\t* g++.dg/other/packed1.C: Expect to fail on lm32.        \n+\t* g++.old-deja/g++.jason/thunk3.C: Likewise.                 \n \n 2009-11-11  Daniel Jacobowitz  <dan@codesourcery.com>\n "}, {"sha": "6cd798f46fb5013b0f9aaffb6b6b14ca777a5c1d", "filename": "gcc/testsuite/gcc.dg/lto/lto.exp", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5fae76b1004f5f6d195b000d5866703a4d2faf91/gcc%2Ftestsuite%2Fgcc.dg%2Flto%2Flto.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5fae76b1004f5f6d195b000d5866703a4d2faf91/gcc%2Ftestsuite%2Fgcc.dg%2Flto%2Flto.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Flto%2Flto.exp?ref=5fae76b1004f5f6d195b000d5866703a4d2faf91", "patch": "@@ -35,7 +35,7 @@ load_lib gcc.exp\n load_lib lto.exp\n \n gcc_init\n-lto_init\n+lto_init no-mathlib\n \n # Define an identifier for use with this suite to avoid name conflicts\n # with other lto tests running at the same time.\n@@ -55,3 +55,5 @@ foreach src [lsort [find $srcdir/$subdir *_0.c]] {\n \n     lto-execute $src $sid\n }\n+\n+lto_finish"}, {"sha": "c3ff61aa2ce33f699c764a441e1eb40317f055b8", "filename": "gcc/testsuite/lib/lto.exp", "status": "modified", "additions": 28, "deletions": 1, "changes": 29, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5fae76b1004f5f6d195b000d5866703a4d2faf91/gcc%2Ftestsuite%2Flib%2Flto.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5fae76b1004f5f6d195b000d5866703a4d2faf91/gcc%2Ftestsuite%2Flib%2Flto.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Flib%2Flto.exp?ref=5fae76b1004f5f6d195b000d5866703a4d2faf91", "patch": "@@ -17,11 +17,22 @@\n # Contributed by Diego Novillo <dnovillo@google.com>\n \n \n-# lto_init -- called at the start of eac subdir of tests\n+# lto_init -- called at the start of each subdir of tests\n \n proc lto_init { args } {\n     global LTO_OPTIONS\n \n+    if {[info exists args] && $args == \"no-mathlib\"} {\n+\tglobal board_info\n+\tglobal saved_mathlib\n+\n+\tset dest [target_info name]\n+\tif [board_info $dest exists mathlib] {\n+\t    set saved_mathlib [board_info $dest mathlib]\n+\t}\n+\tset board_info($dest,mathlib) \" \"\n+    }\n+\n     # Each test is run with the compiler options from this list.\n     # The default option lists can be overridden by LTO_OPTIONS=\"[list\n     # {opts_1} {opts_2}... {opts_n}]\" where opts_i are lists of options.\n@@ -37,6 +48,22 @@ proc lto_init { args } {\n     }\n }\n \n+#\n+# lto_finish -- called at the end of each subdir of tests if mathlib is\n+#\t\tchanged.\n+#\n+\n+proc lto_finish { } {\n+    global board_info\n+    global saved_mathlib\n+\n+    set dest [target_info name]\n+    if [info exists saved_mathlib] {\n+\tset board_info($dest,mathlib) $saved_mathlib\n+    } elseif [board_info $dest exists mathlib] {\n+\tunset board_info($dest,mathlib)\n+    }\n+}\n \n # Subsets of tests can be selectively disabled by members of this list:\n #  - ATTRIBUTE: disable all tests using the __attribute__ extension,"}]}