{"sha": "ff082cab8150ceabc83e2321824c5a4f372df396", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZmYwODJjYWI4MTUwY2VhYmM4M2UyMzIxODI0YzVhNGYzNzJkZjM5Ng==", "commit": {"author": {"name": "Rainer Orth", "email": "ro@CeBiTec.Uni-Bielefeld.DE", "date": "2013-11-28T12:27:58Z"}, "committer": {"name": "Rainer Orth", "email": "ro@gcc.gnu.org", "date": "2013-11-28T12:27:58Z"}, "message": "Add -lrt on Solaris\n\n\tgcc/cp:\n\t* g++spec.c (TIMELIB): Define.\n\t(WITHLIBC, SKIPOPT): Adjust values.\n\t(lang_specific_driver): Add TIME_LIBRARY if not passed explicitly.\n\n\tgcc:\n\t* config/sol2.h (TIME_LIBRARY): Define.\n\nFrom-SVN: r205483", "tree": {"sha": "0b31deb1edb9a707798c68f61eacd89550def09a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0b31deb1edb9a707798c68f61eacd89550def09a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ff082cab8150ceabc83e2321824c5a4f372df396", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ff082cab8150ceabc83e2321824c5a4f372df396", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ff082cab8150ceabc83e2321824c5a4f372df396", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ff082cab8150ceabc83e2321824c5a4f372df396/comments", "author": {"login": "rorth", "id": 3930951, "node_id": "MDQ6VXNlcjM5MzA5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/3930951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rorth", "html_url": "https://github.com/rorth", "followers_url": "https://api.github.com/users/rorth/followers", "following_url": "https://api.github.com/users/rorth/following{/other_user}", "gists_url": "https://api.github.com/users/rorth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rorth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rorth/subscriptions", "organizations_url": "https://api.github.com/users/rorth/orgs", "repos_url": "https://api.github.com/users/rorth/repos", "events_url": "https://api.github.com/users/rorth/events{/privacy}", "received_events_url": "https://api.github.com/users/rorth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "049558ed481d2c43a77a13f7486dc403162d88ee", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/049558ed481d2c43a77a13f7486dc403162d88ee", "html_url": "https://github.com/Rust-GCC/gccrs/commit/049558ed481d2c43a77a13f7486dc403162d88ee"}], "stats": {"total": 51, "additions": 48, "deletions": 3}, "files": [{"sha": "9ebecda6ecc618758665157de29e032e3497e237", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ff082cab8150ceabc83e2321824c5a4f372df396/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ff082cab8150ceabc83e2321824c5a4f372df396/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=ff082cab8150ceabc83e2321824c5a4f372df396", "patch": "@@ -1,3 +1,7 @@\n+2013-11-28  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>\n+\n+\t* config/sol2.h (TIME_LIBRARY): Define.\n+\n 2013-11-28  Richard Biener  <rguenther@suse.de>\n \n \tPR lto/59323"}, {"sha": "abd7342aef5138795746bb09256e44b2b71499c4", "filename": "gcc/config/sol2.h", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ff082cab8150ceabc83e2321824c5a4f372df396/gcc%2Fconfig%2Fsol2.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ff082cab8150ceabc83e2321824c5a4f372df396/gcc%2Fconfig%2Fsol2.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fsol2.h?ref=ff082cab8150ceabc83e2321824c5a4f372df396", "patch": "@@ -163,6 +163,9 @@ along with GCC; see the file COPYING3.  If not see\n #undef LINK_ARCH_SPEC\n #define LINK_ARCH_SPEC LINK_ARCH32_SPEC\n \n+/* C++11 programs need -lrt for nanosleep.  */\n+#define TIME_LIBRARY \"rt\"\n+\n #ifndef USE_GLD\n /* With Sun ld, -rdynamic is a no-op.  */\n #define RDYNAMIC_SPEC \"\""}, {"sha": "adc60267405d282323eafc03b7254f158e1e38a8", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ff082cab8150ceabc83e2321824c5a4f372df396/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ff082cab8150ceabc83e2321824c5a4f372df396/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=ff082cab8150ceabc83e2321824c5a4f372df396", "patch": "@@ -1,3 +1,9 @@\n+2013-11-28  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>\n+\n+\t* g++spec.c (TIMELIB): Define.\n+\t(WITHLIBC, SKIPOPT): Adjust values.\n+\t(lang_specific_driver): Add TIME_LIBRARY if not passed explicitly.\n+\n 2013-11-28  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR c/59310"}, {"sha": "93f94602c9208e319535b4b7359eb2401af7af62", "filename": "gcc/cp/g++spec.c", "status": "modified", "additions": 35, "deletions": 3, "changes": 38, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ff082cab8150ceabc83e2321824c5a4f372df396/gcc%2Fcp%2Fg%2B%2Bspec.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ff082cab8150ceabc83e2321824c5a4f372df396/gcc%2Fcp%2Fg%2B%2Bspec.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fg%2B%2Bspec.c?ref=ff082cab8150ceabc83e2321824c5a4f372df396", "patch": "@@ -28,10 +28,12 @@ along with GCC; see the file COPYING3.  If not see\n #define LANGSPEC\t(1<<1)\n /* This bit is set if they did `-lm' or `-lmath'.  */\n #define MATHLIB\t\t(1<<2)\n+/* This bit is set if they did `-lrt' or equivalent.  */\n+#define TIMELIB\t\t(1<<3)\n /* This bit is set if they did `-lc'.  */\n-#define WITHLIBC\t(1<<3)\n+#define WITHLIBC\t(1<<4)\n /* Skip this option.  */\n-#define SKIPOPT\t\t(1<<4)\n+#define SKIPOPT\t\t(1<<5)\n \n #ifndef MATH_LIBRARY\n #define MATH_LIBRARY \"m\"\n@@ -40,6 +42,10 @@ along with GCC; see the file COPYING3.  If not see\n #define MATH_LIBRARY_PROFILE MATH_LIBRARY\n #endif\n \n+#ifndef TIME_LIBRARY\n+#define TIME_LIBRARY \"\"\n+#endif\n+\n #ifndef LIBSTDCXX\n #define LIBSTDCXX \"stdc++\"\n #endif\n@@ -83,16 +89,22 @@ lang_specific_driver (struct cl_decoded_option **in_decoded_options,\n   /* \"-lm\" or \"-lmath\" if it appears on the command line.  */\n   const struct cl_decoded_option *saw_math = NULL;\n \n+  /* \"-lrt\" or eqivalent if it appears on the command line.  */\n+  const struct cl_decoded_option *saw_time = NULL;\n+\n   /* \"-lc\" if it appears on the command line.  */\n   const struct cl_decoded_option *saw_libc = NULL;\n \n   /* An array used to flag each argument that needs a bit set for\n-     LANGSPEC, MATHLIB, or WITHLIBC.  */\n+     LANGSPEC, MATHLIB, TIMELIB, or WITHLIBC.  */\n   int *args;\n \n   /* By default, we throw on the math library if we have one.  */\n   int need_math = (MATH_LIBRARY[0] != '\\0');\n \n+  /* By default, we throw on the time library if we have one.  */\n+  int need_time = (TIME_LIBRARY[0] != '\\0');\n+\n   /* True if we saw -static.  */\n   int static_link = 0;\n \n@@ -136,6 +148,11 @@ lang_specific_driver (struct cl_decoded_option **in_decoded_options,\n \t      args[i] |= MATHLIB;\n \t      need_math = 0;\n \t    }\n+\t  else if (strcmp (arg, TIME_LIBRARY) == 0)\n+\t    {\n+\t      args[i] |= TIMELIB;\n+\t      need_time = 0;\n+\t    }\n \t  else if (strcmp (arg, \"c\") == 0)\n \t    args[i] |= WITHLIBC;\n \t  else\n@@ -268,6 +285,12 @@ lang_specific_driver (struct cl_decoded_option **in_decoded_options,\n \t  saw_math = &decoded_options[i];\n \t}\n \n+      if (!saw_time && (args[i] & TIMELIB) && library > 0)\n+\t{\n+\t  --j;\n+\t  saw_time = &decoded_options[i];\n+\t}\n+\n       if (!saw_libc && (args[i] & WITHLIBC) && library > 0)\n \t{\n \t  --j;\n@@ -352,6 +375,15 @@ lang_specific_driver (struct cl_decoded_option **in_decoded_options,\n       added_libraries++;\n       j++;\n     }\n+  if (saw_time)\n+    new_decoded_options[j++] = *saw_time;\n+  else if (library > 0 && need_time)\n+    {\n+      generate_option (OPT_l, TIME_LIBRARY, 1, CL_DRIVER,\n+\t\t       &new_decoded_options[j]);\n+      added_libraries++;\n+      j++;\n+    }\n   if (saw_libc)\n     new_decoded_options[j++] = *saw_libc;\n   if (shared_libgcc && !static_link)"}]}