{"sha": "e12c40944905e48a1830861c63e6e39ae67eb8b0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTEyYzQwOTQ0OTA1ZTQ4YTE4MzA4NjFjNjNlNmUzOWFlNjdlYjhiMA==", "commit": {"author": {"name": "Alexandre Oliva", "email": "aoliva@redhat.com", "date": "2009-09-03T05:55:57Z"}, "committer": {"name": "Alexandre Oliva", "email": "aoliva@gcc.gnu.org", "date": "2009-09-03T05:55:57Z"}, "message": "configure.ac (--with-build-config): New.\n\nChangeLog:\n* configure.ac (--with-build-config): New.  Set BUILD_CONFIG.\nDefault to bootstrap-debug only if compare-debug works.\n* configure: Rebuilt.\n* Makefile.tpl: Make BUILD_CONFIG configure-configurable.\n* Makefile.in: Rebuilt.\ncontrib/ChangeLog:\n* bootstrap-debug-big.mk (STAGE2_CFLAGS): Drop -gtoggle.\n* bootstrap-debug-lean.mk: Update comments.\n(STAGE2_CFLAGS): Likewise.\n(do-compare): Don't override.\ngcc/ChangeLog:\n* doc/invoke.texi (BUILD_CONFIG): Document --with-build-config.\n(bootstrap-debug): Explain conditions in which it becomes default.\n(bootstrap-debug-big): Rather than duplicate bootstrap-debug,\nmake it add to it.\n\nFrom-SVN: r151367", "tree": {"sha": "25dfd748372489c6fc5d3fdee9ab3613caae4dc5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/25dfd748372489c6fc5d3fdee9ab3613caae4dc5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e12c40944905e48a1830861c63e6e39ae67eb8b0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e12c40944905e48a1830861c63e6e39ae67eb8b0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e12c40944905e48a1830861c63e6e39ae67eb8b0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e12c40944905e48a1830861c63e6e39ae67eb8b0/comments", "author": null, "committer": null, "parents": [{"sha": "95da10ea1894ddc616d2d1a28f787e2c7b9a85e8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/95da10ea1894ddc616d2d1a28f787e2c7b9a85e8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/95da10ea1894ddc616d2d1a28f787e2c7b9a85e8"}], "stats": {"total": 144, "additions": 114, "deletions": 30}, "files": [{"sha": "6c2978002636471c9599712f0d0f9deecbcd6011", "filename": "ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e12c40944905e48a1830861c63e6e39ae67eb8b0/ChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e12c40944905e48a1830861c63e6e39ae67eb8b0/ChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/ChangeLog?ref=e12c40944905e48a1830861c63e6e39ae67eb8b0", "patch": "@@ -1,3 +1,11 @@\n+2009-09-03  Alexandre Oliva  <aoliva@redhat.com>\n+\n+\t* configure.ac (--with-build-config): New.  Set BUILD_CONFIG.\n+\tDefault to bootstrap-debug only if compare-debug works.\n+\t* configure: Rebuilt.\n+\t* Makefile.tpl: Make BUILD_CONFIG configure-configurable.\n+\t* Makefile.in: Rebuilt.\n+\n 2009-09-02  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>\n \n \t* MAINTAINERS (OS Port Maintainers): Update my email address."}, {"sha": "044f849d0aa68119104251f1f18530041e5f7b15", "filename": "Makefile.in", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e12c40944905e48a1830861c63e6e39ae67eb8b0/Makefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e12c40944905e48a1830861c63e6e39ae67eb8b0/Makefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/Makefile.in?ref=e12c40944905e48a1830861c63e6e39ae67eb8b0", "patch": "@@ -771,7 +771,7 @@ EXTRA_GCC_FLAGS = \\\n GCC_FLAGS_TO_PASS = $(BASE_FLAGS_TO_PASS) $(EXTRA_HOST_FLAGS) $(EXTRA_GCC_FLAGS)\n \n @if gcc\n-BUILD_CONFIG = bootstrap-debug\n+BUILD_CONFIG = @BUILD_CONFIG@\n ifneq ($(BUILD_CONFIG),)\n include $(foreach CONFIG, $(BUILD_CONFIG), $(srcdir)/config/$(CONFIG).mk)\n endif"}, {"sha": "6c63d950fc6d0d4c0dee3c13a504e3aa32b9e7c9", "filename": "Makefile.tpl", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e12c40944905e48a1830861c63e6e39ae67eb8b0/Makefile.tpl", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e12c40944905e48a1830861c63e6e39ae67eb8b0/Makefile.tpl", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/Makefile.tpl?ref=e12c40944905e48a1830861c63e6e39ae67eb8b0", "patch": "@@ -619,7 +619,7 @@ EXTRA_GCC_FLAGS = \\\n GCC_FLAGS_TO_PASS = $(BASE_FLAGS_TO_PASS) $(EXTRA_HOST_FLAGS) $(EXTRA_GCC_FLAGS)\n \n @if gcc\n-BUILD_CONFIG = bootstrap-debug\n+BUILD_CONFIG = @BUILD_CONFIG@\n ifneq ($(BUILD_CONFIG),)\n include $(foreach CONFIG, $(BUILD_CONFIG), $(srcdir)/config/$(CONFIG).mk)\n endif"}, {"sha": "855ddc2a642446e7e6266780a2b12e056977c2c4", "filename": "config/bootstrap-debug-big.mk", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e12c40944905e48a1830861c63e6e39ae67eb8b0/config%2Fbootstrap-debug-big.mk", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e12c40944905e48a1830861c63e6e39ae67eb8b0/config%2Fbootstrap-debug-big.mk", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/config%2Fbootstrap-debug-big.mk?ref=e12c40944905e48a1830861c63e6e39ae67eb8b0", "patch": "@@ -3,6 +3,6 @@\n # stage3, it generates dumps during stage2 and stage3, saving them all\n # until the final compare.\n \n-STAGE2_CFLAGS += -gtoggle -fdump-final-insns\n+STAGE2_CFLAGS += -fdump-final-insns\n STAGE3_CFLAGS += -fdump-final-insns\n do-compare = $(SHELL) $(srcdir)/contrib/compare-debug $$f1 $$f2"}, {"sha": "e215280b09f36ff240bf997afc70167534076ea1", "filename": "config/bootstrap-debug-lean.mk", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e12c40944905e48a1830861c63e6e39ae67eb8b0/config%2Fbootstrap-debug-lean.mk", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e12c40944905e48a1830861c63e6e39ae67eb8b0/config%2Fbootstrap-debug-lean.mk", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/config%2Fbootstrap-debug-lean.mk?ref=e12c40944905e48a1830861c63e6e39ae67eb8b0", "patch": "@@ -1,11 +1,11 @@\n-# This BUILD_CONFIG option is a bit like bootstrap-debug, but in\n-# addition to comparing stripped object files, it also compares\n-# compiler internal state during stage3.\n+# This BUILD_CONFIG option is a bit like bootstrap-debug, but rather\n+# than comparing stripped object files, it compares compiler internal\n+# state during stage3.  Both can be used simultaneously.\n \n-# This makes it slower than bootstrap-debug, for there's additional\n-# dumping and recompilation during stage3.  bootstrap-debug-big can\n-# avoid the recompilation, if plenty of disk space is available.\n+# This makes it slower than bootstrap-debug alone, for there's\n+# additional dumping and recompilation during stage3.\n+# bootstrap-debug-big can avoid the recompilation, if plenty of disk\n+# space is available.\n \n-STAGE2_CFLAGS += -gtoggle -fcompare-debug=\n+STAGE2_CFLAGS += -fcompare-debug=\n STAGE3_CFLAGS += -fcompare-debug\n-do-compare = $(SHELL) $(srcdir)/contrib/compare-debug $$f1 $$f2"}, {"sha": "c8f2fcf15161c5b4916db4fc6ac7b275736089da", "filename": "configure", "status": "modified", "additions": 33, "deletions": 3, "changes": 36, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e12c40944905e48a1830861c63e6e39ae67eb8b0/configure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e12c40944905e48a1830861c63e6e39ae67eb8b0/configure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/configure?ref=e12c40944905e48a1830861c63e6e39ae67eb8b0", "patch": "@@ -631,6 +631,7 @@ build_tooldir\n tooldir\n GCC_SHLIB_SUBDIR\n RPATH_ENVVAR\n+BUILD_CONFIG\n CXXFLAGS_FOR_TARGET\n CFLAGS_FOR_TARGET\n DEBUG_PREFIX_CFLAGS_FOR_TARGET\n@@ -6569,13 +6570,42 @@ $as_echo \"$as_me: WARNING: trying to bootstrap a cross compiler\" >&2;}\n esac\n \n # Adjust the toplevel makefile according to whether bootstrap was selected.\n-case \"$enable_bootstrap\" in\n+case $enable_bootstrap in\n   yes)\n-    bootstrap_suffix=bootstrap ;;\n+    bootstrap_suffix=bootstrap\n+    BUILD_CONFIG=bootstrap-debug\n+    ;;\n   no)\n-    bootstrap_suffix=no-bootstrap ;;\n+    bootstrap_suffix=no-bootstrap\n+    BUILD_CONFIG=\n+    ;;\n esac\n \n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: checking for default BUILD_CONFIG\" >&5\n+$as_echo_n \"checking for default BUILD_CONFIG... \" >&6; }\n+if test \"x${with_build_config}\" != x; then\n+  BUILD_CONFIG=$with_build_config\n+else\n+  case $BUILD_CONFIG in\n+  bootstrap-debug)\n+    if echo \"int f (void) { return 0; }\" > conftest.c &&\n+       ${CC} -c conftest.c &&\n+       mv conftest.o conftest.o.g0 &&\n+       ${CC} -c -g conftest.c &&\n+       mv conftest.o conftest.o.g &&\n+       ${srcdir}/contrib/compare-debug conftest.o.g0 conftest.o.g; then\n+      :\n+    else\n+      BUILD_CONFIG=\n+    fi\n+    rm -f conftest.c conftest.o conftest.o.g0 conftest.o.g\n+    ;;\n+  esac\n+fi\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $BUILD_CONFIG\" >&5\n+$as_echo \"$BUILD_CONFIG\" >&6; }\n+\n+\n for module in ${build_configdirs} ; do\n   if test -z \"${no_recursion}\" \\\n      && test -f ${build_subdir}/${module}/Makefile; then"}, {"sha": "caff7e5af132c96af4413b19b7231fc5a385b6cd", "filename": "configure.ac", "status": "modified", "additions": 30, "deletions": 3, "changes": 33, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e12c40944905e48a1830861c63e6e39ae67eb8b0/configure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e12c40944905e48a1830861c63e6e39ae67eb8b0/configure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/configure.ac?ref=e12c40944905e48a1830861c63e6e39ae67eb8b0", "patch": "@@ -2459,13 +2459,40 @@ case \"$have_compiler:$host:$target:$enable_bootstrap\" in\n esac\n \n # Adjust the toplevel makefile according to whether bootstrap was selected.\n-case \"$enable_bootstrap\" in\n+case $enable_bootstrap in\n   yes)\n-    bootstrap_suffix=bootstrap ;;\n+    bootstrap_suffix=bootstrap\n+    BUILD_CONFIG=bootstrap-debug\n+    ;;\n   no)\n-    bootstrap_suffix=no-bootstrap ;;\n+    bootstrap_suffix=no-bootstrap\n+    BUILD_CONFIG=\n+    ;;\n esac\n \n+AC_MSG_CHECKING(for default BUILD_CONFIG)\n+if test \"x${with_build_config}\" != x; then\n+  BUILD_CONFIG=$with_build_config\n+else\n+  case $BUILD_CONFIG in\n+  bootstrap-debug)\n+    if echo \"int f (void) { return 0; }\" > conftest.c &&\n+       ${CC} -c conftest.c &&\n+       mv conftest.o conftest.o.g0 &&\n+       ${CC} -c -g conftest.c &&\n+       mv conftest.o conftest.o.g &&\n+       ${srcdir}/contrib/compare-debug conftest.o.g0 conftest.o.g; then\n+      :\n+    else\n+      BUILD_CONFIG=\n+    fi\n+    rm -f conftest.c conftest.o conftest.o.g0 conftest.o.g\n+    ;;\n+  esac\n+fi\n+AC_MSG_RESULT($BUILD_CONFIG)\n+AC_SUBST(BUILD_CONFIG)\n+\n for module in ${build_configdirs} ; do\n   if test -z \"${no_recursion}\" \\\n      && test -f ${build_subdir}/${module}/Makefile; then"}, {"sha": "d15084e0bbfa00c406ae83c155f1c946ebe2bfdf", "filename": "contrib/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e12c40944905e48a1830861c63e6e39ae67eb8b0/contrib%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e12c40944905e48a1830861c63e6e39ae67eb8b0/contrib%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2FChangeLog?ref=e12c40944905e48a1830861c63e6e39ae67eb8b0", "patch": "@@ -1,3 +1,10 @@\n+2009-09-03  Alexandre Oliva  <aoliva@redhat.com>\n+\n+\t* bootstrap-debug-big.mk (STAGE2_CFLAGS): Drop -gtoggle.\n+\t* bootstrap-debug-lean.mk: Update comments.\n+\t(STAGE2_CFLAGS): Likewise.\n+\t(do-compare): Don't override.\n+\n 2009-09-01  Alexandre Oliva  <aoliva@redhat.com>\n \n \t* compare-debug: Look for .gkd files and compare them."}, {"sha": "fef23a8e251ba873dca4fd9a6282337277812d1f", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e12c40944905e48a1830861c63e6e39ae67eb8b0/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e12c40944905e48a1830861c63e6e39ae67eb8b0/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=e12c40944905e48a1830861c63e6e39ae67eb8b0", "patch": "@@ -1,3 +1,10 @@\n+2009-09-03  Alexandre Oliva  <aoliva@redhat.com>\n+\n+\t* doc/invoke.texi (BUILD_CONFIG): Document --with-build-config.\n+\t(bootstrap-debug): Explain conditions in which it becomes default.\n+\t(bootstrap-debug-big): Rather than duplicate bootstrap-debug,\n+\tmake it add to it.\n+\n 2009-09-03  Namhyung Kim  <namhyung@gmail.com>\n \n \t* doc/invoke.texi (Optimize Options): Move"}, {"sha": "e0098bc156aceb41795bbf38d7e59b042e600f3f", "filename": "gcc/doc/install.texi", "status": "modified", "additions": 18, "deletions": 13, "changes": 31, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e12c40944905e48a1830861c63e6e39ae67eb8b0/gcc%2Fdoc%2Finstall.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e12c40944905e48a1830861c63e6e39ae67eb8b0/gcc%2Fdoc%2Finstall.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdoc%2Finstall.texi?ref=e12c40944905e48a1830861c63e6e39ae67eb8b0", "patch": "@@ -2080,11 +2080,13 @@ the one you are building on: for example, you could build a\n @code{powerpc64-unknown-linux-gnu} host.  In this case, pass\n @option{--enable-bootstrap} to the configure script.\n \n-@code{BUILD_CONFIG} can be used to bring in additional customization to\n-the build.  It can be set to a whitespace-separated list of names.  For\n-each such @code{NAME}, top-level @file{config/@code{NAME}.mk} will be\n-included by the top-level @file{Makefile}, bringing in any settings it\n-contains.  Some examples are:\n+@code{BUILD_CONFIG} can be used to bring in additional customization\n+to the build.  It can be set to a whitespace-separated list of names.\n+For each such @code{NAME}, top-level @file{config/@code{NAME}.mk} will\n+be included by the top-level @file{Makefile}, bringing in any settings\n+it contains.  The default @code{BUILD_CONFIG} can be set using the\n+configure option @option{--with-build-config=@code{NAME}...}.  Some\n+examples of supported build configurations are:\n \n @table @asis\n @item @samp{bootstrap-O1}\n@@ -2097,19 +2099,22 @@ Analogous to @code{bootstrap-O1}.\n \n @item @samp{bootstrap-debug}\n Verifies that the compiler generates the same executable code, whether\n-or not it is asked to emit debug information.  To this end, this option\n-builds stage2 host programs without debug information, and uses\n+or not it is asked to emit debug information.  To this end, this\n+option builds stage2 host programs without debug information, and uses\n @file{contrib/compare-debug} to compare them with the stripped stage3\n object files.  If @code{BOOT_CFLAGS} is overridden so as to not enable\n debug information, stage2 will have it, and stage3 won't.  This option\n-is enabled by default when GCC bootstrapping is enabled: in addition to\n-better test coverage, it makes default bootstraps faster and leaner.\n+is enabled by default when GCC bootstrapping is enabled, if\n+@code{strip} can turn object files compiled with and without debug\n+info into identical object files.  In addition to better test\n+coverage, this option makes default bootstraps faster and leaner.\n \n @item @samp{bootstrap-debug-big}\n-In addition to the checking performed by @code{bootstrap-debug}, this\n-option saves internal compiler dumps during stage2 and stage3 and\n-compares them as well, which helps catch additional potential problems,\n-but at a great cost in terms of disk space.\n+Rather than comparing stripped object files, as in\n+@code{bootstrap-debug}, this option saves internal compiler dumps\n+during stage2 and stage3 and compares them as well, which helps catch\n+additional potential problems, but at a great cost in terms of disk\n+space.  It can be specified in addition to @samp{bootstrap-debug}.\n \n @item @samp{bootstrap-debug-lean}\n This option saves disk space compared with @code{bootstrap-debug-big},"}]}