{"sha": "ca178f85a63290092282309bc58d624379f749b9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Y2ExNzhmODVhNjMyOTAwOTIyODIzMDliYzU4ZDYyNDM3OWY3NDliOQ==", "commit": {"author": {"name": "Bruce Korb", "email": "bkorb@gnu.org", "date": "2007-04-07T17:55:07Z"}, "committer": {"name": "Bruce Korb", "email": "korbb@gcc.gnu.org", "date": "2007-04-07T17:55:07Z"}, "message": "Separate NUL byte detection from rest of -Wformat warnings\n\nFrom-SVN: r123640", "tree": {"sha": "19dc2cc7322d36f6899efcd2e24c938b87f989ee", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/19dc2cc7322d36f6899efcd2e24c938b87f989ee"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ca178f85a63290092282309bc58d624379f749b9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ca178f85a63290092282309bc58d624379f749b9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ca178f85a63290092282309bc58d624379f749b9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ca178f85a63290092282309bc58d624379f749b9/comments", "author": {"login": "brkorb", "id": 1242936, "node_id": "MDQ6VXNlcjEyNDI5MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/1242936?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brkorb", "html_url": "https://github.com/brkorb", "followers_url": "https://api.github.com/users/brkorb/followers", "following_url": "https://api.github.com/users/brkorb/following{/other_user}", "gists_url": "https://api.github.com/users/brkorb/gists{/gist_id}", "starred_url": "https://api.github.com/users/brkorb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brkorb/subscriptions", "organizations_url": "https://api.github.com/users/brkorb/orgs", "repos_url": "https://api.github.com/users/brkorb/repos", "events_url": "https://api.github.com/users/brkorb/events{/privacy}", "received_events_url": "https://api.github.com/users/brkorb/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "594dc04813751aa479a77f866f2bd179fba03730", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/594dc04813751aa479a77f866f2bd179fba03730", "html_url": "https://github.com/Rust-GCC/gccrs/commit/594dc04813751aa479a77f866f2bd179fba03730"}], "stats": {"total": 60, "additions": 59, "deletions": 1}, "files": [{"sha": "b422096c176cf7ad86d2f851a302b2c949734315", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ca178f85a63290092282309bc58d624379f749b9/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ca178f85a63290092282309bc58d624379f749b9/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=ca178f85a63290092282309bc58d624379f749b9", "patch": "@@ -1,3 +1,11 @@\n+2007-04-07  Bruce Korb  <bkorb@gnu.org>\n+\n+\t* c.opt: Add -Wformat-contains-nul.\n+\t* c-format.c (set_Wformat):  Set warn_format_contains_nul to the\n+\t  -Wformat setting.\n+\t(check_format_info_main): Check OPT_Wformat_contains_nul before emitting\n+\tthe NUL byte warning.\n+\n 2007-04-07  H.J. Lu  <hongjiu.lu@intel.com>\n \n \t* config/i386/i386.c (ix86_handle_option): Handle SSSE3."}, {"sha": "a64e30984eec631f73c703b4a68645deb50ea965", "filename": "gcc/c-format.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ca178f85a63290092282309bc58d624379f749b9/gcc%2Fc-format.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ca178f85a63290092282309bc58d624379f749b9/gcc%2Fc-format.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-format.c?ref=ca178f85a63290092282309bc58d624379f749b9", "patch": "@@ -40,6 +40,7 @@ set_Wformat (int setting)\n   warn_format = setting;\n   warn_format_extra_args = setting;\n   warn_format_zero_length = setting;\n+  warn_format_contains_nul = setting;\n   if (setting != 1)\n     {\n       warn_format_nonliteral = setting;\n@@ -1482,7 +1483,7 @@ check_format_info_main (format_check_results *res,\n       if (*format_chars == 0)\n \t{\n \t  if (format_chars - orig_format_chars != format_length)\n-\t    warning (OPT_Wformat, \"embedded %<\\\\0%> in format\");\n+\t    warning (OPT_Wformat_contains_nul, \"embedded %<\\\\0%> in format\");\n \t  if (info->first_arg_num != 0 && params != 0\n \t      && has_operand_number <= 0)\n \t    {"}, {"sha": "2130c7d7e7509a26b0d8db7dbb2bd6ce4379d8db", "filename": "gcc/c-opts.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ca178f85a63290092282309bc58d624379f749b9/gcc%2Fc-opts.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ca178f85a63290092282309bc58d624379f749b9/gcc%2Fc-opts.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-opts.c?ref=ca178f85a63290092282309bc58d624379f749b9", "patch": "@@ -1106,6 +1106,8 @@ c_common_post_options (const char **pfilename)\n \t       \"-Wformat-zero-length ignored without -Wformat\");\n       warning (OPT_Wformat_nonliteral,\n \t       \"-Wformat-nonliteral ignored without -Wformat\");\n+      warning (OPT_Wformat_contains_nul,\n+\t       \"-Wformat-contains-nul ignored without -Wformat\");\n       warning (OPT_Wformat_security,\n \t       \"-Wformat-security ignored without -Wformat\");\n     }"}, {"sha": "9af480355b150e18387814e3fdf4c8c1d706a362", "filename": "gcc/c.opt", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ca178f85a63290092282309bc58d624379f749b9/gcc%2Fc.opt", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ca178f85a63290092282309bc58d624379f749b9/gcc%2Fc.opt", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc.opt?ref=ca178f85a63290092282309bc58d624379f749b9", "patch": "@@ -216,6 +216,10 @@ Wformat-nonliteral\n C ObjC C++ ObjC++ Var(warn_format_nonliteral) Warning\n Warn about format strings that are not literals\n \n+Wformat-contains-nul\n+C ObjC C++ ObjC++ Var(warn_format_contains_nul)\n+Warn about format strings that contain NUL bytes\n+\n Wformat-security\n C ObjC C++ ObjC++ Var(warn_format_security) Warning\n Warn about possible security problems with format functions"}, {"sha": "2d2bbc02cbb43218d6ffe252df19981b056907ca", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ca178f85a63290092282309bc58d624379f749b9/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ca178f85a63290092282309bc58d624379f749b9/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=ca178f85a63290092282309bc58d624379f749b9", "patch": "@@ -1,3 +1,9 @@\n+2007-04-07  Bruce Korb  <bkorb@gnu.org>\n+\n+\t* gcc.dg/format/opt-6.c: New test.\n+\t* gcc.dg/format/nul-1.c: New test.\n+\t* gcc.dg/format/nul-2.c: New test.\n+\n 2007-04-06  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n \n \tPR libgfortran/31395"}, {"sha": "c45453dba0735124a949cc463ddba57561795737", "filename": "gcc/testsuite/gcc.dg/format/nul-1.c", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ca178f85a63290092282309bc58d624379f749b9/gcc%2Ftestsuite%2Fgcc.dg%2Fformat%2Fnul-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ca178f85a63290092282309bc58d624379f749b9/gcc%2Ftestsuite%2Fgcc.dg%2Fformat%2Fnul-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fformat%2Fnul-1.c?ref=ca178f85a63290092282309bc58d624379f749b9", "patch": "@@ -0,0 +1,14 @@\n+/* Test diagnostics for suppressing contains nul\n+   -Wformat.  -Wformat.  */\n+/* Origin: Bruce Korb <bkorb@gnu.org> */\n+/* { dg-do compile } */\n+/* { dg-options \"-Wformat -Wno-format-contains-nul\" } */\n+\n+#include \"format.h\"\n+\n+void\n+foo (void)\n+{\n+  static char const fmt[] = \"x%s\\0%s\\n\\0abc\";\n+  printf (fmt+4, fmt+8); /* { dg-bogus \"embedded.*in format\" \"bogus embed warning\" } */\n+}"}, {"sha": "da69f0b9e989fd79137d5e2f45d517ec6a1f6e78", "filename": "gcc/testsuite/gcc.dg/format/nul-2.c", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ca178f85a63290092282309bc58d624379f749b9/gcc%2Ftestsuite%2Fgcc.dg%2Fformat%2Fnul-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ca178f85a63290092282309bc58d624379f749b9/gcc%2Ftestsuite%2Fgcc.dg%2Fformat%2Fnul-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fformat%2Fnul-2.c?ref=ca178f85a63290092282309bc58d624379f749b9", "patch": "@@ -0,0 +1,16 @@\n+/* Test diagnostics for options used on their own without\n+   -Wformat.  -Wformat-.  */\n+/* Origin: Bruce Korb <bkorb@gnu.org> */\n+/* { dg-do compile } */\n+/* { dg-options \"-Wformat\" } */\n+\n+/* { dg-warning \"warning: embedded .* in format\" \"ignored\" { target *-*-* } 0 } */\n+\n+#include \"format.h\"\n+\n+void\n+fumble (void)\n+{\n+  static char const fmt[] = \"x%s\\0%s\\n\\0abc\";\n+  printf (fmt+4, fmt+8);\n+}"}, {"sha": "75a5da2c2ceaaea7773ba571980b4e3540627b30", "filename": "gcc/testsuite/gcc.dg/format/opt-6.c", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ca178f85a63290092282309bc58d624379f749b9/gcc%2Ftestsuite%2Fgcc.dg%2Fformat%2Fopt-6.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ca178f85a63290092282309bc58d624379f749b9/gcc%2Ftestsuite%2Fgcc.dg%2Fformat%2Fopt-6.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fformat%2Fopt-6.c?ref=ca178f85a63290092282309bc58d624379f749b9", "patch": "@@ -0,0 +1,7 @@\n+/* Test diagnostics for options used on their own without\n+   -Wformat.  -Wformat-contains-nul.  */\n+/* Origin: Bruce Korb <bkorb@gnu.org> */\n+/* { dg-do compile } */\n+/* { dg-options \"-Wformat-contains-nul\" } */\n+\n+/* { dg-warning \"warning: -Wformat-contains-nul ignored without -Wformat\" \"ignored\" { target *-*-* } 0 } */"}]}