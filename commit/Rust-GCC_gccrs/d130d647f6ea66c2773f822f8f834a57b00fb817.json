{"sha": "d130d647f6ea66c2773f822f8f834a57b00fb817", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDEzMGQ2NDdmNmVhNjZjMjc3M2Y4MjJmOGY4MzRhNTdiMDBmYjgxNw==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2009-03-18T17:06:15Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2009-03-18T17:06:15Z"}, "message": "re PR debug/39485 (-O0 -g still puts whole object to a register)\n\n\tPR debug/39485\n\t* function.c (use_register_for_decl): When not optimizing, disregard\n\tregister keyword for variables with types containing methods.\n\nFrom-SVN: r144939", "tree": {"sha": "d085647e97b62f96314401a16b2427b7029080a5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d085647e97b62f96314401a16b2427b7029080a5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d130d647f6ea66c2773f822f8f834a57b00fb817", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d130d647f6ea66c2773f822f8f834a57b00fb817", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d130d647f6ea66c2773f822f8f834a57b00fb817", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d130d647f6ea66c2773f822f8f834a57b00fb817/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "8f5929e11fa965fd2ad5d63c55de1cebc1b06af3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8f5929e11fa965fd2ad5d63c55de1cebc1b06af3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8f5929e11fa965fd2ad5d63c55de1cebc1b06af3"}], "stats": {"total": 27, "additions": 26, "deletions": 1}, "files": [{"sha": "a13d05e75882bc7fb1ff28763a9408b6ab2625d3", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d130d647f6ea66c2773f822f8f834a57b00fb817/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d130d647f6ea66c2773f822f8f834a57b00fb817/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=d130d647f6ea66c2773f822f8f834a57b00fb817", "patch": "@@ -12,6 +12,10 @@\n \t* function.c (struct temp_slot): Likewise.\n \t* cfgloop.h (struct loop): Likewise.\n \n+\tPR debug/39485\n+\t* function.c (use_register_for_decl): When not optimizing, disregard\n+\tregister keyword for variables with types containing methods.\n+\n 2009-03-18  Sebastian Pop  <sebastian.pop@amd.com>\n \n \tPR middle-end/39447"}, {"sha": "e8d99015e4d78155c6b90b1d5dff795703efa073", "filename": "gcc/function.c", "status": "modified", "additions": 22, "deletions": 1, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d130d647f6ea66c2773f822f8f834a57b00fb817/gcc%2Ffunction.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d130d647f6ea66c2773f822f8f834a57b00fb817/gcc%2Ffunction.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffunction.c?ref=d130d647f6ea66c2773f822f8f834a57b00fb817", "patch": "@@ -1942,7 +1942,28 @@ use_register_for_decl (const_tree decl)\n   if (DECL_IGNORED_P (decl))\n     return true;\n \n-  return (optimize || DECL_REGISTER (decl));\n+  if (optimize)\n+    return true;\n+\n+  if (!DECL_REGISTER (decl))\n+    return false;\n+\n+  switch (TREE_CODE (TREE_TYPE (decl)))\n+    {\n+    case RECORD_TYPE:\n+    case UNION_TYPE:\n+    case QUAL_UNION_TYPE:\n+      /* When not optimizing, disregard register keyword for variables with\n+\t types containing methods, otherwise the methods won't be callable\n+\t from the debugger.  */\n+      if (TYPE_METHODS (TREE_TYPE (decl)))\n+\treturn false;\n+      break;\n+    default:\n+      break;\n+    }\n+\n+  return true;\n }\n \n /* Return true if TYPE should be passed by invisible reference.  */"}]}