{"sha": "aee6ed4a2cbed1ac8be35332ee2391206e2101a2", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWVlNmVkNGEyY2JlZDFhYzhiZTM1MzMyZWUyMzkxMjA2ZTIxMDFhMg==", "commit": {"author": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2019-01-18T03:29:38Z"}, "committer": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2019-01-18T03:29:38Z"}, "message": "re PR go/88202 (FAIL: runtime/pprof)\n\n\tPR go/88202\n    runtime: in sigprof, skip to sigtrampgo if we don't find sigtramp\n    \n    Fixes https://gcc.gnu.org/PR88202\n    \n    Reviewed-on: https://go-review.googlesource.com/c/158218\n\nFrom-SVN: r268057", "tree": {"sha": "e50bdbe4203778fb88f8247d303ef2c3bcb04c3d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e50bdbe4203778fb88f8247d303ef2c3bcb04c3d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/aee6ed4a2cbed1ac8be35332ee2391206e2101a2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/aee6ed4a2cbed1ac8be35332ee2391206e2101a2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/aee6ed4a2cbed1ac8be35332ee2391206e2101a2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/aee6ed4a2cbed1ac8be35332ee2391206e2101a2/comments", "author": null, "committer": null, "parents": [{"sha": "151a199f292c8978bf3d5d2123e65af224ed45c2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/151a199f292c8978bf3d5d2123e65af224ed45c2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/151a199f292c8978bf3d5d2123e65af224ed45c2"}], "stats": {"total": 13, "additions": 10, "deletions": 3}, "files": [{"sha": "99ec5ccfb6ba153dfc17c49de6ecb3caca68f5d5", "filename": "gcc/go/gofrontend/MERGE", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aee6ed4a2cbed1ac8be35332ee2391206e2101a2/gcc%2Fgo%2Fgofrontend%2FMERGE", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aee6ed4a2cbed1ac8be35332ee2391206e2101a2/gcc%2Fgo%2Fgofrontend%2FMERGE", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgo%2Fgofrontend%2FMERGE?ref=aee6ed4a2cbed1ac8be35332ee2391206e2101a2", "patch": "@@ -1,4 +1,4 @@\n-d6576c83016d856217758c06d945bfc363ffb817\n+d16e9181a760796802c067730bb030b92b63fb2c\n \n The first line of this file holds the git revision number of the last\n merge done from the gofrontend repository."}, {"sha": "80b04ab4a5de3d59b26c4ce4b773eee717465c6e", "filename": "libgo/go/runtime/proc.go", "status": "modified", "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aee6ed4a2cbed1ac8be35332ee2391206e2101a2/libgo%2Fgo%2Fruntime%2Fproc.go", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aee6ed4a2cbed1ac8be35332ee2391206e2101a2/libgo%2Fgo%2Fruntime%2Fproc.go", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgo%2Fgo%2Fruntime%2Fproc.go?ref=aee6ed4a2cbed1ac8be35332ee2391206e2101a2", "patch": "@@ -3600,10 +3600,17 @@ func sigprof(pc uintptr, gp *g, mp *m) {\n \t\t// To ensure a sane profile, walk through the frames in\n \t\t// \"stklocs\" until we find the \"runtime.sigtramp\" frame, then\n \t\t// report only those frames below the frame one down from\n-\t\t// that. If for some reason \"runtime.sigtramp\" is not present,\n-\t\t// don't make any changes.\n+\t\t// that. On systems that don't split stack, \"sigtramp\" can\n+\t\t// do a sibling call to \"sigtrampgo\", so use \"sigtrampgo\"\n+\t\t// if we don't find \"sigtramp\". If for some reason\n+\t\t// neither \"runtime.sigtramp\" nor \"runtime.sigtrampgo\" is\n+\t\t// present, don't make any changes.\n \t\tframesToDiscard := 0\n \t\tfor i := 0; i < n; i++ {\n+\t\t\tif stklocs[i].function == \"runtime.sigtrampgo\" && i+2 < n {\n+\t\t\t\tframesToDiscard = i + 2\n+\t\t\t\tn -= framesToDiscard\n+\t\t\t}\n \t\t\tif stklocs[i].function == \"runtime.sigtramp\" && i+2 < n {\n \t\t\t\tframesToDiscard = i + 2\n \t\t\t\tn -= framesToDiscard"}]}