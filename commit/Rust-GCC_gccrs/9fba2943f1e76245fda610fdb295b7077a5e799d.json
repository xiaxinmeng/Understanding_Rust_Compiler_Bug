{"sha": "9fba2943f1e76245fda610fdb295b7077a5e799d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWZiYTI5NDNmMWU3NjI0NWZkYTYxMGZkYjI5NWI3MDc3YTVlNzk5ZA==", "commit": {"author": {"name": "Tom de Vries", "email": "tom@codesourcery.com", "date": "2017-08-06T09:56:38Z"}, "committer": {"name": "Tom de Vries", "email": "vries@gcc.gnu.org", "date": "2017-08-06T09:56:38Z"}, "message": "Add missing edge probabilities in expand_oacc_for, tile case\n\n ;;   basic block 11, loop depth 2, freq 0, maybe hot\n ;;    prev block 22, next block 23, flags: (NEW, REACHABLE)\n ;;    pred:       22 (TRUE_VALUE)\n ;;                24 (TRUE_VALUE)\n   ...\n   if (.e_offset.15D.1971 < .e_bound.14D.1972)\n-    goto <bb 23>; [100.00%] [count: INV]\n+    goto <bb 23>; [80.01%] [count: INV]\n   else\n-    goto <bb 24>; [INV] [count: INV]\n+    goto <bb 24>; [19.99%] [count: INV]\n\n ;;   basic block 23, loop depth 3, freq 0, maybe hot\n ;;    prev block 11, next block 24, flags: (NEW)\n ;;    pred:       11 [always]  (TRUE_VALUE)\n ;;                23 (TRUE_VALUE)\n   ixD.1974 = .outer.4D.1967 + .e_offset.15D.1971;\n   .e_offset.15D.1971 = .e_offset.15D.1971 + .e_step.16D.1973;\n   if (.e_offset.15D.1971 < .e_bound.14D.1972)\n-    goto <bb 23>; [INV] [count: INV]\n+    goto <bb 23>; [80.01%] [count: INV]\n   else\n-    goto <bb 24>; [100.00%] [count: INV]\n+    goto <bb 24>; [19.99%] [count: INV]\n\n2017-08-06  Tom de Vries  <tom@codesourcery.com>\n\n\t* omp-expand.c (expand_oacc_for): Add missing edge probability for tile\n\tand element loops.\n\nFrom-SVN: r250900", "tree": {"sha": "21822ae9d31791c9ddd50d2f615df7e540518ee7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/21822ae9d31791c9ddd50d2f615df7e540518ee7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9fba2943f1e76245fda610fdb295b7077a5e799d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9fba2943f1e76245fda610fdb295b7077a5e799d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9fba2943f1e76245fda610fdb295b7077a5e799d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9fba2943f1e76245fda610fdb295b7077a5e799d/comments", "author": null, "committer": null, "parents": [{"sha": "f38057cc118cca4a97eac5c3c5c7c15bee024799", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f38057cc118cca4a97eac5c3c5c7c15bee024799", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f38057cc118cca4a97eac5c3c5c7c15bee024799"}], "stats": {"total": 16, "additions": 14, "deletions": 2}, "files": [{"sha": "51ed7c9916231b39522bc6f07b9d2db86d911e2f", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9fba2943f1e76245fda610fdb295b7077a5e799d/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9fba2943f1e76245fda610fdb295b7077a5e799d/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=9fba2943f1e76245fda610fdb295b7077a5e799d", "patch": "@@ -1,3 +1,8 @@\n+2017-08-06  Tom de Vries  <tom@codesourcery.com>\n+\n+\t* omp-expand.c (expand_oacc_for): Add missing edge probability for tile\n+\tand element loops.\n+\n 2017-08-06  Tom de Vries  <tom@codesourcery.com>\n \n \t* omp-expand.c (expand_oacc_for): Add missing edge probability for chunk"}, {"sha": "0a0098af6695219ca15251aa22cdc9469a8e5459", "filename": "gcc/omp-expand.c", "status": "modified", "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9fba2943f1e76245fda610fdb295b7077a5e799d/gcc%2Fomp-expand.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9fba2943f1e76245fda610fdb295b7077a5e799d/gcc%2Fomp-expand.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fomp-expand.c?ref=9fba2943f1e76245fda610fdb295b7077a5e799d", "patch": "@@ -5663,9 +5663,16 @@ expand_oacc_for (struct omp_region *region, struct omp_for_data *fd)\n \t  cont_bb = split->dest;\n \n \t  split->flags ^= EDGE_FALLTHRU | EDGE_FALSE_VALUE;\n-\t  make_edge (elem_cont_bb, elem_body_bb, EDGE_TRUE_VALUE);\n+\t  split->probability = profile_probability::unlikely ().guessed ();\n+\t  edge latch_edge\n+\t    = make_edge (elem_cont_bb, elem_body_bb, EDGE_TRUE_VALUE);\n+\t  latch_edge->probability = profile_probability::likely ().guessed ();\n \n-\t  make_edge (body_bb, cont_bb, EDGE_FALSE_VALUE);\n+\t  edge skip_edge = make_edge (body_bb, cont_bb, EDGE_FALSE_VALUE);\n+\t  skip_edge->probability = profile_probability::unlikely ().guessed ();\n+\t  edge loop_entry_edge = EDGE_SUCC (body_bb, 1 - skip_edge->dest_idx);\n+\t  loop_entry_edge->probability\n+\t    = profile_probability::likely ().guessed ();\n \n \t  gsi = gsi_for_stmt (cont_stmt);\n \t}"}]}