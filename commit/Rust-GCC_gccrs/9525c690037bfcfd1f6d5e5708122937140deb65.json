{"sha": "9525c690037bfcfd1f6d5e5708122937140deb65", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTUyNWM2OTAwMzdiZmNmZDFmNmQ1ZTU3MDgxMjI5MzcxNDBkZWI2NQ==", "commit": {"author": {"name": "Jim Wilson", "email": "wilson@cygnus.com", "date": "2000-03-15T19:35:26Z"}, "committer": {"name": "Jim Wilson", "email": "wilson@gcc.gnu.org", "date": "2000-03-15T19:35:26Z"}, "message": "Patches to make libobjc build.\n\n\t* config/ia64/ia64.md (restore_stack_nonlocal): New.\n\t* config/ia64/lib1funcs.asm (__ia64_nonlocal_goto): Delete padding nop.\n\t(__ia64_restore_stack_nonlocal): New.\n\t* config/ia64/t-ia64 (LIB1ASMFUNCS): Add __restore_stack_nonlocal.\n\nFrom-SVN: r32564", "tree": {"sha": "724ea7938f70c67f312a420cb085d65d50ee1e36", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/724ea7938f70c67f312a420cb085d65d50ee1e36"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9525c690037bfcfd1f6d5e5708122937140deb65", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9525c690037bfcfd1f6d5e5708122937140deb65", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9525c690037bfcfd1f6d5e5708122937140deb65", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9525c690037bfcfd1f6d5e5708122937140deb65/comments", "author": null, "committer": null, "parents": [{"sha": "1690826f332db8489e14f8c95bf0aef4e09acef8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1690826f332db8489e14f8c95bf0aef4e09acef8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1690826f332db8489e14f8c95bf0aef4e09acef8"}], "stats": {"total": 72, "additions": 66, "deletions": 6}, "files": [{"sha": "47287d795cc520772a8d58f588f03442f97ecc95", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9525c690037bfcfd1f6d5e5708122937140deb65/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9525c690037bfcfd1f6d5e5708122937140deb65/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=9525c690037bfcfd1f6d5e5708122937140deb65", "patch": "@@ -1,3 +1,10 @@\n+Wed Mar 15 11:34:27 2000  Jim Wilson  <wilson@cygnus.com>\n+\n+\t* config/ia64/ia64.md (restore_stack_nonlocal): New.\n+\t* config/ia64/lib1funcs.asm (__ia64_nonlocal_goto): Delete padding nop.\n+\t(__ia64_restore_stack_nonlocal): New.\n+\t* config/ia64/t-ia64 (LIB1ASMFUNCS): Add __restore_stack_nonlocal.\n+\n 2000-03-15  Alexandre Oliva  <oliva@lsd.ic.unicamp.br>\n \n \t* cpphash.c (collect_formal_parameters): Do not complain about"}, {"sha": "877948911dfb9450eb9804626b78fe46af43a9e8", "filename": "gcc/config/ia64/ia64.md", "status": "modified", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9525c690037bfcfd1f6d5e5708122937140deb65/gcc%2Fconfig%2Fia64%2Fia64.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9525c690037bfcfd1f6d5e5708122937140deb65/gcc%2Fconfig%2Fia64%2Fia64.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fia64%2Fia64.md?ref=9525c690037bfcfd1f6d5e5708122937140deb65", "patch": "@@ -3173,6 +3173,24 @@\n   \"\"\n   \"fc %0\\;;;\\;adds %0=31,%0\\;;;\\;fc %0\\;;;\\;sync.i\\;srlz.i\"\n   [(set_attr \"type\" \"unknown\")])\n+\f\n+;; Builtin apply support.\n+\n+(define_expand \"restore_stack_nonlocal\"\n+  [(use (match_operand:DI 0 \"register_operand\" \"\"))\n+   (use (match_operand:OI 1 \"memory_operand\" \"\"))]\n+  \"\"\n+  \"\n+{\n+  emit_library_call (gen_rtx_SYMBOL_REF (Pmode,\n+\t\t\t\t\t \\\"__ia64_restore_stack_nonlocal\\\"),\n+\t\t     0, VOIDmode, 1,\n+\t\t     copy_to_reg (XEXP (operands[1], 0)), Pmode);\n+  DONE;\n+}\")\n+\n+\f\n+;;; Intrinsics support.\n \n (define_insn \"ccv_restore_si\"\n   [(unspec [(const_int 0)] 11)"}, {"sha": "c69eda286c82c329e7153507dd23673b45caab6e", "filename": "gcc/config/ia64/lib1funcs.asm", "status": "modified", "additions": 40, "deletions": 5, "changes": 45, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9525c690037bfcfd1f6d5e5708122937140deb65/gcc%2Fconfig%2Fia64%2Flib1funcs.asm", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9525c690037bfcfd1f6d5e5708122937140deb65/gcc%2Fconfig%2Fia64%2Flib1funcs.asm", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fia64%2Flib1funcs.asm?ref=9525c690037bfcfd1f6d5e5708122937140deb65", "patch": "@@ -602,11 +602,6 @@ __ia64_nonlocal_goto:\n \tadds r2=8,in2\n \tld8 r12=[in2],16\n \tmov.ret.sptk.few.dc.dc rp = r33, .L0\n-// ??? flushrs must be first instruction of a group.  Gas is unfortunately\n-// putting the stop bit before the padding nop instead of after it, making\n-// flushrs the first instruction of its bundle, but the second instruction\n-// of its group.  We explicitly add the nop to avoid this problem.\n-\tnop.i 0\n \t;;\n \tflushrs\n \tld8 r16=[r2],16\n@@ -633,3 +628,43 @@ __ia64_nonlocal_goto:\n \t;;\n \t.endp __ia64_nonlocal_goto\n #endif\n+\n+#ifdef L__restore_stack_nonlocal\n+// This is mostly the same as nonlocal_goto above.\n+// ??? This has not been tested yet.\n+\n+// void __ia64_restore_stack_nonlocal(void *save_area)\n+\n+\t.text\n+\t.align 16\n+\t.global __ia64_restore_stack_nonlocal\n+\t.proc __ia64_restore_stack_nonlocal\n+__ia64_restore_stack_nonlocal:\n+\talloc r20=ar.pfs,4,0,0,0\n+\tmov r19=ar.rsc\n+\tadds r2=8,in0\n+\tld8 r12=[in0],16\n+\t;;\n+\tflushrs\n+\tld8 r16=[r2],16\n+\tand r19=0x1c,r19\n+\tld8 r17=[in0]\n+\t;;\n+\tld8 r18=[r2]\n+\tmov ar.rsc=r19\n+\t;;\n+\tmov ar.bspstore=r16\n+\t;;\n+\tmov ar.rnat=r17\n+\tmov ar.pfs=r18\n+\tor r19=0x3,r19\n+\t;;\n+\tloadrs\n+\tinvala\n+.L0:\t{\n+\tmov ar.rsc=r19\n+\tbr.ret.sptk.few rp\n+\t}\n+\t;;\n+\t.endp __ia64_restore_stack_nonlocal\n+#endif"}, {"sha": "cb23c5237a7b772c44e485bccc5da362fa6dc1e6", "filename": "gcc/config/ia64/t-ia64", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9525c690037bfcfd1f6d5e5708122937140deb65/gcc%2Fconfig%2Fia64%2Ft-ia64", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9525c690037bfcfd1f6d5e5708122937140deb65/gcc%2Fconfig%2Fia64%2Ft-ia64", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fia64%2Ft-ia64?ref=9525c690037bfcfd1f6d5e5708122937140deb65", "patch": "@@ -11,7 +11,7 @@ LIB1ASMSRC    = ia64/lib1funcs.asm\n LIB1ASMFUNCS  = __divdf3 __divsf3 \\\n \t__divdi3 __moddi3 __udivdi3 __umoddi3 \\\n \t__divsi3 __modsi3 __udivsi3 __umodsi3 __save_stack_nonlocal \\\n-\t__nonlocal_goto\n+\t__nonlocal_goto __restore_stack_nonlocal\n \n # ??? Hack to get -P option used when compiling lib1funcs.asm, because Intel\n # assembler does not accept # line number as a comment."}]}