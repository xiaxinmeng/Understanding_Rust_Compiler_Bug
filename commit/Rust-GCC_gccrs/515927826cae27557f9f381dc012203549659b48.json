{"sha": "515927826cae27557f9f381dc012203549659b48", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTE1OTI3ODI2Y2FlMjc1NTdmOWYzODFkYzAxMjIwMzU0OTY1OWI0OA==", "commit": {"author": {"name": "Nathanael Nerode", "email": "neroden@gcc.gnu.org", "date": "2004-02-20T02:01:16Z"}, "committer": {"name": "Nathanael Nerode", "email": "neroden@gcc.gnu.org", "date": "2004-02-20T02:01:16Z"}, "message": "re PR bootstrap/11932 (Parallel bootstrap failure with sparc libiberty multilib)\n\n\tPR bootstrap/11932\n\t* mkinstalldirs, install-sh: Import from automake CVS HEAD.\n\nFrom-SVN: r78143", "tree": {"sha": "cc6b1eecf6b3d385bc2b0d4e08fb6843091e2841", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/cc6b1eecf6b3d385bc2b0d4e08fb6843091e2841"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/515927826cae27557f9f381dc012203549659b48", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/515927826cae27557f9f381dc012203549659b48", "html_url": "https://github.com/Rust-GCC/gccrs/commit/515927826cae27557f9f381dc012203549659b48", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/515927826cae27557f9f381dc012203549659b48/comments", "author": null, "committer": null, "parents": [{"sha": "089e52f7738e1085904143a7a38f3cd9de3d0893", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/089e52f7738e1085904143a7a38f3cd9de3d0893", "html_url": "https://github.com/Rust-GCC/gccrs/commit/089e52f7738e1085904143a7a38f3cd9de3d0893"}], "stats": {"total": 542, "additions": 304, "deletions": 238}, "files": [{"sha": "ed79ee14959cb7c1263161e3b681ac5408b83092", "filename": "ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/515927826cae27557f9f381dc012203549659b48/ChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/515927826cae27557f9f381dc012203549659b48/ChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/ChangeLog?ref=515927826cae27557f9f381dc012203549659b48", "patch": "@@ -1,3 +1,8 @@\n+2004-02-19  Nathanael Nerode  <neroden@gcc.gnu.org>\n+\n+\tPR bootstrap/11932\n+\t* mkinstalldirs, install-sh: Import from automake CVS HEAD.\n+\n 2004-02-14  Jerry Quinn  <jlquinn@optonline.net>\n \n \t* MAINTAINERS: Added myself to write-after-approval."}, {"sha": "77bc38144f23d186b8f0bac3595c9b1e1f8dfb6f", "filename": "install-sh", "status": "modified", "additions": 245, "deletions": 223, "changes": 468, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/515927826cae27557f9f381dc012203549659b48/install-sh", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/515927826cae27557f9f381dc012203549659b48/install-sh", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/install-sh?ref=515927826cae27557f9f381dc012203549659b48", "patch": "@@ -1,7 +1,8 @@\n #!/bin/sh\n-#\n # install - install a program, script, or datafile\n-#\n+\n+scriptversion=2004-02-15.20\n+\n # This originates from X11R5 (mit/util/scripts/install.sh), which was\n # later released in X11R6 (xc/config/util/install.sh) with the\n # following copyright and license.\n@@ -41,13 +42,11 @@\n # from scratch.  It can only install one file at a time, a restriction\n # shared with many OS's install programs.\n \n-\n # set DOITPROG to echo to test this script\n \n # Don't use :- since 4.3BSD and earlier shells don't like it.\n doit=\"${DOITPROG-}\"\n \n-\n # put in absolute paths if you don't have them in your path; or use env. vars.\n \n mvprog=\"${MVPROG-mv}\"\n@@ -59,236 +58,259 @@ stripprog=\"${STRIPPROG-strip}\"\n rmprog=\"${RMPROG-rm}\"\n mkdirprog=\"${MKDIRPROG-mkdir}\"\n \n-transformbasename=\"\"\n-transform_arg=\"\"\n+transformbasename=\n+transform_arg=\n instcmd=\"$mvprog\"\n chmodcmd=\"$chmodprog 0755\"\n-chowncmd=\"\"\n-chgrpcmd=\"\"\n-stripcmd=\"\"\n+chowncmd=\n+chgrpcmd=\n+stripcmd=\n rmcmd=\"$rmprog -f\"\n mvcmd=\"$mvprog\"\n-src=\"\"\n-dst=\"\"\n-dir_arg=\"\"\n-\n-while [ x\"$1\" != x ]; do\n-    case $1 in\n-\t-c) instcmd=$cpprog\n-\t    shift\n-\t    continue;;\n-\n-\t-d) dir_arg=true\n-\t    shift\n-\t    continue;;\n-\n-\t-m) chmodcmd=\"$chmodprog $2\"\n-\t    shift\n-\t    shift\n-\t    continue;;\n-\n-\t-o) chowncmd=\"$chownprog $2\"\n-\t    shift\n-\t    shift\n-\t    continue;;\n-\n-\t-g) chgrpcmd=\"$chgrpprog $2\"\n-\t    shift\n-\t    shift\n-\t    continue;;\n-\n-\t-s) stripcmd=$stripprog\n-\t    shift\n-\t    continue;;\n-\n-\t-t=*) transformarg=`echo $1 | sed 's/-t=//'`\n-\t    shift\n-\t    continue;;\n-\n-\t-b=*) transformbasename=`echo $1 | sed 's/-b=//'`\n-\t    shift\n-\t    continue;;\n-\n-\t*)  if [ x\"$src\" = x ]\n-\t    then\n-\t\tsrc=$1\n-\t    else\n-\t\t# this colon is to work around a 386BSD /bin/sh bug\n-\t\t:\n-\t\tdst=$1\n-\t    fi\n-\t    shift\n-\t    continue;;\n-    esac\n+src=\n+dst=\n+dir_arg=\n+\n+usage=\"Usage: $0 [OPTION]... SRCFILE DSTFILE\n+   or: $0 [OPTION]... SRCFILES... DIRECTORY\n+   or: $0 -d DIRECTORIES...\n+\n+In the first form, install SRCFILE to DSTFILE, removing SRCFILE by default.\n+In the second, create the directory path DIR.\n+\n+Options:\n+-b=TRANSFORMBASENAME\n+-c         copy source (using $cpprog) instead of moving (using $mvprog).\n+-d         create directories instead of installing files.\n+-g GROUP   $chgrp installed files to GROUP.\n+-m MODE    $chmod installed files to MODE.\n+-o USER    $chown installed files to USER.\n+-s         strip installed files (using $stripprog).\n+-t=TRANSFORM\n+--help     display this help and exit.\n+--version  display version info and exit.\n+\n+Environment variables override the default commands:\n+  CHGRPPROG CHMODPROG CHOWNPROG CPPROG MKDIRPROG MVPROG RMPROG STRIPPROG\n+\"\n+\n+while test -n \"$1\"; do\n+  case $1 in\n+    -b=*) transformbasename=`echo $1 | sed 's/-b=//'`\n+        shift\n+        continue;;\n+\n+    -c) instcmd=$cpprog\n+        shift\n+        continue;;\n+\n+    -d) dir_arg=true\n+        shift\n+        continue;;\n+\n+    -g) chgrpcmd=\"$chgrpprog $2\"\n+        shift\n+        shift\n+        continue;;\n+\n+    --help) echo \"$usage\"; exit 0;;\n+\n+    -m) chmodcmd=\"$chmodprog $2\"\n+        shift\n+        shift\n+        continue;;\n+\n+    -o) chowncmd=\"$chownprog $2\"\n+        shift\n+        shift\n+        continue;;\n+\n+    -s) stripcmd=$stripprog\n+        shift\n+        continue;;\n+\n+    -t=*) transformarg=`echo $1 | sed 's/-t=//'`\n+        shift\n+        continue;;\n+\n+    --version) echo \"$0 $scriptversion\"; exit 0;;\n+\n+    *)  # When -d is used, all remaining arguments are directories to create.\n+\ttest -n \"$dir_arg\" && break\n+        # Otherwise, the last argument is the destination.  Remove it from $@.\n+\tfor arg\n+\tdo\n+          if test -n \"$dstarg\"; then\n+\t    # $@ is not empty: it contains at least $arg.\n+\t    set fnord \"$@\" \"$dstarg\"\n+\t    shift # fnord\n+\t  fi\n+\t  shift # arg\n+\t  dstarg=$arg\n+\tdone\n+\tbreak;;\n+  esac\n done\n \n-if [ x\"$src\" = x ]\n-then\n-\techo \"$0: no input file specified\" >&2\n-\texit 1\n-else\n-\t:\n+if test -z \"$1\"; then\n+  if test -z \"$dir_arg\"; then\n+    echo \"$0: no input file specified.\" >&2\n+    exit 1\n+  fi\n+  # It's OK to call `install-sh -d' without argument.\n+  # This can happen when creating conditional directories.\n+  exit 0\n fi\n \n-if [ x\"$dir_arg\" != x ]; then\n-\tdst=$src\n-\tsrc=\"\"\n-\n-\tif [ -d \"$dst\" ]; then\n-\t\tinstcmd=:\n-\t\tchmodcmd=\"\"\n-\telse\n-\t\tinstcmd=$mkdirprog\n-\tfi\n-else\n-\n-# Waiting for this to be detected by the \"$instcmd $src $dsttmp\" command\n-# might cause directories to be created, which would be especially bad\n-# if $src (and thus $dsttmp) contains '*'.\n-\n-\tif [ -f \"$src\" ] || [ -d \"$src\" ]\n-\tthen\n-\t\t:\n-\telse\n-\t\techo \"$0: $src does not exist\" >&2\n-\t\texit 1\n-\tfi\n-\n-\tif [ x\"$dst\" = x ]\n-\tthen\n-\t\techo \"$0: no destination specified\" >&2\n-\t\texit 1\n-\telse\n-\t\t:\n-\tfi\n-\n-# If destination is a directory, append the input filename; if your system\n-# does not like double slashes in filenames, you may need to add some logic\n-\n-\tif [ -d \"$dst\" ]\n-\tthen\n-\t\tdst=$dst/`basename \"$src\"`\n-\telse\n-\t\t:\n-\tfi\n-fi\n-\n-## this sed command emulates the dirname command\n-dstdir=`echo \"$dst\" | sed -e 's,[^/]*$,,;s,/$,,;s,^$,.,'`\n-\n-# Make sure that the destination directory exists.\n-#  this part is taken from Noah Friedman's mkinstalldirs script\n-\n-# Skip lots of stat calls in the usual case.\n-if [ ! -d \"$dstdir\" ]; then\n-defaultIFS='\n-\t'\n-IFS=\"${IFS-$defaultIFS}\"\n-\n-oIFS=$IFS\n-# Some sh's can't handle IFS=/ for some reason.\n-IFS='%'\n-set - `echo \"$dstdir\" | sed -e 's@/@%@g' -e 's@^%@/@'`\n-IFS=$oIFS\n-\n-pathcomp=''\n-\n-while [ $# -ne 0 ] ; do\n-\tpathcomp=$pathcomp$1\n-\tshift\n-\n-\tif [ ! -d \"$pathcomp\" ] ;\n-        then\n-\t\t$mkdirprog \"$pathcomp\"\n-\telse\n-\t\t:\n-\tfi\n+for src\n+do\n+  # Protect names starting with `-'.\n+  case $src in\n+    -*) src=./$src ;;\n+  esac\n+\n+  if test -n \"$dir_arg\"; then\n+    dst=$src\n+    src=\n+\n+    if test -d \"$dst\"; then\n+      instcmd=:\n+      chmodcmd=\n+    else\n+      instcmd=$mkdirprog\n+    fi\n+  else\n+    # Waiting for this to be detected by the \"$instcmd $src $dsttmp\" command\n+    # might cause directories to be created, which would be especially bad\n+    # if $src (and thus $dsttmp) contains '*'.\n+    if test ! -f \"$src\" && test ! -d \"$src\"; then\n+      echo \"$0: $src does not exist.\" >&2\n+      exit 1\n+    fi\n+\n+    if test -z \"$dstarg\"; then\n+      echo \"$0: no destination specified.\" >&2\n+      exit 1\n+    fi\n+\n+    dst=$dstarg\n+    # Protect names starting with `-'.\n+    case $dst in\n+      -*) dst=./$dst ;;\n+    esac\n \n-\tpathcomp=$pathcomp/\n+    # If destination is a directory, append the input filename; won't work\n+    # if double slashes aren't ignored.\n+    if test -d \"$dst\"; then\n+      dst=$dst/`basename \"$src\"`\n+    fi\n+  fi\n+\n+  # This sed command emulates the dirname command.\n+  dstdir=`echo \"$dst\" | sed -e 's,[^/]*$,,;s,/$,,;s,^$,.,'`\n+\n+  # Make sure that the destination directory exists.\n+\n+  # Skip lots of stat calls in the usual case.\n+  if test ! -d \"$dstdir\"; then\n+    defaultIFS='\n+\t '\n+    IFS=\"${IFS-$defaultIFS}\"\n+\n+    oIFS=$IFS\n+    # Some sh's can't handle IFS=/ for some reason.\n+    IFS='%'\n+    set - `echo \"$dstdir\" | sed -e 's@/@%@g' -e 's@^%@/@'`\n+    IFS=$oIFS\n+\n+    pathcomp=\n+\n+    while test $# -ne 0 ; do\n+      pathcomp=$pathcomp$1\n+      shift\n+      if test ! -d \"$pathcomp\"; then\n+        $mkdirprog \"$pathcomp\" || lasterr=$?\n+\t# mkdir can fail with a `File exist' error in case several\n+\t# install-sh are creating the directory concurrently.  This\n+\t# is OK.\n+\ttest ! -d \"$pathcomp\" && { (exit ${lasterr-1}); exit; }\n+      fi\n+      pathcomp=$pathcomp/\n+    done\n+  fi\n+\n+  if test -n \"$dir_arg\"; then\n+    $doit $instcmd \"$dst\" \\\n+      && { test -z \"$chowncmd\" || $doit $chowncmd \"$dst\"; } \\\n+      && { test -z \"$chgrpcmd\" || $doit $chgrpcmd \"$dst\"; } \\\n+      && { test -z \"$stripcmd\" || $doit $stripcmd \"$dst\"; } \\\n+      && { test -z \"$chmodcmd\" || $doit $chmodcmd \"$dst\"; }\n+\n+  else\n+    # If we're going to rename the final executable, determine the name now.\n+    if test -z \"$transformarg\"; then\n+      dstfile=`basename \"$dst\"`\n+    else\n+      dstfile=`basename \"$dst\" $transformbasename \\\n+               | sed $transformarg`$transformbasename\n+    fi\n+\n+    # don't allow the sed command to completely eliminate the filename.\n+    test -z \"$dstfile\" && dstfile=`basename \"$dst\"`\n+\n+    # Make a couple of temp file names in the proper directory.\n+    dsttmp=$dstdir/_inst.$$_\n+    rmtmp=$dstdir/_rm.$$_\n+\n+    # Trap to clean up those temp files at exit.\n+    trap 'status=$?; rm -f \"$dsttmp\" \"$rmtmp\" && exit $status' 0\n+    trap '(exit $?); exit' 1 2 13 15\n+\n+    # Move or copy the file name to the temp name\n+    $doit $instcmd \"$src\" \"$dsttmp\" &&\n+\n+    # and set any options; do chmod last to preserve setuid bits.\n+    #\n+    # If any of these fail, we abort the whole thing.  If we want to\n+    # ignore errors from any of these, just make sure not to ignore\n+    # errors from the above \"$doit $instcmd $src $dsttmp\" command.\n+    #\n+    { test -z \"$chowncmd\" || $doit $chowncmd \"$dsttmp\"; } \\\n+      && { test -z \"$chgrpcmd\" || $doit $chgrpcmd \"$dsttmp\"; } \\\n+      && { test -z \"$stripcmd\" || $doit $stripcmd \"$dsttmp\"; } \\\n+      && { test -z \"$chmodcmd\" || $doit $chmodcmd \"$dsttmp\"; } &&\n+\n+    # Now remove or move aside any old file at destination location.  We\n+    # try this two ways since rm can't unlink itself on some systems and\n+    # the destination file might be busy for other reasons.  In this case,\n+    # the final cleanup might fail but the new file should still install\n+    # successfully.\n+    {\n+      if test -f \"$dstdir/$dstfile\"; then\n+        $doit $rmcmd -f \"$dstdir/$dstfile\" 2>/dev/null \\\n+        || $doit $mvcmd -f \"$dstdir/$dstfile\" \"$rmtmp\" 2>/dev/null \\\n+        || {\n+\t  echo \"$0: cannot unlink or rename $dstdir/$dstfile\" >&2\n+\t  (exit 1); exit\n+        }\n+      else\n+        :\n+      fi\n+    } &&\n+\n+    # Now rename the file to the real destination.\n+    $doit $mvcmd \"$dsttmp\" \"$dstdir/$dstfile\"\n+  fi || { (exit 1); exit; }\n done\n-fi\n-\n-if [ x\"$dir_arg\" != x ]\n-then\n-\t$doit $instcmd \"$dst\" &&\n-\n-\tif [ x\"$chowncmd\" != x ]; then $doit $chowncmd \"$dst\"; else : ; fi &&\n-\tif [ x\"$chgrpcmd\" != x ]; then $doit $chgrpcmd \"$dst\"; else : ; fi &&\n-\tif [ x\"$stripcmd\" != x ]; then $doit $stripcmd \"$dst\"; else : ; fi &&\n-\tif [ x\"$chmodcmd\" != x ]; then $doit $chmodcmd \"$dst\"; else : ; fi\n-else\n-\n-# If we're going to rename the final executable, determine the name now.\n-\n-\tif [ x\"$transformarg\" = x ]\n-\tthen\n-\t\tdstfile=`basename \"$dst\"`\n-\telse\n-\t\tdstfile=`basename \"$dst\" $transformbasename |\n-\t\t\tsed $transformarg`$transformbasename\n-\tfi\n-\n-# don't allow the sed command to completely eliminate the filename\n-\n-\tif [ x\"$dstfile\" = x ]\n-\tthen\n-\t\tdstfile=`basename \"$dst\"`\n-\telse\n-\t\t:\n-\tfi\n-\n-# Make a couple of temp file names in the proper directory.\n-\n-\tdsttmp=$dstdir/#inst.$$#\n-\trmtmp=$dstdir/#rm.$$#\n-\n-# Trap to clean up temp files at exit.\n-\n-\ttrap 'status=$?; rm -f \"$dsttmp\" \"$rmtmp\" && exit $status' 0\n-\ttrap '(exit $?); exit' 1 2 13 15\n-\n-# Move or copy the file name to the temp name\n-\n-\t$doit $instcmd \"$src\" \"$dsttmp\" &&\n-\n-# and set any options; do chmod last to preserve setuid bits\n-\n-# If any of these fail, we abort the whole thing.  If we want to\n-# ignore errors from any of these, just make sure not to ignore\n-# errors from the above \"$doit $instcmd $src $dsttmp\" command.\n-\n-\tif [ x\"$chowncmd\" != x ]; then $doit $chowncmd \"$dsttmp\"; else :;fi &&\n-\tif [ x\"$chgrpcmd\" != x ]; then $doit $chgrpcmd \"$dsttmp\"; else :;fi &&\n-\tif [ x\"$stripcmd\" != x ]; then $doit $stripcmd \"$dsttmp\"; else :;fi &&\n-\tif [ x\"$chmodcmd\" != x ]; then $doit $chmodcmd \"$dsttmp\"; else :;fi &&\n-\n-# Now remove or move aside any old file at destination location.  We try this\n-# two ways since rm can't unlink itself on some systems and the destination\n-# file might be busy for other reasons.  In this case, the final cleanup\n-# might fail but the new file should still install successfully.\n-\n-{\n-\tif [ -f \"$dstdir/$dstfile\" ]\n-\tthen\n-\t\t$doit $rmcmd -f \"$dstdir/$dstfile\" 2>/dev/null ||\n-\t\t$doit $mvcmd -f \"$dstdir/$dstfile\" \"$rmtmp\" 2>/dev/null ||\n-\t\t{\n-\t\t  echo \"$0: cannot unlink or rename $dstdir/$dstfile\" >&2\n-\t\t  (exit 1); exit\n-\t\t}\n-\telse\n-\t\t:\n-\tfi\n-} &&\n-\n-# Now rename the file to the real destination.\n-\n-\t$doit $mvcmd \"$dsttmp\" \"$dstdir/$dstfile\"\n-\n-fi &&\n \n # The final little trick to \"correctly\" pass the exit status to the exit trap.\n-\n {\n-\t(exit 0); exit\n+  (exit 0); exit\n }\n+\n+# Local variables:\n+# eval: (add-hook 'write-file-hooks 'time-stamp)\n+# time-stamp-start: \"scriptversion=\"\n+# time-stamp-format: \"%:y-%02m-%02d.%02H\"\n+# time-stamp-end: \"$\"\n+# End:"}, {"sha": "6fbe5e117629c75a723710efc4b2e0341c17c895", "filename": "mkinstalldirs", "status": "modified", "additions": 54, "deletions": 15, "changes": 69, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/515927826cae27557f9f381dc012203549659b48/mkinstalldirs", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/515927826cae27557f9f381dc012203549659b48/mkinstalldirs", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/mkinstalldirs?ref=515927826cae27557f9f381dc012203549659b48", "patch": "@@ -1,20 +1,32 @@\n #! /bin/sh\n # mkinstalldirs --- make directory hierarchy\n-# Author: Noah Friedman <friedman@prep.ai.mit.edu>\n+\n+scriptversion=2004-02-15.20\n+\n+# Original author: Noah Friedman <friedman@prep.ai.mit.edu>\n # Created: 1993-05-16\n-# Public domain\n+# Public domain.\n+#\n+# This file is maintained in Automake, please report\n+# bugs to <bug-automake@gnu.org> or send patches to\n+# <automake-patches@gnu.org>.\n \n errstatus=0\n dirmode=\"\"\n \n usage=\"\\\n-Usage: mkinstalldirs [-h] [--help] [-m mode] dir ...\"\n+Usage: mkinstalldirs [-h] [--help] [--version] [-m MODE] DIR ...\n+\n+Create each directory DIR (with mode MODE, if specified), including all\n+leading file name components.\n+\n+Report bugs to <bug-automake@gnu.org>.\"\n \n # process command line arguments\n while test $# -gt 0 ; do\n   case $1 in\n     -h | --help | --h*)         # -h for help\n-      echo \"$usage\" 1>&2\n+      echo \"$usage\"\n       exit 0\n       ;;\n     -m)                         # -m PERM arg\n@@ -23,6 +35,10 @@ while test $# -gt 0 ; do\n       dirmode=$1\n       shift\n       ;;\n+    --version)\n+      echo \"$0 $scriptversion\"\n+      exit 0\n+      ;;\n     --)                         # stop option processing\n       shift\n       break\n@@ -50,17 +66,37 @@ case $# in\n   0) exit 0 ;;\n esac\n \n+# Solaris 8's mkdir -p isn't thread-safe.  If you mkdir -p a/b and\n+# mkdir -p a/c at the same time, both will detect that a is missing,\n+# one will create a, then the other will try to create a and die with\n+# a \"File exists\" error.  This is a problem when calling mkinstalldirs\n+# from a parallel make.  We use --version in the probe to restrict\n+# ourselves to GNU mkdir, which is thread-safe.\n case $dirmode in\n   '')\n-    if mkdir -p -- . 2>/dev/null; then\n+    if mkdir -p --version . >/dev/null 2>&1 && test ! -d ./--version; then\n       echo \"mkdir -p -- $*\"\n       exec mkdir -p -- \"$@\"\n+    else\n+      # On NextStep and OpenStep, the `mkdir' command does not\n+      # recognize any option.  It will interpret all options as\n+      # directories to create, and then abort because `.' already\n+      # exists.\n+      test -d ./-p && rmdir ./-p\n+      test -d ./--version && rmdir ./--version\n     fi\n     ;;\n   *)\n-    if mkdir -m \"$dirmode\" -p -- . 2>/dev/null; then\n+    if mkdir -m \"$dirmode\" -p --version . >/dev/null 2>&1 &&\n+       test ! -d ./--version; then\n       echo \"mkdir -m $dirmode -p -- $*\"\n       exec mkdir -m \"$dirmode\" -p -- \"$@\"\n+    else\n+      # Clean up after NextStep and OpenStep mkdir.\n+      for d in ./-m ./-p ./--version \"./$dirmode\";\n+      do\n+        test -d $d && rmdir $d\n+      done\n     fi\n     ;;\n esac\n@@ -84,17 +120,17 @@ do\n       mkdir \"$pathcomp\" || lasterr=$?\n \n       if test ! -d \"$pathcomp\"; then\n-  \terrstatus=$lasterr\n+\terrstatus=$lasterr\n       else\n-  \tif test ! -z \"$dirmode\"; then\n+\tif test ! -z \"$dirmode\"; then\n \t  echo \"chmod $dirmode $pathcomp\"\n-    \t  lasterr=\"\"\n-  \t  chmod \"$dirmode\" \"$pathcomp\" || lasterr=$?\n+\t  lasterr=\"\"\n+\t  chmod \"$dirmode\" \"$pathcomp\" || lasterr=$?\n \n-  \t  if test ! -z \"$lasterr\"; then\n-  \t    errstatus=$lasterr\n-  \t  fi\n-  \tfi\n+\t  if test ! -z \"$lasterr\"; then\n+\t    errstatus=$lasterr\n+\t  fi\n+\tfi\n       fi\n     fi\n \n@@ -107,5 +143,8 @@ exit $errstatus\n # Local Variables:\n # mode: shell-script\n # sh-indentation: 2\n+# eval: (add-hook 'write-file-hooks 'time-stamp)\n+# time-stamp-start: \"scriptversion=\"\n+# time-stamp-format: \"%:y-%02m-%02d.%02H\"\n+# time-stamp-end: \"$\"\n # End:\n-# mkinstalldirs ends here"}]}