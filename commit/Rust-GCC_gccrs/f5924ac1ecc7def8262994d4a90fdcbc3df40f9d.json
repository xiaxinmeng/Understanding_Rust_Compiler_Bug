{"sha": "f5924ac1ecc7def8262994d4a90fdcbc3df40f9d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjU5MjRhYzFlY2M3ZGVmODI2Mjk5NGQ0YTkwZmRjYmMzZGY0MGY5ZA==", "commit": {"author": {"name": "Nathan Sidwell", "email": "nathan@codesourcery.com", "date": "2003-07-05T16:11:53Z"}, "committer": {"name": "Nathan Sidwell", "email": "nathan@gcc.gnu.org", "date": "2003-07-05T16:11:53Z"}, "message": "toplev.c (output_clean_symbol_name): Remove.\n\n\t* toplev.c (output_clean_symbol_name): Remove.\n\t* toplev.h (output_clean_symbol_name): Remove.\n\t* config/alpha/alpha.c (unicosmk_output_module_name): Use\n\tlbasename & clean_symbol_name.\n\nFrom-SVN: r68978", "tree": {"sha": "d2e9fdc94df1c994011ca95833f07282659dd155", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d2e9fdc94df1c994011ca95833f07282659dd155"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f5924ac1ecc7def8262994d4a90fdcbc3df40f9d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f5924ac1ecc7def8262994d4a90fdcbc3df40f9d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f5924ac1ecc7def8262994d4a90fdcbc3df40f9d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f5924ac1ecc7def8262994d4a90fdcbc3df40f9d/comments", "author": null, "committer": null, "parents": [{"sha": "f92c5313e17a9b084d8bb80f272d3b9996156d1f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f92c5313e17a9b084d8bb80f272d3b9996156d1f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f92c5313e17a9b084d8bb80f272d3b9996156d1f"}], "stats": {"total": 45, "additions": 16, "deletions": 29}, "files": [{"sha": "33ea3abd478afafa08a1dd87a53a79fabbd9eb9e", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f5924ac1ecc7def8262994d4a90fdcbc3df40f9d/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f5924ac1ecc7def8262994d4a90fdcbc3df40f9d/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=f5924ac1ecc7def8262994d4a90fdcbc3df40f9d", "patch": "@@ -1,3 +1,10 @@\n+2003-07-05  Nathan Sidwell  <nathan@codesourcery.com>\n+\n+\t* toplev.c (output_clean_symbol_name): Remove.\n+\t* toplev.h (output_clean_symbol_name): Remove.\n+\t* config/alpha/alpha.c (unicosmk_output_module_name): Use\n+\tlbasename & clean_symbol_name.\n+\n 2003-07-05  Kazu Hirata  <kazu@cs.umass.edu>\n \n \t* ggc.h: Follow spelling conventions."}, {"sha": "df386deb937577abe0029ce0f64c13eff0ba5fda", "filename": "gcc/config/alpha/alpha.c", "status": "modified", "additions": 9, "deletions": 12, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f5924ac1ecc7def8262994d4a90fdcbc3df40f9d/gcc%2Fconfig%2Falpha%2Falpha.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f5924ac1ecc7def8262994d4a90fdcbc3df40f9d/gcc%2Fconfig%2Falpha%2Falpha.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Falpha%2Falpha.c?ref=f5924ac1ecc7def8262994d4a90fdcbc3df40f9d", "patch": "@@ -9278,22 +9278,19 @@ unicosmk_initial_elimination_offset (int from, int to)\n static void\n unicosmk_output_module_name (FILE *file)\n {\n-  const char *name;\n-\n-  /* Strip directories.  */\n-\n-  name = strrchr (main_input_filename, '/');\n-  if (name)\n-    ++name;\n-  else\n-    name = main_input_filename;\n-\n+  const char *name = lbasename (main_input_filename);\n+  unsigned len = strlen (name);\n+  char *clean_name = alloca (len + 2);\n+  char *ptr = clean_name;\n+  \n   /* CAM only accepts module names that start with a letter or '$'. We\n      prefix the module name with a '$' if necessary.  */\n \n   if (!ISALPHA (*name))\n-    putc ('$', file);\n-  output_clean_symbol_name (file, name);\n+    *ptr++ = '$';\n+  memcpy (ptr, name, len + 1);\n+  clean_symbol_name (clean_name);\n+  fputs (clean_name, file);\n }\n \n /* Output the definition of a common variable.  */"}, {"sha": "33374679f64eab77842aef5833a226e590e4faf2", "filename": "gcc/toplev.c", "status": "modified", "additions": 0, "deletions": 16, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f5924ac1ecc7def8262994d4a90fdcbc3df40f9d/gcc%2Ftoplev.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f5924ac1ecc7def8262994d4a90fdcbc3df40f9d/gcc%2Ftoplev.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftoplev.c?ref=f5924ac1ecc7def8262994d4a90fdcbc3df40f9d", "patch": "@@ -1699,22 +1699,6 @@ output_quoted_string (FILE *asm_file, const char *string)\n #endif\n }\n \n-/* Output NAME into FILE after having turned it into something\n-   usable as an identifier in a target's assembly file.  */\n-void\n-output_clean_symbol_name (FILE *file, const char *name)\n-{\n-  /* Make a copy of NAME.  */\n-  char *id = xstrdup (name);\n-\n-  /* Make it look like a valid identifier for an assembler.  */\n-  clean_symbol_name (id);\n-\n-  fputs (id, file);\n-  free (id);\n-}\n-\n-\n /* Output a file name in the form wanted by System V.  */\n \n void"}, {"sha": "e750207b92365145cb8f56bf7a2e8f7ea29452aa", "filename": "gcc/toplev.h", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f5924ac1ecc7def8262994d4a90fdcbc3df40f9d/gcc%2Ftoplev.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f5924ac1ecc7def8262994d4a90fdcbc3df40f9d/gcc%2Ftoplev.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftoplev.h?ref=f5924ac1ecc7def8262994d4a90fdcbc3df40f9d", "patch": "@@ -89,7 +89,6 @@ extern void warning_for_asm\t\t(struct rtx_def *,\n \t\t\t\t\t const char *, ...) ATTRIBUTE_GCC_DIAG(2,3);\n extern void warn_deprecated_use\t\t(union tree_node *);\n \n-extern void output_clean_symbol_name    (FILE *, const char *);\n #ifdef BUFSIZ\n extern void output_quoted_string\t(FILE *, const char *);\n extern void output_file_directive\t(FILE *, const char *);"}]}