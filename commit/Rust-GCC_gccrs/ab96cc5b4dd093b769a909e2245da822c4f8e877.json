{"sha": "ab96cc5b4dd093b769a909e2245da822c4f8e877", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWI5NmNjNWI0ZGQwOTNiNzY5YTkwOWUyMjQ1ZGE4MjJjNGY4ZTg3Nw==", "commit": {"author": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2012-08-11T08:38:59Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2012-08-11T08:38:59Z"}, "message": "lto-cgraph.c (output_cgraph): Rename to ...\n\n\n\t* lto-cgraph.c (output_cgraph): Rename to ...\n\t(output_symtab): ... this one. Update for LTO_section_symtab_nodes.\n\t(input_cgraph): Rename to ...\n\t(input_symtab): ... this one. Update for LTO_section_symtab_nodes.\n\t* lto-streamer-out.c (create_output_block): Do not set\n\tsection_type.\n\t(produce_asm): Likewise.\n\t(lto_output_toplevel_asms): Likewise.\n\t(produce_asm_for_decls): Likewise.\n\t(lto_output): Use output_symtab.\n\t* lto-section-in.c (lto_section_name): Update.\n\t* lto-section-out.c (lto_destroy_simple_output_block): Remove section_type.\n\t* lto-streamer.h (enum lto_section_type): Remove LTO_section_varpool;\n\trename LTO_section_cgraph to LTO_section_symtab_nodes.\n\t(struct lto_header): Remove section_type.\n\n\t* lto.c (read_cgraph_and_symbols): Use input_symtab.\n\nFrom-SVN: r190312", "tree": {"sha": "0793ee7ca02faf63574b64bf05c816cc6b8837e1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0793ee7ca02faf63574b64bf05c816cc6b8837e1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ab96cc5b4dd093b769a909e2245da822c4f8e877", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ab96cc5b4dd093b769a909e2245da822c4f8e877", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ab96cc5b4dd093b769a909e2245da822c4f8e877", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ab96cc5b4dd093b769a909e2245da822c4f8e877/comments", "author": null, "committer": null, "parents": [{"sha": "3af76e5a95e8cef562136a40a78bb19f83df59dd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3af76e5a95e8cef562136a40a78bb19f83df59dd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3af76e5a95e8cef562136a40a78bb19f83df59dd"}], "stats": {"total": 64, "additions": 39, "deletions": 25}, "files": [{"sha": "6eb422b0ca890caf9d5feaebf46335934ca77f97", "filename": "gcc/ChangeLog", "status": "modified", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ab96cc5b4dd093b769a909e2245da822c4f8e877/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ab96cc5b4dd093b769a909e2245da822c4f8e877/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=ab96cc5b4dd093b769a909e2245da822c4f8e877", "patch": "@@ -1,3 +1,21 @@\n+2012-08-11  Jan Hubicka  <jh@suse.cz>\n+\n+\t* lto-cgraph.c (output_cgraph): Rename to ...\n+\t(output_symtab): ... this one. Update for LTO_section_symtab_nodes.\n+\t(input_cgraph): Rename to ...\n+\t(input_symtab): ... this one. Update for LTO_section_symtab_nodes.\n+\t* lto-streamer-out.c (create_output_block): Do not set\n+\tsection_type.\n+\t(produce_asm): Likewise.\n+\t(lto_output_toplevel_asms): Likewise.\n+\t(produce_asm_for_decls): Likewise.\n+\t(lto_output): Use output_symtab.\n+\t* lto-section-in.c (lto_section_name): Update.\n+\t* lto-section-out.c (lto_destroy_simple_output_block): Remove section_type.\n+\t* lto-streamer.h (enum lto_section_type): Remove LTO_section_varpool;\n+\trename LTO_section_cgraph to LTO_section_symtab_nodes.\n+\t(struct lto_header): Remove section_type.\n+\n 2012-08-11  Jan Hubicka  <jh@suse.cz>\n \n \t* cgraph.h (vector types for symtab_node): Add."}, {"sha": "c77408f85144b1efd31846e434612ab47051e4e5", "filename": "gcc/lto-cgraph.c", "status": "modified", "additions": 7, "deletions": 7, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ab96cc5b4dd093b769a909e2245da822c4f8e877/gcc%2Flto-cgraph.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ab96cc5b4dd093b769a909e2245da822c4f8e877/gcc%2Flto-cgraph.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flto-cgraph.c?ref=ab96cc5b4dd093b769a909e2245da822c4f8e877", "patch": "@@ -747,10 +747,10 @@ compute_ltrans_boundary (struct lto_out_decl_state *state,\n     }\n }\n \n-/* Output the part of the cgraph in SET.  */\n+/* Output the part of the symtab in SET and VSET.  */\n \n void\n-output_cgraph (cgraph_node_set set, varpool_node_set vset)\n+output_symtab (cgraph_node_set set, varpool_node_set vset)\n {\n   struct cgraph_node *node;\n   struct lto_simple_output_block *ob;\n@@ -762,7 +762,7 @@ output_cgraph (cgraph_node_set set, varpool_node_set vset)\n   if (flag_wpa)\n     output_cgraph_opt_summary (set);\n \n-  ob = lto_create_simple_output_block (LTO_section_cgraph);\n+  ob = lto_create_simple_output_block (LTO_section_symtab_nodes);\n \n   output_profile_summary (ob);\n \n@@ -1301,11 +1301,11 @@ merge_profile_summaries (struct lto_file_decl_data **file_data_vec)\n       }\n }\n \n-/* Input and merge the cgraph from each of the .o files passed to\n+/* Input and merge the symtab from each of the .o files passed to\n    lto1.  */\n \n void\n-input_cgraph (void)\n+input_symtab (void)\n {\n   struct lto_file_decl_data **file_data_vec = lto_get_file_decl_data ();\n   struct lto_file_decl_data *file_data;\n@@ -1321,14 +1321,14 @@ input_cgraph (void)\n       struct lto_input_block *ib;\n       VEC(symtab_node, heap) *nodes;\n \n-      ib = lto_create_simple_input_block (file_data, LTO_section_cgraph,\n+      ib = lto_create_simple_input_block (file_data, LTO_section_symtab_nodes,\n \t\t\t\t\t  &data, &len);\n       if (!ib) \n \tfatal_error (\"cannot find LTO cgraph in %s\", file_data->file_name);\n       input_profile_summary (ib, file_data);\n       file_data->symtab_node_encoder = lto_symtab_encoder_new ();\n       nodes = input_cgraph_1 (file_data, ib);\n-      lto_destroy_simple_input_block (file_data, LTO_section_cgraph,\n+      lto_destroy_simple_input_block (file_data, LTO_section_symtab_nodes,\n \t\t\t\t      ib, data, len);\n \n       ib = lto_create_simple_input_block (file_data, LTO_section_refs,"}, {"sha": "8d49765b6a69bcafd4d25ef9049d17b1cb5ed955", "filename": "gcc/lto-section-in.c", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ab96cc5b4dd093b769a909e2245da822c4f8e877/gcc%2Flto-section-in.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ab96cc5b4dd093b769a909e2245da822c4f8e877/gcc%2Flto-section-in.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flto-section-in.c?ref=ab96cc5b4dd093b769a909e2245da822c4f8e877", "patch": "@@ -49,14 +49,13 @@ const char *lto_section_name[LTO_N_SECTION_TYPES] =\n   \"decls\",\n   \"function_body\",\n   \"statics\",\n-  \"cgraph\",\n-  \"vars\",\n+  \"symtab\",\n   \"refs\",\n   \"asm\",\n   \"jmpfuncs\",\n   \"pureconst\",\n   \"reference\",\n-  \"symtab\",\n+  \"symtab_nodes\",\n   \"opts\",\n   \"cgraphopt\",\n   \"inline\""}, {"sha": "3de48e03df48a3772c783eddacd53ad03ba47663", "filename": "gcc/lto-section-out.c", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ab96cc5b4dd093b769a909e2245da822c4f8e877/gcc%2Flto-section-out.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ab96cc5b4dd093b769a909e2245da822c4f8e877/gcc%2Flto-section-out.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flto-section-out.c?ref=ab96cc5b4dd093b769a909e2245da822c4f8e877", "patch": "@@ -412,7 +412,6 @@ lto_destroy_simple_output_block (struct lto_simple_output_block *ob)\n   memset (&header, 0, sizeof (struct lto_simple_header));\n   header.lto_header.major_version = LTO_major_version;\n   header.lto_header.minor_version = LTO_minor_version;\n-  header.lto_header.section_type = LTO_section_cgraph;\n \n   header.compressed_size = 0;\n "}, {"sha": "0426401d5ef7ac283b07b06397ce2eba706fe3e9", "filename": "gcc/lto-streamer-out.c", "status": "modified", "additions": 2, "deletions": 6, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ab96cc5b4dd093b769a909e2245da822c4f8e877/gcc%2Flto-streamer-out.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ab96cc5b4dd093b769a909e2245da822c4f8e877/gcc%2Flto-streamer-out.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flto-streamer-out.c?ref=ab96cc5b4dd093b769a909e2245da822c4f8e877", "patch": "@@ -707,7 +707,6 @@ produce_asm (struct output_block *ob, tree fn)\n   /* Write the header.  */\n   header.lto_header.major_version = LTO_major_version;\n   header.lto_header.minor_version = LTO_minor_version;\n-  header.lto_header.section_type = section_type;\n \n   header.compressed_size = 0;\n \n@@ -893,7 +892,6 @@ lto_output_toplevel_asms (void)\n   /* Write the header.  */\n   header.lto_header.major_version = LTO_major_version;\n   header.lto_header.minor_version = LTO_minor_version;\n-  header.lto_header.section_type = LTO_section_asm;\n \n   header.main_size = ob->main_stream->total_size;\n   header.string_size = ob->string_stream->total_size;\n@@ -1020,7 +1018,7 @@ lto_output (cgraph_node_set set, varpool_node_set vset)\n      be done now to make sure that all the statements in every function\n      have been renumbered so that edges can be associated with call\n      statements using the statement UIDs.  */\n-  output_cgraph (set, vset);\n+  output_symtab (set, vset);\n \n #ifdef ENABLE_CHECKING\n   lto_bitmap_free (output);\n@@ -1430,7 +1428,6 @@ produce_asm_for_decls (cgraph_node_set set ATTRIBUTE_UNUSED,\n \n   header.lto_header.major_version = LTO_major_version;\n   header.lto_header.minor_version = LTO_minor_version;\n-  header.lto_header.section_type = LTO_section_decls;\n \n   /* Currently not used.  This field would allow us to preallocate\n      the globals vector, so that it need not be resized as it is extended.  */\n@@ -1457,8 +1454,7 @@ produce_asm_for_decls (cgraph_node_set set ATTRIBUTE_UNUSED,\n \n   /* Write the main out-decl state, followed by out-decl states of\n      functions. */\n-  decl_state_stream = ((struct lto_output_stream *)\n-\t\t       xcalloc (1, sizeof (struct lto_output_stream)));\n+  decl_state_stream = XCNEW (struct lto_output_stream);\n   num_decl_states = num_fns + 1;\n   lto_output_data_stream (decl_state_stream, &num_decl_states,\n \t\t\t  sizeof (num_decl_states));"}, {"sha": "b874b0aa016dc262e7abf3b74ccb8f0e43e12f98", "filename": "gcc/lto-streamer.h", "status": "modified", "additions": 4, "deletions": 6, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ab96cc5b4dd093b769a909e2245da822c4f8e877/gcc%2Flto-streamer.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ab96cc5b4dd093b769a909e2245da822c4f8e877/gcc%2Flto-streamer.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flto-streamer.h?ref=ab96cc5b4dd093b769a909e2245da822c4f8e877", "patch": "@@ -235,14 +235,13 @@ enum lto_section_type\n   LTO_section_decls = 0,\n   LTO_section_function_body,\n   LTO_section_static_initializer,\n-  LTO_section_cgraph,\n-  LTO_section_varpool,\n+  LTO_section_symtab,\n   LTO_section_refs,\n   LTO_section_asm,\n   LTO_section_jump_functions,\n   LTO_section_ipa_pure_const,\n   LTO_section_ipa_reference,\n-  LTO_section_symtab,\n+  LTO_section_symtab_nodes,\n   LTO_section_opts,\n   LTO_section_cgraph_opt_sum,\n   LTO_section_inline_summary,\n@@ -336,7 +335,6 @@ struct lto_header\n {\n   int16_t major_version;\n   int16_t minor_version;\n-  enum lto_section_type section_type;\n };\n \n /* The header for a function body.  */\n@@ -820,8 +818,8 @@ bool lto_symtab_encoder_encode_body_p (lto_symtab_encoder_t,\n \n bool lto_symtab_encoder_encode_initializer_p (lto_symtab_encoder_t,\n \t\t\t\t\t      struct varpool_node *);\n-void output_cgraph (cgraph_node_set, varpool_node_set);\n-void input_cgraph (void);\n+void output_symtab (cgraph_node_set, varpool_node_set);\n+void input_symtab (void);\n bool referenced_from_other_partition_p (struct ipa_ref_list *,\n \t\t\t\t        cgraph_node_set,\n \t\t\t\t        varpool_node_set vset);"}, {"sha": "fb1ea42e25e26287d7fff184beb68a652c46a397", "filename": "gcc/lto/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ab96cc5b4dd093b769a909e2245da822c4f8e877/gcc%2Flto%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ab96cc5b4dd093b769a909e2245da822c4f8e877/gcc%2Flto%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flto%2FChangeLog?ref=ab96cc5b4dd093b769a909e2245da822c4f8e877", "patch": "@@ -1,3 +1,7 @@\n+2012-07-24  Jan Hubicka  <jh@suse.cz>\n+\n+\t* lto.c (read_cgraph_and_symbols): Use input_symtab.\n+\n 2012-07-24  Uros Bizjak  <ubizjak@gmail.com>\n \n \t* lto-tree.h (lang_decl): Add variable_size GTY option."}, {"sha": "bd91c391fd142a12fecc41debdbce9c366a1d26b", "filename": "gcc/lto/lto.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ab96cc5b4dd093b769a909e2245da822c4f8e877/gcc%2Flto%2Flto.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ab96cc5b4dd093b769a909e2245da822c4f8e877/gcc%2Flto%2Flto.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flto%2Flto.c?ref=ab96cc5b4dd093b769a909e2245da822c4f8e877", "patch": "@@ -1807,8 +1807,8 @@ read_cgraph_and_symbols (unsigned nfiles, const char **fnames)\n     fprintf (stderr, \"\\nReading the callgraph\\n\");\n \n   timevar_push (TV_IPA_LTO_CGRAPH_IO);\n-  /* Read the callgraph.  */\n-  input_cgraph ();\n+  /* Read the symtab.  */\n+  input_symtab ();\n   timevar_pop (TV_IPA_LTO_CGRAPH_IO);\n \n   if (!quiet_flag)"}]}