{"sha": "28f2a080cc27531a8c78aec9f44aeff4961c2a4c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjhmMmEwODBjYzI3NTMxYThjNzhhZWM5ZjQ0YWVmZjQ5NjFjMmE0Yw==", "commit": {"author": {"name": "Harald Anlauf", "email": "anlauf@gmx.de", "date": "2020-07-21T19:37:30Z"}, "committer": {"name": "Harald Anlauf", "email": "anlauf@gmx.de", "date": "2020-07-21T19:37:30Z"}, "message": "PR fortran/89574 - ICE in conv_function_val, at fortran/trans-expr.c:3792\n\nWhen checking for an external procedure from the same file, do not\nconsider symbols from different modules.\n\ngcc/fortran/\n\tPR fortran/89574\n\t* trans-decl.c (gfc_get_extern_function_decl): Check whether a\n\tsymbol belongs to a different module.", "tree": {"sha": "405b2e48d96d5082075e159f946027ce292d2312", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/405b2e48d96d5082075e159f946027ce292d2312"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/28f2a080cc27531a8c78aec9f44aeff4961c2a4c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/28f2a080cc27531a8c78aec9f44aeff4961c2a4c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/28f2a080cc27531a8c78aec9f44aeff4961c2a4c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/28f2a080cc27531a8c78aec9f44aeff4961c2a4c/comments", "author": {"login": "harald-anlauf", "id": 90786862, "node_id": "MDQ6VXNlcjkwNzg2ODYy", "avatar_url": "https://avatars.githubusercontent.com/u/90786862?v=4", "gravatar_id": "", "url": "https://api.github.com/users/harald-anlauf", "html_url": "https://github.com/harald-anlauf", "followers_url": "https://api.github.com/users/harald-anlauf/followers", "following_url": "https://api.github.com/users/harald-anlauf/following{/other_user}", "gists_url": "https://api.github.com/users/harald-anlauf/gists{/gist_id}", "starred_url": "https://api.github.com/users/harald-anlauf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/harald-anlauf/subscriptions", "organizations_url": "https://api.github.com/users/harald-anlauf/orgs", "repos_url": "https://api.github.com/users/harald-anlauf/repos", "events_url": "https://api.github.com/users/harald-anlauf/events{/privacy}", "received_events_url": "https://api.github.com/users/harald-anlauf/received_events", "type": "User", "site_admin": false}, "committer": {"login": "harald-anlauf", "id": 90786862, "node_id": "MDQ6VXNlcjkwNzg2ODYy", "avatar_url": "https://avatars.githubusercontent.com/u/90786862?v=4", "gravatar_id": "", "url": "https://api.github.com/users/harald-anlauf", "html_url": "https://github.com/harald-anlauf", "followers_url": "https://api.github.com/users/harald-anlauf/followers", "following_url": "https://api.github.com/users/harald-anlauf/following{/other_user}", "gists_url": "https://api.github.com/users/harald-anlauf/gists{/gist_id}", "starred_url": "https://api.github.com/users/harald-anlauf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/harald-anlauf/subscriptions", "organizations_url": "https://api.github.com/users/harald-anlauf/orgs", "repos_url": "https://api.github.com/users/harald-anlauf/repos", "events_url": "https://api.github.com/users/harald-anlauf/events{/privacy}", "received_events_url": "https://api.github.com/users/harald-anlauf/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "02363d5fdb862a11e6e65ac5b0d1f5ee0c422dc3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/02363d5fdb862a11e6e65ac5b0d1f5ee0c422dc3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/02363d5fdb862a11e6e65ac5b0d1f5ee0c422dc3"}], "stats": {"total": 36, "additions": 35, "deletions": 1}, "files": [{"sha": "45a739ac860ae6a0375c37c5426efd2df23ccb3c", "filename": "gcc/fortran/trans-decl.c", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/28f2a080cc27531a8c78aec9f44aeff4961c2a4c/gcc%2Ffortran%2Ftrans-decl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/28f2a080cc27531a8c78aec9f44aeff4961c2a4c/gcc%2Ffortran%2Ftrans-decl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-decl.c?ref=28f2a080cc27531a8c78aec9f44aeff4961c2a4c", "patch": "@@ -2090,12 +2090,17 @@ gfc_get_extern_function_decl (gfc_symbol * sym, gfc_actual_arglist *actual_args)\n       if (gsym && !gsym->bind_c)\n \tgsym = NULL;\n     }\n-  else\n+  else if (sym->module == NULL)\n     {\n       gsym = gfc_find_gsymbol (gfc_gsym_root, sym->name);\n       if (gsym && gsym->bind_c)\n \tgsym = NULL;\n     }\n+  else\n+    {\n+      /* Procedure from a different module.  */\n+      gsym = NULL;\n+    }\n \n   if (gsym && !gsym->defined)\n     gsym = NULL;"}, {"sha": "48dd0680a48d082b2eeb230141d04b1144357d41", "filename": "gcc/testsuite/gfortran.dg/pr89574.f90", "status": "added", "additions": 29, "deletions": 0, "changes": 29, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/28f2a080cc27531a8c78aec9f44aeff4961c2a4c/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr89574.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/28f2a080cc27531a8c78aec9f44aeff4961c2a4c/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr89574.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr89574.f90?ref=28f2a080cc27531a8c78aec9f44aeff4961c2a4c", "patch": "@@ -0,0 +1,29 @@\n+! { dg-do compile }\n+! PR fortran/89574 - ICE in conv_function_val, at fortran/trans-expr.c:3792\n+\n+module mod1\n+contains\n+  subroutine init\n+  end subroutine\n+end module\n+\n+module mod2\n+contains\n+  subroutine init\n+  end subroutine\n+end module\n+\n+module init\n+  use mod1, only : test_init1 => init\n+  use mod2, only : test_init2 => init\n+  implicit none\n+contains\n+  subroutine sub\n+    call test_init1\n+    call test_init2\n+    call init\n+  contains\n+    subroutine init\n+    end subroutine\n+  end subroutine\n+end module"}]}