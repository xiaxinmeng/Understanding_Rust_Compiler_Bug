{"sha": "9bc5028273e55ced2622bb5aafa9a70cde7003b7", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWJjNTAyODI3M2U1NWNlZDI2MjJiYjVhYWZhOWE3MGNkZTcwMDNiNw==", "commit": {"author": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2015-09-24T15:46:24Z"}, "committer": {"name": "Jonathan Wakely", "email": "redi@gcc.gnu.org", "date": "2015-09-24T15:46:24Z"}, "message": "Leave moved-from std::deque in a valid state\n\n\tPR libstdc++/67707\n\t* include/bits/stl_deque.h (_Deque_base::_M_move_impl): Initialize\n\tempty object.\n\t* testsuite/23_containers/deque/allocator/move.cc: Check moved-from\n\tdeque.\n\nFrom-SVN: r228090", "tree": {"sha": "fb1da80c898e322f44ac7a772516ad08e0aa4292", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/fb1da80c898e322f44ac7a772516ad08e0aa4292"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9bc5028273e55ced2622bb5aafa9a70cde7003b7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9bc5028273e55ced2622bb5aafa9a70cde7003b7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9bc5028273e55ced2622bb5aafa9a70cde7003b7", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9bc5028273e55ced2622bb5aafa9a70cde7003b7/comments", "author": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4f761179ed60c76164ba5a07f656015b3698734f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4f761179ed60c76164ba5a07f656015b3698734f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4f761179ed60c76164ba5a07f656015b3698734f"}], "stats": {"total": 19, "additions": 19, "deletions": 0}, "files": [{"sha": "24a60508cce981fe1797615d0e759395eabf5398", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9bc5028273e55ced2622bb5aafa9a70cde7003b7/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9bc5028273e55ced2622bb5aafa9a70cde7003b7/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=9bc5028273e55ced2622bb5aafa9a70cde7003b7", "patch": "@@ -1,3 +1,11 @@\n+2015-09-24  Jonathan Wakely  <jwakely@redhat.com>\n+\n+\tPR libstdc++/67707\n+\t* include/bits/stl_deque.h (_Deque_base::_M_move_impl): Initialize\n+\tempty object.\n+\t* testsuite/23_containers/deque/allocator/move.cc: Check moved-from\n+\tdeque.\n+\n 2015-09-23  Jonathan Wakely  <jwakely@redhat.com>\n \n \t* src/filesystem/ops.cc (canonical): Simplify error handling and"}, {"sha": "f81ffd97d33fb1015e3f791be22b4019568fc5fc", "filename": "libstdc++-v3/include/bits/stl_deque.h", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9bc5028273e55ced2622bb5aafa9a70cde7003b7/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstl_deque.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9bc5028273e55ced2622bb5aafa9a70cde7003b7/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstl_deque.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstl_deque.h?ref=9bc5028273e55ced2622bb5aafa9a70cde7003b7", "patch": "@@ -644,6 +644,7 @@ _GLIBCXX_BEGIN_NAMESPACE_CONTAINER\n \t_Tp_alloc_type __sink __attribute((__unused__)) {std::move(__alloc)};\n \t// Create an empty map that allocates using the moved-from allocator.\n \t_Deque_base __empty{__alloc};\n+\t__empty._M_initialize_map(0);\n \t// Now safe to modify current allocator and perform non-throwing swaps.\n \t_Deque_impl __ret{std::move(_M_get_Tp_allocator())};\n \t_M_impl._M_swap_data(__ret);"}, {"sha": "1b8a0e4e2fb2bdda860af637fcb9814c361f9233", "filename": "libstdc++-v3/testsuite/23_containers/deque/allocator/move.cc", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9bc5028273e55ced2622bb5aafa9a70cde7003b7/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Fdeque%2Fallocator%2Fmove.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9bc5028273e55ced2622bb5aafa9a70cde7003b7/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Fdeque%2Fallocator%2Fmove.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Fdeque%2Fallocator%2Fmove.cc?ref=9bc5028273e55ced2622bb5aafa9a70cde7003b7", "patch": "@@ -36,6 +36,11 @@ void test01()\n   VERIFY(1 == v1.get_allocator().get_personality());\n   VERIFY(1 == v2.get_allocator().get_personality());\n   VERIFY( it == v2.begin() );\n+\n+  // PR libstdc++/67707\n+  VERIFY( v1.size() == 0 );\n+  v1 = test_type();\n+  VERIFY( v1.size() == 0 );\n }\n \n void test02()\n@@ -47,6 +52,11 @@ void test02()\n   test_type v2(std::move(v1), alloc_type(2));\n   VERIFY(1 == v1.get_allocator().get_personality());\n   VERIFY(2 == v2.get_allocator().get_personality());\n+\n+  // PR libstdc++/67707\n+  VERIFY( v1.size() == 0 );\n+  v1 = test_type();\n+  VERIFY( v1.size() == 0 );\n }\n \n int main()"}]}