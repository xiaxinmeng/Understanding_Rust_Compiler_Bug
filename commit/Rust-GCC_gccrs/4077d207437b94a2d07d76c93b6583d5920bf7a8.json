{"sha": "4077d207437b94a2d07d76c93b6583d5920bf7a8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDA3N2QyMDc0MzdiOTRhMmQwN2Q3NmM5M2I2NTgzZDU5MjBiZjdhOA==", "commit": {"author": {"name": "Tobias Schl\u00fcter", "email": "tobias.schlueter@physik.uni-muenchen.de", "date": "2004-07-09T21:20:50Z"}, "committer": {"name": "Tobias Schl\u00fcter", "email": "tobi@gcc.gnu.org", "date": "2004-07-09T21:20:50Z"}, "message": "re PR fortran/13201 (PARAMETER variables of nonconstant shape are accepted)\n\nPR fortran/13201\n* resolve.c (resolve_symbol): Verify that the shape of a\nparameter array is not only explicit, but also constant.\n* array.c (gfc_is_compile_time_shape): New function.\n* gfortran.h (gfc_is_compile_time_shape): Add prototype.\n\nFrom-SVN: r84400", "tree": {"sha": "d3352c7a5ccff7412b5e6acf7f1978a0e40eb5b6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d3352c7a5ccff7412b5e6acf7f1978a0e40eb5b6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4077d207437b94a2d07d76c93b6583d5920bf7a8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4077d207437b94a2d07d76c93b6583d5920bf7a8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4077d207437b94a2d07d76c93b6583d5920bf7a8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4077d207437b94a2d07d76c93b6583d5920bf7a8/comments", "author": {"login": "TobiSchluter", "id": 11887541, "node_id": "MDQ6VXNlcjExODg3NTQx", "avatar_url": "https://avatars.githubusercontent.com/u/11887541?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TobiSchluter", "html_url": "https://github.com/TobiSchluter", "followers_url": "https://api.github.com/users/TobiSchluter/followers", "following_url": "https://api.github.com/users/TobiSchluter/following{/other_user}", "gists_url": "https://api.github.com/users/TobiSchluter/gists{/gist_id}", "starred_url": "https://api.github.com/users/TobiSchluter/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TobiSchluter/subscriptions", "organizations_url": "https://api.github.com/users/TobiSchluter/orgs", "repos_url": "https://api.github.com/users/TobiSchluter/repos", "events_url": "https://api.github.com/users/TobiSchluter/events{/privacy}", "received_events_url": "https://api.github.com/users/TobiSchluter/received_events", "type": "User", "site_admin": false}, "committer": {"login": "TobiSchluter", "id": 11887541, "node_id": "MDQ6VXNlcjExODg3NTQx", "avatar_url": "https://avatars.githubusercontent.com/u/11887541?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TobiSchluter", "html_url": "https://github.com/TobiSchluter", "followers_url": "https://api.github.com/users/TobiSchluter/followers", "following_url": "https://api.github.com/users/TobiSchluter/following{/other_user}", "gists_url": "https://api.github.com/users/TobiSchluter/gists{/gist_id}", "starred_url": "https://api.github.com/users/TobiSchluter/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TobiSchluter/subscriptions", "organizations_url": "https://api.github.com/users/TobiSchluter/orgs", "repos_url": "https://api.github.com/users/TobiSchluter/repos", "events_url": "https://api.github.com/users/TobiSchluter/events{/privacy}", "received_events_url": "https://api.github.com/users/TobiSchluter/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1f33f6b4c779919d3dd77be7001747a621de0e6a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1f33f6b4c779919d3dd77be7001747a621de0e6a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1f33f6b4c779919d3dd77be7001747a621de0e6a"}], "stats": {"total": 40, "additions": 35, "deletions": 5}, "files": [{"sha": "26182d4c95b18bc31bf54b587874b79059fcbd85", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4077d207437b94a2d07d76c93b6583d5920bf7a8/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4077d207437b94a2d07d76c93b6583d5920bf7a8/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=4077d207437b94a2d07d76c93b6583d5920bf7a8", "patch": "@@ -1,3 +1,11 @@\n+2004-07-09  Tobias Schlueter  <tobias.schlueter@physik.uni-muenchen.de>\n+\t\n+\tPR fortran/13201\n+\t* resolve.c (resolve_symbol): Verify that the shape of a\n+\tparameter array is not only explicit, but also constant.\n+\t* array.c (gfc_is_compile_time_shape): New function.\n+\t* gfortran.h (gfc_is_compile_time_shape): Add prototype.\n+\n 2004-07-09  Tobias Schlueter  <tobias.schlueter@physik.uni-muenchen.de>\n \n \tPR fortran/15481"}, {"sha": "c7fc8bbccf7cee7c73d0925ea78b03ad6d389ef9", "filename": "gcc/fortran/array.c", "status": "modified", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4077d207437b94a2d07d76c93b6583d5920bf7a8/gcc%2Ffortran%2Farray.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4077d207437b94a2d07d76c93b6583d5920bf7a8/gcc%2Ffortran%2Farray.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Farray.c?ref=4077d207437b94a2d07d76c93b6583d5920bf7a8", "patch": "@@ -1973,3 +1973,22 @@ gfc_find_array_ref (gfc_expr * e)\n \n   return &ref->u.ar;\n }\n+\n+\n+/* Find out if an array shape is known at compile time.  */\n+\n+int\n+gfc_is_compile_time_shape (gfc_array_spec *as)\n+{\n+  int i;\n+\n+  if (as->type != AS_EXPLICIT)\n+    return 0;\n+\n+  for (i = 0; i < as->rank; i++)\n+    if (!gfc_is_constant_expr (as->lower[i])\n+\t|| !gfc_is_constant_expr (as->upper[i]))\n+      return 0;\n+\n+  return 1;\n+}"}, {"sha": "d82d30621d756d982aa7ada205855ecacdcdf257", "filename": "gcc/fortran/gfortran.h", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4077d207437b94a2d07d76c93b6583d5920bf7a8/gcc%2Ffortran%2Fgfortran.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4077d207437b94a2d07d76c93b6583d5920bf7a8/gcc%2Ffortran%2Fgfortran.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fgfortran.h?ref=4077d207437b94a2d07d76c93b6583d5920bf7a8", "patch": "@@ -1645,6 +1645,7 @@ void gfc_insert_constructor (gfc_expr *, gfc_constructor *);\n gfc_constructor *gfc_get_constructor (void);\n tree gfc_conv_array_initializer (tree type, gfc_expr * expr);\n try spec_size (gfc_array_spec *, mpz_t *);\n+int gfc_is_compile_time_shape (gfc_array_spec *);\n \n /* interface.c -- FIXME: some of these should be in symbol.c */\n void gfc_free_interface (gfc_interface *);"}, {"sha": "81df9ef03f8e4e5dc16c7b4c7f2659b6017a8228", "filename": "gcc/fortran/resolve.c", "status": "modified", "additions": 7, "deletions": 5, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4077d207437b94a2d07d76c93b6583d5920bf7a8/gcc%2Ffortran%2Fresolve.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4077d207437b94a2d07d76c93b6583d5920bf7a8/gcc%2Ffortran%2Fresolve.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fresolve.c?ref=4077d207437b94a2d07d76c93b6583d5920bf7a8", "patch": "@@ -3745,12 +3745,14 @@ resolve_symbol (gfc_symbol * sym)\n       return;\n     }\n \n-  if (sym->attr.flavor == FL_PARAMETER\n-      && sym->as != NULL && sym->as->type != AS_EXPLICIT)\n+  /* A parameter array's shape needs to be constant.  */\n+\n+  if (sym->attr.flavor == FL_PARAMETER && sym->as != NULL \n+      && !gfc_is_compile_time_shape (sym->as))\n     {\n-      gfc_error (\"Parameter array '%s' at %L must have an explicit shape\",\n-\t\t sym->name, &sym->declared_at);\n-      return;\n+      gfc_error (\"Parameter array '%s' at %L cannot be automatic \"\n+\t\t \"or assumed shape\", sym->name, &sym->declared_at);\n+\t  return;\n     }\n \n   /* Make sure that character string variables with assumed length are"}]}