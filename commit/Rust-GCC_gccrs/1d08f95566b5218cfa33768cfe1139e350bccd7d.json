{"sha": "1d08f95566b5218cfa33768cfe1139e350bccd7d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWQwOGY5NTU2NmI1MjE4Y2ZhMzM3NjhjZmUxMTM5ZTM1MGJjY2Q3ZA==", "commit": {"author": {"name": "Richard Guenther", "email": "rguenther@suse.de", "date": "2006-10-31T09:08:11Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2006-10-31T09:08:11Z"}, "message": "i386.md (asindf2, [...]): Conditionalize expansion on !optimize_size.\n\n2006-10-31  Richard Guenther  <rguenther@suse.de>\n\n\t* config/i386/i386.md (asindf2, asinsf2, asinxf2, acosdf2,\n\tacossf2, acosxf2, log1psf2, log1pdf2, log1pxf2, ilogbsi2,\n\texpsf2, expdf2, expxf2, exp10sf2, exp10df2, exp10xf2,\n\texp2sf2, exp2df2, exp2xf2, expm1df2, expm1sf2, expm1xf2,\n\tldexpdf3, ldexpsf3, ldexpxf3, rintxf2, rintdf2, rintsf2,\n\tlround<mode>di2, lround<mode>si2, floorxf2, floordf2, floorsf2,\n\tlfloor<mode>di2, lfloor<mode>si2, ceilxf2, ceildf2, ceilsf2,\n\tbtruncxf2, btruncdf2, btruncsf2): Conditionalize expansion on\n\t!optimize_size.\n\nFrom-SVN: r118221", "tree": {"sha": "4c60eba71206743fea3f38a2445e73ac93898a64", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4c60eba71206743fea3f38a2445e73ac93898a64"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1d08f95566b5218cfa33768cfe1139e350bccd7d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1d08f95566b5218cfa33768cfe1139e350bccd7d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1d08f95566b5218cfa33768cfe1139e350bccd7d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1d08f95566b5218cfa33768cfe1139e350bccd7d/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "dd5797cc36028b51596c88d0b5ecc1f0a2902488", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dd5797cc36028b51596c88d0b5ecc1f0a2902488", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dd5797cc36028b51596c88d0b5ecc1f0a2902488"}], "stats": {"total": 204, "additions": 109, "deletions": 95}, "files": [{"sha": "3c037f0733fc37cc4d6ae3bd898ddee3757f1ef4", "filename": "gcc/ChangeLog", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1d08f95566b5218cfa33768cfe1139e350bccd7d/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1d08f95566b5218cfa33768cfe1139e350bccd7d/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=1d08f95566b5218cfa33768cfe1139e350bccd7d", "patch": "@@ -1,3 +1,15 @@\n+2006-10-31  Richard Guenther  <rguenther@suse.de>\n+\n+\t* config/i386/i386.md (asindf2, asinsf2, asinxf2, acosdf2,\n+\tacossf2, acosxf2, log1psf2, log1pdf2, log1pxf2, ilogbsi2,\n+\texpsf2, expdf2, expxf2, exp10sf2, exp10df2, exp10xf2,\n+\texp2sf2, exp2df2, exp2xf2, expm1df2, expm1sf2, expm1xf2,\n+\tldexpdf3, ldexpsf3, ldexpxf3, rintxf2, rintdf2, rintsf2,\n+\tlround<mode>di2, lround<mode>si2, floorxf2, floordf2, floorsf2,\n+\tlfloor<mode>di2, lfloor<mode>si2, ceilxf2, ceildf2, ceilsf2,\n+\tbtruncxf2, btruncdf2, btruncsf2): Conditionalize expansion on\n+\t!optimize_size.\n+\n 2006-10-31  Steven Bosscher  <steven@gcc.gnu.org>\n \n \t* opts.c (decode_options): Disable CSE skip blocks."}, {"sha": "1b9e23410cd7b777ada3c4e0743090536d4f892c", "filename": "gcc/config/i386/i386.md", "status": "modified", "additions": 97, "deletions": 95, "changes": 192, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1d08f95566b5218cfa33768cfe1139e350bccd7d/gcc%2Fconfig%2Fi386%2Fi386.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1d08f95566b5218cfa33768cfe1139e350bccd7d/gcc%2Fconfig%2Fi386%2Fi386.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386.md?ref=1d08f95566b5218cfa33768cfe1139e350bccd7d", "patch": "@@ -16262,7 +16262,7 @@\n \t(float_truncate:DF (match_dup 7)))]\n   \"TARGET_USE_FANCY_MATH_387\n    && (!(TARGET_SSE2 && TARGET_SSE_MATH) || TARGET_MIX_SSE_I387)\n-   && flag_unsafe_math_optimizations\"\n+   && flag_unsafe_math_optimizations && !optimize_size\"\n {\n   int i;\n \n@@ -16286,7 +16286,7 @@\n \t(float_truncate:SF (match_dup 7)))]\n   \"TARGET_USE_FANCY_MATH_387\n    && (!TARGET_SSE_MATH || TARGET_MIX_SSE_I387)\n-   && flag_unsafe_math_optimizations\"\n+   && flag_unsafe_math_optimizations && !optimize_size\"\n {\n   int i;\n \n@@ -16307,7 +16307,7 @@\n \t\t\t      UNSPEC_FPATAN))\n    \t      (clobber (match_scratch:XF 6 \"\"))])]\n   \"TARGET_USE_FANCY_MATH_387\n-   && flag_unsafe_math_optimizations\"\n+   && flag_unsafe_math_optimizations && !optimize_size\"\n {\n   int i;\n \n@@ -16331,7 +16331,7 @@\n \t(float_truncate:DF (match_dup 7)))]\n   \"TARGET_USE_FANCY_MATH_387\n    && (!(TARGET_SSE2 && TARGET_SSE_MATH) || TARGET_MIX_SSE_I387)\n-   && flag_unsafe_math_optimizations\"\n+   && flag_unsafe_math_optimizations && !optimize_size\"\n {\n   int i;\n \n@@ -16355,7 +16355,7 @@\n \t(float_truncate:SF (match_dup 7)))]\n   \"TARGET_USE_FANCY_MATH_387\n    && (!TARGET_SSE_MATH || TARGET_MIX_SSE_I387)\n-   && flag_unsafe_math_optimizations\"\n+   && flag_unsafe_math_optimizations && !optimize_size\"\n {\n   int i;\n \n@@ -16376,7 +16376,7 @@\n \t\t\t      UNSPEC_FPATAN))\n    \t      (clobber (match_scratch:XF 6 \"\"))])]\n   \"TARGET_USE_FANCY_MATH_387\n-   && flag_unsafe_math_optimizations\"\n+   && flag_unsafe_math_optimizations && !optimize_size\"\n {\n   int i;\n \n@@ -16589,7 +16589,7 @@\n    (use (match_operand:SF 1 \"register_operand\" \"\"))]\n   \"TARGET_USE_FANCY_MATH_387\n    && (!TARGET_SSE_MATH || TARGET_MIX_SSE_I387)\n-   && flag_unsafe_math_optimizations\"\n+   && flag_unsafe_math_optimizations && !optimize_size\"\n {\n   rtx op0 = gen_reg_rtx (XFmode);\n   rtx op1 = gen_reg_rtx (XFmode);\n@@ -16605,7 +16605,7 @@\n    (use (match_operand:DF 1 \"register_operand\" \"\"))]\n   \"TARGET_USE_FANCY_MATH_387\n    && (!(TARGET_SSE2 && TARGET_SSE_MATH) || TARGET_MIX_SSE_I387)\n-   && flag_unsafe_math_optimizations\"\n+   && flag_unsafe_math_optimizations && !optimize_size\"\n {\n   rtx op0 = gen_reg_rtx (XFmode);\n   rtx op1 = gen_reg_rtx (XFmode);\n@@ -16620,7 +16620,7 @@\n   [(use (match_operand:XF 0 \"register_operand\" \"\"))\n    (use (match_operand:XF 1 \"register_operand\" \"\"))]\n   \"TARGET_USE_FANCY_MATH_387\n-   && flag_unsafe_math_optimizations\"\n+   && flag_unsafe_math_optimizations && !optimize_size\"\n {\n   ix86_emit_i387_log1p (operands[0], operands[1]);\n   DONE;\n@@ -16697,7 +16697,7 @@\n \t      (clobber (reg:CC FLAGS_REG))])]\n   \"TARGET_USE_FANCY_MATH_387\n    && (!TARGET_SSE_MATH || TARGET_MIX_SSE_I387)\n-   && flag_unsafe_math_optimizations\"\n+   && flag_unsafe_math_optimizations && !optimize_size\"\n {\n   operands[2] = gen_reg_rtx (XFmode);\n   operands[3] = gen_reg_rtx (XFmode);\n@@ -16745,7 +16745,7 @@\n \t(float_truncate:SF (match_dup 10)))]\n   \"TARGET_USE_FANCY_MATH_387\n    && (!TARGET_SSE_MATH || TARGET_MIX_SSE_I387)\n-   && flag_unsafe_math_optimizations\"\n+   && flag_unsafe_math_optimizations && !optimize_size\"\n {\n   rtx temp;\n   int i;\n@@ -16775,7 +16775,7 @@\n \t(float_truncate:DF (match_dup 10)))]\n   \"TARGET_USE_FANCY_MATH_387\n    && (!(TARGET_SSE2 && TARGET_SSE_MATH) || TARGET_MIX_SSE_I387)\n-   && flag_unsafe_math_optimizations\"\n+   && flag_unsafe_math_optimizations && !optimize_size\"\n {\n   rtx temp;\n   int i;\n@@ -16801,7 +16801,7 @@\n \t\t   (unspec:XF [(match_dup 8) (match_dup 4)]\n \t\t\t      UNSPEC_FSCALE_EXP))])]\n   \"TARGET_USE_FANCY_MATH_387\n-   && flag_unsafe_math_optimizations\"\n+   && flag_unsafe_math_optimizations && !optimize_size\"\n {\n   rtx temp;\n   int i;\n@@ -16831,7 +16831,7 @@\n \t(float_truncate:SF (match_dup 10)))]\n   \"TARGET_USE_FANCY_MATH_387\n    && (!TARGET_SSE_MATH || TARGET_MIX_SSE_I387)\n-   && flag_unsafe_math_optimizations\"\n+   && flag_unsafe_math_optimizations && !optimize_size\"\n {\n   rtx temp;\n   int i;\n@@ -16861,7 +16861,7 @@\n \t(float_truncate:DF (match_dup 10)))]\n   \"TARGET_USE_FANCY_MATH_387\n    && (!(TARGET_SSE2 && TARGET_SSE_MATH) || TARGET_MIX_SSE_I387)\n-   && flag_unsafe_math_optimizations\"\n+   && flag_unsafe_math_optimizations && !optimize_size\"\n {\n   rtx temp;\n   int i;\n@@ -16887,7 +16887,7 @@\n \t\t   (unspec:XF [(match_dup 8) (match_dup 4)]\n \t\t\t      UNSPEC_FSCALE_EXP))])]\n   \"TARGET_USE_FANCY_MATH_387\n-   && flag_unsafe_math_optimizations\"\n+   && flag_unsafe_math_optimizations && !optimize_size\"\n {\n   rtx temp;\n   int i;\n@@ -16916,7 +16916,7 @@\n \t(float_truncate:SF (match_dup 8)))]\n   \"TARGET_USE_FANCY_MATH_387\n    && (!TARGET_SSE_MATH || TARGET_MIX_SSE_I387)\n-   && flag_unsafe_math_optimizations\"\n+   && flag_unsafe_math_optimizations && !optimize_size\"\n {\n   int i;\n \n@@ -16942,7 +16942,7 @@\n \t(float_truncate:DF (match_dup 8)))]\n   \"TARGET_USE_FANCY_MATH_387\n    && (!(TARGET_SSE2 && TARGET_SSE_MATH) || TARGET_MIX_SSE_I387)\n-   && flag_unsafe_math_optimizations\"\n+   && flag_unsafe_math_optimizations && !optimize_size\"\n {\n   int i;\n \n@@ -16964,7 +16964,7 @@\n \t\t   (unspec:XF [(match_dup 7) (match_dup 3)]\n \t\t\t      UNSPEC_FSCALE_EXP))])]\n   \"TARGET_USE_FANCY_MATH_387\n-   && flag_unsafe_math_optimizations\"\n+   && flag_unsafe_math_optimizations && !optimize_size\"\n {\n   int i;\n \n@@ -16998,7 +16998,7 @@\n \t(float_truncate:DF (match_dup 14)))]\n   \"TARGET_USE_FANCY_MATH_387\n    && (!(TARGET_SSE2 && TARGET_SSE_MATH) || TARGET_MIX_SSE_I387)\n-   && flag_unsafe_math_optimizations\"\n+   && flag_unsafe_math_optimizations && !optimize_size\"\n {\n   rtx temp;\n   int i;\n@@ -17035,7 +17035,7 @@\n \t(float_truncate:SF (match_dup 14)))]\n   \"TARGET_USE_FANCY_MATH_387\n    && (!TARGET_SSE_MATH || TARGET_MIX_SSE_I387)\n-   && flag_unsafe_math_optimizations\"\n+   && flag_unsafe_math_optimizations && !optimize_size\"\n {\n   rtx temp;\n   int i;\n@@ -17069,7 +17069,7 @@\n    (set (match_operand:XF 0 \"register_operand\" \"\")\n \t(plus:XF (match_dup 12) (match_dup 7)))]\n   \"TARGET_USE_FANCY_MATH_387\n-   && flag_unsafe_math_optimizations\"\n+   && flag_unsafe_math_optimizations && !optimize_size\"\n {\n   rtx temp;\n   int i;\n@@ -17096,7 +17096,7 @@\n \t(float_truncate:DF (match_dup 5)))]\n   \"TARGET_USE_FANCY_MATH_387\n    && (!(TARGET_SSE2 && TARGET_SSE_MATH) || TARGET_MIX_SSE_I387)\n-   && flag_unsafe_math_optimizations\"\n+   && flag_unsafe_math_optimizations && !optimize_size\"\n {\n   int i;\n \n@@ -17119,7 +17119,7 @@\n \t(float_truncate:SF (match_dup 5)))]\n   \"TARGET_USE_FANCY_MATH_387\n    && (!TARGET_SSE_MATH || TARGET_MIX_SSE_I387)\n-   && flag_unsafe_math_optimizations\"\n+   && flag_unsafe_math_optimizations && !optimize_size\"\n {\n   int i;\n \n@@ -17138,7 +17138,7 @@\n \t\t   (unspec:XF [(match_dup 1) (match_dup 3)]\n \t\t\t      UNSPEC_FSCALE_EXP))])]\n   \"TARGET_USE_FANCY_MATH_387\n-   && flag_unsafe_math_optimizations\"\n+   && flag_unsafe_math_optimizations && !optimize_size\"\n {\n   int i;\n \n@@ -17164,20 +17164,22 @@\n     && (!(TARGET_SSE2 && TARGET_SSE_MATH) || TARGET_MIX_SSE_I387)\n     && flag_unsafe_math_optimizations)\n    || (SSE_FLOAT_MODE_P (DFmode) && TARGET_SSE_MATH\n-       && !flag_trapping_math)\"\n+       && !flag_trapping_math\n+       && !optimize_size)\"\n {\n   if (SSE_FLOAT_MODE_P (DFmode) && TARGET_SSE_MATH\n-      && !flag_trapping_math)\n+      && !flag_trapping_math\n+      && !optimize_size)\n     ix86_expand_rint (operand0, operand1);\n   else\n     {\n-  rtx op0 = gen_reg_rtx (XFmode);\n-  rtx op1 = gen_reg_rtx (XFmode);\n+      rtx op0 = gen_reg_rtx (XFmode);\n+      rtx op1 = gen_reg_rtx (XFmode);\n \n-  emit_insn (gen_extenddfxf2 (op1, operands[1]));\n-  emit_insn (gen_frndintxf2 (op0, op1));\n+      emit_insn (gen_extenddfxf2 (op1, operands[1]));\n+      emit_insn (gen_frndintxf2 (op0, op1));\n \n-  emit_insn (gen_truncxfdf2_i387_noop (operands[0], op0));\n+      emit_insn (gen_truncxfdf2_i387_noop (operands[0], op0));\n     }\n   DONE;\n })\n@@ -17189,20 +17191,22 @@\n     && (!TARGET_SSE_MATH || TARGET_MIX_SSE_I387)\n     && flag_unsafe_math_optimizations)\n    || (SSE_FLOAT_MODE_P (SFmode) && TARGET_SSE_MATH\n-       && !flag_trapping_math)\"\n+       && !flag_trapping_math\n+       && !optimize_size)\"\n {\n   if (SSE_FLOAT_MODE_P (SFmode) && TARGET_SSE_MATH\n-      && !flag_trapping_math)\n+      && !flag_trapping_math\n+      && !optimize_size)\n     ix86_expand_rint (operand0, operand1);\n   else\n     {\n-  rtx op0 = gen_reg_rtx (XFmode);\n-  rtx op1 = gen_reg_rtx (XFmode);\n+      rtx op0 = gen_reg_rtx (XFmode);\n+      rtx op1 = gen_reg_rtx (XFmode);\n \n-  emit_insn (gen_extendsfxf2 (op1, operands[1]));\n-  emit_insn (gen_frndintxf2 (op0, op1));\n+      emit_insn (gen_extendsfxf2 (op1, operands[1]));\n+      emit_insn (gen_frndintxf2 (op0, op1));\n \n-  emit_insn (gen_truncxfsf2_i387_noop (operands[0], op0));\n+      emit_insn (gen_truncxfsf2_i387_noop (operands[0], op0));\n     }\n   DONE;\n })\n@@ -17211,7 +17215,7 @@\n   [(use (match_operand:XF 0 \"register_operand\" \"\"))\n    (use (match_operand:XF 1 \"register_operand\" \"\"))]\n   \"TARGET_USE_FANCY_MATH_387\n-   && flag_unsafe_math_optimizations\"\n+   && flag_unsafe_math_optimizations && !optimize_size\"\n {\n   emit_insn (gen_frndintxf2 (operands[0], operands[1]));\n   DONE;\n@@ -17392,7 +17396,8 @@\n   [(match_operand:DI 0 \"nonimmediate_operand\" \"\")\n    (match_operand:SSEMODEF 1 \"register_operand\" \"\")]\n   \"SSE_FLOAT_MODE_P (<MODE>mode) && TARGET_SSE_MATH && TARGET_64BIT\n-   && !flag_trapping_math && !flag_rounding_math\"\n+   && !flag_trapping_math && !flag_rounding_math\n+   && !optimize_size\"\n {\n   ix86_expand_lround (operand0, operand1);\n   DONE;\n@@ -17402,7 +17407,8 @@\n   [(match_operand:SI 0 \"nonimmediate_operand\" \"\")\n    (match_operand:SSEMODEF 1 \"register_operand\" \"\")]\n   \"SSE_FLOAT_MODE_P (<MODE>mode) && TARGET_SSE_MATH\n-   && !flag_trapping_math && !flag_rounding_math\"\n+   && !flag_trapping_math && !flag_rounding_math\n+   && !optimize_size\"\n {\n   ix86_expand_lround (operand0, operand1);\n   DONE;\n@@ -17451,7 +17457,7 @@\n   [(use (match_operand:XF 0 \"register_operand\" \"\"))\n    (use (match_operand:XF 1 \"register_operand\" \"\"))]\n   \"TARGET_USE_FANCY_MATH_387\n-   && flag_unsafe_math_optimizations\"\n+   && flag_unsafe_math_optimizations && !optimize_size\"\n {\n   emit_insn (gen_frndintxf2_floor (operands[0], operands[1]));\n   DONE;\n@@ -17460,16 +17466,15 @@\n (define_expand \"floordf2\"\n   [(use (match_operand:DF 0 \"register_operand\" \"\"))\n    (use (match_operand:DF 1 \"register_operand\" \"\"))]\n-  \"(TARGET_USE_FANCY_MATH_387\n-    && (!(TARGET_SSE2 && TARGET_SSE_MATH) || TARGET_MIX_SSE_I387)\n-    && flag_unsafe_math_optimizations)\n-   || (SSE_FLOAT_MODE_P (DFmode) && TARGET_SSE_MATH\n-       && !flag_trapping_math\n-       && !optimize_size)\"\n+  \"((TARGET_USE_FANCY_MATH_387\n+     && (!(TARGET_SSE2 && TARGET_SSE_MATH) || TARGET_MIX_SSE_I387)\n+     && flag_unsafe_math_optimizations)\n+    || (SSE_FLOAT_MODE_P (DFmode) && TARGET_SSE_MATH\n+        && !flag_trapping_math))\n+   && !optimize_size\"\n {\n   if (SSE_FLOAT_MODE_P (DFmode) && TARGET_SSE_MATH\n-      && !flag_trapping_math\n-      && !optimize_size)\n+      && !flag_trapping_math)\n     {\n       if (TARGET_64BIT)\n \tix86_expand_floorceil (operand0, operand1, true);\n@@ -17492,16 +17497,15 @@\n (define_expand \"floorsf2\"\n   [(use (match_operand:SF 0 \"register_operand\" \"\"))\n    (use (match_operand:SF 1 \"register_operand\" \"\"))]\n-  \"(TARGET_USE_FANCY_MATH_387\n-    && (!TARGET_SSE_MATH || TARGET_MIX_SSE_I387)\n-    && flag_unsafe_math_optimizations)\n-   || (SSE_FLOAT_MODE_P (SFmode) && TARGET_SSE_MATH\n-       && !flag_trapping_math\n-       && !optimize_size)\"\n+  \"((TARGET_USE_FANCY_MATH_387\n+     && (!TARGET_SSE_MATH || TARGET_MIX_SSE_I387)\n+     && flag_unsafe_math_optimizations)\n+    || (SSE_FLOAT_MODE_P (SFmode) && TARGET_SSE_MATH\n+        && !flag_trapping_math))\n+   && !optimize_size\"\n {\n   if (SSE_FLOAT_MODE_P (SFmode) && TARGET_SSE_MATH\n-      && !flag_trapping_math\n-      && !optimize_size)\n+      && !flag_trapping_math)\n     ix86_expand_floorceil (operand0, operand1, true);\n   else\n     {\n@@ -17678,7 +17682,8 @@\n   [(match_operand:DI 0 \"nonimmediate_operand\" \"\")\n    (match_operand:SSEMODEF 1 \"register_operand\" \"\")]\n   \"SSE_FLOAT_MODE_P (<MODE>mode) && TARGET_SSE_MATH && TARGET_64BIT\n-   && !flag_trapping_math\"\n+   && !flag_trapping_math\n+   && !optimize_size\"\n {\n   ix86_expand_lfloorceil (operand0, operand1, true);\n   DONE;\n@@ -17688,7 +17693,8 @@\n   [(match_operand:SI 0 \"nonimmediate_operand\" \"\")\n    (match_operand:SSEMODEF 1 \"register_operand\" \"\")]\n   \"SSE_FLOAT_MODE_P (<MODE>mode) && TARGET_SSE_MATH\n-   && !flag_trapping_math\"\n+   && !flag_trapping_math\n+   && (!optimize_size || !TARGET_64BIT)\"\n {\n   ix86_expand_lfloorceil (operand0, operand1, true);\n   DONE;\n@@ -17737,7 +17743,7 @@\n   [(use (match_operand:XF 0 \"register_operand\" \"\"))\n    (use (match_operand:XF 1 \"register_operand\" \"\"))]\n   \"TARGET_USE_FANCY_MATH_387\n-   && flag_unsafe_math_optimizations\"\n+   && flag_unsafe_math_optimizations && !optimize_size\"\n {\n   emit_insn (gen_frndintxf2_ceil (operands[0], operands[1]));\n   DONE;\n@@ -17746,16 +17752,15 @@\n (define_expand \"ceildf2\"\n   [(use (match_operand:DF 0 \"register_operand\" \"\"))\n    (use (match_operand:DF 1 \"register_operand\" \"\"))]\n-  \"(TARGET_USE_FANCY_MATH_387\n-    && (!(TARGET_SSE2 && TARGET_SSE_MATH) || TARGET_MIX_SSE_I387)\n-    && flag_unsafe_math_optimizations)\n-   || (SSE_FLOAT_MODE_P (DFmode) && TARGET_SSE_MATH\n-       && !flag_trapping_math\n-       && !optimize_size)\"\n+  \"((TARGET_USE_FANCY_MATH_387\n+     && (!(TARGET_SSE2 && TARGET_SSE_MATH) || TARGET_MIX_SSE_I387)\n+     && flag_unsafe_math_optimizations)\n+    || (SSE_FLOAT_MODE_P (DFmode) && TARGET_SSE_MATH\n+        && !flag_trapping_math))\n+   && !optimize_size\"\n {\n   if (SSE_FLOAT_MODE_P (DFmode) && TARGET_SSE_MATH\n-      && !flag_trapping_math\n-      && !optimize_size)\n+      && !flag_trapping_math)\n     {\n       if (TARGET_64BIT)\n \tix86_expand_floorceil (operand0, operand1, false);\n@@ -17778,16 +17783,15 @@\n (define_expand \"ceilsf2\"\n   [(use (match_operand:SF 0 \"register_operand\" \"\"))\n    (use (match_operand:SF 1 \"register_operand\" \"\"))]\n-  \"(TARGET_USE_FANCY_MATH_387\n-    && (!TARGET_SSE_MATH || TARGET_MIX_SSE_I387)\n-    && flag_unsafe_math_optimizations)\n-   || (SSE_FLOAT_MODE_P (SFmode) && TARGET_SSE_MATH\n-       && !flag_trapping_math\n-       && !optimize_size)\"\n+  \"((TARGET_USE_FANCY_MATH_387\n+     && (!TARGET_SSE_MATH || TARGET_MIX_SSE_I387)\n+     && flag_unsafe_math_optimizations)\n+    || (SSE_FLOAT_MODE_P (SFmode) && TARGET_SSE_MATH\n+        && !flag_trapping_math))\n+   && !optimize_size\"\n {\n   if (SSE_FLOAT_MODE_P (SFmode) && TARGET_SSE_MATH\n-      && !flag_trapping_math\n-      && !optimize_size)\n+      && !flag_trapping_math)\n     ix86_expand_floorceil (operand0, operand1, false);\n   else\n     {\n@@ -18023,7 +18027,7 @@\n   [(use (match_operand:XF 0 \"register_operand\" \"\"))\n    (use (match_operand:XF 1 \"register_operand\" \"\"))]\n   \"TARGET_USE_FANCY_MATH_387\n-   && flag_unsafe_math_optimizations\"\n+   && flag_unsafe_math_optimizations && !optimize_size\"\n {\n   emit_insn (gen_frndintxf2_trunc (operands[0], operands[1]));\n   DONE;\n@@ -18032,16 +18036,15 @@\n (define_expand \"btruncdf2\"\n   [(use (match_operand:DF 0 \"register_operand\" \"\"))\n    (use (match_operand:DF 1 \"register_operand\" \"\"))]\n-  \"(TARGET_USE_FANCY_MATH_387\n-    && (!(TARGET_SSE2 && TARGET_SSE_MATH) || TARGET_MIX_SSE_I387)\n-    && flag_unsafe_math_optimizations)\n-   || (SSE_FLOAT_MODE_P (DFmode) && TARGET_SSE_MATH\n-       && !flag_trapping_math\n-       && !optimize_size)\"\n+  \"((TARGET_USE_FANCY_MATH_387\n+     && (!(TARGET_SSE2 && TARGET_SSE_MATH) || TARGET_MIX_SSE_I387)\n+     && flag_unsafe_math_optimizations)\n+    || (SSE_FLOAT_MODE_P (DFmode) && TARGET_SSE_MATH\n+        && !flag_trapping_math))\n+   && !optimize_size\"\n {\n   if (SSE_FLOAT_MODE_P (DFmode) && TARGET_SSE_MATH\n-      && !flag_trapping_math\n-      && !optimize_size)\n+      && !flag_trapping_math)\n     {\n       if (TARGET_64BIT)\n \tix86_expand_trunc (operand0, operand1);\n@@ -18064,16 +18067,15 @@\n (define_expand \"btruncsf2\"\n   [(use (match_operand:SF 0 \"register_operand\" \"\"))\n    (use (match_operand:SF 1 \"register_operand\" \"\"))]\n-  \"(TARGET_USE_FANCY_MATH_387\n-    && (!TARGET_SSE_MATH || TARGET_MIX_SSE_I387)\n-    && flag_unsafe_math_optimizations)\n-   || (SSE_FLOAT_MODE_P (SFmode) && TARGET_SSE_MATH\n-       && !flag_trapping_math\n-       && !optimize_size)\"\n+  \"((TARGET_USE_FANCY_MATH_387\n+     && (!TARGET_SSE_MATH || TARGET_MIX_SSE_I387)\n+     && flag_unsafe_math_optimizations)\n+    || (SSE_FLOAT_MODE_P (SFmode) && TARGET_SSE_MATH\n+        && !flag_trapping_math))\n+   && !optimize_size\"\n {\n   if (SSE_FLOAT_MODE_P (SFmode) && TARGET_SSE_MATH\n-      && !flag_trapping_math\n-      && !optimize_size)\n+      && !flag_trapping_math)\n     ix86_expand_trunc (operand0, operand1);\n   else\n     {"}]}