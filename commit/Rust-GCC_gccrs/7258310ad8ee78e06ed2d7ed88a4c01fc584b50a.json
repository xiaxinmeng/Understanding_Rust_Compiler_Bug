{"sha": "7258310ad8ee78e06ed2d7ed88a4c01fc584b50a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzI1ODMxMGFkOGVlNzhlMDZlZDJkN2VkODhhNGMwMWZjNTg0YjUwYQ==", "commit": {"author": {"name": "Tom Tromey", "email": "tromey@redhat.com", "date": "2002-03-08T16:31:28Z"}, "committer": {"name": "Tom Tromey", "email": "tromey@gcc.gnu.org", "date": "2002-03-08T16:31:28Z"}, "message": "posix.cc (internal_gettimeofday): New function.\n\n\t* posix.cc (internal_gettimeofday): New function.\n\t(_Jv_select): Use it.\n\nFrom-SVN: r50442", "tree": {"sha": "2bfe80e53394fccad5abf00a040a6681c74858e5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2bfe80e53394fccad5abf00a040a6681c74858e5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7258310ad8ee78e06ed2d7ed88a4c01fc584b50a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7258310ad8ee78e06ed2d7ed88a4c01fc584b50a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7258310ad8ee78e06ed2d7ed88a4c01fc584b50a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7258310ad8ee78e06ed2d7ed88a4c01fc584b50a/comments", "author": null, "committer": null, "parents": [{"sha": "81034129233e4dc9b8c770ab836bda4260652c6a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/81034129233e4dc9b8c770ab836bda4260652c6a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/81034129233e4dc9b8c770ab836bda4260652c6a"}], "stats": {"total": 21, "additions": 19, "deletions": 2}, "files": [{"sha": "39a56566c458a481034f9247e81cbd116a6b34c8", "filename": "libjava/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7258310ad8ee78e06ed2d7ed88a4c01fc584b50a/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7258310ad8ee78e06ed2d7ed88a4c01fc584b50a/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=7258310ad8ee78e06ed2d7ed88a4c01fc584b50a", "patch": "@@ -1,3 +1,8 @@\n+2002-03-08  Tom Tromey  <tromey@redhat.com>\n+\n+\t* posix.cc (internal_gettimeofday): New function.\n+\t(_Jv_select): Use it.\n+\n 2002-03-07  Adam Megacz  <adam@xwt.org>\n \n         * java/net/natPlainSocketImpl.cc: Changed USE_WINSOCK to"}, {"sha": "f4b76962e35f61594632f039a2a927ed2e4848a7", "filename": "libjava/posix.cc", "status": "modified", "additions": 14, "deletions": 2, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7258310ad8ee78e06ed2d7ed88a4c01fc584b50a/libjava%2Fposix.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7258310ad8ee78e06ed2d7ed88a4c01fc584b50a/libjava%2Fposix.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fposix.cc?ref=7258310ad8ee78e06ed2d7ed88a4c01fc584b50a", "patch": "@@ -62,6 +62,18 @@ _Jv_platform_initialize (void)\n #endif\n }\n \n+static inline void\n+internal_gettimeofday (struct timeval *result)\n+{\n+#if defined (HAVE_GETTIMEOFDAY)\n+  gettimeofday (result, NULL);\n+#else\n+  jlong val = _Jv_platform_gettimeofday ();\n+  result->tv_sec = val / 1000;\n+  result->tv_usec = (val % 1000) * 1000;\n+#endif /* HAVE_GETTIMEOFDAY */\n+}\n+\n // A wrapper for select() which ignores EINTR.\n int\n _Jv_select (int n, fd_set *readfds, fd_set  *writefds,\n@@ -72,7 +84,7 @@ _Jv_select (int n, fd_set *readfds, fd_set  *writefds,\n   struct timeval end, delay;\n   if (timeout)\n     {\n-      _Jv_platform_gettimeofday (&end);\n+      internal_gettimeofday (&end);\n       end.tv_usec += timeout->tv_usec;\n       if (end.tv_usec >= 1000000)\n \t{\n@@ -102,7 +114,7 @@ _Jv_select (int n, fd_set *readfds, fd_set  *writefds,\n       struct timeval after;\n       if (timeout)\n \t{\n-\t  _Jv_platform_gettimeofday (&after);\n+\t  internal_gettimeofday (&after);\n \t  // Now compute new timeout argument.\n \t  delay.tv_usec = end.tv_usec - after.tv_usec;\n \t  delay.tv_sec = end.tv_sec - after.tv_sec;"}]}