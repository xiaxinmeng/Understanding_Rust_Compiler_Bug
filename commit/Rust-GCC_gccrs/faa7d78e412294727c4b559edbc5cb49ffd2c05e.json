{"sha": "faa7d78e412294727c4b559edbc5cb49ffd2c05e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZmFhN2Q3OGU0MTIyOTQ3MjdjNGI1NTllZGJjNWNiNDlmZmQyYzA1ZQ==", "commit": {"author": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2015-02-17T12:44:26Z"}, "committer": {"name": "Jonathan Wakely", "email": "redi@gcc.gnu.org", "date": "2015-02-17T12:44:26Z"}, "message": "re PR libstdc++/65085 (Move-assigned empty string corrupt with -D_GLIBCXX_USE_CXX11_ABI=1)\n\n\tPR libstdc++/65085\n\t* include/bits/basic_string.h (basic_string(basic_string&&)): Ensure\n\tempty string gets null-terminated.\n\t* testsuite/21_strings/basic_string/cons/char/65085.cc: New.\n\nFrom-SVN: r220758", "tree": {"sha": "5228babd1f05ec341272c7f28d635d08b639017c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5228babd1f05ec341272c7f28d635d08b639017c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/faa7d78e412294727c4b559edbc5cb49ffd2c05e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/faa7d78e412294727c4b559edbc5cb49ffd2c05e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/faa7d78e412294727c4b559edbc5cb49ffd2c05e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/faa7d78e412294727c4b559edbc5cb49ffd2c05e/comments", "author": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "06e6dc291cfcb3941742b36fb870a1adafcb4412", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/06e6dc291cfcb3941742b36fb870a1adafcb4412", "html_url": "https://github.com/Rust-GCC/gccrs/commit/06e6dc291cfcb3941742b36fb870a1adafcb4412"}], "stats": {"total": 52, "additions": 49, "deletions": 3}, "files": [{"sha": "951bb91838ff8d1c70457383f34a6ce330b70ec9", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/faa7d78e412294727c4b559edbc5cb49ffd2c05e/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/faa7d78e412294727c4b559edbc5cb49ffd2c05e/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=faa7d78e412294727c4b559edbc5cb49ffd2c05e", "patch": "@@ -1,3 +1,10 @@\n+2015-02-17  Jonathan Wakely  <jwakely@redhat.com>\n+\n+\tPR libstdc++/65085\n+\t* include/bits/basic_string.h (basic_string(basic_string&&)): Ensure\n+\tempty string gets null-terminated.\n+\t* testsuite/21_strings/basic_string/cons/char/65085.cc: New.\n+\n 2015-02-13  Matthew Wahab  <matthew.wahab@arm.com>\n \n \t* testsuite/28_regex/traits/char/isctype.cc (test01): Fix"}, {"sha": "3b2603fc650792051300861a7a8f915fecb62f9e", "filename": "libstdc++-v3/include/bits/basic_string.h", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/faa7d78e412294727c4b559edbc5cb49ffd2c05e/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fbasic_string.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/faa7d78e412294727c4b559edbc5cb49ffd2c05e/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fbasic_string.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fbasic_string.h?ref=faa7d78e412294727c4b559edbc5cb49ffd2c05e", "patch": "@@ -476,9 +476,8 @@ _GLIBCXX_BEGIN_NAMESPACE_CXX11\n       {\n \tif (__str._M_is_local())\n \t  {\n-\t    if (__str.length())\n-\t      traits_type::copy(_M_local_buf, __str._M_local_buf,\n-\t\t\t\t_S_local_capacity + 1);\n+\t    traits_type::copy(_M_local_buf, __str._M_local_buf,\n+\t\t\t      _S_local_capacity + 1);\n \t  }\n \telse\n \t  {"}, {"sha": "609f7be3d80907dd9a277f72964eecc6f923ae0b", "filename": "libstdc++-v3/testsuite/21_strings/basic_string/cons/char/65085.cc", "status": "added", "additions": 40, "deletions": 0, "changes": 40, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/faa7d78e412294727c4b559edbc5cb49ffd2c05e/libstdc%2B%2B-v3%2Ftestsuite%2F21_strings%2Fbasic_string%2Fcons%2Fchar%2F65085.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/faa7d78e412294727c4b559edbc5cb49ffd2c05e/libstdc%2B%2B-v3%2Ftestsuite%2F21_strings%2Fbasic_string%2Fcons%2Fchar%2F65085.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F21_strings%2Fbasic_string%2Fcons%2Fchar%2F65085.cc?ref=faa7d78e412294727c4b559edbc5cb49ffd2c05e", "patch": "@@ -0,0 +1,40 @@\n+// Copyright (C) 2015 Free Software Foundation, Inc.\n+//\n+// This file is part of the GNU ISO C++ Library.  This library is free\n+// software; you can redistribute it and/or modify it under the\n+// terms of the GNU General Public License as published by the\n+// Free Software Foundation; either version 3, or (at your option)\n+// any later version.\n+\n+// This library is distributed in the hope that it will be useful,\n+// but WITHOUT ANY WARRANTY; without even the implied warranty of\n+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+// GNU General Public License for more details.\n+\n+// You should have received a copy of the GNU General Public License along\n+// with this library; see the file COPYING3.  If not see\n+// <http://www.gnu.org/licenses/>.\n+\n+// { dg-options \"-std=gnu++11\" }\n+\n+#include <string>\n+#include <new>\n+#include <cstring>\n+#include <testsuite_hooks.h>\n+\n+void\n+test01()\n+{\n+  std::string s;\n+  char buf[sizeof(std::string)];\n+  std::memset(buf, 0xff, sizeof(buf));\n+  std::string* p = ::new(buf) std::string(std::move(s));\n+  VERIFY((*p)[0] == '\\0');\n+  p->~basic_string();\n+}\n+\n+int\n+main()\n+{\n+  test01();\n+}"}]}