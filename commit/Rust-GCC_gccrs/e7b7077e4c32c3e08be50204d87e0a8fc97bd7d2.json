{"sha": "e7b7077e4c32c3e08be50204d87e0a8fc97bd7d2", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTdiNzA3N2U0YzMyYzNlMDhiZTUwMjA0ZDg3ZTBhOGZjOTdiZDdkMg==", "commit": {"author": {"name": "Joern Rennecke", "email": "joern.rennecke@embecosm.com", "date": "2014-05-07T13:21:59Z"}, "committer": {"name": "Joern Rennecke", "email": "amylaar@gcc.gnu.org", "date": "2014-05-07T13:21:59Z"}, "message": "epiphany.c (epiphany_handle_interrupt_attribute): Emit an error when the function has arguments.\n\ngcc:\n        * config/epiphany/epiphany.c (epiphany_handle_interrupt_attribute):\n        Emit an error when the function has arguments.\ngcc/testsuite:\n        * gcc.target/epiphany/isr-arg.c: New file.\n\nFrom-SVN: r210157", "tree": {"sha": "b50942c94d70242b6946f591159d1178c4a67ea2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b50942c94d70242b6946f591159d1178c4a67ea2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e7b7077e4c32c3e08be50204d87e0a8fc97bd7d2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e7b7077e4c32c3e08be50204d87e0a8fc97bd7d2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e7b7077e4c32c3e08be50204d87e0a8fc97bd7d2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e7b7077e4c32c3e08be50204d87e0a8fc97bd7d2/comments", "author": {"login": "amylaar", "id": 1663475, "node_id": "MDQ6VXNlcjE2NjM0NzU=", "avatar_url": "https://avatars.githubusercontent.com/u/1663475?v=4", "gravatar_id": "", "url": "https://api.github.com/users/amylaar", "html_url": "https://github.com/amylaar", "followers_url": "https://api.github.com/users/amylaar/followers", "following_url": "https://api.github.com/users/amylaar/following{/other_user}", "gists_url": "https://api.github.com/users/amylaar/gists{/gist_id}", "starred_url": "https://api.github.com/users/amylaar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/amylaar/subscriptions", "organizations_url": "https://api.github.com/users/amylaar/orgs", "repos_url": "https://api.github.com/users/amylaar/repos", "events_url": "https://api.github.com/users/amylaar/events{/privacy}", "received_events_url": "https://api.github.com/users/amylaar/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "c4597c1dd9561a6128fe68247ed0074a27562a4a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c4597c1dd9561a6128fe68247ed0074a27562a4a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c4597c1dd9561a6128fe68247ed0074a27562a4a"}], "stats": {"total": 37, "additions": 34, "deletions": 3}, "files": [{"sha": "4532bd52262a251adac3579b09568bf1a0b3881b", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e7b7077e4c32c3e08be50204d87e0a8fc97bd7d2/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e7b7077e4c32c3e08be50204d87e0a8fc97bd7d2/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=e7b7077e4c32c3e08be50204d87e0a8fc97bd7d2", "patch": "@@ -1,3 +1,8 @@\n+2014-05-07  Joern Rennecke  <joern.rennecke@embecosm.com>\n+\n+\t* config/epiphany/epiphany.c (epiphany_handle_interrupt_attribute):\n+\tEmit an error when the function has arguments.\n+\n 2014-05-07  Thomas Schwinge  <thomas@codesourcery.com>\n \n \t* cfgloop.h (unswitch_loops): Remove."}, {"sha": "ebe6f05302da31c152c6cafe2ff588eb91d8045c", "filename": "gcc/config/epiphany/epiphany.c", "status": "modified", "additions": 16, "deletions": 3, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e7b7077e4c32c3e08be50204d87e0a8fc97bd7d2/gcc%2Fconfig%2Fepiphany%2Fepiphany.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e7b7077e4c32c3e08be50204d87e0a8fc97bd7d2/gcc%2Fconfig%2Fepiphany%2Fepiphany.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fepiphany%2Fepiphany.c?ref=e7b7077e4c32c3e08be50204d87e0a8fc97bd7d2", "patch": "@@ -450,15 +450,28 @@ static const struct attribute_spec epiphany_attribute_table[] =\n /* Handle an \"interrupt\" attribute; arguments as in\n    struct attribute_spec.handler.  */\n static tree\n-epiphany_handle_interrupt_attribute (tree *node ATTRIBUTE_UNUSED,\n-\t\t\t\t     tree name, tree args,\n+epiphany_handle_interrupt_attribute (tree *node, tree name, tree args,\n \t\t\t\t     int flags ATTRIBUTE_UNUSED,\n \t\t\t\t     bool *no_add_attrs)\n {\n   tree value;\n \n   if (!args)\n-    return NULL_TREE;\n+    {\n+      gcc_assert (DECL_P (*node));\n+      tree t = TREE_TYPE (*node);\n+      if (TREE_CODE (t) != FUNCTION_TYPE)\n+\twarning (OPT_Wattributes, \"%qE attribute only applies to functions\",\n+\t\t name);\n+      /* Argument handling and the stack layout for interrupt handlers\n+\t don't mix.  It makes no sense in the first place, so emit an\n+\t error for this.  */\n+      else if (TYPE_ARG_TYPES (t)\n+\t       && TREE_VALUE (TYPE_ARG_TYPES (t)) != void_type_node)\n+\terror_at (DECL_SOURCE_LOCATION (*node),\n+\t\t  \"interrupt handlers cannot have arguments\");\n+      return NULL_TREE;\n+    }\n \n   value = TREE_VALUE (args);\n "}, {"sha": "2925e328728e84e9e59fa8bb953349917d86218b", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e7b7077e4c32c3e08be50204d87e0a8fc97bd7d2/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e7b7077e4c32c3e08be50204d87e0a8fc97bd7d2/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=e7b7077e4c32c3e08be50204d87e0a8fc97bd7d2", "patch": "@@ -1,3 +1,7 @@\n+2014-05-07  Joern Rennecke  <joern.rennecke@embecosm.com>\n+\n+\t* gcc.target/epiphany/isr-arg.c: New file.\n+\n 2014-05-07  Evgeny Stupachenko  <evstupac@gmail.com>\n \n \tPR tree-optimization/52252"}, {"sha": "5a8acc63518229755472f07d19a9e1f2b42cc256", "filename": "gcc/testsuite/gcc.target/epiphany/isr-arg.c", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e7b7077e4c32c3e08be50204d87e0a8fc97bd7d2/gcc%2Ftestsuite%2Fgcc.target%2Fepiphany%2Fisr-arg.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e7b7077e4c32c3e08be50204d87e0a8fc97bd7d2/gcc%2Ftestsuite%2Fgcc.target%2Fepiphany%2Fisr-arg.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fepiphany%2Fisr-arg.c?ref=e7b7077e4c32c3e08be50204d87e0a8fc97bd7d2", "patch": "@@ -0,0 +1,9 @@\n+int *p;\n+\n+void __attribute__((interrupt))\n+isr (int signum) /* { dg-error \"interrupt handlers cannot have arguments\"  } */\n+{\n+  *p = 1;\n+  return;\n+}\n+"}]}