{"sha": "19fc9faaaf98b3c45ede31da2e3cb970ef7b372a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTlmYzlmYWFhZjk4YjNjNDVlZGUzMWRhMmUzY2I5NzBlZjdiMzcyYQ==", "commit": {"author": {"name": "Marek Polacek", "email": "polacek@redhat.com", "date": "2014-05-02T18:09:42Z"}, "committer": {"name": "Marek Polacek", "email": "mpolacek@gcc.gnu.org", "date": "2014-05-02T18:09:42Z"}, "message": "c-typeck.c (c_finish_return): Separate warning_at calls.\n\nc/\n\t* c-typeck.c (c_finish_return): Separate warning_at calls.\ncp/\n\t* typeck.c (maybe_warn_about_returning_address_of_local): Separate\n\twarning_at calls.\n\nFrom-SVN: r210012", "tree": {"sha": "071af8206b3e246f7368ae1b77b50da2d378bf6f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/071af8206b3e246f7368ae1b77b50da2d378bf6f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/19fc9faaaf98b3c45ede31da2e3cb970ef7b372a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/19fc9faaaf98b3c45ede31da2e3cb970ef7b372a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/19fc9faaaf98b3c45ede31da2e3cb970ef7b372a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/19fc9faaaf98b3c45ede31da2e3cb970ef7b372a/comments", "author": {"login": "mpolacek", "id": 10496300, "node_id": "MDQ6VXNlcjEwNDk2MzAw", "avatar_url": "https://avatars.githubusercontent.com/u/10496300?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mpolacek", "html_url": "https://github.com/mpolacek", "followers_url": "https://api.github.com/users/mpolacek/followers", "following_url": "https://api.github.com/users/mpolacek/following{/other_user}", "gists_url": "https://api.github.com/users/mpolacek/gists{/gist_id}", "starred_url": "https://api.github.com/users/mpolacek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mpolacek/subscriptions", "organizations_url": "https://api.github.com/users/mpolacek/orgs", "repos_url": "https://api.github.com/users/mpolacek/repos", "events_url": "https://api.github.com/users/mpolacek/events{/privacy}", "received_events_url": "https://api.github.com/users/mpolacek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "6577374eaa1de4e387f4a67c300133922dd52707", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6577374eaa1de4e387f4a67c300133922dd52707", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6577374eaa1de4e387f4a67c300133922dd52707"}], "stats": {"total": 29, "additions": 22, "deletions": 7}, "files": [{"sha": "b32e4fd196d4d420fb84f538476b43a7e667a304", "filename": "gcc/c/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/19fc9faaaf98b3c45ede31da2e3cb970ef7b372a/gcc%2Fc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/19fc9faaaf98b3c45ede31da2e3cb970ef7b372a/gcc%2Fc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc%2FChangeLog?ref=19fc9faaaf98b3c45ede31da2e3cb970ef7b372a", "patch": "@@ -1,3 +1,7 @@\n+2014-05-02  Marek Polacek  <polacek@redhat.com>\n+\n+\t* c-typeck.c (c_finish_return): Separate warning_at calls.\n+\n 2014-05-02  Marek Polacek  <polacek@redhat.com>\n \n \t* c-tree.h (error_init): Remove declaration."}, {"sha": "f7ad91ed1c76ef78d9c1fcab3953f21627ef469a", "filename": "gcc/c/c-typeck.c", "status": "modified", "additions": 8, "deletions": 4, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/19fc9faaaf98b3c45ede31da2e3cb970ef7b372a/gcc%2Fc%2Fc-typeck.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/19fc9faaaf98b3c45ede31da2e3cb970ef7b372a/gcc%2Fc%2Fc-typeck.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc%2Fc-typeck.c?ref=19fc9faaaf98b3c45ede31da2e3cb970ef7b372a", "patch": "@@ -9273,10 +9273,14 @@ c_finish_return (location_t loc, tree retval, tree origtype)\n \t\t  && !DECL_EXTERNAL (inner)\n \t\t  && !TREE_STATIC (inner)\n \t\t  && DECL_CONTEXT (inner) == current_function_decl)\n-\t\twarning_at (loc,\n-\t\t\t    OPT_Wreturn_local_addr, \"function returns address \"\n-\t\t\t    \"of %s\", TREE_CODE (inner) == LABEL_DECL\n-\t\t\t\t     ? \"label\" : \"local variable\");\n+\t\t{\n+\t\t  if (TREE_CODE (inner) == LABEL_DECL)\n+\t\t    warning_at (loc, OPT_Wreturn_local_addr,\n+\t\t\t\t\"function returns address of label\");\n+\t\t  else\n+\t\t    warning_at (loc, OPT_Wreturn_local_addr,\n+\t\t\t\t\"function returns address of local variable\");\n+\t\t}\n \t      break;\n \n \t    default:"}, {"sha": "7729cb9d8c7281e039279b5b516e889f7a58eb6d", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/19fc9faaaf98b3c45ede31da2e3cb970ef7b372a/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/19fc9faaaf98b3c45ede31da2e3cb970ef7b372a/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=19fc9faaaf98b3c45ede31da2e3cb970ef7b372a", "patch": "@@ -1,3 +1,8 @@\n+2014-05-02  Marek Polacek  <polacek@redhat.com>\n+\n+\t* typeck.c (maybe_warn_about_returning_address_of_local): Separate\n+\twarning_at calls.\n+\n 2014-05-01  Marek Polacek  <polacek@redhat.com>\n \n \tPR c/43395"}, {"sha": "7b28a9a58695b919c89e1cee9a388337ef8c4812", "filename": "gcc/cp/typeck.c", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/19fc9faaaf98b3c45ede31da2e3cb970ef7b372a/gcc%2Fcp%2Ftypeck.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/19fc9faaaf98b3c45ede31da2e3cb970ef7b372a/gcc%2Fcp%2Ftypeck.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ftypeck.c?ref=19fc9faaaf98b3c45ede31da2e3cb970ef7b372a", "patch": "@@ -8309,10 +8309,12 @@ maybe_warn_about_returning_address_of_local (tree retval)\n       if (TREE_CODE (valtype) == REFERENCE_TYPE)\n \twarning (OPT_Wreturn_local_addr, \"reference to local variable %q+D returned\",\n \t\t whats_returned);\n+      else if (TREE_CODE (whats_returned) == LABEL_DECL)\n+\twarning (OPT_Wreturn_local_addr, \"address of label %q+D returned\",\n+\t\t whats_returned);\n       else\n-\twarning (OPT_Wreturn_local_addr, \"address of %s %q+D returned\",\n-\t\t TREE_CODE (whats_returned) == LABEL_DECL\n-\t\t ? \"label\" : \"local variable\", whats_returned);\n+\twarning (OPT_Wreturn_local_addr, \"address of local variable %q+D \"\n+\t\t \"returned\", whats_returned);\n       return;\n     }\n }"}]}