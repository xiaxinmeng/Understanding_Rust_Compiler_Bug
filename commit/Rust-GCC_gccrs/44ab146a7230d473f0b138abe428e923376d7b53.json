{"sha": "44ab146a7230d473f0b138abe428e923376d7b53", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDRhYjE0NmE3MjMwZDQ3M2YwYjEzOGFiZTQyOGU5MjMzNzZkN2I1Mw==", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2016-05-12T07:18:58Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2016-05-12T07:18:58Z"}, "message": "re PR tree-optimization/70986 (ICE on valid code at -O3 on x86_64-linux-gnu in combine_blocks, at tree-if-conv.c:2219)\n\n2016-05-12  Richard Biener  <rguenther@suse.de>\n\n\tPR tree-optimization/70986\n\t* cfganal.c: Include cfgloop.h.\n\t(dfs_find_deadend): Prefer to take edges exiting loops.\n\n\t* gcc.dg/torture/pr70986-1.c: New testcase.\n\t* gcc.dg/torture/pr70986-2.c: Likewise.\n\t* gcc.dg/torture/pr70986-3.c: Likewise.\n\nFrom-SVN: r236158", "tree": {"sha": "6128def514d0e208db50df8ed14b675c2610e908", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6128def514d0e208db50df8ed14b675c2610e908"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/44ab146a7230d473f0b138abe428e923376d7b53", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/44ab146a7230d473f0b138abe428e923376d7b53", "html_url": "https://github.com/Rust-GCC/gccrs/commit/44ab146a7230d473f0b138abe428e923376d7b53", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/44ab146a7230d473f0b138abe428e923376d7b53/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "b5aa474d1e94543a2878bef474dc5c6242711f33", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b5aa474d1e94543a2878bef474dc5c6242711f33", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b5aa474d1e94543a2878bef474dc5c6242711f33"}], "stats": {"total": 90, "additions": 89, "deletions": 1}, "files": [{"sha": "da2a10c0356b33557afd1a5f39bf91707e5fd862", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/44ab146a7230d473f0b138abe428e923376d7b53/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/44ab146a7230d473f0b138abe428e923376d7b53/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=44ab146a7230d473f0b138abe428e923376d7b53", "patch": "@@ -1,3 +1,9 @@\n+2016-05-12  Richard Biener  <rguenther@suse.de>\n+\n+\tPR tree-optimization/70986\n+\t* cfganal.c: Include cfgloop.h.\n+\t(dfs_find_deadend): Prefer to take edges exiting loops.\n+\n 2016-05-11  Bill Schmidt  <wschmidt@linux.vnet.ibm.com>\n \n \t* gcc.target/powerpc/pr70963.c: Require at least power8 at both"}, {"sha": "a4bdef603052c9927b9d7158d740e9ebb26ae044", "filename": "gcc/cfganal.c", "status": "modified", "additions": 16, "deletions": 1, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/44ab146a7230d473f0b138abe428e923376d7b53/gcc%2Fcfganal.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/44ab146a7230d473f0b138abe428e923376d7b53/gcc%2Fcfganal.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcfganal.c?ref=44ab146a7230d473f0b138abe428e923376d7b53", "patch": "@@ -26,6 +26,7 @@ along with GCC; see the file COPYING3.  If not see\n #include \"cfghooks.h\"\n #include \"timevar.h\"\n #include \"cfganal.h\"\n+#include \"cfgloop.h\"\n \n /* Store the data structures necessary for depth-first search.  */\n struct depth_first_search_ds {\n@@ -747,7 +748,21 @@ dfs_find_deadend (basic_block bb)\n           return bb;\n         }\n \n-      bb = EDGE_SUCC (bb, 0)->dest;\n+      /* If we are in an analyzed cycle make sure to try exiting it.\n+         Note this is a heuristic only and expected to work when loop\n+\t fixup is needed as well.  */\n+      if (! bb->loop_father\n+\t  || ! loop_outer (bb->loop_father))\n+\tbb = EDGE_SUCC (bb, 0)->dest;\n+      else\n+\t{\n+\t  edge_iterator ei;\n+\t  edge e;\n+\t  FOR_EACH_EDGE (e, ei, bb->succs)\n+\t    if (loop_exit_edge_p (bb->loop_father, e))\n+\t      break;\n+\t  bb = e ? e->dest : EDGE_SUCC (bb, 0)->dest;\n+\t}\n     }\n \n   gcc_unreachable ();"}, {"sha": "ce5dfea8cba953f5cbde8c5520cf78f5cf1d5d1f", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/44ab146a7230d473f0b138abe428e923376d7b53/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/44ab146a7230d473f0b138abe428e923376d7b53/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=44ab146a7230d473f0b138abe428e923376d7b53", "patch": "@@ -1,3 +1,10 @@\n+2016-05-12  Richard Biener  <rguenther@suse.de>\n+\n+\tPR tree-optimization/70986\n+\t* gcc.dg/torture/pr70986-1.c: New testcase.\n+\t* gcc.dg/torture/pr70986-2.c: Likewise.\n+\t* gcc.dg/torture/pr70986-3.c: Likewise.\n+\n 2016-05-11  Mikhail Maltsev  <maltsevm@gmail.com>\n \n \tPR c/43651"}, {"sha": "4da1f54eef0700d4e74af14c63b1b8bca7149358", "filename": "gcc/testsuite/gcc.dg/torture/pr70986-1.c", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/44ab146a7230d473f0b138abe428e923376d7b53/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr70986-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/44ab146a7230d473f0b138abe428e923376d7b53/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr70986-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr70986-1.c?ref=44ab146a7230d473f0b138abe428e923376d7b53", "patch": "@@ -0,0 +1,22 @@\n+/* { dg-do compile } */\n+\n+int a, g;\n+char b, c;\n+short d, e, f;\n+\n+char\n+fn1 ()\n+{\n+  return a ? a : 1;\n+}\n+\n+void\n+fn2 ()\n+{\n+  char h;\n+  for (; d;)\n+    for (; e; e++)\n+      c = (fn1 () && h) & !(f |= 9 ^ (b > (g = c)));\n+  for (;;)\n+    ;\n+}"}, {"sha": "2f4d2b645e030a031eb70f042acbf356560f24bf", "filename": "gcc/testsuite/gcc.dg/torture/pr70986-2.c", "status": "added", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/44ab146a7230d473f0b138abe428e923376d7b53/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr70986-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/44ab146a7230d473f0b138abe428e923376d7b53/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr70986-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr70986-2.c?ref=44ab146a7230d473f0b138abe428e923376d7b53", "patch": "@@ -0,0 +1,20 @@\n+/* { dg-do compile } */\n+\n+int gi, dg;\n+\n+void\n+fe (void)\n+{\n+  int ka = gi;\n+\n+  for (;;)\n+    {\n+      if (ka != 0)\n+\t{\n+\t  if (dg != 0)\n+\t    gi = 0;\n+\t  ++ka;\n+\t}\n+      ++dg;\n+    }\n+}"}, {"sha": "5b722d590a04a90413e5e39f6f91717433f69733", "filename": "gcc/testsuite/gcc.dg/torture/pr70986-3.c", "status": "added", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/44ab146a7230d473f0b138abe428e923376d7b53/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr70986-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/44ab146a7230d473f0b138abe428e923376d7b53/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr70986-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr70986-3.c?ref=44ab146a7230d473f0b138abe428e923376d7b53", "patch": "@@ -0,0 +1,18 @@\n+/* { dg-do compile } */\n+\n+int a, b;\n+int\n+fn1 (int p1)\n+{\n+  return p1 < 0 ? p1 : a;\n+}\n+\n+void\n+fn2 ()\n+{\n+lbl_100:\n+  b = 1;\n+  for (; b != 21; b = fn1 (b))\n+    ;\n+  goto lbl_100;\n+}"}]}