{"sha": "24c79709800fe1f0213ef441f26fe08e881e5ab5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjRjNzk3MDk4MDBmZTFmMDIxM2VmNDQxZjI2ZmUwOGU4ODFlNWFiNQ==", "commit": {"author": {"name": "Sebastian Pop", "email": "sebastian.pop@amd.com", "date": "2009-11-25T04:58:16Z"}, "committer": {"name": "Sebastian Pop", "email": "spop@gcc.gnu.org", "date": "2009-11-25T04:58:16Z"}, "message": "graphite-poly.c (apply_poly_transforms): Implement the high level driver for flag_loop_block.\n\n2009-10-09  Sebastian Pop  <sebastian.pop@amd.com>\n\n\t* graphite-poly.c (apply_poly_transforms): Implement the high\n\tlevel driver for flag_loop_block.\n\t* tree-ssa-loop.c (gate_graphite_transforms): Remove call to sorry for\n\tflag_loop_block.\n\n\t* gcc.dg/graphite/graphite.exp (DEFAULT_CFLAGS_GRAPHITE_BLOCK): Add\n\t-floop-block.\n\t* gfortran.dg/graphite/graphite.exp (DEFAULT_CFLAGS_GRAPHITE_BLOCK):\n\tAdd -floop-block.\n\nFrom-SVN: r154569", "tree": {"sha": "f6a3de9cab437f1335d5a15c73ead4cf2cf686d0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f6a3de9cab437f1335d5a15c73ead4cf2cf686d0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/24c79709800fe1f0213ef441f26fe08e881e5ab5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/24c79709800fe1f0213ef441f26fe08e881e5ab5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/24c79709800fe1f0213ef441f26fe08e881e5ab5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/24c79709800fe1f0213ef441f26fe08e881e5ab5/comments", "author": null, "committer": {"login": "sebpop", "id": 568397, "node_id": "MDQ6VXNlcjU2ODM5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/568397?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sebpop", "html_url": "https://github.com/sebpop", "followers_url": "https://api.github.com/users/sebpop/followers", "following_url": "https://api.github.com/users/sebpop/following{/other_user}", "gists_url": "https://api.github.com/users/sebpop/gists{/gist_id}", "starred_url": "https://api.github.com/users/sebpop/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sebpop/subscriptions", "organizations_url": "https://api.github.com/users/sebpop/orgs", "repos_url": "https://api.github.com/users/sebpop/repos", "events_url": "https://api.github.com/users/sebpop/events{/privacy}", "received_events_url": "https://api.github.com/users/sebpop/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a0517b76ddeb6fdbc4346a508e98ac842b539694", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a0517b76ddeb6fdbc4346a508e98ac842b539694", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a0517b76ddeb6fdbc4346a508e98ac842b539694"}], "stats": {"total": 44, "additions": 29, "deletions": 15}, "files": [{"sha": "388b4fdd5900699708f06a66365174d6683fa60f", "filename": "gcc/ChangeLog.graphite", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/24c79709800fe1f0213ef441f26fe08e881e5ab5/gcc%2FChangeLog.graphite", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/24c79709800fe1f0213ef441f26fe08e881e5ab5/gcc%2FChangeLog.graphite", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog.graphite?ref=24c79709800fe1f0213ef441f26fe08e881e5ab5", "patch": "@@ -1,3 +1,15 @@\n+2009-10-09  Sebastian Pop  <sebastian.pop@amd.com>\n+\n+\t* graphite-poly.c (apply_poly_transforms): Implement the high\n+\tlevel driver for flag_loop_block.\n+\t* tree-ssa-loop.c (gate_graphite_transforms): Remove call to sorry for\n+\tflag_loop_block.\n+\n+\t* gcc.dg/graphite/graphite.exp (DEFAULT_CFLAGS_GRAPHITE_BLOCK): Add\n+\t-floop-block.\n+\t* gfortran.dg/graphite/graphite.exp (DEFAULT_CFLAGS_GRAPHITE_BLOCK):\n+\tAdd -floop-block.\n+\n 2009-10-09  Sebastian Pop  <sebastian.pop@amd.com>\n \n \t* graphite-poly.h (lst_find_pbb): New."}, {"sha": "d956ad4df258180fca6cc71af2284b44883d9832", "filename": "gcc/graphite-poly.c", "status": "modified", "additions": 11, "deletions": 6, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/24c79709800fe1f0213ef441f26fe08e881e5ab5/gcc%2Fgraphite-poly.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/24c79709800fe1f0213ef441f26fe08e881e5ab5/gcc%2Fgraphite-poly.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgraphite-poly.c?ref=24c79709800fe1f0213ef441f26fe08e881e5ab5", "patch": "@@ -250,13 +250,18 @@ apply_poly_transforms (scop_p scop)\n     transform_done = true;\n \n   if (flag_loop_block)\n-    gcc_unreachable (); /* Not yet supported.  */\n-\n-  if (flag_loop_strip_mine)\n-    transform_done |= scop_do_strip_mine (scop);\n+    {\n+      transform_done |= scop_do_strip_mine (scop);\n+      transform_done |= scop_do_interchange (scop);\n+    }\n+  else\n+    {\n+      if (flag_loop_strip_mine)\n+\ttransform_done |= scop_do_strip_mine (scop);\n \n-  if (flag_loop_interchange)\n-    transform_done |= scop_do_interchange (scop);\n+      if (flag_loop_interchange)\n+\ttransform_done |= scop_do_interchange (scop);\n+    }\n \n   return transform_done;\n }"}, {"sha": "1267cf25382d1ad2b0bbd4ea96fd7c27ff442321", "filename": "gcc/testsuite/gcc.dg/graphite/graphite.exp", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/24c79709800fe1f0213ef441f26fe08e881e5ab5/gcc%2Ftestsuite%2Fgcc.dg%2Fgraphite%2Fgraphite.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/24c79709800fe1f0213ef441f26fe08e881e5ab5/gcc%2Ftestsuite%2Fgcc.dg%2Fgraphite%2Fgraphite.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fgraphite%2Fgraphite.exp?ref=24c79709800fe1f0213ef441f26fe08e881e5ab5", "patch": "@@ -43,7 +43,7 @@ dg-init\n set wait_to_run_files [lsort [glob -nocomplain $srcdir/$subdir/*.c ] ]\n \n # Flags using for block-* files.\n-set DEFAULT_CFLAGS_GRAPHITE_BLOCK \"-O2 -fdump-tree-graphite-all\"\n+set DEFAULT_CFLAGS_GRAPHITE_BLOCK \"-O2 -floop-block -fdump-tree-graphite-all\"\n set block_files [lsort [glob -nocomplain $srcdir/$subdir/block-*.c ] ]\n dg-runtest $block_files \"\" $DEFAULT_CFLAGS_GRAPHITE_BLOCK\n foreach block_file $block_files {lremove wait_to_run_files $block_file}\n@@ -55,9 +55,9 @@ dg-runtest $id_files \"\" $DEFAULT_CFLAGS_GRAPHITE_IDENTITY\n foreach id_file $id_files {lremove wait_to_run_files $id_file}\n \n # Flags using for interchange-* files.\n-set DEFAULT_CFLAGS_GRAPHITE_BLOCK \"-O2 -fdump-tree-graphite-all -floop-interchange -ffast-math\"\n+set DEFAULT_CFLAGS_GRAPHITE_INTERCHANGE \"-O2 -fdump-tree-graphite-all -floop-interchange -ffast-math\"\n set interchange_files [lsort [glob -nocomplain $srcdir/$subdir/interchange-*.c ] ]\n-dg-runtest $interchange_files \"\" $DEFAULT_CFLAGS_GRAPHITE_BLOCK\n+dg-runtest $interchange_files \"\" $DEFAULT_CFLAGS_GRAPHITE_INTERCHANGE\n foreach interchange_file $interchange_files {lremove wait_to_run_files $interchange_file}\n \n # Flags using for scop-* files."}, {"sha": "0746d375689a09f912303d76659430d8895f2c17", "filename": "gcc/testsuite/gfortran.dg/graphite/graphite.exp", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/24c79709800fe1f0213ef441f26fe08e881e5ab5/gcc%2Ftestsuite%2Fgfortran.dg%2Fgraphite%2Fgraphite.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/24c79709800fe1f0213ef441f26fe08e881e5ab5/gcc%2Ftestsuite%2Fgfortran.dg%2Fgraphite%2Fgraphite.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fgraphite%2Fgraphite.exp?ref=24c79709800fe1f0213ef441f26fe08e881e5ab5", "patch": "@@ -42,7 +42,7 @@ dg-init\n set wait_to_run_files [lsort [glob -nocomplain $srcdir/$subdir/*.\\[fF\\]{,90,95,03,08} ] ]\n \n # Flags using for block-* files.\n-set DEFAULT_FLAGS_GRAPHITE_BLOCK \"-O2 -fdump-tree-graphite-all\"\n+set DEFAULT_FLAGS_GRAPHITE_BLOCK \"-O2 -floop-block -fdump-tree-graphite-all\"\n set block_files [lsort [glob -nocomplain $srcdir/$subdir/block-*.\\[fF\\]{,90,95,03,08} ] ]\n gfortran-dg-runtest $block_files $DEFAULT_FLAGS_GRAPHITE_BLOCK\n foreach block_file $block_files {lremove wait_to_run_files $block_file}\n@@ -54,9 +54,9 @@ gfortran-dg-runtest $id_files $DEFAULT_FLAGS_GRAPHITE_IDENTITY\n foreach id_file $id_files {lremove wait_to_run_files $id_file}\n \n # Flags using for interchange-* files.\n-set DEFAULT_FLAGS_GRAPHITE_BLOCK \"-O2 -fdump-tree-graphite-all -floop-interchange\"\n+set DEFAULT_FLAGS_GRAPHITE_INTERCHANGE \"-O2 -fdump-tree-graphite-all -floop-interchange\"\n set interchange_files [lsort [glob -nocomplain $srcdir/$subdir/interchange-*.\\[fF\\]{,90,95,03,08} ] ]\n-gfortran-dg-runtest $interchange_files $DEFAULT_FLAGS_GRAPHITE_BLOCK\n+gfortran-dg-runtest $interchange_files $DEFAULT_FLAGS_GRAPHITE_INTERCHANGE\n foreach interchange_file $interchange_files {lremove wait_to_run_files $interchange_file}\n \n # Flags using for scop-* files."}, {"sha": "b497cccccd162fce096c3f7fbe4a6b7ef903d934", "filename": "gcc/tree-ssa-loop.c", "status": "modified", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/24c79709800fe1f0213ef441f26fe08e881e5ab5/gcc%2Ftree-ssa-loop.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/24c79709800fe1f0213ef441f26fe08e881e5ab5/gcc%2Ftree-ssa-loop.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-loop.c?ref=24c79709800fe1f0213ef441f26fe08e881e5ab5", "patch": "@@ -311,9 +311,6 @@ gate_graphite_transforms (void)\n       || flag_graphite_identity || flag_loop_parallelize_all)\n     flag_graphite = 1;\n \n-  if (flag_loop_block)\n-    sorry (\"loop blocking not implemented\");\n-\n   return flag_graphite != 0;\n }\n "}]}