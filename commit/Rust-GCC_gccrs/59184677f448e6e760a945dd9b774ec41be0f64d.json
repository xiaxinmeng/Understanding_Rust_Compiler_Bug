{"sha": "59184677f448e6e760a945dd9b774ec41be0f64d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTkxODQ2NzdmNDQ4ZTZlNzYwYTk0NWRkOWI3NzRlYzQxYmUwZjY0ZA==", "commit": {"author": {"name": "Toshiyasu Morita", "email": "toshiyasu.morita@hsa.hitachi.com", "date": "2002-04-20T18:01:53Z"}, "committer": {"name": "Kazu Hirata", "email": "kazu@gcc.gnu.org", "date": "2002-04-20T18:01:53Z"}, "message": "lib1funcs.asm (___mulsi3): Use hardware multiply instructions for H8/300H case.\n\n\t* config/h8300/lib1funcs.asm (___mulsi3): Use hardware\n\tmultiply instructions for H8/300H case.\n\nFrom-SVN: r52558", "tree": {"sha": "2a2d5537271cb0ce68f2987699a8e23f7d62ad64", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2a2d5537271cb0ce68f2987699a8e23f7d62ad64"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/59184677f448e6e760a945dd9b774ec41be0f64d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/59184677f448e6e760a945dd9b774ec41be0f64d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/59184677f448e6e760a945dd9b774ec41be0f64d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/59184677f448e6e760a945dd9b774ec41be0f64d/comments", "author": null, "committer": null, "parents": [{"sha": "b1113e0aac47b9af49b6e94394b03808e0463601", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b1113e0aac47b9af49b6e94394b03808e0463601", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b1113e0aac47b9af49b6e94394b03808e0463601"}], "stats": {"total": 70, "additions": 46, "deletions": 24}, "files": [{"sha": "63fd6350be4c39c505c9b920447106e45953c5e9", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/59184677f448e6e760a945dd9b774ec41be0f64d/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/59184677f448e6e760a945dd9b774ec41be0f64d/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=59184677f448e6e760a945dd9b774ec41be0f64d", "patch": "@@ -1,3 +1,8 @@\n+2002-04-20  Toshiyasu Morita  <toshiyasu.morita@hsa.hitachi.com>\n+\n+\t* config/h8300/lib1funcs.asm (___mulsi3): Use hardware\n+\tmultiply instructions for H8/300H case.\n+\n 2002-04-20  Toshiyasu Morita  <toshiyasu.morita@hsa.hitachi.com>\n \n \t* config/h8300/lib1funcs.asm (___cmpsi2, ___ucmpsi2):"}, {"sha": "0fbeacd0ed07f3670fe991c19fb8018b33d12b28", "filename": "gcc/config/h8300/lib1funcs.asm", "status": "modified", "additions": 41, "deletions": 24, "changes": 65, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/59184677f448e6e760a945dd9b774ec41be0f64d/gcc%2Fconfig%2Fh8300%2Flib1funcs.asm", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/59184677f448e6e760a945dd9b774ec41be0f64d/gcc%2Fconfig%2Fh8300%2Flib1funcs.asm", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fh8300%2Flib1funcs.asm?ref=59184677f448e6e760a945dd9b774ec41be0f64d", "patch": "@@ -730,32 +730,49 @@ _done:\n \n #else /* __H8300H__ */\n \n+;\n+; mulsi3 for H8/300H - based on Hitachi SH implementation\n+;\n+; by Toshiyasu Morita\n+;\n+; Old code:\n+;\n+; 16b * 16b = 372 states (worst case)\n+; 32b * 32b = 724 states (worst case)\n+;\n+; New code:\n+;\n+; 16b * 16b =  68 states\n+; 16b * 32b =  96 states\n+; 32b * 32b = 124 states\n+;\n+\n \t.global\t___mulsi3\n ___mulsi3:\n-\tsub.l\tA2P,A2P\n-\n-\t; while (a)\n-_top:\tmov.l\tA0P,A0P\n-\tbeq\t_done\n-\n-\t; if (a & 1)\n-\tbld\t#0,A0L\n-\tbcc\t_nobit\n-\n-\t; r += b\n-\tadd.l\tA1P,A2P\n-\n-_nobit:\n-\t; a >>= 1\n-\tshlr.l\tA0P\n-\n-\t; b <<= 1\n-\tshll.l\tA1P\n-\tbra\t_top\n-\n-_done:\n-\tmov.l\tA2P,A0P\n-\trts\n+\tpush.l\ter3     ; (10 states)\n+  \n+\tmov.w\tr1,r2   ; ( 2 states) b * d\n+\tmulxu\tr0,er2  ; (22 states)\n+  \n+\tmov.w\te0,r3   ; ( 2 states) a * d\n+\tbeq\tL_skip1 ; ( 4 states)\n+\tmulxu\tr1,er3  ; (22 states)\n+\tmov.w\tr3,e3   ; ( 2 states)\n+\tmov.w\t#0,r3   ; ( 2 states)\n+\tadd.l\ter3,er2 ; ( 2 states)\n+\n+L_skip1:\n+\tmov.w\te1,r3   ; ( 2 states) c * b\n+\tbeq\tL_skip2 ; ( 4 states)\n+\tmulxu\tr0,er3  ; (22 states)\n+\tmov.w\tr3,e3   ; ( 2 states)\n+\tmov.w\t#0,r3   ; ( 2 states)\n+\tadd.l\ter3,er2 ; ( 2 states)\n+\n+L_skip2:\n+\tmov.l\ter2,er0\t; ( 2 states)\n+\tpop.l\ter3\t; (10 states)\n+\trts\t\t; (10 states)\n \n #endif\n #endif /* L_mulsi3 */"}]}