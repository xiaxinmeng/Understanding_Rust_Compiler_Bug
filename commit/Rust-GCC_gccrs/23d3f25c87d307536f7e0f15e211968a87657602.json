{"sha": "23d3f25c87d307536f7e0f15e211968a87657602", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjNkM2YyNWM4N2QzMDc1MzZmN2UwZjE1ZTIxMTk2OGE4NzY1NzYwMg==", "commit": {"author": {"name": "Mark Eggleston", "email": "markeggleston@gcc.gnu.org", "date": "2020-02-18T14:15:41Z"}, "committer": {"name": "Mark Eggleston", "email": "markeggleston@gcc.gnu.org", "date": "2020-02-18T14:15:41Z"}, "message": "[Fortran] ICE: Invalid expression in gfc_element_size PR93601\n\nICE occurs when assigning a BOZ constant to an class(*) variable\nwith the allocatable attribute. Use of BOZ constants outside\ndata statements and int/real/dble/cmplx intrinsics is not allowed.\n\nOriginal patch provided by Steven G. Kargl  <kargl@gcc.gnu.org>.\n\ngcc/fortran/ChangeLog\n\n\tPR fortran/93601\n\t* match.c (gfc_match_assignment) : Reject assignment if\n\tthe lhs stype is BT_CLASS and the rhs type is BT_BOZ.\n\ngcc/testsuite/ChangeLog\n\n\tPR fortran/93601\n\t* gfortran.dg/pr93601.f90 : New test.", "tree": {"sha": "f1a38ab5169c3ccb426df0042d1b9e2b8000a93a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f1a38ab5169c3ccb426df0042d1b9e2b8000a93a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/23d3f25c87d307536f7e0f15e211968a87657602", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/23d3f25c87d307536f7e0f15e211968a87657602", "html_url": "https://github.com/Rust-GCC/gccrs/commit/23d3f25c87d307536f7e0f15e211968a87657602", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/23d3f25c87d307536f7e0f15e211968a87657602/comments", "author": null, "committer": null, "parents": [{"sha": "08afe87b7976e93197a66e01f93191ead496ad42", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/08afe87b7976e93197a66e01f93191ead496ad42", "html_url": "https://github.com/Rust-GCC/gccrs/commit/08afe87b7976e93197a66e01f93191ead496ad42"}], "stats": {"total": 28, "additions": 28, "deletions": 0}, "files": [{"sha": "5daaefdee9bd9368d61c2ed5310ecf2f95287032", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/23d3f25c87d307536f7e0f15e211968a87657602/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/23d3f25c87d307536f7e0f15e211968a87657602/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=23d3f25c87d307536f7e0f15e211968a87657602", "patch": "@@ -1,3 +1,9 @@\n+2020-02-18  Steven G. Kargl  <kargl@gcc.gnu.org>\n+\n+\tPR fortran/93601\n+\t* match.c (gfc_match_assignment) : Reject assignment if\n+\tthe lhs stype is BT_CLASS and the rhs type is BT_BOZ.\n+\n 2020-02-18  Steven G. Kargl  <kargl@gcc.gnu.org>\n \n \tPR fortran/93603"}, {"sha": "e4d52245976022a7d7193729b8899b7d8fb042f5", "filename": "gcc/fortran/match.c", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/23d3f25c87d307536f7e0f15e211968a87657602/gcc%2Ffortran%2Fmatch.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/23d3f25c87d307536f7e0f15e211968a87657602/gcc%2Ffortran%2Fmatch.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fmatch.c?ref=23d3f25c87d307536f7e0f15e211968a87657602", "patch": "@@ -1348,6 +1348,16 @@ gfc_match_assignment (void)\n   rvalue = NULL;\n   m = gfc_match (\" %e%t\", &rvalue);\n \n+  if (m == MATCH_YES\n+      && rvalue->ts.type == BT_BOZ\n+      && lvalue->ts.type == BT_CLASS)\n+    {\n+      m = MATCH_ERROR;\n+      gfc_error (\"BOZ literal constant at %L is neither a DATA statement \"\n+\t\t \"value nor an actual argument of INT/REAL/DBLE/CMPLX \"\n+\t\t \"intrinsic subprogram\", &rvalue->where);\n+    }\n+\n   if (lvalue->expr_type == EXPR_CONSTANT)\n     {\n       /* This clobbers %len and %kind.  */"}, {"sha": "6b008fde20250a00097550b97ac9a94ab209c1c4", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/23d3f25c87d307536f7e0f15e211968a87657602/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/23d3f25c87d307536f7e0f15e211968a87657602/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=23d3f25c87d307536f7e0f15e211968a87657602", "patch": "@@ -1,3 +1,8 @@\n+2020-02-18  Mark Eggleston  <mark.eggleston@codethink.com>\n+\n+\tPR fortran/93601\n+\t* gfortran.dg/pr93601.f90 : New test.\n+\n 2020-02-18  Martin Liska  <mliska@suse.cz>\n \n \tPR ipa/93583"}, {"sha": "495447c637bfe2cbc7399e2ccf45891b73842661", "filename": "gcc/testsuite/gfortran.dg/pr93601.f90", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/23d3f25c87d307536f7e0f15e211968a87657602/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr93601.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/23d3f25c87d307536f7e0f15e211968a87657602/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr93601.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr93601.f90?ref=23d3f25c87d307536f7e0f15e211968a87657602", "patch": "@@ -0,0 +1,7 @@\n+! { dg-do compile }\n+\n+program p\n+   class(*), allocatable :: z\n+   z = z'1' ! { dg-error \"BOZ literal constant at\" }\n+end\n+"}]}