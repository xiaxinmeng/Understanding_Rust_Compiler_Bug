{"sha": "6ed545b124429c80a5dd7dd74673035880242060", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NmVkNTQ1YjEyNDQyOWM4MGE1ZGQ3ZGQ3NDY3MzAzNTg4MDI0MjA2MA==", "commit": {"author": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1997-07-14T10:51:23Z"}, "committer": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1997-07-14T10:51:23Z"}, "message": "(schedule_block): Free space associated with reg_pending_sets and old_live_regs.\n\n(schedule_block): Free space associated with reg_pending_sets and\nold_live_regs.\n(schedule_insns): Free bb_{dead,live}_regs on first pass.\n(sched_analyze_insn): Use EXECUTE_IF_SET_IN_REG_SET and then clear.\n\nFrom-SVN: r14426", "tree": {"sha": "6473882039c26b5019ac81dddd386daacba15268", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6473882039c26b5019ac81dddd386daacba15268"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6ed545b124429c80a5dd7dd74673035880242060", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6ed545b124429c80a5dd7dd74673035880242060", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6ed545b124429c80a5dd7dd74673035880242060", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6ed545b124429c80a5dd7dd74673035880242060/comments", "author": null, "committer": null, "parents": [{"sha": "4fac99c8564b9aecee4ae3b388bb6e566400687e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4fac99c8564b9aecee4ae3b388bb6e566400687e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4fac99c8564b9aecee4ae3b388bb6e566400687e"}], "stats": {"total": 28, "additions": 20, "deletions": 8}, "files": [{"sha": "84fe84dceaad56e015d2497c3c12d4b906312e11", "filename": "gcc/sched.c", "status": "modified", "additions": 20, "deletions": 8, "changes": 28, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6ed545b124429c80a5dd7dd74673035880242060/gcc%2Fsched.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6ed545b124429c80a5dd7dd74673035880242060/gcc%2Fsched.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fsched.c?ref=6ed545b124429c80a5dd7dd74673035880242060", "patch": "@@ -2128,10 +2128,11 @@ sched_analyze_insn (x, insn, loop_notes)\n \t  sched_analyze_2 (XEXP (note, 0), insn);\n     }\n \n-  EXECUTE_IF_SET_AND_RESET_IN_REG_SET (reg_pending_sets, 0, i,\n-\t\t\t\t       {\n-\t\t\t\t\t reg_last_sets[i] = insn;\n-\t\t\t\t       });\n+  EXECUTE_IF_SET_IN_REG_SET (reg_pending_sets, 0, i,\n+\t\t\t     {\n+\t\t\t       reg_last_sets[i] = insn;\n+\t\t\t     });\n+  CLEAR_REG_SET (reg_pending_sets);\n \n   if (reg_pending_sets_all)\n     {\n@@ -3254,7 +3255,7 @@ schedule_block (b, file)\n      to schedule this block.  */\n   if (head == tail\n       && (GET_CODE (head) == NOTE || GET_CODE (head) == CODE_LABEL))\n-    return;\n+    goto ret;\n \n #if 0\n   /* This short-cut doesn't work.  It does not count call insns crossed by\n@@ -3267,7 +3268,7 @@ schedule_block (b, file)\n      has one insn, so this won't slow down this pass by much.  */\n \n   if (head == tail)\n-    return;\n+    goto ret;\n #endif\n \n   /* Now HEAD through TAIL are the insns actually to be rearranged;\n@@ -3292,7 +3293,7 @@ schedule_block (b, file)\n   if (n_insns == 0)\n     {\n       free_pending_lists ();\n-      return;\n+      goto ret;\n     }\n \n   /* Allocate vector to hold insns to be rearranged (except those\n@@ -3422,7 +3423,7 @@ schedule_block (b, file)\n \t  finish_sometimes_live (regs_sometimes_live, sometimes_max);\n \t}\n       free_pending_lists ();\n-      return;\n+      goto ret;\n     }\n #endif\n \n@@ -4081,6 +4082,10 @@ schedule_block (b, file)\n   /* Yow! We're done!  */\n   free_pending_lists ();\n \n+ret:\n+  FREE_REG_SET (reg_pending_sets);\n+  FREE_REG_SET (old_live_regs);\n+\n   return;\n }\n \f\n@@ -5066,5 +5071,12 @@ schedule_insns (dump_file)\n \t      REG_N_CALLS_CROSSED (regno) = sched_reg_n_calls_crossed[regno];\n \t  }\n     }\n+\n+  if (reload_completed == 0)\n+    {\n+      FREE_REG_SET (bb_dead_regs);\n+      FREE_REG_SET (bb_live_regs);\n+    }\n+\n }\n #endif /* INSN_SCHEDULING */"}]}