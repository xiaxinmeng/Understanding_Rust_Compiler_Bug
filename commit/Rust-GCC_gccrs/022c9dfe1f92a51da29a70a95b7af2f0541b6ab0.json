{"sha": "022c9dfe1f92a51da29a70a95b7af2f0541b6ab0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDIyYzlkZmUxZjkyYTUxZGEyOWE3MGE5NWI3YWYyZjA1NDFiNmFiMA==", "commit": {"author": {"name": "Ed Schonberg", "email": "schonberg@adacore.com", "date": "2019-08-14T09:52:39Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "pmderodat@gcc.gnu.org", "date": "2019-08-14T09:52:39Z"}, "message": "[Ada] Do not crash with -gnatR3 on Ghost aspects\n\n2019-08-14  Ed Schonberg  <schonberg@adacore.com>\n\ngcc/ada/\n\n\t* sem_aux.adb (Next_Rep_Item): If a node in the rep chain\n\tinvolves a Ghost aspect it may have been replaced by a null\n\tstatement; use the original node to find next Rep_Item.\n\t* repinfo.adb (List_Entities): Do not list an Ignored\n\tGhost_Entity, for which information may have been deleted.\n\nFrom-SVN: r274470", "tree": {"sha": "c76e8d51ba35da7c5dc2414e119d46d00077690a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c76e8d51ba35da7c5dc2414e119d46d00077690a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/022c9dfe1f92a51da29a70a95b7af2f0541b6ab0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/022c9dfe1f92a51da29a70a95b7af2f0541b6ab0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/022c9dfe1f92a51da29a70a95b7af2f0541b6ab0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/022c9dfe1f92a51da29a70a95b7af2f0541b6ab0/comments", "author": {"login": "Edschonberg", "id": 6352375, "node_id": "MDQ6VXNlcjYzNTIzNzU=", "avatar_url": "https://avatars.githubusercontent.com/u/6352375?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Edschonberg", "html_url": "https://github.com/Edschonberg", "followers_url": "https://api.github.com/users/Edschonberg/followers", "following_url": "https://api.github.com/users/Edschonberg/following{/other_user}", "gists_url": "https://api.github.com/users/Edschonberg/gists{/gist_id}", "starred_url": "https://api.github.com/users/Edschonberg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Edschonberg/subscriptions", "organizations_url": "https://api.github.com/users/Edschonberg/orgs", "repos_url": "https://api.github.com/users/Edschonberg/repos", "events_url": "https://api.github.com/users/Edschonberg/events{/privacy}", "received_events_url": "https://api.github.com/users/Edschonberg/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "0246fe44ac945c563cb57fdb625746293d8f8334", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0246fe44ac945c563cb57fdb625746293d8f8334", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0246fe44ac945c563cb57fdb625746293d8f8334"}], "stats": {"total": 15, "additions": 15, "deletions": 0}, "files": [{"sha": "1c869e12359fb00c37edb0ededed91c3c813bbc5", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/022c9dfe1f92a51da29a70a95b7af2f0541b6ab0/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/022c9dfe1f92a51da29a70a95b7af2f0541b6ab0/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=022c9dfe1f92a51da29a70a95b7af2f0541b6ab0", "patch": "@@ -1,3 +1,11 @@\n+2019-08-14  Ed Schonberg  <schonberg@adacore.com>\n+\n+\t* sem_aux.adb (Next_Rep_Item): If a node in the rep chain\n+\tinvolves a Ghost aspect it may have been replaced by a null\n+\tstatement; use the original node to find next Rep_Item.\n+\t* repinfo.adb (List_Entities): Do not list an Ignored\n+\tGhost_Entity, for which information may have been deleted.\n+\n 2019-08-14  Bob Duff  <duff@adacore.com>\n \n \t* sem_prag.ads, sem_prag.adb"}, {"sha": "6f531b21348a440e7b1a742878136c941c52243d", "filename": "gcc/ada/repinfo.adb", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/022c9dfe1f92a51da29a70a95b7af2f0541b6ab0/gcc%2Fada%2Frepinfo.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/022c9dfe1f92a51da29a70a95b7af2f0541b6ab0/gcc%2Fada%2Frepinfo.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Frepinfo.adb?ref=022c9dfe1f92a51da29a70a95b7af2f0541b6ab0", "patch": "@@ -479,6 +479,7 @@ package body Repinfo is\n \n       if Present (Ent)\n         and then Nkind (Declaration_Node (Ent)) not in N_Renaming_Declaration\n+        and then not Is_Ignored_Ghost_Entity (Ent)\n       then\n          --  If entity is a subprogram and we are listing mechanisms,\n          --  then we need to list mechanisms for this entity. We skip this"}, {"sha": "e5bd68ac7b8b8a448a1bca7dd57f8aac4fb07546", "filename": "gcc/ada/sem_aux.adb", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/022c9dfe1f92a51da29a70a95b7af2f0541b6ab0/gcc%2Fada%2Fsem_aux.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/022c9dfe1f92a51da29a70a95b7af2f0541b6ab0/gcc%2Fada%2Fsem_aux.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_aux.adb?ref=022c9dfe1f92a51da29a70a95b7af2f0541b6ab0", "patch": "@@ -569,6 +569,12 @@ package body Sem_Aux is\n             elsif Entity (N) = E then\n                return N;\n             end if;\n+\n+         --  A Ghost-related aspect, if disabled, may have been replaced by a\n+         --  null statement.\n+\n+         elsif Nkind (N) = N_Null_Statement then\n+            N := Original_Node (N);\n          end if;\n \n          Next_Rep_Item (N);"}]}