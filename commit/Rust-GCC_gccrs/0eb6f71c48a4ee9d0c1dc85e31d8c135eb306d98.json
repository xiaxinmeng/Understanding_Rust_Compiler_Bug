{"sha": "0eb6f71c48a4ee9d0c1dc85e31d8c135eb306d98", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MGViNmY3MWM0OGE0ZWU5ZDBjMWRjODVlMzFkOGMxMzVlYjMwNmQ5OA==", "commit": {"author": {"name": "David Malcolm", "email": "dmalcolm@redhat.com", "date": "2015-08-06T19:05:52Z"}, "committer": {"name": "David Malcolm", "email": "dmalcolm@gcc.gnu.org", "date": "2015-08-06T19:05:52Z"}, "message": "jit.dg/test-benchmark.c: add a summary of timings\n\ngcc/testsuite/ChangeLog:\n\t* jit.dg/test-benchmark.c (main): Record all elapsed times at each\n\toptimization level, and print a summary at the end.\n\nFrom-SVN: r226697", "tree": {"sha": "5de486c8a293c9a154ba7cfcb4efdd1208d0ab2a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5de486c8a293c9a154ba7cfcb4efdd1208d0ab2a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0eb6f71c48a4ee9d0c1dc85e31d8c135eb306d98", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0eb6f71c48a4ee9d0c1dc85e31d8c135eb306d98", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0eb6f71c48a4ee9d0c1dc85e31d8c135eb306d98", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0eb6f71c48a4ee9d0c1dc85e31d8c135eb306d98/comments", "author": {"login": "davidmalcolm", "id": 1553248, "node_id": "MDQ6VXNlcjE1NTMyNDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1553248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidmalcolm", "html_url": "https://github.com/davidmalcolm", "followers_url": "https://api.github.com/users/davidmalcolm/followers", "following_url": "https://api.github.com/users/davidmalcolm/following{/other_user}", "gists_url": "https://api.github.com/users/davidmalcolm/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidmalcolm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidmalcolm/subscriptions", "organizations_url": "https://api.github.com/users/davidmalcolm/orgs", "repos_url": "https://api.github.com/users/davidmalcolm/repos", "events_url": "https://api.github.com/users/davidmalcolm/events{/privacy}", "received_events_url": "https://api.github.com/users/davidmalcolm/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "00ebbcbc5990f11d0b2f5c0385b32cd587d4a4ac", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/00ebbcbc5990f11d0b2f5c0385b32cd587d4a4ac", "html_url": "https://github.com/Rust-GCC/gccrs/commit/00ebbcbc5990f11d0b2f5c0385b32cd587d4a4ac"}], "stats": {"total": 23, "additions": 20, "deletions": 3}, "files": [{"sha": "66d57bb6aac6d615dbd64e7bc774c47c0cc9d5de", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0eb6f71c48a4ee9d0c1dc85e31d8c135eb306d98/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0eb6f71c48a4ee9d0c1dc85e31d8c135eb306d98/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=0eb6f71c48a4ee9d0c1dc85e31d8c135eb306d98", "patch": "@@ -1,3 +1,8 @@\n+2015-08-06  David Malcolm  <dmalcolm@redhat.com>\n+\n+\t* jit.dg/test-benchmark.c (main): Record all elapsed times at each\n+\toptimization level, and print a summary at the end.\n+\n 2015-08-06  Jiong Wang  <jiong.wang@arm.com>\n \n \t* gcc.target/aarch64/tlsdesc_hoist.c: New testcase."}, {"sha": "ca2984cffb7c82dc5f6156b3972fad4be5694fcc", "filename": "gcc/testsuite/jit.dg/test-benchmark.c", "status": "modified", "additions": 15, "deletions": 3, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0eb6f71c48a4ee9d0c1dc85e31d8c135eb306d98/gcc%2Ftestsuite%2Fjit.dg%2Ftest-benchmark.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0eb6f71c48a4ee9d0c1dc85e31d8c135eb306d98/gcc%2Ftestsuite%2Fjit.dg%2Ftest-benchmark.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fjit.dg%2Ftest-benchmark.c?ref=0eb6f71c48a4ee9d0c1dc85e31d8c135eb306d98", "patch": "@@ -222,13 +222,14 @@ main (int argc, char **argv)\n {\n   int opt_level;\n   int num_iterations = 100;\n+  double elapsed_time[4];\n \n   ticks_to_msec = TICKS_TO_MSEC;\n \n   for (opt_level = 0; opt_level < 4; opt_level++)\n     {\n       int i;\n-      double start_time, end_time, elapsed_time;\n+      double start_time, end_time;\n       start_time = get_wallclock_time ();\n       gcc_jit_timer *timer = gcc_jit_timer_new ();\n       for (i = 1; i <= num_iterations; i++)\n@@ -240,17 +241,28 @@ main (int argc, char **argv)\n \t  test_jit (argv[0], opt_level, timer);\n \t}\n       end_time = get_wallclock_time ();\n-      elapsed_time = end_time - start_time;\n+      elapsed_time[opt_level] = end_time - start_time;\n       gcc_jit_timer_print (timer, stderr);\n       gcc_jit_timer_release (timer);\n       pass (\"%s: survived %i iterations at optlevel %i\",\n \t    argv[0], num_iterations, opt_level);\n       note ((\"%s: %i iterations at optlevel %i\"\n \t     \" took a total of %.3fs (%.3fs per iteration)\"),\n \t    argv[0], num_iterations, opt_level,\n-\t    elapsed_time, elapsed_time / num_iterations);\n+\t    elapsed_time[opt_level],\n+\t    elapsed_time[opt_level] / num_iterations);\n     }\n+\n   totals ();\n \n+  /* Print a summary.  */\n+  printf (\"%s: %i iterations: time taken (lower is better)\\n\",\n+\t  argv[0], num_iterations);\n+  for (opt_level = 0; opt_level < 4; opt_level++)\n+    printf (\"optlevel %i: %.3fs (%.3fs per iteration)\\n\",\n+\t    opt_level,\n+\t    elapsed_time[opt_level],\n+\t    elapsed_time[opt_level] / num_iterations);\n+\n   return 0;\n }"}]}