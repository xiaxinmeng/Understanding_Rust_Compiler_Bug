{"sha": "c28fcc601cfb584dbcf800a53f5d68d6766e50b3", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzI4ZmNjNjAxY2ZiNTg0ZGJjZjgwMGE1M2Y1ZDY4ZDY3NjZlNTBiMw==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2017-02-18T13:14:43Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2017-02-18T13:14:43Z"}, "message": "re PR target/79569 (Unrecognized command line option \u2018-m3dnowa\u2019)\n\n\tPR target/79569\n\t* config/i386/i386.opt (m3dnowa): Replace Undocumented with Report.\n\t* common/config/i386/i386-common.c (OPTION_MASK_ISA_3DNOW_A_SET): Define.\n\t(ix86_handle_option): Handle OPT_m3dnowa.\n\t* doc/invoke.texi (-m3dnowa): Document.\n\t* doc/extend.texi (__builtin_ia32_pmulhuw, __builtin_ia32_pf2iw): Use\n\t-m3dnowa instead of -m3dnow -march=athlon.\n\n\t* gcc.target/i386/3dnowA-3.c: New test.\n\nFrom-SVN: r245561", "tree": {"sha": "87149d8fde909ea0821b7799f6636091fd920e79", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/87149d8fde909ea0821b7799f6636091fd920e79"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c28fcc601cfb584dbcf800a53f5d68d6766e50b3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c28fcc601cfb584dbcf800a53f5d68d6766e50b3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c28fcc601cfb584dbcf800a53f5d68d6766e50b3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c28fcc601cfb584dbcf800a53f5d68d6766e50b3/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "c26159516d6a16def440628643d8c1b7c43169c3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c26159516d6a16def440628643d8c1b7c43169c3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c26159516d6a16def440628643d8c1b7c43169c3"}], "stats": {"total": 58, "additions": 46, "deletions": 12}, "files": [{"sha": "69db3df49d0cfb70b7b14331c5556b7750b103bc", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c28fcc601cfb584dbcf800a53f5d68d6766e50b3/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c28fcc601cfb584dbcf800a53f5d68d6766e50b3/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=c28fcc601cfb584dbcf800a53f5d68d6766e50b3", "patch": "@@ -1,5 +1,13 @@\n 2017-02-18  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR target/79569\n+\t* config/i386/i386.opt (m3dnowa): Replace Undocumented with Report.\n+\t* common/config/i386/i386-common.c (OPTION_MASK_ISA_3DNOW_A_SET): Define.\n+\t(ix86_handle_option): Handle OPT_m3dnowa.\n+\t* doc/invoke.texi (-m3dnowa): Document.\n+\t* doc/extend.texi (__builtin_ia32_pmulhuw, __builtin_ia32_pf2iw): Use\n+\t-m3dnowa instead of -m3dnow -march=athlon.\n+\n \tPR target/79559\n \t* config/i386/i386.c (ix86_print_operand): Use output_operand_lossage\n \tinstead of gcc_assert for K, r and R code checks.  Formatting fixes."}, {"sha": "4185176495a2096a49ba305c5a411f1e96741458", "filename": "gcc/common/config/i386/i386-common.c", "status": "modified", "additions": 13, "deletions": 1, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c28fcc601cfb584dbcf800a53f5d68d6766e50b3/gcc%2Fcommon%2Fconfig%2Fi386%2Fi386-common.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c28fcc601cfb584dbcf800a53f5d68d6766e50b3/gcc%2Fcommon%2Fconfig%2Fi386%2Fi386-common.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcommon%2Fconfig%2Fi386%2Fi386-common.c?ref=c28fcc601cfb584dbcf800a53f5d68d6766e50b3", "patch": "@@ -35,6 +35,8 @@ along with GCC; see the file COPYING3.  If not see\n #define OPTION_MASK_ISA_MMX_SET OPTION_MASK_ISA_MMX\n #define OPTION_MASK_ISA_3DNOW_SET \\\n   (OPTION_MASK_ISA_3DNOW | OPTION_MASK_ISA_MMX_SET)\n+#define OPTION_MASK_ISA_3DNOW_A_SET \\\n+  (OPTION_MASK_ISA_3DNOW_A | OPTION_MASK_ISA_3DNOW_SET)\n \n #define OPTION_MASK_ISA_SSE_SET OPTION_MASK_ISA_SSE\n #define OPTION_MASK_ISA_SSE2_SET \\\n@@ -293,7 +295,17 @@ ix86_handle_option (struct gcc_options *opts,\n       return true;\n \n     case OPT_m3dnowa:\n-      return false;\n+      if (value)\n+\t{\n+\t  opts->x_ix86_isa_flags |= OPTION_MASK_ISA_3DNOW_A_SET;\n+\t  opts->x_ix86_isa_flags_explicit |= OPTION_MASK_ISA_3DNOW_A_SET;\n+\t}\n+      else\n+\t{\n+\t  opts->x_ix86_isa_flags &= ~OPTION_MASK_ISA_3DNOW_A_UNSET;\n+\t  opts->x_ix86_isa_flags_explicit |= OPTION_MASK_ISA_3DNOW_A_UNSET;\n+\t}\n+      return true;\n \n     case OPT_msse:\n       if (value)"}, {"sha": "71100d98708e648acfb8c2de605dd1162cc088a0", "filename": "gcc/config/i386/i386.opt", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c28fcc601cfb584dbcf800a53f5d68d6766e50b3/gcc%2Fconfig%2Fi386%2Fi386.opt", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c28fcc601cfb584dbcf800a53f5d68d6766e50b3/gcc%2Fconfig%2Fi386%2Fi386.opt", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386.opt?ref=c28fcc601cfb584dbcf800a53f5d68d6766e50b3", "patch": "@@ -614,7 +614,7 @@ Target Report Mask(ISA_3DNOW) Var(ix86_isa_flags) Save\n Support 3DNow! built-in functions.\n \n m3dnowa\n-Target Undocumented Mask(ISA_3DNOW_A) Var(ix86_isa_flags) Save\n+Target Report Mask(ISA_3DNOW_A) Var(ix86_isa_flags) Save\n Support Athlon 3Dnow! built-in functions.\n \n msse"}, {"sha": "143a7b7eb617ebdb86399ab4a1d8b8f5512fbe10", "filename": "gcc/doc/extend.texi", "status": "modified", "additions": 4, "deletions": 6, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c28fcc601cfb584dbcf800a53f5d68d6766e50b3/gcc%2Fdoc%2Fextend.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c28fcc601cfb584dbcf800a53f5d68d6766e50b3/gcc%2Fdoc%2Fextend.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdoc%2Fextend.texi?ref=c28fcc601cfb584dbcf800a53f5d68d6766e50b3", "patch": "@@ -19513,9 +19513,8 @@ v2si __builtin_ia32_psradi (v2si, int)\n @end smallexample\n \n The following built-in functions are made available either with\n-@option{-msse}, or with a combination of @option{-m3dnow} and\n-@option{-march=athlon}.  All of them generate the machine\n-instruction that is part of the name.\n+@option{-msse}, or with @option{-m3dnowa}.  All of them generate\n+the machine instruction that is part of the name.\n \n @smallexample\n v4hi __builtin_ia32_pmulhuw (v4hi, v4hi)\n@@ -20615,9 +20614,8 @@ v2sf __builtin_ia32_pi2fd (v2si)\n v4hi __builtin_ia32_pmulhrw (v4hi, v4hi)\n @end smallexample\n \n-The following built-in functions are available when both @option{-m3dnow}\n-and @option{-march=athlon} are used.  All of them generate the machine\n-instruction that is part of the name.\n+The following built-in functions are available when @option{-m3dnowa} is used.\n+All of them generate the machine instruction that is part of the name.\n \n @smallexample\n v2si __builtin_ia32_pf2iw (v2sf)"}, {"sha": "31d1095856048da446fa47b2a0eb0cc738b250a4", "filename": "gcc/doc/invoke.texi", "status": "modified", "additions": 7, "deletions": 4, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c28fcc601cfb584dbcf800a53f5d68d6766e50b3/gcc%2Fdoc%2Finvoke.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c28fcc601cfb584dbcf800a53f5d68d6766e50b3/gcc%2Fdoc%2Finvoke.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdoc%2Finvoke.texi?ref=c28fcc601cfb584dbcf800a53f5d68d6766e50b3", "patch": "@@ -1188,9 +1188,9 @@ See RS/6000 and PowerPC Options.\n -mavx512bw  -mavx512dq  -mavx512ifma  -mavx512vbmi  -msha  -maes @gol\n -mpclmul  -mfsgsbase  -mrdrnd  -mf16c  -mfma @gol\n -mprefetchwt1  -mclflushopt  -mxsavec  -mxsaves @gol\n--msse4a  -m3dnow  -mpopcnt  -mabm  -mbmi  -mtbm  -mfma4  -mxop  -mlzcnt @gol\n--mbmi2  -mfxsr  -mxsave  -mxsaveopt  -mrtm  -mlwp  -mmpx  -mmwaitx @gol\n--mclzero  -mpku  -mthreads @gol\n+-msse4a  -m3dnow  -m3dnowa  -mpopcnt  -mabm  -mbmi  -mtbm  -mfma4  -mxop @gol\n+-mlzcnt  -mbmi2  -mfxsr  -mxsave  -mxsaveopt  -mrtm  -mlwp  -mmpx  @gol\n+-mmwaitx  -mclzero  -mpku  -mthreads @gol\n -mms-bitfields  -mno-align-stringops  -minline-all-stringops @gol\n -minline-stringops-dynamically  -mstringop-strategy=@var{alg} @gol\n -mmemcpy-strategy=@var{strategy}  -mmemset-strategy=@var{strategy} @gol\n@@ -24998,6 +24998,9 @@ preferred alignment to @option{-mpreferred-stack-boundary=2}.\n @itemx -m3dnow\n @opindex m3dnow\n @need 200\n+@itemx -m3dnowa\n+@opindex m3dnowa\n+@need 200\n @itemx -mpopcnt\n @opindex mpopcnt\n @need 200\n@@ -25047,7 +25050,7 @@ These switches enable the use of instructions in the MMX, SSE,\n SSE2, SSE3, SSSE3, SSE4.1, AVX, AVX2, AVX512F, AVX512PF, AVX512ER, AVX512CD,\n SHA, AES, PCLMUL, FSGSBASE, RDRND, F16C, FMA, SSE4A, FMA4, XOP, LWP, ABM,\n AVX512VL, AVX512BW, AVX512DQ, AVX512IFMA AVX512VBMI, BMI, BMI2, FXSR,\n-XSAVE, XSAVEOPT, LZCNT, RTM, MPX, MWAITX, PKU or 3DNow!@:\n+XSAVE, XSAVEOPT, LZCNT, RTM, MPX, MWAITX, PKU, 3DNow!@: or enhanced 3DNow!@:\n extended instruction sets.  Each has a corresponding @option{-mno-} option\n to disable use of these instructions.\n "}, {"sha": "6f741582a70e34892e2f7d18391024e704073885", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c28fcc601cfb584dbcf800a53f5d68d6766e50b3/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c28fcc601cfb584dbcf800a53f5d68d6766e50b3/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=c28fcc601cfb584dbcf800a53f5d68d6766e50b3", "patch": "@@ -1,5 +1,8 @@\n 2017-02-18  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR target/79569\n+\t* gcc.target/i386/3dnowA-3.c: New test.\n+\n \tPR target/79559\n \t* gcc.target/i386/pr79559.c: New test.\n "}, {"sha": "7cd57af6a59394f1e0a7c152cb8094f029a3c869", "filename": "gcc/testsuite/gcc.target/i386/3dnowA-3.c", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c28fcc601cfb584dbcf800a53f5d68d6766e50b3/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2F3dnowA-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c28fcc601cfb584dbcf800a53f5d68d6766e50b3/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2F3dnowA-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2F3dnowA-3.c?ref=c28fcc601cfb584dbcf800a53f5d68d6766e50b3", "patch": "@@ -0,0 +1,10 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O0 -Werror-implicit-function-declaration -m3dnowa\" } */\n+\n+#include <mm3dnow.h>\n+\n+__m64\n+foo (__m64 x, __m64 y)\n+{\n+  return _m_pfnacc (x, y);\n+}"}]}