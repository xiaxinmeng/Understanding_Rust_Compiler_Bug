{"sha": "e80b21edaebbc271cc2b3f996f51694c3c9bafe6", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTgwYjIxZWRhZWJiYzI3MWNjMmIzZjk5NmY1MTY5NGMzYzliYWZlNg==", "commit": {"author": {"name": "Martin Jambor", "email": "mjambor@suse.cz", "date": "2011-01-27T13:41:51Z"}, "committer": {"name": "Martin Jambor", "email": "jamborm@gcc.gnu.org", "date": "2011-01-27T13:41:51Z"}, "message": "re PR tree-optimization/47228 (wrong code with loop)\n\n2011-01-27  Martin Jambor  <mjambor@suse.cz>\n\n\tPR tree-optimization/47228\n\t* tree-sra.c (sra_modify_assign): Use build_ref_for_model instead of\n\tbuild_ref_for_offset.\n\n\t* testsuite/gcc.dg/torture/pr47228.c: New test.\n\nFrom-SVN: r169331", "tree": {"sha": "205042b8932b572b2d6dffbeafe420b31a1d325d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/205042b8932b572b2d6dffbeafe420b31a1d325d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e80b21edaebbc271cc2b3f996f51694c3c9bafe6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e80b21edaebbc271cc2b3f996f51694c3c9bafe6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e80b21edaebbc271cc2b3f996f51694c3c9bafe6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e80b21edaebbc271cc2b3f996f51694c3c9bafe6/comments", "author": {"login": "jamborm", "id": 2180070, "node_id": "MDQ6VXNlcjIxODAwNzA=", "avatar_url": "https://avatars.githubusercontent.com/u/2180070?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jamborm", "html_url": "https://github.com/jamborm", "followers_url": "https://api.github.com/users/jamborm/followers", "following_url": "https://api.github.com/users/jamborm/following{/other_user}", "gists_url": "https://api.github.com/users/jamborm/gists{/gist_id}", "starred_url": "https://api.github.com/users/jamborm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jamborm/subscriptions", "organizations_url": "https://api.github.com/users/jamborm/orgs", "repos_url": "https://api.github.com/users/jamborm/repos", "events_url": "https://api.github.com/users/jamborm/events{/privacy}", "received_events_url": "https://api.github.com/users/jamborm/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "6c90babb57291ae2895175d98a5cbc4897abe621", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6c90babb57291ae2895175d98a5cbc4897abe621", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6c90babb57291ae2895175d98a5cbc4897abe621"}], "stats": {"total": 48, "additions": 44, "deletions": 4}, "files": [{"sha": "3bee8dd54f638e24bedb9188868dd26dde3405c5", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e80b21edaebbc271cc2b3f996f51694c3c9bafe6/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e80b21edaebbc271cc2b3f996f51694c3c9bafe6/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=e80b21edaebbc271cc2b3f996f51694c3c9bafe6", "patch": "@@ -1,3 +1,9 @@\n+2011-01-27  Martin Jambor  <mjambor@suse.cz>\n+\n+\tPR tree-optimization/47228\n+\t* tree-sra.c (sra_modify_assign): Use build_ref_for_model instead of\n+\tbuild_ref_for_offset.\n+\n 2011-01-27  Ulrich Weigand  <Ulrich.Weigand@de.ibm.com>\n \n \t* config/spu/spu-elf.h (ASM_SPEC): Remove."}, {"sha": "acaa86287d91bc738add30a8063538f1c8c58358", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e80b21edaebbc271cc2b3f996f51694c3c9bafe6/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e80b21edaebbc271cc2b3f996f51694c3c9bafe6/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=e80b21edaebbc271cc2b3f996f51694c3c9bafe6", "patch": "@@ -1,3 +1,8 @@\n+2011-01-27  Martin Jambor  <mjambor@suse.cz>\n+\n+\tPR tree-optimization/47228\n+\t* gcc.dg/torture/pr47228.c: New test.\n+\n 2011-01-27  Andreas Krebbel  <Andreas.Krebbel@de.ibm.com>\n \n \t* gcc.dg/tree-ssa/pr42585.c: Disable on s390 and s390x."}, {"sha": "5bc9f0ad5113585aebe88b98a1e74a4c553daf47", "filename": "gcc/testsuite/gcc.dg/torture/pr47228.c", "status": "added", "additions": 31, "deletions": 0, "changes": 31, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e80b21edaebbc271cc2b3f996f51694c3c9bafe6/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr47228.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e80b21edaebbc271cc2b3f996f51694c3c9bafe6/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr47228.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr47228.c?ref=e80b21edaebbc271cc2b3f996f51694c3c9bafe6", "patch": "@@ -0,0 +1,31 @@\n+/* { dg-do run } */\n+\n+struct S4\n+{\n+  unsigned f0:24;\n+} __attribute__((__packed__));\n+\n+struct S4 g_10 = {\n+  6210831\n+};\n+\n+struct S4 func_2 (int x)\n+{\n+  struct S4 l_8[2] = {\n+    {0}, {0}\n+  };\n+  g_10 = l_8[1];\n+  for (; x<2; x++) {\n+    struct S4 tmp = {\n+      11936567\n+    };\n+    l_8[x] = tmp;\n+  }\n+  return g_10;\n+}\n+\n+int main (void)\n+{\n+  func_2 (0);\n+  return 0;\n+}"}, {"sha": "82d760121967de669671f577a879810f28301773", "filename": "gcc/tree-sra.c", "status": "modified", "additions": 2, "deletions": 4, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e80b21edaebbc271cc2b3f996f51694c3c9bafe6/gcc%2Ftree-sra.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e80b21edaebbc271cc2b3f996f51694c3c9bafe6/gcc%2Ftree-sra.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-sra.c?ref=e80b21edaebbc271cc2b3f996f51694c3c9bafe6", "patch": "@@ -2739,15 +2739,13 @@ sra_modify_assign (gimple *stmt, gimple_stmt_iterator *gsi)\n \t      && !contains_bitfld_comp_ref_p (lhs)\n \t      && !access_has_children_p (lacc))\n \t    {\n-\t      lhs = build_ref_for_offset (loc, lhs, 0, TREE_TYPE (rhs),\n-\t\t\t\t\t  gsi, false);\n+\t      lhs = build_ref_for_model (loc, lhs, 0, racc, gsi, false);\n \t      gimple_assign_set_lhs (*stmt, lhs);\n \t    }\n \t  else if (AGGREGATE_TYPE_P (TREE_TYPE (rhs))\n \t\t   && !contains_vce_or_bfcref_p (rhs)\n \t\t   && !access_has_children_p (racc))\n-\t    rhs = build_ref_for_offset (loc, rhs, 0, TREE_TYPE (lhs),\n-\t\t\t\t\tgsi, false);\n+\t    rhs = build_ref_for_model (loc, rhs, 0, lacc, gsi, false);\n \n \t  if (!useless_type_conversion_p (TREE_TYPE (lhs), TREE_TYPE (rhs)))\n \t    {"}]}