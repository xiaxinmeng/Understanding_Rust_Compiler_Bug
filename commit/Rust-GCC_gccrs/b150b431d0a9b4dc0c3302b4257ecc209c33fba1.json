{"sha": "b150b431d0a9b4dc0c3302b4257ecc209c33fba1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjE1MGI0MzFkMGE5YjRkYzBjMzMwMmI0MjU3ZWNjMjA5YzMzZmJhMQ==", "commit": {"author": {"name": "Nicolas Roche", "email": "roche@adacore.com", "date": "2007-04-06T09:18:36Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2007-04-06T09:18:36Z"}, "message": "cstreams.c (__gnat_full_name): Fix issues on VxWorks 6.x for which absolute path can have the following form...\n\n2007-04-06  Nicolas Roche  <roche@adacore.com>\n\n\t* cstreams.c (__gnat_full_name): Fix issues on VxWorks 6.x for which\n\tabsolute path can have the following form: device:/a/b. In this case\n\t'/' should be inserted between the path and the filename.\n\nFrom-SVN: r123556", "tree": {"sha": "816123e9b77187babfffea963436935f3f060430", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/816123e9b77187babfffea963436935f3f060430"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b150b431d0a9b4dc0c3302b4257ecc209c33fba1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b150b431d0a9b4dc0c3302b4257ecc209c33fba1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b150b431d0a9b4dc0c3302b4257ecc209c33fba1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b150b431d0a9b4dc0c3302b4257ecc209c33fba1/comments", "author": {"login": "Nikokrock", "id": 7796165, "node_id": "MDQ6VXNlcjc3OTYxNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/7796165?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Nikokrock", "html_url": "https://github.com/Nikokrock", "followers_url": "https://api.github.com/users/Nikokrock/followers", "following_url": "https://api.github.com/users/Nikokrock/following{/other_user}", "gists_url": "https://api.github.com/users/Nikokrock/gists{/gist_id}", "starred_url": "https://api.github.com/users/Nikokrock/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Nikokrock/subscriptions", "organizations_url": "https://api.github.com/users/Nikokrock/orgs", "repos_url": "https://api.github.com/users/Nikokrock/repos", "events_url": "https://api.github.com/users/Nikokrock/events{/privacy}", "received_events_url": "https://api.github.com/users/Nikokrock/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "41ccd2d8c88353d35a3c3f220a7aff2d57ae2dca", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/41ccd2d8c88353d35a3c3f220a7aff2d57ae2dca", "html_url": "https://github.com/Rust-GCC/gccrs/commit/41ccd2d8c88353d35a3c3f220a7aff2d57ae2dca"}], "stats": {"total": 12, "additions": 11, "deletions": 1}, "files": [{"sha": "a45487b41b591e376f433b5bd9d2c2c40d0ec5fa", "filename": "gcc/ada/cstreams.c", "status": "modified", "additions": 11, "deletions": 1, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b150b431d0a9b4dc0c3302b4257ecc209c33fba1/gcc%2Fada%2Fcstreams.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b150b431d0a9b4dc0c3302b4257ecc209c33fba1/gcc%2Fada%2Fcstreams.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fcstreams.c?ref=b150b431d0a9b4dc0c3302b4257ecc209c33fba1", "patch": "@@ -6,7 +6,7 @@\n  *                                                                          *\n  *              Auxiliary C functions for Interfaces.C.Streams              *\n  *                                                                          *\n- *          Copyright (C) 1992-2003 Free Software Foundation, Inc.          *\n+ *          Copyright (C) 1992-2006, Free Software Foundation, Inc.         *\n  *                                                                          *\n  * GNAT is free software;  you can  redistribute it  and/or modify it under *\n  * terms of the  GNU General Public License as published  by the Free Soft- *\n@@ -211,10 +211,20 @@ __gnat_full_name (char *nam, char *buffer)\n \t  return 0;\n \t}\n \n+#ifdef __vxworks\n+      /* On VxWorks, getcwd always returns an absolute path. But this path\n+         can be also a device name like \"serial:\". In this case '/' should not\n+         be appended. As on VxWorks 6.x the returned path can starts with\n+         the device name (ex: machine:/directory), we need to test if the last\n+         character of the path is ':' to know if '/' should be appended. */\n+      if (buffer[strlen (buffer) - 1] != ':')\n+         strcat (buffer, \"/\");\n+#else\n       /* If the name returned is an absolute path, it is safe to append '/'\n \t to the path and concatenate the name of the file. */\n       if (buffer[0] == '/')\n \tstrcat (buffer, \"/\");\n+#endif\n \n       strcat (buffer, nam);\n     }"}]}