{"sha": "4c6f9770100ef079f2ce2743b320f6705b03dd4f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NGM2Zjk3NzAxMDBlZjA3OWYyY2UyNzQzYjMyMGY2NzA1YjAzZGQ0Zg==", "commit": {"author": {"name": "Adam Nemet", "email": "anemet@caviumnetworks.com", "date": "2008-10-07T00:30:00Z"}, "committer": {"name": "Adam Nemet", "email": "nemet@gcc.gnu.org", "date": "2008-10-07T00:30:00Z"}, "message": "mips.md (mulsi3_mul3, [...]): Merge these ...\n\n\t* config/mips/mips.md (mulsi3_mul3, muldi3_mul3): Merge these ...\n\t(mul<mode>3_mul3): ... into this new template.\n\ntestsuite/\n\t* gcc.target/mips/mips.exp (dg-mips-options): Set mips_new_gp to\n\t32 when -march=r3900 is passed.\n\t* testsuite/gcc.target/mips/r3900-mult.c: New test.\n\nFrom-SVN: r140922", "tree": {"sha": "759e54799611048940851e86e582891cdfdbc086", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/759e54799611048940851e86e582891cdfdbc086"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4c6f9770100ef079f2ce2743b320f6705b03dd4f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4c6f9770100ef079f2ce2743b320f6705b03dd4f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4c6f9770100ef079f2ce2743b320f6705b03dd4f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4c6f9770100ef079f2ce2743b320f6705b03dd4f/comments", "author": null, "committer": null, "parents": [{"sha": "2018c607607892f7a17c58495bbc4ccb54ad6c8b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2018c607607892f7a17c58495bbc4ccb54ad6c8b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2018c607607892f7a17c58495bbc4ccb54ad6c8b"}], "stats": {"total": 55, "additions": 31, "deletions": 24}, "files": [{"sha": "e766799ad5b6bcbab92e4cc0906fe819bb380434", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4c6f9770100ef079f2ce2743b320f6705b03dd4f/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4c6f9770100ef079f2ce2743b320f6705b03dd4f/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=4c6f9770100ef079f2ce2743b320f6705b03dd4f", "patch": "@@ -1,3 +1,8 @@\n+2008-10-06  Adam Nemet  <anemet@caviumnetworks.com>\n+\n+\t* config/mips/mips.md (mulsi3_mul3, muldi3_mul3): Merge these ...\n+\t(mul<mode>3_mul3): ... into this new template.\n+\n 2008-10-06  Aldy Hernandez  <aldyh@redhat.com>\n \n \t* gimplify.c (gimplify_arg): Add location argument.  Use it."}, {"sha": "3f56feb2ee9fc3ab1cbcb11475ea2284b8112697", "filename": "gcc/config/mips/mips.md", "status": "modified", "additions": 10, "deletions": 24, "changes": 34, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4c6f9770100ef079f2ce2743b320f6705b03dd4f/gcc%2Fconfig%2Fmips%2Fmips.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4c6f9770100ef079f2ce2743b320f6705b03dd4f/gcc%2Fconfig%2Fmips%2Fmips.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.md?ref=4c6f9770100ef079f2ce2743b320f6705b03dd4f", "patch": "@@ -1367,35 +1367,21 @@\n   DONE;\n })\n \n-(define_insn \"mulsi3_mul3\"\n-  [(set (match_operand:SI 0 \"register_operand\" \"=d,l\")\n-\t(mult:SI (match_operand:SI 1 \"register_operand\" \"d,d\")\n-\t\t (match_operand:SI 2 \"register_operand\" \"d,d\")))\n-   (clobber (match_scratch:SI 3 \"=l,X\"))]\n-  \"ISA_HAS_MUL3\"\n+(define_insn \"mul<mode>3_mul3\"\n+  [(set (match_operand:GPR 0 \"register_operand\" \"=d,l\")\n+\t(mult:GPR (match_operand:GPR 1 \"register_operand\" \"d,d\")\n+\t\t  (match_operand:GPR 2 \"register_operand\" \"d,d\")))\n+   (clobber (match_scratch:GPR 3 \"=l,X\"))]\n+  \"ISA_HAS_<D>MUL3\"\n {\n   if (which_alternative == 1)\n-    return \"mult\\t%1,%2\";\n-  if (TARGET_MIPS3900)\n+    return \"<d>mult\\t%1,%2\";\n+  if (<MODE>mode == SImode && TARGET_MIPS3900)\n     return \"mult\\t%0,%1,%2\";\n-  return \"mul\\t%0,%1,%2\";\n+  return \"<d>mul\\t%0,%1,%2\";\n }\n   [(set_attr \"type\" \"imul3,imul\")\n-   (set_attr \"mode\" \"SI\")])\n-\n-(define_insn \"muldi3_mul3\"\n-  [(set (match_operand:DI 0 \"register_operand\" \"=d,l\")\n-\t(mult:DI (match_operand:DI 1 \"register_operand\" \"d,d\")\n-\t\t (match_operand:DI 2 \"register_operand\" \"d,d\")))\n-   (clobber (match_scratch:DI 3 \"=l,X\"))]\n-  \"ISA_HAS_DMUL3\"\n-{\n-  if (which_alternative == 1)\n-    return \"dmult\\t%1,%2\";\n-  return \"dmul\\t%0,%1,%2\";\n-}\n-  [(set_attr \"type\" \"imul3,imul\")\n-   (set_attr \"mode\" \"DI\")])\n+   (set_attr \"mode\" \"<MODE>\")])\n \n ;; If a register gets allocated to LO, and we spill to memory, the reload\n ;; will include a move from LO to a GPR.  Merge it into the multiplication"}, {"sha": "d9f4f297826ad83b515b800a6370c1860da1b4b7", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4c6f9770100ef079f2ce2743b320f6705b03dd4f/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4c6f9770100ef079f2ce2743b320f6705b03dd4f/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=4c6f9770100ef079f2ce2743b320f6705b03dd4f", "patch": "@@ -1,3 +1,9 @@\n+2008-10-06  Adam Nemet  <anemet@caviumnetworks.com>\n+\n+\t* gcc.target/mips/mips.exp (dg-mips-options): Set mips_new_gp to\n+\t32 when -march=r3900 is passed.\n+\t* testsuite/gcc.target/mips/r3900-mult.c: New test.\n+\n 2008-10-06  Aldy Hernandez  <aldyh@redhat.com>\n \n \t* gcc.dg/gomp/for-1.c: Test column."}, {"sha": "8e66e0a1901e010a92bd1fd9594963f3f2f5d94d", "filename": "gcc/testsuite/gcc.target/mips/mips.exp", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4c6f9770100ef079f2ce2743b320f6705b03dd4f/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fmips.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4c6f9770100ef079f2ce2743b320f6705b03dd4f/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fmips.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fmips.exp?ref=4c6f9770100ef079f2ce2743b320f6705b03dd4f", "patch": "@@ -261,6 +261,7 @@ proc dg-mips-options {args} {\n \t    -mips[12] -\n \t    -mips32* -\n \t    -march=mips32* -\n+\t    -march=r3900 -\n \t    -march=24k* -\n \t    -mabi=32 -\n \t    -mgp32 {"}, {"sha": "393f1086e072d7e2eb9cee41c1e75601485a0b34", "filename": "gcc/testsuite/gcc.target/mips/r3900-mult.c", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4c6f9770100ef079f2ce2743b320f6705b03dd4f/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fr3900-mult.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4c6f9770100ef079f2ce2743b320f6705b03dd4f/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fr3900-mult.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fr3900-mult.c?ref=4c6f9770100ef079f2ce2743b320f6705b03dd4f", "patch": "@@ -0,0 +1,9 @@\n+/* { dg-do compile } */\n+/* { dg-mips-options \"-march=r3900\" } */\n+/* { dg-final { scan-assembler \"\\tmult\\t\\[^\\n\\]*,\\[^\\n\\]*,\" } } */\n+\n+NOMIPS16 int\n+f (int a, int b)\n+{\n+  return a * b;\n+}"}]}