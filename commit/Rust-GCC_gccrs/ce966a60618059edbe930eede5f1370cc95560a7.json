{"sha": "ce966a60618059edbe930eede5f1370cc95560a7", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Y2U5NjZhNjA2MTgwNTllZGJlOTMwZWVkZTVmMTM3MGNjOTU1NjBhNw==", "commit": {"author": {"name": "Richard Stallman", "email": "rms@gnu.org", "date": "1993-10-06T22:09:26Z"}, "committer": {"name": "Richard Stallman", "email": "rms@gnu.org", "date": "1993-10-06T22:09:26Z"}, "message": "Add peepholes for stack adjust plus pushes.\n\n(recognizer for subtracting const from reg 17):\nAdd %$ in adjspb/adjspd insns.\n\nFrom-SVN: r5648", "tree": {"sha": "25f5f16194b8486fcac623c0fe0a9d99152657db", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/25f5f16194b8486fcac623c0fe0a9d99152657db"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ce966a60618059edbe930eede5f1370cc95560a7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ce966a60618059edbe930eede5f1370cc95560a7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ce966a60618059edbe930eede5f1370cc95560a7", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ce966a60618059edbe930eede5f1370cc95560a7/comments", "author": null, "committer": null, "parents": [{"sha": "33724a9fb2d8f62576e56d51b9182bf7a2a939f2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/33724a9fb2d8f62576e56d51b9182bf7a2a939f2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/33724a9fb2d8f62576e56d51b9182bf7a2a939f2"}], "stats": {"total": 32, "additions": 30, "deletions": 2}, "files": [{"sha": "66f565537425b03bd1e4b9e084eeb7751551c475", "filename": "gcc/config/ns32k/ns32k.md", "status": "modified", "additions": 30, "deletions": 2, "changes": 32, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ce966a60618059edbe930eede5f1370cc95560a7/gcc%2Fconfig%2Fns32k%2Fns32k.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ce966a60618059edbe930eede5f1370cc95560a7/gcc%2Fconfig%2Fns32k%2Fns32k.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fns32k%2Fns32k.md?ref=ce966a60618059edbe930eede5f1370cc95560a7", "patch": "@@ -945,8 +945,8 @@\n {\n   if (GET_CODE(operands[0]) == CONST_INT && INTVAL(operands[0]) < 64\n       && INTVAL(operands[0]) > -64 && ! TARGET_32532)\n-    return \\\"adjspb %0\\\";\n-  return \\\"adjspd %0\\\";\n+    return \\\"adjspb %$%0\\\";\n+  return \\\"adjspd %$%0\\\";\n }\")\n \n (define_insn \"subsi3\"\n@@ -2583,3 +2583,31 @@\n \t(leu:QI (cc0) (const_int 0)))]\n   \"\"\n   \"slsb %0\")\n+\f\n+;; Speed up stack adjust followed by a fullword fixedpoint push.\n+\n+(define_peephole\n+  [(set (reg:SI 17) (plus:SI (reg:SI 17) (const_int 4)))\n+   (set (match_operand:SI 0 \"push_operand\" \"=m\")\n+\t(match_operand:SI 1 \"general_operand\" \"g\"))]\n+  \"! reg_mentioned_p (stack_pointer_rtx, operands[1])\"\n+  \"*\n+{\n+  return \\\"movd %1,0(sp)\\\";\n+}\")\n+\n+;; Speed up stack adjust followed by two fullword fixedpoint pushes.\n+\n+(define_peephole\n+  [(set (reg:SI 17) (plus:SI (reg:SI 17) (const_int 8)))\n+   (set (match_operand:SI 0 \"push_operand\" \"=m\")\n+\t(match_operand:SI 1 \"general_operand\" \"g\"))\n+   (set (match_operand:SI 2 \"push_operand\" \"=m\")\n+\t(match_operand:SI 3 \"general_operand\" \"g\"))]\n+  \"! reg_mentioned_p (stack_pointer_rtx, operands[1])\n+   && ! reg_mentioned_p (stack_pointer_rtx, operands[3])\"\n+  \"*\n+{\n+  return \\\"movd %1,4(sp); movd %3,0(sp)\\\";\n+}\")\n+"}]}