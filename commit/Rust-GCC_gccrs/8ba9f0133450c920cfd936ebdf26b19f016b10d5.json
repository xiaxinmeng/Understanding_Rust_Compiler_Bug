{"sha": "8ba9f0133450c920cfd936ebdf26b19f016b10d5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OGJhOWYwMTMzNDUwYzkyMGNmZDkzNmViZGYyNmIxOWYwMTZiMTBkNQ==", "commit": {"author": {"name": "Benjamin Kosnik", "email": "bkoz@redhat.com", "date": "2006-10-10T10:14:13Z"}, "committer": {"name": "Benjamin Kosnik", "email": "bkoz@gcc.gnu.org", "date": "2006-10-10T10:14:13Z"}, "message": "re PR libstdc++/29118 (Timeouts in libstdc++, libjava and libgomp testsuites)\n\n2006-10-09  Benjamin Kosnik  <bkoz@redhat.com>\n\n\tPR libstdc++/29118\n\t* src/locale_init.cc (__get_locale_mutex): New. \n\t(locale::locale): Use it.\n\t(locale::global): Use it.\n\nFrom-SVN: r117600", "tree": {"sha": "c2c560cabcd5a9374d25b6f6dd7da8d5c1b3bcb1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c2c560cabcd5a9374d25b6f6dd7da8d5c1b3bcb1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8ba9f0133450c920cfd936ebdf26b19f016b10d5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8ba9f0133450c920cfd936ebdf26b19f016b10d5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8ba9f0133450c920cfd936ebdf26b19f016b10d5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8ba9f0133450c920cfd936ebdf26b19f016b10d5/comments", "author": null, "committer": null, "parents": [{"sha": "599a964a52716fadaa2e70337d36c54b9585cf0e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/599a964a52716fadaa2e70337d36c54b9585cf0e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/599a964a52716fadaa2e70337d36c54b9585cf0e"}], "stats": {"total": 20, "additions": 16, "deletions": 4}, "files": [{"sha": "6be5a03e5d21699b918aa1ce29a6e6b62da61567", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8ba9f0133450c920cfd936ebdf26b19f016b10d5/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8ba9f0133450c920cfd936ebdf26b19f016b10d5/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=8ba9f0133450c920cfd936ebdf26b19f016b10d5", "patch": "@@ -1,3 +1,10 @@\n+2006-10-09  Benjamin Kosnik  <bkoz@redhat.com>\n+\n+\tPR libstdc++/29118\n+\t* src/locale_init.cc (__get_locale_mutex): New. \n+\t(locale::locale): Use it.\n+\t(locale::global): Use it.\t\n+\n 2006-10-09  Benjamin Kosnik  <bkoz@redhat.com>\n \n \tPR libstdc++/29095"}, {"sha": "a2c18dd84cb0212c3156463e359ebc908459cd50", "filename": "libstdc++-v3/src/locale_init.cc", "status": "modified", "additions": 9, "deletions": 4, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8ba9f0133450c920cfd936ebdf26b19f016b10d5/libstdc%2B%2B-v3%2Fsrc%2Flocale_init.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8ba9f0133450c920cfd936ebdf26b19f016b10d5/libstdc%2B%2B-v3%2Fsrc%2Flocale_init.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fsrc%2Flocale_init.cc?ref=8ba9f0133450c920cfd936ebdf26b19f016b10d5", "patch": "@@ -36,6 +36,13 @@\n \n namespace \n {\n+  __gnu_cxx::__mutex&\n+  __get_locale_mutex()\n+  {\n+    static __gnu_cxx::__mutex locale_mutex;\n+    return locale_mutex;\n+  }\n+\n   using namespace std;\n \n   typedef char fake_locale_Impl[sizeof(locale::_Impl)]\n@@ -198,16 +205,14 @@ namespace\n   __attribute__ ((aligned(__alignof__(std::__timepunct_cache<wchar_t>))));\n   fake_time_cache_w timepunct_cache_w;\n #endif\n-\n-  __gnu_cxx::__mutex locale_mutex;\n } // anonymous namespace\n \n _GLIBCXX_BEGIN_NAMESPACE(std)\n \n   locale::locale() throw() : _M_impl(0)\n   { \n     _S_initialize();\n-    __gnu_cxx::__scoped_lock sentry(locale_mutex);\n+    __gnu_cxx::__scoped_lock sentry(__get_locale_mutex());\n     _S_global->_M_add_reference();\n     _M_impl = _S_global;\n   }\n@@ -218,7 +223,7 @@ _GLIBCXX_BEGIN_NAMESPACE(std)\n     _S_initialize();\n     _Impl* __old;\n     {\n-      __gnu_cxx::__scoped_lock sentry(locale_mutex);\n+      __gnu_cxx::__scoped_lock sentry(__get_locale_mutex());\n       __old = _S_global;\n       __other._M_impl->_M_add_reference();\n       _S_global = __other._M_impl;"}]}