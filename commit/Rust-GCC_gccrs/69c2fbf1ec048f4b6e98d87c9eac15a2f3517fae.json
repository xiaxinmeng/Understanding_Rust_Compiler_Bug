{"sha": "69c2fbf1ec048f4b6e98d87c9eac15a2f3517fae", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjljMmZiZjFlYzA0OGY0YjZlOThkODdjOWVhYzE1YTJmMzUxN2ZhZQ==", "commit": {"author": {"name": "Richard Guenther", "email": "rguenther@suse.de", "date": "2011-10-06T10:34:18Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2011-10-06T10:34:18Z"}, "message": "fold-const.c (fold_ternary_loc): Also fold non-constant vector CONSTRUCTORs.\n\n2011-10-06  Richard Guenther  <rguenther@suse.de>\n\n\t* fold-const.c (fold_ternary_loc): Also fold non-constant\n\tvector CONSTRUCTORs.  Make more efficient.\n\t* tree-ssa-dom.c (cprop_operand): Don't handle virtual operands.\n\t(cprop_into_stmt): Don't propagate into virtual operands.\n\t(optimize_stmt): Really dump original statement.\n\nFrom-SVN: r179597", "tree": {"sha": "0c61e2ca7b43856f679a73d727e8eb626f35d3ff", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0c61e2ca7b43856f679a73d727e8eb626f35d3ff"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/69c2fbf1ec048f4b6e98d87c9eac15a2f3517fae", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/69c2fbf1ec048f4b6e98d87c9eac15a2f3517fae", "html_url": "https://github.com/Rust-GCC/gccrs/commit/69c2fbf1ec048f4b6e98d87c9eac15a2f3517fae", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/69c2fbf1ec048f4b6e98d87c9eac15a2f3517fae/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "50000e860242d036402fce25ea56ddc4e6d209cf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/50000e860242d036402fce25ea56ddc4e6d209cf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/50000e860242d036402fce25ea56ddc4e6d209cf"}], "stats": {"total": 33, "additions": 17, "deletions": 16}, "files": [{"sha": "ce0215de3048be4cb81e33554bae91910fed8100", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/69c2fbf1ec048f4b6e98d87c9eac15a2f3517fae/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/69c2fbf1ec048f4b6e98d87c9eac15a2f3517fae/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=69c2fbf1ec048f4b6e98d87c9eac15a2f3517fae", "patch": "@@ -1,3 +1,11 @@\n+2011-10-06  Richard Guenther  <rguenther@suse.de>\n+\n+\t* fold-const.c (fold_ternary_loc): Also fold non-constant\n+\tvector CONSTRUCTORs.  Make more efficient.\n+\t* tree-ssa-dom.c (cprop_operand): Don't handle virtual operands.\n+\t(cprop_into_stmt): Don't propagate into virtual operands.\n+\t(optimize_stmt): Really dump original statement.\n+\n 2011-10-06  Nick Clifton  <nickc@redhat.com>\n \n \t* config/rx/rx.md (smin3): Revert previous delta."}, {"sha": "404d904d3ba8d1c8ddbc6247c343c16241a246c2", "filename": "gcc/fold-const.c", "status": "modified", "additions": 9, "deletions": 16, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/69c2fbf1ec048f4b6e98d87c9eac15a2f3517fae/gcc%2Ffold-const.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/69c2fbf1ec048f4b6e98d87c9eac15a2f3517fae/gcc%2Ffold-const.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffold-const.c?ref=69c2fbf1ec048f4b6e98d87c9eac15a2f3517fae", "patch": "@@ -13647,7 +13647,7 @@ fold_ternary_loc (location_t loc, enum tree_code code, tree type,\n \n     case BIT_FIELD_REF:\n       if ((TREE_CODE (arg0) == VECTOR_CST\n-\t   || (TREE_CODE (arg0) == CONSTRUCTOR && TREE_CONSTANT (arg0)))\n+\t   || TREE_CODE (arg0) == CONSTRUCTOR)\n \t  && type == TREE_TYPE (TREE_TYPE (arg0)))\n \t{\n \t  unsigned HOST_WIDE_INT width = tree_low_cst (arg1, 1);\n@@ -13659,24 +13659,17 @@ fold_ternary_loc (location_t loc, enum tree_code code, tree type,\n \t      && (idx = idx / width)\n \t\t < TYPE_VECTOR_SUBPARTS (TREE_TYPE (arg0)))\n \t    {\n-\t      tree elements = NULL_TREE;\n-\n \t      if (TREE_CODE (arg0) == VECTOR_CST)\n-\t\telements = TREE_VECTOR_CST_ELTS (arg0);\n-\t      else\n \t\t{\n-\t\t  unsigned HOST_WIDE_INT idx;\n-\t\t  tree value;\n-\n-\t\t  FOR_EACH_CONSTRUCTOR_VALUE (CONSTRUCTOR_ELTS (arg0), idx, value)\n-\t\t    elements = tree_cons (NULL_TREE, value, elements);\n+\t\t  tree elements = TREE_VECTOR_CST_ELTS (arg0);\n+\t\t  while (idx-- > 0 && elements)\n+\t\t    elements = TREE_CHAIN (elements);\n+\t\t  if (elements)\n+\t\t    return TREE_VALUE (elements);\n \t\t}\n-\t      while (idx-- > 0 && elements)\n-\t\telements = TREE_CHAIN (elements);\n-\t      if (elements)\n-\t\treturn TREE_VALUE (elements);\n-\t      else\n-\t\treturn build_zero_cst (type);\n+\t      else if (idx < CONSTRUCTOR_NELTS (arg0))\n+\t\treturn CONSTRUCTOR_ELT (arg0, idx)->value;\n+\t      return build_zero_cst (type);\n \t    }\n \t}\n "}]}