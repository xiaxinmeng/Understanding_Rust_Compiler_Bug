{"sha": "8e1ba78f1b8eedd6c65c6f0e6d6d09a801de5d3d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OGUxYmE3OGYxYjhlZWRkNmM2NWM2ZjBlNmQ2ZDA5YTgwMWRlNWQzZA==", "commit": {"author": {"name": "Jan Hubicka", "email": "hubicka@ucw.cz", "date": "2014-09-20T03:11:04Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2014-09-20T03:11:04Z"}, "message": "ipa-visibility.c (varpool_node::externally_visible_p): Do not privatize dynamic TLS variables.\n\n\t* ipa-visibility.c (varpool_node::externally_visible_p): Do not\n\tprivatize dynamic TLS variables.\n\nFrom-SVN: r215417", "tree": {"sha": "747bbde9edb99ee3266d883a819aa1c7fa43e116", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/747bbde9edb99ee3266d883a819aa1c7fa43e116"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8e1ba78f1b8eedd6c65c6f0e6d6d09a801de5d3d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8e1ba78f1b8eedd6c65c6f0e6d6d09a801de5d3d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8e1ba78f1b8eedd6c65c6f0e6d6d09a801de5d3d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8e1ba78f1b8eedd6c65c6f0e6d6d09a801de5d3d/comments", "author": null, "committer": null, "parents": [{"sha": "26e82579383ea5d8fcf2149eaba65708893f58dc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/26e82579383ea5d8fcf2149eaba65708893f58dc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/26e82579383ea5d8fcf2149eaba65708893f58dc"}], "stats": {"total": 12, "additions": 12, "deletions": 0}, "files": [{"sha": "87907fdd6fdf30a5c454fd12c444fa1915b4ca9b", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8e1ba78f1b8eedd6c65c6f0e6d6d09a801de5d3d/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8e1ba78f1b8eedd6c65c6f0e6d6d09a801de5d3d/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=8e1ba78f1b8eedd6c65c6f0e6d6d09a801de5d3d", "patch": "@@ -1,3 +1,8 @@\n+2014-09-19  Jan Hubicka  <hubicka@ucw.cz>\n+\n+\t* ipa-visibility.c (varpool_node::externally_visible_p): Do not\n+\tprivatize dynamic TLS variables.\n+\n 2014-09-19  Jan Hubicka  <hubicka@ucw.cz>\n \n \t* diagnostic.c (warning_n): New function."}, {"sha": "ea6052f8861f10781b2dbdd8140d6403468c2e05", "filename": "gcc/ipa-visibility.c", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8e1ba78f1b8eedd6c65c6f0e6d6d09a801de5d3d/gcc%2Fipa-visibility.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8e1ba78f1b8eedd6c65c6f0e6d6d09a801de5d3d/gcc%2Fipa-visibility.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-visibility.c?ref=8e1ba78f1b8eedd6c65c6f0e6d6d09a801de5d3d", "patch": "@@ -277,6 +277,13 @@ varpool_node::externally_visible_p (void)\n   if (used_from_object_file_p ())\n     return true;\n \n+  /* Bringing TLS variables local may cause dynamic linker failures\n+     on limits of static TLS vars.  */\n+  if (DECL_THREAD_LOCAL_P (decl)\n+      && (DECL_TLS_MODEL (decl) != TLS_MODEL_EMULATED\n+\t  && DECL_TLS_MODEL (decl) != TLS_MODEL_INITIAL_EXEC))\n+    return true;\n+\n   if (DECL_HARD_REGISTER (decl))\n     return true;\n   if (DECL_PRESERVE_P (decl))"}]}