{"sha": "73c8c157adf578b5fcd51d9a55a2dc5c3484a113", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzNjOGMxNTdhZGY1NzhiNWZjZDUxZDlhNTVhMmRjNWMzNDg0YTExMw==", "commit": {"author": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1994-08-01T22:52:34Z"}, "committer": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1994-08-01T22:52:34Z"}, "message": "Handle _BSD_WCHAR_T_ like _WCHAR_T_, since at least BSD/386 1.1 uses the former instead of the latter.\n\nHandle _BSD_WCHAR_T_ like _WCHAR_T_, since at least BSD/386 1.1 uses\nthe former instead of the latter.  If _BSD_RUNE_T_ is defined, then\ndefine rune_t when we define wchar_t.  Test definedness of _GCC_SIZE_T\nas well as _GCC_SIZE_T_; likewise for _GCC_PTRDIFF_T and _GCC_WCHAR_T.\n\nFrom-SVN: r7844", "tree": {"sha": "0b4b177d5d1b2099b9c5278d893779ad437a78dd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0b4b177d5d1b2099b9c5278d893779ad437a78dd"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/73c8c157adf578b5fcd51d9a55a2dc5c3484a113", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/73c8c157adf578b5fcd51d9a55a2dc5c3484a113", "html_url": "https://github.com/Rust-GCC/gccrs/commit/73c8c157adf578b5fcd51d9a55a2dc5c3484a113", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/73c8c157adf578b5fcd51d9a55a2dc5c3484a113/comments", "author": null, "committer": null, "parents": [{"sha": "b93f0d49245cad4230a57a20cfb598975fe4e121", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b93f0d49245cad4230a57a20cfb598975fe4e121", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b93f0d49245cad4230a57a20cfb598975fe4e121"}], "stats": {"total": 36, "additions": 36, "deletions": 0}, "files": [{"sha": "11c4829f1cba9f6e34897c4f28832b1e723129d9", "filename": "gcc/ginclude/stddef.h", "status": "modified", "additions": 36, "deletions": 0, "changes": 36, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/73c8c157adf578b5fcd51d9a55a2dc5c3484a113/gcc%2Fginclude%2Fstddef.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/73c8c157adf578b5fcd51d9a55a2dc5c3484a113/gcc%2Fginclude%2Fstddef.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fginclude%2Fstddef.h?ref=73c8c157adf578b5fcd51d9a55a2dc5c3484a113", "patch": "@@ -35,9 +35,13 @@\n #ifndef _PTRDIFF_T_\n #define _PTRDIFF_T\n #endif\n+/* On BSD/386 1.1, at least, machine/ansi.h defines _BSD_WCHAR_T_\n+   instead of _WCHAR_T_. */\n #ifndef _WCHAR_T_\n+#ifndef _BSD_WCHAR_T_\n #define _WCHAR_T\n #endif\n+#endif\n /* Undef _FOO_T_ if we are supposed to define foo_t.  */\n #if defined (__need_ptrdiff_t) || defined (_STDDEF_H_)\n #undef _PTRDIFF_T_\n@@ -169,6 +173,26 @@ typedef __SIZE_TYPE__ size_t;\n #define ___int_wchar_t_h\n #define __INT_WCHAR_T_H\n #define _GCC_WCHAR_T\n+\n+/* On BSD/386 1.1, at least, machine/ansi.h defines _BSD_WCHAR_T_\n+   instead of _WCHAR_T_, and _BSD_RUNE_T_ (which, unlike the other\n+   symbols in the _FOO_T_ family, stays defined even after its\n+   corresponding type is defined).  If we define wchar_t, then we\n+   must undef _WCHAR_T_; for BSD/386 1.1 (and perhaps others), if\n+   we undef _WCHAR_T_, then we must also define rune_t, since \n+   headers like runetype.h assume that if machine/ansi.h is included,\n+   and _BSD_WCHAR_T_ is not defined, then rune_t is available.\n+   machine/ansi.h says, \"Note that _WCHAR_T_ and _RUNE_T_ must be of\n+   the same type.\" */\n+#ifdef _BSD_WCHAR_T_\n+#undef _BSD_WCHAR_T_\n+#ifdef _BSD_RUNE_T_\n+#if !defined (_ANSI_SOURCE) && !defined (_POSIX_SOURCE)\n+typedef _BSD_RUNE_T_ rune_t;\n+#endif\n+#endif\n+#endif\n+\n #ifndef __WCHAR_TYPE__\n #define __WCHAR_TYPE__ int\n #endif\n@@ -188,6 +212,8 @@ typedef __WCHAR_TYPE__ wchar_t;\n /*  In 4.3bsd-net2, leave these undefined to indicate that size_t, etc.\n     are already defined.  */\n #ifdef _ANSI_H_\n+/*  The references to _GCC_PTRDIFF_T_, _GCC_SIZE_T_, and _GCC_WCHAR_T_\n+    are probably typos and should be removed before 2.7 is released.  */\n #ifdef _GCC_PTRDIFF_T_\n #undef _PTRDIFF_T_\n #endif\n@@ -197,6 +223,16 @@ typedef __WCHAR_TYPE__ wchar_t;\n #ifdef _GCC_WCHAR_T_\n #undef _WCHAR_T_\n #endif\n+/*  The following ones are the real ones.  */\n+#ifdef _GCC_PTRDIFF_T\n+#undef _PTRDIFF_T_\n+#endif\n+#ifdef _GCC_SIZE_T\n+#undef _SIZE_T_\n+#endif\n+#ifdef _GCC_WCHAR_T\n+#undef _WCHAR_T_\n+#endif\n #endif /* _ANSI_H_ */\n \n #endif /* __sys_stdtypes_h */"}]}