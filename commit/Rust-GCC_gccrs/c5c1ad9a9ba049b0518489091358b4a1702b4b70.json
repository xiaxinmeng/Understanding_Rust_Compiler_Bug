{"sha": "c5c1ad9a9ba049b0518489091358b4a1702b4b70", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzVjMWFkOWE5YmEwNDliMDUxODQ4OTA5MTM1OGI0YTE3MDJiNGI3MA==", "commit": {"author": {"name": "Jan Hubicka", "email": "hubicka@ucw.cz", "date": "2017-07-16T10:06:00Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2017-07-16T10:06:00Z"}, "message": "tree-ssa-threadupdate.c (compute_path_counts, [...]): Use profile_probability.\n\n\t* tree-ssa-threadupdate.c (compute_path_counts,\n\tupdate_joiner_offpath_counts): Use profile_probability.\n\nFrom-SVN: r250233", "tree": {"sha": "056bb5f96494fedc48b17e193c4c673598792662", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/056bb5f96494fedc48b17e193c4c673598792662"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c5c1ad9a9ba049b0518489091358b4a1702b4b70", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c5c1ad9a9ba049b0518489091358b4a1702b4b70", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c5c1ad9a9ba049b0518489091358b4a1702b4b70", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c5c1ad9a9ba049b0518489091358b4a1702b4b70/comments", "author": null, "committer": null, "parents": [{"sha": "00aeee5636caf20262bf00270bce7eb11f3e62ab", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/00aeee5636caf20262bf00270bce7eb11f3e62ab", "html_url": "https://github.com/Rust-GCC/gccrs/commit/00aeee5636caf20262bf00270bce7eb11f3e62ab"}], "stats": {"total": 12, "additions": 8, "deletions": 4}, "files": [{"sha": "9470e63e365be2bfddc856a4ff0f816894ac0a33", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c5c1ad9a9ba049b0518489091358b4a1702b4b70/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c5c1ad9a9ba049b0518489091358b4a1702b4b70/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=c5c1ad9a9ba049b0518489091358b4a1702b4b70", "patch": "@@ -1,3 +1,8 @@\n+2017-07-07  Jan Hubicka  <hubicka@ucw.cz>\n+\n+\t* tree-ssa-threadupdate.c (compute_path_counts,\n+\tupdate_joiner_offpath_counts): Use profile_probability.\n+\n 2017-07-15  Thomas Preud'homme  <thomas.preudhomme@arm.com>\n \n \tRevert:"}, {"sha": "9da74675eefc5150220e18966073fce32c06fdb7", "filename": "gcc/tree-ssa-threadupdate.c", "status": "modified", "additions": 3, "deletions": 4, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c5c1ad9a9ba049b0518489091358b4a1702b4b70/gcc%2Ftree-ssa-threadupdate.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c5c1ad9a9ba049b0518489091358b4a1702b4b70/gcc%2Ftree-ssa-threadupdate.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-threadupdate.c?ref=c5c1ad9a9ba049b0518489091358b4a1702b4b70", "patch": "@@ -763,8 +763,7 @@ compute_path_counts (struct redirection_data *rd,\n   /* Handle incoming profile insanities.  */\n   if (total_count < path_in_count)\n     path_in_count = total_count;\n-  int onpath_scale\n-\t = path_in_count.probability_in (total_count).to_reg_br_prob_base ();\n+  profile_probability onpath_scale = path_in_count.probability_in (total_count);\n \n   /* Walk the entire path to do some more computation in order to estimate\n      how much of the path_in_count will flow out of the duplicated threading\n@@ -977,8 +976,8 @@ update_joiner_offpath_counts (edge epath, basic_block dup_bb,\n \t among the duplicated off-path edges based on their original\n \t ratio to the full off-path count (total_orig_off_path_count).\n \t */\n-      int scale = enonpath->count.probability_in (total_orig_off_path_count)\n-\t\t\t.to_reg_br_prob_base ();\n+      profile_probability scale\n+\t\t = enonpath->count.probability_in (total_orig_off_path_count);\n       /* Give the duplicated offpath edge a portion of the duplicated\n \t total.  */\n       enonpathdup->count = total_dup_off_path_count.apply_probability (scale);"}]}