{"sha": "ff14c1f700199f7b27863f55f0e42d3066939f71", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZmYxNGMxZjcwMDE5OWY3YjI3ODYzZjU1ZjBlNDJkMzA2NjkzOWY3MQ==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@redhat.com", "date": "2009-11-09T18:32:44Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "2009-11-09T18:32:44Z"}, "message": "re PR c++/41994 (ICE with &A::operator T)\n\n\tPR c++/41994\n\t* pt.c (tsubst_baselink): tsubst the name.\n\nFrom-SVN: r154041", "tree": {"sha": "6507c687d383e5e2276b90e62c5aef4ca99bc13c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6507c687d383e5e2276b90e62c5aef4ca99bc13c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ff14c1f700199f7b27863f55f0e42d3066939f71", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ff14c1f700199f7b27863f55f0e42d3066939f71", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ff14c1f700199f7b27863f55f0e42d3066939f71", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ff14c1f700199f7b27863f55f0e42d3066939f71/comments", "author": {"login": "jicama", "id": 266146, "node_id": "MDQ6VXNlcjI2NjE0Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/266146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jicama", "html_url": "https://github.com/jicama", "followers_url": "https://api.github.com/users/jicama/followers", "following_url": "https://api.github.com/users/jicama/following{/other_user}", "gists_url": "https://api.github.com/users/jicama/gists{/gist_id}", "starred_url": "https://api.github.com/users/jicama/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jicama/subscriptions", "organizations_url": "https://api.github.com/users/jicama/orgs", "repos_url": "https://api.github.com/users/jicama/repos", "events_url": "https://api.github.com/users/jicama/events{/privacy}", "received_events_url": "https://api.github.com/users/jicama/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "8b0c13a8240a7f49775c2a4e71da39db3515ec19", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8b0c13a8240a7f49775c2a4e71da39db3515ec19", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8b0c13a8240a7f49775c2a4e71da39db3515ec19"}], "stats": {"total": 26, "additions": 23, "deletions": 3}, "files": [{"sha": "f126a104d5841f499a1273ca0404a58902d61419", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ff14c1f700199f7b27863f55f0e42d3066939f71/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ff14c1f700199f7b27863f55f0e42d3066939f71/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=ff14c1f700199f7b27863f55f0e42d3066939f71", "patch": "@@ -1,3 +1,8 @@\n+2009-11-09  Jason Merrill  <jason@redhat.com>\n+\n+\tPR c++/41994\n+\t* pt.c (tsubst_baselink): tsubst the name.\n+\n 2009-11-07  Jason Merrill  <jason@redhat.com>\n \n \tPR c++/37920"}, {"sha": "3efeda80fe61524e228e9ec490cfa00774bb9592", "filename": "gcc/cp/pt.c", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ff14c1f700199f7b27863f55f0e42d3066939f71/gcc%2Fcp%2Fpt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ff14c1f700199f7b27863f55f0e42d3066939f71/gcc%2Fcp%2Fpt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fpt.c?ref=ff14c1f700199f7b27863f55f0e42d3066939f71", "patch": "@@ -10318,7 +10318,7 @@ tsubst_baselink (tree baselink, tree object_type,\n     qualifying_scope = tsubst (qualifying_scope, args,\n \t\t\t       complain, in_decl);\n     fns = BASELINK_FUNCTIONS (baselink);\n-    optype = BASELINK_OPTYPE (baselink);\n+    optype = tsubst (BASELINK_OPTYPE (baselink), args, complain, in_decl);\n     if (TREE_CODE (fns) == TEMPLATE_ID_EXPR)\n       {\n \ttemplate_id_p = true;\n@@ -10329,6 +10329,8 @@ tsubst_baselink (tree baselink, tree object_type,\n \t\t\t\t\t\tcomplain, in_decl);\n       }\n     name = DECL_NAME (get_first_fn (fns));\n+    if (IDENTIFIER_TYPENAME_P (name))\n+      name = mangle_conv_op_name_for_type (optype);\n     baselink = lookup_fnfields (qualifying_scope, name, /*protect=*/1);\n \n     /* If lookup found a single function, mark it as used at this\n@@ -10347,8 +10349,7 @@ tsubst_baselink (tree baselink, tree object_type,\n \t\t    BASELINK_FUNCTIONS (baselink),\n \t\t    template_args);\n     /* Update the conversion operator type.  */\n-    BASELINK_OPTYPE (baselink) \n-      = tsubst (optype, args, complain, in_decl);\n+    BASELINK_OPTYPE (baselink) = optype;\n \n     if (!object_type)\n       object_type = current_class_type;"}, {"sha": "a470e60eb287b5c4f5c366e34427894b609de2f0", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ff14c1f700199f7b27863f55f0e42d3066939f71/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ff14c1f700199f7b27863f55f0e42d3066939f71/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=ff14c1f700199f7b27863f55f0e42d3066939f71", "patch": "@@ -1,3 +1,8 @@\n+2009-11-09  Jason Merrill  <jason@redhat.com>\n+\n+\tPR c++/41994\n+\t* g++.dg/template/conv10.C: New.\n+\n 2009-11-07  Jason Merrill  <jason@redhat.com>\n \n \tPR c++/37920"}, {"sha": "0a001be14e1967dc13aaf637aa41356d470559b8", "filename": "gcc/testsuite/g++.dg/template/conv10.C", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ff14c1f700199f7b27863f55f0e42d3066939f71/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fconv10.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ff14c1f700199f7b27863f55f0e42d3066939f71/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fconv10.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fconv10.C?ref=ff14c1f700199f7b27863f55f0e42d3066939f71", "patch": "@@ -0,0 +1,9 @@\n+// PR c++/41994\n+\n+template<typename T> struct A\n+{\n+  operator T();\n+  A() { T (A::*f)() = &A::operator T; }\n+};\n+\n+A<int> a;"}]}