{"sha": "42f10ba5b57250506d69a0391ea7771c843ea286", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDJmMTBiYTViNTcyNTA1MDZkNjlhMDM5MWVhNzc3MWM4NDNlYTI4Ng==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2021-07-13T07:50:49Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2021-07-13T07:50:49Z"}, "message": "libgomp: Don't include limits.h instead of hidden visibility block\n\nsem.h is included in between # pragma GCC visibility push(hidden)\nand # pragma GCC visibility pop and includes limits.h there, which\nsince the introduction of sysconf declaration in recent glibcs\nin there causes trouble.  libgomp assumes it is compiled by gcc,\nso we don't really need to include limits.h there and can use\n-__INT_MAX__ - 1 instead (which clang and icc support too for years).\n\n2021-07-13  Jakub Jelinek  <jakub@redhat.com>\n\t    Florian Weimer  <fweimer@redhat.com>\n\n\t* config/linux/sem.h: Don't include limits.h.\n\t(SEM_WAIT): Define to -__INT_MAX__ - 1 instead of INT_MIN.\n\t* config/linux/affinity.c: Include limits.h.", "tree": {"sha": "a4caa808f6fb61ecf3e821ae2cdba05fad1a71c0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a4caa808f6fb61ecf3e821ae2cdba05fad1a71c0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/42f10ba5b57250506d69a0391ea7771c843ea286", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/42f10ba5b57250506d69a0391ea7771c843ea286", "html_url": "https://github.com/Rust-GCC/gccrs/commit/42f10ba5b57250506d69a0391ea7771c843ea286", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/42f10ba5b57250506d69a0391ea7771c843ea286/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "18a463bb666cc8f3421589e7641ec617acb84741", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/18a463bb666cc8f3421589e7641ec617acb84741", "html_url": "https://github.com/Rust-GCC/gccrs/commit/18a463bb666cc8f3421589e7641ec617acb84741"}], "stats": {"total": 5, "additions": 2, "deletions": 3}, "files": [{"sha": "1b636c613704079a894d28156de03a005e8cf561", "filename": "libgomp/config/linux/affinity.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/42f10ba5b57250506d69a0391ea7771c843ea286/libgomp%2Fconfig%2Flinux%2Faffinity.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/42f10ba5b57250506d69a0391ea7771c843ea286/libgomp%2Fconfig%2Flinux%2Faffinity.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Fconfig%2Flinux%2Faffinity.c?ref=42f10ba5b57250506d69a0391ea7771c843ea286", "patch": "@@ -35,6 +35,7 @@\n #include <stdio.h>\n #include <string.h>\n #include <unistd.h>\n+#include <limits.h>\n \n #ifdef HAVE_PTHREAD_AFFINITY_NP\n "}, {"sha": "a3b0e267238c9ecba7afe0c6821790f6bbff0217", "filename": "libgomp/config/linux/sem.h", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/42f10ba5b57250506d69a0391ea7771c843ea286/libgomp%2Fconfig%2Flinux%2Fsem.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/42f10ba5b57250506d69a0391ea7771c843ea286/libgomp%2Fconfig%2Flinux%2Fsem.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Fconfig%2Flinux%2Fsem.h?ref=42f10ba5b57250506d69a0391ea7771c843ea286", "patch": "@@ -33,10 +33,8 @@\n #ifndef GOMP_SEM_H\n #define GOMP_SEM_H 1\n \n-#include <limits.h> /* For INT_MIN */\n-\n typedef int gomp_sem_t;\n-#define SEM_WAIT INT_MIN\n+#define SEM_WAIT (-__INT_MAX__ - 1)\n #define SEM_INC 1\n \n extern void gomp_sem_wait_slow (gomp_sem_t *, int);"}]}