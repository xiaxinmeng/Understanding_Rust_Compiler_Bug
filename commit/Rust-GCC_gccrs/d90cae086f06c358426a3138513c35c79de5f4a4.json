{"sha": "d90cae086f06c358426a3138513c35c79de5f4a4", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDkwY2FlMDg2ZjA2YzM1ODQyNmEzMTM4NTEzYzM1Yzc5ZGU1ZjRhNA==", "commit": {"author": {"name": "Jan Hubicka", "email": "hubicka@ucw.cz", "date": "2015-02-10T16:38:31Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2015-02-10T16:38:31Z"}, "message": "re PR ipa/64982 (Many g++ failures on x86_64-apple-darwin14 with -m32.)\n\n\tPR ipa/64982\n\t* cgraphunit.c (cgraph_node::expand_thunk): Look for stdarg\n\tthunks.\n\t* method.c (use_thunk): Do not check for stdarg thunks.\n\nFrom-SVN: r220587", "tree": {"sha": "9fb7c639432aed1256e3d0c328b87087c60e352a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9fb7c639432aed1256e3d0c328b87087c60e352a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d90cae086f06c358426a3138513c35c79de5f4a4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d90cae086f06c358426a3138513c35c79de5f4a4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d90cae086f06c358426a3138513c35c79de5f4a4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d90cae086f06c358426a3138513c35c79de5f4a4/comments", "author": null, "committer": null, "parents": [{"sha": "b2f2a1c99a71af82ae7af9fa2a1f5fd80b1ee226", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b2f2a1c99a71af82ae7af9fa2a1f5fd80b1ee226", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b2f2a1c99a71af82ae7af9fa2a1f5fd80b1ee226"}], "stats": {"total": 33, "additions": 19, "deletions": 14}, "files": [{"sha": "5da067e24955562526d26cddf16e23f3b233ada9", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d90cae086f06c358426a3138513c35c79de5f4a4/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d90cae086f06c358426a3138513c35c79de5f4a4/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=d90cae086f06c358426a3138513c35c79de5f4a4", "patch": "@@ -1,3 +1,9 @@\n+2015-02-10  Jan Hubicka  <hubicka@ucw.cz>\n+\n+\tPR ipa/64982\n+\t* cgraphunit.c (cgraph_node::expand_thunk): Look for stdarg\n+\tthunks.\n+\n 2015-02-10  Trevor Saunders  <tsaunders@mozilla.com>\n \n \tPR tree-optimization/64326"}, {"sha": "48a4b35a938c724617dc5007d01b60c20479f3af", "filename": "gcc/cgraphunit.c", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d90cae086f06c358426a3138513c35c79de5f4a4/gcc%2Fcgraphunit.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d90cae086f06c358426a3138513c35c79de5f4a4/gcc%2Fcgraphunit.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcgraphunit.c?ref=d90cae086f06c358426a3138513c35c79de5f4a4", "patch": "@@ -1559,6 +1559,14 @@ cgraph_node::expand_thunk (bool output_asm_thunks, bool force_gimple_thunk)\n       thunk.thunk_p = false;\n       analyzed = false;\n     }\n+  else if (stdarg_p (TREE_TYPE (thunk_fndecl)))\n+    {\n+      error (\"generic thunk code fails for method %qD which uses %<...%>\",\n+\t     thunk_fndecl);\n+      TREE_ASM_WRITTEN (thunk_fndecl) = 1;\n+      analyzed = true;\n+      return false;\n+    }\n   else\n     {\n       tree restype;"}, {"sha": "7e282d83f51ccd9dd0aac41d05990490eff0ba5f", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d90cae086f06c358426a3138513c35c79de5f4a4/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d90cae086f06c358426a3138513c35c79de5f4a4/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=d90cae086f06c358426a3138513c35c79de5f4a4", "patch": "@@ -1,3 +1,8 @@\n+2015-02-10  Jan Hubicka  <hubicka@ucw.cz>\n+\n+\tPR ipa/64982\n+\t* method.c (use_thunk): Do not check for stdarg thunks.\n+\n 2015-02-06  Jason Merrill  <jason@redhat.com>\n \n \tPR c++/64899"}, {"sha": "33e2f3cb52fb34e2b17720f3db4bcc80e478a6cd", "filename": "gcc/cp/method.c", "status": "modified", "additions": 0, "deletions": 14, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d90cae086f06c358426a3138513c35c79de5f4a4/gcc%2Fcp%2Fmethod.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d90cae086f06c358426a3138513c35c79de5f4a4/gcc%2Fcp%2Fmethod.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fmethod.c?ref=d90cae086f06c358426a3138513c35c79de5f4a4", "patch": "@@ -418,20 +418,6 @@ use_thunk (tree thunk_fndecl, bool emit_p)\n   if (DECL_ONE_ONLY (function))\n     thunk_node->add_to_same_comdat_group (funcn);\n \n-  if (!this_adjusting\n-      || !targetm.asm_out.can_output_mi_thunk (thunk_fndecl, fixed_offset,\n-\t\t\t\t\t       virtual_value, alias))\n-    {\n-      /* If this is a covariant thunk, or we don't have the necessary\n-\t code for efficient thunks, generate a thunk function that\n-\t just makes a call to the real function.  Unfortunately, this\n-\t doesn't work for varargs.  */\n-\n-      if (varargs_function_p (function))\n-\terror (\"generic thunk code fails for method %q#D which uses %<...%>\",\n-\t       function);\n-    }\n-\n   pop_from_top_level ();\n }\n \f"}]}