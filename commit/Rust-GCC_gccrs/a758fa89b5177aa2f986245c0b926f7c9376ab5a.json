{"sha": "a758fa89b5177aa2f986245c0b926f7c9376ab5a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTc1OGZhODliNTE3N2FhMmY5ODYyNDVjMGI5MjZmN2M5Mzc2YWI1YQ==", "commit": {"author": {"name": "Aurelien Jarno", "email": "aurelien@aurel32.net", "date": "2007-05-06T02:42:36Z"}, "committer": {"name": "John David Anglin", "email": "danglin@gcc.gnu.org", "date": "2007-05-06T02:42:36Z"}, "message": "pa.md: Split tgd_load, tld_load and tie_load into pic and non-pic versions.\n\n\t* config/pa/pa.md: Split tgd_load, tld_load and tie_load\n\tinto pic and non-pic versions. Mark r19 as used for \n\ttgd_load_pic, tld_load_pic and tie_load_pic. Mark r27 as used \n\tfor tgd_load, tld_load and tie_load .\n\t* config/pa/pa.c (legitimize_tls_address): Emit pic or non-pic\n\tversion of tgd_load, tld_load and tie_load depending on the \n\tvalue of flag_pic.\n\nFrom-SVN: r124468", "tree": {"sha": "f7836b92c63908c33faaad5f099a4d9b7959e030", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f7836b92c63908c33faaad5f099a4d9b7959e030"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a758fa89b5177aa2f986245c0b926f7c9376ab5a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a758fa89b5177aa2f986245c0b926f7c9376ab5a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a758fa89b5177aa2f986245c0b926f7c9376ab5a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a758fa89b5177aa2f986245c0b926f7c9376ab5a/comments", "author": {"login": "aurel32", "id": 7688913, "node_id": "MDQ6VXNlcjc2ODg5MTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7688913?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aurel32", "html_url": "https://github.com/aurel32", "followers_url": "https://api.github.com/users/aurel32/followers", "following_url": "https://api.github.com/users/aurel32/following{/other_user}", "gists_url": "https://api.github.com/users/aurel32/gists{/gist_id}", "starred_url": "https://api.github.com/users/aurel32/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aurel32/subscriptions", "organizations_url": "https://api.github.com/users/aurel32/orgs", "repos_url": "https://api.github.com/users/aurel32/repos", "events_url": "https://api.github.com/users/aurel32/events{/privacy}", "received_events_url": "https://api.github.com/users/aurel32/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "a2aa65f063a85d23f961337510d3a9395d79de41", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a2aa65f063a85d23f961337510d3a9395d79de41", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a2aa65f063a85d23f961337510d3a9395d79de41"}], "stats": {"total": 91, "additions": 73, "deletions": 18}, "files": [{"sha": "17eb8e4a2f8bb9f234c90237697eafc28589e74c", "filename": "gcc/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a758fa89b5177aa2f986245c0b926f7c9376ab5a/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a758fa89b5177aa2f986245c0b926f7c9376ab5a/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=a758fa89b5177aa2f986245c0b926f7c9376ab5a", "patch": "@@ -1,3 +1,13 @@\n+2007-05-05  Aurelien Jarno  <aurelien@aurel32.net>\n+\n+\t* config/pa/pa.md: Split tgd_load, tld_load and tie_load\n+\tinto pic and non-pic versions. Mark r19 as used for \n+\ttgd_load_pic, tld_load_pic and tie_load_pic. Mark r27 as used \n+\tfor tgd_load, tld_load and tie_load .\n+\t* config/pa/pa.c (legitimize_tls_address): Emit pic or non-pic\n+\tversion of tgd_load, tld_load and tie_load depending on the \n+\tvalue of flag_pic.\n+\n 2007-05-04  Ulrich Drepper  <drepper@redhat.com>\n \t    Jakub Jelinek  <jakub@redhat.com>\n "}, {"sha": "7c486f1c5d4869089a02cb30ea60a78376febd26", "filename": "gcc/config/pa/pa.c", "status": "modified", "additions": 12, "deletions": 3, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a758fa89b5177aa2f986245c0b926f7c9376ab5a/gcc%2Fconfig%2Fpa%2Fpa.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a758fa89b5177aa2f986245c0b926f7c9376ab5a/gcc%2Fconfig%2Fpa%2Fpa.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fpa%2Fpa.c?ref=a758fa89b5177aa2f986245c0b926f7c9376ab5a", "patch": "@@ -733,15 +733,21 @@ legitimize_tls_address (rtx addr)\n     {\n       case TLS_MODEL_GLOBAL_DYNAMIC:\n \ttmp = gen_reg_rtx (Pmode);\n-\temit_insn (gen_tgd_load (tmp, addr));\n+\tif (flag_pic)\n+\t  emit_insn (gen_tgd_load_pic (tmp, addr));\n+\telse\n+\t  emit_insn (gen_tgd_load (tmp, addr));\n \tret = hppa_tls_call (tmp);\n \tbreak;\n \n       case TLS_MODEL_LOCAL_DYNAMIC:\n \tret = gen_reg_rtx (Pmode);\n \ttmp = gen_reg_rtx (Pmode);\n \tstart_sequence ();\n-\temit_insn (gen_tld_load (tmp, addr));\n+\tif (flag_pic)\n+\t  emit_insn (gen_tld_load_pic (tmp, addr));\n+\telse\n+\t  emit_insn (gen_tld_load (tmp, addr));\n \tt1 = hppa_tls_call (tmp);\n \tinsn = get_insns ();\n \tend_sequence ();\n@@ -757,7 +763,10 @@ legitimize_tls_address (rtx addr)\n \ttmp = gen_reg_rtx (Pmode);\n \tret = gen_reg_rtx (Pmode);\n \temit_insn (gen_tp_load (tp));\n-\temit_insn (gen_tie_load (tmp, addr));\n+\tif (flag_pic)\n+\t  emit_insn (gen_tie_load_pic (tmp, addr));\n+\telse\n+\t  emit_insn (gen_tie_load (tmp, addr));\n \temit_move_insn (ret, gen_rtx_PLUS (Pmode, tp, tmp));\n \tbreak;\n "}, {"sha": "698579a4ba9c4b5425bdd2a8331efb3801ebc7d6", "filename": "gcc/config/pa/pa.md", "status": "modified", "additions": 51, "deletions": 15, "changes": 66, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a758fa89b5177aa2f986245c0b926f7c9376ab5a/gcc%2Fconfig%2Fpa%2Fpa.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a758fa89b5177aa2f986245c0b926f7c9376ab5a/gcc%2Fconfig%2Fpa%2Fpa.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fpa%2Fpa.md?ref=a758fa89b5177aa2f986245c0b926f7c9376ab5a", "patch": "@@ -39,6 +39,9 @@\n    (UNSPEC_TLSLDBASE\t7)\n    (UNSPEC_TLSIE\t8)\n    (UNSPEC_TLSLE \t9)\n+   (UNSPEC_TLSGD_PIC   10)\n+   (UNSPEC_TLSLDM_PIC  11)\n+   (UNSPEC_TLSIE_PIC   12)\n   ])\n \n ;; UNSPEC_VOLATILE:\n@@ -10148,29 +10151,51 @@ add,l %2,%3,%3\\;bv,n %%r0(%3)\"\n (define_insn \"tgd_load\"\n  [(set (match_operand:SI 0 \"register_operand\" \"=r\")\n        (unspec:SI [(match_operand 1 \"tgd_symbolic_operand\" \"\")] UNSPEC_TLSGD))\n-  (clobber (reg:SI 1))]\n+  (clobber (reg:SI 1))\n+  (use (reg:SI 27))]\n   \"\"\n   \"*\n {\n-  if (flag_pic)\n-    return \\\"addil LT'%1-$tls_gdidx$,%%r19\\;ldo RT'%1-$tls_gdidx$(%%r1),%0\\\";\n-  else\n-    return \\\"addil LR'%1-$tls_gdidx$,%%r27\\;ldo RR'%1-$tls_gdidx$(%%r1),%0\\\";\n+  return \\\"addil LR'%1-$tls_gdidx$,%%r27\\;ldo RR'%1-$tls_gdidx$(%%r1),%0\\\";\n+}\"\n+  [(set_attr \"type\" \"multi\")\n+   (set_attr \"length\" \"8\")])\n+\n+(define_insn \"tgd_load_pic\"\n+ [(set (match_operand:SI 0 \"register_operand\" \"=r\")\n+       (unspec:SI [(match_operand 1 \"tgd_symbolic_operand\" \"\")] UNSPEC_TLSGD_PIC))\n+  (clobber (reg:SI 1))\n+  (use (reg:SI 19))]\n+  \"\"\n+  \"*\n+{\n+  return \\\"addil LT'%1-$tls_gdidx$,%%r19\\;ldo RT'%1-$tls_gdidx$(%%r1),%0\\\";\n }\"\n   [(set_attr \"type\" \"multi\")\n    (set_attr \"length\" \"8\")])\n \n (define_insn \"tld_load\"\n  [(set (match_operand:SI 0 \"register_operand\" \"=r\")\n        (unspec:SI [(match_operand 1 \"tld_symbolic_operand\" \"\")] UNSPEC_TLSLDM))\n-  (clobber (reg:SI 1))]\n+  (clobber (reg:SI 1))\n+  (use (reg:SI 27))]\n   \"\"\n   \"*\n {\n-  if (flag_pic)\n-    return \\\"addil LT'%1-$tls_ldidx$,%%r19\\;ldo RT'%1-$tls_ldidx$(%%r1),%0\\\";\n-  else\n-    return \\\"addil LR'%1-$tls_ldidx$,%%r27\\;ldo RR'%1-$tls_ldidx$(%%r1),%0\\\";\n+  return \\\"addil LR'%1-$tls_ldidx$,%%r27\\;ldo RR'%1-$tls_ldidx$(%%r1),%0\\\";\n+}\"\n+  [(set_attr \"type\" \"multi\")\n+   (set_attr \"length\" \"8\")])\n+\n+(define_insn \"tld_load_pic\"\n+ [(set (match_operand:SI 0 \"register_operand\" \"=r\")\n+       (unspec:SI [(match_operand 1 \"tld_symbolic_operand\" \"\")] UNSPEC_TLSLDM_PIC))\n+  (clobber (reg:SI 1))\n+  (use (reg:SI 19))]\n+  \"\"\n+  \"*\n+{\n+  return \\\"addil LT'%1-$tls_ldidx$,%%r19\\;ldo RT'%1-$tls_ldidx$(%%r1),%0\\\";\n }\"\n   [(set_attr \"type\" \"multi\")\n    (set_attr \"length\" \"8\")])\n@@ -10200,14 +10225,25 @@ add,l %2,%3,%3\\;bv,n %%r0(%3)\"\n (define_insn \"tie_load\"\n   [(set (match_operand:SI 0 \"register_operand\" \"=r\")\n         (unspec:SI [(match_operand 1 \"tie_symbolic_operand\" \"\")] UNSPEC_TLSIE))\n-   (clobber (reg:SI 1))]\n+   (clobber (reg:SI 1))\n+   (use (reg:SI 27))]\n   \"\"\n   \"*\n {\n-  if (flag_pic)\n-    return \\\"addil LT'%1-$tls_ieoff$,%%r19\\;ldw RT'%1-$tls_ieoff$(%%r1),%0\\\";\n-  else\n-    return \\\"addil LR'%1-$tls_ieoff$,%%r27\\;ldw RR'%1-$tls_ieoff$(%%r1),%0\\\";\n+  return \\\"addil LR'%1-$tls_ieoff$,%%r27\\;ldw RR'%1-$tls_ieoff$(%%r1),%0\\\";\n+}\"\n+  [(set_attr \"type\" \"multi\")\n+   (set_attr \"length\" \"8\")])\n+\n+(define_insn \"tie_load_pic\"\n+  [(set (match_operand:SI 0 \"register_operand\" \"=r\")\n+        (unspec:SI [(match_operand 1 \"tie_symbolic_operand\" \"\")] UNSPEC_TLSIE_PIC))\n+   (clobber (reg:SI 1))\n+   (use (reg:SI 19))]\n+  \"\"\n+  \"*\n+{\n+  return \\\"addil LT'%1-$tls_ieoff$,%%r19\\;ldw RT'%1-$tls_ieoff$(%%r1),%0\\\";\n }\"\n   [(set_attr \"type\" \"multi\")\n    (set_attr \"length\" \"8\")])"}]}