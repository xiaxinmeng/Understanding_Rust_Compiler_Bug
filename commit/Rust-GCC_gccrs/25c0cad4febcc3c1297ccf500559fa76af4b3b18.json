{"sha": "25c0cad4febcc3c1297ccf500559fa76af4b3b18", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjVjMGNhZDRmZWJjYzNjMTI5N2NjZjUwMDU1OWZhNzZhZjRiM2IxOA==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2010-02-19T18:31:01Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2010-02-19T18:31:01Z"}, "message": "ipa-struct-reorg.c (make_field_acc_node, [...]): Use XCNEW instead of xcalloc.\n\n\t* ipa-struct-reorg.c (make_field_acc_node, gen_cluster, peel_field):\n\tUse XCNEW instead of xcalloc.\n\t(add_access_to_acc_sites, create_new_var_node, add_alloc_site): Use\n\tXNEW instead of xmalloc.\n\t(get_fields): Use XNEWVEC instead of xmalloc.\n\nFrom-SVN: r156905", "tree": {"sha": "deccd998eb003b2b20566d1556826450ef0f50f7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/deccd998eb003b2b20566d1556826450ef0f50f7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/25c0cad4febcc3c1297ccf500559fa76af4b3b18", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/25c0cad4febcc3c1297ccf500559fa76af4b3b18", "html_url": "https://github.com/Rust-GCC/gccrs/commit/25c0cad4febcc3c1297ccf500559fa76af4b3b18", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/25c0cad4febcc3c1297ccf500559fa76af4b3b18/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "e19bcb67dd5942d598c282427f91437166dd565d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e19bcb67dd5942d598c282427f91437166dd565d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e19bcb67dd5942d598c282427f91437166dd565d"}], "stats": {"total": 28, "additions": 13, "deletions": 15}, "files": [{"sha": "ce842ff64bc3eeb0a92d17096772e9e501059e19", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/25c0cad4febcc3c1297ccf500559fa76af4b3b18/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/25c0cad4febcc3c1297ccf500559fa76af4b3b18/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=25c0cad4febcc3c1297ccf500559fa76af4b3b18", "patch": "@@ -1,5 +1,11 @@\n 2010-02-19  Jakub Jelinek  <jakub@redhat.com>\n \n+\t* ipa-struct-reorg.c (make_field_acc_node, gen_cluster, peel_field):\n+\tUse XCNEW instead of xcalloc.\n+\t(add_access_to_acc_sites, create_new_var_node, add_alloc_site): Use\n+\tXNEW instead of xmalloc.\n+\t(get_fields): Use XNEWVEC instead of xmalloc.\n+\n \tPR debug/43084\n \t* ipa-struct-reorg.c (add_access_to_acc_sites): For debug stmts don't\n \tpopulate vars array."}, {"sha": "e0336aa1a134ad62e2ab6e320f75edb30b6decf0", "filename": "gcc/ipa-struct-reorg.c", "status": "modified", "additions": 7, "deletions": 15, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/25c0cad4febcc3c1297ccf500559fa76af4b3b18/gcc%2Fipa-struct-reorg.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/25c0cad4febcc3c1297ccf500559fa76af4b3b18/gcc%2Fipa-struct-reorg.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-struct-reorg.c?ref=25c0cad4febcc3c1297ccf500559fa76af4b3b18", "patch": "@@ -447,9 +447,7 @@ decompose_access (tree str_decl, struct field_access_site *acc)\n static inline struct field_access_site *\n make_field_acc_node (void)\n {\n-  int size = sizeof (struct field_access_site);\n-\n-  return (struct field_access_site *) xcalloc (1, size);\n+  return XCNEW (struct field_access_site);\n }\n \n /* This function returns the structure field access, defined by STMT,\n@@ -495,7 +493,7 @@ add_access_to_acc_sites (gimple stmt, tree var, htab_t accs)\n      {\n        void **slot;\n \n-       acc = (struct access_site *) xmalloc (sizeof (struct access_site));\n+       acc = XNEW (struct access_site);\n        acc->stmt = stmt;\n        if (!is_gimple_debug (stmt))\n \t acc->vars = VEC_alloc (tree, heap, 10);\n@@ -2000,7 +1998,7 @@ create_new_var_node (tree var, d_str str)\n {\n   new_var node;\n \n-  node = (new_var) xmalloc (sizeof (struct new_var_data));\n+  node = XNEW (struct new_var_data);\n   node->orig_var = var;\n   node->new_vars = VEC_alloc (tree, heap, VEC_length (tree, str->new_types));\n   return node;\n@@ -2341,8 +2339,7 @@ get_fields (tree struct_decl, int num_fields)\n   tree t = TYPE_FIELDS (struct_decl);\n   int idx = 0;\n \n-  list =\n-    (struct field_entry *) xmalloc (num_fields * sizeof (struct field_entry));\n+  list = XNEWVEC (struct field_entry, num_fields);\n \n   for (idx = 0 ; t; t = TREE_CHAIN (t), idx++)\n     if (TREE_CODE (t) == FIELD_DECL)\n@@ -3038,8 +3035,7 @@ add_alloc_site (tree fn_decl, gimple stmt, d_str str)\n     {\n       void **slot;\n \n-      fallocs = (fallocs_t)\n-\txmalloc (sizeof (struct func_alloc_sites));\n+      fallocs = XNEW (struct func_alloc_sites);\n       fallocs->func = fn_decl;\n       fallocs->allocs = VEC_alloc (alloc_site_t, heap, 1);\n       slot = htab_find_slot_with_hash (alloc_sites, fn_decl,\n@@ -3194,10 +3190,8 @@ collect_accesses_in_bb (basic_block bb)\n static void\n gen_cluster (sbitmap fields, d_str str)\n {\n-  struct field_cluster *crr_cluster = NULL;\n+  struct field_cluster *crr_cluster = XCNEW (struct field_cluster);\n \n-  crr_cluster =\n-    (struct field_cluster *) xcalloc (1, sizeof (struct field_cluster));\n   crr_cluster->sibling = str->struct_clustering;\n   str->struct_clustering = crr_cluster;\n   crr_cluster->fields_in_cluster = fields;\n@@ -3208,10 +3202,8 @@ gen_cluster (sbitmap fields, d_str str)\n static void\n peel_field (int i, d_str ds)\n {\n-  struct field_cluster *crr_cluster = NULL;\n+  struct field_cluster *crr_cluster = XCNEW (struct field_cluster);\n \n-  crr_cluster =\n-    (struct field_cluster *) xcalloc (1, sizeof (struct field_cluster));\n   crr_cluster->sibling = ds->struct_clustering;\n   ds->struct_clustering = crr_cluster;\n   crr_cluster->fields_in_cluster ="}]}