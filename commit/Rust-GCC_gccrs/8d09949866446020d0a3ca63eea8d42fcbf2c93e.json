{"sha": "8d09949866446020d0a3ca63eea8d42fcbf2c93e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OGQwOTk0OTg2NjQ0NjAyMGQwYTNjYTYzZWVhOGQ0MmZjYmYyYzkzZQ==", "commit": {"author": {"name": "Andrew Pinski", "email": "pinskia@physics.uc.edu", "date": "2005-09-12T13:56:07Z"}, "committer": {"name": "Andrew Pinski", "email": "pinskia@gcc.gnu.org", "date": "2005-09-12T13:56:07Z"}, "message": "tree-ssa-dse.c (dse_optimize_stmt): Fix up all of V_MAY_DEF and V_MUST_DEF instead of just the first_use_p.\n\n2005-09-12  Andrew Pinski  <pinskia@physics.uc.edu>\n\n        * tree-ssa-dse.c (dse_optimize_stmt): Fix up all of V_MAY_DEF and\n        V_MUST_DEF instead of just the first_use_p.\n        Don't mark the virtual variables for renaming on the statement which\n        is being removed.\n        (pass_dse): Remove TODO_update_ssa.\n\nFrom-SVN: r104172", "tree": {"sha": "585567d020443a753efdc661b623dee6eeff37c3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/585567d020443a753efdc661b623dee6eeff37c3"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8d09949866446020d0a3ca63eea8d42fcbf2c93e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8d09949866446020d0a3ca63eea8d42fcbf2c93e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8d09949866446020d0a3ca63eea8d42fcbf2c93e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8d09949866446020d0a3ca63eea8d42fcbf2c93e/comments", "author": null, "committer": null, "parents": [{"sha": "f439f9a536087071b4593eb0dda40eb5cc592c1c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f439f9a536087071b4593eb0dda40eb5cc592c1c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f439f9a536087071b4593eb0dda40eb5cc592c1c"}], "stats": {"total": 27, "additions": 14, "deletions": 13}, "files": [{"sha": "e8dd797287062dc6e242da150ddb01cc6e1801af", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8d09949866446020d0a3ca63eea8d42fcbf2c93e/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8d09949866446020d0a3ca63eea8d42fcbf2c93e/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=8d09949866446020d0a3ca63eea8d42fcbf2c93e", "patch": "@@ -1,3 +1,11 @@\n+2005-09-12  Andrew Pinski  <pinskia@physics.uc.edu>\n+\n+\t* tree-ssa-dse.c (dse_optimize_stmt): Fix up all of V_MAY_DEF and \n+\tV_MUST_DEF instead of just the first_use_p.\n+\tDon't mark the virtual variables for renaming on the statement which \n+\tis being removed.\n+\t(pass_dse): Remove TODO_update_ssa.\n+\n 2005-09-12  J\"orn Rennecke <joern.rennecke@st.com>\n \n \tPR middle-end/23290"}, {"sha": "7087018063c6fdb1e4249d955911be23259497be", "filename": "gcc/tree-ssa-dse.c", "status": "modified", "additions": 6, "deletions": 13, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8d09949866446020d0a3ca63eea8d42fcbf2c93e/gcc%2Ftree-ssa-dse.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8d09949866446020d0a3ca63eea8d42fcbf2c93e/gcc%2Ftree-ssa-dse.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-dse.c?ref=8d09949866446020d0a3ca63eea8d42fcbf2c93e", "patch": "@@ -257,31 +257,25 @@ dse_optimize_stmt (struct dom_walk_data *walk_data,\n \t  && operand_equal_p (TREE_OPERAND (stmt, 0),\n \t\t\t      TREE_OPERAND (use_stmt, 0), 0))\n \t{\n-\t  tree def;\n-\t  ssa_op_iter iter;\n-\n \t  /* Make sure we propagate the ABNORMAL bit setting.  */\n \t  if (SSA_NAME_OCCURS_IN_ABNORMAL_PHI (USE_FROM_PTR (first_use_p)))\n \t    SSA_NAME_OCCURS_IN_ABNORMAL_PHI (usevar) = 1;\n-\t  /* Then we need to fix the operand of the consuming stmt.  */\n-\t  SET_USE (first_use_p, usevar);\n \n \t  if (dump_file && (dump_flags & TDF_DETAILS))\n             {\n               fprintf (dump_file, \"  Deleted dead store '\");\n               print_generic_expr (dump_file, bsi_stmt (bsi), dump_flags);\n               fprintf (dump_file, \"'\\n\");\n             }\n-\n+\t  /* Then we need to fix the operand of the consuming stmt.  */\n+\t  FOR_EACH_SSA_MUST_AND_MAY_DEF_OPERAND (var1, var2, stmt, op_iter)\n+\t    {\n+\t      single_imm_use (DEF_FROM_PTR (var1), &use_p, &temp);\n+\t      SET_USE (use_p, USE_FROM_PTR (var2));\n+\t    }\n \t  /* Remove the dead store.  */\n \t  bsi_remove (&bsi);\n \n-\t  /* The virtual defs for the dead statement will need to be\n-\t     updated.  Since these names are going to disappear,\n-\t     FUD chains for uses downstream need to be updated.  */\n-\t  FOR_EACH_SSA_TREE_OPERAND (def, stmt, iter, SSA_OP_VIRTUAL_DEFS)\n-\t    mark_sym_for_renaming (SSA_NAME_VAR (def));\n-\n \t  /* And release any SSA_NAMEs set in this statement back to the\n \t     SSA_NAME manager.  */\n \t  release_defs (stmt);\n@@ -408,7 +402,6 @@ struct tree_opt_pass pass_dse = {\n   0,\t\t\t\t/* todo_flags_start */\n   TODO_dump_func\n     | TODO_ggc_collect\n-    | TODO_update_ssa\n     | TODO_verify_ssa,\t\t/* todo_flags_finish */\n   0\t\t\t\t/* letter */\n };"}]}