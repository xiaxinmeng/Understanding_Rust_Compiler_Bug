{"sha": "f59d40267ba8eb4e938c02d1a8a0c890cbf1f359", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjU5ZDQwMjY3YmE4ZWI0ZTkzOGMwMmQxYThhMGM4OTBjYmYxZjM1OQ==", "commit": {"author": {"name": "Martin Sebor", "email": "msebor@redhat.com", "date": "2018-01-07T04:19:35Z"}, "committer": {"name": "Jeff Law", "email": "law@gcc.gnu.org", "date": "2018-01-07T04:19:35Z"}, "message": "re PR tree-optimization/83640 (ICE in generic_overlap, at gimple-ssa-warn-restrict.c:814)\n\n2018-01-06  Martin Sebor  <msebor@redhat.com>\n\n\tPR tree-optimization/83640\n\t* gimple-ssa-warn-restrict.c (builtin_access::builtin_access): Avoid\n\tsubtracting negative offset from size.\n\t(builtin_access::overlap): Adjust offset bounds of the access to fall\n\twithin the size of the object if possible.\n\n\tPR tree-optimization/83640\n\t* gcc.dg/Wrestrict-6.c: New test.\n\t* gcc.dg/pr83640.c: New test.\n\nFrom-SVN: r256319", "tree": {"sha": "089e39031abaa2049faac69072192fed7554808a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/089e39031abaa2049faac69072192fed7554808a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f59d40267ba8eb4e938c02d1a8a0c890cbf1f359", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f59d40267ba8eb4e938c02d1a8a0c890cbf1f359", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f59d40267ba8eb4e938c02d1a8a0c890cbf1f359", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f59d40267ba8eb4e938c02d1a8a0c890cbf1f359/comments", "author": {"login": "msebor", "id": 381149, "node_id": "MDQ6VXNlcjM4MTE0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/381149?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msebor", "html_url": "https://github.com/msebor", "followers_url": "https://api.github.com/users/msebor/followers", "following_url": "https://api.github.com/users/msebor/following{/other_user}", "gists_url": "https://api.github.com/users/msebor/gists{/gist_id}", "starred_url": "https://api.github.com/users/msebor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msebor/subscriptions", "organizations_url": "https://api.github.com/users/msebor/orgs", "repos_url": "https://api.github.com/users/msebor/repos", "events_url": "https://api.github.com/users/msebor/events{/privacy}", "received_events_url": "https://api.github.com/users/msebor/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "9ea52d27eca0c56c88a3941b413ef56950d9f5c3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9ea52d27eca0c56c88a3941b413ef56950d9f5c3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9ea52d27eca0c56c88a3941b413ef56950d9f5c3"}], "stats": {"total": 97, "additions": 95, "deletions": 2}, "files": [{"sha": "cd9971d0d1a38a197e33a6342d2fb3ce7a7957fd", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f59d40267ba8eb4e938c02d1a8a0c890cbf1f359/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f59d40267ba8eb4e938c02d1a8a0c890cbf1f359/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=f59d40267ba8eb4e938c02d1a8a0c890cbf1f359", "patch": "@@ -1,3 +1,11 @@\n+2018-01-06  Martin Sebor  <msebor@redhat.com>\n+\n+\tPR tree-optimization/83640\n+\t* gimple-ssa-warn-restrict.c (builtin_access::builtin_access): Avoid\n+\tsubtracting negative offset from size.\n+\t(builtin_access::overlap): Adjust offset bounds of the access to fall\n+\twithin the size of the object if possible.\n+\n 2018-01-06  Richard Sandiford  <richard.sandiford@linaro.org>\n \n \tPR rtl-optimization/83699"}, {"sha": "6384c5714ecfbe7cf5c7a7549513f52420a7c415", "filename": "gcc/gimple-ssa-warn-restrict.c", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f59d40267ba8eb4e938c02d1a8a0c890cbf1f359/gcc%2Fgimple-ssa-warn-restrict.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f59d40267ba8eb4e938c02d1a8a0c890cbf1f359/gcc%2Fgimple-ssa-warn-restrict.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgimple-ssa-warn-restrict.c?ref=f59d40267ba8eb4e938c02d1a8a0c890cbf1f359", "patch": "@@ -1371,8 +1371,6 @@ maybe_diag_overlap (location_t loc, gcall *call, builtin_access &acs)\n       return true;\n     }\n \n-  /* Issue \"may overlap\" diagnostics below.  */\n-\n   /* Use more concise wording when one of the offsets is unbounded\n      to avoid confusing the user with large and mostly meaningless\n      numbers.  */"}, {"sha": "3b1548dde2008a5b14d93745a18eb0931ea6eb46", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f59d40267ba8eb4e938c02d1a8a0c890cbf1f359/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f59d40267ba8eb4e938c02d1a8a0c890cbf1f359/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=f59d40267ba8eb4e938c02d1a8a0c890cbf1f359", "patch": "@@ -1,3 +1,9 @@\n+2018-01-06  Martin Sebor  <msebor@redhat.com>\n+\n+\tPR tree-optimization/83640\n+\t* gcc.dg/Wrestrict-6.c: New test.\n+\t* gcc.dg/pr83640.c: New test.\n+\n 2018-01-06  Richard Sandiford  <richard.sandiford@linaro.org>\n \n \t* gcc.target/aarch64/reg-alloc-1.c: New test."}, {"sha": "c1bb373c5cd0d4930d57eb8562d9c90791cd514a", "filename": "gcc/testsuite/gcc.dg/Wrestrict-6.c", "status": "added", "additions": 66, "deletions": 0, "changes": 66, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f59d40267ba8eb4e938c02d1a8a0c890cbf1f359/gcc%2Ftestsuite%2Fgcc.dg%2FWrestrict-6.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f59d40267ba8eb4e938c02d1a8a0c890cbf1f359/gcc%2Ftestsuite%2Fgcc.dg%2FWrestrict-6.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2FWrestrict-6.c?ref=f59d40267ba8eb4e938c02d1a8a0c890cbf1f359", "patch": "@@ -0,0 +1,66 @@\n+/* PR tree-optimization/83640 - ice in generic_overlap, at\n+   gimple-ssa-warn-restrict.c:814\n+   Test to verify that a pointer offset range whose upper bound is less\n+   than its lower bound (when interpreted as a signed integer) is handled\n+   correctly.\n+   { dg-do compile }\n+   { dg-options \"-O2 -Wrestrict\" }  */\n+\n+#include \"range.h\"\n+\n+extern char* strcpy (char*, const char*);\n+extern char* stpcpy (char*, const char*);\n+\n+void sink (void*);\n+\n+void warn_2_smax_p2 (void)\n+{\n+  char a[7] = \"01234\";\n+\n+  char *d = a;\n+\n+  ptrdiff_t i = UR (2, DIFF_MAX + (size_t)2);\n+\n+  strcpy (d, d + i);          /* { dg-warning \"accessing between 0 and 4 bytes at offsets 0 and \\\\\\[2, -\\[0-9\\]+] may overlap up to 2 bytes at offset 2\" } */\n+\n+  sink (d);\n+}\n+\n+void nowarn_3_smax_p2 (void)\n+{\n+  char a[7] = \"12345\";\n+\n+  char *d = a;\n+\n+  ptrdiff_t i = UR (3, DIFF_MAX + (size_t)2);\n+\n+  strcpy (d, d + i);\n+\n+  sink (d);\n+}\n+\n+void warn_2u_smax_p2 (void)\n+{\n+  char a[7] = \"23456\";\n+\n+  char *d = a;\n+\n+  size_t i = UR (2, DIFF_MAX + (size_t)2);\n+\n+  strcpy (d, d + i);          /* { dg-warning \"accessing between 0 and 4 bytes at offsets 0 and \\\\\\[2, -\\[0-9\\]+] may overlap up to 2 bytes at offset 2\" } */\n+\n+  sink (d);\n+}\n+\n+void nowarn_3u_smax_p2 (void)\n+{\n+  char a[7] = \"34567\";\n+\n+  char *d = a;\n+\n+  size_t i = UR (3, DIFF_MAX + (size_t)2);\n+\n+  strcpy (d, d + i);\n+\n+  sink (d);\n+}"}, {"sha": "3b4d1be72783bad980c3f851d1d85803f73c5cff", "filename": "gcc/testsuite/gcc.dg/pr83640.c", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f59d40267ba8eb4e938c02d1a8a0c890cbf1f359/gcc%2Ftestsuite%2Fgcc.dg%2Fpr83640.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f59d40267ba8eb4e938c02d1a8a0c890cbf1f359/gcc%2Ftestsuite%2Fgcc.dg%2Fpr83640.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr83640.c?ref=f59d40267ba8eb4e938c02d1a8a0c890cbf1f359", "patch": "@@ -0,0 +1,15 @@\n+/* PR tree-optimization/83640 - ice in generic_overlap, at\n+   gimple-ssa-warn-restrict.c:814\n+   { dg-do compile }\n+   { dg-options \"-O2 -Wall\" }  */\n+\n+char *foo (void);\n+\n+void\n+bar (char *b, char *c)\n+{\n+  b = c;\n+  c = foo ();\n+  __builtin_strcat (c, \"*/\");\n+  __builtin_strcat (c, b);\n+}"}]}