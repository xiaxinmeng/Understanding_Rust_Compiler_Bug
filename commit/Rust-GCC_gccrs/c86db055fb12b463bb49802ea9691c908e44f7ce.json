{"sha": "c86db055fb12b463bb49802ea9691c908e44f7ce", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Yzg2ZGIwNTVmYjEyYjQ2M2JiNDk4MDJlYTk2OTFjOTA4ZTQ0ZjdjZQ==", "commit": {"author": {"name": "Mikhail Maltsev", "email": "maltsevm@gmail.com", "date": "2015-10-23T22:36:12Z"}, "committer": {"name": "Jeff Law", "email": "law@gcc.gnu.org", "date": "2015-10-23T22:36:12Z"}, "message": "[PATCH 4/9] ENABLE_CHECKING refactoring: Fortran\n\n2015-10-05  Mikhail Maltsev  <maltsevm@gmail.com>\n\n\t* trans-common.c (create_common): Adjust to use flag_checking.\n\t* trans.c (gfc_add_modify_loc): Use gcc_checking_assert.\n\nFrom-SVN: r229273", "tree": {"sha": "ac9f8f4ec23550f1c7051ab424688f90af50735f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ac9f8f4ec23550f1c7051ab424688f90af50735f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c86db055fb12b463bb49802ea9691c908e44f7ce", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c86db055fb12b463bb49802ea9691c908e44f7ce", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c86db055fb12b463bb49802ea9691c908e44f7ce", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c86db055fb12b463bb49802ea9691c908e44f7ce/comments", "author": {"login": "miyuki", "id": 4668268, "node_id": "MDQ6VXNlcjQ2NjgyNjg=", "avatar_url": "https://avatars.githubusercontent.com/u/4668268?v=4", "gravatar_id": "", "url": "https://api.github.com/users/miyuki", "html_url": "https://github.com/miyuki", "followers_url": "https://api.github.com/users/miyuki/followers", "following_url": "https://api.github.com/users/miyuki/following{/other_user}", "gists_url": "https://api.github.com/users/miyuki/gists{/gist_id}", "starred_url": "https://api.github.com/users/miyuki/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/miyuki/subscriptions", "organizations_url": "https://api.github.com/users/miyuki/orgs", "repos_url": "https://api.github.com/users/miyuki/repos", "events_url": "https://api.github.com/users/miyuki/events{/privacy}", "received_events_url": "https://api.github.com/users/miyuki/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "9447d255f44d763533cd25ca464665fa806aeb66", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9447d255f44d763533cd25ca464665fa806aeb66", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9447d255f44d763533cd25ca464665fa806aeb66"}], "stats": {"total": 26, "additions": 14, "deletions": 12}, "files": [{"sha": "7ed2bc58c341f36b58d83a2ff2d589af0a2896ec", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c86db055fb12b463bb49802ea9691c908e44f7ce/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c86db055fb12b463bb49802ea9691c908e44f7ce/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=c86db055fb12b463bb49802ea9691c908e44f7ce", "patch": "@@ -1,3 +1,8 @@\n+2015-10-23  Mikhail Maltsev  <maltsevm@gmail.com>\n+\n+\t* trans-common.c (create_common): Adjust to use flag_checking.\n+\t* trans.c (gfc_add_modify_loc): Use gcc_checking_assert.\n+\n 2015-10-21  Martin Sebor  <msebor@redhat.com>\n \n \tPR driver/68043"}, {"sha": "ae336c15e3ead7c54c12b17c2db27bbd5296db47", "filename": "gcc/fortran/trans-common.c", "status": "modified", "additions": 7, "deletions": 8, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c86db055fb12b463bb49802ea9691c908e44f7ce/gcc%2Ffortran%2Ftrans-common.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c86db055fb12b463bb49802ea9691c908e44f7ce/gcc%2Ffortran%2Ftrans-common.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-common.c?ref=c86db055fb12b463bb49802ea9691c908e44f7ce", "patch": "@@ -686,14 +686,13 @@ create_common (gfc_common_head *com, segment_info *head, bool saw_equiv)\n       TREE_STATIC (ctor) = 1;\n       DECL_INITIAL (decl) = ctor;\n \n-#ifdef ENABLE_CHECKING\n-      {\n-\ttree field, value;\n-\tunsigned HOST_WIDE_INT idx;\n-\tFOR_EACH_CONSTRUCTOR_ELT (CONSTRUCTOR_ELTS (ctor), idx, field, value)\n-\t  gcc_assert (TREE_CODE (field) == FIELD_DECL);\n-      }\n-#endif\n+      if (flag_checking)\n+\t{\n+\t  tree field, value;\n+\t  unsigned HOST_WIDE_INT idx;\n+\t  FOR_EACH_CONSTRUCTOR_ELT (CONSTRUCTOR_ELTS (ctor), idx, field, value)\n+\t    gcc_assert (TREE_CODE (field) == FIELD_DECL);\n+\t}\n     }\n \n   /* Build component reference for each variable.  */"}, {"sha": "4eaea53dd087c8045510cb866fd2f1d31e3c3554", "filename": "gcc/fortran/trans.c", "status": "modified", "additions": 2, "deletions": 4, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c86db055fb12b463bb49802ea9691c908e44f7ce/gcc%2Ffortran%2Ftrans.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c86db055fb12b463bb49802ea9691c908e44f7ce/gcc%2Ffortran%2Ftrans.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans.c?ref=c86db055fb12b463bb49802ea9691c908e44f7ce", "patch": "@@ -151,17 +151,15 @@ gfc_add_modify_loc (location_t loc, stmtblock_t * pblock, tree lhs, tree rhs)\n {\n   tree tmp;\n \n-#ifdef ENABLE_CHECKING\n   tree t1, t2;\n   t1 = TREE_TYPE (rhs);\n   t2 = TREE_TYPE (lhs);\n   /* Make sure that the types of the rhs and the lhs are the same\n      for scalar assignments.  We should probably have something\n      similar for aggregates, but right now removing that check just\n      breaks everything.  */\n-  gcc_assert (t1 == t2\n-\t      || AGGREGATE_TYPE_P (TREE_TYPE (lhs)));\n-#endif\n+  gcc_checking_assert (t1 == t2\n+\t\t       || AGGREGATE_TYPE_P (TREE_TYPE (lhs)));\n \n   tmp = fold_build2_loc (loc, MODIFY_EXPR, void_type_node, lhs,\n \t\t\t rhs);"}]}