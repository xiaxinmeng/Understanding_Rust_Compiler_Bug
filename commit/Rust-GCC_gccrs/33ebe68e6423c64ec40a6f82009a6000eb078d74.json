{"sha": "33ebe68e6423c64ec40a6f82009a6000eb078d74", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzNlYmU2OGU2NDIzYzY0ZWM0MGE2ZjgyMDA5YTYwMDBlYjA3OGQ3NA==", "commit": {"author": {"name": "Ito Kazumitsu", "email": "kaz@maczuka.gcd.org", "date": "2003-11-27T09:16:13Z"}, "committer": {"name": "Michael Koch", "email": "mkoch@gcc.gnu.org", "date": "2003-11-27T09:16:13Z"}, "message": "GregorianCalendar.java (getLinearTime): Avoid counting the leap day of the leap year twice.\n\n2003-11-27  Ito Kazumitsu  <kaz@maczuka.gcd.org>\n\n\t* java/util/GregorianCalendar.java (getLinearTime): Avoid counting\n\tthe leap day of the leap year twice.\n\t(computeFields): First week of month is 1 not 0.\n\nFrom-SVN: r73984", "tree": {"sha": "c3e5b3e6556c8b3b8819997437729e6cd8b51ed6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c3e5b3e6556c8b3b8819997437729e6cd8b51ed6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/33ebe68e6423c64ec40a6f82009a6000eb078d74", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/33ebe68e6423c64ec40a6f82009a6000eb078d74", "html_url": "https://github.com/Rust-GCC/gccrs/commit/33ebe68e6423c64ec40a6f82009a6000eb078d74", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/33ebe68e6423c64ec40a6f82009a6000eb078d74/comments", "author": null, "committer": null, "parents": [{"sha": "0e8c0c22a533da3c330151bc2d7387b4757f7bad", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0e8c0c22a533da3c330151bc2d7387b4757f7bad", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0e8c0c22a533da3c330151bc2d7387b4757f7bad"}], "stats": {"total": 16, "additions": 12, "deletions": 4}, "files": [{"sha": "33a869218ae303e816f38735613c3ff9dfec9283", "filename": "libjava/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/33ebe68e6423c64ec40a6f82009a6000eb078d74/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/33ebe68e6423c64ec40a6f82009a6000eb078d74/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=33ebe68e6423c64ec40a6f82009a6000eb078d74", "patch": "@@ -1,3 +1,9 @@\n+2003-11-27  Ito Kazumitsu  <kaz@maczuka.gcd.org>\n+\n+\t* java/util/GregorianCalendar.java (getLinearTime): Avoid counting\n+\tthe leap day of the leap year twice.\n+\t(computeFields): First week of month is 1 not 0.\n+\n 2003-11-27  Mark Wielaard  <mark@klomp.org>\n \n \t* javax/swing/plaf/basic/BasicDefaults.java (BasicDefaults): Put"}, {"sha": "624924cd208c63d377c5abcc4bd696e039b80817", "filename": "libjava/java/util/GregorianCalendar.java", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/33ebe68e6423c64ec40a6f82009a6000eb078d74/libjava%2Fjava%2Futil%2FGregorianCalendar.java", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/33ebe68e6423c64ec40a6f82009a6000eb078d74/libjava%2Fjava%2Futil%2FGregorianCalendar.java", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjava%2Futil%2FGregorianCalendar.java?ref=33ebe68e6423c64ec40a6f82009a6000eb078d74", "patch": "@@ -1,5 +1,5 @@\n /* java.util.GregorianCalendar\n-   Copyright (C) 1998, 1999, 2001, 2002 Free Software Foundation, Inc.\n+   Copyright (C) 1998, 1999, 2001, 2002, 2003 Free Software Foundation, Inc.\n \n This file is part of GNU Classpath.\n \n@@ -264,8 +264,10 @@ private long getLinearTime(int year, int dayOfYear, int millis)\n \t//\n \t// The additional leap year factor accounts for the fact that\n \t// a leap day is not seen on Jan 1 of the leap year.\n+\t// And on and after the leap day, the leap day has already been\n+\t// included in dayOfYear. \n \tint gregOffset = (year / 400) - (year / 100) + 2;\n-\tif (isLeapYear (year, true) && dayOfYear < 31 + 29)\n+\tif (isLeapYear (year, true))\n \t  --gregOffset;\n \ttime += gregOffset * (24 * 60 * 60 * 1000L);\n       }\n@@ -604,12 +606,12 @@ protected synchronized void computeFields()\n \tcalculateDay(++day, gregorian);\n       }\n \n-    fields[DAY_OF_WEEK_IN_MONTH] = (fields[DAY_OF_MONTH] + 6) / 7;\n+    fields[DAY_OF_WEEK_IN_MONTH] = (fields[DAY_OF_MONTH] + 12) / 7;\n \n     // which day of the week are we (0..6), relative to getFirstDayOfWeek\n     int relativeWeekday = (7 + fields[DAY_OF_WEEK] - getFirstDayOfWeek()) % 7;\n \n-    fields[WEEK_OF_MONTH] = (fields[DAY_OF_MONTH] - relativeWeekday + 6) / 7;\n+    fields[WEEK_OF_MONTH] = (fields[DAY_OF_MONTH] - relativeWeekday + 12) / 7;\n \n     int weekOfYear = (fields[DAY_OF_YEAR] - relativeWeekday + 6) / 7;\n "}]}