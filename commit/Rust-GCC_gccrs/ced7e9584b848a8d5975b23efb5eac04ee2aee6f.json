{"sha": "ced7e9584b848a8d5975b23efb5eac04ee2aee6f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Y2VkN2U5NTg0Yjg0OGE4ZDU5NzViMjNlZmI1ZWFjMDRlZTJhZWU2Zg==", "commit": {"author": {"name": "Jan Hubicka", "email": "hubicka@ucw.cz", "date": "2015-12-08T22:01:41Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2015-12-08T22:01:41Z"}, "message": "re PR lto/61886 (LTO breaks fread with _FORTIFY_SOURCE=2)\n\n\n\tPR ipa/61886\n\t* ipa-visibility.c (can_replace_by_local_alias): Look through transparent\n\taliaes; refuse weakrefs.\n\t(update_visibility_by_resolution_info): Skip transparent aliases in the\n\tanalysis part\n\nFrom-SVN: r231428", "tree": {"sha": "fccadd5a0c819417c9fa8a460d16af2c7d45ea94", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/fccadd5a0c819417c9fa8a460d16af2c7d45ea94"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ced7e9584b848a8d5975b23efb5eac04ee2aee6f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ced7e9584b848a8d5975b23efb5eac04ee2aee6f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ced7e9584b848a8d5975b23efb5eac04ee2aee6f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ced7e9584b848a8d5975b23efb5eac04ee2aee6f/comments", "author": null, "committer": null, "parents": [{"sha": "54f97f900086fcc62411261205dd61e50f460421", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/54f97f900086fcc62411261205dd61e50f460421", "html_url": "https://github.com/Rust-GCC/gccrs/commit/54f97f900086fcc62411261205dd61e50f460421"}], "stats": {"total": 17, "additions": 16, "deletions": 1}, "files": [{"sha": "8554091625c017bfed8251dc244c02105c7fc823", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ced7e9584b848a8d5975b23efb5eac04ee2aee6f/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ced7e9584b848a8d5975b23efb5eac04ee2aee6f/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=ced7e9584b848a8d5975b23efb5eac04ee2aee6f", "patch": "@@ -1,3 +1,11 @@\n+2015-12-08  Jan Hubicka  <hubicka@ucw.cz>\n+\n+\tPR ipa/61886\n+\t* ipa-visibility.c (can_replace_by_local_alias): Look through transparent\n+\taliaes; refuse weakrefs.\n+\t(update_visibility_by_resolution_info): Skip transparent aliases in the\n+\tanalysis part\n+\n 2015-12-08  Jan Hubicka  <hubicka@ucw.cz>\n \n \tPR ipa/61886"}, {"sha": "5b03159197ce8d00d594a4dfee90e14ca1cadfe6", "filename": "gcc/ipa-visibility.c", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ced7e9584b848a8d5975b23efb5eac04ee2aee6f/gcc%2Fipa-visibility.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ced7e9584b848a8d5975b23efb5eac04ee2aee6f/gcc%2Fipa-visibility.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-visibility.c?ref=ced7e9584b848a8d5975b23efb5eac04ee2aee6f", "patch": "@@ -332,6 +332,13 @@ varpool_node::externally_visible_p (void)\n bool\n can_replace_by_local_alias (symtab_node *node)\n {\n+  /* Weakrefs have a reason to be non-local.  Be sure we do not replace\n+     them.  */\n+  while (node->transparent_alias && node->definition && !node->weakref)\n+    node = node->get_alias_target ();\n+  if (node->weakref)\n+    return false;\n+  \n   return (node->get_availability () > AVAIL_INTERPOSABLE\n \t  && !decl_binds_to_current_def_p (node->decl)\n \t  && !node->can_be_discarded_p ());\n@@ -392,7 +399,7 @@ update_visibility_by_resolution_info (symtab_node * node)\n     for (symtab_node *next = node->same_comdat_group;\n \t next != node; next = next->same_comdat_group)\n       {\n-\tif (!next->externally_visible)\n+\tif (!next->externally_visible || next->transparent_alias)\n \t  continue;\n \n \tbool same_def"}]}