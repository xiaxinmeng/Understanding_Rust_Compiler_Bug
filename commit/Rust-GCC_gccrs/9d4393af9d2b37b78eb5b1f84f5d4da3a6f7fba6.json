{"sha": "9d4393af9d2b37b78eb5b1f84f5d4da3a6f7fba6", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWQ0MzkzYWY5ZDJiMzdiNzhlYjViMWY4NGY1ZDRkYTNhNmY3ZmJhNg==", "commit": {"author": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2021-07-12T15:09:34Z"}, "committer": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2021-07-12T17:35:27Z"}, "message": "libstdc++: Constrain std::as_writable_bytes [PR101411]\n\nThe std::as_writable_bytes function should be constrained to only accept\nwritable spans. Currently it can be called but then gives an error in\nthe function body.\n\nSigned-off-by: Jonathan Wakely <jwakely@redhat.com>\n\nlibstdc++-v3/ChangeLog:\n\n\tPR libstdc++/101411\n\t* include/std/span (as_writable_bytes): Add requires-clause.\n\t* testsuite/23_containers/span/101411.cc: New test.", "tree": {"sha": "2a130a418f2583104f5ea1523714780cc200cf26", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2a130a418f2583104f5ea1523714780cc200cf26"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9d4393af9d2b37b78eb5b1f84f5d4da3a6f7fba6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9d4393af9d2b37b78eb5b1f84f5d4da3a6f7fba6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9d4393af9d2b37b78eb5b1f84f5d4da3a6f7fba6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9d4393af9d2b37b78eb5b1f84f5d4da3a6f7fba6/comments", "author": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3f2338b4706cdc53ab276b9a5fed7f6927404f07", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3f2338b4706cdc53ab276b9a5fed7f6927404f07", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3f2338b4706cdc53ab276b9a5fed7f6927404f07"}], "stats": {"total": 16, "additions": 16, "deletions": 0}, "files": [{"sha": "21d8f6a43a6832b6b4b07aaad2fa712df970e0cf", "filename": "libstdc++-v3/include/std/span", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9d4393af9d2b37b78eb5b1f84f5d4da3a6f7fba6/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fspan", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9d4393af9d2b37b78eb5b1f84f5d4da3a6f7fba6/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fspan", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fspan?ref=9d4393af9d2b37b78eb5b1f84f5d4da3a6f7fba6", "patch": "@@ -425,6 +425,7 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n     }\n \n   template<typename _Type, size_t _Extent>\n+    requires (!is_const_v<_Type>)\n     inline\n     span<byte, _Extent == dynamic_extent\n        ? dynamic_extent : _Extent * sizeof(_Type)>"}, {"sha": "05bdd3badbdbaefb3a436f296f14f2e3e5e580b4", "filename": "libstdc++-v3/testsuite/23_containers/span/101411.cc", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9d4393af9d2b37b78eb5b1f84f5d4da3a6f7fba6/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Fspan%2F101411.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9d4393af9d2b37b78eb5b1f84f5d4da3a6f7fba6/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Fspan%2F101411.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Fspan%2F101411.cc?ref=9d4393af9d2b37b78eb5b1f84f5d4da3a6f7fba6", "patch": "@@ -0,0 +1,15 @@\n+// { dg-options \"-std=gnu++20\" }\n+// { dg-do compile { xfail c++20 } }\n+#include <span>\n+\n+// PR libstdc++/101411\n+\n+void f(std::span<const int> s)\n+{\n+  std::as_writable_bytes(s); // { dg-error \"no matching function\" }\n+}\n+\n+void f1(std::span<const int, 1> s)\n+{\n+  std::as_writable_bytes(s); // { dg-error \"no matching function\" }\n+}"}]}