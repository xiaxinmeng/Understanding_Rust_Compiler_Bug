{"sha": "5e85fa99975d9e53b980e3f8f78732966769f9de", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NWU4NWZhOTk5NzVkOWU1M2I5ODBlM2Y4Zjc4NzMyOTY2NzY5ZjlkZQ==", "commit": {"author": {"name": "Benjamin Kosnik", "email": "bkoz@redhat.com", "date": "2002-11-20T21:22:48Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2002-11-20T21:22:48Z"}, "message": "streambuf.tcc (__copy_streambufs): Revert previous fix for the interactive half of libstdc++/6745...\n\n2002-11-20  Benjamin Kosnik  <bkoz@redhat.com>\n\t    Jonathan Lennox  <lennox@cs.columbia.edu>\n\n\t* include/bits/streambuf.tcc (__copy_streambufs):\n\tRevert previous fix for the interactive half of\n\tlibstdc++/6745, use _M_buf_size_opt to set dynamically\n\tthe correct buffer size.\n\nCo-Authored-By: Jonathan Lennox <lennox@cs.columbia.edu>\n\nFrom-SVN: r59314", "tree": {"sha": "7eb90abab5f96541a5c9d68b645072f38b70401b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7eb90abab5f96541a5c9d68b645072f38b70401b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5e85fa99975d9e53b980e3f8f78732966769f9de", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5e85fa99975d9e53b980e3f8f78732966769f9de", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5e85fa99975d9e53b980e3f8f78732966769f9de", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5e85fa99975d9e53b980e3f8f78732966769f9de/comments", "author": null, "committer": null, "parents": [{"sha": "c6de9c29fd7f0704038a889fcfec2bd013fee7ba", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c6de9c29fd7f0704038a889fcfec2bd013fee7ba", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c6de9c29fd7f0704038a889fcfec2bd013fee7ba"}], "stats": {"total": 19, "additions": 10, "deletions": 9}, "files": [{"sha": "d330a0e675b52ab72946b746b72f78e3caecddb0", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5e85fa99975d9e53b980e3f8f78732966769f9de/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5e85fa99975d9e53b980e3f8f78732966769f9de/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=5e85fa99975d9e53b980e3f8f78732966769f9de", "patch": "@@ -1,3 +1,11 @@\n+2002-11-20  Benjamin Kosnik  <bkoz@redhat.com>\n+            Jonathan Lennox  <lennox@cs.columbia.edu>\n+\n+\t* include/bits/streambuf.tcc (__copy_streambufs):\n+\tRevert previous fix for the interactive half of\n+\tlibstdc++/6745, use _M_buf_size_opt to set dynamically\n+\tthe correct buffer size.\n+\n 2002-11-20  Jonathan Wakely  <redi@gcc.gnu.org>\n \n \t* docs/html/21_strings/howto.html: Fix example code, cite Gaby's"}, {"sha": "a2e0b4b1749518abeb53ca085011c05208e47c6d", "filename": "libstdc++-v3/include/bits/streambuf.tcc", "status": "modified", "additions": 2, "deletions": 9, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5e85fa99975d9e53b980e3f8f78732966769f9de/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstreambuf.tcc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5e85fa99975d9e53b980e3f8f78732966769f9de/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstreambuf.tcc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstreambuf.tcc?ref=5e85fa99975d9e53b980e3f8f78732966769f9de", "patch": "@@ -37,10 +37,6 @@\n \n #pragma GCC system_header\n \n-#ifdef _GLIBCPP_HAVE_UNISTD_H\n-#include <unistd.h>\n-#endif\n-\n namespace std \n {\n   template<typename _CharT, typename _Traits>\n@@ -224,11 +220,8 @@ namespace std\n \t\t}\n  \t      else \n \t\t{\n-#ifdef _GLIBCPP_HAVE_ISATTY\t\t  \n-\t\t  size_t __size = isatty(0) ? 1 : static_cast<size_t>(BUFSIZ);\n-#else\n-\t\t  size_t __size = 1;\n-#endif\n+\t\t  size_t __size =\n+\t\t    __sbin->_M_buf_size_opt > 0 ? __sbin->_M_buf_size_opt : 1;\n \t\t  _CharT* __buf =\n \t\t    static_cast<_CharT*>(__builtin_alloca(sizeof(_CharT) * __size));\n \t\t  streamsize __charsread = __sbin->sgetn(__buf, __size);"}]}