{"sha": "1de8a83646644d4486ddceea6a6c102133b8f1be", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWRlOGE4MzY0NjY0NGQ0NDg2ZGRjZWVhNmE2YzEwMjEzM2I4ZjFiZQ==", "commit": {"author": {"name": "Victor Leikehman", "email": "lei@haifasphere.co.il", "date": "2004-05-15T18:20:09Z"}, "committer": {"name": "Paul Brook", "email": "pbrook@gcc.gnu.org", "date": "2004-05-15T18:20:09Z"}, "message": "* decl.c (add_init_expr_to_sym): Check for variable size arrays.\n\nFrom-SVN: r81894", "tree": {"sha": "ee975035bf26be32393490e253e09668af0046ff", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ee975035bf26be32393490e253e09668af0046ff"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1de8a83646644d4486ddceea6a6c102133b8f1be", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1de8a83646644d4486ddceea6a6c102133b8f1be", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1de8a83646644d4486ddceea6a6c102133b8f1be", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1de8a83646644d4486ddceea6a6c102133b8f1be/comments", "author": null, "committer": null, "parents": [{"sha": "e2bb53e59a21c042db3e0b605752e683d62618cc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e2bb53e59a21c042db3e0b605752e683d62618cc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e2bb53e59a21c042db3e0b605752e683d62618cc"}], "stats": {"total": 20, "additions": 19, "deletions": 1}, "files": [{"sha": "00e6be2f6db7423f57523dc4ff65f65102d6a4a0", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1de8a83646644d4486ddceea6a6c102133b8f1be/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1de8a83646644d4486ddceea6a6c102133b8f1be/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=1de8a83646644d4486ddceea6a6c102133b8f1be", "patch": "@@ -1,3 +1,7 @@\n+2004-05-15  Victor Leikehman  <lei@haifasphere.co.il>\n+\n+\t* decl.c (add_init_expr_to_sym): Check for variable size arrays.\n+\n 2004-05-15  Tobias Schlueter  <tobias.schlueter@physik.uni-muenchen.de>\n \n \t* primary.c (match_boz_constant): Use gfc_notify_std() for"}, {"sha": "c36c7bad51d3073e4ea18bc7606ec61df19b0638", "filename": "gcc/fortran/decl.c", "status": "modified", "additions": 15, "deletions": 1, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1de8a83646644d4486ddceea6a6c102133b8f1be/gcc%2Ffortran%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1de8a83646644d4486ddceea6a6c102133b8f1be/gcc%2Ffortran%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fdecl.c?ref=1de8a83646644d4486ddceea6a6c102133b8f1be", "patch": "@@ -254,6 +254,7 @@ static try\n add_init_expr_to_sym (const char *name, gfc_expr ** initp,\n \t\t      locus * var_locus)\n {\n+  int i;\n   symbol_attribute attr;\n   gfc_symbol *sym;\n   gfc_expr *init;\n@@ -287,7 +288,7 @@ add_init_expr_to_sym (const char *name, gfc_expr ** initp,\n   else\n     {\n       /* If a variable appears in a DATA block, it cannot have an\n-         initializer.  */\n+\t initializer.  */\n       if (sym->attr.data)\n \t{\n \t  gfc_error\n@@ -301,6 +302,19 @@ add_init_expr_to_sym (const char *name, gfc_expr ** initp,\n \t  && gfc_check_assign_symbol (sym, init) == FAILURE)\n \treturn FAILURE;\n \n+      for (i = 0; i < sym->attr.dimension; i++)\n+\t{\n+\t  if (sym->as->lower[i] == NULL\n+\t      || sym->as->lower[i]->expr_type != EXPR_CONSTANT\n+\t      || sym->as->upper[i] == NULL\n+\t      || sym->as->upper[i]->expr_type != EXPR_CONSTANT)\n+\t    {\n+\t      gfc_error (\"Array '%s' at %C cannot have initializer\",\n+\t\t\t sym->name);\n+\t      return FAILURE;\n+\t    }\n+\t}\n+\n       /* Add initializer.  Make sure we keep the ranks sane.  */\n       if (sym->attr.dimension && init->rank == 0)\n \tinit->rank = sym->as->rank;"}]}