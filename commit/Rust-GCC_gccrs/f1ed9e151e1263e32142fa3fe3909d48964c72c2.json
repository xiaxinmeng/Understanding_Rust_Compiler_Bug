{"sha": "f1ed9e151e1263e32142fa3fe3909d48964c72c2", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjFlZDllMTUxZTEyNjNlMzIxNDJmYTNmZTM5MDlkNDg5NjRjNzJjMg==", "commit": {"author": {"name": "Janus Weil", "email": "janus@gcc.gnu.org", "date": "2014-02-21T22:54:50Z"}, "committer": {"name": "Janus Weil", "email": "janus@gcc.gnu.org", "date": "2014-02-21T22:54:50Z"}, "message": "re PR fortran/60302 (ICE with c_f_pointer and android cross compiler)\n\n2014-02-21  Janus Weil  <janus@gcc.gnu.org>\n\n\tPR fortran/60302\n\t* check.c (gfc_check_c_f_pointer): Only clear 'size' if 'gfc_array_size'\n\tis successful.\n\n\n2014-02-21  Janus Weil  <janus@gcc.gnu.org>\n\n\tPR fortran/60302\n\t* gfortran.dg/c_f_pointer_shape_tests_6.f90: New.\n\nFrom-SVN: r208033", "tree": {"sha": "ad96c11489b4f82b4d9dcd96d716aa8436b7a1eb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ad96c11489b4f82b4d9dcd96d716aa8436b7a1eb"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f1ed9e151e1263e32142fa3fe3909d48964c72c2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f1ed9e151e1263e32142fa3fe3909d48964c72c2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f1ed9e151e1263e32142fa3fe3909d48964c72c2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f1ed9e151e1263e32142fa3fe3909d48964c72c2/comments", "author": {"login": "janusw", "id": 484108, "node_id": "MDQ6VXNlcjQ4NDEwOA==", "avatar_url": "https://avatars.githubusercontent.com/u/484108?v=4", "gravatar_id": "", "url": "https://api.github.com/users/janusw", "html_url": "https://github.com/janusw", "followers_url": "https://api.github.com/users/janusw/followers", "following_url": "https://api.github.com/users/janusw/following{/other_user}", "gists_url": "https://api.github.com/users/janusw/gists{/gist_id}", "starred_url": "https://api.github.com/users/janusw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/janusw/subscriptions", "organizations_url": "https://api.github.com/users/janusw/orgs", "repos_url": "https://api.github.com/users/janusw/repos", "events_url": "https://api.github.com/users/janusw/events{/privacy}", "received_events_url": "https://api.github.com/users/janusw/received_events", "type": "User", "site_admin": false}, "committer": {"login": "janusw", "id": 484108, "node_id": "MDQ6VXNlcjQ4NDEwOA==", "avatar_url": "https://avatars.githubusercontent.com/u/484108?v=4", "gravatar_id": "", "url": "https://api.github.com/users/janusw", "html_url": "https://github.com/janusw", "followers_url": "https://api.github.com/users/janusw/followers", "following_url": "https://api.github.com/users/janusw/following{/other_user}", "gists_url": "https://api.github.com/users/janusw/gists{/gist_id}", "starred_url": "https://api.github.com/users/janusw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/janusw/subscriptions", "organizations_url": "https://api.github.com/users/janusw/orgs", "repos_url": "https://api.github.com/users/janusw/repos", "events_url": "https://api.github.com/users/janusw/events{/privacy}", "received_events_url": "https://api.github.com/users/janusw/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d723358d0167b16e3fdffe71e4e5267e3ce01a5f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d723358d0167b16e3fdffe71e4e5267e3ce01a5f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d723358d0167b16e3fdffe71e4e5267e3ce01a5f"}], "stats": {"total": 40, "additions": 33, "deletions": 7}, "files": [{"sha": "995ede78f833cc86939ea07fa4d847fbd7c6a1c3", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f1ed9e151e1263e32142fa3fe3909d48964c72c2/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f1ed9e151e1263e32142fa3fe3909d48964c72c2/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=f1ed9e151e1263e32142fa3fe3909d48964c72c2", "patch": "@@ -1,3 +1,9 @@\n+2014-02-21  Janus Weil  <janus@gcc.gnu.org>\n+\n+\tPR fortran/60302\n+\t* check.c (gfc_check_c_f_pointer): Only clear 'size' if 'gfc_array_size'\n+\tis successful.\n+\n 2014-02-21  Janus Weil  <janus@gcc.gnu.org>\n \n \tPR fortran/60234"}, {"sha": "119750aab8f26d6dabeb8ed43f7d5fea90059f3a", "filename": "gcc/fortran/check.c", "status": "modified", "additions": 8, "deletions": 7, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f1ed9e151e1263e32142fa3fe3909d48964c72c2/gcc%2Ffortran%2Fcheck.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f1ed9e151e1263e32142fa3fe3909d48964c72c2/gcc%2Ffortran%2Fcheck.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fcheck.c?ref=f1ed9e151e1263e32142fa3fe3909d48964c72c2", "patch": "@@ -3944,16 +3944,17 @@ gfc_check_c_f_pointer (gfc_expr *cptr, gfc_expr *fptr, gfc_expr *shape)\n   if (shape)\n     {\n       mpz_t size;\n-\n-      if (gfc_array_size (shape, &size)\n-\t  && mpz_cmp_ui (size, fptr->rank) != 0)\n+      if (gfc_array_size (shape, &size))\n \t{\n+\t  if (mpz_cmp_ui (size, fptr->rank) != 0)\n+\t    {\n+\t      mpz_clear (size);\n+\t      gfc_error (\"SHAPE argument at %L to C_F_POINTER must have the same \"\n+\t\t\t\"size as the RANK of FPTR\", &shape->where);\n+\t      return false;\n+\t    }\n \t  mpz_clear (size);\n-\t  gfc_error (\"SHAPE argument at %L to C_F_POINTER must have the same \"\n-\t\t     \"size as the RANK of FPTR\", &shape->where);\n-\t  return false;\n \t}\n-      mpz_clear (size);\n     }\n \n   if (fptr->ts.type == BT_CLASS)"}, {"sha": "030107932f1311ed4150032a9260bcc1950c9ebf", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f1ed9e151e1263e32142fa3fe3909d48964c72c2/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f1ed9e151e1263e32142fa3fe3909d48964c72c2/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=f1ed9e151e1263e32142fa3fe3909d48964c72c2", "patch": "@@ -1,3 +1,8 @@\n+2014-02-21  Janus Weil  <janus@gcc.gnu.org>\n+\n+\tPR fortran/60302\n+\t* gfortran.dg/c_f_pointer_shape_tests_6.f90: New.\n+\n 2014-02-21  Bill Schmidt  <wschmidt@linux.vnet.ibm.com>\n \n \t* gcc.dg/vmx/vsums.c: Check entire result vector."}, {"sha": "dd9b16366422d6c73bd4d5ce9d546ea9ec4d43f9", "filename": "gcc/testsuite/gfortran.dg/c_f_pointer_shape_tests_6.f90", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f1ed9e151e1263e32142fa3fe3909d48964c72c2/gcc%2Ftestsuite%2Fgfortran.dg%2Fc_f_pointer_shape_tests_6.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f1ed9e151e1263e32142fa3fe3909d48964c72c2/gcc%2Ftestsuite%2Fgfortran.dg%2Fc_f_pointer_shape_tests_6.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fc_f_pointer_shape_tests_6.f90?ref=f1ed9e151e1263e32142fa3fe3909d48964c72c2", "patch": "@@ -0,0 +1,14 @@\n+! { dg-do compile }\n+!\n+! PR 60302: [4.9 Regression] ICE with c_f_pointer and android cross compiler\n+!\n+! Contributed by Valery Weber <valeryweber@hotmail.com>\n+\n+subroutine reshape_inplace_c2_c2 (new_shape)\n+  use, intrinsic :: iso_c_binding\n+  implicit none\n+  integer :: new_shape(:)\n+  complex, pointer :: ptr_x(:)\n+  type(c_ptr) :: loc_x\n+  call c_f_pointer (loc_x, ptr_x, new_shape)\n+end subroutine"}]}