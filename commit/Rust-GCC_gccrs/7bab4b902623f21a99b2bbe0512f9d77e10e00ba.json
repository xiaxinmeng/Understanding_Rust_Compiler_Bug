{"sha": "7bab4b902623f21a99b2bbe0512f9d77e10e00ba", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2JhYjRiOTAyNjIzZjIxYTk5YjJiYmUwNTEyZjlkNzdlMTBlMDBiYQ==", "commit": {"author": {"name": "Bernd Schmidt", "email": "bernd.schmidt@analog.com", "date": "2006-05-17T09:44:35Z"}, "committer": {"name": "Bernd Schmidt", "email": "bernds@gcc.gnu.org", "date": "2006-05-17T09:44:35Z"}, "message": "temp2.C: New test.\n\n\t* g++.dg/opt/temp2.C: New test.\n\nFrom-SVN: r113851", "tree": {"sha": "5d76078ec5c20ef4d861f5ca3692608edae67894", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5d76078ec5c20ef4d861f5ca3692608edae67894"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7bab4b902623f21a99b2bbe0512f9d77e10e00ba", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7bab4b902623f21a99b2bbe0512f9d77e10e00ba", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7bab4b902623f21a99b2bbe0512f9d77e10e00ba", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7bab4b902623f21a99b2bbe0512f9d77e10e00ba/comments", "author": null, "committer": null, "parents": [{"sha": "33598a1b8e670a9e36b8be056c7f610cd26fe0be", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/33598a1b8e670a9e36b8be056c7f610cd26fe0be", "html_url": "https://github.com/Rust-GCC/gccrs/commit/33598a1b8e670a9e36b8be056c7f610cd26fe0be"}], "stats": {"total": 66, "additions": 66, "deletions": 0}, "files": [{"sha": "bc6e789bf51a2f4b336a2afad00519e672421157", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7bab4b902623f21a99b2bbe0512f9d77e10e00ba/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7bab4b902623f21a99b2bbe0512f9d77e10e00ba/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=7bab4b902623f21a99b2bbe0512f9d77e10e00ba", "patch": "@@ -1,3 +1,7 @@\n+2005-05-17  Bernd Schmidt  <bernd.schmidt@analog.com>\n+\n+\t* g++.dg/opt/temp2.C: New test.\n+\n 2006-05-17  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR c++/27491"}, {"sha": "35520a2427c839e27752be624eb252e3544d8ca4", "filename": "gcc/testsuite/g++.dg/opt/temp2.C", "status": "added", "additions": 62, "deletions": 0, "changes": 62, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7bab4b902623f21a99b2bbe0512f9d77e10e00ba/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fopt%2Ftemp2.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7bab4b902623f21a99b2bbe0512f9d77e10e00ba/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fopt%2Ftemp2.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fopt%2Ftemp2.C?ref=7bab4b902623f21a99b2bbe0512f9d77e10e00ba", "patch": "@@ -0,0 +1,62 @@\n+// { dg-do run }\n+\n+// Copyright (C) 2006 Free Software Foundation, Inc.\n+\n+// Originally from PR 16681, found also in init/array15.C\n+// This variant of the testcase verifies that we do not create\n+// a temporary on the stack, which is PR 27620.\n+\n+int i;\n+\n+extern \"C\"\n+void *memcpy (void *dest, const void *src, __SIZE_TYPE__ n)\n+{\n+  char *d = (char *) dest;\n+  const char *s = (const char *) src;\n+  while (n--)\n+    d[n] = s[n];\n+  ++i;\n+  return dest;\n+}\n+\n+struct foo {\n+  unsigned char buffer[41112];\n+  foo() ;\n+  bool check () const;\n+};\n+\n+foo::foo ()\n+  : buffer()\n+{}\n+\n+bool foo::check () const\n+{\n+  for (unsigned ix = sizeof (buffer); ix--;)\n+    if (buffer[ix])\n+      return false;\n+  return true;\n+}\n+\n+void *operator new (__SIZE_TYPE__ size, void *p)\n+{\n+  return p;\n+}\n+\n+char heap[50000];\n+\n+int main ()\n+{\n+  for (unsigned ix = sizeof (heap); ix--;)\n+    heap[ix] = ix;\n+\n+  i = 0;\n+  foo *f = new (heap) foo ();\n+\n+  if (i != 0)\n+    return 1;\n+  if (!f->check ())\n+    return 1;\n+  return 0;\n+}\n+\n+  "}]}