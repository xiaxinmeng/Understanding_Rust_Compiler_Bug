{"sha": "88020bd8ea3599aacf21218df9f8f7dbb8e15cff", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODgwMjBiZDhlYTM1OTlhYWNmMjEyMThkZjlmOGY3ZGJiOGUxNWNmZg==", "commit": {"author": {"name": "Mark Mitchell", "email": "mark@codesourcery.com", "date": "2004-03-17T04:33:28Z"}, "committer": {"name": "Mark Mitchell", "email": "mmitchel@gcc.gnu.org", "date": "2004-03-17T04:33:28Z"}, "message": "re PR c++/14481 (strange warning when assigning to bitfield)\n\n\tPR c++/14481\n\t* fold-const.c (fold): Set TREE_NO_UNUSED_WARNING on implicitly\n\tgenerated COMPOUND_EXPRs.\n\n\tPR c++/14481\n\t* g++.dg/warn/Wunused-7.C: New test.\n\nFrom-SVN: r79570", "tree": {"sha": "db986d888c5c1503a9a42244b70a049fbedc32d0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/db986d888c5c1503a9a42244b70a049fbedc32d0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/88020bd8ea3599aacf21218df9f8f7dbb8e15cff", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/88020bd8ea3599aacf21218df9f8f7dbb8e15cff", "html_url": "https://github.com/Rust-GCC/gccrs/commit/88020bd8ea3599aacf21218df9f8f7dbb8e15cff", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/88020bd8ea3599aacf21218df9f8f7dbb8e15cff/comments", "author": null, "committer": null, "parents": [{"sha": "bf3864fe15178a34c0445b0b834dada0fe3aeded", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bf3864fe15178a34c0445b0b834dada0fe3aeded", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bf3864fe15178a34c0445b0b834dada0fe3aeded"}], "stats": {"total": 36, "additions": 30, "deletions": 6}, "files": [{"sha": "894d105237ec1c4b9d7d341d3fe127f2946485e1", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/88020bd8ea3599aacf21218df9f8f7dbb8e15cff/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/88020bd8ea3599aacf21218df9f8f7dbb8e15cff/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=88020bd8ea3599aacf21218df9f8f7dbb8e15cff", "patch": "@@ -1,3 +1,9 @@\n+2004-03-16  Mark Mitchell  <mark@codesourcery.com>\n+\n+\tPR c++/14481\n+\t* fold-const.c (fold): Set TREE_NO_UNUSED_WARNING on implicitly\n+\tgenerated COMPOUND_EXPRs.\n+\n 2004-03-16  Ralf Corsepius <corsepiu@faw.uni-ulm.de>\n \n \t* config/h8300/t-rtems (h8300-*-rtems*): New."}, {"sha": "41683399f5c1250478a4328f1944e0ee03059136", "filename": "gcc/fold-const.c", "status": "modified", "additions": 7, "deletions": 6, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/88020bd8ea3599aacf21218df9f8f7dbb8e15cff/gcc%2Ffold-const.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/88020bd8ea3599aacf21218df9f8f7dbb8e15cff/gcc%2Ffold-const.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffold-const.c?ref=88020bd8ea3599aacf21218df9f8f7dbb8e15cff", "patch": "@@ -1392,7 +1392,7 @@ int_const_binop (enum tree_code code, tree arg1, tree arg2, int notrunc)\n       && ((hi == 0 && (HOST_WIDE_INT) low >= 0)\n \t  || (hi == -1 && (HOST_WIDE_INT) low < 0))\n       && overflow == 0 && ! TREE_OVERFLOW (arg1) && ! TREE_OVERFLOW (arg2))\n-    return size_int_type_wide (low, type);\n+    return size_int_type (low, type);\n   else\n     {\n       t = build_int_2 (low, hi);\n@@ -1598,7 +1598,7 @@ size_htab_eq (const void *x, const void *y)\n tree\n size_int_wide (HOST_WIDE_INT number, enum size_type_kind kind)\n {\n-  return size_int_type_wide (number, sizetype_tab[(int) kind]);\n+  return size_int_type (number, sizetype_tab[(int) kind]);\n }\n \n /* Likewise, but the desired type is specified explicitly.  */\n@@ -1608,7 +1608,7 @@ static GTY ((if_marked (\"ggc_marked_p\"), param_is (union tree_node)))\n      htab_t size_htab;\n \n tree\n-size_int_type_wide (HOST_WIDE_INT number, tree type)\n+size_int_type_wide (HOST_WIDE_INT high, HOST_WIDE_INT low, tree type)\n {\n   void **slot;\n \n@@ -1621,8 +1621,8 @@ size_int_type_wide (HOST_WIDE_INT number, tree type)\n   /* Adjust NEW_CONST to be the constant we want.  If it's already in the\n      hash table, we return the value from the hash table.  Otherwise, we\n      place that in the hash table and make a new node for the next time.  */\n-  TREE_INT_CST_LOW (new_const) = number;\n-  TREE_INT_CST_HIGH (new_const) = number < 0 ? -1 : 0;\n+  TREE_INT_CST_LOW (new_const) = low;\n+  TREE_INT_CST_HIGH (new_const) = high;\n   TREE_TYPE (new_const) = type;\n   TREE_OVERFLOW (new_const) = TREE_CONSTANT_OVERFLOW (new_const)\n     = force_fit_type (new_const, 0);\n@@ -1745,7 +1745,7 @@ fold_convert_const (enum tree_code code, tree type, tree arg1)\n \t  if (TREE_CODE (type) == INTEGER_TYPE && TYPE_IS_SIZETYPE (type)\n \t      && !TREE_CONSTANT_OVERFLOW (arg1)\n \t      && compare_tree_int (arg1, 10000) < 0)\n-\t    return size_int_type_wide (TREE_INT_CST_LOW (arg1), type);\n+\t    return size_int_type (TREE_INT_CST_LOW (arg1), type);\n \n \t  /* Given an integer constant, make new constant with new type,\n \t     appropriately sign-extended or truncated.  */\n@@ -5749,6 +5749,7 @@ fold (tree expr)\n \t  TREE_OPERAND (t, 0) = TREE_OPERAND (prev, 1);\n \t  /* First do the assignment, then return converted constant.  */\n \t  t = build (COMPOUND_EXPR, TREE_TYPE (t), prev, fold (t));\n+\t  TREE_NO_UNUSED_WARNING (t) = 1;\n \t  TREE_USED (t) = 1;\n \t  return t;\n \t}"}, {"sha": "029201beaf6a4894a10c78d1de798a36bb026a08", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/88020bd8ea3599aacf21218df9f8f7dbb8e15cff/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/88020bd8ea3599aacf21218df9f8f7dbb8e15cff/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=88020bd8ea3599aacf21218df9f8f7dbb8e15cff", "patch": "@@ -1,3 +1,8 @@\n+2004-03-16  Mark Mitchell  <mark@codesourcery.com>\n+\n+\tPR c++/14481\n+\t* g++.dg/warn/Wunused-7.C: New test.\n+\n 2004-03-16  Kaveh R. Ghazi  <ghazi@caip.rutgers.edu>\n \n \t* gcc.dg/torture/builtin-integral-1.c: New test."}, {"sha": "4281bc8156916ce53806dc56fdf78ba380b82dd5", "filename": "gcc/testsuite/g++.dg/warn/Wunused-7.C", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/88020bd8ea3599aacf21218df9f8f7dbb8e15cff/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWunused-7.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/88020bd8ea3599aacf21218df9f8f7dbb8e15cff/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWunused-7.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWunused-7.C?ref=88020bd8ea3599aacf21218df9f8f7dbb8e15cff", "patch": "@@ -0,0 +1,12 @@\n+// PR c++/14481\n+// { dg-options \"-Wunused\" }\n+\n+void func()\n+{\n+  struct mybitfields {\n+    unsigned int s_field:8;\n+  };\n+  struct mybitfields s;\n+  s.s_field = 255;\n+};\n+"}]}