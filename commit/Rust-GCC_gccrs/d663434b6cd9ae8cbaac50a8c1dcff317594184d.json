{"sha": "d663434b6cd9ae8cbaac50a8c1dcff317594184d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDY2MzQzNGI2Y2Q5YWU4Y2JhYWM1MGE4YzFkY2ZmMzE3NTk0MTg0ZA==", "commit": {"author": {"name": "Tobias Schl\u00fcter", "email": "tobias.schlueter@physik.uni-muenchen.de", "date": "2004-05-15T18:02:20Z"}, "committer": {"name": "Tobias Schl\u00fcter", "email": "tobi@gcc.gnu.org", "date": "2004-05-15T18:02:20Z"}, "message": "re PR fortran/13826 (Derived types in DATA statements not PARAMETERs)\n\nfortran:\nPR fortran/13826\n* primary.c (match_structure_constructor): Rename ...\n(gfc_match_structure_constructor): ... to this. Make non-static.\n(gfc_match_rvalue): Call renamed function.\n* match.h (gfc_match_structure_constructor): Declare.\n* match.c (gfc_match_data_constant): Handle structure\nconstructor.\n\ntestsuite:\nPR fortran/13826\n* gfortran.fortran-torture/compile/data_1.f90: New test.\n\nFrom-SVN: r81891", "tree": {"sha": "a2f7e67e6e38ab33d08e077762d35c4386c5e8b1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a2f7e67e6e38ab33d08e077762d35c4386c5e8b1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d663434b6cd9ae8cbaac50a8c1dcff317594184d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d663434b6cd9ae8cbaac50a8c1dcff317594184d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d663434b6cd9ae8cbaac50a8c1dcff317594184d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d663434b6cd9ae8cbaac50a8c1dcff317594184d/comments", "author": {"login": "TobiSchluter", "id": 11887541, "node_id": "MDQ6VXNlcjExODg3NTQx", "avatar_url": "https://avatars.githubusercontent.com/u/11887541?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TobiSchluter", "html_url": "https://github.com/TobiSchluter", "followers_url": "https://api.github.com/users/TobiSchluter/followers", "following_url": "https://api.github.com/users/TobiSchluter/following{/other_user}", "gists_url": "https://api.github.com/users/TobiSchluter/gists{/gist_id}", "starred_url": "https://api.github.com/users/TobiSchluter/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TobiSchluter/subscriptions", "organizations_url": "https://api.github.com/users/TobiSchluter/orgs", "repos_url": "https://api.github.com/users/TobiSchluter/repos", "events_url": "https://api.github.com/users/TobiSchluter/events{/privacy}", "received_events_url": "https://api.github.com/users/TobiSchluter/received_events", "type": "User", "site_admin": false}, "committer": {"login": "TobiSchluter", "id": 11887541, "node_id": "MDQ6VXNlcjExODg3NTQx", "avatar_url": "https://avatars.githubusercontent.com/u/11887541?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TobiSchluter", "html_url": "https://github.com/TobiSchluter", "followers_url": "https://api.github.com/users/TobiSchluter/followers", "following_url": "https://api.github.com/users/TobiSchluter/following{/other_user}", "gists_url": "https://api.github.com/users/TobiSchluter/gists{/gist_id}", "starred_url": "https://api.github.com/users/TobiSchluter/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TobiSchluter/subscriptions", "organizations_url": "https://api.github.com/users/TobiSchluter/orgs", "repos_url": "https://api.github.com/users/TobiSchluter/repos", "events_url": "https://api.github.com/users/TobiSchluter/events{/privacy}", "received_events_url": "https://api.github.com/users/TobiSchluter/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f437e359921603b19e22c44b44f6bb64c199b04f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f437e359921603b19e22c44b44f6bb64c199b04f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f437e359921603b19e22c44b44f6bb64c199b04f"}], "stats": {"total": 35, "additions": 30, "deletions": 5}, "files": [{"sha": "16ea4470998b03db8e1c78b7f15de721d45c82fc", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 10, "deletions": 1, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d663434b6cd9ae8cbaac50a8c1dcff317594184d/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d663434b6cd9ae8cbaac50a8c1dcff317594184d/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=d663434b6cd9ae8cbaac50a8c1dcff317594184d", "patch": "@@ -1,3 +1,13 @@\n+2004-05-15  Tobias Schlueter  <tobias.schlueter@physik.uni-muenchen.de>\n+\n+\tPR fortran/13826\n+\t* primary.c (match_structure_constructor): Rename ...\n+\t(gfc_match_structure_constructor): ... to this. Make non-static.\n+\t(gfc_match_rvalue): Call renamed function.\n+\t* match.h (gfc_match_structure_constructor): Declare.\n+\t* match.c (gfc_match_data_constant): Handle structure\n+\tconstructor.\n+\n 2004-05-15  Tobias Schlueter  <tobias.schlueter@physik.uni-muenchen.de>\n \n \tPR fortran/13702 \n@@ -47,7 +57,6 @@\n \tpreprocessor flags.\n \t(all): Add missing initializers.\n \n-\n 2004-05-15  Tobias Schlueter  <tobias.schlueter@physik.uni-muenchen.de>\n \n \t* Make-lang.in (trans-common.o): Remove redundant dependency."}, {"sha": "1b2b763013e28cbbad4ee67d698655070495d659", "filename": "gcc/fortran/match.c", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d663434b6cd9ae8cbaac50a8c1dcff317594184d/gcc%2Ffortran%2Fmatch.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d663434b6cd9ae8cbaac50a8c1dcff317594184d/gcc%2Ffortran%2Fmatch.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fmatch.c?ref=d663434b6cd9ae8cbaac50a8c1dcff317594184d", "patch": "@@ -2907,12 +2907,15 @@ match_data_constant (gfc_expr ** result)\n   if (gfc_find_symbol (name, NULL, 1, &sym))\n     return MATCH_ERROR;\n \n-  if (sym == NULL || sym->attr.flavor != FL_PARAMETER)\n+  if (sym == NULL\n+      || (sym->attr.flavor != FL_PARAMETER && sym->attr.flavor != FL_DERIVED))\n     {\n       gfc_error (\"Symbol '%s' must be a PARAMETER in DATA statement at %C\",\n \t\t name);\n       return MATCH_ERROR;\n     }\n+  else if (sym->attr.flavor == FL_DERIVED)\n+    return gfc_match_structure_constructor (sym, result);\n \n   *result = gfc_copy_expr (sym->value);\n   return MATCH_YES;"}, {"sha": "6cff5cc0aa0c562e8caf189403928816ced8ad3a", "filename": "gcc/fortran/match.h", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d663434b6cd9ae8cbaac50a8c1dcff317594184d/gcc%2Ffortran%2Fmatch.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d663434b6cd9ae8cbaac50a8c1dcff317594184d/gcc%2Ffortran%2Fmatch.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fmatch.h?ref=d663434b6cd9ae8cbaac50a8c1dcff317594184d", "patch": "@@ -120,6 +120,7 @@ match gfc_match_modproc (void);\n match gfc_match_target (void);\n \n /* primary.c */\n+match gfc_match_structure_constructor (gfc_symbol *, gfc_expr **);\n match gfc_match_rvalue (gfc_expr **);\n match gfc_match_variable (gfc_expr **, int);\n match gfc_match_actual_arglist (int, gfc_actual_arglist **);"}, {"sha": "d10a46244e9f37950c6e3c6ae816d063475a1002", "filename": "gcc/fortran/primary.c", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d663434b6cd9ae8cbaac50a8c1dcff317594184d/gcc%2Ffortran%2Fprimary.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d663434b6cd9ae8cbaac50a8c1dcff317594184d/gcc%2Ffortran%2Fprimary.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fprimary.c?ref=d663434b6cd9ae8cbaac50a8c1dcff317594184d", "patch": "@@ -1747,8 +1747,8 @@ gfc_expr_attr (gfc_expr * e)\n /* Match a structure constructor.  The initial symbol has already been\n    seen.  */\n \n-static match\n-match_structure_constructor (gfc_symbol * sym, gfc_expr ** result)\n+match\n+gfc_match_structure_constructor (gfc_symbol * sym, gfc_expr ** result)\n {\n   gfc_constructor *head, *tail;\n   gfc_component *comp;\n@@ -1908,7 +1908,7 @@ gfc_match_rvalue (gfc_expr ** result)\n       if (sym == NULL)\n \tm = MATCH_ERROR;\n       else\n-        m = match_structure_constructor (sym, &e);\n+        m = gfc_match_structure_constructor (sym, &e);\n       break;\n \n     /* If we're here, then the name is known to be the name of a"}, {"sha": "d23aed287c8bf11087cbeda029647fa31ea4c086", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d663434b6cd9ae8cbaac50a8c1dcff317594184d/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d663434b6cd9ae8cbaac50a8c1dcff317594184d/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=d663434b6cd9ae8cbaac50a8c1dcff317594184d", "patch": "@@ -1,3 +1,8 @@\n+2004-05-15  Tobias Schlueter  <tobias.schlueter@physik.uni-muenchen.de>\n+\n+\tPR fortran/13826\n+\t* gfortran.fortran-torture/compile/data_1.f90: New test.\n+\n 2004-05-15  Ulrich Weigand  <uweigand@de.ibm.com>\n \n \t* gcc.dg/const-elim-1.c: Remove XFAIL for s390*-*-*."}, {"sha": "fa8ab9fe1f7a0b31390c388249290568fca077f5", "filename": "gcc/testsuite/gfortran.fortran-torture/compile/data_1.f90", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d663434b6cd9ae8cbaac50a8c1dcff317594184d/gcc%2Ftestsuite%2Fgfortran.fortran-torture%2Fcompile%2Fdata_1.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d663434b6cd9ae8cbaac50a8c1dcff317594184d/gcc%2Ftestsuite%2Fgfortran.fortran-torture%2Fcompile%2Fdata_1.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.fortran-torture%2Fcompile%2Fdata_1.f90?ref=d663434b6cd9ae8cbaac50a8c1dcff317594184d", "patch": "@@ -0,0 +1,7 @@\n+! this tests the fix for PR 13826\n+TYPE a\n+   REAL x\n+END TYPE\n+TYPE(a) :: y\n+DATA y /a(1.)/ ! used to give an error about non-PARAMETER\n+END"}]}