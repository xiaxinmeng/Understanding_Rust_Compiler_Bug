{"sha": "a5e8b0607431fdefa0dba2bcf477a1695ac5d227", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTVlOGIwNjA3NDMxZmRlZmEwZGJhMmJjZjQ3N2ExNjk1YWM1ZDIyNw==", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2018-09-03T17:41:05Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2018-09-03T17:41:05Z"}, "message": "re PR tree-optimization/87177 (wrong code at -O2 and -O3 on x86-64-linux-gnu)\n\n2018-09-03  Richard Biener  <rguenther@suse.de>\n\n\tPR tree-optimization/87177\n\t* tree-ssa-sccvn.c (vuse_ssa_val): Revert previous change, keep\n\tcleanup.\n\n\t* gcc.dg/torture/pr87177.c: New testcase.\n\t* gcc.dg/torture/pr87177-2.c: Likewise.\n\nFrom-SVN: r264069", "tree": {"sha": "2b777ff2b25afd681d5c2ffce8b038862e57a893", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2b777ff2b25afd681d5c2ffce8b038862e57a893"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a5e8b0607431fdefa0dba2bcf477a1695ac5d227", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a5e8b0607431fdefa0dba2bcf477a1695ac5d227", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a5e8b0607431fdefa0dba2bcf477a1695ac5d227", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a5e8b0607431fdefa0dba2bcf477a1695ac5d227/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "64979e04afabef10adfce819b9955dd8ae6c2fbe", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/64979e04afabef10adfce819b9955dd8ae6c2fbe", "html_url": "https://github.com/Rust-GCC/gccrs/commit/64979e04afabef10adfce819b9955dd8ae6c2fbe"}], "stats": {"total": 113, "additions": 103, "deletions": 10}, "files": [{"sha": "62e32c68774169f7ed845d3f816073d97e052af0", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a5e8b0607431fdefa0dba2bcf477a1695ac5d227/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a5e8b0607431fdefa0dba2bcf477a1695ac5d227/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=a5e8b0607431fdefa0dba2bcf477a1695ac5d227", "patch": "@@ -1,3 +1,9 @@\n+2018-09-03  Richard Biener  <rguenther@suse.de>\n+\n+\tPR tree-optimization/87177\n+\t* tree-ssa-sccvn.c (vuse_ssa_val): Revert previous change, keep\n+\tcleanup.\n+\n 2018-09-03  Alexander Monakov  <amonakov@ispras.ru>\n \n \t* bb-reorder.c (edge_order): Convert to C-qsort-style"}, {"sha": "9828b4b94dfe80d0ee015f906de81fcf3a703e88", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a5e8b0607431fdefa0dba2bcf477a1695ac5d227/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a5e8b0607431fdefa0dba2bcf477a1695ac5d227/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=a5e8b0607431fdefa0dba2bcf477a1695ac5d227", "patch": "@@ -1,3 +1,9 @@\n+2018-09-03  Richard Biener  <rguenther@suse.de>\n+\n+\tPR tree-optimization/87177\n+\t* gcc.dg/torture/pr87177.c: New testcase.\n+\t* gcc.dg/torture/pr87177-2.c: Likewise.\n+\n 2018-09-03  Richard Biener  <rguenther@suse.de>\n \n \tPR tree-optimization/87200"}, {"sha": "55920768c83529981fe7bd2032bb7fd4e53753f9", "filename": "gcc/testsuite/gcc.dg/torture/pr87177-2.c", "status": "added", "additions": 28, "deletions": 0, "changes": 28, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a5e8b0607431fdefa0dba2bcf477a1695ac5d227/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr87177-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a5e8b0607431fdefa0dba2bcf477a1695ac5d227/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr87177-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr87177-2.c?ref=a5e8b0607431fdefa0dba2bcf477a1695ac5d227", "patch": "@@ -0,0 +1,28 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-w\" } */\n+\n+int dk;\n+\n+void\n+lv (void)\n+{\n+  int nm;\n+\n+  dk = 1;\n+  while (dk != 0)\n+    {\n+    }\n+\n+  if (1 / 0)\n+    {\n+      dk = 0;\n+      while (dk != 0)\n+\t{\n+\t}\n+    }\n+\n+  for (;;)\n+    nm = !!dk;\n+\n+  (void) nm;\n+}"}, {"sha": "efeaebf301c312de1c90caa08e9f9aec52a6cb50", "filename": "gcc/testsuite/gcc.dg/torture/pr87177.c", "status": "added", "additions": 61, "deletions": 0, "changes": 61, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a5e8b0607431fdefa0dba2bcf477a1695ac5d227/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr87177.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a5e8b0607431fdefa0dba2bcf477a1695ac5d227/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr87177.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr87177.c?ref=a5e8b0607431fdefa0dba2bcf477a1695ac5d227", "patch": "@@ -0,0 +1,61 @@\n+/* { dg-do run } */\n+\n+int __attribute__((noinline)) my_printf (const char *p, ...)\n+{\n+  static volatile int x;\n+  ++x;\n+}\n+\n+int a, b, c, e, f, g, h, i, j, k, l;\n+unsigned d;\n+\n+static void p ()\n+{\n+  while (1)\n+    {\n+      int n = h;\n+      h = 8;\n+      if (!e)\n+\tbreak;\n+      h = n;\n+      while (1)\n+\t;\n+    }\n+  for (; c != 4; c++)\n+    {\n+      int o = g = 1;\n+      for (; g; g--)\n+\t{\n+\t  while (d < b)\n+\t    e--;\n+\t  a = g;\n+\t  int q = o;\n+\t  if (q)\n+\t    L1:\n+\t\tj = f;\n+\t  if (l)\n+\t    {\n+\t      my_printf (\"%d\", g);\n+\t      goto L1;\n+\t    }\n+\t  o = l;\n+\t  k = q;\n+\t}\n+    }\n+}\n+\n+void s ()\n+{\n+  int m = 0;\n+L2:\n+  if (i && g)\n+    goto L2;\n+  for (; m < 2; m++)\n+    p ();\n+}\n+\n+int main ()\n+{\n+  s ();\n+  return 0;\n+}"}, {"sha": "34c193b58f5348b2095ef9a417deec2ab35d3873", "filename": "gcc/tree-ssa-sccvn.c", "status": "modified", "additions": 2, "deletions": 10, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a5e8b0607431fdefa0dba2bcf477a1695ac5d227/gcc%2Ftree-ssa-sccvn.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a5e8b0607431fdefa0dba2bcf477a1695ac5d227/gcc%2Ftree-ssa-sccvn.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-sccvn.c?ref=a5e8b0607431fdefa0dba2bcf477a1695ac5d227", "patch": "@@ -485,16 +485,8 @@ vuse_ssa_val (tree x)\n \n   do\n     {\n-      if (SSA_NAME_IS_DEFAULT_DEF (x))\n-\treturn x;\n-      vn_ssa_aux_t tem\n-\t= vn_ssa_aux_hash->find_with_hash (x, SSA_NAME_VERSION (x));\n-      /* For region-based VN this makes walk_non_aliased_vuses stop walking\n-\t when we are about to look at a def outside of the region.  */\n-      if (!tem || !tem->visited)\n-\treturn NULL_TREE;\n-      gcc_assert (tem->valnum != VN_TOP);\n-      x = tem->valnum;\n+      x = SSA_VAL (x);\n+      gcc_assert (x != VN_TOP);\n     }\n   while (SSA_NAME_IN_FREE_LIST (x));\n "}]}