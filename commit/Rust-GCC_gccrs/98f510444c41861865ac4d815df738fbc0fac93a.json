{"sha": "98f510444c41861865ac4d815df738fbc0fac93a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OThmNTEwNDQ0YzQxODYxODY1YWM0ZDgxNWRmNzM4ZmJjMGZhYzkzYQ==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2015-01-21T21:59:34Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2015-01-21T21:59:34Z"}, "message": "re PR debug/64511 (ICE at -O3 with -g enabled on x86_64-linux-gnu)\n\n\tPR debug/64511\n\t* simplify-rtx.c (simplify_relational_operation_1): Don't try to\n\toptimize (eq/ne (and (side_effects) (const_int 0)) (const_int 0))\n\tinto (eq/ne (and (not (side_effects)) (const_int 0)) (const_int 0)).\n\n\t* gcc.dg/pr64511.c: New test.\n\nFrom-SVN: r219974", "tree": {"sha": "1fa4ffd08de9e492888996917c3d6e158166d429", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1fa4ffd08de9e492888996917c3d6e158166d429"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/98f510444c41861865ac4d815df738fbc0fac93a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/98f510444c41861865ac4d815df738fbc0fac93a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/98f510444c41861865ac4d815df738fbc0fac93a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/98f510444c41861865ac4d815df738fbc0fac93a/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "b85a3242397d2c63d1185bbc17386520335313cb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b85a3242397d2c63d1185bbc17386520335313cb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b85a3242397d2c63d1185bbc17386520335313cb"}], "stats": {"total": 37, "additions": 35, "deletions": 2}, "files": [{"sha": "190fdfdc8aa8523207c8371278159ca89aba9d72", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/98f510444c41861865ac4d815df738fbc0fac93a/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/98f510444c41861865ac4d815df738fbc0fac93a/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=98f510444c41861865ac4d815df738fbc0fac93a", "patch": "@@ -1,5 +1,10 @@\n 2015-01-21  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR debug/64511\n+\t* simplify-rtx.c (simplify_relational_operation_1): Don't try to\n+\toptimize (eq/ne (and (side_effects) (const_int 0)) (const_int 0))\n+\tinto (eq/ne (and (not (side_effects)) (const_int 0)) (const_int 0)).\n+\n \tPR sanitizer/64706\n \t* doc/invoke.texi (-fsanitize=vptr): Document.\n "}, {"sha": "5c9e3bf166720739581fa5a10f8bba365bc8e2ea", "filename": "gcc/simplify-rtx.c", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/98f510444c41861865ac4d815df738fbc0fac93a/gcc%2Fsimplify-rtx.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/98f510444c41861865ac4d815df738fbc0fac93a/gcc%2Fsimplify-rtx.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fsimplify-rtx.c?ref=98f510444c41861865ac4d815df738fbc0fac93a", "patch": "@@ -4589,7 +4589,8 @@ simplify_relational_operation_1 (enum rtx_code code, machine_mode mode,\n   if ((code == EQ || code == NE)\n       && op0code == AND\n       && rtx_equal_p (XEXP (op0, 0), op1)\n-      && !side_effects_p (op1))\n+      && !side_effects_p (op1)\n+      && op1 != CONST0_RTX (cmp_mode))\n     {\n       rtx not_y = simplify_gen_unary (NOT, cmp_mode, XEXP (op0, 1), cmp_mode);\n       rtx lhs = simplify_gen_binary (AND, cmp_mode, not_y, XEXP (op0, 0));\n@@ -4602,7 +4603,8 @@ simplify_relational_operation_1 (enum rtx_code code, machine_mode mode,\n   if ((code == EQ || code == NE)\n       && op0code == AND\n       && rtx_equal_p (XEXP (op0, 1), op1)\n-      && !side_effects_p (op1))\n+      && !side_effects_p (op1)\n+      && op1 != CONST0_RTX (cmp_mode))\n     {\n       rtx not_x = simplify_gen_unary (NOT, cmp_mode, XEXP (op0, 0), cmp_mode);\n       rtx lhs = simplify_gen_binary (AND, cmp_mode, not_x, XEXP (op0, 1));"}, {"sha": "f093c78841c1ad1688792856a360d23f453b3a05", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/98f510444c41861865ac4d815df738fbc0fac93a/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/98f510444c41861865ac4d815df738fbc0fac93a/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=98f510444c41861865ac4d815df738fbc0fac93a", "patch": "@@ -1,5 +1,8 @@\n 2015-01-21  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR debug/64511\n+\t* gcc.dg/pr64511.c: New test.\n+\n \tPR rtl-optimization/62078\n \t* g++.dg/opt/pr62078.C: New test.\n "}, {"sha": "83cb5af807c59492c19e913e5ff7e0f2128a548b", "filename": "gcc/testsuite/gcc.dg/pr64511.c", "status": "added", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/98f510444c41861865ac4d815df738fbc0fac93a/gcc%2Ftestsuite%2Fgcc.dg%2Fpr64511.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/98f510444c41861865ac4d815df738fbc0fac93a/gcc%2Ftestsuite%2Fgcc.dg%2Fpr64511.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr64511.c?ref=98f510444c41861865ac4d815df738fbc0fac93a", "patch": "@@ -0,0 +1,23 @@\n+/* PR debug/64511 */\n+/* { dg-do compile } */\n+/* { dg-options \"-O3 -g\" } */\n+\n+int a, c;\n+int *volatile b;\n+\n+void\n+foo (int p)\n+{\n+  int d;\n+  int *e = &a;\n+  d = ((p == 0) & *e) != 0;\n+  b = e;\n+  for (; c;)\n+    ;\n+}\n+\n+void\n+bar (void)\n+{\n+  foo (1);\n+}"}]}