{"sha": "864396ff9e8a4ee1f02e1ff0fb4d096bbca547ff", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODY0Mzk2ZmY5ZThhNGVlMWYwMmUxZmYwZmI0ZDA5NmJiY2E1NDdmZg==", "commit": {"author": {"name": "Alan Modra", "email": "amodra@gmail.com", "date": "2015-03-09T23:18:57Z"}, "committer": {"name": "Alan Modra", "email": "amodra@gcc.gnu.org", "date": "2015-03-09T23:18:57Z"}, "message": "re PR target/65286 (When building on powerpc64le-unknown-linux-gnu, --disable-multilib must be used)\n\n\tPR target/65286\n\t* config.gcc (powerpc*-*-linux*): Arrange for powerpc64le-linux\n\tto be single-arch by default.  Set cpu_is_64bit for powerpc64\n\tgiven --with-cpu=native.\n\t* config/rs6000/t-fprules: Do not set default MULTILIB vars.\n\t* config/rs6000/t-linux (MULTIARCH_DIRNAME): Support powerpc64\n\tand powerpc64le.\n\t* config/rs6000/linux64.h (SUBSUBTARGET_OVERRIDE_OPTIONS): Test\n\trs6000_isa_flags rather than TARGET_64BIT.\n\nFrom-SVN: r221288", "tree": {"sha": "53571cee2adb6aca1f31369dc72e57fe49aa049a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/53571cee2adb6aca1f31369dc72e57fe49aa049a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/864396ff9e8a4ee1f02e1ff0fb4d096bbca547ff", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/864396ff9e8a4ee1f02e1ff0fb4d096bbca547ff", "html_url": "https://github.com/Rust-GCC/gccrs/commit/864396ff9e8a4ee1f02e1ff0fb4d096bbca547ff", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/864396ff9e8a4ee1f02e1ff0fb4d096bbca547ff/comments", "author": {"login": "amodra", "id": 6006325, "node_id": "MDQ6VXNlcjYwMDYzMjU=", "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4", "gravatar_id": "", "url": "https://api.github.com/users/amodra", "html_url": "https://github.com/amodra", "followers_url": "https://api.github.com/users/amodra/followers", "following_url": "https://api.github.com/users/amodra/following{/other_user}", "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}", "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/amodra/subscriptions", "organizations_url": "https://api.github.com/users/amodra/orgs", "repos_url": "https://api.github.com/users/amodra/repos", "events_url": "https://api.github.com/users/amodra/events{/privacy}", "received_events_url": "https://api.github.com/users/amodra/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "711d91e13f68b63402bbce1fe1fc6656cdf912fd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/711d91e13f68b63402bbce1fe1fc6656cdf912fd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/711d91e13f68b63402bbce1fe1fc6656cdf912fd"}], "stats": {"total": 60, "additions": 41, "deletions": 19}, "files": [{"sha": "6526a8e8d12894a10572974894280446ce5b2758", "filename": "gcc/ChangeLog", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/864396ff9e8a4ee1f02e1ff0fb4d096bbca547ff/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/864396ff9e8a4ee1f02e1ff0fb4d096bbca547ff/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=864396ff9e8a4ee1f02e1ff0fb4d096bbca547ff", "patch": "@@ -1,3 +1,15 @@\n+2015-03-10  Alan Modra  <amodra@gmail.com>\n+\n+\tPR target/65286\n+\t* config.gcc (powerpc*-*-linux*): Arrange for powerpc64le-linux\n+\tto be single-arch by default.  Set cpu_is_64bit for powerpc64\n+\tgiven --with-cpu=native.\n+\t* config/rs6000/t-fprules: Do not set default MULTILIB vars.\n+\t* config/rs6000/t-linux (MULTIARCH_DIRNAME): Support powerpc64\n+\tand powerpc64le.\n+\t* config/rs6000/linux64.h (SUBSUBTARGET_OVERRIDE_OPTIONS): Test\n+\trs6000_isa_flags rather than TARGET_64BIT.\n+\n 2015-03-09  Yoshinori Sato  <ysato@users.sourceforge.jp>\n \t    Kaz Kojima  <kkojima@gcc.gnu.org>\n "}, {"sha": "69d1670b1d722802759ae3f544762d8692997682", "filename": "gcc/config.gcc", "status": "modified", "additions": 19, "deletions": 10, "changes": 29, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/864396ff9e8a4ee1f02e1ff0fb4d096bbca547ff/gcc%2Fconfig.gcc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/864396ff9e8a4ee1f02e1ff0fb4d096bbca547ff/gcc%2Fconfig.gcc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig.gcc?ref=864396ff9e8a4ee1f02e1ff0fb4d096bbca547ff", "patch": "@@ -2337,28 +2337,32 @@ powerpc-*-rtems*)\n powerpc*-*-linux*)\n \ttm_file=\"${tm_file} dbxelf.h elfos.h gnu-user.h freebsd-spec.h rs6000/sysv4.h\"\n \textra_options=\"${extra_options} rs6000/sysv4.opt\"\n-\ttmake_file=\"rs6000/t-fprules rs6000/t-ppcos ${tmake_file} rs6000/t-ppccomm\"\n+\ttmake_file=\"${tmake_file} rs6000/t-fprules rs6000/t-ppccomm\"\n \textra_objs=\"$extra_objs rs6000-linux.o\"\n \tcase ${target} in\n \t    powerpc*le-*-*)\n \t\ttm_file=\"${tm_file} rs6000/sysv4le.h\" ;;\n \tesac\n-\tmaybe_biarch=yes\n+\tcase ${target}:${with_cpu} in\n+\t    powerpc64*: | powerpc64*:native) cpu_is_64bit=yes ;;\n+\tesac\n+\tmaybe_biarch=${cpu_is_64bit}\n+\tcase ${enable_targets} in\n+\t    *powerpc64*) maybe_biarch=yes ;;\n+\tesac\n \tcase ${target} in\n \t    powerpc64*-*-linux*spe* | powerpc64*-*-linux*paired*)\n-\t    \techo \"*** Configuration ${target} not supported\" 1>&2\n+\t\techo \"*** Configuration ${target} not supported\" 1>&2\n \t\texit 1\n \t\t;;\n \t    powerpc*-*-linux*spe* | powerpc*-*-linux*paired*)\n \t\tmaybe_biarch=\n \t\t;;\n-\t    powerpc64*-*-linux*)\n-\t    \ttest x$with_cpu != x || cpu_is_64bit=yes\n-\t\tmaybe_biarch=always\n-\t\t;;\n \tesac\n-\tcase ${maybe_biarch}:${enable_targets}:${cpu_is_64bit} in\n-\t    always:* | yes:*powerpc64* | yes:all:* | yes:*:yes)\n+\tcase ${target}:${enable_targets}:${maybe_biarch} in\n+\t    powerpc64-* | powerpc-*:*:yes | *:*powerpc64-*:yes | *:all:yes \\\n+\t    | powerpc64le*:*powerpcle* | powerpc64le*:*powerpc-* \\\n+\t    | powerpcle-*:*powerpc64le*:yes)\n \t\tif test x$cpu_is_64bit = xyes; then\n \t\t    tm_file=\"${tm_file} rs6000/default64.h\"\n \t\tfi\n@@ -2379,9 +2383,14 @@ powerpc*-*-linux*)\n \t\tesac\n \t\textra_options=\"${extra_options} rs6000/linux64.opt\"\n \t\t;;\n+\t    powerpc64*)\n+\t\ttm_file=\"${tm_file} rs6000/default64.h rs6000/linux64.h glibc-stdint.h\"\n+\t\textra_options=\"${extra_options} rs6000/linux64.opt\"\n+\t\ttmake_file=\"${tmake_file} rs6000/t-linux\"\n+\t\t;;\n \t    *)\n \t\ttm_file=\"${tm_file} rs6000/linux.h glibc-stdint.h\"\n-\t\ttmake_file=\"$tmake_file rs6000/t-linux\"\n+\t\ttmake_file=\"${tmake_file} rs6000/t-ppcos rs6000/t-linux\"\n \t\t;;\n \tesac\n \tcase ${target} in"}, {"sha": "0879e7ed4d73a4653fb3bb8710feff570c0b56b9", "filename": "gcc/config/rs6000/linux64.h", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/864396ff9e8a4ee1f02e1ff0fb4d096bbca547ff/gcc%2Fconfig%2Frs6000%2Flinux64.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/864396ff9e8a4ee1f02e1ff0fb4d096bbca547ff/gcc%2Fconfig%2Frs6000%2Flinux64.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Flinux64.h?ref=864396ff9e8a4ee1f02e1ff0fb4d096bbca547ff", "patch": "@@ -97,7 +97,7 @@ extern int dot_symbols;\n     {\t\t\t\t\t\t\t\t\\\n       if (!global_options_set.x_rs6000_alignment_flags)\t\t\\\n \trs6000_alignment_flags = MASK_ALIGN_NATURAL;\t\t\\\n-      if (TARGET_64BIT)\t\t\t\t\t\t\\\n+      if (rs6000_isa_flags & OPTION_MASK_64BIT)\t\t\t\\\n \t{\t\t\t\t\t\t\t\\\n \t  if (DEFAULT_ABI != ABI_AIX)\t\t\t\t\\\n \t    {\t\t\t\t\t\t\t\\"}, {"sha": "dc345ad9e84688b2f6e278adfcd9dde6fca99780", "filename": "gcc/config/rs6000/t-fprules", "status": "modified", "additions": 0, "deletions": 6, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/864396ff9e8a4ee1f02e1ff0fb4d096bbca547ff/gcc%2Fconfig%2Frs6000%2Ft-fprules", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/864396ff9e8a4ee1f02e1ff0fb4d096bbca547ff/gcc%2Fconfig%2Frs6000%2Ft-fprules", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Ft-fprules?ref=864396ff9e8a4ee1f02e1ff0fb4d096bbca547ff", "patch": "@@ -18,9 +18,3 @@\n \n SOFT_FLOAT_CPUS = e300c2 401 403 405 440 464 476 ec603e 801 821 823 860\n MULTILIB_MATCHES_FLOAT = $(foreach cpu, $(SOFT_FLOAT_CPUS), msoft-float=mcpu?$(cpu))\n-\n-# Build the libraries for both hard and soft floating point by default\n-\n-MULTILIB_OPTIONS = msoft-float\n-MULTILIB_DIRNAMES = soft-float\n-MULTILIB_MATCHES\t= ${MULTILIB_MATCHES_FLOAT}"}, {"sha": "1630a0cc3a2a57044639eea394e701f3c473da61", "filename": "gcc/config/rs6000/t-linux", "status": "modified", "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/864396ff9e8a4ee1f02e1ff0fb4d096bbca547ff/gcc%2Fconfig%2Frs6000%2Ft-linux", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/864396ff9e8a4ee1f02e1ff0fb4d096bbca547ff/gcc%2Fconfig%2Frs6000%2Ft-linux", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Ft-linux?ref=864396ff9e8a4ee1f02e1ff0fb4d096bbca547ff", "patch": "@@ -1,10 +1,17 @@\n # do not define the multiarch name if configured for a soft-float cpu\n # or soft-float.\n ifeq (,$(filter $(with_cpu),$(SOFT_FLOAT_CPUS))$(findstring soft,$(with_float)))\n+ifneq (,$(findstring powerpc64,$(target)))\n+MULTIARCH_DIRNAME := powerpc64-linux-gnu\n+else\n ifneq (,$(findstring spe,$(target)))\n-MULTIARCH_DIRNAME = powerpc-linux-gnuspe$(if $(findstring 8548,$(with_cpu)),,v1)\n+MULTIARCH_DIRNAME := powerpc-linux-gnuspe$(if $(findstring 8548,$(with_cpu)),,v1)\n else\n-MULTIARCH_DIRNAME = powerpc-linux-gnu\n+MULTIARCH_DIRNAME := powerpc-linux-gnu\n+endif\n+endif\n+ifneq (,$(findstring powerpcle,$(target))$(findstring powerpc64le,$(target)))\n+MULTIARCH_DIRNAME := $(subst -linux,le-linux,$(MULTIARCH_DIRNAME))\n endif\n endif\n "}]}