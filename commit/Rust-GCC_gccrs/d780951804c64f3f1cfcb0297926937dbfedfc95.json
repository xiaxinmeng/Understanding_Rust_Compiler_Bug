{"sha": "d780951804c64f3f1cfcb0297926937dbfedfc95", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDc4MDk1MTgwNGM2NGYzZjFjZmNiMDI5NzkyNjkzN2RiZmVkZmM5NQ==", "commit": {"author": {"name": "Martin Liska", "email": "mliska@suse.cz", "date": "2015-06-01T12:48:40Z"}, "committer": {"name": "Martin Liska", "email": "marxin@gcc.gnu.org", "date": "2015-06-01T12:48:40Z"}, "message": "Change use to type-based pool allocator in\n\n\t* ipa-profile.c (account_time_size): Use new type-based pool allocator.\n\t(ipa_profile_generate_summary): Likewise.\n\t(ipa_profile_read_summary): Likewise.\n\t(ipa_profile): Likewise.\n\nFrom-SVN: r223968", "tree": {"sha": "a13a22c259585b71707a975fb6aa9b6fb3f37a89", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a13a22c259585b71707a975fb6aa9b6fb3f37a89"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d780951804c64f3f1cfcb0297926937dbfedfc95", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d780951804c64f3f1cfcb0297926937dbfedfc95", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d780951804c64f3f1cfcb0297926937dbfedfc95", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d780951804c64f3f1cfcb0297926937dbfedfc95/comments", "author": {"login": "marxin", "id": 2658545, "node_id": "MDQ6VXNlcjI2NTg1NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/2658545?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marxin", "html_url": "https://github.com/marxin", "followers_url": "https://api.github.com/users/marxin/followers", "following_url": "https://api.github.com/users/marxin/following{/other_user}", "gists_url": "https://api.github.com/users/marxin/gists{/gist_id}", "starred_url": "https://api.github.com/users/marxin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marxin/subscriptions", "organizations_url": "https://api.github.com/users/marxin/orgs", "repos_url": "https://api.github.com/users/marxin/repos", "events_url": "https://api.github.com/users/marxin/events{/privacy}", "received_events_url": "https://api.github.com/users/marxin/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "dc5667a30b74e6e8e9208691ddd2fa953bd70e3d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dc5667a30b74e6e8e9208691ddd2fa953bd70e3d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dc5667a30b74e6e8e9208691ddd2fa953bd70e3d"}], "stats": {"total": 18, "additions": 11, "deletions": 7}, "files": [{"sha": "2291b0f7e11c73391fa660b23b4d35b788b0dc8c", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d780951804c64f3f1cfcb0297926937dbfedfc95/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d780951804c64f3f1cfcb0297926937dbfedfc95/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=d780951804c64f3f1cfcb0297926937dbfedfc95", "patch": "@@ -1,3 +1,10 @@\n+2015-06-01  Martin Liska  <mliska@suse.cz>\n+\n+\t* ipa-profile.c (account_time_size): Use new type-based pool allocator.\n+\t(ipa_profile_generate_summary): Likewise.\n+\t(ipa_profile_read_summary): Likewise.\n+\t(ipa_profile): Likewise.\n+\n 2015-06-01  Martin Liska  <mliska@suse.cz>\n \n \t* tree-ssa-structalias.c (new_var_info): Use new type-based pool allocator."}, {"sha": "7c967f9435ea2be7a41fd1d80be25fa527ff24f0", "filename": "gcc/ipa-profile.c", "status": "modified", "additions": 4, "deletions": 7, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d780951804c64f3f1cfcb0297926937dbfedfc95/gcc%2Fipa-profile.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d780951804c64f3f1cfcb0297926937dbfedfc95/gcc%2Fipa-profile.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-profile.c?ref=d780951804c64f3f1cfcb0297926937dbfedfc95", "patch": "@@ -107,7 +107,8 @@ struct histogram_entry\n    duplicate entries.  */\n \n vec<histogram_entry *> histogram;\n-static alloc_pool histogram_pool;\n+static pool_allocator<histogram_entry> histogram_pool\n+  (\"IPA histogram\", 10);\n \n /* Hashtable support for storing SSA names hashed by their SSA_NAME_VAR.  */\n \n@@ -144,7 +145,7 @@ account_time_size (hash_table<histogram_hash> *hashtable,\n \n   if (!*val)\n     {\n-      *val = (histogram_entry *) pool_alloc (histogram_pool);\n+      *val = histogram_pool.allocate ();\n       **val = key;\n       histogram.safe_push (*val);\n     }\n@@ -205,8 +206,6 @@ ipa_profile_generate_summary (void)\n   basic_block bb;\n \n   hash_table<histogram_hash> hashtable (10);\n-  histogram_pool = create_alloc_pool (\"IPA histogram\", sizeof (struct histogram_entry),\n-\t\t\t\t      10);\n   \n   FOR_EACH_FUNCTION_WITH_GIMPLE_BODY (node)\n     FOR_EACH_BB_FN (bb, DECL_STRUCT_FUNCTION (node->decl))\n@@ -287,8 +286,6 @@ ipa_profile_read_summary (void)\n   int j = 0;\n \n   hash_table<histogram_hash> hashtable (10);\n-  histogram_pool = create_alloc_pool (\"IPA histogram\", sizeof (struct histogram_entry),\n-\t\t\t\t      10);\n \n   while ((file_data = file_data_vec[j++]))\n     {\n@@ -593,7 +590,7 @@ ipa_profile (void)\n \t}\n     }\n   histogram.release ();\n-  free_alloc_pool (histogram_pool);\n+  histogram_pool.release ();\n \n   /* Produce speculative calls: we saved common traget from porfiling into\n      e->common_target_id.  Now, at link time, we can look up corresponding"}]}