{"sha": "9e6dca75944c1d711ef62e4d7d2befa9179e166b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWU2ZGNhNzU5NDRjMWQ3MTFlZjYyZTRkN2QyYmVmYTkxNzllMTY2Yg==", "commit": {"author": {"name": "Thomas Koenig", "email": "tkoenig@gcc.gnu.org", "date": "2008-05-04T10:14:49Z"}, "committer": {"name": "Thomas Koenig", "email": "tkoenig@gcc.gnu.org", "date": "2008-05-04T10:14:49Z"}, "message": "re PR fortran/35990 (run-time abort for PACK of run-time zero sized array)\n\n2008-05-04  Thomas Koenig  <tkoenig@gcc.gnu.org>\n\n\tPR libfortran/35990\n\t* intrinsics/pack_generic.c:  Really commit.\n\nFrom-SVN: r134928", "tree": {"sha": "916b49d74e2b351e44cd9159b7487c6daebdecef", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/916b49d74e2b351e44cd9159b7487c6daebdecef"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9e6dca75944c1d711ef62e4d7d2befa9179e166b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9e6dca75944c1d711ef62e4d7d2befa9179e166b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9e6dca75944c1d711ef62e4d7d2befa9179e166b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9e6dca75944c1d711ef62e4d7d2befa9179e166b/comments", "author": null, "committer": null, "parents": [{"sha": "7ad99d60f442253354e6a7b1be56748f6e627246", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7ad99d60f442253354e6a7b1be56748f6e627246", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7ad99d60f442253354e6a7b1be56748f6e627246"}], "stats": {"total": 21, "additions": 19, "deletions": 2}, "files": [{"sha": "ec9ab88b75333c5413a802335d6b240a1d6d96a9", "filename": "libgfortran/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9e6dca75944c1d711ef62e4d7d2befa9179e166b/libgfortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9e6dca75944c1d711ef62e4d7d2befa9179e166b/libgfortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2FChangeLog?ref=9e6dca75944c1d711ef62e4d7d2befa9179e166b", "patch": "@@ -1,3 +1,8 @@\n+2008-05-04  Thomas Koenig  <tkoenig@gcc.gnu.org>\n+\n+\tPR libfortran/35990\n+\t* intrinsics/pack_generic.c:  Really commit.\n+\n 2008-05-04  Thomas Koenig  <tkoenig@gcc.gnu.org>\n \n \tPR libfortran/35990"}, {"sha": "bb4abaeae4b4b895b3543d9ea664e0d75730e89e", "filename": "libgfortran/intrinsics/pack_generic.c", "status": "modified", "additions": 14, "deletions": 2, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9e6dca75944c1d711ef62e4d7d2befa9179e166b/libgfortran%2Fintrinsics%2Fpack_generic.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9e6dca75944c1d711ef62e4d7d2befa9179e166b/libgfortran%2Fintrinsics%2Fpack_generic.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fintrinsics%2Fpack_generic.c?ref=9e6dca75944c1d711ef62e4d7d2befa9179e166b", "patch": "@@ -491,32 +491,44 @@ pack_s_internal (gfc_array_char *ret, const gfc_array_char *array,\n   index_type dim;\n   index_type ssize;\n   index_type nelem;\n+  index_type total;\n \n   dim = GFC_DESCRIPTOR_RANK (array);\n   ssize = 1;\n   for (n = 0; n < dim; n++)\n     {\n       count[n] = 0;\n       extent[n] = array->dim[n].ubound + 1 - array->dim[n].lbound;\n+      if (extent[n] < 0)\n+\textent[n] = 0;\n+\n       sstride[n] = array->dim[n].stride * size;\n       ssize *= extent[n];\n     }\n   if (sstride[0] == 0)\n     sstride[0] = size;\n \n   sstride0 = sstride[0];\n-  sptr = array->data;\n+\n+  if (ssize != 0)\n+    sptr = array->data;\n+  else\n+    sptr = NULL;\n \n   if (ret->data == NULL)\n     {\n       /* Allocate the memory for the result.  */\n-      int total;\n \n       if (vector != NULL)\n \t{\n \t  /* The return array will have as many elements as there are\n \t     in vector.  */\n \t  total = vector->dim[0].ubound + 1 - vector->dim[0].lbound;\n+\t  if (total <= 0)\n+\t    {\n+\t      total = 0;\n+\t      vector = NULL;\n+\t    }\n \t}\n       else\n \t{"}]}