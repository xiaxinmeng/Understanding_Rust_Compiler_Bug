{"sha": "53e788d00c62e4430ed77f65ad669b8c60e69420", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTNlNzg4ZDAwYzYyZTQ0MzBlZDc3ZjY1YWQ2NjliOGM2MGU2OTQyMA==", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2017-05-12T10:54:29Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2017-05-12T10:54:29Z"}, "message": "re PR tree-optimization/80713 (recent crash in update_dep_bb)\n\n2017-05-12  Richard Biener  <rguenther@suse.de>\n\n\tPR tree-optimization/80713\n\t* tree-ssa-pre.c (remove_dead_inserted_code): Clear\n\tinserted_exprs bit for not removed stmts.\n\n\t* gcc.dg/torture/pr80713.c: New testcase.\n\nFrom-SVN: r247963", "tree": {"sha": "472a2bbcccd0aaf65c3b199dc33e708277edea3f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/472a2bbcccd0aaf65c3b199dc33e708277edea3f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/53e788d00c62e4430ed77f65ad669b8c60e69420", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/53e788d00c62e4430ed77f65ad669b8c60e69420", "html_url": "https://github.com/Rust-GCC/gccrs/commit/53e788d00c62e4430ed77f65ad669b8c60e69420", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/53e788d00c62e4430ed77f65ad669b8c60e69420/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "2ead1ab91123d2af20dac4dfa551355dacfef00d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2ead1ab91123d2af20dac4dfa551355dacfef00d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2ead1ab91123d2af20dac4dfa551355dacfef00d"}], "stats": {"total": 48, "additions": 48, "deletions": 0}, "files": [{"sha": "988e8c795d44f3f9a253bedd93719186e0d9c6d6", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/53e788d00c62e4430ed77f65ad669b8c60e69420/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/53e788d00c62e4430ed77f65ad669b8c60e69420/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=53e788d00c62e4430ed77f65ad669b8c60e69420", "patch": "@@ -1,3 +1,9 @@\n+2017-05-12  Richard Biener  <rguenther@suse.de>\n+\n+\tPR tree-optimization/80713\n+\t* tree-ssa-pre.c (remove_dead_inserted_code): Clear\n+\tinserted_exprs bit for not removed stmts.\n+\n 2017-05-12  Thomas Schwinge  <thomas@codesourcery.com>\n \n \tPR middle-end/69921"}, {"sha": "b1c69d2959407326bf35292d8b06a1ffbe0ee7bd", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/53e788d00c62e4430ed77f65ad669b8c60e69420/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/53e788d00c62e4430ed77f65ad669b8c60e69420/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=53e788d00c62e4430ed77f65ad669b8c60e69420", "patch": "@@ -1,3 +1,8 @@\n+2017-05-12  Richard Biener  <rguenther@suse.de>\n+\n+\tPR tree-optimization/80713\n+\t* gcc.dg/torture/pr80713.c: New testcase.\n+\n 2017-05-12  Andi Kleen  <ak@linux.intel.com>\n \n \tPR testsuite/77684"}, {"sha": "18bd9b0e1e4017c13188f1dcdf8becf2c6e1c220", "filename": "gcc/testsuite/gcc.dg/torture/pr80713.c", "status": "added", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/53e788d00c62e4430ed77f65ad669b8c60e69420/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr80713.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/53e788d00c62e4430ed77f65ad669b8c60e69420/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr80713.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr80713.c?ref=53e788d00c62e4430ed77f65ad669b8c60e69420", "patch": "@@ -0,0 +1,24 @@\n+/* { dg-do compile } */\n+\n+int a, b, d, e, f;\n+int *c;\n+void g()\n+{\n+  for (;;)\n+    {\n+      if (*c) {\n+\t  int h;\n+\t  *c = (__UINTPTR_TYPE__) &h;\n+      } else\n+\tb = 0;\n+      if (f)\n+\t*c = (__UINTPTR_TYPE__) g;\n+      else\n+\tfor (; a; a++)\n+\t  for (;;) {\n+\t      if (d)\n+\t\tbreak;\n+\t      c = (int *) (__UINTPTR_TYPE__) e;\n+\t  }\n+    }\n+}"}, {"sha": "c7062b7379872b32a06be964765feb065eb444e6", "filename": "gcc/tree-ssa-pre.c", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/53e788d00c62e4430ed77f65ad669b8c60e69420/gcc%2Ftree-ssa-pre.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/53e788d00c62e4430ed77f65ad669b8c60e69420/gcc%2Ftree-ssa-pre.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-pre.c?ref=53e788d00c62e4430ed77f65ad669b8c60e69420", "patch": "@@ -4947,8 +4947,14 @@ remove_dead_inserted_code (void)\n \t}\n     }\n \n+  unsigned int to_clear = -1U;\n   EXECUTE_IF_SET_IN_BITMAP (inserted_exprs, 0, i, bi)\n     {\n+      if (to_clear != -1U)\n+\t{\n+\t  bitmap_clear_bit (inserted_exprs, to_clear);\n+\t  to_clear = -1U;\n+\t}\n       t = SSA_NAME_DEF_STMT (ssa_name (i));\n       if (!gimple_plf (t, NECESSARY))\n \t{\n@@ -4969,7 +4975,14 @@ remove_dead_inserted_code (void)\n \t      release_defs (t);\n \t    }\n \t}\n+      else\n+\t/* eliminate_fini will skip stmts marked for removal if we\n+\t   already removed it and uses inserted_exprs for this, so\n+\t   clear those we didn't end up removing.  */\n+\tto_clear = i;\n     }\n+  if (to_clear != -1U)\n+    bitmap_clear_bit (inserted_exprs, to_clear);\n   BITMAP_FREE (worklist);\n }\n "}]}