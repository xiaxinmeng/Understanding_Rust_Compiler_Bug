{"sha": "a7c3e87ed900cb2b6ff0f72292e8a18cb87187b6", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTdjM2U4N2VkOTAwY2IyYjZmZjBmNzIyOTJlOGExOGNiODcxODdiNg==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2015-01-29T20:40:07Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2015-01-29T20:40:07Z"}, "message": "re PR sanitizer/64717 (-fsanitize=vptr leads to warning: \u2018<anonymous>\u2019 may be used uninitialized in this function [-Wmaybe-uninitialized])\n\n\tPR c++/64717\n\t* cp-ubsan.c (cp_ubsan_instrument_vptr): Don't wrap vptr\n\tinto SAVE_EXPR.\n\n\t* g++.dg/ubsan/pr64717-1.C: New test.\n\t* g++.dg/ubsan/pr64717-2.C: New test.\n\nFrom-SVN: r220262", "tree": {"sha": "c120f358a21ea86209079717ef7ab2ac726a35b2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c120f358a21ea86209079717ef7ab2ac726a35b2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a7c3e87ed900cb2b6ff0f72292e8a18cb87187b6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a7c3e87ed900cb2b6ff0f72292e8a18cb87187b6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a7c3e87ed900cb2b6ff0f72292e8a18cb87187b6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a7c3e87ed900cb2b6ff0f72292e8a18cb87187b6/comments", "author": null, "committer": null, "parents": [{"sha": "d240f6b36ae42145ba900e9534bd6fb305b30508", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d240f6b36ae42145ba900e9534bd6fb305b30508", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d240f6b36ae42145ba900e9534bd6fb305b30508"}], "stats": {"total": 50, "additions": 48, "deletions": 2}, "files": [{"sha": "308e5bcc17f345d01b81281c995171e1ab743ac8", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a7c3e87ed900cb2b6ff0f72292e8a18cb87187b6/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a7c3e87ed900cb2b6ff0f72292e8a18cb87187b6/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=a7c3e87ed900cb2b6ff0f72292e8a18cb87187b6", "patch": "@@ -1,3 +1,9 @@\n+2015-01-29  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR c++/64717\n+\t* cp-ubsan.c (cp_ubsan_instrument_vptr): Don't wrap vptr\n+\tinto SAVE_EXPR.\n+\n 2015-01-29  Jason Merrill  <jason@redhat.com>\n \n \tPR c++/49508"}, {"sha": "ce12263177077faf895ebf697ac0a76278148975", "filename": "gcc/cp/cp-ubsan.c", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a7c3e87ed900cb2b6ff0f72292e8a18cb87187b6/gcc%2Fcp%2Fcp-ubsan.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a7c3e87ed900cb2b6ff0f72292e8a18cb87187b6/gcc%2Fcp%2Fcp-ubsan.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fcp-ubsan.c?ref=a7c3e87ed900cb2b6ff0f72292e8a18cb87187b6", "patch": "@@ -107,7 +107,6 @@ cp_ubsan_instrument_vptr (location_t loc, tree op, tree type, bool is_addr,\n \t\t\tfold_build2 (NE_EXPR, boolean_type_node, op,\n \t\t\t\t     build_zero_cst (TREE_TYPE (op))),\n \t\t\tvptr, build_int_cst (uint64_type_node, 0));\n-  vptr = build1_loc (loc, SAVE_EXPR, uint64_type_node, vptr);\n   tree ti_decl = get_tinfo_decl (type);\n   mark_used (ti_decl);\n   tree ptype = build_pointer_type (type);"}, {"sha": "d3b38839083bda254c436ec3227cdabc216e0c22", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a7c3e87ed900cb2b6ff0f72292e8a18cb87187b6/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a7c3e87ed900cb2b6ff0f72292e8a18cb87187b6/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=a7c3e87ed900cb2b6ff0f72292e8a18cb87187b6", "patch": "@@ -1,4 +1,10 @@\n-2015-22-01  Uros Bizjak  <ubizjak@gmail.com>\n+2015-01-29  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR c++/64717\n+\t* g++.dg/ubsan/pr64717-1.C: New test.\n+\t* g++.dg/ubsan/pr64717-2.C: New test.\n+\n+2015-01-29  Uros Bizjak  <ubizjak@gmail.com>\n \n \t* gcc.dg/tree-ssa/pr64801.c: Fix scan-tree-dump-not directive.\n "}, {"sha": "45ed8c6f0392b21f8dc992432a3b533a9258be3e", "filename": "gcc/testsuite/g++.dg/ubsan/pr64717-1.C", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a7c3e87ed900cb2b6ff0f72292e8a18cb87187b6/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fubsan%2Fpr64717-1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a7c3e87ed900cb2b6ff0f72292e8a18cb87187b6/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fubsan%2Fpr64717-1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fubsan%2Fpr64717-1.C?ref=a7c3e87ed900cb2b6ff0f72292e8a18cb87187b6", "patch": "@@ -0,0 +1,15 @@\n+// PR c++/64717\n+// { dg-do compile }\n+// { dg-options \"-O2 -Wuninitialized -fsanitize=vptr\" }\n+\n+class Foo {};\n+Foo make_foo ();\n+\n+struct Handle { virtual ~Handle (); };\n+Handle open (Foo);\n+\n+void\n+bar ()\n+{\n+  Handle file (open (make_foo ())); // { dg-bogus \"is used uninitialized\" }\n+}"}, {"sha": "3f10440735ff9ac83c69bda9b5659d54f6f223a2", "filename": "gcc/testsuite/g++.dg/ubsan/pr64717-2.C", "status": "added", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a7c3e87ed900cb2b6ff0f72292e8a18cb87187b6/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fubsan%2Fpr64717-2.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a7c3e87ed900cb2b6ff0f72292e8a18cb87187b6/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fubsan%2Fpr64717-2.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fubsan%2Fpr64717-2.C?ref=a7c3e87ed900cb2b6ff0f72292e8a18cb87187b6", "patch": "@@ -0,0 +1,20 @@\n+// PR c++/64717\n+// { dg-do compile }\n+// { dg-options \"-O2 -Wuninitialized -fsanitize=vptr\" }\n+\n+class ios {};\n+\n+struct stringstream : virtual ios {\n+  stringstream (char *);\n+  ~stringstream ();\n+};\n+\n+struct string { char *c_str (); };\n+\n+string make_str ();\n+\n+void\n+bar ()\n+{\n+  stringstream param (make_str ().c_str ()); // { dg-bogus \"is used uninitialized\" }\n+}"}]}