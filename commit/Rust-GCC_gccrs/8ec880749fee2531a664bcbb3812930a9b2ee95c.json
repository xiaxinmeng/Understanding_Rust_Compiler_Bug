{"sha": "8ec880749fee2531a664bcbb3812930a9b2ee95c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OGVjODgwNzQ5ZmVlMjUzMWE2NjRiY2JiMzgxMjkzMGE5YjJlZTk1Yw==", "commit": {"author": {"name": "Steve Pribyl", "email": "steve@netfuel.com", "date": "2003-07-21T02:09:47Z"}, "committer": {"name": "Tom Tromey", "email": "tromey@gcc.gnu.org", "date": "2003-07-21T02:09:47Z"}, "message": "natSharedLibLoader.cc (init): `libname' now a String.\n\n2003-07-20  Steve Pribyl <steve@netfuel.com.>\n\n\t* gnu/gcj/runtime/natSharedLibLoader.cc (init): `libname' now a\n\tString.  Put dlerror() message into exception.\n\tInclude UnsatisfiedLinkError.\n\t* gnu/gcj/runtime/SharedLibLoader.java (init): `libname' now a\n\tString.  Now native.\n\nFrom-SVN: r69622", "tree": {"sha": "3acb94a20dc2a55b893b5314f730de5134a8ed17", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3acb94a20dc2a55b893b5314f730de5134a8ed17"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8ec880749fee2531a664bcbb3812930a9b2ee95c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8ec880749fee2531a664bcbb3812930a9b2ee95c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8ec880749fee2531a664bcbb3812930a9b2ee95c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8ec880749fee2531a664bcbb3812930a9b2ee95c/comments", "author": null, "committer": null, "parents": [{"sha": "ffd94572f43f8b2a3697c9718c34ac3275a48262", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ffd94572f43f8b2a3697c9718c34ac3275a48262", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ffd94572f43f8b2a3697c9718c34ac3275a48262"}], "stats": {"total": 28, "additions": 20, "deletions": 8}, "files": [{"sha": "8bc4dc79a56e6900e5d6e4f02d2db5b6da8a2168", "filename": "libjava/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8ec880749fee2531a664bcbb3812930a9b2ee95c/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8ec880749fee2531a664bcbb3812930a9b2ee95c/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=8ec880749fee2531a664bcbb3812930a9b2ee95c", "patch": "@@ -1,3 +1,11 @@\n+2003-07-20  Steve Pribyl <steve@netfuel.com.>\n+\n+\t* gnu/gcj/runtime/natSharedLibLoader.cc (init): `libname' now a\n+\tString.  Put dlerror() message into exception.\n+\tInclude UnsatisfiedLinkError.\n+\t* gnu/gcj/runtime/SharedLibLoader.java (init): `libname' now a\n+\tString.  Now native.\n+\n 2003-07-20  Tom Tromey  <tromey@redhat.com>\n \n \t* java/lang/Runtime.java: Comment fix."}, {"sha": "cfcd04e936ad110b45481b03da7a2e9022453721", "filename": "libjava/gnu/gcj/runtime/SharedLibLoader.java", "status": "modified", "additions": 1, "deletions": 6, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8ec880749fee2531a664bcbb3812930a9b2ee95c/libjava%2Fgnu%2Fgcj%2Fruntime%2FSharedLibLoader.java", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8ec880749fee2531a664bcbb3812930a9b2ee95c/libjava%2Fgnu%2Fgcj%2Fruntime%2FSharedLibLoader.java", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fgnu%2Fgcj%2Fruntime%2FSharedLibLoader.java?ref=8ec880749fee2531a664bcbb3812930a9b2ee95c", "patch": "@@ -45,12 +45,7 @@ public SharedLibLoader(String libname)\n     init(libname, 0);\n   }\n \n-  void init(String libname, int flags)\n-  {\n-    init(libname.getBytes(), flags);\n-  }\n-\n-  native void init(byte[] libname, int flags);\n+  native void init(String libname, int flags);\n \n   public Class loadClass(String name)\n     throws ClassNotFoundException"}, {"sha": "49bcfb4d10fca828431f5870c6ec8ede03fe178f", "filename": "libjava/gnu/gcj/runtime/natSharedLibLoader.cc", "status": "modified", "additions": 11, "deletions": 2, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8ec880749fee2531a664bcbb3812930a9b2ee95c/libjava%2Fgnu%2Fgcj%2Fruntime%2FnatSharedLibLoader.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8ec880749fee2531a664bcbb3812930a9b2ee95c/libjava%2Fgnu%2Fgcj%2Fruntime%2FnatSharedLibLoader.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fgnu%2Fgcj%2Fruntime%2FnatSharedLibLoader.cc?ref=8ec880749fee2531a664bcbb3812930a9b2ee95c", "patch": "@@ -14,6 +14,7 @@ details.  */\n #include <gnu/gcj/runtime/SharedLibLoader.h>\n #include <java/io/IOException.h>\n #include <java/lang/UnsupportedOperationException.h>\n+#include <java/lang/UnsatisfiedLinkError.h>\n \n #ifdef HAVE_DLOPEN\n #include <dlfcn.h>\n@@ -45,10 +46,14 @@ struct SharedLibDummy\n #endif\n \n void\n-gnu::gcj::runtime::SharedLibLoader::init(jbyteArray libname, jint flags)\n+gnu::gcj::runtime::SharedLibLoader::init(jstring libname, jint flags)\n {\n #ifdef HAVE_DLOPEN\n-  char *lname = (char*) elements(libname);\n+  jint len = _Jv_GetStringUTFLength (libname);\n+  char lname[len + 1];\n+  JvGetStringUTFRegion (libname, 0, libname->length(), lname);\n+  lname[len] = '\\0';\n+\n   if (flags==0)\n     flags = RTLD_LAZY;\n   JvSynchronize dummy1(&java::lang::Class::class$);\n@@ -59,6 +64,10 @@ gnu::gcj::runtime::SharedLibLoader::init(jbyteArray libname, jint flags)\n   if (h == NULL)\n     {\n       const char *msg = dlerror();\n+      jstring str = JvNewStringLatin1 (lname);\n+      str = str->concat (JvNewStringLatin1 (\": \"));\n+      str = str->concat (JvNewStringLatin1 (msg));\n+      throw new java::lang::UnsatisfiedLinkError (str);\n     }\n   handler = (gnu::gcj::RawData*) h;\n #else"}]}