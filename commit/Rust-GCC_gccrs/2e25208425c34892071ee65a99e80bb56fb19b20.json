{"sha": "2e25208425c34892071ee65a99e80bb56fb19b20", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MmUyNTIwODQyNWMzNDg5MjA3MWVlNjVhOTllODBiYjU2ZmIxOWIyMA==", "commit": {"author": {"name": "Kenneth Zadeck", "email": "zadeck@naturalbridge.com", "date": "2013-11-27T15:42:02Z"}, "committer": {"name": "Kenneth Zadeck", "email": "zadeck@gcc.gnu.org", "date": "2013-11-27T15:42:02Z"}, "message": "c90-const-expr-8.c: Look for overflow on INT_MIN % -1.\n\n2013-11-27  Kenneth Zadeck  <zadeck@naturalbridge.com>\n\n\t* gcc.dg/c90-const-expr-8.c: Look for overflow on INT_MIN % -1.\n\t* gcc.dg/c99-const-expr-8.c: Look for overflow on INT_MIN % -1.\n\n2013-11-27  Kenneth Zadeck  <zadeck@naturalbridge.com>\n\n\t* fold-const.c\n\t(int_const_binop_1): Make INT_MIN % -1 return 0 with the overflow\n\tbit set.\n\nFrom-SVN: r205448", "tree": {"sha": "2550786536ef94f31fb46f8419d188392110b7c1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2550786536ef94f31fb46f8419d188392110b7c1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2e25208425c34892071ee65a99e80bb56fb19b20", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2e25208425c34892071ee65a99e80bb56fb19b20", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2e25208425c34892071ee65a99e80bb56fb19b20", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2e25208425c34892071ee65a99e80bb56fb19b20/comments", "author": {"login": "zadeck", "id": 42682403, "node_id": "MDQ6VXNlcjQyNjgyNDAz", "avatar_url": "https://avatars.githubusercontent.com/u/42682403?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zadeck", "html_url": "https://github.com/zadeck", "followers_url": "https://api.github.com/users/zadeck/followers", "following_url": "https://api.github.com/users/zadeck/following{/other_user}", "gists_url": "https://api.github.com/users/zadeck/gists{/gist_id}", "starred_url": "https://api.github.com/users/zadeck/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zadeck/subscriptions", "organizations_url": "https://api.github.com/users/zadeck/orgs", "repos_url": "https://api.github.com/users/zadeck/repos", "events_url": "https://api.github.com/users/zadeck/events{/privacy}", "received_events_url": "https://api.github.com/users/zadeck/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "e9287a41dffc9e76dd80be4be75b0c3a58f57231", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e9287a41dffc9e76dd80be4be75b0c3a58f57231", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e9287a41dffc9e76dd80be4be75b0c3a58f57231"}], "stats": {"total": 34, "additions": 31, "deletions": 3}, "files": [{"sha": "1ef702c50fee5c6255b32e396ef2ea06c2777864", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2e25208425c34892071ee65a99e80bb56fb19b20/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2e25208425c34892071ee65a99e80bb56fb19b20/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=2e25208425c34892071ee65a99e80bb56fb19b20", "patch": "@@ -1,3 +1,9 @@\n+2013-11-27  Kenneth Zadeck  <zadeck@naturalbridge.com>\n+\n+\t* fold-const.c\n+\t(int_const_binop_1): Make INT_MIN % -1 return 0 with the overflow\n+\tbit set.\n+\n 2013-11-27  Richard Biener  <rguenther@suse.de>\n \n \tPR middle-end/58723"}, {"sha": "fcd7f087be8d66c635f7d10ceaefada3ce1217c7", "filename": "gcc/fold-const.c", "status": "modified", "additions": 16, "deletions": 1, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2e25208425c34892071ee65a99e80bb56fb19b20/gcc%2Ffold-const.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2e25208425c34892071ee65a99e80bb56fb19b20/gcc%2Ffold-const.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffold-const.c?ref=2e25208425c34892071ee65a99e80bb56fb19b20", "patch": "@@ -1110,7 +1110,22 @@ int_const_binop_1 (enum tree_code code, const_tree arg1, const_tree arg2,\n     case ROUND_MOD_EXPR:\n       if (op2.is_zero ())\n \treturn NULL_TREE;\n-      tmp = op1.divmod_with_overflow (op2, uns, code, &res, &overflow);\n+\n+      /* Check for the case the case of INT_MIN % -1 and return\n+       overflow and result = 0.  The TImode case is handled properly\n+       in double-int.  */\n+      if (TYPE_PRECISION (type) <= HOST_BITS_PER_WIDE_INT \n+\t  && !uns\n+          && op2.is_minus_one () \n+\t  && op1.high == (HOST_WIDE_INT) -1\n+\t  && (HOST_WIDE_INT) op1.low \n+\t  == (((HOST_WIDE_INT)-1) << (TYPE_PRECISION (type) - 1)))\n+\t{\n+\t  overflow = 1;\n+\t  res = double_int_zero;\n+\t}\n+      else\n+\ttmp = op1.divmod_with_overflow (op2, uns, code, &res, &overflow);\n       break;\n \n     case MIN_EXPR:"}, {"sha": "075e0b14d80f1e44d4ae16e3c06f1adcfb486c44", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2e25208425c34892071ee65a99e80bb56fb19b20/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2e25208425c34892071ee65a99e80bb56fb19b20/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=2e25208425c34892071ee65a99e80bb56fb19b20", "patch": "@@ -1,3 +1,8 @@\n+2013-11-27  Kenneth Zadeck  <zadeck@naturalbridge.com>\n+\n+\t* gcc.dg/c90-const-expr-8.c: Look for overflow on INT_MIN % -1.\n+\t* gcc.dg/c99-const-expr-8.c: Look for overflow on INT_MIN % -1.\n+\n 2013-11-27  Marek Polacek  <polacek@redhat.com>\n \n \tPR sanitizer/59306"}, {"sha": "b6aba7b1d87eab5ef03a2e553cbcdbc586158dcd", "filename": "gcc/testsuite/gcc.dg/c90-const-expr-8.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2e25208425c34892071ee65a99e80bb56fb19b20/gcc%2Ftestsuite%2Fgcc.dg%2Fc90-const-expr-8.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2e25208425c34892071ee65a99e80bb56fb19b20/gcc%2Ftestsuite%2Fgcc.dg%2Fc90-const-expr-8.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fc90-const-expr-8.c?ref=2e25208425c34892071ee65a99e80bb56fb19b20", "patch": "@@ -23,5 +23,6 @@ enum e {\n   /* { dg-error \"3:overflow in constant expression\" \"constant\" { target *-*-* } 22 } */\n   E6 = 0 * !-INT_MIN, /* { dg-warning \"13:integer overflow in expression\" } */\n   /* { dg-error \"8:not an integer constant\" \"constant\" { target *-*-* } 24 } */\n-  E7 = INT_MIN % -1 /* Not an overflow.  */\n+  E7 = INT_MIN % -1 /* { dg-warning \"16:integer overflow in expression\" } */\n+  /* { dg-error \"1:overflow in constant expression\" \"constant\" { target *-*-* } 28 } */\n };"}, {"sha": "1ddd9ed91ce0d6483b1cd3b80cb1215f6d1be3b7", "filename": "gcc/testsuite/gcc.dg/c99-const-expr-8.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2e25208425c34892071ee65a99e80bb56fb19b20/gcc%2Ftestsuite%2Fgcc.dg%2Fc99-const-expr-8.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2e25208425c34892071ee65a99e80bb56fb19b20/gcc%2Ftestsuite%2Fgcc.dg%2Fc99-const-expr-8.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fc99-const-expr-8.c?ref=2e25208425c34892071ee65a99e80bb56fb19b20", "patch": "@@ -23,5 +23,6 @@ enum e {\n   /* { dg-error \"overflow in constant expression\" \"constant\" { target *-*-* } 22 } */\n   E6 = 0 * !-INT_MIN, /* { dg-warning \"integer overflow in expression\" } */\n   /* { dg-error \"not an integer constant\" \"constant\" { target *-*-* } 24 } */\n-  E7 = INT_MIN % -1 /* Not an overflow.  */\n+  E7 = INT_MIN % -1 /* { dg-warning \"16:integer overflow in expression\" } */\n+  /* { dg-error \"1:overflow in constant expression\" \"constant\" { target *-*-* } 28 } */\n };"}]}