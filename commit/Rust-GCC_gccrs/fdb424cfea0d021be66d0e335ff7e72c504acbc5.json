{"sha": "fdb424cfea0d021be66d0e335ff7e72c504acbc5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZmRiNDI0Y2ZlYTBkMDIxYmU2NmQwZTMzNWZmN2U3MmM1MDRhY2JjNQ==", "commit": {"author": {"name": "Tom de Vries", "email": "tom@codesourcery.com", "date": "2014-11-25T16:45:13Z"}, "committer": {"name": "Tom de Vries", "email": "vries@gcc.gnu.org", "date": "2014-11-25T16:45:13Z"}, "message": "Use .mklog name and email settings, or git settings\n\n2014-11-25  Tom de Vries  <tom@codesourcery.com>\n\t    Peter Bergner  <bergner@vnet.ibm.com>\n\n\t* mklog: Handle .mklog.  Use git setting independent of presence .git\n\tdirectory.\n\nCo-Authored-By: Peter Bergner <bergner@vnet.ibm.com>\n\nFrom-SVN: r218050", "tree": {"sha": "db3b3ee106f34c37786b73f9195448ca945da46f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/db3b3ee106f34c37786b73f9195448ca945da46f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/fdb424cfea0d021be66d0e335ff7e72c504acbc5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fdb424cfea0d021be66d0e335ff7e72c504acbc5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fdb424cfea0d021be66d0e335ff7e72c504acbc5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fdb424cfea0d021be66d0e335ff7e72c504acbc5/comments", "author": null, "committer": null, "parents": [{"sha": "743c11344e3b55bfb0f90983e0bc060c13225054", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/743c11344e3b55bfb0f90983e0bc060c13225054", "html_url": "https://github.com/Rust-GCC/gccrs/commit/743c11344e3b55bfb0f90983e0bc060c13225054"}], "stats": {"total": 62, "additions": 41, "deletions": 21}, "files": [{"sha": "77bad5a9cff22ecea521beba55268ae0ca73d8e2", "filename": "contrib/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fdb424cfea0d021be66d0e335ff7e72c504acbc5/contrib%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fdb424cfea0d021be66d0e335ff7e72c504acbc5/contrib%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2FChangeLog?ref=fdb424cfea0d021be66d0e335ff7e72c504acbc5", "patch": "@@ -1,3 +1,9 @@\n+2014-11-25  Tom de Vries  <tom@codesourcery.com>\n+\t    Peter Bergner  <bergner@vnet.ibm.com>\n+\n+\t* mklog: Handle .mklog.  Use git setting independent of presence .git\n+\tdirectory.\n+\n 2014-11-14  Tom de Vries  <tom@codesourcery.com>\n \n \t* mklog: Move reading of .diff file up and add comment.  Copy diff_lines"}, {"sha": "f7974a7bd156a870b9f0be94f07ebd4853c11352", "filename": "contrib/mklog", "status": "modified", "additions": 35, "deletions": 21, "changes": 56, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fdb424cfea0d021be66d0e335ff7e72c504acbc5/contrib%2Fmklog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fdb424cfea0d021be66d0e335ff7e72c504acbc5/contrib%2Fmklog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2Fmklog?ref=fdb424cfea0d021be66d0e335ff7e72c504acbc5", "patch": "@@ -29,32 +29,46 @@\n use File::Temp;\n use File::Copy qw(cp mv);\n \n-# Change these settings to reflect your profile.\n-$username = $ENV{'USER'};\n-$name = `finger $username | grep -o 'Name: .*'`;\n-@n = split(/: /, $name);\n-$name = $n[1]; chop($name);\n-$addr = $username . \"\\@my.domain.org\";\n $date = `date +%Y-%m-%d`; chop ($date);\n \n+$dot_mklog_format_msg =\n+    \"The .mklog format is:\\n\"\n+    . \"NAME = ...\\n\"\n+    . \"EMAIL = ...\\n\";\n+\n+# Create a .mklog to reflect your profile, if necessary.\n+my $conf = \"$ENV{HOME}/.mklog\";\n+if (-f \"$conf\") {\n+    open (CONF, \"$conf\")\n+\tor die \"Could not open file '$conf' for reading: $!\\n\";\n+    while (<CONF>) {\n+\tif (m/^\\s*NAME\\s*=\\s*(.*?)\\s*$/) {\n+\t    $name = $1;\n+\t} elsif (m/^\\s*EMAIL\\s*=\\s*(.*?)\\s*$/) {\n+\t    $addr = $1;\n+\t}\n+    }\n+    if (!($name && $addr)) {\n+\tdie \"Could not read .mklog settings.\\n\"\n+\t    . $dot_mklog_format_msg;\n+    }\n+} else {\n+    $name = `git config user.name`;\n+    chomp($name);\n+    $addr = `git config user.email`;\n+    chomp($addr);\n+\n+    if (!($name && $addr)) {\n+\tdie \"Could not read git user.name and user.email settings.\\n\"\n+\t    . \"Please add missing git settings, or create a .mklog file in\"\n+\t    . \" $ENV{HOME}.\\n\"\n+\t    . $dot_mklog_format_msg;\n+    }\n+}\n+\n $gcc_root = $0;\n $gcc_root =~ s/[^\\\\\\/]+$/../;\n \n-# if this is a git tree then take name and email from the git configuration\n-if (-d \"$gcc_root/.git\") {\n-  $gitname = `git config user.name`;\n-  chomp($gitname);\n-  if ($gitname) {\n-\t  $name = $gitname;\n-  }\n-\n-  $gitaddr = `git config user.email`;\n-  chomp($gitaddr);\n-  if ($gitaddr) {\n-\t  $addr = $gitaddr;\n-  }\n-}\n-\n #-----------------------------------------------------------------------------\n # Program starts here. You should not need to edit anything below this\n # line."}]}