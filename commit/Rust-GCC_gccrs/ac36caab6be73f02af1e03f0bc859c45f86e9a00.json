{"sha": "ac36caab6be73f02af1e03f0bc859c45f86e9a00", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWMzNmNhYWI2YmU3M2YwMmFmMWUwM2YwYmM4NTljNDVmODZlOWEwMA==", "commit": {"author": {"name": "Vincent Celier", "email": "celier@adacore.com", "date": "2006-10-31T18:00:14Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2006-10-31T18:00:14Z"}, "message": "gnatls.adb: Take into account GPR_PROJECT_PATH...\n\n2006-10-31  Vincent Celier  <celier@adacore.com>\n        \n\t* gnatls.adb: Take into account GPR_PROJECT_PATH, when it is defined,\n\tinstead of ADA_PROJECT_PATH, for the project path.\n\t(Gnatls): When displaying the project path directories, use host dir\n\tspecs.\n\n\t* prj-ext.adb (Prj.Ext elaboration): On VMS, only expand relative path\n\tnames in the project path, as absolute paths may correspond to\n\tmulti-valued VMS logical names.\n\nFrom-SVN: r118278", "tree": {"sha": "5e020b43997063f84a1635efa6516b4f13846069", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5e020b43997063f84a1635efa6516b4f13846069"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ac36caab6be73f02af1e03f0bc859c45f86e9a00", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ac36caab6be73f02af1e03f0bc859c45f86e9a00", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ac36caab6be73f02af1e03f0bc859c45f86e9a00", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ac36caab6be73f02af1e03f0bc859c45f86e9a00/comments", "author": {"login": "vcelier", "id": 8888056, "node_id": "MDQ6VXNlcjg4ODgwNTY=", "avatar_url": "https://avatars.githubusercontent.com/u/8888056?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vcelier", "html_url": "https://github.com/vcelier", "followers_url": "https://api.github.com/users/vcelier/followers", "following_url": "https://api.github.com/users/vcelier/following{/other_user}", "gists_url": "https://api.github.com/users/vcelier/gists{/gist_id}", "starred_url": "https://api.github.com/users/vcelier/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vcelier/subscriptions", "organizations_url": "https://api.github.com/users/vcelier/orgs", "repos_url": "https://api.github.com/users/vcelier/repos", "events_url": "https://api.github.com/users/vcelier/events{/privacy}", "received_events_url": "https://api.github.com/users/vcelier/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "ef6ea465e38970e96a0ab50641e761f1b7c4dcff", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ef6ea465e38970e96a0ab50641e761f1b7c4dcff", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ef6ea465e38970e96a0ab50641e761f1b7c4dcff"}], "stats": {"total": 52, "additions": 32, "deletions": 20}, "files": [{"sha": "2d3ad747871d71f950973d14dd0117f77bc30919", "filename": "gcc/ada/gnatls.adb", "status": "modified", "additions": 19, "deletions": 13, "changes": 32, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ac36caab6be73f02af1e03f0bc859c45f86e9a00/gcc%2Fada%2Fgnatls.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ac36caab6be73f02af1e03f0bc859c45f86e9a00/gcc%2Fada%2Fgnatls.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgnatls.adb?ref=ac36caab6be73f02af1e03f0bc859c45f86e9a00", "patch": "@@ -48,9 +48,11 @@ with GNAT.Case_Util; use GNAT.Case_Util;\n procedure Gnatls is\n    pragma Ident (Gnat_Static_Version_String);\n \n+   Gpr_Project_Path : constant String := \"GPR_PROJECT_PATH\";\n    Ada_Project_Path : constant String := \"ADA_PROJECT_PATH\";\n-   --  Name of the env. variable that contains path name(s) of directories\n-   --  where project files may reside.\n+   --  Names of the env. variables that contains path name(s) of directories\n+   --  where project files may reside. If GPR_PROJECT_PATH is defined, its\n+   --  value is used, otherwise ADA_PROJECT_PATH is used, if defined.\n \n    --  NOTE : The following string may be used by other tools, such as GPS. So\n    --  it can only be modified if these other uses are checked and coordinated.\n@@ -1547,10 +1549,10 @@ begin\n       Write_Eol;\n \n       declare\n-         Project_Path : constant String_Access := Getenv (Ada_Project_Path);\n+         Project_Path : String_Access := Getenv (Gpr_Project_Path);\n \n-         Lib    : constant String :=\n-                    Directory_Separator & \"lib\" & Directory_Separator;\n+         Lib : constant String :=\n+                 Directory_Separator & \"lib\" & Directory_Separator;\n \n          First : Natural;\n          Last  : Natural;\n@@ -1560,9 +1562,12 @@ begin\n       begin\n          --  If there is a project path, display each directory in the path\n \n+         if Project_Path.all = \"\" then\n+            Project_Path := Getenv (Ada_Project_Path);\n+         end if;\n+\n          if Project_Path.all /= \"\" then\n             First := Project_Path'First;\n-\n             loop\n                while First <= Project_Path'Last\n                  and then (Project_Path (First) = Path_Separator)\n@@ -1573,7 +1578,6 @@ begin\n                exit when First > Project_Path'Last;\n \n                Last := First;\n-\n                while Last < Project_Path'Last\n                  and then Project_Path (Last + 1) /= Path_Separator\n                loop\n@@ -1593,7 +1597,9 @@ begin\n                   --  project path.\n \n                   Write_Str (\"   \");\n-                  Write_Str (Project_Path (First .. Last));\n+                  Write_Str\n+                    (To_Host_Dir_Spec\n+                       (Project_Path (First .. Last), True).all);\n                   Write_Eol;\n                end if;\n \n@@ -1630,11 +1636,11 @@ begin\n             --  directory <prefix>/lib/gnat/.\n \n             if Name_Len >= 5 then\n-               Write_Str (\"   \");\n-               Write_Str (Name_Buffer (1 .. Name_Len));\n-               Write_Str (\"gnat\");\n-               Write_Char (Directory_Separator);\n-               Write_Eol;\n+               Name_Buffer (Name_Len + 1 .. Name_Len + 4) := \"gnat\";\n+               Name_Buffer (Name_Len + 5) := Directory_Separator;\n+               Name_Len := Name_Len + 5;\n+               Write_Line\n+                 (To_Host_Dir_Spec (Name_Buffer (1 .. Name_Len), True).all);\n             end if;\n          end if;\n       end;"}, {"sha": "649c2ba15e3aa0539bf0871da188049835970c24", "filename": "gcc/ada/prj-ext.adb", "status": "modified", "additions": 13, "deletions": 7, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ac36caab6be73f02af1e03f0bc859c45f86e9a00/gcc%2Fada%2Fprj-ext.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ac36caab6be73f02af1e03f0bc859c45f86e9a00/gcc%2Fada%2Fprj-ext.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-ext.adb?ref=ac36caab6be73f02af1e03f0bc859c45f86e9a00", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 B o d y                                  --\n --                                                                          --\n---          Copyright (C) 2000-2005, Free Software Foundation, Inc.         --\n+--          Copyright (C) 2000-2006, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -24,9 +24,10 @@\n --                                                                          --\n ------------------------------------------------------------------------------\n \n-with Namet;   use Namet;\n-with Output;  use Output;\n-with Osint;   use Osint;\n+with Hostparm;\n+with Namet;    use Namet;\n+with Output;   use Output;\n+with Osint;    use Osint;\n with Sdefault;\n \n with GNAT.HTable;\n@@ -73,7 +74,6 @@ package body Prj.Ext is\n    is\n       The_Key   : Name_Id;\n       The_Value : Name_Id;\n-\n    begin\n       Name_Len := Value'Length;\n       Name_Buffer (1 .. Name_Len) := Value;\n@@ -251,10 +251,16 @@ begin\n \n                Name_Len := Name_Len - No_Project_Default_Dir'Length - 1;\n \n-            else\n+            elsif not Hostparm.OpenVMS\n+              or else not Is_Absolute_Path (Name_Buffer (First .. Last))\n+            then\n+               --  On VMS, only expand relative path names, as absolute paths\n+               --  may correspond to multi-valued VMS logical names.\n+\n                declare\n                   New_Dir : constant String :=\n-                             Normalize_Pathname (Name_Buffer (First .. Last));\n+                              Normalize_Pathname (Name_Buffer (First .. Last));\n+\n                begin\n                   --  If the absolute path was resolved and is different from\n                   --  the original, replace original with the resolved path."}]}