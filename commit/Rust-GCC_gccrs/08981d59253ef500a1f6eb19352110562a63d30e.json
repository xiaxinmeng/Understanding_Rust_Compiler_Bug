{"sha": "08981d59253ef500a1f6eb19352110562a63d30e", "node_id": "C_kwDOANBUbNoAKDA4OTgxZDU5MjUzZWY1MDBhMWY2ZWIxOTM1MjExMDU2MmE2M2QzMGU", "commit": {"author": {"name": "Hans-Peter Nilsson", "email": "hp@axis.com", "date": "2023-03-21T15:09:23Z"}, "committer": {"name": "Hans-Peter Nilsson", "email": "hp@bitrange.com", "date": "2023-03-23T20:48:58Z"}, "message": "testsuite: Compile-only gcc.dg/tree-ssa/pr100359.c if ! natural_alignment_32\n\nThe test gcc.dg/tree-ssa/pr100359.c fails the \"test for\nexcess errors\" for at least m68k-linux, pru-elf, and\ncris-elf according to posts on gcc-testresults.  For\ncris-elf, the \"excess errors\" is a failure to link; an\nundefined reference to foo, because the code has a call to\nan extern function foo, which is not optimized away, and\nwhich is not defined.  I guess it's the same for those other\ntargets.\n\nFrom comparative gdb sessions for native x86_64-linux and\ncris-elf, I see tree-ssa-sccvn.cc:vn_reference_lookup_3\n(called from the \"pre\" pass) requires int-size-alignment for\na target to see through the \"int *\" dereference, that the\nexpression is constant false and subsequently optimize away\nthe call to foo.  The conclusion is with substantially less\neffort available from comments in PR91419.\n\nThe point of the test seems only incidental to\noptimizing-out the call to foo, judging from the comments in\nPR100359, so an alternative is compile it (not link it) for\nall targets.  However, I chose to not change the nature of\nthe test where it passes.\n\n\t* gcc.dg/tree-ssa/pr100359.c: Compile-only for ! natural_alignment_32.", "tree": {"sha": "fca3d0729d885f5fe6b50fda460f4ad1dab537d4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/fca3d0729d885f5fe6b50fda460f4ad1dab537d4"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/08981d59253ef500a1f6eb19352110562a63d30e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/08981d59253ef500a1f6eb19352110562a63d30e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/08981d59253ef500a1f6eb19352110562a63d30e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/08981d59253ef500a1f6eb19352110562a63d30e/comments", "author": {"login": "hpataxisdotcom", "id": 80339731, "node_id": "MDQ6VXNlcjgwMzM5NzMx", "avatar_url": "https://avatars.githubusercontent.com/u/80339731?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hpataxisdotcom", "html_url": "https://github.com/hpataxisdotcom", "followers_url": "https://api.github.com/users/hpataxisdotcom/followers", "following_url": "https://api.github.com/users/hpataxisdotcom/following{/other_user}", "gists_url": "https://api.github.com/users/hpataxisdotcom/gists{/gist_id}", "starred_url": "https://api.github.com/users/hpataxisdotcom/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hpataxisdotcom/subscriptions", "organizations_url": "https://api.github.com/users/hpataxisdotcom/orgs", "repos_url": "https://api.github.com/users/hpataxisdotcom/repos", "events_url": "https://api.github.com/users/hpataxisdotcom/events{/privacy}", "received_events_url": "https://api.github.com/users/hpataxisdotcom/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "f58cbbb7c90d8cfea87dc4490b575a368e1e2c82", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f58cbbb7c90d8cfea87dc4490b575a368e1e2c82", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f58cbbb7c90d8cfea87dc4490b575a368e1e2c82"}], "stats": {"total": 3, "additions": 2, "deletions": 1}, "files": [{"sha": "236dbef41c4ec12355e2a1f73bbf81ab5a89bd79", "filename": "gcc/testsuite/gcc.dg/tree-ssa/pr100359.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/08981d59253ef500a1f6eb19352110562a63d30e/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fpr100359.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/08981d59253ef500a1f6eb19352110562a63d30e/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fpr100359.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fpr100359.c?ref=08981d59253ef500a1f6eb19352110562a63d30e", "patch": "@@ -1,4 +1,5 @@\n-/* { dg-do link } */\n+/* { dg-do link { target natural_alignment_32 } } */\n+/* { dg-do compile { target { ! natural_alignment_32 } } } */\n /* { dg-options \"-O3 -fdump-tree-cunrolli-optimized\" } */\n \n extern void foo(void);"}]}