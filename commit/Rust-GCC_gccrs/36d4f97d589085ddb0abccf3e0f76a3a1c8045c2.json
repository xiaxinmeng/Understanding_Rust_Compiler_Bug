{"sha": "36d4f97d589085ddb0abccf3e0f76a3a1c8045c2", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzZkNGY5N2Q1ODkwODVkZGIwYWJjY2YzZTBmNzZhM2ExYzgwNDVjMg==", "commit": {"author": {"name": "Ghjuvan Lacambre", "email": "lacambre@adacore.com", "date": "2021-03-17T17:33:34Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "derodat@adacore.com", "date": "2021-07-05T13:09:11Z"}, "message": "[Ada] Turn GNAT_Annotate into its own pragma\n\ngcc/ada/\n\n\t* aspects.ads: Add GNAT_Annotate aspect.\n\t* gnat1drv.adb (Adjust_Global_Switches): Stop defining\n\tName_Gnat_Annotate as an alias of Name_Annotate.\n\t* snames.ads-tmpl: Define Gnat_Annotate.\n\t* par-prag.adb, sem_prag.ads: Add Pragma_Gnat_Annotate to list\n\tof pragmas.\n\t* lib-writ.adb, sem_ch13.adb, sem_prag.adb: Handle Gnat_Annotate\n\tlike Aspect_Annotate.", "tree": {"sha": "bc2fa1aa5114abe2e6742cb3f6905978d7a72a99", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/bc2fa1aa5114abe2e6742cb3f6905978d7a72a99"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/36d4f97d589085ddb0abccf3e0f76a3a1c8045c2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/36d4f97d589085ddb0abccf3e0f76a3a1c8045c2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/36d4f97d589085ddb0abccf3e0f76a3a1c8045c2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/36d4f97d589085ddb0abccf3e0f76a3a1c8045c2/comments", "author": {"login": "glacambre", "id": 11534587, "node_id": "MDQ6VXNlcjExNTM0NTg3", "avatar_url": "https://avatars.githubusercontent.com/u/11534587?v=4", "gravatar_id": "", "url": "https://api.github.com/users/glacambre", "html_url": "https://github.com/glacambre", "followers_url": "https://api.github.com/users/glacambre/followers", "following_url": "https://api.github.com/users/glacambre/following{/other_user}", "gists_url": "https://api.github.com/users/glacambre/gists{/gist_id}", "starred_url": "https://api.github.com/users/glacambre/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/glacambre/subscriptions", "organizations_url": "https://api.github.com/users/glacambre/orgs", "repos_url": "https://api.github.com/users/glacambre/repos", "events_url": "https://api.github.com/users/glacambre/events{/privacy}", "received_events_url": "https://api.github.com/users/glacambre/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pmderodat", "id": 758452, "node_id": "MDQ6VXNlcjc1ODQ1Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/758452?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pmderodat", "html_url": "https://github.com/pmderodat", "followers_url": "https://api.github.com/users/pmderodat/followers", "following_url": "https://api.github.com/users/pmderodat/following{/other_user}", "gists_url": "https://api.github.com/users/pmderodat/gists{/gist_id}", "starred_url": "https://api.github.com/users/pmderodat/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pmderodat/subscriptions", "organizations_url": "https://api.github.com/users/pmderodat/orgs", "repos_url": "https://api.github.com/users/pmderodat/repos", "events_url": "https://api.github.com/users/pmderodat/events{/privacy}", "received_events_url": "https://api.github.com/users/pmderodat/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "22c0e0cabd0d9c1f100e7a5f43c8781198e3448e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/22c0e0cabd0d9c1f100e7a5f43c8781198e3448e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/22c0e0cabd0d9c1f100e7a5f43c8781198e3448e"}], "stats": {"total": 33, "additions": 19, "deletions": 14}, "files": [{"sha": "0f9ed232c8029c8770dffce8215f273c01f41570", "filename": "gcc/ada/aspects.ads", "status": "modified", "additions": 10, "deletions": 3, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/36d4f97d589085ddb0abccf3e0f76a3a1c8045c2/gcc%2Fada%2Faspects.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/36d4f97d589085ddb0abccf3e0f76a3a1c8045c2/gcc%2Fada%2Faspects.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Faspects.ads?ref=36d4f97d589085ddb0abccf3e0f76a3a1c8045c2", "patch": "@@ -100,6 +100,7 @@ package Aspects is\n       Aspect_External_Tag,\n       Aspect_Ghost,                         -- GNAT\n       Aspect_Global,                        -- GNAT\n+      Aspect_GNAT_Annotate,                 -- GNAT\n       Aspect_Implicit_Dereference,\n       Aspect_Initial_Condition,             -- GNAT\n       Aspect_Initializes,                   -- GNAT\n@@ -269,6 +270,7 @@ package Aspects is\n       Aspect_Favor_Top_Level            => True,\n       Aspect_Ghost                      => True,\n       Aspect_Global                     => True,\n+      Aspect_GNAT_Annotate              => True,\n       Aspect_Inline_Always              => True,\n       Aspect_Invariant                  => True,\n       Aspect_Lock_Free                  => True,\n@@ -318,9 +320,10 @@ package Aspects is\n    --  the same aspect attached to the same declaration are allowed.\n \n    No_Duplicates_Allowed : constant array (Aspect_Id) of Boolean :=\n-     (Aspect_Annotate  => False,\n-      Aspect_Test_Case => False,\n-      others           => True);\n+     (Aspect_Annotate      => False,\n+      Aspect_GNAT_Annotate => False,\n+      Aspect_Test_Case     => False,\n+      others               => True);\n \n    --  The following subtype defines aspects corresponding to library unit\n    --  pragmas, these can only validly appear as aspects for library units,\n@@ -387,6 +390,7 @@ package Aspects is\n       Aspect_External_Tag               => Expression,\n       Aspect_Ghost                      => Optional_Expression,\n       Aspect_Global                     => Expression,\n+      Aspect_GNAT_Annotate              => Expression,\n       Aspect_Implicit_Dereference       => Name,\n       Aspect_Initial_Condition          => Expression,\n       Aspect_Initializes                => Expression,\n@@ -491,6 +495,7 @@ package Aspects is\n       Aspect_External_Tag                 => False,\n       Aspect_Ghost                        => False,\n       Aspect_Global                       => False,\n+      Aspect_GNAT_Annotate               => False,\n       Aspect_Implicit_Dereference         => False,\n       Aspect_Initial_Condition            => False,\n       Aspect_Initializes                  => False,\n@@ -647,6 +652,7 @@ package Aspects is\n       Aspect_Full_Access_Only             => Name_Full_Access_Only,\n       Aspect_Ghost                        => Name_Ghost,\n       Aspect_Global                       => Name_Global,\n+      Aspect_GNAT_Annotate                => Name_GNAT_Annotate,\n       Aspect_Implicit_Dereference         => Name_Implicit_Dereference,\n       Aspect_Import                       => Name_Import,\n       Aspect_Independent                  => Name_Independent,\n@@ -957,6 +963,7 @@ package Aspects is\n       Aspect_Extensions_Visible           => Never_Delay,\n       Aspect_Ghost                        => Never_Delay,\n       Aspect_Global                       => Never_Delay,\n+      Aspect_GNAT_Annotate                => Never_Delay,\n       Aspect_Import                       => Never_Delay,\n       Aspect_Initial_Condition            => Never_Delay,\n       Aspect_Initializes                  => Never_Delay,"}, {"sha": "22c93113709c071125280ab16745d0b047b0cab2", "filename": "gcc/ada/gnat1drv.adb", "status": "modified", "additions": 0, "deletions": 7, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/36d4f97d589085ddb0abccf3e0f76a3a1c8045c2/gcc%2Fada%2Fgnat1drv.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/36d4f97d589085ddb0abccf3e0f76a3a1c8045c2/gcc%2Fada%2Fgnat1drv.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgnat1drv.adb?ref=36d4f97d589085ddb0abccf3e0f76a3a1c8045c2", "patch": "@@ -67,7 +67,6 @@ with Sem_Type;\n with Set_Targ;\n with Sinfo;          use Sinfo;\n with Sinfo.Nodes;    use Sinfo.Nodes;\n-with Sinfo.Utils;    use Sinfo.Utils;\n with Sinput;         use Sinput;\n with Sinput.L;       use Sinput.L;\n with Snames;         use Snames;\n@@ -146,12 +145,6 @@ procedure Gnat1drv is\n    --  Start of processing for Adjust_Global_Switches\n \n    begin\n-      --  Define pragma GNAT_Annotate as an alias of pragma Annotate, to be\n-      --  able to work around bootstrap limitations with the old syntax of\n-      --  pragma Annotate, and use pragma GNAT_Annotate in compiler sources\n-      --  when needed.\n-\n-      Map_Pragma_Name (From => Name_Gnat_Annotate, To => Name_Annotate);\n \n       --  -gnatd_U disables prepending error messages with \"error:\"\n "}, {"sha": "16993dd8f43182d2aef80c945f7f34e74cccbc34", "filename": "gcc/ada/lib-writ.adb", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/36d4f97d589085ddb0abccf3e0f76a3a1c8045c2/gcc%2Fada%2Flib-writ.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/36d4f97d589085ddb0abccf3e0f76a3a1c8045c2/gcc%2Fada%2Flib-writ.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flib-writ.adb?ref=36d4f97d589085ddb0abccf3e0f76a3a1c8045c2", "patch": "@@ -709,7 +709,7 @@ package body Lib.Writ is\n                   Write_Info_Char (' ');\n \n                   case Pragma_Name (N) is\n-                     when Name_Annotate =>\n+                     when Name_Annotate | Name_GNAT_Annotate =>\n                         C := 'A';\n                      when Name_Comment =>\n                         C := 'C';"}, {"sha": "06c7d877fe226eeabc82d98aba1d763a1fc1ac1a", "filename": "gcc/ada/par-prag.adb", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/36d4f97d589085ddb0abccf3e0f76a3a1c8045c2/gcc%2Fada%2Fpar-prag.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/36d4f97d589085ddb0abccf3e0f76a3a1c8045c2/gcc%2Fada%2Fpar-prag.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fpar-prag.adb?ref=36d4f97d589085ddb0abccf3e0f76a3a1c8045c2", "patch": "@@ -1389,6 +1389,7 @@ begin\n          | Pragma_Finalize_Storage_Only\n          | Pragma_Ghost\n          | Pragma_Global\n+         | Pragma_GNAT_Annotate\n          | Pragma_Ident\n          | Pragma_Implementation_Defined\n          | Pragma_Implemented"}, {"sha": "cdc00832e931ea5592e5cd422e71657529689b26", "filename": "gcc/ada/sem_ch13.adb", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/36d4f97d589085ddb0abccf3e0f76a3a1c8045c2/gcc%2Fada%2Fsem_ch13.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/36d4f97d589085ddb0abccf3e0f76a3a1c8045c2/gcc%2Fada%2Fsem_ch13.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch13.adb?ref=36d4f97d589085ddb0abccf3e0f76a3a1c8045c2", "patch": "@@ -4199,7 +4199,7 @@ package body Sem_Ch13 is\n \n                --  Case 2e: Annotate aspect\n \n-               when Aspect_Annotate =>\n+               when Aspect_Annotate | Aspect_GNAT_Annotate =>\n                   declare\n                      Args  : List_Id;\n                      Pargs : List_Id;\n@@ -11117,6 +11117,7 @@ package body Sem_Ch13 is\n             | Aspect_Extensions_Visible\n             | Aspect_Ghost\n             | Aspect_Global\n+            | Aspect_GNAT_Annotate\n             | Aspect_Implicit_Dereference\n             | Aspect_Initial_Condition\n             | Aspect_Initializes"}, {"sha": "36b305eec31ffc5168e842a7a6f94fb5c24e97ce", "filename": "gcc/ada/sem_prag.adb", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/36d4f97d589085ddb0abccf3e0f76a3a1c8045c2/gcc%2Fada%2Fsem_prag.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/36d4f97d589085ddb0abccf3e0f76a3a1c8045c2/gcc%2Fada%2Fsem_prag.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_prag.adb?ref=36d4f97d589085ddb0abccf3e0f76a3a1c8045c2", "patch": "@@ -12688,7 +12688,7 @@ package body Sem_Prag is\n          --  external tool and a tool-specific function. These arguments are\n          --  not analyzed.\n \n-         when Pragma_Annotate => Annotate : declare\n+         when Pragma_Annotate | Pragma_GNAT_Annotate => Annotate : declare\n             Arg     : Node_Id;\n             Expr    : Node_Id;\n             Nam_Arg : Node_Id;\n@@ -31246,6 +31246,7 @@ package body Sem_Prag is\n       Pragma_Finalize_Storage_Only          =>  0,\n       Pragma_Ghost                          =>  0,\n       Pragma_Global                         => -1,\n+      Pragma_GNAT_Annotate                  => 93,\n       Pragma_Ident                          => -1,\n       Pragma_Ignore_Pragma                  =>  0,\n       Pragma_Implementation_Defined         => -1,"}, {"sha": "e1664811f5066d11e347734e0a5746a11ca25e26", "filename": "gcc/ada/sem_prag.ads", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/36d4f97d589085ddb0abccf3e0f76a3a1c8045c2/gcc%2Fada%2Fsem_prag.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/36d4f97d589085ddb0abccf3e0f76a3a1c8045c2/gcc%2Fada%2Fsem_prag.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_prag.ads?ref=36d4f97d589085ddb0abccf3e0f76a3a1c8045c2", "patch": "@@ -63,6 +63,7 @@ package Sem_Prag is\n       Pragma_Favor_Top_Level              => True,\n       Pragma_Ghost                        => True,\n       Pragma_Global                       => True,\n+      Pragma_GNAT_Annotate                => True,\n       Pragma_Import                       => True,\n       Pragma_Independent                  => True,\n       Pragma_Independent_Components       => True,"}, {"sha": "837a878cfdad8bb956db70b61ea5b45b08e2f2a8", "filename": "gcc/ada/snames.ads-tmpl", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/36d4f97d589085ddb0abccf3e0f76a3a1c8045c2/gcc%2Fada%2Fsnames.ads-tmpl", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/36d4f97d589085ddb0abccf3e0f76a3a1c8045c2/gcc%2Fada%2Fsnames.ads-tmpl", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsnames.ads-tmpl?ref=36d4f97d589085ddb0abccf3e0f76a3a1c8045c2", "patch": "@@ -439,6 +439,7 @@ package Snames is\n    --  correctly recognize and process Fast_Math.\n \n    Name_Favor_Top_Level                : constant Name_Id := N + $; -- GNAT\n+   Name_GNAT_Annotate                  : constant Name_Id := N + $; -- GNAT\n    Name_Ignore_Pragma                  : constant Name_Id := N + $; -- GNAT\n    Name_Implicit_Packing               : constant Name_Id := N + $; -- GNAT\n    Name_Initialize_Scalars             : constant Name_Id := N + $; -- GNAT\n@@ -796,7 +797,6 @@ package Snames is\n    Name_Gcc                            : constant Name_Id := N + $;\n    Name_General                        : constant Name_Id := N + $;\n    Name_Gnat                           : constant Name_Id := N + $;\n-   Name_Gnat_Annotate                  : constant Name_Id := N + $;\n    Name_Gnat_Extended_Ravenscar        : constant Name_Id := N + $;\n    Name_Gnat_Ravenscar_EDF             : constant Name_Id := N + $;\n    Name_Gnatprove                      : constant Name_Id := N + $;\n@@ -1767,6 +1767,7 @@ package Snames is\n       Pragma_Extensions_Allowed,\n       Pragma_External_Name_Casing,\n       Pragma_Favor_Top_Level,\n+      Pragma_GNAT_Annotate,\n       Pragma_Ignore_Pragma,\n       Pragma_Implicit_Packing,\n       Pragma_Initialize_Scalars,"}]}