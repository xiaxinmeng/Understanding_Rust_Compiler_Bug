{"sha": "d29445972065f54566402b255d76b2567e23d445", "node_id": "C_kwDOANBUbNoAKGQyOTQ0NTk3MjA2NWY1NDU2NjQwMmIyNTVkNzZiMjU2N2UyM2Q0NDU", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2021-11-15T07:54:52Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2021-11-15T07:58:39Z"}, "message": "libgomp: Add a testcase for omp_get_num_teams inside of target inside of host teams\n\nThis is https://github.com/OpenMP/spec/issues/3183\nThere is an agreement that we should return 1 team inside of target,\neven if that target is inside of host teams.  We were doing that\nwhen offloading and not during host fallback, r12-5151 should fix that\neven for host fallback.\n\n2021-11-15  Jakub Jelinek  <jakub@redhat.com>\n\n\t* testsuite/libgomp.c/teams-5.c: New test.", "tree": {"sha": "31e83c94cc017f00667cc6d4da6003ab4eae6062", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/31e83c94cc017f00667cc6d4da6003ab4eae6062"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d29445972065f54566402b255d76b2567e23d445", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d29445972065f54566402b255d76b2567e23d445", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d29445972065f54566402b255d76b2567e23d445", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d29445972065f54566402b255d76b2567e23d445/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2317082c151e5580e0bfe5fcfbd0e9d0172446c9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2317082c151e5580e0bfe5fcfbd0e9d0172446c9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2317082c151e5580e0bfe5fcfbd0e9d0172446c9"}], "stats": {"total": 17, "additions": 17, "deletions": 0}, "files": [{"sha": "ad42e05825f56be3af9222d1f17ad61e96d0137d", "filename": "libgomp/testsuite/libgomp.c/teams-5.c", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d29445972065f54566402b255d76b2567e23d445/libgomp%2Ftestsuite%2Flibgomp.c%2Fteams-5.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d29445972065f54566402b255d76b2567e23d445/libgomp%2Ftestsuite%2Flibgomp.c%2Fteams-5.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Ftestsuite%2Flibgomp.c%2Fteams-5.c?ref=d29445972065f54566402b255d76b2567e23d445", "patch": "@@ -0,0 +1,17 @@\n+#include <omp.h>\n+#include <stdlib.h>\n+\n+int\n+main ()\n+{\n+  #pragma omp teams num_teams (2)\n+  {\n+    if (omp_get_num_teams () != 2)\n+      abort ();\n+    #pragma omp parallel if (0)\n+    #pragma omp target\n+    if (omp_get_num_teams () != 1 || omp_get_team_num () != 0)\n+      abort ();\n+  }\n+  return 0;\n+}"}]}