{"sha": "08f0e79ed931917b74221563e09d85e4804c4293", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDhmMGU3OWVkOTMxOTE3Yjc0MjIxNTYzZTA5ZDg1ZTQ4MDRjNDI5Mw==", "commit": {"author": {"name": "Tom Tromey", "email": "tromey@redhat.com", "date": "2007-01-10T19:28:39Z"}, "committer": {"name": "Tom Tromey", "email": "tromey@gcc.gnu.org", "date": "2007-01-10T19:28:39Z"}, "message": "fold-const.c (fold_truthop): Don't check can_use_bit_fields_p.\n\ngcc\n\t* fold-const.c (fold_truthop): Don't check can_use_bit_fields_p.\n\t(fold_binary): Likewise.\n\t* langhooks.c (lhd_can_use_bit_fields_p): Removed.\n\t* langhooks-def.h (lhd_can_use_bit_fields_p): Removed.\n\t(LANG_HOOKS_CAN_USE_BIT_FIELDS_P): Removed.\n\t(LANG_HOOKS_INITIALIZER): Remove LANG_HOOKS_CAN_USE_BIT_FIELDS_P.\n\t* langhooks.h (struct lang_hooks): Removed field\n\t'can_use_bit_fields_p'.\ngcc/java\n\t* lang.c (java_can_use_bit_fields_p): Removed.\n\t(LANG_HOOKS_CAN_USE_BIT_FIELDS_P): Removed.\n\nFrom-SVN: r120647", "tree": {"sha": "722fcda144ee1c967294ec48adf52843af50195d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/722fcda144ee1c967294ec48adf52843af50195d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/08f0e79ed931917b74221563e09d85e4804c4293", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/08f0e79ed931917b74221563e09d85e4804c4293", "html_url": "https://github.com/Rust-GCC/gccrs/commit/08f0e79ed931917b74221563e09d85e4804c4293", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/08f0e79ed931917b74221563e09d85e4804c4293/comments", "author": null, "committer": null, "parents": [{"sha": "e0ae13896e72fdc6d0cf2a93452ecbb8a7993860", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e0ae13896e72fdc6d0cf2a93452ecbb8a7993860", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e0ae13896e72fdc6d0cf2a93452ecbb8a7993860"}], "stats": {"total": 53, "additions": 19, "deletions": 34}, "files": [{"sha": "2bb7b53d3ee18d257baac0b1b6391c959449ce75", "filename": "gcc/ChangeLog", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/08f0e79ed931917b74221563e09d85e4804c4293/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/08f0e79ed931917b74221563e09d85e4804c4293/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=08f0e79ed931917b74221563e09d85e4804c4293", "patch": "@@ -1,3 +1,14 @@\n+2007-01-10  Tom Tromey  <tromey@redhat.com>\n+\n+\t* fold-const.c (fold_truthop): Don't check can_use_bit_fields_p.\n+\t(fold_binary): Likewise.\n+\t* langhooks.c (lhd_can_use_bit_fields_p): Removed.\n+\t* langhooks-def.h (lhd_can_use_bit_fields_p): Removed.\n+\t(LANG_HOOKS_CAN_USE_BIT_FIELDS_P): Removed.\n+\t(LANG_HOOKS_INITIALIZER): Remove LANG_HOOKS_CAN_USE_BIT_FIELDS_P.\n+\t* langhooks.h (struct lang_hooks): Removed field\n+\t'can_use_bit_fields_p'.\n+\n 2007-01-10  Ralf Cors\u00e9pius <ralf.corsepius@rtems.org>\n \n \t* config/bfin/t-bfin, config/bfin/t-bfin-elf: Remove GCC_CFLAGS."}, {"sha": "3a3c1f9ce92b0e38704fc11efbf220a7d9395f98", "filename": "gcc/fold-const.c", "status": "modified", "additions": 2, "deletions": 8, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/08f0e79ed931917b74221563e09d85e4804c4293/gcc%2Ffold-const.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/08f0e79ed931917b74221563e09d85e4804c4293/gcc%2Ffold-const.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffold-const.c?ref=08f0e79ed931917b74221563e09d85e4804c4293", "patch": "@@ -1,6 +1,6 @@\n /* Fold a constant sub-tree into a single node for C-compiler\n    Copyright (C) 1987, 1988, 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999,\n-   2000, 2001, 2002, 2003, 2004, 2005, 2006 Free Software Foundation, Inc.\n+   2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007 Free Software Foundation, Inc.\n \n This file is part of GCC.\n \n@@ -5117,11 +5117,6 @@ fold_truthop (enum tree_code code, tree truth_type, tree lhs, tree rhs)\n \treturn 0;\n     }\n \n-  /* After this point all optimizations will generate bit-field\n-     references, which we might not want.  */\n-  if (! lang_hooks.can_use_bit_fields_p ())\n-    return 0;\n-\n   /* See if we can find a mode that contains both fields being compared on\n      the left.  If we can't, fail.  Otherwise, update all constants and masks\n      to be relative to a field of that size.  */\n@@ -10947,8 +10942,7 @@ fold_binary (enum tree_code code, tree type, tree op0, tree op1)\n \t}\n \n       /* If this is a comparison of a field, we may be able to simplify it.  */\n-      if (((TREE_CODE (arg0) == COMPONENT_REF\n-\t    && lang_hooks.can_use_bit_fields_p ())\n+      if ((TREE_CODE (arg0) == COMPONENT_REF\n \t   || TREE_CODE (arg0) == BIT_FIELD_REF)\n \t  /* Handle the constant case even without -O\n \t     to make sure the warnings are given.  */"}, {"sha": "9b28a7249415f469cf1550df190436ccb153890e", "filename": "gcc/java/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/08f0e79ed931917b74221563e09d85e4804c4293/gcc%2Fjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/08f0e79ed931917b74221563e09d85e4804c4293/gcc%2Fjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2FChangeLog?ref=08f0e79ed931917b74221563e09d85e4804c4293", "patch": "@@ -1,3 +1,8 @@\n+2007-01-10  Tom Tromey  <tromey@redhat.com>\n+\n+\t* lang.c (java_can_use_bit_fields_p): Removed.\n+\t(LANG_HOOKS_CAN_USE_BIT_FIELDS_P): Removed.\n+\n 2007-01-09  Andrew Haley  <aph@redhat.com>\n \n \t* expr.c (build_java_arrayaccess): Rewrite to generate array"}, {"sha": "461cdc81eef29110b8064ba95a19705ad88fa9eb", "filename": "gcc/java/lang.c", "status": "modified", "additions": 0, "deletions": 11, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/08f0e79ed931917b74221563e09d85e4804c4293/gcc%2Fjava%2Flang.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/08f0e79ed931917b74221563e09d85e4804c4293/gcc%2Fjava%2Flang.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2Flang.c?ref=08f0e79ed931917b74221563e09d85e4804c4293", "patch": "@@ -60,7 +60,6 @@ static tree java_tree_inlining_walk_subtrees (tree *, int *, walk_tree_fn,\n \t\t\t\t\t      void *, struct pointer_set_t *);\n static int merge_init_test_initialization (void * *, void *);\n static int inline_init_test_initialization (void * *, void *);\n-static bool java_can_use_bit_fields_p (void);\n static bool java_dump_tree (void *, tree);\n static void dump_compound_expr (dump_info_p, tree);\n static bool java_decl_ok_for_sibcall (tree);\n@@ -178,8 +177,6 @@ struct language_function GTY(())\n #define LANG_HOOKS_DECL_PRINTABLE_NAME lang_printable_name\n #undef LANG_HOOKS_PRINT_ERROR_FUNCTION\n #define LANG_HOOKS_PRINT_ERROR_FUNCTION\tjava_print_error_function\n-#undef LANG_HOOKS_CAN_USE_BIT_FIELDS_P\n-#define LANG_HOOKS_CAN_USE_BIT_FIELDS_P java_can_use_bit_fields_p\n \n #undef LANG_HOOKS_TYPE_FOR_MODE\n #define LANG_HOOKS_TYPE_FOR_MODE java_type_for_mode\n@@ -597,14 +594,6 @@ java_init_options (unsigned int argc ATTRIBUTE_UNUSED,\n   return CL_Java;\n }\n \n-static bool\n-java_can_use_bit_fields_p (void)\n-{\n-  /* The bit-field optimizations cause problems when generating class\n-     files.  */\n-  return flag_emit_class_files ? false : true;\n-}\n-\n /* Post-switch processing.  */\n static bool\n java_post_options (const char **pfilename)"}, {"sha": "1165d344fefa3088371da8f36ff52e11ec48732b", "filename": "gcc/langhooks-def.h", "status": "modified", "additions": 1, "deletions": 4, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/08f0e79ed931917b74221563e09d85e4804c4293/gcc%2Flanghooks-def.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/08f0e79ed931917b74221563e09d85e4804c4293/gcc%2Flanghooks-def.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flanghooks-def.h?ref=08f0e79ed931917b74221563e09d85e4804c4293", "patch": "@@ -1,5 +1,5 @@\n /* Default macros to initialize the lang_hooks data structure.\n-   Copyright 2001, 2002, 2003, 2004, 2005, 2006 Free Software Foundation, Inc.\n+   Copyright 2001, 2002, 2003, 2004, 2005, 2006, 2007 Free Software Foundation, Inc.\n    Contributed by Alexandre Oliva  <aoliva@redhat.com>\n \n This file is part of GCC.\n@@ -60,7 +60,6 @@ extern int lhd_expand_decl (tree);\n extern void lhd_print_error_function (struct diagnostic_context *,\n \t\t\t\t      const char *);\n extern void lhd_set_decl_assembler_name (tree);\n-extern bool lhd_can_use_bit_fields_p (void);\n extern bool lhd_warn_unused_global_decl (tree);\n extern void lhd_incomplete_type_error (tree, tree);\n extern tree lhd_type_promotes_to (tree);\n@@ -116,7 +115,6 @@ extern void lhd_omp_firstprivatize_type_sizes (struct gimplify_omp_ctx *,\n #define LANG_HOOKS_STATICP\t\tlhd_staticp\n #define LANG_HOOKS_DUP_LANG_SPECIFIC_DECL lhd_do_nothing_t\n #define LANG_HOOKS_SET_DECL_ASSEMBLER_NAME lhd_set_decl_assembler_name\n-#define LANG_HOOKS_CAN_USE_BIT_FIELDS_P lhd_can_use_bit_fields_p\n #define LANG_HOOKS_REDUCE_BIT_FIELD_OPERATIONS false\n #define LANG_HOOKS_NO_BODY_BLOCKS\tfalse\n #define LANG_HOOKS_PRINT_STATISTICS\tlhd_do_nothing\n@@ -303,7 +301,6 @@ extern tree lhd_make_node (enum tree_code);\n   LANG_HOOKS_STATICP, \\\n   LANG_HOOKS_DUP_LANG_SPECIFIC_DECL, \\\n   LANG_HOOKS_SET_DECL_ASSEMBLER_NAME, \\\n-  LANG_HOOKS_CAN_USE_BIT_FIELDS_P, \\\n   LANG_HOOKS_REDUCE_BIT_FIELD_OPERATIONS, \\\n   LANG_HOOKS_NO_BODY_BLOCKS, \\\n   LANG_HOOKS_PRINT_STATISTICS, \\"}, {"sha": "5145fc33521ffadbf330f1b6907967a1f48af90d", "filename": "gcc/langhooks.c", "status": "modified", "additions": 0, "deletions": 7, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/08f0e79ed931917b74221563e09d85e4804c4293/gcc%2Flanghooks.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/08f0e79ed931917b74221563e09d85e4804c4293/gcc%2Flanghooks.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flanghooks.c?ref=08f0e79ed931917b74221563e09d85e4804c4293", "patch": "@@ -185,13 +185,6 @@ lhd_set_decl_assembler_name (tree decl)\n     }\n }\n \n-/* By default we always allow bit-field based optimizations.  */\n-bool\n-lhd_can_use_bit_fields_p (void)\n-{\n-  return true;\n-}\n-\n /* Type promotion for variable arguments.  */\n tree\n lhd_type_promotes_to (tree ARG_UNUSED (type))"}, {"sha": "db7a35e16a5ced883e48fd72048b27c159507e5d", "filename": "gcc/langhooks.h", "status": "modified", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/08f0e79ed931917b74221563e09d85e4804c4293/gcc%2Flanghooks.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/08f0e79ed931917b74221563e09d85e4804c4293/gcc%2Flanghooks.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flanghooks.h?ref=08f0e79ed931917b74221563e09d85e4804c4293", "patch": "@@ -347,10 +347,6 @@ struct lang_hooks\n      assembler does not talk about it.  */\n   void (*set_decl_assembler_name) (tree);\n \n-  /* Return nonzero if fold-const is free to use bit-field\n-     optimizations, for instance in fold_truthop().  */\n-  bool (*can_use_bit_fields_p) (void);\n-\n   /* Nonzero if operations on types narrower than their mode should\n      have their results reduced to the precision of the type.  */\n   bool reduce_bit_field_operations;"}]}