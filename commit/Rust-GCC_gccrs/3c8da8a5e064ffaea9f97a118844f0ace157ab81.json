{"sha": "3c8da8a5e064ffaea9f97a118844f0ace157ab81", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6M2M4ZGE4YTVlMDY0ZmZhZWE5Zjk3YTExODg0NGYwYWNlMTU3YWI4MQ==", "commit": {"author": {"name": "Alexandre Oliva", "email": "aoliva@redhat.com", "date": "2007-11-26T06:24:54Z"}, "committer": {"name": "Alexandre Oliva", "email": "aoliva@gcc.gnu.org", "date": "2007-11-26T06:24:54Z"}, "message": "tree-ssa-live.c (remove_unused_scope_block_p): Drop declarations and blocks only after inlining.\n\n* tree-ssa-live.c (remove_unused_scope_block_p): Drop\ndeclarations and blocks only after inlining.  Check that\nnon-empty blocks are not dropped.\n* tree-inline.c (expand_call_inline): Check that functions are\nnot inlined too late.\n\nFrom-SVN: r130424", "tree": {"sha": "9f3970e56f7699f3fe29ddd7cc3e98c94ed238ca", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9f3970e56f7699f3fe29ddd7cc3e98c94ed238ca"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3c8da8a5e064ffaea9f97a118844f0ace157ab81", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3c8da8a5e064ffaea9f97a118844f0ace157ab81", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3c8da8a5e064ffaea9f97a118844f0ace157ab81", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3c8da8a5e064ffaea9f97a118844f0ace157ab81/comments", "author": null, "committer": null, "parents": [{"sha": "573b3837c6c60c904934b16dea1c9679005b68f6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/573b3837c6c60c904934b16dea1c9679005b68f6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/573b3837c6c60c904934b16dea1c9679005b68f6"}], "stats": {"total": 26, "additions": 23, "deletions": 3}, "files": [{"sha": "7dac51909addc3b148ef62a1af41235838b0cadd", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3c8da8a5e064ffaea9f97a118844f0ace157ab81/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3c8da8a5e064ffaea9f97a118844f0ace157ab81/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=3c8da8a5e064ffaea9f97a118844f0ace157ab81", "patch": "@@ -1,3 +1,11 @@\n+2007-11-26  Alexandre Oliva  <aoliva@redhat.com>, Jan Hubicka  <jh@suse.cz>\n+\n+\t* tree-ssa-live.c (remove_unused_scope_block_p): Drop\n+\tdeclarations and blocks only after inlining.  Check that\n+\tnon-empty blocks are not dropped.\n+\t* tree-inline.c (expand_call_inline): Check that functions are\n+\tnot inlined too late.\n+\n 2007-11-26  Ben Elliston  <bje@au.ibm.com>\n \n \t* unwind-dw2-fde.c: Fix comment typo."}, {"sha": "e7fba9129ebf7350bbd549cca45c1146b507aa70", "filename": "gcc/tree-inline.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3c8da8a5e064ffaea9f97a118844f0ace157ab81/gcc%2Ftree-inline.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3c8da8a5e064ffaea9f97a118844f0ace157ab81/gcc%2Ftree-inline.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-inline.c?ref=3c8da8a5e064ffaea9f97a118844f0ace157ab81", "patch": "@@ -2652,6 +2652,8 @@ expand_call_inline (basic_block bb, tree stmt, tree *tp, void *data)\n   id->src_cfun = DECL_STRUCT_FUNCTION (fn);\n   id->call_expr = t;\n \n+  gcc_assert (!id->src_cfun->after_inlining);\n+\n   initialize_inlined_parameters (id, t, fn, bb);\n \n   if (DECL_INITIAL (fn))"}, {"sha": "51d682c1c190114d7ace610c7b91120bb5130850", "filename": "gcc/tree-ssa-live.c", "status": "modified", "additions": 13, "deletions": 3, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3c8da8a5e064ffaea9f97a118844f0ace157ab81/gcc%2Ftree-ssa-live.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3c8da8a5e064ffaea9f97a118844f0ace157ab81/gcc%2Ftree-ssa-live.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-live.c?ref=3c8da8a5e064ffaea9f97a118844f0ace157ab81", "patch": "@@ -500,8 +500,15 @@ remove_unused_scope_block_p (tree scope)\n       /* When we are not doing full debug info, we however can keep around\n \t only the used variables for cfgexpand's memory packing saving quite\n \t a lot of memory.  */\n-      else if (debug_info_level != DINFO_LEVEL_NORMAL\n-\t       && debug_info_level != DINFO_LEVEL_VERBOSE)\n+      else if (debug_info_level == DINFO_LEVEL_NORMAL\n+\t       || debug_info_level == DINFO_LEVEL_VERBOSE\n+\t       /* Removing declarations before inlining is going to affect\n+\t\t  DECL_UID that in turn is going to affect hashtables and\n+\t\t  code generation.  */\n+\t       || !cfun->after_inlining)\n+\tunused = false;\n+\n+      else\n \t{\n \t  *t = TREE_CHAIN (*t);\n \t  next = t;\n@@ -523,7 +530,10 @@ remove_unused_scope_block_p (tree scope)\n \t    nsubblocks ++;\n \t  }\n \telse\n-          *t = BLOCK_CHAIN (*t);\n+\t  {\n+\t    gcc_assert (!BLOCK_VARS (*t));\n+\t    *t = BLOCK_CHAIN (*t);\n+\t  }\n       }\n     else\n       {"}]}