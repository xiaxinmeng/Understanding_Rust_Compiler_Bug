{"sha": "885a33e117bf7339ecb1d4f3ef12b817cbead81c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODg1YTMzZTExN2JmNzMzOWVjYjFkNGYzZWYxMmI4MTdjYmVhZDgxYw==", "commit": {"author": {"name": "Richard Sandiford", "email": "richard.sandiford@linaro.org", "date": "2018-01-24T16:22:30Z"}, "committer": {"name": "Richard Sandiford", "email": "rsandifo@gcc.gnu.org", "date": "2018-01-24T16:22:30Z"}, "message": "Fix use of boolean_true/false_node (PR 83979)\n\nr255913 changed some constant_boolean_node calls to boolean_true_node\nand boolean_false_node, which meant that the returned tree didn't\nalways have the right type.\n\n2018-01-24  Richard Sandiford  <richard.sandiford@linaro.org>\n\ngcc/\n\tPR tree-optimization/83979\n\t* fold-const.c (fold_comparison): Use constant_boolean_node\n\tinstead of boolean_{true,false}_node.\n\ngcc/testsuite/\n\tPR tree-optimization/83979\n\t* g++.dg/pr83979.c: New test.\n\nFrom-SVN: r257021", "tree": {"sha": "0fd1c2c6bcb52cf3e1074bed3d06770ca5e11520", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0fd1c2c6bcb52cf3e1074bed3d06770ca5e11520"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/885a33e117bf7339ecb1d4f3ef12b817cbead81c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/885a33e117bf7339ecb1d4f3ef12b817cbead81c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/885a33e117bf7339ecb1d4f3ef12b817cbead81c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/885a33e117bf7339ecb1d4f3ef12b817cbead81c/comments", "author": null, "committer": null, "parents": [{"sha": "35d93d1d8caeddb4d990c8391fff2587bed8a3cd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/35d93d1d8caeddb4d990c8391fff2587bed8a3cd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/35d93d1d8caeddb4d990c8391fff2587bed8a3cd"}], "stats": {"total": 42, "additions": 30, "deletions": 12}, "files": [{"sha": "9c313b367d380b66f0571b20d9b2a17d2e2dc536", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/885a33e117bf7339ecb1d4f3ef12b817cbead81c/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/885a33e117bf7339ecb1d4f3ef12b817cbead81c/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=885a33e117bf7339ecb1d4f3ef12b817cbead81c", "patch": "@@ -1,3 +1,9 @@\n+2018-01-24  Richard Sandiford  <richard.sandiford@linaro.org>\n+\n+\tPR tree-optimization/83979\n+\t* fold-const.c (fold_comparison): Use constant_boolean_node\n+\tinstead of boolean_{true,false}_node.\n+\n 2018-01-24  Jan Hubicka  <hubicka@ucw.cz>\n \n \t* ipa-profile.c (ipa_propagate_frequency_1): Fix logic skipping calls"}, {"sha": "744c3552ead8d1f9a912dcc42ef2bbf4ad0303ab", "filename": "gcc/fold-const.c", "status": "modified", "additions": 12, "deletions": 12, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/885a33e117bf7339ecb1d4f3ef12b817cbead81c/gcc%2Ffold-const.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/885a33e117bf7339ecb1d4f3ef12b817cbead81c/gcc%2Ffold-const.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffold-const.c?ref=885a33e117bf7339ecb1d4f3ef12b817cbead81c", "patch": "@@ -8572,39 +8572,39 @@ fold_comparison (location_t loc, enum tree_code code, tree type,\n \t\t{\n \t\tcase EQ_EXPR:\n \t\t  if (known_eq (bitpos0, bitpos1))\n-\t\t    return boolean_true_node;\n+\t\t    return constant_boolean_node (true, type);\n \t\t  if (known_ne (bitpos0, bitpos1))\n-\t\t    return boolean_false_node;\n+\t\t    return constant_boolean_node (false, type);\n \t\t  break;\n \t\tcase NE_EXPR:\n \t\t  if (known_ne (bitpos0, bitpos1))\n-\t\t    return boolean_true_node;\n+\t\t    return constant_boolean_node (true, type);\n \t\t  if (known_eq (bitpos0, bitpos1))\n-\t\t    return boolean_false_node;\n+\t\t    return constant_boolean_node (false, type);\n \t\t  break;\n \t\tcase LT_EXPR:\n \t\t  if (known_lt (bitpos0, bitpos1))\n-\t\t    return boolean_true_node;\n+\t\t    return constant_boolean_node (true, type);\n \t\t  if (known_ge (bitpos0, bitpos1))\n-\t\t    return boolean_false_node;\n+\t\t    return constant_boolean_node (false, type);\n \t\t  break;\n \t\tcase LE_EXPR:\n \t\t  if (known_le (bitpos0, bitpos1))\n-\t\t    return boolean_true_node;\n+\t\t    return constant_boolean_node (true, type);\n \t\t  if (known_gt (bitpos0, bitpos1))\n-\t\t    return boolean_false_node;\n+\t\t    return constant_boolean_node (false, type);\n \t\t  break;\n \t\tcase GE_EXPR:\n \t\t  if (known_ge (bitpos0, bitpos1))\n-\t\t    return boolean_true_node;\n+\t\t    return constant_boolean_node (true, type);\n \t\t  if (known_lt (bitpos0, bitpos1))\n-\t\t    return boolean_false_node;\n+\t\t    return constant_boolean_node (false, type);\n \t\t  break;\n \t\tcase GT_EXPR:\n \t\t  if (known_gt (bitpos0, bitpos1))\n-\t\t    return boolean_true_node;\n+\t\t    return constant_boolean_node (true, type);\n \t\t  if (known_le (bitpos0, bitpos1))\n-\t\t    return boolean_false_node;\n+\t\t    return constant_boolean_node (false, type);\n \t\t  break;\n \t\tdefault:;\n \t\t}"}, {"sha": "b5ecce013581f1ba563dc24ec97068fc79db2229", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/885a33e117bf7339ecb1d4f3ef12b817cbead81c/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/885a33e117bf7339ecb1d4f3ef12b817cbead81c/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=885a33e117bf7339ecb1d4f3ef12b817cbead81c", "patch": "@@ -1,3 +1,8 @@\n+2018-01-24  Richard Sandiford  <richard.sandiford@linaro.org>\n+\n+\tPR tree-optimization/83979\n+\t* g++.dg/pr83979.c: New test.\n+\n 2018-01-24  Kyrylo Tkachov  <kyrylo.tkachov@arm.com>\n \n \t* gcc.dg/lto/20110201-1_0.c: Remove explicit -mfloat-abi=softfp"}, {"sha": "a39b1ea6ab9b53b989948feda7bccbd4745d9df7", "filename": "gcc/testsuite/g++.dg/pr83979.c", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/885a33e117bf7339ecb1d4f3ef12b817cbead81c/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fpr83979.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/885a33e117bf7339ecb1d4f3ef12b817cbead81c/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fpr83979.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fpr83979.c?ref=885a33e117bf7339ecb1d4f3ef12b817cbead81c", "patch": "@@ -0,0 +1,7 @@\n+/* { dg-compile } */\n+\n+int\n+foo (char* p)\n+{\n+  return p + 1000 < p;\n+}"}]}