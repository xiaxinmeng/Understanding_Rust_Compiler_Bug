{"sha": "82a197a2bb8198cc98bcd10c76be89dcfb3cdf9c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODJhMTk3YTJiYjgxOThjYzk4YmNkMTBjNzZiZTg5ZGNmYjNjZGY5Yw==", "commit": {"author": {"name": "Zhenqiang Chen", "email": "zhenqiang.chen@arm.com", "date": "2014-01-17T05:43:45Z"}, "committer": {"name": "Zhenqiang Chen", "email": "zqchen@gcc.gnu.org", "date": "2014-01-17T05:43:45Z"}, "message": "arm.c (arm_v7m_tune): Set max_insns_skipped to 2.\n\nChangeLog:\n2014-01-17  Zhenqiang Chen  <zhenqiang.chen@arm.com>\n\n\t* config/arm/arm.c (arm_v7m_tune): Set max_insns_skipped to 2.\n\t(thumb2_final_prescan_insn): Set max to MAX_INSN_PER_IT_BLOCK.\n\ntestsuite/ChangeLog:\n2014-01-17  Zhenqiang Chen  <zhenqiang.chen@arm.com>\n\n\t* gcc.target/arm/its.c: New test.\n\nFrom-SVN: r206698", "tree": {"sha": "87e0489792b512de3446da55341db20c394cb506", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/87e0489792b512de3446da55341db20c394cb506"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/82a197a2bb8198cc98bcd10c76be89dcfb3cdf9c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/82a197a2bb8198cc98bcd10c76be89dcfb3cdf9c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/82a197a2bb8198cc98bcd10c76be89dcfb3cdf9c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/82a197a2bb8198cc98bcd10c76be89dcfb3cdf9c/comments", "author": null, "committer": null, "parents": [{"sha": "c68b3f5291b6588570760d247a3f5223cb087915", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c68b3f5291b6588570760d247a3f5223cb087915", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c68b3f5291b6588570760d247a3f5223cb087915"}], "stats": {"total": 41, "additions": 35, "deletions": 6}, "files": [{"sha": "eaa192715b145f9c3263875ada1b6e5ffac98263", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/82a197a2bb8198cc98bcd10c76be89dcfb3cdf9c/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/82a197a2bb8198cc98bcd10c76be89dcfb3cdf9c/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=82a197a2bb8198cc98bcd10c76be89dcfb3cdf9c", "patch": "@@ -1,3 +1,8 @@\n+2014-01-17  Zhenqiang Chen  <zhenqiang.chen@arm.com>\n+\n+\t* config/arm/arm.c (arm_v7m_tune): Set max_insns_skipped to 2.\n+\t(thumb2_final_prescan_insn): Set max to MAX_INSN_PER_IT_BLOCK.\n+\n 2014-01-16  Ilya Enkovich  <ilya.enkovich@intel.com>\n \n \t* ipa-ref.c (ipa_remove_stmt_references): Fix references"}, {"sha": "fc81bf684072252cecece6c12cf0240d20e7d000", "filename": "gcc/config/arm/arm.c", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/82a197a2bb8198cc98bcd10c76be89dcfb3cdf9c/gcc%2Fconfig%2Farm%2Farm.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/82a197a2bb8198cc98bcd10c76be89dcfb3cdf9c/gcc%2Fconfig%2Farm%2Farm.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Farm.c?ref=82a197a2bb8198cc98bcd10c76be89dcfb3cdf9c", "patch": "@@ -1696,7 +1696,7 @@ const struct tune_params arm_v7m_tune =\n   &v7m_extra_costs,\n   NULL,\t\t\t\t\t\t/* Sched adj cost.  */\n   1,\t\t\t\t\t\t/* Constant limit.  */\n-  5,\t\t\t\t\t\t/* Max cond insns.  */\n+  2,\t\t\t\t\t\t/* Max cond insns.  */\n   ARM_PREFETCH_NOT_BENEFICIAL,\n   true,\t\t\t\t\t\t/* Prefer constant pool.  */\n   arm_cortex_m_branch_cost,\n@@ -22138,11 +22138,11 @@ thumb2_final_prescan_insn (rtx insn)\n   int mask;\n   int max;\n \n-  /* Maximum number of conditionally executed instructions in a block\n-     is minimum of the two max values: maximum allowed in an IT block\n-     and maximum that is beneficial according to the cost model and tune.  */\n-  max = (max_insns_skipped < MAX_INSN_PER_IT_BLOCK) ?\n-    max_insns_skipped : MAX_INSN_PER_IT_BLOCK;\n+  /* max_insns_skipped in the tune was already taken into account in the\n+     cost model of ifcvt pass when generating COND_EXEC insns.  At this stage\n+     just emit the IT blocks as we can.  It does not make sense to split\n+     the IT blocks.  */\n+  max = MAX_INSN_PER_IT_BLOCK;\n \n   /* Remove the previous insn from the count of insns to be output.  */\n   if (arm_condexec_count)"}, {"sha": "665d9034d276e98a260e12d51b9ecf664e0677f4", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/82a197a2bb8198cc98bcd10c76be89dcfb3cdf9c/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/82a197a2bb8198cc98bcd10c76be89dcfb3cdf9c/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=82a197a2bb8198cc98bcd10c76be89dcfb3cdf9c", "patch": "@@ -1,3 +1,7 @@\n+2014-01-17  Zhenqiang Chen  <zhenqiang.chen@arm.com>\n+\n+\t* gcc.target/arm/its.c: New testcase.\n+\n 2014-01-16  Jan Hubicka  <jh@suse.cz>\n \n \tPR ipa/59775"}, {"sha": "5425f1e920592c911771d93a4620448b06d51394", "filename": "gcc/testsuite/gcc.target/arm/its.c", "status": "added", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/82a197a2bb8198cc98bcd10c76be89dcfb3cdf9c/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fits.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/82a197a2bb8198cc98bcd10c76be89dcfb3cdf9c/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fits.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fits.c?ref=82a197a2bb8198cc98bcd10c76be89dcfb3cdf9c", "patch": "@@ -0,0 +1,20 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O2\" }  */\n+int test (int a, int b)\n+{\n+  int r;\n+  if (a > 10)\n+    {\n+      r = a - b;\n+      r += 10;\n+    }\n+  else\n+    {\n+      r = b - a;\n+      r -= 7;\n+    }\n+  if (r > 0)\n+    r -= 3;\n+  return r;\n+}\n+/* { dg-final { scan-assembler-times \"\\tit\" 2 { target arm_thumb2 } } } */"}]}