{"sha": "44d5230cc3b623e04e46b2674fbf971743e55057", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDRkNTIzMGNjM2I2MjNlMDRlNDZiMjY3NGZiZjk3MTc0M2U1NTA1Nw==", "commit": {"author": {"name": "Paolo Carlini", "email": "pcarlini@suse.de", "date": "2007-08-28T08:48:24Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2007-08-28T08:48:24Z"}, "message": "re PR libstdc++/33128 (std::tr1::uniform_int returns value out of range)\n\n2007-08-28  Paolo Carlini  <pcarlini@suse.de>\n\n\tPR libstdc++/33128\n\t* include/tr1_impl/random (uniform_int<>::_M_call): Deal with\n\t__urng() returning negative values.\n\t* testsuite/tr1/5_numerical_facilities/random/uniform_int/33128.cc:\n\tNew.\n\nFrom-SVN: r127849", "tree": {"sha": "fdfa7bcdbb3cead5bed742d58588e1c4618fc51b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/fdfa7bcdbb3cead5bed742d58588e1c4618fc51b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/44d5230cc3b623e04e46b2674fbf971743e55057", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/44d5230cc3b623e04e46b2674fbf971743e55057", "html_url": "https://github.com/Rust-GCC/gccrs/commit/44d5230cc3b623e04e46b2674fbf971743e55057", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/44d5230cc3b623e04e46b2674fbf971743e55057/comments", "author": null, "committer": null, "parents": [{"sha": "46dc0789fed233da1561e6c2ee1a4a7ab82e9fd4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/46dc0789fed233da1561e6c2ee1a4a7ab82e9fd4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/46dc0789fed233da1561e6c2ee1a4a7ab82e9fd4"}], "stats": {"total": 57, "additions": 56, "deletions": 1}, "files": [{"sha": "b41548f2f4dfef1d26af6cb0a7b6969c9ec2eea9", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/44d5230cc3b623e04e46b2674fbf971743e55057/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/44d5230cc3b623e04e46b2674fbf971743e55057/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=44d5230cc3b623e04e46b2674fbf971743e55057", "patch": "@@ -1,3 +1,11 @@\n+2007-08-28  Paolo Carlini  <pcarlini@suse.de>\n+\n+\tPR libstdc++/33128\n+\t* include/tr1_impl/random (uniform_int<>::_M_call): Deal with\n+\t__urng() returning negative values.\n+\t* testsuite/tr1/5_numerical_facilities/random/uniform_int/33128.cc:\n+\tNew.\n+\n 2007-08-24  Benjamin Kosnik  <bkoz@redhat.com>\n \n \t* acinclude.m4: Fix duplicate variable names."}, {"sha": "e855307dace7b180905bcd785bd079fdf5591396", "filename": "libstdc++-v3/include/tr1_impl/random", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/44d5230cc3b623e04e46b2674fbf971743e55057/libstdc%2B%2B-v3%2Finclude%2Ftr1_impl%2Frandom", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/44d5230cc3b623e04e46b2674fbf971743e55057/libstdc%2B%2B-v3%2Finclude%2Ftr1_impl%2Frandom", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Ftr1_impl%2Frandom?ref=44d5230cc3b623e04e46b2674fbf971743e55057", "patch": "@@ -1604,7 +1604,11 @@ _GLIBCXX_BEGIN_NAMESPACE_TR1\n         result_type\n         _M_call(_UniformRandomNumberGenerator& __urng,\n \t\tresult_type __min, result_type __max, true_type)\n-        { return result_type(__urng() % (__max - __min + 1)) + __min; }\n+        {\n+\t  typedef typename __gnu_cxx::__add_unsigned<typename\n+\t    _UniformRandomNumberGenerator::result_type>::__type __utype;\n+\t  return result_type(__utype(__urng()) % (__max - __min + 1)) + __min; \n+\t}\n \n       template<typename _UniformRandomNumberGenerator>\n         result_type"}, {"sha": "bf10eddbf7d69534ebc6917673d2bce6a9eda853", "filename": "libstdc++-v3/testsuite/tr1/5_numerical_facilities/random/uniform_int/33128.cc", "status": "added", "additions": 43, "deletions": 0, "changes": 43, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/44d5230cc3b623e04e46b2674fbf971743e55057/libstdc%2B%2B-v3%2Ftestsuite%2Ftr1%2F5_numerical_facilities%2Frandom%2Funiform_int%2F33128.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/44d5230cc3b623e04e46b2674fbf971743e55057/libstdc%2B%2B-v3%2Ftestsuite%2Ftr1%2F5_numerical_facilities%2Frandom%2Funiform_int%2F33128.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2Ftr1%2F5_numerical_facilities%2Frandom%2Funiform_int%2F33128.cc?ref=44d5230cc3b623e04e46b2674fbf971743e55057", "patch": "@@ -0,0 +1,43 @@\n+// Copyright (C) 2007 Free Software Foundation, Inc.\n+//\n+// This file is part of the GNU ISO C++ Library.  This library is free\n+// software; you can redistribute it and/or modify it under the\n+// terms of the GNU General Public License as published by the\n+// Free Software Foundation; either version 2, or (at your option)\n+// any later version.\n+//\n+// This library is distributed in the hope that it will be useful,\n+// but WITHOUT ANY WARRANTY; without even the implied warranty of\n+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+// GNU General Public License for more details.\n+//\n+// You should have received a copy of the GNU General Public License along\n+// with this library; see the file COPYING.  If not, write to the Free\n+// Software Foundation, 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301,\n+// USA.\n+\n+// 5.1.7.1 Class template uniform_int\n+// 5.1.1 [7] Table 17\n+\n+#include <tr1/random>\n+#include <testsuite_hooks.h>\n+\n+// libstdc++/33128\n+int test01()\n+{\n+  bool test __attribute__((unused)) = true;\n+\n+  std::tr1::mt19937 rng;\n+  std::tr1::uniform_int<> six(1,6);\n+  std::tr1::variate_generator<std::tr1::mt19937, std::tr1::uniform_int<> >\n+            die(rng, six);\n+\n+  int val = die();\n+  VERIFY( val >= 1 && val <= 6 );\n+}\n+\n+int main()\n+{\n+  test01();\n+  return 0;\n+}"}]}