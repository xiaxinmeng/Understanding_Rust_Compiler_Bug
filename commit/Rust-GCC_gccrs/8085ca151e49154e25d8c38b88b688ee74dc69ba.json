{"sha": "8085ca151e49154e25d8c38b88b688ee74dc69ba", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODA4NWNhMTUxZTQ5MTU0ZTI1ZDhjMzhiODhiNjg4ZWU3NGRjNjliYQ==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2007-12-17T14:16:42Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2007-12-17T14:16:42Z"}, "message": "re PR c/34506 (gcc disallows comma between C/C++ OpenMP clauses)\n\n\tPR c/34506\n\t* c-parser.c (c_parser_omp_all_clauses): Accept optional comma\n\tin between clauses.\n\n\t* parser.c (cp_parser_omp_all_clauses): Accept optional comma\n\tin between clauses.\n\n\t* gcc.dg/gomp/clause-2.c: New test.\n\t* g++.dg/gomp/clause-4.C: New test.\n\nFrom-SVN: r131008", "tree": {"sha": "0c1892c61bffadc9f08eb2066cb7ca1d4438cae2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0c1892c61bffadc9f08eb2066cb7ca1d4438cae2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8085ca151e49154e25d8c38b88b688ee74dc69ba", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8085ca151e49154e25d8c38b88b688ee74dc69ba", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8085ca151e49154e25d8c38b88b688ee74dc69ba", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8085ca151e49154e25d8c38b88b688ee74dc69ba/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "7f59aaba14dbcbd17ed63e0828d66742b61a5466", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7f59aaba14dbcbd17ed63e0828d66742b61a5466", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7f59aaba14dbcbd17ed63e0828d66742b61a5466"}], "stats": {"total": 85, "additions": 82, "deletions": 3}, "files": [{"sha": "1cc7ca2c0b6b10d3c66df75abb4378ab3b0fd267", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8085ca151e49154e25d8c38b88b688ee74dc69ba/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8085ca151e49154e25d8c38b88b688ee74dc69ba/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=8085ca151e49154e25d8c38b88b688ee74dc69ba", "patch": "@@ -1,3 +1,9 @@\n+2007-12-17  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR c/34506\n+\t* c-parser.c (c_parser_omp_all_clauses): Accept optional comma\n+\tin between clauses.\n+\n 2007-12-17  Dorit Nuzman  <dorit@il.ibm.com>\n \n \tPR tree-optimization/34445"}, {"sha": "107b114d4695cdb0e5e7479c553b91f6c1227c94", "filename": "gcc/c-parser.c", "status": "modified", "additions": 10, "deletions": 2, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8085ca151e49154e25d8c38b88b688ee74dc69ba/gcc%2Fc-parser.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8085ca151e49154e25d8c38b88b688ee74dc69ba/gcc%2Fc-parser.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-parser.c?ref=8085ca151e49154e25d8c38b88b688ee74dc69ba", "patch": "@@ -7262,14 +7262,22 @@ c_parser_omp_all_clauses (c_parser *parser, unsigned int mask,\n \t\t\t  const char *where)\n {\n   tree clauses = NULL;\n+  bool first = true;\n \n   while (c_parser_next_token_is_not (parser, CPP_PRAGMA_EOL))\n     {\n-      location_t here = c_parser_peek_token (parser)->location;\n-      const pragma_omp_clause c_kind = c_parser_omp_clause_name (parser);\n+      location_t here;\n+      pragma_omp_clause c_kind;\n       const char *c_name;\n       tree prev = clauses;\n \n+      if (!first && c_parser_next_token_is (parser, CPP_COMMA))\n+\tc_parser_consume_token (parser);\n+\n+      first = false;\n+      here = c_parser_peek_token (parser)->location;\n+      c_kind = c_parser_omp_clause_name (parser);\n+\n       switch (c_kind)\n \t{\n \tcase PRAGMA_OMP_CLAUSE_COPYIN:"}, {"sha": "e4c2244615088ece0684aa5dcd563381891bf505", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8085ca151e49154e25d8c38b88b688ee74dc69ba/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8085ca151e49154e25d8c38b88b688ee74dc69ba/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=8085ca151e49154e25d8c38b88b688ee74dc69ba", "patch": "@@ -1,3 +1,9 @@\n+2007-12-17  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR c/34506\n+\t* parser.c (cp_parser_omp_all_clauses): Accept optional comma\n+\tin between clauses.\n+\n 2007-12-15  Alexandre Oliva  <aoliva@redhat.com>\n \n \tPR debug/7081"}, {"sha": "f3d4ce207e623a5085d89b8b9bac4ae9c96675cf", "filename": "gcc/cp/parser.c", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8085ca151e49154e25d8c38b88b688ee74dc69ba/gcc%2Fcp%2Fparser.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8085ca151e49154e25d8c38b88b688ee74dc69ba/gcc%2Fcp%2Fparser.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fparser.c?ref=8085ca151e49154e25d8c38b88b688ee74dc69ba", "patch": "@@ -19671,13 +19671,20 @@ cp_parser_omp_all_clauses (cp_parser *parser, unsigned int mask,\n \t\t\t   const char *where, cp_token *pragma_tok)\n {\n   tree clauses = NULL;\n+  bool first = true;\n \n   while (cp_lexer_next_token_is_not (parser->lexer, CPP_PRAGMA_EOL))\n     {\n-      pragma_omp_clause c_kind = cp_parser_omp_clause_name (parser);\n+      pragma_omp_clause c_kind;\n       const char *c_name;\n       tree prev = clauses;\n \n+      if (!first && cp_lexer_next_token_is (parser->lexer, CPP_COMMA))\n+\tcp_lexer_consume_token (parser->lexer);\n+\n+      c_kind = cp_parser_omp_clause_name (parser);\n+      first = false;\n+\n       switch (c_kind)\n \t{\n \tcase PRAGMA_OMP_CLAUSE_COPYIN:"}, {"sha": "81f351621343b15d8ca9015f157e52b31b3e7e16", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8085ca151e49154e25d8c38b88b688ee74dc69ba/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8085ca151e49154e25d8c38b88b688ee74dc69ba/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=8085ca151e49154e25d8c38b88b688ee74dc69ba", "patch": "@@ -1,3 +1,9 @@\n+2007-12-17  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR c/34506\n+\t* gcc.dg/gomp/clause-2.c: New test.\n+\t* g++.dg/gomp/clause-4.C: New test.\n+\n 2007-12-17  Tobias Burnus  <burnus@net-b.de>\n \n \t* gfortran.dg/initialization_16.f90: Update as FLOAT/SNGL are"}, {"sha": "06b91e8a28d3973a7d2b45eae7d96c28f73a30b6", "filename": "gcc/testsuite/g++.dg/gomp/clause-4.C", "status": "added", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8085ca151e49154e25d8c38b88b688ee74dc69ba/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fgomp%2Fclause-4.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8085ca151e49154e25d8c38b88b688ee74dc69ba/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fgomp%2Fclause-4.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fgomp%2Fclause-4.C?ref=8085ca151e49154e25d8c38b88b688ee74dc69ba", "patch": "@@ -0,0 +1,23 @@\n+// PR c/34506\n+// { dg-do compile }\n+\n+#define p parallel\n+\n+void\n+foo (int x)\n+{\n+#pragma omp p num_threads (4) if (1) private (x)\n+    ;\n+#pragma omp p num_threads(4)if(1)private(x)\n+    ;\n+#pragma omp p num_threads (4), if (1) , private (x)\n+    ;\n+#pragma omp p num_threads(4),if(1),private(x)\n+    ;\n+#pragma omp p, num_threads (4), if (1), private (x)\t// { dg-error \"clause before\" }\n+    ;\n+#pragma omp p num_threads (4), if (1), private (x),\t// { dg-error \"clause before\" }\n+    ;\n+#pragma omp p num_threads (4), , if (1), private (x)\t// { dg-error \"clause before\" }\n+    ;\n+}"}, {"sha": "4b12fc8f0c0b3bbdee13a61960b9f1726ccadfbd", "filename": "gcc/testsuite/gcc.dg/gomp/clause-2.c", "status": "added", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8085ca151e49154e25d8c38b88b688ee74dc69ba/gcc%2Ftestsuite%2Fgcc.dg%2Fgomp%2Fclause-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8085ca151e49154e25d8c38b88b688ee74dc69ba/gcc%2Ftestsuite%2Fgcc.dg%2Fgomp%2Fclause-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fgomp%2Fclause-2.c?ref=8085ca151e49154e25d8c38b88b688ee74dc69ba", "patch": "@@ -0,0 +1,23 @@\n+/* PR c/34506 */\n+/* { dg-do compile } */\n+\n+#define p parallel\n+\n+void\n+foo (int x)\n+{\n+#pragma omp p num_threads (4) if (1) private (x)\n+    ;\n+#pragma omp p num_threads(4)if(1)private(x)\n+    ;\n+#pragma omp p num_threads (4), if (1) , private (x)\n+    ;\n+#pragma omp p num_threads(4),if(1),private(x)\n+    ;\n+#pragma omp p, num_threads (4), if (1), private (x)\t/* { dg-error \"clause before\" } */\n+    ;\n+#pragma omp p num_threads (4), if (1), private (x),\t/* { dg-error \"clause before\" } */\n+    ;\n+#pragma omp p num_threads (4), , if (1), private (x)\t/* { dg-error \"clause before\" } */\n+    ;\n+}"}]}