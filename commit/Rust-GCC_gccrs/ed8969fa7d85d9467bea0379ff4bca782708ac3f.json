{"sha": "ed8969fa7d85d9467bea0379ff4bca782708ac3f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWQ4OTY5ZmE3ZDg1ZDk0NjdiZWEwMzc5ZmY0YmNhNzgyNzA4YWMzZg==", "commit": {"author": {"name": "Jim Wilson", "email": "wilson@gcc.gnu.org", "date": "1994-03-18T23:43:00Z"}, "committer": {"name": "Jim Wilson", "email": "wilson@gcc.gnu.org", "date": "1994-03-18T23:43:00Z"}, "message": "(SELECT_SECTION): Variables go in readonly data\nonly if the initializer is constant.\n\nFrom-SVN: r6820", "tree": {"sha": "f0a28f279a86dda097db4b1543ece6ced2c93aa7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f0a28f279a86dda097db4b1543ece6ced2c93aa7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ed8969fa7d85d9467bea0379ff4bca782708ac3f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ed8969fa7d85d9467bea0379ff4bca782708ac3f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ed8969fa7d85d9467bea0379ff4bca782708ac3f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ed8969fa7d85d9467bea0379ff4bca782708ac3f/comments", "author": null, "committer": null, "parents": [{"sha": "07aeab22c0aa102a34c5fdd1b435964135271618", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/07aeab22c0aa102a34c5fdd1b435964135271618", "html_url": "https://github.com/Rust-GCC/gccrs/commit/07aeab22c0aa102a34c5fdd1b435964135271618"}], "stats": {"total": 70, "additions": 52, "deletions": 18}, "files": [{"sha": "14f4b95f661b1f6727e4e43bd28f88a99db97969", "filename": "gcc/config/i386/osfrose.h", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ed8969fa7d85d9467bea0379ff4bca782708ac3f/gcc%2Fconfig%2Fi386%2Fosfrose.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ed8969fa7d85d9467bea0379ff4bca782708ac3f/gcc%2Fconfig%2Fi386%2Fosfrose.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fosfrose.h?ref=ed8969fa7d85d9467bea0379ff4bca782708ac3f", "patch": "@@ -707,7 +707,10 @@ while (0)\n   else if (TREE_CODE (DECL) != VAR_DECL)\t\t\t\t\\\n     readonly_data_section ();\t\t\t\t\t\t\\\n \t\t\t\t\t\t\t\t\t\\\n-  else if (!TREE_READONLY (DECL))\t\t\t\t\t\\\n+  else if (!TREE_READONLY (DECL) || TREE_SIDE_EFFECTS (DECL)\t\t\\\n+\t   || !DECL_INITIAL (DECL)\t\t\t\t\t\\\n+\t   || (DECL_INITIAL (DECL) != error_mark_node\t\t\t\\\n+\t       && !TREE_CONSTANT (DECL_INITIAL (DECL))))\t\t\\\n     data_section ();\t\t\t\t\t\t\t\\\n \t\t\t\t\t\t\t\t\t\\\n   else\t\t\t\t\t\t\t\t\t\\"}, {"sha": "cafbdd56a4fb390631cdcb6e162887012e5cde23", "filename": "gcc/config/i386/svr3gas.h", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ed8969fa7d85d9467bea0379ff4bca782708ac3f/gcc%2Fconfig%2Fi386%2Fsvr3gas.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ed8969fa7d85d9467bea0379ff4bca782708ac3f/gcc%2Fconfig%2Fi386%2Fsvr3gas.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fsvr3gas.h?ref=ed8969fa7d85d9467bea0379ff4bca782708ac3f", "patch": "@@ -255,7 +255,10 @@ dtors_section ()\t\t\t\t\t\t\t\\\n   else if (TREE_CODE (DECL) == VAR_DECL)\t\t\t\t\\\n     {\t\t\t\t\t\t\t\t\t\\\n       if ((0 && RELOC)\t/* should be (flag_pic && RELOC) */\t\t\\\n-\t  || !TREE_READONLY (DECL) || TREE_SIDE_EFFECTS (DECL))\t\t\\\n+\t  || !TREE_READONLY (DECL) || TREE_SIDE_EFFECTS (DECL)\t\t\\\n+\t  || !DECL_INITIAL (DECL)\t\t\t\t\t\\\n+\t  || (DECL_INITIAL (DECL) != error_mark_node \t\t\t\\\n+\t      && !TREE_CONSTANT (DECL_INITIAL (DECL))))\t\t\t\\\n \tdata_section ();\t\t\t\t\t\t\\\n       else\t\t\t\t\t\t\t\t\\\n \tconst_section ();\t\t\t\t\t\t\\"}, {"sha": "6c41e4e3ffccb8cc3657a7a4c07eb7ca9b7dea70", "filename": "gcc/config/m88k/m88k.h", "status": "modified", "additions": 6, "deletions": 3, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ed8969fa7d85d9467bea0379ff4bca782708ac3f/gcc%2Fconfig%2Fm88k%2Fm88k.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ed8969fa7d85d9467bea0379ff4bca782708ac3f/gcc%2Fconfig%2Fm88k%2Fm88k.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fm88k%2Fm88k.h?ref=ed8969fa7d85d9467bea0379ff4bca782708ac3f", "patch": "@@ -197,13 +197,13 @@ extern char * reg_names[];\n    Redefined in sysv4.h, and luna.h.  */\n #define VERSION_INFO1\t\"88open OCS/BCS, \"\n #ifndef VERSION_INFO2\n-#define VERSION_INFO2   \"$Revision: 1.57 $\"\n+#define VERSION_INFO2   \"$Revision: 1.58 $\"\n #endif\n \n #ifndef VERSION_STRING\n #define VERSION_STRING  version_string\n #ifdef __STDC__\n-#define TM_RCS_ID      \"@(#)\" __FILE__ \" $Revision: 1.57 $ \" __DATE__\n+#define TM_RCS_ID      \"@(#)\" __FILE__ \" $Revision: 1.58 $ \" __DATE__\n #else\n #define TM_RCS_ID      \"$What$\"\n #endif  /* __STDC__ */\n@@ -2552,7 +2552,10 @@ sdata_section ()\t\t\t\t\t\t\t\\\n       if (SYMBOL_REF_FLAG (XEXP (DECL_RTL (DECL), 0)))\t\t\t\\\n \tsdata_section ();\t\t\t\t\t\t\\\n       else if ((flag_pic && RELOC)\t\t\t\t\t\\\n-\t  || !TREE_READONLY (DECL) || TREE_SIDE_EFFECTS (DECL))\t\t\\\n+\t       || !TREE_READONLY (DECL) || TREE_SIDE_EFFECTS (DECL)\t\\\n+\t       || !DECL_INITIAL (DECL)\t\t\t\t\t\\\n+\t       || (DECL_INITIAL (DECL) != error_mark_node\t\t\\\n+\t\t   && !TREE_CONSTANT (DECL_INITIAL (DECL))))\t\t\\\n \tdata_section ();\t\t\t\t\t\t\\\n       else\t\t\t\t\t\t\t\t\\\n \tconst_section ();\t\t\t\t\t\t\\"}, {"sha": "bb20567bc2a6aac75954f5eefb4a9689839a4fc6", "filename": "gcc/config/mips/mips.h", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ed8969fa7d85d9467bea0379ff4bca782708ac3f/gcc%2Fconfig%2Fmips%2Fmips.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ed8969fa7d85d9467bea0379ff4bca782708ac3f/gcc%2Fconfig%2Fmips%2Fmips.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.h?ref=ed8969fa7d85d9467bea0379ff4bca782708ac3f", "patch": "@@ -3528,7 +3528,10 @@ rdata_section ()\t\t\t\t\t\t\t\\\n   else if (TREE_CODE (DECL) != VAR_DECL)\t\t\t\t\\\n     rdata_section ();\t\t\t\t\t\t\t\\\n \t\t\t\t\t\t\t\t\t\\\n-  else if (!TREE_READONLY (DECL))\t\t\t\t\t\\\n+  else if (!TREE_READONLY (DECL) || TREE_SIDE_EFFECTS (DECL)\t\t\\\n+\t   || !DECL_INITIAL (DECL)\t\t\t\t\t\\\n+\t   || (DECL_INITIAL (DECL) != error_mark_node\t\t\t\\\n+\t       && !TREE_CONSTANT (DECL_INITIAL (DECL))))\t\t\\\n     data_section ();\t\t\t\t\t\t\t\\\n \t\t\t\t\t\t\t\t\t\\\n   else\t\t\t\t\t\t\t\t\t\\"}, {"sha": "d6e7003cfe8942047b30f4874cbb091f11ea64f2", "filename": "gcc/config/nextstep.h", "status": "modified", "additions": 12, "deletions": 4, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ed8969fa7d85d9467bea0379ff4bca782708ac3f/gcc%2Fconfig%2Fnextstep.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ed8969fa7d85d9467bea0379ff4bca782708ac3f/gcc%2Fconfig%2Fnextstep.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fnextstep.h?ref=ed8969fa7d85d9467bea0379ff4bca782708ac3f", "patch": "@@ -536,11 +536,19 @@ objc_section_init ()\t\t\t\t\\\n \t  else\t\t\t\t\t\t\t\t\\\n \t    data_section ();\t\t\t\t\t\t\\\n \t}\t\t\t\t\t\t\t\t\\\n-      else if ((TREE_READONLY (exp) || TREE_CONSTANT (exp))\t\\\n-\t       && !TREE_SIDE_EFFECTS (exp))\t\t\t\t\\\n-\treadonly_data_section ();\t\t\t\t\t\\\n+      else if (TREE_CODE (DECL) == VAR_DECL)\t\t\t\t\\\n+\t{\t\t\t\t\t\t\t\t\\\n+\t  if ((flag_pic && RELOC)\t\t\t\t\t\\\n+\t      || !TREE_READONLY (DECL) || TREE_SIDE_EFFECTS (DECL)\t\\\n+\t      || !DECL_INITIAL (DECL)\t\t\t\t\t\\\n+\t      || (DECL_INITIAL (DECL) != error_mark_node\t\t\\\n+\t\t  && !TREE_CONSTANT (DECL_INITIAL (DECL))))\t\t\\\n+\t    data_section ();\t\t\t\t\t\t\\\n+\t  else\t\t\t\t\t\t\t\t\\\n+\t    readonly_data_section ();\t\t\t\t\t\\\n+\t}\t\t\t\t\t\t\t\t\\\n       else\t\t\t\t\t\t\t\t\\\n-        data_section ();\t\t\t\t\t\t\\\n+\treadonly_data_section ();\t\t\t\t\t\\\n     }\t\t\t\t\t\t\t\t\t\\\n   while (0)\n "}, {"sha": "3bd77cd369e59d52eae4cdede0097002107d2c35", "filename": "gcc/config/rs6000/rs6000.h", "status": "modified", "additions": 7, "deletions": 5, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ed8969fa7d85d9467bea0379ff4bca782708ac3f/gcc%2Fconfig%2Frs6000%2Frs6000.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ed8969fa7d85d9467bea0379ff4bca782708ac3f/gcc%2Fconfig%2Frs6000%2Frs6000.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.h?ref=ed8969fa7d85d9467bea0379ff4bca782708ac3f", "patch": "@@ -1747,11 +1747,13 @@ toc_section ()\t\t\t\t\t\t\\\n \n #define SELECT_SECTION(EXP,RELOC)\t\t\t\\\n {\t\t\t\t\t\t\t\\\n-  if ((TREE_READONLY (EXP)\t\t\t\t\\\n-       || (TREE_CODE (EXP) == STRING_CST\t\t\\\n-\t   && !flag_writable_strings))\t\t\t\\\n-      && ! TREE_THIS_VOLATILE (EXP)\t\t\t\\\n-      && ! (RELOC))\t\t\t\t\t\\\n+  if ((TREE_CODE (EXP) == STRING_CST\t\t\t\\\n+       && !flag_writable_strings)\t\t\t\\\n+      || (TREE_READONLY (EXP) && ! TREE_THIS_VOLATILE (EXP) \\\n+\t  && DECL_INITIAL (EXP)\t\t\t\t\\\n+\t  && (DECL_INITIAL (EXP) == error_mark_node\t\\\n+\t      || TREE_CONSTANT (DECL_INITIAL (EXP)))\t\\\n+\t  && ! (RELOC)))\t\t\t\t\\\n     {\t\t\t\t\t\t\t\\\n       if (TREE_PUBLIC (EXP))\t\t\t\t\\\n         read_only_data_section ();\t\t\t\\"}, {"sha": "9fe8b82bab92471b8a89e60775bff1591df3f9f8", "filename": "gcc/config/sparc/sparc.h", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ed8969fa7d85d9467bea0379ff4bca782708ac3f/gcc%2Fconfig%2Fsparc%2Fsparc.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ed8969fa7d85d9467bea0379ff4bca782708ac3f/gcc%2Fconfig%2Fsparc%2Fsparc.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fsparc%2Fsparc.h?ref=ed8969fa7d85d9467bea0379ff4bca782708ac3f", "patch": "@@ -282,6 +282,9 @@ extern int target_flags;\n   if (TREE_CODE (T) == VAR_DECL)\t\t\t\t\t\\\n     {\t\t\t\t\t\t\t\t\t\\\n       if (TREE_READONLY (T) && ! TREE_SIDE_EFFECTS (T)\t\t\t\\\n+\t  && DECL_INITIAL (T)\t\t\t\t\t\t\\\n+\t  && (DECL_INITIAL (T) == error_mark_node\t\t\t\\\n+\t      || TREE_CONSTANT (DECL_INITIAL (T)))\t\t\t\\\n \t  && DECL_ALIGN (T) <= MAX_TEXT_ALIGN\t\t\t\t\\\n \t  && ! (flag_pic && (RELOC)))\t\t\t\t\t\\\n \ttext_section ();\t\t\t\t\t\t\\"}, {"sha": "94cefb44f3ebe7d4a31b5621cfdd99ea939b0360", "filename": "gcc/config/svr3.h", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ed8969fa7d85d9467bea0379ff4bca782708ac3f/gcc%2Fconfig%2Fsvr3.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ed8969fa7d85d9467bea0379ff4bca782708ac3f/gcc%2Fconfig%2Fsvr3.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fsvr3.h?ref=ed8969fa7d85d9467bea0379ff4bca782708ac3f", "patch": "@@ -363,7 +363,10 @@ dtors_section ()\t\t\t\t\t\t\t\\\n   else if (TREE_CODE (DECL) == VAR_DECL)\t\t\t\t\\\n     {\t\t\t\t\t\t\t\t\t\\\n       if ((0 && RELOC)\t/* should be (flag_pic && RELOC) */\t\t\\\n-\t  || !TREE_READONLY (DECL) || TREE_SIDE_EFFECTS (DECL))\t\t\\\n+\t  || !TREE_READONLY (DECL) || TREE_SIDE_EFFECTS (DECL)\t\t\\\n+\t  || !DECL_INITIAL (DECL)\t\t\t\t\t\\\n+\t  || (DECL_INITIAL (DECL) != error_mark_node\t\t\t\\\n+\t      && !TREE_CONSTANT (DECL_INITIAL (DECL))))\t\t\t\\\n \tdata_section ();\t\t\t\t\t\t\\\n       else\t\t\t\t\t\t\t\t\\\n \tconst_section ();\t\t\t\t\t\t\\"}, {"sha": "9b5d15cdb9e5f66aad34b98858acee46748b94b4", "filename": "gcc/config/svr4.h", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ed8969fa7d85d9467bea0379ff4bca782708ac3f/gcc%2Fconfig%2Fsvr4.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ed8969fa7d85d9467bea0379ff4bca782708ac3f/gcc%2Fconfig%2Fsvr4.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fsvr4.h?ref=ed8969fa7d85d9467bea0379ff4bca782708ac3f", "patch": "@@ -513,7 +513,10 @@ dtors_section ()\t\t\t\t\t\t\t\\\n   else if (TREE_CODE (DECL) == VAR_DECL)\t\t\t\t\\\n     {\t\t\t\t\t\t\t\t\t\\\n       if ((flag_pic && RELOC)\t\t\t\t\t\t\\\n-\t  || !TREE_READONLY (DECL) || TREE_SIDE_EFFECTS (DECL))\t\t\\\n+\t  || !TREE_READONLY (DECL) || TREE_SIDE_EFFECTS (DECL)\t\t\\\n+\t  || !DECL_INITIAL (DECL)\t\t\t\t\t\\\n+\t  || (DECL_INITIAL (DECL) != error_mark_node\t\t\t\\\n+\t      && !TREE_CONSTANT (DECL_INITIAL (DECL))))\t\t\t\\\n \tdata_section ();\t\t\t\t\t\t\\\n       else\t\t\t\t\t\t\t\t\\\n \tconst_section ();\t\t\t\t\t\t\\"}, {"sha": "b6f2ebd0a0b746a6f72084eacbcbaca5fbad1cb9", "filename": "gcc/config/vax/vms.h", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ed8969fa7d85d9467bea0379ff4bca782708ac3f/gcc%2Fconfig%2Fvax%2Fvms.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ed8969fa7d85d9467bea0379ff4bca782708ac3f/gcc%2Fconfig%2Fvax%2Fvms.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fvax%2Fvms.h?ref=ed8969fa7d85d9467bea0379ff4bca782708ac3f", "patch": "@@ -253,7 +253,10 @@ const_section ()\t\t\t\t\t\\\n {\t\t\t\t\t\t\t\t\t\\\n   if (TREE_CODE (T) == VAR_DECL)\t\t\t\t\t\\\n     {\t\t\t\t\t\t\t\t\t\\\n-      if (TREE_READONLY (T) && ! TREE_THIS_VOLATILE (T))\t\t\\\n+      if (TREE_READONLY (T) && ! TREE_THIS_VOLATILE (T)\t\t\t\\\n+\t  && DECL_INITIAL (T)\t\t\t\t\t\t\\\n+\t  && (DECL_INITIAL (T) == error_mark_node\t\t\t\\\n+\t      || TREE_CONSTANT (DECL_INITIAL (T))))\t\t\t\\\n \t{\t\t\t\t\t\t\t\t\\\n \t  if (TREE_PUBLIC (T))\t\t\t\t\t\t\\\n \t    const_section ();\t\t\t\t\t\t\\"}]}