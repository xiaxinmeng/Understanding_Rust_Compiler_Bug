{"sha": "7fc9c2e52f66a2b8aa101ef918829046f8f517e8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2ZjOWMyZTUyZjY2YTJiOGFhMTAxZWY5MTg4MjkwNDZmOGY1MTdlOA==", "commit": {"author": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2018-10-05T17:51:57Z"}, "committer": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2018-10-05T17:51:57Z"}, "message": "libgo: use inline assembly in favor of call to _xgetbv()\n    \n    Use inline assembly in the implementation of internal_cpu.xgetbv as\n    opposed to a call to the intrinsic _xgetbv(), since non-gcc compilers\n    (e.g. clang) may or may not have support for it.\n    \n    Reviewed-on: https://go-review.googlesource.com/c/140137\n\nFrom-SVN: r264882", "tree": {"sha": "2d06104b346a0aad0d48b96c8d6627ba7d88daed", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2d06104b346a0aad0d48b96c8d6627ba7d88daed"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7fc9c2e52f66a2b8aa101ef918829046f8f517e8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7fc9c2e52f66a2b8aa101ef918829046f8f517e8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7fc9c2e52f66a2b8aa101ef918829046f8f517e8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7fc9c2e52f66a2b8aa101ef918829046f8f517e8/comments", "author": null, "committer": null, "parents": [{"sha": "d5a9895595c126a5fa8b41c222f330908c3a7e72", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d5a9895595c126a5fa8b41c222f330908c3a7e72", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d5a9895595c126a5fa8b41c222f330908c3a7e72"}], "stats": {"total": 16, "additions": 11, "deletions": 5}, "files": [{"sha": "2c7a860c8a8ffa7991bfef87a39e646455f1cb82", "filename": "gcc/go/gofrontend/MERGE", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7fc9c2e52f66a2b8aa101ef918829046f8f517e8/gcc%2Fgo%2Fgofrontend%2FMERGE", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7fc9c2e52f66a2b8aa101ef918829046f8f517e8/gcc%2Fgo%2Fgofrontend%2FMERGE", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgo%2Fgofrontend%2FMERGE?ref=7fc9c2e52f66a2b8aa101ef918829046f8f517e8", "patch": "@@ -1,4 +1,4 @@\n-9f4cf23e716bcf65e071260afa032a64acd3fdde\n+d0739c13ca3686df1f8d0fae7c6c5caaed058503\n \n The first line of this file holds the git revision number of the last\n merge done from the gofrontend repository."}, {"sha": "1d5b492a7877f762e1bc3c920c490a9a3819b60d", "filename": "libgo/go/internal/cpu/cpu_gccgo.c", "status": "modified", "additions": 10, "deletions": 4, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7fc9c2e52f66a2b8aa101ef918829046f8f517e8/libgo%2Fgo%2Finternal%2Fcpu%2Fcpu_gccgo.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7fc9c2e52f66a2b8aa101ef918829046f8f517e8/libgo%2Fgo%2Finternal%2Fcpu%2Fcpu_gccgo.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgo%2Fgo%2Finternal%2Fcpu%2Fcpu_gccgo.c?ref=7fc9c2e52f66a2b8aa101ef918829046f8f517e8", "patch": "@@ -52,12 +52,18 @@ struct xgetbv_ret xgetbv(void)\n #pragma GCC target(\"xsave\")\n \n struct xgetbv_ret xgetbv(void) {\n-\tlong long r;\n \tstruct xgetbv_ret ret;\n \n-\tr = _xgetbv(0);\n-\tret.eax = r & 0xffffffff;\n-\tret.edx = r >> 32;\n+        // At some point, use call to _xgetbv() instead:\n+        //\n+        //       long long r = _xgetbv(0);\n+        //       ret.eax = r & 0xffffffff;\n+        //       ret.edx = r >> 32;\n+        //\n+        unsigned int __eax, __edx, __xcr_no = 0;\n+        __asm__ (\"xgetbv\" : \"=a\" (__eax), \"=d\" (__edx) : \"c\" (__xcr_no));\n+        ret.eax = __eax;\n+        ret.edx = __edx;\n \treturn ret;\n }\n "}]}