{"sha": "35a952ba70028b50fbd2fd19f7dc91f2da45371e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzVhOTUyYmE3MDAyOGI1MGZiZDJmZDE5ZjdkYzkxZjJkYTQ1MzcxZQ==", "commit": {"author": {"name": "Martin Jambor", "email": "mjambor@suse.cz", "date": "2017-06-13T11:34:51Z"}, "committer": {"name": "Martin Jambor", "email": "jamborm@gcc.gnu.org", "date": "2017-06-13T11:34:51Z"}, "message": "[PR80803 1/2] Streamline SRA access enqueuing\n\n2017-06-13  Martin Jambor  <mjambor@suse.cz>\n\n\t* tree-sra.c (add_access_to_work_queue): Only enqueue accesses\n\tthat have a first_link.\n\t(sort_and_splice_var_accesses): Do not check first_link before\n\tenquing.\n\t(subtree_mark_written_and_enqueue): Likewise.\n\t(propagate_all_subaccesses): Likewise and do not stop at first\n\tparent with a first_link.\n\nFrom-SVN: r249153", "tree": {"sha": "35eb66b90e2c173c1b89df32c2459105ec4c6ef6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/35eb66b90e2c173c1b89df32c2459105ec4c6ef6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/35a952ba70028b50fbd2fd19f7dc91f2da45371e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/35a952ba70028b50fbd2fd19f7dc91f2da45371e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/35a952ba70028b50fbd2fd19f7dc91f2da45371e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/35a952ba70028b50fbd2fd19f7dc91f2da45371e/comments", "author": {"login": "jamborm", "id": 2180070, "node_id": "MDQ6VXNlcjIxODAwNzA=", "avatar_url": "https://avatars.githubusercontent.com/u/2180070?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jamborm", "html_url": "https://github.com/jamborm", "followers_url": "https://api.github.com/users/jamborm/followers", "following_url": "https://api.github.com/users/jamborm/following{/other_user}", "gists_url": "https://api.github.com/users/jamborm/gists{/gist_id}", "starred_url": "https://api.github.com/users/jamborm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jamborm/subscriptions", "organizations_url": "https://api.github.com/users/jamborm/orgs", "repos_url": "https://api.github.com/users/jamborm/repos", "events_url": "https://api.github.com/users/jamborm/events{/privacy}", "received_events_url": "https://api.github.com/users/jamborm/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "7aa923e02f598c1075f3acf1e5da946848515b36", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7aa923e02f598c1075f3acf1e5da946848515b36", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7aa923e02f598c1075f3acf1e5da946848515b36"}], "stats": {"total": 24, "additions": 14, "deletions": 10}, "files": [{"sha": "4dec155ad86aa3bb9c454f457b2585f08aa464a3", "filename": "gcc/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/35a952ba70028b50fbd2fd19f7dc91f2da45371e/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/35a952ba70028b50fbd2fd19f7dc91f2da45371e/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=35a952ba70028b50fbd2fd19f7dc91f2da45371e", "patch": "@@ -1,3 +1,13 @@\n+2017-06-13  Martin Jambor  <mjambor@suse.cz>\n+\n+\t* tree-sra.c (add_access_to_work_queue): Only enqueue accesses\n+\tthat have a first_link.\n+\t(sort_and_splice_var_accesses): Do not check first_link before\n+\tenquing.\n+\t(subtree_mark_written_and_enqueue): Likewise.\n+\t(propagate_all_subaccesses): Likewise and do not stop at first\n+\tparent with a first_link.\n+\n 2017-06-13  Martin Jambor  <mjambor@suse.cz>\n \n \t* tree-sra.c (dump_access_tree_1): Fix accidental dumping to stderr"}, {"sha": "05bc3d0e806f14629a7fd0215a5b694bf322d20d", "filename": "gcc/tree-sra.c", "status": "modified", "additions": 4, "deletions": 10, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/35a952ba70028b50fbd2fd19f7dc91f2da45371e/gcc%2Ftree-sra.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/35a952ba70028b50fbd2fd19f7dc91f2da45371e/gcc%2Ftree-sra.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-sra.c?ref=35a952ba70028b50fbd2fd19f7dc91f2da45371e", "patch": "@@ -627,7 +627,7 @@ relink_to_new_repr (struct access *new_racc, struct access *old_racc)\n static void\n add_access_to_work_queue (struct access *access)\n {\n-  if (!access->grp_queued)\n+  if (access->first_link && !access->grp_queued)\n     {\n       gcc_assert (!access->next_queued);\n       access->next_queued = work_queue_head;\n@@ -2112,8 +2112,7 @@ sort_and_splice_var_accesses (tree var)\n       access->grp_total_scalarization = total_scalarization;\n       access->grp_partial_lhs = grp_partial_lhs;\n       access->grp_unscalarizable_region = unscalarizable_region;\n-      if (access->first_link)\n-\tadd_access_to_work_queue (access);\n+      add_access_to_work_queue (access);\n \n       *prev_acc_ptr = access;\n       prev_acc_ptr = &access->next_grp;\n@@ -2670,8 +2669,7 @@ subtree_mark_written_and_enqueue (struct access *access)\n   if (access->grp_write)\n     return;\n   access->grp_write = true;\n-  if (access->first_link)\n-    add_access_to_work_queue (access);\n+  add_access_to_work_queue (access);\n \n   struct access *child;\n   for (child = access->first_child; child; child = child->next_sibling)\n@@ -2715,11 +2713,7 @@ propagate_all_subaccesses (void)\n \t  if (reque_parents)\n \t    do\n \t      {\n-\t\tif (lacc->first_link)\n-\t\t  {\n-\t\t    add_access_to_work_queue (lacc);\n-\t\t    break;\n-\t\t  }\n+\t\tadd_access_to_work_queue (lacc);\n \t\tlacc = lacc->parent;\n \t      }\n \t    while (lacc);"}]}