{"sha": "cbb0b55385692dca6898a2668766f17ea42c4d2e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Y2JiMGI1NTM4NTY5MmRjYTY4OThhMjY2ODc2NmYxN2VhNDJjNGQyZQ==", "commit": {"author": {"name": "Yannick Moy", "email": "moy@adacore.com", "date": "2019-09-17T08:01:10Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "pmderodat@gcc.gnu.org", "date": "2019-09-17T08:01:10Z"}, "message": "[Ada] Do not inline dispatching operations in GNATprove mode\n\nIn GNATprove, local subprograms without contracts are candidates for\ninlining, so that they are only analyzed in the context of their calls.\nThis does not apply to dispatching operations, which may be called\nthrough dispatching, in an unknown calling context. Hence such\noperations should not be considered as candidates for inlining.\n\nThere is no test as this has no effect on compilation.\n\n2019-09-17  Yannick Moy  <moy@adacore.com>\n\ngcc/ada/\n\n\t* inline.adb (Can_Be_Inlined_In_GNATprove_Mode): Add handling\n\tfor dispatching operations.\n\nFrom-SVN: r275779", "tree": {"sha": "713135b4be8b9de962ed05acc58babf7ed7a5a1f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/713135b4be8b9de962ed05acc58babf7ed7a5a1f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/cbb0b55385692dca6898a2668766f17ea42c4d2e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cbb0b55385692dca6898a2668766f17ea42c4d2e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cbb0b55385692dca6898a2668766f17ea42c4d2e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cbb0b55385692dca6898a2668766f17ea42c4d2e/comments", "author": {"login": "yannickmoy", "id": 859440, "node_id": "MDQ6VXNlcjg1OTQ0MA==", "avatar_url": "https://avatars.githubusercontent.com/u/859440?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yannickmoy", "html_url": "https://github.com/yannickmoy", "followers_url": "https://api.github.com/users/yannickmoy/followers", "following_url": "https://api.github.com/users/yannickmoy/following{/other_user}", "gists_url": "https://api.github.com/users/yannickmoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/yannickmoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yannickmoy/subscriptions", "organizations_url": "https://api.github.com/users/yannickmoy/orgs", "repos_url": "https://api.github.com/users/yannickmoy/repos", "events_url": "https://api.github.com/users/yannickmoy/events{/privacy}", "received_events_url": "https://api.github.com/users/yannickmoy/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "a9a08e6d331cb454741d2b089cdedaefedfd5271", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a9a08e6d331cb454741d2b089cdedaefedfd5271", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a9a08e6d331cb454741d2b089cdedaefedfd5271"}], "stats": {"total": 11, "additions": 11, "deletions": 0}, "files": [{"sha": "a2f7e27633497ade628a0eba1860750264ff9b63", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cbb0b55385692dca6898a2668766f17ea42c4d2e/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cbb0b55385692dca6898a2668766f17ea42c4d2e/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=cbb0b55385692dca6898a2668766f17ea42c4d2e", "patch": "@@ -1,3 +1,8 @@\n+2019-09-17  Yannick Moy  <moy@adacore.com>\n+\n+\t* inline.adb (Can_Be_Inlined_In_GNATprove_Mode): Add handling\n+\tfor dispatching operations.\n+\n 2019-09-17  Ed Schonberg  <schonberg@adacore.com>\n \n \t* sem_ch13.adb (Check_Aspect_At_End_Of_Declarations): In a"}, {"sha": "6e345d66aa727852177490fa9938f167da23daba", "filename": "gcc/ada/inline.adb", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cbb0b55385692dca6898a2668766f17ea42c4d2e/gcc%2Fada%2Finline.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cbb0b55385692dca6898a2668766f17ea42c4d2e/gcc%2Fada%2Finline.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Finline.adb?ref=cbb0b55385692dca6898a2668766f17ea42c4d2e", "patch": "@@ -1681,6 +1681,12 @@ package body Inline is\n       elsif not In_Extended_Main_Code_Unit (Id) then\n          return False;\n \n+      --  Do not inline dispatching operations, as only their static calls\n+      --  can be analyzed in context, and not their dispatching calls.\n+\n+      elsif Is_Dispatching_Operation (Id) then\n+         return False;\n+\n       --  Do not inline subprograms marked No_Return, possibly used for\n       --  signaling errors, which GNATprove handles specially.\n "}]}