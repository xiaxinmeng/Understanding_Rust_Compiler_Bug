{"sha": "4da3b0f8d1550ad6d312cadf8ef6ca9ca7d838ab", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NGRhM2IwZjhkMTU1MGFkNmQzMTJjYWRmOGVmNmNhOWNhN2Q4MzhhYg==", "commit": {"author": {"name": "Ian Lance Taylor", "email": "iant@google.com", "date": "2010-11-21T01:49:05Z"}, "committer": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2010-11-21T01:49:05Z"}, "message": "configure.ac: Only disable a language library if no language needs it.\n\n\t* configure.ac: Only disable a language library if no language needs\n\tit.  Don't let --disable-libgcj uncondtionally disable libffi.\n\t* configure: Rebuild.\n\nFrom-SVN: r166993", "tree": {"sha": "923bf3d1c8a371cd30f9e4146dce538958a69872", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/923bf3d1c8a371cd30f9e4146dce538958a69872"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4da3b0f8d1550ad6d312cadf8ef6ca9ca7d838ab", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4da3b0f8d1550ad6d312cadf8ef6ca9ca7d838ab", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4da3b0f8d1550ad6d312cadf8ef6ca9ca7d838ab", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4da3b0f8d1550ad6d312cadf8ef6ca9ca7d838ab/comments", "author": null, "committer": null, "parents": [{"sha": "24a57808c19e8177372e1b6076fa24684e62d192", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/24a57808c19e8177372e1b6076fa24684e62d192", "html_url": "https://github.com/Rust-GCC/gccrs/commit/24a57808c19e8177372e1b6076fa24684e62d192"}], "stats": {"total": 54, "additions": 48, "deletions": 6}, "files": [{"sha": "7828200809106e17da326e39127aeb3382be0daf", "filename": "ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4da3b0f8d1550ad6d312cadf8ef6ca9ca7d838ab/ChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4da3b0f8d1550ad6d312cadf8ef6ca9ca7d838ab/ChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/ChangeLog?ref=4da3b0f8d1550ad6d312cadf8ef6ca9ca7d838ab", "patch": "@@ -1,3 +1,9 @@\n+2010-11-20  Ian Lance Taylor  <iant@google.com>\n+\n+\t* configure.ac: Only disable a language library if no language needs\n+\tit.  Don't let --disable-libgcj uncondtionally disable libffi.\n+\t* configure: Rebuild.\n+\n 2010-11-20  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>\n \n \t* Makefile.in: Regenerate."}, {"sha": "a44f4184e6f8cc6ad4386a6960c235562bd431f0", "filename": "configure", "status": "modified", "additions": 21, "deletions": 3, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4da3b0f8d1550ad6d312cadf8ef6ca9ca7d838ab/configure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4da3b0f8d1550ad6d312cadf8ef6ca9ca7d838ab/configure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/configure?ref=4da3b0f8d1550ad6d312cadf8ef6ca9ca7d838ab", "patch": "@@ -2985,7 +2985,8 @@ yes)\n   ;;\n no)\n   # Make sure we get it printed in the list of not supported target libs.\n-  noconfigdirs=\"$noconfigdirs ${libgcj}\"\n+  # Don't disable libffi, though, other languages use it.\n+  noconfigdirs=\"$noconfigdirs `echo ${libgcj} | sed -e 's/target-libffi//'`\"\n   ;;\n esac\n \n@@ -6177,6 +6178,9 @@ if test -d ${srcdir}/gcc; then\n   missing_languages=`echo \",$enable_languages,\" | sed -e s/,all,/,/ -e s/,c,/,/ `\n   potential_languages=,c,\n \n+  enabled_target_libs=\n+  disabled_target_libs=\n+\n   for lang_frag in ${srcdir}/gcc/*/config-lang.in .. ; do\n     case ${lang_frag} in\n       ..) ;;\n@@ -6254,17 +6258,20 @@ if test -d ${srcdir}/gcc; then\n \tcase $add_this_lang in\n \t  unsupported)\n             # Remove language-dependent dirs.\n-            eval noconfigdirs='\"$noconfigdirs \"'\\\"$target_libs $lang_dirs\\\"\n+\t    disabled_target_libs=\"$disabled_target_libs $target_libs\"\n+\t    noconfigdirs=\"$noconfigdirs $lang_dirs\"\n \t    ;;\n \t  no)\n             # Remove language-dependent dirs; still show language as supported.\n-            eval noconfigdirs='\"$noconfigdirs \"'\\\"$target_libs $lang_dirs\\\"\n+\t    disabled_target_libs=\"$disabled_target_libs $target_libs\"\n+\t    noconfigdirs=\"$noconfigdirs $lang_dirs\"\n             potential_languages=\"${potential_languages}${language},\"\n \t    ;;\n           yes)\n \t    new_enable_languages=\"${new_enable_languages}${language},\"\n             potential_languages=\"${potential_languages}${language},\"\n \t    missing_languages=`echo \"$missing_languages\" | sed \"s/,$language,/,/\"`\n+\t    enabled_target_libs=\"$enabled_target_libs $target_libs\"\n \t    case \"${boot_language}:,$enable_stage1_languages,\" in\n \t      yes:* | *:*,$language,* | *:*,yes, | *:*,all,)\n \t\t# Add to (comma-separated) list of stage 1 languages.\n@@ -6282,6 +6289,17 @@ if test -d ${srcdir}/gcc; then\n     esac\n   done\n \n+  # Add target libraries which are only needed for disabled languages\n+  # to noconfigdirs.\n+  if test -n \"$disabled_target_libs\"; then\n+    for dir in $disabled_target_libs; do\n+      case \" $enabled_target_libs \" in\n+      *\" ${dir} \"*) ;;\n+      *) noconfigdirs=\"$noconfigdirs $dir\" ;;\n+      esac\n+    done\n+  fi\n+\n   # Check whether --enable-stage1-languages was given.\n if test \"${enable_stage1_languages+set}\" = set; then :\n   enableval=$enable_stage1_languages; case ,${enable_stage1_languages}, in"}, {"sha": "0a5c276a033cc2a098bef75ff8a808860fee2b89", "filename": "configure.ac", "status": "modified", "additions": 21, "deletions": 3, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4da3b0f8d1550ad6d312cadf8ef6ca9ca7d838ab/configure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4da3b0f8d1550ad6d312cadf8ef6ca9ca7d838ab/configure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/configure.ac?ref=4da3b0f8d1550ad6d312cadf8ef6ca9ca7d838ab", "patch": "@@ -451,7 +451,8 @@ yes)\n   ;;\n no)\n   # Make sure we get it printed in the list of not supported target libs.\n-  noconfigdirs=\"$noconfigdirs ${libgcj}\"\n+  # Don't disable libffi, though, other languages use it.\n+  noconfigdirs=\"$noconfigdirs `echo ${libgcj} | sed -e 's/target-libffi//'`\"\n   ;;\n esac\n \n@@ -1765,6 +1766,9 @@ if test -d ${srcdir}/gcc; then\n   missing_languages=`echo \",$enable_languages,\" | sed -e s/,all,/,/ -e s/,c,/,/ `\n   potential_languages=,c,\n \n+  enabled_target_libs=\n+  disabled_target_libs=\n+\n   for lang_frag in ${srcdir}/gcc/*/config-lang.in .. ; do\n     case ${lang_frag} in\n       ..) ;;\n@@ -1842,17 +1846,20 @@ if test -d ${srcdir}/gcc; then\n \tcase $add_this_lang in\n \t  unsupported)\n             # Remove language-dependent dirs.\n-            eval noconfigdirs='\"$noconfigdirs \"'\\\"$target_libs $lang_dirs\\\"\n+\t    disabled_target_libs=\"$disabled_target_libs $target_libs\"\n+\t    noconfigdirs=\"$noconfigdirs $lang_dirs\"\n \t    ;;\n \t  no)\n             # Remove language-dependent dirs; still show language as supported.\n-            eval noconfigdirs='\"$noconfigdirs \"'\\\"$target_libs $lang_dirs\\\"\n+\t    disabled_target_libs=\"$disabled_target_libs $target_libs\"\n+\t    noconfigdirs=\"$noconfigdirs $lang_dirs\"\n             potential_languages=\"${potential_languages}${language},\"\n \t    ;;\n           yes)\n \t    new_enable_languages=\"${new_enable_languages}${language},\"\n             potential_languages=\"${potential_languages}${language},\"\n \t    missing_languages=`echo \"$missing_languages\" | sed \"s/,$language,/,/\"`\n+\t    enabled_target_libs=\"$enabled_target_libs $target_libs\"\n \t    case \"${boot_language}:,$enable_stage1_languages,\" in\n \t      yes:* | *:*,$language,* | *:*,yes, | *:*,all,)\n \t\t# Add to (comma-separated) list of stage 1 languages.\n@@ -1870,6 +1877,17 @@ if test -d ${srcdir}/gcc; then\n     esac\n   done\n \n+  # Add target libraries which are only needed for disabled languages\n+  # to noconfigdirs.\n+  if test -n \"$disabled_target_libs\"; then\n+    for dir in $disabled_target_libs; do\n+      case \" $enabled_target_libs \" in\n+      *\" ${dir} \"*) ;;\n+      *) noconfigdirs=\"$noconfigdirs $dir\" ;;\n+      esac\n+    done\n+  fi\n+\n   AC_ARG_ENABLE(stage1-languages,\n [  --enable-stage1-languages@<:@=all@:>@   choose additional languages to build during\n                           stage1.  Mostly useful for compiler development.],"}]}