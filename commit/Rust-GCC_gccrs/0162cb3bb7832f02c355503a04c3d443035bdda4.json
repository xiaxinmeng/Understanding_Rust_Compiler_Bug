{"sha": "0162cb3bb7832f02c355503a04c3d443035bdda4", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDE2MmNiM2JiNzgzMmYwMmMzNTU1MDNhMDRjM2Q0NDMwMzViZGRhNA==", "commit": {"author": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2014-11-19T17:40:42Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2014-11-19T17:40:42Z"}, "message": "re PR c++/55425 (constexpr does not work in many situations  (both built-in and user supplied literals))\n\n/cp\n2014-11-19  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/55425\n\t* constexpr.c (constexpr_fn_retval): Accept __func__, __FUNCTION__,\n\tand __PRETTY_FUNCTION__.\n\n/testsuite\n2014-11-19  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/55425\n\t* g++.dg/cpp0x/constexpr-__func__.C\n\nFrom-SVN: r217788", "tree": {"sha": "f2a5402e5f4c1077a8868f4c5bd65c707e2fc376", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f2a5402e5f4c1077a8868f4c5bd65c707e2fc376"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0162cb3bb7832f02c355503a04c3d443035bdda4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0162cb3bb7832f02c355503a04c3d443035bdda4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0162cb3bb7832f02c355503a04c3d443035bdda4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0162cb3bb7832f02c355503a04c3d443035bdda4/comments", "author": null, "committer": null, "parents": [{"sha": "538dd0b78f4b3998a1719a282811cb0caa1b035a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/538dd0b78f4b3998a1719a282811cb0caa1b035a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/538dd0b78f4b3998a1719a282811cb0caa1b035a"}], "stats": {"total": 35, "additions": 29, "deletions": 6}, "files": [{"sha": "13a9965cee8a5cccad58000e2f1a29d6fb3a17b6", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0162cb3bb7832f02c355503a04c3d443035bdda4/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0162cb3bb7832f02c355503a04c3d443035bdda4/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=0162cb3bb7832f02c355503a04c3d443035bdda4", "patch": "@@ -1,3 +1,9 @@\n+2014-11-19  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/55425\n+\t* constexpr.c (constexpr_fn_retval): Accept __func__, __FUNCTION__,\n+\tand __PRETTY_FUNCTION__.\n+\n 2014-11-18  Jason Merrill  <jason@redhat.com>\n \n \tPR c++/63924"}, {"sha": "d98d9b9259ef18a1e474e91d5ee37747d85f70ae", "filename": "gcc/cp/constexpr.c", "status": "modified", "additions": 8, "deletions": 3, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0162cb3bb7832f02c355503a04c3d443035bdda4/gcc%2Fcp%2Fconstexpr.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0162cb3bb7832f02c355503a04c3d443035bdda4/gcc%2Fcp%2Fconstexpr.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fconstexpr.c?ref=0162cb3bb7832f02c355503a04c3d443035bdda4", "patch": "@@ -616,9 +616,14 @@ constexpr_fn_retval (tree body)\n       return break_out_target_exprs (TREE_OPERAND (body, 0));\n \n     case DECL_EXPR:\n-      if (TREE_CODE (DECL_EXPR_DECL (body)) == USING_DECL)\n-\treturn NULL_TREE;\n-      return error_mark_node;\n+      {\n+\ttree decl = DECL_EXPR_DECL (body);\n+\tif (TREE_CODE (decl) == USING_DECL\n+\t    /* Accept __func__, __FUNCTION__, and __PRETTY_FUNCTION__.  */\n+\t    || DECL_ARTIFICIAL (decl))\n+\t  return NULL_TREE;\n+\treturn error_mark_node;\n+      }\n \n     case CLEANUP_POINT_EXPR:\n       return constexpr_fn_retval (TREE_OPERAND (body, 0));"}, {"sha": "3a2dbf7c86a5c4213feccd812e20d9e4fe948916", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 9, "deletions": 3, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0162cb3bb7832f02c355503a04c3d443035bdda4/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0162cb3bb7832f02c355503a04c3d443035bdda4/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=0162cb3bb7832f02c355503a04c3d443035bdda4", "patch": "@@ -1,11 +1,17 @@\n+2014-11-19  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/55425\n+\t* g++.dg/cpp0x/constexpr-__func__.C\n+\n 2014-11-19  Renlin Li  <Renlin.Li@arm.com>\n-    PR target/63424\n+\n+\tPR target/63424\n \t* gcc.target/aarch64/pr63424.c: New test.\n \n 2014-11-19  Renlin Li  <Renlin.Li@arm.com>\n \n-    PR middle-end/63762\n-\t* gcc.dg/pr63762.c: New test. \n+\tPR middle-end/63762\n+\t* gcc.dg/pr63762.c: New test.\n \n 2014-11-19  Marek Polacek  <polacek@redhat.com>\n "}, {"sha": "a71ed6c63c2b3284e0032381820c0c9055f27eb3", "filename": "gcc/testsuite/g++.dg/cpp0x/constexpr-__func__.C", "status": "added", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0162cb3bb7832f02c355503a04c3d443035bdda4/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fconstexpr-__func__.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0162cb3bb7832f02c355503a04c3d443035bdda4/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fconstexpr-__func__.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fconstexpr-__func__.C?ref=0162cb3bb7832f02c355503a04c3d443035bdda4", "patch": "@@ -0,0 +1,6 @@\n+// PR c++/55425\n+// { dg-do compile { target c++11 } }\n+\n+constexpr const char* x() { return __func__; }\n+constexpr const char* y() { return __FUNCTION__; }\n+constexpr const char* z() { return __PRETTY_FUNCTION__; }"}]}