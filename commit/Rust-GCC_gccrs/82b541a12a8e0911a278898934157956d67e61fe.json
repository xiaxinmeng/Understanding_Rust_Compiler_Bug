{"sha": "82b541a12a8e0911a278898934157956d67e61fe", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODJiNTQxYTEyYThlMDkxMWEyNzg4OTg5MzQxNTc5NTZkNjdlNjFmZQ==", "commit": {"author": {"name": "Janus Weil", "email": "janus@gcc.gnu.org", "date": "2013-04-17T16:13:07Z"}, "committer": {"name": "Janus Weil", "email": "janus@gcc.gnu.org", "date": "2013-04-17T16:13:07Z"}, "message": "re PR fortran/56814 (Bogus Interface mismatch in dummy procedure)\n\n2013-04-17  Janus Weil  <janus@gcc.gnu.org>\n\n\tPR fortran/56814\n\t* interface.c (check_result_characteristics): Get result from interface\n\tif present.\n\n\n2013-04-17  Janus Weil  <janus@gcc.gnu.org>\n\n\tPR fortran/56814\n\t* gfortran.dg/proc_ptr_42.f90: New.\n\nFrom-SVN: r198032", "tree": {"sha": "c2321b6343800a3dfa1d468670923991af13d344", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c2321b6343800a3dfa1d468670923991af13d344"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/82b541a12a8e0911a278898934157956d67e61fe", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/82b541a12a8e0911a278898934157956d67e61fe", "html_url": "https://github.com/Rust-GCC/gccrs/commit/82b541a12a8e0911a278898934157956d67e61fe", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/82b541a12a8e0911a278898934157956d67e61fe/comments", "author": {"login": "janusw", "id": 484108, "node_id": "MDQ6VXNlcjQ4NDEwOA==", "avatar_url": "https://avatars.githubusercontent.com/u/484108?v=4", "gravatar_id": "", "url": "https://api.github.com/users/janusw", "html_url": "https://github.com/janusw", "followers_url": "https://api.github.com/users/janusw/followers", "following_url": "https://api.github.com/users/janusw/following{/other_user}", "gists_url": "https://api.github.com/users/janusw/gists{/gist_id}", "starred_url": "https://api.github.com/users/janusw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/janusw/subscriptions", "organizations_url": "https://api.github.com/users/janusw/orgs", "repos_url": "https://api.github.com/users/janusw/repos", "events_url": "https://api.github.com/users/janusw/events{/privacy}", "received_events_url": "https://api.github.com/users/janusw/received_events", "type": "User", "site_admin": false}, "committer": {"login": "janusw", "id": 484108, "node_id": "MDQ6VXNlcjQ4NDEwOA==", "avatar_url": "https://avatars.githubusercontent.com/u/484108?v=4", "gravatar_id": "", "url": "https://api.github.com/users/janusw", "html_url": "https://github.com/janusw", "followers_url": "https://api.github.com/users/janusw/followers", "following_url": "https://api.github.com/users/janusw/following{/other_user}", "gists_url": "https://api.github.com/users/janusw/gists{/gist_id}", "starred_url": "https://api.github.com/users/janusw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/janusw/subscriptions", "organizations_url": "https://api.github.com/users/janusw/orgs", "repos_url": "https://api.github.com/users/janusw/repos", "events_url": "https://api.github.com/users/janusw/events{/privacy}", "received_events_url": "https://api.github.com/users/janusw/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0480fff0ff265263b0795d64137a0e194c875bc4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0480fff0ff265263b0795d64137a0e194c875bc4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0480fff0ff265263b0795d64137a0e194c875bc4"}], "stats": {"total": 58, "additions": 56, "deletions": 2}, "files": [{"sha": "7e0e7b4cea3cf0b7eb80d915d94a20162c2bde12", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/82b541a12a8e0911a278898934157956d67e61fe/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/82b541a12a8e0911a278898934157956d67e61fe/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=82b541a12a8e0911a278898934157956d67e61fe", "patch": "@@ -1,3 +1,9 @@\n+2013-04-17  Janus Weil  <janus@gcc.gnu.org>\n+\n+\tPR fortran/56814\n+\t* interface.c (check_result_characteristics): Get result from interface\n+\tif present.\n+\n 2013-04-17  Janne Blomqvist  <jb@gcc.gnu.org>\n \n \tPR fortran/40958"}, {"sha": "1b967fac275fdf84b9564df104ce15bd95cbad8a", "filename": "gcc/fortran/interface.c", "status": "modified", "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/82b541a12a8e0911a278898934157956d67e61fe/gcc%2Ffortran%2Finterface.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/82b541a12a8e0911a278898934157956d67e61fe/gcc%2Ffortran%2Finterface.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Finterface.c?ref=82b541a12a8e0911a278898934157956d67e61fe", "patch": "@@ -1188,8 +1188,15 @@ check_result_characteristics (gfc_symbol *s1, gfc_symbol *s2,\n {\n   gfc_symbol *r1, *r2;\n \n-  r1 = s1->result ? s1->result : s1;\n-  r2 = s2->result ? s2->result : s2;\n+  if (s1->ts.interface && s1->ts.interface->result)\n+    r1 = s1->ts.interface->result;\n+  else\n+    r1 = s1->result ? s1->result : s1;\n+\n+  if (s2->ts.interface && s2->ts.interface->result)\n+    r2 = s2->ts.interface->result;\n+  else\n+    r2 = s2->result ? s2->result : s2;\n \n   if (r1->ts.type == BT_UNKNOWN)\n     return true;"}, {"sha": "c10ffdc91daa9acc02cdaccf282374e5c1a9c5c3", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/82b541a12a8e0911a278898934157956d67e61fe/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/82b541a12a8e0911a278898934157956d67e61fe/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=82b541a12a8e0911a278898934157956d67e61fe", "patch": "@@ -1,3 +1,8 @@\n+2013-04-17  Janus Weil  <janus@gcc.gnu.org>\n+\n+\tPR fortran/56814\n+\t* gfortran.dg/proc_ptr_42.f90: New.\n+\n 2013-04-17  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* gnat.dg/discr41.ad[sb]: New test."}, {"sha": "8556fdf0c217b6a074caede384ce740607fff17b", "filename": "gcc/testsuite/gfortran.dg/proc_ptr_42.f90", "status": "added", "additions": 36, "deletions": 0, "changes": 36, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/82b541a12a8e0911a278898934157956d67e61fe/gcc%2Ftestsuite%2Fgfortran.dg%2Fproc_ptr_42.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/82b541a12a8e0911a278898934157956d67e61fe/gcc%2Ftestsuite%2Fgfortran.dg%2Fproc_ptr_42.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fproc_ptr_42.f90?ref=82b541a12a8e0911a278898934157956d67e61fe", "patch": "@@ -0,0 +1,36 @@\n+! { dg-do compile }\n+!\n+! PR 56814: [4.8/4.9 Regression] Bogus Interface mismatch in dummy procedure\n+!\n+! Contributed by Marco Restelli <mrestelli@gmail.com>\n+\n+module m1\n+  abstract interface\n+    pure function i_f(x) result(d)\n+    real, intent(in) :: x(:,:)\n+    real :: d(size(x,1),size(x,2))\n+    end function\n+  end interface\n+\n+  procedure(i_f), pointer :: f => null()\n+end module\n+\n+module m2\n+contains\n+  pure subroutine ns_dirdata(fun)\n+    interface\n+    pure function fun(x) result(d)\n+      real, intent(in) :: x(:,:)\n+      real :: d(size(x,1),size(x,2))\n+    end function\n+    end interface\n+  end subroutine\n+end module\n+\n+program p\n+ use m1\n+ use m2\n+  call ns_dirdata(f)\n+end\n+\n+! { dg-final { cleanup-modules \"m1 m2\" } }"}]}