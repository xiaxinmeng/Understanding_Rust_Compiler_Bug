{"sha": "0ca2faee4f6194686a8121f76ffb7036614e259d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MGNhMmZhZWU0ZjYxOTQ2ODZhODEyMWY3NmZmYjcwMzY2MTRlMjU5ZA==", "commit": {"author": {"name": "Zdenek Dvorak", "email": "dvorakz@suse.cz", "date": "2007-04-11T16:45:47Z"}, "committer": {"name": "Zdenek Dvorak", "email": "rakdver@gcc.gnu.org", "date": "2007-04-11T16:45:47Z"}, "message": "tree-data-ref.c (add_multivariate_self_dist): Force the distance vector to be positive.\n\n\t* tree-data-ref.c (add_multivariate_self_dist): Force the distance\n\tvector to be positive.\n\nFrom-SVN: r123720", "tree": {"sha": "d28be87d38025ece5bfa679e0b51142c941bd476", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d28be87d38025ece5bfa679e0b51142c941bd476"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0ca2faee4f6194686a8121f76ffb7036614e259d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0ca2faee4f6194686a8121f76ffb7036614e259d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0ca2faee4f6194686a8121f76ffb7036614e259d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0ca2faee4f6194686a8121f76ffb7036614e259d/comments", "author": null, "committer": null, "parents": [{"sha": "e9e0aa2c9677074a7912521f4fa1aebf53640198", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e9e0aa2c9677074a7912521f4fa1aebf53640198", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e9e0aa2c9677074a7912521f4fa1aebf53640198"}], "stats": {"total": 22, "additions": 20, "deletions": 2}, "files": [{"sha": "98d5bc7588912d53da7f762c4319d191d53a9f69", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0ca2faee4f6194686a8121f76ffb7036614e259d/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0ca2faee4f6194686a8121f76ffb7036614e259d/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=0ca2faee4f6194686a8121f76ffb7036614e259d", "patch": "@@ -1,3 +1,8 @@\n+2007-04-10  Zdenek Dvorak  <dvorakz@suse.cz>\n+\n+\t* tree-data-ref.c (add_multivariate_self_dist): Force the distance\n+\tvector to be positive.\n+\n 2007-04-11  Diego Novillo  <dnovillo@redhat.com>\n \n \tPR 30735"}, {"sha": "7d8074679ea3b58c9ecc88881dd3e247cb03ffa2", "filename": "gcc/tree-data-ref.c", "status": "modified", "additions": 15, "deletions": 2, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0ca2faee4f6194686a8121f76ffb7036614e259d/gcc%2Ftree-data-ref.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0ca2faee4f6194686a8121f76ffb7036614e259d/gcc%2Ftree-data-ref.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-data-ref.c?ref=0ca2faee4f6194686a8121f76ffb7036614e259d", "patch": "@@ -3857,6 +3857,7 @@ add_multivariate_self_dist (struct data_dependence_relation *ddr, tree c_2)\n   tree c_1 = CHREC_LEFT (c_2);\n   tree c_0 = CHREC_LEFT (c_1);\n   lambda_vector dist_v;\n+  int v1, v2, cd;\n \n   /* Polynomials with more than 2 variables are not handled yet.  */\n   if (TREE_CODE (c_0) != INTEGER_CST)\n@@ -3870,8 +3871,20 @@ add_multivariate_self_dist (struct data_dependence_relation *ddr, tree c_2)\n \n   /* For \"{{0, +, 2}_1, +, 3}_2\" the distance vector is (3, -2).  */\n   dist_v = lambda_vector_new (DDR_NB_LOOPS (ddr));\n-  dist_v[x_1] = int_cst_value (CHREC_RIGHT (c_2));\n-  dist_v[x_2] = -int_cst_value (CHREC_RIGHT (c_1));\n+  v1 = int_cst_value (CHREC_RIGHT (c_1));\n+  v2 = int_cst_value (CHREC_RIGHT (c_2));\n+  cd = gcd (v1, v2);\n+  v1 /= cd;\n+  v2 /= cd;\n+\n+  if (v2 < 0)\n+    {\n+      v2 = -v2;\n+      v1 = -v1;\n+    }\n+\n+  dist_v[x_1] = v2;\n+  dist_v[x_2] = -v1;\n   save_dist_v (ddr, dist_v);\n \n   add_outer_distances (ddr, dist_v, x_1);"}]}