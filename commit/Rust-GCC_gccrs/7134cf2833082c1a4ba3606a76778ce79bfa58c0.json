{"sha": "7134cf2833082c1a4ba3606a76778ce79bfa58c0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzEzNGNmMjgzMzA4MmMxYTRiYTM2MDZhNzY3NzhjZTc5YmZhNThjMA==", "commit": {"author": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2013-02-05T22:22:17Z"}, "committer": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2013-02-05T22:22:17Z"}, "message": "re PR go/56017 (libgo testsuite does not support cross testing)\n\n\tPR go/56017\nlibgo: Use DejaGNU when testing a cross-compiler.\n\nFrom-SVN: r195766", "tree": {"sha": "41af694846a1bfc8719f9e3c0aeb2200cceb969f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/41af694846a1bfc8719f9e3c0aeb2200cceb969f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7134cf2833082c1a4ba3606a76778ce79bfa58c0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7134cf2833082c1a4ba3606a76778ce79bfa58c0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7134cf2833082c1a4ba3606a76778ce79bfa58c0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7134cf2833082c1a4ba3606a76778ce79bfa58c0/comments", "author": null, "committer": null, "parents": [{"sha": "31502f9f1f9095aaa60094385a2e116b03b23804", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/31502f9f1f9095aaa60094385a2e116b03b23804", "html_url": "https://github.com/Rust-GCC/gccrs/commit/31502f9f1f9095aaa60094385a2e116b03b23804"}], "stats": {"total": 38, "additions": 26, "deletions": 12}, "files": [{"sha": "4ba3145daabf317d83f6be8919d83668944fc79a", "filename": "libgo/Makefile.am", "status": "modified", "additions": 1, "deletions": 7, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7134cf2833082c1a4ba3606a76778ce79bfa58c0/libgo%2FMakefile.am", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7134cf2833082c1a4ba3606a76778ce79bfa58c0/libgo%2FMakefile.am", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgo%2FMakefile.am?ref=7134cf2833082c1a4ba3606a76778ce79bfa58c0", "patch": "@@ -1991,12 +1991,6 @@ BUILDPACKAGE = \\\n \tfiles=`echo $^ | sed -e 's/[^ ]*\\.gox//g'`; \\\n \t$(LTGOCOMPILE) -I . -c -fgo-pkgpath=`echo $@ | sed -e 's/.lo$$//' -e 's/-go$$//'` -o $@ $$files\n \n-if LIBGO_IS_RTEMS\n-use_dejagnu = yes\n-else\n-use_dejagnu = no\n-endif\n-\n GOTESTFLAGS =\n \n # Check a package.\n@@ -2015,7 +2009,7 @@ CHECK = \\\n \texport LD_LIBRARY_PATH; \\\n \t$(MKDIR_P) $(@D); \\\n \trm -f $@-testsum $@-testlog; \\\n-\tif test \"$(use_dejagnu)\" = \"yes\"; then \\\n+\tif test \"$(USE_DEJAGNU)\" = \"yes\"; then \\\n \t  $(SHELL) $(srcdir)/testsuite/gotest --dejagnu=yes --basedir=$(srcdir) --srcdir=$(srcdir)/go/$(@D) --pkgpath=\"$(@D)\" --pkgfiles=\"$(go_$(subst /,_,$(@D))_files)\" --testname=\"$(@D)\" --goarch=\"$(GOARCH)\" $(GOTESTFLAGS) $(go_$(subst /,_,$(@D))_test_files); \\\n \telse \\\n \t  if $(SHELL) $(srcdir)/testsuite/gotest --basedir=$(srcdir) --srcdir=$(srcdir)/go/$(@D) --pkgpath=\"$(@D)\" --pkgfiles=\"$(go_$(subst /,_,$(@D))_files)\" --goarch=\"$(GOARCH)\" $(GOTESTFLAGS) $(go_$(subst /,_,$(@D))_test_files) >>$@-testlog 2>&1; then \\"}, {"sha": "1376d566d6ddbb5f6f32f0e8e775817eeb623fee", "filename": "libgo/Makefile.in", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7134cf2833082c1a4ba3606a76778ce79bfa58c0/libgo%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7134cf2833082c1a4ba3606a76778ce79bfa58c0/libgo%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgo%2FMakefile.in?ref=7134cf2833082c1a4ba3606a76778ce79bfa58c0", "patch": "@@ -359,6 +359,7 @@ SPLIT_STACK = @SPLIT_STACK@\n STRINGOPS_FLAG = @STRINGOPS_FLAG@\n STRIP = @STRIP@\n STRUCT_EPOLL_EVENT_FD_OFFSET = @STRUCT_EPOLL_EVENT_FD_OFFSET@\n+USE_DEJAGNU = @USE_DEJAGNU@\n VERSION = @VERSION@\n WARN_FLAGS = @WARN_FLAGS@\n WERROR = @WERROR@\n@@ -2107,8 +2108,6 @@ BUILDPACKAGE = \\\n \tfiles=`echo $^ | sed -e 's/[^ ]*\\.gox//g'`; \\\n \t$(LTGOCOMPILE) -I . -c -fgo-pkgpath=`echo $@ | sed -e 's/.lo$$//' -e 's/-go$$//'` -o $@ $$files\n \n-@LIBGO_IS_RTEMS_FALSE@use_dejagnu = no\n-@LIBGO_IS_RTEMS_TRUE@use_dejagnu = yes\n GOTESTFLAGS = \n \n # Check a package.\n@@ -2127,7 +2126,7 @@ CHECK = \\\n \texport LD_LIBRARY_PATH; \\\n \t$(MKDIR_P) $(@D); \\\n \trm -f $@-testsum $@-testlog; \\\n-\tif test \"$(use_dejagnu)\" = \"yes\"; then \\\n+\tif test \"$(USE_DEJAGNU)\" = \"yes\"; then \\\n \t  $(SHELL) $(srcdir)/testsuite/gotest --dejagnu=yes --basedir=$(srcdir) --srcdir=$(srcdir)/go/$(@D) --pkgpath=\"$(@D)\" --pkgfiles=\"$(go_$(subst /,_,$(@D))_files)\" --testname=\"$(@D)\" --goarch=\"$(GOARCH)\" $(GOTESTFLAGS) $(go_$(subst /,_,$(@D))_test_files); \\\n \telse \\\n \t  if $(SHELL) $(srcdir)/testsuite/gotest --basedir=$(srcdir) --srcdir=$(srcdir)/go/$(@D) --pkgpath=\"$(@D)\" --pkgfiles=\"$(go_$(subst /,_,$(@D))_files)\" --goarch=\"$(GOARCH)\" $(GOTESTFLAGS) $(go_$(subst /,_,$(@D))_test_files) >>$@-testlog 2>&1; then \\"}, {"sha": "c3b41cf61af400f7d7444ab0d5a0d3eb4638fbff", "filename": "libgo/configure", "status": "modified", "additions": 11, "deletions": 2, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7134cf2833082c1a4ba3606a76778ce79bfa58c0/libgo%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7134cf2833082c1a4ba3606a76778ce79bfa58c0/libgo%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgo%2Fconfigure?ref=7134cf2833082c1a4ba3606a76778ce79bfa58c0", "patch": "@@ -653,6 +653,7 @@ LIBGO_IS_ALPHA_FALSE\n LIBGO_IS_ALPHA_TRUE\n LIBGO_IS_386_FALSE\n LIBGO_IS_386_TRUE\n+USE_DEJAGNU\n GOOS\n LIBGO_IS_SOLARIS_FALSE\n LIBGO_IS_SOLARIS_TRUE\n@@ -11104,7 +11105,7 @@ else\n   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2\n   lt_status=$lt_dlunknown\n   cat > conftest.$ac_ext <<_LT_EOF\n-#line 11107 \"configure\"\n+#line 11108 \"configure\"\n #include \"confdefs.h\"\n \n #if HAVE_DLFCN_H\n@@ -11210,7 +11211,7 @@ else\n   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2\n   lt_status=$lt_dlunknown\n   cat > conftest.$ac_ext <<_LT_EOF\n-#line 11213 \"configure\"\n+#line 11214 \"configure\"\n #include \"confdefs.h\"\n \n #if HAVE_DLFCN_H\n@@ -13562,6 +13563,14 @@ fi\n \n \n \n+USE_DEJAGNU=no\n+case ${host} in\n+  *-*-rtems*) USE_DEJAGNU=yes ;;\n+  ${target}) ;;\n+  *) USE_DEJAGNU=yes ;;\n+esac\n+\n+\n is_386=no\n is_alpha=no\n is_arm=no"}, {"sha": "761fb82c5db9c271a0f8a7547d5834e35243b43a", "filename": "libgo/configure.ac", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7134cf2833082c1a4ba3606a76778ce79bfa58c0/libgo%2Fconfigure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7134cf2833082c1a4ba3606a76778ce79bfa58c0/libgo%2Fconfigure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgo%2Fconfigure.ac?ref=7134cf2833082c1a4ba3606a76778ce79bfa58c0", "patch": "@@ -156,6 +156,17 @@ AM_CONDITIONAL(LIBGO_IS_RTEMS, test $is_rtems = yes)\n AM_CONDITIONAL(LIBGO_IS_SOLARIS, test $is_solaris = yes)\n AC_SUBST(GOOS)\n \n+dnl Test whether we need to use DejaGNU or whether we can use the\n+dnl simpler gotest approach.  We can only use gotest for a native\n+dnl build.\n+USE_DEJAGNU=no\n+case ${host} in\n+  *-*-rtems*) USE_DEJAGNU=yes ;;\n+  ${target}) ;;\n+  *) USE_DEJAGNU=yes ;;\n+esac\n+AC_SUBST(USE_DEJAGNU)\n+\n dnl N.B. Keep in sync with gcc/testsuite/go.test/go-test.exp (go-set-goarch).\n is_386=no\n is_alpha=no"}, {"sha": "8f0e2ad9337d8f5b75df39c758bba48781a20408", "filename": "libgo/testsuite/Makefile.in", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7134cf2833082c1a4ba3606a76778ce79bfa58c0/libgo%2Ftestsuite%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7134cf2833082c1a4ba3606a76778ce79bfa58c0/libgo%2Ftestsuite%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgo%2Ftestsuite%2FMakefile.in?ref=7134cf2833082c1a4ba3606a76778ce79bfa58c0", "patch": "@@ -137,6 +137,7 @@ SPLIT_STACK = @SPLIT_STACK@\n STRINGOPS_FLAG = @STRINGOPS_FLAG@\n STRIP = @STRIP@\n STRUCT_EPOLL_EVENT_FD_OFFSET = @STRUCT_EPOLL_EVENT_FD_OFFSET@\n+USE_DEJAGNU = @USE_DEJAGNU@\n VERSION = @VERSION@\n WARN_FLAGS = @WARN_FLAGS@\n WERROR = @WERROR@"}]}