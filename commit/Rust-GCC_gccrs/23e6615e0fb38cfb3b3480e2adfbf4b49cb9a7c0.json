{"sha": "23e6615e0fb38cfb3b3480e2adfbf4b49cb9a7c0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjNlNjYxNWUwZmIzOGNmYjNiMzQ4MGUyYWRmYmY0YjQ5Y2I5YTdjMA==", "commit": {"author": {"name": "Robert Dewar", "email": "dewar@adacore.com", "date": "2008-05-20T12:47:49Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2008-05-20T12:47:49Z"}, "message": "opt.ads (Treat_Restrictions_As_Warnings): New switch\n\n2008-05-20  Robert Dewar  <dewar@adacore.com>\n\n\t* opt.ads (Treat_Restrictions_As_Warnings): New switch\n\n\t* sem_prag.adb, par-prag.adb, restrict.ads: Implement flag\n\tTreat_Restrictions_As_Warnings.\n\n\t* switch-c.adb: Recognize new switch -gnatr\n\n\t* usage.adb: Add line for -gnatr\n\nFrom-SVN: r135632", "tree": {"sha": "6057e60f87f368caaf3ed4d9c6a0825c0c9f954d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6057e60f87f368caaf3ed4d9c6a0825c0c9f954d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/23e6615e0fb38cfb3b3480e2adfbf4b49cb9a7c0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/23e6615e0fb38cfb3b3480e2adfbf4b49cb9a7c0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/23e6615e0fb38cfb3b3480e2adfbf4b49cb9a7c0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/23e6615e0fb38cfb3b3480e2adfbf4b49cb9a7c0/comments", "author": null, "committer": null, "parents": [{"sha": "604b5bcb1780cb0cb7c0ed24f2f2ce6e0545322d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/604b5bcb1780cb0cb7c0ed24f2f2ce6e0545322d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/604b5bcb1780cb0cb7c0ed24f2f2ce6e0545322d"}], "stats": {"total": 56, "additions": 41, "deletions": 15}, "files": [{"sha": "600231c737aca1945c6998ccf4982b729a33a4c7", "filename": "gcc/ada/opt.ads", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/23e6615e0fb38cfb3b3480e2adfbf4b49cb9a7c0/gcc%2Fada%2Fopt.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/23e6615e0fb38cfb3b3480e2adfbf4b49cb9a7c0/gcc%2Fada%2Fopt.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fopt.ads?ref=23e6615e0fb38cfb3b3480e2adfbf4b49cb9a7c0", "patch": "@@ -1108,6 +1108,11 @@ package Opt is\n    --  Tolerate time stamp and other consistency errors. If this flag is set to\n    --  True (-t), then inconsistencies result in warnings rather than errors.\n \n+   Treat_Restrictions_As_Warnings : Boolean := False;\n+   --  GNAT\n+   --  Set True to treat pragma Restrictions as Restriction_Warnings. Set by\n+   --  -gnatr switch.\n+\n    Tree_Output : Boolean := False;\n    --  GNAT\n    --  Set to True (-gnatt) to generate output tree file"}, {"sha": "c8b84ab189e61006860bcd7cf007b027bf49464f", "filename": "gcc/ada/par-prag.adb", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/23e6615e0fb38cfb3b3480e2adfbf4b49cb9a7c0/gcc%2Fada%2Fpar-prag.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/23e6615e0fb38cfb3b3480e2adfbf4b49cb9a7c0/gcc%2Fada%2Fpar-prag.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fpar-prag.adb?ref=23e6615e0fb38cfb3b3480e2adfbf4b49cb9a7c0", "patch": "@@ -234,7 +234,8 @@ function Prag (Pragma_Node : Node_Id; Semi : Source_Ptr) return Node_Id is\n          elsif Id = Name_No_Dependence then\n             Set_Restriction_No_Dependence\n               (Unit => Expr,\n-               Warn => Prag_Id = Pragma_Restriction_Warnings);\n+               Warn => Prag_Id = Pragma_Restriction_Warnings\n+                         or else Treat_Restrictions_As_Warnings);\n          end if;\n \n          Next (Arg);"}, {"sha": "fbc8a8a54f8041f0bd5e0ecb91c07046672ed99b", "filename": "gcc/ada/restrict.ads", "status": "modified", "additions": 10, "deletions": 7, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/23e6615e0fb38cfb3b3480e2adfbf4b49cb9a7c0/gcc%2Fada%2Frestrict.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/23e6615e0fb38cfb3b3480e2adfbf4b49cb9a7c0/gcc%2Fada%2Frestrict.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Frestrict.ads?ref=23e6615e0fb38cfb3b3480e2adfbf4b49cb9a7c0", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 S p e c                                  --\n --                                                                          --\n---          Copyright (C) 1992-2007, Free Software Foundation, Inc.         --\n+--          Copyright (C) 1992-2008, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -277,11 +277,12 @@ package Restrict is\n      (P    : Profile_Name;\n       N    : Node_Id;\n       Warn : Boolean);\n-   --  Sets the set of restrictions associated with the given profile\n-   --  name. N is the node of the construct to which error messages\n-   --  are to be attached as required. Warn is set True for the case\n-   --  of Profile_Warnings where the restrictions are set as warnings\n-   --  rather than legality requirements.\n+   --  Sets the set of restrictions associated with the given profile name. N\n+   --  is the node of the construct to which error messages are to be attached\n+   --  as required. Warn is set True for the case of Profile_Warnings where the\n+   --  restrictions are set as warnings rather than legality requirements, and\n+   --  is also True for Profile if the Treat_Restrictions_As_Warnings flag is\n+   --  set. It is false for Profile if this flag is not set.\n \n    procedure Set_Restriction\n      (R : All_Boolean_Restrictions;\n@@ -301,7 +302,9 @@ package Restrict is\n      (Unit : Node_Id;\n       Warn : Boolean);\n    --  Sets given No_Dependence restriction in table if not there already.\n-   --  Warn is True if from Restriction_Warnings, False if from Restrictions.\n+   --  Warn is True if from Restriction_Warnings, or for Restrictions if flag\n+   --  Treat_Restrictions_As_Warnings is set. False if from Restrictions and\n+   --  this flag is not set.\n \n    function Tasking_Allowed return Boolean;\n    pragma Inline (Tasking_Allowed);"}, {"sha": "15f4e181f7a1c79a8bbb81f6b00abbdf567892e2", "filename": "gcc/ada/sem_prag.adb", "status": "modified", "additions": 11, "deletions": 5, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/23e6615e0fb38cfb3b3480e2adfbf4b49cb9a7c0/gcc%2Fada%2Fsem_prag.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/23e6615e0fb38cfb3b3480e2adfbf4b49cb9a7c0/gcc%2Fada%2Fsem_prag.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_prag.adb?ref=23e6615e0fb38cfb3b3480e2adfbf4b49cb9a7c0", "patch": "@@ -671,7 +671,9 @@ package body Sem_Prag is\n \n       procedure Process_Restrictions_Or_Restriction_Warnings (Warn : Boolean);\n       --  Common processing for Restrictions and Restriction_Warnings pragmas.\n-      --  Warn is False for Restrictions, True for Restriction_Warnings.\n+      --  Warn is True for Restriction_Warnings, or for Restrictions if the\n+      --  flag Treat_Restrictions_As_Warnings is set, and False if this flag\n+      --  is not set in the Restrictions case.\n \n       procedure Process_Suppress_Unsuppress (Suppress_Case : Boolean);\n       --  Common processing for Suppress and Unsuppress. The boolean parameter\n@@ -4770,7 +4772,8 @@ package body Sem_Prag is\n \n          --  Set the corresponding restrictions\n \n-         Set_Profile_Restrictions (Ravenscar, N, Warn => False);\n+         Set_Profile_Restrictions\n+           (Ravenscar, N, Warn => Treat_Restrictions_As_Warnings);\n       end Set_Ravenscar_Profile;\n \n    --  Start of processing for Analyze_Pragma\n@@ -9790,7 +9793,8 @@ package body Sem_Prag is\n                if Chars (Argx) = Name_Ravenscar then\n                   Set_Ravenscar_Profile (N);\n                elsif Chars (Argx) = Name_Restricted then\n-                  Set_Profile_Restrictions (Restricted, N, Warn => False);\n+                  Set_Profile_Restrictions\n+                    (Restricted, N, Warn => Treat_Restrictions_As_Warnings);\n                else\n                   Error_Pragma_Arg (\"& is not a valid profile\", Argx);\n                end if;\n@@ -10285,7 +10289,8 @@ package body Sem_Prag is\n             GNAT_Pragma;\n             Check_Arg_Count (0);\n             Check_Valid_Configuration_Pragma;\n-            Set_Profile_Restrictions (Restricted, N, Warn => False);\n+            Set_Profile_Restrictions\n+              (Restricted, N, Warn => Treat_Restrictions_As_Warnings);\n \n             if Warn_On_Obsolescent_Feature then\n                Error_Msg_N\n@@ -10305,7 +10310,8 @@ package body Sem_Prag is\n          --  | restriction_parameter_IDENTIFIER => EXPRESSION\n \n          when Pragma_Restrictions =>\n-            Process_Restrictions_Or_Restriction_Warnings (Warn => False);\n+            Process_Restrictions_Or_Restriction_Warnings\n+              (Warn => Treat_Restrictions_As_Warnings);\n \n          --------------------------\n          -- Restriction_Warnings --"}, {"sha": "cf59c8198cdcf4f615402d3b68e08d16604d805c", "filename": "gcc/ada/switch-c.adb", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/23e6615e0fb38cfb3b3480e2adfbf4b49cb9a7c0/gcc%2Fada%2Fswitch-c.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/23e6615e0fb38cfb3b3480e2adfbf4b49cb9a7c0/gcc%2Fada%2Fswitch-c.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fswitch-c.adb?ref=23e6615e0fb38cfb3b3480e2adfbf4b49cb9a7c0", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 B o d y                                  --\n --                                                                          --\n---          Copyright (C) 2001-2007, Free Software Foundation, Inc.         --\n+--          Copyright (C) 2001-2008, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -660,13 +660,19 @@ package body Switch.C is\n                Ptr := Ptr + 1;\n                Try_Semantics := True;\n \n-            --  Processing for q switch\n+            --  Processing for Q switch\n \n             when 'Q' =>\n                Ptr := Ptr + 1;\n                Force_ALI_Tree_File := True;\n                Try_Semantics := True;\n \n+               --  Processing for r switch\n+\n+            when 'r' =>\n+               Ptr := Ptr + 1;\n+               Treat_Restrictions_As_Warnings := True;\n+\n             --  Processing for R switch\n \n             when 'R' =>"}, {"sha": "5a1f4827eabc023fdeb4e9216c3623bda58deb7a", "filename": "gcc/ada/usage.adb", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/23e6615e0fb38cfb3b3480e2adfbf4b49cb9a7c0/gcc%2Fada%2Fusage.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/23e6615e0fb38cfb3b3480e2adfbf4b49cb9a7c0/gcc%2Fada%2Fusage.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fusage.adb?ref=23e6615e0fb38cfb3b3480e2adfbf4b49cb9a7c0", "patch": "@@ -289,6 +289,11 @@ begin\n    Write_Switch_Char (\"Q\");\n    Write_Line (\"Don't quit, write ali/tree file even if compile errors\");\n \n+   --  Line for -gnatr switch\n+\n+   Write_Switch_Char (\"r\");\n+   Write_Line (\"Treat pragma Restrictions as Restriction_Warnings\");\n+\n    --  Lines for -gnatR switch\n \n    Write_Switch_Char (\"R?\");"}]}