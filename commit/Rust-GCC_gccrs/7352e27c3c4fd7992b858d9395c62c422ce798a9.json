{"sha": "7352e27c3c4fd7992b858d9395c62c422ce798a9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzM1MmUyN2MzYzRmZDc5OTJiODU4ZDkzOTVjNjJjNDIyY2U3OThhOQ==", "commit": {"author": {"name": "Andrew Pinski", "email": "andrew_pinski@playstation.sony.com", "date": "2008-08-05T18:23:07Z"}, "committer": {"name": "Andrew Pinski", "email": "pinskia@gcc.gnu.org", "date": "2008-08-05T18:23:07Z"}, "message": "re PR tree-optimization/37024 (bad tail call from tuples merge)\n\n2008-08-05  Andrew Pinski  <andrew_pinski@playstation.sony.com>\n\n        PR tree-opt/37024\n        * tree-tailcall.c (process_assignment): Use gimple_assign_cast_p \n        instead of IS_CONVERT_EXPR_CODE_P for seeing if the assignment\n        is a conversion.\n\n2008-08-05  Andrew Pinski  <andrew_pinski@playstation.sony.com>\n\n        PR tree-opt/37024\n        * gcc.dg/tree-ssa/tailcall-4.c: New testcase.\n\nFrom-SVN: r138735", "tree": {"sha": "8ef4ec677c22f7569e7770bf72c3cc4a2a6bed5d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8ef4ec677c22f7569e7770bf72c3cc4a2a6bed5d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7352e27c3c4fd7992b858d9395c62c422ce798a9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7352e27c3c4fd7992b858d9395c62c422ce798a9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7352e27c3c4fd7992b858d9395c62c422ce798a9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7352e27c3c4fd7992b858d9395c62c422ce798a9/comments", "author": null, "committer": null, "parents": [{"sha": "d4ea462245cd9d967dce805b8b97ffe10ee30c3e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d4ea462245cd9d967dce805b8b97ffe10ee30c3e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d4ea462245cd9d967dce805b8b97ffe10ee30c3e"}], "stats": {"total": 30, "additions": 29, "deletions": 1}, "files": [{"sha": "cdc4d87d10749e5cabcf8306356b905659313eb5", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7352e27c3c4fd7992b858d9395c62c422ce798a9/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7352e27c3c4fd7992b858d9395c62c422ce798a9/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=7352e27c3c4fd7992b858d9395c62c422ce798a9", "patch": "@@ -1,3 +1,10 @@\n+2008-08-05  Andrew Pinski  <andrew_pinski@playstation.sony.com>\n+\n+\tPR tree-opt/37024\n+\t* tree-tailcall.c (process_assignment): Use gimple_assign_cast_p\n+\tinstead of IS_CONVERT_EXPR_CODE_P for seeing if the assignment\n+\tis a conversion.\n+\n 2008-08-05  Richard Henderson  <rth@redhat.com>\n \n \t* Makefile.in (c-cppbuiltin.o): Depend on debug.h."}, {"sha": "aae61b48eabc0688ea51e6bfc7d8d72f5ed5c62d", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7352e27c3c4fd7992b858d9395c62c422ce798a9/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7352e27c3c4fd7992b858d9395c62c422ce798a9/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=7352e27c3c4fd7992b858d9395c62c422ce798a9", "patch": "@@ -1,3 +1,8 @@\n+2008-08-05  Andrew Pinski  <andrew_pinski@playstation.sony.com>\n+\n+\tPR tree-opt/37024\n+\t* gcc.dg/tree-ssa/tailcall-4.c: New testcase.\n+\n 2008-08-05  Richard Guenther  <rguenther@suse.de>\n \n \tPR middle-end/37026"}, {"sha": "e7983da31da7b7a042283d81ccb408163987dea9", "filename": "gcc/testsuite/gcc.dg/tree-ssa/tailcall-4.c", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7352e27c3c4fd7992b858d9395c62c422ce798a9/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Ftailcall-4.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7352e27c3c4fd7992b858d9395c62c422ce798a9/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Ftailcall-4.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Ftailcall-4.c?ref=7352e27c3c4fd7992b858d9395c62c422ce798a9", "patch": "@@ -0,0 +1,16 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -fdump-tree-tailc-details\" } */\n+/* PR tree-opt/37024 */\n+\n+double doubleValue();\n+\n+long\n+longValue ()\n+{\n+ return (long) doubleValue ();\n+}\n+\n+/* We should not tail call doubleValue in longValue as the mode changes. */\n+/* { dg-final { scan-tree-dump-times \"Found tail call\" 0 \"tailc\"} } */\n+/* { dg-final { cleanup-tree-dump \"tailc\" } } */\n+"}, {"sha": "935b41941a02655c6a54392a4c9a899b3e1c6f5a", "filename": "gcc/tree-tailcall.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7352e27c3c4fd7992b858d9395c62c422ce798a9/gcc%2Ftree-tailcall.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7352e27c3c4fd7992b858d9395c62c422ce798a9/gcc%2Ftree-tailcall.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-tailcall.c?ref=7352e27c3c4fd7992b858d9395c62c422ce798a9", "patch": "@@ -283,7 +283,7 @@ process_assignment (gimple stmt, gimple_stmt_iterator call, tree *m,\n     {\n       /* Reject a tailcall if the type conversion might need\n \t additional code.  */\n-      if (IS_CONVERT_EXPR_CODE_P (code)\n+      if (gimple_assign_cast_p (stmt)\n \t  && TYPE_MODE (TREE_TYPE (dest)) != TYPE_MODE (TREE_TYPE (src_var)))\n \treturn false;\n "}]}