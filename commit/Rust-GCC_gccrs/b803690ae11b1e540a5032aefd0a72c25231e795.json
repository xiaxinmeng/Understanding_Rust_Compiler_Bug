{"sha": "b803690ae11b1e540a5032aefd0a72c25231e795", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjgwMzY5MGFlMTFiMWU1NDBhNTAzMmFlZmQwYTcyYzI1MjMxZTc5NQ==", "commit": {"author": {"name": "Paul Thomas", "email": "pault@gcc.gnu.org", "date": "2008-10-12T10:46:14Z"}, "committer": {"name": "Paul Thomas", "email": "pault@gcc.gnu.org", "date": "2008-10-12T10:46:14Z"}, "message": "re PR fortran/37787 (right-left hand side overlap not recognized with EQUIVALENCEd array assignment)\n\n2008-10-12  Paul Thomas  <pault@gcc.gnu.org>\n\n\tPR fortran/37787\n\t* dependency.c (gfc_are_equivalenced_arrays): Look in symbol\n\tnamespace rather than current namespace, if it is available.\n\n2008-10-12  Paul Thomas  <pault@gcc.gnu.org>\n\n\tPR fortran/37787\n\t* gfortran.dg/module_equivalence_5.f90: New test.\n\nFrom-SVN: r141073", "tree": {"sha": "4cccc34e283e4cc8dfb62af0d5b64fde03d0a90f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4cccc34e283e4cc8dfb62af0d5b64fde03d0a90f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b803690ae11b1e540a5032aefd0a72c25231e795", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b803690ae11b1e540a5032aefd0a72c25231e795", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b803690ae11b1e540a5032aefd0a72c25231e795", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b803690ae11b1e540a5032aefd0a72c25231e795/comments", "author": null, "committer": null, "parents": [{"sha": "7a99defe0dbef55bcbcf2df076a896cc0e7e6658", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7a99defe0dbef55bcbcf2df076a896cc0e7e6658", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7a99defe0dbef55bcbcf2df076a896cc0e7e6658"}], "stats": {"total": 53, "additions": 52, "deletions": 1}, "files": [{"sha": "ac1eaf63bcf54773dd0254e99fef409bf2ecf9b8", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b803690ae11b1e540a5032aefd0a72c25231e795/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b803690ae11b1e540a5032aefd0a72c25231e795/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=b803690ae11b1e540a5032aefd0a72c25231e795", "patch": "@@ -1,3 +1,9 @@\n+2008-10-12  Paul Thomas  <pault@gcc.gnu.org>\n+\n+\tPR fortran/37787\n+\t* dependency.c (gfc_are_equivalenced_arrays): Look in symbol\n+\tnamespace rather than current namespace, if it is available.\n+\n 2008-10-12  Steven G. Kargl  <kargls@comcast.net>\n \n \tPR fortran/37792"}, {"sha": "05a3dccf1a97d9c74d5bcc19a220022a221f8bbb", "filename": "gcc/fortran/dependency.c", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b803690ae11b1e540a5032aefd0a72c25231e795/gcc%2Ffortran%2Fdependency.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b803690ae11b1e540a5032aefd0a72c25231e795/gcc%2Ffortran%2Fdependency.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fdependency.c?ref=b803690ae11b1e540a5032aefd0a72c25231e795", "patch": "@@ -547,10 +547,16 @@ gfc_are_equivalenced_arrays (gfc_expr *e1, gfc_expr *e2)\n       || !e2->symtree->n.sym->attr.in_equivalence|| !e1->rank || !e2->rank)\n     return 0;\n \n+  if (e1->symtree->n.sym->ns\n+\t&& e1->symtree->n.sym->ns != gfc_current_ns)\n+    l = e1->symtree->n.sym->ns->equiv_lists;\n+  else\n+    l = gfc_current_ns->equiv_lists;\n+\n   /* Go through the equiv_lists and return 1 if the variables\n      e1 and e2 are members of the same group and satisfy the\n      requirement on their relative offsets.  */\n-  for (l = gfc_current_ns->equiv_lists; l; l = l->next)\n+  for (; l; l = l->next)\n     {\n       fl1 = NULL;\n       fl2 = NULL;"}, {"sha": "81512ef1e693731a0414768d817d40e17304bc5c", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b803690ae11b1e540a5032aefd0a72c25231e795/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b803690ae11b1e540a5032aefd0a72c25231e795/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=b803690ae11b1e540a5032aefd0a72c25231e795", "patch": "@@ -1,3 +1,8 @@\n+2008-10-12  Paul Thomas  <pault@gcc.gnu.org>\n+\n+\tPR fortran/37787\n+\t* gfortran.dg/module_equivalence_5.f90: New test.\n+\n 2008-10-12  Steven G. Kargl  <kargls@comcast.net>\n \n \tPR fortran/37792"}, {"sha": "de1d5043d79e56967920a0d25b4333338bfffec5", "filename": "gcc/testsuite/gfortran.dg/module_equivalence_5.f90", "status": "added", "additions": 34, "deletions": 0, "changes": 34, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b803690ae11b1e540a5032aefd0a72c25231e795/gcc%2Ftestsuite%2Fgfortran.dg%2Fmodule_equivalence_5.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b803690ae11b1e540a5032aefd0a72c25231e795/gcc%2Ftestsuite%2Fgfortran.dg%2Fmodule_equivalence_5.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fmodule_equivalence_5.f90?ref=b803690ae11b1e540a5032aefd0a72c25231e795", "patch": "@@ -0,0 +1,34 @@\n+! { dg-do run }\n+!\n+! Fixes PR37787 where the EQUIVALENCE between QLA1 and QLA2 wasn't recognized\n+! in the dependency checking because the compiler was looking in the wrong name\n+! space.\n+!\n+! Contributed by Dick Hendrickson <dick.hendrickson@gmail.com>\n+!\n+module stuff\n+  integer, parameter :: r4_kv = 4\n+contains\n+\n+  SUBROUTINE CF0004\n+!  COPYRIGHT 1999   SPACKMAN & HENDRICKSON, INC.\n+    REAL(R4_KV), dimension (10) :: QLA1, QLA2, QLA3, &\n+                                   QCA = (/(i, i= 1, 10)/)\n+    EQUIVALENCE (QLA1, QLA2)\n+    QLA1 = QCA\n+    QLA3 = QCA\n+    QLA3( 2:10:3) = QCA ( 1:5:2) + 1\n+    QLA1( 2:10:3) = QLA2( 1:5:2) + 1  !failed because of dependency\n+    if (any (qla1 .ne. qla3)) call abort\n+  END SUBROUTINE\n+end module\n+\n+program try_cf004\n+  use stuff\n+  nf1 = 1\n+  nf2 = 2\n+  call cf0004\n+end\n+\n+! { dg-final { cleanup-modules \"stuff\" } }\n+"}]}