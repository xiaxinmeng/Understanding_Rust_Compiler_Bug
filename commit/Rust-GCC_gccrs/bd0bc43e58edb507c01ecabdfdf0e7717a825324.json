{"sha": "bd0bc43e58edb507c01ecabdfdf0e7717a825324", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmQwYmM0M2U1OGVkYjUwN2MwMWVjYWJkZmRmMGU3NzE3YTgyNTMyNA==", "commit": {"author": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2011-09-02T07:10:07Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2011-09-02T07:10:07Z"}, "message": "[multiple changes]\n\n2011-09-02  Ed Schonberg  <schonberg@adacore.com>\n\n\t* sem_ch10.adb (Analyze_With_Clause): If the library unit\n\tis the generated subprogram declaration for a child unit body\n\tthat acts as spec, use the original body in the with_clause,\n\tto prevent binding errors.\n\n2011-09-02  Vincent Celier  <celier@adacore.com>\n\n\t* gnat_ugn.texi: Adapt documentation of -gnateInnn to new VMS\n\tqualifier /MULTI_UNIT_INDEX=\n\n2011-09-02  Johannes Kanig  <kanig@adacore.com>\n\n\t* g-comlin.adb (Getopt): Return when switch is dealt with automatically,\n\tinstead of calling the callback function\n\nFrom-SVN: r178435", "tree": {"sha": "912a34c00bd350df63b1b3b2de596bb767cf8687", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/912a34c00bd350df63b1b3b2de596bb767cf8687"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bd0bc43e58edb507c01ecabdfdf0e7717a825324", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bd0bc43e58edb507c01ecabdfdf0e7717a825324", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bd0bc43e58edb507c01ecabdfdf0e7717a825324", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bd0bc43e58edb507c01ecabdfdf0e7717a825324/comments", "author": null, "committer": null, "parents": [{"sha": "9fdb5d2171b7104581e0e80bfb8f527d37d93fcd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9fdb5d2171b7104581e0e80bfb8f527d37d93fcd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9fdb5d2171b7104581e0e80bfb8f527d37d93fcd"}], "stats": {"total": 44, "additions": 40, "deletions": 4}, "files": [{"sha": "4ab69228bbbd5d7d05aeceb4bdfe35b4fcfd2411", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bd0bc43e58edb507c01ecabdfdf0e7717a825324/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bd0bc43e58edb507c01ecabdfdf0e7717a825324/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=bd0bc43e58edb507c01ecabdfdf0e7717a825324", "patch": "@@ -1,3 +1,20 @@\n+2011-09-02  Ed Schonberg  <schonberg@adacore.com>\n+\n+\t* sem_ch10.adb (Analyze_With_Clause): If the library unit\n+\tis the generated subprogram declaration for a child unit body\n+\tthat acts as spec, use the original body in the with_clause,\n+\tto prevent binding errors.\n+\n+2011-09-02  Vincent Celier  <celier@adacore.com>\n+\n+\t* gnat_ugn.texi: Adapt documentation of -gnateInnn to new VMS\n+\tqualifier /MULTI_UNIT_INDEX=\n+\n+2011-09-02  Johannes Kanig  <kanig@adacore.com>\n+\n+\t* g-comlin.adb (Getopt): Return when switch is dealt with automatically,\n+\tinstead of calling the callback function\n+\n 2011-09-02  Robert Dewar  <dewar@adacore.com>\n \n \t* prj-proc.adb, prj.ads, sem_util.adb, s-taprop-linux.adb,"}, {"sha": "43a6524eb61d610cd9921d7792bb0f7592f6924c", "filename": "gcc/ada/g-comlin.adb", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bd0bc43e58edb507c01ecabdfdf0e7717a825324/gcc%2Fada%2Fg-comlin.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bd0bc43e58edb507c01ecabdfdf0e7717a825324/gcc%2Fada%2Fg-comlin.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fg-comlin.adb?ref=bd0bc43e58edb507c01ecabdfdf0e7717a825324", "patch": "@@ -3290,11 +3290,14 @@ package body GNAT.Command_Line is\n                           with \"Expected integer parameter for '\"\n                             & Switch & \"'\";\n                   end;\n+                  return;\n \n                when Switch_String =>\n                   Free (Config.Switches (Index).String_Output.all);\n                   Config.Switches (Index).String_Output.all :=\n                     new String'(Parameter);\n+                  return;\n+\n             end case;\n          end if;\n "}, {"sha": "f1b21637d1b06df5519a9a1fae9dc67fdc4b1492", "filename": "gcc/ada/g-comlin.ads", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bd0bc43e58edb507c01ecabdfdf0e7717a825324/gcc%2Fada%2Fg-comlin.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bd0bc43e58edb507c01ecabdfdf0e7717a825324/gcc%2Fada%2Fg-comlin.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fg-comlin.ads?ref=bd0bc43e58edb507c01ecabdfdf0e7717a825324", "patch": "@@ -707,7 +707,8 @@ package GNAT.Command_Line is\n       Callback : Switch_Handler := null;\n       Parser   : Opt_Parser := Command_Line_Parser);\n    --  Similar to the standard Getopt function.\n-   --  For each switch found on the command line, this calls Callback.\n+   --  For each switch found on the command line, this calls Callback, if the\n+   --  switch is not handled automatically.\n    --\n    --  The list of valid switches are the ones from the configuration. The\n    --  switches that were declared through Define_Switch with an Output"}, {"sha": "145c66ea8e0476223530c336b7b0ebfc4c34aac8", "filename": "gcc/ada/gnat_ugn.texi", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bd0bc43e58edb507c01ecabdfdf0e7717a825324/gcc%2Fada%2Fgnat_ugn.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bd0bc43e58edb507c01ecabdfdf0e7717a825324/gcc%2Fada%2Fgnat_ugn.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgnat_ugn.texi?ref=bd0bc43e58edb507c01ecabdfdf0e7717a825324", "patch": "@@ -4130,11 +4130,11 @@ Display full source path name in brief error messages.\n @cindex @option{-gnateG} (@command{gcc})\n Save result of preprocessing in a text file.\n \n-@item -gnateInnn\n+@item ^-gnateI^/MULTI_UNIT_INDEX=^@var{nnn}\n @cindex @option{-gnateI} (@command{gcc})\n Indicates that the source is a multi-unit source and that the index of the\n-unit to compile is nnn. nnn needs to be a positive number and need to\n-be a valid index in the multi-unit source.\n+unit to compile is @var{nnn}. @var{nnn} needs to be a positive number and need\n+to be a valid index in the multi-unit source.\n \n @item -gnatem=@var{path}\n @cindex @option{-gnatem} (@command{gcc})"}, {"sha": "a0f0a798858ab963bc1aa998bdf7dc0341586ecd", "filename": "gcc/ada/sem_ch10.adb", "status": "modified", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bd0bc43e58edb507c01ecabdfdf0e7717a825324/gcc%2Fada%2Fsem_ch10.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bd0bc43e58edb507c01ecabdfdf0e7717a825324/gcc%2Fada%2Fsem_ch10.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch10.adb?ref=bd0bc43e58edb507c01ecabdfdf0e7717a825324", "patch": "@@ -2536,6 +2536,21 @@ package body Sem_Ch10 is\n          --  Child unit in a with clause\n \n          Change_Selected_Component_To_Expanded_Name (Name (N));\n+\n+         --  If this is a child unit without a spec, and it has benn analyzed\n+         --  already, a declaration has been created for it. The with_clause\n+         --  must reflect the actual body, and not the generated declaration,\n+         --  to prevent spurious binding errors involving an out-of-date spec.\n+         --  Note that this can only happen if the unit includes more than one\n+         --  with_clause for the child unit (e.g. in separate subunits).\n+\n+         if Unit_Kind = N_Subprogram_Declaration\n+           and then Analyzed (Library_Unit (N))\n+           and then not Comes_From_Source (Library_Unit (N))\n+         then\n+            Set_Library_Unit (N,\n+               Cunit (Get_Source_Unit (Corresponding_Body (U))));\n+         end if;\n       end if;\n \n       --  Restore style checks and restrictions"}]}