{"sha": "8c211c83bba629be6318b5b3fba7137cf633ef9a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OGMyMTFjODNiYmE2MjliZTYzMThiNWIzZmJhNzEzN2NmNjMzZWY5YQ==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2010-10-25T17:26:04Z"}, "committer": {"name": "Eric Botcazou", "email": "ebotcazou@gcc.gnu.org", "date": "2010-10-25T17:26:04Z"}, "message": "decl.c (gnat_to_gnu_entity): Do not set TREE_THIS_NOTRAP on the INDIRECT_REF node built for the template.\n\n\t* gcc-interface/decl.c (gnat_to_gnu_entity) <E_Array_Type>: Do not set\n\tTREE_THIS_NOTRAP on the INDIRECT_REF node built for the template.\n\nFrom-SVN: r165925", "tree": {"sha": "579321e1bafe5b6bd421b4622738b3e8515093cd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/579321e1bafe5b6bd421b4622738b3e8515093cd"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8c211c83bba629be6318b5b3fba7137cf633ef9a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8c211c83bba629be6318b5b3fba7137cf633ef9a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8c211c83bba629be6318b5b3fba7137cf633ef9a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8c211c83bba629be6318b5b3fba7137cf633ef9a/comments", "author": null, "committer": null, "parents": [{"sha": "570f4691719a51481deae0109e358a605dd35604", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/570f4691719a51481deae0109e358a605dd35604", "html_url": "https://github.com/Rust-GCC/gccrs/commit/570f4691719a51481deae0109e358a605dd35604"}], "stats": {"total": 106, "additions": 105, "deletions": 1}, "files": [{"sha": "4ae15c6900794411fca33f5886229a4280fdda97", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8c211c83bba629be6318b5b3fba7137cf633ef9a/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8c211c83bba629be6318b5b3fba7137cf633ef9a/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=8c211c83bba629be6318b5b3fba7137cf633ef9a", "patch": "@@ -1,3 +1,8 @@\n+2010-10-25  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* gcc-interface/decl.c (gnat_to_gnu_entity) <E_Array_Type>: Do not set\n+\tTREE_THIS_NOTRAP on the INDIRECT_REF node built for the template.\n+\n 2010-10-25  Jose Ruiz  <ruiz@adacore.com>\n \n \t* gcc-interface/Makefile.in (LIBGNAT_TARGET_PAIRS for powerpc-linux):"}, {"sha": "b7fe778a2578d6c72641eb9800c363ae4c9c3273", "filename": "gcc/ada/gcc-interface/decl.c", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8c211c83bba629be6318b5b3fba7137cf633ef9a/gcc%2Fada%2Fgcc-interface%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8c211c83bba629be6318b5b3fba7137cf633ef9a/gcc%2Fada%2Fgcc-interface%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgcc-interface%2Fdecl.c?ref=8c211c83bba629be6318b5b3fba7137cf633ef9a", "patch": "@@ -1942,7 +1942,6 @@ gnat_to_gnu_entity (Entity_Id gnat_entity, tree gnu_expr, int definition)\n \tgnu_template_reference\n \t  = build_unary_op (INDIRECT_REF, gnu_template_type, tem);\n \tTREE_READONLY (gnu_template_reference) = 1;\n-\tTREE_THIS_NOTRAP (gnu_template_reference) = 1;\n \n \t/* Now create the GCC type for each index and add the fields for that\n \t   index to the template.  */"}, {"sha": "9255d054a5fdb8fc7751654c36ca57f771956695", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8c211c83bba629be6318b5b3fba7137cf633ef9a/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8c211c83bba629be6318b5b3fba7137cf633ef9a/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=8c211c83bba629be6318b5b3fba7137cf633ef9a", "patch": "@@ -1,3 +1,9 @@\n+2010-10-25  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* gnat.dg/loop_optimization8.adb: New test.\n+\t* gnat.dg/loop_optimization8_pkg1.ad[sb]: New helper.\n+\t* gnat.dg/loop_optimization8_pkg2.ad[sb]: Likewise.\n+\n 2010-10-25  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* gnat.dg/in_out_parameter2.adb: New test."}, {"sha": "6be28f11347effd342b65e102c3b896345f74118", "filename": "gcc/testsuite/gnat.dg/loop_optimization8.adb", "status": "added", "additions": 30, "deletions": 0, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8c211c83bba629be6318b5b3fba7137cf633ef9a/gcc%2Ftestsuite%2Fgnat.dg%2Floop_optimization8.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8c211c83bba629be6318b5b3fba7137cf633ef9a/gcc%2Ftestsuite%2Fgnat.dg%2Floop_optimization8.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Floop_optimization8.adb?ref=8c211c83bba629be6318b5b3fba7137cf633ef9a", "patch": "@@ -0,0 +1,30 @@\n+-- { dg-do run }\n+-- { dg-options \"-O -gnatn\" }\n+\n+with Loop_Optimization8_Pkg1;\n+\n+procedure Loop_Optimization8 is\n+\n+  Data : Loop_Optimization8_Pkg1.T;\n+\n+  procedure Check_1 (N : in Natural) is\n+  begin\n+     if N /= 0 then\n+       for I in 1 .. Data.Last loop\n+         declare\n+           F : constant Natural := Data.Elements (I);\n+         begin\n+           if F = N then\n+              raise Program_Error;\n+           end if;\n+         end;\n+       end loop;\n+     end if;\n+  end;\n+\n+  procedure Check is new Loop_Optimization8_Pkg1.Iter (Check_1);\n+\n+begin\n+  Data := Loop_Optimization8_Pkg1.Empty;\n+  Check;\n+end;"}, {"sha": "3c3368dd4796b6440af37a4c7a5a1e58f6d1ee1b", "filename": "gcc/testsuite/gnat.dg/loop_optimization8_pkg1.adb", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8c211c83bba629be6318b5b3fba7137cf633ef9a/gcc%2Ftestsuite%2Fgnat.dg%2Floop_optimization8_pkg1.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8c211c83bba629be6318b5b3fba7137cf633ef9a/gcc%2Ftestsuite%2Fgnat.dg%2Floop_optimization8_pkg1.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Floop_optimization8_pkg1.adb?ref=8c211c83bba629be6318b5b3fba7137cf633ef9a", "patch": "@@ -0,0 +1,15 @@\n+with Loop_Optimization8_Pkg2;\n+\n+package body Loop_Optimization8_Pkg1 is\n+\n+  Data : Loop_Optimization8_Pkg2.T\n+    := new Loop_Optimization8_Pkg2.Obj_T'(Length =>1, Elements => (1 => 1));\n+\n+  procedure Iter is\n+  begin\n+    for I in 1 .. Loop_Optimization8_Pkg2.Length (Data) loop\n+      Action (Loop_Optimization8_Pkg2.Index (Data, I));\n+    end loop;\n+  end;\n+\n+end Loop_Optimization8_Pkg1;"}, {"sha": "e6f3c7021022c94b7a23b32393ab985445fe0c41", "filename": "gcc/testsuite/gnat.dg/loop_optimization8_pkg1.ads", "status": "added", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8c211c83bba629be6318b5b3fba7137cf633ef9a/gcc%2Ftestsuite%2Fgnat.dg%2Floop_optimization8_pkg1.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8c211c83bba629be6318b5b3fba7137cf633ef9a/gcc%2Ftestsuite%2Fgnat.dg%2Floop_optimization8_pkg1.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Floop_optimization8_pkg1.ads?ref=8c211c83bba629be6318b5b3fba7137cf633ef9a", "patch": "@@ -0,0 +1,20 @@\n+with Ada.Finalization;\n+\n+package Loop_Optimization8_Pkg1 is\n+\n+  type Array_T is array (Positive range <>) of Natural;\n+\n+  type Array_Access_T is access Array_T;\n+\n+  type T is new Ada.Finalization.Controlled with record\n+    Last : Natural := 0;\n+    Elements : Array_Access_T;\n+  end record;\n+\n+  Empty : T := (Ada.Finalization.Controlled with Last => 0, Elements => null);\n+\n+  generic\n+    with procedure Action (Info : Natural);\n+  procedure Iter;\n+\n+end Loop_Optimization8_Pkg1;"}, {"sha": "9b9a3dea170d9fea575a570c42f2cf6f0950b3bc", "filename": "gcc/testsuite/gnat.dg/loop_optimization8_pkg2.adb", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8c211c83bba629be6318b5b3fba7137cf633ef9a/gcc%2Ftestsuite%2Fgnat.dg%2Floop_optimization8_pkg2.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8c211c83bba629be6318b5b3fba7137cf633ef9a/gcc%2Ftestsuite%2Fgnat.dg%2Floop_optimization8_pkg2.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Floop_optimization8_pkg2.adb?ref=8c211c83bba629be6318b5b3fba7137cf633ef9a", "patch": "@@ -0,0 +1,13 @@\n+package body Loop_Optimization8_Pkg2 is\n+\n+  function Length (Set : T) return Natural is\n+  begin\n+    return Set.Length;\n+  end Length;\n+\n+  function Index (Set : T; Position : Natural) return Integer is\n+  begin\n+    return Set.Elements (Position);\n+  end Index;\n+\n+end Loop_Optimization8_Pkg2;"}, {"sha": "b92cb588bd17e6c21b73d2ef6dcb7c91a1fbd2e5", "filename": "gcc/testsuite/gnat.dg/loop_optimization8_pkg2.ads", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8c211c83bba629be6318b5b3fba7137cf633ef9a/gcc%2Ftestsuite%2Fgnat.dg%2Floop_optimization8_pkg2.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8c211c83bba629be6318b5b3fba7137cf633ef9a/gcc%2Ftestsuite%2Fgnat.dg%2Floop_optimization8_pkg2.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Floop_optimization8_pkg2.ads?ref=8c211c83bba629be6318b5b3fba7137cf633ef9a", "patch": "@@ -0,0 +1,16 @@\n+package Loop_Optimization8_Pkg2 is\n+\n+  type Array_T is array (Natural range <>) of Integer;\n+\n+  type Obj_T (Length : Natural) is\n+    record\n+      Elements : Array_T (1 .. Length);\n+    end record;\n+\n+  type T is access Obj_T;\n+\n+  function Length (Set : T) return Natural;\n+  function Index (Set : T; Position : Natural) return Integer;\n+  pragma Inline (Length, Index);\n+\n+end Loop_Optimization8_Pkg2;"}]}