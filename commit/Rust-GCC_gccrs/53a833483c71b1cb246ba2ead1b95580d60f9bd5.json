{"sha": "53a833483c71b1cb246ba2ead1b95580d60f9bd5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTNhODMzNDgzYzcxYjFjYjI0NmJhMmVhZDFiOTU1ODBkNjBmOWJkNQ==", "commit": {"author": {"name": "Michael Meissner", "email": "michael.meissner@amd.com", "date": "2007-09-25T15:54:00Z"}, "committer": {"name": "Michael Meissner", "email": "meissner@gcc.gnu.org", "date": "2007-09-25T15:54:00Z"}, "message": "Fix 33524; SSE5 vectorized int->long conversions are broken\n\nFrom-SVN: r128768", "tree": {"sha": "497af38c68546a777236befc2840fcfd7b52f26f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/497af38c68546a777236befc2840fcfd7b52f26f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/53a833483c71b1cb246ba2ead1b95580d60f9bd5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/53a833483c71b1cb246ba2ead1b95580d60f9bd5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/53a833483c71b1cb246ba2ead1b95580d60f9bd5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/53a833483c71b1cb246ba2ead1b95580d60f9bd5/comments", "author": null, "committer": null, "parents": [{"sha": "49e39588b6c99f93b6a092c43549a85f2fe9c690", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/49e39588b6c99f93b6a092c43549a85f2fe9c690", "html_url": "https://github.com/Rust-GCC/gccrs/commit/49e39588b6c99f93b6a092c43549a85f2fe9c690"}], "stats": {"total": 46, "additions": 43, "deletions": 3}, "files": [{"sha": "7fe782828536f9bc805ef9adc818ce604b559f37", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/53a833483c71b1cb246ba2ead1b95580d60f9bd5/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/53a833483c71b1cb246ba2ead1b95580d60f9bd5/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=53a833483c71b1cb246ba2ead1b95580d60f9bd5", "patch": "@@ -1,3 +1,11 @@\n+2007-09-25  Michael Meissner  <michael.meissner@amd.com>\n+\n+\tPR c/33524\n+\t* config/i386/i386.c (ix86_expand_sse5_unpack): Change to call\n+\tgen_sse5_pperm_sign_v4si_v2di and gen_sse5_pperm_zero_v4si_v2di\n+\tfor vector int32 -> int64 conversions.  Don't write beyond the end\n+\tof the allocated vector for int32 -> int64 conversions.\n+\n 2007-09-25  Revital Eres  <eres@il.ibm.com>\n \n \t* config/rs6000/paired.h (paired_sel): New."}, {"sha": "e208fb4de4f89ab5787f96717c16ad041e789d7f", "filename": "gcc/config/i386/i386.c", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/53a833483c71b1cb246ba2ead1b95580d60f9bd5/gcc%2Fconfig%2Fi386%2Fi386.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/53a833483c71b1cb246ba2ead1b95580d60f9bd5/gcc%2Fconfig%2Fi386%2Fi386.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386.c?ref=53a833483c71b1cb246ba2ead1b95580d60f9bd5", "patch": "@@ -13542,15 +13542,15 @@ ix86_expand_sse5_unpack (rtx operands[2], bool unsigned_p, bool high_p)\n       for (i = 0; i < 16; i++)\n \tRTVEC_ELT (v, i) = GEN_INT (pperm_bytes[i]);\n \n-      for (i = 0; i < 4; i++)\n+      for (i = 0; i < 2; i++)\n \tRTVEC_ELT (vs, i) = GEN_INT (i + h2);\n \n       p = gen_rtx_PARALLEL (VOIDmode, vs);\n       x = force_reg (V16QImode, gen_rtx_CONST_VECTOR (V16QImode, v));\n       if (unsigned_p)\n-\temit_insn (gen_sse5_pperm_zero_v8hi_v4si (op0, op1, p, x));\n+\temit_insn (gen_sse5_pperm_zero_v4si_v2di (op0, op1, p, x));\n       else\n-\temit_insn (gen_sse5_pperm_sign_v8hi_v4si (op0, op1, p, x));\n+\temit_insn (gen_sse5_pperm_sign_v4si_v2di (op0, op1, p, x));\n       break;\n \n     default:"}, {"sha": "ed4ce2530028dc0b18edc2f42c15f49643341f3a", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/53a833483c71b1cb246ba2ead1b95580d60f9bd5/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/53a833483c71b1cb246ba2ead1b95580d60f9bd5/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=53a833483c71b1cb246ba2ead1b95580d60f9bd5", "patch": "@@ -1,3 +1,9 @@\n+2007-09-25  Michael Meissner  <michael.meissner@amd.com>\n+\n+\tPR c/33524\n+\t* gcc.target/i386/sse5-convert.c: New file, test int->long\n+\tvectorized conversions.\n+\n 2007-09-25  Revital Eres  <eres@il.ibm.com>\n \n \t* testsuite/gcc.target/powerpc/ppc-paired.c (paired_sel): Add."}, {"sha": "0dfdc3ca5f7348268be0a9e7c0307a9c477dad92", "filename": "gcc/testsuite/gcc.target/i386/sse5-convert.c", "status": "added", "additions": 26, "deletions": 0, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/53a833483c71b1cb246ba2ead1b95580d60f9bd5/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fsse5-convert.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/53a833483c71b1cb246ba2ead1b95580d60f9bd5/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fsse5-convert.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fsse5-convert.c?ref=53a833483c71b1cb246ba2ead1b95580d60f9bd5", "patch": "@@ -0,0 +1,26 @@\n+/* Test that the compiler properly optimizes vector SI->DI conversions.  This\n+   was a bug in the initial SSE5 code.  */\n+\n+/* { dg-do compile { target x86_64-*-*} } */\n+/* { dg-options \"-O2 -msse5 -ftree-vectorize\" } */\n+\n+/* This is PR c/33524 */\n+\n+typedef long long __m128i  __attribute__ ((__vector_size__ (16), __may_alias__));\n+\n+#define SIZE 10240\n+union {\n+  signed   int   si[SIZE];\n+  signed   long  sl[SIZE];\n+  __m128i        align;\n+} a, b;\n+\n+void conv_sign_int_sign_long (void)\n+{\n+  int i;\n+\n+  for (i = 0; i < SIZE; i++)\n+    a.sl[i] = b.si[i];\n+}\n+\n+/* { dg-final { scan-assembler \"pperm\" } } */"}]}