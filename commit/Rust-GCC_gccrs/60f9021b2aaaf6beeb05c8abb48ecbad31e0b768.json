{"sha": "60f9021b2aaaf6beeb05c8abb48ecbad31e0b768", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjBmOTAyMWIyYWFhZjZiZWViMDVjOGFiYjQ4ZWNiYWQzMWUwYjc2OA==", "commit": {"author": {"name": "Kaz Kojima", "email": "kkojima@gcc.gnu.org", "date": "2012-03-13T22:50:16Z"}, "committer": {"name": "Kaz Kojima", "email": "kkojima@gcc.gnu.org", "date": "2012-03-13T22:50:16Z"}, "message": "ffi.c (ffi_prep_closure_loc): Don't ASSERT ABI test, just return FFI_BAD_ABI when things are wrong.\n\n\t* src/sh/ffi.c (ffi_prep_closure_loc): Don't ASSERT ABI test,\n\tjust return FFI_BAD_ABI when things are wrong.\n\t* src/sh64/ffi.c (ffi_prep_closure_loc): Ditto.\n\nFrom-SVN: r185361", "tree": {"sha": "d9bc825e34f48648ec69abf6928f0e84af830b89", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d9bc825e34f48648ec69abf6928f0e84af830b89"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/60f9021b2aaaf6beeb05c8abb48ecbad31e0b768", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/60f9021b2aaaf6beeb05c8abb48ecbad31e0b768", "html_url": "https://github.com/Rust-GCC/gccrs/commit/60f9021b2aaaf6beeb05c8abb48ecbad31e0b768", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/60f9021b2aaaf6beeb05c8abb48ecbad31e0b768/comments", "author": null, "committer": null, "parents": [{"sha": "0d23faac63ce40059a91650b0801fa680cc8cb9a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0d23faac63ce40059a91650b0801fa680cc8cb9a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0d23faac63ce40059a91650b0801fa680cc8cb9a"}], "stats": {"total": 16, "additions": 12, "deletions": 4}, "files": [{"sha": "28847807d9e3c4ab1030ea519a89279517b9919d", "filename": "libffi/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/60f9021b2aaaf6beeb05c8abb48ecbad31e0b768/libffi%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/60f9021b2aaaf6beeb05c8abb48ecbad31e0b768/libffi%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2FChangeLog?ref=60f9021b2aaaf6beeb05c8abb48ecbad31e0b768", "patch": "@@ -1,3 +1,9 @@\n+2012-03-13  Kaz Kojima  <kkojima@gcc.gnu.org>\n+\n+\t* src/sh/ffi.c (ffi_prep_closure_loc): Don't ASSERT ABI test,\n+\tjust return FFI_BAD_ABI when things are wrong.\n+\t* src/sh64/ffi.c (ffi_prep_closure_loc): Ditto.\n+\n 2012-03-03  H.J. Lu  <hongjiu.lu@intel.com>\n \n \t* src/x86/ffi64.c (ffi_call): Cast the return value to unsigned"}, {"sha": "3515b91b1d07709bf0c4795dbc11afb4f2430765", "filename": "libffi/src/sh/ffi.c", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/60f9021b2aaaf6beeb05c8abb48ecbad31e0b768/libffi%2Fsrc%2Fsh%2Fffi.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/60f9021b2aaaf6beeb05c8abb48ecbad31e0b768/libffi%2Fsrc%2Fsh%2Fffi.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2Fsrc%2Fsh%2Fffi.c?ref=60f9021b2aaaf6beeb05c8abb48ecbad31e0b768", "patch": "@@ -1,5 +1,5 @@\n /* -----------------------------------------------------------------------\n-   ffi.c - Copyright (c) 2002, 2003, 2004, 2005, 2006, 2007, 2008 Kaz Kojima\n+   ffi.c - Copyright (c) 2002-2008, 2012 Kaz Kojima\n            Copyright (c) 2008 Red Hat, Inc.\n    \n    SuperH Foreign Function Interface \n@@ -463,7 +463,8 @@ ffi_prep_closure_loc (ffi_closure* closure,\n   unsigned int *tramp;\n   unsigned int insn;\n \n-  FFI_ASSERT (cif->abi == FFI_GCC_SYSV);\n+  if (cif->abi != FFI_SYSV)\n+    return FFI_BAD_ABI;\n \n   tramp = (unsigned int *) &closure->tramp[0];\n   /* Set T bit if the function returns a struct pointed with R2.  */"}, {"sha": "123b87ace92f452a6fbf97e2d547a986f54f9a78", "filename": "libffi/src/sh64/ffi.c", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/60f9021b2aaaf6beeb05c8abb48ecbad31e0b768/libffi%2Fsrc%2Fsh64%2Fffi.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/60f9021b2aaaf6beeb05c8abb48ecbad31e0b768/libffi%2Fsrc%2Fsh64%2Fffi.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2Fsrc%2Fsh64%2Fffi.c?ref=60f9021b2aaaf6beeb05c8abb48ecbad31e0b768", "patch": "@@ -1,5 +1,5 @@\n /* -----------------------------------------------------------------------\n-   ffi.c - Copyright (c) 2003, 2004, 2006, 2007 Kaz Kojima\n+   ffi.c - Copyright (c) 2003, 2004, 2006, 2007, 2012 Kaz Kojima\n            Copyright (c) 2008 Anthony Green\n    \n    SuperH SHmedia Foreign Function Interface \n@@ -302,7 +302,8 @@ ffi_prep_closure_loc (ffi_closure *closure,\n {\n   unsigned int *tramp;\n \n-  FFI_ASSERT (cif->abi == FFI_GCC_SYSV);\n+  if (cif->abi != FFI_SYSV)\n+    return FFI_BAD_ABI;\n \n   tramp = (unsigned int *) &closure->tramp[0];\n   /* Since ffi_closure is an aligned object, the ffi trampoline is"}]}