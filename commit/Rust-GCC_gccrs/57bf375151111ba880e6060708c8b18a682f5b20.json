{"sha": "57bf375151111ba880e6060708c8b18a682f5b20", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTdiZjM3NTE1MTExMWJhODgwZTYwNjA3MDhjOGIxOGE2ODJmNWIyMA==", "commit": {"author": {"name": "Aldy Hernandez", "email": "aldyh@redhat.com", "date": "2021-05-25T15:44:51Z"}, "committer": {"name": "Aldy Hernandez", "email": "aldyh@redhat.com", "date": "2021-05-26T19:26:54Z"}, "message": "Convert evrp pass to get_range_query.\n\ngcc/ChangeLog:\n\n\t* gimple-ssa-evrp.c (rvrp_folder::rvrp_folder): Call\n\tenable_ranger.\n\t(rvrp_folder::~rvrp_folder): Call disable_ranger.\n\t(hybrid_folder::hybrid_folder): Call enable_ranger.\n\t(hybrid_folder::~hybrid_folder): Call disable_ranger.", "tree": {"sha": "f11dc3cdce2ffbe802796dfef5179e2e60219d04", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f11dc3cdce2ffbe802796dfef5179e2e60219d04"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/57bf375151111ba880e6060708c8b18a682f5b20", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/57bf375151111ba880e6060708c8b18a682f5b20", "html_url": "https://github.com/Rust-GCC/gccrs/commit/57bf375151111ba880e6060708c8b18a682f5b20", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/57bf375151111ba880e6060708c8b18a682f5b20/comments", "author": {"login": "aldyh", "id": 12937877, "node_id": "MDQ6VXNlcjEyOTM3ODc3", "avatar_url": "https://avatars.githubusercontent.com/u/12937877?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aldyh", "html_url": "https://github.com/aldyh", "followers_url": "https://api.github.com/users/aldyh/followers", "following_url": "https://api.github.com/users/aldyh/following{/other_user}", "gists_url": "https://api.github.com/users/aldyh/gists{/gist_id}", "starred_url": "https://api.github.com/users/aldyh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aldyh/subscriptions", "organizations_url": "https://api.github.com/users/aldyh/orgs", "repos_url": "https://api.github.com/users/aldyh/repos", "events_url": "https://api.github.com/users/aldyh/events{/privacy}", "received_events_url": "https://api.github.com/users/aldyh/received_events", "type": "User", "site_admin": false}, "committer": {"login": "aldyh", "id": 12937877, "node_id": "MDQ6VXNlcjEyOTM3ODc3", "avatar_url": "https://avatars.githubusercontent.com/u/12937877?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aldyh", "html_url": "https://github.com/aldyh", "followers_url": "https://api.github.com/users/aldyh/followers", "following_url": "https://api.github.com/users/aldyh/following{/other_user}", "gists_url": "https://api.github.com/users/aldyh/gists{/gist_id}", "starred_url": "https://api.github.com/users/aldyh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aldyh/subscriptions", "organizations_url": "https://api.github.com/users/aldyh/orgs", "repos_url": "https://api.github.com/users/aldyh/repos", "events_url": "https://api.github.com/users/aldyh/events{/privacy}", "received_events_url": "https://api.github.com/users/aldyh/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "586d6f7aee0ba9faf3d9b7afd6ff89d57763a775", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/586d6f7aee0ba9faf3d9b7afd6ff89d57763a775", "html_url": "https://github.com/Rust-GCC/gccrs/commit/586d6f7aee0ba9faf3d9b7afd6ff89d57763a775"}], "stats": {"total": 20, "additions": 9, "deletions": 11}, "files": [{"sha": "118d10365a006fd22530655305541eda89e62a1e", "filename": "gcc/gimple-ssa-evrp.c", "status": "modified", "additions": 9, "deletions": 11, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/57bf375151111ba880e6060708c8b18a682f5b20/gcc%2Fgimple-ssa-evrp.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/57bf375151111ba880e6060708c8b18a682f5b20/gcc%2Fgimple-ssa-evrp.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgimple-ssa-evrp.c?ref=57bf375151111ba880e6060708c8b18a682f5b20", "patch": "@@ -117,19 +117,18 @@ class rvrp_folder : public substitute_and_fold_engine\n public:\n \n   rvrp_folder () : substitute_and_fold_engine (), m_simplifier ()\n-  { \n-    if (param_evrp_mode & EVRP_MODE_TRACE)\n-      m_ranger = new trace_ranger ();\n-    else\n-      m_ranger = new gimple_ranger ();\n+  {\n+    m_ranger = enable_ranger (cfun);\n     m_simplifier.set_range_query (m_ranger);\n   }\n       \n   ~rvrp_folder ()\n   {\n     if (dump_file && (dump_flags & TDF_DETAILS))\n       m_ranger->dump (dump_file);\n-    delete m_ranger;\n+\n+    m_ranger->export_global_ranges ();\n+    disable_ranger (cfun);\n   }\n \n   tree value_of_expr (tree name, gimple *s = NULL) OVERRIDE\n@@ -175,10 +174,7 @@ class hybrid_folder : public evrp_folder\n public:\n   hybrid_folder (bool evrp_first)\n   {\n-    if (param_evrp_mode & EVRP_MODE_TRACE)\n-      m_ranger = new trace_ranger ();\n-    else\n-      m_ranger = new gimple_ranger ();\n+    m_ranger = enable_ranger (cfun);\n \n     if (evrp_first)\n       {\n@@ -196,7 +192,9 @@ class hybrid_folder : public evrp_folder\n   {\n     if (dump_file && (dump_flags & TDF_DETAILS))\n       m_ranger->dump (dump_file);\n-    delete m_ranger;\n+\n+    m_ranger->export_global_ranges ();\n+    disable_ranger (cfun);\n   }\n \n   bool fold_stmt (gimple_stmt_iterator *gsi) OVERRIDE"}]}