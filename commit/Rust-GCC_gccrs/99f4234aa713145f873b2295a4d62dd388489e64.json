{"sha": "99f4234aa713145f873b2295a4d62dd388489e64", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTlmNDIzNGFhNzEzMTQ1Zjg3M2IyMjk1YTRkNjJkZDM4ODQ4OWU2NA==", "commit": {"author": {"name": "Mark Mitchell", "email": "mark@codesourcery.com", "date": "2006-08-27T17:45:25Z"}, "committer": {"name": "Mark Mitchell", "email": "mmitchel@gcc.gnu.org", "date": "2006-08-27T17:45:25Z"}, "message": "re PR c++/28058 (ICE in inline_forbidden_p)\n\n\tPR c++/28058\n\t* pt.c (register_specialization): Return error_mark_node for\n\tspecialization-after-instantiation.\n\t* decl2.c (mark_used): Mark the main function used when one of its\n\tclones is used.\n\t\n\tPR c++/28058\n\t* g++.dg/template/spec31.C: New test.\n\nFrom-SVN: r116491", "tree": {"sha": "61cd571210dd2a9eb140c6a82736f3e05ddaac45", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/61cd571210dd2a9eb140c6a82736f3e05ddaac45"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/99f4234aa713145f873b2295a4d62dd388489e64", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/99f4234aa713145f873b2295a4d62dd388489e64", "html_url": "https://github.com/Rust-GCC/gccrs/commit/99f4234aa713145f873b2295a4d62dd388489e64", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/99f4234aa713145f873b2295a4d62dd388489e64/comments", "author": null, "committer": null, "parents": [{"sha": "bf87e098aefb413abaa78ec5e0d37dc7366c2c86", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bf87e098aefb413abaa78ec5e0d37dc7366c2c86", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bf87e098aefb413abaa78ec5e0d37dc7366c2c86"}], "stats": {"total": 27, "additions": 26, "deletions": 1}, "files": [{"sha": "369a678036a98c245d099d9a5ffe25678f366efe", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/99f4234aa713145f873b2295a4d62dd388489e64/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/99f4234aa713145f873b2295a4d62dd388489e64/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=99f4234aa713145f873b2295a4d62dd388489e64", "patch": "@@ -1,3 +1,11 @@\n+2006-08-27  Mark Mitchell  <mark@codesourcery.com>\n+\n+\tPR c++/28058\n+\t* pt.c (register_specialization): Return error_mark_node for\n+\tspecialization-after-instantiation.\n+\t* decl2.c (mark_used): Mark the main function used when one of its\n+\tclones is used.\n+\t\n 2006-08-27  Lee Millward  <lee.millward@codesourcery.com>\n \n         PR c++/26573"}, {"sha": "a6187e28006d6ad7cabd8c144452fe96e98caa83", "filename": "gcc/cp/decl2.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/99f4234aa713145f873b2295a4d62dd388489e64/gcc%2Fcp%2Fdecl2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/99f4234aa713145f873b2295a4d62dd388489e64/gcc%2Fcp%2Fdecl2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl2.c?ref=99f4234aa713145f873b2295a4d62dd388489e64", "patch": "@@ -3494,6 +3494,8 @@ mark_used (tree decl)\n     }\n \n   TREE_USED (decl) = 1;\n+  if (DECL_CLONED_FUNCTION_P (decl))\n+    TREE_USED (DECL_CLONED_FUNCTION (decl)) = 1;\n   /* If we don't need a value, then we don't need to synthesize DECL.  */\n   if (skip_evaluation)\n     return;"}, {"sha": "17557c0fffaeacedabd3fc5da18ace644dc5c1ae", "filename": "gcc/cp/pt.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/99f4234aa713145f873b2295a4d62dd388489e64/gcc%2Fcp%2Fpt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/99f4234aa713145f873b2295a4d62dd388489e64/gcc%2Fcp%2Fpt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fpt.c?ref=99f4234aa713145f873b2295a4d62dd388489e64", "patch": "@@ -1163,7 +1163,7 @@ register_specialization (tree spec, tree tmpl, tree args, bool is_friend)\n \t    {\n \t      error (\"specialization of %qD after instantiation\",\n \t\t     fn);\n-\t      return spec;\n+\t      return error_mark_node;\n \t    }\n \t  else\n \t    {"}, {"sha": "dd2456b89c75f7e2b74883c438ee24e63ab8e72a", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/99f4234aa713145f873b2295a4d62dd388489e64/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/99f4234aa713145f873b2295a4d62dd388489e64/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=99f4234aa713145f873b2295a4d62dd388489e64", "patch": "@@ -1,3 +1,8 @@\n+2006-08-27  Mark Mitchell  <mark@codesourcery.com>\n+\n+\tPR c++/28058\n+\t* g++.dg/template/spec31.C: New test.\n+\n 2006-08-27  Lee Millward  <lee.millward@codesourcery.com>\n \n         PR c++/26573"}, {"sha": "3b36ab486ad077d38d3fdf4239d5ee6699ce3c20", "filename": "gcc/testsuite/g++.dg/template/spec31.C", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/99f4234aa713145f873b2295a4d62dd388489e64/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fspec31.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/99f4234aa713145f873b2295a4d62dd388489e64/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fspec31.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fspec31.C?ref=99f4234aa713145f873b2295a4d62dd388489e64", "patch": "@@ -0,0 +1,10 @@\n+// PR c++/28058\n+\n+template<int> struct A\n+{\n+  A() {}\n+};\n+\n+A<0> a;\n+\n+template<> A<0>::A() {} // { dg-error \"specialization\" } "}]}