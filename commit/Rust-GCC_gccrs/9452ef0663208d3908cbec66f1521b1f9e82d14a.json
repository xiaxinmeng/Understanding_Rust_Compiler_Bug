{"sha": "9452ef0663208d3908cbec66f1521b1f9e82d14a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTQ1MmVmMDY2MzIwOGQzOTA4Y2JlYzY2ZjE1MjFiMWY5ZTgyZDE0YQ==", "commit": {"author": {"name": "Tom de Vries", "email": "tom@codesourcery.com", "date": "2015-06-08T08:57:39Z"}, "committer": {"name": "Tom de Vries", "email": "vries@gcc.gnu.org", "date": "2015-06-08T08:57:39Z"}, "message": "Add debug msg to dump_file in add_new_function\n\n2015-06-08  Tom de Vries  <tom@codesourcery.com>\n\n\tPR tree-optimization/66435\n\t* cgraphunit.c (cgraph_node::add_new_function): Dump message on new\n\tfunction.\n\n\t* gcc.dg/gomp/notify-new-function-2.c: New test.\n\t* gcc.dg/gomp/notify-new-function-3.c: Same.\n\t* gcc.dg/gomp/notify-new-function.c: Same.\n\nFrom-SVN: r224209", "tree": {"sha": "4adf666d83553cb88ff315152a87a159b4cfc32c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4adf666d83553cb88ff315152a87a159b4cfc32c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9452ef0663208d3908cbec66f1521b1f9e82d14a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9452ef0663208d3908cbec66f1521b1f9e82d14a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9452ef0663208d3908cbec66f1521b1f9e82d14a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9452ef0663208d3908cbec66f1521b1f9e82d14a/comments", "author": null, "committer": null, "parents": [{"sha": "bd75ff94b295f58cdddd716a68c8c44b9a4e8c94", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bd75ff94b295f58cdddd716a68c8c44b9a4e8c94", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bd75ff94b295f58cdddd716a68c8c44b9a4e8c94"}], "stats": {"total": 81, "additions": 81, "deletions": 0}, "files": [{"sha": "bd1c4b0a37c3567d9389036df1ba727bb1ebf204", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9452ef0663208d3908cbec66f1521b1f9e82d14a/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9452ef0663208d3908cbec66f1521b1f9e82d14a/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=9452ef0663208d3908cbec66f1521b1f9e82d14a", "patch": "@@ -1,3 +1,9 @@\n+2015-06-08  Tom de Vries  <tom@codesourcery.com>\n+\n+\tPR tree-optimization/66435\n+\t* cgraphunit.c (cgraph_node::add_new_function): Dump message on new\n+\tfunction.\n+\n 2015-06-06  Jan Hubicka  <hubicka@ucw.cz>\n \n \t* alias.c (get_alias_set): Be ready for TYPE_CANONICAL"}, {"sha": "6a1f0c1dd2f51e4e38ac2fbfef8f2361658e29de", "filename": "gcc/cgraphunit.c", "status": "modified", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9452ef0663208d3908cbec66f1521b1f9e82d14a/gcc%2Fcgraphunit.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9452ef0663208d3908cbec66f1521b1f9e82d14a/gcc%2Fcgraphunit.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcgraphunit.c?ref=9452ef0663208d3908cbec66f1521b1f9e82d14a", "patch": "@@ -507,6 +507,23 @@ cgraph_node::add_new_function (tree fndecl, bool lowered)\n {\n   gcc::pass_manager *passes = g->get_passes ();\n   cgraph_node *node;\n+\n+  if (dump_file)\n+    {\n+      struct function *fn = DECL_STRUCT_FUNCTION (fndecl);\n+      const char *function_type = ((gimple_has_body_p (fndecl))\n+\t\t\t\t   ? (lowered\n+\t\t\t\t      ? (gimple_in_ssa_p (fn)\n+\t\t\t\t\t ? \"ssa gimple\"\n+\t\t\t\t\t : \"low gimple\")\n+\t\t\t\t      : \"high gimple\")\n+\t\t\t\t   : \"to-be-gimplified\");\n+      fprintf (dump_file,\n+\t       \"Added new %s function %s to callgraph\\n\",\n+\t       function_type,\n+\t       fndecl_name (fndecl));\n+    }\n+\n   switch (symtab->state)\n     {\n       case PARSING:"}, {"sha": "913bd036e9ac5945c0a57aa062d507af7eda5707", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9452ef0663208d3908cbec66f1521b1f9e82d14a/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9452ef0663208d3908cbec66f1521b1f9e82d14a/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=9452ef0663208d3908cbec66f1521b1f9e82d14a", "patch": "@@ -1,3 +1,10 @@\n+2015-06-08  Tom de Vries  <tom@codesourcery.com>\n+\n+\tPR tree-optimization/66435\n+\t* gcc.dg/gomp/notify-new-function-2.c: New test.\n+\t* gcc.dg/gomp/notify-new-function-3.c: Same.\n+\t* gcc.dg/gomp/notify-new-function.c: Same.\n+\n 2015-06-06  Jan Hubicka  <hubicka@ucw.cz>\n \n \t* gfortran.dg/lto/bind_c-1_0.f90: New testcase."}, {"sha": "e9c893908c66621b50f171f3b4fab52a7d38c480", "filename": "gcc/testsuite/gcc.dg/gomp/notify-new-function-2.c", "status": "added", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9452ef0663208d3908cbec66f1521b1f9e82d14a/gcc%2Ftestsuite%2Fgcc.dg%2Fgomp%2Fnotify-new-function-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9452ef0663208d3908cbec66f1521b1f9e82d14a/gcc%2Ftestsuite%2Fgcc.dg%2Fgomp%2Fnotify-new-function-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fgomp%2Fnotify-new-function-2.c?ref=9452ef0663208d3908cbec66f1521b1f9e82d14a", "patch": "@@ -0,0 +1,20 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -fopenmp -fdump-tree-omplower\" } */\n+\n+void __attribute__((noinline))\n+baz (int *p)\n+{\n+}\n+\n+void\n+foo (void)\n+{\n+  int p[2];\n+  p[0] = 1;\n+  p[1] = 3;\n+  #pragma omp task firstprivate (p)\n+    baz (p);\n+}\n+\n+/* Check for new function notification in omplower dump.  */\n+/* { dg-final { scan-tree-dump-times \"Added new high gimple function foo\\\\._omp_cpyfn\\\\.1 to callgraph\" 1 \"omplower\" } } */"}, {"sha": "f173b8e23671bd8218809d565b0718082b4ea93f", "filename": "gcc/testsuite/gcc.dg/gomp/notify-new-function-3.c", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9452ef0663208d3908cbec66f1521b1f9e82d14a/gcc%2Ftestsuite%2Fgcc.dg%2Fgomp%2Fnotify-new-function-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9452ef0663208d3908cbec66f1521b1f9e82d14a/gcc%2Ftestsuite%2Fgcc.dg%2Fgomp%2Fnotify-new-function-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fgomp%2Fnotify-new-function-3.c?ref=9452ef0663208d3908cbec66f1521b1f9e82d14a", "patch": "@@ -0,0 +1,14 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -ftree-parallelize-loops=2 -fdump-tree-ompexpssa\" } */\n+\n+void\n+foo (int *__restrict a, int *__restrict b, int *__restrict c)\n+{\n+  int i;\n+  for (i = 0; i < 1000; ++i)\n+    c[i] = a[i] + b[i];\n+}\n+\n+\n+/* Check for new function notification in ompexpssa dump.  */\n+/* { dg-final { scan-tree-dump-times \"Added new ssa gimple function foo\\\\._loopfn\\\\.0 to callgraph\" 1 \"ompexpssa\" } } */"}, {"sha": "4770a6bda8c2e963ddb6756ed768aafcace13ca9", "filename": "gcc/testsuite/gcc.dg/gomp/notify-new-function.c", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9452ef0663208d3908cbec66f1521b1f9e82d14a/gcc%2Ftestsuite%2Fgcc.dg%2Fgomp%2Fnotify-new-function.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9452ef0663208d3908cbec66f1521b1f9e82d14a/gcc%2Ftestsuite%2Fgcc.dg%2Fgomp%2Fnotify-new-function.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fgomp%2Fnotify-new-function.c?ref=9452ef0663208d3908cbec66f1521b1f9e82d14a", "patch": "@@ -0,0 +1,17 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -fopenmp -fdump-tree-ompexp\" } */\n+\n+int\n+main (void)\n+{\n+#pragma omp parallel\n+  {\n+    extern void foo (void);\n+    foo ();\n+  }\n+  return 0;\n+}\n+\n+\n+/* Check for new function notification in ompexp dump.  */\n+/* { dg-final { scan-tree-dump-times \"Added new low gimple function main\\\\._omp_fn\\\\.0 to callgraph\" 1 \"ompexp\" } } */"}]}