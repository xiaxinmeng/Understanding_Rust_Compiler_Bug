{"sha": "6fdc74c91b2d1dc12544a351721d647be1a84085", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NmZkYzc0YzkxYjJkMWRjMTI1NDRhMzUxNzIxZDY0N2JlMWE4NDA4NQ==", "commit": {"author": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2016-09-22T10:06:41Z"}, "committer": {"name": "Jonathan Wakely", "email": "redi@gcc.gnu.org", "date": "2016-09-22T10:06:41Z"}, "message": "Update pretty printer for std::variant\n\n\t* python/libstdcxx/v6/printers.py (StdVariantPrinter): Adjust for\n\trecent change to _Variant_storage.\n\t* testsuite/libstdc++-prettyprinters/cxx17.cc: Test variant with\n\treference type.\n\nFrom-SVN: r240345", "tree": {"sha": "0661d922cfaf405d48e8eb51b75f04efaf6e44b1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0661d922cfaf405d48e8eb51b75f04efaf6e44b1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6fdc74c91b2d1dc12544a351721d647be1a84085", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6fdc74c91b2d1dc12544a351721d647be1a84085", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6fdc74c91b2d1dc12544a351721d647be1a84085", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6fdc74c91b2d1dc12544a351721d647be1a84085/comments", "author": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "64626fcaaaa2584a244db423d48e5bebfc6ade33", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/64626fcaaaa2584a244db423d48e5bebfc6ade33", "html_url": "https://github.com/Rust-GCC/gccrs/commit/64626fcaaaa2584a244db423d48e5bebfc6ade33"}], "stats": {"total": 10, "additions": 9, "deletions": 1}, "files": [{"sha": "e9bb0ce0fa6d7b4cabf2921384a71b7f5cb7fbe5", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6fdc74c91b2d1dc12544a351721d647be1a84085/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6fdc74c91b2d1dc12544a351721d647be1a84085/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=6fdc74c91b2d1dc12544a351721d647be1a84085", "patch": "@@ -1,5 +1,10 @@\n 2016-09-22  Jonathan Wakely  <jwakely@redhat.com>\n \n+\t* python/libstdcxx/v6/printers.py (StdVariantPrinter): Adjust for\n+\trecent change to _Variant_storage.\n+\t* testsuite/libstdc++-prettyprinters/cxx17.cc: Test variant with\n+\treference type.\n+\n \t* include/bits/uses_allocator.h (__uses_allocator_construct): Qualify\n \tstd::forward and ::new. Cast pointer to void*.\n \t* include/std/variant (_Variant_storage, _Union, _Variant_base)"}, {"sha": "18c6f6b6a380c42b040a850da6b07bda83efa023", "filename": "libstdc++-v3/python/libstdcxx/v6/printers.py", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6fdc74c91b2d1dc12544a351721d647be1a84085/libstdc%2B%2B-v3%2Fpython%2Flibstdcxx%2Fv6%2Fprinters.py", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6fdc74c91b2d1dc12544a351721d647be1a84085/libstdc%2B%2B-v3%2Fpython%2Flibstdcxx%2Fv6%2Fprinters.py", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fpython%2Flibstdcxx%2Fv6%2Fprinters.py?ref=6fdc74c91b2d1dc12544a351721d647be1a84085", "patch": "@@ -994,7 +994,7 @@ def __init__(self, typename, val):\n             visualizer = None\n         else:\n             self.contained_type = alternatives[int(self.index)]\n-            addr = val['_M_first']['_M_storage'].address\n+            addr = val['_M_union']['_M_first']['_M_storage'].address\n             contained_value = addr.cast(self.contained_type.pointer()).dereference()\n             visualizer = gdb.default_visualizer(contained_value)\n         super (StdVariantPrinter, self).__init__(contained_value, visualizer, 'array')"}, {"sha": "09d79e9e59d5b7ca8396ca1f4f1775fb5c61b2bd", "filename": "libstdc++-v3/testsuite/libstdc++-prettyprinters/cxx17.cc", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6fdc74c91b2d1dc12544a351721d647be1a84085/libstdc%2B%2B-v3%2Ftestsuite%2Flibstdc%2B%2B-prettyprinters%2Fcxx17.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6fdc74c91b2d1dc12544a351721d647be1a84085/libstdc%2B%2B-v3%2Ftestsuite%2Flibstdc%2B%2B-prettyprinters%2Fcxx17.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2Flibstdc%2B%2B-prettyprinters%2Fcxx17.cc?ref=6fdc74c91b2d1dc12544a351721d647be1a84085", "patch": "@@ -84,6 +84,9 @@ main()\n   variant<float, int, string_view> v4{ str };\n // { dg-final { note-test v4 {std::variant<float, int, std::string_view> [index 2] = {\"string\"}} } }\n \n+  variant<string_view&> vref{str};\n+// { dg-final { note-test vref {std::variant<std::basic_string_view<char, std::char_traits<char> > &> [index 0] = {\"string\"}} } }\n+\n   std::cout << \"\\n\";\n   return 0;\t\t\t// Mark SPOT\n }"}]}