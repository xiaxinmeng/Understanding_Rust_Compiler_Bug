{"sha": "b09bf97bcd51adcc554e21213cd4159db95805a3", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjA5YmY5N2JjZDUxYWRjYzU1NGUyMTIxM2NkNDE1OWRiOTU4MDVhMw==", "commit": {"author": {"name": "Yury Gribov", "email": "tetra2005@gmail.com", "date": "2017-09-29T19:40:16Z"}, "committer": {"name": "Yury Gribov", "email": "ygribov@gcc.gnu.org", "date": "2017-09-29T19:40:16Z"}, "message": "re PR middle-end/82319 (ICE in generic_simplify_148, at generic-match.c:6436)\n\n2017-09-29  Yury Gribov  <tetra2005@gmail.com>\n\n\tPR middle-end/82319\ngcc/\n\t* match.pd: Fix handling of NaNs in pattern.\n\ngcc/testsuite/\n\t* c-c++/common/pr57371-4.c: Test NaN comparisons.\n\nFrom-SVN: r253307", "tree": {"sha": "e6a08f58f36898a8bc37718b1bc4815f2753ea0d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e6a08f58f36898a8bc37718b1bc4815f2753ea0d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b09bf97bcd51adcc554e21213cd4159db95805a3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b09bf97bcd51adcc554e21213cd4159db95805a3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b09bf97bcd51adcc554e21213cd4159db95805a3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b09bf97bcd51adcc554e21213cd4159db95805a3/comments", "author": {"login": "yugr", "id": 1101391, "node_id": "MDQ6VXNlcjExMDEzOTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1101391?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yugr", "html_url": "https://github.com/yugr", "followers_url": "https://api.github.com/users/yugr/followers", "following_url": "https://api.github.com/users/yugr/following{/other_user}", "gists_url": "https://api.github.com/users/yugr/gists{/gist_id}", "starred_url": "https://api.github.com/users/yugr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yugr/subscriptions", "organizations_url": "https://api.github.com/users/yugr/orgs", "repos_url": "https://api.github.com/users/yugr/repos", "events_url": "https://api.github.com/users/yugr/events{/privacy}", "received_events_url": "https://api.github.com/users/yugr/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "6e3e841997276a3a3ac5c90b253ba235d8262990", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6e3e841997276a3a3ac5c90b253ba235d8262990", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6e3e841997276a3a3ac5c90b253ba235d8262990"}], "stats": {"total": 24, "additions": 23, "deletions": 1}, "files": [{"sha": "2063108fdfb7ca394855314d6509ba1f47b0d75e", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b09bf97bcd51adcc554e21213cd4159db95805a3/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b09bf97bcd51adcc554e21213cd4159db95805a3/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=b09bf97bcd51adcc554e21213cd4159db95805a3", "patch": "@@ -1,3 +1,8 @@\n+2017-09-29  Yury Gribov  <tetra2005@gmail.com>\n+\n+\tPR middle-end/82319\n+\t* match.pd: Fix handling of NaNs in pattern.\n+\n 2017-09-29  Jeff Law  <law@redhat.com>\n \n \t* sbitmap.c (bitmap_bit_in_range_p): New function."}, {"sha": "1136a598abb139673ff54bd57e5bfd7fbe335ac7", "filename": "gcc/match.pd", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b09bf97bcd51adcc554e21213cd4159db95805a3/gcc%2Fmatch.pd", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b09bf97bcd51adcc554e21213cd4159db95805a3/gcc%2Fmatch.pd", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fmatch.pd?ref=b09bf97bcd51adcc554e21213cd4159db95805a3", "patch": "@@ -2961,7 +2961,7 @@ DEFINE_INT_AND_FLOAT_ROUND_FN (RINT)\n \t else\n \t   real_trunc (&icst, fmt, cst);\n \n-\t bool cst_int_p = real_identical (&icst, cst);\n+\t bool cst_int_p = !real_isnan (cst) && real_identical (&icst, cst);\n \n \t bool overflow_p = false;\n \t wide_int icst_val"}, {"sha": "8cb533bd58b50e97497b8a2db23cf34439c14c4b", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b09bf97bcd51adcc554e21213cd4159db95805a3/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b09bf97bcd51adcc554e21213cd4159db95805a3/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=b09bf97bcd51adcc554e21213cd4159db95805a3", "patch": "@@ -1,3 +1,8 @@\n+2017-09-29  Yury Gribov  <tetra2005@gmail.com>\n+\n+\tPR middle-end/82319\n+\t* c-c++/common/pr57371-4.c: Test NaN comparisons.\n+\n 2017-09-29  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* g++.dg/other/dump-ada-spec-10.C: New test."}, {"sha": "f43f7c22419a56661ebcb284fa648f478be1833f", "filename": "gcc/testsuite/c-c++-common/pr57371-4.c", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b09bf97bcd51adcc554e21213cd4159db95805a3/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fpr57371-4.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b09bf97bcd51adcc554e21213cd4159db95805a3/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fpr57371-4.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fpr57371-4.c?ref=b09bf97bcd51adcc554e21213cd4159db95805a3", "patch": "@@ -69,4 +69,16 @@ void nonfinite(unsigned short x) {\n     nonfinite_10 = (float) x != SNAN;\n     /* { dg-final { scan-tree-dump \"nonfinite_10 = \\\\(float\\\\)\" \"original\" } } */\n   }\n+\n+  {\n+    volatile int nonfinite_11;\n+    nonfinite_11 = (float) x == QNAN;\n+    /* { dg-final { scan-tree-dump \"nonfinite_11 = 0\" \"original\" } } */\n+  }\n+\n+  {\n+    volatile int nonfinite_12;\n+    nonfinite_12 = (float) x != QNAN;\n+    /* { dg-final { scan-tree-dump \"nonfinite_12 = 1\" \"original\" } } */\n+  }\n }"}]}