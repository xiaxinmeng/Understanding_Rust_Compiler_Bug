{"sha": "dd35aac798661f0ad778384bc8d0751584a137c0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZGQzNWFhYzc5ODY2MWYwYWQ3NzgzODRiYzhkMDc1MTU4NGExMzdjMA==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@redhat.com", "date": "2011-03-28T16:14:22Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "2011-03-28T16:14:22Z"}, "message": "Core 1232\n\n\tCore 1232\n\t* call.c (build_array_conv): New.\n\t(implicit_conversion): Use it.\n\nFrom-SVN: r171614", "tree": {"sha": "0da34b1a4025af9fee057fdd4c38796435b0572a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0da34b1a4025af9fee057fdd4c38796435b0572a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/dd35aac798661f0ad778384bc8d0751584a137c0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dd35aac798661f0ad778384bc8d0751584a137c0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dd35aac798661f0ad778384bc8d0751584a137c0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dd35aac798661f0ad778384bc8d0751584a137c0/comments", "author": {"login": "jicama", "id": 266146, "node_id": "MDQ6VXNlcjI2NjE0Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/266146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jicama", "html_url": "https://github.com/jicama", "followers_url": "https://api.github.com/users/jicama/followers", "following_url": "https://api.github.com/users/jicama/following{/other_user}", "gists_url": "https://api.github.com/users/jicama/gists{/gist_id}", "starred_url": "https://api.github.com/users/jicama/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jicama/subscriptions", "organizations_url": "https://api.github.com/users/jicama/orgs", "repos_url": "https://api.github.com/users/jicama/repos", "events_url": "https://api.github.com/users/jicama/events{/privacy}", "received_events_url": "https://api.github.com/users/jicama/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "159177a1542d7bc9ca5110aa1dcc7dde9a799024", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/159177a1542d7bc9ca5110aa1dcc7dde9a799024", "html_url": "https://github.com/Rust-GCC/gccrs/commit/159177a1542d7bc9ca5110aa1dcc7dde9a799024"}], "stats": {"total": 67, "additions": 67, "deletions": 0}, "files": [{"sha": "22bd6b83d06916cea014cb896306f3e88e0ffed4", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dd35aac798661f0ad778384bc8d0751584a137c0/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dd35aac798661f0ad778384bc8d0751584a137c0/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=dd35aac798661f0ad778384bc8d0751584a137c0", "patch": "@@ -1,5 +1,9 @@\n 2011-03-28  Jason Merrill  <jason@redhat.com>\n \n+\tCore 1232\n+\t* call.c (build_array_conv): New.\n+\t(implicit_conversion): Use it.\n+\n \t* call.c (reference_binding): Allow direct binding to an array\n \trvalue.\n "}, {"sha": "a1cfa96e795b4f9cb4e2ad8c1114ac612e6e208b", "filename": "gcc/cp/call.c", "status": "modified", "additions": 49, "deletions": 0, "changes": 49, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dd35aac798661f0ad778384bc8d0751584a137c0/gcc%2Fcp%2Fcall.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dd35aac798661f0ad778384bc8d0751584a137c0/gcc%2Fcp%2Fcall.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fcall.c?ref=dd35aac798661f0ad778384bc8d0751584a137c0", "patch": "@@ -801,6 +801,53 @@ build_aggr_conv (tree type, tree ctor, int flags)\n   return c;\n }\n \n+/* Represent a conversion from CTOR, a braced-init-list, to TYPE, an\n+   array type, if such a conversion is possible.  */\n+\n+static conversion *\n+build_array_conv (tree type, tree ctor, int flags)\n+{\n+  conversion *c;\n+  unsigned HOST_WIDE_INT len = CONSTRUCTOR_NELTS (ctor);\n+  tree elttype = TREE_TYPE (type);\n+  unsigned i;\n+  tree val;\n+  bool bad = false;\n+  bool user = false;\n+  enum conversion_rank rank = cr_exact;\n+\n+  if (TYPE_DOMAIN (type))\n+    {\n+      unsigned HOST_WIDE_INT alen = tree_low_cst (array_type_nelts_top (type), 1);\n+      if (alen < len)\n+\treturn NULL;\n+    }\n+\n+  FOR_EACH_CONSTRUCTOR_VALUE (CONSTRUCTOR_ELTS (ctor), i, val)\n+    {\n+      conversion *sub\n+\t= implicit_conversion (elttype, TREE_TYPE (val), val,\n+\t\t\t       false, flags);\n+      if (sub == NULL)\n+\treturn NULL;\n+\n+      if (sub->rank > rank)\n+\trank = sub->rank;\n+      if (sub->user_conv_p)\n+\tuser = true;\n+      if (sub->bad_p)\n+\tbad = true;\n+    }\n+\n+  c = alloc_conversion (ck_aggr);\n+  c->type = type;\n+  c->rank = rank;\n+  c->user_conv_p = user;\n+  c->bad_p = bad;\n+  c->u.next = NULL;\n+  return c;\n+}\n+\n /* Build a representation of the identity conversion from EXPR to\n    itself.  The TYPE should match the type of EXPR, if EXPR is non-NULL.  */\n \n@@ -1623,6 +1670,8 @@ implicit_conversion (tree to, tree from, tree expr, bool c_cast_p,\n \t      return conv;\n \t    }\n \t}\n+      else if (TREE_CODE (to) == ARRAY_TYPE)\n+\treturn build_array_conv (to, expr, flags);\n     }\n \n   if (expr != NULL_TREE"}, {"sha": "4445d51694e347405e6b3617c5f8419e48f7e12e", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dd35aac798661f0ad778384bc8d0751584a137c0/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dd35aac798661f0ad778384bc8d0751584a137c0/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=dd35aac798661f0ad778384bc8d0751584a137c0", "patch": "@@ -1,5 +1,7 @@\n 2011-03-28  Jason Merrill  <jason@redhat.com>\n \n+\t* g++.dg/cpp0x/initlist-array2.C: New.\n+\n \t* g++.dg/cpp0x/initlist-array1.C: New.\n \n \t* g++.dg/cpp0x/constexpr-compound.C: New."}, {"sha": "19eec33acf7f3ac639f7af50ebfc9ccfb4d1e6bc", "filename": "gcc/testsuite/g++.dg/cpp0x/initlist-array2.C", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dd35aac798661f0ad778384bc8d0751584a137c0/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Finitlist-array2.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dd35aac798661f0ad778384bc8d0751584a137c0/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Finitlist-array2.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Finitlist-array2.C?ref=dd35aac798661f0ad778384bc8d0751584a137c0", "patch": "@@ -0,0 +1,12 @@\n+// { dg-options -std=c++0x }\n+\n+typedef int IA[2];\n+typedef double DA[2];\n+\n+void f(const IA&) { }\n+void f(const DA&);\n+\n+int main()\n+{\n+  f({1,2});\n+}"}]}