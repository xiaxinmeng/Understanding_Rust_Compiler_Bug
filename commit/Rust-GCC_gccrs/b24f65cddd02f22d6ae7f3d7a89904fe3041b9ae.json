{"sha": "b24f65cddd02f22d6ae7f3d7a89904fe3041b9ae", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjI0ZjY1Y2RkZDAyZjIyZDZhZTdmM2Q3YTg5OTA0ZmUzMDQxYjlhZQ==", "commit": {"author": {"name": "Alexandre Petit-Bianco", "email": "apbianco@cygnus.com", "date": "1998-05-15T17:32:40Z"}, "committer": {"name": "Jim Wilson", "email": "wilson@gcc.gnu.org", "date": "1998-05-15T17:32:40Z"}, "message": "Patch from Alex Petit-Bianco.\n\n\t* expr.c (expand_expr, case EXPR_WITH_FILE_LOCATION): Save/restore\n\tinput_filename and lineno around expand_expr call.  Set them to values\n\tin WFL before expand_expr call.\n\nFrom-SVN: r19778", "tree": {"sha": "d0e1ea4877528601326b16e545b6c2aa1b02eed7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d0e1ea4877528601326b16e545b6c2aa1b02eed7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b24f65cddd02f22d6ae7f3d7a89904fe3041b9ae", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b24f65cddd02f22d6ae7f3d7a89904fe3041b9ae", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b24f65cddd02f22d6ae7f3d7a89904fe3041b9ae", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b24f65cddd02f22d6ae7f3d7a89904fe3041b9ae/comments", "author": null, "committer": null, "parents": [{"sha": "c1465d214794ae6ce6cdd9d7c1bc5c0e7d2bd545", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c1465d214794ae6ce6cdd9d7c1bc5c0e7d2bd545", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c1465d214794ae6ce6cdd9d7c1bc5c0e7d2bd545"}], "stats": {"total": 23, "additions": 20, "deletions": 3}, "files": [{"sha": "d4023bec82d59909d77470293908f4766b9b5a2a", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b24f65cddd02f22d6ae7f3d7a89904fe3041b9ae/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b24f65cddd02f22d6ae7f3d7a89904fe3041b9ae/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=b24f65cddd02f22d6ae7f3d7a89904fe3041b9ae", "patch": "@@ -1,3 +1,9 @@\n+Fri May 15 17:26:18 1998  Alexandre Petit-Bianco  <apbianco@cygnus.com>\n+\n+\t* expr.c (expand_expr, case EXPR_WITH_FILE_LOCATION): Save/restore\n+\tinput_filename and lineno around expand_expr call.  Set them to values\n+\tin WFL before expand_expr call.\n+\n Fri May 15 12:44:57 1998  Benjamin Kosnik  <bkoz@rhino.cygnus.com>\n \n \t* stor-layout.c (set_sizetype): Set TYPE_NAME on bitsizetype."}, {"sha": "34f744db7f3330aee4d2359fc40e4fd356ff98e9", "filename": "gcc/expr.c", "status": "modified", "additions": 14, "deletions": 3, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b24f65cddd02f22d6ae7f3d7a89904fe3041b9ae/gcc%2Fexpr.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b24f65cddd02f22d6ae7f3d7a89904fe3041b9ae/gcc%2Fexpr.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fexpr.c?ref=b24f65cddd02f22d6ae7f3d7a89904fe3041b9ae", "patch": "@@ -5171,9 +5171,20 @@ expand_expr (exp, target, tmode, modifier)\n       return TREE_CST_RTL (exp);\n \n     case EXPR_WITH_FILE_LOCATION:\n-      if (EXPR_WFL_EMIT_LINE_NOTE (exp))\n-\temit_line_note (EXPR_WFL_FILENAME (exp), EXPR_WFL_LINENO (exp));\n-      return expand_expr (EXPR_WFL_NODE (exp), target, tmode, modifier);\n+      {\n+\trtx to_return;\n+\tchar *saved_input_filename = input_filename;\n+\tint saved_lineno = lineno;\n+\tinput_filename = EXPR_WFL_FILENAME (exp);\n+\tlineno = EXPR_WFL_LINENO (exp);\n+\tif (EXPR_WFL_EMIT_LINE_NOTE (exp))\n+\t  emit_line_note (input_filename, lineno);\n+\t/* Possibly avoid switching back and force here */\n+\tto_return = expand_expr (EXPR_WFL_NODE (exp), target, tmode, modifier);\n+\tinput_filename = saved_input_filename;\n+\tlineno = saved_lineno;\n+\treturn to_return;\n+      }\n \n     case SAVE_EXPR:\n       context = decl_function_context (exp);"}]}