{"sha": "f6937e32d041eedb13f605a014eb4506a158ba62", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjY5MzdlMzJkMDQxZWVkYjEzZjYwNWEwMTRlYjQ1MDZhMTU4YmE2Mg==", "commit": {"author": {"name": "Vladimir Makarov", "email": "vmakarov@redhat.com", "date": "2013-10-25T21:34:26Z"}, "committer": {"name": "Vladimir Makarov", "email": "vmakarov@gcc.gnu.org", "date": "2013-10-25T21:34:26Z"}, "message": "re PR rtl-optimization/58759 (wrong code (segfaults) at -O2 on x86_64-linux-gnu in 32-bit mode)\n\n2013-10-25  Vladimir Makarov  <vmakarov@redhat.com>\n\n\tPR rtl-optimization/58759\n\t* lra-constraints.c (lra_constraints): Remove wrong condition to\n\tremove insn setting up an equivalent pseudo.\n\n2013-10-25  Vladimir Makarov  <vmakarov@redhat.com>\n\n\tPR rtl-optimization/58759\n\t* gcc.target/i386/pr58759.c: New.\n\nFrom-SVN: r204080", "tree": {"sha": "3ea933d09d48793f3d02906e2059a2fde73bc441", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3ea933d09d48793f3d02906e2059a2fde73bc441"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f6937e32d041eedb13f605a014eb4506a158ba62", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f6937e32d041eedb13f605a014eb4506a158ba62", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f6937e32d041eedb13f605a014eb4506a158ba62", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f6937e32d041eedb13f605a014eb4506a158ba62/comments", "author": {"login": "vnmakarov", "id": 9855671, "node_id": "MDQ6VXNlcjk4NTU2NzE=", "avatar_url": "https://avatars.githubusercontent.com/u/9855671?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vnmakarov", "html_url": "https://github.com/vnmakarov", "followers_url": "https://api.github.com/users/vnmakarov/followers", "following_url": "https://api.github.com/users/vnmakarov/following{/other_user}", "gists_url": "https://api.github.com/users/vnmakarov/gists{/gist_id}", "starred_url": "https://api.github.com/users/vnmakarov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vnmakarov/subscriptions", "organizations_url": "https://api.github.com/users/vnmakarov/orgs", "repos_url": "https://api.github.com/users/vnmakarov/repos", "events_url": "https://api.github.com/users/vnmakarov/events{/privacy}", "received_events_url": "https://api.github.com/users/vnmakarov/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "01b1efaa1439e6cbf44566354dcce9a96d5c6f5e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/01b1efaa1439e6cbf44566354dcce9a96d5c6f5e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/01b1efaa1439e6cbf44566354dcce9a96d5c6f5e"}], "stats": {"total": 65, "additions": 52, "deletions": 13}, "files": [{"sha": "29035aa7997d94915dbf53e5952faea53242d353", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f6937e32d041eedb13f605a014eb4506a158ba62/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f6937e32d041eedb13f605a014eb4506a158ba62/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=f6937e32d041eedb13f605a014eb4506a158ba62", "patch": "@@ -1,3 +1,9 @@\n+2013-10-25  Vladimir Makarov  <vmakarov@redhat.com>\n+\n+\tPR rtl-optimization/58759\n+\t* lra-constraints.c (lra_constraints): Remove wrong condition to\n+\tremove insn setting up an equivalent pseudo.\n+\n 2013-10-25  Vladimir Makarov  <vmakarov@redhat.com>\n \n \t* config/rs6000/rs6000-protos.h"}, {"sha": "a2d348d8dfe8c55072ff87e8a7bdbeeaed7bfa21", "filename": "gcc/lra-constraints.c", "status": "modified", "additions": 3, "deletions": 13, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f6937e32d041eedb13f605a014eb4506a158ba62/gcc%2Flra-constraints.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f6937e32d041eedb13f605a014eb4506a158ba62/gcc%2Flra-constraints.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flra-constraints.c?ref=f6937e32d041eedb13f605a014eb4506a158ba62", "patch": "@@ -3975,18 +3975,6 @@ lra_constraints (bool first_p)\n \t\tdest_reg = SUBREG_REG (dest_reg);\n \t      if ((REG_P (dest_reg)\n \t\t   && (x = get_equiv_substitution (dest_reg)) != dest_reg\n-\t\t   /* Check that this is actually an insn setting up\n-\t\t      the equivalence.  */\n-\t\t   && (in_list_p (curr_insn,\n-\t\t\t\t  ira_reg_equiv\n-\t\t\t\t  [REGNO (dest_reg)].init_insns)\n-\t\t       /* Init insns may contain not all insns setting\n-\t\t\t  up equivalence as we have live range\n-\t\t\t  splitting.  So here we use another condition\n-\t\t\t  to check insn setting up the equivalence\n-\t\t\t  which should be removed, e.g. in case when\n-\t\t\t  the equivalence is a constant.  */\n-\t\t       || ! MEM_P (x))\n \t\t   /* Remove insns which set up a pseudo whose value\n \t\t      can not be changed.  Such insns might be not in\n \t\t      init_insns because we don't update equiv data\n@@ -3999,8 +3987,10 @@ lra_constraints (bool first_p)\n \t\t      secondary memory movement.  Then the pseudo is\n \t\t      spilled and we use the equiv constant.  In this\n \t\t      case we should remove the additional insn and\n-\t\t      this insn is not init_insns list.\t */\n+\t\t      this insn is not init_insns list.  */\n \t\t   && (! MEM_P (x) || MEM_READONLY_P (x)\n+\t\t       /* Check that this is actually an insn setting\n+\t\t\t  up the equivalence.  */\n \t\t       || in_list_p (curr_insn,\n \t\t\t\t     ira_reg_equiv\n \t\t\t\t     [REGNO (dest_reg)].init_insns)))"}, {"sha": "6b981122ac978800ffc53c6b745a1e39864430d5", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f6937e32d041eedb13f605a014eb4506a158ba62/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f6937e32d041eedb13f605a014eb4506a158ba62/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=f6937e32d041eedb13f605a014eb4506a158ba62", "patch": "@@ -1,3 +1,8 @@\n+2013-10-25  Vladimir Makarov  <vmakarov@redhat.com>\n+\n+\tPR rtl-optimization/58759\n+\t* gcc.target/i386/pr58759.c: New.\n+\n 2013-10-25  Tobias Burnus  <burnus@net-b.de>\n \n \t* g++.dg/vect/pr33426-ivdep.cc: Use dg-options."}, {"sha": "8257dde533da546ef31067915aaccd03df00a2e7", "filename": "gcc/testsuite/gcc.target/i386/pr58759.c", "status": "added", "additions": 38, "deletions": 0, "changes": 38, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f6937e32d041eedb13f605a014eb4506a158ba62/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr58759.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f6937e32d041eedb13f605a014eb4506a158ba62/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr58759.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr58759.c?ref=f6937e32d041eedb13f605a014eb4506a158ba62", "patch": "@@ -0,0 +1,38 @@\n+/* { dg-do run } */\n+/* { dg-options \"-O2\" } */\n+\n+\n+int a, b, c, d, e, f, h, l, m, n, k, o;\n+long long g;\n+\n+struct S\n+{\n+  int f1;\n+  int f2;\n+  int f3;\n+  int f4;\n+};\n+\n+static struct S i = {0,0,0,0}, j;\n+\n+void\n+foo ()\n+{\n+  m = 1 & d;\n+  n = b + c;\n+  o = k >> 1;\n+  f = 0 == e;\n+}\n+\n+int\n+main ()\n+{\n+  for (; h < 1; h++)\n+    {\n+      g = 1 | (0 > 1 - a ? 0 : a);\n+      foo ();\n+      for (l = 0; l < 3; l++)\n+      j = i;\n+    }\n+  return 0;\n+}"}]}