{"sha": "5d70666e4c20dd634283e09336c78f79fce77d77", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NWQ3MDY2NmU0YzIwZGQ2MzQyODNlMDkzMzZjNzhmNzlmY2U3N2Q3Nw==", "commit": {"author": {"name": "Ryan Burn", "email": "contact@rnburn.com", "date": "2016-01-27T17:17:23Z"}, "committer": {"name": "Jeff Law", "email": "law@gcc.gnu.org", "date": "2016-01-27T17:17:23Z"}, "message": "re PR c++/69267 ([cilkplus] ICE when calling a function with an empty class as an argument)\n\n2016-01-15  Ryan Burn  <contact@rnburn.com>\n\n        PR cilkplus/69267\n        * cilk.c (cilk_gimplify_call_params_in_spawned_fn): Change to use\n        gimplify_arg. Removed superfluous post_p argument.\n        * c-family.h (cilk_gimplify_call_params_in_spawned_fn): Removed\n        superfluous post_p argument.\n        * c-gimplify.c (c_gimplify_expr): Likewise.\n\ngcc/cp/ChangeLog:\n\n2016-01-15  Ryan Burn  <contact@rnburn.com>\n\n        PR cilkplus/69267\n        * cp-gimplify.c (cilk_cp_gimplify_call_params_in_spawned_fn): Removed\n        superfluous post_p argument in call to\n        cilk_gimplify_call_params_in_spawned_fn.\n\ngcc/testsuite/ChangeLog:\n\n2016-01-15  Ryan Burn  <contact@rnburn.com>\n\n\tPR cilkplus/69267\n\t* g++.dg/cilk-plus/CK/pr69267.cc: New test.\n\nFrom-SVN: r232887", "tree": {"sha": "07d37e6aa17f4ef0fdb0be81d976d0710aa4160e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/07d37e6aa17f4ef0fdb0be81d976d0710aa4160e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5d70666e4c20dd634283e09336c78f79fce77d77", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5d70666e4c20dd634283e09336c78f79fce77d77", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5d70666e4c20dd634283e09336c78f79fce77d77", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5d70666e4c20dd634283e09336c78f79fce77d77/comments", "author": null, "committer": null, "parents": [{"sha": "87ff4d664cee24c5e3070bd573f501bb982ee862", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/87ff4d664cee24c5e3070bd573f501bb982ee862", "html_url": "https://github.com/Rust-GCC/gccrs/commit/87ff4d664cee24c5e3070bd573f501bb982ee862"}], "stats": {"total": 47, "additions": 38, "deletions": 9}, "files": [{"sha": "8c869896130ec691969f0c6cd8a86109129023fa", "filename": "gcc/c-family/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5d70666e4c20dd634283e09336c78f79fce77d77/gcc%2Fc-family%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5d70666e4c20dd634283e09336c78f79fce77d77/gcc%2Fc-family%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2FChangeLog?ref=5d70666e4c20dd634283e09336c78f79fce77d77", "patch": "@@ -1,3 +1,12 @@\n+2016-01-27  Ryan Burn  <contact@rnburn.com>\n+\n+\tPR cilkplus/69267\n+\t* cilk.c (cilk_gimplify_call_params_in_spawned_fn): Change to use\n+\tgimplify_arg. Removed superfluous post_p argument.\n+\t* c-family.h (cilk_gimplify_call_params_in_spawned_fn): Removed\n+\tsuperfluous post_p argument.\n+\t* c-gimplify.c (c_gimplify_expr): Likewise.\n+\n 2016-01-26  David Malcolm  <dmalcolm@redhat.com>\n \n \tPR other/69006"}, {"sha": "fa3746c3725034d083aa33506a71d189751ae8d1", "filename": "gcc/c-family/c-common.h", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5d70666e4c20dd634283e09336c78f79fce77d77/gcc%2Fc-family%2Fc-common.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5d70666e4c20dd634283e09336c78f79fce77d77/gcc%2Fc-family%2Fc-common.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2Fc-common.h?ref=5d70666e4c20dd634283e09336c78f79fce77d77", "patch": "@@ -1449,8 +1449,7 @@ extern bool is_cilkplus_vector_p (tree);\n extern tree insert_cilk_frame (tree);\n extern void cilk_init_builtins (void);\n extern int gimplify_cilk_spawn (tree *);\n-extern void cilk_gimplify_call_params_in_spawned_fn (tree *, gimple_seq *,\n-\t\t\t\t\t\t     gimple_seq *);\n+extern void cilk_gimplify_call_params_in_spawned_fn (tree *, gimple_seq *);\n extern void cilk_install_body_with_frame_cleanup (tree, tree, void *);\n extern bool cilk_detect_spawn_and_unwrap (tree *);\n extern bool cilk_set_spawn_marker (location_t, tree);"}, {"sha": "0757193beeabca08c30a2b85d93505647b49a886", "filename": "gcc/c-family/c-gimplify.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5d70666e4c20dd634283e09336c78f79fce77d77/gcc%2Fc-family%2Fc-gimplify.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5d70666e4c20dd634283e09336c78f79fce77d77/gcc%2Fc-family%2Fc-gimplify.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2Fc-gimplify.c?ref=5d70666e4c20dd634283e09336c78f79fce77d77", "patch": "@@ -277,7 +277,7 @@ c_gimplify_expr (tree *expr_p, gimple_seq *pre_p ATTRIBUTE_UNUSED,\n \n       if (!seen_error ())\n \t{\n-\t  cilk_gimplify_call_params_in_spawned_fn (expr_p, pre_p, post_p);\n+\t  cilk_gimplify_call_params_in_spawned_fn (expr_p, pre_p);\n \t  return (enum gimplify_status) gimplify_cilk_spawn (expr_p);\n \t}\n       return GS_ERROR;\n@@ -292,7 +292,7 @@ c_gimplify_expr (tree *expr_p, gimple_seq *pre_p ATTRIBUTE_UNUSED,\n \t     it is supposed to be.  */\n \t  && !seen_error ())\n \t{\n-\t  cilk_gimplify_call_params_in_spawned_fn (expr_p, pre_p, post_p);\n+\t  cilk_gimplify_call_params_in_spawned_fn (expr_p, pre_p);\n \t  return (enum gimplify_status) gimplify_cilk_spawn (expr_p);\n \t}\n "}, {"sha": "0b876b9fd6c3438527af051136a3ff760fd008b2", "filename": "gcc/c-family/cilk.c", "status": "modified", "additions": 3, "deletions": 4, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5d70666e4c20dd634283e09336c78f79fce77d77/gcc%2Fc-family%2Fcilk.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5d70666e4c20dd634283e09336c78f79fce77d77/gcc%2Fc-family%2Fcilk.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2Fcilk.c?ref=5d70666e4c20dd634283e09336c78f79fce77d77", "patch": "@@ -779,8 +779,7 @@ create_cilk_wrapper (tree exp, tree *args_out)\n    gimple sequences from the caller of gimplify_cilk_spawn.  */\n \n void\n-cilk_gimplify_call_params_in_spawned_fn (tree *expr_p, gimple_seq *pre_p,\n-\t\t\t\t\t gimple_seq *post_p)\n+cilk_gimplify_call_params_in_spawned_fn (tree *expr_p, gimple_seq *pre_p)\n {\n   int ii = 0;\n   tree *fix_parm_expr = expr_p;\n@@ -797,8 +796,8 @@ cilk_gimplify_call_params_in_spawned_fn (tree *expr_p, gimple_seq *pre_p,\n \n   if (TREE_CODE (*fix_parm_expr) == CALL_EXPR)\n     for (ii = 0; ii < call_expr_nargs (*fix_parm_expr); ii++)\n-      gimplify_expr (&CALL_EXPR_ARG (*fix_parm_expr, ii), pre_p, post_p,\n-\t\t     is_gimple_reg, fb_rvalue);\n+      gimplify_arg (&CALL_EXPR_ARG (*fix_parm_expr, ii), pre_p,\n+\t\t    EXPR_LOCATION (*fix_parm_expr));\n }\n \n "}, {"sha": "493b17afee32acf61c50b36af40754e5ff4e37ec", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5d70666e4c20dd634283e09336c78f79fce77d77/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5d70666e4c20dd634283e09336c78f79fce77d77/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=5d70666e4c20dd634283e09336c78f79fce77d77", "patch": "@@ -1,3 +1,10 @@\n+2016-01-27  Ryan Burn  <contact@rnburn.com>\n+\n+\tPR cilkplus/69267\n+\t* cp-gimplify.c (cilk_cp_gimplify_call_params_in_spawned_fn): Removed\n+\tsuperfluous post_p argument in call to\n+\tcilk_gimplify_call_params_in_spawned_fn.\n+\n 2016-01-27  Marek Polacek  <polacek@redhat.com>\n \n \tPR c++/69379"}, {"sha": "bb815340dddd9bb9f5027f45c1c7001961814681", "filename": "gcc/cp/cp-gimplify.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5d70666e4c20dd634283e09336c78f79fce77d77/gcc%2Fcp%2Fcp-gimplify.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5d70666e4c20dd634283e09336c78f79fce77d77/gcc%2Fcp%2Fcp-gimplify.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fcp-gimplify.c?ref=5d70666e4c20dd634283e09336c78f79fce77d77", "patch": "@@ -98,7 +98,7 @@ cilk_cp_gimplify_call_params_in_spawned_fn (tree *expr_p, gimple_seq *pre_p,\n {\n   int ii = 0;\n \n-  cilk_gimplify_call_params_in_spawned_fn (expr_p, pre_p, post_p);  \n+  cilk_gimplify_call_params_in_spawned_fn (expr_p, pre_p);\n   if (TREE_CODE (*expr_p) == AGGR_INIT_EXPR)\n     for (ii = 0; ii < aggr_init_expr_nargs (*expr_p); ii++)\n       gimplify_expr (&AGGR_INIT_EXPR_ARG (*expr_p, ii), pre_p, post_p,"}, {"sha": "98bb775ccac8ebdbe5d3b2a5d0da0723e28f4af2", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5d70666e4c20dd634283e09336c78f79fce77d77/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5d70666e4c20dd634283e09336c78f79fce77d77/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=5d70666e4c20dd634283e09336c78f79fce77d77", "patch": "@@ -1,3 +1,8 @@\n+2016-01-27  Ryan Burn  <contact@rnburn.com>\n+\n+\tPR cilkplus/69267\n+\t* g++.dg/cilk-plus/CK/pr69267.cc: New test.\n+\n 2016-01-27  Uros Bizjak  <ubizjak@gmail.com>\n \n \tPR target/69512"}, {"sha": "7d00e49bf38dda3cd522919ea0379030bf363e9c", "filename": "gcc/testsuite/g++.dg/cilk-plus/CK/pr69267.cc", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5d70666e4c20dd634283e09336c78f79fce77d77/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcilk-plus%2FCK%2Fpr69267.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5d70666e4c20dd634283e09336c78f79fce77d77/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcilk-plus%2FCK%2Fpr69267.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcilk-plus%2FCK%2Fpr69267.cc?ref=5d70666e4c20dd634283e09336c78f79fce77d77", "patch": "@@ -0,0 +1,10 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-fcilkplus\" } */\n+\n+struct A {};\n+\n+void f (A) {}\n+\n+void g () {\n+  _Cilk_spawn f (A ());\n+}"}]}