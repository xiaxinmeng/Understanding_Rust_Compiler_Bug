{"sha": "898c05b8bd9d73fdb3dd1e9e4e4044b0ac74a789", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODk4YzA1YjhiZDlkNzNmZGIzZGQxZTllNGU0MDQ0YjBhYzc0YTc4OQ==", "commit": {"author": {"name": "Bud Davis", "email": "bdavis@gcc.gnu.org", "date": "2004-06-09T01:03:02Z"}, "committer": {"name": "Bud Davis", "email": "bdavis@gcc.gnu.org", "date": "2004-06-09T01:03:02Z"}, "message": "re PR libfortran/14897 ('T' edit descriptor output incorrect)\n\n2004-06-09  Bud Davis  <bdavis9659@comcast.net>\n\n\tPR gfortran/14897\n\t* gfortran.fortran-torture/execute/t_edit.f90\n\n \t* io/transfer.c (formatted_transfer): position is unique\n         for T and TL edit descriptors.\n \t(data_transfer_init): set record length to size of internal\n         file.\n\nFrom-SVN: r82808", "tree": {"sha": "2750ee5b1877241a5b772185087f286b7f1a8f59", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2750ee5b1877241a5b772185087f286b7f1a8f59"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/898c05b8bd9d73fdb3dd1e9e4e4044b0ac74a789", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/898c05b8bd9d73fdb3dd1e9e4e4044b0ac74a789", "html_url": "https://github.com/Rust-GCC/gccrs/commit/898c05b8bd9d73fdb3dd1e9e4e4044b0ac74a789", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/898c05b8bd9d73fdb3dd1e9e4e4044b0ac74a789/comments", "author": null, "committer": null, "parents": [{"sha": "31b6f11ab0530374184676979781ba81b06ae38f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/31b6f11ab0530374184676979781ba81b06ae38f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/31b6f11ab0530374184676979781ba81b06ae38f"}], "stats": {"total": 50, "additions": 41, "deletions": 9}, "files": [{"sha": "d726cf08f69cbf487d6a367b5e7501b2c6bde1f2", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/898c05b8bd9d73fdb3dd1e9e4e4044b0ac74a789/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/898c05b8bd9d73fdb3dd1e9e4e4044b0ac74a789/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=898c05b8bd9d73fdb3dd1e9e4e4044b0ac74a789", "patch": "@@ -1,3 +1,8 @@\n+2004-06-09  Bud Davis  <bdavis9659@comcast.net>\n+\n+\tPR gfortran/14897\n+\t* gfortran.fortran-torture/execute/t_edit.f90\n+\n 2004-06-09  Bud Davis  <bdavis9659@comcast.net>\n                                                                                     \n         PR gfortran/15755"}, {"sha": "9746f31947a177aa91db37d7768e4557c617412e", "filename": "gcc/testsuite/gfortran.fortran-torture/execute/t_edit.f90", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/898c05b8bd9d73fdb3dd1e9e4e4044b0ac74a789/gcc%2Ftestsuite%2Fgfortran.fortran-torture%2Fexecute%2Ft_edit.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/898c05b8bd9d73fdb3dd1e9e4e4044b0ac74a789/gcc%2Ftestsuite%2Fgfortran.fortran-torture%2Fexecute%2Ft_edit.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.fortran-torture%2Fexecute%2Ft_edit.f90?ref=898c05b8bd9d73fdb3dd1e9e4e4044b0ac74a789", "patch": "@@ -0,0 +1,11 @@\n+!pr 14897  T edit descriptor broken\n+      implicit none\n+      character*80 line\n+      WRITE(line,'(T5,A,T10,A,T15,A)')'AA','BB','CC'\n+      if (line.ne.'    AA   BB   CC    ') call abort\n+      WRITE(line,'(5HAAAAA,TL4,4HABCD)')\n+      if (line.ne.'AABCD') call abort\n+      END\n+\n+\n+"}, {"sha": "e9f17ee05bd24d98e8ecd75d5e6088fbb883ace9", "filename": "libgfortran/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/898c05b8bd9d73fdb3dd1e9e4e4044b0ac74a789/libgfortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/898c05b8bd9d73fdb3dd1e9e4e4044b0ac74a789/libgfortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2FChangeLog?ref=898c05b8bd9d73fdb3dd1e9e4e4044b0ac74a789", "patch": "@@ -1,3 +1,11 @@\n+2004-06-09  Bud Davis  <bdavis9659@comcaste.net>\n+\n+\tPR gfortran/14897\n+\t* io/transfer.c (formatted_transfer): position is unique\n+         for T and TL edit descriptors.\n+ \t(data_transfer_init): set record length to size of internal\n+         file.\n+\n 2004-06-09  Bud Davis  <bdavis9659@comcast.net>\n \n \tPR gfortran/15755"}, {"sha": "04b7c5a7ac23c3c7cddd9e19d5c12309085e2734", "filename": "libgfortran/io/transfer.c", "status": "modified", "additions": 17, "deletions": 9, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/898c05b8bd9d73fdb3dd1e9e4e4044b0ac74a789/libgfortran%2Fio%2Ftransfer.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/898c05b8bd9d73fdb3dd1e9e4e4044b0ac74a789/libgfortran%2Fio%2Ftransfer.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fio%2Ftransfer.c?ref=898c05b8bd9d73fdb3dd1e9e4e4044b0ac74a789", "patch": "@@ -608,14 +608,18 @@ formatted_transfer (bt type, void *p, int len)\n \n \t  break;\n \n-        case FMT_T:\n-           pos = f->u.n ;\n-           pos= current_unit->recl - current_unit->bytes_left - pos;\n-                         /* fall through */\n-\n         case FMT_TL:\n-           consume_data_flag = 0 ;\n-           pos = f->u.n ;\n+        case FMT_T:\n+           if (f->format==FMT_TL)\n+             {\n+                pos = f->u.n ;\n+                pos= current_unit->recl - current_unit->bytes_left - pos;\n+             }\n+           else // FMT==T\n+             {\n+                consume_data_flag = 0 ;\n+                pos = f->u.n - 1; \n+             }\n \n            if (pos < 0 || pos >= current_unit->recl )\n            {\n@@ -898,8 +902,12 @@ data_transfer_init (int read_flag)\n   if (current_unit == NULL)\n     return;\n \n-  if (is_internal_unit() && g.mode==WRITING)\n-    empty_internal_buffer (current_unit->s);\n+  if (is_internal_unit())\n+    {\n+      current_unit->recl = file_length(current_unit->s);\n+      if (g.mode==WRITING)\n+        empty_internal_buffer (current_unit->s);\n+    }\n \n   /* Check the action */\n "}]}