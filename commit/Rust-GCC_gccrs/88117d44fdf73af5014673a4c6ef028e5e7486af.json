{"sha": "88117d44fdf73af5014673a4c6ef028e5e7486af", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODgxMTdkNDRmZGY3M2FmNTAxNDY3M2E0YzZlZjAyOGU1ZTc0ODZhZg==", "commit": {"author": {"name": "Nick Clifton", "email": "nickc@cygnus.com", "date": "1998-05-17T23:08:40Z"}, "committer": {"name": "Jeff Law", "email": "law@gcc.gnu.org", "date": "1998-05-17T23:08:40Z"}, "message": "gcc.c (SWITCH_CURTAILS_COMPILATION): Definition.\n\n        * gcc.c (SWITCH_CURTAILS_COMPILATION): Definition.\n        (DEFAULT_SWITCH_CURTAILS_COMPILATION): True for options -S and -c.\n        (process_command): If HAVE_EXECUTABLE_SUFFIX is defined then scan\n        command line arguments to see if an executable is not being\n        created, and if so - do not append the suffix.\n        * tm.texi (SWITCH_CURTAILS_COMPILATION): Add description of new\n        driver macro.\n\nFrom-SVN: r19824", "tree": {"sha": "2f16e1bc3300b7a15436e611d2cf3152a373c390", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2f16e1bc3300b7a15436e611d2cf3152a373c390"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/88117d44fdf73af5014673a4c6ef028e5e7486af", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/88117d44fdf73af5014673a4c6ef028e5e7486af", "html_url": "https://github.com/Rust-GCC/gccrs/commit/88117d44fdf73af5014673a4c6ef028e5e7486af", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/88117d44fdf73af5014673a4c6ef028e5e7486af/comments", "author": null, "committer": null, "parents": [{"sha": "e5e8a8bf3921f126e8ce4e14b02d99ceaa6805c7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e5e8a8bf3921f126e8ce4e14b02d99ceaa6805c7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e5e8a8bf3921f126e8ce4e14b02d99ceaa6805c7"}], "stats": {"total": 73, "additions": 71, "deletions": 2}, "files": [{"sha": "831cd540031a8f1e073f320a65f98d1eb6067740", "filename": "gcc/ChangeLog", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/88117d44fdf73af5014673a4c6ef028e5e7486af/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/88117d44fdf73af5014673a4c6ef028e5e7486af/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=88117d44fdf73af5014673a4c6ef028e5e7486af", "patch": "@@ -1,3 +1,14 @@\n+Mon May 18 00:08:19 1998  Nick Clifton  <nickc@cygnus.com>\n+\n+\t* gcc.c (SWITCH_CURTAILS_COMPILATION): Definition.\n+\t(DEFAULT_SWITCH_CURTAILS_COMPILATION): True for options -S and -c.\n+\t(process_command): If HAVE_EXECUTABLE_SUFFIX is defined then scan\n+\tcommand line arguments to see if an executable is not being\n+\tcreated, and if so - do not append the suffix.\n+\n+\t* tm.texi (SWITCH_CURTAILS_COMPILATION): Add description of new\n+\tdriver macro.\n+\n Sun May 17 23:59:45 1998  John Wehle  (john@feith.com)\n \n \t* i386.h (ALIGN_DFmode): Delete."}, {"sha": "c2c1af628094838ea33a845d419c5654b71307e6", "filename": "gcc/gcc.c", "status": "modified", "additions": 45, "deletions": 2, "changes": 47, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/88117d44fdf73af5014673a4c6ef028e5e7486af/gcc%2Fgcc.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/88117d44fdf73af5014673a4c6ef028e5e7486af/gcc%2Fgcc.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgcc.c?ref=88117d44fdf73af5014673a4c6ef028e5e7486af", "patch": "@@ -536,6 +536,18 @@ static struct user_specs *user_specs_head, *user_specs_tail;\n #define WORD_SWITCH_TAKES_ARG(STR) DEFAULT_WORD_SWITCH_TAKES_ARG (STR)\n #endif\n \f\n+\n+#ifdef HAVE_EXECUTABLE_SUFFIX\n+/* This defines which switches stop a full compilation.  */\n+#define DEFAULT_SWITCH_CURTAILS_COMPILATION(CHAR) \\\n+  ((CHAR) == 'c' || (CHAR) == 'S')\n+\n+#ifndef SWITCH_CURTAILS_COMPILATION\n+#define SWITCH_CURTAILS_COMPILATION(CHAR) \\\n+  DEFAULT_SWITCH_CURTAILS_COMPILATION(CHAR)\n+#endif\n+#endif\n+\n /* Record the mapping from file suffixes for compilation specs.  */\n \n struct compiler\n@@ -2780,6 +2792,7 @@ process_command (argc, argv)\n \t      }\n \t      break;\n \n+\t    case 'S':\n \t    case 'c':\n \t      if (p[1] == 0)\n \t\t{\n@@ -2791,10 +2804,40 @@ process_command (argc, argv)\n \n \t    case 'o':\n \t      have_o = 1;\n+#if defined(HAVE_EXECUTABLE_SUFFIX)\n+\t      if (! have_c)\n+\t\t{\n+\t\t  int skip;\n+\t\t  \n+\t\t  /* Forward scan, just in case -S or -c is specified\n+\t\t     after -o.  */\n+\t\t  int j = i + 1;\n+\t\t  if (p[1] == 0)\n+\t\t    ++j;\n+\t\t  while (j < argc)\n+\t\t    {\n+\t\t      if (argv[j][0] == '-')\n+\t\t\t{\n+\t\t\t  if (SWITCH_CURTAILS_COMPILATION (argv[j][1])\n+\t\t\t      && argv[j][2] == 0)\n+\t\t\t    {\n+\t\t\t      have_c = 1;\n+\t\t\t      break;\n+\t\t\t    }\n+\t\t\t  else if (skip = SWITCH_TAKES_ARG (argv[j][1]))\n+\t\t\t    j += skip - (argv[j][2] != 0);\n+\t\t\t  else if (skip = WORD_SWITCH_TAKES_ARG (argv[j] + 1))\n+\t\t\t    j += skip;\n+\t\t\t}\n+\t\t      j++;\n+\t\t    }\n+\t\t}\n+#endif\n #if defined(HAVE_EXECUTABLE_SUFFIX) || defined(HAVE_OBJECT_SUFFIX)\n-\t      argv[i] = convert_filename (argv[i], 1);\n \t      if (p[1] == 0)\n-\t\targv[i+1] = convert_filename (argv[i+1], 1);\n+\t\targv[i+1] = convert_filename (argv[i+1], ! have_c);\n+\t      else\n+\t\targv[i] = convert_filename (argv[i], ! have_c);\n #endif\n \t      goto normal_switch;\n "}, {"sha": "9ae707403b53b8a7991a1934674dc2f902ae9600", "filename": "gcc/tm.texi", "status": "modified", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/88117d44fdf73af5014673a4c6ef028e5e7486af/gcc%2Ftm.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/88117d44fdf73af5014673a4c6ef028e5e7486af/gcc%2Ftm.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftm.texi?ref=88117d44fdf73af5014673a4c6ef028e5e7486af", "patch": "@@ -76,6 +76,21 @@ wish to add additional options which take arguments.  Any redefinition\n should call @code{DEFAULT_WORD_SWITCH_TAKES_ARG} and then check for\n additional options.\n \n+@findex SWITCH_CURTAILS_COMPILATION\n+@item SWITCH_CURTAILS_COMPILATION (@var{char})\n+A C expression which determines whether the option @samp{-@var{char}}\n+stops compilation before the generation of an executable.  The value is\n+boolean, non-zero if the option does stop an executable from being\n+generated, zero otherwise.\n+\n+By default, this macro is defined as\n+@code{DEFAULT_SWITCH_CURTAILS_COMPILATION}, which handles the standard\n+options properly.  You need not define\n+@code{SWITCH_CURTAILS_COMPILATION} unless you wish to add additional\n+options which affect the generation of an executable.  Any redefinition\n+should call @code{DEFAULT_SWITCH_CURTAILS_COMPILATION} and then check\n+for additional options.\n+\n @findex SWITCHES_NEED_SPACES\n @item SWITCHES_NEED_SPACES\n A string-valued C expression which enumerates the options for which"}]}