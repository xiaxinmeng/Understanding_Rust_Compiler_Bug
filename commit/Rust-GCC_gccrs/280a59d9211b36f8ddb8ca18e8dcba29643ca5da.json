{"sha": "280a59d9211b36f8ddb8ca18e8dcba29643ca5da", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjgwYTU5ZDkyMTFiMzZmOGRkYjhjYTE4ZThkY2JhMjk2NDNjYTVkYQ==", "commit": {"author": {"name": "Xionghu Luo", "email": "luoxhu@linux.ibm.com", "date": "2021-01-29T02:47:07Z"}, "committer": {"name": "Xionghu Luo", "email": "luoxhu@linux.ibm.com", "date": "2021-01-29T07:33:09Z"}, "message": "testsuite: Run vec_insert case on P8 and P9 with option specified\n\nMove run_test and TEST_VEC_INSERT_ALL to header file for share usage.\n\ngcc/testsuite/ChangeLog:\n\n2021-01-29  Xionghu Luo  <luoxhu@linux.ibm.com>\n\n\t* gcc.target/powerpc/pr79251.p8.c: Move TEST_VEC_INSERT_ALL\n\tto ...\n\t* gcc.target/powerpc/pr79251.h: ...this.\n\t* gcc.target/powerpc/pr79251.p9.c: Likewise.\n\t* gcc.target/powerpc/pr79251-run.c: Move run_test to pr79251.h.\n\tRename to...\n\t* gcc.target/powerpc/pr79251-run.p8.c: ...this.\n\t* gcc.target/powerpc/pr79251-run.p9.c: New test.", "tree": {"sha": "6125b335459ad44b2a9b8bd5bba96c22b1808e69", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6125b335459ad44b2a9b8bd5bba96c22b1808e69"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/280a59d9211b36f8ddb8ca18e8dcba29643ca5da", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/280a59d9211b36f8ddb8ca18e8dcba29643ca5da", "html_url": "https://github.com/Rust-GCC/gccrs/commit/280a59d9211b36f8ddb8ca18e8dcba29643ca5da", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/280a59d9211b36f8ddb8ca18e8dcba29643ca5da/comments", "author": {"login": "xionghul", "id": 4607154, "node_id": "MDQ6VXNlcjQ2MDcxNTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/4607154?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xionghul", "html_url": "https://github.com/xionghul", "followers_url": "https://api.github.com/users/xionghul/followers", "following_url": "https://api.github.com/users/xionghul/following{/other_user}", "gists_url": "https://api.github.com/users/xionghul/gists{/gist_id}", "starred_url": "https://api.github.com/users/xionghul/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xionghul/subscriptions", "organizations_url": "https://api.github.com/users/xionghul/orgs", "repos_url": "https://api.github.com/users/xionghul/repos", "events_url": "https://api.github.com/users/xionghul/events{/privacy}", "received_events_url": "https://api.github.com/users/xionghul/received_events", "type": "User", "site_admin": false}, "committer": {"login": "xionghul", "id": 4607154, "node_id": "MDQ6VXNlcjQ2MDcxNTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/4607154?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xionghul", "html_url": "https://github.com/xionghul", "followers_url": "https://api.github.com/users/xionghul/followers", "following_url": "https://api.github.com/users/xionghul/following{/other_user}", "gists_url": "https://api.github.com/users/xionghul/gists{/gist_id}", "starred_url": "https://api.github.com/users/xionghul/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xionghul/subscriptions", "organizations_url": "https://api.github.com/users/xionghul/orgs", "repos_url": "https://api.github.com/users/xionghul/repos", "events_url": "https://api.github.com/users/xionghul/events{/privacy}", "received_events_url": "https://api.github.com/users/xionghul/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f8f5388c9e94d4324c31d82b335fa138518e3171", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f8f5388c9e94d4324c31d82b335fa138518e3171", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f8f5388c9e94d4324c31d82b335fa138518e3171"}], "stats": {"total": 79, "additions": 45, "deletions": 34}, "files": [{"sha": "6afd357c7ba8990d12c7ec5fd168ff87559b21af", "filename": "gcc/testsuite/gcc.target/powerpc/pr79251-run.c", "status": "removed", "additions": 0, "deletions": 30, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f8f5388c9e94d4324c31d82b335fa138518e3171/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr79251-run.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f8f5388c9e94d4324c31d82b335fa138518e3171/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr79251-run.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr79251-run.c?ref=f8f5388c9e94d4324c31d82b335fa138518e3171", "patch": "@@ -1,30 +0,0 @@\n-/* { dg-do run } */\n-/* { dg-require-effective-target vsx_hw } */\n-/* { dg-options \"-O2 -mvsx\" } */\n-\n-#include <stddef.h>\n-#include <altivec.h>\n-#include \"pr79251.h\"\n-\n-TEST_VEC_INSERT_ALL (test)\n-\n-#define run_test(TYPE, num)                                                    \\\n-  {                                                                            \\\n-    vector TYPE v;                                                             \\\n-    vector TYPE u = {0x0};                                                     \\\n-    for (long k = 0; k < 16 / sizeof (TYPE); k++)                              \\\n-      v[k] = 0xaa;                                                             \\\n-    for (long k = 0; k < 16 / sizeof (TYPE); k++)                              \\\n-      {                                                                        \\\n-\tu = test##num (v, 254, k);                                             \\\n-\tif (u[k] != (TYPE) 254)                                                \\\n-\t  __builtin_abort ();                                                  \\\n-      }                                                                        \\\n-  }\n-\n-int\n-main (void)\n-{\n-  TEST_VEC_INSERT_ALL (run_test)\n-  return 0;\n-}"}, {"sha": "47d4d288f3c42f97002f9169dbb96a199f3cb404", "filename": "gcc/testsuite/gcc.target/powerpc/pr79251-run.p8.c", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/280a59d9211b36f8ddb8ca18e8dcba29643ca5da/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr79251-run.p8.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/280a59d9211b36f8ddb8ca18e8dcba29643ca5da/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr79251-run.p8.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr79251-run.p8.c?ref=280a59d9211b36f8ddb8ca18e8dcba29643ca5da", "patch": "@@ -0,0 +1,14 @@\n+/* { dg-do run } */\n+/* { dg-require-effective-target p8vector_hw } */\n+/* { dg-options \"-O2 -mvsx -mdejagnu-cpu=power8\" } */\n+\n+#include <stddef.h>\n+#include <altivec.h>\n+#include \"pr79251.h\"\n+\n+int\n+main (void)\n+{\n+  TEST_VEC_INSERT_ALL (run_test)\n+  return 0;\n+}"}, {"sha": "fd56b2356f46a27abec5ecddf8a29106d2934c2d", "filename": "gcc/testsuite/gcc.target/powerpc/pr79251-run.p9.c", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/280a59d9211b36f8ddb8ca18e8dcba29643ca5da/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr79251-run.p9.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/280a59d9211b36f8ddb8ca18e8dcba29643ca5da/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr79251-run.p9.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr79251-run.p9.c?ref=280a59d9211b36f8ddb8ca18e8dcba29643ca5da", "patch": "@@ -0,0 +1,14 @@\n+/* { dg-do run } */\n+/* { dg-require-effective-target p9vector_hw } */\n+/* { dg-options \"-O2 -mvsx -mdejagnu-cpu=power9\" } */\n+\n+#include <stddef.h>\n+#include <altivec.h>\n+#include \"pr79251.h\"\n+\n+int\n+main (void)\n+{\n+  TEST_VEC_INSERT_ALL (run_test)\n+  return 0;\n+}"}, {"sha": "2684b66096634775e352cfa1098742a085c301bb", "filename": "gcc/testsuite/gcc.target/powerpc/pr79251.h", "status": "modified", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/280a59d9211b36f8ddb8ca18e8dcba29643ca5da/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr79251.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/280a59d9211b36f8ddb8ca18e8dcba29643ca5da/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr79251.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr79251.h?ref=280a59d9211b36f8ddb8ca18e8dcba29643ca5da", "patch": "@@ -17,3 +17,20 @@\n   T (unsigned long long, 7)                                                    \\\n   T (float, 8)                                                                 \\\n   T (double, 9)\n+\n+TEST_VEC_INSERT_ALL (test)\n+\n+#define run_test(TYPE, num)                                                    \\\n+  {                                                                            \\\n+    vector TYPE v;                                                             \\\n+    vector TYPE u = {0x0};                                                     \\\n+    for (long k = 0; k < 16 / sizeof (TYPE); k++)                              \\\n+      v[k] = 0xaa;                                                             \\\n+    for (long k = 0; k < 16 / sizeof (TYPE); k++)                              \\\n+      {                                                                        \\\n+\tu = test##num (v, 254, k);                                             \\\n+\tif (u[k] != (TYPE) 254)                                                \\\n+\t  __builtin_abort ();                                                  \\\n+      }                                                                        \\\n+  }\n+"}, {"sha": "77e8cbb55ccfc9f108b765f073d3e997525ffa85", "filename": "gcc/testsuite/gcc.target/powerpc/pr79251.p8.c", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/280a59d9211b36f8ddb8ca18e8dcba29643ca5da/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr79251.p8.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/280a59d9211b36f8ddb8ca18e8dcba29643ca5da/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr79251.p8.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr79251.p8.c?ref=280a59d9211b36f8ddb8ca18e8dcba29643ca5da", "patch": "@@ -6,8 +6,6 @@\n #include <altivec.h>\n #include \"pr79251.h\"\n \n-TEST_VEC_INSERT_ALL (test)\n-\n /* { dg-final { scan-assembler-not {\\mstxw\\M} } } */\n /* { dg-final { scan-assembler-times {\\mlvsl\\M} 10 { target lp64 } } } */\n /* { dg-final { scan-assembler-times {\\mlvsr\\M} 3 { target lp64 } } } */"}, {"sha": "d4095d38319ef088cd55d4c617b25868d77beb23", "filename": "gcc/testsuite/gcc.target/powerpc/pr79251.p9.c", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/280a59d9211b36f8ddb8ca18e8dcba29643ca5da/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr79251.p9.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/280a59d9211b36f8ddb8ca18e8dcba29643ca5da/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr79251.p9.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr79251.p9.c?ref=280a59d9211b36f8ddb8ca18e8dcba29643ca5da", "patch": "@@ -6,8 +6,6 @@\n #include <altivec.h>\n #include \"pr79251.h\"\n \n-TEST_VEC_INSERT_ALL (test)\n-\n /* { dg-final { scan-assembler-not {\\mstxw\\M} } } */\n /* { dg-final { scan-assembler-times {\\mlvsl\\M} 10 { target lp64 } } } */\n /* { dg-final { scan-assembler-times {\\mlvsr\\M} 10 { target lp64 } } } */"}]}