{"sha": "5e750dc69f9e2580bed0d45bd0383622cc272b39", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NWU3NTBkYzY5ZjllMjU4MGJlZDBkNDViZDAzODM2MjJjYzI3MmIzOQ==", "commit": {"author": {"name": "Jan Hubicka", "email": "hubicka@ucw.cz", "date": "2014-04-17T18:35:54Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2014-04-17T18:35:54Z"}, "message": "ipa-inline.c (inline_small_functions): Account only non-cold functions.\n\n\n\t* ipa-inline.c (inline_small_functions): Account only non-cold\n\tfunctions.\n\t* doc/invoke.texi (inline-unit-growth): Update documentation.\n\nFrom-SVN: r209490", "tree": {"sha": "d9d58ac41ea36e27fed4e20250e6280a4154de93", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d9d58ac41ea36e27fed4e20250e6280a4154de93"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5e750dc69f9e2580bed0d45bd0383622cc272b39", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5e750dc69f9e2580bed0d45bd0383622cc272b39", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5e750dc69f9e2580bed0d45bd0383622cc272b39", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5e750dc69f9e2580bed0d45bd0383622cc272b39/comments", "author": null, "committer": null, "parents": [{"sha": "32337f1014e18221050f034723d3b75f2b08c908", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/32337f1014e18221050f034723d3b75f2b08c908", "html_url": "https://github.com/Rust-GCC/gccrs/commit/32337f1014e18221050f034723d3b75f2b08c908"}], "stats": {"total": 14, "additions": 12, "deletions": 2}, "files": [{"sha": "b9874c0c9d507e7d44a0d1cdbbf0f567e21419ab", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5e750dc69f9e2580bed0d45bd0383622cc272b39/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5e750dc69f9e2580bed0d45bd0383622cc272b39/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=5e750dc69f9e2580bed0d45bd0383622cc272b39", "patch": "@@ -1,3 +1,9 @@\n+2014-04-17  Jan Hubicka  <hubicka@ucw.cz>\n+\n+\t* ipa-inline.c (inline_small_functions): Account only non-cold\n+\tfunctions.\n+\t* doc/invoke.texi (inline-unit-growth): Update documentation.\n+\n 2014-04-17  Pat Haugen  <pthaugen@us.ibm.com>\n \n \t* config/rs6000/rs6000.md (addti3, subti3): New."}, {"sha": "8004da86f4f50b7126c28af30669b3055244121e", "filename": "gcc/doc/invoke.texi", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5e750dc69f9e2580bed0d45bd0383622cc272b39/gcc%2Fdoc%2Finvoke.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5e750dc69f9e2580bed0d45bd0383622cc272b39/gcc%2Fdoc%2Finvoke.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdoc%2Finvoke.texi?ref=5e750dc69f9e2580bed0d45bd0383622cc272b39", "patch": "@@ -9409,7 +9409,8 @@ before applying @option{--param inline-unit-growth}.  The default is 10000.\n @item inline-unit-growth\n Specifies maximal overall growth of the compilation unit caused by inlining.\n The default value is 30 which limits unit growth to 1.3 times the original\n-size.\n+size. Cold functions (either marked cold via an attribibute or by profile\n+feedback) are not accounted into the unit size.\n \n @item ipcp-unit-growth\n Specifies maximal overall growth of the compilation unit caused by"}, {"sha": "e8f03be397b86c862134c8b8658c022f2d5bf059", "filename": "gcc/ipa-inline.c", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5e750dc69f9e2580bed0d45bd0383622cc272b39/gcc%2Fipa-inline.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5e750dc69f9e2580bed0d45bd0383622cc272b39/gcc%2Fipa-inline.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-inline.c?ref=5e750dc69f9e2580bed0d45bd0383622cc272b39", "patch": "@@ -1585,7 +1585,10 @@ inline_small_functions (void)\n \t    struct inline_summary *info = inline_summary (node);\n \t    struct ipa_dfs_info *dfs = (struct ipa_dfs_info *) node->aux;\n \n-\t    if (!DECL_EXTERNAL (node->decl))\n+\t    /* Do not account external functions, they will be optimized out\n+\t       if not inlined.  Also only count the non-cold portion of program.  */\n+\t    if (!DECL_EXTERNAL (node->decl)\n+\t\t&& node->frequency != NODE_FREQUENCY_UNLIKELY_EXECUTED)\n \t      initial_size += info->size;\n \t    info->growth = estimate_growth (node);\n \t    if (dfs && dfs->next_cycle)"}]}