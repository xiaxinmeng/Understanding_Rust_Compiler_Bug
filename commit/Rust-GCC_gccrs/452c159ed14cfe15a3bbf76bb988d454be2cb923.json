{"sha": "452c159ed14cfe15a3bbf76bb988d454be2cb923", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDUyYzE1OWVkMTRjZmUxNWEzYmJmNzZiYjk4OGQ0NTRiZTJjYjkyMw==", "commit": {"author": {"name": "Ulrich Weigand", "email": "uweigand@de.ibm.com", "date": "2004-03-10T15:12:10Z"}, "committer": {"name": "Ulrich Weigand", "email": "uweigand@gcc.gnu.org", "date": "2004-03-10T15:12:10Z"}, "message": "dbxout.c (dbxout_symbol_location): Do not output references to optimized-out constant pool symbols.\n\n\t* dbxout.c (dbxout_symbol_location): Do not output references\n\tto optimized-out constant pool symbols.\n\nFrom-SVN: r79258", "tree": {"sha": "3cf536be37878e40f9fa8a49def5a1b619f506eb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3cf536be37878e40f9fa8a49def5a1b619f506eb"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/452c159ed14cfe15a3bbf76bb988d454be2cb923", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/452c159ed14cfe15a3bbf76bb988d454be2cb923", "html_url": "https://github.com/Rust-GCC/gccrs/commit/452c159ed14cfe15a3bbf76bb988d454be2cb923", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/452c159ed14cfe15a3bbf76bb988d454be2cb923/comments", "author": null, "committer": null, "parents": [{"sha": "f69535d2b7b0fca2642a0b77ff373215277861fa", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f69535d2b7b0fca2642a0b77ff373215277861fa", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f69535d2b7b0fca2642a0b77ff373215277861fa"}], "stats": {"total": 29, "additions": 25, "deletions": 4}, "files": [{"sha": "48f98f2603ffb7ee3b2df94a71930a84347a0c1d", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/452c159ed14cfe15a3bbf76bb988d454be2cb923/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/452c159ed14cfe15a3bbf76bb988d454be2cb923/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=452c159ed14cfe15a3bbf76bb988d454be2cb923", "patch": "@@ -1,3 +1,8 @@\n+2004-03-10  Ulrich Weigand  <uweigand@de.ibm.com>\n+\n+\t* dbxout.c (dbxout_symbol_location): Do not output references\n+\tto optimized-out constant pool symbols.\n+\n 2004-03-10  Andreas Schwab  <schwab@suse.de>\n \n \t* config/ia64/ia64.md (divsi3, udivsi3): Remove unused variable"}, {"sha": "2e7c1eb177707921ca338498bdb96c78d75b66fc", "filename": "gcc/dbxout.c", "status": "modified", "additions": 20, "deletions": 4, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/452c159ed14cfe15a3bbf76bb988d454be2cb923/gcc%2Fdbxout.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/452c159ed14cfe15a3bbf76bb988d454be2cb923/gcc%2Fdbxout.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdbxout.c?ref=452c159ed14cfe15a3bbf76bb988d454be2cb923", "patch": "@@ -2503,11 +2503,27 @@ dbxout_symbol_location (tree decl, tree type, const char *suffix, rtx home)\n \t      if (GET_CODE (current_sym_addr) == SYMBOL_REF\n \t\t  && CONSTANT_POOL_ADDRESS_P (current_sym_addr))\n \t\t{\n-\t\t  rtx tmp = get_pool_constant (current_sym_addr);\n+\t\t  bool marked;\n+\t\t  rtx tmp = get_pool_constant_mark (current_sym_addr, &marked);\n \n-\t\t  if (GET_CODE (tmp) == SYMBOL_REF\n-\t\t      || GET_CODE (tmp) == LABEL_REF)\n-\t\t    current_sym_addr = tmp;\n+\t\t  if (GET_CODE (tmp) == SYMBOL_REF)\n+\t\t    {\n+\t\t      current_sym_addr = tmp;\n+\t\t      if (CONSTANT_POOL_ADDRESS_P (current_sym_addr))\n+\t\t        get_pool_constant_mark (current_sym_addr, &marked);\n+\t\t      else\n+\t\t\tmarked = true;\n+\t\t    }\n+\t\t  else if (GET_CODE (tmp) == LABEL_REF)\n+\t\t    {\n+\t\t      current_sym_addr = tmp;\n+\t\t      marked = true;\n+\t\t    }\n+\n+\t\t   /* If all references to the constant pool were optimized\n+\t\t      out, we just ignore the symbol.  */\n+\t\t  if (!marked)\n+\t\t    return 0;\n \t\t}\n \n \t      /* Ultrix `as' seems to need this.  */"}]}