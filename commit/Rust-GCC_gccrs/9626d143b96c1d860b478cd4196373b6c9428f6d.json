{"sha": "9626d143b96c1d860b478cd4196373b6c9428f6d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTYyNmQxNDNiOTZjMWQ4NjBiNDc4Y2Q0MTk2MzczYjZjOTQyOGY2ZA==", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2015-05-19T09:36:35Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2015-05-19T09:36:35Z"}, "message": "re PR tree-optimization/66165 (vect_transform_slp_perm_load: vec out of range ?)\n\n2015-05-19  Richard Biener  <rguenther@suse.de>\n\n\tPR tree-optimization/66165\n\t* tree-vect-slp.c (vect_supported_load_permutation_p): Add guard\n\tfor no load permutation.\n\n\t* gcc.dg/torture/pr66165.c: New testcase.\n\n\tPR tree-optimization/66185\n\t* tree-vect-slp.c (vect_build_slp_tree): Properly roll back\n\twhen building the SLP node from scalars.\n\n\t* gcc.dg/torture/pr66185.c: New testcase.\n\nFrom-SVN: r223349", "tree": {"sha": "74ed8779cf358a8c314b9e9bf52677f36112fa68", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/74ed8779cf358a8c314b9e9bf52677f36112fa68"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9626d143b96c1d860b478cd4196373b6c9428f6d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9626d143b96c1d860b478cd4196373b6c9428f6d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9626d143b96c1d860b478cd4196373b6c9428f6d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9626d143b96c1d860b478cd4196373b6c9428f6d/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "d33606c30678cbccf0e95840e7dc48918ff1e21e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d33606c30678cbccf0e95840e7dc48918ff1e21e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d33606c30678cbccf0e95840e7dc48918ff1e21e"}], "stats": {"total": 54, "additions": 54, "deletions": 0}, "files": [{"sha": "ed64b470784a9e1ce68eb2492afc02dc4041cfa4", "filename": "gcc/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9626d143b96c1d860b478cd4196373b6c9428f6d/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9626d143b96c1d860b478cd4196373b6c9428f6d/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=9626d143b96c1d860b478cd4196373b6c9428f6d", "patch": "@@ -1,3 +1,13 @@\n+2015-05-19  Richard Biener  <rguenther@suse.de>\n+\n+\tPR tree-optimization/66165\n+\t* tree-vect-slp.c (vect_supported_load_permutation_p): Add guard\n+\tfor no load permutation.\n+\n+\tPR tree-optimization/66185\n+\t* tree-vect-slp.c (vect_build_slp_tree): Properly roll back\n+\twhen building the SLP node from scalars.\n+\n 2015-05-19  Eric Botcazou  <ebotcazou@adacore.com>\n \t    Tristan Gingold  <gingold@adacore.com>\n "}, {"sha": "cffec1b62db9260d3b5ee781715bf31f308d0c3c", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9626d143b96c1d860b478cd4196373b6c9428f6d/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9626d143b96c1d860b478cd4196373b6c9428f6d/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=9626d143b96c1d860b478cd4196373b6c9428f6d", "patch": "@@ -1,3 +1,11 @@\n+2015-05-19  Richard Biener  <rguenther@suse.de>\n+\n+\tPR tree-optimization/66165\n+\t* gcc.dg/torture/pr66165.c: New testcase.\n+\n+\tPR tree-optimization/66185\n+\t* gcc.dg/torture/pr66185.c: New testcase.\n+\n 2015-05-19  Oleg Endo  <olegendo@gcc.gnu.org>\n \n \tPR target/54236"}, {"sha": "07407d05019a9a5bd228d2e0efcd187ebed00fc9", "filename": "gcc/testsuite/gcc.dg/torture/pr66165.c", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9626d143b96c1d860b478cd4196373b6c9428f6d/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr66165.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9626d143b96c1d860b478cd4196373b6c9428f6d/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr66165.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr66165.c?ref=9626d143b96c1d860b478cd4196373b6c9428f6d", "patch": "@@ -0,0 +1,11 @@\n+/* { dg-do compile } */\n+\n+void foo(double *d, double *a)\n+{\n+  d[0] += d[2];\n+  d[1] += d[3];\n+  d[2] += d[4];\n+  d[3] += d[5];\n+  a[0] = d[0];\n+  a[1] = d[1];\n+}"}, {"sha": "5a57ac1d76c1f340602d789559374b8a6e81d901", "filename": "gcc/testsuite/gcc.dg/torture/pr66185.c", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9626d143b96c1d860b478cd4196373b6c9428f6d/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr66185.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9626d143b96c1d860b478cd4196373b6c9428f6d/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr66185.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr66185.c?ref=9626d143b96c1d860b478cd4196373b6c9428f6d", "patch": "@@ -0,0 +1,13 @@\n+/* { dg-do compile } */\n+\n+unsigned int a;\n+int b[5], c;\n+\n+int\n+main ()\n+{\n+  for (c = 0; c < 4; c++)\n+    b[c] = b[c+1] > ((b[0] > 0) > a);\n+\n+  return 0;\n+}"}, {"sha": "cad1604b438909413e4724a385014fc15deddf29", "filename": "gcc/tree-vect-slp.c", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9626d143b96c1d860b478cd4196373b6c9428f6d/gcc%2Ftree-vect-slp.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9626d143b96c1d860b478cd4196373b6c9428f6d/gcc%2Ftree-vect-slp.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-vect-slp.c?ref=9626d143b96c1d860b478cd4196373b6c9428f6d", "patch": "@@ -1103,6 +1103,16 @@ vect_build_slp_tree (loop_vec_info loop_vinfo, bb_vec_info bb_vinfo,\n \t     scalar version.  */\n \t  && !is_pattern_stmt_p (vinfo_for_stmt (stmt)))\n \t{\n+\t  unsigned int j;\n+\t  slp_tree grandchild;\n+\n+\t  /* Roll back.  */\n+\t  *max_nunits = old_max_nunits;\n+\t  loads->truncate (old_nloads);\n+\t  FOR_EACH_VEC_ELT (SLP_TREE_CHILDREN (child), j, grandchild)\n+\t    vect_free_slp_tree (grandchild);\n+\t  SLP_TREE_CHILDREN (child).truncate (0);\n+\n \t  dump_printf_loc (MSG_NOTE, vect_location,\n \t\t\t   \"Building vector operands from scalars\\n\");\n \t  oprnd_info->def_stmts = vNULL;\n@@ -1400,6 +1410,8 @@ vect_supported_load_permutation_p (slp_instance slp_instn)\n          no permutation is necessary.  */\n       FOR_EACH_VEC_ELT (SLP_INSTANCE_LOADS (slp_instn), i, node)\n         {\n+\t  if (!SLP_TREE_LOAD_PERMUTATION (node).exists ())\n+\t    continue;\n \t  bool subchain_p = true;\n           next_load = NULL;\n           FOR_EACH_VEC_ELT (SLP_TREE_SCALAR_STMTS (node), j, load)"}]}