{"sha": "576319a79ad554e2537b0d97a355f7896c8c3a35", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTc2MzE5YTc5YWQ1NTRlMjUzN2IwZDk3YTM1NWY3ODk2YzhjM2EzNQ==", "commit": {"author": {"name": "DJ Delorie", "email": "dj@redhat.com", "date": "2010-04-19T23:25:31Z"}, "committer": {"name": "DJ Delorie", "email": "dj@gcc.gnu.org", "date": "2010-04-19T23:25:31Z"}, "message": "cfgexpand.c (expand_debug_expr): Check for mismatched modes in POINTER_PLUS_EXPR and fix them.\n\n* cfgexpand.c (expand_debug_expr): Check for mismatched modes in\nPOINTER_PLUS_EXPR and fix them.\n\nFrom-SVN: r158532", "tree": {"sha": "92c1907c30a7a197bc8429b4cd75fe7b9de2fba2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/92c1907c30a7a197bc8429b4cd75fe7b9de2fba2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/576319a79ad554e2537b0d97a355f7896c8c3a35", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/576319a79ad554e2537b0d97a355f7896c8c3a35", "html_url": "https://github.com/Rust-GCC/gccrs/commit/576319a79ad554e2537b0d97a355f7896c8c3a35", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/576319a79ad554e2537b0d97a355f7896c8c3a35/comments", "author": null, "committer": null, "parents": [{"sha": "578ad14116c61ef20c9d295da570537f6e9c5d2a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/578ad14116c61ef20c9d295da570537f6e9c5d2a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/578ad14116c61ef20c9d295da570537f6e9c5d2a"}], "stats": {"total": 21, "additions": 21, "deletions": 0}, "files": [{"sha": "5fc2dfcca46ed08831f4a875f468c5728cb1b86b", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/576319a79ad554e2537b0d97a355f7896c8c3a35/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/576319a79ad554e2537b0d97a355f7896c8c3a35/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=576319a79ad554e2537b0d97a355f7896c8c3a35", "patch": "@@ -1,3 +1,8 @@\n+2010-04-19  DJ Delorie  <dj@redhat.com>\n+\n+\t* cfgexpand.c (expand_debug_expr): Check for mismatched modes in\n+\tPOINTER_PLUS_EXPR and fix them.\n+\n 2010-04-19  Eric B. Weddington  <eric.weddington@atmel.com>\n \n \t* config/avr/avr-devices.c (avr_mcu_types): Add support for new"}, {"sha": "084772b26b9b63ba6ad1c7e25bec0992ea66fd67", "filename": "gcc/cfgexpand.c", "status": "modified", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/576319a79ad554e2537b0d97a355f7896c8c3a35/gcc%2Fcfgexpand.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/576319a79ad554e2537b0d97a355f7896c8c3a35/gcc%2Fcfgexpand.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcfgexpand.c?ref=576319a79ad554e2537b0d97a355f7896c8c3a35", "patch": "@@ -2616,6 +2616,22 @@ expand_debug_expr (tree exp)\n \treturn gen_rtx_FIX (mode, op0);\n \n     case POINTER_PLUS_EXPR:\n+      /* For the rare target where pointers are not the same size as\n+\t size_t, we need to check for mis-matched modes and correct\n+\t the addend.  */\n+      if (op0 && op1\n+\t  && GET_MODE (op0) != VOIDmode && GET_MODE (op1) != VOIDmode\n+\t  && GET_MODE (op0) != GET_MODE (op1))\n+\t{\n+\t  if (GET_MODE_BITSIZE (GET_MODE (op0)) < GET_MODE_BITSIZE (GET_MODE (op1)))\n+\t    op1 = gen_rtx_TRUNCATE (GET_MODE (op0), op1);\n+\t  else\n+\t    /* We always sign-extend, regardless of the signedness of\n+\t       the operand, because the operand is always unsigned\n+\t       here even if the original C expression is signed.  */\n+\t    op1 = gen_rtx_SIGN_EXTEND (GET_MODE (op0), op1);\n+\t}\n+      /* Fall through.  */\n     case PLUS_EXPR:\n       return gen_rtx_PLUS (mode, op0, op1);\n "}]}