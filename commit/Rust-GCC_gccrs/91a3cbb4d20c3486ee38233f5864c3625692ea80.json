{"sha": "91a3cbb4d20c3486ee38233f5864c3625692ea80", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTFhM2NiYjRkMjBjMzQ4NmVlMzgyMzNmNTg2NGMzNjI1NjkyZWE4MA==", "commit": {"author": {"name": "Richard Sandiford", "email": "richard.sandiford@arm.com", "date": "2018-10-08T18:58:59Z"}, "committer": {"name": "Richard Sandiford", "email": "rsandifo@gcc.gnu.org", "date": "2018-10-08T18:58:59Z"}, "message": "Use FOR_EACH_IMM_USE_FAST in gimple-ssa-backprop.c\n\nAs pointed out by Richard in PR63155.  It speeds up the testcase a few %.\n\n2018-10-08  Richard Sandiford  <richard.sandiford@arm.com>\n\ngcc/\n\tPR middle-end/63155\n\t* gimple-ssa-backprop.c (backprop::intersect_uses): Use\n\tFOR_EACH_IMM_USE_FAST instead of FOR_EACH_IMM_USE_STMT.\n\nFrom-SVN: r264941", "tree": {"sha": "49307b01a9f05fd1b9a1739ed38cf07e9004c72f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/49307b01a9f05fd1b9a1739ed38cf07e9004c72f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/91a3cbb4d20c3486ee38233f5864c3625692ea80", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/91a3cbb4d20c3486ee38233f5864c3625692ea80", "html_url": "https://github.com/Rust-GCC/gccrs/commit/91a3cbb4d20c3486ee38233f5864c3625692ea80", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/91a3cbb4d20c3486ee38233f5864c3625692ea80/comments", "author": {"login": "rsandifo-arm", "id": 28043039, "node_id": "MDQ6VXNlcjI4MDQzMDM5", "avatar_url": "https://avatars.githubusercontent.com/u/28043039?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rsandifo-arm", "html_url": "https://github.com/rsandifo-arm", "followers_url": "https://api.github.com/users/rsandifo-arm/followers", "following_url": "https://api.github.com/users/rsandifo-arm/following{/other_user}", "gists_url": "https://api.github.com/users/rsandifo-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/rsandifo-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rsandifo-arm/subscriptions", "organizations_url": "https://api.github.com/users/rsandifo-arm/orgs", "repos_url": "https://api.github.com/users/rsandifo-arm/repos", "events_url": "https://api.github.com/users/rsandifo-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/rsandifo-arm/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "be86efa7cc3ff3f4cd99da34a7fb73b5043cb4d9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/be86efa7cc3ff3f4cd99da34a7fb73b5043cb4d9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/be86efa7cc3ff3f4cd99da34a7fb73b5043cb4d9"}], "stats": {"total": 16, "additions": 10, "deletions": 6}, "files": [{"sha": "8e06be7620baff1a3d3671292c688c9188a9a77d", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/91a3cbb4d20c3486ee38233f5864c3625692ea80/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/91a3cbb4d20c3486ee38233f5864c3625692ea80/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=91a3cbb4d20c3486ee38233f5864c3625692ea80", "patch": "@@ -1,3 +1,9 @@\n+2018-10-08  Richard Sandiford  <richard.sandiford@arm.com>\n+\n+\tPR middle-end/63155\n+\t* gimple-ssa-backprop.c (backprop::intersect_uses): Use\n+\tFOR_EACH_IMM_USE_FAST instead of FOR_EACH_IMM_USE_STMT.\n+\n 2018-10-08  H.J. Lu  <hongjiu.lu@intel.com>\n \n \tPR target/87517"}, {"sha": "16b8943d58ee0b0052f1a6ed3f47ce15383a1df2", "filename": "gcc/gimple-ssa-backprop.c", "status": "modified", "additions": 4, "deletions": 6, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/91a3cbb4d20c3486ee38233f5864c3625692ea80/gcc%2Fgimple-ssa-backprop.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/91a3cbb4d20c3486ee38233f5864c3625692ea80/gcc%2Fgimple-ssa-backprop.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgimple-ssa-backprop.c?ref=91a3cbb4d20c3486ee38233f5864c3625692ea80", "patch": "@@ -496,10 +496,11 @@ bool\n backprop::intersect_uses (tree var, usage_info *info)\n {\n   imm_use_iterator iter;\n-  gimple *stmt;\n+  use_operand_p use_p;\n   *info = usage_info::intersection_identity ();\n-  FOR_EACH_IMM_USE_STMT (stmt, iter, var)\n+  FOR_EACH_IMM_USE_FAST (use_p, iter, var)\n     {\n+      gimple *stmt = USE_STMT (use_p);\n       if (is_gimple_debug (stmt))\n \tcontinue;\n       gphi *phi = dyn_cast <gphi *> (stmt);\n@@ -523,10 +524,7 @@ backprop::intersect_uses (tree var, usage_info *info)\n \t  process_use (stmt, var, &subinfo);\n \t  *info &= subinfo;\n \t  if (!info->is_useful ())\n-\t    {\n-\t      BREAK_FROM_IMM_USE_STMT (iter);\n-\t      return false;\n-\t    }\n+\t    return false;\n \t}\n     }\n   return true;"}]}