{"sha": "26865ab4e8a09b607fae1c338137a4ac65c476cc", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjY4NjVhYjRlOGEwOWI2MDdmYWUxYzMzODEzN2E0YWM2NWM0NzZjYw==", "commit": {"author": {"name": "Steven G. Kargl", "email": "kargl@gcc.gnu.org", "date": "2010-09-09T18:52:11Z"}, "committer": {"name": "Steven G. Kargl", "email": "kargl@gcc.gnu.org", "date": "2010-09-09T18:52:11Z"}, "message": "dummy_optional_arg.f90: New test.\n\n2010-09-09  Steven G. Kargl  <kargl@gcc.gnu.org>\n\n\t* gfortran.dg/dummy_optional_arg.f90: New test.\n\n2010-09-09  Steven G. Kargl  <kargl@gcc.gnu.org>\n\n\t* fortran/expr.c (check_inquiry): OPTIONAL attribute is not allowed\n\tfor dummy argument that appears in a specification statement.\n\nFrom-SVN: r164120", "tree": {"sha": "a432bf98d9ee2e60655380588d94eed4e8d7d7f5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a432bf98d9ee2e60655380588d94eed4e8d7d7f5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/26865ab4e8a09b607fae1c338137a4ac65c476cc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/26865ab4e8a09b607fae1c338137a4ac65c476cc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/26865ab4e8a09b607fae1c338137a4ac65c476cc", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/26865ab4e8a09b607fae1c338137a4ac65c476cc/comments", "author": null, "committer": null, "parents": [{"sha": "b1012ca4be23e00404c49f8520196af908110a10", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b1012ca4be23e00404c49f8520196af908110a10", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b1012ca4be23e00404c49f8520196af908110a10"}], "stats": {"total": 33, "additions": 33, "deletions": 0}, "files": [{"sha": "29b8a2696d2186621be75cfc7e732b262b7f5d35", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/26865ab4e8a09b607fae1c338137a4ac65c476cc/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/26865ab4e8a09b607fae1c338137a4ac65c476cc/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=26865ab4e8a09b607fae1c338137a4ac65c476cc", "patch": "@@ -1,3 +1,8 @@\n+2010-09-09  Steven G. Kargl  <kargl@gcc.gnu.org>\n+\n+\t* fortran/expr.c (check_inquiry): OPTIONAL attribute is not allowed\n+\tfor dummy argument that appears in a specification statement.\n+\n 2010-09-09  Mikael Morin  <mikael@gcc.gnu.org>\n \n \t* trans-array.c (gfc_get_array_ref_dim): New function."}, {"sha": "76ceec95715155ac58e4164ab12c0c0d2409d9b9", "filename": "gcc/fortran/expr.c", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/26865ab4e8a09b607fae1c338137a4ac65c476cc/gcc%2Ffortran%2Fexpr.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/26865ab4e8a09b607fae1c338137a4ac65c476cc/gcc%2Ffortran%2Fexpr.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fexpr.c?ref=26865ab4e8a09b607fae1c338137a4ac65c476cc", "patch": "@@ -2305,6 +2305,12 @@ check_inquiry (gfc_expr *e, int not_restricted)\n \t      && ap->expr->expr_type != EXPR_VARIABLE\n \t      && check_restricted (ap->expr) == FAILURE)\n \t  return MATCH_ERROR;\n+\n+\tif (not_restricted == 0\n+\t    && ap->expr->expr_type == EXPR_VARIABLE\n+\t    && ap->expr->symtree->n.sym->attr.dummy\n+\t    && ap->expr->symtree->n.sym->attr.optional)\n+\t  return MATCH_NO;\n     }\n \n   return MATCH_YES;"}, {"sha": "fbbbd56911ea558f0599fe998e3fce9123ee337c", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/26865ab4e8a09b607fae1c338137a4ac65c476cc/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/26865ab4e8a09b607fae1c338137a4ac65c476cc/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=26865ab4e8a09b607fae1c338137a4ac65c476cc", "patch": "@@ -1,3 +1,7 @@\n+2010-09-09  Steven G. Kargl  <kargl@gcc.gnu.org>\n+\n+\t* gfortran.dg/dummy_optional_arg.f90: New test.\n+\n 2010-09-08  Jan Hubicka  <jh@suse.cz>\n \n \tPR tree-optimization/45598"}, {"sha": "4c0417bffc0914f89ef93cc6f9ad89cc290ee7ab", "filename": "gcc/testsuite/gfortran.dg/dummy_optional_arg.f90", "status": "added", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/26865ab4e8a09b607fae1c338137a4ac65c476cc/gcc%2Ftestsuite%2Fgfortran.dg%2Fdummy_optional_arg.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/26865ab4e8a09b607fae1c338137a4ac65c476cc/gcc%2Ftestsuite%2Fgfortran.dg%2Fdummy_optional_arg.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fdummy_optional_arg.f90?ref=26865ab4e8a09b607fae1c338137a4ac65c476cc", "patch": "@@ -0,0 +1,18 @@\n+! { dg-do compile }\n+! PR fortran/45495\n+!\n+! Code originally submitted by Philip Mason <pmason at ricardo dot com>\n+!\n+function jack(aa)\n+   character(len=*), intent(in) :: aa\n+   optional :: aa\n+   character(len=len(aa)+1) :: jack ! { dg-error \"cannot be OPTIONAL\" }\n+   jack = ''\n+end function jack\n+\n+function diane(aa)\n+   character(len=*), intent(out) :: aa\n+   character(len=len(aa)+1) :: diane\n+   diane = '012345678901'\n+   aa = 'abcdefghijklmn'\n+end function diane"}]}