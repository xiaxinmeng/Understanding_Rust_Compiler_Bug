{"sha": "06ed016f032b8f66740c85d75955e8ea65ee6ca2", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDZlZDAxNmYwMzJiOGY2Njc0MGM4NWQ3NTk1NWU4ZWE2NWVlNmNhMg==", "commit": {"author": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2010-10-06T17:28:13Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2010-10-06T17:28:13Z"}, "message": "lto.c (partition_cgraph_node_p, [...]): Handle COMDATs required by the linker.\n\n\n\t* lto.c (partition_cgraph_node_p, partition_varpool_node_p): Handle\n\tCOMDATs required by the linker.\n\nFrom-SVN: r165058", "tree": {"sha": "647a3954144781838fdaa4adcdc62cbbe93e16c4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/647a3954144781838fdaa4adcdc62cbbe93e16c4"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/06ed016f032b8f66740c85d75955e8ea65ee6ca2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/06ed016f032b8f66740c85d75955e8ea65ee6ca2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/06ed016f032b8f66740c85d75955e8ea65ee6ca2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/06ed016f032b8f66740c85d75955e8ea65ee6ca2/comments", "author": null, "committer": null, "parents": [{"sha": "0e9ea52bfcd9b8ab3994329154c48f19be7c0086", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0e9ea52bfcd9b8ab3994329154c48f19be7c0086", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0e9ea52bfcd9b8ab3994329154c48f19be7c0086"}], "stats": {"total": 11, "additions": 9, "deletions": 2}, "files": [{"sha": "0057fe39775628d8faca6bf86571506158576c4f", "filename": "gcc/lto/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/06ed016f032b8f66740c85d75955e8ea65ee6ca2/gcc%2Flto%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/06ed016f032b8f66740c85d75955e8ea65ee6ca2/gcc%2Flto%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flto%2FChangeLog?ref=06ed016f032b8f66740c85d75955e8ea65ee6ca2", "patch": "@@ -1,3 +1,8 @@\n+2010-10-06  Jan Hubicka  <jh@suse.cz>\n+\n+\t* lto.c (partition_cgraph_node_p, partition_varpool_node_p): Handle\n+\tCOMDATs required by the linker.\n+\n 2010-10-05  Ian Lance Taylor  <iant@google.com>\n \n \t* lto.c (lto_section_with_id): Make s a const pointer."}, {"sha": "ab90e85ed41599ef263682997a31e468d7dd65d9", "filename": "gcc/lto/lto.c", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/06ed016f032b8f66740c85d75955e8ea65ee6ca2/gcc%2Flto%2Flto.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/06ed016f032b8f66740c85d75955e8ea65ee6ca2/gcc%2Flto%2Flto.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flto%2Flto.c?ref=06ed016f032b8f66740c85d75955e8ea65ee6ca2", "patch": "@@ -839,7 +839,8 @@ partition_cgraph_node_p (struct cgraph_node *node)\n     return false;\n   /* Extern inlines and comdat are always only in partitions they are needed.  */\n   if (DECL_EXTERNAL (node->decl)\n-      || DECL_COMDAT (node->decl))\n+      || (DECL_COMDAT (node->decl)\n+\t  && !cgraph_used_from_object_file_p (node)))\n     return false;\n   return true;\n }\n@@ -854,7 +855,8 @@ partition_varpool_node_p (struct varpool_node *vnode)\n     return false;\n   /* Constant pool and comdat are always only in partitions they are needed.  */\n   if (DECL_IN_CONSTANT_POOL (vnode->decl)\n-      || DECL_COMDAT (vnode->decl))\n+      || (DECL_COMDAT (vnode->decl)\n+\t  && !varpool_used_from_object_file_p (vnode)))\n     return false;\n   return true;\n }"}]}