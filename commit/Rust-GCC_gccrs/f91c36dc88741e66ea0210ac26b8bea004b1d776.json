{"sha": "f91c36dc88741e66ea0210ac26b8bea004b1d776", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjkxYzM2ZGM4ODc0MWU2NmVhMDIxMGFjMjZiOGJlYTAwNGIxZDc3Ng==", "commit": {"author": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2009-06-23T09:39:00Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2009-06-23T09:39:00Z"}, "message": "[multiple changes]\n\n2009-06-23  Robert Dewar  <dewar@adacore.com>\n\n\t* s-strhas.adb, s-strhas.ads: Restrict to 32-bit modular types\n\n\t* s-imgdec.adb (Set_Decimal_Digits): Fix error of too many digits for\n\tsmall values\n\n\t* prj-conf.ads: Minor reformatting\n\n\t* prj-conf.adb: Minor reformatting\n\n2009-06-23  Vasiliy Fofanov  <fofanov@adacore.com>\n\n\t* g-debpoo.adb (Dump_Gnatmem): Output dummy timestamps for allocations\n\tto correspond to the log format that gnatmem now expects.\n\n2009-06-23  Vincent Celier  <celier@adacore.com>\n\n\t* prj-attr.adb: New attributes Initial_Required_Switches,\n\tFinal_Required_Switches and Object_File_Switches\n\t\n\t* prj-nmsc.adb (Process_Compiler): Process new attributes\n\tName_Final_Required_Switches, Name_Initial_Required_Switches and\n\tName_Object_File_Switches.\n\n\t* prj.ads (Language_Config): New component\n\tCompiler_Initial_Required_Switches (replace Compiler_Required_Switches),\n\tCompiler_Final_Required_Switches and Object_File_Switches.\n\n\t* snames.ads-tmpl: New standard names Initial_Required_Switches,\n\tFinal_Required_Switches and Object_File_Switches\n\nFrom-SVN: r148837", "tree": {"sha": "e8e6d4b216634565907a5eb44fff365de722eb4d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e8e6d4b216634565907a5eb44fff365de722eb4d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f91c36dc88741e66ea0210ac26b8bea004b1d776", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f91c36dc88741e66ea0210ac26b8bea004b1d776", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f91c36dc88741e66ea0210ac26b8bea004b1d776", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f91c36dc88741e66ea0210ac26b8bea004b1d776/comments", "author": null, "committer": null, "parents": [{"sha": "352620476c902cea186f10e68a97880edb255743", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/352620476c902cea186f10e68a97880edb255743", "html_url": "https://github.com/Rust-GCC/gccrs/commit/352620476c902cea186f10e68a97880edb255743"}], "stats": {"total": 293, "additions": 178, "deletions": 115}, "files": [{"sha": "453a2676fdd8b1a0121d14db51fd14af0b9b4410", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 32, "deletions": 0, "changes": 32, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f91c36dc88741e66ea0210ac26b8bea004b1d776/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f91c36dc88741e66ea0210ac26b8bea004b1d776/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=f91c36dc88741e66ea0210ac26b8bea004b1d776", "patch": "@@ -1,3 +1,35 @@\n+2009-06-23  Robert Dewar  <dewar@adacore.com>\n+\n+\t* s-strhas.adb, s-strhas.ads: Restrict to 32-bit modular types\n+\n+\t* s-imgdec.adb (Set_Decimal_Digits): Fix error of too many digits for\n+\tsmall values\n+\n+\t* prj-conf.ads: Minor reformatting\n+\n+\t* prj-conf.adb: Minor reformatting\n+\n+2009-06-23  Vasiliy Fofanov  <fofanov@adacore.com>\n+\n+\t* g-debpoo.adb (Dump_Gnatmem): Output dummy timestamps for allocations\n+\tto correspond to the log format that gnatmem now expects.\n+\n+2009-06-23  Vincent Celier  <celier@adacore.com>\n+\n+\t* prj-attr.adb: New attributes Initial_Required_Switches,\n+\tFinal_Required_Switches and Object_File_Switches\n+\t\n+\t* prj-nmsc.adb (Process_Compiler): Process new attributes\n+\tName_Final_Required_Switches, Name_Initial_Required_Switches and\n+\tName_Object_File_Switches.\n+\n+\t* prj.ads (Language_Config): New component\n+\tCompiler_Initial_Required_Switches (replace Compiler_Required_Switches),\n+\tCompiler_Final_Required_Switches and Object_File_Switches.\n+\n+\t* snames.ads-tmpl: New standard names Initial_Required_Switches,\n+\tFinal_Required_Switches and Object_File_Switches\n+\n 2009-06-23  Pascal Obry  <obry@adacore.com>\n \n \t* s-strhas.adb, s-strhas.ads: Minor reformatting."}, {"sha": "5127de9bdd434c11499d2e9f42171e91d3291ebc", "filename": "gcc/ada/g-debpoo.adb", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f91c36dc88741e66ea0210ac26b8bea004b1d776/gcc%2Fada%2Fg-debpoo.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f91c36dc88741e66ea0210ac26b8bea004b1d776/gcc%2Fada%2Fg-debpoo.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fg-debpoo.adb?ref=f91c36dc88741e66ea0210ac26b8bea004b1d776", "patch": "@@ -1675,10 +1675,13 @@ package body GNAT.Debug_Pools is\n       Actual_Size : size_t;\n       Num_Calls   : Integer;\n       Tracebk     : Tracebacks_Array_Access;\n+      Dummy_Time  : Duration := 1.0;\n \n    begin\n       File := fopen (File_Name & ASCII.NUL, \"wb\" & ASCII.NUL);\n       fwrite (\"GMEM DUMP\" & ASCII.LF, 10, 1, File);\n+      fwrite (Dummy_Time'Address, Duration'Max_Size_In_Storage_Elements, 1,\n+              File);\n \n       --  List of not deallocated blocks (see Print_Info)\n \n@@ -1700,6 +1703,8 @@ package body GNAT.Debug_Pools is\n          fwrite (Current'Address, Address_Size, 1, File);\n          fwrite (Actual_Size'Address, size_t'Max_Size_In_Storage_Elements, 1,\n                  File);\n+         fwrite (Dummy_Time'Address, Duration'Max_Size_In_Storage_Elements, 1,\n+                 File);\n          fwrite (Num_Calls'Address, Integer'Max_Size_In_Storage_Elements, 1,\n                  File);\n "}, {"sha": "f22c6a7305a45b9b50a62aa55b045a3fb404b10f", "filename": "gcc/ada/prj-attr.adb", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f91c36dc88741e66ea0210ac26b8bea004b1d776/gcc%2Fada%2Fprj-attr.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f91c36dc88741e66ea0210ac26b8bea004b1d776/gcc%2Fada%2Fprj-attr.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-attr.adb?ref=f91c36dc88741e66ea0210ac26b8bea004b1d776", "patch": "@@ -173,9 +173,12 @@ package body Prj.Attr is\n \n    \"Sadriver#\" &\n    \"Larequired_switches#\" &\n+   \"Lainitial_required_switches#\" &\n+   \"Lafinal_required_switches#\" &\n    \"Lapic_option#\" &\n    \"Sapath_syntax#\" &\n    \"Saobject_file_suffix#\" &\n+   \"Laobject_file_switches#\" &\n \n    --  Configuration - Mapping files\n "}, {"sha": "86e7081e46bdbbf43c259e8eadc7b1d99e68108f", "filename": "gcc/ada/prj-conf.adb", "status": "modified", "additions": 40, "deletions": 38, "changes": 78, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f91c36dc88741e66ea0210ac26b8bea004b1d776/gcc%2Fada%2Fprj-conf.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f91c36dc88741e66ea0210ac26b8bea004b1d776/gcc%2Fada%2Fprj-conf.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-conf.adb?ref=f91c36dc88741e66ea0210ac26b8bea004b1d776", "patch": "@@ -79,16 +79,16 @@ package body Prj.Conf is\n    --  found, or null otherwise\n \n    function Check_Target\n-     (Config_File  : Prj.Project_Id;\n+     (Config_File        : Prj.Project_Id;\n       Autoconf_Specified : Boolean;\n-      Project_Tree : Prj.Project_Tree_Ref;\n-      Target       : String := \"\") return Boolean;\n-   --  Check that the config file's target matches Target.\n-   --  Target should be set to the empty string when the user did not specify\n-   --  a target.\n-   --  If the target in the configuration file is invalid, this function will\n-   --  call Osint.Fail to report a fatal error message and stop the program.\n-   --  Autoconf_Specified should be set to True if the user has used --autoconf\n+      Project_Tree       : Prj.Project_Tree_Ref;\n+      Target             : String := \"\") return Boolean;\n+   --  Check that the config file's target matches Target. Target should be\n+   --  set to the empty string when the user did not specify a target. If the\n+   --  target in the configuration file is invalid, this function will call\n+   --  Osint.Fail to report a fatal error message and stop the program.\n+   --  Autoconf_Specified should be set to True if the user has used\n+   --  autoconf.\n \n    --------------------\n    -- Add_Attributes --\n@@ -118,7 +118,6 @@ package body Prj.Conf is\n    begin\n       Conf_Attr_Id := Conf_Decl.Attributes;\n       User_Attr_Id := User_Decl.Attributes;\n-\n       while Conf_Attr_Id /= No_Variable loop\n          Conf_Attr :=\n            Project_Tree.Variable_Elements.Table (Conf_Attr_Id);\n@@ -135,25 +134,22 @@ package body Prj.Conf is\n                Project_Tree.Variable_Elements.Table (User_Attr_Id) :=\n                  User_Attr;\n \n-            elsif User_Attr.Value.Kind = List and then\n-            Conf_Attr.Value.Values /= Nil_String\n+            elsif User_Attr.Value.Kind = List\n+              and then Conf_Attr.Value.Values /= Nil_String\n             then\n-\n                --  List attribute declared in both the user project and the\n                --  configuration project: prepend the user list with the\n                --  configuration list.\n \n                declare\n-                  Conf_List : String_List_Id :=\n-                    Conf_Attr.Value.Values;\n+                  Conf_List : String_List_Id := Conf_Attr.Value.Values;\n                   Conf_Elem : String_Element;\n                   User_List : constant String_List_Id :=\n-                    User_Attr.Value.Values;\n+                                User_Attr.Value.Values;\n                   New_List : String_List_Id;\n                   New_Elem : String_Element;\n \n                begin\n-\n                   --  Create new list\n \n                   String_Element_Table.Increment_Last\n@@ -187,7 +183,6 @@ package body Prj.Conf is\n                         exit;\n \n                      else\n-\n                         --  If it is not the last element in the list, add to\n                         --  new list.\n \n@@ -269,10 +264,11 @@ package body Prj.Conf is\n \n                   if Conf_List /= Nil_String then\n                      declare\n-                        Link : constant String_List_Id :=\n-                                 User_Array_Elem.Value.Values;\n+                        Link     : constant String_List_Id :=\n+                                     User_Array_Elem.Value.Values;\n                         Previous : String_List_Id := Nil_String;\n                         Next     : String_List_Id;\n+\n                      begin\n                         loop\n                            Conf_List_Elem :=\n@@ -330,7 +326,6 @@ package body Prj.Conf is\n            (Name,\n             \".\" & Path_Separator &\n             Prefix_Path & \"share\" & Directory_Separator & \"gpr\");\n-\n       else\n          return Locate_Regular_File (Name, \".\");\n       end if;\n@@ -346,10 +341,12 @@ package body Prj.Conf is\n       Project_Tree : Prj.Project_Tree_Ref;\n       Target       : String := \"\") return Boolean\n    is\n-      Variable   : constant Variable_Value :=\n-        Value_Of (Name_Target, Config_File.Decl.Attributes, Project_Tree);\n+      Variable : constant Variable_Value :=\n+                   Value_Of\n+                     (Name_Target, Config_File.Decl.Attributes, Project_Tree);\n       Tgt_Name : Name_Id := No_Name;\n       OK       : Boolean;\n+\n    begin\n       if Variable /= Nil_Variable_Value and then not Variable.Default then\n          Tgt_Name := Variable.Value;\n@@ -359,7 +356,7 @@ package body Prj.Conf is\n          OK := not Autoconf_Specified or Tgt_Name = No_Name;\n       else\n          OK := Tgt_Name /= No_Name\n-           and then Target = Get_Name_String (Tgt_Name);\n+                 and then Target = Get_Name_String (Tgt_Name);\n       end if;\n \n       if not OK then\n@@ -423,7 +420,8 @@ package body Prj.Conf is\n \n       function Default_File_Name return String is\n          Ada_RTS : constant String := Runtime_Name_For (Name_Ada);\n-         Tmp : String_Access;\n+         Tmp     : String_Access;\n+\n       begin\n          if Target_Name /= \"\" then\n             if Ada_RTS /= \"\" then\n@@ -459,6 +457,7 @@ package body Prj.Conf is\n \n       function Might_Have_Sources (Project : Project_Id) return Boolean is\n          Variable : Variable_Value;\n+\n       begin\n          Variable :=\n            Value_Of\n@@ -478,6 +477,7 @@ package body Prj.Conf is\n             return Variable = Nil_Variable_Value\n               or else Variable.Default\n               or else Variable.Values /= Nil_String;\n+\n          else\n             return False;\n          end if;\n@@ -497,11 +497,11 @@ package body Prj.Conf is\n             Equal      => \"=\");\n          --  Hash table to keep the languages used in the project tree\n \n-         IDE      : constant Package_Id :=\n-           Value_Of\n-             (Name_Ide,\n-              Project.Decl.Packages,\n-              Project_Tree);\n+         IDE : constant Package_Id :=\n+                 Value_Of\n+                   (Name_Ide,\n+                    Project.Decl.Packages,\n+                    Project_Tree);\n \n          Prj_Iter : Project_List;\n          List     : String_List_Id;\n@@ -535,8 +535,8 @@ package body Prj.Conf is\n                           Prj_Iter.Project.Decl.Attributes,\n                           Project_Tree);\n \n-                     if Variable /= Nil_Variable_Value and then\n-                       not Variable.Default\n+                     if Variable /= Nil_Variable_Value\n+                       and then not Variable.Default\n                      then\n                         Get_Name_String (Variable.Value);\n                         To_Lower (Name_Buffer (1 .. Name_Len));\n@@ -574,16 +574,15 @@ package body Prj.Conf is\n \n          Name  := Language_Htable.Get_First;\n          Count := 0;\n-\n          while Name /= No_Name loop\n             Count := Count + 1;\n             Name := Language_Htable.Get_Next;\n          end loop;\n \n          Result := new String_List (1 .. Count);\n-         Count  := 1;\n-         Name   := Language_Htable.Get_First;\n \n+         Count := 1;\n+         Name  := Language_Htable.Get_First;\n          while Name /= No_Name loop\n             --  Check if IDE'Compiler_Command is declared for the language.\n             --  If it is, use its value to invoke gprconfig.\n@@ -645,10 +644,14 @@ package body Prj.Conf is\n \n       procedure Do_Autoconf is\n          Obj_Dir : constant Variable_Value :=\n-           Value_Of (Name_Object_Dir, Project.Decl.Attributes, Project_Tree);\n+                     Value_Of\n+                       (Name_Object_Dir,\n+                        Project.Decl.Attributes,\n+                        Project_Tree);\n \n          Gprconfig_Path  : String_Access;\n          Success         : Boolean;\n+\n       begin\n          Gprconfig_Path := Locate_Exec_On_Path (Gprconfig_Name);\n \n@@ -892,7 +895,7 @@ package body Prj.Conf is\n       Prj.Initialize (Project_Tree);\n       Prj.Tree.Initialize (Project_Node_Tree);\n \n-      Main_Project      := No_Project;\n+      Main_Project := No_Project;\n       Automatically_Generated := False;\n \n       Prj.Part.Parse\n@@ -986,7 +989,6 @@ package body Prj.Conf is\n \n    begin\n       Proj := Project_Tree.Projects;\n-\n       while Proj /= null loop\n          if Proj.Project /= Config_File then\n             User_Decl := Proj.Project.Decl;"}, {"sha": "dace0b0ce88cceef5ea1129fdcf7688cc47c47ef", "filename": "gcc/ada/prj-conf.ads", "status": "modified", "additions": 9, "deletions": 3, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f91c36dc88741e66ea0210ac26b8bea004b1d776/gcc%2Fada%2Fprj-conf.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f91c36dc88741e66ea0210ac26b8bea004b1d776/gcc%2Fada%2Fprj-conf.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-conf.ads?ref=f91c36dc88741e66ea0210ac26b8bea004b1d776", "patch": "@@ -24,7 +24,7 @@\n --                                                                          --\n ------------------------------------------------------------------------------\n \n---  The following package manipulates the configuration files.\n+--  The following package manipulates the configuration files\n \n with Prj.Tree;\n \n@@ -35,8 +35,8 @@ package Prj.Conf is\n       Project_Tree : Prj.Project_Tree_Ref);\n    --  Hook called after the config file has been parsed. This lets the\n    --  application do last minute changes to it (GPS uses this to add the\n-   --  default naming schemes for instance). At that point, the config file has\n-   --  not been applied to the project yet.\n+   --  default naming schemes for instance). At that point, the config file\n+   --  has not been applied to the project yet.\n \n    procedure Parse_Project_And_Apply_Config\n      (Main_Project               : out Prj.Project_Id;\n@@ -55,6 +55,7 @@ package Prj.Conf is\n       On_Load_Config             : Config_File_Hook := null);\n    --  Find the main configuration project and parse the project tree rooted at\n    --  this configuration project.\n+   --\n    --  If the processing fails, Main_Project is set to No_Project. If the error\n    --  happend while parsing the project itself (ie creating the tree),\n    --  User_Project_Node is also set to Empty_Node\n@@ -63,6 +64,7 @@ package Prj.Conf is\n    --  If this is the case, the config file might be (re)generated, as\n    --  appropriate, to match languages and target if the one specified doesn't\n    --  already match.\n+   --\n    --  Normalized_Hostname is the host on which gprbuild is returned,\n    --  normalized so that we can more easily compare it with what is stored in\n    --  configuration files. It is used when the target is unspecified, although\n@@ -90,20 +92,24 @@ package Prj.Conf is\n    --  default configuration file is found, a new one will be automatically\n    --  generated if Allow_Automatic_Generation is true (otherwise an error\n    --  reported to the user via Osint.Fail).\n+   --\n    --  On exit, Configuration_Project_Path is never null (if none could be\n    --  found, Os.Fail was called and the program exited anyway).\n+   --\n    --  The choice and generation of a configuration file depends on several\n    --  attributes of the user's project file (given by the Project argument),\n    --  like the list of languages that must be supported. Project must\n    --  therefore have been partially processed (phase one of the processing\n    --  only).\n+   --\n    --  Config_File_Name should be set to the name of the config file specified\n    --  by the user (either through gprbuild's --config or --autoconf switches).\n    --  In the latter case, Autoconf_Specified should be set to true, to\n    --  indicate that the configuration file can be regenerated to match target\n    --  and languages. This name can either be an absolute path, or the a base\n    --  name that will be searched in the default config file directories (which\n    --  depends on the installation path for the tools).\n+   --\n    --  Target_Name is used to chose among several possibilities\n    --  the configuration file that will be used.\n    --"}, {"sha": "24535b76c56d63a3e641c6b4d0af24f31798d855", "filename": "gcc/ada/prj-nmsc.adb", "status": "modified", "additions": 25, "deletions": 52, "changes": 77, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f91c36dc88741e66ea0210ac26b8bea004b1d776/gcc%2Fada%2Fprj-nmsc.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f91c36dc88741e66ea0210ac26b8bea004b1d776/gcc%2Fada%2Fprj-nmsc.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-nmsc.adb?ref=f91c36dc88741e66ea0210ac26b8bea004b1d776", "patch": "@@ -622,7 +622,7 @@ package body Prj.Nmsc is\n       Suffix   : File_Name_Type) return Boolean\n    is\n    begin\n-      if Suffix = No_File then\n+      if Suffix = No_File or else Suffix = Empty_File then\n          return False;\n       end if;\n \n@@ -1427,9 +1427,18 @@ package body Prj.Nmsc is\n                            Lang_Index.Config.Compiler_Driver :=\n                              File_Name_Type (Element.Value.Value);\n \n-                        when Name_Required_Switches =>\n+                        when Name_Required_Switches |\n+                             Name_Initial_Required_Switches =>\n+                           Put (Into_List =>\n+                                  Lang_Index.Config.\n+                                    Compiler_Initial_Required_Switches,\n+                                From_List => Element.Value.Values,\n+                                In_Tree   => In_Tree);\n+\n+                        when Name_Final_Required_Switches =>\n                            Put (Into_List =>\n-                                  Lang_Index.Config.Compiler_Required_Switches,\n+                                  Lang_Index.Config.\n+                                    Compiler_Final_Required_Switches,\n                                 From_List => Element.Value.Values,\n                                 In_Tree   => In_Tree);\n \n@@ -1460,6 +1469,12 @@ package body Prj.Nmsc is\n                                 Element.Value.Value;\n                            end if;\n \n+                        when Name_Object_File_Switches =>\n+                           Put (Into_List =>\n+                                  Lang_Index.Config.Object_File_Switches,\n+                                From_List => Element.Value.Values,\n+                                In_Tree   => In_Tree);\n+\n                         when Name_Pic_Option =>\n \n                            --  Attribute Compiler_Pic_Option (<language>)\n@@ -4112,28 +4127,6 @@ package body Prj.Nmsc is\n             end if;\n          end;\n \n-         declare\n-            Current : Array_Element_Id;\n-            Element : Array_Element;\n-\n-         begin\n-            Current := Project.Naming.Spec_Suffix;\n-            while Current /= No_Array_Element loop\n-               Element := In_Tree.Array_Elements.Table (Current);\n-               Get_Name_String (Element.Value.Value);\n-\n-               if Name_Len = 0 then\n-                  Error_Msg\n-                    (Project, In_Tree,\n-                     \"Spec_Suffix cannot be empty\",\n-                     Element.Value.Location);\n-               end if;\n-\n-               In_Tree.Array_Elements.Table (Current) := Element;\n-               Current := Element.Next;\n-            end loop;\n-         end;\n-\n          --  Check Body_Suffix\n \n          declare\n@@ -4194,28 +4187,6 @@ package body Prj.Nmsc is\n             end if;\n          end;\n \n-         declare\n-            Current : Array_Element_Id;\n-            Element : Array_Element;\n-\n-         begin\n-            Current := Project.Naming.Body_Suffix;\n-            while Current /= No_Array_Element loop\n-               Element := In_Tree.Array_Elements.Table (Current);\n-               Get_Name_String (Element.Value.Value);\n-\n-               if Name_Len = 0 then\n-                  Error_Msg\n-                    (Project, In_Tree,\n-                     \"Body_Suffix cannot be empty\",\n-                     Element.Value.Location);\n-               end if;\n-\n-               In_Tree.Array_Elements.Table (Current) := Element;\n-               Current := Element.Next;\n-            end loop;\n-         end;\n-\n          --  Get the exceptions, if any\n \n          Project.Naming.Specification_Exceptions :=\n@@ -6421,19 +6392,21 @@ package body Prj.Nmsc is\n       Suffix_Str : constant String := Get_Name_String (Suffix);\n \n    begin\n-      if Suffix_Str'Length = 0 or else Index (Suffix_Str, \".\") = 0 then\n+      if Suffix_Str'Length = 0 then\n+         return False;\n+      elsif Index (Suffix_Str, \".\") = 0 then\n          return True;\n       end if;\n \n-      --  If dot replacement is a single dot, and first character of suffix is\n-      --  also a dot\n+      --  Case of dot replacement is a single dot, and first character of\n+      --  suffix is also a dot.\n \n       if Get_Name_String (Dot_Replacement) = \".\"\n         and then Suffix_Str (Suffix_Str'First) = '.'\n       then\n          for Index in Suffix_Str'First + 1 .. Suffix_Str'Last loop\n \n-            --  If there is another dot\n+            --  Case of following dot\n \n             if Suffix_Str (Index) = '.' then\n \n@@ -6784,7 +6757,7 @@ package body Prj.Nmsc is\n         (Source_List_File.Kind = Single,\n          \"Source_List_File is not a single string\");\n \n-      --  If the user has specified a Sources attribute\n+      --  If the user has specified a Source_Files attribute\n \n       if not Sources.Default then\n          if not Source_List_File.Default then"}, {"sha": "3302e773df5f36059fe132cc3564ae770be6cd7d", "filename": "gcc/ada/prj.ads", "status": "modified", "additions": 17, "deletions": 5, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f91c36dc88741e66ea0210ac26b8bea004b1d776/gcc%2Fada%2Fprj.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f91c36dc88741e66ea0210ac26b8bea004b1d776/gcc%2Fada%2Fprj.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj.ads?ref=f91c36dc88741e66ea0210ac26b8bea004b1d776", "patch": "@@ -419,15 +419,25 @@ package Prj is\n       Compiler_Driver_Path : String_Access := null;\n       --  The path name of the executable for the compiler of the language\n \n-      Compiler_Required_Switches : Name_List_Index := No_Name_List;\n-      --  The list of switches that are required as a minimum to invoke the\n-      --  compiler driver.\n+      Compiler_Initial_Required_Switches : Name_List_Index := No_Name_List;\n+      --  The list of initial switches that are required as a minimum to invoke\n+      --  the compiler driver.\n+\n+      Compiler_Final_Required_Switches : Name_List_Index := No_Name_List;\n+      --  The list of final switches that are required as a minimum to invoke\n+      --  the compiler driver.\n \n       Path_Syntax                  : Path_Syntax_Kind := Host;\n       --  Value may be Canonical (Unix style) or Host (host syntax, for example\n       --  on VMS for DEC C).\n \n-      Object_File_Suffix : Name_Id := No_Name;\n+      Object_File_Suffix                 : Name_Id := No_Name;\n+      --  Optional alternate object file suffix\n+\n+      Object_File_Switches               : Name_List_Index := No_Name_List;\n+      --  Optional object file switches. When this is defined, the switches\n+      --  are used to specify the object file. The object file name is appended\n+      --  to the last switch in the list. Example: (\"-o\", \"\").\n \n       Compilation_PIC_Option : Name_List_Index := No_Name_List;\n       --  The option(s) to compile a source in Position Independent Code for\n@@ -543,9 +553,11 @@ package Prj is\n                            Include_Compatible_Languages => No_Name_List,\n                            Compiler_Driver              => No_File,\n                            Compiler_Driver_Path         => null,\n-                           Compiler_Required_Switches   => No_Name_List,\n+                           Compiler_Initial_Required_Switches => No_Name_List,\n+                           Compiler_Final_Required_Switches   => No_Name_List,\n                            Path_Syntax                  => Canonical,\n                            Object_File_Suffix           => No_Name,\n+                           Object_File_Switches         => No_Name_List,\n                            Compilation_PIC_Option       => No_Name_List,\n                            Object_Generated             => True,\n                            Objects_Linked               => True,"}, {"sha": "efead0be17efaf236bcad8be32a340df2ce72bd6", "filename": "gcc/ada/s-imgdec.adb", "status": "modified", "additions": 26, "deletions": 7, "changes": 33, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f91c36dc88741e66ea0210ac26b8bea004b1d776/gcc%2Fada%2Fs-imgdec.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f91c36dc88741e66ea0210ac26b8bea004b1d776/gcc%2Fada%2Fs-imgdec.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fs-imgdec.adb?ref=f91c36dc88741e66ea0210ac26b8bea004b1d776", "patch": "@@ -101,13 +101,14 @@ package body System.Img_Dec is\n       Expon : Integer;\n       --  Integer value of exponent\n \n-      procedure Round (N : Natural);\n+      procedure Round (N : Integer);\n       --  Round the number in Digs. N is the position of the last digit to be\n       --  retained in the rounded position (rounding is based on Digs (N + 1)\n       --  FD, LD, ND are reset as necessary if required. Note that if the\n       --  result value rounds up (e.g. 9.99 => 10.0), an extra digit can be\n       --  placed in the sign position as a result of the rounding, this is\n-      --  the case in which FD is adjusted.\n+      --  the case in which FD is adjusted. The call to Round has no effect\n+      --  if N is outside the range FD .. LD.\n \n       procedure Set (C : Character);\n       pragma Inline (Set);\n@@ -131,11 +132,11 @@ package body System.Img_Dec is\n       -- Round --\n       -----------\n \n-      procedure Round (N : Natural) is\n+      procedure Round (N : Integer) is\n          D : Character;\n \n       begin\n-         --  Nothing to do if rounding at or past last digit\n+         --  Nothing to do if rounding past the last digit we have\n \n          if N >= LD then\n             return;\n@@ -318,9 +319,27 @@ package body System.Img_Dec is\n             Set_Blanks_And_Sign (Fore - 1);\n             Set ('0');\n             Set ('.');\n-            Set_Zeroes (-Digits_Before_Point);\n-            Set_Digits (FD, LD);\n-            Set_Zeroes (Digits_After_Point - Scale);\n+\n+            declare\n+               DA : Natural := Digits_After_Point;\n+               --  Digits remaining to output after point\n+\n+               LZ : constant Integer :=\n+                      Integer'Max (0, Integer'Min (DA, -Digits_Before_Point));\n+               --  Number of leading zeroes after point\n+\n+            begin\n+               Set_Zeroes (LZ);\n+               DA := DA - LZ;\n+\n+               if DA < ND then\n+                  Set_Digits (FD, FD + DA - 1);\n+\n+               else\n+                  Set_Digits (FD, LD);\n+                  Set_Zeroes (DA - ND);\n+               end if;\n+            end;\n \n          --  At least one digit before point in input\n "}, {"sha": "b83823050e63f54ca95199e6de99caece0e84fdf", "filename": "gcc/ada/s-strhas.adb", "status": "modified", "additions": 8, "deletions": 3, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f91c36dc88741e66ea0210ac26b8bea004b1d776/gcc%2Fada%2Fs-strhas.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f91c36dc88741e66ea0210ac26b8bea004b1d776/gcc%2Fada%2Fs-strhas.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fs-strhas.adb?ref=f91c36dc88741e66ea0210ac26b8bea004b1d776", "patch": "@@ -31,16 +31,21 @@\n \n package body System.String_Hash is\n \n-   --  Compute a hash value for a key. The approach here is follows\n-   --  the algorithm used in GNU Awk and the ndbm substitute SDBM by\n-   --  Ozan Yigit.\n+   --  Compute a hash value for a key. The approach here is follows the\n+   --  algorithm used in GNU Awk and the ndbm substitute SDBM by Ozan Yigit.\n \n    ----------\n    -- Hash --\n    ----------\n \n    function Hash (Key : Key_Type) return Hash_Type is\n \n+      pragma Compile_Time_Error\n+        (Hash_Type'Modulus /= 2 ** 32\n+          or else Hash_Type'First /= 0\n+          or else Hash_Type'Last /= 2 ** 32 - 1,\n+         \"Hash_Type must be 32-bit modular with range 0 .. 2**32-1\");\n+\n       function Shift_Left\n         (Value  : Hash_Type;\n          Amount : Natural) return Hash_Type;"}, {"sha": "c2e72ccbb7c32c45b4bb95efbbd00c7d1c54f63e", "filename": "gcc/ada/s-strhas.ads", "status": "modified", "additions": 10, "deletions": 7, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f91c36dc88741e66ea0210ac26b8bea004b1d776/gcc%2Fada%2Fs-strhas.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f91c36dc88741e66ea0210ac26b8bea004b1d776/gcc%2Fada%2Fs-strhas.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fs-strhas.ads?ref=f91c36dc88741e66ea0210ac26b8bea004b1d776", "patch": "@@ -29,13 +29,14 @@\n --                                                                          --\n ------------------------------------------------------------------------------\n \n---  This package provides a generic hashing function over strings,\n---  suitable for use with a string keyed hash table.\n+--  This package provides a generic hashing function over strings, suitable for\n+--  use with a string keyed hash table. In particular, it is the basis for the\n+--  string hash functions in Ada.Containers.\n --\n---  The strategy used here is not appropriate for applications that\n---  require cryptographically strong hashes, or for application which\n---  wish to use very wide hash values as pseudo unique identifiers. In\n---  such cases please refer to GNAT.SHA1 and GNAT.MD5.\n+--  The algorithm used here is not appropriate for applications that require\n+--  cryptographically strong hashes, or for application which wish to use very\n+--  wide hash values as pseudo unique identifiers. In such cases please refer\n+--  to GNAT.SHA1 and GNAT.MD5.\n \n package System.String_Hash is\n    pragma Pure;\n@@ -48,7 +49,9 @@ package System.String_Hash is\n       --  The string type to use as a hash key\n \n       type Hash_Type is mod <>;\n-      --  The type to be returned as a hash value\n+      --  The type to be returned as a hash value. This must be a 32-bit\n+      --  unsigned type with full range 0 .. 2**32-1, no other type is allowed\n+      --  for this instantiation (checked in the body by Compile_Time_Error).\n \n    function Hash (Key : Key_Type) return Hash_Type;\n    pragma Inline (Hash);"}, {"sha": "7a304fefa9303a0c41b6060817e4c662c38ba23c", "filename": "gcc/ada/snames.ads-tmpl", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f91c36dc88741e66ea0210ac26b8bea004b1d776/gcc%2Fada%2Fsnames.ads-tmpl", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f91c36dc88741e66ea0210ac26b8bea004b1d776/gcc%2Fada%2Fsnames.ads-tmpl", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsnames.ads-tmpl?ref=f91c36dc88741e66ea0210ac26b8bea004b1d776", "patch": "@@ -1047,6 +1047,7 @@ package Snames is\n    Name_Executable_Suffix                : constant Name_Id := N + $;\n    Name_Extends                          : constant Name_Id := N + $;\n    Name_Externally_Built                 : constant Name_Id := N + $;\n+   Name_Final_Required_Switches          : constant Name_Id := N + $;\n    Name_Finder                           : constant Name_Id := N + $;\n    Name_Global_Compilation_Switches      : constant Name_Id := N + $;\n    Name_Global_Configuration_Pragmas     : constant Name_Id := N + $;\n@@ -1062,6 +1063,7 @@ package Snames is\n    Name_Include_Path                     : constant Name_Id := N + $;\n    Name_Include_Path_File                : constant Name_Id := N + $;\n    Name_Inherit_Source_Path              : constant Name_Id := N + $;\n+   Name_Initial_Required_Switches        : constant Name_Id := N + $;\n    Name_Languages                        : constant Name_Id := N + $;\n    Name_Library                          : constant Name_Id := N + $;\n    Name_Library_Ali_Dir                  : constant Name_Id := N + $;\n@@ -1099,6 +1101,7 @@ package Snames is\n    Name_Naming                           : constant Name_Id := N + $;\n    Name_None                             : constant Name_Id := N + $;\n    Name_Object_File_Suffix               : constant Name_Id := N + $;\n+   Name_Object_File_Switches             : constant Name_Id := N + $;\n    Name_Object_Generated                 : constant Name_Id := N + $;\n    Name_Object_List                      : constant Name_Id := N + $;\n    Name_Objects_Linked                   : constant Name_Id := N + $;"}]}