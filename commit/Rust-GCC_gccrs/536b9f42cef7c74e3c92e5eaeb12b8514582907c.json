{"sha": "536b9f42cef7c74e3c92e5eaeb12b8514582907c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTM2YjlmNDJjZWY3Yzc0ZTNjOTJlNWVhZWIxMmI4NTE0NTgyOTA3Yw==", "commit": {"author": {"name": "Matthew Wahab", "email": "matthew.wahab@arm.com", "date": "2016-09-23T09:09:28Z"}, "committer": {"name": "Matthew Wahab", "email": "mwahab@gcc.gnu.org", "date": "2016-09-23T09:09:28Z"}, "message": "[PATCH 4/17][ARM] Define feature macros for FP16.\n\n2016-09-23  Matthew Wahab  <matthew.wahab@arm.com>\n\n\t* config/arm/arm-c.c (arm_cpu_builtins): Define\n\t\"__ARM_FEATURE_FP16_SCALAR_ARITHMETIC\" and\n\t\"__ARM_FEATURE_FP16_VECTOR_ARITHMETIC\".\n\ntestsuite/\n2016-09-23  Matthew Wahab  <matthew.wahab@arm.com>\n\n\t* gcc.target/arm/attr-fp16-arith-1.c: New.\n\nFrom-SVN: r240402", "tree": {"sha": "38097b66a0f324274c966b4a29fc70b3dcedcc2d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/38097b66a0f324274c966b4a29fc70b3dcedcc2d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/536b9f42cef7c74e3c92e5eaeb12b8514582907c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/536b9f42cef7c74e3c92e5eaeb12b8514582907c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/536b9f42cef7c74e3c92e5eaeb12b8514582907c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/536b9f42cef7c74e3c92e5eaeb12b8514582907c/comments", "author": null, "committer": null, "parents": [{"sha": "1b9e31cf74fbc3dc5f56e78e1719f0efa2cf65ff", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1b9e31cf74fbc3dc5f56e78e1719f0efa2cf65ff", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1b9e31cf74fbc3dc5f56e78e1719f0efa2cf65ff"}], "stats": {"total": 60, "additions": 60, "deletions": 0}, "files": [{"sha": "12adfb96c9a43304adace1a850571f8ec6b911b2", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/536b9f42cef7c74e3c92e5eaeb12b8514582907c/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/536b9f42cef7c74e3c92e5eaeb12b8514582907c/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=536b9f42cef7c74e3c92e5eaeb12b8514582907c", "patch": "@@ -1,3 +1,9 @@\n+2016-09-23  Matthew Wahab  <matthew.wahab@arm.com>\n+\n+\t* config/arm/arm-c.c (arm_cpu_builtins): Define\n+\t\"__ARM_FEATURE_FP16_SCALAR_ARITHMETIC\" and\n+\t\"__ARM_FEATURE_FP16_VECTOR_ARITHMETIC\".\n+\n 2016-09-23  Matthew Wahab  <matthew.wahab@arm.com>\n \n \t* doc/sourcebuild.texi (ARM-specific attributes): Add anchor for"}, {"sha": "72837001d1011e366233236a6ba3d1e5775583b1", "filename": "gcc/config/arm/arm-c.c", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/536b9f42cef7c74e3c92e5eaeb12b8514582907c/gcc%2Fconfig%2Farm%2Farm-c.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/536b9f42cef7c74e3c92e5eaeb12b8514582907c/gcc%2Fconfig%2Farm%2Farm-c.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Farm-c.c?ref=536b9f42cef7c74e3c92e5eaeb12b8514582907c", "patch": "@@ -142,6 +142,11 @@ arm_cpu_builtins (struct cpp_reader* pfile)\n   def_or_undef_macro (pfile, \"__ARM_FP16_ARGS\",\n \t\t      arm_fp16_format != ARM_FP16_FORMAT_NONE);\n \n+  def_or_undef_macro (pfile, \"__ARM_FEATURE_FP16_SCALAR_ARITHMETIC\",\n+\t\t      TARGET_VFP_FP16INST);\n+  def_or_undef_macro (pfile, \"__ARM_FEATURE_FP16_VECTOR_ARITHMETIC\",\n+\t\t      TARGET_NEON_FP16INST);\n+\n   def_or_undef_macro (pfile, \"__ARM_FEATURE_FMA\", TARGET_FMA);\n   def_or_undef_macro (pfile, \"__ARM_NEON__\", TARGET_NEON);\n   def_or_undef_macro (pfile, \"__ARM_NEON\", TARGET_NEON);"}, {"sha": "f2fb03ca693c375ee6cab57b5227d8ffeda1c9e0", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/536b9f42cef7c74e3c92e5eaeb12b8514582907c/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/536b9f42cef7c74e3c92e5eaeb12b8514582907c/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=536b9f42cef7c74e3c92e5eaeb12b8514582907c", "patch": "@@ -1,3 +1,7 @@\n+2016-09-23  Matthew Wahab  <matthew.wahab@arm.com>\n+\n+\t* gcc.target/arm/attr-fp16-arith-1.c: New.\n+\n 2016-09-23  Matthew Wahab  <matthew.wahab@arm.com>\n \n \t* lib/target-supports.exp (add_options_for_arm_v8_2a_fp16_scalar):"}, {"sha": "5011315961cce933e4af79696d077606a1c19eac", "filename": "gcc/testsuite/gcc.target/arm/attr-fp16-arith-1.c", "status": "added", "additions": 45, "deletions": 0, "changes": 45, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/536b9f42cef7c74e3c92e5eaeb12b8514582907c/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fattr-fp16-arith-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/536b9f42cef7c74e3c92e5eaeb12b8514582907c/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fattr-fp16-arith-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fattr-fp16-arith-1.c?ref=536b9f42cef7c74e3c92e5eaeb12b8514582907c", "patch": "@@ -0,0 +1,45 @@\n+/* { dg-do compile } */\n+/* { dg-require-effective-target arm_v8_2a_fp16_neon_ok } */\n+/* { dg-options \"-O2\" } */\n+/* { dg-add-options arm_v8_2a_fp16_scalar } */\n+\n+/* Reset fpu to a value compatible with the next pragmas.  */\n+#pragma GCC target (\"fpu=vfp\")\n+\n+#pragma GCC push_options\n+#pragma GCC target (\"fpu=fp-armv8\")\n+\n+#ifndef __ARM_FEATURE_FP16_SCALAR_ARITHMETIC\n+#error __ARM_FEATURE_FP16_SCALAR_ARITHMETIC not defined.\n+#endif\n+\n+#pragma GCC push_options\n+#pragma GCC target (\"fpu=neon-fp-armv8\")\n+\n+#ifndef __ARM_FEATURE_FP16_VECTOR_ARITHMETIC\n+#error __ARM_FEATURE_FP16_VECTOR_ARITHMETIC not defined.\n+#endif\n+\n+#ifndef __ARM_NEON\n+#error __ARM_NEON not defined.\n+#endif\n+\n+#if !defined (__ARM_FP) || !(__ARM_FP & 0x2)\n+#error Invalid value for __ARM_FP\n+#endif\n+\n+#pragma GCC pop_options\n+\n+/* Check that the FP version is correctly reset to mfpu=fp-armv8.  */\n+\n+#if !defined (__ARM_FP) || !(__ARM_FP & 0x2)\n+#error __ARM_FP should record FP16 support.\n+#endif\n+\n+#pragma GCC pop_options\n+\n+/* Check that the FP version is correctly reset to mfpu=vfp.  */\n+\n+#if !defined (__ARM_FP) || (__ARM_FP & 0x2)\n+#error Unexpected value for __ARM_FP.\n+#endif"}]}