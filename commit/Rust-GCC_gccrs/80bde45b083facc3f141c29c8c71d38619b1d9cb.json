{"sha": "80bde45b083facc3f141c29c8c71d38619b1d9cb", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODBiZGU0NWIwODNmYWNjM2YxNDFjMjljOGM3MWQzODYxOWIxZDljYg==", "commit": {"author": {"name": "Cary Coutant", "email": "ccoutant@google.com", "date": "2011-05-06T17:34:01Z"}, "committer": {"name": "Cary Coutant", "email": "ccoutant@gcc.gnu.org", "date": "2011-05-06T17:34:01Z"}, "message": "dwarf2out.c (contains_subprogram_definition): New function.\n\n\t* dwarf2out.c (contains_subprogram_definition): New function.\n\t(should_move_die_to_comdat): Call it.\n\nFrom-SVN: r173497", "tree": {"sha": "dc95f4e5bf0dcdc9a1a460b9efc473c3c4bad617", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/dc95f4e5bf0dcdc9a1a460b9efc473c3c4bad617"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/80bde45b083facc3f141c29c8c71d38619b1d9cb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/80bde45b083facc3f141c29c8c71d38619b1d9cb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/80bde45b083facc3f141c29c8c71d38619b1d9cb", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/80bde45b083facc3f141c29c8c71d38619b1d9cb/comments", "author": null, "committer": null, "parents": [{"sha": "7e1352fe55aa8c9573c9a3e9e3d6d8eed3e879d6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7e1352fe55aa8c9573c9a3e9e3d6d8eed3e879d6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7e1352fe55aa8c9573c9a3e9e3d6d8eed3e879d6"}], "stats": {"total": 21, "additions": 21, "deletions": 0}, "files": [{"sha": "9d0294e369c935e1dda69c77ec55f91cf08b388c", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/80bde45b083facc3f141c29c8c71d38619b1d9cb/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/80bde45b083facc3f141c29c8c71d38619b1d9cb/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=80bde45b083facc3f141c29c8c71d38619b1d9cb", "patch": "@@ -1,3 +1,8 @@\n+2011-05-06  Cary Coutant  <ccoutant@google.com>\n+\n+\t* dwarf2out.c (contains_subprogram_definition): New function.\n+\t(should_move_die_to_comdat): Call it.\n+\n 2011-05-06  Jeff Law  <law@redhat.com>\n \n \t* tree-ssa-threadupdate.c (create_block_for_threading): Do not call"}, {"sha": "c08f5aac614e873e9bf92a3124925e3e8818c4dc", "filename": "gcc/dwarf2out.c", "status": "modified", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/80bde45b083facc3f141c29c8c71d38619b1d9cb/gcc%2Fdwarf2out.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/80bde45b083facc3f141c29c8c71d38619b1d9cb/gcc%2Fdwarf2out.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdwarf2out.c?ref=80bde45b083facc3f141c29c8c71d38619b1d9cb", "patch": "@@ -10170,6 +10170,20 @@ is_nested_in_subprogram (dw_die_ref die)\n   return local_scope_p (decl);\n }\n \n+/* Return non-zero if this DIE contains a defining declaration of a\n+   subprogram.  */\n+\n+static int\n+contains_subprogram_definition (dw_die_ref die)\n+{\n+  dw_die_ref c;\n+\n+  if (die->die_tag == DW_TAG_subprogram && ! is_declaration_die (die))\n+    return 1;\n+  FOR_EACH_CHILD (die, c, if (contains_subprogram_definition(c)) return 1);\n+  return 0;\n+}\n+\n /* Return non-zero if this is a type DIE that should be moved to a\n    COMDAT .debug_types section.  */\n \n@@ -10188,6 +10202,8 @@ should_move_die_to_comdat (dw_die_ref die)\n           || get_AT (die, DW_AT_abstract_origin)\n           || is_nested_in_subprogram (die))\n         return 0;\n+      /* A type definition should never contain a subprogram definition.  */\n+      gcc_assert (!contains_subprogram_definition (die));\n       return 1;\n     case DW_TAG_array_type:\n     case DW_TAG_interface_type:"}]}