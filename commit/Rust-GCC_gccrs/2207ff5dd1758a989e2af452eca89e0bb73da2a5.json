{"sha": "2207ff5dd1758a989e2af452eca89e0bb73da2a5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjIwN2ZmNWRkMTc1OGE5ODllMmFmNDUyZWNhODllMGJiNzNkYTJhNQ==", "commit": {"author": {"name": "DJ Delorie", "email": "dj@redhat.com", "date": "2016-12-06T06:38:23Z"}, "committer": {"name": "DJ Delorie", "email": "dj@gcc.gnu.org", "date": "2016-12-06T06:38:23Z"}, "message": "* argv.c (expandargv): Check for directories passed as @-files.\n\nFrom-SVN: r243280", "tree": {"sha": "961450e3d60e5f55dde272bae8fba35846926c20", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/961450e3d60e5f55dde272bae8fba35846926c20"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2207ff5dd1758a989e2af452eca89e0bb73da2a5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2207ff5dd1758a989e2af452eca89e0bb73da2a5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2207ff5dd1758a989e2af452eca89e0bb73da2a5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2207ff5dd1758a989e2af452eca89e0bb73da2a5/comments", "author": null, "committer": null, "parents": [{"sha": "202687fb7c65fa951f7ffd39c0a4a651ab753daf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/202687fb7c65fa951f7ffd39c0a4a651ab753daf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/202687fb7c65fa951f7ffd39c0a4a651ab753daf"}], "stats": {"total": 23, "additions": 23, "deletions": 0}, "files": [{"sha": "e4e765a1e8d58f9b082d37ee32212a831123b42c", "filename": "libiberty/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2207ff5dd1758a989e2af452eca89e0bb73da2a5/libiberty%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2207ff5dd1758a989e2af452eca89e0bb73da2a5/libiberty%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libiberty%2FChangeLog?ref=2207ff5dd1758a989e2af452eca89e0bb73da2a5", "patch": "@@ -1,3 +1,7 @@\n+2016-11-30  DJ Delorie  <dj@redhat.com>\n+\n+\t* argv.c (expandargv): Check for directories passed as @-files.\n+\n 2016-11-30  David Malcolm  <dmalcolm@redhat.com>\n \n \tPR c/78498"}, {"sha": "fd43e78b170fbf71eebfc269fcf1947b8175227a", "filename": "libiberty/argv.c", "status": "modified", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2207ff5dd1758a989e2af452eca89e0bb73da2a5/libiberty%2Fargv.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2207ff5dd1758a989e2af452eca89e0bb73da2a5/libiberty%2Fargv.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libiberty%2Fargv.c?ref=2207ff5dd1758a989e2af452eca89e0bb73da2a5", "patch": "@@ -35,6 +35,13 @@ Boston, MA 02110-1301, USA.  */\n #include <string.h>\n #include <stdlib.h>\n #include <stdio.h>\n+#include <sys/types.h>\n+#ifdef HAVE_UNISTD_H\n+#include <unistd.h>\n+#endif\n+#if HAVE_SYS_STAT_H\n+#include <sys/stat.h>\n+#endif\n \n #ifndef NULL\n #define NULL 0\n@@ -387,6 +394,9 @@ expandargv (int *argcp, char ***argvp)\n       char **file_argv;\n       /* The number of options read from the response file, if any.  */\n       size_t file_argc;\n+#ifdef S_ISDIR\n+      struct stat sb;\n+#endif\n       /* We are only interested in options of the form \"@file\".  */\n       filename = (*argvp)[i];\n       if (filename[0] != '@')\n@@ -397,6 +407,15 @@ expandargv (int *argcp, char ***argvp)\n \t  fprintf (stderr, \"%s: error: too many @-files encountered\\n\", (*argvp)[0]);\n \t  xexit (1);\n \t}\n+#ifdef S_ISDIR\n+      if (stat (filename+1, &sb) < 0)\n+\tcontinue;\n+      if (S_ISDIR(sb.st_mode))\n+\t{\n+\t  fprintf (stderr, \"%s: error: @-file refers to a directory\\n\", (*argvp)[0]);\n+\t  xexit (1);\n+\t}\n+#endif\n       /* Read the contents of the file.  */\n       f = fopen (++filename, \"r\");\n       if (!f)"}]}