{"sha": "3934b625ee2f522edf455191d1eaaa42e265a1d9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzkzNGI2MjVlZTJmNTIyZWRmNDU1MTkxZDFlYWFhNDJlMjY1YTFkOQ==", "commit": {"author": {"name": "Thomas Koenig", "email": "tkoenig@gcc.gnu.org", "date": "2017-10-10T16:49:32Z"}, "committer": {"name": "Thomas Koenig", "email": "tkoenig@gcc.gnu.org", "date": "2017-10-10T16:49:32Z"}, "message": "re PR libfortran/82233 (execute_command_line causes program to stop when command fails (or does not exist))\n\n2017-10-10  Thomas Koenig  <tkoenig@gcc.gnu.org>\n\n\tPR libfortran/82233\n\t* intrinsics/execute_command_line.c (execute_command_line):\n\tNo call to runtime_error if cmdstat is present.\n\n2017-10-10  Thomas Koenig  <tkoenig@gcc.gnu.org>\n\n\tPR libfortran/82233\n\t* gfortran.dg/execute_command_line_3.f90: New test.\n\nFrom-SVN: r253593", "tree": {"sha": "6d2aba7bdb402ff9984c97114d2053a2282a468b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6d2aba7bdb402ff9984c97114d2053a2282a468b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3934b625ee2f522edf455191d1eaaa42e265a1d9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3934b625ee2f522edf455191d1eaaa42e265a1d9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3934b625ee2f522edf455191d1eaaa42e265a1d9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3934b625ee2f522edf455191d1eaaa42e265a1d9/comments", "author": null, "committer": null, "parents": [{"sha": "53befce7f2b35e69ad78b945fc06403c753480a5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/53befce7f2b35e69ad78b945fc06403c753480a5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/53befce7f2b35e69ad78b945fc06403c753480a5"}], "stats": {"total": 45, "additions": 37, "deletions": 8}, "files": [{"sha": "ae985df779228e965360cd30bbaa4cc6d2c6c17f", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3934b625ee2f522edf455191d1eaaa42e265a1d9/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3934b625ee2f522edf455191d1eaaa42e265a1d9/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=3934b625ee2f522edf455191d1eaaa42e265a1d9", "patch": "@@ -1,3 +1,8 @@\n+2017-10-10  Thomas Koenig  <tkoenig@gcc.gnu.org>\n+\n+\tPR libfortran/82233\n+\t* gfortran.dg/execute_command_line_3.f90: New test.\n+\n 2017-10-10  Will Schmidt  <will_schmidt@vnet.ibm.com>\n \n \t* gcc.target/powerpc/fold-vec-splat-16.c: New"}, {"sha": "87d73d1b50f98c0bce3f7e55f7095b3e57e7197a", "filename": "gcc/testsuite/gfortran.dg/execute_command_line_3.f90", "status": "added", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3934b625ee2f522edf455191d1eaaa42e265a1d9/gcc%2Ftestsuite%2Fgfortran.dg%2Fexecute_command_line_3.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3934b625ee2f522edf455191d1eaaa42e265a1d9/gcc%2Ftestsuite%2Fgfortran.dg%2Fexecute_command_line_3.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fexecute_command_line_3.f90?ref=3934b625ee2f522edf455191d1eaaa42e265a1d9", "patch": "@@ -0,0 +1,24 @@\n+! { dg-do  run }\n+! PR 82233 - there were program aborts for some of these commands.\n+! Original test case by Urban Jost.\n+program boom\n+implicit none\n+integer                       :: i,j \n+character(len=256)            :: msg\n+character(len=:), allocatable :: command\n+   command='notthere'\n+   msg='' ! seems to only be defined if exitstatus.ne.0\n+   ! ok -- these work\n+   call execute_command_line(command , wait=.false., exitstat=i, cmdstat=j, cmdmsg=msg)\n+   if (j /= 0 .or. msg /= '') call abort\n+   call execute_command_line(command ,               exitstat=i, cmdstat=j, cmdmsg=msg )\n+   if (j /= 3 .or. msg /= \"Invalid command line\" ) call abort\n+   msg = ''\n+   call execute_command_line(command , wait=.false., exitstat=i,            cmdmsg=msg )\n+   print *,msg\n+   if (msg /= '') call abort\n+   call execute_command_line(command ,               exitstat=i, cmdstat=j             )\n+   if (j /= 3) call abort\n+   call execute_command_line(command , wait=.false., exitstat=i                        )\n+\n+end program boom"}, {"sha": "ef9ef19b68b6d53e70eb130b8392289246fc4724", "filename": "libgfortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3934b625ee2f522edf455191d1eaaa42e265a1d9/libgfortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3934b625ee2f522edf455191d1eaaa42e265a1d9/libgfortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2FChangeLog?ref=3934b625ee2f522edf455191d1eaaa42e265a1d9", "patch": "@@ -1,3 +1,9 @@\n+2017-10-10  Thomas Koenig  <tkoenig@gcc.gnu.org>\n+\n+\tPR libfortran/82233\n+\t* intrinsics/execute_command_line.c (execute_command_line):\n+\tNo call to runtime_error if cmdstat is present.\n+\n 2017-09-24  Dominique d'Humieres  <dominiq@lps.ens.fr>\n \n \tPR libgfortran/79612"}, {"sha": "31ab36de9d8d5c3183f33abefcce0cc7d019460e", "filename": "libgfortran/intrinsics/execute_command_line.c", "status": "modified", "additions": 2, "deletions": 8, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3934b625ee2f522edf455191d1eaaa42e265a1d9/libgfortran%2Fintrinsics%2Fexecute_command_line.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3934b625ee2f522edf455191d1eaaa42e265a1d9/libgfortran%2Fintrinsics%2Fexecute_command_line.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fintrinsics%2Fexecute_command_line.c?ref=3934b625ee2f522edf455191d1eaaa42e265a1d9", "patch": "@@ -125,15 +125,9 @@ execute_command_line (const char *command, bool wait, int *exitstat,\n   free (cmd);\n \n   /* Now copy back to the Fortran string if needed.  */\n-  if (cmdstat && *cmdstat > EXEC_NOERROR)\n-    {\n-      if (cmdmsg)\n-\tfstrcpy (cmdmsg, cmdmsg_len, cmdmsg_values[*cmdstat],\n+  if (cmdstat && *cmdstat > EXEC_NOERROR && cmdmsg)\n+    fstrcpy (cmdmsg, cmdmsg_len, cmdmsg_values[*cmdstat],\n \t\tstrlen (cmdmsg_values[*cmdstat]));\n-      else\n-\truntime_error (\"Failure in EXECUTE_COMMAND_LINE: %s\",\n-\t\t       cmdmsg_values[*cmdstat]);\n-    }\n }\n \n "}]}