{"sha": "093024421f69476a1863c7711012166f06ac60d2", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDkzMDI0NDIxZjY5NDc2YTE4NjNjNzcxMTAxMjE2NmYwNmFjNjBkMg==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2011-06-16T07:45:17Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2011-06-16T07:45:17Z"}, "message": "re PR tree-optimization/49419 (gcc -O2 miscompiles gp2c)\n\n\tPR tree-optimization/49419\n\t* tree-vrp.c (execute_vrp): Call init_range_assertions\n\tbefore estimate_numbers_of_iterations, call\n\tfree_number_of_iterations_estimates before calling\n\tremove_range_assertions.\n\n\t* gcc.c-torture/execute/pr49419.c: New test.\n\nFrom-SVN: r175092", "tree": {"sha": "666e2e34a125f659a4b12b009a25653dbbbefe13", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/666e2e34a125f659a4b12b009a25653dbbbefe13"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/093024421f69476a1863c7711012166f06ac60d2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/093024421f69476a1863c7711012166f06ac60d2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/093024421f69476a1863c7711012166f06ac60d2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/093024421f69476a1863c7711012166f06ac60d2/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "81c411666a736dadfc8774ba1ce1823d69c55077", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/81c411666a736dadfc8774ba1ce1823d69c55077", "html_url": "https://github.com/Rust-GCC/gccrs/commit/81c411666a736dadfc8774ba1ce1823d69c55077"}], "stats": {"total": 57, "additions": 55, "deletions": 2}, "files": [{"sha": "e661a4446c27058ffa780accd7997f2fda18ca9b", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/093024421f69476a1863c7711012166f06ac60d2/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/093024421f69476a1863c7711012166f06ac60d2/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=093024421f69476a1863c7711012166f06ac60d2", "patch": "@@ -1,3 +1,11 @@\n+2011-06-16  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR tree-optimization/49419\n+\t* tree-vrp.c (execute_vrp): Call init_range_assertions\n+\tbefore estimate_numbers_of_iterations, call\n+\tfree_number_of_iterations_estimates before calling\n+\tremove_range_assertions.\n+\n 2011-06-16  Revital Eres  <revital.eres@linaro.org>\n \n \t* modulo-sched.c (struct ps_insn): Remove row_rest_count field."}, {"sha": "73d20745fbc2812d3cb55ba8189930ae5cc411f6", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/093024421f69476a1863c7711012166f06ac60d2/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/093024421f69476a1863c7711012166f06ac60d2/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=093024421f69476a1863c7711012166f06ac60d2", "patch": "@@ -1,3 +1,8 @@\n+2011-06-16  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR tree-optimization/49419\n+\t* gcc.c-torture/execute/pr49419.c: New test.\n+\n 2011-06-16  Revital Eres  <revital.eres@linaro.org>\n \n \t* gcc.dg/sms-9.c: New file."}, {"sha": "fddc1646202bd5e3a6ed19629e5faea724dfbe2b", "filename": "gcc/testsuite/gcc.c-torture/execute/pr49419.c", "status": "added", "additions": 38, "deletions": 0, "changes": 38, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/093024421f69476a1863c7711012166f06ac60d2/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fpr49419.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/093024421f69476a1863c7711012166f06ac60d2/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fpr49419.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fpr49419.c?ref=093024421f69476a1863c7711012166f06ac60d2", "patch": "@@ -0,0 +1,38 @@\n+/* PR tree-optimization/49419 */\n+\n+extern void abort (void);\n+\n+struct S { int w, x, y; } *t;\n+\n+int\n+foo (int n, int f, int *s, int m)\n+{\n+  int x, i, a;\n+  if (n == -1)\n+    return 0;\n+  for (x = n, i = 0; t[x].w == f && i < m; i++)\n+    x = t[x].x;\n+  if (i == m)\n+    abort ();\n+  a = i + 1;\n+  for (x = n; i > 0; i--)\n+    {\n+      s[i] = t[x].y;\n+      x = t[x].x;\n+    }\n+  s[0] = x;\n+  return a;\n+}\n+\n+int\n+main (void)\n+{\n+  int s[3], i;\n+  struct S buf[3] = { { 1, 1, 2 }, { 0, 0, 0 }, { 0, 0, 0 } };\n+  t = buf;\n+  if (foo (0, 1, s, 3) != 2)\n+    abort ();\n+  if (s[0] != 1 || s[1] != 2)\n+    abort ();\n+  return 0;\n+}"}, {"sha": "c049c5d426bffcec79bc06c9130cb2d6f8e5f2b7", "filename": "gcc/tree-vrp.c", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/093024421f69476a1863c7711012166f06ac60d2/gcc%2Ftree-vrp.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/093024421f69476a1863c7711012166f06ac60d2/gcc%2Ftree-vrp.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-vrp.c?ref=093024421f69476a1863c7711012166f06ac60d2", "patch": "@@ -7728,14 +7728,14 @@ execute_vrp (void)\n   rewrite_into_loop_closed_ssa (NULL, TODO_update_ssa);\n   scev_initialize ();\n \n+  insert_range_assertions ();\n+\n   /* Estimate number of iterations - but do not use undefined behavior\n      for this.  We can't do this lazily as other functions may compute\n      this using undefined behavior.  */\n   free_numbers_of_iterations_estimates ();\n   estimate_numbers_of_iterations (false);\n \n-  insert_range_assertions ();\n-\n   to_remove_edges = VEC_alloc (edge, heap, 10);\n   to_update_switch_stmts = VEC_alloc (switch_update, heap, 5);\n   threadedge_initialize_values ();\n@@ -7744,6 +7744,8 @@ execute_vrp (void)\n   ssa_propagate (vrp_visit_stmt, vrp_visit_phi_node);\n   vrp_finalize ();\n \n+  free_numbers_of_iterations_estimates ();\n+\n   /* ASSERT_EXPRs must be removed before finalizing jump threads\n      as finalizing jump threads calls the CFG cleanup code which\n      does not properly handle ASSERT_EXPRs.  */"}]}