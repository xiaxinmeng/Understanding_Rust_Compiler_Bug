{"sha": "efaa76b31d79af03bcd7291053f407357b4d35bb", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWZhYTc2YjMxZDc5YWYwM2JjZDcyOTEwNTNmNDA3MzU3YjRkMzViYg==", "commit": {"author": {"name": "Paolo Carlini", "email": "paolo.carlini@oracle.com", "date": "2011-05-27T14:21:33Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2011-05-27T14:21:33Z"}, "message": "re PR c++/42056 (ICE with invalid use of auto in template)\n\n/cp\n2011-05-27  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/42056\n\t* typeck2.c (build_functional_cast): Complain early for invalid uses\n\tof 'auto' and set type to error_mark_node.\n\n/testsuite\n2011-05-27  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/42056\n\t* testsuite/g++.dg/cpp0x/auto25.C: New.\n\nFrom-SVN: r174337", "tree": {"sha": "aa2a047109bbd2908546b33ba962f9572ad7bb01", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/aa2a047109bbd2908546b33ba962f9572ad7bb01"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/efaa76b31d79af03bcd7291053f407357b4d35bb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/efaa76b31d79af03bcd7291053f407357b4d35bb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/efaa76b31d79af03bcd7291053f407357b4d35bb", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/efaa76b31d79af03bcd7291053f407357b4d35bb/comments", "author": null, "committer": null, "parents": [{"sha": "b0bd15f7aa9e9eecc4d97f6c0165c32c3055922e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b0bd15f7aa9e9eecc4d97f6c0165c32c3055922e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b0bd15f7aa9e9eecc4d97f6c0165c32c3055922e"}], "stats": {"total": 30, "additions": 30, "deletions": 0}, "files": [{"sha": "cd2ff4723559a521022ff1ff294a99c0fc375a5e", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/efaa76b31d79af03bcd7291053f407357b4d35bb/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/efaa76b31d79af03bcd7291053f407357b4d35bb/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=efaa76b31d79af03bcd7291053f407357b4d35bb", "patch": "@@ -1,3 +1,9 @@\n+2011-05-27  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/42056\n+\t* typeck2.c (build_functional_cast): Complain early for invalid uses\n+\tof 'auto' and set type to error_mark_node.\n+\n 2011-05-26  Jason Merrill  <jason@redhat.com>\n \n \tPR c++/47721"}, {"sha": "031f076863f0d85b1542f7fb1504fce27b61211b", "filename": "gcc/cp/typeck2.c", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/efaa76b31d79af03bcd7291053f407357b4d35bb/gcc%2Fcp%2Ftypeck2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/efaa76b31d79af03bcd7291053f407357b4d35bb/gcc%2Fcp%2Ftypeck2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ftypeck2.c?ref=efaa76b31d79af03bcd7291053f407357b4d35bb", "patch": "@@ -1599,6 +1599,13 @@ build_functional_cast (tree exp, tree parms, tsubst_flags_t complain)\n       return error_mark_node;\n     }\n \n+  if (type_uses_auto (type))\n+    {\n+      if (complain & tf_error)\n+\terror (\"invalid use of %<auto%>\");\n+      type = error_mark_node;\n+    }\n+\n   if (processing_template_decl)\n     {\n       tree t;"}, {"sha": "61892232fffd790a7efd898721ef83ecbfd9e6aa", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/efaa76b31d79af03bcd7291053f407357b4d35bb/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/efaa76b31d79af03bcd7291053f407357b4d35bb/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=efaa76b31d79af03bcd7291053f407357b4d35bb", "patch": "@@ -1,3 +1,8 @@\n+2011-05-27  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/42056\n+\t* testsuite/g++.dg/cpp0x/auto25.C: New.\n+\n 2011-05-27  Richard Guenther  <rguenther@suse.de>\n \n \t* gcc.c-torture/execute/920711-1.x: Add -fwrapv."}, {"sha": "2917c0e197836037b1033cdd4aa699699820399c", "filename": "gcc/testsuite/g++.dg/cpp0x/auto25.C", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/efaa76b31d79af03bcd7291053f407357b4d35bb/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fauto25.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/efaa76b31d79af03bcd7291053f407357b4d35bb/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fauto25.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fauto25.C?ref=efaa76b31d79af03bcd7291053f407357b4d35bb", "patch": "@@ -0,0 +1,12 @@\n+// PR c++/42056\n+// { dg-options -std=c++0x }\n+\n+template<int> struct A\n+{\n+  int a[auto(1)]; // { dg-error \"invalid use of\" }\n+};\n+\n+template<int> void foo()\n+{\n+  int a[auto(1)]; // { dg-error \"invalid use of\" }\n+}"}]}