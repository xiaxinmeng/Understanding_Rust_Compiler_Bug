{"sha": "bb7f43b62a58a0f0326fd3060f0bd43e6f3ef971", "node_id": "C_kwDOANBUbNoAKGJiN2Y0M2I2MmE1OGEwZjAzMjZmZDMwNjBmMGJkNDNlNmYzZWY5NzE", "commit": {"author": {"name": "Richard Sandiford", "email": "richard.sandiford@arm.com", "date": "2022-09-29T10:32:56Z"}, "committer": {"name": "Richard Sandiford", "email": "richard.sandiford@arm.com", "date": "2022-09-29T10:32:56Z"}, "message": "aarch64: Tweak contents of flags_on/off fields\n\nAfter previous changes, it's more convenient if the flags_on and\nflags_off fields of all_extensions include the feature flag itself.\n\ngcc/\n\t* common/config/aarch64/aarch64-common.cc (all_extensions):\n\tInclude the feature flag in flags_on and flags_off.\n\t(aarch64_parse_extension): Update accordingly.\n\t(aarch64_get_extension_string_for_isa_flags): Likewise.", "tree": {"sha": "4c3c99d5b70adc914379a0ab6b52e348d34c948a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4c3c99d5b70adc914379a0ab6b52e348d34c948a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bb7f43b62a58a0f0326fd3060f0bd43e6f3ef971", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bb7f43b62a58a0f0326fd3060f0bd43e6f3ef971", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bb7f43b62a58a0f0326fd3060f0bd43e6f3ef971", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bb7f43b62a58a0f0326fd3060f0bd43e6f3ef971/comments", "author": {"login": "rsandifo-arm", "id": 28043039, "node_id": "MDQ6VXNlcjI4MDQzMDM5", "avatar_url": "https://avatars.githubusercontent.com/u/28043039?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rsandifo-arm", "html_url": "https://github.com/rsandifo-arm", "followers_url": "https://api.github.com/users/rsandifo-arm/followers", "following_url": "https://api.github.com/users/rsandifo-arm/following{/other_user}", "gists_url": "https://api.github.com/users/rsandifo-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/rsandifo-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rsandifo-arm/subscriptions", "organizations_url": "https://api.github.com/users/rsandifo-arm/orgs", "repos_url": "https://api.github.com/users/rsandifo-arm/repos", "events_url": "https://api.github.com/users/rsandifo-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/rsandifo-arm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "rsandifo-arm", "id": 28043039, "node_id": "MDQ6VXNlcjI4MDQzMDM5", "avatar_url": "https://avatars.githubusercontent.com/u/28043039?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rsandifo-arm", "html_url": "https://github.com/rsandifo-arm", "followers_url": "https://api.github.com/users/rsandifo-arm/followers", "following_url": "https://api.github.com/users/rsandifo-arm/following{/other_user}", "gists_url": "https://api.github.com/users/rsandifo-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/rsandifo-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rsandifo-arm/subscriptions", "organizations_url": "https://api.github.com/users/rsandifo-arm/orgs", "repos_url": "https://api.github.com/users/rsandifo-arm/repos", "events_url": "https://api.github.com/users/rsandifo-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/rsandifo-arm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "fed55a60e5b230bc159617f26e33611073c672fd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fed55a60e5b230bc159617f26e33611073c672fd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fed55a60e5b230bc159617f26e33611073c672fd"}], "stats": {"total": 14, "additions": 6, "deletions": 8}, "files": [{"sha": "ffa83bb478fddbb1152ded424315a683569e932b", "filename": "gcc/common/config/aarch64/aarch64-common.cc", "status": "modified", "additions": 6, "deletions": 8, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bb7f43b62a58a0f0326fd3060f0bd43e6f3ef971/gcc%2Fcommon%2Fconfig%2Faarch64%2Faarch64-common.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bb7f43b62a58a0f0326fd3060f0bd43e6f3ef971/gcc%2Fcommon%2Fconfig%2Faarch64%2Faarch64-common.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcommon%2Fconfig%2Faarch64%2Faarch64-common.cc?ref=bb7f43b62a58a0f0326fd3060f0bd43e6f3ef971", "patch": "@@ -137,10 +137,8 @@ struct aarch64_option_extension\n static constexpr aarch64_option_extension all_extensions[] =\n {\n #define AARCH64_OPT_EXTENSION(NAME, IDENT, C, D, E, F) \\\n-  {NAME, AARCH64_FL_##IDENT, \\\n-   feature_deps::IDENT ().explicit_on & ~AARCH64_FL_##IDENT, \\\n-   feature_deps::get_flags_off (feature_deps::root_off_##IDENT) \\\n-   & ~AARCH64_FL_##IDENT},\n+  {NAME, AARCH64_FL_##IDENT, feature_deps::IDENT ().explicit_on, \\\n+   feature_deps::get_flags_off (feature_deps::root_off_##IDENT)},\n #include \"config/aarch64/aarch64-option-extensions.def\"\n   {NULL, 0, 0, 0}\n };\n@@ -228,9 +226,9 @@ aarch64_parse_extension (const char *str, aarch64_feature_flags *isa_flags,\n \t    {\n \t      /* Add or remove the extension.  */\n \t      if (adding_ext)\n-\t\t*isa_flags |= (opt->flags_on | opt->flag_canonical);\n+\t\t*isa_flags |= opt->flags_on;\n \t      else\n-\t\t*isa_flags &= ~(opt->flags_off | opt->flag_canonical);\n+\t\t*isa_flags &= ~opt->flags_off;\n \t      break;\n \t    }\n \t}\n@@ -304,7 +302,7 @@ aarch64_get_extension_string_for_isa_flags\n \n       if ((flags & isa_flags & (explicit_flags | ~current_flags)) == flags)\n \t{\n-\t  current_flags |= opt.flag_canonical | opt.flags_on;\n+\t  current_flags |= opt.flags_on;\n \t  added |= opt.flag_canonical;\n \t}\n     }\n@@ -319,7 +317,7 @@ aarch64_get_extension_string_for_isa_flags\n   for (auto &opt : all_extensions)\n     if (opt.flag_canonical & current_flags & ~isa_flags)\n       {\n-\tcurrent_flags &= ~(opt.flag_canonical | opt.flags_off);\n+\tcurrent_flags &= ~opt.flags_off;\n \toutstr += \"+no\";\n \toutstr += opt.name;\n       }"}]}