{"sha": "d0ee55a1f7ce56b20e9d52904da026a316241930", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDBlZTU1YTFmN2NlNTZiMjBlOWQ1MjkwNGRhMDI2YTMxNjI0MTkzMA==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2017-07-28T07:11:51Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2017-07-28T07:11:51Z"}, "message": "re PR tree-optimization/81578 (ICE in omp_reduction_init_op)\n\n\tPR tree-optimization/81578\n\t* tree-parloops.c (build_new_reduction): Bail out if\n\treduction_code isn't one of the standard OpenMP reductions.\n\tMove the details printing after that decision.\n\n\t* gcc.dg/pr81578.c: New test.\n\nFrom-SVN: r250651", "tree": {"sha": "77c6765ddf61786720242bb3a9d02a72472e690f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/77c6765ddf61786720242bb3a9d02a72472e690f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d0ee55a1f7ce56b20e9d52904da026a316241930", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d0ee55a1f7ce56b20e9d52904da026a316241930", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d0ee55a1f7ce56b20e9d52904da026a316241930", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d0ee55a1f7ce56b20e9d52904da026a316241930/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "1ce75e415688d0f0bec52cdd8d0fcdaccb5efac5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1ce75e415688d0f0bec52cdd8d0fcdaccb5efac5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1ce75e415688d0f0bec52cdd8d0fcdaccb5efac5"}], "stats": {"total": 58, "additions": 49, "deletions": 9}, "files": [{"sha": "b2aec1afa54f3d45ff42d15de4c991fa64992c46", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d0ee55a1f7ce56b20e9d52904da026a316241930/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d0ee55a1f7ce56b20e9d52904da026a316241930/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=d0ee55a1f7ce56b20e9d52904da026a316241930", "patch": "@@ -1,3 +1,10 @@\n+2017-07-28  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR tree-optimization/81578\n+\t* tree-parloops.c (build_new_reduction): Bail out if\n+\treduction_code isn't one of the standard OpenMP reductions.\n+\tMove the details printing after that decision.\n+\n 2017-07-27  Peter Bergner  <bergner@vnet.ibm.com>\n \n \t* config/rs6000/predicates.md (volatile_mem_operand): Remove code"}, {"sha": "19f10701053bbbfa7b981770fcf9a6ea8708fc3e", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d0ee55a1f7ce56b20e9d52904da026a316241930/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d0ee55a1f7ce56b20e9d52904da026a316241930/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=d0ee55a1f7ce56b20e9d52904da026a316241930", "patch": "@@ -1,3 +1,8 @@\n+2017-07-28  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR tree-optimization/81578\n+\t* gcc.dg/pr81578.c: New test.\n+\n 2017-07-28  Richard Biener  <rguenther@suse.de>\n \n \tPR tree-optimization/81573"}, {"sha": "a6ef77f20c02d3458dc33a40b073cd093b72849c", "filename": "gcc/testsuite/gcc.dg/pr81578.c", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d0ee55a1f7ce56b20e9d52904da026a316241930/gcc%2Ftestsuite%2Fgcc.dg%2Fpr81578.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d0ee55a1f7ce56b20e9d52904da026a316241930/gcc%2Ftestsuite%2Fgcc.dg%2Fpr81578.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr81578.c?ref=d0ee55a1f7ce56b20e9d52904da026a316241930", "patch": "@@ -0,0 +1,12 @@\n+/* PR tree-optimization/81578 */\n+/* { dg-do compile { target pthread } } */\n+/* { dg-options \"-O2 -ftree-parallelize-loops=2\" } */\n+\n+int\n+foo (int *x)\n+{\n+  int i, r = 1;\n+  for (i = 0; i != 1024; i++)\n+    r *= x[i] < 0;\n+  return r;\n+}"}, {"sha": "538932e50bfb8e9761fd6551483f620dcac2cb76", "filename": "gcc/tree-parloops.c", "status": "modified", "additions": 25, "deletions": 9, "changes": 34, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d0ee55a1f7ce56b20e9d52904da026a316241930/gcc%2Ftree-parloops.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d0ee55a1f7ce56b20e9d52904da026a316241930/gcc%2Ftree-parloops.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-parloops.c?ref=d0ee55a1f7ce56b20e9d52904da026a316241930", "patch": "@@ -2475,23 +2475,39 @@ build_new_reduction (reduction_info_table_type *reduction_list,\n \n   gcc_assert (reduc_stmt);\n \n-  if (dump_file && (dump_flags & TDF_DETAILS))\n-    {\n-      fprintf (dump_file,\n-\t       \"Detected reduction. reduction stmt is:\\n\");\n-      print_gimple_stmt (dump_file, reduc_stmt, 0);\n-      fprintf (dump_file, \"\\n\");\n-    }\n-\n   if (gimple_code (reduc_stmt) == GIMPLE_PHI)\n     {\n       tree op1 = PHI_ARG_DEF (reduc_stmt, 0);\n       gimple *def1 = SSA_NAME_DEF_STMT (op1);\n       reduction_code = gimple_assign_rhs_code (def1);\n     }\n-\n   else\n     reduction_code = gimple_assign_rhs_code (reduc_stmt);\n+  /* Check for OpenMP supported reduction.  */\n+  switch (reduction_code)\n+    {\n+    case PLUS_EXPR:\n+    case MULT_EXPR:\n+    case MAX_EXPR:\n+    case MIN_EXPR:\n+    case BIT_IOR_EXPR:\n+    case BIT_XOR_EXPR:\n+    case BIT_AND_EXPR:\n+    case TRUTH_OR_EXPR:\n+    case TRUTH_XOR_EXPR:\n+    case TRUTH_AND_EXPR:\n+      break;\n+    default:\n+      return;\n+    }\n+\n+  if (dump_file && (dump_flags & TDF_DETAILS))\n+    {\n+      fprintf (dump_file,\n+\t       \"Detected reduction. reduction stmt is:\\n\");\n+      print_gimple_stmt (dump_file, reduc_stmt, 0);\n+      fprintf (dump_file, \"\\n\");\n+    }\n \n   new_reduction = XCNEW (struct reduction_info);\n "}]}