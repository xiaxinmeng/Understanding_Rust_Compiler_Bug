{"sha": "0f741287d6f41e37052c58fdb2bb3eee9ab3cd79", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MGY3NDEyODdkNmY0MWUzNzA1MmM1OGZkYjJiYjNlZWU5YWIzY2Q3OQ==", "commit": {"author": {"name": "Sebastian Pop", "email": "sebastian.pop@amd.com", "date": "2010-06-25T18:38:04Z"}, "committer": {"name": "Sebastian Pop", "email": "spop@gcc.gnu.org", "date": "2010-06-25T18:38:04Z"}, "message": "Call cleanup_tree_cfg after if-conversion.\n\n2010-06-25  Sebastian Pop  <sebastian.pop@amd.com>\n\n\t* tree-if-conv.c (combine_blocks): Remove FIXME comment.\n\t(tree_if_conversion): Returns true when something has been changed.\n\t(main_tree_if_conversion): Return TODO_cleanup_cfg when if-conversion\n\tchanged something.\n\nFrom-SVN: r161396", "tree": {"sha": "8bd609215852906cf6f10e0388fceab4848130c3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8bd609215852906cf6f10e0388fceab4848130c3"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0f741287d6f41e37052c58fdb2bb3eee9ab3cd79", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0f741287d6f41e37052c58fdb2bb3eee9ab3cd79", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0f741287d6f41e37052c58fdb2bb3eee9ab3cd79", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0f741287d6f41e37052c58fdb2bb3eee9ab3cd79/comments", "author": null, "committer": {"login": "sebpop", "id": 568397, "node_id": "MDQ6VXNlcjU2ODM5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/568397?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sebpop", "html_url": "https://github.com/sebpop", "followers_url": "https://api.github.com/users/sebpop/followers", "following_url": "https://api.github.com/users/sebpop/following{/other_user}", "gists_url": "https://api.github.com/users/sebpop/gists{/gist_id}", "starred_url": "https://api.github.com/users/sebpop/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sebpop/subscriptions", "organizations_url": "https://api.github.com/users/sebpop/orgs", "repos_url": "https://api.github.com/users/sebpop/repos", "events_url": "https://api.github.com/users/sebpop/events{/privacy}", "received_events_url": "https://api.github.com/users/sebpop/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "53aa40a821dbbcf90426ddd25682bb91b9572079", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/53aa40a821dbbcf90426ddd25682bb91b9572079", "html_url": "https://github.com/Rust-GCC/gccrs/commit/53aa40a821dbbcf90426ddd25682bb91b9572079"}], "stats": {"total": 24, "additions": 17, "deletions": 7}, "files": [{"sha": "b7fbcb99dcf71b23c9485a663d5352d6e1d8f62a", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0f741287d6f41e37052c58fdb2bb3eee9ab3cd79/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0f741287d6f41e37052c58fdb2bb3eee9ab3cd79/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=0f741287d6f41e37052c58fdb2bb3eee9ab3cd79", "patch": "@@ -1,3 +1,10 @@\n+2010-06-25  Sebastian Pop  <sebastian.pop@amd.com>\n+\n+\t* tree-if-conv.c (combine_blocks): Remove FIXME comment.\n+\t(tree_if_conversion): Returns true when something has been changed.\n+\t(main_tree_if_conversion): Return TODO_cleanup_cfg when if-conversion\n+\tchanged something.\n+\n 2010-06-25  Sebastian Pop  <sebastian.pop@amd.com>\n \n \t* Makefile.in (tree-if-conv.o): Depends on DBGCNT_H."}, {"sha": "f200d480b59683ed418aaad8cee380c2ab2d8ccc", "filename": "gcc/tree-if-conv.c", "status": "modified", "additions": 10, "deletions": 7, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0f741287d6f41e37052c58fdb2bb3eee9ab3cd79/gcc%2Ftree-if-conv.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0f741287d6f41e37052c58fdb2bb3eee9ab3cd79/gcc%2Ftree-if-conv.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-if-conv.c?ref=0f741287d6f41e37052c58fdb2bb3eee9ab3cd79", "patch": "@@ -1162,21 +1162,20 @@ combine_blocks (struct loop *loop)\n \n   /* If possible, merge loop header to the block with the exit edge.\n      This reduces the number of basic blocks to two, to please the\n-     vectorizer that handles only loops with two nodes.\n-\n-     FIXME: Call cleanup_tree_cfg.  */\n+     vectorizer that handles only loops with two nodes.  */\n   if (exit_bb\n       && exit_bb != loop->header\n       && can_merge_blocks_p (loop->header, exit_bb))\n     merge_blocks (loop->header, exit_bb);\n }\n \n /* If-convert LOOP when it is legal.  For the moment this pass has no\n-   profitability analysis.  */\n+   profitability analysis.  Returns true when something changed.  */\n \n-static void\n+static bool\n tree_if_conversion (struct loop *loop)\n {\n+  bool changed = false;\n   ifc_bbs = NULL;\n \n   if (!if_convertible_loop_p (loop)\n@@ -1187,6 +1186,7 @@ tree_if_conversion (struct loop *loop)\n      blocks into one huge basic block doing the if-conversion\n      on-the-fly.  */\n   combine_blocks (loop);\n+  changed = true;\n \n  cleanup:\n   if (ifc_bbs)\n@@ -1199,6 +1199,8 @@ tree_if_conversion (struct loop *loop)\n       free (ifc_bbs);\n       ifc_bbs = NULL;\n     }\n+\n+  return changed;\n }\n \n /* Tree if-conversion pass management.  */\n@@ -1208,14 +1210,15 @@ main_tree_if_conversion (void)\n {\n   loop_iterator li;\n   struct loop *loop;\n+  bool changed = false;\n \n   if (number_of_loops () <= 1)\n     return 0;\n \n   FOR_EACH_LOOP (li, loop, 0)\n-    tree_if_conversion (loop);\n+    changed |= tree_if_conversion (loop);\n \n-  return 0;\n+  return changed ? TODO_cleanup_cfg : 0;\n }\n \n static bool"}]}