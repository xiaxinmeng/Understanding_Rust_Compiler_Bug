{"sha": "06ace75d4bcebf8bcc021dfe918b9866fba3108c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDZhY2U3NWQ0YmNlYmY4YmNjMDIxZGZlOTE4Yjk4NjZmYmEzMTA4Yw==", "commit": {"author": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2017-05-12T12:49:34Z"}, "committer": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2017-05-12T12:49:34Z"}, "message": "runtime: fix build for non-split-stack systems\n    \n    Change memory allocation accounting for stacks to use stacks_sys,\n    since that seems to be what it is for.\n    \n    Reviewed-on: https://go-review.googlesource.com/43297\n\nFrom-SVN: r247967", "tree": {"sha": "08382cff0b3974233757b76703128dac8c0077ae", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/08382cff0b3974233757b76703128dac8c0077ae"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/06ace75d4bcebf8bcc021dfe918b9866fba3108c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/06ace75d4bcebf8bcc021dfe918b9866fba3108c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/06ace75d4bcebf8bcc021dfe918b9866fba3108c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/06ace75d4bcebf8bcc021dfe918b9866fba3108c/comments", "author": null, "committer": null, "parents": [{"sha": "7af1c0ad98613e1a8684b075ac2a6e4739b07b07", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7af1c0ad98613e1a8684b075ac2a6e4739b07b07", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7af1c0ad98613e1a8684b075ac2a6e4739b07b07"}], "stats": {"total": 14, "additions": 11, "deletions": 3}, "files": [{"sha": "f4bcf46e46ea652ddcc27fa7b13f872657e5e7ce", "filename": "gcc/go/gofrontend/MERGE", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/06ace75d4bcebf8bcc021dfe918b9866fba3108c/gcc%2Fgo%2Fgofrontend%2FMERGE", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/06ace75d4bcebf8bcc021dfe918b9866fba3108c/gcc%2Fgo%2Fgofrontend%2FMERGE", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgo%2Fgofrontend%2FMERGE?ref=06ace75d4bcebf8bcc021dfe918b9866fba3108c", "patch": "@@ -1,4 +1,4 @@\n-3c1258156a2ae483c5cc523cb7a3c3374cbe7c2c\n+d5bfa6cebb19a154cbfbc53f6e647d2ca7adef68\n \n The first line of this file holds the git revision number of the last\n merge done from the gofrontend repository."}, {"sha": "8bfdcbc9523addaa8081dbe082ab4f21dea6f64b", "filename": "libgo/go/runtime/runtime2.go", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/06ace75d4bcebf8bcc021dfe918b9866fba3108c/libgo%2Fgo%2Fruntime%2Fruntime2.go", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/06ace75d4bcebf8bcc021dfe918b9866fba3108c/libgo%2Fgo%2Fruntime%2Fruntime2.go", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgo%2Fgo%2Fruntime%2Fruntime2.go?ref=06ace75d4bcebf8bcc021dfe918b9866fba3108c", "patch": "@@ -793,3 +793,10 @@ type g_ucontext_t [(_sizeof_ucontext_t + 15) / unsafe.Sizeof(uintptr(0))]uintptr\n // sigset is the Go version of the C type sigset_t.\n // _sigset_t is defined by the Makefile from <signal.h>.\n type sigset _sigset_t\n+\n+// getMemstats returns a pointer to the internal memstats variable,\n+// for C code.\n+//go:linkname getMemstats runtime.getMemstats\n+func getMemstats() *mstats {\n+\treturn &memstats\n+}"}, {"sha": "14ee673dc47e94fd4e17ab3d012032e6c6898922", "filename": "libgo/runtime/proc.c", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/06ace75d4bcebf8bcc021dfe918b9866fba3108c/libgo%2Fruntime%2Fproc.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/06ace75d4bcebf8bcc021dfe918b9866fba3108c/libgo%2Fruntime%2Fproc.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgo%2Fruntime%2Fproc.c?ref=06ace75d4bcebf8bcc021dfe918b9866fba3108c", "patch": "@@ -406,6 +406,8 @@ extern void globrunqput(G*)\n   __asm__(GOSYM_PREFIX \"runtime.globrunqput\");\n extern P* pidleget(void)\n   __asm__(GOSYM_PREFIX \"runtime.pidleget\");\n+extern struct mstats* getMemstats(void)\n+  __asm__(GOSYM_PREFIX \"runtime.getMemstats\");\n \n bool runtime_isstarted;\n \n@@ -726,7 +728,7 @@ runtime_malg(bool allocatestack, bool signalstack, byte** ret_stack, uintptr* re\n                 // 32-bit mode, the Go allocation space is all of\n                 // memory anyhow.\n \t\tif(sizeof(void*) == 8) {\n-\t\t\tvoid *p = runtime_sysAlloc(stacksize, &mstats()->other_sys);\n+\t\t\tvoid *p = runtime_sysAlloc(stacksize, &getMemstats()->stacks_sys);\n \t\t\tif(p == nil)\n \t\t\t\truntime_throw(\"runtime: cannot allocate memory for goroutine stack\");\n \t\t\t*ret_stack = (byte*)p;"}, {"sha": "1ce30db00cdc103e1ca80c069b85963f175b0849", "filename": "libgo/runtime/stack.c", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/06ace75d4bcebf8bcc021dfe918b9866fba3108c/libgo%2Fruntime%2Fstack.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/06ace75d4bcebf8bcc021dfe918b9866fba3108c/libgo%2Fruntime%2Fstack.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgo%2Fruntime%2Fstack.c?ref=06ace75d4bcebf8bcc021dfe918b9866fba3108c", "patch": "@@ -80,7 +80,6 @@ static void doscanstack1(G *gp, void *gcw) {\n \t\t\tscanstackblock(sp, (uintptr)(spsize), gcw);\n \t}\n #else\n-\tM *mp;\n \tbyte* bottom;\n \tbyte* top;\n "}]}