{"sha": "c802b1cf7d8298fbacb5248ca2d5cdc11fa276ed", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzgwMmIxY2Y3ZDgyOThmYmFjYjUyNDhjYTJkNWNkYzExZmEyNzZlZA==", "commit": {"author": {"name": "Basile Starynkevitch", "email": "basile@starynkevitch.net", "date": "2009-10-05T15:59:11Z"}, "committer": {"name": "Basile Starynkevitch", "email": "bstarynk@gcc.gnu.org", "date": "2009-10-05T15:59:11Z"}, "message": "gengtype.c (write_types): Moved call to write_func_for_structure into seperate loops.\n\n\n2009-10-05  Basile Starynkevitch  <basile@starynkevitch.net>\n\t    Rafael Espindola  <espindola@google.com>\n\n\t* gengtype.c (write_types): Moved call to write_func_for_structure\n\tinto seperate loops.\n\n\nCo-Authored-By: Rafael Avila de Espindola <espindola@google.com>\n\nFrom-SVN: r152455", "tree": {"sha": "3240d406d5845a99fa293c7201c131ca04555c81", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3240d406d5845a99fa293c7201c131ca04555c81"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c802b1cf7d8298fbacb5248ca2d5cdc11fa276ed", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c802b1cf7d8298fbacb5248ca2d5cdc11fa276ed", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c802b1cf7d8298fbacb5248ca2d5cdc11fa276ed", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c802b1cf7d8298fbacb5248ca2d5cdc11fa276ed/comments", "author": {"login": "bstarynk", "id": 90412, "node_id": "MDQ6VXNlcjkwNDEy", "avatar_url": "https://avatars.githubusercontent.com/u/90412?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bstarynk", "html_url": "https://github.com/bstarynk", "followers_url": "https://api.github.com/users/bstarynk/followers", "following_url": "https://api.github.com/users/bstarynk/following{/other_user}", "gists_url": "https://api.github.com/users/bstarynk/gists{/gist_id}", "starred_url": "https://api.github.com/users/bstarynk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bstarynk/subscriptions", "organizations_url": "https://api.github.com/users/bstarynk/orgs", "repos_url": "https://api.github.com/users/bstarynk/repos", "events_url": "https://api.github.com/users/bstarynk/events{/privacy}", "received_events_url": "https://api.github.com/users/bstarynk/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "a9cc44581ac57b7138d7dea22fe4acc7c8a9f1ed", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a9cc44581ac57b7138d7dea22fe4acc7c8a9f1ed", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a9cc44581ac57b7138d7dea22fe4acc7c8a9f1ed"}], "stats": {"total": 57, "additions": 45, "deletions": 12}, "files": [{"sha": "95a8b7040d06764fd6908cb0314b8cc81c488de0", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c802b1cf7d8298fbacb5248ca2d5cdc11fa276ed/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c802b1cf7d8298fbacb5248ca2d5cdc11fa276ed/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=c802b1cf7d8298fbacb5248ca2d5cdc11fa276ed", "patch": "@@ -1,3 +1,10 @@\n+\n+2009-10-05  Basile Starynkevitch  <basile@starynkevitch.net>\n+\t    Rafael Espindola  <espindola@google.com>\n+\n+\t* gengtype.c (write_types): Moved call to write_func_for_structure\n+\tinto seperate loops.\n+\n 2009-10-05  Richard Guenther  <rguenther@suse.de>\n \n \tPR lto/41281"}, {"sha": "e5b43dde96e13209e1a37f95896cb096a9212225", "filename": "gcc/gengtype.c", "status": "modified", "additions": 38, "deletions": 12, "changes": 50, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c802b1cf7d8298fbacb5248ca2d5cdc11fa276ed/gcc%2Fgengtype.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c802b1cf7d8298fbacb5248ca2d5cdc11fa276ed/gcc%2Fgengtype.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgengtype.c?ref=c802b1cf7d8298fbacb5248ca2d5cdc11fa276ed", "patch": "@@ -141,8 +141,7 @@ static void oprintf (outf_p o, const char *S, ...)\n static outf_p output_files;\n \n /* The plugin input files and their number; in that case only\n-   corresponding gt-<plugin>.h are generated in the current\n-   directory.  */\n+   a single file is produced.  */\n static char** plugin_files;\n static size_t nb_plugin_files;\n /* the generated plugin output name & file */\n@@ -2719,6 +2718,9 @@ write_types (outf_p output_header, type_p structures, type_p param_structs,\n   type_p s;\n \n   oprintf (output_header, \"\\n/* %s*/\\n\", wtd->comment);\n+  /* We first emit the macros and the declarations. Functions' code is\n+     emitted afterwards.  This is needed in plugin mode.  */\n+  oprintf (output_header, \"/* macros and declarations */\\n\");\n   for (s = structures; s; s = s->next)\n     if (s->gc_used == GC_POINTED_TO\n \t|| s->gc_used == GC_MAYBE_POINTED_TO)\n@@ -2767,21 +2769,11 @@ write_types (outf_p output_header, type_p structures, type_p param_structs,\n \t\t     s->u.s.tag);\n \t    continue;\n \t  }\n-\n-\tif (s->kind == TYPE_LANG_STRUCT)\n-\t  {\n-\t    type_p ss;\n-\t    for (ss = s->u.s.lang_struct; ss; ss = ss->next)\n-\t      write_func_for_structure (s, ss, NULL, wtd);\n-\t  }\n-\telse\n-\t  write_func_for_structure (s, s, NULL, wtd);\n       }\n \n   for (s = param_structs; s; s = s->next)\n     if (s->gc_used == GC_POINTED_TO)\n       {\n-\ttype_p * param = s->u.param_struct.param;\n \ttype_p stru = s->u.param_struct.stru;\n \n \t/* Declare the marker procedure.  */\n@@ -2795,7 +2787,41 @@ write_types (outf_p output_header, type_p structures, type_p param_structs,\n \t\t     s->u.s.tag);\n \t    continue;\n \t  }\n+      }\n+  \n+  /* At last we emit the functions code.  */ \n+  oprintf (output_header, \"\\n/* functions code */\\n\");\n+  for (s = structures; s; s = s->next)\n+    if (s->gc_used == GC_POINTED_TO\n+\t|| s->gc_used == GC_MAYBE_POINTED_TO)\n+      {\n+\toptions_p opt;\n \n+\tif (s->gc_used == GC_MAYBE_POINTED_TO\n+\t    && s->u.s.line.file == NULL)\n+\t  continue;\n+\tfor (opt = s->u.s.opt; opt; opt = opt->next)\n+\t  if (strcmp (opt->name, \"ptr_alias\") == 0)\n+\t    break;\n+\tif (opt)\n+\t  continue;\n+\t\n+\tif (s->kind == TYPE_LANG_STRUCT)\n+\t  {\n+\t    type_p ss;\n+\t    for (ss = s->u.s.lang_struct; ss; ss = ss->next)\n+\t      write_func_for_structure (s, ss, NULL, wtd);\n+\t  }\n+\telse\n+\t  write_func_for_structure (s, s, NULL, wtd);\n+      }\n+  for (s = param_structs; s; s = s->next)\n+    if (s->gc_used == GC_POINTED_TO)\n+      {\n+\ttype_p *param = s->u.param_struct.param;\n+\ttype_p stru = s->u.param_struct.stru;\n+\tif (stru->u.s.line.file == NULL)\n+\t  continue;\n \tif (stru->kind == TYPE_LANG_STRUCT)\n \t  {\n \t    type_p ss;"}]}