{"sha": "094e84faf02b3bc9c09cfadf76110965176d688f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDk0ZTg0ZmFmMDJiM2JjOWMwOWNmYWRmNzYxMTA5NjUxNzZkNjg4Zg==", "commit": {"author": {"name": "Richard Sandiford", "email": "rsandifo@redhat.com", "date": "2004-09-10T14:14:30Z"}, "committer": {"name": "Richard Sandiford", "email": "rsandifo@gcc.gnu.org", "date": "2004-09-10T14:14:30Z"}, "message": "frv.md (UNSPEC_MASACCS, [...]): New constants.\n\n\t* config/frv/frv.md (UNSPEC_MASACCS, UNSPEC_MDASACCS): New constants.\n\t(maddaccs, msubaccs, *maddacc): Turn operand 0 into a single ACC/ACCG\n\tpair.  Remove match_dup from inputs.  Remove masaccs handling.\n\t(mdaddaccs, mdsubaccs, *mdaddacc): Likewise a dual ACC/ACCG pair.\n\t(masaccs, mdasaccs): Turn into define_insns.\n\nFrom-SVN: r87299", "tree": {"sha": "2c2e9181f66b505d3dde6cb42dcf519104d6431a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2c2e9181f66b505d3dde6cb42dcf519104d6431a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/094e84faf02b3bc9c09cfadf76110965176d688f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/094e84faf02b3bc9c09cfadf76110965176d688f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/094e84faf02b3bc9c09cfadf76110965176d688f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/094e84faf02b3bc9c09cfadf76110965176d688f/comments", "author": null, "committer": null, "parents": [{"sha": "d635c70797688ead5f670ad5b176b12c0129b74f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d635c70797688ead5f670ad5b176b12c0129b74f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d635c70797688ead5f670ad5b176b12c0129b74f"}], "stats": {"total": 132, "additions": 63, "deletions": 69}, "files": [{"sha": "7b73e8266e830723d4b140061f70bc4d44647ad3", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/094e84faf02b3bc9c09cfadf76110965176d688f/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/094e84faf02b3bc9c09cfadf76110965176d688f/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=094e84faf02b3bc9c09cfadf76110965176d688f", "patch": "@@ -1,3 +1,11 @@\n+2004-09-10  Richard Sandiford  <rsandifo@redhat.com>\n+\n+\t* config/frv/frv.md (UNSPEC_MASACCS, UNSPEC_MDASACCS): New constants.\n+\t(maddaccs, msubaccs, *maddacc): Turn operand 0 into a single ACC/ACCG\n+\tpair.  Remove match_dup from inputs.  Remove masaccs handling.\n+\t(mdaddaccs, mdsubaccs, *mdaddacc): Likewise a dual ACC/ACCG pair.\n+\t(masaccs, mdasaccs): Turn into define_insns.\n+\n 2004-09-10  Richard Sandiford  <rsandifo@redhat.com>\n \n \t* tree-tailcall.c (process_assignment): Only do accumulator transforms"}, {"sha": "ac51410d71f3465e80b28d0ebff75930c8400bd5", "filename": "gcc/config/frv/frv.md", "status": "modified", "additions": 55, "deletions": 69, "changes": 124, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/094e84faf02b3bc9c09cfadf76110965176d688f/gcc%2Fconfig%2Ffrv%2Ffrv.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/094e84faf02b3bc9c09cfadf76110965176d688f/gcc%2Fconfig%2Ffrv%2Ffrv.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Ffrv%2Ffrv.md?ref=094e84faf02b3bc9c09cfadf76110965176d688f", "patch": "@@ -6208,6 +6208,8 @@\n    (UNSPEC_MQLMTHS\t\t155)\n    (UNSPEC_MQSLLHI\t\t156)\n    (UNSPEC_MQSRAHI\t\t157)\n+   (UNSPEC_MASACCS\t\t158)\n+   (UNSPEC_MDASACCS\t\t159)\n ])\n \n ;; Logic operations: type \"mlogic\"\n@@ -7726,52 +7728,45 @@\n ;; Accumulator addition/subtraction: type \"maddacc\"\n \n (define_expand \"maddaccs\"\n-  [(parallel [(set (match_operand:DI 0 \"even_acc_operand\" \"\")\n-\t\t   (unspec:DI [(match_dup 0)\n-\t\t\t       (match_operand:DI 1 \"even_acc_operand\" \"\")]\n+  [(parallel [(set (match_operand:SI 0 \"acc_operand\" \"\")\n+\t\t   (unspec:SI [(match_operand:DI 1 \"even_acc_operand\" \"\")]\n \t\t\t      UNSPEC_MADDACC))\n-\t      (set (match_operand:HI 2 \"accg_operand\" \"\")\n-\t\t   (unspec:HI [(match_dup 2)\n-\t\t\t       (match_operand:HI 3 \"accg_operand\" \"\")\n+\t      (set (match_operand:QI 2 \"accg_operand\" \"\")\n+\t\t   (unspec:QI [(match_operand:HI 3 \"accg_operand\" \"\")\n \t\t\t       (match_dup 4)]\n \t\t\t      UNSPEC_MADDACC))])]\n   \"TARGET_MEDIA_REV2\"\n   \"operands[4] = GEN_INT (FRV_BUILTIN_MADDACCS);\")\n \n (define_expand \"msubaccs\"\n-  [(parallel [(set (match_operand:DI 0 \"even_acc_operand\" \"\")\n-\t\t   (unspec:DI [(match_dup 0)\n-\t\t\t       (match_operand:DI 1 \"even_acc_operand\" \"\")]\n+  [(parallel [(set (match_operand:SI 0 \"acc_operand\" \"\")\n+\t\t   (unspec:SI [(match_operand:DI 1 \"even_acc_operand\" \"\")]\n \t\t\t      UNSPEC_MADDACC))\n-\t      (set (match_operand:HI 2 \"accg_operand\" \"\")\n-\t\t   (unspec:HI [(match_dup 2)\n-\t\t\t       (match_operand:HI 3 \"accg_operand\" \"\")\n+\t      (set (match_operand:QI 2 \"accg_operand\" \"\")\n+\t\t   (unspec:QI [(match_operand:HI 3 \"accg_operand\" \"\")\n \t\t\t       (match_dup 4)]\n \t\t\t      UNSPEC_MADDACC))])]\n   \"TARGET_MEDIA_REV2\"\n   \"operands[4] = GEN_INT (FRV_BUILTIN_MSUBACCS);\")\n \n-(define_expand \"masaccs\"\n-  [(parallel [(set (match_operand:DI 0 \"even_acc_operand\" \"\")\n-\t\t   (unspec:DI [(match_dup 0)\n-\t\t\t       (match_operand:DI 1 \"even_acc_operand\" \"\")]\n-\t\t\t      UNSPEC_MADDACC))\n-\t      (set (match_operand:HI 2 \"accg_operand\" \"\")\n-\t\t   (unspec:HI [(match_dup 2)\n-\t\t\t       (match_operand:HI 3 \"accg_operand\" \"\")\n-\t\t\t       (match_dup 4)]\n-\t\t\t      UNSPEC_MADDACC))])]\n+(define_insn \"masaccs\"\n+  [(set (match_operand:DI 0 \"even_acc_operand\" \"=b\")\n+\t(unspec:DI [(match_operand:DI 1 \"even_acc_operand\" \"b\")]\n+\t\t   UNSPEC_MASACCS))\n+   (set (match_operand:HI 2 \"accg_operand\" \"=B\")\n+\t(unspec:HI [(match_operand:HI 3 \"accg_operand\" \"B\")]\n+\t\t   UNSPEC_MASACCS))]\n   \"TARGET_MEDIA_REV2\"\n-  \"operands[4] = GEN_INT (FRV_BUILTIN_MASACCS);\")\n+  \"masaccs %1, %0\"\n+  [(set_attr \"length\" \"4\")\n+   (set_attr \"type\" \"maddacc\")])\n \n (define_insn \"*maddacc\"\n-  [(set (match_operand:DI 0 \"even_acc_operand\" \"+b\")\n-\t(unspec:DI [(match_dup 0)\n-\t\t    (match_operand:DI 1 \"even_acc_operand\" \"b\")]\n+  [(set (match_operand:SI 0 \"acc_operand\" \"=a\")\n+\t(unspec:SI [(match_operand:DI 1 \"even_acc_operand\" \"b\")]\n \t\t   UNSPEC_MADDACC))\n-   (set (match_operand:HI 2 \"accg_operand\" \"+B\")\n-\t(unspec:HI [(match_dup 2)\n-\t\t    (match_operand:HI 3 \"accg_operand\" \"B\")\n+   (set (match_operand:QI 2 \"accg_operand\" \"=B\")\n+\t(unspec:QI [(match_operand:HI 3 \"accg_operand\" \"B\")\n \t\t    (match_operand:SI 4 \"const_int_operand\" \"n\")]\n \t\t   UNSPEC_MADDACC))]\n   \"TARGET_MEDIA_REV2\"\n@@ -7782,7 +7777,6 @@\n   default:\t\t     break;\n   case FRV_BUILTIN_MADDACCS: return \\\"maddaccs %1, %0\\\";\n   case FRV_BUILTIN_MSUBACCS: return \\\"msubaccs %1, %0\\\";\n-  case FRV_BUILTIN_MASACCS:  return \\\"masaccs %1, %0\\\";\n   }\n \n   fatal_insn (\\\"Bad media insn, maddacc\\\", insn);\n@@ -7793,54 +7787,47 @@\n ;; Dual accumulator addition/subtraction: type \"mdaddacc\"\n \n (define_expand \"mdaddaccs\"\n-  [(parallel [(set (match_operand:V4SI 0 \"quad_acc_operand\" \"\")\n-\t\t   (unspec:V4SI [(match_dup 0)\n-\t\t\t\t (match_operand:V4SI 1 \"quad_acc_operand\" \"\")]\n-\t\t\t\tUNSPEC_MDADDACC))\n-\t      (set (match_operand:V4QI 2 \"accg_operand\" \"\")\n-\t\t   (unspec:V4QI [(match_dup 2)\n-\t\t\t\t (match_operand:V4QI 3 \"accg_operand\" \"\")\n-\t\t\t\t (match_dup 4)]\n-\t\t\t\tUNSPEC_MDADDACC))])]\n+  [(parallel [(set (match_operand:DI 0 \"even_acc_operand\" \"\")\n+\t\t   (unspec:DI [(match_operand:V4SI 1 \"quad_acc_operand\" \"\")]\n+\t\t\t      UNSPEC_MDADDACC))\n+\t      (set (match_operand:HI 2 \"accg_operand\" \"\")\n+\t\t   (unspec:HI [(match_operand:V4QI 3 \"accg_operand\" \"\")\n+\t\t\t       (match_dup 4)]\n+\t\t\t      UNSPEC_MDADDACC))])]\n   \"TARGET_MEDIA_REV2\"\n   \"operands[4] = GEN_INT (FRV_BUILTIN_MDADDACCS);\")\n \n (define_expand \"mdsubaccs\"\n-  [(parallel [(set (match_operand:V4SI 0 \"quad_acc_operand\" \"\")\n-\t\t   (unspec:V4SI [(match_dup 0)\n-\t\t\t\t (match_operand:V4SI 1 \"quad_acc_operand\" \"\")]\n-\t\t\t\tUNSPEC_MDADDACC))\n-\t      (set (match_operand:V4QI 2 \"accg_operand\" \"\")\n-\t      \t   (unspec:V4QI [(match_dup 2)\n-\t\t\t\t (match_operand:V4QI 3 \"accg_operand\" \"\")\n-\t\t\t\t (match_dup 4)]\n-\t\t\t\tUNSPEC_MDADDACC))])]\n+  [(parallel [(set (match_operand:DI 0 \"even_acc_operand\" \"\")\n+\t\t   (unspec:DI [(match_operand:V4SI 1 \"quad_acc_operand\" \"\")]\n+\t\t\t      UNSPEC_MDADDACC))\n+\t      (set (match_operand:HI 2 \"accg_operand\" \"\")\n+\t      \t   (unspec:HI [(match_operand:V4QI 3 \"accg_operand\" \"\")\n+\t\t\t       (match_dup 4)]\n+\t\t\t      UNSPEC_MDADDACC))])]\n   \"TARGET_MEDIA_REV2\"\n   \"operands[4] = GEN_INT (FRV_BUILTIN_MDSUBACCS);\")\n \n-(define_expand \"mdasaccs\"\n-  [(parallel [(set (match_operand:V4SI 0 \"quad_acc_operand\" \"\")\n-\t\t   (unspec:V4SI [(match_dup 0)\n-\t\t\t\t (match_operand:V4SI 1 \"quad_acc_operand\" \"\")]\n-\t\t\t\tUNSPEC_MDADDACC))\n-\t      (set (match_operand:V4QI 2 \"accg_operand\" \"\")\n-\t\t   (unspec:V4QI [(match_dup 2)\n-\t\t\t         (match_operand:V4QI 3 \"accg_operand\" \"\")\n-\t\t\t\t (match_dup 4)]\n-\t\t\t        UNSPEC_MDADDACC))])]\n+(define_insn \"mdasaccs\"\n+  [(set (match_operand:V4SI 0 \"quad_acc_operand\" \"=A\")\n+\t(unspec:V4SI [(match_operand:V4SI 1 \"quad_acc_operand\" \"A\")]\n+\t\t     UNSPEC_MDASACCS))\n+   (set (match_operand:V4QI 2 \"accg_operand\" \"=B\")\n+\t(unspec:V4QI [(match_operand:V4QI 3 \"accg_operand\" \"B\")]\n+\t\t     UNSPEC_MDASACCS))]\n   \"TARGET_MEDIA_REV2\"\n-  \"operands[4] = GEN_INT (FRV_BUILTIN_MDASACCS);\")\n+  \"mdasaccs %1, %0\"\n+  [(set_attr \"length\" \"4\")\n+   (set_attr \"type\" \"mdaddacc\")])\n \n (define_insn \"*mdaddacc\"\n-  [(set (match_operand:V4SI 0 \"quad_acc_operand\" \"+A\")\n-\t(unspec:V4SI [(match_dup 0)\n-\t\t      (match_operand:V4SI 1 \"quad_acc_operand\" \"A\")]\n-\t\t     UNSPEC_MDADDACC))\n-   (set (match_operand:V4QI 2 \"accg_operand\" \"+B\")\n-\t(unspec:V4QI [(match_dup 2)\n-\t\t      (match_operand:V4QI 3 \"accg_operand\" \"B\")\n-\t\t      (match_operand:SI 4 \"const_int_operand\" \"n\")]\n-\t\t     UNSPEC_MDADDACC))]\n+  [(set (match_operand:DI 0 \"even_acc_operand\" \"=b\")\n+\t(unspec:DI [(match_operand:V4SI 1 \"quad_acc_operand\" \"A\")]\n+\t\t   UNSPEC_MDADDACC))\n+   (set (match_operand:HI 2 \"accg_operand\" \"=B\")\n+\t(unspec:HI [(match_operand:V4QI 3 \"accg_operand\" \"B\")\n+\t\t    (match_operand:SI 4 \"const_int_operand\" \"n\")]\n+\t\t   UNSPEC_MDADDACC))]\n   \"TARGET_MEDIA_REV2\"\n   \"*\n {\n@@ -7849,7 +7836,6 @@\n   default:\t\t      break;\n   case FRV_BUILTIN_MDADDACCS: return \\\"mdaddaccs %1, %0\\\";\n   case FRV_BUILTIN_MDSUBACCS: return \\\"mdsubaccs %1, %0\\\";\n-  case FRV_BUILTIN_MDASACCS:  return \\\"mdasaccs %1, %0\\\";\n   }\n \n   fatal_insn (\\\"Bad media insn, mdaddacc\\\", insn);"}]}