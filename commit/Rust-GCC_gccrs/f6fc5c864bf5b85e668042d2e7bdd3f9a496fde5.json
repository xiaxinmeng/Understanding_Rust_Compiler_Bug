{"sha": "f6fc5c864bf5b85e668042d2e7bdd3f9a496fde5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjZmYzVjODY0YmY1Yjg1ZTY2ODA0MmQyZTdiZGQzZjlhNDk2ZmRlNQ==", "commit": {"author": {"name": "Mark Mitchell", "email": "mark@codesourcery.com", "date": "2007-02-27T15:49:23Z"}, "committer": {"name": "Mark Mitchell", "email": "mmitchel@gcc.gnu.org", "date": "2007-02-27T15:49:23Z"}, "message": "c-common.c (get_priority): Add check for SUPPORTS_INIT_PRIORITY.\n\n\t* c-common.c (get_priority): Add check for\n\tSUPPORTS_INIT_PRIORITY.\n\n\t* lib/target-supports.exp (check_effective_target_init_priority):\n\tRemove Solaris special case.\n\nFrom-SVN: r122378", "tree": {"sha": "6202d439e8eccfb35cb0bd6d9cf4e61e9222cb64", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6202d439e8eccfb35cb0bd6d9cf4e61e9222cb64"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f6fc5c864bf5b85e668042d2e7bdd3f9a496fde5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f6fc5c864bf5b85e668042d2e7bdd3f9a496fde5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f6fc5c864bf5b85e668042d2e7bdd3f9a496fde5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f6fc5c864bf5b85e668042d2e7bdd3f9a496fde5/comments", "author": null, "committer": null, "parents": [{"sha": "97130915859e571fc8eb6e4ff0eab2ad5e737cc9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/97130915859e571fc8eb6e4ff0eab2ad5e737cc9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/97130915859e571fc8eb6e4ff0eab2ad5e737cc9"}], "stats": {"total": 29, "additions": 21, "deletions": 8}, "files": [{"sha": "bac6d56f54dda74e985a507282c24c28cd267c37", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f6fc5c864bf5b85e668042d2e7bdd3f9a496fde5/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f6fc5c864bf5b85e668042d2e7bdd3f9a496fde5/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=f6fc5c864bf5b85e668042d2e7bdd3f9a496fde5", "patch": "@@ -1,3 +1,8 @@\n+2007-02-27  Mark Mitchell  <mark@codesourcery.com>\n+\n+\t* c-common.c (get_priority): Add check for\n+\tSUPPORTS_INIT_PRIORITY.\n+\n 2007-02-27  Bernd Schmidt  <bernd.schmidt@analog.com>\n \n \t* config/bfin/bfin.md (doloop_end): FAIL if counter reg isn't SImode."}, {"sha": "8d321a292f5e066a1778b010d692ccedd39f4f34", "filename": "gcc/c-common.c", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f6fc5c864bf5b85e668042d2e7bdd3f9a496fde5/gcc%2Fc-common.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f6fc5c864bf5b85e668042d2e7bdd3f9a496fde5/gcc%2Fc-common.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-common.c?ref=f6fc5c864bf5b85e668042d2e7bdd3f9a496fde5", "patch": "@@ -4697,6 +4697,15 @@ get_priority (tree args, bool is_destructor)\n   if (!args)\n     return DEFAULT_INIT_PRIORITY;\n   \n+  if (!SUPPORTS_INIT_PRIORITY)\n+    {\n+      if (is_destructor)\n+\terror (\"destructor priorities are not supported\");\n+      else\n+\terror (\"constructor priorities are not supported\");\n+      return DEFAULT_INIT_PRIORITY;\n+    }\n+\n   arg = TREE_VALUE (args);\n   if (!host_integerp (arg, /*pos=*/0)\n       || !INTEGRAL_TYPE_P (TREE_TYPE (arg)))"}, {"sha": "cf07c57ad94810536e0dcd19554b5ee87ccc83a4", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f6fc5c864bf5b85e668042d2e7bdd3f9a496fde5/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f6fc5c864bf5b85e668042d2e7bdd3f9a496fde5/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=f6fc5c864bf5b85e668042d2e7bdd3f9a496fde5", "patch": "@@ -1,3 +1,8 @@\n+2007-02-27  Mark Mitchell  <mark@codesourcery.com>\n+\n+\t* lib/target-supports.exp (check_effective_target_init_priority):\n+\tRemove Solaris special case.\n+\n 2007-02-26  Geoffrey Keating  <geoffk@apple.com>\n \n \t* gcc.target/powerpc/stabs-attrib-vect-darwin.c: Allow\n@@ -35,7 +40,8 @@\n \t* g++.dg/special/initp1.C: Likewise.\n \t* g++.dg/special/ecos.exp: Remove code to detect availability of\n \tconstructor priorities.\n-\t* lib/target-support.exp (target_init_priority): New function.\n+\t* lib/target-supports.exp (check_effective_target_init_priority):\n+\tNew function.\n \n 2007-02-24  Jan Hubicka  <jh@suse.cz>\n "}, {"sha": "e205f47b3f4c79399dfbcdd64ffdaa34cba0182c", "filename": "gcc/testsuite/lib/target-supports.exp", "status": "modified", "additions": 0, "deletions": 7, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f6fc5c864bf5b85e668042d2e7bdd3f9a496fde5/gcc%2Ftestsuite%2Flib%2Ftarget-supports.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f6fc5c864bf5b85e668042d2e7bdd3f9a496fde5/gcc%2Ftestsuite%2Flib%2Ftarget-supports.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Flib%2Ftarget-supports.exp?ref=f6fc5c864bf5b85e668042d2e7bdd3f9a496fde5", "patch": "@@ -2093,13 +2093,6 @@ proc check_effective_target_dummy_wcsftime {} {\n # supposed on this target.\n \n proc check_effective_target_init_priority {} {\n-    # On Solaris2, initialization priorities are only supported with\n-    # GNU ld, but the compiler accepts them even when using Sun ld.\n-    # For more information, see PR 6482.\n-    if { [istarget *-solaris2*] } {\n-\treturn 1\n-    }\n-\n     return [check_no_compiler_messages init_priority assembly \"\n \tvoid f() __attribute__((constructor (1000)));\n \tvoid f() \\{\\}"}]}