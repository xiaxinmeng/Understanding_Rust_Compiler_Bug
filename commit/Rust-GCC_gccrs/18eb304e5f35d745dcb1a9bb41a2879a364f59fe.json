{"sha": "18eb304e5f35d745dcb1a9bb41a2879a364f59fe", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MThlYjMwNGU1ZjM1ZDc0NWRjYjFhOWJiNDFhMjg3OWEzNjRmNTlmZQ==", "commit": {"author": {"name": "Jeff Law", "email": "law@redhat.com", "date": "2017-02-23T05:47:43Z"}, "committer": {"name": "Jeff Law", "email": "law@gcc.gnu.org", "date": "2017-02-23T05:47:43Z"}, "message": "re PR tree-optimization/79578 (Unnecessary instructions in generated code)\n\n\tPR tree-optimization/79578\n\t* tree-ssa-dse.c (clear_bytes_written_by): Use operand_equal_p\n\tto compare base operands.\n\n\tPR tree-optimization/79578\n\t* g++.dg/tree-ssa/ssa-dse-3.C: New test.\n\nFrom-SVN: r245675", "tree": {"sha": "0dcaba18a3d8d4af87ff52e98edd49f63362b466", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0dcaba18a3d8d4af87ff52e98edd49f63362b466"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/18eb304e5f35d745dcb1a9bb41a2879a364f59fe", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/18eb304e5f35d745dcb1a9bb41a2879a364f59fe", "html_url": "https://github.com/Rust-GCC/gccrs/commit/18eb304e5f35d745dcb1a9bb41a2879a364f59fe", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/18eb304e5f35d745dcb1a9bb41a2879a364f59fe/comments", "author": null, "committer": null, "parents": [{"sha": "680ed1065a3701a55f1a800db4d70f08e5ea5194", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/680ed1065a3701a55f1a800db4d70f08e5ea5194", "html_url": "https://github.com/Rust-GCC/gccrs/commit/680ed1065a3701a55f1a800db4d70f08e5ea5194"}], "stats": {"total": 41, "additions": 40, "deletions": 1}, "files": [{"sha": "6da1d74115f18b879d5f90853d0dd72b7d127ac5", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/18eb304e5f35d745dcb1a9bb41a2879a364f59fe/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/18eb304e5f35d745dcb1a9bb41a2879a364f59fe/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=18eb304e5f35d745dcb1a9bb41a2879a364f59fe", "patch": "@@ -1,3 +1,9 @@\n+2017-02-22 Jeff Law  <law@redhat.com>\n+\n+\tPR tree-optimization/79578\n+\t* tree-ssa-dse.c (clear_bytes_written_by): Use operand_equal_p\n+\tto compare base operands.\n+\n 2017-02-22  Segher Boessenkool  <segher@kernel.crashing.org>\n \n \tPR target/79211"}, {"sha": "d900cc3496ba6e8ac1a3334958cddd13dd6a01f0", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/18eb304e5f35d745dcb1a9bb41a2879a364f59fe/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/18eb304e5f35d745dcb1a9bb41a2879a364f59fe/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=18eb304e5f35d745dcb1a9bb41a2879a364f59fe", "patch": "@@ -1,3 +1,8 @@\n+2017-02-22  Jeff Law  <law@redhat.com>\n+\n+\tPR tree-optimization/79578\n+\t* g++.dg/tree-ssa/ssa-dse-3.C: New test.\n+\n 2017-02-22  Sameera Deshpande  <sameera.deshpande@imgtec.com>\n \n \t* gcc.target/mips/msa-fp-cc.c: New test."}, {"sha": "fe8f309ac22988437e542532f60553c9460e6d16", "filename": "gcc/testsuite/g++.dg/tree-ssa/ssa-dse-3.C", "status": "added", "additions": 28, "deletions": 0, "changes": 28, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/18eb304e5f35d745dcb1a9bb41a2879a364f59fe/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftree-ssa%2Fssa-dse-3.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/18eb304e5f35d745dcb1a9bb41a2879a364f59fe/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftree-ssa%2Fssa-dse-3.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftree-ssa%2Fssa-dse-3.C?ref=18eb304e5f35d745dcb1a9bb41a2879a364f59fe", "patch": "@@ -0,0 +1,28 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-std=c++14 -O3 -fdump-tree-dse1-details\" } */\n+\n+#include <new>\n+#include <cstdint>\n+\n+struct A\n+{\n+    std::uint16_t a, b;\n+};\n+\n+A* f(char* b) __attribute__((noinline));\n+\n+A* f(char* b) {\n+    auto a = new(b) A{};\n+    a->a = 1;\n+    a->b = 2;\n+    return a;\n+}\n+\n+int main() {\n+    char b[sizeof(A)] alignas(A);\n+    f(b);\n+}\n+\n+\n+/* { dg-final { scan-tree-dump \"Deleted dead store: \" \"dse1\" } } */\n+"}, {"sha": "a82e16449c49ad93914a27df525e05c00e8c1680", "filename": "gcc/tree-ssa-dse.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/18eb304e5f35d745dcb1a9bb41a2879a364f59fe/gcc%2Ftree-ssa-dse.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/18eb304e5f35d745dcb1a9bb41a2879a364f59fe/gcc%2Ftree-ssa-dse.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-dse.c?ref=18eb304e5f35d745dcb1a9bb41a2879a364f59fe", "patch": "@@ -176,7 +176,7 @@ clear_bytes_written_by (sbitmap live_bytes, gimple *stmt, ao_ref *ref)\n   /* Verify we have the same base memory address, the write\n      has a known size and overlaps with REF.  */\n   if (valid_ao_ref_for_dse (&write)\n-      && write.base == ref->base\n+      && operand_equal_p (write.base, ref->base, 0)\n       && write.size == write.max_size\n       && ((write.offset < ref->offset\n \t   && write.offset + write.size > ref->offset)"}]}