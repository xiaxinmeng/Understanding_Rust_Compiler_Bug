{"sha": "3c0ae05d9edbf9f3c28e6458c41ec32a77337e38", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6M2MwYWUwNWQ5ZWRiZjlmM2MyOGU2NDU4YzQxZWMzMmE3NzMzN2UzOA==", "commit": {"author": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2017-09-06T10:19:44Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2017-09-06T10:19:44Z"}, "message": "[multiple changes]\n\n2017-09-06  Ed Schonberg  <schonberg@adacore.com>\n\n\t* sem_warn.adb (Warn_On_Overlapping_Actuals): Refine previous\n\tfix and preserve older GNAT warning on overlapping actuals that\n\tare not elementary types.\n\n2017-09-06  Justin Squirek  <squirek@adacore.com>\n\n\t* sem_attr.adb: Comment correction.\n\nFrom-SVN: r251771", "tree": {"sha": "9ebf04d6a52ed4167c68dcc1442af6ab6a85f852", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9ebf04d6a52ed4167c68dcc1442af6ab6a85f852"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3c0ae05d9edbf9f3c28e6458c41ec32a77337e38", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3c0ae05d9edbf9f3c28e6458c41ec32a77337e38", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3c0ae05d9edbf9f3c28e6458c41ec32a77337e38", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3c0ae05d9edbf9f3c28e6458c41ec32a77337e38/comments", "author": null, "committer": null, "parents": [{"sha": "62bb542316bd5917977eda6ea89fcaadb09be287", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/62bb542316bd5917977eda6ea89fcaadb09be287", "html_url": "https://github.com/Rust-GCC/gccrs/commit/62bb542316bd5917977eda6ea89fcaadb09be287"}], "stats": {"total": 62, "additions": 47, "deletions": 15}, "files": [{"sha": "5e6d0afd348e508fa841f02e0a25a7f407a36182", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3c0ae05d9edbf9f3c28e6458c41ec32a77337e38/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3c0ae05d9edbf9f3c28e6458c41ec32a77337e38/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=3c0ae05d9edbf9f3c28e6458c41ec32a77337e38", "patch": "@@ -1,3 +1,13 @@\n+2017-09-06  Ed Schonberg  <schonberg@adacore.com>\n+\n+\t* sem_warn.adb (Warn_On_Overlapping_Actuals): Refine previous\n+\tfix and preserve older GNAT warning on overlapping actuals that\n+\tare not elementary types.\n+\n+2017-09-06  Justin Squirek  <squirek@adacore.com>\n+\n+\t* sem_attr.adb: Comment correction.\n+\n 2017-09-06  Gary Dismukes  <dismukes@adacore.com>\n \n \t* sem_util.adb: Minor reformatting."}, {"sha": "436c359d91c719b0d0556d630f04584520c1ea48", "filename": "gcc/ada/sem_attr.adb", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3c0ae05d9edbf9f3c28e6458c41ec32a77337e38/gcc%2Fada%2Fsem_attr.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3c0ae05d9edbf9f3c28e6458c41ec32a77337e38/gcc%2Fada%2Fsem_attr.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_attr.adb?ref=3c0ae05d9edbf9f3c28e6458c41ec32a77337e38", "patch": "@@ -364,7 +364,8 @@ package body Sem_Attr is\n       --  Check that P is an object reference\n \n       procedure Check_Object_Reference_Image (Str_Typ : Entity_Id);\n-      --  Verify that the prefix of an image attribute.... ???\n+      --  Verify that the prefix of an image attribute is an object reference\n+      --  and set the Etype of the prefix to that specified by Str_Typ.\n \n       procedure Check_PolyORB_Attribute;\n       --  Validity checking for PolyORB/DSA attribute"}, {"sha": "962e9194e93d544a700ec887292990bca44c8d08", "filename": "gcc/ada/sem_warn.adb", "status": "modified", "additions": 35, "deletions": 14, "changes": 49, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3c0ae05d9edbf9f3c28e6458c41ec32a77337e38/gcc%2Fada%2Fsem_warn.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3c0ae05d9edbf9f3c28e6458c41ec32a77337e38/gcc%2Fada%2Fsem_warn.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_warn.adb?ref=3c0ae05d9edbf9f3c28e6458c41ec32a77337e38", "patch": "@@ -3608,10 +3608,14 @@ package body Sem_Warn is\n \n       --  Local variables\n \n-      Act1  : Node_Id;\n-      Act2  : Node_Id;\n-      Form1 : Entity_Id;\n-      Form2 : Entity_Id;\n+      Act1       : Node_Id;\n+      Act2       : Node_Id;\n+      Form1      : Entity_Id;\n+      Form2      : Entity_Id;\n+      Warn_Only  : Boolean;\n+      --  GNAT warns on overlapping in-out parameters even when there\n+      --  sre no two in-out parameters of an elementary type, as stated in\n+      --  RM 6.5.1 (17/2).\n \n    --  Start of processing for Warn_On_Overlapping_Actuals\n \n@@ -3621,6 +3625,29 @@ package body Sem_Warn is\n          return;\n       end if;\n \n+      --  The call is illegal only if there are at least two in-out\n+      --  parameters of the same elementary type.\n+\n+      Warn_Only := True;\n+      Form1 := First_Formal (Subp);\n+      while Present (Form1) loop\n+         Form2 := Next_Formal (Form1);\n+         while Present (Form2) loop\n+            if Is_Elementary_Type (Etype (Form1))\n+              and then Is_Elementary_Type (Etype (Form2))\n+              and then Ekind (Form1) /= E_In_Parameter\n+              and then Ekind (Form2) /= E_In_Parameter\n+            then\n+               Warn_Only := False;\n+               exit;\n+            end if;\n+\n+            Next_Formal (Form2);\n+         end loop;\n+\n+         Next_Formal (Form1);\n+      end loop;\n+\n       --  Exclude calls rewritten as enumeration literals\n \n       if Nkind (N) not in N_Subprogram_Call\n@@ -3684,14 +3711,6 @@ package body Sem_Warn is\n                   then\n                      null;\n \n-                  --  If the types of the formals are different there can\n-                  --  be no aliasing (even though there might be overlap\n-                  --  through address clauses, which must be intentional).\n-\n-                  elsif Base_Type (Etype (Form1)) /= Base_Type (Etype (Form2))\n-                  then\n-                     null;\n-\n                   --  Here we may need to issue overlap message\n \n                   else\n@@ -3708,10 +3727,12 @@ package body Sem_Warn is\n \n                        or else not Is_Elementary_Type (Etype (Form1))\n \n-                       --  Finally, debug flag -gnatd.E changes the error to a\n+                       --  debug flag -gnatd.E changes the error to a\n                        --  warning even in Ada 2012 mode.\n \n-                       or else Error_To_Warning;\n+                       or else Error_To_Warning\n+\n+                       or else Warn_Only;\n \n                      declare\n                         Act  : Node_Id;"}]}