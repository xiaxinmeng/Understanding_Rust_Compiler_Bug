{"sha": "0780eccc5da4e9c0f4e8492fab37e13459da6476", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDc4MGVjY2M1ZGE0ZTljMGY0ZTg0OTJmYWIzN2UxMzQ1OWRhNjQ3Ng==", "commit": {"author": {"name": "Vincent Celier", "email": "celier@adacore.com", "date": "2007-04-06T09:24:28Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2007-04-06T09:24:28Z"}, "message": "mlib.adb (Building_Library): Only output \"building a library...\" in verbose mode\n\n2007-04-06  Vincent Celier  <celier@adacore.com>\n\n\t* mlib.adb (Building_Library): Only output \"building a library...\" in\n\tverbose mode\n\n\t* mlib-prj.adb (Build_Library): Only output lists of object and ALI\n\tfiles in verbose mode.\n\n\t* mlib-utl.adb (Ar): Only output the first object files when not in\n\tverbose mode.\n\t(Gcc): Do not display all the object files if not in verbose mode, only\n\tthe first one.\n\nFrom-SVN: r123585", "tree": {"sha": "563a614cf2fe714c51cbba326b304bb16359a781", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/563a614cf2fe714c51cbba326b304bb16359a781"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0780eccc5da4e9c0f4e8492fab37e13459da6476", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0780eccc5da4e9c0f4e8492fab37e13459da6476", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0780eccc5da4e9c0f4e8492fab37e13459da6476", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0780eccc5da4e9c0f4e8492fab37e13459da6476/comments", "author": {"login": "vcelier", "id": 8888056, "node_id": "MDQ6VXNlcjg4ODgwNTY=", "avatar_url": "https://avatars.githubusercontent.com/u/8888056?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vcelier", "html_url": "https://github.com/vcelier", "followers_url": "https://api.github.com/users/vcelier/followers", "following_url": "https://api.github.com/users/vcelier/following{/other_user}", "gists_url": "https://api.github.com/users/vcelier/gists{/gist_id}", "starred_url": "https://api.github.com/users/vcelier/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vcelier/subscriptions", "organizations_url": "https://api.github.com/users/vcelier/orgs", "repos_url": "https://api.github.com/users/vcelier/repos", "events_url": "https://api.github.com/users/vcelier/events{/privacy}", "received_events_url": "https://api.github.com/users/vcelier/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "0916df6a3e3a63c275b1b88b6298bcdd97e9b2d4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0916df6a3e3a63c275b1b88b6298bcdd97e9b2d4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0916df6a3e3a63c275b1b88b6298bcdd97e9b2d4"}], "stats": {"total": 88, "additions": 63, "deletions": 25}, "files": [{"sha": "307e4f6176d82ca5baa73246ab4bd0c12fb88f6d", "filename": "gcc/ada/mlib-prj.adb", "status": "modified", "additions": 22, "deletions": 17, "changes": 39, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0780eccc5da4e9c0f4e8492fab37e13459da6476/gcc%2Fada%2Fmlib-prj.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0780eccc5da4e9c0f4e8492fab37e13459da6476/gcc%2Fada%2Fmlib-prj.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fmlib-prj.adb?ref=0780eccc5da4e9c0f4e8492fab37e13459da6476", "patch": "@@ -1393,30 +1393,35 @@ package body MLib.Prj is\n             Write_Str  (\" library for project \");\n             Write_Line (Project_Name);\n \n-            Write_Eol;\n+            --  Only output the list of object files and ALI files in verbose\n+            --  mode.\n \n-            Write_Line (\"object files:\");\n+            if Opt.Verbose_Mode then\n+               Write_Eol;\n \n-            for Index in Object_Files'Range loop\n-               Write_Str  (\"   \");\n-               Write_Line (Object_Files (Index).all);\n-            end loop;\n+               Write_Line (\"object files:\");\n \n-            Write_Eol;\n+               for Index in Object_Files'Range loop\n+                  Write_Str  (\"   \");\n+                  Write_Line (Object_Files (Index).all);\n+               end loop;\n \n-            if Ali_Files'Length = 0 then\n-               Write_Line (\"NO ALI files\");\n+               Write_Eol;\n \n-            else\n-               Write_Line (\"ALI files:\");\n+               if Ali_Files'Length = 0 then\n+                  Write_Line (\"NO ALI files\");\n \n-               for Index in Ali_Files'Range loop\n-                  Write_Str  (\"   \");\n-                  Write_Line (Ali_Files (Index).all);\n-               end loop;\n-            end if;\n+               else\n+                  Write_Line (\"ALI files:\");\n \n-            Write_Eol;\n+                  for Index in Ali_Files'Range loop\n+                     Write_Str  (\"   \");\n+                     Write_Line (Ali_Files (Index).all);\n+                  end loop;\n+               end if;\n+\n+               Write_Eol;\n+            end if;\n          end if;\n \n          --  We check that all object files are regular files"}, {"sha": "09c89264dd23b2431cae7abc2c82de7753a10cc0", "filename": "gcc/ada/mlib-utl.adb", "status": "modified", "additions": 39, "deletions": 6, "changes": 45, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0780eccc5da4e9c0f4e8492fab37e13459da6476/gcc%2Fada%2Fmlib-utl.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0780eccc5da4e9c0f4e8492fab37e13459da6476/gcc%2Fada%2Fmlib-utl.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fmlib-utl.adb?ref=0780eccc5da4e9c0f4e8492fab37e13459da6476", "patch": "@@ -124,6 +124,14 @@ package body MLib.Utl is\n             end if;\n \n             Write_Char (' ');\n+\n+            --  Only output the first object files when not in verbose mode\n+\n+            if (not Opt.Verbose_Mode) and then J = Ar_Options'Length + 3 then\n+               Write_Str (\"...\");\n+               exit;\n+            end if;\n+\n             Write_Str  (Arguments (J).all);\n             Line_Length := Line_Length + 1 + Arguments (J)'Length;\n          end loop;\n@@ -209,6 +217,10 @@ package body MLib.Utl is\n \n       Driver    : String_Access;\n \n+      type Object_Position is (First, Second, Last);\n+\n+      Position : Object_Position;\n+\n    begin\n       if Driver_Name = No_Name then\n          if Gcc_Exec = null then\n@@ -246,12 +258,6 @@ package body MLib.Utl is\n       A := A + Options'Length;\n       Arguments (A - Options'Length + 1 .. A) := Options;\n \n-      A := A + Objects'Length;\n-      Arguments (A - Objects'Length + 1 .. A) := Objects;\n-\n-      A := A + Options_2'Length;\n-      Arguments (A - Options_2'Length + 1 .. A) := Options_2;\n-\n       if not Opt.Quiet_Output then\n          Write_Str (Driver.all);\n \n@@ -260,9 +266,36 @@ package body MLib.Utl is\n             Write_Str  (Arguments (J).all);\n          end loop;\n \n+         --  Do not display all the object files if not in verbose mode, only\n+         --  the first one.\n+\n+         Position := First;\n+         for J in Objects'Range loop\n+            if Opt.Verbose_Mode or else Position = First then\n+               Write_Char (' ');\n+               Write_Str (Objects (J).all);\n+               Position := Second;\n+\n+            elsif Position = Second then\n+               Write_Str (\" ...\");\n+               Position := Last;\n+            end if;\n+         end loop;\n+\n+         for J in Options_2'Range loop\n+            Write_Char (' ');\n+            Write_Str (Options_2 (J).all);\n+         end loop;\n+\n          Write_Eol;\n       end if;\n \n+      A := A + Objects'Length;\n+      Arguments (A - Objects'Length + 1 .. A) := Objects;\n+\n+      A := A + Options_2'Length;\n+      Arguments (A - Options_2'Length + 1 .. A) := Options_2;\n+\n       OS_Lib.Spawn (Driver.all, Arguments (1 .. A), Success);\n \n       if not Success then"}, {"sha": "def15c254296ecb385b78242add1abde30e9e983", "filename": "gcc/ada/mlib.adb", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0780eccc5da4e9c0f4e8492fab37e13459da6476/gcc%2Fada%2Fmlib.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0780eccc5da4e9c0f4e8492fab37e13459da6476/gcc%2Fada%2Fmlib.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fmlib.adb?ref=0780eccc5da4e9c0f4e8492fab37e13459da6476", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 B o d y                                  --\n --                                                                          --\n---                     Copyright (C) 1999-2005, AdaCore                     --\n+--                     Copyright (C) 1999-2006, AdaCore                     --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -53,7 +53,7 @@ package body MLib is\n       pragma Warnings (Off, Afiles);\n \n    begin\n-      if not Opt.Quiet_Output then\n+      if Opt.Verbose_Mode and not Opt.Quiet_Output then\n          Write_Line (\"building a library...\");\n          Write_Str  (\"   make \");\n          Write_Line (Output_File);"}]}