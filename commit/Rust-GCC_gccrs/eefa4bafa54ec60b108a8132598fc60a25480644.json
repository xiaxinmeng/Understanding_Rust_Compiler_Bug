{"sha": "eefa4bafa54ec60b108a8132598fc60a25480644", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWVmYTRiYWZhNTRlYzYwYjEwOGE4MTMyNTk4ZmM2MGEyNTQ4MDY0NA==", "commit": {"author": {"name": "Abderrazek Zaafrani", "email": "a.zaafrani@samsung.com", "date": "2015-11-11T20:43:51Z"}, "committer": {"name": "Sebastian Pop", "email": "spop@gcc.gnu.org", "date": "2015-11-11T20:43:51Z"}, "message": "improve construction of the original schedule\n\nThe patch builds the original schedule based on the now optimized scattering\ndimension instead of building one based on the loop index only.\n\nThe implementation is simpler and catches more cases where the original schedule\nand the transformed schedule are the same, such as the one below:\n\nfor (i = 0; i < 1000; i++)\n{\n  Temp = F[i];\n  for (j = 0; j < 1000; j++)\n {\n    D[j] = E[j]  * Temp;\n    A[i][j] = A[i][j]  + B[i][j] * C[i][j] - D[j] ;\n  }\n  D[i] = E[i] * F[i];\n}\n\n  * graphite-sese-to-poly.c (build_scop_original_schedule): Call\n  isl_union_map_add_map on every pbb->schedule.\n\nFrom-SVN: r230191", "tree": {"sha": "a7750363fe6a9434a56d232430833e3216b9b9b5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a7750363fe6a9434a56d232430833e3216b9b9b5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/eefa4bafa54ec60b108a8132598fc60a25480644", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/eefa4bafa54ec60b108a8132598fc60a25480644", "html_url": "https://github.com/Rust-GCC/gccrs/commit/eefa4bafa54ec60b108a8132598fc60a25480644", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/eefa4bafa54ec60b108a8132598fc60a25480644/comments", "author": null, "committer": {"login": "sebpop", "id": 568397, "node_id": "MDQ6VXNlcjU2ODM5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/568397?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sebpop", "html_url": "https://github.com/sebpop", "followers_url": "https://api.github.com/users/sebpop/followers", "following_url": "https://api.github.com/users/sebpop/following{/other_user}", "gists_url": "https://api.github.com/users/sebpop/gists{/gist_id}", "starred_url": "https://api.github.com/users/sebpop/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sebpop/subscriptions", "organizations_url": "https://api.github.com/users/sebpop/orgs", "repos_url": "https://api.github.com/users/sebpop/repos", "events_url": "https://api.github.com/users/sebpop/events{/privacy}", "received_events_url": "https://api.github.com/users/sebpop/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d82f8c85fcb2fdd4400ab14b336aa957baf7ffab", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d82f8c85fcb2fdd4400ab14b336aa957baf7ffab", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d82f8c85fcb2fdd4400ab14b336aa957baf7ffab"}], "stats": {"total": 32, "additions": 16, "deletions": 16}, "files": [{"sha": "efbd38f272fbb757389bb68b22cae49b755f07cd", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eefa4bafa54ec60b108a8132598fc60a25480644/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eefa4bafa54ec60b108a8132598fc60a25480644/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=eefa4bafa54ec60b108a8132598fc60a25480644", "patch": "@@ -1,3 +1,8 @@\n+2015-11-11  Abderrazek Zaafrani  <a.zaafrani@samsung.com>\n+\n+\t* graphite-sese-to-poly.c (build_scop_original_schedule): Call\n+\tisl_union_map_add_map on every pbb->schedule.\n+\n 2015-11-11  Tom de Vries  <tom@codesourcery.com>\n \n \t* tree-parloops.c (create_parallel_loop): Return void."}, {"sha": "3c245125fa77bf00124cd61efbe8f452cc8ce90d", "filename": "gcc/graphite-sese-to-poly.c", "status": "modified", "additions": 11, "deletions": 16, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eefa4bafa54ec60b108a8132598fc60a25480644/gcc%2Fgraphite-sese-to-poly.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eefa4bafa54ec60b108a8132598fc60a25480644/gcc%2Fgraphite-sese-to-poly.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgraphite-sese-to-poly.c?ref=eefa4bafa54ec60b108a8132598fc60a25480644", "patch": "@@ -446,31 +446,26 @@ build_scop_minimal_scattering (scop_p scop)\n      }\n \n    Static schedules for A to D expressed in a union map:\n-\n-   { S_A[i0, i1] -> [i0, i1]; S_B[i0] -> [i0]; S_C[] -> []; S_9[i0] -> [i0] }\n-\n+   {\n+     S_A[i0, i1] -> [0, i0, 0, i1];\n+     S_B[i0]     -> [0, i0, 1];\n+     S_C[]       -> [1];\n+     S_D[i0]     -> [2, i0, 0]\n+   }\n */\n \n static void\n build_scop_original_schedule (scop_p scop)\n {\n+  int i;\n+  poly_bb_p pbb;\n+\n   isl_space *space = isl_set_get_space (scop->param_context);\n   isl_union_map *res = isl_union_map_empty (space);\n \n-  int i;\n-  poly_bb_p pbb;\n   FOR_EACH_VEC_ELT (scop->pbbs, i, pbb)\n-    {\n-      int nb_dimensions = isl_set_dim (pbb->domain, isl_dim_set);\n-      isl_space *dc = isl_set_get_space (pbb->domain);\n-      isl_space *dm = isl_space_add_dims (isl_space_from_domain (dc),\n-\t\t\t\t\t  isl_dim_out, nb_dimensions);\n-      isl_map *mp = isl_map_universe (dm);\n-      for (int i = 0; i < nb_dimensions; i++)\n-\tmp = isl_map_equate (mp, isl_dim_in, i, isl_dim_out, i);\n-\n-      res = isl_union_map_add_map (res, mp);\n-    }\n+    res = isl_union_map_add_map (res, isl_map_copy (pbb->schedule));\n+\n   scop->original_schedule = res;\n }\n "}]}