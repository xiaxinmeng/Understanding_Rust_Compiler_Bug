{"sha": "9bd99cce5b3769fd98b3db0d858222fa67e56486", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWJkOTljY2U1YjM3NjlmZDk4YjNkYjBkODU4MjIyZmE2N2U1NjQ4Ng==", "commit": {"author": {"name": "Chung-Lin Tang", "email": "cltang@codesourcery.com", "date": "2016-11-17T06:26:56Z"}, "committer": {"name": "Chung-Lin Tang", "email": "cltang@gcc.gnu.org", "date": "2016-11-17T06:26:56Z"}, "message": "re PR target/78357 (nios2 uses non-standard atomic functions)\n\n2016-11-17  Chung-Lin Tang  <cltang@codesourcery.com>\n\n\tPR target/78357\n\t* config/nios2/nios2.c (nios2_init_libfuncs): Remove TARGET_LINUX_ABI\n\tcondition.\n\t(TARGET_INIT_LIBFUNCS): Delete definition and...\n\t* config/nios2/linux.h (TARGET_INIT_LIBFUNCS): ...move to here, add\n\tcomments.\n\nFrom-SVN: r242534", "tree": {"sha": "289c77c852da5ded79da5208441b4479e61c6275", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/289c77c852da5ded79da5208441b4479e61c6275"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9bd99cce5b3769fd98b3db0d858222fa67e56486", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9bd99cce5b3769fd98b3db0d858222fa67e56486", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9bd99cce5b3769fd98b3db0d858222fa67e56486", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9bd99cce5b3769fd98b3db0d858222fa67e56486/comments", "author": {"login": "cltang", "id": 4055966, "node_id": "MDQ6VXNlcjQwNTU5NjY=", "avatar_url": "https://avatars.githubusercontent.com/u/4055966?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cltang", "html_url": "https://github.com/cltang", "followers_url": "https://api.github.com/users/cltang/followers", "following_url": "https://api.github.com/users/cltang/following{/other_user}", "gists_url": "https://api.github.com/users/cltang/gists{/gist_id}", "starred_url": "https://api.github.com/users/cltang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cltang/subscriptions", "organizations_url": "https://api.github.com/users/cltang/orgs", "repos_url": "https://api.github.com/users/cltang/repos", "events_url": "https://api.github.com/users/cltang/events{/privacy}", "received_events_url": "https://api.github.com/users/cltang/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "82e435c396a2b50386952ad2ae79aaee2469f5ee", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/82e435c396a2b50386952ad2ae79aaee2469f5ee", "html_url": "https://github.com/Rust-GCC/gccrs/commit/82e435c396a2b50386952ad2ae79aaee2469f5ee"}], "stats": {"total": 20, "additions": 14, "deletions": 6}, "files": [{"sha": "c1c5b8bff48f710b02d0735160707871abf62b3a", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9bd99cce5b3769fd98b3db0d858222fa67e56486/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9bd99cce5b3769fd98b3db0d858222fa67e56486/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=9bd99cce5b3769fd98b3db0d858222fa67e56486", "patch": "@@ -1,3 +1,12 @@\n+2016-11-17  Chung-Lin Tang  <cltang@codesourcery.com>\n+\n+\tPR target/78357\n+\t* config/nios2/nios2.c (nios2_init_libfuncs): Remove TARGET_LINUX_ABI\n+\tcondition.\n+\t(TARGET_INIT_LIBFUNCS): Delete definition and...\n+\t* config/nios2/linux.h (TARGET_INIT_LIBFUNCS): ...move to here, add\n+\tcomments.\n+\n 2016-11-17  Krister Walfridsson  <krister.walfridsson@gmail.com>\n \n \t* config/netbsd-stdint.h: New."}, {"sha": "7b9e59ae96af647bf0d10d535f758afd6be4f2d4", "filename": "gcc/config/nios2/linux.h", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9bd99cce5b3769fd98b3db0d858222fa67e56486/gcc%2Fconfig%2Fnios2%2Flinux.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9bd99cce5b3769fd98b3db0d858222fa67e56486/gcc%2Fconfig%2Fnios2%2Flinux.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fnios2%2Flinux.h?ref=9bd99cce5b3769fd98b3db0d858222fa67e56486", "patch": "@@ -44,3 +44,7 @@\n    Nios II Processor Reference Handbook.  */\n #define TARGET_LINUX_ABI 1\n \n+/* For Linux, we have access to kernel support for atomic operations,\n+   add initialization for __sync_* builtins.  */\n+#undef TARGET_INIT_LIBFUNCS\n+#define TARGET_INIT_LIBFUNCS nios2_init_libfuncs"}, {"sha": "b8e21fb18b2e70b0fc16f28e6cf5b16a44e8f827", "filename": "gcc/config/nios2/nios2.c", "status": "modified", "additions": 1, "deletions": 6, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9bd99cce5b3769fd98b3db0d858222fa67e56486/gcc%2Fconfig%2Fnios2%2Fnios2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9bd99cce5b3769fd98b3db0d858222fa67e56486/gcc%2Fconfig%2Fnios2%2Fnios2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fnios2%2Fnios2.c?ref=9bd99cce5b3769fd98b3db0d858222fa67e56486", "patch": "@@ -3607,9 +3607,7 @@ nios2_expand_builtin (tree exp, rtx target, rtx subtarget ATTRIBUTE_UNUSED,\n static void\n nios2_init_libfuncs (void)\n {\n-  /* For Linux, we have access to kernel support for atomic operations.  */\n-  if (TARGET_LINUX_ABI)\n-    init_sync_libfuncs (UNITS_PER_WORD);\n+  init_sync_libfuncs (UNITS_PER_WORD);\n }\n \n \f\n@@ -4986,9 +4984,6 @@ nios2_adjust_reg_alloc_order (void)\n #undef TARGET_BUILTIN_DECL\n #define TARGET_BUILTIN_DECL nios2_builtin_decl\n \n-#undef TARGET_INIT_LIBFUNCS\n-#define TARGET_INIT_LIBFUNCS nios2_init_libfuncs\n-\n #undef TARGET_FUNCTION_OK_FOR_SIBCALL\n #define TARGET_FUNCTION_OK_FOR_SIBCALL hook_bool_tree_tree_true\n "}]}