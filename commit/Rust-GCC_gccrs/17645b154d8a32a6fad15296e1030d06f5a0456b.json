{"sha": "17645b154d8a32a6fad15296e1030d06f5a0456b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTc2NDViMTU0ZDhhMzJhNmZhZDE1Mjk2ZTEwMzBkMDZmNWEwNDU2Yg==", "commit": {"author": {"name": "Neil Booth", "email": "neil@daikokuya.demon.co.uk", "date": "2002-05-23T18:55:27Z"}, "committer": {"name": "Neil Booth", "email": "neil@gcc.gnu.org", "date": "2002-05-23T18:55:27Z"}, "message": "cppinit.c (mark_named_operators): Split out from init_builtins.\n\n\t* cppinit.c (mark_named_operators): Split out from init_builtins.\n\t(cpp_finish_options): Call it from here instead.\ntestsuite:\n\t* gcc.dg/cpp/named_ops.c: New test.\n\nFrom-SVN: r53803", "tree": {"sha": "ae57a5c0b975e00e24a2e69297727c26a4bc0aae", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ae57a5c0b975e00e24a2e69297727c26a4bc0aae"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/17645b154d8a32a6fad15296e1030d06f5a0456b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/17645b154d8a32a6fad15296e1030d06f5a0456b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/17645b154d8a32a6fad15296e1030d06f5a0456b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/17645b154d8a32a6fad15296e1030d06f5a0456b/comments", "author": null, "committer": null, "parents": [{"sha": "79ed7328ef779277dfd4bca0ab254db30416e6b7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/79ed7328ef779277dfd4bca0ab254db30416e6b7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/79ed7328ef779277dfd4bca0ab254db30416e6b7"}], "stats": {"total": 52, "additions": 42, "deletions": 10}, "files": [{"sha": "5e67ce273d3771c85fff82d2524cf64dc4573051", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/17645b154d8a32a6fad15296e1030d06f5a0456b/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/17645b154d8a32a6fad15296e1030d06f5a0456b/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=17645b154d8a32a6fad15296e1030d06f5a0456b", "patch": "@@ -1,3 +1,8 @@\n+2002-05-23  Neil Booth  <neil@daikokuya.demon.co.uk>\n+\n+\t* cppinit.c (mark_named_operators): Split out from init_builtins.\n+\t(cpp_finish_options): Call it from here instead.\n+\n 2002-05-23  Jason Thorpe  <thorpej@wasabisystems.com>\n \n \t* builtin-attrs.def: Update copyright years."}, {"sha": "98782416e96f5a058562fc61f4af403636a090f7", "filename": "gcc/cppinit.c", "status": "modified", "additions": 22, "deletions": 10, "changes": 32, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/17645b154d8a32a6fad15296e1030d06f5a0456b/gcc%2Fcppinit.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/17645b154d8a32a6fad15296e1030d06f5a0456b/gcc%2Fcppinit.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcppinit.c?ref=17645b154d8a32a6fad15296e1030d06f5a0456b", "patch": "@@ -98,6 +98,7 @@ static void path_include\t\tPARAMS ((cpp_reader *,\n \t\t\t\t\t\t char *, int));\n static void init_library\t\tPARAMS ((void));\n static void init_builtins\t\tPARAMS ((cpp_reader *));\n+static void mark_named_operators\tPARAMS ((cpp_reader *));\n static void append_include_chain\tPARAMS ((cpp_reader *,\n \t\t\t\t\t\t char *, int, int));\n static struct search_path * remove_dup_dir\tPARAMS ((cpp_reader *,\n@@ -664,6 +665,23 @@ static const struct builtin operator_array[] =\n };\n #undef B\n \n+/* Mark the C++ named operators in the hash table.  */\n+static void\n+mark_named_operators (pfile)\n+     cpp_reader *pfile;\n+{\n+  const struct builtin *b;\n+\n+  for (b = operator_array;\n+       b < (operator_array + ARRAY_SIZE (operator_array));\n+       b++)\n+    {\n+      cpp_hashnode *hp = cpp_lookup (pfile, b->name, b->len);\n+      hp->flags |= NODE_OPERATOR;\n+      hp->value.operator = b->value;\n+    }\n+}\n+\n /* Subroutine of cpp_read_main_file; reads the builtins table above and\n    enters them, and language-specific macros, into the hash table.  */\n static void\n@@ -682,16 +700,6 @@ init_builtins (pfile)\n       hp->value.builtin = b->value;\n     }\n \n-  if (CPP_OPTION (pfile, cplusplus) && CPP_OPTION (pfile, operator_names))\n-    for (b = operator_array;\n-\t b < (operator_array + ARRAY_SIZE (operator_array));\n-\t b++)\n-      {\n-\tcpp_hashnode *hp = cpp_lookup (pfile, b->name, b->len);\n-\thp->flags |= NODE_OPERATOR;\n-\thp->value.operator = b->value;\n-      }\n-\n   if (CPP_OPTION (pfile, cplusplus))\n     _cpp_define_builtin (pfile, \"__cplusplus 1\");\n   else if (CPP_OPTION (pfile, objc))\n@@ -976,6 +984,10 @@ void\n cpp_finish_options (pfile)\n      cpp_reader *pfile;\n {\n+  /* Mark named operators before handling command line macros.  */\n+  if (CPP_OPTION (pfile, cplusplus) && CPP_OPTION (pfile, operator_names))\n+    mark_named_operators (pfile);\n+\n   /* Install builtins and process command line macros etc. in the order\n      they appeared, but only if not already preprocessed.  */\n   if (! CPP_OPTION (pfile, preprocessed))"}, {"sha": "4ae2f82f3b988cdf2a40349263482ee337118e59", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/17645b154d8a32a6fad15296e1030d06f5a0456b/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/17645b154d8a32a6fad15296e1030d06f5a0456b/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=17645b154d8a32a6fad15296e1030d06f5a0456b", "patch": "@@ -1,3 +1,7 @@\n+2002-05-23  Neil Booth  <neil@daikokuya.demon.co.uk>\n+\n+\t* gcc.dg/cpp/named_ops.c: New test.\n+\n 2002-05-23  Mark Mitchell  <mark@codesourcery.com>\n \n \t* gcc/testsuite/gcc.dg/weak-8.c: New test."}, {"sha": "d03684a5f10b3c2a14b978d2daff61717b0b5ab5", "filename": "gcc/testsuite/gcc.dg/cpp/named_ops.c", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/17645b154d8a32a6fad15296e1030d06f5a0456b/gcc%2Ftestsuite%2Fgcc.dg%2Fcpp%2Fnamed_ops.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/17645b154d8a32a6fad15296e1030d06f5a0456b/gcc%2Ftestsuite%2Fgcc.dg%2Fcpp%2Fnamed_ops.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fcpp%2Fnamed_ops.c?ref=17645b154d8a32a6fad15296e1030d06f5a0456b", "patch": "@@ -0,0 +1,11 @@\n+/* Copyright (C) 2002 Free Software Foundation, Inc.  */\n+\n+/* { dg-do preprocess } */\n+/* { dg-options -fpreprocessed } */\n+\n+/* Tests that C++ named ops are still there with -fpreprocessed.  */\n+\n+/* Source: Neil Booth, 23 May 2002.  */\n+\n+#if 2 xor 2\n+#endif"}]}