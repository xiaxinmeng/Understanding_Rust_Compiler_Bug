{"sha": "ec666d23ca0f507e0940bcdf0b65848bceb1af30", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWM2NjZkMjNjYTBmNTA3ZTA5NDBiY2RmMGI2NTg0OGJjZWIxYWYzMA==", "commit": {"author": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2004-09-07T20:59:18Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2004-09-07T20:59:18Z"}, "message": "cse.c (fold_rtx): Avoid building of (CONST (MINUS (CONST_INT) (SYMBOL_REF)))\n\n\t* cse.c (fold_rtx):  Avoid building of\n\t(CONST (MINUS (CONST_INT) (SYMBOL_REF)))\n\nFrom-SVN: r87156", "tree": {"sha": "4e9fa96fc33091fc673b10b40663ad44ba84f3aa", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4e9fa96fc33091fc673b10b40663ad44ba84f3aa"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ec666d23ca0f507e0940bcdf0b65848bceb1af30", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ec666d23ca0f507e0940bcdf0b65848bceb1af30", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ec666d23ca0f507e0940bcdf0b65848bceb1af30", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ec666d23ca0f507e0940bcdf0b65848bceb1af30/comments", "author": null, "committer": null, "parents": [{"sha": "c4817ba67ecd0e9c9ec8bb2771be05551f9ce195", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c4817ba67ecd0e9c9ec8bb2771be05551f9ce195", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c4817ba67ecd0e9c9ec8bb2771be05551f9ce195"}], "stats": {"total": 14, "additions": 13, "deletions": 1}, "files": [{"sha": "3938e7a569519052f70af786cb7d5452aa39fe1c", "filename": "gcc/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ec666d23ca0f507e0940bcdf0b65848bceb1af30/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ec666d23ca0f507e0940bcdf0b65848bceb1af30/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=ec666d23ca0f507e0940bcdf0b65848bceb1af30", "patch": "@@ -1,5 +1,8 @@\n 2004-09-07  Jan Hubicka  <jh@suse.cz>\n \n+\t* cse.c (fold_rtx):  Avoid building of\n+\t(CONST (MINUS (CONST_INT) (SYMBOL_REF)))\n+\n \t* tree-ssa-pre.c (grand_bitmap_obstack): New.\n \t(value_insert_into_set_bitmap, bitmap_set_new): Use the obstack.\n \t(init_pre): Initialize obstack."}, {"sha": "fb9632875561ccfebdb1d828df47bdd682a90135", "filename": "gcc/cse.c", "status": "modified", "additions": 10, "deletions": 1, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ec666d23ca0f507e0940bcdf0b65848bceb1af30/gcc%2Fcse.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ec666d23ca0f507e0940bcdf0b65848bceb1af30/gcc%2Fcse.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcse.c?ref=ec666d23ca0f507e0940bcdf0b65848bceb1af30", "patch": "@@ -3787,7 +3787,16 @@ fold_rtx (rtx x, rtx insn)\n \tnew = simplify_unary_operation (code, mode,\n \t\t\t\t\tconst_arg0 ? const_arg0 : folded_arg0,\n \t\t\t\t\tmode_arg0);\n-\tif (new != 0 && is_const)\n+\t/* NEG of PLUS could be converted into MINUS, but that causes\n+\t   expressions of the form\n+\t   (CONST (MINUS (CONST_INT) (SYMBOL_REF)))\n+\t   which many ports mistakenly treat as LEGITIMATE_CONSTANT_P.\n+\t   FIXME: those ports should be fixed.  */\n+\tif (new != 0 && is_const\n+\t    && GET_CODE (new) == PLUS\n+\t    && (GET_CODE (XEXP (new, 0)) == SYMBOL_REF\n+\t\t|| GET_CODE (XEXP (new, 0)) == LABEL_REF)\n+\t    && GET_CODE (XEXP (new, 1)) == CONST_INT)\n \t  new = gen_rtx_CONST (mode, new);\n       }\n       break;"}]}