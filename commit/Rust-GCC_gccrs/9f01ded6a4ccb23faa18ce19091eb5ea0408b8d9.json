{"sha": "9f01ded6a4ccb23faa18ce19091eb5ea0408b8d9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWYwMWRlZDZhNGNjYjIzZmFhMThjZTE5MDkxZWI1ZWEwNDA4YjhkOQ==", "commit": {"author": {"name": "Kriang Lerdsuwanakij", "email": "lerdsuwa@users.sourceforge.net", "date": "2003-05-11T10:06:39Z"}, "committer": {"name": "Kriang Lerdsuwanakij", "email": "lerdsuwa@gcc.gnu.org", "date": "2003-05-11T10:06:39Z"}, "message": "PR c++/10230, c++/10481\n\n\tPR c++/10230, c++/10481\n\t* semantics.c (finish_non_static_data_member): Handle when the\n\tnon-static member is not from a base of the current class type.\n\n\t* g++.dg/lookup/scoped5.C: New test.\n\nFrom-SVN: r66683", "tree": {"sha": "712300bb0224b77b61f835658679572e5ed34310", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/712300bb0224b77b61f835658679572e5ed34310"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9f01ded6a4ccb23faa18ce19091eb5ea0408b8d9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9f01ded6a4ccb23faa18ce19091eb5ea0408b8d9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9f01ded6a4ccb23faa18ce19091eb5ea0408b8d9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9f01ded6a4ccb23faa18ce19091eb5ea0408b8d9/comments", "author": null, "committer": null, "parents": [{"sha": "fcea74011f2d59f310379d393799c353b7c54293", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fcea74011f2d59f310379d393799c353b7c54293", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fcea74011f2d59f310379d393799c353b7c54293"}], "stats": {"total": 43, "additions": 41, "deletions": 2}, "files": [{"sha": "a11a50218b35315efb03913b824450284f14ecd2", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9f01ded6a4ccb23faa18ce19091eb5ea0408b8d9/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9f01ded6a4ccb23faa18ce19091eb5ea0408b8d9/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=9f01ded6a4ccb23faa18ce19091eb5ea0408b8d9", "patch": "@@ -1,3 +1,9 @@\n+2003-05-11  Kriang Lerdsuwanakij  <lerdsuwa@users.sourceforge.net>\n+\n+\tPR c++/10230, c++/10481\n+\t* semantics.c (finish_non_static_data_member): Handle when the\n+\tnon-static member is not from a base of the current class type.\n+\n 2003-05-11  Kriang Lerdsuwanakij  <lerdsuwa@users.sourceforge.net>\n \n \tPR c++/10552"}, {"sha": "ab6a75c7ddbca03d50afcd406023575ed29670df", "filename": "gcc/cp/semantics.c", "status": "modified", "additions": 11, "deletions": 2, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9f01ded6a4ccb23faa18ce19091eb5ea0408b8d9/gcc%2Fcp%2Fsemantics.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9f01ded6a4ccb23faa18ce19091eb5ea0408b8d9/gcc%2Fcp%2Fsemantics.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fsemantics.c?ref=9f01ded6a4ccb23faa18ce19091eb5ea0408b8d9", "patch": "@@ -1276,13 +1276,22 @@ finish_non_static_data_member (tree decl, tree qualifying_scope)\n       tree access_type = current_class_type;\n       tree object = current_class_ref;\n \n-      while (!DERIVED_FROM_P (context_for_name_lookup (decl), access_type))\n+      while (access_type\n+\t     && !DERIVED_FROM_P (context_for_name_lookup (decl), access_type))\n \t{\n \t  access_type = TYPE_CONTEXT (access_type);\n-\t  while (DECL_P (access_type))\n+\t  while (access_type && DECL_P (access_type))\n \t    access_type = DECL_CONTEXT (access_type);\n \t}\n \n+      if (!access_type)\n+\t{\n+\t  cp_error_at (\"object missing in reference to `%D'\",\n+\t\t       decl);\n+\t  error (\"from this location\");\n+\t  return error_mark_node;\n+\t}\n+\n       perform_or_defer_access_check (access_type, decl);\n \n       /* If the data member was named `C::M', convert `*this' to `C'"}, {"sha": "5f370555bf42be61e37edbf1d41d8620991cbb1d", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9f01ded6a4ccb23faa18ce19091eb5ea0408b8d9/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9f01ded6a4ccb23faa18ce19091eb5ea0408b8d9/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=9f01ded6a4ccb23faa18ce19091eb5ea0408b8d9", "patch": "@@ -1,3 +1,8 @@\n+2003-05-11  Kriang Lerdsuwanakij  <lerdsuwa@users.sourceforge.net>\n+\n+\tPR c++/10230, c++/10481\n+\t* g++.dg/lookup/scoped5.C: New test.\n+\n 2003-05-11  Kriang Lerdsuwanakij  <lerdsuwa@users.sourceforge.net>\n \n \tPR c++/10552"}, {"sha": "267bc601d38ad03ecf69ed9879758e7aa557a8bf", "filename": "gcc/testsuite/g++.dg/lookup/scoped5.C", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9f01ded6a4ccb23faa18ce19091eb5ea0408b8d9/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Fscoped5.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9f01ded6a4ccb23faa18ce19091eb5ea0408b8d9/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Fscoped5.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Fscoped5.C?ref=9f01ded6a4ccb23faa18ce19091eb5ea0408b8d9", "patch": "@@ -0,0 +1,19 @@\n+// { dg-do compile }\n+\n+// Origin: pepeaty@yahoo.com\n+\n+// PR c++/10230: ICE while determining if refered non-static member\n+// is from a base type of the current class.\n+\n+class A {\n+public:\n+  class B {\n+  public:\n+    int a;\t\t\t// { dg-error \"member of base\" }\n+  };\n+};\n+\n+class C {\n+public:\n+  void f(void) { sizeof(A::B::a); } // { dg-error \"this location\" }\n+};"}]}