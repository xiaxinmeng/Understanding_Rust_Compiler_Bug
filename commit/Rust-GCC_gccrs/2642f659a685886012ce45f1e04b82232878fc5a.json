{"sha": "2642f659a685886012ce45f1e04b82232878fc5a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjY0MmY2NTlhNjg1ODg2MDEyY2U0NWYxZTA0YjgyMjMyODc4ZmM1YQ==", "commit": {"author": {"name": "Jack Howarth", "email": "howarth@bromo.med.uc.edu", "date": "2010-08-17T13:22:28Z"}, "committer": {"name": "Iain Sandoe", "email": "iains@gcc.gnu.org", "date": "2010-08-17T13:22:28Z"}, "message": "gcc.c (spec_function): Add remove-outfile.\n\n\n2010-08-17  Jack Howarth <howarth@bromo.med.uc.edu>\n\n\t* gcc.c (spec_function): Add remove-outfile.\n\t(remove_outfile_spec_function): New function.\n\t* config/darwin.h (LINK_SPEC): Add removal of\n\t-ldl, -lm and -lpthread.\n\t* invoke.texi (replace-outfile): Document.\n\nFrom-SVN: r163305", "tree": {"sha": "bab5c0bd0898b585bfbdc2cef1cac677a2b6ad2f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/bab5c0bd0898b585bfbdc2cef1cac677a2b6ad2f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2642f659a685886012ce45f1e04b82232878fc5a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2642f659a685886012ce45f1e04b82232878fc5a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2642f659a685886012ce45f1e04b82232878fc5a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2642f659a685886012ce45f1e04b82232878fc5a/comments", "author": null, "committer": {"login": "iains", "id": 4039407, "node_id": "MDQ6VXNlcjQwMzk0MDc=", "avatar_url": "https://avatars.githubusercontent.com/u/4039407?v=4", "gravatar_id": "", "url": "https://api.github.com/users/iains", "html_url": "https://github.com/iains", "followers_url": "https://api.github.com/users/iains/followers", "following_url": "https://api.github.com/users/iains/following{/other_user}", "gists_url": "https://api.github.com/users/iains/gists{/gist_id}", "starred_url": "https://api.github.com/users/iains/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/iains/subscriptions", "organizations_url": "https://api.github.com/users/iains/orgs", "repos_url": "https://api.github.com/users/iains/repos", "events_url": "https://api.github.com/users/iains/events{/privacy}", "received_events_url": "https://api.github.com/users/iains/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a85615d28a72fcc16591d60d82f623feb3df7442", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a85615d28a72fcc16591d60d82f623feb3df7442", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a85615d28a72fcc16591d60d82f623feb3df7442"}], "stats": {"total": 43, "additions": 43, "deletions": 0}, "files": [{"sha": "ff72674c46b72d63d775a8adc0caa1c4e4423bc0", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2642f659a685886012ce45f1e04b82232878fc5a/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2642f659a685886012ce45f1e04b82232878fc5a/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=2642f659a685886012ce45f1e04b82232878fc5a", "patch": "@@ -1,3 +1,11 @@\n+2010-08-17  Jack Howarth <howarth@bromo.med.uc.edu>\n+\n+\t* gcc.c (spec_function): Add remove-outfile.\n+\t(remove_outfile_spec_function): New function.\n+\t* config/darwin.h (LINK_SPEC): Add removal of\n+\t-ldl, -lm and -lpthread.\n+\t* invoke.texi (replace-outfile): Document.\n+\n 2010-08-17  Uros Bizjak  <ubizjak@gmail.com>\n \n \tPR target/45296"}, {"sha": "c9354344e3b441991f1a764f10226c2dc177a18a", "filename": "gcc/config/darwin.h", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2642f659a685886012ce45f1e04b82232878fc5a/gcc%2Fconfig%2Fdarwin.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2642f659a685886012ce45f1e04b82232878fc5a/gcc%2Fconfig%2Fdarwin.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fdarwin.h?ref=2642f659a685886012ce45f1e04b82232878fc5a", "patch": "@@ -303,6 +303,9 @@ extern GTY(()) int darwin_ms_struct;\n    so put a * after their names so all of them get passed.  */\n #define LINK_SPEC  \\\n   \"%{static}%{!static:-dynamic} \\\n+   %:remove-outfile(-ldl) \\\n+   %:remove-outfile(-lm) \\\n+   %:remove-outfile(-lpthread) \\\n    %{fgnu-runtime: %{static|static-libgcc: \\\n                      %:replace-outfile(-lobjc libobjc-gnu.a%s); \\\n                     :%:replace-outfile(-lobjc -lobjc-gnu ) } }\\"}, {"sha": "b2d72d9a9d0b4fe4c99857f3fe3d33be3338be06", "filename": "gcc/doc/invoke.texi", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2642f659a685886012ce45f1e04b82232878fc5a/gcc%2Fdoc%2Finvoke.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2642f659a685886012ce45f1e04b82232878fc5a/gcc%2Fdoc%2Finvoke.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdoc%2Finvoke.texi?ref=2642f659a685886012ce45f1e04b82232878fc5a", "patch": "@@ -9629,6 +9629,15 @@ is a small example of its usage:\n %@{fgnu-runtime:%:replace-outfile(-lobjc -lobjc-gnu)@}\n @end smallexample\n \n+@item @code{remove-outfile}\n+The @code{remove-outfile} spec function takes one argument.  It looks for the\n+first argument in the outfiles array and removes it.  Here is a small example\n+its usage:\n+\n+@smallexample\n+%:remove-outfile(-lm)\n+@end smallexample\n+\n @item @code{print-asm-header}\n The @code{print-asm-header} function takes no arguments and simply\n prints a banner like:"}, {"sha": "a96d49785b2bb977774ffa3888e34c6a9c931bd0", "filename": "gcc/gcc.c", "status": "modified", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2642f659a685886012ce45f1e04b82232878fc5a/gcc%2Fgcc.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2642f659a685886012ce45f1e04b82232878fc5a/gcc%2Fgcc.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgcc.c?ref=2642f659a685886012ce45f1e04b82232878fc5a", "patch": "@@ -317,6 +317,7 @@ static const char *getenv_spec_function (int, const char **);\n static const char *if_exists_spec_function (int, const char **);\n static const char *if_exists_else_spec_function (int, const char **);\n static const char *replace_outfile_spec_function (int, const char **);\n+static const char *remove_outfile_spec_function (int, const char **);\n static const char *version_compare_spec_function (int, const char **);\n static const char *include_spec_function (int, const char **);\n static const char *find_file_spec_function (int, const char **);\n@@ -1615,6 +1616,7 @@ static const struct spec_function static_spec_functions[] =\n   { \"if-exists\",\t\tif_exists_spec_function },\n   { \"if-exists-else\",\t\tif_exists_else_spec_function },\n   { \"replace-outfile\",\t\treplace_outfile_spec_function },\n+  { \"remove-outfile\",\t\tremove_outfile_spec_function },\n   { \"version-compare\",\t\tversion_compare_spec_function },\n   { \"include\",\t\t\tinclude_spec_function },\n   { \"find-file\",\t\tfind_file_spec_function },\n@@ -8274,6 +8276,27 @@ replace_outfile_spec_function (int argc, const char **argv)\n   return NULL;\n }\n \n+/* remove-outfile built-in spec function.\n+ *\n+ *    This looks for the first argument in the outfiles array's name and\n+ *       removes it.  */\n+\n+static const char *\n+remove_outfile_spec_function (int argc, const char **argv)\n+{\n+  int i;\n+  /* Must have exactly one argument.  */\n+  if (argc != 1)\n+    abort ();\n+\n+  for (i = 0; i < n_infiles; i++)\n+    {\n+      if (outfiles[i] && !strcmp (outfiles[i], argv[0]))\n+        outfiles[i] = NULL;\n+    }\n+  return NULL;\n+}\n+\n /* Given two version numbers, compares the two numbers.\n    A version number must match the regular expression\n    ([1-9][0-9]*|0)(\\.([1-9][0-9]*|0))*"}]}