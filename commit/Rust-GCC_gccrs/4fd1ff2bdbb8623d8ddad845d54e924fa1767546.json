{"sha": "4fd1ff2bdbb8623d8ddad845d54e924fa1767546", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NGZkMWZmMmJkYmI4NjIzZDhkZGFkODQ1ZDU0ZTkyNGZhMTc2NzU0Ng==", "commit": {"author": {"name": "Matt Austern", "email": "austern@apple.com", "date": "2004-02-23T19:49:23Z"}, "committer": {"name": "Matt Austern", "email": "austern@gcc.gnu.org", "date": "2004-02-23T19:49:23Z"}, "message": "darwin.h (SUBTARGET_OPTIONS): Add -mmacosx= option.\n\n\t* config/darwin.h (SUBTARGET_OPTIONS): Add -mmacosx= option.\n\t(macosx_version_min_required): Declare global variable.\n\t* config/darwin-protos.h (darwin_parse_macosx_version_name): Declare.\n\t* config/darwin.c (macosx_version_min_required): Define variable.\n\t(darwin_macosx_vers_tbl): Define. Table mapping text strings of\n\tOS versions to numerical codes.\n\t(darwin_parse_macosx_version_name): Define.  Parse -mmacosx=,\n\tset macosx_version_min_required appropriately.\n\t* config/i386/darwin.h (SUBTARGET_OVERRIDE_OPTIONS): Define.\n\tInvoke darwin_parse_macosx_version_name.\n\t* config/rs6000/darwin.h (SUBTARGET_OVERRIDE_OPTIONS): Add\n\tdarwin_parse_macosx_version_name to Darwin option handling.\n\t* doc/invoke.texi (-mmacosx=): Document.\n\nFrom-SVN: r78329", "tree": {"sha": "ec0e8c8a55e2a939c639128d9ae80c15f5626f59", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ec0e8c8a55e2a939c639128d9ae80c15f5626f59"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4fd1ff2bdbb8623d8ddad845d54e924fa1767546", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4fd1ff2bdbb8623d8ddad845d54e924fa1767546", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4fd1ff2bdbb8623d8ddad845d54e924fa1767546", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4fd1ff2bdbb8623d8ddad845d54e924fa1767546/comments", "author": null, "committer": null, "parents": [{"sha": "6f94dea7854dac34ce80692eed3c9b24f8cb8912", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6f94dea7854dac34ce80692eed3c9b24f8cb8912", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6f94dea7854dac34ce80692eed3c9b24f8cb8912"}], "stats": {"total": 90, "additions": 88, "deletions": 2}, "files": [{"sha": "d41719211f891447b732419f7d5d3aca3c12497a", "filename": "gcc/ChangeLog", "status": "modified", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4fd1ff2bdbb8623d8ddad845d54e924fa1767546/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4fd1ff2bdbb8623d8ddad845d54e924fa1767546/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=4fd1ff2bdbb8623d8ddad845d54e924fa1767546", "patch": "@@ -1,3 +1,19 @@\n+2003-02-23  Matt Austern  <austern@apple.com >\n+\n+\t* config/darwin.h (SUBTARGET_OPTIONS): Add -mmacosx= option.\n+\t(macosx_version_min_required): Declare global variable.\n+\t* config/darwin-protos.h (darwin_parse_macosx_version_name): Declare.\n+\t* config/darwin.c (macosx_version_min_required): Define variable.\n+\t(darwin_macosx_vers_tbl): Define. Table mapping text strings of\n+\tOS versions to numerical codes.\n+\t(darwin_parse_macosx_version_name): Define.  Parse -mmacosx=,\n+\tset macosx_version_min_required appropriately.\n+\t* config/i386/darwin.h (SUBTARGET_OVERRIDE_OPTIONS): Define.\n+\tInvoke darwin_parse_macosx_version_name.\n+\t* config/rs6000/darwin.h (SUBTARGET_OVERRIDE_OPTIONS): Add\n+\tdarwin_parse_macosx_version_name to Darwin option handling.\n+\t* doc/invoke.texi (-mmacosx=): Document.\n+\t\n 2004-02-23  Dale Johannesen  <dalej@apple.com>\n \n \t* config/rs6000.md (movsf_hardfloat): Add POWER form of nop."}, {"sha": "1c432bf15a071f79f7fd2a77e185048ecf3c6015", "filename": "gcc/config/darwin-protos.h", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4fd1ff2bdbb8623d8ddad845d54e924fa1767546/gcc%2Fconfig%2Fdarwin-protos.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4fd1ff2bdbb8623d8ddad845d54e924fa1767546/gcc%2Fconfig%2Fdarwin-protos.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fdarwin-protos.h?ref=4fd1ff2bdbb8623d8ddad845d54e924fa1767546", "patch": "@@ -18,6 +18,8 @@ along with GCC; see the file COPYING.  If not, write to\n the Free Software Foundation, 59 Temple Place - Suite 330,\n Boston, MA 02111-1307, USA.  */\n \n+extern void darwin_parse_macosx_version_name (void);\n+\n extern int name_needs_quotes (const char *);\n \n extern void machopic_validate_stub_or_non_lazy_ptr (const char *, int);"}, {"sha": "fd5d8b6272da68cb5c76e42e9a0c254d3b3010a4", "filename": "gcc/config/darwin.c", "status": "modified", "additions": 42, "deletions": 0, "changes": 42, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4fd1ff2bdbb8623d8ddad845d54e924fa1767546/gcc%2Fconfig%2Fdarwin.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4fd1ff2bdbb8623d8ddad845d54e924fa1767546/gcc%2Fconfig%2Fdarwin.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fdarwin.c?ref=4fd1ff2bdbb8623d8ddad845d54e924fa1767546", "patch": "@@ -48,6 +48,48 @@ static void update_non_lazy_ptrs (const char *);\n static void update_stubs (const char *);\n static const char *machopic_non_lazy_ptr_name (const char*);\n \n+/* Earliest operating system for which generated code is targeted, as string\n+   and as integer.  The string form is \"10.0\", \"10.1\", etc.  The corresponding\n+   numeric versions are 1000, 1010, etc.  This number is used for feature \n+   tests of the form \"enable_this_feature = macosx_version_min_required >= n\",\n+   so 0 is a conservative default. */\n+\n+const char *darwin_macosx_version_name;\n+unsigned int macosx_version_min_required = 0;\n+\n+/* Parse -macosx= option. */\n+\n+static struct darwin_macosx_vers {\n+  const char *vers_str;\n+  unsigned int vers_num;\n+} darwin_macosx_vers_tbl[] = {\n+  { \"10.0\", 1000 },\n+  { \"10.1\", 1010 },\n+  { \"10.2\", 1020 },\n+  { \"jaguar\", 1020 },\n+  { \"10.3\", 1030 },\n+  { \"panther\", 1030 },\n+  { \"10.4\", 1040 },\n+  { \"10.5\", 1050 },\n+  { NULL, 0 }\n+};  \n+\n+void darwin_parse_macosx_version_name (void)\n+{\n+  if (darwin_macosx_version_name)\n+    {\n+      struct darwin_macosx_vers *v = darwin_macosx_vers_tbl;\n+      while (v->vers_str\n+\t     && strcmp (darwin_macosx_version_name, v->vers_str) != 0)\n+\tv++;\n+\n+      if (v->vers_str)\n+\tmacosx_version_min_required = v->vers_num;\n+      else\n+\twarning (\"-macosx=%s: unrecognized version\", darwin_macosx_version_name);\n+    }\n+}\n+\n int\n name_needs_quotes (const char *name)\n {"}, {"sha": "b3260fdded3d354a6226a7d97200b95a203f3d2e", "filename": "gcc/config/darwin.h", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4fd1ff2bdbb8623d8ddad845d54e924fa1767546/gcc%2Fconfig%2Fdarwin.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4fd1ff2bdbb8623d8ddad845d54e924fa1767546/gcc%2Fconfig%2Fdarwin.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fdarwin.h?ref=4fd1ff2bdbb8623d8ddad845d54e924fa1767546", "patch": "@@ -82,6 +82,19 @@ Boston, MA 02111-1307, USA.  */\n #undef\tDEFAULT_PCC_STRUCT_RETURN\n #define DEFAULT_PCC_STRUCT_RETURN 0\n \n+/* Strings provided by SUBTARGET_OPTIONS */\n+extern const char *darwin_macosx_version_name;\n+\n+/* Override rs6000.h/i386.h definition */\n+#undef SUBTARGET_OPTIONS\n+#define SUBTARGET_OPTIONS\t\t\t\t\t            \\\n+  { \"macosx=\", &darwin_macosx_version_name,\t\t    \\\n+      N_(\"Earliest operating system for which code should be generated\"), 0 }\n+\n+/* Earliest operating system for which generated code is targeted. 1000 for 10.0,\n+   1010 for 10.1, etc. */\n+extern unsigned int macosx_version_min_required;\n+\n /* This table intercepts weirdo options whose names would interfere\n    with normal driver conventions, and either translates them into\n    standardly-named options, or adds a 'Z' so that they can get to"}, {"sha": "23db7c00853892d6dda38228e4d8ecca754c7d2c", "filename": "gcc/config/i386/darwin.h", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4fd1ff2bdbb8623d8ddad845d54e924fa1767546/gcc%2Fconfig%2Fi386%2Fdarwin.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4fd1ff2bdbb8623d8ddad845d54e924fa1767546/gcc%2Fconfig%2Fi386%2Fdarwin.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fdarwin.h?ref=4fd1ff2bdbb8623d8ddad845d54e924fa1767546", "patch": "@@ -51,6 +51,11 @@ Boston, MA 02111-1307, USA.  */\n #define SUBTARGET_EXTRA_SPECS\t\t\t\\\n   { \"darwin_arch\", \"i386\" },\n \n+#define SUBTARGET_OVERRIDE_OPTIONS\t\t\t\t  \t\\\n+do {\t\t\t\t\t\t\t\t\t\\\n+  darwin_parse_macosx_version_name ();                                  \\\n+} while (0)\n+\n /* Use the following macro for any Darwin/x86-specific command-line option\n    translation.  */\n #define SUBTARGET_OPTION_TRANSLATE_TABLE"}, {"sha": "5b3abab3523d0a7d38ce2df9368891efa386b713", "filename": "gcc/config/rs6000/darwin.h", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4fd1ff2bdbb8623d8ddad845d54e924fa1767546/gcc%2Fconfig%2Frs6000%2Fdarwin.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4fd1ff2bdbb8623d8ddad845d54e924fa1767546/gcc%2Fconfig%2Frs6000%2Fdarwin.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Fdarwin.h?ref=4fd1ff2bdbb8623d8ddad845d54e924fa1767546", "patch": "@@ -87,7 +87,8 @@ do {\t\t\t\t\t\t\t\t\t\\\n         flag_pic = 2;\t\t\t\t\t\t\t\\\n       }\t\t\t\t\t\t\t\t\t\\\n   }\t\t\t\t\t\t\t\t\t\\\n-}while(0)\n+  darwin_parse_macosx_version_name ();                                  \\\n+} while (0)\n \n /* We want -fPIC by default, unless we're using -static to compile for\n    the kernel or some such.  */"}, {"sha": "3a062399a333247205e1e055b853b42ed58bcffb", "filename": "gcc/doc/invoke.texi", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4fd1ff2bdbb8623d8ddad845d54e924fa1767546/gcc%2Fdoc%2Finvoke.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4fd1ff2bdbb8623d8ddad845d54e924fa1767546/gcc%2Fdoc%2Finvoke.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdoc%2Finvoke.texi?ref=4fd1ff2bdbb8623d8ddad845d54e924fa1767546", "patch": "@@ -462,7 +462,7 @@ in the following sections.\n -single_module  -static  -sub_library  -sub_umbrella @gol\n -twolevel_namespace  -umbrella  -undefined @gol\n -unexported_symbols_list  -weak_reference_mismatches @gol\n--whatsloaded}\n+-whatsloaded -mmacosx=@var{ver}}\n \n @emph{MIPS Options}\n @gccoptlist{-EL  -EB  -march=@var{arch}  -mtune=@var{arch} @gol\n@@ -7590,6 +7590,13 @@ See man ld(1) for more information.\n This specifies the @var{executable} that will be loading the build\n output file being linked. See man ld(1) for more information.\n \n+@item -mmacosx=@var{ver}\n+@opindex mmacosx\n+This specifies the earliest version of Mac OS for which code should\n+be generated.  Specifying @code{-mmacosx=10.2}, for example, allows\n+the compiler to use features that were first made available in that\n+version of the operating system.\n+\n @item -allowable_client  @var{client_name}\n @itemx -arch_only\n "}]}