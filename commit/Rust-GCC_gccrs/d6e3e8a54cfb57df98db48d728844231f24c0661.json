{"sha": "d6e3e8a54cfb57df98db48d728844231f24c0661", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDZlM2U4YTU0Y2ZiNTdkZjk4ZGI0OGQ3Mjg4NDQyMzFmMjRjMDY2MQ==", "commit": {"author": {"name": "Marek Polacek", "email": "polacek@redhat.com", "date": "2017-04-18T09:38:55Z"}, "committer": {"name": "Marek Polacek", "email": "mpolacek@gcc.gnu.org", "date": "2017-04-18T09:38:55Z"}, "message": "PR c++/80241 - ICE with alignas pack expansion.\n\n\t* error.c (dump_expr): Handle TREE_LIST.\n\t* parser.c (cp_parser_std_attribute_list): Return error_mark if\n\tmake_pack_expansion returns an error.\n\n\t* g++.dg/cpp0x/alignas11.C: New test.\n\nFrom-SVN: r246963", "tree": {"sha": "3367d671ce30a920158423ae9001d9c05b16c377", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3367d671ce30a920158423ae9001d9c05b16c377"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d6e3e8a54cfb57df98db48d728844231f24c0661", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d6e3e8a54cfb57df98db48d728844231f24c0661", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d6e3e8a54cfb57df98db48d728844231f24c0661", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d6e3e8a54cfb57df98db48d728844231f24c0661/comments", "author": {"login": "mpolacek", "id": 10496300, "node_id": "MDQ6VXNlcjEwNDk2MzAw", "avatar_url": "https://avatars.githubusercontent.com/u/10496300?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mpolacek", "html_url": "https://github.com/mpolacek", "followers_url": "https://api.github.com/users/mpolacek/followers", "following_url": "https://api.github.com/users/mpolacek/following{/other_user}", "gists_url": "https://api.github.com/users/mpolacek/gists{/gist_id}", "starred_url": "https://api.github.com/users/mpolacek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mpolacek/subscriptions", "organizations_url": "https://api.github.com/users/mpolacek/orgs", "repos_url": "https://api.github.com/users/mpolacek/repos", "events_url": "https://api.github.com/users/mpolacek/events{/privacy}", "received_events_url": "https://api.github.com/users/mpolacek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "be7c73ae358319c5f9541f2e2f7a5dc37ec0e116", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/be7c73ae358319c5f9541f2e2f7a5dc37ec0e116", "html_url": "https://github.com/Rust-GCC/gccrs/commit/be7c73ae358319c5f9541f2e2f7a5dc37ec0e116"}], "stats": {"total": 30, "additions": 28, "deletions": 2}, "files": [{"sha": "6eac0ba0ca095450297a31a740151388a321142c", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d6e3e8a54cfb57df98db48d728844231f24c0661/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d6e3e8a54cfb57df98db48d728844231f24c0661/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=d6e3e8a54cfb57df98db48d728844231f24c0661", "patch": "@@ -3,6 +3,11 @@\n \tPR c++/80244 - ICE with attribute in template alias.\n \t* tree.c (strip_typedefs): Handle UNDERLYING_TYPE.\n \n+\tPR c++/80241 - ICE with alignas pack expansion.\n+\t* error.c (dump_expr): Handle TREE_LIST.\n+\t* parser.c (cp_parser_std_attribute_list): Return error_mark if\n+\tmake_pack_expansion returns an error.\n+\n 2017-04-17  Bernd Edlinger  <bernd.edlinger@hotmail.de>\n \n \tPR c++/80287"}, {"sha": "40a7eab4b9e0bc78201cb11f83b0ac6799e8bb7f", "filename": "gcc/cp/error.c", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d6e3e8a54cfb57df98db48d728844231f24c0661/gcc%2Fcp%2Ferror.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d6e3e8a54cfb57df98db48d728844231f24c0661/gcc%2Fcp%2Ferror.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ferror.c?ref=d6e3e8a54cfb57df98db48d728844231f24c0661", "patch": "@@ -2822,6 +2822,10 @@ dump_expr (cxx_pretty_printer *pp, tree t, int flags)\n       pp_string (pp, M_(\"*this\"));\n       break;\n \n+    case TREE_LIST:\n+      dump_expr_list (pp, t, flags);\n+      break;\n+\n       /*  This list is incomplete, but should suffice for now.\n \t  It is very important that `sorry' does not call\n \t  `report_error_function'.  That could cause an infinite loop.  */"}, {"sha": "5255e713a32495249985b3be94e6649964e722c5", "filename": "gcc/cp/parser.c", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d6e3e8a54cfb57df98db48d728844231f24c0661/gcc%2Fcp%2Fparser.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d6e3e8a54cfb57df98db48d728844231f24c0661/gcc%2Fcp%2Fparser.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fparser.c?ref=d6e3e8a54cfb57df98db48d728844231f24c0661", "patch": "@@ -24846,8 +24846,12 @@ cp_parser_std_attribute_list (cp_parser *parser, tree attr_ns)\n \t    error_at (token->location,\n \t\t      \"expected attribute before %<...%>\");\n \t  else\n-\t    TREE_VALUE (attribute)\n-\t      = make_pack_expansion (TREE_VALUE (attribute));\n+\t    {\n+\t      tree pack = make_pack_expansion (TREE_VALUE (attribute));\n+\t      if (pack == error_mark_node)\n+\t\treturn error_mark_node;\n+\t      TREE_VALUE (attribute) = pack;\n+\t    }\n \t  token = cp_lexer_peek_token (parser->lexer);\n \t}\n       if (token->type != CPP_COMMA)"}, {"sha": "db98764c62772cd8721f415985609fd45c164a1b", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d6e3e8a54cfb57df98db48d728844231f24c0661/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d6e3e8a54cfb57df98db48d728844231f24c0661/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=d6e3e8a54cfb57df98db48d728844231f24c0661", "patch": "@@ -3,6 +3,9 @@\n \tPR c++/80244 - ICE with attribute in template alias.\n \t* g++.dg/cpp0x/alias-decl-59.C: New test.\n \n+\tPR c++/80241 - ICE with alignas pack expansion.\n+\t* g++.dg/cpp0x/alignas11.C: New test.\n+\n 2017-04-17  Bernd Edlinger  <bernd.edlinger@hotmail.de>\n \n \tPR c++/80287"}, {"sha": "73c54da00f638dc04d2352931f2244a297e8e267", "filename": "gcc/testsuite/g++.dg/cpp0x/alignas11.C", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d6e3e8a54cfb57df98db48d728844231f24c0661/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Falignas11.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d6e3e8a54cfb57df98db48d728844231f24c0661/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Falignas11.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Falignas11.C?ref=d6e3e8a54cfb57df98db48d728844231f24c0661", "patch": "@@ -0,0 +1,10 @@\n+// PR c++/80241\n+// { dg-do compile { target c++11 } }\n+\n+template <typename... T>\n+struct A\n+{\n+  [[gnu::aligned (alignof(A))...]] char c; // { dg-error \"expansion pattern\" }\n+};\n+\n+A<int> a;"}]}