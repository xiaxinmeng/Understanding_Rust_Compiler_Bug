{"sha": "a983abd29c19a3bbfa39512d1622e92797f22521", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTk4M2FiZDI5YzE5YTNiYmZhMzk1MTJkMTYyMmU5Mjc5N2YyMjUyMQ==", "commit": {"author": {"name": "Paolo Carlini", "email": "paolo.carlini@oracle.com", "date": "2015-06-02T10:28:14Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2015-06-02T10:28:14Z"}, "message": "re PR c++/61683 (decltype-specifier not accepted as mem-initializer-id)\n\n/cp\n2015-06-02  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/61683\n\t* parser.c (cp_parser_mem_initializer): Allow for decltype-specifier.\n\n/testsuite\n2015-06-02  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/61683\n\t* g++.dg/cpp0x/decltype-mem-initializer1.C: New.\n\nFrom-SVN: r224022", "tree": {"sha": "32089317911fe9b254dfcde2e5f988dd15e605cd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/32089317911fe9b254dfcde2e5f988dd15e605cd"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a983abd29c19a3bbfa39512d1622e92797f22521", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a983abd29c19a3bbfa39512d1622e92797f22521", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a983abd29c19a3bbfa39512d1622e92797f22521", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a983abd29c19a3bbfa39512d1622e92797f22521/comments", "author": null, "committer": null, "parents": [{"sha": "b4147b63ad2d8dace41f33d62ac341b7c64ae905", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b4147b63ad2d8dace41f33d62ac341b7c64ae905", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b4147b63ad2d8dace41f33d62ac341b7c64ae905"}], "stats": {"total": 45, "additions": 34, "deletions": 11}, "files": [{"sha": "c6f1a6d2282f3256c51add1c1f0ab56cbd7bc0e6", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a983abd29c19a3bbfa39512d1622e92797f22521/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a983abd29c19a3bbfa39512d1622e92797f22521/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=a983abd29c19a3bbfa39512d1622e92797f22521", "patch": "@@ -1,3 +1,8 @@\n+2015-06-02  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/61683\n+\t* parser.c (cp_parser_mem_initializer): Allow for decltype-specifier.\n+\n 2015-06-01  Jason Merrill  <jason@redhat.com>\n \n \tPR c++/65942"}, {"sha": "9ae555c1354a93caa6901ac6d23225b9cce2951b", "filename": "gcc/cp/parser.c", "status": "modified", "additions": 16, "deletions": 11, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a983abd29c19a3bbfa39512d1622e92797f22521/gcc%2Fcp%2Fparser.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a983abd29c19a3bbfa39512d1622e92797f22521/gcc%2Fcp%2Fparser.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fparser.c?ref=a983abd29c19a3bbfa39512d1622e92797f22521", "patch": "@@ -12803,11 +12803,12 @@ cp_parser_mem_initializer (cp_parser* parser)\n \n    mem-initializer-id:\n      :: [opt] nested-name-specifier [opt] class-name\n+     decltype-specifier (C++11)\n      identifier\n \n-   Returns a TYPE indicating the class to be initializer for the first\n-   production.  Returns an IDENTIFIER_NODE indicating the data member\n-   to be initialized for the second production.  */\n+   Returns a TYPE indicating the class to be initialized for the first\n+   production (and the second in C++11).  Returns an IDENTIFIER_NODE\n+   indicating the data member to be initialized for the last production.  */\n \n static tree\n cp_parser_mem_initializer_id (cp_parser* parser)\n@@ -12865,14 +12866,18 @@ cp_parser_mem_initializer_id (cp_parser* parser)\n \t\t\t\t /*is_declaration=*/true);\n   /* Otherwise, we could also be looking for an ordinary identifier.  */\n   cp_parser_parse_tentatively (parser);\n-  /* Try a class-name.  */\n-  id = cp_parser_class_name (parser,\n-\t\t\t     /*typename_keyword_p=*/true,\n-\t\t\t     /*template_keyword_p=*/false,\n-\t\t\t     none_type,\n-\t\t\t     /*check_dependency_p=*/true,\n-\t\t\t     /*class_head_p=*/false,\n-\t\t\t     /*is_declaration=*/true);\n+  if (cp_lexer_next_token_is_decltype (parser->lexer))\n+    /* Try a decltype-specifier.  */\n+    id = cp_parser_decltype (parser);\n+  else\n+    /* Otherwise, try a class-name.  */\n+    id = cp_parser_class_name (parser,\n+\t\t\t       /*typename_keyword_p=*/true,\n+\t\t\t       /*template_keyword_p=*/false,\n+\t\t\t       none_type,\n+\t\t\t       /*check_dependency_p=*/true,\n+\t\t\t       /*class_head_p=*/false,\n+\t\t\t       /*is_declaration=*/true);\n   /* If we found one, we're done.  */\n   if (cp_parser_parse_definitely (parser))\n     return id;"}, {"sha": "2ea81dd1bba712d05cbbd1bc1b0cb6ff661c622a", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a983abd29c19a3bbfa39512d1622e92797f22521/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a983abd29c19a3bbfa39512d1622e92797f22521/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=a983abd29c19a3bbfa39512d1622e92797f22521", "patch": "@@ -1,3 +1,8 @@\n+2015-06-02  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/61683\n+\t* g++.dg/cpp0x/decltype-mem-initializer1.C: New.\n+\n 2015-06-02  Bin Cheng  <bin.cheng@arm.com>\n \n \tPR tree-optimization/48052"}, {"sha": "d036b2929f9e3d497c13977330de407e1fbca3dd", "filename": "gcc/testsuite/g++.dg/cpp0x/decltype-mem-initializer1.C", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a983abd29c19a3bbfa39512d1622e92797f22521/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fdecltype-mem-initializer1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a983abd29c19a3bbfa39512d1622e92797f22521/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fdecltype-mem-initializer1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fdecltype-mem-initializer1.C?ref=a983abd29c19a3bbfa39512d1622e92797f22521", "patch": "@@ -0,0 +1,8 @@\n+// PR c++/61683\n+// { dg-do compile { target c++11 } }\n+\n+struct A {};\n+A a;\n+struct B : A {\n+  B(): decltype(a)() {}\n+};"}]}