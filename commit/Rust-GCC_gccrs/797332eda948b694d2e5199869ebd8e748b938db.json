{"sha": "797332eda948b694d2e5199869ebd8e748b938db", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Nzk3MzMyZWRhOTQ4YjY5NGQyZTUxOTk4NjllYmQ4ZTc0OGI5MzhkYg==", "commit": {"author": {"name": "Jerry DeLisle", "email": "jvdelisle@gcc.gnu.org", "date": "2012-12-27T18:07:33Z"}, "committer": {"name": "Jerry DeLisle", "email": "jvdelisle@gcc.gnu.org", "date": "2012-12-27T18:07:33Z"}, "message": "re PR fortran/48976 (INQUIRE with STREAM= not supported)\n\n2012-12-27  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n\n\tPR libfortran/48976\n\t* io/inquire.c (inquire_via_unit): Set user stream inquiry variable to\n\tappropriate value based on unit access method. (inquire_via_filename):\n\tSince filename is not associated with an open unit, set stream inquiry\n\tto UNKNOWN.\n\t* io/io.h: Define inquire stream parameters.\n\nFrom-SVN: r194733", "tree": {"sha": "637fd85a9c4a23ec552c1929931db6848d597935", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/637fd85a9c4a23ec552c1929931db6848d597935"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/797332eda948b694d2e5199869ebd8e748b938db", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/797332eda948b694d2e5199869ebd8e748b938db", "html_url": "https://github.com/Rust-GCC/gccrs/commit/797332eda948b694d2e5199869ebd8e748b938db", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/797332eda948b694d2e5199869ebd8e748b938db/comments", "author": null, "committer": null, "parents": [{"sha": "53b0dee13562d7e267c108d7d13580ad6b2b74fe", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/53b0dee13562d7e267c108d7d13580ad6b2b74fe", "html_url": "https://github.com/Rust-GCC/gccrs/commit/53b0dee13562d7e267c108d7d13580ad6b2b74fe"}], "stats": {"total": 35, "additions": 35, "deletions": 0}, "files": [{"sha": "fa651f9264c4c3c3c07fcaf71dae125510efc29e", "filename": "libgfortran/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/797332eda948b694d2e5199869ebd8e748b938db/libgfortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/797332eda948b694d2e5199869ebd8e748b938db/libgfortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2FChangeLog?ref=797332eda948b694d2e5199869ebd8e748b938db", "patch": "@@ -1,3 +1,12 @@\n+2012-12-27  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n+\n+\tPR libfortran/48976\n+\t* io/inquire.c (inquire_via_unit): Set user stream inquiry variable to\n+\tappropriate value based on unit access method. (inquire_via_filename):\n+\tSince filename is not associated with an open unit, set stream inquiry\n+\tto UNKNOWN.\n+\t* io/io.h: Define inquire stream parameters.\n+\n 2012-12-26  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n \n \tPR libfortran/48960"}, {"sha": "6dd003c01aa002439738062eb8fb44849260b9bd", "filename": "libgfortran/io/inquire.c", "status": "modified", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/797332eda948b694d2e5199869ebd8e748b938db/libgfortran%2Fio%2Finquire.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/797332eda948b694d2e5199869ebd8e748b938db/libgfortran%2Fio%2Finquire.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fio%2Finquire.c?ref=797332eda948b694d2e5199869ebd8e748b938db", "patch": "@@ -414,6 +414,27 @@ inquire_via_unit (st_parameter_inquire *iqp, gfc_unit * u)\n \t      *iqp->size = ssize (u->s);\n \t    }\n \t}\n+\n+      if ((cf2 & IOPARM_INQUIRE_HAS_IQSTREAM) != 0)\n+\t{\n+\t  if (u == NULL)\n+\t    p = \"UNKNOWN\";\n+\t  else\n+\t    switch (u->flags.access)\n+\t      {\n+\t      case ACCESS_SEQUENTIAL:\n+\t      case ACCESS_DIRECT:\n+\t\tp = \"NO\";\n+\t\tbreak;\n+\t      case ACCESS_STREAM:\n+\t\tp = \"YES\";\n+\t\tbreak;\n+\t      default:\n+\t\tinternal_error (&iqp->common, \"inquire_via_unit(): Bad pad\");\n+\t      }\n+    \n+\t  cf_strcpy (iqp->iqstream, iqp->iqstream_len, p);\n+\t}\n     }\n \n   if ((cf & IOPARM_INQUIRE_HAS_POSITION) != 0)\n@@ -659,6 +680,9 @@ inquire_via_filename (st_parameter_inquire *iqp)\n \n       if ((cf2 & IOPARM_INQUIRE_HAS_SIZE) != 0)\n \t*iqp->size = file_size (iqp->file, iqp->file_len);\n+\n+      if ((cf2 & IOPARM_INQUIRE_HAS_IQSTREAM) != 0)\n+\tcf_strcpy (iqp->iqstream, iqp->iqstream_len, \"UNKNOWN\");\n     }\n \n   if ((cf & IOPARM_INQUIRE_HAS_POSITION) != 0)"}, {"sha": "43aeafd2e635c87a52edae1177ca7c0f2338f5fc", "filename": "libgfortran/io/io.h", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/797332eda948b694d2e5199869ebd8e748b938db/libgfortran%2Fio%2Fio.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/797332eda948b694d2e5199869ebd8e748b938db/libgfortran%2Fio%2Fio.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fio%2Fio.h?ref=797332eda948b694d2e5199869ebd8e748b938db", "patch": "@@ -293,6 +293,7 @@ st_parameter_filepos;\n #define IOPARM_INQUIRE_HAS_PENDING\t(1 << 5)\n #define IOPARM_INQUIRE_HAS_SIZE\t\t(1 << 6)\n #define IOPARM_INQUIRE_HAS_ID\t\t(1 << 7)\n+#define IOPARM_INQUIRE_HAS_IQSTREAM\t(1 << 8)\n \n typedef struct\n {\n@@ -326,6 +327,7 @@ typedef struct\n   GFC_INTEGER_4 *pending;\n   GFC_IO_INT *size;\n   GFC_INTEGER_4 *id;\n+  CHARACTER1 (iqstream);\n }\n st_parameter_inquire;\n "}]}