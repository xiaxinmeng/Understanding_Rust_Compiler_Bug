{"sha": "83b14b884703a989f1ac97df97588fddbc979c5a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODNiMTRiODg0NzAzYTk4OWYxYWM5N2RmOTc1ODhmZGRiYzk3OWM1YQ==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@redhat.com", "date": "2002-06-18T16:05:31Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "2002-06-18T16:05:31Z"}, "message": "C++ ABI changes.\n\n        * class.c (build_base_field): Set DECL_PACKED.\n        (layout_class_type): Don't use tail padding of PODs.\n        * mangle.c (write_unqualified_name): Fix template conversion op\n        mangling.\n\nFrom-SVN: r54747", "tree": {"sha": "98c55d8452bda03001636a7d267a1f324d91b761", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/98c55d8452bda03001636a7d267a1f324d91b761"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/83b14b884703a989f1ac97df97588fddbc979c5a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/83b14b884703a989f1ac97df97588fddbc979c5a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/83b14b884703a989f1ac97df97588fddbc979c5a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/83b14b884703a989f1ac97df97588fddbc979c5a/comments", "author": {"login": "jicama", "id": 266146, "node_id": "MDQ6VXNlcjI2NjE0Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/266146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jicama", "html_url": "https://github.com/jicama", "followers_url": "https://api.github.com/users/jicama/followers", "following_url": "https://api.github.com/users/jicama/following{/other_user}", "gists_url": "https://api.github.com/users/jicama/gists{/gist_id}", "starred_url": "https://api.github.com/users/jicama/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jicama/subscriptions", "organizations_url": "https://api.github.com/users/jicama/orgs", "repos_url": "https://api.github.com/users/jicama/repos", "events_url": "https://api.github.com/users/jicama/events{/privacy}", "received_events_url": "https://api.github.com/users/jicama/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "3831381763ca5f41d6f7406d590e1e38a8531e1c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3831381763ca5f41d6f7406d590e1e38a8531e1c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3831381763ca5f41d6f7406d590e1e38a8531e1c"}], "stats": {"total": 27, "additions": 26, "deletions": 1}, "files": [{"sha": "21ced62e840832edd0cbdb7b99cbad9a0e66c9d5", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/83b14b884703a989f1ac97df97588fddbc979c5a/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/83b14b884703a989f1ac97df97588fddbc979c5a/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=83b14b884703a989f1ac97df97588fddbc979c5a", "patch": "@@ -1,3 +1,11 @@\n+2002-06-14  Jason Merrill  <jason@redhat.com>\n+\n+\tC++ ABI changes.\n+\t* class.c (build_base_field): Set DECL_PACKED.\n+\t(layout_class_type): Don't use tail padding of PODs.\n+\t* mangle.c (write_unqualified_name): Fix template conversion op\n+\tmangling.\n+\n 2002-06-16  Richard Henderson  <rth@redhat.com>\n \n \tPR opt/6793"}, {"sha": "09a03857afeea6d8c4efbb4f8d85544aced72d21", "filename": "gcc/cp/class.c", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/83b14b884703a989f1ac97df97588fddbc979c5a/gcc%2Fcp%2Fclass.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/83b14b884703a989f1ac97df97588fddbc979c5a/gcc%2Fcp%2Fclass.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fclass.c?ref=83b14b884703a989f1ac97df97588fddbc979c5a", "patch": "@@ -3837,6 +3837,8 @@ build_base_field (rli, binfo, empty_p, offsets, t)\n   DECL_SIZE_UNIT (decl) = CLASSTYPE_SIZE_UNIT (basetype);\n   DECL_ALIGN (decl) = CLASSTYPE_ALIGN (basetype);\n   DECL_USER_ALIGN (decl) = CLASSTYPE_USER_ALIGN (basetype);\n+  /* Tell the backend not to round up to TYPE_ALIGN.  */\n+  DECL_PACKED (decl) = 1;\n   \n   if (!integer_zerop (DECL_SIZE (decl)))\n     {\n@@ -4978,6 +4980,12 @@ layout_class_type (t, empty_p, vfuns_p,\n       CLASSTYPE_SIZE (t) = bitsize_zero_node;\n       CLASSTYPE_SIZE_UNIT (t) = size_zero_node;\n     }\n+  /* If this is a POD, we can't reuse its tail padding.  */\n+  else if (!CLASSTYPE_NON_POD_P (t))\n+    {\n+      CLASSTYPE_SIZE (t) = TYPE_SIZE (t);\n+      CLASSTYPE_SIZE_UNIT (t) = TYPE_SIZE_UNIT (t);\n+    }\n   else\n     {\n       CLASSTYPE_SIZE (t) = TYPE_BINFO_SIZE (t);"}, {"sha": "996b0272d7318d8bfbb1caf2543037594cf544b4", "filename": "gcc/cp/mangle.c", "status": "modified", "additions": 10, "deletions": 1, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/83b14b884703a989f1ac97df97588fddbc979c5a/gcc%2Fcp%2Fmangle.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/83b14b884703a989f1ac97df97588fddbc979c5a/gcc%2Fcp%2Fmangle.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fmangle.c?ref=83b14b884703a989f1ac97df97588fddbc979c5a", "patch": "@@ -988,8 +988,17 @@ write_unqualified_name (decl)\n     {\n       /* Conversion operator. Handle it right here.  \n            <operator> ::= cv <type>  */\n+      tree type;\n+      if (decl_is_template_id (decl, NULL))\n+\t{\n+\t  tree fn_type = get_mostly_instantiated_function_type (decl, NULL,\n+\t\t\t\t\t\t\t\tNULL);\n+\t  type = TREE_TYPE (fn_type);\n+\t}\n+      else\n+\ttype = TREE_TYPE (DECL_NAME (decl));\n       write_string (\"cv\");\n-      write_type (TREE_TYPE (DECL_NAME (decl)));\n+      write_type (type);\n     }\n   else if (DECL_OVERLOADED_OPERATOR_P (decl))\n     {"}]}