{"sha": "c58e8676dd02e78d29512ff0f0b024ce91c62883", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzU4ZTg2NzZkZDAyZTc4ZDI5NTEyZmYwZjBiMDI0Y2U5MWM2Mjg4Mw==", "commit": {"author": {"name": "Volker Reichelt", "email": "reichelt@igpm.rwth-aachen.de", "date": "2006-08-16T20:50:18Z"}, "committer": {"name": "Volker Reichelt", "email": "reichelt@gcc.gnu.org", "date": "2006-08-16T20:50:18Z"}, "message": "re PR c/27489 (ICE on broken switch condition)\n\n\tPR c/27489\n\t* c-typeck.c (c_start_case): Handle invalid orig_type correctly.\n\tClean up.\n\nFrom-SVN: r116188", "tree": {"sha": "2ec2140ed04b65b2da1c049493d675e61c629492", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2ec2140ed04b65b2da1c049493d675e61c629492"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c58e8676dd02e78d29512ff0f0b024ce91c62883", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c58e8676dd02e78d29512ff0f0b024ce91c62883", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c58e8676dd02e78d29512ff0f0b024ce91c62883", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c58e8676dd02e78d29512ff0f0b024ce91c62883/comments", "author": null, "committer": null, "parents": [{"sha": "e8c96d09013bbef59b28613a4982bc499a1073a7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e8c96d09013bbef59b28613a4982bc499a1073a7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e8c96d09013bbef59b28613a4982bc499a1073a7"}], "stats": {"total": 23, "additions": 14, "deletions": 9}, "files": [{"sha": "aa17eb1d404397b29ddaafd954cd12f549d2ea8c", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c58e8676dd02e78d29512ff0f0b024ce91c62883/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c58e8676dd02e78d29512ff0f0b024ce91c62883/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=c58e8676dd02e78d29512ff0f0b024ce91c62883", "patch": "@@ -1,3 +1,9 @@\n+2006-08-16  Volker Reichelt  <reichelt@igpm.rwth-aachen.de>\n+\n+\tPR c/27489\n+\t* c-typeck.c (c_start_case): Handle invalid orig_type correctly.\n+\tClean up.\n+\n 2006-08-16  Mike Stump  <mrs@apple.com>\n \n \t* doc/invoke.texi (-Wno-deprecated-declarations): Fixup use of pxref."}, {"sha": "2fbd89f5c2db695dc284bccaa734848bff0f5f6b", "filename": "gcc/c-typeck.c", "status": "modified", "additions": 8, "deletions": 9, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c58e8676dd02e78d29512ff0f0b024ce91c62883/gcc%2Fc-typeck.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c58e8676dd02e78d29512ff0f0b024ce91c62883/gcc%2Fc-typeck.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-typeck.c?ref=c58e8676dd02e78d29512ff0f0b024ce91c62883", "patch": "@@ -7064,25 +7064,25 @@ struct c_switch *c_switch_stack;\n tree\n c_start_case (tree exp)\n {\n-  enum tree_code code;\n-  tree type, orig_type = error_mark_node;\n+  tree orig_type = error_mark_node;\n   struct c_switch *cs;\n \n   if (exp != error_mark_node)\n     {\n-      code = TREE_CODE (TREE_TYPE (exp));\n       orig_type = TREE_TYPE (exp);\n \n-      if (!INTEGRAL_TYPE_P (orig_type)\n-\t  && code != ERROR_MARK)\n+      if (!INTEGRAL_TYPE_P (orig_type))\n \t{\n-\t  error (\"switch quantity not an integer\");\n+\t  if (orig_type != error_mark_node)\n+\t    {\n+\t      error (\"switch quantity not an integer\");\n+\t      orig_type = error_mark_node;\n+\t    }\n \t  exp = integer_zero_node;\n-\t  orig_type = error_mark_node;\n \t}\n       else\n \t{\n-\t  type = TYPE_MAIN_VARIANT (TREE_TYPE (exp));\n+\t  tree type = TYPE_MAIN_VARIANT (orig_type);\n \n \t  if (!in_system_header\n \t      && (type == long_integer_type_node\n@@ -7091,7 +7091,6 @@ c_start_case (tree exp)\n \t\t     \"converted to %<int%> in ISO C\");\n \n \t  exp = default_conversion (exp);\n-\t  type = TREE_TYPE (exp);\n \t}\n     }\n "}]}