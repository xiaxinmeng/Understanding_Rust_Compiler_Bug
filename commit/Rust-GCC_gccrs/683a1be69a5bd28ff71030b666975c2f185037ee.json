{"sha": "683a1be69a5bd28ff71030b666975c2f185037ee", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjgzYTFiZTY5YTViZDI4ZmY3MTAzMGI2NjY5NzVjMmYxODUwMzdlZQ==", "commit": {"author": {"name": "DJ Delorie", "email": "dj@redhat.com", "date": "2009-07-27T20:31:04Z"}, "committer": {"name": "DJ Delorie", "email": "dj@gcc.gnu.org", "date": "2009-07-27T20:31:04Z"}, "message": "mep.c (mep_expand_builtin_saveregs): Make sure 64-bit types are dword-aligned.\n\n* config/mep/mep.c (mep_expand_builtin_saveregs): Make sure 64-bit\ntypes are dword-aligned.\n(mep_expand_va_start): Likewise.\n\nFrom-SVN: r150136", "tree": {"sha": "4b7f4b48e7940765fa39709396ab0ec6b794e744", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4b7f4b48e7940765fa39709396ab0ec6b794e744"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/683a1be69a5bd28ff71030b666975c2f185037ee", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/683a1be69a5bd28ff71030b666975c2f185037ee", "html_url": "https://github.com/Rust-GCC/gccrs/commit/683a1be69a5bd28ff71030b666975c2f185037ee", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/683a1be69a5bd28ff71030b666975c2f185037ee/comments", "author": null, "committer": null, "parents": [{"sha": "a348618dae884974ebfbf4ddb746100fed4dba6b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a348618dae884974ebfbf4ddb746100fed4dba6b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a348618dae884974ebfbf4ddb746100fed4dba6b"}], "stats": {"total": 24, "additions": 20, "deletions": 4}, "files": [{"sha": "a20aed1230e14d6629b1cdbaf6209e3885801e89", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/683a1be69a5bd28ff71030b666975c2f185037ee/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/683a1be69a5bd28ff71030b666975c2f185037ee/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=683a1be69a5bd28ff71030b666975c2f185037ee", "patch": "@@ -1,3 +1,9 @@\n+2009-07-27  DJ Delorie  <dj@redhat.com>\n+\n+\t* config/mep/mep.c (mep_expand_builtin_saveregs): Make sure 64-bit\n+\ttypes are dword-aligned.\n+\t(mep_expand_va_start): Likewise.\n+\n 2009-07-27  Olivier Hainque  <hainque@adacore.com>\n             Douglas B Rupp  <rupp@gnat.com>\n "}, {"sha": "e237c4741991863873a668dbfa0af1ed8eb9476b", "filename": "gcc/config/mep/mep.c", "status": "modified", "additions": 14, "deletions": 4, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/683a1be69a5bd28ff71030b666975c2f185037ee/gcc%2Fconfig%2Fmep%2Fmep.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/683a1be69a5bd28ff71030b666975c2f185037ee/gcc%2Fconfig%2Fmep%2Fmep.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmep%2Fmep.c?ref=683a1be69a5bd28ff71030b666975c2f185037ee", "patch": "@@ -3530,15 +3530,23 @@ mep_expand_builtin_saveregs (void)\n   rtx regbuf;\n \n   ns = cfun->machine->arg_regs_to_save;\n-  bufsize = ns * (TARGET_IVC2 ? 12 : 4);\n-  regbuf = assign_stack_local (SImode, bufsize, 32);\n+  if (TARGET_IVC2)\n+    {\n+      bufsize = 8 * ((ns + 1) / 2) + 8 * ns;\n+      regbuf = assign_stack_local (SImode, bufsize, 64);\n+    }\n+  else\n+    {\n+      bufsize = ns * 4;\n+      regbuf = assign_stack_local (SImode, bufsize, 32);\n+    }\n \n   move_block_from_reg (5-ns, regbuf, ns);\n \n   if (TARGET_IVC2)\n     {\n       rtx tmp = gen_rtx_MEM (DImode, XEXP (regbuf, 0));\n-      int ofs = 4 * ns;\n+      int ofs = 8 * ((ns+1)/2);\n \n       for (i=0; i<ns; i++)\n \t{\n@@ -3627,7 +3635,9 @@ mep_expand_va_start (tree valist, rtx nextarg)\n   TREE_SIDE_EFFECTS (t) = 1;\n   expand_expr (t, const0_rtx, VOIDmode, EXPAND_NORMAL);\n \n-  /* va_list.next_cop = va_list.next_gp_limit; */\n+  u = fold_build2 (POINTER_PLUS_EXPR, ptr_type_node, u,\n+\t\t   size_int (8 * ((ns+1)/2)));\n+  /* va_list.next_cop = ROUND_UP(va_list.next_gp_limit,8); */\n   t = build2 (MODIFY_EXPR, ptr_type_node, next_cop, u);\n   TREE_SIDE_EFFECTS (t) = 1;\n   expand_expr (t, const0_rtx, VOIDmode, EXPAND_NORMAL);"}]}