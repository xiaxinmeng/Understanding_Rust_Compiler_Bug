{"sha": "ebef4d30443353b9cf4b2b559b2429273b60065b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWJlZjRkMzA0NDMzNTNiOWNmNGIyYjU1OWIyNDI5MjczYjYwMDY1Yg==", "commit": {"author": {"name": "James A. Morrison", "email": "phython@gcc.gnu.org", "date": "2004-12-21T17:07:06Z"}, "committer": {"name": "James A. Morrison", "email": "phython@gcc.gnu.org", "date": "2004-12-21T17:07:06Z"}, "message": "re PR c/18963 (static and nested declarations cause an ice)\n\n2004-12-21  James A. Morrison  <phython@gcc.gnu.org>\n\n       PR c/18963\n       * c-decl.c (pushdecl): Remove block trying to merge static function\n       declarations at block scope to file scope declarations.\n\ntestsuite:\n        PR c/18963\n        * gcc.dg/pr18963-1.c: New test.\n\nFrom-SVN: r92460", "tree": {"sha": "0add9045f20f4db5dba3f2c3bb1fec81d63bfa1f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0add9045f20f4db5dba3f2c3bb1fec81d63bfa1f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ebef4d30443353b9cf4b2b559b2429273b60065b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ebef4d30443353b9cf4b2b559b2429273b60065b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ebef4d30443353b9cf4b2b559b2429273b60065b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ebef4d30443353b9cf4b2b559b2429273b60065b/comments", "author": null, "committer": null, "parents": [{"sha": "6f17bbcf0518928c510fcc8c7bbb48c0ec21a8f3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6f17bbcf0518928c510fcc8c7bbb48c0ec21a8f3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6f17bbcf0518928c510fcc8c7bbb48c0ec21a8f3"}], "stats": {"total": 64, "additions": 40, "deletions": 24}, "files": [{"sha": "71a1525bc42088e108197e1b051d83056a98c556", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ebef4d30443353b9cf4b2b559b2429273b60065b/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ebef4d30443353b9cf4b2b559b2429273b60065b/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=ebef4d30443353b9cf4b2b559b2429273b60065b", "patch": "@@ -1,3 +1,9 @@\n+2004-12-21  James A. Morrison  <phython@gcc.gnu.org>\n+\n+\tPR c/18963\n+\t* c-decl.c (pushdecl): Remove block trying to merge static function\n+\tdeclarations at block scope to file scope declarations.\n+\n 2004-12-21  James A. Morrison  <phython@gcc.gnu.org>\n \n \tPR c/18596"}, {"sha": "975e281b5cf3291c952a6d6b002f90b5bfb89490", "filename": "gcc/c-decl.c", "status": "modified", "additions": 0, "deletions": 24, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ebef4d30443353b9cf4b2b559b2429273b60065b/gcc%2Fc-decl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ebef4d30443353b9cf4b2b559b2429273b60065b/gcc%2Fc-decl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-decl.c?ref=ebef4d30443353b9cf4b2b559b2429273b60065b", "patch": "@@ -2069,30 +2069,6 @@ pushdecl (tree x)\n \t    }\n \t}\n     }\n-  /* Similarly, a declaration of a function with static linkage at\n-     block scope must be checked against any existing declaration\n-     of that function at file scope.  */\n-  else if (TREE_CODE (x) == FUNCTION_DECL && scope != file_scope\n-\t   && !TREE_PUBLIC (x) && !DECL_INITIAL (x))\n-    {\n-      if (warn_nested_externs && !DECL_IN_SYSTEM_HEADER (x))\n-\twarning (\"nested static declaration of %qD\", x);\n-\n-      while (b && !B_IN_FILE_SCOPE (b))\n-\tb = b->shadowed;\n-\n-      if (b && same_translation_unit_p (x, b->decl)\n-\t  && duplicate_decls (x, b->decl))\n-\t{\n-\t  bind (name, b->decl, scope, /*invisible=*/false, /*nested=*/true);\n-\t  return b->decl;\n-\t}\n-      else\n-\t{\n-\t  bind (name, x, file_scope, /*invisible=*/true, /*nested=*/false);\n-\t  nested = true;\n-\t}\n-    }\n \n   warn_if_shadowing (x);\n "}, {"sha": "99ccef818632f12432999a2f14e08416b89f5c04", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ebef4d30443353b9cf4b2b559b2429273b60065b/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ebef4d30443353b9cf4b2b559b2429273b60065b/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=ebef4d30443353b9cf4b2b559b2429273b60065b", "patch": "@@ -1,3 +1,8 @@\n+2004-12-21  James A. Morrison  <phython@gcc.gnu.org>\n+\n+\tPR c/18963\n+\t* gcc.dg/pr18963-1.c: New test.\n+\n 2004-12-21  James A. Morrison  <phython@gcc.gnu.org>\n \n \tPR c/18596"}, {"sha": "df43c6543f78c8b9a4c33fbd4bee52eee0bbc90f", "filename": "gcc/testsuite/gcc.dg/pr18963-1.c", "status": "added", "additions": 29, "deletions": 0, "changes": 29, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ebef4d30443353b9cf4b2b559b2429273b60065b/gcc%2Ftestsuite%2Fgcc.dg%2Fpr18963-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ebef4d30443353b9cf4b2b559b2429273b60065b/gcc%2Ftestsuite%2Fgcc.dg%2Fpr18963-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr18963-1.c?ref=ebef4d30443353b9cf4b2b559b2429273b60065b", "patch": "@@ -0,0 +1,29 @@\n+/* { dg-do run } */\n+/* { dg-options \"\" } */\n+\n+static int barf ();\n+\n+int foo ()\n+{ \n+  auto int barf ();\n+  int j = 4;\n+\n+  int barf () {\n+    return j;\n+  }\n+\n+  return barf ();\n+}\n+\n+static int barf () {\n+  return 3;\n+}\n+\n+extern void exit (int);\n+extern void abort ();\n+\n+int main (int argc, char *argv[]) {\n+  if (foo () != 4)\n+    abort ();\n+  exit (0);\n+}"}]}