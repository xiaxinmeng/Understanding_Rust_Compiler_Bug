{"sha": "465d76b7352eec414e0444a1c5840e0c339415b8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDY1ZDc2YjczNTJlZWM0MTRlMDQ0NGExYzU4NDBlMGMzMzk0MTViOA==", "commit": {"author": {"name": "Paolo Carlini", "email": "paolo.carlini@oracle.com", "date": "2009-12-15T20:58:29Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2009-12-15T20:58:29Z"}, "message": "re PR libstdc++/42381 (deque shouldn't reserve that much memory)\n\n2009-12-15  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR libsdtc++/42381\n\t* include/bits/stl_deque.h (_GLIBCXX_DEQUE_BUF_SIZE): Add.\n\t(__deque_buf_size(size_t)): Use it.\n\t* testsuite/23_containers/deque/requirements/dr438/\n\tassign_neg.cc: Adjust dg-error line numbers.\n\t* testsuite/23_containers/deque/requirements/dr438/\n\tinsert_neg.cc: Likewise.\n\t* testsuite/23_containers/deque/requirements/dr438/\n\tconstructor_1_neg.cc: Likewise.\n\t* testsuite/23_containers/deque/requirements/dr438/\n\tconstructor_2_neg.cc: Likewise.\n\nFrom-SVN: r155271", "tree": {"sha": "343851c183a60a7393bf85c776dacb679c2e15bc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/343851c183a60a7393bf85c776dacb679c2e15bc"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/465d76b7352eec414e0444a1c5840e0c339415b8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/465d76b7352eec414e0444a1c5840e0c339415b8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/465d76b7352eec414e0444a1c5840e0c339415b8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/465d76b7352eec414e0444a1c5840e0c339415b8/comments", "author": null, "committer": null, "parents": [{"sha": "abcd7e08477154884ab6be8ae846059eed0e9f45", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/abcd7e08477154884ab6be8ae846059eed0e9f45", "html_url": "https://github.com/Rust-GCC/gccrs/commit/abcd7e08477154884ab6be8ae846059eed0e9f45"}], "stats": {"total": 36, "additions": 30, "deletions": 6}, "files": [{"sha": "fd5dc86d959655f7b7b8c0a7cbfce259951ffea8", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/465d76b7352eec414e0444a1c5840e0c339415b8/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/465d76b7352eec414e0444a1c5840e0c339415b8/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=465d76b7352eec414e0444a1c5840e0c339415b8", "patch": "@@ -1,3 +1,17 @@\n+2009-12-15  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR libsdtc++/42381\n+\t* include/bits/stl_deque.h (_GLIBCXX_DEQUE_BUF_SIZE): Add.\n+\t(__deque_buf_size(size_t)): Use it.\n+\t* testsuite/23_containers/deque/requirements/dr438/\n+\tassign_neg.cc: Adjust dg-error line numbers.\n+\t* testsuite/23_containers/deque/requirements/dr438/\n+\tinsert_neg.cc: Likewise.\n+\t* testsuite/23_containers/deque/requirements/dr438/\n+\tconstructor_1_neg.cc: Likewise.\n+\t* testsuite/23_containers/deque/requirements/dr438/\n+\tconstructor_2_neg.cc: Likewise.\n+\n 2009-12-15  Jonathan Wakely  <jwakely.gcc@gmail.com>\n \n \t* include/std/future (unique_future::get, promise::set_value): Remove"}, {"sha": "d7589f71d7aa7eea0e8552624a50ac710a6be6f0", "filename": "libstdc++-v3/include/bits/stl_deque.h", "status": "modified", "additions": 12, "deletions": 2, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/465d76b7352eec414e0444a1c5840e0c339415b8/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstl_deque.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/465d76b7352eec414e0444a1c5840e0c339415b8/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstl_deque.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstl_deque.h?ref=465d76b7352eec414e0444a1c5840e0c339415b8", "patch": "@@ -72,11 +72,19 @@ _GLIBCXX_BEGIN_NESTED_NAMESPACE(std, _GLIBCXX_STD_D)\n    *  This function started off as a compiler kludge from SGI, but seems to\n    *  be a useful wrapper around a repeated constant expression.  The '512' is\n    *  tunable (and no other code needs to change), but no investigation has\n-   *  been done since inheriting the SGI code.\n+   *  been done since inheriting the SGI code.  Touch _GLIBCXX_DEQUE_BUF_SIZE\n+   *  only if you know what you are doing, however: changing it breaks the\n+   *  binary compatibility!!\n   */\n+\n+#ifndef _GLIBCXX_DEQUE_BUF_SIZE\n+#define _GLIBCXX_DEQUE_BUF_SIZE 512\n+#endif\n+\n   inline size_t\n   __deque_buf_size(size_t __size)\n-  { return __size < 512 ? size_t(512 / __size) : size_t(1); }\n+  { return (__size < _GLIBCXX_DEQUE_BUF_SIZE\n+\t    ? size_t(_GLIBCXX_DEQUE_BUF_SIZE / __size) : size_t(1)); }\n \n \n   /**\n@@ -1798,6 +1806,8 @@ _GLIBCXX_BEGIN_NESTED_NAMESPACE(std, _GLIBCXX_STD_D)\n     swap(deque<_Tp,_Alloc>& __x, deque<_Tp,_Alloc>& __y)\n     { __x.swap(__y); }\n \n+#undef _GLIBCXX_DEQUE_BUF_SIZE\n+\n _GLIBCXX_END_NESTED_NAMESPACE\n \n #endif /* _STL_DEQUE_H */"}, {"sha": "314a13f64e7a66f8944317c020c458d6729d5dcd", "filename": "libstdc++-v3/testsuite/23_containers/deque/requirements/dr438/assign_neg.cc", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/465d76b7352eec414e0444a1c5840e0c339415b8/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Fdeque%2Frequirements%2Fdr438%2Fassign_neg.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/465d76b7352eec414e0444a1c5840e0c339415b8/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Fdeque%2Frequirements%2Fdr438%2Fassign_neg.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Fdeque%2Frequirements%2Fdr438%2Fassign_neg.cc?ref=465d76b7352eec414e0444a1c5840e0c339415b8", "patch": "@@ -18,7 +18,7 @@\n // <http://www.gnu.org/licenses/>.\n \n // { dg-do compile }\n-// { dg-error \"no matching\" \"\" { target *-*-* } 1494 }\n+// { dg-error \"no matching\" \"\" { target *-*-* } 1502 }\n // { dg-excess-errors \"\" }\n \n #include <deque>"}, {"sha": "2ae51b836d807b8f6b02b3f7bda2493cc5dae53b", "filename": "libstdc++-v3/testsuite/23_containers/deque/requirements/dr438/constructor_1_neg.cc", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/465d76b7352eec414e0444a1c5840e0c339415b8/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Fdeque%2Frequirements%2Fdr438%2Fconstructor_1_neg.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/465d76b7352eec414e0444a1c5840e0c339415b8/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Fdeque%2Frequirements%2Fdr438%2Fconstructor_1_neg.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Fdeque%2Frequirements%2Fdr438%2Fconstructor_1_neg.cc?ref=465d76b7352eec414e0444a1c5840e0c339415b8", "patch": "@@ -18,7 +18,7 @@\n // <http://www.gnu.org/licenses/>.\n \n // { dg-do compile }\n-// { dg-error \"no matching\" \"\" { target *-*-* } 1433 }\n+// { dg-error \"no matching\" \"\" { target *-*-* } 1441 }\n // { dg-excess-errors \"\" }\n \n #include <deque>"}, {"sha": "22bb275068b3de06a88462cf9fd19afbfdff9bab", "filename": "libstdc++-v3/testsuite/23_containers/deque/requirements/dr438/constructor_2_neg.cc", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/465d76b7352eec414e0444a1c5840e0c339415b8/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Fdeque%2Frequirements%2Fdr438%2Fconstructor_2_neg.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/465d76b7352eec414e0444a1c5840e0c339415b8/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Fdeque%2Frequirements%2Fdr438%2Fconstructor_2_neg.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Fdeque%2Frequirements%2Fdr438%2Fconstructor_2_neg.cc?ref=465d76b7352eec414e0444a1c5840e0c339415b8", "patch": "@@ -18,7 +18,7 @@\n // <http://www.gnu.org/licenses/>.\n \n // { dg-do compile }\n-// { dg-error \"no matching\" \"\" { target *-*-* } 1433 }\n+// { dg-error \"no matching\" \"\" { target *-*-* } 1441 }\n // { dg-excess-errors \"\" }\n \n #include <deque>"}, {"sha": "cdacae483f93b8b27ede4c12ad755b574767848a", "filename": "libstdc++-v3/testsuite/23_containers/deque/requirements/dr438/insert_neg.cc", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/465d76b7352eec414e0444a1c5840e0c339415b8/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Fdeque%2Frequirements%2Fdr438%2Finsert_neg.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/465d76b7352eec414e0444a1c5840e0c339415b8/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Fdeque%2Frequirements%2Fdr438%2Finsert_neg.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Fdeque%2Frequirements%2Fdr438%2Finsert_neg.cc?ref=465d76b7352eec414e0444a1c5840e0c339415b8", "patch": "@@ -18,7 +18,7 @@\n // <http://www.gnu.org/licenses/>.\n \n // { dg-do compile }\n-// { dg-error \"no matching\" \"\" { target *-*-* } 1578 }\n+// { dg-error \"no matching\" \"\" { target *-*-* } 1586 }\n // { dg-excess-errors \"\" }\n \n #include <deque>"}]}