{"sha": "57e1270f58ad000b55282ae12b3c641f940bc923", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTdlMTI3MGY1OGFkMDAwYjU1MjgyYWUxMmIzYzY0MWY5NDBiYzkyMw==", "commit": {"author": {"name": "Fritz Reese", "email": "fritzoreese@gmail.com", "date": "2017-08-10T12:36:44Z"}, "committer": {"name": "Fritz Reese", "email": "foreese@gcc.gnu.org", "date": "2017-08-10T12:36:44Z"}, "message": "options.c (set_dec_flags, [...]): Only set flag_d_lines with -fdec when not set by user.\n\n2017-08-10  Fritz Reese <Reese-Fritz@zai.com>\n\n    gcc/fortran/ChangeLog:\n\n\t* options.c (set_dec_flags, gfc_post_options): Only set flag_d_lines\n\twith -fdec when not set by user.\n\n    gcc/testsuite/ChangeLog:\n\n    gfortran.dg/\n\t* dec_d_lines_1.f, dec_d_lines_2.f: New.\n\nFrom-SVN: r251024", "tree": {"sha": "ec223d9e9ea6f23e81c0be67fa969f3431c28183", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ec223d9e9ea6f23e81c0be67fa969f3431c28183"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/57e1270f58ad000b55282ae12b3c641f940bc923", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/57e1270f58ad000b55282ae12b3c641f940bc923", "html_url": "https://github.com/Rust-GCC/gccrs/commit/57e1270f58ad000b55282ae12b3c641f940bc923", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/57e1270f58ad000b55282ae12b3c641f940bc923/comments", "author": {"login": "fritzr", "id": 2230564, "node_id": "MDQ6VXNlcjIyMzA1NjQ=", "avatar_url": "https://avatars.githubusercontent.com/u/2230564?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fritzr", "html_url": "https://github.com/fritzr", "followers_url": "https://api.github.com/users/fritzr/followers", "following_url": "https://api.github.com/users/fritzr/following{/other_user}", "gists_url": "https://api.github.com/users/fritzr/gists{/gist_id}", "starred_url": "https://api.github.com/users/fritzr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fritzr/subscriptions", "organizations_url": "https://api.github.com/users/fritzr/orgs", "repos_url": "https://api.github.com/users/fritzr/repos", "events_url": "https://api.github.com/users/fritzr/events{/privacy}", "received_events_url": "https://api.github.com/users/fritzr/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "6f855a26ab2d30bc7f3b0cfec456e2b27e63b9a7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6f855a26ab2d30bc7f3b0cfec456e2b27e63b9a7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6f855a26ab2d30bc7f3b0cfec456e2b27e63b9a7"}], "stats": {"total": 45, "additions": 38, "deletions": 7}, "files": [{"sha": "20fa93f6ec9410f7e8d5c88a1225721016d04a97", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/57e1270f58ad000b55282ae12b3c641f940bc923/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/57e1270f58ad000b55282ae12b3c641f940bc923/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=57e1270f58ad000b55282ae12b3c641f940bc923", "patch": "@@ -1,4 +1,9 @@\n-2017-08-10  Fritz Reese <Reese-Fritz@zai.com>\n+2017-08-10  Fritz Reese <fritzoreese@gmail.com>\n+\n+\t* options.c (set_dec_flags, gfc_post_options): Only set flag_d_lines\n+\twith -fdec when not set by user.\n+\n+2017-08-10  Fritz Reese <fritzoreese@gmail.com>\n \n \t* decl.c (attr_seen): New static variable.\n \t* decl.c (variable_decl): Match %FILL in STRUCTURE body."}, {"sha": "cd254e932296555f242f953468d0556c3bbf1da2", "filename": "gcc/fortran/options.c", "status": "modified", "additions": 9, "deletions": 5, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/57e1270f58ad000b55282ae12b3c641f940bc923/gcc%2Ffortran%2Foptions.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/57e1270f58ad000b55282ae12b3c641f940bc923/gcc%2Ffortran%2Foptions.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Foptions.c?ref=57e1270f58ad000b55282ae12b3c641f940bc923", "patch": "@@ -57,9 +57,6 @@ set_dec_flags (int value)\n     | GFC_STD_GNU | GFC_STD_LEGACY;\n   gfc_option.warn_std &= ~(GFC_STD_LEGACY | GFC_STD_F95_DEL);\n \n-  /* Set -fd-lines-as-comments by default.  */\n-  if (value && gfc_current_form != FORM_FREE && gfc_option.flag_d_lines == -1)\n-    gfc_option.flag_d_lines = 0;\n \n   /* Set other DEC compatibility extensions.  */\n   flag_dollar_ok |= value;\n@@ -339,8 +336,15 @@ gfc_post_options (const char **pfilename)\n \tdiagnostic_classify_diagnostic (global_dc, OPT_Wline_truncation,\n \t\t\t\t\tDK_ERROR, UNKNOWN_LOCATION);\n     }\n-  else if (warn_line_truncation == -1)\n-    warn_line_truncation = 0;\n+  else\n+    {\n+      /* With -fdec, set -fd-lines-as-comments by default in fixed form.  */\n+      if (flag_dec && gfc_option.flag_d_lines == -1)\n+\tgfc_option.flag_d_lines = 0;\n+\n+      if (warn_line_truncation == -1)\n+\twarn_line_truncation = 0;\n+    }\n \n   /* If -pedantic, warn about the use of GNU extensions.  */\n   if (pedantic && (gfc_option.allow_std & GFC_STD_GNU) != 0)"}, {"sha": "a1e72369cd34ae4509702c9d21f220a7624da9e1", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/57e1270f58ad000b55282ae12b3c641f940bc923/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/57e1270f58ad000b55282ae12b3c641f940bc923/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=57e1270f58ad000b55282ae12b3c641f940bc923", "patch": "@@ -1,4 +1,9 @@\n-2017-08-10  Fritz Reese <Reese-Fritz@zai.com>\n+2017-08-10  Fritz Reese <fritzoreese@gmail.com>\n+\n+\t* gfortran.dg/dec_d_lines_1.f: New test.\n+\t* gfortran.dg/dec_d_lines_2.f: New test.\n+\n+2017-08-10  Fritz Reese <fritzoreese@gmail.com>\n \n \t* gfortran.dg/dec_structure_18.f90: New test.\n \t* gfortran.dg/dec_structure_19.f90: New test."}, {"sha": "2cc7a01daffbde796c77225128673e1c42ddb955", "filename": "gcc/testsuite/gfortran.dg/dec_d_lines_1.f", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/57e1270f58ad000b55282ae12b3c641f940bc923/gcc%2Ftestsuite%2Fgfortran.dg%2Fdec_d_lines_1.f", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/57e1270f58ad000b55282ae12b3c641f940bc923/gcc%2Ftestsuite%2Fgfortran.dg%2Fdec_d_lines_1.f", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fdec_d_lines_1.f?ref=57e1270f58ad000b55282ae12b3c641f940bc923", "patch": "@@ -0,0 +1,9 @@\n+! { dg-do compile }\n+! { dg-options \"-ffixed-form -fd-lines-as-code -fdec\" }\n+!\n+! Ensure -fd-lines-as-code is not overridden by -fdec.\n+!\n+      i = 0\n+d     end\n+      subroutine s\n+D     end"}, {"sha": "31eaf5f232890e499a7507e9d736690e17ef33af", "filename": "gcc/testsuite/gfortran.dg/dec_d_lines_2.f", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/57e1270f58ad000b55282ae12b3c641f940bc923/gcc%2Ftestsuite%2Fgfortran.dg%2Fdec_d_lines_2.f", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/57e1270f58ad000b55282ae12b3c641f940bc923/gcc%2Ftestsuite%2Fgfortran.dg%2Fdec_d_lines_2.f", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fdec_d_lines_2.f?ref=57e1270f58ad000b55282ae12b3c641f940bc923", "patch": "@@ -0,0 +1,8 @@\n+! { dg-do compile }\n+! { dg-options \"-ffixed-form -fdec\" }\n+!\n+! Ensure -fd-lines-as-comments is enabled by default with -fdec.\n+!\n+d This is a comment.\n+D This line, too.\n+      end"}]}