{"sha": "f73dc37f756c3839704b24739e875f378edb9db4", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjczZGMzN2Y3NTZjMzgzOTcwNGIyNDczOWU4NzVmMzc4ZWRiOWRiNA==", "commit": {"author": {"name": "Ed Schonberg", "email": "schonberg@adacore.com", "date": "2016-04-20T10:46:57Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2016-04-20T10:46:57Z"}, "message": "sem_util.ads, [...] (Is_Expanded_Priority_Attribute): New predicate to determine that in a context with full run-time...\n\n2016-04-20  Ed Schonberg  <schonberg@adacore.com>\n\n\t* sem_util.ads, sem_util.adb (Is_Expanded_Priority_Attribute):\n\tNew predicate to determine that in a context with full run-time,\n\ta function call is an expansion of a reference to attribute\n\tPriority.\n\t* sem_ch5.adb (Analyze_Function_Call): use it.\n\t* exp_ch5.adb (Expand_N_Subprogram_Call): use it.\n\nFrom-SVN: r235265", "tree": {"sha": "d7d1bbe572ad92b1dc6a9f703757cda9068a237f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d7d1bbe572ad92b1dc6a9f703757cda9068a237f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f73dc37f756c3839704b24739e875f378edb9db4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f73dc37f756c3839704b24739e875f378edb9db4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f73dc37f756c3839704b24739e875f378edb9db4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f73dc37f756c3839704b24739e875f378edb9db4/comments", "author": {"login": "Edschonberg", "id": 6352375, "node_id": "MDQ6VXNlcjYzNTIzNzU=", "avatar_url": "https://avatars.githubusercontent.com/u/6352375?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Edschonberg", "html_url": "https://github.com/Edschonberg", "followers_url": "https://api.github.com/users/Edschonberg/followers", "following_url": "https://api.github.com/users/Edschonberg/following{/other_user}", "gists_url": "https://api.github.com/users/Edschonberg/gists{/gist_id}", "starred_url": "https://api.github.com/users/Edschonberg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Edschonberg/subscriptions", "organizations_url": "https://api.github.com/users/Edschonberg/orgs", "repos_url": "https://api.github.com/users/Edschonberg/repos", "events_url": "https://api.github.com/users/Edschonberg/events{/privacy}", "received_events_url": "https://api.github.com/users/Edschonberg/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "75a957f5dba310b73a1d040da70f6e4077379af4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/75a957f5dba310b73a1d040da70f6e4077379af4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/75a957f5dba310b73a1d040da70f6e4077379af4"}], "stats": {"total": 42, "additions": 30, "deletions": 12}, "files": [{"sha": "b849645a49d7d0417d9c893f3dbc7acafb5e9f32", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f73dc37f756c3839704b24739e875f378edb9db4/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f73dc37f756c3839704b24739e875f378edb9db4/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=f73dc37f756c3839704b24739e875f378edb9db4", "patch": "@@ -1,3 +1,12 @@\n+2016-04-20  Ed Schonberg  <schonberg@adacore.com>\n+\n+\t* sem_util.ads, sem_util.adb (Is_Expanded_Priority_Attribute):\n+\tNew predicate to determine that in a context with full run-time,\n+\ta function call is an expansion of a reference to attribute\n+\tPriority.\n+\t* sem_ch5.adb (Analyze_Function_Call): use it.\n+\t* exp_ch5.adb (Expand_N_Subprogram_Call): use it.\n+\n 2016-04-20  Hristian Kirtchev  <kirtchev@adacore.com>\n \n \t* einfo.adb Flag286 is now used as Is_Exception_Handler."}, {"sha": "9f9c832ac4726e1cb47457b4c59189dc4d22cec8", "filename": "gcc/ada/exp_ch5.adb", "status": "modified", "additions": 2, "deletions": 6, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f73dc37f756c3839704b24739e875f378edb9db4/gcc%2Fada%2Fexp_ch5.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f73dc37f756c3839704b24739e875f378edb9db4/gcc%2Fada%2Fexp_ch5.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fexp_ch5.adb?ref=f73dc37f756c3839704b24739e875f378edb9db4", "patch": "@@ -1695,12 +1695,8 @@ package body Exp_Ch5 is\n             --  previously expanded into a call to the Get_Ceiling run-time\n             --  subprogram. In restricted profiles this is not available.\n \n-            if Nkind (Ent) = N_Function_Call\n-              and then not Configurable_Run_Time_Mode\n-              and then (Entity (Name (Ent)) = RTE (RE_Get_Ceiling)\n-                          or else\n-                        Entity (Name (Ent)) = RTE (RO_PE_Get_Ceiling))\n-            then\n+            if Is_Expanded_Priority_Attribute (Ent) then\n+\n                --  Look for the enclosing concurrent type\n \n                Conctyp := Current_Scope;"}, {"sha": "71ab4d0f26e4b04ce63dd788a89efdc3ab3653ee", "filename": "gcc/ada/sem_ch5.adb", "status": "modified", "additions": 1, "deletions": 6, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f73dc37f756c3839704b24739e875f378edb9db4/gcc%2Fada%2Fsem_ch5.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f73dc37f756c3839704b24739e875f378edb9db4/gcc%2Fada%2Fsem_ch5.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch5.adb?ref=f73dc37f756c3839704b24739e875f378edb9db4", "patch": "@@ -41,7 +41,6 @@ with Nmake;    use Nmake;\n with Opt;      use Opt;\n with Restrict; use Restrict;\n with Rident;   use Rident;\n-with Rtsfind;  use Rtsfind;\n with Sem;      use Sem;\n with Sem_Aux;  use Sem_Aux;\n with Sem_Case; use Sem_Case;\n@@ -440,11 +439,7 @@ package body Sem_Ch5 is\n                   --  objects have been previously expanded into calls to the\n                   --  Get_Ceiling run-time subprogram.\n \n-                 or else\n-                  (Nkind (Ent) = N_Function_Call\n-                    and then (Entity (Name (Ent)) = RTE (RE_Get_Ceiling)\n-                               or else\n-                              Entity (Name (Ent)) = RTE (RO_PE_Get_Ceiling)))\n+                 or else Is_Expanded_Priority_Attribute (Ent)\n                then\n                   --  The enclosing subprogram cannot be a protected function\n "}, {"sha": "eaa2429c1742c590f195f53706c9473ac1cf1f18", "filename": "gcc/ada/sem_util.adb", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f73dc37f756c3839704b24739e875f378edb9db4/gcc%2Fada%2Fsem_util.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f73dc37f756c3839704b24739e875f378edb9db4/gcc%2Fada%2Fsem_util.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_util.adb?ref=f73dc37f756c3839704b24739e875f378edb9db4", "patch": "@@ -12123,6 +12123,19 @@ package body Sem_Util is\n           and then Nkind (Unit_Declaration_Node (Id)) = N_Entry_Declaration;\n    end Is_Entry_Declaration;\n \n+   ------------------------------------\n+   -- Is_Expanded_Priority_Attribute --\n+   ------------------------------------\n+\n+   function Is_Expanded_Priority_Attribute (E : Entity_Id) return Boolean is\n+   begin\n+      return\n+        Nkind (E) = N_Function_Call\n+          and then not Configurable_Run_Time_Mode\n+          and then (Entity (Name (E)) = RTE (RE_Get_Ceiling)\n+                     or else Entity (Name (E)) = RTE (RO_PE_Get_Ceiling));\n+   end Is_Expanded_Priority_Attribute;\n+\n    ----------------------------\n    -- Is_Expression_Function --\n    ----------------------------"}, {"sha": "93fadaacab4c6919fe124324db0b4b17dc3f2110", "filename": "gcc/ada/sem_util.ads", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f73dc37f756c3839704b24739e875f378edb9db4/gcc%2Fada%2Fsem_util.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f73dc37f756c3839704b24739e875f378edb9db4/gcc%2Fada%2Fsem_util.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_util.ads?ref=f73dc37f756c3839704b24739e875f378edb9db4", "patch": "@@ -1376,6 +1376,11 @@ package Sem_Util is\n    function Is_Entry_Declaration (Id : Entity_Id) return Boolean;\n    --  Determine whether entity Id is the spec entity of an entry [family]\n \n+   function Is_Expanded_Priority_Attribute (E : Entity_Id) return Boolean;\n+   --  Check whether a function in a call is an expanded priority attribute,\n+   --  which is transformed into an Rtsfind call to Get_Ceiling. This expansion\n+   --  does not take place in a configurable runtime.\n+\n    function Is_Expression_Function (Subp : Entity_Id) return Boolean;\n    --  Determine whether subprogram [body] Subp denotes an expression function\n "}]}