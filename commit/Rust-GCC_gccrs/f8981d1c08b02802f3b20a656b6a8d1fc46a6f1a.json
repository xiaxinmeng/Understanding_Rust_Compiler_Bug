{"sha": "f8981d1c08b02802f3b20a656b6a8d1fc46a6f1a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Zjg5ODFkMWMwOGIwMjgwMmYzYjIwYTY1NmI2YThkMWZjNDZhNmYxYQ==", "commit": {"author": {"name": "Alexandre Oliva", "email": "aoliva@redhat.com", "date": "2009-11-16T20:18:33Z"}, "committer": {"name": "Alexandre Oliva", "email": "aoliva@gcc.gnu.org", "date": "2009-11-16T20:18:33Z"}, "message": "tree-cfg.c (gimple_redirect_edge_and_branch): Create the decl label for the new dest block on demand.\n\n* tree-cfg.c (gimple_redirect_edge_and_branch) <case GIMPLE_ASM>:\nCreate the decl label for the new dest block on demand.  Require\na fallthrough edge if no asm labels were redirected.\n\nFrom-SVN: r154213", "tree": {"sha": "0ef81fd54f54010bdbafa2f630380ac7e91165cf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0ef81fd54f54010bdbafa2f630380ac7e91165cf"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f8981d1c08b02802f3b20a656b6a8d1fc46a6f1a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f8981d1c08b02802f3b20a656b6a8d1fc46a6f1a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f8981d1c08b02802f3b20a656b6a8d1fc46a6f1a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f8981d1c08b02802f3b20a656b6a8d1fc46a6f1a/comments", "author": null, "committer": null, "parents": [{"sha": "a81f2330a313bcba17be25819ba4c3ad9ffd03c7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a81f2330a313bcba17be25819ba4c3ad9ffd03c7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a81f2330a313bcba17be25819ba4c3ad9ffd03c7"}], "stats": {"total": 19, "additions": 17, "deletions": 2}, "files": [{"sha": "aba806ec8120c3f960d05983f361814191ee4676", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f8981d1c08b02802f3b20a656b6a8d1fc46a6f1a/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f8981d1c08b02802f3b20a656b6a8d1fc46a6f1a/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=f8981d1c08b02802f3b20a656b6a8d1fc46a6f1a", "patch": "@@ -1,3 +1,9 @@\n+2009-11-16  Alexandre Oliva  <aoliva@redhat.com>\n+\n+\t* tree-cfg.c (gimple_redirect_edge_and_branch) <case GIMPLE_ASM>:\n+\tCreate the decl label for the new dest block on demand.  Require\n+\ta fallthrough edge if no asm labels were redirected.\n+\n 2009-11-16  Uros Bizjak  <ubizjak@gmail.com>\n \n \t* config/i386/i386.md (cbranchsi4): Use nonimmediate_operand for"}, {"sha": "b3b71b9abba95e26f46cb29ecff77b06612b161d", "filename": "gcc/tree-cfg.c", "status": "modified", "additions": 11, "deletions": 2, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f8981d1c08b02802f3b20a656b6a8d1fc46a6f1a/gcc%2Ftree-cfg.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f8981d1c08b02802f3b20a656b6a8d1fc46a6f1a/gcc%2Ftree-cfg.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-cfg.c?ref=f8981d1c08b02802f3b20a656b6a8d1fc46a6f1a", "patch": "@@ -4666,14 +4666,23 @@ gimple_redirect_edge_and_branch (edge e, basic_block dest)\n     case GIMPLE_ASM:\n       {\n \tint i, n = gimple_asm_nlabels (stmt);\n-\ttree label = gimple_block_label (dest);\n+\ttree label = NULL;\n \n \tfor (i = 0; i < n; ++i)\n \t  {\n \t    tree cons = gimple_asm_label_op (stmt, i);\n \t    if (label_to_block (TREE_VALUE (cons)) == e->dest)\n-\t      TREE_VALUE (cons) = label;\n+\t      {\n+\t\tif (!label)\n+\t\t  label = gimple_block_label (dest);\n+\t\tTREE_VALUE (cons) = label;\n+\t      }\n \t  }\n+\n+\t/* If we didn't find any label matching the former edge in the\n+\t   asm labels, we must be redirecting the fallthrough\n+\t   edge.  */\n+\tgcc_assert (label || (e->flags & EDGE_FALLTHRU));\n       }\n       break;\n "}]}