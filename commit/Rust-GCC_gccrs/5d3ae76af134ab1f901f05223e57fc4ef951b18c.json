{"sha": "5d3ae76af134ab1f901f05223e57fc4ef951b18c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NWQzYWU3NmFmMTM0YWIxZjkwMWYwNTIyM2U1N2ZjNGVmOTUxYjE4Yw==", "commit": {"author": {"name": "Segher Boessenkool", "email": "segher@kernel.crashing.org", "date": "2017-05-19T11:29:21Z"}, "committer": {"name": "Segher Boessenkool", "email": "segher@gcc.gnu.org", "date": "2017-05-19T11:29:21Z"}, "message": "rs6000: Make constant formation a tiny bit better\n\nIf we cannot load a constant into a register in one insn, and that\nconstant is a valid mask (for rotate instructions), we currently\nprefer to load -1 and then mask it.  This patch makes us not do that if\ninstead we could use two add or or instructions, since those are\nsometimes faster on certain CPUs (and never are slower).\n\n\n\t* config/rs6000/rs6000.md (splitter to load of -1 and mask): Don't\n\tuse this splitter if two add or or instructions would also work for\n\tthe constant we want to generate.\n\nFrom-SVN: r248265", "tree": {"sha": "58d1e883a54e2e25917097c06c8dd3dc265e9d50", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/58d1e883a54e2e25917097c06c8dd3dc265e9d50"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5d3ae76af134ab1f901f05223e57fc4ef951b18c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5d3ae76af134ab1f901f05223e57fc4ef951b18c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5d3ae76af134ab1f901f05223e57fc4ef951b18c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5d3ae76af134ab1f901f05223e57fc4ef951b18c/comments", "author": {"login": "segher", "id": 417629, "node_id": "MDQ6VXNlcjQxNzYyOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/417629?v=4", "gravatar_id": "", "url": "https://api.github.com/users/segher", "html_url": "https://github.com/segher", "followers_url": "https://api.github.com/users/segher/followers", "following_url": "https://api.github.com/users/segher/following{/other_user}", "gists_url": "https://api.github.com/users/segher/gists{/gist_id}", "starred_url": "https://api.github.com/users/segher/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/segher/subscriptions", "organizations_url": "https://api.github.com/users/segher/orgs", "repos_url": "https://api.github.com/users/segher/repos", "events_url": "https://api.github.com/users/segher/events{/privacy}", "received_events_url": "https://api.github.com/users/segher/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "3a6461f307f6204f2b415a3fc94fa21dc7cbe3ec", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3a6461f307f6204f2b415a3fc94fa21dc7cbe3ec", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3a6461f307f6204f2b415a3fc94fa21dc7cbe3ec"}], "stats": {"total": 7, "additions": 7, "deletions": 0}, "files": [{"sha": "9006383293e17c981f5ac42f73d611940aa057dd", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5d3ae76af134ab1f901f05223e57fc4ef951b18c/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5d3ae76af134ab1f901f05223e57fc4ef951b18c/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=5d3ae76af134ab1f901f05223e57fc4ef951b18c", "patch": "@@ -1,3 +1,9 @@\n+2017-05-19  Segher Boessenkool  <segher@kernel.crashing.org>\n+\n+\t* config/rs6000/rs6000.md (splitter to load of -1 and mask): Don't\n+\tuse this splitter if two add or or instructions would also work for\n+\tthe constant we want to generate.\n+\n 2017-05-19  Richard Biener  <rguenther@suse.de>\n \n \tPR build/80821"}, {"sha": "799d786edfedb98729add9e4e5f36257397aec66", "filename": "gcc/config/rs6000/rs6000.md", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5d3ae76af134ab1f901f05223e57fc4ef951b18c/gcc%2Fconfig%2Frs6000%2Frs6000.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5d3ae76af134ab1f901f05223e57fc4ef951b18c/gcc%2Fconfig%2Frs6000%2Frs6000.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.md?ref=5d3ae76af134ab1f901f05223e57fc4ef951b18c", "patch": "@@ -8732,6 +8732,7 @@\n \t(match_operand:DI 1 \"const_int_operand\"))]\n   \"TARGET_POWERPC64\n    && num_insns_constant (operands[1], DImode) > 1\n+   && !IN_RANGE (INTVAL (operands[1]), -0x80000000, 0xffffffff)\n    && rs6000_is_valid_and_mask (operands[1], DImode)\"\n   [(set (match_dup 0)\n \t(const_int -1))"}]}