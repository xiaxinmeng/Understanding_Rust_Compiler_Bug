{"sha": "b3fd81925d96d46b83b9d32daf10a213792ca9a4", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjNmZDgxOTI1ZDk2ZDQ2YjgzYjlkMzJkYWYxMGEyMTM3OTJjYTlhNA==", "commit": {"author": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "1997-07-01T20:16:19Z"}, "committer": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "1997-07-01T20:16:19Z"}, "message": "Fix static functions in sys/stat.h for C++\n\nFrom-SVN: r14366", "tree": {"sha": "0a81ba150e8cc4cddf9ad29ee3201b8b9d7c1105", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0a81ba150e8cc4cddf9ad29ee3201b8b9d7c1105"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b3fd81925d96d46b83b9d32daf10a213792ca9a4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b3fd81925d96d46b83b9d32daf10a213792ca9a4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b3fd81925d96d46b83b9d32daf10a213792ca9a4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b3fd81925d96d46b83b9d32daf10a213792ca9a4/comments", "author": null, "committer": null, "parents": [{"sha": "8195ec37afe082d68902cab332762a92fc4c5abf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8195ec37afe082d68902cab332762a92fc4c5abf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8195ec37afe082d68902cab332762a92fc4c5abf"}], "stats": {"total": 30, "additions": 30, "deletions": 0}, "files": [{"sha": "c0ca7826d7fadf0e471163cd3afe2eacddbb3613", "filename": "gcc/fixinc.sco", "status": "modified", "additions": 30, "deletions": 0, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b3fd81925d96d46b83b9d32daf10a213792ca9a4/gcc%2Ffixinc.sco", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b3fd81925d96d46b83b9d32daf10a213792ca9a4/gcc%2Ffixinc.sco", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffixinc.sco?ref=b3fd81925d96d46b83b9d32daf10a213792ca9a4", "patch": "@@ -338,6 +338,36 @@ if [ \\! -z \"$file_to_fix\" ]; then\n   rm -f /tmp/$base\n fi\n \n+#\n+# Also, the static functions lstat() and fchmod() in <sys/stat.h> \n+# cause G++ grief since they're not wrapped in \"if __cplusplus\".   \n+# Fix that up now.\n+#\n+file=sys/stat.h\n+if [ -r $file ] && [ ! -r ${LIB}/$file ]; then\n+  cp $file ${LIB}/$file >/dev/null 2>&1 || echo \"Can't copy $file\"\n+  chmod +w ${LIB}/$file 2>/dev/null\n+  chmod a+r ${LIB}/$file 2>/dev/null\n+fi\n+\n+if [ -r ${LIB}/$file ]; then\n+  echo Fixing $file, static definitions not C++-aware.\n+  sed -e '/^static int[ \t]*/i\\\n+#if __cplusplus\\\n+extern \"C\"\\\n+{\\\n+#endif /* __cplusplus */ \\\n+' \\\n+-e '/^}$/a\\\n+#if __cplusplus\\\n+}\\\n+#endif /* __cplusplus */ \\\n+' ${LIB}/$file > ${LIB}/${file}.sed\n+  rm -f ${LIB}/$file; mv ${LIB}/${file}.sed ${LIB}/$file\n+  if cmp $file ${LIB}/$file >/dev/null 2>&1; then\n+    rm -f ${LIB}/$file\n+  fi\n+fi\n \n echo 'Removing unneeded directories:'\n cd $LIB"}]}