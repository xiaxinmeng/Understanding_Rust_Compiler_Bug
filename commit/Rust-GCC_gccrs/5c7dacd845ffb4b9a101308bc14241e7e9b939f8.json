{"sha": "5c7dacd845ffb4b9a101308bc14241e7e9b939f8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NWM3ZGFjZDg0NWZmYjRiOWExMDEzMDhiYzE0MjQxZTdlOWI5MzlmOA==", "commit": {"author": {"name": "SimplyTheOther", "email": "simplytheother@gmail.com", "date": "2021-02-05T13:49:35Z"}, "committer": {"name": "SimplyTheOther", "email": "simplytheother@gmail.com", "date": "2021-02-05T13:49:35Z"}, "message": "Added some debug for cfg stripping and improved dump messages", "tree": {"sha": "0d25f1e3f9bf7f192a06487cfb268719465df527", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0d25f1e3f9bf7f192a06487cfb268719465df527"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5c7dacd845ffb4b9a101308bc14241e7e9b939f8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5c7dacd845ffb4b9a101308bc14241e7e9b939f8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5c7dacd845ffb4b9a101308bc14241e7e9b939f8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5c7dacd845ffb4b9a101308bc14241e7e9b939f8/comments", "author": {"login": "SimplyTheOther", "id": 19371469, "node_id": "MDQ6VXNlcjE5MzcxNDY5", "avatar_url": "https://avatars.githubusercontent.com/u/19371469?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SimplyTheOther", "html_url": "https://github.com/SimplyTheOther", "followers_url": "https://api.github.com/users/SimplyTheOther/followers", "following_url": "https://api.github.com/users/SimplyTheOther/following{/other_user}", "gists_url": "https://api.github.com/users/SimplyTheOther/gists{/gist_id}", "starred_url": "https://api.github.com/users/SimplyTheOther/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SimplyTheOther/subscriptions", "organizations_url": "https://api.github.com/users/SimplyTheOther/orgs", "repos_url": "https://api.github.com/users/SimplyTheOther/repos", "events_url": "https://api.github.com/users/SimplyTheOther/events{/privacy}", "received_events_url": "https://api.github.com/users/SimplyTheOther/received_events", "type": "User", "site_admin": false}, "committer": {"login": "SimplyTheOther", "id": 19371469, "node_id": "MDQ6VXNlcjE5MzcxNDY5", "avatar_url": "https://avatars.githubusercontent.com/u/19371469?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SimplyTheOther", "html_url": "https://github.com/SimplyTheOther", "followers_url": "https://api.github.com/users/SimplyTheOther/followers", "following_url": "https://api.github.com/users/SimplyTheOther/following{/other_user}", "gists_url": "https://api.github.com/users/SimplyTheOther/gists{/gist_id}", "starred_url": "https://api.github.com/users/SimplyTheOther/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SimplyTheOther/subscriptions", "organizations_url": "https://api.github.com/users/SimplyTheOther/orgs", "repos_url": "https://api.github.com/users/SimplyTheOther/repos", "events_url": "https://api.github.com/users/SimplyTheOther/events{/privacy}", "received_events_url": "https://api.github.com/users/SimplyTheOther/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7c7c76f27f6ab999ec8fa299bde8911911fa7d90", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7c7c76f27f6ab999ec8fa299bde8911911fa7d90", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7c7c76f27f6ab999ec8fa299bde8911911fa7d90"}], "stats": {"total": 18, "additions": 13, "deletions": 5}, "files": [{"sha": "29fc58bc8200c46d7d6d7050f7e4787193206b48", "filename": "gcc/rust/expand/rust-macro-expand.cc", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5c7dacd845ffb4b9a101308bc14241e7e9b939f8/gcc%2Frust%2Fexpand%2Frust-macro-expand.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5c7dacd845ffb4b9a101308bc14241e7e9b939f8/gcc%2Frust%2Fexpand%2Frust-macro-expand.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Frust%2Fexpand%2Frust-macro-expand.cc?ref=5c7dacd845ffb4b9a101308bc14241e7e9b939f8", "patch": "@@ -1504,7 +1504,7 @@ class AttrVisitor : public AST::ASTVisitor\n \treturn;\n       }\n \n-    // TODO: strip sub-patterns of pattern\n+    // strip sub-patterns of pattern\n     auto &pattern = expr.get_pattern ();\n     pattern->accept_vis (*this);\n     if (pattern->is_marked_for_strip ())\n@@ -3283,7 +3283,12 @@ MacroExpander::fails_cfg_with_expand (std::vector<AST::Attribute> &attrs) const\n \t    attr.parse_attr_to_meta_item ();\n \n \t  if (!attr.check_cfg_predicate (session))\n+    {\n+      // DEBUG\n+      fprintf (stderr, \"cfg predicate failed for attribute: \\033[0;31m'%s'\\033[0m\\n\", attr.as_string ());\n+\n \t    return true;\n+    }\n \t}\n     }\n   return false;"}, {"sha": "dcdbd49db4322757cddaa442e4b83ceb47b00e55", "filename": "gcc/rust/rust-session-manager.cc", "status": "modified", "additions": 7, "deletions": 4, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5c7dacd845ffb4b9a101308bc14241e7e9b939f8/gcc%2Frust%2Frust-session-manager.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5c7dacd845ffb4b9a101308bc14241e7e9b939f8/gcc%2Frust%2Frust-session-manager.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Frust%2Frust-session-manager.cc?ref=5c7dacd845ffb4b9a101308bc14241e7e9b939f8", "patch": "@@ -363,7 +363,8 @@ Session::enable_dump (std::string arg)\n       rust_error_at (\n \tLocation (),\n \t\"dumping all is not supported as of now. choose %<lex%>, %<parse%>, \"\n-\t\"or %<target_options%>\");\n+\t\"%<register_plugins%>, %<injection%>, %<expansion%>, %<resolution%>,\"\n+  \" %<target_options%>, or %<hir%>\");\n       return false;\n     }\n   else if (arg == \"lex\")\n@@ -406,15 +407,17 @@ Session::enable_dump (std::string arg)\n   else if (arg == \"\")\n     {\n       rust_error_at (Location (), \"dump option was not given a name. choose \"\n-\t\t\t\t  \"%<lex%>, %<parse%>, or %<target_options%>\");\n+\t\t\t\t  \"%<lex%>, %<parse%>, %<register_plugins%>, %<injection%>, \"\n+          \"%<expansion%>, %<resolution%>, %<target_options%>, or %<hir%>\");\n       return false;\n     }\n   else\n     {\n       rust_error_at (\n \tLocation (),\n-\t\"dump option %qs was unrecognised. choose %<lex%>, %<parse%>, or \"\n-\t\"%<target_options%>\",\n+\t\"dump option %qs was unrecognised. choose %<lex%>, %<parse%>, \"\n+      \"%<register_plugins%>, %<injection%>, %<expansion%>, %<resolution%>,\"\n+      \" %<target_options%>, or %<hir%>\",\n \targ.c_str ());\n       return false;\n     }"}]}