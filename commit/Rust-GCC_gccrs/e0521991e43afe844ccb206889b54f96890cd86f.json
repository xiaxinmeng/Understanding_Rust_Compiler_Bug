{"sha": "e0521991e43afe844ccb206889b54f96890cd86f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTA1MjE5OTFlNDNhZmU4NDRjY2IyMDY4ODliNTRmOTY4OTBjZDg2Zg==", "commit": {"author": {"name": "Ira Rosen", "email": "ira.rosen@linaro.org", "date": "2011-09-15T10:46:39Z"}, "committer": {"name": "Ira Rosen", "email": "irar@gcc.gnu.org", "date": "2011-09-15T10:46:39Z"}, "message": "tree-vect-data-refs.c (vect_analyze_data_ref_dependence): Allow read-after-read dependencies in basic block SLP.\n\n\n        * tree-vect-data-refs.c (vect_analyze_data_ref_dependence): Allow\n        read-after-read dependencies in basic block SLP.\n\nFrom-SVN: r178880", "tree": {"sha": "8a5f476c165afd0e2738bb275d1440f1422fb7dc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8a5f476c165afd0e2738bb275d1440f1422fb7dc"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e0521991e43afe844ccb206889b54f96890cd86f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e0521991e43afe844ccb206889b54f96890cd86f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e0521991e43afe844ccb206889b54f96890cd86f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e0521991e43afe844ccb206889b54f96890cd86f/comments", "author": null, "committer": null, "parents": [{"sha": "4178104336ad9164e960a27477dbd974fb835b48", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4178104336ad9164e960a27477dbd974fb835b48", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4178104336ad9164e960a27477dbd974fb835b48"}], "stats": {"total": 71, "additions": 71, "deletions": 0}, "files": [{"sha": "7c44c12781296632ffd2078d029ca2d637f22d27", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e0521991e43afe844ccb206889b54f96890cd86f/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e0521991e43afe844ccb206889b54f96890cd86f/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=e0521991e43afe844ccb206889b54f96890cd86f", "patch": "@@ -1,3 +1,8 @@\n+2011-09-15  Ira Rosen  <ira.rosen@linaro.org>\n+\n+\t* tree-vect-data-refs.c (vect_analyze_data_ref_dependence): Allow\n+\tread-after-read dependencies in basic block SLP.\n+\n 2011-09-14  Richard Sandiford  <rdsandiford@googlemail.com>\n \n \t* config/sparc/sparc.md: Use match_test rather than eq/ne symbol_ref"}, {"sha": "71e748d8514202cfb2d8abd5b795abb0f8138119", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e0521991e43afe844ccb206889b54f96890cd86f/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e0521991e43afe844ccb206889b54f96890cd86f/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=e0521991e43afe844ccb206889b54f96890cd86f", "patch": "@@ -1,3 +1,7 @@\n+2011-09-15  Ira Rosen  <ira.rosen@linaro.org>\n+\n+\t* gcc.dg/vect/bb-slp-25.c: New.\n+\n 2011-09-14  Paolo Carlini  <paolo.carlini@oracle.com>\n \n \tPR c++/50391"}, {"sha": "6834960b545e723810fbb9449c1c1355566c2546", "filename": "gcc/testsuite/gcc.dg/vect/bb-slp-25.c", "status": "added", "additions": 57, "deletions": 0, "changes": 57, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e0521991e43afe844ccb206889b54f96890cd86f/gcc%2Ftestsuite%2Fgcc.dg%2Fvect%2Fbb-slp-25.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e0521991e43afe844ccb206889b54f96890cd86f/gcc%2Ftestsuite%2Fgcc.dg%2Fvect%2Fbb-slp-25.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fvect%2Fbb-slp-25.c?ref=e0521991e43afe844ccb206889b54f96890cd86f", "patch": "@@ -0,0 +1,57 @@\n+/* { dg-require-effective-target vect_int } */\n+\n+#include <stdarg.h>\n+#include \"tree-vect.h\"\n+\n+#define A 3\n+#define B 4\n+#define N 256\n+\n+short src[N], dst[N];\n+\n+void foo (short * __restrict dst, short * __restrict src, int h, int stride)\n+{\n+  int i;\n+  h /= 16;\n+  for (i = 0; i < h; i++)\n+    {\n+      dst[0] += A*src[0] + src[stride];\n+      dst[1] += A*src[1] + src[1+stride];\n+      dst[2] += A*src[2] + src[2+stride];\n+      dst[3] += A*src[3] + src[3+stride];\n+      dst[4] += A*src[4] + src[4+stride];\n+      dst[5] += A*src[5] + src[5+stride];\n+      dst[6] += A*src[6] + src[6+stride];\n+      dst[7] += A*src[7] + src[7+stride];\n+      dst += 8;\n+      src += 8;\n+   }\n+}\n+\n+\n+int main (void)\n+{\n+  int i;\n+\n+  check_vect ();\n+\n+  for (i = 0; i < N; i++)\n+    {\n+       dst[i] = 0;\n+       src[i] = i;\n+    }\n+\n+  foo (dst, src, N, 8);\n+\n+  for (i = 0; i < N/2; i++)\n+    {\n+      if (dst[i] != A * i + i + 8)\n+        abort ();\n+    }\n+\n+  return 0;\n+}\n+\n+/* { dg-final { scan-tree-dump-times \"basic block vectorized using SLP\" 1 \"slp\" { target vect_element_align } } } */\n+/* { dg-final { cleanup-tree-dump \"slp\" } } */\n+"}, {"sha": "33ccf347ff9719f4af339393e2a912cb4be2a5ba", "filename": "gcc/tree-vect-data-refs.c", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e0521991e43afe844ccb206889b54f96890cd86f/gcc%2Ftree-vect-data-refs.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e0521991e43afe844ccb206889b54f96890cd86f/gcc%2Ftree-vect-data-refs.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-vect-data-refs.c?ref=e0521991e43afe844ccb206889b54f96890cd86f", "patch": "@@ -607,6 +607,11 @@ vect_analyze_data_ref_dependence (struct data_dependence_relation *ddr,\n       if (vect_check_interleaving (dra, drb))\n          return false;\n \n+      /* Read-read is OK (we need this check here, after checking for\n+         interleaving).  */\n+      if (DR_IS_READ (dra) && DR_IS_READ (drb))\n+        return false;\n+\n       if (vect_print_dump_info (REPORT_DR_DETAILS))\n         {\n           fprintf (vect_dump, \"can't determine dependence between \");"}]}