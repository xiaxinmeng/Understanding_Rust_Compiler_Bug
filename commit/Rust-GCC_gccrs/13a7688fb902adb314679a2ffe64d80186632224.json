{"sha": "13a7688fb902adb314679a2ffe64d80186632224", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTNhNzY4OGZiOTAyYWRiMzE0Njc5YTJmZmU2NGQ4MDE4NjYzMjIyNA==", "commit": {"author": {"name": "Thomas Koenig", "email": "tkoenig@gcc.gnu.org", "date": "2018-03-27T17:28:35Z"}, "committer": {"name": "Thomas Koenig", "email": "tkoenig@gcc.gnu.org", "date": "2018-03-27T17:28:35Z"}, "message": "re PR fortran/85083 (ICE in gfc_convert_to_structure_constructor, at fortran/primary.c:2915)\n\n2018-03-27  Thomas Koenig  <tkoenig@gcc.gnu.org>\n\tHarald Anlauf  <anlauf@gmx.de>\n\n\tPR fortran/85083\n\t* primary.c (gfc_convert_to_structure_constructor): Check\n\tconformance of argument types in structure constructor.\n\n2018-03-27  Thomas Koenig  <tkoenig@gcc.gnu.org>\n\tHarald Anlauf  <anlauf@gmx.de>\n\n\t* gfortran.dg/structure_constructor_15.f90: New test.\n\n\nCo-Authored-By: Harald Anlauf <anlauf@gmx.de>\n\nFrom-SVN: r258899", "tree": {"sha": "a049c882fae34daa94adcf65ee9555e470d33f69", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a049c882fae34daa94adcf65ee9555e470d33f69"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/13a7688fb902adb314679a2ffe64d80186632224", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/13a7688fb902adb314679a2ffe64d80186632224", "html_url": "https://github.com/Rust-GCC/gccrs/commit/13a7688fb902adb314679a2ffe64d80186632224", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/13a7688fb902adb314679a2ffe64d80186632224/comments", "author": null, "committer": null, "parents": [{"sha": "d555040fc4c7e7b023c23e5c0f4889936a154ca9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d555040fc4c7e7b023c23e5c0f4889936a154ca9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d555040fc4c7e7b023c23e5c0f4889936a154ca9"}], "stats": {"total": 25, "additions": 25, "deletions": 0}, "files": [{"sha": "fb0f04e47f02a5f64258da62e3b4be733274c75e", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/13a7688fb902adb314679a2ffe64d80186632224/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/13a7688fb902adb314679a2ffe64d80186632224/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=13a7688fb902adb314679a2ffe64d80186632224", "patch": "@@ -1,3 +1,10 @@\n+2018-03-27  Thomas Koenig  <tkoenig@gcc.gnu.org>\n+\tHarald Anlauf  <anlauf@gmx.de>\n+\n+\tPR fortran/85083\n+\t* primary.c (gfc_convert_to_structure_constructor): Check\n+\tconformance of argument types in structure constructor.\n+\n 2018-03-26  Thomas Koenig  <tkoenig@gcc.gnu.org>\n \n \tPR fortran/66709"}, {"sha": "094f2101bbc553fb27f375eac8195e4e0a2a974c", "filename": "gcc/fortran/primary.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/13a7688fb902adb314679a2ffe64d80186632224/gcc%2Ffortran%2Fprimary.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/13a7688fb902adb314679a2ffe64d80186632224/gcc%2Ffortran%2Fprimary.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fprimary.c?ref=13a7688fb902adb314679a2ffe64d80186632224", "patch": "@@ -2898,6 +2898,7 @@ gfc_convert_to_structure_constructor (gfc_expr *e, gfc_symbol *sym, gfc_expr **c\n       if (this_comp->ts.type == BT_CHARACTER && !this_comp->attr.allocatable\n \t  && this_comp->ts.u.cl && this_comp->ts.u.cl->length\n \t  && this_comp->ts.u.cl->length->expr_type == EXPR_CONSTANT\n+\t  && actual->expr->ts.type == BT_CHARACTER\n \t  && actual->expr->expr_type == EXPR_CONSTANT)\n \t{\n \t  ptrdiff_t c, e;"}, {"sha": "642bf15852b3dcd1e6d4f497c449d8bfd0c9675d", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/13a7688fb902adb314679a2ffe64d80186632224/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/13a7688fb902adb314679a2ffe64d80186632224/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=13a7688fb902adb314679a2ffe64d80186632224", "patch": "@@ -1,3 +1,8 @@\n+2018-03-27  Thomas Koenig  <tkoenig@gcc.gnu.org>\n+\tHarald Anlauf  <anlauf@gmx.de>\n+\n+\t* gfortran.dg/structure_constructor_15.f90: New test.\n+\n 2018-03-27  Volker Reichelt  <v.reichelt@netcologne.de>\n \n \t* g++.dg/cpp0x/defaulted2.C: Use dg-message instead of dg-error"}, {"sha": "583e3abafe1a2e7976ef25bfbd7e5bbda102f846", "filename": "gcc/testsuite/gfortran.dg/structure_constructor_15.f90", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/13a7688fb902adb314679a2ffe64d80186632224/gcc%2Ftestsuite%2Fgfortran.dg%2Fstructure_constructor_15.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/13a7688fb902adb314679a2ffe64d80186632224/gcc%2Ftestsuite%2Fgfortran.dg%2Fstructure_constructor_15.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fstructure_constructor_15.f90?ref=13a7688fb902adb314679a2ffe64d80186632224", "patch": "@@ -0,0 +1,12 @@\n+! { dg-do compile }\n+! PR 85083\n+!\n+! Testcase from PR by G. Steinmetz  <gscfq@t-online.de>\n+!\n+program p\n+  type t\n+     character(3) :: c\n+  end type t\n+  type(t), allocatable :: z\n+  allocate (z, source=t(.true.,'abc')) ! { dg-error \"Too many components\" }\n+end"}]}