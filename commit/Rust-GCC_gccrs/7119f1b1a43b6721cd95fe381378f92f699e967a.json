{"sha": "7119f1b1a43b6721cd95fe381378f92f699e967a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzExOWYxYjFhNDNiNjcyMWNkOTVmZTM4MTM3OGY5MmY2OTllOTY3YQ==", "commit": {"author": {"name": "Martin Liska", "email": "mliska@suse.cz", "date": "2016-07-07T13:11:05Z"}, "committer": {"name": "Martin Liska", "email": "marxin@gcc.gnu.org", "date": "2016-07-07T13:11:05Z"}, "message": "Add PRED_FORTRAN_LOOP_PREHEADER to DO loops with step\n\n\t* trans-stmt.c (gfc_trans_do): Add expect builtin for DO\n\tloops with step bigger than +-1.\n\t* gfortran.dg/predict-1.f90: Ammend the test.\n\t* gfortran.dg/predict-2.f90: Likewise.\n\nFrom-SVN: r238112", "tree": {"sha": "f77f660ff41bf265a42fa278057b4c34ae6acd64", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f77f660ff41bf265a42fa278057b4c34ae6acd64"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7119f1b1a43b6721cd95fe381378f92f699e967a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7119f1b1a43b6721cd95fe381378f92f699e967a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7119f1b1a43b6721cd95fe381378f92f699e967a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7119f1b1a43b6721cd95fe381378f92f699e967a/comments", "author": {"login": "marxin", "id": 2658545, "node_id": "MDQ6VXNlcjI2NTg1NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/2658545?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marxin", "html_url": "https://github.com/marxin", "followers_url": "https://api.github.com/users/marxin/followers", "following_url": "https://api.github.com/users/marxin/following{/other_user}", "gists_url": "https://api.github.com/users/marxin/gists{/gist_id}", "starred_url": "https://api.github.com/users/marxin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marxin/subscriptions", "organizations_url": "https://api.github.com/users/marxin/orgs", "repos_url": "https://api.github.com/users/marxin/repos", "events_url": "https://api.github.com/users/marxin/events{/privacy}", "received_events_url": "https://api.github.com/users/marxin/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "0e77949e878dd109ee7daffcda12faa1a8000d29", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0e77949e878dd109ee7daffcda12faa1a8000d29", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0e77949e878dd109ee7daffcda12faa1a8000d29"}], "stats": {"total": 31, "additions": 24, "deletions": 7}, "files": [{"sha": "983e75f5f6d558ae412e5cc06fccbf07fa6a70e6", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7119f1b1a43b6721cd95fe381378f92f699e967a/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7119f1b1a43b6721cd95fe381378f92f699e967a/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=7119f1b1a43b6721cd95fe381378f92f699e967a", "patch": "@@ -1,3 +1,8 @@\n+2016-07-07  Martin Liska  <mliska@suse.cz>\n+\n+\t* trans-stmt.c (gfc_trans_do): Add expect builtin for DO\n+\tloops with step bigger than +-1.\n+\n 2016-07-05  Alessandro Fanfarillo  <fanfarillo.gcc@gmail.com>\n \n \t* array.c (gfc_match_array_ref): Add parsing support for"}, {"sha": "ad88273c8762c719e2742651dca0b7c94576d66d", "filename": "gcc/fortran/trans-stmt.c", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7119f1b1a43b6721cd95fe381378f92f699e967a/gcc%2Ffortran%2Ftrans-stmt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7119f1b1a43b6721cd95fe381378f92f699e967a/gcc%2Ffortran%2Ftrans-stmt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-stmt.c?ref=7119f1b1a43b6721cd95fe381378f92f699e967a", "patch": "@@ -2109,7 +2109,8 @@ gfc_trans_do (gfc_code * code, tree exit_cond)\n       pos = build2 (COMPOUND_EXPR, void_type_node,\n \t\t    fold_build2 (MODIFY_EXPR, void_type_node,\n \t\t\t\t countm1, tmp2),\n-\t\t    build3_loc (loc, COND_EXPR, void_type_node, tmp,\n+\t\t    build3_loc (loc, COND_EXPR, void_type_node,\n+\t\t\t\tgfc_unlikely (tmp, PRED_FORTRAN_LOOP_PREHEADER),\n \t\t\t\tbuild1_loc (loc, GOTO_EXPR, void_type_node,\n \t\t\t\t\t    exit_label), NULL_TREE));\n \n@@ -2123,7 +2124,8 @@ gfc_trans_do (gfc_code * code, tree exit_cond)\n       neg = build2 (COMPOUND_EXPR, void_type_node,\n \t\t    fold_build2 (MODIFY_EXPR, void_type_node,\n \t\t\t\t countm1, tmp2),\n-\t\t    build3_loc (loc, COND_EXPR, void_type_node, tmp,\n+\t\t    build3_loc (loc, COND_EXPR, void_type_node,\n+\t\t\t\tgfc_unlikely (tmp, PRED_FORTRAN_LOOP_PREHEADER),\n \t\t\t\tbuild1_loc (loc, GOTO_EXPR, void_type_node,\n \t\t\t\t\t    exit_label), NULL_TREE));\n "}, {"sha": "cdc7c06ecbe9f7f3896c11ab885d6edb1ccdff9c", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7119f1b1a43b6721cd95fe381378f92f699e967a/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7119f1b1a43b6721cd95fe381378f92f699e967a/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=7119f1b1a43b6721cd95fe381378f92f699e967a", "patch": "@@ -1,3 +1,8 @@\n+2016-07-07  Martin Liska  <mliska@suse.cz>\n+\n+\t* gfortran.dg/predict-1.f90: Ammend the test.\n+\t* gfortran.dg/predict-2.f90: Likewise.\n+\n 2016-07-07  Ilya Enkovich  <ilya.enkovich@intel.com>\n \n \tPR ipa/71624"}, {"sha": "a3feea9b12383d6dff0781be3b783c92aca29cf0", "filename": "gcc/testsuite/gfortran.dg/predict-1.f90", "status": "modified", "additions": 7, "deletions": 2, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7119f1b1a43b6721cd95fe381378f92f699e967a/gcc%2Ftestsuite%2Fgfortran.dg%2Fpredict-1.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7119f1b1a43b6721cd95fe381378f92f699e967a/gcc%2Ftestsuite%2Fgfortran.dg%2Fpredict-1.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpredict-1.f90?ref=7119f1b1a43b6721cd95fe381378f92f699e967a", "patch": "@@ -4,9 +4,14 @@\n subroutine test(block, array)\n integer :: i, block(9), array(2)\n \n-do i = array(1), array(2)\n+do i = array(1), array(2), 2\n     block(i) = i\n end do\n+\n+do i = array(1), array(2), -2\n+    block(i) = block(i) + i\n+end do\n+\n end subroutine test\n \n-! { dg-final { scan-tree-dump-times \"Fortran loop preheader heuristics of edge\\[^:\\]*: 99.0%\" 1 \"profile_estimate\" } }\n+! { dg-final { scan-tree-dump-times \"Fortran loop preheader heuristics of edge\\[^:\\]*: 1.0%\" 2 \"profile_estimate\" } }"}, {"sha": "11a9ec5fd4b37e9ca76140da424102df6e73a532", "filename": "gcc/testsuite/gfortran.dg/predict-2.f90", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7119f1b1a43b6721cd95fe381378f92f699e967a/gcc%2Ftestsuite%2Fgfortran.dg%2Fpredict-2.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7119f1b1a43b6721cd95fe381378f92f699e967a/gcc%2Ftestsuite%2Fgfortran.dg%2Fpredict-2.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpredict-2.f90?ref=7119f1b1a43b6721cd95fe381378f92f699e967a", "patch": "@@ -4,12 +4,12 @@\n subroutine test(block, array)\n integer :: i,j, block(9), array(2)\n \n-do i = array(1), array(2)\n-    do j = array(1), array(2)\n+do i = array(1), array(2), 2\n+    do j = array(1), array(2), 3\n        block(i) = j\n     end do\n end do\n end subroutine test\n \n ! { dg-final { scan-tree-dump-times \"Fortran loop preheader heuristics of edge\" 2 \"profile_estimate\" } }\n-! { dg-final { scan-tree-dump-times \"loop gueard\" 0 \"profile_estimate\" } }\n+! { dg-final { scan-tree-dump-times \"loop guard\" 0 \"profile_estimate\" } }"}]}