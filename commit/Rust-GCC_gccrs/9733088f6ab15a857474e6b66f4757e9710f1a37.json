{"sha": "9733088f6ab15a857474e6b66f4757e9710f1a37", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTczMzA4OGY2YWIxNWE4NTc0NzRlNmI2NmY0NzU3ZTk3MTBmMWEzNw==", "commit": {"author": {"name": "Tristan Gingold", "email": "gingold@adacore.com", "date": "2015-10-23T13:01:23Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2015-10-23T13:01:23Z"}, "message": "utils2.c (build_call_alloc_dealloc): Check no implicit task and protected object restrictions.\n\n2015-10-23  Tristan Gingold  <gingold@adacore.com>\n\n\t* gcc-interface/utils2.c (build_call_alloc_dealloc): Check no implicit\n\ttask and protected object restrictions.\n\nFrom-SVN: r229252", "tree": {"sha": "1037042989730774aecb88482c90ea06c6ea176f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1037042989730774aecb88482c90ea06c6ea176f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9733088f6ab15a857474e6b66f4757e9710f1a37", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9733088f6ab15a857474e6b66f4757e9710f1a37", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9733088f6ab15a857474e6b66f4757e9710f1a37", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9733088f6ab15a857474e6b66f4757e9710f1a37/comments", "author": {"login": "gingold-adacore", "id": 16334725, "node_id": "MDQ6VXNlcjE2MzM0NzI1", "avatar_url": "https://avatars.githubusercontent.com/u/16334725?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gingold-adacore", "html_url": "https://github.com/gingold-adacore", "followers_url": "https://api.github.com/users/gingold-adacore/followers", "following_url": "https://api.github.com/users/gingold-adacore/following{/other_user}", "gists_url": "https://api.github.com/users/gingold-adacore/gists{/gist_id}", "starred_url": "https://api.github.com/users/gingold-adacore/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gingold-adacore/subscriptions", "organizations_url": "https://api.github.com/users/gingold-adacore/orgs", "repos_url": "https://api.github.com/users/gingold-adacore/repos", "events_url": "https://api.github.com/users/gingold-adacore/events{/privacy}", "received_events_url": "https://api.github.com/users/gingold-adacore/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "6f99dcec636ac8bd0aec5ff9eec9cc6627d4889e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6f99dcec636ac8bd0aec5ff9eec9cc6627d4889e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6f99dcec636ac8bd0aec5ff9eec9cc6627d4889e"}], "stats": {"total": 14, "additions": 12, "deletions": 2}, "files": [{"sha": "28cc00cf8e0f5b5d758cfadf950f8204525e8561", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9733088f6ab15a857474e6b66f4757e9710f1a37/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9733088f6ab15a857474e6b66f4757e9710f1a37/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=9733088f6ab15a857474e6b66f4757e9710f1a37", "patch": "@@ -1,3 +1,8 @@\n+2015-10-23  Tristan Gingold  <gingold@adacore.com>\n+\n+\t* gcc-interface/utils2.c (build_call_alloc_dealloc): Check no implicit\n+\ttask and protected object restrictions.\n+\n 2015-10-23  Hristian Kirtchev  <kirtchev@adacore.com>\n \n \t* sem_ch12.adb, exp_ch6.adb: Minor reformatting."}, {"sha": "ce1a2f2dcb34a6c9404dbeda26ae311d488dcd14", "filename": "gcc/ada/gcc-interface/utils2.c", "status": "modified", "additions": 7, "deletions": 2, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9733088f6ab15a857474e6b66f4757e9710f1a37/gcc%2Fada%2Fgcc-interface%2Futils2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9733088f6ab15a857474e6b66f4757e9710f1a37/gcc%2Fada%2Fgcc-interface%2Futils2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgcc-interface%2Futils2.c?ref=9733088f6ab15a857474e6b66f4757e9710f1a37", "patch": "@@ -2329,8 +2329,13 @@ build_call_alloc_dealloc (tree gnu_obj, tree gnu_size, tree gnu_type,\n \n       /* Check that we aren't violating the associated restriction.  */\n       if (!(Nkind (gnat_node) == N_Allocator && Comes_From_Source (gnat_node)))\n-\tCheck_No_Implicit_Heap_Alloc (gnat_node);\n-\n+\t{\n+\t  Check_No_Implicit_Heap_Alloc (gnat_node);\n+\t  if (Has_Task (Etype (gnat_node)))\n+\t    Check_No_Implicit_Task_Alloc (gnat_node);\n+\t  if (Has_Protected (Etype (gnat_node)))\n+\t    Check_No_Implicit_Protected_Alloc (gnat_node);\n+\t}\n       return maybe_wrap_malloc (gnu_size, gnu_type, gnat_node);\n     }\n }"}]}