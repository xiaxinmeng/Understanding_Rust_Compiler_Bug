{"sha": "a5a635fc4331b6d5f1a1e688e1153abd2ff194a5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTVhNjM1ZmM0MzMxYjZkNWYxYTFlNjg4ZTExNTNhYmQyZmYxOTRhNQ==", "commit": {"author": {"name": "Peixin Qiao", "email": "qiaopeixin@huawei.com", "date": "2020-08-19T09:55:19Z"}, "committer": {"name": "Richard Sandiford", "email": "richard.sandiford@arm.com", "date": "2020-08-19T09:55:19Z"}, "message": "AArch64: Remove \"fndecl && TREE_PUBLIC (fndecl)\" in aarch64_init_cumulative_args\n\nThis check will prevent the function type check of static funtion or calling\nvia a funtion pointer. The function type should be checked no matter if the\nfunction has external linkage.\n\ngcc/ChangeLog:\n\n\t* config/aarch64/aarch64.c (aarch64_init_cumulative_args): Remove\n\t\"fndecl && TREE_PUBLIC (fndecl)\" check since it prevents the funtion\n\ttype check when calling via a function pointer or when calling a static\n\tfunction.\n\ngcc/testsuite/ChangeLog:\n\n\t* gcc.target/aarch64/mgeneral-regs_7.c: New test.", "tree": {"sha": "455c613912a61f70a419f2c9c967a97e9eeb4326", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/455c613912a61f70a419f2c9c967a97e9eeb4326"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a5a635fc4331b6d5f1a1e688e1153abd2ff194a5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a5a635fc4331b6d5f1a1e688e1153abd2ff194a5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a5a635fc4331b6d5f1a1e688e1153abd2ff194a5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a5a635fc4331b6d5f1a1e688e1153abd2ff194a5/comments", "author": {"login": "PeixinQiao", "id": 86228265, "node_id": "MDQ6VXNlcjg2MjI4MjY1", "avatar_url": "https://avatars.githubusercontent.com/u/86228265?v=4", "gravatar_id": "", "url": "https://api.github.com/users/PeixinQiao", "html_url": "https://github.com/PeixinQiao", "followers_url": "https://api.github.com/users/PeixinQiao/followers", "following_url": "https://api.github.com/users/PeixinQiao/following{/other_user}", "gists_url": "https://api.github.com/users/PeixinQiao/gists{/gist_id}", "starred_url": "https://api.github.com/users/PeixinQiao/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/PeixinQiao/subscriptions", "organizations_url": "https://api.github.com/users/PeixinQiao/orgs", "repos_url": "https://api.github.com/users/PeixinQiao/repos", "events_url": "https://api.github.com/users/PeixinQiao/events{/privacy}", "received_events_url": "https://api.github.com/users/PeixinQiao/received_events", "type": "User", "site_admin": false}, "committer": {"login": "rsandifo-arm", "id": 28043039, "node_id": "MDQ6VXNlcjI4MDQzMDM5", "avatar_url": "https://avatars.githubusercontent.com/u/28043039?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rsandifo-arm", "html_url": "https://github.com/rsandifo-arm", "followers_url": "https://api.github.com/users/rsandifo-arm/followers", "following_url": "https://api.github.com/users/rsandifo-arm/following{/other_user}", "gists_url": "https://api.github.com/users/rsandifo-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/rsandifo-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rsandifo-arm/subscriptions", "organizations_url": "https://api.github.com/users/rsandifo-arm/orgs", "repos_url": "https://api.github.com/users/rsandifo-arm/repos", "events_url": "https://api.github.com/users/rsandifo-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/rsandifo-arm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7dbcb569b2793be8748050f91ea8a089bc2623c8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7dbcb569b2793be8748050f91ea8a089bc2623c8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7dbcb569b2793be8748050f91ea8a089bc2623c8"}], "stats": {"total": 12, "additions": 11, "deletions": 1}, "files": [{"sha": "b6d74496cd0b287024121aa3cccf7f87de57310f", "filename": "gcc/config/aarch64/aarch64.c", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a5a635fc4331b6d5f1a1e688e1153abd2ff194a5/gcc%2Fconfig%2Faarch64%2Faarch64.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a5a635fc4331b6d5f1a1e688e1153abd2ff194a5/gcc%2Fconfig%2Faarch64%2Faarch64.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Faarch64%2Faarch64.c?ref=a5a635fc4331b6d5f1a1e688e1153abd2ff194a5", "patch": "@@ -6017,7 +6017,6 @@ aarch64_init_cumulative_args (CUMULATIVE_ARGS *pcum,\n \n   if (!silent_p\n       && !TARGET_FLOAT\n-      && fndecl && TREE_PUBLIC (fndecl)\n       && fntype && fntype != error_mark_node)\n     {\n       const_tree type = TREE_TYPE (fntype);"}, {"sha": "3998947987c0cd74c182453f1824d94a52142f28", "filename": "gcc/testsuite/gcc.target/aarch64/mgeneral-regs_7.c", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a5a635fc4331b6d5f1a1e688e1153abd2ff194a5/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fmgeneral-regs_7.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a5a635fc4331b6d5f1a1e688e1153abd2ff194a5/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fmgeneral-regs_7.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fmgeneral-regs_7.c?ref=a5a635fc4331b6d5f1a1e688e1153abd2ff194a5", "patch": "@@ -0,0 +1,11 @@\n+/* { dg-options \"-mgeneral-regs-only\" } */\n+\n+typedef int v4si __attribute__ ((__vector_size__ ((16))));\n+\n+v4si (*foo) ();\n+\n+void\n+f0 (v4si *ptr)\n+{\n+  *ptr = foo (); /* { dg-error \"'-mgeneral-regs-only' is incompatible with the use of vector types\" } */\n+}"}]}