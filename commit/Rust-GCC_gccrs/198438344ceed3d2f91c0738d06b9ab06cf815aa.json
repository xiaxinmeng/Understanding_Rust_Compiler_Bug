{"sha": "198438344ceed3d2f91c0738d06b9ab06cf815aa", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTk4NDM4MzQ0Y2VlZDNkMmY5MWMwNzM4ZDA2YjlhYjA2Y2Y4MTVhYQ==", "commit": {"author": {"name": "Mark Mitchell", "email": "mark@codesourcery.com", "date": "2005-10-03T17:21:40Z"}, "committer": {"name": "Mark Mitchell", "email": "mmitchel@gcc.gnu.org", "date": "2005-10-03T17:21:40Z"}, "message": "re PR c++/17775 (-frepo with function template in anonymous namespace fails to compile)\n\n\tPR c++/17775\n\t* repo.c: Include flags.h.\n\t(finish_repo): Add -frandom-seed to the arguments.\n\tPR c++/17775\n\t* g++.dg/template/repo4.C: New test.\n\nFrom-SVN: r104898", "tree": {"sha": "fea276bce4881692ca7bc5a18c1dab22b21c6519", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/fea276bce4881692ca7bc5a18c1dab22b21c6519"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/198438344ceed3d2f91c0738d06b9ab06cf815aa", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/198438344ceed3d2f91c0738d06b9ab06cf815aa", "html_url": "https://github.com/Rust-GCC/gccrs/commit/198438344ceed3d2f91c0738d06b9ab06cf815aa", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/198438344ceed3d2f91c0738d06b9ab06cf815aa/comments", "author": null, "committer": null, "parents": [{"sha": "39d164680db36b49c69e1d55cc0913153741fcba", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/39d164680db36b49c69e1d55cc0913153741fcba", "html_url": "https://github.com/Rust-GCC/gccrs/commit/39d164680db36b49c69e1d55cc0913153741fcba"}], "stats": {"total": 39, "additions": 38, "deletions": 1}, "files": [{"sha": "6ccc3f971250412686114c6706740871e8568248", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/198438344ceed3d2f91c0738d06b9ab06cf815aa/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/198438344ceed3d2f91c0738d06b9ab06cf815aa/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=198438344ceed3d2f91c0738d06b9ab06cf815aa", "patch": "@@ -1,3 +1,9 @@\n+2005-10-03  Mark Mitchell  <mark@codesourcery.com>\n+\n+\tPR c++/17775\n+\t* repo.c: Include flags.h.\n+\t(finish_repo): Add -frandom-seed to the arguments.\n+\n 2005-10-02  Mark Mitchell  <mark@codesourcery.com>\n \n \tPR c++/22621"}, {"sha": "eee3b87f8d3da81d776b0c95598c407d866ff495", "filename": "gcc/cp/repo.c", "status": "modified", "additions": 11, "deletions": 1, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/198438344ceed3d2f91c0738d06b9ab06cf815aa/gcc%2Fcp%2Frepo.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/198438344ceed3d2f91c0738d06b9ab06cf815aa/gcc%2Fcp%2Frepo.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Frepo.c?ref=198438344ceed3d2f91c0738d06b9ab06cf815aa", "patch": "@@ -36,6 +36,7 @@ Boston, MA 02110-1301, USA.  */\n #include \"obstack.h\"\n #include \"toplev.h\"\n #include \"diagnostic.h\"\n+#include \"flags.h\"\n \n static char *extract_string (char **);\n static const char *get_base_filename (const char *);\n@@ -239,7 +240,16 @@ finish_repo (void)\n   fprintf (repo_file, \"D %s\\n\", dir);\n   args = getenv (\"COLLECT_GCC_OPTIONS\");\n   if (args)\n-    fprintf (repo_file, \"A %s\\n\", args);\n+    {\n+      fprintf (repo_file, \"A %s\", args);\n+      /* If -frandom-seed is not among the ARGS, then add the value\n+\t that we chose.  That will ensure that the names of types from\n+\t anonymous namespaces will get the same mangling when this\n+\t file is recompiled.  */\n+      if (!strstr (args, \"'-frandom-seed=\"))\n+\tfprintf (repo_file, \" '-frandom-seed=%s'\", flag_random_seed);\n+      fprintf (repo_file, \"\\n\");\n+    }\n \n   for (t = pending_repo; t; t = TREE_CHAIN (t))\n     {"}, {"sha": "ecb578e1146f5369d5c371b4860e0eac8f6ae611", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/198438344ceed3d2f91c0738d06b9ab06cf815aa/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/198438344ceed3d2f91c0738d06b9ab06cf815aa/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=198438344ceed3d2f91c0738d06b9ab06cf815aa", "patch": "@@ -1,3 +1,8 @@\n+2005-10-03  Mark Mitchell  <mark@codesourcery.com>\n+\n+\tPR c++/17775\n+\t* g++.dg/template/repo4.C: New test.\n+\n 2005-10-03  Francois-Xavier Coudert  <coudert@clipper.ens.fr>\n \n \tPR libfortran/19308"}, {"sha": "bd07f9580f9bbd83659b785a1de811bc7779dcbb", "filename": "gcc/testsuite/g++.dg/template/repo4.C", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/198438344ceed3d2f91c0738d06b9ab06cf815aa/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Frepo4.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/198438344ceed3d2f91c0738d06b9ab06cf815aa/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Frepo4.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Frepo4.C?ref=198438344ceed3d2f91c0738d06b9ab06cf815aa", "patch": "@@ -0,0 +1,16 @@\n+// PR c++/17775\n+// { dg-options \"-frepo\" }\n+// { dg-final { cleanup-repo-files } }\n+\n+namespace { \n+  struct Foo {}; \n+} \n+ \n+template <typename Tp> \n+void foo(Tp) {} \n+ \n+int \n+main() \n+{ \n+  foo(Foo()); \n+} "}]}