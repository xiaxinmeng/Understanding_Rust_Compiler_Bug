{"sha": "a6092975367388a74307ea5c40eb539ad83a1fb1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTYwOTI5NzUzNjczODhhNzQzMDdlYTVjNDBlYjUzOWFkODNhMWZiMQ==", "commit": {"author": {"name": "Geoff Keating", "email": "geoffk@cygnus.com", "date": "1999-10-28T20:37:37Z"}, "committer": {"name": "Geoffrey Keating", "email": "geoffk@gcc.gnu.org", "date": "1999-10-28T20:37:37Z"}, "message": "flow.c (propagate_block): When the last reference to a label before an ADDR_VEC is deleted because the...\n\n* flow.c (propagate_block): When the last reference to a label\nbefore an ADDR_VEC is deleted because the reference is a dead\nstore, delete the ADDR_VEC.\n\nFrom-SVN: r30247", "tree": {"sha": "61d216c911f0d0d3176bf1ca4b90cc34802a10e7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/61d216c911f0d0d3176bf1ca4b90cc34802a10e7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a6092975367388a74307ea5c40eb539ad83a1fb1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a6092975367388a74307ea5c40eb539ad83a1fb1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a6092975367388a74307ea5c40eb539ad83a1fb1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a6092975367388a74307ea5c40eb539ad83a1fb1/comments", "author": null, "committer": null, "parents": [{"sha": "af05822029866791f4fb4a241ac5f0bc529c09cf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/af05822029866791f4fb4a241ac5f0bc529c09cf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/af05822029866791f4fb4a241ac5f0bc529c09cf"}], "stats": {"total": 40, "additions": 40, "deletions": 0}, "files": [{"sha": "97e54f562c0b5d8591b48fa1475b098b4d480e4f", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a6092975367388a74307ea5c40eb539ad83a1fb1/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a6092975367388a74307ea5c40eb539ad83a1fb1/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=a6092975367388a74307ea5c40eb539ad83a1fb1", "patch": "@@ -1,3 +1,9 @@\n+Fri Oct 29 06:32:44 1999  Geoffrey Keating  <geoffk@cygnus.com>\n+\n+\t* flow.c (propagate_block): When the last reference to a label\n+ \tbefore an ADDR_VEC is deleted because the reference is a dead\n+ \tstore, delete the ADDR_VEC.\n+\n Thu Oct 28 12:28:50 1999  Richard Henderson  <rth@cygnus.com>\n \n \t* resource.c (find_free_register): Don't use the frame pointer"}, {"sha": "8758ea81cd0278b992f938334bf361c83b0f7aa5", "filename": "gcc/flow.c", "status": "modified", "additions": 34, "deletions": 0, "changes": 34, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a6092975367388a74307ea5c40eb539ad83a1fb1/gcc%2Fflow.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a6092975367388a74307ea5c40eb539ad83a1fb1/gcc%2Fflow.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fflow.c?ref=a6092975367388a74307ea5c40eb539ad83a1fb1", "patch": "@@ -3321,6 +3321,40 @@ propagate_block (old, first, last, significant, bnum, flags)\n \t     can cause trouble for first or last insn in a basic block.  */\n \t  if ((flags & PROP_KILL_DEAD_CODE) && insn_is_dead)\n \t    {\n+\t      rtx inote;\n+\t      /* If the insn referred to a label, note that the label is\n+\t\t now less used.  */\n+\t      for (inote = REG_NOTES (insn); inote; inote = XEXP (inote, 1))\n+\t\t{\n+\t\t  if (REG_NOTE_KIND (inote) == REG_LABEL)\n+\t\t    {\n+\t\t      rtx label = XEXP (inote, 0);\n+\t\t      rtx next;\n+\t\t      LABEL_NUSES (label)--;\n+\n+\t\t      /* If this label was attached to an ADDR_VEC, it's\n+\t\t\t safe to delete the ADDR_VEC.  In fact, it's pretty much\n+\t\t\t mandatory to delete it, because the ADDR_VEC may\n+\t\t\t be referencing labels that no longer exist.  */\n+\t\t      if (LABEL_NUSES (label) == 0\n+\t\t\t  && (next = next_nonnote_insn (label)) != NULL\n+\t\t\t  && GET_CODE (next) == JUMP_INSN\n+\t\t\t  && (GET_CODE (PATTERN (next)) == ADDR_VEC\n+\t\t\t      || GET_CODE (PATTERN (next)) == ADDR_DIFF_VEC))\n+\t\t\t{\n+\t\t\t  rtx pat = PATTERN (next);\n+\t\t\t  int diff_vec_p = GET_CODE (pat) == ADDR_DIFF_VEC;\n+\t\t\t  int len = XVECLEN (pat, diff_vec_p);\n+\t\t\t  int i;\n+\t\t\t  for (i = 0; i < len; i++)\n+\t\t\t    LABEL_NUSES (XEXP (XVECEXP (pat, diff_vec_p, i), 0))--;\n+\t\t\t  PUT_CODE (next, NOTE);\n+\t\t\t  NOTE_LINE_NUMBER (next) = NOTE_INSN_DELETED;\n+\t\t\t  NOTE_SOURCE_FILE (next) = 0;\n+\t\t\t}\n+\t\t    }\n+\t\t}\n+\n \t      PUT_CODE (insn, NOTE);\n \t      NOTE_LINE_NUMBER (insn) = NOTE_INSN_DELETED;\n \t      NOTE_SOURCE_FILE (insn) = 0;"}]}