{"sha": "03ce701abb566ddc1b756db9c713c0150f7acb49", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDNjZTcwMWFiYjU2NmRkYzFiNzU2ZGI5YzcxM2MwMTUwZjdhY2I0OQ==", "commit": {"author": {"name": "John David Anglin", "email": "danglin@gcc.gnu.org", "date": "2014-12-22T23:10:18Z"}, "committer": {"name": "John David Anglin", "email": "danglin@gcc.gnu.org", "date": "2014-12-22T23:10:18Z"}, "message": "re PR target/55023 (hppa: wrong code generated with tail call optimisation)\n\n\tPR target/55023\n\t* dse.c (scan_insn): Treat sibling call as though it does a wild read.\n\t* testsuite/gcc.dg/pr55023.c: New file.\n\nFrom-SVN: r219037", "tree": {"sha": "fd53c8b633e81a3820dcf82d29ebefed910b42b5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/fd53c8b633e81a3820dcf82d29ebefed910b42b5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/03ce701abb566ddc1b756db9c713c0150f7acb49", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/03ce701abb566ddc1b756db9c713c0150f7acb49", "html_url": "https://github.com/Rust-GCC/gccrs/commit/03ce701abb566ddc1b756db9c713c0150f7acb49", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/03ce701abb566ddc1b756db9c713c0150f7acb49/comments", "author": null, "committer": null, "parents": [{"sha": "5341599ab6d3c313e779c8ded61844acd1283649", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5341599ab6d3c313e779c8ded61844acd1283649", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5341599ab6d3c313e779c8ded61844acd1283649"}], "stats": {"total": 53, "additions": 53, "deletions": 0}, "files": [{"sha": "9f0408506a52a95235a7fe303f54944fb232fc1b", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/03ce701abb566ddc1b756db9c713c0150f7acb49/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/03ce701abb566ddc1b756db9c713c0150f7acb49/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=03ce701abb566ddc1b756db9c713c0150f7acb49", "patch": "@@ -1,3 +1,8 @@\n+2014-12-22  John David Anglin  <danglin@gcc.gnu.org>\n+\n+\tPR target/55023\n+\t* dse.c (scan_insn): Treat sibling call as though it does a wild read.\n+\n 2014-12-22  Bin Cheng  <bin.cheng@arm.com>\n \n \tPR rtl-optimization/62151"}, {"sha": "3a7f31c1b83b73b34e4be3dbf385130e46d5f556", "filename": "gcc/dse.c", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/03ce701abb566ddc1b756db9c713c0150f7acb49/gcc%2Fdse.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/03ce701abb566ddc1b756db9c713c0150f7acb49/gcc%2Fdse.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdse.c?ref=03ce701abb566ddc1b756db9c713c0150f7acb49", "patch": "@@ -2483,6 +2483,17 @@ scan_insn (bb_info_t bb_info, rtx_insn *insn)\n \n       insn_info->cannot_delete = true;\n \n+      /* Arguments for a sibling call that are pushed to memory are passed\n+\t using the incoming argument pointer of the current function.  These\n+\t may or may not be frame related depending on the target.  Since\n+\t argument pointer related stores are not currently tracked, we treat\n+\t a sibling call as though it does a wild read.  */\n+      if (SIBLING_CALL_P (insn))\n+\t{\n+\t  add_wild_read (bb_info);\n+\t  return;\n+\t}\n+\n       /* Const functions cannot do anything bad i.e. read memory,\n \t however, they can read their parameters which may have\n \t been pushed onto the stack."}, {"sha": "9337c95374e92fed985193d8cc8df38e7a2aedb1", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/03ce701abb566ddc1b756db9c713c0150f7acb49/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/03ce701abb566ddc1b756db9c713c0150f7acb49/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=03ce701abb566ddc1b756db9c713c0150f7acb49", "patch": "@@ -1,3 +1,7 @@\n+2014-12-22  John David Anglin  <danglin@gcc.gnu.org>\n+\n+\t* gcc.dg/pr55023.c: New file.\n+\n 2014-12-22  Francois-Xavier Coudert  <fxcoudert@gcc.gnu.org>\n \n \t* lib/ubsan-dg.exp: Add library path for libstdc++."}, {"sha": "8f6b300b17bb469e1488b5037349f8f0abe7404d", "filename": "gcc/testsuite/gcc.dg/pr55023.c", "status": "added", "additions": 33, "deletions": 0, "changes": 33, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/03ce701abb566ddc1b756db9c713c0150f7acb49/gcc%2Ftestsuite%2Fgcc.dg%2Fpr55023.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/03ce701abb566ddc1b756db9c713c0150f7acb49/gcc%2Ftestsuite%2Fgcc.dg%2Fpr55023.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr55023.c?ref=03ce701abb566ddc1b756db9c713c0150f7acb49", "patch": "@@ -0,0 +1,33 @@\n+/* PR rtl-optimization/55023 */\n+/* { dg-do run } */\n+/* { dg-options \"-O2 -fno-inline\" } */\n+\n+extern void abort (void);\n+typedef long long int64_t;\n+\n+struct foo {\n+    int x;\n+    int y;\n+};\n+\n+int64_t foo(int64_t a, int64_t b, int64_t c)\n+{\n+    return a + b + c;\n+}\n+\n+int64_t bar(int64_t a, struct foo bq, struct foo cq)\n+{\n+    int64_t b = bq.x + bq.y;\n+    int64_t c = cq.x + cq.y;\n+    return foo(a, b, c);\n+}\n+\n+int main(void)\n+{\n+  int64_t a = 1;\n+  struct foo b = { 2, 3 };\n+  struct foo c = { 4, 5 };\n+  if (bar (a, b, c) != 15)\n+    abort ();\n+  return 0;\n+}"}]}