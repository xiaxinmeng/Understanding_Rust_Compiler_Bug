{"sha": "eb9cb0fc5e0c945f8f2bc0d3acaf4fbba7acfe6b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWI5Y2IwZmM1ZTBjOTQ1ZjhmMmJjMGQzYWNhZjRmYmJhN2FjZmU2Yg==", "commit": {"author": {"name": "Ed Schonberg", "email": "schonberg@adacore.com", "date": "2009-04-29T13:20:27Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2009-04-29T13:20:27Z"}, "message": "exp_ch9.ads, [...] (Build_Wrapper_Spec): Use source line of primitive operation...\n\n2009-04-29  Ed Schonberg  <schonberg@adacore.com>\n\n\t* exp_ch9.ads, exp_ch9.adb (Build_Wrapper_Spec): Use source line of\n\tprimitive operation, rather than source line of synchronized type, when\n\tbuilding the wrapper for a primitive operation that overrides an\n\toperation inherited from a progenitor, to improve the error message on\n\tduplicate declarations.\n\n\t* sem_ch3.adb (Process_Full_View): Use new signature of\n\tBuild_Wrapper_Spec.\n\nFrom-SVN: r146961", "tree": {"sha": "c48d51fc9f53affdb580ed2ce609b90d8439b495", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c48d51fc9f53affdb580ed2ce609b90d8439b495"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/eb9cb0fc5e0c945f8f2bc0d3acaf4fbba7acfe6b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/eb9cb0fc5e0c945f8f2bc0d3acaf4fbba7acfe6b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/eb9cb0fc5e0c945f8f2bc0d3acaf4fbba7acfe6b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/eb9cb0fc5e0c945f8f2bc0d3acaf4fbba7acfe6b/comments", "author": {"login": "Edschonberg", "id": 6352375, "node_id": "MDQ6VXNlcjYzNTIzNzU=", "avatar_url": "https://avatars.githubusercontent.com/u/6352375?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Edschonberg", "html_url": "https://github.com/Edschonberg", "followers_url": "https://api.github.com/users/Edschonberg/followers", "following_url": "https://api.github.com/users/Edschonberg/following{/other_user}", "gists_url": "https://api.github.com/users/Edschonberg/gists{/gist_id}", "starred_url": "https://api.github.com/users/Edschonberg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Edschonberg/subscriptions", "organizations_url": "https://api.github.com/users/Edschonberg/orgs", "repos_url": "https://api.github.com/users/Edschonberg/repos", "events_url": "https://api.github.com/users/Edschonberg/events{/privacy}", "received_events_url": "https://api.github.com/users/Edschonberg/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "7f7d37cbf136d4d43dec8d70b0d8308bd3cc4459", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7f7d37cbf136d4d43dec8d70b0d8308bd3cc4459", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7f7d37cbf136d4d43dec8d70b0d8308bd3cc4459"}], "stats": {"total": 61, "additions": 36, "deletions": 25}, "files": [{"sha": "46a198f367fa89b001f13322c83d9a52a0d534f0", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eb9cb0fc5e0c945f8f2bc0d3acaf4fbba7acfe6b/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eb9cb0fc5e0c945f8f2bc0d3acaf4fbba7acfe6b/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=eb9cb0fc5e0c945f8f2bc0d3acaf4fbba7acfe6b", "patch": "@@ -1,3 +1,14 @@\n+2009-04-29  Ed Schonberg  <schonberg@adacore.com>\n+\n+\t* exp_ch9.ads, exp_ch9.adb (Build_Wrapper_Spec): Use source line of\n+\tprimitive operation, rather than source line of synchronized type, when\n+\tbuilding the wrapper for a primitive operation that overrides an\n+\toperation inherited from a progenitor, to improve the error message on\n+\tduplicate declarations.\n+\n+\t* sem_ch3.adb (Process_Full_View): Use new signature of\n+\tBuild_Wrapper_Spec.\n+\n 2009-04-29  Robert Dewar  <dewar@adacore.com>\n \n \t* prj-nmsc.ads: Minor reformatting"}, {"sha": "ddaa632f0ba0df29871f8d78e7c619315de0890c", "filename": "gcc/ada/exp_ch9.adb", "status": "modified", "additions": 13, "deletions": 13, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eb9cb0fc5e0c945f8f2bc0d3acaf4fbba7acfe6b/gcc%2Fada%2Fexp_ch9.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eb9cb0fc5e0c945f8f2bc0d3acaf4fbba7acfe6b/gcc%2Fada%2Fexp_ch9.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fexp_ch9.adb?ref=eb9cb0fc5e0c945f8f2bc0d3acaf4fbba7acfe6b", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 B o d y                                  --\n --                                                                          --\n---          Copyright (C) 1992-2008, Free Software Foundation, Inc.         --\n+--          Copyright (C) 1992-2009, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -1599,7 +1599,7 @@ package body Exp_Ch9 is\n          Body_Spec : Node_Id;\n \n       begin\n-         Body_Spec := Build_Wrapper_Spec (Loc, Subp_Id, Obj_Typ, Formals);\n+         Body_Spec := Build_Wrapper_Spec (Subp_Id, Obj_Typ, Formals);\n \n          --  The subprogram is not overriding or is not a primitive declared\n          --  between two views.\n@@ -1776,11 +1776,11 @@ package body Exp_Ch9 is\n    ------------------------\n \n    function Build_Wrapper_Spec\n-     (Loc     : Source_Ptr;\n-      Subp_Id : Entity_Id;\n+     (Subp_Id : Entity_Id;\n       Obj_Typ : Entity_Id;\n       Formals : List_Id) return Node_Id\n    is\n+      Loc           : constant Source_Ptr := Sloc (Subp_Id);\n       First_Param   : Node_Id;\n       Iface         : Entity_Id;\n       Iface_Elmt    : Elmt_Id;\n@@ -2147,18 +2147,18 @@ package body Exp_Ch9 is\n                  and then Ekind (Defining_Identifier (Decl)) = E_Entry\n                then\n                   Wrap_Spec :=\n-                    Build_Wrapper_Spec (Loc,\n-                      Subp_Id => Defining_Identifier (Decl),\n-                      Obj_Typ => Rec_Typ,\n-                      Formals => Parameter_Specifications (Decl));\n+                    Build_Wrapper_Spec\n+                      (Subp_Id => Defining_Identifier (Decl),\n+                       Obj_Typ => Rec_Typ,\n+                       Formals => Parameter_Specifications (Decl));\n \n                elsif Nkind (Decl) = N_Subprogram_Declaration then\n                   Wrap_Spec :=\n-                    Build_Wrapper_Spec (Loc,\n-                      Subp_Id => Defining_Unit_Name (Specification (Decl)),\n-                      Obj_Typ => Rec_Typ,\n-                      Formals =>\n-                        Parameter_Specifications (Specification (Decl)));\n+                    Build_Wrapper_Spec\n+                      (Subp_Id => Defining_Unit_Name (Specification (Decl)),\n+                       Obj_Typ => Rec_Typ,\n+                       Formals =>\n+                         Parameter_Specifications (Specification (Decl)));\n                end if;\n \n                if Present (Wrap_Spec) then"}, {"sha": "8e795e12c0f64fb7590a3f39e8d0ec00d87b0966", "filename": "gcc/ada/exp_ch9.ads", "status": "modified", "additions": 5, "deletions": 4, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eb9cb0fc5e0c945f8f2bc0d3acaf4fbba7acfe6b/gcc%2Fada%2Fexp_ch9.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eb9cb0fc5e0c945f8f2bc0d3acaf4fbba7acfe6b/gcc%2Fada%2Fexp_ch9.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fexp_ch9.ads?ref=eb9cb0fc5e0c945f8f2bc0d3acaf4fbba7acfe6b", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 S p e c                                  --\n --                                                                          --\n---          Copyright (C) 1992-2008, Free Software Foundation, Inc.         --\n+--          Copyright (C) 1992-2009, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -154,8 +154,7 @@ package Exp_Ch9 is\n    --  Build_Task_Allocate_Block.\n \n    function Build_Wrapper_Spec\n-     (Loc     : Source_Ptr;\n-      Subp_Id : Entity_Id;\n+     (Subp_Id : Entity_Id;\n       Obj_Typ : Entity_Id;\n       Formals : List_Id) return Node_Id;\n    --  Ada 2005 (AI-345): Build the specification of a primitive operation\n@@ -203,7 +202,9 @@ package Exp_Ch9 is\n    --  routine to make sure Complete_Master is called on exit).\n \n    procedure Expand_Access_Protected_Subprogram_Type (N : Node_Id);\n-   --  Build Equivalent_Type for an Access_to_protected_Subprogram\n+   --  Build Equivalent_Type for an Access_To_Protected_Subprogram.\n+   --  Equivalent_Type is a record type with two components: a pointer\n+   --  to the protected object, and a pointer to the operation itself.\n \n    procedure Expand_Accept_Declarations (N : Node_Id; Ent : Entity_Id);\n    --  Expand declarations required for accept statement. See bodies of"}, {"sha": "114e217986f7c57db1635c6c67cdc2af6dbda08b", "filename": "gcc/ada/sem_ch3.adb", "status": "modified", "additions": 7, "deletions": 8, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eb9cb0fc5e0c945f8f2bc0d3acaf4fbba7acfe6b/gcc%2Fada%2Fsem_ch3.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eb9cb0fc5e0c945f8f2bc0d3acaf4fbba7acfe6b/gcc%2Fada%2Fsem_ch3.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch3.adb?ref=eb9cb0fc5e0c945f8f2bc0d3acaf4fbba7acfe6b", "patch": "@@ -16262,7 +16262,6 @@ package body Sem_Ch3 is\n                   declare\n                      Conc_Typ  : constant Entity_Id :=\n                                    Corresponding_Record_Type (Full_T);\n-                     Loc       : constant Source_Ptr := Sloc (Conc_Typ);\n                      Curr_Nod  : Node_Id := Parent (Conc_Typ);\n                      Wrap_Spec : Node_Id;\n \n@@ -16274,14 +16273,14 @@ package body Sem_Ch3 is\n                           and then not Is_Abstract_Subprogram (Prim)\n                         then\n                            Wrap_Spec :=\n-                             Make_Subprogram_Declaration (Loc,\n+                             Make_Subprogram_Declaration (Sloc (Prim),\n                                Specification =>\n-                                 Build_Wrapper_Spec (Loc,\n-                                   Subp_Id => Prim,\n-                                   Obj_Typ => Conc_Typ,\n-                                   Formals =>\n-                                     Parameter_Specifications (\n-                                       Parent (Prim))));\n+                                 Build_Wrapper_Spec\n+                                   (Subp_Id => Prim,\n+                                    Obj_Typ => Conc_Typ,\n+                                    Formals =>\n+                                      Parameter_Specifications (\n+                                        Parent (Prim))));\n \n                            Insert_After (Curr_Nod, Wrap_Spec);\n                            Curr_Nod := Wrap_Spec;"}]}