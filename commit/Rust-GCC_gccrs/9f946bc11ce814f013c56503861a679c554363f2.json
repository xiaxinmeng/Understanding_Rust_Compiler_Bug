{"sha": "9f946bc11ce814f013c56503861a679c554363f2", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWY5NDZiYzExY2U4MTRmMDEzYzU2NTAzODYxYTY3OWM1NTQzNjNmMg==", "commit": {"author": {"name": "Richard Sandiford", "email": "rdsandiford@googlemail.com", "date": "2010-05-20T22:20:34Z"}, "committer": {"name": "Richard Sandiford", "email": "rsandifo@gcc.gnu.org", "date": "2010-05-20T22:20:34Z"}, "message": "config.gcc (mips*-sde-elf*): Don't use sdemtk.opt.\n\n2010-05-08  Richard Sandiford  <rdsandiford@googlemail.com>\n\t    Jim Wilson  <wilson@codesourcery.com>\n\ngcc/\n\t* config.gcc (mips*-sde-elf*): Don't use sdemtk.opt.\n\t* config/mips/mips.h (TARGET_CPU_CPP_BUILTINS): Define __mips_no_float\n\tfor TARGET_NO_FLOAT.\n\t* config/mips/mips.c (mips_file_start): Expand conditional expression\n\tinto \"if\" statements.  Use .gnu_attribute 4,0 for TARGET_NO_FLOAT.\n\t(mips_override_options): Move -mno-float override -msoft-float and\n\t-mhard-float.\n\t* config/mips/mips.opt (mno-float): Move from sdemtk.opt, but add\n\tCondition(TARGET_SUPPORTS_NO_FLOAT).\n\t* config/mips/sdemtk.h (TARGET_OS_CPP_BUILTINS): Don't set\n\t__mips_no_float here.\n\t(SUBTARGET_OVERRIDE_OPTIONS): Delete.\n\t(TARGET_SUPPORTS_NO_FLOAT): Define.\n\t* config/mips/sdemtk.opt: Delete.\n\nFrom-SVN: r159642", "tree": {"sha": "62e4fd7aaae919b494f584ff11e5ca1b23bc66d5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/62e4fd7aaae919b494f584ff11e5ca1b23bc66d5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9f946bc11ce814f013c56503861a679c554363f2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9f946bc11ce814f013c56503861a679c554363f2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9f946bc11ce814f013c56503861a679c554363f2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9f946bc11ce814f013c56503861a679c554363f2/comments", "author": {"login": "rsandifo", "id": 4235983, "node_id": "MDQ6VXNlcjQyMzU5ODM=", "avatar_url": "https://avatars.githubusercontent.com/u/4235983?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rsandifo", "html_url": "https://github.com/rsandifo", "followers_url": "https://api.github.com/users/rsandifo/followers", "following_url": "https://api.github.com/users/rsandifo/following{/other_user}", "gists_url": "https://api.github.com/users/rsandifo/gists{/gist_id}", "starred_url": "https://api.github.com/users/rsandifo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rsandifo/subscriptions", "organizations_url": "https://api.github.com/users/rsandifo/orgs", "repos_url": "https://api.github.com/users/rsandifo/repos", "events_url": "https://api.github.com/users/rsandifo/events{/privacy}", "received_events_url": "https://api.github.com/users/rsandifo/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "4ed44cccdd2243a585cd3beb4bb3fbe616e7d156", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4ed44cccdd2243a585cd3beb4bb3fbe616e7d156", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4ed44cccdd2243a585cd3beb4bb3fbe616e7d156"}], "stats": {"total": 101, "additions": 56, "deletions": 45}, "files": [{"sha": "5687a0c295ed3b318dd2d5ea19d432b515bfec3b", "filename": "gcc/ChangeLog", "status": "modified", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9f946bc11ce814f013c56503861a679c554363f2/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9f946bc11ce814f013c56503861a679c554363f2/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=9f946bc11ce814f013c56503861a679c554363f2", "patch": "@@ -1,3 +1,20 @@\n+2010-05-20  Richard Sandiford  <rdsandiford@googlemail.com>\n+\n+\t* config.gcc (mips*-sde-elf*): Don't use sdemtk.opt.\n+\t* config/mips/mips.h (TARGET_CPU_CPP_BUILTINS): Define __mips_no_float\n+\tfor TARGET_NO_FLOAT.\n+\t* config/mips/mips.c (mips_file_start): Expand conditional expression\n+\tinto \"if\" statements.  Use .gnu_attribute 4,0 for TARGET_NO_FLOAT.\n+\t(mips_override_options): Move -mno-float override -msoft-float and\n+\t-mhard-float.\n+\t* config/mips/mips.opt (mno-float): Move from sdemtk.opt, but add\n+\tCondition(TARGET_SUPPORTS_NO_FLOAT).\n+\t* config/mips/sdemtk.h (TARGET_OS_CPP_BUILTINS): Don't set\n+\t__mips_no_float here.\n+\t(SUBTARGET_OVERRIDE_OPTIONS): Delete.\n+\t(TARGET_SUPPORTS_NO_FLOAT): Define.\n+\t* config/mips/sdemtk.opt: Delete.\n+\n 2010-05-20  Segher Boessenkool  <segher@kernel.crashing.org>\n \n \t* ipa-prop.c (compute_complex_ancestor_jump_func): Bail"}, {"sha": "06e694baded1968e6f454f05f878bb5a5f24b029", "filename": "gcc/config.gcc", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9f946bc11ce814f013c56503861a679c554363f2/gcc%2Fconfig.gcc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9f946bc11ce814f013c56503861a679c554363f2/gcc%2Fconfig.gcc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig.gcc?ref=9f946bc11ce814f013c56503861a679c554363f2", "patch": "@@ -1760,7 +1760,6 @@ mips*-sde-elf*)\n \t    # MIPS toolkit libraries.\n \t    tm_file=\"$tm_file mips/sdemtk.h\"\n \t    tmake_file=\"$tmake_file mips/t-sdemtk\"\n-\t    extra_options=\"$extra_options mips/sdemtk.opt\"\n \t    case ${enable_threads} in\n \t      \"\" | yes | mipssde)\n \t\tthread_file='mipssde'"}, {"sha": "9c897c24ef888467323f7c183f3b12d5bd5f670c", "filename": "gcc/config/mips/mips.c", "status": "modified", "additions": 28, "deletions": 4, "changes": 32, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9f946bc11ce814f013c56503861a679c554363f2/gcc%2Fconfig%2Fmips%2Fmips.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9f946bc11ce814f013c56503861a679c554363f2/gcc%2Fconfig%2Fmips%2Fmips.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.c?ref=9f946bc11ce814f013c56503861a679c554363f2", "patch": "@@ -8172,10 +8172,27 @@ mips_file_start (void)\n \t\t \"\\t.previous\\n\", TARGET_LONG64 ? 64 : 32);\n \n #ifdef HAVE_AS_GNU_ATTRIBUTE\n-      fprintf (asm_out_file, \"\\t.gnu_attribute 4, %d\\n\",\n-\t       (TARGET_HARD_FLOAT_ABI\n-\t\t? (TARGET_DOUBLE_FLOAT\n-\t\t   ? ((!TARGET_64BIT && TARGET_FLOAT64) ? 4 : 1) : 2) : 3));\n+      {\n+\tint attr;\n+\n+\t/* No floating-point operations, -mno-float.  */\n+\tif (TARGET_NO_FLOAT)\n+\t  attr = 0;\n+\t/* Soft-float code, -msoft-float.  */\n+\telse if (!TARGET_HARD_FLOAT_ABI)\n+\t  attr = 3;\n+\t/* Single-float code, -msingle-float.  */\n+\telse if (!TARGET_DOUBLE_FLOAT)\n+\t  attr = 2;\n+\t/* 64-bit FP registers on a 32-bit target, -mips32r2 -mfp64.  */\n+\telse if (!TARGET_64BIT && TARGET_FLOAT64)\n+\t  attr = 4;\n+\t/* Regular FP code, FP regs same size as GP regs, -mdouble-float.  */\n+\telse\n+\t  attr = 1;\n+\n+\tfprintf (asm_out_file, \"\\t.gnu_attribute 4, %d\\n\", attr);\n+      }\n #endif\n     }\n \n@@ -15405,6 +15422,13 @@ mips_override_options (void)\n   SUBTARGET_OVERRIDE_OPTIONS;\n #endif\n \n+  /* -mno-float overrides -mhard-float and -msoft-float.  */\n+  if (TARGET_NO_FLOAT)\n+    {\n+      target_flags |= MASK_SOFT_FLOAT_ABI;\n+      target_flags_explicit |= MASK_SOFT_FLOAT_ABI;\n+    }\n+\n   /* Set the small data limit.  */\n   mips_small_data_threshold = (g_switch_set\n \t\t\t       ? g_switch_value"}, {"sha": "dcac46ba45acf5abc20ef169d60f18424198a9b5", "filename": "gcc/config/mips/mips.h", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9f946bc11ce814f013c56503861a679c554363f2/gcc%2Fconfig%2Fmips%2Fmips.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9f946bc11ce814f013c56503861a679c554363f2/gcc%2Fconfig%2Fmips%2Fmips.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.h?ref=9f946bc11ce814f013c56503861a679c554363f2", "patch": "@@ -536,7 +536,9 @@ enum mips_code_readable_setting {\n \t\t\t\t\t\t\t\t\t\\\n       /* These defines reflect the ABI in use, not whether the  \t\\\n \t FPU is directly accessible.  */\t\t\t\t\\\n-      if (TARGET_HARD_FLOAT_ABI)\t\t\t\t\t\\\n+      if (TARGET_NO_FLOAT)\t\t\t\t\t\t\\\n+\tbuiltin_define (\"__mips_no_float\");\t\t\t\t\\\n+      else if (TARGET_HARD_FLOAT_ABI)\t\t\t\t\t\\\n \tbuiltin_define (\"__mips_hard_float\");\t\t\t\t\\\n       else\t\t\t\t\t\t\t\t\\\n \tbuiltin_define (\"__mips_soft_float\");\t\t\t\t\\"}, {"sha": "94714878debbc5c7808054f52235d4c02ff2606a", "filename": "gcc/config/mips/mips.opt", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9f946bc11ce814f013c56503861a679c554363f2/gcc%2Fconfig%2Fmips%2Fmips.opt", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9f946bc11ce814f013c56503861a679c554363f2/gcc%2Fconfig%2Fmips%2Fmips.opt", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.opt?ref=9f946bc11ce814f013c56503861a679c554363f2", "patch": "@@ -224,6 +224,10 @@ mmt\n Target Report Var(TARGET_MT)\n Allow the use of MT instructions\n \n+mno-float\n+Target Report RejectNegative Var(TARGET_NO_FLOAT) Condition(TARGET_SUPPORTS_NO_FLOAT)\n+Prevent the use of all floating-point operations\n+\n mno-flush-func\n Target RejectNegative\n Do not use a cache-flushing function before calling stack trampolines"}, {"sha": "e927a6021b1de7409668f532c583c8ec7bba5a95", "filename": "gcc/config/mips/sdemtk.h", "status": "modified", "additions": 4, "deletions": 16, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9f946bc11ce814f013c56503861a679c554363f2/gcc%2Fconfig%2Fmips%2Fsdemtk.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9f946bc11ce814f013c56503861a679c554363f2/gcc%2Fconfig%2Fmips%2Fsdemtk.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fsdemtk.h?ref=9f946bc11ce814f013c56503861a679c554363f2", "patch": "@@ -35,10 +35,7 @@ along with GCC; see the file COPYING3.  If not see\n \tbuiltin_define (\"__mipsfp64\");\t\t\t\\\n \t\t\t\t\t\t\t\\\n       if (TARGET_NO_FLOAT) \t\t\t\t\\\n-\t{\t\t\t\t\t\t\\\n-\t  builtin_define (\"__NO_FLOAT\");\t\t\\\n-\t  builtin_define (\"__mips_no_float\");\t\t\\\n-\t}\t\t\t\t\t\t\\\n+\tbuiltin_define (\"__NO_FLOAT\");\t\t\t\\\n       else if (TARGET_SOFT_FLOAT_ABI)\t\t\t\\\n \tbuiltin_define (\"__SOFT_FLOAT\");\t\t\\\n       else if (TARGET_SINGLE_FLOAT)\t\t\t\\\n@@ -57,18 +54,6 @@ along with GCC; see the file COPYING3.  If not see\n     }\t\t\t\t\t\t\t\\\n   while (0)\n \n-#undef SUBTARGET_OVERRIDE_OPTIONS\n-#define SUBTARGET_OVERRIDE_OPTIONS\t\t\t\\\n-  do\t\t\t\t\t\t\t\\\n-    {\t\t\t\t\t\t\t\\\n-      if (TARGET_NO_FLOAT)\t\t\t\t\\\n-\t{\t\t\t\t\t\t\\\n-\t  target_flags |= MASK_SOFT_FLOAT_ABI;\t\t\\\n-\t  target_flags_explicit |= MASK_SOFT_FLOAT_ABI;\t\\\n-\t}\t\t\t\t\t\t\\\n-    }\t\t\t\t\t\t\t\\\n-  while (0)\n-\n /* For __clear_cache in libgcc2.c.  */\n #ifdef IN_LIBGCC2\n extern void mips_sync_icache (void *beg, unsigned long len);\n@@ -113,3 +98,6 @@ extern void mips_sync_icache (void *beg, unsigned long len);\n /* ...nor does the call sequence preserve $31.  */\n #undef MIPS_SAVE_REG_FOR_PROFILING_P\n #define MIPS_SAVE_REG_FOR_PROFILING_P(REGNO) ((REGNO) == RETURN_ADDR_REGNUM)\n+\n+/* Compile in support for the -mno-float option.  */\n+#define TARGET_SUPPORTS_NO_FLOAT 1"}, {"sha": "c1d2949cd8ec831717b5ac55e567bc009d9cc485", "filename": "gcc/config/mips/sdemtk.opt", "status": "removed", "additions": 0, "deletions": 23, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4ed44cccdd2243a585cd3beb4bb3fbe616e7d156/gcc%2Fconfig%2Fmips%2Fsdemtk.opt", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4ed44cccdd2243a585cd3beb4bb3fbe616e7d156/gcc%2Fconfig%2Fmips%2Fsdemtk.opt", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fsdemtk.opt?ref=4ed44cccdd2243a585cd3beb4bb3fbe616e7d156", "patch": "@@ -1,23 +0,0 @@\n-; Options for the MIPS SDE configuration.\n-;\n-; Copyright (C) 2007 Free Software Foundation, Inc.\n-;\n-; This file is part of GCC.\n-;\n-; GCC is free software; you can redistribute it and/or modify it under\n-; the terms of the GNU General Public License as published by the Free\n-; Software Foundation; either version 3, or (at your option) any later\n-; version.\n-;\n-; GCC is distributed in the hope that it will be useful, but WITHOUT\n-; ANY WARRANTY; without even the implied warranty of MERCHANTABILITY\n-; or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public\n-; License for more details.\n-;\n-; You should have received a copy of the GNU General Public License\n-; along with GCC; see the file COPYING3.  If not see\n-; <http://www.gnu.org/licenses/>.\n-\n-mno-float\n-Target Report RejectNegative Var(TARGET_NO_FLOAT)\n-Prevent the use of all floating-point operations"}]}