{"sha": "da2a24c3f60194266096c3b807798fbc20d38a7f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZGEyYTI0YzNmNjAxOTQyNjYwOTZjM2I4MDc3OThmYmMyMGQzOGE3Zg==", "commit": {"author": {"name": "Paul Thomas", "email": "pault@gcc.gnu.org", "date": "2006-11-21T23:42:17Z"}, "committer": {"name": "Paul Thomas", "email": "pault@gcc.gnu.org", "date": "2006-11-21T23:42:17Z"}, "message": "re PR fortran/29820 (ICE in fold_convert, at fold-const.c:2146)\n\n2006-11-21 Paul Thomas  <pault@gcc.gnu.org>\n\n\tPR fortran/29820\n\t* trans-array.c (gfc_get_derived_type): Once done, spread the\n\tbackend_decl to all identical derived types in all sibling\n\tnamespaces.\n\n2006-11-21 Paul Thomas  <pault@gcc.gnu.org>\n\n\tPR fortran/29820\n\t* gfortran.dg/used_types_13.f90: New test.\n\nFrom-SVN: r119073", "tree": {"sha": "4a0682b92c6d4b0d966b0bdbe1c9ef2e7610d2a3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4a0682b92c6d4b0d966b0bdbe1c9ef2e7610d2a3"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/da2a24c3f60194266096c3b807798fbc20d38a7f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/da2a24c3f60194266096c3b807798fbc20d38a7f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/da2a24c3f60194266096c3b807798fbc20d38a7f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/da2a24c3f60194266096c3b807798fbc20d38a7f/comments", "author": null, "committer": null, "parents": [{"sha": "887af464cde973b03e4e95ee3ad13a5c2ea076d8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/887af464cde973b03e4e95ee3ad13a5c2ea076d8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/887af464cde973b03e4e95ee3ad13a5c2ea076d8"}], "stats": {"total": 47, "additions": 42, "deletions": 5}, "files": [{"sha": "bfc6d6db223c8fb8fc9ffe647b0515c812a13634", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/da2a24c3f60194266096c3b807798fbc20d38a7f/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/da2a24c3f60194266096c3b807798fbc20d38a7f/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=da2a24c3f60194266096c3b807798fbc20d38a7f", "patch": "@@ -1,3 +1,10 @@\n+2006-11-21 Paul Thomas  <pault@gcc.gnu.org>\n+\n+\tPR fortran/29820\n+\t* trans-array.c (gfc_get_derived_type): Once done, spread the\n+\tbackend_decl to all identical derived types in all sibling\n+\tnamespaces.\n+\n 2006-11-20  Tobias Burnus  <burnus@net-b.de>\n \n \tPR fortran/27546"}, {"sha": "b1eeffcbbab9a4cd522e5d2d2882fdf584c5896e", "filename": "gcc/fortran/trans-types.c", "status": "modified", "additions": 2, "deletions": 5, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/da2a24c3f60194266096c3b807798fbc20d38a7f/gcc%2Ffortran%2Ftrans-types.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/da2a24c3f60194266096c3b807798fbc20d38a7f/gcc%2Ffortran%2Ftrans-types.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-types.c?ref=da2a24c3f60194266096c3b807798fbc20d38a7f", "patch": "@@ -1608,11 +1608,8 @@ gfc_get_derived_type (gfc_symbol * derived)\n other_equal_dts:\n   /* Add this backend_decl to all the other, equal derived types and\n      their components in this and sibling namespaces.  */\n-\n-  for (dt = derived->ns->derived_types; dt; dt = dt->next)\n-    copy_dt_decls_ifequal (derived, dt->derived);\n-\n-  for (ns = derived->ns->sibling; ns; ns = ns->sibling)\n+  ns = derived->ns->parent ? derived->ns->parent->contained : derived->ns;\n+  for (; ns; ns = ns->sibling)\n     for (dt = ns->derived_types; dt; dt = dt->next)\n       copy_dt_decls_ifequal (derived, dt->derived);\n "}, {"sha": "f4e5182233b2b843289631c1d5f4f7822b4fa3f4", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/da2a24c3f60194266096c3b807798fbc20d38a7f/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/da2a24c3f60194266096c3b807798fbc20d38a7f/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=da2a24c3f60194266096c3b807798fbc20d38a7f", "patch": "@@ -1,3 +1,8 @@\n+2006-11-21 Paul Thomas  <pault@gcc.gnu.org>\n+\n+\tPR fortran/29820\n+\t* gfortran.dg/used_types_13.f90: New test.\n+\n 2006-11-21  Janis Johnson  <janis187@us.ibm.com>\n \n \t* gcc.dg/dfp/snan.c: Delete."}, {"sha": "9208b593333f1f0298066b67b717c03e51b022fc", "filename": "gcc/testsuite/gfortran.dg/used_types_13.f90", "status": "added", "additions": 28, "deletions": 0, "changes": 28, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/da2a24c3f60194266096c3b807798fbc20d38a7f/gcc%2Ftestsuite%2Fgfortran.dg%2Fused_types_13.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/da2a24c3f60194266096c3b807798fbc20d38a7f/gcc%2Ftestsuite%2Fgfortran.dg%2Fused_types_13.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fused_types_13.f90?ref=da2a24c3f60194266096c3b807798fbc20d38a7f", "patch": "@@ -0,0 +1,28 @@\n+! { dg-do compile }\n+! Tests the fix for PR29820, which was another problem with derived type\n+! association.  Not all siblings were being searched for identical types.\n+!\n+! Contributed by Harald Anlauf  <anlauf@gmx.de>\n+!\n+module geo\n+  type geodetic\n+     real :: h\n+  end type geodetic\n+end module geo\n+module gfcbug44\n+  implicit none\n+contains\n+subroutine point ( gp)\n+  use geo\n+  type(geodetic),  intent(out) :: gp\n+  type(geodetic) :: gpx(1)\n+  gp = gpx(1)\n+end subroutine point\n+subroutine plane ()\n+  use geo\n+  type(geodetic)  :: gp\n+  call point ( gp)\n+end subroutine plane\n+end module gfcbug44\n+! { dg-final { cleanup-modules \"geo gfcbug44\" } }\n+"}]}