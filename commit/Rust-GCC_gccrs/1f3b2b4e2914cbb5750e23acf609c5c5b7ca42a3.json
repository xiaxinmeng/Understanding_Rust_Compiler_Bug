{"sha": "1f3b2b4e2914cbb5750e23acf609c5c5b7ca42a3", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWYzYjJiNGUyOTE0Y2JiNTc1MGUyM2FjZjYwOWM1YzViN2NhNDJhMw==", "commit": {"author": {"name": "Alexander Monakov", "email": "amonakov@ispras.ru", "date": "2011-04-08T11:44:51Z"}, "committer": {"name": "Alexander Monakov", "email": "amonakov@gcc.gnu.org", "date": "2011-04-08T11:44:51Z"}, "message": "re PR rtl-optimization/48442 (ICE: in init_seqno, at sel-sched.c:6767 with -Os -fselective-scheduling2 --param max-sched-extend-regions-iters=100)\n\n\tPR rtl-optimization/48442\n\t* sel-sched.c (init_seqno): Remove number_of_insns argument.  Update\n\tall callers.  Adjust assert.\n\ntestsuite:\n\t* gcc.dg/pr48442.c: New.\n\nFrom-SVN: r172173", "tree": {"sha": "54adf3a225a75715a3a100b0d21952a07e4b1cb0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/54adf3a225a75715a3a100b0d21952a07e4b1cb0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1f3b2b4e2914cbb5750e23acf609c5c5b7ca42a3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1f3b2b4e2914cbb5750e23acf609c5c5b7ca42a3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1f3b2b4e2914cbb5750e23acf609c5c5b7ca42a3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1f3b2b4e2914cbb5750e23acf609c5c5b7ca42a3/comments", "author": {"login": "amonakov", "id": 1997391, "node_id": "MDQ6VXNlcjE5OTczOTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1997391?v=4", "gravatar_id": "", "url": "https://api.github.com/users/amonakov", "html_url": "https://github.com/amonakov", "followers_url": "https://api.github.com/users/amonakov/followers", "following_url": "https://api.github.com/users/amonakov/following{/other_user}", "gists_url": "https://api.github.com/users/amonakov/gists{/gist_id}", "starred_url": "https://api.github.com/users/amonakov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/amonakov/subscriptions", "organizations_url": "https://api.github.com/users/amonakov/orgs", "repos_url": "https://api.github.com/users/amonakov/repos", "events_url": "https://api.github.com/users/amonakov/events{/privacy}", "received_events_url": "https://api.github.com/users/amonakov/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "554f1948b9c4fdbf3920666dc5b2814fe821b627", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/554f1948b9c4fdbf3920666dc5b2814fe821b627", "html_url": "https://github.com/Rust-GCC/gccrs/commit/554f1948b9c4fdbf3920666dc5b2814fe821b627"}], "stats": {"total": 64, "additions": 50, "deletions": 14}, "files": [{"sha": "b357ba769390b7736826df2ac531b892c2cfe512", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1f3b2b4e2914cbb5750e23acf609c5c5b7ca42a3/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1f3b2b4e2914cbb5750e23acf609c5c5b7ca42a3/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=1f3b2b4e2914cbb5750e23acf609c5c5b7ca42a3", "patch": "@@ -1,3 +1,9 @@\n+2011-04-08  Alexander Monakov  <amonakov@ispras.ru>\n+\n+\tPR rtl-optimization/48442\n+\t* sel-sched.c (init_seqno): Remove number_of_insns argument.  Update\n+\tall callers.  Adjust assert.\n+\n 2011-04-08  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR tree-optimization/48377"}, {"sha": "0e8173b3dddee8f58eb071281094574d34f0e413", "filename": "gcc/sel-sched.c", "status": "modified", "additions": 12, "deletions": 14, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1f3b2b4e2914cbb5750e23acf609c5c5b7ca42a3/gcc%2Fsel-sched.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1f3b2b4e2914cbb5750e23acf609c5c5b7ca42a3/gcc%2Fsel-sched.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fsel-sched.c?ref=1f3b2b4e2914cbb5750e23acf609c5c5b7ca42a3", "patch": "@@ -6731,15 +6731,14 @@ init_seqno_1 (basic_block bb, sbitmap visited_bbs, bitmap blocks_to_reschedule)\n     INSN_SEQNO (insn) = cur_seqno--;\n }\n \n-/* Initialize seqnos for the current region.  NUMBER_OF_INSNS is the number\n-   of instructions in the region, BLOCKS_TO_RESCHEDULE contains blocks on\n-   which we're rescheduling when pipelining, FROM is the block where\n+/* Initialize seqnos for the current region.  BLOCKS_TO_RESCHEDULE contains\n+   blocks on which we're rescheduling when pipelining, FROM is the block where\n    traversing region begins (it may not be the head of the region when\n    pipelining, but the head of the loop instead).\n \n    Returns the maximal seqno found.  */\n static int\n-init_seqno (int number_of_insns, bitmap blocks_to_reschedule, basic_block from)\n+init_seqno (bitmap blocks_to_reschedule, basic_block from)\n {\n   sbitmap visited_bbs;\n   bitmap_iterator bi;\n@@ -6762,9 +6761,13 @@ init_seqno (int number_of_insns, bitmap blocks_to_reschedule, basic_block from)\n       from = EBB_FIRST_BB (0);\n     }\n \n-  cur_seqno = number_of_insns > 0 ? number_of_insns : sched_max_luid - 1;\n+  cur_seqno = sched_max_luid - 1;\n   init_seqno_1 (from, visited_bbs, blocks_to_reschedule);\n-  gcc_assert (cur_seqno == 0 || number_of_insns == 0);\n+\n+  /* cur_seqno may be positive if the number of instructions is less than\n+     sched_max_luid - 1 (when rescheduling or if some instructions have been\n+     removed by the call to purge_empty_blocks in sel_sched_region_1).  */\n+  gcc_assert (cur_seqno >= 0);\n \n   sbitmap_free (visited_bbs);\n   return sched_max_luid - 1;\n@@ -7473,17 +7476,12 @@ sel_sched_region_2 (int orig_max_seqno)\n static void\n sel_sched_region_1 (void)\n {\n-  int number_of_insns;\n   int orig_max_seqno;\n \n-  /* Remove empty blocks that might be in the region from the beginning.\n-     We need to do save sched_max_luid before that, as it actually shows\n-     the number of insns in the region, and purge_empty_blocks can\n-     alter it.  */\n-  number_of_insns = sched_max_luid - 1;\n+  /* Remove empty blocks that might be in the region from the beginning.  */\n   purge_empty_blocks ();\n \n-  orig_max_seqno = init_seqno (number_of_insns, NULL, NULL);\n+  orig_max_seqno = init_seqno (NULL, NULL);\n   gcc_assert (orig_max_seqno >= 1);\n \n   /* When pipelining outer loops, create fences on the loop header,\n@@ -7560,7 +7558,7 @@ sel_sched_region_1 (void)\n                 {\n                   flist_tail_init (new_fences);\n \n-                  orig_max_seqno = init_seqno (0, blocks_to_reschedule, bb);\n+                  orig_max_seqno = init_seqno (blocks_to_reschedule, bb);\n \n                   /* Mark BB as head of the new ebb.  */\n                   bitmap_set_bit (forced_ebb_heads, bb->index);"}, {"sha": "e311e804439b1b85e040328f70028506288883f7", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1f3b2b4e2914cbb5750e23acf609c5c5b7ca42a3/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1f3b2b4e2914cbb5750e23acf609c5c5b7ca42a3/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=1f3b2b4e2914cbb5750e23acf609c5c5b7ca42a3", "patch": "@@ -1,3 +1,8 @@\n+2011-04-08  Alexander Monakov  <amonakov@ispras.ru>\n+\n+\tPR rtl-optimization/48442\n+\t* gcc.dg/pr48442.c: New.\n+\n 2011-04-08  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR tree-optimization/48377"}, {"sha": "88e3497b11de549b98ba2f00bd0d339dab77bd57", "filename": "gcc/testsuite/gcc.dg/pr48442.c", "status": "added", "additions": 27, "deletions": 0, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1f3b2b4e2914cbb5750e23acf609c5c5b7ca42a3/gcc%2Ftestsuite%2Fgcc.dg%2Fpr48442.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1f3b2b4e2914cbb5750e23acf609c5c5b7ca42a3/gcc%2Ftestsuite%2Fgcc.dg%2Fpr48442.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr48442.c?ref=1f3b2b4e2914cbb5750e23acf609c5c5b7ca42a3", "patch": "@@ -0,0 +1,27 @@\n+/* { dg-do compile { target powerpc*-*-* ia64-*-* i?86-*-* x86_64-*-* } } */\n+/* { dg-options \"-Os -fselective-scheduling2 --param max-sched-extend-regions-iters=100\" } */\n+void f (void)\n+{\n+  unsigned *a2;\n+  int vertex2;\n+  int c, x2, dx2, dy2, s2;\n+  long m, b;\n+  do\n+    {\n+      if (dx2)\n+\tdx2 = dx2 % dy2;\n+\ts2 = (dx2 / dy2);\n+    }\n+  while (vertex2);\n+  for (;;)\n+    {\n+      c = x2;\n+      a2 = 0;\n+      if (c)\n+\t{\n+\t  m = b << (c);\n+\t  *a2 = (*a2 & ~m);\n+\t}\n+      x2 += s2;\n+    }\n+}"}]}