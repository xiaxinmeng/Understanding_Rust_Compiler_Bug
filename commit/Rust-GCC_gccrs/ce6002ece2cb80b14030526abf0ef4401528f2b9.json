{"sha": "ce6002ece2cb80b14030526abf0ef4401528f2b9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Y2U2MDAyZWNlMmNiODBiMTQwMzA1MjZhYmYwZWY0NDAxNTI4ZjJiOQ==", "commit": {"author": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2012-03-15T09:09:31Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2012-03-15T09:09:31Z"}, "message": "[multiple changes]\n\n2012-03-15  Vincent Pucci  <pucci@adacore.com>\n\n\t* sem_ch4.adb (Analyze_Quantified_Expression):\n\tPreanalyze the condition when the quantified expression will be\n\tfurther expanded.\n\n2012-03-15  Yannick Moy  <moy@adacore.com>\n\n\t* sem_prag.adb, sem_util.adb, sem_util.ads, sem_attr.adb, sem_ch6.adb,\n\tsem_warn.adb: Minor refactoring, renaming Case_Pragma in CTC_Pragma,\n\tto refer to both Test_Case pragma and Contract_Case pragma (same\n\tacronym as in Spec_CTC_List).\n\nFrom-SVN: r185419", "tree": {"sha": "5665a991cf87d1cc1e6f22bae76850f022ff663a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5665a991cf87d1cc1e6f22bae76850f022ff663a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ce6002ece2cb80b14030526abf0ef4401528f2b9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ce6002ece2cb80b14030526abf0ef4401528f2b9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ce6002ece2cb80b14030526abf0ef4401528f2b9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ce6002ece2cb80b14030526abf0ef4401528f2b9/comments", "author": null, "committer": null, "parents": [{"sha": "b285815ef53ed6215fc2493b40a38cf4e8041b71", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b285815ef53ed6215fc2493b40a38cf4e8041b71", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b285815ef53ed6215fc2493b40a38cf4e8041b71"}], "stats": {"total": 83, "additions": 54, "deletions": 29}, "files": [{"sha": "45a53bbd88a4272fc791c9d8c73992c989f7f6aa", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ce6002ece2cb80b14030526abf0ef4401528f2b9/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ce6002ece2cb80b14030526abf0ef4401528f2b9/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=ce6002ece2cb80b14030526abf0ef4401528f2b9", "patch": "@@ -1,3 +1,16 @@\n+2012-03-15  Vincent Pucci  <pucci@adacore.com>\n+\n+\t* sem_ch4.adb (Analyze_Quantified_Expression):\n+\tPreanalyze the condition when the quantified expression will be\n+\tfurther expanded.\n+\n+2012-03-15  Yannick Moy  <moy@adacore.com>\n+\n+\t* sem_prag.adb, sem_util.adb, sem_util.ads, sem_attr.adb, sem_ch6.adb,\n+\tsem_warn.adb: Minor refactoring, renaming Case_Pragma in CTC_Pragma,\n+\tto refer to both Test_Case pragma and Contract_Case pragma (same\n+\tacronym as in Spec_CTC_List).\n+\n 2012-03-15  Robert Dewar  <dewar@adacore.com>\n \n \t* sem_prag.adb, sem_prag.ads, sem_util.ads, sem_attr.adb, sem_ch6.adb,"}, {"sha": "50c7d1242ec05c57d3a24de81a9f73146edd8737", "filename": "gcc/ada/sem_attr.adb", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ce6002ece2cb80b14030526abf0ef4401528f2b9/gcc%2Fada%2Fsem_attr.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ce6002ece2cb80b14030526abf0ef4401528f2b9/gcc%2Fada%2Fsem_attr.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_attr.adb?ref=ce6002ece2cb80b14030526abf0ef4401528f2b9", "patch": "@@ -4260,7 +4260,7 @@ package body Sem_Attr is\n             then\n                declare\n                   Arg_Ens : constant Node_Id :=\n-                              Get_Ensures_From_Case_Pragma (Prag);\n+                              Get_Ensures_From_CTC_Pragma (Prag);\n                   Arg     : Node_Id;\n \n                begin"}, {"sha": "55674855ab3ad9ad1fb7a2849e1a2e27fc105e6a", "filename": "gcc/ada/sem_ch4.adb", "status": "modified", "additions": 14, "deletions": 1, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ce6002ece2cb80b14030526abf0ef4401528f2b9/gcc%2Fada%2Fsem_ch4.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ce6002ece2cb80b14030526abf0ef4401528f2b9/gcc%2Fada%2Fsem_ch4.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch4.adb?ref=ce6002ece2cb80b14030526abf0ef4401528f2b9", "patch": "@@ -29,6 +29,7 @@ with Debug;    use Debug;\n with Einfo;    use Einfo;\n with Elists;   use Elists;\n with Errout;   use Errout;\n+with Expander; use Expander;\n with Exp_Util; use Exp_Util;\n with Fname;    use Fname;\n with Itypes;   use Itypes;\n@@ -3442,7 +3443,19 @@ package body Sem_Ch4 is\n          Set_Parent (Iterator_Specification (Iterator), Iterator);\n       end if;\n \n-      Analyze (Condition (N));\n+      if Needs_Expansion then\n+\n+         --  The full analysis will be performed during the expansion of the\n+         --  quantified expression, only a preanalysis of the condition needs\n+         --  to be done.\n+\n+         Expander_Mode_Save_And_Set (False);\n+         Analyze (Condition (N));\n+         Expander_Mode_Restore;\n+      else\n+         Analyze (Condition (N));\n+      end if;\n+\n       End_Scope;\n \n       Set_Etype (N, Standard_Boolean);"}, {"sha": "a63cb7944b797455ea71d8cd55e1d4f333db193d", "filename": "gcc/ada/sem_ch6.adb", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ce6002ece2cb80b14030526abf0ef4401528f2b9/gcc%2Fada%2Fsem_ch6.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ce6002ece2cb80b14030526abf0ef4401528f2b9/gcc%2Fada%2Fsem_ch6.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch6.adb?ref=ce6002ece2cb80b14030526abf0ef4401528f2b9", "patch": "@@ -7079,7 +7079,7 @@ package body Sem_Ch6 is\n          loop\n             --  Retrieve the Ensures component of the contract-case, if any\n \n-            Arg := Get_Ensures_From_Case_Pragma (Prag);\n+            Arg := Get_Ensures_From_CTC_Pragma (Prag);\n \n             if Pragma_Name (Prag) = Name_Contract_Case then\n \n@@ -11058,11 +11058,11 @@ package body Sem_Ch6 is\n          --  Copy the Requires and Ensures expressions\n \n          Req  := New_Copy_Tree\n-                   (Expression (Get_Requires_From_Case_Pragma (Prag)),\n+                   (Expression (Get_Requires_From_CTC_Pragma (Prag)),\n                     New_Scope => Current_Scope);\n \n          Ens  := New_Copy_Tree\n-                   (Expression (Get_Ensures_From_Case_Pragma (Prag)),\n+                   (Expression (Get_Ensures_From_CTC_Pragma (Prag)),\n                     New_Scope => Current_Scope);\n \n          --  Build the postcondition (not Requires'Old or else Ensures)"}, {"sha": "38a2c8c4a05603026d353bf7357b69963f18141c", "filename": "gcc/ada/sem_prag.adb", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ce6002ece2cb80b14030526abf0ef4401528f2b9/gcc%2Fada%2Fsem_prag.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ce6002ece2cb80b14030526abf0ef4401528f2b9/gcc%2Fada%2Fsem_prag.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_prag.adb?ref=ce6002ece2cb80b14030526abf0ef4401528f2b9", "patch": "@@ -260,8 +260,8 @@ package body Sem_Prag is\n \n       Preanalyze_CTC_Args\n         (N,\n-         Get_Requires_From_Case_Pragma (N),\n-         Get_Ensures_From_Case_Pragma (N));\n+         Get_Requires_From_CTC_Pragma (N),\n+         Get_Ensures_From_CTC_Pragma (N));\n \n       --  Remove the subprogram from the scope stack now that the pre-analysis\n       --  of the expressions in the contract case or test case is done.\n@@ -1465,13 +1465,13 @@ package body Sem_Prag is\n             --  same name associated to this subprogram.\n \n             declare\n-               Name : constant String_Id := Get_Name_From_Case_Pragma (N);\n+               Name : constant String_Id := Get_Name_From_CTC_Pragma (N);\n                CTC  : Node_Id;\n \n             begin\n                CTC := Spec_CTC_List (Contract (S));\n                while Present (CTC) loop\n-                  if String_Equal (Name, Get_Name_From_Case_Pragma (CTC)) then\n+                  if String_Equal (Name, Get_Name_From_CTC_Pragma (CTC)) then\n                      Error_Msg_Sloc := Sloc (CTC);\n                      Error_Pragma (\"name for pragma% is already used#\");\n                   end if;"}, {"sha": "6519221cbe67b4441c83132d7a43a37bbe37b7ab", "filename": "gcc/ada/sem_util.adb", "status": "modified", "additions": 15, "deletions": 15, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ce6002ece2cb80b14030526abf0ef4401528f2b9/gcc%2Fada%2Fsem_util.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ce6002ece2cb80b14030526abf0ef4401528f2b9/gcc%2Fada%2Fsem_util.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_util.adb?ref=ce6002ece2cb80b14030526abf0ef4401528f2b9", "patch": "@@ -4490,11 +4490,11 @@ package body Sem_Util is\n       end if;\n    end Get_Enum_Lit_From_Pos;\n \n-   ----------------------------------\n-   -- Get_Ensures_From_Case_Pragma --\n-   ----------------------------------\n+   ---------------------------------\n+   -- Get_Ensures_From_CTC_Pragma --\n+   ---------------------------------\n \n-   function Get_Ensures_From_Case_Pragma (N : Node_Id) return Node_Id is\n+   function Get_Ensures_From_CTC_Pragma (N : Node_Id) return Node_Id is\n       Args : constant List_Id := Pragma_Argument_Associations (N);\n       Res  : Node_Id;\n \n@@ -4514,7 +4514,7 @@ package body Sem_Util is\n       end if;\n \n       return Res;\n-   end Get_Ensures_From_Case_Pragma;\n+   end Get_Ensures_From_CTC_Pragma;\n \n    ------------------------\n    -- Get_Generic_Entity --\n@@ -4602,16 +4602,16 @@ package body Sem_Util is\n       return Entity_Id (Get_Name_Table_Info (Id));\n    end Get_Name_Entity_Id;\n \n-   -------------------------------\n-   -- Get_Name_From_Case_Pragma --\n-   -------------------------------\n+   ------------------------------\n+   -- Get_Name_From_CTC_Pragma --\n+   ------------------------------\n \n-   function Get_Name_From_Case_Pragma (N : Node_Id) return String_Id is\n+   function Get_Name_From_CTC_Pragma (N : Node_Id) return String_Id is\n       Arg : constant Node_Id :=\n               Get_Pragma_Arg (First (Pragma_Argument_Associations (N)));\n    begin\n       return Strval (Expr_Value_S (Arg));\n-   end Get_Name_From_Case_Pragma;\n+   end Get_Name_From_CTC_Pragma;\n \n    -------------------\n    -- Get_Pragma_Id --\n@@ -4656,11 +4656,11 @@ package body Sem_Util is\n       return R;\n    end Get_Renamed_Entity;\n \n-   -----------------------------------\n-   -- Get_Requires_From_Case_Pragma --\n-   -----------------------------------\n+   ----------------------------------\n+   -- Get_Requires_From_CTC_Pragma --\n+   ----------------------------------\n \n-   function Get_Requires_From_Case_Pragma (N : Node_Id) return Node_Id is\n+   function Get_Requires_From_CTC_Pragma (N : Node_Id) return Node_Id is\n       Args : constant List_Id := Pragma_Argument_Associations (N);\n       Res  : Node_Id;\n \n@@ -4677,7 +4677,7 @@ package body Sem_Util is\n       end if;\n \n       return Res;\n-   end Get_Requires_From_Case_Pragma;\n+   end Get_Requires_From_CTC_Pragma;\n \n    -------------------------\n    -- Get_Subprogram_Body --"}, {"sha": "34d2fc0383c2e51b41abc3c698344280d437bf70", "filename": "gcc/ada/sem_util.ads", "status": "modified", "additions": 3, "deletions": 4, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ce6002ece2cb80b14030526abf0ef4401528f2b9/gcc%2Fada%2Fsem_util.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ce6002ece2cb80b14030526abf0ef4401528f2b9/gcc%2Fada%2Fsem_util.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_util.ads?ref=ce6002ece2cb80b14030526abf0ef4401528f2b9", "patch": "@@ -538,7 +538,7 @@ package Sem_Util is\n    --  If expression N references a part of an object, return this object.\n    --  Otherwise return Empty. Expression N should have been resolved already.\n \n-   function Get_Ensures_From_Case_Pragma (N : Node_Id) return Node_Id;\n+   function Get_Ensures_From_CTC_Pragma (N : Node_Id) return Node_Id;\n    --  Return the Ensures component of Contract_Case or Test_Case pragma N, or\n    --  Empty otherwise.\n \n@@ -573,9 +573,8 @@ package Sem_Util is\n    --  is the innermost visible entity with the given name. See the body of\n    --  Sem_Ch8 for further details on handling of entity visibility.\n \n-   function Get_Name_From_Case_Pragma (N : Node_Id) return String_Id;\n+   function Get_Name_From_CTC_Pragma (N : Node_Id) return String_Id;\n    --  Return the Name component of Contract_Case or Test_Case pragma N\n-   --  Bad name, Case_Pragma is meaningless to me ???\n \n    function Get_Pragma_Id (N : Node_Id) return Pragma_Id;\n    pragma Inline (Get_Pragma_Id);\n@@ -592,7 +591,7 @@ package Sem_Util is\n    --  not a renamed entity, returns its argument. It is an error to call this\n    --  with any other kind of entity.\n \n-   function Get_Requires_From_Case_Pragma (N : Node_Id) return Node_Id;\n+   function Get_Requires_From_CTC_Pragma (N : Node_Id) return Node_Id;\n    --  Return the Requires component of Contract_Case or Test_Case pragma N, or\n    --  Empty otherwise.\n "}, {"sha": "3ba8b9116cdbf0315ce5d41936802e2c56198e20", "filename": "gcc/ada/sem_warn.adb", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ce6002ece2cb80b14030526abf0ef4401528f2b9/gcc%2Fada%2Fsem_warn.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ce6002ece2cb80b14030526abf0ef4401528f2b9/gcc%2Fada%2Fsem_warn.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_warn.adb?ref=ce6002ece2cb80b14030526abf0ef4401528f2b9", "patch": "@@ -1775,7 +1775,7 @@ package body Sem_Warn is\n                                      or else\n                                    Pragma_Name (P) = Name_Test_Case)\n                                 and then\n-                                  Nod = Get_Ensures_From_Case_Pragma (P)\n+                                  Nod = Get_Ensures_From_CTC_Pragma (P)\n                               then\n                                  return True;\n                               end if;"}]}