{"sha": "9fcb28197f056fd7e1ace31db7aa7f0104f7eb96", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWZjYjI4MTk3ZjA1NmZkN2UxYWNlMzFkYjdhYTdmMDEwNGY3ZWI5Ng==", "commit": {"author": {"name": "Steven G. Kargl", "email": "kargl@gcc.gnu.org", "date": "2016-07-30T23:01:06Z"}, "committer": {"name": "Steven G. Kargl", "email": "kargl@gcc.gnu.org", "date": "2016-07-30T23:01:06Z"}, "message": "re PR fortran/68566 (ICE on using unusable array in reshape (double free or corruption))\n\n2016-07-30  Steven G. Kargl  <kargl@gcc.gnu.org>\n\n\tPR fortran/68566\n\t* check.c (gfc_check_reshape): Check for constant expression.\n\n2016-07-30  Steven G. Kargl  <kargl@gcc.gnu.org>\n\n\tPR fortran/68566\n\t* gfortran.dg/pr68566.f90: new test.\n\nFrom-SVN: r238911", "tree": {"sha": "54c1c5e532ad18166a3465120bb778aa7e7682a7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/54c1c5e532ad18166a3465120bb778aa7e7682a7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9fcb28197f056fd7e1ace31db7aa7f0104f7eb96", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9fcb28197f056fd7e1ace31db7aa7f0104f7eb96", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9fcb28197f056fd7e1ace31db7aa7f0104f7eb96", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9fcb28197f056fd7e1ace31db7aa7f0104f7eb96/comments", "author": null, "committer": null, "parents": [{"sha": "8bada5cd4e51feb60e1e887ecf0bda3288949af4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8bada5cd4e51feb60e1e887ecf0bda3288949af4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8bada5cd4e51feb60e1e887ecf0bda3288949af4"}], "stats": {"total": 25, "additions": 24, "deletions": 1}, "files": [{"sha": "32a1e86ab253a3bd5a36a681fd4885761077ac3b", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9fcb28197f056fd7e1ace31db7aa7f0104f7eb96/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9fcb28197f056fd7e1ace31db7aa7f0104f7eb96/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=9fcb28197f056fd7e1ace31db7aa7f0104f7eb96", "patch": "@@ -1,3 +1,8 @@\n+2016-07-30  Steven G. Kargl  <kargl@gcc.gnu.org>\n+\n+\tPR fortran/68566\n+\t* check.c (gfc_check_reshape): Check for constant expression.\n+\n 2016-07-30  Steven G. Kargl  <kargl@gcc.gnu.org>\n \n \tPR fortran/69867"}, {"sha": "288957aaa34fba3f063ad9ff2021cf6e7ea73003", "filename": "gcc/fortran/check.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9fcb28197f056fd7e1ace31db7aa7f0104f7eb96/gcc%2Ffortran%2Fcheck.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9fcb28197f056fd7e1ace31db7aa7f0104f7eb96/gcc%2Ffortran%2Fcheck.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fcheck.c?ref=9fcb28197f056fd7e1ace31db7aa7f0104f7eb96", "patch": "@@ -3827,7 +3827,7 @@ gfc_check_reshape (gfc_expr *source, gfc_expr *shape,\n       if (!type_check (order, 3, BT_INTEGER))\n \treturn false;\n \n-      if (order->expr_type == EXPR_ARRAY)\n+      if (order->expr_type == EXPR_ARRAY && gfc_is_constant_expr (order))\n \t{\n \t  int i, order_size, dim, perm[GFC_MAX_DIMENSIONS];\n \t  gfc_expr *e;"}, {"sha": "e4ce4c7ecebd0b0da3b8574cd1426cdede2b28ee", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9fcb28197f056fd7e1ace31db7aa7f0104f7eb96/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9fcb28197f056fd7e1ace31db7aa7f0104f7eb96/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=9fcb28197f056fd7e1ace31db7aa7f0104f7eb96", "patch": "@@ -1,3 +1,8 @@\n+2016-07-30  Steven G. Kargl  <kargl@gcc.gnu.org>\n+\n+\tPR fortran/68566\n+\t* gfortran.dg/pr68566.f90: new test.\n+\n 2016-07-30 Martin Sebor  <msebor@redhat.com>\n \n \tPR c++/60760"}, {"sha": "160e9ac58f6cad45ea4e5129dc596e9ee53f4c9e", "filename": "gcc/testsuite/gfortran.dg/pr68566.f90", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9fcb28197f056fd7e1ace31db7aa7f0104f7eb96/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr68566.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9fcb28197f056fd7e1ace31db7aa7f0104f7eb96/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr68566.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr68566.f90?ref=9fcb28197f056fd7e1ace31db7aa7f0104f7eb96", "patch": "@@ -0,0 +1,13 @@\n+! { dg-do run }\n+program p\n+   character(len=20) s1, s2\n+   integer, allocatable :: n(:)\n+   n = [2,1]\n+   s1 = '1 5 2 6 3 0 4 0'\n+   write(s2,'(8(I0,1x))') reshape ([1,2,3,4,5,6], [2,4], [0,0], [2,1])\n+   if (trim(s1) /= trim(s2)) call abort\n+   write(s2,'(8(I0,1x))') reshape ([1,2,3,4,5,6], [2,4], [0,0], n)\n+   if (trim(s1) /= trim(s2)) call abort\n+   write(s2,'(8(I0,1x))') reshape ([1,2,3,4,5,6], [2,4], [0,0], [n])\n+   if (trim(s1) /= trim(s2)) call abort\n+end"}]}