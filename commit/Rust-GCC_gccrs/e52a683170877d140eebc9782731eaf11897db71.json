{"sha": "e52a683170877d140eebc9782731eaf11897db71", "node_id": "C_kwDOANBUbNoAKGU1MmE2ODMxNzA4NzdkMTQwZWViYzk3ODI3MzFlYWYxMTg5N2RiNzE", "commit": {"author": {"name": "Joel Teichroeb", "email": "joel@teichroeb.net", "date": "2022-02-04T16:35:08Z"}, "committer": {"name": "David Malcolm", "email": "dmalcolm@redhat.com", "date": "2022-02-09T02:36:21Z"}, "message": "analyzer: Fix tests for glibc 2.35 [PR101081]\n\nIn recent versions of glibc fopen has __attribute__((malloc)).\nSince we can not detect wether this attribute is present or not,\nwe avoid including stdio.h and instead forward declare what we\nneed in each test.\n\nSigned-off-by: Joel Teichroeb <joel@teichroeb.net>\n\ngcc/testsuite/ChangeLog:\n\tPR analyzer/101081\n\t* gcc.dg/analyzer/analyzer-verbosity-2a.c: Replace #include of\n\tstdio.h with declarations needed by the test.\n\t* gcc.dg/analyzer/analyzer-verbosity-3a.c: Likewise.\n\t* gcc.dg/analyzer/edges-1.c: Likewise.\n\t* gcc.dg/analyzer/file-1.c: Likewise.\n\t* gcc.dg/analyzer/file-2.c: Likewise.\n\t* gcc.dg/analyzer/file-paths-1.c: Likewise.\n\t* gcc.dg/analyzer/file-pr58237.c: Likewise.\n\t* gcc.dg/analyzer/pr99716-1.c: Likewise.\n\nSigned-off-by: David Malcolm <dmalcolm@redhat.com>", "tree": {"sha": "6125c20ee638da53fade1929745f1bd3b9b72e9a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6125c20ee638da53fade1929745f1bd3b9b72e9a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e52a683170877d140eebc9782731eaf11897db71", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e52a683170877d140eebc9782731eaf11897db71", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e52a683170877d140eebc9782731eaf11897db71", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e52a683170877d140eebc9782731eaf11897db71/comments", "author": {"login": "klusark", "id": 240865, "node_id": "MDQ6VXNlcjI0MDg2NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/240865?v=4", "gravatar_id": "", "url": "https://api.github.com/users/klusark", "html_url": "https://github.com/klusark", "followers_url": "https://api.github.com/users/klusark/followers", "following_url": "https://api.github.com/users/klusark/following{/other_user}", "gists_url": "https://api.github.com/users/klusark/gists{/gist_id}", "starred_url": "https://api.github.com/users/klusark/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/klusark/subscriptions", "organizations_url": "https://api.github.com/users/klusark/orgs", "repos_url": "https://api.github.com/users/klusark/repos", "events_url": "https://api.github.com/users/klusark/events{/privacy}", "received_events_url": "https://api.github.com/users/klusark/received_events", "type": "User", "site_admin": false}, "committer": {"login": "davidmalcolm", "id": 1553248, "node_id": "MDQ6VXNlcjE1NTMyNDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1553248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidmalcolm", "html_url": "https://github.com/davidmalcolm", "followers_url": "https://api.github.com/users/davidmalcolm/followers", "following_url": "https://api.github.com/users/davidmalcolm/following{/other_user}", "gists_url": "https://api.github.com/users/davidmalcolm/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidmalcolm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidmalcolm/subscriptions", "organizations_url": "https://api.github.com/users/davidmalcolm/orgs", "repos_url": "https://api.github.com/users/davidmalcolm/repos", "events_url": "https://api.github.com/users/davidmalcolm/events{/privacy}", "received_events_url": "https://api.github.com/users/davidmalcolm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "391512ade5f6cda95456133296c8dcc42d5fbefd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/391512ade5f6cda95456133296c8dcc42d5fbefd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/391512ade5f6cda95456133296c8dcc42d5fbefd"}], "stats": {"total": 53, "additions": 44, "deletions": 9}, "files": [{"sha": "cf014b0a3c8fa01b04f2e9e062bd7c3711eeeb6d", "filename": "gcc/testsuite/gcc.dg/analyzer/analyzer-verbosity-2a.c", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e52a683170877d140eebc9782731eaf11897db71/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fanalyzer-verbosity-2a.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e52a683170877d140eebc9782731eaf11897db71/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fanalyzer-verbosity-2a.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fanalyzer-verbosity-2a.c?ref=e52a683170877d140eebc9782731eaf11897db71", "patch": "@@ -1,6 +1,9 @@\n /* { dg-additional-options \"-fanalyzer-verbosity=2\" } */\n \n-#include <stdio.h>\n+typedef struct FILE   FILE;\n+\n+FILE* fopen (const char*, const char*);\n+int   fclose (FILE*);\n \n extern int foo ();\n extern void bar ();"}, {"sha": "b0ece203f56de1322672e87a084ab3be058cb816", "filename": "gcc/testsuite/gcc.dg/analyzer/analyzer-verbosity-3a.c", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e52a683170877d140eebc9782731eaf11897db71/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fanalyzer-verbosity-3a.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e52a683170877d140eebc9782731eaf11897db71/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fanalyzer-verbosity-3a.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fanalyzer-verbosity-3a.c?ref=e52a683170877d140eebc9782731eaf11897db71", "patch": "@@ -1,6 +1,9 @@\n /* { dg-additional-options \"-fanalyzer-verbosity=3\" } */\n \n-#include <stdio.h>\n+typedef struct FILE   FILE;\n+\n+FILE* fopen (const char*, const char*);\n+int   fclose (FILE*);\n \n extern int foo ();\n extern void bar ();"}, {"sha": "f08a6143d59b0aded87c052a9aedf28bfd424599", "filename": "gcc/testsuite/gcc.dg/analyzer/edges-1.c", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e52a683170877d140eebc9782731eaf11897db71/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fedges-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e52a683170877d140eebc9782731eaf11897db71/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fedges-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fedges-1.c?ref=e52a683170877d140eebc9782731eaf11897db71", "patch": "@@ -1,4 +1,7 @@\n-#include <stdio.h>\n+typedef struct FILE   FILE;\n+\n+FILE* fopen (const char*, const char*);\n+int   fclose (FILE*);\n \n extern int foo ();\n extern void bar ();"}, {"sha": "e8d934331fd473383335482e8c94af34cecf2a1e", "filename": "gcc/testsuite/gcc.dg/analyzer/file-1.c", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e52a683170877d140eebc9782731eaf11897db71/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffile-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e52a683170877d140eebc9782731eaf11897db71/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffile-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffile-1.c?ref=e52a683170877d140eebc9782731eaf11897db71", "patch": "@@ -1,4 +1,9 @@\n-#include <stdio.h>\n+typedef struct FILE   FILE;\n+\n+FILE* fopen (const char*, const char*);\n+int   fclose (FILE*);\n+#define SEEK_SET        0\n+int fseek (FILE *, long int, int);\n \n void\n test_1 (const char *path)"}, {"sha": "9c58108a5312b6e6f85a9a1a1d7dc6bdf0c8c34d", "filename": "gcc/testsuite/gcc.dg/analyzer/file-2.c", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e52a683170877d140eebc9782731eaf11897db71/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffile-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e52a683170877d140eebc9782731eaf11897db71/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffile-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffile-2.c?ref=e52a683170877d140eebc9782731eaf11897db71", "patch": "@@ -1,4 +1,7 @@\n-#include <stdio.h>\n+typedef struct FILE   FILE;\n+\n+FILE* fopen (const char*, const char*);\n+int   fclose (FILE*);\n \n struct foo\n {"}, {"sha": "f35017835d49e7a6440d6deb7e269d7246ccb533", "filename": "gcc/testsuite/gcc.dg/analyzer/file-paths-1.c", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e52a683170877d140eebc9782731eaf11897db71/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffile-paths-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e52a683170877d140eebc9782731eaf11897db71/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffile-paths-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffile-paths-1.c?ref=e52a683170877d140eebc9782731eaf11897db71", "patch": "@@ -1,6 +1,13 @@\n /* { dg-additional-options \"-fanalyzer-verbosity=3\" } */\n \n-#include <stdio.h>\n+typedef struct FILE   FILE;\n+\n+FILE* fopen (const char*, const char*);\n+int   fclose (FILE*);\n+char *fgets (char *, int, FILE *);\n+\n+#define NULL ((void *)0)\n+\n \n /* Verify that we correctly emit CFG events in the face of buffers\n    being clobbered in these leak reports.  */"}, {"sha": "ecc7144198b608ba05cdf8fce764504b2a432c51", "filename": "gcc/testsuite/gcc.dg/analyzer/file-pr58237.c", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e52a683170877d140eebc9782731eaf11897db71/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffile-pr58237.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e52a683170877d140eebc9782731eaf11897db71/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffile-pr58237.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffile-pr58237.c?ref=e52a683170877d140eebc9782731eaf11897db71", "patch": "@@ -1,4 +1,10 @@\n-#include <stdio.h>\n+typedef struct FILE   FILE;\n+\n+FILE* fopen (const char*, const char*);\n+int   fclose (FILE*);\n+char *fgets (char *, int, FILE *);\n+\n+#define NULL ((void *)0)\n \n void f0(const char *str)\n {"}, {"sha": "2ccdcc73a5c29a34977a3cc629596d43b21a24cc", "filename": "gcc/testsuite/gcc.dg/analyzer/pr99716-1.c", "status": "modified", "additions": 7, "deletions": 2, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e52a683170877d140eebc9782731eaf11897db71/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fpr99716-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e52a683170877d140eebc9782731eaf11897db71/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fpr99716-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fpr99716-1.c?ref=e52a683170877d140eebc9782731eaf11897db71", "patch": "@@ -1,5 +1,10 @@\n-#include <stdio.h>\n-#include <stdlib.h>\n+typedef struct FILE   FILE;\n+\n+FILE* fopen (const char*, const char*);\n+int   fclose (FILE*);\n+int fprintf (FILE *, const char *, ...);\n+\n+#define NULL ((void *)0)\n \n void\n test_1 (void)"}]}