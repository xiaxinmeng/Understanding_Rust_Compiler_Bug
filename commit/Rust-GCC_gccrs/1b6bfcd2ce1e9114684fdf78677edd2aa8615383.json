{"sha": "1b6bfcd2ce1e9114684fdf78677edd2aa8615383", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWI2YmZjZDJjZTFlOTExNDY4NGZkZjc4Njc3ZWRkMmFhODYxNTM4Mw==", "commit": {"author": {"name": "Mark Mitchell", "email": "mark@codesourcery.com", "date": "2004-01-16T17:54:25Z"}, "committer": {"name": "Mark Mitchell", "email": "mmitchel@gcc.gnu.org", "date": "2004-01-16T17:54:25Z"}, "message": "re PR c++/13478 (gcc uses wrong constructor to initialize a const reference)\n\n\tPR c++/13478\n\t* call.c (initialize_reference): Pass -1 for inner parameter to\n\tconvert_like_real.\n\n\tPR c++/13478\n\t* g++.dg/init/ref10.C: New test.\n\nFrom-SVN: r75983", "tree": {"sha": "698bbdc1f426564069ac00d68683d9b06bc0ff83", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/698bbdc1f426564069ac00d68683d9b06bc0ff83"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1b6bfcd2ce1e9114684fdf78677edd2aa8615383", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1b6bfcd2ce1e9114684fdf78677edd2aa8615383", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1b6bfcd2ce1e9114684fdf78677edd2aa8615383", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1b6bfcd2ce1e9114684fdf78677edd2aa8615383/comments", "author": null, "committer": null, "parents": [{"sha": "a3fe7b56f3f0f153f9524f55bbcae9c65f127691", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a3fe7b56f3f0f153f9524f55bbcae9c65f127691", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a3fe7b56f3f0f153f9524f55bbcae9c65f127691"}], "stats": {"total": 12, "additions": 8, "deletions": 4}, "files": [{"sha": "c2458abfe86d020353e1f218dc4463ae9db9b1a1", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1b6bfcd2ce1e9114684fdf78677edd2aa8615383/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1b6bfcd2ce1e9114684fdf78677edd2aa8615383/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=1b6bfcd2ce1e9114684fdf78677edd2aa8615383", "patch": "@@ -1,8 +1,8 @@\n 2004-01-16  Mark Mitchell  <mark@codesourcery.com>\n \n \tPR c++/13478\n-\t* call.c (convert_like_real): Do not perform an additional\n-\tdirect-initialization when binding to a reference.\n+\t* call.c (initialize_reference): Pass -1 for inner parameter to\n+\tconvert_like_real.\n \n 2004-01-15  Giovanni Bajo  <giovannibajo@gcc.gnu.org>\n "}, {"sha": "aaf902ceed63ff8422624f595b831cfe9dbdd703", "filename": "gcc/cp/call.c", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1b6bfcd2ce1e9114684fdf78677edd2aa8615383/gcc%2Fcp%2Fcall.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1b6bfcd2ce1e9114684fdf78677edd2aa8615383/gcc%2Fcp%2Fcall.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fcall.c?ref=1b6bfcd2ce1e9114684fdf78677edd2aa8615383", "patch": "@@ -4068,7 +4068,8 @@ convert_like_real (tree convs, tree expr, tree fn, int argnum, int inner,\n \t   conversion, but is not considered during overload resolution.\n \n \t   If the target is a class, that means call a ctor.  */\n-\tif (IS_AGGR_TYPE (totype) && inner >= 0)\n+\tif (IS_AGGR_TYPE (totype)\n+\t    && (inner >= 0 || !lvalue_p (expr)))\n \t  {\n \t    expr = (build_temp \n \t\t    (expr, totype, \n@@ -6250,7 +6251,10 @@ initialize_reference (tree type, tree expr, tree decl, tree *cleanup)\n       else\n \tbase_conv_type = NULL_TREE;\n       /* Perform the remainder of the conversion.  */\n-      expr = convert_like (conv, expr);\n+      expr = convert_like_real (conv, expr,\n+\t\t\t\t/*fn=*/NULL_TREE, /*argnum=*/0,\n+\t\t\t\t/*inner=*/-1,\n+\t\t\t\t/*issue_conversion_warnings=*/true);\n       if (!real_lvalue_p (expr))\n \t{\n \t  tree init;"}]}