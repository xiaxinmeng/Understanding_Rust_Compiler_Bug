{"sha": "dfda40f8147412328f699628a54b0aaa584776e7", "node_id": "C_kwDOANBUbNoAKGRmZGE0MGY4MTQ3NDEyMzI4ZjY5OTYyOGE1NGIwYWFhNTg0Nzc2ZTc", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2022-05-12T12:03:32Z"}, "committer": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2022-05-12T13:05:45Z"}, "message": "rtl-optimization/105577 - RTL DSE and non-call EH\n\nWhen one of the first two stages of DSE removes a throwing stmt\nwe have to purge dead EH edges before the DF re-analyze fires off\na fast DCE since that cannot cope with the situation.\n\n2022-05-12  Richard Biener  <rguenther@suse.de>\n\n\tPR rtl-optimization/105577\n\t* dse.cc (rest_of_handle_dse): Make sure to purge dead EH\n\tedges before running fast DCE via df_analyze.", "tree": {"sha": "237be28ae200f54b39c441b74a6495d8dad3c9cb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/237be28ae200f54b39c441b74a6495d8dad3c9cb"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/dfda40f8147412328f699628a54b0aaa584776e7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dfda40f8147412328f699628a54b0aaa584776e7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dfda40f8147412328f699628a54b0aaa584776e7", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dfda40f8147412328f699628a54b0aaa584776e7/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c4471a4a3cd0923582f88249feb9fb1a2e37c32a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c4471a4a3cd0923582f88249feb9fb1a2e37c32a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c4471a4a3cd0923582f88249feb9fb1a2e37c32a"}], "stats": {"total": 10, "additions": 10, "deletions": 0}, "files": [{"sha": "30c11cee0348e70e06e378c40ea1cfe87c3017b8", "filename": "gcc/dse.cc", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dfda40f8147412328f699628a54b0aaa584776e7/gcc%2Fdse.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dfda40f8147412328f699628a54b0aaa584776e7/gcc%2Fdse.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdse.cc?ref=dfda40f8147412328f699628a54b0aaa584776e7", "patch": "@@ -3682,6 +3682,16 @@ rest_of_handle_dse (void)\n \n   dse_step0 ();\n   dse_step1 ();\n+  /* DSE can eliminate potentially-trapping MEMs.\n+     Remove any EH edges associated with them, since otherwise\n+     DF_LR_RUN_DCE will complain later.  */\n+  if ((locally_deleted || globally_deleted)\n+      && cfun->can_throw_non_call_exceptions\n+      && purge_all_dead_edges ())\n+    {\n+      free_dominance_info (CDI_DOMINATORS);\n+      delete_unreachable_blocks ();\n+    }\n   dse_step2_init ();\n   if (dse_step2 ())\n     {"}]}