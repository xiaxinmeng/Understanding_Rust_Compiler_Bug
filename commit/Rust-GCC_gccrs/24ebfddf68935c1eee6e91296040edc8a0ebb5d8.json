{"sha": "24ebfddf68935c1eee6e91296040edc8a0ebb5d8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjRlYmZkZGY2ODkzNWMxZWVlNmU5MTI5NjA0MGVkYzhhMGViYjVkOA==", "commit": {"author": {"name": "Yury Gribov", "email": "y.gribov@samsung.com", "date": "2014-11-18T07:37:17Z"}, "committer": {"name": "Yury Gribov", "email": "ygribov@gcc.gnu.org", "date": "2014-11-18T07:37:17Z"}, "message": "re PR sanitizer/63802 (UBSan doesn't catch misaligned access if address is 16-bytes (or more) aligned)\n\n2014-11-18  Yury Gribov  <y.gribov@samsung.com>\n\n\tPR sanitizer/63802\n\ngcc/\n\t* stor-layout.c (min_align_of_type): Respect user alignment\n\tmore.\n\ngcc/testsuite/\n\t* c-c++-common/ubsan/pr63802.c: New test.\n\nFrom-SVN: r217689", "tree": {"sha": "90dca729a9de6cf67659d3f673f4f7000930375a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/90dca729a9de6cf67659d3f673f4f7000930375a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/24ebfddf68935c1eee6e91296040edc8a0ebb5d8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/24ebfddf68935c1eee6e91296040edc8a0ebb5d8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/24ebfddf68935c1eee6e91296040edc8a0ebb5d8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/24ebfddf68935c1eee6e91296040edc8a0ebb5d8/comments", "author": null, "committer": null, "parents": [{"sha": "005581f187d790a411a6e96e8002cb56bc1ae12c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/005581f187d790a411a6e96e8002cb56bc1ae12c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/005581f187d790a411a6e96e8002cb56bc1ae12c"}], "stats": {"total": 36, "additions": 35, "deletions": 1}, "files": [{"sha": "c0649cf5d03a189e7ddfff27a708b0ad44634311", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/24ebfddf68935c1eee6e91296040edc8a0ebb5d8/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/24ebfddf68935c1eee6e91296040edc8a0ebb5d8/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=24ebfddf68935c1eee6e91296040edc8a0ebb5d8", "patch": "@@ -1,3 +1,9 @@\n+2014-11-18  Yury Gribov  <y.gribov@samsung.com>\n+\n+\tPR sanitizer/63802\n+\t* stor-layout.c (min_align_of_type): Respect user alignment\n+\tmore.\n+\n 2014-11-18  Ilya Enkovich  <ilya.enkovich@intel.com>\n \n \t* passes.c (remove_cgraph_node_from_order): New."}, {"sha": "db09855e1f47bc6cd09939be2d0bfcaa507f86ba", "filename": "gcc/stor-layout.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/24ebfddf68935c1eee6e91296040edc8a0ebb5d8/gcc%2Fstor-layout.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/24ebfddf68935c1eee6e91296040edc8a0ebb5d8/gcc%2Fstor-layout.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fstor-layout.c?ref=24ebfddf68935c1eee6e91296040edc8a0ebb5d8", "patch": "@@ -2430,9 +2430,9 @@ unsigned int\n min_align_of_type (tree type)\n {\n   unsigned int align = TYPE_ALIGN (type);\n-  align = MIN (align, BIGGEST_ALIGNMENT);\n   if (!TYPE_USER_ALIGN (type))\n     {\n+      align = MIN (align, BIGGEST_ALIGNMENT);\n #ifdef BIGGEST_FIELD_ALIGNMENT\n       align = MIN (align, BIGGEST_FIELD_ALIGNMENT);\n #endif"}, {"sha": "8a924cc5f0e249939d65a1144270e3ecbf053945", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/24ebfddf68935c1eee6e91296040edc8a0ebb5d8/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/24ebfddf68935c1eee6e91296040edc8a0ebb5d8/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=24ebfddf68935c1eee6e91296040edc8a0ebb5d8", "patch": "@@ -1,3 +1,8 @@\n+2014-11-18  Yury Gribov  <y.gribov@samsung.com>\n+\n+\tPR sanitizer/63802\n+\t* c-c++-common/ubsan/pr63802.c: New test.\n+\n 2014-11-18  Ilya Enkovich  <ilya.enkovich@intel.com>\n \n \t* g++.dg/pr63766.C: New."}, {"sha": "454c0980f5b0290ba691f2efbf74e4c05f2fc9aa", "filename": "gcc/testsuite/c-c++-common/ubsan/pr63802.c", "status": "added", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/24ebfddf68935c1eee6e91296040edc8a0ebb5d8/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fubsan%2Fpr63802.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/24ebfddf68935c1eee6e91296040edc8a0ebb5d8/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fubsan%2Fpr63802.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fubsan%2Fpr63802.c?ref=24ebfddf68935c1eee6e91296040edc8a0ebb5d8", "patch": "@@ -0,0 +1,23 @@\n+/* Limit this to known non-strict alignment targets.  */\n+/* { dg-do run { target { i?86-*-linux* x86_64-*-linux* } } } */\n+/* { dg-options \"-fsanitize=alignment\" } */\n+\n+#define __round_mask(x, y) ((__typeof__(x))((y)-1))\n+#define round_up(x, y) ((((x)-1) | __round_mask(x, y))+1)\n+\n+struct test_struct {\n+  unsigned long a;\n+  int b;\n+} __attribute__((__aligned__(64)));\n+\n+char a[200];\n+\n+int main ()\n+{\n+  volatile int x = ((struct test_struct*)(round_up((unsigned long)a, 64) + 16))->b;\n+  volatile int y = ((struct test_struct*)(round_up((unsigned long)a, 64) + 15))->b;\n+\n+  return 0;\n+}\n+\n+/* { dg-output \"\\.c:18:\\[0-9]*: \\[^\\n\\r]*member access within misaligned address 0x\\[0-9a-fA-F]* for type 'struct test_struct', which requires 64 byte alignment.*\" } */"}]}