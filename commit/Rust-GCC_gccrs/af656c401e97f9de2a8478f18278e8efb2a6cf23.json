{"sha": "af656c401e97f9de2a8478f18278e8efb2a6cf23", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWY2NTZjNDAxZTk3ZjlkZTJhODQ3OGYxODI3OGU4ZWZiMmE2Y2YyMw==", "commit": {"author": {"name": "David Malcolm", "email": "dmalcolm@redhat.com", "date": "2020-09-07T21:43:02Z"}, "committer": {"name": "David Malcolm", "email": "dmalcolm@redhat.com", "date": "2020-09-08T14:50:12Z"}, "message": "analyzer: fix ICE on RANGE_EXPR with CONSTRUCTOR value [PR96950]\n\ngcc/analyzer/ChangeLog:\n\tPR analyzer/96950\n\t* store.cc (binding_map::apply_ctor_to_region): Handle RANGE_EXPR\n\twhere min_index == max_index.\n\t(binding_map::apply_ctor_val_to_range): Replace assertion that we\n\tdon't have a CONSTRUCTOR value with error-handling.", "tree": {"sha": "b1a98686e304911580f9732d9724c5ca1bc0cef6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b1a98686e304911580f9732d9724c5ca1bc0cef6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/af656c401e97f9de2a8478f18278e8efb2a6cf23", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/af656c401e97f9de2a8478f18278e8efb2a6cf23", "html_url": "https://github.com/Rust-GCC/gccrs/commit/af656c401e97f9de2a8478f18278e8efb2a6cf23", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/af656c401e97f9de2a8478f18278e8efb2a6cf23/comments", "author": {"login": "davidmalcolm", "id": 1553248, "node_id": "MDQ6VXNlcjE1NTMyNDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1553248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidmalcolm", "html_url": "https://github.com/davidmalcolm", "followers_url": "https://api.github.com/users/davidmalcolm/followers", "following_url": "https://api.github.com/users/davidmalcolm/following{/other_user}", "gists_url": "https://api.github.com/users/davidmalcolm/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidmalcolm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidmalcolm/subscriptions", "organizations_url": "https://api.github.com/users/davidmalcolm/orgs", "repos_url": "https://api.github.com/users/davidmalcolm/repos", "events_url": "https://api.github.com/users/davidmalcolm/events{/privacy}", "received_events_url": "https://api.github.com/users/davidmalcolm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "davidmalcolm", "id": 1553248, "node_id": "MDQ6VXNlcjE1NTMyNDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1553248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidmalcolm", "html_url": "https://github.com/davidmalcolm", "followers_url": "https://api.github.com/users/davidmalcolm/followers", "following_url": "https://api.github.com/users/davidmalcolm/following{/other_user}", "gists_url": "https://api.github.com/users/davidmalcolm/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidmalcolm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidmalcolm/subscriptions", "organizations_url": "https://api.github.com/users/davidmalcolm/orgs", "repos_url": "https://api.github.com/users/davidmalcolm/repos", "events_url": "https://api.github.com/users/davidmalcolm/events{/privacy}", "received_events_url": "https://api.github.com/users/davidmalcolm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "47997a32e63b77ec88a7131a5d540f108c698661", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/47997a32e63b77ec88a7131a5d540f108c698661", "html_url": "https://github.com/Rust-GCC/gccrs/commit/47997a32e63b77ec88a7131a5d540f108c698661"}], "stats": {"total": 18, "additions": 14, "deletions": 4}, "files": [{"sha": "94bcbecce888355687ff466466a9eab95ccbb3d4", "filename": "gcc/analyzer/store.cc", "status": "modified", "additions": 14, "deletions": 4, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/af656c401e97f9de2a8478f18278e8efb2a6cf23/gcc%2Fanalyzer%2Fstore.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/af656c401e97f9de2a8478f18278e8efb2a6cf23/gcc%2Fanalyzer%2Fstore.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fanalyzer%2Fstore.cc?ref=af656c401e97f9de2a8478f18278e8efb2a6cf23", "patch": "@@ -425,9 +425,18 @@ binding_map::apply_ctor_to_region (const region *parent_reg, tree ctor,\n \t{\n \t  tree min_index = TREE_OPERAND (index, 0);\n \t  tree max_index = TREE_OPERAND (index, 1);\n-\t  if (!apply_ctor_val_to_range (parent_reg, mgr,\n-\t\t\t\t\tmin_index, max_index, val))\n-\t    return false;\n+\t  if (min_index == max_index)\n+\t    {\n+\t      if (!apply_ctor_pair_to_child_region (parent_reg, mgr,\n+\t\t\t\t\t\t    min_index, val))\n+\t\treturn false;\n+\t    }\n+\t  else\n+\t    {\n+\t      if (!apply_ctor_val_to_range (parent_reg, mgr,\n+\t\t\t\t\t    min_index, max_index, val))\n+\t\treturn false;\n+\t    }\n \t  continue;\n \t}\n       if (!apply_ctor_pair_to_child_region (parent_reg, mgr, index, val))\n@@ -472,7 +481,8 @@ binding_map::apply_ctor_val_to_range (const region *parent_reg,\n   gcc_assert (range_key->concrete_p ());\n \n   /* Get the value.  */\n-  gcc_assert (TREE_CODE (val) != CONSTRUCTOR);\n+  if (TREE_CODE (val) == CONSTRUCTOR)\n+    return false;\n   const svalue *sval = get_svalue_for_ctor_val (val, mgr);\n \n   /* Bind the value to the range.  */"}]}