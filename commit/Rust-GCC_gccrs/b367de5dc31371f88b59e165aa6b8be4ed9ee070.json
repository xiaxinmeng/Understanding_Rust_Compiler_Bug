{"sha": "b367de5dc31371f88b59e165aa6b8be4ed9ee070", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjM2N2RlNWRjMzEzNzFmODhiNTllMTY1YWE2YjhiZTRlZDllZTA3MA==", "commit": {"author": {"name": "David Malcolm", "email": "dmalcolm@redhat.com", "date": "2017-10-23T20:25:58Z"}, "committer": {"name": "David Malcolm", "email": "dmalcolm@gcc.gnu.org", "date": "2017-10-23T20:25:58Z"}, "message": "Add INCLUDE_UNIQUE_PTR and use it (PR bootstrap/82610)\n\ngcc/ChangeLog:\n\tPR bootstrap/82610\n\t* system.h: Conditionally include \"unique-ptr.h\" if\n\tINCLUDE_UNIQUE_PTR is defined.\n\t* unique-ptr-tests.cc: Remove include of \"unique-ptr.h\" in favor\n\tof defining INCLUDE_UNIQUE_PTR before including \"system.h\".\n\ninclude/ChangeLog:\n\t* unique-ptr.h: Make include of <memory> conditional on C++11 or\n\tlater.\n\nFrom-SVN: r254024", "tree": {"sha": "8517bc2e3717c7759be570e3b44b39e5d294aeaa", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8517bc2e3717c7759be570e3b44b39e5d294aeaa"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b367de5dc31371f88b59e165aa6b8be4ed9ee070", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b367de5dc31371f88b59e165aa6b8be4ed9ee070", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b367de5dc31371f88b59e165aa6b8be4ed9ee070", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b367de5dc31371f88b59e165aa6b8be4ed9ee070/comments", "author": {"login": "davidmalcolm", "id": 1553248, "node_id": "MDQ6VXNlcjE1NTMyNDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1553248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidmalcolm", "html_url": "https://github.com/davidmalcolm", "followers_url": "https://api.github.com/users/davidmalcolm/followers", "following_url": "https://api.github.com/users/davidmalcolm/following{/other_user}", "gists_url": "https://api.github.com/users/davidmalcolm/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidmalcolm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidmalcolm/subscriptions", "organizations_url": "https://api.github.com/users/davidmalcolm/orgs", "repos_url": "https://api.github.com/users/davidmalcolm/repos", "events_url": "https://api.github.com/users/davidmalcolm/events{/privacy}", "received_events_url": "https://api.github.com/users/davidmalcolm/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "802561b2cc6cd4e4f59815f7de199026de62a650", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/802561b2cc6cd4e4f59815f7de199026de62a650", "html_url": "https://github.com/Rust-GCC/gccrs/commit/802561b2cc6cd4e4f59815f7de199026de62a650"}], "stats": {"total": 29, "additions": 27, "deletions": 2}, "files": [{"sha": "8aa652dfd111cff9a636f1293427b3af84424752", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b367de5dc31371f88b59e165aa6b8be4ed9ee070/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b367de5dc31371f88b59e165aa6b8be4ed9ee070/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=b367de5dc31371f88b59e165aa6b8be4ed9ee070", "patch": "@@ -1,3 +1,11 @@\n+2017-10-23  David Malcolm  <dmalcolm@redhat.com>\n+\n+\tPR bootstrap/82610\n+\t* system.h: Conditionally include \"unique-ptr.h\" if\n+\tINCLUDE_UNIQUE_PTR is defined.\n+\t* unique-ptr-tests.cc: Remove include of \"unique-ptr.h\" in favor\n+\tof defining INCLUDE_UNIQUE_PTR before including \"system.h\".\n+\n 2017-10-23  Sebastian Perta  <sebastian.perta@renesas.com>\n \n \t* config/rl78/rl78.md: New define_expand \"subdi3\"."}, {"sha": "cd464544ff430da9c88f837d141b6aea3b6f2b03", "filename": "gcc/system.h", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b367de5dc31371f88b59e165aa6b8be4ed9ee070/gcc%2Fsystem.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b367de5dc31371f88b59e165aa6b8be4ed9ee070/gcc%2Fsystem.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fsystem.h?ref=b367de5dc31371f88b59e165aa6b8be4ed9ee070", "patch": "@@ -720,6 +720,16 @@ extern int vsnprintf (char *, size_t, const char *, va_list);\n #define __builtin_expect(a, b) (a)\n #endif\n \n+/* Some of the headers included by <memory> can use \"abort\" within a\n+   namespace, e.g. \"_VSTD::abort();\", which fails after we use the\n+   preprocessor to redefine \"abort\" as \"fancy_abort\" below.\n+   Given that unique-ptr.h can use \"free\", we need to do this after \"free\"\n+   is declared but before \"abort\" is overridden.  */\n+\n+#ifdef INCLUDE_UNIQUE_PTR\n+# include \"unique-ptr.h\"\n+#endif\n+\n /* Redefine abort to report an internal error w/o coredump, and\n    reporting the location of the error in the source file.  */\n extern void fancy_abort (const char *, int, const char *)"}, {"sha": "d27569471898aa9b003e9f1f7e314a47b8e74792", "filename": "gcc/unique-ptr-tests.cc", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b367de5dc31371f88b59e165aa6b8be4ed9ee070/gcc%2Funique-ptr-tests.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b367de5dc31371f88b59e165aa6b8be4ed9ee070/gcc%2Funique-ptr-tests.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Funique-ptr-tests.cc?ref=b367de5dc31371f88b59e165aa6b8be4ed9ee070", "patch": "@@ -18,9 +18,9 @@ along with GCC; see the file COPYING3.  If not see\n <http://www.gnu.org/licenses/>.  */\n \n #include \"config.h\"\n+#define INCLUDE_UNIQUE_PTR\n #include \"system.h\"\n #include \"coretypes.h\"\n-#include \"unique-ptr.h\"\n #include \"selftest.h\"\n \n #if CHECKING_P"}, {"sha": "8ccc57ae7832cc8a9a8cc593949540fa9627187e", "filename": "include/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b367de5dc31371f88b59e165aa6b8be4ed9ee070/include%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b367de5dc31371f88b59e165aa6b8be4ed9ee070/include%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/include%2FChangeLog?ref=b367de5dc31371f88b59e165aa6b8be4ed9ee070", "patch": "@@ -1,3 +1,8 @@\n+2017-10-23  David Malcolm  <dmalcolm@redhat.com>\n+\n+\t* unique-ptr.h: Make include of <memory> conditional on C++11 or\n+\tlater.\n+\n 2017-10-16  Trevor Saunders  <tbsaunde+gcc@tbsaunde.org>\n \t    David Malcolm  <dmalcolm@redhat.com>\n "}, {"sha": "0b6f11a81465dfbaa51579adb260f31df5b26252", "filename": "include/unique-ptr.h", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b367de5dc31371f88b59e165aa6b8be4ed9ee070/include%2Funique-ptr.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b367de5dc31371f88b59e165aa6b8be4ed9ee070/include%2Funique-ptr.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/include%2Funique-ptr.h?ref=b367de5dc31371f88b59e165aa6b8be4ed9ee070", "patch": "@@ -74,7 +74,9 @@\n #ifndef GNU_UNIQUE_PTR_H\n #define GNU_UNIQUE_PTR_H 1\n \n-#include <memory>\n+#if __cplusplus >= 201103\n+# include <memory>\n+#endif\n \n namespace gnu\n {"}]}