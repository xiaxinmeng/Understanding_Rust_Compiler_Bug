{"sha": "e3bb089d5f7f4d615c3cf71acacbb89a89287a8e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTNiYjA4OWQ1ZjdmNGQ2MTVjM2NmNzFhY2FjYmI4OWE4OTI4N2E4ZQ==", "commit": {"author": {"name": "Ian Lance Taylor", "email": "iant@google.com", "date": "2011-01-25T15:29:02Z"}, "committer": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2011-01-25T15:29:02Z"}, "message": "lto-plugin.c (gold_version): New static variable.\n\n\t* lto-plugin.c (gold_version): New static variable.\n\t(all_symbols_read_handler): Don't check pass_through_items if\n\tusing gold 1.11 or later.\n\t(onload): Set gold_version if we see LDPT_GOLD_VERSION.\n\nFrom-SVN: r169237", "tree": {"sha": "7457b3189091fc80da5fdb55ee22562c6722c4be", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7457b3189091fc80da5fdb55ee22562c6722c4be"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e3bb089d5f7f4d615c3cf71acacbb89a89287a8e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e3bb089d5f7f4d615c3cf71acacbb89a89287a8e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e3bb089d5f7f4d615c3cf71acacbb89a89287a8e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e3bb089d5f7f4d615c3cf71acacbb89a89287a8e/comments", "author": null, "committer": null, "parents": [{"sha": "db963b528702d92bb843ff50f8d7a3d7fb34257d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/db963b528702d92bb843ff50f8d7a3d7fb34257d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/db963b528702d92bb843ff50f8d7a3d7fb34257d"}], "stats": {"total": 17, "additions": 16, "deletions": 1}, "files": [{"sha": "bda47ec471fed3000d0a4029664afb1f45d5d1ce", "filename": "lto-plugin/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e3bb089d5f7f4d615c3cf71acacbb89a89287a8e/lto-plugin%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e3bb089d5f7f4d615c3cf71acacbb89a89287a8e/lto-plugin%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/lto-plugin%2FChangeLog?ref=e3bb089d5f7f4d615c3cf71acacbb89a89287a8e", "patch": "@@ -1,3 +1,10 @@\n+2011-01-25  Ian Lance Taylor  <iant@google.com>\n+\n+\t* lto-plugin.c (gold_version): New static variable.\n+\t(all_symbols_read_handler): Don't check pass_through_items if\n+\tusing gold 1.11 or later.\n+\t(onload): Set gold_version if we see LDPT_GOLD_VERSION.\n+\n 2011-01-12  Richard Guenther  <rguenther@suse.de>\n \n \tPR lto/47264"}, {"sha": "64a0164da3cf1766d03633eb475605ba5d348040", "filename": "lto-plugin/lto-plugin.c", "status": "modified", "additions": 9, "deletions": 1, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e3bb089d5f7f4d615c3cf71acacbb89a89287a8e/lto-plugin%2Flto-plugin.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e3bb089d5f7f4d615c3cf71acacbb89a89287a8e/lto-plugin%2Flto-plugin.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/lto-plugin%2Flto-plugin.c?ref=e3bb089d5f7f4d615c3cf71acacbb89a89287a8e", "patch": "@@ -152,6 +152,10 @@ static char debug;\n static char nop;\n static char *resolution_file = NULL;\n \n+/* The version of gold being used, or -1 if not gold.  The number is\n+   MAJOR * 100 + MINOR.  */\n+static int gold_version = -1;\n+\n /* Not used by default, but can be overridden at runtime\n    by using -plugin-opt=-sym-style={none,win32,underscore|uscore}\n    (in fact, only first letter of style arg is checked.)  */\n@@ -622,7 +626,8 @@ all_symbols_read_handler (void)\n \n   free (lto_argv);\n \n-  if (pass_through_items)\n+  /* --pass-through is not needed when using gold 1.11 or later.  */\n+  if (pass_through_items && gold_version < 111)\n     {\n       unsigned int i;\n       for (i = 0; i < num_pass_through_items; i++)\n@@ -998,6 +1003,9 @@ onload (struct ld_plugin_tv *tv)\n \tcase LDPT_OPTION:\n \t  process_option (p->tv_u.tv_string);\n \t  break;\n+\tcase LDPT_GOLD_VERSION:\n+\t  gold_version = p->tv_u.tv_val;\n+\t  break;\n \tdefault:\n \t  break;\n \t}"}]}