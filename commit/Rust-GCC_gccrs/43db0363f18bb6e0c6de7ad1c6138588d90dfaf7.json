{"sha": "43db0363f18bb6e0c6de7ad1c6138588d90dfaf7", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDNkYjAzNjNmMThiYjZlMGM2ZGU3YWQxYzYxMzg1ODhkOTBkZmFmNw==", "commit": {"author": {"name": "Richard Kenner", "email": "kenner@vlsi1.ultra.nyu.edu", "date": "2000-08-16T11:59:03Z"}, "committer": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "2000-08-16T11:59:03Z"}, "message": "calls.c (calls_function_1, [...]): Only test TYPE_RETURNS_STACK_DEPRESSED for FUNCTION_TYPE.\n\n\t* calls.c (calls_function_1, expand_call): Only test\n\tTYPE_RETURNS_STACK_DEPRESSED for FUNCTION_TYPE.\n\t* function.c (thread_prologue_and_epilogue_insns): Likewise.\n\nFrom-SVN: r35743", "tree": {"sha": "f52f5b59263e90bcf12f1bfd831bf0ede843f644", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f52f5b59263e90bcf12f1bfd831bf0ede843f644"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/43db0363f18bb6e0c6de7ad1c6138588d90dfaf7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/43db0363f18bb6e0c6de7ad1c6138588d90dfaf7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/43db0363f18bb6e0c6de7ad1c6138588d90dfaf7", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/43db0363f18bb6e0c6de7ad1c6138588d90dfaf7/comments", "author": null, "committer": null, "parents": [{"sha": "853d88280aa4989f22b716b55f80b0d36ae5fc27", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/853d88280aa4989f22b716b55f80b0d36ae5fc27", "html_url": "https://github.com/Rust-GCC/gccrs/commit/853d88280aa4989f22b716b55f80b0d36ae5fc27"}], "stats": {"total": 18, "additions": 14, "deletions": 4}, "files": [{"sha": "6aa5df572c3055eecdcfdbb5306045e5315c6da6", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/43db0363f18bb6e0c6de7ad1c6138588d90dfaf7/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/43db0363f18bb6e0c6de7ad1c6138588d90dfaf7/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=43db0363f18bb6e0c6de7ad1c6138588d90dfaf7", "patch": "@@ -1,3 +1,9 @@\n+Wed Aug 16 08:10:32 2000  Richard Kenner  <kenner@vlsi1.ultra.nyu.edu>\n+\n+\t* calls.c (calls_function_1, expand_call): Only test\n+\tTYPE_RETURNS_STACK_DEPRESSED for FUNCTION_TYPE.\n+\t* function.c (thread_prologue_and_epilogue_insns): Likewise.\n+\n 2000-08-16  Richard Henderson  <rth@cygnus.com>\n \n \t* combine.c (simplify_shift_const): Revert previous two"}, {"sha": "2d0d52c40f64c53dc600d1626b50d7c60c55618b", "filename": "gcc/calls.c", "status": "modified", "additions": 6, "deletions": 3, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/43db0363f18bb6e0c6de7ad1c6138588d90dfaf7/gcc%2Fcalls.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/43db0363f18bb6e0c6de7ad1c6138588d90dfaf7/gcc%2Fcalls.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcalls.c?ref=43db0363f18bb6e0c6de7ad1c6138588d90dfaf7", "patch": "@@ -281,8 +281,10 @@ calls_function_1 (exp, which)\n     case CALL_EXPR:\n       if (which == 0)\n \treturn 1;\n-      else if (TYPE_RETURNS_STACK_DEPRESSED\n-\t       (TREE_TYPE (TREE_TYPE (TREE_OPERAND (exp, 0)))))\n+      else if ((TREE_CODE (TREE_TYPE (TREE_TYPE (TREE_OPERAND (exp, 0))))\n+\t\t== FUNCTION_TYPE)\n+\t       && (TYPE_RETURNS_STACK_DEPRESSED\n+\t\t   (TREE_TYPE (TREE_TYPE (TREE_OPERAND (exp, 0))))))\n \treturn 1;\n       else if (TREE_CODE (TREE_OPERAND (exp, 0)) == ADDR_EXPR\n \t       && (TREE_CODE (TREE_OPERAND (TREE_OPERAND (exp, 0), 0))\n@@ -2195,7 +2197,8 @@ expand_call (exp, target, ignore)\n     flags |= flags_from_decl_or_type (TREE_TYPE (TREE_TYPE (p)));\n \n   /* Mark if the function returns with the stack pointer depressed.  */\n-  if (TYPE_RETURNS_STACK_DEPRESSED (TREE_TYPE (TREE_TYPE (p))))\n+  if (TREE_CODE (TREE_TYPE (TREE_TYPE (p))) == FUNCTION_TYPE\n+      && TYPE_RETURNS_STACK_DEPRESSED (TREE_TYPE (TREE_TYPE (p))))\n     {\n       flags |= ECF_SP_DEPRESSED;\n       flags &= ~ (ECF_PURE | ECF_CONST);"}, {"sha": "7601c94ef3612cd6d03fd30e35b94263262004f4", "filename": "gcc/function.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/43db0363f18bb6e0c6de7ad1c6138588d90dfaf7/gcc%2Ffunction.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/43db0363f18bb6e0c6de7ad1c6138588d90dfaf7/gcc%2Ffunction.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffunction.c?ref=43db0363f18bb6e0c6de7ad1c6138588d90dfaf7", "patch": "@@ -7058,7 +7058,8 @@ thread_prologue_and_epilogue_insns (f)\n \n       /* If this function returns with the stack depressed, massage\n \t the epilogue to actually do that.  */\n-      if (TYPE_RETURNS_STACK_DEPRESSED (TREE_TYPE (current_function_decl)))\n+      if (TREE_CODE (TREE_TYPE (current_function_decl)) == FUNCTION_TYPE\n+\t  && TYPE_RETURNS_STACK_DEPRESSED (TREE_TYPE (current_function_decl)))\n \tkeep_stack_depressed (seq);\n \n       emit_jump_insn (seq);"}]}