{"sha": "dca9e8be87dafdc558e3554c1c21f599918509a5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZGNhOWU4YmU4N2RhZmRjNTU4ZTM1NTRjMWMyMWY1OTk5MTg1MDlhNQ==", "commit": {"author": {"name": "Thomas Koenig", "email": "tkoenig@gcc.gnu.org", "date": "2018-01-30T20:49:49Z"}, "committer": {"name": "Thomas Koenig", "email": "tkoenig@gcc.gnu.org", "date": "2018-01-30T20:49:49Z"}, "message": "re PR fortran/84133 (ICE in gimplify_var_or_parm_decl, at gimplify.c:2706)\n\n2018-01-30  Thomas Koenig  <tkoenig@gcc.gnu.org>\n\n\tPR fortran/84133\n\t* frontend-passes (matmul_to_var_expr): Return early if\n\tin association list.\n\t(inline_matmul_assign): Likewise.\n\n2018-01-30  Thomas Koenig  <tkoenig@gcc.gnu.org>\n\n\tPR fortran/84133\n\t* gfortran.dg/inline_matmul_21.f90: New test case.\n\nFrom-SVN: r257206", "tree": {"sha": "0c807d129d15c5f0eff26e8cbeba570e4971187f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0c807d129d15c5f0eff26e8cbeba570e4971187f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/dca9e8be87dafdc558e3554c1c21f599918509a5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dca9e8be87dafdc558e3554c1c21f599918509a5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dca9e8be87dafdc558e3554c1c21f599918509a5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dca9e8be87dafdc558e3554c1c21f599918509a5/comments", "author": null, "committer": null, "parents": [{"sha": "881f7c9735c14d6cd4d98f3fbd68cc3e2d906ecd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/881f7c9735c14d6cd4d98f3fbd68cc3e2d906ecd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/881f7c9735c14d6cd4d98f3fbd68cc3e2d906ecd"}], "stats": {"total": 31, "additions": 29, "deletions": 2}, "files": [{"sha": "292abc159531117775f2132735d11aadb0cd178f", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dca9e8be87dafdc558e3554c1c21f599918509a5/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dca9e8be87dafdc558e3554c1c21f599918509a5/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=dca9e8be87dafdc558e3554c1c21f599918509a5", "patch": "@@ -1,3 +1,10 @@\n+2018-01-30  Thomas Koenig  <tkoenig@gcc.gnu.org>\n+\n+\tPR fortran/84133\n+\t* frontend-passes (matmul_to_var_expr): Return early if\n+\tin association list.\n+\t(inline_matmul_assign): Likewise.\n+\n 2017-01-29  Thomas Koenig  <tkoenig@gcc.gnu.org>\n \n \tPR fortran/84073"}, {"sha": "11a5b9b779c7b58208edf196af24728f32113808", "filename": "gcc/fortran/frontend-passes.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dca9e8be87dafdc558e3554c1c21f599918509a5/gcc%2Ffortran%2Ffrontend-passes.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dca9e8be87dafdc558e3554c1c21f599918509a5/gcc%2Ffortran%2Ffrontend-passes.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ffrontend-passes.c?ref=dca9e8be87dafdc558e3554c1c21f599918509a5", "patch": "@@ -2763,7 +2763,7 @@ matmul_to_var_expr (gfc_expr **ep, int *walk_subtrees ATTRIBUTE_UNUSED,\n     return 0;\n \n   if (forall_level > 0 || iterator_level > 0 || in_omp_workshare\n-      || in_where)\n+      || in_where || in_assoc_list)\n     return 0;\n \n   /* Check if this is already in the form c = matmul(a,b).  */\n@@ -3728,7 +3728,7 @@ inline_matmul_assign (gfc_code **c, int *walk_subtrees,\n   if (co->op != EXEC_ASSIGN)\n     return 0;\n \n-  if (in_where)\n+  if (in_where || in_assoc_list)\n     return 0;\n \n   /* The BLOCKS generated for the temporary variables and FORALL don't"}, {"sha": "b1a7ba859964a8344064e5d8795aa450403586e2", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dca9e8be87dafdc558e3554c1c21f599918509a5/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dca9e8be87dafdc558e3554c1c21f599918509a5/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=dca9e8be87dafdc558e3554c1c21f599918509a5", "patch": "@@ -1,3 +1,8 @@\n+2018-01-30  Thomas Koenig  <tkoenig@gcc.gnu.org>\n+\n+\tPR fortran/84133\n+\t* gfortran.dg/inline_matmul_21.f90: New test case.\n+\n 2018-01-30  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>\n \n \t* g++.dg/torture/pr81360.C: Add -fdump-ipa-icf to dg-options."}, {"sha": "5bfda8b6f8d1093b2e94e90fe905146bed2d13cd", "filename": "gcc/testsuite/gfortran.dg/inline_matmul_21.f90", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dca9e8be87dafdc558e3554c1c21f599918509a5/gcc%2Ftestsuite%2Fgfortran.dg%2Finline_matmul_21.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dca9e8be87dafdc558e3554c1c21f599918509a5/gcc%2Ftestsuite%2Fgfortran.dg%2Finline_matmul_21.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Finline_matmul_21.f90?ref=dca9e8be87dafdc558e3554c1c21f599918509a5", "patch": "@@ -0,0 +1,15 @@\n+! { dg-do compile }\n+! { dg-additional-options \"-ffrontend-optimize\" }\n+! PR 84133 - this used to ICE. Original test case by\n+! Gerhard Steinmetz.\n+\n+program p\n+   real :: x(2,2) = 1.0\n+   real :: z(2,2)\n+   associate (y => matmul(x,x))\n+      z = y\n+   end associate\n+   print *, z\n+end\n+\n+  "}]}