{"sha": "6915c1cea268ed78af4db03fe631e927d63fdf0c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjkxNWMxY2VhMjY4ZWQ3OGFmNGRiMDNmZTYzMWU5MjdkNjNmZGYwYw==", "commit": {"author": {"name": "Ulrich Weigand", "email": "uweigand@de.ibm.com", "date": "2006-10-23T13:38:50Z"}, "committer": {"name": "Ulrich Weigand", "email": "uweigand@gcc.gnu.org", "date": "2006-10-23T13:38:50Z"}, "message": "predicates.md (\"bras_sym_operand\"): Do not accept nonlocal function symbols if flag_pic.\n\nChangeLog:\n\n\t* config/s390/predicates.md (\"bras_sym_operand\"): Do not accept\n\tnonlocal function symbols if flag_pic.\n\ntestsuite/ChangeLog:\n\n\t* g++.dg/other/s390-1.C: New testcase.\n\nFrom-SVN: r117973", "tree": {"sha": "eb6ff9a62aaa3a30a0283ef270a97f90d5e21443", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/eb6ff9a62aaa3a30a0283ef270a97f90d5e21443"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6915c1cea268ed78af4db03fe631e927d63fdf0c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6915c1cea268ed78af4db03fe631e927d63fdf0c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6915c1cea268ed78af4db03fe631e927d63fdf0c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6915c1cea268ed78af4db03fe631e927d63fdf0c/comments", "author": null, "committer": null, "parents": [{"sha": "b0cd88d2161d4b0ba7e0f80a645379c888790463", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b0cd88d2161d4b0ba7e0f80a645379c888790463", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b0cd88d2161d4b0ba7e0f80a645379c888790463"}], "stats": {"total": 44, "additions": 43, "deletions": 1}, "files": [{"sha": "4c022e5071b53ea752499e1cd41b36fc8b180eae", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6915c1cea268ed78af4db03fe631e927d63fdf0c/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6915c1cea268ed78af4db03fe631e927d63fdf0c/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=6915c1cea268ed78af4db03fe631e927d63fdf0c", "patch": "@@ -1,3 +1,8 @@\n+2006-10-23  Ulrich Weigand  <uweigand@de.ibm.com>\n+\n+\t* config/s390/predicates.md (\"bras_sym_operand\"): Do not accept\n+\tnonlocal function symbols if flag_pic.\n+\n 2006-10-23  Richard Guenther  <rguenther@suse.de>\n \n \tPR middle-end/27132"}, {"sha": "5f9e8d4389205322920c539e45f3152a55df9e40", "filename": "gcc/config/s390/predicates.md", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6915c1cea268ed78af4db03fe631e927d63fdf0c/gcc%2Fconfig%2Fs390%2Fpredicates.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6915c1cea268ed78af4db03fe631e927d63fdf0c/gcc%2Fconfig%2Fs390%2Fpredicates.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fs390%2Fpredicates.md?ref=6915c1cea268ed78af4db03fe631e927d63fdf0c", "patch": "@@ -62,7 +62,8 @@\n ;; Allow SYMBOL_REFs and @PLT stubs.\n \n (define_special_predicate \"bras_sym_operand\"\n-  (ior (match_code \"symbol_ref\")\n+  (ior (and (match_code \"symbol_ref\")\n+\t    (match_test \"!flag_pic || SYMBOL_REF_LOCAL_P (op)\"))\n        (and (match_code \"const\")\n \t    (and (match_test \"GET_CODE (XEXP (op, 0)) == UNSPEC\")\n \t\t (match_test \"XINT (XEXP (op, 0), 1) == UNSPEC_PLT\")))))"}, {"sha": "b5cd9012f62f587160a5e3360cf48f375006ddd8", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6915c1cea268ed78af4db03fe631e927d63fdf0c/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6915c1cea268ed78af4db03fe631e927d63fdf0c/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=6915c1cea268ed78af4db03fe631e927d63fdf0c", "patch": "@@ -1,3 +1,7 @@\n+2006-10-23  Ulrich Weigand  <uweigand@de.ibm.com>\n+\n+\t* g++.dg/other/s390-1.C: New testcase.\n+\n 2006-10-23  Richard Guenther  <rguenther@suse.de>\n \n \tPR middle-end/27132"}, {"sha": "bf37ca449e34f98779804968da0ff04c3466b3d7", "filename": "gcc/testsuite/g++.dg/other/s390-1.C", "status": "added", "additions": 32, "deletions": 0, "changes": 32, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6915c1cea268ed78af4db03fe631e927d63fdf0c/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fs390-1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6915c1cea268ed78af4db03fe631e927d63fdf0c/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fs390-1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fs390-1.C?ref=6915c1cea268ed78af4db03fe631e927d63fdf0c", "patch": "@@ -0,0 +1,32 @@\n+// { dg-do compile { target s390x-*-* } }\n+// { dg-options \"-O3 -fPIC\" }\n+\n+class A\n+{\n+public:\n+  void f (void) { _M_a = 0; }\n+  void g (void) { _M_a = 1; }\n+  void h (void);\n+\n+private:\n+  int _M_a;\n+};\n+\n+class B : virtual public A\n+{\n+};\n+\n+void\n+test (B& x)\n+{\n+  for (int i = 0; i < 17; i++)\n+   {\n+     x.f ();\n+     (x.*&A::g) ();\n+     x.h ();\n+   }\n+}\n+\n+// Check that every call to A::g goes via the PLT.\n+// { dg-final { scan-assembler-not \"brasl\\[^@\\]*\\n\" } }\n+"}]}