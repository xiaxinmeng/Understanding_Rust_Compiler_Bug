{"sha": "0984258e474b6f071a995579fe5896d13fe2d58a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDk4NDI1OGU0NzRiNmYwNzFhOTk1NTc5ZmU1ODk2ZDEzZmUyZDU4YQ==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2019-08-14T09:51:48Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "pmderodat@gcc.gnu.org", "date": "2019-08-14T09:51:48Z"}, "message": "[Ada] Remove obsolete Pending_Descriptor table and related bits\n\nThe table has been unused for a while.  No functional changes.\n\n2019-08-14  Eric Botcazou  <ebotcazou@adacore.com>\n\ngcc/ada/\n\n\t* inline.ads (Pending_Descriptor): Delete.\n\t* inline.adb (Initialize): Do not initialize it.\n\t* sem_ch12.adb (Delay_Descriptors): Delete.\n\t(Analyze_Package_Instantiation): Call\n\tSet_Delay_Subprogram_Descriptors instead of Delay_Descriptors\n\tthroughout.\n\nFrom-SVN: r274459", "tree": {"sha": "348d8b61194179479a134c1ba462e95dacab5b6c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/348d8b61194179479a134c1ba462e95dacab5b6c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0984258e474b6f071a995579fe5896d13fe2d58a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0984258e474b6f071a995579fe5896d13fe2d58a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0984258e474b6f071a995579fe5896d13fe2d58a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0984258e474b6f071a995579fe5896d13fe2d58a/comments", "author": null, "committer": null, "parents": [{"sha": "f056076f5fe77fe8b13050eb3affc4c8ac700722", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f056076f5fe77fe8b13050eb3affc4c8ac700722", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f056076f5fe77fe8b13050eb3affc4c8ac700722"}], "stats": {"total": 47, "additions": 13, "deletions": 34}, "files": [{"sha": "8f981a84d7a6de8fa2aa1b301edd07f1bc20c9cb", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0984258e474b6f071a995579fe5896d13fe2d58a/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0984258e474b6f071a995579fe5896d13fe2d58a/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=0984258e474b6f071a995579fe5896d13fe2d58a", "patch": "@@ -1,3 +1,12 @@\n+2019-08-14  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* inline.ads (Pending_Descriptor): Delete.\n+\t* inline.adb (Initialize): Do not initialize it.\n+\t* sem_ch12.adb (Delay_Descriptors): Delete.\n+\t(Analyze_Package_Instantiation): Call\n+\tSet_Delay_Subprogram_Descriptors instead of Delay_Descriptors\n+\tthroughout.\n+\n 2019-08-14  Bob Duff  <duff@adacore.com>\n \n \t* exp_aggr.adb (Init_Hidden_Discriminants): Avoid processing the"}, {"sha": "862f047707d5291ab493b181be530b3dcf89fd81", "filename": "gcc/ada/inline.adb", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0984258e474b6f071a995579fe5896d13fe2d58a/gcc%2Fada%2Finline.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0984258e474b6f071a995579fe5896d13fe2d58a/gcc%2Fada%2Finline.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Finline.adb?ref=0984258e474b6f071a995579fe5896d13fe2d58a", "patch": "@@ -4209,7 +4209,6 @@ package body Inline is\n \n    procedure Initialize is\n    begin\n-      Pending_Descriptor.Init;\n       Pending_Instantiations.Init;\n       Inlined_Bodies.Init;\n       Successors.Init;"}, {"sha": "5af42f958c6797d3d6e0d4f1025d4f6a50f2614f", "filename": "gcc/ada/inline.ads", "status": "modified", "additions": 0, "deletions": 14, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0984258e474b6f071a995579fe5896d13fe2d58a/gcc%2Fada%2Finline.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0984258e474b6f071a995579fe5896d13fe2d58a/gcc%2Fada%2Finline.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Finline.ads?ref=0984258e474b6f071a995579fe5896d13fe2d58a", "patch": "@@ -108,20 +108,6 @@ package Inline is\n      Table_Increment      => Alloc.Pending_Instantiations_Increment,\n      Table_Name           => \"Pending_Instantiations\");\n \n-   --  The following table records subprograms and packages for which\n-   --  generation of subprogram descriptors must be delayed.\n-\n-   package Pending_Descriptor is new Table.Table (\n-     Table_Component_Type => Entity_Id,\n-     Table_Index_Type     => Int,\n-     Table_Low_Bound      => 0,\n-     Table_Initial        => Alloc.Pending_Instantiations_Initial,\n-     Table_Increment      => Alloc.Pending_Instantiations_Increment,\n-     Table_Name           => \"Pending_Descriptor\");\n-\n-   --  The following should be initialized in an init call in Frontend, we\n-   --  have thoughts of making the frontend reusable in future ???\n-\n    -----------------\n    -- Subprograms --\n    -----------------"}, {"sha": "06afd2aa62cc1305f4ba8d792fc11f0a56d12710", "filename": "gcc/ada/sem_ch12.adb", "status": "modified", "additions": 4, "deletions": 19, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0984258e474b6f071a995579fe5896d13fe2d58a/gcc%2Fada%2Fsem_ch12.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0984258e474b6f071a995579fe5896d13fe2d58a/gcc%2Fada%2Fsem_ch12.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch12.adb?ref=0984258e474b6f071a995579fe5896d13fe2d58a", "patch": "@@ -3846,27 +3846,12 @@ package body Sem_Ch12 is\n    procedure Analyze_Package_Instantiation (N : Node_Id) is\n       Has_Inline_Always : Boolean := False;\n \n-      procedure Delay_Descriptors (E : Entity_Id);\n-      --  Delay generation of subprogram descriptors for given entity\n-\n       function Might_Inline_Subp (Gen_Unit : Entity_Id) return Boolean;\n       --  If inlining is active and the generic contains inlined subprograms,\n       --  we instantiate the body. This may cause superfluous instantiations,\n       --  but it is simpler than detecting the need for the body at the point\n       --  of inlining, when the context of the instance is not available.\n \n-      -----------------------\n-      -- Delay_Descriptors --\n-      -----------------------\n-\n-      procedure Delay_Descriptors (E : Entity_Id) is\n-      begin\n-         if not Delay_Subprogram_Descriptors (E) then\n-            Set_Delay_Subprogram_Descriptors (E);\n-            Pending_Descriptor.Append (E);\n-         end if;\n-      end Delay_Descriptors;\n-\n       -----------------------\n       -- Might_Inline_Subp --\n       -----------------------\n@@ -4468,10 +4453,10 @@ package body Sem_Ch12 is\n                      if Ekind (Enclosing_Master) = E_Package then\n                         if Is_Compilation_Unit (Enclosing_Master) then\n                            if In_Package_Body (Enclosing_Master) then\n-                              Delay_Descriptors\n+                              Set_Delay_Subprogram_Descriptors\n                                 (Body_Entity (Enclosing_Master));\n                            else\n-                              Delay_Descriptors\n+                              Set_Delay_Subprogram_Descriptors\n                                 (Enclosing_Master);\n                            end if;\n \n@@ -4511,7 +4496,7 @@ package body Sem_Ch12 is\n                         end loop;\n \n                         if Is_Subprogram (Enclosing_Master) then\n-                           Delay_Descriptors (Enclosing_Master);\n+                           Set_Delay_Subprogram_Descriptors (Enclosing_Master);\n \n                         elsif Is_Task_Type (Enclosing_Master) then\n                            declare\n@@ -4520,7 +4505,7 @@ package body Sem_Ch12 is\n                                         (Enclosing_Master);\n                            begin\n                               if Present (TBP) then\n-                                 Delay_Descriptors  (TBP);\n+                                 Set_Delay_Subprogram_Descriptors (TBP);\n                                  Set_Delay_Cleanups (TBP);\n                               end if;\n                            end;"}]}