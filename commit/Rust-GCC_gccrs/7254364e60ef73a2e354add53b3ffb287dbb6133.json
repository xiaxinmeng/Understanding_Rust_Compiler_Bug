{"sha": "7254364e60ef73a2e354add53b3ffb287dbb6133", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzI1NDM2NGU2MGVmNzNhMmUzNTRhZGQ1M2IzZmZiMjg3ZGJiNjEzMw==", "commit": {"author": {"name": "Alexandre Oliva", "email": "aoliva@redhat.com", "date": "2010-06-20T23:57:54Z"}, "committer": {"name": "Alexandre Oliva", "email": "aoliva@gcc.gnu.org", "date": "2010-06-20T23:57:54Z"}, "message": "re PR lto/44248 (-fcompare-debug failure with -flto/-fwhopr -g)\n\nPR debug/44248\n* lto-streamer-in.c (input_bb): Leave debug stmts alone.\n(input_function): Drop them here, if VTA is disabled.\n\nFrom-SVN: r161056", "tree": {"sha": "1f74699e3510fcfa2f6c9022caa7742fdee4fc2c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1f74699e3510fcfa2f6c9022caa7742fdee4fc2c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7254364e60ef73a2e354add53b3ffb287dbb6133", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7254364e60ef73a2e354add53b3ffb287dbb6133", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7254364e60ef73a2e354add53b3ffb287dbb6133", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7254364e60ef73a2e354add53b3ffb287dbb6133/comments", "author": null, "committer": null, "parents": [{"sha": "dedd9d0500596157cd1db1957e8ed0dd3ba2ac36", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dedd9d0500596157cd1db1957e8ed0dd3ba2ac36", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dedd9d0500596157cd1db1957e8ed0dd3ba2ac36"}], "stats": {"total": 34, "additions": 24, "deletions": 10}, "files": [{"sha": "f827fabc6de7c67aecae52043bbfd96350305c3f", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7254364e60ef73a2e354add53b3ffb287dbb6133/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7254364e60ef73a2e354add53b3ffb287dbb6133/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=7254364e60ef73a2e354add53b3ffb287dbb6133", "patch": "@@ -1,3 +1,9 @@\n+2010-06-20  Alexandre Oliva  <aoliva@redhat.com>\n+\n+\tPR debug/44248\n+\t* lto-streamer-in.c (input_bb): Leave debug stmts alone.\n+\t(input_function): Drop them here, if VTA is disabled.\n+\n 2010-06-20  Uros Bizjak  <ubizjak@gmail.com>\n \n \tPR target/44546"}, {"sha": "635cff4d3f53c18684e34bec780cafb9c60e8df4", "filename": "gcc/lto-streamer-in.c", "status": "modified", "additions": 18, "deletions": 10, "changes": 28, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7254364e60ef73a2e354add53b3ffb287dbb6133/gcc%2Flto-streamer-in.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7254364e60ef73a2e354add53b3ffb287dbb6133/gcc%2Flto-streamer-in.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flto-streamer-in.c?ref=7254364e60ef73a2e354add53b3ffb287dbb6133", "patch": "@@ -1204,13 +1204,6 @@ input_bb (struct lto_input_block *ib, enum LTO_tags tag,\n     {\n       gimple stmt = input_gimple_stmt (ib, data_in, fn, tag);\n \n-      /* Change debug stmts to nops on-the-fly if we do not have VTA enabled.\n-\t This allows us to build for example static libs with debugging\n-\t enabled and do the final link without.  */\n-      if (!MAY_HAVE_DEBUG_STMTS\n-\t  && is_gimple_debug (stmt))\n-\tstmt = gimple_build_nop ();\n-\n       find_referenced_vars_in (stmt);\n       gsi_insert_after (&bsi, stmt, GSI_NEW_STMT);\n \n@@ -1370,11 +1363,26 @@ input_function (tree fn_decl, struct data_in *data_in,\n   stmts = (gimple *) xcalloc (gimple_stmt_max_uid (fn), sizeof (gimple));\n   FOR_ALL_BB (bb)\n     {\n-      gimple_stmt_iterator bsi;\n-      for (bsi = gsi_start_bb (bb); !gsi_end_p (bsi); gsi_next (&bsi))\n+      gimple_stmt_iterator bsi = gsi_start_bb (bb);\n+      while (!gsi_end_p (bsi))\n \t{\n \t  gimple stmt = gsi_stmt (bsi);\n-\t  stmts[gimple_uid (stmt)] = stmt;\n+\t  /* If we're recompiling LTO objects with debug stmts but\n+\t     we're not supposed to have debug stmts, remove them now.\n+\t     We can't remove them earlier because this would cause uid\n+\t     mismatches in fixups, but we can do it at this point, as\n+\t     long as debug stmts don't require fixups.  */\n+\t  if (!MAY_HAVE_DEBUG_STMTS && is_gimple_debug (stmt))\n+\t    {\n+\t      gimple_stmt_iterator gsi = bsi;\n+\t      gsi_next (&bsi);\n+\t      gsi_remove (&gsi, true);\n+\t    }\n+\t  else\n+\t    {\n+\t      gsi_next (&bsi);\n+\t      stmts[gimple_uid (stmt)] = stmt;\n+\t    }\n \t}\n     }\n "}]}