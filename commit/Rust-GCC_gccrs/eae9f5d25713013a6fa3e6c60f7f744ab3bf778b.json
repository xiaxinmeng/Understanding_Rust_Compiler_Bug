{"sha": "eae9f5d25713013a6fa3e6c60f7f744ab3bf778b", "node_id": "C_kwDOANBUbNoAKGVhZTlmNWQyNTcxMzAxM2E2ZmEzZTZjNjBmN2Y3NDRhYjNiZjc3OGI", "commit": {"author": {"name": "Julien Bortolussi", "email": "bortolussi@adacore.com", "date": "2022-08-04T16:15:13Z"}, "committer": {"name": "Marc Poulhi\u00e8s", "email": "poulhies@adacore.com", "date": "2022-09-06T07:14:21Z"}, "message": "[Ada] Fix a bug in the contract of formal ordered sets\n\nThere are 2 main issues in the postcondition of the function Replace\nof the formal ordered sets, in the sub package Generic_Keys. One is\nrelated to the fact that when the element is changed, the key is\nalso changed. The second one is due to the fact that the arrival of\nthe new element might modify the ordering of the set and thus\nthe Positions might be modified.\nAs a consequence, the postcondition might be false and thus fail\nat runtime.\n\ngcc/ada/\n\n\t* libgnat/a-cforse.ads (Replace): Fix the postcondition.", "tree": {"sha": "b075e3b68d6e89a1260a918977e6ec2f99981d0a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b075e3b68d6e89a1260a918977e6ec2f99981d0a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/eae9f5d25713013a6fa3e6c60f7f744ab3bf778b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/eae9f5d25713013a6fa3e6c60f7f744ab3bf778b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/eae9f5d25713013a6fa3e6c60f7f744ab3bf778b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/eae9f5d25713013a6fa3e6c60f7f744ab3bf778b/comments", "author": {"login": "JulienBortolussiAda", "id": 103429088, "node_id": "U_kgDOBioz4A", "avatar_url": "https://avatars.githubusercontent.com/u/103429088?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JulienBortolussiAda", "html_url": "https://github.com/JulienBortolussiAda", "followers_url": "https://api.github.com/users/JulienBortolussiAda/followers", "following_url": "https://api.github.com/users/JulienBortolussiAda/following{/other_user}", "gists_url": "https://api.github.com/users/JulienBortolussiAda/gists{/gist_id}", "starred_url": "https://api.github.com/users/JulienBortolussiAda/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JulienBortolussiAda/subscriptions", "organizations_url": "https://api.github.com/users/JulienBortolussiAda/orgs", "repos_url": "https://api.github.com/users/JulienBortolussiAda/repos", "events_url": "https://api.github.com/users/JulienBortolussiAda/events{/privacy}", "received_events_url": "https://api.github.com/users/JulienBortolussiAda/received_events", "type": "User", "site_admin": false}, "committer": {"login": "dkm", "id": 87603, "node_id": "MDQ6VXNlcjg3NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/87603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dkm", "html_url": "https://github.com/dkm", "followers_url": "https://api.github.com/users/dkm/followers", "following_url": "https://api.github.com/users/dkm/following{/other_user}", "gists_url": "https://api.github.com/users/dkm/gists{/gist_id}", "starred_url": "https://api.github.com/users/dkm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dkm/subscriptions", "organizations_url": "https://api.github.com/users/dkm/orgs", "repos_url": "https://api.github.com/users/dkm/repos", "events_url": "https://api.github.com/users/dkm/events{/privacy}", "received_events_url": "https://api.github.com/users/dkm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c56c7d3aeb050ddfe7a41cc00ce5eaa5c4edd636", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c56c7d3aeb050ddfe7a41cc00ce5eaa5c4edd636", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c56c7d3aeb050ddfe7a41cc00ce5eaa5c4edd636"}], "stats": {"total": 7, "additions": 4, "deletions": 3}, "files": [{"sha": "f6cca0fe05282e3fc73dc31e314af173911fe16e", "filename": "gcc/ada/libgnat/a-cforse.ads", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eae9f5d25713013a6fa3e6c60f7f744ab3bf778b/gcc%2Fada%2Flibgnat%2Fa-cforse.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eae9f5d25713013a6fa3e6c60f7f744ab3bf778b/gcc%2Fada%2Flibgnat%2Fa-cforse.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flibgnat%2Fa-cforse.ads?ref=eae9f5d25713013a6fa3e6c60f7f744ab3bf778b", "patch": "@@ -1598,7 +1598,7 @@ is\n \n              --  Key now maps to New_Item\n \n-             and Element (Container, Key) = New_Item\n+             and Element (Container, Find (Container, Key)'Old) = New_Item\n \n              --  New_Item is contained in Container\n \n@@ -1622,8 +1622,9 @@ is\n                     E_Right  => Elements (Container),\n                     P_Left   => Positions (Container)'Old,\n                     P_Right  => Positions (Container),\n-                    Position => Find (Container, Key))\n-             and Positions (Container) = Positions (Container)'Old;\n+                    Position => Find (Container, Key)'Old)\n+             and P.Keys_Included (Positions (Container),\n+                                  Positions (Container)'Old);\n \n       procedure Exclude (Container : in out Set; Key : Key_Type) with\n         Global         => null,"}]}