{"sha": "a81f4b678524dbc3c3614f785c5bfee0944ce522", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTgxZjRiNjc4NTI0ZGJjM2MzNjE0Zjc4NWM1YmZlZTA5NDRjZTUyMg==", "commit": {"author": {"name": "Daniel Kraft", "email": "d@domob.eu", "date": "2010-10-12T13:30:53Z"}, "committer": {"name": "Daniel Kraft", "email": "domob@gcc.gnu.org", "date": "2010-10-12T13:30:53Z"}, "message": "re PR fortran/38936 ([F03] ASSOCIATE construct / improved SELECT TYPE (a=>expr))\n\n2010-10-12  Daniel Kraft  <d@domob.eu>\n\n\tPR fortran/38936\n\t* parse.c (parse_associate): Set typespec of associate-name if that of\n\tthe target is already available.\n\n2010-10-12  Daniel Kraft  <d@domob.eu>\n\n\tPR fortran/38936\n\t* gfortran.dg/associate_1.f03: More tests with derived-types.\n\t* gfortran.dg/associate_9.f03: New test (XFAIL for now).\n\t* gfortran.dg/associate_8.f03: Fix typo.\n\t* gfortran.dg/initialization_27.f90: Fix typo.\n\nFrom-SVN: r165378", "tree": {"sha": "990f5cbdbf6138633ef12dc690bc1ecdae5a3b56", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/990f5cbdbf6138633ef12dc690bc1ecdae5a3b56"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a81f4b678524dbc3c3614f785c5bfee0944ce522", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a81f4b678524dbc3c3614f785c5bfee0944ce522", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a81f4b678524dbc3c3614f785c5bfee0944ce522", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a81f4b678524dbc3c3614f785c5bfee0944ce522/comments", "author": {"login": "domob1812", "id": 4943644, "node_id": "MDQ6VXNlcjQ5NDM2NDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/4943644?v=4", "gravatar_id": "", "url": "https://api.github.com/users/domob1812", "html_url": "https://github.com/domob1812", "followers_url": "https://api.github.com/users/domob1812/followers", "following_url": "https://api.github.com/users/domob1812/following{/other_user}", "gists_url": "https://api.github.com/users/domob1812/gists{/gist_id}", "starred_url": "https://api.github.com/users/domob1812/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/domob1812/subscriptions", "organizations_url": "https://api.github.com/users/domob1812/orgs", "repos_url": "https://api.github.com/users/domob1812/repos", "events_url": "https://api.github.com/users/domob1812/events{/privacy}", "received_events_url": "https://api.github.com/users/domob1812/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "f166413ae0e3dd76bc8c83d9865bcff20d5623aa", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f166413ae0e3dd76bc8c83d9865bcff20d5623aa", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f166413ae0e3dd76bc8c83d9865bcff20d5623aa"}], "stats": {"total": 79, "additions": 76, "deletions": 3}, "files": [{"sha": "517b50096d51e8a30907ed5d302fd1ef6abb6a64", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a81f4b678524dbc3c3614f785c5bfee0944ce522/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a81f4b678524dbc3c3614f785c5bfee0944ce522/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=a81f4b678524dbc3c3614f785c5bfee0944ce522", "patch": "@@ -1,3 +1,9 @@\n+2010-10-12  Daniel Kraft  <d@domob.eu>\n+\n+\tPR fortran/38936\n+\t* parse.c (parse_associate): Set typespec of associate-name if that of\n+\tthe target is already available.\n+\n 2010-10-10  Janus Weil  <janus@gcc.gnu.org>\n \n \tPR fortran/45961"}, {"sha": "89ffbafa96ca59b3bb675a56ca93eb8884ab984a", "filename": "gcc/fortran/parse.c", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a81f4b678524dbc3c3614f785c5bfee0944ce522/gcc%2Ffortran%2Fparse.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a81f4b678524dbc3c3614f785c5bfee0944ce522/gcc%2Ffortran%2Fparse.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fparse.c?ref=a81f4b678524dbc3c3614f785c5bfee0944ce522", "patch": "@@ -3237,6 +3237,13 @@ parse_associate (void)\n       sym->assoc = a;\n       sym->declared_at = a->where;\n       gfc_set_sym_referenced (sym);\n+\n+      /* Initialize the typespec.  It is not available in all cases,\n+\t however, as it may only be set on the target during resolution.\n+\t Still, sometimes it helps to have it right now -- especially\n+\t for parsing component references on the associate-name\n+\t in case of assication to a derived-type.  */\n+      sym->ts = a->target->ts;\n     }\n \n   accept_statement (ST_ASSOCIATE);"}, {"sha": "a87da8cf71af9d734ee34a0b987a0735783e628a", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a81f4b678524dbc3c3614f785c5bfee0944ce522/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a81f4b678524dbc3c3614f785c5bfee0944ce522/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=a81f4b678524dbc3c3614f785c5bfee0944ce522", "patch": "@@ -1,3 +1,11 @@\n+2010-10-12  Daniel Kraft  <d@domob.eu>\n+\n+\tPR fortran/38936\n+\t* gfortran.dg/associate_1.f03: More tests with derived-types.\n+\t* gfortran.dg/associate_9.f03: New test (XFAIL for now).\n+\t* gfortran.dg/associate_8.f03: Fix typo.\n+\t* gfortran.dg/initialization_27.f90: Fix typo.\n+\n 2010-10-12  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>\n \n \tPR testsuite/45851"}, {"sha": "d7b14aebeb515504969cb3e978f93d7a4634ae64", "filename": "gcc/testsuite/gfortran.dg/associate_1.f03", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a81f4b678524dbc3c3614f785c5bfee0944ce522/gcc%2Ftestsuite%2Fgfortran.dg%2Fassociate_1.f03", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a81f4b678524dbc3c3614f785c5bfee0944ce522/gcc%2Ftestsuite%2Fgfortran.dg%2Fassociate_1.f03", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fassociate_1.f03?ref=a81f4b678524dbc3c3614f785c5bfee0944ce522", "patch": "@@ -76,9 +76,10 @@ PROGRAM main\n   ! Association to derived type and component.\n   tp = myt (1)\n   ASSOCIATE (x => tp, y => tp%comp)\n-    ! FIXME: Parsing of derived-type associate names, tests with x.\n+    IF (x%comp /= 1) CALL abort ()\n     IF (y /= 1) CALL abort ()\n     y = 5\n+    IF (x%comp /= 5) CALL abort ()\n   END ASSOCIATE\n   IF (tp%comp /= 5) CALL abort ()\n "}, {"sha": "a6f9938f0bb5ea1c29c704fd2e39c57020adb919", "filename": "gcc/testsuite/gfortran.dg/associate_8.f03", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a81f4b678524dbc3c3614f785c5bfee0944ce522/gcc%2Ftestsuite%2Fgfortran.dg%2Fassociate_8.f03", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a81f4b678524dbc3c3614f785c5bfee0944ce522/gcc%2Ftestsuite%2Fgfortran.dg%2Fassociate_8.f03", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fassociate_8.f03?ref=a81f4b678524dbc3c3614f785c5bfee0944ce522", "patch": "@@ -1,4 +1,4 @@\n-! { dg-do run}\n+! { dg-do run }\n ! { dg-options \"-std=f2003 -fall-intrinsics\" }\n \n ! PR fortran/38936"}, {"sha": "13a10fc0d9c6ecf3e2026b03dab38bfb56bf5aec", "filename": "gcc/testsuite/gfortran.dg/associate_9.f03", "status": "added", "additions": 51, "deletions": 0, "changes": 51, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a81f4b678524dbc3c3614f785c5bfee0944ce522/gcc%2Ftestsuite%2Fgfortran.dg%2Fassociate_9.f03", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a81f4b678524dbc3c3614f785c5bfee0944ce522/gcc%2Ftestsuite%2Fgfortran.dg%2Fassociate_9.f03", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fassociate_9.f03?ref=a81f4b678524dbc3c3614f785c5bfee0944ce522", "patch": "@@ -0,0 +1,51 @@\n+! { dg-do compile }\n+! { dg-options \"-std=f2003 -fall-intrinsics\" }\n+\n+! FIXME: Change into run test and remove excess error expectation.\n+\n+! PR fortran/38936\n+! Association to derived-type, where the target type is not know\n+! during parsing (only resolution).\n+\n+! Contributed by Daniel Kraft, d@domob.eu.\n+\n+MODULE m\n+  IMPLICIT NONE\n+\n+  TYPE :: mynum\n+    INTEGER :: comp\n+  END TYPE mynum\n+\n+  INTERFACE OPERATOR(+)\n+    MODULE PROCEDURE add\n+  END INTERFACE OPERATOR(+)\n+\n+CONTAINS\n+\n+  PURE FUNCTION add (a, b)\n+    TYPE(mynum), INTENT(IN) :: a, b\n+    TYPE(mynum) :: add\n+\n+    add%comp = a%comp + b%comp\n+  END FUNCTION add\n+\n+END MODULE m\n+\n+PROGRAM main\n+  USE :: m\n+  IMPLICIT NONE\n+\n+  TYPE(mynum) :: a\n+  a = mynum (5)\n+\n+  ASSOCIATE (x => add (a, a))\n+    IF (x%comp /= 10) CALL abort ()\n+  END ASSOCIATE\n+\n+  ASSOCIATE (x => a + a)\n+    IF (x%comp /= 10) CALL abort ()\n+  END ASSOCIATE\n+END PROGRAM main\n+\n+! { dg-excess-errors \"Syntex error in IF\" }\n+! { dg-final { cleanup-modules \"m\" } }"}, {"sha": "8e21936f6f93986510d5ea744644ca376d2bb2e6", "filename": "gcc/testsuite/gfortran.dg/initialization_27.f90", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a81f4b678524dbc3c3614f785c5bfee0944ce522/gcc%2Ftestsuite%2Fgfortran.dg%2Finitialization_27.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a81f4b678524dbc3c3614f785c5bfee0944ce522/gcc%2Ftestsuite%2Fgfortran.dg%2Finitialization_27.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Finitialization_27.f90?ref=a81f4b678524dbc3c3614f785c5bfee0944ce522", "patch": "@@ -1,4 +1,4 @@\n-! { dg-do run}\n+! { dg-do run }\n !\n ! PR fortran/45489\n !"}]}