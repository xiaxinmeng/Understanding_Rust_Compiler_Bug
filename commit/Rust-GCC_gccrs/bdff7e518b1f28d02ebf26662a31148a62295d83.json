{"sha": "bdff7e518b1f28d02ebf26662a31148a62295d83", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmRmZjdlNTE4YjFmMjhkMDJlYmYyNjY2MmEzMTE0OGE2MjI5NWQ4Mw==", "commit": {"author": {"name": "Jerry DeLisle", "email": "jvdelisle@gcc.gnu.org", "date": "2016-10-21T01:41:03Z"}, "committer": {"name": "Jerry DeLisle", "email": "jvdelisle@gcc.gnu.org", "date": "2016-10-21T01:41:03Z"}, "message": "transfer.c (finalize_transfer): Free format data in child procedures.\n\n2016-10-20  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n\n\t* io/transfer.c (finalize_transfer): Free format data in child\n\tprocedures. (st_read_done, st_write_done): Don't free format\n\thash table.\n\nFrom-SVN: r241392", "tree": {"sha": "88f4b34425f5c5cb2698dac11211de239f68dd0e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/88f4b34425f5c5cb2698dac11211de239f68dd0e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bdff7e518b1f28d02ebf26662a31148a62295d83", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bdff7e518b1f28d02ebf26662a31148a62295d83", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bdff7e518b1f28d02ebf26662a31148a62295d83", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bdff7e518b1f28d02ebf26662a31148a62295d83/comments", "author": null, "committer": null, "parents": [{"sha": "2b1c40345d4b76c40fd676636a79176e8459e65b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2b1c40345d4b76c40fd676636a79176e8459e65b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2b1c40345d4b76c40fd676636a79176e8459e65b"}], "stats": {"total": 21, "additions": 16, "deletions": 5}, "files": [{"sha": "511458f89d3178274d9050dcd962c934573983be", "filename": "libgfortran/ChangeLog", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bdff7e518b1f28d02ebf26662a31148a62295d83/libgfortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bdff7e518b1f28d02ebf26662a31148a62295d83/libgfortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2FChangeLog?ref=bdff7e518b1f28d02ebf26662a31148a62295d83", "patch": "@@ -1,10 +1,16 @@\n+2016-10-20  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n+\n+\t* io/transfer.c (finalize_transfer): Free format data in child\n+\tprocedures. (st_read_done, st_write_done): Don't free format\n+\thash table.\n+\n 2016-10-17  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n \n \tPR fortran/48298\n \t* io/io.h: Move size_used from dtp to unit structure. Add bool\n \thas_size to unit structure.\n-\t* read.c (read_x): Use has_size and size_used.\n-\t* transfer.c (read_sf_internal,read_sf,read_block_form,\n+\t* io/read.c (read_x): Use has_size and size_used.\n+\t* io/transfer.c (read_sf_internal,read_sf,read_block_form,\n \tread_block_form4): Likewise.\n \t(data_transfer_init): If parent, initialize the size variables.\n \t(finalize_transfer): Set the size variable using size_used in"}, {"sha": "0879ca7ae8c7efa6a3662e0477680624adef6ab0", "filename": "libgfortran/io/transfer.c", "status": "modified", "additions": 8, "deletions": 3, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bdff7e518b1f28d02ebf26662a31148a62295d83/libgfortran%2Fio%2Ftransfer.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bdff7e518b1f28d02ebf26662a31148a62295d83/libgfortran%2Fio%2Ftransfer.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fio%2Ftransfer.c?ref=bdff7e518b1f28d02ebf26662a31148a62295d83", "patch": "@@ -3783,7 +3783,14 @@ finalize_transfer (st_parameter_dt *dtp)\n     }\n \n   if (dtp->u.p.current_unit && (dtp->u.p.current_unit->child_dtio  > 0))\n-    return;\n+    {\n+      if (cf & IOPARM_DT_HAS_FORMAT)\n+        {\n+\t  free (dtp->u.p.fmt);\n+\t  free (dtp->format);\n+\t}\n+      return;\n+    }\n \n   if ((dtp->common.flags & IOPARM_DT_HAS_SIZE) != 0)\n     *dtp->size = dtp->u.p.current_unit->size_used;\n@@ -3972,7 +3979,6 @@ st_read_done (st_parameter_dt *dtp)\n         {\n \t  free (dtp->u.p.current_unit->filename);\n \t  dtp->u.p.current_unit->filename = NULL;\n-\t  free_format_hash_table (dtp->u.p.current_unit);\n \t  free (dtp->u.p.current_unit->s);\n \t  dtp->u.p.current_unit->s = NULL;\n \t  if (dtp->u.p.current_unit->ls)\n@@ -4043,7 +4049,6 @@ st_write_done (st_parameter_dt *dtp)\n \t{\n \t  free (dtp->u.p.current_unit->filename);\n \t  dtp->u.p.current_unit->filename = NULL;\n-\t  free_format_hash_table (dtp->u.p.current_unit);\n \t  free (dtp->u.p.current_unit->s);\n \t  dtp->u.p.current_unit->s = NULL;\n \t  if (dtp->u.p.current_unit->ls)"}]}