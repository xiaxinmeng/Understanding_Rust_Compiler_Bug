{"sha": "68ea098a059c352835b2090a02a163f47560ef17", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjhlYTA5OGEwNTljMzUyODM1YjIwOTBhMDJhMTYzZjQ3NTYwZWYxNw==", "commit": {"author": {"name": "Nathan Sidwell", "email": "nathan@codesourcery.com", "date": "2003-08-15T10:46:51Z"}, "committer": {"name": "Nathan Sidwell", "email": "nathan@gcc.gnu.org", "date": "2003-08-15T10:46:51Z"}, "message": "cp:\t* pt.c (instantiate_class_template): Set location before substuting bases.\n\ncp:\t* pt.c (instantiate_class_template): Set location before\n\tsubstuting bases.\ntestsuite:\n\t* g++.dg/template/error2.C: New test.\n\t* g++.dg/lookup/using7.C: Adjust errors\n\t* g++.old-deja/g++.pt/crash36.C: Likewise.\n\t* g++.old-deja/g++.pt/derived3.C: Likewise.\n\nFrom-SVN: r70476", "tree": {"sha": "381dcd409dcfdf722aba79a14047cc2baa00a58a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/381dcd409dcfdf722aba79a14047cc2baa00a58a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/68ea098a059c352835b2090a02a163f47560ef17", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/68ea098a059c352835b2090a02a163f47560ef17", "html_url": "https://github.com/Rust-GCC/gccrs/commit/68ea098a059c352835b2090a02a163f47560ef17", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/68ea098a059c352835b2090a02a163f47560ef17/comments", "author": null, "committer": null, "parents": [{"sha": "4f7847cab9999f228bd0ebf17dda3a1cdde94d02", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4f7847cab9999f228bd0ebf17dda3a1cdde94d02", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4f7847cab9999f228bd0ebf17dda3a1cdde94d02"}], "stats": {"total": 56, "additions": 50, "deletions": 6}, "files": [{"sha": "6f8b592cbb0e7837e1020c6c46611c79ab0709da", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/68ea098a059c352835b2090a02a163f47560ef17/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/68ea098a059c352835b2090a02a163f47560ef17/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=68ea098a059c352835b2090a02a163f47560ef17", "patch": "@@ -1,5 +1,8 @@\n 2003-08-15  Nathan Sidwell  <nathan@codesourcery.com>\n \n+\t* pt.c (instantiate_class_template): Set location before\n+\tsubstuting bases.\n+\n \t* decl.c (make_typename_type): Use my_friendly_assert.\n \t* pt.c (tsubst_aggr_type): Rearrange context substitution.\n "}, {"sha": "722c18e2a34a69b5fbc5fa410c05709e00d27ae7", "filename": "gcc/cp/pt.c", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/68ea098a059c352835b2090a02a163f47560ef17/gcc%2Fcp%2Fpt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/68ea098a059c352835b2090a02a163f47560ef17/gcc%2Fcp%2Fpt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fpt.c?ref=68ea098a059c352835b2090a02a163f47560ef17", "patch": "@@ -5137,6 +5137,10 @@ instantiate_class_template (tree type)\n       SET_CLASSTYPE_INTERFACE_UNKNOWN (type);\n     }\n \n+  /* Set the input location to the template definition. This is needed\n+     if tsubsting causes an error.  */\n+  input_location = DECL_SOURCE_LOCATION (TYPE_NAME (pattern));\n+\n   TYPE_HAS_CONSTRUCTOR (type) = TYPE_HAS_CONSTRUCTOR (pattern);\n   TYPE_HAS_DESTRUCTOR (type) = TYPE_HAS_DESTRUCTOR (pattern);\n   TYPE_HAS_NEW_OPERATOR (type) = TYPE_HAS_NEW_OPERATOR (pattern);"}, {"sha": "e12c2f7bd3324b77a8307d891350d373ffb0bfb7", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/68ea098a059c352835b2090a02a163f47560ef17/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/68ea098a059c352835b2090a02a163f47560ef17/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=68ea098a059c352835b2090a02a163f47560ef17", "patch": "@@ -1,3 +1,10 @@\n+2003-08-15  Nathan Sidwell  <nathan@codesourcery.com>\n+\n+\t* g++.dg/template/error2.C: New test.\n+\t* g++.dg/lookup/using7.C: Adjust errors\n+\t* g++.old-deja/g++.pt/crash36.C: Likewise.\n+\t* g++.old-deja/g++.pt/derived3.C: Likewise.\n+\n 2003-08-14  Kaveh R. Ghazi  <ghazi@caip.rutgers.edu>\n \n \t* gcc.c-torture/execute/builtins/lib/strcat.c: New."}, {"sha": "e62d3f310acf1a066f0cd944984516988e6a3ea3", "filename": "gcc/testsuite/g++.dg/lookup/using7.C", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/68ea098a059c352835b2090a02a163f47560ef17/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Fusing7.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/68ea098a059c352835b2090a02a163f47560ef17/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Fusing7.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Fusing7.C?ref=68ea098a059c352835b2090a02a163f47560ef17", "patch": "@@ -4,7 +4,7 @@ template <typename T, bool=T::X> struct A\n };\n \n template <typename T> struct B : A<T>\n-{\n+{ // { dg-error \"\" }\n   using A<T>::i; // { dg-error \"\" } \n };\n "}, {"sha": "1ce9b6f5174ea54aa0bb9b42d7e11b01737b03bd", "filename": "gcc/testsuite/g++.dg/template/error2.C", "status": "added", "additions": 28, "deletions": 0, "changes": 28, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/68ea098a059c352835b2090a02a163f47560ef17/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Ferror2.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/68ea098a059c352835b2090a02a163f47560ef17/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Ferror2.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Ferror2.C?ref=68ea098a059c352835b2090a02a163f47560ef17", "patch": "@@ -0,0 +1,28 @@\n+// { dg-do compile }\n+\n+// Copyright (C) 2003 Free Software Foundation, Inc.\n+// Contributed by Nathan Sidwell 14 Aug 2003 <nathan@codesourcery.com>\n+\n+// instantiated from did not indicate the nested class\n+\n+template<class T> struct X\n+{\n+  T m; // { dg-error \"\" \"\" }\n+};\n+\n+template<class T >\n+struct Derived\n+{\n+  class Nested : public X<T>\n+  { // { dg-error \"instantiated\"\n+  };\n+  \n+  Nested m; // { dg-error \"instantiated\" \"\" }\n+  \n+  void Foo ();\n+};\n+\n+void Foo (Derived<void> &x)\n+{\n+  x.Foo (); // { dg-error \"instantiated\" \"\" }\n+}"}, {"sha": "146c0b137832865451c8d0b10cfd5ef4770ce6bb", "filename": "gcc/testsuite/g++.old-deja/g++.pt/crash36.C", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/68ea098a059c352835b2090a02a163f47560ef17/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.pt%2Fcrash36.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/68ea098a059c352835b2090a02a163f47560ef17/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.pt%2Fcrash36.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.pt%2Fcrash36.C?ref=68ea098a059c352835b2090a02a163f47560ef17", "patch": "@@ -14,7 +14,7 @@ struct iterator {\n \n template <class Iterator>\n struct reverse_iterator : public\n-iterator<typename iterator_traits<Iterator>::iterator_category> {\n+iterator<typename iterator_traits<Iterator>::iterator_category> { // { dg-error \"\" } no type iterator_category\n   protected:\n   Iterator current;\n   "}, {"sha": "806e0f5c99c7be76f2bf8438b21e9bba7548397c", "filename": "gcc/testsuite/g++.old-deja/g++.pt/derived3.C", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/68ea098a059c352835b2090a02a163f47560ef17/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.pt%2Fderived3.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/68ea098a059c352835b2090a02a163f47560ef17/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.pt%2Fderived3.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.pt%2Fderived3.C?ref=68ea098a059c352835b2090a02a163f47560ef17", "patch": "@@ -1,14 +1,16 @@\n-// { dg-do assemble  }\n+// { dg-do compile  }\n \n // by Paul Burchard <burchard@pobox.com>, Level Set Systems, Inc.\n // Copyright (C) 1999, 2002 Free Software Foundation\n \n template<class T>\n class X {\n-\tclass Y : public T {};\n-\tY y;\t\t\t// { dg-error \"\" } invalid base type\n+\tclass Y : public T\n+\t{ // { dg-error \"base type .* fails to be\" \"\" }\n+\t};\n+\tY y;\t\t\t// { dg-error \"instantiated\" \"\" }\n };\n int main() {\n-\tX<int> x;\t\t// { dg-error \"\" } instantiated\n+\tX<int> x;\t\t// { dg-error \"instantiated\" \"\" }\n }\n "}]}