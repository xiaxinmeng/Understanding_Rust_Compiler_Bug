{"sha": "6ba3b2142afa6dc34bc4946e3d147d768a5523b7", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NmJhM2IyMTQyYWZhNmRjMzRiYzQ5NDZlM2QxNDdkNzY4YTU1MjNiNw==", "commit": {"author": {"name": "Richard Henderson", "email": "rth@redhat.com", "date": "2001-10-08T16:46:24Z"}, "committer": {"name": "Richard Henderson", "email": "rth@gcc.gnu.org", "date": "2001-10-08T16:46:24Z"}, "message": "varasm.c (restore_varasm_status): New.\n\n        * varasm.c (restore_varasm_status): New.\n        * function.h: Declare it.\n        * function.c (pop_function_context_from): Call it.\n\nFrom-SVN: r46080", "tree": {"sha": "1ef7f51a92bb7772d1a5442e68d47fb8473a35f9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1ef7f51a92bb7772d1a5442e68d47fb8473a35f9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6ba3b2142afa6dc34bc4946e3d147d768a5523b7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6ba3b2142afa6dc34bc4946e3d147d768a5523b7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6ba3b2142afa6dc34bc4946e3d147d768a5523b7", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6ba3b2142afa6dc34bc4946e3d147d768a5523b7/comments", "author": null, "committer": null, "parents": [{"sha": "31ed8fea3d618377c79be11b05f41539df915cc4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/31ed8fea3d618377c79be11b05f41539df915cc4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/31ed8fea3d618377c79be11b05f41539df915cc4"}], "stats": {"total": 25, "additions": 25, "deletions": 0}, "files": [{"sha": "182fd9c931dbeceaa9c511bad9b51919b737b639", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6ba3b2142afa6dc34bc4946e3d147d768a5523b7/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6ba3b2142afa6dc34bc4946e3d147d768a5523b7/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=6ba3b2142afa6dc34bc4946e3d147d768a5523b7", "patch": "@@ -1,3 +1,9 @@\n+2001-10-08  Richard Henderson  <rth@redhat.com>\n+\n+\t* varasm.c (restore_varasm_status): New.\n+\t* function.h: Declare it.\n+\t* function.c (pop_function_context_from): Call it.\n+\n 2001-10-08  Richard Henderson  <rth@redhat.com>\n \n \t* c-common.h (struct c_lang_decl): Add declared_inline."}, {"sha": "086fdc69d6f0e3c3471952dbe75babfc1d6523bf", "filename": "gcc/function.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6ba3b2142afa6dc34bc4946e3d147d768a5523b7/gcc%2Ffunction.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6ba3b2142afa6dc34bc4946e3d147d768a5523b7/gcc%2Ffunction.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffunction.c?ref=6ba3b2142afa6dc34bc4946e3d147d768a5523b7", "patch": "@@ -386,6 +386,7 @@ pop_function_context_from (context)\n   reg_renumber = 0;\n \n   restore_emit_status (p);\n+  restore_varasm_status (p);\n \n   if (restore_lang_status)\n     (*restore_lang_status) (p);"}, {"sha": "c4419604d740df31b303c6972bee2c98ec59ead3", "filename": "gcc/function.h", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6ba3b2142afa6dc34bc4946e3d147d768a5523b7/gcc%2Ffunction.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6ba3b2142afa6dc34bc4946e3d147d768a5523b7/gcc%2Ffunction.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffunction.h?ref=6ba3b2142afa6dc34bc4946e3d147d768a5523b7", "patch": "@@ -592,6 +592,7 @@ extern void free_after_parsing\t\tPARAMS ((struct function *));\n extern void free_after_compilation\tPARAMS ((struct function *));\n \n extern void init_varasm_status\t\tPARAMS ((struct function *));\n+extern void restore_varasm_status\tPARAMS ((struct function *));\n extern void free_varasm_status\t\tPARAMS ((struct function *));\n extern void free_emit_status\t\tPARAMS ((struct function *));\n extern void free_stmt_status            PARAMS ((struct function *));"}, {"sha": "d2a59d8e43e1dcc8fe9fbf97a1cb52fac97c449a", "filename": "gcc/varasm.c", "status": "modified", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6ba3b2142afa6dc34bc4946e3d147d768a5523b7/gcc%2Fvarasm.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6ba3b2142afa6dc34bc4946e3d147d768a5523b7/gcc%2Fvarasm.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fvarasm.c?ref=6ba3b2142afa6dc34bc4946e3d147d768a5523b7", "patch": "@@ -3493,6 +3493,23 @@ init_varasm_status (f)\n   p->x_const_double_chain = 0;\n }\n \n+/* Nested functions diddle with our const_double_chain via\n+   clear_const_double_mem and const_tiny_rtx.  Remove these\n+   entries from our const_double_chain.  */\n+\n+void\n+restore_varasm_status (f)\n+     struct function *f;\n+{\n+  rtx *p = &f->varasm->x_const_double_chain;\n+\n+  while (*p)\n+    if (CONST_DOUBLE_MEM (*p) == cc0_rtx)\n+      *p = CONST_DOUBLE_CHAIN (*p);\n+    else\n+      p = &CONST_DOUBLE_CHAIN (*p);\n+}\n+\n /* Mark PC for GC.  */\n \n static void"}]}