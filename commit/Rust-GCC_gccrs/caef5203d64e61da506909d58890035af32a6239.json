{"sha": "caef5203d64e61da506909d58890035af32a6239", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Y2FlZjUyMDNkNjRlNjFkYTUwNjkwOWQ1ODg5MDAzNWFmMzJhNjIzOQ==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2021-09-14T08:44:34Z"}, "committer": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2021-09-14T08:45:35Z"}, "message": "Fix internal error on pointer-to-pointer binding in LTO mode\n\ngcc/ada/\n\t* gcc-interface/utils.c (update_pointer_to): Set TYPE_CANONICAL on\n\tpointer and reference types.", "tree": {"sha": "7e13c5976665587832f7b7a7383aed7d0aa064b6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7e13c5976665587832f7b7a7383aed7d0aa064b6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/caef5203d64e61da506909d58890035af32a6239", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/caef5203d64e61da506909d58890035af32a6239", "html_url": "https://github.com/Rust-GCC/gccrs/commit/caef5203d64e61da506909d58890035af32a6239", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/caef5203d64e61da506909d58890035af32a6239/comments", "author": null, "committer": null, "parents": [{"sha": "b29fc21482c0e203136eb5d44bdc1495de3918c6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b29fc21482c0e203136eb5d44bdc1495de3918c6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b29fc21482c0e203136eb5d44bdc1495de3918c6"}], "stats": {"total": 6, "additions": 5, "deletions": 1}, "files": [{"sha": "4190855b763949f762b89ab43d58496a97f4c44d", "filename": "gcc/ada/gcc-interface/utils.c", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/caef5203d64e61da506909d58890035af32a6239/gcc%2Fada%2Fgcc-interface%2Futils.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/caef5203d64e61da506909d58890035af32a6239/gcc%2Fada%2Fgcc-interface%2Futils.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgcc-interface%2Futils.c?ref=caef5203d64e61da506909d58890035af32a6239", "patch": "@@ -4329,6 +4329,7 @@ update_pointer_to (tree old_type, tree new_type)\n \t    TREE_TYPE (t) = new_type;\n \t    if (TYPE_NULL_BOUNDS (t))\n \t      TREE_TYPE (TREE_OPERAND (TYPE_NULL_BOUNDS (t), 0)) = new_type;\n+\t    TYPE_CANONICAL (t) = TYPE_CANONICAL (TYPE_POINTER_TO (new_type));\n \t  }\n \n       /* Chain REF and its variants at the end.  */\n@@ -4345,7 +4346,10 @@ update_pointer_to (tree old_type, tree new_type)\n       /* Now adjust them.  */\n       for (; ref; ref = TYPE_NEXT_REF_TO (ref))\n \tfor (t = TYPE_MAIN_VARIANT (ref); t; t = TYPE_NEXT_VARIANT (t))\n-\t  TREE_TYPE (t) = new_type;\n+\t  {\n+\t    TREE_TYPE (t) = new_type;\n+\t    TYPE_CANONICAL (t) = TYPE_CANONICAL (TYPE_REFERENCE_TO (new_type));\n+\t  }\n \n       TYPE_POINTER_TO (old_type) = NULL_TREE;\n       TYPE_REFERENCE_TO (old_type) = NULL_TREE;"}]}