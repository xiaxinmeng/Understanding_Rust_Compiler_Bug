{"sha": "968e57283eda9b6f9eb513b0e8572c8a9efaa79f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTY4ZTU3MjgzZWRhOWI2ZjllYjUxM2IwZTg1NzJjOGE5ZWZhYTc5Zg==", "commit": {"author": {"name": "Alexandre Oliva", "email": "aoliva@redhat.com", "date": "2009-10-08T19:20:22Z"}, "committer": {"name": "Alexandre Oliva", "email": "aoliva@gcc.gnu.org", "date": "2009-10-08T19:20:22Z"}, "message": "re PR debug/41353 (VTA missed-debug issues)\n\nPR debug/41353\n* regmove.c (regmove_backward_pass): Replace src with dst in the\ndebug insn, and check for dst before rather than after.\n\nFrom-SVN: r152573", "tree": {"sha": "8b2386ebb2d6ce3706ad704edd3c86b164fbffa2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8b2386ebb2d6ce3706ad704edd3c86b164fbffa2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/968e57283eda9b6f9eb513b0e8572c8a9efaa79f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/968e57283eda9b6f9eb513b0e8572c8a9efaa79f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/968e57283eda9b6f9eb513b0e8572c8a9efaa79f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/968e57283eda9b6f9eb513b0e8572c8a9efaa79f/comments", "author": null, "committer": null, "parents": [{"sha": "42ccb890752a9456140ee00d12dbcf4fc62ac0a3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/42ccb890752a9456140ee00d12dbcf4fc62ac0a3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/42ccb890752a9456140ee00d12dbcf4fc62ac0a3"}], "stats": {"total": 29, "additions": 20, "deletions": 9}, "files": [{"sha": "a7e2290d42ac1012223de08422e71744b4c22021", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/968e57283eda9b6f9eb513b0e8572c8a9efaa79f/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/968e57283eda9b6f9eb513b0e8572c8a9efaa79f/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=968e57283eda9b6f9eb513b0e8572c8a9efaa79f", "patch": "@@ -1,3 +1,9 @@\n+2009-10-08  Alexandre Oliva  <aoliva@redhat.com>\n+\n+\tPR debug/41353\n+\t* regmove.c (regmove_backward_pass): Replace src with dst in the\n+\tdebug insn, and check for dst before rather than after.\n+\n 2009-10-08  Janis Johnson <janis187@us.ibm.com>\n \n \t* config/rs6000/rs6000.c (rs6000_delegitimize_address): Remove."}, {"sha": "a411183c55045439b4617e90168171a648293186", "filename": "gcc/regmove.c", "status": "modified", "additions": 14, "deletions": 9, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/968e57283eda9b6f9eb513b0e8572c8a9efaa79f/gcc%2Fregmove.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/968e57283eda9b6f9eb513b0e8572c8a9efaa79f/gcc%2Fregmove.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fregmove.c?ref=968e57283eda9b6f9eb513b0e8572c8a9efaa79f", "patch": "@@ -1117,23 +1117,28 @@ regmove_backward_pass (void)\n \t\t      break;\n \t\t    }\n \n-\t\t  /* We can't make this change if SRC is read or\n+\t\t  /* We can't make this change if DST is mentioned at\n+\t\t     all in P, since we are going to change its value.\n+\t\t     We can't make this change if SRC is read or\n \t\t     partially written in P, since we are going to\n-\t\t     eliminate SRC. We can't make this change \n-\t\t     if DST is mentioned at all in P,\n-\t\t     since we are going to change its value.  */\n-\t\t  if (reg_overlap_mentioned_p (src, PATTERN (p)))\n+\t\t     eliminate SRC.  However, if it's a debug insn, we\n+\t\t     can't refrain from making the change, for this\n+\t\t     would cause codegen differences, so instead we\n+\t\t     invalidate debug expressions that reference DST,\n+\t\t     and adjust references to SRC in them so that they\n+\t\t     become references to DST.  */\n+\t\t  if (reg_mentioned_p (dst, PATTERN (p)))\n \t\t    {\n \t\t      if (DEBUG_INSN_P (p))\n-\t\t\tvalidate_replace_rtx_group (dst, src, insn);\n+\t\t\tvalidate_change (p, &INSN_VAR_LOCATION_LOC (p),\n+\t\t\t\t\t gen_rtx_UNKNOWN_VAR_LOC (), 1);\n \t\t      else\n \t\t\tbreak;\n \t\t    }\n-\t\t  if (reg_mentioned_p (dst, PATTERN (p)))\n+\t\t  if (reg_overlap_mentioned_p (src, PATTERN (p)))\n \t\t    {\n \t\t      if (DEBUG_INSN_P (p))\n-\t\t\tvalidate_change (p, &INSN_VAR_LOCATION_LOC (p),\n-\t\t\t\t\t gen_rtx_UNKNOWN_VAR_LOC (), 1);\n+\t\t\tvalidate_replace_rtx_group (src, dst, p);\n \t\t      else\n \t\t\tbreak;\n \t\t    }"}]}