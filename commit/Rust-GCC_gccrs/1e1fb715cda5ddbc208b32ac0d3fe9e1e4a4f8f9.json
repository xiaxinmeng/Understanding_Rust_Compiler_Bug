{"sha": "1e1fb715cda5ddbc208b32ac0d3fe9e1e4a4f8f9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWUxZmI3MTVjZGE1ZGRiYzIwOGIzMmFjMGQzZmU5ZTFlNGE0ZjhmOQ==", "commit": {"author": {"name": "Thomas Schwinge", "email": "thomas@codesourcery.com", "date": "2019-12-09T11:40:08Z"}, "committer": {"name": "Thomas Schwinge", "email": "tschwinge@gcc.gnu.org", "date": "2019-12-09T11:40:08Z"}, "message": "Add 'libgomp.oacc-c-c++-common/host_data-6.c'\n\n\tlibgomp/\n\t* testsuite/libgomp.oacc-c-c++-common/host_data-6.c: New file.\n\nFrom-SVN: r279119", "tree": {"sha": "5a66d2b261d16c401c5142d721155cdb76ae0068", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5a66d2b261d16c401c5142d721155cdb76ae0068"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1e1fb715cda5ddbc208b32ac0d3fe9e1e4a4f8f9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1e1fb715cda5ddbc208b32ac0d3fe9e1e4a4f8f9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1e1fb715cda5ddbc208b32ac0d3fe9e1e4a4f8f9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1e1fb715cda5ddbc208b32ac0d3fe9e1e4a4f8f9/comments", "author": {"login": "tschwinge", "id": 21753, "node_id": "MDQ6VXNlcjIxNzUz", "avatar_url": "https://avatars.githubusercontent.com/u/21753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tschwinge", "html_url": "https://github.com/tschwinge", "followers_url": "https://api.github.com/users/tschwinge/followers", "following_url": "https://api.github.com/users/tschwinge/following{/other_user}", "gists_url": "https://api.github.com/users/tschwinge/gists{/gist_id}", "starred_url": "https://api.github.com/users/tschwinge/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tschwinge/subscriptions", "organizations_url": "https://api.github.com/users/tschwinge/orgs", "repos_url": "https://api.github.com/users/tschwinge/repos", "events_url": "https://api.github.com/users/tschwinge/events{/privacy}", "received_events_url": "https://api.github.com/users/tschwinge/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "b5859e400219c891b81e0788e7e58422706e4a49", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b5859e400219c891b81e0788e7e58422706e4a49", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b5859e400219c891b81e0788e7e58422706e4a49"}], "stats": {"total": 49, "additions": 49, "deletions": 0}, "files": [{"sha": "6ef2f24e4d50fde5e5710cf1f9cebe2cbc8d38a1", "filename": "libgomp/ChangeLog", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1e1fb715cda5ddbc208b32ac0d3fe9e1e4a4f8f9/libgomp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1e1fb715cda5ddbc208b32ac0d3fe9e1e4a4f8f9/libgomp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2FChangeLog?ref=1e1fb715cda5ddbc208b32ac0d3fe9e1e4a4f8f9", "patch": "@@ -1,5 +1,7 @@\n 2019-12-09  Thomas Schwinge  <thomas@codesourcery.com>\n \n+\t* testsuite/libgomp.oacc-c-c++-common/host_data-6.c: New file.\n+\n \t* target.c (gomp_exit_data): Use 'gomp_remove_var'.\n \n 2019-12-09  Tobias Burnus  <tobias@codesourcery.com>"}, {"sha": "1cda442b00134fdc1203c4ccb6428d1a5bc3a455", "filename": "libgomp/testsuite/libgomp.oacc-c-c++-common/host_data-6.c", "status": "added", "additions": 47, "deletions": 0, "changes": 47, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1e1fb715cda5ddbc208b32ac0d3fe9e1e4a4f8f9/libgomp%2Ftestsuite%2Flibgomp.oacc-c-c%2B%2B-common%2Fhost_data-6.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1e1fb715cda5ddbc208b32ac0d3fe9e1e4a4f8f9/libgomp%2Ftestsuite%2Flibgomp.oacc-c-c%2B%2B-common%2Fhost_data-6.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Ftestsuite%2Flibgomp.oacc-c-c%2B%2B-common%2Fhost_data-6.c?ref=1e1fb715cda5ddbc208b32ac0d3fe9e1e4a4f8f9", "patch": "@@ -0,0 +1,47 @@\n+/* Call 'acc_memcpy_from_device' inside '#pragma acc host_data'.  */\n+\n+/* { dg-skip-if \"\" { *-*-* } { \"*\" } { \"-DACC_MEM_SHARED=0\" } } */\n+\n+#include <assert.h>\n+#include <stdlib.h>\n+#include <string.h>\n+#include <openacc.h>\n+\n+int\n+main ()\n+{\n+  const int SIZE = 318;\n+  const int c0 = 22;\n+  const int c1 = 112;\n+\n+  char *h = (char *) malloc (SIZE);\n+\n+  memset (h, c0, SIZE);\n+\n+#pragma acc data create (h[0:SIZE - 44])\n+  {\n+#pragma acc update device (h[0:SIZE - 44])\n+\n+    memset (h, c1, 67);\n+\n+    void *d = h;\n+#pragma acc host_data use_device (d)\n+    {\n+      acc_memcpy_from_device (h, d, 12);\n+    }\n+  }\n+\n+  for (int i = 0; i < SIZE; ++i)\n+    {\n+      if (i < 12)\n+\tassert (h[i] == c0);\n+      else if (i < 67)\n+\tassert (h[i] == c1);\n+      else\n+\tassert (h[i] == c0);\n+    }\n+\n+  free (h);\n+\n+  return 0;\n+}"}]}