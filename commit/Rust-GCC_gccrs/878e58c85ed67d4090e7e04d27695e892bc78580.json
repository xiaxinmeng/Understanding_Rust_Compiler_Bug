{"sha": "878e58c85ed67d4090e7e04d27695e892bc78580", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODc4ZTU4Yzg1ZWQ2N2Q0MDkwZTdlMDRkMjc2OTVlODkyYmM3ODU4MA==", "commit": {"author": {"name": "Robert Dewar", "email": "dewar@adacore.com", "date": "2015-05-22T12:51:36Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2015-05-22T12:51:36Z"}, "message": "exp_ch4.adb (Expand_N_Op_Eq): Introduce 'Machine for 'Result comparison.\n\n2015-05-22  Robert Dewar  <dewar@adacore.com>\n\n\t* exp_ch4.adb (Expand_N_Op_Eq): Introduce 'Machine for 'Result\n\tcomparison.\n\nFrom-SVN: r223559", "tree": {"sha": "1338b17af8940144bc5deeefeb5dd2bebc22495e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1338b17af8940144bc5deeefeb5dd2bebc22495e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/878e58c85ed67d4090e7e04d27695e892bc78580", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/878e58c85ed67d4090e7e04d27695e892bc78580", "html_url": "https://github.com/Rust-GCC/gccrs/commit/878e58c85ed67d4090e7e04d27695e892bc78580", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/878e58c85ed67d4090e7e04d27695e892bc78580/comments", "author": null, "committer": null, "parents": [{"sha": "64a40a7bb33b55a2c0503ef93908dc33896f37d0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/64a40a7bb33b55a2c0503ef93908dc33896f37d0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/64a40a7bb33b55a2c0503ef93908dc33896f37d0"}], "stats": {"total": 29, "additions": 29, "deletions": 0}, "files": [{"sha": "7105a7a1ea4cecdbdc10e708e3697a5351ccbcd3", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/878e58c85ed67d4090e7e04d27695e892bc78580/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/878e58c85ed67d4090e7e04d27695e892bc78580/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=878e58c85ed67d4090e7e04d27695e892bc78580", "patch": "@@ -1,3 +1,8 @@\n+2015-05-22  Robert Dewar  <dewar@adacore.com>\n+\n+\t* exp_ch4.adb (Expand_N_Op_Eq): Introduce 'Machine for 'Result\n+\tcomparison.\n+\n 2015-05-22  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* sprint.adb (Source_Dump): When generating debug files, deal"}, {"sha": "df73482a4d5bb1ed0961ad3979163a542a32bd93", "filename": "gcc/ada/exp_ch4.adb", "status": "modified", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/878e58c85ed67d4090e7e04d27695e892bc78580/gcc%2Fada%2Fexp_ch4.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/878e58c85ed67d4090e7e04d27695e892bc78580/gcc%2Fada%2Fexp_ch4.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fexp_ch4.adb?ref=878e58c85ed67d4090e7e04d27695e892bc78580", "patch": "@@ -7519,7 +7519,31 @@ package body Exp_Ch4 is\n \n       Rewrite_Comparison (N);\n \n+      --  Special optimization of length comparison\n+\n       Optimize_Length_Comparison (N);\n+\n+      --  One more special case, if we have a comparison of X'Result = expr\n+      --  in floating-point, then if not already there, change expr to be\n+      --  f'Machine (expr) to eliminate suprise from extra precision.\n+\n+      if Is_Floating_Point_Type (Typl)\n+        and then Nkind (Original_Node (Lhs)) = N_Attribute_Reference\n+        and then Attribute_Name (Original_Node (Lhs)) = Name_Result\n+      then\n+         --  Stick in the Typ'Machine call if not already there\n+\n+         if Nkind (Rhs) /= N_Attribute_Reference\n+           or else Attribute_Name (Rhs) /= Name_Machine\n+         then\n+            Rewrite (Rhs,\n+              Make_Attribute_Reference (Loc,\n+                Prefix         => New_Occurrence_Of (Typl, Loc),\n+                Attribute_Name => Name_Machine,\n+                Expressions    => New_List (Relocate_Node (Rhs))));\n+            Analyze_And_Resolve (Rhs, Typl);\n+         end if;\n+      end if;\n    end Expand_N_Op_Eq;\n \n    -----------------------"}]}