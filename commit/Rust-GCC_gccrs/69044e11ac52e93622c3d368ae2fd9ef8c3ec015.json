{"sha": "69044e11ac52e93622c3d368ae2fd9ef8c3ec015", "node_id": "C_kwDOANBUbNoAKDY5MDQ0ZTExYWM1MmU5MzYyMmMzZDM2OGFlMmZkOWVmOGMzZWMwMTU", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2023-04-01T07:32:20Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2023-04-01T07:32:20Z"}, "message": "range-op-float: Further foperator_{,not_}equal::fold_range fix\n\nOn Fri, Mar 31, 2023 at 12:45:10PM +0200, Jakub Jelinek via Gcc-patches wrote:\n>    - there is a missing case (not handled in this patch) where both operands\n>      are known to be zeros, but not singleton zeros\n\nThis patch adds those cases.\n\n2023-04-01  Jakub Jelinek  <jakub@redhat.com>\n\n\t* range-op-float.cc (foperator_equal::fold_range): If at least\n\tone of the op ranges is not singleton and neither is NaN and all\n\t4 bounds are zero, return [1, 1].\n\t(foperator_not_equal::fold_range): In the same case return [0, 0].", "tree": {"sha": "9c8e75621985527097bb25d9accb65258d3fa2a7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9c8e75621985527097bb25d9accb65258d3fa2a7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/69044e11ac52e93622c3d368ae2fd9ef8c3ec015", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/69044e11ac52e93622c3d368ae2fd9ef8c3ec015", "html_url": "https://github.com/Rust-GCC/gccrs/commit/69044e11ac52e93622c3d368ae2fd9ef8c3ec015", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/69044e11ac52e93622c3d368ae2fd9ef8c3ec015/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5fe05ffefd21c4fa6a71e0c570a05d7c0e7e892c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5fe05ffefd21c4fa6a71e0c570a05d7c0e7e892c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5fe05ffefd21c4fa6a71e0c570a05d7c0e7e892c"}], "stats": {"total": 14, "additions": 14, "deletions": 0}, "files": [{"sha": "41d497e96ade884af13e45a919eebea7070e9ef6", "filename": "gcc/range-op-float.cc", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/69044e11ac52e93622c3d368ae2fd9ef8c3ec015/gcc%2Frange-op-float.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/69044e11ac52e93622c3d368ae2fd9ef8c3ec015/gcc%2Frange-op-float.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Frange-op-float.cc?ref=69044e11ac52e93622c3d368ae2fd9ef8c3ec015", "patch": "@@ -616,6 +616,13 @@ foperator_equal::fold_range (irange &r, tree type,\n       else\n \tr = range_false (type);\n     }\n+  else if (real_iszero (&op1.lower_bound ())\n+\t   && real_iszero (&op1.upper_bound ())\n+\t   && real_iszero (&op2.lower_bound ())\n+\t   && real_iszero (&op2.upper_bound ())\n+\t   && !maybe_isnan (op1, op2))\n+    // [-0.0, 0.0] == [-0.0, 0.0] or similar.\n+    r = range_true (type);\n   else\n     {\n       // If ranges do not intersect, we know the range is not equal,\n@@ -732,6 +739,13 @@ foperator_not_equal::fold_range (irange &r, tree type,\n       else\n \tr = range_true (type);\n     }\n+  else if (real_iszero (&op1.lower_bound ())\n+\t   && real_iszero (&op1.upper_bound ())\n+\t   && real_iszero (&op2.lower_bound ())\n+\t   && real_iszero (&op2.upper_bound ())\n+\t   && !maybe_isnan (op1, op2))\n+    // [-0.0, 0.0] != [-0.0, 0.0] or similar.\n+    r = range_false (type);\n   else\n     {\n       // If ranges do not intersect, we know the range is not equal,"}]}