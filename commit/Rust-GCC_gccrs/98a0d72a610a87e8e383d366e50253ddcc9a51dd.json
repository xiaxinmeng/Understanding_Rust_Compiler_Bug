{"sha": "98a0d72a610a87e8e383d366e50253ddcc9a51dd", "node_id": "C_kwDOANBUbNoAKDk4YTBkNzJhNjEwYTg3ZThlMzgzZDM2NmU1MDI1M2RkY2M5YTUxZGQ", "commit": {"author": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2022-06-16T13:57:32Z"}, "committer": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2022-06-16T19:20:40Z"}, "message": "libstdc++: Support constexpr global std::string for size < 15 [PR105995]\n\nI don't think this is required by the standard, but it's easy to\nsupport.\n\nlibstdc++-v3/ChangeLog:\n\n\tPR libstdc++/105995\n\t* include/bits/basic_string.h (_M_use_local_data): Initialize\n\tthe entire SSO buffer.\n\t* testsuite/21_strings/basic_string/cons/char/105995.cc: New test.", "tree": {"sha": "ce3442008ef417de9e0dd5133dc2ea77f8dd7171", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ce3442008ef417de9e0dd5133dc2ea77f8dd7171"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/98a0d72a610a87e8e383d366e50253ddcc9a51dd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/98a0d72a610a87e8e383d366e50253ddcc9a51dd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/98a0d72a610a87e8e383d366e50253ddcc9a51dd", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/98a0d72a610a87e8e383d366e50253ddcc9a51dd/comments", "author": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "51309d1158b85560a975819260776c0ca68fd142", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/51309d1158b85560a975819260776c0ca68fd142", "html_url": "https://github.com/Rust-GCC/gccrs/commit/51309d1158b85560a975819260776c0ca68fd142"}], "stats": {"total": 12, "additions": 11, "deletions": 1}, "files": [{"sha": "b04fba956783fdcea83deaab763b6744787583c5", "filename": "libstdc++-v3/include/bits/basic_string.h", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/98a0d72a610a87e8e383d366e50253ddcc9a51dd/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fbasic_string.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/98a0d72a610a87e8e383d366e50253ddcc9a51dd/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fbasic_string.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fbasic_string.h?ref=98a0d72a610a87e8e383d366e50253ddcc9a51dd", "patch": "@@ -352,7 +352,8 @@ _GLIBCXX_BEGIN_NAMESPACE_CXX11\n       {\n #if __cpp_lib_is_constant_evaluated\n \tif (std::is_constant_evaluated())\n-\t  _M_local_buf[0] = _CharT();\n+\t  for (_CharT& __c : _M_local_buf)\n+\t    __c = _CharT();\n #endif\n \treturn _M_local_data();\n       }"}, {"sha": "aa8bcba3dca946f62929e9f95bfe6af67dabeee7", "filename": "libstdc++-v3/testsuite/21_strings/basic_string/cons/char/105995.cc", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/98a0d72a610a87e8e383d366e50253ddcc9a51dd/libstdc%2B%2B-v3%2Ftestsuite%2F21_strings%2Fbasic_string%2Fcons%2Fchar%2F105995.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/98a0d72a610a87e8e383d366e50253ddcc9a51dd/libstdc%2B%2B-v3%2Ftestsuite%2F21_strings%2Fbasic_string%2Fcons%2Fchar%2F105995.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F21_strings%2Fbasic_string%2Fcons%2Fchar%2F105995.cc?ref=98a0d72a610a87e8e383d366e50253ddcc9a51dd", "patch": "@@ -0,0 +1,9 @@\n+// { dg-options \"-std=gnu++20\" }\n+// { dg-do compile { target c++20 } }\n+// { dg-require-effective-target cxx11_abi }\n+\n+// PR libstdc++/105995\n+// Not required by the standard, but supported for QoI.\n+constexpr std::string pr105995_empty;\n+constexpr std::string pr105995_partial = \"0\";\n+constexpr std::string pr105995_full = \"0123456789abcde\";"}]}