{"sha": "7ae210d5db5eb96989b2f639e65678b5597e61f0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2FlMjEwZDVkYjVlYjk2OTg5YjJmNjM5ZTY1Njc4YjU1OTdlNjFmMA==", "commit": {"author": {"name": "Paul Thomas", "email": "pault@gcc.gnu.org", "date": "2020-12-05T14:14:19Z"}, "committer": {"name": "Paul Thomas", "email": "pault@gcc.gnu.org", "date": "2020-12-05T14:14:19Z"}, "message": "Fortran: flag formal argument before resolving an array spec [PR98016].\n\n2020-12-05  Paul Thomas  <pault@gcc.gnu.org>\n\ngcc/fortran\n\tPR fortran/98016\n\t* resolve.c (resolve_symbol): Set formal_arg_flag before\n\tresolving an array spec and restore value afterwards.\n\ngcc/testsuite/\n\tPR fortran/98016\n\t* gfortran.dg/pr98016.f90: New test.", "tree": {"sha": "c9c644de187e048169a2817be36d4bdc6c4e9668", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c9c644de187e048169a2817be36d4bdc6c4e9668"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7ae210d5db5eb96989b2f639e65678b5597e61f0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7ae210d5db5eb96989b2f639e65678b5597e61f0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7ae210d5db5eb96989b2f639e65678b5597e61f0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7ae210d5db5eb96989b2f639e65678b5597e61f0/comments", "author": null, "committer": null, "parents": [{"sha": "1352bc88a0525743c952197fb2db6e4f8c091cde", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1352bc88a0525743c952197fb2db6e4f8c091cde", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1352bc88a0525743c952197fb2db6e4f8c091cde"}], "stats": {"total": 23, "additions": 23, "deletions": 0}, "files": [{"sha": "0a8f90775ab66b3cab62b422bedab69650dc5c18", "filename": "gcc/fortran/resolve.c", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7ae210d5db5eb96989b2f639e65678b5597e61f0/gcc%2Ffortran%2Fresolve.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7ae210d5db5eb96989b2f639e65678b5597e61f0/gcc%2Ffortran%2Fresolve.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fresolve.c?ref=7ae210d5db5eb96989b2f639e65678b5597e61f0", "patch": "@@ -15394,8 +15394,12 @@ resolve_symbol (gfc_symbol *sym)\n   else if (mp_flag && sym->attr.flavor == FL_PROCEDURE && sym->attr.function)\n     {\n       bool saved_specification_expr = specification_expr;\n+      bool saved_formal_arg_flag = formal_arg_flag;\n+\n       specification_expr = true;\n+      formal_arg_flag = true;\n       gfc_resolve_array_spec (sym->result->as, false);\n+      formal_arg_flag = saved_formal_arg_flag;\n       specification_expr = saved_specification_expr;\n     }\n "}, {"sha": "71df67e6190ed58b8d794b58afa598b504749e49", "filename": "gcc/testsuite/gfortran.dg/pr98016.f90", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7ae210d5db5eb96989b2f639e65678b5597e61f0/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr98016.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7ae210d5db5eb96989b2f639e65678b5597e61f0/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr98016.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr98016.f90?ref=7ae210d5db5eb96989b2f639e65678b5597e61f0", "patch": "@@ -0,0 +1,19 @@\n+! { dg-do compile }\n+!\n+! Fix for PR98016 - Used to fail with Error: Variable \u2018n\u2019 cannot appear in the\n+! expression at (1) for line 16. Workaround was to declare y to be real.\n+!\n+! Posted by Juergen Reuter  <juergen.reuter@desy.de>\n+!\n+program is_it_valid\n+  dimension y(3)\n+  n=3\n+  y=func(1.0)\n+  print *, y\n+  stop\n+contains\n+  function func(x) result (y)\n+    dimension y(n)\n+    y=x\n+  end function\n+end"}]}