{"sha": "88f1975682abfbb86e5e2807ef7225fe6ce177fc", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODhmMTk3NTY4MmFiZmJiODZlNWUyODA3ZWY3MjI1ZmU2Y2UxNzdmYw==", "commit": {"author": {"name": "Richard Henderson", "email": "rth@redhat.com", "date": "2004-08-30T18:16:31Z"}, "committer": {"name": "Richard Henderson", "email": "rth@gcc.gnu.org", "date": "2004-08-30T18:16:31Z"}, "message": "fold-const.c (tree_expr_nonzero_p): Use get_base_address before assuming an ADDR_EXPR is non-null.\n\n        * fold-const.c (tree_expr_nonzero_p): Use get_base_address before\n        assuming an ADDR_EXPR is non-null.\ncp/\n        * class.c (fixed_type_or_null): Use get_base_address before\n        assuming an ADDR_EXPR is non-null.\n\nFrom-SVN: r86788", "tree": {"sha": "b7a95305df70ea17c17b95c7ffb5076a545bbf16", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b7a95305df70ea17c17b95c7ffb5076a545bbf16"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/88f1975682abfbb86e5e2807ef7225fe6ce177fc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/88f1975682abfbb86e5e2807ef7225fe6ce177fc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/88f1975682abfbb86e5e2807ef7225fe6ce177fc", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/88f1975682abfbb86e5e2807ef7225fe6ce177fc/comments", "author": null, "committer": null, "parents": [{"sha": "b6e9851af8002d984ae10a8ff8c36d7a113f0a51", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b6e9851af8002d984ae10a8ff8c36d7a113f0a51", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b6e9851af8002d984ae10a8ff8c36d7a113f0a51"}], "stats": {"total": 43, "additions": 36, "deletions": 7}, "files": [{"sha": "6320873a49d5f21b9f94a6262c23c7935c4f934f", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/88f1975682abfbb86e5e2807ef7225fe6ce177fc/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/88f1975682abfbb86e5e2807ef7225fe6ce177fc/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=88f1975682abfbb86e5e2807ef7225fe6ce177fc", "patch": "@@ -1,3 +1,8 @@\n+2004-08-30  Richard Henderson  <rth@redhat.com>\n+\n+\t* fold-const.c (tree_expr_nonzero_p): Use get_base_address before\n+\tassuming an ADDR_EXPR is non-null.\n+\n 2004-08-30  Jason Merrill  <jason@redhat.com>\n \n \t* gthr-posix.h, gthr-dce.h: Add #pragma weaks."}, {"sha": "83e38c94df143f87747f38186c9f563723417e80", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/88f1975682abfbb86e5e2807ef7225fe6ce177fc/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/88f1975682abfbb86e5e2807ef7225fe6ce177fc/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=88f1975682abfbb86e5e2807ef7225fe6ce177fc", "patch": "@@ -1,3 +1,8 @@\n+2004-08-30  Richard Henderson  <rth@redhat.com>\n+\n+\t* class.c (fixed_type_or_null): Use get_base_address before\n+\tassuming an ADDR_EXPR is non-null.\n+\n 2004-08-30  Nathan Sidwell  <nathan@codesourcery.com>\n \n \t* name-lookup.c (pop_binding, pushdecl,"}, {"sha": "9ef15dcca9808efb5e1496a2c57a79cb8cd43705", "filename": "gcc/cp/class.c", "status": "modified", "additions": 10, "deletions": 2, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/88f1975682abfbb86e5e2807ef7225fe6ce177fc/gcc%2Fcp%2Fclass.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/88f1975682abfbb86e5e2807ef7225fe6ce177fc/gcc%2Fcp%2Fclass.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fclass.c?ref=88f1975682abfbb86e5e2807ef7225fe6ce177fc", "patch": "@@ -5238,9 +5238,17 @@ fixed_type_or_null (tree instance, int* nonnull, int* cdtorp)\n       return fixed_type_or_null (TREE_OPERAND (instance, 0), nonnull, cdtorp);\n \n     case ADDR_EXPR:\n+      instance = TREE_OPERAND (instance, 0);\n       if (nonnull)\n-\t*nonnull = 1;\n-      return fixed_type_or_null (TREE_OPERAND (instance, 0), nonnull, cdtorp);\n+\t{\n+\t  /* Just because we see an ADDR_EXPR doesn't mean we're dealing\n+\t     with a real object -- given &p->f, p can still be null.  */\n+\t  tree t = get_base_address (instance);\n+\t  /* ??? Probably should check DECL_WEAK here.  */\n+\t  if (t && DECL_P (t))\n+\t    *nonnull = 1;\n+\t}\n+      return fixed_type_or_null (instance, nonnull, cdtorp);\n \n     case COMPONENT_REF:\n       /* If this component is really a base class reference, then the field"}, {"sha": "3ee2bc746e3db1daf69916ea9d21ff4653cf8c57", "filename": "gcc/fold-const.c", "status": "modified", "additions": 16, "deletions": 5, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/88f1975682abfbb86e5e2807ef7225fe6ce177fc/gcc%2Ffold-const.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/88f1975682abfbb86e5e2807ef7225fe6ce177fc/gcc%2Ffold-const.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffold-const.c?ref=88f1975682abfbb86e5e2807ef7225fe6ce177fc", "patch": "@@ -9582,11 +9582,22 @@ tree_expr_nonzero_p (tree t)\n       break;\n \n    case ADDR_EXPR:\n-      /* Weak declarations may link to NULL.  */\n-      if (DECL_P (TREE_OPERAND (t, 0)))\n-\treturn !DECL_WEAK (TREE_OPERAND (t, 0));\n-      /* Constants and all other cases are never weak.  */\n-      return true;\n+      {\n+\ttree base = get_base_address (TREE_OPERAND (t, 0));\n+\n+\tif (!base)\n+\t  return false;\n+\n+\t/* Weak declarations may link to NULL.  */\n+\tif (DECL_P (base))\n+\t  return !DECL_WEAK (base);\n+\n+\t/* Constants are never weak.  */\n+\tif (TREE_CODE_CLASS (TREE_CODE (base)) == 'c')\n+\t  return true;\n+\n+\treturn false;\n+      }\n \n     case COND_EXPR:\n       return (tree_expr_nonzero_p (TREE_OPERAND (t, 1))"}]}