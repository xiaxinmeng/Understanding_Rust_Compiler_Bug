{"sha": "364f9c6bf65b5d01561f622a42a8a508a3009300", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzY0ZjljNmJmNjViNWQwMTU2MWY2MjJhNDJhOGE1MDhhMzAwOTMwMA==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@redhat.com", "date": "2009-12-05T01:51:46Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "2009-12-05T01:51:46Z"}, "message": "re PR c++/42010 ([C++0x] ICE: lang_* check: failed in discriminator_for_local_entity, at cp/mangle.c:1581)\n\n\tPR c++/42010\n\t* cp-tree.h (DECL_DISCRIMINATOR_SET_P): New.\n\t* mangle.c (discriminator_for_local_entity): Check it.\n\nFrom-SVN: r155007", "tree": {"sha": "2eb63ab5db50c37e458fdf6eaa1769ab49a7f082", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2eb63ab5db50c37e458fdf6eaa1769ab49a7f082"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/364f9c6bf65b5d01561f622a42a8a508a3009300", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/364f9c6bf65b5d01561f622a42a8a508a3009300", "html_url": "https://github.com/Rust-GCC/gccrs/commit/364f9c6bf65b5d01561f622a42a8a508a3009300", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/364f9c6bf65b5d01561f622a42a8a508a3009300/comments", "author": {"login": "jicama", "id": 266146, "node_id": "MDQ6VXNlcjI2NjE0Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/266146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jicama", "html_url": "https://github.com/jicama", "followers_url": "https://api.github.com/users/jicama/followers", "following_url": "https://api.github.com/users/jicama/following{/other_user}", "gists_url": "https://api.github.com/users/jicama/gists{/gist_id}", "starred_url": "https://api.github.com/users/jicama/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jicama/subscriptions", "organizations_url": "https://api.github.com/users/jicama/orgs", "repos_url": "https://api.github.com/users/jicama/repos", "events_url": "https://api.github.com/users/jicama/events{/privacy}", "received_events_url": "https://api.github.com/users/jicama/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "b50eb277c1c3eef6f81de369130aca3ee9fff5a0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b50eb277c1c3eef6f81de369130aca3ee9fff5a0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b50eb277c1c3eef6f81de369130aca3ee9fff5a0"}], "stats": {"total": 32, "additions": 30, "deletions": 2}, "files": [{"sha": "bb3f8f929322aee454b88f5330eb1bbe35964068", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/364f9c6bf65b5d01561f622a42a8a508a3009300/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/364f9c6bf65b5d01561f622a42a8a508a3009300/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=364f9c6bf65b5d01561f622a42a8a508a3009300", "patch": "@@ -1,5 +1,9 @@\n 2009-12-04  Jason Merrill  <jason@redhat.com>\n \n+\tPR c++/42010\n+\t* cp-tree.h (DECL_DISCRIMINATOR_SET_P): New.\n+\t* mangle.c (discriminator_for_local_entity): Check it.\n+\n \tPR c++/42277\n \t* semantics.c (finish_decltype_type): Defer handling of decltype\n \tof a non-dependent COMPONENT_REF in a template."}, {"sha": "21a914d4a865840c6134e12f9bf8067f2a00326a", "filename": "gcc/cp/cp-tree.h", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/364f9c6bf65b5d01561f622a42a8a508a3009300/gcc%2Fcp%2Fcp-tree.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/364f9c6bf65b5d01561f622a42a8a508a3009300/gcc%2Fcp%2Fcp-tree.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fcp-tree.h?ref=364f9c6bf65b5d01561f622a42a8a508a3009300", "patch": "@@ -2052,6 +2052,10 @@ struct GTY(()) lang_decl {\n /* Discriminator for name mangling.  */\n #define DECL_DISCRIMINATOR(NODE) (LANG_DECL_U2_CHECK (NODE, 1)->discriminator)\n \n+/* True iff DECL_DISCRIMINATOR is set for a DECL_DISCRIMINATOR_P decl.  */\n+#define DECL_DISCRIMINATOR_SET_P(NODE) \\\n+  (DECL_LANG_SPECIFIC (NODE) && DECL_LANG_SPECIFIC (NODE)->u.base.u2sel == 1)\n+\n /* The index of a user-declared parameter in its function, starting at 1.\n    All artificial parameters will have index 0.  */\n #define DECL_PARM_INDEX(NODE) \\"}, {"sha": "3afc0949cf8a0e9f5f99afd4b860d178aa1d2e13", "filename": "gcc/cp/mangle.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/364f9c6bf65b5d01561f622a42a8a508a3009300/gcc%2Fcp%2Fmangle.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/364f9c6bf65b5d01561f622a42a8a508a3009300/gcc%2Fcp%2Fmangle.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fmangle.c?ref=364f9c6bf65b5d01561f622a42a8a508a3009300", "patch": "@@ -1577,11 +1577,11 @@ discriminator_for_local_entity (tree entity)\n {\n   if (DECL_DISCRIMINATOR_P (entity))\n     {\n-      if (DECL_LANG_SPECIFIC (entity))\n+      if (DECL_DISCRIMINATOR_SET_P (entity))\n \treturn DECL_DISCRIMINATOR (entity);\n       else\n \t/* The first entity with a particular name doesn't get\n-\t   DECL_LANG_SPECIFIC/DECL_DISCRIMINATOR.  */\n+\t   DECL_DISCRIMINATOR set up.  */\n \treturn 0;\n     }\n   else if (TREE_CODE (entity) == TYPE_DECL)"}, {"sha": "12a57bccd351bf3497a55dd7ea23d9e99619138a", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/364f9c6bf65b5d01561f622a42a8a508a3009300/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/364f9c6bf65b5d01561f622a42a8a508a3009300/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=364f9c6bf65b5d01561f622a42a8a508a3009300", "patch": "@@ -1,5 +1,8 @@\n 2009-12-04  Jason Merrill  <jason@redhat.com>\n \n+\tPR c++/42010\n+\t* g++.dg/abi/local2.C: New.\n+\n \tPR c++/42277\n \t* g++.dg/cpp0x/decltype20.C: New.\n "}, {"sha": "f56701610f17e8c64e897d99c70fe0a3583e9f0a", "filename": "gcc/testsuite/g++.dg/abi/local2.C", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/364f9c6bf65b5d01561f622a42a8a508a3009300/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fabi%2Flocal2.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/364f9c6bf65b5d01561f622a42a8a508a3009300/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fabi%2Flocal2.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fabi%2Flocal2.C?ref=364f9c6bf65b5d01561f622a42a8a508a3009300", "patch": "@@ -0,0 +1,17 @@\n+// PR c++/42010\n+// { dg-final { scan-assembler \"ZZN1A1fEvE1s\" } }\n+\n+struct A {\n+  static int f()\n+  {\n+    static struct {\n+      int i;\n+    } s;\n+    return s.i;\n+  }\n+};\n+\n+int main()\n+{\n+  return A::f();\n+}"}]}