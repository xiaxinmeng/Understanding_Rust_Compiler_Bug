{"sha": "da3ebf2ddefe30d18110c6f73ca8abe644c46b5d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZGEzZWJmMmRkZWZlMzBkMTgxMTBjNmY3M2NhOGFiZTY0NGM0NmI1ZA==", "commit": {"author": {"name": "Tom de Vries", "email": "tom@codesourcery.com", "date": "2016-04-17T05:22:45Z"}, "committer": {"name": "Tom de Vries", "email": "vries@gcc.gnu.org", "date": "2016-04-17T05:22:45Z"}, "message": "Simplify loop in pp_write_text_as_dot_label_to_stream\n\n2016-04-17  Tom de Vries  <tom@codesourcery.com>\n\n\t* pretty-print.c (pp_write_text_as_dot_label_to_stream): Simplify loop\n\tstructure.\n\nFrom-SVN: r235075", "tree": {"sha": "2650aaaf6a4a08998177636ea3795ff236f74b51", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2650aaaf6a4a08998177636ea3795ff236f74b51"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/da3ebf2ddefe30d18110c6f73ca8abe644c46b5d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/da3ebf2ddefe30d18110c6f73ca8abe644c46b5d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/da3ebf2ddefe30d18110c6f73ca8abe644c46b5d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/da3ebf2ddefe30d18110c6f73ca8abe644c46b5d/comments", "author": null, "committer": null, "parents": [{"sha": "182c78687e6cf481c4d8e8fce99a0f293510adb7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/182c78687e6cf481c4d8e8fce99a0f293510adb7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/182c78687e6cf481c4d8e8fce99a0f293510adb7"}], "stats": {"total": 28, "additions": 19, "deletions": 9}, "files": [{"sha": "2bd0d6fb6d08342d4e0f9010071e5d74217c0f0b", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/da3ebf2ddefe30d18110c6f73ca8abe644c46b5d/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/da3ebf2ddefe30d18110c6f73ca8abe644c46b5d/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=da3ebf2ddefe30d18110c6f73ca8abe644c46b5d", "patch": "@@ -1,3 +1,8 @@\n+2016-04-17  Tom de Vries  <tom@codesourcery.com>\n+\n+\t* pretty-print.c (pp_write_text_as_dot_label_to_stream): Simplify loop\n+\tstructure.\n+\n 2016-04-17  Tom de Vries  <tom@codesourcery.com>\n \n \tPR other/70185"}, {"sha": "f6e4b43d9fbcddf1fd7df35c621e8ffa002387c4", "filename": "gcc/pretty-print.c", "status": "modified", "additions": 14, "deletions": 9, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/da3ebf2ddefe30d18110c6f73ca8abe644c46b5d/gcc%2Fpretty-print.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/da3ebf2ddefe30d18110c6f73ca8abe644c46b5d/gcc%2Fpretty-print.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fpretty-print.c?ref=da3ebf2ddefe30d18110c6f73ca8abe644c46b5d", "patch": "@@ -159,20 +159,20 @@ pp_write_text_as_dot_label_to_stream (pretty_printer *pp, bool for_record)\n   const char *p = text;\n   FILE *fp = pp_buffer (pp)->stream;\n \n-  while (*p)\n+  for (;*p; p++)\n     {\n+      bool escape_char;\n       switch (*p)\n \t{\n \t/* Print newlines as a left-aligned newline.  */\n \tcase '\\n':\n-\t  fputs (\"\\\\l\\\\\\n\", fp);\n+\t  fputs (\"\\\\l\", fp);\n+\t  escape_char = true;\n \t  break;\n \n \t/* A pipe is only special for record-shape nodes.  */\n \tcase '|':\n-\t  if (for_record)\n-\t    fputc ('\\\\', fp);\n-\t  fputc (*p, fp);\n+\t  escape_char = for_record;\n \t  break;\n \n \t/* The following characters always have to be escaped\n@@ -183,13 +183,18 @@ pp_write_text_as_dot_label_to_stream (pretty_printer *pp, bool for_record)\n \tcase '>':\n \tcase '\"':\n \tcase ' ':\n-\t  fputc ('\\\\', fp);\n-\t  /* fall through */\n+\t  escape_char = true;\n+\t  break;\n+\n \tdefault:\n-\t  fputc (*p, fp);\n+\t  escape_char = false;\n \t  break;\n \t}\n-      p++;\n+\n+      if (escape_char)\n+\tfputc ('\\\\', fp);\n+\n+      fputc (*p, fp);\n     }\n \n   pp_clear_output_area (pp);"}]}