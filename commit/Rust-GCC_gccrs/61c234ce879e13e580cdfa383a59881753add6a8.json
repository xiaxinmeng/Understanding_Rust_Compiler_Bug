{"sha": "61c234ce879e13e580cdfa383a59881753add6a8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjFjMjM0Y2U4NzllMTNlNTgwY2RmYTM4M2E1OTg4MTc1M2FkZDZhOA==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2003-08-23T22:18:54Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2003-08-23T22:18:54Z"}, "message": "c-decl.c (pushdecl): Only put decls which finish_struct will do something about onto incomplete chain.\n\n\t* c-decl.c (pushdecl): Only put decls which finish_struct will do\n\tsomething about onto incomplete chain.\n\t(finish_struct): If not removing type from incomplete\n\tlist, update prev.\n\n\t* gcc.dg/20030815-1.c: New test.\n\nFrom-SVN: r70752", "tree": {"sha": "78a76c5ec38f223d94c70b1761e375c81455986b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/78a76c5ec38f223d94c70b1761e375c81455986b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/61c234ce879e13e580cdfa383a59881753add6a8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/61c234ce879e13e580cdfa383a59881753add6a8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/61c234ce879e13e580cdfa383a59881753add6a8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/61c234ce879e13e580cdfa383a59881753add6a8/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "ebe75517d4ffdb7045a607c6c5426306dbf662ee", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ebe75517d4ffdb7045a607c6c5426306dbf662ee", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ebe75517d4ffdb7045a607c6c5426306dbf662ee"}], "stats": {"total": 50, "additions": 47, "deletions": 3}, "files": [{"sha": "b793413b428d4e0900d7eda0a118f0b3ac0953b7", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/61c234ce879e13e580cdfa383a59881753add6a8/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/61c234ce879e13e580cdfa383a59881753add6a8/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=61c234ce879e13e580cdfa383a59881753add6a8", "patch": "@@ -1,3 +1,10 @@\n+2003-08-23  Jakub Jelinek  <jakub@redhat.com>\n+\n+\t* c-decl.c (pushdecl): Only put decls which finish_struct will do\n+\tsomething about onto incomplete chain.\n+\t(finish_struct): If not removing type from incomplete\n+\tlist, update prev.\n+\n Wed Aug 20 12:08:55 CEST 2003  Jan Hubicka  <jh@suse.cz>\n \n \tPR target/11369"}, {"sha": "721946ec6c8ac889c7934744600ac18aaee580f3", "filename": "gcc/c-decl.c", "status": "modified", "additions": 10, "deletions": 3, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/61c234ce879e13e580cdfa383a59881753add6a8/gcc%2Fc-decl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/61c234ce879e13e580cdfa383a59881753add6a8/gcc%2Fc-decl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-decl.c?ref=61c234ce879e13e580cdfa383a59881753add6a8", "patch": "@@ -1760,8 +1760,10 @@ pushdecl (tree x)\n \n \t  while (TREE_CODE (element) == ARRAY_TYPE)\n \t    element = TREE_TYPE (element);\n-\t  if (TREE_CODE (element) == RECORD_TYPE\n-\t      || TREE_CODE (element) == UNION_TYPE)\n+\t  if ((TREE_CODE (element) == RECORD_TYPE\n+\t       || TREE_CODE (element) == UNION_TYPE)\n+\t      && (TREE_CODE (x) != TYPE_DECL\n+\t\t  || TREE_CODE (TREE_TYPE (x)) == ARRAY_TYPE))\n \t    scope->incomplete = tree_cons (NULL_TREE, x, scope->incomplete);\n \t}\n     }\n@@ -5154,7 +5156,8 @@ finish_struct (tree t, tree fieldlist, tree attributes)\n \t      && TREE_CODE (decl) != TYPE_DECL)\n \t    {\n \t      layout_decl (decl, 0);\n-\t      /* This is a no-op in c-lang.c or something real in objc-act.c.  */\n+\t      /* This is a no-op in c-lang.c or something real in\n+\t\t objc-act.c.  */\n \t      if (c_dialect_objc ())\n \t\tobjc_check_decl (decl);\n \t      rest_of_decl_compilation (decl, NULL, toplevel, 0);\n@@ -5190,7 +5193,11 @@ finish_struct (tree t, tree fieldlist, tree attributes)\n \t\t  else\n \t\t    current_scope->incomplete = TREE_CHAIN (x);\n \t\t}\n+\t      else\n+\t\tprev = x;\n \t    }\n+\t  else\n+\t    prev = x;\n \t}\n     }\n "}, {"sha": "bfcab555256c4e1eb69fdb2a1b8fbe41f9f1e7ab", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/61c234ce879e13e580cdfa383a59881753add6a8/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/61c234ce879e13e580cdfa383a59881753add6a8/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=61c234ce879e13e580cdfa383a59881753add6a8", "patch": "@@ -1,3 +1,7 @@\n+2003-08-23  Jakub Jelinek  <jakub@redhat.com>\n+\n+\t* gcc.dg/20030815-1.c: New test.\n+\n 2003-08-23  Kriang Lerdsuwanakij  <lerdsuwa@users.sourceforge.net>\n \n \tPR c++/3765"}, {"sha": "fe1e7b49a581e24c8c515023c0ce2ef820ae6d1a", "filename": "gcc/testsuite/gcc.dg/20030815-1.c", "status": "added", "additions": 26, "deletions": 0, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/61c234ce879e13e580cdfa383a59881753add6a8/gcc%2Ftestsuite%2Fgcc.dg%2F20030815-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/61c234ce879e13e580cdfa383a59881753add6a8/gcc%2Ftestsuite%2Fgcc.dg%2F20030815-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2F20030815-1.c?ref=61c234ce879e13e580cdfa383a59881753add6a8", "patch": "@@ -0,0 +1,26 @@\n+/* Test completion of incomplete types.\n+   There used to be a bug where some types from incomplete\n+   list were accidentally lost.  */\n+/* { dg-do compile } */\n+/* { dg-options \"\" } */\n+\n+typedef struct a A[1];\n+typedef struct b B[1];\n+typedef struct c C[1];\n+typedef struct d D[1];\n+typedef struct a E;\n+typedef struct b F;\n+typedef struct c G;\n+typedef struct d H;\n+struct a { int a; };\n+struct c { int c; };\n+struct d { int d; };\n+struct b { int b; };\n+int sa = sizeof (A);\n+int sb = sizeof (B);\n+int sc = sizeof (C);\n+int sd = sizeof (D);\n+int se = sizeof (E);\n+int sf = sizeof (F);\n+int sg = sizeof (G);\n+int sh = sizeof (H);"}]}