{"sha": "220ab6b433ee3a360c52032445676758991ed7d9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjIwYWI2YjQzM2VlM2EzNjBjNTIwMzI0NDU2NzY3NTg5OTFlZDdkOQ==", "commit": {"author": {"name": "Steven G. Kargl", "email": "kargl@gcc.gnu.org", "date": "2015-10-02T00:49:28Z"}, "committer": {"name": "Steven G. Kargl", "email": "kargl@gcc.gnu.org", "date": "2015-10-02T00:49:28Z"}, "message": "re PR fortran/66979 (gfortran internal compiler error with malformed FLUSH statement)\n\n2015-10-01  Steven G. Kargl  <kargl@gcc.gnu.org>\n\n\tPR fortran/66979\n\t* io.c (gfc_resolve_filepos): Check for a UNIT number.  Add a nearby\n\tmissing 'return false'.\n\n2015-10-01  Steven G. Kargl  <kargl@gcc.gnu.org>\n\n\tPR fortran/66979\n\tgfortran.dg/pr66979.f90: new test.\n\nFrom-SVN: r228364", "tree": {"sha": "02754e54539199603e6cddc52673d2a6e442426e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/02754e54539199603e6cddc52673d2a6e442426e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/220ab6b433ee3a360c52032445676758991ed7d9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/220ab6b433ee3a360c52032445676758991ed7d9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/220ab6b433ee3a360c52032445676758991ed7d9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/220ab6b433ee3a360c52032445676758991ed7d9/comments", "author": null, "committer": null, "parents": [{"sha": "b64c3d0696c572b7fc21fecfd78b9aaadf2b4892", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b64c3d0696c572b7fc21fecfd78b9aaadf2b4892", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b64c3d0696c572b7fc21fecfd78b9aaadf2b4892"}], "stats": {"total": 27, "additions": 27, "deletions": 0}, "files": [{"sha": "9e6f2bdbcd530ee955327445a9d68195066d180e", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/220ab6b433ee3a360c52032445676758991ed7d9/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/220ab6b433ee3a360c52032445676758991ed7d9/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=220ab6b433ee3a360c52032445676758991ed7d9", "patch": "@@ -1,3 +1,9 @@\n+2015-10-01  Steven G. Kargl  <kargl@gcc.gnu.org>\n+\n+\tPR fortran/66979\n+\t* io.c (gfc_resolve_filepos): Check for a UNIT number.  Add a nearby\n+\tmissing 'return false'.\n+\n 2015-10-01  Steven G. Kargl  <kargl@gcc.gnu.org>\n \n \tPR fortran/67616"}, {"sha": "e5d68fb60badc52f51b5c62f761b6d6ff792bd64", "filename": "gcc/fortran/io.c", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/220ab6b433ee3a360c52032445676758991ed7d9/gcc%2Ffortran%2Fio.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/220ab6b433ee3a360c52032445676758991ed7d9/gcc%2Ffortran%2Fio.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fio.c?ref=220ab6b433ee3a360c52032445676758991ed7d9", "patch": "@@ -2515,12 +2515,21 @@ gfc_resolve_filepos (gfc_filepos *fp)\n   if (!gfc_reference_st_label (fp->err, ST_LABEL_TARGET))\n     return false;\n \n+  if (!fp->unit && (fp->iostat || fp->iomsg))\n+    {\n+      locus where;\n+      where = fp->iostat ? fp->iostat->where : fp->iomsg->where;\n+      gfc_error (\"UNIT number missing in statement at %L\", &where);\n+      return false;\n+    }\n+\n   if (fp->unit->expr_type == EXPR_CONSTANT\n       && fp->unit->ts.type == BT_INTEGER\n       && mpz_sgn (fp->unit->value.integer) < 0)\n     {\n       gfc_error (\"UNIT number in statement at %L must be non-negative\",\n \t\t &fp->unit->where);\n+      return false;\n     }\n \n   return true;"}, {"sha": "ea748b92adc4117bfa3d77b3a20d2dfbc6e2e5f3", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/220ab6b433ee3a360c52032445676758991ed7d9/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/220ab6b433ee3a360c52032445676758991ed7d9/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=220ab6b433ee3a360c52032445676758991ed7d9", "patch": "@@ -1,3 +1,8 @@\n+2015-10-01  Steven G. Kargl  <kargl@gcc.gnu.org>\n+\n+\tPR fortran/66979\n+\tgfortran.dg/pr66979.f90: new test.\n+\n 2015-10-01  Steven G. Kargl  <kargl@gcc.gnu.org>\n \n \tPR fortran/67616"}, {"sha": "c102e91e91d3eecb18f35a6bb6429ce2f41a0b6f", "filename": "gcc/testsuite/gfortran.dg/pr66979.f90", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/220ab6b433ee3a360c52032445676758991ed7d9/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr66979.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/220ab6b433ee3a360c52032445676758991ed7d9/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr66979.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr66979.f90?ref=220ab6b433ee3a360c52032445676758991ed7d9", "patch": "@@ -0,0 +1,7 @@\n+! { dg-do compile }\n+! PR fortran/66979\n+program p\n+  implicit none\n+  integer::i\n+  flush (iostat=i) ! { dg-error \"UNIT number missing\" }\n+end program p"}]}