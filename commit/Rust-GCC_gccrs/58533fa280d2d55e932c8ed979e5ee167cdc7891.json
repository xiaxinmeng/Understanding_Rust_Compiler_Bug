{"sha": "58533fa280d2d55e932c8ed979e5ee167cdc7891", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTg1MzNmYTI4MGQyZDU1ZTkzMmM4ZWQ5NzllNWVlMTY3Y2RjNzg5MQ==", "commit": {"author": {"name": "Richard Henderson", "email": "rth@redhat.com", "date": "2002-04-19T04:41:34Z"}, "committer": {"name": "Richard Henderson", "email": "rth@gcc.gnu.org", "date": "2002-04-19T04:41:34Z"}, "message": "* function.c: Revert patch for c/6358.\n\nFrom-SVN: r52511", "tree": {"sha": "011f22bf1211c4716db4b4fdaacc7666e30d69f6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/011f22bf1211c4716db4b4fdaacc7666e30d69f6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/58533fa280d2d55e932c8ed979e5ee167cdc7891", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/58533fa280d2d55e932c8ed979e5ee167cdc7891", "html_url": "https://github.com/Rust-GCC/gccrs/commit/58533fa280d2d55e932c8ed979e5ee167cdc7891", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/58533fa280d2d55e932c8ed979e5ee167cdc7891/comments", "author": null, "committer": null, "parents": [{"sha": "0cd3301ba72bd155f8808d6395e5766a592e980c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0cd3301ba72bd155f8808d6395e5766a592e980c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0cd3301ba72bd155f8808d6395e5766a592e980c"}], "stats": {"total": 63, "additions": 24, "deletions": 39}, "files": [{"sha": "dabbf94c4536c4a6fe8a918e6732eb9fffa2b733", "filename": "gcc/ChangeLog", "status": "modified", "additions": 10, "deletions": 6, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/58533fa280d2d55e932c8ed979e5ee167cdc7891/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/58533fa280d2d55e932c8ed979e5ee167cdc7891/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=58533fa280d2d55e932c8ed979e5ee167cdc7891", "patch": "@@ -1,15 +1,19 @@\n 2002-04-18  Richard Henderson  <rth@redhat.com>\n \n-        * ifcvt.c (find_cond_trap): Handle cases with no proper THEN or JOIN\n-        blocks.  Handle multiple references to the TRAP block.  Handle\n-        non-adjacent THEN and OTHER blocks.\n+\t* function.c: Revert patch for c/6358.\n \n 2002-04-18  Richard Henderson  <rth@redhat.com>\n \n-        * config/ia64/ia64.c (ia64_function_arg_pass_by_reference): Don't\n-        crash with no type for by-mode libcalls.\n+\t* ifcvt.c (find_cond_trap): Handle cases with no proper THEN or JOIN\n+\tblocks.  Handle multiple references to the TRAP block.  Handle\n+\tnon-adjacent THEN and OTHER blocks.\n \n-        * config/ia64/ia64.md (conditional_trap): Fix predicate polarity.\n+2002-04-18  Richard Henderson  <rth@redhat.com>\n+\n+\t* config/ia64/ia64.c (ia64_function_arg_pass_by_reference): Don't\n+\tcrash with no type for by-mode libcalls.\n+\n+\t* config/ia64/ia64.md (conditional_trap): Fix predicate polarity.\n \n 2002-04-18  Bob Wilson  <bob.wilson@acm.org>\n "}, {"sha": "86a87ab60683574c10daf8136d907418561b4d3f", "filename": "gcc/function.c", "status": "modified", "additions": 14, "deletions": 33, "changes": 47, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/58533fa280d2d55e932c8ed979e5ee167cdc7891/gcc%2Ffunction.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/58533fa280d2d55e932c8ed979e5ee167cdc7891/gcc%2Ffunction.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffunction.c?ref=58533fa280d2d55e932c8ed979e5ee167cdc7891", "patch": "@@ -5145,35 +5145,6 @@ assign_parms (fndecl)\n   current_function_return_rtx\n     = (DECL_RTL_SET_P (DECL_RESULT (fndecl))\n        ? DECL_RTL (DECL_RESULT (fndecl)) : NULL_RTX);\n-\n-  /* If scalar return value was computed in a pseudo-reg, or was a named\n-     return value that got dumped to the stack, copy that to the hard\n-     return register.  */\n-  if (DECL_RTL_SET_P (DECL_RESULT (fndecl)))\n-    {\n-      tree decl_result = DECL_RESULT (fndecl);\n-      rtx decl_rtl = DECL_RTL (decl_result);\n-\n-      if (REG_P (decl_rtl)\n-\t  ? REGNO (decl_rtl) >= FIRST_PSEUDO_REGISTER\n-\t  : DECL_REGISTER (decl_result))\n-\t{\n-\t  rtx real_decl_rtl;\n-\n-#ifdef FUNCTION_OUTGOING_VALUE\n-\t  real_decl_rtl = FUNCTION_OUTGOING_VALUE (TREE_TYPE (decl_result),\n-\t\t\t\t\t\t   fndecl);\n-#else\n-\t  real_decl_rtl = FUNCTION_VALUE (TREE_TYPE (decl_result),\n-\t\t\t\t\t  fndecl);\n-#endif\n-\t  REG_FUNCTION_VALUE_P (real_decl_rtl) = 1;\n-\t  /* The delay slot scheduler assumes that current_function_return_rtx\n-\t     holds the hard register containing the return value, not a\n-\t     temporary pseudo.  */\n-\t  current_function_return_rtx = real_decl_rtl;\n-\t}\n-    }\n }\n \f\n /* Indicate whether REGNO is an incoming argument to the current function\n@@ -6987,11 +6958,16 @@ expand_function_end (filename, line, end_bindings)\n \t  ? REGNO (decl_rtl) >= FIRST_PSEUDO_REGISTER\n \t  : DECL_REGISTER (decl_result))\n \t{\n-\t  rtx real_decl_rtl = current_function_return_rtx;\n+\t  rtx real_decl_rtl;\n \n-\t  /* This should be set in assign_parms.  */\n-\t  if (! REG_FUNCTION_VALUE_P (real_decl_rtl))\n-\t    abort ();\n+#ifdef FUNCTION_OUTGOING_VALUE\n+\t  real_decl_rtl = FUNCTION_OUTGOING_VALUE (TREE_TYPE (decl_result),\n+\t\t\t\t\t\t   current_function_decl);\n+#else\n+\t  real_decl_rtl = FUNCTION_VALUE (TREE_TYPE (decl_result),\n+\t\t\t\t\t  current_function_decl);\n+#endif\n+\t  REG_FUNCTION_VALUE_P (real_decl_rtl) = 1;\n \n \t  /* If this is a BLKmode structure being returned in registers,\n \t     then use the mode computed in expand_return.  Note that if\n@@ -7019,6 +6995,11 @@ expand_function_end (filename, line, end_bindings)\n \t\t\t     int_size_in_bytes (TREE_TYPE (decl_result)));\n \t  else\n \t    emit_move_insn (real_decl_rtl, decl_rtl);\n+\n+\t  /* The delay slot scheduler assumes that current_function_return_rtx\n+\t     holds the hard register containing the return value, not a\n+\t     temporary pseudo.  */\n+\t  current_function_return_rtx = real_decl_rtl;\n \t}\n     }\n "}]}