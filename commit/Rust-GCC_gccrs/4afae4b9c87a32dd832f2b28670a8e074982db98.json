{"sha": "4afae4b9c87a32dd832f2b28670a8e074982db98", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NGFmYWU0YjljODdhMzJkZDgzMmYyYjI4NjcwYThlMDc0OTgyZGI5OA==", "commit": {"author": {"name": "Joel Sherrill", "email": "joel@OARcorp.com", "date": "2004-04-08T17:30:32Z"}, "committer": {"name": "Joel Sherrill", "email": "joel@gcc.gnu.org", "date": "2004-04-08T17:30:32Z"}, "message": "re PR ada/14665 (gnatmake invokes wrong cross tools)\n\n2004-04-08  Joel Sherrill  <joel@oarcorp.com>\n\n\tPR ada/14665\n\t* ada/osint.adb (Find_Program_Name): Rework to properly handle\n\tfilenames which end in .exe or have versioning suffixes like VMS.\n\nFrom-SVN: r80514", "tree": {"sha": "23b4a09cb41bb8b497bc34ac574ec87bee101e9b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/23b4a09cb41bb8b497bc34ac574ec87bee101e9b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4afae4b9c87a32dd832f2b28670a8e074982db98", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4afae4b9c87a32dd832f2b28670a8e074982db98", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4afae4b9c87a32dd832f2b28670a8e074982db98", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4afae4b9c87a32dd832f2b28670a8e074982db98/comments", "author": null, "committer": null, "parents": [{"sha": "467f3af023d0794a67636bed334683a62fdb7058", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/467f3af023d0794a67636bed334683a62fdb7058", "html_url": "https://github.com/Rust-GCC/gccrs/commit/467f3af023d0794a67636bed334683a62fdb7058"}], "stats": {"total": 41, "additions": 36, "deletions": 5}, "files": [{"sha": "7639f5efac247dc5b83380cac8dce7359c1c3557", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4afae4b9c87a32dd832f2b28670a8e074982db98/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4afae4b9c87a32dd832f2b28670a8e074982db98/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=4afae4b9c87a32dd832f2b28670a8e074982db98", "patch": "@@ -1,3 +1,9 @@\n+2004-04-08  Joel Sherrill  <joel@oarcorp.com>\n+\n+\tPR ada/14665\n+\t* ada/osint.adb (Find_Program_Name): Rework to properly handle\n+\tfilenames which end in .exe or have versioning suffixes like VMS.\n+\n 2004-04-08  Andrew Pinski  <pinskia@physics.uc.edu>\n \n \tPR target/10129"}, {"sha": "2dc5c3215092934337c29b2db484407da2349e93", "filename": "gcc/ada/osint.adb", "status": "modified", "additions": 30, "deletions": 5, "changes": 35, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4afae4b9c87a32dd832f2b28670a8e074982db98/gcc%2Fada%2Fosint.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4afae4b9c87a32dd832f2b28670a8e074982db98/gcc%2Fada%2Fosint.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fosint.adb?ref=4afae4b9c87a32dd832f2b28670a8e074982db98", "patch": "@@ -1008,12 +1008,37 @@ package body Osint is\n          end if;\n       end loop;\n \n-      for J in reverse Cindex1 .. Cindex2 loop\n-         if Command_Name (J) = '.' then\n-            Cindex2 := J - 1;\n-            exit;\n+      --  Command_Name(Cindex1 .. Cindex2) is now the equivalent of the\n+      --  POSIX command \"basename argv[0]\"\n+\n+      --  Strip off any versioning information such as found on VMS.\n+      --  This would take the form of TOOL.exe followed by a \";\" or \".\"\n+      --  and a sequence of one or more numbers.\n+\n+      if Command_Name (Cindex2) in '0' .. '9' then\n+         for J in reverse Cindex1 .. Cindex2 loop\n+\n+            exit when Command_Name (J) not in '0' .. '9';\n+\n+            if Command_Name (J) = '.' or Command_Name (J) = ';' then\n+               Cindex2 := J - 1;\n+               exit;\n+            end if;\n+         end loop;\n+      end if;\n+\n+      --  Strip off any executable extension (usually nothing or .exe)\n+      --  but formally reported by autoconf in the variable EXEEXT\n+\n+      if Cindex2 - Cindex1 >= 4 then\n+         if To_Lower (Command_Name (Cindex2 - 3)) = '.'\n+            and then To_Lower (Command_Name (Cindex2 - 2)) = 'e'\n+            and then To_Lower (Command_Name (Cindex2 - 1)) = 'x'\n+            and then To_Lower (Command_Name (Cindex2)) = 'e'\n+         then\n+            Cindex2 := Cindex2 - 4;\n          end if;\n-      end loop;\n+      end if;\n \n       Name_Len := Cindex2 - Cindex1 + 1;\n       Name_Buffer (1 .. Name_Len) := Command_Name (Cindex1 .. Cindex2);"}]}