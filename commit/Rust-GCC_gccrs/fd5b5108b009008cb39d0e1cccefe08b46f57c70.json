{"sha": "fd5b5108b009008cb39d0e1cccefe08b46f57c70", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZmQ1YjUxMDhiMDA5MDA4Y2IzOWQwZTFjY2NlZmUwOGI0NmY1N2M3MA==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2006-11-21T09:43:16Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2006-11-21T09:43:16Z"}, "message": "re PR c++/29570 (ICE with brace-enclosed initializer)\n\n\tPR c++/29570\n\t* decl.c (cp_finish_decl): Check for value dependent brace enclosed\n\tscalar initializer.\n\n\t* g++.dg/template/static29.C: New test.\n\nFrom-SVN: r119045", "tree": {"sha": "f4ca07233bb06e4e51b75b59fd0969dbf091802a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f4ca07233bb06e4e51b75b59fd0969dbf091802a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/fd5b5108b009008cb39d0e1cccefe08b46f57c70", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fd5b5108b009008cb39d0e1cccefe08b46f57c70", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fd5b5108b009008cb39d0e1cccefe08b46f57c70", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fd5b5108b009008cb39d0e1cccefe08b46f57c70/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "4576ceaf227bb48e2771f388405e3043b5e4ffeb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4576ceaf227bb48e2771f388405e3043b5e4ffeb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4576ceaf227bb48e2771f388405e3043b5e4ffeb"}], "stats": {"total": 21, "additions": 20, "deletions": 1}, "files": [{"sha": "0cd3ccc8fb6156265eb943aa494df0819127dd2c", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fd5b5108b009008cb39d0e1cccefe08b46f57c70/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fd5b5108b009008cb39d0e1cccefe08b46f57c70/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=fd5b5108b009008cb39d0e1cccefe08b46f57c70", "patch": "@@ -1,5 +1,9 @@\n 2006-11-21  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR c++/29570\n+\t* decl.c (cp_finish_decl): Check for value dependent brace enclosed\n+\tscalar initializer.\n+\n \tPR c++/29734\n \t* cp-tree.h (WANT_VECTOR): Define.\n \t(WANT_ARITH): Add WANT_VECTOR."}, {"sha": "d10c3a2f0482801db80a40ef5c41992a1d8f2423", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fd5b5108b009008cb39d0e1cccefe08b46f57c70/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fd5b5108b009008cb39d0e1cccefe08b46f57c70/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=fd5b5108b009008cb39d0e1cccefe08b46f57c70", "patch": "@@ -5058,7 +5058,14 @@ cp_finish_decl (tree decl, tree init, bool init_const_expr_p,\n \t  || !DECL_CLASS_SCOPE_P (decl)\n \t  || !DECL_INTEGRAL_CONSTANT_VAR_P (decl)\n \t  || type_dependent_p\n-\t  || value_dependent_expression_p (init))\n+\t  || value_dependent_expression_p (init)\n+\t     /* Check also if initializer is a value dependent\n+\t\t{ integral_constant_expression }.  */\n+\t  || (TREE_CODE (init) == CONSTRUCTOR\n+\t      && VEC_length (constructor_elt, CONSTRUCTOR_ELTS (init)) == 1\n+\t      && value_dependent_expression_p\n+\t\t   (VEC_index (constructor_elt,\n+\t\t\t       CONSTRUCTOR_ELTS (init), 0)->value)))\n \t{\n \t  if (init)\n \t    DECL_INITIAL (decl) = init;"}, {"sha": "d0f9bc073fe676b7b3b68e8fd11f4f3c5cc92aa9", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fd5b5108b009008cb39d0e1cccefe08b46f57c70/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fd5b5108b009008cb39d0e1cccefe08b46f57c70/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=fd5b5108b009008cb39d0e1cccefe08b46f57c70", "patch": "@@ -1,5 +1,8 @@\n 2006-11-21  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR c++/29570\n+\t* g++.dg/template/static29.C: New test.\n+\n \tPR c++/29734\n \t* g++.dg/conversion/simd4.C: New test.\n "}, {"sha": "a949c0cd85eadc1e7744862bb417f58bc38c2a2c", "filename": "gcc/testsuite/g++.dg/template/static29.C", "status": "added", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fd5b5108b009008cb39d0e1cccefe08b46f57c70/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fstatic29.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fd5b5108b009008cb39d0e1cccefe08b46f57c70/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fstatic29.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fstatic29.C?ref=fd5b5108b009008cb39d0e1cccefe08b46f57c70", "patch": "@@ -0,0 +1,5 @@\n+// PR c++/29570\n+\n+template<int> struct A { static const int i; };\n+\n+template<int N> const int A<N>::i = { A<N>::i };"}]}