{"sha": "9910c53c49cd73e11ef039c011287b342fb8b6d2", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTkxMGM1M2M0OWNkNzNlMTFlZjAzOWMwMTEyODdiMzQyZmI4YjZkMg==", "commit": {"author": {"name": "Joey Ye", "email": "joey.ye@arm.com", "date": "2014-02-28T12:02:13Z"}, "committer": {"name": "Joey Ye", "email": "jye2@gcc.gnu.org", "date": "2014-02-28T12:02:13Z"}, "message": "PR target/PR60169\n\n2014-02-28  Joey Ye  <joey.ye@arm.com>\n\n        PR target/PR60169\n\t* config/arm/arm.c (thumb_far_jump_used_p): Don't change\n\tif reload in progress or completed.\n\ntestsuite:\n\t* gcc.target/arm/thumb1-far-jump-3.c: New case.\n\nFrom-SVN: r208217", "tree": {"sha": "f15fb69455b00b99ab88ff45c3f5e078e1a18b44", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f15fb69455b00b99ab88ff45c3f5e078e1a18b44"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9910c53c49cd73e11ef039c011287b342fb8b6d2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9910c53c49cd73e11ef039c011287b342fb8b6d2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9910c53c49cd73e11ef039c011287b342fb8b6d2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9910c53c49cd73e11ef039c011287b342fb8b6d2/comments", "author": {"login": "joeye-arm", "id": 38510878, "node_id": "MDQ6VXNlcjM4NTEwODc4", "avatar_url": "https://avatars.githubusercontent.com/u/38510878?v=4", "gravatar_id": "", "url": "https://api.github.com/users/joeye-arm", "html_url": "https://github.com/joeye-arm", "followers_url": "https://api.github.com/users/joeye-arm/followers", "following_url": "https://api.github.com/users/joeye-arm/following{/other_user}", "gists_url": "https://api.github.com/users/joeye-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/joeye-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/joeye-arm/subscriptions", "organizations_url": "https://api.github.com/users/joeye-arm/orgs", "repos_url": "https://api.github.com/users/joeye-arm/repos", "events_url": "https://api.github.com/users/joeye-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/joeye-arm/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "070f030948bcf458cb39b39e91708fb2a2b72855", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/070f030948bcf458cb39b39e91708fb2a2b72855", "html_url": "https://github.com/Rust-GCC/gccrs/commit/070f030948bcf458cb39b39e91708fb2a2b72855"}], "stats": {"total": 124, "additions": 124, "deletions": 0}, "files": [{"sha": "c0304cf7539ac6c74fdccbcbce201855fe014e82", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9910c53c49cd73e11ef039c011287b342fb8b6d2/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9910c53c49cd73e11ef039c011287b342fb8b6d2/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=9910c53c49cd73e11ef039c011287b342fb8b6d2", "patch": "@@ -1,3 +1,9 @@\n+2014-02-28  Joey Ye  <joey.ye@arm.com>\n+\n+\tPR target/PR60169\n+\t* config/arm/arm.c (thumb_far_jump_used_p): Don't change\n+\tif reload in progress or completed.\n+\n 2014-02-28  Tobias Burnus  <burnus@net-b.de>\n \n \tPR middle-end/60147"}, {"sha": "ce24bfed732e9e00389e9d79c3e71e82a6c348c2", "filename": "gcc/config/arm/arm.c", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9910c53c49cd73e11ef039c011287b342fb8b6d2/gcc%2Fconfig%2Farm%2Farm.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9910c53c49cd73e11ef039c011287b342fb8b6d2/gcc%2Fconfig%2Farm%2Farm.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Farm.c?ref=9910c53c49cd73e11ef039c011287b342fb8b6d2", "patch": "@@ -26255,6 +26255,11 @@ thumb_far_jump_used_p (void)\n \treturn 0;\n     }\n \n+  /* We should not change far_jump_used during or after reload, as there is\n+     no chance to change stack frame layout.  */\n+  if (reload_in_progress || reload_completed)\n+    return 0;\n+\n   /* Check to see if the function contains a branch\n      insn with the far jump attribute set.  */\n   for (insn = get_insns (); insn; insn = NEXT_INSN (insn))"}, {"sha": "dac918c89ae6bcfa1658ddee5a696985a244687a", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9910c53c49cd73e11ef039c011287b342fb8b6d2/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9910c53c49cd73e11ef039c011287b342fb8b6d2/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=9910c53c49cd73e11ef039c011287b342fb8b6d2", "patch": "@@ -1,3 +1,8 @@\n+2014-02-28  Joey Ye  <joey.ye@arm.com>\n+\n+\tPR target/PR60169\n+\t* gcc.target/arm/thumb1-far-jump-3.c: New case.\n+\n 2014-02-27  Paolo Carlini  <paolo.carlini@oracle.com>\n \n \tPR c++/60253"}, {"sha": "90559bacb2af6c86dda614c949dfa13a92b3757f", "filename": "gcc/testsuite/gcc.target/arm/thumb1-far-jump-3.c", "status": "added", "additions": 108, "deletions": 0, "changes": 108, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9910c53c49cd73e11ef039c011287b342fb8b6d2/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fthumb1-far-jump-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9910c53c49cd73e11ef039c011287b342fb8b6d2/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fthumb1-far-jump-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fthumb1-far-jump-3.c?ref=9910c53c49cd73e11ef039c011287b342fb8b6d2", "patch": "@@ -0,0 +1,108 @@\n+/* Catch reload ICE on target thumb1 with far jump optimization.\n+ * It is also a valid case for non-thumb1 target.  */\n+\n+/* Add -mno-lra option as it is only reproducable with reload.  It will\n+   be removed after reload is completely removed.  */\n+/* { dg-options \"-mno-lra -fomit-frame-pointer\" } */\n+/* { dg-do compile } */\n+\n+#define C      2\n+#define A      4\n+#define RGB  (C | A)\n+#define GRAY (A)\n+\n+typedef unsigned long uint_32;\n+typedef unsigned char byte;\n+typedef byte        * bytep;\n+\n+typedef struct ss\n+{\n+   uint_32 w;\n+   uint_32 r;\n+   byte c;\n+   byte b;\n+   byte p;\n+} info;\n+\n+typedef info * infop;\n+\n+void\n+foo(infop info, bytep row)\n+{\n+   uint_32 iw = info->w;\n+   if (info->c == RGB)\n+   {\n+      if (info->b == 8)\n+      {\n+         bytep sp = row + info->r;\n+         bytep dp = sp;\n+         byte save;\n+         uint_32 i;\n+\n+         for (i = 0; i < iw; i++)\n+         {\n+            save = *(--sp);\n+            *(--dp) = *(--sp);\n+            *(--dp) = *(--sp);\n+            *(--dp) = *(--sp);\n+            *(--dp) = save;\n+         }\n+      }\n+\n+      else\n+      {\n+         bytep sp = row + info->r;\n+         bytep dp = sp;\n+         byte save[2];\n+         uint_32 i;\n+\n+         for (i = 0; i < iw; i++)\n+         {\n+            save[0] = *(--sp);\n+            save[1] = *(--sp);\n+            *(--dp) = *(--sp);\n+            *(--dp) = *(--sp);\n+            *(--dp) = *(--sp);\n+            *(--dp) = *(--sp);\n+            *(--dp) = *(--sp);\n+            *(--dp) = *(--sp);\n+            *(--dp) = save[0];\n+            *(--dp) = save[1];\n+         }\n+      }\n+   }\n+   else if (info->c == GRAY)\n+   {\n+      if (info->b == 8)\n+      {\n+         bytep sp = row + info->r;\n+         bytep dp = sp;\n+         byte save;\n+         uint_32 i;\n+\n+         for (i = 0; i < iw; i++)\n+         {\n+            save = *(--sp);\n+            *(--dp) = *(--sp);\n+            *(--dp) = save;\n+         }\n+      }\n+      else\n+      {\n+         bytep sp = row + info->r;\n+         bytep dp = sp;\n+         byte save[2];\n+         uint_32 i;\n+\n+         for (i = 0; i < iw; i++)\n+         {\n+            save[0] = *(--sp);\n+            save[1] = *(--sp);\n+            *(--dp) = *(--sp);\n+            *(--dp) = *(--sp);\n+            *(--dp) = save[0];\n+            *(--dp) = save[1];\n+         }\n+      }\n+   }\n+}"}]}