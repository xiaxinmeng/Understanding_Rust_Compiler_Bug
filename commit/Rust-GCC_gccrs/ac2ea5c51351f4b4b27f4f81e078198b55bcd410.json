{"sha": "ac2ea5c51351f4b4b27f4f81e078198b55bcd410", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWMyZWE1YzUxMzUxZjRiNGIyN2Y0ZjgxZTA3ODE5OGI1NWJjZDQxMA==", "commit": {"author": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2014-10-17T09:11:14Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2014-10-17T09:11:14Z"}, "message": "[multiple changes]\n\n2014-10-17  Ed Schonberg  <schonberg@adacore.com>\n\n\t* exp_ch3.adb (Build_Component_Invariant_Call): Retrieve Invariant\n\tsubprogram from base type.\n\t* sem_ch7.adb (Analyze_Package_Specification): Build invariant\n\tsubprogram for private type, not any of its subtypes.\n\t* sem_ch13.adb (Build_Invariant_Procedure_Declaration): Set type\n\tof procedure entity, because a call to it may be generated in\n\ta client unit before the corresponding subprogram declaration\n\tis analyzed.\n\n2014-10-17  Vincent Celier  <celier@adacore.com>\n\n\t* prj-nmsc.adb (Get_Directories): Do not create directories\n\twhen a project is abstract.\n\n2014-10-17  Ed Schonberg  <schonberg@adacore.com>\n\n\t* sem_ch5.adb (Analyze_Iterator_Specification): If the domain\n\tof iteration is given by an expression that is not an array type,\n\tverify that its type implements an iterator iterface.\n\nFrom-SVN: r216380", "tree": {"sha": "9ee5f817a683d0157c79b91d46374083b7c80f46", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9ee5f817a683d0157c79b91d46374083b7c80f46"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ac2ea5c51351f4b4b27f4f81e078198b55bcd410", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ac2ea5c51351f4b4b27f4f81e078198b55bcd410", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ac2ea5c51351f4b4b27f4f81e078198b55bcd410", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ac2ea5c51351f4b4b27f4f81e078198b55bcd410/comments", "author": null, "committer": null, "parents": [{"sha": "99425ec329df4fa7d48f34803efd901284267197", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/99425ec329df4fa7d48f34803efd901284267197", "html_url": "https://github.com/Rust-GCC/gccrs/commit/99425ec329df4fa7d48f34803efd901284267197"}], "stats": {"total": 51, "additions": 47, "deletions": 4}, "files": [{"sha": "63cf230a00152095cc58f45cc181d24629cd14d0", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ac2ea5c51351f4b4b27f4f81e078198b55bcd410/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ac2ea5c51351f4b4b27f4f81e078198b55bcd410/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=ac2ea5c51351f4b4b27f4f81e078198b55bcd410", "patch": "@@ -1,3 +1,25 @@\n+2014-10-17  Ed Schonberg  <schonberg@adacore.com>\n+\n+\t* exp_ch3.adb (Build_Component_Invariant_Call): Retrieve Invariant\n+\tsubprogram from base type.\n+\t* sem_ch7.adb (Analyze_Package_Specification): Build invariant\n+\tsubprogram for private type, not any of its subtypes.\n+\t* sem_ch13.adb (Build_Invariant_Procedure_Declaration): Set type\n+\tof procedure entity, because a call to it may be generated in\n+\ta client unit before the corresponding subprogram declaration\n+\tis analyzed.\n+\n+2014-10-17  Vincent Celier  <celier@adacore.com>\n+\n+\t* prj-nmsc.adb (Get_Directories): Do not create directories\n+\twhen a project is abstract.\n+\n+2014-10-17  Ed Schonberg  <schonberg@adacore.com>\n+\n+\t* sem_ch5.adb (Analyze_Iterator_Specification): If the domain\n+\tof iteration is given by an expression that is not an array type,\n+\tverify that its type implements an iterator iterface.\n+\n 2014-10-17  Robert Dewar  <dewar@adacore.com>\n \n \t* sem_attr.adb (Eval_Attribute): Ensure that attribute"}, {"sha": "dd6d34e00267c92fa872e2fa69d8cf5b539002e3", "filename": "gcc/ada/exp_ch3.adb", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ac2ea5c51351f4b4b27f4f81e078198b55bcd410/gcc%2Fada%2Fexp_ch3.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ac2ea5c51351f4b4b27f4f81e078198b55bcd410/gcc%2Fada%2Fexp_ch3.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fexp_ch3.adb?ref=ac2ea5c51351f4b4b27f4f81e078198b55bcd410", "patch": "@@ -3720,10 +3720,12 @@ package body Exp_Ch3 is\n             end if;\n          end if;\n \n+         --  The aspect is type-specific, so retrieve it from the base type.\n+\n          Call :=\n            Make_Procedure_Call_Statement (Loc,\n              Name                   =>\n-               New_Occurrence_Of (Invariant_Procedure (Typ), Loc),\n+               New_Occurrence_Of (Invariant_Procedure (Base_Type (Typ)), Loc),\n              Parameter_Associations => New_List (Sel_Comp));\n \n          if Is_Access_Type (Etype (Comp)) then"}, {"sha": "0e0117af7b40cc1e7d52d9b43bfbdbb6e578ce12", "filename": "gcc/ada/prj-nmsc.adb", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ac2ea5c51351f4b4b27f4f81e078198b55bcd410/gcc%2Fada%2Fprj-nmsc.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ac2ea5c51351f4b4b27f4f81e078198b55bcd410/gcc%2Fada%2Fprj-nmsc.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-nmsc.adb?ref=ac2ea5c51351f4b4b27f4f81e078198b55bcd410", "patch": "@@ -5498,13 +5498,15 @@ package body Prj.Nmsc is\n       Dir_Exists : Boolean;\n \n       No_Sources : constant Boolean :=\n-                     ((not Source_Files.Default\n+                     Project.Qualifier = Abstract_Project\n+                       or else\n+                     (((not Source_Files.Default\n                         and then Source_Files.Values = Nil_String)\n                        or else (not Source_Dirs.Default\n                                  and then Source_Dirs.Values = Nil_String)\n                        or else (not Languages.Default\n                                  and then Languages.Values = Nil_String))\n-                     and then Project.Extends = No_Project;\n+                     and then Project.Extends = No_Project);\n \n    --  Start of processing for Get_Directories\n "}, {"sha": "71442ae7263493ccda2929c9a15b924f018cd485", "filename": "gcc/ada/sem_ch13.adb", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ac2ea5c51351f4b4b27f4f81e078198b55bcd410/gcc%2Fada%2Fsem_ch13.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ac2ea5c51351f4b4b27f4f81e078198b55bcd410/gcc%2Fada%2Fsem_ch13.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch13.adb?ref=ac2ea5c51351f4b4b27f4f81e078198b55bcd410", "patch": "@@ -3903,6 +3903,7 @@ package body Sem_Ch13 is\n \n          if Ctrl = Ent\n            or else Ctrl = Class_Wide_Type (Ent)\n+\n            or else\n              (Ekind (Ctrl) = E_Anonymous_Access_Type\n                and then\n@@ -7393,6 +7394,7 @@ package body Sem_Ch13 is\n           Chars => New_External_Name (Chars (Typ), \"Invariant\"));\n       Set_Has_Invariants (Typ);\n       Set_Ekind (SId, E_Procedure);\n+      Set_Etype (SId, Standard_Void_Type);\n       Set_Is_Invariant_Procedure (SId);\n       Set_Invariant_Procedure (Typ, SId);\n "}, {"sha": "c8d27f1384be6078a860da86a0877e1ce7e82958", "filename": "gcc/ada/sem_ch5.adb", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ac2ea5c51351f4b4b27f4f81e078198b55bcd410/gcc%2Fada%2Fsem_ch5.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ac2ea5c51351f4b4b27f4f81e078198b55bcd410/gcc%2Fada%2Fsem_ch5.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch5.adb?ref=ac2ea5c51351f4b4b27f4f81e078198b55bcd410", "patch": "@@ -1838,6 +1838,17 @@ package body Sem_Ch5 is\n \n             else\n                Typ := Etype (Iter_Name);\n+\n+               --  Verify that the expression produces an iterator.\n+\n+               if not Of_Present (N) and then not Is_Iterator (Typ)\n+                 and then not Is_Array_Type (Typ)\n+                 and then No (Find_Aspect (Typ, Aspect_Iterable))\n+               then\n+                  Error_Msg_N\n+                    (\"expect object that implements iterator interface\",\n+                        Iter_Name);\n+               end if;\n             end if;\n \n             --  Protect against malformed iterator"}, {"sha": "bfbf85893d95f5236d347bb43cd36f14678d1075", "filename": "gcc/ada/sem_ch7.adb", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ac2ea5c51351f4b4b27f4f81e078198b55bcd410/gcc%2Fada%2Fsem_ch7.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ac2ea5c51351f4b4b27f4f81e078198b55bcd410/gcc%2Fada%2Fsem_ch7.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch7.adb?ref=ac2ea5c51351f4b4b27f4f81e078198b55bcd410", "patch": "@@ -1384,7 +1384,11 @@ package body Sem_Ch7 is\n             end if;\n \n             if Has_Invariants (E) then\n-               Build_Invariant_Procedure (E, N);\n+               if Ekind (E) = E_Private_Subtype then\n+                  null;\n+               else\n+                  Build_Invariant_Procedure (E, N);\n+               end if;\n             end if;\n          end if;\n "}]}