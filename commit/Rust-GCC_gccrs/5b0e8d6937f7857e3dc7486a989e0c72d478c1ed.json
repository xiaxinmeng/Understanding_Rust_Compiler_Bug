{"sha": "5b0e8d6937f7857e3dc7486a989e0c72d478c1ed", "node_id": "C_kwDOANBUbNoAKDViMGU4ZDY5MzdmNzg1N2UzZGM3NDg2YTk4OWUwYzcyZDQ3OGMxZWQ", "commit": {"author": {"name": "Arnaud Charlet", "email": "charlet@adacore.com", "date": "2022-04-02T17:29:09Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "derodat@adacore.com", "date": "2022-05-18T08:41:04Z"}, "message": "[Ada] Errors missed on ACATS test B650007\n\nThis ACATS test shows that we need to call Is_Immutably_Limited_Type\nin Analyze_Function_Return and also that we have a latent bug in\nIs_Immutably_Limited_Type which shouldn't look through private types.\n\ngcc/ada/\n\n\t* sem_aux.adb (Is_Immutably_Limited_Type): Do not look through\n\tprivate types as per RM 7.5(8.1).\n\t* sem_ch6.adb (Analyze_Function_Return): Use\n\tIs_Immutably_Limited_Type as per RM 6.5(5.10).", "tree": {"sha": "5d2e8c571c07343ed095719f6f006f1df30177ed", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5d2e8c571c07343ed095719f6f006f1df30177ed"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5b0e8d6937f7857e3dc7486a989e0c72d478c1ed", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5b0e8d6937f7857e3dc7486a989e0c72d478c1ed", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5b0e8d6937f7857e3dc7486a989e0c72d478c1ed", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5b0e8d6937f7857e3dc7486a989e0c72d478c1ed/comments", "author": {"login": "ArnaudCharlet", "id": 30291825, "node_id": "MDQ6VXNlcjMwMjkxODI1", "avatar_url": "https://avatars.githubusercontent.com/u/30291825?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ArnaudCharlet", "html_url": "https://github.com/ArnaudCharlet", "followers_url": "https://api.github.com/users/ArnaudCharlet/followers", "following_url": "https://api.github.com/users/ArnaudCharlet/following{/other_user}", "gists_url": "https://api.github.com/users/ArnaudCharlet/gists{/gist_id}", "starred_url": "https://api.github.com/users/ArnaudCharlet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ArnaudCharlet/subscriptions", "organizations_url": "https://api.github.com/users/ArnaudCharlet/orgs", "repos_url": "https://api.github.com/users/ArnaudCharlet/repos", "events_url": "https://api.github.com/users/ArnaudCharlet/events{/privacy}", "received_events_url": "https://api.github.com/users/ArnaudCharlet/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pmderodat", "id": 758452, "node_id": "MDQ6VXNlcjc1ODQ1Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/758452?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pmderodat", "html_url": "https://github.com/pmderodat", "followers_url": "https://api.github.com/users/pmderodat/followers", "following_url": "https://api.github.com/users/pmderodat/following{/other_user}", "gists_url": "https://api.github.com/users/pmderodat/gists{/gist_id}", "starred_url": "https://api.github.com/users/pmderodat/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pmderodat/subscriptions", "organizations_url": "https://api.github.com/users/pmderodat/orgs", "repos_url": "https://api.github.com/users/pmderodat/repos", "events_url": "https://api.github.com/users/pmderodat/events{/privacy}", "received_events_url": "https://api.github.com/users/pmderodat/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9af8c27f090ae549f43e40cff00a9d702db0ac85", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9af8c27f090ae549f43e40cff00a9d702db0ac85", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9af8c27f090ae549f43e40cff00a9d702db0ac85"}], "stats": {"total": 21, "additions": 7, "deletions": 14}, "files": [{"sha": "43c33b45928dbe170ae145c2b932d07167ddc77c", "filename": "gcc/ada/sem_aux.adb", "status": "modified", "additions": 1, "deletions": 9, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5b0e8d6937f7857e3dc7486a989e0c72d478c1ed/gcc%2Fada%2Fsem_aux.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5b0e8d6937f7857e3dc7486a989e0c72d478c1ed/gcc%2Fada%2Fsem_aux.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_aux.adb?ref=5b0e8d6937f7857e3dc7486a989e0c72d478c1ed", "patch": "@@ -1059,15 +1059,7 @@ package body Sem_Aux is\n             end if;\n \n          else\n-            declare\n-               Utyp : constant Entity_Id := Underlying_Type (Btype);\n-            begin\n-               if No (Utyp) then\n-                  return False;\n-               else\n-                  return Is_Immutably_Limited_Type (Utyp);\n-               end if;\n-            end;\n+            return False;\n          end if;\n \n       elsif Is_Concurrent_Type (Btype) then"}, {"sha": "c9e57e95b10769e89d653d26ae58aefe7ec7eb02", "filename": "gcc/ada/sem_ch6.adb", "status": "modified", "additions": 6, "deletions": 5, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5b0e8d6937f7857e3dc7486a989e0c72d478c1ed/gcc%2Fada%2Fsem_ch6.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5b0e8d6937f7857e3dc7486a989e0c72d478c1ed/gcc%2Fada%2Fsem_ch6.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch6.adb?ref=5b0e8d6937f7857e3dc7486a989e0c72d478c1ed", "patch": "@@ -1566,17 +1566,18 @@ package body Sem_Ch6 is\n \n             --  Check RM 6.5 (5.9/3)\n \n-            if Has_Aliased then\n+            if Has_Aliased and then not Is_Immutably_Limited_Type (R_Type) then\n                if Ada_Version < Ada_2012\n                  and then Warn_On_Ada_2012_Compatibility\n                then\n                   Error_Msg_N\n-                    (\"ALIASED only allowed for limited return objects \"\n-                     & \"in Ada 2012?y?\", N);\n+                    (\"ALIASED only allowed for immutably limited return \" &\n+                     \"objects in Ada 2012?y?\", N);\n \n-               elsif not Is_Limited_View (R_Type) then\n+               else\n                   Error_Msg_N\n-                    (\"ALIASED only allowed for limited return objects\", N);\n+                    (\"ALIASED only allowed for immutably limited return \" &\n+                     \"objects\", N);\n                end if;\n             end if;\n "}]}