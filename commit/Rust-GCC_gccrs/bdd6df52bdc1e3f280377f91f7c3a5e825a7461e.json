{"sha": "bdd6df52bdc1e3f280377f91f7c3a5e825a7461e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmRkNmRmNTJiZGMxZTNmMjgwMzc3ZjkxZjdjM2E1ZTgyNWE3NDYxZQ==", "commit": {"author": {"name": "Danny Smith", "email": "dannysmith@users.sourceforge.net", "date": "2008-02-24T09:19:39Z"}, "committer": {"name": "Danny Smith", "email": "dannysmith@gcc.gnu.org", "date": "2008-02-24T09:19:39Z"}, "message": "re PR c++/34749 (Incorrect warning when applying dllimport to friend function)\n\ncp\n\tPR c++/34749\n\t* friend.c (do_friend): Call cplus_decl_attributes earlier.\n\ntestsuite\n\tPR c++/34749\n\t* g++.dg.ext/dllimport13.C: New test.\n\nFrom-SVN: r132585", "tree": {"sha": "40c61febe42d8e42bc09fb68c73f43dc0b9b2dc6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/40c61febe42d8e42bc09fb68c73f43dc0b9b2dc6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bdd6df52bdc1e3f280377f91f7c3a5e825a7461e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bdd6df52bdc1e3f280377f91f7c3a5e825a7461e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bdd6df52bdc1e3f280377f91f7c3a5e825a7461e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bdd6df52bdc1e3f280377f91f7c3a5e825a7461e/comments", "author": null, "committer": null, "parents": [{"sha": "153fbec8c7fa71a3da7368b8b0640ef910c30063", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/153fbec8c7fa71a3da7368b8b0640ef910c30063", "html_url": "https://github.com/Rust-GCC/gccrs/commit/153fbec8c7fa71a3da7368b8b0640ef910c30063"}], "stats": {"total": 38, "additions": 31, "deletions": 7}, "files": [{"sha": "68f9a7badd100cd2126f85bfcb5bb2d2ba5e3d1f", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bdd6df52bdc1e3f280377f91f7c3a5e825a7461e/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bdd6df52bdc1e3f280377f91f7c3a5e825a7461e/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=bdd6df52bdc1e3f280377f91f7c3a5e825a7461e", "patch": "@@ -1,3 +1,8 @@\n+2008-02-24  Danny Smith  <dannysmith@users.sourceforge.net>\n+\n+\tPR c++/34749\n+\t* friend.c (do_friend): Call cplus_decl_attributes earlier.\n+\n 2008-02-22  Andrew Pinski  <andrew_pinski@playstation.sony.com>\n \n \tPR C++/34715"}, {"sha": "c4dfcc58798ae4decaf977cddd3586b5b6562e53", "filename": "gcc/cp/friend.c", "status": "modified", "additions": 7, "deletions": 7, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bdd6df52bdc1e3f280377f91f7c3a5e825a7461e/gcc%2Fcp%2Ffriend.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bdd6df52bdc1e3f280377f91f7c3a5e825a7461e/gcc%2Fcp%2Ffriend.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ffriend.c?ref=bdd6df52bdc1e3f280377f91f7c3a5e825a7461e", "patch": "@@ -413,6 +413,13 @@ do_friend (tree ctype, tree declarator, tree decl,\n   /* Every decl that gets here is a friend of something.  */\n   DECL_FRIEND_P (decl) = 1;\n \n+  /* Unfortunately, we have to handle attributes here.  Normally we would\n+     handle them in start_decl_1, but since this is a friend decl start_decl_1\n+     never gets to see it.  */\n+\n+  /* Set attributes here so if duplicate decl, will have proper attributes.  */\n+  cplus_decl_attributes (&decl, attrlist, 0);\n+\n   if (TREE_CODE (declarator) == TEMPLATE_ID_EXPR)\n     {\n       declarator = TREE_OPERAND (declarator, 0);\n@@ -582,12 +589,5 @@ do_friend (tree ctype, tree declarator, tree decl,\n       DECL_FRIEND_P (decl) = 1;\n     }\n \n-  /* Unfortunately, we have to handle attributes here.  Normally we would\n-     handle them in start_decl_1, but since this is a friend decl start_decl_1\n-     never gets to see it.  */\n-\n-  /* Set attributes here so if duplicate decl, will have proper attributes.  */\n-  cplus_decl_attributes (&decl, attrlist, 0);\n-\n   return decl;\n }"}, {"sha": "b5f5a89e975e8db80596a41db60d2c249caaa3a1", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bdd6df52bdc1e3f280377f91f7c3a5e825a7461e/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bdd6df52bdc1e3f280377f91f7c3a5e825a7461e/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=bdd6df52bdc1e3f280377f91f7c3a5e825a7461e", "patch": "@@ -1,3 +1,8 @@\n+2008-02-24  Danny Smith  <dannysmith@users.sourceforge.net>\n+\n+\tPR c++/34749\n+\t* g++.dg.ext/dllimport13.C: New test.\n+\n 2008-02-23  Francois-Xavier Coudert  <coudert@clipper.ens.fr>\n \n \tPR libfortran/24685"}, {"sha": "a0d4ab555f944ade0644a1db0ff18619b3e45d09", "filename": "gcc/testsuite/g++.dg/ext/dllimport13.C", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bdd6df52bdc1e3f280377f91f7c3a5e825a7461e/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fdllimport13.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bdd6df52bdc1e3f280377f91f7c3a5e825a7461e/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fdllimport13.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fdllimport13.C?ref=bdd6df52bdc1e3f280377f91f7c3a5e825a7461e", "patch": "@@ -0,0 +1,14 @@\n+//  PR c++/34749\n+//  Ensure dllimport is handled correctly for friends\n+\n+// { dg-do compile { target i?86-*-cygwin* i?86-*-mingw*} }\n+\n+int  __declspec (dllimport) bar();\n+int  __declspec (dllimport) baz();\n+\n+class Foo\n+{\n+//  MS requires that the dllimport attribute be specified on each declaration \n+    friend  int __declspec (dllimport) bar();\n+    friend int  baz();  //  { dg-warning \"dllimport ignored\" }\n+};"}]}