{"sha": "148c744a1789b29b3c3c32b45ea3be913fef6a52", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTQ4Yzc0NGExNzg5YjI5YjNjM2MzMmI0NWVhM2JlOTEzZmVmNmE1Mg==", "commit": {"author": {"name": "Pascal Obry", "email": "obry@adacore.com", "date": "2014-08-01T08:10:34Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2014-08-01T08:10:34Z"}, "message": "adaint.h, adaint.c (__gnat_file_length): Returns an __int64.\n\n2014-08-01  Pascal Obry  <obry@adacore.com>\n\n\t* adaint.h, adaint.c (__gnat_file_length): Returns an __int64.\n\t(__gnat_named_file_length): Likewise.\n\t(__gnat_file_length_attr): Likewise.\n\t* a-direct.adb (C_Size): Use size_t as returned type.\n\t* osint.adb (File_Length): Adjust spec for Internal routine\n\t(returns size_t).\n\t* s-os_lib.adb (File_Length): Now returns a CRTL.size_t.\n\t(System.CRTL): With claused moved to spec.\n\t* s-os_lib.ads (System.CRTL): With clause moved to here.\n\nFrom-SVN: r213412", "tree": {"sha": "6d947b509c5720962bfcba5c62b900bab43882a0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6d947b509c5720962bfcba5c62b900bab43882a0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/148c744a1789b29b3c3c32b45ea3be913fef6a52", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/148c744a1789b29b3c3c32b45ea3be913fef6a52", "html_url": "https://github.com/Rust-GCC/gccrs/commit/148c744a1789b29b3c3c32b45ea3be913fef6a52", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/148c744a1789b29b3c3c32b45ea3be913fef6a52/comments", "author": {"login": "TurboGit", "id": 467069, "node_id": "MDQ6VXNlcjQ2NzA2OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/467069?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TurboGit", "html_url": "https://github.com/TurboGit", "followers_url": "https://api.github.com/users/TurboGit/followers", "following_url": "https://api.github.com/users/TurboGit/following{/other_user}", "gists_url": "https://api.github.com/users/TurboGit/gists{/gist_id}", "starred_url": "https://api.github.com/users/TurboGit/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TurboGit/subscriptions", "organizations_url": "https://api.github.com/users/TurboGit/orgs", "repos_url": "https://api.github.com/users/TurboGit/repos", "events_url": "https://api.github.com/users/TurboGit/events{/privacy}", "received_events_url": "https://api.github.com/users/TurboGit/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "479f90598ae5c20aa042e4700a98f273c8094496", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/479f90598ae5c20aa042e4700a98f273c8094496", "html_url": "https://github.com/Rust-GCC/gccrs/commit/479f90598ae5c20aa042e4700a98f273c8094496"}], "stats": {"total": 42, "additions": 29, "deletions": 13}, "files": [{"sha": "2248f1d8783fd2a3c7bb4a26df14a9b33eeae728", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/148c744a1789b29b3c3c32b45ea3be913fef6a52/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/148c744a1789b29b3c3c32b45ea3be913fef6a52/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=148c744a1789b29b3c3c32b45ea3be913fef6a52", "patch": "@@ -1,3 +1,15 @@\n+2014-08-01  Pascal Obry  <obry@adacore.com>\n+\n+\t* adaint.h, adaint.c (__gnat_file_length): Returns an __int64.\n+\t(__gnat_named_file_length): Likewise.\n+\t(__gnat_file_length_attr): Likewise.\n+\t* a-direct.adb (C_Size): Use size_t as returned type.\n+\t* osint.adb (File_Length): Adjust spec for Internal routine\n+\t(returns size_t).\n+\t* s-os_lib.adb (File_Length): Now returns a CRTL.size_t.\n+\t(System.CRTL): With claused moved to spec.\n+\t* s-os_lib.ads (System.CRTL): With clause moved to here.\n+\n 2014-08-01  Pascal Obry  <obry@adacore.com>\n \n \t* adaint.h, adaint.c (__gnat_open): Added."}, {"sha": "275ad7ad5031501aeb0bf0b15814dfb608831f23", "filename": "gcc/ada/a-direct.adb", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/148c744a1789b29b3c3c32b45ea3be913fef6a52/gcc%2Fada%2Fa-direct.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/148c744a1789b29b3c3c32b45ea3be913fef6a52/gcc%2Fada%2Fa-direct.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fa-direct.adb?ref=148c744a1789b29b3c3c32b45ea3be913fef6a52", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 B o d y                                  --\n --                                                                          --\n---          Copyright (C) 2004-2013, Free Software Foundation, Inc.         --\n+--          Copyright (C) 2004-2014, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -1250,7 +1250,7 @@ package body Ada.Directories is\n    function Size (Name : String) return File_Size is\n       C_Name : String (1 .. Name'Length + 1);\n \n-      function C_Size (Name : Address) return Long_Integer;\n+      function C_Size (Name : Address) return size_t;\n       pragma Import (C, C_Size, \"__gnat_named_file_length\");\n \n    begin"}, {"sha": "e0193afcc34b3755964f11c48abc769fc06227bc", "filename": "gcc/ada/adaint.c", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/148c744a1789b29b3c3c32b45ea3be913fef6a52/gcc%2Fada%2Fadaint.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/148c744a1789b29b3c3c32b45ea3be913fef6a52/gcc%2Fada%2Fadaint.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fadaint.c?ref=148c744a1789b29b3c3c32b45ea3be913fef6a52", "patch": "@@ -1308,7 +1308,7 @@ __gnat_stat_to_attr (int fd, char* name, struct file_attributes* attr)\n  ** Return the number of bytes in the specified file\n  ****************************************************************/\n \n-long\n+__int64\n __gnat_file_length_attr (int fd, char* name, struct file_attributes* attr)\n {\n   if (attr->file_length == -1) {\n@@ -1318,15 +1318,15 @@ __gnat_file_length_attr (int fd, char* name, struct file_attributes* attr)\n   return attr->file_length;\n }\n \n-long\n+__int64\n __gnat_file_length (int fd)\n {\n   struct file_attributes attr;\n   __gnat_reset_attributes (&attr);\n   return __gnat_file_length_attr (fd, NULL, &attr);\n }\n \n-long\n+__int64\n __gnat_named_file_length (char *name)\n {\n   struct file_attributes attr;"}, {"sha": "9b6bbca4e521256e061668314959efe229dfac01", "filename": "gcc/ada/adaint.h", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/148c744a1789b29b3c3c32b45ea3be913fef6a52/gcc%2Fada%2Fadaint.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/148c744a1789b29b3c3c32b45ea3be913fef6a52/gcc%2Fada%2Fadaint.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fadaint.h?ref=148c744a1789b29b3c3c32b45ea3be913fef6a52", "patch": "@@ -98,7 +98,7 @@ struct file_attributes {\n   unsigned char directory;\n \n   OS_Time timestamp;\n-  long file_length;\n+  __int64 file_length;\n };\n /* WARNING: changing the size here might require changing the constant\n  * File_Attributes_Size in osint.ads (which should be big enough to\n@@ -151,8 +151,8 @@ extern int    __gnat_create_output_file            (char *);\n extern int    __gnat_create_output_file_new        (char *);\n \n extern int    __gnat_open_append                   (char *, int);\n-extern long   __gnat_file_length                   (int);\n-extern long   __gnat_named_file_length             (char *);\n+extern __int64 __gnat_file_length                  (int);\n+extern __int64 __gnat_named_file_length            (char *);\n extern void   __gnat_tmp_name\t\t\t   (char *);\n extern DIR   *__gnat_opendir                       (char *);\n extern char  *__gnat_readdir                       (DIR *, char *, int *);\n@@ -177,7 +177,7 @@ extern int    __gnat_is_executable_file      (char *name);\n \n extern void   __gnat_reset_attributes (struct file_attributes *);\n extern int    __gnat_error_attributes (struct file_attributes *);\n-extern long   __gnat_file_length_attr        (int, char *, struct file_attributes *);\n+extern __int64 __gnat_file_length_attr       (int, char *, struct file_attributes *);\n extern OS_Time __gnat_file_time_name_attr    (char *, struct file_attributes *);\n extern OS_Time __gnat_file_time_fd_attr      (int,    struct file_attributes *);\n extern int    __gnat_file_exists_attr        (char *, struct file_attributes *);"}, {"sha": "159501de777b3fe604d30f93ed0a196d0755a8f1", "filename": "gcc/ada/osint.adb", "status": "modified", "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/148c744a1789b29b3c3c32b45ea3be913fef6a52/gcc%2Fada%2Fosint.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/148c744a1789b29b3c3c32b45ea3be913fef6a52/gcc%2Fada%2Fosint.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fosint.adb?ref=148c744a1789b29b3c3c32b45ea3be913fef6a52", "patch": "@@ -1076,10 +1076,13 @@ package body Osint is\n       function Internal\n         (F : Integer;\n          N : C_File_Name;\n-         A : System.Address) return Long_Integer;\n+         A : System.Address) return size_t;\n       pragma Import (C, Internal, \"__gnat_file_length_attr\");\n    begin\n-      return Internal (-1, Name, Attr.all'Address);\n+      --  The conversion from size_t to Long_Integer is ok here as this\n+      --  routine is only to be used by the compiler and we do not expect\n+      --  a unit to be larger than a 32bit integer.\n+      return Long_Integer (Internal (-1, Name, Attr.all'Address));\n    end File_Length;\n \n    ---------------------"}, {"sha": "eacc8968750dfee9be4400ff8df748715aff6f27", "filename": "gcc/ada/s-os_lib.adb", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/148c744a1789b29b3c3c32b45ea3be913fef6a52/gcc%2Fada%2Fs-os_lib.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/148c744a1789b29b3c3c32b45ea3be913fef6a52/gcc%2Fada%2Fs-os_lib.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fs-os_lib.adb?ref=148c744a1789b29b3c3c32b45ea3be913fef6a52", "patch": "@@ -35,7 +35,6 @@ with Ada.Unchecked_Conversion;\n with Ada.Unchecked_Deallocation;\n with System; use System;\n with System.Case_Util;\n-with System.CRTL;\n with System.Soft_Links;\n \n package body System.OS_Lib is"}, {"sha": "7c474007378fd425e7009bfc6ccc433f73038e8a", "filename": "gcc/ada/s-os_lib.ads", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/148c744a1789b29b3c3c32b45ea3be913fef6a52/gcc%2Fada%2Fs-os_lib.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/148c744a1789b29b3c3c32b45ea3be913fef6a52/gcc%2Fada%2Fs-os_lib.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fs-os_lib.ads?ref=148c744a1789b29b3c3c32b45ea3be913fef6a52", "patch": "@@ -56,6 +56,8 @@ pragma Compiler_Unit_Warning;\n with System;\n with System.Strings;\n \n+with System.CRTL;\n+\n package System.OS_Lib is\n    pragma Preelaborate;\n \n@@ -432,7 +434,7 @@ package System.OS_Lib is\n    --  to the current position (origin = SEEK_CUR), end of file (origin =\n    --  SEEK_END), or start of file (origin = SEEK_SET).\n \n-   function File_Length (FD : File_Descriptor) return Long_Integer;\n+   function File_Length (FD : File_Descriptor) return CRTL.size_t;\n    pragma Import (C, File_Length, \"__gnat_file_length\");\n    --  Get length of file from file descriptor FD\n "}]}