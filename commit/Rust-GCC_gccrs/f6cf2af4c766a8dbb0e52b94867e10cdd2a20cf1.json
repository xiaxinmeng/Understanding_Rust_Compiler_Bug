{"sha": "f6cf2af4c766a8dbb0e52b94867e10cdd2a20cf1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjZjZjJhZjRjNzY2YThkYmIwZTUyYjk0ODY3ZTEwY2RkMmEyMGNmMQ==", "commit": {"author": {"name": "Vincent Celier", "email": "celier@adacore.com", "date": "2006-10-31T18:02:17Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2006-10-31T18:02:17Z"}, "message": "mlib-utl.adb (Initialized): Remove, no longer used\n\n2006-10-31  Vincent Celier  <celier@adacore.com>\n\n\t* mlib-utl.adb (Initialized): Remove, no longer used\n\t(Initialize): Remove, no longer used\n\t(Ar): If Ar_Exec is null, get the location of the archive builder and,\n\tif there is one, the archive indexer. Fail if the archive builder cannot\n\tbe found.\n\t(Gcc): If the driver path is unknown, get it. Fail if the driver cannot\n\tbe found.\n\nFrom-SVN: r118286", "tree": {"sha": "55ae9179b7d51cddc2f0c5d1b12fb1c8ed02bf2f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/55ae9179b7d51cddc2f0c5d1b12fb1c8ed02bf2f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f6cf2af4c766a8dbb0e52b94867e10cdd2a20cf1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f6cf2af4c766a8dbb0e52b94867e10cdd2a20cf1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f6cf2af4c766a8dbb0e52b94867e10cdd2a20cf1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f6cf2af4c766a8dbb0e52b94867e10cdd2a20cf1/comments", "author": {"login": "vcelier", "id": 8888056, "node_id": "MDQ6VXNlcjg4ODgwNTY=", "avatar_url": "https://avatars.githubusercontent.com/u/8888056?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vcelier", "html_url": "https://github.com/vcelier", "followers_url": "https://api.github.com/users/vcelier/followers", "following_url": "https://api.github.com/users/vcelier/following{/other_user}", "gists_url": "https://api.github.com/users/vcelier/gists{/gist_id}", "starred_url": "https://api.github.com/users/vcelier/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vcelier/subscriptions", "organizations_url": "https://api.github.com/users/vcelier/orgs", "repos_url": "https://api.github.com/users/vcelier/repos", "events_url": "https://api.github.com/users/vcelier/events{/privacy}", "received_events_url": "https://api.github.com/users/vcelier/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "b8783398c18321947a868ad9e6e2b408a91b77db", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b8783398c18321947a868ad9e6e2b408a91b77db", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b8783398c18321947a868ad9e6e2b408a91b77db"}], "stats": {"total": 110, "additions": 49, "deletions": 61}, "files": [{"sha": "821bfa981fb1d082c1afe75950b138b50c8ec39c", "filename": "gcc/ada/mlib-utl.adb", "status": "modified", "additions": 49, "deletions": 61, "changes": 110, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f6cf2af4c766a8dbb0e52b94867e10cdd2a20cf1/gcc%2Fada%2Fmlib-utl.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f6cf2af4c766a8dbb0e52b94867e10cdd2a20cf1/gcc%2Fada%2Fmlib-utl.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fmlib-utl.adb?ref=f6cf2af4c766a8dbb0e52b94867e10cdd2a20cf1", "patch": "@@ -36,8 +36,6 @@ with GNAT;     use GNAT;\n \n package body MLib.Utl is\n \n-   Initialized : Boolean := False;\n-\n    Gcc_Name : constant String := Osint.Program_Name (\"gcc\").all;\n    Gcc_Exec : OS_Lib.String_Access;\n \n@@ -49,9 +47,6 @@ package body MLib.Utl is\n    Ranlib_Exec    : OS_Lib.String_Access := null;\n    Ranlib_Options : OS_Lib.String_List_Access := null;\n \n-   procedure Initialize;\n-   --  Look for the tools in the path and record the full path for each one\n-\n    --------\n    -- Ar --\n    --------\n@@ -65,7 +60,47 @@ package body MLib.Utl is\n       Line_Length : Natural := 0;\n \n    begin\n-      Utl.Initialize;\n+      if Ar_Exec = null then\n+         Ar_Name := Osint.Program_Name (Archive_Builder);\n+         Ar_Exec := OS_Lib.Locate_Exec_On_Path (Ar_Name.all);\n+\n+         if Ar_Exec = null then\n+            Free (Ar_Name);\n+            Ar_Name := new String'(Archive_Builder);\n+            Ar_Exec := OS_Lib.Locate_Exec_On_Path (Ar_Name.all);\n+         end if;\n+\n+         if Ar_Exec = null then\n+            Fail (Ar_Name.all, \" not found in path\");\n+\n+         elsif Opt.Verbose_Mode then\n+            Write_Str  (\"found \");\n+            Write_Line (Ar_Exec.all);\n+         end if;\n+\n+         Ar_Options := Archive_Builder_Options;\n+\n+         --  ranlib\n+\n+         Ranlib_Name := Osint.Program_Name (Archive_Indexer);\n+\n+         if Ranlib_Name'Length > 0 then\n+            Ranlib_Exec := OS_Lib.Locate_Exec_On_Path (Ranlib_Name.all);\n+\n+            if Ranlib_Exec = null then\n+               Free (Ranlib_Name);\n+               Ranlib_Name := new String'(Archive_Indexer);\n+               Ranlib_Exec := OS_Lib.Locate_Exec_On_Path (Ranlib_Name.all);\n+            end if;\n+\n+            if Ranlib_Exec /= null and then Opt.Verbose_Mode then\n+               Write_Str (\"found \");\n+               Write_Line (Ranlib_Exec.all);\n+            end if;\n+         end if;\n+\n+         Ranlib_Options := Archive_Indexer_Options;\n+      end if;\n \n       Arguments :=\n         new String_List (1 .. 1 + Ar_Options'Length + Objects'Length);\n@@ -175,9 +210,15 @@ package body MLib.Utl is\n       Driver    : String_Access;\n \n    begin\n-      Utl.Initialize;\n-\n       if Driver_Name = No_Name then\n+         if Gcc_Exec = null then\n+            Gcc_Exec := OS_Lib.Locate_Exec_On_Path (Gcc_Name);\n+\n+            if Gcc_Exec = null then\n+               Fail (Gcc_Name, \" not found in path\");\n+            end if;\n+         end if;\n+\n          Driver := Gcc_Exec;\n \n       else\n@@ -234,59 +275,6 @@ package body MLib.Utl is\n       end if;\n    end Gcc;\n \n-   ----------------\n-   -- Initialize --\n-   ----------------\n-\n-   procedure Initialize is\n-   begin\n-      if not Initialized then\n-         Initialized := True;\n-\n-         --  gcc\n-\n-         Gcc_Exec := OS_Lib.Locate_Exec_On_Path (Gcc_Name);\n-\n-         if Gcc_Exec = null then\n-            Fail (Gcc_Name, \" not found in path\");\n-\n-         elsif Opt.Verbose_Mode then\n-            Write_Str  (\"found \");\n-            Write_Line (Gcc_Exec.all);\n-         end if;\n-\n-         --  ar\n-\n-         Ar_Name := Osint.Program_Name (Archive_Builder);\n-         Ar_Exec := OS_Lib.Locate_Exec_On_Path (Ar_Name.all);\n-\n-         if Ar_Exec = null then\n-            Fail (Ar_Name.all, \" not found in path\");\n-\n-         elsif Opt.Verbose_Mode then\n-            Write_Str  (\"found \");\n-            Write_Line (Ar_Exec.all);\n-         end if;\n-\n-         Ar_Options := Archive_Builder_Options;\n-\n-         --  ranlib\n-\n-         Ranlib_Name := Osint.Program_Name (Archive_Indexer);\n-\n-         if Ranlib_Name'Length > 0 then\n-            Ranlib_Exec := OS_Lib.Locate_Exec_On_Path (Ranlib_Name.all);\n-\n-            if Ranlib_Exec /= null and then Opt.Verbose_Mode then\n-               Write_Str (\"found \");\n-               Write_Line (Ranlib_Exec.all);\n-            end if;\n-         end if;\n-\n-         Ranlib_Options := Archive_Indexer_Options;\n-      end if;\n-   end Initialize;\n-\n    -------------------\n    -- Lib_Directory --\n    -------------------"}]}