{"sha": "42e0278a47a5d9a6f826ed62c155f12f002ce6bc", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDJlMDI3OGE0N2E1ZDlhNmY4MjZlZDYyYzE1NWYxMmYwMDJjZTZiYw==", "commit": {"author": {"name": "Tom Wood", "email": "wood@gnu.org", "date": "1992-10-22T10:03:47Z"}, "committer": {"name": "Tom Wood", "email": "wood@gnu.org", "date": "1992-10-22T10:03:47Z"}, "message": "(prologue_marked): New variable.\n\n\t(m88k_end_prologue): Output the epilogue mark here if the start of\n\tthe epilogue passed the end of the prologue.\n\t(m88k_begin_epilogue): Don't output the epilogue mark if the end\n\tof the prologue hasn't been processed yet.\n\nFrom-SVN: r2549", "tree": {"sha": "2a06a3332970a7b2ed680cdf86a03c36a05fca0e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2a06a3332970a7b2ed680cdf86a03c36a05fca0e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/42e0278a47a5d9a6f826ed62c155f12f002ce6bc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/42e0278a47a5d9a6f826ed62c155f12f002ce6bc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/42e0278a47a5d9a6f826ed62c155f12f002ce6bc", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/42e0278a47a5d9a6f826ed62c155f12f002ce6bc/comments", "author": null, "committer": null, "parents": [{"sha": "63d415c0deacd98d6e5d771af8d80ca99baf1743", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/63d415c0deacd98d6e5d771af8d80ca99baf1743", "html_url": "https://github.com/Rust-GCC/gccrs/commit/63d415c0deacd98d6e5d771af8d80ca99baf1743"}], "stats": {"total": 35, "additions": 26, "deletions": 9}, "files": [{"sha": "19a36e0b7cf1bd78ca0318569c72a98c88798a95", "filename": "gcc/config/m88k/m88k.c", "status": "modified", "additions": 26, "deletions": 9, "changes": 35, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/42e0278a47a5d9a6f826ed62c155f12f002ce6bc/gcc%2Fconfig%2Fm88k%2Fm88k.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/42e0278a47a5d9a6f826ed62c155f12f002ce6bc/gcc%2Fconfig%2Fm88k%2Fm88k.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fm88k%2Fm88k.c?ref=42e0278a47a5d9a6f826ed62c155f12f002ce6bc", "patch": "@@ -47,7 +47,7 @@ extern char *ctime ();\n extern int flag_traditional;\n extern FILE *asm_out_file;\n \n-static char out_sccs_id[] = \"@(#)m88k.c\t2.2.13.5 10/19/92 15:27:15\";\n+static char out_sccs_id[] = \"@(#)m88k.c\t2.2.13.6 10/21/92 12:41:48\";\n static char tm_sccs_id [] = TM_SCCS_ID;\n \n char *m88k_pound_sign = \"\";\t/* Either # for SVR4 or empty for SVR3 */\n@@ -1678,6 +1678,7 @@ static int  frame_laid_out;\n static int  frame_size;\n static int  variable_args_p;\n static int  epilogue_marked;\n+static int  prologue_marked;\n \n extern char call_used_regs[];\n extern int  current_function_pretend_args_size;\n@@ -1854,19 +1855,30 @@ m88k_begin_prologue (stream, size)\n      FILE *stream;\n      int size;\n {\n-  epilogue_marked = 0;\n   m88k_prologue_done = 1;\t/* it's ok now to put out ln directives */\n }\n \n void\n m88k_end_prologue (stream)\n      FILE *stream;\n {\n-  if (TARGET_OCS_DEBUG_INFO)\n-    PUT_OCS_FUNCTION_START (stream);\n-  if (epilogue_marked)\n-    abort ();\n-  frame_laid_out = 0;\n+  if (TARGET_OCS_DEBUG_INFO && !prologue_marked)\n+    {\n+      PUT_OCS_FUNCTION_START (stream);\n+      prologue_marked = 1;\n+\n+      /* If we've already passed the start of the epilogue, say that\n+\t it starts here.  This marks the function as having a null body,\n+\t but at a point where the return address is in a known location.\n+\n+\t Originally, I thought this couldn't happen, but the pic prologue\n+\t for leaf functions ends with the instruction that restores the\n+\t return address from the temporary register.  If the temporary\n+\t register is never used, that instruction can float all the way\n+\t to the end of the function.  */\n+      if (epilogue_marked)\n+\tPUT_OCS_FUNCTION_END (stream);\n+    }\n }\n \n void\n@@ -1927,8 +1939,10 @@ void\n m88k_begin_epilogue (stream)\n      FILE *stream;\n {\n-  if (TARGET_OCS_DEBUG_INFO)\n-    PUT_OCS_FUNCTION_END (stream);\n+  if (TARGET_OCS_DEBUG_INFO && !epilogue_marked && prologue_marked)\n+    {\n+      PUT_OCS_FUNCTION_END (stream);\n+    }\n   epilogue_marked = 1;\n }\n \n@@ -1959,6 +1973,9 @@ m88k_end_epilogue (stream, size)\n   m88k_function_number++;\n   m88k_prologue_done\t= 0;\t\t/* don't put out ln directives */\n   variable_args_p\t= 0;\t\t/* has variable args */\n+  frame_laid_out\t= 0;\n+  epilogue_marked\t= 0;\n+  prologue_marked\t= 0;\n }\n \n void"}]}