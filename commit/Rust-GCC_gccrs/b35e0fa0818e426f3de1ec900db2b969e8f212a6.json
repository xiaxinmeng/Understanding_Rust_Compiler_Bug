{"sha": "b35e0fa0818e426f3de1ec900db2b969e8f212a6", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjM1ZTBmYTA4MThlNDI2ZjNkZTFlYzkwMGRiMmI5NjllOGYyMTJhNg==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2014-03-22T07:18:38Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2014-03-22T07:18:38Z"}, "message": "re PR debug/60603 (.debug_macinfo/.debug_macro has wrong line numbers for built-in macros)\n\n\tPR debug/60603\nc-family/\n\t* c-opts.c (c_finish_options): Restore cb_file_change call to\n\t<built-in>.\nfortran/\n\t* cpp.c (gfc_cpp_init): Restore cb_change_file call to\n\t<built-in>.\ntestsuite/\n\t* gcc.dg/debug/dwarf2/dwarf2-macro2.c: New test.\n\nFrom-SVN: r208763", "tree": {"sha": "d27174ed6e79ae0b0010eaf708bb6fbc53a18b8d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d27174ed6e79ae0b0010eaf708bb6fbc53a18b8d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b35e0fa0818e426f3de1ec900db2b969e8f212a6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b35e0fa0818e426f3de1ec900db2b969e8f212a6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b35e0fa0818e426f3de1ec900db2b969e8f212a6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b35e0fa0818e426f3de1ec900db2b969e8f212a6/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "e10bd1cacc141e20f78ead2a0f07c009d95ba4c3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e10bd1cacc141e20f78ead2a0f07c009d95ba4c3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e10bd1cacc141e20f78ead2a0f07c009d95ba4c3"}], "stats": {"total": 44, "additions": 35, "deletions": 9}, "files": [{"sha": "536b4fc4ca2566d194282470384639ab8ba37b1c", "filename": "gcc/c-family/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b35e0fa0818e426f3de1ec900db2b969e8f212a6/gcc%2Fc-family%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b35e0fa0818e426f3de1ec900db2b969e8f212a6/gcc%2Fc-family%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2FChangeLog?ref=b35e0fa0818e426f3de1ec900db2b969e8f212a6", "patch": "@@ -1,3 +1,9 @@\n+2014-03-22  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR debug/60603\n+\t* c-opts.c (c_finish_options): Restore cb_file_change call to\n+\t<built-in>.\n+\n 2014-03-13  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR middle-end/36282"}, {"sha": "e162e49a18a8bb6275e49caabc268a051f2d106d", "filename": "gcc/c-family/c-opts.c", "status": "modified", "additions": 10, "deletions": 9, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b35e0fa0818e426f3de1ec900db2b969e8f212a6/gcc%2Fc-family%2Fc-opts.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b35e0fa0818e426f3de1ec900db2b969e8f212a6/gcc%2Fc-family%2Fc-opts.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2Fc-opts.c?ref=b35e0fa0818e426f3de1ec900db2b969e8f212a6", "patch": "@@ -1274,17 +1274,18 @@ c_finish_options (void)\n     {\n       size_t i;\n \n-      {\n-\t/* Make sure all of the builtins about to be declared have\n-\t  BUILTINS_LOCATION has their source_location.  */\n-\tsource_location builtins_loc = BUILTINS_LOCATION;\n-\tcpp_force_token_locations (parse_in, &builtins_loc);\n+      cb_file_change (parse_in,\n+\t\t      linemap_add (line_table, LC_RENAME, 0,\n+\t\t\t\t   _(\"<built-in>\"), 0));\n+      /* Make sure all of the builtins about to be declared have\n+\t BUILTINS_LOCATION has their source_location.  */\n+      source_location builtins_loc = BUILTINS_LOCATION;\n+      cpp_force_token_locations (parse_in, &builtins_loc);\n \n-\tcpp_init_builtins (parse_in, flag_hosted);\n-\tc_cpp_builtins (parse_in);\n+      cpp_init_builtins (parse_in, flag_hosted);\n+      c_cpp_builtins (parse_in);\n \n-\tcpp_stop_forcing_token_locations (parse_in);\n-      }\n+      cpp_stop_forcing_token_locations (parse_in);\n \n       /* We're about to send user input to cpplib, so make it warn for\n \t things that we previously (when we sent it internal definitions)"}, {"sha": "3e4d08d68c08b5096ce74085a7300e0ac47cd9fb", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b35e0fa0818e426f3de1ec900db2b969e8f212a6/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b35e0fa0818e426f3de1ec900db2b969e8f212a6/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=b35e0fa0818e426f3de1ec900db2b969e8f212a6", "patch": "@@ -1,3 +1,9 @@\n+2014-03-22  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR debug/60603\n+\t* cpp.c (gfc_cpp_init): Restore cb_change_file call to\n+\t<built-in>.\n+\n 2014-03-21  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n \n \tPR fortran/60148"}, {"sha": "169599003db400ff2e36d094db324b4fb0bc5ca5", "filename": "gcc/fortran/cpp.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b35e0fa0818e426f3de1ec900db2b969e8f212a6/gcc%2Ffortran%2Fcpp.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b35e0fa0818e426f3de1ec900db2b969e8f212a6/gcc%2Ffortran%2Fcpp.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fcpp.c?ref=b35e0fa0818e426f3de1ec900db2b969e8f212a6", "patch": "@@ -576,6 +576,7 @@ gfc_cpp_init (void)\n   if (gfc_option.flag_preprocessed)\n     return;\n \n+  cpp_change_file (cpp_in, LC_RENAME, _(\"<built-in>\"));\n   if (!gfc_cpp_option.no_predefined)\n     {\n       /* Make sure all of the builtins about to be declared have"}, {"sha": "3b22af8d9d977531516a25ee236e4dfcedfbf21f", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b35e0fa0818e426f3de1ec900db2b969e8f212a6/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b35e0fa0818e426f3de1ec900db2b969e8f212a6/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=b35e0fa0818e426f3de1ec900db2b969e8f212a6", "patch": "@@ -1,3 +1,8 @@\n+2014-03-22  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR debug/60603\n+\t* gcc.dg/debug/dwarf2/dwarf2-macro2.c: New test.\n+\n 2014-03-21  Paolo Carlini  <paolo.carlini@oracle.com>\n \n \t* g++.dg/cpp1y/pr60033.C: Use target c++1y."}, {"sha": "3dfa2908ef364756f523bc896355df088bdba628", "filename": "gcc/testsuite/gcc.dg/debug/dwarf2/dwarf2-macro2.c", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b35e0fa0818e426f3de1ec900db2b969e8f212a6/gcc%2Ftestsuite%2Fgcc.dg%2Fdebug%2Fdwarf2%2Fdwarf2-macro2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b35e0fa0818e426f3de1ec900db2b969e8f212a6/gcc%2Ftestsuite%2Fgcc.dg%2Fdebug%2Fdwarf2%2Fdwarf2-macro2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fdebug%2Fdwarf2%2Fdwarf2-macro2.c?ref=b35e0fa0818e426f3de1ec900db2b969e8f212a6", "patch": "@@ -0,0 +1,7 @@\n+/* Test to make sure the macro info includes the predefined macros with line number 0.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-g3 -gdwarf -dA -fverbose-asm\" } */\n+/* { dg-final { scan-assembler \"At line number 0\" } } */\n+\n+#define FOO 1\n+int i;"}]}