{"sha": "a48ebf39c9ff4310332dd9f2ea84f2992d7c9076", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTQ4ZWJmMzljOWZmNDMxMDMzMmRkOWYyZWE4NGYyOTkyZDdjOTA3Ng==", "commit": {"author": {"name": "Francois-Xavier Coudert", "email": "fxcoudert@gcc.gnu.org", "date": "2007-11-17T00:10:00Z"}, "committer": {"name": "Fran\u00e7ois-Xavier Coudert", "email": "fxcoudert@gcc.gnu.org", "date": "2007-11-17T00:10:00Z"}, "message": "re PR fortran/34108 (ICE: Segmentation fault occurs by \"write(*,0)\" statement)\n\n        PR fortran/34108\n\n        * io.c (check_format_string): Only check character expressions.\n        (match_dt_format): Return MATCH_ERROR if that is what\n        gfc_match_st_label said.\n\n        * gfortran.dg/fmt_label_1.f90: New test.\n\nFrom-SVN: r130249", "tree": {"sha": "e39dc3e0dc7b62e6ca0d7390fcbbeac8a70a3e01", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e39dc3e0dc7b62e6ca0d7390fcbbeac8a70a3e01"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a48ebf39c9ff4310332dd9f2ea84f2992d7c9076", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a48ebf39c9ff4310332dd9f2ea84f2992d7c9076", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a48ebf39c9ff4310332dd9f2ea84f2992d7c9076", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a48ebf39c9ff4310332dd9f2ea84f2992d7c9076/comments", "author": {"login": "fxcoudert", "id": 1980544, "node_id": "MDQ6VXNlcjE5ODA1NDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1980544?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fxcoudert", "html_url": "https://github.com/fxcoudert", "followers_url": "https://api.github.com/users/fxcoudert/followers", "following_url": "https://api.github.com/users/fxcoudert/following{/other_user}", "gists_url": "https://api.github.com/users/fxcoudert/gists{/gist_id}", "starred_url": "https://api.github.com/users/fxcoudert/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fxcoudert/subscriptions", "organizations_url": "https://api.github.com/users/fxcoudert/orgs", "repos_url": "https://api.github.com/users/fxcoudert/repos", "events_url": "https://api.github.com/users/fxcoudert/events{/privacy}", "received_events_url": "https://api.github.com/users/fxcoudert/received_events", "type": "User", "site_admin": false}, "committer": {"login": "fxcoudert", "id": 1980544, "node_id": "MDQ6VXNlcjE5ODA1NDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1980544?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fxcoudert", "html_url": "https://github.com/fxcoudert", "followers_url": "https://api.github.com/users/fxcoudert/followers", "following_url": "https://api.github.com/users/fxcoudert/following{/other_user}", "gists_url": "https://api.github.com/users/fxcoudert/gists{/gist_id}", "starred_url": "https://api.github.com/users/fxcoudert/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fxcoudert/subscriptions", "organizations_url": "https://api.github.com/users/fxcoudert/orgs", "repos_url": "https://api.github.com/users/fxcoudert/repos", "events_url": "https://api.github.com/users/fxcoudert/events{/privacy}", "received_events_url": "https://api.github.com/users/fxcoudert/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "de03de6403a9d483644f3549071bdf3be9a1043b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/de03de6403a9d483644f3549071bdf3be9a1043b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/de03de6403a9d483644f3549071bdf3be9a1043b"}], "stats": {"total": 28, "additions": 26, "deletions": 2}, "files": [{"sha": "0d343eb71289a9bf60ab1269a301e1d74d733ded", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a48ebf39c9ff4310332dd9f2ea84f2992d7c9076/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a48ebf39c9ff4310332dd9f2ea84f2992d7c9076/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=a48ebf39c9ff4310332dd9f2ea84f2992d7c9076", "patch": "@@ -1,3 +1,10 @@\n+2007-11-17  Francois-Xavier Coudert  <fxcoudert@gcc.gnu.org>\n+\n+\tPR fortran/34108\n+\t* io.c (check_format_string): Only check character expressions.\n+\t(match_dt_format): Return MATCH_ERROR if that is what\n+\tgfc_match_st_label said.\n+\n 2007-11-16  Francois-Xavier Coudert  <fxcoudert@gcc.gnu.org>\n \n \tPR fortran/33957"}, {"sha": "bb4295b866af1942def0501142b696c0edf3699a", "filename": "gcc/fortran/io.c", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a48ebf39c9ff4310332dd9f2ea84f2992d7c9076/gcc%2Ffortran%2Fio.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a48ebf39c9ff4310332dd9f2ea84f2992d7c9076/gcc%2Ffortran%2Fio.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fio.c?ref=a48ebf39c9ff4310332dd9f2ea84f2992d7c9076", "patch": "@@ -919,7 +919,7 @@ check_format (bool is_input)\n static try\n check_format_string (gfc_expr *e, bool is_input)\n {\n-  if (!e || e->expr_type != EXPR_CONSTANT)\n+  if (!e || e->ts.type != BT_CHARACTER || e->expr_type != EXPR_CONSTANT)\n     return SUCCESS;\n \n   mode = MODE_STRING;\n@@ -2082,6 +2082,7 @@ match_dt_format (gfc_dt *dt)\n   locus where;\n   gfc_expr *e;\n   gfc_st_label *label;\n+  match m;\n \n   where = gfc_current_locus;\n \n@@ -2094,7 +2095,7 @@ match_dt_format (gfc_dt *dt)\n       return MATCH_YES;\n     }\n \n-  if (gfc_match_st_label (&label) == MATCH_YES)\n+  if ((m = gfc_match_st_label (&label)) == MATCH_YES)\n     {\n       if (dt->format_expr != NULL || dt->format_label != NULL)\n \t{\n@@ -2108,6 +2109,9 @@ match_dt_format (gfc_dt *dt)\n       dt->format_label = label;\n       return MATCH_YES;\n     }\n+  else if (m == MATCH_ERROR)\n+    /* The label was zero or too large.  Emit the correct diagnosis.  */\n+    return MATCH_ERROR;\n \n   if (gfc_match_expr (&e) == MATCH_YES)\n     {"}, {"sha": "bec1ea53bcdf3171c7241e5d2969bd8d464a394e", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a48ebf39c9ff4310332dd9f2ea84f2992d7c9076/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a48ebf39c9ff4310332dd9f2ea84f2992d7c9076/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=a48ebf39c9ff4310332dd9f2ea84f2992d7c9076", "patch": "@@ -1,3 +1,8 @@\n+2007-11-17  Francois-Xavier Coudert  <fxcoudert@gcc.gnu.org>\n+\n+\tPR fortran/34108\n+\t* gfortran.dg/fmt_label_1.f90: New test.\n+\n 2007-11-16  Francois-Xavier Coudert  <fxcoudert@gcc.gnu.org>\n \n \tPR fortran/33957"}, {"sha": "eb11b790d2f23c222a4abd93ee8f9a608d730f4a", "filename": "gcc/testsuite/gfortran.dg/fmt_label_1.f90", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a48ebf39c9ff4310332dd9f2ea84f2992d7c9076/gcc%2Ftestsuite%2Fgfortran.dg%2Ffmt_label_1.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a48ebf39c9ff4310332dd9f2ea84f2992d7c9076/gcc%2Ftestsuite%2Fgfortran.dg%2Ffmt_label_1.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Ffmt_label_1.f90?ref=a48ebf39c9ff4310332dd9f2ea84f2992d7c9076", "patch": "@@ -0,0 +1,8 @@\n+! { dg-do compile }\n+!\n+! Check for diagnostics (PR 34108)\n+  write (*,0) 'xxx' ! { dg-error \"Statement label .* is zero\" }\n+  write (*,1) 'xxx' ! { dg-error \"FORMAT label .* not defined\" }\n+  write (*,123456) 'xxx' ! { dg-error \"Too many digits in statement label\" }\n+  write (*,-1) 'xxx' ! { dg-error \"\" }\n+  end"}]}