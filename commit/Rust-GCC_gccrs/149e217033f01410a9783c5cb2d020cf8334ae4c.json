{"sha": "149e217033f01410a9783c5cb2d020cf8334ae4c", "node_id": "C_kwDOANBUbNoAKDE0OWUyMTcwMzNmMDE0MTBhOTc4M2M1Y2IyZDAyMGNmODMzNGFlNGM", "commit": {"author": {"name": "Kito Cheng", "email": "kito.cheng@sifive.com", "date": "2021-08-23T03:19:52Z"}, "committer": {"name": "Kito Cheng", "email": "kito.cheng@sifive.com", "date": "2021-10-25T09:04:17Z"}, "message": "RISC-V: Minimal support of bitmanip extension\n\n2021-10-25  Kito Cheng  <kito.cheng@sifive.com>\n\ngcc/ChangeLog:\n\n\t* common/config/riscv/riscv-common.c (riscv_ext_version_table):\n\tAdd zba, zbb, zbc and zbs.\n\t(riscv_ext_flag_table): Ditto.\n\t* config/riscv/riscv-opts.h (MASK_ZBA): New.\n\t(MASK_ZBB): Ditto.\n\t(MASK_ZBC): Ditto.\n\t(MASK_ZBS): Ditto.\n\t(TARGET_ZBA): Ditto.\n\t(TARGET_ZBB): Ditto.\n\t(TARGET_ZBC): Ditto.\n\t(TARGET_ZBS): Ditto.\n\t* config/riscv/riscv.opt (riscv_zb_subext): New.", "tree": {"sha": "0d313e29033e18a92216d4c5aa42ba7a887aa790", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0d313e29033e18a92216d4c5aa42ba7a887aa790"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/149e217033f01410a9783c5cb2d020cf8334ae4c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/149e217033f01410a9783c5cb2d020cf8334ae4c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/149e217033f01410a9783c5cb2d020cf8334ae4c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/149e217033f01410a9783c5cb2d020cf8334ae4c/comments", "author": {"login": "kito-cheng", "id": 2723185, "node_id": "MDQ6VXNlcjI3MjMxODU=", "avatar_url": "https://avatars.githubusercontent.com/u/2723185?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kito-cheng", "html_url": "https://github.com/kito-cheng", "followers_url": "https://api.github.com/users/kito-cheng/followers", "following_url": "https://api.github.com/users/kito-cheng/following{/other_user}", "gists_url": "https://api.github.com/users/kito-cheng/gists{/gist_id}", "starred_url": "https://api.github.com/users/kito-cheng/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kito-cheng/subscriptions", "organizations_url": "https://api.github.com/users/kito-cheng/orgs", "repos_url": "https://api.github.com/users/kito-cheng/repos", "events_url": "https://api.github.com/users/kito-cheng/events{/privacy}", "received_events_url": "https://api.github.com/users/kito-cheng/received_events", "type": "User", "site_admin": false}, "committer": {"login": "kito-cheng", "id": 2723185, "node_id": "MDQ6VXNlcjI3MjMxODU=", "avatar_url": "https://avatars.githubusercontent.com/u/2723185?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kito-cheng", "html_url": "https://github.com/kito-cheng", "followers_url": "https://api.github.com/users/kito-cheng/followers", "following_url": "https://api.github.com/users/kito-cheng/following{/other_user}", "gists_url": "https://api.github.com/users/kito-cheng/gists{/gist_id}", "starred_url": "https://api.github.com/users/kito-cheng/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kito-cheng/subscriptions", "organizations_url": "https://api.github.com/users/kito-cheng/orgs", "repos_url": "https://api.github.com/users/kito-cheng/repos", "events_url": "https://api.github.com/users/kito-cheng/events{/privacy}", "received_events_url": "https://api.github.com/users/kito-cheng/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1a07bc9cda77b1211e95ae295b30e46c0d9ee222", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1a07bc9cda77b1211e95ae295b30e46c0d9ee222", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1a07bc9cda77b1211e95ae295b30e46c0d9ee222"}], "stats": {"total": 23, "additions": 23, "deletions": 0}, "files": [{"sha": "37b6ea8008660b7527d9edf9373964b838de06a5", "filename": "gcc/common/config/riscv/riscv-common.c", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/149e217033f01410a9783c5cb2d020cf8334ae4c/gcc%2Fcommon%2Fconfig%2Friscv%2Friscv-common.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/149e217033f01410a9783c5cb2d020cf8334ae4c/gcc%2Fcommon%2Fconfig%2Friscv%2Friscv-common.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcommon%2Fconfig%2Friscv%2Friscv-common.c?ref=149e217033f01410a9783c5cb2d020cf8334ae4c", "patch": "@@ -101,6 +101,11 @@ static const struct riscv_ext_version riscv_ext_version_table[] =\n   {\"zifencei\", ISA_SPEC_CLASS_20191213, 2, 0},\n   {\"zifencei\", ISA_SPEC_CLASS_20190608, 2, 0},\n \n+  {\"zba\", ISA_SPEC_CLASS_NONE, 1, 0},\n+  {\"zbb\", ISA_SPEC_CLASS_NONE, 1, 0},\n+  {\"zbc\", ISA_SPEC_CLASS_NONE, 1, 0},\n+  {\"zbs\", ISA_SPEC_CLASS_NONE, 1, 0},\n+\n   /* Terminate the list.  */\n   {NULL, ISA_SPEC_CLASS_NONE, 0, 0}\n };\n@@ -906,6 +911,11 @@ static const riscv_ext_flag_table_t riscv_ext_flag_table[] =\n   {\"zicsr\",    &gcc_options::x_riscv_zi_subext, MASK_ZICSR},\n   {\"zifencei\", &gcc_options::x_riscv_zi_subext, MASK_ZIFENCEI},\n \n+  {\"zba\",    &gcc_options::x_riscv_zb_subext, MASK_ZBA},\n+  {\"zbb\",    &gcc_options::x_riscv_zb_subext, MASK_ZBB},\n+  {\"zbc\",    &gcc_options::x_riscv_zb_subext, MASK_ZBC},\n+  {\"zbs\",    &gcc_options::x_riscv_zb_subext, MASK_ZBS},\n+\n   {NULL, NULL, 0}\n };\n "}, {"sha": "2efc4b80f1fb40acfb433be3d3c7e495ddb6759c", "filename": "gcc/config/riscv/riscv-opts.h", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/149e217033f01410a9783c5cb2d020cf8334ae4c/gcc%2Fconfig%2Friscv%2Friscv-opts.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/149e217033f01410a9783c5cb2d020cf8334ae4c/gcc%2Fconfig%2Friscv%2Friscv-opts.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Friscv%2Friscv-opts.h?ref=149e217033f01410a9783c5cb2d020cf8334ae4c", "patch": "@@ -73,4 +73,14 @@ enum stack_protector_guard {\n #define TARGET_ZICSR    ((riscv_zi_subext & MASK_ZICSR) != 0)\n #define TARGET_ZIFENCEI ((riscv_zi_subext & MASK_ZIFENCEI) != 0)\n \n+#define MASK_ZBA      (1 << 0)\n+#define MASK_ZBB      (1 << 1)\n+#define MASK_ZBC      (1 << 2)\n+#define MASK_ZBS      (1 << 3)\n+\n+#define TARGET_ZBA    ((riscv_zb_subext & MASK_ZBA) != 0)\n+#define TARGET_ZBB    ((riscv_zb_subext & MASK_ZBB) != 0)\n+#define TARGET_ZBC    ((riscv_zb_subext & MASK_ZBC) != 0)\n+#define TARGET_ZBS    ((riscv_zb_subext & MASK_ZBS) != 0)\n+\n #endif /* ! GCC_RISCV_OPTS_H */"}, {"sha": "15bf89e17c2516b89b1f119d2eb6438d08ab4866", "filename": "gcc/config/riscv/riscv.opt", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/149e217033f01410a9783c5cb2d020cf8334ae4c/gcc%2Fconfig%2Friscv%2Friscv.opt", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/149e217033f01410a9783c5cb2d020cf8334ae4c/gcc%2Fconfig%2Friscv%2Friscv.opt", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Friscv%2Friscv.opt?ref=149e217033f01410a9783c5cb2d020cf8334ae4c", "patch": "@@ -195,6 +195,9 @@ long riscv_stack_protector_guard_offset = 0\n TargetVariable\n int riscv_zi_subext\n \n+TargetVariable\n+int riscv_zb_subext\n+\n Enum\n Name(isa_spec_class) Type(enum riscv_isa_spec_class)\n Supported ISA specs (for use with the -misa-spec= option):"}]}