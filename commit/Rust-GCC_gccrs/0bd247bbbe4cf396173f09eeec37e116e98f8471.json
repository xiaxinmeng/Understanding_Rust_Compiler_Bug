{"sha": "0bd247bbbe4cf396173f09eeec37e116e98f8471", "node_id": "C_kwDOANBUbNoAKDBiZDI0N2JiYmU0Y2YzOTYxNzNmMDllZWVjMzdlMTE2ZTk4Zjg0NzE", "commit": {"author": {"name": "Marcel Vollweiler", "email": "marcel@codesourcery.com", "date": "2022-01-19T13:03:54Z"}, "committer": {"name": "Marcel Vollweiler", "email": "marcel@codesourcery.com", "date": "2022-01-19T13:03:54Z"}, "message": "libgomp, OpenMP: Fix issue for omp_get_device_num on gcn targets.\n\nCurrently omp_get_device_num does not work on gcn targets with more than one\noffload device. The reason is that GOMP_DEVICE_NUM_VAR is static in\nicv-device.c and thus \"__gomp_device_num\" is not visible in the offload image.\n\nThis patch removes \"static\" such that \"__gomp_device_num\" is now part of the\noffload image and can now be found in GOMP_OFFLOAD_load_image in the plugin.\n\nThis is not an issue for nvptx. There, \"__gomp_device_num\" is in the offload\nimage even with \"static\".\n\nlibgomp/ChangeLog:\n\n\t* config/gcn/icv-device.c: Make GOMP_DEVICE_NUM_VAR public (remove\n\t\"static\") to make the device num available in the offload image.", "tree": {"sha": "5656b6bc58528b5f268ed7082237125b5519c8ae", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5656b6bc58528b5f268ed7082237125b5519c8ae"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0bd247bbbe4cf396173f09eeec37e116e98f8471", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0bd247bbbe4cf396173f09eeec37e116e98f8471", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0bd247bbbe4cf396173f09eeec37e116e98f8471", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0bd247bbbe4cf396173f09eeec37e116e98f8471/comments", "author": null, "committer": null, "parents": [{"sha": "39f581028c76ebfc94a5c2714f43c9e56089a9b0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/39f581028c76ebfc94a5c2714f43c9e56089a9b0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/39f581028c76ebfc94a5c2714f43c9e56089a9b0"}], "stats": {"total": 2, "additions": 1, "deletions": 1}, "files": [{"sha": "f70b7e6de075f8dda82d1d75efed97fb7efd2643", "filename": "libgomp/config/gcn/icv-device.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0bd247bbbe4cf396173f09eeec37e116e98f8471/libgomp%2Fconfig%2Fgcn%2Ficv-device.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0bd247bbbe4cf396173f09eeec37e116e98f8471/libgomp%2Fconfig%2Fgcn%2Ficv-device.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Fconfig%2Fgcn%2Ficv-device.c?ref=0bd247bbbe4cf396173f09eeec37e116e98f8471", "patch": "@@ -60,7 +60,7 @@ omp_is_initial_device (void)\n \n /* This is set to the device number of current GPU during device initialization,\n    when the offload image containing this libgomp portion is loaded.  */\n-static volatile int GOMP_DEVICE_NUM_VAR;\n+volatile int GOMP_DEVICE_NUM_VAR;\n \n int\n omp_get_device_num (void)"}]}