{"sha": "85c0f02d872dc02ebe9568dd748e09b88acba886", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODVjMGYwMmQ4NzJkYzAyZWJlOTU2OGRkNzQ4ZTA5Yjg4YWNiYTg4Ng==", "commit": {"author": {"name": "Steven Bosscher", "email": "steven@gcc.gnu.org", "date": "2013-03-23T21:41:38Z"}, "committer": {"name": "Steven Bosscher", "email": "steven@gcc.gnu.org", "date": "2013-03-23T21:41:38Z"}, "message": "gcse.c (oprs_unchanged_p): Respect flag_gcse_lm.\n\n\t* gcse.c (oprs_unchanged_p): Respect flag_gcse_lm.\n\t(record_last_mem_set_info): Likewise.\n\nFrom-SVN: r197012", "tree": {"sha": "1cf3efa2038a7fb928d17752f24afb12821b1df7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1cf3efa2038a7fb928d17752f24afb12821b1df7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/85c0f02d872dc02ebe9568dd748e09b88acba886", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/85c0f02d872dc02ebe9568dd748e09b88acba886", "html_url": "https://github.com/Rust-GCC/gccrs/commit/85c0f02d872dc02ebe9568dd748e09b88acba886", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/85c0f02d872dc02ebe9568dd748e09b88acba886/comments", "author": null, "committer": null, "parents": [{"sha": "225ccc68d7a040c5db248b52dd4a4ed0acafd622", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/225ccc68d7a040c5db248b52dd4a4ed0acafd622", "html_url": "https://github.com/Rust-GCC/gccrs/commit/225ccc68d7a040c5db248b52dd4a4ed0acafd622"}], "stats": {"total": 14, "additions": 11, "deletions": 3}, "files": [{"sha": "60749994051a9bc890350f570bde7358219bce81", "filename": "gcc/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/85c0f02d872dc02ebe9568dd748e09b88acba886/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/85c0f02d872dc02ebe9568dd748e09b88acba886/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=85c0f02d872dc02ebe9568dd748e09b88acba886", "patch": "@@ -1,5 +1,8 @@\n 2013-03-23  Steven Bosscher  <steven@gcc.gnu.org>\n \n+\t* gcse.c (oprs_unchanged_p): Respect flag_gcse_lm.\n+\t(record_last_mem_set_info): Likewise.\n+\n \t* df-core.c (rest_of_handle_df_initialize): Use XCNEWVEC instead\n \tof XNEWVEC followed by memset.\n \t(df_worklist_dataflow): Use XNEWVEC instead of xmalloc with a cast."}, {"sha": "0c176f69f48ca19d521c167c200f40dd9638451c", "filename": "gcc/gcse.c", "status": "modified", "additions": 8, "deletions": 3, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/85c0f02d872dc02ebe9568dd748e09b88acba886/gcc%2Fgcse.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/85c0f02d872dc02ebe9568dd748e09b88acba886/gcc%2Fgcse.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgcse.c?ref=85c0f02d872dc02ebe9568dd748e09b88acba886", "patch": "@@ -890,8 +890,9 @@ oprs_unchanged_p (const_rtx x, const_rtx insn, int avail_p)\n       }\n \n     case MEM:\n-      if (load_killed_in_block_p (current_bb, DF_INSN_LUID (insn),\n-\t\t\t\t  x, avail_p))\n+      if (! flag_gcse_lm\n+\t  || load_killed_in_block_p (current_bb, DF_INSN_LUID (insn),\n+\t\t\t\t     x, avail_p))\n \treturn 0;\n       else\n \treturn oprs_unchanged_p (XEXP (x, 0), insn, avail_p);\n@@ -1471,10 +1472,14 @@ canon_list_insert (rtx dest ATTRIBUTE_UNUSED, const_rtx x ATTRIBUTE_UNUSED,\n static void\n record_last_mem_set_info (rtx insn)\n {\n-  int bb = BLOCK_FOR_INSN (insn)->index;\n+  int bb;\n+\n+  if (! flag_gcse_lm)\n+    return;\n \n   /* load_killed_in_block_p will handle the case of calls clobbering\n      everything.  */\n+  bb = BLOCK_FOR_INSN (insn)->index;\n   modify_mem_list[bb].safe_push (insn);\n   bitmap_set_bit (modify_mem_list_set, bb);\n "}]}