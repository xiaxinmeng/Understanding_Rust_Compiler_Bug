{"sha": "7fee6a39eb712a971f56f6c80ccb6b260655d3e8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2ZlZTZhMzllYjcxMmE5NzFmNTZmNmM4MGNjYjZiMjYwNjU1ZDNlOA==", "commit": {"author": {"name": "Bechir Zalila", "email": "bechir.zalila@gmail.com", "date": "2008-11-07T10:46:18Z"}, "committer": {"name": "Eric Botcazou", "email": "ebotcazou@gcc.gnu.org", "date": "2008-11-07T10:46:18Z"}, "message": "re PR ada/34289 (gnatmake -s doesn't work)\n\n\tPR ada/34289\n\t* lib.ads: (Enable_Switch_Storing): Declare.\n\t* lib.adb: (Enable_Switch_Storing): New procedure.\n\t* switch-c.adb (Scan_Front_End_Switches): Add support for -gnatea.\n\t* make.adb: (Compile_Sources.Compile): Add -gnatea as first option.\n\t(Display): Never display -gnatea\n\t* gcc-interface/lang-specs.h: If -gnatea is present, pass -gnatez.\n\nCo-Authored-By: Eric Botcazou <ebotcazou@adacore.com>\n\nFrom-SVN: r141673", "tree": {"sha": "d9fefbd5cf8fd8e9e324b96d58d792f547ef67a1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d9fefbd5cf8fd8e9e324b96d58d792f547ef67a1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7fee6a39eb712a971f56f6c80ccb6b260655d3e8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7fee6a39eb712a971f56f6c80ccb6b260655d3e8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7fee6a39eb712a971f56f6c80ccb6b260655d3e8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7fee6a39eb712a971f56f6c80ccb6b260655d3e8/comments", "author": {"login": "BechirZalila", "id": 4518482, "node_id": "MDQ6VXNlcjQ1MTg0ODI=", "avatar_url": "https://avatars.githubusercontent.com/u/4518482?v=4", "gravatar_id": "", "url": "https://api.github.com/users/BechirZalila", "html_url": "https://github.com/BechirZalila", "followers_url": "https://api.github.com/users/BechirZalila/followers", "following_url": "https://api.github.com/users/BechirZalila/following{/other_user}", "gists_url": "https://api.github.com/users/BechirZalila/gists{/gist_id}", "starred_url": "https://api.github.com/users/BechirZalila/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/BechirZalila/subscriptions", "organizations_url": "https://api.github.com/users/BechirZalila/orgs", "repos_url": "https://api.github.com/users/BechirZalila/repos", "events_url": "https://api.github.com/users/BechirZalila/events{/privacy}", "received_events_url": "https://api.github.com/users/BechirZalila/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "3453cb7809320683712bdd845a76dd7dac3095ff", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3453cb7809320683712bdd845a76dd7dac3095ff", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3453cb7809320683712bdd845a76dd7dac3095ff"}], "stats": {"total": 53, "additions": 47, "deletions": 6}, "files": [{"sha": "8c340c1102fdc327969c41538b81466b80c8e0cd", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7fee6a39eb712a971f56f6c80ccb6b260655d3e8/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7fee6a39eb712a971f56f6c80ccb6b260655d3e8/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=7fee6a39eb712a971f56f6c80ccb6b260655d3e8", "patch": "@@ -1,3 +1,14 @@\n+2008-11-07  Bechir Zalila  <bechir.zalila@gmail.com>\n+            Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\tPR ada/34289\n+\t* lib.ads: (Enable_Switch_Storing): Declare.\n+\t* lib.adb: (Enable_Switch_Storing): New procedure.\n+\t* switch-c.adb (Scan_Front_End_Switches): Add support for -gnatea.\n+\t* make.adb: (Compile_Sources.Compile): Add -gnatea as first option.\n+\t(Display): Never display -gnatea\n+\t* gcc-interface/lang-specs.h: If -gnatea is present, pass -gnatez.\n+\n 2008-11-07  Thomas Quinot  <quinot@adacore.com>\n \n \t* gcc-interface/trans.c (Attribute_to_gnu, case Attr_Length): Check"}, {"sha": "8e839a3453db248c334f1983decbf434785f5fa0", "filename": "gcc/ada/gcc-interface/lang-specs.h", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7fee6a39eb712a971f56f6c80ccb6b260655d3e8/gcc%2Fada%2Fgcc-interface%2Flang-specs.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7fee6a39eb712a971f56f6c80ccb6b260655d3e8/gcc%2Fada%2Fgcc-interface%2Flang-specs.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgcc-interface%2Flang-specs.h?ref=7fee6a39eb712a971f56f6c80ccb6b260655d3e8", "patch": "@@ -35,7 +35,8 @@\n  gnat1 %{I*} %{k8:-gnatk8} %{Wall:-gnatwa} %{w:-gnatws} %{!Q:-quiet}\\\n     %{nostdinc*} %{nostdlib*}\\\n     -dumpbase %{.adb:%b.adb}%{.ads:%b.ads}%{!.adb:%{!.ads:%b.ada}}\\\n-    %{O*} %{W*} %{w} %{p} %{pg:-p} %{a} %{f*} %{d*} %{g*&m*} \"\n+    %{O*} %{W*} %{w} %{p} %{pg:-p} %{a} %{f*} %{d*}\\\n+    %{gnatea:-gnatez} %{g*&m*} \"\n #if defined(TARGET_VXWORKS_RTP)\n    \"%{fRTS=rtp:-mrtp} \"\n #endif"}, {"sha": "5271a4573b2899d8859ce6afea4c13505f3c025b", "filename": "gcc/ada/lib.adb", "status": "modified", "additions": 14, "deletions": 1, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7fee6a39eb712a971f56f6c80ccb6b260655d3e8/gcc%2Fada%2Flib.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7fee6a39eb712a971f56f6c80ccb6b260655d3e8/gcc%2Fada%2Flib.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flib.adb?ref=7fee6a39eb712a971f56f6c80ccb6b260655d3e8", "patch": "@@ -49,7 +49,7 @@ with Uname;   use Uname;\n package body Lib is\n \n    Switch_Storing_Enabled : Boolean := True;\n-   --  Set to False by Disable_Switch_Storing\n+   --  Controlled by Enable_Switch_Storing/Disable_Switch_Storing\n \n    -----------------------\n    -- Local Subprograms --\n@@ -433,6 +433,19 @@ package body Lib is\n       return Compilation_Switches.Last;\n    end Compilation_Switches_Last;\n \n+   ---------------------------\n+   -- Enable_Switch_Storing --\n+   ---------------------------\n+\n+   procedure Enable_Switch_Storing is\n+   begin\n+      Switch_Storing_Enabled := True;\n+   end Enable_Switch_Storing;\n+\n+   ----------------------------\n+   -- Disable_Switch_Storing --\n+   ----------------------------\n+\n    procedure Disable_Switch_Storing is\n    begin\n       Switch_Storing_Enabled := False;"}, {"sha": "0b2eefb7537eacfb731d06f748371d50846f20ba", "filename": "gcc/ada/lib.ads", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7fee6a39eb712a971f56f6c80ccb6b260655d3e8/gcc%2Fada%2Flib.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7fee6a39eb712a971f56f6c80ccb6b260655d3e8/gcc%2Fada%2Flib.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flib.ads?ref=7fee6a39eb712a971f56f6c80ccb6b260655d3e8", "patch": "@@ -562,9 +562,15 @@ package Lib is\n    --  which may influence the generated output file(s). Switch is the text of\n    --  the switch to store (except that -fRTS gets changed back to --RTS).\n \n+   procedure Enable_Switch_Storing;\n+   --  Enable registration of switches by Store_Compilation_Switch. Used to\n+   --  avoid registering switches added automatically by the gcc driver at the\n+   --  beginning of the command line.\n+\n    procedure Disable_Switch_Storing;\n    --  Disable registration of switches by Store_Compilation_Switch. Used to\n-   --  avoid registering switches added automatically by the gcc driver.\n+   --  avoid registering switches added automatically by the gcc driver at the\n+   --  end of the command line.\n \n    procedure Store_Linker_Option_String (S : String_Id);\n    --  This procedure is called to register the string from a pragma"}, {"sha": "f79cbe5f0e8600209b47793b03a8d35a9bea5258", "filename": "gcc/ada/make.adb", "status": "modified", "additions": 8, "deletions": 3, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7fee6a39eb712a971f56f6c80ccb6b260655d3e8/gcc%2Fada%2Fmake.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7fee6a39eb712a971f56f6c80ccb6b260655d3e8/gcc%2Fada%2Fmake.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fmake.adb?ref=7fee6a39eb712a971f56f6c80ccb6b260655d3e8", "patch": "@@ -2947,7 +2947,7 @@ package body Make is\n          Source_Index : Int;\n          Args         : Argument_List) return Process_Id\n       is\n-         Comp_Args : Argument_List (Args'First .. Args'Last + 9);\n+         Comp_Args : Argument_List (Args'First .. Args'Last + 10);\n          Comp_Next : Integer := Args'First;\n          Comp_Last : Integer;\n          Arg_Index : Integer;\n@@ -3004,6 +3004,9 @@ package body Make is\n             end if;\n          end loop;\n \n+         Comp_Args (Comp_Next) := new String'(\"-gnatea\");\n+         Comp_Next := Comp_Next + 1;\n+\n          Comp_Args (Comp_Next) := Comp_Flag;\n          Comp_Next := Comp_Next + 1;\n \n@@ -4109,9 +4112,11 @@ package body Make is\n \n          for J in Args'Range loop\n \n-            --  Never display -gnatez\n+            --  Never display -gnatea nor -gnatez\n \n-            if Args (J).all /= \"-gnatez\" then\n+            if Args (J).all /= \"-gnatea\" and then\n+              Args (J).all /= \"-gnatez\"\n+            then\n \n                --  Do not display the mapping file argument automatically\n                --  created when using a project file."}, {"sha": "0da8f6671f2ff15ee0cd8d1dfc6e7f66316f8116", "filename": "gcc/ada/switch-c.adb", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7fee6a39eb712a971f56f6c80ccb6b260655d3e8/gcc%2Fada%2Fswitch-c.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7fee6a39eb712a971f56f6c80ccb6b260655d3e8/gcc%2Fada%2Fswitch-c.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fswitch-c.adb?ref=7fee6a39eb712a971f56f6c80ccb6b260655d3e8", "patch": "@@ -301,6 +301,11 @@ package body Switch.C is\n \n                case Switch_Chars (Ptr) is\n \n+                  when 'a' =>\n+                     Store_Switch := False;\n+                     Enable_Switch_Storing;\n+                     Ptr := Ptr + 1;\n+\n                   --  -gnatec (configuration pragmas)\n \n                   when 'c' =>"}]}