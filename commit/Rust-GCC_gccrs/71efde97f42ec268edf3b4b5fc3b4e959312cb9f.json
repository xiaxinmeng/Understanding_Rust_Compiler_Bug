{"sha": "71efde97f42ec268edf3b4b5fc3b4e959312cb9f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzFlZmRlOTdmNDJlYzI2OGVkZjNiNGI1ZmMzYjRlOTU5MzEyY2I5Zg==", "commit": {"author": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1995-01-25T22:06:11Z"}, "committer": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1995-01-25T22:06:11Z"}, "message": "(do_include): For VMS...\n\n(do_include): For VMS, don't attempt to treat `#include X' as\n`#include <X.h>' unless `X' has already been macro expanded.\n(main): For VMS, do a better job of picking out the base name from\nargv[0]'s absolute name.\n\nFrom-SVN: r8820", "tree": {"sha": "2fa2d0834d249bce3d79bef7b7041be19b691236", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2fa2d0834d249bce3d79bef7b7041be19b691236"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/71efde97f42ec268edf3b4b5fc3b4e959312cb9f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/71efde97f42ec268edf3b4b5fc3b4e959312cb9f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/71efde97f42ec268edf3b4b5fc3b4e959312cb9f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/71efde97f42ec268edf3b4b5fc3b4e959312cb9f/comments", "author": null, "committer": null, "parents": [{"sha": "3a887df45563f1d343889e5fd22dcb2cbcfbaece", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3a887df45563f1d343889e5fd22dcb2cbcfbaece", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3a887df45563f1d343889e5fd22dcb2cbcfbaece"}], "stats": {"total": 26, "additions": 15, "deletions": 11}, "files": [{"sha": "4171f4b36b04580a57a59f98db2e8759fd5eb562", "filename": "gcc/cccp.c", "status": "modified", "additions": 15, "deletions": 11, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71efde97f42ec268edf3b4b5fc3b4e959312cb9f/gcc%2Fcccp.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71efde97f42ec268edf3b4b5fc3b4e959312cb9f/gcc%2Fcccp.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcccp.c?ref=71efde97f42ec268edf3b4b5fc3b4e959312cb9f", "patch": "@@ -1149,16 +1149,19 @@ main (argc, argv)\n #ifdef VMS\n   {\n     /* Remove directories from PROGNAME.  */\n-    char *s;\n-\n-    progname = savestring (argv[0]);\n-\n-    if (!(s = rindex (progname, ']')))\n-      s = rindex (progname, ':');\n-    if (s)\n-      strcpy (progname, s+1);\n-    if (s = rindex (progname, '.'))\n-      *s = '\\0';\n+    char *s = progname;\n+\n+    if ((p = rindex (s, ':')) != 0) s = p + 1;\t/* skip device */\n+    if ((p = rindex (s, ']')) != 0) s = p + 1;\t/* skip directory */\n+    if ((p = rindex (s, '>')) != 0) s = p + 1;\t/* alternate (int'n'l) dir */\n+    s = progname = savestring (s);\n+    if ((p = rindex (s, ';')) != 0) *p = '\\0';\t/* strip version number */\n+    if ((p = rindex (s, '.')) != 0\t\t/* strip type iff \".exe\" */\n+\t&& (p[1] == 'e' || p[1] == 'E')\n+\t&& (p[2] == 'x' || p[2] == 'X')\n+\t&& (p[3] == 'e' || p[3] == 'E')\n+\t&& !p[4])\n+      *p = '\\0';\n   }\n #endif\n \n@@ -4178,8 +4181,9 @@ do_include (buf, limit, op, keyword)\n      * Support '#include xyz' like VAX-C to allow for easy use of all the\n      * decwindow include files. It defaults to '#include <xyz.h>' (so the\n      * code from case '<' is repeated here) and generates a warning.\n+     * (Note: macro expansion of `xyz' takes precedence.)\n      */\n-    if (isalpha(*(--fbeg))) {\n+    if (retried && isalpha(*(--fbeg))) {\n       fend = fbeg;\n       while (fend != limit && (!isspace(*fend))) fend++;\n       warning (\"VAX-C-style include specification found, use '#include <filename.h>' !\");"}]}