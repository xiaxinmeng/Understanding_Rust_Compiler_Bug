{"sha": "b93029150149dce2e8d2d3948b5e8d7fbd14c26e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjkzMDI5MTUwMTQ5ZGNlMmU4ZDJkMzk0OGI1ZThkN2ZiZDE0YzI2ZQ==", "commit": {"author": {"name": "Mark Mitchell", "email": "mark@codesourcery.com", "date": "2006-11-28T02:19:02Z"}, "committer": {"name": "Mark Mitchell", "email": "mmitchel@gcc.gnu.org", "date": "2006-11-28T02:19:02Z"}, "message": "class.c (build_vcall_offset_vtbl_entries): Do not add vcall entries for a primary construction virtual table.\n\n\t* class.c (build_vcall_offset_vtbl_entries): Do not add vcall\n\tentries for a primary construction virtual table.\n\nFrom-SVN: r119271", "tree": {"sha": "d439c6902f5d8d68b1501c9595436af9dc85835f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d439c6902f5d8d68b1501c9595436af9dc85835f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b93029150149dce2e8d2d3948b5e8d7fbd14c26e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b93029150149dce2e8d2d3948b5e8d7fbd14c26e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b93029150149dce2e8d2d3948b5e8d7fbd14c26e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b93029150149dce2e8d2d3948b5e8d7fbd14c26e/comments", "author": null, "committer": null, "parents": [{"sha": "df69b58cd5ad1d5ba162e3a5a6337b0ee34c64e8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/df69b58cd5ad1d5ba162e3a5a6337b0ee34c64e8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/df69b58cd5ad1d5ba162e3a5a6337b0ee34c64e8"}], "stats": {"total": 14, "additions": 13, "deletions": 1}, "files": [{"sha": "076abeaf30497c87c69c6e00370587f770c333d6", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b93029150149dce2e8d2d3948b5e8d7fbd14c26e/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b93029150149dce2e8d2d3948b5e8d7fbd14c26e/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=b93029150149dce2e8d2d3948b5e8d7fbd14c26e", "patch": "@@ -1,3 +1,8 @@\n+2006-11-27  Mark Mitchell  <mark@codesourcery.com>\n+\n+\t* class.c (build_vcall_offset_vtbl_entries): Do not add vcall\n+\tentries for a primary construction virtual table.\n+\n 2006-11-26  Mark Mitchell  <mark@codesourcery.com>\n \n \tPR c++/29886"}, {"sha": "6b195fb1f2519ea4eea8512eb2405b829e96db61", "filename": "gcc/cp/class.c", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b93029150149dce2e8d2d3948b5e8d7fbd14c26e/gcc%2Fcp%2Fclass.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b93029150149dce2e8d2d3948b5e8d7fbd14c26e/gcc%2Fcp%2Fclass.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fclass.c?ref=b93029150149dce2e8d2d3948b5e8d7fbd14c26e", "patch": "@@ -7449,7 +7449,14 @@ build_vcall_offset_vtbl_entries (tree binfo, vtbl_init_data* vid)\n   /* We only need these entries if this base is a virtual base.  We\n      compute the indices -- but do not add to the vtable -- when\n      building the main vtable for a class.  */\n-  if (BINFO_VIRTUAL_P (binfo) || binfo == TYPE_BINFO (vid->derived))\n+  if (binfo == TYPE_BINFO (vid->derived)\n+      || (BINFO_VIRTUAL_P (binfo) \n+\t  /* If BINFO is RTTI_BINFO, then (since BINFO does not\n+\t     correspond to VID->DERIVED), we are building a primary\n+\t     construction virtual table.  Since this is a primary\n+\t     virtual table, we do not need the vcall offsets for\n+\t     BINFO.  */\n+\t  && binfo != vid->rtti_binfo))\n     {\n       /* We need a vcall offset for each of the virtual functions in this\n \t vtable.  For example:"}]}