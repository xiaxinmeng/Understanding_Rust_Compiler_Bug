{"sha": "150bd82096743de59b2528fefcb7a5ec936f9d89", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTUwYmQ4MjA5Njc0M2RlNTliMjUyOGZlZmNiN2E1ZWM5MzZmOWQ4OQ==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2010-12-06T19:28:09Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2010-12-06T19:28:09Z"}, "message": "re PR rtl-optimization/46777 (ICE: in rtl_verify_flow_info, at cfgrtl.c:2164 with -O -fgcse -fno-tree-dominator-opts -funroll-loops)\n\n\tPR rtl-optimization/46777\n\t* cfglayout.c (duplicate_insn_chain): Avoid duplicating\n\talso barrier after tablejump.\n\n\t* gcc.dg/pr46777.c: New test.\n\nFrom-SVN: r167513", "tree": {"sha": "959f69dcff53adb1e2fe7053bcc927890ba29a79", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/959f69dcff53adb1e2fe7053bcc927890ba29a79"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/150bd82096743de59b2528fefcb7a5ec936f9d89", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/150bd82096743de59b2528fefcb7a5ec936f9d89", "html_url": "https://github.com/Rust-GCC/gccrs/commit/150bd82096743de59b2528fefcb7a5ec936f9d89", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/150bd82096743de59b2528fefcb7a5ec936f9d89/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "ce7190e503340dd94fec600f25d0ec64c7f56422", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ce7190e503340dd94fec600f25d0ec64c7f56422", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ce7190e503340dd94fec600f25d0ec64c7f56422"}], "stats": {"total": 75, "additions": 74, "deletions": 1}, "files": [{"sha": "047bcef4ba2383738078a6776d0cf4d41401e9f0", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/150bd82096743de59b2528fefcb7a5ec936f9d89/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/150bd82096743de59b2528fefcb7a5ec936f9d89/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=150bd82096743de59b2528fefcb7a5ec936f9d89", "patch": "@@ -1,3 +1,9 @@\n+2010-12-06  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR rtl-optimization/46777\n+\t* cfglayout.c (duplicate_insn_chain): Avoid duplicating\n+\talso barrier after tablejump.\n+\n 2010-12-06  Joern Rennecke  <amylaar@spamcop.net>\n \t    Richard Henderson  <rth@redhat.com>\n "}, {"sha": "f7d4d10440355a17c69837e80cfde989fd005653", "filename": "gcc/cfglayout.c", "status": "modified", "additions": 14, "deletions": 1, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/150bd82096743de59b2528fefcb7a5ec936f9d89/gcc%2Fcfglayout.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/150bd82096743de59b2528fefcb7a5ec936f9d89/gcc%2Fcfglayout.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcfglayout.c?ref=150bd82096743de59b2528fefcb7a5ec936f9d89", "patch": "@@ -1177,7 +1177,20 @@ duplicate_insn_chain (rtx from, rtx to)\n \t     moved far from original jump.  */\n \t  if (GET_CODE (PATTERN (insn)) == ADDR_VEC\n \t      || GET_CODE (PATTERN (insn)) == ADDR_DIFF_VEC)\n-\t    break;\n+\t    {\n+\t      /* Avoid copying following barrier as well if any\n+\t\t (and debug insns in between).  */\n+\t      rtx next;\n+\n+\t      for (next = NEXT_INSN (insn);\n+\t\t   next != NEXT_INSN (to);\n+\t\t   next = NEXT_INSN (next))\n+\t\tif (!DEBUG_INSN_P (next))\n+\t\t  break;\n+\t      if (next != NEXT_INSN (to) && BARRIER_P (next))\n+\t\tinsn = next;\n+\t      break;\n+\t    }\n \t  copy = emit_copy_of_insn_after (insn, get_last_insn ());\n           maybe_copy_prologue_epilogue_insn (insn, copy);\n \t  break;"}, {"sha": "3c5c43e1696d311d89aab404e5a7bd625131069e", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/150bd82096743de59b2528fefcb7a5ec936f9d89/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/150bd82096743de59b2528fefcb7a5ec936f9d89/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=150bd82096743de59b2528fefcb7a5ec936f9d89", "patch": "@@ -1,3 +1,8 @@\n+2010-12-06  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR rtl-optimization/46777\n+\t* gcc.dg/pr46777.c: New test.\n+\n 2010-12-06  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>\n \n \t* ada/acats/run_acats (which): Assign output to temporary"}, {"sha": "e9f40a080ebad7e7702180846772c93e69ee7779", "filename": "gcc/testsuite/gcc.dg/pr46777.c", "status": "added", "additions": 49, "deletions": 0, "changes": 49, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/150bd82096743de59b2528fefcb7a5ec936f9d89/gcc%2Ftestsuite%2Fgcc.dg%2Fpr46777.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/150bd82096743de59b2528fefcb7a5ec936f9d89/gcc%2Ftestsuite%2Fgcc.dg%2Fpr46777.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr46777.c?ref=150bd82096743de59b2528fefcb7a5ec936f9d89", "patch": "@@ -0,0 +1,49 @@\n+/* PR rtl-optimization/46777 */\n+/* { dg-do compile } */\n+/* { dg-options \"-fgcse -O -fno-tree-dominator-opts -funroll-loops\" } */\n+\n+struct S { char s[256]; };\n+\n+static inline int\n+foo (int x, int y)\n+{\n+  switch (x)\n+    {\n+    case 1:\n+    case 2:\n+      return 3;\n+    case 3:\n+    case 4:\n+      return 2;\n+    case 5:\n+      switch (y)\n+\t{\n+\tcase 4:\n+\t  return 1;\n+\t}\n+    }\n+  return 0;\n+}\n+\n+void\n+bar (struct S *x, int *y, int *z, int **w)\n+{\n+  switch (*y ? x->s[*y] : foo (y[1], y[0]))\n+    {\n+    case 3:\n+      if (y + 2 == z)\n+\tfor (;;)\n+\t  {\n+\t    y += 2;\n+\t    switch (*y ? x->s[*y] : foo (y[1], y[0]))\n+\t      {\n+\t      case 6:\n+\t\tbreak;\n+\t      default:\n+\t\t*w = y;\n+\t      }\n+\t    if (y == z)\n+\t      break;\n+\t  }\n+    }\n+}"}]}