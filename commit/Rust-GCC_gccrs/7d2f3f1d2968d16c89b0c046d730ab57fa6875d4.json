{"sha": "7d2f3f1d2968d16c89b0c046d730ab57fa6875d4", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2QyZjNmMWQyOTY4ZDE2Yzg5YjBjMDQ2ZDczMGFiNTdmYTY4NzVkNA==", "commit": {"author": {"name": "Paolo Carlini", "email": "paolo.carlini@oracle.com", "date": "2017-01-16T09:09:30Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2017-01-16T09:09:30Z"}, "message": "re PR c++/71737 (ICE following 2x pack expansion in non-pack with template alias)\n\n/c-family\n2017-01-16  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/71737\n\t* c-common.c (set_underlying_type): Always set DECL_ORIGINAL_TYPE.\n\n/testsuite\n2017-01-16  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/71737\n\t* g++.dg/cpp0x/pr71737.C: New.\n\nFrom-SVN: r244486", "tree": {"sha": "736e048357146c99ea7cf08124c6ce193a9ebca7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/736e048357146c99ea7cf08124c6ce193a9ebca7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7d2f3f1d2968d16c89b0c046d730ab57fa6875d4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7d2f3f1d2968d16c89b0c046d730ab57fa6875d4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7d2f3f1d2968d16c89b0c046d730ab57fa6875d4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7d2f3f1d2968d16c89b0c046d730ab57fa6875d4/comments", "author": null, "committer": null, "parents": [{"sha": "d743728f903ea03b0114feb594e038ca8ca799d9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d743728f903ea03b0114feb594e038ca8ca799d9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d743728f903ea03b0114feb594e038ca8ca799d9"}], "stats": {"total": 39, "additions": 32, "deletions": 7}, "files": [{"sha": "525a73f93aad7b235c98ca5233a3d18dcb92ed8d", "filename": "gcc/c-family/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7d2f3f1d2968d16c89b0c046d730ab57fa6875d4/gcc%2Fc-family%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7d2f3f1d2968d16c89b0c046d730ab57fa6875d4/gcc%2Fc-family%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2FChangeLog?ref=7d2f3f1d2968d16c89b0c046d730ab57fa6875d4", "patch": "@@ -1,3 +1,8 @@\n+2017-01-16  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/71737\n+\t* c-common.c (set_underlying_type): Always set DECL_ORIGINAL_TYPE.\n+\n 2017-01-12  Martin Sebor  <msebor@redhat.com>\n \n \t(-Wformat-overflow): ...to this."}, {"sha": "085bea03ac4bdf204ccf8f1c78b95fabb4bc3352", "filename": "gcc/c-family/c-common.c", "status": "modified", "additions": 9, "deletions": 7, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7d2f3f1d2968d16c89b0c046d730ab57fa6875d4/gcc%2Fc-family%2Fc-common.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7d2f3f1d2968d16c89b0c046d730ab57fa6875d4/gcc%2Fc-family%2Fc-common.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2Fc-common.c?ref=7d2f3f1d2968d16c89b0c046d730ab57fa6875d4", "patch": "@@ -7419,16 +7419,18 @@ set_underlying_type (tree x)\n       if (TYPE_NAME (TREE_TYPE (x)) == 0)\n \tTYPE_NAME (TREE_TYPE (x)) = x;\n     }\n-  else if (TREE_TYPE (x) != error_mark_node\n-\t   && DECL_ORIGINAL_TYPE (x) == NULL_TREE)\n+  else if (DECL_ORIGINAL_TYPE (x) == NULL_TREE)\n     {\n       tree tt = TREE_TYPE (x);\n       DECL_ORIGINAL_TYPE (x) = tt;\n-      tt = build_variant_type_copy (tt);\n-      TYPE_STUB_DECL (tt) = TYPE_STUB_DECL (DECL_ORIGINAL_TYPE (x));\n-      TYPE_NAME (tt) = x;\n-      TREE_USED (tt) = TREE_USED (x);\n-      TREE_TYPE (x) = tt;\n+      if (tt != error_mark_node)\n+\t{\n+\t  tt = build_variant_type_copy (tt);\n+\t  TYPE_STUB_DECL (tt) = TYPE_STUB_DECL (DECL_ORIGINAL_TYPE (x));\n+\t  TYPE_NAME (tt) = x;\n+\t  TREE_USED (tt) = TREE_USED (x);\n+\t  TREE_TYPE (x) = tt;\n+\t}\n     }\n }\n "}, {"sha": "aeb050a77c9b35c402a78d311f2cd8d8ca3d7c2f", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7d2f3f1d2968d16c89b0c046d730ab57fa6875d4/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7d2f3f1d2968d16c89b0c046d730ab57fa6875d4/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=7d2f3f1d2968d16c89b0c046d730ab57fa6875d4", "patch": "@@ -1,3 +1,8 @@\n+2017-01-16  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/71737\n+\t* g++.dg/cpp0x/pr71737.C: New.\n+\n 2017-01-16  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* gnat.dg/opt62.adb: New test."}, {"sha": "384d947845286565ce603f3d2ad1c7c228927fdb", "filename": "gcc/testsuite/g++.dg/cpp0x/pr71737.C", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7d2f3f1d2968d16c89b0c046d730ab57fa6875d4/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fpr71737.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7d2f3f1d2968d16c89b0c046d730ab57fa6875d4/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fpr71737.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fpr71737.C?ref=7d2f3f1d2968d16c89b0c046d730ab57fa6875d4", "patch": "@@ -0,0 +1,13 @@\n+// PR c++/78765\n+// { dg-do compile { target c++11 } }\n+\n+template <template <typename ...> class TT>\n+struct quote {\n+  template <typename ...Ts>\n+  using apply = TT<Ts...>;  // { dg-error \"pack expansion\" }\n+};\n+\n+template <typename>\n+using to_int_t = int;\n+\n+using t = quote<quote<to_int_t>::apply>::apply<int>;"}]}