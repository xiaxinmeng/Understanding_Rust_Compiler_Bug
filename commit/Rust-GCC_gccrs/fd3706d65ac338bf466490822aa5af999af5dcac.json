{"sha": "fd3706d65ac338bf466490822aa5af999af5dcac", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZmQzNzA2ZDY1YWMzMzhiZjQ2NjQ5MDgyMmFhNWFmOTk5YWY1ZGNhYw==", "commit": {"author": {"name": "Steve Ellcey", "email": "sellcey@marvell.com", "date": "2019-02-27T00:02:53Z"}, "committer": {"name": "Steve Ellcey", "email": "sje@gcc.gnu.org", "date": "2019-02-27T00:02:53Z"}, "message": "simd-builtins-1.f90: Update for aarch64*-*-*.\n\n2018-02-26  Steve Ellcey  <sellcey@marvell.com>\n\n\t* gfortran.dg/simd-builtins-1.f90: Update for aarch64*-*-*.\n\t* gfortran.dg/simd-builtins-2.f90: Ditto.\n\t* gfortran.dg/simd-builtins-6.f90: Ditto.\n\t* gfortran.dg/simd-builtins-8.f90: New test.\n\t* gfortran.dg/simd-builtins-8.h: New header file.\n\nFrom-SVN: r269236", "tree": {"sha": "01056b1db333bd72b93fffb83eca79805a9aab30", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/01056b1db333bd72b93fffb83eca79805a9aab30"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/fd3706d65ac338bf466490822aa5af999af5dcac", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fd3706d65ac338bf466490822aa5af999af5dcac", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fd3706d65ac338bf466490822aa5af999af5dcac", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fd3706d65ac338bf466490822aa5af999af5dcac/comments", "author": null, "committer": null, "parents": [{"sha": "3bac1e207dcbef241f791fc183bf5f8ac3b19b02", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3bac1e207dcbef241f791fc183bf5f8ac3b19b02", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3bac1e207dcbef241f791fc183bf5f8ac3b19b02"}], "stats": {"total": 59, "additions": 48, "deletions": 11}, "files": [{"sha": "807c04567f5136893e2c28e4dadd9b1a6f8e939c", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fd3706d65ac338bf466490822aa5af999af5dcac/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fd3706d65ac338bf466490822aa5af999af5dcac/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=fd3706d65ac338bf466490822aa5af999af5dcac", "patch": "@@ -1,3 +1,11 @@\n+2018-02-26  Steve Ellcey  <sellcey@marvell.com>\n+\n+\t* gfortran.dg/simd-builtins-1.f90: Update for aarch64*-*-*.\n+\t* gfortran.dg/simd-builtins-2.f90: Ditto.\n+\t* gfortran.dg/simd-builtins-6.f90: Ditto.\n+\t* gfortran.dg/simd-builtins-8.f90: New test.\n+\t* gfortran.dg/simd-builtins-8.h: New header file.\n+\n 2019-02-26  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR c++/89507"}, {"sha": "5cb3eb5132a866b9df4966eae9fa44ed5ed20686", "filename": "gcc/testsuite/gfortran.dg/simd-builtins-1.f90", "status": "modified", "additions": 7, "deletions": 5, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fd3706d65ac338bf466490822aa5af999af5dcac/gcc%2Ftestsuite%2Fgfortran.dg%2Fsimd-builtins-1.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fd3706d65ac338bf466490822aa5af999af5dcac/gcc%2Ftestsuite%2Fgfortran.dg%2Fsimd-builtins-1.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fsimd-builtins-1.f90?ref=fd3706d65ac338bf466490822aa5af999af5dcac", "patch": "@@ -1,5 +1,6 @@\n-! { dg-do compile { target { i?86-*-linux* x86_64-*-linux* } } }\n-! { dg-additional-options \"-msse2 -mno-avx -nostdinc -Ofast -fpre-include=simd-builtins-1.h -fdump-tree-optimized\" }\n+! { dg-do compile { target i?86-*-linux* x86_64-*-linux* aarch64*-*-linux* } }\n+! { dg-additional-options \"-nostdinc -Ofast -fpre-include=simd-builtins-1.h -fdump-tree-optimized\" }\n+! { dg-additional-options \"-msse2 -mno-avx\" { target i?86-*-linux* x86_64-*-linux* } }\n \n program test_overloaded_intrinsic\n   real(4) :: x4(3200), y4(3200)\n@@ -14,6 +15,7 @@ program test_overloaded_intrinsic\n   print *, y8\n end\n \n-! { dg-final { scan-tree-dump \"sinf.simdclone\" \"optimized\" } } */\n-! { dg-final { scan-tree-dump \"__builtin_sin\" \"optimized\" } } */\n-! { dg-final { scan-assembler \"call.*_ZGVbN4v_sinf\" } }\n+! { dg-final { scan-tree-dump \"sinf.simdclone\" \"optimized\" } }\n+! { dg-final { scan-tree-dump \"__builtin_sin\" \"optimized\" } }\n+! { dg-final { scan-assembler \"call.*_ZGVbN4v_sinf\" { target i?86-*-linux* x86_64-*-* } } }\n+! { dg-final { scan-assembler \"bl.*_ZGVnN4v_sinf\" { target aarch64*-*-* } } }"}, {"sha": "2e5bc22716be4e748cc54b6ac64f5a3435c0a783", "filename": "gcc/testsuite/gfortran.dg/simd-builtins-2.f90", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fd3706d65ac338bf466490822aa5af999af5dcac/gcc%2Ftestsuite%2Fgfortran.dg%2Fsimd-builtins-2.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fd3706d65ac338bf466490822aa5af999af5dcac/gcc%2Ftestsuite%2Fgfortran.dg%2Fsimd-builtins-2.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fsimd-builtins-2.f90?ref=fd3706d65ac338bf466490822aa5af999af5dcac", "patch": "@@ -1,11 +1,12 @@\n-! { dg-do compile { target { i?86-*-linux* x86_64-*-linux* } } }\n-! { dg-additional-options \"-msse2 -nostdinc -Ofast -fdump-tree-optimized\" }\n+! { dg-do compile { target { i?86-*-linux* x86_64-*-linux* aarch64*-*-linux* } } }\n+! { dg-additional-options \"-nostdinc -Ofast -fdump-tree-optimized\" }\n+! { dg-additional-options \"-msse2\" { target i?86-*-linux* x86_64-*-linux* } }\n \n program test_overloaded_intrinsic\n   real(4) :: x4(3200), y4(3200)\n   real(8) :: x8(3200), y8(3200)\n \n-  ! this should be using simd clone\n+  ! this should not be using simd clone\n   y4 = sin(x4)\n   print *, y4\n \n@@ -18,3 +19,4 @@ program test_overloaded_intrinsic\n ! { dg-final { scan-tree-dump \"__builtin_sin\" \"optimized\" } } */\n ! { dg-final { scan-tree-dump-not \"simdclone\" \"optimized\" } } */\n ! { dg-final { scan-assembler-not \"call.*_ZGVbN4v_sinf\" } }\n+! { dg-final { scan-assembler-not \"bl.*_ZGVnN4v_sinf\" } }"}, {"sha": "60bcac78f3e0cc492930f3eb73cf97065312dc1c", "filename": "gcc/testsuite/gfortran.dg/simd-builtins-6.f90", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fd3706d65ac338bf466490822aa5af999af5dcac/gcc%2Ftestsuite%2Fgfortran.dg%2Fsimd-builtins-6.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fd3706d65ac338bf466490822aa5af999af5dcac/gcc%2Ftestsuite%2Fgfortran.dg%2Fsimd-builtins-6.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fsimd-builtins-6.f90?ref=fd3706d65ac338bf466490822aa5af999af5dcac", "patch": "@@ -1,5 +1,6 @@\n-! { dg-do compile { target { i?86-*-linux* x86_64-*-linux* } } }\n-! { dg-additional-options \"-msse2 -mno-avx -nostdinc -Ofast -fdump-tree-optimized\" }\n+! { dg-do compile { target { i?86-*-linux* x86_64-*-linux* aarch64*-*-linux* } } }\n+! { dg-additional-options \"-nostdinc -Ofast -fdump-tree-optimized\" }\n+! { dg-additional-options \"-msse2 -mno-avx\" { target i?86-*-linux* x86_64-*-linux* } }\n \n !GCC$ builtin (sin) attributes simd (inbranch)\n !GCC$ builtin (sinf) attributes simd (notinbranch)\n@@ -21,4 +22,5 @@ program test_overloaded_intrinsic\n \n ! { dg-final { scan-tree-dump \"sinf.simdclone\" \"optimized\" } } */\n ! { dg-final { scan-tree-dump \"__builtin_sin\" \"optimized\" } } */\n-! { dg-final { scan-assembler \"call.*_ZGVbN4v_sinf\" } }\n+! { dg-final { scan-assembler \"call.*_ZGVbN4v_sinf\" { target i?86-*-linux* x86_64-*-* } } }\n+! { dg-final { scan-assembler \"bl.*_ZGVnN4v_sinf\" { target aarch64*-*-* } } }"}, {"sha": "0237235b5ae88b39fef5f9599776e16392c89691", "filename": "gcc/testsuite/gfortran.dg/simd-builtins-8.f90", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fd3706d65ac338bf466490822aa5af999af5dcac/gcc%2Ftestsuite%2Fgfortran.dg%2Fsimd-builtins-8.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fd3706d65ac338bf466490822aa5af999af5dcac/gcc%2Ftestsuite%2Fgfortran.dg%2Fsimd-builtins-8.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fsimd-builtins-8.f90?ref=fd3706d65ac338bf466490822aa5af999af5dcac", "patch": "@@ -0,0 +1,19 @@\n+! { dg-do compile { target { aarch64*-*-linux* } } }\n+! { dg-additional-options \"-nostdinc -Ofast -fpre-include=simd-builtins-8.h -fdump-tree-optimized\" }\n+\n+program test_overloaded_intrinsic\n+  real(4) :: x4(3200), y4(3200)\n+  real(8) :: x8(3200), y8(3200)\n+\n+  y4 = sin(x4)\n+  print *, y4\n+\n+  y4 = sin(x8)\n+  print *, y8\n+end\n+\n+! { dg-final { scan-tree-dump \"sinf.simdclone\" \"optimized\" { target ilp32 } } } */\n+! { dg-final { scan-tree-dump-not \"sin.simdclone\" \"optimized\" { target ilp32 } } } */\n+\n+! { dg-final { scan-tree-dump \"sin.simdclone\" \"optimized\" { target lp64 } } } */\n+! { dg-final { scan-tree-dump-not \"sinf.simdclone\" \"optimized\" { target lp64  } } } */"}, {"sha": "2eade390b37930534fef754bc1c99c448c5d8b43", "filename": "gcc/testsuite/gfortran.dg/simd-builtins-8.h", "status": "added", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fd3706d65ac338bf466490822aa5af999af5dcac/gcc%2Ftestsuite%2Fgfortran.dg%2Fsimd-builtins-8.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fd3706d65ac338bf466490822aa5af999af5dcac/gcc%2Ftestsuite%2Fgfortran.dg%2Fsimd-builtins-8.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fsimd-builtins-8.h?ref=fd3706d65ac338bf466490822aa5af999af5dcac", "patch": "@@ -0,0 +1,4 @@\n+!GCC$ builtin (sin) attributes simd (notinbranch) if('aarch64')\n+!GCC$ builtin (sin) attributes simd (notinbranch) if('aarch64_be')\n+!GCC$ builtin (sinf) attributes simd (notinbranch) if('aarch64_ilp32')\n+!GCC$ builtin (sinf) attributes simd (notinbranch) if('aarch64_be_ilp32')"}]}