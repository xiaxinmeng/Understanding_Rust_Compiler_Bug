{"sha": "ad4188f8385f86cc04806fb0e26c7da1f5f655b8", "node_id": "C_kwDOANBUbNoAKGFkNDE4OGY4Mzg1Zjg2Y2MwNDgwNmZiMGUyNmM3ZGExZjVmNjU1Yjg", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2022-01-19T12:59:21Z"}, "committer": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2022-01-20T08:04:20Z"}, "message": "tree-optimization/104114 - avoid diagnosing V1mode lowering\n\nCurrently we diagnose vector lowering of V1mode operations that\nare not natively supported into V_C_E, scalar op plus CTOR with\n-Wvector-operation-performance but that's hardly useful behavior\neven though the way we lower things can be improved.\n\nThe following disables the diagnostics for the cases the vect.exp\ntestsuite runs into, on x86 that are vect-cond-11.c and\nvect-singleton_1.c.\n\n2022-01-19  Richard Biener  <rguenther@suse.de>\n\n\tPR tree-optimization/104114\n\t* tree-vect-generic.cc (expand_vector_piecewise): Do not diagnose\n\tsingle element vector decomposition.", "tree": {"sha": "65a5c9e710ccbbd1eaade7fa14aff5877fd85fc7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/65a5c9e710ccbbd1eaade7fa14aff5877fd85fc7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ad4188f8385f86cc04806fb0e26c7da1f5f655b8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ad4188f8385f86cc04806fb0e26c7da1f5f655b8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ad4188f8385f86cc04806fb0e26c7da1f5f655b8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ad4188f8385f86cc04806fb0e26c7da1f5f655b8/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "30f2c22def7392119f1ffaca30ef998b3b43f336", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/30f2c22def7392119f1ffaca30ef998b3b43f336", "html_url": "https://github.com/Rust-GCC/gccrs/commit/30f2c22def7392119f1ffaca30ef998b3b43f336"}], "stats": {"total": 5, "additions": 4, "deletions": 1}, "files": [{"sha": "f4fc7d161190e11f95feb12fe9bf347bd0cf0542", "filename": "gcc/tree-vect-generic.cc", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ad4188f8385f86cc04806fb0e26c7da1f5f655b8/gcc%2Ftree-vect-generic.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ad4188f8385f86cc04806fb0e26c7da1f5f655b8/gcc%2Ftree-vect-generic.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-vect-generic.cc?ref=ad4188f8385f86cc04806fb0e26c7da1f5f655b8", "patch": "@@ -317,7 +317,10 @@ expand_vector_piecewise (gimple_stmt_iterator *gsi, elem_op_func f,\n   int i;\n   location_t loc = gimple_location (gsi_stmt (*gsi));\n \n-  if (ret_type || !parallel_p)\n+  if (nunits == 1)\n+    /* Do not diagnose decomposing single element vectors.  */\n+    ;\n+  else if (ret_type || !parallel_p)\n     warning_at (loc, OPT_Wvector_operation_performance,\n \t\t\"vector operation will be expanded piecewise\");\n   else"}]}