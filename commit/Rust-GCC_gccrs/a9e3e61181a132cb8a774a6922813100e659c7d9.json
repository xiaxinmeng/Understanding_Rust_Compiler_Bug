{"sha": "a9e3e61181a132cb8a774a6922813100e659c7d9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTllM2U2MTE4MWExMzJjYjhhNzc0YTY5MjI4MTMxMDBlNjU5YzdkOQ==", "commit": {"author": {"name": "Gavin Romig-Koch", "email": "gavin@cygnus.com", "date": "1998-08-12T09:42:55Z"}, "committer": {"name": "Gavin Romig-Koch", "email": "gavin@gcc.gnu.org", "date": "1998-08-12T09:42:55Z"}, "message": "mips.h (ENCODE_SECTION_INFO): Set SYMBOL_REF_FLAG for VAR_DECL's in gp addressable sections.\n\n\t* mips/mips.h (ENCODE_SECTION_INFO): Set SYMBOL_REF_FLAG for\n\tVAR_DECL's in gp addressable sections.\n\nFrom-SVN: r21681", "tree": {"sha": "d8903ec183b203939b7cb3a1b9317ab385a6db6e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d8903ec183b203939b7cb3a1b9317ab385a6db6e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a9e3e61181a132cb8a774a6922813100e659c7d9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a9e3e61181a132cb8a774a6922813100e659c7d9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a9e3e61181a132cb8a774a6922813100e659c7d9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a9e3e61181a132cb8a774a6922813100e659c7d9/comments", "author": null, "committer": null, "parents": [{"sha": "87183d21f5188965d91773391da653b23640365c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/87183d21f5188965d91773391da653b23640365c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/87183d21f5188965d91773391da653b23640365c"}], "stats": {"total": 23, "additions": 22, "deletions": 1}, "files": [{"sha": "26cd943254ff6ec3841acc4c5543b66f62466514", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a9e3e61181a132cb8a774a6922813100e659c7d9/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a9e3e61181a132cb8a774a6922813100e659c7d9/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=a9e3e61181a132cb8a774a6922813100e659c7d9", "patch": "@@ -1,3 +1,8 @@\n+Wed Aug 12 12:39:16 1998  Gavin Romig-Koch  <gavin@cygnus.com>\n+\n+\t* mips/mips.h (ENCODE_SECTION_INFO): Set SYMBOL_REF_FLAG for\n+\tVAR_DECL's in gp addressable sections.\n+\n Tue Aug 11 23:02:31 1998  John Carr  <jfc@mit.edu>\n \n \t* sparc.c: Change return <exp> to <exp>; return; in functions"}, {"sha": "8bf22c37aa64a0a2c73efbf227209fe64b10fb17", "filename": "gcc/config/mips/mips.h", "status": "modified", "additions": 17, "deletions": 1, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a9e3e61181a132cb8a774a6922813100e659c7d9/gcc%2Fconfig%2Fmips%2Fmips.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a9e3e61181a132cb8a774a6922813100e659c7d9/gcc%2Fconfig%2Fmips%2Fmips.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.h?ref=a9e3e61181a132cb8a774a6922813100e659c7d9", "patch": "@@ -3043,7 +3043,13 @@ typedef struct mips_args {\n    constants which are put in the .text section.  We also record the\n    total length of all such strings; this total is used to decide\n    whether we need to split the constant table, and need not be\n-   precisely correct.  */\n+   precisely correct. \n+\n+   When not mips16 code nor embedded PIC, if a symbol is in a\n+   gp addresable section, SYMBOL_REF_FLAG is set prevent gcc from\n+   splitting the reference so that gas can generate a gp relative\n+   reference.\n+ */\n \n #define ENCODE_SECTION_INFO(DECL)\t\t\t\t\t\\\n do\t\t\t\t\t\t\t\t\t\\\n@@ -3070,6 +3076,16 @@ do\t\t\t\t\t\t\t\t\t\\\n \t  SYMBOL_REF_FLAG (XEXP (TREE_CST_RTL (DECL), 0)) = 1;\t\t\\\n       }\t\t\t\t\t\t\t\t\t\\\n \t\t\t\t\t\t\t\t\t\\\n+    else if (TREE_CODE (DECL) == VAR_DECL\t\t\t\t\\\n+             && DECL_SECTION_NAME (DECL) != NULL_TREE                   \\\n+             && (0 == strcmp (TREE_STRING_POINTER (DECL_SECTION_NAME (DECL)), \\\n+                              \".sdata\")                                 \\\n+                || 0 == strcmp (TREE_STRING_POINTER (DECL_SECTION_NAME (DECL)),\\\n+                              \".sbss\")))                                \\\n+      {\t\t\t\t\t\t\t\t\t\\\n+        SYMBOL_REF_FLAG (XEXP (DECL_RTL (DECL), 0)) = 1;\t\t\\\n+      }\t\t\t\t\t\t\t\t\t\\\n+\t\t\t\t\t\t\t\t\t\\\n     else if (TARGET_GP_OPT && TREE_CODE (DECL) == VAR_DECL)\t\t\\\n       {\t\t\t\t\t\t\t\t\t\\\n \tint size = int_size_in_bytes (TREE_TYPE (DECL));\t\t\\"}]}