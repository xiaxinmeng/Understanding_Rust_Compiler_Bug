{"sha": "bcf88f9b91e911d01ba43026f15eaa4858e23e4c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmNmODhmOWI5MWU5MTFkMDFiYTQzMDI2ZjE1ZWFhNDg1OGUyM2U0Yw==", "commit": {"author": {"name": "Bob Wilson", "email": "bob.wilson@acm.org", "date": "2002-04-01T19:52:18Z"}, "committer": {"name": "Bob Wilson", "email": "bwilson@gcc.gnu.org", "date": "2002-04-01T19:52:18Z"}, "message": "xtensa.c (xtensa_va_arg): Fix to handle arguments for which MUST_PASS_IN_STACK is true (e.g....\n\n        * config/xtensa/xtensa.c (xtensa_va_arg): Fix to handle arguments\n        for which MUST_PASS_IN_STACK is true (e.g., variable-sized types).\n\nFrom-SVN: r51700", "tree": {"sha": "c00059b72636edee78bb612232b5a761d9aaa7f0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c00059b72636edee78bb612232b5a761d9aaa7f0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bcf88f9b91e911d01ba43026f15eaa4858e23e4c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bcf88f9b91e911d01ba43026f15eaa4858e23e4c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bcf88f9b91e911d01ba43026f15eaa4858e23e4c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bcf88f9b91e911d01ba43026f15eaa4858e23e4c/comments", "author": null, "committer": null, "parents": [{"sha": "ed4168d56fca29ef1678edcde2346f18bea80c1d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ed4168d56fca29ef1678edcde2346f18bea80c1d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ed4168d56fca29ef1678edcde2346f18bea80c1d"}], "stats": {"total": 38, "additions": 25, "deletions": 13}, "files": [{"sha": "fa98fbbf0cdd7fc81660beadd28e26afacf68282", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bcf88f9b91e911d01ba43026f15eaa4858e23e4c/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bcf88f9b91e911d01ba43026f15eaa4858e23e4c/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=bcf88f9b91e911d01ba43026f15eaa4858e23e4c", "patch": "@@ -1,3 +1,8 @@\n+2002-04-01  Bob Wilson  <bob.wilson@acm.org>\n+\n+\t* config/xtensa/xtensa.c (xtensa_va_arg): Fix to handle arguments\n+\tfor which MUST_PASS_IN_STACK is true (e.g., variable-sized types).\n+\n 2002-04-01  Neil Booth  <neil@daikokuya.demon.co.uk>\n \n \t* c-common.c (unsigned_conversion_warning, convert_and_check,"}, {"sha": "c6bc9590ea270b5500158009d55bb66488ec8772", "filename": "gcc/config/xtensa/xtensa.c", "status": "modified", "additions": 20, "deletions": 13, "changes": 33, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bcf88f9b91e911d01ba43026f15eaa4858e23e4c/gcc%2Fconfig%2Fxtensa%2Fxtensa.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bcf88f9b91e911d01ba43026f15eaa4858e23e4c/gcc%2Fconfig%2Fxtensa%2Fxtensa.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fxtensa%2Fxtensa.c?ref=bcf88f9b91e911d01ba43026f15eaa4858e23e4c", "patch": "@@ -2496,26 +2496,32 @@ xtensa_va_arg (valist, type)\n \n   /* Check if the argument is in registers:\n \n-     if ((AP).__va_ndx <= __MAX_ARGS_IN_REGISTERS * 4)\n+     if ((AP).__va_ndx <= __MAX_ARGS_IN_REGISTERS * 4\n+         && !MUST_PASS_IN_STACK (type))\n         __array = (AP).__va_reg;\n   */\n \n-  lab_false = gen_label_rtx ();\n-  lab_over = gen_label_rtx ();\n   array = gen_reg_rtx (Pmode);\n \n-  emit_cmp_and_jump_insns (expand_expr (ndx, NULL_RTX, SImode, EXPAND_NORMAL),\n-\t\t\t   GEN_INT (MAX_ARGS_IN_REGISTERS * UNITS_PER_WORD),\n-\t\t\t   GT, const1_rtx, SImode, 0, lab_false);\n+  if (!MUST_PASS_IN_STACK (VOIDmode, type))\n+    {\n+      lab_false = gen_label_rtx ();\n+      lab_over = gen_label_rtx ();\n \n-  r = expand_expr (reg, array, Pmode, EXPAND_NORMAL);\n-  if (r != array)\n-    emit_move_insn (array, r);\n+      emit_cmp_and_jump_insns (expand_expr (ndx, NULL_RTX, SImode,\n+\t\t\t\t\t    EXPAND_NORMAL),\n+\t\t\t       GEN_INT (MAX_ARGS_IN_REGISTERS\n+\t\t\t\t\t* UNITS_PER_WORD),\n+\t\t\t       GT, const1_rtx, SImode, 0, lab_false);\n \n-  emit_jump_insn (gen_jump (lab_over));\n-  emit_barrier ();\n-  emit_label (lab_false);\n+      r = expand_expr (reg, array, Pmode, EXPAND_NORMAL);\n+      if (r != array)\n+\temit_move_insn (array, r);\n \n+      emit_jump_insn (gen_jump (lab_over));\n+      emit_barrier ();\n+      emit_label (lab_false);\n+    }\n \n   /* ...otherwise, the argument is on the stack (never split between\n      registers and the stack -- change __va_ndx if necessary):\n@@ -2545,7 +2551,8 @@ xtensa_va_arg (valist, type)\n   if (r != array)\n     emit_move_insn (array, r);\n \n-  emit_label (lab_over);\n+  if (!MUST_PASS_IN_STACK (VOIDmode, type))\n+    emit_label (lab_over);\n \n \n   /* Given the base array pointer (__array) and index to the subsequent"}]}