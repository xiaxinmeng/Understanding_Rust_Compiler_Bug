{"sha": "e3951b03376718fb739661420dffea9de1edbcfa", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTM5NTFiMDMzNzY3MThmYjczOTY2MTQyMGRmZmVhOWRlMWVkYmNmYQ==", "commit": {"author": {"name": "Jan Hubicka", "email": "hubicka@ucw.cz", "date": "2017-12-02T09:48:24Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2017-12-02T09:48:24Z"}, "message": "ipa-cp.c (ipcp_lattice<valtype>::print): Update dumping.\n\n\t* ipa-cp.c (ipcp_lattice<valtype>::print): Update dumping.\n\t(update_specialized_profile): Fix updating of counts.\n\t(perhaps_add_new_callers): Likewise.\n\nFrom-SVN: r255358", "tree": {"sha": "bf3c634b7359fe86934cd78e37850aed0eae89d8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/bf3c634b7359fe86934cd78e37850aed0eae89d8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e3951b03376718fb739661420dffea9de1edbcfa", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e3951b03376718fb739661420dffea9de1edbcfa", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e3951b03376718fb739661420dffea9de1edbcfa", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e3951b03376718fb739661420dffea9de1edbcfa/comments", "author": null, "committer": null, "parents": [{"sha": "4ca47ced33cc0d6f9e336930d628a6fdbf22f6e2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4ca47ced33cc0d6f9e336930d628a6fdbf22f6e2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4ca47ced33cc0d6f9e336930d628a6fdbf22f6e2"}], "stats": {"total": 17, "additions": 10, "deletions": 7}, "files": [{"sha": "367dcb14828a977cbfc5d3566597c927328cc0af", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e3951b03376718fb739661420dffea9de1edbcfa/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e3951b03376718fb739661420dffea9de1edbcfa/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=e3951b03376718fb739661420dffea9de1edbcfa", "patch": "@@ -1,3 +1,9 @@\n+2017-12-01  Jan Hubicka  <hubicka@ucw.cz>\n+\n+\t* ipa-cp.c (ipcp_lattice<valtype>::print): Update dumping.\n+\t(update_specialized_profile): Fix updating of counts.\n+\t(perhaps_add_new_callers): Likewise.\n+\n 2017-12-01  Jan Hubicka  <hubicka@ucw.cz>\n \n \tPR target/81616"}, {"sha": "b6b1fefe9bc549ae79e9fa2b3dcb944952cae283", "filename": "gcc/ipa-cp.c", "status": "modified", "additions": 4, "deletions": 7, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e3951b03376718fb739661420dffea9de1edbcfa/gcc%2Fipa-cp.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e3951b03376718fb739661420dffea9de1edbcfa/gcc%2Fipa-cp.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-cp.c?ref=e3951b03376718fb739661420dffea9de1edbcfa", "patch": "@@ -497,8 +497,8 @@ ipcp_lattice<valtype>::print (FILE * f, bool dump_sources, bool dump_benefits)\n \n \t  fprintf (f, \" [from:\");\n \t  for (s = val->sources; s; s = s->next)\n-\t    fprintf (f, \" %i(%i)\", s->cs->caller->order,\n-\t\t     s->cs->frequency ());\n+\t    fprintf (f, \" %i(%f)\", s->cs->caller->order,\n+\t\t     s->cs->sreal_frequency ().to_double ());\n \t  fprintf (f, \"]\");\n \t}\n \n@@ -3751,10 +3751,7 @@ update_specialized_profile (struct cgraph_node *new_node,\n   orig_node->count -= redirected_sum;\n \n   for (cs = new_node->callees; cs; cs = cs->next_callee)\n-    if (cs->frequency ())\n-      cs->count += cs->count.apply_scale (redirected_sum, new_node_count);\n-    else\n-      cs->count = profile_count::zero ();\n+    cs->count += cs->count.apply_scale (redirected_sum, new_node_count);\n \n   for (cs = orig_node->callees; cs; cs = cs->next_callee)\n     {\n@@ -4482,7 +4479,7 @@ perhaps_add_new_callers (cgraph_node *node, ipcp_value<valtype> *val)\n \t}\n     }\n \n-  if (redirected_sum > profile_count::zero ())\n+  if (redirected_sum.nonzero_p ())\n     update_specialized_profile (val->spec_node, node, redirected_sum);\n }\n "}]}