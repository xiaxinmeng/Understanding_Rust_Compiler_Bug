{"sha": "f35b24e9cc18e2f917aa52dfaea8cf88a85cbb68", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjM1YjI0ZTljYzE4ZTJmOTE3YWE1MmRmYWVhOGNmODhhODVjYmI2OA==", "commit": {"author": {"name": "Robert Dewar", "email": "dewar@adacore.com", "date": "2007-06-06T10:36:48Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2007-06-06T10:36:48Z"}, "message": "layout.ads, layout.adb (Adjust_Esize_Alignment): Move spec to package spec from body\n\n2007-04-20  Robert Dewar  <dewar@adacore.com>\n\n\t* layout.ads, layout.adb (Adjust_Esize_Alignment): Move spec to package\n\tspec from body\n\t(Layout_Type): Fix recomputation of size from alignment.\n\nFrom-SVN: r125430", "tree": {"sha": "6574dd19dcce4e6014fb5f03a9ea6662d5ab98bd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6574dd19dcce4e6014fb5f03a9ea6662d5ab98bd"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f35b24e9cc18e2f917aa52dfaea8cf88a85cbb68", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f35b24e9cc18e2f917aa52dfaea8cf88a85cbb68", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f35b24e9cc18e2f917aa52dfaea8cf88a85cbb68", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f35b24e9cc18e2f917aa52dfaea8cf88a85cbb68/comments", "author": null, "committer": null, "parents": [{"sha": "27f92b1609f366d1642bd8a4323cec8e317fe948", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/27f92b1609f366d1642bd8a4323cec8e317fe948", "html_url": "https://github.com/Rust-GCC/gccrs/commit/27f92b1609f366d1642bd8a4323cec8e317fe948"}], "stats": {"total": 22, "additions": 12, "deletions": 10}, "files": [{"sha": "faff2d5edc04fa77043834f8f7d336d75a9e1427", "filename": "gcc/ada/layout.adb", "status": "modified", "additions": 4, "deletions": 9, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f35b24e9cc18e2f917aa52dfaea8cf88a85cbb68/gcc%2Fada%2Flayout.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f35b24e9cc18e2f917aa52dfaea8cf88a85cbb68/gcc%2Fada%2Flayout.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flayout.adb?ref=f35b24e9cc18e2f917aa52dfaea8cf88a85cbb68", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 B o d y                                  --\n --                                                                          --\n---          Copyright (C) 2001-2006, Free Software Foundation, Inc.         --\n+--          Copyright (C) 2001-2007, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -31,6 +31,7 @@ with Einfo;    use Einfo;\n with Errout;   use Errout;\n with Exp_Ch3;  use Exp_Ch3;\n with Exp_Util; use Exp_Util;\n+with Namet;    use Namet;\n with Nlists;   use Nlists;\n with Nmake;    use Nmake;\n with Opt;      use Opt;\n@@ -70,11 +71,6 @@ package body Layout is\n    -- Local Subprograms --\n    -----------------------\n \n-   procedure Adjust_Esize_Alignment (E : Entity_Id);\n-   --  E is the entity for a type or object. This procedure checks that the\n-   --  size and alignment are compatible, and if not either gives an error\n-   --  message if they cannot be adjusted or else adjusts them appropriately.\n-\n    function Assoc_Add\n      (Loc        : Source_Ptr;\n       Left_Opnd  : Node_Id;\n@@ -2486,9 +2482,8 @@ package body Layout is\n                declare\n                   A : constant Uint   := Alignment_In_Bits (E);\n                   S : constant SO_Ref := RM_Size (E);\n-\n                begin\n-                  Set_Esize (E, (S * A + A - 1) / A);\n+                  Set_Esize (E, (S + A - 1) / A * A);\n                end;\n             end if;\n \n@@ -2605,7 +2600,7 @@ package body Layout is\n             if Has_Object_Size_Clause (E) then\n                Error_Msg_Uint_1 := RM_Size (E);\n                Error_Msg_F\n-                 (\"object size is too small, minimum is ^\",\n+                 (\"object size is too small, minimum allowed is ^\",\n                   Expression (Get_Attribute_Definition_Clause\n                                              (E, Attribute_Object_Size)));\n             end if;"}, {"sha": "e1cbe94248e292303c3f6aa488a0d2687ef1920a", "filename": "gcc/ada/layout.ads", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f35b24e9cc18e2f917aa52dfaea8cf88a85cbb68/gcc%2Fada%2Flayout.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f35b24e9cc18e2f917aa52dfaea8cf88a85cbb68/gcc%2Fada%2Flayout.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flayout.ads?ref=f35b24e9cc18e2f917aa52dfaea8cf88a85cbb68", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 S p e c                                  --\n --                                                                          --\n---          Copyright (C) 2000-2004 Free Software Foundation, Inc.          --\n+--          Copyright (C) 2000-2006, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -60,6 +60,13 @@ package Layout is\n    --  it means that the object must be allocated dynamically, since\n    --  its length is not known at compile time.\n \n+   --  The following are utility routines, called from various places\n+\n+   procedure Adjust_Esize_Alignment (E : Entity_Id);\n+   --  E is the entity for a type or object. This procedure checks that the\n+   --  size and alignment are compatible, and if not either gives an error\n+   --  message if they cannot be adjusted or else adjusts them appropriately.\n+\n    procedure Set_Discrete_RM_Size (Def_Id : Entity_Id);\n    --  Set proper RM_Size for discrete size, this is normally the minimum\n    --  number of bits to accommodate the range given, except in the case"}]}