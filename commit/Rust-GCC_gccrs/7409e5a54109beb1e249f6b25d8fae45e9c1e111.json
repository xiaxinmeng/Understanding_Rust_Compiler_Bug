{"sha": "7409e5a54109beb1e249f6b25d8fae45e9c1e111", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzQwOWU1YTU0MTA5YmViMWUyNDlmNmIyNWQ4ZmFlNDVlOWMxZTExMQ==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2009-04-27T05:54:32Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2009-04-27T05:54:32Z"}, "message": "re PR c++/39875 (Wrong \"value computed is not used\" warning)\n\n\tPR c++/39875\n\t* cvt.c (convert_to_void) <case INDIRECT_REF>: Only warn about\n\t-Wunused-value if implicit.\n\n\t* g++.dg/warn/Wunused-15.C: New test.\n\nFrom-SVN: r146825", "tree": {"sha": "968f19673bc125b699601e6421177f0ba8940329", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/968f19673bc125b699601e6421177f0ba8940329"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7409e5a54109beb1e249f6b25d8fae45e9c1e111", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7409e5a54109beb1e249f6b25d8fae45e9c1e111", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7409e5a54109beb1e249f6b25d8fae45e9c1e111", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7409e5a54109beb1e249f6b25d8fae45e9c1e111/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "5bb786b05392b26a399ad9cbf183ebfe6afd99a1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5bb786b05392b26a399ad9cbf183ebfe6afd99a1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5bb786b05392b26a399ad9cbf183ebfe6afd99a1"}], "stats": {"total": 28, "additions": 27, "deletions": 1}, "files": [{"sha": "3feda531fdeb727aa5f04c2fef4fe0d2b5e6a0d9", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7409e5a54109beb1e249f6b25d8fae45e9c1e111/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7409e5a54109beb1e249f6b25d8fae45e9c1e111/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=7409e5a54109beb1e249f6b25d8fae45e9c1e111", "patch": "@@ -1,3 +1,9 @@\n+2009-04-27  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR c++/39875\n+\t* cvt.c (convert_to_void) <case INDIRECT_REF>: Only warn about\n+\t-Wunused-value if implicit.\n+\n 2009-04-24  Ian Lance Taylor  <iant@google.com>\n \n \t* call.c (build_temp): Change 0 to enum constant."}, {"sha": "c86fbdfe0da0cc7da8d4ac1e1bd8995bed33893f", "filename": "gcc/cp/cvt.c", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7409e5a54109beb1e249f6b25d8fae45e9c1e111/gcc%2Fcp%2Fcvt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7409e5a54109beb1e249f6b25d8fae45e9c1e111/gcc%2Fcp%2Fcvt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fcvt.c?ref=7409e5a54109beb1e249f6b25d8fae45e9c1e111", "patch": "@@ -787,7 +787,10 @@ ocp_convert (tree type, tree expr, int convtype, int flags)\n    make it impossible to ignore the reference return value from functions. We\n    issue warnings in the confusing cases.\n \n-   IMPLICIT is tells us the context of an implicit void conversion.  */\n+   IMPLICIT is non-NULL iff an expression is being implicitly converted; it\n+   is NULL when the user is explicitly converting an expression to void via\n+   a cast.  When non-NULL, IMPLICIT is a string indicating the context of\n+   the implicit conversion.  */\n \n tree\n convert_to_void (tree expr, const char *implicit, tsubst_flags_t complain)\n@@ -885,6 +888,7 @@ convert_to_void (tree expr, const char *implicit, tsubst_flags_t complain)\n                - automatic dereferencing of references, since the user cannot\n                  control it. (See also warn_if_unused_value() in stmt.c.)  */\n             if (warn_unused_value\n+\t\t&& implicit\n                 && (complain & tf_warning)\n                 && !TREE_NO_WARNING (expr)\n                 && !is_reference)"}, {"sha": "b5beac223bf328c185057abaeffda16f24c1fea7", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7409e5a54109beb1e249f6b25d8fae45e9c1e111/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7409e5a54109beb1e249f6b25d8fae45e9c1e111/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=7409e5a54109beb1e249f6b25d8fae45e9c1e111", "patch": "@@ -1,3 +1,8 @@\n+2009-04-27  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR c++/39875\n+\t* g++.dg/warn/Wunused-15.C: New test.\n+\n 2009-04-26  Michael Matz  <matz@suse.de>\n \n \tExpand from SSA."}, {"sha": "efaebc006e8353de401191d4a06e4836f8ff0885", "filename": "gcc/testsuite/g++.dg/warn/Wunused-15.C", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7409e5a54109beb1e249f6b25d8fae45e9c1e111/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWunused-15.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7409e5a54109beb1e249f6b25d8fae45e9c1e111/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWunused-15.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWunused-15.C?ref=7409e5a54109beb1e249f6b25d8fae45e9c1e111", "patch": "@@ -0,0 +1,11 @@\n+// PR c++/39875\n+// { dg-do compile }\n+// { dg-options \"-Wunused-value\" }\n+\n+int *i;\n+void\n+foo ()\n+{\n+  *i++;\t\t// { dg-warning \"value computed is not used\" }\n+  (void) *i++;\t// { dg-bogus \"value computed is not used\" }\n+}"}]}