{"sha": "8be6ada8faac0f530f03a3694b2c65ce49d8f35d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OGJlNmFkYThmYWFjMGY1MzBmMDNhMzY5NGIyYzY1Y2U0OWQ4ZjM1ZA==", "commit": {"author": {"name": "Bernd Schmidt", "email": "bernd.schmidt@analog.com", "date": "2009-09-14T12:05:42Z"}, "committer": {"name": "Bernd Schmidt", "email": "bernds@gcc.gnu.org", "date": "2009-09-14T12:05:42Z"}, "message": "gcc/\n\tFrom Jie Zhang <jie.zhang@analog.com>:\n\t* config/bfin/bfin.c (bfin_expand_prologue): Ask do_link to\n\tsave FP and RETS with saveall attribute.\n\t(bfin_expand_epilogue): Ask do_unlink to restore FP and RETS\n\twith saveall attribute.\n\ngcc/testsuite/\n\tFrom Jie Zhang <jie.zhang@analog.com>:\n\t* gcc.target/bfin/saveall.c: New test.\n\nFrom-SVN: r151686", "tree": {"sha": "6c07f1bebbc526082b5deace080ae0d63dadff12", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6c07f1bebbc526082b5deace080ae0d63dadff12"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8be6ada8faac0f530f03a3694b2c65ce49d8f35d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8be6ada8faac0f530f03a3694b2c65ce49d8f35d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8be6ada8faac0f530f03a3694b2c65ce49d8f35d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8be6ada8faac0f530f03a3694b2c65ce49d8f35d/comments", "author": null, "committer": null, "parents": [{"sha": "49caeea1b05c9ebf3f51a719143c49bd05ba2ed5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/49caeea1b05c9ebf3f51a719143c49bd05ba2ed5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/49caeea1b05c9ebf3f51a719143c49bd05ba2ed5"}], "stats": {"total": 29, "additions": 27, "deletions": 2}, "files": [{"sha": "5e590eedbcdc9c4f682079d695161239be5bc4e5", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8be6ada8faac0f530f03a3694b2c65ce49d8f35d/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8be6ada8faac0f530f03a3694b2c65ce49d8f35d/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=8be6ada8faac0f530f03a3694b2c65ce49d8f35d", "patch": "@@ -3,6 +3,12 @@\n \t* config/bfin/bfin.c (bfin_longcall_p): Don't use short calls for weak\n \tsymbols.\n \n+\tFrom Jie Zhang <jie.zhang@analog.com>:\n+\t* config/bfin/bfin.c (bfin_expand_prologue): Ask do_link to\n+\tsave FP and RETS with saveall attribute.\n+\t(bfin_expand_epilogue): Ask do_unlink to restore FP and RETS\n+\twith saveall attribute.\n+\n 2009-09-14  Richard Guenther  <rguenther@suse.de>\n \n \tPR middle-end/41350"}, {"sha": "744ad3dbe6cf800659bb6286e9a4b29f86ae7259", "filename": "gcc/config/bfin/bfin.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8be6ada8faac0f530f03a3694b2c65ce49d8f35d/gcc%2Fconfig%2Fbfin%2Fbfin.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8be6ada8faac0f530f03a3694b2c65ce49d8f35d/gcc%2Fconfig%2Fbfin%2Fbfin.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fbfin%2Fbfin.c?ref=8be6ada8faac0f530f03a3694b2c65ce49d8f35d", "patch": "@@ -1396,7 +1396,7 @@ bfin_expand_prologue (void)\n     }\n   expand_prologue_reg_save (spreg, all, false);\n \n-  do_link (spreg, frame_size, false);\n+  do_link (spreg, frame_size, all);\n \n   if (TARGET_ID_SHARED_LIBRARY\n       && !TARGET_SEP_DATA\n@@ -1425,7 +1425,7 @@ bfin_expand_epilogue (int need_return, int eh_return, bool sibcall_p)\n       return;\n     }\n \n-  do_unlink (spreg, get_frame_size (), false, e);\n+  do_unlink (spreg, get_frame_size (), all, e);\n \n   expand_epilogue_reg_restore (spreg, all, false);\n "}, {"sha": "d2f7d5479f74036a834408ff7e357992b9dab574", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8be6ada8faac0f530f03a3694b2c65ce49d8f35d/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8be6ada8faac0f530f03a3694b2c65ce49d8f35d/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=8be6ada8faac0f530f03a3694b2c65ce49d8f35d", "patch": "@@ -1,3 +1,8 @@\n+2009-09-14  Bernd Schmidt  <bernd.schmidt@analog.com>\n+\n+\tFrom Jie Zhang <jie.zhang@analog.com>:\n+\t* gcc.target/bfin/saveall.c: New test.\n+\n 2009-09-14  Andrew Stubbs  <ams@codesourcery.com>\n \n \t* gcc.target/sh/20080410-1.c: Remove obsolete -fira option."}, {"sha": "19f9decd74d64e2aa40c62d3360703ae20e0f765", "filename": "gcc/testsuite/gcc.target/bfin/saveall.c", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8be6ada8faac0f530f03a3694b2c65ce49d8f35d/gcc%2Ftestsuite%2Fgcc.target%2Fbfin%2Fsaveall.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8be6ada8faac0f530f03a3694b2c65ce49d8f35d/gcc%2Ftestsuite%2Fgcc.target%2Fbfin%2Fsaveall.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fbfin%2Fsaveall.c?ref=8be6ada8faac0f530f03a3694b2c65ce49d8f35d", "patch": "@@ -0,0 +1,14 @@\n+/* { dg-do run { target bfin*-*-* } } */\n+/* { dg-options \"-fomit-frame-pointer\" } */\n+\n+void foo (void) __attribute__ ((saveall));\n+void foo ()\n+{\n+  asm (\"R0 = 0; RETS = R0;\");\n+}\n+\n+int main ()\n+{\n+  foo ();\n+  return 0;\n+}"}]}