{"sha": "d579e2e76f9469e1b386d693af57c5c4f0ede410", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDU3OWUyZTc2Zjk0NjllMWIzODZkNjkzYWY1N2M1YzRmMGVkZTQxMA==", "commit": {"author": {"name": "Tobias Burnus", "email": "tobias@codesourcery.com", "date": "2021-03-29T08:38:39Z"}, "committer": {"name": "Tobias Burnus", "email": "tobias@codesourcery.com", "date": "2021-03-29T08:40:38Z"}, "message": "libgomp: Fix on_device_arch.c aux-file handling [PR99555]\n\nlibgomp/ChangeLog:\n\n\tPR target/99555\n\t* testsuite/lib/on_device_arch.c: Move to ...\n\t* testsuite/libgomp.c-c++-common/on_device_arch.h: ... here.\n\t* testsuite/libgomp.fortran/on_device_arch.c: New file;\n\t#include on_device_arch.h.\n\t* testsuite/libgomp.c-c++-common/task-detach-6.c: #include\n\ton_device_arch.h instead of using dg-additional-source.\n\t* testsuite/libgomp.c/pr99555-1.c: Likewise.\n\t* testsuite/libgomp.fortran/task-detach-6.f90: Update to use\n\ton_device_arch.c without relative paths.", "tree": {"sha": "318d1547f457f8f844d200e37fb63f3795241500", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/318d1547f457f8f844d200e37fb63f3795241500"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d579e2e76f9469e1b386d693af57c5c4f0ede410", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d579e2e76f9469e1b386d693af57c5c4f0ede410", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d579e2e76f9469e1b386d693af57c5c4f0ede410", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d579e2e76f9469e1b386d693af57c5c4f0ede410/comments", "author": {"login": "tob2", "id": 264461, "node_id": "MDQ6VXNlcjI2NDQ2MQ==", "avatar_url": "https://avatars.githubusercontent.com/u/264461?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tob2", "html_url": "https://github.com/tob2", "followers_url": "https://api.github.com/users/tob2/followers", "following_url": "https://api.github.com/users/tob2/following{/other_user}", "gists_url": "https://api.github.com/users/tob2/gists{/gist_id}", "starred_url": "https://api.github.com/users/tob2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tob2/subscriptions", "organizations_url": "https://api.github.com/users/tob2/orgs", "repos_url": "https://api.github.com/users/tob2/repos", "events_url": "https://api.github.com/users/tob2/events{/privacy}", "received_events_url": "https://api.github.com/users/tob2/received_events", "type": "User", "site_admin": false}, "committer": {"login": "tob2", "id": 264461, "node_id": "MDQ6VXNlcjI2NDQ2MQ==", "avatar_url": "https://avatars.githubusercontent.com/u/264461?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tob2", "html_url": "https://github.com/tob2", "followers_url": "https://api.github.com/users/tob2/followers", "following_url": "https://api.github.com/users/tob2/following{/other_user}", "gists_url": "https://api.github.com/users/tob2/gists{/gist_id}", "starred_url": "https://api.github.com/users/tob2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tob2/subscriptions", "organizations_url": "https://api.github.com/users/tob2/orgs", "repos_url": "https://api.github.com/users/tob2/repos", "events_url": "https://api.github.com/users/tob2/events{/privacy}", "received_events_url": "https://api.github.com/users/tob2/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c411011287f707d42fd582a01de2ed0d36867211", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c411011287f707d42fd582a01de2ed0d36867211", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c411011287f707d42fd582a01de2ed0d36867211"}], "stats": {"total": 12, "additions": 6, "deletions": 6}, "files": [{"sha": "1c0753c318149cbd0384e2ec35a11321b2f29c8f", "filename": "libgomp/testsuite/libgomp.c-c++-common/on_device_arch.h", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d579e2e76f9469e1b386d693af57c5c4f0ede410/libgomp%2Ftestsuite%2Flibgomp.c-c%2B%2B-common%2Fon_device_arch.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d579e2e76f9469e1b386d693af57c5c4f0ede410/libgomp%2Ftestsuite%2Flibgomp.c-c%2B%2B-common%2Fon_device_arch.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Ftestsuite%2Flibgomp.c-c%2B%2B-common%2Fon_device_arch.h?ref=d579e2e76f9469e1b386d693af57c5c4f0ede410", "previous_filename": "libgomp/testsuite/lib/on_device_arch.c"}, {"sha": "119d7f52f8fc86613b44f913f8289f632eb7f230", "filename": "libgomp/testsuite/libgomp.c-c++-common/task-detach-6.c", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d579e2e76f9469e1b386d693af57c5c4f0ede410/libgomp%2Ftestsuite%2Flibgomp.c-c%2B%2B-common%2Ftask-detach-6.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d579e2e76f9469e1b386d693af57c5c4f0ede410/libgomp%2Ftestsuite%2Flibgomp.c-c%2B%2B-common%2Ftask-detach-6.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Ftestsuite%2Flibgomp.c-c%2B%2B-common%2Ftask-detach-6.c?ref=d579e2e76f9469e1b386d693af57c5c4f0ede410", "patch": "@@ -1,10 +1,8 @@\n /* { dg-do run } */\n \n-/* { dg-additional-sources \"../lib/on_device_arch.c\" } */\n-extern int on_device_arch_nvptx ();\n-\n #include <omp.h>\n #include <assert.h>\n+#include \"on_device_arch.h\"\n \n /* Test tasks with detach clause on an offload device.  Each device\n    thread spawns off a chain of tasks, that can then be executed by"}, {"sha": "0dc17bfa3371bf06403c20f0446eaa837aa470e2", "filename": "libgomp/testsuite/libgomp.c/pr99555-1.c", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d579e2e76f9469e1b386d693af57c5c4f0ede410/libgomp%2Ftestsuite%2Flibgomp.c%2Fpr99555-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d579e2e76f9469e1b386d693af57c5c4f0ede410/libgomp%2Ftestsuite%2Flibgomp.c%2Fpr99555-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Ftestsuite%2Flibgomp.c%2Fpr99555-1.c?ref=d579e2e76f9469e1b386d693af57c5c4f0ede410", "patch": "@@ -2,8 +2,7 @@\n \n // { dg-additional-options \"-O0\" }\n \n-// { dg-additional-sources \"../lib/on_device_arch.c\" }\n-extern int on_device_arch_nvptx ();\n+#include \"../libgomp.c-c++-common/on_device_arch.h\"\n \n int main (void)\n {"}, {"sha": "98822c4b04365680fcd014cda5897eb62796763c", "filename": "libgomp/testsuite/libgomp.fortran/on_device_arch.c", "status": "added", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d579e2e76f9469e1b386d693af57c5c4f0ede410/libgomp%2Ftestsuite%2Flibgomp.fortran%2Fon_device_arch.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d579e2e76f9469e1b386d693af57c5c4f0ede410/libgomp%2Ftestsuite%2Flibgomp.fortran%2Fon_device_arch.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Ftestsuite%2Flibgomp.fortran%2Fon_device_arch.c?ref=d579e2e76f9469e1b386d693af57c5c4f0ede410", "patch": "@@ -0,0 +1,3 @@\n+/* Auxiliar file.  */\n+/* { dg-do compile  { target skip-all-targets } } */\n+#include \"../libgomp.c-c++-common/on_device_arch.h\""}, {"sha": "bd0beb6317909132d540a3838b611e120e24d2f5", "filename": "libgomp/testsuite/libgomp.fortran/task-detach-6.f90", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d579e2e76f9469e1b386d693af57c5c4f0ede410/libgomp%2Ftestsuite%2Flibgomp.fortran%2Ftask-detach-6.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d579e2e76f9469e1b386d693af57c5c4f0ede410/libgomp%2Ftestsuite%2Flibgomp.fortran%2Ftask-detach-6.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Ftestsuite%2Flibgomp.fortran%2Ftask-detach-6.f90?ref=d579e2e76f9469e1b386d693af57c5c4f0ede410", "patch": "@@ -1,6 +1,6 @@\n ! { dg-do run }\n \n-! { dg-additional-sources ../lib/on_device_arch.c }\n+! { dg-additional-sources on_device_arch.c }\n   ! { dg-prune-output \"command-line option '-fintrinsic-modules-path=.*' is valid for Fortran but not for C\" }\n \n ! Test tasks with detach clause on an offload device.  Each device"}]}