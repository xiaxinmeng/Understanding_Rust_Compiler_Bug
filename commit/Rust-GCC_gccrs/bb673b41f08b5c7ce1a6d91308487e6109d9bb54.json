{"sha": "bb673b41f08b5c7ce1a6d91308487e6109d9bb54", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmI2NzNiNDFmMDhiNWM3Y2UxYTZkOTEzMDg0ODdlNjEwOWQ5YmI1NA==", "commit": {"author": {"name": "Richard Guenther", "email": "rguenth@gcc.gnu.org", "date": "2005-05-21T12:35:55Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2005-05-21T12:35:55Z"}, "message": "tree-stdarg.c (execute_optimize_stdarg): Handle references to va_list of the form &va[0].\n\n2005-05-21  Richard Guenther  <rguenth@gcc.gnu.org>\n\n\t* tree-stdarg.c (execute_optimize_stdarg): Handle references\n\tto va_list of the form &va[0].\n\nFrom-SVN: r100043", "tree": {"sha": "073f9964a4c1cad83a1b9ebcba599d787632e79d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/073f9964a4c1cad83a1b9ebcba599d787632e79d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bb673b41f08b5c7ce1a6d91308487e6109d9bb54", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bb673b41f08b5c7ce1a6d91308487e6109d9bb54", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bb673b41f08b5c7ce1a6d91308487e6109d9bb54", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bb673b41f08b5c7ce1a6d91308487e6109d9bb54/comments", "author": null, "committer": null, "parents": [{"sha": "69a2d125d6071769f9ae2b98d35b0e2c4674d935", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/69a2d125d6071769f9ae2b98d35b0e2c4674d935", "html_url": "https://github.com/Rust-GCC/gccrs/commit/69a2d125d6071769f9ae2b98d35b0e2c4674d935"}], "stats": {"total": 29, "additions": 24, "deletions": 5}, "files": [{"sha": "e7e90f051f22120f76d25688a87484161027ba7e", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bb673b41f08b5c7ce1a6d91308487e6109d9bb54/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bb673b41f08b5c7ce1a6d91308487e6109d9bb54/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=bb673b41f08b5c7ce1a6d91308487e6109d9bb54", "patch": "@@ -1,3 +1,8 @@\n+2005-05-21  Richard Guenther  <rguenth@gcc.gnu.org>\n+\n+\t* tree-stdarg.c (execute_optimize_stdarg): Handle references\n+\tto va_list of the form &va[0].\n+\n 2005-05-20  Jan Hubicka  <jh@suse.cz>\n \n \t* Makefile.in (insn-emit.o): Add basic-block.h dependency."}, {"sha": "c0d16b1b31e8231e9156399a381e29bb010fe6ed", "filename": "gcc/tree-stdarg.c", "status": "modified", "additions": 19, "deletions": 5, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bb673b41f08b5c7ce1a6d91308487e6109d9bb54/gcc%2Ftree-stdarg.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bb673b41f08b5c7ce1a6d91308487e6109d9bb54/gcc%2Ftree-stdarg.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-stdarg.c?ref=bb673b41f08b5c7ce1a6d91308487e6109d9bb54", "patch": "@@ -660,16 +660,30 @@ execute_optimize_stdarg (void)\n \n \t  si.va_start_count++;\n \t  ap = TREE_VALUE (TREE_OPERAND (call, 1));\n-\t  if (TREE_CODE (ap) != ADDR_EXPR\n-\t      || TYPE_MAIN_VARIANT (TREE_TYPE (TREE_OPERAND (ap, 0)))\n-\t\t != TYPE_MAIN_VARIANT (va_list_type_node)\n-\t      || TREE_CODE (TREE_OPERAND (ap, 0)) != VAR_DECL)\n+\n+\t  if (TREE_CODE (ap) != ADDR_EXPR)\n \t    {\n \t      va_list_escapes = true;\n \t      break;\n \t    }\n-\n \t  ap = TREE_OPERAND (ap, 0);\n+\t  if (TREE_CODE (ap) == ARRAY_REF)\n+\t    {\n+\t      if (! integer_zerop (TREE_OPERAND (ap, 1)))\n+\t        {\n+\t          va_list_escapes = true;\n+\t          break;\n+\t\t}\n+\t      ap = TREE_OPERAND (ap, 0);\n+\t    }\n+\t  if (TYPE_MAIN_VARIANT (TREE_TYPE (ap))\n+\t      != TYPE_MAIN_VARIANT (va_list_type_node)\n+\t      || TREE_CODE (ap) != VAR_DECL)\n+\t    {\n+\t      va_list_escapes = true;\n+\t      break;\n+\t    }\n+\n \t  if (is_global_var (ap))\n \t    {\n \t      va_list_escapes = true;"}]}