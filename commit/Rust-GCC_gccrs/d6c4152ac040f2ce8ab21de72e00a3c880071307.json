{"sha": "d6c4152ac040f2ce8ab21de72e00a3c880071307", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDZjNDE1MmFjMDQwZjJjZThhYjIxZGU3MmUwMGEzYzg4MDA3MTMwNw==", "commit": {"author": {"name": "Jon Beniston", "email": "jon@beniston.com", "date": "2001-03-27T02:39:16Z"}, "committer": {"name": "Bryce McKinlay", "email": "bryce@gcc.gnu.org", "date": "2001-03-27T02:39:16Z"}, "message": "configure.in: Added X86_WIN32 target (Win32, CygWin, MingW).\n\n2001-03-27  Jon Beniston  <jon@beniston.com>\n\n\t* configure.in: Added X86_WIN32 target (Win32, CygWin, MingW).\n\t* configure: Rebuilt.\n\t* Makefile.am: Added X86_WIN32 target support.\n\t* Makefile.in: Rebuilt.\n\n\t* include/ffi.h.in: Added X86_WIN32 target support.\n\n\t* src/ffitest.c: Doesn't run structure tests for X86_WIN32 targets.\n\t* src/types.c: Added X86_WIN32 target support.\n\n\t* src/x86/win32.S: New file. Based on sysv.S, but with EH\n\tstuff removed and made to work with CygWin's gas.\n\nFrom-SVN: r40860", "tree": {"sha": "624b17833a8b4f15408d3ebc9f14aa3c486b8dad", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/624b17833a8b4f15408d3ebc9f14aa3c486b8dad"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d6c4152ac040f2ce8ab21de72e00a3c880071307", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d6c4152ac040f2ce8ab21de72e00a3c880071307", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d6c4152ac040f2ce8ab21de72e00a3c880071307", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d6c4152ac040f2ce8ab21de72e00a3c880071307/comments", "author": {"login": "srcejon", "id": 57259258, "node_id": "MDQ6VXNlcjU3MjU5MjU4", "avatar_url": "https://avatars.githubusercontent.com/u/57259258?v=4", "gravatar_id": "", "url": "https://api.github.com/users/srcejon", "html_url": "https://github.com/srcejon", "followers_url": "https://api.github.com/users/srcejon/followers", "following_url": "https://api.github.com/users/srcejon/following{/other_user}", "gists_url": "https://api.github.com/users/srcejon/gists{/gist_id}", "starred_url": "https://api.github.com/users/srcejon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/srcejon/subscriptions", "organizations_url": "https://api.github.com/users/srcejon/orgs", "repos_url": "https://api.github.com/users/srcejon/repos", "events_url": "https://api.github.com/users/srcejon/events{/privacy}", "received_events_url": "https://api.github.com/users/srcejon/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "b850de4faa9430a721ffeee7aacd968c2b1befad", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b850de4faa9430a721ffeee7aacd968c2b1befad", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b850de4faa9430a721ffeee7aacd968c2b1befad"}], "stats": {"total": 335, "additions": 265, "deletions": 70}, "files": [{"sha": "1559e39457939c21b20dfbb074d9da929ccf5f8b", "filename": "libffi/ChangeLog", "status": "modified", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d6c4152ac040f2ce8ab21de72e00a3c880071307/libffi%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d6c4152ac040f2ce8ab21de72e00a3c880071307/libffi%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2FChangeLog?ref=d6c4152ac040f2ce8ab21de72e00a3c880071307", "patch": "@@ -1,3 +1,18 @@\n+2001-03-27  Jon Beniston  <jon@beniston.com>\n+\n+\t* configure.in: Added X86_WIN32 target (Win32, CygWin, MingW).\n+\t* configure: Rebuilt.\n+\t* Makefile.am: Added X86_WIN32 target support.\n+\t* Makefile.in: Rebuilt.\n+\n+\t* include/ffi.h.in: Added X86_WIN32 target support.\n+\n+\t* src/ffitest.c: Doesn't run structure tests for X86_WIN32 targets.\n+\t* src/types.c: Added X86_WIN32 target support.\n+\n+\t* src/x86/win32.S: New file. Based on sysv.S, but with EH\n+\tstuff removed and made to work with CygWin's gas.\n+\n 2001-03-26  Bryce McKinlay  <bryce@albatross.co.nz>\n \n \t* configure.in: Make target subdirectory in build dir."}, {"sha": "b96cb3520110fca95a698886376520f8c4663c52", "filename": "libffi/Makefile.am", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d6c4152ac040f2ce8ab21de72e00a3c880071307/libffi%2FMakefile.am", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d6c4152ac040f2ce8ab21de72e00a3c880071307/libffi%2FMakefile.am", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2FMakefile.am?ref=d6c4152ac040f2ce8ab21de72e00a3c880071307", "patch": "@@ -7,7 +7,7 @@ SUBDIRS = include\n EXTRA_DIST = LICENSE ChangeLog.v1 src/mips/ffi.c src/mips/n32.S \\\n \t\tsrc/mips/n32.s src/mips/o32.S src/mips/o32.s \\\n \t\tsrc/sparc/ffi.c src/sparc/v8.S src/sparc/v9.S \\\n-\t\tsrc/x86/ffi.c src/x86/sysv.S \\\n+\t\tsrc/x86/ffi.c src/x86/sysv.S src/x86/win32.S \\\n \t\tsrc/alpha/ffi.c src/alpha/osf.S \\\n \t\tsrc/m68k/ffi.c src/m68k/sysv.S \\\n \t\tsrc/powerpc/ffi.c src/powerpc/sysv.S \\\n@@ -90,6 +90,7 @@ ffitest_LDFLAGS = -shared-libgcc\n TARGET_SRC_MIPS_GCC = src/mips/ffi.c src/mips/o32.S src/mips/n32.S\n TARGET_SRC_MIPS_SGI = src/mips/ffi.c src/mips/o32.s src/mips/n32.s\n TARGET_SRC_X86 = src/x86/ffi.c src/x86/sysv.S\n+TARGET_SRC_X86_WIN32 = src/x86/ffi.c src/x86/win32.S\n TARGET_SRC_SPARC = src/sparc/ffi.c src/sparc/v8.S src/sparc/v9.S\n TARGET_SRC_ALPHA = src/alpha/ffi.c src/alpha/osf.S\n TARGET_SRC_IA64 = src/ia64/ffi.c src/ia64/unix.S\n@@ -110,6 +111,9 @@ endif\n if X86\n libffi_la_SOURCES = $(libffi_la_common_SOURCES) $(TARGET_SRC_X86)\n endif\n+if X86_WIN32\n+libffi_la_SOURCES = $(libffi_la_common_SOURCES) $(TARGET_SRC_X86_WIN32)\n+endif\n if SPARC\n libffi_la_SOURCES = $(libffi_la_common_SOURCES) $(TARGET_SRC_SPARC)\n endif"}, {"sha": "242acc5fe517a96193710bd8e452c5cddf14f566", "filename": "libffi/Makefile.in", "status": "modified", "additions": 12, "deletions": 7, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d6c4152ac040f2ce8ab21de72e00a3c880071307/libffi%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d6c4152ac040f2ce8ab21de72e00a3c880071307/libffi%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2FMakefile.in?ref=d6c4152ac040f2ce8ab21de72e00a3c880071307", "patch": "@@ -88,7 +88,7 @@ SUBDIRS = include\n EXTRA_DIST = LICENSE ChangeLog.v1 src/mips/ffi.c src/mips/n32.S \\\n \t\tsrc/mips/n32.s src/mips/o32.S src/mips/o32.s \\\n \t\tsrc/sparc/ffi.c src/sparc/v8.S src/sparc/v9.S \\\n-\t\tsrc/x86/ffi.c src/x86/sysv.S \\\n+\t\tsrc/x86/ffi.c src/x86/sysv.S src/x86/win32.S \\\n \t\tsrc/alpha/ffi.c src/alpha/osf.S \\\n \t\tsrc/m68k/ffi.c src/m68k/sysv.S \\\n \t\tsrc/powerpc/ffi.c src/powerpc/sysv.S \\\n@@ -161,6 +161,7 @@ ffitest_LDFLAGS = -shared-libgcc\n TARGET_SRC_MIPS_GCC = src/mips/ffi.c src/mips/o32.S src/mips/n32.S\n TARGET_SRC_MIPS_SGI = src/mips/ffi.c src/mips/o32.s src/mips/n32.s\n TARGET_SRC_X86 = src/x86/ffi.c src/x86/sysv.S\n+TARGET_SRC_X86_WIN32 = src/x86/ffi.c src/x86/win32.S\n TARGET_SRC_SPARC = src/sparc/ffi.c src/sparc/v8.S src/sparc/v9.S\n TARGET_SRC_ALPHA = src/alpha/ffi.c src/alpha/osf.S\n TARGET_SRC_IA64 = src/ia64/ffi.c src/ia64/unix.S\n@@ -174,6 +175,7 @@ libffi_la_common_SOURCES = src/debug.c src/prep_cif.c src/types.c \\\n @MIPS_GCC_TRUE@libffi_la_SOURCES = @MIPS_GCC_TRUE@$(libffi_la_common_SOURCES) $(TARGET_SRC_MIPS_GCC)\n @MIPS_SGI_TRUE@libffi_la_SOURCES = @MIPS_SGI_TRUE@$(libffi_la_common_SOURCES) $(TARGET_SRC_MIPS_SGI)\n @X86_TRUE@libffi_la_SOURCES = @X86_TRUE@$(libffi_la_common_SOURCES) $(TARGET_SRC_X86)\n+@X86_WIN32_TRUE@libffi_la_SOURCES = @X86_WIN32_TRUE@$(libffi_la_common_SOURCES) $(TARGET_SRC_X86_WIN32)\n @SPARC_TRUE@libffi_la_SOURCES = @SPARC_TRUE@$(libffi_la_common_SOURCES) $(TARGET_SRC_SPARC)\n @ALPHA_TRUE@libffi_la_SOURCES = @ALPHA_TRUE@$(libffi_la_common_SOURCES) $(TARGET_SRC_ALPHA)\n @IA64_TRUE@libffi_la_SOURCES = @IA64_TRUE@$(libffi_la_common_SOURCES) $(TARGET_SRC_IA64)\n@@ -198,6 +200,12 @@ CPPFLAGS = @CPPFLAGS@\n LDFLAGS = @LDFLAGS@\n LIBS = @LIBS@\n libffi_la_LIBADD = \n+@SPARC_TRUE@libffi_la_OBJECTS =  src/debug.lo src/prep_cif.lo \\\n+@SPARC_TRUE@src/types.lo src/raw_api.lo src/java_raw_api.lo \\\n+@SPARC_TRUE@src/sparc/ffi.lo src/sparc/v8.lo src/sparc/v9.lo\n+@MIPS_SGI_TRUE@libffi_la_OBJECTS =  src/debug.lo src/prep_cif.lo \\\n+@MIPS_SGI_TRUE@src/types.lo src/raw_api.lo src/java_raw_api.lo \\\n+@MIPS_SGI_TRUE@src/mips/ffi.lo src/mips/o32.lo src/mips/n32.lo\n @IA64_TRUE@libffi_la_OBJECTS =  src/debug.lo src/prep_cif.lo \\\n @IA64_TRUE@src/types.lo src/raw_api.lo src/java_raw_api.lo \\\n @IA64_TRUE@src/ia64/ffi.lo src/ia64/unix.lo\n@@ -213,19 +221,16 @@ libffi_la_LIBADD =\n @X86_TRUE@libffi_la_OBJECTS =  src/debug.lo src/prep_cif.lo src/types.lo \\\n @X86_TRUE@src/raw_api.lo src/java_raw_api.lo src/x86/ffi.lo \\\n @X86_TRUE@src/x86/sysv.lo\n-@SPARC_TRUE@libffi_la_OBJECTS =  src/debug.lo src/prep_cif.lo \\\n-@SPARC_TRUE@src/types.lo src/raw_api.lo src/java_raw_api.lo \\\n-@SPARC_TRUE@src/sparc/ffi.lo src/sparc/v8.lo src/sparc/v9.lo\n-@MIPS_SGI_TRUE@libffi_la_OBJECTS =  src/debug.lo src/prep_cif.lo \\\n-@MIPS_SGI_TRUE@src/types.lo src/raw_api.lo src/java_raw_api.lo \\\n-@MIPS_SGI_TRUE@src/mips/ffi.lo src/mips/o32.lo src/mips/n32.lo\n @ARM_TRUE@libffi_la_OBJECTS =  src/debug.lo src/prep_cif.lo src/types.lo \\\n @ARM_TRUE@src/raw_api.lo src/java_raw_api.lo src/arm/sysv.lo \\\n @ARM_TRUE@src/arm/ffi.lo\n @POWERPC_TRUE@libffi_la_OBJECTS =  src/debug.lo src/prep_cif.lo \\\n @POWERPC_TRUE@src/types.lo src/raw_api.lo src/java_raw_api.lo \\\n @POWERPC_TRUE@src/powerpc/ffi.lo src/powerpc/sysv.lo \\\n @POWERPC_TRUE@src/powerpc/ppc_closure.lo\n+@X86_WIN32_TRUE@libffi_la_OBJECTS =  src/debug.lo src/prep_cif.lo \\\n+@X86_WIN32_TRUE@src/types.lo src/raw_api.lo src/java_raw_api.lo \\\n+@X86_WIN32_TRUE@src/x86/ffi.lo src/x86/win32.lo\n noinst_PROGRAMS =  ffitest$(EXEEXT)\n PROGRAMS =  $(noinst_PROGRAMS)\n "}, {"sha": "5124d1f5fabe9525b062507172c803569ef50594", "filename": "libffi/configure", "status": "modified", "additions": 76, "deletions": 62, "changes": 138, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d6c4152ac040f2ce8ab21de72e00a3c880071307/libffi%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d6c4152ac040f2ce8ab21de72e00a3c880071307/libffi%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2Fconfigure?ref=d6c4152ac040f2ce8ab21de72e00a3c880071307", "patch": "@@ -2367,6 +2367,9 @@ i*86-*-linux*) TARGET=X86; TARGETDIR=x86;;\n i*86-*-solaris*) TARGET=X86; TARGETDIR=x86;;\n i*86-*-beos*) TARGET=X86; TARGETDIR=x86;;\n i*86-*-freebsd*) TARGET=X86; TARGETDIR=x86;;\n+i*86-*-win32*) TARGET=X86_WIN32; TARGETDIR=x86;;\n+i*86-*-cygwin*) TARGET=X86_WIN32; TARGETDIR=x86;;\n+i*86-*-mingw*) TARGET=X86_WIN32; TARGETDIR=x86;;\n sparc-sun-4*) TARGET=SPARC; TARGETDIR=sparc;;\n sparc-sun-*) TARGET=SPARC; TARGETDIR=sparc;;\n sparc-*-linux*) TARGET=SPARC; TARGETDIR=sparc;;\n@@ -2421,6 +2424,15 @@ else\n fi\n \n \n+if test x$TARGET = xX86_WIN32; then\n+  X86_WIN32_TRUE=\n+  X86_WIN32_FALSE='#'\n+else\n+  X86_WIN32_TRUE='#'\n+  X86_WIN32_FALSE=\n+fi\n+\n+\n if test x$TARGET = xALPHA; then\n   ALPHA_TRUE=\n   ALPHA_FALSE='#'\n@@ -2466,7 +2478,7 @@ else\n fi\n \n echo $ac_n \"checking how to run the C preprocessor\"\"... $ac_c\" 1>&6\n-echo \"configure:2470: checking how to run the C preprocessor\" >&5\n+echo \"configure:2482: checking how to run the C preprocessor\" >&5\n # On Suns, sometimes $CPP names a directory.\n if test -n \"$CPP\" && test -d \"$CPP\"; then\n   CPP=\n@@ -2481,13 +2493,13 @@ else\n   # On the NeXT, cc -E runs the code through the compiler's parser,\n   # not just through cpp.\n   cat > conftest.$ac_ext <<EOF\n-#line 2485 \"configure\"\n+#line 2497 \"configure\"\n #include \"confdefs.h\"\n #include <assert.h>\n Syntax Error\n EOF\n ac_try=\"$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out\"\n-{ (eval echo configure:2491: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n+{ (eval echo configure:2503: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n ac_err=`grep -v '^ *+' conftest.out | grep -v \"^conftest.${ac_ext}\\$\"`\n if test -z \"$ac_err\"; then\n   :\n@@ -2498,13 +2510,13 @@ else\n   rm -rf conftest*\n   CPP=\"${CC-cc} -E -traditional-cpp\"\n   cat > conftest.$ac_ext <<EOF\n-#line 2502 \"configure\"\n+#line 2514 \"configure\"\n #include \"confdefs.h\"\n #include <assert.h>\n Syntax Error\n EOF\n ac_try=\"$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out\"\n-{ (eval echo configure:2508: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n+{ (eval echo configure:2520: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n ac_err=`grep -v '^ *+' conftest.out | grep -v \"^conftest.${ac_ext}\\$\"`\n if test -z \"$ac_err\"; then\n   :\n@@ -2515,13 +2527,13 @@ else\n   rm -rf conftest*\n   CPP=\"${CC-cc} -nologo -E\"\n   cat > conftest.$ac_ext <<EOF\n-#line 2519 \"configure\"\n+#line 2531 \"configure\"\n #include \"confdefs.h\"\n #include <assert.h>\n Syntax Error\n EOF\n ac_try=\"$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out\"\n-{ (eval echo configure:2525: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n+{ (eval echo configure:2537: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n ac_err=`grep -v '^ *+' conftest.out | grep -v \"^conftest.${ac_ext}\\$\"`\n if test -z \"$ac_err\"; then\n   :\n@@ -2546,20 +2558,20 @@ fi\n echo \"$ac_t\"\"$CPP\" 1>&6\n \n echo $ac_n \"checking for ANSI C header files\"\"... $ac_c\" 1>&6\n-echo \"configure:2550: checking for ANSI C header files\" >&5\n+echo \"configure:2562: checking for ANSI C header files\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_header_stdc'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 2555 \"configure\"\n+#line 2567 \"configure\"\n #include \"confdefs.h\"\n #include <stdlib.h>\n #include <stdarg.h>\n #include <string.h>\n #include <float.h>\n EOF\n ac_try=\"$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out\"\n-{ (eval echo configure:2563: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n+{ (eval echo configure:2575: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n ac_err=`grep -v '^ *+' conftest.out | grep -v \"^conftest.${ac_ext}\\$\"`\n if test -z \"$ac_err\"; then\n   rm -rf conftest*\n@@ -2576,7 +2588,7 @@ rm -f conftest*\n if test $ac_cv_header_stdc = yes; then\n   # SunOS 4.x string.h does not declare mem*, contrary to ANSI.\n cat > conftest.$ac_ext <<EOF\n-#line 2580 \"configure\"\n+#line 2592 \"configure\"\n #include \"confdefs.h\"\n #include <string.h>\n EOF\n@@ -2594,7 +2606,7 @@ fi\n if test $ac_cv_header_stdc = yes; then\n   # ISC 2.0.2 stdlib.h does not declare free, contrary to ANSI.\n cat > conftest.$ac_ext <<EOF\n-#line 2598 \"configure\"\n+#line 2610 \"configure\"\n #include \"confdefs.h\"\n #include <stdlib.h>\n EOF\n@@ -2615,7 +2627,7 @@ if test \"$cross_compiling\" = yes; then\n   :\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 2619 \"configure\"\n+#line 2631 \"configure\"\n #include \"confdefs.h\"\n #include <ctype.h>\n #define ISLOWER(c) ('a' <= (c) && (c) <= 'z')\n@@ -2626,7 +2638,7 @@ if (XOR (islower (i), ISLOWER (i)) || toupper (i) != TOUPPER (i)) exit(2);\n exit (0); }\n \n EOF\n-if { (eval echo configure:2630: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n+if { (eval echo configure:2642: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n then\n   :\n else\n@@ -2652,12 +2664,12 @@ fi\n for ac_func in memcpy\n do\n echo $ac_n \"checking for $ac_func\"\"... $ac_c\" 1>&6\n-echo \"configure:2656: checking for $ac_func\" >&5\n+echo \"configure:2668: checking for $ac_func\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_func_$ac_func'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 2661 \"configure\"\n+#line 2673 \"configure\"\n #include \"confdefs.h\"\n /* System header to define __stub macros and hopefully few prototypes,\n     which can conflict with char $ac_func(); below.  */\n@@ -2680,7 +2692,7 @@ $ac_func();\n \n ; return 0; }\n EOF\n-if { (eval echo configure:2684: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo configure:2696: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n   eval \"ac_cv_func_$ac_func=yes\"\n else\n@@ -2707,19 +2719,19 @@ done\n # The Ultrix 4.2 mips builtin alloca declared by alloca.h only works\n # for constant arguments.  Useless!\n echo $ac_n \"checking for working alloca.h\"\"... $ac_c\" 1>&6\n-echo \"configure:2711: checking for working alloca.h\" >&5\n+echo \"configure:2723: checking for working alloca.h\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_header_alloca_h'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 2716 \"configure\"\n+#line 2728 \"configure\"\n #include \"confdefs.h\"\n #include <alloca.h>\n int main() {\n char *p = alloca(2 * sizeof(int));\n ; return 0; }\n EOF\n-if { (eval echo configure:2723: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo configure:2735: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n   ac_cv_header_alloca_h=yes\n else\n@@ -2740,12 +2752,12 @@ EOF\n fi\n \n echo $ac_n \"checking for alloca\"\"... $ac_c\" 1>&6\n-echo \"configure:2744: checking for alloca\" >&5\n+echo \"configure:2756: checking for alloca\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_func_alloca_works'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 2749 \"configure\"\n+#line 2761 \"configure\"\n #include \"confdefs.h\"\n \n #ifdef __GNUC__\n@@ -2773,7 +2785,7 @@ int main() {\n char *p = (char *) alloca(1);\n ; return 0; }\n EOF\n-if { (eval echo configure:2777: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo configure:2789: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n   ac_cv_func_alloca_works=yes\n else\n@@ -2805,12 +2817,12 @@ EOF\n \n \n echo $ac_n \"checking whether alloca needs Cray hooks\"\"... $ac_c\" 1>&6\n-echo \"configure:2809: checking whether alloca needs Cray hooks\" >&5\n+echo \"configure:2821: checking whether alloca needs Cray hooks\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_os_cray'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 2814 \"configure\"\n+#line 2826 \"configure\"\n #include \"confdefs.h\"\n #if defined(CRAY) && ! defined(CRAY2)\n webecray\n@@ -2835,12 +2847,12 @@ echo \"$ac_t\"\"$ac_cv_os_cray\" 1>&6\n if test $ac_cv_os_cray = yes; then\n for ac_func in _getb67 GETB67 getb67; do\n   echo $ac_n \"checking for $ac_func\"\"... $ac_c\" 1>&6\n-echo \"configure:2839: checking for $ac_func\" >&5\n+echo \"configure:2851: checking for $ac_func\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_func_$ac_func'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 2844 \"configure\"\n+#line 2856 \"configure\"\n #include \"confdefs.h\"\n /* System header to define __stub macros and hopefully few prototypes,\n     which can conflict with char $ac_func(); below.  */\n@@ -2863,7 +2875,7 @@ $ac_func();\n \n ; return 0; }\n EOF\n-if { (eval echo configure:2867: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo configure:2879: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n   eval \"ac_cv_func_$ac_func=yes\"\n else\n@@ -2890,15 +2902,15 @@ done\n fi\n \n echo $ac_n \"checking stack direction for C alloca\"\"... $ac_c\" 1>&6\n-echo \"configure:2894: checking stack direction for C alloca\" >&5\n+echo \"configure:2906: checking stack direction for C alloca\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_c_stack_direction'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   if test \"$cross_compiling\" = yes; then\n   ac_cv_c_stack_direction=0\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 2902 \"configure\"\n+#line 2914 \"configure\"\n #include \"confdefs.h\"\n find_stack_direction ()\n {\n@@ -2917,7 +2929,7 @@ main ()\n   exit (find_stack_direction() < 0);\n }\n EOF\n-if { (eval echo configure:2921: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n+if { (eval echo configure:2933: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n then\n   ac_cv_c_stack_direction=1\n else\n@@ -2940,15 +2952,15 @@ fi\n \n \n echo $ac_n \"checking size of short\"\"... $ac_c\" 1>&6\n-echo \"configure:2944: checking size of short\" >&5\n+echo \"configure:2956: checking size of short\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_sizeof_short'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   if test \"$cross_compiling\" = yes; then\n     { echo \"configure: error: can not run test program while cross compiling\" 1>&2; exit 1; }\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 2952 \"configure\"\n+#line 2964 \"configure\"\n #include \"confdefs.h\"\n #include <stdio.h>\n main()\n@@ -2959,7 +2971,7 @@ main()\n   exit(0);\n }\n EOF\n-if { (eval echo configure:2963: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n+if { (eval echo configure:2975: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n then\n   ac_cv_sizeof_short=`cat conftestval`\n else\n@@ -2979,15 +2991,15 @@ EOF\n \n \n echo $ac_n \"checking size of int\"\"... $ac_c\" 1>&6\n-echo \"configure:2983: checking size of int\" >&5\n+echo \"configure:2995: checking size of int\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_sizeof_int'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   if test \"$cross_compiling\" = yes; then\n     { echo \"configure: error: can not run test program while cross compiling\" 1>&2; exit 1; }\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 2991 \"configure\"\n+#line 3003 \"configure\"\n #include \"confdefs.h\"\n #include <stdio.h>\n main()\n@@ -2998,7 +3010,7 @@ main()\n   exit(0);\n }\n EOF\n-if { (eval echo configure:3002: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n+if { (eval echo configure:3014: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n then\n   ac_cv_sizeof_int=`cat conftestval`\n else\n@@ -3018,15 +3030,15 @@ EOF\n \n \n echo $ac_n \"checking size of long\"\"... $ac_c\" 1>&6\n-echo \"configure:3022: checking size of long\" >&5\n+echo \"configure:3034: checking size of long\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_sizeof_long'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   if test \"$cross_compiling\" = yes; then\n     { echo \"configure: error: can not run test program while cross compiling\" 1>&2; exit 1; }\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 3030 \"configure\"\n+#line 3042 \"configure\"\n #include \"confdefs.h\"\n #include <stdio.h>\n main()\n@@ -3037,7 +3049,7 @@ main()\n   exit(0);\n }\n EOF\n-if { (eval echo configure:3041: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n+if { (eval echo configure:3053: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n then\n   ac_cv_sizeof_long=`cat conftestval`\n else\n@@ -3057,15 +3069,15 @@ EOF\n \n \n echo $ac_n \"checking size of long long\"\"... $ac_c\" 1>&6\n-echo \"configure:3061: checking size of long long\" >&5\n+echo \"configure:3073: checking size of long long\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_sizeof_long_long'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   if test \"$cross_compiling\" = yes; then\n     { echo \"configure: error: can not run test program while cross compiling\" 1>&2; exit 1; }\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 3069 \"configure\"\n+#line 3081 \"configure\"\n #include \"confdefs.h\"\n #include <stdio.h>\n main()\n@@ -3076,7 +3088,7 @@ main()\n   exit(0);\n }\n EOF\n-if { (eval echo configure:3080: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n+if { (eval echo configure:3092: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n then\n   ac_cv_sizeof_long_long=`cat conftestval`\n else\n@@ -3096,15 +3108,15 @@ EOF\n \n \n echo $ac_n \"checking size of float\"\"... $ac_c\" 1>&6\n-echo \"configure:3100: checking size of float\" >&5\n+echo \"configure:3112: checking size of float\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_sizeof_float'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   if test \"$cross_compiling\" = yes; then\n     { echo \"configure: error: can not run test program while cross compiling\" 1>&2; exit 1; }\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 3108 \"configure\"\n+#line 3120 \"configure\"\n #include \"confdefs.h\"\n #include <stdio.h>\n main()\n@@ -3115,7 +3127,7 @@ main()\n   exit(0);\n }\n EOF\n-if { (eval echo configure:3119: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n+if { (eval echo configure:3131: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n then\n   ac_cv_sizeof_float=`cat conftestval`\n else\n@@ -3135,15 +3147,15 @@ EOF\n \n \n echo $ac_n \"checking size of double\"\"... $ac_c\" 1>&6\n-echo \"configure:3139: checking size of double\" >&5\n+echo \"configure:3151: checking size of double\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_sizeof_double'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   if test \"$cross_compiling\" = yes; then\n     { echo \"configure: error: can not run test program while cross compiling\" 1>&2; exit 1; }\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 3147 \"configure\"\n+#line 3159 \"configure\"\n #include \"confdefs.h\"\n #include <stdio.h>\n main()\n@@ -3154,7 +3166,7 @@ main()\n   exit(0);\n }\n EOF\n-if { (eval echo configure:3158: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n+if { (eval echo configure:3170: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n then\n   ac_cv_sizeof_double=`cat conftestval`\n else\n@@ -3174,15 +3186,15 @@ EOF\n \n \n echo $ac_n \"checking size of long double\"\"... $ac_c\" 1>&6\n-echo \"configure:3178: checking size of long double\" >&5\n+echo \"configure:3190: checking size of long double\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_sizeof_long_double'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   if test \"$cross_compiling\" = yes; then\n     { echo \"configure: error: can not run test program while cross compiling\" 1>&2; exit 1; }\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 3186 \"configure\"\n+#line 3198 \"configure\"\n #include \"confdefs.h\"\n #include <stdio.h>\n main()\n@@ -3193,7 +3205,7 @@ main()\n   exit(0);\n }\n EOF\n-if { (eval echo configure:3197: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n+if { (eval echo configure:3209: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n then\n   ac_cv_sizeof_long_double=`cat conftestval`\n else\n@@ -3214,15 +3226,15 @@ EOF\n \n \n echo $ac_n \"checking size of void *\"\"... $ac_c\" 1>&6\n-echo \"configure:3218: checking size of void *\" >&5\n+echo \"configure:3230: checking size of void *\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_sizeof_void_p'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   if test \"$cross_compiling\" = yes; then\n     { echo \"configure: error: can not run test program while cross compiling\" 1>&2; exit 1; }\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 3226 \"configure\"\n+#line 3238 \"configure\"\n #include \"confdefs.h\"\n #include <stdio.h>\n main()\n@@ -3233,7 +3245,7 @@ main()\n   exit(0);\n }\n EOF\n-if { (eval echo configure:3237: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n+if { (eval echo configure:3249: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n then\n   ac_cv_sizeof_void_p=`cat conftestval`\n else\n@@ -3253,14 +3265,14 @@ EOF\n \n \n echo $ac_n \"checking whether byte ordering is bigendian\"\"... $ac_c\" 1>&6\n-echo \"configure:3257: checking whether byte ordering is bigendian\" >&5\n+echo \"configure:3269: checking whether byte ordering is bigendian\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_c_bigendian'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   ac_cv_c_bigendian=unknown\n # See if sys/param.h defines the BYTE_ORDER macro.\n cat > conftest.$ac_ext <<EOF\n-#line 3264 \"configure\"\n+#line 3276 \"configure\"\n #include \"confdefs.h\"\n #include <sys/types.h>\n #include <sys/param.h>\n@@ -3271,11 +3283,11 @@ int main() {\n #endif\n ; return 0; }\n EOF\n-if { (eval echo configure:3275: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; }; then\n+if { (eval echo configure:3287: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; }; then\n   rm -rf conftest*\n   # It does; now see whether it defined to BIG_ENDIAN or not.\n cat > conftest.$ac_ext <<EOF\n-#line 3279 \"configure\"\n+#line 3291 \"configure\"\n #include \"confdefs.h\"\n #include <sys/types.h>\n #include <sys/param.h>\n@@ -3286,7 +3298,7 @@ int main() {\n #endif\n ; return 0; }\n EOF\n-if { (eval echo configure:3290: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; }; then\n+if { (eval echo configure:3302: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; }; then\n   rm -rf conftest*\n   ac_cv_c_bigendian=yes\n else\n@@ -3306,7 +3318,7 @@ if test \"$cross_compiling\" = yes; then\n     { echo \"configure: error: can not run test program while cross compiling\" 1>&2; exit 1; }\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 3310 \"configure\"\n+#line 3322 \"configure\"\n #include \"confdefs.h\"\n main () {\n   /* Are we little or big endian?  From Harbison&Steele.  */\n@@ -3319,7 +3331,7 @@ main () {\n   exit (u.c[sizeof (long) - 1] == 1);\n }\n EOF\n-if { (eval echo configure:3323: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n+if { (eval echo configure:3335: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n then\n   ac_cv_c_bigendian=no\n else\n@@ -3577,6 +3589,8 @@ s%@SPARC_TRUE@%$SPARC_TRUE%g\n s%@SPARC_FALSE@%$SPARC_FALSE%g\n s%@X86_TRUE@%$X86_TRUE%g\n s%@X86_FALSE@%$X86_FALSE%g\n+s%@X86_WIN32_TRUE@%$X86_WIN32_TRUE%g\n+s%@X86_WIN32_FALSE@%$X86_WIN32_FALSE%g\n s%@ALPHA_TRUE@%$ALPHA_TRUE%g\n s%@ALPHA_FALSE@%$ALPHA_FALSE%g\n s%@IA64_TRUE@%$IA64_TRUE%g"}, {"sha": "e7af4785302e56c0d865238c70b436de9bed0abd", "filename": "libffi/configure.in", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d6c4152ac040f2ce8ab21de72e00a3c880071307/libffi%2Fconfigure.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d6c4152ac040f2ce8ab21de72e00a3c880071307/libffi%2Fconfigure.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2Fconfigure.in?ref=d6c4152ac040f2ce8ab21de72e00a3c880071307", "patch": "@@ -51,6 +51,9 @@ i*86-*-linux*) TARGET=X86; TARGETDIR=x86;;\n i*86-*-solaris*) TARGET=X86; TARGETDIR=x86;;\n i*86-*-beos*) TARGET=X86; TARGETDIR=x86;;\n i*86-*-freebsd*) TARGET=X86; TARGETDIR=x86;;\n+i*86-*-win32*) TARGET=X86_WIN32; TARGETDIR=x86;;\n+i*86-*-cygwin*) TARGET=X86_WIN32; TARGETDIR=x86;;\n+i*86-*-mingw*) TARGET=X86_WIN32; TARGETDIR=x86;;\n sparc-sun-4*) TARGET=SPARC; TARGETDIR=sparc;;\n sparc-sun-*) TARGET=SPARC; TARGETDIR=sparc;;\n sparc-*-linux*) TARGET=SPARC; TARGETDIR=sparc;;\n@@ -71,6 +74,7 @@ AM_CONDITIONAL(MIPS_GCC, test ${TARGET}${ac_cv_prog_gcc} = MIPSyes)\n AM_CONDITIONAL(MIPS_SGI, test ${TARGET}${ac_cv_prog_gcc} = MIPSno)\n AM_CONDITIONAL(SPARC, test x$TARGET = xSPARC)\n AM_CONDITIONAL(X86, test x$TARGET = xX86)\n+AM_CONDITIONAL(X86_WIN32, test x$TARGET = xX86_WIN32)\n AM_CONDITIONAL(ALPHA, test x$TARGET = xALPHA)\n AM_CONDITIONAL(IA64, test x$TARGET = xIA64)\n AM_CONDITIONAL(M68K, test x$TARGET = xM68K)"}, {"sha": "1cd3524868701e1f99f2e709fe4a5507dadd4483", "filename": "libffi/include/ffi.h.in", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d6c4152ac040f2ce8ab21de72e00a3c880071307/libffi%2Finclude%2Fffi.h.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d6c4152ac040f2ce8ab21de72e00a3c880071307/libffi%2Finclude%2Fffi.h.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2Finclude%2Fffi.h.in?ref=d6c4152ac040f2ce8ab21de72e00a3c880071307", "patch": "@@ -195,6 +195,12 @@ typedef enum ffi_abi {\n   FFI_DEFAULT_ABI = FFI_SYSV,\n #endif\n \n+  /* ---- Intel x86 Win32 ---------- */\n+#ifdef X86_WIN32\n+  FFI_SYSV,\n+  FFI_DEFAULT_ABI = FFI_SYSV,\n+#endif\n+\n   /* ---- Intel ia64 ---------------- */\n #ifdef IA64\n   FFI_UNIX,   \t/* Linux and all Unix variants use the same conventions\t*/\n@@ -351,6 +357,12 @@ size_t ffi_java_raw_size (ffi_cif *cif);\n #define FFI_TRAMPOLINE_SIZE 10\n #define FFI_NATIVE_RAW_API 1\t/* and has native raw api support */\n \n+#elif defined(X86_WIN32)\n+\n+#define FFI_CLOSURES 1\t\t/* x86 supports closures */\n+#define FFI_TRAMPOLINE_SIZE 10\n+#define FFI_NATIVE_RAW_API 1\t/* and has native raw api support */\n+\n #elif defined(IA64)\n \n #define FFI_CLOSURES 1"}, {"sha": "a03f045b2fb27cb135dbdb4b3de930be1e2549b3", "filename": "libffi/src/ffitest.c", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d6c4152ac040f2ce8ab21de72e00a3c880071307/libffi%2Fsrc%2Fffitest.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d6c4152ac040f2ce8ab21de72e00a3c880071307/libffi%2Fsrc%2Fffitest.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2Fsrc%2Fffitest.c?ref=d6c4152ac040f2ce8ab21de72e00a3c880071307", "patch": "@@ -541,6 +541,8 @@ int main(/*@unused@*/ int argc, /*@unused@*/ char *argv[])\n     printf(\"%lu promotion tests run\\n\", ul);\n   }\n \n+#ifndef X86_WIN32 /* Structures dont work on Win32 */\n+\n   /* struct tests */\n   {\n     test_structure_1 ts1_arg;\n@@ -699,6 +701,10 @@ int main(/*@unused@*/ int argc, /*@unused@*/ char *argv[])\n     free (ts5_result);\n   }\n \n+#else\n+  printf(\"Structure passing doesn't work on Win32.\\n\");\n+#endif /* X86_WIN32 */\n+\n # if FFI_CLOSURES\n   /* A simple closure test */\n     {"}, {"sha": "5eba1512969f697fc92d41bf42fd16866495cdd8", "filename": "libffi/src/types.c", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d6c4152ac040f2ce8ab21de72e00a3c880071307/libffi%2Fsrc%2Ftypes.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d6c4152ac040f2ce8ab21de72e00a3c880071307/libffi%2Fsrc%2Ftypes.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2Fsrc%2Ftypes.c?ref=d6c4152ac040f2ce8ab21de72e00a3c880071307", "patch": "@@ -57,6 +57,11 @@ FFI_INTEGRAL_TYPEDEF(pointer, 4, 4, FFI_TYPE_POINTER);\n FFI_INTEGRAL_TYPEDEF(uint64, 8, 4, FFI_TYPE_UINT64);\n FFI_INTEGRAL_TYPEDEF(sint64, 8, 4, FFI_TYPE_SINT64);\n \n+#elif defined X86_WIN32\n+\n+FFI_INTEGRAL_TYPEDEF(uint64, 8, 4, FFI_TYPE_UINT64);\n+FFI_INTEGRAL_TYPEDEF(sint64, 8, 4, FFI_TYPE_SINT64);\n+\n #elif defined ARM\n \n FFI_INTEGRAL_TYPEDEF(uint64, 8, 4, FFI_TYPE_UINT64);\n@@ -80,6 +85,11 @@ FFI_INTEGRAL_TYPEDEF(sint64, 8, 8, FFI_TYPE_SINT64);\n FFI_INTEGRAL_TYPEDEF(double, 8, 4, FFI_TYPE_DOUBLE);\n FFI_INTEGRAL_TYPEDEF(longdouble, 12, 4, FFI_TYPE_LONGDOUBLE);\n \n+#elif defined X86_WIN32\n+\n+FFI_INTEGRAL_TYPEDEF(double, 8, 4, FFI_TYPE_DOUBLE);\n+FFI_INTEGRAL_TYPEDEF(longdouble, 12, 4, FFI_TYPE_LONGDOUBLE);\n+\n #elif defined ARM\n \n FFI_INTEGRAL_TYPEDEF(double, 8, 4, FFI_TYPE_DOUBLE);"}, {"sha": "520d1fc0898b048201f03c2a321c17e0efa70ce1", "filename": "libffi/src/x86/win32.S", "status": "added", "additions": 125, "deletions": 0, "changes": 125, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d6c4152ac040f2ce8ab21de72e00a3c880071307/libffi%2Fsrc%2Fx86%2Fwin32.S", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d6c4152ac040f2ce8ab21de72e00a3c880071307/libffi%2Fsrc%2Fx86%2Fwin32.S", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2Fsrc%2Fx86%2Fwin32.S?ref=d6c4152ac040f2ce8ab21de72e00a3c880071307", "patch": "@@ -0,0 +1,125 @@\n+/* -----------------------------------------------------------------------\n+   win32.S - Copyright (c) 1996, 1998, 2001  Cygnus Solutions\n+ \n+   X86 Foreign Function Interface\n+ \n+   Permission is hereby granted, free of charge, to any person obtaining\n+   a copy of this software and associated documentation files (the\n+   ``Software''), to deal in the Software without restriction, including\n+   without limitation the rights to use, copy, modify, merge, publish,\n+   distribute, sublicense, and/or sell copies of the Software, and to\n+   permit persons to whom the Software is furnished to do so, subject to\n+   the following conditions:\n+ \n+   The above copyright notice and this permission notice shall be included\n+   in all copies or substantial portions of the Software.\n+ \n+   THE SOFTWARE IS PROVIDED ``AS IS'', WITHOUT WARRANTY OF ANY KIND, EXPRESS\n+   OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n+   MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\n+   IN NO EVENT SHALL CYGNUS SOLUTIONS BE LIABLE FOR ANY CLAIM, DAMAGES OR\n+   OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,\n+   ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\n+   OTHER DEALINGS IN THE SOFTWARE.\n+   ----------------------------------------------------------------------- */\n+ \n+#define LIBFFI_ASM\n+#include <ffi.h>\n+ \n+.text\n+ \n+.globl ffi_prep_args\n+ \n+        # This assumes we are using gas.\n+        .balign 16\n+.globl _ffi_call_SYSV\n+ \n+_ffi_call_SYSV:\n+        pushl %ebp\n+        movl  %esp,%ebp\n+ \n+        # Make room for all of the new args.\n+        movl  16(%ebp),%ecx                                                     \n+        subl  %ecx,%esp\n+ \n+        movl  %esp,%eax\n+ \n+        # Place all of the ffi_prep_args in position\n+        pushl 12(%ebp)\n+        pushl %eax\n+        call  *8(%ebp)\n+ \n+        # Return stack to previous state and call the function\n+        addl  $8,%esp\n+ \n+        call  *28(%ebp)\n+ \n+        # Remove the space we pushed for the args\n+        movl  16(%ebp),%ecx\n+        addl  %ecx,%esp\n+ \n+        # Load %ecx with the return type code\n+        movl  20(%ebp),%ecx\n+ \n+        # If the return value pointer is NULL, assume no return value.\n+        cmpl  $0,24(%ebp)\n+        jne   retint\n+ \n+        # Even if there is no space for the return value, we are\n+        # obliged to handle floating-point values.\n+        cmpl  $FFI_TYPE_FLOAT,%ecx\n+        jne   noretval\n+        fstp  %st(0)\n+ \n+        jmp   epilogue\n+ \n+retint:\n+        cmpl  $FFI_TYPE_INT,%ecx\n+        jne   retfloat\n+        # Load %ecx with the pointer to storage for the return value\n+        movl  24(%ebp),%ecx\n+        movl  %eax,0(%ecx)\n+        jmp   epilogue\n+ \n+retfloat:\n+        cmpl  $FFI_TYPE_FLOAT,%ecx\n+        jne   retdouble   \n+         # Load %ecx with the pointer to storage for the return value\n+        movl  24(%ebp),%ecx\n+        fstps (%ecx)\n+        jmp   epilogue\n+ \n+retdouble:\n+        cmpl  $FFI_TYPE_DOUBLE,%ecx\n+        jne   retlongdouble\n+        # Load %ecx with the pointer to storage for the return value\n+        movl  24(%ebp),%ecx\n+        fstpl (%ecx)\n+        jmp   epilogue\n+ \n+retlongdouble:\n+        cmpl  $FFI_TYPE_LONGDOUBLE,%ecx\n+        jne   retint64\n+        # Load %ecx with the pointer to storage for the return value\n+        movl  24(%ebp),%ecx\n+        fstpt (%ecx)\n+        jmp   epilogue\n+ \n+retint64:\n+        cmpl  $FFI_TYPE_SINT64,%ecx\n+        jne   retstruct\n+        # Load %ecx with the pointer to storage for the return value\n+        movl  24(%ebp),%ecx\n+        movl  %eax,0(%ecx)\n+        movl  %edx,4(%ecx)\n+ \n+retstruct:\n+        # Nothing to do!\n+ \n+noretval:\n+epilogue:\n+        movl %ebp,%esp\n+        popl %ebp\n+        ret\n+ \n+.ffi_call_SYSV_end:"}]}