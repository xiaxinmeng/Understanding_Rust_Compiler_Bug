{"sha": "254d3f88b467dffb1c34e23aac1a96ab243550d0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjU0ZDNmODhiNDY3ZGZmYjFjMzRlMjNhYWMxYTk2YWIyNDM1NTBkMA==", "commit": {"author": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1995-08-13T22:32:16Z"}, "committer": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1995-08-13T22:32:16Z"}, "message": "(warning_with_line): New function.\n\n(trigraph_pcp): Use it, to avoid reporting line number.\n(vwarning_with_line): Don't report line number if zero.\n\nFrom-SVN: r10217", "tree": {"sha": "9b65fdbc87f3a92e093b68d0ddeab4b1bb3440fd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9b65fdbc87f3a92e093b68d0ddeab4b1bb3440fd"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/254d3f88b467dffb1c34e23aac1a96ab243550d0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/254d3f88b467dffb1c34e23aac1a96ab243550d0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/254d3f88b467dffb1c34e23aac1a96ab243550d0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/254d3f88b467dffb1c34e23aac1a96ab243550d0/comments", "author": null, "committer": null, "parents": [{"sha": "5a00de6f5251379d0883143759eae721ca99fc4d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5a00de6f5251379d0883143759eae721ca99fc4d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5a00de6f5251379d0883143759eae721ca99fc4d"}], "stats": {"total": 21, "additions": 19, "deletions": 2}, "files": [{"sha": "a1cc53e4288628d6577316aee4f59adf50b54554", "filename": "gcc/cccp.c", "status": "modified", "additions": 19, "deletions": 2, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/254d3f88b467dffb1c34e23aac1a96ab243550d0/gcc%2Fcccp.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/254d3f88b467dffb1c34e23aac1a96ab243550d0/gcc%2Fcccp.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcccp.c?ref=254d3f88b467dffb1c34e23aac1a96ab243550d0", "patch": "@@ -1157,6 +1157,7 @@ static void vwarning PROTO((char *, va_list));\n static void error_with_line PRINTF_PROTO_2((int, char *, ...));\n static void verror_with_line PROTO((int, char *, va_list));\n static void vwarning_with_line PROTO((int, char *, va_list));\n+static void warning_with_line PROTO((int, char *, ...));\n void pedwarn PRINTF_PROTO_1((char *, ...));\n void pedwarn_with_line PRINTF_PROTO_2((int, char *, ...));\n static void pedwarn_with_file_and_line PRINTF_PROTO_3((char *, int, char *, ...));\n@@ -2487,7 +2488,7 @@ trigraph_pcp (buf)\n   buf->length -= fptr - bptr;\n   buf->buf[buf->length] = '\\0';\n   if (warn_trigraphs && fptr != bptr)\n-    warning (\"%d trigraph(s) encountered\", (fptr - bptr) / 2);\n+    warning_with_line (0, \"%d trigraph(s) encountered\", (fptr - bptr) / 2);\n }\n \f\n /* Move all backslash-newline pairs out of embarrassing places.\n@@ -9002,6 +9003,22 @@ verror_with_line (line, msg, args)\n   errors++;\n }\n \n+static void\n+#if defined (__STDC__) && defined (HAVE_VPRINTF)\n+warning_with_line (int line, PRINTF_ALIST (msg))\n+#else\n+warning_with_line (line, PRINTF_ALIST (msg))\n+     int line;\n+     PRINTF_DCL (msg)\n+#endif\n+{\n+  va_list args;\n+\n+  VA_START (args, msg);\n+  vwarning_with_line (line, msg, args);\n+  va_end (args);\n+}\n+\n static void\n vwarning_with_line (line, msg, args)\n      int line;\n@@ -9026,7 +9043,7 @@ vwarning_with_line (line, msg, args)\n     }\n \n   if (ip != NULL)\n-    fprintf (stderr, \"%s:%d: \", ip->nominal_fname, line);\n+    fprintf (stderr, line ? \"%s:%d: \" : \"%s: \", ip->nominal_fname, line);\n   fprintf (stderr, \"warning: \");\n   vfprintf (stderr, msg, args);\n   fprintf (stderr, \"\\n\");"}]}