{"sha": "88962108fc1e1e59c4d3f4765cae3f28c03a7745", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODg5NjIxMDhmYzFlMWU1OWM0ZDNmNDc2NWNhZTNmMjhjMDNhNzc0NQ==", "commit": {"author": {"name": "Ralph Loader", "email": "suckfish@ihug.co.nz", "date": "2003-09-22T08:17:49Z"}, "committer": {"name": "Bryce McKinlay", "email": "bryce@gcc.gnu.org", "date": "2003-09-22T08:17:49Z"}, "message": "re PR libgcj/12350 (StringBuffer.substring handles shared flag incorrected.)\n\n2003-09-21  Ralph Loader  <suckfish@ihug.co.nz>\n\n        PR java/12350:\n        * java/lang/StringBuffer.java (substring): Fix handling of shared\n        flag.\n\n2003-09-21  Ralph Loader  <suckfish@ihug.co.nz>\n\n        PR java/12350\n        * libjava.lang/PR12350.java: New file.\n        * libjava.lang/PR12350.out: New file.\n\nFrom-SVN: r71651", "tree": {"sha": "3783116e9b94c6400adcc9ebbaeadcf6c20c8887", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3783116e9b94c6400adcc9ebbaeadcf6c20c8887"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/88962108fc1e1e59c4d3f4765cae3f28c03a7745", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/88962108fc1e1e59c4d3f4765cae3f28c03a7745", "html_url": "https://github.com/Rust-GCC/gccrs/commit/88962108fc1e1e59c4d3f4765cae3f28c03a7745", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/88962108fc1e1e59c4d3f4765cae3f28c03a7745/comments", "author": null, "committer": null, "parents": [{"sha": "b5bb72ec41b6411a5c7a1f00855cb6d743ab1b7a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b5bb72ec41b6411a5c7a1f00855cb6d743ab1b7a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b5bb72ec41b6411a5c7a1f00855cb6d743ab1b7a"}], "stats": {"total": 37, "additions": 35, "deletions": 2}, "files": [{"sha": "ac57998976ab90438dbd7065fb3235dc89f02796", "filename": "libjava/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/88962108fc1e1e59c4d3f4765cae3f28c03a7745/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/88962108fc1e1e59c4d3f4765cae3f28c03a7745/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=88962108fc1e1e59c4d3f4765cae3f28c03a7745", "patch": "@@ -1,3 +1,8 @@\n+2003-09-21  Ralph Loader  <suckfish@ihug.co.nz>\n+\n+\tPR java/12350:\n+\t* java/lang/StringBuffer.java (substring): Fix handling of shared flag.\n+\n 2003-09-22  Michael Koch  <konqueror@gmx.de>\n \n \t* jni.cc (_Jv_LookupJNIMethod): Remove workaround that should hide a"}, {"sha": "a7c2590f39ace07e95bf11b0712de27251ff851e", "filename": "libjava/java/lang/StringBuffer.java", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/88962108fc1e1e59c4d3f4765cae3f28c03a7745/libjava%2Fjava%2Flang%2FStringBuffer.java", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/88962108fc1e1e59c4d3f4765cae3f28c03a7745/libjava%2Fjava%2Flang%2FStringBuffer.java", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjava%2Flang%2FStringBuffer.java?ref=88962108fc1e1e59c4d3f4765cae3f28c03a7745", "patch": "@@ -564,8 +564,9 @@ public synchronized String substring(int beginIndex, int endIndex)\n       throw new StringIndexOutOfBoundsException();\n     if (len == 0)\n       return \"\";\n-    // Share the char[] unless 3/4 empty.\n-    shared = (len << 2) >= value.length;\n+    // Share unless substring is smaller than 1/4 of the buffer.\n+    if ((len << 2) >= value.length)\n+      shared = true;\n     // Package constructor avoids an array copy.\n     return new String(value, beginIndex, len, shared);\n   }"}, {"sha": "eccde2a1f9d56b56f2aee4117138ef69adb06e9a", "filename": "libjava/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/88962108fc1e1e59c4d3f4765cae3f28c03a7745/libjava%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/88962108fc1e1e59c4d3f4765cae3f28c03a7745/libjava%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Ftestsuite%2FChangeLog?ref=88962108fc1e1e59c4d3f4765cae3f28c03a7745", "patch": "@@ -1,3 +1,9 @@\n+2003-09-21  Ralph Loader  <suckfish@ihug.co.nz>\n+\n+\tPR java/12350\n+\t* libjava.lang/PR12350.java: New file.\n+\t* libjava.lang/PR12350.out: New file.\n+\n 2003-09-17  Ranjit Mathew  <rmathew@hotmail.com>\n \n \tPR java/9577"}, {"sha": "ded8856cf92a0b02d6a872e2314834cf7a77176f", "filename": "libjava/testsuite/libjava.lang/PR12350.java", "status": "added", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/88962108fc1e1e59c4d3f4765cae3f28c03a7745/libjava%2Ftestsuite%2Flibjava.lang%2FPR12350.java", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/88962108fc1e1e59c4d3f4765cae3f28c03a7745/libjava%2Ftestsuite%2Flibjava.lang%2FPR12350.java", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Ftestsuite%2Flibjava.lang%2FPR12350.java?ref=88962108fc1e1e59c4d3f4765cae3f28c03a7745", "patch": "@@ -0,0 +1,20 @@\n+public class PR12350\n+{\n+    static public void main (String[] ignored) throws Throwable\n+    {\n+\tStringBuffer b = new StringBuffer (\"Good string.  More than 16 chars.\");\n+\n+\t// Should cause sharing.\n+\tString s = b.toString();\n+\n+\t// Take a char by char unshared copy of s.\n+\tString t = new String (s.toCharArray());\n+\n+\tb.substring (0, 4);\t// BUG: Clears shared flag.\n+\tb.replace (0, 4, \"Bad \"); // Modifies shared data.\n+\n+\tSystem.out.println (s);\n+\tassert s.equals (t);\n+    }\n+\n+}"}, {"sha": "61dc0a6373fd5bb4f58b643fc00be317398651cc", "filename": "libjava/testsuite/libjava.lang/PR12350.out", "status": "added", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/88962108fc1e1e59c4d3f4765cae3f28c03a7745/libjava%2Ftestsuite%2Flibjava.lang%2FPR12350.out", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/88962108fc1e1e59c4d3f4765cae3f28c03a7745/libjava%2Ftestsuite%2Flibjava.lang%2FPR12350.out", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Ftestsuite%2Flibjava.lang%2FPR12350.out?ref=88962108fc1e1e59c4d3f4765cae3f28c03a7745", "patch": "@@ -0,0 +1 @@\n+Good string.  More than 16 chars."}]}