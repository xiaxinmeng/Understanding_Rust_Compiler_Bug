{"sha": "23e7aeeac72859a7bd8d73f62ea60dc18acd326e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjNlN2FlZWFjNzI4NTlhN2JkOGQ3M2Y2MmVhNjBkYzE4YWNkMzI2ZQ==", "commit": {"author": {"name": "Kenneth Zadeck", "email": "zadeck@naturalbridge.com", "date": "2007-10-09T14:00:11Z"}, "committer": {"name": "H.J. Lu", "email": "hjl@gcc.gnu.org", "date": "2007-10-09T14:00:11Z"}, "message": "re PR rtl-optimization/33669 (Revision 128957 miscompiles 481.wrf)\n\ngcc/\n\n2007-10-09  Kenneth Zadeck <zadeck@naturalbridge.com>\n\n\tPR middle-end/33669\n\t* ra-conflict.c (record_one_conflict_between_regnos,\n\tset_conflicts_for_earlyclobber, global_conflicts): Improved\n\tlogging.\n\t(global_conflicts): Removed incorrect check.\n\ngcc/testsuite/\n\n2007-10-09  Kenneth Zadeck <zadeck@naturalbridge.com>\n\n\tPR middle-end/33669\n\t* gcc.c-torture/execute/pr33669.c: New.\n\nFrom-SVN: r129166", "tree": {"sha": "eeef3678f2859457c4c3866b5af872f488458bdf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/eeef3678f2859457c4c3866b5af872f488458bdf"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/23e7aeeac72859a7bd8d73f62ea60dc18acd326e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/23e7aeeac72859a7bd8d73f62ea60dc18acd326e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/23e7aeeac72859a7bd8d73f62ea60dc18acd326e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/23e7aeeac72859a7bd8d73f62ea60dc18acd326e/comments", "author": {"login": "zadeck", "id": 42682403, "node_id": "MDQ6VXNlcjQyNjgyNDAz", "avatar_url": "https://avatars.githubusercontent.com/u/42682403?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zadeck", "html_url": "https://github.com/zadeck", "followers_url": "https://api.github.com/users/zadeck/followers", "following_url": "https://api.github.com/users/zadeck/following{/other_user}", "gists_url": "https://api.github.com/users/zadeck/gists{/gist_id}", "starred_url": "https://api.github.com/users/zadeck/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zadeck/subscriptions", "organizations_url": "https://api.github.com/users/zadeck/orgs", "repos_url": "https://api.github.com/users/zadeck/repos", "events_url": "https://api.github.com/users/zadeck/events{/privacy}", "received_events_url": "https://api.github.com/users/zadeck/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "56a51b00a9168b86275a492fced5c948b575cf10", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/56a51b00a9168b86275a492fced5c948b575cf10", "html_url": "https://github.com/Rust-GCC/gccrs/commit/56a51b00a9168b86275a492fced5c948b575cf10"}], "stats": {"total": 65, "additions": 59, "deletions": 6}, "files": [{"sha": "d10a6c5bac1bef5a976ec85424018e9c4e504d2c", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/23e7aeeac72859a7bd8d73f62ea60dc18acd326e/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/23e7aeeac72859a7bd8d73f62ea60dc18acd326e/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=23e7aeeac72859a7bd8d73f62ea60dc18acd326e", "patch": "@@ -1,3 +1,11 @@\n+2007-10-09  Kenneth Zadeck <zadeck@naturalbridge.com>\n+\n+\tPR middle-end/33669\n+\t* ra-conflict.c (record_one_conflict_between_regnos,\n+\tset_conflicts_for_earlyclobber, global_conflicts): Improved\n+\tlogging.\n+\t(global_conflicts): Removed incorrect check.\n+\n 2007-10-09  Richard Sandiford  <rsandifo@nildram.co.uk>\n \n \tPR tree-optimization/33615"}, {"sha": "a18444329bec00035c1c8619b72371c3ed27d45e", "filename": "gcc/ra-conflict.c", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/23e7aeeac72859a7bd8d73f62ea60dc18acd326e/gcc%2Fra-conflict.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/23e7aeeac72859a7bd8d73f62ea60dc18acd326e/gcc%2Fra-conflict.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fra-conflict.c?ref=23e7aeeac72859a7bd8d73f62ea60dc18acd326e", "patch": "@@ -196,7 +196,7 @@ record_one_conflict_between_regnos (enum machine_mode mode1, int r1,\n   int allocno2 = reg_allocno[r2];\n \n   if (dump_file)\n-    fprintf (dump_file, \"  rocbr adding %d<=>%d\\n\", r1, r2);\n+    fprintf (dump_file, \"    rocbr adding %d<=>%d\\n\", r1, r2);\n \n   if (allocno1 >= 0 && allocno2 >= 0)\n     set_conflict (allocno1, allocno2);\n@@ -401,9 +401,6 @@ set_conflicts_for_earlyclobber (rtx insn)\n \t\t\t\t\t\t    recog_data.operand[use + 1]);\n \t\t}\n \t}\n-\n-  if (dump_file) \n-    fprintf (dump_file, \"  finished early clobber conflicts.\\n\");\n }\n \n \n@@ -983,8 +980,7 @@ global_conflicts (void)\n \t\t\tset_renumbers_live (&renumbers_live, live_subregs, live_subregs_used, \n \t\t\t\t\t    allocnum, renumber);\n \t\t    }\n-\t\t  \n-\t\t  else if (!sparseset_bit_p (allocnos_live, allocnum))\n+\t\t  else\n \t\t    {\n \t\t      if (dump_file)\n \t\t\tfprintf (dump_file, \"    dying pseudo\\n\");\n@@ -1071,6 +1067,8 @@ global_conflicts (void)\n \t\t FIXME: We should consider either adding a new kind of\n \t\t clobber, or adding a flag to the clobber distinguish\n \t\t these two cases.  */\n+\t      if (dump_file && VEC_length (df_ref_t, clobbers))\n+\t\tfprintf (dump_file, \"  clobber conflicts\\n\");\n \t      for (k = VEC_length (df_ref_t, clobbers) - 1; k >= 0; k--)\n \t\t{\n \t\t  struct df_ref *def = VEC_index (df_ref_t, clobbers, k);\n@@ -1132,6 +1130,8 @@ global_conflicts (void)\n \t      if (GET_CODE (PATTERN (insn)) == PARALLEL && multiple_sets (insn))\n \t\t{ \n \t\t  int j;\n+\t\t  if (dump_file)\n+\t\t    fprintf (dump_file, \"  multiple sets\\n\");\n \t\t  for (j = VEC_length (df_ref_t, dying_regs) - 1; j >= 0; j--)\n \t\t    {\n \t\t      int used_in_output = 0;"}, {"sha": "c37814b98eea03b1d67079773635920dab595845", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/23e7aeeac72859a7bd8d73f62ea60dc18acd326e/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/23e7aeeac72859a7bd8d73f62ea60dc18acd326e/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=23e7aeeac72859a7bd8d73f62ea60dc18acd326e", "patch": "@@ -1,3 +1,8 @@\n+2007-10-09  Kenneth Zadeck <zadeck@naturalbridge.com>\n+\n+\tPR middle-end/33669\n+\t* gcc.c-torture/execute/pr33669.c: New.\n+\n 2007-10-09  Richard Sandiford  <rsandifo@nildram.co.uk>\n \n \tPR tree-optimization/33615"}, {"sha": "69d86258d21cc27d87224c472ace54c0588d24af", "filename": "gcc/testsuite/gcc.c-torture/execute/pr33669.c", "status": "added", "additions": 40, "deletions": 0, "changes": 40, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/23e7aeeac72859a7bd8d73f62ea60dc18acd326e/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fpr33669.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/23e7aeeac72859a7bd8d73f62ea60dc18acd326e/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fpr33669.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fpr33669.c?ref=23e7aeeac72859a7bd8d73f62ea60dc18acd326e", "patch": "@@ -0,0 +1,40 @@\n+extern void abort (void);\n+\n+typedef struct foo_t\n+{ \n+  unsigned int blksz;\n+  unsigned int bf_cnt; \n+} foo_t;\n+\n+#define _RNDUP(x, unit)  ((((x) + (unit) - 1) / (unit)) * (unit))\n+#define _RNDDOWN(x, unit)  ((x) - ((x)%(unit)))\n+\n+long long\n+foo (foo_t *const pxp,  long long offset, unsigned int extent)\n+{\n+  long long blkoffset = _RNDDOWN(offset, (long long )pxp->blksz);\n+  unsigned int diff = (unsigned int)(offset - blkoffset);\n+  unsigned int blkextent = _RNDUP(diff + extent, pxp->blksz);\n+\n+  if (pxp->blksz < blkextent)\n+    return -1LL;\n+\n+  if (pxp->bf_cnt > pxp->blksz)\n+    pxp->bf_cnt = pxp->blksz;\n+\n+  return blkoffset;\n+}\n+\n+int\n+main ()\n+{\n+  foo_t x;\n+  long long xx;\n+\n+  x.blksz = 8192;\n+  x.bf_cnt = 0;\n+  xx = foo (&x, 0, 4096);\n+  if (xx != 0LL)\n+    abort ();\n+  return 0;\n+}"}]}