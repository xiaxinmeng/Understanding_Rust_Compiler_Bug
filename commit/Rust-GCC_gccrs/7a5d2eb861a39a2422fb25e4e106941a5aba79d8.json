{"sha": "7a5d2eb861a39a2422fb25e4e106941a5aba79d8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2E1ZDJlYjg2MWEzOWEyNDIyZmIyNWU0ZTEwNjk0MWE1YWJhNzlkOA==", "commit": {"author": {"name": "Ian Lance Taylor", "email": "iant@google.com", "date": "2009-06-22T16:49:03Z"}, "committer": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2009-06-22T16:49:03Z"}, "message": "linux.opt: Put mglibc ahead of muclibc.\n\n./:\t* config/linux.opt: Put mglibc ahead of muclibc.\n\n\t* c-decl.c (diagnose_mismatched_decls): Add -Wc++-compat warning\n\tfor duplicate decls.\ntestsuite/:\n\t* gcc.dg/Wcxx-compat-19.c: New testcase.\n\nFrom-SVN: r148808", "tree": {"sha": "b04b7d452e4afa1ea57eb1317a2bd224cb2ab8f4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b04b7d452e4afa1ea57eb1317a2bd224cb2ab8f4"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7a5d2eb861a39a2422fb25e4e106941a5aba79d8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7a5d2eb861a39a2422fb25e4e106941a5aba79d8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7a5d2eb861a39a2422fb25e4e106941a5aba79d8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7a5d2eb861a39a2422fb25e4e106941a5aba79d8/comments", "author": null, "committer": null, "parents": [{"sha": "86e3c83a1cc35d293f60ebd6128993b754a9e7ad", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/86e3c83a1cc35d293f60ebd6128993b754a9e7ad", "html_url": "https://github.com/Rust-GCC/gccrs/commit/86e3c83a1cc35d293f60ebd6128993b754a9e7ad"}], "stats": {"total": 54, "additions": 48, "deletions": 6}, "files": [{"sha": "769976e7e85025be90310b9b502bc0e14a7722c5", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7a5d2eb861a39a2422fb25e4e106941a5aba79d8/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7a5d2eb861a39a2422fb25e4e106941a5aba79d8/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=7a5d2eb861a39a2422fb25e4e106941a5aba79d8", "patch": "@@ -1,3 +1,10 @@\n+2009-06-22  Ian Lance Taylor  <iant@google.com>\n+\n+\t* config/linux.opt: Put mglibc ahead of muclibc.\n+\n+\t* c-decl.c (diagnose_mismatched_decls): Add -Wc++-compat warning\n+\tfor duplicate decls.\n+\n 2009-06-22  Matthias Klose  <doko@ubuntu.com>\n \n \t* Makefile.in (install-plugin): Remove extra `/' after $(DESTDIR)."}, {"sha": "5eab454e03dcd494e593f04e65a6cb3c77d93df6", "filename": "gcc/c-decl.c", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7a5d2eb861a39a2422fb25e4e106941a5aba79d8/gcc%2Fc-decl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7a5d2eb861a39a2422fb25e4e106941a5aba79d8/gcc%2Fc-decl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-decl.c?ref=7a5d2eb861a39a2422fb25e4e106941a5aba79d8", "patch": "@@ -1991,6 +1991,18 @@ diagnose_mismatched_decls (tree newdecl, tree olddecl,\n \n \t  return false;\n \t}\n+\n+      /* C++ does not permit a decl to appear multiple times at file\n+\t scope.  */\n+      if (warn_cxx_compat\n+\t  && DECL_FILE_SCOPE_P (newdecl)\n+\t  && !DECL_EXTERNAL (newdecl)\n+\t  && !DECL_EXTERNAL (olddecl))\n+\twarned |= warning_at (DECL_SOURCE_LOCATION (newdecl),\n+\t\t\t      OPT_Wc___compat,\n+\t\t\t      (\"duplicate declaration of %qD is \"\n+\t\t\t       \"invalid in C++\"),\n+\t\t\t      newdecl);\n     }\n \n   /* warnings */"}, {"sha": "a9b40f0899e548c13d41725aab1db6e55ef7694d", "filename": "gcc/config/linux.opt", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7a5d2eb861a39a2422fb25e4e106941a5aba79d8/gcc%2Fconfig%2Flinux.opt", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7a5d2eb861a39a2422fb25e4e106941a5aba79d8/gcc%2Fconfig%2Flinux.opt", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Flinux.opt?ref=7a5d2eb861a39a2422fb25e4e106941a5aba79d8", "patch": "@@ -1,6 +1,6 @@\n ; Processor-independent options for GNU/Linux.\n ;\n-; Copyright (C) 2006, 2007 Free Software Foundation, Inc.\n+; Copyright (C) 2006, 2007, 2009 Free Software Foundation, Inc.\n ; Contributed by CodeSourcery.\n ;\n ; This file is part of GCC.\n@@ -19,10 +19,10 @@\n ; along with GCC; see the file COPYING3.  If not see\n ; <http://www.gnu.org/licenses/>.\n \n-muclibc\n-Target RejectNegative Report Mask(UCLIBC) Var(linux_uclibc) Init(UCLIBC_DEFAULT ? OPTION_MASK_UCLIBC : 0)\n-Use uClibc instead of GNU libc\n-\n mglibc\n-Target RejectNegative Report InverseMask(UCLIBC, GLIBC) Var(linux_uclibc) VarExists\n+Target RejectNegative Report InverseMask(UCLIBC, GLIBC) Var(linux_uclibc) Init(UCLIBC_DEFAULT ? OPTION_MASK_UCLIBC : 0)\n Use GNU libc instead of uClibc\n+\n+muclibc\n+Target RejectNegative Report Mask(UCLIBC) Var(linux_uclibc) VarExists\n+Use uClibc instead of GNU libc"}, {"sha": "2bb9f6f8695a62834edd15d1d01c369fe4e6f9ce", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7a5d2eb861a39a2422fb25e4e106941a5aba79d8/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7a5d2eb861a39a2422fb25e4e106941a5aba79d8/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=7a5d2eb861a39a2422fb25e4e106941a5aba79d8", "patch": "@@ -1,3 +1,7 @@\n+2009-06-22  Ian Lance Taylor  <iant@google.com>\n+\n+\t* gcc.dg/Wcxx-compat-19.c: New testcase.\n+\n 2009-06-22  Matthias Klose  <doko@ubuntu.com>\n \n \tPR objc/28050"}, {"sha": "120ccf5c074bf758cf47f72e2457bea50d7681ce", "filename": "gcc/testsuite/gcc.dg/Wcxx-compat-19.c", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7a5d2eb861a39a2422fb25e4e106941a5aba79d8/gcc%2Ftestsuite%2Fgcc.dg%2FWcxx-compat-19.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7a5d2eb861a39a2422fb25e4e106941a5aba79d8/gcc%2Ftestsuite%2Fgcc.dg%2FWcxx-compat-19.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2FWcxx-compat-19.c?ref=7a5d2eb861a39a2422fb25e4e106941a5aba79d8", "patch": "@@ -0,0 +1,19 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-Wc++-compat\" } */\n+int v1;\t\t\t/* { dg-message \"previous declaration\" } */\n+int v1;\t\t\t/* { dg-warning \"invalid in C\\[+\\]\\[+\\]\" } */\n+int v2;\t\t\t/* { dg-message \"previous declaration\" } */\n+int v2 = 1;\t\t/* { dg-warning \"invalid in C\\[+\\]\\[+\\]\" } */\n+extern int v3;\n+int v3;\t\t\t/* { dg-message \"previous declaration\" } */\n+int v3 = 1;\t\t/* { dg-warning \"invalid in C\\[+\\]\\[+\\]\" } */\n+extern int v4;\n+int v4 = 1;\n+static int v5;\t\t/* { dg-message \"previous declaration\" } */\n+static int v5;\t\t/* { dg-warning \"invalid in C\\[+\\]\\[+\\]\" } */\n+static int v6;\t\t/* { dg-message \"previous declaration\" } */\n+static int v6 = 1;\t/* { dg-warning \"invalid in C\\[+\\]\\[+\\]\" } */\n+int v7;\n+extern int v7;\n+int v8 = 1;\n+extern int v8;"}]}