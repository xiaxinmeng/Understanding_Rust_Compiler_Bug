{"sha": "f1d42e85ad96f0c2977118c019a8a31e895ea1da", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjFkNDJlODVhZDk2ZjBjMjk3NzExOGMwMTlhOGEzMWU4OTVlYTFkYQ==", "commit": {"author": {"name": "Rainer Orth", "email": "ro@CeBiTec.Uni-Bielefeld.DE", "date": "2018-12-13T14:41:34Z"}, "committer": {"name": "Rainer Orth", "email": "ro@gcc.gnu.org", "date": "2018-12-13T14:41:34Z"}, "message": "Include gdc.test prefix in test names (PR testsuite/88041)\n\n\tPR testsuite/88041\n\t* lib/gdc-dg.exp (gdc-dg-test): Strip gdc.test prefix.\n\t* gdc.test/gdc-test.exp (gdc-do-test): Create $subdir link.\n\tInclude $subdir in filename.\n\tCleanup generated source.\n\t* gdc.test/compilable/ddoc9676a.d (EXTRA_SOURCES): Don't use\n\tabsolute path.\n\t* gdc.test/compilable/depsOutput9948.d: Likewise.\n\nFrom-SVN: r267094", "tree": {"sha": "00aed9b0737699d596adcaa5b77b0864c996bb87", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/00aed9b0737699d596adcaa5b77b0864c996bb87"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f1d42e85ad96f0c2977118c019a8a31e895ea1da", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f1d42e85ad96f0c2977118c019a8a31e895ea1da", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f1d42e85ad96f0c2977118c019a8a31e895ea1da", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f1d42e85ad96f0c2977118c019a8a31e895ea1da/comments", "author": {"login": "rorth", "id": 3930951, "node_id": "MDQ6VXNlcjM5MzA5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/3930951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rorth", "html_url": "https://github.com/rorth", "followers_url": "https://api.github.com/users/rorth/followers", "following_url": "https://api.github.com/users/rorth/following{/other_user}", "gists_url": "https://api.github.com/users/rorth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rorth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rorth/subscriptions", "organizations_url": "https://api.github.com/users/rorth/orgs", "repos_url": "https://api.github.com/users/rorth/repos", "events_url": "https://api.github.com/users/rorth/events{/privacy}", "received_events_url": "https://api.github.com/users/rorth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "a51f8c92e2ae4ea0ab6b83f3f9cc40b092aa99c8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a51f8c92e2ae4ea0ab6b83f3f9cc40b092aa99c8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a51f8c92e2ae4ea0ab6b83f3f9cc40b092aa99c8"}], "stats": {"total": 29, "additions": 24, "deletions": 5}, "files": [{"sha": "8957b2121fe986423638c24a8bb0c6ff16147149", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 12, "deletions": 1, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f1d42e85ad96f0c2977118c019a8a31e895ea1da/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f1d42e85ad96f0c2977118c019a8a31e895ea1da/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=f1d42e85ad96f0c2977118c019a8a31e895ea1da", "patch": "@@ -1,3 +1,14 @@\n+2018-12-13  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>\n+\n+\tPR testsuite/88041\n+\t* lib/gdc-dg.exp (gdc-dg-test): Strip gdc.test prefix.\n+\t* gdc.test/gdc-test.exp (gdc-do-test): Create $subdir link.\n+\tInclude $subdir in filename.\n+\tCleanup generated source.\n+\t* gdc.test/compilable/ddoc9676a.d (EXTRA_SOURCES): Don't use\n+\tabsolute path.\n+\t* gdc.test/compilable/depsOutput9948.d: Likewise.\n+\n 2018-12-13  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR testsuite/88454\n@@ -23,7 +34,7 @@\n \n \tPR target/88461\n \t* gcc.target/i386/pr88461.c: New test.\n-\t\n+\n 2018-12-12  Paolo Carlini  <paolo.carlini@oracle.com>\n \n \t* g++.dg/other/static5.C: New."}, {"sha": "326c2cf5325f04db12209acf2d6d9ae25d53c98f", "filename": "gcc/testsuite/gdc.test/compilable/ddoc9676a.d", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f1d42e85ad96f0c2977118c019a8a31e895ea1da/gcc%2Ftestsuite%2Fgdc.test%2Fcompilable%2Fddoc9676a.d", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f1d42e85ad96f0c2977118c019a8a31e895ea1da/gcc%2Ftestsuite%2Fgdc.test%2Fcompilable%2Fddoc9676a.d", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgdc.test%2Fcompilable%2Fddoc9676a.d?ref=f1d42e85ad96f0c2977118c019a8a31e895ea1da", "patch": "@@ -1,5 +1,5 @@\n // PERMUTE_ARGS:\n-// EXTRA_SOURCES: /extra-files/ddoc9676a.ddoc\n+// EXTRA_SOURCES: extra-files/ddoc9676a.ddoc\n // REQUIRED_ARGS: -D -Dd${RESULTS_DIR}/compilable -o-\n // POST_SCRIPT: compilable/extra-files/ddocAny-postscript.sh 9676a\n "}, {"sha": "0876094d4bbf535c2c7c3222b4b693eb8ae038c8", "filename": "gcc/testsuite/gdc.test/compilable/depsOutput9948.d", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f1d42e85ad96f0c2977118c019a8a31e895ea1da/gcc%2Ftestsuite%2Fgdc.test%2Fcompilable%2FdepsOutput9948.d", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f1d42e85ad96f0c2977118c019a8a31e895ea1da/gcc%2Ftestsuite%2Fgdc.test%2Fcompilable%2FdepsOutput9948.d", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgdc.test%2Fcompilable%2FdepsOutput9948.d?ref=f1d42e85ad96f0c2977118c019a8a31e895ea1da", "patch": "@@ -1,7 +1,7 @@\n // PERMUTE_ARGS:\n // REQUIRED_ARGS: -deps=${RESULTS_DIR}/compilable/depsOutput9948.deps\n // POST_SCRIPT: compilable/extra-files/depsOutput.sh \n-// EXTRA_SOURCES: /extra-files/depsOutput9948a.d\n+// EXTRA_SOURCES: extra-files/depsOutput9948a.d\n \n module depsOutput9948;\n import depsOutput9948a;"}, {"sha": "28f52dac23bc903bdeb880ed661c527928d1ecc3", "filename": "gcc/testsuite/gdc.test/gdc-test.exp", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f1d42e85ad96f0c2977118c019a8a31e895ea1da/gcc%2Ftestsuite%2Fgdc.test%2Fgdc-test.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f1d42e85ad96f0c2977118c019a8a31e895ea1da/gcc%2Ftestsuite%2Fgdc.test%2Fgdc-test.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgdc.test%2Fgdc-test.exp?ref=f1d42e85ad96f0c2977118c019a8a31e895ea1da", "patch": "@@ -360,6 +360,9 @@ proc gdc-do-test { } {\n     # Initialize `dg'.\n     dg-init\n \n+    # Create gdc.test link so test names include that subdir.\n+    catch { file link $subdir . }\n+\n     # Main loop.\n \n     # set verbose 1\n@@ -380,7 +383,8 @@ proc gdc-do-test { } {\n \n         # Convert to DG test.\n         set imports [format \"-I%s/%s\" $base $dir]\n-        set filename [dmd2dg $base $dir/$name.$ext]\n+        # Include $subdir prefix so test names follow DejaGnu conventions.\n+        set filename \"$subdir/[dmd2dg $base $dir/$name.$ext]\"\n \n         if { $dir == \"runnable\" } {\n             append PERMUTE_ARGS \" $SHARED_OPTION\"\n@@ -423,7 +427,7 @@ proc gdc-do-test { } {\n         }\n \n         # Cleanup\n-        #file delete $filename\n+        file delete $filename\n     }\n \n     # All done."}, {"sha": "81d404887d82640e547774719b8d2e8e4d10701e", "filename": "gcc/testsuite/lib/gdc-dg.exp", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f1d42e85ad96f0c2977118c019a8a31e895ea1da/gcc%2Ftestsuite%2Flib%2Fgdc-dg.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f1d42e85ad96f0c2977118c019a8a31e895ea1da/gcc%2Ftestsuite%2Flib%2Fgdc-dg.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Flib%2Fgdc-dg.exp?ref=f1d42e85ad96f0c2977118c019a8a31e895ea1da", "patch": "@@ -32,6 +32,10 @@ proc gdc-dg-test { prog do_what extra_tool_flags } {\n \t}\n     }\n \n+    # Strip gdc.test prefix off test names to avoid pathname failures in\n+    # some tests.\n+    set prog [dg-trim-dirname gdc.test $prog]\n+\n     set result \\\n         [gcc-dg-test-1 gdc_target_compile $prog $do_what $extra_tool_flags]\n "}]}