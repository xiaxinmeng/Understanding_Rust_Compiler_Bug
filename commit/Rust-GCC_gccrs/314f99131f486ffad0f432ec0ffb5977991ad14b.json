{"sha": "314f99131f486ffad0f432ec0ffb5977991ad14b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzE0Zjk5MTMxZjQ4NmZmYWQwZjQzMmVjMGZmYjU5Nzc5OTFhZDE0Yg==", "commit": {"author": {"name": "Bernd Schmidt", "email": "bernd.schmidt@analog.com", "date": "2007-05-03T13:17:51Z"}, "committer": {"name": "Bernd Schmidt", "email": "bernds@gcc.gnu.org", "date": "2007-05-03T13:17:51Z"}, "message": "bfin.md (addpdi3, [...]): New patterns.\n\n\t* config/bfin/bfin.md (addpdi3, us_truncpdisi2): New patterns.\n\t(umulsi3_highpart): Use them.\n\t* config/bfin/lib1funcs.asm (__umulsi3_highpart): Use unsigned move\n\tfor final accumulator to D regisster tranfser.\n\nFrom-SVN: r124376", "tree": {"sha": "b82df934a8d2b54015019c10765a1d67515d6667", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b82df934a8d2b54015019c10765a1d67515d6667"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/314f99131f486ffad0f432ec0ffb5977991ad14b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/314f99131f486ffad0f432ec0ffb5977991ad14b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/314f99131f486ffad0f432ec0ffb5977991ad14b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/314f99131f486ffad0f432ec0ffb5977991ad14b/comments", "author": null, "committer": null, "parents": [{"sha": "cb9ed5d79fe359fe089e43b3851a72e7e27c5316", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cb9ed5d79fe359fe089e43b3851a72e7e27c5316", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cb9ed5d79fe359fe089e43b3851a72e7e27c5316"}], "stats": {"total": 28, "additions": 26, "deletions": 2}, "files": [{"sha": "0d7c9ddd0d7c724a0857d58e8a85db4c1cf84aee", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/314f99131f486ffad0f432ec0ffb5977991ad14b/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/314f99131f486ffad0f432ec0ffb5977991ad14b/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=314f99131f486ffad0f432ec0ffb5977991ad14b", "patch": "@@ -1,3 +1,10 @@\n+2007-05-03  Bernd Schmidt  <bernd.schmidt@analog.com>\n+\n+\t* config/bfin/bfin.md (addpdi3, us_truncpdisi2): New patterns.\n+\t(umulsi3_highpart): Use them.\n+\t* config/bfin/lib1funcs.asm (__umulsi3_highpart): Use unsigned move\n+\tfor final accumulator to D regisster tranfser.\n+\n 2007-05-03  Dorit Nuzman  <dorit@il.ibm.com>\n \n \tPR tree-optimization/31699"}, {"sha": "217c26d7d159dad7c5a3c57e083b73518a523a19", "filename": "gcc/config/bfin/bfin.md", "status": "modified", "additions": 17, "deletions": 1, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/314f99131f486ffad0f432ec0ffb5977991ad14b/gcc%2Fconfig%2Fbfin%2Fbfin.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/314f99131f486ffad0f432ec0ffb5977991ad14b/gcc%2Fconfig%2Fbfin%2Fbfin.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fbfin%2Fbfin.md?ref=314f99131f486ffad0f432ec0ffb5977991ad14b", "patch": "@@ -1227,6 +1227,14 @@\n \n ;; Accumulator addition\n \n+(define_insn \"addpdi3\"\n+  [(set (match_operand:PDI 0 \"register_operand\" \"=A\")\n+        (ss_plus:PDI (match_operand:PDI 1 \"register_operand\" \"%0\")\n+\t\t     (match_operand:PDI 2 \"nonmemory_operand\" \"B\")))]\n+  \"\"\n+  \"A0 += A1%!\"\n+  [(set_attr \"type\" \"dsp32\")])\n+\n (define_insn \"sum_of_accumulators\"\n   [(set (match_operand:SI 0 \"register_operand\" \"=d\")\n \t(ss_truncate:SI\n@@ -1238,6 +1246,13 @@\n   \"%0 = (A0 += A1)%!\"\n   [(set_attr \"type\" \"dsp32\")])\n \n+(define_insn \"us_truncpdisi2\"\n+  [(set (match_operand:SI 0 \"register_operand\" \"=D,W\")\n+\t(us_truncate:SI (match_operand:PDI 1 \"register_operand\" \"A,B\")))]\n+  \"\"\n+  \"%0 = %1 (FU)%!\"\n+  [(set_attr \"type\" \"dsp32\")])\n+\n ;; Bit test instructions\n \n (define_insn \"*not_bittst\"\n@@ -1501,7 +1516,8 @@\n \t\t\t\t\t       const1_rtx, const0_rtx,\n \t\t\t\t\t       a1reg, const0_rtx, GEN_INT (MACFLAG_FU)));\n       emit_insn (gen_lshrpdi3 (a1reg, a1reg, GEN_INT (16)));\n-      emit_insn (gen_sum_of_accumulators (operands[0], a0reg, a0reg, a1reg));\n+      emit_insn (gen_addpdi3 (a0reg, a0reg, a1reg));\n+      emit_insn (gen_us_truncpdisi2 (operands[0], a0reg));\n     }\n   else\n     {"}, {"sha": "c8d7fe855cf0075691a20c254d3f37ae87ae3700", "filename": "gcc/config/bfin/lib1funcs.asm", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/314f99131f486ffad0f432ec0ffb5977991ad14b/gcc%2Fconfig%2Fbfin%2Flib1funcs.asm", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/314f99131f486ffad0f432ec0ffb5977991ad14b/gcc%2Fconfig%2Fbfin%2Flib1funcs.asm", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fbfin%2Flib1funcs.asm?ref=314f99131f486ffad0f432ec0ffb5977991ad14b", "patch": "@@ -128,7 +128,8 @@ ___umulsi3_highpart:\n \tA0 = R1.H * R0.H, A1 += R1.L * R0.H (FU);\n \tA1 += R0.L * R1.H (FU);\n \tA1 = A1 >> 16;\n-\tR0 = (A0 += A1);\n+\tA0 += A1;\n+\tR0 = A0 (FU);\n \tRTS;\n #endif\n "}]}