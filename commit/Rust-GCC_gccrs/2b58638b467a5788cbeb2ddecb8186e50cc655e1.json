{"sha": "2b58638b467a5788cbeb2ddecb8186e50cc655e1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MmI1ODYzOGI0NjdhNTc4OGNiZWIyZGRlY2I4MTg2ZTUwY2M2NTVlMQ==", "commit": {"author": {"name": "Paul Brook", "email": "paul@codesourcery.com", "date": "2004-10-07T00:43:21Z"}, "committer": {"name": "Paul Brook", "email": "pbrook@gcc.gnu.org", "date": "2004-10-07T00:43:21Z"}, "message": "re PR fortran/17678 (USE statement incorrectly initializes allocatable array)\n\n\tPR fortran/17678\n\t* trans-array.c (gfc_trans_deferred_array): Leave use associated\n\tvariables alone.\ntestsuite/\n\t* gfortran.dg/use_allocated_1.f90: New test.\n\nFrom-SVN: r88655", "tree": {"sha": "510d55097ada56c1bc250ed1cde1c4e9b69eece0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/510d55097ada56c1bc250ed1cde1c4e9b69eece0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2b58638b467a5788cbeb2ddecb8186e50cc655e1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2b58638b467a5788cbeb2ddecb8186e50cc655e1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2b58638b467a5788cbeb2ddecb8186e50cc655e1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2b58638b467a5788cbeb2ddecb8186e50cc655e1/comments", "author": null, "committer": null, "parents": [{"sha": "d1d525310beefc660673ca07246a4eb14b342503", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d1d525310beefc660673ca07246a4eb14b342503", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d1d525310beefc660673ca07246a4eb14b342503"}], "stats": {"total": 33, "additions": 31, "deletions": 2}, "files": [{"sha": "60c8dba558a36dc5547be4e18476d2f99b9578ce", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2b58638b467a5788cbeb2ddecb8186e50cc655e1/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2b58638b467a5788cbeb2ddecb8186e50cc655e1/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=2b58638b467a5788cbeb2ddecb8186e50cc655e1", "patch": "@@ -1,3 +1,9 @@\n+2004-10-07  Paul Brook  <paul@codesourcery.com>\n+\n+\tPR fortran/17678\n+\t* trans-array.c (gfc_trans_deferred_array): Leave use associated\n+\tvariables alone.\n+\n 2004-10-06  Tobias Schlueter  <tobias.schlueter@physik.uni-muenchen.de>\n \n \tPR fortran/17568"}, {"sha": "d36155dc3641b289a2ce6f6e6b5504e77af01a68", "filename": "gcc/fortran/trans-array.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2b58638b467a5788cbeb2ddecb8186e50cc655e1/gcc%2Ffortran%2Ftrans-array.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2b58638b467a5788cbeb2ddecb8186e50cc655e1/gcc%2Ffortran%2Ftrans-array.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-array.c?ref=2b58638b467a5788cbeb2ddecb8186e50cc655e1", "patch": "@@ -3999,8 +3999,8 @@ gfc_trans_deferred_array (gfc_symbol * sym, tree body)\n       && !INTEGER_CST_P (sym->ts.cl->backend_decl))\n     gfc_trans_init_string_length (sym->ts.cl, &fnblock);\n \n-  /* Parameter variables don't need anything special.  */\n-  if (sym->attr.dummy)\n+  /* Parameter and use associated variables don't need anything special.  */\n+  if (sym->attr.dummy || sym->attr.use_assoc)\n     {\n       gfc_add_expr_to_block (&fnblock, body);\n "}, {"sha": "04ce16093e7dfed496f4626c7feb94e0cf74db20", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2b58638b467a5788cbeb2ddecb8186e50cc655e1/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2b58638b467a5788cbeb2ddecb8186e50cc655e1/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=2b58638b467a5788cbeb2ddecb8186e50cc655e1", "patch": "@@ -1,3 +1,8 @@\n+2004-10-07  Paul Brook  <paul@codesourcery.com>\n+\n+\tPR fortran/17678\n+\t* gfortran.dg/use_allocated_1.f90: New test.\n+\n 2004-10-06  Andrew Pinski  <pinskia@physics.uc.edu>\n \n \tPR middle-end/17849"}, {"sha": "fb51502edc2d61e3b1de019df20e03a33e561e7a", "filename": "gcc/testsuite/gfortran.dg/use_allocated_1.f90", "status": "added", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2b58638b467a5788cbeb2ddecb8186e50cc655e1/gcc%2Ftestsuite%2Fgfortran.dg%2Fuse_allocated_1.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2b58638b467a5788cbeb2ddecb8186e50cc655e1/gcc%2Ftestsuite%2Fgfortran.dg%2Fuse_allocated_1.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fuse_allocated_1.f90?ref=2b58638b467a5788cbeb2ddecb8186e50cc655e1", "patch": "@@ -0,0 +1,18 @@\n+! { dg-do run }\n+! PR17678\n+! We were incorrectly setting use-associated variables to unallocated\n+! on procedure entry.\n+module foo\n+  integer, dimension(:), allocatable :: bar\n+end module\n+\n+program main\n+  use foo\n+  allocate (bar(10))\n+  call init\n+end program main\n+\n+subroutine init\n+  use foo\n+  if (.not.allocated(bar)) call abort\n+end subroutine init"}]}