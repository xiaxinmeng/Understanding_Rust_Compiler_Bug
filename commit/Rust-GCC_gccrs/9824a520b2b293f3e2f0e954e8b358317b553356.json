{"sha": "9824a520b2b293f3e2f0e954e8b358317b553356", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTgyNGE1MjBiMmIyOTNmM2UyZjBlOTU0ZThiMzU4MzE3YjU1MzM1Ng==", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2017-12-05T15:10:23Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2017-12-05T15:10:23Z"}, "message": "re PR tree-optimization/83277 ([graphite] Wrong code w/ -O2 -floop-nest-optimize)\n\n2017-12-05  Richard Biener  <rguenther@suse.de>\n\n\tPR tree-optimization/83277\n\t* graphite-isl-ast-to-gimple.c (should_copy_to_new_region): Make sure\n\tto code-gen liveout vars.\n\n\t* gcc.dg/graphite/pr83277.c: New testcase.\n\nFrom-SVN: r255424", "tree": {"sha": "82c8fde25fe4149fde2e49bd77f2454cc65b6f53", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/82c8fde25fe4149fde2e49bd77f2454cc65b6f53"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9824a520b2b293f3e2f0e954e8b358317b553356", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9824a520b2b293f3e2f0e954e8b358317b553356", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9824a520b2b293f3e2f0e954e8b358317b553356", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9824a520b2b293f3e2f0e954e8b358317b553356/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "6acc594827256e256815741aef5102ca6838fa5b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6acc594827256e256815741aef5102ca6838fa5b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6acc594827256e256815741aef5102ca6838fa5b"}], "stats": {"total": 69, "additions": 67, "deletions": 2}, "files": [{"sha": "cfda6b3c691b8bbfe386af9d85f84f4110507e21", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9824a520b2b293f3e2f0e954e8b358317b553356/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9824a520b2b293f3e2f0e954e8b358317b553356/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=9824a520b2b293f3e2f0e954e8b358317b553356", "patch": "@@ -1,3 +1,9 @@\n+2017-12-05  Richard Biener  <rguenther@suse.de>\n+\n+\tPR tree-optimization/83277\n+\t* graphite-isl-ast-to-gimple.c (should_copy_to_new_region): Make sure\n+\tto code-gen liveout vars.\n+\n 2017-12-05  Richard Sandiford  <richard.sandiford@linaro.org>\n \n \t* config/aarch64/aarch64-simd.md (aarch64_simd_bsldi_internal)"}, {"sha": "ab7f0e786ba2c89c9d3be7169509a2d3838d8458", "filename": "gcc/graphite-isl-ast-to-gimple.c", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9824a520b2b293f3e2f0e954e8b358317b553356/gcc%2Fgraphite-isl-ast-to-gimple.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9824a520b2b293f3e2f0e954e8b358317b553356/gcc%2Fgraphite-isl-ast-to-gimple.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgraphite-isl-ast-to-gimple.c?ref=9824a520b2b293f3e2f0e954e8b358317b553356", "patch": "@@ -1137,8 +1137,10 @@ should_copy_to_new_region (gimple *stmt, sese_info_p region)\n   if (is_gimple_assign (stmt)\n       && (lhs = gimple_assign_lhs (stmt))\n       && TREE_CODE (lhs) == SSA_NAME\n-      && is_gimple_reg (lhs)\n-      && scev_analyzable_p (lhs, region->region))\n+      && scev_analyzable_p (lhs, region->region)\n+      /* But to code-generate liveouts - liveout PHI generation is\n+         in generic sese.c code that cannot do code generation.  */\n+      && ! bitmap_bit_p (region->liveout, SSA_NAME_VERSION (lhs)))\n     return false;\n \n   return true;"}, {"sha": "b4f02a70046c688e43208c40e00be7dcc49b3484", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9824a520b2b293f3e2f0e954e8b358317b553356/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9824a520b2b293f3e2f0e954e8b358317b553356/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=9824a520b2b293f3e2f0e954e8b358317b553356", "patch": "@@ -1,3 +1,8 @@\n+2017-12-05  Richard Biener  <rguenther@suse.de>\n+\n+\tPR tree-optimization/83277\n+\t* gcc.dg/graphite/pr83277.c: New testcase.\n+\n 2017-12-05  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR tree-optimization/83283"}, {"sha": "aef4fee4272a7351524e4f8726b5f501659f5d10", "filename": "gcc/testsuite/gcc.dg/graphite/pr83277.c", "status": "added", "additions": 52, "deletions": 0, "changes": 52, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9824a520b2b293f3e2f0e954e8b358317b553356/gcc%2Ftestsuite%2Fgcc.dg%2Fgraphite%2Fpr83277.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9824a520b2b293f3e2f0e954e8b358317b553356/gcc%2Ftestsuite%2Fgcc.dg%2Fgraphite%2Fpr83277.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fgraphite%2Fpr83277.c?ref=9824a520b2b293f3e2f0e954e8b358317b553356", "patch": "@@ -0,0 +1,52 @@\n+/* { dg-do run } */\n+/* { dg-options \"-O2 -floop-nest-optimize\" } */\n+\n+int rk, si = 0;\n+int jr[2];\n+\n+int\n+wv (signed char n8)\n+{\n+  const int tw = 8;\n+  int xq[tw];\n+  int bj, pu = 0;\n+\n+  for (bj = 0; bj < tw; ++bj)\n+    xq[bj] = 0;\n+\n+  bj = 0;\n+  while (bj < 1)\n+    {\n+      int gs = n8 ^ 128;\n+\n+      if (gs != 0)\n+\t{\n+\t  int u7[3];\n+\n+\t  while (bj < 2)\n+\t    {\n+\t      u7[bj] = 0;\n+\t      ++bj;\n+\t    }\n+\n+\t  jr[0] = u7[0];\n+\t  rk = xq[0];\n+\t  pu = n8;\n+\n+\t  if (si != 0)\n+\t    return si;\n+\t}\n+    }\n+\n+  return pu;\n+}\n+\n+int\n+main (void)\n+{\n+  signed char ax = 1;\n+\n+  if (wv (ax) != ax)\n+    __builtin_abort ();\n+  return 0;\n+}"}]}