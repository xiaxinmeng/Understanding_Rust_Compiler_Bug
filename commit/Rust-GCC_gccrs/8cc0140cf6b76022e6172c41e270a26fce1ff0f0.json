{"sha": "8cc0140cf6b76022e6172c41e270a26fce1ff0f0", "node_id": "C_kwDOANBUbNoAKDhjYzAxNDBjZjZiNzYwMjJlNjE3MmM0MWUyNzBhMjZmY2UxZmYwZjA", "commit": {"author": {"name": "Marc Poulhi\u00e8s", "email": "dkm@kataplop.net", "date": "2021-11-09T08:13:23Z"}, "committer": {"name": "Marc Poulhi\u00e8s", "email": "dkm@kataplop.net", "date": "2021-11-09T08:16:47Z"}, "message": "More help on running clang-format locally\n\nAdd note on using git-clang-format and clang-format-diff.py.\n\nRemove the `clang-format` from the required items of PR as it's not enforced\nanymore. It's now handled by regular code review.\n\nRefs #242\n\nSigned-off-by: Marc Poulhi\u00e8s <dkm@kataplop.net>", "tree": {"sha": "4e4fe2dcd13d7cf01f0679adc4b2d3d76cdce6f8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4e4fe2dcd13d7cf01f0679adc4b2d3d76cdce6f8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8cc0140cf6b76022e6172c41e270a26fce1ff0f0", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEy35wXiwjotpFIaYoRb3lOkoqmoIFAmGKLq8ACgkQRb3lOkoq\nmoLTlA//TCVRBkkt687YpeTCagmmoyfUBKWBrW9JeJ6Z93DfGD7SIcA93YP16mYt\n0SKj62Iu6Y+e2sy138FtxAgR/Xk6SMleFhCF7ox1RuK1UAzAuDFGTYCsB1DuUYPs\nXVrmm87z3tDL6OApXmfnqNKYDKPX8fQGaGBMtBOo+lI9pUgtWkU8Et12MiGBvVcx\nuCVy8cLGAmRpGIrQYMjiDD3NmVJ4SlePsxe0rehOgkooZRsOXQzKnnhZucXk/qh8\ninD8oaWQS1PbcOxhwXPiP4CukYmWBgga/2XHjt0eSzGvxQBq0MZioL10PKNN5pRX\nHdpQ9voeA1WVUFnO9EH/kDf3sUf6H6eGI6olsb9PI/l3aQ9/dPSp84WXsX0dqqu4\nKlgSp1z0QGQ91YvtmissCaB/npRJUd9pNGh2B4czOMg6srfxdEbwWRZ8JZPOn7TC\naVTvrVU/iIlpFiQfMc3ms0NAIrwD/xTFeqn7crESzeLWmcBepdeaDMl3mHcvV9PA\nHdKGMFBs+4rho7RZabh92U8waQuTbSvq/CiEHILC4sv8n04a+9imtFliXc6lFkNf\n7uGtCgLCHecCMTSAqF9MqTkl22/eGesTxJjZ/mzvYmyMfycJQqNk/gqYNM9Nl0ZC\ngX06nNHRFj3SlUAK3DyRHnRRs2fslihvALYkkeegEDy+NhzwsIU=\n=u/A/\n-----END PGP SIGNATURE-----", "payload": "tree 4e4fe2dcd13d7cf01f0679adc4b2d3d76cdce6f8\nparent 07fee63db7b06207917849410e12de750bdb646f\nauthor Marc Poulhi\u00e8s <dkm@kataplop.net> 1636445603 +0100\ncommitter Marc Poulhi\u00e8s <dkm@kataplop.net> 1636445807 +0100\n\nMore help on running clang-format locally\n\nAdd note on using git-clang-format and clang-format-diff.py.\n\nRemove the `clang-format` from the required items of PR as it's not enforced\nanymore. It's now handled by regular code review.\n\nRefs #242\n\nSigned-off-by: Marc Poulhi\u00e8s <dkm@kataplop.net>\n"}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8cc0140cf6b76022e6172c41e270a26fce1ff0f0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8cc0140cf6b76022e6172c41e270a26fce1ff0f0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8cc0140cf6b76022e6172c41e270a26fce1ff0f0/comments", "author": {"login": "dkm", "id": 87603, "node_id": "MDQ6VXNlcjg3NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/87603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dkm", "html_url": "https://github.com/dkm", "followers_url": "https://api.github.com/users/dkm/followers", "following_url": "https://api.github.com/users/dkm/following{/other_user}", "gists_url": "https://api.github.com/users/dkm/gists{/gist_id}", "starred_url": "https://api.github.com/users/dkm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dkm/subscriptions", "organizations_url": "https://api.github.com/users/dkm/orgs", "repos_url": "https://api.github.com/users/dkm/repos", "events_url": "https://api.github.com/users/dkm/events{/privacy}", "received_events_url": "https://api.github.com/users/dkm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "dkm", "id": 87603, "node_id": "MDQ6VXNlcjg3NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/87603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dkm", "html_url": "https://github.com/dkm", "followers_url": "https://api.github.com/users/dkm/followers", "following_url": "https://api.github.com/users/dkm/following{/other_user}", "gists_url": "https://api.github.com/users/dkm/gists{/gist_id}", "starred_url": "https://api.github.com/users/dkm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dkm/subscriptions", "organizations_url": "https://api.github.com/users/dkm/orgs", "repos_url": "https://api.github.com/users/dkm/repos", "events_url": "https://api.github.com/users/dkm/events{/privacy}", "received_events_url": "https://api.github.com/users/dkm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "07fee63db7b06207917849410e12de750bdb646f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/07fee63db7b06207917849410e12de750bdb646f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/07fee63db7b06207917849410e12de750bdb646f"}], "stats": {"total": 78, "additions": 71, "deletions": 7}, "files": [{"sha": "52fbb9954c5c0f4ed27af0247d30f7740a860ce1", "filename": "CONTRIBUTING.md", "status": "modified", "additions": 71, "deletions": 7, "changes": 78, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8cc0140cf6b76022e6172c41e270a26fce1ff0f0/CONTRIBUTING.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8cc0140cf6b76022e6172c41e270a26fce1ff0f0/CONTRIBUTING.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/CONTRIBUTING.md?ref=8cc0140cf6b76022e6172c41e270a26fce1ff0f0", "patch": "@@ -40,17 +40,81 @@ These will be imported into a GitHub PR to follow the normal review process, and\n \n * Where possible please add test cases to `gcc/testsuite/rust/` for all PRs. Some issues may not be testable via dejagnu/automation such as debug dump changes.\n \n-* PRs won't be merged until `clang-format` and the build and tests pass.\n+* Follow the [GCC coding style](https://gcc.gnu.org/codingconventions.html) (see `clang-format` below).\n \n-** Running `clang-format` locally\n+* PRs won't be merged until the build and tests pass.\n \n-... corresponding to what the _Clang Format Lint_ (`.github/workflows/clang-format.yml`) is doing, with `clang-format-10` being available locally, and avoiding the Docker overhead.\n+* Please take the time to create good git commit messages see the existing format of them in the git log or refer to something like: https://chris.beams.io/posts/git-commit/\n \n-    $ wget 'https://github.com/DoozyX/clang-format-lint-action/raw/v0.11/run-clang-format.py'\n-    $ cp contrib/clang-format .clang-format\n-    $ python3 run-clang-format.py --clang-format-executable clang-format-10 --recursive --extensions h,cc gcc/rust/\n+#### Running `clang-format` locally\n \n-* Please take the time to create good git commit messages see the existing format of them in the git log or refer to something like: https://chris.beams.io/posts/git-commit/\n+* on all files using python scripts\n+... corresponding to what the _Clang Format Lint_ (`.github/workflows/clang-format.yml`) is doing, with `clang-format-10` being available locally, and avoiding the Docker overhead.\n+\n+```shell\n+$ wget 'https://github.com/DoozyX/clang-format-lint-action/raw/v0.11/run-clang-format.py'\n+$ cp contrib/clang-format .clang-format\n+$ python3 run-clang-format.py --clang-format-executable clang-format-10 --recursive --extensions h,cc gcc/rust/\n+```\n+\n+* on a given patch using python scripts\n+See the [clang-format documentation](https://clang.llvm.org/docs/ClangFormat.html#script-for-patch-reformatting) :\n+\n+    $ git diff -U0 --no-color HEAD^ | clang-format-diff.py -i -p1\n+\n+* using `git` interface\n+\n+At least on Debian and its derivative, each `clang-format` packages also comes\n+with `git-clang-format` command that can be used easily. It applies on staged\n+changes, and any modification can be seen as unstaged changes:\n+\n+```diff\n+$ git diff --cached\n+diff --git a/gcc/rust/rust-abi.h b/gcc/rust/rust-abi.h\n+index bd3043295ce..9559374ce60 100644\n+--- a/gcc/rust/rust-abi.h\n++++ b/gcc/rust/rust-abi.h\n+@@ -22,10 +22,10 @@ namespace Rust {\n+ enum ABI\n+ {\n+   UNKNOWN,\n+-  RUST,\n++     RUST,\n+   INTRINSIC,\n+   C,\n+-  CDECL,\n++     CDECL,\n+   STDCALL,\n+   FASTCALL,\n+ };\n+ \n+gccrs/gcc/rust on \ue0a0 dkm/clang_format [$!+?]\n+\u276f git clang-format\n+changed files:\n+    gcc/rust/rust-abi.h\n+ \n+gccrs/gcc/rust on \ue0a0 dkm/clang_format [$!+?]\n+$ git diff rust-abi.h\n+diff --git a/gcc/rust/rust-abi.h b/gcc/rust/rust-abi.h\n+index 9559374ce60..bd3043295ce 100644\n+--- a/gcc/rust/rust-abi.h\n++++ b/gcc/rust/rust-abi.h\n+@@ -22,10 +22,10 @@ namespace Rust {\n+ enum ABI\n+ {\n+   UNKNOWN,\n+-     RUST,\n++  RUST,\n+   INTRINSIC,\n+   C,\n+-     CDECL,\n++  CDECL,\n+   STDCALL,\n+   FASTCALL,\n+ };\n+```\n+\n+Also note that you can use a given version of `clang-format` by using `git clang-format-10` if you have installed that particular version.\n \n Thanks! :heart: :heart: :heart:\n "}]}