{"sha": "495ed96c2a50e2ff9ce7b056ca6aea822090ed28", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDk1ZWQ5NmMyYTUwZTJmZjljZTdiMDU2Y2E2YWVhODIyMDkwZWQyOA==", "commit": {"author": {"name": "Uros Bizjak", "email": "uros@kss-loka.si", "date": "2006-10-21T20:05:35Z"}, "committer": {"name": "Uros Bizjak", "email": "uros@gcc.gnu.org", "date": "2006-10-21T20:05:35Z"}, "message": "re PR middle-end/28252 (pow(x,1/3.0) should be converted to cbrt(x))\n\n2006-10-21  Uros Bizjak  <uros@kss-loka.si>\n\n        PR middle-end/28252\n        * builtins.c (fold_builtin): Fold pow(x,1.0/3.0) as cbrt(x) if\n        flag_unsafe_math_optimizations is set.\n\ntestsuite/ChangeLog:\n\n        PR middle-end/28252\n        * gcc.dg/builtins-8.c: Also check pow(x,1.0/3.0) to cbrt(x)\n        transformation.\n\nFrom-SVN: r117937", "tree": {"sha": "0b1857927bfdd0fd605f71bf64a94a534bc8cac2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0b1857927bfdd0fd605f71bf64a94a534bc8cac2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/495ed96c2a50e2ff9ce7b056ca6aea822090ed28", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/495ed96c2a50e2ff9ce7b056ca6aea822090ed28", "html_url": "https://github.com/Rust-GCC/gccrs/commit/495ed96c2a50e2ff9ce7b056ca6aea822090ed28", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/495ed96c2a50e2ff9ce7b056ca6aea822090ed28/comments", "author": null, "committer": null, "parents": [{"sha": "0bfa1541fa2bc1b422babce2a6c272de36ecdad5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0bfa1541fa2bc1b422babce2a6c272de36ecdad5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0bfa1541fa2bc1b422babce2a6c272de36ecdad5"}], "stats": {"total": 35, "additions": 34, "deletions": 1}, "files": [{"sha": "21550b3626fd2797fd5c799c5df961611a14bb68", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/495ed96c2a50e2ff9ce7b056ca6aea822090ed28/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/495ed96c2a50e2ff9ce7b056ca6aea822090ed28/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=495ed96c2a50e2ff9ce7b056ca6aea822090ed28", "patch": "@@ -4,6 +4,12 @@\n \t(expand_builtin): Use it to expand lrint instead of\n \texpand_builtin_mathfn.\n \n+2006-10-21  Uros Bizjak  <uros@kss-loka.si>\n+\n+\tPR middle-end/28252\n+\t* builtins.c (fold_builtin): Fold pow(x,1.0/3.0) as cbrt(x) if\n+\tflag_unsafe_math_optimizations is set.\n+\n 2006-10-21  Uros Bizjak  <uros@kss-loka.si>\n \n \tPR target/19398"}, {"sha": "ecee42b69be6ff06aa26aa54eeb6fbaabcc1be26", "filename": "gcc/builtins.c", "status": "modified", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/495ed96c2a50e2ff9ce7b056ca6aea822090ed28/gcc%2Fbuiltins.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/495ed96c2a50e2ff9ce7b056ca6aea822090ed28/gcc%2Fbuiltins.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fbuiltins.c?ref=495ed96c2a50e2ff9ce7b056ca6aea822090ed28", "patch": "@@ -7775,6 +7775,23 @@ fold_builtin_pow (tree fndecl, tree arglist, tree type)\n \t    }\n \t}\n \n+      /* Optimize pow(x,1.0/3.0) = cbrt(x).  */\n+      if (flag_unsafe_math_optimizations)\n+\t{\n+\t  const REAL_VALUE_TYPE dconstroot\n+\t    = real_value_truncate (TYPE_MODE (type), dconstthird);\n+\n+\t  if (REAL_VALUES_EQUAL (c, dconstroot))\n+\t    {\n+\t      tree cbrtfn = mathfn_built_in (type, BUILT_IN_CBRT);\n+\t      if (cbrtfn != NULL_TREE)\n+\t\t{\n+\t\t  tree arglist = build_tree_list (NULL_TREE, arg0);\n+\t\t  return build_function_call_expr (cbrtfn, arglist);\n+\t\t}\n+\t    }\n+\t}\n+\n       /* Check for an integer exponent.  */\n       n = real_to_integer (&c);\n       real_from_integer (&cint, VOIDmode, n, n < 0 ? -1 : 0, 0);"}, {"sha": "b55cd7c8f8bcc800528c6c434e727879affa4950", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/495ed96c2a50e2ff9ce7b056ca6aea822090ed28/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/495ed96c2a50e2ff9ce7b056ca6aea822090ed28/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=495ed96c2a50e2ff9ce7b056ca6aea822090ed28", "patch": "@@ -1,3 +1,9 @@\n+2006-10-21  Uros Bizjak  <uros@kss-loka.si>\n+\n+\tPR middle-end/28252\n+\t* gcc.dg/builtins-8.c: Also check pow(x,1.0/3.0) to cbrt(x)\n+\ttransformation.\n+\n 2006-10-21  Richard Guenther  <rguenther@suse.de>\n \n \tPR tree-optimization/3511"}, {"sha": "be17774d5265a85a6e05158166ffa7f23e1a7bce", "filename": "gcc/testsuite/gcc.dg/builtins-8.c", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/495ed96c2a50e2ff9ce7b056ca6aea822090ed28/gcc%2Ftestsuite%2Fgcc.dg%2Fbuiltins-8.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/495ed96c2a50e2ff9ce7b056ca6aea822090ed28/gcc%2Ftestsuite%2Fgcc.dg%2Fbuiltins-8.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fbuiltins-8.c?ref=495ed96c2a50e2ff9ce7b056ca6aea822090ed28", "patch": "@@ -1,4 +1,4 @@\n-/* Copyright (C) 2003  Free Software Foundation.\n+/* Copyright (C) 2003, 2006  Free Software Foundation.\n \n    Verify that built-in math function constant folding of functions\n    with one constant argument is correctly performed by the compiler.\n@@ -11,6 +11,7 @@\n extern void abort(void);\n extern double pow(double, double);\n extern double sqrt(double);\n+extern double cbrt(double);\n \n void test(double x)\n {\n@@ -25,6 +26,9 @@ void test(double x)\n \n   if (pow(x,0.5) != sqrt(x))\n     abort ();\n+\n+  if (pow(x,1.0/3.0) != cbrt(x))\n+    abort ();\n }\n \n int main()"}]}