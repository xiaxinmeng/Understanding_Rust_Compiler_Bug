{"sha": "b786d31f62a93acc810f7bf5271c1bc80f259a8d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Yjc4NmQzMWY2MmE5M2FjYzgxMGY3YmY1MjcxYzFiYzgwZjI1OWE4ZA==", "commit": {"author": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2013-12-15T22:19:33Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2013-12-15T22:19:33Z"}, "message": "re PR ipa/59265 (Segmentation fault in ipa_note_param_call for -fprofile-use in SPEC CPU2006)\n\n\n\tPR ipa/59265\n\t* ipa-prop.c (ipa_analyze_call_uses): Skip already\n\tdevirtualized calls.\n\tg++.dg/torture/pr59265.C: New testcase.\n\nFrom-SVN: r206004", "tree": {"sha": "c2f4cb96b50e92592fd350a911703658f5fa6f7d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c2f4cb96b50e92592fd350a911703658f5fa6f7d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b786d31f62a93acc810f7bf5271c1bc80f259a8d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b786d31f62a93acc810f7bf5271c1bc80f259a8d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b786d31f62a93acc810f7bf5271c1bc80f259a8d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b786d31f62a93acc810f7bf5271c1bc80f259a8d/comments", "author": null, "committer": null, "parents": [{"sha": "88fab00db092415489517cc6700ba7b58c5d30bb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/88fab00db092415489517cc6700ba7b58c5d30bb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/88fab00db092415489517cc6700ba7b58c5d30bb"}], "stats": {"total": 43, "additions": 42, "deletions": 1}, "files": [{"sha": "023a2291bac4692165447f67892fa5f17068e171", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b786d31f62a93acc810f7bf5271c1bc80f259a8d/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b786d31f62a93acc810f7bf5271c1bc80f259a8d/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=b786d31f62a93acc810f7bf5271c1bc80f259a8d", "patch": "@@ -1,5 +1,10 @@\n 2013-12-14   Jan Hubicka  <jh@suse.cz>\n \n+\tPR ipa/59265\n+\t* ipa-prop.c (ipa_analyze_call_uses): Skip already\n+\tdevirtualized calls.\n+\n+2013-12-14   Jan Hubicka  <jh@suse.cz>\n \tPR middle-end/58477\n \t* ipa-prop.c (stmt_may_be_vtbl_ptr_store): Skip clobbers.\n "}, {"sha": "a753c040b9ed6e8e3602b86558b71e5ebbcdface", "filename": "gcc/ipa-prop.c", "status": "modified", "additions": 10, "deletions": 1, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b786d31f62a93acc810f7bf5271c1bc80f259a8d/gcc%2Fipa-prop.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b786d31f62a93acc810f7bf5271c1bc80f259a8d/gcc%2Fipa-prop.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-prop.c?ref=b786d31f62a93acc810f7bf5271c1bc80f259a8d", "patch": "@@ -2024,8 +2024,17 @@ ipa_analyze_call_uses (struct cgraph_node *node,\n \t\t       struct param_analysis_info *parms_ainfo, gimple call)\n {\n   tree target = gimple_call_fn (call);\n+  struct cgraph_edge *cs;\n \n-  if (!target)\n+  if (!target\n+      || (TREE_CODE (target) != SSA_NAME\n+          && !virtual_method_call_p (target)))\n+    return;\n+\n+  /* If we previously turned the call into a direct call, there is\n+     no need to analyze.  */\n+  cs = cgraph_edge (node, call);\n+  if (cs && !cs->indirect_unknown_callee)\n     return;\n   if (TREE_CODE (target) == SSA_NAME)\n     ipa_analyze_indirect_call_uses (node, info, parms_ainfo, call, target);"}, {"sha": "f143da257feafa009af84ac2c0a1e0f50caf047a", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b786d31f62a93acc810f7bf5271c1bc80f259a8d/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b786d31f62a93acc810f7bf5271c1bc80f259a8d/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=b786d31f62a93acc810f7bf5271c1bc80f259a8d", "patch": "@@ -1,3 +1,8 @@\n+2013-12-14   Jan Hubicka  <jh@suse.cz>\n+\n+\tPR ipa/59265\n+\tg++.dg/torture/pr59265.C: New testcase.\n+\n 2013-12-15  Uros Bizjak  <ubizjak@gmail.com>\n \n \t* gcc.dg/vect/vect-nop-move.c (foo32x2_be): Call"}, {"sha": "880c454da10345ff2c1aa4b3ad53f3803fe9a346", "filename": "gcc/testsuite/g++.dg/torture/pr59265.C", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b786d31f62a93acc810f7bf5271c1bc80f259a8d/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftorture%2Fpr59265.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b786d31f62a93acc810f7bf5271c1bc80f259a8d/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftorture%2Fpr59265.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftorture%2Fpr59265.C?ref=b786d31f62a93acc810f7bf5271c1bc80f259a8d", "patch": "@@ -0,0 +1,22 @@\n+// { dg-do compile }\n+// { dg-options \"-fprofile-use -std=gnu++11\" }\n+\n+class A {\n+  int m_fn1() const;\n+  unsigned m_fn2() const;\n+};\n+class B {\n+public:\n+  virtual void m_fn1();\n+};\n+class C final : B {\n+  C();\n+  virtual void m_fn2() { m_fn1(); }\n+};\n+int a;\n+unsigned A::m_fn2() const {\n+  if (m_fn1())\n+    return 0;\n+  a = m_fn2();\n+}\n+C::C() {}"}]}