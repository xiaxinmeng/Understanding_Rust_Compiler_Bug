{"sha": "a93ee058fa3f2b0569e43b425293f28858eebfaf", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTkzZWUwNThmYTNmMmIwNTY5ZTQzYjQyNTI5M2YyODg1OGVlYmZhZg==", "commit": {"author": {"name": "Nathan Sidwell", "email": "nathan@acm.org", "date": "2017-11-03T13:16:06Z"}, "committer": {"name": "Nathan Sidwell", "email": "nathan@gcc.gnu.org", "date": "2017-11-03T13:16:06Z"}, "message": "[PR c++/82710] false positive paren warning\n\nhttps://gcc.gnu.org/ml/gcc-patches/2017-11/msg00186.html\n\tPR c++/82710\n\t* decl.c (grokdeclarator): Protect MAYBE_CLASS things from paren\n\twarning too.\n\n\tPR c++/82710\n\t* g++.dg/warn/pr82710.C: More cases.\n\nFrom-SVN: r254371", "tree": {"sha": "6fb5fdaa2630816d3d1b7476197b123d4463dacf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6fb5fdaa2630816d3d1b7476197b123d4463dacf"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a93ee058fa3f2b0569e43b425293f28858eebfaf", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a93ee058fa3f2b0569e43b425293f28858eebfaf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a93ee058fa3f2b0569e43b425293f28858eebfaf", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a93ee058fa3f2b0569e43b425293f28858eebfaf/comments", "author": {"login": "urnathan", "id": 13103001, "node_id": "MDQ6VXNlcjEzMTAzMDAx", "avatar_url": "https://avatars.githubusercontent.com/u/13103001?v=4", "gravatar_id": "", "url": "https://api.github.com/users/urnathan", "html_url": "https://github.com/urnathan", "followers_url": "https://api.github.com/users/urnathan/followers", "following_url": "https://api.github.com/users/urnathan/following{/other_user}", "gists_url": "https://api.github.com/users/urnathan/gists{/gist_id}", "starred_url": "https://api.github.com/users/urnathan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/urnathan/subscriptions", "organizations_url": "https://api.github.com/users/urnathan/orgs", "repos_url": "https://api.github.com/users/urnathan/repos", "events_url": "https://api.github.com/users/urnathan/events{/privacy}", "received_events_url": "https://api.github.com/users/urnathan/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "97695d99b0caa475df0a7b569fee6d3bef35b4d7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/97695d99b0caa475df0a7b569fee6d3bef35b4d7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/97695d99b0caa475df0a7b569fee6d3bef35b4d7"}], "stats": {"total": 43, "additions": 36, "deletions": 7}, "files": [{"sha": "590e3221c8ccb8463789cb4b818866ca95c945ad", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a93ee058fa3f2b0569e43b425293f28858eebfaf/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a93ee058fa3f2b0569e43b425293f28858eebfaf/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=a93ee058fa3f2b0569e43b425293f28858eebfaf", "patch": "@@ -1,3 +1,9 @@\n+2017-11-03  Nathan Sidwell  <nathan@acm.org>\n+\n+\tPR c++/82710\n+\t* decl.c (grokdeclarator): Protect MAYBE_CLASS things from paren\n+\twarning too.\n+\n 2017-11-02  Paolo Carlini  <paolo.carlini@oracle.com>\n \n \tPR c++/81957"}, {"sha": "0ce8f2d343589677e7e8113179a345f8f5b69a37", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 8, "deletions": 6, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a93ee058fa3f2b0569e43b425293f28858eebfaf/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a93ee058fa3f2b0569e43b425293f28858eebfaf/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=a93ee058fa3f2b0569e43b425293f28858eebfaf", "patch": "@@ -10795,13 +10795,15 @@ grokdeclarator (const cp_declarator *declarator,\n \t to be a constructor call.  */\n       if (decl_context != PARM\n \t  && declarator->parenthesized != UNKNOWN_LOCATION\n-\t  /* If the type is a class and the inner name used a global\n-\t     namespace qualifier, we need the parens.  Unfortunately\n-\t     all we can tell is that a qualified name was used.  */\n-\t  && !(CLASS_TYPE_P (type)\n-\t       && inner_declarator\n+\t  /* If the type is class-like and the inner name used a\n+\t     global namespace qualifier, we need the parens.\n+\t     Unfortunately all we can tell is whether a qualified name\n+\t     was used or not.  */\n+\t  && !(inner_declarator\n \t       && inner_declarator->kind == cdk_id\n-\t       && inner_declarator->u.id.qualifying_scope))\n+\t       && inner_declarator->u.id.qualifying_scope\n+\t       && (MAYBE_CLASS_TYPE_P (type)\n+\t\t   || TREE_CODE (type) == ENUMERAL_TYPE)))\n \twarning_at (declarator->parenthesized, OPT_Wparentheses,\n \t\t    \"unnecessary parentheses in declaration of %qs\", name);\n       if (declarator->kind == cdk_id || declarator->kind == cdk_decomp)"}, {"sha": "e40224e5564498f416cea7d216f14a6fcad7a6df", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a93ee058fa3f2b0569e43b425293f28858eebfaf/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a93ee058fa3f2b0569e43b425293f28858eebfaf/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=a93ee058fa3f2b0569e43b425293f28858eebfaf", "patch": "@@ -1,3 +1,8 @@\n+2017-11-03  Nathan Sidwell  <nathan@acm.org>\n+\n+\tPR c++/82710\n+\t* g++.dg/warn/pr82710.C: More cases.\n+\n 2017-11-03  Richard Sandiford  <richard.sandiford@linaro.org>\n \n \t* gcc.dg/pr82809.c: New test."}, {"sha": "93585eacf99f1db2694146171a37652b19b4016d", "filename": "gcc/testsuite/g++.dg/warn/pr82710.C", "status": "modified", "additions": 17, "deletions": 1, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a93ee058fa3f2b0569e43b425293f28858eebfaf/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2Fpr82710.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a93ee058fa3f2b0569e43b425293f28858eebfaf/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2Fpr82710.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2Fpr82710.C?ref=a93ee058fa3f2b0569e43b425293f28858eebfaf", "patch": "@@ -1,14 +1,20 @@\n-// { dg-additional-options -Wparentheses }\n+// { dg-do compile { target c++11 } }\n+// { dg-additional-options \"-Wparentheses -Wno-non-template-friend\" }\n \n // the MVP warning triggered on a friend decl.  */\n class X;\n+enum class Q {}; // C++ 11ness\n+enum R {};\n \n namespace here \n {\n   // these friends\n   X friendFunc1();\n   X *friendFunc2 ();\n   int friendFunc3 ();\n+  int bob ();\n+  Q bill ();\n+  R ben ();\n }\n \n namespace nm\n@@ -19,6 +25,9 @@ namespace nm\n     void friendFunc1 ();\n     void friendFunc2 ();\n     void friendFunc3 ();\n+    int bob ();\n+    Q bill ();\n+    R ben ();\n   }\n \n   class TestClass\n@@ -28,5 +37,12 @@ namespace nm\n     friend X *::here::friendFunc2 ();\n     friend int (::here::friendFunc3 ()); // { dg-warning \"\" }\n   };\n+\n+  template <typename T> class X\n+  {\n+    friend typename T::frob (::here::bob ());\n+    friend Q (::here::bill ());\n+    friend R (::here::ben ());\n+  };\n }\n "}]}