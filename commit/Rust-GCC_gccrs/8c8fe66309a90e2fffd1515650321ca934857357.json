{"sha": "8c8fe66309a90e2fffd1515650321ca934857357", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OGM4ZmU2NjMwOWE5MGUyZmZmZDE1MTU2NTAzMjFjYTkzNDg1NzM1Nw==", "commit": {"author": {"name": "Tom de Vries", "email": "tom@codesourcery.com", "date": "2014-10-17T06:36:35Z"}, "committer": {"name": "Tom de Vries", "email": "vries@gcc.gnu.org", "date": "2014-10-17T06:36:35Z"}, "message": "Handle copy cycles in pass_cprop_hardreg\n\n2014-10-17  Tom de Vries  <tom@codesourcery.com>\n\n\tPR rtl-optimization/61605\n\t* regcprop.c (copyprop_hardreg_forward_1): Add copy_p and noop_p.  Don't\n\tnotice stores for noops.  Don't regard noops as copies.\n\nFrom-SVN: r216364", "tree": {"sha": "d324360c0d59e9d4b01b8bc75b244c5f1e5d7307", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d324360c0d59e9d4b01b8bc75b244c5f1e5d7307"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8c8fe66309a90e2fffd1515650321ca934857357", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8c8fe66309a90e2fffd1515650321ca934857357", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8c8fe66309a90e2fffd1515650321ca934857357", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8c8fe66309a90e2fffd1515650321ca934857357/comments", "author": null, "committer": null, "parents": [{"sha": "5dad161975e0e5362ecb554e08d4a94a2c4b3922", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5dad161975e0e5362ecb554e08d4a94a2c4b3922", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5dad161975e0e5362ecb554e08d4a94a2c4b3922"}], "stats": {"total": 25, "additions": 20, "deletions": 5}, "files": [{"sha": "af302053b98699d09b1d6b40cb52a85573e86a4b", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8c8fe66309a90e2fffd1515650321ca934857357/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8c8fe66309a90e2fffd1515650321ca934857357/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=8c8fe66309a90e2fffd1515650321ca934857357", "patch": "@@ -1,3 +1,9 @@\n+2014-10-17  Tom de Vries  <tom@codesourcery.com>\n+\n+\tPR rtl-optimization/61605\n+\t* regcprop.c (copyprop_hardreg_forward_1): Add copy_p and noop_p.  Don't\n+\tnotice stores for noops.  Don't regard noops as copies.\n+\n 2014-10-17  Uros Bizjak  <ubizjak@gmail.com>\n \n \t* config/i386/cpuid.h (__cpuid): Remove definitions that handle %ebx"}, {"sha": "015366b34d55e4cbacb0554d8fc9ceb7626b49d7", "filename": "gcc/regcprop.c", "status": "modified", "additions": 14, "deletions": 5, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8c8fe66309a90e2fffd1515650321ca934857357/gcc%2Fregcprop.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8c8fe66309a90e2fffd1515650321ca934857357/gcc%2Fregcprop.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fregcprop.c?ref=8c8fe66309a90e2fffd1515650321ca934857357", "patch": "@@ -1047,12 +1047,21 @@ copyprop_hardreg_forward_1 (basic_block bb, struct value_data *vd)\n \t    }\n \t}\n \n-      /* Notice stores.  */\n-      note_stores (PATTERN (insn), kill_set_value, &ksvd);\n+      bool copy_p = (set\n+\t\t     && REG_P (SET_DEST (set))\n+\t\t     && REG_P (SET_SRC (set)));\n+      bool noop_p = (copy_p\n+\t\t     && rtx_equal_p (SET_DEST (set), SET_SRC (set)));\n \n-      /* Notice copies.  */\n-      if (set && REG_P (SET_DEST (set)) && REG_P (SET_SRC (set)))\n-\tcopy_value (SET_DEST (set), SET_SRC (set), vd);\n+      if (!noop_p)\n+\t{\n+\t  /* Notice stores.  */\n+\t  note_stores (PATTERN (insn), kill_set_value, &ksvd);\n+\n+\t  /* Notice copies.  */\n+\t  if (copy_p)\n+\t    copy_value (SET_DEST (set), SET_SRC (set), vd);\n+\t}\n \n       if (insn == BB_END (bb))\n \tbreak;"}]}