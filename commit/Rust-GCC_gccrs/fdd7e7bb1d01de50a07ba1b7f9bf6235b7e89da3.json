{"sha": "fdd7e7bb1d01de50a07ba1b7f9bf6235b7e89da3", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZmRkN2U3YmIxZDAxZGU1MGEwN2JhMWI3ZjliZjYyMzViN2U4OWRhMw==", "commit": {"author": {"name": "Emmanuel Briot", "email": "briot@adacore.com", "date": "2009-07-13T09:16:31Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2009-07-13T09:16:31Z"}, "message": "prj-proc.adb, [...]: Remove all remaining global variables and tables in prj-nmsc.adb.\n\n2009-07-13  Emmanuel Briot  <briot@adacore.com>\n\n\t* prj-proc.adb, prj-proc.ads, prj.ads, prj-nmsc.adb, prj-nmsc.ads,\n\tprj-pars.adb, prj-conf.adb, prj-conf.ads: Remove all remaining global\n\tvariables and tables in prj-nmsc.adb.\n\t(Tree_Processing_Data): Renames Processing_Data, some new fields added\n\t(Project_Processing_Data): New record\n\tSimplify/unify check for missing sources.\n\nFrom-SVN: r149558", "tree": {"sha": "50fe25cb1308810069cefd58d6ccb0397db77aaa", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/50fe25cb1308810069cefd58d6ccb0397db77aaa"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/fdd7e7bb1d01de50a07ba1b7f9bf6235b7e89da3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fdd7e7bb1d01de50a07ba1b7f9bf6235b7e89da3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fdd7e7bb1d01de50a07ba1b7f9bf6235b7e89da3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fdd7e7bb1d01de50a07ba1b7f9bf6235b7e89da3/comments", "author": {"login": "briot", "id": 42402, "node_id": "MDQ6VXNlcjQyNDAy", "avatar_url": "https://avatars.githubusercontent.com/u/42402?v=4", "gravatar_id": "", "url": "https://api.github.com/users/briot", "html_url": "https://github.com/briot", "followers_url": "https://api.github.com/users/briot/followers", "following_url": "https://api.github.com/users/briot/following{/other_user}", "gists_url": "https://api.github.com/users/briot/gists{/gist_id}", "starred_url": "https://api.github.com/users/briot/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/briot/subscriptions", "organizations_url": "https://api.github.com/users/briot/orgs", "repos_url": "https://api.github.com/users/briot/repos", "events_url": "https://api.github.com/users/briot/events{/privacy}", "received_events_url": "https://api.github.com/users/briot/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "fc2c32e2a1de9332cf7dbe90f7bd7600945999c3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fc2c32e2a1de9332cf7dbe90f7bd7600945999c3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fc2c32e2a1de9332cf7dbe90f7bd7600945999c3"}], "stats": {"total": 2039, "additions": 899, "deletions": 1140}, "files": [{"sha": "63f938060ec5eb45a4db3079c071e99799cc7c89", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fdd7e7bb1d01de50a07ba1b7f9bf6235b7e89da3/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fdd7e7bb1d01de50a07ba1b7f9bf6235b7e89da3/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=fdd7e7bb1d01de50a07ba1b7f9bf6235b7e89da3", "patch": "@@ -1,3 +1,12 @@\n+2009-07-13  Emmanuel Briot  <briot@adacore.com>\n+\n+\t* prj-proc.adb, prj-proc.ads, prj.ads, prj-nmsc.adb, prj-nmsc.ads,\n+\tprj-pars.adb, prj-conf.adb, prj-conf.ads: Remove all remaining global\n+\tvariables and tables in prj-nmsc.adb.\n+\t(Tree_Processing_Data): Renames Processing_Data, some new fields added\n+\t(Project_Processing_Data): New record\n+\tSimplify/unify check for missing sources.\n+\n 2009-07-13  Emmanuel Briot  <briot@adacore.com>\n \n \t* gnatcmd.adb, make.adb, mlib-prj.adb, prj-part.adb, mlib.adb,"}, {"sha": "e7e297243802e2e64256c6c8157ee5f480dd1e94", "filename": "gcc/ada/prj-conf.adb", "status": "modified", "additions": 12, "deletions": 11, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fdd7e7bb1d01de50a07ba1b7f9bf6235b7e89da3/gcc%2Fada%2Fprj-conf.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fdd7e7bb1d01de50a07ba1b7f9bf6235b7e89da3/gcc%2Fada%2Fprj-conf.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-conf.adb?ref=fdd7e7bb1d01de50a07ba1b7f9bf6235b7e89da3", "patch": "@@ -909,6 +909,7 @@ package body Prj.Conf is\n       Compiler_Driver_Mandatory  : Boolean := True;\n       Allow_Duplicate_Basenames  : Boolean := False;\n       Reset_Tree                 : Boolean := True;\n+      Require_Sources_Other_Lang : Boolean := True;\n       When_No_Sources            : Error_Warning := Warning)\n    is\n       Main_Config_Project : Project_Id;\n@@ -954,17 +955,17 @@ package body Prj.Conf is\n       --  Finish processing the user's project\n \n       Prj.Proc.Process_Project_Tree_Phase_2\n-        (In_Tree                   => Project_Tree,\n-         Project                   => Main_Project,\n-         Success                   => Success,\n-         From_Project_Node         => User_Project_Node,\n-         From_Project_Node_Tree    => Project_Node_Tree,\n-         Report_Error              => Report_Error,\n-         Current_Dir               => Current_Directory,\n-         When_No_Sources           => When_No_Sources,\n-         Compiler_Driver_Mandatory => Compiler_Driver_Mandatory,\n-         Allow_Duplicate_Basenames => Allow_Duplicate_Basenames,\n-         Is_Config_File            => False);\n+        (In_Tree                    => Project_Tree,\n+         Project                    => Main_Project,\n+         Success                    => Success,\n+         From_Project_Node          => User_Project_Node,\n+         From_Project_Node_Tree     => Project_Node_Tree,\n+         Report_Error               => Report_Error,\n+         Current_Dir                => Current_Directory,\n+         When_No_Sources            => When_No_Sources,\n+         Require_Sources_Other_Lang => Require_Sources_Other_Lang,\n+         Compiler_Driver_Mandatory  => Compiler_Driver_Mandatory,\n+         Allow_Duplicate_Basenames  => Allow_Duplicate_Basenames);\n \n       if not Success then\n          Main_Project := No_Project;"}, {"sha": "f95adc144eaccabd819a034b45a23e815ccff96f", "filename": "gcc/ada/prj-conf.ads", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fdd7e7bb1d01de50a07ba1b7f9bf6235b7e89da3/gcc%2Fada%2Fprj-conf.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fdd7e7bb1d01de50a07ba1b7f9bf6235b7e89da3/gcc%2Fada%2Fprj-conf.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-conf.ads?ref=fdd7e7bb1d01de50a07ba1b7f9bf6235b7e89da3", "patch": "@@ -101,13 +101,18 @@ package Prj.Conf is\n       Compiler_Driver_Mandatory  : Boolean := True;\n       Allow_Duplicate_Basenames  : Boolean := False;\n       Reset_Tree                 : Boolean := True;\n+      Require_Sources_Other_Lang : Boolean := True;\n       When_No_Sources            : Error_Warning := Warning);\n    --  Same as above, except the project must already have been parsed through\n    --  Prj.Part.Parse, and only the processing of the project and the\n    --  configuration is done at this level.\n    --  If Reset_Tree is true, all projects are first removed from the tree.\n    --  When_No_Sources indicates what should be done when no sources are found\n    --  for one of the languages of the project.\n+   --  If Require_Sources_Other_Lang is true, then all languages must have at\n+   --  least one source file, or an error is reported via When_No_Sources. If\n+   --  it is false, this is only required for Ada (and only if it is a language\n+   --  of the project).\n \n    Invalid_Config : exception;\n "}, {"sha": "53bd367f1490272a82020e09e8f267d94bc38de2", "filename": "gcc/ada/prj-nmsc.adb", "status": "modified", "additions": 753, "deletions": 1011, "changes": 1764, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fdd7e7bb1d01de50a07ba1b7f9bf6235b7e89da3/gcc%2Fada%2Fprj-nmsc.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fdd7e7bb1d01de50a07ba1b7f9bf6235b7e89da3/gcc%2Fada%2Fprj-nmsc.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-nmsc.adb?ref=fdd7e7bb1d01de50a07ba1b7f9bf6235b7e89da3"}, {"sha": "c706636047d03060519d00d5b04ab7c4f898b9d5", "filename": "gcc/ada/prj-nmsc.ads", "status": "modified", "additions": 54, "deletions": 33, "changes": 87, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fdd7e7bb1d01de50a07ba1b7f9bf6235b7e89da3/gcc%2Fada%2Fprj-nmsc.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fdd7e7bb1d01de50a07ba1b7f9bf6235b7e89da3/gcc%2Fada%2Fprj-nmsc.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-nmsc.ads?ref=fdd7e7bb1d01de50a07ba1b7f9bf6235b7e89da3", "patch": "@@ -25,31 +25,48 @@\n \n --  Perform various checks on a project and find all its source files\n \n+with GNAT.Dynamic_HTables;\n+\n private package Prj.Nmsc is\n \n-   type Processing_Data is private;\n+   type Tree_Processing_Data is private;\n    --  Temporary data which is needed while parsing a project. It does not need\n    --  to be kept in memory once a project has been fully loaded, but is\n    --  necessary while performing consistency checks (duplicate sources,...)\n    --  This data must be initialized before processing any project, and the\n    --  same data is used for processing all projects in the tree.\n \n-   procedure Initialize (Proc_Data : in out Processing_Data);\n-   --  Initialize Proc_Data\n+   procedure Initialize\n+     (Data                       : out Tree_Processing_Data;\n+      Tree                       : Project_Tree_Ref;\n+      Report_Error               : Put_Line_Access;\n+      When_No_Sources            : Error_Warning;\n+      Require_Sources_Other_Lang : Boolean := True;\n+      Allow_Duplicate_Basenames  : Boolean := True;\n+      Compiler_Driver_Mandatory  : Boolean := False);\n+   --  Initialize Data\n+   --  If Allow_Duplicate_Basenames, then files with the same base names are\n+   --  authorized within a project for source-based languages (never for unit\n+   --  based languages)\n+   --  If Compiler_Driver_Mandatory is true, then a Compiler.Driver attribute\n+   --  for each language must be defined, or we will not look for its source\n+   --  files.\n+   --  When_No_Sources indicates what should be done when no sources of a\n+   --  language are found in a project where this language is declared.\n+   --  If Require_Sources_Other_Lang is true, then all languages must have at\n+   --  least one source file, or an error is reported via When_No_Sources. If\n+   --  it is false, this is only required for Ada (and only if it is a language\n+   --  of the project).\n+   --  If Report_Error is null, use the standard error reporting mechanism\n+   --  (Errout). Otherwise, report errors using Report_Error.\n \n-   procedure Free (Proc_Data : in out Processing_Data);\n-   --  Free the memory occupied by Proc_Data\n+   procedure Free (Data : in out Tree_Processing_Data);\n+   --  Free the memory occupied by Data\n \n    procedure Check\n-     (Project                   : Project_Id;\n-      In_Tree                   : Project_Tree_Ref;\n-      Report_Error              : Put_Line_Access;\n-      When_No_Sources           : Error_Warning;\n-      Current_Dir               : String;\n-      Proc_Data                 : in out Processing_Data;\n-      Is_Config_File            : Boolean;\n-      Compiler_Driver_Mandatory : Boolean;\n-      Allow_Duplicate_Basenames : Boolean);\n+     (Project        : Project_Id;\n+      Current_Dir    : String;\n+      Data           : in out Tree_Processing_Data);\n    --  Perform consistency and semantic checks on a project, starting from the\n    --  project tree parsed from the .gpr file. This procedure interprets the\n    --  various case statements in the project based on the current environment\n@@ -61,28 +78,32 @@ private package Prj.Nmsc is\n    --  is Ada_Only, this procedure will only search Ada sources, but in multi-\n    --  language mode it will look for sources for all supported languages.\n    --\n-   --  If Report_Error is null, use the standard error reporting mechanism\n-   --  (Errout). Otherwise, report errors using Report_Error.\n-   --\n    --  Current_Dir is for optimization purposes only, avoiding system calls to\n    --  query it.\n-   --\n-   --  When_No_Sources indicates what should be done when no sources of a\n-   --  language are found in a project where this language is declared.\n-   --\n-   --  Is_Config_File should be True if Project is config file (.cgpr)\n-   --\n-   --  If Compiler_Driver_Mandatory is true, then a Compiler.Driver attribute\n-   --  for each language must be defined, or we will not look for its source\n-   --  files.\n-   --\n-   --  If Allow_Duplicate_Basenames, then files with the same base names are\n-   --  authorized within a project for source-based languages (never for unit\n-   --  based languages)\n \n private\n-   type Processing_Data is record\n-      Units : Files_Htable.Instance;\n-      --  Mapping from file base name to the Source_Id of the file\n+\n+   package Files_Htable is new GNAT.Dynamic_HTables.Simple_HTable\n+     (Header_Num => Header_Num,\n+      Element    => Source_Id,\n+      No_Element => No_Source,\n+      Key        => File_Name_Type,\n+      Hash       => Hash,\n+      Equal      => \"=\");\n+   --  Mapping from base file names to Source_Id (containing full info about\n+   --  the source)\n+\n+   type Tree_Processing_Data is record\n+      Tree                      : Project_Tree_Ref;\n+      --  The data applies when parsing this tree\n+\n+      File_To_Source            : Files_Htable.Instance;\n+\n+      Require_Sources_Other_Lang : Boolean;\n+      Report_Error               : Put_Line_Access;\n+      When_No_Sources            : Error_Warning;\n+      Allow_Duplicate_Basenames  : Boolean := True;\n+      Compiler_Driver_Mandatory  : Boolean := False;\n+      --  See comments for Initialize\n    end record;\n end Prj.Nmsc;"}, {"sha": "239c3ea8332cdada40007fa11937de13ff1beea5", "filename": "gcc/ada/prj-pars.adb", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fdd7e7bb1d01de50a07ba1b7f9bf6235b7e89da3/gcc%2Fada%2Fprj-pars.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fdd7e7bb1d01de50a07ba1b7f9bf6235b7e89da3/gcc%2Fada%2Fprj-pars.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-pars.adb?ref=fdd7e7bb1d01de50a07ba1b7f9bf6235b7e89da3", "patch": "@@ -94,6 +94,7 @@ package body Prj.Pars is\n                Normalized_Hostname        => \"\",\n                Compiler_Driver_Mandatory  => False,\n                Allow_Duplicate_Basenames  => False,\n+               Require_Sources_Other_Lang => False,\n                On_Load_Config             =>\n                  Add_Default_GNAT_Naming_Scheme'Access,\n                Reset_Tree                 => Reset_Tree,"}, {"sha": "ef398133bded395c75b05a87162699eed316fe84", "filename": "gcc/ada/prj-proc.adb", "status": "modified", "additions": 53, "deletions": 61, "changes": 114, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fdd7e7bb1d01de50a07ba1b7f9bf6235b7e89da3/gcc%2Fada%2Fprj-proc.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fdd7e7bb1d01de50a07ba1b7f9bf6235b7e89da3/gcc%2Fada%2Fprj-proc.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-proc.adb?ref=fdd7e7bb1d01de50a07ba1b7f9bf6235b7e89da3", "patch": "@@ -79,17 +79,16 @@ package body Prj.Proc is\n    --  the package or project with declarations Decl.\n \n    procedure Check\n-     (In_Tree                   : Project_Tree_Ref;\n-      Project                   : Project_Id;\n-      Current_Dir               : String;\n-      When_No_Sources           : Error_Warning;\n-      Is_Config_File            : Boolean;\n-      Compiler_Driver_Mandatory : Boolean;\n-      Allow_Duplicate_Basenames : Boolean);\n+     (In_Tree                    : Project_Tree_Ref;\n+      Project                    : Project_Id;\n+      Current_Dir                : String;\n+      When_No_Sources            : Error_Warning;\n+      Require_Sources_Other_Lang : Boolean;\n+      Compiler_Driver_Mandatory  : Boolean;\n+      Allow_Duplicate_Basenames  : Boolean);\n    --  Set all projects to not checked, then call Recursive_Check for the\n    --  main project Project. Project is set to No_Project if errors occurred.\n    --  Current_Dir is for optimization purposes, avoiding extra system calls.\n-   --  Is_Config_File should be True if Project is a config file (.cgpr).\n    --  If Allow_Duplicate_Basenames, then files with the same base names are\n    --  authorized within a project for source-based languages (never for unit\n    --  based languages)\n@@ -152,13 +151,8 @@ package body Prj.Proc is\n    --  project.\n \n    type Recursive_Check_Data is record\n-      In_Tree                   : Project_Tree_Ref;\n       Current_Dir               : String_Access;\n-      When_No_Sources           : Error_Warning;\n-      Proc_Data                 : Processing_Data;\n-      Is_Config_File            : Boolean;\n-      Compiler_Driver_Mandatory : Boolean;\n-      Allow_Duplicate_Basenames : Boolean;\n+      Proc_Data                 : Tree_Processing_Data;\n    end record;\n    --  Data passed to Recursive_Check\n    --  Current_Dir is for optimization purposes, avoiding extra system calls.\n@@ -285,13 +279,13 @@ package body Prj.Proc is\n    -----------\n \n    procedure Check\n-     (In_Tree                   : Project_Tree_Ref;\n-      Project                   : Project_Id;\n-      Current_Dir               : String;\n-      When_No_Sources           : Error_Warning;\n-      Is_Config_File            : Boolean;\n-      Compiler_Driver_Mandatory : Boolean;\n-      Allow_Duplicate_Basenames : Boolean)\n+     (In_Tree                    : Project_Tree_Ref;\n+      Project                    : Project_Id;\n+      Current_Dir                : String;\n+      When_No_Sources            : Error_Warning;\n+      Require_Sources_Other_Lang : Boolean;\n+      Compiler_Driver_Mandatory  : Boolean;\n+      Allow_Duplicate_Basenames  : Boolean)\n    is\n       Dir : aliased String := Current_Dir;\n \n@@ -301,14 +295,16 @@ package body Prj.Proc is\n       Data : Recursive_Check_Data;\n \n    begin\n-      Data.In_Tree                   := In_Tree;\n       Data.Current_Dir               := Dir'Unchecked_Access;\n-      Data.When_No_Sources           := When_No_Sources;\n-      Data.Is_Config_File            := Is_Config_File;\n-      Data.Compiler_Driver_Mandatory := Compiler_Driver_Mandatory;\n-      Data.Allow_Duplicate_Basenames := Allow_Duplicate_Basenames;\n \n-      Initialize (Data.Proc_Data);\n+      Initialize\n+        (Data.Proc_Data,\n+         Tree                       => In_Tree,\n+         Allow_Duplicate_Basenames  => Allow_Duplicate_Basenames,\n+         Require_Sources_Other_Lang => Require_Sources_Other_Lang,\n+         Compiler_Driver_Mandatory  => Compiler_Driver_Mandatory,\n+         When_No_Sources            => When_No_Sources,\n+         Report_Error               => null);\n \n       Check_All_Projects (Project, Data, Imported_First => True);\n \n@@ -1244,8 +1240,7 @@ package body Prj.Proc is\n       Report_Error           : Put_Line_Access;\n       When_No_Sources        : Error_Warning := Error;\n       Reset_Tree             : Boolean       := True;\n-      Current_Dir            : String        := \"\";\n-      Is_Config_File         : Boolean)\n+      Current_Dir            : String        := \"\")\n    is\n    begin\n       Process_Project_Tree_Phase_1\n@@ -1257,19 +1252,21 @@ package body Prj.Proc is\n          Report_Error           => Report_Error,\n          Reset_Tree             => Reset_Tree);\n \n-      if not Is_Config_File then\n+      if Project_Qualifier_Of (From_Project_Node, From_Project_Node_Tree) /=\n+        Configuration\n+      then\n          Process_Project_Tree_Phase_2\n-           (In_Tree                   => In_Tree,\n-            Project                   => Project,\n-            Success                   => Success,\n-            From_Project_Node         => From_Project_Node,\n-            From_Project_Node_Tree    => From_Project_Node_Tree,\n-            Report_Error              => Report_Error,\n-            When_No_Sources           => When_No_Sources,\n-            Current_Dir               => Current_Dir,\n-            Compiler_Driver_Mandatory => True,\n-            Allow_Duplicate_Basenames => False,\n-            Is_Config_File            => Is_Config_File);\n+           (In_Tree                    => In_Tree,\n+            Project                    => Project,\n+            Success                    => Success,\n+            From_Project_Node          => From_Project_Node,\n+            From_Project_Node_Tree     => From_Project_Node_Tree,\n+            Report_Error               => Report_Error,\n+            When_No_Sources            => When_No_Sources,\n+            Current_Dir                => Current_Dir,\n+            Require_Sources_Other_Lang => False,\n+            Compiler_Driver_Mandatory  => True,\n+            Allow_Duplicate_Basenames  => False);\n       end if;\n    end Process;\n \n@@ -2315,17 +2312,17 @@ package body Prj.Proc is\n    ----------------------------------\n \n    procedure Process_Project_Tree_Phase_2\n-     (In_Tree                   : Project_Tree_Ref;\n-      Project                   : Project_Id;\n-      Success                   : out Boolean;\n-      From_Project_Node         : Project_Node_Id;\n-      From_Project_Node_Tree    : Project_Node_Tree_Ref;\n-      Report_Error              : Put_Line_Access;\n-      When_No_Sources           : Error_Warning := Error;\n-      Current_Dir               : String;\n-      Is_Config_File            : Boolean;\n-      Compiler_Driver_Mandatory : Boolean;\n-      Allow_Duplicate_Basenames : Boolean)\n+     (In_Tree                    : Project_Tree_Ref;\n+      Project                    : Project_Id;\n+      Success                    : out Boolean;\n+      From_Project_Node          : Project_Node_Id;\n+      From_Project_Node_Tree     : Project_Node_Tree_Ref;\n+      Report_Error               : Put_Line_Access;\n+      When_No_Sources            : Error_Warning := Error;\n+      Current_Dir                : String;\n+      Require_Sources_Other_Lang : Boolean;\n+      Compiler_Driver_Mandatory  : Boolean;\n+      Allow_Duplicate_Basenames  : Boolean)\n    is\n       Obj_Dir    : Path_Name_Type;\n       Extending  : Project_Id;\n@@ -2341,9 +2338,9 @@ package body Prj.Proc is\n \n       if Project /= No_Project then\n          Check (In_Tree, Project, Current_Dir, When_No_Sources,\n-                Is_Config_File            => Is_Config_File,\n-                Compiler_Driver_Mandatory => Compiler_Driver_Mandatory,\n-                Allow_Duplicate_Basenames => Allow_Duplicate_Basenames);\n+                Require_Sources_Other_Lang => Require_Sources_Other_Lang,\n+                Compiler_Driver_Mandatory  => Compiler_Driver_Mandatory,\n+                Allow_Duplicate_Basenames  => Allow_Duplicate_Basenames);\n       end if;\n \n       --  If main project is an extending all project, set the object\n@@ -2464,12 +2461,7 @@ package body Prj.Proc is\n          Write_Line (\"\"\"\");\n       end if;\n \n-      Prj.Nmsc.Check\n-        (Project, Data.In_Tree, Error_Report, Data.When_No_Sources,\n-         Data.Current_Dir.all, Data.Proc_Data,\n-         Compiler_Driver_Mandatory => Data.Compiler_Driver_Mandatory,\n-         Is_Config_File            => Data.Is_Config_File,\n-         Allow_Duplicate_Basenames => Data.Allow_Duplicate_Basenames);\n+      Prj.Nmsc.Check (Project, Data.Current_Dir.all, Data.Proc_Data);\n    end Recursive_Check;\n \n    -----------------------"}, {"sha": "7be4382a7a11d807eb752a444086422c582506d8", "filename": "gcc/ada/prj-proc.ads", "status": "modified", "additions": 12, "deletions": 15, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fdd7e7bb1d01de50a07ba1b7f9bf6235b7e89da3/gcc%2Fada%2Fprj-proc.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fdd7e7bb1d01de50a07ba1b7f9bf6235b7e89da3/gcc%2Fada%2Fprj-proc.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-proc.ads?ref=fdd7e7bb1d01de50a07ba1b7f9bf6235b7e89da3", "patch": "@@ -58,17 +58,17 @@ package Prj.Proc is\n    --  project table before processing.\n \n    procedure Process_Project_Tree_Phase_2\n-     (In_Tree                   : Project_Tree_Ref;\n-      Project                   : Project_Id;\n-      Success                   : out Boolean;\n-      From_Project_Node         : Project_Node_Id;\n-      From_Project_Node_Tree    : Project_Node_Tree_Ref;\n-      Report_Error              : Put_Line_Access;\n-      When_No_Sources           : Error_Warning := Error;\n-      Current_Dir               : String;\n-      Is_Config_File            : Boolean;\n-      Compiler_Driver_Mandatory : Boolean;\n-      Allow_Duplicate_Basenames : Boolean);\n+     (In_Tree                    : Project_Tree_Ref;\n+      Project                    : Project_Id;\n+      Success                    : out Boolean;\n+      From_Project_Node          : Project_Node_Id;\n+      From_Project_Node_Tree     : Project_Node_Tree_Ref;\n+      Report_Error               : Put_Line_Access;\n+      When_No_Sources            : Error_Warning := Error;\n+      Current_Dir                : String;\n+      Require_Sources_Other_Lang : Boolean;\n+      Compiler_Driver_Mandatory  : Boolean;\n+      Allow_Duplicate_Basenames  : Boolean);\n    --  Perform the second phase of the processing, filling the rest of the\n    --  project with the information extracted from the project tree. This phase\n    --  requires that the configuration file has already been parsed (in fact\n@@ -78,8 +78,6 @@ package Prj.Proc is\n    --\n    --  Current_Dir is for optimization purposes, avoiding extra system calls.\n    --\n-   --  Is_Config_File should be true if Project is a config file (.cgpr)\n-   --\n    --  If Allow_Duplicate_Basenames, then files with the same base names are\n    --  authorized within a project for source-based languages (never for unit\n    --  based languages)\n@@ -93,8 +91,7 @@ package Prj.Proc is\n       Report_Error           : Put_Line_Access;\n       When_No_Sources        : Error_Warning := Error;\n       Reset_Tree             : Boolean := True;\n-      Current_Dir            : String := \"\";\n-      Is_Config_File         : Boolean);\n+      Current_Dir            : String := \"\");\n    --  Performs the two phases of the processing\n \n end Prj.Proc;"}, {"sha": "bf6b03bcbae436c8c4c6dd3c4121844a40d4dc23", "filename": "gcc/ada/prj.ads", "status": "modified", "additions": 0, "deletions": 9, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fdd7e7bb1d01de50a07ba1b7f9bf6235b7e89da3/gcc%2Fada%2Fprj.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fdd7e7bb1d01de50a07ba1b7f9bf6235b7e89da3/gcc%2Fada%2Fprj.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj.ads?ref=fdd7e7bb1d01de50a07ba1b7f9bf6235b7e89da3", "patch": "@@ -1268,15 +1268,6 @@ package Prj is\n       Equal      => \"=\");\n    --  Mapping of unit names to indexes in the Units table\n \n-   package Files_Htable is new Simple_HTable\n-     (Header_Num => Header_Num,\n-      Element    => Source_Id,\n-      No_Element => No_Source,\n-      Key        => File_Name_Type,\n-      Hash       => Hash,\n-      Equal      => \"=\");\n-   --  Mapping of file names to indexes in the Units table\n-\n    ---------------------\n    -- Source_Iterator --\n    ---------------------"}]}