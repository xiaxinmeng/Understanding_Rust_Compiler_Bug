{"sha": "e30ce0a36c89794543381b3699cc23011af4e85c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTMwY2UwYTM2Yzg5Nzk0NTQzMzgxYjM2OTljYzIzMDExYWY0ZTg1Yw==", "commit": {"author": {"name": "Jeff Law", "email": "law@redhat.com", "date": "2017-05-15T17:21:31Z"}, "committer": {"name": "Jeff Law", "email": "law@gcc.gnu.org", "date": "2017-05-15T17:21:31Z"}, "message": "reorg.c (relax_delay_slots): Create a new variable to hold the temporary target rather than clobbering...\n\n\t* reorg.c (relax_delay_slots): Create a new variable to hold\n\tthe temporary target rather than clobbering TARGET_LABEL.\n\n\t* gcc.target/mips/reorgbug-1.c: New test.\n\nFrom-SVN: r248067", "tree": {"sha": "84821df085894cc6ada5cd4b4bedf59d2e828ce9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/84821df085894cc6ada5cd4b4bedf59d2e828ce9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e30ce0a36c89794543381b3699cc23011af4e85c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e30ce0a36c89794543381b3699cc23011af4e85c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e30ce0a36c89794543381b3699cc23011af4e85c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e30ce0a36c89794543381b3699cc23011af4e85c/comments", "author": null, "committer": null, "parents": [{"sha": "cc9d8f3b46c0fbb515199d067789aaf890b62088", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cc9d8f3b46c0fbb515199d067789aaf890b62088", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cc9d8f3b46c0fbb515199d067789aaf890b62088"}], "stats": {"total": 58, "additions": 52, "deletions": 6}, "files": [{"sha": "18b6ed59c73bc21b2943b04cb5089206ab761793", "filename": "gcc/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e30ce0a36c89794543381b3699cc23011af4e85c/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e30ce0a36c89794543381b3699cc23011af4e85c/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=e30ce0a36c89794543381b3699cc23011af4e85c", "patch": "@@ -1,5 +1,8 @@\n 2017-05-15  Jeff Law  <law@redhat.com>\n \n+\t* reorg.c (relax_delay_slots): Create a new variable to hold\n+\tthe temporary target rather than clobbering TARGET_LABEL.\n+\n \t* config/tilegx/tilegx.c (tilegx_expand_unaligned_load): Add\n \tmissing argument to extract_bit_field call.\n \t* config/tilepro/tilepro.c (tilepro_expand_unaligned_load): Likewise."}, {"sha": "1a6fd86e2866fc11051bd9b40ac95b225a96aac3", "filename": "gcc/reorg.c", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e30ce0a36c89794543381b3699cc23011af4e85c/gcc%2Freorg.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e30ce0a36c89794543381b3699cc23011af4e85c/gcc%2Freorg.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Freorg.c?ref=e30ce0a36c89794543381b3699cc23011af4e85c", "patch": "@@ -3351,16 +3351,16 @@ relax_delay_slots (rtx_insn *first)\n \t  && simplejump_or_return_p (trial_seq->insn (0))\n \t  && redundant_insn (trial_seq->insn (1), insn, vNULL))\n \t{\n-\t  target_label = JUMP_LABEL (trial_seq->insn (0));\n-\t  if (ANY_RETURN_P (target_label))\n-\t    target_label = find_end_label (target_label);\n+\t  rtx temp_label = JUMP_LABEL (trial_seq->insn (0));\n+\t  if (ANY_RETURN_P (temp_label))\n+\t    temp_label = find_end_label (temp_label);\n \t  \n-\t  if (target_label\n+\t  if (temp_label\n \t      && redirect_with_delay_slots_safe_p (delay_jump_insn,\n-\t\t\t\t\t\t   target_label, insn))\n+\t\t\t\t\t\t   temp_label, insn))\n \t    {\n \t      update_block (trial_seq->insn (1), insn);\n-\t      reorg_redirect_jump (delay_jump_insn, target_label);\n+\t      reorg_redirect_jump (delay_jump_insn, temp_label);\n \t      next = insn;\n \t      continue;\n \t    }"}, {"sha": "9fb8c8598b8396d5f54fe5ccc2e9b58ce3f47577", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e30ce0a36c89794543381b3699cc23011af4e85c/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e30ce0a36c89794543381b3699cc23011af4e85c/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=e30ce0a36c89794543381b3699cc23011af4e85c", "patch": "@@ -1,3 +1,7 @@\n+2017-05-15  Jeff Law  <law@redhat.com>\n+\n+\t* gcc.target/mips/reorgbug-1.c: New test.\n+\n 2017-05-15  Pierre-Marie de Rodat  <derodat@adacore.com>\n \n \t* gnat.dg/specs/pack13.ads: New test."}, {"sha": "b820a2b5df13ab594e58b691102700f54a6b538b", "filename": "gcc/testsuite/gcc.target/mips/reorgbug-1.c", "status": "added", "additions": 39, "deletions": 0, "changes": 39, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e30ce0a36c89794543381b3699cc23011af4e85c/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Freorgbug-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e30ce0a36c89794543381b3699cc23011af4e85c/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Freorgbug-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Freorgbug-1.c?ref=e30ce0a36c89794543381b3699cc23011af4e85c", "patch": "@@ -0,0 +1,39 @@\n+/* { dg-options \"-O2 -msoft-float -mips2\" } */\n+\n+typedef long int __int32_t;\n+typedef long unsigned int __uint32_t;\n+typedef union\n+{\n+  double value;\n+  struct\n+  {\n+    __uint32_t msw;\n+    __uint32_t lsw;\n+  }\n+  parts;\n+}\n+ieee_double_shape_type;\n+double\n+__ieee754_fmod (double x, double y, int z, int xx)\n+{\n+  __int32_t n, hx, hy, hz, ix, iy, sx, i;\n+  __uint32_t lx, ly, lz;\n+  ieee_double_shape_type ew_u;\n+  ew_u.value = (x);\n+  (lx) = ew_u.parts.lsw;\n+  ew_u.value = (y);\n+  (hy) = ew_u.parts.msw;\n+  (ly) = ew_u.parts.lsw;\n+  if (hy == 0 || hx >= 0x7ff00000)\n+    return (x * y);\n+  if (z)\n+    {\n+      if ((hx < hy) || (lx < ly))\n+\treturn x;\n+      lz = lx - ly;\n+      lx = lz + lz;\n+    }\n+  ieee_double_shape_type iw_u;\n+  iw_u.parts.lsw = (lx);\n+  return iw_u.value;\n+}"}]}