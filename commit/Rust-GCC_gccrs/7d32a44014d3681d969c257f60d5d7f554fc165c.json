{"sha": "7d32a44014d3681d969c257f60d5d7f554fc165c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2QzMmE0NDAxNGQzNjgxZDk2OWMyNTdmNjBkNWQ3ZjU1NGZjMTY1Yw==", "commit": {"author": {"name": "Sebastian Pop", "email": "sebastian.pop@amd.com", "date": "2011-03-02T03:48:44Z"}, "committer": {"name": "Sebastian Pop", "email": "spop@gcc.gnu.org", "date": "2011-03-02T03:48:44Z"}, "message": "Add -lpwl to ppllibs.\n\n2011-03-02  Sebastian Pop  <sebastian.pop@amd.com>\n\n\t* configure.ac: Add -lpwl to ppllibs.\n\t* configure: Regenerated.\n\nFrom-SVN: r170610", "tree": {"sha": "8d7d40603030f117b9ae8a5796f3eca2770d9c73", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8d7d40603030f117b9ae8a5796f3eca2770d9c73"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7d32a44014d3681d969c257f60d5d7f554fc165c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7d32a44014d3681d969c257f60d5d7f554fc165c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7d32a44014d3681d969c257f60d5d7f554fc165c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7d32a44014d3681d969c257f60d5d7f554fc165c/comments", "author": null, "committer": {"login": "sebpop", "id": 568397, "node_id": "MDQ6VXNlcjU2ODM5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/568397?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sebpop", "html_url": "https://github.com/sebpop", "followers_url": "https://api.github.com/users/sebpop/followers", "following_url": "https://api.github.com/users/sebpop/following{/other_user}", "gists_url": "https://api.github.com/users/sebpop/gists{/gist_id}", "starred_url": "https://api.github.com/users/sebpop/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sebpop/subscriptions", "organizations_url": "https://api.github.com/users/sebpop/orgs", "repos_url": "https://api.github.com/users/sebpop/repos", "events_url": "https://api.github.com/users/sebpop/events{/privacy}", "received_events_url": "https://api.github.com/users/sebpop/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3d2bc11b8d07d7efec102710437ff4c159f0bff8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3d2bc11b8d07d7efec102710437ff4c159f0bff8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3d2bc11b8d07d7efec102710437ff4c159f0bff8"}], "stats": {"total": 186, "additions": 136, "deletions": 50}, "files": [{"sha": "29215671a6b17ecb664ad21f30bf01edc80a0019", "filename": "ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7d32a44014d3681d969c257f60d5d7f554fc165c/ChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7d32a44014d3681d969c257f60d5d7f554fc165c/ChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/ChangeLog?ref=7d32a44014d3681d969c257f60d5d7f554fc165c", "patch": "@@ -1,3 +1,8 @@\n+2011-03-02  Sebastian Pop  <sebastian.pop@amd.com>\n+\n+\t* configure.ac: Add -lpwl to ppllibs.\n+\t* configure: Regenerated.\n+\n 2011-03-02  Sebastian Pop  <sebastian.pop@amd.com>\n \n \t* config/cloog.m4: Add -lisl to clooglibs."}, {"sha": "997282f7a805d545e8e0b546ae9957cc3333b88f", "filename": "configure", "status": "modified", "additions": 84, "deletions": 24, "changes": 108, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7d32a44014d3681d969c257f60d5d7f554fc165c/configure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7d32a44014d3681d969c257f60d5d7f554fc165c/configure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/configure?ref=7d32a44014d3681d969c257f60d5d7f554fc165c", "patch": "@@ -5660,8 +5660,9 @@ fi\n \n \n # Check for PPL\n-ppllibs=\" -lppl_c -lppl -lgmpxx\"\n+ppllibs=\n pplinc=\n+pwllib=\n \n \n # Check whether --with-ppl was given.\n@@ -5682,52 +5683,110 @@ if test \"${with_ppl_lib+set}\" = set; then :\n fi\n \n \n+# Check whether --enable-ppl-version-check was given.\n+if test \"${enable_ppl_version_check+set}\" = set; then :\n+  enableval=$enable_ppl_version_check;\n+fi\n+\n+\n case $with_ppl in\n-  no)\n-    ppllibs=\n-    ;;\n-  \"\" | yes)\n+  yes | no | \"\")\n     ;;\n   *)\n-    ppllibs=\"-L$with_ppl/lib -lppl_c -lppl -lgmpxx\"\n+    ppllibs=\"-L$with_ppl/lib\"\n     pplinc=\"-I$with_ppl/include $pplinc\"\n+    if test -d \"$with_ppl/lib\" && test -d \"$with_ppl/include\"; then\n+      with_ppl=yes\n+    else\n+      as_fn_error \"cannot find directories \\\"$with_ppl/lib\\\" or \\\"$with_ppl/include\\\"\" \"$LINENO\" 5\n+    fi\n     ;;\n esac\n-if test \"x$with_ppl_include\" != x; then\n+\n+if test x\"$with_ppl_include\" != x; then\n   pplinc=\"-I$with_ppl_include $pplinc\"\n+  with_ppl=yes\n fi\n+\n if test \"x$with_ppl_lib\" != x; then\n-  ppllibs=\"-L$with_ppl_lib -lppl_c -lppl -lgmpxx\"\n+  ppllibs=\"-L$with_ppl_lib\"\n+  with_ppl=yes\n fi\n-if test \"x$with_ppl$with_ppl_include$with_ppl_lib\" = x && test -d ${srcdir}/ppl; then\n-  ppllibs='-L$$r/$(HOST_SUBDIR)/ppl/interfaces/C/'\"$lt_cv_objdir\"' -L$$r/$(HOST_SUBDIR)/ppl/src/'\"$lt_cv_objdir\"' -lppl_c -lppl -lgmpxx '\n+\n+if test x\"$with_ppl$with_ppl_include$with_ppl_lib\" = x && test -d ${srcdir}/ppl; then\n+  if test x\"$enable_watchdog\" = xyes; then\n+    pwllib=\"-lpwl\"\n+  fi\n+  ppllibs='-L$$r/$(HOST_SUBDIR)/ppl/interfaces/C/'\"$lt_cv_objdir\"' -L$$r/$(HOST_SUBDIR)/ppl/src/'\"$lt_cv_objdir\"\n   pplinc='-I$$r/$(HOST_SUBDIR)/ppl/src -I$$r/$(HOST_SUBDIR)/ppl/interfaces/C '\n   enable_ppl_version_check=no\n+  with_ppl=yes\n fi\n \n-# Check whether --enable-ppl-version-check was given.\n-if test \"${enable_ppl_version_check+set}\" = set; then :\n-  enableval=$enable_ppl_version_check; ENABLE_PPL_CHECK=$enableval\n+if test \"x$with_ppl\" = xyes; then\n+  if test \"x$pwllib\" = x; then\n+    saved_LDFLAGS=\"$LDFLAGS\"\n+    LDFLAGS=\"$LDFLAGS $ppllibs\"\n+    { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for PWL_handle_timeout in -lpwl\" >&5\n+$as_echo_n \"checking for PWL_handle_timeout in -lpwl... \" >&6; }\n+if test \"${ac_cv_lib_pwl_PWL_handle_timeout+set}\" = set; then :\n+  $as_echo_n \"(cached) \" >&6\n+else\n+  ac_check_lib_save_LIBS=$LIBS\n+LIBS=\"-lpwl  $LIBS\"\n+cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n+/* end confdefs.h.  */\n+\n+/* Override any GCC internal prototype to avoid an error.\n+   Use char because int might match the return type of a GCC\n+   builtin and then its argument prototype would still apply.  */\n+#ifdef __cplusplus\n+extern \"C\"\n+#endif\n+char PWL_handle_timeout ();\n+int\n+main ()\n+{\n+return PWL_handle_timeout ();\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+if ac_fn_c_try_link \"$LINENO\"; then :\n+  ac_cv_lib_pwl_PWL_handle_timeout=yes\n else\n-  ENABLE_PPL_CHECK=yes\n+  ac_cv_lib_pwl_PWL_handle_timeout=no\n+fi\n+rm -f core conftest.err conftest.$ac_objext \\\n+    conftest$ac_exeext conftest.$ac_ext\n+LIBS=$ac_check_lib_save_LIBS\n+fi\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_pwl_PWL_handle_timeout\" >&5\n+$as_echo \"$ac_cv_lib_pwl_PWL_handle_timeout\" >&6; }\n+if test \"x$ac_cv_lib_pwl_PWL_handle_timeout\" = x\"\"yes; then :\n+  pwllib=\"-lpwl\"\n fi\n \n+    LDFLAGS=\"$saved_LDFLAGS\"\n+  fi\n \n-if test \"x$with_ppl\" != \"xno\" -a \"${ENABLE_PPL_CHECK}\" = \"yes\"; then\n-  saved_CFLAGS=\"$CFLAGS\"\n-  CFLAGS=\"$CFLAGS $pplinc $gmpinc\"\n-  { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for version 0.11 (or later revision) of PPL\" >&5\n-$as_echo_n \"checking for version 0.11 (or later revision) of PPL... \" >&6; }\n-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n+  ppllibs=\"$ppllibs -lppl_c -lppl $pwllib -lgmpxx\"\n+\n+  if test \"$enable_ppl_version_check\" != no; then\n+    saved_CFLAGS=\"$CFLAGS\"\n+    CFLAGS=\"$CFLAGS $pplinc $gmpinc\"\n+    { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for version 0.11 (revision 0 or later) of PPL\" >&5\n+$as_echo_n \"checking for version 0.11 (revision 0 or later) of PPL... \" >&6; }\n+    cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n /* end confdefs.h.  */\n #include \"ppl_c.h\"\n int\n main ()\n {\n \n-  #if PPL_VERSION_MAJOR != 0 || PPL_VERSION_MINOR < 11\n-  choke me\n-  #endif\n+    #if PPL_VERSION_MAJOR != 0 || PPL_VERSION_MINOR < 11\n+    choke me\n+    #endif\n \n   ;\n   return 0;\n@@ -5741,7 +5800,8 @@ else\n $as_echo \"no\" >&6; }; ppllibs= ; pplinc= ; with_ppl=no\n fi\n rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext\n-  CFLAGS=\"$saved_CFLAGS\"\n+    CFLAGS=\"$saved_CFLAGS\"\n+  fi\n fi\n \n # Flags needed for PPL"}, {"sha": "4fb29c0368686d88145532b2db6a03c21f562f29", "filename": "configure.ac", "status": "modified", "additions": 47, "deletions": 26, "changes": 73, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7d32a44014d3681d969c257f60d5d7f554fc165c/configure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7d32a44014d3681d969c257f60d5d7f554fc165c/configure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/configure.ac?ref=7d32a44014d3681d969c257f60d5d7f554fc165c", "patch": "@@ -1621,8 +1621,9 @@ AC_ARG_WITH(boot-ldflags,\n AC_SUBST(poststage1_ldflags)\n \n # Check for PPL\n-ppllibs=\" -lppl_c -lppl -lgmpxx\"\n+ppllibs=\n pplinc=\n+pwllib=\n \n AC_ARG_WITH(ppl,\n [AS_HELP_STRING([--with-ppl=PATH],\n@@ -1636,45 +1637,65 @@ AC_ARG_WITH(ppl-lib,\n [AS_HELP_STRING([--with-ppl-lib=PATH],\n \t\t[specify directory for the installed PPL library])])\n \n-case $with_ppl in \n-  no)\n-    ppllibs=\n-    ;;\n-  \"\" | yes)\n+AC_ARG_ENABLE(ppl-version-check,\n+[AS_HELP_STRING([--disable-ppl-version-check],\n+\t\t[disable check for PPL version])])\n+\n+case $with_ppl in\n+  yes | no | \"\")\n     ;;\n   *)\n-    ppllibs=\"-L$with_ppl/lib -lppl_c -lppl -lgmpxx\"\n+    ppllibs=\"-L$with_ppl/lib\"\n     pplinc=\"-I$with_ppl/include $pplinc\"\n+    if test -d \"$with_ppl/lib\" && test -d \"$with_ppl/include\"; then\n+      with_ppl=yes\n+    else\n+      AC_MSG_ERROR([cannot find directories \"$with_ppl/lib\" or \"$with_ppl/include\"])\n+    fi\n     ;;\n esac\n-if test \"x$with_ppl_include\" != x; then\n+\n+if test x\"$with_ppl_include\" != x; then\n   pplinc=\"-I$with_ppl_include $pplinc\"\n+  with_ppl=yes\n fi\n+\n if test \"x$with_ppl_lib\" != x; then\n-  ppllibs=\"-L$with_ppl_lib -lppl_c -lppl -lgmpxx\"\n+  ppllibs=\"-L$with_ppl_lib\"\n+  with_ppl=yes\n fi\n-if test \"x$with_ppl$with_ppl_include$with_ppl_lib\" = x && test -d ${srcdir}/ppl; then\n-  ppllibs='-L$$r/$(HOST_SUBDIR)/ppl/interfaces/C/'\"$lt_cv_objdir\"' -L$$r/$(HOST_SUBDIR)/ppl/src/'\"$lt_cv_objdir\"' -lppl_c -lppl -lgmpxx '\n+\n+if test x\"$with_ppl$with_ppl_include$with_ppl_lib\" = x && test -d ${srcdir}/ppl; then\n+  if test x\"$enable_watchdog\" = xyes; then\n+    pwllib=\"-lpwl\"\n+  fi\n+  ppllibs='-L$$r/$(HOST_SUBDIR)/ppl/interfaces/C/'\"$lt_cv_objdir\"' -L$$r/$(HOST_SUBDIR)/ppl/src/'\"$lt_cv_objdir\"\n   pplinc='-I$$r/$(HOST_SUBDIR)/ppl/src -I$$r/$(HOST_SUBDIR)/ppl/interfaces/C '\n   enable_ppl_version_check=no\n+  with_ppl=yes\n fi\n \n-AC_ARG_ENABLE(ppl-version-check,\n-[AS_HELP_STRING([--disable-ppl-version-check],\n-\t\t[disable check for PPL version])],\n-ENABLE_PPL_CHECK=$enableval,\n-ENABLE_PPL_CHECK=yes)\n+if test \"x$with_ppl\" = xyes; then\n+  if test \"x$pwllib\" = x; then\n+    saved_LDFLAGS=\"$LDFLAGS\"\n+    LDFLAGS=\"$LDFLAGS $ppllibs\"\n+    AC_CHECK_LIB(pwl,PWL_handle_timeout,[pwllib=\"-lpwl\"])\n+    LDFLAGS=\"$saved_LDFLAGS\"\n+  fi\n \n-if test \"x$with_ppl\" != \"xno\" -a \"${ENABLE_PPL_CHECK}\" = \"yes\"; then\n-  saved_CFLAGS=\"$CFLAGS\"\n-  CFLAGS=\"$CFLAGS $pplinc $gmpinc\"\n-  AC_MSG_CHECKING([for version 0.11 (or later revision) of PPL])\n-  AC_TRY_COMPILE([#include \"ppl_c.h\"],[\n-  #if PPL_VERSION_MAJOR != 0 || PPL_VERSION_MINOR < 11\n-  choke me\n-  #endif\n-  ], [AC_MSG_RESULT([yes])], [AC_MSG_RESULT([no]); ppllibs= ; pplinc= ; with_ppl=no ])\n-  CFLAGS=\"$saved_CFLAGS\"\n+  ppllibs=\"$ppllibs -lppl_c -lppl $pwllib -lgmpxx\"\n+\n+  if test \"$enable_ppl_version_check\" != no; then\n+    saved_CFLAGS=\"$CFLAGS\"\n+    CFLAGS=\"$CFLAGS $pplinc $gmpinc\"\n+    AC_MSG_CHECKING([for version 0.11 (revision 0 or later) of PPL])\n+    AC_TRY_COMPILE([#include \"ppl_c.h\"],[\n+    #if PPL_VERSION_MAJOR != 0 || PPL_VERSION_MINOR < 11\n+    choke me\n+    #endif\n+    ], [AC_MSG_RESULT([yes])], [AC_MSG_RESULT([no]); ppllibs= ; pplinc= ; with_ppl=no ])\n+    CFLAGS=\"$saved_CFLAGS\"\n+  fi\n fi\n \n # Flags needed for PPL"}]}