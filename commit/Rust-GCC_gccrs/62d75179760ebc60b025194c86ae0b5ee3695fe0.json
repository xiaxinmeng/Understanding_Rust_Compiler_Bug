{"sha": "62d75179760ebc60b025194c86ae0b5ee3695fe0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjJkNzUxNzk3NjBlYmM2MGIwMjUxOTRjODZhZTBiNWVlMzY5NWZlMA==", "commit": {"author": {"name": "H.J. Lu", "email": "hjl@gcc.gnu.org", "date": "2007-08-27T14:14:31Z"}, "committer": {"name": "H.J. Lu", "email": "hjl@gcc.gnu.org", "date": "2007-08-27T14:14:31Z"}, "message": "re PR target/31385 (gcc fails to find spill register for decimal arithmetic)\n\ngcc/\n\n2007-08-27  H.J. Lu  <hongjiu.lu@intel.com>\n\n\tPR target/31385\n\t* config/i386/i386.h (VALID_DFP_MODE_P): New.\n\t* config/i386/i386.c (ix86_hard_regno_mode_ok): Allow DFP in\n\tGPR.\n\ngcc/testsuite/\n\n2007-08-27  H.J. Lu  <hongjiu.lu@intel.com>\n\n\tPR target/31385\n\t* gcc.dg/dfp/pr31385.c: New.\n\nFrom-SVN: r127833", "tree": {"sha": "74057d0c8939679c68d2a3aa3e5c182f1385c913", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/74057d0c8939679c68d2a3aa3e5c182f1385c913"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/62d75179760ebc60b025194c86ae0b5ee3695fe0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/62d75179760ebc60b025194c86ae0b5ee3695fe0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/62d75179760ebc60b025194c86ae0b5ee3695fe0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/62d75179760ebc60b025194c86ae0b5ee3695fe0/comments", "author": null, "committer": null, "parents": [{"sha": "b5deb7b691b1ef2afe673899d021e17143e0c957", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b5deb7b691b1ef2afe673899d021e17143e0c957", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b5deb7b691b1ef2afe673899d021e17143e0c957"}], "stats": {"total": 49, "additions": 48, "deletions": 1}, "files": [{"sha": "91d1bfa9d55e1fe50577c50dc6f85e220f71129b", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/62d75179760ebc60b025194c86ae0b5ee3695fe0/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/62d75179760ebc60b025194c86ae0b5ee3695fe0/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=62d75179760ebc60b025194c86ae0b5ee3695fe0", "patch": "@@ -1,6 +1,13 @@\n+2007-08-27  H.J. Lu  <hongjiu.lu@intel.com>\n+\n+\tPR target/31385\n+\t* config/i386/i386.h (VALID_DFP_MODE_P): New.\n+\t* config/i386/i386.c (ix86_hard_regno_mode_ok): Allow DFP in\n+\tGPR.\n+\n 2007-08-27  Sandra Loosemore  <sandra@codesourcery.com>\n \t    David Ung  <davidu@mips.com>\n-            Nigel Stephens <nigel@mips.com>\n+\t    Nigel Stephens <nigel@mips.com>\n \n \tSeparate target-specific initialization from general\n \tback-end initialization."}, {"sha": "7fdae6c7136f6c0d04c12c3e2d66c4aceb139111", "filename": "gcc/config/i386/i386.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/62d75179760ebc60b025194c86ae0b5ee3695fe0/gcc%2Fconfig%2Fi386%2Fi386.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/62d75179760ebc60b025194c86ae0b5ee3695fe0/gcc%2Fconfig%2Fi386%2Fi386.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386.c?ref=62d75179760ebc60b025194c86ae0b5ee3695fe0", "patch": "@@ -20568,6 +20568,8 @@ ix86_hard_regno_mode_ok (int regno, enum machine_mode mode)\n     return 1;\n   else if (VALID_FP_MODE_P (mode))\n     return 1;\n+  else if (VALID_DFP_MODE_P (mode))\n+    return 1;\n   /* Lots of MMX code casts 8 byte vector modes to DImode.  If we then go\n      on to use that value in smaller contexts, this can easily force a\n      pseudo to be allocated to GENERAL_REGS.  Since this is no worse than"}, {"sha": "93e24dd90fbff89cbcc08d281709931db3f28baa", "filename": "gcc/config/i386/i386.h", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/62d75179760ebc60b025194c86ae0b5ee3695fe0/gcc%2Fconfig%2Fi386%2Fi386.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/62d75179760ebc60b025194c86ae0b5ee3695fe0/gcc%2Fconfig%2Fi386%2Fi386.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386.h?ref=62d75179760ebc60b025194c86ae0b5ee3695fe0", "patch": "@@ -1088,6 +1088,9 @@ do {\t\t\t\t\t\t\t\t\t\\\n    place emms and femms instructions.  */\n #define UNITS_PER_SIMD_WORD (TARGET_SSE ? 16 : UNITS_PER_WORD)\n \n+#define VALID_DFP_MODE_P(MODE)\t\t\t\t\t\t\\\n+    ((MODE) == SDmode || (MODE) == DDmode || (MODE) == TDmode)\n+\n #define VALID_FP_MODE_P(MODE)\t\t\t\t\t\t\\\n     ((MODE) == SFmode || (MODE) == DFmode || (MODE) == XFmode\t\t\\\n      || (MODE) == SCmode || (MODE) == DCmode || (MODE) == XCmode)\t\\"}, {"sha": "301693a76f714e155ca0693c8d09567342702144", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/62d75179760ebc60b025194c86ae0b5ee3695fe0/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/62d75179760ebc60b025194c86ae0b5ee3695fe0/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=62d75179760ebc60b025194c86ae0b5ee3695fe0", "patch": "@@ -1,3 +1,8 @@\n+2007-08-27  H.J. Lu  <hongjiu.lu@intel.com>\n+\n+\tPR target/31385\n+\t* gcc.dg/dfp/pr31385.c: New.\n+\n 2007-08-27  Uros Bizjak  <ubizjak@gmail.com>\n \n \t* gcc.dg/unsigned-long-compare.c: Remove target selector."}, {"sha": "63a23c4bb750833ed6de8f03a1ebdbe46afffaf0", "filename": "gcc/testsuite/gcc.dg/dfp/pr31385.c", "status": "added", "additions": 30, "deletions": 0, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/62d75179760ebc60b025194c86ae0b5ee3695fe0/gcc%2Ftestsuite%2Fgcc.dg%2Fdfp%2Fpr31385.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/62d75179760ebc60b025194c86ae0b5ee3695fe0/gcc%2Ftestsuite%2Fgcc.dg%2Fdfp%2Fpr31385.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fdfp%2Fpr31385.c?ref=62d75179760ebc60b025194c86ae0b5ee3695fe0", "patch": "@@ -0,0 +1,30 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-std=gnu99 -O2\" } */\n+\n+typedef _Decimal32 fp_t;\n+\n+extern fp_t g(fp_t);\n+\n+fp_t\n+bug(fp_t x)\n+{\n+    fp_t result;\n+    int n;\n+    fp_t f, f3, y, z;\n+\n+    n = 0;\n+    y = 1.DF;\n+    f = g(x);\n+\n+    if (f < 0.DF)\n+        f = -f;\n+\n+    f3 = 2.DF;\n+\n+    z = (y + y + f / (y * y));\n+    y = (z + z) / (9.DF) + f3 / (z * z);\n+\n+    result = y;\n+\n+    return (result);\n+}"}]}