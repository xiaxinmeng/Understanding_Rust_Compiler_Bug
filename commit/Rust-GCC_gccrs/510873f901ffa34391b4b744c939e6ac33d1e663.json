{"sha": "510873f901ffa34391b4b744c939e6ac33d1e663", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTEwODczZjkwMWZmYTM0MzkxYjRiNzQ0YzkzOWU2YWMzM2QxZTY2Mw==", "commit": {"author": {"name": "Jan Hubicka", "email": "hubicka@ucw.cz", "date": "2019-12-13T18:43:20Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2019-12-13T18:43:20Z"}, "message": "lto-streamer-in.c (input_function): Add node parameter.\n\n\n\t* lto-streamer-in.c (input_function): Add node parameter.\n\t(lto_read_body_or_constructor): Use it.\n\nFrom-SVN: r279379", "tree": {"sha": "9ba13d1d0b439ad2ed851344c144a0550c4465ba", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9ba13d1d0b439ad2ed851344c144a0550c4465ba"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/510873f901ffa34391b4b744c939e6ac33d1e663", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/510873f901ffa34391b4b744c939e6ac33d1e663", "html_url": "https://github.com/Rust-GCC/gccrs/commit/510873f901ffa34391b4b744c939e6ac33d1e663", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/510873f901ffa34391b4b744c939e6ac33d1e663/comments", "author": null, "committer": null, "parents": [{"sha": "26b74ed0223d108d7d7818c3c860f20cfe81a4af", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/26b74ed0223d108d7d7818c3c860f20cfe81a4af", "html_url": "https://github.com/Rust-GCC/gccrs/commit/26b74ed0223d108d7d7818c3c860f20cfe81a4af"}], "stats": {"total": 15, "additions": 9, "deletions": 6}, "files": [{"sha": "06b94444800a1ff3c58a1fdf5d7bb874dfcc9c2b", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/510873f901ffa34391b4b744c939e6ac33d1e663/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/510873f901ffa34391b4b744c939e6ac33d1e663/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=510873f901ffa34391b4b744c939e6ac33d1e663", "patch": "@@ -1,3 +1,8 @@\n+2019-12-13  Jan Hubicka  <hubicka@ucw.cz>\n+\n+\t* lto-streamer-in.c (input_function): Add node parameter.\n+\t(lto_read_body_or_constructor): Use it.\n+\n 2019-12-13  Roman Zhuykov  <zhroma@ispras.ru>\n \n \tPR rtl-optimization/92591"}, {"sha": "675e1a7a15343cf37fbb28b3ee8a08ee7163fd62", "filename": "gcc/lto-streamer-in.c", "status": "modified", "additions": 4, "deletions": 6, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/510873f901ffa34391b4b744c939e6ac33d1e663/gcc%2Flto-streamer-in.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/510873f901ffa34391b4b744c939e6ac33d1e663/gcc%2Flto-streamer-in.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flto-streamer-in.c?ref=510873f901ffa34391b4b744c939e6ac33d1e663", "patch": "@@ -1022,13 +1022,13 @@ input_struct_function_base (struct function *fn, class data_in *data_in,\n \n static void\n input_function (tree fn_decl, class data_in *data_in,\n-\t\tclass lto_input_block *ib, class lto_input_block *ib_cfg)\n+\t\tclass lto_input_block *ib, class lto_input_block *ib_cfg,\n+\t\tcgraph_node *node)\n {\n   struct function *fn;\n   enum LTO_tags tag;\n   gimple **stmts;\n   basic_block bb;\n-  struct cgraph_node *node;\n \n   tag = streamer_read_record_start (ib);\n   lto_tag_check (tag, LTO_function);\n@@ -1064,9 +1064,6 @@ input_function (tree fn_decl, class data_in *data_in,\n \n   gimple_register_cfg_hooks ();\n \n-  node = cgraph_node::get (fn_decl);\n-  if (!node)\n-    node = cgraph_node::create (fn_decl);\n   input_struct_function_base (fn, data_in, ib);\n   input_cfg (ib_cfg, data_in, fn);\n \n@@ -1293,7 +1290,8 @@ lto_read_body_or_constructor (struct lto_file_decl_data *file_data, struct symta\n \t{\n \t  lto_input_block ib_cfg (data + cfg_offset, header->cfg_size,\n \t\t\t\t  file_data->mode_table);\n-\t  input_function (fn_decl, data_in, &ib_main, &ib_cfg);\n+\t  input_function (fn_decl, data_in, &ib_main, &ib_cfg,\n+\t\t\t  dyn_cast <cgraph_node *>(node));\n \t}\n       else\n         input_constructor (fn_decl, data_in, &ib_main);"}]}