{"sha": "b9ca913b6a886bfb72c03704cc3c9492ebdb562b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjljYTkxM2I2YTg4NmJmYjcyYzAzNzA0Y2MzYzk0OTJlYmRiNTYyYg==", "commit": {"author": {"name": "Martin Liska", "email": "mliska@suse.cz", "date": "2020-05-29T11:55:35Z"}, "committer": {"name": "Martin Liska", "email": "mliska@suse.cz", "date": "2020-05-29T15:25:02Z"}, "message": "Error for missing change description in git_commit.py.\n\ncontrib/ChangeLog:\n\n\t* gcc-changelog/git_commit.py: Find empty change descriptions.\n\t* gcc-changelog/test_email.py: New test.\n\t* gcc-changelog/test_patches.txt: New patch that tests that.", "tree": {"sha": "292fb2d8238039320da19cee1a6f369c25a46b38", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/292fb2d8238039320da19cee1a6f369c25a46b38"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b9ca913b6a886bfb72c03704cc3c9492ebdb562b", "comment_count": 0, "verification": {"verified": false, "reason": "unknown_key", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQEzBAABCAAdFiEE6I4wzqqylQBfXaRhTcGC3A+nN4UFAl7RKU4ACgkQTcGC3A+n\nN4Vtngf6A6LxSkEBu4TC5m1TeoLD1/CbOAkTbqU0nkRV6ihaUNzlW3UMxQbiiZel\nymAmvsUWidJYmya9SCri/qCUirksqc6H821lPi27KF2MyxAgGfU1dgvEyErRshQg\nKl1zgp4oT66K3BQOC+UyisGvCdFx6UgtJxe0XDzbkn/Z6+JTZTtkcKfq9kBa2S9S\n4JMlf/0RmAe3jZTCGsNJe94nTtZVsPnO0ISBkuAtthBxrN9kXNyxa9Fga3CNPDxr\ngRvu+wCWGm76HwT778HDKd7J7b2k2XC/+7tYe5LcOICmp5mtRDo6KPSRnyj9WxI1\nY1UP3DOMiPptgEud8gxxRUC41eMpmw==\n=LIgR\n-----END PGP SIGNATURE-----", "payload": "tree 292fb2d8238039320da19cee1a6f369c25a46b38\nparent 5e54b01f2b5cc7fd7c3523563e2db751e0706ff6\nauthor Martin Liska <mliska@suse.cz> 1590753335 +0200\ncommitter Martin Liska <mliska@suse.cz> 1590765902 +0200\n\nError for missing change description in git_commit.py.\n\ncontrib/ChangeLog:\n\n\t* gcc-changelog/git_commit.py: Find empty change descriptions.\n\t* gcc-changelog/test_email.py: New test.\n\t* gcc-changelog/test_patches.txt: New patch that tests that.\n"}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b9ca913b6a886bfb72c03704cc3c9492ebdb562b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b9ca913b6a886bfb72c03704cc3c9492ebdb562b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b9ca913b6a886bfb72c03704cc3c9492ebdb562b/comments", "author": {"login": "marxin", "id": 2658545, "node_id": "MDQ6VXNlcjI2NTg1NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/2658545?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marxin", "html_url": "https://github.com/marxin", "followers_url": "https://api.github.com/users/marxin/followers", "following_url": "https://api.github.com/users/marxin/following{/other_user}", "gists_url": "https://api.github.com/users/marxin/gists{/gist_id}", "starred_url": "https://api.github.com/users/marxin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marxin/subscriptions", "organizations_url": "https://api.github.com/users/marxin/orgs", "repos_url": "https://api.github.com/users/marxin/repos", "events_url": "https://api.github.com/users/marxin/events{/privacy}", "received_events_url": "https://api.github.com/users/marxin/received_events", "type": "User", "site_admin": false}, "committer": {"login": "marxin", "id": 2658545, "node_id": "MDQ6VXNlcjI2NTg1NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/2658545?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marxin", "html_url": "https://github.com/marxin", "followers_url": "https://api.github.com/users/marxin/followers", "following_url": "https://api.github.com/users/marxin/following{/other_user}", "gists_url": "https://api.github.com/users/marxin/gists{/gist_id}", "starred_url": "https://api.github.com/users/marxin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marxin/subscriptions", "organizations_url": "https://api.github.com/users/marxin/orgs", "repos_url": "https://api.github.com/users/marxin/repos", "events_url": "https://api.github.com/users/marxin/events{/privacy}", "received_events_url": "https://api.github.com/users/marxin/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5e54b01f2b5cc7fd7c3523563e2db751e0706ff6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5e54b01f2b5cc7fd7c3523563e2db751e0706ff6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5e54b01f2b5cc7fd7c3523563e2db751e0706ff6"}], "stats": {"total": 44, "additions": 44, "deletions": 0}, "files": [{"sha": "4f82b58f64b96c4655f01714cda33203589afb59", "filename": "contrib/gcc-changelog/git_commit.py", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b9ca913b6a886bfb72c03704cc3c9492ebdb562b/contrib%2Fgcc-changelog%2Fgit_commit.py", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b9ca913b6a886bfb72c03704cc3c9492ebdb562b/contrib%2Fgcc-changelog%2Fgit_commit.py", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2Fgcc-changelog%2Fgit_commit.py?ref=b9ca913b6a886bfb72c03704cc3c9492ebdb562b", "patch": "@@ -274,6 +274,7 @@ def __init__(self, hexsha, date, author, body, modified_files,\n         self.parse_lines(all_are_ignored)\n         if self.changes:\n             self.parse_changelog()\n+            self.check_for_empty_description()\n             self.deduce_changelog_locations()\n             if not self.errors:\n                 self.check_mentioned_files()\n@@ -440,6 +441,15 @@ def parse_changelog(self):\n                         else:\n                             last_entry.lines.append(line)\n \n+    def check_for_empty_description(self):\n+        for entry in self.changelog_entries:\n+            for i, line in enumerate(entry.lines):\n+                if (star_prefix_regex.match(line) and line.endswith(':') and\n+                    (i == len(entry.lines) - 1\n+                     or star_prefix_regex.match(entry.lines[i + 1]))):\n+                    msg = 'missing description of a change'\n+                    self.errors.append(Error(msg, line))\n+\n     def get_file_changelog_location(self, changelog_file):\n         for file in self.modified_files:\n             if file[0] == changelog_file:"}, {"sha": "158eb6513679a9cb201dab8e91b0cd5089d3ab9e", "filename": "contrib/gcc-changelog/test_email.py", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b9ca913b6a886bfb72c03704cc3c9492ebdb562b/contrib%2Fgcc-changelog%2Ftest_email.py", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b9ca913b6a886bfb72c03704cc3c9492ebdb562b/contrib%2Fgcc-changelog%2Ftest_email.py", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2Fgcc-changelog%2Ftest_email.py?ref=b9ca913b6a886bfb72c03704cc3c9492ebdb562b", "patch": "@@ -312,3 +312,9 @@ def test_duplicite_author_lines(self):\n                 == 'Steven G. Kargl  <kargl@gcc.gnu.org>')\n         assert (email.changelog_entries[0].author_lines[1][0]\n                 == 'Mark Eggleston  <markeggleston@gcc.gnu.org>')\n+\n+    def test_missing_change_description(self):\n+        email = self.from_patch_glob('0001-Missing-change-description.patch')\n+        assert len(email.errors) == 2\n+        assert email.errors[0].message == 'missing description of a change'\n+        assert email.errors[1].message == 'missing description of a change'"}, {"sha": "25311fbf3006d1c09dc3b559fa2c23719e8c8a01", "filename": "contrib/gcc-changelog/test_patches.txt", "status": "modified", "additions": 28, "deletions": 0, "changes": 28, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b9ca913b6a886bfb72c03704cc3c9492ebdb562b/contrib%2Fgcc-changelog%2Ftest_patches.txt", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b9ca913b6a886bfb72c03704cc3c9492ebdb562b/contrib%2Fgcc-changelog%2Ftest_patches.txt", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2Fgcc-changelog%2Ftest_patches.txt?ref=b9ca913b6a886bfb72c03704cc3c9492ebdb562b", "patch": "@@ -2945,3 +2945,31 @@ index 00000000000..fda10c1a88b\n +\n -- \n 2.26.2\n+\n+=== 0001-Missing-change-description.patch ===\n+From 8ec655bd94615ba45adabae9b50df299edb74eda Mon Sep 17 00:00:00 2001\n+From: Martin Liska <mliska@suse.cz>\n+Date: Fri, 29 May 2020 13:42:57 +0200\n+Subject: [PATCH] Test me.\n+\n+gcc/ChangeLog:\n+\n+\t* ipa-icf-gimple.c (compare_gimple_asm):\n+\t* ipa-icf-gimple2.c (compare_gimple_asm): Good.\n+\t* ipa-icf-gimple3.c (compare_gimple_asm):\n+---\n+ contrib/gcc-changelog/git_commit.py | 10 ++++++++++\n+ gcc/ipa-icf-gimple.c                |  1 +\n+ 2 files changed, 11 insertions(+)\n+\n+diff --git a/gcc/ipa-icf-gimple.c b/gcc/ipa-icf-gimple.c\n+index 1cd5872c03d..6f95aedb3d3 100644\n+--- a/gcc/ipa-icf-gimple.c\n++++ b/gcc/ipa-icf-gimple.c\n+@@ -850,3 +850,4 @@\n+ }\n+ \n+ } // ipa_icf_gimple namespace\n++\n+-- \n+2.26.2"}]}