{"sha": "c566b8285e00ca746f6e747e78d54fad02fb746e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzU2NmI4Mjg1ZTAwY2E3NDZmNmU3NDdlNzhkNTRmYWQwMmZiNzQ2ZQ==", "commit": {"author": {"name": "David Malcolm", "email": "dmalcolm@redhat.com", "date": "2014-08-22T00:32:20Z"}, "committer": {"name": "David Malcolm", "email": "dmalcolm@gcc.gnu.org", "date": "2014-08-22T00:32:20Z"}, "message": "compare-elim.c: Use rtx_insn\n\ngcc/\n2014-08-22  David Malcolm  <dmalcolm@redhat.com>\n\n\t* compare-elim.c (struct comparison_use): Strengthen field \"insn\"\n\tfrom rtx to rtx_insn *.\n\t(struct comparison): Likewise, also for field \"prev_clobber\".\n\t(conforming_compare): Likewise for param \"insn\".\n\t(arithmetic_flags_clobber_p): Likewise.\n\t(find_flags_uses_in_insn): Likewise.\n\t(find_comparison_dom_walker::before_dom_children): Likewise for\n\tlocals \"insn\", \"next\", \"last_clobber\".\n\t(try_eliminate_compare): Likewise for locals \"insn\", \"bb_head\".\n\nFrom-SVN: r214302", "tree": {"sha": "f4dab3b010aa7ec567709cc84ffe8226945207a7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f4dab3b010aa7ec567709cc84ffe8226945207a7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c566b8285e00ca746f6e747e78d54fad02fb746e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c566b8285e00ca746f6e747e78d54fad02fb746e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c566b8285e00ca746f6e747e78d54fad02fb746e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c566b8285e00ca746f6e747e78d54fad02fb746e/comments", "author": {"login": "davidmalcolm", "id": 1553248, "node_id": "MDQ6VXNlcjE1NTMyNDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1553248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidmalcolm", "html_url": "https://github.com/davidmalcolm", "followers_url": "https://api.github.com/users/davidmalcolm/followers", "following_url": "https://api.github.com/users/davidmalcolm/following{/other_user}", "gists_url": "https://api.github.com/users/davidmalcolm/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidmalcolm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidmalcolm/subscriptions", "organizations_url": "https://api.github.com/users/davidmalcolm/orgs", "repos_url": "https://api.github.com/users/davidmalcolm/repos", "events_url": "https://api.github.com/users/davidmalcolm/events{/privacy}", "received_events_url": "https://api.github.com/users/davidmalcolm/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "71e88baf6b32ccc46e745d601b897757ed7f981c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/71e88baf6b32ccc46e745d601b897757ed7f981c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/71e88baf6b32ccc46e745d601b897757ed7f981c"}], "stats": {"total": 31, "additions": 22, "deletions": 9}, "files": [{"sha": "321bd36e35f25e8797503749104e99c273ed6013", "filename": "gcc/ChangeLog", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c566b8285e00ca746f6e747e78d54fad02fb746e/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c566b8285e00ca746f6e747e78d54fad02fb746e/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=c566b8285e00ca746f6e747e78d54fad02fb746e", "patch": "@@ -1,3 +1,15 @@\n+2014-08-22  David Malcolm  <dmalcolm@redhat.com>\n+\n+\t* compare-elim.c (struct comparison_use): Strengthen field \"insn\"\n+\tfrom rtx to rtx_insn *.\n+\t(struct comparison): Likewise, also for field \"prev_clobber\".\n+\t(conforming_compare): Likewise for param \"insn\".\n+\t(arithmetic_flags_clobber_p): Likewise.\n+\t(find_flags_uses_in_insn): Likewise.\n+\t(find_comparison_dom_walker::before_dom_children): Likewise for\n+\tlocals \"insn\", \"next\", \"last_clobber\".\n+\t(try_eliminate_compare): Likewise for locals \"insn\", \"bb_head\".\n+\n 2014-08-22  David Malcolm  <dmalcolm@redhat.com>\n \n \t* combine-stack-adj.c (struct csa_reflist): Strengthen field"}, {"sha": "7e12e36896ed92403d34b6d02bd905e4ea8834d3", "filename": "gcc/compare-elim.c", "status": "modified", "additions": 10, "deletions": 9, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c566b8285e00ca746f6e747e78d54fad02fb746e/gcc%2Fcompare-elim.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c566b8285e00ca746f6e747e78d54fad02fb746e/gcc%2Fcompare-elim.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcompare-elim.c?ref=c566b8285e00ca746f6e747e78d54fad02fb746e", "patch": "@@ -81,7 +81,7 @@ along with GCC; see the file COPYING3.  If not see\n struct comparison_use\n {\n   /* The instruction in which the result of the compare is used.  */\n-  rtx insn;\n+  rtx_insn *insn;\n   /* The location of the flags register within the use.  */\n   rtx *loc;\n   /* The comparison code applied against the flags register.  */\n@@ -91,10 +91,10 @@ struct comparison_use\n struct comparison\n {\n   /* The comparison instruction.  */\n-  rtx insn;\n+  rtx_insn *insn;\n \n   /* The insn prior to the comparison insn that clobbers the flags.  */\n-  rtx prev_clobber;\n+  rtx_insn *prev_clobber;\n \n   /* The two values being compared.  These will be either REGs or\n      constants.  */\n@@ -129,7 +129,7 @@ static vec<comparison_struct_p> all_compares;\n    the rtx for the COMPARE itself.  */\n \n static rtx\n-conforming_compare (rtx insn)\n+conforming_compare (rtx_insn *insn)\n {\n   rtx set, src, dest;\n \n@@ -159,7 +159,7 @@ conforming_compare (rtx insn)\n    correct.  The term \"arithmetic\" may be somewhat misleading...  */\n \n static bool\n-arithmetic_flags_clobber_p (rtx insn)\n+arithmetic_flags_clobber_p (rtx_insn *insn)\n {\n   rtx pat, x;\n \n@@ -194,7 +194,7 @@ arithmetic_flags_clobber_p (rtx insn)\n    it in CMP; otherwise indicate that we've missed a use.  */\n \n static void\n-find_flags_uses_in_insn (struct comparison *cmp, rtx insn)\n+find_flags_uses_in_insn (struct comparison *cmp, rtx_insn *insn)\n {\n   df_ref use;\n \n@@ -263,7 +263,7 @@ void\n find_comparison_dom_walker::before_dom_children (basic_block bb)\n {\n   struct comparison *last_cmp;\n-  rtx insn, next, last_clobber;\n+  rtx_insn *insn, *next, *last_clobber;\n   bool last_cmp_valid;\n   bool need_purge = false;\n   bitmap killed;\n@@ -295,7 +295,7 @@ find_comparison_dom_walker::before_dom_children (basic_block bb)\n     {\n       rtx src;\n \n-      next = (insn == BB_END (bb) ? NULL_RTX : NEXT_INSN (insn));\n+      next = (insn == BB_END (bb) ? NULL : NEXT_INSN (insn));\n       if (!NONDEBUG_INSN_P (insn))\n \tcontinue;\n \n@@ -515,7 +515,8 @@ maybe_select_cc_mode (struct comparison *cmp, rtx a ATTRIBUTE_UNUSED,\n static bool\n try_eliminate_compare (struct comparison *cmp)\n {\n-  rtx x, insn, bb_head, flags, in_a, cmp_src;\n+  rtx_insn *insn, *bb_head;\n+  rtx x, flags, in_a, cmp_src;\n \n   /* We must have found an interesting \"clobber\" preceding the compare.  */\n   if (cmp->prev_clobber == NULL)"}]}