{"sha": "e091a0fe0779f788ee11e81f0d3d6f5d7bd0e9f4", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTA5MWEwZmUwNzc5Zjc4OGVlMTFlODFmMGQzZDZmNWQ3YmQwZTlmNA==", "commit": {"author": {"name": "Segher Boessenkool", "email": "segher@kernel.crashing.org", "date": "2017-03-20T23:08:16Z"}, "committer": {"name": "Segher Boessenkool", "email": "segher@gcc.gnu.org", "date": "2017-03-20T23:08:16Z"}, "message": "combine: Fix 79910\n\nIf the dest of an I0 or I1 is used in an insn before I2, as can happen\nin various uncommon cases, and we manage to do the combination, the set\nis moved to I2, which is wrong.  Don't allow combining the insns in this\ncase.\n\n\n\tPR rtl-optimization/79910\n\t* combine.c (can_combine_p): Do not allow combining an I0 or I1\n\tif its dest is used by an insn before I2 (other than the combined\n\tinsns themselves, which are properly handled already).\n\nFrom-SVN: r246297", "tree": {"sha": "210f18d4a1f6bc25ab025dbe7945ff510192ccfd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/210f18d4a1f6bc25ab025dbe7945ff510192ccfd"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e091a0fe0779f788ee11e81f0d3d6f5d7bd0e9f4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e091a0fe0779f788ee11e81f0d3d6f5d7bd0e9f4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e091a0fe0779f788ee11e81f0d3d6f5d7bd0e9f4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e091a0fe0779f788ee11e81f0d3d6f5d7bd0e9f4/comments", "author": {"login": "segher", "id": 417629, "node_id": "MDQ6VXNlcjQxNzYyOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/417629?v=4", "gravatar_id": "", "url": "https://api.github.com/users/segher", "html_url": "https://github.com/segher", "followers_url": "https://api.github.com/users/segher/followers", "following_url": "https://api.github.com/users/segher/following{/other_user}", "gists_url": "https://api.github.com/users/segher/gists{/gist_id}", "starred_url": "https://api.github.com/users/segher/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/segher/subscriptions", "organizations_url": "https://api.github.com/users/segher/orgs", "repos_url": "https://api.github.com/users/segher/repos", "events_url": "https://api.github.com/users/segher/events{/privacy}", "received_events_url": "https://api.github.com/users/segher/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "366e9446961bf5d8efcb0bc5442e2d112dc17160", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/366e9446961bf5d8efcb0bc5442e2d112dc17160", "html_url": "https://github.com/Rust-GCC/gccrs/commit/366e9446961bf5d8efcb0bc5442e2d112dc17160"}], "stats": {"total": 11, "additions": 11, "deletions": 0}, "files": [{"sha": "afb4a52347224814f2326a12797548518ac7638b", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e091a0fe0779f788ee11e81f0d3d6f5d7bd0e9f4/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e091a0fe0779f788ee11e81f0d3d6f5d7bd0e9f4/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=e091a0fe0779f788ee11e81f0d3d6f5d7bd0e9f4", "patch": "@@ -1,3 +1,10 @@\n+2017-03-20  Segher Boessenkool  <segher@kernel.crashing.org>\n+\n+\tPR rtl-optimization/79910\n+\t* combine.c (can_combine_p): Do not allow combining an I0 or I1\n+\tif its dest is used by an insn before I2 (other than the combined\n+\tinsns themselves, which are properly handled already).\n+\n 2017-03-20  Segher Boessenkool  <segher@kernel.crashing.org>\n \n \tRevert:"}, {"sha": "17258f0e0c5ac27916cd59617dffa31df42dd6b7", "filename": "gcc/combine.c", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e091a0fe0779f788ee11e81f0d3d6f5d7bd0e9f4/gcc%2Fcombine.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e091a0fe0779f788ee11e81f0d3d6f5d7bd0e9f4/gcc%2Fcombine.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcombine.c?ref=e091a0fe0779f788ee11e81f0d3d6f5d7bd0e9f4", "patch": "@@ -1953,6 +1953,10 @@ can_combine_p (rtx_insn *insn, rtx_insn *i3, rtx_insn *pred ATTRIBUTE_UNUSED,\n       || (succ2 && FIND_REG_INC_NOTE (succ2, dest))\n       /* Don't substitute into a non-local goto, this confuses CFG.  */\n       || (JUMP_P (i3) && find_reg_note (i3, REG_NON_LOCAL_GOTO, NULL_RTX))\n+      /* Make sure that DEST is not used after INSN but before SUCC, or\n+\t between SUCC and SUCC2.  */\n+      || (succ && reg_used_between_p (dest, insn, succ))\n+      || (succ2 && reg_used_between_p (dest, succ, succ2))\n       /* Make sure that DEST is not used after SUCC but before I3.  */\n       || (!all_adjacent\n \t  && ((succ2"}]}