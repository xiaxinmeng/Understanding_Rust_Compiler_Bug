{"sha": "a5740f2b7285f950e68d7790c37e28a5b768b4e8", "node_id": "C_kwDOANBUbNoAKGE1NzQwZjJiNzI4NWY5NTBlNjhkNzc5MGMzN2UyOGE1Yjc2OGI0ZTg", "commit": {"author": {"name": "Yannick Moy", "email": "moy@adacore.com", "date": "2021-09-03T07:19:49Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "derodat@adacore.com", "date": "2021-10-04T08:45:10Z"}, "message": "[Ada] Mark Ada.Text_IO in SPARK\n\ngcc/ada/\n\n\t* libgnat/a-textio.adb: Mark body out of SPARK.\n\t* libgnat/a-textio.ads: Mark spec in SPARK and private part out\n\tof SPARK.\n\t* sem.adb (Semantics.Do_Analyze): Similar to ghost code\n\tattributes, save and restore value of\n\tIgnore_SPARK_Mode_Pragmas_In_Instance.", "tree": {"sha": "38a8dee53c0fd9be033acf6155bf44d54b9e58bd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/38a8dee53c0fd9be033acf6155bf44d54b9e58bd"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a5740f2b7285f950e68d7790c37e28a5b768b4e8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a5740f2b7285f950e68d7790c37e28a5b768b4e8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a5740f2b7285f950e68d7790c37e28a5b768b4e8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a5740f2b7285f950e68d7790c37e28a5b768b4e8/comments", "author": {"login": "yannickmoy", "id": 859440, "node_id": "MDQ6VXNlcjg1OTQ0MA==", "avatar_url": "https://avatars.githubusercontent.com/u/859440?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yannickmoy", "html_url": "https://github.com/yannickmoy", "followers_url": "https://api.github.com/users/yannickmoy/followers", "following_url": "https://api.github.com/users/yannickmoy/following{/other_user}", "gists_url": "https://api.github.com/users/yannickmoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/yannickmoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yannickmoy/subscriptions", "organizations_url": "https://api.github.com/users/yannickmoy/orgs", "repos_url": "https://api.github.com/users/yannickmoy/repos", "events_url": "https://api.github.com/users/yannickmoy/events{/privacy}", "received_events_url": "https://api.github.com/users/yannickmoy/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pmderodat", "id": 758452, "node_id": "MDQ6VXNlcjc1ODQ1Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/758452?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pmderodat", "html_url": "https://github.com/pmderodat", "followers_url": "https://api.github.com/users/pmderodat/followers", "following_url": "https://api.github.com/users/pmderodat/following{/other_user}", "gists_url": "https://api.github.com/users/pmderodat/gists{/gist_id}", "starred_url": "https://api.github.com/users/pmderodat/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pmderodat/subscriptions", "organizations_url": "https://api.github.com/users/pmderodat/orgs", "repos_url": "https://api.github.com/users/pmderodat/repos", "events_url": "https://api.github.com/users/pmderodat/events{/privacy}", "received_events_url": "https://api.github.com/users/pmderodat/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "39d7ff0fd7487bfb188f9e4c186076a106f995f8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/39d7ff0fd7487bfb188f9e4c186076a106f995f8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/39d7ff0fd7487bfb188f9e4c186076a106f995f8"}], "stats": {"total": 16, "additions": 12, "deletions": 4}, "files": [{"sha": "8667360e2735e8743890888fda9f7bc393f3e95f", "filename": "gcc/ada/libgnat/a-textio.adb", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a5740f2b7285f950e68d7790c37e28a5b768b4e8/gcc%2Fada%2Flibgnat%2Fa-textio.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a5740f2b7285f950e68d7790c37e28a5b768b4e8/gcc%2Fada%2Flibgnat%2Fa-textio.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flibgnat%2Fa-textio.adb?ref=a5740f2b7285f950e68d7790c37e28a5b768b4e8", "patch": "@@ -44,6 +44,7 @@ pragma Elaborate_All (System.File_IO);\n --  Needed because of calls to Chain_File in package body elaboration\n \n package body Ada.Text_IO with\n+  SPARK_Mode => Off,\n   Refined_State => (File_System => (Standard_In,\n                                     Standard_Out,\n                                     Standard_Err,"}, {"sha": "f94c92dff2cd242a2466b6570c5505dcb4a92999", "filename": "gcc/ada/libgnat/a-textio.ads", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a5740f2b7285f950e68d7790c37e28a5b768b4e8/gcc%2Fada%2Flibgnat%2Fa-textio.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a5740f2b7285f950e68d7790c37e28a5b768b4e8/gcc%2Fada%2Flibgnat%2Fa-textio.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flibgnat%2Fa-textio.ads?ref=a5740f2b7285f950e68d7790c37e28a5b768b4e8", "patch": "@@ -56,8 +56,9 @@ with System.File_Control_Block;\n with System.WCh_Con;\n \n package Ada.Text_IO with\n-  Abstract_State    => (File_System),\n-  Initializes       => (File_System),\n+  SPARK_Mode,\n+  Abstract_State    => File_System,\n+  Initializes       => File_System,\n   Initial_Condition => Line_Length = 0 and Page_Length = 0\n is\n    pragma Elaborate_Body;\n@@ -547,6 +548,7 @@ is\n    Layout_Error : exception renames IO_Exceptions.Layout_Error;\n \n private\n+   pragma SPARK_Mode (Off);\n \n    --  The following procedures have a File_Type formal of mode IN OUT because\n    --  they may close the original file. The Close operation may raise an"}, {"sha": "3eee2ee31b73e61ff248f92dec63ce2c0a079d5e", "filename": "gcc/ada/sem.adb", "status": "modified", "additions": 7, "deletions": 2, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a5740f2b7285f950e68d7790c37e28a5b768b4e8/gcc%2Fada%2Fsem.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a5740f2b7285f950e68d7790c37e28a5b768b4e8/gcc%2Fada%2Fsem.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem.adb?ref=a5740f2b7285f950e68d7790c37e28a5b768b4e8", "patch": "@@ -1402,7 +1402,9 @@ package body Sem is\n       procedure Do_Analyze is\n          Saved_GM  : constant Ghost_Mode_Type := Ghost_Mode;\n          Saved_IGR : constant Node_Id         := Ignored_Ghost_Region;\n-         --  Save the Ghost-related attributes to restore on exit\n+         Saved_ISMP : constant Boolean        :=\n+                        Ignore_SPARK_Mode_Pragmas_In_Instance;\n+         --  Save Ghost and SPARK mode-related data to restore on exit\n \n          --  Generally style checks are preserved across compilations, with\n          --  one exception: s-oscons.ads, which allows arbitrary long lines\n@@ -1421,6 +1423,7 @@ package body Sem is\n          --  Set up a clean environment before analyzing\n \n          Install_Ghost_Region (None, Empty);\n+         Ignore_SPARK_Mode_Pragmas_In_Instance := False;\n \n          Outer_Generic_Scope := Empty;\n          Scope_Suppress      := Suppress_Options;\n@@ -1443,9 +1446,11 @@ package body Sem is\n \n          Pop_Scope;\n          Restore_Scope_Stack  (List);\n-         Restore_Ghost_Region (Saved_GM, Saved_IGR);\n          Style_Max_Line_Length := Saved_ML;\n          Style_Check_Max_Line_Length := Saved_CML;\n+\n+         Restore_Ghost_Region (Saved_GM, Saved_IGR);\n+         Ignore_SPARK_Mode_Pragmas_In_Instance := Saved_ISMP;\n       end Do_Analyze;\n \n       --  Local variables"}]}