{"sha": "0631e008adc759cc801d0d034224ee6b4bcf31aa", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDYzMWUwMDhhZGM3NTljYzgwMWQwZDAzNDIyNGVlNmI0YmNmMzFhYQ==", "commit": {"author": {"name": "Steve Kargl", "email": "sgk@troutmask.apl.washington.edu", "date": "2021-02-12T15:58:16Z"}, "committer": {"name": "Jerry DeLisle", "email": "jvdelisle@gcc.gnu.org", "date": "2021-02-12T15:58:16Z"}, "message": "libgfortran: Fix PR95647 by changing the interfaces of operators .eq. and .ne.\n\nThe FE converts the old school .eq. to ==,\nand then tracks the ==.  The module starts with == and so it does not\nproperly overload the .eq.  Reversing the interfaces fixes this.\n\n2021-02-12  Steve Kargl <sgk@troutmask.apl.washington.edu>\n\nlibgfortran/ChangeLog:\n\n\tPR libfortran/95647\n\t* ieee/ieee_arithmetic.F90: Flip interfaces of operators .eq. to\n\t== and .ne. to /= .\n\ngcc/testsuite/ChangeLog:\n\n\tPR libfortran/95647\n\t* gfortran.dg/ieee/ieee_12.f90: New test.", "tree": {"sha": "c96b1b4067b287dd13c516319c7f38e1b55e5508", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c96b1b4067b287dd13c516319c7f38e1b55e5508"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0631e008adc759cc801d0d034224ee6b4bcf31aa", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0631e008adc759cc801d0d034224ee6b4bcf31aa", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0631e008adc759cc801d0d034224ee6b4bcf31aa", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0631e008adc759cc801d0d034224ee6b4bcf31aa/comments", "author": {"login": "kargl", "id": 28907258, "node_id": "MDQ6VXNlcjI4OTA3MjU4", "avatar_url": "https://avatars.githubusercontent.com/u/28907258?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kargl", "html_url": "https://github.com/kargl", "followers_url": "https://api.github.com/users/kargl/followers", "following_url": "https://api.github.com/users/kargl/following{/other_user}", "gists_url": "https://api.github.com/users/kargl/gists{/gist_id}", "starred_url": "https://api.github.com/users/kargl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kargl/subscriptions", "organizations_url": "https://api.github.com/users/kargl/orgs", "repos_url": "https://api.github.com/users/kargl/repos", "events_url": "https://api.github.com/users/kargl/events{/privacy}", "received_events_url": "https://api.github.com/users/kargl/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "adfee3c4c03dd70a06f6283178d7943b09652206", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/adfee3c4c03dd70a06f6283178d7943b09652206", "html_url": "https://github.com/Rust-GCC/gccrs/commit/adfee3c4c03dd70a06f6283178d7943b09652206"}], "stats": {"total": 33, "additions": 29, "deletions": 4}, "files": [{"sha": "139a70142b8223c9aba33d6cda24a1d490c240b0", "filename": "gcc/testsuite/gfortran.dg/ieee/ieee_12.f90", "status": "added", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0631e008adc759cc801d0d034224ee6b4bcf31aa/gcc%2Ftestsuite%2Fgfortran.dg%2Fieee%2Fieee_12.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0631e008adc759cc801d0d034224ee6b4bcf31aa/gcc%2Ftestsuite%2Fgfortran.dg%2Fieee%2Fieee_12.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fieee%2Fieee_12.f90?ref=0631e008adc759cc801d0d034224ee6b4bcf31aa", "patch": "@@ -0,0 +1,24 @@\n+! { dg-do run }\n+! PR95647 operator(.eq.) and operator(==) treated differently\n+program test\n+  use, intrinsic :: ieee_arithmetic, only :                 &\n+&                ieee_class,                                       &\n+&                ieee_class_type,                                  &\n+&                ieee_negative_normal,                             &\n+&                ieee_positive_normal,                             &\n+&                operator(.eq.), operator(.ne.)\n+  integer :: good\n+  real(4) r4\n+  type(ieee_class_type) class1\n+  good = 0\n+  r4 = 1.0\n+  class1 = ieee_class(r4)\n+  if (class1 .eq. ieee_positive_normal) good = good + 1\n+  if (class1 .ne. ieee_negative_normal) good = good + 1\n+  r4 = -1.0\n+  class1 = ieee_class(r4)\n+  if (class1 .eq. ieee_negative_normal) good = good + 1\n+  if (class1 .ne. ieee_positive_normal) good = good + 1\n+  if (good /= 4) call abort\n+end program test\n+"}, {"sha": "35a16938f8e9c1550b6296a208228e6c550fe407", "filename": "libgfortran/ieee/ieee_arithmetic.F90", "status": "modified", "additions": 5, "deletions": 4, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0631e008adc759cc801d0d034224ee6b4bcf31aa/libgfortran%2Fieee%2Fieee_arithmetic.F90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0631e008adc759cc801d0d034224ee6b4bcf31aa/libgfortran%2Fieee%2Fieee_arithmetic.F90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fieee%2Fieee_arithmetic.F90?ref=0631e008adc759cc801d0d034224ee6b4bcf31aa", "patch": "@@ -77,15 +77,16 @@ module IEEE_ARITHMETIC\n \n \n   ! Equality operators on the derived types\n-  interface operator (==)\n+  ! Note, the FE overloads .eq. to == and .ne. to /=\n+  interface operator (.eq.)\n     module procedure IEEE_CLASS_TYPE_EQ, IEEE_ROUND_TYPE_EQ\n   end interface\n-  public :: operator(==)\n+  public :: operator(.eq.)\n \n-  interface operator (/=)\n+  interface operator (.ne.)\n     module procedure IEEE_CLASS_TYPE_NE, IEEE_ROUND_TYPE_NE\n   end interface\n-  public :: operator (/=)\n+  public :: operator (.ne.)\n \n \n   ! IEEE_IS_FINITE"}]}