{"sha": "d26cc5885a491dedad0bdf3468a7b91c1f75a868", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDI2Y2M1ODg1YTQ5MWRlZGFkMGJkZjM0NjhhN2I5MWMxZjc1YTg2OA==", "commit": {"author": {"name": "Alan Modra", "email": "amodra@gmail.com", "date": "2020-10-01T09:11:37Z"}, "committer": {"name": "Alan Modra", "email": "amodra@gmail.com", "date": "2020-10-01T22:43:44Z"}, "message": "[RS6000] rs6000_linux64_override_options fix\n\nCommit c6be439b37 wrongly left a block of code inside an \"else\" block,\nwhich changed the default for power10 TARGET_NO_FP_IN_TOC\naccidentally.  We don't want FP constants in the TOC when\n-mcmodel=medium can address them just as efficiently outside the TOC.\n\n\t* config/rs6000/rs6000.c (rs6000_linux64_override_options):\n\tFormatting.  Correct setting of TARGET_NO_FP_IN_TOC and\n\tTARGET_NO_SUM_IN_TOC.", "tree": {"sha": "c79aec85630db8c07eff170cd58493b444d0e11c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c79aec85630db8c07eff170cd58493b444d0e11c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d26cc5885a491dedad0bdf3468a7b91c1f75a868", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d26cc5885a491dedad0bdf3468a7b91c1f75a868", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d26cc5885a491dedad0bdf3468a7b91c1f75a868", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d26cc5885a491dedad0bdf3468a7b91c1f75a868/comments", "author": {"login": "amodra", "id": 6006325, "node_id": "MDQ6VXNlcjYwMDYzMjU=", "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4", "gravatar_id": "", "url": "https://api.github.com/users/amodra", "html_url": "https://github.com/amodra", "followers_url": "https://api.github.com/users/amodra/followers", "following_url": "https://api.github.com/users/amodra/following{/other_user}", "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}", "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/amodra/subscriptions", "organizations_url": "https://api.github.com/users/amodra/orgs", "repos_url": "https://api.github.com/users/amodra/repos", "events_url": "https://api.github.com/users/amodra/events{/privacy}", "received_events_url": "https://api.github.com/users/amodra/received_events", "type": "User", "site_admin": false}, "committer": {"login": "amodra", "id": 6006325, "node_id": "MDQ6VXNlcjYwMDYzMjU=", "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4", "gravatar_id": "", "url": "https://api.github.com/users/amodra", "html_url": "https://github.com/amodra", "followers_url": "https://api.github.com/users/amodra/followers", "following_url": "https://api.github.com/users/amodra/following{/other_user}", "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}", "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/amodra/subscriptions", "organizations_url": "https://api.github.com/users/amodra/orgs", "repos_url": "https://api.github.com/users/amodra/repos", "events_url": "https://api.github.com/users/amodra/events{/privacy}", "received_events_url": "https://api.github.com/users/amodra/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4830b30c823abaea8ea46dcece65c4681877b38d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4830b30c823abaea8ea46dcece65c4681877b38d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4830b30c823abaea8ea46dcece65c4681877b38d"}], "stats": {"total": 20, "additions": 7, "deletions": 13}, "files": [{"sha": "1b5b8e213bfc35391350f437962e9b6cbd0d7c0a", "filename": "gcc/config/rs6000/rs6000.c", "status": "modified", "additions": 7, "deletions": 13, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d26cc5885a491dedad0bdf3468a7b91c1f75a868/gcc%2Fconfig%2Frs6000%2Frs6000.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d26cc5885a491dedad0bdf3468a7b91c1f75a868/gcc%2Fconfig%2Frs6000%2Frs6000.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.c?ref=d26cc5885a491dedad0bdf3468a7b91c1f75a868", "patch": "@@ -3494,8 +3494,7 @@ rs6000_linux64_override_options ()\n \t}\n       if (!global_options_set.x_rs6000_current_cmodel)\n \tSET_CMODEL (CMODEL_MEDIUM);\n-      if ((rs6000_isa_flags_explicit\n-\t   & OPTION_MASK_MINIMAL_TOC) != 0)\n+      if ((rs6000_isa_flags_explicit & OPTION_MASK_MINIMAL_TOC) != 0)\n \t{\n \t  if (global_options_set.x_rs6000_current_cmodel\n \t      && rs6000_current_cmodel != CMODEL_SMALL)\n@@ -3504,23 +3503,18 @@ rs6000_linux64_override_options ()\n \t    SET_CMODEL (CMODEL_SMALL);\n \t  else if (TARGET_PCREL\n \t\t   || (PCREL_SUPPORTED_BY_OS\n-\t\t       && (rs6000_isa_flags_explicit\n-\t\t\t   & OPTION_MASK_PCREL) == 0))\n+\t\t       && (rs6000_isa_flags_explicit & OPTION_MASK_PCREL) == 0))\n \t    /* Ignore -mno-minimal-toc.  */\n \t    ;\n \t  else\n \t    SET_CMODEL (CMODEL_SMALL);\n \t}\n-      else\n+      if (rs6000_current_cmodel != CMODEL_SMALL)\n \t{\n-\t  if (rs6000_current_cmodel != CMODEL_SMALL)\n-\t    {\n-\t      if (!global_options_set.x_TARGET_NO_FP_IN_TOC)\n-\t\tTARGET_NO_FP_IN_TOC\n-\t\t  = rs6000_current_cmodel == CMODEL_MEDIUM;\n-\t      if (!global_options_set.x_TARGET_NO_SUM_IN_TOC)\n-\t\tTARGET_NO_SUM_IN_TOC = 0;\n-\t    }\n+\t  if (!global_options_set.x_TARGET_NO_FP_IN_TOC)\n+\t    TARGET_NO_FP_IN_TOC = rs6000_current_cmodel == CMODEL_MEDIUM;\n+\t  if (!global_options_set.x_TARGET_NO_SUM_IN_TOC)\n+\t    TARGET_NO_SUM_IN_TOC = 0;\n \t}\n       if (TARGET_PLTSEQ && DEFAULT_ABI != ABI_ELFv2)\n \t{"}]}