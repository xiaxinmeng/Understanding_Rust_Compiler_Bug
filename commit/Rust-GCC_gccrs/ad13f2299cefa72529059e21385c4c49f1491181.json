{"sha": "ad13f2299cefa72529059e21385c4c49f1491181", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWQxM2YyMjk5Y2VmYTcyNTI5MDU5ZTIxMzg1YzRjNDlmMTQ5MTE4MQ==", "commit": {"author": {"name": "Dodji Seketeli", "email": "dodji@redhat.com", "date": "2010-05-17T17:24:32Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2010-05-17T17:24:32Z"}, "message": "re PR c++/44108 (-Wunused-but-set-variable does not consider array sizing use of a const variable)\n\n\tPR c++/44108\n\t* decl.c (compute_array_index_type): Call mark_rvalue_use.\n\n\t* c-c++-common/Wunused-var-8.c: New test.\n\nCo-Authored-By: Jason Merrill <jason@redhat.com>\n\nFrom-SVN: r159497", "tree": {"sha": "786dcd92a7ad0fc0015905fd8c1894a4eca21613", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/786dcd92a7ad0fc0015905fd8c1894a4eca21613"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ad13f2299cefa72529059e21385c4c49f1491181", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ad13f2299cefa72529059e21385c4c49f1491181", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ad13f2299cefa72529059e21385c4c49f1491181", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ad13f2299cefa72529059e21385c4c49f1491181/comments", "author": null, "committer": null, "parents": [{"sha": "f145213fcc63518e181ae5b74a38f75555f6a741", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f145213fcc63518e181ae5b74a38f75555f6a741", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f145213fcc63518e181ae5b74a38f75555f6a741"}], "stats": {"total": 33, "additions": 33, "deletions": 0}, "files": [{"sha": "acc111f7569690a09b7106430443cfd44d721395", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ad13f2299cefa72529059e21385c4c49f1491181/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ad13f2299cefa72529059e21385c4c49f1491181/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=ad13f2299cefa72529059e21385c4c49f1491181", "patch": "@@ -1,3 +1,9 @@\n+2010-05-17  Dodji Seketeli  <dodji@redhat.com>\n+\t    Jason Merrill  <jason@redhat.com>\n+\n+\tPR c++/44108\n+\t* decl.c (compute_array_index_type): Call mark_rvalue_use.\n+\n 2010-05-15  Jason Merrill  <jason@redhat.com>\n \n \t* cp-tree.h (TYPE_NOEXCEPT_P): New macro."}, {"sha": "0636aba01e266d3cf390c1914a21260f26618848", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ad13f2299cefa72529059e21385c4c49f1491181/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ad13f2299cefa72529059e21385c4c49f1491181/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=ad13f2299cefa72529059e21385c4c49f1491181", "patch": "@@ -7369,6 +7369,8 @@ compute_array_index_type (tree name, tree size)\n   /* The size might be the result of a cast.  */\n   STRIP_TYPE_NOPS (size);\n \n+  size = mark_rvalue_use (size);\n+\n   /* It might be a const variable or enumeration constant.  */\n   size = integral_constant_value (size);\n   if (error_operand_p (size))"}, {"sha": "2d31000e6bf0daac0ff6d496722e6a5156aea71f", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ad13f2299cefa72529059e21385c4c49f1491181/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ad13f2299cefa72529059e21385c4c49f1491181/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=ad13f2299cefa72529059e21385c4c49f1491181", "patch": "@@ -1,3 +1,9 @@\n+2010-05-17  Dodji Seketeli  <dodji@redhat.com>\n+\t    Jason Merrill  <jason@redhat.com>\n+\n+\tPR c++/44108\n+\t* c-c++-common/Wunused-var-8.c: New test.\n+\n 2010-05-17  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR bootstrap/42347"}, {"sha": "0923b3556625584ecf79edecaf76bccefc7944fc", "filename": "gcc/testsuite/c-c++-common/Wunused-var-8.c", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ad13f2299cefa72529059e21385c4c49f1491181/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2FWunused-var-8.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ad13f2299cefa72529059e21385c4c49f1491181/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2FWunused-var-8.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2FWunused-var-8.c?ref=ad13f2299cefa72529059e21385c4c49f1491181", "patch": "@@ -0,0 +1,19 @@\n+/* Origin: PR c++/44108 */\n+/* { dg-options \"-Wunused\" } */\n+/* { dg-do compile } */\n+\n+int\n+foo ()\n+{\n+  unsigned int M = 2;\n+  const unsigned int M_CONST = 2;\n+  static unsigned int M_STATIC = 2;\n+  static const unsigned int M_STATIC_CONST = 2;\n+\n+  char n1[M];\n+  char n2[M_CONST];\n+  char n3[M_STATIC];\n+  char n4[M_STATIC_CONST];\n+\n+  return sizeof (n1) + sizeof (n2) + sizeof (n3) + sizeof (n4);\n+}"}]}