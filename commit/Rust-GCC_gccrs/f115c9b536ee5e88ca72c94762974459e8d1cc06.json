{"sha": "f115c9b536ee5e88ca72c94762974459e8d1cc06", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjExNWM5YjUzNmVlNWU4OGNhNzJjOTQ3NjI5NzQ0NTllOGQxY2MwNg==", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2018-06-05T13:42:57Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2018-06-05T13:42:57Z"}, "message": "lto.c (cmp_type_location): Expand locations only once.\n\n2018-06-05  Richard Biener  <rguenther@suse.de>\n\n\t* lto.c (cmp_type_location): Expand locations only once.\n\nFrom-SVN: r261201", "tree": {"sha": "6edad1d702f54c1dcc2d0d132fca1b0a9ac8b6f1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6edad1d702f54c1dcc2d0d132fca1b0a9ac8b6f1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f115c9b536ee5e88ca72c94762974459e8d1cc06", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f115c9b536ee5e88ca72c94762974459e8d1cc06", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f115c9b536ee5e88ca72c94762974459e8d1cc06", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f115c9b536ee5e88ca72c94762974459e8d1cc06/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "05f9a806ee423a6dc7995c1c1bfe18c97c80c5c4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/05f9a806ee423a6dc7995c1c1bfe18c97c80c5c4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/05f9a806ee423a6dc7995c1c1bfe18c97c80c5c4"}], "stats": {"total": 26, "additions": 13, "deletions": 13}, "files": [{"sha": "f77634aae6a94acf63e52b2f379d65103b64a689", "filename": "gcc/lto/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f115c9b536ee5e88ca72c94762974459e8d1cc06/gcc%2Flto%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f115c9b536ee5e88ca72c94762974459e8d1cc06/gcc%2Flto%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flto%2FChangeLog?ref=f115c9b536ee5e88ca72c94762974459e8d1cc06", "patch": "@@ -1,3 +1,7 @@\n+2018-06-05  Richard Biener  <rguenther@suse.de>\n+\n+\t* lto.c (cmp_type_location): Expand locations only once.\n+\n 2018-05-30  Jan Hubicka  <hubicka@ucw.cz>\n \n \t* lang.opt (lto_linker_output): Add nolto-rel."}, {"sha": "17634797c6edd7efee7699a29f50fd2043b27112", "filename": "gcc/lto/lto.c", "status": "modified", "additions": 9, "deletions": 13, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f115c9b536ee5e88ca72c94762974459e8d1cc06/gcc%2Flto%2Flto.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f115c9b536ee5e88ca72c94762974459e8d1cc06/gcc%2Flto%2Flto.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flto%2Flto.c?ref=f115c9b536ee5e88ca72c94762974459e8d1cc06", "patch": "@@ -1707,23 +1707,19 @@ cmp_type_location (const void *p1_, const void *p2_)\n \n   tree tname1 = TYPE_NAME (*p1);\n   tree tname2 = TYPE_NAME (*p2);\n+  expanded_location xloc1 = expand_location (DECL_SOURCE_LOCATION (tname1));\n+  expanded_location xloc2 = expand_location (DECL_SOURCE_LOCATION (tname2));\n \n-  const char *f1 = DECL_SOURCE_FILE (tname1);\n-  const char *f2 = DECL_SOURCE_FILE (tname2);\n-\n+  const char *f1 = lbasename (xloc1.file);\n+  const char *f2 = lbasename (xloc2.file);\n   int r = strcmp (f1, f2);\n   if (r == 0)\n     {\n-      int l1 = DECL_SOURCE_LINE (tname1);\n-      int l2 = DECL_SOURCE_LINE (tname2);\n-      if (l1 == l2)\n-       {\n-\t int l1 = DECL_SOURCE_COLUMN (tname1);\n-\t int l2 = DECL_SOURCE_COLUMN (tname2);\n-\t return l1 - l2;\n-       }\n-      else\n-       return l1 - l2;\n+      int l1 = xloc1.line;\n+      int l2 = xloc2.line;\n+      if (l1 != l2)\n+\treturn l1 - l2;\n+      return xloc1.column - xloc2.column;\n     }\n   else\n     return r;"}]}