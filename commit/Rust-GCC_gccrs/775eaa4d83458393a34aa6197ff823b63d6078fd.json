{"sha": "775eaa4d83458393a34aa6197ff823b63d6078fd", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Nzc1ZWFhNGQ4MzQ1ODM5M2EzNGFhNjE5N2ZmODIzYjYzZDYwNzhmZA==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2019-10-02T22:33:39Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2019-10-02T22:33:39Z"}, "message": "re PR rtl-optimization/91976 (RTL check: expected code 'const_int', have 'reg' in emit_block_move_hints, at expr.c:1627)\n\n\tPR rtl-optimization/91976\n\t* expr.c (emit_block_move_hints): Don't call can_move_by_pieces if\n\tsize is not CONST_INT_P, set pieces_ok to false in that case.  Simplify\n\tCONST_INT_P (size) && pieces_ok to pieces_ok.  Formatting fix.\n\nFrom-SVN: r276495", "tree": {"sha": "1238acad4fded9e02848fdc004a8f02d187e6845", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1238acad4fded9e02848fdc004a8f02d187e6845"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/775eaa4d83458393a34aa6197ff823b63d6078fd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/775eaa4d83458393a34aa6197ff823b63d6078fd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/775eaa4d83458393a34aa6197ff823b63d6078fd", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/775eaa4d83458393a34aa6197ff823b63d6078fd/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "1006c9d4395a939820df76f37c7b085a4a1a003f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1006c9d4395a939820df76f37c7b085a4a1a003f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1006c9d4395a939820df76f37c7b085a4a1a003f"}], "stats": {"total": 25, "additions": 17, "deletions": 8}, "files": [{"sha": "6aff2cd4371fff4ffa961b3bd09495f2602764e9", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/775eaa4d83458393a34aa6197ff823b63d6078fd/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/775eaa4d83458393a34aa6197ff823b63d6078fd/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=775eaa4d83458393a34aa6197ff823b63d6078fd", "patch": "@@ -1,3 +1,10 @@\n+2019-10-03  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR rtl-optimization/91976\n+\t* expr.c (emit_block_move_hints): Don't call can_move_by_pieces if\n+\tsize is not CONST_INT_P, set pieces_ok to false in that case.  Simplify\n+\tCONST_INT_P (size) && pieces_ok to pieces_ok.  Formatting fix.\n+\n 2019-10-02  Martin Sebor  <msebor@redhat.com>\n \n \tPR tree-optimization/80936"}, {"sha": "c4210547aee66cd40523c08100c2ee491399ca1b", "filename": "gcc/expr.c", "status": "modified", "additions": 10, "deletions": 8, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/775eaa4d83458393a34aa6197ff823b63d6078fd/gcc%2Fexpr.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/775eaa4d83458393a34aa6197ff823b63d6078fd/gcc%2Fexpr.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fexpr.c?ref=775eaa4d83458393a34aa6197ff823b63d6078fd", "patch": "@@ -1624,16 +1624,18 @@ emit_block_move_hints (rtx x, rtx y, rtx size, enum block_op_methods method,\n       set_mem_size (y, const_size);\n     }\n \n-  bool pieces_ok = can_move_by_pieces (INTVAL (size), align);\n+  bool pieces_ok = false;\n+  if (CONST_INT_P (size))\n+    pieces_ok = can_move_by_pieces (INTVAL (size), align);\n   bool pattern_ok = false;\n \n-  if (!CONST_INT_P (size) || !pieces_ok || might_overlap)\n+  if (!pieces_ok || might_overlap)\n     {\n-      pattern_ok = \n-\temit_block_move_via_pattern (x, y, size, align,\n-\t\t\t\t     expected_align, expected_size,\n-\t\t\t\t     min_size, max_size, probable_max_size,\n-\t\t\t\t     might_overlap);\n+      pattern_ok\n+\t= emit_block_move_via_pattern (x, y, size, align,\n+\t\t\t\t       expected_align, expected_size,\n+\t\t\t\t       min_size, max_size, probable_max_size,\n+\t\t\t\t       might_overlap);\n       if (!pattern_ok && might_overlap)\n \t{\n \t  /* Do not try any of the other methods below as they are not safe\n@@ -1645,7 +1647,7 @@ emit_block_move_hints (rtx x, rtx y, rtx size, enum block_op_methods method,\n \n   if (pattern_ok)\n     ;\n-  else if (CONST_INT_P (size) && pieces_ok)\n+  else if (pieces_ok)\n     move_by_pieces (x, y, INTVAL (size), align, RETURN_BEGIN);\n   else if (may_use_call && !might_overlap\n \t   && ADDR_SPACE_GENERIC_P (MEM_ADDR_SPACE (x))"}]}