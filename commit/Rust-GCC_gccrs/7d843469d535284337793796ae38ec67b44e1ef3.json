{"sha": "7d843469d535284337793796ae38ec67b44e1ef3", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2Q4NDM0NjlkNTM1Mjg0MzM3NzkzNzk2YWUzOGVjNjdiNDRlMWVmMw==", "commit": {"author": {"name": "Simon Wright", "email": "simon@pushface.org", "date": "2017-09-12T15:29:16Z"}, "committer": {"name": "Jeff Law", "email": "law@gcc.gnu.org", "date": "2017-09-12T15:29:16Z"}, "message": "re PR target/80204 (macosx-version-min wrong for macOS Sierra 10.12.3)\n\n\tPR target/80204\n\t* config/darwin-driver.c (darwin_find_version_from_kernel): Eliminate\n\tcalculation of the minor version, always output as 0.\n\nFrom-SVN: r252029", "tree": {"sha": "d55ae2fd6bdd7ff14fa88abd9b21df454c0a4d6e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d55ae2fd6bdd7ff14fa88abd9b21df454c0a4d6e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7d843469d535284337793796ae38ec67b44e1ef3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7d843469d535284337793796ae38ec67b44e1ef3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7d843469d535284337793796ae38ec67b44e1ef3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7d843469d535284337793796ae38ec67b44e1ef3/comments", "author": {"login": "simonjwright", "id": 1824512, "node_id": "MDQ6VXNlcjE4MjQ1MTI=", "avatar_url": "https://avatars.githubusercontent.com/u/1824512?v=4", "gravatar_id": "", "url": "https://api.github.com/users/simonjwright", "html_url": "https://github.com/simonjwright", "followers_url": "https://api.github.com/users/simonjwright/followers", "following_url": "https://api.github.com/users/simonjwright/following{/other_user}", "gists_url": "https://api.github.com/users/simonjwright/gists{/gist_id}", "starred_url": "https://api.github.com/users/simonjwright/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/simonjwright/subscriptions", "organizations_url": "https://api.github.com/users/simonjwright/orgs", "repos_url": "https://api.github.com/users/simonjwright/repos", "events_url": "https://api.github.com/users/simonjwright/events{/privacy}", "received_events_url": "https://api.github.com/users/simonjwright/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "cbc45bea5f58a19d0545d1101a0a0c1a9e7760d2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cbc45bea5f58a19d0545d1101a0a0c1a9e7760d2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cbc45bea5f58a19d0545d1101a0a0c1a9e7760d2"}], "stats": {"total": 22, "additions": 11, "deletions": 11}, "files": [{"sha": "306cf5708c29197868574995d1af03164a82b020", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7d843469d535284337793796ae38ec67b44e1ef3/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7d843469d535284337793796ae38ec67b44e1ef3/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=7d843469d535284337793796ae38ec67b44e1ef3", "patch": "@@ -1,3 +1,9 @@\n+2017-09-02 Simon Wright <simon@pushface.org>\n+\n+\tPR target/80204\n+\t* config/darwin-driver.c (darwin_find_version_from_kernel): Eliminate\n+\tcalculation of the minor version, always output as 0.\n+\n 2017-09-12  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR target/82112"}, {"sha": "0348b40322589aec2b56a01a7be520d2cf20dd36", "filename": "gcc/config/darwin-driver.c", "status": "modified", "additions": 5, "deletions": 11, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7d843469d535284337793796ae38ec67b44e1ef3/gcc%2Fconfig%2Fdarwin-driver.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7d843469d535284337793796ae38ec67b44e1ef3/gcc%2Fconfig%2Fdarwin-driver.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fdarwin-driver.c?ref=7d843469d535284337793796ae38ec67b44e1ef3", "patch": "@@ -37,9 +37,7 @@ darwin_find_version_from_kernel (void)\n   size_t osversion_len = sizeof (osversion) - 1;\n   static int osversion_name[2] = { CTL_KERN, KERN_OSRELEASE };\n   int major_vers;\n-  char minor_vers[6];\n   char * version_p;\n-  char * version_pend;\n   char * new_flag;\n \n   /* Determine the version of the running OS.  If we can't, warn user,\n@@ -61,13 +59,6 @@ darwin_find_version_from_kernel (void)\n     major_vers = major_vers * 10 + (*version_p++ - '0');\n   if (*version_p++ != '.')\n     goto parse_failed;\n-  version_pend = strchr(version_p, '.');\n-  if (!version_pend)\n-    goto parse_failed;\n-  if (! ISDIGIT (*version_p))\n-    goto parse_failed;\n-  strncpy(minor_vers, version_p, version_pend - version_p);\n-  minor_vers[version_pend - version_p] = '\\0';\n   \n   /* The major kernel version number is 4 plus the second OS version\n      component.  */\n@@ -77,7 +68,11 @@ darwin_find_version_from_kernel (void)\n        FIXME: we should not assume this - a newer linker could be used.  */\n     asprintf (&new_flag, \"10.%d\", major_vers - 4);\n   else\n-    asprintf (&new_flag, \"10.%d.%s\", major_vers - 4, minor_vers);\n+    /* Although the newer linker supports three-component system\n+       versions, there's no guarantee that the minor version component\n+       of the kernel and the system are the same. Apple's clang always\n+       uses 0 as the minor version: do the same.  */\n+    asprintf (&new_flag, \"10.%d.0\", major_vers - 4);\n \n   return new_flag;\n \n@@ -86,7 +81,6 @@ darwin_find_version_from_kernel (void)\n \t   (int) osversion_len, osversion);\n   return NULL;\n }\n-\n #endif\n \n /* When running on a Darwin system and using that system's headers and"}]}