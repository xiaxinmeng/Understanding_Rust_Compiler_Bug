{"sha": "8964432ad6f17cef74aa97c367d2975ba9458f92", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODk2NDQzMmFkNmYxN2NlZjc0YWE5N2MzNjdkMjk3NWJhOTQ1OGY5Mg==", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2019-05-02T14:08:08Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2019-05-02T14:08:08Z"}, "message": "re PR tree-optimization/89653 (Missing vectorization of loop containing std::min/std::max and temporary)\n\n2019-05-02  Richard Biener  <rguenther@suse.de>\n\n\tPR tree-optimization/89653\n\t* tree-ssa-loop.c (pass_data_tree_loop_init): Execute\n\tupdate-address-taken before the pass.\n\t* passes.def (pass_tree_loop_init): Put comment before it.\n\n\t* g++.dg/vect/pr89653.cc: New testcase.\n\nFrom-SVN: r270800", "tree": {"sha": "172994fc163031c61f48b2a00664c4de0866fd0c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/172994fc163031c61f48b2a00664c4de0866fd0c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8964432ad6f17cef74aa97c367d2975ba9458f92", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8964432ad6f17cef74aa97c367d2975ba9458f92", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8964432ad6f17cef74aa97c367d2975ba9458f92", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8964432ad6f17cef74aa97c367d2975ba9458f92/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "420ee75d7dbdba35878d7feabea7d30d77b82943", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/420ee75d7dbdba35878d7feabea7d30d77b82943", "html_url": "https://github.com/Rust-GCC/gccrs/commit/420ee75d7dbdba35878d7feabea7d30d77b82943"}], "stats": {"total": 28, "additions": 27, "deletions": 1}, "files": [{"sha": "9149eaad186f583dec670108ce2bf96079ccc5c5", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8964432ad6f17cef74aa97c367d2975ba9458f92/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8964432ad6f17cef74aa97c367d2975ba9458f92/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=8964432ad6f17cef74aa97c367d2975ba9458f92", "patch": "@@ -1,3 +1,10 @@\n+2019-05-02  Richard Biener  <rguenther@suse.de>\n+\n+\tPR tree-optimization/89653\n+\t* tree-ssa-loop.c (pass_data_tree_loop_init): Execute\n+\tupdate-address-taken before the pass.\n+\t* passes.def (pass_tree_loop_init): Put comment before it.\n+\n 2019-05-02  Richard Biener  <rguenther@suse.de>\n \n \tPR tree-optimization/89509"}, {"sha": "ad2efabd3853d8d20562f66f4c5bb34694ec80f2", "filename": "gcc/passes.def", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8964432ad6f17cef74aa97c367d2975ba9458f92/gcc%2Fpasses.def", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8964432ad6f17cef74aa97c367d2975ba9458f92/gcc%2Fpasses.def", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fpasses.def?ref=8964432ad6f17cef74aa97c367d2975ba9458f92", "patch": "@@ -255,6 +255,8 @@ along with GCC; see the file COPYING3.  If not see\n       NEXT_PASS (pass_fix_loops);\n       NEXT_PASS (pass_tree_loop);\n       PUSH_INSERT_PASSES_WITHIN (pass_tree_loop)\n+          /* Before loop_init we rewrite no longer addressed locals into SSA\n+\t     form if possible.  */\n \t  NEXT_PASS (pass_tree_loop_init);\n \t  NEXT_PASS (pass_tree_unswitch);\n \t  NEXT_PASS (pass_scev_cprop);"}, {"sha": "bf32f0e756a5dee12dc47dfa0792c9a01744a7d0", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8964432ad6f17cef74aa97c367d2975ba9458f92/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8964432ad6f17cef74aa97c367d2975ba9458f92/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=8964432ad6f17cef74aa97c367d2975ba9458f92", "patch": "@@ -1,3 +1,8 @@\n+2019-05-02  Richard Biener  <rguenther@suse.de>\n+\n+\tPR tree-optimization/89653\n+\t* g++.dg/vect/pr89653.cc: New testcase.\n+\n 2019-05-02  Richard Biener  <rguenther@suse.de>\n \n \tPR tree-optimization/89509"}, {"sha": "d38b49a549723ee2a36d3e6980b5214c64bf4c73", "filename": "gcc/testsuite/g++.dg/vect/pr89653.cc", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8964432ad6f17cef74aa97c367d2975ba9458f92/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fvect%2Fpr89653.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8964432ad6f17cef74aa97c367d2975ba9458f92/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fvect%2Fpr89653.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fvect%2Fpr89653.cc?ref=8964432ad6f17cef74aa97c367d2975ba9458f92", "patch": "@@ -0,0 +1,12 @@\n+// { dg-do compile }\n+// { dg-require-effective-target vect_double }\n+\n+#include <algorithm>\n+\n+void loop1(double * const __restrict__ vec, double x, int end)\n+{\n+  for (int i = 0; i < end; ++i)\n+    vec[i] = std::min(vec[i], vec[i]/x);\n+}\n+\n+// { dg-final { scan-tree-dump \"vectorized 1 loops\" \"vect\" } }"}, {"sha": "1ac6cee60b0eafcf5af09ad37ea3a7c9a5cb5cca", "filename": "gcc/tree-ssa-loop.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8964432ad6f17cef74aa97c367d2975ba9458f92/gcc%2Ftree-ssa-loop.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8964432ad6f17cef74aa97c367d2975ba9458f92/gcc%2Ftree-ssa-loop.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-loop.c?ref=8964432ad6f17cef74aa97c367d2975ba9458f92", "patch": "@@ -330,7 +330,7 @@ const pass_data pass_data_tree_loop_init =\n   PROP_cfg, /* properties_required */\n   0, /* properties_provided */\n   0, /* properties_destroyed */\n-  0, /* todo_flags_start */\n+  TODO_update_address_taken, /* todo_flags_start */\n   0, /* todo_flags_finish */\n };\n "}]}