{"sha": "f77b022b82d2ff2a4859b2dab1f58c97ce0d1b51", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Zjc3YjAyMmI4MmQyZmYyYTQ4NTliMmRhYjFmNThjOTdjZTBkMWI1MQ==", "commit": {"author": {"name": "Vincent Celier", "email": "celier@adacore.com", "date": "2011-08-03T12:36:13Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2011-08-03T12:36:13Z"}, "message": "make.adb (Gnatmake): Add to table Library_Projs only library projects that are not extended.\n\n2011-08-03  Vincent Celier  <celier@adacore.com>\n\n\t* make.adb (Gnatmake): Add to table Library_Projs only library projects\n\tthat are not extended. Do not check if a library project that is\n\textended should be regenerated. Do not add to table Library_Paths the\n\tlibraries that are in extended projects. Link only with libraries that\n\tare in libray projects that are not extended.\n\t* prj-nmsc.adb (Check_Library_Attributes): Do not reset flag Library\n\tfor a library project that is extended.\n\nFrom-SVN: r177269", "tree": {"sha": "b8cef53a01079c8f0649c5ae7f8071eea1632d37", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b8cef53a01079c8f0649c5ae7f8071eea1632d37"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f77b022b82d2ff2a4859b2dab1f58c97ce0d1b51", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f77b022b82d2ff2a4859b2dab1f58c97ce0d1b51", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f77b022b82d2ff2a4859b2dab1f58c97ce0d1b51", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f77b022b82d2ff2a4859b2dab1f58c97ce0d1b51/comments", "author": {"login": "vcelier", "id": 8888056, "node_id": "MDQ6VXNlcjg4ODgwNTY=", "avatar_url": "https://avatars.githubusercontent.com/u/8888056?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vcelier", "html_url": "https://github.com/vcelier", "followers_url": "https://api.github.com/users/vcelier/followers", "following_url": "https://api.github.com/users/vcelier/following{/other_user}", "gists_url": "https://api.github.com/users/vcelier/gists{/gist_id}", "starred_url": "https://api.github.com/users/vcelier/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vcelier/subscriptions", "organizations_url": "https://api.github.com/users/vcelier/orgs", "repos_url": "https://api.github.com/users/vcelier/repos", "events_url": "https://api.github.com/users/vcelier/events{/privacy}", "received_events_url": "https://api.github.com/users/vcelier/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "276e02243a3e9dfd2fa7043dba85dfb85a81f22a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/276e02243a3e9dfd2fa7043dba85dfb85a81f22a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/276e02243a3e9dfd2fa7043dba85dfb85a81f22a"}], "stats": {"total": 116, "additions": 66, "deletions": 50}, "files": [{"sha": "6afbcd295c8dddbf52ab4ead916a5fd364876992", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f77b022b82d2ff2a4859b2dab1f58c97ce0d1b51/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f77b022b82d2ff2a4859b2dab1f58c97ce0d1b51/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=f77b022b82d2ff2a4859b2dab1f58c97ce0d1b51", "patch": "@@ -1,3 +1,13 @@\n+2011-08-03  Vincent Celier  <celier@adacore.com>\n+\n+\t* make.adb (Gnatmake): Add to table Library_Projs only library projects\n+\tthat are not extended. Do not check if a library project that is\n+\textended should be regenerated. Do not add to table Library_Paths the\n+\tlibraries that are in extended projects. Link only with libraries that\n+\tare in libray projects that are not extended.\n+\t* prj-nmsc.adb (Check_Library_Attributes): Do not reset flag Library\n+\tfor a library project that is extended.\n+\n 2011-08-03  Gary Dismukes  <dismukes@adacore.com>\n \n \t* sem_ch6.adb (Find_Corresponding_Spec): When in an instance, skip"}, {"sha": "6be04b1569996fd79d753b507bd1d539766a4773", "filename": "gcc/ada/make.adb", "status": "modified", "additions": 56, "deletions": 48, "changes": 104, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f77b022b82d2ff2a4859b2dab1f58c97ce0d1b51/gcc%2Fada%2Fmake.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f77b022b82d2ff2a4859b2dab1f58c97ce0d1b51/gcc%2Fada%2Fmake.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fmake.adb?ref=f77b022b82d2ff2a4859b2dab1f58c97ce0d1b51", "patch": "@@ -5530,17 +5530,19 @@ package body Make is\n \n                      Proj1 := Project_Tree.Projects;\n                      while Proj1 /= null loop\n-                        if Proj1.Project.Standalone_Library then\n-                           Stand_Alone_Libraries := True;\n-                        end if;\n+                        if Proj1.Project.Extended_By = No_Project then\n+                           if Proj1.Project.Standalone_Library then\n+                              Stand_Alone_Libraries := True;\n+                           end if;\n \n-                        if Proj1.Project.Library then\n-                           MLib.Prj.Check_Library\n-                             (Proj1.Project, Project_Tree);\n-                        end if;\n+                           if Proj1.Project.Library then\n+                              MLib.Prj.Check_Library\n+                                (Proj1.Project, Project_Tree);\n+                           end if;\n \n-                        if Proj1.Project.Need_To_Build_Lib then\n-                           Add_To_Library_Projs (Proj1.Project);\n+                           if Proj1.Project.Need_To_Build_Lib then\n+                              Add_To_Library_Projs (Proj1.Project);\n+                           end if;\n                         end if;\n \n                         Proj1 := Proj1.Next;\n@@ -5553,6 +5555,7 @@ package body Make is\n                      Proj1 := Project_Tree.Projects;\n                      while Proj1 /= null loop\n                         if Proj1.Project.Library\n+                          and then Proj1.Project.Extended_By = No_Project\n                           and then Proj1.Project.Library_Kind /= Static\n                           and then not Proj1.Project.Need_To_Build_Lib\n                           and then not Proj1.Project.Externally_Built\n@@ -5898,11 +5901,10 @@ package body Make is\n                   --  except those of library projects.\n \n                   Prj.Env.Set_Ada_Paths\n-                    (Main_Project, Project_Tree, Use_Include_Path_File);\n-                  --  (Project => Main_Project,\n-                  --   In_Tree => Project_Tree,\n-                  --   Including_Libraries => True,\n-                  --   Include_Path => Use_Include_Path_File);\n+                    (Project => Main_Project,\n+                     In_Tree => Project_Tree,\n+                     Including_Libraries => False,\n+                     Include_Path => Use_Include_Path_File);\n \n                   --  If switch -C was specified, create a binder mapping file\n \n@@ -6000,6 +6002,7 @@ package body Make is\n                            --  is set, add it to the Library_Paths table.\n \n                            if Proj1.Project.Library_Kind /= Static\n+                             and then Proj1.Project.Extended_By = No_Project\n                              and then Path_Option /= null\n                            then\n                               Library_Paths.Increment_Last;\n@@ -6014,39 +6017,44 @@ package body Make is\n                      end loop;\n \n                      for Index in 1 .. Library_Projs.Last loop\n-                        if Library_Projs.Table (Index).Library_Kind = Static\n-                          and then not Targparm.OpenVMS_On_Target\n+                        if\n+                          Library_Projs.Table (Index).Extended_By = No_Project\n                         then\n-                           Linker_Switches.Increment_Last;\n-                           Linker_Switches.Table (Linker_Switches.Last) :=\n-                             new String'\n-                               (Get_Name_String\n-                                 (Library_Projs.Table\n-                                   (Index).Library_Dir.Display_Name) &\n-                                \"lib\" &\n-                                Get_Name_String\n-                                  (Library_Projs.Table (Index). Library_Name) &\n-                                \".\" &\n-                                MLib.Tgt.Archive_Ext);\n+                           if Library_Projs.Table (Index).Library_Kind = Static\n+                             and then not Targparm.OpenVMS_On_Target\n+                           then\n+                              Linker_Switches.Increment_Last;\n+                              Linker_Switches.Table (Linker_Switches.Last) :=\n+                                new String'\n+                                  (Get_Name_String\n+                                       (Library_Projs.Table\n+                                            (Index).Library_Dir.Display_Name) &\n+                                   \"lib\" &\n+                                   Get_Name_String\n+                                     (Library_Projs.Table\n+                                        (Index).Library_Name) &\n+                                   \".\" &\n+                                   MLib.Tgt.Archive_Ext);\n \n-                        else\n-                           --  Add the -L switch\n-\n-                           Linker_Switches.Increment_Last;\n-                           Linker_Switches.Table (Linker_Switches.Last) :=\n-                             new String'(\"-L\" &\n-                               Get_Name_String\n-                                 (Library_Projs.Table (Index).\n-                                    Library_Dir.Display_Name));\n-\n-                           --  Add the -l switch\n-\n-                           Linker_Switches.Increment_Last;\n-                           Linker_Switches.Table (Linker_Switches.Last) :=\n-                             new String'(\"-l\" &\n-                               Get_Name_String\n-                                 (Library_Projs.Table (Index).\n-                                    Library_Name));\n+                           else\n+                              --  Add the -L switch\n+\n+                              Linker_Switches.Increment_Last;\n+                              Linker_Switches.Table (Linker_Switches.Last) :=\n+                                new String'(\"-L\" &\n+                                  Get_Name_String\n+                                    (Library_Projs.Table (Index).\n+                                       Library_Dir.Display_Name));\n+\n+                              --  Add the -l switch\n+\n+                              Linker_Switches.Increment_Last;\n+                              Linker_Switches.Table (Linker_Switches.Last) :=\n+                                new String'(\"-l\" &\n+                                  Get_Name_String\n+                                    (Library_Projs.Table (Index).\n+                                       Library_Name));\n+                           end if;\n                         end if;\n                      end loop;\n                   end if;\n@@ -6080,9 +6088,9 @@ package body Make is\n                                  Linker_Switches.Increment_Last;\n                                  Linker_Switches.Table\n                                    (Linker_Switches.Last) :=\n-                                     new String'\n-                                       (Path_Option.all &\n-                                        Library_Paths.Table (Index).all);\n+                                   new String'\n+                                     (Path_Option.all &\n+                                      Library_Paths.Table (Index).all);\n                               end loop;\n \n                               --  One switch for the standard GNAT library dir"}, {"sha": "6c79fdec8d144ef1e07705806e59098bb74c832a", "filename": "gcc/ada/prj-nmsc.adb", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f77b022b82d2ff2a4859b2dab1f58c97ce0d1b51/gcc%2Fada%2Fprj-nmsc.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f77b022b82d2ff2a4859b2dab1f58c97ce0d1b51/gcc%2Fada%2Fprj-nmsc.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-nmsc.adb?ref=f77b022b82d2ff2a4859b2dab1f58c97ce0d1b51", "patch": "@@ -4271,8 +4271,6 @@ package body Prj.Nmsc is\n                exit;\n             end if;\n          end loop;\n-\n-         Project.Extends.Library := False;\n       end if;\n \n       if Project.Library and then not Lib_Name.Default then"}]}