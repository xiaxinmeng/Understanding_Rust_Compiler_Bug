{"sha": "3b96b93aec896a79bffad622ce6a161276cb198e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6M2I5NmI5M2FlYzg5NmE3OWJmZmFkNjIyY2U2YTE2MTI3NmNiMTk4ZQ==", "commit": {"author": {"name": "Martin Sebor", "email": "msebor@redhat.com", "date": "2016-02-24T17:23:35Z"}, "committer": {"name": "Martin Sebor", "email": "msebor@gcc.gnu.org", "date": "2016-02-24T17:23:35Z"}, "message": "PR c++/69912 - [6 regression] ICE in build_ctor_subob_ref initializing\n\nPR c++/69912 - [6 regression] ICE in build_ctor_subob_ref initializing\n\ta flexible array member\n\ngcc/testsuite/ChangeLog:\n2016-02-24  Martin Sebor  <msebor@redhat.com>\n\n\tPR c++/69912\n\t* g++.dg/ext/flexary15.C: New test.\n\ngcc/cp/ChangeLog:\n2016-02-24  Martin Sebor  <msebor@redhat.com>\n\n\tPR c++/69912\n\t* tree.c (build_ctor_subob_ref): Compare types' main variants\n        instead of the types as they are.\n\nFrom-SVN: r233678", "tree": {"sha": "df773a7c17ec70564d69527a0612f6a4dc771193", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/df773a7c17ec70564d69527a0612f6a4dc771193"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3b96b93aec896a79bffad622ce6a161276cb198e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3b96b93aec896a79bffad622ce6a161276cb198e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3b96b93aec896a79bffad622ce6a161276cb198e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3b96b93aec896a79bffad622ce6a161276cb198e/comments", "author": {"login": "msebor", "id": 381149, "node_id": "MDQ6VXNlcjM4MTE0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/381149?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msebor", "html_url": "https://github.com/msebor", "followers_url": "https://api.github.com/users/msebor/followers", "following_url": "https://api.github.com/users/msebor/following{/other_user}", "gists_url": "https://api.github.com/users/msebor/gists{/gist_id}", "starred_url": "https://api.github.com/users/msebor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msebor/subscriptions", "organizations_url": "https://api.github.com/users/msebor/orgs", "repos_url": "https://api.github.com/users/msebor/repos", "events_url": "https://api.github.com/users/msebor/events{/privacy}", "received_events_url": "https://api.github.com/users/msebor/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "57c2c374df803636ce218618091114ac13647467", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/57c2c374df803636ce218618091114ac13647467", "html_url": "https://github.com/Rust-GCC/gccrs/commit/57c2c374df803636ce218618091114ac13647467"}], "stats": {"total": 35, "additions": 31, "deletions": 4}, "files": [{"sha": "764d2a8283e4778e783058f04b9039be42e263c9", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3b96b93aec896a79bffad622ce6a161276cb198e/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3b96b93aec896a79bffad622ce6a161276cb198e/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=3b96b93aec896a79bffad622ce6a161276cb198e", "patch": "@@ -1,3 +1,9 @@\n+016-02-24  Martin Sebor  <msebor@redhat.com>\n+\n+\tPR c++/69912\n+\t* tree.c (build_ctor_subob_ref): Compare types' main variants\n+\tinstead of the types as they are.\n+\n 2016-02-24  Jason Merrill  <jason@redhat.com>\n \n \t* decl.c (start_preparsed_function): Condition ctor clobber on"}, {"sha": "0f7287ab0d76eaa7aed2e9e232b26c997e27e901", "filename": "gcc/cp/tree.c", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3b96b93aec896a79bffad622ce6a161276cb198e/gcc%2Fcp%2Ftree.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3b96b93aec896a79bffad622ce6a161276cb198e/gcc%2Fcp%2Ftree.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ftree.c?ref=3b96b93aec896a79bffad622ce6a161276cb198e", "patch": "@@ -2592,8 +2592,10 @@ build_ctor_subob_ref (tree index, tree type, tree obj)\n \t{\n \t  /* When the destination object refers to a flexible array member\n \t     verify that it matches the type of the source object except\n-\t     for its domain.  */\n-\t  gcc_assert (comptypes (type, objtype, COMPARE_REDECLARATION));\n+\t     for its domain and qualifiers.  */\n+\t  gcc_assert (comptypes (TYPE_MAIN_VARIANT (type),\n+\t  \t\t\t TYPE_MAIN_VARIANT (objtype),\n+\t  \t\t\t COMPARE_REDECLARATION));\n \t}\n       else\n \tgcc_assert (same_type_ignoring_top_level_qualifiers_p (type, objtype));"}, {"sha": "311232fbcdbdcf61b37c60a91ee5e91c63a5f1d6", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 7, "deletions": 2, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3b96b93aec896a79bffad622ce6a161276cb198e/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3b96b93aec896a79bffad622ce6a161276cb198e/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=3b96b93aec896a79bffad622ce6a161276cb198e", "patch": "@@ -1,8 +1,13 @@\n 2016-02-24  Martin Sebor  <msebor@redhat.com>\n \n-\t* gcc/testsuite/gcc.dg/builtins-68.c: Avoid making unportable\n+\tPR c++/69912\n+\t* g++.dg/ext/flexary15.C: New test.\n+\n+2016-02-24  Martin Sebor  <msebor@redhat.com>\n+\n+\t* gcc.dg/builtins-68.c: Avoid making unportable\n \tassumptions about the relationship between SIZE_MAX and UINT_MAX.\n-\t* gcc/testsuite/g++.dg/ext/builtin_alloca.C: Same.\n+\t* g++.dg/ext/builtin_alloca.C: Same.\n \n 2016-02-24  Maxim Kuvyrkov  <maxim.kuvyrkov@linaro.org>\n \t    Charles Baylis  <charles.baylis@linaro.org>"}, {"sha": "c03a60e7b50a6b5af1a0465dad80927f229a0a05", "filename": "gcc/testsuite/g++.dg/ext/flexary15.C", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3b96b93aec896a79bffad622ce6a161276cb198e/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fflexary15.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3b96b93aec896a79bffad622ce6a161276cb198e/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fflexary15.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fflexary15.C?ref=3b96b93aec896a79bffad622ce6a161276cb198e", "patch": "@@ -0,0 +1,14 @@\n+// PR c++/69912 - [6 regression] ICE in build_ctor_subob_ref initializing\n+//                a flexible array member\n+// { dg-do compile }\n+// { dg-options \"-Wno-pedantic -Wno-write-strings -fpermissive\" }\n+\n+struct S {\n+  int n; \n+  char *a[];\n+};\n+\n+void foo (const char *a)\n+{\n+  const S s = { 1, { a, \"b\" } };   // { dg-warning \"invalid conversion\" }\n+}"}]}