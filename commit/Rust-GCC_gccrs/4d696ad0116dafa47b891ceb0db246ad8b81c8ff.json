{"sha": "4d696ad0116dafa47b891ceb0db246ad8b81c8ff", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NGQ2OTZhZDAxMTZkYWZhNDdiODkxY2ViMGRiMjQ2YWQ4YjgxYzhmZg==", "commit": {"author": {"name": "Anatoly Sokolov", "email": "aesok@post.ru", "date": "2009-10-19T20:54:07Z"}, "committer": {"name": "Anatoly Sokolov", "email": "aesok@gcc.gnu.org", "date": "2009-10-19T20:54:07Z"}, "message": "cris.c (cris_function_value, [...]): New functions.\n\n\t* config/cris/cris.c (cris_function_value, cris_libcall_value,\n\tcris_function_value_regno_p): New functions.\n\t(cris_promote_function_mode): Update comment.\n\t(TARGET_FUNCTION_VALUE, TARGET_LIBCALL_VALUE): Declare.\n\t* config/cris/cris.h: (FUNCTION_VALUE, LIBCALL_VALUE): Remove.\n\t(FUNCTION_VALUE_REGNO_P): Redefine, use cris_function_value_regno_p.\n\t* config/cris/cris-protos.h (cris_function_value_regno_p): Declare.\n\nFrom-SVN: r152992", "tree": {"sha": "97e0203267944d09bf0b8ccc41c7f705cbad2f0e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/97e0203267944d09bf0b8ccc41c7f705cbad2f0e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4d696ad0116dafa47b891ceb0db246ad8b81c8ff", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4d696ad0116dafa47b891ceb0db246ad8b81c8ff", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4d696ad0116dafa47b891ceb0db246ad8b81c8ff", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4d696ad0116dafa47b891ceb0db246ad8b81c8ff/comments", "author": null, "committer": null, "parents": [{"sha": "270213ca8217b909df33a83ffd83d34815273a96", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/270213ca8217b909df33a83ffd83d34815273a96", "html_url": "https://github.com/Rust-GCC/gccrs/commit/270213ca8217b909df33a83ffd83d34815273a96"}], "stats": {"total": 61, "additions": 52, "deletions": 9}, "files": [{"sha": "83b507adb28cbb2834da7695464b0c06cb8f99a4", "filename": "gcc/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4d696ad0116dafa47b891ceb0db246ad8b81c8ff/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4d696ad0116dafa47b891ceb0db246ad8b81c8ff/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=4d696ad0116dafa47b891ceb0db246ad8b81c8ff", "patch": "@@ -1,3 +1,13 @@\n+2009-10-19  Anatoly Sokolov  <aesok@post.ru>\n+\n+\t* config/cris/cris.c (cris_function_value, cris_libcall_value,\n+\tcris_function_value_regno_p): New functions.\n+\t(cris_promote_function_mode): Update comment.\n+\t(TARGET_FUNCTION_VALUE, TARGET_LIBCALL_VALUE): Declare.\n+\t* config/cris/cris.h: (FUNCTION_VALUE, LIBCALL_VALUE): Remove.\n+\t(FUNCTION_VALUE_REGNO_P): Redefine, use cris_function_value_regno_p.\n+\t* config/cris/cris-protos.h (cris_function_value_regno_p): Declare.\n+\n 2009-10-19  Jakub Jelinek  <jakub@redhat.com>\n \n \t* unwind-dw2.c (execute_stack_op): Fix operand order for"}, {"sha": "721c90ff887f78ee109277d405cfd2c67e25a14f", "filename": "gcc/config/cris/cris-protos.h", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4d696ad0116dafa47b891ceb0db246ad8b81c8ff/gcc%2Fconfig%2Fcris%2Fcris-protos.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4d696ad0116dafa47b891ceb0db246ad8b81c8ff/gcc%2Fconfig%2Fcris%2Fcris-protos.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fcris%2Fcris-protos.h?ref=4d696ad0116dafa47b891ceb0db246ad8b81c8ff", "patch": "@@ -71,3 +71,5 @@ extern void cris_override_options (void);\n extern int cris_initial_elimination_offset (int, int);\n \n extern void cris_init_expanders (void);\n+\n+extern bool cris_function_value_regno_p (const unsigned int);"}, {"sha": "225ad403dda7eb657188a5883f1c583217ec589b", "filename": "gcc/config/cris/cris.c", "status": "modified", "additions": 39, "deletions": 2, "changes": 41, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4d696ad0116dafa47b891ceb0db246ad8b81c8ff/gcc%2Fconfig%2Fcris%2Fcris.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4d696ad0116dafa47b891ceb0db246ad8b81c8ff/gcc%2Fconfig%2Fcris%2Fcris.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fcris%2Fcris.c?ref=4d696ad0116dafa47b891ceb0db246ad8b81c8ff", "patch": "@@ -130,6 +130,9 @@ static bool cris_frame_pointer_required (void);\n static void cris_asm_trampoline_template (FILE *);\n static void cris_trampoline_init (rtx, tree, rtx);\n \n+static rtx cris_function_value(const_tree, const_tree, bool);\n+static rtx cris_libcall_value (enum machine_mode, const_rtx);\n+\n /* This is the parsed result of the \"-max-stack-stackframe=\" option.  If\n    it (still) is zero, then there was no such option given.  */\n int cris_max_stackframe = 0;\n@@ -197,6 +200,11 @@ int cris_cpu_version = CRIS_DEFAULT_CPU_VERSION;\n #undef TARGET_TRAMPOLINE_INIT\n #define TARGET_TRAMPOLINE_INIT cris_trampoline_init\n \n+#undef TARGET_FUNCTION_VALUE\n+#define TARGET_FUNCTION_VALUE cris_function_value\n+#undef TARGET_LIBCALL_VALUE\n+#define TARGET_LIBCALL_VALUE cris_libcall_value\n+\n struct gcc_target targetm = TARGET_INITIALIZER;\n \n /* Helper for cris_load_multiple_op and cris_ret_movem_op.  */\n@@ -3777,13 +3785,42 @@ cris_promote_function_mode (const_tree type ATTRIBUTE_UNUSED,\n                             int for_return)\n {\n   /* Defining PROMOTE_FUNCTION_RETURN in gcc-2.7.2 uncovered bug 981110 (even\n-     when modifying FUNCTION_VALUE to return the promoted mode).  Maybe\n-     pointless as of now, but let's keep the old behavior.  */\n+     when modifying TARGET_FUNCTION_VALUE to return the promoted mode).\n+     Maybe pointless as of now, but let's keep the old behavior.  */\n   if (for_return == 1)\n     return mode;\n   return CRIS_PROMOTED_MODE (mode, *punsignedp, type);\n } \n \n+/* Let's assume all functions return in r[CRIS_FIRST_ARG_REG] for the\n+   time being.  */\n+\n+static rtx\n+cris_function_value(const_tree type,\n+\t\t    const_tree func ATTRIBUTE_UNUSED,\n+\t\t    bool outgoing ATTRIBUTE_UNUSED)\n+{\n+  return gen_rtx_REG (TYPE_MODE (type), CRIS_FIRST_ARG_REG);\n+}\n+\n+/* Let's assume all functions return in r[CRIS_FIRST_ARG_REG] for the\n+   time being.  */\n+\n+static rtx\n+cris_libcall_value (enum machine_mode mode,\n+\t\t    const_rtx fun ATTRIBUTE_UNUSED)\n+{\n+  return gen_rtx_REG (mode, CRIS_FIRST_ARG_REG);\n+}\n+\n+/* Let's assume all functions return in r[CRIS_FIRST_ARG_REG] for the\n+   time being.  */\n+\n+bool\n+cris_function_value_regno_p (const unsigned int regno)\n+{\n+  return (regno == CRIS_FIRST_ARG_REG);\n+}\n \n static int\n cris_arg_partial_bytes (CUMULATIVE_ARGS *ca, enum machine_mode mode,"}, {"sha": "0fea7d77b39f48dbc3102b5cf4e21866e1fb07a7", "filename": "gcc/config/cris/cris.h", "status": "modified", "additions": 1, "deletions": 7, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4d696ad0116dafa47b891ceb0db246ad8b81c8ff/gcc%2Fconfig%2Fcris%2Fcris.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4d696ad0116dafa47b891ceb0db246ad8b81c8ff/gcc%2Fconfig%2Fcris%2Fcris.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fcris%2Fcris.h?ref=4d696ad0116dafa47b891ceb0db246ad8b81c8ff", "patch": "@@ -906,14 +906,8 @@ struct cum_args {int regs;};\n \n /* Node: Scalar Return */\n \n-/* Let's assume all functions return in r[CRIS_FIRST_ARG_REG] for the\n-   time being.  */\n-#define FUNCTION_VALUE(VALTYPE, FUNC)  \\\n- gen_rtx_REG (TYPE_MODE (VALTYPE), CRIS_FIRST_ARG_REG)\n+#define FUNCTION_VALUE_REGNO_P(N) cris_function_value_regno_p (N)\n \n-#define LIBCALL_VALUE(MODE) gen_rtx_REG (MODE, CRIS_FIRST_ARG_REG)\n-\n-#define FUNCTION_VALUE_REGNO_P(N) ((N) == CRIS_FIRST_ARG_REG)\n \n \n /* Node: Aggregate Return */"}]}