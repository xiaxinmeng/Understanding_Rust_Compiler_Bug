{"sha": "890b87d1743154cc57f54e6085e292b537dba428", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODkwYjg3ZDE3NDMxNTRjYzU3ZjU0ZTYwODVlMjkyYjUzN2RiYTQyOA==", "commit": {"author": {"name": "Thomas Schwinge", "email": "thomas@codesourcery.com", "date": "2018-12-14T20:41:46Z"}, "committer": {"name": "Thomas Schwinge", "email": "tschwinge@gcc.gnu.org", "date": "2018-12-14T20:41:46Z"}, "message": "Repair liboffloadmic after \"(Partial) OpenMP 5.0 support for GCC 9\"\n\n..., which now failed to build, as follows:\n\n    In file included from [...]/source-gcc/liboffloadmic/runtime/offload_common.h:43,\n                     from [...]/source-gcc/liboffloadmic/runtime/dv_util.cpp:31:\n    [...]/source-gcc/liboffloadmic/runtime/offload.h:220:12: error: conflicting declaration of C function 'int omp_target_is_present(void*, int)'\n      220 | extern int omp_target_is_present(\n          |            ^~~~~~~~~~~~~~~~~~~~~\n    In file included from [...]/source-gcc/liboffloadmic/runtime/offload.h:45,\n                     from [...]/source-gcc/liboffloadmic/runtime/offload_common.h:43,\n                     from [...]/source-gcc/liboffloadmic/runtime/dv_util.cpp:31:\n    ./../libgomp/omp.h:166:12: note: previous declaration 'int omp_target_is_present(const void*, int)'\n      166 | extern int omp_target_is_present (const void *, int) __GOMP_NOTHROW;\n          |            ^~~~~~~~~~~~~~~~~~~~~\n    In file included from [...]/source-gcc/liboffloadmic/runtime/offload_common.h:43,\n                     from [...]/source-gcc/liboffloadmic/runtime/dv_util.cpp:31:\n    [...]/source-gcc/liboffloadmic/runtime/offload.h:236:12: error: conflicting declaration of C function 'int omp_target_memcpy(void*, void*, size_t, size_t, size_t, int, int)'\n      236 | extern int omp_target_memcpy(\n          |            ^~~~~~~~~~~~~~~~~\n    In file included from [...]/source-gcc/liboffloadmic/runtime/offload.h:45,\n                     from [...]/source-gcc/liboffloadmic/runtime/offload_common.h:43,\n                     from [...]/source-gcc/liboffloadmic/runtime/dv_util.cpp:31:\n    ./../libgomp/omp.h:167:12: note: previous declaration 'int omp_target_memcpy(void*, const void*, long unsigned int, long unsigned int, long unsigned int, int, int)'\n      167 | extern int omp_target_memcpy (void *, const void *, __SIZE_TYPE__,\n          |            ^~~~~~~~~~~~~~~~~\n    In file included from [...]/source-gcc/liboffloadmic/runtime/offload_common.h:43,\n                     from [...]/source-gcc/liboffloadmic/runtime/dv_util.cpp:31:\n    [...]/source-gcc/liboffloadmic/runtime/offload.h:262:12: error: conflicting declaration of C function 'int omp_target_memcpy_rect(void*, void*, size_t, int, const size_t*, const size_t*, const size_t*, const size_t*, const size_t*, int, int)'\n      262 | extern int omp_target_memcpy_rect(\n          |            ^~~~~~~~~~~~~~~~~~~~~~\n    In file included from [...]/source-gcc/liboffloadmic/runtime/offload.h:45,\n                     from [...]/source-gcc/liboffloadmic/runtime/offload_common.h:43,\n                     from [...]/source-gcc/liboffloadmic/runtime/dv_util.cpp:31:\n    ./../libgomp/omp.h:170:12: note: previous declaration 'int omp_target_memcpy_rect(void*, const void*, long unsigned int, int, const long unsigned int*, const long unsigned int*, const long unsigned int*, const long unsigned int*, const long unsigned int*, int, int)'\n      170 | extern int omp_target_memcpy_rect (void *, const void *, __SIZE_TYPE__, int,\n          |            ^~~~~~~~~~~~~~~~~~~~~~\n    In file included from [...]/source-gcc/liboffloadmic/runtime/offload_common.h:43,\n                     from [...]/source-gcc/liboffloadmic/runtime/dv_util.cpp:31:\n    [...]/source-gcc/liboffloadmic/runtime/offload.h:285:12: error: conflicting declaration of C function 'int omp_target_associate_ptr(void*, void*, size_t, size_t, int)'\n      285 | extern int omp_target_associate_ptr(\n          |            ^~~~~~~~~~~~~~~~~~~~~~~~\n    In file included from [...]/source-gcc/liboffloadmic/runtime/offload.h:45,\n                     from [...]/source-gcc/liboffloadmic/runtime/offload_common.h:43,\n                     from [...]/source-gcc/liboffloadmic/runtime/dv_util.cpp:31:\n    ./../libgomp/omp.h:177:12: note: previous declaration 'int omp_target_associate_ptr(const void*, const void*, long unsigned int, long unsigned int, int)'\n      177 | extern int omp_target_associate_ptr (const void *, const void *, __SIZE_TYPE__,\n          |            ^~~~~~~~~~~~~~~~~~~~~~~~\n    In file included from [...]/source-gcc/liboffloadmic/runtime/offload_common.h:43,\n                     from [...]/source-gcc/liboffloadmic/runtime/dv_util.cpp:31:\n    [...]/source-gcc/liboffloadmic/runtime/offload.h:299:12: error: conflicting declaration of C function 'int omp_target_disassociate_ptr(void*, int)'\n      299 | extern int omp_target_disassociate_ptr(\n          |            ^~~~~~~~~~~~~~~~~~~~~~~~~~~\n    In file included from [...]/source-gcc/liboffloadmic/runtime/offload.h:45,\n                     from [...]/source-gcc/liboffloadmic/runtime/offload_common.h:43,\n                     from [...]/source-gcc/liboffloadmic/runtime/dv_util.cpp:31:\n    ./../libgomp/omp.h:179:12: note: previous declaration 'int omp_target_disassociate_ptr(const void*, int)'\n      179 | extern int omp_target_disassociate_ptr (const void *, int) __GOMP_NOTHROW;\n          |            ^~~~~~~~~~~~~~~~~~~~~~~~~~~\n    Makefile:904: recipe for target 'liboffloadmic_target_la-dv_util.lo' failed\n    make[3]: *** [liboffloadmic_target_la-dv_util.lo] Error 1\n    make[3]: Leaving directory '[...]/build-gcc-offload-x86_64-intelmicemul-linux-gnu/x86_64-intelmicemul-linux-gnu/liboffloadmic'\n    Makefile:1031: recipe for target 'all-recursive' failed\n    make[2]: *** [all-recursive] Error 1\n    make[2]: Leaving directory '[...]/build-gcc-offload-x86_64-intelmicemul-linux-gnu/x86_64-intelmicemul-linux-gnu/liboffloadmic'\n    Makefile:12707: recipe for target 'all-target-liboffloadmic' failed\n    make[1]: *** [all-target-liboffloadmic] Error 2\n    make[1]: Leaving directory '[...]/build-gcc-offload-x86_64-intelmicemul-linux-gnu'\n    Makefile:941: recipe for target 'all' failed\n    make: *** [all] Error 2\n\n\tliboffloadmic/\n\t* runtime/offload.h (omp_target_is_present, omp_target_memcpy)\n\t(omp_target_memcpy_rect, omp_target_associate_ptr)\n\t(omp_target_disassociate_ptr): Adjust to libgomp changes.\n\nFrom-SVN: r267145", "tree": {"sha": "3efc677d604af43c4dc8bb83d2e829ea9885a18e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3efc677d604af43c4dc8bb83d2e829ea9885a18e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/890b87d1743154cc57f54e6085e292b537dba428", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/890b87d1743154cc57f54e6085e292b537dba428", "html_url": "https://github.com/Rust-GCC/gccrs/commit/890b87d1743154cc57f54e6085e292b537dba428", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/890b87d1743154cc57f54e6085e292b537dba428/comments", "author": {"login": "tschwinge", "id": 21753, "node_id": "MDQ6VXNlcjIxNzUz", "avatar_url": "https://avatars.githubusercontent.com/u/21753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tschwinge", "html_url": "https://github.com/tschwinge", "followers_url": "https://api.github.com/users/tschwinge/followers", "following_url": "https://api.github.com/users/tschwinge/following{/other_user}", "gists_url": "https://api.github.com/users/tschwinge/gists{/gist_id}", "starred_url": "https://api.github.com/users/tschwinge/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tschwinge/subscriptions", "organizations_url": "https://api.github.com/users/tschwinge/orgs", "repos_url": "https://api.github.com/users/tschwinge/repos", "events_url": "https://api.github.com/users/tschwinge/events{/privacy}", "received_events_url": "https://api.github.com/users/tschwinge/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "b96778342fa7d6890876eecdaa0470b3915724e6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b96778342fa7d6890876eecdaa0470b3915724e6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b96778342fa7d6890876eecdaa0470b3915724e6"}], "stats": {"total": 18, "additions": 12, "deletions": 6}, "files": [{"sha": "8e4dc3747141f009d36caf31ed1b1db8ba4530b7", "filename": "liboffloadmic/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/890b87d1743154cc57f54e6085e292b537dba428/liboffloadmic%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/890b87d1743154cc57f54e6085e292b537dba428/liboffloadmic%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/liboffloadmic%2FChangeLog?ref=890b87d1743154cc57f54e6085e292b537dba428", "patch": "@@ -1,3 +1,9 @@\n+2018-12-14  Thomas Schwinge  <thomas@codesourcery.com>\n+\n+\t* runtime/offload.h (omp_target_is_present, omp_target_memcpy)\n+\t(omp_target_memcpy_rect, omp_target_associate_ptr)\n+\t(omp_target_disassociate_ptr): Adjust to libgomp changes.\n+\n 2018-10-31  Joseph Myers  <joseph@codesourcery.com>\n \n \tPR bootstrap/82856"}, {"sha": "4a329ba0e560ef186f4cc563a27117cefecd6b40", "filename": "liboffloadmic/runtime/offload.h", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/890b87d1743154cc57f54e6085e292b537dba428/liboffloadmic%2Fruntime%2Foffload.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/890b87d1743154cc57f54e6085e292b537dba428/liboffloadmic%2Fruntime%2Foffload.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/liboffloadmic%2Fruntime%2Foffload.h?ref=890b87d1743154cc57f54e6085e292b537dba428", "patch": "@@ -218,7 +218,7 @@ extern void omp_target_free(\n     \\return            true if storage is found, false otherwise.\n */\n extern int omp_target_is_present(\n-    void *ptr,\n+    const void *ptr,\n     int device_num\n ) __GOMP_NOTHROW;\n \n@@ -235,7 +235,7 @@ extern int omp_target_is_present(\n */\n extern int omp_target_memcpy(\n     void   *dst, \n-    void   *src, \n+    const void *src,\n     size_t  length, \n     size_t  dst_offset, \n     size_t  src_offset, \n@@ -261,7 +261,7 @@ extern int omp_target_memcpy(\n */\n extern int omp_target_memcpy_rect(\n     void         *dst,\n-    void         *src,\n+    const void   *src,\n     size_t        element_size,\n     int           num_dims,\n     const size_t *volume,\n@@ -283,8 +283,8 @@ extern int omp_target_memcpy_rect(\n     \\return               0 on success, 1 otherwise.\n */\n extern int omp_target_associate_ptr(\n-    void   *host_ptr, \n-    void   *device_ptr,\n+    const void *host_ptr,\n+    const void *device_ptr,\n     size_t  size,\n     size_t  device_offset,\n     int     device_num\n@@ -297,7 +297,7 @@ extern int omp_target_associate_ptr(\n     \\return            0 on success, 1 otherwise.\n */\n extern int omp_target_disassociate_ptr(\n-    void   *host_ptr,\n+    const void *host_ptr,\n     int     device_num\n ) __GOMP_NOTHROW;\n "}]}