{"sha": "e30ecc5d62d3fb4dcb02174702407799fb3f1c64", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTMwZWNjNWQ2MmQzZmI0ZGNiMDIxNzQ3MDI0MDc3OTlmYjNmMWM2NA==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2011-04-12T06:43:12Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2011-04-12T06:43:12Z"}, "message": "re PR c/48517 (ICE in build_unary_op, at c-typeck.c:3786)\n\n\tPR c/48517\n\t* c-typeck.c (store_init_value): Set TREE_TYPE (decl) to\n\tqualified type.\n\n\t* gcc.c-torture/compile/pr48517.c: New test.\n\nFrom-SVN: r172299", "tree": {"sha": "82fc95409c02251ff92e0134aaf36745e161820e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/82fc95409c02251ff92e0134aaf36745e161820e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e30ecc5d62d3fb4dcb02174702407799fb3f1c64", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e30ecc5d62d3fb4dcb02174702407799fb3f1c64", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e30ecc5d62d3fb4dcb02174702407799fb3f1c64", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e30ecc5d62d3fb4dcb02174702407799fb3f1c64/comments", "author": null, "committer": null, "parents": [{"sha": "bae5cddff8b905bb49ed4e013e9756ebea13c099", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bae5cddff8b905bb49ed4e013e9756ebea13c099", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bae5cddff8b905bb49ed4e013e9756ebea13c099"}], "stats": {"total": 17, "additions": 16, "deletions": 1}, "files": [{"sha": "15b77550dc3ab55bcdb60e83ba2f1775684b2a34", "filename": "gcc/c-typeck.c", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e30ecc5d62d3fb4dcb02174702407799fb3f1c64/gcc%2Fc-typeck.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e30ecc5d62d3fb4dcb02174702407799fb3f1c64/gcc%2Fc-typeck.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-typeck.c?ref=e30ecc5d62d3fb4dcb02174702407799fb3f1c64", "patch": "@@ -5773,11 +5773,13 @@ store_init_value (location_t init_loc, tree decl, tree init, tree origtype)\n \t      /* For int foo[] = (int [3]){1}; we need to set array size\n \t\t now since later on array initializer will be just the\n \t\t brace enclosed list of the compound literal.  */\n+\t      tree etype = strip_array_types (TREE_TYPE (decl));\n \t      type = build_distinct_type_copy (TYPE_MAIN_VARIANT (type));\n-\t      TREE_TYPE (decl) = type;\n \t      TYPE_DOMAIN (type) = TYPE_DOMAIN (TREE_TYPE (cldecl));\n \t      layout_type (type);\n \t      layout_decl (cldecl, 0);\n+\t      TREE_TYPE (decl)\n+\t\t= c_build_qualified_type (type, TYPE_QUALS (etype));\n \t    }\n \t}\n     }"}, {"sha": "30b3ecbb354703b305d01a03b2cd5c400faa0f2a", "filename": "gcc/testsuite/gcc.c-torture/compile/pr48517.c", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e30ecc5d62d3fb4dcb02174702407799fb3f1c64/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fpr48517.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e30ecc5d62d3fb4dcb02174702407799fb3f1c64/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fpr48517.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fpr48517.c?ref=e30ecc5d62d3fb4dcb02174702407799fb3f1c64", "patch": "@@ -0,0 +1,13 @@\n+/* PR c/48517 */\n+/* { dg-do compile } */\n+/* { dg-options \"\" } */\n+\n+void bar (const unsigned short *);\n+\n+void\n+foo (void)\n+{\n+  static const unsigned short array[] = (const unsigned short []) { 0x0D2B };\n+  const unsigned short *ptr = array;\n+  bar (ptr);\n+}"}]}