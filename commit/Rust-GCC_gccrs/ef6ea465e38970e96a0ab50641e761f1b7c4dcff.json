{"sha": "ef6ea465e38970e96a0ab50641e761f1b7c4dcff", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWY2ZWE0NjVlMzg5NzBlOTZhMGFiNTA2NDFlNzYxZjFiN2M0ZGNmZg==", "commit": {"author": {"name": "Vincent Celier", "email": "celier@adacore.com", "date": "2006-10-31T17:59:58Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2006-10-31T17:59:58Z"}, "message": "gnatlink.adb (Gnatlink): If gcc is not called with -shared-libgcc...\n\n2006-10-31  Vincent Celier  <celier@adacore.com>\n\n\t* gnatlink.adb (Gnatlink): If gcc is not called with -shared-libgcc,\n\tcall it with -static-libgcc, as there are some platforms, such as\n\tDarwin, where one of these two switches is compulsory to link.\n\nFrom-SVN: r118277", "tree": {"sha": "bacf20db14cbe9d46cad238e4da03caa369c5c5c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/bacf20db14cbe9d46cad238e4da03caa369c5c5c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ef6ea465e38970e96a0ab50641e761f1b7c4dcff", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ef6ea465e38970e96a0ab50641e761f1b7c4dcff", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ef6ea465e38970e96a0ab50641e761f1b7c4dcff", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ef6ea465e38970e96a0ab50641e761f1b7c4dcff/comments", "author": {"login": "vcelier", "id": 8888056, "node_id": "MDQ6VXNlcjg4ODgwNTY=", "avatar_url": "https://avatars.githubusercontent.com/u/8888056?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vcelier", "html_url": "https://github.com/vcelier", "followers_url": "https://api.github.com/users/vcelier/followers", "following_url": "https://api.github.com/users/vcelier/following{/other_user}", "gists_url": "https://api.github.com/users/vcelier/gists{/gist_id}", "starred_url": "https://api.github.com/users/vcelier/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vcelier/subscriptions", "organizations_url": "https://api.github.com/users/vcelier/orgs", "repos_url": "https://api.github.com/users/vcelier/repos", "events_url": "https://api.github.com/users/vcelier/events{/privacy}", "received_events_url": "https://api.github.com/users/vcelier/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "64c69860aa9a0a0fda1017d597f6fa5db5ba9e4e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/64c69860aa9a0a0fda1017d597f6fa5db5ba9e4e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/64c69860aa9a0a0fda1017d597f6fa5db5ba9e4e"}], "stats": {"total": 19, "additions": 18, "deletions": 1}, "files": [{"sha": "5e5f144790fef25d471821a9bd1cd668fef9d29e", "filename": "gcc/ada/gnatlink.adb", "status": "modified", "additions": 18, "deletions": 1, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ef6ea465e38970e96a0ab50641e761f1b7c4dcff/gcc%2Fada%2Fgnatlink.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ef6ea465e38970e96a0ab50641e761f1b7c4dcff/gcc%2Fada%2Fgnatlink.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgnatlink.adb?ref=ef6ea465e38970e96a0ab50641e761f1b7c4dcff", "patch": "@@ -57,6 +57,11 @@ procedure Gnatlink is\n                             new String'(Shared_Libgcc_String);\n    --  Used to invoke gcc when the binder is invoked with -shared\n \n+   Static_Libgcc_String : constant String := \"-static-libgcc\";\n+   Static_Libgcc        : constant String_Access :=\n+                            new String'(Static_Libgcc_String);\n+   --  Used to invoke gcc when shared libs are not used\n+\n    package Gcc_Linker_Options is new Table.Table (\n      Table_Component_Type => String_Access,\n      Table_Index_Type     => Integer,\n@@ -71,7 +76,7 @@ procedure Gnatlink is\n      Table_Index_Type     => Integer,\n      Table_Low_Bound      => 1,\n      Table_Initial        => 4096,\n-     Table_Increment      => 2,\n+     Table_Increment      => 100,\n      Table_Name           => \"Gnatlink.Libpath\");\n    --  Comments needed ???\n \n@@ -661,6 +666,7 @@ procedure Gnatlink is\n       --  Last object file index in Linker_Objects table\n \n       Status : int;\n+      pragma Warnings (Off, Status);\n       --  Used for various Interfaces.C_Streams calls\n \n       Closing_Status : Boolean;\n@@ -1803,6 +1809,17 @@ begin\n \n                J := J + 1;\n             end loop;\n+\n+            --  If gcc is not called with -shared-libgcc, call it with\n+            --  -static-libgcc, as there are some platforms where one of these\n+            --  two switches is compulsory to link.\n+\n+            if not Shared_Libgcc_Seen then\n+               Linker_Options.Increment_Last;\n+               Linker_Options.Table (Linker_Options.Last) := Static_Libgcc;\n+               Num_Args := Num_Args + 1;\n+            end if;\n+\n          end Clean_Link_Option_Set;\n \n          --  Prepare arguments for call to linker"}]}