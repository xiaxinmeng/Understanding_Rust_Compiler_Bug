{"sha": "a1527a93a6a7dcc031b917db1e6ff7efa8916c4a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTE1MjdhOTNhNmE3ZGNjMDMxYjkxN2RiMWU2ZmY3ZWZhODkxNmM0YQ==", "commit": {"author": {"name": "Thomas Preud'homme", "email": "thomas.preudhomme@arm.com", "date": "2017-04-04T16:24:18Z"}, "committer": {"name": "Thomas Preud'homme", "email": "thopre01@gcc.gnu.org", "date": "2017-04-04T16:24:18Z"}, "message": "[ARM] Fix small multiply feature\n\n2017-04-03  Thomas Preud'homme  <thomas.preudhomme@arm.com>\n\n    gcc/\n    PR target/80307\n    * config/arm/arm.c (thumb1_rtx_costs): Give a cost of 32\n    instructions for small multiply cores.\n\n    gcc/testsuite/\n    PR target/80307\n    * gcc.target/arm/small-multiply-m0-1.c: Do not skip test if not\n    targeting any CPU or architecture.\n    * gcc.target/arm/small-multiply-m0-2.c: Likewise.\n    * gcc.target/arm/small-multiply-m0-3.c: Likewise.\n    * gcc.target/arm/small-multiply-m0plus-1.c: Likewise.\n    * gcc.target/arm/small-multiply-m0plus-2.c: Likewise.\n    * gcc.target/arm/small-multiply-m0plus-3.c: Likewise.\n    * gcc.target/arm/small-multiply-m1-1.c: Likewise.\n    * gcc.target/arm/small-multiply-m1-2.c: Likewise.\n    * gcc.target/arm/small-multiply-m1-3.c: Likewise.\n\nFrom-SVN: r246682", "tree": {"sha": "bc35abe43e30f51545d485d92fda19d26c329fe4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/bc35abe43e30f51545d485d92fda19d26c329fe4"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a1527a93a6a7dcc031b917db1e6ff7efa8916c4a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a1527a93a6a7dcc031b917db1e6ff7efa8916c4a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a1527a93a6a7dcc031b917db1e6ff7efa8916c4a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a1527a93a6a7dcc031b917db1e6ff7efa8916c4a/comments", "author": {"login": "RoboTux", "id": 272327, "node_id": "MDQ6VXNlcjI3MjMyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/272327?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RoboTux", "html_url": "https://github.com/RoboTux", "followers_url": "https://api.github.com/users/RoboTux/followers", "following_url": "https://api.github.com/users/RoboTux/following{/other_user}", "gists_url": "https://api.github.com/users/RoboTux/gists{/gist_id}", "starred_url": "https://api.github.com/users/RoboTux/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RoboTux/subscriptions", "organizations_url": "https://api.github.com/users/RoboTux/orgs", "repos_url": "https://api.github.com/users/RoboTux/repos", "events_url": "https://api.github.com/users/RoboTux/events{/privacy}", "received_events_url": "https://api.github.com/users/RoboTux/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "8734bc723261fe8a0ba3b354f94519dfa60562ce", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8734bc723261fe8a0ba3b354f94519dfa60562ce", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8734bc723261fe8a0ba3b354f94519dfa60562ce"}], "stats": {"total": 43, "additions": 33, "deletions": 10}, "files": [{"sha": "4136a2922b904deae39b74f9d94e1f993f6376ec", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a1527a93a6a7dcc031b917db1e6ff7efa8916c4a/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a1527a93a6a7dcc031b917db1e6ff7efa8916c4a/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=a1527a93a6a7dcc031b917db1e6ff7efa8916c4a", "patch": "@@ -1,10 +1,16 @@\n+2017-04-04  Thomas Preud'homme  <thomas.preudhomme@arm.com>\n+\n+\tPR target/80307\n+\t* config/arm/arm.c (thumb1_rtx_costs): Give a cost of 32\n+\tinstructions for small multiply cores.\n+\n 2017-04-04  Jeff Law  <law@redhat.com>\n \n \t* config/mips/mips.c (mips_multi_add): Zero initialize the newly\n \tadded member.\n \t(mips_expand_vec_perm_const): Initialize elements in orig_perm\n \tthat are not set by the loop over the elements.\n-\t\n+\n 2017-04-04  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR target/80286"}, {"sha": "931c72d46f58f623d38ca445abfc5b241a990a10", "filename": "gcc/config/arm/arm.c", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a1527a93a6a7dcc031b917db1e6ff7efa8916c4a/gcc%2Fconfig%2Farm%2Farm.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a1527a93a6a7dcc031b917db1e6ff7efa8916c4a/gcc%2Fconfig%2Farm%2Farm.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Farm.c?ref=a1527a93a6a7dcc031b917db1e6ff7efa8916c4a", "patch": "@@ -8727,6 +8727,9 @@ thumb1_rtx_costs (rtx x, enum rtx_code code, enum rtx_code outer)\n       return COSTS_N_INSNS (1);\n \n     case MULT:\n+      if (arm_arch6m && arm_m_profile_small_mul)\n+\treturn COSTS_N_INSNS (32);\n+\n       if (CONST_INT_P (XEXP (x, 1)))\n \t{\n \t  int cycles = 0;"}, {"sha": "0d5f12853d96b0952d19f8ed9ca7381390e01daf", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a1527a93a6a7dcc031b917db1e6ff7efa8916c4a/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a1527a93a6a7dcc031b917db1e6ff7efa8916c4a/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=a1527a93a6a7dcc031b917db1e6ff7efa8916c4a", "patch": "@@ -1,3 +1,17 @@\n+2017-04-04  Thomas Preud'homme  <thomas.preudhomme@arm.com>\n+\n+\tPR target/80307\n+\t* gcc.target/arm/small-multiply-m0-1.c: Do not skip test if not\n+\ttargeting any CPU or architecture.\n+\t* gcc.target/arm/small-multiply-m0-2.c: Likewise.\n+\t* gcc.target/arm/small-multiply-m0-3.c: Likewise.\n+\t* gcc.target/arm/small-multiply-m0plus-1.c: Likewise.\n+\t* gcc.target/arm/small-multiply-m0plus-2.c: Likewise.\n+\t* gcc.target/arm/small-multiply-m0plus-3.c: Likewise.\n+\t* gcc.target/arm/small-multiply-m1-1.c: Likewise.\n+\t* gcc.target/arm/small-multiply-m1-2.c: Likewise.\n+\t* gcc.target/arm/small-multiply-m1-3.c: Likewise.\n+\n 2017-04-04  Nicolas Koenig  <koenigni@student.ethz.ch> \n \n \tPR fortran/69498"}, {"sha": "52c652c1cba3729c121d613bdb8c9f3524b04c98", "filename": "gcc/testsuite/gcc.target/arm/small-multiply-m0-1.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a1527a93a6a7dcc031b917db1e6ff7efa8916c4a/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fsmall-multiply-m0-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a1527a93a6a7dcc031b917db1e6ff7efa8916c4a/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fsmall-multiply-m0-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fsmall-multiply-m0-1.c?ref=a1527a93a6a7dcc031b917db1e6ff7efa8916c4a", "patch": "@@ -1,6 +1,6 @@\n /* { dg-do compile } */\n /* { dg-require-effective-target arm_thumb1_ok } */\n-/* { dg-skip-if \"Test is specific to cortex-m0.small-multiply\" { arm*-*-* } { \"*\" } { \"-mcpu=cortex-m0.small-multiply\" } } */\n+/* { dg-skip-if \"do not override -mcpu\" { *-*-* } { \"-mcpu=*\" \"-march=*\" } { \"-mcpu=cortex-m0.small-multiply\" } } */\n /* { dg-options \"-mcpu=cortex-m0.small-multiply -mthumb -O2\" } */\n \n int"}, {"sha": "10d49e9eace6141a5d3c906e235b6bbddaed8b4e", "filename": "gcc/testsuite/gcc.target/arm/small-multiply-m0-2.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a1527a93a6a7dcc031b917db1e6ff7efa8916c4a/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fsmall-multiply-m0-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a1527a93a6a7dcc031b917db1e6ff7efa8916c4a/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fsmall-multiply-m0-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fsmall-multiply-m0-2.c?ref=a1527a93a6a7dcc031b917db1e6ff7efa8916c4a", "patch": "@@ -1,6 +1,6 @@\n /* { dg-do compile } */\n /* { dg-require-effective-target arm_thumb1_ok } */\n-/* { dg-skip-if \"Test is specific to cortex-m0.small-multiply\" { arm*-*-* } { \"*\" } { \"-mcpu=cortex-m0.small-multiply\" } } */\n+/* { dg-skip-if \"do not override -mcpu\" { *-*-* } { \"-mcpu=*\" \"-march=*\" } { \"-mcpu=cortex-m0.small-multiply\" } } */\n /* { dg-options \"-mcpu=cortex-m0.small-multiply -mthumb -Os\" } */\n \n int"}, {"sha": "b4af511af86c88a6d98a2779b3dc808d2163380c", "filename": "gcc/testsuite/gcc.target/arm/small-multiply-m0-3.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a1527a93a6a7dcc031b917db1e6ff7efa8916c4a/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fsmall-multiply-m0-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a1527a93a6a7dcc031b917db1e6ff7efa8916c4a/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fsmall-multiply-m0-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fsmall-multiply-m0-3.c?ref=a1527a93a6a7dcc031b917db1e6ff7efa8916c4a", "patch": "@@ -1,6 +1,6 @@\n /* { dg-do compile } */\n /* { dg-require-effective-target arm_thumb1_ok } */\n-/* { dg-skip-if \"Test is specific to cortex-m0.small-multiply\" { arm*-*-* } { \"*\" } { \"-mcpu=cortex-m0.small-multiply\" } } */\n+/* { dg-skip-if \"do not override -mcpu\" { *-*-* } { \"-mcpu=*\" \"-march=*\" } { \"-mcpu=cortex-m0.small-multiply\" } } */\n /* { dg-options \"-mcpu=cortex-m0.small-multiply -mthumb -Os\" } */\n \n int"}, {"sha": "59dba7cf4abc814f0ee2cf9c4776d76d644a07fc", "filename": "gcc/testsuite/gcc.target/arm/small-multiply-m0plus-1.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a1527a93a6a7dcc031b917db1e6ff7efa8916c4a/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fsmall-multiply-m0plus-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a1527a93a6a7dcc031b917db1e6ff7efa8916c4a/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fsmall-multiply-m0plus-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fsmall-multiply-m0plus-1.c?ref=a1527a93a6a7dcc031b917db1e6ff7efa8916c4a", "patch": "@@ -1,6 +1,6 @@\n /* { dg-do compile } */\n /* { dg-require-effective-target arm_thumb1_ok } */\n-/* { dg-skip-if \"Test is specific to cortex-m0plus.small-multiply\" { arm*-*-* } { \"*\" } { \"-mcpu=cortex-m0plus.small-multiply\" } } */\n+/* { dg-skip-if \"do not override -mcpu\" { *-*-* } { \"-mcpu=*\" \"-march=*\" } { \"-mcpu=cortex-m0plus.small-multiply\" } } */\n /* { dg-options \"-mcpu=cortex-m0plus.small-multiply -mthumb -O2\" } */\n \n int"}, {"sha": "685ef44077669e6bc7152dd64b94d99056b93dd2", "filename": "gcc/testsuite/gcc.target/arm/small-multiply-m0plus-2.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a1527a93a6a7dcc031b917db1e6ff7efa8916c4a/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fsmall-multiply-m0plus-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a1527a93a6a7dcc031b917db1e6ff7efa8916c4a/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fsmall-multiply-m0plus-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fsmall-multiply-m0plus-2.c?ref=a1527a93a6a7dcc031b917db1e6ff7efa8916c4a", "patch": "@@ -1,6 +1,6 @@\n /* { dg-do compile } */\n /* { dg-require-effective-target arm_thumb1_ok } */\n-/* { dg-skip-if \"Test is specific to cortex-m0plus.small-multiply\" { arm*-*-* } { \"*\" } { \"-mcpu=cortex-m0plus.small-multiply\" } } */\n+/* { dg-skip-if \"do not override -mcpu\" { *-*-* } { \"-mcpu=*\" \"-march=*\" } { \"-mcpu=cortex-m0plus.small-multiply\" } } */\n /* { dg-options \"-mcpu=cortex-m0plus.small-multiply -mthumb -Os\" } */\n \n int"}, {"sha": "d24e720fe677fde0adf6865b24b3daf7bb2d286c", "filename": "gcc/testsuite/gcc.target/arm/small-multiply-m0plus-3.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a1527a93a6a7dcc031b917db1e6ff7efa8916c4a/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fsmall-multiply-m0plus-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a1527a93a6a7dcc031b917db1e6ff7efa8916c4a/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fsmall-multiply-m0plus-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fsmall-multiply-m0plus-3.c?ref=a1527a93a6a7dcc031b917db1e6ff7efa8916c4a", "patch": "@@ -1,6 +1,6 @@\n /* { dg-do compile } */\n /* { dg-require-effective-target arm_thumb1_ok } */\n-/* { dg-skip-if \"Test is specific to cortex-m0plus.small-multiply\" { arm*-*-* } { \"*\" } { \"-mcpu=cortex-m0plus.small-multiply\" } } */\n+/* { dg-skip-if \"do not override -mcpu\" { *-*-* } { \"-mcpu=*\" \"-march=*\" } { \"-mcpu=cortex-m0plus.small-multiply\" } } */\n /* { dg-options \"-mcpu=cortex-m0plus.small-multiply -mthumb -Os\" } */\n \n int"}, {"sha": "d966ae955ce8d8d02b438441a4d53262f7479d5f", "filename": "gcc/testsuite/gcc.target/arm/small-multiply-m1-1.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a1527a93a6a7dcc031b917db1e6ff7efa8916c4a/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fsmall-multiply-m1-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a1527a93a6a7dcc031b917db1e6ff7efa8916c4a/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fsmall-multiply-m1-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fsmall-multiply-m1-1.c?ref=a1527a93a6a7dcc031b917db1e6ff7efa8916c4a", "patch": "@@ -1,6 +1,6 @@\n /* { dg-do compile } */\n /* { dg-require-effective-target arm_thumb1_ok } */\n-/* { dg-skip-if \"Test is specific to cortex-m1.small-multiply\" { arm*-*-* } { \"*\" } { \"-mcpu=cortex-m1.small-multiply\" } } */\n+/* { dg-skip-if \"do not override -mcpu\" { *-*-* } { \"-mcpu=*\" \"-march=*\" } { \"-mcpu=cortex-m1.small-multiply\" } } */\n /* { dg-options \"-mcpu=cortex-m1.small-multiply -mthumb -O2\" } */\n \n int"}, {"sha": "60576bb9ed155d99851d6a00cd57eb3b78ea1a13", "filename": "gcc/testsuite/gcc.target/arm/small-multiply-m1-2.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a1527a93a6a7dcc031b917db1e6ff7efa8916c4a/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fsmall-multiply-m1-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a1527a93a6a7dcc031b917db1e6ff7efa8916c4a/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fsmall-multiply-m1-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fsmall-multiply-m1-2.c?ref=a1527a93a6a7dcc031b917db1e6ff7efa8916c4a", "patch": "@@ -1,6 +1,6 @@\n /* { dg-do compile } */\n /* { dg-require-effective-target arm_thumb1_ok } */\n-/* { dg-skip-if \"Test is specific to cortex-m1.small-multiply\" { arm*-*-* } { \"*\" } { \"-mcpu=cortex-m1.small-multiply\" } } */\n+/* { dg-skip-if \"do not override -mcpu\" { *-*-* } { \"-mcpu=*\" \"-march=*\" } { \"-mcpu=cortex-m1.small-multiply\" } } */\n /* { dg-options \"-mcpu=cortex-m1.small-multiply -mthumb -Os\" } */\n \n int"}, {"sha": "c56479d18973373fd8cc100d4614c083fd1a8cce", "filename": "gcc/testsuite/gcc.target/arm/small-multiply-m1-3.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a1527a93a6a7dcc031b917db1e6ff7efa8916c4a/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fsmall-multiply-m1-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a1527a93a6a7dcc031b917db1e6ff7efa8916c4a/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fsmall-multiply-m1-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fsmall-multiply-m1-3.c?ref=a1527a93a6a7dcc031b917db1e6ff7efa8916c4a", "patch": "@@ -1,6 +1,6 @@\n /* { dg-do compile } */\n /* { dg-require-effective-target arm_thumb1_ok } */\n-/* { dg-skip-if \"Test is specific to cortex-m1.small-multiply\" { arm*-*-* } { \"*\" } { \"-mcpu=cortex-m1.small-multiply\" } } */\n+/* { dg-skip-if \"do not override -mcpu\" { *-*-* } { \"-mcpu=*\" \"-march=*\" } { \"-mcpu=cortex-m1.small-multiply\" } } */\n /* { dg-options \"-mcpu=cortex-m1.small-multiply -mthumb -Os\" } */\n \n int"}]}