{"sha": "5a864002b8608352188f6019d28ba15878e05363", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NWE4NjQwMDJiODYwODM1MjE4OGY2MDE5ZDI4YmExNTg3OGUwNTM2Mw==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@gcc.gnu.org", "date": "2008-03-31T19:14:08Z"}, "committer": {"name": "Eric Botcazou", "email": "ebotcazou@gcc.gnu.org", "date": "2008-03-31T19:14:08Z"}, "message": "decl.c (gnat_to_gnu_entity): Do not force a non-null size if it has overflowed.\n\n\t* decl.c (gnat_to_gnu_entity) <object>: Do not force a non-null\n\tsize if it has overflowed.\n\nFrom-SVN: r133768", "tree": {"sha": "0f65879b64d2251911ce095698a002384eaf0bd2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0f65879b64d2251911ce095698a002384eaf0bd2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5a864002b8608352188f6019d28ba15878e05363", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5a864002b8608352188f6019d28ba15878e05363", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5a864002b8608352188f6019d28ba15878e05363", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5a864002b8608352188f6019d28ba15878e05363/comments", "author": null, "committer": null, "parents": [{"sha": "a12bdb97c9bb28dc996017ec826612ac61dbe846", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a12bdb97c9bb28dc996017ec826612ac61dbe846", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a12bdb97c9bb28dc996017ec826612ac61dbe846"}], "stats": {"total": 33, "additions": 30, "deletions": 3}, "files": [{"sha": "f5b9df21c6dd3e9b1dc5a2e3775a3dc516b41d8f", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5a864002b8608352188f6019d28ba15878e05363/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5a864002b8608352188f6019d28ba15878e05363/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=5a864002b8608352188f6019d28ba15878e05363", "patch": "@@ -1,5 +1,10 @@\n+2008-03-31  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* decl.c (gnat_to_gnu_entity) <object>: Do not force a non-null\n+\tsize if it has overflowed.\n+\n 2008-03-31  Olivier Hainque  <hainque@adacore.com>\n-            Eric Botcazou  <botcazou@adacore.com>\n+            Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* utils2.c (find_common_type): Document assumption on t1/t2 vs\n \tlhs/rhs. Force use of lhs type if smaller, whatever the modes."}, {"sha": "6f92fac5428ead4462a4003dccb06bc5e2445049", "filename": "gcc/ada/decl.c", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5a864002b8608352188f6019d28ba15878e05363/gcc%2Fada%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5a864002b8608352188f6019d28ba15878e05363/gcc%2Fada%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fdecl.c?ref=5a864002b8608352188f6019d28ba15878e05363", "patch": "@@ -640,8 +640,12 @@ gnat_to_gnu_entity (Entity_Id gnat_entity, tree gnu_expr, int definition)\n \t   clause, as we would lose useful information on the view size\n \t   (e.g. for null array slices) and we are not allocating the object\n \t   here anyway.  */\n-\tif (((gnu_size && integer_zerop (gnu_size))\n-\t     || (TYPE_SIZE (gnu_type) && integer_zerop (TYPE_SIZE (gnu_type))))\n+\tif (((gnu_size\n+\t      && integer_zerop (gnu_size)\n+\t      && !TREE_OVERFLOW (gnu_size))\n+\t     || (TYPE_SIZE (gnu_type)\n+\t\t && integer_zerop (TYPE_SIZE (gnu_type))\n+\t\t && !TREE_OVERFLOW (TYPE_SIZE (gnu_type))))\n \t    && (!Is_Constr_Subt_For_UN_Aliased (Etype (gnat_entity))\n \t\t|| !Is_Array_Type (Etype (gnat_entity)))\n \t    && !Present (Renamed_Object (gnat_entity))"}, {"sha": "ba35c2b25426661c528fd80ca1bc62dcf8d05ca2", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5a864002b8608352188f6019d28ba15878e05363/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5a864002b8608352188f6019d28ba15878e05363/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=5a864002b8608352188f6019d28ba15878e05363", "patch": "@@ -1,3 +1,7 @@\n+2008-03-31  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* gnat.dg/object_overflow.adb: New test.\n+\n 2008-03-31  Andrew Pinski  <andrew_pinski@playstation.sony.com>\n \n \tPR middle-end/30186"}, {"sha": "820e93656e6a29c21f3cbead4335f1659bada2c5", "filename": "gcc/testsuite/gnat.dg/object_overflow.adb", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5a864002b8608352188f6019d28ba15878e05363/gcc%2Ftestsuite%2Fgnat.dg%2Fobject_overflow.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5a864002b8608352188f6019d28ba15878e05363/gcc%2Ftestsuite%2Fgnat.dg%2Fobject_overflow.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fobject_overflow.adb?ref=5a864002b8608352188f6019d28ba15878e05363", "patch": "@@ -0,0 +1,14 @@\n+-- { dg-do compile }\n+\n+procedure Object_Overflow is\n+\n+  type Rec is null record;\n+\n+  procedure Proc (x : Rec) is begin null; end;\n+\n+  type Arr is array(Long_Integer) of Rec;\n+  Obj : Arr; -- { dg-warning \"Storage_Error will be raised\" }\n+\n+begin\n+  Proc (Obj(1));\n+end;"}]}