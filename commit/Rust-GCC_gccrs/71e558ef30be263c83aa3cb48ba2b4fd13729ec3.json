{"sha": "71e558ef30be263c83aa3cb48ba2b4fd13729ec3", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzFlNTU4ZWYzMGJlMjYzYzgzYWEzY2I0OGJhMmI0ZmQxMzcyOWVjMw==", "commit": {"author": {"name": "Jeff Law", "email": "law@redhat.com", "date": "2015-10-22T19:18:05Z"}, "committer": {"name": "Jeff Law", "email": "law@gcc.gnu.org", "date": "2015-10-22T19:18:05Z"}, "message": "[PATCH] Fix abort in write_eligible_delay\n\n[PATCH] Fix abort in write_eligible_delay\n        * genattrtab.c (main): If we do not have any annul-true or annul-false\n        slots, then write out a dummy eligible_for_annul_true or\n        eligible_for_annul_false as needed.\n\nFrom-SVN: r229184", "tree": {"sha": "06f531f631409981667204a33ef61e75bae1b02f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/06f531f631409981667204a33ef61e75bae1b02f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/71e558ef30be263c83aa3cb48ba2b4fd13729ec3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/71e558ef30be263c83aa3cb48ba2b4fd13729ec3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/71e558ef30be263c83aa3cb48ba2b4fd13729ec3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/71e558ef30be263c83aa3cb48ba2b4fd13729ec3/comments", "author": null, "committer": null, "parents": [{"sha": "8d535dab41846796712adabc2beb260f26ad457e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8d535dab41846796712adabc2beb260f26ad457e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8d535dab41846796712adabc2beb260f26ad457e"}], "stats": {"total": 36, "additions": 34, "deletions": 2}, "files": [{"sha": "04d8e1639d0c3fd139c70ec8aa72d3c427e115ee", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71e558ef30be263c83aa3cb48ba2b4fd13729ec3/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71e558ef30be263c83aa3cb48ba2b4fd13729ec3/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=71e558ef30be263c83aa3cb48ba2b4fd13729ec3", "patch": "@@ -1,3 +1,9 @@\n+2015-10-22  Jeff Law  <law@redhat.com>\n+\n+\t* genattrtab.c (main): If we do not have any annul-true or annul-false\n+\tslots, then write out a dummy eligible_for_annul_true or\n+\teligible_for_annul_false as needed.\n+\n 2015-10-22  Nick Clifton  <nickc@redhat.com>\n \n \t* config/msp430/msp430.opt: Add -msilicon-errata and"}, {"sha": "32b837c287c802c3ac5b659701b535b0171a3004", "filename": "gcc/genattrtab.c", "status": "modified", "additions": 28, "deletions": 2, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71e558ef30be263c83aa3cb48ba2b4fd13729ec3/gcc%2Fgenattrtab.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71e558ef30be263c83aa3cb48ba2b4fd13729ec3/gcc%2Fgenattrtab.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgenattrtab.c?ref=71e558ef30be263c83aa3cb48ba2b4fd13729ec3", "patch": "@@ -4411,6 +4411,26 @@ write_indent (FILE *outf, int indent)\n     fprintf (outf, \" \");\n }\n \n+/* If the target does not have annul-true or annul-false delay slots, this\n+   function will create a dummy eligible_for function on OUTF which always\n+   returns false.  KIND will be annul_true or annul_false.  */\n+\n+static void\n+write_dummy_eligible_delay (FILE *outf, const char *kind)\n+{\n+  /* Write function prelude.  */\n+\n+  fprintf (outf, \"int\\n\");\n+  fprintf (outf, \"eligible_for_%s (rtx_insn *delay_insn ATTRIBUTE_UNUSED,\\n\"\n+\t\t \"    int slot ATTRIBUTE_UNUSED,\\n\"\n+\t\t \"    rtx_insn *candidate_insn ATTRIBUTE_UNUSED,\\n\"\n+\t\t \"    int flags ATTRIBUTE_UNUSED)\\n\",\n+\t   kind);\n+  fprintf (outf, \"{\\n\");\n+  fprintf (outf, \"  return 0;\\n\");\n+  fprintf (outf, \"}\\n\\n\");\n+}\n+\n /* Write a subroutine that is given an insn that requires a delay slot, a\n    delay slot ordinal, and a candidate insn.  It returns nonzero if the\n    candidate can be placed in the specified delay slot of the insn.\n@@ -5307,8 +5327,14 @@ main (int argc, char **argv)\n      (The function to compute the number of delay slots will be written\n      below.)  */\n   write_eligible_delay (attr_file, \"delay\");\n-  write_eligible_delay (attr_file, \"annul_true\");\n-  write_eligible_delay (attr_file, \"annul_false\");\n+  if (have_annul_true)\n+    write_eligible_delay (attr_file, \"annul_true\");\n+  else\n+    write_dummy_eligible_delay (attr_file, \"annul_true\");\n+  if (have_annul_false)\n+    write_eligible_delay (attr_file, \"annul_false\");\n+  else\n+    write_dummy_eligible_delay (attr_file, \"annul_false\");\n \n   /* Write out constant delay slot info.  */\n   write_const_num_delay_slots (attr_file);"}]}