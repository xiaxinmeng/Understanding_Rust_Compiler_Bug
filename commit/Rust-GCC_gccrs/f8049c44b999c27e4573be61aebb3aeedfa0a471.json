{"sha": "f8049c44b999c27e4573be61aebb3aeedfa0a471", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjgwNDljNDRiOTk5YzI3ZTQ1NzNiZTYxYWViYjNhZWVkZmEwYTQ3MQ==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2017-10-18T09:20:31Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2017-10-18T09:20:31Z"}, "message": "re PR lto/82598 (lto debugobj lacks .note.GNU-stack)\n\n\tPR lto/82598\n\t* simple-object.c (handle_lto_debug_sections): Copy over also\n\t.note.GNU-stack section with unchanged name.\n\t* simple-object-elf.c (SHF_EXECINSTR): Define.\n\t(simple_object_elf_copy_lto_debug_section): Drop SHF_EXECINSTR bit\n\ton .note.GNU-stack section.\n\nFrom-SVN: r253851", "tree": {"sha": "32b58288db1646967f927fe5f8ad0201503115f1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/32b58288db1646967f927fe5f8ad0201503115f1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f8049c44b999c27e4573be61aebb3aeedfa0a471", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f8049c44b999c27e4573be61aebb3aeedfa0a471", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f8049c44b999c27e4573be61aebb3aeedfa0a471", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f8049c44b999c27e4573be61aebb3aeedfa0a471/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "ac2bb5222b47c6d79372ecbc16da3b282792ea07", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ac2bb5222b47c6d79372ecbc16da3b282792ea07", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ac2bb5222b47c6d79372ecbc16da3b282792ea07"}], "stats": {"total": 22, "additions": 21, "deletions": 1}, "files": [{"sha": "f1f010327b065faddad862af937b899e18106d28", "filename": "libiberty/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f8049c44b999c27e4573be61aebb3aeedfa0a471/libiberty%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f8049c44b999c27e4573be61aebb3aeedfa0a471/libiberty%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libiberty%2FChangeLog?ref=f8049c44b999c27e4573be61aebb3aeedfa0a471", "patch": "@@ -1,3 +1,12 @@\n+2017-10-18  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR lto/82598\n+\t* simple-object.c (handle_lto_debug_sections): Copy over also\n+\t.note.GNU-stack section with unchanged name.\n+\t* simple-object-elf.c (SHF_EXECINSTR): Define.\n+\t(simple_object_elf_copy_lto_debug_section): Drop SHF_EXECINSTR bit\n+\ton .note.GNU-stack section.\n+\n 2017-09-25  Nathan Sidwell  <nathan@acm.org>\n \n \tPR demangler/82195"}, {"sha": "c39492439d099372f1d76e5b14d0015484bc3a5a", "filename": "libiberty/simple-object-elf.c", "status": "modified", "additions": 9, "deletions": 1, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f8049c44b999c27e4573be61aebb3aeedfa0a471/libiberty%2Fsimple-object-elf.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f8049c44b999c27e4573be61aebb3aeedfa0a471/libiberty%2Fsimple-object-elf.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libiberty%2Fsimple-object-elf.c?ref=f8049c44b999c27e4573be61aebb3aeedfa0a471", "patch": "@@ -196,6 +196,7 @@ typedef struct {\n \n /* Values for sh_flags field.  */\n \n+#define SHF_EXECINSTR\t0x00000004\t/* Executable section.  */\n #define SHF_EXCLUDE\t0x80000000\t/* Link editor is to exclude this\n \t\t\t\t\t   section from executable and\n \t\t\t\t\t   shared library that it builds\n@@ -1403,7 +1404,14 @@ simple_object_elf_copy_lto_debug_sections (simple_object_read *sobj,\n       flags = ELF_FETCH_FIELD (type_functions, ei_class, Shdr,\n \t\t\t       shdr, sh_flags, Elf_Addr);\n       if (ret == 0)\n-\tflags &= ~SHF_EXCLUDE;\n+\t{\n+\t  /* The debugobj doesn't contain any code, thus no trampolines.\n+\t     Even when the original object needs trampolines, debugobj\n+\t     doesn't.  */\n+\t  if (strcmp (name, \".note.GNU-stack\") == 0)\n+\t    flags &= ~SHF_EXECINSTR;\n+\t  flags &= ~SHF_EXCLUDE;\n+\t}\n       else if (ret == -1)\n \tflags = SHF_EXCLUDE;\n       ELF_SET_FIELD (type_functions, ei_class, Shdr,"}, {"sha": "19d222fb1cd11cfe5b0dfc30b5399457be4e568e", "filename": "libiberty/simple-object.c", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f8049c44b999c27e4573be61aebb3aeedfa0a471/libiberty%2Fsimple-object.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f8049c44b999c27e4573be61aebb3aeedfa0a471/libiberty%2Fsimple-object.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libiberty%2Fsimple-object.c?ref=f8049c44b999c27e4573be61aebb3aeedfa0a471", "patch": "@@ -273,6 +273,9 @@ handle_lto_debug_sections (const char **name)\n       *name = *name + sizeof (\".gnu.lto_\") - 1;\n       return 1;\n     }\n+  /* Copy over .note.GNU-stack section under the same name if present.  */\n+  else if (strcmp (*name, \".note.GNU-stack\") == 0)\n+    return 1;\n   return 0;\n }\n "}]}