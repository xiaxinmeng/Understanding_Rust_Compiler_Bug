{"sha": "62448787ebfeba29c475b5713b97aaade1ce2243", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjI0NDg3ODdlYmZlYmEyOWM0NzViNTcxM2I5N2FhYWRlMWNlMjI0Mw==", "commit": {"author": {"name": "Paolo Carlini", "email": "pcarlini@suse.de", "date": "2006-02-19T18:27:06Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2006-02-19T18:27:06Z"}, "message": "std_sstream.h (basic_stringbuf<>::setbuf): Simply clear the internal _M_string, adjust _M_sync call.\n\n2006-02-19  Paolo Carlini  <pcarlini@suse.de>\n\n\t* include/std/std_sstream.h (basic_stringbuf<>::setbuf): Simply\n\tclear the internal _M_string, adjust _M_sync call.\n\t* include/bits/sstream.tcc (basic_stringbuf<>::_M_sync): Adjust\n\tconsistently for calls from setbuf.\n\nFrom-SVN: r111274", "tree": {"sha": "363e7e2ffa23a15ca68d5303ce41c5f2747038d7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/363e7e2ffa23a15ca68d5303ce41c5f2747038d7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/62448787ebfeba29c475b5713b97aaade1ce2243", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/62448787ebfeba29c475b5713b97aaade1ce2243", "html_url": "https://github.com/Rust-GCC/gccrs/commit/62448787ebfeba29c475b5713b97aaade1ce2243", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/62448787ebfeba29c475b5713b97aaade1ce2243/comments", "author": null, "committer": null, "parents": [{"sha": "4cf4d6a32328de2725c0ca4ca7a991b97ab5e46f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4cf4d6a32328de2725c0ca4ca7a991b97ab5e46f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4cf4d6a32328de2725c0ca4ca7a991b97ab5e46f"}], "stats": {"total": 39, "additions": 23, "deletions": 16}, "files": [{"sha": "1e1c79fb275bc924e33dfba42ece69233763cdea", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/62448787ebfeba29c475b5713b97aaade1ce2243/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/62448787ebfeba29c475b5713b97aaade1ce2243/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=62448787ebfeba29c475b5713b97aaade1ce2243", "patch": "@@ -1,3 +1,10 @@\n+2006-02-19  Paolo Carlini  <pcarlini@suse.de>\n+\n+\t* include/std/std_sstream.h (basic_stringbuf<>::setbuf): Simply\n+\tclear the internal _M_string, adjust _M_sync call.\n+\t* include/bits/sstream.tcc (basic_stringbuf<>::_M_sync): Adjust\n+\tconsistently for calls from setbuf.\n+\n 2006-02-17  Paolo Carlini  <pcarlini@suse.de>\n \t    Howard Hinnant  <hhinnant@apple.com>\n "}, {"sha": "2c5be334557d54bafce3736df0381778fcc0e12a", "filename": "libstdc++-v3/include/bits/sstream.tcc", "status": "modified", "additions": 14, "deletions": 14, "changes": 28, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/62448787ebfeba29c475b5713b97aaade1ce2243/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fsstream.tcc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/62448787ebfeba29c475b5713b97aaade1ce2243/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fsstream.tcc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fsstream.tcc?ref=62448787ebfeba29c475b5713b97aaade1ce2243", "patch": "@@ -225,35 +225,35 @@ _GLIBCXX_BEGIN_NAMESPACE(std)\n       return __ret;\n     }\n \n-  // Assumes: contents of _M_string and internal buffer match exactly.\n-  // __i == _M_in_cur - _M_in_beg\n-  // __o == _M_out_cur - _M_out_beg\n   template <class _CharT, class _Traits, class _Alloc>\n     void\n     basic_stringbuf<_CharT, _Traits, _Alloc>::\n     _M_sync(char_type* __base, __size_type __i, __size_type __o)\n     {\n       const bool __testin = _M_mode & ios_base::in;\n       const bool __testout = _M_mode & ios_base::out;\n-      char_type* __end = __base + _M_string.size();\n-      \n+      char_type* __endg = __base + _M_string.size();\n+      char_type* __endp = __base + _M_string.capacity();\n+\n+      if (__base != _M_string.data())\n+\t{\n+\t  // setbuf: __i == size of buffer area (_M_string.size() == 0).\n+\t  __endg += __i;\n+\t  __i = 0;\n+\t  __endp = __endg;\n+\t}\n+\n       if (__testin)\n-\tthis->setg(__base, __base + __i, __end);\n+\tthis->setg(__base, __base + __i, __endg);\n       if (__testout)\n \t{\n-\t  // If __base comes from setbuf we cannot trust capacity()\n-\t  // to match the size of the buffer area:  in general, after\n-\t  // Step 1 in setbuf, _M_string.capacity() >= __n.\n-\t  if (__base == _M_string.data())\n-\t    this->setp(__base, __base + _M_string.capacity());\n-\t  else\n-\t    this->setp(__base, __end);\n+\t  this->setp(__base, __endp);\n \t  this->pbump(__o);\n \t  // egptr() always tracks the string end.  When !__testin,\n \t  // for the correct functioning of the streambuf inlines\n \t  // the other get area pointers are identical.\n \t  if (!__testin)\n-\t    this->setg(__end, __end, __end);\n+\t    this->setg(__endg, __endg, __endg);\n \t}\n     }\n "}, {"sha": "f30c23bfeac193a4601f590f05ffa9fed0710b2d", "filename": "libstdc++-v3/include/std/std_sstream.h", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/62448787ebfeba29c475b5713b97aaade1ce2243/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fstd_sstream.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/62448787ebfeba29c475b5713b97aaade1ce2243/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fstd_sstream.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fstd_sstream.h?ref=62448787ebfeba29c475b5713b97aaade1ce2243", "patch": "@@ -211,10 +211,10 @@ _GLIBCXX_BEGIN_NAMESPACE(std)\n \t    // things will quickly blow up.\n \t    \n \t    // Step 1: Destroy the current internal array.\n-\t    _M_string.assign(__s, __n);\n+\t    _M_string.clear();\n \t    \n \t    // Step 2: Use the external array.\n-\t    _M_sync(__s, 0, 0);\n+\t    _M_sync(__s, __n, 0);\n \t  }\n \treturn this;\n       }"}]}