{"sha": "1cefb0511e72b85a59a822040fe19da09ee3a5bb", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWNlZmIwNTExZTcyYjg1YTU5YTgyMjA0MGZlMTlkYTA5ZWUzYTViYg==", "commit": {"author": {"name": "Bill Schmidt", "email": "wschmidt@linux.vnet.ibm.com", "date": "2017-03-21T18:14:42Z"}, "committer": {"name": "William Schmidt", "email": "wschmidt@gcc.gnu.org", "date": "2017-03-21T18:14:42Z"}, "message": "re PR tree-optimization/79908 (ICE in gimplify_expr (gimplify.c:12155) gimplification failed)\n\n[gcc]\n\n2017-03-21  Bill Schmidt  <wschmidt@linux.vnet.ibm.com>\n\n\tPR tree-optimization/79908\n\t* tree-stdarg.c (expand_ifn_va_arg_1): Revert the following\n\tchange: For a VA_ARG whose LHS has been cast away, use\n\tforce_gimple_operand to construct the side effects.\n\n[gcc/testsuite]\n\n2017-03-21  Bill Schmidt  <wschmidt@linux.vnet.ibm.com>\n\n\tPR tree-optimization/79908\n\t* gcc.dg/torture/pr79908.c: Revert addition of new file.\n\nFrom-SVN: r246330", "tree": {"sha": "201986efd5724a888ae2ee2dc26fb71e2e3aa54b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/201986efd5724a888ae2ee2dc26fb71e2e3aa54b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1cefb0511e72b85a59a822040fe19da09ee3a5bb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1cefb0511e72b85a59a822040fe19da09ee3a5bb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1cefb0511e72b85a59a822040fe19da09ee3a5bb", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1cefb0511e72b85a59a822040fe19da09ee3a5bb/comments", "author": {"login": "wschmidt-ibm", "id": 5520937, "node_id": "MDQ6VXNlcjU1MjA5Mzc=", "avatar_url": "https://avatars.githubusercontent.com/u/5520937?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wschmidt-ibm", "html_url": "https://github.com/wschmidt-ibm", "followers_url": "https://api.github.com/users/wschmidt-ibm/followers", "following_url": "https://api.github.com/users/wschmidt-ibm/following{/other_user}", "gists_url": "https://api.github.com/users/wschmidt-ibm/gists{/gist_id}", "starred_url": "https://api.github.com/users/wschmidt-ibm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wschmidt-ibm/subscriptions", "organizations_url": "https://api.github.com/users/wschmidt-ibm/orgs", "repos_url": "https://api.github.com/users/wschmidt-ibm/repos", "events_url": "https://api.github.com/users/wschmidt-ibm/events{/privacy}", "received_events_url": "https://api.github.com/users/wschmidt-ibm/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "efebb49e44278330ed9ed9c60da62c813722bebf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/efebb49e44278330ed9ed9c60da62c813722bebf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/efebb49e44278330ed9ed9c60da62c813722bebf"}], "stats": {"total": 36, "additions": 16, "deletions": 20}, "files": [{"sha": "4706704ade58842f6e44910a291201dcc9f3b30c", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1cefb0511e72b85a59a822040fe19da09ee3a5bb/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1cefb0511e72b85a59a822040fe19da09ee3a5bb/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=1cefb0511e72b85a59a822040fe19da09ee3a5bb", "patch": "@@ -1,3 +1,10 @@\n+2017-03-21  Bill Schmidt  <wschmidt@linux.vnet.ibm.com>\n+\n+\tPR tree-optimization/79908\n+\t* tree-stdarg.c (expand_ifn_va_arg_1): Revert the following\n+\tchange: For a VA_ARG whose LHS has been cast away, use\n+\tforce_gimple_operand to construct the side effects.\n+\n 2017-03-21  David Malcolm  <dmalcolm@redhat.com>\n \n \tPR translation/80001"}, {"sha": "aa6ec43ebc0eb3b389871212b1f6ddd865ef884a", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1cefb0511e72b85a59a822040fe19da09ee3a5bb/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1cefb0511e72b85a59a822040fe19da09ee3a5bb/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=1cefb0511e72b85a59a822040fe19da09ee3a5bb", "patch": "@@ -1,3 +1,8 @@\n+2017-03-21  Bill Schmidt  <wschmidt@linux.vnet.ibm.com>\n+\n+\tPR tree-optimization/79908\n+\t* gcc.dg/torture/pr79908.c: Revert addition of new file.\n+\n 2017-03-21  Marek Polacek  <polacek@redhat.com>\n \t    Martin Sebor  <msebor@redhat.com>\n "}, {"sha": "e69de29bb2d1d6434b8b29ae775ad8c2e48c5391", "filename": "gcc/testsuite/gcc.dg/torture/pr79908.c", "status": "modified", "additions": 0, "deletions": 12, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1cefb0511e72b85a59a822040fe19da09ee3a5bb/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr79908.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1cefb0511e72b85a59a822040fe19da09ee3a5bb/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr79908.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr79908.c?ref=1cefb0511e72b85a59a822040fe19da09ee3a5bb", "patch": "@@ -1,12 +0,0 @@\n-/* { dg-do compile } */\n-\n-/* Used to fail in the stdarg pass before fix for PR79908.  */\n-\n-typedef __builtin_va_list __gnuc_va_list;\n-typedef __gnuc_va_list va_list;\n-\n-void testva (int n, ...)\n-{\n-  va_list ap;\n-  _Complex int i = __builtin_va_arg (ap, _Complex int);\n-}"}, {"sha": "8972822f5b7d38fdb66d8261639d72b97d56f878", "filename": "gcc/tree-stdarg.c", "status": "modified", "additions": 4, "deletions": 8, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1cefb0511e72b85a59a822040fe19da09ee3a5bb/gcc%2Ftree-stdarg.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1cefb0511e72b85a59a822040fe19da09ee3a5bb/gcc%2Ftree-stdarg.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-stdarg.c?ref=1cefb0511e72b85a59a822040fe19da09ee3a5bb", "patch": "@@ -33,7 +33,6 @@ along with GCC; see the file COPYING3.  If not see\n #include \"gimple-iterator.h\"\n #include \"gimple-walk.h\"\n #include \"gimplify.h\"\n-#include \"gimplify-me.h\"\n #include \"tree-into-ssa.h\"\n #include \"tree-cfg.h\"\n #include \"tree-stdarg.h\"\n@@ -1059,16 +1058,12 @@ expand_ifn_va_arg_1 (function *fun)\n \t    gimplify_assign (lhs, expr, &pre);\n \t  }\n \telse\n-\t  {\n-\t    gimple_seq tmp_seq;\n-\t    force_gimple_operand (expr, &tmp_seq, false, NULL_TREE);\n-\t    gimple_seq_add_seq_without_update (&pre, tmp_seq);\n-\t  }\n+\t  gimplify_expr (&expr, &pre, &post, is_gimple_lvalue, fb_lvalue);\n \n \tinput_location = saved_location;\n \tpop_gimplify_context (NULL);\n \n-\tgimple_seq_add_seq_without_update (&pre, post);\n+\tgimple_seq_add_seq (&pre, post);\n \tupdate_modified_stmts (pre);\n \n \t/* Add the sequence after IFN_VA_ARG.  This splits the bb right\n@@ -1077,10 +1072,11 @@ expand_ifn_va_arg_1 (function *fun)\n \tgimple_find_sub_bbs (pre, &i);\n \n \t/* Remove the IFN_VA_ARG gimple_call.  It's the last stmt in the\n-\t   bb if we added any stmts.  */\n+\t   bb.  */\n \tunlink_stmt_vdef (stmt);\n \trelease_ssa_name_fn (fun, gimple_vdef (stmt));\n \tgsi_remove (&i, true);\n+\tgcc_assert (gsi_end_p (i));\n \n \t/* We're walking here into the bbs which contain the expansion of\n \t   IFN_VA_ARG, and will not contain another IFN_VA_ARG that needs"}]}