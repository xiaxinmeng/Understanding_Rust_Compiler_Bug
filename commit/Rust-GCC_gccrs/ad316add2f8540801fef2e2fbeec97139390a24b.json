{"sha": "ad316add2f8540801fef2e2fbeec97139390a24b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWQzMTZhZGQyZjg1NDA4MDFmZWYyZTJmYmVlYzk3MTM5MzkwYTI0Yg==", "commit": {"author": {"name": "Doug Rupp", "email": "rupp@adacore.com", "date": "2008-08-01T07:38:54Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2008-08-01T07:38:54Z"}, "message": "mlib-tgt-specific-vms-alpha.adb (Build_Dynamic_Library): Output a dummy transfer address for debugging.\n\n2008-08-01  Doug Rupp  <rupp@adacore.com>\n\n\t* mlib-tgt-specific-vms-alpha.adb (Build_Dynamic_Library): Output a\n\tdummy transfer address for debugging.\n\t\n\t* mlib-tgt-specific-vms-ia64.adb (Build_Dynamic_Library): Likewise.\n\nFrom-SVN: r138464", "tree": {"sha": "8f920e272577f7eff4f750d7c46cb9210bc5eb25", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8f920e272577f7eff4f750d7c46cb9210bc5eb25"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ad316add2f8540801fef2e2fbeec97139390a24b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ad316add2f8540801fef2e2fbeec97139390a24b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ad316add2f8540801fef2e2fbeec97139390a24b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ad316add2f8540801fef2e2fbeec97139390a24b/comments", "author": {"login": "Cementitious", "id": 115579865, "node_id": "U_kgDOBuOb2Q", "avatar_url": "https://avatars.githubusercontent.com/u/115579865?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Cementitious", "html_url": "https://github.com/Cementitious", "followers_url": "https://api.github.com/users/Cementitious/followers", "following_url": "https://api.github.com/users/Cementitious/following{/other_user}", "gists_url": "https://api.github.com/users/Cementitious/gists{/gist_id}", "starred_url": "https://api.github.com/users/Cementitious/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Cementitious/subscriptions", "organizations_url": "https://api.github.com/users/Cementitious/orgs", "repos_url": "https://api.github.com/users/Cementitious/repos", "events_url": "https://api.github.com/users/Cementitious/events{/privacy}", "received_events_url": "https://api.github.com/users/Cementitious/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "0f300ef506a9eb119d35435e7ba06cc8b4e22775", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0f300ef506a9eb119d35435e7ba06cc8b4e22775", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0f300ef506a9eb119d35435e7ba06cc8b4e22775"}], "stats": {"total": 117, "additions": 50, "deletions": 67}, "files": [{"sha": "f272307b9359e4dd7cd3891f3b3ada8da0c013cb", "filename": "gcc/ada/mlib-tgt-specific-vms-alpha.adb", "status": "modified", "additions": 23, "deletions": 16, "changes": 39, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ad316add2f8540801fef2e2fbeec97139390a24b/gcc%2Fada%2Fmlib-tgt-specific-vms-alpha.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ad316add2f8540801fef2e2fbeec97139390a24b/gcc%2Fada%2Fmlib-tgt-specific-vms-alpha.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fmlib-tgt-specific-vms-alpha.adb?ref=ad316add2f8540801fef2e2fbeec97139390a24b", "patch": "@@ -276,29 +276,36 @@ package body MLib.Tgt.Specific is\n             --  Create and write the auto-init assembly file\n \n             declare\n-               First_Line : constant String :=\n-                              ASCII.HT & \".section LIB$INITIALIZE,GBL,NOWRT\" &\n-               ASCII.LF;\n-               Second_Line : constant String :=\n-                               ASCII.HT & \".long \" & Init_Proc & ASCII.LF;\n-               --  First and second lines of the auto-init assembly file\n+               use ASCII;\n+\n+               --  Output a dummy transfer address for debugging\n+               --  followed by the LIB$INITIALIZE section.\n+\n+               Lines : constant String :=\n+                 HT & \".text\" & LF &\n+                 HT & \".align 4\" & LF &\n+                 HT & \".globl __main\" & LF &\n+                 HT & \".ent __main\" & LF &\n+                 \"__main..en:\" & LF &\n+                 HT & \".base $27\" & LF &\n+                 HT & \".frame $29,0,$26,8\" & LF &\n+                 HT & \"ret $31,($26),1\" & LF &\n+                 HT & \".link\" & LF &\n+                 \"__main:\" & LF &\n+                 HT & \".pdesc __main..en,null\" & LF &\n+                 HT & \".end __main\" & LF & LF &\n+                 HT & \".section LIB$INITIALIZE,GBL,NOWRT\" & LF &\n+                 HT & \".long \" & Init_Proc & LF;\n \n             begin\n                Macro_File := Create_File (Macro_File_Name, Text);\n                OK := Macro_File /= Invalid_FD;\n \n                if OK then\n                   Len := Write\n-                    (Macro_File, First_Line (First_Line'First)'Address,\n-                     First_Line'Length);\n-                  OK := Len = First_Line'Length;\n-               end if;\n-\n-               if OK then\n-                  Len := Write\n-                    (Macro_File, Second_Line (Second_Line'First)'Address,\n-                     Second_Line'Length);\n-                  OK := Len = Second_Line'Length;\n+                    (Macro_File, Lines (Lines'First)'Address,\n+                     Lines'Length);\n+                  OK := Len = Lines'Length;\n                end if;\n \n                if OK then"}, {"sha": "ed483876be4bbd9b87026b865846d5e07fd0e1f8", "filename": "gcc/ada/mlib-tgt-specific-vms-ia64.adb", "status": "modified", "additions": 27, "deletions": 51, "changes": 78, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ad316add2f8540801fef2e2fbeec97139390a24b/gcc%2Fada%2Fmlib-tgt-specific-vms-ia64.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ad316add2f8540801fef2e2fbeec97139390a24b/gcc%2Fada%2Fmlib-tgt-specific-vms-ia64.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fmlib-tgt-specific-vms-ia64.adb?ref=ad316add2f8540801fef2e2fbeec97139390a24b", "patch": "@@ -275,64 +275,40 @@ package body MLib.Tgt.Specific is\n             --  Create and write the auto-init assembly file\n \n             declare\n-               First_Line  : constant String :=\n-                               ASCII.HT\n-                               & \".type \" & Init_Proc & \"#, @function\"\n-                               & ASCII.LF;\n-               Second_Line : constant String :=\n-                               ASCII.HT\n-                               & \".global \" & Init_Proc & \"#\"\n-                               & ASCII.LF;\n-               Third_Line  : constant String :=\n-                               ASCII.HT\n-                               & \".global LIB$INITIALIZE#\"\n-                               & ASCII.LF;\n-               Fourth_Line : constant String :=\n-                               ASCII.HT\n-                               & \".section LIB$INITIALIZE#,\"\"a\"\",@progbits\"\n-                               & ASCII.LF;\n-               Fifth_Line  : constant String :=\n-                               ASCII.HT\n-                               & \"data4 @fptr(\" & Init_Proc & \"#)\"\n-                               & ASCII.LF;\n+               use ASCII;\n+\n+               --  Output a dummy transfer address for debugging\n+               --  followed by the LIB$INITIALIZE section.\n+\n+               Lines : constant String :=\n+                 HT & \".pred.safe_across_calls p1-p5,p16-p63\" & LF &\n+                 HT & \".text\" & LF &\n+                 HT & \".align 16\" & LF &\n+                 HT & \".global __main#\" & LF &\n+                 HT & \".proc __main#\" & LF &\n+                      \"__main:\" & LF &\n+                 HT & \".prologue\" & LF &\n+                 HT & \".body\" & LF &\n+                 HT & \".mib\" & LF &\n+                 HT & \"nop 0\" & LF &\n+                 HT & \"nop 0\" & LF &\n+                 HT & \"br.ret.sptk.many b0\" & LF &\n+                 HT & \".endp __main#\" & LF & LF &\n+                 HT & \".type \" & Init_Proc & \"#, @function\" & LF &\n+                 HT & \".global \" & Init_Proc & \"#\" & LF &\n+                 HT & \".global LIB$INITIALIZE#\" & LF &\n+                 HT & \".section LIB$INITIALIZE#,\"\"a\"\",@progbits\" & LF &\n+                 HT & \"data4 @fptr(\" & Init_Proc & \"#)\" & LF;\n \n             begin\n                Macro_File := Create_File (Macro_File_Name, Text);\n                OK := Macro_File /= Invalid_FD;\n \n                if OK then\n                   Len := Write\n-                    (Macro_File, First_Line (First_Line'First)'Address,\n-                     First_Line'Length);\n-                  OK := Len = First_Line'Length;\n-               end if;\n-\n-               if OK then\n-                  Len := Write\n-                    (Macro_File, Second_Line (Second_Line'First)'Address,\n-                     Second_Line'Length);\n-                  OK := Len = Second_Line'Length;\n-               end if;\n-\n-               if OK then\n-                  Len := Write\n-                    (Macro_File, Third_Line (Third_Line'First)'Address,\n-                     Third_Line'Length);\n-                  OK := Len = Third_Line'Length;\n-               end if;\n-\n-               if OK then\n-                  Len := Write\n-                    (Macro_File, Fourth_Line (Fourth_Line'First)'Address,\n-                     Fourth_Line'Length);\n-                  OK := Len = Fourth_Line'Length;\n-               end if;\n-\n-               if OK then\n-                  Len := Write\n-                    (Macro_File, Fifth_Line (Fifth_Line'First)'Address,\n-                     Fifth_Line'Length);\n-                  OK := Len = Fifth_Line'Length;\n+                    (Macro_File, Lines (Lines'First)'Address,\n+                     Lines'Length);\n+                  OK := Len = Lines'Length;\n                end if;\n \n                if OK then"}]}