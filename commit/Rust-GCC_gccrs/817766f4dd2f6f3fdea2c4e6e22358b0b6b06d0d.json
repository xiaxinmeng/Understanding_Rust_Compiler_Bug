{"sha": "817766f4dd2f6f3fdea2c4e6e22358b0b6b06d0d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODE3NzY2ZjRkZDJmNmYzZmRlYTJjNGU2ZTIyMzU4YjBiNmIwNmQwZA==", "commit": {"author": {"name": "Luc Michel", "email": "lmichel@kalray.eu", "date": "2021-08-17T15:34:37Z"}, "committer": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2021-08-17T15:54:44Z"}, "message": "libstdc++: Fix testsuite for skipping gdb tests on remote/non-native target\n\nThis fixes an incorrect invocation of gdb on remote targets where\nDejaGNU would try to run host's gdb in remote target simulator.\ngdb-test skips the testing when target is remote or non native but the\ngdb version check function does not.\n\nSuggested-by: Jonathan Wakely <jwakely@redhat.com>\nSigned-off-by: Luc Michel <lmichel@kalray.eu>\n\nCo-authored-by: Marc Poulhies <mpoulhies@kalrayinc.com>\n\nlibstdc++-v3/ChangeLog:\n\n\t* testsuite/lib/gdb-test.exp (gdb_version_check)\n\t(gdb_version_check_xmethods): Only check the GDB version for\n\tlocal native targets.", "tree": {"sha": "6f61769a4f4f20b10f7a8122ca5b293b6ceaa63d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6f61769a4f4f20b10f7a8122ca5b293b6ceaa63d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/817766f4dd2f6f3fdea2c4e6e22358b0b6b06d0d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/817766f4dd2f6f3fdea2c4e6e22358b0b6b06d0d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/817766f4dd2f6f3fdea2c4e6e22358b0b6b06d0d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/817766f4dd2f6f3fdea2c4e6e22358b0b6b06d0d/comments", "author": {"login": "luc-mchl", "id": 91250356, "node_id": "MDQ6VXNlcjkxMjUwMzU2", "avatar_url": "https://avatars.githubusercontent.com/u/91250356?v=4", "gravatar_id": "", "url": "https://api.github.com/users/luc-mchl", "html_url": "https://github.com/luc-mchl", "followers_url": "https://api.github.com/users/luc-mchl/followers", "following_url": "https://api.github.com/users/luc-mchl/following{/other_user}", "gists_url": "https://api.github.com/users/luc-mchl/gists{/gist_id}", "starred_url": "https://api.github.com/users/luc-mchl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/luc-mchl/subscriptions", "organizations_url": "https://api.github.com/users/luc-mchl/orgs", "repos_url": "https://api.github.com/users/luc-mchl/repos", "events_url": "https://api.github.com/users/luc-mchl/events{/privacy}", "received_events_url": "https://api.github.com/users/luc-mchl/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "174f9257a75dec93221eca26c236e0a6346c9dfd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/174f9257a75dec93221eca26c236e0a6346c9dfd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/174f9257a75dec93221eca26c236e0a6346c9dfd"}], "stats": {"total": 4, "additions": 4, "deletions": 0}, "files": [{"sha": "f993355c2b416485c21cac29b75df7588b975475", "filename": "libstdc++-v3/testsuite/lib/gdb-test.exp", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/817766f4dd2f6f3fdea2c4e6e22358b0b6b06d0d/libstdc%2B%2B-v3%2Ftestsuite%2Flib%2Fgdb-test.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/817766f4dd2f6f3fdea2c4e6e22358b0b6b06d0d/libstdc%2B%2B-v3%2Ftestsuite%2Flib%2Fgdb-test.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2Flib%2Fgdb-test.exp?ref=817766f4dd2f6f3fdea2c4e6e22358b0b6b06d0d", "patch": "@@ -280,6 +280,8 @@ proc gdb_batch_check {command pattern} {\n # but not earlier versions.\n # Return 1 if the version is ok, 0 otherwise.\n proc gdb_version_check {} {\n+    if { ![isnative] || [is_remote target] } { return 0 }\n+\n     return [gdb_batch_check \"python print(gdb.lookup_global_symbol)\" \\\n \t      \"<built-in function lookup_global_symbol>\"]\n }\n@@ -288,6 +290,8 @@ proc gdb_version_check {} {\n # in a manner similar to the check for a version of gdb which supports the\n # pretty-printer tests below.\n proc gdb_version_check_xmethods {} {\n+    if { ![isnative] || [is_remote target] } { return 0 }\n+\n     return [gdb_batch_check \\\n \t      \"python import gdb.xmethod; print(gdb.xmethod.XMethod)\" \\\n \t      \"<class 'gdb\\\\.xmethod\\\\.XMethod'>\"]"}]}