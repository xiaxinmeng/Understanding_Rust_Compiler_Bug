{"sha": "b8c73637a42f0f686fbc4e392d2718151dd2bd9e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjhjNzM2MzdhNDJmMGY2ODZmYmM0ZTM5MmQyNzE4MTUxZGQyYmQ5ZQ==", "commit": {"author": {"name": "Michael Matz", "email": "matz@suse.de", "date": "2010-11-21T07:56:12Z"}, "committer": {"name": "Tobias Burnus", "email": "burnus@gcc.gnu.org", "date": "2010-11-21T07:56:12Z"}, "message": "re PR driver/46516 (Non-multilib search problem in gcc.c / gfortran error: libgfortran.spec: No such file or directory)\n\n2010-11-21  Michael Matz  <matz@suse.de>\n            Tobias Burnus  <burnus@net-b.de>\n\n        PR driver/46516\n        * gfortranspec.c (lang_specific_driver,\n        lang_specific_pre_link): Load libgfortran.spec in\n        lang_specific_pre_link unless found in the -L path.\n\n\nCo-Authored-By: Tobias Burnus <burnus@net-b.de>\n\nFrom-SVN: r166998", "tree": {"sha": "84bb95306f015ba30218e3f37350445b695b56ef", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/84bb95306f015ba30218e3f37350445b695b56ef"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b8c73637a42f0f686fbc4e392d2718151dd2bd9e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b8c73637a42f0f686fbc4e392d2718151dd2bd9e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b8c73637a42f0f686fbc4e392d2718151dd2bd9e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b8c73637a42f0f686fbc4e392d2718151dd2bd9e/comments", "author": {"login": "susematz", "id": 4117296, "node_id": "MDQ6VXNlcjQxMTcyOTY=", "avatar_url": "https://avatars.githubusercontent.com/u/4117296?v=4", "gravatar_id": "", "url": "https://api.github.com/users/susematz", "html_url": "https://github.com/susematz", "followers_url": "https://api.github.com/users/susematz/followers", "following_url": "https://api.github.com/users/susematz/following{/other_user}", "gists_url": "https://api.github.com/users/susematz/gists{/gist_id}", "starred_url": "https://api.github.com/users/susematz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/susematz/subscriptions", "organizations_url": "https://api.github.com/users/susematz/orgs", "repos_url": "https://api.github.com/users/susematz/repos", "events_url": "https://api.github.com/users/susematz/events{/privacy}", "received_events_url": "https://api.github.com/users/susematz/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "8812e4d5dd6f5ff0cac16c22bfe41986d92cb959", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8812e4d5dd6f5ff0cac16c22bfe41986d92cb959", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8812e4d5dd6f5ff0cac16c22bfe41986d92cb959"}], "stats": {"total": 28, "additions": 21, "deletions": 7}, "files": [{"sha": "db4380f7795be53a88cd0add263fb54a3da996b0", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b8c73637a42f0f686fbc4e392d2718151dd2bd9e/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b8c73637a42f0f686fbc4e392d2718151dd2bd9e/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=b8c73637a42f0f686fbc4e392d2718151dd2bd9e", "patch": "@@ -1,3 +1,11 @@\n+2010-11-21  Michael Matz  <matz@suse.de>\n+\t    Tobias Burnus  <burnus@net-b.de>\n+\n+\tPR driver/46516\n+\t* gfortranspec.c (lang_specific_driver,\n+\tlang_specific_pre_link): Load libgfortran.spec in\n+\tlang_specific_pre_link unless found in the -L path.\n+\n 2010-11-20  Janne Blomqvist  <jb@gcc.gnu.org>\n \n \t* f95-lang.c (gfc_init_decl_processing): Set size_type_node as"}, {"sha": "d8d9fc24075a5ff563f7a9b59701782b0ee9573e", "filename": "gcc/fortran/gfortranspec.c", "status": "modified", "additions": 13, "deletions": 7, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b8c73637a42f0f686fbc4e392d2718151dd2bd9e/gcc%2Ffortran%2Fgfortranspec.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b8c73637a42f0f686fbc4e392d2718151dd2bd9e/gcc%2Ffortran%2Fgfortranspec.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fgfortranspec.c?ref=b8c73637a42f0f686fbc4e392d2718151dd2bd9e", "patch": "@@ -75,6 +75,9 @@ static void append_arg (const struct cl_decoded_option *);\n static unsigned int g77_newargc;\n static struct cl_decoded_option *g77_new_decoded_options;\n \n+/* The path to the spec file.  */\n+char *spec_file = NULL;\n+\n \n /* Return full path name of spec file if it is in DIR, or NULL if\n    not.  */\n@@ -223,9 +226,6 @@ lang_specific_driver (struct cl_decoded_option **in_decoded_options,\n   /* Whether we should link a static libgfortran. */\n   int static_lib = 0; \n \n-  /* The path to the spec file.  */\n-  char *spec_file = NULL;\n-\n   /* Whether we need to link statically.  */\n   int static_linking = 0;\n \n@@ -447,9 +447,10 @@ For more information about these matters, see the file named COPYING\\n\\n\"));\n #endif\n \n   /* Read the specs file corresponding to libgfortran.\n-     If we didn't find the spec file on the -L path, then we hope it\n-     is somewhere in the standard install areas.  */\n-  append_option (OPT_specs_, spec_file == NULL ? SPEC_FILE : spec_file, 1);\n+     If we didn't find the spec file on the -L path, we load it\n+     via lang_specific_pre_link.  */\n+  if (spec_file)\n+    append_option (OPT_specs_, spec_file, 1);\n \n   if (verbose && g77_new_decoded_options != g77_x_decoded_options)\n     {\n@@ -467,8 +468,13 @@ For more information about these matters, see the file named COPYING\\n\\n\"));\n \n /* Called before linking.  Returns 0 on success and -1 on failure.  */\n int\n-lang_specific_pre_link (void)\t/* Not used for F77.  */\n+lang_specific_pre_link (void)\n {\n+  if (spec_file)\n+    free (spec_file);\n+  else\n+    do_spec (\"%:include(libgfortran.spec)\");\n+\n   return 0;\n }\n "}]}