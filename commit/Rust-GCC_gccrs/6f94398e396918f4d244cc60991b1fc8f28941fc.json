{"sha": "6f94398e396918f4d244cc60991b1fc8f28941fc", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NmY5NDM5OGUzOTY5MThmNGQyNDRjYzYwOTkxYjFmYzhmMjg5NDFmYw==", "commit": {"author": {"name": "Paolo Carlini", "email": "paolo.carlini@oracle.com", "date": "2011-09-28T22:04:48Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2011-09-28T22:04:48Z"}, "message": "re PR c++/45278 (-Wextra doesn't warn about (pointer < 0 ).)\n\n/cp\n2011-09-28  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/45278\n\t* typeck.c (cp_build_binary_op): With -Wextra, warn for ordered\n\tcomparison of pointer with zero.\n\n/testsuite\n2011-09-28  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/45278\n\t* g++.dg/warn/Wextra-3.C: New.\n\nFrom-SVN: r179321", "tree": {"sha": "7288113c3410ad7be6e2e1844c8ca4e76f8cbb26", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7288113c3410ad7be6e2e1844c8ca4e76f8cbb26"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6f94398e396918f4d244cc60991b1fc8f28941fc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6f94398e396918f4d244cc60991b1fc8f28941fc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6f94398e396918f4d244cc60991b1fc8f28941fc", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6f94398e396918f4d244cc60991b1fc8f28941fc/comments", "author": null, "committer": null, "parents": [{"sha": "39f2bcb5e15aa41a156ac55a0466aa3bb82bc327", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/39f2bcb5e15aa41a156ac55a0466aa3bb82bc327", "html_url": "https://github.com/Rust-GCC/gccrs/commit/39f2bcb5e15aa41a156ac55a0466aa3bb82bc327"}], "stats": {"total": 34, "additions": 32, "deletions": 2}, "files": [{"sha": "68e702fe8cf1dc3b9b7d20fd3c467f01cf16f0b9", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6f94398e396918f4d244cc60991b1fc8f28941fc/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6f94398e396918f4d244cc60991b1fc8f28941fc/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=6f94398e396918f4d244cc60991b1fc8f28941fc", "patch": "@@ -1,3 +1,9 @@\n+2011-09-28  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/45278\n+\t* typeck.c (cp_build_binary_op): With -Wextra, warn for ordered\n+\tcomparison of pointer with zero.\n+\n 2011-09-27  Paolo Carlini  <paolo.carlini@oracle.com>\n \n \tPR c++/31489"}, {"sha": "d416b42db3b0a9f4698705b11220937934bc62ca", "filename": "gcc/cp/typeck.c", "status": "modified", "additions": 12, "deletions": 2, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6f94398e396918f4d244cc60991b1fc8f28941fc/gcc%2Fcp%2Ftypeck.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6f94398e396918f4d244cc60991b1fc8f28941fc/gcc%2Fcp%2Ftypeck.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ftypeck.c?ref=6f94398e396918f4d244cc60991b1fc8f28941fc", "patch": "@@ -4189,9 +4189,19 @@ cp_build_binary_op (location_t location,\n \tresult_type = composite_pointer_type (type0, type1, op0, op1,\n \t\t\t\t\t      CPO_COMPARISON, complain);\n       else if (code0 == POINTER_TYPE && null_ptr_cst_p (op1))\n-\tresult_type = type0;\n+\t{\n+\t  result_type = type0;\n+\t  if (extra_warnings && (complain & tf_warning))\n+\t    warning (OPT_Wextra,\n+\t\t     \"ordered comparison of pointer with integer zero\");\n+\t}\n       else if (code1 == POINTER_TYPE && null_ptr_cst_p (op0))\n-\tresult_type = type1;\n+\t{\n+\t  result_type = type1;\n+\t  if (extra_warnings && (complain & tf_warning))\n+\t    warning (OPT_Wextra,\n+\t\t     \"ordered comparison of pointer with integer zero\");\n+\t}\n       else if (null_ptr_cst_p (op0) && null_ptr_cst_p (op1))\n \t/* One of the operands must be of nullptr_t type.  */\n         result_type = TREE_TYPE (nullptr_node);"}, {"sha": "ea1cad512019ee906870a0a060448f9900613549", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6f94398e396918f4d244cc60991b1fc8f28941fc/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6f94398e396918f4d244cc60991b1fc8f28941fc/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=6f94398e396918f4d244cc60991b1fc8f28941fc", "patch": "@@ -1,3 +1,8 @@\n+2011-09-28  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/45278\n+\t* g++.dg/warn/Wextra-3.C: New.\n+\n 2011-09-28  Oleg Endo  <oleg.endo@t-online.de>\n \n \tPR target/49486"}, {"sha": "04fdbba9076fd303650f9e79cbe571c9060b79f1", "filename": "gcc/testsuite/g++.dg/warn/Wextra-3.C", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6f94398e396918f4d244cc60991b1fc8f28941fc/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWextra-3.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6f94398e396918f4d244cc60991b1fc8f28941fc/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWextra-3.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWextra-3.C?ref=6f94398e396918f4d244cc60991b1fc8f28941fc", "patch": "@@ -0,0 +1,9 @@\n+// PR c++/45278\n+// { dg-options \"-Wextra\" } \n+\n+extern void* p;\n+\n+int f1() { return ( p <  0 ? 1 : 0 ); } // { dg-warning \"ordered comparison\" }\n+int f2() { return ( p <= 0 ? 1 : 0 ); } // { dg-warning \"ordered comparison\" }\n+int f3() { return ( p >  0 ? 1 : 0 ); } // { dg-warning \"ordered comparison\" }\n+int f4() { return ( p >= 0 ? 1 : 0 ); } // { dg-warning \"ordered comparison\" }"}]}