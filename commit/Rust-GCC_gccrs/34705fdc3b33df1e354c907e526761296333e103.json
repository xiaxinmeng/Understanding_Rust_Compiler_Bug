{"sha": "34705fdc3b33df1e354c907e526761296333e103", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzQ3MDVmZGMzYjMzZGYxZTM1NGM5MDdlNTI2NzYxMjk2MzMzZTEwMw==", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2017-11-17T13:36:37Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2017-11-17T13:36:37Z"}, "message": "re PR fortran/83017 (DO CONCURRENT not parallelizing)\n\n2017-11-17  Richard Biener  <rguenther@suse.de>\n\n\tPR fortran/83017\n\t* tree-core.h (enum annot_expr_kind): Add annot_expr_parallel_kind.\n\t* tree-pretty-print.c (dump_generic_node): Handle\n\tannot_expr_parallel_kind.\n\t* tree-cfg.c (replace_loop_annotate_in_block): Likewise.\n\t* gimplify.c (gimple_boolify): Likewise.\n\n\tfortran/\n\t* trans-stmt.c (gfc_trans_forall_loop): Annotate DO CONCURRENT\n\tloops with annot_expr_parallel_kind instead of just\n\tannot_expr_ivdep_kind.\n\nFrom-SVN: r254869", "tree": {"sha": "34285f4410f9daa4859939f8013b770975840418", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/34285f4410f9daa4859939f8013b770975840418"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/34705fdc3b33df1e354c907e526761296333e103", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/34705fdc3b33df1e354c907e526761296333e103", "html_url": "https://github.com/Rust-GCC/gccrs/commit/34705fdc3b33df1e354c907e526761296333e103", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/34705fdc3b33df1e354c907e526761296333e103/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "1ecae1fc238a6b02b3cc2de6a24d73966bc45a03", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1ecae1fc238a6b02b3cc2de6a24d73966bc45a03", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1ecae1fc238a6b02b3cc2de6a24d73966bc45a03"}], "stats": {"total": 27, "additions": 26, "deletions": 1}, "files": [{"sha": "993ac9bba249bb62ed04dd1e85437ae5228a092e", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/34705fdc3b33df1e354c907e526761296333e103/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/34705fdc3b33df1e354c907e526761296333e103/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=34705fdc3b33df1e354c907e526761296333e103", "patch": "@@ -1,3 +1,12 @@\n+2017-11-17  Richard Biener  <rguenther@suse.de>\n+\n+\tPR fortran/83017\n+\t* tree-core.h (enum annot_expr_kind): Add annot_expr_parallel_kind.\n+\t* tree-pretty-print.c (dump_generic_node): Handle\n+\tannot_expr_parallel_kind.\n+\t* tree-cfg.c (replace_loop_annotate_in_block): Likewise.\n+\t* gimplify.c (gimple_boolify): Likewise.\n+\n 2017-11-17  Igor Tsimbalist  <igor.v.tsimbalist@intel.com>\n \n \t* config.gcc (extra_headers): Add cet.h for x86 targets."}, {"sha": "cd72b1cf0c3fb2ed060d4de40636d51727d436f1", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/34705fdc3b33df1e354c907e526761296333e103/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/34705fdc3b33df1e354c907e526761296333e103/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=34705fdc3b33df1e354c907e526761296333e103", "patch": "@@ -1,3 +1,10 @@\n+2017-11-17  Richard Biener  <rguenther@suse.de>\n+\n+\tPR fortran/83017\n+\t* trans-stmt.c (gfc_trans_forall_loop): Annotate DO CONCURRENT\n+\tloops with annot_expr_parallel_kind instead of just\n+\tannot_expr_ivdep_kind.\n+\n 2017-11-15  Martin Liska  <mliska@suse.cz>\n \n \t* options.c (gfc_post_options):"}, {"sha": "a89751bfd79aaecee5073886f44d9b04049af110", "filename": "gcc/fortran/trans-stmt.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/34705fdc3b33df1e354c907e526761296333e103/gcc%2Ffortran%2Ftrans-stmt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/34705fdc3b33df1e354c907e526761296333e103/gcc%2Ffortran%2Ftrans-stmt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-stmt.c?ref=34705fdc3b33df1e354c907e526761296333e103", "patch": "@@ -3455,7 +3455,7 @@ gfc_trans_forall_loop (forall_info *forall_tmp, tree body,\n       if (forall_tmp->do_concurrent)\n \tcond = build2 (ANNOTATE_EXPR, TREE_TYPE (cond), cond,\n \t\t       build_int_cst (integer_type_node,\n-\t\t\t\t      annot_expr_ivdep_kind));\n+\t\t\t\t      annot_expr_parallel_kind));\n \n       tmp = build1_v (GOTO_EXPR, exit_label);\n       tmp = fold_build3_loc (input_location, COND_EXPR, void_type_node,"}, {"sha": "d71bd2ab01ecba77e899fd446e8fb4484e8c129b", "filename": "gcc/gimplify.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/34705fdc3b33df1e354c907e526761296333e103/gcc%2Fgimplify.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/34705fdc3b33df1e354c907e526761296333e103/gcc%2Fgimplify.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgimplify.c?ref=34705fdc3b33df1e354c907e526761296333e103", "patch": "@@ -3749,6 +3749,7 @@ gimple_boolify (tree expr)\n \tcase annot_expr_ivdep_kind:\n \tcase annot_expr_no_vector_kind:\n \tcase annot_expr_vector_kind:\n+\tcase annot_expr_parallel_kind:\n \t  TREE_OPERAND (expr, 0) = gimple_boolify (TREE_OPERAND (expr, 0));\n \t  if (TREE_CODE (type) != BOOLEAN_TYPE)\n \t    TREE_TYPE (expr) = boolean_type_node;"}, {"sha": "f44855024a32654821bda7507688a62498de54c3", "filename": "gcc/tree-cfg.c", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/34705fdc3b33df1e354c907e526761296333e103/gcc%2Ftree-cfg.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/34705fdc3b33df1e354c907e526761296333e103/gcc%2Ftree-cfg.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-cfg.c?ref=34705fdc3b33df1e354c907e526761296333e103", "patch": "@@ -287,6 +287,10 @@ replace_loop_annotate_in_block (basic_block bb, struct loop *loop)\n \t  loop->force_vectorize = true;\n \t  cfun->has_force_vectorize_loops = true;\n \t  break;\n+\tcase annot_expr_parallel_kind:\n+\t  loop->can_be_parallel = true;\n+\t  loop->safelen = INT_MAX;\n+\t  break;\n \tdefault:\n \t  gcc_unreachable ();\n \t}"}, {"sha": "aa54221253c2d760dda5e3b1bbb910b840fdfc2e", "filename": "gcc/tree-core.h", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/34705fdc3b33df1e354c907e526761296333e103/gcc%2Ftree-core.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/34705fdc3b33df1e354c907e526761296333e103/gcc%2Ftree-core.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-core.h?ref=34705fdc3b33df1e354c907e526761296333e103", "patch": "@@ -853,6 +853,7 @@ enum annot_expr_kind {\n   annot_expr_ivdep_kind,\n   annot_expr_no_vector_kind,\n   annot_expr_vector_kind,\n+  annot_expr_parallel_kind,\n   annot_expr_kind_last\n };\n "}, {"sha": "169f9724eb1ae1f59572a1fe99f6a3ac62deea19", "filename": "gcc/tree-pretty-print.c", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/34705fdc3b33df1e354c907e526761296333e103/gcc%2Ftree-pretty-print.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/34705fdc3b33df1e354c907e526761296333e103/gcc%2Ftree-pretty-print.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-pretty-print.c?ref=34705fdc3b33df1e354c907e526761296333e103", "patch": "@@ -2638,6 +2638,9 @@ dump_generic_node (pretty_printer *pp, tree node, int spc, dump_flags_t flags,\n \tcase annot_expr_vector_kind:\n \t  pp_string (pp, \", vector\");\n \t  break;\n+\tcase annot_expr_parallel_kind:\n+\t  pp_string (pp, \", parallel\");\n+\t  break;\n \tdefault:\n \t  gcc_unreachable ();\n \t}"}]}