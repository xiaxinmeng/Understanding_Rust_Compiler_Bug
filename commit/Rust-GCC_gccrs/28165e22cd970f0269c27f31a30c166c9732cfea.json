{"sha": "28165e22cd970f0269c27f31a30c166c9732cfea", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjgxNjVlMjJjZDk3MGYwMjY5YzI3ZjMxYTMwYzE2NmM5NzMyY2ZlYQ==", "commit": {"author": {"name": "Richard Earnshaw", "email": "rearnsha@arm.com", "date": "2002-09-28T12:09:27Z"}, "committer": {"name": "Richard Earnshaw", "email": "rearnsha@gcc.gnu.org", "date": "2002-09-28T12:09:27Z"}, "message": "sysv.S: If we don't have machine/asm.h and the pre-processor has defined...\n\n* src/arm/sysv.S: If we don't have machine/asm.h and the pre-processor\nhas defined __USER_LABEL_PREFIX__, then use it in CNAME.\n(ffi_call_SYSV): Handle soft-float.\n\nFrom-SVN: r57609", "tree": {"sha": "9dfeceaf76350703dcfa91f04a9a3fa96e53beb9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9dfeceaf76350703dcfa91f04a9a3fa96e53beb9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/28165e22cd970f0269c27f31a30c166c9732cfea", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/28165e22cd970f0269c27f31a30c166c9732cfea", "html_url": "https://github.com/Rust-GCC/gccrs/commit/28165e22cd970f0269c27f31a30c166c9732cfea", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/28165e22cd970f0269c27f31a30c166c9732cfea/comments", "author": null, "committer": null, "parents": [{"sha": "fb3d26dc12f31470f70812d0abfd135db09ef59a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fb3d26dc12f31470f70812d0abfd135db09ef59a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fb3d26dc12f31470f70812d0abfd135db09ef59a"}], "stats": {"total": 21, "additions": 21, "deletions": 0}, "files": [{"sha": "365a1043b9964494e46912c457a58cac1c139646", "filename": "libffi/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/28165e22cd970f0269c27f31a30c166c9732cfea/libffi%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/28165e22cd970f0269c27f31a30c166c9732cfea/libffi%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2FChangeLog?ref=28165e22cd970f0269c27f31a30c166c9732cfea", "patch": "@@ -1,3 +1,9 @@\n+2002-09-28  Richard Earnshaw  <rearnsha@arm.com>\n+\n+\t* src/arm/sysv.S: If we don't have machine/asm.h and the pre-processor\n+\thas defined __USER_LABEL_PREFIX__, then use it in CNAME.\n+\t(ffi_call_SYSV): Handle soft-float.\n+\n 2002-09-27  Bo Thorsen  <bo@suse.de>\n \n \t* include/ffi.h.in: Fix multilib x86-64 support."}, {"sha": "a494a2ffebfda191c836327b2221e287680bf293", "filename": "libffi/src/arm/sysv.S", "status": "modified", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/28165e22cd970f0269c27f31a30c166c9732cfea/libffi%2Fsrc%2Farm%2Fsysv.S", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/28165e22cd970f0269c27f31a30c166c9732cfea/libffi%2Fsrc%2Farm%2Fsysv.S", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2Fsrc%2Farm%2Fsysv.S?ref=28165e22cd970f0269c27f31a30c166c9732cfea", "patch": "@@ -28,6 +28,13 @@\n #ifdef HAVE_MACHINE_ASM_H\n #include <machine/asm.h>\n #else\n+#ifdef __USER_LABEL_PREFIX__\n+#define CONCAT1(a, b) CONCAT2(a, b)\n+#define CONCAT2(a, b) a ## b\n+\n+/* Use the right prefix for global labels.  */\n+#define CNAME(x) CONCAT1 (__USER_LABEL_PREFIX__, x)\n+#else\n /* XXX these lose for some platforms, I'm sure. */\n #define CNAME(x) x\n #define ENTRY(x) .globl CNAME(x); .type CNAME(x),%function; CNAME(x):\n@@ -96,12 +103,20 @@ ENTRY(ffi_call_SYSV)\n \n # return FLOAT\n \tcmp     a4, #FFI_TYPE_FLOAT\n+#ifdef __SOFTFP__\n+\tstreq\ta1, [a3]\n+#else\n \tstfeqs  f0, [a3]\n+#endif\n \tbeq     epilogue\n \n # return DOUBLE or LONGDOUBLE\n \tcmp     a4, #FFI_TYPE_DOUBLE\n+#ifdef __SOFTFP__\n+\tstmeqia\ta3, {a1, a2}\n+#else\n \tstfeqd  f0, [a3]\n+#endif\n \n epilogue:\n         ldmfd sp!, {a1-a4, fp, pc}"}]}