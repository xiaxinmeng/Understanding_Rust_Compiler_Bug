{"sha": "17972da719db3ced8d90b01beed66b597f07f806", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTc5NzJkYTcxOWRiM2NlZDhkOTBiMDFiZWVkNjZiNTk3ZjA3ZjgwNg==", "commit": {"author": {"name": "Samuel Tardieu", "email": "sam@rfc1149.net", "date": "2008-04-14T12:08:31Z"}, "committer": {"name": "Samuel Tardieu", "email": "sam@gcc.gnu.org", "date": "2008-04-14T12:08:31Z"}, "message": "sem_util.ads, [...] (In_Subprogram): New function.\n\n    gcc/ada/\n\t* sem_util.ads, sem_util.adb (In_Subprogram): New function.\n\t* sem_attr.adb (Analyze_Attribute, Attribute_Old case): Use it.\n\n    gcc/testsuite/\n\t* gnat.dg/deep_old.adb: New.\n\nFrom-SVN: r134260", "tree": {"sha": "c41b3f7f63d76e906c54bbe9a251a6d3ed8f6c3a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c41b3f7f63d76e906c54bbe9a251a6d3ed8f6c3a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/17972da719db3ced8d90b01beed66b597f07f806", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/17972da719db3ced8d90b01beed66b597f07f806", "html_url": "https://github.com/Rust-GCC/gccrs/commit/17972da719db3ced8d90b01beed66b597f07f806", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/17972da719db3ced8d90b01beed66b597f07f806/comments", "author": {"login": "samueltardieu", "id": 44656, "node_id": "MDQ6VXNlcjQ0NjU2", "avatar_url": "https://avatars.githubusercontent.com/u/44656?v=4", "gravatar_id": "", "url": "https://api.github.com/users/samueltardieu", "html_url": "https://github.com/samueltardieu", "followers_url": "https://api.github.com/users/samueltardieu/followers", "following_url": "https://api.github.com/users/samueltardieu/following{/other_user}", "gists_url": "https://api.github.com/users/samueltardieu/gists{/gist_id}", "starred_url": "https://api.github.com/users/samueltardieu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/samueltardieu/subscriptions", "organizations_url": "https://api.github.com/users/samueltardieu/orgs", "repos_url": "https://api.github.com/users/samueltardieu/repos", "events_url": "https://api.github.com/users/samueltardieu/events{/privacy}", "received_events_url": "https://api.github.com/users/samueltardieu/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "e965b4534fb33510b35640bcc36873d398817374", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e965b4534fb33510b35640bcc36873d398817374", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e965b4534fb33510b35640bcc36873d398817374"}], "stats": {"total": 34, "additions": 33, "deletions": 1}, "files": [{"sha": "848beee0598ada69aab1c069d99e3e2d244cf5b0", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/17972da719db3ced8d90b01beed66b597f07f806/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/17972da719db3ced8d90b01beed66b597f07f806/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=17972da719db3ced8d90b01beed66b597f07f806", "patch": "@@ -1,3 +1,8 @@\n+2008-04-14  Samuel Tardieu  <sam@rfc1149.net>\n+\n+\t* sem_util.ads, sem_util.adb (In_Subprogram): New function.\n+\t* sem_attr.adb (Analyze_Attribute, Attribute_Old case): Use it.\n+\n 2008-04-14  Rolf Ebert  <rolf.ebert.gcc@gmx.de>\n \n \tPR ada/20822"}, {"sha": "ed52023e716f724df8abf7517e24b155aaa8685a", "filename": "gcc/ada/sem_attr.adb", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/17972da719db3ced8d90b01beed66b597f07f806/gcc%2Fada%2Fsem_attr.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/17972da719db3ced8d90b01beed66b597f07f806/gcc%2Fada%2Fsem_attr.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_attr.adb?ref=17972da719db3ced8d90b01beed66b597f07f806", "patch": "@@ -3472,7 +3472,7 @@ package body Sem_Attr is\n          Check_E0;\n          Set_Etype (N, P_Type);\n \n-         if not Is_Subprogram (Current_Scope) then\n+         if not In_Subprogram then\n             Error_Attr (\"attribute % can only appear within subprogram\", N);\n          end if;\n "}, {"sha": "3d5aa776e893c2174573d12148569f8d5174f865", "filename": "gcc/ada/sem_util.adb", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/17972da719db3ced8d90b01beed66b597f07f806/gcc%2Fada%2Fsem_util.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/17972da719db3ced8d90b01beed66b597f07f806/gcc%2Fada%2Fsem_util.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_util.adb?ref=17972da719db3ced8d90b01beed66b597f07f806", "patch": "@@ -5365,6 +5365,15 @@ package body Sem_Util is\n       return False;\n    end In_Package_Body;\n \n+   -------------------\n+   -- In_Subprogram --\n+   -------------------\n+\n+   function In_Subprogram return Boolean is\n+   begin\n+      return Current_Subprogram /= Empty;\n+   end In_Subprogram;\n+\n    --------------------------------------\n    -- In_Subprogram_Or_Concurrent_Unit --\n    --------------------------------------"}, {"sha": "d8c0b17e8d7e8ec78767fa5a8e4b7ca7aa5a0f97", "filename": "gcc/ada/sem_util.ads", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/17972da719db3ced8d90b01beed66b597f07f806/gcc%2Fada%2Fsem_util.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/17972da719db3ced8d90b01beed66b597f07f806/gcc%2Fada%2Fsem_util.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_util.ads?ref=17972da719db3ced8d90b01beed66b597f07f806", "patch": "@@ -587,6 +587,12 @@ package Sem_Util is\n    function In_Package_Body return Boolean;\n    --  Returns True if current scope is within a package body\n \n+   function In_Subprogram return Boolean;\n+   --  Determines if the current scope is within a subprogram compilation\n+   --  unit (inside a subprogram declaration, subprogram body, or generic\n+   --  subprogram declaration). The test is for appearing anywhere within\n+   --  such a construct (that is it does not need to be directly within).\n+\n    function In_Subprogram_Or_Concurrent_Unit return Boolean;\n    --  Determines if the current scope is within a subprogram compilation\n    --  unit (inside a subprogram declaration, subprogram body, or generic"}, {"sha": "97d0dc701b14ae821d8d62508d0ad82f64db3202", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/17972da719db3ced8d90b01beed66b597f07f806/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/17972da719db3ced8d90b01beed66b597f07f806/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=17972da719db3ced8d90b01beed66b597f07f806", "patch": "@@ -1,3 +1,7 @@\n+2008-04-14  Samuel Tardieu  <sam@rfc1149.net>\n+\n+\t* gnat.dg/deep_old.adb: New.\n+\n 2008-04-14  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* gnat.dg/loop_address2.adb: New test."}, {"sha": "6aca027f4acf0463bd97f7afc3bcbe8bcf6df427", "filename": "gcc/testsuite/gnat.dg/deep_old.adb", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/17972da719db3ced8d90b01beed66b597f07f806/gcc%2Ftestsuite%2Fgnat.dg%2Fdeep_old.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/17972da719db3ced8d90b01beed66b597f07f806/gcc%2Ftestsuite%2Fgnat.dg%2Fdeep_old.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fdeep_old.adb?ref=17972da719db3ced8d90b01beed66b597f07f806", "patch": "@@ -0,0 +1,8 @@\n+procedure Deep_Old (X : Integer) is\n+begin\n+   begin\n+      if X = X'Old then\n+         null;\n+      end if;\n+   end;\n+end Deep_Old;"}]}