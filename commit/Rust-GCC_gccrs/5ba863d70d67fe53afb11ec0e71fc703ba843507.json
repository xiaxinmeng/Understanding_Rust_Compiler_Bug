{"sha": "5ba863d70d67fe53afb11ec0e71fc703ba843507", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NWJhODYzZDcwZDY3ZmU1M2FmYjExZWMwZTcxZmM3MDNiYTg0MzUwNw==", "commit": {"author": {"name": "DJ Delorie", "email": "dj@redhat.com", "date": "2009-09-11T01:06:36Z"}, "committer": {"name": "DJ Delorie", "email": "dj@gcc.gnu.org", "date": "2009-09-11T01:06:36Z"}, "message": "mep.md (eh_epilogue): Defer until after epilogue is emitted.\n\n* config/mep/mep.md (eh_epilogue): Defer until after epilogue is\nemitted.\n\n* config/mep/mep.h (LEGITIMATE_CONSTANT_P): New.\n* config/mep/mep.c (mep_legitimate_constant_p): New.\n* config/mep/mep-protos.h: Prototype it.\n\nFrom-SVN: r151625", "tree": {"sha": "b69489c02c52fc31e99819ea360ac4da2d3024ea", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b69489c02c52fc31e99819ea360ac4da2d3024ea"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5ba863d70d67fe53afb11ec0e71fc703ba843507", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5ba863d70d67fe53afb11ec0e71fc703ba843507", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5ba863d70d67fe53afb11ec0e71fc703ba843507", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5ba863d70d67fe53afb11ec0e71fc703ba843507/comments", "author": null, "committer": null, "parents": [{"sha": "24f7037972cbedeeea8b3629245ba7ef2117c297", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/24f7037972cbedeeea8b3629245ba7ef2117c297", "html_url": "https://github.com/Rust-GCC/gccrs/commit/24f7037972cbedeeea8b3629245ba7ef2117c297"}], "stats": {"total": 29, "additions": 27, "deletions": 2}, "files": [{"sha": "64b946a4a1b850085be2ae5d8914c38e0dd4e681", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5ba863d70d67fe53afb11ec0e71fc703ba843507/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5ba863d70d67fe53afb11ec0e71fc703ba843507/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=5ba863d70d67fe53afb11ec0e71fc703ba843507", "patch": "@@ -1,3 +1,12 @@\n+2009-09-10  DJ Delorie  <dj@redhat.com>\n+\n+\t* config/mep/mep.md (eh_epilogue): Defer until after epilogue is\n+\temitted.\n+\n+\t* config/mep/mep.h (LEGITIMATE_CONSTANT_P): New.\n+\t* config/mep/mep.c (mep_legitimate_constant_p): New.\n+\t* config/mep/mep-protos.h: Prototype it.\n+\n 2009-09-10  Richard Henderson  <rth@redhat.com>\n \n \t* print-rtl.c (print_rtx): Fix JUMP_LABEL index."}, {"sha": "e53ca79639c1f87a9e6520d1f1a71222ae9e12b8", "filename": "gcc/config/mep/mep-protos.h", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5ba863d70d67fe53afb11ec0e71fc703ba843507/gcc%2Fconfig%2Fmep%2Fmep-protos.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5ba863d70d67fe53afb11ec0e71fc703ba843507/gcc%2Fconfig%2Fmep%2Fmep-protos.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmep%2Fmep-protos.h?ref=5ba863d70d67fe53afb11ec0e71fc703ba843507", "patch": "@@ -48,6 +48,7 @@ extern void mep_split_wide_move (rtx *, enum machine_mode);\n #ifdef RTX_CODE\n extern bool mep_expand_setcc (rtx *);\n extern rtx mep_expand_cbranch (rtx *);\n+extern bool mep_legitimate_constant_p (rtx);\n #endif\n extern const char *mep_emit_cbranch (rtx *, int);\n extern void mep_expand_call (rtx *, int);"}, {"sha": "6ff6405c571b55c28659fa3ec48b1e13e95fd9b2", "filename": "gcc/config/mep/mep.c", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5ba863d70d67fe53afb11ec0e71fc703ba843507/gcc%2Fconfig%2Fmep%2Fmep.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5ba863d70d67fe53afb11ec0e71fc703ba843507/gcc%2Fconfig%2Fmep%2Fmep.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmep%2Fmep.c?ref=5ba863d70d67fe53afb11ec0e71fc703ba843507", "patch": "@@ -1211,6 +1211,20 @@ mep_multi_slot (rtx x)\n }\n \n \n+bool\n+mep_legitimate_constant_p (rtx x)\n+{\n+  /* We can't convert symbol values to gp- or tp-rel values after\n+     reload, as reload might have used $gp or $tp for other\n+     purposes.  */\n+  if (GET_CODE (x) == SYMBOL_REF && (reload_in_progress || reload_completed))\n+    {\n+      char e = mep_section_tag (x);\n+      return (e != 't' && e != 'b');\n+    }\n+  return 1;\n+}\n+\n /* Be careful not to use macros that need to be compiled one way for\n    strict, and another way for not-strict, like REG_OK_FOR_BASE_P.  */\n "}, {"sha": "39837dfc329fd300693a9ec1a380ba8d22de6f5f", "filename": "gcc/config/mep/mep.h", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5ba863d70d67fe53afb11ec0e71fc703ba843507/gcc%2Fconfig%2Fmep%2Fmep.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5ba863d70d67fe53afb11ec0e71fc703ba843507/gcc%2Fconfig%2Fmep%2Fmep.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmep%2Fmep.h?ref=5ba863d70d67fe53afb11ec0e71fc703ba843507", "patch": "@@ -599,7 +599,8 @@ typedef struct\n \n #define GO_IF_MODE_DEPENDENT_ADDRESS(ADDR, LABEL)\n \n-#define LEGITIMATE_CONSTANT_P(X) 1\n+#define LEGITIMATE_CONSTANT_P(X) \\\n+  mep_legitimate_constant_p(X)\n \n #define SELECT_CC_MODE(OP, X, Y)  CCmode\n \f"}, {"sha": "773a9a0aa1418cf1791e95c0d2e87f653b7965bc", "filename": "gcc/config/mep/mep.md", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5ba863d70d67fe53afb11ec0e71fc703ba843507/gcc%2Fconfig%2Fmep%2Fmep.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5ba863d70d67fe53afb11ec0e71fc703ba843507/gcc%2Fconfig%2Fmep%2Fmep.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmep%2Fmep.md?ref=5ba863d70d67fe53afb11ec0e71fc703ba843507", "patch": "@@ -2192,7 +2192,7 @@\n    (use (reg:SI LP_REGNO))]\n   \"\"\n   \"#\"\n-  \"reload_completed\"\n+  \"epilogue_completed\"\n   [(const_int 1)]\n   \"mep_emit_eh_epilogue (operands); DONE;\"\n   [(set_attr \"slot\" \"multi\")])"}]}