{"sha": "8e7816b4663fa7cade055ace845703ef99451456", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OGU3ODE2YjQ2NjNmYTdjYWRlMDU1YWNlODQ1NzAzZWY5OTQ1MTQ1Ng==", "commit": {"author": {"name": "Andrey Belevantsev", "email": "abel@ispras.ru", "date": "2016-03-21T07:52:05Z"}, "committer": {"name": "Andrey Belevantsev", "email": "abel@gcc.gnu.org", "date": "2016-03-21T07:52:05Z"}, "message": "re PR rtl-optimization/69102 (ICE: in move_op_ascend, at sel-sched.c:6138 with -fselective-scheduling2)\n\ngcc/\n        PR rtl-optimization/69102\n        * sched-deps.c (sched_analyze_insn): Do not set last_args_size field\n        when we have a readonly dependency context.\n\ntestsuite/\n\n        PR rtl-optimization/69102\n        * gcc.c-torture/compile/pr69102.c: New test.\n\nFrom-SVN: r234359", "tree": {"sha": "349a5e2622b98200a0d551a8e3fee580c88733ff", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/349a5e2622b98200a0d551a8e3fee580c88733ff"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8e7816b4663fa7cade055ace845703ef99451456", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8e7816b4663fa7cade055ace845703ef99451456", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8e7816b4663fa7cade055ace845703ef99451456", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8e7816b4663fa7cade055ace845703ef99451456/comments", "author": {"login": "abonzo", "id": 20396542, "node_id": "MDQ6VXNlcjIwMzk2NTQy", "avatar_url": "https://avatars.githubusercontent.com/u/20396542?v=4", "gravatar_id": "", "url": "https://api.github.com/users/abonzo", "html_url": "https://github.com/abonzo", "followers_url": "https://api.github.com/users/abonzo/followers", "following_url": "https://api.github.com/users/abonzo/following{/other_user}", "gists_url": "https://api.github.com/users/abonzo/gists{/gist_id}", "starred_url": "https://api.github.com/users/abonzo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/abonzo/subscriptions", "organizations_url": "https://api.github.com/users/abonzo/orgs", "repos_url": "https://api.github.com/users/abonzo/repos", "events_url": "https://api.github.com/users/abonzo/events{/privacy}", "received_events_url": "https://api.github.com/users/abonzo/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "d816052f1740f0d0a8037b098876a4070bf27d51", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d816052f1740f0d0a8037b098876a4070bf27d51", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d816052f1740f0d0a8037b098876a4070bf27d51"}], "stats": {"total": 35, "additions": 34, "deletions": 1}, "files": [{"sha": "f4431a02bdb88b15397c9c172017ac6c10060011", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8e7816b4663fa7cade055ace845703ef99451456/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8e7816b4663fa7cade055ace845703ef99451456/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=8e7816b4663fa7cade055ace845703ef99451456", "patch": "@@ -1,3 +1,9 @@\n+2016-03-21  Andrey Belevantsev  <abel@ispras.ru>\n+\n+\tPR rtl-optimization/69102\n+\t* sched-deps.c (sched_analyze_insn): Do not set last_args_size field\n+\twhen we have a readonly dependency context. \n+\n 2016-03-18  Jeff Law  <law@redhat.com>\n \n \tPR rtl-optimization/70263"}, {"sha": "8f3a124a8fad518b6920fb041f9a0b08fe848d3b", "filename": "gcc/sched-deps.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8e7816b4663fa7cade055ace845703ef99451456/gcc%2Fsched-deps.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8e7816b4663fa7cade055ace845703ef99451456/gcc%2Fsched-deps.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fsched-deps.c?ref=8e7816b4663fa7cade055ace845703ef99451456", "patch": "@@ -3495,7 +3495,8 @@ sched_analyze_insn (struct deps_desc *deps, rtx x, rtx_insn *insn)\n     {\n       if (deps->last_args_size)\n \tadd_dependence (insn, deps->last_args_size, REG_DEP_OUTPUT);\n-      deps->last_args_size = insn;\n+      if (!deps->readonly)\n+\tdeps->last_args_size = insn;\n     }\n }\n "}, {"sha": "ab1b25a876b0d1e83a7ce7965e62e2cf7afe023b", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8e7816b4663fa7cade055ace845703ef99451456/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8e7816b4663fa7cade055ace845703ef99451456/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=8e7816b4663fa7cade055ace845703ef99451456", "patch": "@@ -1,3 +1,8 @@\n+2016-03-21  Andrey Belevantsev  <abel@ispras.ru>\n+\n+\tPR rtl-optimization/69102\n+\t* gcc.c-torture/compile/pr69102.c: New test.\n+\n 2016-03-18  Jeff Law  <law@redhat.com>\n \n \tPR rtl-optimization/70263"}, {"sha": "b1328cad974a6b0ceb95830c300d89b3250c4421", "filename": "gcc/testsuite/gcc.c-torture/compile/pr69102.c", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8e7816b4663fa7cade055ace845703ef99451456/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fpr69102.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8e7816b4663fa7cade055ace845703ef99451456/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fpr69102.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fpr69102.c?ref=8e7816b4663fa7cade055ace845703ef99451456", "patch": "@@ -0,0 +1,21 @@\n+/* { dg-options \"-Og -fPIC -fschedule-insns2 -fselective-scheduling2 -fno-tree-fre --param=max-sched-extend-regions-iters=10\" } */\n+void bar (unsigned int);\n+\n+void\n+foo (void)\n+{\n+  char buf[1] = { 3 };\n+  const char *p = buf;\n+  const char **q = &p;\n+  unsigned int ch;\n+  switch (**q)\n+    {\n+    case 1:  ch = 5; break;\n+    case 2:  ch = 4; break;\n+    case 3:  ch = 3; break;\n+    case 4:  ch = 2; break;\n+    case 5:  ch = 1; break;\n+    default: ch = 0; break;\n+    }\n+  bar (ch);\n+}"}]}