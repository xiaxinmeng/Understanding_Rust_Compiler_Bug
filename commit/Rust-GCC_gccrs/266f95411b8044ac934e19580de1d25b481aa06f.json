{"sha": "266f95411b8044ac934e19580de1d25b481aa06f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjY2Zjk1NDExYjgwNDRhYzkzNGUxOTU4MGRlMWQyNWI0ODFhYTA2Zg==", "commit": {"author": {"name": "Jim Wilson", "email": "wilson@gcc.gnu.org", "date": "1993-02-05T23:50:44Z"}, "committer": {"name": "Jim Wilson", "email": "wilson@gcc.gnu.org", "date": "1993-02-05T23:50:44Z"}, "message": "Initial revision\n\nFrom-SVN: r3431", "tree": {"sha": "40ae571f75eb13d2ee3a90b2876fc589c18fea5e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/40ae571f75eb13d2ee3a90b2876fc589c18fea5e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/266f95411b8044ac934e19580de1d25b481aa06f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/266f95411b8044ac934e19580de1d25b481aa06f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/266f95411b8044ac934e19580de1d25b481aa06f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/266f95411b8044ac934e19580de1d25b481aa06f/comments", "author": null, "committer": null, "parents": [{"sha": "d68398271cd3079fa4536fc0241ce7d6bbab6b2d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d68398271cd3079fa4536fc0241ce7d6bbab6b2d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d68398271cd3079fa4536fc0241ce7d6bbab6b2d"}], "stats": {"total": 311, "additions": 311, "deletions": 0}, "files": [{"sha": "bd7c737cc029a7385a9521e05e9b24e52f24f3c6", "filename": "gcc/config/i386/sol2-c1.asm", "status": "added", "additions": 155, "deletions": 0, "changes": 155, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/266f95411b8044ac934e19580de1d25b481aa06f/gcc%2Fconfig%2Fi386%2Fsol2-c1.asm", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/266f95411b8044ac934e19580de1d25b481aa06f/gcc%2Fconfig%2Fi386%2Fsol2-c1.asm", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fsol2-c1.asm?ref=266f95411b8044ac934e19580de1d25b481aa06f", "patch": "@@ -0,0 +1,155 @@\n+! crt1.s for Solaris 2, x86\n+\n+!   Copyright (C) 1993 Free Software Foundation, Inc.\n+!   Written By Fred Fish, Nov 1992\n+! \n+! This file is free software; you can redistribute it and/or modify it\n+! under the terms of the GNU General Public License as published by the\n+! Free Software Foundation; either version 2, or (at your option) any\n+! later version.\n+! \n+! In addition to the permissions in the GNU General Public License, the\n+! Free Software Foundation gives you unlimited permission to link the\n+! compiled version of this file with other programs, and to distribute\n+! those programs without any restriction coming from the use of this\n+! file.  (The General Public License restrictions do apply in other\n+! respects; for example, they cover modification of the file, and\n+! distribution when not linked into another program.)\n+! \n+! This file is distributed in the hope that it will be useful, but\n+! WITHOUT ANY WARRANTY; without even the implied warranty of\n+! MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+! General Public License for more details.\n+! \n+! You should have received a copy of the GNU General Public License\n+! along with this program; see the file COPYING.  If not, write to\n+! the Free Software Foundation, 675 Mass Ave, Cambridge, MA 02139, USA.\n+! \n+!    As a special exception, if you link this library with files\n+!    compiled with GCC to produce an executable, this does not cause\n+!    the resulting executable to be covered by the GNU General Public License.\n+!    This exception does not however invalidate any other reasons why\n+!    the executable file might be covered by the GNU General Public License.\n+! \n+\n+! This file takes control of the process from the kernel, as specified\n+! in section 3 of the System V Application Binary Interface, Intel386\n+! Processor Supplement.  It has been constructed from information obtained\n+! from the ABI, information obtained from single stepping existing\n+! Solaris executables through their startup code with gdb, and from\n+! information obtained by single stepping executables on other i386 SVR4\n+! implementations.  This file is the first thing linked into any executable.\n+\n+\t.file\t\"crt1.s\"\n+\t.ident\t\"GNU C crt1.s\"\n+\t.weak\t_cleanup\n+\t.weak\t_DYNAMIC\n+\t.text\n+\n+! Start creating the initial frame by pushing a NULL value for the return\n+! address of the initial frame, and mark the end of the stack frame chain\n+! (the innermost stack frame) with a NULL value, per page 3-32 of the ABI.\n+! Initialize the first stack frame pointer in %ebp (the contents of which\n+! are unspecified at process initialization).\n+\n+\t.globl\t_start\n+_start:\n+\tpushl\t$0x0\n+\tpushl\t$0x0\n+\tmovl\t%esp,%ebp\n+\n+! As specified per page 3-32 of the ABI, %edx contains a function \n+! pointer that should be registered with atexit(), for proper\n+! shared object termination.  Just push it onto the stack for now\n+! to preserve it.  We want to register _cleanup() first.\n+\n+\tpushl\t%edx\n+\n+! Check to see if there is an _cleanup() function linked in, and if\n+! so, register it with atexit() as the last thing to be run by\n+! atexit().\n+\n+\tmovl\t$_cleanup,%eax\n+\ttestl\t%eax,%eax\n+\tje\t.L1\n+\tpushl\t$_cleanup\n+\tcall\tatexit\n+\taddl\t$0x4,%esp\n+.L1:\n+\n+! Now check to see if we have an _DYNAMIC table, and if so then\n+! we need to register the function pointer previously in %edx, but\n+! now conveniently saved on the stack as the argument to pass to\n+! atexit().\n+\n+\tmovl\t$_DYNAMIC,%eax\n+\ttestl\t%eax,%eax\n+\tje\t.L2\n+\tcall\tatexit\n+.L2:\n+\n+! Register _fini() with atexit().  We will take care of calling _init()\n+! directly.\n+\n+\tpushl\t$_fini\n+\tcall\tatexit\n+\n+! Compute the address of the environment vector on the stack and load\n+! it into the global variable _environ.  Currently argc is at 8 off\n+! the frame pointer.  Fetch the argument count into %eax, scale by the\n+! size of each arg (4 bytes) and compute the address of the environment\n+! vector which is 16 bytes (the two zero words we pushed, plus argc,\n+! plus the null word terminating the arg vector) further up the stack,\n+! off the frame pointer (whew!).\n+\n+\tmovl\t8(%ebp),%eax\n+\tleal\t16(%ebp,%eax,4),%edx\n+\tmovl\t%edx,_environ\n+\n+! Push the environment vector pointer, the argument vector pointer,\n+! and the argument count on to the stack to set up the arguments\n+! for _init(), _fpstart(), and main().  Note that the environment\n+! vector pointer and the arg count were previously loaded into\n+! %edx and %eax respectively.  The only new value we need to compute\n+! is the argument vector pointer, which is at a fixed address off\n+! the initial frame pointer.\n+\n+\tpushl\t%edx\n+\tleal\t12(%ebp),%edx\n+\tpushl\t%edx\n+\tpushl\t%eax\n+\n+! Call _init(argc, argv, environ), _fpstart(argc, argv, environ), and\n+! main(argc, argv, environ).\n+\n+\tcall\t_init\n+\tcall\t__fpstart\n+\tcall\tmain\n+\n+! Pop the argc, argv, and environ arguments off the stack, push the\n+! value returned from main(), and call exit().\n+\n+\taddl\t$12,%esp\n+\tpushl\t%eax\n+\tcall\texit\n+\n+! An inline equivalent of _exit, as specified in Figure 3-26 of the ABI.\n+\n+\tpushl\t$0x0\n+\tmovl\t$0x1,%eax\n+\tlcall\t$7,$0\n+\n+! If all else fails, just try a halt!\n+\n+\thlt\n+\t.type\t_start,@function\n+\t.size\t_start,.-_start\n+\n+! A dummy profiling support routine for non-profiling executables,\n+! in case we link in some objects that have been compiled for profiling.\n+\n+\t.globl\t_mcount\n+_mcount:\n+\tret\n+\t.type\t_mcount,@function\n+\t.size\t_mcount,.-_mcount"}, {"sha": "0d9b71850a4294adcf15ff8c404f751bfcbab6e2", "filename": "gcc/config/i386/sol2-ci.asm", "status": "added", "additions": 50, "deletions": 0, "changes": 50, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/266f95411b8044ac934e19580de1d25b481aa06f/gcc%2Fconfig%2Fi386%2Fsol2-ci.asm", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/266f95411b8044ac934e19580de1d25b481aa06f/gcc%2Fconfig%2Fi386%2Fsol2-ci.asm", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fsol2-ci.asm?ref=266f95411b8044ac934e19580de1d25b481aa06f", "patch": "@@ -0,0 +1,50 @@\n+! crti.s for Solaris 2, x86.\n+\n+!   Copyright (C) 1993 Free Software Foundation, Inc.\n+!   Written By Fred Fish, Nov 1992\n+! \n+! This file is free software; you can redistribute it and/or modify it\n+! under the terms of the GNU General Public License as published by the\n+! Free Software Foundation; either version 2, or (at your option) any\n+! later version.\n+! \n+! In addition to the permissions in the GNU General Public License, the\n+! Free Software Foundation gives you unlimited permission to link the\n+! compiled version of this file with other programs, and to distribute\n+! those programs without any restriction coming from the use of this\n+! file.  (The General Public License restrictions do apply in other\n+! respects; for example, they cover modification of the file, and\n+! distribution when not linked into another program.)\n+! \n+! This file is distributed in the hope that it will be useful, but\n+! WITHOUT ANY WARRANTY; without even the implied warranty of\n+! MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+! General Public License for more details.\n+! \n+! You should have received a copy of the GNU General Public License\n+! along with this program; see the file COPYING.  If not, write to\n+! the Free Software Foundation, 675 Mass Ave, Cambridge, MA 02139, USA.\n+! \n+!    As a special exception, if you link this library with files\n+!    compiled with GCC to produce an executable, this does not cause\n+!    the resulting executable to be covered by the GNU General Public License.\n+!    This exception does not however invalidate any other reasons why\n+!    the executable file might be covered by the GNU General Public License.\n+! \n+\n+! This file just supplies labeled starting points for the .init and .fini\n+! sections.  It is linked in before the values-Xx.o files and also before\n+! crtbegin.o.\n+ \n+\t.file\t\"crti.s\"\n+\t.ident\t\"GNU C crti.s\"\n+\n+\t.section .init\n+\t.globl\t_init\n+\t.type\t_init,@function\n+_init:\n+\n+\t.section .fini\n+\t.globl\t_fini\n+\t.type\t_fini,@function\n+_fini:"}, {"sha": "e55eac28bbae4e55f48e0afda8d2ab860fa5e740", "filename": "gcc/config/i386/sol2-cn.asm", "status": "added", "additions": 45, "deletions": 0, "changes": 45, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/266f95411b8044ac934e19580de1d25b481aa06f/gcc%2Fconfig%2Fi386%2Fsol2-cn.asm", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/266f95411b8044ac934e19580de1d25b481aa06f/gcc%2Fconfig%2Fi386%2Fsol2-cn.asm", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fsol2-cn.asm?ref=266f95411b8044ac934e19580de1d25b481aa06f", "patch": "@@ -0,0 +1,45 @@\n+! crtn.s for Solaris 2, x86.\n+\n+!   Copyright (C) 1993 Free Software Foundation, Inc.\n+!   Written By Fred Fish, Nov 1992\n+! \n+! This file is free software; you can redistribute it and/or modify it\n+! under the terms of the GNU General Public License as published by the\n+! Free Software Foundation; either version 2, or (at your option) any\n+! later version.\n+! \n+! In addition to the permissions in the GNU General Public License, the\n+! Free Software Foundation gives you unlimited permission to link the\n+! compiled version of this file with other programs, and to distribute\n+! those programs without any restriction coming from the use of this\n+! file.  (The General Public License restrictions do apply in other\n+! respects; for example, they cover modification of the file, and\n+! distribution when not linked into another program.)\n+! \n+! This file is distributed in the hope that it will be useful, but\n+! WITHOUT ANY WARRANTY; without even the implied warranty of\n+! MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+! General Public License for more details.\n+! \n+! You should have received a copy of the GNU General Public License\n+! along with this program; see the file COPYING.  If not, write to\n+! the Free Software Foundation, 675 Mass Ave, Cambridge, MA 02139, USA.\n+! \n+!    As a special exception, if you link this library with files\n+!    compiled with GCC to produce an executable, this does not cause\n+!    the resulting executable to be covered by the GNU General Public License.\n+!    This exception does not however invalidate any other reasons why\n+!    the executable file might be covered by the GNU General Public License.\n+! \n+\n+! This file just supplies returns for the .init and .fini sections.  It is\n+! linked in after all other files.\n+\n+\t.file\t\"crtn.o\"\n+\t.ident\t\"GNU C crtn.o\"\n+\n+\t.section .init\n+\tret    $0x0\n+\n+\t.section .fini\n+\tret    $0x0"}, {"sha": "126bd0851eb0434069c71581927a95d376d55f38", "filename": "gcc/config/i386/sol2.h", "status": "added", "additions": 33, "deletions": 0, "changes": 33, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/266f95411b8044ac934e19580de1d25b481aa06f/gcc%2Fconfig%2Fi386%2Fsol2.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/266f95411b8044ac934e19580de1d25b481aa06f/gcc%2Fconfig%2Fi386%2Fsol2.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fsol2.h?ref=266f95411b8044ac934e19580de1d25b481aa06f", "patch": "@@ -0,0 +1,33 @@\n+/* Target definitions for GNU compiler for Intel 80386 running Solaris 2\n+   Copyright (C) 1993 Free Software Foundation, Inc.\n+\n+   Written by Fred Fish (fnf@cygnus.com).\n+\n+This file is part of GNU CC.\n+\n+GNU CC is free software; you can redistribute it and/or modify\n+it under the terms of the GNU General Public License as published by\n+the Free Software Foundation; either version 2, or (at your option)\n+any later version.\n+\n+GNU CC is distributed in the hope that it will be useful,\n+but WITHOUT ANY WARRANTY; without even the implied warranty of\n+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+GNU General Public License for more details.\n+\n+You should have received a copy of the GNU General Public License\n+along with GNU CC; see the file COPYING.  If not, write to\n+the Free Software Foundation, 675 Mass Ave, Cambridge, MA 02139, USA.  */\n+\n+#include \"i386/sysv4.h\"\n+\n+/* The Solaris 2.0 x86 linker botches alignment of code sections.\n+   It tries to align to a 16 byte boundary by padding with 0x00000090\n+   ints, rather than 0x90 bytes (nop).  This generates trash in the\n+   \".init\" section since the contribution from crtbegin.o is only 7\n+   bytes.  The linker pads it to 16 bytes with a single 0x90 byte, and\n+   two 0x00000090 ints, which generates a segmentation violation when\n+   executed.  This macro forces the assembler to do the padding, since\n+   it knows what it is doing. */\n+\n+#define FORCE_INIT_SECTION_ALIGN do { asm (ALIGN_ASM_OP ## \" 16\"); } while (0)"}, {"sha": "972fd73cbe52059a918c56dc94f3c9f3d9fc180a", "filename": "gcc/config/i386/t-sol2", "status": "added", "additions": 28, "deletions": 0, "changes": 28, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/266f95411b8044ac934e19580de1d25b481aa06f/gcc%2Fconfig%2Fi386%2Ft-sol2", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/266f95411b8044ac934e19580de1d25b481aa06f/gcc%2Fconfig%2Fi386%2Ft-sol2", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Ft-sol2?ref=266f95411b8044ac934e19580de1d25b481aa06f", "patch": "@@ -0,0 +1,28 @@\n+# We need startup files for Solaris, since we don't get them with the system\n+# FIXME:  Should include \"gmon.o\" when it is ported.\n+\n+EXTRA_PARTS=crt1.o crti.o crtn.o crtbegin.o crtend.o\n+\n+# we need to supply our own assembly versions of libgcc1.c files,\n+# since the user may not have native 'cc' available\n+\n+LIBGCC1 = libgcc1.null\n+\n+# gmon build rule:\n+gmon.o:\t$(srcdir)/config/i386/gmon-sol2.c $(GCC_PASSES) $(CONFIG_H)\n+\t$(GCC_FOR_TARGET) $(GCC_CFLAGS) $(INCLUDES) \\\n+\t\t-c $(srcdir)/config/i386/gmon-sol2.c -o gmon.o\n+\n+# Assemble startup files.\n+# Apparently Sun believes that assembler files don't need comments, because no\n+# single ASCII character is valid (tried them all).  So we manually strip out\n+# the comments with sed.  This bug may only be in the Early Access releases.\n+crt1.o: $(srcdir)/config/i386/sol2-c1.asm\n+\tsed -e '/^!/d' <$(srcdir)/config/i386/sol2-c1.asm >crt1.s\n+\t$(AS) -o crt1.o crt1.s\n+crti.o: $(srcdir)/config/i386/sol2-ci.asm\n+\tsed -e '/^!/d' <$(srcdir)/config/i386/sol2-ci.asm >crti.s\n+\t$(AS) -o crti.o crti.s\n+crtn.o: $(srcdir)/config/i386/sol2-cn.asm\n+\tsed -e '/^!/d' <$(srcdir)/config/i386/sol2-cn.asm >crtn.s\n+\t$(AS) -o crtn.o crtn.s"}]}