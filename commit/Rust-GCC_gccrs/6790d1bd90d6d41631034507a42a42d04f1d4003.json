{"sha": "6790d1bd90d6d41631034507a42a42d04f1d4003", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Njc5MGQxYmQ5MGQ2ZDQxNjMxMDM0NTA3YTQyYTQyZDA0ZjFkNDAwMw==", "commit": {"author": {"name": "Richard Kenner", "email": "kenner@vlsi1.ultra.nyu.edu", "date": "2001-12-29T21:00:51Z"}, "committer": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "2001-12-29T21:00:51Z"}, "message": "stor-layout.c (layout_decl): Don't misalign field of variable size for packed record.\n\n\t* stor-layout.c (layout_decl): Don't misalign field of variable size\n\tfor packed record.\n\nFrom-SVN: r48384", "tree": {"sha": "9eff696e051cd33a2392999d77a89728d2cec952", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9eff696e051cd33a2392999d77a89728d2cec952"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6790d1bd90d6d41631034507a42a42d04f1d4003", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6790d1bd90d6d41631034507a42a42d04f1d4003", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6790d1bd90d6d41631034507a42a42d04f1d4003", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6790d1bd90d6d41631034507a42a42d04f1d4003/comments", "author": null, "committer": null, "parents": [{"sha": "f11c3043051e421744ea3d5d3b32c9149fbacf4e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f11c3043051e421744ea3d5d3b32c9149fbacf4e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f11c3043051e421744ea3d5d3b32c9149fbacf4e"}], "stats": {"total": 13, "additions": 12, "deletions": 1}, "files": [{"sha": "5ba989d534f718aeee600636d5f5e99ab5563266", "filename": "gcc/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6790d1bd90d6d41631034507a42a42d04f1d4003/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6790d1bd90d6d41631034507a42a42d04f1d4003/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=6790d1bd90d6d41631034507a42a42d04f1d4003", "patch": "@@ -1,5 +1,8 @@\n Sat Dec 29 15:48:54 2001  Richard Kenner  <kenner@vlsi1.ultra.nyu.edu>\n \n+\t* stor-layout.c (layout_decl): Don't misalign field of variable size\n+\tfor packed record.\n+\n \t* dwarf2out.c (compute_section_prefix): Avoid cast warning.\n \t(gen_decl_die): Only check DECL_IGNORED_P on decls.\n \t(dwarf2out_decl): Check for DECL_IGNORED_P only when needed."}, {"sha": "fe9ed2c9ca8537a159c278e39b34792ba7fd0092", "filename": "gcc/stor-layout.c", "status": "modified", "additions": 9, "deletions": 1, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6790d1bd90d6d41631034507a42a42d04f1d4003/gcc%2Fstor-layout.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6790d1bd90d6d41631034507a42a42d04f1d4003/gcc%2Fstor-layout.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fstor-layout.c?ref=6790d1bd90d6d41631034507a42a42d04f1d4003", "patch": "@@ -389,7 +389,15 @@ layout_decl (decl, known_align)\n       DECL_BIT_FIELD_TYPE (decl) = DECL_BIT_FIELD (decl) ? type : 0;\n       if (maximum_field_alignment != 0)\n \tDECL_ALIGN (decl) = MIN (DECL_ALIGN (decl), maximum_field_alignment);\n-      else if (DECL_PACKED (decl))\n+\n+      /* If the field is of variable size, we can't misalign it since we\n+\t have no way to make a temporary to align the result.  But this\n+\t isn't an issue if the decl is not addressable.  Likewise if it\n+\t is of unknown size.  */\n+      else if (DECL_PACKED (decl)\n+\t       && (DECL_NONADDRESSABLE_P (decl)\n+\t\t   || DECL_SIZE_UNIT (decl) == 0\n+\t\t   || TREE_CODE (DECL_SIZE_UNIT (decl)) == INTEGER_CST))\n \t{\n \t  DECL_ALIGN (decl) = MIN (DECL_ALIGN (decl), BITS_PER_UNIT);\n \t  DECL_USER_ALIGN (decl) = 0;"}]}