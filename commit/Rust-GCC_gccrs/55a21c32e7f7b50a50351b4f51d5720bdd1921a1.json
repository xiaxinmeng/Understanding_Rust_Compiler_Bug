{"sha": "55a21c32e7f7b50a50351b4f51d5720bdd1921a1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTVhMjFjMzJlN2Y3YjUwYTUwMzUxYjRmNTFkNTcyMGJkZDE5MjFhMQ==", "commit": {"author": {"name": "Aldy Hernandez", "email": "aldyh@redhat.com", "date": "2002-03-12T01:24:42Z"}, "committer": {"name": "Aldy Hernandez", "email": "aldyh@gcc.gnu.org", "date": "2002-03-12T01:24:42Z"}, "message": "altivec-1.c: Cleanup and use altivec.h.\n\n2002-03-11  Aldy Hernandez  <aldyh@redhat.com>\n\n        * gcc.dg/altivec-1.c: Cleanup and use altivec.h.\n\nFrom-SVN: r50624", "tree": {"sha": "3e1505f5bd59a1baa3e638de5d60e473e0ccc4c0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3e1505f5bd59a1baa3e638de5d60e473e0ccc4c0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/55a21c32e7f7b50a50351b4f51d5720bdd1921a1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/55a21c32e7f7b50a50351b4f51d5720bdd1921a1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/55a21c32e7f7b50a50351b4f51d5720bdd1921a1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/55a21c32e7f7b50a50351b4f51d5720bdd1921a1/comments", "author": {"login": "aldyh", "id": 12937877, "node_id": "MDQ6VXNlcjEyOTM3ODc3", "avatar_url": "https://avatars.githubusercontent.com/u/12937877?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aldyh", "html_url": "https://github.com/aldyh", "followers_url": "https://api.github.com/users/aldyh/followers", "following_url": "https://api.github.com/users/aldyh/following{/other_user}", "gists_url": "https://api.github.com/users/aldyh/gists{/gist_id}", "starred_url": "https://api.github.com/users/aldyh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aldyh/subscriptions", "organizations_url": "https://api.github.com/users/aldyh/orgs", "repos_url": "https://api.github.com/users/aldyh/repos", "events_url": "https://api.github.com/users/aldyh/events{/privacy}", "received_events_url": "https://api.github.com/users/aldyh/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "bc204393c834739e398207f5e5c2e671ef56210f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bc204393c834739e398207f5e5c2e671ef56210f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bc204393c834739e398207f5e5c2e671ef56210f"}], "stats": {"total": 94, "additions": 27, "deletions": 67}, "files": [{"sha": "dc5e87cc3588831bcf7cb1275ff86d00f63c0604", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/55a21c32e7f7b50a50351b4f51d5720bdd1921a1/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/55a21c32e7f7b50a50351b4f51d5720bdd1921a1/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=55a21c32e7f7b50a50351b4f51d5720bdd1921a1", "patch": "@@ -1,3 +1,7 @@\n+2002-03-11  Aldy Hernandez  <aldyh@redhat.com>\n+\n+        * gcc.dg/altivec-1.c: Cleanup and use altivec.h.\n+\n 2002-03-11  Richard Henderson  <rth@redhat.com>\n \n \t* g++.old-deja/g++.brendan/crash52.C: Remove return warning marker."}, {"sha": "3d37a2e1c76fdcbd8b44667a3df86f13cd4c4930", "filename": "gcc/testsuite/gcc.dg/altivec-1.c", "status": "modified", "additions": 23, "deletions": 67, "changes": 90, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/55a21c32e7f7b50a50351b4f51d5720bdd1921a1/gcc%2Ftestsuite%2Fgcc.dg%2Faltivec-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/55a21c32e7f7b50a50351b4f51d5720bdd1921a1/gcc%2Ftestsuite%2Fgcc.dg%2Faltivec-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Faltivec-1.c?ref=55a21c32e7f7b50a50351b4f51d5720bdd1921a1", "patch": "@@ -3,80 +3,36 @@\n \n /* Program to test PowerPC AltiVec instructions.  */\n \n-/* These macros are not analogous to the overloaded functions\n-   described in Motorola's AltiVec Programming Interface Manual.\n-   These are just here for readability.  Eventually we'll get the\n-   overloaded functions implemented in an <altivec.h>.  */\n+#include <altivec.h>\n \n-#define vec_load(src) \\\n-  __builtin_altivec_ld_internal_4si ((int *) src)\n+extern void abort (void);\n \n-#define vec_store(dst, src) \\\n-  __builtin_altivec_st_internal_4si ((int *) dst, (int4) src)\n+vector int a1 = { 100, 200, 300, 400 };\n+vector int a2 = { 500, 600, 700, 800 };\n+vector int addi = { 600, 800, 1000, 1200 };\n+vector int avgi = { 300, 400, 500, 600 };\n \n-#define vec_add_int4(x, y) \\\n-  __builtin_altivec_vaddsws (x, y)\n+vector float f1 = { 1.0, 2.0, 3.0, 4.0 };  \n+vector float f2 = { 5.0, 6.0, 7.0, 8.0 };\n+vector float f3;\n+vector float addf = { 6.0, 8.0, 10.0, 12.0 };\n \n-#define vec_add_float4(x, y) \\\n-  __builtin_altivec_vaddfp (x, y)\n+vector int k;\n+vector float f, g, h;\n \n-#define vec_average_int4(x, y) \\\n-  __builtin_altivec_vavgsw (x, y)\n-\n-typedef int int4 __attribute__ ((mode(V4SI)));\n-typedef float float4 __attribute__ ((mode(V4SF)));\n-\n-int a1[4] __attribute__((aligned(16))) = { 100, 200, 300, 400 };\n-int a2[4] __attribute__((aligned(16))) = { 500, 600, 700, 800 };\n-int a3[4] __attribute__((aligned(16)));\n-int addi[4] = { 600, 800, 1000, 1200 };\n-int avgi[4] = { 300, 400, 500, 600 };\n-\n-float f1[4] __attribute__((aligned(16))) = { 1.0, 2.0, 3.0, 4.0 };  \n-float f2[4] __attribute__((aligned(16))) = { 5.0, 6.0, 7.0, 8.0 };\n-float f3[4] __attribute__((aligned(16)));\n-float addf[4] = { 6.0, 8.0, 10.0, 12.0 };\n-\n-int4 i, j, k;\n-float4 f, g, h;\n-\n-void\n-compare_int4 (int *a, int *b)\n-{\n-  int i;\n-\n-  for (i = 0; i < 4; ++i)\n-    if (a[i] != b[i])\n-      exit (1);\n-}\n-\n-void\n-compare_float4 (float *a, float *b)\n-{\n-  int i;\n-\n-  for (i = 0; i < 4; ++i)\n-    if (a[i] != b[i])\n-      exit (1);\n-}\n-\n-main ()\n+int main ()\n {\n-  i = vec_load (a1);\n-  j = vec_load (a2);\n-  k = vec_add_int4 (i, j);\n-  vec_store (a3, k);\n-  compare_int4 (a3, addi);\n+  k = vec_add (a1, a2);\n+  if (!vec_all_eq (addi, k))\n+    abort ();\n \n-  k = vec_average_int4 (i, j);\n-  vec_store (a3, k);\n-  compare_int4 (a3, avgi);\n+  k = vec_avg (a1, a2);\n+  if (!vec_all_eq (k, avgi))\n+    abort ();\n \n-  f = (float4) vec_load (f1);\n-  g = (float4) vec_load (f2);\n-  h = vec_add_float4 (f, g);\n-  vec_store (f3, h);\n-  compare_float4 (f3, addf);\n+  h = vec_add (f1, f2);\n+  if (!vec_all_eq (h, addf))\n+    abort ();\n \n-  exit (0);\n+  return 0;\n }"}]}