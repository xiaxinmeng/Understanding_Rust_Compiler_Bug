{"sha": "0c2edd9f44eaf7a63442884d3c404240c8ef033b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MGMyZWRkOWY0NGVhZjdhNjM0NDI4ODRkM2M0MDQyNDBjOGVmMDMzYg==", "commit": {"author": {"name": "Ian Lance Taylor", "email": "iant@google.com", "date": "2009-10-10T04:47:05Z"}, "committer": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2009-10-10T04:47:05Z"}, "message": "configure.ac: Use AC_SEARCH_LIBS to find dlopen.\n\n\t* configure.ac: Use AC_SEARCH_LIBS to find dlopen.\n\t* configure: Rebuild.\n\nFrom-SVN: r152615", "tree": {"sha": "3a2bf1f284bd8512335718730cb09368f933789a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3a2bf1f284bd8512335718730cb09368f933789a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0c2edd9f44eaf7a63442884d3c404240c8ef033b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0c2edd9f44eaf7a63442884d3c404240c8ef033b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0c2edd9f44eaf7a63442884d3c404240c8ef033b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0c2edd9f44eaf7a63442884d3c404240c8ef033b/comments", "author": null, "committer": null, "parents": [{"sha": "30c99a9e194d987fce5271cacc16adf54f7c1bdf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/30c99a9e194d987fce5271cacc16adf54f7c1bdf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/30c99a9e194d987fce5271cacc16adf54f7c1bdf"}], "stats": {"total": 80, "additions": 56, "deletions": 24}, "files": [{"sha": "dd177c4ad0d101ef29faf6a2e76b5c1f51cb5a8d", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0c2edd9f44eaf7a63442884d3c404240c8ef033b/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0c2edd9f44eaf7a63442884d3c404240c8ef033b/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=0c2edd9f44eaf7a63442884d3c404240c8ef033b", "patch": "@@ -1,3 +1,8 @@\n+2009-10-09  Ian Lance Taylor  <iant@google.com>\n+\n+\t* configure.ac: Use AC_SEARCH_LIBS to find dlopen.\n+\t* configure: Rebuild.\n+\n 2009-10-09  Neil Vachharajani <nvachhar@google.com>\n \n \t* doc/cpp.texi (Other Directives): Do not list #ident and #sccs as"}, {"sha": "903c949ce6b813b51e0e52f68300bae1b6782eac", "filename": "gcc/configure", "status": "modified", "additions": 48, "deletions": 15, "changes": 63, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0c2edd9f44eaf7a63442884d3c404240c8ef033b/gcc%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0c2edd9f44eaf7a63442884d3c404240c8ef033b/gcc%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfigure?ref=0c2edd9f44eaf7a63442884d3c404240c8ef033b", "patch": "@@ -25013,30 +25013,63 @@ rm -f core conftest.err conftest.$ac_objext \\\n   fi\n \n   # Check -ldl\n-  LIBS=\"$LIBS -ldl\"\n-  { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for -ldl\" >&5\n-$as_echo_n \"checking for -ldl... \" >&6; }\n-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n+  { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for library containing dlopen\" >&5\n+$as_echo_n \"checking for library containing dlopen... \" >&6; }\n+if test \"${ac_cv_search_dlopen+set}\" = set; then :\n+  $as_echo_n \"(cached) \" >&6\n+else\n+  ac_func_search_save_LIBS=$LIBS\n+cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n /* end confdefs.h.  */\n-#include <dlfcn.h>\n+\n+/* Override any GCC internal prototype to avoid an error.\n+   Use char because int might match the return type of a GCC\n+   builtin and then its argument prototype would still apply.  */\n+#ifdef __cplusplus\n+extern \"C\"\n+#endif\n+char dlopen ();\n int\n main ()\n {\n-volatile int f = 0; if (f) dlopen (\"dummy\", 0);\n+return dlopen ();\n   ;\n   return 0;\n }\n _ACEOF\n-if ac_fn_c_try_link \"$LINENO\"; then :\n-  { $as_echo \"$as_me:${as_lineno-$LINENO}: result: yes\" >&5\n-$as_echo \"yes\" >&6; }; have_dl=yes\n-else\n-  { $as_echo \"$as_me:${as_lineno-$LINENO}: result: no\" >&5\n-$as_echo \"no\" >&6; }\n+for ac_lib in '' dl; do\n+  if test -z \"$ac_lib\"; then\n+    ac_res=\"none required\"\n+  else\n+    ac_res=-l$ac_lib\n+    LIBS=\"-l$ac_lib  $ac_func_search_save_LIBS\"\n+  fi\n+  if ac_fn_c_try_link \"$LINENO\"; then :\n+  ac_cv_search_dlopen=$ac_res\n fi\n rm -f core conftest.err conftest.$ac_objext \\\n-    conftest$ac_exeext conftest.$ac_ext\n-  if test x\"$have_dl\" = x\"yes\"; then\n+    conftest$ac_exeext\n+  if test \"${ac_cv_search_dlopen+set}\" = set; then :\n+  break\n+fi\n+done\n+if test \"${ac_cv_search_dlopen+set}\" = set; then :\n+\n+else\n+  ac_cv_search_dlopen=no\n+fi\n+rm conftest.$ac_ext\n+LIBS=$ac_func_search_save_LIBS\n+fi\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $ac_cv_search_dlopen\" >&5\n+$as_echo \"$ac_cv_search_dlopen\" >&6; }\n+ac_res=$ac_cv_search_dlopen\n+if test \"$ac_res\" != no; then :\n+  test \"$ac_res\" = \"none required\" || LIBS=\"$ac_res $LIBS\"\n+\n+fi\n+\n+  if test x\"$ac_cv_search_dlopen\" = x\"-ldl\"; then\n     pluginlibs=\"$pluginlibs -ldl\"\n   fi\n \n@@ -25064,7 +25097,7 @@ $as_echo \"no\" >&6; }; have_pic_shared=no\n fi\n rm -f core conftest.err conftest.$ac_objext \\\n     conftest$ac_exeext conftest.$ac_ext\n-  if test x\"$have_pic_shared\" != x\"yes\"; then\n+  if test x\"$have_pic_shared\" != x\"yes\" -o x\"$ac_cv_search_dlopen\" = x\"no\"; then\n     pluginlibs=\n     enable_plugin=no\n   fi"}, {"sha": "eee47ad08b4a8d35f275b6c71e61afa4de177c61", "filename": "gcc/configure.ac", "status": "modified", "additions": 3, "deletions": 9, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0c2edd9f44eaf7a63442884d3c404240c8ef033b/gcc%2Fconfigure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0c2edd9f44eaf7a63442884d3c404240c8ef033b/gcc%2Fconfigure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfigure.ac?ref=0c2edd9f44eaf7a63442884d3c404240c8ef033b", "patch": "@@ -4253,14 +4253,8 @@ if test x\"$enable_plugin\" = x\"yes\"; then\n   fi\n \n   # Check -ldl\n-  LIBS=\"$LIBS -ldl\"\n-  AC_MSG_CHECKING([for -ldl])\n-  AC_TRY_LINK(\n-    [#include <dlfcn.h>],\n-    [volatile int f = 0; if (f) dlopen (\"dummy\", 0);],\n-    [AC_MSG_RESULT([yes]); have_dl=yes],\n-    [AC_MSG_RESULT([no])])\n-  if test x\"$have_dl\" = x\"yes\"; then\n+  AC_SEARCH_LIBS([dlopen], [dl])\n+  if test x\"$ac_cv_search_dlopen\" = x\"-ldl\"; then\n     pluginlibs=\"$pluginlibs -ldl\"\n   fi\n \n@@ -4271,7 +4265,7 @@ if test x\"$enable_plugin\" = x\"yes\"; then\n     [extern int X;],[return X == 0;],\n     [AC_MSG_RESULT([yes]); have_pic_shared=yes],\n     [AC_MSG_RESULT([no]); have_pic_shared=no])\n-  if test x\"$have_pic_shared\" != x\"yes\"; then\n+  if test x\"$have_pic_shared\" != x\"yes\" -o x\"$ac_cv_search_dlopen\" = x\"no\"; then\n     pluginlibs=\n     enable_plugin=no\n   fi"}]}