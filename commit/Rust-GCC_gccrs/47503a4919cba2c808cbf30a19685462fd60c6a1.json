{"sha": "47503a4919cba2c808cbf30a19685462fd60c6a1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDc1MDNhNDkxOWNiYTJjODA4Y2JmMzBhMTk2ODU0NjJmZDYwYzZhMQ==", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2014-08-19T07:57:44Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2014-08-19T07:57:44Z"}, "message": "lto-streamer-out.c (DFS::DFS_write_tree_body): Stream DECL_EXTERNALs in BLOCKs as non-references.\n\n2014-08-19  Richard Biener  <rguenther@suse.de>\n\n\t* lto-streamer-out.c (DFS::DFS_write_tree_body): Stream\n\tDECL_EXTERNALs in BLOCKs as non-references.\n\t* tree-streamer-out.c (streamer_write_chain): Likewise.\n\nFrom-SVN: r214135", "tree": {"sha": "9c3c3f9957eb4b87e7976b5b57d29f4fe6005959", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9c3c3f9957eb4b87e7976b5b57d29f4fe6005959"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/47503a4919cba2c808cbf30a19685462fd60c6a1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/47503a4919cba2c808cbf30a19685462fd60c6a1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/47503a4919cba2c808cbf30a19685462fd60c6a1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/47503a4919cba2c808cbf30a19685462fd60c6a1/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "21c924ac985800859335f088e24b374b29c179b0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/21c924ac985800859335f088e24b374b29c179b0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/21c924ac985800859335f088e24b374b29c179b0"}], "stats": {"total": 22, "additions": 16, "deletions": 6}, "files": [{"sha": "dafc0e5a9888f1efbadea6c7b822f341d9584faa", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/47503a4919cba2c808cbf30a19685462fd60c6a1/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/47503a4919cba2c808cbf30a19685462fd60c6a1/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=47503a4919cba2c808cbf30a19685462fd60c6a1", "patch": "@@ -1,3 +1,9 @@\n+2014-08-19  Richard Biener  <rguenther@suse.de>\n+\n+\t* lto-streamer-out.c (DFS::DFS_write_tree_body): Stream\n+\tDECL_EXTERNALs in BLOCKs as non-references.\n+\t* tree-streamer-out.c (streamer_write_chain): Likewise.\n+\n 2014-08-19  Alexander Ivchenko  <alexander.ivchenko@intel.com>\n \t    Maxim Kuznetsov  <maxim.kuznetsov@intel.com>\n \t    Anna Tikhonova  <anna.tikhonova@intel.com>"}, {"sha": "00a7badd9e7571be60bb79e585bab64c0f535320", "filename": "gcc/lto-streamer-out.c", "status": "modified", "additions": 7, "deletions": 3, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/47503a4919cba2c808cbf30a19685462fd60c6a1/gcc%2Flto-streamer-out.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/47503a4919cba2c808cbf30a19685462fd60c6a1/gcc%2Flto-streamer-out.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flto-streamer-out.c?ref=47503a4919cba2c808cbf30a19685462fd60c6a1", "patch": "@@ -648,9 +648,13 @@ DFS::DFS_write_tree_body (struct output_block *ob,\n   if (CODE_CONTAINS_STRUCT (code, TS_BLOCK))\n     {\n       for (tree t = BLOCK_VARS (expr); t; t = TREE_CHAIN (t))\n-\t/* ???  FIXME.  See also streamer_write_chain.  */\n-\tif (!(VAR_OR_FUNCTION_DECL_P (t)\n-\t      && DECL_EXTERNAL (t)))\n+\tif (VAR_OR_FUNCTION_DECL_P (t)\n+\t    && DECL_EXTERNAL (t))\n+\t  /* We have to stream externals in the block chain as\n+\t     non-references.  See also\n+\t     tree-streamer-out.c:streamer_write_chain.  */\n+\t  DFS_write_tree (ob, expr_state, t, ref_p, false, single_p);\n+\telse\n \t  DFS_follow_tree_edge (t);\n \n       DFS_follow_tree_edge (BLOCK_SUPERCONTEXT (expr));"}, {"sha": "15ad8f8dbf6f3f79f112429e60fc1a9a66a7b2e8", "filename": "gcc/tree-streamer-out.c", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/47503a4919cba2c808cbf30a19685462fd60c6a1/gcc%2Ftree-streamer-out.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/47503a4919cba2c808cbf30a19685462fd60c6a1/gcc%2Ftree-streamer-out.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-streamer-out.c?ref=47503a4919cba2c808cbf30a19685462fd60c6a1", "patch": "@@ -524,11 +524,11 @@ streamer_write_chain (struct output_block *ob, tree t, bool ref_p)\n       /* We avoid outputting external vars or functions by reference\n \t to the global decls section as we do not want to have them\n \t enter decl merging.  This is, of course, only for the call\n-\t for streaming BLOCK_VARS, but other callers are safe.  */\n-      /* ???  FIXME wrt SCC streaming.  Drop these for now.  */\n+\t for streaming BLOCK_VARS, but other callers are safe.\n+\t See also lto-streamer-out.c:DFS_write_tree_body.  */\n       if (VAR_OR_FUNCTION_DECL_P (t)\n \t  && DECL_EXTERNAL (t))\n-\t; /* stream_write_tree_shallow_non_ref (ob, t, ref_p); */\n+\tstream_write_tree_shallow_non_ref (ob, t, ref_p);\n       else\n \tstream_write_tree (ob, t, ref_p);\n "}]}