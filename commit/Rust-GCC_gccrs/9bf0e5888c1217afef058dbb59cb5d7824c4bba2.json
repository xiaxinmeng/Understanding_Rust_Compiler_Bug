{"sha": "9bf0e5888c1217afef058dbb59cb5d7824c4bba2", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWJmMGU1ODg4YzEyMTdhZmVmMDU4ZGJiNTljYjVkNzgyNGM0YmJhMg==", "commit": {"author": {"name": "Volker Reichelt", "email": "reichelt@igpm.rwth-aachen.de", "date": "2004-12-10T16:04:22Z"}, "committer": {"name": "Volker Reichelt", "email": "reichelt@gcc.gnu.org", "date": "2004-12-10T16:04:22Z"}, "message": "re PR c++/18731 (ICE on invalid template declaration)\n\n\tPR c++/18731\n\t* parser.c (cp_parser_class_head): Reject typedef-name in class head.\n\n\t* g++.dg/parser/struct-1.C: New test.\n\t* g++.dg/parser/struct-2.C: New test.\n\t* g++.dg/parser/struct-3.C: New test.\n\nFrom-SVN: r91993", "tree": {"sha": "9de3b8f1275d3a5a4b767de6d6f4b524b720fcf9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9de3b8f1275d3a5a4b767de6d6f4b524b720fcf9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9bf0e5888c1217afef058dbb59cb5d7824c4bba2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9bf0e5888c1217afef058dbb59cb5d7824c4bba2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9bf0e5888c1217afef058dbb59cb5d7824c4bba2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9bf0e5888c1217afef058dbb59cb5d7824c4bba2/comments", "author": null, "committer": null, "parents": [{"sha": "417c735c222642f006a3ab29655bf20664b64f32", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/417c735c222642f006a3ab29655bf20664b64f32", "html_url": "https://github.com/Rust-GCC/gccrs/commit/417c735c222642f006a3ab29655bf20664b64f32"}], "stats": {"total": 42, "additions": 42, "deletions": 0}, "files": [{"sha": "1abbc26e039df6ffbdd6e42da448cab8ae87f21b", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9bf0e5888c1217afef058dbb59cb5d7824c4bba2/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9bf0e5888c1217afef058dbb59cb5d7824c4bba2/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=9bf0e5888c1217afef058dbb59cb5d7824c4bba2", "patch": "@@ -1,3 +1,8 @@\n+2004-12-10  Volker Reichelt  <reichelt@igpm.rwth-aachen.de>\n+\n+\tPR c++/18731\n+\t* parser.c (cp_parser_class_head): Reject typedef-name in class head.\n+\n 2004-12-09  Matt Austern  <austern@apple.com>\n \n \tPR c++/18514"}, {"sha": "b728ad1d1b61ef91e3cb1572d95addf2cfe78c22", "filename": "gcc/cp/parser.c", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9bf0e5888c1217afef058dbb59cb5d7824c4bba2/gcc%2Fcp%2Fparser.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9bf0e5888c1217afef058dbb59cb5d7824c4bba2/gcc%2Fcp%2Fparser.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fparser.c?ref=9bf0e5888c1217afef058dbb59cb5d7824c4bba2", "patch": "@@ -12620,6 +12620,15 @@ cp_parser_class_head (cp_parser* parser,\n   else if (nested_name_specifier)\n     {\n       tree scope;\n+\n+      /* Reject typedef-names in class heads.  */\n+      if (!DECL_IMPLICIT_TYPEDEF_P (type))\n+\t{\n+\t  error (\"invalid class name in declaration of %qD\", type);\n+\t  type = NULL_TREE;\n+\t  goto done;\n+\t}\n+\n       /* Figure out in what scope the declaration is being placed.  */\n       scope = current_scope ();\n       /* If that scope does not contain the scope in which the"}, {"sha": "08e72216bebd64d3e6bacfe4e42dd1dac1382543", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9bf0e5888c1217afef058dbb59cb5d7824c4bba2/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9bf0e5888c1217afef058dbb59cb5d7824c4bba2/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=9bf0e5888c1217afef058dbb59cb5d7824c4bba2", "patch": "@@ -1,3 +1,10 @@\n+2004-12-10  Volker Reichelt  <reichelt@igpm.rwth-aachen.de>\n+\n+\tPR c++/18731\n+\t* g++.dg/parser/struct-1.C: New test.\n+\t* g++.dg/parser/struct-2.C: New test.\n+\t* g++.dg/parser/struct-3.C: New test.\n+\n 2004-12-09  Richard Henderson  <rth@redhat.com>\n \n \t* gcc.dg/loop-3.c: Don't use i386 tuning for amd64."}, {"sha": "6e0d93aadf4a7537e727d70ad410bdd5f2678b26", "filename": "gcc/testsuite/g++.dg/parse/struct-1.C", "status": "added", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9bf0e5888c1217afef058dbb59cb5d7824c4bba2/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Fstruct-1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9bf0e5888c1217afef058dbb59cb5d7824c4bba2/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Fstruct-1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Fstruct-1.C?ref=9bf0e5888c1217afef058dbb59cb5d7824c4bba2", "patch": "@@ -0,0 +1,4 @@\n+// Origin: Volker Reichelt <reichelt@igpm.rwth-aachen.de>\n+// PR c++/18731\n+\n+template<typename T> struct T::A {}; // { dg-error \"invalid class name\" }"}, {"sha": "b63045bf9d6b83ba4e5302fe30d656a26ee8f5db", "filename": "gcc/testsuite/g++.dg/parse/struct-2.C", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9bf0e5888c1217afef058dbb59cb5d7824c4bba2/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Fstruct-2.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9bf0e5888c1217afef058dbb59cb5d7824c4bba2/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Fstruct-2.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Fstruct-2.C?ref=9bf0e5888c1217afef058dbb59cb5d7824c4bba2", "patch": "@@ -0,0 +1,7 @@\n+// Origin: Volker Reichelt <reichelt@igpm.rwth-aachen.de>\n+// PR c++/18731\n+\n+template<typename T> struct A\n+{\n+    struct T::B {}; // { dg-error \"invalid class name\" }\n+};"}, {"sha": "8e73ce4f0195c369c4e33d9ee17f33c88482fac5", "filename": "gcc/testsuite/g++.dg/parse/struct-3.C", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9bf0e5888c1217afef058dbb59cb5d7824c4bba2/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Fstruct-3.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9bf0e5888c1217afef058dbb59cb5d7824c4bba2/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Fstruct-3.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Fstruct-3.C?ref=9bf0e5888c1217afef058dbb59cb5d7824c4bba2", "patch": "@@ -0,0 +1,10 @@\n+// Origin: Volker Reichelt <reichelt@igpm.rwth-aachen.de>\n+// PR c++/18731\n+\n+struct A\n+{\n+    struct B;\n+    typedef B C;\n+};\n+\n+struct A::C {}; // { dg-error \"invalid class name\" }"}]}