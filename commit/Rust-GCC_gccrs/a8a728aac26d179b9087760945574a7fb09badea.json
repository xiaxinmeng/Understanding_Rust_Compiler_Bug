{"sha": "a8a728aac26d179b9087760945574a7fb09badea", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YThhNzI4YWFjMjZkMTc5YjkwODc3NjA5NDU1NzRhN2ZiMDliYWRlYQ==", "commit": {"author": {"name": "Vladimir Makarov", "email": "vmakarov@redhat.com", "date": "2019-12-19T21:59:47Z"}, "committer": {"name": "Vladimir Makarov", "email": "vmakarov@gcc.gnu.org", "date": "2019-12-19T21:59:47Z"}, "message": "re PR target/92905 (Spills float-int union to memory)\n\n2019-12-19  Vladimir Makarov  <vmakarov@redhat.com>\n\n\tPR target/92905\n\t* lra-constraints.c (process_alt_operands): Check offmemok when\n\tprocessing preferred_reload_class.\n\n2019-12-19  Vladimir Makarov  <vmakarov@redhat.com>\n\n\tPR target/92905\n\t* gcc.target/i386/pr92905.c: New test.\n\nFrom-SVN: r279596", "tree": {"sha": "0f836e0eabc09616e277844d7f37fa909c806135", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0f836e0eabc09616e277844d7f37fa909c806135"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a8a728aac26d179b9087760945574a7fb09badea", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a8a728aac26d179b9087760945574a7fb09badea", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a8a728aac26d179b9087760945574a7fb09badea", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a8a728aac26d179b9087760945574a7fb09badea/comments", "author": {"login": "vnmakarov", "id": 9855671, "node_id": "MDQ6VXNlcjk4NTU2NzE=", "avatar_url": "https://avatars.githubusercontent.com/u/9855671?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vnmakarov", "html_url": "https://github.com/vnmakarov", "followers_url": "https://api.github.com/users/vnmakarov/followers", "following_url": "https://api.github.com/users/vnmakarov/following{/other_user}", "gists_url": "https://api.github.com/users/vnmakarov/gists{/gist_id}", "starred_url": "https://api.github.com/users/vnmakarov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vnmakarov/subscriptions", "organizations_url": "https://api.github.com/users/vnmakarov/orgs", "repos_url": "https://api.github.com/users/vnmakarov/repos", "events_url": "https://api.github.com/users/vnmakarov/events{/privacy}", "received_events_url": "https://api.github.com/users/vnmakarov/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "38830e506c4d97d391521249aaf5e942e53e980b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/38830e506c4d97d391521249aaf5e942e53e980b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/38830e506c4d97d391521249aaf5e942e53e980b"}], "stats": {"total": 43, "additions": 38, "deletions": 5}, "files": [{"sha": "1d78e020b198e2fb4a88a7d81f72c40d79a3a132", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a8a728aac26d179b9087760945574a7fb09badea/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a8a728aac26d179b9087760945574a7fb09badea/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=a8a728aac26d179b9087760945574a7fb09badea", "patch": "@@ -1,3 +1,9 @@\n+2019-12-19  Vladimir Makarov  <vmakarov@redhat.com>\n+\n+\tPR target/92905\n+\t* lra-constraints.c (process_alt_operands): Check offmemok when\n+\tprocessing preferred_reload_class.\n+\n 2019-12-19  Andrew Stubbs  <ams@codesourcery.com>\n \n \t* config/gcn/gcn-valu.md"}, {"sha": "a5b4eefa60ea1cd3cd77581594410c934f80fd3b", "filename": "gcc/lra-constraints.c", "status": "modified", "additions": 18, "deletions": 5, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a8a728aac26d179b9087760945574a7fb09badea/gcc%2Flra-constraints.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a8a728aac26d179b9087760945574a7fb09badea/gcc%2Flra-constraints.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flra-constraints.c?ref=a8a728aac26d179b9087760945574a7fb09badea", "patch": "@@ -2722,11 +2722,24 @@ process_alt_operands (int only_alternative)\n \t\t\t  && (targetm.preferred_output_reload_class\n \t\t\t      (op, this_alternative) == NO_REGS))))\n \t\t{\n-\t\t  if (lra_dump_file != NULL)\n-\t\t    fprintf (lra_dump_file,\n-\t\t\t     \"            %d Non-prefered reload: reject+=%d\\n\",\n-\t\t\t     nop, LRA_MAX_REJECT);\n-\t\t  reject += LRA_MAX_REJECT;\n+\t\t  if (offmemok && REG_P (op))\n+\t\t    {\n+\t\t      if (lra_dump_file != NULL)\n+\t\t\tfprintf\n+\t\t\t  (lra_dump_file,\n+\t\t\t   \"            %d Spill pseudo into memory: reject+=3\\n\",\n+\t\t\t   nop);\n+\t\t      reject += 3;\n+\t\t    }\n+\t\t  else\n+\t\t    {\n+\t\t      if (lra_dump_file != NULL)\n+\t\t\tfprintf\n+\t\t\t  (lra_dump_file,\n+\t\t\t   \"            %d Non-prefered reload: reject+=%d\\n\",\n+\t\t\t   nop, LRA_MAX_REJECT);\n+\t\t      reject += LRA_MAX_REJECT;\n+\t\t    }\n \t\t}\n \n \t      if (! (MEM_P (op) && offmemok)"}, {"sha": "5dfb3ec4ec2c569188ca833953f4bd9cabbdb570", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a8a728aac26d179b9087760945574a7fb09badea/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a8a728aac26d179b9087760945574a7fb09badea/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=a8a728aac26d179b9087760945574a7fb09badea", "patch": "@@ -1,3 +1,8 @@\n+2019-12-19  Vladimir Makarov  <vmakarov@redhat.com>\n+\n+\tPR target/92905\n+\t* gcc.target/i386/pr92905.c: New test.\n+\n 2019-12-19  Richard Sandiford  <richard.sandiford@arm.com>\n \n \t* g++.dg/ext/sve-sizeless-2.C: Don't expect an error for"}, {"sha": "672ba8ee48aa67dde0ce1f1e4df52e4b9d9dc184", "filename": "gcc/testsuite/gcc.target/i386/pr92905.c", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a8a728aac26d179b9087760945574a7fb09badea/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr92905.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a8a728aac26d179b9087760945574a7fb09badea/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr92905.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr92905.c?ref=a8a728aac26d179b9087760945574a7fb09badea", "patch": "@@ -0,0 +1,9 @@\n+/* { dg-do compile { target { lp64 } } } */\n+/* { dg-options \"-O2 -mtune=intel\" } */\n+float f(float x)\n+{\n+    union {float f; unsigned i;} u = {x};\n+    u.i |= 0x80000000;\n+    return u.f;\n+}\n+/* { dg-final { scan-assembler-not \"rsp\"} } */"}]}