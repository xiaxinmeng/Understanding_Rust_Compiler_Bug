{"sha": "8ff25a2279081ff24df5ddff9b76b500b75ec03b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OGZmMjVhMjI3OTA4MWZmMjRkZjVkZGZmOWI3NmI1MDBiNzVlYzAzYg==", "commit": {"author": {"name": "Paolo Carlini", "email": "paolo.carlini@oracle.com", "date": "2013-05-15T16:10:22Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2013-05-15T16:10:22Z"}, "message": "re PR c++/31952 (parameters may be redeclared in a function try-block)\n\n/cp\n2013-05-15  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/31952\n\t* name-lookup.c (pushdecl_maybe_friend_1): Diagnose illegal\n\tredeclarations.\n\n/testsuite\n2013-05-15  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/31952\n\t* g++.dg/parse/pr31952-1.C: New.\n\t* g++.dg/parse/pr31952-2.C: Likewise.\n\t* g++.dg/parse/pr31952-3.C: Likewise.\n\n\t* g++.dg/parse/pr18770.C: Adjust dg-errors to dg-messages.\n\t* g++.old-deja/g++.jason/cond.C: Likewise.\n\t* g++.dg/cpp0x/range-for5.C: Likewise.\n\nFrom-SVN: r198939", "tree": {"sha": "ebc82354262263db18dd487af08e8f0384b840bb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ebc82354262263db18dd487af08e8f0384b840bb"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8ff25a2279081ff24df5ddff9b76b500b75ec03b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8ff25a2279081ff24df5ddff9b76b500b75ec03b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8ff25a2279081ff24df5ddff9b76b500b75ec03b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8ff25a2279081ff24df5ddff9b76b500b75ec03b/comments", "author": null, "committer": null, "parents": [{"sha": "ad4db775e2c6fb42129048c0de213fa6f1cd98e3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ad4db775e2c6fb42129048c0de213fa6f1cd98e3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ad4db775e2c6fb42129048c0de213fa6f1cd98e3"}], "stats": {"total": 181, "additions": 169, "deletions": 12}, "files": [{"sha": "cf91769b72f6a9cd9165b215847f8ba5f42060fb", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8ff25a2279081ff24df5ddff9b76b500b75ec03b/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8ff25a2279081ff24df5ddff9b76b500b75ec03b/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=8ff25a2279081ff24df5ddff9b76b500b75ec03b", "patch": "@@ -1,3 +1,9 @@\n+2013-05-15  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/31952\n+\t* name-lookup.c (pushdecl_maybe_friend_1): Diagnose illegal\n+\tredeclarations.\n+\n 2013-05-14  Jason Merrill  <jason@redhat.com>\n \n \tPR c++/57243"}, {"sha": "a60504fafdfef610b559d35fd82b430ce316edd4", "filename": "gcc/cp/name-lookup.c", "status": "modified", "additions": 26, "deletions": 1, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8ff25a2279081ff24df5ddff9b76b500b75ec03b/gcc%2Fcp%2Fname-lookup.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8ff25a2279081ff24df5ddff9b76b500b75ec03b/gcc%2Fcp%2Fname-lookup.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fname-lookup.c?ref=8ff25a2279081ff24df5ddff9b76b500b75ec03b", "patch": "@@ -1131,7 +1131,32 @@ pushdecl_maybe_friend_1 (tree x, bool is_friend)\n \t\t\t   || oldscope->kind == sk_for))\n \t\t{\n \t\t  error (\"redeclaration of %q#D\", x);\n-\t\t  error (\"%q+#D previously declared here\", oldlocal);\n+\t\t  inform (input_location, \"%q+#D previously declared here\",\n+\t\t\t  oldlocal);\n+\t\t  nowarn = true;\n+\t\t}\n+\t      /* C++11:\n+\t\t 3.3.3/3:  The name declared in an exception-declaration (...)\n+\t\t shall not be redeclared in the outermost block of the handler.\n+\t\t 3.3.3/2:  A parameter name shall not be redeclared (...) in\n+\t\t the outermost block of any handler associated with a\n+\t\t function-try-block.\n+\t\t 3.4.1/15: The function parameter names shall not be redeclared\n+\t\t in the exception-declaration nor in the outermost block of a\n+\t\t handler for the function-try-block.  */\n+\t      else if ((VAR_P (oldlocal)\n+\t\t\t&& oldscope == current_binding_level->level_chain\n+\t\t\t&& oldscope->kind == sk_catch)\n+\t\t       || (TREE_CODE (oldlocal) == PARM_DECL\n+\t\t\t   && (current_binding_level->kind == sk_catch\n+\t\t\t       || (current_binding_level->level_chain->kind\n+\t\t\t\t   == sk_catch))\n+\t\t\t   && in_function_try_handler))\n+\t\t{\n+\t\t  if (permerror (input_location, \"redeclaration of %q#D\", x))\n+\t\t    inform (input_location, \"%q+#D previously declared here\",\n+\t\t\t    oldlocal);\n+\t\t  nowarn = true;\n \t\t}\n \n \t      if (warn_shadow && !nowarn)"}, {"sha": "55315f49faa627d324bd5a8244bb528260928a38", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8ff25a2279081ff24df5ddff9b76b500b75ec03b/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8ff25a2279081ff24df5ddff9b76b500b75ec03b/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=8ff25a2279081ff24df5ddff9b76b500b75ec03b", "patch": "@@ -1,3 +1,14 @@\n+2013-05-15  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/31952\n+\t* g++.dg/parse/pr31952-1.C: New.\n+\t* g++.dg/parse/pr31952-2.C: Likewise.\n+\t* g++.dg/parse/pr31952-3.C: Likewise.\n+\n+\t* g++.dg/parse/pr18770.C: Adjust dg-errors to dg-messages.\n+\t* g++.old-deja/g++.jason/cond.C: Likewise.\n+\t* g++.dg/cpp0x/range-for5.C: Likewise.\n+\n 2013-05-15  Ramana Radhakrishnan  <ramana.radhakrishnan@arm.com>\n \n \tPR target/19599"}, {"sha": "04754b780e68a5845bbdd77831f9d2f3a8ca1d9c", "filename": "gcc/testsuite/g++.dg/cpp0x/range-for5.C", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8ff25a2279081ff24df5ddff9b76b500b75ec03b/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Frange-for5.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8ff25a2279081ff24df5ddff9b76b500b75ec03b/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Frange-for5.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Frange-for5.C?ref=8ff25a2279081ff24df5ddff9b76b500b75ec03b", "patch": "@@ -47,7 +47,7 @@ void test1()\n \n   //Check the correct scopes\n   int i;\n-  for (int i : a)\t\t// { dg-error \"previously declared\" }\n+  for (int i : a)\t\t// { dg-message \"previously declared\" }\n   {\n     int i;\t\t\t// { dg-error \"redeclaration\" }\n   }"}, {"sha": "71d95e331134ac01b64a985c582a28f791fb1c7b", "filename": "gcc/testsuite/g++.dg/parse/pr18770.C", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8ff25a2279081ff24df5ddff9b76b500b75ec03b/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Fpr18770.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8ff25a2279081ff24df5ddff9b76b500b75ec03b/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Fpr18770.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Fpr18770.C?ref=8ff25a2279081ff24df5ddff9b76b500b75ec03b", "patch": "@@ -11,7 +11,7 @@ extern int j;\n void\n e0 (void)\n {\n-  for (int i = 0;\t// { dg-error \"previously declared here\" \"prev\" }\n+  for (int i = 0;\t// { dg-message \"previously declared here\" \"prev\" }\n        i < 10; ++i)\n     {\n       int i = 2;\t// { dg-error \"redeclaration\" \"redecl\" }\n@@ -24,7 +24,7 @@ e1 (void)\n {\n   int i;\n   for (i = 0;\n-       int k = j; i++)\t// { dg-error \"previously declared here\" \"prev\" }\n+       int k = j; i++)\t// { dg-message \"previously declared here\" \"prev\" }\n     {\n       int k = 2;\t// { dg-error \"redeclaration\" \"redecl\" }\n       foo (k);\n@@ -34,7 +34,7 @@ e1 (void)\n void\n e2 (void)\n {\n-  if (int i = 1)\t// { dg-error \"previously declared here\" \"prev\" }\n+  if (int i = 1)\t// { dg-message \"previously declared here\" \"prev\" }\n     {\n       int i = 2;\t// { dg-error \"redeclaration\" \"redecl\" }\n       foo (i);\n@@ -44,7 +44,7 @@ e2 (void)\n void\n e3 (void)\n {\n-  if (int i = 1)\t// { dg-error \"previously declared here\" \"prev\" }\n+  if (int i = 1)\t// { dg-message \"previously declared here\" \"prev\" }\n     {\n       foo (i);\n     }\n@@ -58,7 +58,7 @@ e3 (void)\n void\n e4 (void)\n {\n-  while (int i = 1)\t// { dg-error \"previously declared here\" \"prev\" }\n+  while (int i = 1)\t// { dg-message \"previously declared here\" \"prev\" }\n     {\n       int i = 2;\t// { dg-error \"redeclaration\" \"redecl\" }\n       foo (i);\n@@ -68,7 +68,7 @@ e4 (void)\n void\n e5 (void)\n {\n-  switch (int i = j)\t// { dg-error \"previously declared here\" \"prev\" }\n+  switch (int i = j)\t// { dg-message \"previously declared here\" \"prev\" }\n     {\n     int i;\t\t// { dg-error \"redeclaration\" \"redecl\" }\n     default:"}, {"sha": "aad3a11a77deaf047d2971d81dbcf925badf106b", "filename": "gcc/testsuite/g++.dg/parse/pr31952-1.C", "status": "added", "additions": 41, "deletions": 0, "changes": 41, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8ff25a2279081ff24df5ddff9b76b500b75ec03b/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Fpr31952-1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8ff25a2279081ff24df5ddff9b76b500b75ec03b/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Fpr31952-1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Fpr31952-1.C?ref=8ff25a2279081ff24df5ddff9b76b500b75ec03b", "patch": "@@ -0,0 +1,41 @@\n+// PR c++/31952\n+\n+int\n+f0 (int bar)  // { dg-message \"previously\" }\n+try\n+{\n+  return 0;\n+}\n+catch (...)\n+{\n+  int bar = 0; // { dg-error \"redeclaration\" }\n+  return 1;\n+}\n+\n+int\n+f1 (int bar)\n+try\n+{\n+  return 0;\n+}\n+catch (...)\n+{\n+  {\n+    int bar = 0; // Ok, not outermost block.\n+  }\n+  return 1;\n+}\n+\n+int\n+f2 (int bar)\n+{\n+  try\n+    {\n+      return 0;\n+    }\n+  catch (...)\n+    {\n+      int bar = 0; // Ok, not a function-try-block.\n+      return 1;\n+    }\n+}"}, {"sha": "f09bcab1b85206402c222425150db5786a6e594a", "filename": "gcc/testsuite/g++.dg/parse/pr31952-2.C", "status": "added", "additions": 49, "deletions": 0, "changes": 49, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8ff25a2279081ff24df5ddff9b76b500b75ec03b/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Fpr31952-2.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8ff25a2279081ff24df5ddff9b76b500b75ec03b/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Fpr31952-2.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Fpr31952-2.C?ref=8ff25a2279081ff24df5ddff9b76b500b75ec03b", "patch": "@@ -0,0 +1,49 @@\n+// PR c++/31952\n+\n+void\n+f0()\n+{\n+  try\n+  {\n+  }\n+  catch (void *e)  // { dg-message \"previously\" }\n+  {\n+    void *e;       // { dg-error \"redeclaration\" }\n+  }\n+}\n+\n+void\n+f1()\n+{\n+  try\n+  {\n+  }\n+  catch (void *e)\n+  {\n+    {\n+      void *e; // Ok, not outermost block.\n+    }\n+  }\n+}\n+\n+void\n+f2()\n+try\n+{\n+}\n+catch (void *e)  // { dg-message \"previously\" }\n+{\n+  void *e;       // { dg-error \"redeclaration\" }\n+}\n+\n+void\n+f3()\n+try\n+{\n+}\n+catch (void *e)\n+{\n+  {\n+    void *e; // Ok, not outermost block.\n+  }\n+}"}, {"sha": "9fe5f02837860693c243a602a44518cc8ba8d348", "filename": "gcc/testsuite/g++.dg/parse/pr31952-3.C", "status": "added", "additions": 25, "deletions": 0, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8ff25a2279081ff24df5ddff9b76b500b75ec03b/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Fpr31952-3.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8ff25a2279081ff24df5ddff9b76b500b75ec03b/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Fpr31952-3.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Fpr31952-3.C?ref=8ff25a2279081ff24df5ddff9b76b500b75ec03b", "patch": "@@ -0,0 +1,25 @@\n+// PR c++/31952\n+\n+int\n+f0 (int bar)     // { dg-message \"previously\" }\n+try\n+{\n+  return 0;\n+}\n+catch (int bar)  // { dg-error \"redeclaration\" }\n+{\n+  return 1;\n+}\n+\n+int\n+f1 (int bar)\n+{\n+  try\n+  {\n+    return 0;\n+  }\n+  catch (int bar)  // Ok, not a function-try-block.\n+  {\n+    return 1;\n+  }\n+}"}, {"sha": "925d8635c1e9c19aee8834d91908f2eefe34007d", "filename": "gcc/testsuite/g++.old-deja/g++.jason/cond.C", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8ff25a2279081ff24df5ddff9b76b500b75ec03b/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.jason%2Fcond.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8ff25a2279081ff24df5ddff9b76b500b75ec03b/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.jason%2Fcond.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.jason%2Fcond.C?ref=8ff25a2279081ff24df5ddff9b76b500b75ec03b", "patch": "@@ -6,7 +6,7 @@ int main()\n {\n   float i;\n   \n-  if (int i = 1)\t\t// { dg-error \"previously\" }\n+  if (int i = 1)\t\t// { dg-message \"previously\" }\n     {\n       char i;\t\t\t// { dg-error \"redeclaration\" } \n       char j;\n@@ -17,17 +17,17 @@ int main()\n       char j;\n     }\n \n-  while (int i = 0)\t\t// { dg-error \"previously\" }\n+  while (int i = 0)\t\t// { dg-message \"previously\" }\n     {\n       int i;\t\t\t// { dg-error \"redeclaration\" }\n     }\n \n-  for (; int i = 0; )\t\t// { dg-error \"previously\" }\n+  for (; int i = 0; )\t\t// { dg-message \"previously\" }\n     {\n       int i;\t\t\t// { dg-error \"redeclaration\" }\n     }\n \n-  switch (int i = 0)\t\t// { dg-error \"previously\" }\n+  switch (int i = 0)\t\t// { dg-message \"previously\" }\n     {\n     default:\n       int i;\t\t\t// { dg-error \"redeclaration\" } "}]}