{"sha": "c4499192638ad901fc03021834eec60399bfa736", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzQ0OTkxOTI2MzhhZDkwMWZjMDMwMjE4MzRlZWM2MDM5OWJmYTczNg==", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2019-05-17T12:04:21Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2019-05-17T12:04:21Z"}, "message": "gimple-parser.c (c_parser_gimple_statement): Handle __VEC_PERM.\n\n2019-05-17  Richard Biener  <rguenther@suse.de>\n\n\tc/\n\t* gimple-parser.c (c_parser_gimple_statement): Handle __VEC_PERM.\n\t(c_parser_gimple_unary_expression): Likewise.\n\t(c_parser_gimple_parentized_ternary_expression): New function.\n\n\t* gimple-pretty-print.c (dump_ternary_rhs): Handle dumping\n\tVEC_PERM_EXPR as __VEC_PERM with -gimple.\n\n\t* gcc.dg/gimplefe-41.c: New testcase.\n\nFrom-SVN: r271320", "tree": {"sha": "86dff9166726cc0e075dfa26d8dd8072a903c3d3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/86dff9166726cc0e075dfa26d8dd8072a903c3d3"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c4499192638ad901fc03021834eec60399bfa736", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c4499192638ad901fc03021834eec60399bfa736", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c4499192638ad901fc03021834eec60399bfa736", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c4499192638ad901fc03021834eec60399bfa736/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "35ee7f54686d7cba0feb5c1750ae4071db252000", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/35ee7f54686d7cba0feb5c1750ae4071db252000", "html_url": "https://github.com/Rust-GCC/gccrs/commit/35ee7f54686d7cba0feb5c1750ae4071db252000"}], "stats": {"total": 102, "additions": 99, "deletions": 3}, "files": [{"sha": "16b67c49da818f8bc42ec3c066fbbca90e90fd87", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c4499192638ad901fc03021834eec60399bfa736/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c4499192638ad901fc03021834eec60399bfa736/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=c4499192638ad901fc03021834eec60399bfa736", "patch": "@@ -1,3 +1,8 @@\n+2019-05-17  Richard Biener  <rguenther@suse.de>\n+\n+\t* gimple-pretty-print.c (dump_ternary_rhs): Handle dumping\n+\tVEC_PERM_EXPR as __VEC_PERM with -gimple.\n+\n 2019-05-17  Andreas Krebbel  <krebbel@linux.ibm.com>\n \n \t* config/s390/s390-builtins.def (s390_vec_sldw_*): Use the"}, {"sha": "863fabfffdd032ea06a526fd7db2bf659de71883", "filename": "gcc/c/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c4499192638ad901fc03021834eec60399bfa736/gcc%2Fc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c4499192638ad901fc03021834eec60399bfa736/gcc%2Fc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc%2FChangeLog?ref=c4499192638ad901fc03021834eec60399bfa736", "patch": "@@ -1,3 +1,9 @@\n+2019-05-17  Richard Biener  <rguenther@suse.de>\n+\n+\t* gimple-parser.c (c_parser_gimple_statement): Handle __VEC_PERM.\n+\t(c_parser_gimple_unary_expression): Likewise.\n+\t(c_parser_gimple_parentized_ternary_expression): New function.\n+\n 2019-05-16  Richard Biener  <rguenther@suse.de>\n \n \t* gimple-parser.c (c_parser_gimple_statement): Handle __BIT_INSERT."}, {"sha": "275ad911d0867db570e1d14e179d1c50f73b1f79", "filename": "gcc/c/gimple-parser.c", "status": "modified", "additions": 37, "deletions": 1, "changes": 38, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c4499192638ad901fc03021834eec60399bfa736/gcc%2Fc%2Fgimple-parser.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c4499192638ad901fc03021834eec60399bfa736/gcc%2Fc%2Fgimple-parser.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc%2Fgimple-parser.c?ref=c4499192638ad901fc03021834eec60399bfa736", "patch": "@@ -746,8 +746,9 @@ c_parser_gimple_statement (gimple_parser &parser, gimple_seq *seq)\n \tif (strcmp (IDENTIFIER_POINTER (id), \"__ABS\") == 0\n \t    || strcmp (IDENTIFIER_POINTER (id), \"__ABSU\") == 0\n \t    || strcmp (IDENTIFIER_POINTER (id), \"__MIN\") == 0\n+\t    || strcmp (IDENTIFIER_POINTER (id), \"__MAX\") == 0\n \t    || strcmp (IDENTIFIER_POINTER (id), \"__BIT_INSERT\") == 0\n-\t    || strcmp (IDENTIFIER_POINTER (id), \"__MAX\") == 0)\n+\t    || strcmp (IDENTIFIER_POINTER (id), \"__VEC_PERM\") == 0)\n \t  goto build_unary_expr;\n \tbreak;\n       }\n@@ -1012,6 +1013,38 @@ c_parser_gimple_parentized_binary_expression (gimple_parser &parser,\n   return ret;\n }\n \n+/* Parse a gimple parentized binary expression.  */\n+\n+static c_expr\n+c_parser_gimple_parentized_ternary_expression (gimple_parser &parser,\n+\t\t\t\t\t       location_t op_loc,\n+\t\t\t\t\t       tree_code code)\n+{\n+  struct c_expr ret;\n+  ret.set_error ();\n+\n+  c_parser_consume_token (parser);\n+  if (!c_parser_require (parser, CPP_OPEN_PAREN, \"expected %<(%>\"))\n+    return ret;\n+  c_expr op1 = c_parser_gimple_postfix_expression (parser);\n+  if (!c_parser_require (parser, CPP_COMMA, \"expected %<,%>\"))\n+    return ret;\n+  c_expr op2 = c_parser_gimple_postfix_expression (parser);\n+  if (!c_parser_require (parser, CPP_COMMA, \"expected %<)%>\"))\n+    return ret;\n+  c_expr op3 = c_parser_gimple_postfix_expression (parser);\n+  if (!c_parser_require (parser, CPP_CLOSE_PAREN, \"expected %<)%>\"))\n+    return ret;\n+\n+  if (op1.value != error_mark_node\n+      && op2.value != error_mark_node\n+      && op3.value != error_mark_node)\n+    ret.value = build3_loc (op_loc,\n+\t\t\t    code, TREE_TYPE (op1.value),\n+\t\t\t    op1.value, op2.value, op3.value);\n+  return ret;\n+}\n+\n /* Parse gimple unary expression.\n \n    gimple-unary-expression:\n@@ -1109,6 +1142,9 @@ c_parser_gimple_unary_expression (gimple_parser &parser)\n \t    return c_parser_gimple_parentized_binary_expression (parser,\n \t\t\t\t\t\t\t\t op_loc,\n \t\t\t\t\t\t\t\t MAX_EXPR);\n+\t  else if (strcmp (IDENTIFIER_POINTER (id), \"__VEC_PERM\") == 0)\n+\t    return c_parser_gimple_parentized_ternary_expression\n+\t\t\t(parser, op_loc, VEC_PERM_EXPR);\n \t  else if (strcmp (IDENTIFIER_POINTER (id), \"__BIT_INSERT\") == 0)\n \t    {\n \t      /* __BIT_INSERT '(' postfix-expression, postfix-expression,"}, {"sha": "10f79ea619e3ebfdcbe9f5159e174cf2bb08b7d8", "filename": "gcc/gimple-pretty-print.c", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c4499192638ad901fc03021834eec60399bfa736/gcc%2Fgimple-pretty-print.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c4499192638ad901fc03021834eec60399bfa736/gcc%2Fgimple-pretty-print.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgimple-pretty-print.c?ref=c4499192638ad901fc03021834eec60399bfa736", "patch": "@@ -529,13 +529,19 @@ dump_ternary_rhs (pretty_printer *buffer, gassign *gs, int spc,\n       break;\n     \n     case VEC_PERM_EXPR:\n-      pp_string (buffer, \"VEC_PERM_EXPR <\");\n+      if (flags & TDF_GIMPLE)\n+\tpp_string (buffer, \"__VEC_PERM (\");\n+      else\n+\tpp_string (buffer, \"VEC_PERM_EXPR <\");\n       dump_generic_node (buffer, gimple_assign_rhs1 (gs), spc, flags, false);\n       pp_string (buffer, \", \");\n       dump_generic_node (buffer, gimple_assign_rhs2 (gs), spc, flags, false);\n       pp_string (buffer, \", \");\n       dump_generic_node (buffer, gimple_assign_rhs3 (gs), spc, flags, false);\n-      pp_greater (buffer);\n+      if (flags & TDF_GIMPLE)\n+\tpp_right_paren (buffer);\n+      else\n+\tpp_greater (buffer);\n       break;\n \n     case REALIGN_LOAD_EXPR:"}, {"sha": "650c25a89e52b41adb3c7dba814bfeefe9fdbb82", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c4499192638ad901fc03021834eec60399bfa736/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c4499192638ad901fc03021834eec60399bfa736/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=c4499192638ad901fc03021834eec60399bfa736", "patch": "@@ -1,3 +1,7 @@\n+2019-05-17  Richard Biener  <rguenther@suse.de>\n+\n+\t* gcc.dg/gimplefe-41.c: New testcase.\n+\n 2019-05-17  Jun Ma  <JunMa@linux.alibaba.com>\n \n \tPR tree-optimization/90106"}, {"sha": "cd642d68fd0f0eb91aae649fe95d41dfbbcb064f", "filename": "gcc/testsuite/gcc.dg/gimplefe-41.c", "status": "added", "additions": 39, "deletions": 0, "changes": 39, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c4499192638ad901fc03021834eec60399bfa736/gcc%2Ftestsuite%2Fgcc.dg%2Fgimplefe-41.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c4499192638ad901fc03021834eec60399bfa736/gcc%2Ftestsuite%2Fgcc.dg%2Fgimplefe-41.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fgimplefe-41.c?ref=c4499192638ad901fc03021834eec60399bfa736", "patch": "@@ -0,0 +1,39 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-fgimple -Wno-psabi -w\" } */\n+\n+typedef double __v2df __attribute__ ((__vector_size__ (16)));\n+typedef unsigned long __v2di __attribute__ ((__vector_size__ (16)));\n+\n+__v2df __GIMPLE (ssa)\n+_mm_add_sd (__v2df x, __v2df y)\n+{\n+  __v2df z;\n+  double _1;\n+  double _2;\n+  double _3;\n+  __v2df _7;\n+\n+  __BB(2):\n+  _1 = __BIT_FIELD_REF <double> (x_4(D), 64u, 0u);\n+  _2 = __BIT_FIELD_REF <double> (y_5(D), 64u, 0u);\n+  _3 = _1 + _2;\n+  _7 = _Literal (__v2df) {_3, _3};\n+  z_6 = __VEC_PERM (x_4(D), _7, _Literal (__v2di) { 2ul, 1ul });\n+  return z_6;\n+}\n+\n+__v2df __GIMPLE (ssa)\n+_mm_add_sd2 (__v2df x, __v2df y)\n+{\n+  __v2df z;\n+  double _1;\n+  double _2;\n+  double _3;\n+\n+  __BB(2):\n+  _1 = __BIT_FIELD_REF <double> (x_4(D), 64u, 0u);\n+  _2 = __BIT_FIELD_REF <double> (y_5(D), 64u, 0u);\n+  _3 = _1 + _2;\n+  z_6 = __BIT_INSERT (x_4(D), _3, 0);\n+  return z_6;\n+}"}]}