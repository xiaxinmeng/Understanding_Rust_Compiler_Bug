{"sha": "59e2c378c2f9319e9dea14b09a9d3cdd29d2c0cc", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTllMmMzNzhjMmY5MzE5ZTlkZWExNGIwOWE5ZDNjZGQyOWQyYzBjYw==", "commit": {"author": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1994-08-07T12:53:44Z"}, "committer": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1994-08-07T12:53:44Z"}, "message": "(eliminate_regs, case SUBREG): Add USE of pseudo so we don't\nimproperly delete an output reload.\n\nFrom-SVN: r7869", "tree": {"sha": "0f774a1c4502a34caa4243f328eb4d55b62ee186", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0f774a1c4502a34caa4243f328eb4d55b62ee186"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/59e2c378c2f9319e9dea14b09a9d3cdd29d2c0cc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/59e2c378c2f9319e9dea14b09a9d3cdd29d2c0cc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/59e2c378c2f9319e9dea14b09a9d3cdd29d2c0cc", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/59e2c378c2f9319e9dea14b09a9d3cdd29d2c0cc/comments", "author": null, "committer": null, "parents": [{"sha": "486d850940b886d03a7be2c525a9cc80f90c669c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/486d850940b886d03a7be2c525a9cc80f90c669c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/486d850940b886d03a7be2c525a9cc80f90c669c"}], "stats": {"total": 17, "additions": 13, "deletions": 4}, "files": [{"sha": "9223c217553819b2f91e81b796474f802ae7c3f1", "filename": "gcc/reload1.c", "status": "modified", "additions": 13, "deletions": 4, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/59e2c378c2f9319e9dea14b09a9d3cdd29d2c0cc/gcc%2Freload1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/59e2c378c2f9319e9dea14b09a9d3cdd29d2c0cc/gcc%2Freload1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Freload1.c?ref=59e2c378c2f9319e9dea14b09a9d3cdd29d2c0cc", "patch": "@@ -2886,11 +2886,20 @@ eliminate_regs (x, mem_mode, insn)\n \n \t  /* If we didn't change anything, we must retain the pseudo.  */\n \t  if (new == reg_equiv_memory_loc[REGNO (SUBREG_REG (x))])\n-\t    new = XEXP (x, 0);\n+\t    new = SUBREG_REG (x);\n \t  else\n-\t    /* Otherwise, ensure NEW isn't shared in case we have to reload\n-\t       it.  */\n-\t    new = copy_rtx (new);\n+\t    {\n+\t      /* Otherwise, ensure NEW isn't shared in case we have to reload\n+\t\t it.  */\n+\t      new = copy_rtx (new);\n+\n+\t      /* In this case, we must show that the pseudo is used in this\n+\t\t insn so that delete_output_reload will do the right thing.  */\n+\t      if (insn != 0 && GET_CODE (insn) != EXPR_LIST\n+\t\t  && GET_CODE (insn) != INSN_LIST)\n+\t\temit_insn_before (gen_rtx (USE, VOIDmode, SUBREG_REG (x)),\n+\t\t\t\t  insn);\n+\t    }\n \t}\n       else\n \tnew = eliminate_regs (SUBREG_REG (x), mem_mode, insn);"}]}