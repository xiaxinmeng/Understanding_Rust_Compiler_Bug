{"sha": "a0effa2858914b2b6fd030df33e26ba0aabc327d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTBlZmZhMjg1ODkxNGIyYjZmZDAzMGRmMzNlMjZiYTBhYWJjMzI3ZA==", "commit": {"author": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1997-06-27T23:36:18Z"}, "committer": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1997-06-27T23:36:18Z"}, "message": "(libobjc_entry.o, libobjc_s.a, libobjc.dll): New targets.\n\n(objc.install-normal): Install Objective-C runtime as a DLL.\n(objc.mostlyclean): Clean up files used to build DLL.\n\nFrom-SVN: r14358", "tree": {"sha": "7e9f9cb265a4d42ce171f87ae5dba9a66c5cace3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7e9f9cb265a4d42ce171f87ae5dba9a66c5cace3"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a0effa2858914b2b6fd030df33e26ba0aabc327d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a0effa2858914b2b6fd030df33e26ba0aabc327d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a0effa2858914b2b6fd030df33e26ba0aabc327d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a0effa2858914b2b6fd030df33e26ba0aabc327d/comments", "author": null, "committer": null, "parents": [{"sha": "b63b5db5c7652b53ba4a840d22220867c880f68f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b63b5db5c7652b53ba4a840d22220867c880f68f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b63b5db5c7652b53ba4a840d22220867c880f68f"}], "stats": {"total": 40, "additions": 37, "deletions": 3}, "files": [{"sha": "fd6e80b1b2a762f7dd68840e5ed8c02c019261d6", "filename": "gcc/objc/Make-lang.in", "status": "modified", "additions": 37, "deletions": 3, "changes": 40, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a0effa2858914b2b6fd030df33e26ba0aabc327d/gcc%2Fobjc%2FMake-lang.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a0effa2858914b2b6fd030df33e26ba0aabc327d/gcc%2Fobjc%2FMake-lang.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fobjc%2FMake-lang.in?ref=a0effa2858914b2b6fd030df33e26ba0aabc327d", "patch": "@@ -179,6 +179,9 @@ objc/nil_method.o: $(srcdir)/objc/nil_method.c\n objc/linking.o: $(srcdir)/objc/linking.m\n \t$(GCC_FOR_TARGET) $(GCC_CFLAGS) $(INCLUDES) \\\n \t-c $(srcdir)/objc/linking.m -o $@\n+$(srcdir)/objc/libobjc_entry.o: $(srcdir)/objc/libobjc_entry.c\n+\t$(GCC_FOR_TARGET) $(GCC_CFLAGS) $(INCLUDES) \\\n+\t-c $(srcdir)/objc/libobjc_entry.c -o $@\n \n # Build the Objective C runtime library.\n libobjc.a: cc1obj specs stmp-int-hdrs libgcc2.ready \\\n@@ -187,6 +190,27 @@ libobjc.a: cc1obj specs stmp-int-hdrs libgcc2.ready \\\n \t$(AR) $(AR_FLAGS) libobjc.a $(OBJC_O)\n \t-if $(RANLIB_TEST) ; then $(RANLIB) libobjc.a; else true; fi\n \n+libobjc_s.a: libobjc.a\n+\tmv libobjc.a libobjc_s.a\n+\n+# Create a relocatable DLL\n+libobjc.dll: libobjc_s.a $(srcdir)/objc/libobjc_entry.o\n+\t$(GCC_FOR_TARGET) -dll -Wl,--base-file -Wl,libobjc.base \\\n+\t\t-o libobjc.dll libobjc_s.a \\\n+\t\t$(srcdir)/objc/libobjc_entry.o -lkernel32\n+\t$(DLLTOOL) --dllname libobjc.dll --def $(srcdir)/objc/libobjc.def \\\n+\t\t--base-file libobjc.base --output-exp libobjc.exp\n+\t$(GCC_FOR_TARGET) -dll -Wl,--base-file libobjc.base libobjc.exp \\\n+\t\t-o libobjc.dll libobjc_s.a \\\n+\t\t$(srcdir)/objc/libobjc_entry.o -lkernel32\n+\t$(DLLTOOL) --dllname libobjc.dll --def $(srcdir)/objc/libobjc.def \\\n+\t\t--base-file libobjc.base --output-exp libobjc.exp\n+\t$(GCC_FOR_TARGET) libobjc.exp -dll \\\n+\t\t-o libobjc.dll libobjc_s.a \\\n+\t\t$(srcdir)/objc/libobjc_entry.o -lkernel32\n+\t$(DLLTOOL) --dllname libobjc.dll --def $(srcdir)/objc/libobjc.def \\\n+\t\t--output-lib libobjc.a\n+\n \f\n # Build hooks:\n \n@@ -202,7 +226,6 @@ objc.dvi:\n # Install hooks:\n # cc1obj is installed elsewhere as part of $(COMPILERS).\n \n-# Nothing to do here.\n objc.install-normal: installdirs\n \t-if [ -f libobjc.a ] ; then \\\n \t  rm -f $(libsubdir)/libobjc.a; \\\n@@ -211,7 +234,17 @@ objc.install-normal: installdirs\n \t    (cd $(libsubdir); $(RANLIB) libobjc.a); else true; fi; \\\n \t  chmod a-x $(libsubdir)/libobjc.a; \\\n \telse true; fi\n-\n+\t-if [ -f libobjc_s.a ] ; then \\\n+\t  rm -f $(libsubdir)/libobjc_s.a; \\\n+\t  $(INSTALL_DATA) libobjc_s.a $(libsubdir)/libobjc_s.a; \\\n+\t  if $(RANLIB_TEST) ; then \\\n+\t    (cd $(libsubdir); $(RANLIB) libobjc_s.a); else true; fi; \\\n+\t  chmod a-x $(libsubdir)/libobjc_s.a; \\\n+\telse true; fi\n+\t-if [ -f libobjc.dll ] ; then \\\n+\t  rm -f $(bindir)/libobjc.dll; \\\n+\t  $(INSTALL_DATA) libobjc.dll $(bindir)/libobjc.dll; \\\n+\telse true; fi\n \n objc.install-common:\n \n@@ -227,7 +260,8 @@ objc.uninstall:\n objc.mostlyclean:\n \t-rm -f tmp-objc-prs.y\n \t-rm -f objc/*$(objext) objc/xforward objc/fflags\n-\t-rm -f libobjc.a\n+\t-rm -f libobjc.a libobjc_s.a libobjc.dll\n+\t-rm -f libobjc.base libobjc.exp\n objc.clean: objc.mostlyclean\n \t-rm -rf objc-headers\n objc.distclean:"}]}