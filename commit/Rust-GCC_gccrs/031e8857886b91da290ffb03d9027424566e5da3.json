{"sha": "031e8857886b91da290ffb03d9027424566e5da3", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDMxZTg4NTc4ODZiOTFkYTI5MGZmYjAzZDkwMjc0MjQ1NjZlNWRhMw==", "commit": {"author": {"name": "Richard Sandiford", "email": "richard.sandiford@arm.com", "date": "2019-09-10T18:56:21Z"}, "committer": {"name": "Richard Sandiford", "email": "rsandifo@gcc.gnu.org", "date": "2019-09-10T18:56:21Z"}, "message": "Move c6x REGNO_REG_CLASS out of line\n\nI have a series of patches that hides call_used_regs from target-\nindependent code, a knock-on effect of which is that (public) target\nmacros can't use call_used_regs either.  This patch fixes the only\ncase in which that was a problem.\n\n2019-09-10  Richard Sandiford  <richard.sandiford@arm.com>\n\ngcc/\n\t* config/c6x/c6x-protos.h (c6x_set_return_address): Declare.\n\t* config/c6x/c6x.h (REGNO_REG_CLASS): Move implementation to\n\t* config/c6x/c6x.c (c6x_regno_reg_class): ...this new function.\n\nFrom-SVN: r275597", "tree": {"sha": "38e3ad9468d0607ef4c594d9fc2c8e0252773763", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/38e3ad9468d0607ef4c594d9fc2c8e0252773763"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/031e8857886b91da290ffb03d9027424566e5da3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/031e8857886b91da290ffb03d9027424566e5da3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/031e8857886b91da290ffb03d9027424566e5da3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/031e8857886b91da290ffb03d9027424566e5da3/comments", "author": {"login": "rsandifo-arm", "id": 28043039, "node_id": "MDQ6VXNlcjI4MDQzMDM5", "avatar_url": "https://avatars.githubusercontent.com/u/28043039?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rsandifo-arm", "html_url": "https://github.com/rsandifo-arm", "followers_url": "https://api.github.com/users/rsandifo-arm/followers", "following_url": "https://api.github.com/users/rsandifo-arm/following{/other_user}", "gists_url": "https://api.github.com/users/rsandifo-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/rsandifo-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rsandifo-arm/subscriptions", "organizations_url": "https://api.github.com/users/rsandifo-arm/orgs", "repos_url": "https://api.github.com/users/rsandifo-arm/repos", "events_url": "https://api.github.com/users/rsandifo-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/rsandifo-arm/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "0f8b14ee8ae787d7fba104dbdeb31e0400f6b7d2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0f8b14ee8ae787d7fba104dbdeb31e0400f6b7d2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0f8b14ee8ae787d7fba104dbdeb31e0400f6b7d2"}], "stats": {"total": 37, "additions": 31, "deletions": 6}, "files": [{"sha": "56f99f01e2930a456f42f2abd13903efdd7c342a", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/031e8857886b91da290ffb03d9027424566e5da3/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/031e8857886b91da290ffb03d9027424566e5da3/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=031e8857886b91da290ffb03d9027424566e5da3", "patch": "@@ -1,3 +1,9 @@\n+2019-09-10  Richard Sandiford  <richard.sandiford@arm.com>\n+\n+\t* config/c6x/c6x-protos.h (c6x_set_return_address): Declare.\n+\t* config/c6x/c6x.h (REGNO_REG_CLASS): Move implementation to\n+\t* config/c6x/c6x.c (c6x_regno_reg_class): ...this new function.\n+\n 2019-09-10  Richard Sandiford  <richard.sandiford@arm.com>\n \n \t* rtl.h (get_call_rtx_from): Take a const rtx_insn * instead of an rtx."}, {"sha": "b2043cbe0deb29a819fc295febb6d33c4180f482", "filename": "gcc/config/c6x/c6x-protos.h", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/031e8857886b91da290ffb03d9027424566e5da3/gcc%2Fconfig%2Fc6x%2Fc6x-protos.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/031e8857886b91da290ffb03d9027424566e5da3/gcc%2Fconfig%2Fc6x%2Fc6x-protos.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fc6x%2Fc6x-protos.h?ref=031e8857886b91da290ffb03d9027424566e5da3", "patch": "@@ -53,6 +53,8 @@ extern void c6x_expand_epilogue (bool);\n extern rtx c6x_return_addr_rtx (int);\n \n extern void c6x_set_return_address (rtx, rtx);\n+\n+enum reg_class c6x_regno_reg_class (int);\n #endif\n \n extern void c6x_override_options (void);"}, {"sha": "852373bb1dedd457ea6d984c1a13edc5e114fcc3", "filename": "gcc/config/c6x/c6x.c", "status": "modified", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/031e8857886b91da290ffb03d9027424566e5da3/gcc%2Fconfig%2Fc6x%2Fc6x.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/031e8857886b91da290ffb03d9027424566e5da3/gcc%2Fconfig%2Fc6x%2Fc6x.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fc6x%2Fc6x.c?ref=031e8857886b91da290ffb03d9027424566e5da3", "patch": "@@ -6677,6 +6677,28 @@ c6x_modes_tieable_p (machine_mode mode1, machine_mode mode2)\n \t      && GET_MODE_SIZE (mode2) <= UNITS_PER_WORD));\n }\n \n+/* Implement REGNO_REG_CLASS.  */\n+\n+enum reg_class\n+c6x_regno_reg_class (int reg)\n+{\n+  if (reg >= REG_A1 && reg <= REG_A2)\n+    return PREDICATE_A_REGS;\n+\n+  if (reg == REG_A0 && TARGET_INSNS_64)\n+    return PREDICATE_A_REGS;\n+\n+  if (reg >= REG_B0 && reg <= REG_B2)\n+    return PREDICATE_B_REGS;\n+\n+  if (A_REGNO_P (reg))\n+    return NONPREDICATE_A_REGS;\n+\n+  if (call_used_regs[reg])\n+    return CALL_USED_B_REGS;\n+\n+  return B_REGS;\n+}\n \f\n /* Target Structure.  */\n "}, {"sha": "e93a544a9a854d98d9d751c97096fca54548d248", "filename": "gcc/config/c6x/c6x.h", "status": "modified", "additions": 1, "deletions": 6, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/031e8857886b91da290ffb03d9027424566e5da3/gcc%2Fconfig%2Fc6x%2Fc6x.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/031e8857886b91da290ffb03d9027424566e5da3/gcc%2Fconfig%2Fc6x%2Fc6x.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fc6x%2Fc6x.h?ref=031e8857886b91da290ffb03d9027424566e5da3", "patch": "@@ -259,12 +259,7 @@ enum reg_class\n #define CROSS_OPERANDS(X0,X1) \\\n   (A_REG_P (X0) == A_REG_P (X1) ? CROSS_N : CROSS_Y)\n \n-#define REGNO_REG_CLASS(reg) \\\n-    ((reg) >= REG_A1 && (reg) <= REG_A2 ? PREDICATE_A_REGS\t\\\n-     : (reg) == REG_A0 && TARGET_INSNS_64 ? PREDICATE_A_REGS\t\\\n-     : (reg) >= REG_B0 && (reg) <= REG_B2 ? PREDICATE_B_REGS\t\\\n-     : A_REGNO_P (reg) ? NONPREDICATE_A_REGS\t\t\t\\\n-     : call_used_regs[reg] ? CALL_USED_B_REGS : B_REGS)\n+#define REGNO_REG_CLASS(reg) c6x_regno_reg_class (reg)\n \n #define BASE_REG_CLASS ALL_REGS\n #define INDEX_REG_CLASS ALL_REGS"}]}