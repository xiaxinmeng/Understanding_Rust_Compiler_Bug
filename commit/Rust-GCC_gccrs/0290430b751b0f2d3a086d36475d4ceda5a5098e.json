{"sha": "0290430b751b0f2d3a086d36475d4ceda5a5098e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDI5MDQzMGI3NTFiMGYyZDNhMDg2ZDM2NDc1ZDRjZWRhNWE1MDk4ZQ==", "commit": {"author": {"name": "Richard Earnshaw", "email": "rearnsha@arm.com", "date": "2012-09-14T17:10:45Z"}, "committer": {"name": "Richard Earnshaw", "email": "rearnsha@gcc.gnu.org", "date": "2012-09-14T17:10:45Z"}, "message": "re PR target/54516 (ICE in reload_cse_simplify_operands, at postreload.c:403 with -O1 -march=armv7-a -mthumb)\n\n\tPR target/54516\n\tPR rtl-optimization/54540\n\t* reload.c (find_dummy_reload): Don't use OUT as a reload reg\n\tfor IN if it overlaps a fixed register.\n\nFrom-SVN: r191307", "tree": {"sha": "b9aab0164d03a44a4a0d11b593533cb96d017c9c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b9aab0164d03a44a4a0d11b593533cb96d017c9c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0290430b751b0f2d3a086d36475d4ceda5a5098e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0290430b751b0f2d3a086d36475d4ceda5a5098e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0290430b751b0f2d3a086d36475d4ceda5a5098e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0290430b751b0f2d3a086d36475d4ceda5a5098e/comments", "author": null, "committer": null, "parents": [{"sha": "cde43acdba16efdb6e4e4488ec19e4106b5396c7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cde43acdba16efdb6e4e4488ec19e4106b5396c7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cde43acdba16efdb6e4e4488ec19e4106b5396c7"}], "stats": {"total": 17, "additions": 15, "deletions": 2}, "files": [{"sha": "21a8f94e22fc3202a8984ff9cd15f9fb686c9d92", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0290430b751b0f2d3a086d36475d4ceda5a5098e/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0290430b751b0f2d3a086d36475d4ceda5a5098e/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=0290430b751b0f2d3a086d36475d4ceda5a5098e", "patch": "@@ -1,3 +1,10 @@\n+2012-09-14  Richard Earnshaw  <rearnsha@arm.com>\n+\n+\tPR target/54516\n+\tPR rtl-optimization/54540\n+\t* reload.c (find_dummy_reload): Don't use OUT as a reload reg\n+\tfor IN if it overlaps a fixed register.\n+\n 2012-09-14  Eric Botcazou  <ebotcazou@adacore.com>\n \n \tPR rtl-optimization/44194"}, {"sha": "2e41ed6498e6a394dc01c6c4ed3d1f6df6da6ec6", "filename": "gcc/reload.c", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0290430b751b0f2d3a086d36475d4ceda5a5098e/gcc%2Freload.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0290430b751b0f2d3a086d36475d4ceda5a5098e/gcc%2Freload.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Freload.c?ref=0290430b751b0f2d3a086d36475d4ceda5a5098e", "patch": "@@ -2036,7 +2036,12 @@ find_dummy_reload (rtx real_in, rtx real_out, rtx *inloc, rtx *outloc,\n \t However, we only ignore IN in its role as this reload.\n \t If the insn uses IN elsewhere and it contains OUT,\n \t that counts.  We can't be sure it's the \"same\" operand\n-\t so it might not go through this reload.  */\n+\t so it might not go through this reload.  \n+\n+         We also need to avoid using OUT if it, or part of it, is a\n+         fixed register.  Modifying such registers, even transiently,\n+         may have undefined effects on the machine, such as modifying\n+         the stack pointer.  */\n       saved_rtx = *inloc;\n       *inloc = const0_rtx;\n \n@@ -2049,7 +2054,8 @@ find_dummy_reload (rtx real_in, rtx real_out, rtx *inloc, rtx *outloc,\n \n \t  for (i = 0; i < nwords; i++)\n \t    if (! TEST_HARD_REG_BIT (reg_class_contents[(int) rclass],\n-\t\t\t\t     regno + i))\n+\t\t\t\t     regno + i)\n+\t\t|| fixed_regs[regno + i])\n \t      break;\n \n \t  if (i == nwords)"}]}