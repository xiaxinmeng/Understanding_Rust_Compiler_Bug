{"sha": "4e63b362a711b50ad75dcac2da73127503be2609", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NGU2M2IzNjJhNzExYjUwYWQ3NWRjYWMyZGE3MzEyNzUwM2JlMjYwOQ==", "commit": {"author": {"name": "Anatoly Sokolov", "email": "aesok@post.ru", "date": "2007-06-29T20:05:56Z"}, "committer": {"name": "Anatoly Sokolov", "email": "aesok@gcc.gnu.org", "date": "2007-06-29T20:05:56Z"}, "message": "re PR target/32335 (libgcc build failure, ICE in cselib_record_set, at cselib.c:1508)\n\n\tPR target/32335\n\t* config/avr/avr.c: Include dataflow header file.\n\t(expand_prologue): Adjust for prologue insn change.\n\t* config/avr/avr.md (call_prologue_saves): Only modify REG_SP once\n\tinside a insn.\n\nFrom-SVN: r126121", "tree": {"sha": "2bf2b704aa5edd46264cdd2ecd892fed1c6d82ea", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2bf2b704aa5edd46264cdd2ecd892fed1c6d82ea"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4e63b362a711b50ad75dcac2da73127503be2609", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4e63b362a711b50ad75dcac2da73127503be2609", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4e63b362a711b50ad75dcac2da73127503be2609", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4e63b362a711b50ad75dcac2da73127503be2609/comments", "author": null, "committer": null, "parents": [{"sha": "f535826b35af889f4df263e2f77f000312814d7d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f535826b35af889f4df263e2f77f000312814d7d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f535826b35af889f4df263e2f77f000312814d7d"}], "stats": {"total": 29, "additions": 19, "deletions": 10}, "files": [{"sha": "e01cf06f0af767ace253231202aa44686d45584b", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4e63b362a711b50ad75dcac2da73127503be2609/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4e63b362a711b50ad75dcac2da73127503be2609/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=4e63b362a711b50ad75dcac2da73127503be2609", "patch": "@@ -1,3 +1,11 @@\n+2007-06-29 Anatoly Sokolov <aesok@post.ru>\n+\n+\tPR target/32335\n+\t* config/avr/avr.c: Include dataflow header file.\n+\t(expand_prologue): Adjust for prologue insn change.\n+\t* config/avr/avr.md (call_prologue_saves): Only modify REG_SP once\n+\tinside a insn.\n+\n 2007-06-29  Richard Guenther  <rguenther@suse.de>\n \n \tPR middle-end/32493"}, {"sha": "d9dec887b6d778a7bc35da3cf4efe9dae6e39d65", "filename": "gcc/config/avr/avr.c", "status": "modified", "additions": 7, "deletions": 2, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4e63b362a711b50ad75dcac2da73127503be2609/gcc%2Fconfig%2Favr%2Favr.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4e63b362a711b50ad75dcac2da73127503be2609/gcc%2Fconfig%2Favr%2Favr.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Favr%2Favr.c?ref=4e63b362a711b50ad75dcac2da73127503be2609", "patch": "@@ -44,6 +44,7 @@\n #include \"tm_p.h\"\n #include \"target.h\"\n #include \"target-def.h\"\n+#include \"df.h\"\n \n /* Maximal allowed offset for an address in the LD command */\n #define MAX_LD_OFFSET(MODE) (64 - (signed)GET_MODE_SIZE (MODE))\n@@ -631,9 +632,13 @@ expand_prologue (void)\n     }\n   else if (minimize && (frame_pointer_needed || live_seq > 6)) \n     {\n+      insn = emit_move_insn (gen_rtx_REG (HImode, REG_X), \n+                             gen_int_mode (size, HImode));\n+      RTX_FRAME_RELATED_P (insn) = 1;\n+\n       insn = \n-        emit_insn (gen_call_prologue_saves (gen_int_mode (size, HImode),\n-                                            gen_int_mode (live_seq, HImode)));\n+        emit_insn (gen_call_prologue_saves (gen_int_mode (live_seq, HImode),\n+\t\t\t\t\t    gen_int_mode (size + live_seq, HImode)));\n       RTX_FRAME_RELATED_P (insn) = 1;\n     }\n   else"}, {"sha": "2a7c9c8e9872aa9354ac6f57aebefdde26178c7d", "filename": "gcc/config/avr/avr.md", "status": "modified", "additions": 4, "deletions": 8, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4e63b362a711b50ad75dcac2da73127503be2609/gcc%2Fconfig%2Favr%2Favr.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4e63b362a711b50ad75dcac2da73127503be2609/gcc%2Fconfig%2Favr%2Favr.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Favr%2Favr.md?ref=4e63b362a711b50ad75dcac2da73127503be2609", "patch": "@@ -2706,20 +2706,16 @@\n ;;  Library prologue saves\n (define_insn \"call_prologue_saves\"\n   [(unspec_volatile:HI [(const_int 0)] UNSPECV_PROLOGUE_SAVES)\n-   (set (reg:HI REG_SP) (minus:HI \n-                           (reg:HI REG_SP)\n-                           (match_operand:HI 0 \"immediate_operand\" \"\")))\n+   (match_operand:HI 0 \"immediate_operand\" \"\")\n    (set (reg:HI REG_SP) (minus:HI \n                            (reg:HI REG_SP)\n                            (match_operand:HI 1 \"immediate_operand\" \"\")))\n-   (set (reg:HI REG_X) (match_dup 0))\n+   (use (reg:HI REG_X))\n    (clobber (reg:HI REG_Z))]\n   \"\"\n-  \"ldi r26,lo8(%0)\n-\tldi r27,hi8(%0)\n-\tldi r30,pm_lo8(1f)\n+  \"ldi r30,pm_lo8(1f)\n \tldi r31,pm_hi8(1f)\n-\t%~jmp __prologue_saves__+((18 - %1) * 2)\n+\t%~jmp __prologue_saves__+((18 - %0) * 2)\n 1:\"\n   [(set_attr_alternative \"length\"\n \t\t\t [(if_then_else (eq_attr \"mcu_mega\" \"yes\")"}]}