{"sha": "71b7c365f973b2a9c556f47290328805e886be31", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzFiN2MzNjVmOTczYjJhOWM1NTZmNDcyOTAzMjg4MDVlODg2YmUzMQ==", "commit": {"author": {"name": "Tom de Vries", "email": "tom@codesourcery.com", "date": "2018-03-22T10:21:12Z"}, "committer": {"name": "Tom de Vries", "email": "vries@gcc.gnu.org", "date": "2018-03-22T10:21:12Z"}, "message": "[tail-merge] Don't merge bbs with bb_has_abnormal_pred\n\n2018-03-22  Tom de Vries  <tom@codesourcery.com>\n\n\tPR tree-optimization/84956\n\t* tree-ssa-tail-merge.c (find_clusters_1): Skip bbs with\n\tbb_has_abnormal_pred.\n\n\t* gcc.dg/pr84956.c: New test.\n\nFrom-SVN: r258758", "tree": {"sha": "fee2be8174aac019903eac1f2898ac84c773bc75", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/fee2be8174aac019903eac1f2898ac84c773bc75"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/71b7c365f973b2a9c556f47290328805e886be31", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/71b7c365f973b2a9c556f47290328805e886be31", "html_url": "https://github.com/Rust-GCC/gccrs/commit/71b7c365f973b2a9c556f47290328805e886be31", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/71b7c365f973b2a9c556f47290328805e886be31/comments", "author": null, "committer": null, "parents": [{"sha": "f13ed3ed23d38d801223b20b2e01140183394477", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f13ed3ed23d38d801223b20b2e01140183394477", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f13ed3ed23d38d801223b20b2e01140183394477"}], "stats": {"total": 44, "additions": 42, "deletions": 2}, "files": [{"sha": "06320e4c802c211c5400e901d1e51d2776f30e30", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71b7c365f973b2a9c556f47290328805e886be31/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71b7c365f973b2a9c556f47290328805e886be31/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=71b7c365f973b2a9c556f47290328805e886be31", "patch": "@@ -1,3 +1,9 @@\n+2018-03-22  Tom de Vries  <tom@codesourcery.com>\n+\n+\tPR tree-optimization/84956\n+\t* tree-ssa-tail-merge.c (find_clusters_1): Skip bbs with\n+\tbb_has_abnormal_pred.\n+\n 2018-03-22  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR sanitizer/85018"}, {"sha": "abc1b9fb76accfce911ca26def6421026d494e3b", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71b7c365f973b2a9c556f47290328805e886be31/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71b7c365f973b2a9c556f47290328805e886be31/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=71b7c365f973b2a9c556f47290328805e886be31", "patch": "@@ -1,3 +1,8 @@\n+2018-03-22  Tom de Vries  <tom@codesourcery.com>\n+\n+\tPR tree-optimization/84956\n+\t* gcc.dg/pr84956.c: New test.\n+\n 2018-03-22  Marek Polacek  <polacek@redhat.com>\n \n \tPR c++/84854"}, {"sha": "055a749d6356f923c8c9bd6d1495e7e61ae6a543", "filename": "gcc/testsuite/gcc.dg/pr84956.c", "status": "added", "additions": 27, "deletions": 0, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71b7c365f973b2a9c556f47290328805e886be31/gcc%2Ftestsuite%2Fgcc.dg%2Fpr84956.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71b7c365f973b2a9c556f47290328805e886be31/gcc%2Ftestsuite%2Fgcc.dg%2Fpr84956.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr84956.c?ref=71b7c365f973b2a9c556f47290328805e886be31", "patch": "@@ -0,0 +1,27 @@\n+/* { dg-options \"-O2 -ftree-tail-merge\" } */\n+\n+char a;\n+int c;\n+unsigned b ();\n+\n+unsigned\n+setjmp ()\n+{\n+}\n+\n+static void\n+d ()\n+{\n+  if (b ())\n+    c = 3;\n+}\n+\n+void\n+e ()\n+{\n+  d ();\n+  a && ({ setjmp (); });\n+  a && ({ setjmp (); });\n+  a && ({ setjmp (); });\n+}\n+"}, {"sha": "f482ce197cd8e0b1ad9b1bd995c2d1d33ff21256", "filename": "gcc/tree-ssa-tail-merge.c", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71b7c365f973b2a9c556f47290328805e886be31/gcc%2Ftree-ssa-tail-merge.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71b7c365f973b2a9c556f47290328805e886be31/gcc%2Ftree-ssa-tail-merge.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-tail-merge.c?ref=71b7c365f973b2a9c556f47290328805e886be31", "patch": "@@ -1455,15 +1455,17 @@ find_clusters_1 (same_succ *same_succ)\n       /* TODO: handle blocks with phi-nodes.  We'll have to find corresponding\n \t phi-nodes in bb1 and bb2, with the same alternatives for the same\n \t preds.  */\n-      if (bb_has_non_vop_phi (bb1) || bb_has_eh_pred (bb1))\n+      if (bb_has_non_vop_phi (bb1) || bb_has_eh_pred (bb1)\n+\t  || bb_has_abnormal_pred (bb1))\n \tcontinue;\n \n       nr_comparisons = 0;\n       EXECUTE_IF_SET_IN_BITMAP (same_succ->bbs, i + 1, j, bj)\n \t{\n \t  bb2 = BASIC_BLOCK_FOR_FN (cfun, j);\n \n-\t  if (bb_has_non_vop_phi (bb2) || bb_has_eh_pred (bb2))\n+\t  if (bb_has_non_vop_phi (bb2) || bb_has_eh_pred (bb2)\n+\t      || bb_has_abnormal_pred (bb2))\n \t    continue;\n \n \t  if (BB_CLUSTER (bb1) != NULL && BB_CLUSTER (bb1) == BB_CLUSTER (bb2))"}]}