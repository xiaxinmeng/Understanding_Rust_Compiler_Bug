{"sha": "556afcdc1107b79c8f037cc1f9dc4f5a220ff8e4", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTU2YWZjZGMxMTA3Yjc5YzhmMDM3Y2MxZjlkYzRmNWEyMjBmZjhlNA==", "commit": {"author": {"name": "Sebastian Pop", "email": "sebastian.pop@amd.com", "date": "2010-01-07T18:32:51Z"}, "committer": {"name": "Sebastian Pop", "email": "spop@gcc.gnu.org", "date": "2010-01-07T18:32:51Z"}, "message": "Fix memory leaks.\n\n2010-01-06  Sebastian Pop  <sebastian.pop@amd.com>\n\n\t* graphite-clast-to-gimple.c (save_clast_name_index): Free slot\n\tbefore allocating a new one.\n\t(copy_renames): Check that slot is not NULL.\n\t(mark_bb_with_pbb): Same.\n\t(compute_cloog_iv_types_1): Same.\n\t* graphite-interchange.c (lst_perfect_nestify): Free the before,\n\tnest, and after LSTs.\n\t(lst_try_interchange_loops): Same.\n\nFrom-SVN: r155702", "tree": {"sha": "6e8b7af7a18c1c655884e15f7890e21a3bb5fd4c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6e8b7af7a18c1c655884e15f7890e21a3bb5fd4c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/556afcdc1107b79c8f037cc1f9dc4f5a220ff8e4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/556afcdc1107b79c8f037cc1f9dc4f5a220ff8e4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/556afcdc1107b79c8f037cc1f9dc4f5a220ff8e4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/556afcdc1107b79c8f037cc1f9dc4f5a220ff8e4/comments", "author": null, "committer": {"login": "sebpop", "id": 568397, "node_id": "MDQ6VXNlcjU2ODM5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/568397?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sebpop", "html_url": "https://github.com/sebpop", "followers_url": "https://api.github.com/users/sebpop/followers", "following_url": "https://api.github.com/users/sebpop/following{/other_user}", "gists_url": "https://api.github.com/users/sebpop/gists{/gist_id}", "starred_url": "https://api.github.com/users/sebpop/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sebpop/subscriptions", "organizations_url": "https://api.github.com/users/sebpop/orgs", "repos_url": "https://api.github.com/users/sebpop/repos", "events_url": "https://api.github.com/users/sebpop/events{/privacy}", "received_events_url": "https://api.github.com/users/sebpop/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e68c3c6cc5c3c64ed5aeeec90ac7db195ce7a2e2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e68c3c6cc5c3c64ed5aeeec90ac7db195ce7a2e2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e68c3c6cc5c3c64ed5aeeec90ac7db195ce7a2e2"}], "stats": {"total": 42, "additions": 35, "deletions": 7}, "files": [{"sha": "780f23eac1e5e92a630557f7ab01c99220113af2", "filename": "gcc/ChangeLog.graphite", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/556afcdc1107b79c8f037cc1f9dc4f5a220ff8e4/gcc%2FChangeLog.graphite", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/556afcdc1107b79c8f037cc1f9dc4f5a220ff8e4/gcc%2FChangeLog.graphite", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog.graphite?ref=556afcdc1107b79c8f037cc1f9dc4f5a220ff8e4", "patch": "@@ -1,3 +1,14 @@\n+2010-01-06  Sebastian Pop  <sebastian.pop@amd.com>\n+\n+\t* graphite-clast-to-gimple.c (save_clast_name_index): Free slot\n+\tbefore allocating a new one.\n+\t(copy_renames): Check that slot is not NULL.\n+\t(mark_bb_with_pbb): Same.\n+\t(compute_cloog_iv_types_1): Same.\n+\t* graphite-interchange.c (lst_perfect_nestify): Free the before,\n+\tnest, and after LSTs.\n+\t(lst_try_interchange_loops): Same.\n+\n 2010-01-05  Sebastian Pop  <sebastian.pop@amd.com>\n \n \tPR middle-end/42178"}, {"sha": "41094614f1076ac58c193d6aa4dda4a57a696c90", "filename": "gcc/graphite-clast-to-gimple.c", "status": "modified", "additions": 9, "deletions": 4, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/556afcdc1107b79c8f037cc1f9dc4f5a220ff8e4/gcc%2Fgraphite-clast-to-gimple.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/556afcdc1107b79c8f037cc1f9dc4f5a220ff8e4/gcc%2Fgraphite-clast-to-gimple.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgraphite-clast-to-gimple.c?ref=556afcdc1107b79c8f037cc1f9dc4f5a220ff8e4", "patch": "@@ -117,7 +117,12 @@ save_clast_name_index (htab_t index_table, const char *name, int index)\n   slot = htab_find_slot (index_table, &tmp, INSERT);\n \n   if (slot)\n-    *slot = new_clast_name_index (name, index);\n+    {\n+      if (*slot)\n+\tfree (*slot);\n+\n+      *slot = new_clast_name_index (name, index);\n+    }\n }\n \n /* Print to stderr the element ELT.  */\n@@ -629,7 +634,7 @@ copy_renames (void **slot, void *s)\n   tmp.old_name = old_name;\n   x = htab_find_slot (res, &tmp, INSERT);\n \n-  if (!*x)\n+  if (x && !*x)\n     *x = new_rename_map_elt (old_name, expr);\n \n   return 1;\n@@ -660,7 +665,7 @@ mark_bb_with_pbb (poly_bb_p pbb, basic_block bb, htab_t bb_pbb_mapping)\n   tmp.bb = bb;\n   x = htab_find_slot (bb_pbb_mapping, &tmp, INSERT);\n \n-  if (!*x)\n+  if (x && !*x)\n     *x = new_bb_pbb_def (bb, pbb);\n }\n \n@@ -1026,7 +1031,7 @@ compute_cloog_iv_types_1 (poly_bb_p pbb, struct clast_user_stmt *user_stmt)\n \n       slot = htab_find_slot (GBB_CLOOG_IV_TYPES (gbb), &tmp, INSERT);\n \n-      if (!*slot)\n+      if (slot && !*slot)\n \t{\n \t  tree oldiv = pbb_to_depth_to_oldiv (pbb, index);\n \t  tree type = oldiv ? TREE_TYPE (oldiv) : integer_type_node;"}, {"sha": "7ec7fead2f9b3badf87e3d5513015a77ad7b62f8", "filename": "gcc/graphite-interchange.c", "status": "modified", "additions": 15, "deletions": 3, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/556afcdc1107b79c8f037cc1f9dc4f5a220ff8e4/gcc%2Fgraphite-interchange.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/556afcdc1107b79c8f037cc1f9dc4f5a220ff8e4/gcc%2Fgraphite-interchange.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgraphite-interchange.c?ref=556afcdc1107b79c8f037cc1f9dc4f5a220ff8e4", "patch": "@@ -587,11 +587,20 @@ lst_perfect_nestify (lst_p loop1, lst_p loop2, lst_p *before,\n   lst_remove_all_before_excluding_pbb (*nest, last, false);\n \n   if (lst_empty_p (*before))\n-    *before = NULL;\n+    {\n+      free_lst (*before);\n+      *before = NULL;\n+    }\n   if (lst_empty_p (*after))\n-    *after = NULL;\n+    {\n+      free_lst (*after);\n+      *after = NULL;\n+    }\n   if (lst_empty_p (*nest))\n-    *nest = NULL;\n+    {\n+      free_lst (*nest);\n+      *nest = NULL;\n+    }\n }\n \n /* Try to interchange LOOP1 with LOOP2 for all the statements of the\n@@ -646,6 +655,9 @@ lst_try_interchange_loops (scop_p scop, lst_p loop1, lst_p loop2)\n     }\n \n   /* Undo the transform.  */\n+  free_lst (before);\n+  free_lst (nest);\n+  free_lst (after);\n   lst_apply_interchange (loop2, depth2, depth1);\n   return false;\n }"}]}