{"sha": "ec5dd52b373735f93077aece00864c48c7a8bae4", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWM1ZGQ1MmIzNzM3MzVmOTMwNzdhZWNlMDA4NjRjNDhjN2E4YmFlNA==", "commit": {"author": {"name": "Tom Tromey", "email": "tromey@redhat.com", "date": "2006-01-19T00:57:00Z"}, "committer": {"name": "Tom Tromey", "email": "tromey@gcc.gnu.org", "date": "2006-01-19T00:57:00Z"}, "message": "jni.cc (_Jv_JNI_AttachCurrentThread): Return environment if it already exists.\n\n\t* jni.cc (_Jv_JNI_AttachCurrentThread): Return environment if it\n\talready exists.\n\nFrom-SVN: r109936", "tree": {"sha": "07c7e50757b9549955bd62df9c7e3dea9daadeeb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/07c7e50757b9549955bd62df9c7e3dea9daadeeb"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ec5dd52b373735f93077aece00864c48c7a8bae4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ec5dd52b373735f93077aece00864c48c7a8bae4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ec5dd52b373735f93077aece00864c48c7a8bae4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ec5dd52b373735f93077aece00864c48c7a8bae4/comments", "author": null, "committer": null, "parents": [{"sha": "5bf5a10b1ccacfc5eac5c1941d2198eb89258ce9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5bf5a10b1ccacfc5eac5c1941d2198eb89258ce9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5bf5a10b1ccacfc5eac5c1941d2198eb89258ce9"}], "stats": {"total": 17, "additions": 13, "deletions": 4}, "files": [{"sha": "31f66e6a04dae5aa66d2bf0d5c09521f1bd223e8", "filename": "libjava/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ec5dd52b373735f93077aece00864c48c7a8bae4/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ec5dd52b373735f93077aece00864c48c7a8bae4/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=ec5dd52b373735f93077aece00864c48c7a8bae4", "patch": "@@ -1,3 +1,8 @@\n+2006-01-18  Tom Tromey  <tromey@redhat.com>\n+\n+\t* jni.cc (_Jv_JNI_AttachCurrentThread): Return environment if it\n+\talready exists.\n+\n 2006-01-18  Keith Seitz  <keiths@redhat.com>\n \n \t* include/java-interp.h (_Jv_CompileMethod): Add declaration."}, {"sha": "5a93753f006db5afd9147941ffffea5f72bb55e5", "filename": "libjava/jni.cc", "status": "modified", "additions": 8, "deletions": 4, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ec5dd52b373735f93077aece00864c48c7a8bae4/libjava%2Fjni.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ec5dd52b373735f93077aece00864c48c7a8bae4/libjava%2Fjni.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjni.cc?ref=ec5dd52b373735f93077aece00864c48c7a8bae4", "patch": "@@ -1,6 +1,6 @@\n // jni.cc - JNI implementation, including the jump table.\n \n-/* Copyright (C) 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005\n+/* Copyright (C) 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006\n    Free Software Foundation\n \n    This file is part of libgcj.\n@@ -2352,10 +2352,14 @@ _Jv_JNI_AttachCurrentThread (JavaVM *, jstring name, void **penv,\n     }\n \n   // Attaching an already-attached thread is a no-op.\n-  if (_Jv_GetCurrentJNIEnv () != NULL)\n-    return 0;\n+  JNIEnv *env = _Jv_GetCurrentJNIEnv ();\n+  if (env != NULL)\n+    {\n+      *penv = reinterpret_cast<void *> (env);\n+      return 0;\n+    }\n \n-  JNIEnv *env = (JNIEnv *) _Jv_MallocUnchecked (sizeof (JNIEnv));\n+  env = (JNIEnv *) _Jv_MallocUnchecked (sizeof (JNIEnv));\n   if (env == NULL)\n     return JNI_ERR;\n   env->p = &_Jv_JNIFunctions;"}]}