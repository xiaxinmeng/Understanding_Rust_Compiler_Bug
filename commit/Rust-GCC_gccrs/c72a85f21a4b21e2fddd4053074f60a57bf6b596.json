{"sha": "c72a85f21a4b21e2fddd4053074f60a57bf6b596", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzcyYTg1ZjIxYTRiMjFlMmZkZGQ0MDUzMDc0ZjYwYTU3YmY2YjU5Ng==", "commit": {"author": {"name": "Thomas Quinot", "email": "quinot@adacore.com", "date": "2009-04-24T14:47:29Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2009-04-24T14:47:29Z"}, "message": "sem_res.adb (Static_Concatenation): Simplify predicate to make it accurately handle cases such as \"lit\" & \"lit\" and...\n\n2009-04-24  Thomas Quinot  <quinot@adacore.com>\n\n\t* sem_res.adb (Static_Concatenation): Simplify predicate to make it\n\taccurately handle cases such as \"lit\" & \"lit\" and\n\t\"lit\" & static_string_constant\n\nFrom-SVN: r146728", "tree": {"sha": "6360e69dee919b58d2143bc07997c970eb31e0c6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6360e69dee919b58d2143bc07997c970eb31e0c6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c72a85f21a4b21e2fddd4053074f60a57bf6b596", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c72a85f21a4b21e2fddd4053074f60a57bf6b596", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c72a85f21a4b21e2fddd4053074f60a57bf6b596", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c72a85f21a4b21e2fddd4053074f60a57bf6b596/comments", "author": null, "committer": null, "parents": [{"sha": "3563739bcd2982f43e3c9c5818c8e0d2ad971394", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3563739bcd2982f43e3c9c5818c8e0d2ad971394", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3563739bcd2982f43e3c9c5818c8e0d2ad971394"}], "stats": {"total": 52, "additions": 27, "deletions": 25}, "files": [{"sha": "9ffd6500b23798fd6c4817bbf40c92a3825db7bf", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c72a85f21a4b21e2fddd4053074f60a57bf6b596/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c72a85f21a4b21e2fddd4053074f60a57bf6b596/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=c72a85f21a4b21e2fddd4053074f60a57bf6b596", "patch": "@@ -1,3 +1,9 @@\n+2009-04-24  Thomas Quinot  <quinot@adacore.com>\n+\n+\t* sem_res.adb (Static_Concatenation): Simplify predicate to make it\n+\taccurately handle cases such as \"lit\" & \"lit\" and\n+\t\"lit\" & static_string_constant\n+\n 2009-04-24  Emmanuel Briot  <briot@adacore.com>\n \n \t* prj-proc.adb, make.adb, mlib-prj.adb, prj.adb, prj.ads, clean.adb,"}, {"sha": "0378bd542ccfb932886071381bafde50dc3dac16", "filename": "gcc/ada/sem_res.adb", "status": "modified", "additions": 21, "deletions": 25, "changes": 46, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c72a85f21a4b21e2fddd4053074f60a57bf6b596/gcc%2Fada%2Fsem_res.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c72a85f21a4b21e2fddd4053074f60a57bf6b596/gcc%2Fada%2Fsem_res.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_res.adb?ref=c72a85f21a4b21e2fddd4053074f60a57bf6b596", "patch": "@@ -3026,34 +3026,30 @@ package body Sem_Res is\n \n       function Static_Concatenation (N : Node_Id) return Boolean is\n       begin\n-         if Nkind (N) /= N_Op_Concat\n-           or else Etype (N) /= Standard_String\n-         then\n-            return False;\n+         case Nkind (N) is\n+            when N_String_Literal =>\n+               return True;\n \n-         elsif Nkind (Left_Opnd (N)) = N_String_Literal then\n-            return Static_Concatenation (Right_Opnd (N));\n+            when N_Op_Concat      =>\n+               return Static_Concatenation (Left_Opnd (N))\n+                        and then\n+                      Static_Concatenation (Right_Opnd (N));\n+\n+            when others =>\n+               if Is_Entity_Name (N) then\n+                  declare\n+                     Ent : constant Entity_Id := Entity (N);\n+                  begin\n+                     return Ekind (Ent) = E_Constant\n+                              and then Present (Constant_Value (Ent))\n+                              and then Is_Static_Expression\n+                                         (Constant_Value (Ent));\n+                  end;\n \n-         elsif Is_Entity_Name (Left_Opnd (N)) then\n-            declare\n-               Ent : constant Entity_Id := Entity (Left_Opnd (N));\n-            begin\n-               if Ekind (Ent) = E_Constant\n-                 and then Present (Constant_Value (Ent))\n-                 and then Is_Static_Expression (Constant_Value (Ent))\n-               then\n-                  return Static_Concatenation (Right_Opnd (N));\n                else\n                   return False;\n                end if;\n-            end;\n-\n-         elsif Static_Concatenation (Left_Opnd (N)) then\n-            return Static_Concatenation (Right_Opnd (N));\n-\n-         else\n-            return False;\n-         end if;\n+         end case;\n       end Static_Concatenation;\n \n    --  Start of processing for Resolve_Actuals\n@@ -8315,7 +8311,7 @@ package body Sem_Res is\n \n                if From_With_Type (Opnd) then\n                   Error_Msg_Qual_Level := 99;\n-                  Error_Msg_NE (\"missing with-clause on package &\", N,\n+                  Error_Msg_NE (\"missing WITH clause on package &\", N,\n                     Cunit_Entity (Get_Source_Unit (Base_Type (Opnd))));\n                   Error_Msg_N\n                     (\"type conversions require visibility of the full view\",\n@@ -8327,7 +8323,7 @@ package body Sem_Res is\n                       and then Present (Non_Limited_View (Etype (Target))))\n                then\n                   Error_Msg_Qual_Level := 99;\n-                  Error_Msg_NE (\"missing with-clause on package &\", N,\n+                  Error_Msg_NE (\"missing WITH clause on package &\", N,\n                     Cunit_Entity (Get_Source_Unit (Base_Type (Target))));\n                   Error_Msg_N\n                     (\"type conversions require visibility of the full view\","}]}