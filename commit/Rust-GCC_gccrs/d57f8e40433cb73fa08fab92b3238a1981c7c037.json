{"sha": "d57f8e40433cb73fa08fab92b3238a1981c7c037", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDU3ZjhlNDA0MzNjYjczZmEwOGZhYjkyYjMyMzhhMTk4MWM3YzAzNw==", "commit": {"author": {"name": "Piotr Trojanek", "email": "trojanek@adacore.com", "date": "2020-04-27T09:30:06Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "derodat@adacore.com", "date": "2020-06-19T08:17:10Z"}, "message": "[Ada] Add comments about attribute 'Valid_Scalars on private tagged types\n\n2020-06-19  Piotr Trojanek  <trojanek@adacore.com>\n\ngcc/ada/\n\n\t* exp_attr.adb (Expand_N_Attribute_Reference): Add comment.\n\t* sem_attr.adb (Analyze_Attribute): Add ??? comment.\n\t* sem_util.ads (Valid_Scalars): This routine is only used for\n\t'Valid_Scalars and not for 'Valid.", "tree": {"sha": "137254873f4a612d695a912bc88a19434b13f39e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/137254873f4a612d695a912bc88a19434b13f39e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d57f8e40433cb73fa08fab92b3238a1981c7c037", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d57f8e40433cb73fa08fab92b3238a1981c7c037", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d57f8e40433cb73fa08fab92b3238a1981c7c037", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d57f8e40433cb73fa08fab92b3238a1981c7c037/comments", "author": {"login": "ptroja", "id": 161602, "node_id": "MDQ6VXNlcjE2MTYwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/161602?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ptroja", "html_url": "https://github.com/ptroja", "followers_url": "https://api.github.com/users/ptroja/followers", "following_url": "https://api.github.com/users/ptroja/following{/other_user}", "gists_url": "https://api.github.com/users/ptroja/gists{/gist_id}", "starred_url": "https://api.github.com/users/ptroja/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ptroja/subscriptions", "organizations_url": "https://api.github.com/users/ptroja/orgs", "repos_url": "https://api.github.com/users/ptroja/repos", "events_url": "https://api.github.com/users/ptroja/events{/privacy}", "received_events_url": "https://api.github.com/users/ptroja/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pmderodat", "id": 758452, "node_id": "MDQ6VXNlcjc1ODQ1Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/758452?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pmderodat", "html_url": "https://github.com/pmderodat", "followers_url": "https://api.github.com/users/pmderodat/followers", "following_url": "https://api.github.com/users/pmderodat/following{/other_user}", "gists_url": "https://api.github.com/users/pmderodat/gists{/gist_id}", "starred_url": "https://api.github.com/users/pmderodat/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pmderodat/subscriptions", "organizations_url": "https://api.github.com/users/pmderodat/orgs", "repos_url": "https://api.github.com/users/pmderodat/repos", "events_url": "https://api.github.com/users/pmderodat/events{/privacy}", "received_events_url": "https://api.github.com/users/pmderodat/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a4dafb8b92e00e2f783bf8915b17f1f450eff227", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a4dafb8b92e00e2f783bf8915b17f1f450eff227", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a4dafb8b92e00e2f783bf8915b17f1f450eff227"}], "stats": {"total": 15, "additions": 10, "deletions": 5}, "files": [{"sha": "84a36f89a26ea208f5504a50098441ca090cab51", "filename": "gcc/ada/exp_attr.adb", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d57f8e40433cb73fa08fab92b3238a1981c7c037/gcc%2Fada%2Fexp_attr.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d57f8e40433cb73fa08fab92b3238a1981c7c037/gcc%2Fada%2Fexp_attr.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fexp_attr.adb?ref=d57f8e40433cb73fa08fab92b3238a1981c7c037", "patch": "@@ -7094,7 +7094,8 @@ package body Exp_Attr is\n \n          Expr := Empty;\n \n-         --  Attribute 'Valid_Scalars is not supported on private tagged types\n+         --  Attribute 'Valid_Scalars is not supported on private tagged types;\n+         --  see a detailed explanation where this attribute is analyzed.\n \n          if Is_Private_Type (Ptyp) and then Is_Tagged_Type (Ptyp) then\n             null;"}, {"sha": "3bd87fdf3db22e5ec5dad8f56d21243b0c741421", "filename": "gcc/ada/sem_attr.adb", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d57f8e40433cb73fa08fab92b3238a1981c7c037/gcc%2Fada%2Fsem_attr.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d57f8e40433cb73fa08fab92b3238a1981c7c037/gcc%2Fada%2Fsem_attr.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_attr.adb?ref=d57f8e40433cb73fa08fab92b3238a1981c7c037", "patch": "@@ -7016,6 +7016,10 @@ package body Sem_Attr is\n                --  types due to a code generation issue. Is_Visible_Component\n                --  does not allow for a component of a private tagged type to\n                --  be successfully retrieved.\n+               --  ??? This attribute should simply ignore type privacy\n+               --  (see Validated_View). It should examine components of the\n+               --  tagged type extensions (if any) and recursively examine\n+               --  'Valid_Scalars of the parent's type (if any).\n \n                --  Do not use Error_Attr_P because this bypasses any subsequent\n                --  processing and leaves the attribute with type Any_Type. This"}, {"sha": "d99edeaa9022b60ccab989b17248502d09335edb", "filename": "gcc/ada/sem_util.ads", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d57f8e40433cb73fa08fab92b3238a1981c7c037/gcc%2Fada%2Fsem_util.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d57f8e40433cb73fa08fab92b3238a1981c7c037/gcc%2Fada%2Fsem_util.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_util.ads?ref=d57f8e40433cb73fa08fab92b3238a1981c7c037", "patch": "@@ -3050,10 +3050,10 @@ package Sem_Util is\n    --  conversions, and unchecked conversions.\n \n    function Validated_View (Typ : Entity_Id) return Entity_Id;\n-   --  Obtain the \"validated view\" of arbitrary type Typ which is suitable\n-   --  for verification by attributes 'Valid and 'Valid_Scalars. This view\n-   --  is the type itself or its full view while stripping away concurrency,\n-   --  derivations, and privacy.\n+   --  Obtain the \"validated view\" of arbitrary type Typ which is suitable for\n+   --  verification by attributes 'Valid_Scalars. This view is the type itself\n+   --  or its full view while stripping away concurrency, derivations, and\n+   --  privacy.\n \n    function Visible_Ancestors (Typ : Entity_Id) return Elist_Id;\n    --  [Ada 2012:AI-0125-1]: Collect all the visible parents and progenitors"}]}