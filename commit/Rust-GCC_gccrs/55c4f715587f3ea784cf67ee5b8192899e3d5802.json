{"sha": "55c4f715587f3ea784cf67ee5b8192899e3d5802", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTVjNGY3MTU1ODdmM2VhNzg0Y2Y2N2VlNWI4MTkyODk5ZTNkNTgwMg==", "commit": {"author": {"name": "Rainer Orth", "email": "ro@CeBiTec.Uni-Bielefeld.DE", "date": "2010-04-09T17:32:54Z"}, "committer": {"name": "Rainer Orth", "email": "ro@gcc.gnu.org", "date": "2010-04-09T17:32:54Z"}, "message": "configure.ac: Determine Sun ld version numbers.\n\n\t* configure.ac: Determine Sun ld version numbers.\n\t(comdat_group): Restrict GNU ld version checks to gld.\n\t(comdat_group, *-*-solaris2.1[1-9]*): Enable for Sun ld > 1.1688.\n\t(enable_comdat): Support --enable-comdat.\n\t* configure: Regenerate.\n\t* doc/install.texi (Configuration): Document --enable-comdat.\n\nFrom-SVN: r158172", "tree": {"sha": "577933b08daff68b3b380007c7fe3cd5e8436944", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/577933b08daff68b3b380007c7fe3cd5e8436944"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/55c4f715587f3ea784cf67ee5b8192899e3d5802", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/55c4f715587f3ea784cf67ee5b8192899e3d5802", "html_url": "https://github.com/Rust-GCC/gccrs/commit/55c4f715587f3ea784cf67ee5b8192899e3d5802", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/55c4f715587f3ea784cf67ee5b8192899e3d5802/comments", "author": {"login": "rorth", "id": 3930951, "node_id": "MDQ6VXNlcjM5MzA5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/3930951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rorth", "html_url": "https://github.com/rorth", "followers_url": "https://api.github.com/users/rorth/followers", "following_url": "https://api.github.com/users/rorth/following{/other_user}", "gists_url": "https://api.github.com/users/rorth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rorth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rorth/subscriptions", "organizations_url": "https://api.github.com/users/rorth/orgs", "repos_url": "https://api.github.com/users/rorth/repos", "events_url": "https://api.github.com/users/rorth/events{/privacy}", "received_events_url": "https://api.github.com/users/rorth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "62e0852342ca9d580f5f3b0995b54c370f545c44", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/62e0852342ca9d580f5f3b0995b54c370f545c44", "html_url": "https://github.com/Rust-GCC/gccrs/commit/62e0852342ca9d580f5f3b0995b54c370f545c44"}], "stats": {"total": 119, "additions": 111, "deletions": 8}, "files": [{"sha": "a822b36ac02d761a982e1b9636f70536fdd72406", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/55c4f715587f3ea784cf67ee5b8192899e3d5802/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/55c4f715587f3ea784cf67ee5b8192899e3d5802/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=55c4f715587f3ea784cf67ee5b8192899e3d5802", "patch": "@@ -1,3 +1,12 @@\n+2010-04-09  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>\n+\n+\t* configure.ac: Determine Sun ld version numbers.\n+\t(comdat_group): Restrict GNU ld version checks to gld.\n+\t(comdat_group, *-*-solaris2.1[1-9]*): Enable for Sun ld > 1.1688.\n+\t(enable_comdat): Support --enable-comdat.\n+\t* configure: Regenerate.\n+\t* doc/install.texi (Configuration): Document --enable-comdat.\n+\n 2010-04-09  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>\n \n \t* config/sparc/sol2-gld.h: Remove SPARC reference."}, {"sha": "888fc9418a642112e48d76e0ac1ce3b6ca178282", "filename": "gcc/configure", "status": "modified", "additions": 51, "deletions": 5, "changes": 56, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/55c4f715587f3ea784cf67ee5b8192899e3d5802/gcc%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/55c4f715587f3ea784cf67ee5b8192899e3d5802/gcc%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfigure?ref=55c4f715587f3ea784cf67ee5b8192899e3d5802", "patch": "@@ -900,6 +900,7 @@ with_pic\n enable_fast_install\n enable_libtool_lock\n with_plugin_ld\n+enable_comdat\n enable_gnu_unique_object\n enable_linker_build_id\n with_long_double_128\n@@ -1602,6 +1603,7 @@ Optional Features:\n   --enable-fast-install[=PKGS]\n                           optimize for fast installation [default=yes]\n   --disable-libtool-lock  avoid locking (might break parallel builds)\n+  --enable-comdat         enable COMDAT group support\n   --enable-gnu-unique-object\tenable the use of the @gnu_unique_object ELF extension on\n \t\t\t\tglibc systems\n   --enable-linker-build-id\n@@ -17037,7 +17039,7 @@ else\n   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2\n   lt_status=$lt_dlunknown\n   cat > conftest.$ac_ext <<_LT_EOF\n-#line 17040 \"configure\"\n+#line 17042 \"configure\"\n #include \"confdefs.h\"\n \n #if HAVE_DLFCN_H\n@@ -17143,7 +17145,7 @@ else\n   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2\n   lt_status=$lt_dlunknown\n   cat > conftest.$ac_ext <<_LT_EOF\n-#line 17146 \"configure\"\n+#line 17148 \"configure\"\n #include \"confdefs.h\"\n \n #if HAVE_DLFCN_H\n@@ -21210,6 +21212,27 @@ if test $in_tree_ld != yes ; then\n     ld_vers_major=`expr \"$ld_vers\" : '\\([0-9]*\\)'`\n     ld_vers_minor=`expr \"$ld_vers\" : '[0-9]*\\.\\([0-9]*\\)'`\n     ld_vers_patch=`expr \"$ld_vers\" : '[0-9]*\\.[0-9]*\\.\\([0-9]*\\)'`\n+  else\n+    case \"${target}\" in\n+      *-*-solaris2*)\n+\t#\n+\t# Solaris 2 ld -V output looks like this for a regular version:\n+\t#\n+\t# ld: Software Generation Utilities - Solaris Link Editors: 5.11-1.1699\n+\t#\n+\t# but test versions add stuff at the end:\n+\t#\n+\t# ld: Software Generation Utilities - Solaris Link Editors: 5.11-1.1701:onnv-ab196087-6931056-03/25/10\n+\t#\n+\tld_ver=`$gcc_cv_ld -V 2>&1`\n+\tif echo \"$ld_ver\" | grep 'Solaris Link Editors' > /dev/null; then\n+\t  ld_vers=`echo $ld_ver | sed -n \\\n+\t    -e 's,^.*: 5\\.[0-9][0-9]*-\\([0-9]\\.[0-9][0-9]*\\).*$,\\1,p'`\n+\t  ld_vers_major=`expr \"$ld_vers\" : '\\([0-9]*\\)'`\n+\t  ld_vers_minor=`expr \"$ld_vers\" : '[0-9]*\\.\\([0-9]*\\)'`\n+\tfi\n+\t;;\n+    esac\n   fi\n fi\n \n@@ -21808,7 +21831,7 @@ elif test $in_tree_ld = yes ; then\n      && test $in_tree_ld_is_elf = yes; then\n      comdat_group=yes\n   fi\n-elif test x\"$ld_vers\" != x; then\n+elif echo \"$ld_ver\" | grep GNU > /dev/null; then\n   comdat_group=yes\n   if test 0\"$ld_date\" -lt 20050308; then\n     if test -n \"$ld_date\"; then\n@@ -21821,9 +21844,32 @@ elif test x\"$ld_vers\" != x; then\n     fi\n   fi\n else\n-  # assume linkers other than GNU ld don't support COMDAT group\n-  comdat_group=no\n+  case \"${target}\" in\n+    *-*-solaris2.1[1-9]*)\n+      # Sun ld has COMDAT group support since Solaris 9, but it doesn't\n+      # interoperate with GNU as until Solaris 11 build 130, i.e. ld\n+      # version 1.688.\n+      #\n+      # FIXME: Maybe need to refine later when COMDAT group support with\n+      # Sun as is implemented.\n+      if test \"$ld_vers_major\" -gt 1 || test \"$ld_vers_minor\" -ge 1688; then\n+        comdat_group=yes\n+      else\n+        comdat_group=no\n+      fi\n+      ;;\n+    *)\n+      # Assume linkers other than GNU ld don't support COMDAT group.\n+      comdat_group=no\n+      ;;\n+  esac\n fi\n+# Allow overriding the automatic COMDAT group tests above.\n+# Check whether --enable-comdat was given.\n+if test \"${enable_comdat+set}\" = set; then :\n+  enableval=$enable_comdat; comdat_group=\"$enable_comdat\"\n+fi\n+\n if test $comdat_group = no; then\n   gcc_cv_as_comdat_group=no\n   gcc_cv_as_comdat_group_percent=no"}, {"sha": "abf03c5b31f4914905316201073a1f1a5bd32dd8", "filename": "gcc/configure.ac", "status": "modified", "additions": 47, "deletions": 3, "changes": 50, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/55c4f715587f3ea784cf67ee5b8192899e3d5802/gcc%2Fconfigure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/55c4f715587f3ea784cf67ee5b8192899e3d5802/gcc%2Fconfigure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfigure.ac?ref=55c4f715587f3ea784cf67ee5b8192899e3d5802", "patch": "@@ -2142,6 +2142,27 @@ if test $in_tree_ld != yes ; then\n     ld_vers_major=`expr \"$ld_vers\" : '\\([0-9]*\\)'`\n     ld_vers_minor=`expr \"$ld_vers\" : '[0-9]*\\.\\([0-9]*\\)'`\n     ld_vers_patch=`expr \"$ld_vers\" : '[0-9]*\\.[0-9]*\\.\\([0-9]*\\)'`\n+  else\n+    case \"${target}\" in\n+      *-*-solaris2*)\n+\t#\n+\t# Solaris 2 ld -V output looks like this for a regular version:\n+\t#\n+\t# ld: Software Generation Utilities - Solaris Link Editors: 5.11-1.1699\n+\t#\n+\t# but test versions add stuff at the end:\n+\t#\n+\t# ld: Software Generation Utilities - Solaris Link Editors: 5.11-1.1701:onnv-ab196087-6931056-03/25/10\n+\t#\n+\tld_ver=`$gcc_cv_ld -V 2>&1`\n+\tif echo \"$ld_ver\" | grep 'Solaris Link Editors' > /dev/null; then\n+\t  ld_vers=`echo $ld_ver | sed -n \\\n+\t    -e 's,^.*: 5\\.[0-9][0-9]*-\\([0-9]\\.[0-9][0-9]*\\).*$,\\1,p'`\n+\t  ld_vers_major=`expr \"$ld_vers\" : '\\([0-9]*\\)'`\n+\t  ld_vers_minor=`expr \"$ld_vers\" : '[0-9]*\\.\\([0-9]*\\)'`\n+\tfi\n+\t;;\n+    esac\n   fi\n fi\n changequote([,])dnl\n@@ -2462,7 +2483,7 @@ elif test $in_tree_ld = yes ; then\n      && test $in_tree_ld_is_elf = yes; then\n      comdat_group=yes\n   fi\n-elif test x\"$ld_vers\" != x; then\n+elif echo \"$ld_ver\" | grep GNU > /dev/null; then\n   comdat_group=yes\n   if test 0\"$ld_date\" -lt 20050308; then\n     if test -n \"$ld_date\"; then\n@@ -2475,9 +2496,32 @@ elif test x\"$ld_vers\" != x; then\n     fi\n   fi\n else\n-  # assume linkers other than GNU ld don't support COMDAT group\n-  comdat_group=no\n+changequote(,)dnl\n+  case \"${target}\" in\n+    *-*-solaris2.1[1-9]*)\n+      # Sun ld has COMDAT group support since Solaris 9, but it doesn't\n+      # interoperate with GNU as until Solaris 11 build 130, i.e. ld\n+      # version 1.688.\n+      #\n+      # FIXME: Maybe need to refine later when COMDAT group support with\n+      # Sun as is implemented.\n+      if test \"$ld_vers_major\" -gt 1 || test \"$ld_vers_minor\" -ge 1688; then\n+        comdat_group=yes\n+      else\n+        comdat_group=no\n+      fi\n+      ;;\n+    *)\n+      # Assume linkers other than GNU ld don't support COMDAT group.\n+      comdat_group=no\n+      ;;\n+  esac\n+changequote([,])dnl\n fi\n+# Allow overriding the automatic COMDAT group tests above.\n+AC_ARG_ENABLE(comdat,\n+  [AS_HELP_STRING([--enable-comdat], [enable COMDAT group support])],\n+  [comdat_group=\"$enable_comdat\"])\n if test $comdat_group = no; then\n   gcc_cv_as_comdat_group=no\n   gcc_cv_as_comdat_group_percent=no"}, {"sha": "c2468dc9e8fc08da60240a602ea0ac9bf19bf990", "filename": "gcc/doc/install.texi", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/55c4f715587f3ea784cf67ee5b8192899e3d5802/gcc%2Fdoc%2Finstall.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/55c4f715587f3ea784cf67ee5b8192899e3d5802/gcc%2Fdoc%2Finstall.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdoc%2Finstall.texi?ref=55c4f715587f3ea784cf67ee5b8192899e3d5802", "patch": "@@ -1233,6 +1233,10 @@ This is the default for the m32r platform.\n Specify that the user visible @command{cpp} program should be installed\n in @file{@var{prefix}/@var{dirname}/cpp}, in addition to @var{bindir}.\n \n+@item --enable-comdat\n+Enable COMDAT group support.  This is primarily used to override the\n+automatically detected value.\n+\n @item --enable-initfini-array\n Force the use of sections @code{.init_array} and @code{.fini_array}\n (instead of @code{.init} and @code{.fini}) for constructors and"}]}