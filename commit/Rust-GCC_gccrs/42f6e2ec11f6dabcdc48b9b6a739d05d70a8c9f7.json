{"sha": "42f6e2ec11f6dabcdc48b9b6a739d05d70a8c9f7", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDJmNmUyZWMxMWY2ZGFiY2RjNDhiOWI2YTczOWQwNWQ3MGE4YzlmNw==", "commit": {"author": {"name": "Richard Guenther", "email": "rguenther@suse.de", "date": "2007-06-29T13:43:10Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2007-06-29T13:43:10Z"}, "message": "re PR middle-end/32493 (Fails to inline varargs function with unused arguments)\n\n2006-06-29  Richard Guenther  <rguenther@suse.de>\n\n\tPR middle-end/32493\n\t* gimplify.c (gimplify_call_expr): Ignore variable argument parts\n\tduring type verification.\n\n\t* gcc.dg/inline-23.c: New testcase.\n\nFrom-SVN: r126113", "tree": {"sha": "34d09710500c8001c0c549f2d207f6cd59a0b876", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/34d09710500c8001c0c549f2d207f6cd59a0b876"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/42f6e2ec11f6dabcdc48b9b6a739d05d70a8c9f7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/42f6e2ec11f6dabcdc48b9b6a739d05d70a8c9f7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/42f6e2ec11f6dabcdc48b9b6a739d05d70a8c9f7", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/42f6e2ec11f6dabcdc48b9b6a739d05d70a8c9f7/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "29fbecf33f017563e0e5488188d23b32a38bcbeb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/29fbecf33f017563e0e5488188d23b32a38bcbeb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/29fbecf33f017563e0e5488188d23b32a38bcbeb"}], "stats": {"total": 49, "additions": 42, "deletions": 7}, "files": [{"sha": "3aef438548771170bb0d9d7ad652693e222d3cf5", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/42f6e2ec11f6dabcdc48b9b6a739d05d70a8c9f7/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/42f6e2ec11f6dabcdc48b9b6a739d05d70a8c9f7/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=42f6e2ec11f6dabcdc48b9b6a739d05d70a8c9f7", "patch": "@@ -1,3 +1,9 @@\n+2006-06-29  Richard Guenther  <rguenther@suse.de>\n+\n+\tPR middle-end/32493\n+\t* gimplify.c (gimplify_call_expr): Ignore variable argument parts\n+\tduring type verification.\n+\n 2007-06-29  Jan Hubicka  <jh@suse.cz>\n \n \t* recog.c (validate_change_rtx_1): Unshare TO argument."}, {"sha": "a7669acc9680f0dd7e03419651103d37d910fcc1", "filename": "gcc/gimplify.c", "status": "modified", "additions": 14, "deletions": 7, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/42f6e2ec11f6dabcdc48b9b6a739d05d70a8c9f7/gcc%2Fgimplify.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/42f6e2ec11f6dabcdc48b9b6a739d05d70a8c9f7/gcc%2Fgimplify.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgimplify.c?ref=42f6e2ec11f6dabcdc48b9b6a739d05d70a8c9f7", "patch": "@@ -2138,14 +2138,21 @@ gimplify_call_expr (tree *expr_p, tree *pre_p, bool want_value)\n   if (parms)\n     {\n       for (i = 0, p = parms; i < nargs; i++, p = TREE_CHAIN (p))\n-\tif (!p\n-\t    || TREE_VALUE (p) == error_mark_node\n-\t    || CALL_EXPR_ARG (*expr_p, i) == error_mark_node\n-\t    || !fold_convertible_p (TREE_VALUE (p), CALL_EXPR_ARG (*expr_p, i)))\n-\t  {\n-\t    CALL_CANNOT_INLINE_P (*expr_p) = 1;\n+\t{\n+\t  /* If this is a varargs function defer inlining decision\n+\t     to callee.  */\n+\t  if (!p)\n \t    break;\n-\t  }\n+\t  if (TREE_VALUE (p) == error_mark_node\n+\t      || CALL_EXPR_ARG (*expr_p, i) == error_mark_node\n+\t      || TREE_CODE (TREE_VALUE (p)) == VOID_TYPE\n+\t      || !fold_convertible_p (TREE_VALUE (p),\n+\t\t\t\t      CALL_EXPR_ARG (*expr_p, i)))\n+\t    {\n+\t      CALL_CANNOT_INLINE_P (*expr_p) = 1;\n+\t      break;\n+\t    }\n+\t}\n     }\n   else if (decl && DECL_ARGUMENTS (decl))\n     {"}, {"sha": "9c6e0c5a3f7c997a024d96f72bcfeab28255e603", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/42f6e2ec11f6dabcdc48b9b6a739d05d70a8c9f7/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/42f6e2ec11f6dabcdc48b9b6a739d05d70a8c9f7/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=42f6e2ec11f6dabcdc48b9b6a739d05d70a8c9f7", "patch": "@@ -1,3 +1,8 @@\n+2006-06-29  Richard Guenther  <rguenther@suse.de>\n+\n+\tPR middle-end/32493\n+\t* gcc.dg/inline-23.c: New testcase.\n+\n 2007-06-29  Uros Bizjak  <ubizjak@gmail.com>\n \n \tPR tree-optimization/24659"}, {"sha": "171cf624a19e9f8a2851cc830daa9efe94670ecb", "filename": "gcc/testsuite/gcc.dg/inline-23.c", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/42f6e2ec11f6dabcdc48b9b6a739d05d70a8c9f7/gcc%2Ftestsuite%2Fgcc.dg%2Finline-23.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/42f6e2ec11f6dabcdc48b9b6a739d05d70a8c9f7/gcc%2Ftestsuite%2Fgcc.dg%2Finline-23.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Finline-23.c?ref=42f6e2ec11f6dabcdc48b9b6a739d05d70a8c9f7", "patch": "@@ -0,0 +1,17 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-std=gnu89\" } */\n+/* Make sure we can inline a varargs function whose variable arguments\n+   are not used.  See PR32493.  */\n+static inline __attribute__((always_inline)) void __check_printsym_format(const\n+char *fmt, ...)\n+{\n+}\n+static inline __attribute__((always_inline)) void print_symbol(const char *fmt,\n+unsigned long addr)\n+{\n+ __check_printsym_format(fmt, \"\");\n+}\n+void do_initcalls(void **call)\n+{\n+   print_symbol(\": %s()\", (unsigned long) *call);\n+}"}]}