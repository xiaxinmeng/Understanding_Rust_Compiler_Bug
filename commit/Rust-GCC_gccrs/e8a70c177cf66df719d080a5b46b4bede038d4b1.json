{"sha": "e8a70c177cf66df719d080a5b46b4bede038d4b1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZThhNzBjMTc3Y2Y2NmRmNzE5ZDA4MGE1YjQ2YjRiZWRlMDM4ZDRiMQ==", "commit": {"author": {"name": "Steve Ellcey", "email": "sellcey@marvell.com", "date": "2019-08-02T16:01:15Z"}, "committer": {"name": "Steve Ellcey", "email": "sje@gcc.gnu.org", "date": "2019-08-02T16:01:15Z"}, "message": "omp-simd-clone.c (simd_clone_adjust_return_type): Remove call to build_distinct_type_copy.\n\n2019-08-02  Steve Ellcey  <sellcey@marvell.com>\n\n\t* omp-simd-clone.c (simd_clone_adjust_return_type): Remove call to\n\tbuild_distinct_type_copy.\n\t(simd_clone_adjust_argument_types): Ditto.\n\t(simd_clone_adjust): Call build_distinct_type_copy here.\n\t(expand_simd_clones): Ditto.\n\nFrom-SVN: r274019", "tree": {"sha": "e57bafa34b12dd389b86cc86329f669a2a7c35da", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e57bafa34b12dd389b86cc86329f669a2a7c35da"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e8a70c177cf66df719d080a5b46b4bede038d4b1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e8a70c177cf66df719d080a5b46b4bede038d4b1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e8a70c177cf66df719d080a5b46b4bede038d4b1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e8a70c177cf66df719d080a5b46b4bede038d4b1/comments", "author": null, "committer": null, "parents": [{"sha": "f04bffb04a4dae3e1a1f87f53c4591fc48bb8058", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f04bffb04a4dae3e1a1f87f53c4591fc48bb8058", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f04bffb04a4dae3e1a1f87f53c4591fc48bb8058"}], "stats": {"total": 18, "additions": 12, "deletions": 6}, "files": [{"sha": "9493986bc05abbffddc2c2ce79d89d9d84c90fdc", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e8a70c177cf66df719d080a5b46b4bede038d4b1/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e8a70c177cf66df719d080a5b46b4bede038d4b1/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=e8a70c177cf66df719d080a5b46b4bede038d4b1", "patch": "@@ -1,3 +1,11 @@\n+2019-08-02  Steve Ellcey  <sellcey@marvell.com>\n+\n+\t* omp-simd-clone.c (simd_clone_adjust_return_type): Remove call to\n+\tbuild_distinct_type_copy.\n+\t(simd_clone_adjust_argument_types): Ditto.\n+\t(simd_clone_adjust): Call build_distinct_type_copy here.\n+\t(expand_simd_clones): Ditto.\n+\n 2019-08-02  Uro\u0161 Bizjak  <ubizjak@gmail.com>\n \n \tPR target/91201"}, {"sha": "c8c528471a3a2e6bf0a288ba25a9e9ef3ea99198", "filename": "gcc/omp-simd-clone.c", "status": "modified", "additions": 4, "deletions": 6, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e8a70c177cf66df719d080a5b46b4bede038d4b1/gcc%2Fomp-simd-clone.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e8a70c177cf66df719d080a5b46b4bede038d4b1/gcc%2Fomp-simd-clone.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fomp-simd-clone.c?ref=e8a70c177cf66df719d080a5b46b4bede038d4b1", "patch": "@@ -498,7 +498,6 @@ simd_clone_adjust_return_type (struct cgraph_node *node)\n   /* Adjust the function return type.  */\n   if (orig_rettype == void_type_node)\n     return NULL_TREE;\n-  TREE_TYPE (fndecl) = build_distinct_type_copy (TREE_TYPE (fndecl));\n   t = TREE_TYPE (TREE_TYPE (fndecl));\n   if (INTEGRAL_TYPE_P (t) || POINTER_TYPE_P (t))\n     veclen = node->simdclone->vecsize_int;\n@@ -724,11 +723,7 @@ simd_clone_adjust_argument_types (struct cgraph_node *node)\n \t  else\n \t    new_reversed = void_list_node;\n \t}\n-\n-      tree new_type = build_distinct_type_copy (TREE_TYPE (node->decl));\n-      TYPE_ARG_TYPES (new_type) = new_reversed;\n-      TREE_TYPE (node->decl) = new_type;\n-\n+      TYPE_ARG_TYPES (TREE_TYPE (node->decl)) = new_reversed;\n       adjustments.release ();\n     }\n   args.release ();\n@@ -1164,6 +1159,7 @@ simd_clone_adjust (struct cgraph_node *node)\n {\n   push_cfun (DECL_STRUCT_FUNCTION (node->decl));\n \n+  TREE_TYPE (node->decl) = build_distinct_type_copy (TREE_TYPE (node->decl));\n   targetm.simd_clone.adjust (node);\n \n   tree retval = simd_clone_adjust_return_type (node);\n@@ -1737,6 +1733,8 @@ expand_simd_clones (struct cgraph_node *node)\n \t    simd_clone_adjust (n);\n \t  else\n \t    {\n+\t      TREE_TYPE (n->decl)\n+\t\t= build_distinct_type_copy (TREE_TYPE (n->decl));\n \t      targetm.simd_clone.adjust (n);\n \t      simd_clone_adjust_return_type (n);\n \t      simd_clone_adjust_argument_types (n);"}]}