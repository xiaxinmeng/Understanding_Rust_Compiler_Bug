{"sha": "7a544ce153d84b697ec10a5acfd9b2e35a94fd87", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2E1NDRjZTE1M2Q4NGI2OTdlYzEwYTVhY2ZkOWIyZTM1YTk0ZmQ4Nw==", "commit": {"author": {"name": "Bruce Korb", "email": "bkorb@gnu.org", "date": "2000-05-09T16:21:08Z"}, "committer": {"name": "Bruce Korb", "email": "korbb@gcc.gnu.org", "date": "2000-05-09T16:21:08Z"}, "message": "Added 'test_text' for many fixes\n\nFrom-SVN: r33801", "tree": {"sha": "640a3c27e50bfcbf7ee30515df4bc60221c9b95a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/640a3c27e50bfcbf7ee30515df4bc60221c9b95a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7a544ce153d84b697ec10a5acfd9b2e35a94fd87", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7a544ce153d84b697ec10a5acfd9b2e35a94fd87", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7a544ce153d84b697ec10a5acfd9b2e35a94fd87", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7a544ce153d84b697ec10a5acfd9b2e35a94fd87/comments", "author": {"login": "brkorb", "id": 1242936, "node_id": "MDQ6VXNlcjEyNDI5MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/1242936?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brkorb", "html_url": "https://github.com/brkorb", "followers_url": "https://api.github.com/users/brkorb/followers", "following_url": "https://api.github.com/users/brkorb/following{/other_user}", "gists_url": "https://api.github.com/users/brkorb/gists{/gist_id}", "starred_url": "https://api.github.com/users/brkorb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brkorb/subscriptions", "organizations_url": "https://api.github.com/users/brkorb/orgs", "repos_url": "https://api.github.com/users/brkorb/repos", "events_url": "https://api.github.com/users/brkorb/events{/privacy}", "received_events_url": "https://api.github.com/users/brkorb/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "c8c6d887a57ba81e74f5604b527339b6aaef917e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c8c6d887a57ba81e74f5604b527339b6aaef917e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c8c6d887a57ba81e74f5604b527339b6aaef917e"}], "stats": {"total": 192, "additions": 163, "deletions": 29}, "files": [{"sha": "3f33f4f00b0b2959d1fc5e3479e03902bee741ed", "filename": "gcc/ChangeLog", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7a544ce153d84b697ec10a5acfd9b2e35a94fd87/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7a544ce153d84b697ec10a5acfd9b2e35a94fd87/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=7a544ce153d84b697ec10a5acfd9b2e35a94fd87", "patch": "@@ -1,5 +1,7 @@\n 2000-05-09  Bruce Korb  <bkorb@gnu.org>\n \n+\t* fixinc/check.tpl:  Template for checking fixes\n+\t* fixinc/inclhack.def:  Added 'test_text' for many fixes\n \t* fixinc/fixinc.sco:  Oh, yes, we don't need this any more.\n \n Tue May  9 16:30:27 MET DST 2000  Jan Hubicka  <jh@suse.cz>"}, {"sha": "bf71036e62c04fc7cb11a44864834c2e9b6fd3d5", "filename": "gcc/fixinc/check.tpl", "status": "added", "additions": 78, "deletions": 0, "changes": 78, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7a544ce153d84b697ec10a5acfd9b2e35a94fd87/gcc%2Ffixinc%2Fcheck.tpl", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7a544ce153d84b697ec10a5acfd9b2e35a94fd87/gcc%2Ffixinc%2Fcheck.tpl", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffixinc%2Fcheck.tpl?ref=7a544ce153d84b697ec10a5acfd9b2e35a94fd87", "patch": "@@ -0,0 +1,78 @@\n+[= autogen template sh=check.sh =]\n+[=\n+#\n+#  This file contanes the shell template to run tests on the fixes\n+#\n+=]#!/bin/sh\n+\n+set -e\n+[ -d testdir ] && rm -rf testdir\n+mkdir testdir\n+cd testdir\n+\n+TARGET_MACHINE='*'\n+DESTDIR=`pwd`/res\n+SRCDIR=`pwd`/inc\n+FIND_BASE='.'\n+\n+export TARGET_MACHINE DESTDIR SRCDIR FIND_BASE\n+\n+mkdir ${DESTDIR} ${SRCDIR}\n+\n+( cd ${SRCDIR}\n+  mkdir sys X11 Xm sundev sunwindow )\n+\n+[=\n+\n+_FOR fix =][=\n+\n+  _IF test_text _exist ! =][=\n+    _IF replace _exist ! =]\n+echo No test for [=hackname=][=\n+    _ENDIF =][=\n+  _ELSE =]\n+cat >> inc/[=\n+    _IF files _exist =][=\n+      files[0] =][=\n+    _ELSE =]testing.h[=\n+    _ENDIF =] <<- '_HACK_EOF_'\n+\n+\n+\t#ifndef [=hackname _up=]_CHECK\n+\t#define [=hackname _up=]_CHECK\n+[=test_text \"\\t\" _prefix=]\n+\t#endif  /* [=hackname _up=]_CHECK */\n+_HACK_EOF_\n+[=_ENDIF =][=\n+\n+/fix\n+\n+=]\n+\n+cd inc\n+find . -type f | ../../fixincl\n+cd ..\n+diff -cr inc res | \\\n+  sed -e 's;^\\(\\*\\*\\* inc/[^\t]*\\)\t.*$;\\1;' \\\n+      -e 's;^\\(--- res/[^\t]*\\)\t.*$;\\1;' > NEWDIFF\n+echo\n+echo Test output check:\n+[=\n+\n+_FOR fix =][=\n+\n+  _IF test_text _exist =]\n+fgrep [=hackname _up=]_CHECK NEWDIFF > /dev/null 2>&1 || \\\n+  echo \"[=_eval hackname _get \"#%32s test failed.  See inc/\"\n+          _printf =][=\n+    _IF files _exist =][=\n+      files[0] =][=\n+    _ELSE =]testing.h[=\n+    _ENDIF =]\"[=\n+  _ENDIF =][=\n+\n+/fix\n+\n+=][=\n+_eval _outfile \"chmod +x %s\" _printf _shell\n+=]"}, {"sha": "624913080f2101396983c7892137a60a1574ee66", "filename": "gcc/fixinc/inclhack.def", "status": "modified", "additions": 83, "deletions": 29, "changes": 112, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7a544ce153d84b697ec10a5acfd9b2e35a94fd87/gcc%2Ffixinc%2Finclhack.def", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7a544ce153d84b697ec10a5acfd9b2e35a94fd87/gcc%2Ffixinc%2Finclhack.def", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffixinc%2Finclhack.def?ref=7a544ce153d84b697ec10a5acfd9b2e35a94fd87", "patch": "@@ -1,7 +1,7 @@\n \n /* -*- Mode: C -*-  */\n \n-autogen definitions inclhack;\n+autogen definitions fixincl;\n \n /* Define all the fixes we know about for repairing damaged headers.\n    Please see the README before adding or changing entries in this file.\n@@ -521,11 +521,12 @@ fix = {\n  *  of struct rusage, so the prototype (added by fixproto) causes havoc.\n  */\n fix = {\n-    hackname = aix_syswait;\n-    files    = sys/wait.h;\n-    select = \"bos325,\";\n+    hackname  = aix_syswait;\n+    files     = sys/wait.h;\n+    select    = \"bos325,\";\n     sed    = \"/^extern pid_t wait3();$/i\\\\\\n\"\n              \"struct rusage;\\n\";\n+    test_text = \"/* bos325, */\\nextern pid_t wait3();\";\n };\n \n \n@@ -536,35 +537,38 @@ fix = {\n  *  required by ANSI C.\n  */\n fix = {\n-    hackname = aix_volatile;\n-    files    = sys/signal.h;\n-    select   = \"typedef volatile int sig_atomic_t\";\n+    hackname  = aix_volatile;\n+    files     = sys/signal.h;\n+    select    = \"typedef volatile int sig_atomic_t\";\n     sed      = \"s/typedef volatile int sig_atomic_t\"\n                 \"/typedef int sig_atomic_t/\";\n+    test_text = \"typedef volatile int sig_atomic_t;\";\n };\n \n \n /*\n  *  Fix getopt declarations in stdio.h and stdlib.h on Alpha OSF/1 and AIX.\n  */\n fix = {\n-    hackname = alpha_getopt;\n-    files  = \"stdio.h\";\n-    files  = \"stdlib.h\";\n-    select = 'getopt\\(int, char \\*\\[';\n+    hackname  = alpha_getopt;\n+    files     = \"stdio.h\";\n+    files     = \"stdlib.h\";\n+    select    = 'getopt\\(int, char \\*\\[\\], *char \\*\\)';\n     sed    = 's/getopt(int, char \\*\\[\\],[ ]*char \\*)/'\n                'getopt(int, char *const[], const char *)/';\n+    test_text = 'extern int getopt(int, char *[], char *);';\n };\n \n \n /* \n  * Remove erroneous parentheses in sym.h on Alpha OSF/1.\n  */\n fix = {\n-    hackname = alpha_parens;\n-    files    = sym.h;\n-    select   = '#ifndef\\(__mips64\\)';\n+    hackname  = alpha_parens;\n+    files     = sym.h;\n+    select    = '#ifndef\\(__mips64\\)';\n     sed      = \"s/#ifndef(__mips64)/#ifndef __mips64/\";\n+    test_text = \"#ifndef(__mips64) /* bogus */\\nextern int foo;\\n#endif\";\n };\n \n \n@@ -576,6 +580,7 @@ fix = {\n     files    = unistd.h;\n     select   = \"char[ \\t]*\\\\*[\\t ]*sbrk[ \\t]*\\\\(\";\n     sed  = \"s/char\\\\([ \\t]*\\\\*[\\t ]*sbrk[ \\t]*(\\\\)/void\\\\1/\";\n+    test_text = \"extern char* sbrk(ptrdiff_t increment);\";\n };\n \n \n@@ -584,10 +589,11 @@ fix = {\n  *  hint that is specific to the Norcroft compiler.\n  */\n fix = {\n-    hackname = arm_norcroft_hint;\n-    select   = \"___type p_type\";\n-    files    = \"X11/Intrinsic.h\";\n+    hackname  = arm_norcroft_hint;\n+    select    = \"___type p_type\";\n+    files     = \"X11/Intrinsic.h\";\n     sed      = \"s/___type p_type/p_type/\";\n+    test_text = \"___type p_type mumble;\";\n };\n \n \n@@ -601,6 +607,10 @@ fix = {\n     select = \"#[ \\t]*define[ \\t]*__wchar_t\";\n     sed    = \"s/\\\\(#[ \\t]*ifndef[ \\t]*\\\\)__wchar_t/\\\\1_GCC_WCHAR_T/\";\n     sed    = \"s/\\\\(#[ \\t]*define[ \\t]*\\\\)__wchar_t/\\\\1_GCC_WCHAR_T/\";\n+    test_text =\n+    \"# ifndef \\t __wchar_t /* we don't have wchar_t yet, ... */\\n\"\n+    \"#  define  __wchar_t  short\\n\"\n+    \"# endif /* __wchar_t */\";\n };\n \n \n@@ -614,6 +624,9 @@ fix = {\n     select   = \"#ifndef NOINLINE\";\n     sed      = \"s|#ifndef NOINLINE\"\n                 \"|#if !defined(NOINLINE) \\\\&\\\\& !defined(__GNUC__)|\";\n+    test_text =\n+    \"#ifndef NOINLINE /* ain't got no inline, so we got it */\\n\"\n+    \"#endif /* NOINLINE */\";\n };\n \n \n@@ -661,6 +674,8 @@ fix = {\n \n     sed = \"/^[ ]*typedef[ \\t][ \\t]*unsigned int[ \\t][ \\t]*bool[ \\t]*;/a\\\\\\n\"\n                 \"#endif\\n\";\n+    test_text = \"# define bool\\t char \\n\"\n+                \"typedef unsigned int\\tbool \\t; /* bool type */\";\n };\n \n \n@@ -673,6 +688,7 @@ fix = {\n     select = \"^[ \\t]*typedef[ \\t]+struct[ \\t]+term[ \\t]*;\";\n     sed    = \"s/^[ \\t]*typedef[ \\t][ \\t]*\"\n              \"\\\\(struct[ \\t][ \\t]*term[ \\t]*;[ \\t]*\\\\)$/\\\\1/\";\n+    test_text = 'typedef struct term;';\n };\n \n \n@@ -684,6 +700,7 @@ fix = {\n     hackname = badquote;\n     files    = sundev/vuid_event.h;\n     sed      = \"s/doesn't/does not/\";\n+    test_text = \"/* doesn't have matched single quotes */\";\n };\n \n \n@@ -699,7 +716,7 @@ fix = {\n fix = {\n     hackname = bad_lval;\n \n-    select   = \"^[ \\t]*#[ \\t]*pragma[ \\t][ \\t]*extern_prefix\";\n+    select   = \"^[ \\t]*#[ \\t]*pragma[ \\t]+extern_prefix\";\n \n     files    = libgen.h;\n     files    = dirent.h;\n@@ -716,8 +733,13 @@ fix = {\n     files    = time.h;\n     files    = unistd.h;\n     sed      =\n-        \"s/^[ \\t]*#[ \\t]*define[ \\t]*\\\\([^(]*\\\\)\\\\(([^)]*)\\\\)[ \\t]*\"\n+        \"s/^[ \\t]*#[ \\t]*define[ \\t]+\\\\([^(]*\\\\)\\\\(([^)]*)\\\\)[ \\t]*\"\n                \"\\\\(_.\\\\)\\\\1\\\\2[ \\t]*$/#define \\\\1 \\\\3\\\\1/\";\n+\n+    test_text = '#pragma extern_prefix \"_FOO\"'\"\\n\"\n+                \"#define something(x,y,z) _FOOsomething(x,y,z)\\n\"\n+                \"#define otherwise(x,y,z) BAR_Something(x,y,z)\\n\"\n+                \"#define mumble _FOOmumble\";\n };\n \n \n@@ -728,9 +750,10 @@ fix = {\n     hackname = broken_assert_stdio;\n     files    = assert.h;\n     select   = stderr;\n-    bypass   = \"include.*stdio.h\";\n+    bypass   = \"include.*stdio\\\\.h\";\n     sed      = \"1i\\\\\\n\"\n                \"#include <stdio.h>\\n\";\n+    test_text = \"extern FILE* stderr;\";\n };\n \n \n@@ -741,11 +764,12 @@ fix = {\n     hackname = broken_assert_stdlib;\n     files    = assert.h;\n     select   = 'exit *\\(|abort *\\(';\n-    bypass   = \"include.*stdlib.h\";\n+    bypass   = \"include.*stdlib\\\\.h\";\n     sed      = \"1i\\\\\\n\"\n                \"#ifdef __cplusplus\\\\\\n\"\n                \"#include <stdlib.h>\\\\\\n\"\n                \"#endif\\n\";\n+    test_text = \"extern void exit ( int );\";\n };\n \n \n@@ -759,6 +783,11 @@ fix = {\n     select = '^extern double cabs';\n     sed    = '/^extern double cabs();/d';\n     sed    = '/^extern double cabs(struct dbl_hypot);/d';\n+    test_text = \"#ifdef __STDC__\\n\"\n+                \"extern double cabs(struct dbl_hypot);\\n\"\n+                \"#else\\n\"\n+                \"extern double cabs();\\n\"\n+                \"#endif\";\n };\n \n \n@@ -773,6 +802,10 @@ fix = {\n     sed = \"/^[ \\t]*float[ \\t]*fasm/i\\\\\\n#ifdef __DECC\\n\";\n     sed = \"/^[ \\t]*#[ \\t]*pragma[ \\t]*intrinsic([ \\t]*dasm/a\\\\\\n\"\n           \"#endif\\n\";\n+    test_text =\n+    \"float fasm {\\n\"\n+    \"    ... asm stuff ...\\n\"\n+    \"};\\n#pragma intrinsic( dasm )\\n/* END ASM TEST*/\";\n };\n \n \n@@ -784,6 +817,7 @@ fix = {\n     files  = \"sunwindow/win_lock.h\";\n     files  = \"sunwindow/win_cursor.h\";\n     sed    = \"s/ecd.cursor/ecd_cursor/\";\n+    test_text = \"#ifdef ecd.cursor\\n#error bogus\\n#endif /* ecd+cursor */\";\n };\n \n \n@@ -797,17 +831,19 @@ fix = {\n     select = 'include.*\"\\.\\./machine/';\n     sed    = \"s,\\\"../machine/inline.h\\\",<machine/inline.h>,\";\n     sed    = \"s,\\\"../machine/psl.h\\\",<machine/psl.h>,\";\n+    test_text = '# include \"../machine/fumble.h\"';\n };\n \n \n /*\n  *  Check for (...) in C++ code in HP/UX sys/file.h.\n  */\n fix = {\n-    hackname = hp_sysfile;\n-    files    = sys/file.h;\n-    select   = \"HPUX_SOURCE\";\n+    hackname  = hp_sysfile;\n+    files     = sys/file.h;\n+    select    = \"HPUX_SOURCE\";\n     sed      = 's/(\\.\\.\\.)/(struct file *, ...)/';\n+    test_text = \"extern void foo(...); /* bad varargs */\";\n };\n \n \n@@ -841,13 +877,15 @@ fix = {\n  *  HPUX 10.x sys/param.h defines MAXINT which clashes with values.h\n  */\n fix = {\n-    hackname = hpux_maxint;\n-    files    = sys/param.h;\n+    hackname  = hpux_maxint;\n+    files     = sys/param.h;\n+    select    = \"^#[ \\t]*define[ \\t]*MAXINT[ \\t]\";\n     sed      = \"/^#[ \\t]*define[ \\t]*MAXINT[ \\t]/i\\\\\\n\"\n                \"#ifndef MAXINT\\n\";\n \n     sed      = \"/^#[ \\t]*define[ \\t]*MAXINT[ \\t]/a\\\\\\n\"\n                \"#endif\\n\";\n+    test_text = '#define MAXINT 0x7FFFFFFF';\n };\n \n \n@@ -859,6 +897,7 @@ fix = {\n     files    = sys/time.h;\n     select   = \"^extern struct sigevent;\";\n     sed      = \"s/^extern struct sigevent;/struct sigevent;/\";\n+    test_text = 'extern struct sigevent;';\n };\n \n \n@@ -895,8 +934,10 @@ fix = {\n fix = {\n     hackname = hpux11_uint32_c;\n     files    = inttypes.h;\n-    select   = \"^#define UINT32_C\\\\(__c\\\\)[ \\t]*__CONCAT__\\\\(__CONCAT_U__\\\\(__c\\\\),l\\\\)\";\n+    select   = \"^#define UINT32_C\\\\(__c\\\\)[ \\t]*\"\n+                         \"__CONCAT__\\\\(__CONCAT_U__\\\\(__c\\\\),l\\\\)\";\n     sed      = \"s/^#define UINT32_C(__c)\\\\([ \\t]*\\\\)__CONCAT__(__CONCAT_U__(__c),l)/#define UINT32_C(__c)\\\\1__CONCAT__(__c,ul)/\";\n+    c_fix_arg = '#define UINT32_C(__c) __CONCAT__(__c,ul)';\n };\n \n /*\n@@ -915,10 +956,12 @@ fix = {\n     files  = \"sys/fcntl.h\";\n     files  = \"sys/dirent.h\";\n \n-    select = \"defined\\(__STDC__\\) && !defined\\(_POSIX_SOURCE\\)\";\n-    \n+    select = \"!defined\\(__STDC__\\) && !defined\\(_POSIX_SOURCE\\)\";\n+\n     sed    = \"s/!defined(__STDC__) && !defined(_POSIX_SOURCE)/\"\n                \"!defined(_POSIX_SOURCE)/\";\n+    test_text = \"#if !defined(__STDC__) && !defined(_POSIX_SOURCE) /* ? ! */\"\n+                \"\\nint foo;\\n#endif\";\n };\n \n /*\n@@ -2506,6 +2549,7 @@ fix = {\n     files    = time.h;\n     select   = \"uint_t[ \\t][ \\t]*_clocks_per_sec\";\n     sed      = \"s/uint_t/unsigned int/\";\n+    test_text = \"uint_t\\t_clocks_per_sec;\";\n };\n \n \n@@ -2562,6 +2606,10 @@ fix = {\n                    \"#else\\n\";\n     sed      = \"/char \\\\*class;/a\\\\\\n\"\n                    \"#endif\\n\";\n+    test_text =\n+    \"struct {\\n\"\n+    \"   char *class;\\n\"\n+    \"} mumble;\\n\";\n };\n \n \n@@ -2573,6 +2621,7 @@ fix = {\n     files    = Xm/BaseClassI.h;\n     bypass   = \"__cplusplus\";\n     sed      = \"s/ class[)]/ c_class)/g\";\n+    test_text = \"extern mumble (int  class);\\n\";\n };\n \n \n@@ -2593,6 +2642,10 @@ fix = {\n                    \"#endif\\n\";\n \n     sed      = \"s/Widget new,/Widget c_new,/g\";\n+    test_text =\n+    \"struct wedge {\\n\"\n+    \"   Widget\\told, new; /* fix the new */\\n\"\n+    \"};\\nextern Wedged( Widget new, Widget old );\";\n };\n \n \n@@ -2608,6 +2661,7 @@ fix = {\n     sed      = \"s,^extern char \\\\*\\tsprintf();$,#ifndef __STDC__\\\\\\n\"\n                \"extern char *\\tsprintf();\\\\\\n\"\n                \"#endif /* !defined __STDC__ */,\";\n+    test_text = \"extern char *\\tsprintf();\";\n };\n \n /*EOF*/"}]}