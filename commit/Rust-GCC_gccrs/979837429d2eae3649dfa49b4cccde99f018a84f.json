{"sha": "979837429d2eae3649dfa49b4cccde99f018a84f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTc5ODM3NDI5ZDJlYWUzNjQ5ZGZhNDliNGNjY2RlOTlmMDE4YTg0Zg==", "commit": {"author": {"name": "Paul Brook", "email": "paul@codesourcery.com", "date": "2004-05-13T23:11:47Z"}, "committer": {"name": "Paul Brook", "email": "pbrook@gcc.gnu.org", "date": "2004-05-13T23:11:47Z"}, "message": "re PR fortran/15314 (ICE caused by array initializer in derived type definition)\n\n\tPR fortran/15314\n\t* trans-expr.c (gfc_conv_structure): Use field type, not expr type.\n\nFrom-SVN: r81816", "tree": {"sha": "856971393ad62f09764aa4f3cfdfb1d86371d618", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/856971393ad62f09764aa4f3cfdfb1d86371d618"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/979837429d2eae3649dfa49b4cccde99f018a84f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/979837429d2eae3649dfa49b4cccde99f018a84f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/979837429d2eae3649dfa49b4cccde99f018a84f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/979837429d2eae3649dfa49b4cccde99f018a84f/comments", "author": null, "committer": null, "parents": [{"sha": "15342341aa4ade477abe31ccba4333d6dfc2956b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/15342341aa4ade477abe31ccba4333d6dfc2956b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/15342341aa4ade477abe31ccba4333d6dfc2956b"}], "stats": {"total": 20, "additions": 10, "deletions": 10}, "files": [{"sha": "e32d1885ed81d28b9a05f011f8d46df684e0fc82", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/979837429d2eae3649dfa49b4cccde99f018a84f/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/979837429d2eae3649dfa49b4cccde99f018a84f/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=979837429d2eae3649dfa49b4cccde99f018a84f", "patch": "@@ -1,3 +1,8 @@\n+2004-05-13  Paul Brook  <paul@codesourcery.com>\n+\n+\tPR fortran/15314\n+\t* trans-expr.c (gfc_conv_structure): Use field type, not expr type.\n+\n 2004-05-13  Joseph S. Myers  <jsm@polyomino.org.uk>\n \n \t* gfortran.texi: Use @table @emph instead of @itemize @emph."}, {"sha": "1f98f9e1a89c6baaea1a0445afc95a237d0c338b", "filename": "gcc/fortran/trans-expr.c", "status": "modified", "additions": 5, "deletions": 10, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/979837429d2eae3649dfa49b4cccde99f018a84f/gcc%2Ffortran%2Ftrans-expr.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/979837429d2eae3649dfa49b4cccde99f018a84f/gcc%2Ffortran%2Ftrans-expr.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-expr.c?ref=979837429d2eae3649dfa49b4cccde99f018a84f", "patch": "@@ -1292,20 +1292,15 @@ gfc_conv_structure (gfc_se * se, gfc_expr * expr, int init)\n       /* Evaluate the expression for this component.  */\n       if (init)\n \t{\n-\t  switch (c->expr->expr_type)\n+\t  if (cm->dimension)\n \t    {\n-\t    case EXPR_ARRAY:\n \t      arraytype = TREE_TYPE (cm->backend_decl);\n \t      cse.expr = gfc_conv_array_initializer (arraytype, c->expr);\n-\t      break;\n-\n-\t    case EXPR_STRUCTURE:\n-\t      gfc_conv_structure (&cse, c->expr, 1);\n-\t      break;\n-\n-\t    default:\n-\t      gfc_conv_expr (&cse, c->expr);\n \t    }\n+\t  else if (cm->ts.type == BT_DERIVED)\n+\t    gfc_conv_structure (&cse, c->expr, 1);\n+\t  else\n+\t    gfc_conv_expr (&cse, c->expr);\n \t}\n       else\n \t{"}]}