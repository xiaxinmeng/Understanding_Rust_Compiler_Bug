{"sha": "d731ee04423f788ff370a82eab69b4038bb14cdd", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDczMWVlMDQ0MjNmNzg4ZmYzNzBhODJlYWI2OWI0MDM4YmIxNGNkZA==", "commit": {"author": {"name": "Bin Cheng", "email": "bin.cheng@arm.com", "date": "2014-03-13T02:40:08Z"}, "committer": {"name": "Bin Cheng", "email": "amker@gcc.gnu.org", "date": "2014-03-13T02:40:08Z"}, "message": "tree-cfgcleanup.c (remove_forwarder_block_with_phi): Record BB's single pred and update the father loop's latch info later.\n\n\n\t* tree-cfgcleanup.c (remove_forwarder_block_with_phi): Record\n\tBB's single pred and update the father loop's latch info later.\n\nFrom-SVN: r208527", "tree": {"sha": "a7906c5a290183421fef8db4d70832d51442a831", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a7906c5a290183421fef8db4d70832d51442a831"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d731ee04423f788ff370a82eab69b4038bb14cdd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d731ee04423f788ff370a82eab69b4038bb14cdd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d731ee04423f788ff370a82eab69b4038bb14cdd", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d731ee04423f788ff370a82eab69b4038bb14cdd/comments", "author": null, "committer": null, "parents": [{"sha": "9f493d9da64d9f3810e6acc83c304ce84cd71449", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9f493d9da64d9f3810e6acc83c304ce84cd71449", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9f493d9da64d9f3810e6acc83c304ce84cd71449"}], "stats": {"total": 16, "additions": 16, "deletions": 0}, "files": [{"sha": "beea3437a4731d4dc480ad4581913d5d7a1c59fe", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d731ee04423f788ff370a82eab69b4038bb14cdd/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d731ee04423f788ff370a82eab69b4038bb14cdd/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=d731ee04423f788ff370a82eab69b4038bb14cdd", "patch": "@@ -1,3 +1,8 @@\n+2014-03-13  Bin Cheng  <bin.cheng@arm.com>\n+\n+\t* tree-cfgcleanup.c (remove_forwarder_block_with_phi): Record\n+\tBB's single pred and update the father loop's latch info later.\n+\n 2014-03-12  Michael Meissner  <meissner@linux.vnet.ibm.com>\n \n \t* config/rs6000/vector.md (VEC_L): Add V1TI mode to vector types."}, {"sha": "08401dd2db64d93952514ad2fc718c1931d470bd", "filename": "gcc/tree-cfgcleanup.c", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d731ee04423f788ff370a82eab69b4038bb14cdd/gcc%2Ftree-cfgcleanup.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d731ee04423f788ff370a82eab69b4038bb14cdd/gcc%2Ftree-cfgcleanup.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-cfgcleanup.c?ref=d731ee04423f788ff370a82eab69b4038bb14cdd", "patch": "@@ -820,6 +820,12 @@ remove_forwarder_block_with_phi (basic_block bb)\n       && DECL_NONLOCAL (gimple_label_label (label)))\n     return false;\n \n+  /* Record BB's single pred in case we need to update the father\n+     loop's latch information later.  */\n+  basic_block pred = NULL;\n+  if (single_pred_p (bb))\n+    pred = single_pred (bb);\n+\n   /* Redirect each incoming edge to BB to DEST.  */\n   while (EDGE_COUNT (bb->preds) > 0)\n     {\n@@ -904,6 +910,11 @@ remove_forwarder_block_with_phi (basic_block bb)\n \n   set_immediate_dominator (CDI_DOMINATORS, dest, dom);\n \n+  /* Adjust latch infomation of BB's parent loop as otherwise\n+     the cfg hook has a hard time not to kill the loop.  */\n+  if (current_loops && bb->loop_father->latch == bb)\n+    bb->loop_father->latch = pred;\n+\n   /* Remove BB since all of BB's incoming edges have been redirected\n      to DEST.  */\n   delete_basic_block (bb);"}]}