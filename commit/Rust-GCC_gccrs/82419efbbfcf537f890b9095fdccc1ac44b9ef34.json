{"sha": "82419efbbfcf537f890b9095fdccc1ac44b9ef34", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODI0MTllZmJiZmNmNTM3Zjg5MGI5MDk1ZmRjY2MxYWM0NGI5ZWYzNA==", "commit": {"author": {"name": "Tom de Vries", "email": "tom@codesourcery.com", "date": "2017-09-14T21:15:40Z"}, "committer": {"name": "Tom de Vries", "email": "vries@gcc.gnu.org", "date": "2017-09-14T21:15:40Z"}, "message": "Introduce libgomp/testsuite/libgomp.c-c++-common\n\n2017-09-14  Tom de Vries  <tom@codesourcery.com>\n\n\t* testsuite/libgomp.c++/cancel-taskgroup-1.C: Remove.\n\t* testsuite/libgomp.c/cancel-taskgroup-1.c: Move to ...\n\t* testsuite/libgomp.c-c++-common/cancel-taskgroup-1.c: ... here.\n\t* testsuite/libgomp.c/c.exp: Include test-cases from\n\tlibgomp.c-c++-common.\n\t* testsuite/libgomp.c++/c++.exp: Same.  Force c++-mode compilation of .c\n\tfiles.\n\nFrom-SVN: r252775", "tree": {"sha": "ed1bf026e4635d1e7bb092e666ee4b13e1acfbc6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ed1bf026e4635d1e7bb092e666ee4b13e1acfbc6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/82419efbbfcf537f890b9095fdccc1ac44b9ef34", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/82419efbbfcf537f890b9095fdccc1ac44b9ef34", "html_url": "https://github.com/Rust-GCC/gccrs/commit/82419efbbfcf537f890b9095fdccc1ac44b9ef34", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/82419efbbfcf537f890b9095fdccc1ac44b9ef34/comments", "author": null, "committer": null, "parents": [{"sha": "12fca96eb386678706a0d87515c2d3412a67ad4d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/12fca96eb386678706a0d87515c2d3412a67ad4d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/12fca96eb386678706a0d87515c2d3412a67ad4d"}], "stats": {"total": 30, "additions": 24, "deletions": 6}, "files": [{"sha": "9fafd622b60311de75c0feefc42fc162a3d2600f", "filename": "libgomp/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/82419efbbfcf537f890b9095fdccc1ac44b9ef34/libgomp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/82419efbbfcf537f890b9095fdccc1ac44b9ef34/libgomp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2FChangeLog?ref=82419efbbfcf537f890b9095fdccc1ac44b9ef34", "patch": "@@ -1,3 +1,13 @@\n+2017-09-14  Tom de Vries  <tom@codesourcery.com>\n+\n+\t* testsuite/libgomp.c++/cancel-taskgroup-1.C: Remove.\n+\t* testsuite/libgomp.c/cancel-taskgroup-1.c: Move to ...\n+\t* testsuite/libgomp.c-c++-common/cancel-taskgroup-1.c: ... here.\n+\t* testsuite/libgomp.c/c.exp: Include test-cases from\n+\tlibgomp.c-c++-common.\n+\t* testsuite/libgomp.c++/c++.exp: Same.  Force c++-mode compilation of .c\n+\tfiles.\n+\n 2017-09-14  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR c++/81314"}, {"sha": "f4884e2ffa7a85932fc769cd90357da4040d522f", "filename": "libgomp/testsuite/libgomp.c++/c++.exp", "status": "modified", "additions": 11, "deletions": 1, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/82419efbbfcf537f890b9095fdccc1ac44b9ef34/libgomp%2Ftestsuite%2Flibgomp.c%2B%2B%2Fc%2B%2B.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/82419efbbfcf537f890b9095fdccc1ac44b9ef34/libgomp%2Ftestsuite%2Flibgomp.c%2B%2B%2Fc%2B%2B.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Ftestsuite%2Flibgomp.c%2B%2B%2Fc%2B%2B.exp?ref=82419efbbfcf537f890b9095fdccc1ac44b9ef34", "patch": "@@ -22,6 +22,11 @@ dg-init\n # Turn on OpenMP.\n lappend ALWAYS_CFLAGS \"additional_flags=-fopenmp\"\n \n+# Switch into C++ mode.  Otherwise, the libgomp.c-c++-common/*.c\n+# files would be compiled as C files.\n+set SAVE_GCC_UNDER_TEST \"$GCC_UNDER_TEST\"\n+set GCC_UNDER_TEST \"$GCC_UNDER_TEST -x c++\"\n+\n set blddir [lookfor_file [get_multilibs] libgomp]\n \n \n@@ -47,7 +52,9 @@ if { $blddir != \"\" } {\n \n if { $lang_test_file_found } {\n     # Gather a list of all tests.\n-    set tests [lsort [find $srcdir/$subdir *.C]]\n+    set tests [lsort [concat \\\n+\t\t\t  [find $srcdir/$subdir *.C] \\\n+\t\t\t  [find $srcdir/$subdir/../libgomp.c-c++-common *.c]]]\n \n     if { $blddir != \"\" } {\n         set ld_library_path \"$always_ld_library_path:${blddir}/${lang_library_path}\"\n@@ -68,5 +75,8 @@ if { $lang_test_file_found } {\n     dg-runtest $tests \"\" \"$libstdcxx_includes $DEFAULT_CFLAGS\"\n }\n \n+# See above.\n+set GCC_UNDER_TEST \"$SAVE_GCC_UNDER_TEST\"\n+\n # All done.\n dg-finish"}, {"sha": "4f66859d171d65096e54328c8884fde130b5775c", "filename": "libgomp/testsuite/libgomp.c++/cancel-taskgroup-1.C", "status": "removed", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/12fca96eb386678706a0d87515c2d3412a67ad4d/libgomp%2Ftestsuite%2Flibgomp.c%2B%2B%2Fcancel-taskgroup-1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/12fca96eb386678706a0d87515c2d3412a67ad4d/libgomp%2Ftestsuite%2Flibgomp.c%2B%2B%2Fcancel-taskgroup-1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Ftestsuite%2Flibgomp.c%2B%2B%2Fcancel-taskgroup-1.C?ref=12fca96eb386678706a0d87515c2d3412a67ad4d", "patch": "@@ -1,4 +0,0 @@\n-// { dg-do run }\n-// { dg-set-target-env-var OMP_CANCELLATION \"true\" }\n-\n-#include \"../libgomp.c/cancel-taskgroup-1.c\""}, {"sha": "5a808113fb07092c2b316c2d25b7b2ef66ce1c82", "filename": "libgomp/testsuite/libgomp.c-c++-common/cancel-taskgroup-1.c", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/82419efbbfcf537f890b9095fdccc1ac44b9ef34/libgomp%2Ftestsuite%2Flibgomp.c-c%2B%2B-common%2Fcancel-taskgroup-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/82419efbbfcf537f890b9095fdccc1ac44b9ef34/libgomp%2Ftestsuite%2Flibgomp.c-c%2B%2B-common%2Fcancel-taskgroup-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Ftestsuite%2Flibgomp.c-c%2B%2B-common%2Fcancel-taskgroup-1.c?ref=82419efbbfcf537f890b9095fdccc1ac44b9ef34", "previous_filename": "libgomp/testsuite/libgomp.c/cancel-taskgroup-1.c"}, {"sha": "31bdd5795dc27cb159fd74700b277a8d69311c30", "filename": "libgomp/testsuite/libgomp.c/c.exp", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/82419efbbfcf537f890b9095fdccc1ac44b9ef34/libgomp%2Ftestsuite%2Flibgomp.c%2Fc.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/82419efbbfcf537f890b9095fdccc1ac44b9ef34/libgomp%2Ftestsuite%2Flibgomp.c%2Fc.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Ftestsuite%2Flibgomp.c%2Fc.exp?ref=82419efbbfcf537f890b9095fdccc1ac44b9ef34", "patch": "@@ -24,7 +24,9 @@ dg-init\n lappend ALWAYS_CFLAGS \"additional_flags=-fopenmp\"\n \n # Gather a list of all tests.\n-set tests [lsort [find $srcdir/$subdir *.c]]\n+set tests [lsort [concat \\\n+\t\t      [find $srcdir/$subdir *.c] \\\n+\t\t      [find $srcdir/$subdir/../libgomp.c-c++-common *.c]]]\n \n set ld_library_path $always_ld_library_path\n append ld_library_path [gcc-set-multilib-library-path $GCC_UNDER_TEST]"}]}