{"sha": "fb7ca5a762a94ab5c7f3d16831b3dc037dfa6619", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZmI3Y2E1YTc2MmE5NGFiNWM3ZjNkMTY4MzFiM2RjMDM3ZGZhNjYxOQ==", "commit": {"author": {"name": "Janus Weil", "email": "janus@gcc.gnu.org", "date": "2008-12-06T12:15:49Z"}, "committer": {"name": "Janus Weil", "email": "janus@gcc.gnu.org", "date": "2008-12-06T12:15:49Z"}, "message": "re PR fortran/38415 (procedure pointer assignment to abstract interface)\n\n2008-12-06  Janus Weil  <janus@gcc.gnu.org>\n\n\tPR fortran/38415\n\t* expr.c (gfc_check_pointer_assign): Added a check for abstract\n\tinterfaces in procedure pointer assignments, removed check involving\n\tgfc_compare_interfaces until PR38290 is fixed completely.\n\n\n2008-12-06  Janus Weil  <janus@gcc.gnu.org>\n\n\tPR fortran/38415\n\t* gfortran.dg/proc_ptr_2.f90: Extended.\n\t* gfortran.dg/proc_ptr_11.f90: Modified.\n\nFrom-SVN: r142520", "tree": {"sha": "5a9334a2b80c82df9dca83e90e67075a67ae7527", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5a9334a2b80c82df9dca83e90e67075a67ae7527"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/fb7ca5a762a94ab5c7f3d16831b3dc037dfa6619", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fb7ca5a762a94ab5c7f3d16831b3dc037dfa6619", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fb7ca5a762a94ab5c7f3d16831b3dc037dfa6619", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fb7ca5a762a94ab5c7f3d16831b3dc037dfa6619/comments", "author": {"login": "janusw", "id": 484108, "node_id": "MDQ6VXNlcjQ4NDEwOA==", "avatar_url": "https://avatars.githubusercontent.com/u/484108?v=4", "gravatar_id": "", "url": "https://api.github.com/users/janusw", "html_url": "https://github.com/janusw", "followers_url": "https://api.github.com/users/janusw/followers", "following_url": "https://api.github.com/users/janusw/following{/other_user}", "gists_url": "https://api.github.com/users/janusw/gists{/gist_id}", "starred_url": "https://api.github.com/users/janusw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/janusw/subscriptions", "organizations_url": "https://api.github.com/users/janusw/orgs", "repos_url": "https://api.github.com/users/janusw/repos", "events_url": "https://api.github.com/users/janusw/events{/privacy}", "received_events_url": "https://api.github.com/users/janusw/received_events", "type": "User", "site_admin": false}, "committer": {"login": "janusw", "id": 484108, "node_id": "MDQ6VXNlcjQ4NDEwOA==", "avatar_url": "https://avatars.githubusercontent.com/u/484108?v=4", "gravatar_id": "", "url": "https://api.github.com/users/janusw", "html_url": "https://github.com/janusw", "followers_url": "https://api.github.com/users/janusw/followers", "following_url": "https://api.github.com/users/janusw/following{/other_user}", "gists_url": "https://api.github.com/users/janusw/gists{/gist_id}", "starred_url": "https://api.github.com/users/janusw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/janusw/subscriptions", "organizations_url": "https://api.github.com/users/janusw/orgs", "repos_url": "https://api.github.com/users/janusw/repos", "events_url": "https://api.github.com/users/janusw/events{/privacy}", "received_events_url": "https://api.github.com/users/janusw/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "22493a73d5952c7d84908d8cc2abbb21264e3d5f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/22493a73d5952c7d84908d8cc2abbb21264e3d5f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/22493a73d5952c7d84908d8cc2abbb21264e3d5f"}], "stats": {"total": 36, "additions": 34, "deletions": 2}, "files": [{"sha": "0fed3d2957075e3759a4930a8842bd4b6ed52571", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fb7ca5a762a94ab5c7f3d16831b3dc037dfa6619/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fb7ca5a762a94ab5c7f3d16831b3dc037dfa6619/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=fb7ca5a762a94ab5c7f3d16831b3dc037dfa6619", "patch": "@@ -1,3 +1,10 @@\n+2008-12-06  Janus Weil  <janus@gcc.gnu.org>\n+\n+\tPR fortran/38415\n+\t* expr.c (gfc_check_pointer_assign): Added a check for abstract\n+\tinterfaces in procedure pointer assignments, removed check involving\n+\tgfc_compare_interfaces until PR38290 is fixed completely.\n+\n 2008-12-05  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n \n \tPR fortran/38291"}, {"sha": "07dfc7a08a31fc953b8dfca9967274c4bfc38469", "filename": "gcc/fortran/expr.c", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fb7ca5a762a94ab5c7f3d16831b3dc037dfa6619/gcc%2Ffortran%2Fexpr.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fb7ca5a762a94ab5c7f3d16831b3dc037dfa6619/gcc%2Ffortran%2Fexpr.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fexpr.c?ref=fb7ca5a762a94ab5c7f3d16831b3dc037dfa6619", "patch": "@@ -3125,6 +3125,13 @@ gfc_check_pointer_assign (gfc_expr *lvalue, gfc_expr *rvalue)\n \t\t     &rvalue->where);\n \t  return FAILURE;\n \t}\n+      if (attr.abstract)\n+\t{\n+\t  gfc_error (\"Abstract interface '%s' is invalid \"\n+\t\t     \"in procedure pointer assignment at %L\",\n+\t\t     rvalue->symtree->name, &rvalue->where);\n+\t}\n+      /* TODO. See PR 38290.\n       if (rvalue->expr_type == EXPR_VARIABLE\n \t  && lvalue->symtree->n.sym->attr.if_source != IFSRC_UNKNOWN\n \t  && !gfc_compare_interfaces (lvalue->symtree->n.sym,\n@@ -3133,7 +3140,7 @@ gfc_check_pointer_assign (gfc_expr *lvalue, gfc_expr *rvalue)\n \t  gfc_error (\"Interfaces don't match \"\n \t\t     \"in procedure pointer assignment at %L\", &rvalue->where);\n \t  return FAILURE;\n-\t}\n+\t}*/\n       return SUCCESS;\n     }\n "}, {"sha": "2c7ee3cba637e9f3ba6897470d27cbfa19769d73", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fb7ca5a762a94ab5c7f3d16831b3dc037dfa6619/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fb7ca5a762a94ab5c7f3d16831b3dc037dfa6619/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=fb7ca5a762a94ab5c7f3d16831b3dc037dfa6619", "patch": "@@ -1,3 +1,9 @@\n+2008-12-06  Janus Weil  <janus@gcc.gnu.org>\n+\n+\tPR fortran/38415\n+\t* gfortran.dg/proc_ptr_2.f90: Extended.\n+\t* gfortran.dg/proc_ptr_11.f90: Modified.\n+\n 2008-12-05  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n \n \tPR fortran/38291"}, {"sha": "69bf140b818c7775a6d3c8749acfd50dce9c0748", "filename": "gcc/testsuite/gfortran.dg/proc_ptr_11.f90", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fb7ca5a762a94ab5c7f3d16831b3dc037dfa6619/gcc%2Ftestsuite%2Fgfortran.dg%2Fproc_ptr_11.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fb7ca5a762a94ab5c7f3d16831b3dc037dfa6619/gcc%2Ftestsuite%2Fgfortran.dg%2Fproc_ptr_11.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fproc_ptr_11.f90?ref=fb7ca5a762a94ab5c7f3d16831b3dc037dfa6619", "patch": "@@ -14,8 +14,12 @@ end subroutine up\n   end interface\n \n   procedure( up ) , pointer :: pptr\n+  procedure(isign), pointer :: q\n \n-  pptr => add   ! { dg-error \"Interfaces don't match\" }\n+  ! TODO. See PR 38290.\n+  !pptr => add   ! { \"Interfaces don't match\" }\n+\n+  q => add\n \n   print *, pptr()   ! { dg-error \"is not a function\" }\n "}, {"sha": "98539b985af167891a2152650e4f3b55a45683ac", "filename": "gcc/testsuite/gfortran.dg/proc_ptr_2.f90", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fb7ca5a762a94ab5c7f3d16831b3dc037dfa6619/gcc%2Ftestsuite%2Fgfortran.dg%2Fproc_ptr_2.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fb7ca5a762a94ab5c7f3d16831b3dc037dfa6619/gcc%2Ftestsuite%2Fgfortran.dg%2Fproc_ptr_2.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fproc_ptr_2.f90?ref=fb7ca5a762a94ab5c7f3d16831b3dc037dfa6619", "patch": "@@ -8,10 +8,18 @@\n PROCEDURE(REAL), SAVE    :: noptr    ! { dg-error \"attribute conflicts with\" }\n REAL :: x\n \n+ abstract interface\n+   subroutine bar(a)\n+     integer :: a\n+   end subroutine bar\n+ end interface\n+\n ptr => cos(4.0)        ! { dg-error \"Invalid procedure pointer assignment\" }\n ptr => x               ! { dg-error \"Invalid procedure pointer assignment\" }\n ptr => sin(x)          ! { dg-error \"Invalid procedure pointer assignment\" }\n \n+ptr => bar             ! { dg-error \"is invalid in procedure pointer assignment\" }\n+\n ALLOCATE(ptr)          ! { dg-error \"must be ALLOCATABLE\" }\n \n end"}]}