{"sha": "48b6cd9d20b473886b39b2a206765da747a88484", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDhiNmNkOWQyMGI0NzM4ODZiMzliMmEyMDY3NjVkYTc0N2E4ODQ4NA==", "commit": {"author": {"name": "Simon Martin", "email": "simartin@users.sourceforge.net", "date": "2009-03-27T13:17:37Z"}, "committer": {"name": "H.J. Lu", "email": "hjl@gcc.gnu.org", "date": "2009-03-27T13:17:37Z"}, "message": "re PR c++/37647 (ICE with invalid use of constructor)\n\ngcc/cp/\n\n2009-03-27  Simon Martin  <simartin@users.sourceforge.net>\n\n\tPR c++/37647\n\t* decl.c (grokdeclarator): Reject [con|de]stuctors in a non-class\n\tscope.\n\ngcc/testsuite/\n\n2009-03-27  Simon Martin  <simartin@users.sourceforge.net>\n\n\tPR c++/37647\n\t* g++.dg/parse/ctor9.C: New test.\n\nFrom-SVN: r145105", "tree": {"sha": "c2bdd6259ed4f3763cf7a439c4ddf12a39f71514", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c2bdd6259ed4f3763cf7a439c4ddf12a39f71514"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/48b6cd9d20b473886b39b2a206765da747a88484", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/48b6cd9d20b473886b39b2a206765da747a88484", "html_url": "https://github.com/Rust-GCC/gccrs/commit/48b6cd9d20b473886b39b2a206765da747a88484", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/48b6cd9d20b473886b39b2a206765da747a88484/comments", "author": {"login": "simartin", "id": 935202, "node_id": "MDQ6VXNlcjkzNTIwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/935202?v=4", "gravatar_id": "", "url": "https://api.github.com/users/simartin", "html_url": "https://github.com/simartin", "followers_url": "https://api.github.com/users/simartin/followers", "following_url": "https://api.github.com/users/simartin/following{/other_user}", "gists_url": "https://api.github.com/users/simartin/gists{/gist_id}", "starred_url": "https://api.github.com/users/simartin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/simartin/subscriptions", "organizations_url": "https://api.github.com/users/simartin/orgs", "repos_url": "https://api.github.com/users/simartin/repos", "events_url": "https://api.github.com/users/simartin/events{/privacy}", "received_events_url": "https://api.github.com/users/simartin/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "6a837908f994e64fa285acdcc1183e9d0e41ff9a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6a837908f994e64fa285acdcc1183e9d0e41ff9a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6a837908f994e64fa285acdcc1183e9d0e41ff9a"}], "stats": {"total": 26, "additions": 26, "deletions": 0}, "files": [{"sha": "d12059420346186ee28169cca0e742a38951fb5a", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/48b6cd9d20b473886b39b2a206765da747a88484/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/48b6cd9d20b473886b39b2a206765da747a88484/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=48b6cd9d20b473886b39b2a206765da747a88484", "patch": "@@ -1,3 +1,9 @@\n+2009-03-27  Simon Martin  <simartin@users.sourceforge.net>\n+\n+\tPR c++/37647\n+\t* decl.c (grokdeclarator): Reject [con|de]stuctors in a non-class\n+\tscope.\n+\n 2009-03-27  Simon Martin  <simartin@users.sourceforge.net>\n \n \tPR c++/29727"}, {"sha": "b16ae262bea3ca7d487a52b1709fd7dea30cfb8b", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/48b6cd9d20b473886b39b2a206765da747a88484/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/48b6cd9d20b473886b39b2a206765da747a88484/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=48b6cd9d20b473886b39b2a206765da747a88484", "patch": "@@ -9346,6 +9346,14 @@ grokdeclarator (const cp_declarator *declarator,\n \t\terror (\"virtual non-class function %qs\", name);\n \t\tvirtualp = 0;\n \t      }\n+\t    else if (sfk == sfk_constructor\n+\t\t     || sfk == sfk_destructor)\n+\t      {\n+\t\terror (funcdef_flag\n+\t\t       ? \"%qs defined in a non-class scope\"\n+\t\t       : \"%qs declared in a non-class scope\", name);\n+\t\tsfk = sfk_none;\n+\t      }\n \t  }\n \telse if (TREE_CODE (type) == FUNCTION_TYPE && staticp < 2\n \t\t && !NEW_DELETE_OPNAME_P (original_name))"}, {"sha": "82fc8ab70cae22ca85e37a590c8be801e2539f0e", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/48b6cd9d20b473886b39b2a206765da747a88484/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/48b6cd9d20b473886b39b2a206765da747a88484/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=48b6cd9d20b473886b39b2a206765da747a88484", "patch": "@@ -1,3 +1,8 @@\n+2009-03-27  Simon Martin  <simartin@users.sourceforge.net>\n+\n+\tPR c++/37647\n+\t* g++.dg/parse/ctor9.C: New test.\n+\n 2009-03-27  Simon Martin  <simartin@users.sourceforge.net>\n \n \tPR c++/29727"}, {"sha": "b80f7289253d4b4e9ab8e6867be7219b9ca93675", "filename": "gcc/testsuite/g++.dg/parse/ctor9.C", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/48b6cd9d20b473886b39b2a206765da747a88484/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Fctor9.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/48b6cd9d20b473886b39b2a206765da747a88484/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Fctor9.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Fctor9.C?ref=48b6cd9d20b473886b39b2a206765da747a88484", "patch": "@@ -0,0 +1,7 @@\n+/* PR c++/37647 */\n+/* { dg-do \"compile\" } */\n+\n+struct A\n+{\n+  A() { void A(); } /* { dg-error \"return type specification for constructor invalid|non-class scope\" } */\n+};"}]}