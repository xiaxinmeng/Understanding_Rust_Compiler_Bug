{"sha": "39b4020ca1c28fb1a27813920bda7cdec3bc77f4", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzliNDAyMGNhMWMyOGZiMWEyNzgxMzkyMGJkYTdjZGVjM2JjNzdmNA==", "commit": {"author": {"name": "Richard Sandiford", "email": "rsandifo@redhat.com", "date": "2005-04-04T19:42:51Z"}, "committer": {"name": "Richard Sandiford", "email": "rsandifo@gcc.gnu.org", "date": "2005-04-04T19:42:51Z"}, "message": "Makefile.in (tree-ssa-loop-ivopts.o): Depend on langhooks.h.\n\n\t* Makefile.in (tree-ssa-loop-ivopts.o): Depend on langhooks.h.\n\t* tree-ssa-loop-ivopts.c: Include langhooks.h.\n\t(add_standard_iv_candidates_for_size): New function, extracting code\n\tfrom add_standard_iv_candidates and parameterizing it by type size.\n\t(add_standard_iv_candidates): Use add_standard_iv_candidates_for_size.\n\nFrom-SVN: r97571", "tree": {"sha": "4998e29147da8a4841f600c5183c7ec26e00e07a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4998e29147da8a4841f600c5183c7ec26e00e07a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/39b4020ca1c28fb1a27813920bda7cdec3bc77f4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/39b4020ca1c28fb1a27813920bda7cdec3bc77f4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/39b4020ca1c28fb1a27813920bda7cdec3bc77f4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/39b4020ca1c28fb1a27813920bda7cdec3bc77f4/comments", "author": null, "committer": null, "parents": [{"sha": "251e2ff23fc7a7c7a319dee3fa6acac3d8c2642a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/251e2ff23fc7a7c7a319dee3fa6acac3d8c2642a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/251e2ff23fc7a7c7a319dee3fa6acac3d8c2642a"}], "stats": {"total": 38, "additions": 26, "deletions": 12}, "files": [{"sha": "846f6f2f012b6ab6a3cbc7e48ad55d78634d845f", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/39b4020ca1c28fb1a27813920bda7cdec3bc77f4/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/39b4020ca1c28fb1a27813920bda7cdec3bc77f4/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=39b4020ca1c28fb1a27813920bda7cdec3bc77f4", "patch": "@@ -1,3 +1,11 @@\n+2004-04-04  Richard Sandiford  <rsandifo@redhat.com>\n+\n+\t* Makefile.in (tree-ssa-loop-ivopts.o): Depend on langhooks.h.\n+\t* tree-ssa-loop-ivopts.c: Include langhooks.h.\n+\t(add_standard_iv_candidates_for_size): New function, extracting code\n+\tfrom add_standard_iv_candidates and parameterizing it by type size.\n+\t(add_standard_iv_candidates): Use add_standard_iv_candidates_for_size.\n+\n 2004-04-04  Richard Sandiford  <rsandifo@redhat.com>\n \n \t* system.h (GCOV_SIZE_TYPE): Unposion."}, {"sha": "b73170a9427ba9c299d10c31cdd062a79759cb74", "filename": "gcc/Makefile.in", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/39b4020ca1c28fb1a27813920bda7cdec3bc77f4/gcc%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/39b4020ca1c28fb1a27813920bda7cdec3bc77f4/gcc%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FMakefile.in?ref=39b4020ca1c28fb1a27813920bda7cdec3bc77f4", "patch": "@@ -1746,7 +1746,7 @@ tree-ssa-loop-ivopts.o : tree-ssa-loop-ivopts.c $(TREE_FLOW_H) $(CONFIG_H) \\\n    $(SYSTEM_H) $(RTL_H) $(TREE_H) $(TM_P_H) $(CFGLOOP_H) varray.h $(EXPR_H) \\\n    output.h diagnostic.h $(TIMEVAR_H) $(TM_H) coretypes.h $(TREE_DUMP_H) \\\n    tree-pass.h $(GGC_H) $(RECOG_H) insn-config.h $(HASHTAB_H) $(SCEV_H) \\\n-   cfgloop.h $(PARAMS_H) sbitmap.h\n+   cfgloop.h $(PARAMS_H) sbitmap.h langhooks.h\n tree-ssa-loop-manip.o : tree-ssa-loop-manip.c $(TREE_FLOW_H) $(CONFIG_H) \\\n    $(SYSTEM_H) $(RTL_H) $(TREE_H) $(TM_P_H) $(CFGLOOP_H) \\\n    output.h diagnostic.h $(TIMEVAR_H) $(TM_H) coretypes.h $(TREE_DUMP_H) \\"}, {"sha": "494b41ec736cf539106e07a79b4ff7ee80976612", "filename": "gcc/tree-ssa-loop-ivopts.c", "status": "modified", "additions": 17, "deletions": 11, "changes": 28, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/39b4020ca1c28fb1a27813920bda7cdec3bc77f4/gcc%2Ftree-ssa-loop-ivopts.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/39b4020ca1c28fb1a27813920bda7cdec3bc77f4/gcc%2Ftree-ssa-loop-ivopts.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-loop-ivopts.c?ref=39b4020ca1c28fb1a27813920bda7cdec3bc77f4", "patch": "@@ -88,6 +88,7 @@ Software Foundation, 59 Temple Place - Suite 330, Boston, MA\n #include \"tree-scalar-evolution.h\"\n #include \"cfgloop.h\"\n #include \"params.h\"\n+#include \"langhooks.h\"\n \n /* The infinite cost.  */\n #define INFTY 10000000\n@@ -1980,23 +1981,28 @@ add_candidate (struct ivopts_data *data,\n     add_candidate_1 (data, base, step, important, IP_END, use, NULL_TREE);\n }\n \n+/* Add a standard \"0 + 1 * iteration\" iv candidate for a\n+   type with SIZE bits.  */\n+\n+static void\n+add_standard_iv_candidates_for_size (struct ivopts_data *data,\n+\t\t\t\t     unsigned int size)\n+{\n+  tree type = lang_hooks.types.type_for_size (size, true);\n+  add_candidate (data, build_int_cst (type, 0), build_int_cst (type, 1),\n+\t\t true, NULL);\n+}\n+\n /* Adds standard iv candidates.  */\n \n static void\n add_standard_iv_candidates (struct ivopts_data *data)\n {\n-  /* Add 0 + 1 * iteration candidate.  */\n-  add_candidate (data,\n-\t\t build_int_cst (unsigned_intSI_type_node, 0),\n-      \t\t build_int_cst (unsigned_intSI_type_node, 1),\n-\t\t true, NULL);\n+  add_standard_iv_candidates_for_size (data, INT_TYPE_SIZE);\n \n-  /* The same for a long type if it is still fast enough.  */\n-  if (BITS_PER_WORD > 32)\n-    add_candidate (data,\n-\t\t   build_int_cst (unsigned_intDI_type_node, 0),\n-\t\t   build_int_cst (unsigned_intDI_type_node, 1),\n-\t\t   true, NULL);\n+  /* The same for a double-integer type if it is still fast enough.  */\n+  if (BITS_PER_WORD >= INT_TYPE_SIZE * 2)\n+    add_standard_iv_candidates_for_size (data, INT_TYPE_SIZE * 2);\n }\n \n "}]}