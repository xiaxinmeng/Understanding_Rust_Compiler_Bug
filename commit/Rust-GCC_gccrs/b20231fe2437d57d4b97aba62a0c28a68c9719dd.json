{"sha": "b20231fe2437d57d4b97aba62a0c28a68c9719dd", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjIwMjMxZmUyNDM3ZDU3ZDRiOTdhYmE2MmEwYzI4YTY4Yzk3MTlkZA==", "commit": {"author": {"name": "Danny Smith", "email": "dansmister@gmail.com", "date": "2009-07-12T06:09:39Z"}, "committer": {"name": "Danny Smith", "email": "dannysmith@gcc.gnu.org", "date": "2009-07-12T06:09:39Z"}, "message": "winnt.c (i386_pe_determine_dllexport_p): Don't dllexport if !TREE_PUBLIC.\n\n\t* config/i386/winnt.c (i386_pe_determine_dllexport_p): Don't\n\tdllexport if !TREE_PUBLIC.\n\t(i386_pe_maybe_record_exported_symbol): Assert TREE_PUBLIC.\n\nFrom-SVN: r149525", "tree": {"sha": "67739660575e53277c7a81761c5f9254f4504802", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/67739660575e53277c7a81761c5f9254f4504802"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b20231fe2437d57d4b97aba62a0c28a68c9719dd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b20231fe2437d57d4b97aba62a0c28a68c9719dd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b20231fe2437d57d4b97aba62a0c28a68c9719dd", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b20231fe2437d57d4b97aba62a0c28a68c9719dd/comments", "author": null, "committer": null, "parents": [{"sha": "b96a645580b7d659e5723859802bcc44b25fc505", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b96a645580b7d659e5723859802bcc44b25fc505", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b96a645580b7d659e5723859802bcc44b25fc505"}], "stats": {"total": 12, "additions": 12, "deletions": 0}, "files": [{"sha": "c8a39500b80073aa24f8364d0c70106dfc253c07", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b20231fe2437d57d4b97aba62a0c28a68c9719dd/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b20231fe2437d57d4b97aba62a0c28a68c9719dd/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=b20231fe2437d57d4b97aba62a0c28a68c9719dd", "patch": "@@ -1,3 +1,9 @@\n+2009-07-12  Danny Smith  <dansmister@gmail.com>\n+\n+\t* config/i386/winnt.c (i386_pe_determine_dllexport_p): Don't\n+\tdllexport if !TREE_PUBLIC.\n+\t(i386_pe_maybe_record_exported_symbol): Assert TREE_PUBLIC.\n+\n 2009-07-11  Anatoly Sokolov  <aesok@post.ru>\n \n \t* config/avr/avr.h (TARGET_CPU_CPP_BUILTINS): Redefine."}, {"sha": "7069c40846fedf46f5104460b58be64958f23bf4", "filename": "gcc/config/i386/winnt.c", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b20231fe2437d57d4b97aba62a0c28a68c9719dd/gcc%2Fconfig%2Fi386%2Fwinnt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b20231fe2437d57d4b97aba62a0c28a68c9719dd/gcc%2Fconfig%2Fi386%2Fwinnt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fwinnt.c?ref=b20231fe2437d57d4b97aba62a0c28a68c9719dd", "patch": "@@ -107,6 +107,10 @@ i386_pe_determine_dllexport_p (tree decl)\n   if (TREE_CODE (decl) != VAR_DECL && TREE_CODE (decl) != FUNCTION_DECL)\n     return false;\n \n+  /* Don't export local clones of dllexports.  */\n+  if (!TREE_PUBLIC (decl))\n+    return false;\n+\n   if (lookup_attribute (\"dllexport\", DECL_ATTRIBUTES (decl)))\n     return true;\n \n@@ -601,6 +605,8 @@ i386_pe_maybe_record_exported_symbol (tree decl, const char *name, int is_data)\n   if (!SYMBOL_REF_DLLEXPORT_P (symbol))\n     return;\n \n+  gcc_assert (TREE_PUBLIC (decl));\n+\n   p = (struct export_list *) ggc_alloc (sizeof *p);\n   p->next = export_head;\n   p->name = name;"}]}