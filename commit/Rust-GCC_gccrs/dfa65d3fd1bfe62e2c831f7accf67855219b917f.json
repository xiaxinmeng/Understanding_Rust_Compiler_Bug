{"sha": "dfa65d3fd1bfe62e2c831f7accf67855219b917f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZGZhNjVkM2ZkMWJmZTYyZTJjODMxZjdhY2NmNjc4NTUyMTliOTE3Zg==", "commit": {"author": {"name": "Nathan Sidwell", "email": "nathan@acm.org", "date": "2017-11-02T18:26:29Z"}, "committer": {"name": "Nathan Sidwell", "email": "nathan@gcc.gnu.org", "date": "2017-11-02T18:26:29Z"}, "message": "[PR c++/82710] false positive paren warning\n\nhttps://gcc.gnu.org/ml/gcc-patches/2017-11/msg00119.html\n\tPR c++/82710\n\t* decl.c (grokdeclarator): Don't warn when parens protect a return\n\ttype from a qualified name.\n\n\tPR c++/82710\n\t* g++.dg/warn/pr82710.C: New.\n\nFrom-SVN: r254349", "tree": {"sha": "bd548651e16769c30fa4864f708eda2a2847a8fd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/bd548651e16769c30fa4864f708eda2a2847a8fd"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/dfa65d3fd1bfe62e2c831f7accf67855219b917f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dfa65d3fd1bfe62e2c831f7accf67855219b917f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dfa65d3fd1bfe62e2c831f7accf67855219b917f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dfa65d3fd1bfe62e2c831f7accf67855219b917f/comments", "author": {"login": "urnathan", "id": 13103001, "node_id": "MDQ6VXNlcjEzMTAzMDAx", "avatar_url": "https://avatars.githubusercontent.com/u/13103001?v=4", "gravatar_id": "", "url": "https://api.github.com/users/urnathan", "html_url": "https://github.com/urnathan", "followers_url": "https://api.github.com/users/urnathan/followers", "following_url": "https://api.github.com/users/urnathan/following{/other_user}", "gists_url": "https://api.github.com/users/urnathan/gists{/gist_id}", "starred_url": "https://api.github.com/users/urnathan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/urnathan/subscriptions", "organizations_url": "https://api.github.com/users/urnathan/orgs", "repos_url": "https://api.github.com/users/urnathan/repos", "events_url": "https://api.github.com/users/urnathan/events{/privacy}", "received_events_url": "https://api.github.com/users/urnathan/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "e10dbae3dad0ac5269685620caa6f2698b00d669", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e10dbae3dad0ac5269685620caa6f2698b00d669", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e10dbae3dad0ac5269685620caa6f2698b00d669"}], "stats": {"total": 54, "additions": 51, "deletions": 3}, "files": [{"sha": "7a7a58941e67b8fd59b8d6cae32315f5f62da0ab", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dfa65d3fd1bfe62e2c831f7accf67855219b917f/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dfa65d3fd1bfe62e2c831f7accf67855219b917f/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=dfa65d3fd1bfe62e2c831f7accf67855219b917f", "patch": "@@ -1,3 +1,9 @@\n+2017-11-02  Nathan Sidwell  <nathan@acm.org>\n+\n+\tPR c++/82710\n+\t* decl.c (grokdeclarator): Don't warn when parens protect a return\n+\ttype from a qualified name.\n+\n 2017-11-01  Nathan Sidwell  <nathan@acm.org>\n \n \t* cp-tree.h (enum cp_identifier_kind): Delete cik_newdel_op."}, {"sha": "62bd3daef74148cd21f5141250e57ef1f3e09d62", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 10, "deletions": 3, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dfa65d3fd1bfe62e2c831f7accf67855219b917f/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dfa65d3fd1bfe62e2c831f7accf67855219b917f/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=dfa65d3fd1bfe62e2c831f7accf67855219b917f", "patch": "@@ -10788,18 +10788,25 @@ grokdeclarator (const cp_declarator *declarator,\n \t\t\t\t\t    attr_flags);\n \t}\n \n+      inner_declarator = declarator->declarator;\n+\n       /* We don't want to warn in parmeter context because we don't\n \t yet know if the parse will succeed, and this might turn out\n \t to be a constructor call.  */\n       if (decl_context != PARM\n-\t  && declarator->parenthesized != UNKNOWN_LOCATION)\n+\t  && declarator->parenthesized != UNKNOWN_LOCATION\n+\t  /* If the type is a class and the inner name used a global\n+\t     namespace qualifier, we need the parens.  Unfortunately\n+\t     all we can tell is that a qualified name was used.  */\n+\t  && !(CLASS_TYPE_P (type)\n+\t       && inner_declarator\n+\t       && inner_declarator->kind == cdk_id\n+\t       && inner_declarator->u.id.qualifying_scope))\n \twarning_at (declarator->parenthesized, OPT_Wparentheses,\n \t\t    \"unnecessary parentheses in declaration of %qs\", name);\n       if (declarator->kind == cdk_id || declarator->kind == cdk_decomp)\n \tbreak;\n \n-      inner_declarator = declarator->declarator;\n-\n       switch (declarator->kind)\n \t{\n \tcase cdk_array:"}, {"sha": "bc4a20752c2cffa7f207b849e9e723ed95f906d4", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dfa65d3fd1bfe62e2c831f7accf67855219b917f/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dfa65d3fd1bfe62e2c831f7accf67855219b917f/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=dfa65d3fd1bfe62e2c831f7accf67855219b917f", "patch": "@@ -1,5 +1,8 @@\n 2017-11-02  Nathan Sidwell  <nathan@acm.org>\n \n+\tPR c++/82710\n+\t* g++.dg/warn/pr82710.C: New.\n+\n \t* g++.dg/lang-dump.C: New.\n \n 2017-11-02  Richard Biener  <rguenther@suse.de>"}, {"sha": "a1f9247129ea8bcee0348e41a6a8ee8a31f33a13", "filename": "gcc/testsuite/g++.dg/warn/pr82710.C", "status": "added", "additions": 32, "deletions": 0, "changes": 32, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dfa65d3fd1bfe62e2c831f7accf67855219b917f/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2Fpr82710.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dfa65d3fd1bfe62e2c831f7accf67855219b917f/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2Fpr82710.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2Fpr82710.C?ref=dfa65d3fd1bfe62e2c831f7accf67855219b917f", "patch": "@@ -0,0 +1,32 @@\n+// { dg-additional-options -Wparentheses }\n+\n+// the MVP warning triggered on a friend decl.  */\n+class X;\n+\n+namespace here \n+{\n+  // these friends\n+  X friendFunc1();\n+  X *friendFunc2 ();\n+  int friendFunc3 ();\n+}\n+\n+namespace nm\n+{\n+  namespace here \n+  {\n+    // Not these friends\n+    void friendFunc1 ();\n+    void friendFunc2 ();\n+    void friendFunc3 ();\n+  }\n+\n+  class TestClass\n+  {\n+    friend X (::here::friendFunc1 ()); // parens are needed\n+    friend X *(::here::friendFunc2 ()); // { dg-warning \"\" }\n+    friend X *::here::friendFunc2 ();\n+    friend int (::here::friendFunc3 ()); // { dg-warning \"\" }\n+  };\n+}\n+"}]}