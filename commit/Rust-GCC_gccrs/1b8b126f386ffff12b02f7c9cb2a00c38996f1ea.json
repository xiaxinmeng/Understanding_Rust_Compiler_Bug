{"sha": "1b8b126f386ffff12b02f7c9cb2a00c38996f1ea", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWI4YjEyNmYzODZmZmZmMTJiMDJmN2M5Y2IyYTAwYzM4OTk2ZjFlYQ==", "commit": {"author": {"name": "Manuel L\u00f3pez-Ib\u00e1\u00f1ez", "email": "manu@gcc.gnu.org", "date": "2012-05-09T21:14:15Z"}, "committer": {"name": "Manuel L\u00f3pez-Ib\u00e1\u00f1ez", "email": "manu@gcc.gnu.org", "date": "2012-05-09T21:14:15Z"}, "message": "re PR c++/53289 (unnecessary repetition of caret diagnostics)\n\n2012-05-09  Manuel L\u00f3pez-Ib\u00e1\u00f1ez  <manu@gcc.gnu.org>\n\n\tPR c++/53289\ngcc/\n\t* diagnostic.h (diagnostic_context): Add last_location.\n\t* diagnostic.c (diagnostic_initialize): Initialize it.\n\t(diagnostic_show_locus): Use it.\n\nFrom-SVN: r187355", "tree": {"sha": "4b18ba8c78c4acdb7b3108123cdc3146cde30ec1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4b18ba8c78c4acdb7b3108123cdc3146cde30ec1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1b8b126f386ffff12b02f7c9cb2a00c38996f1ea", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1b8b126f386ffff12b02f7c9cb2a00c38996f1ea", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1b8b126f386ffff12b02f7c9cb2a00c38996f1ea", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1b8b126f386ffff12b02f7c9cb2a00c38996f1ea/comments", "author": null, "committer": null, "parents": [{"sha": "d21a7b447a2bdf5fe11f70827327c46472ee081a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d21a7b447a2bdf5fe11f70827327c46472ee081a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d21a7b447a2bdf5fe11f70827327c46472ee081a"}], "stats": {"total": 15, "additions": 14, "deletions": 1}, "files": [{"sha": "40ff5a153c884c118262737d8d156bfe2e8745db", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1b8b126f386ffff12b02f7c9cb2a00c38996f1ea/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1b8b126f386ffff12b02f7c9cb2a00c38996f1ea/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=1b8b126f386ffff12b02f7c9cb2a00c38996f1ea", "patch": "@@ -10,6 +10,13 @@\n \t(xop_mulv2div2di3_low): Remove insn_and_split pattern.\n \t(xop_mulv2div2di3_high): Ditto.\n \n+2012-05-09  Manuel L\u00f3pez-Ib\u00e1\u00f1ez  <manu@gcc.gnu.org>\n+\n+\tPR c++/53289\n+\t* diagnostic.h (diagnostic_context): Add last_location.\n+\t* diagnostic.c (diagnostic_initialize): Initialize it.\n+\t(diagnostic_show_locus): Use it.\n+\n 2012-05-09  Manuel L\u00f3pez-Ib\u00e1\u00f1ez  <manu@gcc.gnu.org>\n \n        * doc/extend.texi (Function Attributes): Point xref to section"}, {"sha": "4913eed9c67318104881aa7835fe826b69752a05", "filename": "gcc/diagnostic.c", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1b8b126f386ffff12b02f7c9cb2a00c38996f1ea/gcc%2Fdiagnostic.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1b8b126f386ffff12b02f7c9cb2a00c38996f1ea/gcc%2Fdiagnostic.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdiagnostic.c?ref=1b8b126f386ffff12b02f7c9cb2a00c38996f1ea", "patch": "@@ -147,6 +147,7 @@ diagnostic_initialize (diagnostic_context *context, int n_opts)\n   context->option_enabled = NULL;\n   context->option_state = NULL;\n   context->option_name = NULL;\n+  context->last_location = UNKNOWN_LOCATION;\n   context->last_module = 0;\n   context->x_data = NULL;\n   context->lock = 0;\n@@ -263,9 +264,11 @@ diagnostic_show_locus (diagnostic_context * context,\n \n \n   if (!context->show_caret\n-      || diagnostic->location <= BUILTINS_LOCATION)\n+      || diagnostic->location <= BUILTINS_LOCATION\n+      || diagnostic->location == context->last_location)\n     return;\n \n+  context->last_location = diagnostic->location;\n   s = expand_location_to_spelling_point (diagnostic->location);\n   line = location_get_source_line (s);\n   if (line == NULL)"}, {"sha": "976754ef3f27853c2f551e243994f6b635243bc6", "filename": "gcc/diagnostic.h", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1b8b126f386ffff12b02f7c9cb2a00c38996f1ea/gcc%2Fdiagnostic.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1b8b126f386ffff12b02f7c9cb2a00c38996f1ea/gcc%2Fdiagnostic.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdiagnostic.h?ref=1b8b126f386ffff12b02f7c9cb2a00c38996f1ea", "patch": "@@ -172,6 +172,9 @@ struct diagnostic_context\n   /* Auxiliary data for client.  */\n   void *x_data;\n \n+  /* Used to detect that the last caret was printed at the same location.  */\n+  location_t last_location;\n+\n   /* Used to detect when the input file stack has changed since last\n      described.  */\n   const struct line_map *last_module;"}]}