{"sha": "5619cc87d3d51997d943672bb159a6523355f60a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTYxOWNjODdkM2Q1MTk5N2Q5NDM2NzJiYjE1OWE2NTIzMzU1ZjYwYQ==", "commit": {"author": {"name": "Jim Wilson", "email": "wilson@gcc.gnu.org", "date": "1994-09-20T20:08:32Z"}, "committer": {"name": "Jim Wilson", "email": "wilson@gcc.gnu.org", "date": "1994-09-20T20:08:32Z"}, "message": "(mips_output_external): Use ASM_OUTPUT_UNDEF_FUNCTION.\n\n(mips_output_external_libcall): New function.\n(mips_asm_file_end): Handle ASM_OUTPUT_UNDEF_FUNCTION.\n\nFrom-SVN: r8101", "tree": {"sha": "c9b6428b59e55e20bc50ad3834d110ad2a32a608", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c9b6428b59e55e20bc50ad3834d110ad2a32a608"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5619cc87d3d51997d943672bb159a6523355f60a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5619cc87d3d51997d943672bb159a6523355f60a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5619cc87d3d51997d943672bb159a6523355f60a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5619cc87d3d51997d943672bb159a6523355f60a/comments", "author": null, "committer": null, "parents": [{"sha": "b696ee6b889c9c2c385cc759fe86019850f522ab", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b696ee6b889c9c2c385cc759fe86019850f522ab", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b696ee6b889c9c2c385cc759fe86019850f522ab"}], "stats": {"total": 53, "additions": 46, "deletions": 7}, "files": [{"sha": "cd5450b7ccba62ad7d65da14fd590a73b0b91b74", "filename": "gcc/config/mips/mips.c", "status": "modified", "additions": 46, "deletions": 7, "changes": 53, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5619cc87d3d51997d943672bb159a6523355f60a/gcc%2Fconfig%2Fmips%2Fmips.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5619cc87d3d51997d943672bb159a6523355f60a/gcc%2Fconfig%2Fmips%2Fmips.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.c?ref=5619cc87d3d51997d943672bb159a6523355f60a", "patch": "@@ -3778,8 +3778,38 @@ mips_output_external (file, decl, name)\n       p->size = len;\n       extern_head = p;\n     }\n+\n+#ifdef ASM_OUTPUT_UNDEF_FUNCTION\n+  if (TREE_CODE (decl) == FUNCTION_DECL)\n+    {\n+      p = (struct extern_list *)permalloc ((long) sizeof (struct extern_list));\n+      p->next = extern_head;\n+      p->name = name;\n+      p->size = -1;\n+      extern_head = p;\n+    }\n+#endif\n+\n+  return 0;\n+}\n+\n+#ifdef ASM_OUTPUT_UNDEF_FUNCTION\n+int\n+mips_output_external_libcall (file, name)\n+     FILE *file;\n+     char *name;\n+{\n+  register struct extern_list *p;\n+\n+  p = (struct extern_list *)permalloc ((long) sizeof (struct extern_list));\n+  p->next = extern_head;\n+  p->name = name;\n+  p->size = -1;\n+  extern_head = p;\n+\n   return 0;\n }\n+#endif\n \n \f\n /* Compute a string to use as a temporary file name.  */\n@@ -4049,10 +4079,9 @@ mips_asm_file_end (file)\n   if (HALF_PIC_P ())\n     HALF_PIC_FINISH (file);\n \n-  if (TARGET_GP_OPT)\n+  if (extern_head)\n     {\n-      if (extern_head)\n-\tfputs (\"\\n\", file);\n+      fputs (\"\\n\", file);\n \n       for (p = extern_head; p != 0; p = p->next)\n \t{\n@@ -4062,12 +4091,22 @@ mips_asm_file_end (file)\n \t  if (! TREE_ASM_WRITTEN (name_tree))\n \t    {\n \t      TREE_ASM_WRITTEN (name_tree) = 1;\n-\t      fputs (\"\\t.extern\\t\", file);\n-\t      assemble_name (file, p->name);\n-\t      fprintf (file, \", %d\\n\", p->size);\n+#ifdef ASM_OUTPUT_UNDEF_FUNCTION\n+\t      if (p->size == -1)\n+\t\tASM_OUTPUT_UNDEF_FUNCTION (file, p->name);\n+\t      else\n+#endif\n+\t\t{\n+\t\t  fputs (\"\\t.extern\\t\", file);\n+\t\t  assemble_name (file, p->name);\n+\t\t  fprintf (file, \", %d\\n\", p->size);\n+\t\t}\n \t    }\n \t}\n-\n+    }\n+      \n+  if (TARGET_GP_OPT)\n+    {\n       fprintf (file, \"\\n\\t.text\\n\");\n       rewind (asm_out_text_file);\n       if (ferror (asm_out_text_file))"}]}