{"sha": "48efbbe8a0b37d7da6a8bae0e28fccdeeaa82c63", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDhlZmJiZThhMGIzN2Q3ZGE2YThiYWUwZTI4ZmNjZGVlYWE4MmM2Mw==", "commit": {"author": {"name": "Mike Stump", "email": "mikestump@comcast.net", "date": "2015-08-17T09:39:58Z"}, "committer": {"name": "Kyrylo Tkachov", "email": "ktkachov@gcc.gnu.org", "date": "2015-08-17T09:39:58Z"}, "message": "[ARM] arm memcpy of aligned data\n\n2015-08-17  Mike Stump  <mikestump@comcast.net>\n\n\t* config/arm/arm.c (arm_block_move_unaligned_straight):\n\tEmit normal move instead of unaligned load when source or destination\n\tare appropriately aligned.\n\n2015-08-17 Mike Stump  <mikestump@comcast.net>\n           Kyrylo Tkachov  <kyrylo.tkachov@arm.com>\n\n\t* gcc.target/arm/memcpy-aligned-1.c: New test.\n\nCo-Authored-By: Kyrylo Tkachov <kyrylo.tkachov@arm.com>\n\nFrom-SVN: r226935", "tree": {"sha": "2c3d94c1683bb111be24a78337f55053f7536ed7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2c3d94c1683bb111be24a78337f55053f7536ed7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/48efbbe8a0b37d7da6a8bae0e28fccdeeaa82c63", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/48efbbe8a0b37d7da6a8bae0e28fccdeeaa82c63", "html_url": "https://github.com/Rust-GCC/gccrs/commit/48efbbe8a0b37d7da6a8bae0e28fccdeeaa82c63", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/48efbbe8a0b37d7da6a8bae0e28fccdeeaa82c63/comments", "author": null, "committer": null, "parents": [{"sha": "d202f9bdb49ef0b5d778a254796c64a710223515", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d202f9bdb49ef0b5d778a254796c64a710223515", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d202f9bdb49ef0b5d778a254796c64a710223515"}], "stats": {"total": 33, "additions": 31, "deletions": 2}, "files": [{"sha": "66bfd50a5468b62f709c216945000eeb07d0a9da", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/48efbbe8a0b37d7da6a8bae0e28fccdeeaa82c63/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/48efbbe8a0b37d7da6a8bae0e28fccdeeaa82c63/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=48efbbe8a0b37d7da6a8bae0e28fccdeeaa82c63", "patch": "@@ -1,3 +1,9 @@\n+2015-08-17  Mike Stump  <mikestump@comcast.net>\n+\n+\t* config/arm/arm.c (arm_block_move_unaligned_straight):\n+\tEmit normal move instead of unaligned load when source or destination\n+\tare appropriately aligned.\n+\n 2015-08-17  Richard Biener  <rguenther@suse.de>\n \t    Naveen H.S  <Naveen.Hurugalawadi@caviumnetworks.com>\n "}, {"sha": "8ded4946a6a3117e467f55d0f8b933d1b41e6d3e", "filename": "gcc/config/arm/arm.c", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/48efbbe8a0b37d7da6a8bae0e28fccdeeaa82c63/gcc%2Fconfig%2Farm%2Farm.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/48efbbe8a0b37d7da6a8bae0e28fccdeeaa82c63/gcc%2Fconfig%2Farm%2Farm.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Farm.c?ref=48efbbe8a0b37d7da6a8bae0e28fccdeeaa82c63", "patch": "@@ -14412,7 +14412,10 @@ arm_block_move_unaligned_straight (rtx dstbase, rtx srcbase,\n \t\t\t\tsrcoffset + j * UNITS_PER_WORD - src_autoinc);\n \t  mem = adjust_automodify_address (srcbase, SImode, addr,\n \t\t\t\t\t   srcoffset + j * UNITS_PER_WORD);\n-\t  emit_insn (gen_unaligned_loadsi (regs[j], mem));\n+\t  if (src_aligned)\n+\t    emit_move_insn (regs[j], mem);\n+\t  else\n+\t    emit_insn (gen_unaligned_loadsi (regs[j], mem));\n \t}\n       srcoffset += words * UNITS_PER_WORD;\n     }\n@@ -14431,7 +14434,10 @@ arm_block_move_unaligned_straight (rtx dstbase, rtx srcbase,\n \t\t\t\tdstoffset + j * UNITS_PER_WORD - dst_autoinc);\n \t  mem = adjust_automodify_address (dstbase, SImode, addr,\n \t\t\t\t\t   dstoffset + j * UNITS_PER_WORD);\n-\t  emit_insn (gen_unaligned_storesi (mem, regs[j]));\n+\t  if (dst_aligned)\n+\t    emit_move_insn (mem, regs[j]);\n+\t  else\n+\t    emit_insn (gen_unaligned_storesi (mem, regs[j]));\n \t}\n       dstoffset += words * UNITS_PER_WORD;\n     }"}, {"sha": "394a42fafdd6c74337d28ba07003ee6e03b264f2", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/48efbbe8a0b37d7da6a8bae0e28fccdeeaa82c63/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/48efbbe8a0b37d7da6a8bae0e28fccdeeaa82c63/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=48efbbe8a0b37d7da6a8bae0e28fccdeeaa82c63", "patch": "@@ -1,3 +1,8 @@\n+2015-08-17 Mike Stump  <mikestump@comcast.net>\n+           Kyrylo Tkachov  <kyrylo.tkachov@arm.com>\n+\n+\t* gcc.target/arm/memcpy-aligned-1.c: New test.\n+\n 2015-08-16  Francois-Xavier Coudert  <fxcoudert@gcc.gnu.org>\n \n \tPR fortran/54656"}, {"sha": "852b391388bdaec9e5fcc2f03cf8fd9fa469281a", "filename": "gcc/testsuite/gcc.target/arm/memcpy-aligned-1.c", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/48efbbe8a0b37d7da6a8bae0e28fccdeeaa82c63/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fmemcpy-aligned-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/48efbbe8a0b37d7da6a8bae0e28fccdeeaa82c63/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fmemcpy-aligned-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fmemcpy-aligned-1.c?ref=48efbbe8a0b37d7da6a8bae0e28fccdeeaa82c63", "patch": "@@ -0,0 +1,12 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -save-temps\" } */\n+\n+void *memcpy (void *dest, const void *src, unsigned int n);\n+\n+void foo (char *dst, int i)\n+{\n+  memcpy (dst, &i, sizeof (i));\n+}\n+\n+/* { dg-final { scan-assembler-times \"str\\t\" 1 } } */\n+/* { dg-final { scan-assembler-not \"ldr\\t\" } } */"}]}