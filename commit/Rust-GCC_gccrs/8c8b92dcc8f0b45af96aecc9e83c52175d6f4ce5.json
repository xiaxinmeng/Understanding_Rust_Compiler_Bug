{"sha": "8c8b92dcc8f0b45af96aecc9e83c52175d6f4ce5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OGM4YjkyZGNjOGYwYjQ1YWY5NmFlY2M5ZTgzYzUyMTc1ZDZmNGNlNQ==", "commit": {"author": {"name": "Bob Duff", "email": "duff@adacore.com", "date": "2020-07-02T22:16:57Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "derodat@adacore.com", "date": "2020-10-19T09:53:36Z"}, "message": "[Ada] Ada2020: matching parentheses and brackets\n\ngcc/ada/\n\n\t* par-ch4.adb (P_Aggregate_Or_Paren_Expr): Require matching\n\tparens or brackets.\n\t* par.adb, par-tchk.adb (T_Right_Bracket): New procedure to give\n\tan error on missing ].", "tree": {"sha": "bfc76d6835d590f5de2dafa5009ec34f1a0e4421", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/bfc76d6835d590f5de2dafa5009ec34f1a0e4421"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8c8b92dcc8f0b45af96aecc9e83c52175d6f4ce5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8c8b92dcc8f0b45af96aecc9e83c52175d6f4ce5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8c8b92dcc8f0b45af96aecc9e83c52175d6f4ce5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8c8b92dcc8f0b45af96aecc9e83c52175d6f4ce5/comments", "author": {"login": "bobduff", "id": 29099567, "node_id": "MDQ6VXNlcjI5MDk5NTY3", "avatar_url": "https://avatars.githubusercontent.com/u/29099567?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bobduff", "html_url": "https://github.com/bobduff", "followers_url": "https://api.github.com/users/bobduff/followers", "following_url": "https://api.github.com/users/bobduff/following{/other_user}", "gists_url": "https://api.github.com/users/bobduff/gists{/gist_id}", "starred_url": "https://api.github.com/users/bobduff/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bobduff/subscriptions", "organizations_url": "https://api.github.com/users/bobduff/orgs", "repos_url": "https://api.github.com/users/bobduff/repos", "events_url": "https://api.github.com/users/bobduff/events{/privacy}", "received_events_url": "https://api.github.com/users/bobduff/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pmderodat", "id": 758452, "node_id": "MDQ6VXNlcjc1ODQ1Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/758452?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pmderodat", "html_url": "https://github.com/pmderodat", "followers_url": "https://api.github.com/users/pmderodat/followers", "following_url": "https://api.github.com/users/pmderodat/following{/other_user}", "gists_url": "https://api.github.com/users/pmderodat/gists{/gist_id}", "starred_url": "https://api.github.com/users/pmderodat/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pmderodat/subscriptions", "organizations_url": "https://api.github.com/users/pmderodat/orgs", "repos_url": "https://api.github.com/users/pmderodat/repos", "events_url": "https://api.github.com/users/pmderodat/events{/privacy}", "received_events_url": "https://api.github.com/users/pmderodat/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b9d685922c7d960ab5b0beae348cfb37df08d115", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b9d685922c7d960ab5b0beae348cfb37df08d115", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b9d685922c7d960ab5b0beae348cfb37df08d115"}], "stats": {"total": 47, "additions": 34, "deletions": 13}, "files": [{"sha": "649c88ec2830f124a1067bb4719a2c13f44e993e", "filename": "gcc/ada/par-ch4.adb", "status": "modified", "additions": 19, "deletions": 13, "changes": 32, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8c8b92dcc8f0b45af96aecc9e83c52175d6f4ce5/gcc%2Fada%2Fpar-ch4.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8c8b92dcc8f0b45af96aecc9e83c52175d6f4ce5/gcc%2Fada%2Fpar-ch4.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fpar-ch4.adb?ref=8c8b92dcc8f0b45af96aecc9e83c52175d6f4ce5", "patch": "@@ -1391,6 +1391,9 @@ package body Ch4 is\n          return Maybe;\n       end Is_Quantified_Expression;\n \n+      Start_Token : constant Token_Type := Token;\n+      --  Used to prevent mismatches (...] and [...)\n+\n    --  Start of processing for P_Aggregate_Or_Paren_Expr\n \n    begin\n@@ -1697,23 +1700,26 @@ package body Ch4 is\n          end if;\n       end loop;\n \n-      --  All component associations (positional and named) have been scanned\n+      --  All component associations (positional and named) have been scanned.\n+      --  Scan ] or ) based on Start_Token.\n \n-      if Token = Tok_Right_Bracket and then Ada_Version >= Ada_2020 then\n-         Set_Component_Associations (Aggregate_Node, Assoc_List);\n-         Set_Is_Homogeneous_Aggregate (Aggregate_Node);\n-         Scan;  --  past right bracket\n+      case Start_Token is\n+         when Tok_Left_Bracket =>\n+            Set_Component_Associations (Aggregate_Node, Assoc_List);\n+            Set_Is_Homogeneous_Aggregate (Aggregate_Node);\n+            T_Right_Bracket;\n \n-         if Token = Tok_Apostrophe then\n-            Scan;\n+            if Token = Tok_Apostrophe then\n+               Scan;\n \n-            if Token = Tok_Identifier then\n-               return P_Reduction_Attribute_Reference (Aggregate_Node);\n+               if Token = Tok_Identifier then\n+                  return P_Reduction_Attribute_Reference (Aggregate_Node);\n+               end if;\n             end if;\n-         end if;\n-      else\n-         T_Right_Paren;\n-      end if;\n+         when Tok_Left_Paren =>\n+            T_Right_Paren;\n+         when others => raise Program_Error;\n+      end case;\n \n       if Nkind (Aggregate_Node) /= N_Delta_Aggregate then\n          Set_Expressions (Aggregate_Node, Expr_List);"}, {"sha": "65ff45aa0e6fcf6262ca90ba46bd59ade45db8f4", "filename": "gcc/ada/par-tchk.adb", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8c8b92dcc8f0b45af96aecc9e83c52175d6f4ce5/gcc%2Fada%2Fpar-tchk.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8c8b92dcc8f0b45af96aecc9e83c52175d6f4ce5/gcc%2Fada%2Fpar-tchk.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fpar-tchk.adb?ref=8c8b92dcc8f0b45af96aecc9e83c52175d6f4ce5", "patch": "@@ -402,6 +402,20 @@ package body Tchk is\n       Check_Token (Tok_Record, AP);\n    end T_Record;\n \n+   ---------------------\n+   -- T_Right_Bracket --\n+   ---------------------\n+\n+   procedure T_Right_Bracket is\n+   begin\n+      if Token = Tok_Right_Bracket then\n+         Scan;\n+      else\n+         Error_Msg_AP -- CODEFIX\n+           (\"|missing \"\"']'\"\"\");\n+      end if;\n+   end T_Right_Bracket;\n+\n    -------------------\n    -- T_Right_Paren --\n    -------------------"}, {"sha": "69da69d07be2803c25402cfcc957c64d57ba06a1", "filename": "gcc/ada/par.adb", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8c8b92dcc8f0b45af96aecc9e83c52175d6f4ce5/gcc%2Fada%2Fpar.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8c8b92dcc8f0b45af96aecc9e83c52175d6f4ce5/gcc%2Fada%2Fpar.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fpar.adb?ref=8c8b92dcc8f0b45af96aecc9e83c52175d6f4ce5", "patch": "@@ -1212,6 +1212,7 @@ function Par (Configuration_Pragmas : Boolean) return List_Id is\n       procedure T_Private;\n       procedure T_Range;\n       procedure T_Record;\n+      procedure T_Right_Bracket;\n       procedure T_Right_Paren;\n       procedure T_Semicolon;\n       procedure T_Then;"}]}