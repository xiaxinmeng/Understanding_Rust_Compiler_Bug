{"sha": "6f81b1ade69b0a968ba6fe5ea1e633cb75a11db4", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NmY4MWIxYWRlNjliMGE5NjhiYTZmZTVlYTFlNjMzY2I3NWExMWRiNA==", "commit": {"author": {"name": "Richard Henderson", "email": "rth@cygnus.com", "date": "2000-04-22T18:41:05Z"}, "committer": {"name": "Richard Henderson", "email": "rth@gcc.gnu.org", "date": "2000-04-22T18:41:05Z"}, "message": "diagnostic.c (init_output_buffer): Don't initialize format_args.\n\n        * diagnostic.c (init_output_buffer): Don't initialize format_args.\n        (output_clear): Likewise.\n        (output_printf): Use va_copy.\n        (vline_wrapper_message_with_location): Likewise.\n        (v_message_with_decl): Likewise.\n        (line_wrapper_printf): VA_START infor buffer.format_args directly.\n        * system.h (va_copy): Provide default implementation.\n\nFrom-SVN: r33341", "tree": {"sha": "1cdfebb14f928bf66cf2dcec028f0342806d1b1e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1cdfebb14f928bf66cf2dcec028f0342806d1b1e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6f81b1ade69b0a968ba6fe5ea1e633cb75a11db4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6f81b1ade69b0a968ba6fe5ea1e633cb75a11db4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6f81b1ade69b0a968ba6fe5ea1e633cb75a11db4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6f81b1ade69b0a968ba6fe5ea1e633cb75a11db4/comments", "author": null, "committer": null, "parents": [{"sha": "d9490f2f4ebedc6c568b963b230f20b298a22159", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d9490f2f4ebedc6c568b963b230f20b298a22159", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d9490f2f4ebedc6c568b963b230f20b298a22159"}], "stats": {"total": 42, "additions": 28, "deletions": 14}, "files": [{"sha": "2fcc64a8aad3e80d22b958d85722e40339d25bf2", "filename": "gcc/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6f81b1ade69b0a968ba6fe5ea1e633cb75a11db4/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6f81b1ade69b0a968ba6fe5ea1e633cb75a11db4/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=6f81b1ade69b0a968ba6fe5ea1e633cb75a11db4", "patch": "@@ -1,3 +1,13 @@\n+2000-04-22  Richard Henderson  <rth@cygnus.com>\n+\n+\t* diagnostic.c (init_output_buffer): Don't initialize format_args.\n+\t(output_clear): Likewise.\n+\t(output_printf): Use va_copy.\n+\t(vline_wrapper_message_with_location): Likewise.\n+\t(v_message_with_decl): Likewise.\n+\t(line_wrapper_printf): VA_START infor buffer.format_args directly.\n+\t* system.h (va_copy): Provide default implementation.\n+\n 2000-04-22  Richard Henderson  <rth@cygnus.com>\n \n \t* predict.c (expected_value_to_br_prob): Don't bomb if op1 of"}, {"sha": "93678ac5f2f78696330ea615ea268294cabeb446", "filename": "gcc/diagnostic.c", "status": "modified", "additions": 10, "deletions": 14, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6f81b1ade69b0a968ba6fe5ea1e633cb75a11db4/gcc%2Fdiagnostic.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6f81b1ade69b0a968ba6fe5ea1e633cb75a11db4/gcc%2Fdiagnostic.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdiagnostic.c?ref=6f81b1ade69b0a968ba6fe5ea1e633cb75a11db4", "patch": "@@ -198,7 +198,6 @@ init_output_buffer (buffer, prefix, maximum_length)\n   output_set_prefix (buffer, prefix);\n   \n   buffer->cursor = NULL;\n-  buffer->format_args = NULL;\n }\n \n /* Reinitialize BUFFER.  */\n@@ -209,7 +208,6 @@ output_clear (buffer)\n   obstack_free (&buffer->obstack, obstack_base (&buffer->obstack));\n   buffer->line_length = 0;\n   buffer->cursor = NULL;\n-  buffer->format_args = NULL;\n }\n \n /* Finishes to construct a NULL-terminated character string representing\n@@ -493,7 +491,7 @@ output_printf VPARAMS ((struct output_buffer *buffer, const char *msgid, ...))\n   msgid = va_arg (ap, const char *);\n #endif\n \n-  buffer->format_args = ap;\n+  va_copy (buffer->format_args, ap);\n   output_notice (buffer, msgid);\n   va_end (buffer->format_args);\n }\n@@ -510,17 +508,15 @@ line_wrapper_printf VPARAMS ((FILE *file, const char *msgid, ...))\n   const char *msgid;\n #endif\n   output_buffer buffer;\n-  va_list ap;\n   \n-  VA_START (ap, msgid);\n+  init_output_buffer (&buffer, NULL, output_maximum_width);\n+  VA_START (buffer.format_args, msgid);\n \n #ifndef ANSI_PROTOTYPES\n-  file = va_arg (ap, FILE *);\n-  msgid = va_arg (ap, const char *);\n+  file = va_arg (buffer.format_args, FILE *);\n+  msgid = va_arg (buffer.format_args, const char *);\n #endif  \n \n-  init_output_buffer (&buffer, NULL, output_maximum_width);\n-  buffer.format_args = ap;\n   output_notice (&buffer, msgid);\n   output_flush_on (&buffer, file);\n \n@@ -538,9 +534,9 @@ vline_wrapper_message_with_location (file, line, warn, msgid, ap)\n {\n   output_buffer buffer;\n   \n-  init_output_buffer\n-    (&buffer, build_location_prefix (file, line, warn), output_maximum_width);\n-  buffer.format_args = ap;\n+  init_output_buffer (&buffer, build_location_prefix (file, line, warn),\n+\t\t      output_maximum_width);\n+  va_copy (buffer.format_args, ap);\n   output_notice (&buffer, msgid);\n   output_flush_on (&buffer, stderr);\n \n@@ -681,9 +677,9 @@ v_message_with_decl (decl, warn, msgid, ap)\n     {\n       if (doing_line_wrapping ())\n         {\n-          buffer.format_args = ap;\n+\t  va_copy (buffer.format_args, ap);\n           output_notice (&buffer, p);\n-          ap = buffer.format_args;\n+          va_copy (ap, buffer.format_args);\n         }\n       else\n         vfprintf (stderr, p, ap);"}, {"sha": "407897759cfa009bf97b53a88b97ce796e613c49", "filename": "gcc/system.h", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6f81b1ade69b0a968ba6fe5ea1e633cb75a11db4/gcc%2Fsystem.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6f81b1ade69b0a968ba6fe5ea1e633cb75a11db4/gcc%2Fsystem.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fsystem.h?ref=6f81b1ade69b0a968ba6fe5ea1e633cb75a11db4", "patch": "@@ -35,6 +35,14 @@ Boston, MA 02111-1307, USA.  */\n #include <varargs.h>\n #endif\n \n+#ifndef va_copy\n+# ifdef __va_copy\n+#   define va_copy(d,s)  __va_copy((d),(s))\n+# else\n+#   define va_copy(d,s)  ((d) = (s))\n+# endif\n+#endif\n+\n #include <stdio.h>\n \n /* Define a generic NULL if one hasn't already been defined.  */"}]}