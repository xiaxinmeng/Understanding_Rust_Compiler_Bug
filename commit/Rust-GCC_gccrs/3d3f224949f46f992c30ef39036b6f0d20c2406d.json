{"sha": "3d3f224949f46f992c30ef39036b6f0d20c2406d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6M2QzZjIyNDk0OWY0NmY5OTJjMzBlZjM5MDM2YjZmMGQyMGMyNDA2ZA==", "commit": {"author": {"name": "Richard Guenther", "email": "rguenther@suse.de", "date": "2012-04-05T09:45:18Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2012-04-05T09:45:18Z"}, "message": "tree-nrv.c (tree_nrv): Release VDEFs.\n\n2012-04-05  Richard Guenther  <rguenther@suse.de>\n\n\t* tree-nrv.c (tree_nrv): Release VDEFs.\n\t* tree-sra.c (sra_modify_constructor_assign): Likewise.\n\t(sra_modify_assign): Likewise.\n\t* tree-vect-stmts.c (vect_remove_stores): Likewise.\n\t* tree-vect-loop.c (vect_transform_loop): Likewise.\n\t* tree-ssa-dom.c (optimize_stmt): Likewise.\n\t* tree-vect-slp.c (vect_schedule_slp): Likewise.\n\t* tree-ssa-math-opts.c (execute_cse_sincos): Likewise.\n\nFrom-SVN: r186160", "tree": {"sha": "82a4f09ff51f17c39f508dc9425bc833499b68fd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/82a4f09ff51f17c39f508dc9425bc833499b68fd"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3d3f224949f46f992c30ef39036b6f0d20c2406d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3d3f224949f46f992c30ef39036b6f0d20c2406d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3d3f224949f46f992c30ef39036b6f0d20c2406d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3d3f224949f46f992c30ef39036b6f0d20c2406d/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "b5b3ec3e6ebe5b7a07654d94f53f97b0a8cca050", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b5b3ec3e6ebe5b7a07654d94f53f97b0a8cca050", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b5b3ec3e6ebe5b7a07654d94f53f97b0a8cca050"}], "stats": {"total": 36, "additions": 33, "deletions": 3}, "files": [{"sha": "bd45eb7572935d358b8974ecc1adb6d97477a418", "filename": "gcc/ChangeLog", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3d3f224949f46f992c30ef39036b6f0d20c2406d/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3d3f224949f46f992c30ef39036b6f0d20c2406d/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=3d3f224949f46f992c30ef39036b6f0d20c2406d", "patch": "@@ -1,3 +1,14 @@\n+2012-04-05  Richard Guenther  <rguenther@suse.de>\n+\n+\t* tree-nrv.c (tree_nrv): Release VDEFs.\n+\t* tree-sra.c (sra_modify_constructor_assign): Likewise.\n+\t(sra_modify_assign): Likewise.\n+\t* tree-vect-stmts.c (vect_remove_stores): Likewise.\n+\t* tree-vect-loop.c (vect_transform_loop): Likewise.\n+\t* tree-ssa-dom.c (optimize_stmt): Likewise.\n+\t* tree-vect-slp.c (vect_schedule_slp): Likewise.\n+\t* tree-ssa-math-opts.c (execute_cse_sincos): Likewise.\n+\n 2012-04-05  Richard Guenther  <rguenther@suse.de>\n \n \t* gimple-iterator.c (gsi_remove): Return whether EH edges need to be"}, {"sha": "b78d9e9bd3aba4eb74fb6d31b9411a53914870c6", "filename": "gcc/tree-eh.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3d3f224949f46f992c30ef39036b6f0d20c2406d/gcc%2Ftree-eh.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3d3f224949f46f992c30ef39036b6f0d20c2406d/gcc%2Ftree-eh.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-eh.c?ref=3d3f224949f46f992c30ef39036b6f0d20c2406d", "patch": "@@ -3268,12 +3268,12 @@ sink_clobbers (basic_block bb)\n       vdef = gimple_vdef (stmt);\n       if (vdef && TREE_CODE (vdef) == SSA_NAME)\n \t{\n+\t  release_ssa_name (vdef);\n \t  vdef = SSA_NAME_VAR (vdef);\n \t  mark_sym_for_renaming (vdef);\n \t  gimple_set_vdef (stmt, vdef);\n \t  gimple_set_vuse (stmt, vdef);\n \t}\n-      release_defs (stmt);\n       gsi_insert_before (&dgsi, stmt, GSI_SAME_STMT);\n     }\n \n@@ -3955,7 +3955,7 @@ cleanup_empty_eh_move_lp (basic_block bb, edge e_out,\n \n   /* Delete the RESX that was matched within the empty handler block.  */\n   gsi = gsi_last_bb (bb);\n-  mark_virtual_ops_for_renaming (gsi_stmt (gsi));\n+  unlink_stmt_vdef (gsi_stmt (gsi));\n   gsi_remove (&gsi, true);\n \n   /* Clean up E_OUT for the fallthru.  */"}, {"sha": "9176e29c3ad23902e198e30a990e115ffddc866c", "filename": "gcc/tree-nrv.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3d3f224949f46f992c30ef39036b6f0d20c2406d/gcc%2Ftree-nrv.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3d3f224949f46f992c30ef39036b6f0d20c2406d/gcc%2Ftree-nrv.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-nrv.c?ref=3d3f224949f46f992c30ef39036b6f0d20c2406d", "patch": "@@ -244,6 +244,7 @@ tree_nrv (void)\n \t    {\n \t      unlink_stmt_vdef (stmt);\n \t      gsi_remove (&gsi, true);\n+\t      release_defs (stmt);\n \t    }\n \t  else\n \t    {"}, {"sha": "c5f105a2297e2bdfffb9f83366f89993bdb9ec5b", "filename": "gcc/tree-sra.c", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3d3f224949f46f992c30ef39036b6f0d20c2406d/gcc%2Ftree-sra.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3d3f224949f46f992c30ef39036b6f0d20c2406d/gcc%2Ftree-sra.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-sra.c?ref=3d3f224949f46f992c30ef39036b6f0d20c2406d", "patch": "@@ -2821,6 +2821,7 @@ sra_modify_constructor_assign (gimple *stmt, gimple_stmt_iterator *gsi)\n \t{\n \t  unlink_stmt_vdef (*stmt);\n \t  gsi_remove (gsi, true);\n+\t  release_defs (*stmt);\n \t  return SRA_AM_REMOVED;\n \t}\n       else\n@@ -2844,6 +2845,7 @@ sra_modify_constructor_assign (gimple *stmt, gimple_stmt_iterator *gsi)\n       init_subtree_with_zero (acc, gsi, false, loc);\n       unlink_stmt_vdef (*stmt);\n       gsi_remove (gsi, true);\n+      release_defs (*stmt);\n       return SRA_AM_REMOVED;\n     }\n   else\n@@ -3094,6 +3096,7 @@ sra_modify_assign (gimple *stmt, gimple_stmt_iterator *gsi)\n \t      gsi_next (gsi);\n \t      unlink_stmt_vdef (*stmt);\n \t      gsi_remove (&orig_gsi, true);\n+\t      release_defs (*stmt);\n \t      sra_stats.deleted++;\n \t      return SRA_AM_REMOVED;\n \t    }\n@@ -3114,6 +3117,7 @@ sra_modify_assign (gimple *stmt, gimple_stmt_iterator *gsi)\n \t      gcc_assert (*stmt == gsi_stmt (*gsi));\n \t      unlink_stmt_vdef (*stmt);\n \t      gsi_remove (gsi, true);\n+\t      release_defs (*stmt);\n \t      sra_stats.deleted++;\n \t      return SRA_AM_REMOVED;\n \t    }"}, {"sha": "d35297abbd72f3f485391d07a566bbf43a04b247", "filename": "gcc/tree-ssa-dom.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3d3f224949f46f992c30ef39036b6f0d20c2406d/gcc%2Ftree-ssa-dom.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3d3f224949f46f992c30ef39036b6f0d20c2406d/gcc%2Ftree-ssa-dom.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-dom.c?ref=3d3f224949f46f992c30ef39036b6f0d20c2406d", "patch": "@@ -2301,6 +2301,7 @@ optimize_stmt (basic_block bb, gimple_stmt_iterator si)\n \t\t  if (dump_file && (dump_flags & TDF_DETAILS))\n \t\t    fprintf (dump_file, \"  Flagged to clear EH edges.\\n\");\n \t\t}\n+\t      release_defs (stmt);\n \t      return;\n \t    }\n \t}"}, {"sha": "f54d08dffee05ed01d64e2145086d2a8c585a478", "filename": "gcc/tree-ssa-math-opts.c", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3d3f224949f46f992c30ef39036b6f0d20c2406d/gcc%2Ftree-ssa-math-opts.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3d3f224949f46f992c30ef39036b6f0d20c2406d/gcc%2Ftree-ssa-math-opts.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-math-opts.c?ref=3d3f224949f46f992c30ef39036b6f0d20c2406d", "patch": "@@ -1430,6 +1430,8 @@ execute_cse_sincos (void)\n \t\t      gimple_set_location (new_stmt, loc);\n \t\t      unlink_stmt_vdef (stmt);\n \t\t      gsi_replace (&gsi, new_stmt, true);\n+\t\t      if (gimple_vdef (stmt))\n+\t\t\trelease_ssa_name (gimple_vdef (stmt));\n \t\t    }\n \t\t  break;\n \n@@ -1450,6 +1452,8 @@ execute_cse_sincos (void)\n \t\t      gimple_set_location (new_stmt, loc);\n \t\t      unlink_stmt_vdef (stmt);\n \t\t      gsi_replace (&gsi, new_stmt, true);\n+\t\t      if (gimple_vdef (stmt))\n+\t\t\trelease_ssa_name (gimple_vdef (stmt));\n \t\t    }\n \t\t  break;\n \n@@ -1465,6 +1469,8 @@ execute_cse_sincos (void)\n \t\t      gimple_set_location (new_stmt, loc);\n \t\t      unlink_stmt_vdef (stmt);\n \t\t      gsi_replace (&gsi, new_stmt, true);\n+\t\t      if (gimple_vdef (stmt))\n+\t\t\trelease_ssa_name (gimple_vdef (stmt));\n \t\t    }\n \t\t  break;\n "}, {"sha": "3df0e4b61ba10969e67fc7670d31954c5286773a", "filename": "gcc/tree-vect-loop.c", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3d3f224949f46f992c30ef39036b6f0d20c2406d/gcc%2Ftree-vect-loop.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3d3f224949f46f992c30ef39036b6f0d20c2406d/gcc%2Ftree-vect-loop.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-vect-loop.c?ref=3d3f224949f46f992c30ef39036b6f0d20c2406d", "patch": "@@ -5476,8 +5476,11 @@ vect_transform_loop (loop_vec_info loop_vinfo)\n \t      else\n \t\t{\n \t\t  /* Free the attached stmt_vec_info and remove the stmt.  */\n-\t\t  free_stmt_vec_info (gsi_stmt (si));\n+\t\t  gimple store = gsi_stmt (si);\n+\t\t  free_stmt_vec_info (store);\n+\t\t  unlink_stmt_vdef (store);\n \t\t  gsi_remove (&si, true);\n+\t\t  release_defs (store);\n \t\t  continue;\n \t\t}\n \t    }"}, {"sha": "014fa988722b13d22e2dc3288b19f63f4cb3b7ee", "filename": "gcc/tree-vect-slp.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3d3f224949f46f992c30ef39036b6f0d20c2406d/gcc%2Ftree-vect-slp.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3d3f224949f46f992c30ef39036b6f0d20c2406d/gcc%2Ftree-vect-slp.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-vect-slp.c?ref=3d3f224949f46f992c30ef39036b6f0d20c2406d", "patch": "@@ -3043,7 +3043,9 @@ vect_schedule_slp (loop_vec_info loop_vinfo, bb_vec_info bb_vinfo)\n            store = STMT_VINFO_RELATED_STMT (vinfo_for_stmt (store));\n           /* Free the attached stmt_vec_info and remove the stmt.  */\n           gsi = gsi_for_stmt (store);\n+\t  unlink_stmt_vdef (store);\n           gsi_remove (&gsi, true);\n+\t  release_defs (store);\n           free_stmt_vec_info (store);\n         }\n     }"}, {"sha": "dabb63d7a92b34580186809c09ad3888946d58f3", "filename": "gcc/tree-vect-stmts.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3d3f224949f46f992c30ef39036b6f0d20c2406d/gcc%2Ftree-vect-stmts.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3d3f224949f46f992c30ef39036b6f0d20c2406d/gcc%2Ftree-vect-stmts.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-vect-stmts.c?ref=3d3f224949f46f992c30ef39036b6f0d20c2406d", "patch": "@@ -5653,7 +5653,9 @@ vect_remove_stores (gimple first_stmt)\n \tnext = STMT_VINFO_RELATED_STMT (stmt_info);\n       /* Free the attached stmt_vec_info and remove the stmt.  */\n       next_si = gsi_for_stmt (next);\n+      unlink_stmt_vdef (next);\n       gsi_remove (&next_si, true);\n+      release_defs (next);\n       free_stmt_vec_info (next);\n       next = tmp;\n     }"}]}