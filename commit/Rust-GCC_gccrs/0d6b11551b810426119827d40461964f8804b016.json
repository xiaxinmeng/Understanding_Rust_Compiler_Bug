{"sha": "0d6b11551b810426119827d40461964f8804b016", "node_id": "C_kwDOANBUbNoAKDBkNmIxMTU1MWI4MTA0MjYxMTk4MjdkNDA0NjE5NjRmODgwNGIwMTY", "commit": {"author": {"name": "Parthib", "email": "94271200+Parthib314@users.noreply.github.com", "date": "2023-01-31T13:15:01Z"}, "committer": {"name": "Parthib", "email": "parthibdutta02@gmail.com", "date": "2023-02-03T12:51:42Z"}, "message": "Moving Functions from rust-gcc-diagnostics to rust-diagnostics.cc\n\ngcc/rust/ChangeLog:\n\n\t* Make-lang.in: Modified\n\t* rust-diagnostics.cc (rust_be_get_quotechars): Added\n\t\t(rust_be_internal_error_at): Added\n\t\t(rust_be_error_at): Added\n\t\t(class rust_error_code_rule): Added\n\t\t(rust_be_warning_at): Added\n\t\t(rust_be_fatal_error): Added\n\t\t(rust_be_inform): Added\n\t\t(rust_be_debug_p): Added\n\n\t* rust-gcc-diagnostics.cc: Removed", "tree": {"sha": "46596873e1c1c7c6cab3a711f752eb86c492db68", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/46596873e1c1c7c6cab3a711f752eb86c492db68"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0d6b11551b810426119827d40461964f8804b016", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0d6b11551b810426119827d40461964f8804b016", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0d6b11551b810426119827d40461964f8804b016", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0d6b11551b810426119827d40461964f8804b016/comments", "author": {"login": "Parthib314", "id": 94271200, "node_id": "U_kgDOBZ524A", "avatar_url": "https://avatars.githubusercontent.com/u/94271200?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Parthib314", "html_url": "https://github.com/Parthib314", "followers_url": "https://api.github.com/users/Parthib314/followers", "following_url": "https://api.github.com/users/Parthib314/following{/other_user}", "gists_url": "https://api.github.com/users/Parthib314/gists{/gist_id}", "starred_url": "https://api.github.com/users/Parthib314/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Parthib314/subscriptions", "organizations_url": "https://api.github.com/users/Parthib314/orgs", "repos_url": "https://api.github.com/users/Parthib314/repos", "events_url": "https://api.github.com/users/Parthib314/events{/privacy}", "received_events_url": "https://api.github.com/users/Parthib314/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Parthib314", "id": 94271200, "node_id": "U_kgDOBZ524A", "avatar_url": "https://avatars.githubusercontent.com/u/94271200?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Parthib314", "html_url": "https://github.com/Parthib314", "followers_url": "https://api.github.com/users/Parthib314/followers", "following_url": "https://api.github.com/users/Parthib314/following{/other_user}", "gists_url": "https://api.github.com/users/Parthib314/gists{/gist_id}", "starred_url": "https://api.github.com/users/Parthib314/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Parthib314/subscriptions", "organizations_url": "https://api.github.com/users/Parthib314/orgs", "repos_url": "https://api.github.com/users/Parthib314/repos", "events_url": "https://api.github.com/users/Parthib314/events{/privacy}", "received_events_url": "https://api.github.com/users/Parthib314/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "21ec24265b2fb5ee76f806680d30ea90b4903ec8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/21ec24265b2fb5ee76f806680d30ea90b4903ec8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/21ec24265b2fb5ee76f806680d30ea90b4903ec8"}], "stats": {"total": 213, "additions": 95, "deletions": 118}, "files": [{"sha": "a005e05d55146db9931fb7434c1f1f5061b86912", "filename": "gcc/rust/Make-lang.in", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0d6b11551b810426119827d40461964f8804b016/gcc%2Frust%2FMake-lang.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0d6b11551b810426119827d40461964f8804b016/gcc%2Frust%2FMake-lang.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Frust%2FMake-lang.in?ref=0d6b11551b810426119827d40461964f8804b016", "patch": "@@ -66,7 +66,6 @@ GRS_OBJS = \\\n     rust/rust-lang.o \\\n     rust/rust-object-export.o \\\n     rust/rust-linemap.o \\\n-    rust/rust-gcc-diagnostics.o \\\n     rust/rust-diagnostics.o \\\n     rust/rust-gcc.o \\\n     rust/rust-token.o \\"}, {"sha": "894772dd5a510999f985da79a753c1ec41da20b6", "filename": "gcc/rust/rust-diagnostics.cc", "status": "modified", "additions": 95, "deletions": 0, "changes": 95, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0d6b11551b810426119827d40461964f8804b016/gcc%2Frust%2Frust-diagnostics.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0d6b11551b810426119827d40461964f8804b016/gcc%2Frust%2Frust-diagnostics.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Frust%2Frust-diagnostics.cc?ref=0d6b11551b810426119827d40461964f8804b016", "patch": "@@ -21,6 +21,9 @@\n #include \"rust-system.h\"\n #include \"rust-diagnostics.h\"\n \n+#include \"options.h\"\n+#include \"diagnostic-metadata.h\"\n+\n static std::string\n mformat_value ()\n {\n@@ -130,6 +133,13 @@ expand_message (const char *fmt, va_list ap)\n static const char *cached_open_quote = NULL;\n static const char *cached_close_quote = NULL;\n \n+void\n+rust_be_get_quotechars (const char **open_qu, const char **close_qu)\n+{\n+  *open_qu = open_quote;\n+  *close_qu = close_quote;\n+}\n+\n const char *\n rust_open_quote ()\n {\n@@ -146,6 +156,16 @@ rust_close_quote ()\n   return cached_close_quote;\n }\n \n+void\n+rust_be_internal_error_at (const Location location, const std::string &errmsg)\n+{\n+  std::string loc_str = Linemap::location_to_string (location);\n+  if (loc_str.empty ())\n+    internal_error (\"%s\", errmsg.c_str ());\n+  else\n+    internal_error (\"at %s, %s\", loc_str.c_str (), errmsg.c_str ());\n+}\n+\n void\n rust_internal_error_at (const Location location, const char *fmt, ...)\n {\n@@ -156,6 +176,13 @@ rust_internal_error_at (const Location location, const char *fmt, ...)\n   va_end (ap);\n }\n \n+void\n+rust_be_error_at (const Location location, const std::string &errmsg)\n+{\n+  location_t gcc_loc = location.gcc_location ();\n+  error_at (gcc_loc, \"%s\", errmsg.c_str ());\n+}\n+\n void\n rust_error_at (const Location location, const char *fmt, ...)\n {\n@@ -166,6 +193,38 @@ rust_error_at (const Location location, const char *fmt, ...)\n   va_end (ap);\n }\n \n+class rust_error_code_rule : public diagnostic_metadata::rule\n+{\n+public:\n+  rust_error_code_rule (const ErrorCode code) : m_code (code) {}\n+\n+  char *make_description () const final override\n+  {\n+    return xstrdup (m_code.m_str);\n+  }\n+\n+  char *make_url () const final override\n+  {\n+    return concat (\"https://doc.rust-lang.org/error-index.html#\", m_code.m_str,\n+\t\t   NULL);\n+  }\n+\n+private:\n+  const ErrorCode m_code;\n+};\n+\n+void\n+rust_be_error_at (const RichLocation &location, const ErrorCode code,\n+\t\t  const std::string &errmsg)\n+{\n+  /* TODO: 'error_at' would like a non-'const' 'rich_location *'.  */\n+  rich_location &gcc_loc = const_cast<rich_location &> (location.get ());\n+  diagnostic_metadata m;\n+  rust_error_code_rule rule (code);\n+  m.add_rule (rule);\n+  error_meta (&gcc_loc, m, \"%s\", errmsg.c_str ());\n+}\n+\n void\n rust_error_at (const RichLocation &location, const ErrorCode code,\n \t       const char *fmt, ...)\n@@ -177,6 +236,14 @@ rust_error_at (const RichLocation &location, const ErrorCode code,\n   va_end (ap);\n }\n \n+void\n+rust_be_warning_at (const Location location, int opt,\n+\t\t    const std::string &warningmsg)\n+{\n+  location_t gcc_loc = location.gcc_location ();\n+  warning_at (gcc_loc, opt, \"%s\", warningmsg.c_str ());\n+}\n+\n void\n rust_warning_at (const Location location, int opt, const char *fmt, ...)\n {\n@@ -187,6 +254,13 @@ rust_warning_at (const Location location, int opt, const char *fmt, ...)\n   va_end (ap);\n }\n \n+void\n+rust_be_fatal_error (const Location location, const std::string &fatalmsg)\n+{\n+  location_t gcc_loc = location.gcc_location ();\n+  fatal_error (gcc_loc, \"%s\", fatalmsg.c_str ());\n+}\n+\n void\n rust_fatal_error (const Location location, const char *fmt, ...)\n {\n@@ -197,6 +271,13 @@ rust_fatal_error (const Location location, const char *fmt, ...)\n   va_end (ap);\n }\n \n+void\n+rust_be_inform (const Location location, const std::string &infomsg)\n+{\n+  location_t gcc_loc = location.gcc_location ();\n+  inform (gcc_loc, \"%s\", infomsg.c_str ());\n+}\n+\n void\n rust_inform (const Location location, const char *fmt, ...)\n {\n@@ -208,6 +289,14 @@ rust_inform (const Location location, const char *fmt, ...)\n }\n \n // Rich Locations\n+void\n+rust_be_error_at (const RichLocation &location, const std::string &errmsg)\n+{\n+  /* TODO: 'error_at' would like a non-'const' 'rich_location *'.  */\n+  rich_location &gcc_loc = const_cast<rich_location &> (location.get ());\n+  error_at (&gcc_loc, \"%s\", errmsg.c_str ());\n+}\n+\n void\n rust_error_at (const RichLocation &location, const char *fmt, ...)\n {\n@@ -218,6 +307,12 @@ rust_error_at (const RichLocation &location, const char *fmt, ...)\n   va_end (ap);\n }\n \n+bool\n+rust_be_debug_p (void)\n+{\n+  return !!flag_rust_debug;\n+}\n+\n void\n rust_debug_loc (const Location location, const char *fmt, ...)\n {"}, {"sha": "98e2af7308d763ee844cdd264241fc7ca5327294", "filename": "gcc/rust/rust-gcc-diagnostics.cc", "status": "removed", "additions": 0, "deletions": 117, "changes": 117, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/21ec24265b2fb5ee76f806680d30ea90b4903ec8/gcc%2Frust%2Frust-gcc-diagnostics.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/21ec24265b2fb5ee76f806680d30ea90b4903ec8/gcc%2Frust%2Frust-gcc-diagnostics.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Frust%2Frust-gcc-diagnostics.cc?ref=21ec24265b2fb5ee76f806680d30ea90b4903ec8", "patch": "@@ -1,117 +0,0 @@\n-// Copyright (C) 2020-2022 Free Software Foundation, Inc.\n-\n-// This file is part of GCC.\n-\n-// GCC is free software; you can redistribute it and/or modify it under\n-// the terms of the GNU General Public License as published by the Free\n-// Software Foundation; either version 3, or (at your option) any later\n-// version.\n-\n-// GCC is distributed in the hope that it will be useful, but WITHOUT ANY\n-// WARRANTY; without even the implied warranty of MERCHANTABILITY or\n-// FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n-// for more details.\n-\n-// You should have received a copy of the GNU General Public License\n-// along with GCC; see the file COPYING3.  If not see\n-// <http://www.gnu.org/licenses/>.\n-\n-// rust-gcc-diagnostics.cc -- GCC implementation of rust diagnostics interface.\n-\n-#include \"rust-system.h\"\n-#include \"rust-diagnostics.h\"\n-\n-#include \"options.h\"\n-#include \"diagnostic-metadata.h\"\n-\n-void\n-rust_be_internal_error_at (const Location location, const std::string &errmsg)\n-{\n-  std::string loc_str = Linemap::location_to_string (location);\n-  if (loc_str.empty ())\n-    internal_error (\"%s\", errmsg.c_str ());\n-  else\n-    internal_error (\"at %s, %s\", loc_str.c_str (), errmsg.c_str ());\n-}\n-\n-void\n-rust_be_error_at (const Location location, const std::string &errmsg)\n-{\n-  location_t gcc_loc = location.gcc_location ();\n-  error_at (gcc_loc, \"%s\", errmsg.c_str ());\n-}\n-\n-void\n-rust_be_warning_at (const Location location, int opt,\n-\t\t    const std::string &warningmsg)\n-{\n-  location_t gcc_loc = location.gcc_location ();\n-  warning_at (gcc_loc, opt, \"%s\", warningmsg.c_str ());\n-}\n-\n-void\n-rust_be_fatal_error (const Location location, const std::string &fatalmsg)\n-{\n-  location_t gcc_loc = location.gcc_location ();\n-  fatal_error (gcc_loc, \"%s\", fatalmsg.c_str ());\n-}\n-\n-void\n-rust_be_inform (const Location location, const std::string &infomsg)\n-{\n-  location_t gcc_loc = location.gcc_location ();\n-  inform (gcc_loc, \"%s\", infomsg.c_str ());\n-}\n-\n-void\n-rust_be_error_at (const RichLocation &location, const std::string &errmsg)\n-{\n-  /* TODO: 'error_at' would like a non-'const' 'rich_location *'.  */\n-  rich_location &gcc_loc = const_cast<rich_location &> (location.get ());\n-  error_at (&gcc_loc, \"%s\", errmsg.c_str ());\n-}\n-\n-class rust_error_code_rule : public diagnostic_metadata::rule\n-{\n-public:\n-  rust_error_code_rule (const ErrorCode code) : m_code (code) {}\n-\n-  char *make_description () const final override\n-  {\n-    return xstrdup (m_code.m_str);\n-  }\n-\n-  char *make_url () const final override\n-  {\n-    return concat (\"https://doc.rust-lang.org/error-index.html#\", m_code.m_str,\n-\t\t   NULL);\n-  }\n-\n-private:\n-  const ErrorCode m_code;\n-};\n-\n-void\n-rust_be_error_at (const RichLocation &location, const ErrorCode code,\n-\t\t  const std::string &errmsg)\n-{\n-  /* TODO: 'error_at' would like a non-'const' 'rich_location *'.  */\n-  rich_location &gcc_loc = const_cast<rich_location &> (location.get ());\n-  diagnostic_metadata m;\n-  rust_error_code_rule rule (code);\n-  m.add_rule (rule);\n-  error_meta (&gcc_loc, m, \"%s\", errmsg.c_str ());\n-}\n-\n-void\n-rust_be_get_quotechars (const char **open_qu, const char **close_qu)\n-{\n-  *open_qu = open_quote;\n-  *close_qu = close_quote;\n-}\n-\n-bool\n-rust_be_debug_p (void)\n-{\n-  return !!flag_rust_debug;\n-}"}]}