{"sha": "085efec58f7088152576e386cc8ddeb9f5ff5068", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDg1ZWZlYzU4ZjcwODgxNTI1NzZlMzg2Y2M4ZGRlYjlmNWZmNTA2OA==", "commit": {"author": {"name": "Iain Sandoe", "email": "iain@sandoe.co.uk", "date": "2019-06-27T18:56:53Z"}, "committer": {"name": "Iain Sandoe", "email": "iains@gcc.gnu.org", "date": "2019-06-27T18:56:53Z"}, "message": "[Darwin, PPC] Do not use longcall for 64b code.\n\nThe linker [ld64] that supports 64Bit does not need the JBSR longcall\noptimisation, and will not work with the most generic case (where the\nsymbol is undefined external, but there is no symbl stub).  So switch\nthe longcall option off.  ld64 will generate branch islands as needed.\n\n2019-06-27  Iain Sandoe  <iain@sandoe.co.uk>\n\n\t* config/rs6000/rs6000.c (darwin_rs6000_override_options): Do not\n\tuse longcall for 64b code.\n\nFrom-SVN: r272758", "tree": {"sha": "132890d90f323a0a5df1e20ccd4d1bc4c46125ab", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/132890d90f323a0a5df1e20ccd4d1bc4c46125ab"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/085efec58f7088152576e386cc8ddeb9f5ff5068", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/085efec58f7088152576e386cc8ddeb9f5ff5068", "html_url": "https://github.com/Rust-GCC/gccrs/commit/085efec58f7088152576e386cc8ddeb9f5ff5068", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/085efec58f7088152576e386cc8ddeb9f5ff5068/comments", "author": {"login": "iains", "id": 4039407, "node_id": "MDQ6VXNlcjQwMzk0MDc=", "avatar_url": "https://avatars.githubusercontent.com/u/4039407?v=4", "gravatar_id": "", "url": "https://api.github.com/users/iains", "html_url": "https://github.com/iains", "followers_url": "https://api.github.com/users/iains/followers", "following_url": "https://api.github.com/users/iains/following{/other_user}", "gists_url": "https://api.github.com/users/iains/gists{/gist_id}", "starred_url": "https://api.github.com/users/iains/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/iains/subscriptions", "organizations_url": "https://api.github.com/users/iains/orgs", "repos_url": "https://api.github.com/users/iains/repos", "events_url": "https://api.github.com/users/iains/events{/privacy}", "received_events_url": "https://api.github.com/users/iains/received_events", "type": "User", "site_admin": false}, "committer": {"login": "iains", "id": 4039407, "node_id": "MDQ6VXNlcjQwMzk0MDc=", "avatar_url": "https://avatars.githubusercontent.com/u/4039407?v=4", "gravatar_id": "", "url": "https://api.github.com/users/iains", "html_url": "https://github.com/iains", "followers_url": "https://api.github.com/users/iains/followers", "following_url": "https://api.github.com/users/iains/following{/other_user}", "gists_url": "https://api.github.com/users/iains/gists{/gist_id}", "starred_url": "https://api.github.com/users/iains/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/iains/subscriptions", "organizations_url": "https://api.github.com/users/iains/orgs", "repos_url": "https://api.github.com/users/iains/repos", "events_url": "https://api.github.com/users/iains/events{/privacy}", "received_events_url": "https://api.github.com/users/iains/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c2fe65930a4b48017042e49516eb338c9e241e53", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c2fe65930a4b48017042e49516eb338c9e241e53", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c2fe65930a4b48017042e49516eb338c9e241e53"}], "stats": {"total": 14, "additions": 14, "deletions": 0}, "files": [{"sha": "7e6396c2eb0814930d6379362ce1d87aa064430a", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/085efec58f7088152576e386cc8ddeb9f5ff5068/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/085efec58f7088152576e386cc8ddeb9f5ff5068/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=085efec58f7088152576e386cc8ddeb9f5ff5068", "patch": "@@ -1,3 +1,8 @@\n+2019-06-27  Iain Sandoe  <iain@sandoe.co.uk>\n+\n+\t* config/rs6000/rs6000.c (darwin_rs6000_override_options): Do not\n+\tuse longcall for 64b code.\n+\n 2019-06-27  Aaron Sawdey <acsawdey@linux.ibm.com>\n \n \t* builtins.c (get_memory_rtx): Fix comment."}, {"sha": "fbff6bdb0a5faa7b264f475d40b8b33fde4c65d8", "filename": "gcc/config/rs6000/rs6000.c", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/085efec58f7088152576e386cc8ddeb9f5ff5068/gcc%2Fconfig%2Frs6000%2Frs6000.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/085efec58f7088152576e386cc8ddeb9f5ff5068/gcc%2Fconfig%2Frs6000%2Frs6000.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.c?ref=085efec58f7088152576e386cc8ddeb9f5ff5068", "patch": "@@ -3418,6 +3418,15 @@ darwin_rs6000_override_options (void)\n       rs6000_isa_flags |= OPTION_MASK_POWERPC64;\n       warning (0, \"%qs requires PowerPC64 architecture, enabling\", \"-m64\");\n     }\n+\n+  /* The linkers [ld64] that support 64Bit do not need the JBSR longcall\n+     optimisation, and will not work with the most generic case (where the\n+     symbol is undefined external, but there is no symbl stub).  */\n+  if (TARGET_64BIT)\n+    rs6000_default_long_calls = 0;\n+\n+  /* ld_classic is (so far) still used for kernel (static) code, and supports\n+     the JBSR longcall / branch islands.  */\n   if (flag_mkernel)\n     {\n       rs6000_default_long_calls = 1;"}]}