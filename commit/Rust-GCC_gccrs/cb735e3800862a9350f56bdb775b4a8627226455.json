{"sha": "cb735e3800862a9350f56bdb775b4a8627226455", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Y2I3MzVlMzgwMDg2MmE5MzUwZjU2YmRiNzc1YjRhODYyNzIyNjQ1NQ==", "commit": {"author": {"name": "Janne Blomqvist", "email": "jb@gcc.gnu.org", "date": "2012-01-12T09:58:34Z"}, "committer": {"name": "Janne Blomqvist", "email": "jb@gcc.gnu.org", "date": "2012-01-12T09:58:34Z"}, "message": "PR 51803 Avoid malloc if getcwd fails or is not available.\n\n2012-01-12  Janne Blomqvist  <jb@gcc.gnu.org>\n\t    Tobias Burnus  <burnus@net-b.de>\n\n\tPR libfortran/51803\n\t* runtime/main.c (store_exe_path): Avoid malloc if getcwd fails or\n\tis not available.\n\nCo-Authored-By: Tobias Burnus <burnus@net-b.de>\n\nFrom-SVN: r183122", "tree": {"sha": "ecec08b90b14048a337d070bc48ab04deedc35ed", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ecec08b90b14048a337d070bc48ab04deedc35ed"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/cb735e3800862a9350f56bdb775b4a8627226455", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cb735e3800862a9350f56bdb775b4a8627226455", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cb735e3800862a9350f56bdb775b4a8627226455", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cb735e3800862a9350f56bdb775b4a8627226455/comments", "author": null, "committer": null, "parents": [{"sha": "725a74a517294915302c713ee309340779514621", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/725a74a517294915302c713ee309340779514621", "html_url": "https://github.com/Rust-GCC/gccrs/commit/725a74a517294915302c713ee309340779514621"}], "stats": {"total": 19, "additions": 16, "deletions": 3}, "files": [{"sha": "7072e18229715b950a188d3032370cbe8d9776fb", "filename": "libgfortran/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cb735e3800862a9350f56bdb775b4a8627226455/libgfortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cb735e3800862a9350f56bdb775b4a8627226455/libgfortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2FChangeLog?ref=cb735e3800862a9350f56bdb775b4a8627226455", "patch": "@@ -1,10 +1,18 @@\n+2012-01-12  Janne Blomqvist  <jb@gcc.gnu.org>\n+\t    Tobias Burnus  <burnus@net-b.de>\n+\n+\tPR libfortran/51803\n+\t* runtime/main.c (store_exe_path): Avoid malloc if getcwd fails or\n+\tis not available.\n+\n 2012-01-11  Tobias Burnus  <burnus@net-b.de>\n \n \t* runtime/main.c (store_exe_path): Fix absolute path\n \tdetection for Windows.\n \n 2012-01-11  Janne Blomqvist  <jb@gcc.gnu.org>\n \t    Mike Stump  <mikestump@comcast.net>\n+\n \tPR libfortran/51803\n \t* runtime/main.c (store_exe_path): Handle getcwd failure and lack\n \tof the function better."}, {"sha": "79659e52bcd250be15823926b32a3cbef3b498ea", "filename": "libgfortran/runtime/main.c", "status": "modified", "additions": 8, "deletions": 3, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cb735e3800862a9350f56bdb775b4a8627226455/libgfortran%2Fruntime%2Fmain.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cb735e3800862a9350f56bdb775b4a8627226455/libgfortran%2Fruntime%2Fmain.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fruntime%2Fmain.c?ref=cb735e3800862a9350f56bdb775b4a8627226455", "patch": "@@ -124,12 +124,17 @@ store_exe_path (const char * argv0)\n \n #ifdef HAVE_GETCWD\n   cwd = getcwd (buf, sizeof (buf));\n-  if (!cwd)\n-    cwd = \".\";\n #else\n-  cwd = \".\";\n+  cwd = NULL;\n #endif\n \n+  if (!cwd)\n+    {\n+      exe_path = argv0;\n+      please_free_exe_path_when_done = 0;\n+      return;\n+    }\n+\n   /* exe_path will be cwd + \"/\" + argv[0] + \"\\0\".  This will not work\n      if the executable is not in the cwd, but at this point we're out\n      of better ideas.  */"}]}