{"sha": "688974a346b1f73cbf94ebe0ca95f4690a7f922b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Njg4OTc0YTM0NmIxZjczY2JmOTRlYmUwY2E5NWY0NjkwYTdmOTIyYg==", "commit": {"author": {"name": "Janus Weil", "email": "janus@gcc.gnu.org", "date": "2013-12-10T21:41:43Z"}, "committer": {"name": "Janus Weil", "email": "janus@gcc.gnu.org", "date": "2013-12-10T21:41:43Z"}, "message": "re PR fortran/35831 ([F95] Shape mismatch check missing for dummy procedure argument)\n\n2013-12-10  Janus Weil  <janus@gcc.gnu.org>\n\n\tPR fortran/35831\n\t* interface.c (check_dummy_characteristics): Add checks for several\n\tattributes.\n\n\n2013-12-10  Janus Weil  <janus@gcc.gnu.org>\n\n\tPR fortran/35831\n\t* gfortran.dg/c_by_val_5.f90: Modified.\n\t* gfortran.dg/dummy_procedure_10.f90: New.\n\nFrom-SVN: r205873", "tree": {"sha": "b5b754a913dc5824d89b51b16207d84626e2959f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b5b754a913dc5824d89b51b16207d84626e2959f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/688974a346b1f73cbf94ebe0ca95f4690a7f922b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/688974a346b1f73cbf94ebe0ca95f4690a7f922b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/688974a346b1f73cbf94ebe0ca95f4690a7f922b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/688974a346b1f73cbf94ebe0ca95f4690a7f922b/comments", "author": {"login": "janusw", "id": 484108, "node_id": "MDQ6VXNlcjQ4NDEwOA==", "avatar_url": "https://avatars.githubusercontent.com/u/484108?v=4", "gravatar_id": "", "url": "https://api.github.com/users/janusw", "html_url": "https://github.com/janusw", "followers_url": "https://api.github.com/users/janusw/followers", "following_url": "https://api.github.com/users/janusw/following{/other_user}", "gists_url": "https://api.github.com/users/janusw/gists{/gist_id}", "starred_url": "https://api.github.com/users/janusw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/janusw/subscriptions", "organizations_url": "https://api.github.com/users/janusw/orgs", "repos_url": "https://api.github.com/users/janusw/repos", "events_url": "https://api.github.com/users/janusw/events{/privacy}", "received_events_url": "https://api.github.com/users/janusw/received_events", "type": "User", "site_admin": false}, "committer": {"login": "janusw", "id": 484108, "node_id": "MDQ6VXNlcjQ4NDEwOA==", "avatar_url": "https://avatars.githubusercontent.com/u/484108?v=4", "gravatar_id": "", "url": "https://api.github.com/users/janusw", "html_url": "https://github.com/janusw", "followers_url": "https://api.github.com/users/janusw/followers", "following_url": "https://api.github.com/users/janusw/following{/other_user}", "gists_url": "https://api.github.com/users/janusw/gists{/gist_id}", "starred_url": "https://api.github.com/users/janusw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/janusw/subscriptions", "organizations_url": "https://api.github.com/users/janusw/orgs", "repos_url": "https://api.github.com/users/janusw/repos", "events_url": "https://api.github.com/users/janusw/events{/privacy}", "received_events_url": "https://api.github.com/users/janusw/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "61063a2a69b6562f088fcb41f1d146b509215039", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/61063a2a69b6562f088fcb41f1d146b509215039", "html_url": "https://github.com/Rust-GCC/gccrs/commit/61063a2a69b6562f088fcb41f1d146b509215039"}], "stats": {"total": 103, "additions": 100, "deletions": 3}, "files": [{"sha": "cb87dd05c1adfaca9e35517961ccbad0e198beb6", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/688974a346b1f73cbf94ebe0ca95f4690a7f922b/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/688974a346b1f73cbf94ebe0ca95f4690a7f922b/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=688974a346b1f73cbf94ebe0ca95f4690a7f922b", "patch": "@@ -1,3 +1,9 @@\n+2013-12-10  Janus Weil  <janus@gcc.gnu.org>\n+\n+\tPR fortran/35831\n+\t* interface.c (check_dummy_characteristics): Add checks for several\n+\tattributes.\n+\n 2013-12-10  Janus Weil  <janus@gcc.gnu.org>\n \n \t* gfortran.texi: Add possible kind values (and default) for"}, {"sha": "1cd1c2b0e3a66e965a9c8a0be5bac99cef37bd14", "filename": "gcc/fortran/interface.c", "status": "modified", "additions": 31, "deletions": 2, "changes": 33, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/688974a346b1f73cbf94ebe0ca95f4690a7f922b/gcc%2Ffortran%2Finterface.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/688974a346b1f73cbf94ebe0ca95f4690a7f922b/gcc%2Ffortran%2Finterface.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Finterface.c?ref=688974a346b1f73cbf94ebe0ca95f4690a7f922b", "patch": "@@ -1114,8 +1114,37 @@ check_dummy_characteristics (gfc_symbol *s1, gfc_symbol *s2,\n       return false;\n     }\n \n-  /* FIXME: Do more comprehensive testing of attributes, like e.g.\n-\t    ASYNCHRONOUS, CONTIGUOUS, VALUE, VOLATILE, etc.  */\n+  /* Check ASYNCHRONOUS attribute.  */\n+  if (s1->attr.asynchronous != s2->attr.asynchronous)\n+    {\n+      snprintf (errmsg, err_len, \"ASYNCHRONOUS mismatch in argument '%s'\",\n+\t\ts1->name);\n+      return false;\n+    }\n+\n+  /* Check CONTIGUOUS attribute.  */\n+  if (s1->attr.contiguous != s2->attr.contiguous)\n+    {\n+      snprintf (errmsg, err_len, \"CONTIGUOUS mismatch in argument '%s'\",\n+\t\ts1->name);\n+      return false;\n+    }\n+\n+  /* Check VALUE attribute.  */\n+  if (s1->attr.value != s2->attr.value)\n+    {\n+      snprintf (errmsg, err_len, \"VALUE mismatch in argument '%s'\",\n+\t\ts1->name);\n+      return false;\n+    }\n+\n+  /* Check VOLATILE attribute.  */\n+  if (s1->attr.volatile_ != s2->attr.volatile_)\n+    {\n+      snprintf (errmsg, err_len, \"VOLATILE mismatch in argument '%s'\",\n+\t\ts1->name);\n+      return false;\n+    }\n \n   /* Check interface of dummy procedures.  */\n   if (s1->attr.flavor == FL_PROCEDURE)"}, {"sha": "5477f3f178dbcdbd78743132259524a40c560f1a", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/688974a346b1f73cbf94ebe0ca95f4690a7f922b/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/688974a346b1f73cbf94ebe0ca95f4690a7f922b/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=688974a346b1f73cbf94ebe0ca95f4690a7f922b", "patch": "@@ -1,3 +1,9 @@\n+2013-12-10  Janus Weil  <janus@gcc.gnu.org>\n+\n+\tPR fortran/35831\n+\t* gfortran.dg/c_by_val_5.f90: Modified.\n+\t* gfortran.dg/dummy_procedure_10.f90: New.\n+\n 2013-12-10  Yury Gribov  <y.gribov@samsung.com>\n \n \t* gcc-dg/tsan/tsan.exp: Added missing call to torture-finish."}, {"sha": "3a8bc3bf750c90aa1200eb0cd62c9cb982be99f9", "filename": "gcc/testsuite/gfortran.dg/c_by_val_5.f90", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/688974a346b1f73cbf94ebe0ca95f4690a7f922b/gcc%2Ftestsuite%2Fgfortran.dg%2Fc_by_val_5.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/688974a346b1f73cbf94ebe0ca95f4690a7f922b/gcc%2Ftestsuite%2Fgfortran.dg%2Fc_by_val_5.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fc_by_val_5.f90?ref=688974a346b1f73cbf94ebe0ca95f4690a7f922b", "patch": "@@ -23,7 +23,7 @@ module x\n  ! \"external\" only.\n  interface\n    subroutine bmp_write(nx)\n-     integer :: nx\n+     integer, value :: nx\n    end subroutine bmp_write\n  end interface\n contains"}, {"sha": "2720b8f2eb66e660ce5e4bb054c2f72022a8bc1f", "filename": "gcc/testsuite/gfortran.dg/dummy_procedure_10.f90", "status": "added", "additions": 56, "deletions": 0, "changes": 56, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/688974a346b1f73cbf94ebe0ca95f4690a7f922b/gcc%2Ftestsuite%2Fgfortran.dg%2Fdummy_procedure_10.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/688974a346b1f73cbf94ebe0ca95f4690a7f922b/gcc%2Ftestsuite%2Fgfortran.dg%2Fdummy_procedure_10.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fdummy_procedure_10.f90?ref=688974a346b1f73cbf94ebe0ca95f4690a7f922b", "patch": "@@ -0,0 +1,56 @@\n+! { dg-do compile }\n+!\n+! PR 35831: [F95] Shape mismatch check missing for dummy procedure argument\n+!\n+! Contributed by Janus Weil <janus@gcc.gnu.org>\n+\n+program test_attributes\n+\n+  call tester1 (a1)   ! { dg-error \"ASYNCHRONOUS mismatch in argument\" }\n+  call tester2 (a2)   ! { dg-error \"CONTIGUOUS mismatch in argument\" }\n+  call tester3 (a1)   ! { dg-error \"VALUE mismatch in argument\" }\n+  call tester4 (a1)   ! { dg-error \"VOLATILE mismatch in argument\" }\n+\n+contains\n+\n+  subroutine a1(aa)\n+    real :: aa\n+  end subroutine\n+  \n+  subroutine a2(bb)\n+    real :: bb(:)\n+  end subroutine\n+\n+  subroutine tester1 (f1)\n+    interface\n+      subroutine f1 (a)\n+        real, asynchronous :: a\n+      end subroutine\n+    end interface\n+  end subroutine\n+\n+  subroutine tester2 (f2)\n+    interface\n+      subroutine f2 (b)\n+        real, contiguous :: b(:)\n+      end subroutine\n+    end interface\n+  end subroutine\n+  \n+  subroutine tester3 (f3)\n+    interface\n+      subroutine f3 (c)\n+        real, value :: c\n+      end subroutine\n+    end interface\n+  end subroutine\n+  \n+  subroutine tester4 (f4)\n+    interface\n+      subroutine f4 (d)\n+        real, volatile :: d\n+      end subroutine\n+    end interface\n+  end subroutine\n+\n+end"}]}