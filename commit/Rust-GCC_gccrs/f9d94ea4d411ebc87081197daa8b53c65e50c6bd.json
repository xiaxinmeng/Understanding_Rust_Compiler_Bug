{"sha": "f9d94ea4d411ebc87081197daa8b53c65e50c6bd", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjlkOTRlYTRkNDExZWJjODcwODExOTdkYWE4YjUzYzY1ZTUwYzZiZA==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@yorick.cygnus.com", "date": "1998-05-20T23:53:04Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "1998-05-20T23:53:04Z"}, "message": "decl.c (grokfndecl): Handle definition of specialization in friend declaration.\n\n\t* decl.c (grokfndecl): Handle definition of specialization in\n\tfriend declaration.\n\t* error.c (dump_decl): Fix LOOKUP_EXPR handling.\n\nFrom-SVN: r19919", "tree": {"sha": "36cf0562e2a9256de61a225af0e201604f64f713", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/36cf0562e2a9256de61a225af0e201604f64f713"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f9d94ea4d411ebc87081197daa8b53c65e50c6bd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f9d94ea4d411ebc87081197daa8b53c65e50c6bd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f9d94ea4d411ebc87081197daa8b53c65e50c6bd", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f9d94ea4d411ebc87081197daa8b53c65e50c6bd/comments", "author": null, "committer": null, "parents": [{"sha": "35acd3f28278072c4753f582ecdc1d49935b1d25", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/35acd3f28278072c4753f582ecdc1d49935b1d25", "html_url": "https://github.com/Rust-GCC/gccrs/commit/35acd3f28278072c4753f582ecdc1d49935b1d25"}], "stats": {"total": 36, "additions": 25, "deletions": 11}, "files": [{"sha": "6353d8d31d2bedd672323370db57b994fa7be0a4", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f9d94ea4d411ebc87081197daa8b53c65e50c6bd/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f9d94ea4d411ebc87081197daa8b53c65e50c6bd/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=f9d94ea4d411ebc87081197daa8b53c65e50c6bd", "patch": "@@ -1,3 +1,10 @@\n+1998-05-20  Jason Merrill  <jason@yorick.cygnus.com>\n+\n+\t* decl.c (grokfndecl): Handle definition of specialization in\n+\tfriend declaration.\n+\n+\t* error.c (dump_decl): Fix LOOKUP_EXPR handling.\n+\n 1998-05-20  Mark Mitchell  <mmitchell@usa.net>\n \n \t* class.c (delete_duplicate_fields_1): Use DECL_DECLARES_TYPE_P"}, {"sha": "a4f9e005f55036d382f0228236f9f7dfe4828cb2", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 17, "deletions": 10, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f9d94ea4d411ebc87081197daa8b53c65e50c6bd/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f9d94ea4d411ebc87081197daa8b53c65e50c6bd/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=f9d94ea4d411ebc87081197daa8b53c65e50c6bd", "patch": "@@ -7625,16 +7625,23 @@ grokfndecl (ctype, type, declarator, orig_declarator, virtualp, flags, quals,\n \tbreak;\n       }\n \n-  if (friendp && \n-      TREE_CODE (orig_declarator) == TEMPLATE_ID_EXPR)\n-    {\n-      /* A friend declaration of the form friend void f<>().  Record\n-\t the information in the TEMPLATE_ID_EXPR.  */\n-      SET_DECL_IMPLICIT_INSTANTIATION (decl);\n-      DECL_TEMPLATE_INFO (decl) \n-\t= perm_tree_cons (TREE_OPERAND (orig_declarator, 0),\n-\t\t\t  TREE_OPERAND (orig_declarator, 1),\n-\t\t\t  NULL_TREE);\n+  if (friendp\n+      && TREE_CODE (orig_declarator) == TEMPLATE_ID_EXPR)\n+    {\n+      if (funcdef_flag)\n+\tcp_error\n+\t  (\"defining explicit specialization `%D' in friend declaration\",\n+\t   orig_declarator);\n+      else\n+\t{\n+\t  /* A friend declaration of the form friend void f<>().  Record\n+\t     the information in the TEMPLATE_ID_EXPR.  */\n+\t  SET_DECL_IMPLICIT_INSTANTIATION (decl);\n+\t  DECL_TEMPLATE_INFO (decl)\n+\t    = perm_tree_cons (TREE_OPERAND (orig_declarator, 0),\n+\t\t\t      TREE_OPERAND (orig_declarator, 1),\n+\t\t\t      NULL_TREE);\n+\t}\n     }\n \n   /* Caller will do the rest of this.  */"}, {"sha": "c75481956374a56a7f9157ac465e3671f0eafc45", "filename": "gcc/cp/error.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f9d94ea4d411ebc87081197daa8b53c65e50c6bd/gcc%2Fcp%2Ferror.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f9d94ea4d411ebc87081197daa8b53c65e50c6bd/gcc%2Fcp%2Ferror.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ferror.c?ref=f9d94ea4d411ebc87081197daa8b53c65e50c6bd", "patch": "@@ -872,7 +872,7 @@ dump_decl (t, v)\n       break;\n \n     case LOOKUP_EXPR:\n-      OB_PUTID (TREE_OPERAND (t, 0));\n+      dump_decl (TREE_OPERAND (t, 0), v);\n       break;\n \n     case LABEL_DECL:"}]}