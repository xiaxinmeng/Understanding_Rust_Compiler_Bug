{"sha": "6a04272a9a6981d30d4c21d99f10405c9a48a5c6", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NmEwNDI3MmE5YTY5ODFkMzBkNGMyMWQ5OWYxMDQwNWM5YTQ4YTVjNg==", "commit": {"author": {"name": "Thomas Quinot", "email": "quinot@adacore.com", "date": "2013-01-02T09:39:36Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2013-01-02T09:39:36Z"}, "message": "sem_ch13.adb (Analyze_Aspect_Specifications): For a Pre/Post aspect that applies to a library subprogram...\n\n2013-01-02  Thomas Quinot  <quinot@adacore.com>\n\n\t* sem_ch13.adb (Analyze_Aspect_Specifications): For a Pre/Post\n\taspect that applies to a library subprogram, prepend corresponding\n\tpragma to the Pragmas_After list, in order for split AND THEN\n\tsections to be processed in the expected order.\n\nFrom-SVN: r194783", "tree": {"sha": "1b67dd78c7c751ad2367e4a79f12f547237cb5d4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1b67dd78c7c751ad2367e4a79f12f547237cb5d4"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6a04272a9a6981d30d4c21d99f10405c9a48a5c6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6a04272a9a6981d30d4c21d99f10405c9a48a5c6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6a04272a9a6981d30d4c21d99f10405c9a48a5c6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6a04272a9a6981d30d4c21d99f10405c9a48a5c6/comments", "author": null, "committer": null, "parents": [{"sha": "c5d00db06fdfa662780ddbb179a684e221655b34", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c5d00db06fdfa662780ddbb179a684e221655b34", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c5d00db06fdfa662780ddbb179a684e221655b34"}], "stats": {"total": 24, "additions": 21, "deletions": 3}, "files": [{"sha": "607bcb83fc751f1552139dac1f24dcd63c60f067", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6a04272a9a6981d30d4c21d99f10405c9a48a5c6/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6a04272a9a6981d30d4c21d99f10405c9a48a5c6/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=6a04272a9a6981d30d4c21d99f10405c9a48a5c6", "patch": "@@ -1,3 +1,10 @@\n+2013-01-02  Thomas Quinot  <quinot@adacore.com>\n+\n+\t* sem_ch13.adb (Analyze_Aspect_Specifications): For a Pre/Post\n+\taspect that applies to a library subprogram, prepend corresponding\n+\tpragma to the Pragmas_After list, in order for split AND THEN\n+\tsections to be processed in the expected order.\n+\n 2013-01-02  Thomas Quinot  <quinot@adacore.com>\n \n \t* exp_prag.adb (Expand_Pragma_Check): The statements generated"}, {"sha": "221c86627919bd67078cf5d35f2581a3a8cdaf55", "filename": "gcc/ada/sem_ch13.adb", "status": "modified", "additions": 14, "deletions": 3, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6a04272a9a6981d30d4c21d99f10405c9a48a5c6/gcc%2Fada%2Fsem_ch13.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6a04272a9a6981d30d4c21d99f10405c9a48a5c6/gcc%2Fada%2Fsem_ch13.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch13.adb?ref=6a04272a9a6981d30d4c21d99f10405c9a48a5c6", "patch": "@@ -1602,10 +1602,21 @@ package body Sem_Ch13 is\n                   --  with delay of visibility for the expression analysis.\n \n                   --  If the entity is a library-level subprogram, the pre/\n-                  --  postconditions must be treated as late pragmas.\n+                  --  postconditions must be treated as late pragmas. Note\n+                  --  that they must be prepended, not appended, to the list,\n+                  --  so that split AND THEN sections are processed in the\n+                  --  correct order.\n \n                   if Nkind (Parent (N)) = N_Compilation_Unit then\n-                     Add_Global_Declaration (Aitem);\n+                     declare\n+                        Aux : constant Node_Id := Aux_Decls_Node (Parent (N));\n+                     begin\n+                        if No (Pragmas_After (Aux)) then\n+                           Set_Pragmas_After (Aux, New_List);\n+                        end if;\n+\n+                        Prepend (Aitem, Pragmas_After (Aux));\n+                     end;\n \n                   --  If it is a subprogram body, add pragmas to list of\n                   --  declarations in body.\n@@ -1930,7 +1941,7 @@ package body Sem_Ch13 is\n \n                   else\n                      if No (Pragmas_After (Aux)) then\n-                        Set_Pragmas_After (Aux, Empty_List);\n+                        Set_Pragmas_After (Aux, New_List);\n                      end if;\n \n                      Append (Aitem, Pragmas_After (Aux));"}]}