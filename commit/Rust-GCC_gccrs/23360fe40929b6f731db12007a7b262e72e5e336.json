{"sha": "23360fe40929b6f731db12007a7b262e72e5e336", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjMzNjBmZTQwOTI5YjZmNzMxZGIxMjAwN2E3YjI2MmU3MmU1ZTMzNg==", "commit": {"author": {"name": "Thomas Koenig", "email": "tkoenig@gcc.gnu.org", "date": "2011-03-29T07:58:54Z"}, "committer": {"name": "Thomas Koenig", "email": "tkoenig@gcc.gnu.org", "date": "2011-03-29T07:58:54Z"}, "message": "function_optimize_1.f90: Add -Warray-temporaries, check for corresponding warning.\n\n2011-03-29  Thomas Koenig  <tkoenig@gcc.gnu.org>\n\n\t* gfortran.dg/function_optimize_1.f90:  Add -Warray-temporaries,\n\tcheck for corresponding warning.\n\n2011-03-29  Thomas Koenig  <tkoenig@gcc.gnu.org>\n\n\t* frontend-passes.c (create_var):  Warn about creating an\n\tarray temporary if requested.\n\nFrom-SVN: r171653", "tree": {"sha": "1acd8e0e6c03c7b1a06a0e430e76382f808828b6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1acd8e0e6c03c7b1a06a0e430e76382f808828b6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/23360fe40929b6f731db12007a7b262e72e5e336", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/23360fe40929b6f731db12007a7b262e72e5e336", "html_url": "https://github.com/Rust-GCC/gccrs/commit/23360fe40929b6f731db12007a7b262e72e5e336", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/23360fe40929b6f731db12007a7b262e72e5e336/comments", "author": null, "committer": null, "parents": [{"sha": "b7469e034026f2c99add427a6c7e90f7088cd712", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b7469e034026f2c99add427a6c7e90f7088cd712", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b7469e034026f2c99add427a6c7e90f7088cd712"}], "stats": {"total": 19, "additions": 16, "deletions": 3}, "files": [{"sha": "4bb344d003a1d9ac3fab00fb5f95ed01e1632b76", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/23360fe40929b6f731db12007a7b262e72e5e336/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/23360fe40929b6f731db12007a7b262e72e5e336/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=23360fe40929b6f731db12007a7b262e72e5e336", "patch": "@@ -1,7 +1,12 @@\n+2011-03-29  Thomas Koenig  <tkoenig@gcc.gnu.org>\n+\n+\t* frontend-passes.c (create_var):  Warn about creating an\n+\tarray temporary if requested.\n+\n 2011-03-27  Thomas Koenig  <tkoenig@gcc.gnu.org>\n \n \tPR fortran/47065\n-\t* frontend-passes (optimize_trim): Also follow references, except\n+\t* frontend-passes.c (optimize_trim): Also follow references, except\n \twhen they are substring references or array references.\n \n 2011-03-27  Tobias Burnus  <burnus@net-b.de>"}, {"sha": "6e59c37cdbcbcd25812d8453e36e677342fb1f73", "filename": "gcc/fortran/frontend-passes.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/23360fe40929b6f731db12007a7b262e72e5e336/gcc%2Ffortran%2Ffrontend-passes.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/23360fe40929b6f731db12007a7b262e72e5e336/gcc%2Ffortran%2Ffrontend-passes.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ffrontend-passes.c?ref=23360fe40929b6f731db12007a7b262e72e5e336", "patch": "@@ -256,6 +256,8 @@ create_var (gfc_expr * e)\n       result->ref->u.ar.type = AR_FULL;\n       result->ref->u.ar.where = e->where;\n       result->ref->u.ar.as = symbol->as;\n+      if (gfc_option.warn_array_temp)\n+\tgfc_warning (\"Creating array temporary at %L\", &(e->where));\n     }\n \n   /* Generate the new assignment.  */"}, {"sha": "071f9596777fcc8279915978529bd3a088cc4f7f", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/23360fe40929b6f731db12007a7b262e72e5e336/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/23360fe40929b6f731db12007a7b262e72e5e336/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=23360fe40929b6f731db12007a7b262e72e5e336", "patch": "@@ -1,3 +1,8 @@\n+2011-03-29  Thomas Koenig  <tkoenig@gcc.gnu.org>\n+\n+\t* gfortran.dg/function_optimize_1.f90:  Add -Warray-temporaries,\n+\tcheck for corresponding warning.\n+\n 2011-03-28  Jason Merrill  <jason@redhat.com>\n \n \t* g++.dg/cpp0x/rv-deduce2.C: New."}, {"sha": "b023121831bd2e1eb501f63f9fe83680efe94509", "filename": "gcc/testsuite/gfortran.dg/function_optimize_1.f90", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/23360fe40929b6f731db12007a7b262e72e5e336/gcc%2Ftestsuite%2Fgfortran.dg%2Ffunction_optimize_1.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/23360fe40929b6f731db12007a7b262e72e5e336/gcc%2Ftestsuite%2Fgfortran.dg%2Ffunction_optimize_1.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Ffunction_optimize_1.f90?ref=23360fe40929b6f731db12007a7b262e72e5e336", "patch": "@@ -1,5 +1,5 @@\n ! { dg-do compile }\n-! { dg-options \"-O -fdump-tree-original\" }\n+! { dg-options \"-O -fdump-tree-original -Warray-temporaries\" }\n program main\n   implicit none\n   real, dimension(2,2) :: a, b, c, d\n@@ -24,7 +24,8 @@ end function elem_impure\n \n   data a /2., 3., 5., 7./\n   data b /11., 13., 17., 23./\n-  write (unit=line, fmt='(4F7.2)') matmul(a,b) + matmul(a,b)\n+  write (unit=line, fmt='(4F7.2)') matmul(a,b)  &\n+       & + matmul(a,b)    ! { dg-warning \"Creating array temporary\" }\n   z = sin(x) + cos(x) + sin(x) + cos(x)\n   print *,z\n   x = ext_func(a) + 23 + ext_func(a)"}]}