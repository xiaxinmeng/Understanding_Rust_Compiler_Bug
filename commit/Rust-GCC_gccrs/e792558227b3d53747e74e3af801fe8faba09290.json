{"sha": "e792558227b3d53747e74e3af801fe8faba09290", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTc5MjU1ODIyN2IzZDUzNzQ3ZTc0ZTNhZjgwMWZlOGZhYmEwOTI5MA==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2011-04-14T21:56:34Z"}, "committer": {"name": "Eric Botcazou", "email": "ebotcazou@gcc.gnu.org", "date": "2011-04-14T21:56:34Z"}, "message": "cfgexpand.c (expand_call_stmt): Rematerialize the original function type if this is not a builtin function.\n\n\t* cfgexpand.c (expand_call_stmt): Rematerialize the original function\n\ttype if this is not a builtin function.\n\nFrom-SVN: r172459", "tree": {"sha": "67e0575f05f86ecdf4777e969cf9afd3591f7de1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/67e0575f05f86ecdf4777e969cf9afd3591f7de1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e792558227b3d53747e74e3af801fe8faba09290", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e792558227b3d53747e74e3af801fe8faba09290", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e792558227b3d53747e74e3af801fe8faba09290", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e792558227b3d53747e74e3af801fe8faba09290/comments", "author": null, "committer": null, "parents": [{"sha": "09db7afe4f724be4582250bd68a0110a60896e95", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/09db7afe4f724be4582250bd68a0110a60896e95", "html_url": "https://github.com/Rust-GCC/gccrs/commit/09db7afe4f724be4582250bd68a0110a60896e95"}], "stats": {"total": 18, "additions": 14, "deletions": 4}, "files": [{"sha": "7808f4cf13c4a6d38e55fc356805471aaaf0383c", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e792558227b3d53747e74e3af801fe8faba09290/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e792558227b3d53747e74e3af801fe8faba09290/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=e792558227b3d53747e74e3af801fe8faba09290", "patch": "@@ -1,3 +1,8 @@\n+2011-04-14  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* cfgexpand.c (expand_call_stmt): Rematerialize the original function\n+\ttype if this is not a builtin function.\n+\n 2011-04-14  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR target/48605"}, {"sha": "45a638356b1f10abaccc441ce08f8fd7ba4c37a2", "filename": "gcc/cfgexpand.c", "status": "modified", "additions": 9, "deletions": 4, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e792558227b3d53747e74e3af801fe8faba09290/gcc%2Fcfgexpand.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e792558227b3d53747e74e3af801fe8faba09290/gcc%2Fcfgexpand.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcfgexpand.c?ref=e792558227b3d53747e74e3af801fe8faba09290", "patch": "@@ -1837,18 +1837,23 @@ expand_gimple_cond (basic_block bb, gimple stmt)\n static void\n expand_call_stmt (gimple stmt)\n {\n-  tree exp;\n-  tree lhs = gimple_call_lhs (stmt);\n-  size_t i;\n+  tree exp, decl, lhs = gimple_call_lhs (stmt);\n   bool builtin_p;\n-  tree decl;\n+  size_t i;\n \n   exp = build_vl_exp (CALL_EXPR, gimple_call_num_args (stmt) + 3);\n \n   CALL_EXPR_FN (exp) = gimple_call_fn (stmt);\n   decl = gimple_call_fndecl (stmt);\n   builtin_p = decl && DECL_BUILT_IN (decl);\n \n+  /* If this is not a builtin function, the function type through which the\n+     call is made may be different from the type of the function.  */\n+  if (!builtin_p)\n+    CALL_EXPR_FN (exp)\n+      = fold_build1 (NOP_EXPR, build_pointer_type (gimple_call_fntype (stmt)),\n+\t\t     CALL_EXPR_FN (exp));\n+\n   TREE_TYPE (exp) = gimple_call_return_type (stmt);\n   CALL_EXPR_STATIC_CHAIN (exp) = gimple_call_chain (stmt);\n "}]}