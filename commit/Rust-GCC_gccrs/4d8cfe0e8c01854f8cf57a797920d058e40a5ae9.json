{"sha": "4d8cfe0e8c01854f8cf57a797920d058e40a5ae9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NGQ4Y2ZlMGU4YzAxODU0ZjhjZjU3YTc5NzkyMGQwNThlNDBhNWFlOQ==", "commit": {"author": {"name": "Kewen Lin", "email": "linkw@gcc.gnu.org", "date": "2019-11-01T13:17:48Z"}, "committer": {"name": "Kewen Lin", "email": "linkw@gcc.gnu.org", "date": "2019-11-01T13:17:48Z"}, "message": "[rs6000] vector conversion RTL pattern update for same unit size\n\n2019-11-01  Kewen Lin  <linkw@gcc.gnu.org>\n\n  * config/rs6000/vsx.md (UNSPEC_VSX_CVSXWSP, UNSPEC_VSX_CVUXWSP,\n  UNSPEC_VSX_XVCVSXDDP, UNSPEC_VSX_XVCVUXDDP,\n  UNSPEC_VSX_XVCVDPSXDS, UNSPEC_VSX_XVCVDPUXDS,\n  UNSPEC_VSX_XVCVSPSXWS): Remove.\n  (vsx_xvcv<su>xddp, vsx_xvcvdp<su>xds, vsx_xvcvsp<su>xws,\n  vsx_xvcv<su>xwsp): Update define_insn RTL patterns.\n\nFrom-SVN: r277708", "tree": {"sha": "0cb6d3b9a51a31a72263680ebe1cd1d42ed2eb4d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0cb6d3b9a51a31a72263680ebe1cd1d42ed2eb4d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4d8cfe0e8c01854f8cf57a797920d058e40a5ae9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4d8cfe0e8c01854f8cf57a797920d058e40a5ae9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4d8cfe0e8c01854f8cf57a797920d058e40a5ae9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4d8cfe0e8c01854f8cf57a797920d058e40a5ae9/comments", "author": {"login": "jedilyn", "id": 38515402, "node_id": "MDQ6VXNlcjM4NTE1NDAy", "avatar_url": "https://avatars.githubusercontent.com/u/38515402?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jedilyn", "html_url": "https://github.com/jedilyn", "followers_url": "https://api.github.com/users/jedilyn/followers", "following_url": "https://api.github.com/users/jedilyn/following{/other_user}", "gists_url": "https://api.github.com/users/jedilyn/gists{/gist_id}", "starred_url": "https://api.github.com/users/jedilyn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jedilyn/subscriptions", "organizations_url": "https://api.github.com/users/jedilyn/orgs", "repos_url": "https://api.github.com/users/jedilyn/repos", "events_url": "https://api.github.com/users/jedilyn/events{/privacy}", "received_events_url": "https://api.github.com/users/jedilyn/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jedilyn", "id": 38515402, "node_id": "MDQ6VXNlcjM4NTE1NDAy", "avatar_url": "https://avatars.githubusercontent.com/u/38515402?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jedilyn", "html_url": "https://github.com/jedilyn", "followers_url": "https://api.github.com/users/jedilyn/followers", "following_url": "https://api.github.com/users/jedilyn/following{/other_user}", "gists_url": "https://api.github.com/users/jedilyn/gists{/gist_id}", "starred_url": "https://api.github.com/users/jedilyn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jedilyn/subscriptions", "organizations_url": "https://api.github.com/users/jedilyn/orgs", "repos_url": "https://api.github.com/users/jedilyn/repos", "events_url": "https://api.github.com/users/jedilyn/events{/privacy}", "received_events_url": "https://api.github.com/users/jedilyn/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "10e1540cdf2509d5414e5a2bc205b0811cf80637", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/10e1540cdf2509d5414e5a2bc205b0811cf80637", "html_url": "https://github.com/Rust-GCC/gccrs/commit/10e1540cdf2509d5414e5a2bc205b0811cf80637"}], "stats": {"total": 114, "additions": 37, "deletions": 77}, "files": [{"sha": "1a39d85d8f999216d05dc33f80678b0dc8b8644e", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4d8cfe0e8c01854f8cf57a797920d058e40a5ae9/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4d8cfe0e8c01854f8cf57a797920d058e40a5ae9/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=4d8cfe0e8c01854f8cf57a797920d058e40a5ae9", "patch": "@@ -1,3 +1,12 @@\n+2019-11-01  Kewen Lin  <linkw@gcc.gnu.org>\n+\n+\t* config/rs6000/vsx.md (UNSPEC_VSX_CVSXWSP, UNSPEC_VSX_CVUXWSP,\n+\tUNSPEC_VSX_XVCVSXDDP, UNSPEC_VSX_XVCVUXDDP,\n+\tUNSPEC_VSX_XVCVDPSXDS, UNSPEC_VSX_XVCVDPUXDS,\n+\tUNSPEC_VSX_XVCVSPSXWS): Remove.\n+\t(vsx_xvcv<su>xddp, vsx_xvcvdp<su>xds, vsx_xvcvsp<su>xws,\n+\tvsx_xvcv<su>xwsp): Update define_insn RTL patterns.\n+\n 2019-11-01  Kewen Lin  <linkw@gcc.gnu.org>\n \n \t* config/rs6000/vsx.md (vsx_xvcdpsp): Remove define_insn."}, {"sha": "05fcdd6cfc02e0f3e5510ed20caf6441c321d15c", "filename": "gcc/config/rs6000/vsx.md", "status": "modified", "additions": 28, "deletions": 77, "changes": 105, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4d8cfe0e8c01854f8cf57a797920d058e40a5ae9/gcc%2Fconfig%2Frs6000%2Fvsx.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4d8cfe0e8c01854f8cf57a797920d058e40a5ae9/gcc%2Fconfig%2Frs6000%2Fvsx.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Fvsx.md?ref=4d8cfe0e8c01854f8cf57a797920d058e40a5ae9", "patch": "@@ -277,8 +277,6 @@\n    UNSPEC_VSX_CVUXDSP\n    UNSPEC_VSX_CVSPSXDS\n    UNSPEC_VSX_CVSPUXDS\n-   UNSPEC_VSX_CVSXWSP\n-   UNSPEC_VSX_CVUXWSP\n    UNSPEC_VSX_FLOAT2\n    UNSPEC_VSX_UNS_FLOAT2\n    UNSPEC_VSX_FLOATE\n@@ -298,12 +296,7 @@\n    UNSPEC_VSX_DIVSD\n    UNSPEC_VSX_DIVUD\n    UNSPEC_VSX_MULSD\n-   UNSPEC_VSX_XVCVSXDDP\n-   UNSPEC_VSX_XVCVUXDDP\n-   UNSPEC_VSX_XVCVDPSXDS\n-   UNSPEC_VSX_XVCVDPUXDS\n    UNSPEC_VSX_SIGN_EXTEND\n-   UNSPEC_VSX_XVCVSPSXWS\n    UNSPEC_VSX_XVCVSPSXDS\n    UNSPEC_VSX_VSLO\n    UNSPEC_VSX_EXTRACT\n@@ -2210,6 +2203,34 @@\n \n ;; Convert and scale (used by vec_ctf, vec_cts, vec_ctu for double/long long)\n \n+(define_insn \"vsx_xvcv<su>xwsp\"\n+  [(set (match_operand:V4SF 0 \"vsx_register_operand\" \"=wa\")\n+     (any_float:V4SF (match_operand:V4SI 1 \"vsx_register_operand\" \"wa\")))]\n+  \"VECTOR_UNIT_VSX_P (V4SFmode)\"\n+  \"xvcv<su>xwsp %x0,%x1\"\n+  [(set_attr \"type\" \"vecfloat\")])\n+\n+(define_insn \"vsx_xvcv<su>xddp\"\n+  [(set (match_operand:V2DF 0 \"vsx_register_operand\" \"=wa\")\n+        (any_float:V2DF (match_operand:V2DI 1 \"vsx_register_operand\" \"wa\")))]\n+  \"VECTOR_UNIT_VSX_P (V2DFmode)\"\n+  \"xvcv<su>xddp %x0,%x1\"\n+  [(set_attr \"type\" \"vecdouble\")])\n+\n+(define_insn \"vsx_xvcvsp<su>xws\"\n+  [(set (match_operand:V4SI 0 \"vsx_register_operand\" \"=wa\")\n+        (any_fix:V4SI (match_operand:V4SF 1 \"vsx_register_operand\" \"wa\")))]\n+  \"VECTOR_UNIT_VSX_P (V4SFmode)\"\n+  \"xvcvsp<su>xws %x0,%x1\"\n+  [(set_attr \"type\" \"vecfloat\")])\n+\n+(define_insn \"vsx_xvcvdp<su>xds\"\n+  [(set (match_operand:V2DI 0 \"vsx_register_operand\" \"=wa\")\n+        (any_fix:V2DI (match_operand:V2DF 1 \"vsx_register_operand\" \"wa\")))]\n+  \"VECTOR_UNIT_VSX_P (V2DFmode)\"\n+  \"xvcvdp<su>xds %x0,%x1\"\n+  [(set_attr \"type\" \"vecdouble\")])\n+\n (define_expand \"vsx_xvcvsxddp_scale\"\n   [(match_operand:V2DF 0 \"vsx_register_operand\")\n    (match_operand:V2DI 1 \"vsx_register_operand\")\n@@ -2225,14 +2246,6 @@\n   DONE;\n })\n \n-(define_insn \"vsx_xvcvsxddp\"\n-  [(set (match_operand:V2DF 0 \"vsx_register_operand\" \"=wa\")\n-        (unspec:V2DF [(match_operand:V2DI 1 \"vsx_register_operand\" \"wa\")]\n-                     UNSPEC_VSX_XVCVSXDDP))]\n-  \"VECTOR_UNIT_VSX_P (V2DFmode)\"\n-  \"xvcvsxddp %x0,%x1\"\n-  [(set_attr \"type\" \"vecdouble\")])\n-\n (define_expand \"vsx_xvcvuxddp_scale\"\n   [(match_operand:V2DF 0 \"vsx_register_operand\")\n    (match_operand:V2DI 1 \"vsx_register_operand\")\n@@ -2248,14 +2261,6 @@\n   DONE;\n })\n \n-(define_insn \"vsx_xvcvuxddp\"\n-  [(set (match_operand:V2DF 0 \"vsx_register_operand\" \"=wa\")\n-        (unspec:V2DF [(match_operand:V2DI 1 \"vsx_register_operand\" \"wa\")]\n-                     UNSPEC_VSX_XVCVUXDDP))]\n-  \"VECTOR_UNIT_VSX_P (V2DFmode)\"\n-  \"xvcvuxddp %x0,%x1\"\n-  [(set_attr \"type\" \"vecdouble\")])\n-\n (define_expand \"vsx_xvcvdpsxds_scale\"\n   [(match_operand:V2DI 0 \"vsx_register_operand\")\n    (match_operand:V2DF 1 \"vsx_register_operand\")\n@@ -2277,26 +2282,6 @@\n   DONE;\n })\n \n-;; convert vector of 64-bit floating point numbers to vector of\n-;; 64-bit signed integer\n-(define_insn \"vsx_xvcvdpsxds\"\n-  [(set (match_operand:V2DI 0 \"vsx_register_operand\" \"=wa\")\n-        (unspec:V2DI [(match_operand:V2DF 1 \"vsx_register_operand\" \"wa\")]\n-                     UNSPEC_VSX_XVCVDPSXDS))]\n-  \"VECTOR_UNIT_VSX_P (V2DFmode)\"\n-  \"xvcvdpsxds %x0,%x1\"\n-  [(set_attr \"type\" \"vecdouble\")])\n-\n-;; convert vector of 32-bit floating point numbers to vector of\n-;; 32-bit signed integer\n-(define_insn \"vsx_xvcvspsxws\"\n-  [(set (match_operand:V4SI 0 \"vsx_register_operand\" \"=wa\")\n-\t(unspec:V4SI [(match_operand:V4SF 1 \"vsx_register_operand\" \"wa\")]\n-\t\t     UNSPEC_VSX_XVCVSPSXWS))]\n-  \"VECTOR_UNIT_VSX_P (V4SFmode)\"\n-  \"xvcvspsxws %x0,%x1\"\n-  [(set_attr \"type\" \"vecfloat\")])\n-\n ;; convert vector of 64-bit floating point numbers to vector of\n ;; 64-bit unsigned integer\n (define_expand \"vsx_xvcvdpuxds_scale\"\n@@ -2320,24 +2305,6 @@\n   DONE;\n })\n \n-;; convert vector of 32-bit floating point numbers to vector of\n-;; 32-bit unsigned integer\n-(define_insn \"vsx_xvcvspuxws\"\n-  [(set (match_operand:V4SI 0 \"vsx_register_operand\" \"=wa\")\n-\t(unspec:V4SI [(match_operand:V4SF 1 \"vsx_register_operand\" \"wa\")]\n-\t\t     UNSPEC_VSX_XVCVSPSXWS))]\n-  \"VECTOR_UNIT_VSX_P (V4SFmode)\"\n-  \"xvcvspuxws %x0,%x1\"\n-  [(set_attr \"type\" \"vecfloat\")])\n-\n-(define_insn \"vsx_xvcvdpuxds\"\n-  [(set (match_operand:V2DI 0 \"vsx_register_operand\" \"=wa\")\n-        (unspec:V2DI [(match_operand:V2DF 1 \"vsx_register_operand\" \"wa\")]\n-                     UNSPEC_VSX_XVCVDPUXDS))]\n-  \"VECTOR_UNIT_VSX_P (V2DFmode)\"\n-  \"xvcvdpuxds %x0,%x1\"\n-  [(set_attr \"type\" \"vecdouble\")])\n-\n ;; Convert from 64-bit to 32-bit types\n ;; Note, favor the Altivec registers since the usual use of these instructions\n ;; is in vector converts and we need to use the Altivec vperm instruction.\n@@ -2424,22 +2391,6 @@\n   \"xvcvspuxds %x0,%x1\"\n   [(set_attr \"type\" \"vecdouble\")])\n \n-(define_insn \"vsx_xvcvsxwsp\"\n-  [(set (match_operand:V4SF 0 \"vsx_register_operand\" \"=wa\")\n-\t(unspec:V4SF [(match_operand:V4SI 1 \"vsx_register_operand\" \"wa\")]\n-\t\t     UNSPEC_VSX_CVSXWSP))]\n-  \"VECTOR_UNIT_VSX_P (V4SFmode)\"\n-  \"xvcvsxwsp %x0,%x1\"\n-  [(set_attr \"type\" \"vecfloat\")])\n-\n-(define_insn \"vsx_xvcvuxwsp\"\n-  [(set (match_operand:V4SF 0 \"vsx_register_operand\" \"=wa\")\n-\t(unspec:V4SF[(match_operand:V4SI 1 \"vsx_register_operand\" \"wa\")]\n-\t\t    UNSPEC_VSX_CVUXWSP))]\n-  \"VECTOR_UNIT_VSX_P (V4SFmode)\"\n-  \"xvcvuxwsp %x0,%x1\"\n-  [(set_attr \"type\" \"vecfloat\")])\n-\n ;; Generate float2 double\n ;; convert two double to float\n (define_expand \"float2_v2df\""}]}