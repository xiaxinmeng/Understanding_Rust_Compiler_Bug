{"sha": "57762e976d599914956203d04f706744bec54ef1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTc3NjJlOTc2ZDU5OTkxNDk1NjIwM2QwNGY3MDY3NDRiZWM1NGVmMQ==", "commit": {"author": {"name": "Christian Borntraeger", "email": "borntraeger@de.ibm.com", "date": "2010-05-11T07:29:59Z"}, "committer": {"name": "Andreas Krebbel", "email": "krebbel@gcc.gnu.org", "date": "2010-05-11T07:29:59Z"}, "message": "tree-ssa-loop-prefetch.c (prune_ref_by_group_reuse): Reset prefetch_before to PREFETCH_ALL if to accesses \"meet\" beyond cache size.\n\n2010-05-11  Christian Borntraeger  <borntraeger@de.ibm.com>\n\n        * tree-ssa-loop-prefetch.c (prune_ref_by_group_reuse): Reset\n\tprefetch_before to PREFETCH_ALL if to accesses \"meet\" beyond\n\tcache size.\n\nFrom-SVN: r159257", "tree": {"sha": "f5d086e41dea69572170f50446b3a4c03d67579c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f5d086e41dea69572170f50446b3a4c03d67579c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/57762e976d599914956203d04f706744bec54ef1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/57762e976d599914956203d04f706744bec54ef1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/57762e976d599914956203d04f706744bec54ef1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/57762e976d599914956203d04f706744bec54ef1/comments", "author": {"login": "borntraeger", "id": 3006059, "node_id": "MDQ6VXNlcjMwMDYwNTk=", "avatar_url": "https://avatars.githubusercontent.com/u/3006059?v=4", "gravatar_id": "", "url": "https://api.github.com/users/borntraeger", "html_url": "https://github.com/borntraeger", "followers_url": "https://api.github.com/users/borntraeger/followers", "following_url": "https://api.github.com/users/borntraeger/following{/other_user}", "gists_url": "https://api.github.com/users/borntraeger/gists{/gist_id}", "starred_url": "https://api.github.com/users/borntraeger/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/borntraeger/subscriptions", "organizations_url": "https://api.github.com/users/borntraeger/orgs", "repos_url": "https://api.github.com/users/borntraeger/repos", "events_url": "https://api.github.com/users/borntraeger/events{/privacy}", "received_events_url": "https://api.github.com/users/borntraeger/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "a8beb3a7be09b268826e992fdddde3dc468c6939", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a8beb3a7be09b268826e992fdddde3dc468c6939", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a8beb3a7be09b268826e992fdddde3dc468c6939"}], "stats": {"total": 12, "additions": 12, "deletions": 0}, "files": [{"sha": "4ade883db3adaa13c3c0d87aba1da1326e0720a2", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/57762e976d599914956203d04f706744bec54ef1/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/57762e976d599914956203d04f706744bec54ef1/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=57762e976d599914956203d04f706744bec54ef1", "patch": "@@ -1,3 +1,9 @@\n+2010-05-11  Christian Borntraeger  <borntraeger@de.ibm.com>\n+\n+        * tree-ssa-loop-prefetch.c (prune_ref_by_group_reuse): Reset\n+\tprefetch_before to PREFETCH_ALL if to accesses \"meet\" beyond\n+\tcache size.\n+\n 2010-05-11  Christian Borntraeger  <borntraeger@de.ibm.com>\n \n         * tree-ssa-loop-prefetch.c: Add debug for dropped prefetches."}, {"sha": "daf9956d3bc3da9eb47f4d31988108c9dc6e675c", "filename": "gcc/tree-ssa-loop-prefetch.c", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/57762e976d599914956203d04f706744bec54ef1/gcc%2Ftree-ssa-loop-prefetch.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/57762e976d599914956203d04f706744bec54ef1/gcc%2Ftree-ssa-loop-prefetch.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-loop-prefetch.c?ref=57762e976d599914956203d04f706744bec54ef1", "patch": "@@ -716,6 +716,9 @@ prune_ref_by_group_reuse (struct mem_ref *ref, struct mem_ref *by,\n       hit_from = ddown (delta_b, PREFETCH_BLOCK) * PREFETCH_BLOCK;\n       prefetch_before = (hit_from - delta_r + step - 1) / step;\n \n+      /* Do not reduce prefetch_before if we meet beyond cache size.  */\n+      if (prefetch_before > abs (L2_CACHE_SIZE_BYTES / step))\n+        prefetch_before = PREFETCH_ALL;\n       if (prefetch_before < ref->prefetch_before)\n \tref->prefetch_before = prefetch_before;\n \n@@ -746,6 +749,9 @@ prune_ref_by_group_reuse (struct mem_ref *ref, struct mem_ref *by,\n \t\t\t\treduced_prefetch_block, align_unit);\n   if (miss_rate <= ACCEPTABLE_MISS_RATE)\n     {\n+      /* Do not reduce prefetch_before if we meet beyond cache size.  */\n+      if (prefetch_before > L2_CACHE_SIZE_BYTES / PREFETCH_BLOCK)\n+        prefetch_before = PREFETCH_ALL;\n       if (prefetch_before < ref->prefetch_before)\n \tref->prefetch_before = prefetch_before;\n "}]}