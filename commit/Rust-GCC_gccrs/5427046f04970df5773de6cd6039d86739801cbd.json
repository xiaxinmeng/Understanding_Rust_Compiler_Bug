{"sha": "5427046f04970df5773de6cd6039d86739801cbd", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTQyNzA0NmYwNDk3MGRmNTc3M2RlNmNkNjAzOWQ4NjczOTgwMWNiZA==", "commit": {"author": {"name": "Ian Lance Taylor", "email": "iant@google.com", "date": "2010-12-02T22:43:58Z"}, "committer": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2010-12-02T22:43:58Z"}, "message": "configure.ac: AC_DEFINE ENABLE_BUILD_WITH_CXX.\n\n\t* configure.ac: AC_DEFINE ENABLE_BUILD_WITH_CXX.  Check for C++\n\theader files unordered_map, tr1/unordered_map, and ext/hash_map.\n\t* configure, config.in: Rebuild.\n\nFrom-SVN: r167396", "tree": {"sha": "c0dc251b6b07d5936c90463e2dc4fc456f4cd759", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c0dc251b6b07d5936c90463e2dc4fc456f4cd759"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5427046f04970df5773de6cd6039d86739801cbd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5427046f04970df5773de6cd6039d86739801cbd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5427046f04970df5773de6cd6039d86739801cbd", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5427046f04970df5773de6cd6039d86739801cbd/comments", "author": null, "committer": null, "parents": [{"sha": "205e4c6a4b80b6307b55b74cb69fadf6ac38dcc9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/205e4c6a4b80b6307b55b74cb69fadf6ac38dcc9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/205e4c6a4b80b6307b55b74cb69fadf6ac38dcc9"}], "stats": {"total": 348, "additions": 307, "deletions": 41}, "files": [{"sha": "7bf179644d585d7f955421d927785d295f756de8", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5427046f04970df5773de6cd6039d86739801cbd/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5427046f04970df5773de6cd6039d86739801cbd/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=5427046f04970df5773de6cd6039d86739801cbd", "patch": "@@ -1,3 +1,9 @@\n+2010-12-02  Ian Lance Taylor  <iant@google.com>\n+\n+\t* configure.ac: AC_DEFINE ENABLE_BUILD_WITH_CXX.  Check for C++\n+\theader files unordered_map, tr1/unordered_map, and ext/hash_map.\n+\t* configure, config.in: Rebuild.\n+\n 2010-11-02  Eric Botcazou  <ebotcazou@adacore.com>\n \n \tPR target/46685"}, {"sha": "89cb46645323de5d12d6912fac512b0db694102c", "filename": "gcc/config.in", "status": "modified", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5427046f04970df5773de6cd6039d86739801cbd/gcc%2Fconfig.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5427046f04970df5773de6cd6039d86739801cbd/gcc%2Fconfig.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig.in?ref=5427046f04970df5773de6cd6039d86739801cbd", "patch": "@@ -45,6 +45,12 @@\n #endif\n \n \n+/* Define if building with C++. */\n+#ifndef USED_FOR_TARGET\n+#undef ENABLE_BUILD_WITH_CXX\n+#endif\n+\n+\n /* Define if you want more run-time sanity checks. This one gets a grab bag of\n    miscellaneous but relatively cheap checks. */\n #ifndef USED_FOR_TARGET\n@@ -832,6 +838,12 @@\n #endif\n \n \n+/* Define to 1 if you have the <ext/hash_map> header file. */\n+#ifndef USED_FOR_TARGET\n+#undef HAVE_EXT_HASH_MAP\n+#endif\n+\n+\n /* Define to 1 if you have the <fcntl.h> header file. */\n #ifndef USED_FOR_TARGET\n #undef HAVE_FCNTL_H\n@@ -1419,6 +1431,12 @@\n #endif\n \n \n+/* Define to 1 if you have the <tr1/unordered_map> header file. */\n+#ifndef USED_FOR_TARGET\n+#undef HAVE_TR1_UNORDERED_MAP\n+#endif\n+\n+\n /* Define to 1 if the system has the type `uintmax_t'. */\n #ifndef USED_FOR_TARGET\n #undef HAVE_UINTMAX_T\n@@ -1437,6 +1455,12 @@\n #endif\n \n \n+/* Define to 1 if you have the <unordered_map> header file. */\n+#ifndef USED_FOR_TARGET\n+#undef HAVE_UNORDERED_MAP\n+#endif\n+\n+\n /* Define to 1 if the system has the type `unsigned long long int'. */\n #ifndef USED_FOR_TARGET\n #undef HAVE_UNSIGNED_LONG_LONG_INT"}, {"sha": "5fb99502f4fb3c13a785bdc19dd7a16cbca679ad", "filename": "gcc/configure", "status": "modified", "additions": 261, "deletions": 41, "changes": 302, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5427046f04970df5773de6cd6039d86739801cbd/gcc%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5427046f04970df5773de6cd6039d86739801cbd/gcc%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfigure?ref=5427046f04970df5773de6cd6039d86739801cbd", "patch": "@@ -688,7 +688,6 @@ ORIGINAL_AS_FOR_TARGET\n gcc_cv_as\n enable_fast_install\n objdir\n-CXXCPP\n OTOOL64\n OTOOL\n LIPO\n@@ -734,6 +733,7 @@ LIBICONV\n LDEXP_LIB\n GNAT_LIBEXC\n COLLECT2_LIBS\n+CXXCPP\n AR\n NM\n BISON\n@@ -2462,6 +2462,72 @@ $as_echo \"$ac_res\" >&6; }\n \n } # ac_fn_c_check_header_preproc\n \n+# ac_fn_cxx_try_cpp LINENO\n+# ------------------------\n+# Try to preprocess conftest.$ac_ext, and return whether this succeeded.\n+ac_fn_cxx_try_cpp ()\n+{\n+  as_lineno=${as_lineno-\"$1\"} as_lineno_stack=as_lineno_stack=$as_lineno_stack\n+  if { { ac_try=\"$ac_cpp conftest.$ac_ext\"\n+case \"(($ac_try\" in\n+  *\\\"* | *\\`* | *\\\\*) ac_try_echo=\\$ac_try;;\n+  *) ac_try_echo=$ac_try;;\n+esac\n+eval ac_try_echo=\"\\\"\\$as_me:${as_lineno-$LINENO}: $ac_try_echo\\\"\"\n+$as_echo \"$ac_try_echo\"; } >&5\n+  (eval \"$ac_cpp conftest.$ac_ext\") 2>conftest.err\n+  ac_status=$?\n+  if test -s conftest.err; then\n+    grep -v '^ *+' conftest.err >conftest.er1\n+    cat conftest.er1 >&5\n+    mv -f conftest.er1 conftest.err\n+  fi\n+  $as_echo \"$as_me:${as_lineno-$LINENO}: \\$? = $ac_status\" >&5\n+  test $ac_status = 0; } >/dev/null && {\n+\t test -z \"$ac_cxx_preproc_warn_flag$ac_cxx_werror_flag\" ||\n+\t test ! -s conftest.err\n+       }; then :\n+  ac_retval=0\n+else\n+  $as_echo \"$as_me: failed program was:\" >&5\n+sed 's/^/| /' conftest.$ac_ext >&5\n+\n+    ac_retval=1\n+fi\n+  eval $as_lineno_stack; test \"x$as_lineno_stack\" = x && { as_lineno=; unset as_lineno;}\n+  return $ac_retval\n+\n+} # ac_fn_cxx_try_cpp\n+\n+# ac_fn_cxx_check_header_preproc LINENO HEADER VAR\n+# ------------------------------------------------\n+# Tests whether HEADER is present, setting the cache variable VAR accordingly.\n+ac_fn_cxx_check_header_preproc ()\n+{\n+  as_lineno=${as_lineno-\"$1\"} as_lineno_stack=as_lineno_stack=$as_lineno_stack\n+  { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for $2\" >&5\n+$as_echo_n \"checking for $2... \" >&6; }\n+if { as_var=$3; eval \"test \\\"\\${$as_var+set}\\\" = set\"; }; then :\n+  $as_echo_n \"(cached) \" >&6\n+else\n+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n+/* end confdefs.h.  */\n+#include <$2>\n+_ACEOF\n+if ac_fn_cxx_try_cpp \"$LINENO\"; then :\n+  eval \"$3=yes\"\n+else\n+  eval \"$3=no\"\n+fi\n+rm -f conftest.err conftest.$ac_ext\n+fi\n+eval ac_res=\\$$3\n+\t       { $as_echo \"$as_me:${as_lineno-$LINENO}: result: $ac_res\" >&5\n+$as_echo \"$ac_res\" >&6; }\n+  eval $as_lineno_stack; test \"x$as_lineno_stack\" = x && { as_lineno=; unset as_lineno;}\n+\n+} # ac_fn_cxx_check_header_preproc\n+\n # ac_fn_c_check_func LINENO FUNC VAR\n # ----------------------------------\n # Tests whether FUNC exists, setting the cache variable VAR accordingly\n@@ -2529,43 +2595,6 @@ $as_echo \"$ac_res\" >&6; }\n \n } # ac_fn_c_check_func\n \n-# ac_fn_cxx_try_cpp LINENO\n-# ------------------------\n-# Try to preprocess conftest.$ac_ext, and return whether this succeeded.\n-ac_fn_cxx_try_cpp ()\n-{\n-  as_lineno=${as_lineno-\"$1\"} as_lineno_stack=as_lineno_stack=$as_lineno_stack\n-  if { { ac_try=\"$ac_cpp conftest.$ac_ext\"\n-case \"(($ac_try\" in\n-  *\\\"* | *\\`* | *\\\\*) ac_try_echo=\\$ac_try;;\n-  *) ac_try_echo=$ac_try;;\n-esac\n-eval ac_try_echo=\"\\\"\\$as_me:${as_lineno-$LINENO}: $ac_try_echo\\\"\"\n-$as_echo \"$ac_try_echo\"; } >&5\n-  (eval \"$ac_cpp conftest.$ac_ext\") 2>conftest.err\n-  ac_status=$?\n-  if test -s conftest.err; then\n-    grep -v '^ *+' conftest.err >conftest.er1\n-    cat conftest.er1 >&5\n-    mv -f conftest.er1 conftest.err\n-  fi\n-  $as_echo \"$as_me:${as_lineno-$LINENO}: \\$? = $ac_status\" >&5\n-  test $ac_status = 0; } >/dev/null && {\n-\t test -z \"$ac_cxx_preproc_warn_flag$ac_cxx_werror_flag\" ||\n-\t test ! -s conftest.err\n-       }; then :\n-  ac_retval=0\n-else\n-  $as_echo \"$as_me: failed program was:\" >&5\n-sed 's/^/| /' conftest.$ac_ext >&5\n-\n-    ac_retval=1\n-fi\n-  eval $as_lineno_stack; test \"x$as_lineno_stack\" = x && { as_lineno=; unset as_lineno;}\n-  return $ac_retval\n-\n-} # ac_fn_cxx_try_cpp\n-\n # ac_fn_cxx_try_link LINENO\n # -------------------------\n # Try to link conftest.$ac_ext, and return whether this succeeded.\n@@ -6815,6 +6844,11 @@ else\n fi\n \n \n+if test \"$ENABLE_BUILD_WITH_CXX\" = \"yes\"; then\n+\n+$as_echo \"#define ENABLE_BUILD_WITH_CXX 1\" >>confdefs.h\n+\n+fi\n \n # With stabs\n \n@@ -8390,6 +8424,193 @@ $as_echo \"#define AC_APPLE_UNIVERSAL_BUILD 1\" >>confdefs.h\n  esac\n \n \n+# ----------------------\n+# Checks for C++ headers\n+# ----------------------\n+\n+ac_ext=cpp\n+ac_cpp='$CXXCPP $CPPFLAGS'\n+ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'\n+ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'\n+ac_compiler_gnu=$ac_cv_cxx_compiler_gnu\n+\n+\n+\n+ac_ext=cpp\n+ac_cpp='$CXXCPP $CPPFLAGS'\n+ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'\n+ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'\n+ac_compiler_gnu=$ac_cv_cxx_compiler_gnu\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: checking how to run the C++ preprocessor\" >&5\n+$as_echo_n \"checking how to run the C++ preprocessor... \" >&6; }\n+if test -z \"$CXXCPP\"; then\n+  if test \"${ac_cv_prog_CXXCPP+set}\" = set; then :\n+  $as_echo_n \"(cached) \" >&6\n+else\n+      # Double quotes because CXXCPP needs to be expanded\n+    for CXXCPP in \"$CXX -E\" \"/lib/cpp\"\n+    do\n+      ac_preproc_ok=false\n+for ac_cxx_preproc_warn_flag in '' yes\n+do\n+  # Use a header file that comes with gcc, so configuring glibc\n+  # with a fresh cross-compiler works.\n+  # Prefer <limits.h> to <assert.h> if __STDC__ is defined, since\n+  # <limits.h> exists even on freestanding compilers.\n+  # On the NeXT, cc -E runs the code through the compiler's parser,\n+  # not just through cpp. \"Syntax error\" is here to catch this case.\n+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n+/* end confdefs.h.  */\n+#ifdef __STDC__\n+# include <limits.h>\n+#else\n+# include <assert.h>\n+#endif\n+\t\t     Syntax error\n+_ACEOF\n+if ac_fn_cxx_try_cpp \"$LINENO\"; then :\n+\n+else\n+  # Broken: fails on valid input.\n+continue\n+fi\n+rm -f conftest.err conftest.$ac_ext\n+\n+  # OK, works on sane cases.  Now check whether nonexistent headers\n+  # can be detected and how.\n+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n+/* end confdefs.h.  */\n+#include <ac_nonexistent.h>\n+_ACEOF\n+if ac_fn_cxx_try_cpp \"$LINENO\"; then :\n+  # Broken: success on invalid input.\n+continue\n+else\n+  # Passes both tests.\n+ac_preproc_ok=:\n+break\n+fi\n+rm -f conftest.err conftest.$ac_ext\n+\n+done\n+# Because of `break', _AC_PREPROC_IFELSE's cleaning code was skipped.\n+rm -f conftest.err conftest.$ac_ext\n+if $ac_preproc_ok; then :\n+  break\n+fi\n+\n+    done\n+    ac_cv_prog_CXXCPP=$CXXCPP\n+\n+fi\n+  CXXCPP=$ac_cv_prog_CXXCPP\n+else\n+  ac_cv_prog_CXXCPP=$CXXCPP\n+fi\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $CXXCPP\" >&5\n+$as_echo \"$CXXCPP\" >&6; }\n+ac_preproc_ok=false\n+for ac_cxx_preproc_warn_flag in '' yes\n+do\n+  # Use a header file that comes with gcc, so configuring glibc\n+  # with a fresh cross-compiler works.\n+  # Prefer <limits.h> to <assert.h> if __STDC__ is defined, since\n+  # <limits.h> exists even on freestanding compilers.\n+  # On the NeXT, cc -E runs the code through the compiler's parser,\n+  # not just through cpp. \"Syntax error\" is here to catch this case.\n+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n+/* end confdefs.h.  */\n+#ifdef __STDC__\n+# include <limits.h>\n+#else\n+# include <assert.h>\n+#endif\n+\t\t     Syntax error\n+_ACEOF\n+if ac_fn_cxx_try_cpp \"$LINENO\"; then :\n+\n+else\n+  # Broken: fails on valid input.\n+continue\n+fi\n+rm -f conftest.err conftest.$ac_ext\n+\n+  # OK, works on sane cases.  Now check whether nonexistent headers\n+  # can be detected and how.\n+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n+/* end confdefs.h.  */\n+#include <ac_nonexistent.h>\n+_ACEOF\n+if ac_fn_cxx_try_cpp \"$LINENO\"; then :\n+  # Broken: success on invalid input.\n+continue\n+else\n+  # Passes both tests.\n+ac_preproc_ok=:\n+break\n+fi\n+rm -f conftest.err conftest.$ac_ext\n+\n+done\n+# Because of `break', _AC_PREPROC_IFELSE's cleaning code was skipped.\n+rm -f conftest.err conftest.$ac_ext\n+if $ac_preproc_ok; then :\n+\n+else\n+  { { $as_echo \"$as_me:${as_lineno-$LINENO}: error: in \\`$ac_pwd':\" >&5\n+$as_echo \"$as_me: error: in \\`$ac_pwd':\" >&2;}\n+as_fn_error \"C++ preprocessor \\\"$CXXCPP\\\" fails sanity check\n+See \\`config.log' for more details.\" \"$LINENO\" 5; }\n+fi\n+\n+ac_ext=cpp\n+ac_cpp='$CXXCPP $CPPFLAGS'\n+ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'\n+ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'\n+ac_compiler_gnu=$ac_cv_cxx_compiler_gnu\n+\n+\n+for ac_header in unordered_map\n+do :\n+  ac_fn_cxx_check_header_preproc \"$LINENO\" \"unordered_map\" \"ac_cv_header_unordered_map\"\n+if test \"x$ac_cv_header_unordered_map\" = x\"\"yes; then :\n+  cat >>confdefs.h <<_ACEOF\n+#define HAVE_UNORDERED_MAP 1\n+_ACEOF\n+\n+fi\n+done\n+\n+for ac_header in tr1/unordered_map\n+do :\n+  ac_fn_cxx_check_header_preproc \"$LINENO\" \"tr1/unordered_map\" \"ac_cv_header_tr1_unordered_map\"\n+if test \"x$ac_cv_header_tr1_unordered_map\" = x\"\"yes; then :\n+  cat >>confdefs.h <<_ACEOF\n+#define HAVE_TR1_UNORDERED_MAP 1\n+_ACEOF\n+\n+fi\n+done\n+\n+for ac_header in ext/hash_map\n+do :\n+  ac_fn_cxx_check_header_preproc \"$LINENO\" \"ext/hash_map\" \"ac_cv_header_ext_hash_map\"\n+if test \"x$ac_cv_header_ext_hash_map\" = x\"\"yes; then :\n+  cat >>confdefs.h <<_ACEOF\n+#define HAVE_EXT_HASH_MAP 1\n+_ACEOF\n+\n+fi\n+done\n+\n+\n+ac_ext=c\n+ac_cpp='$CPP $CPPFLAGS'\n+ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'\n+ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'\n+ac_compiler_gnu=$ac_cv_c_compiler_gnu\n+\n+\n # --------\n # UNSORTED\n # --------\n@@ -13804,7 +14025,6 @@ done\n \n \n \n-\n # Set options\n \n \n@@ -17286,7 +17506,7 @@ else\n   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2\n   lt_status=$lt_dlunknown\n   cat > conftest.$ac_ext <<_LT_EOF\n-#line 17289 \"configure\"\n+#line 17509 \"configure\"\n #include \"confdefs.h\"\n \n #if HAVE_DLFCN_H\n@@ -17392,7 +17612,7 @@ else\n   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2\n   lt_status=$lt_dlunknown\n   cat > conftest.$ac_ext <<_LT_EOF\n-#line 17395 \"configure\"\n+#line 17615 \"configure\"\n #include \"confdefs.h\"\n \n #if HAVE_DLFCN_H"}, {"sha": "98de035f4ac96dc411e736054e7322e40ac91ead", "filename": "gcc/configure.ac", "status": "modified", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5427046f04970df5773de6cd6039d86739801cbd/gcc%2Fconfigure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5427046f04970df5773de6cd6039d86739801cbd/gcc%2Fconfigure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfigure.ac?ref=5427046f04970df5773de6cd6039d86739801cbd", "patch": "@@ -589,6 +589,10 @@ AC_ARG_ENABLE(build-with-cxx,\n ENABLE_BUILD_WITH_CXX=$enableval,\n ENABLE_BUILD_WITH_CXX=no)\n AC_SUBST(ENABLE_BUILD_WITH_CXX)\n+if test \"$ENABLE_BUILD_WITH_CXX\" = \"yes\"; then\n+  AC_DEFINE(ENABLE_BUILD_WITH_CXX, 1,\n+\t    [Define if building with C++.])\n+fi\n \n # With stabs\n AC_ARG_WITH(stabs,\n@@ -905,6 +909,18 @@ AC_CHECK_HEADER(pthread.h, [have_pthread_h=yes], [have_pthread_h=])\n gcc_AC_C_CHAR_BIT\n AC_C_BIGENDIAN\n \n+# ----------------------\n+# Checks for C++ headers\n+# ----------------------\n+\n+AC_LANG_PUSH(C++)\n+\n+AC_CHECK_HEADERS(unordered_map)\n+AC_CHECK_HEADERS(tr1/unordered_map)\n+AC_CHECK_HEADERS(ext/hash_map)\n+\n+AC_LANG_POP(C++)\n+\n # --------\n # UNSORTED\n # --------"}]}