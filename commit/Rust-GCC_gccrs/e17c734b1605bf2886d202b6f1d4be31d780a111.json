{"sha": "e17c734b1605bf2886d202b6f1d4be31d780a111", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTE3YzczNGIxNjA1YmYyODg2ZDIwMmI2ZjFkNGJlMzFkNzgwYTExMQ==", "commit": {"author": {"name": "James E Wilson", "email": "wilson@specifixinc.com", "date": "2004-08-17T21:46:40Z"}, "committer": {"name": "Jim Wilson", "email": "wilson@gcc.gnu.org", "date": "2004-08-17T21:46:40Z"}, "message": "Canonicalize mips nmadd/nmsub patterns.\n\n* config/mips/mips.md: Add canonical nmadd and nmsub patterns for both\nnormal and -ffast-math code.\n\nFrom-SVN: r86148", "tree": {"sha": "2933e475ac466941b45611757f28254b3fa3c328", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2933e475ac466941b45611757f28254b3fa3c328"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e17c734b1605bf2886d202b6f1d4be31d780a111", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e17c734b1605bf2886d202b6f1d4be31d780a111", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e17c734b1605bf2886d202b6f1d4be31d780a111", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e17c734b1605bf2886d202b6f1d4be31d780a111/comments", "author": null, "committer": null, "parents": [{"sha": "743a0a34cafa5fe742274f8b36afc3ca948a10f0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/743a0a34cafa5fe742274f8b36afc3ca948a10f0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/743a0a34cafa5fe742274f8b36afc3ca948a10f0"}], "stats": {"total": 61, "additions": 56, "deletions": 5}, "files": [{"sha": "2ed0288fb3f6e86f1346f2f20478818d0eafa868", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e17c734b1605bf2886d202b6f1d4be31d780a111/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e17c734b1605bf2886d202b6f1d4be31d780a111/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=e17c734b1605bf2886d202b6f1d4be31d780a111", "patch": "@@ -4,7 +4,10 @@\n \tof VOIDmode for comparison code mode.\n \t* config/mips/mips.md: For conditional move patterns, use mode of\n \tfirst compare operand for comparison mode, instead of VOIDmode.\n-\t\n+\n+\t* config/mips/mips.md: Add canonical nmadd and nmsub patterns for both\n+\tnormal and -ffast-math code.\n+\n 2004-08-17  Mark Mitchell  <mark@codesourcery.com>\n \n \tPR c++/15871"}, {"sha": "8a6440e41c3d81ddcbd090692f37e74d8f826820", "filename": "gcc/config/mips/mips.md", "status": "modified", "additions": 52, "deletions": 4, "changes": 56, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e17c734b1605bf2886d202b6f1d4be31d780a111/gcc%2Fconfig%2Fmips%2Fmips.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e17c734b1605bf2886d202b6f1d4be31d780a111/gcc%2Fconfig%2Fmips%2Fmips.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.md?ref=e17c734b1605bf2886d202b6f1d4be31d780a111", "patch": "@@ -1904,7 +1904,19 @@\n \t(neg:DF (plus:DF (mult:DF (match_operand:DF 1 \"register_operand\" \"f\")\n \t\t\t\t  (match_operand:DF 2 \"register_operand\" \"f\"))\n \t\t\t (match_operand:DF 3 \"register_operand\" \"f\"))))]\n-  \"ISA_HAS_NMADD_NMSUB && TARGET_HARD_FLOAT && TARGET_DOUBLE_FLOAT && TARGET_FUSED_MADD\"\n+  \"ISA_HAS_NMADD_NMSUB && TARGET_HARD_FLOAT && TARGET_DOUBLE_FLOAT\n+   && TARGET_FUSED_MADD && HONOR_SIGNED_ZEROS (DFmode)\"\n+  \"nmadd.d\\t%0,%3,%1,%2\"\n+  [(set_attr \"type\"\t\"fmadd\")\n+   (set_attr \"mode\"\t\"DF\")])\n+\n+(define_insn \"\"\n+  [(set (match_operand:DF 0 \"register_operand\" \"=f\")\n+\t(minus:DF (mult:DF (neg:DF (match_operand:DF 1 \"register_operand\" \"f\"))\n+\t\t\t\t   (match_operand:DF 2 \"register_operand\" \"f\"))\n+\t\t  (match_operand:DF 3 \"register_operand\" \"f\")))]\n+  \"ISA_HAS_NMADD_NMSUB && TARGET_HARD_FLOAT && TARGET_DOUBLE_FLOAT\n+   && TARGET_FUSED_MADD && !HONOR_SIGNED_ZEROS (DFmode)\"\n   \"nmadd.d\\t%0,%3,%1,%2\"\n   [(set_attr \"type\"\t\"fmadd\")\n    (set_attr \"mode\"\t\"DF\")])\n@@ -1914,27 +1926,63 @@\n \t(neg:SF (plus:SF (mult:SF (match_operand:SF 1 \"register_operand\" \"f\")\n \t\t\t\t  (match_operand:SF 2 \"register_operand\" \"f\"))\n \t\t\t (match_operand:SF 3 \"register_operand\" \"f\"))))]\n-  \"ISA_HAS_NMADD_NMSUB && TARGET_HARD_FLOAT && TARGET_FUSED_MADD\"\n+  \"ISA_HAS_NMADD_NMSUB && TARGET_HARD_FLOAT && TARGET_FUSED_MADD\n+   && HONOR_SIGNED_ZEROS (SFmode)\"\n   \"nmadd.s\\t%0,%3,%1,%2\"\n   [(set_attr \"type\"\t\"fmadd\")\n    (set_attr \"mode\"\t\"SF\")])\n \n+(define_insn \"\"\n+  [(set (match_operand:SF 0 \"register_operand\" \"=f\")\n+\t(minus:SF (mult:SF (neg:SF (match_operand:SF 1 \"register_operand\" \"f\"))\n+\t\t\t   (match_operand:SF 2 \"register_operand\" \"f\"))\n+\t\t  (match_operand:SF 3 \"register_operand\" \"f\")))]\n+  \"ISA_HAS_NMADD_NMSUB && TARGET_HARD_FLOAT && TARGET_FUSED_MADD\n+   && !HONOR_SIGNED_ZEROS (SFmode)\"\n+  \"nmadd.s\\t%0,%3,%1,%2\"\n+  [(set_attr \"type\"\t\"fmadd\")\n+   (set_attr \"mode\"\t\"SF\")])\n+\n+(define_insn \"\"\n+  [(set (match_operand:DF 0 \"register_operand\" \"=f\")\n+\t(neg:DF (minus:DF (mult:DF (match_operand:DF 2 \"register_operand\" \"f\")\n+\t\t\t\t   (match_operand:DF 3 \"register_operand\" \"f\"))\n+\t\t\t  (match_operand:DF 1 \"register_operand\" \"f\"))))]\n+  \"ISA_HAS_NMADD_NMSUB && TARGET_HARD_FLOAT && TARGET_DOUBLE_FLOAT\n+   && TARGET_FUSED_MADD && HONOR_SIGNED_ZEROS (DFmode)\"\n+  \"nmsub.d\\t%0,%1,%2,%3\"\n+  [(set_attr \"type\"\t\"fmadd\")\n+   (set_attr \"mode\"\t\"DF\")])\n+\n (define_insn \"\"\n   [(set (match_operand:DF 0 \"register_operand\" \"=f\")\n \t(minus:DF (match_operand:DF 1 \"register_operand\" \"f\")\n \t\t  (mult:DF (match_operand:DF 2 \"register_operand\" \"f\")\n \t\t\t   (match_operand:DF 3 \"register_operand\" \"f\"))))]\n-  \"ISA_HAS_NMADD_NMSUB && TARGET_HARD_FLOAT && TARGET_DOUBLE_FLOAT && TARGET_FUSED_MADD\"\n+  \"ISA_HAS_NMADD_NMSUB && TARGET_HARD_FLOAT && TARGET_DOUBLE_FLOAT\n+   && TARGET_FUSED_MADD && !HONOR_SIGNED_ZEROS (DFmode)\"\n   \"nmsub.d\\t%0,%1,%2,%3\"\n   [(set_attr \"type\"\t\"fmadd\")\n    (set_attr \"mode\"\t\"DF\")])\n \n+(define_insn \"\"\n+  [(set (match_operand:SF 0 \"register_operand\" \"=f\")\n+\t(neg:SF (minus:SF (mult:SF (match_operand:SF 2 \"register_operand\" \"f\")\n+\t\t\t\t   (match_operand:SF 3 \"register_operand\" \"f\"))\n+\t\t\t  (match_operand:SF 1 \"register_operand\" \"f\"))))]\n+  \"ISA_HAS_NMADD_NMSUB && TARGET_HARD_FLOAT && TARGET_FUSED_MADD\n+   && HONOR_SIGNED_ZEROS (SFmode)\"\n+  \"nmsub.s\\t%0,%1,%2,%3\"\n+  [(set_attr \"type\"\t\"fmadd\")\n+   (set_attr \"mode\"\t\"SF\")])\n+\n (define_insn \"\"\n   [(set (match_operand:SF 0 \"register_operand\" \"=f\")\n \t(minus:SF (match_operand:SF 1 \"register_operand\" \"f\")\n \t\t  (mult:SF (match_operand:SF 2 \"register_operand\" \"f\")\n \t\t\t   (match_operand:SF 3 \"register_operand\" \"f\"))))]\n-  \"ISA_HAS_NMADD_NMSUB && TARGET_HARD_FLOAT && TARGET_FUSED_MADD\"\n+  \"ISA_HAS_NMADD_NMSUB && TARGET_HARD_FLOAT && TARGET_FUSED_MADD\n+   && !HONOR_SIGNED_ZEROS (SFmode)\"\n   \"nmsub.s\\t%0,%1,%2,%3\"\n   [(set_attr \"type\"\t\"fmadd\")\n    (set_attr \"mode\"\t\"SF\")])"}]}