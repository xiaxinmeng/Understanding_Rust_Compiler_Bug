{"sha": "c2ee70f20de8133a88553270073226b0f3f55f62", "node_id": "C_kwDOANBUbNoAKGMyZWU3MGYyMGRlODEzM2E4ODU1MzI3MDA3MzIyNmIwZjNmNTVmNjI", "commit": {"author": {"name": "Patrick Palka", "email": "ppalka@redhat.com", "date": "2022-09-29T20:27:30Z"}, "committer": {"name": "Patrick Palka", "email": "ppalka@redhat.com", "date": "2022-09-29T20:27:30Z"}, "message": "c++: implicit lookup of std::initializer_list [PR102576]\n\nHere the lookup for the implicit use of std::initializer_list fails\nbecause we do it using get_namespace_binding, which isn't import aware.\nFix this by using lookup_qualified_name instead.\n\n\tPR c++/102576\n\ngcc/cp/ChangeLog:\n\n\t* pt.cc (listify): Use lookup_qualified_name instead of\n\tget_namespace_binding.\n\ngcc/testsuite/ChangeLog:\n\n\t* g++.dg/modules/pr102576_a.H: New test.\n\t* g++.dg/modules/pr102576_b.C: New test.", "tree": {"sha": "e1766651c58ad168f649c81630633e992277759e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e1766651c58ad168f649c81630633e992277759e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c2ee70f20de8133a88553270073226b0f3f55f62", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c2ee70f20de8133a88553270073226b0f3f55f62", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c2ee70f20de8133a88553270073226b0f3f55f62", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c2ee70f20de8133a88553270073226b0f3f55f62/comments", "author": null, "committer": null, "parents": [{"sha": "04d54b70fe2c3d69eb1d08f7212f01c8a972b701", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/04d54b70fe2c3d69eb1d08f7212f01c8a972b701", "html_url": "https://github.com/Rust-GCC/gccrs/commit/04d54b70fe2c3d69eb1d08f7212f01c8a972b701"}], "stats": {"total": 19, "additions": 17, "deletions": 2}, "files": [{"sha": "258f76d6e476f8b0420a3e54ceec93bcf324deca", "filename": "gcc/cp/pt.cc", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c2ee70f20de8133a88553270073226b0f3f55f62/gcc%2Fcp%2Fpt.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c2ee70f20de8133a88553270073226b0f3f55f62/gcc%2Fcp%2Fpt.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fpt.cc?ref=c2ee70f20de8133a88553270073226b0f3f55f62", "patch": "@@ -29161,9 +29161,10 @@ finish_concept_definition (cp_expr id, tree init)\n static tree\n listify (tree arg)\n {\n-  tree std_init_list = get_namespace_binding (std_node, init_list_identifier);\n+  tree std_init_list = lookup_qualified_name (std_node, init_list_identifier);\n \n-  if (!std_init_list || !DECL_CLASS_TEMPLATE_P (std_init_list))\n+  if (std_init_list == error_mark_node\n+      || !DECL_CLASS_TEMPLATE_P (std_init_list))\n     {\n       gcc_rich_location richloc (input_location);\n       maybe_add_include_fixit (&richloc, \"<initializer_list>\", false);"}, {"sha": "87ba9b52031295ec54e0834299631cda48950d85", "filename": "gcc/testsuite/g++.dg/modules/pr102576_a.H", "status": "added", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c2ee70f20de8133a88553270073226b0f3f55f62/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fmodules%2Fpr102576_a.H", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c2ee70f20de8133a88553270073226b0f3f55f62/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fmodules%2Fpr102576_a.H", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fmodules%2Fpr102576_a.H?ref=c2ee70f20de8133a88553270073226b0f3f55f62", "patch": "@@ -0,0 +1,5 @@\n+// PR c++/102576\n+// { dg-additional-options -fmodule-header }\n+// { dg-module-cmi {} }\n+\n+#include <initializer_list>"}, {"sha": "10251ed53044b56e8a0edf7239d4b623c2bd333c", "filename": "gcc/testsuite/g++.dg/modules/pr102576_b.C", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c2ee70f20de8133a88553270073226b0f3f55f62/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fmodules%2Fpr102576_b.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c2ee70f20de8133a88553270073226b0f3f55f62/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fmodules%2Fpr102576_b.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fmodules%2Fpr102576_b.C?ref=c2ee70f20de8133a88553270073226b0f3f55f62", "patch": "@@ -0,0 +1,9 @@\n+// PR c++/102576\n+// { dg-additional-options -fmodules-ts }\n+\n+import \"pr102576_a.H\";\n+\n+int main() {\n+  for (int i : {1, 2, 3})\n+    ;\n+}"}]}