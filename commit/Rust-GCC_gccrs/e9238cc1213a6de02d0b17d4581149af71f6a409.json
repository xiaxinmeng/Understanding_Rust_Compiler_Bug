{"sha": "e9238cc1213a6de02d0b17d4581149af71f6a409", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTkyMzhjYzEyMTNhNmRlMDJkMGIxN2Q0NTgxMTQ5YWY3MWY2YTQwOQ==", "commit": {"author": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2017-09-06T10:09:23Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2017-09-06T10:09:23Z"}, "message": "[multiple changes]\n\n2017-09-06  Yannick Moy  <moy@adacore.com>\n\n\t* sem_res.adb (Resolve): Update message for function call as statement.\n\n2017-09-06  Ed Schonberg  <schonberg@adacore.com>\n\n\t* sem_ch6.adb (Check_Returns): Clean up warnings coming from\n\tgenerated bodies for renamings that are completions, when renamed\n\tprocedure is No_Return.\n\t* sem_ch8.adb (Analyze_Subprogram_Renaming): Implement legality\n\trule in 6.5.1 (7/2): if a renaming is a completion of a subprogram\n\twith No_Return, the renamed entity must be No_Return as well.\n\nFrom-SVN: r251768", "tree": {"sha": "daefa240ed670f39384f5638eb7babab208bf0a4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/daefa240ed670f39384f5638eb7babab208bf0a4"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e9238cc1213a6de02d0b17d4581149af71f6a409", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e9238cc1213a6de02d0b17d4581149af71f6a409", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e9238cc1213a6de02d0b17d4581149af71f6a409", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e9238cc1213a6de02d0b17d4581149af71f6a409/comments", "author": null, "committer": null, "parents": [{"sha": "a4f4dbdb5aed55635b7977300ed7a860c5cd606a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a4f4dbdb5aed55635b7977300ed7a860c5cd606a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a4f4dbdb5aed55635b7977300ed7a860c5cd606a"}], "stats": {"total": 32, "additions": 30, "deletions": 2}, "files": [{"sha": "785a11a8a1fd525c131ea831ebaacec5c6bace4f", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e9238cc1213a6de02d0b17d4581149af71f6a409/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e9238cc1213a6de02d0b17d4581149af71f6a409/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=e9238cc1213a6de02d0b17d4581149af71f6a409", "patch": "@@ -1,3 +1,16 @@\n+2017-09-06  Yannick Moy  <moy@adacore.com>\n+\n+\t* sem_res.adb (Resolve): Update message for function call as statement.\n+\n+2017-09-06  Ed Schonberg  <schonberg@adacore.com>\n+\n+\t* sem_ch6.adb (Check_Returns): Clean up warnings coming from\n+\tgenerated bodies for renamings that are completions, when renamed\n+\tprocedure is No_Return.\n+\t* sem_ch8.adb (Analyze_Subprogram_Renaming): Implement legality\n+\trule in 6.5.1 (7/2): if a renaming is a completion of a subprogram\n+\twith No_Return, the renamed entity must be No_Return as well.\n+\n 2017-09-06  Hristian Kirtchev  <kirtchev@adacore.com>\n \n \t* exp_ch5.adb, freeze.adb, exp_ch4.adb, exp_ch6.adb, lib-xref.adb:"}, {"sha": "64d87b271549db5c756bc8f0c054f47c4b29295b", "filename": "gcc/ada/sem_ch6.adb", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e9238cc1213a6de02d0b17d4581149af71f6a409/gcc%2Fada%2Fsem_ch6.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e9238cc1213a6de02d0b17d4581149af71f6a409/gcc%2Fada%2Fsem_ch6.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch6.adb?ref=e9238cc1213a6de02d0b17d4581149af71f6a409", "patch": "@@ -6693,7 +6693,11 @@ package body Sem_Ch6 is\n                   Error_Msg_N\n                     (\"implied return after this statement \"\n                      & \"would have raised Program_Error\", Last_Stm);\n-               else\n+\n+               --  In normal compilation mode, do not warn on a generated\n+               --  call (e.g. in the body of a renaming as completion).\n+\n+               elsif Comes_From_Source (Last_Stm) then\n                   Error_Msg_N\n                     (\"implied return after this statement \"\n                      & \"will raise Program_Error??\", Last_Stm);"}, {"sha": "82f82d7c4ed7b48dfd0b07efc032d70987e067e4", "filename": "gcc/ada/sem_ch8.adb", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e9238cc1213a6de02d0b17d4581149af71f6a409/gcc%2Fada%2Fsem_ch8.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e9238cc1213a6de02d0b17d4581149af71f6a409/gcc%2Fada%2Fsem_ch8.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch8.adb?ref=e9238cc1213a6de02d0b17d4581149af71f6a409", "patch": "@@ -2946,6 +2946,14 @@ package body Sem_Ch8 is\n          Check_Fully_Conformant (New_S, Rename_Spec);\n          Set_Public_Status (New_S);\n \n+         if No_Return (Rename_Spec)\n+            and then not No_Return (Entity (Nam))\n+         then\n+            Error_Msg_N (\"renaming completes a No_Return procedure\", N);\n+            Error_Msg_N\n+              (\"\\renamed procedure must be nonreturning (RM 6.5.1 (7/2))\", N);\n+         end if;\n+\n          --  The specification does not introduce new formals, but only\n          --  repeats the formals of the original subprogram declaration.\n          --  For cross-reference purposes, and for refactoring tools, we"}, {"sha": "6c0d1a7a0935507d96501b1e9850d9439ab43edf", "filename": "gcc/ada/sem_res.adb", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e9238cc1213a6de02d0b17d4581149af71f6a409/gcc%2Fada%2Fsem_res.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e9238cc1213a6de02d0b17d4581149af71f6a409/gcc%2Fada%2Fsem_res.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_res.adb?ref=e9238cc1213a6de02d0b17d4581149af71f6a409", "patch": "@@ -2533,8 +2533,11 @@ package body Sem_Res is\n                  and then Ekind (Entity (Name (N))) = E_Function\n                then\n                   Error_Msg_NE\n-                    (\"cannot use function & in a procedure call\",\n+                    (\"cannot use call to function & as a statement\",\n                      Name (N), Entity (Name (N)));\n+                  Error_Msg_N\n+                    (\"\\return value of a function call cannot be ignored\",\n+                     Name (N));\n \n                --  Otherwise give general message (not clear what cases this\n                --  covers, but no harm in providing for them)."}]}