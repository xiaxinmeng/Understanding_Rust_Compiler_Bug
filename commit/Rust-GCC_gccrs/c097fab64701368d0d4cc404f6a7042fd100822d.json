{"sha": "c097fab64701368d0d4cc404f6a7042fd100822d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzA5N2ZhYjY0NzAxMzY4ZDBkNGNjNDA0ZjZhNzA0MmZkMTAwODIyZA==", "commit": {"author": {"name": "Kaveh R. Ghazi", "email": "ghazi@caip.rutgers.edu", "date": "2000-12-14T20:09:41Z"}, "committer": {"name": "Kaveh Ghazi", "email": "ghazi@gcc.gnu.org", "date": "2000-12-14T20:09:41Z"}, "message": "warn_summary: Fix subdirectory filtering.\n\n\t* warn_summary: Fix subdirectory filtering.  Add -intl and -fixinc\n\tsubdirectory flags.  Add source directory prefix filtering.\n\tRedirect diagnostic output to stderr.\n\nFrom-SVN: r38260", "tree": {"sha": "6bb7340e0e02d5561041b7a075bfb7355bf66d4f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6bb7340e0e02d5561041b7a075bfb7355bf66d4f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c097fab64701368d0d4cc404f6a7042fd100822d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c097fab64701368d0d4cc404f6a7042fd100822d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c097fab64701368d0d4cc404f6a7042fd100822d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c097fab64701368d0d4cc404f6a7042fd100822d/comments", "author": null, "committer": null, "parents": [{"sha": "e7103ad2984a90b0de89862273881488186dc227", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e7103ad2984a90b0de89862273881488186dc227", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e7103ad2984a90b0de89862273881488186dc227"}], "stats": {"total": 63, "additions": 43, "deletions": 20}, "files": [{"sha": "3aa918c828cb14a0f12e101e2d45ff4a4c6b7ef9", "filename": "contrib/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c097fab64701368d0d4cc404f6a7042fd100822d/contrib%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c097fab64701368d0d4cc404f6a7042fd100822d/contrib%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2FChangeLog?ref=c097fab64701368d0d4cc404f6a7042fd100822d", "patch": "@@ -1,3 +1,9 @@\n+2000-12-14  Kaveh R. Ghazi  <ghazi@caip.rutgers.edu>\n+\n+\t* warn_summary: Fix subdirectory filtering.  Add -intl and -fixinc\n+\tsubdirectory flags.  Add source directory prefix filtering.\n+\tRedirect diagnostic output to stderr.\n+\n 2000-12-07  Zack Weinberg  <zack@wolery.stanford.edu>\n \n \t* texi2pod.pl: If multiple @c man sections with the same tag"}, {"sha": "510c99ed8d8dd010c9d44153f37e9eb49ec5b4d6", "filename": "contrib/warn_summary", "status": "modified", "additions": 37, "deletions": 20, "changes": 57, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c097fab64701368d0d4cc404f6a7042fd100822d/contrib%2Fwarn_summary", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c097fab64701368d0d4cc404f6a7042fd100822d/contrib%2Fwarn_summary", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2Fwarn_summary?ref=c097fab64701368d0d4cc404f6a7042fd100822d", "patch": "@@ -3,7 +3,7 @@\n # This script parses the output of a gcc bootstrap when using warning\n # flags and determines various statistics.\n # \n-# usage: warn_summary [-llf] [-s stage] [-nosub|-ch|-cp|-f|-java]\n+# usage: warn_summary [-llf] [-s stage] [-nosub|-ch|-cp|-f|-java|-intl|-fixinc]\n # \t[-pass|-wpass] [file(s)]\n #\n # -llf\n@@ -19,10 +19,9 @@\n #\n # -nosub\n # Only show warnings from the gcc top level directory.\n-# -ch|-cp|-f|-java\n+# -ch|-cp|-f|-java|-intl|-fixinc\n # Only show warnings from the specified language subdirectory.\n-# These flags assume the output contains \"Entering/Leaving\" messages from\n-# gnu make.  They override each other so only the last one takes effect.\n+# These override each other so only the last one passed takes effect.\n #\n # -pass\n # Pass through the bootstrap output after filtering stage and subdir\n@@ -40,9 +39,9 @@\n longLineFilter()\n {\n   if test -z \"$llf\" ; then\n-    cat $1\n+    cat\n   else\n-    sed 's/^\\(...............................................................................................................................................................................................................................................................\\).*/\\1/' $1\n+    sed 's/^\\(...............................................................................................................................................................................................................................................................\\).*/\\1/'\n   fi\n }\n \n@@ -51,17 +50,17 @@ longLineFilter()\n # through a particular subdirectory set of warnings.\n subdirectoryFilter()\n {\n-  longLineFilter $1 | (\n+  longLineFilter | (\n   if test -z \"$filter\" ; then\n     # Pass through all lines.\n     cat\n   else\n     if test \"$filter\" = nosub ; then\n       # Omit all subdirectories.\n-      $AWK 'BEGIN{t=1} ; /Entering directory.*\\/gcc\\/[a-z]/{t--} ; /Leaving directory.*\\/gcc\\/[a-z]/{t++} ; {if(t==1)print}'\n+      egrep -v '/gcc/(ch|cp|f|java|intl|fixinc)/'\n     else\n       # Pass through only subdir $filter.\n-      $AWK \"BEGIN {t=-1} ; /^cd $filter; make/{t=0} ; /Entering directory .*\\/gcc\\/$filter/{t++} ; /Leaving directory .*\\/gcc\\/$filter/{t--} ; {if(t==1)print}\"\n+      grep \"/gcc/$filter/\"\n     fi\n   fi )\n }\n@@ -87,7 +86,7 @@ stageNfilter()\n # This function displays lines containing warnings.\n warningFilter()\n {\n-  grep ' warning: ' $1\n+  grep ' warning: '\n }\n \n # This function replaces `xxx' with `???', where xxx is usually some\n@@ -114,10 +113,26 @@ keywordFilter() {\n \ts/\"\\([^\"]*\\)\"/`\\1'\"'\"'/g'\n }\n \n+# This function strips out relative pathnames for source files printed\n+# by the warningFilter function.  This is done so that as the snapshot\n+# directory name changes every week, the output of this program can be\n+# compared to previous runs without spurious diffs caused by source\n+# directory name changes.\n+\n+srcdirFilter()\n+{\n+  sed '\n+s%^[^ ]*/\\(gcc/\\)%\\1%;\n+s%^[^ ]*/\\(include/\\)%\\1%;\n+s%^[^ ]*/\\(texinfo/\\)%\\1%;\n+s%^[^ ]*/\\(fastjar/\\)%\\1%;\n+s%^[^ ]*/\\(zlib/\\)%\\1%;\n+s%^[^ ]*/\\(lib[a-z23+-]*/\\)%\\1%;'\n+}\n \n # Start the main section.\n \n-usage=\"usage: `basename $0` [-llf] [-s stage] [-nosub|-ch|-cp|-f|-java] [-pass|-wpass] [file(s)]\"\n+usage=\"usage: `basename $0` [-llf] [-s stage] [-nosub|-ch|-cp|-f|-java|-intl|-fixinc] [-pass|-wpass] [file(s)]\"\n stageN=3\n tmpfile=/tmp/tmp-warn.$$\n \n@@ -140,30 +155,31 @@ fi\n while test -n \"$1\" ; do\n  case \"$1\" in\n    -llf) llf=1 ; shift ;;\n-   -s)  if test -z \"$2\"; then echo $usage; exit 1; fi; stageN=\"$2\"; shift 2 ;;\n+   -s)  if test -z \"$2\"; then echo $usage 1>&2; exit 1; fi\n+\tstageN=\"$2\"; shift 2 ;;\n    -s*) stageN=\"`expr $1 : '-s\\(.*\\)'`\" ; shift ;;\n-   -nosub|-ch|-cp|-f|-java) filter=\"`expr $1 : '-\\(.*\\)'`\" ; shift ;;\n+   -nosub|-ch|-cp|-f|-java|-intl|-fixinc) filter=\"`expr $1 : '-\\(.*\\)'`\" ; shift ;;\n    -pass) pass=1 ; shift ;;\n    -wpass) pass=w ; shift ;;\n-   -*)  echo $usage ; exit 1 ;;\n+   -*)  echo $usage 1>&2 ; exit 1 ;;\n    *)   break ;;\n  esac\n done\n \n # Check for a valid value of $stageN.\n case \"$stageN\" in\n   [0-9]) ;;\n-  *) echo \"Stage <$stageN> must be in the range [0..9].\" ; exit 1 ;;\n+  *) echo \"Stage <$stageN> must be in the range [0..9].\" 1>&2 ; exit 1 ;;\n esac\n \n for file in \"$@\" ; do\n \n-  subdirectoryFilter $file | stageNfilter > $tmpfile\n+  stageNfilter < $file | subdirectoryFilter > $tmpfile\n \n   # (Just) show me the warnings.\n   if test \"$pass\" != '' ; then\n     if test \"$pass\" = w ; then\n-      warningFilter $tmpfile\n+      warningFilter < $tmpfile\n     else\n       cat $tmpfile\n     fi\n@@ -179,15 +195,16 @@ for file in \"$@\" ; do\n       echo \"Counting warnings in the gcc/$filter subdirectory,\"\n     fi\n   fi\n-  count=`warningFilter $tmpfile | wc -l`\n+  count=`warningFilter < $tmpfile | wc -l`\n   echo there are $count warnings in stage$stageN of this bootstrap.\n \n   echo\n   echo Number of warnings per file:\n-  warningFilter $tmpfile | $AWK -F: '{print$1}' | sort | uniq -c | sort -nr\n+  warningFilter < $tmpfile | srcdirFilter | $AWK -F: '{print$1}' | sort | \\\n+    uniq -c | sort -nr\n \n   echo\n   echo Number of warning types:\n-  warningFilter $tmpfile | keywordFilter | sort | uniq -c | sort -nr\n+  warningFilter < $tmpfile | keywordFilter | sort | uniq -c | sort -nr\n \n done"}]}