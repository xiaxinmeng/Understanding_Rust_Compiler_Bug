{"sha": "e430f7389f1f2b06537d4d619c337810676296cb", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTQzMGY3Mzg5ZjFmMmIwNjUzN2Q0ZDYxOWMzMzc4MTA2NzYyOTZjYg==", "commit": {"author": {"name": "J\"orn Rennecke", "email": "amylaar@cygnus.co.uk", "date": "1998-10-02T08:22:31Z"}, "committer": {"name": "Joern Rennecke", "email": "amylaar@gcc.gnu.org", "date": "1998-10-02T08:22:31Z"}, "message": "t-sh (LIB1ASMFUNCS): Add _set_fpscr .\n\n\t* t-sh (LIB1ASMFUNCS): Add _set_fpscr .\n\t* config/sh/lib1funcs.asm (___set_fpscr): Add.\n\nFrom-SVN: r22746", "tree": {"sha": "6ea0e75fb26b0aa87754eb1e618d49d49970029c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6ea0e75fb26b0aa87754eb1e618d49d49970029c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e430f7389f1f2b06537d4d619c337810676296cb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e430f7389f1f2b06537d4d619c337810676296cb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e430f7389f1f2b06537d4d619c337810676296cb", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e430f7389f1f2b06537d4d619c337810676296cb/comments", "author": null, "committer": null, "parents": [{"sha": "ca672a5534a13f73b4b69974954e9ad12d6f2a37", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ca672a5534a13f73b4b69974954e9ad12d6f2a37", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ca672a5534a13f73b4b69974954e9ad12d6f2a37"}], "stats": {"total": 484, "additions": 264, "deletions": 220}, "files": [{"sha": "2429346f42f7356067efcd4f2067a42f492679e2", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e430f7389f1f2b06537d4d619c337810676296cb/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e430f7389f1f2b06537d4d619c337810676296cb/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=e430f7389f1f2b06537d4d619c337810676296cb", "patch": "@@ -1,3 +1,8 @@\n+Fri Oct  2 16:13:12 1998  J\"orn Rennecke <amylaar@cygnus.co.uk>\n+\n+\t* t-sh (LIB1ASMFUNCS): Add _set_fpscr .\n+\t* config/sh/lib1funcs.asm (___set_fpscr): Add.\n+\n Fri Oct  2 02:01:59 1998  Jeffrey A Law  (law@cygnus.com)\n \n \t* regclass.c (reg_scan_mark_refs): Return immediately if passed a"}, {"sha": "5084e9830ef700c50654b79889940f8652c6c338", "filename": "gcc/config/sh/lib1funcs.asm", "status": "modified", "additions": 258, "deletions": 219, "changes": 477, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e430f7389f1f2b06537d4d619c337810676296cb/gcc%2Fconfig%2Fsh%2Flib1funcs.asm", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e430f7389f1f2b06537d4d619c337810676296cb/gcc%2Fconfig%2Fsh%2Flib1funcs.asm", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fsh%2Flib1funcs.asm?ref=e430f7389f1f2b06537d4d619c337810676296cb", "patch": "@@ -1,4 +1,4 @@\n-/* Copyright (C) 1994, 1995 Free Software Foundation, Inc.\n+/* Copyright (C) 1994, 1995, 1997 Free Software Foundation, Inc.\n \n This file is free software; you can redistribute it and/or modify it\n under the terms of the GNU General Public License as published by the\n@@ -39,6 +39,16 @@ Boston, MA 02111-1307, USA.  */\n !! recoded in assembly by Toshiyasu Morita\n !! tm@netcom.com\n \n+/* SH2 optimizations for ___ashrsi3, ___ashlsi3, ___lshrsi3 and\n+   ELF local label prefixes by J\"orn Rennecke\n+   amylaar@cygnus.com  */\n+\n+#ifdef __ELF__\n+#define LOCAL(X) .L_##X\n+#else\n+#define LOCAL(X) L_##X\n+#endif\n+\n #ifdef L_ashiftrt\n \t.global\t___ashiftrt_r4_0\n \t.global\t___ashiftrt_r4_1\n@@ -178,123 +188,127 @@ ___ashiftrt_r4_0:\n \t.align\t2\n ___ashrsi3:\n \tmov\t#31,r0\n-\tcmp/hi\tr0,r5\n-\tbt\tL_ashrsi3_31\n-\tmova\tL_ashrsi3_table,r0\n+\tand\tr0,r5\n+\tmova\tLOCAL(ashrsi3_table),r0\n \tmov.b\t@(r0,r5),r5\n-\tadd\tr5,r0\t\t! Change to braf when gas is fixed\n+#ifdef __sh1__\n+\tadd\tr5,r0\n \tjmp\t@r0\n+#else\n+\tbraf\tr5\n+#endif\n \tmov\tr4,r0\n \n-L_ashrsi3_table:\n-\t.byte\t\tL_ashrsi3_0-L_ashrsi3_table\n-\t.byte\t\tL_ashrsi3_1-L_ashrsi3_table\n-\t.byte\t\tL_ashrsi3_2-L_ashrsi3_table\n-\t.byte\t\tL_ashrsi3_3-L_ashrsi3_table\n-\t.byte\t\tL_ashrsi3_4-L_ashrsi3_table\n-\t.byte\t\tL_ashrsi3_5-L_ashrsi3_table\n-\t.byte\t\tL_ashrsi3_6-L_ashrsi3_table\n-\t.byte\t\tL_ashrsi3_7-L_ashrsi3_table\n-\t.byte\t\tL_ashrsi3_8-L_ashrsi3_table\n-\t.byte\t\tL_ashrsi3_9-L_ashrsi3_table\n-\t.byte\t\tL_ashrsi3_10-L_ashrsi3_table\n-\t.byte\t\tL_ashrsi3_11-L_ashrsi3_table\n-\t.byte\t\tL_ashrsi3_12-L_ashrsi3_table\n-\t.byte\t\tL_ashrsi3_13-L_ashrsi3_table\n-\t.byte\t\tL_ashrsi3_14-L_ashrsi3_table\n-\t.byte\t\tL_ashrsi3_15-L_ashrsi3_table\n-\t.byte\t\tL_ashrsi3_16-L_ashrsi3_table\n-\t.byte\t\tL_ashrsi3_17-L_ashrsi3_table\n-\t.byte\t\tL_ashrsi3_18-L_ashrsi3_table\n-\t.byte\t\tL_ashrsi3_19-L_ashrsi3_table\n-\t.byte\t\tL_ashrsi3_20-L_ashrsi3_table\n-\t.byte\t\tL_ashrsi3_21-L_ashrsi3_table\n-\t.byte\t\tL_ashrsi3_22-L_ashrsi3_table\n-\t.byte\t\tL_ashrsi3_23-L_ashrsi3_table\n-\t.byte\t\tL_ashrsi3_24-L_ashrsi3_table\n-\t.byte\t\tL_ashrsi3_25-L_ashrsi3_table\n-\t.byte\t\tL_ashrsi3_26-L_ashrsi3_table\n-\t.byte\t\tL_ashrsi3_27-L_ashrsi3_table\n-\t.byte\t\tL_ashrsi3_28-L_ashrsi3_table\n-\t.byte\t\tL_ashrsi3_29-L_ashrsi3_table\n-\t.byte\t\tL_ashrsi3_30-L_ashrsi3_table\n-\t.byte\t\tL_ashrsi3_31-L_ashrsi3_table\n-\n-L_ashrsi3_31:\n+\t.align\t2\n+LOCAL(ashrsi3_table):\n+\t.byte\t\tLOCAL(ashrsi3_0)-LOCAL(ashrsi3_table)\n+\t.byte\t\tLOCAL(ashrsi3_1)-LOCAL(ashrsi3_table)\n+\t.byte\t\tLOCAL(ashrsi3_2)-LOCAL(ashrsi3_table)\n+\t.byte\t\tLOCAL(ashrsi3_3)-LOCAL(ashrsi3_table)\n+\t.byte\t\tLOCAL(ashrsi3_4)-LOCAL(ashrsi3_table)\n+\t.byte\t\tLOCAL(ashrsi3_5)-LOCAL(ashrsi3_table)\n+\t.byte\t\tLOCAL(ashrsi3_6)-LOCAL(ashrsi3_table)\n+\t.byte\t\tLOCAL(ashrsi3_7)-LOCAL(ashrsi3_table)\n+\t.byte\t\tLOCAL(ashrsi3_8)-LOCAL(ashrsi3_table)\n+\t.byte\t\tLOCAL(ashrsi3_9)-LOCAL(ashrsi3_table)\n+\t.byte\t\tLOCAL(ashrsi3_10)-LOCAL(ashrsi3_table)\n+\t.byte\t\tLOCAL(ashrsi3_11)-LOCAL(ashrsi3_table)\n+\t.byte\t\tLOCAL(ashrsi3_12)-LOCAL(ashrsi3_table)\n+\t.byte\t\tLOCAL(ashrsi3_13)-LOCAL(ashrsi3_table)\n+\t.byte\t\tLOCAL(ashrsi3_14)-LOCAL(ashrsi3_table)\n+\t.byte\t\tLOCAL(ashrsi3_15)-LOCAL(ashrsi3_table)\n+\t.byte\t\tLOCAL(ashrsi3_16)-LOCAL(ashrsi3_table)\n+\t.byte\t\tLOCAL(ashrsi3_17)-LOCAL(ashrsi3_table)\n+\t.byte\t\tLOCAL(ashrsi3_18)-LOCAL(ashrsi3_table)\n+\t.byte\t\tLOCAL(ashrsi3_19)-LOCAL(ashrsi3_table)\n+\t.byte\t\tLOCAL(ashrsi3_20)-LOCAL(ashrsi3_table)\n+\t.byte\t\tLOCAL(ashrsi3_21)-LOCAL(ashrsi3_table)\n+\t.byte\t\tLOCAL(ashrsi3_22)-LOCAL(ashrsi3_table)\n+\t.byte\t\tLOCAL(ashrsi3_23)-LOCAL(ashrsi3_table)\n+\t.byte\t\tLOCAL(ashrsi3_24)-LOCAL(ashrsi3_table)\n+\t.byte\t\tLOCAL(ashrsi3_25)-LOCAL(ashrsi3_table)\n+\t.byte\t\tLOCAL(ashrsi3_26)-LOCAL(ashrsi3_table)\n+\t.byte\t\tLOCAL(ashrsi3_27)-LOCAL(ashrsi3_table)\n+\t.byte\t\tLOCAL(ashrsi3_28)-LOCAL(ashrsi3_table)\n+\t.byte\t\tLOCAL(ashrsi3_29)-LOCAL(ashrsi3_table)\n+\t.byte\t\tLOCAL(ashrsi3_30)-LOCAL(ashrsi3_table)\n+\t.byte\t\tLOCAL(ashrsi3_31)-LOCAL(ashrsi3_table)\n+\n+LOCAL(ashrsi3_31):\n \trotcl\tr0\n \trts\n \tsubc\tr0,r0\n \n-L_ashrsi3_30:\n+LOCAL(ashrsi3_30):\n \tshar\tr0\n-L_ashrsi3_29:\n+LOCAL(ashrsi3_29):\n \tshar\tr0\n-L_ashrsi3_28:\n+LOCAL(ashrsi3_28):\n \tshar\tr0\n-L_ashrsi3_27:\n+LOCAL(ashrsi3_27):\n \tshar\tr0\n-L_ashrsi3_26:\n+LOCAL(ashrsi3_26):\n \tshar\tr0\n-L_ashrsi3_25:\n+LOCAL(ashrsi3_25):\n \tshar\tr0\n-L_ashrsi3_24:\n+LOCAL(ashrsi3_24):\n \tshlr16\tr0\n \tshlr8\tr0\n \trts\n \texts.b\tr0,r0\n \n-L_ashrsi3_23:\n+LOCAL(ashrsi3_23):\n \tshar\tr0\n-L_ashrsi3_22:\n+LOCAL(ashrsi3_22):\n \tshar\tr0\n-L_ashrsi3_21:\n+LOCAL(ashrsi3_21):\n \tshar\tr0\n-L_ashrsi3_20:\n+LOCAL(ashrsi3_20):\n \tshar\tr0\n-L_ashrsi3_19:\n+LOCAL(ashrsi3_19):\n \tshar\tr0\n-L_ashrsi3_18:\n+LOCAL(ashrsi3_18):\n \tshar\tr0\n-L_ashrsi3_17:\n+LOCAL(ashrsi3_17):\n \tshar\tr0\n-L_ashrsi3_16:\n+LOCAL(ashrsi3_16):\n \tshlr16\tr0\n \trts\n \texts.w\tr0,r0\n \n-L_ashrsi3_15:\n+LOCAL(ashrsi3_15):\n \tshar\tr0\n-L_ashrsi3_14:\n+LOCAL(ashrsi3_14):\n \tshar\tr0\n-L_ashrsi3_13:\n+LOCAL(ashrsi3_13):\n \tshar\tr0\n-L_ashrsi3_12:\n+LOCAL(ashrsi3_12):\n \tshar\tr0\n-L_ashrsi3_11:\n+LOCAL(ashrsi3_11):\n \tshar\tr0\n-L_ashrsi3_10:\n+LOCAL(ashrsi3_10):\n \tshar\tr0\n-L_ashrsi3_9:\n+LOCAL(ashrsi3_9):\n \tshar\tr0\n-L_ashrsi3_8:\n+LOCAL(ashrsi3_8):\n \tshar\tr0\n-L_ashrsi3_7:\n+LOCAL(ashrsi3_7):\n \tshar\tr0\n-L_ashrsi3_6:\n+LOCAL(ashrsi3_6):\n \tshar\tr0\n-L_ashrsi3_5:\n+LOCAL(ashrsi3_5):\n \tshar\tr0\n-L_ashrsi3_4:\n+LOCAL(ashrsi3_4):\n \tshar\tr0\n-L_ashrsi3_3:\n+LOCAL(ashrsi3_3):\n \tshar\tr0\n-L_ashrsi3_2:\n+LOCAL(ashrsi3_2):\n \tshar\tr0\n-L_ashrsi3_1:\n+LOCAL(ashrsi3_1):\n \trts\n \tshar\tr0\n \n-L_ashrsi3_0:\n+LOCAL(ashrsi3_0):\n \trts\n \tnop\n \n@@ -322,136 +336,136 @@ L_ashrsi3_0:\n \t.align\t2\n ___ashlsi3:\n \tmov\t#31,r0\n-\tcmp/hi\tr0,r5\n-\tbt\tL_ashlsi3_32\n-\tmova\tL_ashlsi3_table,r0\n+\tand\tr0,r5\n+\tmova\tLOCAL(ashlsi3_table),r0\n \tmov.b\t@(r0,r5),r5\n-\tadd\tr5,r0\t\t! Change to braf when gas is fixed\n+#ifdef __sh1__\n+\tadd\tr5,r0\n \tjmp\t@r0\n+#else\n+\tbraf\tr5\n+#endif\n \tmov\tr4,r0\n \n-L_ashlsi3_table:\n-\t.byte\t\tL_ashlsi3_0-L_ashlsi3_table\n-\t.byte\t\tL_ashlsi3_1-L_ashlsi3_table\n-\t.byte\t\tL_ashlsi3_2-L_ashlsi3_table\n-\t.byte\t\tL_ashlsi3_3-L_ashlsi3_table\n-\t.byte\t\tL_ashlsi3_4-L_ashlsi3_table\n-\t.byte\t\tL_ashlsi3_5-L_ashlsi3_table\n-\t.byte\t\tL_ashlsi3_6-L_ashlsi3_table\n-\t.byte\t\tL_ashlsi3_7-L_ashlsi3_table\n-\t.byte\t\tL_ashlsi3_8-L_ashlsi3_table\n-\t.byte\t\tL_ashlsi3_9-L_ashlsi3_table\n-\t.byte\t\tL_ashlsi3_10-L_ashlsi3_table\n-\t.byte\t\tL_ashlsi3_11-L_ashlsi3_table\n-\t.byte\t\tL_ashlsi3_12-L_ashlsi3_table\n-\t.byte\t\tL_ashlsi3_13-L_ashlsi3_table\n-\t.byte\t\tL_ashlsi3_14-L_ashlsi3_table\n-\t.byte\t\tL_ashlsi3_15-L_ashlsi3_table\n-\t.byte\t\tL_ashlsi3_16-L_ashlsi3_table\n-\t.byte\t\tL_ashlsi3_17-L_ashlsi3_table\n-\t.byte\t\tL_ashlsi3_18-L_ashlsi3_table\n-\t.byte\t\tL_ashlsi3_19-L_ashlsi3_table\n-\t.byte\t\tL_ashlsi3_20-L_ashlsi3_table\n-\t.byte\t\tL_ashlsi3_21-L_ashlsi3_table\n-\t.byte\t\tL_ashlsi3_22-L_ashlsi3_table\n-\t.byte\t\tL_ashlsi3_23-L_ashlsi3_table\n-\t.byte\t\tL_ashlsi3_24-L_ashlsi3_table\n-\t.byte\t\tL_ashlsi3_25-L_ashlsi3_table\n-\t.byte\t\tL_ashlsi3_26-L_ashlsi3_table\n-\t.byte\t\tL_ashlsi3_27-L_ashlsi3_table\n-\t.byte\t\tL_ashlsi3_28-L_ashlsi3_table\n-\t.byte\t\tL_ashlsi3_29-L_ashlsi3_table\n-\t.byte\t\tL_ashlsi3_30-L_ashlsi3_table\n-\t.byte\t\tL_ashlsi3_31-L_ashlsi3_table\n-\n-L_ashlsi3_6:\n+\t.align\t2\n+LOCAL(ashlsi3_table):\n+\t.byte\t\tLOCAL(ashlsi3_0)-LOCAL(ashlsi3_table)\n+\t.byte\t\tLOCAL(ashlsi3_1)-LOCAL(ashlsi3_table)\n+\t.byte\t\tLOCAL(ashlsi3_2)-LOCAL(ashlsi3_table)\n+\t.byte\t\tLOCAL(ashlsi3_3)-LOCAL(ashlsi3_table)\n+\t.byte\t\tLOCAL(ashlsi3_4)-LOCAL(ashlsi3_table)\n+\t.byte\t\tLOCAL(ashlsi3_5)-LOCAL(ashlsi3_table)\n+\t.byte\t\tLOCAL(ashlsi3_6)-LOCAL(ashlsi3_table)\n+\t.byte\t\tLOCAL(ashlsi3_7)-LOCAL(ashlsi3_table)\n+\t.byte\t\tLOCAL(ashlsi3_8)-LOCAL(ashlsi3_table)\n+\t.byte\t\tLOCAL(ashlsi3_9)-LOCAL(ashlsi3_table)\n+\t.byte\t\tLOCAL(ashlsi3_10)-LOCAL(ashlsi3_table)\n+\t.byte\t\tLOCAL(ashlsi3_11)-LOCAL(ashlsi3_table)\n+\t.byte\t\tLOCAL(ashlsi3_12)-LOCAL(ashlsi3_table)\n+\t.byte\t\tLOCAL(ashlsi3_13)-LOCAL(ashlsi3_table)\n+\t.byte\t\tLOCAL(ashlsi3_14)-LOCAL(ashlsi3_table)\n+\t.byte\t\tLOCAL(ashlsi3_15)-LOCAL(ashlsi3_table)\n+\t.byte\t\tLOCAL(ashlsi3_16)-LOCAL(ashlsi3_table)\n+\t.byte\t\tLOCAL(ashlsi3_17)-LOCAL(ashlsi3_table)\n+\t.byte\t\tLOCAL(ashlsi3_18)-LOCAL(ashlsi3_table)\n+\t.byte\t\tLOCAL(ashlsi3_19)-LOCAL(ashlsi3_table)\n+\t.byte\t\tLOCAL(ashlsi3_20)-LOCAL(ashlsi3_table)\n+\t.byte\t\tLOCAL(ashlsi3_21)-LOCAL(ashlsi3_table)\n+\t.byte\t\tLOCAL(ashlsi3_22)-LOCAL(ashlsi3_table)\n+\t.byte\t\tLOCAL(ashlsi3_23)-LOCAL(ashlsi3_table)\n+\t.byte\t\tLOCAL(ashlsi3_24)-LOCAL(ashlsi3_table)\n+\t.byte\t\tLOCAL(ashlsi3_25)-LOCAL(ashlsi3_table)\n+\t.byte\t\tLOCAL(ashlsi3_26)-LOCAL(ashlsi3_table)\n+\t.byte\t\tLOCAL(ashlsi3_27)-LOCAL(ashlsi3_table)\n+\t.byte\t\tLOCAL(ashlsi3_28)-LOCAL(ashlsi3_table)\n+\t.byte\t\tLOCAL(ashlsi3_29)-LOCAL(ashlsi3_table)\n+\t.byte\t\tLOCAL(ashlsi3_30)-LOCAL(ashlsi3_table)\n+\t.byte\t\tLOCAL(ashlsi3_31)-LOCAL(ashlsi3_table)\n+\n+LOCAL(ashlsi3_6):\n \tshll2\tr0\n-L_ashlsi3_4:\n+LOCAL(ashlsi3_4):\n \tshll2\tr0\n-L_ashlsi3_2:\n+LOCAL(ashlsi3_2):\n \trts\n \tshll2\tr0\n \n-L_ashlsi3_7:\n+LOCAL(ashlsi3_7):\n \tshll2\tr0\n-L_ashlsi3_5:\n+LOCAL(ashlsi3_5):\n \tshll2\tr0\n-L_ashlsi3_3:\n+LOCAL(ashlsi3_3):\n \tshll2\tr0\n-L_ashlsi3_1:\n+LOCAL(ashlsi3_1):\n \trts\n \tshll\tr0\n \n-L_ashlsi3_14:\n+LOCAL(ashlsi3_14):\n \tshll2\tr0\n-L_ashlsi3_12:\n+LOCAL(ashlsi3_12):\n \tshll2\tr0\n-L_ashlsi3_10:\n+LOCAL(ashlsi3_10):\n \tshll2\tr0\n-L_ashlsi3_8:\n+LOCAL(ashlsi3_8):\n \trts\n \tshll8\tr0\n \n-L_ashlsi3_15:\n+LOCAL(ashlsi3_15):\n \tshll2\tr0\n-L_ashlsi3_13:\n+LOCAL(ashlsi3_13):\n \tshll2\tr0\n-L_ashlsi3_11:\n+LOCAL(ashlsi3_11):\n \tshll2\tr0\n-L_ashlsi3_9:\n+LOCAL(ashlsi3_9):\n \tshll8\tr0\n \trts\n \tshll\tr0\n \n-L_ashlsi3_22:\n+LOCAL(ashlsi3_22):\n \tshll2\tr0\n-L_ashlsi3_20:\n+LOCAL(ashlsi3_20):\n \tshll2\tr0\n-L_ashlsi3_18:\n+LOCAL(ashlsi3_18):\n \tshll2\tr0\n-L_ashlsi3_16:\n+LOCAL(ashlsi3_16):\n \trts\n \tshll16\tr0\n \n-L_ashlsi3_23:\n+LOCAL(ashlsi3_23):\n \tshll2\tr0\n-L_ashlsi3_21:\n+LOCAL(ashlsi3_21):\n \tshll2\tr0\n-L_ashlsi3_19:\n+LOCAL(ashlsi3_19):\n \tshll2\tr0\n-L_ashlsi3_17:\n+LOCAL(ashlsi3_17):\n \tshll16\tr0\n \trts\n \tshll\tr0\n \n-L_ashlsi3_30:\n+LOCAL(ashlsi3_30):\n \tshll2\tr0\n-L_ashlsi3_28:\n+LOCAL(ashlsi3_28):\n \tshll2\tr0\n-L_ashlsi3_26:\n+LOCAL(ashlsi3_26):\n \tshll2\tr0\n-L_ashlsi3_24:\n+LOCAL(ashlsi3_24):\n \tshll16\tr0\n \trts\n \tshll8\tr0\n \n-L_ashlsi3_31:\n+LOCAL(ashlsi3_31):\n \tshll2\tr0\n-L_ashlsi3_29:\n+LOCAL(ashlsi3_29):\n \tshll2\tr0\n-L_ashlsi3_27:\n+LOCAL(ashlsi3_27):\n \tshll2\tr0\n-L_ashlsi3_25:\n+LOCAL(ashlsi3_25):\n \tshll16\tr0\n \tshll8\tr0\n \trts\n \tshll\tr0\n \n-L_ashlsi3_32:\n-\trts\n-\tmov\t#0,r0\n-\n-L_ashlsi3_0:\n+LOCAL(ashlsi3_0):\n \trts\n \tnop\n \n@@ -479,136 +493,136 @@ L_ashlsi3_0:\n \t.align\t2\n ___lshrsi3:\n \tmov\t#31,r0\n-\tcmp/hi\tr0,r5\n-\tbt\tL_lshrsi3_32\n-\tmova\tL_lshrsi3_table,r0\n+\tand\tr0,r5\n+\tmova\tLOCAL(lshrsi3_table),r0\n \tmov.b\t@(r0,r5),r5\n-\tadd\tr5,r0\t\t! Change to braf when gas is fixed\n+#ifdef __sh1__\n+\tadd\tr5,r0\n \tjmp\t@r0\n+#else\n+\tbraf\tr5\n+#endif\n \tmov\tr4,r0\n \n-L_lshrsi3_table:\n-\t.byte\t\tL_lshrsi3_0-L_lshrsi3_table\n-\t.byte\t\tL_lshrsi3_1-L_lshrsi3_table\n-\t.byte\t\tL_lshrsi3_2-L_lshrsi3_table\n-\t.byte\t\tL_lshrsi3_3-L_lshrsi3_table\n-\t.byte\t\tL_lshrsi3_4-L_lshrsi3_table\n-\t.byte\t\tL_lshrsi3_5-L_lshrsi3_table\n-\t.byte\t\tL_lshrsi3_6-L_lshrsi3_table\n-\t.byte\t\tL_lshrsi3_7-L_lshrsi3_table\n-\t.byte\t\tL_lshrsi3_8-L_lshrsi3_table\n-\t.byte\t\tL_lshrsi3_9-L_lshrsi3_table\n-\t.byte\t\tL_lshrsi3_10-L_lshrsi3_table\n-\t.byte\t\tL_lshrsi3_11-L_lshrsi3_table\n-\t.byte\t\tL_lshrsi3_12-L_lshrsi3_table\n-\t.byte\t\tL_lshrsi3_13-L_lshrsi3_table\n-\t.byte\t\tL_lshrsi3_14-L_lshrsi3_table\n-\t.byte\t\tL_lshrsi3_15-L_lshrsi3_table\n-\t.byte\t\tL_lshrsi3_16-L_lshrsi3_table\n-\t.byte\t\tL_lshrsi3_17-L_lshrsi3_table\n-\t.byte\t\tL_lshrsi3_18-L_lshrsi3_table\n-\t.byte\t\tL_lshrsi3_19-L_lshrsi3_table\n-\t.byte\t\tL_lshrsi3_20-L_lshrsi3_table\n-\t.byte\t\tL_lshrsi3_21-L_lshrsi3_table\n-\t.byte\t\tL_lshrsi3_22-L_lshrsi3_table\n-\t.byte\t\tL_lshrsi3_23-L_lshrsi3_table\n-\t.byte\t\tL_lshrsi3_24-L_lshrsi3_table\n-\t.byte\t\tL_lshrsi3_25-L_lshrsi3_table\n-\t.byte\t\tL_lshrsi3_26-L_lshrsi3_table\n-\t.byte\t\tL_lshrsi3_27-L_lshrsi3_table\n-\t.byte\t\tL_lshrsi3_28-L_lshrsi3_table\n-\t.byte\t\tL_lshrsi3_29-L_lshrsi3_table\n-\t.byte\t\tL_lshrsi3_30-L_lshrsi3_table\n-\t.byte\t\tL_lshrsi3_31-L_lshrsi3_table\n-\n-L_lshrsi3_6:\n+\t.align\t2\n+LOCAL(lshrsi3_table):\n+\t.byte\t\tLOCAL(lshrsi3_0)-LOCAL(lshrsi3_table)\n+\t.byte\t\tLOCAL(lshrsi3_1)-LOCAL(lshrsi3_table)\n+\t.byte\t\tLOCAL(lshrsi3_2)-LOCAL(lshrsi3_table)\n+\t.byte\t\tLOCAL(lshrsi3_3)-LOCAL(lshrsi3_table)\n+\t.byte\t\tLOCAL(lshrsi3_4)-LOCAL(lshrsi3_table)\n+\t.byte\t\tLOCAL(lshrsi3_5)-LOCAL(lshrsi3_table)\n+\t.byte\t\tLOCAL(lshrsi3_6)-LOCAL(lshrsi3_table)\n+\t.byte\t\tLOCAL(lshrsi3_7)-LOCAL(lshrsi3_table)\n+\t.byte\t\tLOCAL(lshrsi3_8)-LOCAL(lshrsi3_table)\n+\t.byte\t\tLOCAL(lshrsi3_9)-LOCAL(lshrsi3_table)\n+\t.byte\t\tLOCAL(lshrsi3_10)-LOCAL(lshrsi3_table)\n+\t.byte\t\tLOCAL(lshrsi3_11)-LOCAL(lshrsi3_table)\n+\t.byte\t\tLOCAL(lshrsi3_12)-LOCAL(lshrsi3_table)\n+\t.byte\t\tLOCAL(lshrsi3_13)-LOCAL(lshrsi3_table)\n+\t.byte\t\tLOCAL(lshrsi3_14)-LOCAL(lshrsi3_table)\n+\t.byte\t\tLOCAL(lshrsi3_15)-LOCAL(lshrsi3_table)\n+\t.byte\t\tLOCAL(lshrsi3_16)-LOCAL(lshrsi3_table)\n+\t.byte\t\tLOCAL(lshrsi3_17)-LOCAL(lshrsi3_table)\n+\t.byte\t\tLOCAL(lshrsi3_18)-LOCAL(lshrsi3_table)\n+\t.byte\t\tLOCAL(lshrsi3_19)-LOCAL(lshrsi3_table)\n+\t.byte\t\tLOCAL(lshrsi3_20)-LOCAL(lshrsi3_table)\n+\t.byte\t\tLOCAL(lshrsi3_21)-LOCAL(lshrsi3_table)\n+\t.byte\t\tLOCAL(lshrsi3_22)-LOCAL(lshrsi3_table)\n+\t.byte\t\tLOCAL(lshrsi3_23)-LOCAL(lshrsi3_table)\n+\t.byte\t\tLOCAL(lshrsi3_24)-LOCAL(lshrsi3_table)\n+\t.byte\t\tLOCAL(lshrsi3_25)-LOCAL(lshrsi3_table)\n+\t.byte\t\tLOCAL(lshrsi3_26)-LOCAL(lshrsi3_table)\n+\t.byte\t\tLOCAL(lshrsi3_27)-LOCAL(lshrsi3_table)\n+\t.byte\t\tLOCAL(lshrsi3_28)-LOCAL(lshrsi3_table)\n+\t.byte\t\tLOCAL(lshrsi3_29)-LOCAL(lshrsi3_table)\n+\t.byte\t\tLOCAL(lshrsi3_30)-LOCAL(lshrsi3_table)\n+\t.byte\t\tLOCAL(lshrsi3_31)-LOCAL(lshrsi3_table)\n+\n+LOCAL(lshrsi3_6):\n \tshlr2\tr0\n-L_lshrsi3_4:\n+LOCAL(lshrsi3_4):\n \tshlr2\tr0\n-L_lshrsi3_2:\n+LOCAL(lshrsi3_2):\n \trts\n \tshlr2\tr0\n \n-L_lshrsi3_7:\n+LOCAL(lshrsi3_7):\n \tshlr2\tr0\n-L_lshrsi3_5:\n+LOCAL(lshrsi3_5):\n \tshlr2\tr0\n-L_lshrsi3_3:\n+LOCAL(lshrsi3_3):\n \tshlr2\tr0\n-L_lshrsi3_1:\n+LOCAL(lshrsi3_1):\n \trts\n \tshlr\tr0\n \n-L_lshrsi3_14:\n+LOCAL(lshrsi3_14):\n \tshlr2\tr0\n-L_lshrsi3_12:\n+LOCAL(lshrsi3_12):\n \tshlr2\tr0\n-L_lshrsi3_10:\n+LOCAL(lshrsi3_10):\n \tshlr2\tr0\n-L_lshrsi3_8:\n+LOCAL(lshrsi3_8):\n \trts\n \tshlr8\tr0\n \n-L_lshrsi3_15:\n+LOCAL(lshrsi3_15):\n \tshlr2\tr0\n-L_lshrsi3_13:\n+LOCAL(lshrsi3_13):\n \tshlr2\tr0\n-L_lshrsi3_11:\n+LOCAL(lshrsi3_11):\n \tshlr2\tr0\n-L_lshrsi3_9:\n+LOCAL(lshrsi3_9):\n \tshlr8\tr0\n \trts\n \tshlr\tr0\n \n-L_lshrsi3_22:\n+LOCAL(lshrsi3_22):\n \tshlr2\tr0\n-L_lshrsi3_20:\n+LOCAL(lshrsi3_20):\n \tshlr2\tr0\n-L_lshrsi3_18:\n+LOCAL(lshrsi3_18):\n \tshlr2\tr0\n-L_lshrsi3_16:\n+LOCAL(lshrsi3_16):\n \trts\n \tshlr16\tr0\n \n-L_lshrsi3_23:\n+LOCAL(lshrsi3_23):\n \tshlr2\tr0\n-L_lshrsi3_21:\n+LOCAL(lshrsi3_21):\n \tshlr2\tr0\n-L_lshrsi3_19:\n+LOCAL(lshrsi3_19):\n \tshlr2\tr0\n-L_lshrsi3_17:\n+LOCAL(lshrsi3_17):\n \tshlr16\tr0\n \trts\n \tshlr\tr0\n \n-L_lshrsi3_30:\n+LOCAL(lshrsi3_30):\n \tshlr2\tr0\n-L_lshrsi3_28:\n+LOCAL(lshrsi3_28):\n \tshlr2\tr0\n-L_lshrsi3_26:\n+LOCAL(lshrsi3_26):\n \tshlr2\tr0\n-L_lshrsi3_24:\n+LOCAL(lshrsi3_24):\n \tshlr16\tr0\n \trts\n \tshlr8\tr0\n \n-L_lshrsi3_31:\n+LOCAL(lshrsi3_31):\n \tshlr2\tr0\n-L_lshrsi3_29:\n+LOCAL(lshrsi3_29):\n \tshlr2\tr0\n-L_lshrsi3_27:\n+LOCAL(lshrsi3_27):\n \tshlr2\tr0\n-L_lshrsi3_25:\n+LOCAL(lshrsi3_25):\n \tshlr16\tr0\n \tshlr8\tr0\n \trts\n \tshlr\tr0\n \n-L_lshrsi3_32:\n-\trts\n-\tmov\t#0,r0\n-\n-L_lshrsi3_0:\n+LOCAL(lshrsi3_0):\n \trts\n \tnop\n \n@@ -953,3 +967,28 @@ ret:\trts\n \tmov\tr4,r0\n \n #endif\n+#ifdef L_set_fpscr\n+#if defined (__SH3E__)\n+\t.global ___set_fpscr\n+___set_fpscr:\n+\tlds r4,fpscr\n+\tmov.l ___set_fpscr_L1,r1\n+\tswap.w r4,r0\n+\tor #24,r0\n+\txor #16,r0\n+\tswap.w r0,r2\n+\tmov.l r2,@r1\n+\txor #8,r0\n+\tswap.w r0,r3\n+\trts\n+\tmov.l r3,@(4,r1)\n+\t.align 2\n+___set_fpscr_L1:\n+\t.long ___fpscr_values\n+#ifdef __ELF__\n+        .comm   ___fpscr_values,8,4\n+#else\n+        .comm   ___fpscr_values,8\n+#endif /* ELF */\n+#endif /* SH3E */\n+#endif /* L_set_fpscr */"}, {"sha": "c6af7c1839b724cffcd93f63d8ff1cc681c2a1c0", "filename": "gcc/config/sh/t-sh", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e430f7389f1f2b06537d4d619c337810676296cb/gcc%2Fconfig%2Fsh%2Ft-sh", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e430f7389f1f2b06537d4d619c337810676296cb/gcc%2Fconfig%2Fsh%2Ft-sh", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fsh%2Ft-sh?ref=e430f7389f1f2b06537d4d619c337810676296cb", "patch": "@@ -1,7 +1,7 @@\n CROSS_LIBGCC1 = libgcc1-asm.a\n LIB1ASMSRC = sh/lib1funcs.asm\n LIB1ASMFUNCS = _ashiftrt _ashiftrt_n _ashiftlt _lshiftrt _movstr \\\n-  _mulsi3 _sdivsi3 _udivsi3\n+  _mulsi3 _sdivsi3 _udivsi3 _set_fpscr\n \n # These are really part of libgcc1, but this will cause them to be\n # built correctly, so..."}]}