{"sha": "958d42abdf1a1936d290aab126cebd6bb4a52361", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTU4ZDQyYWJkZjFhMTkzNmQyOTBhYWIxMjZjZWJkNmJiNGE1MjM2MQ==", "commit": {"author": {"name": "Patrick Palka", "email": "ppalka@redhat.com", "date": "2020-12-11T14:40:58Z"}, "committer": {"name": "Patrick Palka", "email": "ppalka@redhat.com", "date": "2020-12-11T14:40:58Z"}, "message": "c++: missing SFINAE with pointer subtraction [PR78173]\n\nThis fixes a missed SFINAE when subtracting pointers to an incomplete\ntype.\n\ngcc/cp/ChangeLog:\n\n\tPR c++/78173\n\t* typeck.c (pointer_diff): Use complete_type_or_maybe_complain\n\tinstead of complete_type_or_else.\n\ngcc/testsuite/ChangeLog:\n\n\tPR c++/78173\n\t* g++.dg/cpp2a/concepts-pr78173.C: New test.", "tree": {"sha": "cce0f5e412579a4dcdf3778c775735273c48da00", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/cce0f5e412579a4dcdf3778c775735273c48da00"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/958d42abdf1a1936d290aab126cebd6bb4a52361", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/958d42abdf1a1936d290aab126cebd6bb4a52361", "html_url": "https://github.com/Rust-GCC/gccrs/commit/958d42abdf1a1936d290aab126cebd6bb4a52361", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/958d42abdf1a1936d290aab126cebd6bb4a52361/comments", "author": null, "committer": null, "parents": [{"sha": "33314b11ca2ef1bacc1f5d82c58fae23a1d818ef", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/33314b11ca2ef1bacc1f5d82c58fae23a1d818ef", "html_url": "https://github.com/Rust-GCC/gccrs/commit/33314b11ca2ef1bacc1f5d82c58fae23a1d818ef"}], "stats": {"total": 11, "additions": 10, "deletions": 1}, "files": [{"sha": "a6505814c5304a29bcc1ad2d93d5c105f1da4955", "filename": "gcc/cp/typeck.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/958d42abdf1a1936d290aab126cebd6bb4a52361/gcc%2Fcp%2Ftypeck.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/958d42abdf1a1936d290aab126cebd6bb4a52361/gcc%2Fcp%2Ftypeck.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ftypeck.c?ref=958d42abdf1a1936d290aab126cebd6bb4a52361", "patch": "@@ -5984,7 +5984,7 @@ pointer_diff (location_t loc, tree op0, tree op1, tree ptrtype,\n   tree restype = ptrdiff_type_node;\n   tree target_type = TREE_TYPE (ptrtype);\n \n-  if (!complete_type_or_else (target_type, NULL_TREE))\n+  if (!complete_type_or_maybe_complain (target_type, NULL_TREE, complain))\n     return error_mark_node;\n \n   if (VOID_TYPE_P (target_type))"}, {"sha": "50f561abccec82bfa1e59f200a65b55ab77725a3", "filename": "gcc/testsuite/g++.dg/cpp2a/concepts-pr78173.C", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/958d42abdf1a1936d290aab126cebd6bb4a52361/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp2a%2Fconcepts-pr78173.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/958d42abdf1a1936d290aab126cebd6bb4a52361/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp2a%2Fconcepts-pr78173.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp2a%2Fconcepts-pr78173.C?ref=958d42abdf1a1936d290aab126cebd6bb4a52361", "patch": "@@ -0,0 +1,9 @@\n+// PR c++/78173\n+// { dg-do compile { target c++20 } }\n+\n+template <class T>\n+concept CanDifference = requires(T x, T y) {\n+    x - y;\n+};\n+\n+static_assert(!CanDifference<void*>);"}]}