{"sha": "bcb604b6be026c2c52ec1b3a4734d8f4ed1b91a7", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmNiNjA0YjZiZTAyNmMyYzUyZWMxYjNhNDczNGQ4ZjRlZDFiOTFhNw==", "commit": {"author": {"name": "Fariborz Jahanian", "email": "fjahanian@apple.com", "date": "2005-05-04T22:44:14Z"}, "committer": {"name": "Fariborz Jahanian", "email": "fjahanian@gcc.gnu.org", "date": "2005-05-04T22:44:14Z"}, "message": "Fixed a vrsave problem in the presense of save_world call in the prologue.\n\nOked by Dale Johannesen.\n\nFrom-SVN: r99236", "tree": {"sha": "245efb10b106af6bb77f7147bb5cfb3faa278219", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/245efb10b106af6bb77f7147bb5cfb3faa278219"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bcb604b6be026c2c52ec1b3a4734d8f4ed1b91a7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bcb604b6be026c2c52ec1b3a4734d8f4ed1b91a7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bcb604b6be026c2c52ec1b3a4734d8f4ed1b91a7", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bcb604b6be026c2c52ec1b3a4734d8f4ed1b91a7/comments", "author": null, "committer": null, "parents": [{"sha": "cc73528f07789d3453eccd695cc7703755819dad", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cc73528f07789d3453eccd695cc7703755819dad", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cc73528f07789d3453eccd695cc7703755819dad"}], "stats": {"total": 25, "additions": 17, "deletions": 8}, "files": [{"sha": "c2624bcbc0f885deb621419fa8e1f3a0ffff3f93", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bcb604b6be026c2c52ec1b3a4734d8f4ed1b91a7/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bcb604b6be026c2c52ec1b3a4734d8f4ed1b91a7/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=bcb604b6be026c2c52ec1b3a4734d8f4ed1b91a7", "patch": "@@ -1,3 +1,9 @@\n+2005-05-04 Fariborz Jahanian <fjahanian@apple.com>\n+\n+\t* config/rs6000/rs6000.c (rs6000_emit_prologue): Emit\n+\tsetting of vrsave register for current function after\n+\tcall to save_world is emitted.\n+\n 2005-05-05  Hans-Peter Nilsson  <hp@bitrange.com>\n \n \t* config/mmix/predicates.md: New file."}, {"sha": "5779d1f88ee5019620c8509cbbf5c72afc4e277f", "filename": "gcc/config/rs6000/rs6000.c", "status": "modified", "additions": 11, "deletions": 8, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bcb604b6be026c2c52ec1b3a4734d8f4ed1b91a7/gcc%2Fconfig%2Frs6000%2Frs6000.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bcb604b6be026c2c52ec1b3a4734d8f4ed1b91a7/gcc%2Fconfig%2Frs6000%2Frs6000.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.c?ref=bcb604b6be026c2c52ec1b3a4734d8f4ed1b91a7", "patch": "@@ -13271,7 +13271,7 @@ rs6000_emit_prologue (void)\n      epilogue.  */\n \n   if (TARGET_ALTIVEC && TARGET_ALTIVEC_VRSAVE\n-      && !WORLD_SAVE_P (info) && info->vrsave_mask != 0)\n+      && info->vrsave_mask != 0)\n     {\n       rtx reg, mem, vrsave;\n       int offset;\n@@ -13286,13 +13286,16 @@ rs6000_emit_prologue (void)\n       else\n \temit_insn (gen_rtx_SET (VOIDmode, reg, vrsave));\n \n-      /* Save VRSAVE.  */\n-      offset = info->vrsave_save_offset + sp_offset;\n-      mem\n-\t= gen_rtx_MEM (SImode,\n-\t\t       gen_rtx_PLUS (Pmode, frame_reg_rtx, GEN_INT (offset)));\n-      set_mem_alias_set (mem, rs6000_sr_alias_set);\n-      insn = emit_move_insn (mem, reg);\n+      if (!WORLD_SAVE_P (info))\n+\t{\n+          /* Save VRSAVE.  */\n+          offset = info->vrsave_save_offset + sp_offset;\n+          mem\n+\t    = gen_rtx_MEM (SImode,\n+\t\t           gen_rtx_PLUS (Pmode, frame_reg_rtx, GEN_INT (offset)));\n+          set_mem_alias_set (mem, rs6000_sr_alias_set);\n+          insn = emit_move_insn (mem, reg);\n+\t}\n \n       /* Include the registers in the mask.  */\n       emit_insn (gen_iorsi3 (reg, reg, GEN_INT ((int) info->vrsave_mask)));"}]}