{"sha": "18f60146494a8c90d5dfc1f640b48f2f34a1588c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MThmNjAxNDY0OTRhOGM5MGQ1ZGZjMWY2NDBiNDhmMmYzNGExNTg4Yw==", "commit": {"author": {"name": "Thomas Schwinge", "email": "thomas@codesourcery.com", "date": "2016-02-02T13:53:55Z"}, "committer": {"name": "Thomas Schwinge", "email": "tschwinge@gcc.gnu.org", "date": "2016-02-02T13:53:55Z"}, "message": "Merge BUILT_IN_GOACC_HOST_DATA into BUILT_IN_GOACC_DATA_START\n\n\tgcc/\n\t* omp-builtins.def (BUILT_IN_GOACC_HOST_DATA): Remove.\n\t* omp-low.c (expand_omp_target): Use BUILT_IN_GOACC_DATA_START\n\tinstead.\n\tlibgomp/\n\t* libgomp.map (GOACC_2.0): Remove GOACC_host_data.\n\t* oacc-parallel.c (GOACC_host_data): Remove function definition.\n\nFrom-SVN: r233074", "tree": {"sha": "a23d05493cf5649ac0a0266a05895a9348d75e4b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a23d05493cf5649ac0a0266a05895a9348d75e4b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/18f60146494a8c90d5dfc1f640b48f2f34a1588c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/18f60146494a8c90d5dfc1f640b48f2f34a1588c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/18f60146494a8c90d5dfc1f640b48f2f34a1588c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/18f60146494a8c90d5dfc1f640b48f2f34a1588c/comments", "author": {"login": "tschwinge", "id": 21753, "node_id": "MDQ6VXNlcjIxNzUz", "avatar_url": "https://avatars.githubusercontent.com/u/21753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tschwinge", "html_url": "https://github.com/tschwinge", "followers_url": "https://api.github.com/users/tschwinge/followers", "following_url": "https://api.github.com/users/tschwinge/following{/other_user}", "gists_url": "https://api.github.com/users/tschwinge/gists{/gist_id}", "starred_url": "https://api.github.com/users/tschwinge/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tschwinge/subscriptions", "organizations_url": "https://api.github.com/users/tschwinge/orgs", "repos_url": "https://api.github.com/users/tschwinge/repos", "events_url": "https://api.github.com/users/tschwinge/events{/privacy}", "received_events_url": "https://api.github.com/users/tschwinge/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "1a06f5e6a34797a74e86d2d76369eb9d78c4c538", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1a06f5e6a34797a74e86d2d76369eb9d78c4c538", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1a06f5e6a34797a74e86d2d76369eb9d78c4c538"}], "stats": {"total": 57, "additions": 10, "deletions": 47}, "files": [{"sha": "9a2cec89cbe6a2af69f2790fa1f72dc73c7db6a1", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/18f60146494a8c90d5dfc1f640b48f2f34a1588c/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/18f60146494a8c90d5dfc1f640b48f2f34a1588c/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=18f60146494a8c90d5dfc1f640b48f2f34a1588c", "patch": "@@ -1,3 +1,9 @@\n+2016-02-02  Thomas Schwinge  <thomas@codesourcery.com>\n+\n+\t* omp-builtins.def (BUILT_IN_GOACC_HOST_DATA): Remove.\n+\t* omp-low.c (expand_omp_target): Use BUILT_IN_GOACC_DATA_START\n+\tinstead.\n+\n 2016-02-02  Richard Biener  <rguenther@suse.de>\n \n \tPR tree-optimization/69606"}, {"sha": "ea012df7b6cab426c7dd3228237cfe38d50272ed", "filename": "gcc/omp-builtins.def", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/18f60146494a8c90d5dfc1f640b48f2f34a1588c/gcc%2Fomp-builtins.def", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/18f60146494a8c90d5dfc1f640b48f2f34a1588c/gcc%2Fomp-builtins.def", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fomp-builtins.def?ref=18f60146494a8c90d5dfc1f640b48f2f34a1588c", "patch": "@@ -47,8 +47,6 @@ DEF_GOACC_BUILTIN (BUILT_IN_GOACC_UPDATE, \"GOACC_update\",\n DEF_GOACC_BUILTIN (BUILT_IN_GOACC_WAIT, \"GOACC_wait\",\n \t\t   BT_FN_VOID_INT_INT_VAR,\n \t\t   ATTR_NOTHROW_LIST)\n-DEF_GOACC_BUILTIN (BUILT_IN_GOACC_HOST_DATA, \"GOACC_host_data\",\n-\t\t   BT_FN_VOID_INT_SIZE_PTR_PTR_PTR, ATTR_NOTHROW_LIST)\n \n DEF_GOACC_BUILTIN_COMPILER (BUILT_IN_ACC_ON_DEVICE, \"acc_on_device\",\n \t\t\t    BT_FN_INT_INT, ATTR_CONST_NOTHROW_LEAF_LIST)"}, {"sha": "d41688b2d737af97833a84b6e60e2be007f67b54", "filename": "gcc/omp-low.c", "status": "modified", "additions": 1, "deletions": 4, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/18f60146494a8c90d5dfc1f640b48f2f34a1588c/gcc%2Fomp-low.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/18f60146494a8c90d5dfc1f640b48f2f34a1588c/gcc%2Fomp-low.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fomp-low.c?ref=18f60146494a8c90d5dfc1f640b48f2f34a1588c", "patch": "@@ -13186,6 +13186,7 @@ expand_omp_target (struct omp_region *region)\n       start_ix = BUILT_IN_GOACC_PARALLEL;\n       break;\n     case GF_OMP_TARGET_KIND_OACC_DATA:\n+    case GF_OMP_TARGET_KIND_OACC_HOST_DATA:\n       start_ix = BUILT_IN_GOACC_DATA_START;\n       break;\n     case GF_OMP_TARGET_KIND_OACC_UPDATE:\n@@ -13197,9 +13198,6 @@ expand_omp_target (struct omp_region *region)\n     case GF_OMP_TARGET_KIND_OACC_DECLARE:\n       start_ix = BUILT_IN_GOACC_DECLARE;\n       break;\n-    case GF_OMP_TARGET_KIND_OACC_HOST_DATA:\n-      start_ix = BUILT_IN_GOACC_HOST_DATA;\n-      break;\n     default:\n       gcc_unreachable ();\n     }\n@@ -13324,7 +13322,6 @@ expand_omp_target (struct omp_region *region)\n     case BUILT_IN_GOACC_DATA_START:\n     case BUILT_IN_GOACC_DECLARE:\n     case BUILT_IN_GOMP_TARGET_DATA:\n-    case BUILT_IN_GOACC_HOST_DATA:\n       break;\n     case BUILT_IN_GOMP_TARGET:\n     case BUILT_IN_GOMP_TARGET_UPDATE:"}, {"sha": "250240d7d20b1bca40803ce09811f954293a4de2", "filename": "libgomp/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/18f60146494a8c90d5dfc1f640b48f2f34a1588c/libgomp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/18f60146494a8c90d5dfc1f640b48f2f34a1588c/libgomp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2FChangeLog?ref=18f60146494a8c90d5dfc1f640b48f2f34a1588c", "patch": "@@ -1,5 +1,8 @@\n 2016-02-02  Thomas Schwinge  <thomas@codesourcery.com>\n \n+\t* libgomp.map (GOACC_2.0): Remove GOACC_host_data.\n+\t* oacc-parallel.c (GOACC_host_data): Remove function definition.\n+\n \t* testsuite/lib/libgomp.exp: Skip hsa offloading for OpenACC test\n \tcases.\n "}, {"sha": "4d42c42f4416a076f2746f3a9db5f180c853ae80", "filename": "libgomp/libgomp.map", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/18f60146494a8c90d5dfc1f640b48f2f34a1588c/libgomp%2Flibgomp.map", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/18f60146494a8c90d5dfc1f640b48f2f34a1588c/libgomp%2Flibgomp.map", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Flibgomp.map?ref=18f60146494a8c90d5dfc1f640b48f2f34a1588c", "patch": "@@ -394,7 +394,6 @@ GOACC_2.0.1 {\n   global:\n \tGOACC_declare;\n \tGOACC_parallel_keyed;\n-\tGOACC_host_data;\n } GOACC_2.0;\n \n GOMP_PLUGIN_1.0 {"}, {"sha": "bc246510e2a181b7ad10c71450e6eb383cfd30b8", "filename": "libgomp/oacc-parallel.c", "status": "modified", "additions": 0, "deletions": 40, "changes": 40, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/18f60146494a8c90d5dfc1f640b48f2f34a1588c/libgomp%2Foacc-parallel.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/18f60146494a8c90d5dfc1f640b48f2f34a1588c/libgomp%2Foacc-parallel.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Foacc-parallel.c?ref=18f60146494a8c90d5dfc1f640b48f2f34a1588c", "patch": "@@ -490,46 +490,6 @@ GOACC_wait (int async, int num_waits, ...)\n     goacc_thread ()->dev->openacc.async_wait_all_async_func (acc_async_noval);\n }\n \n-void\n-GOACC_host_data (int device, size_t mapnum,\n-\t\t void **hostaddrs, size_t *sizes, unsigned short *kinds)\n-{\n-  bool host_fallback = device == GOMP_DEVICE_HOST_FALLBACK;\n-  struct target_mem_desc *tgt;\n-\n-#ifdef HAVE_INTTYPES_H\n-  gomp_debug (0, \"%s: mapnum=%\"PRIu64\", hostaddrs=%p, size=%p, kinds=%p\\n\",\n-\t      __FUNCTION__, (uint64_t) mapnum, hostaddrs, sizes, kinds);\n-#else\n-  gomp_debug (0, \"%s: mapnum=%lu, hostaddrs=%p, sizes=%p, kinds=%p\\n\",\n-\t      __FUNCTION__, (unsigned long) mapnum, hostaddrs, sizes, kinds);\n-#endif\n-\n-  goacc_lazy_initialize ();\n-\n-  struct goacc_thread *thr = goacc_thread ();\n-  struct gomp_device_descr *acc_dev = thr->dev;\n-\n-  /* Host fallback or 'do nothing'.  */\n-  if ((acc_dev->capabilities & GOMP_OFFLOAD_CAP_SHARED_MEM)\n-      || host_fallback)\n-    {\n-      tgt = gomp_map_vars (NULL, 0, NULL, NULL, NULL, NULL, true,\n-\t\t\t   GOMP_MAP_VARS_OPENACC);\n-      tgt->prev = thr->mapped_data;\n-      thr->mapped_data = tgt;\n-\n-      return;\n-    }\n-\n-  gomp_debug (0, \"  %s: prepare mappings\\n\", __FUNCTION__);\n-  tgt = gomp_map_vars (acc_dev, mapnum, hostaddrs, NULL, sizes, kinds, true,\n-\t\t       GOMP_MAP_VARS_OPENACC);\n-  gomp_debug (0, \"  %s: mappings prepared\\n\", __FUNCTION__);\n-  tgt->prev = thr->mapped_data;\n-  thr->mapped_data = tgt;\n-}\n-\n int\n GOACC_get_num_threads (void)\n {"}]}