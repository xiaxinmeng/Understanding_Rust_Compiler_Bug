{"sha": "1c02a3d9640482c8e296f4f939381fde52fd9b18", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWMwMmEzZDk2NDA0ODJjOGUyOTZmNGY5MzkzODFmZGU1MmZkOWIxOA==", "commit": {"author": {"name": "Bryce McKinlay", "email": "bryce@albatross.co.nz", "date": "2000-05-20T23:30:46Z"}, "committer": {"name": "Bryce McKinlay", "email": "bryce@gcc.gnu.org", "date": "2000-05-20T23:30:46Z"}, "message": "re GNATS libgcj/226 (implicit __builtin_expect) and GNATS gcj/228 (compressed JAR files)\n\n2000-05-20  Bryce McKinlay  <bryce@albatross.co.nz>\n\n\tFix for PR libgcj/226:\n\t* java/lang/Class.h (_Jv_InitClass): Don't call __builtin_expect,\n\tsince this is an installed header.\n\n\tFix for PR libgcj/228:\n\t* java/util/zip/ZipFile (getInputStream): Create inflater with\n\tnowrapper option.\n\n\t* java/util/zip/natInflater.cc (inflate): Throw zlib's error message\n\twith DataFormatException.\n\nFrom-SVN: r34064", "tree": {"sha": "88a48b421e4bd8ac7064e837896ccf0ff941907b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/88a48b421e4bd8ac7064e837896ccf0ff941907b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1c02a3d9640482c8e296f4f939381fde52fd9b18", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1c02a3d9640482c8e296f4f939381fde52fd9b18", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1c02a3d9640482c8e296f4f939381fde52fd9b18", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1c02a3d9640482c8e296f4f939381fde52fd9b18/comments", "author": null, "committer": null, "parents": [{"sha": "dcfa721dcfd39c314d5dd8c3877c8ad6c79c5a24", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dcfa721dcfd39c314d5dd8c3877c8ad6c79c5a24", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dcfa721dcfd39c314d5dd8c3877c8ad6c79c5a24"}], "stats": {"total": 25, "additions": 21, "deletions": 4}, "files": [{"sha": "bd8c7fbd648061f107b132f475d58d842a852df1", "filename": "libjava/ChangeLog", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1c02a3d9640482c8e296f4f939381fde52fd9b18/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1c02a3d9640482c8e296f4f939381fde52fd9b18/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=1c02a3d9640482c8e296f4f939381fde52fd9b18", "patch": "@@ -1,3 +1,16 @@\n+2000-05-20  Bryce McKinlay  <bryce@albatross.co.nz>\n+\n+\tFix for PR libgcj/226:\n+\t* java/lang/Class.h (_Jv_InitClass): Don't call __builtin_expect,\n+\tsince this is an installed header.\n+\t\n+\tFix for PR libgcj/228:\n+\t* java/util/zip/ZipFile (getInputStream): Create inflater with \n+\tnowrapper option.\n+\t\n+\t* java/util/zip/natInflater.cc (inflate): Throw zlib's error message\n+\twith DataFormatException.\t\n+\n 2000-05-20  Tom Tromey  <tromey@cygnus.com>\n \n \t* Makefile.in: Rebuilt."}, {"sha": "31f143ac577ecd970927115abd66389cc7f59578", "filename": "libjava/java/lang/Class.h", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1c02a3d9640482c8e296f4f939381fde52fd9b18/libjava%2Fjava%2Flang%2FClass.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1c02a3d9640482c8e296f4f939381fde52fd9b18/libjava%2Fjava%2Flang%2FClass.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjava%2Flang%2FClass.h?ref=1c02a3d9640482c8e296f4f939381fde52fd9b18", "patch": "@@ -206,8 +206,9 @@ class java::lang::Class : public java::lang::Object\n   inline friend void \n   _Jv_InitClass (jclass klass)\n   {\n-    if (__builtin_expect (klass->state != JV_STATE_DONE, false))\n-      klass->initializeClass ();\n+    if (klass->state == JV_STATE_DONE)\n+      return;\n+    klass->initializeClass ();  \n   }\n \n   friend _Jv_Method* _Jv_LookupDeclaredMethod (jclass, _Jv_Utf8Const *, "}, {"sha": "78257869fe9fd07d3ae014593256b0788b5a646b", "filename": "libjava/java/util/zip/ZipFile.java", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1c02a3d9640482c8e296f4f939381fde52fd9b18/libjava%2Fjava%2Futil%2Fzip%2FZipFile.java", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1c02a3d9640482c8e296f4f939381fde52fd9b18/libjava%2Fjava%2Futil%2Fzip%2FZipFile.java", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjava%2Futil%2Fzip%2FZipFile.java?ref=1c02a3d9640482c8e296f4f939381fde52fd9b18", "patch": "@@ -133,7 +133,9 @@ public InputStream getInputStream(ZipEntry ze)  throws IOException\n \n     InputStream is = new ByteArrayInputStream (buffer);\n     if (ze.getMethod() == ZipEntry.DEFLATED)\n-      is = new InflaterInputStream (is);\n+      // Data in zipfile entries does not have a zlib header, so construct\n+      // an Inflater with the `nowrapper' option.\n+      is = new InflaterInputStream (is, new Inflater (true), 512);\n     return is;\n   }\n "}, {"sha": "f3d258cdd59806443be792b12950f0849405f106", "filename": "libjava/java/util/zip/natInflater.cc", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1c02a3d9640482c8e296f4f939381fde52fd9b18/libjava%2Fjava%2Futil%2Fzip%2FnatInflater.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1c02a3d9640482c8e296f4f939381fde52fd9b18/libjava%2Fjava%2Futil%2Fzip%2FnatInflater.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjava%2Futil%2Fzip%2FnatInflater.cc?ref=1c02a3d9640482c8e296f4f939381fde52fd9b18", "patch": "@@ -117,7 +117,8 @@ java::util::zip::Inflater::inflate (jbyteArray buf, jint off, jint len)\n       break;\n \n     case Z_DATA_ERROR:\n-      _Jv_Throw (new java::util::zip::DataFormatException);\n+      _Jv_Throw (new java::util::zip::DataFormatException \n+                 (s->msg == NULL ? NULL : JvNewStringLatin1 (s->msg)));\n       break;\n \n     case Z_MEM_ERROR:"}]}