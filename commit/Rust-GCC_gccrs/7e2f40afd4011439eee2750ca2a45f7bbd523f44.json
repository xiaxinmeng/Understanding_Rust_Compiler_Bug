{"sha": "7e2f40afd4011439eee2750ca2a45f7bbd523f44", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2UyZjQwYWZkNDAxMTQzOWVlZTI3NTBjYTJhNDVmN2JiZDUyM2Y0NA==", "commit": {"author": {"name": "Zdenek Dvorak", "email": "dvorakz@suse.cz", "date": "2006-08-17T00:13:24Z"}, "committer": {"name": "Zdenek Dvorak", "email": "rakdver@gcc.gnu.org", "date": "2006-08-17T00:13:24Z"}, "message": "PR gcov/profile/26570\n\n\tPR gcov/profile/26570\n\t* value-prof.c (static_values): Removed.\n\t(tree_find_values_to_profile): Do not set static_values.\n\t(find_values_to_profile): Do not free static_values.\n\t* profile.c (instrument_values): Do not free the values.\n\t(branch_prob): Free the values.\n\n\t* gcc.dg/pr26570.c: New test.\n\nFrom-SVN: r116197", "tree": {"sha": "a22acd748f1104bb18682376f0fca37e65bada6c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a22acd748f1104bb18682376f0fca37e65bada6c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7e2f40afd4011439eee2750ca2a45f7bbd523f44", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7e2f40afd4011439eee2750ca2a45f7bbd523f44", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7e2f40afd4011439eee2750ca2a45f7bbd523f44", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7e2f40afd4011439eee2750ca2a45f7bbd523f44/comments", "author": null, "committer": null, "parents": [{"sha": "d8db3756c9f20b6f3f556b6ff22b91723ad16453", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d8db3756c9f20b6f3f556b6ff22b91723ad16453", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d8db3756c9f20b6f3f556b6ff22b91723ad16453"}], "stats": {"total": 41, "additions": 30, "deletions": 11}, "files": [{"sha": "f4c0ff4b47944ec472d4da796413de1227ec2d88", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7e2f40afd4011439eee2750ca2a45f7bbd523f44/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7e2f40afd4011439eee2750ca2a45f7bbd523f44/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=7e2f40afd4011439eee2750ca2a45f7bbd523f44", "patch": "@@ -1,3 +1,12 @@\n+2006-08-16  Zdenek Dvorak <dvorakz@suse.cz>\n+\n+\tPR gcov/profile/26570\n+\t* value-prof.c (static_values): Removed.\n+\t(tree_find_values_to_profile): Do not set static_values.\n+\t(find_values_to_profile): Do not free static_values.\n+\t* profile.c (instrument_values): Do not free the values.\n+\t(branch_prob): Free the values.\n+\n 2006-08-16  Naveen.H.S  <naveenh@kpitcummins.com>\n \n \t* config/m32c/m32c_lib1.S (__mulsi3): Use only registers for dest."}, {"sha": "9b4930956842ad485c71674a2ecea00f15c9aeb4", "filename": "gcc/profile.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7e2f40afd4011439eee2750ca2a45f7bbd523f44/gcc%2Fprofile.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7e2f40afd4011439eee2750ca2a45f7bbd523f44/gcc%2Fprofile.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fprofile.c?ref=7e2f40afd4011439eee2750ca2a45f7bbd523f44", "patch": "@@ -220,7 +220,6 @@ instrument_values (histogram_values values)\n \t  gcc_unreachable ();\n \t}\n     }\n-  VEC_free (histogram_value, heap, values);\n }\n \f\n \n@@ -1049,6 +1048,7 @@ branch_prob (void)\n \n   free_aux_for_edges ();\n \n+  VEC_free (histogram_value, heap, values);\n   free_edge_list (el);\n   if (flag_branch_probabilities)\n     profile_status = PROFILE_READ;"}, {"sha": "9a6bf5666f7f7881443386cc78eab8b4e22676f0", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7e2f40afd4011439eee2750ca2a45f7bbd523f44/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7e2f40afd4011439eee2750ca2a45f7bbd523f44/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=7e2f40afd4011439eee2750ca2a45f7bbd523f44", "patch": "@@ -1,3 +1,8 @@\n+2006-08-16  Zdenek Dvorak <dvorakz@suse.cz>\n+\n+\tPR gcov/profile/26570\n+\t* gcc.dg/pr26570.c: New test.\n+\n 2006-08-16  Joseph S. Myers  <joseph@codesourcery.com>\n \n \tPR c/27697"}, {"sha": "9041ee41ee09bc1eee9ff6f9b22b1ae32919f06b", "filename": "gcc/testsuite/gcc.dg/pr26570.c", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7e2f40afd4011439eee2750ca2a45f7bbd523f44/gcc%2Ftestsuite%2Fgcc.dg%2Fpr26570.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7e2f40afd4011439eee2750ca2a45f7bbd523f44/gcc%2Ftestsuite%2Fgcc.dg%2Fpr26570.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr26570.c?ref=7e2f40afd4011439eee2750ca2a45f7bbd523f44", "patch": "@@ -0,0 +1,14 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -fprofile-generate -fprofile-use\" } */\n+\n+unsigned test (unsigned a, unsigned b)\n+{\n+  return a / b;\n+} /* { dg-warning \"execution counts estimated\" } */\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -fprofile-generate -fprofile-use\" } */\n+\n+unsigned test (unsigned a, unsigned b)\n+{\n+  return a / b;\n+} /* { dg-warning \"execution counts estimated\" } */"}, {"sha": "6c64e3cbe271dade378ab486e2641d1c631b8d60", "filename": "gcc/value-prof.c", "status": "modified", "additions": 1, "deletions": 10, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7e2f40afd4011439eee2750ca2a45f7bbd523f44/gcc%2Fvalue-prof.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7e2f40afd4011439eee2750ca2a45f7bbd523f44/gcc%2Fvalue-prof.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fvalue-prof.c?ref=7e2f40afd4011439eee2750ca2a45f7bbd523f44", "patch": "@@ -46,12 +46,6 @@ Software Foundation, 51 Franklin Street, Fifth Floor, Boston, MA\n \n static struct value_prof_hooks *value_prof_hooks;\n \n-/* This is the vector of histograms.  Created in find_values_to_profile.\n-   During profile generation, freed by instrument_values.\n-   During profile use, freed by value_profile_transformations.  */\n-\n-static histogram_values static_values = NULL;\n-\n /* In this file value profile based optimizations are placed.  Currently the\n    following optimizations are implemented (for more detailed descriptions\n    see comments at value_profile_transformations):\n@@ -797,7 +791,6 @@ tree_find_values_to_profile (histogram_values *values)\n   FOR_EACH_BB (bb)\n     for (bsi = bsi_start (bb); !bsi_end_p (bsi); bsi_next (&bsi))\n       tree_values_to_profile (bsi_stmt (bsi), values);\n-  static_values = *values;\n   \n   for (i = 0; VEC_iterate (histogram_value, *values, i, hist); i++)\n     {\n@@ -875,9 +868,7 @@ find_values_to_profile (histogram_values *values)\n bool\n value_profile_transformations (void)\n {\n-  bool retval = (value_prof_hooks->value_profile_transformations) ();\n-  VEC_free (histogram_value, heap, static_values);\n-  return retval;\n+  return (value_prof_hooks->value_profile_transformations) ();\n }\n \f\n "}]}