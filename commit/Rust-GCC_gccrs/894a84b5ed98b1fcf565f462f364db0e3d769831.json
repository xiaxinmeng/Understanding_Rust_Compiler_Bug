{"sha": "894a84b5ed98b1fcf565f462f364db0e3d769831", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODk0YTg0YjVlZDk4YjFmY2Y1NjVmNDYyZjM2NGRiMGUzZDc2OTgzMQ==", "commit": {"author": {"name": "Bernd Schmidt", "email": "bernds@codesourcery.com", "date": "2011-11-14T23:31:13Z"}, "committer": {"name": "Hans-Peter Nilsson", "email": "hp@gcc.gnu.org", "date": "2011-11-14T23:31:13Z"}, "message": "re PR rtl-optimization/51051 (build fails on cris-elf building libstdc++-v3)\n\n\tPR rtl-optimization/51051\n\t* cfgrtl.c (cfg_layout_can_merge_blocks_p): Return FALSE if the\n\tmove would cause fallthrough into the exit block.\n\nFrom-SVN: r181371", "tree": {"sha": "077e15975c6c73524eb38086ddfaaaa17a163d7b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/077e15975c6c73524eb38086ddfaaaa17a163d7b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/894a84b5ed98b1fcf565f462f364db0e3d769831", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/894a84b5ed98b1fcf565f462f364db0e3d769831", "html_url": "https://github.com/Rust-GCC/gccrs/commit/894a84b5ed98b1fcf565f462f364db0e3d769831", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/894a84b5ed98b1fcf565f462f364db0e3d769831/comments", "author": null, "committer": null, "parents": [{"sha": "2747a04662929c37d3bcc96c36adc861a4611710", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2747a04662929c37d3bcc96c36adc861a4611710", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2747a04662929c37d3bcc96c36adc861a4611710"}], "stats": {"total": 16, "additions": 16, "deletions": 0}, "files": [{"sha": "2e225e752c11e462d61f74f4707b6a7fc9b6e892", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/894a84b5ed98b1fcf565f462f364db0e3d769831/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/894a84b5ed98b1fcf565f462f364db0e3d769831/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=894a84b5ed98b1fcf565f462f364db0e3d769831", "patch": "@@ -1,3 +1,9 @@\n+2011-11-15  Bernd Schmidt  <bernds@codesourcery.com>\n+\n+\tPR rtl-optimization/51051\n+\t* cfgrtl.c (cfg_layout_can_merge_blocks_p): Return FALSE if the\n+\tmove would cause fallthrough into the exit block.\n+\n 2011-11-14  Richard Henderson  <rth@redhat.com>\n \n \t* config/rs6000/rs6000.c (emit_load_locked): Assert the mode is handled."}, {"sha": "aeb4ba184e16dc6881c0441bd022b84431bf8fc1", "filename": "gcc/cfgrtl.c", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/894a84b5ed98b1fcf565f462f364db0e3d769831/gcc%2Fcfgrtl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/894a84b5ed98b1fcf565f462f364db0e3d769831/gcc%2Fcfgrtl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcfgrtl.c?ref=894a84b5ed98b1fcf565f462f364db0e3d769831", "patch": "@@ -2735,6 +2735,16 @@ cfg_layout_can_merge_blocks_p (basic_block a, basic_block b)\n   if (BB_PARTITION (a) != BB_PARTITION (b))\n     return false;\n \n+  /* If we would end up moving B's instructions, make sure it doesn't fall\n+     through into the exit block, since we cannot recover from a fallthrough\n+     edge into the exit block occurring in the middle of a function.  */\n+  if (NEXT_INSN (BB_END (a)) != BB_HEAD (b))\n+    {\n+      edge e = find_fallthru_edge (b->succs);\n+      if (e && e->dest == EXIT_BLOCK_PTR)\n+\treturn false;\n+    }\n+\n   /* There must be exactly one edge in between the blocks.  */\n   return (single_succ_p (a)\n \t  && single_succ (a) == b"}]}