{"sha": "a5027ea2ad22c82adc68e02dae8be7f69131503a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTUwMjdlYTJhZDIyYzgyYWRjNjhlMDJkYWU4YmU3ZjY5MTMxNTAzYQ==", "commit": {"author": {"name": "Bill Schmidt", "email": "wschmidt@linux.ibm.com", "date": "2021-08-30T19:55:11Z"}, "committer": {"name": "Bill Schmidt", "email": "wschmidt@linux.ibm.com", "date": "2021-08-30T19:58:27Z"}, "message": "rs6000: Add sanity to V2DI_type_node definitions\n\n2021-08-30  Bill Schmidt  <wschmidt@linux.ibm.com>\n\ngcc/\n\t* config/rs6000/rs6000-call.c (rs6000_init_builtins): Change\n\tinitialization of V2DI_type_node and unsigned_V2DI_type_node.", "tree": {"sha": "fbe1e5c9bb4faf3c819812585ac6f9d111ed0654", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/fbe1e5c9bb4faf3c819812585ac6f9d111ed0654"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a5027ea2ad22c82adc68e02dae8be7f69131503a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a5027ea2ad22c82adc68e02dae8be7f69131503a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a5027ea2ad22c82adc68e02dae8be7f69131503a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a5027ea2ad22c82adc68e02dae8be7f69131503a/comments", "author": null, "committer": null, "parents": [{"sha": "b5bc39317bf4da1d51cb6eccf8afcacc90514602", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b5bc39317bf4da1d51cb6eccf8afcacc90514602", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b5bc39317bf4da1d51cb6eccf8afcacc90514602"}], "stats": {"total": 31, "additions": 24, "deletions": 7}, "files": [{"sha": "df405e1b8c724c0c4725e3279ab3a41f6f9bed9f", "filename": "gcc/config/rs6000/rs6000-call.c", "status": "modified", "additions": 24, "deletions": 7, "changes": 31, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a5027ea2ad22c82adc68e02dae8be7f69131503a/gcc%2Fconfig%2Frs6000%2Frs6000-call.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a5027ea2ad22c82adc68e02dae8be7f69131503a/gcc%2Fconfig%2Frs6000%2Frs6000-call.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000-call.c?ref=a5027ea2ad22c82adc68e02dae8be7f69131503a", "patch": "@@ -13297,15 +13297,23 @@ rs6000_init_builtins (void)\n   tree ftype;\n   tree t;\n   machine_mode mode;\n+  const char *str;\n \n   if (TARGET_DEBUG_BUILTIN)\n     fprintf (stderr, \"rs6000_init_builtins%s%s\\n\",\n \t     (TARGET_ALTIVEC)\t   ? \", altivec\" : \"\",\n \t     (TARGET_VSX)\t   ? \", vsx\"\t : \"\");\n \n-  V2DI_type_node = rs6000_vector_type (TARGET_POWERPC64 ? \"__vector long\"\n-\t\t\t\t       : \"__vector long long\",\n-\t\t\t\t       long_long_integer_type_node, 2);\n+  if (new_builtins_are_live)\n+    V2DI_type_node = rs6000_vector_type (\"__vector long long\",\n+\t\t\t\t\t long_long_integer_type_node, 2);\n+  else\n+    {\n+      str = TARGET_POWERPC64 ? \"__vector long\" : \"__vector long long\";\n+      V2DI_type_node = rs6000_vector_type (str,\n+\t\t\t\t\t   long_long_integer_type_node,\n+\t\t\t\t\t   2);\n+    }\n   ptr_V2DI_type_node\n     = build_pointer_type (build_qualified_type (V2DI_type_node,\n \t\t\t\t\t\tTYPE_QUAL_CONST));\n@@ -13356,10 +13364,19 @@ rs6000_init_builtins (void)\n     = build_pointer_type (build_qualified_type (unsigned_V4SI_type_node,\n \t\t\t\t\t\tTYPE_QUAL_CONST));\n \n-  unsigned_V2DI_type_node = rs6000_vector_type (TARGET_POWERPC64\n-\t\t\t\t       ? \"__vector unsigned long\"\n-\t\t\t\t       : \"__vector unsigned long long\",\n-\t\t\t\t       long_long_unsigned_type_node, 2);\n+  if (new_builtins_are_live)\n+    unsigned_V2DI_type_node\n+      = rs6000_vector_type (\"__vector unsigned long long\",\n+\t\t\t    long_long_unsigned_type_node, 2);\n+  else\n+    {\n+      str = TARGET_POWERPC64\n+\t? \"__vector unsigned long\"\n+\t: \"__vector unsigned long long\";\n+      unsigned_V2DI_type_node\n+\t= rs6000_vector_type (str, long_long_unsigned_type_node, 2);\n+    }\n+\n   ptr_unsigned_V2DI_type_node\n     = build_pointer_type (build_qualified_type (unsigned_V2DI_type_node,\n \t\t\t\t\t\tTYPE_QUAL_CONST));"}]}