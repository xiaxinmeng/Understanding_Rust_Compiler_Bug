{"sha": "52fe4de8a3f1afcefdad091977f9b1a21b92a5a1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTJmZTRkZThhM2YxYWZjZWZkYWQwOTE5NzdmOWIxYTIxYjkyYTVhMQ==", "commit": {"author": {"name": "John David Anglin", "email": "dave.anglin@nrc-cnrc.gc.ca", "date": "2004-05-20T18:36:50Z"}, "committer": {"name": "John David Anglin", "email": "danglin@gcc.gnu.org", "date": "2004-05-20T18:36:50Z"}, "message": "reorg.c (delete_from_delay_slot): If we have a barrier after the sequence containing the insn to be deleted...\n\n\t* reorg.c (delete_from_delay_slot): If we have a barrier after the\n\tsequence containing the insn to be deleted, always reemit it.\n\nFrom-SVN: r82065", "tree": {"sha": "cacf03b0026cae4961695314d60373036916041c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/cacf03b0026cae4961695314d60373036916041c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/52fe4de8a3f1afcefdad091977f9b1a21b92a5a1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/52fe4de8a3f1afcefdad091977f9b1a21b92a5a1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/52fe4de8a3f1afcefdad091977f9b1a21b92a5a1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/52fe4de8a3f1afcefdad091977f9b1a21b92a5a1/comments", "author": null, "committer": null, "parents": [{"sha": "7e14028056eafe6486281fb96d17d2f873f6248f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7e14028056eafe6486281fb96d17d2f873f6248f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7e14028056eafe6486281fb96d17d2f873f6248f"}], "stats": {"total": 13, "additions": 11, "deletions": 2}, "files": [{"sha": "e2f342598612c37749c40f05c58264151c04686d", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/52fe4de8a3f1afcefdad091977f9b1a21b92a5a1/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/52fe4de8a3f1afcefdad091977f9b1a21b92a5a1/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=52fe4de8a3f1afcefdad091977f9b1a21b92a5a1", "patch": "@@ -1,3 +1,8 @@\n+2004-05-20  John David Anglin  <dave.anglin@nrc-cnrc.gc.ca>\n+\n+\t* reorg.c (delete_from_delay_slot): If we have a barrier after the\n+\tsequence containing the insn to be deleted, always reemit it.\n+\n 2004-05-20  Richard Henderson  <rth@redhat.com>\n \n \tPR 15454"}, {"sha": "dd9737b506fb336c19c3df2d4115f4443e47227f", "filename": "gcc/reorg.c", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/52fe4de8a3f1afcefdad091977f9b1a21b92a5a1/gcc%2Freorg.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/52fe4de8a3f1afcefdad091977f9b1a21b92a5a1/gcc%2Freorg.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Freorg.c?ref=52fe4de8a3f1afcefdad091977f9b1a21b92a5a1", "patch": "@@ -570,6 +570,7 @@ delete_from_delay_slot (rtx insn)\n   rtx trial, seq_insn, seq, prev;\n   rtx delay_list = 0;\n   int i;\n+  int had_barrier = 0;\n \n   /* We first must find the insn containing the SEQUENCE with INSN in its\n      delay slot.  Do this by finding an insn, TRIAL, where\n@@ -583,6 +584,9 @@ delete_from_delay_slot (rtx insn)\n   seq_insn = PREV_INSN (NEXT_INSN (trial));\n   seq = PATTERN (seq_insn);\n \n+  if (NEXT_INSN (seq_insn) && GET_CODE (NEXT_INSN (seq_insn)) == BARRIER)\n+    had_barrier = 1;\n+\n   /* Create a delay list consisting of all the insns other than the one\n      we are deleting (unless we were the only one).  */\n   if (XVECLEN (seq, 0) > 2)\n@@ -597,8 +601,8 @@ delete_from_delay_slot (rtx insn)\n   delete_related_insns (seq_insn);\n   add_insn_after (trial, prev);\n \n-  if (GET_CODE (trial) == JUMP_INSN\n-      && (simplejump_p (trial) || GET_CODE (PATTERN (trial)) == RETURN))\n+  /* If there was a barrier after the old SEQUENCE, remit it.  */\n+  if (had_barrier)\n     emit_barrier_after (trial);\n \n   /* If there are any delay insns, remit them.  Otherwise clear the"}]}