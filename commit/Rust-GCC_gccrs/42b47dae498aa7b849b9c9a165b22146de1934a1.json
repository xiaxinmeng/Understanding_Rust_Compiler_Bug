{"sha": "42b47dae498aa7b849b9c9a165b22146de1934a1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDJiNDdkYWU0OThhYTdiODQ5YjljOWExNjViMjIxNDZkZTE5MzRhMQ==", "commit": {"author": {"name": "Andrew Stubbs", "email": "ams@codesourcery.com", "date": "2020-07-17T10:45:34Z"}, "committer": {"name": "Andrew Stubbs", "email": "ams@codesourcery.com", "date": "2020-07-17T10:51:26Z"}, "message": "amdgcn: Fix elf.h build issue\n\nAllow building on systems with elf.h that includes AMDGPU definitions,\npartially or completely.\n\ngcc/ChangeLog:\n\n\t* config/gcn/mkoffload.c (EM_AMDGPU): Undefine before defining.\n\t(ELFOSABI_AMDGPU_HSA): Likewise.\n\t(ELFABIVERSION_AMDGPU_HSA): Likewise.\n\t(EF_AMDGPU_MACH_AMDGCN_GFX803): Likewise.\n\t(EF_AMDGPU_MACH_AMDGCN_GFX900): Likewise.\n\t(EF_AMDGPU_MACH_AMDGCN_GFX906): Likewise.\n\t(reserved): Delete.", "tree": {"sha": "5d356276e9255d265e9dd528d6b9de5b460c8d3e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5d356276e9255d265e9dd528d6b9de5b460c8d3e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/42b47dae498aa7b849b9c9a165b22146de1934a1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/42b47dae498aa7b849b9c9a165b22146de1934a1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/42b47dae498aa7b849b9c9a165b22146de1934a1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/42b47dae498aa7b849b9c9a165b22146de1934a1/comments", "author": {"login": "ams-cs", "id": 2235130, "node_id": "MDQ6VXNlcjIyMzUxMzA=", "avatar_url": "https://avatars.githubusercontent.com/u/2235130?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ams-cs", "html_url": "https://github.com/ams-cs", "followers_url": "https://api.github.com/users/ams-cs/followers", "following_url": "https://api.github.com/users/ams-cs/following{/other_user}", "gists_url": "https://api.github.com/users/ams-cs/gists{/gist_id}", "starred_url": "https://api.github.com/users/ams-cs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ams-cs/subscriptions", "organizations_url": "https://api.github.com/users/ams-cs/orgs", "repos_url": "https://api.github.com/users/ams-cs/repos", "events_url": "https://api.github.com/users/ams-cs/events{/privacy}", "received_events_url": "https://api.github.com/users/ams-cs/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ams-cs", "id": 2235130, "node_id": "MDQ6VXNlcjIyMzUxMzA=", "avatar_url": "https://avatars.githubusercontent.com/u/2235130?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ams-cs", "html_url": "https://github.com/ams-cs", "followers_url": "https://api.github.com/users/ams-cs/followers", "following_url": "https://api.github.com/users/ams-cs/following{/other_user}", "gists_url": "https://api.github.com/users/ams-cs/gists{/gist_id}", "starred_url": "https://api.github.com/users/ams-cs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ams-cs/subscriptions", "organizations_url": "https://api.github.com/users/ams-cs/orgs", "repos_url": "https://api.github.com/users/ams-cs/repos", "events_url": "https://api.github.com/users/ams-cs/events{/privacy}", "received_events_url": "https://api.github.com/users/ams-cs/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c9c87e6f9c795bb36e4570a07501fc182eaad035", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c9c87e6f9c795bb36e4570a07501fc182eaad035", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c9c87e6f9c795bb36e4570a07501fc182eaad035"}], "stats": {"total": 11, "additions": 8, "deletions": 3}, "files": [{"sha": "808ce53176c5e3ff1ddb05824d0c584d19acbf23", "filename": "gcc/config/gcn/mkoffload.c", "status": "modified", "additions": 8, "deletions": 3, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/42b47dae498aa7b849b9c9a165b22146de1934a1/gcc%2Fconfig%2Fgcn%2Fmkoffload.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/42b47dae498aa7b849b9c9a165b22146de1934a1/gcc%2Fconfig%2Fgcn%2Fmkoffload.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fgcn%2Fmkoffload.c?ref=42b47dae498aa7b849b9c9a165b22146de1934a1", "patch": "@@ -36,17 +36,23 @@\n #include \"simple-object.h\"\n #include \"elf.h\"\n \n-/* These probably won't be in elf.h for a while.  */\n-#ifndef EM_AMDGPU\n+/* These probably won't (all) be in elf.h for a while.  */\n+#undef  EM_AMDGPU\n #define EM_AMDGPU\t\t0xe0;\n \n+#undef  ELFOSABI_AMDGPU_HSA\n #define ELFOSABI_AMDGPU_HSA\t 64\n+#undef  ELFABIVERSION_AMDGPU_HSA\n #define ELFABIVERSION_AMDGPU_HSA 1\n \n+#undef  EF_AMDGPU_MACH_AMDGCN_GFX803\n #define EF_AMDGPU_MACH_AMDGCN_GFX803 0x2a\n+#undef  EF_AMDGPU_MACH_AMDGCN_GFX900\n #define EF_AMDGPU_MACH_AMDGCN_GFX900 0x2c\n+#undef  EF_AMDGPU_MACH_AMDGCN_GFX906\n #define EF_AMDGPU_MACH_AMDGCN_GFX906 0x2f\n \n+#ifndef R_AMDGPU_NONE\n #define R_AMDGPU_NONE\t\t0\n #define R_AMDGPU_ABS32_LO\t1\t/* (S + A) & 0xFFFFFFFF  */\n #define R_AMDGPU_ABS32_HI\t2\t/* (S + A) >> 32  */\n@@ -59,7 +65,6 @@\n #define R_AMDGPU_GOTPCREL32_HI\t9\t/* (G + GOT + A - P) >> 32  */\n #define R_AMDGPU_REL32_LO\t10\t/* (S + A - P) & 0xFFFFFFFF  */\n #define R_AMDGPU_REL32_HI\t11\t/* (S + A - P) >> 32  */\n-#define reserved\t\t12\n #define R_AMDGPU_RELATIVE64\t13\t/* B + A  */\n #endif\n "}]}