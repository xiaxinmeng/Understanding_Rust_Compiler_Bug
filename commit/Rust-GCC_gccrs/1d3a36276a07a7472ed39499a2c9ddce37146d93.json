{"sha": "1d3a36276a07a7472ed39499a2c9ddce37146d93", "node_id": "C_kwDOANBUbNoAKDFkM2EzNjI3NmEwN2E3NDcyZWQzOTQ5OWEyYzlkZGNlMzcxNDZkOTM", "commit": {"author": {"name": "Ben Boeckel", "email": "mathstuf@gmail.com", "date": "2021-10-25T11:48:42Z"}, "committer": {"name": "Ben Boeckel", "email": "mathstuf@gmail.com", "date": "2021-10-25T12:14:55Z"}, "message": "gccrs: StructExprStructFields: remove `iterate` method\n\nThis provides a getter for the set of fields in a struct expression\nrather than a visitor with a callback which is more complicated for\ncallers, especially static analysis.\n\nSigned-off-by: Ben Boeckel <mathstuf@gmail.com>", "tree": {"sha": "2559822b214026dff3e706f80bec551bfde33e6c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2559822b214026dff3e706f80bec551bfde33e6c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1d3a36276a07a7472ed39499a2c9ddce37146d93", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1d3a36276a07a7472ed39499a2c9ddce37146d93", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1d3a36276a07a7472ed39499a2c9ddce37146d93", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1d3a36276a07a7472ed39499a2c9ddce37146d93/comments", "author": {"login": "mathstuf", "id": 97253, "node_id": "MDQ6VXNlcjk3MjUz", "avatar_url": "https://avatars.githubusercontent.com/u/97253?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mathstuf", "html_url": "https://github.com/mathstuf", "followers_url": "https://api.github.com/users/mathstuf/followers", "following_url": "https://api.github.com/users/mathstuf/following{/other_user}", "gists_url": "https://api.github.com/users/mathstuf/gists{/gist_id}", "starred_url": "https://api.github.com/users/mathstuf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mathstuf/subscriptions", "organizations_url": "https://api.github.com/users/mathstuf/orgs", "repos_url": "https://api.github.com/users/mathstuf/repos", "events_url": "https://api.github.com/users/mathstuf/events{/privacy}", "received_events_url": "https://api.github.com/users/mathstuf/received_events", "type": "User", "site_admin": false}, "committer": {"login": "mathstuf", "id": 97253, "node_id": "MDQ6VXNlcjk3MjUz", "avatar_url": "https://avatars.githubusercontent.com/u/97253?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mathstuf", "html_url": "https://github.com/mathstuf", "followers_url": "https://api.github.com/users/mathstuf/followers", "following_url": "https://api.github.com/users/mathstuf/following{/other_user}", "gists_url": "https://api.github.com/users/mathstuf/gists{/gist_id}", "starred_url": "https://api.github.com/users/mathstuf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mathstuf/subscriptions", "organizations_url": "https://api.github.com/users/mathstuf/orgs", "repos_url": "https://api.github.com/users/mathstuf/repos", "events_url": "https://api.github.com/users/mathstuf/events{/privacy}", "received_events_url": "https://api.github.com/users/mathstuf/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "868d3125d326a6800376411fb6699d984cfa7101", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/868d3125d326a6800376411fb6699d984cfa7101", "html_url": "https://github.com/Rust-GCC/gccrs/commit/868d3125d326a6800376411fb6699d984cfa7101"}], "stats": {"total": 33, "additions": 13, "deletions": 20}, "files": [{"sha": "0d3c50e25ab8e7b711e3eaf542763e9a1731edf8", "filename": "gcc/rust/ast/rust-expr.h", "status": "modified", "additions": 0, "deletions": 9, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1d3a36276a07a7472ed39499a2c9ddce37146d93/gcc%2Frust%2Fast%2Frust-expr.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1d3a36276a07a7472ed39499a2c9ddce37146d93/gcc%2Frust%2Fast%2Frust-expr.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Frust%2Fast%2Frust-expr.h?ref=1d3a36276a07a7472ed39499a2c9ddce37146d93", "patch": "@@ -1799,15 +1799,6 @@ class StructExprStructFields : public StructExprStruct\n     return fields;\n   }\n \n-  void iterate (std::function<bool (StructExprField *)> cb)\n-  {\n-    for (auto &field : fields)\n-      {\n-\tif (!cb (field.get ()))\n-\t  return;\n-      }\n-  }\n-\n   StructBase &get_struct_base () { return struct_base; }\n   const StructBase &get_struct_base () const { return struct_base; }\n "}, {"sha": "782045d41dc560f80893c6e1eaf642a0c5d540f8", "filename": "gcc/rust/hir/rust-ast-lower-expr.h", "status": "modified", "additions": 7, "deletions": 6, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1d3a36276a07a7472ed39499a2c9ddce37146d93/gcc%2Frust%2Fhir%2Frust-ast-lower-expr.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1d3a36276a07a7472ed39499a2c9ddce37146d93/gcc%2Frust%2Fhir%2Frust-ast-lower-expr.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Frust%2Fhir%2Frust-ast-lower-expr.h?ref=1d3a36276a07a7472ed39499a2c9ddce37146d93", "patch": "@@ -546,13 +546,14 @@ class ASTLoweringExpr : public ASTLoweringBase\n \t  = new HIR::StructBase (std::unique_ptr<HIR::Expr> (translated_base));\n       }\n \n+    auto const &in_fields = struct_expr.get_fields ();\n     std::vector<std::unique_ptr<HIR::StructExprField> > fields;\n-    struct_expr.iterate ([&] (AST::StructExprField *field) mutable -> bool {\n-      HIR::StructExprField *translated\n-\t= ASTLowerStructExprField::translate (field);\n-      fields.push_back (std::unique_ptr<HIR::StructExprField> (translated));\n-      return true;\n-    });\n+    for (auto &field : in_fields)\n+      {\n+\tHIR::StructExprField *translated\n+\t  = ASTLowerStructExprField::translate (field.get ());\n+\tfields.push_back (std::unique_ptr<HIR::StructExprField> (translated));\n+      }\n \n     auto crate_num = mappings->get_current_crate ();\n     Analysis::NodeMapping mapping (crate_num, struct_expr.get_node_id (),"}, {"sha": "48906f5dbe19d160eb8dfd8329d7a0955a6e2fd9", "filename": "gcc/rust/resolve/rust-ast-resolve-expr.h", "status": "modified", "additions": 6, "deletions": 5, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1d3a36276a07a7472ed39499a2c9ddce37146d93/gcc%2Frust%2Fresolve%2Frust-ast-resolve-expr.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1d3a36276a07a7472ed39499a2c9ddce37146d93/gcc%2Frust%2Fresolve%2Frust-ast-resolve-expr.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Frust%2Fresolve%2Frust-ast-resolve-expr.h?ref=1d3a36276a07a7472ed39499a2c9ddce37146d93", "patch": "@@ -269,11 +269,12 @@ class ResolveExpr : public ResolverBase\n \t\t\t struct_expr.get_node_id ());\n       }\n \n-    struct_expr.iterate (\n-      [&] (AST::StructExprField *struct_field) mutable -> bool {\n-\tResolveStructExprField::go (struct_field, struct_expr.get_node_id ());\n-\treturn true;\n-      });\n+    auto const &struct_fields = struct_expr.get_fields ();\n+    for (auto &struct_field : struct_fields)\n+      {\n+\tResolveStructExprField::go (struct_field.get (),\n+\t\t\t\t    struct_expr.get_node_id ());\n+      }\n   }\n \n   void visit (AST::GroupedExpr &expr) override"}]}