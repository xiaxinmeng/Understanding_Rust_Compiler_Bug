{"sha": "606145e4e0e54d412059033a6261c53bf11d7b6d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjA2MTQ1ZTRlMGU1NGQ0MTIwNTkwMzNhNjI2MWM1M2JmMTFkN2I2ZA==", "commit": {"author": {"name": "Janis Johnson", "email": "janis187@us.ibm.com", "date": "2004-12-22T17:51:01Z"}, "committer": {"name": "Janis Johnson", "email": "janis@gcc.gnu.org", "date": "2004-12-22T17:51:01Z"}, "message": "* lib/gcc-dg.exp (dg-xfail-if): Fix the flags compared against.\n\nFrom-SVN: r92490", "tree": {"sha": "d87600d9f7a1481b644fab3a0e7fcd401eec6bbd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d87600d9f7a1481b644fab3a0e7fcd401eec6bbd"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/606145e4e0e54d412059033a6261c53bf11d7b6d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/606145e4e0e54d412059033a6261c53bf11d7b6d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/606145e4e0e54d412059033a6261c53bf11d7b6d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/606145e4e0e54d412059033a6261c53bf11d7b6d/comments", "author": null, "committer": null, "parents": [{"sha": "e90f1b9de770f194d1707c80afe7e75def07b873", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e90f1b9de770f194d1707c80afe7e75def07b873", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e90f1b9de770f194d1707c80afe7e75def07b873"}], "stats": {"total": 31, "additions": 28, "deletions": 3}, "files": [{"sha": "5f0074a063b4f8e7f970d6bd96486c1b933e6a97", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/606145e4e0e54d412059033a6261c53bf11d7b6d/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/606145e4e0e54d412059033a6261c53bf11d7b6d/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=606145e4e0e54d412059033a6261c53bf11d7b6d", "patch": "@@ -1,3 +1,7 @@\n+2004-12-22  Janis Johnson  <janis187@us.ibm.com>\n+\n+\t* lib/gcc-dg.exp (dg-xfail-if): Fix the flags compared against.\n+\n 2004-12-22  Jan Beulich  <jbeulich@novell.com>\n \n \t* gcc.dg/20040813-1.c: Skip for *-*-netware*."}, {"sha": "1a08b355aa2308ac140b47336d8c654ddcb0ced4", "filename": "gcc/testsuite/lib/gcc-dg.exp", "status": "modified", "additions": 24, "deletions": 3, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/606145e4e0e54d412059033a6261c53bf11d7b6d/gcc%2Ftestsuite%2Flib%2Fgcc-dg.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/606145e4e0e54d412059033a6261c53bf11d7b6d/gcc%2Ftestsuite%2Flib%2Fgcc-dg.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Flib%2Fgcc-dg.exp?ref=606145e4e0e54d412059033a6261c53bf11d7b6d", "patch": "@@ -426,19 +426,40 @@ proc dg-require-effective-target { args } {\n # The first argument is the line number of the dg-skip-if directive\n # within the test file.   Remaining arguments are as for xfail lists:\n # message { targets } { include } { exclude }\n+#\n+# This tests against multilib flags plus either the default flags for this\n+# group of tests or flags specified with a previous dg-options command.\n \n proc dg-skip-if { args } {\n     set args [lreplace $args 0 0]\n \n-    # The target list might be an effective-target keyword, so replace\n-    # the original list with \"*-*-*\" if it is matched.\n     set selector \"target [join [lindex $args 1]]\"\n     if { [dg-process-target $selector] == \"S\" } {\n-\t# The target list matched; now check the flags.\n+\t# The target list matched; now check the flags.  The DejaGnu proc\n+\t# check_conditional_xfail will look at the options in compiler_flags,\n+\t# so set that up for this test based on flags we know about.  Start\n+\t# the list with a dummy tool name so the list will match \"*\" if\n+\t# there are no flags.\n+\n+\tglobal compiler_flags\n+\tupvar dg-extra-tool-flags extra_tool_flags\n+\n+\tset compiler_flags \" toolname \"\n+\tappend compiler_flags $extra_tool_flags\n+\tset dest [target_info name]\n+\tif [board_info $dest exists multilib_flags] {\n+\t    append compiler_flags \"[board_info $dest multilib_flags] \"\n+\t}\n+\n+\t# The target list might be an effective-target keyword, so replace\n+\t# the original list with \"*-*-*\".\n \tif [check_conditional_xfail [lreplace $args 1 1 \"*-*-*\"]] {\n \t    upvar dg-do-what dg-do-what\n \t    skip_test_and_clear_xfail\n \t}\n+\n+\t# Any value in this variable was left over from an earlier test.\n+\tset compiler_flags \"\"\n     }\n }\n "}]}