{"sha": "2f42e5de44255be86141a2d2468d0dd575981dc4", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MmY0MmU1ZGU0NDI1NWJlODYxNDFhMmQyNDY4ZDBkZDU3NTk4MWRjNA==", "commit": {"author": {"name": "Trevor Saunders", "email": "tsaunders@mozilla.com", "date": "2015-01-06T02:02:47Z"}, "committer": {"name": "Trevor Saunders", "email": "tbsaunde@gcc.gnu.org", "date": "2015-01-06T02:02:47Z"}, "message": "implement -Wsuggest-override\n\nc-family/\n\n\tPR c++/31397\n\t* c.opt (Wsuggest-override): New option.\n\ncp/\n\n\tPR c++/31397\n\t* class.c (check_for_override): Warn when a virtual function is an\n\toverride not marked override.\n\ngcc/\n\n\tPR c++/31397\n\t* doc/invoke.texi: Document -Wsuggest-override.\n\nFrom-SVN: r219213", "tree": {"sha": "e105777f028705614c3513197fcc19cd6e120408", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e105777f028705614c3513197fcc19cd6e120408"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2f42e5de44255be86141a2d2468d0dd575981dc4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2f42e5de44255be86141a2d2468d0dd575981dc4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2f42e5de44255be86141a2d2468d0dd575981dc4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2f42e5de44255be86141a2d2468d0dd575981dc4/comments", "author": null, "committer": null, "parents": [{"sha": "86cfdb4ea9bfb37fa1c9a573f20dd8e7c745b45f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/86cfdb4ea9bfb37fa1c9a573f20dd8e7c745b45f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/86cfdb4ea9bfb37fa1c9a573f20dd8e7c745b45f"}], "stats": {"total": 54, "additions": 53, "deletions": 1}, "files": [{"sha": "87d60b3dc2251de3269c9876f74d4284c8a3934d", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f42e5de44255be86141a2d2468d0dd575981dc4/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f42e5de44255be86141a2d2468d0dd575981dc4/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=2f42e5de44255be86141a2d2468d0dd575981dc4", "patch": "@@ -1,3 +1,8 @@\n+2015-01-05  Trevor Saunders  <tsaunders@mozilla.com>\n+\n+\tPR c++/31397\n+\t* doc/invoke.texi: Document -Wsuggest-override.\n+\n 2015-01-05  Radovan Obradovic  <radovan.obradovic@imgtec.com>\n \n \tPR rtl-optimization/64287"}, {"sha": "4c86fa511d35800548c6f9cbe2f3807d958548d4", "filename": "gcc/c-family/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f42e5de44255be86141a2d2468d0dd575981dc4/gcc%2Fc-family%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f42e5de44255be86141a2d2468d0dd575981dc4/gcc%2Fc-family%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2FChangeLog?ref=2f42e5de44255be86141a2d2468d0dd575981dc4", "patch": "@@ -1,3 +1,8 @@\n+2015-01-05  Trevor Saunders  <tsaunders@mozilla.com>\n+\n+\tPR c++/31397\n+\t* c.opt (Wsuggest-override): New option.\n+\n 2015-01-05  Jakub Jelinek  <jakub@redhat.com>\n \n \tUpdate copyright years."}, {"sha": "064c69e5a1d920c2d39d35da5ed4da7331239a75", "filename": "gcc/c-family/c.opt", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f42e5de44255be86141a2d2468d0dd575981dc4/gcc%2Fc-family%2Fc.opt", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f42e5de44255be86141a2d2468d0dd575981dc4/gcc%2Fc-family%2Fc.opt", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2Fc.opt?ref=2f42e5de44255be86141a2d2468d0dd575981dc4", "patch": "@@ -578,6 +578,11 @@ Wsuggest-attribute=format\n C ObjC C++ ObjC++ Var(warn_suggest_attribute_format) Warning\n Warn about functions which might be candidates for format attributes\n \n+Wsuggest-override\n+C++ ObjC++ Var(warn_override) Warning\n+Suggest that the override keyword be used when the declaration of a virtual\n+function overrides another.\n+\n Wswitch\n C ObjC C++ ObjC++ Var(warn_switch) Warning LangEnabledBy(C ObjC C++ ObjC++,Wall)\n Warn about enumerated switches, with no default, missing a case"}, {"sha": "004629b884897ba5479bcdf0dfd40d533dcbfc58", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f42e5de44255be86141a2d2468d0dd575981dc4/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f42e5de44255be86141a2d2468d0dd575981dc4/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=2f42e5de44255be86141a2d2468d0dd575981dc4", "patch": "@@ -1,3 +1,9 @@\n+2015-01-05  Trevor Saunders  <tsaunders@mozilla.com>\n+\n+\tPR c++/31397\n+\t* class.c (check_for_override): Warn when a virtual function is an\n+\toverride not marked override.\n+\n 2015-01-05  Trevor Saunders  <tsaunders@mozilla.com>\n \n \t* class.c (warn_hidden): Use auto_vec<tree> instead of tree_list to"}, {"sha": "b798a52702fd9f5010c5e86c45d666310353c3f8", "filename": "gcc/cp/class.c", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f42e5de44255be86141a2d2468d0dd575981dc4/gcc%2Fcp%2Fclass.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f42e5de44255be86141a2d2468d0dd575981dc4/gcc%2Fcp%2Fclass.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fclass.c?ref=2f42e5de44255be86141a2d2468d0dd575981dc4", "patch": "@@ -2811,6 +2811,10 @@ check_for_override (tree decl, tree ctype)\n     {\n       DECL_VINDEX (decl) = decl;\n       overrides_found = true;\n+      if (warn_override && !DECL_OVERRIDE_P (decl)\n+\t  && !DECL_DESTRUCTOR_P (decl))\n+\twarning_at (DECL_SOURCE_LOCATION (decl), OPT_Wsuggest_override,\n+\t\t    \"%q+D can be marked override\", decl);\n     }\n \n   if (DECL_VIRTUAL_P (decl))"}, {"sha": "c7a61b8fd53a54641dae9a6a4e2d110eb11ababd", "filename": "gcc/doc/invoke.texi", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f42e5de44255be86141a2d2468d0dd575981dc4/gcc%2Fdoc%2Finvoke.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f42e5de44255be86141a2d2468d0dd575981dc4/gcc%2Fdoc%2Finvoke.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdoc%2Finvoke.texi?ref=2f42e5de44255be86141a2d2468d0dd575981dc4", "patch": "@@ -277,7 +277,7 @@ Objective-C and Objective-C++ Dialects}.\n -Wstack-protector -Wstack-usage=@var{len} -Wstrict-aliasing @gol\n -Wstrict-aliasing=n @gol -Wstrict-overflow -Wstrict-overflow=@var{n} @gol\n -Wsuggest-attribute=@r{[}pure@r{|}const@r{|}noreturn@r{|}format@r{]} @gol\n--Wsuggest-final-types @gol -Wsuggest-final-methods @gol\n+-Wsuggest-final-types @gol -Wsuggest-final-methods @gol -Wsuggest-override @gol\n -Wmissing-format-attribute @gol\n -Wswitch  -Wswitch-default  -Wswitch-enum -Wswitch-bool -Wsync-nand @gol\n -Wsystem-headers  -Wtrampolines  -Wtrigraphs  -Wtype-limits  -Wundef @gol\n@@ -4282,6 +4282,10 @@ class hierarchy graph is more complete. It is recommended to first consider\n suggestions of @option{-Wsuggest-final-types} and then rebuild with new\n annotations.\n \n+@item -Wsuggest-override\n+Warn about overriding virtual functions that are not marked with the override\n+keyword.\n+\n @item -Warray-bounds\n @opindex Wno-array-bounds\n @opindex Warray-bounds"}, {"sha": "f820f4b82c1169d9110c866dd0409ddd2be1a676", "filename": "gcc/testsuite/g++.dg/warn/Wsuggest-override.C", "status": "added", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f42e5de44255be86141a2d2468d0dd575981dc4/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWsuggest-override.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f42e5de44255be86141a2d2468d0dd575981dc4/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWsuggest-override.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWsuggest-override.C?ref=2f42e5de44255be86141a2d2468d0dd575981dc4", "patch": "@@ -0,0 +1,23 @@\n+// { dg-do compile }\n+// { dg-options \"-std=c++11 -Wsuggest-override\" }\n+struct A\n+{\n+\tA();\n+\tvirtual ~A();\n+\tvirtual void f();\n+\tvirtual int bar();\n+\tint c();\n+\toperator int();\n+\tvirtual operator float();\n+};\n+\n+struct B : A\n+{\n+\tB();\n+\tvirtual ~B();\n+\tvirtual void f(); // { dg-warning \"can be marked override\" }\n+virtual int bar() override;\n+int c();\n+operator int();\n+virtual operator float(); // { dg-warning \"can be marked override\" }\n+};"}]}