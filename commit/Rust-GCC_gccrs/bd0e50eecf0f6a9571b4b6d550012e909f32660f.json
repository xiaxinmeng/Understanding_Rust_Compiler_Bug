{"sha": "bd0e50eecf0f6a9571b4b6d550012e909f32660f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmQwZTUwZWVjZjBmNmE5NTcxYjRiNmQ1NTAwMTJlOTA5ZjMyNjYwZg==", "commit": {"author": {"name": "Mark Shinwell", "email": "shinwell@codesourcery.com", "date": "2008-07-07T11:15:21Z"}, "committer": {"name": "Nathan Sidwell", "email": "nathan@gcc.gnu.org", "date": "2008-07-07T11:15:21Z"}, "message": "* config/m68k/lb1sf68.asm: Add PIC macros for Linux targets.\n\nFrom-SVN: r137558", "tree": {"sha": "5ba1e7d4b769ab29f8b21191c8b8852c0a494307", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5ba1e7d4b769ab29f8b21191c8b8852c0a494307"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bd0e50eecf0f6a9571b4b6d550012e909f32660f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bd0e50eecf0f6a9571b4b6d550012e909f32660f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bd0e50eecf0f6a9571b4b6d550012e909f32660f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bd0e50eecf0f6a9571b4b6d550012e909f32660f/comments", "author": null, "committer": null, "parents": [{"sha": "368b55f6b083a01df284be8d536b4977da612894", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/368b55f6b083a01df284be8d536b4977da612894", "html_url": "https://github.com/Rust-GCC/gccrs/commit/368b55f6b083a01df284be8d536b4977da612894"}], "stats": {"total": 40, "additions": 35, "deletions": 5}, "files": [{"sha": "3e5a68d790e65e8fa490de57c92dba8f3e1025a4", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bd0e50eecf0f6a9571b4b6d550012e909f32660f/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bd0e50eecf0f6a9571b4b6d550012e909f32660f/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=bd0e50eecf0f6a9571b4b6d550012e909f32660f", "patch": "@@ -1,3 +1,7 @@\n+2008-07-07  Mark Shinwell  <shinwell@codesourcery.com>\n+\n+\t* config/m68k/lb1sf68.asm: Add PIC macros for Linux targets.\n+\n 2008-07-07  Maxim Kuvyrkov  <maxim@codesourcery.com>\n \t    Nathan Sidwell  <nathan@codesourcery.com>\n "}, {"sha": "e03b7b30d874737118f48c457a46afa1b5e1eae7", "filename": "gcc/config/m68k/lb1sf68.asm", "status": "modified", "additions": 31, "deletions": 5, "changes": 36, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bd0e50eecf0f6a9571b4b6d550012e909f32660f/gcc%2Fconfig%2Fm68k%2Flb1sf68.asm", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bd0e50eecf0f6a9571b4b6d550012e909f32660f/gcc%2Fconfig%2Fm68k%2Flb1sf68.asm", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fm68k%2Flb1sf68.asm?ref=bd0e50eecf0f6a9571b4b6d550012e909f32660f", "patch": "@@ -129,10 +129,11 @@ Boston, MA 02110-1301, USA.  */\n \n #else /* __PIC__ */\n \n-\t/* Common for -mid-shared-libary and -msep-data */\n+\t/* Common for Linux and uClinux, the latter with either\n+\t   -mid-shared-library or -msep-data.  */\n \n \t.macro PICCALL addr\n-#if defined (__mcoldfire__) && !defined (__mcfisab__)\n+#if defined (__mcoldfire__) && !defined (__mcfisab__) && !defined (__mcfisac__)\n \tlea\t\\addr-.-8,a0\n \tjsr\tpc@(a0)\n #else\n@@ -141,6 +142,9 @@ Boston, MA 02110-1301, USA.  */\n \t.endm\n \n \t.macro PICJUMP addr\n+\t/* ISA C has no bra.l instruction, and since this assembly file\n+\t   gets assembled into multiple object files, we avoid the\n+\t   bra instruction entirely.  */\n #if defined (__mcoldfire__) && !defined (__mcfisab__)\n \tlea\t\\addr-.-8,a0\n \tjmp\tpc@(a0)\n@@ -149,7 +153,11 @@ Boston, MA 02110-1301, USA.  */\n #endif\n \t.endm\n \n-# if defined(__ID_SHARED_LIBRARY__)\n+# if defined (__uClinux__)\n+\n+\t/* Versions for uClinux */\n+\n+#  if defined(__ID_SHARED_LIBRARY__)\n \n \t/* -mid-shared-library versions  */\n \n@@ -163,7 +171,7 @@ Boston, MA 02110-1301, USA.  */\n \tmovel\t\\sym@GOT(\\areg), sp@-\n \t.endm\n \n-# else /* !__ID_SHARED_LIBRARY__ */\n+#  else /* !__ID_SHARED_LIBRARY__ */\n \n \t/* Versions for -msep-data */\n \n@@ -175,7 +183,25 @@ Boston, MA 02110-1301, USA.  */\n \tmovel\t\\sym@GOT(a5), sp@-\n \t.endm\n \n-# endif /* !__ID_SHARED_LIBRARY__ */\n+#  endif\n+\n+# else /* !__uClinux__ */\n+\n+\t/* Versions for Linux */\n+\n+\t.macro PICLEA sym, reg\n+\tmovel\t#_GLOBAL_OFFSET_TABLE_@GOTPC, \\reg\n+\tlea\t(-6, pc, \\reg), \\reg\n+\tmovel\t\\sym@GOT(\\reg), \\reg\n+\t.endm\n+\n+\t.macro PICPEA sym, areg\n+\tmovel\t#_GLOBAL_OFFSET_TABLE_@GOTPC, \\areg\n+\tlea\t(-6, pc, \\areg), \\areg\n+\tmovel\t\\sym@GOT(\\areg), sp@-\n+\t.endm\n+\n+# endif\n #endif /* __PIC__ */\n \n "}]}