{"sha": "12a88e6e208fa45a449775bfb9353c777a6081aa", "node_id": "C_kwDOANBUbNoAKDEyYTg4ZTZlMjA4ZmE0NWE0NDk3NzViZmI5MzUzYzc3N2E2MDgxYWE", "commit": {"author": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2022-02-17T17:37:42Z"}, "committer": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2022-02-17T23:44:25Z"}, "message": "libstdc++: Deprecate non-standard std::vector<bool>::insert(pos) [PR104559]\n\nThe SGI STL and pre-1998 drafts of the C++ standard had a default\nargument for vector<bool>::insert(iterator, const bool&) which was\nremove by N1051. The default argument is still present in libstdc++ for\nsome reason. There are no tests verifying it as an extension, so I don't\nthink it has been kept intentionally.\n\nThis removes the default argument but adds an overload without the\nsecond parameter, and adds the deprecated attribute to it. This allows\nany code using it to keep working (for now) but with a warning.\n\nlibstdc++-v3/ChangeLog:\n\n\tPR libstdc++/104559\n\t* doc/xml/manual/evolution.xml: Document deprecation.\n\t* doc/html/manual/api.html: Regenerate.\n\t* include/bits/stl_bvector.h (insert(const_iterator, const bool&)):\n\tRemove default argument.\n\t(insert(const_iterator)): New overload with deprecated attribute.\n\t* testsuite/23_containers/vector/bool/modifiers/insert/104559.cc:\n\tNew test.", "tree": {"sha": "e941071396352f3309d3c49a14f8e7c08936b23e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e941071396352f3309d3c49a14f8e7c08936b23e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/12a88e6e208fa45a449775bfb9353c777a6081aa", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/12a88e6e208fa45a449775bfb9353c777a6081aa", "html_url": "https://github.com/Rust-GCC/gccrs/commit/12a88e6e208fa45a449775bfb9353c777a6081aa", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/12a88e6e208fa45a449775bfb9353c777a6081aa/comments", "author": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2c9b7077b72529fbbe896212a0088bff6025c5e7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2c9b7077b72529fbbe896212a0088bff6025c5e7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2c9b7077b72529fbbe896212a0088bff6025c5e7"}], "stats": {"total": 30, "additions": 28, "deletions": 2}, "files": [{"sha": "bbda6f5acf3e4a1d30fb02f74a3a5f1decbe0f29", "filename": "libstdc++-v3/doc/html/manual/api.html", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/12a88e6e208fa45a449775bfb9353c777a6081aa/libstdc%2B%2B-v3%2Fdoc%2Fhtml%2Fmanual%2Fapi.html", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/12a88e6e208fa45a449775bfb9353c777a6081aa/libstdc%2B%2B-v3%2Fdoc%2Fhtml%2Fmanual%2Fapi.html", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fdoc%2Fhtml%2Fmanual%2Fapi.html?ref=12a88e6e208fa45a449775bfb9353c777a6081aa", "patch": "@@ -454,6 +454,9 @@\n were deprecated for C++17.\n </p><p>\n Non-standard <code class=\"code\">std::pair</code> constructors were deprecated.\n+A non-standard default argument for\n+<code class=\"code\">vector&lt;bool&gt;::insert(const_iterator, const bool&amp;)</code>\n+was deprecated.\n </p><p>\n The <code class=\"literal\">bitmap</code>, <code class=\"literal\">mt</code>, and <code class=\"literal\">pool</code>\n options for <code class=\"option\">--enable-libstdcxx-allocator</code> were removed."}, {"sha": "4923e8c478347a88224d4dbe7839c3fa48d67f72", "filename": "libstdc++-v3/doc/xml/manual/evolution.xml", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/12a88e6e208fa45a449775bfb9353c777a6081aa/libstdc%2B%2B-v3%2Fdoc%2Fxml%2Fmanual%2Fevolution.xml", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/12a88e6e208fa45a449775bfb9353c777a6081aa/libstdc%2B%2B-v3%2Fdoc%2Fxml%2Fmanual%2Fevolution.xml", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fdoc%2Fxml%2Fmanual%2Fevolution.xml?ref=12a88e6e208fa45a449775bfb9353c777a6081aa", "patch": "@@ -1045,6 +1045,9 @@ were deprecated for C++17.\n \n <para>\n Non-standard <code>std::pair</code> constructors were deprecated.\n+A non-standard default argument for\n+<code>vector&lt;bool&gt;::insert(const_iterator, const bool&amp;)</code>\n+was deprecated.\n </para>\n \n <para>"}, {"sha": "d256af40f407b9110f0f21d1c1303448847a966b", "filename": "libstdc++-v3/include/bits/stl_bvector.h", "status": "modified", "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/12a88e6e208fa45a449775bfb9353c777a6081aa/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstl_bvector.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/12a88e6e208fa45a449775bfb9353c777a6081aa/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstl_bvector.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstl_bvector.h?ref=12a88e6e208fa45a449775bfb9353c777a6081aa", "patch": "@@ -1135,9 +1135,9 @@ _GLIBCXX_BEGIN_NAMESPACE_CONTAINER\n       _GLIBCXX20_CONSTEXPR\n       iterator\n #if __cplusplus >= 201103L\n-      insert(const_iterator __position, const bool& __x = bool())\n+      insert(const_iterator __position, const bool& __x)\n #else\n-      insert(iterator __position, const bool& __x = bool())\n+      insert(iterator __position, const bool& __x)\n #endif\n       {\n \tconst difference_type __n = __position - begin();\n@@ -1149,6 +1149,13 @@ _GLIBCXX_BEGIN_NAMESPACE_CONTAINER\n \treturn begin() + __n;\n       }\n \n+#if _GLIBCXX_USE_DEPRECATED\n+      _GLIBCXX_DEPRECATED_SUGGEST(\"insert(position, false)\")\n+      iterator\n+      insert(const_iterator __position)\n+      { return this->insert(__position._M_const_cast(), false); }\n+#endif\n+\n #if __cplusplus >= 201103L\n       template<typename _InputIterator,\n \t       typename = std::_RequireInputIter<_InputIterator>>"}, {"sha": "1121827477f2a780000d4ce57d2cea33cad639b4", "filename": "libstdc++-v3/testsuite/23_containers/vector/bool/modifiers/insert/104559.cc", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/12a88e6e208fa45a449775bfb9353c777a6081aa/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Fvector%2Fbool%2Fmodifiers%2Finsert%2F104559.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/12a88e6e208fa45a449775bfb9353c777a6081aa/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Fvector%2Fbool%2Fmodifiers%2Finsert%2F104559.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Fvector%2Fbool%2Fmodifiers%2Finsert%2F104559.cc?ref=12a88e6e208fa45a449775bfb9353c777a6081aa", "patch": "@@ -0,0 +1,13 @@\n+// { dg-options \"-Wdeprecated\" }\n+// { dg-do compile }\n+// { dg-require-normal-mode \"\" }\n+\n+#include <vector>\n+\n+void\n+test01()\n+{\n+  std::vector<bool> v;\n+  v.insert(v.begin(), false);\n+  v.insert(v.begin());  // { dg-warning \"deprecated\" }\n+}"}]}