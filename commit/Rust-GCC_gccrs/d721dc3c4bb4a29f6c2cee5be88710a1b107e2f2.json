{"sha": "d721dc3c4bb4a29f6c2cee5be88710a1b107e2f2", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDcyMWRjM2M0YmI0YTI5ZjZjMmNlZTViZTg4NzEwYTFiMTA3ZTJmMg==", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2017-03-09T16:19:37Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2017-03-09T16:19:37Z"}, "message": "re PR tree-optimization/79977 ([graphite] ICE in outermost_loop_in_sese, at sese.c:300 w/ -O2 -floop-nest-optimize)\n\n2017-03-09  Richard Biener  <rguenther@suse.de>\n\n\tPR tree-optimization/79977\n\t* graphite-scop-detection.c (scop_detection::merge_sese):\n\tHandle the case of extra exits to blocks dominating the entry.\n\n\t* gcc.dg/graphite/pr79977.c: New testcase.\n\nFrom-SVN: r246006", "tree": {"sha": "0179a516678a98ec5091603a550032b3990ebb78", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0179a516678a98ec5091603a550032b3990ebb78"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d721dc3c4bb4a29f6c2cee5be88710a1b107e2f2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d721dc3c4bb4a29f6c2cee5be88710a1b107e2f2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d721dc3c4bb4a29f6c2cee5be88710a1b107e2f2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d721dc3c4bb4a29f6c2cee5be88710a1b107e2f2/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "e0472d7e8cefd8f4eed658424b8283fcd8ca4b15", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e0472d7e8cefd8f4eed658424b8283fcd8ca4b15", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e0472d7e8cefd8f4eed658424b8283fcd8ca4b15"}], "stats": {"total": 57, "additions": 57, "deletions": 0}, "files": [{"sha": "2c1b515b9107cda0803be312fd2c58c229fb7b1a", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d721dc3c4bb4a29f6c2cee5be88710a1b107e2f2/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d721dc3c4bb4a29f6c2cee5be88710a1b107e2f2/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=d721dc3c4bb4a29f6c2cee5be88710a1b107e2f2", "patch": "@@ -1,3 +1,9 @@\n+2017-03-09  Richard Biener  <rguenther@suse.de>\n+\n+\tPR tree-optimization/79977\n+\t* graphite-scop-detection.c (scop_detection::merge_sese):\n+\tHandle the case of extra exits to blocks dominating the entry.\n+\n 2017-03-09  Toma Tabacu  <toma.tabacu@imgtec.com>\n \n \t* doc/sourcebuild.texi (Effective-Target Keywords, Other attributes):"}, {"sha": "6b722b47965e92364e5e73206988fb08cc40a779", "filename": "gcc/graphite-scop-detection.c", "status": "modified", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d721dc3c4bb4a29f6c2cee5be88710a1b107e2f2/gcc%2Fgraphite-scop-detection.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d721dc3c4bb4a29f6c2cee5be88710a1b107e2f2/gcc%2Fgraphite-scop-detection.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgraphite-scop-detection.c?ref=d721dc3c4bb4a29f6c2cee5be88710a1b107e2f2", "patch": "@@ -817,6 +817,25 @@ scop_detection::merge_sese (sese_l first, sese_l second) const\n \t != loop_depth (exit->dest->loop_father))\n     return invalid_sese;\n \n+  /* For now we just bail out when there is a loop exit in the region\n+     that is not also the exit of the region.  We could enlarge the\n+     region to cover the loop that region exits to.  See PR79977.  */\n+  if (loop_outer (entry->src->loop_father))\n+    {\n+      vec<edge> exits = get_loop_exit_edges (entry->src->loop_father);\n+      for (unsigned i = 0; i < exits.length (); ++i)\n+\t{\n+\t  if (exits[i] != exit\n+\t      && bb_in_region (exits[i]->src, entry->dest, exit->src))\n+\t    {\n+\t      DEBUG_PRINT (dp << \"[scop-detection-fail] cannot merge seses.\\n\");\n+\t      exits.release ();\n+\t      return invalid_sese;\n+\t    }\n+\t}\n+      exits.release ();\n+    }\n+\n   /* For now we just want to bail out when exit does not post-dominate entry.\n      TODO: We might just add a basic_block at the exit to make exit\n      post-dominate entry (the entire region).  */"}, {"sha": "5050929f1a88504b997c2ca8e8cff48fa20605a1", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d721dc3c4bb4a29f6c2cee5be88710a1b107e2f2/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d721dc3c4bb4a29f6c2cee5be88710a1b107e2f2/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=d721dc3c4bb4a29f6c2cee5be88710a1b107e2f2", "patch": "@@ -1,3 +1,8 @@\n+2017-03-09  Richard Biener  <rguenther@suse.de>\n+\n+\tPR tree-optimization/79977\n+\t* gcc.dg/graphite/pr79977.c: New testcase.\n+\n 2017-03-09  Toma Tabacu  <toma.tabacu@imgtec.com>\n \n \t* g++.dg/lto/pr69589_0.C: Add dg-require-effective-target for"}, {"sha": "09606b0739bd5e93bf54734e7d5add78aa25918b", "filename": "gcc/testsuite/gcc.dg/graphite/pr79977.c", "status": "added", "additions": 27, "deletions": 0, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d721dc3c4bb4a29f6c2cee5be88710a1b107e2f2/gcc%2Ftestsuite%2Fgcc.dg%2Fgraphite%2Fpr79977.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d721dc3c4bb4a29f6c2cee5be88710a1b107e2f2/gcc%2Ftestsuite%2Fgcc.dg%2Fgraphite%2Fpr79977.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fgraphite%2Fpr79977.c?ref=d721dc3c4bb4a29f6c2cee5be88710a1b107e2f2", "patch": "@@ -0,0 +1,27 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -floop-nest-optimize\" } */\n+\n+int uo[3];\n+int di;\n+\n+void\n+i7 (int mp)\n+{\n+  int l4;\n+\n+wh:\n+  while (l4 > 1)\n+    {\n+      for (di = 0; di < 2; ++di)\n+\tuo[di] = 0;\n+\n+      for (di = 0; di < 3; ++di)\n+\t{\n+\t  uo[di] = 0;\n+\t  if (mp != 0)\n+\t    goto wh;\n+\t}\n+\n+      --l4;\n+    }\n+}"}]}