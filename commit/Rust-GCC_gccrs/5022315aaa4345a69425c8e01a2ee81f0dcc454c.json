{"sha": "5022315aaa4345a69425c8e01a2ee81f0dcc454c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTAyMjMxNWFhYTQzNDVhNjk0MjVjOGUwMWEyZWU4MWYwZGNjNDU0Yw==", "commit": {"author": {"name": "Rainer Orth", "email": "ro@CeBiTec.Uni-Bielefeld.DE", "date": "2013-03-21T11:57:35Z"}, "committer": {"name": "Rainer Orth", "email": "ro@gcc.gnu.org", "date": "2013-03-21T11:57:35Z"}, "message": "Default to DWARF 4 on Solaris if linker supports CIEv3\n\n\t* configure.ac (gcc_cv_ld_eh_frame_ciev3): New test.\n\t* configure: Regenerate.\n\t* config.in: Regenerate.\n\t* config/sol2.c (solaris_override_options): Only enforce DWARF 2\n\tif !HAVE_LD_EH_FRAME_CIEV3.\n\nFrom-SVN: r196866", "tree": {"sha": "9be6d4aa2a0cb4293f5051bcf62c9edbd152923f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9be6d4aa2a0cb4293f5051bcf62c9edbd152923f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5022315aaa4345a69425c8e01a2ee81f0dcc454c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5022315aaa4345a69425c8e01a2ee81f0dcc454c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5022315aaa4345a69425c8e01a2ee81f0dcc454c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5022315aaa4345a69425c8e01a2ee81f0dcc454c/comments", "author": {"login": "rorth", "id": 3930951, "node_id": "MDQ6VXNlcjM5MzA5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/3930951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rorth", "html_url": "https://github.com/rorth", "followers_url": "https://api.github.com/users/rorth/followers", "following_url": "https://api.github.com/users/rorth/following{/other_user}", "gists_url": "https://api.github.com/users/rorth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rorth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rorth/subscriptions", "organizations_url": "https://api.github.com/users/rorth/orgs", "repos_url": "https://api.github.com/users/rorth/repos", "events_url": "https://api.github.com/users/rorth/events{/privacy}", "received_events_url": "https://api.github.com/users/rorth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "50d4421cb29f3d9bc1fd5b06dbde5b19b82a14e3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/50d4421cb29f3d9bc1fd5b06dbde5b19b82a14e3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/50d4421cb29f3d9bc1fd5b06dbde5b19b82a14e3"}], "stats": {"total": 96, "additions": 93, "deletions": 3}, "files": [{"sha": "11230fb78b64296d80f07dc474cf906ad8344611", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5022315aaa4345a69425c8e01a2ee81f0dcc454c/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5022315aaa4345a69425c8e01a2ee81f0dcc454c/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=5022315aaa4345a69425c8e01a2ee81f0dcc454c", "patch": "@@ -1,3 +1,11 @@\n+2013-03-21  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>\n+\n+\t* configure.ac (gcc_cv_ld_eh_frame_ciev3): New test.\n+\t* configure: Regenerate.\n+\t* config.in: Regenerate.\n+\t* config/sol2.c (solaris_override_options): Only enforce DWARF 2\n+\tif !HAVE_LD_EH_FRAME_CIEV3.\n+\n 2013-03-21  Richard Biener  <rguenther@suse.de>\n \n \t* tree-cfg.c (verify_expr_no_block): New function."}, {"sha": "de8271bcfe250e8229090c524e282a799c8afbf9", "filename": "gcc/config.in", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5022315aaa4345a69425c8e01a2ee81f0dcc454c/gcc%2Fconfig.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5022315aaa4345a69425c8e01a2ee81f0dcc454c/gcc%2Fconfig.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig.in?ref=5022315aaa4345a69425c8e01a2ee81f0dcc454c", "patch": "@@ -1223,6 +1223,12 @@\n #endif\n \n \n+/* Define 0/1 if your linker supports CIE v3 in .eh_frame. */\n+#ifndef USED_FOR_TARGET\n+#undef HAVE_LD_EH_FRAME_CIEV3\n+#endif\n+\n+\n /* Define if your linker supports .eh_frame_hdr. */\n #undef HAVE_LD_EH_FRAME_HDR\n "}, {"sha": "718134e2b907efb882dc80c6e3eda16b2dd726af", "filename": "gcc/config/sol2.c", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5022315aaa4345a69425c8e01a2ee81f0dcc454c/gcc%2Fconfig%2Fsol2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5022315aaa4345a69425c8e01a2ee81f0dcc454c/gcc%2Fconfig%2Fsol2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fsol2.c?ref=5022315aaa4345a69425c8e01a2ee81f0dcc454c", "patch": "@@ -286,8 +286,8 @@ solaris_file_end (void)\n void\n solaris_override_options (void)\n {\n-  /* Don't emit DWARF3/4 unless specifically selected.  Solaris ld cannot\n-     handle CIE version 3 in .eh_frame.  */\n-  if (!global_options_set.x_dwarf_version)\n+  /* Older versions of Solaris ld cannot handle CIE version 3 in .eh_frame.\n+     Don't emit DWARF3/4 unless specifically selected if so.  */\n+  if (!HAVE_LD_EH_FRAME_CIEV3 && !global_options_set.x_dwarf_version)\n     dwarf_version = 2;\n }"}, {"sha": "eac96cdac707dca49605553e0ea9a39d30284df6", "filename": "gcc/configure", "status": "modified", "additions": 40, "deletions": 0, "changes": 40, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5022315aaa4345a69425c8e01a2ee81f0dcc454c/gcc%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5022315aaa4345a69425c8e01a2ee81f0dcc454c/gcc%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfigure?ref=5022315aaa4345a69425c8e01a2ee81f0dcc454c", "patch": "@@ -26350,6 +26350,46 @@ fi\n { $as_echo \"$as_me:${as_lineno-$LINENO}: result: $gcc_cv_ld_eh_frame_hdr\" >&5\n $as_echo \"$gcc_cv_ld_eh_frame_hdr\" >&6; }\n \n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: checking linker CIEv3 in .eh_frame support\" >&5\n+$as_echo_n \"checking linker CIEv3 in .eh_frame support... \" >&6; }\n+gcc_cv_ld_eh_frame_ciev3=no\n+if test $in_tree_ld = yes ; then\n+  if test \"$gcc_cv_gld_major_version\" -eq 2 -a \"$gcc_cv_gld_minor_version\" -ge 16 -o \"$gcc_cv_gld_major_version\" -gt 2 \\\n+     && test $in_tree_ld_is_elf = yes; then\n+    gcc_cv_ld_eh_frame_ciev3=yes\n+  fi\n+elif test x$gcc_cv_ld != x; then\n+  if echo \"$ld_ver\" | grep GNU > /dev/null; then\n+    gcc_cv_ld_eh_frame_ciev3=yes\n+    if test 0\"$ld_date\" -lt 20040513; then\n+      if test -n \"$ld_date\"; then\n+\t# If there was date string, but was earlier than 2004-05-13, fail\n+\tgcc_cv_ld_eh_frame_ciev3=no\n+      elif test \"$ld_vers_major\" -lt 2; then\n+\tgcc_cv_ld_eh_frame_ciev3=no\n+      elif test \"$ld_vers_major\" -eq 2 -a \"$ld_vers_minor\" -lt 16; then\n+\tgcc_cv_ld_eh_frame_ciev3=no\n+      fi\n+    fi\n+  else\n+    case \"$target\" in\n+      *-*-solaris2*)\n+        # Sun ld added support for CIE v3 in .eh_frame in Solaris 11.1.\n+        if test \"$ld_vers_major\" -gt 1 || test \"$ld_vers_minor\" -ge 2324; then\n+          gcc_cv_ld_eh_frame_ciev3=yes\n+        fi\n+        ;;\n+    esac\n+  fi\n+fi\n+\n+cat >>confdefs.h <<_ACEOF\n+#define HAVE_LD_EH_FRAME_CIEV3 `if test x\"$gcc_cv_ld_eh_frame_ciev3\" = xyes; then echo 1; else echo 0; fi`\n+_ACEOF\n+\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $gcc_cv_ld_eh_frame_ciev3\" >&5\n+$as_echo \"$gcc_cv_ld_eh_frame_ciev3\" >&6; }\n+\n { $as_echo \"$as_me:${as_lineno-$LINENO}: checking linker position independent executable support\" >&5\n $as_echo_n \"checking linker position independent executable support... \" >&6; }\n gcc_cv_ld_pie=no"}, {"sha": "40a1af7a4a4fe9f996896e7be4a5fd4deab8628c", "filename": "gcc/configure.ac", "status": "modified", "additions": 36, "deletions": 0, "changes": 36, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5022315aaa4345a69425c8e01a2ee81f0dcc454c/gcc%2Fconfigure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5022315aaa4345a69425c8e01a2ee81f0dcc454c/gcc%2Fconfigure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfigure.ac?ref=5022315aaa4345a69425c8e01a2ee81f0dcc454c", "patch": "@@ -4349,6 +4349,42 @@ if test x\"$gcc_cv_ld_eh_frame_hdr\" = xyes; then\n fi\n AC_MSG_RESULT($gcc_cv_ld_eh_frame_hdr)\n \n+AC_MSG_CHECKING(linker CIEv3 in .eh_frame support)\n+gcc_cv_ld_eh_frame_ciev3=no\n+if test $in_tree_ld = yes ; then\n+  if test \"$gcc_cv_gld_major_version\" -eq 2 -a \"$gcc_cv_gld_minor_version\" -ge 16 -o \"$gcc_cv_gld_major_version\" -gt 2 \\\n+     && test $in_tree_ld_is_elf = yes; then\n+    gcc_cv_ld_eh_frame_ciev3=yes\n+  fi\n+elif test x$gcc_cv_ld != x; then\n+  if echo \"$ld_ver\" | grep GNU > /dev/null; then\n+    gcc_cv_ld_eh_frame_ciev3=yes\n+    if test 0\"$ld_date\" -lt 20040513; then\n+      if test -n \"$ld_date\"; then\n+\t# If there was date string, but was earlier than 2004-05-13, fail\n+\tgcc_cv_ld_eh_frame_ciev3=no\n+      elif test \"$ld_vers_major\" -lt 2; then\n+\tgcc_cv_ld_eh_frame_ciev3=no\n+      elif test \"$ld_vers_major\" -eq 2 -a \"$ld_vers_minor\" -lt 16; then\n+\tgcc_cv_ld_eh_frame_ciev3=no\n+      fi\n+    fi\n+  else\n+    case \"$target\" in\n+      *-*-solaris2*)\n+        # Sun ld added support for CIE v3 in .eh_frame in Solaris 11.1.\n+        if test \"$ld_vers_major\" -gt 1 || test \"$ld_vers_minor\" -ge 2324; then\n+          gcc_cv_ld_eh_frame_ciev3=yes\n+        fi\n+        ;;\n+    esac\n+  fi\n+fi\n+AC_DEFINE_UNQUOTED(HAVE_LD_EH_FRAME_CIEV3,\n+  [`if test x\"$gcc_cv_ld_eh_frame_ciev3\" = xyes; then echo 1; else echo 0; fi`],\n+  [Define 0/1 if your linker supports CIE v3 in .eh_frame.])\n+AC_MSG_RESULT($gcc_cv_ld_eh_frame_ciev3)\n+\n AC_MSG_CHECKING(linker position independent executable support)\n gcc_cv_ld_pie=no\n if test $in_tree_ld = yes ; then"}]}