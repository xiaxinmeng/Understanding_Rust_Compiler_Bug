{"sha": "49522de2d26fdf96e31170fb9692b56084a705ec", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDk1MjJkZTJkMjZmZGY5NmUzMTE3MGZiOTY5MmI1NjA4NGE3MDVlYw==", "commit": {"author": {"name": "Geoffrey Keating", "email": "geoffk@apple.com", "date": "2007-03-13T07:13:16Z"}, "committer": {"name": "Geoffrey Keating", "email": "geoffk@gcc.gnu.org", "date": "2007-03-13T07:13:16Z"}, "message": "darwin-fallback.c: Compile file only on powerpc.\n\n\t* config/rs6000/darwin-fallback.c: Compile file only on powerpc.\n\t(handle_syscall): Handle direct system calls.\n\t* config/rs6000/darwin.h (HAS_MD_FALLBACK_FRAME_STATE_FOR): Delete.\n\nFrom-SVN: r122877", "tree": {"sha": "792b496a47d8363a74d033b600611607288e0ebc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/792b496a47d8363a74d033b600611607288e0ebc"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/49522de2d26fdf96e31170fb9692b56084a705ec", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/49522de2d26fdf96e31170fb9692b56084a705ec", "html_url": "https://github.com/Rust-GCC/gccrs/commit/49522de2d26fdf96e31170fb9692b56084a705ec", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/49522de2d26fdf96e31170fb9692b56084a705ec/comments", "author": {"login": "geoffk01", "id": 31905243, "node_id": "MDQ6VXNlcjMxOTA1MjQz", "avatar_url": "https://avatars.githubusercontent.com/u/31905243?v=4", "gravatar_id": "", "url": "https://api.github.com/users/geoffk01", "html_url": "https://github.com/geoffk01", "followers_url": "https://api.github.com/users/geoffk01/followers", "following_url": "https://api.github.com/users/geoffk01/following{/other_user}", "gists_url": "https://api.github.com/users/geoffk01/gists{/gist_id}", "starred_url": "https://api.github.com/users/geoffk01/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/geoffk01/subscriptions", "organizations_url": "https://api.github.com/users/geoffk01/orgs", "repos_url": "https://api.github.com/users/geoffk01/repos", "events_url": "https://api.github.com/users/geoffk01/events{/privacy}", "received_events_url": "https://api.github.com/users/geoffk01/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "442a795bc6016a0898485d626c55e00af542d91a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/442a795bc6016a0898485d626c55e00af542d91a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/442a795bc6016a0898485d626c55e00af542d91a"}], "stats": {"total": 30, "additions": 23, "deletions": 7}, "files": [{"sha": "6b82882b3fa510ea59d20a3db16055821e493501", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/49522de2d26fdf96e31170fb9692b56084a705ec/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/49522de2d26fdf96e31170fb9692b56084a705ec/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=49522de2d26fdf96e31170fb9692b56084a705ec", "patch": "@@ -1,3 +1,9 @@\n+2007-03-11  Geoffrey Keating  <geoffk@apple.com>\n+\n+\t* config/rs6000/darwin-fallback.c: Compile file only on powerpc.\n+\t(handle_syscall): Handle direct system calls.\n+\t* config/rs6000/darwin.h (HAS_MD_FALLBACK_FRAME_STATE_FOR): Delete.\n+\n 2007-03-12  Brooks Moses  <brooks.moses@codesourcery.com>\n \n \t* doc/invoke.texi: Fix cpp.info cross-reference."}, {"sha": "0fc56b0c4452ec275357d5128deff2cf09335971", "filename": "gcc/config/rs6000/darwin-fallback.c", "status": "modified", "additions": 17, "deletions": 5, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/49522de2d26fdf96e31170fb9692b56084a705ec/gcc%2Fconfig%2Frs6000%2Fdarwin-fallback.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/49522de2d26fdf96e31170fb9692b56084a705ec/gcc%2Fconfig%2Frs6000%2Fdarwin-fallback.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Fdarwin-fallback.c?ref=49522de2d26fdf96e31170fb9692b56084a705ec", "patch": "@@ -1,5 +1,5 @@\n /* Fallback frame-state unwinder for Darwin.\n-   Copyright (C) 2004, 2005 Free Software Foundation, Inc.\n+   Copyright (C) 2004, 2005, 2007 Free Software Foundation, Inc.\n \n    This file is part of GCC.\n \n@@ -27,6 +27,8 @@\n    Software Foundation, 51 Franklin Street, Fifth Floor, Boston, MA\n    02110-1301, USA.  */\n \n+#ifdef __ppc__\n+\n #include \"tconfig.h\"\n #include \"tsystem.h\"\n #include \"coretypes.h\"\n@@ -327,9 +329,9 @@ handle_syscall (_Unwind_FrameState *fs, const reg_unit gprs[32],\n   static _Unwind_Ptr return_addr;\n   \n   /* Yay!  We're in a Libc that we understand, and it's made a\n-     system call.  It'll be one of two kinds: either a Jaguar-style\n-     SYS_sigreturn, or a Panther-style 'syscall' call with 184, which \n-     is also SYS_sigreturn.  */\n+     system call.  In Jaguar, this is a direct system call with value 103;\n+     in Panther and Tiger it is a SYS_syscall call for system call number 184,\n+     and in Leopard it is a direct syscall with number 184.  */\n   \n   if (gprs[0] == 0x67 /* SYS_SIGRETURN */)\n     {\n@@ -339,7 +341,7 @@ handle_syscall (_Unwind_FrameState *fs, const reg_unit gprs[32],\n       is_64 = (uctx->mcsize == UC_FLAVOR64_VEC_SIZE\n \t       || uctx->mcsize == UC_FLAVOR64_SIZE);\n     }\n-  else if (gprs[0] == 0 && gprs[3] == 184)\n+  else if (gprs[0] == 0 /* SYS_syscall */ && gprs[3] == 184)\n     {\n       int ctxstyle = gprs[5];\n       uctx = (struct gcc_ucontext *) gprs[4];\n@@ -348,6 +350,15 @@ handle_syscall (_Unwind_FrameState *fs, const reg_unit gprs[32],\n       is_64 = (ctxstyle == UC_FLAVOR64_VEC || ctxstyle == UC_TRAD64_VEC\n \t       || ctxstyle == UC_FLAVOR64 || ctxstyle == UC_TRAD64);\n     }\n+  else if (gprs[0] == 184 /* SYS_sigreturn */)\n+    {\n+      int ctxstyle = gprs[4];\n+      uctx = (struct gcc_ucontext *) gprs[3];\n+      is_vector = (ctxstyle == UC_FLAVOR_VEC || ctxstyle == UC_FLAVOR64_VEC\n+\t\t   || ctxstyle == UC_TRAD_VEC || ctxstyle == UC_TRAD64_VEC);\n+      is_64 = (ctxstyle == UC_FLAVOR64_VEC || ctxstyle == UC_TRAD64_VEC\n+\t       || ctxstyle == UC_FLAVOR64 || ctxstyle == UC_TRAD64);\n+    }\n   else\n     return false;\n \n@@ -469,3 +480,4 @@ _Unwind_fallback_frame_state_for (struct _Unwind_Context *context,\n     return false;\n   return handle_syscall (fs, gprs, _Unwind_GetCFA (context));\n }\n+#endif"}, {"sha": "6608481fe5ff3f64d588f77920630aebd6328571", "filename": "gcc/config/rs6000/darwin.h", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/49522de2d26fdf96e31170fb9692b56084a705ec/gcc%2Fconfig%2Frs6000%2Fdarwin.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/49522de2d26fdf96e31170fb9692b56084a705ec/gcc%2Fconfig%2Frs6000%2Fdarwin.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Fdarwin.h?ref=49522de2d26fdf96e31170fb9692b56084a705ec", "patch": "@@ -412,8 +412,6 @@\n #define MD_UNWIND_SUPPORT \"config/rs6000/darwin-unwind.h\"\n #endif\n \n-#define HAS_MD_FALLBACK_FRAME_STATE_FOR 1\n-\n /* True, iff we're generating fast turn around debugging code.  When\n    true, we arrange for function prologues to start with 5 nops so\n    that gdb may insert code to redirect them, and for data to be"}]}