{"sha": "98ae96d2ade339df1a2d3a46e6a7faa60aece139", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OThhZTk2ZDJhZGUzMzlkZjFhMmQzYTQ2ZTZhN2ZhYTYwYWVjZTEzOQ==", "commit": {"author": {"name": "Peter Bergner", "email": "bergner@linux.ibm.com", "date": "2019-07-31T17:18:40Z"}, "committer": {"name": "Peter Bergner", "email": "bergner@gcc.gnu.org", "date": "2019-07-31T17:18:40Z"}, "message": "re PR target/91050 (-mdejagnu-cpu=<cpu> does not affect the -m<cpu> assembler option)\n\n\tPR target/91050\n\t* config/rs6000/rs6000.opt (mdejagnu-cpu=): Delete option.\n\t* config/rs6000/rs6000.c (rs6000_option_override_internal): Remove\n\tuse of deleted rs6000_dejagnu_cpu_index variable.\n\t* config/rs6000/rs6000.h (DRIVER_SELF_SPECS): Define.\n\t(SUBTARGET_DRIVER_SELF_SPECS): Likewise.\n\t* config/darwin.h (DRIVER_SELF_SPECS): Rename from this ...\n\t(SUBTARGET_DRIVER_SELF_SPECS): ...to this.\n\t* config/i386/i386.h (DRIVER_SELF_SPECS): Define.\n\t(SUBTARGET_DRIVER_SELF_SPECS): Likewise.\n\nFrom-SVN: r273941", "tree": {"sha": "bc31076907e0c9b754492ac3cfcff36e7aa17f9e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/bc31076907e0c9b754492ac3cfcff36e7aa17f9e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/98ae96d2ade339df1a2d3a46e6a7faa60aece139", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/98ae96d2ade339df1a2d3a46e6a7faa60aece139", "html_url": "https://github.com/Rust-GCC/gccrs/commit/98ae96d2ade339df1a2d3a46e6a7faa60aece139", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/98ae96d2ade339df1a2d3a46e6a7faa60aece139/comments", "author": {"login": "peter-bergner", "id": 17504345, "node_id": "MDQ6VXNlcjE3NTA0MzQ1", "avatar_url": "https://avatars.githubusercontent.com/u/17504345?v=4", "gravatar_id": "", "url": "https://api.github.com/users/peter-bergner", "html_url": "https://github.com/peter-bergner", "followers_url": "https://api.github.com/users/peter-bergner/followers", "following_url": "https://api.github.com/users/peter-bergner/following{/other_user}", "gists_url": "https://api.github.com/users/peter-bergner/gists{/gist_id}", "starred_url": "https://api.github.com/users/peter-bergner/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/peter-bergner/subscriptions", "organizations_url": "https://api.github.com/users/peter-bergner/orgs", "repos_url": "https://api.github.com/users/peter-bergner/repos", "events_url": "https://api.github.com/users/peter-bergner/events{/privacy}", "received_events_url": "https://api.github.com/users/peter-bergner/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "960b9ae05ac46f51370c30d30575e7a7fe6a3a99", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/960b9ae05ac46f51370c30d30575e7a7fe6a3a99", "html_url": "https://github.com/Rust-GCC/gccrs/commit/960b9ae05ac46f51370c30d30575e7a7fe6a3a99"}], "stats": {"total": 46, "additions": 35, "deletions": 11}, "files": [{"sha": "7d984df15f9562e1cef09e5603cb005d1673229f", "filename": "gcc/ChangeLog", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/98ae96d2ade339df1a2d3a46e6a7faa60aece139/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/98ae96d2ade339df1a2d3a46e6a7faa60aece139/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=98ae96d2ade339df1a2d3a46e6a7faa60aece139", "patch": "@@ -1,3 +1,16 @@\n+2019-07-31  Peter Bergner  <bergner@linux.ibm.com>\n+\n+\tPR target/91050\n+\t* config/rs6000/rs6000.opt (mdejagnu-cpu=): Delete option.\n+\t* config/rs6000/rs6000.c (rs6000_option_override_internal): Remove\n+\tuse of deleted rs6000_dejagnu_cpu_index variable.\n+\t* config/rs6000/rs6000.h (DRIVER_SELF_SPECS): Define.\n+\t(SUBTARGET_DRIVER_SELF_SPECS): Likewise.\n+\t* config/darwin.h (DRIVER_SELF_SPECS): Rename from this ...\n+\t(SUBTARGET_DRIVER_SELF_SPECS): ...to this.\n+\t* config/i386/i386.h (DRIVER_SELF_SPECS): Define.\n+\t(SUBTARGET_DRIVER_SELF_SPECS): Likewise.\n+\n 2019-07-31  Richard Biener  <rguenther@suse.de>\n \n \tPR tree-optimization/91280"}, {"sha": "ab5ad03f175d4d20061ba8c66f31587a3785b198", "filename": "gcc/config/darwin.h", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/98ae96d2ade339df1a2d3a46e6a7faa60aece139/gcc%2Fconfig%2Fdarwin.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/98ae96d2ade339df1a2d3a46e6a7faa60aece139/gcc%2Fconfig%2Fdarwin.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fdarwin.h?ref=98ae96d2ade339df1a2d3a46e6a7faa60aece139", "patch": "@@ -125,7 +125,8 @@ extern GTY(()) int darwin_ms_struct;\n \n    However, a few can be handled and we can elide options that are silently-\n    ignored defaults, plus warn on obsolete ones that no longer function.  */\n-#define DRIVER_SELF_SPECS\t\t\t\t\t\t\\\n+#undef SUBTARGET_DRIVER_SELF_SPECS\n+#define SUBTARGET_DRIVER_SELF_SPECS\t\t\t\t\t\\\n \"%{fapple-kext|mkernel:-static}\",\t\t\t\t\t\\\n \"%{gfull:-g -fno-eliminate-unused-debug-symbols} %<gfull\",\t\t\\\n \"%{gsplit-dwarf:%ngsplit-dwarf is not supported on this platform} \\"}, {"sha": "fba015c4260c937f68b19203ec1730df7d45cf82", "filename": "gcc/config/i386/i386.h", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/98ae96d2ade339df1a2d3a46e6a7faa60aece139/gcc%2Fconfig%2Fi386%2Fi386.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/98ae96d2ade339df1a2d3a46e6a7faa60aece139/gcc%2Fconfig%2Fi386%2Fi386.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386.h?ref=98ae96d2ade339df1a2d3a46e6a7faa60aece139", "patch": "@@ -677,6 +677,12 @@ extern tree x86_mfence;\n    with the rounding mode forced to 53 bits.  */\n #define TARGET_96_ROUND_53_LONG_DOUBLE 0\n \n+#ifndef SUBTARGET_DRIVER_SELF_SPECS\n+# define SUBTARGET_DRIVER_SELF_SPECS \"\"\n+#endif\n+\n+#define DRIVER_SELF_SPECS SUBTARGET_DRIVER_SELF_SPECS\n+\n /* -march=native handling only makes sense with compiler running on\n    an x86 or x86_64 chip.  If changing this condition, also change\n    the condition in driver-i386.c.  */"}, {"sha": "4080c82c05f3b6a2dfd6b976d36ad81d666e0153", "filename": "gcc/config/rs6000/rs6000.c", "status": "modified", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/98ae96d2ade339df1a2d3a46e6a7faa60aece139/gcc%2Fconfig%2Frs6000%2Frs6000.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/98ae96d2ade339df1a2d3a46e6a7faa60aece139/gcc%2Fconfig%2Frs6000%2Frs6000.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.c?ref=98ae96d2ade339df1a2d3a46e6a7faa60aece139", "patch": "@@ -3489,9 +3489,6 @@ rs6000_option_override_internal (bool global_init_p)\n   /* Don't override by the processor default if given explicitly.  */\n   set_masks &= ~rs6000_isa_flags_explicit;\n \n-  if (global_init_p && rs6000_dejagnu_cpu_index >= 0)\n-    rs6000_cpu_index = rs6000_dejagnu_cpu_index;\n-\n   /* Process the -mcpu=<xxx> and -mtune=<xxx> argument.  If the user changed\n      the cpu in a target attribute or pragma, but did not specify a tuning\n      option, use the cpu for the tuning option rather than the option specified"}, {"sha": "9c11a3e4d461f60b1855684983062ea75d797cac", "filename": "gcc/config/rs6000/rs6000.h", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/98ae96d2ade339df1a2d3a46e6a7faa60aece139/gcc%2Fconfig%2Frs6000%2Frs6000.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/98ae96d2ade339df1a2d3a46e6a7faa60aece139/gcc%2Fconfig%2Frs6000%2Frs6000.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.h?ref=98ae96d2ade339df1a2d3a46e6a7faa60aece139", "patch": "@@ -77,6 +77,20 @@\n #define PPC405_ERRATUM77 0\n #endif\n \n+#ifndef SUBTARGET_DRIVER_SELF_SPECS\n+# define SUBTARGET_DRIVER_SELF_SPECS \"\"\n+#endif\n+\n+/* Only for use in the testsuite: -mdejagnu-cpu= simply overrides -mcpu=.\n+   With older versions of Dejagnu the command line arguments you set in\n+   RUNTESTFLAGS override those set in the testcases; with this option,\n+   the testcase will always win.  Ditto for -mdejagnu-tune=.  */\n+#define DRIVER_SELF_SPECS \\\n+  \"%{mdejagnu-cpu=*: %<mcpu=* -mcpu=%*}\", \\\n+  \"%{mdejagnu-tune=*: %<mtune=* -mtune=%*}\", \\\n+  \"%{mdejagnu-*: %<mdejagnu-*}\", \\\n+   SUBTARGET_DRIVER_SELF_SPECS\n+\n #if CHECKING_P\n #define ASM_OPT_ANY \"\"\n #else"}, {"sha": "1b69507cfa8664ad300c4413db1e68363c4bfd35", "filename": "gcc/config/rs6000/rs6000.opt", "status": "modified", "additions": 0, "deletions": 7, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/98ae96d2ade339df1a2d3a46e6a7faa60aece139/gcc%2Fconfig%2Frs6000%2Frs6000.opt", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/98ae96d2ade339df1a2d3a46e6a7faa60aece139/gcc%2Fconfig%2Frs6000%2Frs6000.opt", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.opt?ref=98ae96d2ade339df1a2d3a46e6a7faa60aece139", "patch": "@@ -388,13 +388,6 @@ mtune=\n Target RejectNegative Joined Var(rs6000_tune_index) Init(-1) Enum(rs6000_cpu_opt_value) Save\n -mtune=\tSchedule code for given CPU.\n \n-; Only for use in the testsuite.  This simply overrides -mcpu=.  With older\n-; versions of Dejagnu the command line arguments you set in RUNTESTFLAGS\n-; override those set in the testcases; with this option, the testcase will\n-; always win.\n-mdejagnu-cpu=\n-Target Undocumented RejectNegative Joined Var(rs6000_dejagnu_cpu_index) Init(-1) Enum(rs6000_cpu_opt_value) Save\n-\n mtraceback=\n Target RejectNegative Joined Enum(rs6000_traceback_type) Var(rs6000_traceback)\n -mtraceback=[full,part,no]\tSelect type of traceback table."}]}