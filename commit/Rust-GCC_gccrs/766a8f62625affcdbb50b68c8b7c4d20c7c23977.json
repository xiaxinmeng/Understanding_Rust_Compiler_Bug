{"sha": "766a8f62625affcdbb50b68c8b7c4d20c7c23977", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzY2YThmNjI2MjVhZmZjZGJiNTBiNjhjOGI3YzRkMjBjN2MyMzk3Nw==", "commit": {"author": {"name": "Jerry DeLisle", "email": "jvdelisle@gcc.gnu.org", "date": "2007-06-06T00:54:30Z"}, "committer": {"name": "Jerry DeLisle", "email": "jvdelisle@gcc.gnu.org", "date": "2007-06-06T00:54:30Z"}, "message": "re PR testsuite/32057 (Random failure on gfortran.dg/secnds.f)\n\n2007-06-05  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n\n\tPR testsuite/32057\n\t* gfortran.dg/secnds.f: Update test to avoid roundoff errors and\n\tmidnight issues.\n\nFrom-SVN: r125352", "tree": {"sha": "14311a3f90b7488d0b426117b1c9c723f66a057f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/14311a3f90b7488d0b426117b1c9c723f66a057f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/766a8f62625affcdbb50b68c8b7c4d20c7c23977", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/766a8f62625affcdbb50b68c8b7c4d20c7c23977", "html_url": "https://github.com/Rust-GCC/gccrs/commit/766a8f62625affcdbb50b68c8b7c4d20c7c23977", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/766a8f62625affcdbb50b68c8b7c4d20c7c23977/comments", "author": null, "committer": null, "parents": [{"sha": "ee8e242435706dfa09d98abe249e9a99404b6e62", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ee8e242435706dfa09d98abe249e9a99404b6e62", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ee8e242435706dfa09d98abe249e9a99404b6e62"}], "stats": {"total": 29, "additions": 21, "deletions": 8}, "files": [{"sha": "58d3b77815679368def936b919d10e68400b8ab5", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/766a8f62625affcdbb50b68c8b7c4d20c7c23977/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/766a8f62625affcdbb50b68c8b7c4d20c7c23977/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=766a8f62625affcdbb50b68c8b7c4d20c7c23977", "patch": "@@ -1,3 +1,9 @@\n+2007-06-05  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n+\n+\tPR testsuite/32057\n+\t* gfortran.dg/secnds.f: Update test to avoid roundoff errors and\n+\tmidnight issues.\n+\n 2007-06-05  Manuel Lopez-Ibanez  <manu@gcc.gnu.org>\n \n \tPR testsuite/25241"}, {"sha": "3131598a201b5e28de143b4806e2152a31e297ef", "filename": "gcc/testsuite/gfortran.dg/secnds.f", "status": "modified", "additions": 15, "deletions": 8, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/766a8f62625affcdbb50b68c8b7c4d20c7c23977/gcc%2Ftestsuite%2Fgfortran.dg%2Fsecnds.f", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/766a8f62625affcdbb50b68c8b7c4d20c7c23977/gcc%2Ftestsuite%2Fgfortran.dg%2Fsecnds.f", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fsecnds.f?ref=766a8f62625affcdbb50b68c8b7c4d20c7c23977", "patch": "@@ -6,22 +6,29 @@\n C\n       character*20 dum1, dum2, dum3\n       real t1, t1a, t2, t2a\n-      real*8 dat1, dat2\n-      integer i, j, values(8)\n+      real*4 dat1, dat2\n+      integer i, j, values(8), k\n       t1 = secnds (0.0)\n       call date_and_time (dum1, dum2, dum3, values)\n       t1a = secnds (0.0)\n-      dat1 = 0.001*real (values(8)) + real (values(7)) +\n-     &        60.0*real (values(6)) + 3600.0* real (values(5))\n-      if (((dat1 - t1) < 0.) .or. ((dat1 - t1) > (t1a - t1))) call abort ()\n+      dat1 = 0.001 * real(values(8)) + real(values(7)) +\n+     &        60.0 * real(values(6)) + 3600.0 * real(values(5))\n+      ! handle midnight shift\n+      if ((t1a - t1) < -12.0*3600.0 ) t1 = t1 - 24.0*3600.0\n+      if ((t1a - dat1) < -12.0*3600.0 ) dat1 = dat1 - 24.0*3600.0\n+      if ((dat1 < nearest(t1, -1.)) .or. (dat1  > nearest(t1a, 1.)))\n+     &    call abort ()\n       do j=1,10000\n         do i=1,10000\n         end do\n       end do\n       t2a = secnds (t1a)\n       call date_and_time (dum1, dum2, dum3, values)\n       t2 = secnds (t1)\n-      dat2 = 0.001*real (values(8)) + real (values(7)) +\n-     &        60.0*real (values(6)) + 3600.0* real (values(5))\n-      if (((dat2 - dat1) < t2a) .or. ((dat2 - dat1) > t2)) call abort ()\n+      dat2 = 0.001 * real(values(8)) + real(values(7)) +\n+     &        60.0 * real(values(6)) + 3600.0 * real(values(5))\n+      ! handle midnight shift\n+      if ((dat2 - dat1) < -12.0*3600.0 ) dat1 = dat1 - 24.0*3600.0\n+      if (((dat2 - dat1) < t2a - 0.008) .or.\n+     &    ((dat2 - dat1) > t2 + 0.008)) call abort ()\n       end"}]}