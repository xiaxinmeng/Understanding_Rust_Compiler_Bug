{"sha": "db3ed0b3b72051c8b3f82f2f1228dfaad4fbce10", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZGIzZWQwYjNiNzIwNTFjOGIzZjgyZjJmMTIyOGRmYWFkNGZiY2UxMA==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2011-03-17T15:21:39Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2011-03-17T15:21:39Z"}, "message": "re PR middle-end/48152 (Bootstrap failure for x86_64-w64-mingw32 due ICE)\n\n\tPR middle-end/48152\n\t* var-tracking.c (prepare_call_arguments): If argument needs to be\n\tpassed by reference, adjust argtype and mode.\n\nFrom-SVN: r171101", "tree": {"sha": "882a420e77f6dfd63495021ecfdf408baf36266f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/882a420e77f6dfd63495021ecfdf408baf36266f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/db3ed0b3b72051c8b3f82f2f1228dfaad4fbce10", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/db3ed0b3b72051c8b3f82f2f1228dfaad4fbce10", "html_url": "https://github.com/Rust-GCC/gccrs/commit/db3ed0b3b72051c8b3f82f2f1228dfaad4fbce10", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/db3ed0b3b72051c8b3f82f2f1228dfaad4fbce10/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "1bce4ff313bf2e2c9e942df52b494bf22886f163", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1bce4ff313bf2e2c9e942df52b494bf22886f163", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1bce4ff313bf2e2c9e942df52b494bf22886f163"}], "stats": {"total": 27, "additions": 20, "deletions": 7}, "files": [{"sha": "694452e1d79c5b9fafdc446bbb0f9e756d769819", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/db3ed0b3b72051c8b3f82f2f1228dfaad4fbce10/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/db3ed0b3b72051c8b3f82f2f1228dfaad4fbce10/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=db3ed0b3b72051c8b3f82f2f1228dfaad4fbce10", "patch": "@@ -1,3 +1,9 @@\n+2011-03-17  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR middle-end/48152\n+\t* var-tracking.c (prepare_call_arguments): If argument needs to be\n+\tpassed by reference, adjust argtype and mode.\n+\n 2011-03-17  Richard Guenther  <rguenther@suse.de>\n \n \tPR middle-end/48134"}, {"sha": "aab98331df31bd6ea2056835c8937da0b269c8e9", "filename": "gcc/var-tracking.c", "status": "modified", "additions": 14, "deletions": 7, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/db3ed0b3b72051c8b3f82f2f1228dfaad4fbce10/gcc%2Fvar-tracking.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/db3ed0b3b72051c8b3f82f2f1228dfaad4fbce10/gcc%2Fvar-tracking.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fvar-tracking.c?ref=db3ed0b3b72051c8b3f82f2f1228dfaad4fbce10", "patch": "@@ -5732,11 +5732,18 @@ prepare_call_arguments (basic_block bb, rtx insn)\n \t  call_arguments = gen_rtx_EXPR_LIST (VOIDmode, item, call_arguments);\n \tif (t && t != void_list_node)\n \t  {\n-\t    enum machine_mode mode = TYPE_MODE (TREE_VALUE (t));\n-\t    rtx reg = targetm.calls.function_arg (&args_so_far, mode,\n-\t\t\t\t\t\t  TREE_VALUE (t), true);\n-\t    if (TREE_CODE (TREE_VALUE (t)) == REFERENCE_TYPE\n-\t\t&& INTEGRAL_TYPE_P (TREE_TYPE (TREE_VALUE (t)))\n+\t    tree argtype = TREE_VALUE (t);\n+\t    enum machine_mode mode = TYPE_MODE (argtype);\n+\t    rtx reg;\n+\t    if (pass_by_reference (&args_so_far, mode, argtype, true))\n+\t      {\n+\t\targtype = build_pointer_type (argtype);\n+\t\tmode = TYPE_MODE (argtype);\n+\t      }\n+\t    reg = targetm.calls.function_arg (&args_so_far, mode,\n+\t\t\t\t\t      argtype, true);\n+\t    if (TREE_CODE (argtype) == REFERENCE_TYPE\n+\t\t&& INTEGRAL_TYPE_P (TREE_TYPE (argtype))\n \t\t&& reg\n \t\t&& REG_P (reg)\n \t\t&& GET_MODE (reg) == mode\n@@ -5747,7 +5754,7 @@ prepare_call_arguments (basic_block bb, rtx insn)\n \t\t&& item)\n \t      {\n \t\tenum machine_mode indmode\n-\t\t  = TYPE_MODE (TREE_TYPE (TREE_VALUE (t)));\n+\t\t  = TYPE_MODE (TREE_TYPE (argtype));\n \t\trtx mem = gen_rtx_MEM (indmode, x);\n \t\tcselib_val *val = cselib_lookup (mem, indmode, 0, VOIDmode);\n \t\tif (val && cselib_preserved_value_p (val))\n@@ -5784,7 +5791,7 @@ prepare_call_arguments (basic_block bb, rtx insn)\n \t\t  }\n \t      }\n \t    targetm.calls.function_arg_advance (&args_so_far, mode,\n-\t\t\t\t\t\tTREE_VALUE (t), true);\n+\t\t\t\t\t\targtype, true);\n \t    t = TREE_CHAIN (t);\n \t  }\n       }"}]}