{"sha": "738832558ff6a73bf29daee4d880bc602aff8e1f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzM4ODMyNTU4ZmY2YTczYmYyOWRhZWU0ZDg4MGJjNjAyYWZmOGUxZg==", "commit": {"author": {"name": "Ulrich Weigand", "email": "uweigand@de.ibm.com", "date": "2008-07-22T17:21:12Z"}, "committer": {"name": "Ulrich Weigand", "email": "uweigand@gcc.gnu.org", "date": "2008-07-22T17:21:12Z"}, "message": "target-supports.exp (check_effective_target_spu_auto_overlay): New procedure.\n\n\t* lib/target-supports.exp (check_effective_target_spu_auto_overlay):\n\tNew procedure.\n\t* lib/compat.exp (compat-execute): Use it to test whether toolchain\n\tsupports automatic overlay generation for the SPU.\n\nFrom-SVN: r138064", "tree": {"sha": "d4ff05d5a78c518f3751f1e45fee85265842cd06", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d4ff05d5a78c518f3751f1e45fee85265842cd06"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/738832558ff6a73bf29daee4d880bc602aff8e1f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/738832558ff6a73bf29daee4d880bc602aff8e1f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/738832558ff6a73bf29daee4d880bc602aff8e1f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/738832558ff6a73bf29daee4d880bc602aff8e1f/comments", "author": null, "committer": null, "parents": [{"sha": "9cad01cefbf1620fe2264feab58011ea3c23ccee", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9cad01cefbf1620fe2264feab58011ea3c23ccee", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9cad01cefbf1620fe2264feab58011ea3c23ccee"}], "stats": {"total": 22, "additions": 21, "deletions": 1}, "files": [{"sha": "658be5072247504b3c1269b1129af88b6b366f4a", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/738832558ff6a73bf29daee4d880bc602aff8e1f/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/738832558ff6a73bf29daee4d880bc602aff8e1f/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=738832558ff6a73bf29daee4d880bc602aff8e1f", "patch": "@@ -1,3 +1,10 @@\n+2008-07-22  Ulrich Weigand  <Ulrich.Weigand@de.ibm.com>\n+\n+\t* lib/target-supports.exp (check_effective_target_spu_auto_overlay):\n+\tNew procedure.\n+\t* lib/compat.exp (compat-execute): Use it to test whether toolchain\n+\tsupports automatic overlay generation for the SPU.\n+\n 2008-07-22  Daniel Kraft  <d@domob.eu>\n \n \tPR fortran/29835"}, {"sha": "e8ca8fc79875ab9b2a42cc2b35ff5a953748b4a0", "filename": "gcc/testsuite/lib/compat.exp", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/738832558ff6a73bf29daee4d880bc602aff8e1f/gcc%2Ftestsuite%2Flib%2Fcompat.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/738832558ff6a73bf29daee4d880bc602aff8e1f/gcc%2Ftestsuite%2Flib%2Fcompat.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Flib%2Fcompat.exp?ref=738832558ff6a73bf29daee4d880bc602aff8e1f", "patch": "@@ -280,7 +280,7 @@ proc compat-execute { src1 sid use_alt } {\n \n     # On the SPU, most of the compat test cases exceed local store size.\n     # Use automatic overlay support to make them fit.\n-    if { [istarget spu-*-elf*] } {\n+    if { [check_effective_target_spu_auto_overlay] } {\n \tset extra_flags_1 \"$extra_flags_1 -Wl,--auto-overlay\"\n \tset extra_flags_1 \"$extra_flags_1 -ffunction-sections\"\n \tset extra_flags_2 \"$extra_flags_2 -ffunction-sections\""}, {"sha": "66231c669b0d812d907fde360ef43d84ee8d91e4", "filename": "gcc/testsuite/lib/target-supports.exp", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/738832558ff6a73bf29daee4d880bc602aff8e1f/gcc%2Ftestsuite%2Flib%2Ftarget-supports.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/738832558ff6a73bf29daee4d880bc602aff8e1f/gcc%2Ftestsuite%2Flib%2Ftarget-supports.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Flib%2Ftarget-supports.exp?ref=738832558ff6a73bf29daee4d880bc602aff8e1f", "patch": "@@ -1390,6 +1390,19 @@ proc check_effective_target_powerpc_altivec { } {\n     }\n }\n \n+# Return 1 if this is a SPU target with a toolchain that\n+# supports automatic overlay generation.\n+\n+proc check_effective_target_spu_auto_overlay { } {\n+    if { [istarget spu*-*-elf*] } {\n+\treturn [check_no_compiler_messages spu_auto_overlay executable {\n+\t\tint main (void) { }\n+\t\t} \"-Wl,--auto-overlay\" ]\n+    } else {\n+\treturn 0\n+    }\n+}\n+\n # The VxWorks SPARC simulator accepts only EM_SPARC executables and\n # chokes on EM_SPARC32PLUS or EM_SPARCV9 executables.  Return 1 if the\n # test environment appears to run executables on such a simulator."}]}