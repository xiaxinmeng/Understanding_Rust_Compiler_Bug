{"sha": "5c211bfd5afac2c366e840291e8fca8f4b5e2976", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NWMyMTFiZmQ1YWZhYzJjMzY2ZTg0MDI5MWU4ZmNhOGY0YjVlMjk3Ng==", "commit": {"author": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2013-10-14T13:16:59Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2013-10-14T13:16:59Z"}, "message": "[multiple changes]\n\n2013-10-14  Robert Dewar  <dewar@adacore.com>\n\n\t* s-valuti.adb, prep.adb, scng.adb, errout.adb: Minor reformatting.\n\n2013-10-14  Eric Botcazou  <ebotcazou@adacore.com>\n\n\t* adaint.c: Further disable __gnat_get_executable_load_address\n\tfor Linux.\n\n2013-10-14  Vincent Celier  <celier@adacore.com>\n\n\t* gnat_ugn.texi: Add documentation for comparing symbols to\n\tintegers in preprocessing expressions.\n\n2013-10-14  Jose Ruiz  <ruiz@adacore.com>\n\n\t* sem_prag.adb (Analyze_Aspect_Specification): For\n\tPriority and CPU aspects in subprograms, the expression in the\n\taspect is analyzed and exported.\n\t(Analyze_Pragma): When having a Priority pragma in the\n\tmain subprogram, load a unit that will force the initialization\n\tof the tasking run time, which is needed for setting the required\n\tpriority.\n\n2013-10-14  Vincent Celier  <celier@adacore.com>\n\n\t* prj-nmsc.adb (Check_Interfaces): Put in Other_Interfaces all\n\tnon Ada interface files.\n\t* prj.ads (Project_Data): New component Other_Interfaces.\n\nFrom-SVN: r203542", "tree": {"sha": "0f7f721405eed5f3477da90b21bd20778cbd6a8d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0f7f721405eed5f3477da90b21bd20778cbd6a8d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5c211bfd5afac2c366e840291e8fca8f4b5e2976", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5c211bfd5afac2c366e840291e8fca8f4b5e2976", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5c211bfd5afac2c366e840291e8fca8f4b5e2976", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5c211bfd5afac2c366e840291e8fca8f4b5e2976/comments", "author": null, "committer": null, "parents": [{"sha": "ffd76236927edd3e91599aa12ef4c520e9846a3f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ffd76236927edd3e91599aa12ef4c520e9846a3f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ffd76236927edd3e91599aa12ef4c520e9846a3f"}], "stats": {"total": 286, "additions": 186, "deletions": 100}, "files": [{"sha": "588037999d11f2a239e63b9c854d4591be9249dd", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 30, "deletions": 0, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5c211bfd5afac2c366e840291e8fca8f4b5e2976/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5c211bfd5afac2c366e840291e8fca8f4b5e2976/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=5c211bfd5afac2c366e840291e8fca8f4b5e2976", "patch": "@@ -1,3 +1,33 @@\n+2013-10-14  Robert Dewar  <dewar@adacore.com>\n+\n+\t* s-valuti.adb, prep.adb, scng.adb, errout.adb: Minor reformatting.\n+\n+2013-10-14  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* adaint.c: Further disable __gnat_get_executable_load_address\n+\tfor Linux.\n+\n+2013-10-14  Vincent Celier  <celier@adacore.com>\n+\n+\t* gnat_ugn.texi: Add documentation for comparing symbols to\n+\tintegers in preprocessing expressions.\n+\n+2013-10-14  Jose Ruiz  <ruiz@adacore.com>\n+\n+\t* sem_prag.adb (Analyze_Aspect_Specification): For\n+\tPriority and CPU aspects in subprograms, the expression in the\n+\taspect is analyzed and exported.\n+\t(Analyze_Pragma): When having a Priority pragma in the\n+\tmain subprogram, load a unit that will force the initialization\n+\tof the tasking run time, which is needed for setting the required\n+\tpriority.\n+\n+2013-10-14  Vincent Celier  <celier@adacore.com>\n+\n+\t* prj-nmsc.adb (Check_Interfaces): Put in Other_Interfaces all\n+\tnon Ada interface files.\n+\t* prj.ads (Project_Data): New component Other_Interfaces.\n+\n 2013-10-14  Arnaud Charlet  <charlet@adacore.com>\n \n \t* gcc-interface/Makefile.in: Target pairs clean ups."}, {"sha": "ff65bd70bf1fc2cb583e347951d9ef2886f93541", "filename": "gcc/ada/adaint.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5c211bfd5afac2c366e840291e8fca8f4b5e2976/gcc%2Fada%2Fadaint.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5c211bfd5afac2c366e840291e8fca8f4b5e2976/gcc%2Fada%2Fadaint.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fadaint.c?ref=5c211bfd5afac2c366e840291e8fca8f4b5e2976", "patch": "@@ -3929,7 +3929,7 @@ void __gnat_cpu_set (int cpu, size_t count ATTRIBUTE_UNUSED, cpu_set_t *set)\n \n #if defined (__APPLE__)\n #include <mach-o/dyld.h>\n-#elif defined (__linux__)\n+#elif 0 && defined (__linux__)\n #include <link.h>\n #elif defined (__AIX__)\n #include <sys/ldr.h>"}, {"sha": "2c783b2bddf220885c1aa4fa9248ec6ee73cbd0b", "filename": "gcc/ada/errout.adb", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5c211bfd5afac2c366e840291e8fca8f4b5e2976/gcc%2Fada%2Ferrout.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5c211bfd5afac2c366e840291e8fca8f4b5e2976/gcc%2Fada%2Ferrout.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Ferrout.adb?ref=5c211bfd5afac2c366e840291e8fca8f4b5e2976", "patch": "@@ -1625,8 +1625,9 @@ package body Errout is\n             Set_Standard_Error;\n          end if;\n \n-         --  Message giving total number of lines, only when Main_Source_Line\n-         --  is known.\n+         --  Message giving total number of lines. Don't give this message if\n+         --  the Main_Source line is unknown (this happens in error situations,\n+         --  e.g. when integrated preprocessing fails).\n \n          if Main_Source_File /= No_Source_File then\n             Write_Str (\" \");"}, {"sha": "3c0bab86cb6ac99f529ae52a6f9fe3fa08e4f783", "filename": "gcc/ada/gnat_ugn.texi", "status": "modified", "additions": 11, "deletions": 1, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5c211bfd5afac2c366e840291e8fca8f4b5e2976/gcc%2Fada%2Fgnat_ugn.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5c211bfd5afac2c366e840291e8fca8f4b5e2976/gcc%2Fada%2Fgnat_ugn.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgnat_ugn.texi?ref=5c211bfd5afac2c366e840291e8fca8f4b5e2976", "patch": "@@ -16682,6 +16682,11 @@ In this example, @i{expression} is defined by the following grammar:\n @i{expression} ::=  <symbol>\n @i{expression} ::=  <symbol> = \"<value>\"\n @i{expression} ::=  <symbol> = <symbol>\n+@i{expression} ::=  <symbol> = <integer>\n+@i{expression} ::=  <symbol> > <integer>\n+@i{expression} ::=  <symbol> >= <integer>\n+@i{expression} ::=  <symbol> < <integer>\n+@i{expression} ::=  <symbol> <= <integer>\n @i{expression} ::=  <symbol> 'Defined\n @i{expression} ::=  not @i{expression}\n @i{expression} ::=  @i{expression} and @i{expression}\n@@ -16714,6 +16719,11 @@ symbol definition must be one of the (case-insensitive) literals\n corresponding lines are included, and if the value is false, they are\n excluded.\n \n+When comparing a symbol to an integer, the integer is any non negative\n+literal integer as defined in the Ada Reference Manual, such as 3, 16#FF# or\n+2#11#. The symbol value must also be a non negative integer. Integer values\n+in the range 0 .. 2**31-1 are supported.\n+\n The test (@i{expression} ::= <symbol> @code{'Defined}) is true only if\n the symbol has been defined in the definition file or by a @option{-D}\n switch on the command line. Otherwise, the test is false.\n@@ -27447,7 +27457,7 @@ The preprocessing language allows such constructs as\n \n @smallexample\n @group\n-#if DEBUG or PRIORITY > 4 then\n+#if DEBUG or else (PRIORITY > 4) then\n    bunch of declarations\n #else\n    completely different bunch of declarations"}, {"sha": "10ced63f4fd92975a98632ef4b0dcde53bf30405", "filename": "gcc/ada/prep.adb", "status": "modified", "additions": 68, "deletions": 53, "changes": 121, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5c211bfd5afac2c366e840291e8fca8f4b5e2976/gcc%2Fada%2Fprep.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5c211bfd5afac2c366e840291e8fca8f4b5e2976/gcc%2Fada%2Fprep.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprep.adb?ref=5c211bfd5afac2c366e840291e8fca8f4b5e2976", "patch": "@@ -147,21 +147,19 @@ package body Prep is\n \n    type Pp_State is record\n       If_Ptr : Source_Ptr;\n-      --  The location of the #if statement.\n-      --  Used to flag #if with no corresponding #end if, at the end.\n+      --  The location of the #if statement (used to flag #if with no\n+      --  corresponding #end if, at the end).\n \n       Else_Ptr : Source_Ptr;\n-      --  The location of the #else statement.\n-      --  Used to detect multiple #else.\n+      --  The location of the #else statement (used to detect multiple #else's)\n \n       Deleting : Boolean;\n       --  Set to True when the code should be deleted or commented out\n \n       Match_Seen : Boolean;\n-      --  Set to True when a condition in an #if or an #elsif is True.\n-      --  Also set to True if Deleting at the previous level is True.\n-      --  Used to decide if Deleting should be set to True in a following\n-      --  #elsif or #else.\n+      --  Set to True when a condition in an #if or an #elsif is True. Also set\n+      --  to True if Deleting at the previous level is True. Used to decide if\n+      --  Deleting should be set to True in a following #elsif or #else.\n \n    end record;\n \n@@ -190,13 +188,13 @@ package body Prep is\n    function Expression\n      (Evaluate_It  : Boolean;\n       Complemented : Boolean := False) return Boolean;\n-   --  Evaluate a condition in an #if or an #elsif statement.\n-   --  If Evaluate_It is False, the condition is effectively evaluated,\n-   --  otherwise, only the syntax is checked.\n+   --  Evaluate a condition in an #if or an #elsif statement. If Evaluate_It\n+   --  is False, the condition is effectively evaluated, otherwise, only the\n+   --  syntax is checked.\n \n    procedure Go_To_End_Of_Line;\n-   --  Advance the scan pointer until we reach an end of line or the end\n-   --  of the buffer.\n+   --  Advance the scan pointer until we reach an end of line or the end of the\n+   --  buffer.\n \n    function Matching_Strings (S1, S2 : String_Id) return Boolean;\n    --  Returns True if the two string parameters are equal (case insensitive)\n@@ -251,6 +249,7 @@ package body Prep is\n       --  If no character '=', then the value is True\n \n       if Index = 0 then\n+\n          --  Put the symbol in the name buffer\n \n          Name_Len := Definition'Length;\n@@ -377,8 +376,8 @@ package body Prep is\n       Complemented : Boolean := False) return Boolean\n    is\n       Evaluation : Boolean := Evaluate_It;\n-      --  Is set to False after an \"or else\" when left term is True and\n-      --  after an \"and then\" when left term is False.\n+      --  Is set to False after an \"or else\" when left term is True and after\n+      --  an \"and then\" when left term is False.\n \n       Final_Result : Boolean := False;\n \n@@ -405,12 +404,13 @@ package body Prep is\n \n          Current_Result := False;\n \n-         case Token is\n+         --  Scan current term, starting with Token\n \n-            when Tok_Left_Paren =>\n+         case Token is\n \n-               --  ( expression )\n+            --  Handle parenthesized expression\n \n+            when Tok_Left_Paren =>\n                Scan.all;\n                Current_Result := Expression (Evaluation);\n \n@@ -422,14 +422,15 @@ package body Prep is\n                     (\"`)` expected\", Token_Ptr);\n                end if;\n \n-            when Tok_Not =>\n-\n-               --  not expression\n+            --  Handle not expression\n \n+            when Tok_Not =>\n                Scan.all;\n                Current_Result :=\n                  not Expression (Evaluation, Complemented => True);\n \n+            --  Handle sequence starting with identifier\n+\n             when Tok_Identifier =>\n                Symbol_Name1 := Token_Name;\n                Symbol_Pos1  := Token_Ptr;\n@@ -454,11 +455,13 @@ package body Prep is\n                      Current_Result := Index_Of (Symbol_Name1) /= No_Symbol;\n                   end if;\n \n+               --  Handle relational operator\n+\n                elsif\n-                 Token = Tok_Equal or else\n-                 Token = Tok_Less or else\n+                 Token = Tok_Equal      or else\n+                 Token = Tok_Less       or else\n                  Token = Tok_Less_Equal or else\n-                 Token = Tok_Greater or else\n+                 Token = Tok_Greater    or else\n                  Token = Tok_Greater_Equal\n                then\n                   Relop := Token;\n@@ -476,7 +479,10 @@ package body Prep is\n                      declare\n                         Value : constant Int := UI_To_Int (Int_Literal_Value);\n                         Data  : Symbol_Data;\n+\n                         Symbol_Value : Int;\n+                        --  Value of symbol as Int\n+\n                      begin\n                         if Evaluation then\n                            Symbol1 := Index_Of (Symbol_Name1);\n@@ -530,7 +536,7 @@ package body Prep is\n                                     when Constraint_Error =>\n                                        Error_Msg_Name_1 := Symbol_Name1;\n                                        Error_Msg\n-                                         (\"symbol % value is not integer\",\n+                                         (\"symbol % value is not an integer\",\n                                           Symbol_Pos1);\n                                  end;\n                               end if;\n@@ -540,9 +546,13 @@ package body Prep is\n                         Scan.all;\n                      end;\n \n+                  --  Error if relational operator other than = if not numbers\n+\n                   elsif Relop /= Tok_Equal then\n                      Error_Msg (\"number expected\", Token_Ptr);\n \n+                  --  Equality comparison of two strings\n+\n                   elsif Token = Tok_Identifier then\n \n                      --  symbol = symbol\n@@ -586,10 +596,11 @@ package body Prep is\n                         end if;\n \n                         if Symbol_Value1 /= No_String\n-                          and then Symbol_Value2 /= No_String\n+                             and then\n+                           Symbol_Value2 /= No_String\n                         then\n-                           Current_Result := Matching_Strings\n-                                               (Symbol_Value1, Symbol_Value2);\n+                           Current_Result :=\n+                             Matching_Strings (Symbol_Value1, Symbol_Value2);\n                         end if;\n                      end if;\n \n@@ -630,9 +641,9 @@ package body Prep is\n                         Token_Ptr);\n                   end if;\n \n-               else\n-                  --  symbol (True or False)\n+               --  Handle True or False\n \n+               else\n                   if Evaluation then\n                      Symbol1 := Index_Of (Symbol_Name1);\n \n@@ -674,6 +685,8 @@ package body Prep is\n                   end if;\n                end if;\n \n+            --  Unrecognized sequence\n+\n             when others =>\n                Error_Msg (\"`(`, NOT or symbol expected\", Token_Ptr);\n          end case;\n@@ -691,7 +704,7 @@ package body Prep is\n                Final_Result := Final_Result and Current_Result;\n          end case;\n \n-         --  Check the next operator\n+         --  Handle AND\n \n          if Token = Tok_And then\n             if Complemented then\n@@ -714,6 +727,8 @@ package body Prep is\n                end if;\n             end if;\n \n+         --  Handle OR\n+\n          elsif Token = Tok_Or then\n             if Complemented then\n                Error_Msg\n@@ -735,9 +750,9 @@ package body Prep is\n                end if;\n             end if;\n \n-         else\n-            --  No operator: exit the term loop\n+         --  No AND/OR operator, so exit from the loop through terms\n \n+         else\n             exit;\n          end if;\n       end loop;\n@@ -824,7 +839,6 @@ package body Prep is\n                 Get_Name_String (Mapping.Table (Order (Op1)).Symbol);\n          S2 : constant String :=\n                 Get_Name_String (Mapping.Table (Order (Op2)).Symbol);\n-\n       begin\n          return S1 < S2;\n       end Lt;\n@@ -961,6 +975,8 @@ package body Prep is\n    -- Parse_Def_File --\n    --------------------\n \n+   --  This procedure REALLY needs some more comments ???\n+\n    procedure Parse_Def_File is\n       Symbol        : Symbol_Id;\n       Symbol_Name   : Name_Id;\n@@ -1012,7 +1028,6 @@ package body Prep is\n \n                begin\n                   Start_String;\n-\n                   while Ptr < Scan_Ptr loop\n                      Store_String_Char (Sinput.Source (Ptr));\n                      Ptr := Ptr + 1;\n@@ -1102,9 +1117,10 @@ package body Prep is\n             Symbol := Index_Of (Symbol_Name);\n \n             if Symbol /= No_Symbol then\n+\n                --  If we already have an entry for this symbol, replace it\n-               --  with the new value, except if the symbol was declared\n-               --  on the command line.\n+               --  with the new value, except if the symbol was declared on\n+               --  the command line.\n \n                if Mapping.Table (Symbol).On_The_Command_Line then\n                   goto Continue;\n@@ -1299,8 +1315,8 @@ package body Prep is\n                         Scan.all;\n                      end if;\n \n-                     --  It is an error to have trailing characters after\n-                     --  the condition or \"then\".\n+                     --  It is an error to have trailing characters after the\n+                     --  condition or \"then\".\n \n                      if Token /= Tok_End_Of_Line\n                        and then Token /= Tok_EOF\n@@ -1313,8 +1329,9 @@ package body Prep is\n                         Go_To_End_Of_Line;\n                      end if;\n \n-                     --  Depending on the value of the condition, set the\n-                     --  new values of Deleting and Match_Seen.\n+                     --  Depending on the value of the condition, set the new\n+                     --  values of Deleting and Match_Seen.\n+\n                      if Pp_States.Last > 0 then\n                         if Pp_States.Table (Pp_States.Last).Match_Seen then\n                            Pp_States.Table (Pp_States.Last).Deleting := True;\n@@ -1343,8 +1360,7 @@ package body Prep is\n                         No_Error_Found := False;\n                      end if;\n \n-                     --  Set the possibly new values of Deleting and\n-                     --  Match_Seen.\n+                     --  Set the possibly new values of Deleting and Match_Seen\n \n                      if Pp_States.Last > 0 then\n                         if Pp_States.Table (Pp_States.Last).Match_Seen then\n@@ -1358,16 +1374,16 @@ package body Prep is\n                              False;\n                         end if;\n \n-                        --  Set the Else_Ptr to check for illegal #elsif\n-                        --  later.\n+                        --  Set the Else_Ptr to check for illegal #elsif later\n \n                         Pp_States.Table (Pp_States.Last).Else_Ptr :=\n                           Token_Ptr;\n                      end if;\n \n                      Scan.all;\n \n-                     --  It is an error to have characters after \"#else\"\n+                     --  Error of character present after \"#else\"\n+\n                      if Token /= Tok_End_Of_Line\n                        and then Token /= Tok_EOF\n                      then\n@@ -1404,8 +1420,8 @@ package body Prep is\n                         else\n                            Scan.all;\n \n-                           --  It is an error to have character after\n-                           --  \"#end if;\".\n+                           --  Error of character present after \"#end if;\"\n+\n                            if Token /= Tok_End_Of_Line\n                              and then Token /= Tok_EOF\n                            then\n@@ -1535,15 +1551,14 @@ package body Prep is\n \n          pragma Assert (Token = Tok_End_Of_Line or else Token = Tok_EOF);\n \n-         --  At this point, the token is either end of line or EOF.\n-         --  The line to possibly output stops just before the token.\n+         --  At this point, the token is either end of line or EOF. The line to\n+         --  possibly output stops just before the token.\n \n          Output_Line (Start_Of_Processing, Token_Ptr - 1);\n \n          --  If we are at the end of a line, the scan pointer is at the first\n-         --  non blank character, not necessarily the first character of the\n-         --  line; so, we have to deduct Start_Of_Processing from the token\n-         --  pointer.\n+         --  non-blank character (may not be the first character of the line),\n+         --  so we have to deduct Start_Of_Processing from the token pointer.\n \n          if Token = Tok_End_Of_Line then\n             if (Sinput.Source (Token_Ptr) = ASCII.CR"}, {"sha": "eb647df1492f0c404672aba57ed718e8ed176cc7", "filename": "gcc/ada/prj-nmsc.adb", "status": "modified", "additions": 25, "deletions": 1, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5c211bfd5afac2c366e840291e8fca8f4b5e2976/gcc%2Fada%2Fprj-nmsc.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5c211bfd5afac2c366e840291e8fca8f4b5e2976/gcc%2Fada%2Fprj-nmsc.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-nmsc.adb?ref=5c211bfd5afac2c366e840291e8fca8f4b5e2976", "patch": "@@ -2716,7 +2716,8 @@ package body Prj.Nmsc is\n       Other      : Source_Id;\n       Unit_Found : Boolean;\n \n-      Interface_ALIs : String_List_Id := Nil_String;\n+      Interface_ALIs   : String_List_Id := Nil_String;\n+      Other_Interfaces : String_List_Id := Nil_String;\n \n    begin\n       if not Interfaces.Default then\n@@ -2771,6 +2772,8 @@ package body Prj.Nmsc is\n                            Other.Declared_In_Interfaces := True;\n                         end if;\n \n+                        --  Unit based case\n+\n                         if Source.Language.Config.Kind = Unit_Based then\n                            if Source.Kind = Spec\n                              and then Other_Part (Source) /= No_Source\n@@ -2794,6 +2797,26 @@ package body Prj.Nmsc is\n                            Interface_ALIs :=\n                              String_Element_Table.Last\n                                (Shared.String_Elements);\n+\n+                        --  File based case\n+\n+                        else\n+                           String_Element_Table.Increment_Last\n+                             (Shared.String_Elements);\n+\n+                           Shared.String_Elements.Table\n+                             (String_Element_Table.Last\n+                                (Shared.String_Elements)) :=\n+                             (Value         => Name_Id (Source.File),\n+                              Index         => 0,\n+                              Display_Value => Name_Id (Source.Display_File),\n+                              Location      => No_Location,\n+                              Flag          => False,\n+                              Next          => Other_Interfaces);\n+\n+                           Other_Interfaces :=\n+                             String_Element_Table.Last\n+                               (Shared.String_Elements);\n                         end if;\n \n                         Debug_Output\n@@ -2825,6 +2848,7 @@ package body Prj.Nmsc is\n \n          Project.Interfaces_Defined := True;\n          Project.Lib_Interface_ALIs := Interface_ALIs;\n+         Project.Other_Interfaces   := Other_Interfaces;\n \n       elsif Project.Library and then not Library_Interface.Default then\n "}, {"sha": "e39c40c3caaef351d673f174653f4dda409f5c65", "filename": "gcc/ada/prj.ads", "status": "modified", "additions": 18, "deletions": 18, "changes": 36, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5c211bfd5afac2c366e840291e8fca8f4b5e2976/gcc%2Fada%2Fprj.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5c211bfd5afac2c366e840291e8fca8f4b5e2976/gcc%2Fada%2Fprj.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj.ads?ref=5c211bfd5afac2c366e840291e8fca8f4b5e2976", "patch": "@@ -165,8 +165,8 @@ package Prj is\n    --  The defined kinds of variables\n \n    Ignored : constant Variable_Kind;\n-   --  Used to indicate that a package declaration must be ignored\n-   --  while processing the project tree (unknown package name).\n+   --  Used to indicate that a package declaration must be ignored while\n+   --  processing the project tree (unknown package name).\n \n    type Variable_Value (Kind : Variable_Kind := Undefined) is record\n       Project  : Project_Id := No_Project;\n@@ -262,7 +262,7 @@ package Prj is\n                         Attributes => No_Variable,\n                         Arrays     => No_Array,\n                         Packages   => No_Package);\n-   --  Default value of Declarations: indicates that there is no declarations\n+   --  Default value of Declarations: used if there are no declarations\n \n    type Package_Element is record\n       Name   : Name_Id      := No_Name;\n@@ -435,8 +435,8 @@ package Prj is\n \n    function Other_Part (Source : Source_Id) return Source_Id;\n    pragma Inline (Other_Part);\n-   --  Source ID for the other part, if any: for a spec, indicates its body;\n-   --  for a body, indicates its spec.\n+   --  Source ID for the other part, if any: for a spec, returns its body;\n+   --  for a body, returns its spec.\n \n    No_Source : constant Source_Id := null;\n \n@@ -595,9 +595,9 @@ package Prj is\n       --  spec pattern.\n \n       Config_File_Unique : Boolean := False;\n-      --  Indicate if the config file specified to the compiler needs to be\n-      --  unique. If it is unique, then all config files are concatenated into\n-      --  a temp config file.\n+      --  True if the config file specified to the compiler needs to be unique.\n+      --  If it is unique, then all config files are concatenated into a temp\n+      --  config file.\n \n       Binder_Driver : File_Name_Type := No_File;\n       --  The name of the binder driver for the language, if any\n@@ -1345,19 +1345,20 @@ package Prj is\n       --  Indicate that this is a Standalone Library Project File\n \n       Lib_Interface_ALIs : String_List_Id := Nil_String;\n-      --  For Standalone Library Project Files, indicate the list of Interface\n-      --  ALI files.\n+      --  For Standalone Library Project Files, list of Interface ALI files.\n+\n+      Other_Interfaces : String_List_Id := Nil_String;\n+      --  List of non unit based sources in attribute Interfaces\n \n       Lib_Auto_Init : Boolean := False;\n-      --  For non static Stand-Alone Library Project Files, indicate if\n-      --  the library initialisation should be automatic.\n+      --  For non static Stand-Alone Library Project Files, True if the library\n+      --  initialisation should be automatic.\n \n       Symbol_Data : Symbol_Record := No_Symbols;\n       --  Symbol file name, reference symbol file name, symbol policy\n \n       Need_To_Build_Lib : Boolean := False;\n-      --  Indicates that the library of a Library Project needs to be built or\n-      --  rebuilt.\n+      --  True if the library of a Library Project needs to be built or rebuilt\n \n       -------------\n       -- Sources --\n@@ -1415,8 +1416,8 @@ package Prj is\n       --  The path name of the configuration pragmas file, if any\n \n       Config_File_Temp : Boolean := False;\n-      --  An indication that the configuration pragmas file is a temporary file\n-      --  that must be deleted at the end.\n+      --  True if the configuration pragmas file is a temporary file that must\n+      --  be deleted at the end.\n \n       Config_Checked : Boolean := False;\n       --  A flag to avoid checking repetitively the configuration pragmas file\n@@ -1972,8 +1973,7 @@ private\n       --  setting the env var to the same value. When different from No_Path,\n       --  this indicates that logical names (VMS) or environment variables were\n       --  created and should be deassigned to avoid polluting the environment\n-      --  on VMS.\n-      --  gnatmake only\n+      --  on VMS. This is for gnatmake only.\n \n       Current_Object_Path_File : Path_Name_Type := No_Path;\n       --  Current value of project object path file env var. Used to avoid"}, {"sha": "ce6db6fecb415e90c2ae18849cb13afd1971ed0f", "filename": "gcc/ada/s-valuti.adb", "status": "modified", "additions": 13, "deletions": 13, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5c211bfd5afac2c366e840291e8fca8f4b5e2976/gcc%2Fada%2Fs-valuti.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5c211bfd5afac2c366e840291e8fca8f4b5e2976/gcc%2Fada%2Fs-valuti.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fs-valuti.adb?ref=5c211bfd5afac2c366e840291e8fca8f4b5e2976", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 B o d y                                  --\n --                                                                          --\n---          Copyright (C) 1992-2012, Free Software Foundation, Inc.         --\n+--          Copyright (C) 1992-2013, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -134,9 +134,9 @@ package body System.Val_Util is\n \n       --  Scan out the exponent value as an unsigned integer. Values larger\n       --  than (Integer'Last / 10) are simply considered large enough here.\n-      --  This assumption is correct for all machines we know of (e.g. in\n-      --  the case of 16 bit integers it allows exponents up to 3276, which\n-      --  is large enough for the largest floating types in base 2.)\n+      --  This assumption is correct for all machines we know of (e.g. in the\n+      --  case of 16 bit integers it allows exponents up to 3276, which is\n+      --  large enough for the largest floating types in base 2.)\n \n       X := 0;\n \n@@ -222,8 +222,8 @@ package body System.Val_Util is\n       P : Natural := Ptr.all;\n \n    begin\n-      --  Deal with case of null string (all blanks!). As per spec, we\n-      --  raise constraint error, with Ptr unchanged, and thus > Max.\n+      --  Deal with case of null string (all blanks!). As per spec, we raise\n+      --  constraint error, with Ptr unchanged, and thus > Max.\n \n       if P > Max then\n          Bad_Value (Str);\n@@ -300,16 +300,16 @@ package body System.Val_Util is\n    begin\n       P := P + 1;\n \n-      --  If underscore is at the end of string, then this is an error and\n-      --  we raise Constraint_Error, leaving the pointer past the underscore.\n-      --  This seems a bit strange. It means e.g. that if the field is:\n+      --  If underscore is at the end of string, then this is an error and we\n+      --  raise Constraint_Error, leaving the pointer past the underscore. This\n+      --  seems a bit strange. It means e.g. that if the field is:\n \n       --    345_\n \n-      --  that Constraint_Error is raised. You might think that the RM in\n-      --  this case would scan out the 345 as a valid integer, leaving the\n-      --  pointer at the underscore, but the ACVC suite clearly requires\n-      --  an error in this situation (see for example CE3704M).\n+      --  that Constraint_Error is raised. You might think that the RM in this\n+      --  case would scan out the 345 as a valid integer, leaving the pointer\n+      --  at the underscore, but the ACVC suite clearly requires an error in\n+      --  this situation (see for example CE3704M).\n \n       if P > Max then\n          Ptr.all := P;"}, {"sha": "ef3d665554a3d2b7ca72489e967386975c46d66b", "filename": "gcc/ada/scng.adb", "status": "modified", "additions": 4, "deletions": 6, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5c211bfd5afac2c366e840291e8fca8f4b5e2976/gcc%2Fada%2Fscng.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5c211bfd5afac2c366e840291e8fca8f4b5e2976/gcc%2Fada%2Fscng.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fscng.adb?ref=5c211bfd5afac2c366e840291e8fca8f4b5e2976", "patch": "@@ -592,14 +592,12 @@ package body Scng is\n          --  which the digit was expected on input, and is unchanged on return.\n \n          procedure Scan_Integer;\n-         --  Procedure to scan integer literal. On entry, Scan_Ptr points to a\n-         --  digit, on exit Scan_Ptr points past the last character of the\n-         --  integer.\n+         --  Scan integer literal. On entry, Scan_Ptr points to a digit, on\n+         --  exit Scan_Ptr points past the last character of the integer.\n          --\n          --  For each digit encountered, UI_Int_Value is multiplied by 10, and\n-         --  the value of the digit added to the result. In addition, the\n-         --  value in Scale is decremented by one for each actual digit\n-         --  scanned.\n+         --  the value of the digit added to the result. In addition, the value\n+         --  in Scale is decremented by one for each actual digit scanned.\n \n          --------------------------\n          -- Error_Digit_Expected --"}, {"sha": "21e476599fcf58cd91c071efcb3fe0b012991b79", "filename": "gcc/ada/sem_prag.adb", "status": "modified", "additions": 13, "deletions": 5, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5c211bfd5afac2c366e840291e8fca8f4b5e2976/gcc%2Fada%2Fsem_prag.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5c211bfd5afac2c366e840291e8fca8f4b5e2976/gcc%2Fada%2Fsem_prag.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_prag.adb?ref=5c211bfd5afac2c366e840291e8fca8f4b5e2976", "patch": "@@ -16162,16 +16162,24 @@ package body Sem_Prag is\n                Set_Main_Priority\n                     (Current_Sem_Unit, UI_To_Int (Expr_Value (Arg)));\n \n-               --  Load an arbitrary entity from System.Tasking to make sure\n-               --  this package is implicitly with'ed, since we need to have\n-               --  the tasking run-time active for the pragma Priority to have\n-               --  any effect.\n+               --  Load an arbitrary entity from System.Tasking.Stages or\n+               --  System.Tasking.Restricted.Stages (depending on the\n+               --  supported profile) to make sure that one of these packages\n+               --  is implicitly with'ed, since we need to have the tasking\n+               --  run time active for the pragma Priority to have any effect.\n+               --  Previously with with'ed the package System.Tasking, but\n+               --  this package does not trigger the required initialization\n+               --  of the run-time library.\n \n                declare\n                   Discard : Entity_Id;\n                   pragma Warnings (Off, Discard);\n                begin\n-                  Discard := RTE (RE_Task_List);\n+                  if Restricted_Profile then\n+                     Discard := RTE (RE_Activate_Restricted_Tasks);\n+                  else\n+                     Discard := RTE (RE_Activate_Tasks);\n+                  end if;\n                end;\n \n             --  Task or Protected, must be of type Integer"}]}