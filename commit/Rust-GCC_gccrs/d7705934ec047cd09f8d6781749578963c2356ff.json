{"sha": "d7705934ec047cd09f8d6781749578963c2356ff", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDc3MDU5MzRlYzA0N2NkMDlmOGQ2NzgxNzQ5NTc4OTYzYzIzNTZmZg==", "commit": {"author": {"name": "Daniel Berlin", "email": "dberlin@dberlin.org", "date": "2007-08-09T21:13:30Z"}, "committer": {"name": "Daniel Berlin", "email": "dberlin@gcc.gnu.org", "date": "2007-08-09T21:13:30Z"}, "message": "c-typeck.c (readonly_error): Improve error for assignment.\n\n2007-08-09  Daniel Berlin  <dberlin@dberlin.org>\n\n\t* c-typeck.c (readonly_error): Improve error for assignment.\n\t\n\t* c-pretty-print.c (pp_c_additive_expression): Handle pointer-plus\n\texpression. \n\t(pp_c_expression): Ditto.\n2007-08-09  Daniel Berlin  <dberlin@dberlin.org>\n\n\t* typeck2.c (readonly_error): Handle general expressions.\n\t* error.c (dump_expr): Handle POINTER_PLUS_EXPR\n\nFrom-SVN: r127320", "tree": {"sha": "b8e2cae4b6b7aaaea167906c353dd1247b5b562f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b8e2cae4b6b7aaaea167906c353dd1247b5b562f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d7705934ec047cd09f8d6781749578963c2356ff", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d7705934ec047cd09f8d6781749578963c2356ff", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d7705934ec047cd09f8d6781749578963c2356ff", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d7705934ec047cd09f8d6781749578963c2356ff/comments", "author": {"login": "dberlin", "id": 324715, "node_id": "MDQ6VXNlcjMyNDcxNQ==", "avatar_url": "https://avatars.githubusercontent.com/u/324715?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dberlin", "html_url": "https://github.com/dberlin", "followers_url": "https://api.github.com/users/dberlin/followers", "following_url": "https://api.github.com/users/dberlin/following{/other_user}", "gists_url": "https://api.github.com/users/dberlin/gists{/gist_id}", "starred_url": "https://api.github.com/users/dberlin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dberlin/subscriptions", "organizations_url": "https://api.github.com/users/dberlin/orgs", "repos_url": "https://api.github.com/users/dberlin/repos", "events_url": "https://api.github.com/users/dberlin/events{/privacy}", "received_events_url": "https://api.github.com/users/dberlin/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "d6bc05d4a4d310d7a29e5c8e01be8467cd7eedcb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d6bc05d4a4d310d7a29e5c8e01be8467cd7eedcb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d6bc05d4a4d310d7a29e5c8e01be8467cd7eedcb"}], "stats": {"total": 43, "additions": 37, "deletions": 6}, "files": [{"sha": "f9cfb2e8908659c3e72b73e19b68901d3627a877", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d7705934ec047cd09f8d6781749578963c2356ff/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d7705934ec047cd09f8d6781749578963c2356ff/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=d7705934ec047cd09f8d6781749578963c2356ff", "patch": "@@ -1,3 +1,11 @@\n+2007-08-09  Daniel Berlin  <dberlin@dberlin.org>\n+\n+\t* c-typeck.c (readonly_error): Improve error for assignment.\n+\t\n+\t* c-pretty-print.c (pp_c_additive_expression): Handle pointer-plus\n+\texpression. \n+\t(pp_c_expression): Ditto.\n+\n 2007-08-09  Simon Baldwin  <simonb@google.com>\n \n \t* simplify-rtx.c (simplify_binary_operation_1): Removed erroneous"}, {"sha": "a5dd82fb0b5bfedd5d3e23b3cb757be9908dd6ab", "filename": "gcc/c-pretty-print.c", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d7705934ec047cd09f8d6781749578963c2356ff/gcc%2Fc-pretty-print.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d7705934ec047cd09f8d6781749578963c2356ff/gcc%2Fc-pretty-print.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-pretty-print.c?ref=d7705934ec047cd09f8d6781749578963c2356ff", "patch": "@@ -1597,11 +1597,12 @@ pp_c_additive_expression (c_pretty_printer *pp, tree e)\n   enum tree_code code = TREE_CODE (e);\n   switch (code)\n     {\n+    case POINTER_PLUS_EXPR:\n     case PLUS_EXPR:\n     case MINUS_EXPR:\n       pp_c_additive_expression (pp, TREE_OPERAND (e, 0));\n       pp_c_whitespace (pp);\n-      if (code == PLUS_EXPR)\n+      if (code == PLUS_EXPR || code == POINTER_PLUS_EXPR)\n \tpp_plus (pp);\n       else\n \tpp_minus (pp);\n@@ -1979,6 +1980,7 @@ pp_c_expression (c_pretty_printer *pp, tree e)\n       pp_conditional_expression (pp, e);\n       break;\n \n+    case POINTER_PLUS_EXPR:\n     case PLUS_EXPR:\n     case MINUS_EXPR:\n       pp_c_additive_expression (pp, e);"}, {"sha": "3e209e2cd701699175b0205d800bc33d7d56c49c", "filename": "gcc/c-typeck.c", "status": "modified", "additions": 5, "deletions": 4, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d7705934ec047cd09f8d6781749578963c2356ff/gcc%2Fc-typeck.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d7705934ec047cd09f8d6781749578963c2356ff/gcc%2Fc-typeck.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-typeck.c?ref=d7705934ec047cd09f8d6781749578963c2356ff", "patch": "@@ -3152,10 +3152,11 @@ readonly_error (tree arg, enum lvalue_use use)\n \t\t\t G_(\"read-only variable %qD used as %<asm%> output\")),\n \t   arg);\n   else\n-    error (READONLY_MSG (G_(\"assignment of read-only location\"),\n-\t\t\t G_(\"increment of read-only location\"),\n-\t\t\t G_(\"decrement of read-only location\"),\n-\t\t\t G_(\"read-only location used as %<asm%> output\")));\n+    error (READONLY_MSG (G_(\"assignment of read-only location %qE\"),\n+\t\t\t G_(\"increment of read-only location %qE\"),\n+\t\t\t G_(\"decrement of read-only location %qE\"),\n+\t\t\t G_(\"read-only location %qE used as %<asm%> output\")),\n+\t   arg);\n }\n \n "}, {"sha": "e4fcf64a2e042da46a56bd546adc38f0da937467", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d7705934ec047cd09f8d6781749578963c2356ff/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d7705934ec047cd09f8d6781749578963c2356ff/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=d7705934ec047cd09f8d6781749578963c2356ff", "patch": "@@ -1,3 +1,8 @@\n+2007-08-09  Daniel Berlin  <dberlin@dberlin.org>\n+\n+\t* typeck2.c (readonly_error): Handle general expressions.\n+\t* error.c (dump_expr): Handle POINTER_PLUS_EXPR\n+\n 2007-08-06  Dan Hipschman  <dsh@google.com>\n \n \t* method.c (use_thunk): Use DECL_NAME instead of DECL_RTL to"}, {"sha": "46785f97da387ba0ee548d9650fe0698ef28057f", "filename": "gcc/cp/error.c", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d7705934ec047cd09f8d6781749578963c2356ff/gcc%2Fcp%2Ferror.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d7705934ec047cd09f8d6781749578963c2356ff/gcc%2Fcp%2Ferror.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ferror.c?ref=d7705934ec047cd09f8d6781749578963c2356ff", "patch": "@@ -1612,6 +1612,10 @@ dump_expr (tree t, int flags)\n \tdump_expr (TREE_OPERAND (t, 1), flags | TFF_EXPR_IN_PARENS);\n       break;\n \n+    case POINTER_PLUS_EXPR:\n+      dump_binary_op (\"+\", t, flags);\n+      break;\n+\n     case INIT_EXPR:\n     case MODIFY_EXPR:\n     case PLUS_EXPR:"}, {"sha": "f1c3c3258cf79cd6dcdb70465b7395fd700e7edc", "filename": "gcc/cp/typeck2.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d7705934ec047cd09f8d6781749578963c2356ff/gcc%2Fcp%2Ftypeck2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d7705934ec047cd09f8d6781749578963c2356ff/gcc%2Fcp%2Ftypeck2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ftypeck2.c?ref=d7705934ec047cd09f8d6781749578963c2356ff", "patch": "@@ -104,7 +104,7 @@ readonly_error (tree arg, const char* string)\n   else if (TREE_CODE (arg) == FUNCTION_DECL)\n     error (\"%s of function %qD\", string, arg);\n   else\n-    error (\"%s of read-only location\", string);\n+    error (\"%s of read-only location %qE\", string, arg);\n }\n \n \f"}, {"sha": "c5d1c97d877e675d4754747ca9e8a92e3ccdfdae", "filename": "gcc/testsuite/gcc.dg/readonly-loc.c", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d7705934ec047cd09f8d6781749578963c2356ff/gcc%2Ftestsuite%2Fgcc.dg%2Freadonly-loc.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d7705934ec047cd09f8d6781749578963c2356ff/gcc%2Ftestsuite%2Fgcc.dg%2Freadonly-loc.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Freadonly-loc.c?ref=d7705934ec047cd09f8d6781749578963c2356ff", "patch": "@@ -0,0 +1,11 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O\" } */\n+int func()\n+{\n+  const int *arr;\n+  const int arr2[5];\n+  arr[0] = 1; /* { dg-error \"assignment of read-only location\" \"*(arr)\" } */\n+  arr[1] = 1; /* { dg-error \"assignment of read-only location\" \"*(arr + 4u)\" } */\n+  arr2[0] = 1; /* { dg-error \"assignment of read-only location\" \"arr2\\[0\\]\" } */\n+  arr2[1] = 1; /* { dg-error \"assignment of read-only location\" \"arr2\\[1\\]\" } */\n+}"}]}