{"sha": "bbb31a1d5c53076fec251945ae5a500a3e973275", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmJiMzFhMWQ1YzUzMDc2ZmVjMjUxOTQ1YWU1YTUwMGEzZTk3MzI3NQ==", "commit": {"author": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2018-01-10T19:51:24Z"}, "committer": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2018-01-10T19:51:24Z"}, "message": "os, syscall: handle _st_timespec for AIX stat\n    \n    Reviewed-on: https://go-review.googlesource.com/87197\n\nFrom-SVN: r256450", "tree": {"sha": "273fb8b6b872d8a995d3a0bc4552ee862e3691c4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/273fb8b6b872d8a995d3a0bc4552ee862e3691c4"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bbb31a1d5c53076fec251945ae5a500a3e973275", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bbb31a1d5c53076fec251945ae5a500a3e973275", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bbb31a1d5c53076fec251945ae5a500a3e973275", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bbb31a1d5c53076fec251945ae5a500a3e973275/comments", "author": null, "committer": null, "parents": [{"sha": "9a004410d9f64d658864a899ab911ae9a31c444c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9a004410d9f64d658864a899ab911ae9a31c444c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9a004410d9f64d658864a899ab911ae9a31c444c"}], "stats": {"total": 71, "additions": 68, "deletions": 3}, "files": [{"sha": "7abc2136aa6518a6eabf6675959d66dfd1157693", "filename": "gcc/go/gofrontend/MERGE", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bbb31a1d5c53076fec251945ae5a500a3e973275/gcc%2Fgo%2Fgofrontend%2FMERGE", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bbb31a1d5c53076fec251945ae5a500a3e973275/gcc%2Fgo%2Fgofrontend%2FMERGE", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgo%2Fgofrontend%2FMERGE?ref=bbb31a1d5c53076fec251945ae5a500a3e973275", "patch": "@@ -1,4 +1,4 @@\n-d8a9f7433a9e8a81c992ad2908818d2e84f3698b\n+19d94969c5202c07b3b166079b9f4ebbb52dfa6b\n \n The first line of this file holds the git revision number of the last\n merge done from the gofrontend repository."}, {"sha": "265761f98bc6dedd171be2cfd242266d0f7a3848", "filename": "libgo/go/os/stat_aix.go", "status": "added", "additions": 51, "deletions": 0, "changes": 51, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bbb31a1d5c53076fec251945ae5a500a3e973275/libgo%2Fgo%2Fos%2Fstat_aix.go", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bbb31a1d5c53076fec251945ae5a500a3e973275/libgo%2Fgo%2Fos%2Fstat_aix.go", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgo%2Fgo%2Fos%2Fstat_aix.go?ref=bbb31a1d5c53076fec251945ae5a500a3e973275", "patch": "@@ -0,0 +1,51 @@\n+// Copyright 2009 The Go Authors. All rights reserved.\n+// Use of this source code is governed by a BSD-style\n+// license that can be found in the LICENSE file.\n+\n+package os\n+\n+import (\n+\t\"syscall\"\n+\t\"time\"\n+)\n+\n+func fillFileStatFromSys(fs *fileStat, name string) {\n+\tfs.name = basename(name)\n+\tfs.size = int64(fs.sys.Size)\n+\tfs.modTime = stTimespecToTime(fs.sys.Mtim)\n+\tfs.mode = FileMode(fs.sys.Mode & 0777)\n+\tswitch fs.sys.Mode & syscall.S_IFMT {\n+\tcase syscall.S_IFBLK:\n+\t\tfs.mode |= ModeDevice\n+\tcase syscall.S_IFCHR:\n+\t\tfs.mode |= ModeDevice | ModeCharDevice\n+\tcase syscall.S_IFDIR:\n+\t\tfs.mode |= ModeDir\n+\tcase syscall.S_IFIFO:\n+\t\tfs.mode |= ModeNamedPipe\n+\tcase syscall.S_IFLNK:\n+\t\tfs.mode |= ModeSymlink\n+\tcase syscall.S_IFREG:\n+\t\t// nothing to do\n+\tcase syscall.S_IFSOCK:\n+\t\tfs.mode |= ModeSocket\n+\t}\n+\tif fs.sys.Mode&syscall.S_ISGID != 0 {\n+\t\tfs.mode |= ModeSetgid\n+\t}\n+\tif fs.sys.Mode&syscall.S_ISUID != 0 {\n+\t\tfs.mode |= ModeSetuid\n+\t}\n+\tif fs.sys.Mode&syscall.S_ISVTX != 0 {\n+\t\tfs.mode |= ModeSticky\n+\t}\n+}\n+\n+func stTimespecToTime(ts syscall.StTimespec) time.Time {\n+\treturn time.Unix(int64(ts.Sec), int64(ts.Nsec))\n+}\n+\n+// For testing.\n+func atime(fi FileInfo) time.Time {\n+\treturn stTimespecToTime(fi.Sys().(*syscall.Stat_t).Atim)\n+}"}, {"sha": "ef8a574e7bbd8be08f28e44af7c09d308a5e1f75", "filename": "libgo/go/os/stat_atim.go", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bbb31a1d5c53076fec251945ae5a500a3e973275/libgo%2Fgo%2Fos%2Fstat_atim.go", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bbb31a1d5c53076fec251945ae5a500a3e973275/libgo%2Fgo%2Fos%2Fstat_atim.go", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgo%2Fgo%2Fos%2Fstat_atim.go?ref=bbb31a1d5c53076fec251945ae5a500a3e973275", "patch": "@@ -2,7 +2,7 @@\n // Use of this source code is governed by a BSD-style\n // license that can be found in the LICENSE file.\n \n-// +build aix linux openbsd solaristag\n+// +build linux openbsd solaristag\n \n package os\n "}, {"sha": "231ff40500f2cc6f22930a32f87758bd6f5121ea", "filename": "libgo/go/syscall/syscall_aix.go", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bbb31a1d5c53076fec251945ae5a500a3e973275/libgo%2Fgo%2Fsyscall%2Fsyscall_aix.go", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bbb31a1d5c53076fec251945ae5a500a3e973275/libgo%2Fgo%2Fsyscall%2Fsyscall_aix.go", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgo%2Fgo%2Fsyscall%2Fsyscall_aix.go?ref=bbb31a1d5c53076fec251945ae5a500a3e973275", "patch": "@@ -6,6 +6,14 @@ package syscall\n \n import \"unsafe\"\n \n+func (ts *StTimespec) Unix() (sec int64, nsec int64) {\n+\treturn int64(ts.Sec), int64(ts.Nsec)\n+}\n+\n+func (ts *StTimespec) Nano() int64 {\n+\treturn int64(ts.Sec)*1e9 + int64(ts.Nsec)\n+}\n+\n func direntIno(buf []byte) (uint64, bool) {\n \treturn readInt(buf, unsafe.Offsetof(Dirent{}.Ino), unsafe.Sizeof(Dirent{}.Ino))\n }"}, {"sha": "35ce1410ac0d6771cbe0f72648afe80515b64f55", "filename": "libgo/mksysinfo.sh", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bbb31a1d5c53076fec251945ae5a500a3e973275/libgo%2Fmksysinfo.sh", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bbb31a1d5c53076fec251945ae5a500a3e973275/libgo%2Fmksysinfo.sh", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgo%2Fmksysinfo.sh?ref=bbb31a1d5c53076fec251945ae5a500a3e973275", "patch": "@@ -443,6 +443,12 @@ grep '^type _tms ' gen-sysinfo.go | \\\n       -e 's/tms_cstime/Cstime/' \\\n     >> ${OUT}\n \n+# AIX uses st_timespec struct for stat.\n+grep '^type _st_timespec ' gen-sysinfo.go | \\\n+    sed -e 's/type _st_timespec /type StTimespec /' \\\n+      -e 's/tv_sec/Sec/' \\\n+      -e 's/tv_nsec/Nsec/' >> ${OUT}\n+\n # The stat type.\n # Prefer largefile variant if available.\n stat=`grep '^type _stat64 ' gen-sysinfo.go || true`\n@@ -467,7 +473,7 @@ fi | sed -e 's/type _stat64/type Stat_t/' \\\n          -e 's/st_ctim/Ctim/' \\\n          -e 's/\\([^a-zA-Z0-9_]\\)_timeval\\([^a-zA-Z0-9_]\\)/\\1Timeval\\2/g' \\\n          -e 's/\\([^a-zA-Z0-9_]\\)_timespec_t\\([^a-zA-Z0-9_]\\)/\\1Timespec\\2/g' \\\n-         -e 's/\\([^a-zA-Z0-9_]\\)_st_timespec_t\\([^a-zA-Z0-9_]\\)/\\1Timespec\\2/g' \\\n+         -e 's/\\([^a-zA-Z0-9_]\\)_st_timespec_t\\([^a-zA-Z0-9_]\\)/\\1StTimespec\\2/g' \\\n          -e 's/\\([^a-zA-Z0-9_]\\)_timespec\\([^a-zA-Z0-9_]\\)/\\1Timespec\\2/g' \\\n          -e 's/\\([^a-zA-Z0-9_]\\)_timestruc_t\\([^a-zA-Z0-9_]\\)/\\1Timestruc\\2/g' \\\n          -e 's/Godump_[0-9] struct { \\([^;]*;\\) };/\\1/g' \\"}]}