{"sha": "cc6fe784486b77d96bd4cb9cb1d6556c1d5480fb", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Y2M2ZmU3ODQ0ODZiNzdkOTZiZDRjYjljYjFkNjU1NmMxZDU0ODBmYg==", "commit": {"author": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2017-11-29T21:54:18Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2017-11-29T21:54:18Z"}, "message": "re PR c++/82293 (ICE in nonlambda_method_basetype at gcc/cp/lambda.c:886)\n\n/cp\n2017-11-29  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/82293\n\t* lambda.c (nonlambda_method_basetype): Don't use LAMBDA_TYPE_P\n\ton a null type.\n\n/testsuite\n2017-11-29  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/82293\n\t* g++.dg/cpp0x/lambda/lambda-ice24.C: New.\n\nFrom-SVN: r255254", "tree": {"sha": "edced92b46072cae0548f7af7900988498be436a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/edced92b46072cae0548f7af7900988498be436a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/cc6fe784486b77d96bd4cb9cb1d6556c1d5480fb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cc6fe784486b77d96bd4cb9cb1d6556c1d5480fb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cc6fe784486b77d96bd4cb9cb1d6556c1d5480fb", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cc6fe784486b77d96bd4cb9cb1d6556c1d5480fb/comments", "author": null, "committer": null, "parents": [{"sha": "e3704417fa5e3ab896ae766087783b098a2f2f8f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e3704417fa5e3ab896ae766087783b098a2f2f8f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e3704417fa5e3ab896ae766087783b098a2f2f8f"}], "stats": {"total": 27, "additions": 25, "deletions": 2}, "files": [{"sha": "f9fdf1b91d4dac5b048790e13429d5d920de8be2", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cc6fe784486b77d96bd4cb9cb1d6556c1d5480fb/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cc6fe784486b77d96bd4cb9cb1d6556c1d5480fb/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=cc6fe784486b77d96bd4cb9cb1d6556c1d5480fb", "patch": "@@ -1,3 +1,9 @@\n+2017-11-29  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/82293\n+\t* lambda.c (nonlambda_method_basetype): Don't use LAMBDA_TYPE_P\n+\ton a null type.\n+\n 2017-11-29  Jason Merrill  <jason@redhat.com>\n \n \tPR c++/82760 - memory corruption with aligned new.\n@@ -12,7 +18,7 @@\n \t(note_break_stmt, note_iteration_stmt_body_start,\n \tnote_iteration_stmt_body_end): Declare.\n \t* decl.c (struct cp_switch): Add has_default_p, break_stmt_seen_p\n-\tand in_loop_body_p fields. \n+\tand in_loop_body_p fields.\n \t(push_switch): Clear them.\n \t(pop_switch): Set SWITCH_STMT_CANNOT_FALLTHRU_P if has_default_p\n \tand !break_stmt_seen_p.  Assert in_loop_body_p is false."}, {"sha": "c06f4415ebd5d4a9e1798a9937f941dd97c84a98", "filename": "gcc/cp/lambda.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cc6fe784486b77d96bd4cb9cb1d6556c1d5480fb/gcc%2Fcp%2Flambda.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cc6fe784486b77d96bd4cb9cb1d6556c1d5480fb/gcc%2Fcp%2Flambda.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Flambda.c?ref=cc6fe784486b77d96bd4cb9cb1d6556c1d5480fb", "patch": "@@ -920,7 +920,7 @@ nonlambda_method_basetype (void)\n     return NULL_TREE;\n \n   type = current_class_type;\n-  if (!LAMBDA_TYPE_P (type))\n+  if (!type || !LAMBDA_TYPE_P (type))\n     return type;\n \n   /* Find the nearest enclosing non-lambda function.  */"}, {"sha": "f65c3d916b6476a480ba29385187f2eabc7c1c81", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cc6fe784486b77d96bd4cb9cb1d6556c1d5480fb/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cc6fe784486b77d96bd4cb9cb1d6556c1d5480fb/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=cc6fe784486b77d96bd4cb9cb1d6556c1d5480fb", "patch": "@@ -1,3 +1,8 @@\n+2017-11-29  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/82293\n+\t* g++.dg/cpp0x/lambda/lambda-ice24.C: New.\n+\n 2017-11-29  Will Schmidt  <will_schmidt@vnet.ibm.com>\n \n \t* gcc.target/powerpc/fold-vec-ld-char.c: Add lxv to expected output."}, {"sha": "2f42d7145210345c17c51c18f7c439693017af50", "filename": "gcc/testsuite/g++.dg/cpp0x/lambda/lambda-ice24.C", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cc6fe784486b77d96bd4cb9cb1d6556c1d5480fb/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Flambda%2Flambda-ice24.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cc6fe784486b77d96bd4cb9cb1d6556c1d5480fb/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Flambda%2Flambda-ice24.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Flambda%2Flambda-ice24.C?ref=cc6fe784486b77d96bd4cb9cb1d6556c1d5480fb", "patch": "@@ -0,0 +1,12 @@\n+// PR c++/82293\n+// { dg-do compile { target c++11 } }\n+// { dg-options \"-Wshadow\" }\n+\n+template <typename>\n+struct S {\n+  int f{[this](){return 42;}()};\n+};\n+\n+int main(){\n+  return S<int>{}.f;\n+}"}]}