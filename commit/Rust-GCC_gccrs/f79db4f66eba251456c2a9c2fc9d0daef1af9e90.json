{"sha": "f79db4f66eba251456c2a9c2fc9d0daef1af9e90", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Zjc5ZGI0ZjY2ZWJhMjUxNDU2YzJhOWMyZmM5ZDBkYWVmMWFmOWU5MA==", "commit": {"author": {"name": "Andrew Pinski", "email": "andrew_pinski@playstation.sony.com", "date": "2008-02-23T17:58:48Z"}, "committer": {"name": "Andrew Pinski", "email": "pinskia@gcc.gnu.org", "date": "2008-02-23T17:58:48Z"}, "message": "re PR tree-optimization/33512 (Simple bitwise simplification missed)\n\n2008-02-23  Andrew Pinski  <andrew_pinski@playstation.sony.com>\n\n        PR rtl-opt/33512\n        * simplify-rtx.c (simplify_binary_operation_1): Add simplification\n        of (and X (ior (not X) Y) and (and (ior (not X) Y) X).\n\n2008-02-23  Andrew Pinski  <andrew_pinski@playstation.sony.com>\n\n        PR rtl-opt/33512\n        * gcc.dg/and-1.c: New test.\n\nFrom-SVN: r132575", "tree": {"sha": "ee2a5464a8fd46288917b5f1ea33c72955e8af86", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ee2a5464a8fd46288917b5f1ea33c72955e8af86"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f79db4f66eba251456c2a9c2fc9d0daef1af9e90", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f79db4f66eba251456c2a9c2fc9d0daef1af9e90", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f79db4f66eba251456c2a9c2fc9d0daef1af9e90", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f79db4f66eba251456c2a9c2fc9d0daef1af9e90/comments", "author": null, "committer": null, "parents": [{"sha": "bb1f73c2d57ad7e535fe8dbcc52e2d3a3bc680de", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bb1f73c2d57ad7e535fe8dbcc52e2d3a3bc680de", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bb1f73c2d57ad7e535fe8dbcc52e2d3a3bc680de"}], "stats": {"total": 34, "additions": 34, "deletions": 0}, "files": [{"sha": "9bf9a9d915a1603ae4f50d736494e52cb0f30579", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f79db4f66eba251456c2a9c2fc9d0daef1af9e90/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f79db4f66eba251456c2a9c2fc9d0daef1af9e90/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=f79db4f66eba251456c2a9c2fc9d0daef1af9e90", "patch": "@@ -1,3 +1,9 @@\n+2008-02-23  Andrew Pinski  <andrew_pinski@playstation.sony.com>\n+\n+\tPR rtl-opt/33512\n+\t* simplify-rtx.c (simplify_binary_operation_1): Add simplification\n+\tof (and X (ior (not X) Y) and (and (ior (not X) Y) X).\n+\n 2008-02-23  Andrew Pinski  <andrew_pinski@playstation.sony.com>\n \n \tPR pch/35027"}, {"sha": "03fbc750dcf93235682986b27546cc5b9b8d6f0c", "filename": "gcc/simplify-rtx.c", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f79db4f66eba251456c2a9c2fc9d0daef1af9e90/gcc%2Fsimplify-rtx.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f79db4f66eba251456c2a9c2fc9d0daef1af9e90/gcc%2Fsimplify-rtx.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fsimplify-rtx.c?ref=f79db4f66eba251456c2a9c2fc9d0daef1af9e90", "patch": "@@ -2428,6 +2428,19 @@ simplify_binary_operation_1 (enum rtx_code code, enum machine_mode mode,\n \t      return simplify_gen_binary (code, mode, tem, op1);\n \t    }\n \t}\n+\n+      /* (and X (ior (not X) Y) -> (and X Y) */\n+      if (GET_CODE (op1) == IOR\n+\t  && GET_CODE (XEXP (op1, 0)) == NOT\n+\t  && op0 == XEXP (XEXP (op1, 0), 0))\n+       return simplify_gen_binary (AND, mode, op0, XEXP (op1, 1));\n+\n+      /* (and (ior (not X) Y) X) -> (and X Y) */\n+      if (GET_CODE (op0) == IOR\n+\t  && GET_CODE (XEXP (op0, 0)) == NOT\n+\t  && op1 == XEXP (XEXP (op0, 0), 0))\n+\treturn simplify_gen_binary (AND, mode, op1, XEXP (op0, 1));\n+\n       tem = simplify_associative_operation (code, mode, op0, op1);\n       if (tem)\n \treturn tem;"}, {"sha": "e53852be3e6427bcb5e96fbb1c51e643fc0a325d", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f79db4f66eba251456c2a9c2fc9d0daef1af9e90/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f79db4f66eba251456c2a9c2fc9d0daef1af9e90/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=f79db4f66eba251456c2a9c2fc9d0daef1af9e90", "patch": "@@ -1,3 +1,8 @@\n+2008-02-23  Andrew Pinski  <andrew_pinski@playstation.sony.com>\n+\n+\tPR rtl-opt/33512\n+\t* gcc.dg/and-1.c: New test.\n+\n 2008-02-23  Daniel Jacobowitz  <dan@codesourcery.com>\n \n \t* gcc.c-torture/execute/20080222-1.c: New test."}, {"sha": "c66e4e15face9695af7ba7b9d5f7da547d73ab2e", "filename": "gcc/testsuite/gcc.dg/and-1.c", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f79db4f66eba251456c2a9c2fc9d0daef1af9e90/gcc%2Ftestsuite%2Fgcc.dg%2Fand-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f79db4f66eba251456c2a9c2fc9d0daef1af9e90/gcc%2Ftestsuite%2Fgcc.dg%2Fand-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fand-1.c?ref=f79db4f66eba251456c2a9c2fc9d0daef1af9e90", "patch": "@@ -0,0 +1,10 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O2\" } */\n+/* { dg-final { scan-assembler \"and\" { target powerpc*-*-* spu-*-* } } } */\n+/* There should be no nand for this testcase (for either PPC or SPU). */\n+/* { dg-final { scan-assembler-not \"nand\" { target powerpc*-*-* spu-*-* } } } */\n+\n+int f(int y)\n+{\n+  return y & ~(y & -y);\n+}"}]}