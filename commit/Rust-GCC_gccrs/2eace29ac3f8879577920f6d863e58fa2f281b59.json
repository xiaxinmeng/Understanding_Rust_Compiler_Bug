{"sha": "2eace29ac3f8879577920f6d863e58fa2f281b59", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MmVhY2UyOWFjM2Y4ODc5NTc3OTIwZjZkODYzZTU4ZmEyZjI4MWI1OQ==", "commit": {"author": {"name": "Mikael Morin", "email": "mikael@gcc.gnu.org", "date": "2011-11-03T23:17:08Z"}, "committer": {"name": "Mikael Morin", "email": "mikael@gcc.gnu.org", "date": "2011-11-03T23:17:08Z"}, "message": "trans.h (struct gfc_ss): New field parent.\n\n\t* trans.h (struct gfc_ss): New field parent.\n\t* trans-array.c (gfc_trans_scalarizing_loops): Skip clearing if a\n\tparent exists.\n\t* trans-expr.c (gfc_advance_se_ss_chain): Move to parent ss at the\n\tend of the chain.\n\nFrom-SVN: r180889", "tree": {"sha": "a269c2bd3b9affda08aaf4c98ba705eb1e1d2b1c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a269c2bd3b9affda08aaf4c98ba705eb1e1d2b1c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2eace29ac3f8879577920f6d863e58fa2f281b59", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2eace29ac3f8879577920f6d863e58fa2f281b59", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2eace29ac3f8879577920f6d863e58fa2f281b59", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2eace29ac3f8879577920f6d863e58fa2f281b59/comments", "author": null, "committer": null, "parents": [{"sha": "4164579308306672bbc5c1b8f6261d2cae352320", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4164579308306672bbc5c1b8f6261d2cae352320", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4164579308306672bbc5c1b8f6261d2cae352320"}], "stats": {"total": 25, "additions": 23, "deletions": 2}, "files": [{"sha": "a552beade86aa75b32384600f2a5a3432fd556c2", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2eace29ac3f8879577920f6d863e58fa2f281b59/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2eace29ac3f8879577920f6d863e58fa2f281b59/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=2eace29ac3f8879577920f6d863e58fa2f281b59", "patch": "@@ -1,3 +1,11 @@\n+2011-11-03  Mikael Morin  <mikael@gcc.gnu.org>\n+\n+\t* trans.h (struct gfc_ss): New field parent.\n+\t* trans-array.c (gfc_trans_scalarizing_loops): Skip clearing if a\n+\tparent exists.\n+\t* trans-expr.c (gfc_advance_se_ss_chain): Move to parent ss at the\n+\tend of the chain.\n+\n 2011-11-03  Mikael Morin  <mikael@gcc.gnu.org>\n \n \t* trans-array.h (gfc_trans_create_temp_array): Remove loop argument."}, {"sha": "abff8b5dc732457e5f31957c3728c51340354688", "filename": "gcc/fortran/trans-array.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2eace29ac3f8879577920f6d863e58fa2f281b59/gcc%2Ffortran%2Ftrans-array.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2eace29ac3f8879577920f6d863e58fa2f281b59/gcc%2Ffortran%2Ftrans-array.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-array.c?ref=2eace29ac3f8879577920f6d863e58fa2f281b59", "patch": "@@ -3193,7 +3193,8 @@ gfc_trans_scalarizing_loops (gfc_loopinfo * loop, stmtblock_t * body)\n \n   /* Clear all the used flags.  */\n   for (ss = loop->ss; ss != gfc_ss_terminator; ss = ss->loop_chain)\n-    ss->info->useflags = 0;\n+    if (ss->parent == NULL)\n+      ss->info->useflags = 0;\n }\n \n "}, {"sha": "72d35f8de8946bc7c19dbbe6bc80b96ad6227ffd", "filename": "gcc/fortran/trans-expr.c", "status": "modified", "additions": 10, "deletions": 1, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2eace29ac3f8879577920f6d863e58fa2f281b59/gcc%2Ffortran%2Ftrans-expr.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2eace29ac3f8879577920f6d863e58fa2f281b59/gcc%2Ffortran%2Ftrans-expr.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-expr.c?ref=2eace29ac3f8879577920f6d863e58fa2f281b59", "patch": "@@ -83,6 +83,7 @@ void\n gfc_advance_se_ss_chain (gfc_se * se)\n {\n   gfc_se *p;\n+  gfc_ss *ss;\n \n   gcc_assert (se != NULL && se->ss != NULL && se->ss != gfc_ss_terminator);\n \n@@ -93,7 +94,15 @@ gfc_advance_se_ss_chain (gfc_se * se)\n       /* Simple consistency check.  */\n       gcc_assert (p->parent == NULL || p->parent->ss == p->ss);\n \n-      p->ss = p->ss->next;\n+      /* If we were in a nested loop, the next scalarized expression can be\n+\t on the parent ss' next pointer.  Thus we should not take the next\n+\t pointer blindly, but rather go up one nest level as long as next\n+\t is the end of chain.  */\n+      ss = p->ss;\n+      while (ss->next == gfc_ss_terminator && ss->parent != NULL)\n+\tss = ss->parent;\n+\n+      p->ss = ss->next;\n \n       p = p->parent;\n     }"}, {"sha": "53c5ce25fa4bc700ccd06c02bf9181ba4b17fe4d", "filename": "gcc/fortran/trans.h", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2eace29ac3f8879577920f6d863e58fa2f281b59/gcc%2Ffortran%2Ftrans.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2eace29ac3f8879577920f6d863e58fa2f281b59/gcc%2Ffortran%2Ftrans.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans.h?ref=2eace29ac3f8879577920f6d863e58fa2f281b59", "patch": "@@ -246,6 +246,9 @@ typedef struct gfc_ss\n   struct gfc_ss *loop_chain;\n   struct gfc_ss *next;\n \n+  /* Non-null if the ss is part of a nested loop.  */\n+  struct gfc_ss *parent;\n+\n   /* The loop this gfc_ss is in.  */\n   struct gfc_loopinfo *loop;\n "}]}