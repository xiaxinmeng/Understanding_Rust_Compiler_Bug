{"sha": "2d041117f1ee47982a2d8a2a9801f2906df2d91f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MmQwNDExMTdmMWVlNDc5ODJhMmQ4YTJhOTgwMWYyOTA2ZGYyZDkxZg==", "commit": {"author": {"name": "Alan Modra", "email": "amodra@gmail.com", "date": "2017-11-07T04:54:01Z"}, "committer": {"name": "Alan Modra", "email": "amodra@gcc.gnu.org", "date": "2017-11-07T04:54:01Z"}, "message": "Require ngettext in test of system gettext implementation\n\ngcc currently uses ngettext in a number of places (gcc/cp/pt.c,\ngcc/diagnostic.c, gcc/collect2.c).  Apparently there are (or used to\nbe) gettext implementations that lack ngettext.  See config/gettext.m4.\n\nThis patch arranges for intl/ to be compiled when the system gettext\nlacks ngettext.\n\n\t* configure.ac: Invoke AM_GNU_GETTEXT with need_ngettext.\n\t* configure: Regenerate.\n\nFrom-SVN: r254486", "tree": {"sha": "2ca2957253ad56dc167fa1e15aea016de8595408", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2ca2957253ad56dc167fa1e15aea016de8595408"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2d041117f1ee47982a2d8a2a9801f2906df2d91f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2d041117f1ee47982a2d8a2a9801f2906df2d91f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2d041117f1ee47982a2d8a2a9801f2906df2d91f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2d041117f1ee47982a2d8a2a9801f2906df2d91f/comments", "author": {"login": "amodra", "id": 6006325, "node_id": "MDQ6VXNlcjYwMDYzMjU=", "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4", "gravatar_id": "", "url": "https://api.github.com/users/amodra", "html_url": "https://github.com/amodra", "followers_url": "https://api.github.com/users/amodra/followers", "following_url": "https://api.github.com/users/amodra/following{/other_user}", "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}", "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/amodra/subscriptions", "organizations_url": "https://api.github.com/users/amodra/orgs", "repos_url": "https://api.github.com/users/amodra/repos", "events_url": "https://api.github.com/users/amodra/events{/privacy}", "received_events_url": "https://api.github.com/users/amodra/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "0ed1b4890a9cc4be7e24416a37eb14638f5adf7e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0ed1b4890a9cc4be7e24416a37eb14638f5adf7e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0ed1b4890a9cc4be7e24416a37eb14638f5adf7e"}], "stats": {"total": 47, "additions": 26, "deletions": 21}, "files": [{"sha": "6150e7e250f4c027b3c2b926cb9c4886f7d6aef3", "filename": "intl/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2d041117f1ee47982a2d8a2a9801f2906df2d91f/intl%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2d041117f1ee47982a2d8a2a9801f2906df2d91f/intl%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/intl%2FChangeLog?ref=2d041117f1ee47982a2d8a2a9801f2906df2d91f", "patch": "@@ -1,3 +1,8 @@\n+2017-11-07  Alan Modra  <amodra@gmail.com>\n+\n+\t* configure.ac: Invoke AM_GNU_GETTEXT with need_ngettext.\n+\t* configure: Regenerate.\n+\n 2016-11-15  Matthias Klose  <doko@ubuntu.com>\n \n \t* configure: Regenerate."}, {"sha": "2abbcb5b051e0a5988ad536c7458d689842a35d2", "filename": "intl/configure", "status": "modified", "additions": 20, "deletions": 20, "changes": 40, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2d041117f1ee47982a2d8a2a9801f2906df2d91f/intl%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2d041117f1ee47982a2d8a2a9801f2906df2d91f/intl%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/intl%2Fconfigure?ref=2d041117f1ee47982a2d8a2a9801f2906df2d91f", "patch": "@@ -5813,7 +5813,7 @@ $as_echo \"$nls_cv_force_use_gnu_gettext\" >&6; }\n \n         { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for GNU gettext in libc\" >&5\n $as_echo_n \"checking for GNU gettext in libc... \" >&6; }\n-if test \"${gt_cv_func_gnugettext1_libc+set}\" = set; then :\n+if test \"${gt_cv_func_gnugettext2_libc+set}\" = set; then :\n   $as_echo_n \"(cached) \" >&6\n else\n   cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n@@ -5825,23 +5825,23 @@ int\n main ()\n {\n bindtextdomain (\"\", \"\");\n-return (int) gettext (\"\") + _nl_msg_cat_cntr + *_nl_domain_bindings\n+return (int) gettext (\"\") + (int) ngettext (\"\", \"\", 0) + _nl_msg_cat_cntr + *_nl_domain_bindings\n   ;\n   return 0;\n }\n _ACEOF\n if ac_fn_c_try_link \"$LINENO\"; then :\n-  gt_cv_func_gnugettext1_libc=yes\n+  gt_cv_func_gnugettext2_libc=yes\n else\n-  gt_cv_func_gnugettext1_libc=no\n+  gt_cv_func_gnugettext2_libc=no\n fi\n rm -f core conftest.err conftest.$ac_objext \\\n     conftest$ac_exeext conftest.$ac_ext\n fi\n-{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $gt_cv_func_gnugettext1_libc\" >&5\n-$as_echo \"$gt_cv_func_gnugettext1_libc\" >&6; }\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $gt_cv_func_gnugettext2_libc\" >&5\n+$as_echo \"$gt_cv_func_gnugettext2_libc\" >&6; }\n \n-        if test \"$gt_cv_func_gnugettext1_libc\" != \"yes\"; then\n+        if test \"$gt_cv_func_gnugettext2_libc\" != \"yes\"; then\n \n \n \n@@ -6223,7 +6223,7 @@ fi\n \n           { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for GNU gettext in libintl\" >&5\n $as_echo_n \"checking for GNU gettext in libintl... \" >&6; }\n-if test \"${gt_cv_func_gnugettext1_libintl+set}\" = set; then :\n+if test \"${gt_cv_func_gnugettext2_libintl+set}\" = set; then :\n   $as_echo_n \"(cached) \" >&6\n else\n   gt_save_CPPFLAGS=\"$CPPFLAGS\"\n@@ -6243,19 +6243,19 @@ int\n main ()\n {\n bindtextdomain (\"\", \"\");\n-return (int) gettext (\"\") + _nl_msg_cat_cntr + *_nl_expand_alias (0)\n+return (int) gettext (\"\") + (int) ngettext (\"\", \"\", 0) + _nl_msg_cat_cntr + *_nl_expand_alias (0)\n   ;\n   return 0;\n }\n _ACEOF\n if ac_fn_c_try_link \"$LINENO\"; then :\n-  gt_cv_func_gnugettext1_libintl=yes\n+  gt_cv_func_gnugettext2_libintl=yes\n else\n-  gt_cv_func_gnugettext1_libintl=no\n+  gt_cv_func_gnugettext2_libintl=no\n fi\n rm -f core conftest.err conftest.$ac_objext \\\n     conftest$ac_exeext conftest.$ac_ext\n-                        if test \"$gt_cv_func_gnugettext1_libintl\" != yes && test -n \"$LIBICONV\"; then\n+                        if test \"$gt_cv_func_gnugettext2_libintl\" != yes && test -n \"$LIBICONV\"; then\n               LIBS=\"$LIBS $LIBICONV\"\n               cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n /* end confdefs.h.  */\n@@ -6270,15 +6270,15 @@ int\n main ()\n {\n bindtextdomain (\"\", \"\");\n-return (int) gettext (\"\") + _nl_msg_cat_cntr + *_nl_expand_alias (0)\n+return (int) gettext (\"\") + (int) ngettext (\"\", \"\", 0) + _nl_msg_cat_cntr + *_nl_expand_alias (0)\n   ;\n   return 0;\n }\n _ACEOF\n if ac_fn_c_try_link \"$LINENO\"; then :\n   LIBINTL=\"$LIBINTL $LIBICONV\"\n                 LTLIBINTL=\"$LTLIBINTL $LTLIBICONV\"\n-                gt_cv_func_gnugettext1_libintl=yes\n+                gt_cv_func_gnugettext2_libintl=yes\n \n fi\n rm -f core conftest.err conftest.$ac_objext \\\n@@ -6287,12 +6287,12 @@ rm -f core conftest.err conftest.$ac_objext \\\n             CPPFLAGS=\"$gt_save_CPPFLAGS\"\n             LIBS=\"$gt_save_LIBS\"\n fi\n-{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $gt_cv_func_gnugettext1_libintl\" >&5\n-$as_echo \"$gt_cv_func_gnugettext1_libintl\" >&6; }\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $gt_cv_func_gnugettext2_libintl\" >&5\n+$as_echo \"$gt_cv_func_gnugettext2_libintl\" >&6; }\n         fi\n \n-                                        if test \"$gt_cv_func_gnugettext1_libc\" = \"yes\" \\\n-           || { test \"$gt_cv_func_gnugettext1_libintl\" = \"yes\" \\\n+                                        if test \"$gt_cv_func_gnugettext2_libc\" = \"yes\" \\\n+           || { test \"$gt_cv_func_gnugettext2_libintl\" = \"yes\" \\\n                 && test \"$PACKAGE\" != gettext-runtime \\\n                 && test \"$PACKAGE\" != gettext-tools; }; then\n           gt_use_preinstalled_gnugettext=yes\n@@ -6340,7 +6340,7 @@ $as_echo \"$USE_NLS\" >&6; }\n     { $as_echo \"$as_me:${as_lineno-$LINENO}: checking where the gettext function comes from\" >&5\n $as_echo_n \"checking where the gettext function comes from... \" >&6; }\n     if test \"$gt_use_preinstalled_gnugettext\" = \"yes\"; then\n-      if test \"$gt_cv_func_gnugettext1_libintl\" = \"yes\"; then\n+      if test \"$gt_cv_func_gnugettext2_libintl\" = \"yes\"; then\n         gt_source=\"external libintl\"\n       else\n         gt_source=\"libc\"\n@@ -6355,7 +6355,7 @@ $as_echo \"$gt_source\" >&6; }\n   if test \"$USE_NLS\" = \"yes\"; then\n \n     if test \"$gt_use_preinstalled_gnugettext\" = \"yes\"; then\n-      if test \"$gt_cv_func_gnugettext1_libintl\" = \"yes\"; then\n+      if test \"$gt_cv_func_gnugettext2_libintl\" = \"yes\"; then\n         { $as_echo \"$as_me:${as_lineno-$LINENO}: checking how to link with libintl\" >&5\n $as_echo_n \"checking how to link with libintl... \" >&6; }\n         { $as_echo \"$as_me:${as_lineno-$LINENO}: result: $LIBINTL\" >&5"}, {"sha": "36cf97fe4b19cf5ecdd30f54c39cde413c128d09", "filename": "intl/configure.ac", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2d041117f1ee47982a2d8a2a9801f2906df2d91f/intl%2Fconfigure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2d041117f1ee47982a2d8a2a9801f2906df2d91f/intl%2Fconfigure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/intl%2Fconfigure.ac?ref=2d041117f1ee47982a2d8a2a9801f2906df2d91f", "patch": "@@ -4,7 +4,7 @@ AC_CONFIG_SRCDIR(gettext.c)\n AC_CONFIG_HEADER(config.h)\n AC_CONFIG_MACRO_DIR(../config)\n AM_GNU_GETTEXT_VERSION(0.12.1)\n-AM_GNU_GETTEXT\n+AM_GNU_GETTEXT([], [need-ngettext])\n \n # This replaces the extensive use of DEFS in the original Makefile.in.\n AC_DEFINE(IN_LIBINTL, 1, [Define because this is libintl.])"}]}