{"sha": "31607de1b1f4230cf870531ce4ca11b24fad287a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzE2MDdkZTFiMWY0MjMwY2Y4NzA1MzFjZTRjYTExYjI0ZmFkMjg3YQ==", "commit": {"author": {"name": "Chris Fairles", "email": "chris.fairles@gmail.com", "date": "2008-09-03T22:02:04Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2008-09-03T22:02:04Z"}, "message": "condition_variable: Use new deleted ctors.\n\n2008-09-03  Chris Fairles  <chris.fairles@gmail.com>\n\n        * include/std/condition_variable: Use new deleted ctors.\n        * include/std/mutex: Likewise plus implement timed_mutex, \n\trecursive_timed_mutex and call_once.\n\t* src/condition_variable.cc: Implement wait(). Use gthread types.\n\tRemove _GTHREADS_HAS_COND checks in favor of global\n\t_GLIBCXX_HAS_GTHREADS.\n\t* src/mutex.cc (call_once): Implementation using TLS with mutex\n\tfallback.\n\t* config/abi/pre/gnu.ver: Add exported symbols.\n\t* testsuite/lib/libstdc++.exp (check_v3_target_gthreads): New.\n\t* testsuite/lib/dg-options.exp (dg-require-gthreads): Likewise.\n\t* testsuite/30_threads/lock_guard/requirements/typedefs.cc: Use\n\tdg-require-gthreads and dg-require-cstdint.\n\t* testsuite/30_threads/lock_guard/requirements/\n\texplicit_instantiation.cc: Likewise.\n\t* testsuite/30_threads/mutex/dest/destructor_locked.cc: Likewise.\n\t* testsuite/30_threads/mutex/native_handle/1.cc: Likewise.\n\t* testsuite/30_threads/mutex/cons/1.cc: Likewise.\n\t* testsuite/30_threads/mutex/requirements/typedefs.cc: Likewise.\n\t* testsuite/30_threads/mutex/try_lock/1.cc: Likewise.\n\t* testsuite/30_threads/mutex/try_lock/2.cc: Likewise.\n\t* testsuite/30_threads/mutex/lock/1.cc: Likewise.\n\t* testsuite/30_threads/mutex/unlock/1.cc: Likewise.\n\t* testsuite/30_threads/recursive_mutex/dest/destructor_locked.cc:\n\tLikewise.\n        * testsuite/30_threads/recursive_mutex/native_handle/1.cc: Likewise.\n\t* testsuite/30_threads/recursive_mutex/cons/1.cc: Likewise.\n        * testsuite/30_threads/recursive_mutex/requirements/typedefs.cc:\n\tLikewise.\n        * testsuite/30_threads/recursive_mutex/try_lock/1.cc: Likewise.\n        * testsuite/30_threads/recursive_mutex/try_lock/2.cc: Likewise.\n        * testsuite/30_threads/recursive_mutex/lock/1.cc: Likewise.\n        * testsuite/30_threads/recursive_mutex/unlock/1.cc: Likewise.\n\t* testsuite/30_threads/unique_lock/requirements/\n\texplicit_instantiation.cc: Likewise.\n\t* testsuite/30_threads/unique_lock/requirements/typedefs.cc: Likewise.\n        * testsuite/30_threads/mutex/cons/assign_neg.cc: Also adjust dg-error\n\tlines for deleted members.\n        * testsuite/30_threads/mutex/cons/copy_neg.cc: Likewise.\n        * testsuite/30_threads/recursive_mutex/cons/assign_neg.cc: Likewise.\n        * testsuite/30_threads/recursive_mutex/cons/copy_neg.cc: Likewise.\n\t* testsuite/30_threads/call_once/once_flag.cc: New.\n\t* testsuite/30_threads/call_once/call_once1.cc: Likewise.\n\t* testsuite/30_threads/condition_variable/cons/1.cc: Likewise.\n\t* testsuite/30_threads/condition_variable/cons/copy_neg.cc: Likewise\n\t* testsuite/30_threads/condition_variable/cons/assign_neg.cc: Likewise.\n\t* testsuite/30_threads/condition_variable_any/cons/1.cc: Likewise.\n\t* testsuite/30_threads/condition_variable_any/cons/copy_neg.cc:\n\tLikewise.\n\t* testsuite/30_threads/condition_variable_any/cons/assign_neg.cc:\n\tLikewise.\n\t* testsuite/30_threads/timed_mutex/dest/destructor_locked.cc: Likewise.\n\t* testsuite/30_threads/timed_mutex/native_handle/1.cc: Likewise.\n\t* testsuite/30_threads/timed_mutex/try_lock_until/1.cc: Likewise.\n\t* testsuite/30_threads/timed_mutex/try_lock_until/2.cc: Likewise.\n\t* testsuite/30_threads/timed_mutex/cons/assign_neg.cc: Likewise.\n\t* testsuite/30_threads/timed_mutex/cons/1.cc: Likewise.\n\t* testsuite/30_threads/timed_mutex/cons/copy_neg.cc: Likewise.\n\t* testsuite/30_threads/timed_mutex/requirements/typedefs.cc: Likewise.\n\t* testsuite/30_threads/timed_mutex/try_lock/1.cc: Likewise.\n\t* testsuite/30_threads/timed_mutex/try_lock/2.cc: Likewise.\n\t* testsuite/30_threads/timed_mutex/lock/1.cc: Likewise.\n\t* testsuite/30_threads/timed_mutex/unlock/1.cc: Likewise.\n\t* testsuite/30_threads/timed_mutex/try_lock_for/1.cc: Likewise.\n\t* testsuite/30_threads/timed_mutex/try_lock_for/2.cc: Likewise.\n\t* testsuite/30_threads/timed_mutex/try_lock_for/3.cc: Likewise.\n\t* testsuite/30_threads/recursive_timed_mutex/dest/destructor_locked.cc: \n\tLikewise.\n\t* testsuite/30_threads/recursive_timed_mutex/try_lock_until/1.cc: \n\tLikewise.\n\t* testsuite/30_threads/recursive_timed_mutex/try_lock_until/2.cc: \n\tLikewise.\n\t* testsuite/30_threads/recursive_timed_mutex/native_handle/1.cc: \n\tLikewise.\n\t* testsuite/30_threads/recursive_timed_mutex/cons: Likewise.\n\t* testsuite/30_threads/recursive_timed_mutex/cons/assign_neg.cc: \n\tLikewise.\n\t* testsuite/30_threads/recursive_timed_mutex/cons/1.cc: Likewise.\n\t* testsuite/30_threads/recursive_timed_mutex/cons/copy_neg.cc: Likewise.\n\t* testsuite/30_threads/recursive_timed_mutex/requirements/typedefs.cc:\n\tLikewise.\n\t* testsuite/30_threads/recursive_timed_mutex/try_lock/1.cc: Likewise.\n\t* testsuite/30_threads/recursive_timed_mutex/try_lock/2.cc: Likewise.\n\t* testsuite/30_threads/recursive_timed_mutex/lock/1.cc: Likewise.\n\t* testsuite/30_threads/recursive_timed_mutex/lock/2.cc: Likewise.\n\t* testsuite/30_threads/recursive_timed_mutex/unlock/1.cc: Likewise.\n\t* testsuite/30_threads/recursive_timed_mutex/try_lock_for/1.cc:\n\tLikewise.\n\t* testsuite/30_threads/recursive_timed_mutex/try_lock_for/2.cc:\n\tLikewise.\n\t* testsuite/30_threads/recursive_timed_mutex/try_lock_for/3.cc:\n\tLikewise.\n\t* testsuite/30_threads/unique_lock/modifiers/1.cc: Likewise.\n\t* testsuite/30_threads/unique_lock/modifiers/2.cc: Likewise.\n\t* testsuite/30_threads/unique_lock/cons/1.cc: Likewise.\n\t* testsuite/30_threads/unique_lock/cons/2.cc: Likewise.\n\t* testsuite/30_threads/unique_lock/cons/3.cc: Likewise.\n\t* testsuite/30_threads/unique_lock/cons/4.cc: Likewise.\n\t* testsuite/30_threads/unique_lock/cons/5.cc: Likewise.\n\t* testsuite/30_threads/unique_lock/cons/6.cc: Likewise.\n\t* testsuite/30_threads/unique_lock/locking/1.cc: Likewise.\n\t* testsuite/30_threads/unique_lock/locking/2.cc: Likewise.\n\t* testsuite/30_threads/unique_lock/locking/3.cc: Likewise.\n\t* testsuite/30_threads/unique_lock/locking/4.cc: Likewise.\n\nFrom-SVN: r139959", "tree": {"sha": "088d12e249a2fa467f46b127dd986e6fa2069145", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/088d12e249a2fa467f46b127dd986e6fa2069145"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/31607de1b1f4230cf870531ce4ca11b24fad287a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/31607de1b1f4230cf870531ce4ca11b24fad287a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/31607de1b1f4230cf870531ce4ca11b24fad287a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/31607de1b1f4230cf870531ce4ca11b24fad287a/comments", "author": {"login": "chrisfearless", "id": 812000, "node_id": "MDQ6VXNlcjgxMjAwMA==", "avatar_url": "https://avatars.githubusercontent.com/u/812000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chrisfearless", "html_url": "https://github.com/chrisfearless", "followers_url": "https://api.github.com/users/chrisfearless/followers", "following_url": "https://api.github.com/users/chrisfearless/following{/other_user}", "gists_url": "https://api.github.com/users/chrisfearless/gists{/gist_id}", "starred_url": "https://api.github.com/users/chrisfearless/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chrisfearless/subscriptions", "organizations_url": "https://api.github.com/users/chrisfearless/orgs", "repos_url": "https://api.github.com/users/chrisfearless/repos", "events_url": "https://api.github.com/users/chrisfearless/events{/privacy}", "received_events_url": "https://api.github.com/users/chrisfearless/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "3e03c9591c711e01ddcc3bfc01d18ac3a85eb852", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3e03c9591c711e01ddcc3bfc01d18ac3a85eb852", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3e03c9591c711e01ddcc3bfc01d18ac3a85eb852"}], "stats": {"total": 272, "additions": 272, "deletions": 0}, "files": [{"sha": "4650d768412a6fb0f151ca232e1b4ee7d2ee7f48", "filename": "libstdc++-v3/testsuite/30_threads/recursive_mutex/lock/1.cc", "status": "added", "additions": 73, "deletions": 0, "changes": 73, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/31607de1b1f4230cf870531ce4ca11b24fad287a/libstdc%2B%2B-v3%2Ftestsuite%2F30_threads%2Frecursive_mutex%2Flock%2F1.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/31607de1b1f4230cf870531ce4ca11b24fad287a/libstdc%2B%2B-v3%2Ftestsuite%2F30_threads%2Frecursive_mutex%2Flock%2F1.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F30_threads%2Frecursive_mutex%2Flock%2F1.cc?ref=31607de1b1f4230cf870531ce4ca11b24fad287a", "patch": "@@ -0,0 +1,73 @@\n+// { dg-do run { target *-*-freebsd* *-*-netbsd* *-*-linux* *-*-solaris* *-*-cygwin *-*-darwin* alpha*-*-osf* mips-sgi-irix6* } }\n+// { dg-options \" -std=gnu++0x -pthread\" { target *-*-freebsd* *-*-netbsd* *-*-linux* alpha*-*-osf* mips-sgi-irix6* } }\n+// { dg-options \" -std=gnu++0x -pthreads\" { target *-*-solaris* } }\n+// { dg-options \" -std=gnu++0x \" { target *-*-cygwin *-*-darwin* } }\n+// { dg-require-cstdint \"\" }\n+// { dg-require-gthreads \"\" }\n+\n+// Copyright (C) 2008 Free Software Foundation, Inc.\n+//\n+// This file is part of the GNU ISO C++ Library.  This library is free\n+// software; you can redistribute it and/or modify it under the\n+// terms of the GNU General Public License as published by the\n+// Free Software Foundation; either version 2, or (at your option)\n+// any later version.\n+\n+// This library is distributed in the hope that it will be useful,\n+// but WITHOUT ANY WARRANTY; without even the implied warranty of\n+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+// GNU General Public License for more details.\n+\n+// You should have received a copy of the GNU General Public License along\n+// with this library; see the file COPYING.  If not, write to the Free\n+// Software Foundation, 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301,\n+// USA.\n+\n+// As a special exception, you may use this file as part of a free software\n+// library without restriction.  Specifically, if other files instantiate\n+// templates or use macros or inline functions from this file, or you compile\n+// this file and link it with other files to produce an executable, this\n+// file does not by itself cause the resulting executable to be covered by\n+// the GNU General Public License.  This exception does not however\n+// invalidate any other reasons why the executable file might be covered by\n+// the GNU General Public License.\n+\n+#include <mutex>\n+#include <system_error>\n+#include <testsuite_hooks.h>\n+\n+int main()\n+{\n+  bool test __attribute__((unused)) = true;\n+  typedef std::recursive_mutex mutex_type;\n+\n+  try \n+    {\n+      mutex_type m;\n+      m.lock();\n+\n+      // Lock already locked recursive mutex.\n+      try\n+\t{\n+\t  // XXX Will not block.\n+\t  m.lock();\n+\t}\n+      catch (const std::system_error& e)\n+\t{\n+\t  VERIFY( false );\n+\t}\n+\n+      m.unlock();\n+      m.unlock();\n+    }\n+  catch (const std::system_error& e)\n+    {\n+      VERIFY( false );\n+    }\n+  catch (...)\n+    {\n+      VERIFY( false );\n+    }\n+\n+  return 0;\n+}"}, {"sha": "5d83649c42b6ae7ad1a898c8364b53296579368b", "filename": "libstdc++-v3/testsuite/30_threads/recursive_mutex/try_lock/1.cc", "status": "added", "additions": 61, "deletions": 0, "changes": 61, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/31607de1b1f4230cf870531ce4ca11b24fad287a/libstdc%2B%2B-v3%2Ftestsuite%2F30_threads%2Frecursive_mutex%2Ftry_lock%2F1.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/31607de1b1f4230cf870531ce4ca11b24fad287a/libstdc%2B%2B-v3%2Ftestsuite%2F30_threads%2Frecursive_mutex%2Ftry_lock%2F1.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F30_threads%2Frecursive_mutex%2Ftry_lock%2F1.cc?ref=31607de1b1f4230cf870531ce4ca11b24fad287a", "patch": "@@ -0,0 +1,61 @@\n+// { dg-do run { target *-*-freebsd* *-*-netbsd* *-*-linux* *-*-solaris* *-*-cygwin *-*-darwin* alpha*-*-osf* mips-sgi-irix6* } }\n+// { dg-options \" -std=gnu++0x -pthread\" { target *-*-freebsd* *-*-netbsd* *-*-linux* alpha*-*-osf* mips-sgi-irix6* } }\n+// { dg-options \" -std=gnu++0x -pthreads\" { target *-*-solaris* } }\n+// { dg-options \" -std=gnu++0x \" { target *-*-cygwin *-*-darwin* } }\n+// { dg-require-cstdint \"\" }\n+// { dg-require-gthreads \"\" }\n+\n+// Copyright (C) 2008 Free Software Foundation, Inc.\n+//\n+// This file is part of the GNU ISO C++ Library.  This library is free\n+// software; you can redistribute it and/or modify it under the\n+// terms of the GNU General Public License as published by the\n+// Free Software Foundation; either version 2, or (at your option)\n+// any later version.\n+\n+// This library is distributed in the hope that it will be useful,\n+// but WITHOUT ANY WARRANTY; without even the implied warranty of\n+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+// GNU General Public License for more details.\n+\n+// You should have received a copy of the GNU General Public License along\n+// with this library; see the file COPYING.  If not, write to the Free\n+// Software Foundation, 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301,\n+// USA.\n+\n+// As a special exception, you may use this file as part of a free software\n+// library without restriction.  Specifically, if other files instantiate\n+// templates or use macros or inline functions from this file, or you compile\n+// this file and link it with other files to produce an executable, this\n+// file does not by itself cause the resulting executable to be covered by\n+// the GNU General Public License.  This exception does not however\n+// invalidate any other reasons why the executable file might be covered by\n+// the GNU General Public License.\n+\n+#include <mutex>\n+#include <system_error>\n+#include <testsuite_hooks.h>\n+\n+int main()\n+{\n+  bool test __attribute__((unused)) = true;\n+  typedef std::recursive_mutex mutex_type;\n+\n+  try \n+    {\n+      mutex_type m;\n+      bool b = m.try_lock();\n+      VERIFY( b );\n+      m.unlock();\n+    }\n+  catch (const std::system_error& e)\n+    {\n+      VERIFY( false );\n+    }\n+  catch (...)\n+    {\n+      VERIFY( false );\n+    }\n+\n+  return 0;\n+}"}, {"sha": "990063107044a7737e0771e89a0733d9c71af3a5", "filename": "libstdc++-v3/testsuite/30_threads/recursive_mutex/try_lock/2.cc", "status": "added", "additions": 77, "deletions": 0, "changes": 77, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/31607de1b1f4230cf870531ce4ca11b24fad287a/libstdc%2B%2B-v3%2Ftestsuite%2F30_threads%2Frecursive_mutex%2Ftry_lock%2F2.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/31607de1b1f4230cf870531ce4ca11b24fad287a/libstdc%2B%2B-v3%2Ftestsuite%2F30_threads%2Frecursive_mutex%2Ftry_lock%2F2.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F30_threads%2Frecursive_mutex%2Ftry_lock%2F2.cc?ref=31607de1b1f4230cf870531ce4ca11b24fad287a", "patch": "@@ -0,0 +1,77 @@\n+// { dg-do run { target *-*-freebsd* *-*-netbsd* *-*-linux* *-*-solaris* *-*-cygwin *-*-darwin* alpha*-*-osf* mips-sgi-irix6* } }\n+// { dg-options \" -std=gnu++0x -pthread\" { target *-*-freebsd* *-*-netbsd* *-*-linux* alpha*-*-osf* mips-sgi-irix6* } }\n+// { dg-options \" -std=gnu++0x -pthreads\" { target *-*-solaris* } }\n+// { dg-options \" -std=gnu++0x \" { target *-*-cygwin *-*-darwin* } }\n+// { dg-require-cstdint \"\" }\n+// { dg-require-gthreads \"\" }\n+\n+// Copyright (C) 2008 Free Software Foundation, Inc.\n+//\n+// This file is part of the GNU ISO C++ Library.  This library is free\n+// software; you can redistribute it and/or modify it under the\n+// terms of the GNU General Public License as published by the\n+// Free Software Foundation; either version 2, or (at your option)\n+// any later version.\n+\n+// This library is distributed in the hope that it will be useful,\n+// but WITHOUT ANY WARRANTY; without even the implied warranty of\n+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+// GNU General Public License for more details.\n+\n+// You should have received a copy of the GNU General Public License along\n+// with this library; see the file COPYING.  If not, write to the Free\n+// Software Foundation, 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301,\n+// USA.\n+\n+// As a special exception, you may use this file as part of a free software\n+// library without restriction.  Specifically, if other files instantiate\n+// templates or use macros or inline functions from this file, or you compile\n+// this file and link it with other files to produce an executable, this\n+// file does not by itself cause the resulting executable to be covered by\n+// the GNU General Public License.  This exception does not however\n+// invalidate any other reasons why the executable file might be covered by\n+// the GNU General Public License.\n+\n+#include <mutex>\n+#include <system_error>\n+#include <testsuite_hooks.h>\n+\n+int main()\n+{\n+  bool test __attribute__((unused)) = true;\n+  typedef std::recursive_mutex mutex_type;\n+\n+  try \n+    {\n+      mutex_type m;\n+      m.lock();\n+      bool b;\n+\n+      try\n+\t{\n+\t  b = m.try_lock();\n+\t  VERIFY( b );\n+\t  m.unlock();\n+\t}\n+      catch (const std::system_error& e)\n+\t{\n+\t  VERIFY( false );\n+\t}\n+      catch(...)\n+\t{\n+\t  VERIFY( false );\n+\t}\n+\n+      m.unlock();\n+    }\n+  catch (const std::system_error& e)\n+    {\n+      VERIFY( false );\n+    }\n+  catch (...)\n+    {\n+      VERIFY( false );\n+    }\n+\n+  return 0;\n+}"}, {"sha": "1a6d5ffe0857fd5f4cd83f2eb7164ce80f440733", "filename": "libstdc++-v3/testsuite/30_threads/recursive_mutex/unlock/1.cc", "status": "added", "additions": 61, "deletions": 0, "changes": 61, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/31607de1b1f4230cf870531ce4ca11b24fad287a/libstdc%2B%2B-v3%2Ftestsuite%2F30_threads%2Frecursive_mutex%2Funlock%2F1.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/31607de1b1f4230cf870531ce4ca11b24fad287a/libstdc%2B%2B-v3%2Ftestsuite%2F30_threads%2Frecursive_mutex%2Funlock%2F1.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F30_threads%2Frecursive_mutex%2Funlock%2F1.cc?ref=31607de1b1f4230cf870531ce4ca11b24fad287a", "patch": "@@ -0,0 +1,61 @@\n+// { dg-do run { target *-*-freebsd* *-*-netbsd* *-*-linux* *-*-solaris* *-*-cygwin *-*-darwin* alpha*-*-osf* mips-sgi-irix6* } }\n+// { dg-options \" -std=gnu++0x -pthread\" { target *-*-freebsd* *-*-netbsd* *-*-linux* alpha*-*-osf* mips-sgi-irix6* } }\n+// { dg-options \" -std=gnu++0x -pthreads\" { target *-*-solaris* } }\n+// { dg-options \" -std=gnu++0x \" { target *-*-cygwin *-*-darwin* } }\n+// { dg-require-cstdint \"\" }\n+// { dg-require-gthreads \"\" }\n+\n+// Copyright (C) 2008 Free Software Foundation, Inc.\n+//\n+// This file is part of the GNU ISO C++ Library.  This library is free\n+// software; you can redistribute it and/or modify it under the\n+// terms of the GNU General Public License as published by the\n+// Free Software Foundation; either version 2, or (at your option)\n+// any later version.\n+\n+// This library is distributed in the hope that it will be useful,\n+// but WITHOUT ANY WARRANTY; without even the implied warranty of\n+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+// GNU General Public License for more details.\n+\n+// You should have received a copy of the GNU General Public License along\n+// with this library; see the file COPYING.  If not, write to the Free\n+// Software Foundation, 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301,\n+// USA.\n+\n+// As a special exception, you may use this file as part of a free software\n+// library without restriction.  Specifically, if other files instantiate\n+// templates or use macros or inline functions from this file, or you compile\n+// this file and link it with other files to produce an executable, this\n+// file does not by itself cause the resulting executable to be covered by\n+// the GNU General Public License.  This exception does not however\n+// invalidate any other reasons why the executable file might be covered by\n+// the GNU General Public License.\n+\n+#include <mutex>\n+#include <system_error>\n+#include <testsuite_hooks.h>\n+\n+int main()\n+{\n+  bool test __attribute__((unused)) = true;\n+  typedef std::recursive_mutex mutex_type;\n+\n+  try \n+    {\n+      // Unlock mutex that hasn't been locked.\n+      mutex_type m;\n+      m.unlock();\n+    }\n+  catch (const std::system_error& e)\n+    {\n+      // POSIX == EPERM\n+      VERIFY( true );\n+    }\n+  catch (...)\n+    {\n+      VERIFY( false );\n+    }\n+\n+  return 0;\n+}"}]}