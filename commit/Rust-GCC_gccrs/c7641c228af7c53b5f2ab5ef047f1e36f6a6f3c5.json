{"sha": "c7641c228af7c53b5f2ab5ef047f1e36f6a6f3c5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Yzc2NDFjMjI4YWY3YzUzYjVmMmFiNWVmMDQ3ZjFlMzZmNmE2ZjNjNQ==", "commit": {"author": {"name": "Arnaud Charlet", "email": "charlet@adacore.com", "date": "2020-06-05T18:45:23Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "derodat@adacore.com", "date": "2020-07-16T09:17:59Z"}, "message": "[Ada] Spurious redundant use clause warning\n\ngcc/ada/\n\n\t* sem_ch8.adb (Note_Redundant_Use): Add missing warning tag.\n\tDo not check for redundant use clauses in predefined units to avoid\n\tmisleading warnings that may occur as part of a rtsfind load.", "tree": {"sha": "d73fe22866c97a5b6120b15931175b8c813464ec", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d73fe22866c97a5b6120b15931175b8c813464ec"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c7641c228af7c53b5f2ab5ef047f1e36f6a6f3c5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c7641c228af7c53b5f2ab5ef047f1e36f6a6f3c5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c7641c228af7c53b5f2ab5ef047f1e36f6a6f3c5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c7641c228af7c53b5f2ab5ef047f1e36f6a6f3c5/comments", "author": {"login": "ArnaudCharlet", "id": 30291825, "node_id": "MDQ6VXNlcjMwMjkxODI1", "avatar_url": "https://avatars.githubusercontent.com/u/30291825?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ArnaudCharlet", "html_url": "https://github.com/ArnaudCharlet", "followers_url": "https://api.github.com/users/ArnaudCharlet/followers", "following_url": "https://api.github.com/users/ArnaudCharlet/following{/other_user}", "gists_url": "https://api.github.com/users/ArnaudCharlet/gists{/gist_id}", "starred_url": "https://api.github.com/users/ArnaudCharlet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ArnaudCharlet/subscriptions", "organizations_url": "https://api.github.com/users/ArnaudCharlet/orgs", "repos_url": "https://api.github.com/users/ArnaudCharlet/repos", "events_url": "https://api.github.com/users/ArnaudCharlet/events{/privacy}", "received_events_url": "https://api.github.com/users/ArnaudCharlet/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pmderodat", "id": 758452, "node_id": "MDQ6VXNlcjc1ODQ1Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/758452?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pmderodat", "html_url": "https://github.com/pmderodat", "followers_url": "https://api.github.com/users/pmderodat/followers", "following_url": "https://api.github.com/users/pmderodat/following{/other_user}", "gists_url": "https://api.github.com/users/pmderodat/gists{/gist_id}", "starred_url": "https://api.github.com/users/pmderodat/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pmderodat/subscriptions", "organizations_url": "https://api.github.com/users/pmderodat/orgs", "repos_url": "https://api.github.com/users/pmderodat/repos", "events_url": "https://api.github.com/users/pmderodat/events{/privacy}", "received_events_url": "https://api.github.com/users/pmderodat/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d9206abba7e6ac0328cafb3f3556c17220101024", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d9206abba7e6ac0328cafb3f3556c17220101024", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d9206abba7e6ac0328cafb3f3556c17220101024"}], "stats": {"total": 15, "additions": 11, "deletions": 4}, "files": [{"sha": "695ff739b4d2ac47407fec547e027a4251b10fef", "filename": "gcc/ada/sem_ch8.adb", "status": "modified", "additions": 11, "deletions": 4, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c7641c228af7c53b5f2ab5ef047f1e36f6a6f3c5/gcc%2Fada%2Fsem_ch8.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c7641c228af7c53b5f2ab5ef047f1e36f6a6f3c5/gcc%2Fada%2Fsem_ch8.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch8.adb?ref=c7641c228af7c53b5f2ab5ef047f1e36f6a6f3c5", "patch": "@@ -9461,9 +9461,14 @@ package body Sem_Ch8 is\n \n          Set_Redundant_Use (Clause, True);\n \n+         --  Do not check for redundant use if clause is generated, or in an\n+         --  instance, or in a predefined unit to avoid misleading warnings\n+         --  that may occur as part of a rtsfind load.\n+\n          if not Comes_From_Source (Clause)\n            or else In_Instance\n            or else not Warn_On_Redundant_Constructs\n+           or else Is_Predefined_Unit (Current_Sem_Unit)\n          then\n             return;\n          end if;\n@@ -9596,10 +9601,12 @@ package body Sem_Ch8 is\n                          Private_Declarations (Parent (Decl))\n             then\n                declare\n-                  Par : constant Entity_Id := Defining_Entity (Parent (Decl));\n-                  Spec : constant Node_Id  :=\n-                           Specification (Unit (Cunit (Current_Sem_Unit)));\n+                  Par      : constant Entity_Id :=\n+                    Defining_Entity (Parent (Decl));\n+                  Spec     : constant Node_Id  :=\n+                    Specification (Unit (Cunit (Current_Sem_Unit)));\n                   Cur_List : constant List_Id := List_Containing (Cur_Use);\n+\n                begin\n                   if Is_Compilation_Unit (Par)\n                     and then Par /= Cunit_Entity (Current_Sem_Unit)\n@@ -9641,7 +9648,7 @@ package body Sem_Ch8 is\n \n             Error_Msg_Sloc := Sloc (Prev_Use);\n             Error_Msg_NE -- CODEFIX\n-              (\"& is already use-visible through previous use_clause #??\",\n+              (\"& is already use-visible through previous use_clause #?r?\",\n                Redundant, Pack_Name);\n          end if;\n       end Note_Redundant_Use;"}]}