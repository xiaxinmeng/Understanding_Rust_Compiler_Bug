{"sha": "cd6311ef6edcaf65e88a0427f3368a7e8224b1df", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Y2Q2MzExZWY2ZWRjYWY2NWU4OGEwNDI3ZjMzNjhhN2U4MjI0YjFkZg==", "commit": {"author": {"name": "Zack Weinberg", "email": "zack@wolery.cumb.org", "date": "2000-01-12T17:35:41Z"}, "committer": {"name": "Zack Weinberg", "email": "zack@gcc.gnu.org", "date": "2000-01-12T17:35:41Z"}, "message": "c-typeck.c (build_c_cast): Issue -Wcast-qual warnings if the qualifiers don't match at any level of...\n\n\t* c-typeck.c (build_c_cast): Issue -Wcast-qual warnings if the\n\tqualifiers don't match at any level of pointerness.\n\nFrom-SVN: r31356", "tree": {"sha": "9a787e4922adb3937e2386122c671a13db6b2b07", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9a787e4922adb3937e2386122c671a13db6b2b07"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/cd6311ef6edcaf65e88a0427f3368a7e8224b1df", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cd6311ef6edcaf65e88a0427f3368a7e8224b1df", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cd6311ef6edcaf65e88a0427f3368a7e8224b1df", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cd6311ef6edcaf65e88a0427f3368a7e8224b1df/comments", "author": null, "committer": null, "parents": [{"sha": "f668c81cda01a89410ae4b02364065be5b34cfc2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f668c81cda01a89410ae4b02364065be5b34cfc2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f668c81cda01a89410ae4b02364065be5b34cfc2"}], "stats": {"total": 25, "additions": 18, "deletions": 7}, "files": [{"sha": "4ce5ffebe6a5004f81de47dc299faf1c637363a1", "filename": "gcc/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cd6311ef6edcaf65e88a0427f3368a7e8224b1df/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cd6311ef6edcaf65e88a0427f3368a7e8224b1df/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=cd6311ef6edcaf65e88a0427f3368a7e8224b1df", "patch": "@@ -2,6 +2,9 @@\n \n \t* cccp.c: Accept and ignore -lang-fortran.\n \n+\t* c-typeck.c (build_c_cast): Issue -Wcast-qual warnings if the\n+\tqualifiers don't match at any level of pointerness.\n+\n 2000-01-12  Robert Lipe  <robertl@sco.com>\n \n \t* i386/sysv5.h (CPP_SPEC, LIBSPEC): Add -pthreadT."}, {"sha": "e0e4df4949ea6c853a4f1316430a3d7fa17e79d0", "filename": "gcc/c-typeck.c", "status": "modified", "additions": 15, "deletions": 7, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cd6311ef6edcaf65e88a0427f3368a7e8224b1df/gcc%2Fc-typeck.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cd6311ef6edcaf65e88a0427f3368a7e8224b1df/gcc%2Fc-typeck.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-typeck.c?ref=cd6311ef6edcaf65e88a0427f3368a7e8224b1df", "patch": "@@ -3701,16 +3701,24 @@ build_c_cast (type, expr)\n \t  && TREE_CODE (type) == POINTER_TYPE\n \t  && TREE_CODE (otype) == POINTER_TYPE)\n \t{\n-\t  /* Go to the innermost object being pointed to.  */\n \t  tree in_type = type;\n \t  tree in_otype = otype;\n+\t  int warn = 0;\n \n-\t  while (TREE_CODE (in_type) == POINTER_TYPE)\n-\t    in_type = TREE_TYPE (in_type);\n-\t  while (TREE_CODE (in_otype) == POINTER_TYPE)\n-\t    in_otype = TREE_TYPE (in_otype);\n-\t  \n-\t  if (TYPE_QUALS (in_otype) & ~TYPE_QUALS (in_type))\n+\t  /* Check that the qualifiers on IN_TYPE are a superset of\n+\t     the qualifiers of IN_OTYPE.  The outermost level of\n+\t     POINTER_TYPE nodes is uninteresting and we stop as soon\n+\t     as we hit a non-POINTER_TYPE node on either type.  */\n+\t  do\n+\t    {\n+\t      in_otype = TREE_TYPE (in_otype);\n+\t      in_type = TREE_TYPE (in_type);\n+\t      warn |= (TYPE_QUALS (in_otype) & ~TYPE_QUALS (in_type));\n+\t    }\n+\t  while (TREE_CODE (in_type) == POINTER_TYPE\n+\t\t && TREE_CODE (in_otype) == POINTER_TYPE);\n+\n+\t  if (warn)\n \t    /* There are qualifiers present in IN_OTYPE that are not\n \t       present in IN_TYPE.  */\n \t    pedwarn (\"cast discards qualifiers from pointer target type\");"}]}