{"sha": "5d7ef82a5dcfba9ab3d4080fd229449a9b7f2207", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NWQ3ZWY4MmE1ZGNmYmE5YWIzZDQwODBmZDIyOTQ0OWE5YjdmMjIwNw==", "commit": {"author": {"name": "Bernd Schmidt", "email": "bernds@redhat.com", "date": "2001-05-17T12:38:47Z"}, "committer": {"name": "Bernd Schmidt", "email": "bernds@gcc.gnu.org", "date": "2001-05-17T12:38:47Z"}, "message": "Correctly count substitutions if eliminations are going on.\n\nFrom-SVN: r42198", "tree": {"sha": "0d5267e2e8bab747f69faee8aa480e43d877a3cc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0d5267e2e8bab747f69faee8aa480e43d877a3cc"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5d7ef82a5dcfba9ab3d4080fd229449a9b7f2207", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5d7ef82a5dcfba9ab3d4080fd229449a9b7f2207", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5d7ef82a5dcfba9ab3d4080fd229449a9b7f2207", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5d7ef82a5dcfba9ab3d4080fd229449a9b7f2207/comments", "author": null, "committer": null, "parents": [{"sha": "2e2ed7d22dec064200e1548f21dc99625e2be999", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2e2ed7d22dec064200e1548f21dc99625e2be999", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2e2ed7d22dec064200e1548f21dc99625e2be999"}], "stats": {"total": 14, "additions": 10, "deletions": 4}, "files": [{"sha": "15b445d205f6c4b05984ea7da52cff059a2fa89d", "filename": "gcc/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5d7ef82a5dcfba9ab3d4080fd229449a9b7f2207/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5d7ef82a5dcfba9ab3d4080fd229449a9b7f2207/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=5d7ef82a5dcfba9ab3d4080fd229449a9b7f2207", "patch": "@@ -3,6 +3,9 @@\n \t* stmt.c (expand_asm_operands): For inout operands, make sure\n \tthe substitution of '=' for '+' makes it into the rtl.\n \n+\t* reload1.c (delete_output_reload): Call eliminate_regs on substed.\n+\t(reload_as_needed): Call update_eliminable_offsets a bit later.\n+\n 2001-05-17  Gerald Pfeifer  <pfeifer@dbai.tuwien.ac.at>\n \n \t* gcc.texi (gccbug): Refer to the web pages for detailed information"}, {"sha": "ccf7619df845b73ef29ad41fe0ae3f56e0b470f1", "filename": "gcc/reload1.c", "status": "modified", "additions": 7, "deletions": 4, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5d7ef82a5dcfba9ab3d4080fd229449a9b7f2207/gcc%2Freload1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5d7ef82a5dcfba9ab3d4080fd229449a9b7f2207/gcc%2Freload1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Freload1.c?ref=5d7ef82a5dcfba9ab3d4080fd229449a9b7f2207", "patch": "@@ -3874,9 +3874,6 @@ reload_as_needed (live_known)\n \t\t\t    spill_reg_order);\n \t    }\n \n-\t  if (num_eliminable && chain->need_elim)\n-\t    update_eliminable_offsets ();\n-\n \t  if (n_reloads > 0)\n \t    {\n \t      rtx next = NEXT_INSN (insn);\n@@ -3923,6 +3920,10 @@ reload_as_needed (live_known)\n \t\t      NOTE_LINE_NUMBER (p) = NOTE_INSN_DELETED;\n \t\t    }\n \t    }\n+\n+\t  if (num_eliminable && chain->need_elim)\n+\t    update_eliminable_offsets ();\n+\n \t  /* Any previously reloaded spilled pseudo reg, stored in this insn,\n \t     is no longer validly lying around to save a future reload.\n \t     Note that this does not detect pseudos that were reloaded\n@@ -7599,7 +7600,9 @@ delete_output_reload (insn, j, last_reload_reg)\n     }\n   n_occurrences = count_occurrences (PATTERN (insn), reg, 0);\n   if (substed)\n-    n_occurrences += count_occurrences (PATTERN (insn), substed, 0);\n+    n_occurrences += count_occurrences (PATTERN (insn),\n+\t\t\t\t\teliminate_regs (substed, 0,\n+\t\t\t\t\t\t\tNULL_RTX), 0);\n   if (n_occurrences > n_inherited)\n     return;\n "}]}