{"sha": "d19df8b22998766fec1d3c3af055639ba2d172e5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDE5ZGY4YjIyOTk4NzY2ZmVjMWQzYzNhZjA1NTYzOWJhMmQxNzJlNQ==", "commit": {"author": {"name": "Ilya Leoshkevich", "email": "iii@linux.ibm.com", "date": "2019-11-14T16:40:33Z"}, "committer": {"name": "Ilya Leoshkevich", "email": "iii@gcc.gnu.org", "date": "2019-11-14T16:40:33Z"}, "message": "Make flag_thread_jumps a gate of pass_jump_after_combine\n\nThis is a follow-up to\nhttps://gcc.gnu.org/ml/gcc-patches/2019-11/msg00919.html (r278095).\nDominance info is deleted even if we don't perform jump threading.\nSince the whole point of this pass is to perform jump threading (other\ncleanups are not valuable at this point), skip it completely when\nflag_thread_jumps is not set.\n\ngcc/ChangeLog:\n\n2019-11-14  Ilya Leoshkevich  <iii@linux.ibm.com>\n\n\tPR rtl-optimization/92430\n\t* cfgcleanup.c (pass_jump_after_combine::gate): New function.\n\t(pass_jump_after_combine::execute): Perform jump threading\n\tunconditionally.\n\nFrom-SVN: r278254", "tree": {"sha": "fbaddaa1fab9ae6d15d69396418c2cc093296c45", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/fbaddaa1fab9ae6d15d69396418c2cc093296c45"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d19df8b22998766fec1d3c3af055639ba2d172e5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d19df8b22998766fec1d3c3af055639ba2d172e5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d19df8b22998766fec1d3c3af055639ba2d172e5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d19df8b22998766fec1d3c3af055639ba2d172e5/comments", "author": {"login": "iii-i", "id": 45998171, "node_id": "MDQ6VXNlcjQ1OTk4MTcx", "avatar_url": "https://avatars.githubusercontent.com/u/45998171?v=4", "gravatar_id": "", "url": "https://api.github.com/users/iii-i", "html_url": "https://github.com/iii-i", "followers_url": "https://api.github.com/users/iii-i/followers", "following_url": "https://api.github.com/users/iii-i/following{/other_user}", "gists_url": "https://api.github.com/users/iii-i/gists{/gist_id}", "starred_url": "https://api.github.com/users/iii-i/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/iii-i/subscriptions", "organizations_url": "https://api.github.com/users/iii-i/orgs", "repos_url": "https://api.github.com/users/iii-i/repos", "events_url": "https://api.github.com/users/iii-i/events{/privacy}", "received_events_url": "https://api.github.com/users/iii-i/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "27204060db51ed0637e394dff387c66c6b944726", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/27204060db51ed0637e394dff387c66c6b944726", "html_url": "https://github.com/Rust-GCC/gccrs/commit/27204060db51ed0637e394dff387c66c6b944726"}], "stats": {"total": 10, "additions": 9, "deletions": 1}, "files": [{"sha": "051b10ed953c459715f500dc0e93572a88853468", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d19df8b22998766fec1d3c3af055639ba2d172e5/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d19df8b22998766fec1d3c3af055639ba2d172e5/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=d19df8b22998766fec1d3c3af055639ba2d172e5", "patch": "@@ -1,3 +1,10 @@\n+2019-11-14  Ilya Leoshkevich  <iii@linux.ibm.com>\n+\n+\tPR rtl-optimization/92430\n+\t* cfgcleanup.c (pass_jump_after_combine::gate): New function.\n+\t(pass_jump_after_combine::execute): Perform jump threading\n+\tunconditionally.\n+\n 2019-11-14  Jerome Lambourg  <lambourg@adacore.com>\n \t    Doug Rupp <rupp@adacore.com>\n \t    Olivier Hainque  <hainque@adacore.com>"}, {"sha": "f1d421b1cfa91c4f54fd8b745f14498c25bbb12e", "filename": "gcc/cfgcleanup.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d19df8b22998766fec1d3c3af055639ba2d172e5/gcc%2Fcfgcleanup.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d19df8b22998766fec1d3c3af055639ba2d172e5/gcc%2Fcfgcleanup.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcfgcleanup.c?ref=d19df8b22998766fec1d3c3af055639ba2d172e5", "patch": "@@ -3304,6 +3304,7 @@ class pass_jump_after_combine : public rtl_opt_pass\n   {}\n \n   /* opt_pass methods: */\n+  virtual bool gate (function *) { return flag_thread_jumps; }\n   virtual unsigned int execute (function *);\n \n }; // class pass_jump_after_combine\n@@ -3313,7 +3314,7 @@ pass_jump_after_combine::execute (function *)\n {\n   /* Jump threading does not keep dominators up-to-date.  */\n   free_dominance_info (CDI_DOMINATORS);\n-  cleanup_cfg (flag_thread_jumps ? CLEANUP_THREADING : 0);\n+  cleanup_cfg (CLEANUP_THREADING);\n   return 0;\n }\n "}]}