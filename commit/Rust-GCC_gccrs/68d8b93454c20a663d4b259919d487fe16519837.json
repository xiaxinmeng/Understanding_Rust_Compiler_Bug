{"sha": "68d8b93454c20a663d4b259919d487fe16519837", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjhkOGI5MzQ1NGMyMGE2NjNkNGIyNTk5MTlkNDg3ZmUxNjUxOTgzNw==", "commit": {"author": {"name": "Tom Tromey", "email": "tromey@redhat.com", "date": "2005-06-01T15:52:45Z"}, "committer": {"name": "Tom Tromey", "email": "tromey@gcc.gnu.org", "date": "2005-06-01T15:52:45Z"}, "message": "re PR libgcj/21753 (String.substring sharing heuristic should be improved)\n\n\tPR libgcj/21753:\n\t* java/lang/natString.cc (substring): Changed sharing heuristic.\n\nFrom-SVN: r100454", "tree": {"sha": "d45776264c7ddfe40e12a61a6bd2555f42877538", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d45776264c7ddfe40e12a61a6bd2555f42877538"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/68d8b93454c20a663d4b259919d487fe16519837", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/68d8b93454c20a663d4b259919d487fe16519837", "html_url": "https://github.com/Rust-GCC/gccrs/commit/68d8b93454c20a663d4b259919d487fe16519837", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/68d8b93454c20a663d4b259919d487fe16519837/comments", "author": null, "committer": null, "parents": [{"sha": "75fe7b2f406d638fa6de89c44e0a862ab04a0b5e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/75fe7b2f406d638fa6de89c44e0a862ab04a0b5e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/75fe7b2f406d638fa6de89c44e0a862ab04a0b5e"}], "stats": {"total": 10, "additions": 9, "deletions": 1}, "files": [{"sha": "cddaecbd1d984042d365497f954c5d8b30c84a46", "filename": "libjava/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/68d8b93454c20a663d4b259919d487fe16519837/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/68d8b93454c20a663d4b259919d487fe16519837/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=68d8b93454c20a663d4b259919d487fe16519837", "patch": "@@ -1,3 +1,8 @@\n+2005-06-01  Tom Tromey  <tromey@redhat.com>\n+\n+\tPR libgcj/21753:\n+\t* java/lang/natString.cc (substring): Changed sharing heuristic.\n+\n 2005-05-30  Bryce McKinlay  <mckinlay@redhat.com>\n \n \tPR libgcj/21821"}, {"sha": "c8f3129a2129a77d2dbc44a7b4948af905ddbed1", "filename": "libjava/java/lang/natString.cc", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/68d8b93454c20a663d4b259919d487fe16519837/libjava%2Fjava%2Flang%2FnatString.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/68d8b93454c20a663d4b259919d487fe16519837/libjava%2Fjava%2Flang%2FnatString.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjava%2Flang%2FnatString.cc?ref=68d8b93454c20a663d4b259919d487fe16519837", "patch": "@@ -833,7 +833,10 @@ java::lang::String::substring (jint beginIndex, jint endIndex)\n   if (beginIndex == 0 && endIndex == count)\n     return this;\n   jint newCount = endIndex - beginIndex;\n-  if (newCount <= 8)  // Optimization, mainly for GC.\n+  // For very small strings, just allocate a new one.  For other\n+  // substrings, allocate a new one unless the substring is over half\n+  // of the original string.\n+  if (newCount <= 8 || newCount < (count >> 1))\n     return JvNewString(JvGetStringChars(this) + beginIndex, newCount);\n   jstring s = new String();\n   s->data = data;"}]}