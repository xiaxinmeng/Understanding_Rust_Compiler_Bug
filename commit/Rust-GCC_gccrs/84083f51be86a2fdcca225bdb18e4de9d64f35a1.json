{"sha": "84083f51be86a2fdcca225bdb18e4de9d64f35a1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODQwODNmNTFiZTg2YTJmZGNjYTIyNWJkYjE4ZTRkZTlkNjRmMzVhMQ==", "commit": {"author": {"name": "Gary Benson", "email": "gbenson@redhat.com", "date": "2003-11-11T00:51:44Z"}, "committer": {"name": "Tom Tromey", "email": "tromey@gcc.gnu.org", "date": "2003-11-11T00:51:44Z"}, "message": "Timestamp.java (valueOf): Correctly handle nanoseconds.\n\n2003-11-10  Gary Benson  <gbenson@redhat.com>\n\n\t* java/sql/Timestamp.java (valueOf): Correctly handle\n\tnanoseconds.\n\nFrom-SVN: r73437", "tree": {"sha": "b8c48c81ef87d72df44557d96975d8ddb7acbf0f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b8c48c81ef87d72df44557d96975d8ddb7acbf0f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/84083f51be86a2fdcca225bdb18e4de9d64f35a1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/84083f51be86a2fdcca225bdb18e4de9d64f35a1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/84083f51be86a2fdcca225bdb18e4de9d64f35a1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/84083f51be86a2fdcca225bdb18e4de9d64f35a1/comments", "author": null, "committer": null, "parents": [{"sha": "b1e0ae3eaac2cf19674b37d1c18c022987f23dac", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b1e0ae3eaac2cf19674b37d1c18c022987f23dac", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b1e0ae3eaac2cf19674b37d1c18c022987f23dac"}], "stats": {"total": 40, "additions": 31, "deletions": 9}, "files": [{"sha": "0d62f8f7e26f60ab081701ff8dd87a415123c40b", "filename": "libjava/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/84083f51be86a2fdcca225bdb18e4de9d64f35a1/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/84083f51be86a2fdcca225bdb18e4de9d64f35a1/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=84083f51be86a2fdcca225bdb18e4de9d64f35a1", "patch": "@@ -1,3 +1,8 @@\n+2003-11-10  Gary Benson  <gbenson@redhat.com>\n+\n+\t* java/sql/Timestamp.java (valueOf): Correctly handle\n+\tnanoseconds.\n+\n 2003-11-09  Tom Tromey  <tromey@redhat.com>\n \n \t* java/net/Inet4Address.java (serialVersionUID): Updated."}, {"sha": "5ec75da61c17bbed8a789c2a7e131467ec258090", "filename": "libjava/java/sql/Timestamp.java", "status": "modified", "additions": 26, "deletions": 9, "changes": 35, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/84083f51be86a2fdcca225bdb18e4de9d64f35a1/libjava%2Fjava%2Fsql%2FTimestamp.java", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/84083f51be86a2fdcca225bdb18e4de9d64f35a1/libjava%2Fjava%2Fsql%2FTimestamp.java", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjava%2Fsql%2FTimestamp.java?ref=84083f51be86a2fdcca225bdb18e4de9d64f35a1", "patch": "@@ -58,11 +58,7 @@ public class Timestamp extends java.util.Date\n   /**\n    * Used for parsing and formatting this date.\n    */\n-  // Millisecond will have to be close enough for now.\n-  private static SimpleDateFormat parse_sdf = \n-    new SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss.SSSS\");\n-\n-  private static SimpleDateFormat format_sdf =\n+  private static SimpleDateFormat sdf =\n     new SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss\");\n \n   /**\n@@ -79,14 +75,35 @@ public class Timestamp extends java.util.Date\n    */\n   public static Timestamp valueOf(String str)\n   {\n+    int nanos = 0;\n+    int dot = str.indexOf('.');\n+    if (dot != -1)\n+      {\n+\tif (str.lastIndexOf('.') != dot)\n+\t  throw new IllegalArgumentException(str);\n+\n+\tint len = str.length() - dot - 1;\n+\tif (len < 1 || len > 9)\n+\t  throw new IllegalArgumentException(str);\n+\n+\tnanos = Integer.parseInt(str.substring(dot + 1));\n+\tfor (int i = len; i < 9; i++)\n+\t  nanos *= 10;\n+\t\n+\tstr = str.substring(0, dot);\n+\n+      }\n+\n     try\n       {\n-\tjava.util.Date d = (java.util.Date)parse_sdf.parseObject(str);\n+\tjava.util.Date d = (java.util.Date)sdf.parseObject(str);\n \n \tif (d == null)\n \t  throw new IllegalArgumentException(str);\n-\telse\n-\t  return new Timestamp(d.getTime());\n+\n+\tTimestamp ts = new Timestamp(d.getTime() + nanos / 1000000);\n+\tts.nanos = nanos;\n+\treturn ts;\n       }\n     catch (ParseException e)\n       {\n@@ -133,7 +150,7 @@ public Timestamp(long date)\n    */\n   public String toString()\n   {\n-    return format_sdf.format(this) + \".\" + getNanos();\n+    return sdf.format(this) + \".\" + getNanos();\n   }\n \n   /**"}]}