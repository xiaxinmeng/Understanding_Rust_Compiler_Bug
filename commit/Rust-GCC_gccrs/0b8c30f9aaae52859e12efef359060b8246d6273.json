{"sha": "0b8c30f9aaae52859e12efef359060b8246d6273", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MGI4YzMwZjlhYWFlNTI4NTllMTJlZmVmMzU5MDYwYjgyNDZkNjI3Mw==", "commit": {"author": {"name": "Tobias Burnus", "email": "burnus@net-b.de", "date": "2012-10-09T11:46:25Z"}, "committer": {"name": "Tobias Burnus", "email": "burnus@gcc.gnu.org", "date": "2012-10-09T11:46:25Z"}, "message": "lto-cgraph.c (input_node_opt_summary): Remove unused code.\n\ngcc/\n2012-10-08  Tobias Burnus  <burnus@net-b.de>\n\n\t* lto-cgraph.c (input_node_opt_summary): Remove unused code.\n\t* lto-opts.c (append_to_collect_gcc_options): Fix condition.\n\t* lto-symtab.c (lto_cgraph_replace_node): Don't xstrdup string\n\twhich is passed to fprintf.\n\ngcc/lto/\n2012-10-08  Tobias Burnus  <burnus@net-b.de>\n\n\t* lto-lang.c (lto_register_builtin_type): Avoid useless\n\tdecl creation.\n\t* lto-object.c (lto_obj_file_open, lto_obj_file_open): Free memory.\n\nFrom-SVN: r192250", "tree": {"sha": "bd59306e865ec5d8977d9b28fa471840fefb7dca", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/bd59306e865ec5d8977d9b28fa471840fefb7dca"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0b8c30f9aaae52859e12efef359060b8246d6273", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0b8c30f9aaae52859e12efef359060b8246d6273", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0b8c30f9aaae52859e12efef359060b8246d6273", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0b8c30f9aaae52859e12efef359060b8246d6273/comments", "author": {"login": "tob2", "id": 264461, "node_id": "MDQ6VXNlcjI2NDQ2MQ==", "avatar_url": "https://avatars.githubusercontent.com/u/264461?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tob2", "html_url": "https://github.com/tob2", "followers_url": "https://api.github.com/users/tob2/followers", "following_url": "https://api.github.com/users/tob2/following{/other_user}", "gists_url": "https://api.github.com/users/tob2/gists{/gist_id}", "starred_url": "https://api.github.com/users/tob2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tob2/subscriptions", "organizations_url": "https://api.github.com/users/tob2/orgs", "repos_url": "https://api.github.com/users/tob2/repos", "events_url": "https://api.github.com/users/tob2/events{/privacy}", "received_events_url": "https://api.github.com/users/tob2/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "5d9de0d0a5b5e807c92f01712e8dad06e0dfae75", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5d9de0d0a5b5e807c92f01712e8dad06e0dfae75", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5d9de0d0a5b5e807c92f01712e8dad06e0dfae75"}], "stats": {"total": 42, "additions": 29, "deletions": 13}, "files": [{"sha": "7ad8a41c19735a9400d7d7e88d26983ca20b15c7", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0b8c30f9aaae52859e12efef359060b8246d6273/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0b8c30f9aaae52859e12efef359060b8246d6273/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=0b8c30f9aaae52859e12efef359060b8246d6273", "patch": "@@ -1,3 +1,10 @@\n+2012-10-09  Tobias Burnus  <burnus@net-b.de>\n+\n+\t* lto-cgraph.c (input_node_opt_summary): Remove unused code.\n+\t* lto-opts.c (append_to_collect_gcc_options): Fix condition.\n+\t* lto-symtab.c (lto_cgraph_replace_node): Don't xstrdup string\n+\twhich is passed to fprintf.\n+\n 2012-10-09  Paolo Carlini  <paolo.carlini@oracle.com>\n \n \tPR c++/54194"}, {"sha": "b23f192e3bd6042e346c3c74a58cf05359b63790", "filename": "gcc/lto-cgraph.c", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0b8c30f9aaae52859e12efef359060b8246d6273/gcc%2Flto-cgraph.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0b8c30f9aaae52859e12efef359060b8246d6273/gcc%2Flto-cgraph.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flto-cgraph.c?ref=0b8c30f9aaae52859e12efef359060b8246d6273", "patch": "@@ -1517,14 +1517,9 @@ input_node_opt_summary (struct cgraph_node *node,\n   count = streamer_read_uhwi (ib_main);\n   for (i = 0; i < count; i++)\n     {\n-      int parm_num;\n-      tree parm;\n       struct ipa_replace_map *map = ggc_alloc_ipa_replace_map ();\n \n       VEC_safe_push (ipa_replace_map_p, gc, node->clone.tree_map, map);\n-      for (parm_num = 0, parm = DECL_ARGUMENTS (node->symbol.decl); parm_num;\n-\t   parm = DECL_CHAIN (parm))\n-\tparm_num --;\n       map->parm_num = streamer_read_uhwi (ib_main);\n       map->old_tree = NULL;\n       map->new_tree = stream_read_tree (ib_main, data_in);"}, {"sha": "a235f41da8de399511b169525e9c9333a01e017e", "filename": "gcc/lto-opts.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0b8c30f9aaae52859e12efef359060b8246d6273/gcc%2Flto-opts.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0b8c30f9aaae52859e12efef359060b8246d6273/gcc%2Flto-opts.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flto-opts.c?ref=0b8c30f9aaae52859e12efef359060b8246d6273", "patch": "@@ -44,7 +44,7 @@ append_to_collect_gcc_options (struct obstack *ob,\n \t\t\t       bool *first_p, const char *opt)\n {\n   const char *p, *q = opt;\n-  if (!first_p)\n+  if (!*first_p)\n     obstack_grow (ob, \" \", 1);\n   obstack_grow (ob, \"'\", 1);\n   while ((p = strchr (q, '\\'')))"}, {"sha": "659a68b68a52dc7dc5a0d04400dec435a0092b93", "filename": "gcc/lto-symtab.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0b8c30f9aaae52859e12efef359060b8246d6273/gcc%2Flto-symtab.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0b8c30f9aaae52859e12efef359060b8246d6273/gcc%2Flto-symtab.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flto-symtab.c?ref=0b8c30f9aaae52859e12efef359060b8246d6273", "patch": "@@ -46,8 +46,8 @@ lto_cgraph_replace_node (struct cgraph_node *node,\n     {\n       fprintf (cgraph_dump_file, \"Replacing cgraph node %s/%i by %s/%i\"\n  \t       \" for symbol %s\\n\",\n-\t       xstrdup (cgraph_node_name (node)), node->uid,\n-\t       xstrdup (cgraph_node_name (prevailing_node)),\n+\t       cgraph_node_name (node), node->uid,\n+\t       cgraph_node_name (prevailing_node),\n \t       prevailing_node->uid,\n \t       IDENTIFIER_POINTER ((*targetm.asm_out.mangle_assembler_name)\n \t\t (IDENTIFIER_POINTER (DECL_ASSEMBLER_NAME (node->symbol.decl)))));"}, {"sha": "265922f5d133e2f3287d8b866b85997d7cb5c806", "filename": "gcc/lto/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0b8c30f9aaae52859e12efef359060b8246d6273/gcc%2Flto%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0b8c30f9aaae52859e12efef359060b8246d6273/gcc%2Flto%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flto%2FChangeLog?ref=0b8c30f9aaae52859e12efef359060b8246d6273", "patch": "@@ -1,3 +1,9 @@\n+2012-10-09  Tobias Burnus  <burnus@net-b.de>\n+\n+\t* lto-lang.c (lto_register_builtin_type): Avoid useless\n+\tdecl creation.\n+\t* lto-object.c (lto_obj_file_open, lto_obj_file_open): Free memory.\n+\n 2012-10-08  Tobias Burnus  <burnus@net-b.de>\n \n \t* lto.c (lto_wpa_write_files, read_cgraph_and_symbols):"}, {"sha": "edfab74de0ad5b16acc71a3fe2ed71ce6dff9909", "filename": "gcc/lto/lto-lang.c", "status": "modified", "additions": 6, "deletions": 3, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0b8c30f9aaae52859e12efef359060b8246d6273/gcc%2Flto%2Flto-lang.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0b8c30f9aaae52859e12efef359060b8246d6273/gcc%2Flto%2Flto-lang.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flto%2Flto-lang.c?ref=0b8c30f9aaae52859e12efef359060b8246d6273", "patch": "@@ -1079,10 +1079,13 @@ lto_register_builtin_type (tree type, const char *name)\n {\n   tree decl;\n \n-  decl = build_decl (UNKNOWN_LOCATION, TYPE_DECL, get_identifier (name), type);\n-  DECL_ARTIFICIAL (decl) = 1;\n   if (!TYPE_NAME (type))\n-    TYPE_NAME (type) = decl;\n+    {\n+      decl = build_decl (UNKNOWN_LOCATION, TYPE_DECL,\n+\t\t\t get_identifier (name), type);\n+      DECL_ARTIFICIAL (decl) = 1;\n+      TYPE_NAME (type) = decl;\n+    }\n \n   registered_builtin_types = tree_cons (0, type, registered_builtin_types);\n }"}, {"sha": "ce24400cb108f21f619965afbba968e5bc777d51", "filename": "gcc/lto/lto-object.c", "status": "modified", "additions": 7, "deletions": 2, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0b8c30f9aaae52859e12efef359060b8246d6273/gcc%2Flto%2Flto-object.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0b8c30f9aaae52859e12efef359060b8246d6273/gcc%2Flto%2Flto-object.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flto%2Flto-object.c?ref=0b8c30f9aaae52859e12efef359060b8246d6273", "patch": "@@ -133,7 +133,10 @@ lto_obj_file_open (const char *filename, bool writable)\n \t  errmsg = simple_object_attributes_merge (saved_attributes, attrs,\n \t\t\t\t\t\t   &err);\n \t  if (errmsg != NULL)\n-\t    goto fail_errmsg;\n+\t    {\n+\t      free (attrs);\n+\t      goto fail_errmsg;\n+\t    }\n \t}\n     }\n   else\n@@ -155,11 +158,13 @@ lto_obj_file_open (const char *filename, bool writable)\n     error (\"%s: %s: %s\", fname, errmsg, xstrerror (err));\n \t\t\t\t\t \n  fail:\n-  if (lo != NULL)\n+  if (lo->fd != -1)\n     lto_obj_file_close ((lto_file *) lo);\n+  free (lo);\n   return NULL;\n }\n \n+\n /* Close FILE.  If FILE was opened for writing, it is written out\n    now.  */\n "}]}