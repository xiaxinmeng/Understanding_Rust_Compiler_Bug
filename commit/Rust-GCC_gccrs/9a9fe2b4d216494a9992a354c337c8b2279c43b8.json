{"sha": "9a9fe2b4d216494a9992a354c337c8b2279c43b8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWE5ZmUyYjRkMjE2NDk0YTk5OTJhMzU0YzMzN2M4YjIyNzljNDNiOA==", "commit": {"author": {"name": "Bernd Edlinger", "email": "bernd.edlinger@hotmail.de", "date": "2015-09-30T18:51:31Z"}, "committer": {"name": "Bernd Edlinger", "email": "edlinger@gcc.gnu.org", "date": "2015-09-30T18:51:31Z"}, "message": "re PR rtl-optimization/67037 (Wrong code at -O1 and above on ARM)\n\n2015-09-30  Bernd Edlinger  <bernd.edlinger@hotmail.de>\n\n        PR rtl-optimization/67037\n        * lra-constraints.c (process_addr_reg): Use copy_rtx when necessary.\n\ntestsuite:\n2015-09-30  Bernd Edlinger  <bernd.edlinger@hotmail.de>\n\n        PR rtl-optimization/67037\n        * gcc.c-torture/execute/pr67037.c: New test.\n\nFrom-SVN: r228303", "tree": {"sha": "ea16b69240bd8a87433b37ab3b9bacde0c5c69b1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ea16b69240bd8a87433b37ab3b9bacde0c5c69b1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9a9fe2b4d216494a9992a354c337c8b2279c43b8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9a9fe2b4d216494a9992a354c337c8b2279c43b8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9a9fe2b4d216494a9992a354c337c8b2279c43b8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9a9fe2b4d216494a9992a354c337c8b2279c43b8/comments", "author": {"login": "bernd-edlinger", "id": 17638929, "node_id": "MDQ6VXNlcjE3NjM4OTI5", "avatar_url": "https://avatars.githubusercontent.com/u/17638929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bernd-edlinger", "html_url": "https://github.com/bernd-edlinger", "followers_url": "https://api.github.com/users/bernd-edlinger/followers", "following_url": "https://api.github.com/users/bernd-edlinger/following{/other_user}", "gists_url": "https://api.github.com/users/bernd-edlinger/gists{/gist_id}", "starred_url": "https://api.github.com/users/bernd-edlinger/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bernd-edlinger/subscriptions", "organizations_url": "https://api.github.com/users/bernd-edlinger/orgs", "repos_url": "https://api.github.com/users/bernd-edlinger/repos", "events_url": "https://api.github.com/users/bernd-edlinger/events{/privacy}", "received_events_url": "https://api.github.com/users/bernd-edlinger/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "dc0ccbb3a3e60f0423ac69d82f6cb78ff9b10800", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dc0ccbb3a3e60f0423ac69d82f6cb78ff9b10800", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dc0ccbb3a3e60f0423ac69d82f6cb78ff9b10800"}], "stats": {"total": 61, "additions": 60, "deletions": 1}, "files": [{"sha": "b60a3e6bd1c40ececb02e62b8c280ff76738f8be", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9a9fe2b4d216494a9992a354c337c8b2279c43b8/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9a9fe2b4d216494a9992a354c337c8b2279c43b8/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=9a9fe2b4d216494a9992a354c337c8b2279c43b8", "patch": "@@ -1,3 +1,8 @@\n+2015-09-30  Bernd Edlinger  <bernd.edlinger@hotmail.de>\n+\n+\tPR rtl-optimization/67037\n+\t* lra-constraints.c (process_addr_reg): Use copy_rtx when necessary.\n+\n 2015-09-30  Bernd Schmidt  <bernds@redhat.com>\n \n \t* gimple-ssa.h (gimple_df): Add free_ssanames_queue field."}, {"sha": "7764f29f477b78e6fafdc1e8ea8a56471dd1b7ad", "filename": "gcc/lra-constraints.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9a9fe2b4d216494a9992a354c337c8b2279c43b8/gcc%2Flra-constraints.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9a9fe2b4d216494a9992a354c337c8b2279c43b8/gcc%2Flra-constraints.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flra-constraints.c?ref=9a9fe2b4d216494a9992a354c337c8b2279c43b8", "patch": "@@ -1339,7 +1339,7 @@ process_addr_reg (rtx *loc, bool check_only_p, rtx_insn **before, rtx_insn **aft\n   if (after != NULL)\n     {\n       start_sequence ();\n-      lra_emit_move (reg, new_reg);\n+      lra_emit_move (before_p ? copy_rtx (reg) : reg, new_reg);\n       emit_insn (*after);\n       *after = get_insns ();\n       end_sequence ();"}, {"sha": "ece4ad1b089fe85694d357cbc76f57e0ece17e77", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9a9fe2b4d216494a9992a354c337c8b2279c43b8/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9a9fe2b4d216494a9992a354c337c8b2279c43b8/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=9a9fe2b4d216494a9992a354c337c8b2279c43b8", "patch": "@@ -1,3 +1,8 @@\n+2015-09-30  Bernd Edlinger  <bernd.edlinger@hotmail.de>\n+\n+\tPR rtl-optimization/67037\n+\t* gcc.c-torture/execute/pr67037.c: New test.\n+\n 2015-09-30  Ulrich Weigand  <Ulrich.Weigand@de.ibm.com>\n \n \t* lib/target-supports.exp (check_effective_target_sync_int_128):"}, {"sha": "3119d327b02aa275114d8b33b342ccd73893e87e", "filename": "gcc/testsuite/gcc.c-torture/execute/pr67037.c", "status": "added", "additions": 49, "deletions": 0, "changes": 49, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9a9fe2b4d216494a9992a354c337c8b2279c43b8/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fpr67037.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9a9fe2b4d216494a9992a354c337c8b2279c43b8/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fpr67037.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fpr67037.c?ref=9a9fe2b4d216494a9992a354c337c8b2279c43b8", "patch": "@@ -0,0 +1,49 @@\n+long (*extfunc)();\n+\n+static inline void lstrcpynW( short *d, const short *s, int n )\n+{\n+    unsigned int count = n;\n+\n+    while ((count > 1) && *s)\n+    {\n+        count--;\n+        *d++ = *s++;\n+    }\n+    if (count) *d = 0;\n+}\n+\n+int __attribute__((noinline,noclone))\n+badfunc(int u0, int u1, int u2, int u3,\n+  short *fsname, unsigned int fsname_len)\n+{\n+    static const short ntfsW[] = {'N','T','F','S',0};\n+    char superblock[2048+3300];\n+    int ret = 0;\n+    short *p;\n+\n+    if (extfunc())\n+        return 0;\n+    p = (void *)extfunc();\n+    if (p != 0)\n+        goto done;\n+\n+    extfunc(superblock);\n+\n+    lstrcpynW(fsname, ntfsW, fsname_len);\n+\n+    ret = 1;\n+done:\n+    return ret;\n+}\n+\n+static long f()\n+{\n+    return 0;\n+}\n+\n+int main()\n+{\n+    short buf[6];\n+    extfunc = f;\n+    return !badfunc(0, 0, 0, 0, buf, 6);\n+}"}]}