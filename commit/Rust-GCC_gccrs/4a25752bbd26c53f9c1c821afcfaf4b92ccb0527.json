{"sha": "4a25752bbd26c53f9c1c821afcfaf4b92ccb0527", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NGEyNTc1MmJiZDI2YzUzZjljMWM4MjFhZmNmYWY0YjkyY2NiMDUyNw==", "commit": {"author": {"name": "Easwaran Raman", "email": "eraman@google.com", "date": "2011-04-20T18:34:59Z"}, "committer": {"name": "Easwaran Raman", "email": "eraman@gcc.gnu.org", "date": "2011-04-20T18:34:59Z"}, "message": "cfgexpand.c (add_alias_set_conflicts): Add conflicts with a variable containing union type only with -fstrict-aliasing.\n\n2011-04-20  Easwaran Raman  <eraman@google.com>\n\n\t* cfgexpand.c (add_alias_set_conflicts): Add conflicts with a variable\n\tcontaining union type only with -fstrict-aliasing.\n\n2011-04-20  Easwaran Raman  <eraman@google.com>\n\n\t* gcc.dg/stack-layout-1.c: New test.\n\nFrom-SVN: r172788", "tree": {"sha": "82b888cb47014836fd0f723d4bff154d61225312", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/82b888cb47014836fd0f723d4bff154d61225312"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4a25752bbd26c53f9c1c821afcfaf4b92ccb0527", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4a25752bbd26c53f9c1c821afcfaf4b92ccb0527", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4a25752bbd26c53f9c1c821afcfaf4b92ccb0527", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4a25752bbd26c53f9c1c821afcfaf4b92ccb0527/comments", "author": null, "committer": null, "parents": [{"sha": "1809ba94d466b185e0f468999138796cf0da54c7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1809ba94d466b185e0f468999138796cf0da54c7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1809ba94d466b185e0f468999138796cf0da54c7"}], "stats": {"total": 39, "additions": 37, "deletions": 2}, "files": [{"sha": "85ec2e6074793a896b795a2baf4b0ee04aae4b72", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4a25752bbd26c53f9c1c821afcfaf4b92ccb0527/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4a25752bbd26c53f9c1c821afcfaf4b92ccb0527/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=4a25752bbd26c53f9c1c821afcfaf4b92ccb0527", "patch": "@@ -1,3 +1,8 @@\n+2011-04-20  Easwaran Raman  <eraman@google.com>\n+\n+\t* cfgexpand.c (add_alias_set_conflicts): Add conflicts with a variable\n+\tcontaining union type only with -fstrict-aliasing.\n+\n 2011-04-20  Jim Meyering  <meyering@redhat.com>\n \n \tRemove useless if-before-free tests."}, {"sha": "e88bec14945876c7b51ac793e40d01508e4eca12", "filename": "gcc/cfgexpand.c", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4a25752bbd26c53f9c1c821afcfaf4b92ccb0527/gcc%2Fcfgexpand.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4a25752bbd26c53f9c1c821afcfaf4b92ccb0527/gcc%2Fcfgexpand.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcfgexpand.c?ref=4a25752bbd26c53f9c1c821afcfaf4b92ccb0527", "patch": "@@ -373,8 +373,9 @@ add_alias_set_conflicts (void)\n \t\t to elements will conflict.  In case of unions we have\n \t\t to be careful as type based aliasing rules may say\n \t\t access to the same memory does not conflict.  So play\n-\t\t safe and add a conflict in this case.  */\n-\t      || contains_union)\n+\t\t safe and add a conflict in this case when\n+                 -fstrict-aliasing is used.  */\n+              || (contains_union && flag_strict_aliasing))\n \t    add_stack_var_conflict (i, j);\n \t}\n     }"}, {"sha": "dfa5c8c00ced2997cc9a13f1ad1f48dc2316c9f1", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4a25752bbd26c53f9c1c821afcfaf4b92ccb0527/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4a25752bbd26c53f9c1c821afcfaf4b92ccb0527/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=4a25752bbd26c53f9c1c821afcfaf4b92ccb0527", "patch": "@@ -1,3 +1,7 @@\n+2011-04-20  Easwaran Raman  <eraman@google.com>\n+\n+\t* gcc.dg/stack-layout-1.c: New test.\n+\n 2011-04-20  Daniel Jacobowitz  <dan@codesourcery.com>\n \n \t* gcc.dg/vect/vect-shift-3.c, gcc.dg/vect/vect-shift-4.c: New."}, {"sha": "389a4eb051eb424dbf9ab8966586aab6d0657de8", "filename": "gcc/testsuite/gcc.dg/stack-layout-1.c", "status": "added", "additions": 25, "deletions": 0, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4a25752bbd26c53f9c1c821afcfaf4b92ccb0527/gcc%2Ftestsuite%2Fgcc.dg%2Fstack-layout-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4a25752bbd26c53f9c1c821afcfaf4b92ccb0527/gcc%2Ftestsuite%2Fgcc.dg%2Fstack-layout-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fstack-layout-1.c?ref=4a25752bbd26c53f9c1c821afcfaf4b92ccb0527", "patch": "@@ -0,0 +1,25 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -fno-strict-aliasing -fdump-rtl-expand\" } */\n+union U {\n+  int a;\n+  float b;\n+};\n+struct A {\n+  union U u1;\n+  char a[100];\n+};\n+void bar (struct A *);\n+void foo ()\n+  {\n+    {\n+      struct A a;\n+      bar (&a);\n+    }\n+    {\n+      struct A a;\n+      bar (&a);\n+    }\n+  }\n+\n+/* { dg-final { scan-rtl-dump-times \"Partition\" 1 \"expand\" } } */\n+/* { dg-final { cleanup-rtl-dump \"expand\" } } */"}]}