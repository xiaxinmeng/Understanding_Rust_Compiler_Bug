{"sha": "9f693d564fabf90cae085d9d042ef46b697cb807", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWY2OTNkNTY0ZmFiZjkwY2FlMDg1ZDlkMDQyZWY0NmI2OTdjYjgwNw==", "commit": {"author": {"name": "Paolo Carlini", "email": "paolo.carlini@oracle.com", "date": "2012-03-29T22:45:46Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2012-03-29T22:45:46Z"}, "message": "re PR c++/52718 (-Wzero-as-null-pointer-constant: misleading location for 0 as default argument)\n\n/cp\n2012-03-29  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/52718\n\t* decl.c (check_default_argument): With -Wzero-as-null-pointer-constant\n\twarn for a zero as null pointer constant default argument.\n\n/testsuite\n2012-03-29  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/52718\n\t* g++.dg/warn/Wzero-as-null-pointer-constant-5.C: New.\n\nFrom-SVN: r185983", "tree": {"sha": "faf9bc9290b6865b19eb1c4e24fa616af2a800fa", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/faf9bc9290b6865b19eb1c4e24fa616af2a800fa"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9f693d564fabf90cae085d9d042ef46b697cb807", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9f693d564fabf90cae085d9d042ef46b697cb807", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9f693d564fabf90cae085d9d042ef46b697cb807", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9f693d564fabf90cae085d9d042ef46b697cb807/comments", "author": null, "committer": null, "parents": [{"sha": "b9bebd7f03e0117bf488ed687ff752f8a0595b8e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b9bebd7f03e0117bf488ed687ff752f8a0595b8e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b9bebd7f03e0117bf488ed687ff752f8a0595b8e"}], "stats": {"total": 42, "additions": 42, "deletions": 0}, "files": [{"sha": "7e4e5497e3b9ec8eb948bb25d21a362e01ca6e39", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9f693d564fabf90cae085d9d042ef46b697cb807/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9f693d564fabf90cae085d9d042ef46b697cb807/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=9f693d564fabf90cae085d9d042ef46b697cb807", "patch": "@@ -1,3 +1,9 @@\n+2012-03-29  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/52718\n+\t* decl.c (check_default_argument): With -Wzero-as-null-pointer-constant\n+\twarn for a zero as null pointer constant default argument.\n+\n 2012-03-29  Jason Merrill  <jason@redhat.com>\n \n \tPR c++/52685"}, {"sha": "a89523d78f67ba71fd39ca35705826bb4e62899e", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9f693d564fabf90cae085d9d042ef46b697cb807/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9f693d564fabf90cae085d9d042ef46b697cb807/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=9f693d564fabf90cae085d9d042ef46b697cb807", "patch": "@@ -10596,6 +10596,17 @@ check_default_argument (tree decl, tree arg)\n       return error_mark_node;\n     }\n \n+  if (warn_zero_as_null_pointer_constant\n+      && c_inhibit_evaluation_warnings == 0\n+      && (POINTER_TYPE_P (decl_type) || TYPE_PTR_TO_MEMBER_P (decl_type))\n+      && null_ptr_cst_p (arg)\n+      && !NULLPTR_TYPE_P (TREE_TYPE (arg)))\n+    {\n+      warning (OPT_Wzero_as_null_pointer_constant,\n+\t       \"zero as null pointer constant\");\n+      return nullptr_node;\n+    }\n+\n   /* [dcl.fct.default]\n \n      Local variables shall not be used in default argument"}, {"sha": "498218a013df925831ffa308f0cf1b4d6fbab12a", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9f693d564fabf90cae085d9d042ef46b697cb807/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9f693d564fabf90cae085d9d042ef46b697cb807/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=9f693d564fabf90cae085d9d042ef46b697cb807", "patch": "@@ -1,3 +1,8 @@\n+2012-03-29  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/52718\n+\t* g++.dg/warn/Wzero-as-null-pointer-constant-5.C: New.\n+\n 2012-03-29  Jason Merrill  <jason@redhat.com>\n \n \tPR c++/52685"}, {"sha": "185d2b5c4ee15304381ebde11dd0bd862f4f9b34", "filename": "gcc/testsuite/g++.dg/warn/Wzero-as-null-pointer-constant-5.C", "status": "added", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9f693d564fabf90cae085d9d042ef46b697cb807/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWzero-as-null-pointer-constant-5.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9f693d564fabf90cae085d9d042ef46b697cb807/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWzero-as-null-pointer-constant-5.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWzero-as-null-pointer-constant-5.C?ref=9f693d564fabf90cae085d9d042ef46b697cb807", "patch": "@@ -0,0 +1,20 @@\n+// PR c++/52718\n+// { dg-options \"-Wzero-as-null-pointer-constant\" }\n+\n+struct foo\n+{\n+  foo(void* a = 0) {};      // { dg-warning \"zero as null pointer\" }\n+};\n+\n+void* fun(void* a = 0) {};  // { dg-warning \"zero as null pointer\" }\n+\n+struct bar: foo\n+{\n+  bar() {};\n+};\n+\n+struct baz\n+{\n+  baz(const foo& f1 = foo(),\n+      void* f2 = fun()) {};\n+};"}]}