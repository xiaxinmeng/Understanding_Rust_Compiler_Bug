{"sha": "6dfb90cf55f7a7abfcbe6a4bf80b38569cc2a8b6", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NmRmYjkwY2Y1NWY3YTdhYmZjYmU2YTRiZjgwYjM4NTY5Y2MyYThiNg==", "commit": {"author": {"name": "Tom Tromey", "email": "tromey@redhat.com", "date": "2005-07-06T20:10:41Z"}, "committer": {"name": "Tom Tromey", "email": "tromey@gcc.gnu.org", "date": "2005-07-06T20:10:41Z"}, "message": "InputStreamReader.java (refill): Handle no-progress case correctly.\n\n\t* java/io/InputStreamReader.java (refill): Handle no-progress\n\tcase correctly.\n\t* gnu/gcj/convert/IOConverter.java: Add 'utf8' alias.\n\nFrom-SVN: r101663", "tree": {"sha": "06a0be07899ac10cca7cc949fdc95c1331d3b061", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/06a0be07899ac10cca7cc949fdc95c1331d3b061"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6dfb90cf55f7a7abfcbe6a4bf80b38569cc2a8b6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6dfb90cf55f7a7abfcbe6a4bf80b38569cc2a8b6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6dfb90cf55f7a7abfcbe6a4bf80b38569cc2a8b6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6dfb90cf55f7a7abfcbe6a4bf80b38569cc2a8b6/comments", "author": null, "committer": null, "parents": [{"sha": "4b7d2f0796e4f0a49fb56c2ec6477db742b919b6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4b7d2f0796e4f0a49fb56c2ec6477db742b919b6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4b7d2f0796e4f0a49fb56c2ec6477db742b919b6"}], "stats": {"total": 30, "additions": 26, "deletions": 4}, "files": [{"sha": "657e238d87924a450821470d37fb528044f3b257", "filename": "libjava/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6dfb90cf55f7a7abfcbe6a4bf80b38569cc2a8b6/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6dfb90cf55f7a7abfcbe6a4bf80b38569cc2a8b6/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=6dfb90cf55f7a7abfcbe6a4bf80b38569cc2a8b6", "patch": "@@ -1,3 +1,9 @@\n+2005-07-06  Tom Tromey  <tromey@redhat.com>\n+\n+\t* java/io/InputStreamReader.java (refill): Handle no-progress\n+\tcase correctly.\n+\t* gnu/gcj/convert/IOConverter.java: Add 'utf8' alias.\n+\n 2005-07-06  Tom Tromey  <tromey@redhat.com>\n \n \t* testsuite/libjava.jacks/jacks.xfail: Removed 9.1.3-body-5."}, {"sha": "2c6849ce7a37a66235167752df28019743c53fae", "filename": "libjava/gnu/gcj/convert/IOConverter.java", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6dfb90cf55f7a7abfcbe6a4bf80b38569cc2a8b6/libjava%2Fgnu%2Fgcj%2Fconvert%2FIOConverter.java", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6dfb90cf55f7a7abfcbe6a4bf80b38569cc2a8b6/libjava%2Fgnu%2Fgcj%2Fconvert%2FIOConverter.java", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fgnu%2Fgcj%2Fconvert%2FIOConverter.java?ref=6dfb90cf55f7a7abfcbe6a4bf80b38569cc2a8b6", "patch": "@@ -1,4 +1,4 @@\n-/* Copyright (C) 2000, 2001  Free Software Foundation\n+/* Copyright (C) 2000, 2001, 2005  Free Software Foundation\n \n    This file is part of libgcj.\n \n@@ -28,6 +28,8 @@\n     // canonical name.\n     hash.put (\"iso-latin-1\", \"8859_1\");\n     hash.put (\"iso8859_1\", \"8859_1\");\n+    // At least one build script out there uses 'utf8'.\n+    hash.put (\"utf8\", \"UTF8\");\n     // On Solaris the default encoding, as returned by nl_langinfo(),\n     // is `646' (aka ASCII), but the Solaris iconv_open() doesn't\n     // understand that.  We work around the problem by adding an"}, {"sha": "e55f1352caa432ef90f855fa251da2f236741966", "filename": "libjava/java/io/InputStreamReader.java", "status": "modified", "additions": 17, "deletions": 3, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6dfb90cf55f7a7abfcbe6a4bf80b38569cc2a8b6/libjava%2Fjava%2Fio%2FInputStreamReader.java", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6dfb90cf55f7a7abfcbe6a4bf80b38569cc2a8b6/libjava%2Fjava%2Fio%2FInputStreamReader.java", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjava%2Fio%2FInputStreamReader.java?ref=6dfb90cf55f7a7abfcbe6a4bf80b38569cc2a8b6", "patch": "@@ -289,9 +289,23 @@ private int refill(char[] buf, int offset, int length) throws IOException\n \t  return -1;\n \tconverter.setInput(in.buf, in.pos, in.count);\n \tint count = converter.read(buf, offset, length);\n-\tin.skip(converter.inpos - in.pos);\n-\tif (count > 0)\n-\t  return count;\n+\n+\t// We might have bytes but not have made any progress.  In\n+\t// this case we try to refill.  If refilling fails, we assume\n+\t// we have a malformed character at the end of the stream.\n+\tif (count == 0 && converter.inpos == in.pos)\n+\t  {\n+\t    in.mark(in.count);\n+\t    if (! in.refill ())\n+\t      throw new CharConversionException ();\n+\t    in.reset();\n+\t  }\n+\telse\n+\t  {\n+\t    in.skip(converter.inpos - in.pos);\n+\t    if (count > 0)\n+\t      return count;\n+\t  }\n       }\n   }\n }"}]}