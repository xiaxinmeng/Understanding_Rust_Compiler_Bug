{"sha": "2e9cc48c28941114a7b05e42d1ab6abd6919ce62", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MmU5Y2M0OGMyODk0MTExNGE3YjA1ZTQyZDFhYjZhYmQ2OTE5Y2U2Mg==", "commit": {"author": {"name": "Tobias Burnus", "email": "burnus@net-b.de", "date": "2014-12-31T17:16:06Z"}, "committer": {"name": "Tobias Burnus", "email": "burnus@gcc.gnu.org", "date": "2014-12-31T17:16:06Z"}, "message": "match.c (gfc_match_stopcode): Permit error stop in pure procedures with F2015.\n\ngcc/fortran/\n2014-12-31  Tobias Burnus  <burnus@net-b.de>\n\n        * match.c (gfc_match_stopcode): Permit error stop in pure\n        procedures with F2015.\n\ngcc/testsuite/\n2014-12-31  Tobias Burnus  <burnus@net-b.de>\n\n        * gfortran.dg/error_stop_3.f90: New.\n        * gfortran.dg/error_stop_4.f90: New.\n        * gfortran.dg/coarray_3.f90: Remove a dg-error.\n\nFrom-SVN: r219127", "tree": {"sha": "c17275a2aa720df2f31c19545be1af6909c60919", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c17275a2aa720df2f31c19545be1af6909c60919"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2e9cc48c28941114a7b05e42d1ab6abd6919ce62", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2e9cc48c28941114a7b05e42d1ab6abd6919ce62", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2e9cc48c28941114a7b05e42d1ab6abd6919ce62", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2e9cc48c28941114a7b05e42d1ab6abd6919ce62/comments", "author": {"login": "tob2", "id": 264461, "node_id": "MDQ6VXNlcjI2NDQ2MQ==", "avatar_url": "https://avatars.githubusercontent.com/u/264461?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tob2", "html_url": "https://github.com/tob2", "followers_url": "https://api.github.com/users/tob2/followers", "following_url": "https://api.github.com/users/tob2/following{/other_user}", "gists_url": "https://api.github.com/users/tob2/gists{/gist_id}", "starred_url": "https://api.github.com/users/tob2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tob2/subscriptions", "organizations_url": "https://api.github.com/users/tob2/orgs", "repos_url": "https://api.github.com/users/tob2/repos", "events_url": "https://api.github.com/users/tob2/events{/privacy}", "received_events_url": "https://api.github.com/users/tob2/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "1a33dc9ec24fed0406de07f54e0442915e3cfedb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1a33dc9ec24fed0406de07f54e0442915e3cfedb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1a33dc9ec24fed0406de07f54e0442915e3cfedb"}], "stats": {"total": 49, "additions": 44, "deletions": 5}, "files": [{"sha": "b102e312e98543a4b03222117cc644367b18f95f", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2e9cc48c28941114a7b05e42d1ab6abd6919ce62/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2e9cc48c28941114a7b05e42d1ab6abd6919ce62/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=2e9cc48c28941114a7b05e42d1ab6abd6919ce62", "patch": "@@ -1,3 +1,8 @@\n+2014-12-31  Tobias Burnus  <burnus@net-b.de>\n+\n+\t* match.c (gfc_match_stopcode): Permit error stop in pure\n+\tprocedures with F2015.\n+\n 2014-12-31  Uros Bizjak  <ubizjak@gmail.com>\n \n \t* trans-array.c (trans_array_bound_check): Use xasprintf instead"}, {"sha": "2b4202bc96d77231c04c4b514d0d2d7e71bef7a6", "filename": "gcc/fortran/match.c", "status": "modified", "additions": 14, "deletions": 4, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2e9cc48c28941114a7b05e42d1ab6abd6919ce62/gcc%2Ffortran%2Fmatch.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2e9cc48c28941114a7b05e42d1ab6abd6919ce62/gcc%2Ffortran%2Fmatch.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fmatch.c?ref=2e9cc48c28941114a7b05e42d1ab6abd6919ce62", "patch": "@@ -2557,7 +2557,8 @@ gfc_match_cycle (void)\n }\n \n \n-/* Match a number or character constant after an (ALL) STOP or PAUSE statement.  */\n+/* Match a number or character constant after an (ERROR) STOP or PAUSE\n+   statement.  */\n \n static match\n gfc_match_stopcode (gfc_statement st)\n@@ -2581,9 +2582,18 @@ gfc_match_stopcode (gfc_statement st)\n \n   if (gfc_pure (NULL))\n     {\n-      gfc_error (\"%s statement not allowed in PURE procedure at %C\",\n-\t\t gfc_ascii_statement (st));\n-      goto cleanup;\n+      if (st == ST_ERROR_STOP)\n+\t{\n+\t  if (!gfc_notify_std (GFC_STD_F2015, \"%s statement at %C in PURE \"\n+\t\t\t       \"procedure\", gfc_ascii_statement (st)))\n+\t    goto cleanup;\n+\t}\n+      else\n+\t{\n+\t  gfc_error (\"%s statement not allowed in PURE procedure at %C\",\n+\t\t     gfc_ascii_statement (st));\n+\t  goto cleanup;\n+\t}\n     }\n \n   gfc_unset_implicit_pure (NULL);"}, {"sha": "96ca31472c1100e2452b6ea9403fcd2fe94ce01e", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2e9cc48c28941114a7b05e42d1ab6abd6919ce62/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2e9cc48c28941114a7b05e42d1ab6abd6919ce62/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=2e9cc48c28941114a7b05e42d1ab6abd6919ce62", "patch": "@@ -1,3 +1,9 @@\n+2014-12-31  Tobias Burnus  <burnus@net-b.de>\n+\n+\t* gfortran.dg/error_stop_3.f90: New.\n+\t* gfortran.dg/error_stop_4.f90: New.\n+\t* gfortran.dg/coarray_3.f90: Remove a dg-error.\n+\n 2014-12-31  Iain Sandoe  <iain@codesourcery.com>\n \n \t* obj-c++.dg/lambda-0.mm New."}, {"sha": "aba4eb1bc847b04c07f644bc43247712a500ce74", "filename": "gcc/testsuite/gfortran.dg/coarray_3.f90", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2e9cc48c28941114a7b05e42d1ab6abd6919ce62/gcc%2Ftestsuite%2Fgfortran.dg%2Fcoarray_3.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2e9cc48c28941114a7b05e42d1ab6abd6919ce62/gcc%2Ftestsuite%2Fgfortran.dg%2Fcoarray_3.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fcoarray_3.f90?ref=2e9cc48c28941114a7b05e42d1ab6abd6919ce62", "patch": "@@ -79,7 +79,7 @@ pure subroutine pureSub()\n   critical ! { dg-error \"Image control statement CRITICAL\" }\n   end critical ! { dg-error \"Expecting END SUBROUTINE statement\" }\n   sync all ! { dg-error \"Image control statement SYNC\" }\n-  error stop ! { dg-error \"not allowed in PURE procedure\" }\n+  error stop\n end subroutine pureSub\n \n "}, {"sha": "43747397e59a607c1a2c39e4988599c1f44060c5", "filename": "gcc/testsuite/gfortran.dg/error_stop_3.f90", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2e9cc48c28941114a7b05e42d1ab6abd6919ce62/gcc%2Ftestsuite%2Fgfortran.dg%2Ferror_stop_3.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2e9cc48c28941114a7b05e42d1ab6abd6919ce62/gcc%2Ftestsuite%2Fgfortran.dg%2Ferror_stop_3.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Ferror_stop_3.f90?ref=2e9cc48c28941114a7b05e42d1ab6abd6919ce62", "patch": "@@ -0,0 +1,9 @@\n+! { dg-do compile }\n+! { dg-options \"-std=gnu\" }\n+!\n+! F2015 permits ERROR STOP in PURE procedures\n+! FIXME: Change to -std=f2015, when available\n+!\n+pure subroutine foo()\n+  error stop \"failed\"\n+end"}, {"sha": "a28aa3755b26497d6caeccda40403f41183eba1e", "filename": "gcc/testsuite/gfortran.dg/error_stop_4.f90", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2e9cc48c28941114a7b05e42d1ab6abd6919ce62/gcc%2Ftestsuite%2Fgfortran.dg%2Ferror_stop_4.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2e9cc48c28941114a7b05e42d1ab6abd6919ce62/gcc%2Ftestsuite%2Fgfortran.dg%2Ferror_stop_4.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Ferror_stop_4.f90?ref=2e9cc48c28941114a7b05e42d1ab6abd6919ce62", "patch": "@@ -0,0 +1,9 @@\n+! { dg-do compile }\n+! { dg-options \"-std=f2008ts\" }\n+!\n+! F2015 permits ERROR STOP in PURE procedures\n+! FIXME: Change to error_stop_3.f90 to -std=f2015.\n+!\n+pure subroutine foo()\n+  error stop \"failed\"  ! { dg-error \"GNU Extension: ERROR STOP statement at .1. in PURE procedure\" }\n+end"}]}