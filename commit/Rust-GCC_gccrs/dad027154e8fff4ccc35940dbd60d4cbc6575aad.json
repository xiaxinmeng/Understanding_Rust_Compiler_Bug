{"sha": "dad027154e8fff4ccc35940dbd60d4cbc6575aad", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZGFkMDI3MTU0ZThmZmY0Y2NjMzU5NDBkYmQ2MGQ0Y2JjNjU3NWFhZA==", "commit": {"author": {"name": "Richard Guenther", "email": "rguenther@suse.de", "date": "2009-12-11T14:46:09Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2009-12-11T14:46:09Z"}, "message": "re PR lto/41662 (FAIL: g++.dg/lto/20081109 cp_lto_20081109_0.o-cp_lto_20081109_1.o execute -O2 -fwhopr)\n\n2009-12-11  Richard Guenther  <rguenther@suse.de>\n\n\tPR lto/41662\n\t* lto-streamer-in.c (lto_init_eh): Move eh_initialized_p\n\thandling here.\n\t(input_eh_regions): Adjust.\n\t(lto_input_ts_function_decl_tree_pointers): Initialize EH\n\tif a non-NULL DECL_FUNCTION_PERSONALITY was read in.\n\nFrom-SVN: r155163", "tree": {"sha": "ef6d51c28d88455bb982f5b2c2a001f4c88cdb52", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ef6d51c28d88455bb982f5b2c2a001f4c88cdb52"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/dad027154e8fff4ccc35940dbd60d4cbc6575aad", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dad027154e8fff4ccc35940dbd60d4cbc6575aad", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dad027154e8fff4ccc35940dbd60d4cbc6575aad", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dad027154e8fff4ccc35940dbd60d4cbc6575aad/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "e219f32f4b52e334503376ba983ee1503dd34e09", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e219f32f4b52e334503376ba983ee1503dd34e09", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e219f32f4b52e334503376ba983ee1503dd34e09"}], "stats": {"total": 29, "additions": 23, "deletions": 6}, "files": [{"sha": "70a35a7937a32cd3b00a59b400e651a11a718e83", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dad027154e8fff4ccc35940dbd60d4cbc6575aad/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dad027154e8fff4ccc35940dbd60d4cbc6575aad/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=dad027154e8fff4ccc35940dbd60d4cbc6575aad", "patch": "@@ -1,3 +1,12 @@\n+2009-12-11  Richard Guenther  <rguenther@suse.de>\n+\n+\tPR lto/41662\n+\t* lto-streamer-in.c (lto_init_eh): Move eh_initialized_p\n+\thandling here.\n+\t(input_eh_regions): Adjust.\n+\t(lto_input_ts_function_decl_tree_pointers): Initialize EH\n+\tif a non-NULL DECL_FUNCTION_PERSONALITY was read in.\n+\n 2009-12-11  Duncan Sands  <baldrick@free.fr>\n \n \t* passes.c (make_pass_instance): Allocate and copy the right amount of"}, {"sha": "781cf467862e79727f3ac32e90e6b3aaf7a4622b", "filename": "gcc/lto-streamer-in.c", "status": "modified", "additions": 14, "deletions": 6, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dad027154e8fff4ccc35940dbd60d4cbc6575aad/gcc%2Flto-streamer-in.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dad027154e8fff4ccc35940dbd60d4cbc6575aad/gcc%2Flto-streamer-in.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flto-streamer-in.c?ref=dad027154e8fff4ccc35940dbd60d4cbc6575aad", "patch": "@@ -578,6 +578,11 @@ fixup_eh_region_pointers (struct function *fn, HOST_WIDE_INT root_region)\n static void\n lto_init_eh (void)\n {\n+  static bool eh_initialized_p = false;\n+\n+  if (eh_initialized_p)\n+    return;\n+\n   /* Contrary to most other FEs, we only initialize EH support when at\n      least one of the files in the set contains exception regions in\n      it.  Since this happens much later than the call to init_eh in\n@@ -593,6 +598,8 @@ lto_init_eh (void)\n   if (dwarf2out_do_frame ())\n     dwarf2out_frame_init ();\n #endif\n+\n+  eh_initialized_p = true;\n }\n \n \n@@ -605,7 +612,6 @@ input_eh_regions (struct lto_input_block *ib, struct data_in *data_in,\n {\n   HOST_WIDE_INT i, root_region, len;\n   enum LTO_tags tag;\n-  static bool eh_initialized_p = false;\n \n   tag = input_record_start (ib);\n   if (tag == LTO_null)\n@@ -616,11 +622,7 @@ input_eh_regions (struct lto_input_block *ib, struct data_in *data_in,\n   /* If the file contains EH regions, then it was compiled with\n      -fexceptions.  In that case, initialize the backend EH\n      machinery.  */\n-  if (!eh_initialized_p)\n-    {\n-      lto_init_eh ();\n-      eh_initialized_p = true;\n-    }\n+  lto_init_eh ();\n \n   gcc_assert (fn->eh);\n \n@@ -2121,6 +2123,12 @@ lto_input_ts_function_decl_tree_pointers (struct lto_input_block *ib,\n   DECL_FUNCTION_PERSONALITY (expr) = lto_input_tree (ib, data_in);\n   DECL_FUNCTION_SPECIFIC_TARGET (expr) = lto_input_tree (ib, data_in);\n   DECL_FUNCTION_SPECIFIC_OPTIMIZATION (expr) = lto_input_tree (ib, data_in);\n+\n+  /* If the file contains a function with an EH personality set,\n+     then it was compiled with -fexceptions.  In that case, initialize\n+     the backend EH machinery.  */\n+  if (DECL_FUNCTION_PERSONALITY (expr))\n+    lto_init_eh ();\n }\n \n "}]}