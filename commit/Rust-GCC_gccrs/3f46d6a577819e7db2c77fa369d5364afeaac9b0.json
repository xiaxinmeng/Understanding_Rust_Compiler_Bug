{"sha": "3f46d6a577819e7db2c77fa369d5364afeaac9b0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6M2Y0NmQ2YTU3NzgxOWU3ZGIyYzc3ZmEzNjlkNTM2NGFmZWFhYzliMA==", "commit": {"author": {"name": "Manuel L\u00f3pez-Ib\u00e1\u00f1ez", "email": "manu@gcc.gnu.org", "date": "2012-11-07T16:58:03Z"}, "committer": {"name": "Manuel L\u00f3pez-Ib\u00e1\u00f1ez", "email": "manu@gcc.gnu.org", "date": "2012-11-07T16:58:03Z"}, "message": "re PR c/51294 (spurious warning from -Wconversion in C and C++ in conditional expressions)\n\n2012-11-07  Manuel L\u00f3pez-Ib\u00e1\u00f1ez  <manu@gcc.gnu.org>\n\n\tPR c/51294\nc-family/\n\t* c-common.c (conversion_warning): Handle conditional expressions.\ntestsuite/\n\t* c-c++-common/pr51294.c: New.\n\nFrom-SVN: r193301", "tree": {"sha": "0971d353c36c1931f05e569bcfda7a563741f4f0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0971d353c36c1931f05e569bcfda7a563741f4f0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3f46d6a577819e7db2c77fa369d5364afeaac9b0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3f46d6a577819e7db2c77fa369d5364afeaac9b0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3f46d6a577819e7db2c77fa369d5364afeaac9b0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3f46d6a577819e7db2c77fa369d5364afeaac9b0/comments", "author": null, "committer": null, "parents": [{"sha": "dc2d3c67bcc032989d86c9c4637b24157912d34a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dc2d3c67bcc032989d86c9c4637b24157912d34a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dc2d3c67bcc032989d86c9c4637b24157912d34a"}], "stats": {"total": 43, "additions": 27, "deletions": 16}, "files": [{"sha": "6f343ef2419a2b7236bbe1fd29d246ace699f986", "filename": "gcc/c-family/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3f46d6a577819e7db2c77fa369d5364afeaac9b0/gcc%2Fc-family%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3f46d6a577819e7db2c77fa369d5364afeaac9b0/gcc%2Fc-family%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2FChangeLog?ref=3f46d6a577819e7db2c77fa369d5364afeaac9b0", "patch": "@@ -1,3 +1,8 @@\n+2012-11-07  Manuel L\u00f3pez-Ib\u00e1\u00f1ez  <manu@gcc.gnu.org>\n+\n+\tPR c/51294\n+\t* c-common.c (conversion_warning): Handle conditional expressions.\n+\n 2012-10-29  Jonathan Wakely  <jwakely.gcc@gmail.com>\n \n \tPR c++/54930"}, {"sha": "90c1992129f5dec4b7df81d73963cdad2deb0aaf", "filename": "gcc/c-family/c-common.c", "status": "modified", "additions": 8, "deletions": 16, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3f46d6a577819e7db2c77fa369d5364afeaac9b0/gcc%2Fc-family%2Fc-common.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3f46d6a577819e7db2c77fa369d5364afeaac9b0/gcc%2Fc-family%2Fc-common.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2Fc-common.c?ref=3f46d6a577819e7db2c77fa369d5364afeaac9b0", "patch": "@@ -2670,22 +2670,14 @@ conversion_warning (tree type, tree expr)\n \n     case COND_EXPR:\n       {\n-\t/* In case of COND_EXPR, if both operands are constants or\n-\t   COND_EXPR, then we do not care about the type of COND_EXPR,\n-\t   only about the conversion of each operand.  */\n-\ttree op1 = TREE_OPERAND (expr, 1);\n-\ttree op2 = TREE_OPERAND (expr, 2);\n-\n-\tif ((TREE_CODE (op1) == REAL_CST || TREE_CODE (op1) == INTEGER_CST\n-\t     || TREE_CODE (op1) == COND_EXPR)\n-\t    && (TREE_CODE (op2) == REAL_CST || TREE_CODE (op2) == INTEGER_CST\n-\t\t|| TREE_CODE (op2) == COND_EXPR))\n-\t  {\n-\t    conversion_warning (type, op1);\n-\t    conversion_warning (type, op2);\n-\t    return;\n-\t  }\n-\t/* Fall through.  */\n+        /* In case of COND_EXPR, we do not care about the type of\n+           COND_EXPR, only about the conversion of each operand.  */\n+        tree op1 = TREE_OPERAND (expr, 1);\n+        tree op2 = TREE_OPERAND (expr, 2);\n+        \n+        conversion_warning (type, op1);\n+        conversion_warning (type, op2);\n+        return;\n       }\n \n     default: /* 'expr' is not a constant.  */"}, {"sha": "7c2d5dfa39a9098207a526a86431a2ed0ae1fd44", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3f46d6a577819e7db2c77fa369d5364afeaac9b0/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3f46d6a577819e7db2c77fa369d5364afeaac9b0/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=3f46d6a577819e7db2c77fa369d5364afeaac9b0", "patch": "@@ -1,3 +1,8 @@\n+2012-11-07  Manuel L\u00f3pez-Ib\u00e1\u00f1ez  <manu@gcc.gnu.org>\n+\n+\tPR c/51294\n+\t* c-c++-common/pr51294.c: New.\n+\n 2012-11-07  Martin Jambor  <mjambor@suse.cz>\n \n \tPR tree-optimization/53787"}, {"sha": "395e6b2dfc38c87731d763db2d877640afef5bf3", "filename": "gcc/testsuite/c-c++-common/pr51294.c", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3f46d6a577819e7db2c77fa369d5364afeaac9b0/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fpr51294.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3f46d6a577819e7db2c77fa369d5364afeaac9b0/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fpr51294.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fpr51294.c?ref=3f46d6a577819e7db2c77fa369d5364afeaac9b0", "patch": "@@ -0,0 +1,9 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-Wconversion -Wsign-conversion\" } */\n+\n+void foo(int haveBar, char bar_)\n+{\n+  char zuul = haveBar?bar_:0;\n+  char zuul2 = haveBar?bar_:bar_;\n+  char zuul3 = haveBar?0:bar_;\n+}"}]}