{"sha": "6b87d1b4ca69bb14789d100a3c173cc8826c1ff3", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NmI4N2QxYjRjYTY5YmIxNDc4OWQxMDBhM2MxNzNjYzg4MjZjMWZmMw==", "commit": {"author": {"name": "Richard Guenther", "email": "rguenther@suse.de", "date": "2010-05-16T19:56:44Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2010-05-16T19:56:44Z"}, "message": "invoke.texi (-fipa-struct-reorg): Do not mention -fipa-type-escape.\n\n2010-05-16  Richard Guenther  <rguenther@suse.de>\n\n\t* doc/invoke.texi (-fipa-struct-reorg): Do not mention\n\t-fipa-type-escape.\n\t* ipa-type-escape.c (gate_type_escape_vars): Run when\n\t-fipa-struct-reorg runs.\n\t* opts.c (decode_options): Do not unset flag_ipa_type_escape.\n\t* common.opt (fipa-type-escape): Remove.\n\n\t* gcc.dg/pr43317.c: Do not pass -fipa-type-escape.\n\t* gcc.dg/pr43084.c: Likewise.\n\t* gcc.dg/pr42250.c: Pass -fipa-struct-reorg instead of\n\t-fipa-type-escape.\n\t* gcc.dg/struct/wo_prof_escape_arg_to_local.c: Do not pass\n\t-fipa-type-escape.\n\t* gcc.dg/struct/struct-reorg.exp: Likewise.\n\t* gcc.dg/struct/wo_prof_empty_str.c: Likewise.\n\t* gcc.dg/struct/wo_prof_escape_return.c: Likewise.\n\nFrom-SVN: r159464", "tree": {"sha": "fbbc175c38890a47f76c88aa88f9330558efe11d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/fbbc175c38890a47f76c88aa88f9330558efe11d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6b87d1b4ca69bb14789d100a3c173cc8826c1ff3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6b87d1b4ca69bb14789d100a3c173cc8826c1ff3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6b87d1b4ca69bb14789d100a3c173cc8826c1ff3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6b87d1b4ca69bb14789d100a3c173cc8826c1ff3/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "203a92e3844afd5a77cd57d626dca80244a45b89", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/203a92e3844afd5a77cd57d626dca80244a45b89", "html_url": "https://github.com/Rust-GCC/gccrs/commit/203a92e3844afd5a77cd57d626dca80244a45b89"}], "stats": {"total": 53, "additions": 33, "deletions": 20}, "files": [{"sha": "225cdda8fb077351c1943ed784c3f1c999d8f8cb", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6b87d1b4ca69bb14789d100a3c173cc8826c1ff3/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6b87d1b4ca69bb14789d100a3c173cc8826c1ff3/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=6b87d1b4ca69bb14789d100a3c173cc8826c1ff3", "patch": "@@ -1,3 +1,12 @@\n+2010-05-16  Richard Guenther  <rguenther@suse.de>\n+\n+\t* doc/invoke.texi (-fipa-struct-reorg): Do not mention\n+\t-fipa-type-escape.\n+\t* ipa-type-escape.c (gate_type_escape_vars): Run when\n+\t-fipa-struct-reorg runs.\n+\t* opts.c (decode_options): Do not unset flag_ipa_type_escape.\n+\t* common.opt (fipa-type-escape): Remove.\n+\n 2010-05-16  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* opts.c (handle_option): Call into LTO streamer only if ENABLE_LTO."}, {"sha": "8cda9128514aa4d1b0894ec76be0dacdd73a64bc", "filename": "gcc/common.opt", "status": "modified", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6b87d1b4ca69bb14789d100a3c173cc8826c1ff3/gcc%2Fcommon.opt", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6b87d1b4ca69bb14789d100a3c173cc8826c1ff3/gcc%2Fcommon.opt", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcommon.opt?ref=6b87d1b4ca69bb14789d100a3c173cc8826c1ff3", "patch": "@@ -717,10 +717,6 @@ fipa-reference\n Common Report Var(flag_ipa_reference) Init(0) Optimization\n Discover readonly and non addressable static variables\n \n-fipa-type-escape\n-Common Report Var(flag_ipa_type_escape) Init(0) Optimization\n-Type based escape and alias analysis\n-\n fipa-matrix-reorg\n Common Report Var(flag_ipa_matrix_reorg) Optimization\n Perform matrix layout flattening and transposing based"}, {"sha": "e99490227ecd17093116f40bce4bef5970509c65", "filename": "gcc/doc/invoke.texi", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6b87d1b4ca69bb14789d100a3c173cc8826c1ff3/gcc%2Fdoc%2Finvoke.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6b87d1b4ca69bb14789d100a3c173cc8826c1ff3/gcc%2Fdoc%2Finvoke.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdoc%2Finvoke.texi?ref=6b87d1b4ca69bb14789d100a3c173cc8826c1ff3", "patch": "@@ -346,7 +346,7 @@ Objective-C and Objective-C++ Dialects}.\n -finline-functions -finline-functions-called-once -finline-limit=@var{n} @gol\n -finline-small-functions -fipa-cp -fipa-cp-clone -fipa-matrix-reorg -fipa-pta @gol\n -fipa-profile -fipa-pure-const -fipa-reference -fipa-struct-reorg @gol\n--fipa-type-escape -fira-algorithm=@var{algorithm} @gol\n+-fira-algorithm=@var{algorithm} @gol\n -fira-region=@var{region} -fira-coalesce @gol\n -fira-loop-pressure -fno-ira-share-save-slots @gol\n -fno-ira-share-spill-slots -fira-verbose=@var{n} @gol\n@@ -6633,8 +6633,7 @@ Perform structure reorganization optimization, that change C-like structures\n layout in order to better utilize spatial locality.  This transformation is\n affective for programs containing arrays of structures.  Available in two\n compilation modes: profile-based (enabled with @option{-fprofile-generate})\n-or static (which uses built-in heuristics).  Require @option{-fipa-type-escape}\n-to provide the safety of this transformation.  It works only in whole program\n+or static (which uses built-in heuristics).  It works only in whole program\n mode, so it requires @option{-fwhole-program} and @option{-combine} to be\n enabled.  Structures considered @samp{cold} by this transformation are not\n affected (see @option{--param struct-reorg-cold-struct-ratio=@var{value}})."}, {"sha": "c2cb3e877187b36bf5b89c54983966aaa16f1416", "filename": "gcc/ipa-type-escape.c", "status": "modified", "additions": 2, "deletions": 4, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6b87d1b4ca69bb14789d100a3c173cc8826c1ff3/gcc%2Fipa-type-escape.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6b87d1b4ca69bb14789d100a3c173cc8826c1ff3/gcc%2Fipa-type-escape.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-type-escape.c?ref=6b87d1b4ca69bb14789d100a3c173cc8826c1ff3", "patch": "@@ -1,4 +1,4 @@\n-/* Type based alias analysis.\n+/* Escape analysis for types.\n    Copyright (C) 2004, 2005, 2006, 2007, 2008, 2010\n    Free Software Foundation, Inc.\n    Contributed by Kenneth Zadeck <zadeck@naturalbridge.com>\n@@ -2112,9 +2112,7 @@ type_escape_execute (void)\n static bool\n gate_type_escape_vars (void)\n {\n-  return (flag_ipa_type_escape\n-\t  /* Don't bother doing anything if the program has errors.  */\n-\t  && !(errorcount || sorrycount));\n+  return flag_ipa_struct_reorg && flag_whole_program && (optimize > 0);\n }\n \n struct simple_ipa_opt_pass pass_ipa_type_escape ="}, {"sha": "14c9b0420f9113b3684ef7db127ca77a09d1ce14", "filename": "gcc/opts.c", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6b87d1b4ca69bb14789d100a3c173cc8826c1ff3/gcc%2Fopts.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6b87d1b4ca69bb14789d100a3c173cc8826c1ff3/gcc%2Fopts.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fopts.c?ref=6b87d1b4ca69bb14789d100a3c173cc8826c1ff3", "patch": "@@ -1151,7 +1151,6 @@ decode_options (unsigned int argc, const char **argv)\n     {\n       /* These passes are not WHOPR compatible yet.  */\n       flag_ipa_cp = 0;\n-      flag_ipa_type_escape = 0;\n       flag_ipa_pta = 0;\n       flag_ipa_struct_reorg = 0;\n     }"}, {"sha": "4ec703c03adf86e9989fabafef602efbf9ce8001", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6b87d1b4ca69bb14789d100a3c173cc8826c1ff3/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6b87d1b4ca69bb14789d100a3c173cc8826c1ff3/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=6b87d1b4ca69bb14789d100a3c173cc8826c1ff3", "patch": "@@ -1,3 +1,15 @@\n+2010-05-16  Richard Guenther  <rguenther@suse.de>\n+\n+\t* gcc.dg/pr43317.c: Do not pass -fipa-type-escape.\n+\t* gcc.dg/pr43084.c: Likewise.\n+\t* gcc.dg/pr42250.c: Pass -fipa-struct-reorg instead of\n+\t-fipa-type-escape.\n+\t* gcc.dg/struct/wo_prof_escape_arg_to_local.c: Do not pass\n+\t-fipa-type-escape.\n+\t* gcc.dg/struct/struct-reorg.exp: Likewise.\n+\t* gcc.dg/struct/wo_prof_empty_str.c: Likewise.\n+\t* gcc.dg/struct/wo_prof_escape_return.c: Likewise.\n+\n 2010-05-16  Joseph Myers  <joseph@codesourcery.com>\n \n \t* gcc.dg/c1x-static-assert-1.c, gcc.dg/c1x-static-assert-2.c,"}, {"sha": "3ba8e8413e7d50e74565f4709d954e98488c6be9", "filename": "gcc/testsuite/gcc.dg/pr42250.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6b87d1b4ca69bb14789d100a3c173cc8826c1ff3/gcc%2Ftestsuite%2Fgcc.dg%2Fpr42250.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6b87d1b4ca69bb14789d100a3c173cc8826c1ff3/gcc%2Ftestsuite%2Fgcc.dg%2Fpr42250.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr42250.c?ref=6b87d1b4ca69bb14789d100a3c173cc8826c1ff3", "patch": "@@ -1,5 +1,5 @@\n /* { dg-do compile } */\n-/* { dg-options \"-O2 -fipa-type-escape\" } */\n+/* { dg-options \"-O2 -fipa-struct-reorg\" } */\n \n extern double log10 (double __x);\n extern double ceil (double __x);"}, {"sha": "c3101248af68e94756497a7cc9d7d7b98105c963", "filename": "gcc/testsuite/gcc.dg/pr43084.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6b87d1b4ca69bb14789d100a3c173cc8826c1ff3/gcc%2Ftestsuite%2Fgcc.dg%2Fpr43084.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6b87d1b4ca69bb14789d100a3c173cc8826c1ff3/gcc%2Ftestsuite%2Fgcc.dg%2Fpr43084.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr43084.c?ref=6b87d1b4ca69bb14789d100a3c173cc8826c1ff3", "patch": "@@ -1,6 +1,6 @@\n /* PR debug/43084 */\n /* { dg-do compile } */\n-/* { dg-options \"-O1 -fipa-struct-reorg -fwhole-program -fipa-type-escape -fcompare-debug\" } */\n+/* { dg-options \"-O1 -fipa-struct-reorg -fwhole-program -fcompare-debug\" } */\n \n struct S\n {"}, {"sha": "cc5832aee36ed86df7ff1fd752540d918026cd89", "filename": "gcc/testsuite/gcc.dg/pr43317.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6b87d1b4ca69bb14789d100a3c173cc8826c1ff3/gcc%2Ftestsuite%2Fgcc.dg%2Fpr43317.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6b87d1b4ca69bb14789d100a3c173cc8826c1ff3/gcc%2Ftestsuite%2Fgcc.dg%2Fpr43317.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr43317.c?ref=6b87d1b4ca69bb14789d100a3c173cc8826c1ff3", "patch": "@@ -1,5 +1,5 @@\n /* { dg-do compile } */\n-/* { dg-options \"-O -fipa-struct-reorg -fwhole-program -fipa-type-escape -g\" } */\n+/* { dg-options \"-O -fipa-struct-reorg -fwhole-program -g\" } */\n \n extern void *malloc(__SIZE_TYPE__);\n "}, {"sha": "c96501c29804ad83f43d7ad2cccdf6f201d28a77", "filename": "gcc/testsuite/gcc.dg/struct/struct-reorg.exp", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6b87d1b4ca69bb14789d100a3c173cc8826c1ff3/gcc%2Ftestsuite%2Fgcc.dg%2Fstruct%2Fstruct-reorg.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6b87d1b4ca69bb14789d100a3c173cc8826c1ff3/gcc%2Ftestsuite%2Fgcc.dg%2Fstruct%2Fstruct-reorg.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fstruct%2Fstruct-reorg.exp?ref=6b87d1b4ca69bb14789d100a3c173cc8826c1ff3", "patch": "@@ -20,7 +20,7 @@\n load_lib gcc-dg.exp\n load_lib target-supports.exp\n \n-set STRUCT_REORG_CFLAGS \"-O3 -fipa-struct-reorg -fdump-ipa-all -fwhole-program -combine -fipa-type-escape\"\n+set STRUCT_REORG_CFLAGS \"-O3 -fipa-struct-reorg -fdump-ipa-all -fwhole-program -combine\"\n \n # Initialize `dg'.\n dg-init\n@@ -51,7 +51,7 @@ load_lib profopt.exp\n # These are globals used by profopt-execute.  The first is options\n # needed to generate profile data, the second is options to use the\n # profile data.\n-set common \"-O3 -fwhole-program -combine -fipa-type-escape\"\n+set common \"-O3 -fwhole-program -combine\"\n set profile_option [concat $common \" -fprofile-generate\"]\n set feedback_option [concat $common \" -fprofile-use -fipa-struct-reorg -fdump-ipa-all\"]\n "}, {"sha": "db7f6b09cb5f7f84f319004908a9868515d79847", "filename": "gcc/testsuite/gcc.dg/struct/wo_prof_empty_str.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6b87d1b4ca69bb14789d100a3c173cc8826c1ff3/gcc%2Ftestsuite%2Fgcc.dg%2Fstruct%2Fwo_prof_empty_str.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6b87d1b4ca69bb14789d100a3c173cc8826c1ff3/gcc%2Ftestsuite%2Fgcc.dg%2Fstruct%2Fwo_prof_empty_str.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fstruct%2Fwo_prof_empty_str.c?ref=6b87d1b4ca69bb14789d100a3c173cc8826c1ff3", "patch": "@@ -1,4 +1,4 @@\n-/* { dg-options \"-O3 -fno-inline -fipa-type-escape -fdump-ipa-all -fipa-struct-reorg -fwhole-program -combine\" } */\n+/* { dg-options \"-O3 -fno-inline -fdump-ipa-all -fipa-struct-reorg -fwhole-program -combine\" } */\n /* { dg-do compile } */\n /* { dg-do run } */\n "}, {"sha": "e6638b73a6057373f343886f029a88851794475d", "filename": "gcc/testsuite/gcc.dg/struct/wo_prof_escape_arg_to_local.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6b87d1b4ca69bb14789d100a3c173cc8826c1ff3/gcc%2Ftestsuite%2Fgcc.dg%2Fstruct%2Fwo_prof_escape_arg_to_local.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6b87d1b4ca69bb14789d100a3c173cc8826c1ff3/gcc%2Ftestsuite%2Fgcc.dg%2Fstruct%2Fwo_prof_escape_arg_to_local.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fstruct%2Fwo_prof_escape_arg_to_local.c?ref=6b87d1b4ca69bb14789d100a3c173cc8826c1ff3", "patch": "@@ -1,4 +1,4 @@\n-/* { dg-options \"-O3 -fno-inline -fno-ipa-sra -fipa-type-escape -fdump-ipa-all -fipa-struct-reorg -fwhole-program -combine\" } */\n+/* { dg-options \"-O3 -fno-inline -fno-ipa-sra -fdump-ipa-all -fipa-struct-reorg -fwhole-program -combine\" } */\n /* { dg-do compile } */\n /* { dg-do run } */\n "}, {"sha": "8830c55601d6fe14fe9f6c008ab8e078a41c3175", "filename": "gcc/testsuite/gcc.dg/struct/wo_prof_escape_return.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6b87d1b4ca69bb14789d100a3c173cc8826c1ff3/gcc%2Ftestsuite%2Fgcc.dg%2Fstruct%2Fwo_prof_escape_return.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6b87d1b4ca69bb14789d100a3c173cc8826c1ff3/gcc%2Ftestsuite%2Fgcc.dg%2Fstruct%2Fwo_prof_escape_return.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fstruct%2Fwo_prof_escape_return.c?ref=6b87d1b4ca69bb14789d100a3c173cc8826c1ff3", "patch": "@@ -1,4 +1,4 @@\n-/* { dg-options \"-O3 -fno-inline -fipa-type-escape -fdump-ipa-all -fipa-struct-reorg -fwhole-program -combine\" } */\n+/* { dg-options \"-O3 -fno-inline -fdump-ipa-all -fipa-struct-reorg -fwhole-program -combine\" } */\n /* { dg-do compile } */\n /* { dg-do run } */\n "}]}