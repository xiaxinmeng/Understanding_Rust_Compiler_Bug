{"sha": "afce2847b300b1924a08f1fd76b048d94dc22305", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWZjZTI4NDdiMzAwYjE5MjRhMDhmMWZkNzZiMDQ4ZDk0ZGMyMjMwNQ==", "commit": {"author": {"name": "Hans-Peter Nilsson", "email": "hp@axis.com", "date": "2004-05-07T03:20:24Z"}, "committer": {"name": "Hans-Peter Nilsson", "email": "hp@gcc.gnu.org", "date": "2004-05-07T03:20:24Z"}, "message": "re PR rtl-optimization/15296 ([3.4 only] Delayed branch scheduling causing invalid code on cris-*)\n\n\tPR optimization/15296\n\t* reorg.c (fill_simple_delay_slots): Use next_real_insn when\n\tgetting last consecutive label at a branch.\n\t(relax_delay_slots): Similar, near top of loop.\n\nFrom-SVN: r81600", "tree": {"sha": "3fe1cd6d6776b02a4fb490e24bba2280f1a34c0b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3fe1cd6d6776b02a4fb490e24bba2280f1a34c0b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/afce2847b300b1924a08f1fd76b048d94dc22305", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/afce2847b300b1924a08f1fd76b048d94dc22305", "html_url": "https://github.com/Rust-GCC/gccrs/commit/afce2847b300b1924a08f1fd76b048d94dc22305", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/afce2847b300b1924a08f1fd76b048d94dc22305/comments", "author": {"login": "hpataxisdotcom", "id": 80339731, "node_id": "MDQ6VXNlcjgwMzM5NzMx", "avatar_url": "https://avatars.githubusercontent.com/u/80339731?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hpataxisdotcom", "html_url": "https://github.com/hpataxisdotcom", "followers_url": "https://api.github.com/users/hpataxisdotcom/followers", "following_url": "https://api.github.com/users/hpataxisdotcom/following{/other_user}", "gists_url": "https://api.github.com/users/hpataxisdotcom/gists{/gist_id}", "starred_url": "https://api.github.com/users/hpataxisdotcom/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hpataxisdotcom/subscriptions", "organizations_url": "https://api.github.com/users/hpataxisdotcom/orgs", "repos_url": "https://api.github.com/users/hpataxisdotcom/repos", "events_url": "https://api.github.com/users/hpataxisdotcom/events{/privacy}", "received_events_url": "https://api.github.com/users/hpataxisdotcom/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "57408b45844ccf4af894895c6be995f2960d96b5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/57408b45844ccf4af894895c6be995f2960d96b5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/57408b45844ccf4af894895c6be995f2960d96b5"}], "stats": {"total": 15, "additions": 13, "deletions": 2}, "files": [{"sha": "b0eee233a4a77dc32005988f11fc9204e5f148e7", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/afce2847b300b1924a08f1fd76b048d94dc22305/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/afce2847b300b1924a08f1fd76b048d94dc22305/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=afce2847b300b1924a08f1fd76b048d94dc22305", "patch": "@@ -1,3 +1,10 @@\n+2004-05-07  Hans-Peter Nilsson  <hp@axis.com>\n+\n+\tPR optimization/15296\n+\t* reorg.c (fill_simple_delay_slots): Use next_real_insn when\n+\tgetting last consecutive label at a branch.\n+\t(relax_delay_slots): Similar, near top of loop.\n+\n 2004-05-06  John David Anglin  <dave.anglin@nrc-cnrc.gc.ca>\n \n \tPR target/15202"}, {"sha": "2ae0a8f2259f57a77c6be28daf82f21b0494f86f", "filename": "gcc/reorg.c", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/afce2847b300b1924a08f1fd76b048d94dc22305/gcc%2Freorg.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/afce2847b300b1924a08f1fd76b048d94dc22305/gcc%2Freorg.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Freorg.c?ref=afce2847b300b1924a08f1fd76b048d94dc22305", "patch": "@@ -2349,7 +2349,9 @@ fill_simple_delay_slots (int non_jumps_p)\n \t      && eligible_for_delay (insn, slots_filled, next_trial, flags)\n \t      && ! can_throw_internal (trial))\n \t    {\n-\t      rtx new_label = next_active_insn (next_trial);\n+\t      /* See comment in relax_delay_slots about necessity of using\n+\t\t next_real_insn here.  */\n+\t      rtx new_label = next_real_insn (next_trial);\n \n \t      if (new_label != 0)\n \t\tnew_label = get_label_before (new_label);\n@@ -3074,7 +3076,9 @@ relax_delay_slots (rtx first)\n \t  && (target_label = JUMP_LABEL (insn)) != 0)\n \t{\n \t  target_label = follow_jumps (target_label);\n-\t  target_label = prev_label (next_active_insn (target_label));\n+\t  /* See comment further down why we must use next_real_insn here,\n+\t     instead of next_active_insn.  */\n+\t  target_label = prev_label (next_real_insn (target_label));\n \n \t  if (target_label == 0)\n \t    target_label = find_end_label ();"}]}