{"sha": "4357a6c3481d4ab2a32cc905480efdfaacec7937", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDM1N2E2YzM0ODFkNGFiMmEzMmNjOTA1NDgwZWZkZmFhY2VjNzkzNw==", "commit": {"author": {"name": "Chris Demetriou", "email": "cgd@broadcom.com", "date": "2002-07-29T22:07:27Z"}, "committer": {"name": "Chris Demetriou", "email": "cgd@gcc.gnu.org", "date": "2002-07-29T22:07:27Z"}, "message": "configure.in (mips*-*-*): Add a test to see if MIPS libgloss linker scripts use STARTUP directives...\n\n2002-07-29  Chris Demetriou  <cgd@broadcom.com>\n\n        * configure.in (mips*-*-*): Add a test to see if MIPS libgloss\n        linker scripts use STARTUP directives consistently.\n        * configure: Regenerate.\n        * config.in: Regenerate.\n        * config/mips/elf.h (STARTFILE_SPEC): Define conditionally, based\n        on whether HAVE_MIPS_LIBGLOSS_STARTUP_DIRECTIVES is defined.\n        * config/mips/elf64.h (STARTFILE_SPEC): Likewise.\n        * config/mips/isa3264.h (STARTFILE_SPEC): Do not redefine if\n        HAVE_MIPS_LIBGLOSS_STARTUP_DIRECTIVES is set; the result\n        will be the same.\n\nFrom-SVN: r55851", "tree": {"sha": "bc96f85cd11de9c19f512f74bdd5fd6be3ea90b1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/bc96f85cd11de9c19f512f74bdd5fd6be3ea90b1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4357a6c3481d4ab2a32cc905480efdfaacec7937", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4357a6c3481d4ab2a32cc905480efdfaacec7937", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4357a6c3481d4ab2a32cc905480efdfaacec7937", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4357a6c3481d4ab2a32cc905480efdfaacec7937/comments", "author": null, "committer": null, "parents": [{"sha": "9a5cd606802c862d0ce69364facc7c1f098655a0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9a5cd606802c862d0ce69364facc7c1f098655a0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9a5cd606802c862d0ce69364facc7c1f098655a0"}], "stats": {"total": 95, "additions": 93, "deletions": 2}, "files": [{"sha": "f1f8c1506c6a6a551e92656c3cef38572309a6c9", "filename": "gcc/ChangeLog", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4357a6c3481d4ab2a32cc905480efdfaacec7937/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4357a6c3481d4ab2a32cc905480efdfaacec7937/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=4357a6c3481d4ab2a32cc905480efdfaacec7937", "patch": "@@ -1,3 +1,16 @@\n+2002-07-29  Chris Demetriou  <cgd@broadcom.com>\n+\n+\t* configure.in (mips*-*-*): Add a test to see if MIPS libgloss\n+\tlinker scripts use STARTUP directives consistently.\n+\t* configure: Regenerate.\n+\t* config.in: Regenerate.\n+\t* config/mips/elf.h (STARTFILE_SPEC): Define conditionally, based\n+\ton whether HAVE_MIPS_LIBGLOSS_STARTUP_DIRECTIVES is defined.\n+\t* config/mips/elf64.h (STARTFILE_SPEC): Likewise.\n+\t* config/mips/isa3264.h (STARTFILE_SPEC): Do not redefine if\n+\tHAVE_MIPS_LIBGLOSS_STARTUP_DIRECTIVES is set; the result\n+\twill be the same.\n+\n 2002-07-29  Aldy Hernandez  <aldyh@redhat.com>\n \n \t* config/rs6000/rs6000.md (\"cpu\"): Add ppc8540 to attribute."}, {"sha": "de68c88b36d1a3cc8b74dbe9f574050ba632128a", "filename": "gcc/config.in", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4357a6c3481d4ab2a32cc905480efdfaacec7937/gcc%2Fconfig.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4357a6c3481d4ab2a32cc905480efdfaacec7937/gcc%2Fconfig.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig.in?ref=4357a6c3481d4ab2a32cc905480efdfaacec7937", "patch": "@@ -579,6 +579,9 @@\n /* Define if your linker supports --eh-frame-hdr option. */\n #undef HAVE_LD_EH_FRAME_HDR\n \n+/* Define if your MIPS libgloss linker scripts consistently include STARTUP directives. */\n+#undef HAVE_MIPS_LIBGLOSS_STARTUP_DIRECTIVES\n+\n /* Define 0/1 to force the choice for exception handling model. */\n #undef CONFIG_SJLJ_EXCEPTIONS\n "}, {"sha": "b62bf34340975ac50ff2fb12c19e81de8c0ac933", "filename": "gcc/config/mips/elf.h", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4357a6c3481d4ab2a32cc905480efdfaacec7937/gcc%2Fconfig%2Fmips%2Felf.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4357a6c3481d4ab2a32cc905480efdfaacec7937/gcc%2Fconfig%2Fmips%2Felf.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Felf.h?ref=4357a6c3481d4ab2a32cc905480efdfaacec7937", "patch": "@@ -255,7 +255,11 @@ void FN ()                                                            \\\n #define LIB_SPEC \"\"\n \n #undef  STARTFILE_SPEC\n+#ifdef HAVE_MIPS_LIBGLOSS_STARTUP_DIRECTIVES\n+#define STARTFILE_SPEC \"crti%O%s crtbegin%O%s\"\n+#else\n #define STARTFILE_SPEC \"crti%O%s crtbegin%O%s %{!mno-crt0:crt0%O%s}\"\n+#endif\n \n #undef  ENDFILE_SPEC\n #define ENDFILE_SPEC \"crtend%O%s crtn%O%s\""}, {"sha": "32116b7e641c9225dde2a0b65aea128089d7ca87", "filename": "gcc/config/mips/elf64.h", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4357a6c3481d4ab2a32cc905480efdfaacec7937/gcc%2Fconfig%2Fmips%2Felf64.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4357a6c3481d4ab2a32cc905480efdfaacec7937/gcc%2Fconfig%2Fmips%2Felf64.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Felf64.h?ref=4357a6c3481d4ab2a32cc905480efdfaacec7937", "patch": "@@ -225,7 +225,11 @@ void FN ()                                                            \\\n #define LIB_SPEC \"\"\n \n #undef  STARTFILE_SPEC\n+#ifdef HAVE_MIPS_LIBGLOSS_STARTUP_DIRECTIVES\n+#define STARTFILE_SPEC \"crti%O%s crtbegin%O%s\"\n+#else\n #define STARTFILE_SPEC \"crti%O%s crtbegin%O%s %{!mno-crt0:crt0%O%s}\"\n+#endif\n \n #undef  ENDFILE_SPEC\n #define ENDFILE_SPEC \"crtend%O%s crtn%O%s\""}, {"sha": "90525963a2bbc5b316beccee684bc9bb27fc0481", "filename": "gcc/config/mips/isa3264.h", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4357a6c3481d4ab2a32cc905480efdfaacec7937/gcc%2Fconfig%2Fmips%2Fisa3264.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4357a6c3481d4ab2a32cc905480efdfaacec7937/gcc%2Fconfig%2Fmips%2Fisa3264.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fisa3264.h?ref=4357a6c3481d4ab2a32cc905480efdfaacec7937", "patch": "@@ -33,9 +33,13 @@ Boston, MA 02111-1307, USA.  */\n \n #include \"mips/elf.h\"\n \n+#ifndef HAVE_MIPS_LIBGLOSS_STARTUP_DIRECTIVES\n+/* Once HAVE_MIPS_LIBGLOSS_STARTUP_DIRECTIVES is always true, this code\n+   can be GC'd.  */\n #if MIPS_ABI_DEFAULT == ABI_MEABI\n /* For MEABI, don't link with crt0 files, let the linker start files specify\n    the appropriate crt0 file.  */\n #undef  STARTFILE_SPEC\n-#define STARTFILE_SPEC \"crti%O%s crtbegin%O%s %{!mno-crt0: }\"\n+#define STARTFILE_SPEC \"crti%O%s crtbegin%O%s\"\n+#endif\n #endif"}, {"sha": "6c7824d855762c89c5ee775da94a4dc59e01c518", "filename": "gcc/configure", "status": "modified", "additions": 34, "deletions": 1, "changes": 35, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4357a6c3481d4ab2a32cc905480efdfaacec7937/gcc%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4357a6c3481d4ab2a32cc905480efdfaacec7937/gcc%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfigure?ref=4357a6c3481d4ab2a32cc905480efdfaacec7937", "patch": "@@ -7917,6 +7917,39 @@ EOF\n fi\n echo \"$ac_t\"\"$gcc_cv_ld_eh_frame_hdr\" 1>&6\n \n+# Miscellaneous target-specific checks.\n+case \"$target\" in\n+  mips*-*-*)\n+    echo $ac_n \"checking whether libgloss uses STARTUP directives consistently\"\"... $ac_c\" 1>&6\n+echo \"configure:7925: checking whether libgloss uses STARTUP directives consistently\" >&5\n+    gcc_cv_mips_libgloss_startup=no\n+    gcc_cv_libgloss_srcdir=`echo $srcdir | sed -e 's,/gcc$,,'`/libgloss\n+    if test \"x$exec_prefix\" = xNONE; then\n+      if test \"x$prefix\" = xNONE; then\n+        test_prefix=/usr/local\n+      else\n+        test_prefix=$prefix\n+      fi\n+    else\n+      test_prefix=$exec_prefix\n+    fi\n+    for f in $gcc_cv_libgloss_srcdir/mips/idt.ld $test_prefix/$target_alias/lib/idt.ld\n+    do\n+      if grep '^STARTUP' $f > /dev/null 2>&1; then\n+        gcc_cv_mips_libgloss_startup=yes\n+        break\n+      fi\n+    done\n+    if test x\"$gcc_cv_mips_libgloss_startup\" = xyes; then\n+      cat >> confdefs.h <<\\EOF\n+#define HAVE_MIPS_LIBGLOSS_STARTUP_DIRECTIVES 1\n+EOF\n+\n+    fi\n+    echo \"$ac_t\"\"$gcc_cv_mips_libgloss_startup\" 1>&6\n+    ;;\n+esac\n+\n if test \"$prefix\" != \"/usr\" && test \"$prefix\" != \"/usr/local\" ; then\n   cat >> confdefs.h <<EOF\n #define PREFIX_INCLUDE_DIR \"$prefix/include\"\n@@ -8092,7 +8125,7 @@ fi\n \n \n echo $ac_n \"checking whether to enable maintainer-specific portions of Makefiles\"\"... $ac_c\" 1>&6\n-echo \"configure:8096: checking whether to enable maintainer-specific portions of Makefiles\" >&5\n+echo \"configure:8129: checking whether to enable maintainer-specific portions of Makefiles\" >&5\n     # Check whether --enable-maintainer-mode or --disable-maintainer-mode was given.\n if test \"${enable_maintainer_mode+set}\" = set; then\n   enableval=\"$enable_maintainer_mode\""}, {"sha": "5fbdcbca12f2ecfb3aaf5139d76c27f571726d61", "filename": "gcc/configure.in", "status": "modified", "additions": 30, "deletions": 0, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4357a6c3481d4ab2a32cc905480efdfaacec7937/gcc%2Fconfigure.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4357a6c3481d4ab2a32cc905480efdfaacec7937/gcc%2Fconfigure.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfigure.in?ref=4357a6c3481d4ab2a32cc905480efdfaacec7937", "patch": "@@ -2172,6 +2172,36 @@ if test x\"$gcc_cv_ld_eh_frame_hdr\" = xyes; then\n fi\n AC_MSG_RESULT($gcc_cv_ld_eh_frame_hdr)\n \n+# Miscellaneous target-specific checks.\n+case \"$target\" in\n+  mips*-*-*)\n+    AC_MSG_CHECKING(whether libgloss uses STARTUP directives consistently)\n+    gcc_cv_mips_libgloss_startup=no\n+    gcc_cv_libgloss_srcdir=`echo $srcdir | sed -e 's,/gcc$,,'`/libgloss\n+    if test \"x$exec_prefix\" = xNONE; then\n+      if test \"x$prefix\" = xNONE; then\n+        test_prefix=/usr/local\n+      else\n+        test_prefix=$prefix\n+      fi\n+    else\n+      test_prefix=$exec_prefix\n+    fi\n+    for f in $gcc_cv_libgloss_srcdir/mips/idt.ld $test_prefix/$target_alias/lib/idt.ld\n+    do\n+      if grep '^STARTUP' $f > /dev/null 2>&1; then\n+        gcc_cv_mips_libgloss_startup=yes\n+        break\n+      fi\n+    done\n+    if test x\"$gcc_cv_mips_libgloss_startup\" = xyes; then\n+      AC_DEFINE(HAVE_MIPS_LIBGLOSS_STARTUP_DIRECTIVES, 1,\n+        [Define if your MIPS libgloss linker scripts consistently include STARTUP directives.])\n+    fi\n+    AC_MSG_RESULT($gcc_cv_mips_libgloss_startup)\n+    ;;\n+esac\n+\n if test \"$prefix\" != \"/usr\" && test \"$prefix\" != \"/usr/local\" ; then\n   AC_DEFINE_UNQUOTED(PREFIX_INCLUDE_DIR, \"$prefix/include\")\n fi"}]}