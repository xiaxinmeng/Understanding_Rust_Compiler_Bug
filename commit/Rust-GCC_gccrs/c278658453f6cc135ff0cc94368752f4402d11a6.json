{"sha": "c278658453f6cc135ff0cc94368752f4402d11a6", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzI3ODY1ODQ1M2Y2Y2MxMzVmZjBjYzk0MzY4NzUyZjQ0MDJkMTFhNg==", "commit": {"author": {"name": "Kyrylo Tkachov", "email": "kyrylo.tkachov@arm.com", "date": "2014-09-09T11:27:00Z"}, "committer": {"name": "Kyrylo Tkachov", "email": "ktkachov@gcc.gnu.org", "date": "2014-09-09T11:27:00Z"}, "message": "[ARM][5/7] Convert FP mnemonics to UAL | sqrt and FP compare patterns\n\n\t* config/arm/vfp.md (*sqrtsf2_vfp): Use UAL assembly syntax.\n\t(*sqrtdf2_vfp): Likewise.\n\t(*cmpsf_vfp): Likewise.\n\t(*cmpsf_trap_vfp): Likewise.\n\t(*cmpdf_vfp): Likewise.\n\t(*cmpdf_trap_vfp): Likewise.\n\n\t* gcc.target/arm/vfp-1.c: Updated expected assembly.\n\nFrom-SVN: r215054", "tree": {"sha": "9dbed2bb0c80afc3526ba3bc69f6323ad0386f22", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9dbed2bb0c80afc3526ba3bc69f6323ad0386f22"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c278658453f6cc135ff0cc94368752f4402d11a6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c278658453f6cc135ff0cc94368752f4402d11a6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c278658453f6cc135ff0cc94368752f4402d11a6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c278658453f6cc135ff0cc94368752f4402d11a6/comments", "author": {"login": "ktkachov-arm", "id": 74917949, "node_id": "MDQ6VXNlcjc0OTE3OTQ5", "avatar_url": "https://avatars.githubusercontent.com/u/74917949?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ktkachov-arm", "html_url": "https://github.com/ktkachov-arm", "followers_url": "https://api.github.com/users/ktkachov-arm/followers", "following_url": "https://api.github.com/users/ktkachov-arm/following{/other_user}", "gists_url": "https://api.github.com/users/ktkachov-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/ktkachov-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ktkachov-arm/subscriptions", "organizations_url": "https://api.github.com/users/ktkachov-arm/orgs", "repos_url": "https://api.github.com/users/ktkachov-arm/repos", "events_url": "https://api.github.com/users/ktkachov-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/ktkachov-arm/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "14a082a364d3ae8343db57110c03224bcb933c9d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/14a082a364d3ae8343db57110c03224bcb933c9d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/14a082a364d3ae8343db57110c03224bcb933c9d"}], "stats": {"total": 40, "additions": 28, "deletions": 12}, "files": [{"sha": "a2fe548808375a8fd2457aed44338cd9b2ebe612", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c278658453f6cc135ff0cc94368752f4402d11a6/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c278658453f6cc135ff0cc94368752f4402d11a6/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=c278658453f6cc135ff0cc94368752f4402d11a6", "patch": "@@ -1,3 +1,12 @@\n+2014-09-09  Kyrylo Tkachov  <kyrylo.tkachov@arm.com>\n+\n+\t* config/arm/vfp.md (*sqrtsf2_vfp): Use UAL assembly syntax.\n+\t(*sqrtdf2_vfp): Likewise.\n+\t(*cmpsf_vfp): Likewise.\n+\t(*cmpsf_trap_vfp): Likewise.\n+\t(*cmpdf_vfp): Likewise.\n+\t(*cmpdf_trap_vfp): Likewise.\n+\n 2014-09-09  Kyrylo Tkachov  <kyrylo.tkachov@arm.com>\n \n \t* config/arm/vfp.md (*extendsfdf2_vfp): Use UAL assembly syntax."}, {"sha": "d23f7c901e8c10203668d51a865a2643bc01de62", "filename": "gcc/config/arm/vfp.md", "status": "modified", "additions": 13, "deletions": 10, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c278658453f6cc135ff0cc94368752f4402d11a6/gcc%2Fconfig%2Farm%2Fvfp.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c278658453f6cc135ff0cc94368752f4402d11a6/gcc%2Fconfig%2Farm%2Fvfp.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Fvfp.md?ref=c278658453f6cc135ff0cc94368752f4402d11a6", "patch": "@@ -1082,7 +1082,7 @@\n   [(set (match_operand:SF\t   0 \"s_register_operand\" \"=&t,t\")\n \t(sqrt:SF (match_operand:SF 1 \"s_register_operand\" \"t,t\")))]\n   \"TARGET_32BIT && TARGET_HARD_FLOAT && TARGET_VFP\"\n-  \"fsqrts%?\\\\t%0, %1\"\n+  \"vsqrt%?.f32\\\\t%0, %1\"\n   [(set_attr \"predicable\" \"yes\")\n    (set_attr \"predicable_short_it\" \"no\")\n    (set_attr \"arch\" \"*,armv6_or_vfpv3\")\n@@ -1093,7 +1093,7 @@\n   [(set (match_operand:DF\t   0 \"s_register_operand\" \"=&w,w\")\n \t(sqrt:DF (match_operand:DF 1 \"s_register_operand\" \"w,w\")))]\n   \"TARGET_32BIT && TARGET_HARD_FLOAT && TARGET_VFP_DOUBLE\"\n-  \"fsqrtd%?\\\\t%P0, %P1\"\n+  \"vsqrt%?.f64\\\\t%P0, %P1\"\n   [(set_attr \"predicable\" \"yes\")\n    (set_attr \"predicable_short_it\" \"no\")\n    (set_attr \"arch\" \"*,armv6_or_vfpv3\")\n@@ -1175,14 +1175,17 @@\n \n ;; Comparison patterns\n \n+;; In the compare with FP zero case the ARM Architecture Reference Manual\n+;; specifies the immediate to be #0.0.  However, some buggy assemblers only\n+;; accept #0.  We don't want to autodetect broken assemblers, so output #0.\n (define_insn \"*cmpsf_vfp\"\n   [(set (reg:CCFP VFPCC_REGNUM)\n \t(compare:CCFP (match_operand:SF 0 \"s_register_operand\"  \"t,t\")\n \t\t      (match_operand:SF 1 \"vfp_compare_operand\" \"t,G\")))]\n   \"TARGET_32BIT && TARGET_HARD_FLOAT && TARGET_VFP\"\n   \"@\n-   fcmps%?\\\\t%0, %1\n-   fcmpzs%?\\\\t%0\"\n+   vcmp%?.f32\\\\t%0, %1\n+   vcmp%?.f32\\\\t%0, #0\"\n   [(set_attr \"predicable\" \"yes\")\n    (set_attr \"predicable_short_it\" \"no\")\n    (set_attr \"type\" \"fcmps\")]\n@@ -1194,8 +1197,8 @@\n \t\t       (match_operand:SF 1 \"vfp_compare_operand\" \"t,G\")))]\n   \"TARGET_32BIT && TARGET_HARD_FLOAT && TARGET_VFP\"\n   \"@\n-   fcmpes%?\\\\t%0, %1\n-   fcmpezs%?\\\\t%0\"\n+   vcmpe%?.f32\\\\t%0, %1\n+   vcmpe%?.f32\\\\t%0, #0\"\n   [(set_attr \"predicable\" \"yes\")\n    (set_attr \"predicable_short_it\" \"no\")\n    (set_attr \"type\" \"fcmps\")]\n@@ -1207,8 +1210,8 @@\n \t\t      (match_operand:DF 1 \"vfp_compare_operand\" \"w,G\")))]\n   \"TARGET_32BIT && TARGET_HARD_FLOAT && TARGET_VFP_DOUBLE\"\n   \"@\n-   fcmpd%?\\\\t%P0, %P1\n-   fcmpzd%?\\\\t%P0\"\n+   vcmp%?.f64\\\\t%P0, %P1\n+   vcmp%?.f64\\\\t%P0, #0\"\n   [(set_attr \"predicable\" \"yes\")\n    (set_attr \"predicable_short_it\" \"no\")\n    (set_attr \"type\" \"fcmpd\")]\n@@ -1220,8 +1223,8 @@\n \t\t       (match_operand:DF 1 \"vfp_compare_operand\" \"w,G\")))]\n   \"TARGET_32BIT && TARGET_HARD_FLOAT && TARGET_VFP_DOUBLE\"\n   \"@\n-   fcmped%?\\\\t%P0, %P1\n-   fcmpezd%?\\\\t%P0\"\n+   vcmpe%?.f64\\\\t%P0, %P1\n+   vcmpe%?.f64\\\\t%P0, #0\"\n   [(set_attr \"predicable\" \"yes\")\n    (set_attr \"predicable_short_it\" \"no\")\n    (set_attr \"type\" \"fcmpd\")]"}, {"sha": "7214b7ee1c737c20df2d9e077cfa01916121ddd8", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c278658453f6cc135ff0cc94368752f4402d11a6/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c278658453f6cc135ff0cc94368752f4402d11a6/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=c278658453f6cc135ff0cc94368752f4402d11a6", "patch": "@@ -10,6 +10,10 @@\n \n \t* gcc.target/arm/vfp-1.c: Updated expected assembly.\n \n+2014-09-09  Kyrylo Tkachov  <kyrylo.tkachov@arm.com>\n+\n+\t* gcc.target/arm/vfp-1.c: Updated expected assembly.\n+\n 2014-09-09  Kyrylo Tkachov  <kyrylo.tkachov@arm.com>\n \n \t* gcc.target/arm/pr51835.c: Update expected assembly."}, {"sha": "8ceef2ba6379779fd2860c70e5387fe841fa3f4f", "filename": "gcc/testsuite/gcc.target/arm/vfp-1.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c278658453f6cc135ff0cc94368752f4402d11a6/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fvfp-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c278658453f6cc135ff0cc94368752f4402d11a6/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fvfp-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fvfp-1.c?ref=c278658453f6cc135ff0cc94368752f4402d11a6", "patch": "@@ -44,7 +44,7 @@ void test_sf() {\n   /* { dg-final { scan-assembler \"vnmla.f32\" } } */\n   f1 = -f2 * f3 - f1;\n   /* sqrtsf2_vfp */\n-  /* { dg-final { scan-assembler \"fsqrts\" } } */\n+  /* { dg-final { scan-assembler \"vsqrt.f32\" } } */\n   f1 = sqrtf (f1);\n }\n \n@@ -85,7 +85,7 @@ void test_df() {\n   /* { dg-final { scan-assembler \"vnmla.f64\" } } */\n   d1 = -d2 * d3 - d1;\n   /* sqrtdf2_vfp */\n-  /* { dg-final { scan-assembler \"fsqrtd\" } } */\n+  /* { dg-final { scan-assembler \"vsqrt.f64\" } } */\n   d1 = sqrt (d1);\n }\n "}]}