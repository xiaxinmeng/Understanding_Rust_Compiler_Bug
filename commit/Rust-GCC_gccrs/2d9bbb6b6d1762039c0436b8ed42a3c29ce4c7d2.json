{"sha": "2d9bbb6b6d1762039c0436b8ed42a3c29ce4c7d2", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MmQ5YmJiNmI2ZDE3NjIwMzljMDQzNmI4ZWQ0MmEzYzI5Y2U0YzdkMg==", "commit": {"author": {"name": "Tobias Burnus", "email": "burnus@net-b.de", "date": "2008-06-08T07:48:53Z"}, "committer": {"name": "Tobias Burnus", "email": "burnus@gcc.gnu.org", "date": "2008-06-08T07:48:53Z"}, "message": "re PR fortran/35830 (ICE with PROCEDURE(<interface>) containing array formal arguments)\n\n2008-06-08  Tobias Burnus  <burnus@net-b.de>\n\n       PR fortran/35830\n       * resolve.c (resolve_symbol): Copy more attributes for\n       PROCEDUREs with interfaces.\n\n2008-06-08  Tobias Burnus  <burnus@net-b.de>\n\n       PR fortran/35830\n       * proc_decl_13.f90: New.\n       * proc_decl_14.f90: New.\n       * proc_decl_15.f90: New.\n\nFrom-SVN: r136554", "tree": {"sha": "1c9ee13bdb8b1afed0dee7c098d93f402410675e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1c9ee13bdb8b1afed0dee7c098d93f402410675e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2d9bbb6b6d1762039c0436b8ed42a3c29ce4c7d2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2d9bbb6b6d1762039c0436b8ed42a3c29ce4c7d2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2d9bbb6b6d1762039c0436b8ed42a3c29ce4c7d2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2d9bbb6b6d1762039c0436b8ed42a3c29ce4c7d2/comments", "author": {"login": "tob2", "id": 264461, "node_id": "MDQ6VXNlcjI2NDQ2MQ==", "avatar_url": "https://avatars.githubusercontent.com/u/264461?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tob2", "html_url": "https://github.com/tob2", "followers_url": "https://api.github.com/users/tob2/followers", "following_url": "https://api.github.com/users/tob2/following{/other_user}", "gists_url": "https://api.github.com/users/tob2/gists{/gist_id}", "starred_url": "https://api.github.com/users/tob2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tob2/subscriptions", "organizations_url": "https://api.github.com/users/tob2/orgs", "repos_url": "https://api.github.com/users/tob2/repos", "events_url": "https://api.github.com/users/tob2/events{/privacy}", "received_events_url": "https://api.github.com/users/tob2/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "34b74cdf11662e6b1c3001605a93d28a4349d185", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/34b74cdf11662e6b1c3001605a93d28a4349d185", "html_url": "https://github.com/Rust-GCC/gccrs/commit/34b74cdf11662e6b1c3001605a93d28a4349d185"}], "stats": {"total": 112, "additions": 112, "deletions": 0}, "files": [{"sha": "9c950697ddacdf94c8c21a8377c5ea1f51cb7536", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2d9bbb6b6d1762039c0436b8ed42a3c29ce4c7d2/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2d9bbb6b6d1762039c0436b8ed42a3c29ce4c7d2/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=2d9bbb6b6d1762039c0436b8ed42a3c29ce4c7d2", "patch": "@@ -1,3 +1,9 @@\n+2008-06-08  Tobias Burnus  <burnus@net-b.de>\n+\n+\tPR fortran/35830\n+\t* resolve.c (resolve_symbol): Copy more attributes for\n+\tPROCEDUREs with interfaces.\n+\n 2008-06-07  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n \n \tPR fortran/36420"}, {"sha": "9c0e45d63c649185b69ce18bc041c967900ad6c0", "filename": "gcc/fortran/resolve.c", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2d9bbb6b6d1762039c0436b8ed42a3c29ce4c7d2/gcc%2Ffortran%2Fresolve.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2d9bbb6b6d1762039c0436b8ed42a3c29ce4c7d2/gcc%2Ffortran%2Fresolve.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fresolve.c?ref=2d9bbb6b6d1762039c0436b8ed42a3c29ce4c7d2", "patch": "@@ -7905,6 +7905,14 @@ resolve_symbol (gfc_symbol *sym)\n \t  sym->ts.interface = ifc;\n \t  sym->attr.function = ifc->attr.function;\n \t  sym->attr.subroutine = ifc->attr.subroutine;\n+\t  sym->attr.allocatable = ifc->attr.allocatable;\n+\t  sym->attr.pointer = ifc->attr.pointer;\n+\t  sym->attr.pure = ifc->attr.pure;\n+\t  sym->attr.elemental = ifc->attr.elemental;\n+\t  sym->attr.dimension = ifc->attr.dimension;\n+\t  sym->attr.recursive = ifc->attr.recursive;\n+\t  sym->attr.always_explicit = ifc->attr.always_explicit;\n+\t  sym->as = gfc_copy_array_spec (ifc->as);\n \t  copy_formal_args (sym, ifc);\n \t}\n       else if (sym->ts.interface->name[0] != '\\0')"}, {"sha": "d6a0c031e3920da175a2eca5530a513bf4c51eed", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2d9bbb6b6d1762039c0436b8ed42a3c29ce4c7d2/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2d9bbb6b6d1762039c0436b8ed42a3c29ce4c7d2/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=2d9bbb6b6d1762039c0436b8ed42a3c29ce4c7d2", "patch": "@@ -1,3 +1,10 @@\n+2008-06-08  Tobias Burnus  <burnus@net-b.de>\n+\n+\tPR fortran/35830\n+\t* proc_decl_13.f90: New.\n+\t* proc_decl_14.f90: New.\n+\t* proc_decl_15.f90: New.\n+\n 2008-06-07  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n \n \tPR fortran/36420"}, {"sha": "b875376a09d096b165aae09f1986bbb9178e645f", "filename": "gcc/testsuite/gfortran.dg/proc_decl_13.f90", "status": "added", "additions": 45, "deletions": 0, "changes": 45, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2d9bbb6b6d1762039c0436b8ed42a3c29ce4c7d2/gcc%2Ftestsuite%2Fgfortran.dg%2Fproc_decl_13.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2d9bbb6b6d1762039c0436b8ed42a3c29ce4c7d2/gcc%2Ftestsuite%2Fgfortran.dg%2Fproc_decl_13.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fproc_decl_13.f90?ref=2d9bbb6b6d1762039c0436b8ed42a3c29ce4c7d2", "patch": "@@ -0,0 +1,45 @@\n+! { dg-do run }\n+! PR fortran/35830\n+!\n+module m\n+contains\n+  subroutine one(a)\n+      integer a(:)\n+      print *, lbound(a), ubound(a), size(a)\n+      if ((lbound(a,dim=1) /= 1) .or. (ubound(a,dim=1) /= 3)) &\n+        call abort()\n+      print *, a\n+      if (any(a /= [1,2,3])) call abort()\n+  end subroutine one\n+end module m\n+\n+program test\n+  use m\n+  implicit none\n+  call foo1(one)\n+  call foo2(one)\n+contains\n+  subroutine foo1(f)\n+    ! The following interface block is needed\n+    ! for NAG f95 as it wrongly does not like\n+    ! use-associated interfaces for PROCEDURE\n+    ! (It is not needed for gfortran)\n+    interface\n+      subroutine bar(a)\n+        integer a(:)\n+      end subroutine\n+    end interface\n+    procedure(bar) :: f\n+    call f([1,2,3]) ! Was failing before\n+  end subroutine foo1\n+  subroutine foo2(f)\n+    interface\n+      subroutine f(a)\n+        integer a(:)\n+      end subroutine\n+    end interface\n+    call f([1,2,3]) ! Works\n+  end subroutine foo2\n+\n+! { dg-final { cleanup-modules \"m\" } }\n+end program test"}, {"sha": "d30ee7a9067be0ade700041affab403976dd607a", "filename": "gcc/testsuite/gfortran.dg/proc_decl_14.f90", "status": "added", "additions": 26, "deletions": 0, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2d9bbb6b6d1762039c0436b8ed42a3c29ce4c7d2/gcc%2Ftestsuite%2Fgfortran.dg%2Fproc_decl_14.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2d9bbb6b6d1762039c0436b8ed42a3c29ce4c7d2/gcc%2Ftestsuite%2Fgfortran.dg%2Fproc_decl_14.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fproc_decl_14.f90?ref=2d9bbb6b6d1762039c0436b8ed42a3c29ce4c7d2", "patch": "@@ -0,0 +1,26 @@\n+! { dg-do compile }\n+! PR fortran/35830\n+!\n+abstract interface\n+  function ptrfunc()\n+    integer, pointer :: ptrfunc\n+  end function ptrfunc\n+  elemental subroutine elem(a)\n+    integer,intent(in) :: a\n+  end subroutine elem\n+  function dims()\n+    integer :: dims(3)\n+  end function dims\n+end interface\n+\n+procedure(ptrfunc) :: func_a\n+procedure(elem)    :: func_b\n+procedure(dims)     :: func_c\n+\n+integer, pointer :: ptr\n+integer :: array(3)\n+\n+ptr => func_a()\n+call func_b([1,2,3])\n+array = func_c()\n+end"}, {"sha": "f099c1deafb7323864b520aaee36a6bf3cf6538e", "filename": "gcc/testsuite/gfortran.dg/proc_decl_15.f90", "status": "added", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2d9bbb6b6d1762039c0436b8ed42a3c29ce4c7d2/gcc%2Ftestsuite%2Fgfortran.dg%2Fproc_decl_15.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2d9bbb6b6d1762039c0436b8ed42a3c29ce4c7d2/gcc%2Ftestsuite%2Fgfortran.dg%2Fproc_decl_15.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fproc_decl_15.f90?ref=2d9bbb6b6d1762039c0436b8ed42a3c29ce4c7d2", "patch": "@@ -0,0 +1,20 @@\n+! { dg-do run }\n+! PR fortran/35830\n+!\n+function f()\n+  real, allocatable :: f(:)\n+  allocate(f(1:3))\n+  f(1:3)= (/9,8,7/)\n+end function\n+\n+program test\n+  implicit none\n+  abstract interface\n+    function ai()\n+      real, allocatable :: ai(:)\n+    end function\n+  end interface\n+  procedure(ai) :: f\n+  if(any(f() /= [9,8,7])) call abort()\n+  if(size(f()) /= 3) call abort()\n+end"}]}