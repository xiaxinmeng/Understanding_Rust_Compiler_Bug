{"sha": "bc2fcccd9d5cc9d346543a98c98dc00d71e9a5b8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmMyZmNjY2Q5ZDVjYzlkMzQ2NTQzYTk4Yzk4ZGMwMGQ3MWU5YTViOA==", "commit": {"author": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2020-10-01T13:03:19Z"}, "committer": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2020-10-01T13:03:19Z"}, "message": "Fix ICE in ipa_edge_args_sum_t::duplicate\n\n\tPR ipa/97244\n\t* ipa-fnsummary.c (pass_free_fnsummary::execute): Free\n\talso indirect inlining datastructure.\n\t* ipa-modref.c (pass_ipa_modref::execute): Do not free them here.\n\t* ipa-prop.c (ipa_free_all_node_params): Do not crash when info does\n\tnot exist.\n\t(ipa_unregister_cgraph_hooks): Likewise.", "tree": {"sha": "be417efb9b3e9e5376741a893fbefa4c44ba938a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/be417efb9b3e9e5376741a893fbefa4c44ba938a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bc2fcccd9d5cc9d346543a98c98dc00d71e9a5b8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bc2fcccd9d5cc9d346543a98c98dc00d71e9a5b8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bc2fcccd9d5cc9d346543a98c98dc00d71e9a5b8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bc2fcccd9d5cc9d346543a98c98dc00d71e9a5b8/comments", "author": null, "committer": null, "parents": [{"sha": "ba663ac1b1add0f1625862166a946fcb583d3686", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ba663ac1b1add0f1625862166a946fcb583d3686", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ba663ac1b1add0f1625862166a946fcb583d3686"}], "stats": {"total": 10, "additions": 6, "deletions": 4}, "files": [{"sha": "8285cc00d33ccad633f49935bc73e7b8ddbb9047", "filename": "gcc/ipa-fnsummary.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bc2fcccd9d5cc9d346543a98c98dc00d71e9a5b8/gcc%2Fipa-fnsummary.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bc2fcccd9d5cc9d346543a98c98dc00d71e9a5b8/gcc%2Fipa-fnsummary.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-fnsummary.c?ref=bc2fcccd9d5cc9d346543a98c98dc00d71e9a5b8", "patch": "@@ -4680,6 +4680,8 @@ class pass_ipa_free_fn_summary : public simple_ipa_opt_pass\n   virtual unsigned int execute (function *)\n     {\n       ipa_free_fn_summary ();\n+      /* Free ipa-prop structures if they are no longer needed.  */\n+      ipa_free_all_structures_after_iinln ();\n       if (!flag_wpa)\n \tipa_free_size_summary ();\n       return 0;"}, {"sha": "2f4da8f2a148e61bd5b8b366ab73661797278f96", "filename": "gcc/ipa-modref.c", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bc2fcccd9d5cc9d346543a98c98dc00d71e9a5b8/gcc%2Fipa-modref.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bc2fcccd9d5cc9d346543a98c98dc00d71e9a5b8/gcc%2Fipa-modref.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-modref.c?ref=bc2fcccd9d5cc9d346543a98c98dc00d71e9a5b8", "patch": "@@ -1681,8 +1681,6 @@ pass_ipa_modref::execute (function *)\n     }\n   ((modref_summaries *)summaries)->ipa = false;\n   ipa_free_postorder_info ();\n-  /* Free ipa-prop structures if they are no longer needed.  */\n-  ipa_free_all_structures_after_iinln ();\n   return 0;\n }\n "}, {"sha": "ea88fd3fd95e1a7779a8b08d367cd89bc0ab5216", "filename": "gcc/ipa-prop.c", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bc2fcccd9d5cc9d346543a98c98dc00d71e9a5b8/gcc%2Fipa-prop.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bc2fcccd9d5cc9d346543a98c98dc00d71e9a5b8/gcc%2Fipa-prop.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-prop.c?ref=bc2fcccd9d5cc9d346543a98c98dc00d71e9a5b8", "patch": "@@ -4124,7 +4124,8 @@ ipa_free_all_edge_args (void)\n void\n ipa_free_all_node_params (void)\n {\n-  ggc_delete (ipa_node_params_sum);\n+  if (ipa_node_params_sum)\n+    ggc_delete (ipa_node_params_sum);\n   ipa_node_params_sum = NULL;\n }\n \n@@ -4368,7 +4369,8 @@ ipa_register_cgraph_hooks (void)\n static void\n ipa_unregister_cgraph_hooks (void)\n {\n-  symtab->remove_cgraph_insertion_hook (function_insertion_hook_holder);\n+  if (function_insertion_hook_holder)\n+    symtab->remove_cgraph_insertion_hook (function_insertion_hook_holder);\n   function_insertion_hook_holder = NULL;\n }\n "}]}