{"sha": "697a3325ef0aab758d95216c5aea3e6b1bf8d6fe", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Njk3YTMzMjVlZjBhYWI3NThkOTUyMTZjNWFlYTNlNmIxYmY4ZDZmZQ==", "commit": {"author": {"name": "Greta Yorsh", "email": "greta.yorsh@arm.com", "date": "2013-01-29T18:36:53Z"}, "committer": {"name": "Greta Yorsh", "email": "gretay@gcc.gnu.org", "date": "2013-01-29T18:36:53Z"}, "message": "cortex-a7.md (cortex_a7_neon_mul): New reservation.\n\n2013-01-29  Greta Yorsh  <Greta.Yorsh@arm.com>\n\n        * config/arm/cortex-a7.md (cortex_a7_neon_mul):  New reservation.\n\t(cortex_a7_neon_mla): Likewise.\n        (cortex_a7_fpfmad): New reservation.\n        (cortex_a7_fpmacs): Use ffmas and update required units.\n        (cortex_a7_fpmuld): Update required units and latency.\n        (cortex_a7_fpmacd): Likewise.\n        (cortex_a7_fdivs, cortex_a7_fdivd): Likewise.\n        (cortex_a7_neon). Likewise.\n        (bypass) Update participating units.\n\nFrom-SVN: r195552", "tree": {"sha": "d6a20c1c714395b4a81576e079e45a537d424ffe", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d6a20c1c714395b4a81576e079e45a537d424ffe"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/697a3325ef0aab758d95216c5aea3e6b1bf8d6fe", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/697a3325ef0aab758d95216c5aea3e6b1bf8d6fe", "html_url": "https://github.com/Rust-GCC/gccrs/commit/697a3325ef0aab758d95216c5aea3e6b1bf8d6fe", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/697a3325ef0aab758d95216c5aea3e6b1bf8d6fe/comments", "author": null, "committer": null, "parents": [{"sha": "29637783d5b642e5ab85c20f598de3ded0a7a100", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/29637783d5b642e5ab85c20f598de3ded0a7a100", "html_url": "https://github.com/Rust-GCC/gccrs/commit/29637783d5b642e5ab85c20f598de3ded0a7a100"}], "stats": {"total": 98, "additions": 78, "deletions": 20}, "files": [{"sha": "669185909facd22398ce0af851267b2e607df7e2", "filename": "gcc/ChangeLog", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/697a3325ef0aab758d95216c5aea3e6b1bf8d6fe/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/697a3325ef0aab758d95216c5aea3e6b1bf8d6fe/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=697a3325ef0aab758d95216c5aea3e6b1bf8d6fe", "patch": "@@ -1,3 +1,15 @@\n+2013-01-29  Greta Yorsh  <Greta.Yorsh@arm.com>\n+\n+        * config/arm/cortex-a7.md (cortex_a7_neon_mul):  New reservation.\n+\t(cortex_a7_neon_mla): Likewise.\n+        (cortex_a7_fpfmad): New reservation.\n+        (cortex_a7_fpmacs): Use ffmas and update required units.\n+        (cortex_a7_fpmuld): Update required units and latency.\n+        (cortex_a7_fpmacd): Likewise.\n+        (cortex_a7_fdivs, cortex_a7_fdivd): Likewise.\n+        (cortex_a7_neon). Likewise.\n+        (bypass) Update participating units.\n+\n 2013-01-29  Greta Yorsh  <Greta.Yorsh@arm.com>\n \n         * config/arm/arm.md (type): Add ffmas and ffmad to \"type\" attribute."}, {"sha": "a55efeb2e3474132925f1f987ed4798c9f62b307", "filename": "gcc/config/arm/cortex-a7.md", "status": "modified", "additions": 66, "deletions": 20, "changes": 86, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/697a3325ef0aab758d95216c5aea3e6b1bf8d6fe/gcc%2Fconfig%2Farm%2Fcortex-a7.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/697a3325ef0aab758d95216c5aea3e6b1bf8d6fe/gcc%2Fconfig%2Farm%2Fcortex-a7.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Fcortex-a7.md?ref=697a3325ef0aab758d95216c5aea3e6b1bf8d6fe", "patch": "@@ -202,6 +202,9 @@\n ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n ;; Floating-point arithmetic.\n ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n+;; Neon integer, neon floating point, and single-precision floating\n+;; point instructions of the same type have the same timing\n+;; characteristics, but neon instructions cannot dual-issue.\n \n (define_insn_reservation \"cortex_a7_fpalu\" 4\n   (and (eq_attr \"tune\" \"cortexa7\")\n@@ -229,18 +232,37 @@\n             (eq_attr \"neon_type\" \"none\")))\n   \"cortex_a7_ex1+cortex_a7_fpmul_pipe\")\n \n-;; For single-precision multiply-accumulate, the add (accumulate) is issued\n-;; whilst the multiply is in F4.  The multiply result can then be forwarded\n-;; from F5 to F1.  The issue unit is only used once (when we first start\n-;; processing the instruction), but the usage of the FP add pipeline could\n-;; block other instructions attempting to use it simultaneously.  We try to\n-;; avoid that using cortex_a7_fpadd_pipe.\n+(define_insn_reservation \"cortex_a7_neon_mul\" 4\n+  (and (eq_attr \"tune\" \"cortexa7\")\n+       (eq_attr \"neon_type\"\n+                \"neon_mul_ddd_8_16_qdd_16_8_long_32_16_long,\\\n+                 neon_mul_qqq_8_16_32_ddd_32,\\\n+                 neon_mul_qdd_64_32_long_qqd_16_ddd_32_scalar_64_32_long_scalar,\\\n+                 neon_mul_ddd_16_scalar_32_16_long_scalar,\\\n+                 neon_mul_qqd_32_scalar,\\\n+                 neon_fp_vmul_ddd,\\\n+                 neon_fp_vmul_qqd\"))\n+  \"(cortex_a7_both+cortex_a7_fpmul_pipe)*2\")\n \n (define_insn_reservation \"cortex_a7_fpmacs\" 8\n   (and (eq_attr \"tune\" \"cortexa7\")\n-       (and (eq_attr \"type\" \"fmacs\")\n+       (and (eq_attr \"type\" \"fmacs,ffmas\")\n             (eq_attr \"neon_type\" \"none\")))\n-  \"cortex_a7_ex1+cortex_a7_fpmul_pipe, nothing*3, cortex_a7_fpadd_pipe\")\n+  \"cortex_a7_ex1+cortex_a7_fpmul_pipe\")\n+\n+(define_insn_reservation \"cortex_a7_neon_mla\" 8\n+  (and (eq_attr \"tune\" \"cortexa7\")\n+       (eq_attr \"neon_type\"\n+                \"neon_mla_ddd_8_16_qdd_16_8_long_32_16_long,\\\n+                 neon_mla_qqq_8_16,\\\n+                 neon_mla_ddd_32_qqd_16_ddd_32_scalar_qdd_64_32_long_scalar_qdd_64_32_long,\\\n+                 neon_mla_qqq_32_qqd_32_scalar,\\\n+                 neon_mla_ddd_16_scalar_qdd_32_16_long_scalar,\\\n+                 neon_fp_vmla_ddd,\\\n+                 neon_fp_vmla_qqq,\\\n+                 neon_fp_vmla_ddd_scalar,\\\n+                 neon_fp_vmla_qqq_scalar\"))\n+  \"cortex_a7_both+cortex_a7_fpmul_pipe\")\n \n ;; Non-multiply instructions can issue between two cycles of a\n ;; double-precision multiply. \n@@ -249,15 +271,19 @@\n   (and (eq_attr \"tune\" \"cortexa7\")\n        (and (eq_attr \"type\" \"fmuld\")\n             (eq_attr \"neon_type\" \"none\")))\n-  \"cortex_a7_ex1+cortex_a7_fpmul_pipe, cortex_a7_fpmul_pipe*2,\\\n-   cortex_a7_ex1+cortex_a7_fpmul_pipe\")\n+  \"cortex_a7_ex1+cortex_a7_fpmul_pipe, cortex_a7_fpmul_pipe*3\")\n \n (define_insn_reservation \"cortex_a7_fpmacd\" 11\n   (and (eq_attr \"tune\" \"cortexa7\")\n        (and (eq_attr \"type\" \"fmacd\")\n             (eq_attr \"neon_type\" \"none\")))\n-  \"cortex_a7_ex1+cortex_a7_fpmul_pipe, cortex_a7_fpmul_pipe*2,\\\n-   cortex_a7_ex1+cortex_a7_fpmul_pipe, nothing*3, cortex_a7_fpadd_pipe\")\n+  \"cortex_a7_ex1+cortex_a7_fpmul_pipe, cortex_a7_fpmul_pipe*3\")\n+\n+(define_insn_reservation \"cortex_a7_fpfmad\" 8\n+  (and (eq_attr \"tune\" \"cortexa7\")\n+       (and (eq_attr \"type\" \"ffmad\")\n+            (eq_attr \"neon_type\" \"none\")))\n+  \"cortex_a7_ex1+cortex_a7_fpmul_pipe, cortex_a7_fpmul_pipe*4\")\n \n ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n ;; Floating-point divide/square root instructions.\n@@ -267,13 +293,13 @@\n   (and (eq_attr \"tune\" \"cortexa7\")\n        (and (eq_attr \"type\" \"fdivs\")\n             (eq_attr \"neon_type\" \"none\")))\n-  \"cortex_a7_ex1, cortex_a7_fp_div_sqrt * 14\")\n+  \"cortex_a7_ex1+cortex_a7_fp_div_sqrt, cortex_a7_fp_div_sqrt * 13\")\n \n-(define_insn_reservation \"cortex_a7_fdivd\" 29\n+(define_insn_reservation \"cortex_a7_fdivd\" 31\n   (and (eq_attr \"tune\" \"cortexa7\")\n        (and (eq_attr \"type\" \"fdivd\")\n             (eq_attr \"neon_type\" \"none\")))\n-  \"cortex_a7_ex1, cortex_a7_fp_div_sqrt * 28\")\n+  \"cortex_a7_ex1+cortex_a7_fp_div_sqrt, cortex_a7_fp_div_sqrt * 28\")\n \n ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n ;; VFP to/from core transfers.\n@@ -338,16 +364,36 @@\n ;; i.e. a latency of two.\n \n (define_bypass 2 \"cortex_a7_f_loads, cortex_a7_f_loadd\"\n-                 \"cortex_a7_fpalu, cortex_a7_fpmacs, cortex_a7_fpmuld,\\\n-\t\t  cortex_a7_fpmacd, cortex_a7_fdivs, cortex_a7_fdivd,\\\n-\t\t  cortex_a7_f2r\")\n+                  \"cortex_a7_fpalu,\\\n+                   cortex_a7_fpmuls,cortex_a7_fpmacs,\\\n+                   cortex_a7_fpmuld,cortex_a7_fpmacd, cortex_a7_fpfmad,\\\n+                   cortex_a7_fdivs, cortex_a7_fdivd,\\\n+\t\t   cortex_a7_f2r\")\n \n ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n-;; NEON load/store.\n+;; NEON\n ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n \n+;; Simple modeling for all neon instructions not covered earlier.\n \n (define_insn_reservation \"cortex_a7_neon\" 4\n   (and (eq_attr \"tune\" \"cortexa7\")\n-       (eq_attr \"neon_type\" \"!none\"))\n+       (eq_attr \"neon_type\"\n+                \"!none,\\\n+                  neon_mul_ddd_8_16_qdd_16_8_long_32_16_long,\\\n+                  neon_mul_qqq_8_16_32_ddd_32,\\\n+                  neon_mul_qdd_64_32_long_qqd_16_ddd_32_scalar_64_32_long_scalar,\\\n+                  neon_mla_ddd_8_16_qdd_16_8_long_32_16_long,\\\n+                  neon_mla_qqq_8_16,\\\n+                  neon_mla_ddd_32_qqd_16_ddd_32_scalar_qdd_64_32_long_scalar_qdd_64_32_long,\\\n+                  neon_mla_qqq_32_qqd_32_scalar,\\\n+                  neon_mul_ddd_16_scalar_32_16_long_scalar,\\\n+                  neon_mul_qqd_32_scalar,\\\n+                  neon_mla_ddd_16_scalar_qdd_32_16_long_scalar,\\\n+                  neon_fp_vmul_ddd,\\\n+                  neon_fp_vmul_qqd,\\\n+                  neon_fp_vmla_ddd,\\\n+                  neon_fp_vmla_qqq,\\\n+                  neon_fp_vmla_ddd_scalar,\\\n+                  neon_fp_vmla_qqq_scalar\"))\n   \"cortex_a7_both*2\")"}]}