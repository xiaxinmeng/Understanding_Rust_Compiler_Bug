{"sha": "dec0fa945c807ed495a3b74fbf98c6d30a19b4c8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZGVjMGZhOTQ1YzgwN2VkNDk1YTNiNzRmYmY5OGM2ZDMwYTE5YjRjOA==", "commit": {"author": {"name": "Martin v. L\u00f6wis", "email": "loewis@informatik.hu-berlin.de", "date": "1999-12-21T18:10:24Z"}, "committer": {"name": "Martin v. L\u00f6wis", "email": "loewis@gcc.gnu.org", "date": "1999-12-21T18:10:24Z"}, "message": "* filebuf.cc (open): Support ios::ate if _G_HAVE_IO_FILE_OPEN.\n\nFrom-SVN: r31057", "tree": {"sha": "66a4b256b271dcd24e3041f2ae3fd51b171f71b5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/66a4b256b271dcd24e3041f2ae3fd51b171f71b5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/dec0fa945c807ed495a3b74fbf98c6d30a19b4c8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dec0fa945c807ed495a3b74fbf98c6d30a19b4c8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dec0fa945c807ed495a3b74fbf98c6d30a19b4c8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dec0fa945c807ed495a3b74fbf98c6d30a19b4c8/comments", "author": null, "committer": null, "parents": [{"sha": "74a7ea1231dd7c97ff90a1c39944cb6f4cd3ab68", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/74a7ea1231dd7c97ff90a1c39944cb6f4cd3ab68", "html_url": "https://github.com/Rust-GCC/gccrs/commit/74a7ea1231dd7c97ff90a1c39944cb6f4cd3ab68"}], "stats": {"total": 20, "additions": 16, "deletions": 4}, "files": [{"sha": "b582999f6140fca8568d4b5c30f4ffa2401d9b00", "filename": "libio/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dec0fa945c807ed495a3b74fbf98c6d30a19b4c8/libio%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dec0fa945c807ed495a3b74fbf98c6d30a19b4c8/libio%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libio%2FChangeLog?ref=dec0fa945c807ed495a3b74fbf98c6d30a19b4c8", "patch": "@@ -1,3 +1,7 @@\n+1999-12-21  Martin v. L\ufffdwis  <loewis@informatik.hu-berlin.de>\n+\n+\t* filebuf.cc (open): Support ios::ate if _G_HAVE_IO_FILE_OPEN.\n+\n 1999-12-15  Jason Merrill  <jason@casey.cygnus.com>\n \n \t* filedoalloc.c, floatio.h, iovfprintf.c, iovfscanf.c: Remove"}, {"sha": "0b0fd6d88d3acba7d68031c8eee58c530ae690da", "filename": "libio/filebuf.cc", "status": "modified", "additions": 12, "deletions": 4, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dec0fa945c807ed495a3b74fbf98c6d30a19b4c8/libio%2Ffilebuf.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dec0fa945c807ed495a3b74fbf98c6d30a19b4c8/libio%2Ffilebuf.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libio%2Ffilebuf.cc?ref=dec0fa945c807ed495a3b74fbf98c6d30a19b4c8", "patch": "@@ -1,5 +1,5 @@\n /* This is part of libio/iostream, providing -*- C++ -*- input/output.\n-Copyright (C) 1993, 1995 Free Software Foundation\n+Copyright (C) 1993, 1995, 1999 Free Software Foundation\n \n This file is part of the GNU IO Library.  This library is free\n software; you can redistribute it and/or modify it under the\n@@ -112,15 +112,23 @@ filebuf* filebuf::open(const char *filename, ios::openmode mode, int prot)\n   if (mode & (int)ios::noreplace)\n     posix_mode |= O_EXCL;\n #if _G_HAVE_IO_FILE_OPEN\n-  return (filebuf*)_IO_file_open (this, filename, posix_mode, prot,\n-\t\t\t\t  read_write, 0);\n+  if (!_IO_file_open (this, filename, posix_mode, prot, \n+\t\t      read_write, 0))\n+    return NULL;\n+  if (mode & ios::ate) {\n+    if (pubseekoff(0, ios::end) == EOF) {\n+      _IO_un_link (this);\n+      return NULL;\n+    }\n+  }\n+  return this;\n #else\n   int fd = ::open(filename, posix_mode, prot);\n   if (fd < 0)\n     return NULL;\n   _fileno = fd;\n   xsetflags(read_write, _IO_NO_READS+_IO_NO_WRITES+_IO_IS_APPENDING);\n-  if (mode & (ios::ate|ios::app)) {\n+  if (mode & ios::ate) {\n     if (pubseekoff(0, ios::end) == EOF)\n       return NULL;\n   }"}]}