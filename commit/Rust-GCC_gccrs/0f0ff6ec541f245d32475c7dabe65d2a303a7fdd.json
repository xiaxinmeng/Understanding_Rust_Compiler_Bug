{"sha": "0f0ff6ec541f245d32475c7dabe65d2a303a7fdd", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MGYwZmY2ZWM1NDFmMjQ1ZDMyNDc1YzdkYWJlNjVkMmEzMDNhN2ZkZA==", "commit": {"author": {"name": "Tom Tromey", "email": "tromey@redhat.com", "date": "2003-01-23T17:40:42Z"}, "committer": {"name": "Tom Tromey", "email": "tromey@gcc.gnu.org", "date": "2003-01-23T17:40:42Z"}, "message": "* constants.c (set_constant_entry): Allocated cleared memory.\n\nFrom-SVN: r61661", "tree": {"sha": "776cef2837a148db4d5f6a975fa6091c4391523b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/776cef2837a148db4d5f6a975fa6091c4391523b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0f0ff6ec541f245d32475c7dabe65d2a303a7fdd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0f0ff6ec541f245d32475c7dabe65d2a303a7fdd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0f0ff6ec541f245d32475c7dabe65d2a303a7fdd", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0f0ff6ec541f245d32475c7dabe65d2a303a7fdd/comments", "author": null, "committer": null, "parents": [{"sha": "9a600d0c7f8c12236fd1e7fd060c0586c6211d9f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9a600d0c7f8c12236fd1e7fd060c0586c6211d9f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9a600d0c7f8c12236fd1e7fd060c0586c6211d9f"}], "stats": {"total": 15, "additions": 13, "deletions": 2}, "files": [{"sha": "092d5bdc0d6fb3e7ad7b363c29d545920f8183a9", "filename": "gcc/java/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0f0ff6ec541f245d32475c7dabe65d2a303a7fdd/gcc%2Fjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0f0ff6ec541f245d32475c7dabe65d2a303a7fdd/gcc%2Fjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2FChangeLog?ref=0f0ff6ec541f245d32475c7dabe65d2a303a7fdd", "patch": "@@ -1,3 +1,7 @@\n+2003-01-23  Tom Tromey  <tromey@redhat.com>\n+\n+\t* constants.c (set_constant_entry): Allocated cleared memory.\n+\n 2003-01-22  Tom Tromey  <tromey@redhat.com>\n \n \t* java-tree.h: Don't use PARAMS."}, {"sha": "1a56df0646149000ee236bc6243e4cdb2066532e", "filename": "gcc/java/constants.c", "status": "modified", "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0f0ff6ec541f245d32475c7dabe65d2a303a7fdd/gcc%2Fjava%2Fconstants.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0f0ff6ec541f245d32475c7dabe65d2a303a7fdd/gcc%2Fjava%2Fconstants.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2Fconstants.c?ref=0f0ff6ec541f245d32475c7dabe65d2a303a7fdd", "patch": "@@ -46,19 +46,26 @@ set_constant_entry (CPool *cpool, int index, int tag, jword value)\n   if (cpool->data == NULL)\n     {\n       cpool->capacity = 100;\n-      cpool->tags = ggc_alloc (sizeof(uint8) * cpool->capacity);\n-      cpool->data = ggc_alloc (sizeof(union cpool_entry) * cpool->capacity);\n+      cpool->tags = ggc_alloc_cleared (sizeof(uint8) * cpool->capacity);\n+      cpool->data = ggc_alloc_cleared (sizeof(union cpool_entry)\n+\t\t\t\t       * cpool->capacity);\n       cpool->count = 1;\n     }\n   if (index >= cpool->capacity)\n     {\n+      int old_cap = cpool->capacity;\n       cpool->capacity *= 2;\n       if (index >= cpool->capacity)\n \tcpool->capacity = index + 10;\n       cpool->tags = ggc_realloc (cpool->tags, \n \t\t\t\t sizeof(uint8) * cpool->capacity);\n       cpool->data = ggc_realloc (cpool->data,\n \t\t\t\t sizeof(union cpool_entry) * cpool->capacity);\n+\n+      /* Make sure GC never sees uninitialized tag values.  */\n+      memset (cpool->tags + old_cap, 0, cpool->capacity - old_cap);\n+      memset (cpool->data + old_cap, 0,\n+\t      (cpool->capacity - old_cap) * sizeof (union cpool_entry));\n     }\n   if (index >= cpool->count)\n     cpool->count = index + 1;"}]}