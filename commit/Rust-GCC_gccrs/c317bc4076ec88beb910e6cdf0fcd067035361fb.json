{"sha": "c317bc4076ec88beb910e6cdf0fcd067035361fb", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzMxN2JjNDA3NmVjODhiZWI5MTBlNmNkZjBmY2QwNjcwMzUzNjFmYg==", "commit": {"author": {"name": "Daniel Franke", "email": "franke.daniel@gmail.com", "date": "2007-07-29T14:17:59Z"}, "committer": {"name": "Daniel Franke", "email": "dfranke@gcc.gnu.org", "date": "2007-07-29T14:17:59Z"}, "message": "re PR fortran/32906 (Error: Parameter array ... cannot be automatic or assumed shape)\n\ngcc/fortran:\n2007-07-29  Daniel Franke  <franke.daniel@gmail.com>\n\n\tPR fortran/32906\n\t* resolve.c (resolve_fl_parameter): Check for constant shape arrays,\n\tadjusted error message.\n\ngcc/testsuite:\n2007-07-29  Daniel Franke  <franke.daniel@gmail.com>\n\n\tPR fortran/32906\n\t* gfortran.dg/shape_1.f90: Adjust error message.\n\t* gfortran.dg/parameter_array_ref_1.f90: New test.\n\nFrom-SVN: r127043", "tree": {"sha": "ced8852cf592f30ac5230edbb390811f4a44377d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ced8852cf592f30ac5230edbb390811f4a44377d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c317bc4076ec88beb910e6cdf0fcd067035361fb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c317bc4076ec88beb910e6cdf0fcd067035361fb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c317bc4076ec88beb910e6cdf0fcd067035361fb", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c317bc4076ec88beb910e6cdf0fcd067035361fb/comments", "author": {"login": "dfranke76", "id": 15729164, "node_id": "MDQ6VXNlcjE1NzI5MTY0", "avatar_url": "https://avatars.githubusercontent.com/u/15729164?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dfranke76", "html_url": "https://github.com/dfranke76", "followers_url": "https://api.github.com/users/dfranke76/followers", "following_url": "https://api.github.com/users/dfranke76/following{/other_user}", "gists_url": "https://api.github.com/users/dfranke76/gists{/gist_id}", "starred_url": "https://api.github.com/users/dfranke76/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dfranke76/subscriptions", "organizations_url": "https://api.github.com/users/dfranke76/orgs", "repos_url": "https://api.github.com/users/dfranke76/repos", "events_url": "https://api.github.com/users/dfranke76/events{/privacy}", "received_events_url": "https://api.github.com/users/dfranke76/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "b1e759547fa63a16c51093ded69cd79570946c7b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b1e759547fa63a16c51093ded69cd79570946c7b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b1e759547fa63a16c51093ded69cd79570946c7b"}], "stats": {"total": 35, "additions": 31, "deletions": 4}, "files": [{"sha": "671f99ead372d71c719fbe350d0050dfd2641dbf", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c317bc4076ec88beb910e6cdf0fcd067035361fb/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c317bc4076ec88beb910e6cdf0fcd067035361fb/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=c317bc4076ec88beb910e6cdf0fcd067035361fb", "patch": "@@ -1,3 +1,9 @@\n+2007-07-29  Daniel Franke  <franke.daniel@gmail.com>\n+\n+\tPR fortran/32906\n+\t* resolve.c (resolve_fl_parameter): Check for constant shape arrays,\n+\tadjusted error message.\n+\n 2007-07-29  Daniel Franke  <franke.daniel@gmail.com>\n \n \t* invoke.texi: Removed -w from option summary."}, {"sha": "e2ebc992d74ff7748d9dafbc29ba81df51860113", "filename": "gcc/fortran/resolve.c", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c317bc4076ec88beb910e6cdf0fcd067035361fb/gcc%2Ffortran%2Fresolve.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c317bc4076ec88beb910e6cdf0fcd067035361fb/gcc%2Ffortran%2Fresolve.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fresolve.c?ref=c317bc4076ec88beb910e6cdf0fcd067035361fb", "patch": "@@ -7137,10 +7137,12 @@ static try\n resolve_fl_parameter (gfc_symbol *sym)\n {\n   /* A parameter array's shape needs to be constant.  */\n-  if (sym->as != NULL && !gfc_is_compile_time_shape (sym->as))\n+  if (sym->as != NULL \n+      && (sym->as->type == AS_DEFERRED\n+          || is_non_constant_shape_array (sym)))\n     {\n       gfc_error (\"Parameter array '%s' at %L cannot be automatic \"\n-\t\t \"or assumed shape\", sym->name, &sym->declared_at);\n+\t\t \"or of deferred shape\", sym->name, &sym->declared_at);\n       return FAILURE;\n     }\n "}, {"sha": "388c72127ec2b69ccbfdbb3916ec43e8a5a283f8", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c317bc4076ec88beb910e6cdf0fcd067035361fb/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c317bc4076ec88beb910e6cdf0fcd067035361fb/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=c317bc4076ec88beb910e6cdf0fcd067035361fb", "patch": "@@ -1,3 +1,9 @@\n+2007-07-29  Daniel Franke  <franke.daniel@gmail.com>\n+\n+\tPR fortran/32906\n+\t* gfortran.dg/shape_1.f90: Adjust error message.\n+\t* gfortran.dg/parameter_array_ref_1.f90: New test.\n+\n 2007-07-29  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n \n \tPR fortran/31609"}, {"sha": "c22f343778d8b0c3a560f28e7de3b0dd41a41e1d", "filename": "gcc/testsuite/gfortran.dg/parameter_array_ref_1.f90", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c317bc4076ec88beb910e6cdf0fcd067035361fb/gcc%2Ftestsuite%2Fgfortran.dg%2Fparameter_array_ref_1.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c317bc4076ec88beb910e6cdf0fcd067035361fb/gcc%2Ftestsuite%2Fgfortran.dg%2Fparameter_array_ref_1.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fparameter_array_ref_1.f90?ref=c317bc4076ec88beb910e6cdf0fcd067035361fb", "patch": "@@ -0,0 +1,13 @@\n+! { dg-do compile }\n+!\n+! PR fortran/32906 - Parameter array ... cannot be automatic or assumed shape\n+!\n+! Testcase contributed by Florian Ladstaedter <flad AT gmx DOT at>\n+!\n+program test_program\n+  integer, parameter :: len = 1\n+  integer, parameter :: arr(max(len,1)) = (/1/)\n+\n+  character(len=*), dimension (1), parameter             :: specStr = (/'string'/)\n+  double precision, dimension (size(specStr)), parameter :: specNum = (/99.0d0/)\n+end"}, {"sha": "9292adb2e71db2deaf945412a197b1d8687e14d0", "filename": "gcc/testsuite/gfortran.dg/shape_1.f90", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c317bc4076ec88beb910e6cdf0fcd067035361fb/gcc%2Ftestsuite%2Fgfortran.dg%2Fshape_1.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c317bc4076ec88beb910e6cdf0fcd067035361fb/gcc%2Ftestsuite%2Fgfortran.dg%2Fshape_1.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fshape_1.f90?ref=c317bc4076ec88beb910e6cdf0fcd067035361fb", "patch": "@@ -1,6 +1,6 @@\n ! { dg-do compile }\n ! PR 13201 we used to not give an error in those cases\n subroutine foo(n) \n-  integer, parameter :: a(n) = 1 ! { dg-error \"cannot be automatic\" \"automatic shape\" }\n-  integer, parameter :: z(:) = (/ 1,2,3 /) ! { dg-error \"cannot be automatic\" \"assumed shape\" }\n+  integer, parameter :: a(n) = 1           ! { dg-error \"cannot be automatic\" \"automatic shape\" }\n+  integer, parameter :: z(:) = (/ 1,2,3 /) ! { dg-error \"cannot be automatic\" \"deferred shape\" }\n end subroutine"}]}