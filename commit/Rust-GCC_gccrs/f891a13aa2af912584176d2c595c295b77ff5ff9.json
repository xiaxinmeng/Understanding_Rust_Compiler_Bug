{"sha": "f891a13aa2af912584176d2c595c295b77ff5ff9", "node_id": "C_kwDOANBUbNoAKGY4OTFhMTNhYTJhZjkxMjU4NDE3NmQyYzU5NWMyOTViNzdmZjVmZjk", "commit": {"author": {"name": "Philip Herron", "email": "philip.herron@embecosm.com", "date": "2022-08-11T11:34:13Z"}, "committer": {"name": "Philip Herron", "email": "philip.herron@embecosm.com", "date": "2022-08-11T11:34:13Z"}, "message": "Ensure we set TREE_SIDE_EFFECTS on call expressions\n\nWhen we compiling call expressions the GCC helper has quite a simple\nimplementation to determine if there are SIDE_EFFECTS we have more\ninformation in the front-end to determine this. This adds a check that\nthe call expression is deemed to have no side effects ensure we check this\nagainst the fndecl used.\n\nFixes #1460", "tree": {"sha": "90a38aef7e87f385a58c6cf35c9d9e7788efd4e8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/90a38aef7e87f385a58c6cf35c9d9e7788efd4e8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f891a13aa2af912584176d2c595c295b77ff5ff9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f891a13aa2af912584176d2c595c295b77ff5ff9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f891a13aa2af912584176d2c595c295b77ff5ff9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f891a13aa2af912584176d2c595c295b77ff5ff9/comments", "author": {"login": "philberty", "id": 84585, "node_id": "MDQ6VXNlcjg0NTg1", "avatar_url": "https://avatars.githubusercontent.com/u/84585?v=4", "gravatar_id": "", "url": "https://api.github.com/users/philberty", "html_url": "https://github.com/philberty", "followers_url": "https://api.github.com/users/philberty/followers", "following_url": "https://api.github.com/users/philberty/following{/other_user}", "gists_url": "https://api.github.com/users/philberty/gists{/gist_id}", "starred_url": "https://api.github.com/users/philberty/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/philberty/subscriptions", "organizations_url": "https://api.github.com/users/philberty/orgs", "repos_url": "https://api.github.com/users/philberty/repos", "events_url": "https://api.github.com/users/philberty/events{/privacy}", "received_events_url": "https://api.github.com/users/philberty/received_events", "type": "User", "site_admin": false}, "committer": {"login": "philberty", "id": 84585, "node_id": "MDQ6VXNlcjg0NTg1", "avatar_url": "https://avatars.githubusercontent.com/u/84585?v=4", "gravatar_id": "", "url": "https://api.github.com/users/philberty", "html_url": "https://github.com/philberty", "followers_url": "https://api.github.com/users/philberty/followers", "following_url": "https://api.github.com/users/philberty/following{/other_user}", "gists_url": "https://api.github.com/users/philberty/gists{/gist_id}", "starred_url": "https://api.github.com/users/philberty/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/philberty/subscriptions", "organizations_url": "https://api.github.com/users/philberty/orgs", "repos_url": "https://api.github.com/users/philberty/repos", "events_url": "https://api.github.com/users/philberty/events{/privacy}", "received_events_url": "https://api.github.com/users/philberty/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "eca2ac2c23e0c8b438fd696d4f85e35c9210d8dd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/eca2ac2c23e0c8b438fd696d4f85e35c9210d8dd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/eca2ac2c23e0c8b438fd696d4f85e35c9210d8dd"}], "stats": {"total": 3, "additions": 3, "deletions": 0}, "files": [{"sha": "f396aa867b92e5787c82d98feb3c20ff4a7fe703", "filename": "gcc/rust/rust-gcc.cc", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f891a13aa2af912584176d2c595c295b77ff5ff9/gcc%2Frust%2Frust-gcc.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f891a13aa2af912584176d2c595c295b77ff5ff9/gcc%2Frust%2Frust-gcc.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Frust%2Frust-gcc.cc?ref=f891a13aa2af912584176d2c595c295b77ff5ff9", "patch": "@@ -1848,6 +1848,9 @@ Gcc_backend::call_expression (tree fn, const std::vector<tree> &fn_args,\n       ret = build1_loc (location.gcc_location (), NOP_EXPR, rettype, ret);\n     }\n \n+  if (!TREE_SIDE_EFFECTS (ret))\n+    TREE_SIDE_EFFECTS (ret) = TREE_SIDE_EFFECTS (fndecl);\n+\n   delete[] args;\n   return ret;\n }"}]}