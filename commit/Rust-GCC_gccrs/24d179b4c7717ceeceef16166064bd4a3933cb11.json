{"sha": "24d179b4c7717ceeceef16166064bd4a3933cb11", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjRkMTc5YjRjNzcxN2NlZWNlZWYxNjE2NjA2NGJkNGEzOTMzY2IxMQ==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2009-11-03T22:36:39Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2009-11-03T22:36:39Z"}, "message": "re PR rtl-optimization/41917 (Strange athrithmetic result with -O3)\n\n\tPR rtl-optimization/41917\n\t* rtlanal.c (num_sign_bit_copies1) <case UMOD>: If sign bit of second\n\toperand isn't known to be 0, return 1.\n\n\t* gcc.c-torture/execute/pr41917.c: New test.\n\nFrom-SVN: r153874", "tree": {"sha": "219b8371e4eb10703f1ef240e27ca85c4e4861a9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/219b8371e4eb10703f1ef240e27ca85c4e4861a9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/24d179b4c7717ceeceef16166064bd4a3933cb11", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/24d179b4c7717ceeceef16166064bd4a3933cb11", "html_url": "https://github.com/Rust-GCC/gccrs/commit/24d179b4c7717ceeceef16166064bd4a3933cb11", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/24d179b4c7717ceeceef16166064bd4a3933cb11/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "0b94d8b285da86f4e68c396a285a2846df3bdff7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0b94d8b285da86f4e68c396a285a2846df3bdff7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0b94d8b285da86f4e68c396a285a2846df3bdff7"}], "stats": {"total": 44, "additions": 42, "deletions": 2}, "files": [{"sha": "0da48a4f5aec2c9ddc1d10bf4762325c69a599dd", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/24d179b4c7717ceeceef16166064bd4a3933cb11/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/24d179b4c7717ceeceef16166064bd4a3933cb11/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=24d179b4c7717ceeceef16166064bd4a3933cb11", "patch": "@@ -1,3 +1,9 @@\n+2009-11-03  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR rtl-optimization/41917\n+\t* rtlanal.c (num_sign_bit_copies1) <case UMOD>: If sign bit of second\n+\toperand isn't known to be 0, return 1.\n+\n 2009-11-03  Richard Sandiford  <rdsandiford@googlemail.com>\n \n \t* config/mips/mips.md: Fix typos."}, {"sha": "120d37a830ca258d40ca2fc2dc0e3caada5a6a48", "filename": "gcc/rtlanal.c", "status": "modified", "additions": 10, "deletions": 2, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/24d179b4c7717ceeceef16166064bd4a3933cb11/gcc%2Frtlanal.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/24d179b4c7717ceeceef16166064bd4a3933cb11/gcc%2Frtlanal.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Frtlanal.c?ref=24d179b4c7717ceeceef16166064bd4a3933cb11", "patch": "@@ -4517,8 +4517,16 @@ num_sign_bit_copies1 (const_rtx x, enum machine_mode mode, const_rtx known_x,\n \t\t\t\t\t   known_x, known_mode, known_ret);\n \n     case UMOD:\n-      /* The result must be <= the second operand.  */\n-      return cached_num_sign_bit_copies (XEXP (x, 1), mode,\n+      /* The result must be <= the second operand.  If the second operand\n+\t has (or just might have) the high bit set, we know nothing about\n+\t the number of sign bit copies.  */\n+      if (bitwidth > HOST_BITS_PER_WIDE_INT)\n+\treturn 1;\n+      else if ((nonzero_bits (XEXP (x, 1), mode)\n+\t\t& ((HOST_WIDE_INT) 1 << (bitwidth - 1))) != 0)\n+\treturn 1;\n+      else\n+\treturn cached_num_sign_bit_copies (XEXP (x, 1), mode,\n \t\t\t\t\t   known_x, known_mode, known_ret);\n \n     case DIV:"}, {"sha": "220a4c36f267dc7c10050025d873a9d53aa84f54", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/24d179b4c7717ceeceef16166064bd4a3933cb11/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/24d179b4c7717ceeceef16166064bd4a3933cb11/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=24d179b4c7717ceeceef16166064bd4a3933cb11", "patch": "@@ -1,3 +1,8 @@\n+2009-11-03  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR rtl-optimization/41917\n+\t* gcc.c-torture/execute/pr41917.c: New test.\n+\n 2009-11-03  Uros Bizjak  <ubizjak@gmail.com>\n \n \t* gcc.target/i386/pr41900.c: Make test compile only.  Scan assembler"}, {"sha": "4a9ada921c4f326d26c05754717c535f5e082df2", "filename": "gcc/testsuite/gcc.c-torture/execute/pr41917.c", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/24d179b4c7717ceeceef16166064bd4a3933cb11/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fpr41917.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/24d179b4c7717ceeceef16166064bd4a3933cb11/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fpr41917.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fpr41917.c?ref=24d179b4c7717ceeceef16166064bd4a3933cb11", "patch": "@@ -0,0 +1,21 @@\n+/* PR rtl-optimization/41917 */\n+\n+extern void abort (void);\n+unsigned int a = 1;\n+\n+int\n+main (void)\n+{\n+  unsigned int b, c, d;\n+\n+  if (sizeof (int) != 4 || (int) 0xc7d24b5e > 0)\n+    return 0;\n+\n+  c = 0xc7d24b5e;\n+  d = a | -2;\n+  b = (d == 0) ? c : (c % d);\n+  if (b != c)\n+    abort ();\n+\n+  return 0;\n+}"}]}