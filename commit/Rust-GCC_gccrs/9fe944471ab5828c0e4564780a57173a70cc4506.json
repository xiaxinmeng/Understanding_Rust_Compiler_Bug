{"sha": "9fe944471ab5828c0e4564780a57173a70cc4506", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWZlOTQ0NDcxYWI1ODI4YzBlNDU2NDc4MGE1NzE3M2E3MGNjNDUwNg==", "commit": {"author": {"name": "Andrew Haley", "email": "aph@redhat.com", "date": "2007-01-25T19:51:33Z"}, "committer": {"name": "Tom Tromey", "email": "tromey@gcc.gnu.org", "date": "2007-01-25T19:51:33Z"}, "message": "configure, [...]: Rebuilt.\n\n2007-01-25  Andrew Haley  <aph@redhat.com>\n\n\t* configure, Makefile.in, include/config.h.in: Rebuilt.\n\t* Makefile.am (libgcj_la_LIBADD): Removed $(LIBMAGIC).\n\t* configure.ac: Don't check for libmagic.\n\t* java/net/natVMURLConnection.cc (p_magic_open, p_magic_load,\n\tp_magic_close, p_magic_buffer): New globals.\n\t(init): Look up 'magic' functions.\n\t(guessContentTypeFromBuffer): Updated.\n\nFrom-SVN: r121183", "tree": {"sha": "248bb6af58d66aec13f6a02b9c0cce7a33cb29a2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/248bb6af58d66aec13f6a02b9c0cce7a33cb29a2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9fe944471ab5828c0e4564780a57173a70cc4506", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9fe944471ab5828c0e4564780a57173a70cc4506", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9fe944471ab5828c0e4564780a57173a70cc4506", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9fe944471ab5828c0e4564780a57173a70cc4506/comments", "author": {"login": "theRealAph", "id": 254637, "node_id": "MDQ6VXNlcjI1NDYzNw==", "avatar_url": "https://avatars.githubusercontent.com/u/254637?v=4", "gravatar_id": "", "url": "https://api.github.com/users/theRealAph", "html_url": "https://github.com/theRealAph", "followers_url": "https://api.github.com/users/theRealAph/followers", "following_url": "https://api.github.com/users/theRealAph/following{/other_user}", "gists_url": "https://api.github.com/users/theRealAph/gists{/gist_id}", "starred_url": "https://api.github.com/users/theRealAph/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/theRealAph/subscriptions", "organizations_url": "https://api.github.com/users/theRealAph/orgs", "repos_url": "https://api.github.com/users/theRealAph/repos", "events_url": "https://api.github.com/users/theRealAph/events{/privacy}", "received_events_url": "https://api.github.com/users/theRealAph/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "a942e89f3acac05d7099f3ae12ee6a6fd531a051", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a942e89f3acac05d7099f3ae12ee6a6fd531a051", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a942e89f3acac05d7099f3ae12ee6a6fd531a051"}], "stats": {"total": 159, "additions": 49, "deletions": 110}, "files": [{"sha": "eb99fdf10601fb3114e44f043a21f4f90ced6467", "filename": "libjava/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9fe944471ab5828c0e4564780a57173a70cc4506/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9fe944471ab5828c0e4564780a57173a70cc4506/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=9fe944471ab5828c0e4564780a57173a70cc4506", "patch": "@@ -1,3 +1,13 @@\n+2007-01-25  Andrew Haley  <aph@redhat.com>\n+\n+\t* configure, Makefile.in, include/config.h.in: Rebuilt.\n+\t* Makefile.am (libgcj_la_LIBADD): Removed $(LIBMAGIC).\n+\t* configure.ac: Don't check for libmagic.\n+\t* java/net/natVMURLConnection.cc (p_magic_open, p_magic_load,\n+\tp_magic_close, p_magic_buffer): New globals.\n+\t(init): Look up 'magic' functions.\n+\t(guessContentTypeFromBuffer): Updated.\n+\n 2007-01-25  Keith Seitz  <keiths@redhat.com>\n \n \t* jvmti.cc (_Jv_JVMTI_GetMethodName): New function."}, {"sha": "ba89341286a71bc0fb7e812b8fe2162e56d63455", "filename": "libjava/Makefile.am", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9fe944471ab5828c0e4564780a57173a70cc4506/libjava%2FMakefile.am", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9fe944471ab5828c0e4564780a57173a70cc4506/libjava%2FMakefile.am", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FMakefile.am?ref=9fe944471ab5828c0e4564780a57173a70cc4506", "patch": "@@ -240,7 +240,7 @@ libgcj_la_LIBADD = \\\n \t$(all_packages_source_files:.list=.lo) \\\n \t$(bc_objects) \\\n \t$(propertyo_files) \\\n-\t$(LIBMAGIC) $(LIBFFI) $(ZLIBS) $(GCLIBS)\n+\t$(LIBFFI) $(ZLIBS) $(GCLIBS)\n libgcj_la_DEPENDENCIES = libgcj-$(gcc_version).jar \\\n \tjava/lang/Object.lo \\\n \tjava/lang/Class.lo \\"}, {"sha": "e0de8b9431460674ecb172cdf37e68304c9ff632", "filename": "libjava/Makefile.in", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9fe944471ab5828c0e4564780a57173a70cc4506/libjava%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9fe944471ab5828c0e4564780a57173a70cc4506/libjava%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FMakefile.in?ref=9fe944471ab5828c0e4564780a57173a70cc4506", "patch": "@@ -626,7 +626,6 @@ LIBGCJ_LD_SYMBOLIC_FUNCTIONS = @LIBGCJ_LD_SYMBOLIC_FUNCTIONS@\n LIBGCJ_SPEC = @LIBGCJ_SPEC@\n LIBICONV = @LIBICONV@\n LIBLTDL = @LIBLTDL@\n-LIBMAGIC = @LIBMAGIC@\n LIBOBJS = @LIBOBJS@\n LIBS = @LIBS@\n LIBTOOL = @LIBTOOL@\n@@ -887,7 +886,7 @@ libgcj_la_LIBADD = \\\n \t$(all_packages_source_files:.list=.lo) \\\n \t$(bc_objects) \\\n \t$(propertyo_files) \\\n-\t$(LIBMAGIC) $(LIBFFI) $(ZLIBS) $(GCLIBS)\n+\t$(LIBFFI) $(ZLIBS) $(GCLIBS)\n \n libgcj_la_DEPENDENCIES = libgcj-$(gcc_version).jar \\\n \tjava/lang/Object.lo \\"}, {"sha": "db6189075602eef65005724e4cec9c9c8e5b5c31", "filename": "libjava/configure", "status": "modified", "additions": 1, "deletions": 84, "changes": 85, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9fe944471ab5828c0e4564780a57173a70cc4506/libjava%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9fe944471ab5828c0e4564780a57173a70cc4506/libjava%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fconfigure?ref=9fe944471ab5828c0e4564780a57173a70cc4506", "patch": "@@ -310,7 +310,7 @@ ac_includes_default=\"\\\n # include <unistd.h>\n #endif\"\n \n-ac_subst_vars='SHELL PATH_SEPARATOR PACKAGE_NAME PACKAGE_TARNAME PACKAGE_VERSION PACKAGE_STRING PACKAGE_BUGREPORT exec_prefix prefix program_transform_name bindir sbindir libexecdir datadir sysconfdir sharedstatedir localstatedir libdir includedir oldincludedir infodir mandir build_alias host_alias target_alias DEFS ECHO_C ECHO_N ECHO_T LIBS build build_cpu build_vendor build_os build_libsubdir build_subdir host_subdir target_subdir multi_basedir host host_cpu host_vendor host_os target target_cpu target_vendor target_os target_noncanonical LN_S mkinstalldirs JAVA_MAINTAINER_MODE_TRUE JAVA_MAINTAINER_MODE_FALSE CC ac_ct_CC EXEEXT OBJEXT CXX ac_ct_CXX CFLAGS CXXFLAGS LDFLAGS INSTALL_PROGRAM INSTALL_SCRIPT INSTALL_DATA CYGPATH_W PACKAGE VERSION ACLOCAL AUTOCONF AUTOMAKE AUTOHEADER MAKEINFO install_sh STRIP ac_ct_STRIP INSTALL_STRIP_PROGRAM mkdir_p AWK SET_MAKE am__leading_dot AMTAR am__tar am__untar DEPDIR am__include am__quote AMDEP_TRUE AMDEP_FALSE AMDEPBACKSLASH CCDEPMODE am__fastdepCC_TRUE am__fastdepCC_FALSE CXXDEPMODE am__fastdepCXX_TRUE am__fastdepCXX_FALSE AS ac_ct_AS LD ac_ct_LD AR ac_ct_AR RANLIB ac_ct_RANLIB JAR ZIP UNZIP BASH_JAR_TRUE BASH_JAR_FALSE MAINTAINER_MODE_TRUE MAINTAINER_MODE_FALSE MAINT LIBGCJ_CFLAGS LIBGCJ_CXXFLAGS LIBGCJ_JAVAFLAGS LIBGCJ_LD_SYMBOLIC LIBGCJ_LD_SYMBOLIC_FUNCTIONS LIBGCJDEBUG TOOLKIT XLIB_AWT_TRUE XLIB_AWT_FALSE X_AWT_TRUE X_AWT_FALSE GCJ_FOR_ECJX GCJH host_exeext INCLTDL LIBLTDL DIRLTDL LIBTOOL CXXCPP CPPFLAGS GCJ GCJFLAGS GCJDEPMODE am__fastdepGCJ_TRUE am__fastdepGCJ_FALSE subdirs TESTSUBDIR_TRUE TESTSUBDIR_FALSE ECJ_BUILD_JAR ECJ_JAR BUILD_ECJ1_TRUE BUILD_ECJ1_FALSE INSTALL_ECJ_JAR_TRUE INSTALL_ECJ_JAR_FALSE JAVA_HOME_SET_TRUE JAVA_HOME_SET_FALSE JAVA_HOME INTERPRETER LIBFFI LIBFFIINCS PLATFORM CPP EGREP USING_WIN32_PLATFORM_TRUE USING_WIN32_PLATFORM_FALSE USING_POSIX_PLATFORM_TRUE USING_POSIX_PLATFORM_FALSE USING_DARWIN_CRT_TRUE USING_DARWIN_CRT_FALSE SYSTEMSPEC LIBGCJTESTSPEC ZLIBSPEC ZLIBTESTSPEC X_CFLAGS X_PRE_LIBS X_LIBS X_EXTRA_LIBS extra_ldflags_libjava GCLIBS GCINCS GCDEPS GCSPEC JC1GCSPEC GCTESTSPEC USING_BOEHMGC_TRUE USING_BOEHMGC_FALSE USING_NOGC_TRUE USING_NOGC_FALSE THREADLIBS THREADINCS THREADDEPS THREADSPEC THREADSTARTFILESPEC THREADLDFLAGS THREADCXXFLAGS USING_POSIX_THREADS_TRUE USING_POSIX_THREADS_FALSE USING_WIN32_THREADS_TRUE USING_WIN32_THREADS_FALSE USING_NO_THREADS_TRUE USING_NO_THREADS_FALSE USE_LIBGCJ_BC_TRUE USE_LIBGCJ_BC_FALSE LIBGCJ_SPEC HASH_SYNC_SPEC USING_GCC_TRUE USING_GCC_FALSE LIBICONV LTLIBICONV LIBMAGIC PKG_CONFIG GTK_CFLAGS GTK_LIBS GLIB_CFLAGS GLIB_LIBS LIBART_CFLAGS LIBART_LIBS CLASSPATH_SEPARATOR ac_ct_GCJ ZLIBS SYS_ZLIBS ZINCS DIVIDESPEC CHECKREFSPEC EXCEPTIONSPEC BACKTRACESPEC IEEESPEC NATIVE_TRUE NATIVE_FALSE ENABLE_SHARED_TRUE ENABLE_SHARED_FALSE NEEDS_DATA_START_TRUE NEEDS_DATA_START_FALSE GCC_UNWIND_INCLUDE toolexecdir toolexecmainlibdir toolexeclibdir dbexecdir GCJVERSION gxx_include_dir libstdcxx_incdir ALLOCA PERL SYSDEP_SOURCES LD_START_STATIC_SPEC LD_FINISH_STATIC_SPEC here LIBOBJS LTLIBOBJS'\n+ac_subst_vars='SHELL PATH_SEPARATOR PACKAGE_NAME PACKAGE_TARNAME PACKAGE_VERSION PACKAGE_STRING PACKAGE_BUGREPORT exec_prefix prefix program_transform_name bindir sbindir libexecdir datadir sysconfdir sharedstatedir localstatedir libdir includedir oldincludedir infodir mandir build_alias host_alias target_alias DEFS ECHO_C ECHO_N ECHO_T LIBS build build_cpu build_vendor build_os build_libsubdir build_subdir host_subdir target_subdir multi_basedir host host_cpu host_vendor host_os target target_cpu target_vendor target_os target_noncanonical LN_S mkinstalldirs JAVA_MAINTAINER_MODE_TRUE JAVA_MAINTAINER_MODE_FALSE CC ac_ct_CC EXEEXT OBJEXT CXX ac_ct_CXX CFLAGS CXXFLAGS LDFLAGS INSTALL_PROGRAM INSTALL_SCRIPT INSTALL_DATA CYGPATH_W PACKAGE VERSION ACLOCAL AUTOCONF AUTOMAKE AUTOHEADER MAKEINFO install_sh STRIP ac_ct_STRIP INSTALL_STRIP_PROGRAM mkdir_p AWK SET_MAKE am__leading_dot AMTAR am__tar am__untar DEPDIR am__include am__quote AMDEP_TRUE AMDEP_FALSE AMDEPBACKSLASH CCDEPMODE am__fastdepCC_TRUE am__fastdepCC_FALSE CXXDEPMODE am__fastdepCXX_TRUE am__fastdepCXX_FALSE AS ac_ct_AS LD ac_ct_LD AR ac_ct_AR RANLIB ac_ct_RANLIB JAR ZIP UNZIP BASH_JAR_TRUE BASH_JAR_FALSE MAINTAINER_MODE_TRUE MAINTAINER_MODE_FALSE MAINT LIBGCJ_CFLAGS LIBGCJ_CXXFLAGS LIBGCJ_JAVAFLAGS LIBGCJ_LD_SYMBOLIC LIBGCJ_LD_SYMBOLIC_FUNCTIONS LIBGCJDEBUG TOOLKIT XLIB_AWT_TRUE XLIB_AWT_FALSE X_AWT_TRUE X_AWT_FALSE GCJ_FOR_ECJX GCJH host_exeext INCLTDL LIBLTDL DIRLTDL LIBTOOL CXXCPP CPPFLAGS GCJ GCJFLAGS GCJDEPMODE am__fastdepGCJ_TRUE am__fastdepGCJ_FALSE subdirs TESTSUBDIR_TRUE TESTSUBDIR_FALSE ECJ_BUILD_JAR ECJ_JAR BUILD_ECJ1_TRUE BUILD_ECJ1_FALSE INSTALL_ECJ_JAR_TRUE INSTALL_ECJ_JAR_FALSE JAVA_HOME_SET_TRUE JAVA_HOME_SET_FALSE JAVA_HOME INTERPRETER LIBFFI LIBFFIINCS PLATFORM CPP EGREP USING_WIN32_PLATFORM_TRUE USING_WIN32_PLATFORM_FALSE USING_POSIX_PLATFORM_TRUE USING_POSIX_PLATFORM_FALSE USING_DARWIN_CRT_TRUE USING_DARWIN_CRT_FALSE SYSTEMSPEC LIBGCJTESTSPEC ZLIBSPEC ZLIBTESTSPEC X_CFLAGS X_PRE_LIBS X_LIBS X_EXTRA_LIBS extra_ldflags_libjava GCLIBS GCINCS GCDEPS GCSPEC JC1GCSPEC GCTESTSPEC USING_BOEHMGC_TRUE USING_BOEHMGC_FALSE USING_NOGC_TRUE USING_NOGC_FALSE THREADLIBS THREADINCS THREADDEPS THREADSPEC THREADSTARTFILESPEC THREADLDFLAGS THREADCXXFLAGS USING_POSIX_THREADS_TRUE USING_POSIX_THREADS_FALSE USING_WIN32_THREADS_TRUE USING_WIN32_THREADS_FALSE USING_NO_THREADS_TRUE USING_NO_THREADS_FALSE USE_LIBGCJ_BC_TRUE USE_LIBGCJ_BC_FALSE LIBGCJ_SPEC HASH_SYNC_SPEC USING_GCC_TRUE USING_GCC_FALSE LIBICONV LTLIBICONV PKG_CONFIG GTK_CFLAGS GTK_LIBS GLIB_CFLAGS GLIB_LIBS LIBART_CFLAGS LIBART_LIBS CLASSPATH_SEPARATOR ac_ct_GCJ ZLIBS SYS_ZLIBS ZINCS DIVIDESPEC CHECKREFSPEC EXCEPTIONSPEC BACKTRACESPEC IEEESPEC NATIVE_TRUE NATIVE_FALSE ENABLE_SHARED_TRUE ENABLE_SHARED_FALSE NEEDS_DATA_START_TRUE NEEDS_DATA_START_FALSE GCC_UNWIND_INCLUDE toolexecdir toolexecmainlibdir toolexeclibdir dbexecdir GCJVERSION gxx_include_dir libstdcxx_incdir ALLOCA PERL SYSDEP_SOURCES LD_START_STATIC_SPEC LD_FINISH_STATIC_SPEC here LIBOBJS LTLIBOBJS'\n ac_subst_files=''\n \n # Initialize some variables set by options.\n@@ -13919,88 +13919,6 @@ fi\n \n    fi\n \n-   LIBMAGIC=\n-   echo \"$as_me:$LINENO: checking for magic_open in -lmagic\" >&5\n-echo $ECHO_N \"checking for magic_open in -lmagic... $ECHO_C\" >&6\n-if test \"${ac_cv_lib_magic_magic_open+set}\" = set; then\n-  echo $ECHO_N \"(cached) $ECHO_C\" >&6\n-else\n-  ac_check_lib_save_LIBS=$LIBS\n-LIBS=\"-lmagic  $LIBS\"\n-if test x$gcc_no_link = xyes; then\n-  { { echo \"$as_me:$LINENO: error: Link tests are not allowed after GCC_NO_EXECUTABLES.\" >&5\n-echo \"$as_me: error: Link tests are not allowed after GCC_NO_EXECUTABLES.\" >&2;}\n-   { (exit 1); exit 1; }; }\n-fi\n-cat >conftest.$ac_ext <<_ACEOF\n-/* confdefs.h.  */\n-_ACEOF\n-cat confdefs.h >>conftest.$ac_ext\n-cat >>conftest.$ac_ext <<_ACEOF\n-/* end confdefs.h.  */\n-\n-/* Override any gcc2 internal prototype to avoid an error.  */\n-#ifdef __cplusplus\n-extern \"C\"\n-#endif\n-/* We use char because int might match the return type of a gcc2\n-   builtin and then its argument prototype would still apply.  */\n-char magic_open ();\n-int\n-main ()\n-{\n-magic_open ();\n-  ;\n-  return 0;\n-}\n-_ACEOF\n-rm -f conftest.$ac_objext conftest$ac_exeext\n-if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n-  (eval $ac_link) 2>conftest.er1\n-  ac_status=$?\n-  grep -v '^ *+' conftest.er1 >conftest.err\n-  rm -f conftest.er1\n-  cat conftest.err >&5\n-  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n-  (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\n-\t\t\t || test ! -s conftest.err'\n-  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n-  (eval $ac_try) 2>&5\n-  ac_status=$?\n-  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n-  (exit $ac_status); }; } &&\n-\t { ac_try='test -s conftest$ac_exeext'\n-  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n-  (eval $ac_try) 2>&5\n-  ac_status=$?\n-  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n-  (exit $ac_status); }; }; then\n-  ac_cv_lib_magic_magic_open=yes\n-else\n-  echo \"$as_me: failed program was:\" >&5\n-sed 's/^/| /' conftest.$ac_ext >&5\n-\n-ac_cv_lib_magic_magic_open=no\n-fi\n-rm -f conftest.err conftest.$ac_objext \\\n-      conftest$ac_exeext conftest.$ac_ext\n-LIBS=$ac_check_lib_save_LIBS\n-fi\n-echo \"$as_me:$LINENO: result: $ac_cv_lib_magic_magic_open\" >&5\n-echo \"${ECHO_T}$ac_cv_lib_magic_magic_open\" >&6\n-if test $ac_cv_lib_magic_magic_open = yes; then\n-\n-\n-cat >>confdefs.h <<\\_ACEOF\n-#define HAVE_MAGIC_OPEN 1\n-_ACEOF\n-\n-      LIBMAGIC=\"-lmagic\"\n-fi\n-\n-\n-\n    # Test for Gtk stuff, if asked for.\n    if test \"$use_gtk_awt\" = yes; then\n \n@@ -18119,7 +18037,6 @@ s,@USING_GCC_TRUE@,$USING_GCC_TRUE,;t t\n s,@USING_GCC_FALSE@,$USING_GCC_FALSE,;t t\n s,@LIBICONV@,$LIBICONV,;t t\n s,@LTLIBICONV@,$LTLIBICONV,;t t\n-s,@LIBMAGIC@,$LIBMAGIC,;t t\n s,@PKG_CONFIG@,$PKG_CONFIG,;t t\n s,@GTK_CFLAGS@,$GTK_CFLAGS,;t t\n s,@GTK_LIBS@,$GTK_LIBS,;t t"}, {"sha": "773814d1d3931d6ad5aaa02172efb633dca34fb4", "filename": "libjava/configure.ac", "status": "modified", "additions": 0, "deletions": 6, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9fe944471ab5828c0e4564780a57173a70cc4506/libjava%2Fconfigure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9fe944471ab5828c0e4564780a57173a70cc4506/libjava%2Fconfigure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fconfigure.ac?ref=9fe944471ab5828c0e4564780a57173a70cc4506", "patch": "@@ -1209,12 +1209,6 @@ else\n       AC_CHECK_LIB(z, deflate, ZLIBSPEC=-lz, ZLIBSPEC=)\n    fi\n \n-   LIBMAGIC=\n-   AC_CHECK_LIB(magic, magic_open, [\n-      AC_DEFINE([HAVE_MAGIC_OPEN], 1, [Define if you have magic_open().])\n-      LIBMAGIC=\"-lmagic\"])\n-   AC_SUBST(LIBMAGIC)\n-\n    # Test for Gtk stuff, if asked for.\n    if test \"$use_gtk_awt\" = yes; then\n       PKG_CHECK_MODULES(GTK, gtk+-2.0 >= 2.4)"}, {"sha": "617f023b6575816bd7577a8d116b71316e9122c8", "filename": "libjava/gcj/Makefile.in", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9fe944471ab5828c0e4564780a57173a70cc4506/libjava%2Fgcj%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9fe944471ab5828c0e4564780a57173a70cc4506/libjava%2Fgcj%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fgcj%2FMakefile.in?ref=9fe944471ab5828c0e4564780a57173a70cc4506", "patch": "@@ -172,7 +172,6 @@ LIBGCJ_LD_SYMBOLIC_FUNCTIONS = @LIBGCJ_LD_SYMBOLIC_FUNCTIONS@\n LIBGCJ_SPEC = @LIBGCJ_SPEC@\n LIBICONV = @LIBICONV@\n LIBLTDL = @LIBLTDL@\n-LIBMAGIC = @LIBMAGIC@\n LIBOBJS = @LIBOBJS@\n LIBS = @LIBS@\n LIBTOOL = @LIBTOOL@"}, {"sha": "50e054ac4234c22fac6b985c2e92251c20b805c9", "filename": "libjava/include/Makefile.in", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9fe944471ab5828c0e4564780a57173a70cc4506/libjava%2Finclude%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9fe944471ab5828c0e4564780a57173a70cc4506/libjava%2Finclude%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Finclude%2FMakefile.in?ref=9fe944471ab5828c0e4564780a57173a70cc4506", "patch": "@@ -171,7 +171,6 @@ LIBGCJ_LD_SYMBOLIC_FUNCTIONS = @LIBGCJ_LD_SYMBOLIC_FUNCTIONS@\n LIBGCJ_SPEC = @LIBGCJ_SPEC@\n LIBICONV = @LIBICONV@\n LIBLTDL = @LIBLTDL@\n-LIBMAGIC = @LIBMAGIC@\n LIBOBJS = @LIBOBJS@\n LIBS = @LIBS@\n LIBTOOL = @LIBTOOL@"}, {"sha": "6a5bc9696c6faf0d1e5ecfab824cfb08893dea69", "filename": "libjava/include/config.h.in", "status": "modified", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9fe944471ab5828c0e4564780a57173a70cc4506/libjava%2Finclude%2Fconfig.h.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9fe944471ab5828c0e4564780a57173a70cc4506/libjava%2Finclude%2Fconfig.h.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Finclude%2Fconfig.h.in?ref=9fe944471ab5828c0e4564780a57173a70cc4506", "patch": "@@ -187,9 +187,6 @@\n /* Define to 1 if you have the <magic.h> header file. */\n #undef HAVE_MAGIC_H\n \n-/* Define if you have magic_open(). */\n-#undef HAVE_MAGIC_OPEN\n-\n /* Define to 1 if you have the `memcpy' function. */\n #undef HAVE_MEMCPY\n "}, {"sha": "643f90a978ca4f4a371ac995028687f154874a91", "filename": "libjava/java/net/natVMURLConnection.cc", "status": "modified", "additions": 36, "deletions": 11, "changes": 47, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9fe944471ab5828c0e4564780a57173a70cc4506/libjava%2Fjava%2Fnet%2FnatVMURLConnection.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9fe944471ab5828c0e4564780a57173a70cc4506/libjava%2Fjava%2Fnet%2FnatVMURLConnection.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjava%2Fnet%2FnatVMURLConnection.cc?ref=9fe944471ab5828c0e4564780a57173a70cc4506", "patch": "@@ -1,4 +1,4 @@\n-/* Copyright (C) 2006  Free Software Foundation\n+/* Copyright (C) 2006, 2007  Free Software Foundation\n \n    This file is part of libgcj.\n \n@@ -11,46 +11,71 @@ details.  */\n #include <java/net/VMURLConnection.h>\n #include <gcj/cni.h>\n #include <java/lang/UnsupportedOperationException.h>\n+#include <stdio.h>\n \n-#if defined (HAVE_MAGIC_H) && defined (HAVE_MAGIC_OPEN)\n+#if defined (HAVE_MAGIC_H) && defined (USE_LTDL)\n \n #include <magic.h>\n+#include <ltdl.h>\n \n static magic_t cookie;\n \n-#endif /* HAVE_MAGIC_H && HAVE_MAGIC_OPEN */\n+static magic_t (*p_magic_open)(int flags);\n+static int (*p_magic_load)(magic_t cookie, const char *filename);\n+static void (*p_magic_close)(magic_t cookie);\n+static const char * (*p_magic_buffer) (magic_t cookie, const void *buffer,\n+\t\t\t\t       size_t length);\n+\n+#endif /* HAVE_MAGIC_H && defined (USE_LTDL) */\n \n void\n java::net::VMURLConnection::init ()\n {\n-#if defined (HAVE_MAGIC_H) && defined (HAVE_MAGIC_OPEN)\n-  cookie = magic_open (MAGIC_MIME);\n+#if defined (HAVE_MAGIC_H) && defined (USE_LTDL)\n+  lt_dlhandle handle = lt_dlopenext (\"libmagic.so\");\n+  if (!handle)\n+    return;\n+\n+  p_magic_open = (typeof (p_magic_open))lt_dlsym(handle, \"magic_open\");\n+  if (p_magic_open == NULL)\n+    return;\n+  p_magic_buffer = (typeof (p_magic_buffer))lt_dlsym(handle, \"magic_buffer\");\n+  if (p_magic_buffer == NULL)\n+    return;\n+  p_magic_close = (typeof (p_magic_close))lt_dlsym(handle, \"magic_close\");\n+  if (p_magic_close == NULL)\n+    return;\n+  p_magic_load = (typeof (p_magic_load))lt_dlsym(handle, \"magic_load\");\n+  if (p_magic_load == NULL)\n+    return;\n+\n+  cookie = p_magic_open (MAGIC_MIME);\n   if (cookie == (magic_t) NULL)\n     return;\n-  if (magic_load (cookie, NULL) == -1)\n+  if (p_magic_load (cookie, NULL) == -1)\n     {\n-      magic_close (cookie);\n+      p_magic_close (cookie);\n       cookie = (magic_t) NULL;\n     }\n-#endif /* HAVE_MAGIC_H && HAVE_MAGIC_OPEN */\n+#endif /* HAVE_MAGIC_H  && defined (USE_LTDL) */\n }\n \n ::java::lang::String *\n java::net::VMURLConnection::guessContentTypeFromBuffer (jbyteArray bytes,\n \t\t\t\t\t\t\tjint valid)\n {\n-#if defined (HAVE_MAGIC_H) && defined (HAVE_MAGIC_OPEN)\n+#if defined (HAVE_MAGIC_H) && defined (USE_LTDL)\n   const char *result;\n \n   if (cookie == (magic_t) NULL)\n     return NULL;\n \n-  result = magic_buffer (cookie, elements(bytes), valid);\n+  result = p_magic_buffer (cookie, elements(bytes), valid);\n \n   if (result == NULL)\n     return NULL;\n   return _Jv_NewStringUTF (result);\n #else\n   return NULL;\n-#endif /* HAVE_MAGIC_H && HAVE_MAGIC_OPEN */\n+#endif /* HAVE_MAGIC_H  && defined (USE_LTDL) */\n }"}, {"sha": "79a0476cb93331f222a49c6905a09dfe0138dde7", "filename": "libjava/testsuite/Makefile.in", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9fe944471ab5828c0e4564780a57173a70cc4506/libjava%2Ftestsuite%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9fe944471ab5828c0e4564780a57173a70cc4506/libjava%2Ftestsuite%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Ftestsuite%2FMakefile.in?ref=9fe944471ab5828c0e4564780a57173a70cc4506", "patch": "@@ -160,7 +160,6 @@ LIBGCJ_LD_SYMBOLIC_FUNCTIONS = @LIBGCJ_LD_SYMBOLIC_FUNCTIONS@\n LIBGCJ_SPEC = @LIBGCJ_SPEC@\n LIBICONV = @LIBICONV@\n LIBLTDL = @LIBLTDL@\n-LIBMAGIC = @LIBMAGIC@\n LIBOBJS = @LIBOBJS@\n LIBS = @LIBS@\n LIBTOOL = @LIBTOOL@"}]}