{"sha": "9c4cb8615fc71a117c00844fd608ae6788acfd92", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWM0Y2I4NjE1ZmM3MWExMTdjMDA4NDRmZDYwOGFlNjc4OGFjZmQ5Mg==", "commit": {"author": {"name": "Sam Tebbs", "email": "sam.tebbs@arm.com", "date": "2019-08-09T14:11:54Z"}, "committer": {"name": "Sam Tebbs", "email": "samtebbs@gcc.gnu.org", "date": "2019-08-09T14:11:54Z"}, "message": "[PATCH][GCC][AARCH64] Add effective-target check to b key execution tests\n\ngcc/testsuite\n2019-08-09  Sam Tebbs<sam.tebbs@arm.com>\n\n\t* lib/target-supports.exp\n\t(check_effective_target_arm_v8_4a_bkey_directive): New proc.\n\t* g++.target/aarch64/return_address_sign_b_exception.C,\n\treturn_address_sign_ab_exception.C: Add dg-require-effective-target\n\tchecks.\n\nFrom-SVN: r274236", "tree": {"sha": "f75cceaf4fac899843aadd92b29a32da7e4527ff", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f75cceaf4fac899843aadd92b29a32da7e4527ff"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9c4cb8615fc71a117c00844fd608ae6788acfd92", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9c4cb8615fc71a117c00844fd608ae6788acfd92", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9c4cb8615fc71a117c00844fd608ae6788acfd92", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9c4cb8615fc71a117c00844fd608ae6788acfd92/comments", "author": null, "committer": null, "parents": [{"sha": "33e8e0ee4cd185f5073546fed2199c6ec76933ca", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/33e8e0ee4cd185f5073546fed2199c6ec76933ca", "html_url": "https://github.com/Rust-GCC/gccrs/commit/33e8e0ee4cd185f5073546fed2199c6ec76933ca"}], "stats": {"total": 20, "additions": 20, "deletions": 0}, "files": [{"sha": "51d0a87730bb518b2a10a77aafe175c651d54d0f", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9c4cb8615fc71a117c00844fd608ae6788acfd92/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9c4cb8615fc71a117c00844fd608ae6788acfd92/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=9c4cb8615fc71a117c00844fd608ae6788acfd92", "patch": "@@ -1,3 +1,11 @@\n+2019-08-09  Sam Tebbs <sam.tebbs@arm.com>\n+\n+\t* lib/target-supports.exp\n+\t(check_effective_target_arm_v8_4a_bkey_directive): New proc.\n+\t* g++.target/aarch64/return_address_sign_b_exception.C,\n+\treturn_address_sign_ab_exception.C: Add dg-require-effective-target\n+\tchecks.\n+\n 2019-08-09  Richard Sandiford  <richard.sandiford@arm.com>\n \n \tPR middle-end/90313"}, {"sha": "ead11de7b15dd82571345c9cc079e0be3c567b48", "filename": "gcc/testsuite/g++.target/aarch64/return_address_sign_ab_exception.C", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9c4cb8615fc71a117c00844fd608ae6788acfd92/gcc%2Ftestsuite%2Fg%2B%2B.target%2Faarch64%2Freturn_address_sign_ab_exception.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9c4cb8615fc71a117c00844fd608ae6788acfd92/gcc%2Ftestsuite%2Fg%2B%2B.target%2Faarch64%2Freturn_address_sign_ab_exception.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.target%2Faarch64%2Freturn_address_sign_ab_exception.C?ref=9c4cb8615fc71a117c00844fd608ae6788acfd92", "patch": "@@ -1,5 +1,6 @@\n /* { dg-do run } */\n /* { dg-options \"--save-temps\" } */\n+/* { dg-require-effective-target arm_v8_3a_bkey_directive } */\n \n __attribute__((target(\"branch-protection=pac-ret+leaf\")))\n int foo_a () {"}, {"sha": "2f8273135503dbf49b9aa12ffad505ec2fe52b46", "filename": "gcc/testsuite/g++.target/aarch64/return_address_sign_b_exception.C", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9c4cb8615fc71a117c00844fd608ae6788acfd92/gcc%2Ftestsuite%2Fg%2B%2B.target%2Faarch64%2Freturn_address_sign_b_exception.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9c4cb8615fc71a117c00844fd608ae6788acfd92/gcc%2Ftestsuite%2Fg%2B%2B.target%2Faarch64%2Freturn_address_sign_b_exception.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.target%2Faarch64%2Freturn_address_sign_b_exception.C?ref=9c4cb8615fc71a117c00844fd608ae6788acfd92", "patch": "@@ -1,5 +1,6 @@\n /* { dg-do run } */\n /* { dg-options \"-mbranch-protection=pac-ret+leaf+b-key --save-temps\" } */\n+/* { dg-require-effective-target arm_v8_3a_bkey_directive } */\n \n int foo () {\n   throw 22;"}, {"sha": "3c50b8925025504a36c96b52a470a72bc0264edf", "filename": "gcc/testsuite/lib/target-supports.exp", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9c4cb8615fc71a117c00844fd608ae6788acfd92/gcc%2Ftestsuite%2Flib%2Ftarget-supports.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9c4cb8615fc71a117c00844fd608ae6788acfd92/gcc%2Ftestsuite%2Flib%2Ftarget-supports.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Flib%2Ftarget-supports.exp?ref=9c4cb8615fc71a117c00844fd608ae6788acfd92", "patch": "@@ -9463,6 +9463,16 @@ proc check_effective_target_arm_v8_3a_complex_neon_hw { } {\n     } [add_options_for_arm_v8_3a_complex_neon \"\"]]\n }\n \n+# Return 1 if the assembler supports assembling the Armv8.3 pointer authentication B key directive\n+proc check_effective_target_arm_v8_3a_bkey_directive { } {\n+\treturn [check_no_compiler_messages cet object {\n+\t\tint main(void) {\n+\t\t\tasm (\".cfi_b_key_frame\");\n+\t\t\treturn 0;\n+\t\t}\n+\t}]\n+}\n+\n # Returns 1 if the target is using glibc, 0 otherwise.\n \n proc check_effective_target_glibc { } {"}]}