{"sha": "0126020166c4f3bc6a262125ec51a99de8379c4b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDEyNjAyMDE2NmM0ZjNiYzZhMjYyMTI1ZWM1MWE5OWRlODM3OWM0Yg==", "commit": {"author": {"name": "Alexandre Oliva", "email": "oliva@dcc.unicamp.br", "date": "1998-10-11T11:12:06Z"}, "committer": {"name": "Alexandre Oliva", "email": "oliva@gcc.gnu.org", "date": "1998-10-11T11:12:06Z"}, "message": "instantiate4.C: New test: -frepo does not generate needed virtual table\n\n\t* g++.old-deja/g++.pt/instantiate4.C: New test: -frepo does not\n\tgenerate needed virtual table\n\t* lib/old-dejagnu.exp (old-dejagnu): support `Build then link:'\n\nFrom-SVN: r22984", "tree": {"sha": "887d39fc4b566446186b33095119f7ef7f02bed5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/887d39fc4b566446186b33095119f7ef7f02bed5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0126020166c4f3bc6a262125ec51a99de8379c4b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0126020166c4f3bc6a262125ec51a99de8379c4b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0126020166c4f3bc6a262125ec51a99de8379c4b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0126020166c4f3bc6a262125ec51a99de8379c4b/comments", "author": null, "committer": null, "parents": [{"sha": "7d384cc0b300cace24c008fec600219e4377923c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7d384cc0b300cace24c008fec600219e4377923c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7d384cc0b300cace24c008fec600219e4377923c"}], "stats": {"total": 52, "additions": 51, "deletions": 1}, "files": [{"sha": "f01ab0574c32015ec9a753835ad0b3d25a86ec4a", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0126020166c4f3bc6a262125ec51a99de8379c4b/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0126020166c4f3bc6a262125ec51a99de8379c4b/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=0126020166c4f3bc6a262125ec51a99de8379c4b", "patch": "@@ -1,3 +1,10 @@\n+1998-10-11  Alexandre Oliva  <oliva@dcc.unicamp.br>\n+\n+\t* g++.old-deja/g++.pt/instantiate4.C: New test: -frepo does not\n+\tgenerate needed virtual table\n+\n+\t* lib/old-dejagnu.exp (old-dejagnu): support `Build then link:'\n+\n 1998-10-10  Dariush Eslimi  <eslimi@loran.com>\n \n \t* g++.old-deja/g++.ext/typeof1.C: New test; typeof based on"}, {"sha": "6cf4118fdc3f3ce3e3e651b1b8c0f082db666e22", "filename": "gcc/testsuite/g++.old-deja/g++.pt/instantiate4.C", "status": "added", "additions": 29, "deletions": 0, "changes": 29, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0126020166c4f3bc6a262125ec51a99de8379c4b/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.pt%2Finstantiate4.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0126020166c4f3bc6a262125ec51a99de8379c4b/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.pt%2Finstantiate4.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.pt%2Finstantiate4.C?ref=0126020166c4f3bc6a262125ec51a99de8379c4b", "patch": "@@ -0,0 +1,29 @@\n+// Build then link:\n+\n+// Special g++ Options: -frepo -Werror\n+\n+// Submitted by Melissa O'Neill <oneill@cs.sfu.ca>\n+// the vtable of Foo<int> wouldn't be generated\n+\n+// excess errors test - XFAIL *-*-*\n+\n+template <typename A>\n+struct Foo {\n+   virtual void foo() {}\n+};\n+\n+template <typename A>\n+struct Bar {   \n+   void bar();\n+};\n+\n+template <typename A> \n+void Bar<A>::bar() {\n+   Foo<A> oof;\n+}\n+\n+int main () {\n+    Bar<int> rab;\n+    \n+    rab.bar();\n+}"}, {"sha": "95126492e4de5e321199fbec469080e5774b0c52", "filename": "gcc/testsuite/lib/old-dejagnu.exp", "status": "modified", "additions": 15, "deletions": 1, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0126020166c4f3bc6a262125ec51a99de8379c4b/gcc%2Ftestsuite%2Flib%2Fold-dejagnu.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0126020166c4f3bc6a262125ec51a99de8379c4b/gcc%2Ftestsuite%2Flib%2Fold-dejagnu.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Flib%2Fold-dejagnu.exp?ref=0126020166c4f3bc6a262125ec51a99de8379c4b", "patch": "@@ -196,7 +196,7 @@ proc old-dejagnu { compiler prog cflagsx default_cflags libs } {\n # is right.  If no such Special Options are found, $default_cflags is used.\n # FIXME: Can there be multiple lines of these?\n #\n-# Other keywords: \"Build don't link:\", \"Build don't run:\".\n+# Other keywords: \"Build don't link:\", \"Build don't run:\", \"Build then link:\".\n \n     set name \"[file tail [file dirname $prog]]/[file tail $prog]\"\n \n@@ -239,6 +239,15 @@ proc old-dejagnu { compiler prog cflagsx default_cflags libs } {\n \tverbose \"Will compile $prog to object\" 3\n     }\n \n+    set tmp [lindex [grep $prog \"Build then link:\"] 0]\n+    if ![string match \"\" $tmp] then {\n+\tset compile_type \"object\"\n+\tset runflag 2\n+\tset final_output \"$output\"\n+\tset output \"$tmpdir/[file tail [file rootname $prog]].o\"\n+\tverbose \"Will compile $prog to object, then link it\" 3\n+    }\t\n+\n     set tmp [lindex [grep $prog \"Build don.t run:\"] 0]\n     if ![string match \"\" $tmp] then {\n \tset runflag 0\n@@ -399,6 +408,11 @@ proc old-dejagnu { compiler prog cflagsx default_cflags libs } {\n     # we can't run a.out when the compilation fails.\n     remote_file build delete $output\n     set comp_output [${tool}_target_compile $prog $output $compile_type $cflags]\n+    if { $runflag == 2 && [file exists $output] } then {\n+\tset runflag 0\n+\tset comp_output [concat $comp_output [${tool}_target_compile $output $final_output \"executable\" $cflags]]\n+\tset output $final_output\n+    }\n \n     # Delete things like \"ld.so: warning\" messages.\n     set comp_output [prune_warnings $comp_output]"}]}