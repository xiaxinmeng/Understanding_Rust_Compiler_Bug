{"sha": "31392801794f057dab9df4b3f4cd7b516210c199", "node_id": "C_kwDOANBUbNoAKDMxMzkyODAxNzk0ZjA1N2RhYjlkZjRiM2Y0Y2Q3YjUxNjIxMGMxOTk", "commit": {"author": {"name": "Piotr Trojanek", "email": "trojanek@adacore.com", "date": "2022-08-23T13:59:32Z"}, "committer": {"name": "Marc Poulhi\u00e8s", "email": "poulhies@adacore.com", "date": "2022-11-04T13:47:30Z"}, "message": "ada: Cleanup code for unreferenced variables\n\nFurther cleanups related to warnings about unreferenced objects.\n\ngcc/ada/\n\n\t* sem_warn.adb (Check_References): Remove useless query for \"spec\"\n\tof a variable; refactor nested if-statements into a single\n\tcondition.", "tree": {"sha": "57cd4d9200b8468ddb67d46f0274aca8061a522f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/57cd4d9200b8468ddb67d46f0274aca8061a522f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/31392801794f057dab9df4b3f4cd7b516210c199", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/31392801794f057dab9df4b3f4cd7b516210c199", "html_url": "https://github.com/Rust-GCC/gccrs/commit/31392801794f057dab9df4b3f4cd7b516210c199", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/31392801794f057dab9df4b3f4cd7b516210c199/comments", "author": {"login": "ptroja", "id": 161602, "node_id": "MDQ6VXNlcjE2MTYwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/161602?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ptroja", "html_url": "https://github.com/ptroja", "followers_url": "https://api.github.com/users/ptroja/followers", "following_url": "https://api.github.com/users/ptroja/following{/other_user}", "gists_url": "https://api.github.com/users/ptroja/gists{/gist_id}", "starred_url": "https://api.github.com/users/ptroja/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ptroja/subscriptions", "organizations_url": "https://api.github.com/users/ptroja/orgs", "repos_url": "https://api.github.com/users/ptroja/repos", "events_url": "https://api.github.com/users/ptroja/events{/privacy}", "received_events_url": "https://api.github.com/users/ptroja/received_events", "type": "User", "site_admin": false}, "committer": {"login": "dkm", "id": 87603, "node_id": "MDQ6VXNlcjg3NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/87603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dkm", "html_url": "https://github.com/dkm", "followers_url": "https://api.github.com/users/dkm/followers", "following_url": "https://api.github.com/users/dkm/following{/other_user}", "gists_url": "https://api.github.com/users/dkm/gists{/gist_id}", "starred_url": "https://api.github.com/users/dkm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dkm/subscriptions", "organizations_url": "https://api.github.com/users/dkm/orgs", "repos_url": "https://api.github.com/users/dkm/repos", "events_url": "https://api.github.com/users/dkm/events{/privacy}", "received_events_url": "https://api.github.com/users/dkm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "72baa4e2b7f8dfdb2c49950e12a397ef00d3bc16", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/72baa4e2b7f8dfdb2c49950e12a397ef00d3bc16", "html_url": "https://github.com/Rust-GCC/gccrs/commit/72baa4e2b7f8dfdb2c49950e12a397ef00d3bc16"}], "stats": {"total": 29, "additions": 10, "deletions": 19}, "files": [{"sha": "a7f220bfbc78ca09831b8b23333811992556095e", "filename": "gcc/ada/sem_warn.adb", "status": "modified", "additions": 10, "deletions": 19, "changes": 29, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/31392801794f057dab9df4b3f4cd7b516210c199/gcc%2Fada%2Fsem_warn.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/31392801794f057dab9df4b3f4cd7b516210c199/gcc%2Fada%2Fsem_warn.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_warn.adb?ref=31392801794f057dab9df4b3f4cd7b516210c199", "patch": "@@ -1221,7 +1221,7 @@ package body Sem_Warn is\n                elsif Warn_On_Constant\n                  and then Ekind (E1) = E_Variable\n                  and then Has_Initial_Value (E1)\n-                 and then Never_Set_In_Source_Check_Spec (E1)\n+                 and then Never_Set_In_Source (E1)\n                  and then not Generic_Package_Spec_Entity (E1)\n                then\n                   --  A special case, if this variable is volatile and not\n@@ -1248,24 +1248,15 @@ package body Sem_Warn is\n                   --  Here we give the warning if referenced and no pragma\n                   --  Unreferenced or Unmodified is present.\n \n-                  else\n-                     --  Variable case\n-\n-                     if Ekind (E1) = E_Variable then\n-                        if Referenced_Check_Spec (E1)\n-                          and then not Has_Pragma_Unreferenced_Check_Spec (E1)\n-                          and then not Has_Pragma_Unmodified_Check_Spec (E1)\n-                        then\n-                           if not Warnings_Off_E1\n-                             and then not Has_Junk_Name (E1)\n-                           then\n-                              Error_Msg_N -- CODEFIX\n-                                (\"?k?& is not modified, \"\n-                                 & \"could be declared constant!\",\n-                                 E1);\n-                           end if;\n-                        end if;\n-                     end if;\n+                  elsif Referenced (E1)\n+                    and then not Has_Unreferenced (E1)\n+                    and then not Has_Unmodified (E1)\n+                    and then not Warnings_Off_E1\n+                    and then not Has_Junk_Name (E1)\n+                  then\n+                     Error_Msg_N -- CODEFIX\n+                       (\"?k?& is not modified, could be declared constant!\",\n+                        E1);\n                   end if;\n \n                --  Other cases of a variable or parameter never set in source"}]}