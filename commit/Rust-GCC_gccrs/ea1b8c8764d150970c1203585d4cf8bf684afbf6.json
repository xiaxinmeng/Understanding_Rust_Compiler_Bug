{"sha": "ea1b8c8764d150970c1203585d4cf8bf684afbf6", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWExYjhjODc2NGQxNTA5NzBjMTIwMzU4NWQ0Y2Y4YmY2ODRhZmJmNg==", "commit": {"author": {"name": "Jim Meyering", "email": "meyering@redhat.com", "date": "2008-03-10T22:08:34Z"}, "committer": {"name": "Tom Tromey", "email": "tromey@gcc.gnu.org", "date": "2008-03-10T22:08:34Z"}, "message": "Don't leak upon failed realloc.\n\nlibjava\n2008-03-10  Jim Meyering  <meyering@redhat.com>\n        Don't leak upon failed realloc.\n        * gnu/classpath/natSystemProperties.cc\n        (SystemProperties::insertSystemProperties):\nlibjava/classpath\n2008-03-10  Jim Meyering  <meyering@redhat.com>\n        Don't leak upon failed realloc.\n        * native/jni/classpath/jcl.c (JCL_realloc): Upon failed realloc,\n        free the original buffer before throwing the exception.\n\nFrom-SVN: r133094", "tree": {"sha": "760625d856048373d82ecd71dfe46ad4f26ff853", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/760625d856048373d82ecd71dfe46ad4f26ff853"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ea1b8c8764d150970c1203585d4cf8bf684afbf6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ea1b8c8764d150970c1203585d4cf8bf684afbf6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ea1b8c8764d150970c1203585d4cf8bf684afbf6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ea1b8c8764d150970c1203585d4cf8bf684afbf6/comments", "author": null, "committer": null, "parents": [{"sha": "dd6d52363003ef0a2e7c2293bb6d0c5f1f829b6a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dd6d52363003ef0a2e7c2293bb6d0c5f1f829b6a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dd6d52363003ef0a2e7c2293bb6d0c5f1f829b6a"}], "stats": {"total": 19, "additions": 18, "deletions": 1}, "files": [{"sha": "84ea6c0b3be285bac5054a7dc9b4a948fb1afbf6", "filename": "libjava/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ea1b8c8764d150970c1203585d4cf8bf684afbf6/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ea1b8c8764d150970c1203585d4cf8bf684afbf6/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=ea1b8c8764d150970c1203585d4cf8bf684afbf6", "patch": "@@ -1,3 +1,9 @@\n+2008-03-10  Jim Meyering  <meyering@redhat.com>\n+\n+\tDon't leak upon failed realloc.\n+\t* gnu/classpath/natSystemProperties.cc\n+\t(SystemProperties::insertSystemProperties):\n+\n 2008-03-06  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>\n \n \t* HACKING: Fix grep patterns."}, {"sha": "c3d8f6395b6051ef69fbae335a2cb3adfb2fdb27", "filename": "libjava/classpath/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ea1b8c8764d150970c1203585d4cf8bf684afbf6/libjava%2Fclasspath%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ea1b8c8764d150970c1203585d4cf8bf684afbf6/libjava%2Fclasspath%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fclasspath%2FChangeLog?ref=ea1b8c8764d150970c1203585d4cf8bf684afbf6", "patch": "@@ -1,3 +1,9 @@\n+2008-03-10  Jim Meyering  <meyering@redhat.com>\n+\n+\tDon't leak upon failed realloc.\n+\t* native/jni/classpath/jcl.c (JCL_realloc): Upon failed realloc,\n+\tfree the original buffer before throwing the exception.\n+\n 2008-03-09  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>\n \n \t* doc/cp-hacking.texinfo: Fix spacing after periods."}, {"sha": "0180ab9f0f58e756fc1dd35172d24fce2a72b172", "filename": "libjava/classpath/native/jni/classpath/jcl.c", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ea1b8c8764d150970c1203585d4cf8bf684afbf6/libjava%2Fclasspath%2Fnative%2Fjni%2Fclasspath%2Fjcl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ea1b8c8764d150970c1203585d4cf8bf684afbf6/libjava%2Fclasspath%2Fnative%2Fjni%2Fclasspath%2Fjcl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fclasspath%2Fnative%2Fjni%2Fclasspath%2Fjcl.c?ref=ea1b8c8764d150970c1203585d4cf8bf684afbf6", "patch": "@@ -1,5 +1,5 @@\n /* jcl.c\n-   Copyright (C) 1998, 2005, 2006 Free Software Foundation, Inc.\n+   Copyright (C) 1998, 2005, 2006, 2008 Free Software Foundation, Inc.\n \n This file is part of GNU Classpath.\n \n@@ -152,9 +152,11 @@ JCL_malloc (JNIEnv * env, size_t size)\n JNIEXPORT void *JNICALL\n JCL_realloc (JNIEnv * env, void *ptr, size_t size)\n {\n+  void *orig_ptr = ptr;\n   ptr = realloc (ptr, size);\n   if (ptr == 0)\n     {\n+      free (orig_ptr);\n       JCL_ThrowException (env, \"java/lang/OutOfMemoryError\",\n \t\t\t  \"malloc() failed.\");\n       return NULL;"}, {"sha": "e259304b165c2393638e5bd556acc1a86aae6344", "filename": "libjava/gnu/classpath/natSystemProperties.cc", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ea1b8c8764d150970c1203585d4cf8bf684afbf6/libjava%2Fgnu%2Fclasspath%2FnatSystemProperties.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ea1b8c8764d150970c1203585d4cf8bf684afbf6/libjava%2Fgnu%2Fclasspath%2FnatSystemProperties.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fgnu%2Fclasspath%2FnatSystemProperties.cc?ref=ea1b8c8764d150970c1203585d4cf8bf684afbf6", "patch": "@@ -270,7 +270,10 @@ gnu::classpath::SystemProperties::insertSystemProperties (::java::util::Properti\n       if (errno != ERANGE)\n \tbreak;\n       buflen = 2 * buflen;\n+      char *orig_buf = buffer;\n       buffer = (char *) realloc (buffer, buflen);\n+      if (buffer == NULL)\n+\tfree (orig_buf);\n     }\n   if (buffer != NULL)\n     free (buffer);"}]}