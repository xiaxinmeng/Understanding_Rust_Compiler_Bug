{"sha": "ff3467a9ebbd98aadd091a60f622cebf8f4b2870", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZmYzNDY3YTllYmJkOThhYWRkMDkxYTYwZjYyMmNlYmY4ZjRiMjg3MA==", "commit": {"author": {"name": "Jim Wilson", "email": "wilson@cygnus.com", "date": "1997-11-05T02:08:25Z"}, "committer": {"name": "Jim Wilson", "email": "wilson@gcc.gnu.org", "date": "1997-11-05T02:08:25Z"}, "message": "Fix alpha-linux GNU libc build failures.\n\n\t* combine.c (try_combine): When setting elim_i2, check whether newi2pat\n\tsets i2dest.  When calling distribute_notes for i3dest_killed, pass\n\telim_i2 and elim_i1.  When setting elim_i1, check if newi2pat\n\tsets i1dest.\n\nFrom-SVN: r16334", "tree": {"sha": "33834564081d4c750f91a7dd005a5a79aea1608e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/33834564081d4c750f91a7dd005a5a79aea1608e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ff3467a9ebbd98aadd091a60f622cebf8f4b2870", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ff3467a9ebbd98aadd091a60f622cebf8f4b2870", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ff3467a9ebbd98aadd091a60f622cebf8f4b2870", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ff3467a9ebbd98aadd091a60f622cebf8f4b2870/comments", "author": null, "committer": null, "parents": [{"sha": "f754c4a10a754e6f00bf4af89b480596550c5fe2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f754c4a10a754e6f00bf4af89b480596550c5fe2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f754c4a10a754e6f00bf4af89b480596550c5fe2"}], "stats": {"total": 20, "additions": 15, "deletions": 5}, "files": [{"sha": "eddeb22d3f1fb515ebc7bd95cf5fa09b5185f66d", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ff3467a9ebbd98aadd091a60f622cebf8f4b2870/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ff3467a9ebbd98aadd091a60f622cebf8f4b2870/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=ff3467a9ebbd98aadd091a60f622cebf8f4b2870", "patch": "@@ -6,6 +6,11 @@ Tue Nov  4 18:49:42 1997  Jeffrey A Law  (law@cygnus.com)\n \n Tue Nov  4 16:55:11 1997  Jim Wilson  <wilson@cygnus.com>\n \n+\t* combine.c (try_combine): When setting elim_i2, check whether newi2pat\n+\tsets i2dest.  When calling distribute_notes for i3dest_killed, pass\n+\telim_i2 and elim_i1.  When setting elim_i1, check if newi2pat\n+\tsets i1dest.\n+\n \t* mips.md (insv, extzv, extv): Add change_address call.\n \t(movsi_ulw, movsi_usw): Change QImode to BLKmode in pattern.\n "}, {"sha": "6bc921b6f8e9ab8ab1a90d86725d45e38ad9eb04", "filename": "gcc/combine.c", "status": "modified", "additions": 10, "deletions": 5, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ff3467a9ebbd98aadd091a60f622cebf8f4b2870/gcc%2Fcombine.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ff3467a9ebbd98aadd091a60f622cebf8f4b2870/gcc%2Fcombine.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcombine.c?ref=ff3467a9ebbd98aadd091a60f622cebf8f4b2870", "patch": "@@ -2146,10 +2146,15 @@ try_combine (i3, i2, i1)\n     rtx i3links, i2links, i1links = 0;\n     rtx midnotes = 0;\n     register int regno;\n-    /* Compute which registers we expect to eliminate.  */\n-    rtx elim_i2 = (newi2pat || i2dest_in_i2src || i2dest_in_i1src\n+    /* Compute which registers we expect to eliminate.  newi2pat may be setting\n+       either i3dest or i2dest, so we must check it.  Also, i1dest may be the\n+       same as i3dest, in which case newi2pat may be setting i1dest.  */\n+    rtx elim_i2 = ((newi2pat && reg_set_p (i2dest, newi2pat))\n+\t\t   || i2dest_in_i2src || i2dest_in_i1src\n \t\t   ? 0 : i2dest);\n-    rtx elim_i1 = i1 == 0 || i1dest_in_i1src ? 0 : i1dest;\n+    rtx elim_i1 = (i1 == 0 || i1dest_in_i1src\n+\t\t   || (newi2pat && reg_set_p (i1dest, newi2pat))\n+\t\t   ? 0 : i1dest);\n \n     /* Get the old REG_NOTES and LOG_LINKS from all our insns and\n        clear them.  */\n@@ -2312,12 +2317,12 @@ try_combine (i3, i2, i1)\n \tif (newi2pat && reg_set_p (i3dest_killed, newi2pat))\n \t  distribute_notes (gen_rtx (EXPR_LIST, REG_DEAD, i3dest_killed,\n \t\t\t\t     NULL_RTX),\n-\t\t\t    NULL_RTX, i2, NULL_RTX, NULL_RTX, NULL_RTX);\n+\t\t\t    NULL_RTX, i2, NULL_RTX, elim_i2, elim_i1);\n \telse\n \t  distribute_notes (gen_rtx (EXPR_LIST, REG_DEAD, i3dest_killed,\n \t\t\t\t     NULL_RTX),\n \t\t\t    NULL_RTX, i3, newi2pat ? i2 : NULL_RTX,\n-\t\t\t    NULL_RTX, NULL_RTX);\n+\t\t\t    elim_i2, elim_i1);\n       }\n \n     if (i2dest_in_i2src)"}]}