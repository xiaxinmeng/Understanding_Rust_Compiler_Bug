{"sha": "1e4122f1159ace52c114c011013adce25172d77b", "node_id": "C_kwDOANBUbNoAKDFlNDEyMmYxMTU5YWNlNTJjMTE0YzAxMTAxM2FkY2UyNTE3MmQ3N2I", "commit": {"author": {"name": "Alexandre Oliva", "email": "oliva@adacore.com", "date": "2023-03-03T04:47:00Z"}, "committer": {"name": "Alexandre Oliva", "email": "oliva@gnu.org", "date": "2023-03-03T05:32:00Z"}, "message": "[PR100127] Test for coroutine header in clang-compatible tests\n\nThe test is compatible with clang as well as gcc, but ISTM that\ntesting for the __clang__ macro is just as potentially error-prone as\nmacros that used to be GCC-specific are now defined in compilers that\naim for GCC compatibility.  Use a __has_include feature test instead.\n\n\nfor  gcc/testsuite/ChangeLog\n\n\tPR c++/100127\n\t* g++.dg/coroutines/pr100127.C: Test for header rather than\n\tcompiler macro.\n\t* g++.dg/coroutines/pr100772-a.C: Likewise.\n\t* g++.dg/coroutines/pr100772-b.C: Likewise.", "tree": {"sha": "1c39d2d30ad0799d28dbc0d1376117fac57075d6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1c39d2d30ad0799d28dbc0d1376117fac57075d6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1e4122f1159ace52c114c011013adce25172d77b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1e4122f1159ace52c114c011013adce25172d77b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1e4122f1159ace52c114c011013adce25172d77b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1e4122f1159ace52c114c011013adce25172d77b/comments", "author": null, "committer": null, "parents": [{"sha": "ddf7411e2069c33f56541eab35c37558199f3c41", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ddf7411e2069c33f56541eab35c37558199f3c41", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ddf7411e2069c33f56541eab35c37558199f3c41"}], "stats": {"total": 9, "additions": 6, "deletions": 3}, "files": [{"sha": "5879fd0bcc5955672bc15f981feee707c0e0b599", "filename": "gcc/testsuite/g++.dg/coroutines/pr100127.C", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1e4122f1159ace52c114c011013adce25172d77b/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcoroutines%2Fpr100127.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1e4122f1159ace52c114c011013adce25172d77b/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcoroutines%2Fpr100127.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcoroutines%2Fpr100127.C?ref=1e4122f1159ace52c114c011013adce25172d77b", "patch": "@@ -1,4 +1,5 @@\n-#ifdef __clang__\n+#if !__has_include(<coroutine>) \\\n+  && __has_include(<experimental/coroutine>) // for __clang__\n #include <experimental/coroutine>\n namespace std {\n   using namespace std::experimental;"}, {"sha": "06e705b0c65a05e4af4da259f23b099de46f9d1a", "filename": "gcc/testsuite/g++.dg/coroutines/pr100772-a.C", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1e4122f1159ace52c114c011013adce25172d77b/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcoroutines%2Fpr100772-a.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1e4122f1159ace52c114c011013adce25172d77b/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcoroutines%2Fpr100772-a.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcoroutines%2Fpr100772-a.C?ref=1e4122f1159ace52c114c011013adce25172d77b", "patch": "@@ -1,5 +1,6 @@\n //  { dg-additional-options \"-fsyntax-only \" }\n-#ifdef __clang__\n+#if !__has_include(<coroutine>) \\\n+  && __has_include(<experimental/coroutine>) // for __clang__\n #include <experimental/coroutine>\n namespace std {\n   using namespace std::experimental;"}, {"sha": "4ef80a9959490cd4a0e29a64829e331232889f3e", "filename": "gcc/testsuite/g++.dg/coroutines/pr100772-b.C", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1e4122f1159ace52c114c011013adce25172d77b/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcoroutines%2Fpr100772-b.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1e4122f1159ace52c114c011013adce25172d77b/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcoroutines%2Fpr100772-b.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcoroutines%2Fpr100772-b.C?ref=1e4122f1159ace52c114c011013adce25172d77b", "patch": "@@ -1,4 +1,5 @@\n-#ifdef __clang__\n+#if !__has_include(<coroutine>) \\\n+  && __has_include(<experimental/coroutine>) // for __clang__\n #include <experimental/coroutine>\n namespace std {\n   using namespace std::experimental;"}]}