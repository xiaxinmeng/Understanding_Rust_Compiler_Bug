{"sha": "8d0510ddbd6631df4b2b811b19b5d315ad52c82f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OGQwNTEwZGRiZDY2MzFkZjRiMmI4MTFiMTliNWQzMTVhZDUyYzgyZg==", "commit": {"author": {"name": "Roger Sayle", "email": "roger@eyesopen.com", "date": "2007-02-05T16:37:05Z"}, "committer": {"name": "Roger Sayle", "email": "sayle@gcc.gnu.org", "date": "2007-02-05T16:37:05Z"}, "message": "mips-tfile.c (initialize_init_file): Correct endianness test.\n\n\n\t* mips-tfile.c (initialize_init_file): Correct endianness test.\n\nFrom-SVN: r121602", "tree": {"sha": "87b962c7a9de181ad20de86cd29557f0a5db48f0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/87b962c7a9de181ad20de86cd29557f0a5db48f0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8d0510ddbd6631df4b2b811b19b5d315ad52c82f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8d0510ddbd6631df4b2b811b19b5d315ad52c82f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8d0510ddbd6631df4b2b811b19b5d315ad52c82f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8d0510ddbd6631df4b2b811b19b5d315ad52c82f/comments", "author": null, "committer": null, "parents": [{"sha": "cd5c235734cbd984d135eeba66315313e8a633b7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cd5c235734cbd984d135eeba66315313e8a633b7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cd5c235734cbd984d135eeba66315313e8a633b7"}], "stats": {"total": 25, "additions": 21, "deletions": 4}, "files": [{"sha": "165cfeb6ff67b449c7708dad482f0c94d17b667e", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8d0510ddbd6631df4b2b811b19b5d315ad52c82f/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8d0510ddbd6631df4b2b811b19b5d315ad52c82f/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=8d0510ddbd6631df4b2b811b19b5d315ad52c82f", "patch": "@@ -1,3 +1,7 @@\n+2007-02-05  Roger Sayle  <roger@eyesopen.com>\n+\n+\t* mips-tfile.c (initialize_init_file): Correct endianness test.\n+\n 2007-02-05  Kazu Hirata  <kazu@codesourcery.com>\n \n \t* config/m68k/m68k.md (pushdi-1, pushdi, movsi+1): Don't use"}, {"sha": "ac7030049285bb03c5656450c6083cf95e867cc1", "filename": "gcc/mips-tfile.c", "status": "modified", "additions": 17, "deletions": 4, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8d0510ddbd6631df4b2b811b19b5d315ad52c82f/gcc%2Fmips-tfile.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8d0510ddbd6631df4b2b811b19b5d315ad52c82f/gcc%2Fmips-tfile.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fmips-tfile.c?ref=8d0510ddbd6631df4b2b811b19b5d315ad52c82f", "patch": "@@ -3,7 +3,7 @@\n    in the form of comments (the mips assembler does not support\n    assembly access to debug information).\n    Copyright (C) 1991, 1993, 1994, 1995, 1997, 1998, 1999, 2000, 2001,\n-   2002, 2003, 2004, 2005, 2006 Free Software Foundation, Inc.\n+   2002, 2003, 2004, 2005, 2006, 2007 Free Software Foundation, Inc.\n    Contributed by Michael Meissner (meissner@cygnus.com).\n \n This file is part of GCC.\n@@ -2352,15 +2352,28 @@ add_procedure (const char *func_start,  /* 1st byte of func name */\n STATIC void\n initialize_init_file (void)\n {\n+  union {\n+    unsigned char c[4];\n+    int i;\n+  } endian_test;\n+\n   memset (&init_file, 0, sizeof (init_file));\n \n   init_file.fdr.lang = langC;\n   init_file.fdr.fMerge = 1;\n   init_file.fdr.glevel = GLEVEL_2;\n \n-#ifdef WORDS_BIG_ENDIAN\n-  init_file.fdr.fBigendian = 1;\n-#endif\n+  /* mips-tfile doesn't attempt to perform byte swapping and always writes\n+     out integers in its native ordering.  For cross-compilers, this need\n+     not be the same as either the host or the target.  The simplest thing\n+     to do is skip the configury and perform an introspective test.  */\n+  /* ??? Despite the name, mips-tfile is currently only used on alpha/Tru64\n+     and would/may require significant work to be used in cross-compiler\n+     configurations, so we could simply admit defeat and hard code this as\n+     little-endian, i.e. init_file.fdr.fBigendian = 0.  */\n+  endian_test.i = 1;\n+  if (endian_test.c[3])\n+    init_file.fdr.fBigendian = 1;\n \n   INITIALIZE_VARRAY (&init_file.strings, char);\n   INITIALIZE_VARRAY (&init_file.symbols, SYMR);"}]}