{"sha": "baa288f308a8b1b86607995fe71258d7e3cc2825", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmFhMjg4ZjMwOGE4YjFiODY2MDc5OTVmZTcxMjU4ZDdlM2NjMjgyNQ==", "commit": {"author": {"name": "Tom Tromey", "email": "tromey@cygnus.com", "date": "1999-04-21T13:50:39Z"}, "committer": {"name": "Tom Tromey", "email": "tromey@gcc.gnu.org", "date": "1999-04-21T13:50:39Z"}, "message": "natString.cc (getBytes): Reverted earlier change and applied correct fix from Per Bothner.\n\n\t* java/lang/natString.cc (getBytes): Reverted earlier change and\n\tapplied correct fix from Per Bothner.\n\nFrom-SVN: r26579", "tree": {"sha": "d5ee50159f44032acf2cf8931827e14bf35df694", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d5ee50159f44032acf2cf8931827e14bf35df694"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/baa288f308a8b1b86607995fe71258d7e3cc2825", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/baa288f308a8b1b86607995fe71258d7e3cc2825", "html_url": "https://github.com/Rust-GCC/gccrs/commit/baa288f308a8b1b86607995fe71258d7e3cc2825", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/baa288f308a8b1b86607995fe71258d7e3cc2825/comments", "author": null, "committer": null, "parents": [{"sha": "5423609c57f756be5db8981d4ebb11a80d44f6e9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5423609c57f756be5db8981d4ebb11a80d44f6e9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5423609c57f756be5db8981d4ebb11a80d44f6e9"}], "stats": {"total": 11, "additions": 8, "deletions": 3}, "files": [{"sha": "da93b9cc83141e574cc71973d42ab6565c778f55", "filename": "libjava/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/baa288f308a8b1b86607995fe71258d7e3cc2825/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/baa288f308a8b1b86607995fe71258d7e3cc2825/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=baa288f308a8b1b86607995fe71258d7e3cc2825", "patch": "@@ -1,5 +1,8 @@\n 1999-04-21  Tom Tromey  <tromey@cygnus.com>\n \n+\t* java/lang/natString.cc (getBytes): Reverted earlier change and\n+\tapplied correct fix from Per Bothner.\n+\n \t* java/lang/String.java: Don't throw\n \tUnsupportedEncodingException.\n "}, {"sha": "08f1755715dadaf7f90c3b913b441626a6a46e54", "filename": "libjava/java/lang/natString.cc", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/baa288f308a8b1b86607995fe71258d7e3cc2825/libjava%2Fjava%2Flang%2FnatString.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/baa288f308a8b1b86607995fe71258d7e3cc2825/libjava%2Fjava%2Flang%2FnatString.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjava%2Flang%2FnatString.cc?ref=baa288f308a8b1b86607995fe71258d7e3cc2825", "patch": "@@ -473,9 +473,11 @@ java::lang::String::getBytes (jstring enc)\n     {\n       converter->setOutput(buffer, bufpos);\n       int converted = converter->write(this, offset, todo, NULL);\n+      bufpos = converter->count;\n       if (converted == 0)\n \t{\n-\t  jbyteArray newbuffer = JvNewByteArray(2 * buflen);\n+\t  buflen *= 2;\n+\t  jbyteArray newbuffer = JvNewByteArray(buflen);\n \t  memcpy (elements (newbuffer), elements (buffer), bufpos);\n \t  buffer = newbuffer;\n \t}\n@@ -487,8 +489,8 @@ java::lang::String::getBytes (jstring enc)\n     }\n   if (bufpos == buflen)\n     return buffer;\n-  jbyteArray result = JvNewByteArray(buflen);\n-  memcpy (elements (result), elements (buffer), buflen);\n+  jbyteArray result = JvNewByteArray(bufpos);\n+  memcpy (elements (result), elements (buffer), bufpos);\n   return result;\n }\n "}]}