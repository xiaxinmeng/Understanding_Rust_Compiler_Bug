{"sha": "8e89cbfe6cfa70ebe7978bf635111dc307b19f56", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OGU4OWNiZmU2Y2ZhNzBlYmU3OTc4YmY2MzUxMTFkYzMwN2IxOWY1Ng==", "commit": {"author": {"name": "Ollie Wild", "email": "aaw@google.com", "date": "2007-05-22T21:05:01Z"}, "committer": {"name": "Ollie Wild", "email": "aaw@gcc.gnu.org", "date": "2007-05-22T21:05:01Z"}, "message": "name-lookup.c (ambiguous_decl): Adds check for hidden types.\n\n\t* name-lookup.c (ambiguous_decl): Adds check for hidden types.\n\t(unqualified_namespace_lookup): Adds check for hidden types.\n\n\t* g++.dg/lookup/hidden-class10.C: New test.\n\t* g++.dg/lookup/hidden-class11.C: New test.\n\nFrom-SVN: r124963", "tree": {"sha": "f6b49ec02c025097ff133b034f790ab8364dfef5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f6b49ec02c025097ff133b034f790ab8364dfef5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8e89cbfe6cfa70ebe7978bf635111dc307b19f56", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8e89cbfe6cfa70ebe7978bf635111dc307b19f56", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8e89cbfe6cfa70ebe7978bf635111dc307b19f56", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8e89cbfe6cfa70ebe7978bf635111dc307b19f56/comments", "author": {"login": "olliewild", "id": 11523068, "node_id": "MDQ6VXNlcjExNTIzMDY4", "avatar_url": "https://avatars.githubusercontent.com/u/11523068?v=4", "gravatar_id": "", "url": "https://api.github.com/users/olliewild", "html_url": "https://github.com/olliewild", "followers_url": "https://api.github.com/users/olliewild/followers", "following_url": "https://api.github.com/users/olliewild/following{/other_user}", "gists_url": "https://api.github.com/users/olliewild/gists{/gist_id}", "starred_url": "https://api.github.com/users/olliewild/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/olliewild/subscriptions", "organizations_url": "https://api.github.com/users/olliewild/orgs", "repos_url": "https://api.github.com/users/olliewild/repos", "events_url": "https://api.github.com/users/olliewild/events{/privacy}", "received_events_url": "https://api.github.com/users/olliewild/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "6b12f000e0879e171ce0a7677291a9417d014221", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6b12f000e0879e171ce0a7677291a9417d014221", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6b12f000e0879e171ce0a7677291a9417d014221"}], "stats": {"total": 50, "additions": 48, "deletions": 2}, "files": [{"sha": "df07249a0dd5c7327e940acb54c1dfb985efea0f", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8e89cbfe6cfa70ebe7978bf635111dc307b19f56/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8e89cbfe6cfa70ebe7978bf635111dc307b19f56/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=8e89cbfe6cfa70ebe7978bf635111dc307b19f56", "patch": "@@ -1,3 +1,8 @@\n+2007-05-22  Ollie Wild  <aaw@google.com>\n+\n+\t* name-lookup.c (ambiguous_decl): Adds check for hidden types.\n+\t(unqualified_namespace_lookup): Adds check for hidden types.\n+\n 2007-05-22  Ollie Wild  <aaw@google.com>\n \n \t* decl.c (duplicate_decls): Verify namespace names are unique."}, {"sha": "befc2d3a037eca29f669433c7d60c03a4a216211", "filename": "gcc/cp/name-lookup.c", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8e89cbfe6cfa70ebe7978bf635111dc307b19f56/gcc%2Fcp%2Fname-lookup.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8e89cbfe6cfa70ebe7978bf635111dc307b19f56/gcc%2Fcp%2Fname-lookup.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fname-lookup.c?ref=8e89cbfe6cfa70ebe7978bf635111dc307b19f56", "patch": "@@ -3543,7 +3543,7 @@ ambiguous_decl (tree name, struct scope_binding *old, cxx_binding *new,\n     }\n   /* ... and copy the type.  */\n   type = new->type;\n-  if (LOOKUP_NAMESPACES_ONLY (flags))\n+  if (LOOKUP_NAMESPACES_ONLY (flags) || (type && hidden_name_p (type)))\n     type = NULL_TREE;\n   if (!old->type)\n     old->type = type;\n@@ -3699,7 +3699,9 @@ unqualified_namespace_lookup (tree name, int flags)\n \t  if (b->value\n \t      && ((flags & LOOKUP_HIDDEN) || !hidden_name_p (b->value)))\n \t    binding.value = b->value;\n-\t  binding.type = b->type;\n+\t  if (b->type\n+\t      && ((flags & LOOKUP_HIDDEN) || !hidden_name_p (b->type)))\n+\t    binding.type = b->type;\n \t}\n \n       /* Add all _DECLs seen through local using-directives.  */"}, {"sha": "189d5ff9ea491714660ab722c1410aa3f5c4042c", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8e89cbfe6cfa70ebe7978bf635111dc307b19f56/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8e89cbfe6cfa70ebe7978bf635111dc307b19f56/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=8e89cbfe6cfa70ebe7978bf635111dc307b19f56", "patch": "@@ -1,3 +1,8 @@\n+2007-05-22  Ollie Wild  <aaw@google.com>\n+\n+\t* g++.dg/lookup/hidden-class10.C: New test.\n+\t* g++.dg/lookup/hidden-class11.C: New test.\n+\n 2007-05-22  Ollie Wild  <aaw@google.com>\n \n \t* g++.dg/lookup/name-clash5.C: New test."}, {"sha": "f68196ff8a1da0dc18261796383f53e0d82a3c4e", "filename": "gcc/testsuite/g++.dg/lookup/hidden-class10.C", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8e89cbfe6cfa70ebe7978bf635111dc307b19f56/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Fhidden-class10.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8e89cbfe6cfa70ebe7978bf635111dc307b19f56/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Fhidden-class10.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Fhidden-class10.C?ref=8e89cbfe6cfa70ebe7978bf635111dc307b19f56", "patch": "@@ -0,0 +1,11 @@\n+// Copyright (C) 2007 Free Software Foundation\n+// Contributed by Ollie Wild <aaw@google.com>\n+// { dg-do compile }\n+\n+// Verify that a friend class is hidden even if it overrides a builtin\n+// function name.\n+\n+class A {\n+  friend class abort;\n+  abort *b;\t// { dg-error \"no type|expected\" }\n+};"}, {"sha": "8432e32d85a0cf4fd31d60f71683721491bad863", "filename": "gcc/testsuite/g++.dg/lookup/hidden-class11.C", "status": "added", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8e89cbfe6cfa70ebe7978bf635111dc307b19f56/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Fhidden-class11.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8e89cbfe6cfa70ebe7978bf635111dc307b19f56/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Fhidden-class11.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Fhidden-class11.C?ref=8e89cbfe6cfa70ebe7978bf635111dc307b19f56", "patch": "@@ -0,0 +1,23 @@\n+// Copyright (C) 2007 Free Software Foundation\n+// Contributed by Ollie Wild <aaw@google.com>\n+// { dg-do compile }\n+\n+// Verify that a friend class is hidden even if it is hidden by a non-builtin\n+// function name.\n+\n+namespace M {\n+  void F (void);\n+  class F;\n+}\n+\n+namespace N {\n+  void F(void);\n+  class A {\n+    friend class F;\n+  };\n+}\n+\n+using namespace M;\n+using namespace N;\n+\n+class F *b;"}]}