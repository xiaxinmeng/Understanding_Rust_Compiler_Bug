{"sha": "63746c253a83be0022d920e045dfd356b1ca0149", "node_id": "C_kwDOANBUbNoAKDYzNzQ2YzI1M2E4M2JlMDAyMmQ5MjBlMDQ1ZGZkMzU2YjFjYTAxNDk", "commit": {"author": {"name": "Tom de Vries", "email": "tdevries@suse.de", "date": "2022-03-18T15:19:25Z"}, "committer": {"name": "Tom de Vries", "email": "tdevries@suse.de", "date": "2022-03-18T15:27:28Z"}, "message": "Fix \"[openmp] Set location for taskloop stmts\"\n\nI accidentally committed an outdated version of patch \"[openmp] Set location\nfor taskloop stmts\".\n\nFix this by adding the missing changes.\n\ngcc/ChangeLog:\n\n2022-03-18  Tom de Vries  <tdevries@suse.de>\n\n\t* gimplify.cc (gimplify_omp_for): Set location using 'input_location'.\n\tSet gfor location only when dealing with a OMP_TASKLOOP.", "tree": {"sha": "361afd42dfa9270a1102efe3fe9688809eb938f6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/361afd42dfa9270a1102efe3fe9688809eb938f6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/63746c253a83be0022d920e045dfd356b1ca0149", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/63746c253a83be0022d920e045dfd356b1ca0149", "html_url": "https://github.com/Rust-GCC/gccrs/commit/63746c253a83be0022d920e045dfd356b1ca0149", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/63746c253a83be0022d920e045dfd356b1ca0149/comments", "author": {"login": "vries", "id": 4057235, "node_id": "MDQ6VXNlcjQwNTcyMzU=", "avatar_url": "https://avatars.githubusercontent.com/u/4057235?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vries", "html_url": "https://github.com/vries", "followers_url": "https://api.github.com/users/vries/followers", "following_url": "https://api.github.com/users/vries/following{/other_user}", "gists_url": "https://api.github.com/users/vries/gists{/gist_id}", "starred_url": "https://api.github.com/users/vries/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vries/subscriptions", "organizations_url": "https://api.github.com/users/vries/orgs", "repos_url": "https://api.github.com/users/vries/repos", "events_url": "https://api.github.com/users/vries/events{/privacy}", "received_events_url": "https://api.github.com/users/vries/received_events", "type": "User", "site_admin": false}, "committer": {"login": "vries", "id": 4057235, "node_id": "MDQ6VXNlcjQwNTcyMzU=", "avatar_url": "https://avatars.githubusercontent.com/u/4057235?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vries", "html_url": "https://github.com/vries", "followers_url": "https://api.github.com/users/vries/followers", "following_url": "https://api.github.com/users/vries/following{/other_user}", "gists_url": "https://api.github.com/users/vries/gists{/gist_id}", "starred_url": "https://api.github.com/users/vries/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vries/subscriptions", "organizations_url": "https://api.github.com/users/vries/orgs", "repos_url": "https://api.github.com/users/vries/repos", "events_url": "https://api.github.com/users/vries/events{/privacy}", "received_events_url": "https://api.github.com/users/vries/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "41f01c97153d403fb34eefac245bab8ba472beea", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/41f01c97153d403fb34eefac245bab8ba472beea", "html_url": "https://github.com/Rust-GCC/gccrs/commit/41f01c97153d403fb34eefac245bab8ba472beea"}], "stats": {"total": 4, "additions": 2, "deletions": 2}, "files": [{"sha": "f62f150fc0858f9c62e3e817ae9da81b04de4d46", "filename": "gcc/gimplify.cc", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/63746c253a83be0022d920e045dfd356b1ca0149/gcc%2Fgimplify.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/63746c253a83be0022d920e045dfd356b1ca0149/gcc%2Fgimplify.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgimplify.cc?ref=63746c253a83be0022d920e045dfd356b1ca0149", "patch": "@@ -13178,7 +13178,6 @@ gimplify_omp_for (tree *expr_p, gimple_seq *pre_p)\n   gfor = gimple_build_omp_for (for_body, kind, OMP_FOR_CLAUSES (orig_for_stmt),\n \t\t\t       TREE_VEC_LENGTH (OMP_FOR_INIT (for_stmt)),\n \t\t\t       for_pre_body);\n-  gimple_set_location (gfor, EXPR_LOCATION (*expr_p));\n   if (orig_for_stmt != for_stmt)\n     gimple_omp_for_set_combined_p (gfor, true);\n   if (gimplify_omp_ctxp\n@@ -13359,10 +13358,11 @@ gimplify_omp_for (tree *expr_p, gimple_seq *pre_p)\n       *gtask_clauses_ptr = NULL_TREE;\n       *gforo_clauses_ptr = NULL_TREE;\n       BITMAP_FREE (lastprivate_uids);\n+      gimple_set_location (gfor, input_location);\n       g = gimple_build_bind (NULL_TREE, gfor, NULL_TREE);\n       g = gimple_build_omp_task (g, task_clauses, NULL_TREE, NULL_TREE,\n \t\t\t\t NULL_TREE, NULL_TREE, NULL_TREE);\n-      gimple_set_location (g, EXPR_LOCATION (*expr_p));\n+      gimple_set_location (g, input_location);\n       gimple_omp_task_set_taskloop_p (g, true);\n       g = gimple_build_bind (NULL_TREE, g, NULL_TREE);\n       gomp_for *gforo"}]}