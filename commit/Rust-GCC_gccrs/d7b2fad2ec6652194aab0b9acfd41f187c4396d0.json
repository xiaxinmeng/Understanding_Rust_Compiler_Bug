{"sha": "d7b2fad2ec6652194aab0b9acfd41f187c4396d0", "node_id": "C_kwDOANBUbNoAKGQ3YjJmYWQyZWM2NjUyMTk0YWFiMGI5YWNmZDQxZjE4N2M0Mzk2ZDA", "commit": {"author": {"name": "Piotr Trojanek", "email": "trojanek@adacore.com", "date": "2021-12-21T14:20:30Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "derodat@adacore.com", "date": "2022-01-07T16:24:14Z"}, "message": "[Ada] More default initialization for multi-dim array aggregates\n\ngcc/ada/\n\n\t* exp_aggr.adb (Gen_Assign): Remove explicit initialization for\n\tcomponents of access types.\n\t(Get_Assoc_Expr): Enable initialization for components of all\n\ttypes that require simple initialization.", "tree": {"sha": "1d277c89813306afb59b9beee931bfc4fac9f9e8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1d277c89813306afb59b9beee931bfc4fac9f9e8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d7b2fad2ec6652194aab0b9acfd41f187c4396d0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d7b2fad2ec6652194aab0b9acfd41f187c4396d0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d7b2fad2ec6652194aab0b9acfd41f187c4396d0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d7b2fad2ec6652194aab0b9acfd41f187c4396d0/comments", "author": {"login": "ptroja", "id": 161602, "node_id": "MDQ6VXNlcjE2MTYwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/161602?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ptroja", "html_url": "https://github.com/ptroja", "followers_url": "https://api.github.com/users/ptroja/followers", "following_url": "https://api.github.com/users/ptroja/following{/other_user}", "gists_url": "https://api.github.com/users/ptroja/gists{/gist_id}", "starred_url": "https://api.github.com/users/ptroja/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ptroja/subscriptions", "organizations_url": "https://api.github.com/users/ptroja/orgs", "repos_url": "https://api.github.com/users/ptroja/repos", "events_url": "https://api.github.com/users/ptroja/events{/privacy}", "received_events_url": "https://api.github.com/users/ptroja/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pmderodat", "id": 758452, "node_id": "MDQ6VXNlcjc1ODQ1Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/758452?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pmderodat", "html_url": "https://github.com/pmderodat", "followers_url": "https://api.github.com/users/pmderodat/followers", "following_url": "https://api.github.com/users/pmderodat/following{/other_user}", "gists_url": "https://api.github.com/users/pmderodat/gists{/gist_id}", "starred_url": "https://api.github.com/users/pmderodat/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pmderodat/subscriptions", "organizations_url": "https://api.github.com/users/pmderodat/orgs", "repos_url": "https://api.github.com/users/pmderodat/repos", "events_url": "https://api.github.com/users/pmderodat/events{/privacy}", "received_events_url": "https://api.github.com/users/pmderodat/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2eed8f16bfefbf50d991419cc11fe9a0e2122aa8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2eed8f16bfefbf50d991419cc11fe9a0e2122aa8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2eed8f16bfefbf50d991419cc11fe9a0e2122aa8"}], "stats": {"total": 19, "additions": 4, "deletions": 15}, "files": [{"sha": "4dfe280fe61add5deffa9da6fc61639ca612d7c6", "filename": "gcc/ada/exp_aggr.adb", "status": "modified", "additions": 4, "deletions": 15, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d7b2fad2ec6652194aab0b9acfd41f187c4396d0/gcc%2Fada%2Fexp_aggr.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d7b2fad2ec6652194aab0b9acfd41f187c4396d0/gcc%2Fada%2Fexp_aggr.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fexp_aggr.adb?ref=d7b2fad2ec6652194aab0b9acfd41f187c4396d0", "patch": "@@ -1872,12 +1872,6 @@ package body Exp_Aggr is\n                   Set_Etype (Indexed_Comp, Ctype);\n                   Append_To (Stmts, Make_Invariant_Call (Indexed_Comp));\n                end if;\n-\n-            elsif Is_Access_Type (Ctype) then\n-               Append_To (Stmts,\n-                 Make_Assignment_Statement (Loc,\n-                   Name       => New_Copy_Tree (Indexed_Comp),\n-                   Expression => Make_Null (Loc)));\n             end if;\n \n             if Needs_Finalization (Ctype) then\n@@ -2212,15 +2206,10 @@ package body Exp_Aggr is\n \n       begin\n          if Box_Present (Assoc) then\n-            if Is_Scalar_Type (Ctype) then\n-               if Present (Default_Aspect_Component_Value (Typ)) then\n-                  return Default_Aspect_Component_Value (Typ);\n-               elsif Present (Default_Aspect_Value (Ctype)) then\n-                  return Default_Aspect_Value (Ctype);\n-               else\n-                  return Empty;\n-               end if;\n-\n+            if Present (Default_Aspect_Component_Value (Typ)) then\n+               return Default_Aspect_Component_Value (Typ);\n+            elsif Needs_Simple_Initialization (Ctype) then\n+               return Get_Simple_Init_Val (Ctype, N);\n             else\n                return Empty;\n             end if;"}]}