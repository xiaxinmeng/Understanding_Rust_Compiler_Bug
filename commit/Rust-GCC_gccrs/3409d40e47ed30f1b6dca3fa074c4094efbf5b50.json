{"sha": "3409d40e47ed30f1b6dca3fa074c4094efbf5b50", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzQwOWQ0MGU0N2VkMzBmMWI2ZGNhM2ZhMDc0YzQwOTRlZmJmNWI1MA==", "commit": {"author": {"name": "Kostya Serebryany", "email": "kcc@google.com", "date": "2012-11-23T04:09:17Z"}, "committer": {"name": "Kostya Serebryany", "email": "kcc@gcc.gnu.org", "date": "2012-11-23T04:09:17Z"}, "message": "[libsanitizer] a script to help merging asan/tsan from upstream\n\nFrom-SVN: r193743", "tree": {"sha": "02c7148c9f6a8608bf6dd07d39920960e7bd38ff", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/02c7148c9f6a8608bf6dd07d39920960e7bd38ff"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3409d40e47ed30f1b6dca3fa074c4094efbf5b50", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3409d40e47ed30f1b6dca3fa074c4094efbf5b50", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3409d40e47ed30f1b6dca3fa074c4094efbf5b50", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3409d40e47ed30f1b6dca3fa074c4094efbf5b50/comments", "author": {"login": "kcc", "id": 1789297, "node_id": "MDQ6VXNlcjE3ODkyOTc=", "avatar_url": "https://avatars.githubusercontent.com/u/1789297?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kcc", "html_url": "https://github.com/kcc", "followers_url": "https://api.github.com/users/kcc/followers", "following_url": "https://api.github.com/users/kcc/following{/other_user}", "gists_url": "https://api.github.com/users/kcc/gists{/gist_id}", "starred_url": "https://api.github.com/users/kcc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kcc/subscriptions", "organizations_url": "https://api.github.com/users/kcc/orgs", "repos_url": "https://api.github.com/users/kcc/repos", "events_url": "https://api.github.com/users/kcc/events{/privacy}", "received_events_url": "https://api.github.com/users/kcc/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "b28ece323223adc71ea3c6d924d946ae67186153", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b28ece323223adc71ea3c6d924d946ae67186153", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b28ece323223adc71ea3c6d924d946ae67186153"}], "stats": {"total": 86, "additions": 86, "deletions": 0}, "files": [{"sha": "7e206f9b96ce4f33bec729af2c1cc3e48118696a", "filename": "libsanitizer/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3409d40e47ed30f1b6dca3fa074c4094efbf5b50/libsanitizer%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3409d40e47ed30f1b6dca3fa074c4094efbf5b50/libsanitizer%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libsanitizer%2FChangeLog?ref=3409d40e47ed30f1b6dca3fa074c4094efbf5b50", "patch": "@@ -1,3 +1,7 @@\n+2012-11-23  Kostya Serebryany  <kcc@google.com>\n+        \n+\t* merge.sh: a script that will help merges from upstream.\n+\n 2012-11-23  Jakub Jelinek  <jakub@redhat.com>\n \n \t* tsan/Makefile.am (AM_CXXFLAGS): Remove -Wno-variadic-macros."}, {"sha": "92759df2eb9da9e0dd5a99421e06d4fd00c6fcc5", "filename": "libsanitizer/README.gcc", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3409d40e47ed30f1b6dca3fa074c4094efbf5b50/libsanitizer%2FREADME.gcc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3409d40e47ed30f1b6dca3fa074c4094efbf5b50/libsanitizer%2FREADME.gcc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libsanitizer%2FREADME.gcc?ref=3409d40e47ed30f1b6dca3fa074c4094efbf5b50", "patch": "@@ -13,3 +13,6 @@ http://llvm.org/svn/llvm-project/compiler-rt in the following directories:\n Trivial and urgent fixes (portability, build fixes, etc.) may go directly to the\n GCC tree.  All non-trivial changes, functionality improvements, etc. should go\n through the upstream tree first and then be merged back to the GCC tree.\n+The merges from upstream should be done with the aid of the merge.sh script;\n+it will also update the file MERGE to contain the upstream revision\n+we merged with."}, {"sha": "6918ee2475fb690df68f21e15da0b53ea3395fbc", "filename": "libsanitizer/merge.sh", "status": "added", "additions": 79, "deletions": 0, "changes": 79, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3409d40e47ed30f1b6dca3fa074c4094efbf5b50/libsanitizer%2Fmerge.sh", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3409d40e47ed30f1b6dca3fa074c4094efbf5b50/libsanitizer%2Fmerge.sh", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libsanitizer%2Fmerge.sh?ref=3409d40e47ed30f1b6dca3fa074c4094efbf5b50", "patch": "@@ -0,0 +1,79 @@\n+#!/bin/bash\n+\n+# FIXME: do we need a license (or whatever else) header here?\n+\n+# This script merges libsanitizer sources from upstream.\n+\n+get_upstream() {\n+  rm -rf upstream\n+  #cp -rf orig upstream\n+  svn co http://llvm.org/svn/llvm-project/compiler-rt/trunk upstream\n+}\n+\n+get_current_rev() {\n+  cd upstream\n+  svn info | grep Revision | grep -o '[0-9]*'\n+}\n+\n+list_files() {\n+  (cd $1; ls *.{cc,h} 2> /dev/null)\n+\n+}\n+\n+change_comment_headers() {\n+  for f in $(list_files $1); do\n+    changed=$(awk 'NR != 2 && NR != 3' < $1/$f)\n+    echo \"$changed\" > $1/$f\n+  done\n+}\n+\n+# ARGUMENTS: upstream_path local_path\n+# This function merges changes from the directory upstream_path to\n+# the directory  local_path.\n+merge() {\n+  upstream_path=upstream/$1\n+  local_path=$2\n+  change_comment_headers $upstream_path\n+  echo MERGE: $upstream_path\n+  all=$( (list_files $upstream_path; list_files $local_path) | sort | uniq)\n+  #echo $all\n+  for f in $all; do\n+    if  [ -f $upstream_path/$f -a -f $local_path/$f ]; then\n+      echo \"FOUND IN BOTH     :\" $f\n+      # diff -u $local_path/$f $upstream_path/$f\n+      cp -v $upstream_path/$f $local_path\n+    elif [ -f $upstream_path/$f ]; then\n+      echo \"FOUND IN UPSTREAM :\" $f\n+      echo \"UNSUPPORTED YET\" && exit 1\n+    elif [ -f $local_path/$f ]; then\n+      echo \"FOUND IN LOCAL    :\" $f\n+      echo \"UNSUPPORTED YET\" && exit 1\n+    fi\n+  done\n+\n+}\n+\n+fatal() {\n+  echo \"$1\"\n+  exit 1;\n+}\n+\n+pwd | grep 'libsanitizer$' || \\\n+  fatal \"Run this script from libsanitizer dir\"\n+get_upstream\n+CUR_REV=$(get_current_rev)\n+echo Current upstream revision: $CUR_REV\n+merge include/sanitizer include/sanitizer\n+merge lib/asan asan\n+merge lib/sanitizer_common sanitizer_common\n+merge lib/interception interception\n+\n+rm -rf upstream\n+\n+# Update the MERGE file.\n+cat << EOF > MERGE\n+$CUR_REV\n+\n+The first line of this file holds the svn revision number of the\n+last merge done from the master library sources.\n+EOF"}]}