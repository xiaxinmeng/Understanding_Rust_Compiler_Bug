{"sha": "c45a8466e615418926ac97e765e7cee80c020698", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzQ1YTg0NjZlNjE1NDE4OTI2YWM5N2U3NjVlN2NlZTgwYzAyMDY5OA==", "commit": {"author": {"name": "Tom Tromey", "email": "tromey@cygnus.com", "date": "1999-09-08T17:10:22Z"}, "committer": {"name": "Tom Tromey", "email": "tromey@gcc.gnu.org", "date": "1999-09-08T17:10:22Z"}, "message": "posix-threads.h (_Jv_PthreadCheckMonitor): Reverted previous change and implemented a correct test in the __m_count case.\n\n\t* include/posix-threads.h (_Jv_PthreadCheckMonitor): Reverted\n\tprevious change and implemented a correct test in the __m_count\n\tcase.\n\nFrom-SVN: r29209", "tree": {"sha": "1c3b10128636af58dd8eff71ce989482c61ab5bf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1c3b10128636af58dd8eff71ce989482c61ab5bf"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c45a8466e615418926ac97e765e7cee80c020698", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c45a8466e615418926ac97e765e7cee80c020698", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c45a8466e615418926ac97e765e7cee80c020698", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c45a8466e615418926ac97e765e7cee80c020698/comments", "author": null, "committer": null, "parents": [{"sha": "e1b6684ceca53685a860320b57573fcfa83d8e7f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e1b6684ceca53685a860320b57573fcfa83d8e7f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e1b6684ceca53685a860320b57573fcfa83d8e7f"}], "stats": {"total": 8, "additions": 7, "deletions": 1}, "files": [{"sha": "5092814932abff291cb6c7a268573d10fbd72d92", "filename": "libjava/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c45a8466e615418926ac97e765e7cee80c020698/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c45a8466e615418926ac97e765e7cee80c020698/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=c45a8466e615418926ac97e765e7cee80c020698", "patch": "@@ -1,5 +1,9 @@\n 1999-09-08  Tom Tromey  <tromey@cygnus.com>\n \n+\t* include/posix-threads.h (_Jv_PthreadCheckMonitor): Reverted\n+\tprevious change and implemented a correct test in the __m_count\n+\tcase.\n+\n \t* include/posix-threads.h (_Jv_PthreadCheckMonitor): Changed test\n \tin __m_count case.\n "}, {"sha": "38629f44b010a9361b90635d09d3ead376048f9f", "filename": "libjava/include/posix-threads.h", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c45a8466e615418926ac97e765e7cee80c020698/libjava%2Finclude%2Fposix-threads.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c45a8466e615418926ac97e765e7cee80c020698/libjava%2Finclude%2Fposix-threads.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Finclude%2Fposix-threads.h?ref=c45a8466e615418926ac97e765e7cee80c020698", "patch": "@@ -114,7 +114,9 @@ _Jv_PthreadCheckMonitor (_Jv_Mutex_t *mu)\n   // On Linux we exploit knowledge of the implementation.\n   int r = pmu->m_count == 1;\n #elif defined (PTHREAD_MUTEX_HAVE___M_COUNT)\n-  int r = (pthread_t) pmu->__m_owner == pthread_self ();\n+  // In glibc 2.1, the first time the mutex is grabbed __m_count is\n+  // set to 0 and __m_owner is set to pthread_self().\n+  int r = ! pmu->__m_count;\n #else\n   int r = mu->count == 0;\n #endif"}]}