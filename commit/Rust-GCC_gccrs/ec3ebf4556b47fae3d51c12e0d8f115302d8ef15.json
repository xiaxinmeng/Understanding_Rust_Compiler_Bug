{"sha": "ec3ebf4556b47fae3d51c12e0d8f115302d8ef15", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWMzZWJmNDU1NmI0N2ZhZTNkNTFjMTJlMGQ4ZjExNTMwMmQ4ZWYxNQ==", "commit": {"author": {"name": "Olivier Goffart", "email": "olivier@woboq.com", "date": "2011-11-04T17:15:02Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "2011-11-04T17:15:02Z"}, "message": "re PR c++/50965 (C++11 Non static member initializer are not run when class is initialized with {})\n\n\tPR c++/50965\n\t* class.c (check_field_decls): NSDMI makes a class non-aggregate.\n\nCo-Authored-By: Jason Merrill <jason@redhat.com>\n\nFrom-SVN: r180965", "tree": {"sha": "887cd3dc67c05e4d28edfc75dcdcfbbb1087181b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/887cd3dc67c05e4d28edfc75dcdcfbbb1087181b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ec3ebf4556b47fae3d51c12e0d8f115302d8ef15", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ec3ebf4556b47fae3d51c12e0d8f115302d8ef15", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ec3ebf4556b47fae3d51c12e0d8f115302d8ef15", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ec3ebf4556b47fae3d51c12e0d8f115302d8ef15/comments", "author": {"login": "ogoffart", "id": 959326, "node_id": "MDQ6VXNlcjk1OTMyNg==", "avatar_url": "https://avatars.githubusercontent.com/u/959326?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ogoffart", "html_url": "https://github.com/ogoffart", "followers_url": "https://api.github.com/users/ogoffart/followers", "following_url": "https://api.github.com/users/ogoffart/following{/other_user}", "gists_url": "https://api.github.com/users/ogoffart/gists{/gist_id}", "starred_url": "https://api.github.com/users/ogoffart/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ogoffart/subscriptions", "organizations_url": "https://api.github.com/users/ogoffart/orgs", "repos_url": "https://api.github.com/users/ogoffart/repos", "events_url": "https://api.github.com/users/ogoffart/events{/privacy}", "received_events_url": "https://api.github.com/users/ogoffart/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "e98925f693e27eed776eb7ee8191003a97981d21", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e98925f693e27eed776eb7ee8191003a97981d21", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e98925f693e27eed776eb7ee8191003a97981d21"}], "stats": {"total": 28, "additions": 23, "deletions": 5}, "files": [{"sha": "27c8b70924752c479e6932038cb62cd485d906f1", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ec3ebf4556b47fae3d51c12e0d8f115302d8ef15/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ec3ebf4556b47fae3d51c12e0d8f115302d8ef15/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=ec3ebf4556b47fae3d51c12e0d8f115302d8ef15", "patch": "@@ -1,3 +1,9 @@\n+2011-11-04  Olivier Goffart  <olivier@woboq.com>\n+\t    Jason Merrill  <jason@redhat.com>\n+\n+\tPR c++/50965\n+\t* class.c (check_field_decls): NSDMI makes a class non-aggregate.\n+\n 2011-11-04  Paolo Carlini  <paolo.carlini@oracle.com>\n \n \tPR c++/48420"}, {"sha": "1775868aa8ad496e68a6096911b665210585041c", "filename": "gcc/cp/class.c", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ec3ebf4556b47fae3d51c12e0d8f115302d8ef15/gcc%2Fcp%2Fclass.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ec3ebf4556b47fae3d51c12e0d8f115302d8ef15/gcc%2Fcp%2Fclass.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fclass.c?ref=ec3ebf4556b47fae3d51c12e0d8f115302d8ef15", "patch": "@@ -3189,6 +3189,12 @@ check_field_decls (tree t, tree *access_decls,\n \t\t\t  no_const_asn_ref_p,\n \t\t\t  &any_default_members);\n \n+      /* Now that we've removed bit-field widths from DECL_INITIAL,\n+\t anything left in DECL_INITIAL is an NSDMI that makes the class\n+\t non-aggregate.  */\n+      if (DECL_INITIAL (x))\n+\tCLASSTYPE_NON_AGGREGATE (t) = true;\n+\n       /* If any field is const, the structure type is pseudo-const.  */\n       if (CP_TYPE_CONST_P (type))\n \t{"}, {"sha": "c941abc1a55a7b375350cf88089319a3bd804690", "filename": "gcc/cp/cp-tree.h", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ec3ebf4556b47fae3d51c12e0d8f115302d8ef15/gcc%2Fcp%2Fcp-tree.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ec3ebf4556b47fae3d51c12e0d8f115302d8ef15/gcc%2Fcp%2Fcp-tree.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fcp-tree.h?ref=ec3ebf4556b47fae3d51c12e0d8f115302d8ef15", "patch": "@@ -3205,8 +3205,9 @@ more_aggr_init_expr_args_p (const aggr_init_expr_arg_iterator *iter)\n \n /* [dcl.init.aggr]\n \n-   An aggregate is an array or a class with no user-declared\n-   constructors, no private or protected non-static data members, no\n+   An aggregate is an array or a class with no user-provided\n+   constructors, no brace-or-equal-initializers for non-static data\n+   members, no private or protected non-static data members, no\n    base classes, and no virtual functions.\n \n    As an extension, we also treat vectors as aggregates.  Keep these"}, {"sha": "c9bd2480833970c980464e7dafac889172a3b132", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ec3ebf4556b47fae3d51c12e0d8f115302d8ef15/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ec3ebf4556b47fae3d51c12e0d8f115302d8ef15/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=ec3ebf4556b47fae3d51c12e0d8f115302d8ef15", "patch": "@@ -1,3 +1,8 @@\n+2011-11-04  Olivier Goffart  <olivier@woboq.com>\n+\n+\tPR c++/50965\n+\t* g++.dg/cpp0x/nsdmi1.C: Add more cases.\n+\n 2011-11-04  Jiangning Liu  <jiangning.liu@arm.com>\n \n \tPR rtl-optimization/38644"}, {"sha": "159c16de851791208295893d1efd4b1de8e7a772", "filename": "gcc/testsuite/g++.dg/cpp0x/nsdmi1.C", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ec3ebf4556b47fae3d51c12e0d8f115302d8ef15/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fnsdmi1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ec3ebf4556b47fae3d51c12e0d8f115302d8ef15/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fnsdmi1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fnsdmi1.C?ref=ec3ebf4556b47fae3d51c12e0d8f115302d8ef15", "patch": "@@ -31,8 +31,8 @@ int main()\n {\n   A a1;\n   if (a1.i != 42) return 1;\n-  A a2 = { 24 };\n-  if (a2.i != 24) return 2;\n+  A a2{};\n+  if (a2.i != 42) return 2;\n   A a3[1];\n   if (a3[0].i != 42) return 3;\n \n@@ -43,7 +43,7 @@ int main()\n \n   C<int,3> c1;\n   if (c1.m != 3) return 5;\n-  C<int,3> c2 { 5 };\n+  C<int,5> c2 {};\n   if (c2.m != 5) return 6;\n \n   D<int,3> d1;"}]}