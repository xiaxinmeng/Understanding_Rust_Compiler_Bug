{"sha": "85d7b5d5c5b7d1f104ed4dc2715161af433dc623", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODVkN2I1ZDVjNWI3ZDFmMTA0ZWQ0ZGMyNzE1MTYxYWY0MzNkYzYyMw==", "commit": {"author": {"name": "Ian Lance Taylor", "email": "iant@google.com", "date": "2015-01-15T21:10:09Z"}, "committer": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2015-01-15T21:10:09Z"}, "message": "configure.ac: Check for networking libraries; see NET_LIBS.\n\n\t* configure.ac: Check for networking libraries; see NET_LIBS.\n\t* Makefile.am (go$(EXEEXT)): Link against NET_LIBS.\n\t(gofmt$(EXEEXT), cgo$(EXEEXT)): Likewise.\n\t* configure, Makefile.in: Rebuild.\n\nFrom-SVN: r219690", "tree": {"sha": "d7791736c11d37fedba56b5a8151135228f45634", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d7791736c11d37fedba56b5a8151135228f45634"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/85d7b5d5c5b7d1f104ed4dc2715161af433dc623", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/85d7b5d5c5b7d1f104ed4dc2715161af433dc623", "html_url": "https://github.com/Rust-GCC/gccrs/commit/85d7b5d5c5b7d1f104ed4dc2715161af433dc623", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/85d7b5d5c5b7d1f104ed4dc2715161af433dc623/comments", "author": null, "committer": null, "parents": [{"sha": "199b7a3586061f951fa737656217206164456910", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/199b7a3586061f951fa737656217206164456910", "html_url": "https://github.com/Rust-GCC/gccrs/commit/199b7a3586061f951fa737656217206164456910"}], "stats": {"total": 283, "additions": 277, "deletions": 6}, "files": [{"sha": "5746d2c725fce3f096e6dcaf72a2a93e04ec7233", "filename": "gotools/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/85d7b5d5c5b7d1f104ed4dc2715161af433dc623/gotools%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/85d7b5d5c5b7d1f104ed4dc2715161af433dc623/gotools%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gotools%2FChangeLog?ref=85d7b5d5c5b7d1f104ed4dc2715161af433dc623", "patch": "@@ -1,3 +1,10 @@\n+2015-01-15  Ian Lance Taylor  <iant@google.com>\n+\n+\t* configure.ac: Check for networking libraries; see NET_LIBS.\n+\t* Makefile.am (go$(EXEEXT)): Link against NET_LIBS.\n+\t(gofmt$(EXEEXT), cgo$(EXEEXT)): Likewise.\n+\t* configure, Makefile.in: Rebuild.\n+\n 2015-01-14  Ian Lance Taylor  <iant@google.com>\n \n \t* Makefile.am (go_cmd_go_files): Sort entries.  Add generate.go."}, {"sha": "41802efb89177bf1faa0ab4352d4101872badbd8", "filename": "gotools/Makefile.am", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/85d7b5d5c5b7d1f104ed4dc2715161af433dc623/gotools%2FMakefile.am", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/85d7b5d5c5b7d1f104ed4dc2715161af433dc623/gotools%2FMakefile.am", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gotools%2FMakefile.am?ref=85d7b5d5c5b7d1f104ed4dc2715161af433dc623", "patch": "@@ -108,11 +108,11 @@ bin_PROGRAMS = go$(EXEEXT) gofmt$(EXEEXT)\n libexecsub_PROGRAMS = cgo$(EXEEXT)\n \n go$(EXEEXT): $(go_cmd_go_files) zdefaultcc.go $(LIBGODEP)\n-\t$(GOLINK) $(go_cmd_go_files) zdefaultcc.go\n+\t$(GOLINK) $(go_cmd_go_files) zdefaultcc.go $(NET_LIBS)\n gofmt$(EXEEXT): $(go_cmd_gofmt_files) $(LIBGODEP)\n-\t$(GOLINK) $(go_cmd_gofmt_files)\n+\t$(GOLINK) $(go_cmd_gofmt_files) $(NET_LIBS)\n cgo$(EXEEXT): $(go_cmd_cgo_files) zdefaultcc.go $(LIBGODEP)\n-\t$(GOLINK) $(go_cmd_cgo_files) zdefaultcc.go\n+\t$(GOLINK) $(go_cmd_cgo_files) zdefaultcc.go $(NET_LIBS)\n \n else\n "}, {"sha": "295c68d984461bae88707d8c0e4108128718f825", "filename": "gotools/Makefile.in", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/85d7b5d5c5b7d1f104ed4dc2715161af433dc623/gotools%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/85d7b5d5c5b7d1f104ed4dc2715161af433dc623/gotools%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gotools%2FMakefile.in?ref=85d7b5d5c5b7d1f104ed4dc2715161af433dc623", "patch": "@@ -122,6 +122,7 @@ LTLIBOBJS = @LTLIBOBJS@\n MAINT = @MAINT@\n MAKEINFO = @MAKEINFO@\n MKDIR_P = @MKDIR_P@\n+NET_LIBS = @NET_LIBS@\n OBJEXT = @OBJEXT@\n PACKAGE = @PACKAGE@\n PACKAGE_BUGREPORT = @PACKAGE_BUGREPORT@\n@@ -589,11 +590,11 @@ s-zdefaultcc: Makefile\n \t$(STAMP) $@ \n \n @NATIVE_TRUE@go$(EXEEXT): $(go_cmd_go_files) zdefaultcc.go $(LIBGODEP)\n-@NATIVE_TRUE@\t$(GOLINK) $(go_cmd_go_files) zdefaultcc.go\n+@NATIVE_TRUE@\t$(GOLINK) $(go_cmd_go_files) zdefaultcc.go $(NET_LIBS)\n @NATIVE_TRUE@gofmt$(EXEEXT): $(go_cmd_gofmt_files) $(LIBGODEP)\n-@NATIVE_TRUE@\t$(GOLINK) $(go_cmd_gofmt_files)\n+@NATIVE_TRUE@\t$(GOLINK) $(go_cmd_gofmt_files) $(NET_LIBS)\n @NATIVE_TRUE@cgo$(EXEEXT): $(go_cmd_cgo_files) zdefaultcc.go $(LIBGODEP)\n-@NATIVE_TRUE@\t$(GOLINK) $(go_cmd_cgo_files) zdefaultcc.go\n+@NATIVE_TRUE@\t$(GOLINK) $(go_cmd_cgo_files) zdefaultcc.go $(NET_LIBS)\n \n # For a non-native build we have to build the programs using a\n # previously built host (or build -> host) Go compiler.  We should"}, {"sha": "bc9332e1ed2862af638fdc1fa79d18018df23ae3", "filename": "gotools/configure", "status": "modified", "additions": 232, "deletions": 0, "changes": 232, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/85d7b5d5c5b7d1f104ed4dc2715161af433dc623/gotools%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/85d7b5d5c5b7d1f104ed4dc2715161af433dc623/gotools%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gotools%2Fconfigure?ref=85d7b5d5c5b7d1f104ed4dc2715161af433dc623", "patch": "@@ -555,6 +555,7 @@ ac_subst_vars='am__EXEEXT_FALSE\n am__EXEEXT_TRUE\n LTLIBOBJS\n LIBOBJS\n+NET_LIBS\n NATIVE_FALSE\n NATIVE_TRUE\n GOCFLAGS\n@@ -1423,6 +1424,119 @@ fi\n   return $ac_retval\n \n } # ac_fn_c_try_compile\n+\n+# ac_fn_c_try_link LINENO\n+# -----------------------\n+# Try to link conftest.$ac_ext, and return whether this succeeded.\n+ac_fn_c_try_link ()\n+{\n+  as_lineno=${as_lineno-\"$1\"} as_lineno_stack=as_lineno_stack=$as_lineno_stack\n+  rm -f conftest.$ac_objext conftest$ac_exeext\n+  if { { ac_try=\"$ac_link\"\n+case \"(($ac_try\" in\n+  *\\\"* | *\\`* | *\\\\*) ac_try_echo=\\$ac_try;;\n+  *) ac_try_echo=$ac_try;;\n+esac\n+eval ac_try_echo=\"\\\"\\$as_me:${as_lineno-$LINENO}: $ac_try_echo\\\"\"\n+$as_echo \"$ac_try_echo\"; } >&5\n+  (eval \"$ac_link\") 2>conftest.err\n+  ac_status=$?\n+  if test -s conftest.err; then\n+    grep -v '^ *+' conftest.err >conftest.er1\n+    cat conftest.er1 >&5\n+    mv -f conftest.er1 conftest.err\n+  fi\n+  $as_echo \"$as_me:${as_lineno-$LINENO}: \\$? = $ac_status\" >&5\n+  test $ac_status = 0; } && {\n+\t test -z \"$ac_c_werror_flag\" ||\n+\t test ! -s conftest.err\n+       } && test -s conftest$ac_exeext && {\n+\t test \"$cross_compiling\" = yes ||\n+\t $as_test_x conftest$ac_exeext\n+       }; then :\n+  ac_retval=0\n+else\n+  $as_echo \"$as_me: failed program was:\" >&5\n+sed 's/^/| /' conftest.$ac_ext >&5\n+\n+\tac_retval=1\n+fi\n+  # Delete the IPA/IPO (Inter Procedural Analysis/Optimization) information\n+  # created by the PGI compiler (conftest_ipa8_conftest.oo), as it would\n+  # interfere with the next link command; also delete a directory that is\n+  # left behind by Apple's compiler.  We do this before executing the actions.\n+  rm -rf conftest.dSYM conftest_ipa8_conftest.oo\n+  eval $as_lineno_stack; test \"x$as_lineno_stack\" = x && { as_lineno=; unset as_lineno;}\n+  return $ac_retval\n+\n+} # ac_fn_c_try_link\n+\n+# ac_fn_c_check_func LINENO FUNC VAR\n+# ----------------------------------\n+# Tests whether FUNC exists, setting the cache variable VAR accordingly\n+ac_fn_c_check_func ()\n+{\n+  as_lineno=${as_lineno-\"$1\"} as_lineno_stack=as_lineno_stack=$as_lineno_stack\n+  { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for $2\" >&5\n+$as_echo_n \"checking for $2... \" >&6; }\n+if { as_var=$3; eval \"test \\\"\\${$as_var+set}\\\" = set\"; }; then :\n+  $as_echo_n \"(cached) \" >&6\n+else\n+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n+/* end confdefs.h.  */\n+/* Define $2 to an innocuous variant, in case <limits.h> declares $2.\n+   For example, HP-UX 11i <limits.h> declares gettimeofday.  */\n+#define $2 innocuous_$2\n+\n+/* System header to define __stub macros and hopefully few prototypes,\n+    which can conflict with char $2 (); below.\n+    Prefer <limits.h> to <assert.h> if __STDC__ is defined, since\n+    <limits.h> exists even on freestanding compilers.  */\n+\n+#ifdef __STDC__\n+# include <limits.h>\n+#else\n+# include <assert.h>\n+#endif\n+\n+#undef $2\n+\n+/* Override any GCC internal prototype to avoid an error.\n+   Use char because int might match the return type of a GCC\n+   builtin and then its argument prototype would still apply.  */\n+#ifdef __cplusplus\n+extern \"C\"\n+#endif\n+char $2 ();\n+/* The GNU C library defines this for functions which it implements\n+    to always fail with ENOSYS.  Some functions are actually named\n+    something starting with __ and the normal name is an alias.  */\n+#if defined __stub_$2 || defined __stub___$2\n+choke me\n+#endif\n+\n+int\n+main ()\n+{\n+return $2 ();\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+if ac_fn_c_try_link \"$LINENO\"; then :\n+  eval \"$3=yes\"\n+else\n+  eval \"$3=no\"\n+fi\n+rm -f core conftest.err conftest.$ac_objext \\\n+    conftest$ac_exeext conftest.$ac_ext\n+fi\n+eval ac_res=\\$$3\n+\t       { $as_echo \"$as_me:${as_lineno-$LINENO}: result: $ac_res\" >&5\n+$as_echo \"$ac_res\" >&6; }\n+  eval $as_lineno_stack; test \"x$as_lineno_stack\" = x && { as_lineno=; unset as_lineno;}\n+\n+} # ac_fn_c_check_func\n cat >config.log <<_ACEOF\n This file contains any messages produced by compilers while\n running configure, to aid debugging if configure makes a mistake.\n@@ -3675,6 +3789,124 @@ else\n fi\n \n \n+\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: checking for socket libraries\" >&5\n+$as_echo_n \"checking for socket libraries... \" >&6; }\n+if test \"${gotools_cv_lib_sockets+set}\" = set; then :\n+  $as_echo_n \"(cached) \" >&6\n+else\n+  gotools_cv_lib_sockets=\n+   gotools_check_both=no\n+   ac_fn_c_check_func \"$LINENO\" \"connect\" \"ac_cv_func_connect\"\n+if test \"x$ac_cv_func_connect\" = x\"\"yes; then :\n+  gotools_check_socket=no\n+else\n+  gotools_check_socket=yes\n+fi\n+\n+   if test \"$gotools_check_socket\" = \"yes\"; then\n+     unset ac_cv_func_connect\n+     { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for main in -lsocket\" >&5\n+$as_echo_n \"checking for main in -lsocket... \" >&6; }\n+if test \"${ac_cv_lib_socket_main+set}\" = set; then :\n+  $as_echo_n \"(cached) \" >&6\n+else\n+  ac_check_lib_save_LIBS=$LIBS\n+LIBS=\"-lsocket  $LIBS\"\n+cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n+/* end confdefs.h.  */\n+\n+\n+int\n+main ()\n+{\n+return main ();\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+if ac_fn_c_try_link \"$LINENO\"; then :\n+  ac_cv_lib_socket_main=yes\n+else\n+  ac_cv_lib_socket_main=no\n+fi\n+rm -f core conftest.err conftest.$ac_objext \\\n+    conftest$ac_exeext conftest.$ac_ext\n+LIBS=$ac_check_lib_save_LIBS\n+fi\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_socket_main\" >&5\n+$as_echo \"$ac_cv_lib_socket_main\" >&6; }\n+if test \"x$ac_cv_lib_socket_main\" = x\"\"yes; then :\n+  gotools_cv_lib_sockets=\"-lsocket\"\n+else\n+  gotools_check_both=yes\n+fi\n+\n+   fi\n+   if test \"$gotools_check_both\" = \"yes\"; then\n+     gotools_old_libs=$LIBS\n+     LIBS=\"$LIBS -lsocket -lnsl\"\n+     unset ac_cv_func_accept\n+     ac_fn_c_check_func \"$LINENO\" \"accept\" \"ac_cv_func_accept\"\n+if test \"x$ac_cv_func_accept\" = x\"\"yes; then :\n+  gotools_check_nsl=no\n+\t\t    gotools_cv_lib_sockets=\"-lsocket -lnsl\"\n+fi\n+\n+     unset ac_cv_func_accept\n+     LIBS=$gotools_old_libs\n+   fi\n+   unset ac_cv_func_gethostbyname\n+   gotools_old_libs=\"$LIBS\"\n+   ac_fn_c_check_func \"$LINENO\" \"gethostbyname\" \"ac_cv_func_gethostbyname\"\n+if test \"x$ac_cv_func_gethostbyname\" = x\"\"yes; then :\n+\n+else\n+  { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for main in -lnsl\" >&5\n+$as_echo_n \"checking for main in -lnsl... \" >&6; }\n+if test \"${ac_cv_lib_nsl_main+set}\" = set; then :\n+  $as_echo_n \"(cached) \" >&6\n+else\n+  ac_check_lib_save_LIBS=$LIBS\n+LIBS=\"-lnsl  $LIBS\"\n+cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n+/* end confdefs.h.  */\n+\n+\n+int\n+main ()\n+{\n+return main ();\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+if ac_fn_c_try_link \"$LINENO\"; then :\n+  ac_cv_lib_nsl_main=yes\n+else\n+  ac_cv_lib_nsl_main=no\n+fi\n+rm -f core conftest.err conftest.$ac_objext \\\n+    conftest$ac_exeext conftest.$ac_ext\n+LIBS=$ac_check_lib_save_LIBS\n+fi\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_nsl_main\" >&5\n+$as_echo \"$ac_cv_lib_nsl_main\" >&6; }\n+if test \"x$ac_cv_lib_nsl_main\" = x\"\"yes; then :\n+  gotools_cv_lib_sockets=\"$gotools_cv_lib_sockets -lnsl\"\n+fi\n+\n+fi\n+\n+   unset ac_cv_func_gethostbyname\n+   LIBS=$gotools_old_libs\n+\n+fi\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $gotools_cv_lib_sockets\" >&5\n+$as_echo \"$gotools_cv_lib_sockets\" >&6; }\n+NET_LIBS=\"$gotools_cv_lib_sockets\"\n+\n+\n ac_config_files=\"$ac_config_files Makefile\"\n \n "}, {"sha": "24f4498d27900bfcff38533ee5ded95e7b2e207d", "filename": "gotools/configure.ac", "status": "modified", "additions": 31, "deletions": 0, "changes": 31, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/85d7b5d5c5b7d1f104ed4dc2715161af433dc623/gotools%2Fconfigure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/85d7b5d5c5b7d1f104ed4dc2715161af433dc623/gotools%2Fconfigure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gotools%2Fconfigure.ac?ref=85d7b5d5c5b7d1f104ed4dc2715161af433dc623", "patch": "@@ -48,6 +48,37 @@ AC_PROG_GO\n \n AM_CONDITIONAL(NATIVE, test \"$cross_compiling\" = no)\n \n+dnl Test for -lsocket and -lnsl.  Copied from libjava/configure.ac.\n+AC_CACHE_CHECK([for socket libraries], gotools_cv_lib_sockets,\n+  [gotools_cv_lib_sockets=\n+   gotools_check_both=no\n+   AC_CHECK_FUNC(connect, gotools_check_socket=no, gotools_check_socket=yes)\n+   if test \"$gotools_check_socket\" = \"yes\"; then\n+     unset ac_cv_func_connect\n+     AC_CHECK_LIB(socket, main, gotools_cv_lib_sockets=\"-lsocket\",\n+     \t\t  gotools_check_both=yes)\n+   fi\n+   if test \"$gotools_check_both\" = \"yes\"; then\n+     gotools_old_libs=$LIBS\n+     LIBS=\"$LIBS -lsocket -lnsl\"\n+     unset ac_cv_func_accept\n+     AC_CHECK_FUNC(accept,\n+\t\t   [gotools_check_nsl=no\n+\t\t    gotools_cv_lib_sockets=\"-lsocket -lnsl\"])\n+     unset ac_cv_func_accept\n+     LIBS=$gotools_old_libs\n+   fi\n+   unset ac_cv_func_gethostbyname\n+   gotools_old_libs=\"$LIBS\"\n+   AC_CHECK_FUNC(gethostbyname, ,\n+\t\t [AC_CHECK_LIB(nsl, main,\n+\t\t \t[gotools_cv_lib_sockets=\"$gotools_cv_lib_sockets -lnsl\"])])\n+   unset ac_cv_func_gethostbyname\n+   LIBS=$gotools_old_libs\n+])\n+NET_LIBS=\"$gotools_cv_lib_sockets\"\n+AC_SUBST(NET_LIBS)\n+\n AC_CONFIG_FILES(Makefile)\n \n AC_OUTPUT"}]}