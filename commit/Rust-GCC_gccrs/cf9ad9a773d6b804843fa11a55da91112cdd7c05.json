{"sha": "cf9ad9a773d6b804843fa11a55da91112cdd7c05", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Y2Y5YWQ5YTc3M2Q2YjgwNDg0M2ZhMTFhNTVkYTkxMTEyY2RkN2MwNQ==", "commit": {"author": {"name": "Mark Mitchell", "email": "mark@codesourcery.com", "date": "2003-09-07T23:48:33Z"}, "committer": {"name": "Mark Mitchell", "email": "mmitchel@gcc.gnu.org", "date": "2003-09-07T23:48:33Z"}, "message": "re PR c++/11852 (ICE: g++ with bad struct initializer.)\n\n\tPR c++/11852\n\t* varasm.c (initializer_constant_valid_p): Correct logic for\n\tCONSTRUCTORs.\n\n\tPR c++/11852\n\t* g++.dg/init/struct1.C: New test.\n\nFrom-SVN: r71187", "tree": {"sha": "4f5bca36819c0c2c172a2b3ec1aa934de5c312d6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4f5bca36819c0c2c172a2b3ec1aa934de5c312d6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/cf9ad9a773d6b804843fa11a55da91112cdd7c05", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cf9ad9a773d6b804843fa11a55da91112cdd7c05", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cf9ad9a773d6b804843fa11a55da91112cdd7c05", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cf9ad9a773d6b804843fa11a55da91112cdd7c05/comments", "author": null, "committer": null, "parents": [{"sha": "6ef0aa7b3b2d120b33b7852e6377c5536a677e6c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6ef0aa7b3b2d120b33b7852e6377c5536a677e6c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6ef0aa7b3b2d120b33b7852e6377c5536a677e6c"}], "stats": {"total": 41, "additions": 37, "deletions": 4}, "files": [{"sha": "edd91eb9af1c96f3e93599619ef49d50aeb5cd9b", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cf9ad9a773d6b804843fa11a55da91112cdd7c05/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cf9ad9a773d6b804843fa11a55da91112cdd7c05/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=cf9ad9a773d6b804843fa11a55da91112cdd7c05", "patch": "@@ -1,3 +1,9 @@\n+2003-09-07  Mark Mitchell  <mark@codesourcery.com>\n+\n+\tPR c++/11852\n+\t* varasm.c (initializer_constant_valid_p): Correct logic for\n+\tCONSTRUCTORs.\n+\n 2003-09-07  Roger Sayle  <roger@eyesopen.com>\n \n \t* expr.c (expand_operands): New function to expand an operand pair."}, {"sha": "a88421b332ea9bbe6a5c69ce71808fd8a1269810", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cf9ad9a773d6b804843fa11a55da91112cdd7c05/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cf9ad9a773d6b804843fa11a55da91112cdd7c05/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=cf9ad9a773d6b804843fa11a55da91112cdd7c05", "patch": "@@ -1,3 +1,8 @@\n+2003-09-07  Mark Mitchell  <mark@codesourcery.com>\n+\n+\tPR c++/11852\n+\t* g++.dg/init/struct1.C: New test.\n+\n 2003-09-07  Mark Mitchell  <mark@codesourcery.com>\n \n \tPR c++/12181"}, {"sha": "4cabc99e0e233d57cdde433bbe40094981299082", "filename": "gcc/testsuite/g++.dg/init/struct1.C", "status": "added", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cf9ad9a773d6b804843fa11a55da91112cdd7c05/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Finit%2Fstruct1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cf9ad9a773d6b804843fa11a55da91112cdd7c05/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Finit%2Fstruct1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Finit%2Fstruct1.C?ref=cf9ad9a773d6b804843fa11a55da91112cdd7c05", "patch": "@@ -0,0 +1,6 @@\n+struct bug {\n+  const char *name;\n+  unsigned long type;\n+};\n+\n+struct bug s = { 0, (unsigned long) &s | 1 };"}, {"sha": "84fbf259baf7c34f031dd169501ccc2291b8f6eb", "filename": "gcc/varasm.c", "status": "modified", "additions": 20, "deletions": 4, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cf9ad9a773d6b804843fa11a55da91112cdd7c05/gcc%2Fvarasm.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cf9ad9a773d6b804843fa11a55da91112cdd7c05/gcc%2Fvarasm.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fvarasm.c?ref=cf9ad9a773d6b804843fa11a55da91112cdd7c05", "patch": "@@ -3476,11 +3476,27 @@ initializer_constant_valid_p (tree value, tree endtype)\n \t   || TREE_CODE (TREE_TYPE (value)) == RECORD_TYPE)\n \t  && TREE_CONSTANT (value)\n \t  && CONSTRUCTOR_ELTS (value))\n-\treturn\n-\t  initializer_constant_valid_p (TREE_VALUE (CONSTRUCTOR_ELTS (value)),\n-\t\t\t\t\tendtype);\n+\t{\n+\t  tree elt;\n+\t  bool absolute = true;\n+\n+\t  for (elt = CONSTRUCTOR_ELTS (value); elt; elt = TREE_CHAIN (elt))\n+\t    {\n+\t      tree reloc;\n+\t      value = TREE_VALUE (elt);\n+\t      reloc = initializer_constant_valid_p (value, TREE_TYPE (value));\n+\t      if (!reloc)\n+\t\treturn NULL_TREE;\n+\t      if (reloc != null_pointer_node)\n+\t\tabsolute = false;\n+\t    }\n+\t  /* For a non-absolute relocation, there is no single\n+\t     variable that can be \"the variable that determines the\n+\t     relocation.\"  */\n+\t  return absolute ? null_pointer_node : error_mark_node;\n+\t}\n \n-      return TREE_STATIC (value) ? null_pointer_node : 0;\n+      return TREE_STATIC (value) ? null_pointer_node : NULL_TREE;\n \n     case INTEGER_CST:\n     case VECTOR_CST:"}]}