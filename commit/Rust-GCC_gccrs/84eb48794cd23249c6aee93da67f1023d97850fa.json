{"sha": "84eb48794cd23249c6aee93da67f1023d97850fa", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODRlYjQ4Nzk0Y2QyMzI0OWM2YWVlOTNkYTY3ZjEwMjNkOTc4NTBmYQ==", "commit": {"author": {"name": "Paolo Carlini", "email": "pcarlini@unitus.it", "date": "2002-03-05T12:09:45Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2002-03-05T12:09:45Z"}, "message": "2002-03-05  Paolo Carlini  <pcarlini@unitus.it>\n\n\tlibstdc++/5816\n\t* include/bits/locale_facets.tcc\n\t(num_get::_M_extract_float): Fix the parsing of __dec, since\n\tthe standard prescribes that if no grouping characters are\n\tseen, no grouping check is applied.\n        * testsuite/22_locale/num_get_members_char.cc: Add test05\n\tdistilled from the PR.\n        * testsuite/22_locale/num_get_members_wchar_t.cc: Ditto.\n\nFrom-SVN: r50317", "tree": {"sha": "1cded21c99c3d2386712c2039ec57076f9019cb7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1cded21c99c3d2386712c2039ec57076f9019cb7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/84eb48794cd23249c6aee93da67f1023d97850fa", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/84eb48794cd23249c6aee93da67f1023d97850fa", "html_url": "https://github.com/Rust-GCC/gccrs/commit/84eb48794cd23249c6aee93da67f1023d97850fa", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/84eb48794cd23249c6aee93da67f1023d97850fa/comments", "author": null, "committer": null, "parents": [{"sha": "170c56da73fb503fb9ae28de8b66bf96fc38f4bf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/170c56da73fb503fb9ae28de8b66bf96fc38f4bf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/170c56da73fb503fb9ae28de8b66bf96fc38f4bf"}], "stats": {"total": 65, "additions": 63, "deletions": 2}, "files": [{"sha": "fe2cca8526c97de0849d7e88746bc0b3b581e231", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/84eb48794cd23249c6aee93da67f1023d97850fa/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/84eb48794cd23249c6aee93da67f1023d97850fa/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=84eb48794cd23249c6aee93da67f1023d97850fa", "patch": "@@ -1,3 +1,14 @@\n+2002-03-05  Paolo Carlini  <pcarlini@unitus.it>\n+\n+\tlibstdc++/5816\n+\t* include/bits/locale_facets.tcc\n+\t(num_get::_M_extract_float): Fix the parsing of __dec, since\n+\tthe standard prescribes that if no grouping characters are\n+\tseen, no grouping check is applied.\n+\t* testsuite/22_locale/num_get_members_char.cc: Add test05\n+\tdistilled from the PR.\n+\t* testsuite/22_locale/num_get_members_wchar_t.cc: Ditto.\n+\n 2002-03-04  Craig Rodrigues  <rodrigc@gcc.gnu.org>\n \n \t* docs/html/17_intro/porting-howto.xml: Refer to "}, {"sha": "edee81472e38b6d2bbdec6adcb8a2adc87cc9ce8", "filename": "libstdc++-v3/include/bits/locale_facets.tcc", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/84eb48794cd23249c6aee93da67f1023d97850fa/libstdc%2B%2B-v3%2Finclude%2Fbits%2Flocale_facets.tcc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/84eb48794cd23249c6aee93da67f1023d97850fa/libstdc%2B%2B-v3%2Finclude%2Fbits%2Flocale_facets.tcc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Flocale_facets.tcc?ref=84eb48794cd23249c6aee93da67f1023d97850fa", "patch": "@@ -174,7 +174,11 @@ namespace std\n             }\n \t  else if (__c == __dec && !__found_dec)\n \t    {\n-\t      __found_grouping += static_cast<char>(__sep_pos);\n+\t      // According to the standard, if no grouping chars are seen,\n+\t      // no grouping check is applied. Therefore __found_grouping\n+\t      // must be adjusted only if __dec comes after some __sep.\n+\t      if (__found_grouping.size())\n+\t\t__found_grouping += static_cast<char>(__sep_pos);\n \t      ++__pos;\n \t      __xtrc += '.';\n \t      __c = *(++__beg);"}, {"sha": "5630351e2d538c7bf7fbf30c87eb96d785ab4bc5", "filename": "libstdc++-v3/testsuite/22_locale/num_get_members_char.cc", "status": "modified", "additions": 24, "deletions": 1, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/84eb48794cd23249c6aee93da67f1023d97850fa/libstdc%2B%2B-v3%2Ftestsuite%2F22_locale%2Fnum_get_members_char.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/84eb48794cd23249c6aee93da67f1023d97850fa/libstdc%2B%2B-v3%2Ftestsuite%2F22_locale%2Fnum_get_members_char.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F22_locale%2Fnum_get_members_char.cc?ref=84eb48794cd23249c6aee93da67f1023d97850fa", "patch": "@@ -343,7 +343,7 @@ void test04()\n \n   istringstream iss;\n \n-  // A locale that expects grouping\n+  // A locale that expects grouping  \n   locale loc_de(\"de_DE\");\n   iss.imbue(loc_de);\n \n@@ -390,12 +390,35 @@ void test04()\n   VERIFY( ul == 0776 );\n }\n \n+// libstdc++/5816\n+void test05()\n+{\n+  using namespace std;\n+ \n+  double d = 0.0;\n+\n+  istringstream iss;\n+  locale loc_de(\"de_DE\");\n+  iss.imbue(loc_de);\n+\n+  const num_get<char>& ng = use_facet<num_get<char> >(iss.getloc()); \n+  const ios_base::iostate goodbit = ios_base::goodbit;\n+  ios_base::iostate err = ios_base::goodbit;\n+\n+  iss.str(\"1234,5 \");\n+  err = goodbit;\n+  ng.get(iss.rdbuf(), 0, iss, err, d);\n+  VERIFY( err == goodbit );\n+  VERIFY( d == 1234.5 );\n+}\n+\n int main()\n {\n   test01();\n   test02();\n   test03();\n   test04();\n+  test05();\n   return 0;\n }\n "}, {"sha": "c4927e18fb714161a6ba6d4ec235176ddc6782dc", "filename": "libstdc++-v3/testsuite/22_locale/num_get_members_wchar_t.cc", "status": "modified", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/84eb48794cd23249c6aee93da67f1023d97850fa/libstdc%2B%2B-v3%2Ftestsuite%2F22_locale%2Fnum_get_members_wchar_t.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/84eb48794cd23249c6aee93da67f1023d97850fa/libstdc%2B%2B-v3%2Ftestsuite%2F22_locale%2Fnum_get_members_wchar_t.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F22_locale%2Fnum_get_members_wchar_t.cc?ref=84eb48794cd23249c6aee93da67f1023d97850fa", "patch": "@@ -391,6 +391,28 @@ void test04()\n   VERIFY( err == goodbit );\n   VERIFY( ul == 0776 );\n }\n+\n+// libstdc++/5816\n+void test05()\n+{\n+  using namespace std;\n+ \n+  double d = 0.0;\n+\n+  wistringstream iss;\n+  locale loc_de(\"de_DE\");\n+  iss.imbue(loc_de);\n+\n+  const num_get<wchar_t>& ng = use_facet<num_get<wchar_t> >(iss.getloc()); \n+  const ios_base::iostate goodbit = ios_base::goodbit;\n+  ios_base::iostate err = ios_base::goodbit;\n+\n+  iss.str(L\"1234,5 \");\n+  err = goodbit;\n+  ng.get(iss.rdbuf(), 0, iss, err, d);\n+  VERIFY( err == goodbit );\n+  VERIFY( d == 1234.5 );\n+}\n #endif\n \n int main()\n@@ -400,6 +422,7 @@ int main()\n   test02();\n   test03();\n   test04();\n+  test05();\n #endif\n   return 0;\n }"}]}