{"sha": "ccbca5e4aae1b8a064e50edf99e98732e8ef6deb", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Y2NiY2E1ZTRhYWUxYjhhMDY0ZTUwZWRmOTllOTg3MzJlOGVmNmRlYg==", "commit": {"author": {"name": "Alan Modra", "email": "amodra@gcc.gnu.org", "date": "2005-03-31T11:33:05Z"}, "committer": {"name": "Alan Modra", "email": "amodra@gcc.gnu.org", "date": "2005-03-31T11:33:05Z"}, "message": "re PR target/20611 (duplicate label for inlined function referencing TLS)\n\n\tPR target/20611\n\t* config/rs6000/rs6000.md (load_toc_v4_PIC_1b): Remove inline\n\tlabel operand.  Remove (use (unspec..)).  Don't emit a label on\n\tthe offset word.\n\t* config/rs6000/rs6000.c (rs6000_legitimize_tls_address): Don't\n\tgenerate inline label for load_toc_v4_PIC_1b.\n\t(rs6000_emit_load_toc_table): Likewise.\n\nFrom-SVN: r97313", "tree": {"sha": "3d68dc5c7748e492dbd50c7ad3edfa6ce19fb772", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3d68dc5c7748e492dbd50c7ad3edfa6ce19fb772"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ccbca5e4aae1b8a064e50edf99e98732e8ef6deb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ccbca5e4aae1b8a064e50edf99e98732e8ef6deb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ccbca5e4aae1b8a064e50edf99e98732e8ef6deb", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ccbca5e4aae1b8a064e50edf99e98732e8ef6deb/comments", "author": null, "committer": null, "parents": [{"sha": "2767f2589737cec8dfc56e416ccabab6239a73b4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2767f2589737cec8dfc56e416ccabab6239a73b4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2767f2589737cec8dfc56e416ccabab6239a73b4"}], "stats": {"total": 33, "additions": 16, "deletions": 17}, "files": [{"sha": "152d8e603ea2ff6f2fce7f6aeba024b67f7e0bb6", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ccbca5e4aae1b8a064e50edf99e98732e8ef6deb/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ccbca5e4aae1b8a064e50edf99e98732e8ef6deb/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=ccbca5e4aae1b8a064e50edf99e98732e8ef6deb", "patch": "@@ -1,6 +1,12 @@\n-2005-03-31 Mostafa Hagog <mustafa@il.ibm.com>\n+2005-03-31  Alan Modra  <amodra@bigpond.net.au>\n \n-        * testsuite/gcc.dg/20050330-1.c: New test.\n+\tPR target/20611\n+\t* config/rs6000/rs6000.md (load_toc_v4_PIC_1b): Remove inline\n+\tlabel operand.  Remove (use (unspec..)).  Don't emit a label on\n+\tthe offset word.\n+\t* config/rs6000/rs6000.c (rs6000_legitimize_tls_address): Don't\n+\tgenerate inline label for load_toc_v4_PIC_1b.\n+\t(rs6000_emit_load_toc_table): Likewise.\n \n 2005-03-31  Kazu Hirata  <kazu@cs.umass.edu>\n "}, {"sha": "95330733b098d002c03cb71300601e90b11007c6", "filename": "gcc/config/rs6000/rs6000.c", "status": "modified", "additions": 4, "deletions": 15, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ccbca5e4aae1b8a064e50edf99e98732e8ef6deb/gcc%2Fconfig%2Frs6000%2Frs6000.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ccbca5e4aae1b8a064e50edf99e98732e8ef6deb/gcc%2Fconfig%2Frs6000%2Frs6000.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.c?ref=ccbca5e4aae1b8a064e50edf99e98732e8ef6deb", "patch": "@@ -2809,21 +2809,16 @@ rs6000_legitimize_tls_address (rtx addr, enum tls_model model)\n \t\trs6000_emit_move (got, gsym, Pmode);\n \t      else\n \t\t{\n-\t\t  char buf[30];\n-\t\t  static int tls_got_labelno = 0;\n-\t\t  rtx tempLR, lab, tmp3, mem;\n+\t\t  rtx tempLR, tmp3, mem;\n \t\t  rtx first, last;\n \n-\t\t  ASM_GENERATE_INTERNAL_LABEL (buf, \"LTLS\", tls_got_labelno++);\n-\t\t  lab = gen_rtx_SYMBOL_REF (Pmode, ggc_strdup (buf));\n \t\t  tempLR = gen_reg_rtx (Pmode);\n \t\t  tmp1 = gen_reg_rtx (Pmode);\n \t\t  tmp2 = gen_reg_rtx (Pmode);\n \t\t  tmp3 = gen_reg_rtx (Pmode);\n \t\t  mem = gen_const_mem (Pmode, tmp1);\n \n-\t\t  first = emit_insn (gen_load_toc_v4_PIC_1b (tempLR, lab,\n-\t\t\t\t\t\t\t     gsym));\n+\t\t  first = emit_insn (gen_load_toc_v4_PIC_1b (tempLR, gsym));\n \t\t  emit_move_insn (tmp1, tempLR);\n \t\t  emit_move_insn (tmp2, mem);\n \t\t  emit_insn (gen_addsi3 (tmp3, tmp1, tmp2));\n@@ -12024,11 +12019,10 @@ rs6000_emit_load_toc_table (int fromprolog)\n       rtx temp0 = (fromprolog\n \t\t   ? gen_rtx_REG (Pmode, 0)\n \t\t   : gen_reg_rtx (Pmode));\n-      rtx symF;\n \n       if (fromprolog)\n \t{\n-\t  rtx symL;\n+\t  rtx symF, symL;\n \n \t  ASM_GENERATE_INTERNAL_LABEL (buf, \"LCF\", rs6000_pic_labelno);\n \t  symF = gen_rtx_SYMBOL_REF (Pmode, ggc_strdup (buf));\n@@ -12046,14 +12040,9 @@ rs6000_emit_load_toc_table (int fromprolog)\n       else\n \t{\n \t  rtx tocsym;\n-\t  static int reload_toc_labelno = 0;\n \n \t  tocsym = gen_rtx_SYMBOL_REF (Pmode, toc_label_name);\n-\n-\t  ASM_GENERATE_INTERNAL_LABEL (buf, \"LCG\", reload_toc_labelno++);\n-\t  symF = gen_rtx_SYMBOL_REF (Pmode, ggc_strdup (buf));\n-\n-\t  emit_insn (gen_load_toc_v4_PIC_1b (tempLR, symF, tocsym));\n+\t  emit_insn (gen_load_toc_v4_PIC_1b (tempLR, tocsym));\n \t  emit_move_insn (dest, tempLR);\n \t  emit_move_insn (temp0, gen_rtx_MEM (Pmode, dest));\n \t}"}, {"sha": "4d30efb3dae3296d0b9b21352a3f2319a55af919", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ccbca5e4aae1b8a064e50edf99e98732e8ef6deb/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ccbca5e4aae1b8a064e50edf99e98732e8ef6deb/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=ccbca5e4aae1b8a064e50edf99e98732e8ef6deb", "patch": "@@ -1,3 +1,7 @@\n+2005-03-31 Mostafa Hagog <mustafa@il.ibm.com>\n+\n+\t* gcc.dg/20050330-1.c: New test.\n+\n 2005-03-30  Devang Patel  <dpatel@apple.com>\n \n \t* g++.dg/tree-sra/ssa-sra-3.C: New test."}]}