{"sha": "54e07cf808c3b425cf916f42a2a95fcb7d917a6b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTRlMDdjZjgwOGMzYjQyNWNmOTE2ZjQyYTJhOTVmY2I3ZDkxN2E2Yg==", "commit": {"author": {"name": "John David Anglin", "email": "dave.anglin@nrc-cnrc.gc.ca", "date": "2010-11-26T04:09:25Z"}, "committer": {"name": "John David Anglin", "email": "danglin@gcc.gnu.org", "date": "2010-11-26T04:09:25Z"}, "message": "pa.md (negdf2): Condition on !flag_signed_zeros instead of flag_unsafe_math_optimizations.\n\n\t* config/pa/pa.md (negdf2): Condition on !flag_signed_zeros instead of\n\tflag_unsafe_math_optimizations.\n\t(negsf2): Likewise.\n\tMove fnegabs related patterns together.  Only use fmpynfadd instruction\n\tto negate a multiply if !flag_signed_zeros is true.\n\nFrom-SVN: r167159", "tree": {"sha": "c03024eb8d64ed17936c90bc921938d1715a1802", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c03024eb8d64ed17936c90bc921938d1715a1802"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/54e07cf808c3b425cf916f42a2a95fcb7d917a6b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/54e07cf808c3b425cf916f42a2a95fcb7d917a6b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/54e07cf808c3b425cf916f42a2a95fcb7d917a6b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/54e07cf808c3b425cf916f42a2a95fcb7d917a6b/comments", "author": null, "committer": null, "parents": [{"sha": "964db68a6f8a5a90e30be404471fa70954f29e11", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/964db68a6f8a5a90e30be404471fa70954f29e11", "html_url": "https://github.com/Rust-GCC/gccrs/commit/964db68a6f8a5a90e30be404471fa70954f29e11"}], "stats": {"total": 103, "additions": 55, "deletions": 48}, "files": [{"sha": "d4ee580c6c333c5802a4da5893faf0785706af3d", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/54e07cf808c3b425cf916f42a2a95fcb7d917a6b/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/54e07cf808c3b425cf916f42a2a95fcb7d917a6b/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=54e07cf808c3b425cf916f42a2a95fcb7d917a6b", "patch": "@@ -1,3 +1,11 @@\n+2010-11-25  John David Anglin  <dave.anglin@nrc-cnrc.gc.ca>\n+\n+\t* config/pa/pa.md (negdf2): Condition on !flag_signed_zeros instead of\n+\tflag_unsafe_math_optimizations.\n+\t(negsf2): Likewise.\n+\tMove fnegabs related patterns together.  Only use fmpynfadd instruction\n+\tto negate a multiply if !flag_signed_zeros is true.\n+\n 2010-11-25  Uros Bizjak  <ubizjak@gmail.com>\n \n \t* gengtype-state.c (read_state_structures): Initialize \"previous\"."}, {"sha": "1ac18ec0d35fe04691fed5d866a77e6c6ffa2394", "filename": "gcc/config/pa/pa.md", "status": "modified", "additions": 47, "deletions": 48, "changes": 95, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/54e07cf808c3b425cf916f42a2a95fcb7d917a6b/gcc%2Fconfig%2Fpa%2Fpa.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/54e07cf808c3b425cf916f42a2a95fcb7d917a6b/gcc%2Fconfig%2Fpa%2Fpa.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fpa%2Fpa.md?ref=54e07cf808c3b425cf916f42a2a95fcb7d917a6b", "patch": "@@ -5982,7 +5982,7 @@\n \t(neg:DF (match_operand:DF 1 \"register_operand\" \"\")))]\n   \"!TARGET_SOFT_FLOAT\"\n {\n-  if (TARGET_PA_20 || flag_unsafe_math_optimizations)\n+  if (TARGET_PA_20 || !flag_signed_zeros)\n     emit_insn (gen_negdf2_fast (operands[0], operands[1]));\n   else\n     emit_insn (gen_negdf2_slow (operands[0], operands[1]));\n@@ -6026,7 +6026,7 @@\n \t(neg:SF (match_operand:SF 1 \"register_operand\" \"\")))]\n   \"!TARGET_SOFT_FLOAT\"\n {\n-  if (TARGET_PA_20 || flag_unsafe_math_optimizations)\n+  if (TARGET_PA_20 || !flag_signed_zeros)\n     emit_insn (gen_negsf2_fast (operands[0], operands[1]));\n   else\n     emit_insn (gen_negsf2_slow (operands[0], operands[1]));\n@@ -6148,14 +6148,51 @@\n   [(set_attr \"type\" \"fpalu\")\n    (set_attr \"length\" \"4\")])\n \n+(define_insn \"\"\n+  [(set (match_operand:DF 0 \"register_operand\" \"=f\")\n+\t(neg:DF (abs:DF (match_operand:DF 1 \"register_operand\" \"f\"))))\n+   (set (match_operand:DF 2 \"register_operand\" \"=&f\") (abs:DF (match_dup 1)))]\n+  \"(! TARGET_SOFT_FLOAT && TARGET_PA_20\n+    && ! reg_overlap_mentioned_p (operands[2], operands[1]))\"\n+  \"#\"\n+  [(set_attr \"type\" \"fpalu\")\n+   (set_attr \"length\" \"8\")])\n+\n+(define_split\n+  [(set (match_operand:DF 0 \"register_operand\" \"\")\n+\t(neg:DF (abs:DF (match_operand:DF 1 \"register_operand\" \"\"))))\n+   (set (match_operand:DF 2 \"register_operand\" \"\") (abs:DF (match_dup 1)))]\n+  \"! TARGET_SOFT_FLOAT && TARGET_PA_20\"\n+  [(set (match_dup 2) (abs:DF (match_dup 1)))\n+   (set (match_dup 0) (neg:DF (abs:DF (match_dup 1))))]\n+  \"\")\n+\n+(define_insn \"\"\n+  [(set (match_operand:SF 0 \"register_operand\" \"=f\")\n+\t(neg:SF (abs:SF (match_operand:SF 1 \"register_operand\" \"f\"))))\n+   (set (match_operand:SF 2 \"register_operand\" \"=&f\") (abs:SF (match_dup 1)))]\n+  \"(! TARGET_SOFT_FLOAT && TARGET_PA_20\n+    && ! reg_overlap_mentioned_p (operands[2], operands[1]))\"\n+  \"#\"\n+  [(set_attr \"type\" \"fpalu\")\n+   (set_attr \"length\" \"8\")])\n+\n+(define_split\n+  [(set (match_operand:SF 0 \"register_operand\" \"\")\n+\t(neg:SF (abs:SF (match_operand:SF 1 \"register_operand\" \"\"))))\n+   (set (match_operand:SF 2 \"register_operand\" \"\") (abs:SF (match_dup 1)))]\n+  \"! TARGET_SOFT_FLOAT && TARGET_PA_20\"\n+  [(set (match_dup 2) (abs:SF (match_dup 1)))\n+   (set (match_dup 0) (neg:SF (abs:SF (match_dup 1))))]\n+  \"\")\n+\n ;; Negating a multiply can be faked by adding zero in a fused multiply-add\n-;; instruction.\n-;; ??? Only if we add -0.0 or can ignore the sign of zero.\n+;; instruction if we can ignore the sign of zero.\n (define_insn \"\"\n   [(set (match_operand:DF 0 \"register_operand\" \"=f\")\n \t(neg:DF (mult:DF (match_operand:DF 1 \"register_operand\" \"f\")\n \t\t\t (match_operand:DF 2 \"register_operand\" \"f\"))))]\n-  \"! TARGET_SOFT_FLOAT && TARGET_PA_20\"\n+  \"!TARGET_SOFT_FLOAT && TARGET_PA_20 && !flag_signed_zeros\"\n   \"fmpynfadd,dbl %1,%2,%%fr0,%0\"\n   [(set_attr \"type\" \"fpmuldbl\")\n    (set_attr \"length\" \"4\")])\n@@ -6164,7 +6201,7 @@\n   [(set (match_operand:SF 0 \"register_operand\" \"=f\")\n \t(neg:SF (mult:SF (match_operand:SF 1 \"register_operand\" \"f\")\n \t\t\t (match_operand:SF 2 \"register_operand\" \"f\"))))]\n-  \"! TARGET_SOFT_FLOAT && TARGET_PA_20\"\n+  \"!TARGET_SOFT_FLOAT && TARGET_PA_20 && !flag_signed_zeros\"\n   \"fmpynfadd,sgl %1,%2,%%fr0,%0\"\n   [(set_attr \"type\" \"fpmuldbl\")\n    (set_attr \"length\" \"4\")])\n@@ -6175,7 +6212,7 @@\n \t\t\t (match_operand:DF 2 \"register_operand\" \"f\"))))\n    (set (match_operand:DF 3 \"register_operand\" \"=&f\")\n \t(mult:DF (match_dup 1) (match_dup 2)))]\n-  \"(! TARGET_SOFT_FLOAT && TARGET_PA_20\n+  \"(!TARGET_SOFT_FLOAT && TARGET_PA_20 && !flag_signed_zeros\n     && ! (reg_overlap_mentioned_p (operands[3], operands[1])\n           || reg_overlap_mentioned_p (operands[3], operands[2])))\"\n   \"#\"\n@@ -6188,7 +6225,7 @@\n \t\t\t (match_operand:DF 2 \"register_operand\" \"\"))))\n    (set (match_operand:DF 3 \"register_operand\" \"\")\n \t(mult:DF (match_dup 1) (match_dup 2)))]\n-  \"! TARGET_SOFT_FLOAT && TARGET_PA_20\"\n+  \"!TARGET_SOFT_FLOAT && TARGET_PA_20 && !flag_signed_zeros\"\n   [(set (match_dup 3) (mult:DF (match_dup 1) (match_dup 2)))\n    (set (match_dup 0) (neg:DF (mult:DF (match_dup 1) (match_dup 2))))]\n   \"\")\n@@ -6199,7 +6236,7 @@\n \t\t\t (match_operand:SF 2 \"register_operand\" \"f\"))))\n    (set (match_operand:SF 3 \"register_operand\" \"=&f\")\n \t(mult:SF (match_dup 1) (match_dup 2)))]\n-  \"(! TARGET_SOFT_FLOAT && TARGET_PA_20\n+  \"(!TARGET_SOFT_FLOAT && TARGET_PA_20 && !flag_signed_zeros\n     && ! (reg_overlap_mentioned_p (operands[3], operands[1])\n           || reg_overlap_mentioned_p (operands[3], operands[2])))\"\n   \"#\"\n@@ -6212,48 +6249,10 @@\n \t\t\t (match_operand:SF 2 \"register_operand\" \"\"))))\n    (set (match_operand:SF 3 \"register_operand\" \"\")\n \t(mult:SF (match_dup 1) (match_dup 2)))]\n-  \"! TARGET_SOFT_FLOAT && TARGET_PA_20\"\n+  \"!TARGET_SOFT_FLOAT && TARGET_PA_20&& !flag_signed_zeros\"\n   [(set (match_dup 3) (mult:SF (match_dup 1) (match_dup 2)))\n    (set (match_dup 0) (neg:SF (mult:SF (match_dup 1) (match_dup 2))))]\n   \"\")\n-\n-(define_insn \"\"\n-  [(set (match_operand:DF 0 \"register_operand\" \"=f\")\n-\t(neg:DF (abs:DF (match_operand:DF 1 \"register_operand\" \"f\"))))\n-   (set (match_operand:DF 2 \"register_operand\" \"=&f\") (abs:DF (match_dup 1)))]\n-  \"(! TARGET_SOFT_FLOAT && TARGET_PA_20\n-    && ! reg_overlap_mentioned_p (operands[2], operands[1]))\"\n-  \"#\"\n-  [(set_attr \"type\" \"fpalu\")\n-   (set_attr \"length\" \"8\")])\n-\n-(define_split\n-  [(set (match_operand:DF 0 \"register_operand\" \"\")\n-\t(neg:DF (abs:DF (match_operand:DF 1 \"register_operand\" \"\"))))\n-   (set (match_operand:DF 2 \"register_operand\" \"\") (abs:DF (match_dup 1)))]\n-  \"! TARGET_SOFT_FLOAT && TARGET_PA_20\"\n-  [(set (match_dup 2) (abs:DF (match_dup 1)))\n-   (set (match_dup 0) (neg:DF (abs:DF (match_dup 1))))]\n-  \"\")\n-\n-(define_insn \"\"\n-  [(set (match_operand:SF 0 \"register_operand\" \"=f\")\n-\t(neg:SF (abs:SF (match_operand:SF 1 \"register_operand\" \"f\"))))\n-   (set (match_operand:SF 2 \"register_operand\" \"=&f\") (abs:SF (match_dup 1)))]\n-  \"(! TARGET_SOFT_FLOAT && TARGET_PA_20\n-    && ! reg_overlap_mentioned_p (operands[2], operands[1]))\"\n-  \"#\"\n-  [(set_attr \"type\" \"fpalu\")\n-   (set_attr \"length\" \"8\")])\n-\n-(define_split\n-  [(set (match_operand:SF 0 \"register_operand\" \"\")\n-\t(neg:SF (abs:SF (match_operand:SF 1 \"register_operand\" \"\"))))\n-   (set (match_operand:SF 2 \"register_operand\" \"\") (abs:SF (match_dup 1)))]\n-  \"! TARGET_SOFT_FLOAT && TARGET_PA_20\"\n-  [(set (match_dup 2) (abs:SF (match_dup 1)))\n-   (set (match_dup 0) (neg:SF (abs:SF (match_dup 1))))]\n-  \"\")\n \f\n ;;- Shift instructions\n "}]}