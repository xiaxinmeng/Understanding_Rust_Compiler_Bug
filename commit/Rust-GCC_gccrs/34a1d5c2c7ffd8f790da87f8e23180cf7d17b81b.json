{"sha": "34a1d5c2c7ffd8f790da87f8e23180cf7d17b81b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzRhMWQ1YzJjN2ZmZDhmNzkwZGE4N2Y4ZTIzMTgwY2Y3ZDE3YjgxYg==", "commit": {"author": {"name": "Richard Earnshaw", "email": "rearnsha@arm.com", "date": "2018-06-04T08:41:45Z"}, "committer": {"name": "Richard Earnshaw", "email": "rearnsha@gcc.gnu.org", "date": "2018-06-04T08:41:45Z"}, "message": "[arm] PR target/86003 build failures with --with-cpu=xscale\n\nThe XScale cpu configuration in GCC has always been somewhat\nnon-conforming.  Although XScale isn't an architecture (it's simply an\nimplementation of ARMv5te), we do by tradition emit a specific\npre-define for it.  We achieve this effect by adding an additional\nfeature bit to the xscale CPU definition that isn't part of the base\narchitecture.\n\nWhen I restructured the options last year I overlooked this oddity and\nthe result, of course, is that this configuration now fails to build\nas intended.\n\nWhat happens is that the driver (correctly) constructs an architecture\nfor the xscale cpu name (as armv5te) and passes it in addition to the\nCPU name.  The backend code, on finding both a cpu and an architecture\nspecifies attempts to correlate the two and finds a difference due to\nthe additional feature bit and reports an inconsistency (fatally if\n-werror is specified).\n\nI think the best fix to this is to treat the xscale feature bit using\nthe same mechanism that we use for other 'quirks' in CPU\nimplementations and simply filter it out before comparing the\ncapabilities.  It has the additional benefit that it's also the\nsimplest fix.\n\n\tPR target/86003\n\t* config/arm/arm-cpus.in (ALL_QUIRKS): Add xscale feature to the list\n\tof bits to ignore when comparing architectures.\n\nFrom-SVN: r261140", "tree": {"sha": "0ac8cd1182d136e9a80169378744355a95fca726", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0ac8cd1182d136e9a80169378744355a95fca726"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/34a1d5c2c7ffd8f790da87f8e23180cf7d17b81b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/34a1d5c2c7ffd8f790da87f8e23180cf7d17b81b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/34a1d5c2c7ffd8f790da87f8e23180cf7d17b81b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/34a1d5c2c7ffd8f790da87f8e23180cf7d17b81b/comments", "author": null, "committer": null, "parents": [{"sha": "261ef15d46a4220c0b7453ac55265c61cda171b1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/261ef15d46a4220c0b7453ac55265c61cda171b1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/261ef15d46a4220c0b7453ac55265c61cda171b1"}], "stats": {"total": 10, "additions": 9, "deletions": 1}, "files": [{"sha": "e780766e7d8987386329dc5f6eec088c43c0c90f", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/34a1d5c2c7ffd8f790da87f8e23180cf7d17b81b/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/34a1d5c2c7ffd8f790da87f8e23180cf7d17b81b/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=34a1d5c2c7ffd8f790da87f8e23180cf7d17b81b", "patch": "@@ -1,3 +1,9 @@\n+2018-06-04  Richard Earnshaw  <rearnsha@arm.com>\n+\n+\tPR target/86003\n+\t* config/arm/arm-cpus.in (ALL_QUIRKS): Add xscale feature to the list\n+\tof bits to ignore when comparing architectures.\n+\n 2018-06-04  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR tree-optimization/69615"}, {"sha": "661bf1a573c4a00702ba71a0f598776a647cf623", "filename": "gcc/config/arm/arm-cpus.in", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/34a1d5c2c7ffd8f790da87f8e23180cf7d17b81b/gcc%2Fconfig%2Farm%2Farm-cpus.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/34a1d5c2c7ffd8f790da87f8e23180cf7d17b81b/gcc%2Fconfig%2Farm%2Farm-cpus.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Farm-cpus.in?ref=34a1d5c2c7ffd8f790da87f8e23180cf7d17b81b", "patch": "@@ -254,7 +254,9 @@ define fgroup DOTPROD\tNEON dotprod\n \n # List of all quirk bits to strip out when comparing CPU features with\n # architectures.\n-define fgroup ALL_QUIRKS   quirk_no_volatile_ce quirk_armv6kz quirk_cm3_ldrd\n+# xscale isn't really a 'quirk', but it isn't an architecture either and we\n+# need to ignore it for matching purposes.\n+define fgroup ALL_QUIRKS   quirk_no_volatile_ce quirk_armv6kz quirk_cm3_ldrd xscale\n \n # Architecture entries\n # format:"}]}