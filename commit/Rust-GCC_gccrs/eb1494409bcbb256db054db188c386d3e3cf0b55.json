{"sha": "eb1494409bcbb256db054db188c386d3e3cf0b55", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWIxNDk0NDA5YmNiYjI1NmRiMDU0ZGIxODhjMzg2ZDNlM2NmMGI1NQ==", "commit": {"author": {"name": "Richard Guenther", "email": "rguenther@suse.de", "date": "2009-11-08T12:10:32Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2009-11-08T12:10:32Z"}, "message": "re PR rtl-optimization/41928 (segfault at gcc/bitmap.c:297)\n\n2009-11-08  Richard Guenther  <rguenther@suse.de>\n\n\tPR rtl-optimization/41928\n\t* loop-invariant.c (free_loop_data): If we didn't allocate\n\tloop data do not try to free it.\n\n\t* gfortran.dg/pr41928.f90: New testcase.\n\nFrom-SVN: r154008", "tree": {"sha": "119bede4564d00d88fd512ff228ba9fabfae2409", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/119bede4564d00d88fd512ff228ba9fabfae2409"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/eb1494409bcbb256db054db188c386d3e3cf0b55", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/eb1494409bcbb256db054db188c386d3e3cf0b55", "html_url": "https://github.com/Rust-GCC/gccrs/commit/eb1494409bcbb256db054db188c386d3e3cf0b55", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/eb1494409bcbb256db054db188c386d3e3cf0b55/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "b5fcfe893c42ec905538d0964b93a138ca245341", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b5fcfe893c42ec905538d0964b93a138ca245341", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b5fcfe893c42ec905538d0964b93a138ca245341"}], "stats": {"total": 276, "additions": 276, "deletions": 0}, "files": [{"sha": "638d9a4d0ce7373acbf30a68660af559b4e23c52", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eb1494409bcbb256db054db188c386d3e3cf0b55/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eb1494409bcbb256db054db188c386d3e3cf0b55/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=eb1494409bcbb256db054db188c386d3e3cf0b55", "patch": "@@ -1,3 +1,9 @@\n+2009-11-08  Richard Guenther  <rguenther@suse.de>\n+\n+\tPR rtl-optimization/41928\n+\t* loop-invariant.c (free_loop_data): If we didn't allocate\n+\tloop data do not try to free it.\n+\n 2009-11-07  Jason Merrill  <jason@redhat.com>\n \n \t* tree.c (reconstruct_complex_type): Preserve attributes."}, {"sha": "baf249ba3a24ac5b9f50f5f9bd26dfe21f05fe81", "filename": "gcc/loop-invariant.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eb1494409bcbb256db054db188c386d3e3cf0b55/gcc%2Floop-invariant.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eb1494409bcbb256db054db188c386d3e3cf0b55/gcc%2Floop-invariant.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Floop-invariant.c?ref=eb1494409bcbb256db054db188c386d3e3cf0b55", "patch": "@@ -1564,6 +1564,8 @@ static void\n free_loop_data (struct loop *loop)\n {\n   struct loop_data *data = LOOP_DATA (loop);\n+  if (!data)\n+    return;\n \n   bitmap_clear (&LOOP_DATA (loop)->regs_ref);\n   bitmap_clear (&LOOP_DATA (loop)->regs_live);"}, {"sha": "8d594658799d756eaeff79149da57af7e0b3364a", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eb1494409bcbb256db054db188c386d3e3cf0b55/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eb1494409bcbb256db054db188c386d3e3cf0b55/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=eb1494409bcbb256db054db188c386d3e3cf0b55", "patch": "@@ -1,3 +1,8 @@\n+2009-11-08  Richard Guenther  <rguenther@suse.de>\n+\n+\tPR rtl-optimization/41928\n+\t* gfortran.dg/pr41928.f90: New testcase.\n+\n 2009-11-07  Jason Merrill  <jason@redhat.com>\n \n \tPR c++/18451"}, {"sha": "1438b0c122d3810189a89578fa4037451ba5558f", "filename": "gcc/testsuite/gfortran.dg/pr41928.f90", "status": "added", "additions": 263, "deletions": 0, "changes": 263, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eb1494409bcbb256db054db188c386d3e3cf0b55/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr41928.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eb1494409bcbb256db054db188c386d3e3cf0b55/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr41928.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr41928.f90?ref=eb1494409bcbb256db054db188c386d3e3cf0b55", "patch": "@@ -0,0 +1,263 @@\n+! { dg-do compile }\n+! { dg-options \"-O -fbounds-check -w\" }\n+MODULE kinds\n+  INTEGER, PARAMETER :: dp = SELECTED_REAL_KIND ( 14, 200 )\n+  INTEGER, DIMENSION(:), ALLOCATABLE     :: nco,ncoset,nso,nsoset\n+  INTEGER, DIMENSION(:,:,:), ALLOCATABLE :: co,coset\n+END MODULE kinds\n+MODULE ai_moments\n+  USE kinds\n+CONTAINS\n+  SUBROUTINE cossin(la_max,npgfa,zeta,rpgfa,la_min,&\n+                    lb_max,npgfb,zetb,rpgfb,lb_min,&\n+                    rac,rbc,kvec,cosab,sinab)\n+    REAL(KIND=dp), DIMENSION(ncoset(la_max),&\n+      ncoset(lb_max))                        :: sc, ss\n+    DO ipgf=1,npgfa\n+      DO jpgf=1,npgfb\n+        IF (la_max > 0) THEN\n+          DO la=2,la_max\n+            DO ax=2,la\n+              DO ay=0,la-ax\n+                sc(coset(ax,ay,az),1) = rap(1)*sc(coset(ax-1,ay,az),1) +&\n+                              f2 *          kvec(1)*ss(coset(ax-1,ay,az),1)\n+                ss(coset(ax,ay,az),1) = rap(1)*ss(coset(ax-1,ay,az),1) +&\n+                              f2 *          kvec(1)*sc(coset(ax-1,ay,az),1)\n+              END DO\n+            END DO\n+          END DO\n+          IF (lb_max > 0) THEN\n+            DO lb=2,lb_max\n+              ss(1,coset(0,0,lb)) = rbp(3)*ss(1,coset(0,0,lb-1)) +&\n+                           f2 *         kvec(3)*sc(1,coset(0,0,lb-1))\n+              DO bx=2,lb\n+                DO by=0,lb-bx\n+                  ss(1,coset(bx,by,bz)) = rbp(1)*ss(1,coset(bx-1,by,bz)) +&\n+                               f2 *           kvec(1)*sc(1,coset(bx-1,by,bz))\n+                END DO\n+              END DO\n+            END DO\n+          END IF\n+        END IF\n+       DO j=ncoset(lb_min-1)+1,ncoset(lb_max)\n+        END DO\n+      END DO\n+    END DO\n+  END SUBROUTINE cossin\n+  SUBROUTINE moment(la_max,npgfa,zeta,rpgfa,la_min,&\n+                    lb_max,npgfb,zetb,rpgfb,&\n+                    lc_max,rac,rbc,mab)\n+    REAL(KIND=dp), DIMENSION(:), INTENT(IN)  :: zeta, rpgfa\n+    REAL(KIND=dp), DIMENSION(:), INTENT(IN)  :: zetb, rpgfb\n+    REAL(KIND=dp), DIMENSION(:, :, :), &\n+      INTENT(INOUT)                          :: mab\n+    REAL(KIND=dp), DIMENSION(3)              :: rab, rap, rbp, rpc\n+    REAL(KIND=dp), DIMENSION(ncoset(la_max),&\n+      ncoset(lb_max), ncoset(lc_max))        :: s\n+    DO ipgf=1,npgfa\n+      DO jpgf=1,npgfb\n+        IF (rpgfa(ipgf) + rpgfb(jpgf) < dab) THEN\n+          DO k=1, ncoset(lc_max)-1\n+            DO j=nb+1,nb+ncoset(lb_max)\n+              DO i=na+1,na+ncoset(la_max)\n+                mab(i,j,k) = 0.0_dp\n+              END DO\n+            END DO\n+          END DO\n+        END IF\n+        rpc = zetp*(zeta(ipgf)*rac+zetb(jpgf)*rbc)\n+        DO l=2, ncoset(lc_max)\n+          lx = indco(1,l)\n+          l2 = 0\n+          IF ( lz > 0 ) THEN\n+            IF ( lz > 1 ) l2 = coset(lx,ly,lz-2)\n+          ELSE IF ( ly > 0 ) THEN\n+            IF ( ly > 1 ) l2 = coset(lx,ly-2,lz)\n+            IF ( lx > 1 ) l2 = coset(lx-2,ly,lz)\n+          END IF\n+          s(1,1,l) = rpc(i)*s(1,1,l1)\n+          IF ( l2 > 0 ) s(1,1,l) = s(1,1,l) + f2*REAL(ni,dp)*s(1,1,l2)\n+        END DO\n+        DO l = 1, ncoset(lc_max)\n+          IF ( lx > 0 ) THEN \n+            lx1 = coset(lx-1,ly,lz)\n+          END IF\n+          IF ( ly > 0 ) THEN \n+            ly1 = coset(lx,ly-1,lz)\n+          END IF\n+          IF (la_max > 0) THEN\n+            DO la=2,la_max\n+              IF ( lz1 > 0 ) s(coset(0,0,la),1,l) = s(coset(0,0,la),1,l) + &\n+                             f2z*s(coset(0,0,la-1),1,lz1)\n+              IF ( ly1 > 0 ) s(coset(0,1,az),1,l) = s(coset(0,1,az),1,l) + &\n+                             f2y*s(coset(0,0,az),1,ly1)\n+              DO ay=2,la\n+                s(coset(0,ay,az),1,l) = rap(2)*s(coset(0,ay-1,az),1,l) +&\n+                                       f2*REAL(ay-1,dp)*s(coset(0,ay-2,az),1,l)\n+                IF ( ly1 > 0 ) s(coset(0,ay,az),1,l) = s(coset(0,ay,az),1,l) + &\n+                             f2y*s(coset(0,ay-1,az),1,ly1)\n+              END DO\n+              DO ay=0,la-1\n+                IF ( lx1 > 0 ) s(coset(1,ay,az),1,l) = s(coset(1,ay,az),1,l) + &\n+                             f2x*s(coset(0,ay,az),1,lx1)\n+              END DO\n+              DO ax=2,la\n+                DO ay=0,la-ax\n+                  s(coset(ax,ay,az),1,l) = rap(1)*s(coset(ax-1,ay,az),1,l) +&\n+                                          f3*s(coset(ax-2,ay,az),1,l) \n+                  IF ( lx1 > 0 ) s(coset(ax,ay,az),1,l) = s(coset(ax,ay,az),1,l) + &\n+                                 f2x*s(coset(ax-1,ay,az),1,lx1)\n+                END DO\n+              END DO\n+            END DO\n+            IF (lb_max > 0) THEN\n+              DO j=2,ncoset(lb_max)\n+                DO i=1,ncoset(la_max)\n+                  s(i,j,l) = 0.0_dp\n+                END DO\n+              END DO\n+              DO la=la_start,la_max-1\n+                DO ax=0,la\n+                  DO ay=0,la-ax\n+                    s(coset(ax,ay,az),2,l) = s(coset(ax+1,ay,az),1,l) -&\n+                                           rab(1)*s(coset(ax,ay,az),1,l)\n+                    s(coset(ax,ay,az),4,l) = s(coset(ax,ay,az+1),1,l) -&\n+                                           rab(3)*s(coset(ax,ay,az),1,l)\n+                  END DO\n+                END DO\n+              END DO\n+              DO ax=0,la_max\n+                DO ay=0,la_max-ax\n+                  IF (ax == 0) THEN\n+                    s(coset(ax,ay,az),2,l) = rbp(1)*s(coset(ax,ay,az),1,l)\n+                  ELSE\n+                    s(coset(ax,ay,az),2,l) = rbp(1)*s(coset(ax,ay,az),1,l) +&\n+                                            fx*s(coset(ax-1,ay,az),1,l)\n+                  END IF\n+                  IF (lx1 > 0) s(coset(ax,ay,az),2,l) = s(coset(ax,ay,az),2,l) +&\n+                        f2x*s(coset(ax,ay,az),1,lx1)\n+                  IF (ay == 0) THEN\n+                    s(coset(ax,ay,az),3,l) = rbp(2)*s(coset(ax,ay,az),1,l)\n+                  ELSE\n+                    s(coset(ax,ay,az),3,l) = rbp(2)*s(coset(ax,ay,az),1,l) +&\n+                                            fy*s(coset(ax,ay-1,az),1,l)\n+                  END IF\n+                  IF (ly1 > 0) s(coset(ax,ay,az),3,l) = s(coset(ax,ay,az),3,l) +&\n+                        f2y*s(coset(ax,ay,az),1,ly1)\n+                  IF (az == 0) THEN\n+                    s(coset(ax,ay,az),4,l) = rbp(3)*s(coset(ax,ay,az),1,l)\n+                  ELSE\n+                    s(coset(ax,ay,az),4,l) = rbp(3)*s(coset(ax,ay,az),1,l) +&\n+                                            fz*s(coset(ax,ay,az-1),1,l)\n+                  END IF\n+                  IF (lz1 > 0) s(coset(ax,ay,az),4,l) = s(coset(ax,ay,az),4,l) +&\n+                        f2z*s(coset(ax,ay,az),1,lz1)\n+                END DO\n+              END DO\n+              DO lb=2,lb_max\n+                DO la=la_start,la_max-1\n+                  DO ax=0,la\n+                    DO ay=0,la-ax\n+                      s(coset(ax,ay,az),coset(0,0,lb),l) =&\n+                        rab(3)*s(coset(ax,ay,az),coset(0,0,lb-1),l)\n+                      DO bx=1,lb\n+                        DO by=0,lb-bx\n+                          s(coset(ax,ay,az),coset(bx,by,bz),l) =&\n+                            rab(1)*s(coset(ax,ay,az),coset(bx-1,by,bz),l)\n+                        END DO\n+                      END DO\n+                    END DO\n+                  END DO\n+                END DO\n+                DO ax=0,la_max\n+                  DO ay=0,la_max-ax\n+                    IF (az == 0) THEN\n+                      s(coset(ax,ay,az),coset(0,0,lb),l) =&\n+                        rbp(3)*s(coset(ax,ay,az),coset(0,0,lb-1),l) +&\n+                        f3*s(coset(ax,ay,az),coset(0,0,lb-2),l)\n+                    END IF\n+                    IF (lz1 > 0) s(coset(ax,ay,az),coset(0,0,lb),l) =&\n+                                 f2z*s(coset(ax,ay,az),coset(0,0,lb-1),lz1)\n+                    IF (ay == 0) THEN\n+                      IF (ly1 > 0) s(coset(ax,ay,az),coset(0,1,bz),l) =&\n+                                 f2y*s(coset(ax,ay,az),coset(0,0,bz),ly1)\n+                      DO by=2,lb\n+                        s(coset(ax,ay,az),coset(0,by,bz),l) =&\n+                          f3*s(coset(ax,ay,az),coset(0,by-2,bz),l)\n+                        IF (ly1 > 0) s(coset(ax,ay,az),coset(0,by,bz),l) =&\n+                                 f2y*s(coset(ax,ay,az),coset(0,by-1,bz),ly1)\n+                      END DO\n+                      s(coset(ax,ay,az),coset(0,1,bz),l) =&\n+                        fy*s(coset(ax,ay-1,az),coset(0,0,bz),l)\n+                    END IF\n+                    IF (ax == 0) THEN\n+                      DO by=0,lb-1\n+                        IF (lx1 > 0) s(coset(ax,ay,az),coset(1,by,bz),l) =&\n+                                 f2x*s(coset(ax,ay,az),coset(0,by,bz),lx1)\n+                      END DO\n+                      DO bx=2,lb\n+                        DO by=0,lb-bx\n+                          s(coset(ax,ay,az),coset(bx,by,bz),l) =&\n+                            f3*s(coset(ax,ay,az),coset(bx-2,by,bz),l)\n+                          IF (lx1 > 0) s(coset(ax,ay,az),coset(bx,by,bz),l) =&\n+                                 f2x*s(coset(ax,ay,az),coset(bx-1,by,bz),lx1)\n+                        END DO\n+                      END DO\n+                      DO by=0,lb-1\n+                        IF (lx1 > 0) s(coset(ax,ay,az),coset(1,by,bz),l) =&\n+                                 f2x*s(coset(ax,ay,az),coset(0,by,bz),lx1)\n+                      END DO\n+                      DO bx=2,lb\n+                        DO by=0,lb-bx\n+                          s(coset(ax,ay,az),coset(bx,by,bz),l) =&\n+                            f3*s(coset(ax,ay,az),coset(bx-2,by,bz),l)\n+                          IF (lx1 > 0) s(coset(ax,ay,az),coset(bx,by,bz),l) =&\n+                                 f2x*s(coset(ax,ay,az),coset(bx-1,by,bz),lx1)\n+                        END DO\n+                      END DO\n+                    END IF\n+                  END DO\n+                END DO\n+              END DO\n+            END IF\n+            IF (lb_max > 0) THEN\n+              DO lb=2,lb_max\n+                IF (lz1 > 0) s(1,coset(0,0,lb),l) = s(1,coset(0,0,lb),l) +&\n+                             f2z*s(1,coset(0,0,lb-1),lz1)\n+                IF (ly1 > 0) s(1,coset(0,1,bz),l) = s(1,coset(0,1,bz),l) +&\n+                             f2y*s(1,coset(0,0,bz),ly1)\n+              DO by=2,lb\n+                s(1,coset(0,by,bz),l) = rbp(2)*s(1,coset(0,by-1,bz),l) +&\n+                                       f2*REAL(by-1,dp)*s(1,coset(0,by-2,bz),l)\n+                IF (lx1 > 0) s(1,coset(1,by,bz),l) = s(1,coset(1,by,bz),l) +&\n+                             f2x*s(1,coset(0,by,bz),lx1)\n+              END DO\n+              DO bx=2,lb\n+                DO by=0,lb-bx\n+                  IF (lx1 > 0) s(1,coset(bx,by,bz),l) = s(1,coset(bx,by,bz),l) +&\n+                               f2x*s(1,coset(bx-1,by,bz),lx1)\n+                END DO\n+              END DO\n+            END DO\n+          END IF\n+        END IF\n+        END DO\n+        DO k=2,ncoset(lc_max)\n+          DO j=1,ncoset(lb_max)\n+          END DO\n+        END DO\n+      END DO\n+    END DO\n+  END SUBROUTINE moment\n+  SUBROUTINE diff_momop(la_max,npgfa,zeta,rpgfa,la_min,&\n+                    order,rac,rbc,difmab,mab_ext)\n+    REAL(KIND=dp), DIMENSION(:, :, :), &\n+      OPTIONAL, POINTER                      :: mab_ext\n+    REAL(KIND=dp), ALLOCATABLE, &\n+      DIMENSION(:, :, :)                     :: difmab_tmp\n+    DO imom = 1,ncoset(order)-1\n+      CALL adbdr(la_max,npgfa,rpgfa,la_min,&\n+                 difmab_tmp(:,:,2), difmab_tmp(:,:,3))\n+    END DO\n+  END SUBROUTINE diff_momop\n+END MODULE ai_moments"}]}