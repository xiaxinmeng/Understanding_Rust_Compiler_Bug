{"sha": "09191b7e58bac3c38e7e69ff235d15df4561bef7", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDkxOTFiN2U1OGJhYzNjMzhlN2U2OWZmMjM1ZDE1ZGY0NTYxYmVmNw==", "commit": {"author": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2007-04-23T10:10:20Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2007-04-23T10:10:20Z"}, "message": "decl2.c (finish_objects): Do not call target constructor/destructor bits dirrectly.\n\n\n\t* cp/decl2.c (finish_objects): Do not call target constructor/destructor\n\tbits dirrectly.\n\nFrom-SVN: r124062", "tree": {"sha": "43ca308d4920f942e7947d28b7a6ba253330379e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/43ca308d4920f942e7947d28b7a6ba253330379e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/09191b7e58bac3c38e7e69ff235d15df4561bef7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/09191b7e58bac3c38e7e69ff235d15df4561bef7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/09191b7e58bac3c38e7e69ff235d15df4561bef7", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/09191b7e58bac3c38e7e69ff235d15df4561bef7/comments", "author": null, "committer": null, "parents": [{"sha": "c90533c60b73e09d46adbd2b3f14d1697a37eeb3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c90533c60b73e09d46adbd2b3f14d1697a37eeb3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c90533c60b73e09d46adbd2b3f14d1697a37eeb3"}], "stats": {"total": 29, "additions": 15, "deletions": 14}, "files": [{"sha": "1b19ffca397fdda8731e73f37feb93c4ec58e855", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/09191b7e58bac3c38e7e69ff235d15df4561bef7/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/09191b7e58bac3c38e7e69ff235d15df4561bef7/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=09191b7e58bac3c38e7e69ff235d15df4561bef7", "patch": "@@ -1,3 +1,8 @@\n+2007-04-23  Jan Hubicka  <jh@suse.cz>\n+\n+\t* cp/decl2.c (finish_objects): Do not call target constructor/destructor\n+\tbits dirrectly.\n+\n 2007-04-21  Andrew Pinski  <andrew_pinski@playstation.sony.com>\n \n \t* cp-tree.h (lang_tree_node): Use GENERIC_NEXT"}, {"sha": "41778283236ebe3e41fa6921d0499784204ece14", "filename": "gcc/cp/decl2.c", "status": "modified", "additions": 10, "deletions": 14, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/09191b7e58bac3c38e7e69ff235d15df4561bef7/gcc%2Fcp%2Fdecl2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/09191b7e58bac3c38e7e69ff235d15df4561bef7/gcc%2Fcp%2Fdecl2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl2.c?ref=09191b7e58bac3c38e7e69ff235d15df4561bef7", "patch": "@@ -2363,23 +2363,19 @@ finish_objects (int method_type, int initp, tree body)\n   /* Finish up.  */\n   finish_compound_stmt (body);\n   fn = finish_function (0);\n-  expand_or_defer_fn (fn);\n-\n-  /* When only doing semantic analysis, and no RTL generation, we\n-     can't call functions that directly emit assembly code; there is\n-     no assembly file in which to put the code.  */\n-  if (flag_syntax_only)\n-    return;\n \n-  if (targetm.have_ctors_dtors)\n+  if (method_type == 'I')\n     {\n-      rtx fnsym = XEXP (DECL_RTL (fn), 0);\n-      cgraph_mark_needed_node (cgraph_node (fn));\n-      if (method_type == 'I')\n-\t(* targetm.asm_out.constructor) (fnsym, initp);\n-      else\n-\t(* targetm.asm_out.destructor) (fnsym, initp);\n+      DECL_STATIC_CONSTRUCTOR (fn) = 1;\n+      decl_init_priority_insert (fn, initp);\n     }\n+  else\n+    {\n+      DECL_STATIC_DESTRUCTOR (fn) = 1;\n+      decl_fini_priority_insert (fn, initp);\n+    }\n+\n+  expand_or_defer_fn (fn);\n }\n \n /* The names of the parameters to the function created to handle"}]}