{"sha": "d9049d04d5fa172848374e395bf283c164a0f7fd", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDkwNDlkMDRkNWZhMTcyODQ4Mzc0ZTM5NWJmMjgzYzE2NGEwZjdmZA==", "commit": {"author": {"name": "Ed Schonberg", "email": "schonberg@adacore.com", "date": "2017-01-19T11:33:17Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2017-01-19T11:33:17Z"}, "message": "sem_dim.adb (Analyze_Dimension): Analyze object declaration and identifier nodes that do not come from source...\n\n2017-01-19  Ed Schonberg  <schonberg@adacore.com>\n\n\t* sem_dim.adb (Analyze_Dimension): Analyze object declaration and\n\tidentifier nodes that do not come from source, to handle properly\n\tdimensionality check within an inlined body which inclddes both\n\toriginal operands and rewritten operands. This removes spurious\n\tdimensionality errors in the presence of front-end inlining,\n\tas well as in SPARK mode.\n\nFrom-SVN: r244614", "tree": {"sha": "219185dab43ca3e16abe87cb7a0e572d8aa0b61b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/219185dab43ca3e16abe87cb7a0e572d8aa0b61b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d9049d04d5fa172848374e395bf283c164a0f7fd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d9049d04d5fa172848374e395bf283c164a0f7fd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d9049d04d5fa172848374e395bf283c164a0f7fd", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d9049d04d5fa172848374e395bf283c164a0f7fd/comments", "author": {"login": "Edschonberg", "id": 6352375, "node_id": "MDQ6VXNlcjYzNTIzNzU=", "avatar_url": "https://avatars.githubusercontent.com/u/6352375?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Edschonberg", "html_url": "https://github.com/Edschonberg", "followers_url": "https://api.github.com/users/Edschonberg/followers", "following_url": "https://api.github.com/users/Edschonberg/following{/other_user}", "gists_url": "https://api.github.com/users/Edschonberg/gists{/gist_id}", "starred_url": "https://api.github.com/users/Edschonberg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Edschonberg/subscriptions", "organizations_url": "https://api.github.com/users/Edschonberg/orgs", "repos_url": "https://api.github.com/users/Edschonberg/repos", "events_url": "https://api.github.com/users/Edschonberg/events{/privacy}", "received_events_url": "https://api.github.com/users/Edschonberg/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "a57c520e2b884f8f52c03625b3ce2ca838a9427a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a57c520e2b884f8f52c03625b3ce2ca838a9427a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a57c520e2b884f8f52c03625b3ce2ca838a9427a"}], "stats": {"total": 30, "additions": 23, "deletions": 7}, "files": [{"sha": "625643f21fe2a817b22dd7938a06642b8c8100ad", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d9049d04d5fa172848374e395bf283c164a0f7fd/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d9049d04d5fa172848374e395bf283c164a0f7fd/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=d9049d04d5fa172848374e395bf283c164a0f7fd", "patch": "@@ -1,3 +1,12 @@\n+2017-01-19  Ed Schonberg  <schonberg@adacore.com>\n+\n+\t* sem_dim.adb (Analyze_Dimension): Analyze object declaration and\n+\tidentifier nodes that do not come from source, to handle properly\n+\tdimensionality check within an inlined body which inclddes both\n+\toriginal operands and rewritten operands. This removes spurious\n+\tdimensionality errors in the presence of front-end inlining,\n+\tas well as in SPARK mode.\n+\n 2017-01-16  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR driver/49726"}, {"sha": "2c57bcb5227190ff1cb1c83c3e408e8c847cd3ed", "filename": "gcc/ada/sem_dim.adb", "status": "modified", "additions": 14, "deletions": 7, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d9049d04d5fa172848374e395bf283c164a0f7fd/gcc%2Fada%2Fsem_dim.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d9049d04d5fa172848374e395bf283c164a0f7fd/gcc%2Fada%2Fsem_dim.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_dim.adb?ref=d9049d04d5fa172848374e395bf283c164a0f7fd", "patch": "@@ -1122,16 +1122,22 @@ package body Sem_Dim is\n       --  Aspect is an Ada 2012 feature. Note that there is no need to check\n       --  dimensions for nodes that don't come from source, except for subtype\n       --  declarations where the dimensions are inherited from the base type,\n-      --  and for explicit dereferences generated when expanding iterators.\n+      --  for explicit dereferences generated when expanding iterators, and\n+      --  for object declarations generated for inlining.\n \n       if Ada_Version < Ada_2012 then\n          return;\n \n-      elsif not Comes_From_Source (N)\n-        and then Nkind (N) /= N_Subtype_Declaration\n-        and then Nkind (N) /= N_Explicit_Dereference\n-      then\n-         return;\n+      elsif not Comes_From_Source (N) then\n+         if Nkind_In (N, N_Explicit_Dereference,\n+                         N_Identifier,\n+                         N_Object_Declaration,\n+                         N_Subtype_Declaration)\n+         then\n+            null;\n+         else\n+            return;\n+         end if;\n       end if;\n \n       case Nkind (N) is\n@@ -2138,7 +2144,8 @@ package body Sem_Dim is\n             end if;\n          end if;\n \n-         --  Removal of dimensions in expression\n+         --  Remove dimensions in expression after checking consistency\n+         --  with given type.\n \n          Remove_Dimensions (Expr);\n       end if;"}]}