{"sha": "419c62125982f257ef80953a416a58153608ffee", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDE5YzYyMTI1OTgyZjI1N2VmODA5NTNhNDE2YTU4MTUzNjA4ZmZlZQ==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@yorick.cygnus.com", "date": "1999-04-20T01:20:07Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "1999-04-20T01:20:07Z"}, "message": "decl.c (grokfndecl): Always call cplus_decl_attributes.\n\n\t* decl.c (grokfndecl): Always call cplus_decl_attributes.\n\t* decl2.c (grokfield): Pass attrlist to grokdeclarator.\n\nFrom-SVN: r26558", "tree": {"sha": "8501fb2d887b6763aa0f2168e2fe32d6b9383134", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8501fb2d887b6763aa0f2168e2fe32d6b9383134"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/419c62125982f257ef80953a416a58153608ffee", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/419c62125982f257ef80953a416a58153608ffee", "html_url": "https://github.com/Rust-GCC/gccrs/commit/419c62125982f257ef80953a416a58153608ffee", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/419c62125982f257ef80953a416a58153608ffee/comments", "author": null, "committer": null, "parents": [{"sha": "aa9b7b48b69d1d062b753b6569d704eceb892fb4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/aa9b7b48b69d1d062b753b6569d704eceb892fb4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/aa9b7b48b69d1d062b753b6569d704eceb892fb4"}], "stats": {"total": 23, "additions": 15, "deletions": 8}, "files": [{"sha": "61668022029857341df970f69871cc540c04a136", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/419c62125982f257ef80953a416a58153608ffee/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/419c62125982f257ef80953a416a58153608ffee/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=419c62125982f257ef80953a416a58153608ffee", "patch": "@@ -1,3 +1,8 @@\n+1999-04-20  Jason Merrill  <jason@yorick.cygnus.com>\n+\n+\t* decl.c (grokfndecl): Always call cplus_decl_attributes.\n+\t* decl2.c (grokfield): Pass attrlist to grokdeclarator.\n+\n 1999-04-19  Mark Mitchell  <mark@codesourcery.com>\n \n \t* cp-tree.h (finish_static_data_member_decl): New function."}, {"sha": "d6112361fa5ec5ff9927e7007b1ac8f1762e1ca4", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 9, "deletions": 7, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/419c62125982f257ef80953a416a58153608ffee/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/419c62125982f257ef80953a416a58153608ffee/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=419c62125982f257ef80953a416a58153608ffee", "patch": "@@ -8701,6 +8701,10 @@ grokfndecl (ctype, type, declarator, orig_declarator, virtualp, flags, quals,\n        tentative.  error_mark_node is replaced later with the BLOCK.  */\n     DECL_INITIAL (decl) = error_mark_node;\n \n+  if (attrlist)\n+    cplus_decl_attributes (decl, TREE_PURPOSE (attrlist), \n+\t\t\t   TREE_VALUE (attrlist));\n+\n   /* Caller will do the rest of this.  */\n   if (check < 0)\n     return decl;\n@@ -8793,9 +8797,6 @@ grokfndecl (ctype, type, declarator, orig_declarator, virtualp, flags, quals,\n       if (ctype == NULL_TREE || check)\n \treturn decl;\n \n-      if (attrlist)\n-\tcplus_decl_attributes (decl, TREE_PURPOSE (attrlist), \n-\t\t\t       TREE_VALUE (attrlist));\n       make_decl_rtl (decl, NULL_PTR, 1);\n \n       if (virtualp)\n@@ -10759,16 +10760,14 @@ grokdeclarator (declarator, declspecs, decl_context, initialized, attrlist)\n \tattrlist = build_decl_list (NULL_TREE, inner_attrs);\n     }\n \n+  /* Now TYPE has the actual type.  */\n+\n   if (explicitp == 1)\n     {\n       error (\"only constructors can be declared `explicit'\");\n       explicitp = 0;\n     }\n \n-  /* Now TYPE has the actual type.  */\n-\n-  /* If this is declaring a typedef name, return a TYPE_DECL.  */\n-\n   if (RIDBIT_SETP (RID_MUTABLE, specbits))\n     {\n       if (type_quals & TYPE_QUAL_CONST)\n@@ -10795,8 +10794,11 @@ grokdeclarator (declarator, declspecs, decl_context, initialized, attrlist)\n       declarator = dname;\n     }\n   else\n+    /* Unexpected declarator format.  */\n     my_friendly_abort (990210);\n \n+  /* If this is declaring a typedef name, return a TYPE_DECL.  */\n+\n   if (RIDBIT_SETP (RID_TYPEDEF, specbits) && decl_context != TYPENAME)\n     {\n       tree decl;"}, {"sha": "70c9727884a9395b361870396e23e64ca84ff8ec", "filename": "gcc/cp/decl2.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/419c62125982f257ef80953a416a58153608ffee/gcc%2Fcp%2Fdecl2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/419c62125982f257ef80953a416a58153608ffee/gcc%2Fcp%2Fdecl2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl2.c?ref=419c62125982f257ef80953a416a58153608ffee", "patch": "@@ -1570,7 +1570,7 @@ grokfield (declarator, declspecs, init, asmspec_tree, attrlist)\n       && TREE_CHAIN (init) == NULL_TREE)\n     init = NULL_TREE;\n \n-  value = grokdeclarator (declarator, declspecs, FIELD, init != 0, NULL_TREE);\n+  value = grokdeclarator (declarator, declspecs, FIELD, init != 0, attrlist);\n   if (! value || value == error_mark_node)\n     /* friend or constructor went bad.  */\n     return value;"}]}