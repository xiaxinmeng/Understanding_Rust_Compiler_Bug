{"sha": "f7571527a44808cd7062c77bb9570c13f4f6a126", "node_id": "C_kwDOANBUbNoAKGY3NTcxNTI3YTQ0ODA4Y2Q3MDYyYzc3YmI5NTcwYzEzZjRmNmExMjY", "commit": {"author": {"name": "Hongyu Wang", "email": "hongyu.wang@intel.com", "date": "2021-10-15T02:23:38Z"}, "committer": {"name": "Hongyu Wang", "email": "hongyu.wang@intel.com", "date": "2021-10-15T02:41:12Z"}, "message": "AVX512FP16: Fix testcase for complex intrinsic\n\n-march=cascadelake which contains -mavx512vl produces unmatched scan\nfor vf[c]maddcsh test, so add -mno-avx512vl to vf[c]maddcsh-1a.c.\n\nAlso add scan for vblendmps to vf[c]maddcph tests to check correctness.\n\ngcc/testsuite/ChangeLog:\n\n\t* gcc.target/i386/avx512fp16-vfcmaddcph-1a.c: Add scan for\n\tvblendmps.\n\t* gcc.target/i386/avx512fp16-vfmaddcph-1a.c: Likewise.\n\t* gcc.target/i386/avx512fp16vl-vfcmaddcph-1a.c: Likewise.\n\t* gcc.target/i386/avx512fp16vl-vfmaddcph-1a.c: Likewise.\n\t* gcc.target/i386/avx512fp16-vfmaddcsh-1a.c: Add -mno-avx512vl.\n\t* gcc.target/i386/avx512fp16-vfcmaddcsh-1a.c: Likewise.", "tree": {"sha": "8f41dec3702833977a75d414844ce7a74e165771", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8f41dec3702833977a75d414844ce7a74e165771"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f7571527a44808cd7062c77bb9570c13f4f6a126", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f7571527a44808cd7062c77bb9570c13f4f6a126", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f7571527a44808cd7062c77bb9570c13f4f6a126", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f7571527a44808cd7062c77bb9570c13f4f6a126/comments", "author": {"login": "wwwhhhyyy", "id": 5366075, "node_id": "MDQ6VXNlcjUzNjYwNzU=", "avatar_url": "https://avatars.githubusercontent.com/u/5366075?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wwwhhhyyy", "html_url": "https://github.com/wwwhhhyyy", "followers_url": "https://api.github.com/users/wwwhhhyyy/followers", "following_url": "https://api.github.com/users/wwwhhhyyy/following{/other_user}", "gists_url": "https://api.github.com/users/wwwhhhyyy/gists{/gist_id}", "starred_url": "https://api.github.com/users/wwwhhhyyy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wwwhhhyyy/subscriptions", "organizations_url": "https://api.github.com/users/wwwhhhyyy/orgs", "repos_url": "https://api.github.com/users/wwwhhhyyy/repos", "events_url": "https://api.github.com/users/wwwhhhyyy/events{/privacy}", "received_events_url": "https://api.github.com/users/wwwhhhyyy/received_events", "type": "User", "site_admin": false}, "committer": {"login": "wwwhhhyyy", "id": 5366075, "node_id": "MDQ6VXNlcjUzNjYwNzU=", "avatar_url": "https://avatars.githubusercontent.com/u/5366075?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wwwhhhyyy", "html_url": "https://github.com/wwwhhhyyy", "followers_url": "https://api.github.com/users/wwwhhhyyy/followers", "following_url": "https://api.github.com/users/wwwhhhyyy/following{/other_user}", "gists_url": "https://api.github.com/users/wwwhhhyyy/gists{/gist_id}", "starred_url": "https://api.github.com/users/wwwhhhyyy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wwwhhhyyy/subscriptions", "organizations_url": "https://api.github.com/users/wwwhhhyyy/orgs", "repos_url": "https://api.github.com/users/wwwhhhyyy/repos", "events_url": "https://api.github.com/users/wwwhhhyyy/events{/privacy}", "received_events_url": "https://api.github.com/users/wwwhhhyyy/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1595fe44e11a969d8ae462212886fb0a87b46226", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1595fe44e11a969d8ae462212886fb0a87b46226", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1595fe44e11a969d8ae462212886fb0a87b46226"}], "stats": {"total": 10, "additions": 8, "deletions": 2}, "files": [{"sha": "cd39b7f99ff0dab55e75b0bedde3ea11e3e4e1ad", "filename": "gcc/testsuite/gcc.target/i386/avx512fp16-vfcmaddcph-1a.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f7571527a44808cd7062c77bb9570c13f4f6a126/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Favx512fp16-vfcmaddcph-1a.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f7571527a44808cd7062c77bb9570c13f4f6a126/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Favx512fp16-vfcmaddcph-1a.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Favx512fp16-vfcmaddcph-1a.c?ref=f7571527a44808cd7062c77bb9570c13f4f6a126", "patch": "@@ -6,6 +6,7 @@\n /* { dg-final { scan-assembler-times \"vfcmaddcph\\[ \\\\t\\]+\\{rn-sae\\}\\[^\\{\\n\\]*%zmm\\[0-9\\]+\\[^\\n\\r]*%zmm\\[0-9\\]+\\[^\\n\\r]*%zmm\\[0-9\\]+(?:\\n|\\[ \\\\t\\]+#)\" 1 } } */\n /* { dg-final { scan-assembler-times \"vfcmaddcph\\[ \\\\t\\]+\\{rn-sae\\}\\[^\\{\\n\\]*%zmm\\[0-9\\]+\\[^\\n\\r]*%zmm\\[0-9\\]+\\[^\\n\\r]*%zmm\\[0-9\\]+\\{%k\\[0-9\\]\\}\\[^\\n\\r]*(?:\\n|\\[ \\\\t\\]+#)\" 2 } } */\n /* { dg-final { scan-assembler-times \"vfcmaddcph\\[ \\\\t\\]+\\{rz-sae\\}\\[^\\{\\n\\]*%zmm\\[0-9\\]+\\[^\\n\\r]*%zmm\\[0-9\\]+\\[^\\n\\r]*%zmm\\[0-9\\]+\\{%k\\[0-9\\]\\}\\{z\\}\\[^\\n\\r]*(?:\\n|\\[ \\\\t\\]+#)\" 1 } } */\n+/* { dg-final { scan-assembler-times \"vblendmps\\[ \\\\t\\]+%zmm\\[0-9\\]+\\[^\\n\\r]*%zmm\\[0-9\\]+\\[^\\n\\r]*%zmm\\[0-9\\]+\\{%k\\[0-9\\]\\}(?:\\n|\\[ \\\\t\\]+#)\" 2 } } */\n \n #include <immintrin.h>\n "}, {"sha": "eb96588df39be6852085a11aaf459c559f49fef0", "filename": "gcc/testsuite/gcc.target/i386/avx512fp16-vfcmaddcsh-1a.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f7571527a44808cd7062c77bb9570c13f4f6a126/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Favx512fp16-vfcmaddcsh-1a.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f7571527a44808cd7062c77bb9570c13f4f6a126/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Favx512fp16-vfcmaddcsh-1a.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Favx512fp16-vfcmaddcsh-1a.c?ref=f7571527a44808cd7062c77bb9570c13f4f6a126", "patch": "@@ -1,5 +1,5 @@\n /* { dg-do compile } */\n-/* { dg-options \"-mavx512fp16 -O2\" } */\n+/* { dg-options \"-mavx512fp16 -mno-avx512vl -O2\" } */\n /* { dg-final { scan-assembler-times \"vfcmaddcsh\\[ \\\\t\\]+\\[^\\{\\n\\]*%xmm\\[0-9\\]+\\[^\\n\\r]*%xmm\\[0-9\\]+\\[^\\n\\r]*%xmm\\[0-9\\]+(?:\\n|\\[ \\\\t\\]+#)\" 1 } } */\n /* { dg-final { scan-assembler-times \"vfcmaddcsh\\[ \\\\t\\]+\\[^\\{\\n\\]*%xmm\\[0-9\\]+\\[^\\n\\r]*%xmm\\[0-9\\]+\\[^\\n\\r]*%xmm\\[0-9\\]+\\{%k\\[0-9\\]\\}\\[^\\{\\n\\r]*(?:\\n|\\[ \\\\t\\]+#)\" 2 } } */\n /* { dg-final { scan-assembler-times \"vfcmaddcsh\\[ \\\\t\\]+\\[^\\{\\n\\]*%xmm\\[0-9\\]+\\[^\\n\\r]*%xmm\\[0-9\\]+\\[^\\n\\r]*%xmm\\[0-9\\]+\\{%k\\[0-9\\]\\}\\{z\\}\\[^\\n\\r]*(?:\\n|\\[ \\\\t\\]+#)\" 1 } } */"}, {"sha": "859b215ab17923e190355cab5c95c6463f1503a6", "filename": "gcc/testsuite/gcc.target/i386/avx512fp16-vfmaddcph-1a.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f7571527a44808cd7062c77bb9570c13f4f6a126/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Favx512fp16-vfmaddcph-1a.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f7571527a44808cd7062c77bb9570c13f4f6a126/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Favx512fp16-vfmaddcph-1a.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Favx512fp16-vfmaddcph-1a.c?ref=f7571527a44808cd7062c77bb9570c13f4f6a126", "patch": "@@ -6,6 +6,7 @@\n /* { dg-final { scan-assembler-times \"vfmaddcph\\[ \\\\t\\]+\\{rn-sae\\}\\[^\\{\\n\\]*%zmm\\[0-9\\]+\\[^\\n\\r]*%zmm\\[0-9\\]+\\[^\\n\\r]*%zmm\\[0-9\\]+(?:\\n|\\[ \\\\t\\]+#)\" 1 } } */\n /* { dg-final { scan-assembler-times \"vfmaddcph\\[ \\\\t\\]+\\{rn-sae\\}\\[^\\{\\n\\]*%zmm\\[0-9\\]+\\[^\\n\\r]*%zmm\\[0-9\\]+\\[^\\n\\r]*%zmm\\[0-9\\]+\\{%k\\[0-9\\]\\}\\[^\\n\\r]*(?:\\n|\\[ \\\\t\\]+#)\" 2 } } */\n /* { dg-final { scan-assembler-times \"vfmaddcph\\[ \\\\t\\]+\\{rz-sae\\}\\[^\\{\\n\\]*%zmm\\[0-9\\]+\\[^\\n\\r]*%zmm\\[0-9\\]+\\[^\\n\\r]*%zmm\\[0-9\\]+\\{%k\\[0-9\\]\\}\\{z\\}\\[^\\n\\r]*(?:\\n|\\[ \\\\t\\]+#)\" 1 } } */\n+/* { dg-final { scan-assembler-times \"vblendmps\\[ \\\\t\\]+%zmm\\[0-9\\]+\\[^\\n\\r]*%zmm\\[0-9\\]+\\[^\\n\\r]*%zmm\\[0-9\\]+\\{%k\\[0-9\\]\\}(?:\\n|\\[ \\\\t\\]+#)\" 2 } } */\n \n #include <immintrin.h>\n "}, {"sha": "288d1c12a1009be9fdececd2cf1a7e264fc31b93", "filename": "gcc/testsuite/gcc.target/i386/avx512fp16-vfmaddcsh-1a.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f7571527a44808cd7062c77bb9570c13f4f6a126/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Favx512fp16-vfmaddcsh-1a.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f7571527a44808cd7062c77bb9570c13f4f6a126/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Favx512fp16-vfmaddcsh-1a.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Favx512fp16-vfmaddcsh-1a.c?ref=f7571527a44808cd7062c77bb9570c13f4f6a126", "patch": "@@ -1,5 +1,5 @@\n /* { dg-do compile } */\n-/* { dg-options \"-mavx512fp16 -O2\" } */\n+/* { dg-options \"-mavx512fp16 -mno-avx512vl -O2\" } */\n /* { dg-final { scan-assembler-times \"vfmaddcsh\\[ \\\\t\\]+\\[^\\{\\n\\]*%xmm\\[0-9\\]+\\[^\\n\\r]*%xmm\\[0-9\\]+\\[^\\n\\r]*%xmm\\[0-9\\]+(?:\\n|\\[ \\\\t\\]+#)\" 1 } } */\n /* { dg-final { scan-assembler-times \"vfmaddcsh\\[ \\\\t\\]+\\[^\\{\\n\\]*%xmm\\[0-9\\]+\\[^\\n\\r]*%xmm\\[0-9\\]+\\[^\\n\\r]*%xmm\\[0-9\\]+\\{%k\\[0-9\\]\\}\\[^\\{\\n\\r]*(?:\\n|\\[ \\\\t\\]+#)\" 2 } } */\n /* { dg-final { scan-assembler-times \"vfmaddcsh\\[ \\\\t\\]+\\[^\\{\\n\\]*%xmm\\[0-9\\]+\\[^\\n\\r]*%xmm\\[0-9\\]+\\[^\\n\\r]*%xmm\\[0-9\\]+\\{%k\\[0-9\\]\\}\\{z\\}\\[^\\n\\r]*(?:\\n|\\[ \\\\t\\]+#)\" 1 } } */"}, {"sha": "627241c0403401f8efcaf01b3619c2dcd261f3f1", "filename": "gcc/testsuite/gcc.target/i386/avx512fp16vl-vfcmaddcph-1a.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f7571527a44808cd7062c77bb9570c13f4f6a126/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Favx512fp16vl-vfcmaddcph-1a.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f7571527a44808cd7062c77bb9570c13f4f6a126/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Favx512fp16vl-vfcmaddcph-1a.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Favx512fp16vl-vfcmaddcph-1a.c?ref=f7571527a44808cd7062c77bb9570c13f4f6a126", "patch": "@@ -3,9 +3,11 @@\n /* { dg-final { scan-assembler-times \"vfcmaddcph\\[ \\\\t\\]+\\[^\\{\\n\\]*%ymm\\[0-9\\]+\\[^\\n\\r]*%ymm\\[0-9\\]+(?:\\n|\\[ \\\\t\\]+#)\" 1 } } */\n /* { dg-final { scan-assembler-times \"vfcmaddcph\\[ \\\\t\\]+%ymm\\[0-9\\]+\\[^\\n\\r]*%ymm\\[0-9\\]+\\[^\\n\\r]*%ymm\\[0-9\\]+\\{%k\\[0-9\\]\\}(?:\\n|\\[ \\\\t\\]+#)\" 2 } } */\n /* { dg-final { scan-assembler-times \"vfcmaddcph\\[ \\\\t\\]+%ymm\\[0-9\\]+\\[^\\n\\r]*%ymm\\[0-9\\]+\\[^\\n\\r]*%ymm\\[0-9\\]+\\{%k\\[0-9\\]\\}\\{z\\}\\[^\\n\\r]*(?:\\n|\\[ \\\\t\\]+#)\" 1 } } */\n+/* { dg-final { scan-assembler-times \"vblendmps\\[ \\\\t\\]+%ymm\\[0-9\\]+\\[^\\n\\r]*%ymm\\[0-9\\]+\\[^\\n\\r]*%ymm\\[0-9\\]+\\{%k\\[0-9\\]\\}(?:\\n|\\[ \\\\t\\]+#)\" 1 } } */\n /* { dg-final { scan-assembler-times \"vfcmaddcph\\[ \\\\t\\]+%xmm\\[0-9\\]+\\[^\\n\\r]*%xmm\\[0-9\\]+\\[^\\n\\r]*%xmm\\[0-9\\]+(?:\\n|\\[ \\\\t\\]+#)\" 1 } } */\n /* { dg-final { scan-assembler-times \"vfcmaddcph\\[ \\\\t\\]+%xmm\\[0-9\\]+\\[^\\n\\r]*%xmm\\[0-9\\]+\\[^\\n\\r]*%xmm\\[0-9\\]+\\{%k\\[0-9\\]\\}(?:\\n|\\[ \\\\t\\]+#)\" 2 } } */\n /* { dg-final { scan-assembler-times \"vfcmaddcph\\[ \\\\t\\]+%xmm\\[0-9\\]+\\[^\\n\\r]*%xmm\\[0-9\\]+\\[^\\n\\r]*%xmm\\[0-9\\]+\\{%k\\[0-9\\]\\}\\{z\\}\\[^\\n\\r]*(?:\\n|\\[ \\\\t\\]+#)\" 1 } } */\n+/* { dg-final { scan-assembler-times \"vblendmps\\[ \\\\t\\]+%xmm\\[0-9\\]+\\[^\\n\\r]*%xmm\\[0-9\\]+\\[^\\n\\r]*%xmm\\[0-9\\]+\\{%k\\[0-9\\]\\}(?:\\n|\\[ \\\\t\\]+#)\" 1 } } */\n \n #include <immintrin.h>\n "}, {"sha": "75cba83f4ed0ba15ca6fbec33f6232736b25c3cc", "filename": "gcc/testsuite/gcc.target/i386/avx512fp16vl-vfmaddcph-1a.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f7571527a44808cd7062c77bb9570c13f4f6a126/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Favx512fp16vl-vfmaddcph-1a.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f7571527a44808cd7062c77bb9570c13f4f6a126/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Favx512fp16vl-vfmaddcph-1a.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Favx512fp16vl-vfmaddcph-1a.c?ref=f7571527a44808cd7062c77bb9570c13f4f6a126", "patch": "@@ -3,9 +3,11 @@\n /* { dg-final { scan-assembler-times \"vfmaddcph\\[ \\\\t\\]+\\[^\\{\\n\\]*%ymm\\[0-9\\]+\\[^\\n\\r]*%ymm\\[0-9\\]+(?:\\n|\\[ \\\\t\\]+#)\" 1 } } */\n /* { dg-final { scan-assembler-times \"vfmaddcph\\[ \\\\t\\]+%ymm\\[0-9\\]+\\[^\\n\\r]*%ymm\\[0-9\\]+\\[^\\n\\r]*%ymm\\[0-9\\]+\\{%k\\[0-9\\]\\}(?:\\n|\\[ \\\\t\\]+#)\" 2 } } */\n /* { dg-final { scan-assembler-times \"vfmaddcph\\[ \\\\t\\]+%ymm\\[0-9\\]+\\[^\\n\\r]*%ymm\\[0-9\\]+\\[^\\n\\r]*%ymm\\[0-9\\]+\\{%k\\[0-9\\]\\}\\{z\\}\\[^\\n\\r]*(?:\\n|\\[ \\\\t\\]+#)\" 1 } } */\n+/* { dg-final { scan-assembler-times \"vblendmps\\[ \\\\t\\]+%ymm\\[0-9\\]+\\[^\\n\\r]*%ymm\\[0-9\\]+\\[^\\n\\r]*%ymm\\[0-9\\]+\\{%k\\[0-9\\]\\}(?:\\n|\\[ \\\\t\\]+#)\" 1 } } */\n /* { dg-final { scan-assembler-times \"vfmaddcph\\[ \\\\t\\]+%xmm\\[0-9\\]+\\[^\\n\\r]*%xmm\\[0-9\\]+\\[^\\n\\r]*%xmm\\[0-9\\]+(?:\\n|\\[ \\\\t\\]+#)\" 1 } } */\n /* { dg-final { scan-assembler-times \"vfmaddcph\\[ \\\\t\\]+%xmm\\[0-9\\]+\\[^\\n\\r]*%xmm\\[0-9\\]+\\[^\\n\\r]*%xmm\\[0-9\\]+\\{%k\\[0-9\\]\\}(?:\\n|\\[ \\\\t\\]+#)\" 2 } } */\n /* { dg-final { scan-assembler-times \"vfmaddcph\\[ \\\\t\\]+%xmm\\[0-9\\]+\\[^\\n\\r]*%xmm\\[0-9\\]+\\[^\\n\\r]*%xmm\\[0-9\\]+\\{%k\\[0-9\\]\\}\\{z\\}\\[^\\n\\r]*(?:\\n|\\[ \\\\t\\]+#)\" 1 } } */\n+/* { dg-final { scan-assembler-times \"vblendmps\\[ \\\\t\\]+%xmm\\[0-9\\]+\\[^\\n\\r]*%xmm\\[0-9\\]+\\[^\\n\\r]*%xmm\\[0-9\\]+\\{%k\\[0-9\\]\\}(?:\\n|\\[ \\\\t\\]+#)\" 1 } } */\n \n #include <immintrin.h>\n "}]}