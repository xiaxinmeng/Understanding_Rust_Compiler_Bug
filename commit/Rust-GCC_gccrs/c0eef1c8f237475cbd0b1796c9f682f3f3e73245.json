{"sha": "c0eef1c8f237475cbd0b1796c9f682f3f3e73245", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzBlZWYxYzhmMjM3NDc1Y2JkMGIxNzk2YzlmNjgyZjNmM2U3MzI0NQ==", "commit": {"author": {"name": "Jonathan Wakely", "email": "redi@gcc.gnu.org", "date": "2014-05-15T12:31:05Z"}, "committer": {"name": "Jonathan Wakely", "email": "redi@gcc.gnu.org", "date": "2014-05-15T12:31:05Z"}, "message": "re PR libstdc++/60326 (Incorrect type from std::make_unsigned<wchar_t>)\n\n\tPR libstdc++/60326\n\t* include/std/type_traits (__make_unsigned, __make_signed): Define\n\tspecializations for wchar_t, char16_t and char32_t.\n\t* testsuite/20_util/make_signed/requirements/typedefs-4.cc: New.\n\t* testsuite/20_util/make_unsigned/requirements/typedefs-1.cc: Correct\n\ttest for make_unsigned<volatile wchar_t>.\n\t* testsuite/20_util/make_unsigned/requirements/typedefs-2.cc:\n\tLikewise.\n\t* testsuite/20_util/declval/requirements/1_neg.cc: Adjust dg-error\n\tline number.\n\t* testsuite/20_util/make_signed/requirements/typedefs_neg.cc:\n\tLikewise.\n\t* testsuite/20_util/make_unsigned/requirements/typedefs_neg.cc:\n\tLikewise.\n\nFrom-SVN: r210473", "tree": {"sha": "212adaee026f76d37747e04d2e171079c865c6f0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/212adaee026f76d37747e04d2e171079c865c6f0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c0eef1c8f237475cbd0b1796c9f682f3f3e73245", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c0eef1c8f237475cbd0b1796c9f682f3f3e73245", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c0eef1c8f237475cbd0b1796c9f682f3f3e73245", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c0eef1c8f237475cbd0b1796c9f682f3f3e73245/comments", "author": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "927450d08ca506a795671ee2690ecae30eb07de7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/927450d08ca506a795671ee2690ecae30eb07de7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/927450d08ca506a795671ee2690ecae30eb07de7"}], "stats": {"total": 94, "additions": 87, "deletions": 7}, "files": [{"sha": "fa3d8a890d91198251c78a81d580d1cf58200637", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0eef1c8f237475cbd0b1796c9f682f3f3e73245/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0eef1c8f237475cbd0b1796c9f682f3f3e73245/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=c0eef1c8f237475cbd0b1796c9f682f3f3e73245", "patch": "@@ -1,5 +1,22 @@\n 2014-05-15  Jonathan Wakely  <jwakely@redhat.com>\n \n+\tPR libstdc++/60326\n+\t* include/std/type_traits (__make_unsigned, __make_signed): Define\n+\tspecializations for wchar_t, char16_t and char32_t.\n+\t* testsuite/20_util/make_signed/requirements/typedefs-4.cc: New.\n+\t* testsuite/20_util/make_unsigned/requirements/typedefs-1.cc: Correct\n+\ttest for make_unsigned<volatile wchar_t>.\n+\t* testsuite/20_util/make_unsigned/requirements/typedefs-2.cc:\n+\tLikewise.\n+\t* testsuite/20_util/declval/requirements/1_neg.cc: Adjust dg-error\n+\tline number.\n+\t* testsuite/20_util/make_signed/requirements/typedefs_neg.cc:\n+\tLikewise.\n+\t* testsuite/20_util/make_unsigned/requirements/typedefs_neg.cc:\n+\tLikewise.\n+\n+2014-05-15  Jonthan Wakely  <jwakely@redhat.com>\n+\n \t* include/std/tuple (tuple_size<cv _Tp>): Implement LWG 2313.\n \t* include/std/array (tuple_size, tuple_element): Add Doxygen comments.\n \t* include/std/utility (tuple_size, tuple_element): Likewise."}, {"sha": "0eacd36a118365bcf5dcebfef8b31486be57337b", "filename": "libstdc++-v3/include/std/type_traits", "status": "modified", "additions": 30, "deletions": 0, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0eef1c8f237475cbd0b1796c9f682f3f3e73245/libstdc%2B%2B-v3%2Finclude%2Fstd%2Ftype_traits", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0eef1c8f237475cbd0b1796c9f682f3f3e73245/libstdc%2B%2B-v3%2Finclude%2Fstd%2Ftype_traits", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fstd%2Ftype_traits?ref=c0eef1c8f237475cbd0b1796c9f682f3f3e73245", "patch": "@@ -41,6 +41,15 @@ namespace std _GLIBCXX_VISIBILITY(default)\n {\n _GLIBCXX_BEGIN_NAMESPACE_VERSION\n \n+#ifdef _GLIBCXX_USE_C99_STDINT_TR1\n+# if defined (__UINT_LEAST16_TYPE__) && defined(__UINT_LEAST32_TYPE__)\n+  typedef __UINT_LEAST16_TYPE__ uint_least16_t;\n+  typedef __UINT_LEAST32_TYPE__ uint_least32_t;\n+# else\n+#  include <cstdint>\n+# endif\n+#endif\n+\n   /**\n    * @defgroup metaprogramming Metaprogramming\n    * @ingroup utilities\n@@ -1583,6 +1592,12 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n     struct __make_unsigned<long long>\n     { typedef unsigned long long __type; };\n \n+#if defined(_GLIBCXX_USE_WCHAR_T) && !defined(__WCHAR_UNSIGNED__)\n+  template<>\n+    struct __make_unsigned<wchar_t> : __make_unsigned<__WCHAR_TYPE__>\n+    { };\n+#endif\n+\n #if !defined(__STRICT_ANSI__) && defined(_GLIBCXX_USE_INT128)\n   template<>\n     struct __make_unsigned<__int128>\n@@ -1665,6 +1680,21 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n     struct __make_signed<unsigned long long>\n     { typedef signed long long __type; };\n \n+#if defined(_GLIBCXX_USE_WCHAR_T) && defined(__WCHAR_UNSIGNED__)\n+  template<>\n+    struct __make_signed<wchar_t> : __make_signed<__WCHAR_TYPE__>\n+    { };\n+#endif\n+\n+#ifdef _GLIBCXX_USE_C99_STDINT_TR1\n+  template<>\n+    struct __make_signed<char16_t> : __make_signed<uint_least16_t>\n+    { };\n+  template<>\n+    struct __make_signed<char32_t> : __make_signed<uint_least32_t>\n+    { };\n+#endif\n+\n #if !defined(__STRICT_ANSI__) && defined(_GLIBCXX_USE_INT128)\n   template<>\n     struct __make_signed<unsigned __int128>"}, {"sha": "6be3af05ade9a1643e34d14dc2fd120b9e5db4fb", "filename": "libstdc++-v3/testsuite/20_util/declval/requirements/1_neg.cc", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0eef1c8f237475cbd0b1796c9f682f3f3e73245/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fdeclval%2Frequirements%2F1_neg.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0eef1c8f237475cbd0b1796c9f682f3f3e73245/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fdeclval%2Frequirements%2F1_neg.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fdeclval%2Frequirements%2F1_neg.cc?ref=c0eef1c8f237475cbd0b1796c9f682f3f3e73245", "patch": "@@ -19,7 +19,7 @@\n // with this library; see the file COPYING3.  If not see\n // <http://www.gnu.org/licenses/>.\n \n-// { dg-error \"static assertion failed\" \"\" { target *-*-* } 2003 }\n+// { dg-error \"static assertion failed\" \"\" { target *-*-* } 2033 }\n \n #include <utility>\n "}, {"sha": "4950e5470cd8c7dcef6a620a90404b5cf27e9fd8", "filename": "libstdc++-v3/testsuite/20_util/make_signed/requirements/typedefs-4.cc", "status": "added", "additions": 33, "deletions": 0, "changes": 33, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0eef1c8f237475cbd0b1796c9f682f3f3e73245/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fmake_signed%2Frequirements%2Ftypedefs-4.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0eef1c8f237475cbd0b1796c9f682f3f3e73245/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fmake_signed%2Frequirements%2Ftypedefs-4.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fmake_signed%2Frequirements%2Ftypedefs-4.cc?ref=c0eef1c8f237475cbd0b1796c9f682f3f3e73245", "patch": "@@ -0,0 +1,33 @@\n+// { dg-options \"-std=gnu++11\" }\n+// { dg-do compile }\n+// { dg-require-cstdint \"\" }\n+\n+// Copyright (C) 2014 Free Software Foundation, Inc.\n+//\n+// This file is part of the GNU ISO C++ Library.  This library is free\n+// software; you can redistribute it and/or modify it under the\n+// terms of the GNU General Public License as published by the\n+// Free Software Foundation; either version 3, or (at your option)\n+// any later version.\n+//\n+// This library is distributed in the hope that it will be useful,\n+// but WITHOUT ANY WARRANTY; without even the implied warranty of\n+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+// GNU General Public License for more details.\n+//\n+// You should have received a copy of the GNU General Public License along\n+// with this library; see the file COPYING3.  If not see\n+// <http://www.gnu.org/licenses/>.\n+\n+#include <type_traits>\n+\n+// libstdc++/60326\n+\n+using namespace std;\n+#ifdef _GLIBCXX_USE_WCHAR_T\n+using wchar_signed = make_signed<wchar_t>::type;\n+using wchar_unsigned = make_unsigned<wchar_t>::type;\n+static_assert( !is_same<wchar_signed, wchar_unsigned>::value, \"wchar_t\" );\n+#endif\n+static_assert( is_signed<make_signed<char16_t>::type>::value, \"char16_t\");\n+static_assert( is_signed<make_signed<char32_t>::type>::value, \"char32_t\");"}, {"sha": "77f8bb3aadd8696dee0998705a1fd2204b4ead57", "filename": "libstdc++-v3/testsuite/20_util/make_signed/requirements/typedefs_neg.cc", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0eef1c8f237475cbd0b1796c9f682f3f3e73245/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fmake_signed%2Frequirements%2Ftypedefs_neg.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0eef1c8f237475cbd0b1796c9f682f3f3e73245/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fmake_signed%2Frequirements%2Ftypedefs_neg.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fmake_signed%2Frequirements%2Ftypedefs_neg.cc?ref=c0eef1c8f237475cbd0b1796c9f682f3f3e73245", "patch": "@@ -48,5 +48,5 @@ void test01()\n // { dg-error \"required from here\" \"\" { target *-*-* } 40 }\n // { dg-error \"required from here\" \"\" { target *-*-* } 42 }\n \n-// { dg-error \"invalid use of incomplete type\" \"\" { target *-*-* } 1714 }\n-// { dg-error \"declaration of\" \"\" { target *-*-* } 1678 }\n+// { dg-error \"invalid use of incomplete type\" \"\" { target *-*-* } 1744 }\n+// { dg-error \"declaration of\" \"\" { target *-*-* } 1708 }"}, {"sha": "a893ede133d4fb17af10033e895208845606e389", "filename": "libstdc++-v3/testsuite/20_util/make_unsigned/requirements/typedefs-1.cc", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0eef1c8f237475cbd0b1796c9f682f3f3e73245/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fmake_unsigned%2Frequirements%2Ftypedefs-1.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0eef1c8f237475cbd0b1796c9f682f3f3e73245/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fmake_unsigned%2Frequirements%2Ftypedefs-1.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fmake_unsigned%2Frequirements%2Ftypedefs-1.cc?ref=c0eef1c8f237475cbd0b1796c9f682f3f3e73245", "patch": "@@ -49,7 +49,7 @@ void test01()\n \n #ifdef _GLIBCXX_USE_WCHAR_T\n   typedef make_unsigned<volatile wchar_t>::type  \ttest23_type;\n-  static_assert(is_same<test23_type, volatile wchar_t>::value, \"\");\n+  static_assert(is_same<test23_type, volatile unsigned wchar_t>::value, \"\");\n #endif\n \n   // Chapter 48, chapter 20. Smallest rank such that new unsigned type"}, {"sha": "637b0c7ca56a3dc1339c5981e8e1e23083774164", "filename": "libstdc++-v3/testsuite/20_util/make_unsigned/requirements/typedefs-2.cc", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0eef1c8f237475cbd0b1796c9f682f3f3e73245/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fmake_unsigned%2Frequirements%2Ftypedefs-2.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0eef1c8f237475cbd0b1796c9f682f3f3e73245/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fmake_unsigned%2Frequirements%2Ftypedefs-2.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fmake_unsigned%2Frequirements%2Ftypedefs-2.cc?ref=c0eef1c8f237475cbd0b1796c9f682f3f3e73245", "patch": "@@ -50,7 +50,7 @@ void test01()\n \n #ifdef _GLIBCXX_USE_WCHAR_T\n   typedef make_unsigned<volatile wchar_t>::type  \ttest23_type;\n-  static_assert(is_same<test23_type, volatile wchar_t>::value, \"\");\n+  static_assert(is_same<test23_type, volatile unsigned wchar_t>::value, \"\");\n #endif\n \n   typedef make_unsigned<test_enum>::type  \t  test24_type;"}, {"sha": "48ee22557185b55282e8d6cac12236fb70f6bd8a", "filename": "libstdc++-v3/testsuite/20_util/make_unsigned/requirements/typedefs_neg.cc", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0eef1c8f237475cbd0b1796c9f682f3f3e73245/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fmake_unsigned%2Frequirements%2Ftypedefs_neg.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0eef1c8f237475cbd0b1796c9f682f3f3e73245/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fmake_unsigned%2Frequirements%2Ftypedefs_neg.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fmake_unsigned%2Frequirements%2Ftypedefs_neg.cc?ref=c0eef1c8f237475cbd0b1796c9f682f3f3e73245", "patch": "@@ -48,5 +48,5 @@ void test01()\n // { dg-error \"required from here\" \"\" { target *-*-* } 40 }\n // { dg-error \"required from here\" \"\" { target *-*-* } 42 }\n \n-// { dg-error \"invalid use of incomplete type\" \"\" { target *-*-* } 1632 }\n-// { dg-error \"declaration of\" \"\" { target *-*-* } 1596 }\n+// { dg-error \"invalid use of incomplete type\" \"\" { target *-*-* } 1647 }\n+// { dg-error \"declaration of\" \"\" { target *-*-* } 1611 }"}]}