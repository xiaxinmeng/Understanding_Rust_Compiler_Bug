{"sha": "ecd16bf6652c30c8eacbb2dabbc4e6dfd12236c7", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWNkMTZiZjY2NTJjMzBjOGVhY2JiMmRhYmJjNGU2ZGZkMTIyMzZjNw==", "commit": {"author": {"name": "Tom Tromey", "email": "tromey@redhat.com", "date": "2004-09-22T20:16:17Z"}, "committer": {"name": "Tom Tromey", "email": "tromey@gcc.gnu.org", "date": "2004-09-22T20:16:17Z"}, "message": "re PR java/14446 (GZIPInputStream: corrupted gzip file - crc mismatch)\n\n\tPR libgcj/14446:\n\t* java/util/zip/GZIPInputStream.java (read): Avoid sign extension\n\twhen comparing CRCs.\n\t* java/util/zip/InflaterInputStream.java (onebytebuffer): New\n\tfield.\n\t(read()): New overload.\n\nFrom-SVN: r87882", "tree": {"sha": "2387909c6af042a5d6b9fd456ab20930ba600a61", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2387909c6af042a5d6b9fd456ab20930ba600a61"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ecd16bf6652c30c8eacbb2dabbc4e6dfd12236c7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ecd16bf6652c30c8eacbb2dabbc4e6dfd12236c7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ecd16bf6652c30c8eacbb2dabbc4e6dfd12236c7", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ecd16bf6652c30c8eacbb2dabbc4e6dfd12236c7/comments", "author": null, "committer": null, "parents": [{"sha": "9b270cce9339106ca876bf4369156ef5d2bb5588", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9b270cce9339106ca876bf4369156ef5d2bb5588", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9b270cce9339106ca876bf4369156ef5d2bb5588"}], "stats": {"total": 29, "additions": 28, "deletions": 1}, "files": [{"sha": "df804df9c91c9855374f0c70d7973ccfa47881af", "filename": "libjava/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ecd16bf6652c30c8eacbb2dabbc4e6dfd12236c7/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ecd16bf6652c30c8eacbb2dabbc4e6dfd12236c7/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=ecd16bf6652c30c8eacbb2dabbc4e6dfd12236c7", "patch": "@@ -1,3 +1,12 @@\n+2004-09-22  Tom Tromey  <tromey@redhat.com>\n+\n+\tPR libgcj/14446:\n+\t* java/util/zip/GZIPInputStream.java (read): Avoid sign extension\n+\twhen comparing CRCs.\n+\t* java/util/zip/InflaterInputStream.java (onebytebuffer): New\n+\tfield.\n+\t(read()): New overload.\n+\n 2004-09-21  Tom Tromey  <tromey@redhat.com>\n \n \t* java/lang/reflect/natMethod.cc (_Jv_CallAnyMethodA):"}, {"sha": "56401639e0cb0e8a7c99f911f42f20598e6685d5", "filename": "libjava/java/util/zip/GZIPInputStream.java", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ecd16bf6652c30c8eacbb2dabbc4e6dfd12236c7/libjava%2Fjava%2Futil%2Fzip%2FGZIPInputStream.java", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ecd16bf6652c30c8eacbb2dabbc4e6dfd12236c7/libjava%2Fjava%2Futil%2Fzip%2FGZIPInputStream.java", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjava%2Futil%2Fzip%2FGZIPInputStream.java?ref=ecd16bf6652c30c8eacbb2dabbc4e6dfd12236c7", "patch": "@@ -230,7 +230,9 @@ public int read(byte[] buf, int offset, int len) throws IOException\n \t    tmp[i] = (byte) eof_read();\n \t  }\n \n-\tint header_crc = read4(tmp, 0);\n+\t// Be careful to avoid sign extension here; CRC32.getValue()\n+\t// returns a long.\n+\tlong header_crc = read4(tmp, 0) & 0xffffffffL;\n \tif (crc.getValue() != header_crc)\n \t  throw new ZipException(\"corrupted gzip file - crc mismatch\");\n \tint isize = read4(tmp, 4);"}, {"sha": "3676a2cdb5d7c1f329754b408c743947632081a7", "filename": "libjava/java/util/zip/InflaterInputStream.java", "status": "modified", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ecd16bf6652c30c8eacbb2dabbc4e6dfd12236c7/libjava%2Fjava%2Futil%2Fzip%2FInflaterInputStream.java", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ecd16bf6652c30c8eacbb2dabbc4e6dfd12236c7/libjava%2Fjava%2Futil%2Fzip%2FInflaterInputStream.java", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjava%2Futil%2Fzip%2FInflaterInputStream.java?ref=ecd16bf6652c30c8eacbb2dabbc4e6dfd12236c7", "patch": "@@ -70,6 +70,9 @@ public class InflaterInputStream extends FilterInputStream\n    */\n   protected int len;\n \n+  // We just use this if we are decoding one byte at a time with the\n+  // read() call.\n+  private byte[] onebytebuffer = new byte[1];\n \n   /**\n    * Create an InflaterInputStream with the default decompresseor\n@@ -155,6 +158,19 @@ protected void fill() throws IOException\n     inf.setInput(buf, 0, len);\n   }\n \n+  /**\n+   * Reads one byte of decompressed data.\n+   *\n+   * The byte is in the lower 8 bits of the int.\n+   */\n+  public int read() throws IOException\n+  { \n+    int nread = read(onebytebuffer, 0, 1);\n+    if (nread > 0)\n+      return onebytebuffer[0] & 0xff;\n+    return -1;\n+  }\n+\n   /**\n    * Decompresses data into the byte array\n    *"}]}