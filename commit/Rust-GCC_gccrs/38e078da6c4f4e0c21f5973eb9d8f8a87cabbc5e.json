{"sha": "38e078da6c4f4e0c21f5973eb9d8f8a87cabbc5e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzhlMDc4ZGE2YzRmNGUwYzIxZjU5NzNlYjlkOGY4YTg3Y2FiYmM1ZQ==", "commit": {"author": {"name": "Sandra Loosemore", "email": "sandra@codesourcery.com", "date": "2019-12-05T21:36:22Z"}, "committer": {"name": "Sandra Loosemore", "email": "sandra@gcc.gnu.org", "date": "2019-12-05T21:36:22Z"}, "message": "Disable --eh-frame-hdr with -pie or -shared on nios2-linux-gnu.\n\n2019-12-05  Sandra Loosemore  <sandra@codesourcery.com>\n\n\tDisable --eh-frame-hdr with -pie or -shared on nios2-linux-gnu.\n\n\tThe nios2 ABI doesn't have appropriate relocations to support\n\t--eh-frame-hdr with -pie or -shared, so we need to override the\n\tdefault specs that add that link option.  Otherwise we get linker\n\twarnings about invalid FDE encodings.\n\n\tgcc/\n\t* config/nios2/linux.h (LINK_EH_SPEC): Define.\n\n\tgcc/testsuite/\n\t* g++.target/nios2/hello-pie.C: New.\n\t* g++.target/nios2/nios2.exp: New.\n\nFrom-SVN: r279023", "tree": {"sha": "0223e7bf6a44cc595519d9653bcc9a65dcb3613d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0223e7bf6a44cc595519d9653bcc9a65dcb3613d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/38e078da6c4f4e0c21f5973eb9d8f8a87cabbc5e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/38e078da6c4f4e0c21f5973eb9d8f8a87cabbc5e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/38e078da6c4f4e0c21f5973eb9d8f8a87cabbc5e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/38e078da6c4f4e0c21f5973eb9d8f8a87cabbc5e/comments", "author": {"login": "SandraLoosemore", "id": 104087111, "node_id": "U_kgDOBjQ-Rw", "avatar_url": "https://avatars.githubusercontent.com/u/104087111?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SandraLoosemore", "html_url": "https://github.com/SandraLoosemore", "followers_url": "https://api.github.com/users/SandraLoosemore/followers", "following_url": "https://api.github.com/users/SandraLoosemore/following{/other_user}", "gists_url": "https://api.github.com/users/SandraLoosemore/gists{/gist_id}", "starred_url": "https://api.github.com/users/SandraLoosemore/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SandraLoosemore/subscriptions", "organizations_url": "https://api.github.com/users/SandraLoosemore/orgs", "repos_url": "https://api.github.com/users/SandraLoosemore/repos", "events_url": "https://api.github.com/users/SandraLoosemore/events{/privacy}", "received_events_url": "https://api.github.com/users/SandraLoosemore/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "a414fd426346558d7a913af3ed82bcc1121fc880", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a414fd426346558d7a913af3ed82bcc1121fc880", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a414fd426346558d7a913af3ed82bcc1121fc880"}], "stats": {"total": 63, "additions": 63, "deletions": 0}, "files": [{"sha": "5c83a06fd19cc3f5ff40957788b1986eb0c4cb8d", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/38e078da6c4f4e0c21f5973eb9d8f8a87cabbc5e/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/38e078da6c4f4e0c21f5973eb9d8f8a87cabbc5e/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=38e078da6c4f4e0c21f5973eb9d8f8a87cabbc5e", "patch": "@@ -1,3 +1,7 @@\n+2019-12-05  Sandra Loosemore  <sandra@codesourcery.com>\n+\n+\t* config/nios2/linux.h (LINK_EH_SPEC): Define.\n+\n 2019-12-05  Jan Hubicka  <hubicka@ucw.cz>\n \n \t* ipa-inline-transform.c (inline_call): Fix maintenatnce of comdat_local"}, {"sha": "9936b3101d974636383e5d92a065d3da4341f8ab", "filename": "gcc/config/nios2/linux.h", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/38e078da6c4f4e0c21f5973eb9d8f8a87cabbc5e/gcc%2Fconfig%2Fnios2%2Flinux.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/38e078da6c4f4e0c21f5973eb9d8f8a87cabbc5e/gcc%2Fconfig%2Fnios2%2Flinux.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fnios2%2Flinux.h?ref=38e078da6c4f4e0c21f5973eb9d8f8a87cabbc5e", "patch": "@@ -40,6 +40,12 @@\n       -dynamic-linker \" GNU_USER_DYNAMIC_LINKER \"} \\\n     %{static:-static}}\"\n \n+/* The nios2 ABI does not have appropriate relocations to support\n+   --eh-frame-hdr with PIE, or in shared libraries.  */\n+#undef LINK_EH_SPEC\n+#define LINK_EH_SPEC \\\n+  \"%{!pie: %{!shared: %{!static:--eh-frame-hdr}}} \"\n+\n /* This toolchain implements the ABI for Linux Systems documented in the\n    Nios II Processor Reference Handbook.  */\n #define TARGET_LINUX_ABI 1"}, {"sha": "3891ee46fc8229261a73d42d0c62c4af44b7826e", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/38e078da6c4f4e0c21f5973eb9d8f8a87cabbc5e/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/38e078da6c4f4e0c21f5973eb9d8f8a87cabbc5e/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=38e078da6c4f4e0c21f5973eb9d8f8a87cabbc5e", "patch": "@@ -1,3 +1,8 @@\n+2019-12-05  Sandra Loosemore  <sandra@codesourcery.com>\n+\n+\t* g++.target/nios2/hello-pie.C: New.\n+\t* g++.target/nios2/nios2.exp: New.\n+\n 2019-12-05  Marek Polacek  <polacek@redhat.com>\n \t    Jakub Jelinek  <jakub@redhat.com>\n "}, {"sha": "ed016f3daca49eb13f97d3c35f68b36e0c60f901", "filename": "gcc/testsuite/g++.target/nios2/hello-pie.C", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/38e078da6c4f4e0c21f5973eb9d8f8a87cabbc5e/gcc%2Ftestsuite%2Fg%2B%2B.target%2Fnios2%2Fhello-pie.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/38e078da6c4f4e0c21f5973eb9d8f8a87cabbc5e/gcc%2Ftestsuite%2Fg%2B%2B.target%2Fnios2%2Fhello-pie.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.target%2Fnios2%2Fhello-pie.C?ref=38e078da6c4f4e0c21f5973eb9d8f8a87cabbc5e", "patch": "@@ -0,0 +1,14 @@\n+// { dg-do run { target *-*-linux* } }\n+// { dg-options \"-pie -fpie\" }\n+// { dg-output \"Hello, pie World\" }\n+\n+// This test used to give an \"FDE encoding\" error from the linker due to\n+// the ABI not having appropriate relocations for PIE.\n+\n+#include <iostream>\n+\n+int\n+main ()\n+{\n+  std::cout << \"Hello, pie World\" << std::endl;\n+}"}, {"sha": "a4ff7d04ac8298582c67c5694499a51afc56008a", "filename": "gcc/testsuite/g++.target/nios2/nios2.exp", "status": "added", "additions": 34, "deletions": 0, "changes": 34, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/38e078da6c4f4e0c21f5973eb9d8f8a87cabbc5e/gcc%2Ftestsuite%2Fg%2B%2B.target%2Fnios2%2Fnios2.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/38e078da6c4f4e0c21f5973eb9d8f8a87cabbc5e/gcc%2Ftestsuite%2Fg%2B%2B.target%2Fnios2%2Fnios2.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.target%2Fnios2%2Fnios2.exp?ref=38e078da6c4f4e0c21f5973eb9d8f8a87cabbc5e", "patch": "@@ -0,0 +1,34 @@\n+# Copyright (C) 2019 Free Software Foundation, Inc.\n+\n+# This program is free software; you can redistribute it and/or modify\n+# it under the terms of the GNU General Public License as published by\n+# the Free Software Foundation; either version 3 of the License, or\n+# (at your option) any later version.\n+#\n+# This program is distributed in the hope that it will be useful,\n+# but WITHOUT ANY WARRANTY; without even the implied warranty of\n+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+# GNU General Public License for more details.\n+#\n+# You should have received a copy of the GNU General Public License\n+# along with GCC; see the file COPYING3.  If not see\n+# <http://www.gnu.org/licenses/>.\n+\n+# GCC testsuite that uses the `dg.exp' driver.\n+\n+# Exit immediately if this isn't a nios2 target.\n+if ![istarget nios2*-*-*] then {\n+  return\n+}\n+\n+# Load support procs.\n+load_lib g++-dg.exp\n+\n+# Initialize `dg'.\n+dg-init\n+\n+# Main loop.\n+dg-runtest [lsort [glob -nocomplain $srcdir/$subdir/*.C]] \"\" \"\"\n+\n+# All done.\n+dg-finish"}]}