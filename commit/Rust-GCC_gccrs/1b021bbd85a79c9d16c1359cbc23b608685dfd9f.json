{"sha": "1b021bbd85a79c9d16c1359cbc23b608685dfd9f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWIwMjFiYmQ4NWE3OWM5ZDE2YzEzNTljYmMyM2I2MDg2ODVkZmQ5Zg==", "commit": {"author": {"name": "Martin Liska", "email": "mliska@suse.cz", "date": "2020-12-21T09:35:11Z"}, "committer": {"name": "Martin Liska", "email": "mliska@suse.cz", "date": "2020-12-21T09:35:11Z"}, "message": "gcc-changelog: new error for quoted utf8 filenames\n\ncontrib/ChangeLog:\n\n\t* gcc-changelog/git_commit.py: Add new error for quoted\n\tfilenames.\n\t* gcc-changelog/test_email.py: Test it.\n\t* gcc-changelog/test_patches.txt: Test it.", "tree": {"sha": "950a945106f0ae8babc89410e60dfae1a6141ee0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/950a945106f0ae8babc89410e60dfae1a6141ee0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1b021bbd85a79c9d16c1359cbc23b608685dfd9f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1b021bbd85a79c9d16c1359cbc23b608685dfd9f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1b021bbd85a79c9d16c1359cbc23b608685dfd9f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1b021bbd85a79c9d16c1359cbc23b608685dfd9f/comments", "author": {"login": "marxin", "id": 2658545, "node_id": "MDQ6VXNlcjI2NTg1NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/2658545?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marxin", "html_url": "https://github.com/marxin", "followers_url": "https://api.github.com/users/marxin/followers", "following_url": "https://api.github.com/users/marxin/following{/other_user}", "gists_url": "https://api.github.com/users/marxin/gists{/gist_id}", "starred_url": "https://api.github.com/users/marxin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marxin/subscriptions", "organizations_url": "https://api.github.com/users/marxin/orgs", "repos_url": "https://api.github.com/users/marxin/repos", "events_url": "https://api.github.com/users/marxin/events{/privacy}", "received_events_url": "https://api.github.com/users/marxin/received_events", "type": "User", "site_admin": false}, "committer": {"login": "marxin", "id": 2658545, "node_id": "MDQ6VXNlcjI2NTg1NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/2658545?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marxin", "html_url": "https://github.com/marxin", "followers_url": "https://api.github.com/users/marxin/followers", "following_url": "https://api.github.com/users/marxin/following{/other_user}", "gists_url": "https://api.github.com/users/marxin/gists{/gist_id}", "starred_url": "https://api.github.com/users/marxin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marxin/subscriptions", "organizations_url": "https://api.github.com/users/marxin/orgs", "repos_url": "https://api.github.com/users/marxin/repos", "events_url": "https://api.github.com/users/marxin/events{/privacy}", "received_events_url": "https://api.github.com/users/marxin/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2ebe7526584ed81d70d004d4fd527ef86af367c3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2ebe7526584ed81d70d004d4fd527ef86af367c3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2ebe7526584ed81d70d004d4fd527ef86af367c3"}], "stats": {"total": 39, "additions": 39, "deletions": 0}, "files": [{"sha": "f9cb8cbf0308ed0a01d5ec9be7f2c93fb750e0e4", "filename": "contrib/gcc-changelog/git_commit.py", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1b021bbd85a79c9d16c1359cbc23b608685dfd9f/contrib%2Fgcc-changelog%2Fgit_commit.py", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1b021bbd85a79c9d16c1359cbc23b608685dfd9f/contrib%2Fgcc-changelog%2Fgit_commit.py", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2Fgcc-changelog%2Fgit_commit.py?ref=1b021bbd85a79c9d16c1359cbc23b608685dfd9f", "patch": "@@ -299,6 +299,14 @@ def __init__(self, info, strict=True, commit_to_info_hook=None):\n                                      'separately from normal commits'))\n             return\n \n+        # check for an encoded utf-8 filename\n+        hint = 'git config --global core.quotepath false'\n+        for modified, _ in self.info.modified_files:\n+            if modified.startswith('\"') or modified.endswith('\"'):\n+                self.errors.append(Error('Quoted UTF8 filename, please set: '\n+                                         f'\"{hint}\"', modified))\n+                return\n+\n         all_are_ignored = (len(project_files) + len(ignored_files)\n                            == len(self.info.modified_files))\n         self.parse_lines(all_are_ignored)"}, {"sha": "2053531452c9d0c3fbfce89a9cafbc4efef700ec", "filename": "contrib/gcc-changelog/test_email.py", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1b021bbd85a79c9d16c1359cbc23b608685dfd9f/contrib%2Fgcc-changelog%2Ftest_email.py", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1b021bbd85a79c9d16c1359cbc23b608685dfd9f/contrib%2Fgcc-changelog%2Ftest_email.py", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2Fgcc-changelog%2Ftest_email.py?ref=1b021bbd85a79c9d16c1359cbc23b608685dfd9f", "patch": "@@ -399,3 +399,7 @@ def test_wildcard_in_subdir(self):\n     def test_unicode_chars_in_filename(self):\n         email = self.from_patch_glob('0001-Add-horse.patch')\n         assert not email.errors\n+\n+    def test_bad_unicode_chars_in_filename(self):\n+        email = self.from_patch_glob('0001-Add-horse2.patch')\n+        assert email.errors[0].message.startswith('Quoted UTF8 filename')"}, {"sha": "ffd13682d5ce541f0bc96f82dab0835f1714f8fc", "filename": "contrib/gcc-changelog/test_patches.txt", "status": "modified", "additions": 27, "deletions": 0, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1b021bbd85a79c9d16c1359cbc23b608685dfd9f/contrib%2Fgcc-changelog%2Ftest_patches.txt", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1b021bbd85a79c9d16c1359cbc23b608685dfd9f/contrib%2Fgcc-changelog%2Ftest_patches.txt", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2Fgcc-changelog%2Ftest_patches.txt?ref=1b021bbd85a79c9d16c1359cbc23b608685dfd9f", "patch": "@@ -3371,4 +3371,31 @@ index 00000000000..56c67f58752\n +I'm a horse.\n -- \n 2.29.2\n+=== 0001-Add-horse2.patch ===\n+From 2884248d07e4e2c922e137365253e2e521c425b0 Mon Sep 17 00:00:00 2001\n+From: Martin Liska <mliska@suse.cz>\n+Date: Mon, 21 Dec 2020 10:14:46 +0100\n+Subject: [PATCH] Add horse.\n+MIME-Version: 1.0\n+Content-Type: text/plain; charset=UTF-8\n+Content-Transfer-Encoding: 8bit\n+\n+ChangeLog:\n+\n+\t* kon\u00ed\u010dek.txt: New file.\n+---\n+ \"kon\\303\\255\\304\\215ek.txt\" | 1 +\n+ 1 file changed, 1 insertion(+)\n+ create mode 100644 \"kon\\303\\255\\304\\215ek.txt\"\n+\n+diff --git \"a/kon\\303\\255\\304\\215ek.txt\" \"b/kon\\303\\255\\304\\215ek.txt\"\n+new file mode 100644\n+index 00000000000..56c67f58752\n+--- /dev/null\n++++ \"b/kon\\303\\255\\304\\215ek.txt\"\n+@@ -0,0 +1 @@\n++I'm a horse.\n+-- \n+2.29.2\n+\n "}]}