{"sha": "3281be05bc239a26f314aca14e11ad139331ba8e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzI4MWJlMDViYzIzOWEyNmYzMTRhY2ExNGUxMWFkMTM5MzMxYmE4ZQ==", "commit": {"author": {"name": "Mark Mitchell", "email": "mark@codesourcery.com", "date": "2003-09-02T20:54:07Z"}, "committer": {"name": "Mark Mitchell", "email": "mmitchel@gcc.gnu.org", "date": "2003-09-02T20:54:07Z"}, "message": "re PR c++/11847 (reference does not work as template argument any more)\n\n\tPR c++/11847\n\t* pt.c (convert_nontype_argument): Correct representation of\n\tREFERENCE_TYPE expressions.\n\n\tPR c++/11847\n\t* g++.dg/template/class1.C: New test.\n\nFrom-SVN: r71003", "tree": {"sha": "93cf7bb62c03e299a0938b5077fa67a29e16e087", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/93cf7bb62c03e299a0938b5077fa67a29e16e087"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3281be05bc239a26f314aca14e11ad139331ba8e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3281be05bc239a26f314aca14e11ad139331ba8e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3281be05bc239a26f314aca14e11ad139331ba8e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3281be05bc239a26f314aca14e11ad139331ba8e/comments", "author": null, "committer": null, "parents": [{"sha": "643845684253c6054a3990dd166d2b255abaa6e0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/643845684253c6054a3990dd166d2b255abaa6e0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/643845684253c6054a3990dd166d2b255abaa6e0"}], "stats": {"total": 23, "additions": 21, "deletions": 2}, "files": [{"sha": "b24258b4a87d96b12d7b9f64fade2106fa7ebb32", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3281be05bc239a26f314aca14e11ad139331ba8e/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3281be05bc239a26f314aca14e11ad139331ba8e/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=3281be05bc239a26f314aca14e11ad139331ba8e", "patch": "@@ -1,5 +1,9 @@\n 2003-09-02  Mark Mitchell  <mark@codesourcery.com>\n \n+\tPR c++/11847\n+\t* pt.c (convert_nontype_argument): Correct representation of\n+\tREFERENCE_TYPE expressions.\n+\n \tPR c++/11808\n \t* cp-tree.h (KOENIG_LOOKUP_P): New macro.\n \t(finish_call_expr): Change prototype."}, {"sha": "f47990132d2a0fe29b53fa26981b3cf795c44f0c", "filename": "gcc/cp/pt.c", "status": "modified", "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3281be05bc239a26f314aca14e11ad139331ba8e/gcc%2Fcp%2Fpt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3281be05bc239a26f314aca14e11ad139331ba8e/gcc%2Fcp%2Fpt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fpt.c?ref=3281be05bc239a26f314aca14e11ad139331ba8e", "patch": "@@ -3209,9 +3209,12 @@ convert_nontype_argument (tree type, tree expr)\n \ttree type_referred_to = TREE_TYPE (type);\n \n \t/* If this expression already has reference type, get the\n-\t   underling object.  */\n+\t   underlying object.  */\n \tif (TREE_CODE (expr_type) == REFERENCE_TYPE) \n \t  {\n+\t    if (TREE_CODE (expr) == NOP_EXPR\n+\t\t&& TREE_CODE (TREE_OPERAND (expr, 0)) == ADDR_EXPR)\n+\t      STRIP_NOPS (expr);\n \t    my_friendly_assert (TREE_CODE (expr) == ADDR_EXPR, 20000604);\n \t    expr = TREE_OPERAND (expr, 0);\n \t    expr_type = TREE_TYPE (expr);\n@@ -3265,7 +3268,7 @@ convert_nontype_argument (tree type, tree expr)\n \t  }\n \n \tcxx_mark_addressable (expr);\n-\treturn build1 (ADDR_EXPR, type, expr);\n+\treturn build_nop (type, build_address (expr));\n       }\n       break;\n "}, {"sha": "2cac015c21aba608c2c590c3324514158eef8627", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3281be05bc239a26f314aca14e11ad139331ba8e/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3281be05bc239a26f314aca14e11ad139331ba8e/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=3281be05bc239a26f314aca14e11ad139331ba8e", "patch": "@@ -1,5 +1,8 @@\n 2003-09-02  Mark Mitchell  <mark@codesourcery.com>\n \n+\tPR c++/11847\n+\t* g++.dg/template/class1.C: New test.\n+\n \tPR c++/11808\n \t* g++.dg/expr/call1.C: New test.\n "}, {"sha": "96415fbc2254dfc1da8f9c6c6ae012b2a956bae1", "filename": "gcc/testsuite/g++.dg/template/class1.C", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3281be05bc239a26f314aca14e11ad139331ba8e/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fclass1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3281be05bc239a26f314aca14e11ad139331ba8e/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fclass1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fclass1.C?ref=3281be05bc239a26f314aca14e11ad139331ba8e", "patch": "@@ -0,0 +1,9 @@\n+extern const int a;\n+\n+template <const int&> class X {};\n+\n+template <typename> struct Y {\n+    X<a> x;\n+};\n+\n+template struct Y<int>;"}]}