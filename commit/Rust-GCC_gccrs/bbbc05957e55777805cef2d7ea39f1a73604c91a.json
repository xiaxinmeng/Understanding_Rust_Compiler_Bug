{"sha": "bbbc05957e55777805cef2d7ea39f1a73604c91a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmJiYzA1OTU3ZTU1Nzc3ODA1Y2VmMmQ3ZWEzOWYxYTczNjA0YzkxYQ==", "commit": {"author": {"name": "Olivier Hainque", "email": "hainque@adacore.com", "date": "2019-12-30T22:16:37Z"}, "committer": {"name": "Olivier Hainque", "email": "hainque@gcc.gnu.org", "date": "2019-12-30T22:16:37Z"}, "message": "Arrange to preinclude yvals.h ahead of stdint on VxWorks 7\n\nOn Vxworks 7, includers of stdint.h (which we currently \"provide\")\nneed yvals.h to have been included ahead.\n\nInstead of altering the common stdint-gcc.h with unpleasant\nvxworks specific bits to do that, we arrange to provide stdint-gcc.h\non its own along with a stdint.h wrapper which preincludes yvals.h\non vx7 then includes stdint-gcc.h.\n\n2019-12-30  Olivier Hainque  <hainque@adacore.com>\n\n\t* config/vxworks/stdint.h: New file.  Include _yvals.h\n\tthen stdint-gcc.h.\n\t* config/t-vxworks: Arrange to install the stdint.h wrapper.\n\t* config.gcc (*-*-vxworks*): Add stdint-gcc.h to $extra_headers\n\tso it gets copied.  Set use_gcc_stdint to request _not_ crafting\n\tstdint.h through the common Makefile rules.\n\nFrom-SVN: r279791", "tree": {"sha": "f744cc96d2d499bc85a6853969c8b40a9da82506", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f744cc96d2d499bc85a6853969c8b40a9da82506"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bbbc05957e55777805cef2d7ea39f1a73604c91a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bbbc05957e55777805cef2d7ea39f1a73604c91a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bbbc05957e55777805cef2d7ea39f1a73604c91a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bbbc05957e55777805cef2d7ea39f1a73604c91a/comments", "author": {"login": "hainque", "id": 18735142, "node_id": "MDQ6VXNlcjE4NzM1MTQy", "avatar_url": "https://avatars.githubusercontent.com/u/18735142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hainque", "html_url": "https://github.com/hainque", "followers_url": "https://api.github.com/users/hainque/followers", "following_url": "https://api.github.com/users/hainque/following{/other_user}", "gists_url": "https://api.github.com/users/hainque/gists{/gist_id}", "starred_url": "https://api.github.com/users/hainque/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hainque/subscriptions", "organizations_url": "https://api.github.com/users/hainque/orgs", "repos_url": "https://api.github.com/users/hainque/repos", "events_url": "https://api.github.com/users/hainque/events{/privacy}", "received_events_url": "https://api.github.com/users/hainque/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "9905fec4d901d9d9caac74795758e021ef39c25b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9905fec4d901d9d9caac74795758e021ef39c25b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9905fec4d901d9d9caac74795758e021ef39c25b"}], "stats": {"total": 63, "additions": 60, "deletions": 3}, "files": [{"sha": "03e3f80361697357e71284f1a586031856a127e3", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bbbc05957e55777805cef2d7ea39f1a73604c91a/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bbbc05957e55777805cef2d7ea39f1a73604c91a/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=bbbc05957e55777805cef2d7ea39f1a73604c91a", "patch": "@@ -1,3 +1,12 @@\n+2019-12-30  Olivier Hainque  <hainque@adacore.com>\n+\n+\t* config/vxworks/stdint.h: New file.  Include _yvals.h\n+\tthen stdint-gcc.h.\n+\t* config/t-vxworks: Arrange to install the stdint.h wrapper.\n+\t* config.gcc (*-*-vxworks*): Add stdint-gcc.h to $extra_headers\n+\tso it gets copied.  Set use_gcc_stdint to request _not_ crafting\n+\tstdint.h through the common Makefile rules.\n+\n 2019-12-30  Olivier Hainque  <hainque@adacore.com>\n \n \t* config/vxworks/_yvals.h: New file."}, {"sha": "8c2ff9a0def6b34947ea70345d4d991833377bae", "filename": "gcc/config.gcc", "status": "modified", "additions": 11, "deletions": 3, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bbbc05957e55777805cef2d7ea39f1a73604c91a/gcc%2Fconfig.gcc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bbbc05957e55777805cef2d7ea39f1a73604c91a/gcc%2Fconfig.gcc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig.gcc?ref=bbbc05957e55777805cef2d7ea39f1a73604c91a", "patch": "@@ -962,9 +962,6 @@ case ${target} in\n   extra_headers=\"${extra_headers} ../vxworks/vxworks-predef.h\"\n   target_has_targetcm=\"yes\"\n \n-  use_gcc_stdint=provide\n-  tm_file=\"${tm_file} vxworks-stdint.h\"\n-\n   # This private header exposes a consistent interface for checks on\n   # the VxWorks version our runtime header files need to perform, based on\n   # what the system headers adverstise:\n@@ -982,6 +979,17 @@ case ${target} in\n   extra_headers=\"${extra_headers} ../vxworks/math.h ../vxworks/complex.h\"\n   extra_headers=\"${extra_headers} ../vxworks/inttypes.h ../vxworks/setjmp.h\"\n \n+  # We provide stdint.h ...\n+\n+  tm_file=\"${tm_file} vxworks-stdint.h\"\n+\n+  # .. only through the yvals conditional wrapping mentioned above\n+  # to abide by the VxWorks 7 expectations.  The final copy is performed\n+  # explicitly by a t-vxworks Makefile rule.\n+\n+  use_gcc_stdint=none\n+  extra_headers=\"${extra_headers} ../../ginclude/stdint-gcc.h\"\n+\n   case ${enable_threads} in\n     no) ;;\n     \"\" | yes | vxworks) thread_file='vxworks' ;;"}, {"sha": "4f9646dd9615434a6c24689adb5f64e801f03c1a", "filename": "gcc/config/t-vxworks", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bbbc05957e55777805cef2d7ea39f1a73604c91a/gcc%2Fconfig%2Ft-vxworks", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bbbc05957e55777805cef2d7ea39f1a73604c91a/gcc%2Fconfig%2Ft-vxworks", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Ft-vxworks?ref=bbbc05957e55777805cef2d7ea39f1a73604c91a", "patch": "@@ -24,6 +24,18 @@ vxworks-c.o: $(srcdir)/config/vxworks-c.c\n \t$(COMPILE) $<\n \t$(POSTCOMPILE)\n \n+# Arrange to install our stdint.h wrapper, by copying it in the\n+# build-time include dir before this include dir is installed and after\n+# stmp-int-hdrs removes it (because it was told we don't provide it).\n+\n+INSTALL_HEADERS += install-stdint.h\n+\n+install-stdint.h: stmp-int-hdrs\n+\tcp -p $(srcdir)/config/vxworks/stdint.h include/stdint.h\n+\tchmod a+r include/stdint.h\n+\n+$(INSTALL_HEADERS_DIR): install-stdint.h\n+\n # Both the kernel and RTP headers provide limits.h.  They embed VxWorks\n # specificities and are dated on some configurations so we both need to\n # provide our own version and make sure the system one gets exposed."}, {"sha": "5e0dbdfaabd0a9f6b2a85aaebba7d1ecd5672ee9", "filename": "gcc/config/vxworks/stdint.h", "status": "added", "additions": 28, "deletions": 0, "changes": 28, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bbbc05957e55777805cef2d7ea39f1a73604c91a/gcc%2Fconfig%2Fvxworks%2Fstdint.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bbbc05957e55777805cef2d7ea39f1a73604c91a/gcc%2Fconfig%2Fvxworks%2Fstdint.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fvxworks%2Fstdint.h?ref=bbbc05957e55777805cef2d7ea39f1a73604c91a", "patch": "@@ -0,0 +1,28 @@\n+/* This file is part of GCC.\n+\n+GCC is free software; you can redistribute it and/or modify it under\n+the terms of the GNU General Public License as published by the Free\n+Software Foundation; either version 3, or (at your option) any later\n+version.\n+\n+GCC is distributed in the hope that it will be useful, but WITHOUT ANY\n+WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+for more details.\n+\n+Under Section 7 of GPL version 3, you are granted additional\n+permissions described in the GCC Runtime Library Exception, version\n+3.1, as published by the Free Software Foundation.\n+\n+You should have received a copy of the GNU General Public License and\n+a copy of the GCC Runtime Library Exception along with this program;\n+see the files COPYING3 and COPYING.RUNTIME respectively.  If not, see\n+<http://www.gnu.org/licenses/>.  */\n+\n+#ifndef __GCC_STDINT_H\n+#define __GCC_STDINT_H\n+\n+#include <_yvals.h>\n+#include <stdint-gcc.h>\n+\n+#endif"}]}