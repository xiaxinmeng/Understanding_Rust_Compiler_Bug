{"sha": "8a14b86bcf047c938ba81db3e00efb6079d830df", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OGExNGI4NmJjZjA0N2M5MzhiYTgxZGIzZTAwZWZiNjA3OWQ4MzBkZg==", "commit": {"author": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2016-08-04T00:10:35Z"}, "committer": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2016-08-04T00:10:35Z"}, "message": "escape: Enable escape analysis in gccgo.\n\n    \n    Off by default, enabled through -fgo-optimize-allocs.\n    \n    Reviewed-on: https://go-review.googlesource.com/22378\n\nFrom-SVN: r239109", "tree": {"sha": "768c2443a0cfaad5a295f4c64a5ccd42bd2aecc7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/768c2443a0cfaad5a295f4c64a5ccd42bd2aecc7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8a14b86bcf047c938ba81db3e00efb6079d830df", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8a14b86bcf047c938ba81db3e00efb6079d830df", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8a14b86bcf047c938ba81db3e00efb6079d830df", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8a14b86bcf047c938ba81db3e00efb6079d830df/comments", "author": null, "committer": null, "parents": [{"sha": "2f9436e96c444070aa9ab9f00ac3a12b17ebfac9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2f9436e96c444070aa9ab9f00ac3a12b17ebfac9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2f9436e96c444070aa9ab9f00ac3a12b17ebfac9"}], "stats": {"total": 13, "additions": 12, "deletions": 1}, "files": [{"sha": "ba99743f8d2c73093b55ecef5f7f33995493c28c", "filename": "gcc/go/gofrontend/MERGE", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8a14b86bcf047c938ba81db3e00efb6079d830df/gcc%2Fgo%2Fgofrontend%2FMERGE", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8a14b86bcf047c938ba81db3e00efb6079d830df/gcc%2Fgo%2Fgofrontend%2FMERGE", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgo%2Fgofrontend%2FMERGE?ref=8a14b86bcf047c938ba81db3e00efb6079d830df", "patch": "@@ -1,4 +1,4 @@\n-3096ac81185edacbf800783f0f803d1c419dccdd\n+4ba387176e8a826dd5dd6cad4caa2f93434d0b14\n \n The first line of this file holds the git revision number of the last\n merge done from the gofrontend repository."}, {"sha": "dfe6eb230fc37eb75d0218f5ee713b917ee89a39", "filename": "gcc/go/gofrontend/escape.cc", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8a14b86bcf047c938ba81db3e00efb6079d830df/gcc%2Fgo%2Fgofrontend%2Fescape.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8a14b86bcf047c938ba81db3e00efb6079d830df/gcc%2Fgo%2Fgofrontend%2Fescape.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgo%2Fgofrontend%2Fescape.cc?ref=8a14b86bcf047c938ba81db3e00efb6079d830df", "patch": "@@ -14,6 +14,7 @@\n #include \"statements.h\"\n #include \"escape.h\"\n #include \"ast-dump.h\"\n+#include \"go-optimize.h\"\n \n // class Node.\n \n@@ -678,11 +679,19 @@ Escape_note::parse_tag(std::string* tag)\n   return encoding;\n }\n \n+\n+// The -fgo-optimize-alloc flag activates this escape analysis.\n+\n+Go_optimize optimize_allocation_flag(\"allocs\");\n+\n // Analyze the program flow for escape information.\n \n void\n Gogo::analyze_escape()\n {\n+  if (!optimize_allocation_flag.is_enabled() || saw_errors())\n+    return;\n+\n   // Discover strongly connected groups of functions to analyze for escape\n   // information in this package.\n   this->discover_analysis_sets();"}, {"sha": "a0df2b801bddbac95b36ff16e21c279b42e456ab", "filename": "gcc/go/gofrontend/go.cc", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8a14b86bcf047c938ba81db3e00efb6079d830df/gcc%2Fgo%2Fgofrontend%2Fgo.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8a14b86bcf047c938ba81db3e00efb6079d830df/gcc%2Fgo%2Fgofrontend%2Fgo.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgo%2Fgofrontend%2Fgo.cc?ref=8a14b86bcf047c938ba81db3e00efb6079d830df", "patch": "@@ -112,6 +112,8 @@ go_parse_input_files(const char** filenames, unsigned int filename_count,\n   if (only_check_syntax)\n     return;\n \n+  ::gogo->analyze_escape();\n+\n   // Export global identifiers as appropriate.\n   ::gogo->do_exports();\n "}]}