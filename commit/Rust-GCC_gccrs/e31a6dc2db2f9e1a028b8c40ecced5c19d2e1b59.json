{"sha": "e31a6dc2db2f9e1a028b8c40ecced5c19d2e1b59", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTMxYTZkYzJkYjJmOWUxYTAyOGI4YzQwZWNjZWQ1YzE5ZDJlMWI1OQ==", "commit": {"author": {"name": "Bernhard Reutner-Fischer", "email": "aldot@gcc.gnu.org", "date": "2010-06-15T08:35:25Z"}, "committer": {"name": "Bernhard Reutner-Fischer", "email": "aldot@gcc.gnu.org", "date": "2010-06-15T08:35:25Z"}, "message": "gcc_update: Support updating a git clone.\n\n2010-06-15  Bernhard Reutner-Fischer  <aldot@gcc.gnu.org>\n\n\t* gcc_update: Support updating a git clone.\n\nFrom-SVN: r160774", "tree": {"sha": "8e9add2a8401af9f5fc85a090a7fb576f55aa3a1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8e9add2a8401af9f5fc85a090a7fb576f55aa3a1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e31a6dc2db2f9e1a028b8c40ecced5c19d2e1b59", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e31a6dc2db2f9e1a028b8c40ecced5c19d2e1b59", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e31a6dc2db2f9e1a028b8c40ecced5c19d2e1b59", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e31a6dc2db2f9e1a028b8c40ecced5c19d2e1b59/comments", "author": null, "committer": null, "parents": [{"sha": "070b27da92a270f1ada5ee00c04ee697255f2652", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/070b27da92a270f1ada5ee00c04ee697255f2652", "html_url": "https://github.com/Rust-GCC/gccrs/commit/070b27da92a270f1ada5ee00c04ee697255f2652"}], "stats": {"total": 35, "additions": 34, "deletions": 1}, "files": [{"sha": "5037767c2af277f4a992960cdc07c1755fb82926", "filename": "contrib/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e31a6dc2db2f9e1a028b8c40ecced5c19d2e1b59/contrib%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e31a6dc2db2f9e1a028b8c40ecced5c19d2e1b59/contrib%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2FChangeLog?ref=e31a6dc2db2f9e1a028b8c40ecced5c19d2e1b59", "patch": "@@ -1,3 +1,7 @@\n+2010-06-15  Bernhard Reutner-Fischer  <aldot@gcc.gnu.org>\n+\n+\t* gcc_update: Support updating a git clone.\n+\n 2010-06-04  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>\n \n \t* test_summary: Don't use diff -u."}, {"sha": "cfae86a50c6250ccc2cff24c5eca0118c587d955", "filename": "contrib/gcc_update", "status": "modified", "additions": 30, "deletions": 1, "changes": 31, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e31a6dc2db2f9e1a028b8c40ecced5c19d2e1b59/contrib%2Fgcc_update", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e31a6dc2db2f9e1a028b8c40ecced5c19d2e1b59/contrib%2Fgcc_update", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2Fgcc_update?ref=e31a6dc2db2f9e1a028b8c40ecced5c19d2e1b59", "patch": "@@ -245,8 +245,13 @@ p\n \n esac\n \n+is_git=0\n # Check whether this indeed looks like a local SVN tree.\n-if [ ! -d .svn ]; then\n+if [ -d .git ]; then\n+    GCC_GIT=${GCC_GIT-${GIT-git}}\n+    GCC_SVN=\"true -\"\n+    is_git=1\n+elif [ ! -d .svn ]; then\n     echo \"This does not seem to be a GCC SVN tree!\"\n     exit\n fi\n@@ -258,6 +263,7 @@ else\n     set -- $UPDATE_OPTIONS ${1+\"$@\"}\n fi\n \n+if [ $is_git -eq 0 ]; then\n chat \"Updating SVN tree\"\n \n $GCC_SVN ${silent+-q}  --non-interactive update ${1+\"$@\"}\n@@ -283,4 +289,27 @@ p\n \n echo \"[$branch revision $revision]\" > gcc/REVISION\n \n+else\n+    chat \"Updating GIT tree\"\n+    $GCC_GIT diff --quiet --exit-code HEAD\n+    if [ $? -ne 0 ]; then\n+        echo \"Attempting to update a dirty git tree!\" >&2\n+        echo \"Commit or stash your changes first and retry.\" >&2\n+        exit 1\n+    fi\n+    $GCC_GIT pull ${silent+-q} --rebase ${1+\"$@\"}\n+    if [ $? -ne 0 ]; then\n+        (touch_files_reexec)\n+        echo \"git pull of full tree failed.\" >&2\n+        exit 1\n+    fi\n+    rm -f LAST_UPDATED gcc/REVISION\n+    revision=`$GCC_GIT log -n1 --pretty=%p:%t:%H`\n+    branch=`$GCC_GIT name-rev --name-only HEAD || :`\n+    {\n+      date\n+      echo \"`TZ=UTC date` (revision $revision)\"\n+    } > LAST_UPDATED\n+    echo \"[$branch revision $revision]\" > gcc/REVISION\n+fi\n touch_files_reexec"}]}