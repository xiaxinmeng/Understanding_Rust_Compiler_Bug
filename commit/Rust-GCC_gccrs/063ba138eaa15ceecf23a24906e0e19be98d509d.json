{"sha": "063ba138eaa15ceecf23a24906e0e19be98d509d", "node_id": "C_kwDOANBUbNoAKDA2M2JhMTM4ZWFhMTVjZWVjZjIzYTI0OTA2ZTBlMTliZTk4ZDUwOWQ", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2022-11-29T09:41:36Z"}, "committer": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2022-11-29T11:59:23Z"}, "message": "tree-optimization/106995 - if-conversion and vanishing loops\n\nWhen we version loops for vectorization during if-conversion it\ncan happen that either loop vanishes because we run some VN and\nCFG cleanup.  If the to-be vectorized part vanishes we already\nredirect the versioning condition to the original loop.  The following\ndoes the same in case the original loop vanishes as happened\nfor the testcase in the bug in the past (but no longer).\n\n\tPR tree-optimization/106995\n\t* tree-if-conv.cc (pass_if_conversion::execute): Also redirect the\n\tversioning condition to the original loop if this very loop\n\tvanished during CFG cleanup.", "tree": {"sha": "4fffaf937ce836595671f1db45b14b257b55ab0a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4fffaf937ce836595671f1db45b14b257b55ab0a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/063ba138eaa15ceecf23a24906e0e19be98d509d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/063ba138eaa15ceecf23a24906e0e19be98d509d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/063ba138eaa15ceecf23a24906e0e19be98d509d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/063ba138eaa15ceecf23a24906e0e19be98d509d/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ffabce849033e57ebaf60029822b81e981681c21", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ffabce849033e57ebaf60029822b81e981681c21", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ffabce849033e57ebaf60029822b81e981681c21"}], "stats": {"total": 3, "additions": 2, "deletions": 1}, "files": [{"sha": "64b20b4a9e11fe53d7a4bd188c514fdf759b3f3b", "filename": "gcc/tree-if-conv.cc", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/063ba138eaa15ceecf23a24906e0e19be98d509d/gcc%2Ftree-if-conv.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/063ba138eaa15ceecf23a24906e0e19be98d509d/gcc%2Ftree-if-conv.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-if-conv.cc?ref=063ba138eaa15ceecf23a24906e0e19be98d509d", "patch": "@@ -3761,7 +3761,8 @@ pass_if_conversion::execute (function *fun)\n       if (!gimple_bb (g))\n \tcontinue;\n       unsigned ifcvt_loop = tree_to_uhwi (gimple_call_arg (g, 0));\n-      if (!get_loop (fun, ifcvt_loop))\n+      unsigned orig_loop = tree_to_uhwi (gimple_call_arg (g, 1));\n+      if (!get_loop (fun, ifcvt_loop) || !get_loop (fun, orig_loop))\n \t{\n \t  if (dump_file)\n \t    fprintf (dump_file, \"If-converted loop vanished\\n\");"}]}