{"sha": "7e98cccbd85a0bc5ec6b7edf0017d98c2e96aef5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2U5OGNjY2JkODVhMGJjNWVjNmI3ZWRmMDAxN2Q5OGMyZTk2YWVmNQ==", "commit": {"author": {"name": "Steven G. Kargl", "email": "kargl@gcc.gnu.org", "date": "2016-11-22T21:52:15Z"}, "committer": {"name": "Steven G. Kargl", "email": "kargl@gcc.gnu.org", "date": "2016-11-22T21:52:15Z"}, "message": "re PR fortran/78479 (ICE in gfc_apply_init, at fortran/expr.c:4135)\n\n2016-11-22  Steven G. Kargl  <kargl@gcc.gnu.org>\n\n\tPR fortran/78479\n\t* expr.c (gfc_apply_init):  Allocate a charlen if needed.\n\n2016-11-22  Steven G. Kargl  <kargl@gcc.gnu.org>\n\n\tPR fortran/78479\n\t* gfortran.dg/char_component_initializer_3.f90: New test.\n\nFrom-SVN: r242725", "tree": {"sha": "8bceaa50e6ac9a2dbefc7dcde232417bd2186f0f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8bceaa50e6ac9a2dbefc7dcde232417bd2186f0f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7e98cccbd85a0bc5ec6b7edf0017d98c2e96aef5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7e98cccbd85a0bc5ec6b7edf0017d98c2e96aef5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7e98cccbd85a0bc5ec6b7edf0017d98c2e96aef5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7e98cccbd85a0bc5ec6b7edf0017d98c2e96aef5/comments", "author": null, "committer": null, "parents": [{"sha": "7239bf746acb27f8b116e0fbf1b6e40ec12d40d3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7239bf746acb27f8b116e0fbf1b6e40ec12d40d3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7239bf746acb27f8b116e0fbf1b6e40ec12d40d3"}], "stats": {"total": 23, "additions": 22, "deletions": 1}, "files": [{"sha": "1ea1c2cbc9f6edb59b81333f3d6000168afdc2c7", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7e98cccbd85a0bc5ec6b7edf0017d98c2e96aef5/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7e98cccbd85a0bc5ec6b7edf0017d98c2e96aef5/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=7e98cccbd85a0bc5ec6b7edf0017d98c2e96aef5", "patch": "@@ -1,3 +1,8 @@\n+2016-11-22  Steven G. Kargl  <kargl@gcc.gnu.org>\n+\n+\tPR fortran/78479\n+\t* expr.c (gfc_apply_init):  Allocate a charlen if needed.\n+\n 2016-11-22  Janus Weil  <janus@gcc.gnu.org>\n \n \tPR fortran/78443"}, {"sha": "b028d81ba6d07f37d1398ae32ddbb744c678052e", "filename": "gcc/fortran/expr.c", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7e98cccbd85a0bc5ec6b7edf0017d98c2e96aef5/gcc%2Ffortran%2Fexpr.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7e98cccbd85a0bc5ec6b7edf0017d98c2e96aef5/gcc%2Ffortran%2Fexpr.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fexpr.c?ref=7e98cccbd85a0bc5ec6b7edf0017d98c2e96aef5", "patch": "@@ -4132,7 +4132,12 @@ gfc_apply_init (gfc_typespec *ts, symbol_attribute *attr, gfc_expr *init)\n                 {\n                   gfc_set_constant_character_len (len, ctor->expr,\n                                                   has_ts ? -1 : first_len);\n-                  ctor->expr->ts.u.cl->length = gfc_copy_expr (ts->u.cl->length);\n+\t\t  if (!ctor->expr->ts.u.cl)\n+\t\t    ctor->expr->ts.u.cl\n+\t\t      = gfc_new_charlen (gfc_current_ns, ts->u.cl);\n+\t\t  else\n+                    ctor->expr->ts.u.cl->length\n+\t\t      = gfc_copy_expr (ts->u.cl->length);\n                 }\n             }\n         }"}, {"sha": "bb5ce39e33d5bff2fdf9a27e0ddc8c582d63539b", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7e98cccbd85a0bc5ec6b7edf0017d98c2e96aef5/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7e98cccbd85a0bc5ec6b7edf0017d98c2e96aef5/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=7e98cccbd85a0bc5ec6b7edf0017d98c2e96aef5", "patch": "@@ -1,3 +1,8 @@\n+2016-11-22  Steven G. Kargl  <kargl@gcc.gnu.org>\n+\n+\tPR fortran/78479\n+\t* gfortran.dg/char_component_initializer_3.f90: New test.\n+\n 2016-11-22  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR target/78451"}, {"sha": "634da4a8f69644562424c09f118e5bc6edc4bd3e", "filename": "gcc/testsuite/gfortran.dg/char_component_initializer_3.f90", "status": "added", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7e98cccbd85a0bc5ec6b7edf0017d98c2e96aef5/gcc%2Ftestsuite%2Fgfortran.dg%2Fchar_component_initializer_3.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7e98cccbd85a0bc5ec6b7edf0017d98c2e96aef5/gcc%2Ftestsuite%2Fgfortran.dg%2Fchar_component_initializer_3.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fchar_component_initializer_3.f90?ref=7e98cccbd85a0bc5ec6b7edf0017d98c2e96aef5", "patch": "@@ -0,0 +1,6 @@\n+! { dg-do compile }\n+program p\n+   type t\n+      character(3) :: c(1) = 'a' // ['b']\n+   end type\n+end"}]}