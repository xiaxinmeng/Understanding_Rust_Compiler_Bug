{"sha": "1e5c644fb62e3e1757cf74fe8a14873d5e8ba53e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWU1YzY0NGZiNjJlM2UxNzU3Y2Y3NGZlOGExNDg3M2Q1ZThiYTUzZQ==", "commit": {"author": {"name": "Martin Liska", "email": "mliska@suse.cz", "date": "2020-11-30T12:41:26Z"}, "committer": {"name": "Martin Liska", "email": "mliska@suse.cz", "date": "2020-11-30T12:42:25Z"}, "message": "changelog: allow subdir wildcard entry\n\ncontrib/ChangeLog:\n\n\t* gcc-changelog/git_commit.py: Allow sub-directory wildcard\n\tchangelog entry. Fix a typo caused by apostrophe escaping.\n\t* gcc-changelog/test_email.py: Test it.\n\t* gcc-changelog/test_patches.txt: Likewise.", "tree": {"sha": "2b652a9da64852bf2e2698e331d5c166000cd78f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2b652a9da64852bf2e2698e331d5c166000cd78f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1e5c644fb62e3e1757cf74fe8a14873d5e8ba53e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1e5c644fb62e3e1757cf74fe8a14873d5e8ba53e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1e5c644fb62e3e1757cf74fe8a14873d5e8ba53e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1e5c644fb62e3e1757cf74fe8a14873d5e8ba53e/comments", "author": {"login": "marxin", "id": 2658545, "node_id": "MDQ6VXNlcjI2NTg1NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/2658545?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marxin", "html_url": "https://github.com/marxin", "followers_url": "https://api.github.com/users/marxin/followers", "following_url": "https://api.github.com/users/marxin/following{/other_user}", "gists_url": "https://api.github.com/users/marxin/gists{/gist_id}", "starred_url": "https://api.github.com/users/marxin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marxin/subscriptions", "organizations_url": "https://api.github.com/users/marxin/orgs", "repos_url": "https://api.github.com/users/marxin/repos", "events_url": "https://api.github.com/users/marxin/events{/privacy}", "received_events_url": "https://api.github.com/users/marxin/received_events", "type": "User", "site_admin": false}, "committer": {"login": "marxin", "id": 2658545, "node_id": "MDQ6VXNlcjI2NTg1NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/2658545?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marxin", "html_url": "https://github.com/marxin", "followers_url": "https://api.github.com/users/marxin/followers", "following_url": "https://api.github.com/users/marxin/following{/other_user}", "gists_url": "https://api.github.com/users/marxin/gists{/gist_id}", "starred_url": "https://api.github.com/users/marxin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marxin/subscriptions", "organizations_url": "https://api.github.com/users/marxin/orgs", "repos_url": "https://api.github.com/users/marxin/repos", "events_url": "https://api.github.com/users/marxin/events{/privacy}", "received_events_url": "https://api.github.com/users/marxin/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d795a8ef4e02a96ab060b330d38ef923a198c7ce", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d795a8ef4e02a96ab060b330d38ef923a198c7ce", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d795a8ef4e02a96ab060b330d38ef923a198c7ce"}], "stats": {"total": 37, "additions": 34, "deletions": 3}, "files": [{"sha": "57fba756d32ef67894d5c044942c0092e44b7fec", "filename": "contrib/gcc-changelog/git_commit.py", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1e5c644fb62e3e1757cf74fe8a14873d5e8ba53e/contrib%2Fgcc-changelog%2Fgit_commit.py", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1e5c644fb62e3e1757cf74fe8a14873d5e8ba53e/contrib%2Fgcc-changelog%2Fgit_commit.py", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2Fgcc-changelog%2Fgit_commit.py?ref=1e5c644fb62e3e1757cf74fe8a14873d5e8ba53e", "patch": "@@ -493,7 +493,7 @@ def check_file_patterns(self):\n         for entry in self.changelog_entries:\n             for pattern in entry.file_patterns:\n                 name = os.path.join(entry.folder, pattern)\n-                if name not in wildcard_prefixes:\n+                if not [name.startswith(pr) for pr in wildcard_prefixes]:\n                     msg = 'unsupported wildcard prefix'\n                     self.errors.append(Error(msg, name))\n \n@@ -617,7 +617,7 @@ def check_mentioned_files(self):\n \n         for pattern in mentioned_patterns:\n             if pattern not in used_patterns:\n-                error = 'pattern doesn''t match any changed files'\n+                error = \"pattern doesn't match any changed files\"\n                 self.errors.append(Error(error, pattern))\n \n     def check_for_correct_changelog(self):"}, {"sha": "48ecc1ee6a6e4d88e5f4a02b2d1335c75c50113e", "filename": "contrib/gcc-changelog/test_email.py", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1e5c644fb62e3e1757cf74fe8a14873d5e8ba53e/contrib%2Fgcc-changelog%2Ftest_email.py", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1e5c644fb62e3e1757cf74fe8a14873d5e8ba53e/contrib%2Fgcc-changelog%2Ftest_email.py", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2Fgcc-changelog%2Ftest_email.py?ref=1e5c644fb62e3e1757cf74fe8a14873d5e8ba53e", "patch": "@@ -333,7 +333,7 @@ def test_libstdcxx_html_regenerated(self):\n         assert not email.errors\n         email = self.from_patch_glob('0002-libstdc-Fake-test-change-1.patch')\n         assert len(email.errors) == 1\n-        msg = 'pattern doesn''t match any changed files'\n+        msg = \"pattern doesn't match any changed files\"\n         assert email.errors[0].message == msg\n         assert email.errors[0].line == 'libstdc++-v3/doc/html/'\n         email = self.from_patch_glob('0003-libstdc-Fake-test-change-2.patch')\n@@ -386,3 +386,10 @@ def test_emptry_entry_desc_2(self):\n         email = self.from_patch_glob('0001-lto-fix-LTO-debug')\n         assert not email.errors\n         assert len(email.changelog_entries) == 1\n+\n+    def test_wildcard_in_subdir(self):\n+        email = self.from_patch_glob('0001-Wildcard-subdirs.patch')\n+        assert len(email.changelog_entries) == 1\n+        err = email.errors[0]\n+        assert err.message == \"pattern doesn't match any changed files\"\n+        assert err.line == 'libstdc++-v3/testsuite/28_regex_not-existing/'"}, {"sha": "02ce28d20b867111ce3c187bac9f01c0d3940570", "filename": "contrib/gcc-changelog/test_patches.txt", "status": "modified", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1e5c644fb62e3e1757cf74fe8a14873d5e8ba53e/contrib%2Fgcc-changelog%2Ftest_patches.txt", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1e5c644fb62e3e1757cf74fe8a14873d5e8ba53e/contrib%2Fgcc-changelog%2Ftest_patches.txt", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2Fgcc-changelog%2Ftest_patches.txt?ref=1e5c644fb62e3e1757cf74fe8a14873d5e8ba53e", "patch": "@@ -3320,3 +3320,27 @@ index 7c9d492f6a4..37e73348cb7 100644\n -- \n 2.25.1\n \n+=== 0001-Wildcard-subdirs.patch ===\n+From b798205595426c53eb362065f6ed6c320dcc161d Mon Sep 17 00:00:00 2001\n+From: Martin Liska <mliska@suse.cz>\n+Date: Mon, 30 Nov 2020 13:27:51 +0100\n+Subject: [PATCH] Fix it.\n+\n+libstdc++-v3/ChangeLog:\n+\n+\t* testsuite/28_regex/*: Fix them all.\n+\t* testsuite/28_regex_not-existing/*: Fix them all.\n+---\n+ contrib/gcc-changelog/git_commit.py          | 1 +\n+ libstdc++-v3/testsuite/28_regex/init-list.cc | 1 +\n+ 2 files changed, 2 insertions(+)\n+\n+diff --git a/libstdc++-v3/testsuite/28_regex/init-list.cc b/libstdc++-v3/testsuite/28_regex/init-list.cc\n+index f51453f019a..d10ecf483f4 100644\n+--- a/libstdc++-v3/testsuite/28_regex/init-list.cc\n++++ b/libstdc++-v3/testsuite/28_regex/init-list.cc\n+@@ -1 +1,2 @@\n+ \n++\n+--\n+2.29.2"}]}