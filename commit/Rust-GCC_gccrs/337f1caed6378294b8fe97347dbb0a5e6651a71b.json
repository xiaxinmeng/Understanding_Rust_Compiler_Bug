{"sha": "337f1caed6378294b8fe97347dbb0a5e6651a71b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzM3ZjFjYWVkNjM3ODI5NGI4ZmU5NzM0N2RiYjBhNWU2NjUxYTcxYg==", "commit": {"author": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2019-03-01T14:21:24Z"}, "committer": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2019-03-01T14:21:24Z"}, "message": "runtime: call execname and getpagesize on Solaris\n    \n    Interpreting auxv as []uintptr is incorrect on 64-bit big-endian,\n    as auxv alternates a 32-bit int with a 64-bit pointer.\n    \n    Patch from Rainer Orth.\n    \n    Reviewed-on: https://go-review.googlesource.com/c/164739\n\nFrom-SVN: r269315", "tree": {"sha": "945f05bdcac9f3317a9d0861b704cf221c60cc64", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/945f05bdcac9f3317a9d0861b704cf221c60cc64"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/337f1caed6378294b8fe97347dbb0a5e6651a71b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/337f1caed6378294b8fe97347dbb0a5e6651a71b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/337f1caed6378294b8fe97347dbb0a5e6651a71b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/337f1caed6378294b8fe97347dbb0a5e6651a71b/comments", "author": null, "committer": null, "parents": [{"sha": "1259cb6d0034f36cce26ca8fd3d22d40bafce04a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1259cb6d0034f36cce26ca8fd3d22d40bafce04a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1259cb6d0034f36cce26ca8fd3d22d40bafce04a"}], "stats": {"total": 44, "additions": 9, "deletions": 35}, "files": [{"sha": "43c8b6bf1eb1dda461f655f78872a23998a1e8af", "filename": "gcc/go/gofrontend/MERGE", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/337f1caed6378294b8fe97347dbb0a5e6651a71b/gcc%2Fgo%2Fgofrontend%2FMERGE", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/337f1caed6378294b8fe97347dbb0a5e6651a71b/gcc%2Fgo%2Fgofrontend%2FMERGE", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgo%2Fgofrontend%2FMERGE?ref=337f1caed6378294b8fe97347dbb0a5e6651a71b", "patch": "@@ -1,4 +1,4 @@\n-d5e4595784fb744f5fa0e0f90e77de9b5448b793\n+805c82cc141c593ea2f27d8614ecd204e2b5e76e\n \n The first line of this file holds the git revision number of the last\n merge done from the gofrontend repository."}, {"sha": "e67d32c8054710b420b754fb08644bdebd2c9c30", "filename": "libgo/go/runtime/os3_solaris.go", "status": "modified", "additions": 8, "deletions": 34, "changes": 42, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/337f1caed6378294b8fe97347dbb0a5e6651a71b/libgo%2Fgo%2Fruntime%2Fos3_solaris.go", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/337f1caed6378294b8fe97347dbb0a5e6651a71b/libgo%2Fgo%2Fruntime%2Fos3_solaris.go", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgo%2Fgo%2Fruntime%2Fos3_solaris.go?ref=337f1caed6378294b8fe97347dbb0a5e6651a71b", "patch": "@@ -4,45 +4,19 @@\n \n package runtime\n \n-import (\n-\t\"runtime/internal/sys\"\n-\t\"unsafe\"\n-)\n+import _ \"unsafe\"\n \n var executablePath string\n \n-func sysargs(argc int32, argv **byte) {\n-\tn := argc + 1\n-\n-\t// skip over argv, envp to get to auxv\n-\tfor argv_index(argv, n) != nil {\n-\t\tn++\n-\t}\n+//extern getexecname\n+func getexecname() *byte\n \n-\t// skip NULL separator\n-\tn++\n+//extern getpagesize\n+func getpagesize() int32\n \n-\t// now argv+n is auxv\n-\tauxv := (*[1 << 28]uintptr)(add(unsafe.Pointer(argv), uintptr(n)*sys.PtrSize))\n-\tsysauxv(auxv[:])\n-}\n-\n-const (\n-\t_AT_NULL         = 0    // Terminates the vector\n-\t_AT_PAGESZ       = 6    // Page size in bytes\n-\t_AT_SUN_EXECNAME = 2014 // exec() path name\n-)\n-\n-func sysauxv(auxv []uintptr) {\n-\tfor i := 0; auxv[i] != _AT_NULL; i += 2 {\n-\t\ttag, val := auxv[i], auxv[i+1]\n-\t\tswitch tag {\n-\t\tcase _AT_PAGESZ:\n-\t\t\tphysPageSize = val\n-\t\tcase _AT_SUN_EXECNAME:\n-\t\t\texecutablePath = gostringnocopy((*byte)(unsafe.Pointer(val)))\n-\t\t}\n-\t}\n+func sysargs(argc int32, argv **byte) {\n+\tphysPageSize = uintptr(getpagesize())\n+\texecutablePath = gostringnocopy(getexecname())\n }\n \n //go:linkname solarisExecutablePath os.solarisExecutablePath"}]}