{"sha": "492cca24891e2927d0604e2297ab228950d889a6", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDkyY2NhMjQ4OTFlMjkyN2QwNjA0ZTIyOTdhYjIyODk1MGQ4ODlhNg==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "2000-11-11T23:50:20Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "2000-11-11T23:50:20Z"}, "message": "decl.c (maybe_commonize_var): Set DECL_UNINLINABLE for statics in inlines.\n\n        * decl.c (maybe_commonize_var): Set DECL_UNINLINABLE for statics\n        in inlines.\n\nFrom-SVN: r37394", "tree": {"sha": "41016f949c7ab976f805d5285478ff31b3f885d3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/41016f949c7ab976f805d5285478ff31b3f885d3"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/492cca24891e2927d0604e2297ab228950d889a6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/492cca24891e2927d0604e2297ab228950d889a6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/492cca24891e2927d0604e2297ab228950d889a6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/492cca24891e2927d0604e2297ab228950d889a6/comments", "author": null, "committer": null, "parents": [{"sha": "8ee322c99319bb283d6bd298a469482d9eed7004", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8ee322c99319bb283d6bd298a469482d9eed7004", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8ee322c99319bb283d6bd298a469482d9eed7004"}], "stats": {"total": 48, "additions": 44, "deletions": 4}, "files": [{"sha": "12947e1da4cd74a3cae81db9c012cc1020cced2e", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 9, "deletions": 4, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/492cca24891e2927d0604e2297ab228950d889a6/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/492cca24891e2927d0604e2297ab228950d889a6/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=492cca24891e2927d0604e2297ab228950d889a6", "patch": "@@ -1,3 +1,8 @@\n+2000-11-09  Jason Merrill  <jason@redhat.com>\n+\n+\t* decl.c (maybe_commonize_var): Set DECL_UNINLINABLE for statics\n+\tin inlines.\n+\n 2000-11-10  Kaveh R. Ghazi  <ghazi@caip.rutgers.edu>\n \n \t* decl.c (grokdeclarator, save_function_data): Use memcpy, not bcopy.\n@@ -28,10 +33,10 @@\n \t\n 2000-11-07  Eric Christopher  <echristo@redhat.com>\n \n-        * decl.c (init_decl_processing): Change definition of\n-        __wchar_t to wchar_t.  Remove artificial declaration of\n-        wchar_t.\n-        * lex.c: Change instances of __wchar_t to wchar_t.\n+\t* decl.c (init_decl_processing): Change definition of\n+\t__wchar_t to wchar_t.  Remove artificial declaration of\n+\twchar_t.\n+\t* lex.c: Change instances of __wchar_t to wchar_t.\n \n 2000-11-09  Nathan Sidwell  <nathan@codesourcery.com>\n "}, {"sha": "0d677febb115680955326a54dfacc2e2d5d25b43", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/492cca24891e2927d0604e2297ab228950d889a6/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/492cca24891e2927d0604e2297ab228950d889a6/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=492cca24891e2927d0604e2297ab228950d889a6", "patch": "@@ -7655,6 +7655,7 @@ maybe_commonize_var (decl)\n \t inlining of such functions.  */\n       current_function_cannot_inline\n \t= \"function with static variable cannot be inline\";\n+      DECL_UNINLINABLE (current_function_decl) = 1;\n \n       /* If flag_weak, we don't need to mess with this, as we can just\n \t make the function weak, and let it refer to its unique local"}, {"sha": "4f5a73ca3a0967b94ad1f2b9bcb0bbdc211e3a34", "filename": "gcc/testsuite/g++.old-deja/g++.other/comdat1-aux.cc", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/492cca24891e2927d0604e2297ab228950d889a6/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.other%2Fcomdat1-aux.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/492cca24891e2927d0604e2297ab228950d889a6/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.other%2Fcomdat1-aux.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.other%2Fcomdat1-aux.cc?ref=492cca24891e2927d0604e2297ab228950d889a6", "patch": "@@ -0,0 +1,10 @@\n+inline int f ()\n+{\n+  static int k;\n+  return ++k;\n+}\n+\n+int g ()\n+{\n+  return f();\n+}"}, {"sha": "5dd43a8c6d598a91fa822e0fb3009227e2714a83", "filename": "gcc/testsuite/g++.old-deja/g++.other/comdat1.C", "status": "added", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/492cca24891e2927d0604e2297ab228950d889a6/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.other%2Fcomdat1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/492cca24891e2927d0604e2297ab228950d889a6/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.other%2Fcomdat1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.other%2Fcomdat1.C?ref=492cca24891e2927d0604e2297ab228950d889a6", "patch": "@@ -0,0 +1,24 @@\n+// Test that statics in inline functions are unified between\n+// translation units.  Currently we handle this by just suppressing\n+// inling and relying on unification of the function itself.\n+\n+// Special g++ Options: -O\n+\n+// Additional sources: comdat1-aux.cc\n+\n+inline int f ()\n+{\n+  static int i;\n+  return ++i;\n+}\n+\n+int g ();\n+\n+int main ()\n+{\n+  if (f() != 1\n+      || g() != 2\n+      || f() != 3)\n+    return 1;\n+  return 0;\n+}"}]}