{"sha": "6001735ea0da3d5d89a8f249a79fc8198ff28513", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjAwMTczNWVhMGRhM2Q1ZDg5YThmMjQ5YTc5ZmM4MTk4ZmYyODUxMw==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2001-01-28T10:35:45Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2001-01-28T10:35:45Z"}, "message": "optimize.c (copy_body_r): If MODIFY_EXPR has both arguments identical and they would be replaced with...\n\n\t* optimize.c (copy_body_r): If MODIFY_EXPR has both arguments\n\tidentical and they would be replaced with constant, remove\n\tMODIFY_EXPR from the tree.\n\n\t* g++.old-deja/g++.other/inline18.C: New test.\n\nFrom-SVN: r39317", "tree": {"sha": "94c342ca0fab35fea5547deab7b00d988fa3f612", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/94c342ca0fab35fea5547deab7b00d988fa3f612"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6001735ea0da3d5d89a8f249a79fc8198ff28513", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6001735ea0da3d5d89a8f249a79fc8198ff28513", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6001735ea0da3d5d89a8f249a79fc8198ff28513", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6001735ea0da3d5d89a8f249a79fc8198ff28513/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "666bd4e75249b156c8fa42c38f0c4edd0000ea91", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/666bd4e75249b156c8fa42c38f0c4edd0000ea91", "html_url": "https://github.com/Rust-GCC/gccrs/commit/666bd4e75249b156c8fa42c38f0c4edd0000ea91"}], "stats": {"total": 43, "additions": 43, "deletions": 0}, "files": [{"sha": "3fd306d14ef543d4fba0a3e6656bc4fa8dd15414", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6001735ea0da3d5d89a8f249a79fc8198ff28513/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6001735ea0da3d5d89a8f249a79fc8198ff28513/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=6001735ea0da3d5d89a8f249a79fc8198ff28513", "patch": "@@ -1,3 +1,9 @@\n+2001-01-28  Jakub Jelinek  <jakub@redhat.com>\n+\n+\t* optimize.c (copy_body_r): If MODIFY_EXPR has both arguments\n+\tidentical and they would be replaced with constant, remove\n+\tMODIFY_EXPR from the tree.\n+\n 2001-01-27  Kaveh R. Ghazi  <ghazi@caip.rutgers.edu>\n \n \t* Make-lang.in: Remove all dependencies on defaults.h."}, {"sha": "7a7a27c5b02a4bb8939ade9123e7273509f19831", "filename": "gcc/cp/optimize.c", "status": "modified", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6001735ea0da3d5d89a8f249a79fc8198ff28513/gcc%2Fcp%2Foptimize.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6001735ea0da3d5d89a8f249a79fc8198ff28513/gcc%2Fcp%2Foptimize.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Foptimize.c?ref=6001735ea0da3d5d89a8f249a79fc8198ff28513", "patch": "@@ -338,6 +338,26 @@ copy_body_r (tp, walk_subtrees, data)\n \t  TREE_OPERAND (*tp, 1) = TREE_OPERAND (*tp, 3);\n \t  TREE_OPERAND (*tp, 3) = NULL_TREE;\n \t}\n+      else if (TREE_CODE (*tp) == MODIFY_EXPR\n+\t       && TREE_OPERAND (*tp, 0) == TREE_OPERAND (*tp, 1)\n+\t       && nonstatic_local_decl_p (TREE_OPERAND (*tp, 0))\n+\t       && DECL_CONTEXT (TREE_OPERAND (*tp, 0)) == fn)\n+\t{\n+\t  /* Assignments like a = a; don't generate any rtl code\n+\t     and don't count as variable modification.  Avoid\n+\t     keeping bogosities like 0 = 0.  */\n+\t  tree decl = TREE_OPERAND (*tp, 0), value;\n+\t  splay_tree_node n;\n+\n+\t  n = splay_tree_lookup (id->decl_map, (splay_tree_key) decl);\n+\t  if (n)\n+\t    {\n+\t      value = (tree) n->value;\n+\t      STRIP_TYPE_NOPS (value);\n+\t      if (TREE_CONSTANT (value) || TREE_READONLY_DECL_P (value))\n+\t\t*tp = value;\n+\t    }\n+\t}\n     }\n \n   /* Keep iterating.  */"}, {"sha": "edd52229b3ce9e31b5d3bed99ed96c58d9411237", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6001735ea0da3d5d89a8f249a79fc8198ff28513/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6001735ea0da3d5d89a8f249a79fc8198ff28513/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=6001735ea0da3d5d89a8f249a79fc8198ff28513", "patch": "@@ -1,3 +1,7 @@\n+2001-01-28  Jakub Jelinek  <jakub@redhat.com>\n+\n+\t* g++.old-deja/g++.other/inline18.C: New test.\n+\n 2001-01-27  Kaveh R. Ghazi  <ghazi@caip.rutgers.edu>\n \n \t* gcc.c-torture/execute/stdio-opt-2.c: Also test __builtin_puts"}, {"sha": "263fd0eb11657a1b16ada003d6f91925b63b4fd3", "filename": "gcc/testsuite/g++.old-deja/g++.other/inline18.C", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6001735ea0da3d5d89a8f249a79fc8198ff28513/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.other%2Finline18.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6001735ea0da3d5d89a8f249a79fc8198ff28513/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.other%2Finline18.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.other%2Finline18.C?ref=6001735ea0da3d5d89a8f249a79fc8198ff28513", "patch": "@@ -0,0 +1,13 @@\n+// Build don't link:\n+// Origin: Jakub Jelinek <jakub@redhat.com>\n+// Special g++ Options: -O3\n+\n+static void foo (int a)\n+{\n+  a = a;\n+}\n+\n+static void bar (void)\n+{\n+  foo (-1);\n+}"}]}