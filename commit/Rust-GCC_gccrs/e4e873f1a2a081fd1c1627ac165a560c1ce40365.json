{"sha": "e4e873f1a2a081fd1c1627ac165a560c1ce40365", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTRlODczZjFhMmEwODFmZDFjMTYyN2FjMTY1YTU2MGMxY2U0MDM2NQ==", "commit": {"author": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1994-03-25T19:30:41Z"}, "committer": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1994-03-25T19:30:41Z"}, "message": "(output_function_prologue): Use link.w on 68040; emit pea fp + movl\nsp,fp instead of linkw 0 for 6804.0\n\nFrom-SVN: r6898", "tree": {"sha": "13f57781de296af823cad857b95876bee953012b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/13f57781de296af823cad857b95876bee953012b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e4e873f1a2a081fd1c1627ac165a560c1ce40365", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e4e873f1a2a081fd1c1627ac165a560c1ce40365", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e4e873f1a2a081fd1c1627ac165a560c1ce40365", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e4e873f1a2a081fd1c1627ac165a560c1ce40365/comments", "author": null, "committer": null, "parents": [{"sha": "629c5b50207ac024ac3faf27040042d28ed90fd0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/629c5b50207ac024ac3faf27040042d28ed90fd0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/629c5b50207ac024ac3faf27040042d28ed90fd0"}], "stats": {"total": 19, "additions": 16, "deletions": 3}, "files": [{"sha": "4cd6c912b1de455e4919eef0e8efe2d871a06b14", "filename": "gcc/config/m68k/m68k.c", "status": "modified", "additions": 16, "deletions": 3, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e4e873f1a2a081fd1c1627ac165a560c1ce40365/gcc%2Fconfig%2Fm68k%2Fm68k.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e4e873f1a2a081fd1c1627ac165a560c1ce40365/gcc%2Fconfig%2Fm68k%2Fm68k.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fm68k%2Fm68k.c?ref=e4e873f1a2a081fd1c1627ac165a560c1ce40365", "patch": "@@ -1,5 +1,5 @@\n /* Subroutines for insn-output.c for Motorola 68000 family.\n-   Copyright (C) 1987, 1993 Free Software Foundation, Inc.\n+   Copyright (C) 1987, 1993, 1994 Free Software Foundation, Inc.\n \n This file is part of GNU CC.\n \n@@ -93,8 +93,20 @@ output_function_prologue (stream, size)\n \n   if (frame_pointer_needed)\n     {\n-      /* Adding negative number is faster on the 68040.  */\n-      if (fsize < 0x8000 && !TARGET_68040)\n+      if (fsize == 0 && TARGET_68040_ONLY)\n+\t{\n+\t/* on the 68040, pea + move is faster than link.w 0 */\n+#ifdef MOTOROLA\n+\t  asm_fprintf (stream, \"\\tpea (%s)\\n\\tmove.l %s,%s\\n\",\n+\t       reg_names[FRAME_POINTER_REGNUM], reg_names[STACK_POINTER_REGNUM],\n+\t       reg_names[FRAME_POINTER_REGNUM]);\n+#else\n+\t  asm_fprintf (stream, \"\\tpea %s\\@\\n\\tmovel %s,%s\\n\",\n+\t       reg_names[FRAME_POINTER_REGNUM], reg_names[STACK_POINTER_REGNUM],\n+\t       reg_names[FRAME_POINTER_REGNUM]);\n+#endif\n+\t}\n+      else if (fsize < 0x8000)\n \t{\n #ifdef MOTOROLA\n \t  asm_fprintf (stream, \"\\tlink.w %s,%0I%d\\n\",\n@@ -116,6 +128,7 @@ output_function_prologue (stream, size)\n \t}\n       else\n \t{\n+      /* Adding negative number is faster on the 68040.  */\n #ifdef MOTOROLA\n \t  asm_fprintf (stream, \"\\tlink.w %s,%0I0\\n\\tadd.l %0I%d,%Rsp\\n\",\n \t\t       reg_names[FRAME_POINTER_REGNUM], -fsize);"}]}