{"sha": "d3e19c2c97facd63a5ae71a164b89a913beecf18", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDNlMTljMmM5N2ZhY2Q2M2E1YWU3MWExNjRiODlhOTEzYmVlY2YxOA==", "commit": {"author": {"name": "Paolo Carlini", "email": "paolo.carlini@oracle.com", "date": "2017-03-21T10:18:51Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2017-03-21T10:18:51Z"}, "message": "re PR c++/77752 (ICE on C++ code on x86_64-linux-gnu (internal compiler error: Segmentation fault, build_list_conv, implicit_conversion))\n\n/cp\n2017-03-21  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/77752\n\t* name-lookup.c (pushtag_1): Add check for bogus, non template,\n\tstd::initializer_list.\n\n/testsuite\n2017-03-21  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/77752\n\t* g++.dg/cpp0x/initlist97.C: New.\n\t* g++.dg/cpp0x/initlist85.C: Update.\n\nFrom-SVN: r246310", "tree": {"sha": "db3f380de30ffdfd1aa7daf16a7f82be7750a17a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/db3f380de30ffdfd1aa7daf16a7f82be7750a17a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d3e19c2c97facd63a5ae71a164b89a913beecf18", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d3e19c2c97facd63a5ae71a164b89a913beecf18", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d3e19c2c97facd63a5ae71a164b89a913beecf18", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d3e19c2c97facd63a5ae71a164b89a913beecf18/comments", "author": null, "committer": null, "parents": [{"sha": "3ed67fbf3d21c3d81f9d3107b1e07f970c9fac01", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3ed67fbf3d21c3d81f9d3107b1e07f970c9fac01", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3ed67fbf3d21c3d81f9d3107b1e07f970c9fac01"}], "stats": {"total": 34, "additions": 30, "deletions": 4}, "files": [{"sha": "3db9895d5a8cb14da8ac17eb8d37ace6d29c7b0c", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d3e19c2c97facd63a5ae71a164b89a913beecf18/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d3e19c2c97facd63a5ae71a164b89a913beecf18/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=d3e19c2c97facd63a5ae71a164b89a913beecf18", "patch": "@@ -1,3 +1,9 @@\n+2017-03-21  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/77752\n+\t* name-lookup.c (pushtag_1): Add check for bogus, non template,\n+\tstd::initializer_list.\n+\n 2017-03-21  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR c++/35878"}, {"sha": "4d7d3a1bad4c613ecd47862cb6801f17c6d6cebc", "filename": "gcc/cp/name-lookup.c", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d3e19c2c97facd63a5ae71a164b89a913beecf18/gcc%2Fcp%2Fname-lookup.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d3e19c2c97facd63a5ae71a164b89a913beecf18/gcc%2Fcp%2Fname-lookup.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fname-lookup.c?ref=d3e19c2c97facd63a5ae71a164b89a913beecf18", "patch": "@@ -6207,6 +6207,15 @@ pushtag_1 (tree name, tree type, tag_scope scope)\n \t  decl = pushdecl_with_scope_1 (decl, b, /*is_friend=*/false);\n \t  if (decl == error_mark_node)\n \t    return decl;\n+\n+\t  if (DECL_CONTEXT (decl) == std_node\n+\t      && strcmp (TYPE_NAME_STRING (type), \"initializer_list\") == 0\n+\t      && !CLASSTYPE_TEMPLATE_INFO (type))\n+\t    {\n+\t      error (\"declaration of std::initializer_list does not match \"\n+\t\t     \"#include <initializer_list>, isn't a template\");\n+\t      return error_mark_node;\n+\t    }\n \t}\n \n       if (! in_class)"}, {"sha": "a4d58737308acc3ee9529d764bd463be49971af0", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d3e19c2c97facd63a5ae71a164b89a913beecf18/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d3e19c2c97facd63a5ae71a164b89a913beecf18/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=d3e19c2c97facd63a5ae71a164b89a913beecf18", "patch": "@@ -1,3 +1,9 @@\n+2017-03-21  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/77752\n+\t* g++.dg/cpp0x/initlist97.C: New.\n+\t* g++.dg/cpp0x/initlist85.C: Update.\n+\n 2017-03-21  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR c/67338"}, {"sha": "0b5ce497e491c172bd202fd7a86e6f299bd93f20", "filename": "gcc/testsuite/g++.dg/cpp0x/initlist85.C", "status": "modified", "additions": 2, "deletions": 4, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d3e19c2c97facd63a5ae71a164b89a913beecf18/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Finitlist85.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d3e19c2c97facd63a5ae71a164b89a913beecf18/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Finitlist85.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Finitlist85.C?ref=d3e19c2c97facd63a5ae71a164b89a913beecf18", "patch": "@@ -3,14 +3,12 @@\n \n namespace std\n {\n-  struct initializer_list {};\t// { dg-message \"initializer_list\" }\n+  struct initializer_list {};  // { dg-error \"declaration\" }\n }\n \n void foo(std::initializer_list &);\n \n void f()\n {\n-  foo({1, 2});\n+  foo({1, 2});  // { dg-error \"invalid initialization\" }\n }\n-\n-// { dg-prune-output \"compilation terminated\" }"}, {"sha": "be474155a3a922de8630c9bb2d2bf38444ba8154", "filename": "gcc/testsuite/g++.dg/cpp0x/initlist97.C", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d3e19c2c97facd63a5ae71a164b89a913beecf18/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Finitlist97.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d3e19c2c97facd63a5ae71a164b89a913beecf18/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Finitlist97.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Finitlist97.C?ref=d3e19c2c97facd63a5ae71a164b89a913beecf18", "patch": "@@ -0,0 +1,7 @@\n+// PR c++/77752\n+// { dg-do compile { target c++11 } }\n+\n+namespace std {\n+  class initializer_list;  // { dg-error \"declaration\" }\n+}\n+void f(std::initializer_list l) { f({2}); }  // { dg-error \"incomplete type\" }"}]}