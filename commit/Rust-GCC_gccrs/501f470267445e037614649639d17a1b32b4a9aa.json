{"sha": "501f470267445e037614649639d17a1b32b4a9aa", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTAxZjQ3MDI2NzQ0NWUwMzc2MTQ2NDk2MzlkMTdhMWIzMmI0YTlhYQ==", "commit": {"author": {"name": "Thomas Koenig", "email": "tkoenig@gcc.gnu.org", "date": "2020-12-13T11:54:57Z"}, "committer": {"name": "Thomas Koenig", "email": "tkoenig@gcc.gnu.org", "date": "2020-12-13T11:55:56Z"}, "message": "Show coarrays on parse tree dump, implement debug for array references.\n\ngcc/fortran/ChangeLog:\n\n\t* dump-parse-tree.c (show_array_ref): Also show coarrays.\n\t(debug): Implement for array reference.", "tree": {"sha": "c11955781a5a0bef4535c1ec1a82b5bae6531bab", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c11955781a5a0bef4535c1ec1a82b5bae6531bab"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/501f470267445e037614649639d17a1b32b4a9aa", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/501f470267445e037614649639d17a1b32b4a9aa", "html_url": "https://github.com/Rust-GCC/gccrs/commit/501f470267445e037614649639d17a1b32b4a9aa", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/501f470267445e037614649639d17a1b32b4a9aa/comments", "author": null, "committer": null, "parents": [{"sha": "f1eeabc1fd0fff5b77db8672ff0c630bf891f40a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f1eeabc1fd0fff5b77db8672ff0c630bf891f40a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f1eeabc1fd0fff5b77db8672ff0c630bf891f40a"}], "stats": {"total": 36, "additions": 36, "deletions": 0}, "files": [{"sha": "440627a4075d1d81f446b8c8b1d2f8c9b180d5c5", "filename": "gcc/fortran/dump-parse-tree.c", "status": "modified", "additions": 36, "deletions": 0, "changes": 36, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/501f470267445e037614649639d17a1b32b4a9aa/gcc%2Ffortran%2Fdump-parse-tree.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/501f470267445e037614649639d17a1b32b4a9aa/gcc%2Ffortran%2Fdump-parse-tree.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fdump-parse-tree.c?ref=501f470267445e037614649639d17a1b32b4a9aa", "patch": "@@ -361,6 +361,31 @@ show_array_ref (gfc_array_ref * ar)\n     }\n \n   fputc (')', dumpfile);\n+  if (ar->codimen == 0)\n+    return;\n+\n+  /* Show coarray part of the reference, if any.  */\n+  fputc ('[',dumpfile);\n+  for (i = ar->dimen; i < ar->dimen + ar->codimen; i++)\n+    {\n+      if (ar->dimen_type[i] == DIMEN_STAR)\n+\tfputc('*',dumpfile);\n+      else if (ar->dimen_type[i] == DIMEN_THIS_IMAGE)\n+\tfputs(\"THIS_IMAGE\", dumpfile);\n+      else\n+\t{\n+\t  show_expr (ar->start[i]);\n+\t  if (ar->end[i])\n+\t    {\n+\t      fputc(':', dumpfile);\n+\t      show_expr (ar->end[i]);\n+\t    }\n+\t}\n+      if (i != ar->dimen + ar->codimen - 1)\n+\tfputs (\" , \", dumpfile);\n+\n+    }\n+  fputc (']',dumpfile);\n }\n \n \n@@ -3635,3 +3660,14 @@ gfc_dump_global_symbols (FILE *f)\n   else\n     gfc_traverse_gsymbol (gfc_gsym_root, show_global_symbol, (void *) f);\n }\n+\n+/* Show an array ref.  */\n+\n+void debug (gfc_array_ref *ar)\n+{\n+  FILE *tmp = dumpfile;\n+  dumpfile = stderr;\n+  show_array_ref (ar);\n+  fputc ('\\n', dumpfile);\n+  dumpfile = tmp;\n+}"}]}