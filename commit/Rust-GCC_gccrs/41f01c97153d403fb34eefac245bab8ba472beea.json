{"sha": "41f01c97153d403fb34eefac245bab8ba472beea", "node_id": "C_kwDOANBUbNoAKDQxZjAxYzk3MTUzZDQwM2ZiMzRlZWZhYzI0NWJhYjhiYTQ3MmJlZWE", "commit": {"author": {"name": "Iain Sandoe", "email": "iain@sandoe.co.uk", "date": "2022-03-13T16:34:54Z"}, "committer": {"name": "Iain Sandoe", "email": "iain@sandoe.co.uk", "date": "2022-03-18T15:23:49Z"}, "message": "c++tools: Work around a BSD bug in getaddrinfo().\n\nSome versions of the BSD getaddrinfo() call do not work with the specific\ninput of \"0\" for the servname entry (a segv results).  Since we are making\nthe call with a dummy port number, the value is actually no important, other\nthan it should be in range.  Work around the BSD bug by using \"1\" instead.\n\nSigned-off-by: Iain Sandoe <iain@sandoe.co.uk>\n\nc++tools/ChangeLog:\n\n\t* server.cc (accept_from): Use \"1\" as the dummy port number.", "tree": {"sha": "93602c1477fc8714346156be5a04ebc74496d78a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/93602c1477fc8714346156be5a04ebc74496d78a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/41f01c97153d403fb34eefac245bab8ba472beea", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/41f01c97153d403fb34eefac245bab8ba472beea", "html_url": "https://github.com/Rust-GCC/gccrs/commit/41f01c97153d403fb34eefac245bab8ba472beea", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/41f01c97153d403fb34eefac245bab8ba472beea/comments", "author": {"login": "iains", "id": 4039407, "node_id": "MDQ6VXNlcjQwMzk0MDc=", "avatar_url": "https://avatars.githubusercontent.com/u/4039407?v=4", "gravatar_id": "", "url": "https://api.github.com/users/iains", "html_url": "https://github.com/iains", "followers_url": "https://api.github.com/users/iains/followers", "following_url": "https://api.github.com/users/iains/following{/other_user}", "gists_url": "https://api.github.com/users/iains/gists{/gist_id}", "starred_url": "https://api.github.com/users/iains/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/iains/subscriptions", "organizations_url": "https://api.github.com/users/iains/orgs", "repos_url": "https://api.github.com/users/iains/repos", "events_url": "https://api.github.com/users/iains/events{/privacy}", "received_events_url": "https://api.github.com/users/iains/received_events", "type": "User", "site_admin": false}, "committer": {"login": "iains", "id": 4039407, "node_id": "MDQ6VXNlcjQwMzk0MDc=", "avatar_url": "https://avatars.githubusercontent.com/u/4039407?v=4", "gravatar_id": "", "url": "https://api.github.com/users/iains", "html_url": "https://github.com/iains", "followers_url": "https://api.github.com/users/iains/followers", "following_url": "https://api.github.com/users/iains/following{/other_user}", "gists_url": "https://api.github.com/users/iains/gists{/gist_id}", "starred_url": "https://api.github.com/users/iains/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/iains/subscriptions", "organizations_url": "https://api.github.com/users/iains/orgs", "repos_url": "https://api.github.com/users/iains/repos", "events_url": "https://api.github.com/users/iains/events{/privacy}", "received_events_url": "https://api.github.com/users/iains/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "99fcd602a82e28e1d6a843e5cbe011b570dc81fa", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/99fcd602a82e28e1d6a843e5cbe011b570dc81fa", "html_url": "https://github.com/Rust-GCC/gccrs/commit/99fcd602a82e28e1d6a843e5cbe011b570dc81fa"}], "stats": {"total": 6, "additions": 5, "deletions": 1}, "files": [{"sha": "00154a05925d8848a07923b8ce42432ea2be8afe", "filename": "c++tools/server.cc", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/41f01c97153d403fb34eefac245bab8ba472beea/c%2B%2Btools%2Fserver.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/41f01c97153d403fb34eefac245bab8ba472beea/c%2B%2Btools%2Fserver.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/c%2B%2Btools%2Fserver.cc?ref=41f01c97153d403fb34eefac245bab8ba472beea", "patch": "@@ -360,7 +360,11 @@ accept_from (char *arg ATTRIBUTE_UNUSED)\n   hints.ai_next = NULL;\n \n   struct addrinfo *addrs = NULL;\n-  if (int e = getaddrinfo (slash == arg ? NULL : arg, \"0\", &hints, &addrs))\n+  /* getaddrinfo requires either hostname or servname to be non-null, so that we must\n+     set a port number (to cover the case that the string passed contains just /NN).\n+     Use an arbitrary in-range port number, but avoiding \"0\" which triggers a bug on\n+     some BSD variants.  */\n+  if (int e = getaddrinfo (slash == arg ? NULL : arg, \"1\", &hints, &addrs))\n     {\n       noisy (\"cannot resolve '%s': %s\", arg, gai_strerror (e));\n       ok = false;"}]}