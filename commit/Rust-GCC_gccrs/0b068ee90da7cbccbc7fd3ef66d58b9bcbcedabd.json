{"sha": "0b068ee90da7cbccbc7fd3ef66d58b9bcbcedabd", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MGIwNjhlZTkwZGE3Y2JjY2JjN2ZkM2VmNjZkNThiOWJjYmNlZGFiZA==", "commit": {"author": {"name": "Jeff Law", "email": "law@redhat.com", "date": "2004-06-01T07:42:35Z"}, "committer": {"name": "Jeff Law", "email": "law@gcc.gnu.org", "date": "2004-06-01T07:42:35Z"}, "message": "stmt.c (expand_decl): Be more selective about calling mark_reg_pointer.\n\n        * stmt.c (expand_decl): Be more selective about calling\n        mark_reg_pointer.\n\nFrom-SVN: r82533", "tree": {"sha": "2b16ad65ff14e5d87159e2e3e1d8d3ebbecfa368", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2b16ad65ff14e5d87159e2e3e1d8d3ebbecfa368"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0b068ee90da7cbccbc7fd3ef66d58b9bcbcedabd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0b068ee90da7cbccbc7fd3ef66d58b9bcbcedabd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0b068ee90da7cbccbc7fd3ef66d58b9bcbcedabd", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0b068ee90da7cbccbc7fd3ef66d58b9bcbcedabd/comments", "author": null, "committer": null, "parents": [{"sha": "61c627ed2c1b7184807d2101ab2d288e9ca4f39b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/61c627ed2c1b7184807d2101ab2d288e9ca4f39b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/61c627ed2c1b7184807d2101ab2d288e9ca4f39b"}], "stats": {"total": 24, "additions": 19, "deletions": 5}, "files": [{"sha": "8656d299987128b18809cf23bc2f72dd5e04363c", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0b068ee90da7cbccbc7fd3ef66d58b9bcbcedabd/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0b068ee90da7cbccbc7fd3ef66d58b9bcbcedabd/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=0b068ee90da7cbccbc7fd3ef66d58b9bcbcedabd", "patch": "@@ -1,3 +1,8 @@\n+2004-05-19  Jeff Law <law@redhat.com>\n+\n+        * stmt.c (expand_decl): Be more selective about calling\n+        mark_reg_pointer.\n+\n 2004-06-01  Nicola Pero  <nicola@brainstorm.co.uk>\n \n  \tPR objc/7993"}, {"sha": "4df59f8eb452c621f92d038abeef968c063deb00", "filename": "gcc/stmt.c", "status": "modified", "additions": 14, "deletions": 5, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0b068ee90da7cbccbc7fd3ef66d58b9bcbcedabd/gcc%2Fstmt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0b068ee90da7cbccbc7fd3ef66d58b9bcbcedabd/gcc%2Fstmt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fstmt.c?ref=0b068ee90da7cbccbc7fd3ef66d58b9bcbcedabd", "patch": "@@ -3422,12 +3422,21 @@ expand_decl (tree decl)\n \n       SET_DECL_RTL (decl, gen_reg_rtx (reg_mode));\n \n+      /* Note if the object is a user variable.  */\n       if (!DECL_ARTIFICIAL (decl))\n-\tmark_user_reg (DECL_RTL (decl));\n-\n-      if (POINTER_TYPE_P (type))\n-\tmark_reg_pointer (DECL_RTL (decl),\n-\t\t\t  TYPE_ALIGN (TREE_TYPE (TREE_TYPE (decl))));\n+\t{\n+\t  mark_user_reg (DECL_RTL (decl));\n+\n+\t  /* Trust user variables which have a pointer type to really\n+\t     be pointers.  Do not trust compiler generated temporaries\n+\t     as our type system is totally busted as it relates to\n+\t     pointer arithmetic which translates into lots of compiler\n+\t     generated objects with pointer types, but which are not really\n+\t     pointers.  */\n+\t  if (POINTER_TYPE_P (type))\n+\t    mark_reg_pointer (DECL_RTL (decl),\n+\t\t\t      TYPE_ALIGN (TREE_TYPE (TREE_TYPE (decl))));\n+\t}\n \n       maybe_set_unchanging (DECL_RTL (decl), decl);\n "}]}