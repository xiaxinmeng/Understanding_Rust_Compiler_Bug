{"sha": "84b9b8722013c8ce15572c5350ca4aa4ca0f279d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODRiOWI4NzIyMDEzYzhjZTE1NTcyYzUzNTBjYTRhYTRjYTBmMjc5ZA==", "commit": {"author": {"name": "Richard Sandiford", "email": "rdsandiford@googlemail.com", "date": "2009-01-06T22:00:18Z"}, "committer": {"name": "Richard Sandiford", "email": "rsandifo@gcc.gnu.org", "date": "2009-01-06T22:00:18Z"}, "message": "function.h (rtl_data): Add a dbr_scheduled_p field.\n\ngcc/\n\t* function.h (rtl_data): Add a dbr_scheduled_p field.\n\t* reorg.c (dbr_schedule): Set it.\n\t(gate_handle_delay_slots): Check it.\n\t* config/mips/mips.c (mips_base_delayed_branch): Delete.\n\t(mips_reorg): Check flag_delayed_branch instead of\n\tmips_base_delayed_branch.\n\t(mips_override_options): Don't set mips_base_delayed_branch\n\tor flag_delayed_branch.\n\nFrom-SVN: r143136", "tree": {"sha": "de3a6bbab91f28cd79f61ff34a9520334026fd03", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/de3a6bbab91f28cd79f61ff34a9520334026fd03"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/84b9b8722013c8ce15572c5350ca4aa4ca0f279d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/84b9b8722013c8ce15572c5350ca4aa4ca0f279d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/84b9b8722013c8ce15572c5350ca4aa4ca0f279d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/84b9b8722013c8ce15572c5350ca4aa4ca0f279d/comments", "author": {"login": "rsandifo", "id": 4235983, "node_id": "MDQ6VXNlcjQyMzU5ODM=", "avatar_url": "https://avatars.githubusercontent.com/u/4235983?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rsandifo", "html_url": "https://github.com/rsandifo", "followers_url": "https://api.github.com/users/rsandifo/followers", "following_url": "https://api.github.com/users/rsandifo/following{/other_user}", "gists_url": "https://api.github.com/users/rsandifo/gists{/gist_id}", "starred_url": "https://api.github.com/users/rsandifo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rsandifo/subscriptions", "organizations_url": "https://api.github.com/users/rsandifo/orgs", "repos_url": "https://api.github.com/users/rsandifo/repos", "events_url": "https://api.github.com/users/rsandifo/events{/privacy}", "received_events_url": "https://api.github.com/users/rsandifo/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "ace984c85138fbc4aa823a3aae0d0eba2d117437", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ace984c85138fbc4aa823a3aae0d0eba2d117437", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ace984c85138fbc4aa823a3aae0d0eba2d117437"}], "stats": {"total": 24, "additions": 17, "deletions": 7}, "files": [{"sha": "ff5d6f53a93e45c497effac1aceb13e553ae2dad", "filename": "gcc/ChangeLog", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/84b9b8722013c8ce15572c5350ca4aa4ca0f279d/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/84b9b8722013c8ce15572c5350ca4aa4ca0f279d/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=84b9b8722013c8ce15572c5350ca4aa4ca0f279d", "patch": "@@ -1,3 +1,14 @@\n+2009-01-06  Richard Sandiford  <rdsandiford@googlemail.com>\n+\n+\t* function.h (rtl_data): Add a dbr_scheduled_p field.\n+\t* reorg.c (dbr_schedule): Set it.\n+\t(gate_handle_delay_slots): Check it.\n+\t* config/mips/mips.c (mips_base_delayed_branch): Delete.\n+\t(mips_reorg): Check flag_delayed_branch instead of\n+\tmips_base_delayed_branch.\n+\t(mips_override_options): Don't set mips_base_delayed_branch\n+\tor flag_delayed_branch.\n+\n 2009-01-06  Richard Sandiford  <rdsandiford@googlemail.com>\n \n \tPR rtl-optimization/38426."}, {"sha": "55b1c22be66c3e5d7f2ec4ba1d0f610ca16dff8f", "filename": "gcc/config/mips/mips.c", "status": "modified", "additions": 1, "deletions": 6, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/84b9b8722013c8ce15572c5350ca4aa4ca0f279d/gcc%2Fconfig%2Fmips%2Fmips.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/84b9b8722013c8ce15572c5350ca4aa4ca0f279d/gcc%2Fconfig%2Fmips%2Fmips.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.c?ref=84b9b8722013c8ce15572c5350ca4aa4ca0f279d", "patch": "@@ -453,7 +453,6 @@ static int mips_base_target_flags;\n bool mips_base_mips16;\n \n /* The ambient values of other global variables.  */\n-static int mips_base_delayed_branch; /* flag_delayed_branch */\n static int mips_base_schedule_insns; /* flag_schedule_insns */\n static int mips_base_reorder_blocks_and_partition; /* flag_reorder... */\n static int mips_base_move_loop_invariants; /* flag_move_loop_invariants */\n@@ -13297,7 +13296,7 @@ mips_reorg (void)\n   mips16_lay_out_constants ();\n   if (mips_r10k_cache_barrier != R10K_CACHE_BARRIER_NONE)\n     r10k_insert_cache_barriers ();\n-  if (mips_base_delayed_branch)\n+  if (flag_delayed_branch)\n     dbr_schedule (get_insns ());\n   mips_reorg_process_insns ();\n   if (!TARGET_MIPS16\n@@ -14058,7 +14057,6 @@ mips_override_options (void)\n \n   /* Save base state of options.  */\n   mips_base_target_flags = target_flags;\n-  mips_base_delayed_branch = flag_delayed_branch;\n   mips_base_schedule_insns = flag_schedule_insns;\n   mips_base_reorder_blocks_and_partition = flag_reorder_blocks_and_partition;\n   mips_base_move_loop_invariants = flag_move_loop_invariants;\n@@ -14071,9 +14069,6 @@ mips_override_options (void)\n      Do all CPP-sensitive stuff in non-MIPS16 mode; we'll switch to\n      MIPS16 mode afterwards if need be.  */\n   mips_set_mips16_mode (false);\n-\n-  /* We call dbr_schedule from within mips_reorg.  */\n-  flag_delayed_branch = 0;\n }\n \n /* Swap the register information for registers I and I + 1, which"}, {"sha": "f78d737b05f2a1574502db1eec2defe1dbbc2962", "filename": "gcc/function.h", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/84b9b8722013c8ce15572c5350ca4aa4ca0f279d/gcc%2Ffunction.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/84b9b8722013c8ce15572c5350ca4aa4ca0f279d/gcc%2Ffunction.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffunction.h?ref=84b9b8722013c8ce15572c5350ca4aa4ca0f279d", "patch": "@@ -444,6 +444,9 @@ struct rtl_data GTY(())\n   /* Nonzero if function stack realignment has been finalized, namely\n      stack_realign_needed flag has been set and finalized after reload.  */\n   bool stack_realign_finalized;\n+\n+  /* True if dbr_schedule has already been called for this function.  */\n+  bool dbr_scheduled_p;\n };\n \n #define return_label (crtl->x_return_label)"}, {"sha": "fd6a58e02eb94f87872fa1c5f399a16ac6f3d56a", "filename": "gcc/reorg.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/84b9b8722013c8ce15572c5350ca4aa4ca0f279d/gcc%2Freorg.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/84b9b8722013c8ce15572c5350ca4aa4ca0f279d/gcc%2Freorg.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Freorg.c?ref=84b9b8722013c8ce15572c5350ca4aa4ca0f279d", "patch": "@@ -4038,14 +4038,15 @@ dbr_schedule (rtx first)\n   }\n \n #endif\n+  crtl->dbr_scheduled_p = true;\n }\n #endif /* DELAY_SLOTS */\n \f\n static bool\n gate_handle_delay_slots (void)\n {\n #ifdef DELAY_SLOTS\n-  return flag_delayed_branch;\n+  return flag_delayed_branch && !crtl->dbr_scheduled_p;\n #else\n   return 0;\n #endif"}]}