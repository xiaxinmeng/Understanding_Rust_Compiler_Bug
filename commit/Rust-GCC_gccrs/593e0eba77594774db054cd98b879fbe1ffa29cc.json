{"sha": "593e0eba77594774db054cd98b879fbe1ffa29cc", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTkzZTBlYmE3NzU5NDc3NGRiMDU0Y2Q5OGI4NzlmYmUxZmZhMjljYw==", "commit": {"author": {"name": "Patrick Bernardi", "email": "bernardi@adacore.com", "date": "2019-08-19T08:36:26Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "pmderodat@gcc.gnu.org", "date": "2019-08-19T08:36:26Z"}, "message": "[Ada] Enable use of GNAT.Sockets for VxWorks RTP\n\nThe recent introduction of GNAT.Sockets IPv6 support broke support for\nVxWorks RTPs due to the use of internal VxWorks kernel calls. This patch\nrectifies this by using the VxWorks public API for these routines.\n\nThe following RTP should compile successfully on a Development profile\nVxWorks kernel that includes the INCLUDE_GETNAMEINFO component:\n\nwith GNAT.Sockets;      use GNAT.Sockets;\n\nprocedure IPvX is\n   procedure Print_Address_Info\n     (Host, Serv   : String;\n      Family       : Family_Type := Family_Unspec)\n   is\n      Addresses : Address_Info_Array :=\n        Get_Address_Info\n          (Host, Serv, Family,\n           Passive      => False,\n           Numeric_Host => False);\n   begin\n      Sort (Addresses, IPv6_TCP_Preferred'Access);\n   end Print_Address_Info;\n\nbegin\n   Print_Address_Info (\"localhost\", \"ssh\");\nend IPvX;\n\n2019-08-19  Patrick Bernardi  <bernardi@adacore.com>\n\ngcc/ada/\n\n\t* socket.c: Removed the redefinition of getaddrinfo, getnameinfo\n\tand freeaddrinfo to internal VxWorks kernel calls because they\n\tare, well, internal kernel calls and cannot be called from RTPs.\n\tVxWorks provides the necessary components to call these routines\n\tdirectly.\n\nFrom-SVN: r274651", "tree": {"sha": "5b6ddcb1819d8535ade0d13ffef13d671e7f195d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5b6ddcb1819d8535ade0d13ffef13d671e7f195d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/593e0eba77594774db054cd98b879fbe1ffa29cc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/593e0eba77594774db054cd98b879fbe1ffa29cc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/593e0eba77594774db054cd98b879fbe1ffa29cc", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/593e0eba77594774db054cd98b879fbe1ffa29cc/comments", "author": {"login": "burratoo", "id": 23646118, "node_id": "MDQ6VXNlcjIzNjQ2MTE4", "avatar_url": "https://avatars.githubusercontent.com/u/23646118?v=4", "gravatar_id": "", "url": "https://api.github.com/users/burratoo", "html_url": "https://github.com/burratoo", "followers_url": "https://api.github.com/users/burratoo/followers", "following_url": "https://api.github.com/users/burratoo/following{/other_user}", "gists_url": "https://api.github.com/users/burratoo/gists{/gist_id}", "starred_url": "https://api.github.com/users/burratoo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/burratoo/subscriptions", "organizations_url": "https://api.github.com/users/burratoo/orgs", "repos_url": "https://api.github.com/users/burratoo/repos", "events_url": "https://api.github.com/users/burratoo/events{/privacy}", "received_events_url": "https://api.github.com/users/burratoo/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "1f5c7ba85856618c1f14d4f581966baadbe02ddd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1f5c7ba85856618c1f14d4f581966baadbe02ddd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1f5c7ba85856618c1f14d4f581966baadbe02ddd"}], "stats": {"total": 14, "additions": 8, "deletions": 6}, "files": [{"sha": "f89468e1d90613101061da4e5c52f0dd970a2245", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/593e0eba77594774db054cd98b879fbe1ffa29cc/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/593e0eba77594774db054cd98b879fbe1ffa29cc/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=593e0eba77594774db054cd98b879fbe1ffa29cc", "patch": "@@ -1,3 +1,11 @@\n+2019-08-19  Patrick Bernardi  <bernardi@adacore.com>\n+\n+\t* socket.c: Removed the redefinition of getaddrinfo, getnameinfo\n+\tand freeaddrinfo to internal VxWorks kernel calls because they\n+\tare, well, internal kernel calls and cannot be called from RTPs.\n+\tVxWorks provides the necessary components to call these routines\n+\tdirectly.\n+\n 2019-08-19  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* exp_dist.adb (Is_Generic_Actual_Subtype): New predicate."}, {"sha": "94538d4308266bda12d0bf29fc34df40df4ae419", "filename": "gcc/ada/socket.c", "status": "modified", "additions": 0, "deletions": 6, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/593e0eba77594774db054cd98b879fbe1ffa29cc/gcc%2Fada%2Fsocket.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/593e0eba77594774db054cd98b879fbe1ffa29cc/gcc%2Fada%2Fsocket.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsocket.c?ref=593e0eba77594774db054cd98b879fbe1ffa29cc", "patch": "@@ -704,12 +704,6 @@ __gnat_servent_s_proto (struct servent * s)\n \n #if defined(AF_INET6) && !defined(__rtems__)\n \n-#if defined (__vxworks)\n-#define getaddrinfo ipcom_getaddrinfo\n-#define getnameinfo ipcom_getnameinfo\n-#define freeaddrinfo ipcom_freeaddrinfo\n-#endif\n-\n int __gnat_getaddrinfo(\n   const char *node,\n   const char *service,"}]}