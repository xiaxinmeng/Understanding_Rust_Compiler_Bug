{"sha": "71f0026ffaec1d5e06e6359bad838ab3086cee8a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzFmMDAyNmZmYWVjMWQ1ZTA2ZTYzNTliYWQ4MzhhYjMwODZjZWU4YQ==", "commit": {"author": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1995-05-19T10:59:16Z"}, "committer": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1995-05-19T10:59:16Z"}, "message": "Handle revised filenames from vmsconfig.com;\n\n(DO_OBJCLIB): New variable, plus code to compile objc/*.{c,m}.\n\nFrom-SVN: r9743", "tree": {"sha": "cb6f4b4ceb0e0f5ebb94a68d53299f8e209200c1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/cb6f4b4ceb0e0f5ebb94a68d53299f8e209200c1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/71f0026ffaec1d5e06e6359bad838ab3086cee8a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/71f0026ffaec1d5e06e6359bad838ab3086cee8a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/71f0026ffaec1d5e06e6359bad838ab3086cee8a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/71f0026ffaec1d5e06e6359bad838ab3086cee8a/comments", "author": null, "committer": null, "parents": [{"sha": "14aca63216fd725e37987ca89d9c485a507d4cd8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/14aca63216fd725e37987ca89d9c485a507d4cd8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/14aca63216fd725e37987ca89d9c485a507d4cd8"}], "stats": {"total": 47, "additions": 43, "deletions": 4}, "files": [{"sha": "98ad2c96c2a9467f0ddee5e96426391413c52532", "filename": "gcc/make-cc1.com", "status": "modified", "additions": 43, "deletions": 4, "changes": 47, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71f0026ffaec1d5e06e6359bad838ab3086cee8a/gcc%2Fmake-cc1.com", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71f0026ffaec1d5e06e6359bad838ab3086cee8a/gcc%2Fmake-cc1.com", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fmake-cc1.com?ref=71f0026ffaec1d5e06e6359bad838ab3086cee8a", "patch": "@@ -85,12 +85,14 @@ $! you want to build GNU-C (\"CC1\").\n $!\n $! Now figure out what we have been requested to do.\n $p1 = p1+\" \"+p2+\" \"+p3+\" \"+p4+\" \"+p5+\" \"+p6+\" \"+p7 \n-$p1 = f$edit(p1,\"COMPRESS\")\n+$p1 = f$edit(p1,\"COMPRESS,TRIM\")\n $i=0\n $DO_ALL = 0\n $DO_LINK = 0\n $DO_DEBUG = 0\n $DO_CC1PLUS = 0\n+$DO_CC1OBJ = 0\n+$DO_OBJCLIB = 0\n $if f$trnlnm(\"cfile$\").nes.\"\" then  close/noLog cfile$\n $open cfile$ compilers.list\n $cinit:read cfile$ compilername/end=cinit_done\n@@ -106,6 +108,11 @@ $if string.eqs.\" \" then goto done\n $flag = 1\n $if string.eqs.\"CC1PLUS\" then DO_DEFAULT = 0\n $if string.eqs.\"CC1OBJ\" then DO_DEFAULT = 0\n+$if string.eqs.\"OBJCLIB\"\n+$then\tDO_DEFAULT = 0\n+$\tDO_INDEPENDENT = DO_CC1OBJ\n+$\tDO_BC = DO_CC1OBJ\n+$endif\n $if f$extract(0,2,string).nes.\"NO\" then goto parse_option\n $  string=f$extract(2,f$length(string)-2,string)\n $  flag = 0\n@@ -124,6 +131,7 @@ $if DO_CC1PLUS.eq.1 then echo \"   Compile C++ specific object modules.\"\n $if DO_CC1OBJ.eq.1 then echo \"   Compile obj-C specific object modules.\"\n $if DO_INDEPENDENT.eq.1 then echo \"   Compile language independent object modules.\"\n $if DO_BC.eq.1 then echo \"   Compile byte compiler object modules.\"\n+$if DO_OBJCLIB.eq.1 then echo \"   Create Objective-C run-time library.\"\n $link_only:\n $if DO_CC1.eq.1 then\techo \"   Link C compiler (gcc-cc1.exe).\"\n $if DO_CC1PLUS.eq.1 then echo \"   Link C++ compiler (gcc-cc1plus.exe).\"\n@@ -188,14 +196,14 @@ $!\n $if DO_BC.eq.1 \n $\tTHEN \n $\tcall compile bi_all.opt \"\"\n-$\topen ifile$ bc_all.opt\n+$\tif f$trnlnm(\"ifile$\").nes.\"\" then  close/noLog ifile$\n+$\topen ifile$ bc_all.list\n $\tread ifile$ bc_line\n $\tclose ifile$\n $\tbc_index = 0\n $bc_loop:\n $\ttfile = f$element(bc_index, \",\", bc_line)\n $\tif tfile.eqs.\",\" then goto bc_done\n-$\tif f$locate(\".\",tfile).eq.f$length(tfile) then tfile = tfile + \".h\"\n $\tcall bc_generate 'tfile' \"bi_all.opt/opt,\"\n $\tbc_index = bc_index + 1\n $\tgoto bc_loop\n@@ -311,6 +319,37 @@ $!\n $!\n $cdone: close cfile$\n $!\n+$ if DO_OBJCLIB\n+$ then\tset default [.objc]\t!push\n+$\tsave_cflags = CFLAGS\n+$\tCFLAGS = CFLAGS - CINCL1 - CINCL2 + CINCL_SUB\n+$\tMFLAGS = \"/Lang=ObjC\" + CFLAGS\n+$\tlibrary/Obj [-]objclib.olb/Create\n+$\tif f$trnlnm(\"IFILE$\").nes.\"\" then  close/noLog ifile$\n+$\topen/Read ifile$ [-]objc-objs.opt\n+$ocl1:\tread/End=ocl3 ifile$ line\n+$\ti = 0\n+$ocl2:\to = f$element(i,\",\",line)\n+$\tif o.eqs.\",\" then goto ocl1\n+$\tn = o - \".o\"\n+$\tif f$search(n + \".m\").nes.\"\"\n+$\tthen\tf = n + \".m\"\n+$\t\tflags = MFLAGS\n+$\telse\tf = n + \".c\"\n+$\t\tflags = CFLAGS\n+$\tendif\n+$\tset verify\n+$ 'CC' 'flags' 'f'\n+$!'f$verify(0)'\n+$\tlibrary/Obj [-]objclib.olb 'n'.obj/Insert\n+$\tdelete/noConfirm/noLog 'n'.obj;*\n+$\ti = i + 1\n+$\tgoto ocl2\n+$ocl3:\tclose ifile$\n+$\tCFLAGS = save_cflags\n+$\tset default [-]\t!pop\n+$ endif !DO_OBJCLIB\n+$!\n $!\tDone\n $!\n $! 'f$verify(v)\n@@ -424,7 +463,7 @@ $!\t'f$verify(0)\n $!\n $set verify\n $\tassign/user 'p1' sys$output:\n-$\tmcr sys$disk:[]GEN'root1' md\n+$\tmcr sys$disk:[]GEN'root1' vax.md\n $!'f$verify(0)\n $endsubroutine\n $!"}]}