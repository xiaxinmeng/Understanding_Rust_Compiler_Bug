{"sha": "510e072da902bb3651dcfcdcee48d75e12ace6d6", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTEwZTA3MmRhOTAyYmIzNjUxZGNmY2RjZWU0OGQ3NWUxMmFjZTZkNg==", "commit": {"author": {"name": "Paul Koning", "email": "ni1d@arrl.net", "date": "2018-11-05T19:36:16Z"}, "committer": {"name": "Paul Koning", "email": "pkoning@gcc.gnu.org", "date": "2018-11-05T19:36:16Z"}, "message": "target-supports.exp: Add check for \"inf\" effective target keyword.\n\n\t* lib/target-supports.exp: Add check for \"inf\" effective target\n\tkeyword.\n\t* gcc.dg/builtins-44.c: Skip if no infinite support.\n\t* gcc.dg/builtins-45.c: Ditto.\n\t* gcc.dg/torture/builtin-complex-1.c: Ditto.\n\t* gcc.dg/torture/builtin-cproj-1.c: Ditto.\n\t* gcc.dg/torture/builtin-frexp-1.c: Ditto.\n\t* gcc.dg/torture/builtin-ldexp-1.c: Ditto.\n\t* gcc.dg/torture/builtin-logb-1.c: Ditto.\n\t* gcc.dg/torture/builtin-math-2.c: Ditto.\n\t* gcc.dg/torture/builtin-math-5.c: Ditto.\n\t* gcc.dg/torture/builtin-math-7.c: Ditto.\n\t* gcc.dg/torture/builtin-modf-1.c: Ditto.\n\t* gcc.dg/torture/type-generic-1.c: Ditto.\n\nFrom-SVN: r265816", "tree": {"sha": "60419340b2359c2e54c57882e0d343d53c92cf3b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/60419340b2359c2e54c57882e0d343d53c92cf3b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/510e072da902bb3651dcfcdcee48d75e12ace6d6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/510e072da902bb3651dcfcdcee48d75e12ace6d6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/510e072da902bb3651dcfcdcee48d75e12ace6d6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/510e072da902bb3651dcfcdcee48d75e12ace6d6/comments", "author": null, "committer": null, "parents": [{"sha": "08500461fc9e31bfcaae8b3490072614c3e9ea63", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/08500461fc9e31bfcaae8b3490072614c3e9ea63", "html_url": "https://github.com/Rust-GCC/gccrs/commit/08500461fc9e31bfcaae8b3490072614c3e9ea63"}], "stats": {"total": 36, "additions": 36, "deletions": 0}, "files": [{"sha": "78a1b05fcfeff282d70b609e50f34d3c2ce60f6a", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/510e072da902bb3651dcfcdcee48d75e12ace6d6/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/510e072da902bb3651dcfcdcee48d75e12ace6d6/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=510e072da902bb3651dcfcdcee48d75e12ace6d6", "patch": "@@ -1,3 +1,20 @@\n+2018-11-05  Paul Koning  <ni1d@arrl.net>\n+\n+\t* lib/target-supports.exp: Add check for \"inf\" effective target\n+\tkeyword.\n+\t* gcc.dg/builtins-44.c: Skip if no infinite support.\n+\t* gcc.dg/builtins-45.c: Ditto.\n+\t* gcc.dg/torture/builtin-complex-1.c: Ditto.\n+\t* gcc.dg/torture/builtin-cproj-1.c: Ditto.\n+\t* gcc.dg/torture/builtin-frexp-1.c: Ditto.\n+\t* gcc.dg/torture/builtin-ldexp-1.c: Ditto.\n+\t* gcc.dg/torture/builtin-logb-1.c: Ditto.\n+\t* gcc.dg/torture/builtin-math-2.c: Ditto.\n+\t* gcc.dg/torture/builtin-math-5.c: Ditto.\n+\t* gcc.dg/torture/builtin-math-7.c: Ditto.\n+\t* gcc.dg/torture/builtin-modf-1.c: Ditto.\n+\t* gcc.dg/torture/type-generic-1.c: Ditto.\n+\n 2018-11-05  Ilya Leoshkevich  <iii@linux.ibm.com>\n \n \t* gcc.target/s390/md/andc-splitter-1.c: Add colon to"}, {"sha": "8a06b5969957ee7937fbf2e0c9466fe1c01fe732", "filename": "gcc/testsuite/gcc.dg/builtins-44.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/510e072da902bb3651dcfcdcee48d75e12ace6d6/gcc%2Ftestsuite%2Fgcc.dg%2Fbuiltins-44.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/510e072da902bb3651dcfcdcee48d75e12ace6d6/gcc%2Ftestsuite%2Fgcc.dg%2Fbuiltins-44.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fbuiltins-44.c?ref=510e072da902bb3651dcfcdcee48d75e12ace6d6", "patch": "@@ -1,4 +1,5 @@\n /* { dg-do compile } */\n+/* { dg-require-effective-target inf } */\n /* { dg-options \"-O1 -fno-trapping-math -fno-finite-math-only -fdump-tree-optimized\" } */\n   \n extern void f(int);"}, {"sha": "0fa801b330798371101f35d69d4c714df3a98012", "filename": "gcc/testsuite/gcc.dg/builtins-45.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/510e072da902bb3651dcfcdcee48d75e12ace6d6/gcc%2Ftestsuite%2Fgcc.dg%2Fbuiltins-45.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/510e072da902bb3651dcfcdcee48d75e12ace6d6/gcc%2Ftestsuite%2Fgcc.dg%2Fbuiltins-45.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fbuiltins-45.c?ref=510e072da902bb3651dcfcdcee48d75e12ace6d6", "patch": "@@ -1,4 +1,5 @@\n /* { dg-do compile } */\n+/* { dg-require-effective-target inf } */\n /* { dg-options \"-O1 -fno-trapping-math -fno-finite-math-only -fdump-tree-optimized\" } */\n   \n extern void f(int);"}, {"sha": "5a4ed3cce4f4176f610cb4af591278b98e1543fe", "filename": "gcc/testsuite/gcc.dg/torture/builtin-complex-1.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/510e072da902bb3651dcfcdcee48d75e12ace6d6/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fbuiltin-complex-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/510e072da902bb3651dcfcdcee48d75e12ace6d6/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fbuiltin-complex-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fbuiltin-complex-1.c?ref=510e072da902bb3651dcfcdcee48d75e12ace6d6", "patch": "@@ -1,6 +1,7 @@\n /* Test __builtin_complex semantics.  */\n /* { dg-do run } */\n /* { dg-options \"-std=c11 -pedantic-errors\" } */\n+/* { dg-require-effective-target inf } */\n /* { dg-add-options ieee } */\n \n extern void exit (int);"}, {"sha": "d79f34acba6b96ae4f232e397ac1f3d9e0970dad", "filename": "gcc/testsuite/gcc.dg/torture/builtin-cproj-1.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/510e072da902bb3651dcfcdcee48d75e12ace6d6/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fbuiltin-cproj-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/510e072da902bb3651dcfcdcee48d75e12ace6d6/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fbuiltin-cproj-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fbuiltin-cproj-1.c?ref=510e072da902bb3651dcfcdcee48d75e12ace6d6", "patch": "@@ -7,6 +7,7 @@\n \n /* { dg-do link } */\n /* { dg-skip-if \"\" { *-*-* } { \"-O0\" } { \"\" } } */\n+/* { dg-require-effective-target inf } */\n /* { dg-add-options ieee } */\n \n /* All references to link_error should go away at compile-time.  The"}, {"sha": "2f1708b8030db25748a215e9f81d2ef0dd71bad7", "filename": "gcc/testsuite/gcc.dg/torture/builtin-frexp-1.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/510e072da902bb3651dcfcdcee48d75e12ace6d6/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fbuiltin-frexp-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/510e072da902bb3651dcfcdcee48d75e12ace6d6/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fbuiltin-frexp-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fbuiltin-frexp-1.c?ref=510e072da902bb3651dcfcdcee48d75e12ace6d6", "patch": "@@ -9,6 +9,7 @@\n /* { dg-options \"-fno-finite-math-only\" { target sh*-*-* } } */\n /* In order to fold algebraic exprs below, targets with \"composite\"\n    floating point formats need -funsafe-math-optimizations.  */\n+/* { dg-require-effective-target inf } */\n /* { dg-options \"-funsafe-math-optimizations\" { target powerpc*-*-* } } */\n \n extern void link_error(int);"}, {"sha": "05fa2b921e7c6ea2b27141d5f02b370ddbc1faa1", "filename": "gcc/testsuite/gcc.dg/torture/builtin-ldexp-1.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/510e072da902bb3651dcfcdcee48d75e12ace6d6/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fbuiltin-ldexp-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/510e072da902bb3651dcfcdcee48d75e12ace6d6/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fbuiltin-ldexp-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fbuiltin-ldexp-1.c?ref=510e072da902bb3651dcfcdcee48d75e12ace6d6", "patch": "@@ -7,6 +7,7 @@\n \n /* { dg-do link } */\n /* { dg-options \"-fno-finite-math-only\" { target sh*-*-* } } */\n+/* { dg-require-effective-target inf } */\n /* { dg-skip-if \"\" { *-*-* } { \"-O0\" } { \"\" } } */\n \n extern void link_error(int);"}, {"sha": "087d87f01fbc3f89fe6ea2bd837f79a71027a35d", "filename": "gcc/testsuite/gcc.dg/torture/builtin-logb-1.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/510e072da902bb3651dcfcdcee48d75e12ace6d6/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fbuiltin-logb-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/510e072da902bb3651dcfcdcee48d75e12ace6d6/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fbuiltin-logb-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fbuiltin-logb-1.c?ref=510e072da902bb3651dcfcdcee48d75e12ace6d6", "patch": "@@ -9,6 +9,7 @@\n /* { dg-options \"-fno-finite-math-only\" { target sh*-*-* } } */\n /* In order to fold algebraic exprs below, targets with \"composite\"\n    floating point formats need -funsafe-math-optimizations.  */\n+/* { dg-require-effective-target inf } */\n /* { dg-options \"-funsafe-math-optimizations\" { target powerpc*-*-* } } */\n \n extern void link_error(int);"}, {"sha": "73db91681effc9396198c1909a0c56d9ae92d42f", "filename": "gcc/testsuite/gcc.dg/torture/builtin-math-2.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/510e072da902bb3651dcfcdcee48d75e12ace6d6/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fbuiltin-math-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/510e072da902bb3651dcfcdcee48d75e12ace6d6/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fbuiltin-math-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fbuiltin-math-2.c?ref=510e072da902bb3651dcfcdcee48d75e12ace6d6", "patch": "@@ -6,6 +6,7 @@\n    Origin: Kaveh R. Ghazi,  October 22, 2006.  */\n \n /* { dg-do compile } */\n+/* { dg-require-effective-target inf } */\n /* { dg-options \"-fdump-tree-original\" } */\n \n extern void foof (float);"}, {"sha": "9ea906c568a8d0f5ee9039bea4dd8f439e7e02ab", "filename": "gcc/testsuite/gcc.dg/torture/builtin-math-5.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/510e072da902bb3651dcfcdcee48d75e12ace6d6/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fbuiltin-math-5.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/510e072da902bb3651dcfcdcee48d75e12ace6d6/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fbuiltin-math-5.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fbuiltin-math-5.c?ref=510e072da902bb3651dcfcdcee48d75e12ace6d6", "patch": "@@ -6,6 +6,7 @@\n    Origin: Kaveh R. Ghazi,  January 28, 2009.  */\n \n /* { dg-do compile } */\n+/* { dg-require-effective-target inf } */\n /* { dg-options \"-fdump-tree-original\" } */\n \n extern void foof (_Complex float);"}, {"sha": "bdd5907177d95c0939fe2d8bcf4e15f391cea550", "filename": "gcc/testsuite/gcc.dg/torture/builtin-math-7.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/510e072da902bb3651dcfcdcee48d75e12ace6d6/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fbuiltin-math-7.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/510e072da902bb3651dcfcdcee48d75e12ace6d6/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fbuiltin-math-7.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fbuiltin-math-7.c?ref=510e072da902bb3651dcfcdcee48d75e12ace6d6", "patch": "@@ -7,6 +7,7 @@\n /* { dg-do run } */\n /* C6X fails due to -freciprocal-math default.  */\n /* { dg-skip-if \"\" { tic6x-*-* } } */\n+/* { dg-require-effective-target inf } */\n /* { dg-add-options ieee } */\n /* { dg-require-effective-target large_double } */\n "}, {"sha": "78d3032430792cbe22ab88bc60774b76e58c02ae", "filename": "gcc/testsuite/gcc.dg/torture/builtin-modf-1.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/510e072da902bb3651dcfcdcee48d75e12ace6d6/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fbuiltin-modf-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/510e072da902bb3651dcfcdcee48d75e12ace6d6/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fbuiltin-modf-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fbuiltin-modf-1.c?ref=510e072da902bb3651dcfcdcee48d75e12ace6d6", "patch": "@@ -6,6 +6,7 @@\n    Origin: Kaveh R. Ghazi,  February 23, 2007.  */\n \n /* { dg-do link } */\n+/* { dg-require-effective-target inf } */\n /* { dg-options \"-fno-finite-math-only\" { target sh*-*-* } } */\n /* { dg-options \"-funsafe-math-optimizations -fsigned-zeros -fno-associative-math\" { target powerpc-*-darwin* powerpc*-*-linux* } } */\n "}, {"sha": "3df6f9b2d93cfdbb76f0e4298859b8fa47312e75", "filename": "gcc/testsuite/gcc.dg/torture/type-generic-1.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/510e072da902bb3651dcfcdcee48d75e12ace6d6/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Ftype-generic-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/510e072da902bb3651dcfcdcee48d75e12ace6d6/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Ftype-generic-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Ftype-generic-1.c?ref=510e072da902bb3651dcfcdcee48d75e12ace6d6", "patch": "@@ -2,6 +2,7 @@\n    without any fast-math flags.  */\n \n /* { dg-do run } */\n+/* { dg-require-effective-target inf } */\n /* { dg-skip-if \"No Inf/NaN support\" { spu-*-* } } */\n /* { dg-skip-if \"No subnormal support\" { csky-*-* } { \"-mhard-float\" } } */\n /* { dg-options \"-DUNSAFE\" { target tic6x*-*-* visium-*-* nvptx-*-* } } */"}, {"sha": "9780e53dfc0b4be920675f54b164e79582fe17f0", "filename": "gcc/testsuite/lib/target-supports.exp", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/510e072da902bb3651dcfcdcee48d75e12ace6d6/gcc%2Ftestsuite%2Flib%2Ftarget-supports.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/510e072da902bb3651dcfcdcee48d75e12ace6d6/gcc%2Ftestsuite%2Flib%2Ftarget-supports.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Flib%2Ftarget-supports.exp?ref=510e072da902bb3651dcfcdcee48d75e12ace6d6", "patch": "@@ -8933,3 +8933,10 @@ proc check_effective_target_cet { } {\n \t}\n     } \"-O2\" ]\n }\n+\n+# Return 1 if target supports floating point \"infinite\"\n+proc check_effective_target_inf { } {\n+    return [check_no_compiler_messages supports_inf assembly {\n+        const double pinf = __builtin_inf ();\n+    }]\n+}"}]}