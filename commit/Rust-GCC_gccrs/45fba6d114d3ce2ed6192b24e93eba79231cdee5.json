{"sha": "45fba6d114d3ce2ed6192b24e93eba79231cdee5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDVmYmE2ZDExNGQzY2UyZWQ2MTkyYjI0ZTkzZWJhNzkyMzFjZGVlNQ==", "commit": {"author": {"name": "Richard Henderson", "email": "rth@redhat.com", "date": "2011-07-09T19:57:27Z"}, "committer": {"name": "Richard Henderson", "email": "rth@gcc.gnu.org", "date": "2011-07-09T19:57:27Z"}, "message": "re PR rtl-optimization/49686 (CFI notes are missed for delayed slot)\n\nPR debug/49686\n\t* dwarf2cfi.c (dwarf2out_frame_debug): Don't set cfi_insn here...\n\t(create_cfi_notes): ... do it here instead.\n\nFrom-SVN: r176091", "tree": {"sha": "358bc24130084bd3459847b70ee6eecb6e8a8a5b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/358bc24130084bd3459847b70ee6eecb6e8a8a5b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/45fba6d114d3ce2ed6192b24e93eba79231cdee5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/45fba6d114d3ce2ed6192b24e93eba79231cdee5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/45fba6d114d3ce2ed6192b24e93eba79231cdee5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/45fba6d114d3ce2ed6192b24e93eba79231cdee5/comments", "author": null, "committer": null, "parents": [{"sha": "dbbb299a30bda57a2741e3b737e2448ea79d0f9c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dbbb299a30bda57a2741e3b737e2448ea79d0f9c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dbbb299a30bda57a2741e3b737e2448ea79d0f9c"}], "stats": {"total": 31, "additions": 15, "deletions": 16}, "files": [{"sha": "99545fc2416d88be83efbf583d8010e672519a76", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/45fba6d114d3ce2ed6192b24e93eba79231cdee5/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/45fba6d114d3ce2ed6192b24e93eba79231cdee5/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=45fba6d114d3ce2ed6192b24e93eba79231cdee5", "patch": "@@ -1,3 +1,9 @@\n+2011-07-09  Richard Henderson  <rth@redhat.com>\n+\n+\tPR debug/49686\n+\t* dwarf2cfi.c (dwarf2out_frame_debug): Don't set cfi_insn here...\n+\t(create_cfi_notes): ... do it here instead.\n+\n 2011-07-09  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR debug/49676"}, {"sha": "d96aa703878e99da0818dfa60472998cb214ab86", "filename": "gcc/dwarf2cfi.c", "status": "modified", "additions": 9, "deletions": 16, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/45fba6d114d3ce2ed6192b24e93eba79231cdee5/gcc%2Fdwarf2cfi.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/45fba6d114d3ce2ed6192b24e93eba79231cdee5/gcc%2Fdwarf2cfi.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdwarf2cfi.c?ref=45fba6d114d3ce2ed6192b24e93eba79231cdee5", "patch": "@@ -2180,17 +2180,6 @@ dwarf2out_frame_debug (rtx insn, bool after_p)\n   bool handled_one = false;\n   bool need_flush = false;\n \n-  /* Remember where we are to insert notes.  Do not separate tablejump\n-     insns from their ADDR_DIFF_VEC.  Putting the note after the VEC\n-     should be ok.  */\n-  if (after_p)\n-    {\n-      if (!tablejump_p (insn, NULL, &cfi_insn))\n-\tcfi_insn = insn;\n-    }\n-  else\n-    cfi_insn = PREV_INSN (insn);\n-\n   if (!NONJUMP_INSN_P (insn) || clobbers_queued_reg_save (insn))\n     dwarf2out_flush_queued_reg_saves ();\n \n@@ -2201,7 +2190,6 @@ dwarf2out_frame_debug (rtx insn, bool after_p)\n \t is still used to save registers.  */\n       if (!ACCUMULATE_OUTGOING_ARGS)\n \tdwarf2out_notice_stack_adjust (insn, after_p);\n-      cfi_insn = NULL;\n       return;\n     }\n \n@@ -2323,7 +2311,6 @@ dwarf2out_frame_debug (rtx insn, bool after_p)\n \n   if (need_flush)\n     dwarf2out_flush_queued_reg_saves ();\n-  cfi_insn = NULL;\n }\n \n /* Examine CFI and return true if a cfi label and set_loc is needed\n@@ -2432,6 +2419,8 @@ create_cfi_notes (void)\n     {\n       rtx pat;\n \n+      cfi_insn = PREV_INSN (insn);\n+\n       if (BARRIER_P (insn))\n \t{\n \t  dwarf2out_frame_debug (insn, false);\n@@ -2443,9 +2432,7 @@ create_cfi_notes (void)\n \t  switch (NOTE_KIND (insn))\n \t    {\n \t    case NOTE_INSN_PROLOGUE_END:\n-\t      cfi_insn = PREV_INSN (insn);\n \t      dwarf2out_flush_queued_reg_saves ();\n-\t      cfi_insn = NULL;\n \t      break;\n \n \t    case NOTE_INSN_EPILOGUE_BEG:\n@@ -2457,7 +2444,6 @@ create_cfi_notes (void)\n \t    case NOTE_INSN_CFA_RESTORE_STATE:\n \t      cfi_insn = insn;\n \t      dwarf2out_frame_debug_restore_state ();\n-\t      cfi_insn = NULL;\n \t      break;\n \t    }\n \t  continue;\n@@ -2484,8 +2470,15 @@ create_cfi_notes (void)\n \t  || find_reg_note (insn, REG_CFA_FLUSH_QUEUE, NULL))\n \tdwarf2out_frame_debug (insn, false);\n \n+      /* Do not separate tablejump insns from their ADDR_DIFF_VEC.\n+\t Putting the note after the VEC should be ok.  */\n+      if (!tablejump_p (insn, NULL, &cfi_insn))\n+\tcfi_insn = insn;\n+\n       dwarf2out_frame_debug (insn, true);\n     }\n+\n+  cfi_insn = NULL;\n }\n \n /* Determine if we need to save and restore CFI information around this"}]}