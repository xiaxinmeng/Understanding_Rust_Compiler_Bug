{"sha": "58aca9d95cbd0535a99a9642e2e997ea0fd30788", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NThhY2E5ZDk1Y2JkMDUzNWE5OWE5NjQyZTJlOTk3ZWEwZmQzMDc4OA==", "commit": {"author": {"name": "Nathan Sidwell", "email": "nathan@acm.org", "date": "2017-05-22T12:25:06Z"}, "committer": {"name": "Nathan Sidwell", "email": "nathan@gcc.gnu.org", "date": "2017-05-22T12:25:06Z"}, "message": "invoke.texi (fdump-translation-unit): Delete documentation.\n\n\tgcc/\n\t* doc/invoke.texi (fdump-translation-unit): Delete documentation.\n\t(fdump-lang): Document 'raw' option.\n\t* dumpfile.h (TDI_tu): Delete.\n\t* dumpfile.c (dump_files): Remove translation-unit.\n\t(FIRST_AUTO_NUMBERED_DUMP): Decrement.\n\tgcc/cp/\n\t* cp-objcp-common.c (cp_register_dumps): Register raw dumper.\n\t* cp-tree.h (raw_dump_id): Declare.\n\t* decl2.c (raw_dump_id): Define.\n\t(dump_tu): Use raw_dump_id.\n\tgcc/c/\n\t* c-decl.c (c_parse_final_cleanups): Drop TDI_tu handling.\n\nFrom-SVN: r248333", "tree": {"sha": "ad8286ae024d6c89243ce9157d5befffd07d61d4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ad8286ae024d6c89243ce9157d5befffd07d61d4"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/58aca9d95cbd0535a99a9642e2e997ea0fd30788", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/58aca9d95cbd0535a99a9642e2e997ea0fd30788", "html_url": "https://github.com/Rust-GCC/gccrs/commit/58aca9d95cbd0535a99a9642e2e997ea0fd30788", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/58aca9d95cbd0535a99a9642e2e997ea0fd30788/comments", "author": {"login": "urnathan", "id": 13103001, "node_id": "MDQ6VXNlcjEzMTAzMDAx", "avatar_url": "https://avatars.githubusercontent.com/u/13103001?v=4", "gravatar_id": "", "url": "https://api.github.com/users/urnathan", "html_url": "https://github.com/urnathan", "followers_url": "https://api.github.com/users/urnathan/followers", "following_url": "https://api.github.com/users/urnathan/following{/other_user}", "gists_url": "https://api.github.com/users/urnathan/gists{/gist_id}", "starred_url": "https://api.github.com/users/urnathan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/urnathan/subscriptions", "organizations_url": "https://api.github.com/users/urnathan/orgs", "repos_url": "https://api.github.com/users/urnathan/repos", "events_url": "https://api.github.com/users/urnathan/events{/privacy}", "received_events_url": "https://api.github.com/users/urnathan/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "6aea3c3720b89f43b3fd6553a8a70fa5fc26dd4b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6aea3c3720b89f43b3fd6553a8a70fa5fc26dd4b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6aea3c3720b89f43b3fd6553a8a70fa5fc26dd4b"}], "stats": {"total": 62, "additions": 31, "deletions": 31}, "files": [{"sha": "46f39ae486cf12b51f16d45957c03119a2384111", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/58aca9d95cbd0535a99a9642e2e997ea0fd30788/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/58aca9d95cbd0535a99a9642e2e997ea0fd30788/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=58aca9d95cbd0535a99a9642e2e997ea0fd30788", "patch": "@@ -1,3 +1,11 @@\n+2017-05-22  Nathan Sidwell  <nathan@acm.org>\n+\n+\t* doc/invoke.texi (fdump-translation-unit): Delete documentation.\n+\t(fdump-lang): Document 'raw' option.\n+\t* dumpfile.h (TDI_tu): Delete.\n+\t* dumpfile.c (dump_files): Remove translation-unit.\n+\t(FIRST_AUTO_NUMBERED_DUMP): Decrement.\n+\n 2017-05-22  Georg-Johann Lay  <avr@gjlay.de>\n \n \t* config/avr/t-avr (AWK) [t-multilib]: Remove \"-v FORMAT=Makefile\""}, {"sha": "0318bcf043b5fd0295dca3a5174d334abc2b644b", "filename": "gcc/c/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/58aca9d95cbd0535a99a9642e2e997ea0fd30788/gcc%2Fc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/58aca9d95cbd0535a99a9642e2e997ea0fd30788/gcc%2Fc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc%2FChangeLog?ref=58aca9d95cbd0535a99a9642e2e997ea0fd30788", "patch": "@@ -1,3 +1,7 @@\n+2017-05-22  Nathan Sidwell  <nathan@acm.org>\n+\n+\t* c-decl.c (c_parse_final_cleanups): Drop TDI_tu handling.\n+\n 2017-05-19  Thomas Schwinge  <thomas@codesourcery.com>\n \n \t* c-parser.c (c_parser_omp_clause_default): Handle"}, {"sha": "f2b8096d84a1ec07a7699662b8727edd2400c734", "filename": "gcc/c/c-decl.c", "status": "modified", "additions": 0, "deletions": 12, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/58aca9d95cbd0535a99a9642e2e997ea0fd30788/gcc%2Fc%2Fc-decl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/58aca9d95cbd0535a99a9642e2e997ea0fd30788/gcc%2Fc%2Fc-decl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc%2Fc-decl.c?ref=58aca9d95cbd0535a99a9642e2e997ea0fd30788", "patch": "@@ -11214,18 +11214,6 @@ c_parse_final_cleanups (void)\n       dump_ada_specs (collect_all_refs, NULL);\n     }\n \n-  if (ext_block)\n-    {\n-      tree tmp = BLOCK_VARS (ext_block);\n-      dump_flags_t flags;\n-      FILE * stream = dump_begin (TDI_tu, &flags);\n-      if (stream && tmp)\n-\t{\n-\t  dump_node (tmp, flags & ~TDF_SLIM, stream);\n-\t  dump_end (TDI_tu, stream);\n-\t}\n-    }\n-\n   /* Process all file scopes in this compilation, and the external_scope,\n      through wrapup_global_declarations.  */\n   FOR_EACH_VEC_ELT (*all_translation_units, i, t)"}, {"sha": "8b272c84d25f3c06730666ca686d69adc163dc5a", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/58aca9d95cbd0535a99a9642e2e997ea0fd30788/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/58aca9d95cbd0535a99a9642e2e997ea0fd30788/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=58aca9d95cbd0535a99a9642e2e997ea0fd30788", "patch": "@@ -1,5 +1,10 @@\n 2017-05-22  Nathan Sidwell  <nathan@acm.org>\n \n+\t* cp-objcp-common.c (cp_register_dumps): Register raw dumper.\n+\t* cp-tree.h (raw_dump_id): Declare.\n+\t* decl2.c (raw_dump_id): Define.\n+\t(dump_tu): Use raw_dump_id.\n+\n \t* config-lang.in (gtfiles): Sort list, break lines.\n \n \t* cp-tree.h (CPTI_TERMINATE, CPTI_CALL_UNEXPECTED): Rename to ..."}, {"sha": "5a7da5b495713780fb24cdf817a0ddb865f7202c", "filename": "gcc/cp/cp-objcp-common.c", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/58aca9d95cbd0535a99a9642e2e997ea0fd30788/gcc%2Fcp%2Fcp-objcp-common.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/58aca9d95cbd0535a99a9642e2e997ea0fd30788/gcc%2Fcp%2Fcp-objcp-common.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fcp-objcp-common.c?ref=58aca9d95cbd0535a99a9642e2e997ea0fd30788", "patch": "@@ -359,6 +359,9 @@ cp_register_dumps (gcc::dump_manager *dumps)\n {\n   class_dump_id = dumps->dump_register\n     (\".class\", \"lang-class\", \"lang-class\", DK_lang, OPTGROUP_NONE, false);\n+\n+  raw_dump_id = dumps->dump_register\n+    (\".raw\", \"lang-raw\", \"lang-raw\", DK_lang, OPTGROUP_NONE, false);\n }\n \n void"}, {"sha": "0064222599fed74a9528a1cbff1205f6bafa8069", "filename": "gcc/cp/cp-tree.h", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/58aca9d95cbd0535a99a9642e2e997ea0fd30788/gcc%2Fcp%2Fcp-tree.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/58aca9d95cbd0535a99a9642e2e997ea0fd30788/gcc%2Fcp%2Fcp-tree.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fcp-tree.h?ref=58aca9d95cbd0535a99a9642e2e997ea0fd30788", "patch": "@@ -5776,6 +5776,7 @@ extern cp_parameter_declarator *no_parameters;\n \n /* Various dump ids.  */\n extern int class_dump_id;\n+extern int raw_dump_id;\n \n /* in call.c */\n extern bool check_dtor_name\t\t\t(tree, tree);"}, {"sha": "7247b0fb4fac0322e17590b944d15c8be873de59", "filename": "gcc/cp/decl2.c", "status": "modified", "additions": 5, "deletions": 4, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/58aca9d95cbd0535a99a9642e2e997ea0fd30788/gcc%2Fcp%2Fdecl2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/58aca9d95cbd0535a99a9642e2e997ea0fd30788/gcc%2Fcp%2Fdecl2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl2.c?ref=58aca9d95cbd0535a99a9642e2e997ea0fd30788", "patch": "@@ -49,6 +49,9 @@ along with GCC; see the file COPYING3.  If not see\n #include \"c-family/c-ada-spec.h\"\n #include \"asan.h\"\n \n+/* Id for dumping the raw trees.  */\n+int raw_dump_id;\n+ \n extern cpp_reader *parse_in;\n \n /* This structure contains information about the initializations\n@@ -4362,12 +4365,10 @@ static void\n dump_tu (void)\n {\n   dump_flags_t flags;\n-  FILE *stream = dump_begin (TDI_tu, &flags);\n-\n-  if (stream)\n+  if (FILE *stream = dump_begin (raw_dump_id, &flags))\n     {\n       dump_node (global_namespace, flags & ~TDF_SLIM, stream);\n-      dump_end (TDI_tu, stream);\n+      dump_end (raw_dump_id, stream);\n     }\n }\n "}, {"sha": "a65e78f4376fff826de4d95b5714f361d33162ab", "filename": "gcc/doc/invoke.texi", "status": "modified", "additions": 4, "deletions": 12, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/58aca9d95cbd0535a99a9642e2e997ea0fd30788/gcc%2Fdoc%2Finvoke.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/58aca9d95cbd0535a99a9642e2e997ea0fd30788/gcc%2Fdoc%2Finvoke.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdoc%2Finvoke.texi?ref=58aca9d95cbd0535a99a9642e2e997ea0fd30788", "patch": "@@ -550,7 +550,6 @@ Objective-C and Objective-C++ Dialects}.\n -fdump-passes @gol\n -fdump-rtl-@var{pass}  -fdump-rtl-@var{pass}=@var{filename} @gol\n -fdump-statistics @gol\n--fdump-translation-unit@r{[}-@var{n}@r{]} @gol\n -fdump-tree-all @gol\n -fdump-tree-@var{switch} @gol\n -fdump-tree-@var{switch}-@var{options} @gol\n@@ -12972,7 +12971,7 @@ Dump after function inlining.\n @opindex fdump-lang\n Control the dumping of language-specific information.  The @var{options}\n and @var{filename} portions behave as described in the\n-`@option{-fdump-tree} option.  The following @var{switch} values are\n+@option{-fdump-tree} option.  The following @var{switch} values are\n accepted:\n \n @table @samp\n@@ -12984,6 +12983,9 @@ Enable all language-specific dumps.\n Dump class hierarchy information.  Virtual table information is emitted\n unless '@option{slim}' is specified.  This option is applicable to C++ only.\n \n+@item raw\n+Dump the raw internal tree data.  This option is applicable to C++ only.\n+\n @end table\n \n @item -fdump-passes\n@@ -13002,16 +13004,6 @@ whole compilation unit while @samp{-details} dumps every event as\n the passes generate them.  The default with no option is to sum\n counters for each function compiled.\n \n-@item -fdump-translation-unit @r{(C++ only)}\n-@itemx -fdump-translation-unit-@var{options} @r{(C++ only)}\n-@opindex fdump-translation-unit\n-Dump a representation of the tree structure for the entire translation\n-unit to a file.  The file name is made by appending @file{.tu} to the\n-source file name, and the file is created in the same directory as the\n-output file.  If the @samp{-@var{options}} form is used, @var{options}\n-controls the details of the dump as described for the\n-@option{-fdump-tree} options.\n-\n @item -fdump-tree-all\n @itemx -fdump-tree-@var{switch}\n @itemx -fdump-tree-@var{switch}-@var{options}"}, {"sha": "13a711345b4442ff316c24fd4a3d51ac2319529d", "filename": "gcc/dumpfile.c", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/58aca9d95cbd0535a99a9642e2e997ea0fd30788/gcc%2Fdumpfile.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/58aca9d95cbd0535a99a9642e2e997ea0fd30788/gcc%2Fdumpfile.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdumpfile.c?ref=58aca9d95cbd0535a99a9642e2e997ea0fd30788", "patch": "@@ -73,11 +73,10 @@ static struct dump_file_info dump_files[TDI_end] =\n   dump_file_info (\".cgraph\", \"ipa-cgraph\", DK_ipa, 0),\n   dump_file_info (\".type-inheritance\", \"ipa-type-inheritance\", DK_ipa, 0),\n   dump_file_info (\".ipa-clones\", \"ipa-clones\", DK_ipa, 0),\n-  dump_file_info (\".tu\", \"translation-unit\", DK_lang, 1),\n   dump_file_info (\".original\", \"tree-original\", DK_tree, 3),\n   dump_file_info (\".gimple\", \"tree-gimple\", DK_tree, 4),\n   dump_file_info (\".nested\", \"tree-nested\", DK_tree, 5),\n-#define FIRST_AUTO_NUMBERED_DUMP 4\n+#define FIRST_AUTO_NUMBERED_DUMP 3\n \n   dump_file_info (NULL, \"lang-all\", DK_lang, 0),\n   dump_file_info (NULL, \"tree-all\", DK_tree, 0),"}, {"sha": "a1e4720156dd291d39ada32b9fd880b41acbe76d", "filename": "gcc/dumpfile.h", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/58aca9d95cbd0535a99a9642e2e997ea0fd30788/gcc%2Fdumpfile.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/58aca9d95cbd0535a99a9642e2e997ea0fd30788/gcc%2Fdumpfile.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdumpfile.h?ref=58aca9d95cbd0535a99a9642e2e997ea0fd30788", "patch": "@@ -30,7 +30,6 @@ enum tree_dump_index\n   TDI_cgraph,\t\t\t/* dump function call graph.  */\n   TDI_inheritance,\t\t/* dump type inheritance graph.  */\n   TDI_clones,\t\t\t/* dump IPA cloning decisions.  */\n-  TDI_tu,\t\t\t/* dump the whole translation unit.  */\n   TDI_original,\t\t\t/* dump each function before optimizing it */\n   TDI_generic,\t\t\t/* dump each function after genericizing it */\n   TDI_nested,\t\t\t/* dump each function after unnesting it */"}]}