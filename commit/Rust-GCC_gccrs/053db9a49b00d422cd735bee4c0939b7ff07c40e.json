{"sha": "053db9a49b00d422cd735bee4c0939b7ff07c40e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDUzZGI5YTQ5YjAwZDQyMmNkNzM1YmVlNGMwOTM5YjdmZjA3YzQwZQ==", "commit": {"author": {"name": "Indu Bhagat", "email": "indu.bhagat@oracle.com", "date": "2021-09-07T18:16:53Z"}, "committer": {"name": "Indu Bhagat", "email": "indu.bhagat@oracle.com", "date": "2021-09-07T18:16:53Z"}, "message": "debug: Add BTF_WITH_CORE_DEBUG debug format\n\nTo best handle BTF/CO-RE in GCC, a distinct BTF_WITH_CORE_DEBUG debug format is\nbeing added.  This helps the compiler detect whether BTF with CO-RE relocations\nneeds to be emitted.\n\ngcc/ChangeLog:\n\n\t* flag-types.h (enum debug_info_type): Add new enum\n\tDINFO_TYPE_BTF_WITH_CORE.\n\t(BTF_WITH_CORE_DEBUG): New bitmask.\n\t* flags.h (btf_with_core_debuginfo_p): New declaration.\n\t* opts.c (btf_with_core_debuginfo_p): New definition.", "tree": {"sha": "a8d0e57d81aaf1040a352afe7aa5f6946b6d55f0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a8d0e57d81aaf1040a352afe7aa5f6946b6d55f0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/053db9a49b00d422cd735bee4c0939b7ff07c40e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/053db9a49b00d422cd735bee4c0939b7ff07c40e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/053db9a49b00d422cd735bee4c0939b7ff07c40e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/053db9a49b00d422cd735bee4c0939b7ff07c40e/comments", "author": {"login": "ibhagatgnu", "id": 51812649, "node_id": "MDQ6VXNlcjUxODEyNjQ5", "avatar_url": "https://avatars.githubusercontent.com/u/51812649?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ibhagatgnu", "html_url": "https://github.com/ibhagatgnu", "followers_url": "https://api.github.com/users/ibhagatgnu/followers", "following_url": "https://api.github.com/users/ibhagatgnu/following{/other_user}", "gists_url": "https://api.github.com/users/ibhagatgnu/gists{/gist_id}", "starred_url": "https://api.github.com/users/ibhagatgnu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ibhagatgnu/subscriptions", "organizations_url": "https://api.github.com/users/ibhagatgnu/orgs", "repos_url": "https://api.github.com/users/ibhagatgnu/repos", "events_url": "https://api.github.com/users/ibhagatgnu/events{/privacy}", "received_events_url": "https://api.github.com/users/ibhagatgnu/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ibhagatgnu", "id": 51812649, "node_id": "MDQ6VXNlcjUxODEyNjQ5", "avatar_url": "https://avatars.githubusercontent.com/u/51812649?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ibhagatgnu", "html_url": "https://github.com/ibhagatgnu", "followers_url": "https://api.github.com/users/ibhagatgnu/followers", "following_url": "https://api.github.com/users/ibhagatgnu/following{/other_user}", "gists_url": "https://api.github.com/users/ibhagatgnu/gists{/gist_id}", "starred_url": "https://api.github.com/users/ibhagatgnu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ibhagatgnu/subscriptions", "organizations_url": "https://api.github.com/users/ibhagatgnu/orgs", "repos_url": "https://api.github.com/users/ibhagatgnu/repos", "events_url": "https://api.github.com/users/ibhagatgnu/events{/privacy}", "received_events_url": "https://api.github.com/users/ibhagatgnu/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c03db573b9e619f9e4f7d7111f99877368c78e26", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c03db573b9e619f9e4f7d7111f99877368c78e26", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c03db573b9e619f9e4f7d7111f99877368c78e26"}], "stats": {"total": 18, "additions": 17, "deletions": 1}, "files": [{"sha": "cc41b2ae1034c4f99c7d9c5cbcfa38a43695b9dc", "filename": "gcc/flag-types.h", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/053db9a49b00d422cd735bee4c0939b7ff07c40e/gcc%2Fflag-types.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/053db9a49b00d422cd735bee4c0939b7ff07c40e/gcc%2Fflag-types.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fflag-types.h?ref=053db9a49b00d422cd735bee4c0939b7ff07c40e", "patch": "@@ -31,7 +31,8 @@ enum debug_info_type\n   DINFO_TYPE_VMS = 4,\t\t  /* VMS debug info.  */\n   DINFO_TYPE_CTF = 5,\t\t  /* CTF debug info.  */\n   DINFO_TYPE_BTF = 6,\t\t  /* BTF debug info.  */\n-  DINFO_TYPE_MAX = DINFO_TYPE_BTF /* Marker only.  */\n+  DINFO_TYPE_BTF_WITH_CORE = 7,\t  /* BTF debug info with CO-RE relocations.  */\n+  DINFO_TYPE_MAX = DINFO_TYPE_BTF_WITH_CORE /* Marker only.  */\n };\n \n #define NO_DEBUG      (0U)\n@@ -47,6 +48,9 @@ enum debug_info_type\n #define CTF_DEBUG     (1U << DINFO_TYPE_CTF)\n /* Write BTF debug info (using btfout.c).  */\n #define BTF_DEBUG     (1U << DINFO_TYPE_BTF)\n+/* Write BTF debug info for BPF CO-RE usecase (using btfout.c).  */\n+#define BTF_WITH_CORE_DEBUG     (1U << DINFO_TYPE_BTF_WITH_CORE)\n+\n /* Note: Adding new definitions to handle -combination- of debug formats,\n    like VMS_AND_DWARF2_DEBUG is not recommended.  This definition remains\n    here for historical reasons.  */"}, {"sha": "af61bcd613bdabe02d08379a673f4d9be4ce0cba", "filename": "gcc/flags.h", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/053db9a49b00d422cd735bee4c0939b7ff07c40e/gcc%2Fflags.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/053db9a49b00d422cd735bee4c0939b7ff07c40e/gcc%2Fflags.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fflags.h?ref=053db9a49b00d422cd735bee4c0939b7ff07c40e", "patch": "@@ -44,6 +44,10 @@ const char * debug_set_names (uint32_t w_symbols);\n \n extern bool btf_debuginfo_p ();\n \n+/* Return true iff BTF with CO-RE debug info is enabled.  */\n+\n+extern bool btf_with_core_debuginfo_p ();\n+\n /* Return true iff CTF debug info is enabled.  */\n \n extern bool ctf_debuginfo_p ();"}, {"sha": "1d2d22d7a3fd586de1bed7d4da9da71152d878ee", "filename": "gcc/opts.c", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/053db9a49b00d422cd735bee4c0939b7ff07c40e/gcc%2Fopts.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/053db9a49b00d422cd735bee4c0939b7ff07c40e/gcc%2Fopts.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fopts.c?ref=053db9a49b00d422cd735bee4c0939b7ff07c40e", "patch": "@@ -135,6 +135,14 @@ btf_debuginfo_p ()\n   return (write_symbols & BTF_DEBUG);\n }\n \n+/* Return TRUE iff BTF with CO-RE debug info is enabled.  */\n+\n+bool\n+btf_with_core_debuginfo_p ()\n+{\n+  return (write_symbols & BTF_WITH_CORE_DEBUG);\n+}\n+\n /* Return TRUE iff CTF debug info is enabled.  */\n \n bool"}]}