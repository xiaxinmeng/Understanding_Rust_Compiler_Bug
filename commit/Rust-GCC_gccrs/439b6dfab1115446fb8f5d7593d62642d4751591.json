{"sha": "439b6dfab1115446fb8f5d7593d62642d4751591", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDM5YjZkZmFiMTExNTQ0NmZiOGY1ZDc1OTNkNjI2NDJkNDc1MTU5MQ==", "commit": {"author": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2011-09-02T09:36:28Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2011-09-02T09:36:28Z"}, "message": "[multiple changes]\n\n2011-09-02  Robert Dewar  <dewar@adacore.com>\n\n\t* lib-xref.adb: Minor reformatting\n\n2011-09-02  Vincent Celier  <celier@adacore.com>\n\n\t* bindusg.adb, clean.adb, gnatchop.adb, gnatfind.adb, gnatlink.adb,\n\tgnatls.adb, gnatname.adb, gnatxref.adb, gprep.adb, makeusg.adb: Add\n\t--version and --help in usage.\n\t* switch.ads, switch.adb (Display_Usage_Version_And_Help): New procedure\n\nFrom-SVN: r178454", "tree": {"sha": "0673333b8d1aca010ee78d617bf034a02271d9e9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0673333b8d1aca010ee78d617bf034a02271d9e9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/439b6dfab1115446fb8f5d7593d62642d4751591", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/439b6dfab1115446fb8f5d7593d62642d4751591", "html_url": "https://github.com/Rust-GCC/gccrs/commit/439b6dfab1115446fb8f5d7593d62642d4751591", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/439b6dfab1115446fb8f5d7593d62642d4751591/comments", "author": null, "committer": null, "parents": [{"sha": "f2404867dfe7ed85f8a9aff6cf218055ebbb23ae", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f2404867dfe7ed85f8a9aff6cf218055ebbb23ae", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f2404867dfe7ed85f8a9aff6cf218055ebbb23ae"}], "stats": {"total": 71, "additions": 62, "deletions": 9}, "files": [{"sha": "9321841aacd016120295eff680ec235055d33b02", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/439b6dfab1115446fb8f5d7593d62642d4751591/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/439b6dfab1115446fb8f5d7593d62642d4751591/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=439b6dfab1115446fb8f5d7593d62642d4751591", "patch": "@@ -1,3 +1,14 @@\n+2011-09-02  Robert Dewar  <dewar@adacore.com>\n+\n+\t* lib-xref.adb: Minor reformatting\n+\n+2011-09-02  Vincent Celier  <celier@adacore.com>\n+\n+\t* bindusg.adb, clean.adb, gnatchop.adb, gnatfind.adb, gnatlink.adb,\n+\tgnatls.adb, gnatname.adb, gnatxref.adb, gprep.adb, makeusg.adb: Add\n+\t--version and --help in usage.\n+\t* switch.ads, switch.adb (Display_Usage_Version_And_Help): New procedure\n+\n 2011-09-02  Bob Duff  <duff@adacore.com>\n \n \t* lib-xref.adb: (Hash): Avoid use of 'Mod attribute, because old"}, {"sha": "23840d3048c2c5c1cc451d5cb8b172179d91579c", "filename": "gcc/ada/bindusg.adb", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/439b6dfab1115446fb8f5d7593d62642d4751591/gcc%2Fada%2Fbindusg.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/439b6dfab1115446fb8f5d7593d62642d4751591/gcc%2Fada%2Fbindusg.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fbindusg.adb?ref=439b6dfab1115446fb8f5d7593d62642d4751591", "patch": "@@ -25,6 +25,7 @@\n \n with Osint;  use Osint;\n with Output; use Output;\n+with Switch; use Switch;\n \n with System.WCh_Con; use System.WCh_Con;\n \n@@ -55,6 +56,8 @@ package body Bindusg is\n       Write_Eol;\n       Write_Eol;\n \n+      Display_Usage_Version_And_Help;\n+\n       --  Line for @response_file\n \n       Write_Line (\"  @<resp_file> Get arguments from response file\");"}, {"sha": "f20253391cdf476e0b4774a385299c78fb96b7d8", "filename": "gcc/ada/clean.adb", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/439b6dfab1115446fb8f5d7593d62642d4751591/gcc%2Fada%2Fclean.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/439b6dfab1115446fb8f5d7593d62642d4751591/gcc%2Fada%2Fclean.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fclean.adb?ref=439b6dfab1115446fb8f5d7593d62642d4751591", "patch": "@@ -1893,6 +1893,8 @@ package body Clean is\n          Put_Line (\"Usage: gnatclean [switches] {[-innn] name}\");\n          New_Line;\n \n+         Display_Usage_Version_And_Help;\n+\n          Put_Line (\"  names is one or more file names from which \" &\n                    \"the .adb or .ads suffix may be omitted\");\n          Put_Line (\"  names may be omitted if -P<project> is specified\");"}, {"sha": "4cec050321c5c6274b28d4cc8afcf7d896fbb10b", "filename": "gcc/ada/gnatchop.adb", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/439b6dfab1115446fb8f5d7593d62642d4751591/gcc%2Fada%2Fgnatchop.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/439b6dfab1115446fb8f5d7593d62642d4751591/gcc%2Fada%2Fgnatchop.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgnatchop.adb?ref=439b6dfab1115446fb8f5d7593d62642d4751591", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 B o d y                                  --\n --                                                                          --\n---          Copyright (C) 1998-2009, Free Software Foundation, Inc.         --\n+--          Copyright (C) 1998-2011, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -1361,6 +1361,9 @@ procedure Gnatchop is\n          \"[-r] [-p] [-q] [-v] [-w] [-x] [--GCC=xx] file [file ...] [dir]\");\n \n       New_Line;\n+\n+      Display_Usage_Version_And_Help;\n+\n       Put_Line\n         (\"  -c       compilation mode, configuration pragmas \" &\n          \"follow RM rules\");"}, {"sha": "a98e013f2f86a0606b1be53396d00d4d750ab53f", "filename": "gcc/ada/gnatfind.adb", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/439b6dfab1115446fb8f5d7593d62642d4751591/gcc%2Fada%2Fgnatfind.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/439b6dfab1115446fb8f5d7593d62642d4751591/gcc%2Fada%2Fgnatfind.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgnatfind.adb?ref=439b6dfab1115446fb8f5d7593d62642d4751591", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 B o d y                                  --\n --                                                                          --\n---          Copyright (C) 1998-2009, Free Software Foundation, Inc.         --\n+--          Copyright (C) 1998-2011, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -299,6 +299,7 @@ procedure Gnatfind is\n                 & \"references. This parameters are optional\");\n       New_Line;\n       Put_Line (\"gnatfind switches:\");\n+      Display_Usage_Version_And_Help;\n       Put_Line (\"   -a        Consider all files, even when the ali file is \"\n                 & \"readonly\");\n       Put_Line (\"   -aIdir    Specify source files search path\");"}, {"sha": "61d3db3861fb0b5f52f3f2313f2ffe6424b1fd5a", "filename": "gcc/ada/gnatlink.adb", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/439b6dfab1115446fb8f5d7593d62642d4751591/gcc%2Fada%2Fgnatlink.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/439b6dfab1115446fb8f5d7593d62642d4751591/gcc%2Fada%2Fgnatlink.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgnatlink.adb?ref=439b6dfab1115446fb8f5d7593d62642d4751591", "patch": "@@ -1422,6 +1422,8 @@ procedure Gnatlink is\n       Write_Eol;\n       Write_Line (\"  mainprog.ali   the ALI file of the main program\");\n       Write_Eol;\n+      Write_Eol;\n+      Display_Usage_Version_And_Help;\n       Write_Line (\"  -f    Force object file list to be generated\");\n       Write_Line (\"  -g    Compile binder source file with debug information\");\n       Write_Line (\"  -n    Do not compile the binder source file\");"}, {"sha": "7c7b41f89e88966deaa697146583971e611410ab", "filename": "gcc/ada/gnatls.adb", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/439b6dfab1115446fb8f5d7593d62642d4751591/gcc%2Fada%2Fgnatls.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/439b6dfab1115446fb8f5d7593d62642d4751591/gcc%2Fada%2Fgnatls.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgnatls.adb?ref=439b6dfab1115446fb8f5d7593d62642d4751591", "patch": "@@ -1386,6 +1386,8 @@ procedure Gnatls is\n       Write_Str (\"switches:\");\n       Write_Eol;\n \n+      Display_Usage_Version_And_Help;\n+\n       --  Line for -a\n \n       Write_Str (\"  -a         also output relevant predefined units\");"}, {"sha": "c741834ec29a58bf1731769a27c99daecd9f9372", "filename": "gcc/ada/gnatname.adb", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/439b6dfab1115446fb8f5d7593d62642d4751591/gcc%2Fada%2Fgnatname.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/439b6dfab1115446fb8f5d7593d62642d4751591/gcc%2Fada%2Fgnatname.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgnatname.adb?ref=439b6dfab1115446fb8f5d7593d62642d4751591", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 B o d y                                  --\n --                                                                          --\n---          Copyright (C) 2001-2010, Free Software Foundation, Inc.         --\n+--          Copyright (C) 2001-2011, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -512,6 +512,8 @@ procedure Gnatname is\n          Write_Eol;\n          Write_Line (\"switches:\");\n \n+         Display_Usage_Version_And_Help;\n+\n          Write_Line (\"  --subdirs=dir real obj/lib/exec dirs are subdirs\");\n          Write_Eol;\n "}, {"sha": "cbdf54a6d942b9e60c21b382c005e80936efcc8b", "filename": "gcc/ada/gnatxref.adb", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/439b6dfab1115446fb8f5d7593d62642d4751591/gcc%2Fada%2Fgnatxref.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/439b6dfab1115446fb8f5d7593d62642d4751591/gcc%2Fada%2Fgnatxref.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgnatxref.adb?ref=439b6dfab1115446fb8f5d7593d62642d4751591", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 B o d y                                  --\n --                                                                          --\n---          Copyright (C) 1998-2010, Free Software Foundation, Inc.         --\n+--          Copyright (C) 1998-2011, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -257,6 +257,7 @@ procedure Gnatxref is\n                 \"including with'ed units\");\n       New_Line;\n       Put_Line (\"gnatxref switches:\");\n+      Display_Usage_Version_And_Help;\n       Put_Line (\"   -a        Consider all files, even when the ali file is\"\n                 & \" readonly\");\n       Put_Line (\"   -aIdir    Specify source files search path\");"}, {"sha": "f6ce3acf02ee48275d3f038cc6818d8f886bb41f", "filename": "gcc/ada/gprep.adb", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/439b6dfab1115446fb8f5d7593d62642d4751591/gcc%2Fada%2Fgprep.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/439b6dfab1115446fb8f5d7593d62642d4751591/gcc%2Fada%2Fgprep.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgprep.adb?ref=439b6dfab1115446fb8f5d7593d62642d4751591", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 B o d y                                  --\n --                                                                          --\n---          Copyright (C) 2002-2010, Free Software Foundation, Inc.         --\n+--          Copyright (C) 2002-2011, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -808,6 +808,7 @@ package body GPrep is\n       Write_Line (\"  deffile    Name of the definition file\");\n       Write_Eol;\n       Write_Line (\"gnatprep switches:\");\n+      Display_Usage_Version_And_Help;\n       Write_Line (\"   -b  Replace preprocessor lines by blank lines\");\n       Write_Line (\"   -c  Keep preprocessor lines as comments\");\n       Write_Line (\"   -C  Do symbol replacements within comments\");"}, {"sha": "f2df15f42761762d5535d12de2cb668aa2abef58", "filename": "gcc/ada/lib-xref.adb", "status": "modified", "additions": 9, "deletions": 4, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/439b6dfab1115446fb8f5d7593d62642d4751591/gcc%2Fada%2Flib-xref.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/439b6dfab1115446fb8f5d7593d62642d4751591/gcc%2Fada%2Flib-xref.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flib-xref.adb?ref=439b6dfab1115446fb8f5d7593d62642d4751591", "patch": "@@ -1058,10 +1058,15 @@ package body Lib.Xref is\n       XE : Xref_Entry renames Xrefs.Table (F);\n       type M is mod 2**32;\n \n-      H : constant M := M (XE.Key.Ent) + 2**7 * M (abs XE.Key.Loc);\n-      --  We can't use M'Mod above, because it prevents bootstrapping with\n-      --  older compilers. Loc can be negative, so we do \"abs\" before\n-      --  converting.\n+      H : constant M := M (XE.Key.Ent) + 2 ** 7 * M (abs XE.Key.Loc);\n+      --  It would be more natural to write:\n+      --\n+      --    H : constant M := M'Mod (XE.Key.Ent) + 2**7 * M'Mod (XE.Key.Loc);\n+      --\n+      --  But we can't use M'Mod, because it prevents bootstrapping with older\n+      --  compilers. Loc can be negative, so we do \"abs\" before converting.\n+      --  One day this can be cleaned up ???\n+\n    begin\n       return Header_Num (H mod Num_Buckets);\n    end Hash;"}, {"sha": "62cc703094b467b9c6f2db506cb324bf044328c6", "filename": "gcc/ada/makeusg.adb", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/439b6dfab1115446fb8f5d7593d62642d4751591/gcc%2Fada%2Fmakeusg.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/439b6dfab1115446fb8f5d7593d62642d4751591/gcc%2Fada%2Fmakeusg.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fmakeusg.adb?ref=439b6dfab1115446fb8f5d7593d62642d4751591", "patch": "@@ -26,6 +26,7 @@\n with Makeutl;\n with Osint;   use Osint;\n with Output;  use Output;\n+with Switch;  use Switch;\n with Usage;\n \n procedure Makeusg is\n@@ -51,6 +52,8 @@ begin\n    Write_Str (\"gnatmake switches:\");\n    Write_Eol;\n \n+   Display_Usage_Version_And_Help;\n+\n    --  Line for -a\n \n    Write_Str (\"  -a       Consider all files, even readonly ali files\");"}, {"sha": "f871b19fa1a001e0c9afebb9adb701efc6786ba0", "filename": "gcc/ada/switch.adb", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/439b6dfab1115446fb8f5d7593d62642d4751591/gcc%2Fada%2Fswitch.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/439b6dfab1115446fb8f5d7593d62642d4751591/gcc%2Fada%2Fswitch.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fswitch.adb?ref=439b6dfab1115446fb8f5d7593d62642d4751591", "patch": "@@ -98,6 +98,20 @@ package body Switch is\n       end if;\n    end Check_Version_And_Help_G;\n \n+   ------------------------------------\n+   -- Display_Usage_Version_And_Help --\n+   ------------------------------------\n+\n+   procedure Display_Usage_Version_And_Help is\n+   begin\n+      Write_Str (\"  --version   Display version and exit\");\n+      Write_Eol;\n+\n+      Write_Str (\"  --help      Display usage and exit\");\n+      Write_Eol;\n+      Write_Eol;\n+   end Display_Usage_Version_And_Help;\n+\n    ---------------------\n    -- Display_Version --\n    ---------------------"}, {"sha": "b55e2fcf0de35882407ee59ec0210bb93d348d82", "filename": "gcc/ada/switch.ads", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/439b6dfab1115446fb8f5d7593d62642d4751591/gcc%2Fada%2Fswitch.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/439b6dfab1115446fb8f5d7593d62642d4751591/gcc%2Fada%2Fswitch.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fswitch.ads?ref=439b6dfab1115446fb8f5d7593d62642d4751591", "patch": "@@ -64,6 +64,9 @@ package Switch is\n       Version_String : String := Gnatvsn.Gnat_Version_String);\n    --  Display version of a tool when switch --version is used\n \n+   procedure Display_Usage_Version_And_Help;\n+   --  Output the two lines of usage for switches --version and --help\n+\n    function Is_Switch (Switch_Chars : String) return Boolean;\n    --  Returns True iff Switch_Chars is at least two characters long, and the\n    --  first character is an hyphen ('-')."}]}