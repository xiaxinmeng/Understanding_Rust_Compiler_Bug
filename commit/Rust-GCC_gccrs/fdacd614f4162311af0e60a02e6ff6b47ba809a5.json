{"sha": "fdacd614f4162311af0e60a02e6ff6b47ba809a5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZmRhY2Q2MTRmNDE2MjMxMWFmMGU2MGEwMmU2ZmY2YjQ3YmE4MDlhNQ==", "commit": {"author": {"name": "Philippe Gil", "email": "gil@adacore.com", "date": "2019-08-20T09:47:53Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "pmderodat@gcc.gnu.org", "date": "2019-08-20T09:47:53Z"}, "message": "[Ada] Initialize gnat_argc/gnat_argv only the first time\n\n2019-08-20  Philippe Gil  <gil@adacore.com>\n\ngcc/ada/\n\n\t* bindgen.adb (Gen_Main): Set gnat_argc/gnat_argv to argc/argv\n\tonly when still uninitialized.\n\nFrom-SVN: r274716", "tree": {"sha": "1e4cf5d3f2c86c45dfa0bf9404ab7255c793747e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1e4cf5d3f2c86c45dfa0bf9404ab7255c793747e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/fdacd614f4162311af0e60a02e6ff6b47ba809a5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fdacd614f4162311af0e60a02e6ff6b47ba809a5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fdacd614f4162311af0e60a02e6ff6b47ba809a5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fdacd614f4162311af0e60a02e6ff6b47ba809a5/comments", "author": null, "committer": null, "parents": [{"sha": "e1976249a2f4ddf0d98952c2394db9b1e2c634a6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e1976249a2f4ddf0d98952c2394db9b1e2c634a6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e1976249a2f4ddf0d98952c2394db9b1e2c634a6"}], "stats": {"total": 20, "additions": 16, "deletions": 4}, "files": [{"sha": "8485a9c0d09503e8b0742fa27fe5fd1021e32b50", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fdacd614f4162311af0e60a02e6ff6b47ba809a5/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fdacd614f4162311af0e60a02e6ff6b47ba809a5/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=fdacd614f4162311af0e60a02e6ff6b47ba809a5", "patch": "@@ -1,3 +1,8 @@\n+2019-08-20  Philippe Gil  <gil@adacore.com>\n+\n+\t* bindgen.adb (Gen_Main): Set gnat_argc/gnat_argv to argc/argv\n+\tonly when still uninitialized.\n+\n 2019-08-20  Bob Duff  <duff@adacore.com>\n \n \t* libgnat/g-comlin.ads (Exit_From_Command_Line): Fix"}, {"sha": "153043c8678f1d0c6c6f9e1f2c60d81ebe9b5786", "filename": "gcc/ada/bindgen.adb", "status": "modified", "additions": 11, "deletions": 4, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fdacd614f4162311af0e60a02e6ff6b47ba809a5/gcc%2Fada%2Fbindgen.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fdacd614f4162311af0e60a02e6ff6b47ba809a5/gcc%2Fada%2Fbindgen.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fbindgen.adb?ref=fdacd614f4162311af0e60a02e6ff6b47ba809a5", "patch": "@@ -1826,18 +1826,25 @@ package body Bindgen is\n \n       WBI (\"   begin\");\n \n-      --  Acquire command line arguments if present on target\n+      --  Acquire command-line arguments if present on target\n \n       if CodePeer_Mode then\n          null;\n \n       elsif Command_Line_Args_On_Target then\n-         WBI (\"      gnat_argc := argc;\");\n-         WBI (\"      gnat_argv := argv;\");\n+\n+         --  Initialize gnat_argc/gnat_argv only if not already initialized,\n+         --  to avoid losing the result of any command-line processing done by\n+         --  earlier GNAT run-time initialization.\n+\n+         WBI (\"      if gnat_argc = 0 then\");\n+         WBI (\"         gnat_argc := argc;\");\n+         WBI (\"         gnat_argv := argv;\");\n+         WBI (\"      end if;\");\n          WBI (\"      gnat_envp := envp;\");\n          WBI (\"\");\n \n-      --  If configurable run time and no command line args, then nothing needs\n+      --  If configurable run-time and no command-line args, then nothing needs\n       --  to be done since the gnat_argc/argv/envp variables are suppressed in\n       --  this case.\n "}]}