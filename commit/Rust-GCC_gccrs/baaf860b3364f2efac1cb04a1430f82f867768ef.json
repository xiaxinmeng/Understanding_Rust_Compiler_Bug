{"sha": "baaf860b3364f2efac1cb04a1430f82f867768ef", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmFhZjg2MGIzMzY0ZjJlZmFjMWNiMDRhMTQzMGY4MmY4Njc3NjhlZg==", "commit": {"author": {"name": "Jan Hubicka", "email": "hubicka@ucw.cz", "date": "2019-02-12T11:25:11Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2019-02-12T11:25:11Z"}, "message": "re PR target/88777 (Out-of-range offsets building glibc test-tgmath2.c for hppa-linux-gnu)\n\n\n\tPR lto/88777\n\t* cgraphunit.c (analyze_functions): Clear READONLY flag for external\n\ttypes that needs constructiong.\n\t* tree.h (may_be_aliased): Do not check TYPE_NEEDS_CONSTRUCTING.\n\nFrom-SVN: r268791", "tree": {"sha": "e9b26a340267828b74f5c5a01d908071d9eca10d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e9b26a340267828b74f5c5a01d908071d9eca10d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/baaf860b3364f2efac1cb04a1430f82f867768ef", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/baaf860b3364f2efac1cb04a1430f82f867768ef", "html_url": "https://github.com/Rust-GCC/gccrs/commit/baaf860b3364f2efac1cb04a1430f82f867768ef", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/baaf860b3364f2efac1cb04a1430f82f867768ef/comments", "author": null, "committer": null, "parents": [{"sha": "0dcbc6dd8e6bc57a27d5b1cdbd8447a2f5a618b2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0dcbc6dd8e6bc57a27d5b1cdbd8447a2f5a618b2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0dcbc6dd8e6bc57a27d5b1cdbd8447a2f5a618b2"}], "stats": {"total": 19, "additions": 17, "deletions": 2}, "files": [{"sha": "c430e9d5ecd620a6ddc1207b1cc58845190d8ae4", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/baaf860b3364f2efac1cb04a1430f82f867768ef/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/baaf860b3364f2efac1cb04a1430f82f867768ef/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=baaf860b3364f2efac1cb04a1430f82f867768ef", "patch": "@@ -1,3 +1,10 @@\n+2019-02-12  Jan Hubicka  <hubicka@ucw.cz>\n+\n+\tPR lto/88777\n+\t* cgraphunit.c (analyze_functions): Clear READONLY flag for external\n+\ttypes that needs constructiong.\n+\t* tree.h (may_be_aliased): Do not check TYPE_NEEDS_CONSTRUCTING.\n+\n 2019-02-12  Richard Biener  <rguenther@suse.de>\n \n \tPR tree-optimization/89253"}, {"sha": "162e0049b6bf35bd8dfdbaa457d07781fc0a338c", "filename": "gcc/cgraphunit.c", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/baaf860b3364f2efac1cb04a1430f82f867768ef/gcc%2Fcgraphunit.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/baaf860b3364f2efac1cb04a1430f82f867768ef/gcc%2Fcgraphunit.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcgraphunit.c?ref=baaf860b3364f2efac1cb04a1430f82f867768ef", "patch": "@@ -1226,6 +1226,15 @@ analyze_functions (bool first_time)\n        && node != first_handled_var; node = next)\n     {\n       next = node->next;\n+      /* For symbols declared locally we clear TREE_READONLY when emitting\n+\t the construtor (if one is needed).  For external declarations we can\n+\t not safely assume that the type is readonly because we may be called\n+\t during its construction.  */\n+      if (TREE_CODE (node->decl) == VAR_DECL\n+\t  && TYPE_P (TREE_TYPE (node->decl))\n+\t  && TYPE_NEEDS_CONSTRUCTING (TREE_TYPE (node->decl))\n+\t  && DECL_EXTERNAL (node->decl))\n+\tTREE_READONLY (node->decl) = 0;\n       if (!node->aux && !node->referred_to_p ())\n \t{\n \t  if (symtab->dump_file)"}, {"sha": "96d84d961c58a834eaa76ad33b119219fe07fcc6", "filename": "gcc/tree.h", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/baaf860b3364f2efac1cb04a1430f82f867768ef/gcc%2Ftree.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/baaf860b3364f2efac1cb04a1430f82f867768ef/gcc%2Ftree.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree.h?ref=baaf860b3364f2efac1cb04a1430f82f867768ef", "patch": "@@ -5382,8 +5382,7 @@ may_be_aliased (const_tree var)\n \t      || DECL_EXTERNAL (var)\n \t      || TREE_ADDRESSABLE (var))\n \t  && !((TREE_STATIC (var) || TREE_PUBLIC (var) || DECL_EXTERNAL (var))\n-\t       && ((TREE_READONLY (var)\n-\t\t    && !TYPE_NEEDS_CONSTRUCTING (TREE_TYPE (var)))\n+\t       && (TREE_READONLY (var)\n \t\t   || (TREE_CODE (var) == VAR_DECL\n \t\t       && DECL_NONALIASED (var)))));\n }"}]}