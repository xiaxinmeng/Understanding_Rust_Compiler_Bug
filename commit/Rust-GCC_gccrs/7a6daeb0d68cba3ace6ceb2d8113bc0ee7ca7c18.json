{"sha": "7a6daeb0d68cba3ace6ceb2d8113bc0ee7ca7c18", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2E2ZGFlYjBkNjhjYmEzYWNlNmNlYjJkODExM2JjMGVlN2NhN2MxOA==", "commit": {"author": {"name": "Nathan Froyd", "email": "froydnj@codesourcery.com", "date": "2010-12-09T21:50:23Z"}, "committer": {"name": "Nathan Froyd", "email": "froydnj@gcc.gnu.org", "date": "2010-12-09T21:50:23Z"}, "message": "c-typeck.c (build_indirect_ref): Call invalid_indirection_error.\n\ngcc/\n\t* c-typeck.c (build_indirect_ref): Call invalid_indirection_error.\n\ngcc/c-family/\n\t* c-common.h (invalid_indirection_error): Declare.\n\t* c-common.c (invalid_indirection_error): Define.\n\ngcc/cp/\n\t* typeck.c (cp_build_indirect_ref): Call invalid_indirection_error.\n\nFrom-SVN: r167666", "tree": {"sha": "df909e57688b1155ec89d442b57ba0b2026135a9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/df909e57688b1155ec89d442b57ba0b2026135a9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7a6daeb0d68cba3ace6ceb2d8113bc0ee7ca7c18", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7a6daeb0d68cba3ace6ceb2d8113bc0ee7ca7c18", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7a6daeb0d68cba3ace6ceb2d8113bc0ee7ca7c18", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7a6daeb0d68cba3ace6ceb2d8113bc0ee7ca7c18/comments", "author": null, "committer": null, "parents": [{"sha": "083586b88030b716c436119d18547063ed802cc5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/083586b88030b716c436119d18547063ed802cc5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/083586b88030b716c436119d18547063ed802cc5"}], "stats": {"total": 92, "additions": 55, "deletions": 37}, "files": [{"sha": "d9d27245e389ee8240f5ac7292d809a817d23dd7", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7a6daeb0d68cba3ace6ceb2d8113bc0ee7ca7c18/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7a6daeb0d68cba3ace6ceb2d8113bc0ee7ca7c18/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=7a6daeb0d68cba3ace6ceb2d8113bc0ee7ca7c18", "patch": "@@ -1,3 +1,7 @@\n+2010-12-09  Nathan Froyd  <froydnj@codesourcery.com>\n+\n+\t* c-typeck.c (build_indirect_ref): Call invalid_indirection_error.\n+\n 2010-12-09  Joseph Myers  <joseph@codesourcery.com>\n \n \t* doc/extend.texi (Attribute Syntax): Correct description of"}, {"sha": "495816b6a00599065da6b9627329c8aeb5143327", "filename": "gcc/c-family/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7a6daeb0d68cba3ace6ceb2d8113bc0ee7ca7c18/gcc%2Fc-family%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7a6daeb0d68cba3ace6ceb2d8113bc0ee7ca7c18/gcc%2Fc-family%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2FChangeLog?ref=7a6daeb0d68cba3ace6ceb2d8113bc0ee7ca7c18", "patch": "@@ -1,3 +1,8 @@\n+2010-12-09  Nathan Froyd  <froydnj@codesourcery.com>\n+\n+\t* c-common.h (invalid_indirection_error): Declare.\n+\t* c-common.c (invalid_indirection_error): Define.\n+\n 2010-12-03  Richard Guenther  <rguenther@suse.de>\n \n \tPR c/46745"}, {"sha": "8d0fcc388fe762859cdb2f32372668929afb74c9", "filename": "gcc/c-family/c-common.c", "status": "modified", "additions": 37, "deletions": 0, "changes": 37, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7a6daeb0d68cba3ace6ceb2d8113bc0ee7ca7c18/gcc%2Fc-family%2Fc-common.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7a6daeb0d68cba3ace6ceb2d8113bc0ee7ca7c18/gcc%2Fc-family%2Fc-common.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2Fc-common.c?ref=7a6daeb0d68cba3ace6ceb2d8113bc0ee7ca7c18", "patch": "@@ -8585,6 +8585,43 @@ lvalue_error (enum lvalue_use use)\n       gcc_unreachable ();\n     }\n }\n+\n+/* Print an error message for an invalid indirection of type TYPE.\n+   ERRSTRING is the name of the operator for the indirection.  */\n+\n+void\n+invalid_indirection_error (location_t loc, tree type, ref_operator errstring)\n+{\n+  switch (errstring)\n+    {\n+    case RO_NULL:\n+      gcc_assert (c_dialect_cxx ());\n+      error_at (loc, \"invalid type argument (have %qT)\", type);\n+      break;\n+    case RO_ARRAY_INDEXING:\n+      error_at (loc,\n+\t\t\"invalid type argument of array indexing (have %qT)\",\n+\t\ttype);\n+      break;\n+    case RO_UNARY_STAR:\n+      error_at (loc,\n+\t\t\"invalid type argument of unary %<*%> (have %qT)\",\n+\t\ttype);\n+      break;\n+    case RO_ARROW:\n+      error_at (loc,\n+\t\t\"invalid type argument of %<->%> (have %qT)\",\n+\t\ttype);\n+      break;\n+    case RO_IMPLICIT_CONVERSION:\n+      error_at (loc,\n+\t\t\"invalid type argument of implicit conversion (have %qT)\",\n+\t\ttype);\n+      break;\n+    default:\n+      gcc_unreachable ();\n+    }\n+}\n \f\n /* *PTYPE is an incomplete array.  Complete it with a domain based on\n    INITIAL_VALUE.  If INITIAL_VALUE is not present, use 1 if DO_DEFAULT"}, {"sha": "b6f8d398657376ad2bce96eb16d3f29898b08d11", "filename": "gcc/c-family/c-common.h", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7a6daeb0d68cba3ace6ceb2d8113bc0ee7ca7c18/gcc%2Fc-family%2Fc-common.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7a6daeb0d68cba3ace6ceb2d8113bc0ee7ca7c18/gcc%2Fc-family%2Fc-common.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2Fc-common.h?ref=7a6daeb0d68cba3ace6ceb2d8113bc0ee7ca7c18", "patch": "@@ -929,6 +929,7 @@ enum lvalue_use {\n };\n \n extern void lvalue_error (enum lvalue_use);\n+extern void invalid_indirection_error (location_t, tree, ref_operator);\n \n extern int complete_array_type (tree *, tree, bool);\n "}, {"sha": "cbe9f209220a088253a9d58fee0d781fc66bfde9", "filename": "gcc/c-typeck.c", "status": "modified", "additions": 2, "deletions": 20, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7a6daeb0d68cba3ace6ceb2d8113bc0ee7ca7c18/gcc%2Fc-typeck.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7a6daeb0d68cba3ace6ceb2d8113bc0ee7ca7c18/gcc%2Fc-typeck.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-typeck.c?ref=7a6daeb0d68cba3ace6ceb2d8113bc0ee7ca7c18", "patch": "@@ -2267,26 +2267,8 @@ build_indirect_ref (location_t loc, tree ptr, ref_operator errstring)\n \t}\n     }\n   else if (TREE_CODE (pointer) != ERROR_MARK)\n-    switch (errstring)\n-      {\n-         case RO_ARRAY_INDEXING:\n-           error_at (loc,\n-                     \"invalid type argument of array indexing (have %qT)\",\n-                     type);\n-           break;\n-         case RO_UNARY_STAR:\n-           error_at (loc,\n-                     \"invalid type argument of unary %<*%> (have %qT)\",\n-                     type);\n-           break;\n-         case RO_ARROW:\n-           error_at (loc,\n-                     \"invalid type argument of %<->%> (have %qT)\",\n-                     type);\n-           break;\n-         default:\n-           gcc_unreachable ();\n-      }\n+    invalid_indirection_error (loc, type, errstring);\n+\n   return error_mark_node;\n }\n "}, {"sha": "ae7d057a11b9fef075cc32a3259e6af19b806e02", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7a6daeb0d68cba3ace6ceb2d8113bc0ee7ca7c18/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7a6daeb0d68cba3ace6ceb2d8113bc0ee7ca7c18/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=7a6daeb0d68cba3ace6ceb2d8113bc0ee7ca7c18", "patch": "@@ -1,3 +1,7 @@\n+2010-12-09  Nathan Froyd  <froydnj@codesourcery.com>\n+\n+\t* typeck.c (cp_build_indirect_ref): Call invalid_indirection_error.\n+\n 2010-12-09  Nathan Froyd  <froydnj@codesourcery.com>\n \n \t* typeck.c (composite_pointer_error): New function."}, {"sha": "f055bbce2b1e5adb266ae1f3da3927ad89d952f7", "filename": "gcc/cp/typeck.c", "status": "modified", "additions": 2, "deletions": 17, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7a6daeb0d68cba3ace6ceb2d8113bc0ee7ca7c18/gcc%2Fcp%2Ftypeck.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7a6daeb0d68cba3ace6ceb2d8113bc0ee7ca7c18/gcc%2Fcp%2Ftypeck.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ftypeck.c?ref=7a6daeb0d68cba3ace6ceb2d8113bc0ee7ca7c18", "patch": "@@ -2776,23 +2776,8 @@ cp_build_indirect_ref (tree ptr, ref_operator errorstring,\n            gcc_unreachable ();\n       }\n   else if (pointer != error_mark_node)\n-    switch (errorstring)\n-      {\n-         case RO_NULL:\n-           error (\"invalid type argument\");\n-           break;\n-         case RO_ARRAY_INDEXING:\n-           error (\"invalid type argument of array indexing\");\n-           break;\n-         case RO_UNARY_STAR:\n-           error (\"invalid type argument of unary %<*%>\");\n-           break;\n-         case RO_IMPLICIT_CONVERSION:\n-           error (\"invalid type argument of implicit conversion\");\n-           break;\n-         default:\n-           gcc_unreachable ();\n-      }\n+    invalid_indirection_error (input_location, type, errorstring);\n+\n   return error_mark_node;\n }\n "}]}