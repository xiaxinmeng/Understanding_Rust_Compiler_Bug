{"sha": "b9121f42a1086a219ab6312b76e920639a0de260", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjkxMjFmNDJhMTA4NmEyMTlhYjYzMTJiNzZlOTIwNjM5YTBkZTI2MA==", "commit": {"author": {"name": "H.J. Lu", "email": "hongjiu.lu@intel.com", "date": "2010-10-20T11:21:19Z"}, "committer": {"name": "H.J. Lu", "email": "hjl@gcc.gnu.org", "date": "2010-10-20T11:21:19Z"}, "message": "Correct reduc_splus_v8sf and reduc_splus_v4df.\n\ngcc/\n\n2010-10-20  H.J. Lu  <hongjiu.lu@intel.com>\n\n\tPR target/46085\n\t* config/i386/sse.md (reduc_splus_v8sf): Updated.\n\t(reduc_splus_v4df): Likewise.\n\ngcc/testsuite/\n\n2010-10-20  H.J. Lu  <hongjiu.lu@intel.com>\n\n\tPR target/46085\n\t* gcc.target/i386/pr46085-1.c: New.\n\t* gcc.target/i386/pr46085-2.c: Likewise.\n\nFrom-SVN: r165719", "tree": {"sha": "c60b901039bd33fa1ae88c7bec5ea5466cb3f2e0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c60b901039bd33fa1ae88c7bec5ea5466cb3f2e0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b9121f42a1086a219ab6312b76e920639a0de260", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b9121f42a1086a219ab6312b76e920639a0de260", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b9121f42a1086a219ab6312b76e920639a0de260", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b9121f42a1086a219ab6312b76e920639a0de260/comments", "author": {"login": "hjl-tools", "id": 1072356, "node_id": "MDQ6VXNlcjEwNzIzNTY=", "avatar_url": "https://avatars.githubusercontent.com/u/1072356?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hjl-tools", "html_url": "https://github.com/hjl-tools", "followers_url": "https://api.github.com/users/hjl-tools/followers", "following_url": "https://api.github.com/users/hjl-tools/following{/other_user}", "gists_url": "https://api.github.com/users/hjl-tools/gists{/gist_id}", "starred_url": "https://api.github.com/users/hjl-tools/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hjl-tools/subscriptions", "organizations_url": "https://api.github.com/users/hjl-tools/orgs", "repos_url": "https://api.github.com/users/hjl-tools/repos", "events_url": "https://api.github.com/users/hjl-tools/events{/privacy}", "received_events_url": "https://api.github.com/users/hjl-tools/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "742d143c1be9352d388e37bb24ff82c81aca8340", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/742d143c1be9352d388e37bb24ff82c81aca8340", "html_url": "https://github.com/Rust-GCC/gccrs/commit/742d143c1be9352d388e37bb24ff82c81aca8340"}], "stats": {"total": 115, "additions": 112, "deletions": 3}, "files": [{"sha": "686b5912802fb8dc2af2be0530a047bda3362f4f", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b9121f42a1086a219ab6312b76e920639a0de260/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b9121f42a1086a219ab6312b76e920639a0de260/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=b9121f42a1086a219ab6312b76e920639a0de260", "patch": "@@ -1,3 +1,9 @@\n+2010-10-20  H.J. Lu  <hongjiu.lu@intel.com>\n+\n+\tPR target/46085\n+\t* config/i386/sse.md (reduc_splus_v8sf): Updated.\n+\t(reduc_splus_v4df): Likewise.\n+\n 2010-10-20  Richard Guenther  <rguenther@suse.de>\n \n \tPR tree-optimization/45860"}, {"sha": "bff74d57de38efa1a5ad1f373011271b66789ec1", "filename": "gcc/config/i386/sse.md", "status": "modified", "additions": 6, "deletions": 3, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b9121f42a1086a219ab6312b76e920639a0de260/gcc%2Fconfig%2Fi386%2Fsse.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b9121f42a1086a219ab6312b76e920639a0de260/gcc%2Fconfig%2Fi386%2Fsse.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fsse.md?ref=b9121f42a1086a219ab6312b76e920639a0de260", "patch": "@@ -1388,8 +1388,9 @@\n   rtx tmp = gen_reg_rtx (V8SFmode);\n   rtx tmp2 = gen_reg_rtx (V8SFmode);\n   emit_insn (gen_avx_haddv8sf3 (tmp, operands[1], operands[1]));\n-  emit_insn (gen_avx_haddv8sf3 (tmp2, operands[1], operands[1]));\n-  emit_insn (gen_avx_haddv8sf3 (operands[0], tmp2, tmp2));\n+  emit_insn (gen_avx_haddv8sf3 (tmp2, tmp, tmp));\n+  emit_insn (gen_avx_vperm2f128v8sf3 (tmp, tmp2, tmp2, GEN_INT (1)));\n+  emit_insn (gen_addv8sf3 (operands[0], tmp, tmp2));\n   DONE;\n })\n \n@@ -1415,8 +1416,10 @@\n   \"TARGET_AVX\"\n {\n   rtx tmp = gen_reg_rtx (V4DFmode);\n+  rtx tmp2 = gen_reg_rtx (V4DFmode);\n   emit_insn (gen_avx_haddv4df3 (tmp, operands[1], operands[1]));\n-  emit_insn (gen_avx_haddv4df3 (operands[0], tmp, tmp));\n+  emit_insn (gen_avx_vperm2f128v4df3 (tmp2, tmp, tmp, GEN_INT (1)));\n+  emit_insn (gen_addv4df3 (operands[0], tmp, tmp2));\n   DONE;\n })\n "}, {"sha": "fe74a3faa1006fd9b22bb58064fe064035b4ae98", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b9121f42a1086a219ab6312b76e920639a0de260/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b9121f42a1086a219ab6312b76e920639a0de260/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=b9121f42a1086a219ab6312b76e920639a0de260", "patch": "@@ -1,3 +1,9 @@\n+2010-10-20  H.J. Lu  <hongjiu.lu@intel.com>\n+\n+\tPR target/46085\n+\t* gcc.target/i386/pr46085-1.c: New.\n+\t* gcc.target/i386/pr46085-2.c: Likewise.\n+\n 2010-10-20  Richard Guenther  <rguenther@suse.de>\n \n \tPR tree-optimization/45860"}, {"sha": "0251556c568d90aca658fd7853cb76011617fec1", "filename": "gcc/testsuite/gcc.target/i386/pr46085-1.c", "status": "added", "additions": 47, "deletions": 0, "changes": 47, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b9121f42a1086a219ab6312b76e920639a0de260/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr46085-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b9121f42a1086a219ab6312b76e920639a0de260/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr46085-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr46085-1.c?ref=b9121f42a1086a219ab6312b76e920639a0de260", "patch": "@@ -0,0 +1,47 @@\n+/* { dg-do run } */\n+/* { dg-require-effective-target avx } */\n+/* { dg-options \"-O2 -ftree-vectorize -mavx -mtune=generic -ffast-math\" } */\n+\n+#include \"avx-check.h\"\n+\n+#define N 16\n+#define DIFF 242\n+\n+float b[N] = {0,3,6,9,12,15,18,21,24,27,30,33,36,39,42,45};\n+float c[N] = {0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15};\n+\n+void\n+main1 (float x, float max_result)\n+{\n+  int i;\n+  float diff = 2;\n+  float max = x;\n+  float min = 10;\n+\n+  for (i = 0; i < N; i++) {\n+    diff += (b[i] - c[i]);\n+  }\n+\n+  for (i = 0; i < N; i++) {\n+    max = max < c[i] ? c[i] : max;\n+  }\n+\n+  for (i = 0; i < N; i++) {\n+    min = min > c[i] ? c[i] : min;\n+  }\n+\n+  /* check results:  */\n+  if (diff != DIFF)\n+    abort ();\n+  if (max != max_result)\n+    abort ();\n+  if (min != 0)\n+    abort ();\n+}\n+\n+static void\n+avx_test (void)\n+{ \n+  main1 (100, 100);\n+  main1 (0, 15);\n+}"}, {"sha": "568cdd96f46e9a2dd74240fe1045488702e1a8a0", "filename": "gcc/testsuite/gcc.target/i386/pr46085-2.c", "status": "added", "additions": 47, "deletions": 0, "changes": 47, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b9121f42a1086a219ab6312b76e920639a0de260/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr46085-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b9121f42a1086a219ab6312b76e920639a0de260/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr46085-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr46085-2.c?ref=b9121f42a1086a219ab6312b76e920639a0de260", "patch": "@@ -0,0 +1,47 @@\n+/* { dg-do run } */\n+/* { dg-require-effective-target avx } */\n+/* { dg-options \"-O2 -ftree-vectorize -mavx -mtune=generic -ffast-math\" } */\n+\n+#include \"avx-check.h\"\n+\n+#define N 16\n+#define DIFF 242\n+\n+double b[N] = {0,3,6,9,12,15,18,21,24,27,30,33,36,39,42,45};\n+double c[N] = {0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15};\n+\n+void\n+main1 (double x, double max_result)\n+{\n+  int i;\n+  double diff = 2;\n+  double max = x;\n+  double min = 10;\n+\n+  for (i = 0; i < N; i++) {\n+    diff += (b[i] - c[i]);\n+  }\n+\n+  for (i = 0; i < N; i++) {\n+    max = max < c[i] ? c[i] : max;\n+  }\n+\n+  for (i = 0; i < N; i++) {\n+    min = min > c[i] ? c[i] : min;\n+  }\n+\n+  /* check results:  */\n+  if (diff != DIFF)\n+    abort ();\n+  if (max != max_result)\n+    abort ();\n+  if (min != 0)\n+    abort ();\n+}\n+\n+static void\n+avx_test (void)\n+{ \n+  main1 (100, 100);\n+  main1 (0, 15);\n+}"}]}