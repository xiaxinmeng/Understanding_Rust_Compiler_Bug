{"sha": "f0dbeec7c506407aa7e02cc2df82057ea40ab457", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjBkYmVlYzdjNTA2NDA3YWE3ZTAyY2MyZGY4MjA1N2VhNDBhYjQ1Nw==", "commit": {"author": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2018-11-28T20:29:24Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2018-11-28T20:29:24Z"}, "message": "profile-count.h (profile_count::split): Give better result when splitting profile_probability::always.\n\n\n\t* profile-count.h (profile_count::split): Give better result when\n\tsplitting profile_probability::always.\n\nFrom-SVN: r266584", "tree": {"sha": "6bd0c62d4400b9b5e93c8f76b7bfbcaac3a7b2fb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6bd0c62d4400b9b5e93c8f76b7bfbcaac3a7b2fb"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f0dbeec7c506407aa7e02cc2df82057ea40ab457", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f0dbeec7c506407aa7e02cc2df82057ea40ab457", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f0dbeec7c506407aa7e02cc2df82057ea40ab457", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f0dbeec7c506407aa7e02cc2df82057ea40ab457/comments", "author": null, "committer": null, "parents": [{"sha": "c3cc0122ca3f2a1d039dd24e1590362302de30b6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c3cc0122ca3f2a1d039dd24e1590362302de30b6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c3cc0122ca3f2a1d039dd24e1590362302de30b6"}], "stats": {"total": 13, "additions": 11, "deletions": 2}, "files": [{"sha": "3c1f926e239fc9532df83c72868afe3c74430cbb", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f0dbeec7c506407aa7e02cc2df82057ea40ab457/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f0dbeec7c506407aa7e02cc2df82057ea40ab457/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=f0dbeec7c506407aa7e02cc2df82057ea40ab457", "patch": "@@ -1,3 +1,8 @@\n+2018-11-28  Jan Hubicka  <jh@suse.cz>\n+\n+\t* profile-count.h (profile_count::split): Give better result when\n+\tsplitting profile_probability::always.\n+\n 2018-11-28  Vladimir Makarov  <vmakarov@redhat.com>\n \n \tPR target/88207"}, {"sha": "620d6b7145790ee311dd90d0e0c97c8da92f4175", "filename": "gcc/profile-count.h", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f0dbeec7c506407aa7e02cc2df82057ea40ab457/gcc%2Fprofile-count.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f0dbeec7c506407aa7e02cc2df82057ea40ab457/gcc%2Fprofile-count.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fprofile-count.h?ref=f0dbeec7c506407aa7e02cc2df82057ea40ab457", "patch": "@@ -447,8 +447,12 @@ class GTY((user)) profile_probability\n     {\n       profile_probability ret = *this * cprob;\n       /* The following is equivalent to:\n-         *this = cprob.invert () * *this / ret.invert ();  */\n-      *this = (*this - ret) / ret.invert ();\n+         *this = cprob.invert () * *this / ret.invert ();\n+\t Avoid scaling when overall outcome is supposed to be always.\n+\t Without knowing that one is inverse of toher, the result would be\n+\t conservative.  */\n+      if (!(*this == profile_probability::always ()))\n+        *this = (*this - ret) / ret.invert ();\n       return ret;\n     }\n "}]}