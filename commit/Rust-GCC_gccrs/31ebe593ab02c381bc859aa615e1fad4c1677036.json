{"sha": "31ebe593ab02c381bc859aa615e1fad4c1677036", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzFlYmU1OTNhYjAyYzM4MWJjODU5YWE2MTVlMWZhZDRjMTY3NzAzNg==", "commit": {"author": {"name": "H.J. Lu", "email": "hongjiu.lu@intel.com", "date": "2008-05-22T05:28:19Z"}, "committer": {"name": "H.J. Lu", "email": "hjl@gcc.gnu.org", "date": "2008-05-22T05:28:19Z"}, "message": "i386.c (ix86_expand_vector_init_one_var): Use ix86_expand_vector_set on V16QImode for SSE4.1.\n\ngcc/\n\n2008-05-21  H.J. Lu  <hongjiu.lu@intel.com>\n\n\t* config/i386/i386.c (ix86_expand_vector_init_one_var): Use\n\tix86_expand_vector_set on V16QImode for SSE4.1.\n\ngcc/testsuite/\n\n2008-05-21  H.J. Lu  <hongjiu.lu@intel.com>\n\n\t* gcc.target/i386/m128-check.h (ARRAY_SIZE): New.\n\t(CHECK_EXP): Use it.\n\n\t* gcc.target/i386/set-v16qi-3.h: New.\n\t* gcc.target/i386/sse2-set-v16qi-3.c: Likewise.\n\t* gcc.target/i386/sse4_1-set-v16qi-3.c: Likewise.\n\nFrom-SVN: r135750", "tree": {"sha": "b3fcfb48e0a47d9d9f8b5d0869027f4d50e0728a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b3fcfb48e0a47d9d9f8b5d0869027f4d50e0728a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/31ebe593ab02c381bc859aa615e1fad4c1677036", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/31ebe593ab02c381bc859aa615e1fad4c1677036", "html_url": "https://github.com/Rust-GCC/gccrs/commit/31ebe593ab02c381bc859aa615e1fad4c1677036", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/31ebe593ab02c381bc859aa615e1fad4c1677036/comments", "author": {"login": "hjl-tools", "id": 1072356, "node_id": "MDQ6VXNlcjEwNzIzNTY=", "avatar_url": "https://avatars.githubusercontent.com/u/1072356?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hjl-tools", "html_url": "https://github.com/hjl-tools", "followers_url": "https://api.github.com/users/hjl-tools/followers", "following_url": "https://api.github.com/users/hjl-tools/following{/other_user}", "gists_url": "https://api.github.com/users/hjl-tools/gists{/gist_id}", "starred_url": "https://api.github.com/users/hjl-tools/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hjl-tools/subscriptions", "organizations_url": "https://api.github.com/users/hjl-tools/orgs", "repos_url": "https://api.github.com/users/hjl-tools/repos", "events_url": "https://api.github.com/users/hjl-tools/events{/privacy}", "received_events_url": "https://api.github.com/users/hjl-tools/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "c24d4112dd6b4f19cdc43fc99aa0fefe03efa13f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c24d4112dd6b4f19cdc43fc99aa0fefe03efa13f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c24d4112dd6b4f19cdc43fc99aa0fefe03efa13f"}], "stats": {"total": 100, "additions": 99, "deletions": 1}, "files": [{"sha": "9c02b23b4e3424931f2b016f336b055836431b32", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/31ebe593ab02c381bc859aa615e1fad4c1677036/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/31ebe593ab02c381bc859aa615e1fad4c1677036/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=31ebe593ab02c381bc859aa615e1fad4c1677036", "patch": "@@ -1,3 +1,8 @@\n+2008-05-21  H.J. Lu  <hongjiu.lu@intel.com>\n+\n+\t* config/i386/i386.c (ix86_expand_vector_init_one_var): Use\n+\tix86_expand_vector_set on V16QImode for SSE4.1.\n+\n 2008-05-21  Tom Tromey  <tromey@redhat.com>\n \n \t* c.opt (Wimport): Mark as undocumented."}, {"sha": "6f9aaf9332068e94bffdc4567472b83f732adce9", "filename": "gcc/config/i386/i386.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/31ebe593ab02c381bc859aa615e1fad4c1677036/gcc%2Fconfig%2Fi386%2Fi386.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/31ebe593ab02c381bc859aa615e1fad4c1677036/gcc%2Fconfig%2Fi386%2Fi386.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386.c?ref=31ebe593ab02c381bc859aa615e1fad4c1677036", "patch": "@@ -23818,6 +23818,8 @@ ix86_expand_vector_init_one_var (bool mmx_ok, enum machine_mode mode,\n       break;\n \n     case V16QImode:\n+      if (TARGET_SSE4_1)\n+\tbreak;\n       wmode = V8HImode;\n       goto widen;\n     case V8QImode:"}, {"sha": "e9a2c55e937528d66599e95cdb2d9c84cd1dc2f5", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/31ebe593ab02c381bc859aa615e1fad4c1677036/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/31ebe593ab02c381bc859aa615e1fad4c1677036/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=31ebe593ab02c381bc859aa615e1fad4c1677036", "patch": "@@ -1,3 +1,12 @@\n+2008-05-21  H.J. Lu  <hongjiu.lu@intel.com>\n+\n+\t* gcc.target/i386/m128-check.h (ARRAY_SIZE): New.\n+\t(CHECK_EXP): Use it.\n+\n+\t* gcc.target/i386/set-v16qi-3.h: New.\n+\t* gcc.target/i386/sse2-set-v16qi-3.c: Likewise.\n+\t* gcc.target/i386/sse4_1-set-v16qi-3.c: Likewise.\n+\n 2008-05-21  Sebastian Pop  <sebastian.pop@amd.com>\n \n \tPR tree-optimization/36287"}, {"sha": "a20f8215082ff19ba125dc120fcbf3b1ba7fa116", "filename": "gcc/testsuite/gcc.target/i386/m128-check.h", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/31ebe593ab02c381bc859aa615e1fad4c1677036/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fm128-check.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/31ebe593ab02c381bc859aa615e1fad4c1677036/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fm128-check.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fm128-check.h?ref=31ebe593ab02c381bc859aa615e1fad4c1677036", "patch": "@@ -37,6 +37,10 @@ typedef union\n   double a[2];\n } union128d;\n \n+#ifndef ARRAY_SIZE\n+#define ARRAY_SIZE(A) (sizeof (A) / sizeof ((A)[0]))\n+#endif\n+\n #ifdef DEBUG\n #define PRINTF printf\n #else\n@@ -51,7 +55,7 @@ check_##UINON_TYPE (UINON_TYPE u, const VALUE_TYPE *v)\t\\\n   int i;\t\t\t\t\t\t\\\n   int err = 0;\t\t\t\t\t\t\\\n \t\t\t\t\t\t\t\\\n-  for (i = 0; i < sizeof (u.a) / sizeof (u.a[0]); i++)\t\\\n+  for (i = 0; i < ARRAY_SIZE (u.a); i++)\t\t\\\n     if (u.a[i] != v[i])\t\t\t\t\t\\\n       {\t\t\t\t\t\t\t\\\n \terr++;\t\t\t\t\t\t\\"}, {"sha": "faf3cd3442541162e38b9dca6f58418f37abb91f", "filename": "gcc/testsuite/gcc.target/i386/set-v16qi-3.h", "status": "added", "additions": 63, "deletions": 0, "changes": 63, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/31ebe593ab02c381bc859aa615e1fad4c1677036/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fset-v16qi-3.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/31ebe593ab02c381bc859aa615e1fad4c1677036/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fset-v16qi-3.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fset-v16qi-3.h?ref=31ebe593ab02c381bc859aa615e1fad4c1677036", "patch": "@@ -0,0 +1,63 @@\n+#include CHECK_H\n+\n+static __m128i\n+__attribute__((noinline))\n+foo (char x, int i)\n+{\n+  switch (i)\n+    {\n+    case 15:\n+      return _mm_set_epi8 (x, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1);\n+    case 14:\n+      return _mm_set_epi8 (1, x, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1);\n+    case 13:\n+      return _mm_set_epi8 (1, 1, x, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1);\n+    case 12:\n+      return _mm_set_epi8 (1, 1, 1, x, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1);\n+    case 11:\n+      return _mm_set_epi8 (1, 1, 1, 1, x, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1);\n+    case 10:\n+      return _mm_set_epi8 (1, 1, 1, 1, 1, x, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1);\n+    case 9:\n+      return _mm_set_epi8 (1, 1, 1, 1, 1, 1, x, 1, 1, 1, 1, 1, 1, 1, 1, 1);\n+    case 8:\n+      return _mm_set_epi8 (1, 1, 1, 1, 1, 1, 1, x, 1, 1, 1, 1, 1, 1, 1, 1);\n+    case 7:\n+      return _mm_set_epi8 (1, 1, 1, 1, 1, 1, 1, 1, x, 1, 1, 1, 1, 1, 1, 1);\n+    case 6:\n+      return _mm_set_epi8 (1, 1, 1, 1, 1, 1, 1, 1, 1, x, 1, 1, 1, 1, 1, 1);\n+    case 5:\n+      return _mm_set_epi8 (1, 1, 1, 1, 1, 1, 1, 1, 1, 1, x, 1, 1, 1, 1, 1);\n+    case 4:\n+      return _mm_set_epi8 (1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, x, 1, 1, 1, 1);\n+    case 3:\n+      return _mm_set_epi8 (1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, x, 1, 1, 1);\n+    case 2:\n+      return _mm_set_epi8 (1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, x, 1, 1);\n+    case 1:\n+      return _mm_set_epi8 (1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, x, 1);\n+    case 0:\n+      return _mm_set_epi8 (1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, x);\n+    default:\n+      abort ();\n+    }\n+}\n+\n+static void\n+TEST (void)\n+{\n+  char e = 0x13;\n+  char v[16];\n+  union128i_b u;\n+  int i, j;\n+\n+  for (i = 0; i < ARRAY_SIZE (v); i++)\n+    {\n+      for (j = 0; j < ARRAY_SIZE (v); j++)\n+\tv[j] = 1;\n+      v[i] = e;\n+      u.x = foo (e, i);\n+      if (check_union128i_b (u, v))\n+\tabort ();\n+    }\n+}"}, {"sha": "2c0227dd775e8d9491192a6cc86adde3a7862c1a", "filename": "gcc/testsuite/gcc.target/i386/sse2-set-v16qi-3.c", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/31ebe593ab02c381bc859aa615e1fad4c1677036/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fsse2-set-v16qi-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/31ebe593ab02c381bc859aa615e1fad4c1677036/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fsse2-set-v16qi-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fsse2-set-v16qi-3.c?ref=31ebe593ab02c381bc859aa615e1fad4c1677036", "patch": "@@ -0,0 +1,7 @@\n+/* { dg-do run } */\n+/* { dg-options \"-O2 -msse2\" } */\n+\n+#define CHECK_H \"sse2-check.h\"\n+#define TEST sse2_test\n+\n+#include \"set-v16qi-3.h\""}, {"sha": "99f563ab198791c84b568fc01a40a724b85f76e1", "filename": "gcc/testsuite/gcc.target/i386/sse4_1-set-v16qi-3.c", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/31ebe593ab02c381bc859aa615e1fad4c1677036/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fsse4_1-set-v16qi-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/31ebe593ab02c381bc859aa615e1fad4c1677036/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fsse4_1-set-v16qi-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fsse4_1-set-v16qi-3.c?ref=31ebe593ab02c381bc859aa615e1fad4c1677036", "patch": "@@ -0,0 +1,8 @@\n+/* { dg-do run } */\n+/* { dg-require-effective-target sse4 } */\n+/* { dg-options \"-O2 -msse4.1\" } */\n+\n+#define CHECK_H \"sse4_1-check.h\"\n+#define TEST sse4_1_test\n+\n+#include \"set-v16qi-3.h\""}]}