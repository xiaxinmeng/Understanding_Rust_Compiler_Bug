{"sha": "e12bcbf492904c2ead0b91a00e9eff35b2d67c94", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTEyYmNiZjQ5MjkwNGMyZWFkMGI5MWEwMGU5ZWZmMzViMmQ2N2M5NA==", "commit": {"author": {"name": "Richard Henderson", "email": "rth@redhat.com", "date": "2010-11-29T16:43:24Z"}, "committer": {"name": "Rainer Orth", "email": "ro@gcc.gnu.org", "date": "2010-11-29T16:43:24Z"}, "message": "sysv.S (FDE_ENCODING, FDE_ENCODE): Define.\n\n2010-11-29  Richard Henderson  <rth@redhat.com>\n\t    Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>\n\n\t* src/x86/sysv.S (FDE_ENCODING, FDE_ENCODE): Define.\n\t(.eh_frame): Use FDE_ENCODING.\n\t(.LASFDE1, .LASFDE2, LASFDE3): Simplify with FDE_ENCODE.\n\nCo-Authored-By: Rainer Orth <ro@CeBiTec.Uni-Bielefeld.DE>\n\nFrom-SVN: r167251", "tree": {"sha": "1b8661166057754454c74e5ec2a6227a206ce0e9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1b8661166057754454c74e5ec2a6227a206ce0e9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e12bcbf492904c2ead0b91a00e9eff35b2d67c94", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e12bcbf492904c2ead0b91a00e9eff35b2d67c94", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e12bcbf492904c2ead0b91a00e9eff35b2d67c94", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e12bcbf492904c2ead0b91a00e9eff35b2d67c94/comments", "author": null, "committer": null, "parents": [{"sha": "c8718cb3ef78c2e10ac42434330701b1e045a7e2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c8718cb3ef78c2e10ac42434330701b1e045a7e2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c8718cb3ef78c2e10ac42434330701b1e045a7e2"}], "stats": {"total": 58, "additions": 33, "deletions": 25}, "files": [{"sha": "6b78da8b0535890e99fae0b160a314c86f3d0b58", "filename": "libffi/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e12bcbf492904c2ead0b91a00e9eff35b2d67c94/libffi%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e12bcbf492904c2ead0b91a00e9eff35b2d67c94/libffi%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2FChangeLog?ref=e12bcbf492904c2ead0b91a00e9eff35b2d67c94", "patch": "@@ -1,3 +1,10 @@\n+2010-11-29  Richard Henderson  <rth@redhat.com>\n+\t    Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>\n+\n+\t* src/x86/sysv.S (FDE_ENCODING, FDE_ENCODE): Define.\n+\t(.eh_frame): Use FDE_ENCODING.\n+\t(.LASFDE1, .LASFDE2, LASFDE3): Simplify with FDE_ENCODE.\n+\n 2010-11-15  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>\n \n \t* testsuite/lib/libffi-dg.exp: Rename ..."}, {"sha": "f108dd80d71993f8d7e006d62bf557d7fdb34a06", "filename": "libffi/src/x86/sysv.S", "status": "modified", "additions": 26, "deletions": 25, "changes": 51, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e12bcbf492904c2ead0b91a00e9eff35b2d67c94/libffi%2Fsrc%2Fx86%2Fsysv.S", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e12bcbf492904c2ead0b91a00e9eff35b2d67c94/libffi%2Fsrc%2Fx86%2Fsysv.S", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2Fsrc%2Fx86%2Fsysv.S?ref=e12bcbf492904c2ead0b91a00e9eff35b2d67c94", "patch": "@@ -328,6 +328,25 @@ ffi_closure_raw_SYSV:\n \t.size\tffi_closure_raw_SYSV, .-ffi_closure_raw_SYSV\n #endif\n \n+#if defined __PIC__\n+# if defined __sun__ && defined __svr4__\n+/* 32-bit Solaris 2/x86 uses datarel encoding for PIC.  GNU ld before 2.22\n+   doesn't correctly sort .eh_frame_hdr with mixed encodings, so match this.  */\n+#  define FDE_ENCODING\t\t0x30\t/* datarel */\n+#  define FDE_ENCODE(X)\t\tX@GOTOFF\n+# else\n+#  define FDE_ENCODING\t\t0x1b\t/* pcrel sdata4 */\n+#  if defined HAVE_AS_X86_PCREL\n+#   define FDE_ENCODE(X)\tX-.\n+#  else\n+#   define FDE_ENCODE(X)\tX@rel\n+#  endif\n+# endif\n+#else\n+# define FDE_ENCODING\t\t0\t/* absolute */\n+# define FDE_ENCODE(X)\t\tX\n+#endif\n+\n \t.section\t.eh_frame,EH_FRAME_FLAGS,@progbits\n .Lframe1:\n \t.long\t.LECIE1-.LSCIE1\t/* Length of Common Information Entry */\n@@ -354,7 +373,7 @@ ffi_closure_raw_SYSV:\n \t.byte\t0x8\t/* CIE RA Column */\n #ifdef __PIC__\n \t.byte\t0x1\t/* .uleb128 0x1; Augmentation size */\n-\t.byte\t0x1b\t/* FDE Encoding (pcrel sdata4) */\n+\t.byte\tFDE_ENCODING\n #endif\n \t.byte\t0xc\t/* DW_CFA_def_cfa */\n \t.byte\t0x4\t/* .uleb128 0x4 */\n@@ -367,14 +386,8 @@ ffi_closure_raw_SYSV:\n \t.long\t.LEFDE1-.LASFDE1\t/* FDE Length */\n .LASFDE1:\n \t.long\t.LASFDE1-.Lframe1\t/* FDE CIE offset */\n-#if defined __PIC__ && defined HAVE_AS_X86_PCREL\n-\t.long\t.LFB1-.\t/* FDE initial location */\n-#elif defined __PIC__\n-\t.long\t.LFB1@rel\n-#else\n-\t.long\t.LFB1\n-#endif\n-\t.long\t.LFE1-.LFB1\t/* FDE address range */\n+\t.long\tFDE_ENCODE(.LFB1)\t/* FDE initial location */\n+\t.long\t.LFE1-.LFB1\t\t/* FDE address range */\n #ifdef __PIC__\n \t.byte\t0x0\t/* .uleb128 0x0; Augmentation size */\n #endif\n@@ -394,14 +407,8 @@ ffi_closure_raw_SYSV:\n \t.long\t.LEFDE2-.LASFDE2\t/* FDE Length */\n .LASFDE2:\n \t.long\t.LASFDE2-.Lframe1\t/* FDE CIE offset */\n-#if defined __PIC__ && defined HAVE_AS_X86_PCREL\n-\t.long\t.LFB2-.\t/* FDE initial location */\n-#elif defined __PIC__\n-\t.long\t.LFB2@rel\n-#else\n-\t.long\t.LFB2\n-#endif\n-\t.long\t.LFE2-.LFB2\t/* FDE address range */\n+\t.long\tFDE_ENCODE(.LFB2)\t/* FDE initial location */\n+\t.long\t.LFE2-.LFB2\t\t/* FDE address range */\n #ifdef __PIC__\n \t.byte\t0x0\t/* .uleb128 0x0; Augmentation size */\n #endif\n@@ -430,14 +437,8 @@ ffi_closure_raw_SYSV:\n \t.long\t.LEFDE3-.LASFDE3\t/* FDE Length */\n .LASFDE3:\n \t.long\t.LASFDE3-.Lframe1\t/* FDE CIE offset */\n-#if defined __PIC__ && defined HAVE_AS_X86_PCREL\n-\t.long\t.LFB3-.\t/* FDE initial location */\n-#elif defined __PIC__\n-\t.long\t.LFB3@rel\n-#else\n-\t.long\t.LFB3\n-#endif\n-\t.long\t.LFE3-.LFB3\t/* FDE address range */\n+\t.long\tFDE_ENCODE(.LFB3)\t/* FDE initial location */\n+\t.long\t.LFE3-.LFB3\t\t/* FDE address range */\n #ifdef __PIC__\n \t.byte\t0x0\t/* .uleb128 0x0; Augmentation size */\n #endif"}]}