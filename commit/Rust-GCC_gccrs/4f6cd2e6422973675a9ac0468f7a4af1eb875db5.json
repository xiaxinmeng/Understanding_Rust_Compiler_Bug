{"sha": "4f6cd2e6422973675a9ac0468f7a4af1eb875db5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NGY2Y2QyZTY0MjI5NzM2NzVhOWFjMDQ2OGY3YTRhZjFlYjg3NWRiNQ==", "commit": {"author": {"name": "Jeff Law", "email": "law@gcc.gnu.org", "date": "1995-05-21T05:05:25Z"}, "committer": {"name": "Jeff Law", "email": "law@gcc.gnu.org", "date": "1995-05-21T05:05:25Z"}, "message": "pa.c (hppa_encode_label): New variable \"permanent\" to where/how memory is allocated for the new label.\n\n       * pa.c (hppa_encode_label): New variable \"permanent\" to\n        where/how memory is allocated for the new label.  All\n        callers changed.\n\nFrom-SVN: r9759", "tree": {"sha": "ef93cdf2d8d124d9a7eab83b8c32ee00dad818ee", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ef93cdf2d8d124d9a7eab83b8c32ee00dad818ee"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4f6cd2e6422973675a9ac0468f7a4af1eb875db5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4f6cd2e6422973675a9ac0468f7a4af1eb875db5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4f6cd2e6422973675a9ac0468f7a4af1eb875db5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4f6cd2e6422973675a9ac0468f7a4af1eb875db5/comments", "author": null, "committer": null, "parents": [{"sha": "034c1be0fdf231cecab4424e638060370b0cd7a1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/034c1be0fdf231cecab4424e638060370b0cd7a1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/034c1be0fdf231cecab4424e638060370b0cd7a1"}], "stats": {"total": 21, "additions": 16, "deletions": 5}, "files": [{"sha": "b40239695c3f99b5ca834b186d16f131e81a131d", "filename": "gcc/config/pa/pa.c", "status": "modified", "additions": 14, "deletions": 3, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4f6cd2e6422973675a9ac0468f7a4af1eb875db5/gcc%2Fconfig%2Fpa%2Fpa.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4f6cd2e6422973675a9ac0468f7a4af1eb875db5/gcc%2Fconfig%2Fpa%2Fpa.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fpa%2Fpa.c?ref=4f6cd2e6422973675a9ac0468f7a4af1eb875db5", "patch": "@@ -4247,15 +4247,26 @@ extern struct obstack *saveable_obstack;\n /* In HPUX 8.0's shared library scheme, special relocations are needed\n    for function labels if they might be passed to a function\n    in a shared library (because shared libraries don't live in code\n-   space), and special magic is needed to construct their address. */\n+   space), and special magic is needed to construct their address.\n+\n+   For reasons too disgusting to describe storage for the new name\n+   is allocated either on the saveable_obstack (released at function\n+   exit) or via malloc for things that can never change (libcall names\n+   for example). */\n \n void\n-hppa_encode_label (sym)\n+hppa_encode_label (sym, permanent)\n      rtx sym;\n+     int permanent;\n {\n   char *str = XSTR (sym, 0);\n   int len = strlen (str);\n-  char *newstr = obstack_alloc (saveable_obstack, len + 2) ;\n+  char *newstr;\n+\n+  if (permanent)\n+    newstr = malloc (len + 2);\n+  else\n+    newstr = obstack_alloc (saveable_obstack, len + 2);\n \n   if (str[0] == '*')\n     *newstr++ = *str++;"}, {"sha": "62a1ae8082db114186ad61f088dcc82f7b590cb2", "filename": "gcc/config/pa/pa.h", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4f6cd2e6422973675a9ac0468f7a4af1eb875db5/gcc%2Fconfig%2Fpa%2Fpa.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4f6cd2e6422973675a9ac0468f7a4af1eb875db5/gcc%2Fconfig%2Fpa%2Fpa.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fpa%2Fpa.h?ref=4f6cd2e6422973675a9ac0468f7a4af1eb875db5", "patch": "@@ -1511,7 +1511,7 @@ do\t\t\t\t\t\t\t\\\n \t  _rtl = TREE_CST_RTL (DECL);\t\t\t\\\n \tSYMBOL_REF_FLAG (XEXP (_rtl, 0)) = 1;\t\t\\\n \tif (TREE_CODE (DECL) == FUNCTION_DECL)\t\t\\\n-\t  hppa_encode_label (XEXP (DECL_RTL (DECL), 0));\\\n+\t  hppa_encode_label (XEXP (DECL_RTL (DECL), 0), 0);\\\n       }\t\t\t\t\t\t\t\\\n   }\t\t\t\t\t\t\t\\\n while (0)\n@@ -1897,7 +1897,7 @@ readonly_data ()\t\t\t\t\t\t\t\\\n #define ASM_OUTPUT_EXTERNAL_LIBCALL(FILE, RTL) \\\n   do { fputs (\"\\t.IMPORT \", FILE);\t\t\t\t\t\\\n        if (!function_label_operand (RTL, VOIDmode))\t\t\t\\\n-\t hppa_encode_label (RTL);\t\t\t\t\t\\\n+\t hppa_encode_label (RTL, 1);\t\t\t\t\t\\\n        assemble_name (FILE, XSTR ((RTL), 0));\t\t       \t\t\\\n        fputs (\",CODE\\n\", FILE);\t\t\t\t\t\t\\\n      } while (0)"}]}