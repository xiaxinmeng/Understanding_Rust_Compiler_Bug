{"sha": "23e57329c6516a81a8d3eb21b365ca8a0ec0c41b", "node_id": "C_kwDOANBUbNoAKDIzZTU3MzI5YzY1MTZhODFhOGQzZWIyMWIzNjVjYThhMGVjMGM0MWI", "commit": {"author": {"name": "Patrick Palka", "email": "ppalka@redhat.com", "date": "2022-03-28T18:15:39Z"}, "committer": {"name": "Patrick Palka", "email": "ppalka@redhat.com", "date": "2022-03-28T18:15:39Z"}, "message": "c++: reject concept w/ multiple tparm lists [PR105067]\n\nWe weren't rejecting a concept declared with multiple template\nparameter lists.\n\n\tPR c++/105067\n\ngcc/cp/ChangeLog:\n\n\t* pt.cc (finish_concept_definition): Check that a concept is\n\tdeclared with exactly one template parameter list.\n\ngcc/testsuite/ChangeLog:\n\n\t* g++.dg/cpp2a/concepts-err4.C: New test.", "tree": {"sha": "46310c753fa863d290445f139c3e536e4594112a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/46310c753fa863d290445f139c3e536e4594112a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/23e57329c6516a81a8d3eb21b365ca8a0ec0c41b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/23e57329c6516a81a8d3eb21b365ca8a0ec0c41b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/23e57329c6516a81a8d3eb21b365ca8a0ec0c41b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/23e57329c6516a81a8d3eb21b365ca8a0ec0c41b/comments", "author": null, "committer": null, "parents": [{"sha": "ecb4882e362e80a1bf172453ac9b366edbb4e89c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ecb4882e362e80a1bf172453ac9b366edbb4e89c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ecb4882e362e80a1bf172453ac9b366edbb4e89c"}], "stats": {"total": 12, "additions": 12, "deletions": 0}, "files": [{"sha": "cd07e48cb5a05bcc9480a272270266f0edb3909f", "filename": "gcc/cp/pt.cc", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/23e57329c6516a81a8d3eb21b365ca8a0ec0c41b/gcc%2Fcp%2Fpt.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/23e57329c6516a81a8d3eb21b365ca8a0ec0c41b/gcc%2Fcp%2Fpt.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fpt.cc?ref=23e57329c6516a81a8d3eb21b365ca8a0ec0c41b", "patch": "@@ -28815,6 +28815,12 @@ finish_concept_definition (cp_expr id, tree init)\n       return error_mark_node;\n     }\n \n+  if (current_template_depth > 1)\n+    {\n+      error_at (loc, \"concept %qE has multiple template parameter lists\", *id);\n+      return error_mark_node;\n+    }\n+\n   /* Initially build the concept declaration; its type is bool.  */\n   tree decl = build_lang_decl_loc (loc, CONCEPT_DECL, *id, boolean_type_node);\n   DECL_CONTEXT (decl) = current_scope ();"}, {"sha": "57a96a095c78a9cebdd139581269c1ba5a1ace10", "filename": "gcc/testsuite/g++.dg/cpp2a/concepts-err4.C", "status": "added", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/23e57329c6516a81a8d3eb21b365ca8a0ec0c41b/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp2a%2Fconcepts-err4.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/23e57329c6516a81a8d3eb21b365ca8a0ec0c41b/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp2a%2Fconcepts-err4.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp2a%2Fconcepts-err4.C?ref=23e57329c6516a81a8d3eb21b365ca8a0ec0c41b", "patch": "@@ -0,0 +1,6 @@\n+// PR c++/105067\n+// { dg-do compile { target c++20 } }\n+\n+template<class>\n+template<class>\n+concept C = true; // { dg-error \"parameter list\" }"}]}