{"sha": "dd047c67e45c244c147a8244671154c77a9bda47", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZGQwNDdjNjdlNDVjMjQ0YzE0N2E4MjQ0NjcxMTU0Yzc3YTliZGE0Nw==", "commit": {"author": {"name": "Denys Vlasenko", "email": "dvlasenk@redhat.com", "date": "2018-07-04T07:35:37Z"}, "committer": {"name": "Martin Liska", "email": "marxin@gcc.gnu.org", "date": "2018-07-04T07:35:37Z"}, "message": "Temporary remove \"at least 8 byte alignment\" code from x86\n\n2018-07-04  Denys Vlasenko  <dvlasenk@redhat.com>\n\n\t* config/i386/dragonfly.h: (ASM_OUTPUT_MAX_SKIP_ALIGN):\n\tUse a simpler align directive also if MAXSKIP = ALIGN-1.\n\t* config/i386/gas.h (ASM_OUTPUT_MAX_SKIP_ALIGN): Likewise.\n\t* config/i386/lynx.h (ASM_OUTPUT_MAX_SKIP_ALIGN): Likewise.\n\t* config/i386/netbsd-elf.h (ASM_OUTPUT_MAX_SKIP_ALIGN): Likewise.\n\t* config/i386/i386.h (ASM_OUTPUT_MAX_SKIP_PAD): Likewise.\n\t* config/i386/freebsd.h (ASM_OUTPUT_MAX_SKIP_ALIGN): Remove \"If N\n\tis large, do at least 8 byte alignment\" code. Add SUBALIGN_LOG\n\tdefine. Use a simpler align directive also if MAXSKIP = ALIGN-1.\n\t* config/i386/gnu-user.h (ASM_OUTPUT_MAX_SKIP_ALIGN): Likewise.\n\t* config/i386/iamcu.h (ASM_OUTPUT_MAX_SKIP_ALIGN): Likewise.\n\t* config/i386/openbsdelf.h (ASM_OUTPUT_MAX_SKIP_ALIGN): Likewise.\n\t* config/i386/x86-64.h (ASM_OUTPUT_MAX_SKIP_ALIGN): Likewise.\n\nFrom-SVN: r262374", "tree": {"sha": "335bdcdc2ff7703f446f9c2343a21c00f3d15cb6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/335bdcdc2ff7703f446f9c2343a21c00f3d15cb6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/dd047c67e45c244c147a8244671154c77a9bda47", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dd047c67e45c244c147a8244671154c77a9bda47", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dd047c67e45c244c147a8244671154c77a9bda47", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dd047c67e45c244c147a8244671154c77a9bda47/comments", "author": {"login": "dvlasenk", "id": 3449439, "node_id": "MDQ6VXNlcjM0NDk0Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3449439?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dvlasenk", "html_url": "https://github.com/dvlasenk", "followers_url": "https://api.github.com/users/dvlasenk/followers", "following_url": "https://api.github.com/users/dvlasenk/following{/other_user}", "gists_url": "https://api.github.com/users/dvlasenk/gists{/gist_id}", "starred_url": "https://api.github.com/users/dvlasenk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dvlasenk/subscriptions", "organizations_url": "https://api.github.com/users/dvlasenk/orgs", "repos_url": "https://api.github.com/users/dvlasenk/repos", "events_url": "https://api.github.com/users/dvlasenk/events{/privacy}", "received_events_url": "https://api.github.com/users/dvlasenk/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "7709f595efd867318f501db72832fe420dad8560", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7709f595efd867318f501db72832fe420dad8560", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7709f595efd867318f501db72832fe420dad8560"}], "stats": {"total": 132, "additions": 64, "deletions": 68}, "files": [{"sha": "362ef151468a211a3f466e412e951476159d62cf", "filename": "gcc/ChangeLog", "status": "modified", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dd047c67e45c244c147a8244671154c77a9bda47/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dd047c67e45c244c147a8244671154c77a9bda47/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=dd047c67e45c244c147a8244671154c77a9bda47", "patch": "@@ -1,3 +1,19 @@\n+2018-07-04  Denys Vlasenko  <dvlasenk@redhat.com>\n+\n+\t* config/i386/dragonfly.h: (ASM_OUTPUT_MAX_SKIP_ALIGN):\n+\tUse a simpler align directive also if MAXSKIP = ALIGN-1.\n+\t* config/i386/gas.h (ASM_OUTPUT_MAX_SKIP_ALIGN): Likewise.\n+\t* config/i386/lynx.h (ASM_OUTPUT_MAX_SKIP_ALIGN): Likewise.\n+\t* config/i386/netbsd-elf.h (ASM_OUTPUT_MAX_SKIP_ALIGN): Likewise.\n+\t* config/i386/i386.h (ASM_OUTPUT_MAX_SKIP_PAD): Likewise.\n+\t* config/i386/freebsd.h (ASM_OUTPUT_MAX_SKIP_ALIGN): Remove \"If N\n+\tis large, do at least 8 byte alignment\" code. Add SUBALIGN_LOG\n+\tdefine. Use a simpler align directive also if MAXSKIP = ALIGN-1.\n+\t* config/i386/gnu-user.h (ASM_OUTPUT_MAX_SKIP_ALIGN): Likewise.\n+\t* config/i386/iamcu.h (ASM_OUTPUT_MAX_SKIP_ALIGN): Likewise.\n+\t* config/i386/openbsdelf.h (ASM_OUTPUT_MAX_SKIP_ALIGN): Likewise.\n+\t* config/i386/x86-64.h (ASM_OUTPUT_MAX_SKIP_ALIGN): Likewise.\n+\n 2018-07-04  Martin Liska  <mliska@suse.cz>\n             Jonathan Wakely  <jwakely@redhat.com>\n "}, {"sha": "40774c0cf7a5e793d12aa60ec987d6c063684a11", "filename": "gcc/config/i386/dragonfly.h", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dd047c67e45c244c147a8244671154c77a9bda47/gcc%2Fconfig%2Fi386%2Fdragonfly.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dd047c67e45c244c147a8244671154c77a9bda47/gcc%2Fconfig%2Fi386%2Fdragonfly.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fdragonfly.h?ref=dd047c67e45c244c147a8244671154c77a9bda47", "patch": "@@ -69,10 +69,12 @@ see the files COPYING3 and COPYING.RUNTIME respectively.  If not, see\n \n #ifdef HAVE_GAS_MAX_SKIP_P2ALIGN\n #undef  ASM_OUTPUT_MAX_SKIP_ALIGN\n-#define ASM_OUTPUT_MAX_SKIP_ALIGN(FILE, LOG, MAX_SKIP)\t\t\t\t\t\\\n-  if ((LOG) != 0) {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\\\n-    if ((MAX_SKIP) == 0) fprintf ((FILE), \"\\t.p2align %d\\n\", (LOG));\t\\\n-    else fprintf ((FILE), \"\\t.p2align %d,,%d\\n\", (LOG), (MAX_SKIP));\t\\\n+#define ASM_OUTPUT_MAX_SKIP_ALIGN(FILE, LOG, MAX_SKIP)\t\t\t\\\n+  if ((LOG) != 0) {\t\t\t\t\t\t\t\\\n+    if ((MAX_SKIP) == 0 || (MAX_SKIP) >= (1 << (LOG)) - 1)\t\t\\\n+      fprintf ((FILE), \"\\t.p2align %d\\n\", (LOG));\t\t\t\\\n+    else\t\t\t\t\t\t\t\t\\\n+      fprintf ((FILE), \"\\t.p2align %d,,%d\\n\", (LOG), (MAX_SKIP));\t\\\n   }\n #endif\n "}, {"sha": "caac6b3857566e45ba2412f5689408eb353950ab", "filename": "gcc/config/i386/freebsd.h", "status": "modified", "additions": 5, "deletions": 11, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dd047c67e45c244c147a8244671154c77a9bda47/gcc%2Fconfig%2Fi386%2Ffreebsd.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dd047c67e45c244c147a8244671154c77a9bda47/gcc%2Fconfig%2Fi386%2Ffreebsd.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Ffreebsd.h?ref=dd047c67e45c244c147a8244671154c77a9bda47", "patch": "@@ -92,25 +92,19 @@ along with GCC; see the file COPYING3.  If not see\n \n /* A C statement to output to the stdio stream FILE an assembler\n    command to advance the location counter to a multiple of 1<<LOG\n-   bytes if it is within MAX_SKIP bytes.\n+   bytes if it is within MAX_SKIP bytes.  */\n \n-   This is used to align code labels according to Intel recommendations.  */\n+#define SUBALIGN_LOG 3\n \n #ifdef HAVE_GAS_MAX_SKIP_P2ALIGN\n #undef  ASM_OUTPUT_MAX_SKIP_ALIGN\n #define ASM_OUTPUT_MAX_SKIP_ALIGN(FILE,LOG,MAX_SKIP)\t\t\t\\\n   do {\t\t\t\t\t\t\t\t\t\\\n     if ((LOG) != 0) {\t\t\t\t\t\t\t\\\n-      if ((MAX_SKIP) == 0) fprintf ((FILE), \"\\t.p2align %d\\n\", (LOG));\t\\\n-      else {\t\t\t\t\t\t\t\t\\\n+      if ((MAX_SKIP) == 0 || (MAX_SKIP) >= (1 << (LOG)) - 1)\t\t\\\n+\tfprintf ((FILE), \"\\t.p2align %d\\n\", (LOG));\t\t\t\\\n+      else\t\t\t\t\t\t\t\t\\\n \tfprintf ((FILE), \"\\t.p2align %d,,%d\\n\", (LOG), (MAX_SKIP));\t\\\n-\t/* Make sure that we have at least 8 byte alignment if > 8 byte \\\n-\t   alignment is preferred.  */\t\t\t\t\t\\\n-\tif ((LOG) > 3\t\t\t\t\t\t\t\\\n-\t    && (1 << (LOG)) > ((MAX_SKIP) + 1)\t\t\t\t\\\n-\t    && (MAX_SKIP) >= 7)\t\t\t\t\t\t\\\n-\t  fputs (\"\\t.p2align 3\\n\", (FILE));\t\t\t\t\\\n-      }\t\t\t\t\t\t\t\t\t\\\n     }\t\t\t\t\t\t\t\t\t\\\n   } while (0)\n #endif"}, {"sha": "e149ab1360cae8385b23d9c77a2c9f5f376aed6f", "filename": "gcc/config/i386/gas.h", "status": "modified", "additions": 7, "deletions": 5, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dd047c67e45c244c147a8244671154c77a9bda47/gcc%2Fconfig%2Fi386%2Fgas.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dd047c67e45c244c147a8244671154c77a9bda47/gcc%2Fconfig%2Fi386%2Fgas.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fgas.h?ref=dd047c67e45c244c147a8244671154c77a9bda47", "patch": "@@ -57,7 +57,7 @@ along with GCC; see the file COPYING3.  If not see\n #ifdef HAVE_GAS_BALIGN_AND_P2ALIGN \n #undef ASM_OUTPUT_ALIGN\n #define ASM_OUTPUT_ALIGN(FILE,LOG) \\\n-  if ((LOG)!=0) fprintf ((FILE), \"\\t.balign %d\\n\", 1<<(LOG))\n+  if ((LOG)!=0) fprintf ((FILE), \"\\t.balign %d\\n\", 1 << (LOG))\n #endif\n \n /* A C statement to output to the stdio stream FILE an assembler\n@@ -68,10 +68,12 @@ along with GCC; see the file COPYING3.  If not see\n \n #ifdef HAVE_GAS_MAX_SKIP_P2ALIGN\n #  define ASM_OUTPUT_MAX_SKIP_ALIGN(FILE,LOG,MAX_SKIP) \\\n-     if ((LOG) != 0) {\\\n-       if ((MAX_SKIP) == 0) fprintf ((FILE), \"\\t.p2align %d\\n\", (LOG)); \\\n-       else fprintf ((FILE), \"\\t.p2align %d,,%d\\n\", (LOG), (MAX_SKIP)); \\\n-     }\n+    if ((LOG) != 0) { \\\n+      if ((MAX_SKIP) == 0 || (MAX_SKIP) >= (1<<(LOG))-1)\t\t\\\n+\tfprintf ((FILE), \"\\t.p2align %d\\n\", (LOG));\t\t\t\\\n+      else\t\t\t\t\t\t\t\t\\\n+\tfprintf ((FILE), \"\\t.p2align %d,,%d\\n\", (LOG), (MAX_SKIP));\t\\\n+    }\n #endif\n \f\n /* A C statement or statements which output an assembler instruction"}, {"sha": "a922c9b93fadcaac0fbb3d06b5d2388bfbf6f75b", "filename": "gcc/config/i386/gnu-user.h", "status": "modified", "additions": 5, "deletions": 11, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dd047c67e45c244c147a8244671154c77a9bda47/gcc%2Fconfig%2Fi386%2Fgnu-user.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dd047c67e45c244c147a8244671154c77a9bda47/gcc%2Fconfig%2Fi386%2Fgnu-user.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fgnu-user.h?ref=dd047c67e45c244c147a8244671154c77a9bda47", "patch": "@@ -95,24 +95,18 @@ along with GCC; see the file COPYING3.  If not see\n \n /* A C statement to output to the stdio stream FILE an assembler\n    command to advance the location counter to a multiple of 1<<LOG\n-   bytes if it is within MAX_SKIP bytes.\n+   bytes if it is within MAX_SKIP bytes.  */\n \n-   This is used to align code labels according to Intel recommendations.  */\n+#define SUBALIGN_LOG 3\n \n #ifdef HAVE_GAS_MAX_SKIP_P2ALIGN\n #define ASM_OUTPUT_MAX_SKIP_ALIGN(FILE,LOG,MAX_SKIP)\t\t\t\\\n   do {\t\t\t\t\t\t\t\t\t\\\n     if ((LOG) != 0) {\t\t\t\t\t\t\t\\\n-      if ((MAX_SKIP) == 0) fprintf ((FILE), \"\\t.p2align %d\\n\", (LOG));\t\\\n-      else {\t\t\t\t\t\t\t\t\\\n+      if ((MAX_SKIP) == 0 || (MAX_SKIP) >= (1 << (LOG)) - 1)\t\t\\\n+\tfprintf ((FILE), \"\\t.p2align %d\\n\", (LOG));\t\t\t\\\n+      else\t\t\t\t\t\t\t\t\\\n \tfprintf ((FILE), \"\\t.p2align %d,,%d\\n\", (LOG), (MAX_SKIP));\t\\\n-\t/* Make sure that we have at least 8 byte alignment if > 8 byte \\\n-\t   alignment is preferred.  */\t\t\t\t\t\\\n-\tif ((LOG) > 3\t\t\t\t\t\t\t\\\n-\t    && (1 << (LOG)) > ((MAX_SKIP) + 1)\t\t\t\t\\\n-\t    && (MAX_SKIP) >= 7)\t\t\t\t\t\t\\\n-\t  fputs (\"\\t.p2align 3\\n\", (FILE));\t\t\t\t\\\n-      }\t\t\t\t\t\t\t\t\t\\\n     }\t\t\t\t\t\t\t\t\t\\\n   } while (0)\n #endif"}, {"sha": "fbba598ffd5bc408ecf60cfdd6d8754fe3a5d64d", "filename": "gcc/config/i386/i386.h", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dd047c67e45c244c147a8244671154c77a9bda47/gcc%2Fconfig%2Fi386%2Fi386.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dd047c67e45c244c147a8244671154c77a9bda47/gcc%2Fconfig%2Fi386%2Fi386.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386.h?ref=dd047c67e45c244c147a8244671154c77a9bda47", "patch": "@@ -2201,7 +2201,7 @@ extern int const svr4_dbx_register_map[FIRST_PSEUDO_REGISTER];\n #define ASM_OUTPUT_MAX_SKIP_PAD(FILE, LOG, MAX_SKIP)\t\t\t\\\n   if ((LOG) != 0)\t\t\t\t\t\t\t\\\n     {\t\t\t\t\t\t\t\t\t\\\n-      if ((MAX_SKIP) == 0)\t\t\t\t\t\t\\\n+      if ((MAX_SKIP) == 0 || (MAX_SKIP) >= (1 << (LOG)) - 1)\t\t\\\n         fprintf ((FILE), \"\\t.p2align %d\\n\", (LOG));\t\t\t\\\n       else\t\t\t\t\t\t\t\t\\\n         fprintf ((FILE), \"\\t.p2align %d,,%d\\n\", (LOG), (MAX_SKIP));\t\\"}, {"sha": "4e7c56967a53d459a1b41b19751cad8be7d19389", "filename": "gcc/config/i386/iamcu.h", "status": "modified", "additions": 5, "deletions": 11, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dd047c67e45c244c147a8244671154c77a9bda47/gcc%2Fconfig%2Fi386%2Fiamcu.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dd047c67e45c244c147a8244671154c77a9bda47/gcc%2Fconfig%2Fi386%2Fiamcu.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fiamcu.h?ref=dd047c67e45c244c147a8244671154c77a9bda47", "patch": "@@ -62,23 +62,17 @@ see the files COPYING3 and COPYING.RUNTIME respectively.  If not, see\n \n /* A C statement to output to the stdio stream FILE an assembler\n    command to advance the location counter to a multiple of 1<<LOG\n-   bytes if it is within MAX_SKIP bytes.\n+   bytes if it is within MAX_SKIP bytes.  */\n \n-   This is used to align code labels according to Intel recommendations.  */\n+#define SUBALIGN_LOG 3\n \n #define ASM_OUTPUT_MAX_SKIP_ALIGN(FILE,LOG,MAX_SKIP)\t\t\t\\\n   do {\t\t\t\t\t\t\t\t\t\\\n     if ((LOG) != 0) {\t\t\t\t\t\t\t\\\n-      if ((MAX_SKIP) == 0) fprintf ((FILE), \"\\t.p2align %d\\n\", (LOG));\t\\\n-      else {\t\t\t\t\t\t\t\t\\\n+      if ((MAX_SKIP) == 0 || (MAX_SKIP) >= (1 << (LOG)) - 1)\t\t\\\n+\tfprintf ((FILE), \"\\t.p2align %d\\n\", (LOG));\t\t\t\\\n+      else\t\t\t\t\t\t\t\t\\\n \tfprintf ((FILE), \"\\t.p2align %d,,%d\\n\", (LOG), (MAX_SKIP));\t\\\n-\t/* Make sure that we have at least 8 byte alignment if > 8 byte \\\n-\t   alignment is preferred.  */\t\t\t\t\t\\\n-\tif ((LOG) > 3\t\t\t\t\t\t\t\\\n-\t    && (1 << (LOG)) > ((MAX_SKIP) + 1)\t\t\t\t\\\n-\t    && (MAX_SKIP) >= 7)\t\t\t\t\t\t\\\n-\t  fputs (\"\\t.p2align 3\\n\", (FILE));\t\t\t\t\\\n-      }\t\t\t\t\t\t\t\t\t\\\n     }\t\t\t\t\t\t\t\t\t\\\n   } while (0)\n "}, {"sha": "6f4013eb74bdb7069bd48dff6dd08a5ec02be182", "filename": "gcc/config/i386/lynx.h", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dd047c67e45c244c147a8244671154c77a9bda47/gcc%2Fconfig%2Fi386%2Flynx.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dd047c67e45c244c147a8244671154c77a9bda47/gcc%2Fconfig%2Fi386%2Flynx.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Flynx.h?ref=dd047c67e45c244c147a8244671154c77a9bda47", "patch": "@@ -61,8 +61,10 @@ along with GCC; see the file COPYING3.  If not see\n #define ASM_OUTPUT_MAX_SKIP_ALIGN(FILE,LOG,MAX_SKIP)\t\t\t\\\n   do {\t\t\t\t\t\t\t\t\t\\\n     if ((LOG) != 0) {\t\t\t\t\t\t\t\\\n-      if ((MAX_SKIP) == 0) fprintf ((FILE), \"\\t.p2align %d\\n\", (LOG));\t\\\n-      else fprintf ((FILE), \"\\t.p2align %d,,%d\\n\", (LOG), (MAX_SKIP));\t\\\n+      if ((MAX_SKIP) == 0 || (MAX_SKIP) >= (1 << (LOG)) - 1)\t\t\\\n+\tfprintf ((FILE), \"\\t.p2align %d\\n\", (LOG));\t\t\t\\\n+      else\t\t\t\t\t\t\t\t\\\n+\tfprintf ((FILE), \"\\t.p2align %d,,%d\\n\", (LOG), (MAX_SKIP));\t\\\n     }\t\t\t\t\t\t\t\t\t\\\n   } while (0)\n #endif"}, {"sha": "1aa96cd7c8931544fe7b6f2e24c0eb16f5355a84", "filename": "gcc/config/i386/netbsd-elf.h", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dd047c67e45c244c147a8244671154c77a9bda47/gcc%2Fconfig%2Fi386%2Fnetbsd-elf.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dd047c67e45c244c147a8244671154c77a9bda47/gcc%2Fconfig%2Fi386%2Fnetbsd-elf.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fnetbsd-elf.h?ref=dd047c67e45c244c147a8244671154c77a9bda47", "patch": "@@ -104,8 +104,10 @@ along with GCC; see the file COPYING3.  If not see\n #ifdef HAVE_GAS_MAX_SKIP_P2ALIGN\n #define ASM_OUTPUT_MAX_SKIP_ALIGN(FILE, LOG, MAX_SKIP)\t\t\t\\\n   if ((LOG) != 0) {\t\t\t\t\t\t\t\\\n-    if ((MAX_SKIP) == 0) fprintf ((FILE), \"\\t.p2align %d\\n\", (LOG));\t\\\n-    else fprintf ((FILE), \"\\t.p2align %d,,%d\\n\", (LOG), (MAX_SKIP));\t\\\n+    if ((MAX_SKIP) == 0 || (MAX_SKIP) >= (1 << (LOG)) - 1)\t\t\\\n+      fprintf ((FILE), \"\\t.p2align %d\\n\", (LOG));\t\t\t\\\n+    else\t\t\t\t\t\t\t\t\\\n+      fprintf ((FILE), \"\\t.p2align %d,,%d\\n\", (LOG), (MAX_SKIP));\t\\\n   }\n #endif\n "}, {"sha": "705e904e9ab6b246dadb25874ab9be95b7a31ea6", "filename": "gcc/config/i386/openbsdelf.h", "status": "modified", "additions": 5, "deletions": 11, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dd047c67e45c244c147a8244671154c77a9bda47/gcc%2Fconfig%2Fi386%2Fopenbsdelf.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dd047c67e45c244c147a8244671154c77a9bda47/gcc%2Fconfig%2Fi386%2Fopenbsdelf.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fopenbsdelf.h?ref=dd047c67e45c244c147a8244671154c77a9bda47", "patch": "@@ -63,24 +63,18 @@ along with GCC; see the file COPYING3.  If not see\n \n /* A C statement to output to the stdio stream FILE an assembler\n    command to advance the location counter to a multiple of 1<<LOG\n-   bytes if it is within MAX_SKIP bytes.\n+   bytes if it is within MAX_SKIP bytes.  */\n \n-   This is used to align code labels according to Intel recommendations.  */\n+#define SUBALIGN_LOG 3\n \n #ifdef HAVE_GAS_MAX_SKIP_P2ALIGN\n #define ASM_OUTPUT_MAX_SKIP_ALIGN(FILE,LOG,MAX_SKIP)\t\t\t\\\n   do {\t\t\t\t\t\t\t\t\t\\\n     if ((LOG) != 0) {\t\t\t\t\t\t\t\\\n-      if ((MAX_SKIP) == 0) fprintf ((FILE), \"\\t.p2align %d\\n\", (LOG));\t\\\n-      else {\t\t\t\t\t\t\t\t\\\n+      if ((MAX_SKIP) == 0 || (MAX_SKIP) >= (1 << (LOG)) - 1)\t\t\\\n+\tfprintf ((FILE), \"\\t.p2align %d\\n\", (LOG));\t\t\t\\\n+      else\t\t\t\t\t\t\t\t\\\n \tfprintf ((FILE), \"\\t.p2align %d,,%d\\n\", (LOG), (MAX_SKIP));\t\\\n-\t/* Make sure that we have at least 8 byte alignment if > 8 byte \\\n-\t   alignment is preferred.  */\t\t\t\t\t\\\n-\tif ((LOG) > 3\t\t\t\t\t\t\t\\\n-\t    && (1 << (LOG)) > ((MAX_SKIP) + 1)\t\t\t\t\\\n-\t    && (MAX_SKIP) >= 7)\t\t\t\t\t\t\\\n-\t  fputs (\"\\t.p2align 3\\n\", (FILE));\t\t\t\t\\\n-      }\t\t\t\t\t\t\t\t\t\\\n     }\t\t\t\t\t\t\t\t\t\\\n   } while (0)\n #endif"}, {"sha": "66bbd5edc596021954fe18d44ffe39a8ad57fb2b", "filename": "gcc/config/i386/x86-64.h", "status": "modified", "additions": 6, "deletions": 10, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dd047c67e45c244c147a8244671154c77a9bda47/gcc%2Fconfig%2Fi386%2Fx86-64.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dd047c67e45c244c147a8244671154c77a9bda47/gcc%2Fconfig%2Fi386%2Fx86-64.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fx86-64.h?ref=dd047c67e45c244c147a8244671154c77a9bda47", "patch": "@@ -61,27 +61,23 @@ see the files COPYING3 and COPYING.RUNTIME respectively.  If not, see\n \n /* This is used to align code labels according to Intel recommendations.  */\n \n+#define SUBALIGN_LOG 3\n+\n #ifdef HAVE_GAS_MAX_SKIP_P2ALIGN\n #define ASM_OUTPUT_MAX_SKIP_ALIGN(FILE,LOG,MAX_SKIP)\t\t\t\\\n   do {\t\t\t\t\t\t\t\t\t\\\n     if ((LOG) != 0) {\t\t\t\t\t\t\t\\\n-      if ((MAX_SKIP) == 0) fprintf ((FILE), \"\\t.p2align %d\\n\", (LOG));\t\\\n-      else {\t\t\t\t\t\t\t\t\\\n+      if ((MAX_SKIP) == 0 || (MAX_SKIP) >= (1 << (LOG)) - 1)\t\t\\\n+\tfprintf ((FILE), \"\\t.p2align %d\\n\", (LOG));\t\t\t\\\n+      else\t\t\t\t\t\t\t\t\\\n \tfprintf ((FILE), \"\\t.p2align %d,,%d\\n\", (LOG), (MAX_SKIP));\t\\\n-\t/* Make sure that we have at least 8 byte alignment if > 8 byte \\\n-\t   alignment is preferred.  */\t\t\t\t\t\\\n-\tif ((LOG) > 3\t\t\t\t\t\t\t\\\n-\t    && (1 << (LOG)) > ((MAX_SKIP) + 1)\t\t\t\t\\\n-\t    && (MAX_SKIP) >= 7)\t\t\t\t\t\t\\\n-\t  fputs (\"\\t.p2align 3\\n\", (FILE));\t\t\t\t\\\n-      }\t\t\t\t\t\t\t\t\t\\\n     }\t\t\t\t\t\t\t\t\t\\\n   } while (0)\n #undef  ASM_OUTPUT_MAX_SKIP_PAD\n #define ASM_OUTPUT_MAX_SKIP_PAD(FILE, LOG, MAX_SKIP)\t\t\t\\\n   if ((LOG) != 0)\t\t\t\t\t\t\t\\\n     {\t\t\t\t\t\t\t\t\t\\\n-      if ((MAX_SKIP) == 0)\t\t\t\t\t\t\\\n+      if ((MAX_SKIP) == 0 || (MAX_SKIP) >= (1<<(LOG))-1)\t\t\\\n         fprintf ((FILE), \"\\t.p2align %d\\n\", (LOG));\t\t\t\\\n       else\t\t\t\t\t\t\t\t\\\n         fprintf ((FILE), \"\\t.p2align %d,,%d\\n\", (LOG), (MAX_SKIP));\t\\"}]}