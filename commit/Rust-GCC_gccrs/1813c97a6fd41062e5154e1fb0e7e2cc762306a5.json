{"sha": "1813c97a6fd41062e5154e1fb0e7e2cc762306a5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTgxM2M5N2E2ZmQ0MTA2MmU1MTU0ZTFmYjBlN2UyY2M3NjIzMDZhNQ==", "commit": {"author": {"name": "Steven G. Kargl", "email": "kargl@gcc.gnu.org", "date": "2018-03-11T21:39:15Z"}, "committer": {"name": "Steven G. Kargl", "email": "kargl@gcc.gnu.org", "date": "2018-03-11T21:39:15Z"}, "message": "re PR fortran/83939 (Constraint C1290 (elemental function cannot be allocatable) not enforced)\n\n2018-03-11  Steven G. Kargl  <kargl@gcc.gnu.org>\n\n\tPR fortran/83939\n\t* resolve.c (resolve_fl_procedure): Enforce F2018:C15100.\n\n2018-03-11  Steven G. Kargl  <kargl@gcc.gnu.org>\n\n\tPR fortran/83939\n\t* gfortran.dg/pr83939.f90\n\nFrom-SVN: r258437", "tree": {"sha": "0a8e7c558de38b75e4ecd2d2b376c2de0ee42fb4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0a8e7c558de38b75e4ecd2d2b376c2de0ee42fb4"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1813c97a6fd41062e5154e1fb0e7e2cc762306a5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1813c97a6fd41062e5154e1fb0e7e2cc762306a5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1813c97a6fd41062e5154e1fb0e7e2cc762306a5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1813c97a6fd41062e5154e1fb0e7e2cc762306a5/comments", "author": null, "committer": null, "parents": [{"sha": "fbe1f017435875f9bfd29d250b4ba2eaf4c79047", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fbe1f017435875f9bfd29d250b4ba2eaf4c79047", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fbe1f017435875f9bfd29d250b4ba2eaf4c79047"}], "stats": {"total": 36, "additions": 36, "deletions": 0}, "files": [{"sha": "45def3230da3a3abd11b2719472e08d95747a9a2", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1813c97a6fd41062e5154e1fb0e7e2cc762306a5/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1813c97a6fd41062e5154e1fb0e7e2cc762306a5/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=1813c97a6fd41062e5154e1fb0e7e2cc762306a5", "patch": "@@ -1,3 +1,9 @@\n+\n+2018-03-11  Steven G. Kargl  <kargl@gcc.gnu.org>\n+\n+\tPR fortran/83939\n+\t* resolve.c (resolve_fl_procedure): Enforce F2018:C15100.\n+\n 2018-03-11  Steven G. Kargl  <kargls@gcc.gnu.org>\n \n \t* check.c (gfc_check_kill):  Check pid and sig are scalar."}, {"sha": "e28146a8bf46689d639c46616b0a40f426093012", "filename": "gcc/fortran/resolve.c", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1813c97a6fd41062e5154e1fb0e7e2cc762306a5/gcc%2Ffortran%2Fresolve.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1813c97a6fd41062e5154e1fb0e7e2cc762306a5/gcc%2Ffortran%2Fresolve.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fresolve.c?ref=1813c97a6fd41062e5154e1fb0e7e2cc762306a5", "patch": "@@ -12451,6 +12451,19 @@ resolve_fl_procedure (gfc_symbol *sym, int mp_flag)\n \t}\n     }\n \n+  /* F2018, C15100: \"The result of an elemental function shall be scalar,\n+     and shall not have the POINTER or ALLOCATABLE attribute.\"  The scalar\n+     pointer is tested and caught elsewhere.  */\n+  if (sym->attr.elemental && sym->result\n+      && (sym->result->attr.allocatable || sym->result->attr.pointer))\n+    {\n+      gfc_error (\"Function result variable %qs at %L of elemental \"\n+\t\t \"function %qs shall not have an ALLOCATABLE or POINTER \"\n+\t\t \"attribute\", sym->result->name,\n+\t\t &sym->result->declared_at, sym->name);\n+      return false;\n+    }\n+\n   if (sym->attr.is_bind_c && sym->attr.is_c_interop != 1)\n     {\n       gfc_formal_arglist *curr_arg;"}, {"sha": "c089a1dc2731feac9fcbc707e2549bd1e8f21e34", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1813c97a6fd41062e5154e1fb0e7e2cc762306a5/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1813c97a6fd41062e5154e1fb0e7e2cc762306a5/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=1813c97a6fd41062e5154e1fb0e7e2cc762306a5", "patch": "@@ -1,3 +1,8 @@\n+2018-03-11  Steven G. Kargl  <kargl@gcc.gnu.org>\n+\n+\tPR fortran/83939\n+\t* gfortran.dg/pr83939.f90\n+\n 2018-03-11  Thomas Koenig  <tkoenig@gcc.gnu.org>\n \n \tPR fortran/66128"}, {"sha": "dfeaac71630c7afcd097cf0e3163ba979f267324", "filename": "gcc/testsuite/gfortran.dg/pr83939.f90", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1813c97a6fd41062e5154e1fb0e7e2cc762306a5/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr83939.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1813c97a6fd41062e5154e1fb0e7e2cc762306a5/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr83939.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr83939.f90?ref=1813c97a6fd41062e5154e1fb0e7e2cc762306a5", "patch": "@@ -0,0 +1,12 @@\n+! { dg-do compile }\n+elemental function f() result(s) ! { dg-error \"shall not have an ALLOCATABLE or POINTER\" }\n+  allocatable s\n+  allocate(s)\n+  s = 3.5\n+end function\n+\n+elemental function g() result(s) ! { dg-error \"shall not have an ALLOCATABLE or POINTER\" }\n+  pointer s\n+  allocate(s)\n+  s = 3.5\n+end function"}]}