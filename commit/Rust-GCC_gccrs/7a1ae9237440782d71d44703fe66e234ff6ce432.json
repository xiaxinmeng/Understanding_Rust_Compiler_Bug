{"sha": "7a1ae9237440782d71d44703fe66e234ff6ce432", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2ExYWU5MjM3NDQwNzgyZDcxZDQ0NzAzZmU2NmUyMzRmZjZjZTQzMg==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2017-02-28T22:15:54Z"}, "committer": {"name": "Eric Botcazou", "email": "ebotcazou@gcc.gnu.org", "date": "2017-02-28T22:15:54Z"}, "message": "re PR target/79749 (Many sparc testcases FAIL at -O0 with -fomit-frame-pointer)\n\n\tPR target/79749\n\t* config/sparc/sparc.c (sparc_frame_pointer_required): Add missing\n\tcondition on optimize for the leaf function test.\n\nFrom-SVN: r245791", "tree": {"sha": "97afb37b24ac3411b91e36f06d8734400b26b022", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/97afb37b24ac3411b91e36f06d8734400b26b022"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7a1ae9237440782d71d44703fe66e234ff6ce432", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7a1ae9237440782d71d44703fe66e234ff6ce432", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7a1ae9237440782d71d44703fe66e234ff6ce432", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7a1ae9237440782d71d44703fe66e234ff6ce432/comments", "author": null, "committer": null, "parents": [{"sha": "cbf6ad9d6119db62e907a7e4a345b3a44137d036", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cbf6ad9d6119db62e907a7e4a345b3a44137d036", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cbf6ad9d6119db62e907a7e4a345b3a44137d036"}], "stats": {"total": 35, "additions": 33, "deletions": 2}, "files": [{"sha": "51cb8abc1d28729c0bab3ed4962eb6cb3f8b60f0", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7a1ae9237440782d71d44703fe66e234ff6ce432/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7a1ae9237440782d71d44703fe66e234ff6ce432/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=7a1ae9237440782d71d44703fe66e234ff6ce432", "patch": "@@ -1,3 +1,9 @@\n+2017-02-28  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\tPR target/79749\n+\t* config/sparc/sparc.c (sparc_frame_pointer_required): Add missing\n+\tcondition on optimize for the leaf function test.\n+\n 2017-02-28  Martin Liska  <mliska@suse.cz>\n \n \tPR lto/79625"}, {"sha": "16ca444518f4647bb2280215bc4955d1b4eaca75", "filename": "gcc/config/sparc/sparc.c", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7a1ae9237440782d71d44703fe66e234ff6ce432/gcc%2Fconfig%2Fsparc%2Fsparc.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7a1ae9237440782d71d44703fe66e234ff6ce432/gcc%2Fconfig%2Fsparc%2Fsparc.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fsparc%2Fsparc.c?ref=7a1ae9237440782d71d44703fe66e234ff6ce432", "patch": "@@ -12180,8 +12180,9 @@ sparc_frame_pointer_required (void)\n   if (TARGET_FLAT)\n     return false;\n \n-  /* Otherwise, the frame pointer is required if the function isn't leaf.  */\n-  return !(crtl->is_leaf && only_leaf_regs_used ());\n+  /* Otherwise, the frame pointer is required if the function isn't leaf, but\n+     we cannot use sparc_leaf_function_p since it hasn't been computed yet.  */\n+  return !(optimize > 0 && crtl->is_leaf && only_leaf_regs_used ());\n }\n \n /* The way this is structured, we can't eliminate SFP in favor of SP"}, {"sha": "4aab63a4e5d7f42f4ccf3897f63be979c6cbfaf7", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7a1ae9237440782d71d44703fe66e234ff6ce432/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7a1ae9237440782d71d44703fe66e234ff6ce432/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=7a1ae9237440782d71d44703fe66e234ff6ce432", "patch": "@@ -1,3 +1,7 @@\n+2017-02-28  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* gcc.target/sparc/20170228-1.c: New test.\n+\n 2017-02-28  Uros Bizjak  <ubizjak@gmail.com>\n \n \t* gcc.target/i386/invsize-1.c: New test."}, {"sha": "575fbce528dfd90d50539f6e87e2f01b205469e2", "filename": "gcc/testsuite/gcc.target/sparc/20170228-1.c", "status": "added", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7a1ae9237440782d71d44703fe66e234ff6ce432/gcc%2Ftestsuite%2Fgcc.target%2Fsparc%2F20170228-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7a1ae9237440782d71d44703fe66e234ff6ce432/gcc%2Ftestsuite%2Fgcc.target%2Fsparc%2F20170228-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fsparc%2F20170228-1.c?ref=7a1ae9237440782d71d44703fe66e234ff6ce432", "patch": "@@ -0,0 +1,20 @@\n+/* PR target/79749 */\n+/* Reported by Rainer Orth <ro@gcc.gnu.org> */\n+\n+/* { dg-do run } */\n+/* { dg-options \"-fomit-frame-pointer\" } */\n+\n+extern void abort (void);\n+\n+int foo (int x1, int x2, int x3, int x4, int x5, int x6, int x7)\n+{\n+  return x7;\n+}\n+\n+int main (void)\n+{\n+  if (foo (100, 200, 300, 400, 500, 600, 700) != 700)\n+    abort ();\n+\n+  return 0;\n+}"}]}