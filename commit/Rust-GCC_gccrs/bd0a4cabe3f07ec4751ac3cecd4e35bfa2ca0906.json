{"sha": "bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmQwYTRjYWJlM2YwN2VjNDc1MWFjM2NlY2Q0ZTM1YmZhMmNhMDkwNg==", "commit": {"author": {"name": "Emmanuel Briot", "email": "briot@adacore.com", "date": "2009-04-29T12:10:28Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2009-04-29T12:10:28Z"}, "message": "2009-04-29  Emmanuel Briot  <briot@adacore.com>\n\n\t* gnatcmd.adb, prj-proc.adb, prj-proc.ads, make.adb, prj-part.adb,\n\tprj-part.ads, prj.adb, prj.ads, clean.adb, prj-dect.adb, prj-dect.ads,\n\tprj-nmsc.adb, prj-nmsc.ads, prj-pars.adb, prj-pars.ads, prj-makr.adb\n\t(Set_In_Configuration, In_Configuration): Removed.\n\tReplaced by an extra parameter Is_Config_File in several parameter to\n\tavoid global variables to store the state of the parser.\n\nFrom-SVN: r146955", "tree": {"sha": "699db50c8964626cd1cf978fd50f643e924d553c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/699db50c8964626cd1cf978fd50f643e924d553c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906/comments", "author": {"login": "briot", "id": 42402, "node_id": "MDQ6VXNlcjQyNDAy", "avatar_url": "https://avatars.githubusercontent.com/u/42402?v=4", "gravatar_id": "", "url": "https://api.github.com/users/briot", "html_url": "https://github.com/briot", "followers_url": "https://api.github.com/users/briot/followers", "following_url": "https://api.github.com/users/briot/following{/other_user}", "gists_url": "https://api.github.com/users/briot/gists{/gist_id}", "starred_url": "https://api.github.com/users/briot/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/briot/subscriptions", "organizations_url": "https://api.github.com/users/briot/orgs", "repos_url": "https://api.github.com/users/briot/repos", "events_url": "https://api.github.com/users/briot/events{/privacy}", "received_events_url": "https://api.github.com/users/briot/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "69cb258c42f443c2def36a9e6864c7a3538e323c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/69cb258c42f443c2def36a9e6864c7a3538e323c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/69cb258c42f443c2def36a9e6864c7a3538e323c"}], "stats": {"total": 274, "additions": 171, "deletions": 103}, "files": [{"sha": "ba2afc9682335089a57f9048f64a34f24d1c697e", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906", "patch": "@@ -1,3 +1,12 @@\n+2009-04-29  Emmanuel Briot  <briot@adacore.com>\n+\n+\t* gnatcmd.adb, prj-proc.adb, prj-proc.ads, make.adb, prj-part.adb,\n+\tprj-part.ads, prj.adb, prj.ads, clean.adb, prj-dect.adb, prj-dect.ads,\n+\tprj-nmsc.adb, prj-nmsc.ads, prj-pars.adb, prj-pars.ads, prj-makr.adb\n+\t(Set_In_Configuration, In_Configuration): Removed.\n+\tReplaced by an extra parameter Is_Config_File in several parameter to\n+\tavoid global variables to store the state of the parser.\n+\n 2009-04-29  Ed Schonberg  <schonberg@adacore.com>\n \n \t* sinfo.ads, sinfo.adb: New attribute Next_Implicit_With, to chain"}, {"sha": "04512e7778ff3c1749175325866244d11df8b869", "filename": "gcc/ada/clean.adb", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906/gcc%2Fada%2Fclean.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906/gcc%2Fada%2Fclean.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fclean.adb?ref=bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906", "patch": "@@ -1373,7 +1373,8 @@ package body Clean is\n            (Project           => Main_Project,\n             In_Tree           => Project_Tree,\n             Project_File_Name => Project_File_Name.all,\n-            Packages_To_Check => Packages_To_Check_By_Gnatmake);\n+            Packages_To_Check => Packages_To_Check_By_Gnatmake,\n+            Is_Config_File    => False);\n \n          if Main_Project = No_Project then\n             Fail (\"\"\"\" & Project_File_Name.all & \"\"\" processing failed\");"}, {"sha": "81e9bc4191df892c0b25a322bac33f44dd4118e0", "filename": "gcc/ada/gnatcmd.adb", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906/gcc%2Fada%2Fgnatcmd.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906/gcc%2Fada%2Fgnatcmd.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgnatcmd.adb?ref=bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906", "patch": "@@ -1884,7 +1884,8 @@ begin\n            (Project           => Project,\n             In_Tree           => Project_Tree,\n             Project_File_Name => Project_File.all,\n-            Packages_To_Check => Packages_To_Check);\n+            Packages_To_Check => Packages_To_Check,\n+            Is_Config_File    => False);\n \n          if Project = Prj.No_Project then\n             Fail (\"\"\"\" & Project_File.all & \"\"\" processing failed\");"}, {"sha": "3206bc1b009ac7f64899105f7bccf6588fedc2f8", "filename": "gcc/ada/make.adb", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906/gcc%2Fada%2Fmake.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906/gcc%2Fada%2Fmake.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fmake.adb?ref=bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906", "patch": "@@ -6843,7 +6843,8 @@ package body Make is\n            (Project           => Main_Project,\n             In_Tree           => Project_Tree,\n             Project_File_Name => Project_File_Name.all,\n-            Packages_To_Check => Packages_To_Check_By_Gnatmake);\n+            Packages_To_Check => Packages_To_Check_By_Gnatmake,\n+            Is_Config_File    => False);\n \n          --  The parsing of project files may have changed the current output\n "}, {"sha": "49bd50e0e4c1b52a2554b572d4ebf928937ac898", "filename": "gcc/ada/prj-dect.adb", "status": "modified", "additions": 32, "deletions": 15, "changes": 47, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906/gcc%2Fada%2Fprj-dect.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906/gcc%2Fada%2Fprj-dect.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-dect.adb?ref=bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906", "patch": "@@ -63,7 +63,8 @@ package body Prj.Dect is\n       First_Attribute   : Attribute_Node_Id;\n       Current_Project   : Project_Node_Id;\n       Current_Package   : Project_Node_Id;\n-      Packages_To_Check : String_List_Access);\n+      Packages_To_Check : String_List_Access;\n+      Is_Config_File    : Boolean);\n    --  Parse a case construction\n \n    procedure Parse_Declarative_Items\n@@ -73,16 +74,22 @@ package body Prj.Dect is\n       First_Attribute   : Attribute_Node_Id;\n       Current_Project   : Project_Node_Id;\n       Current_Package   : Project_Node_Id;\n-      Packages_To_Check : String_List_Access);\n+      Packages_To_Check : String_List_Access;\n+      Is_Config_File    : Boolean);\n    --  Parse declarative items. Depending on In_Zone, some declarative\n    --  items may be forbidden.\n+   --  Is_Config_File should be set to True if the project represents a config\n+   --  file (.cgpr) since some specific checks apply.\n \n    procedure Parse_Package_Declaration\n      (In_Tree             : Project_Node_Tree_Ref;\n       Package_Declaration : out Project_Node_Id;\n       Current_Project     : Project_Node_Id;\n-      Packages_To_Check   : String_List_Access);\n-   --  Parse a package declaration\n+      Packages_To_Check   : String_List_Access;\n+      Is_Config_File      : Boolean);\n+   --  Parse a package declaration.\n+   --  Is_Config_File should be set to True if the project represents a config\n+   --  file (.cgpr) since some specific checks apply.\n \n    procedure Parse_String_Type_Declaration\n      (In_Tree         : Project_Node_Tree_Ref;\n@@ -108,7 +115,8 @@ package body Prj.Dect is\n       Declarations      : out Project_Node_Id;\n       Current_Project   : Project_Node_Id;\n       Extends           : Project_Node_Id;\n-      Packages_To_Check : String_List_Access)\n+      Packages_To_Check : String_List_Access;\n+      Is_Config_File    : Boolean)\n    is\n       First_Declarative_Item : Project_Node_Id := Empty_Node;\n \n@@ -126,7 +134,8 @@ package body Prj.Dect is\n          First_Attribute   => Prj.Attr.Attribute_First,\n          Current_Project   => Current_Project,\n          Current_Package   => Empty_Node,\n-         Packages_To_Check => Packages_To_Check);\n+         Packages_To_Check => Packages_To_Check,\n+         Is_Config_File    => Is_Config_File);\n       Set_First_Declarative_Item_Of\n         (Declarations, In_Tree, To => First_Declarative_Item);\n    end Parse;\n@@ -605,7 +614,8 @@ package body Prj.Dect is\n       First_Attribute   : Attribute_Node_Id;\n       Current_Project   : Project_Node_Id;\n       Current_Package   : Project_Node_Id;\n-      Packages_To_Check : String_List_Access)\n+      Packages_To_Check : String_List_Access;\n+      Is_Config_File    : Boolean)\n    is\n       Current_Item    : Project_Node_Id := Empty_Node;\n       Next_Item       : Project_Node_Id := Empty_Node;\n@@ -728,7 +738,8 @@ package body Prj.Dect is\n                First_Attribute   => First_Attribute,\n                Current_Project   => Current_Project,\n                Current_Package   => Current_Package,\n-               Packages_To_Check => Packages_To_Check);\n+               Packages_To_Check => Packages_To_Check,\n+               Is_Config_File    => Is_Config_File);\n \n             --  \"when others =>\" must be the last branch, so save the\n             --  Case_Item and exit\n@@ -754,7 +765,8 @@ package body Prj.Dect is\n                First_Attribute   => First_Attribute,\n                Current_Project   => Current_Project,\n                Current_Package   => Current_Package,\n-               Packages_To_Check => Packages_To_Check);\n+               Packages_To_Check => Packages_To_Check,\n+               Is_Config_File    => Is_Config_File);\n \n             Set_First_Declarative_Item_Of\n               (Current_Item, In_Tree, To => First_Declarative_Item);\n@@ -799,7 +811,8 @@ package body Prj.Dect is\n       First_Attribute   : Attribute_Node_Id;\n       Current_Project   : Project_Node_Id;\n       Current_Package   : Project_Node_Id;\n-      Packages_To_Check : String_List_Access)\n+      Packages_To_Check : String_List_Access;\n+      Is_Config_File    : Boolean)\n    is\n       Current_Declarative_Item : Project_Node_Id := Empty_Node;\n       Next_Declarative_Item    : Project_Node_Id := Empty_Node;\n@@ -893,7 +906,8 @@ package body Prj.Dect is\n                  (In_Tree             => In_Tree,\n                   Package_Declaration => Current_Declaration,\n                   Current_Project     => Current_Project,\n-                  Packages_To_Check   => Packages_To_Check);\n+                  Packages_To_Check   => Packages_To_Check,\n+                  Is_Config_File      => Is_Config_File);\n \n                Set_Previous_End_Node (Current_Declaration);\n \n@@ -924,7 +938,8 @@ package body Prj.Dect is\n                   First_Attribute   => First_Attribute,\n                   Current_Project   => Current_Project,\n                   Current_Package   => Current_Package,\n-                  Packages_To_Check => Packages_To_Check);\n+                  Packages_To_Check => Packages_To_Check,\n+                  Is_Config_File    => Is_Config_File);\n \n                Set_Previous_End_Node (Current_Declaration);\n \n@@ -977,7 +992,8 @@ package body Prj.Dect is\n      (In_Tree             : Project_Node_Tree_Ref;\n       Package_Declaration : out Project_Node_Id;\n       Current_Project     : Project_Node_Id;\n-      Packages_To_Check   : String_List_Access)\n+      Packages_To_Check   : String_List_Access;\n+      Is_Config_File      : Boolean)\n    is\n       First_Attribute        : Attribute_Node_Id := Empty_Attribute;\n       Current_Package        : Package_Node_Id   := Empty_Package;\n@@ -1101,7 +1117,7 @@ package body Prj.Dect is\n       end if;\n \n       if Token = Tok_Renames then\n-         if In_Configuration then\n+         if Is_Config_File then\n             Error_Msg\n               (\"no package renames in configuration projects\", Token_Ptr);\n          end if;\n@@ -1216,7 +1232,8 @@ package body Prj.Dect is\n             First_Attribute   => First_Attribute,\n             Current_Project   => Current_Project,\n             Current_Package   => Package_Declaration,\n-            Packages_To_Check => Packages_To_Check);\n+            Packages_To_Check => Packages_To_Check,\n+            Is_Config_File    => Is_Config_File);\n \n          Set_First_Declarative_Item_Of\n            (Package_Declaration, In_Tree, To => First_Declarative_Item);"}, {"sha": "d5a592daae75fd78dc277a269d6fe471d8eee06a", "filename": "gcc/ada/prj-dect.ads", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906/gcc%2Fada%2Fprj-dect.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906/gcc%2Fada%2Fprj-dect.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-dect.ads?ref=bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906", "patch": "@@ -34,7 +34,8 @@ private package Prj.Dect is\n       Declarations      : out Prj.Tree.Project_Node_Id;\n       Current_Project   : Prj.Tree.Project_Node_Id;\n       Extends           : Prj.Tree.Project_Node_Id;\n-      Packages_To_Check : String_List_Access);\n+      Packages_To_Check : String_List_Access;\n+      Is_Config_File    : Boolean);\n    --  Parse project declarative items\n    --\n    --  In_Tree is the project node tree\n@@ -52,5 +53,8 @@ private package Prj.Dect is\n    --  For legal packages declared in project Current_Project that are not in\n    --  Packages_To_Check, only the syntax of the declarations are checked, not\n    --  the attribute names and kinds.\n+   --\n+   --  Is_Config_File should be set to True if the project represents a config\n+   --  file (.cgpr) since some specific checks apply.\n \n end Prj.Dect;"}, {"sha": "7ae8c3d9a219a7112767abea77877f438dae379d", "filename": "gcc/ada/prj-makr.adb", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906/gcc%2Fada%2Fprj-makr.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906/gcc%2Fada%2Fprj-makr.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-makr.adb?ref=bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 B o d y                                  --\n --                                                                          --\n---          Copyright (C) 2001-2008, Free Software Foundation, Inc.         --\n+--          Copyright (C) 2001-2009, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -845,6 +845,7 @@ package body Prj.Makr is\n                Project_File_Name      => Output_Name.all,\n                Always_Errout_Finalize => False,\n                Store_Comments         => True,\n+               Is_Config_File         => False,\n                Current_Directory      => Get_Current_Dir,\n                Packages_To_Check      => Packages_To_Check_By_Gnatname);\n "}, {"sha": "5a76d397a291c9bdee862d43c9a31be95280b608", "filename": "gcc/ada/prj-nmsc.adb", "status": "modified", "additions": 13, "deletions": 9, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906/gcc%2Fada%2Fprj-nmsc.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906/gcc%2Fada%2Fprj-nmsc.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-nmsc.adb?ref=bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906", "patch": "@@ -273,9 +273,11 @@ package body Prj.Nmsc is\n    --  Check that a name is a valid Ada unit name\n \n    procedure Check_Naming_Schemes\n-     (Project : Project_Id;\n-      In_Tree : Project_Tree_Ref);\n-   --  Check the naming scheme part of Data\n+     (Project        : Project_Id;\n+      In_Tree        : Project_Tree_Ref;\n+      Is_Config_File : Boolean);\n+   --  Check the naming scheme part of Data.\n+   --  Is_Config_File should be True if Project is a config file (.cgpr)\n \n    procedure Check_Configuration\n      (Project : Project_Id;\n@@ -788,7 +790,8 @@ package body Prj.Nmsc is\n       Report_Error    : Put_Line_Access;\n       When_No_Sources : Error_Warning;\n       Current_Dir     : String;\n-      Proc_Data       : in out Processing_Data)\n+      Proc_Data       : in out Processing_Data;\n+      Is_Config_File  : Boolean)\n    is\n       Extending : Boolean := False;\n \n@@ -836,7 +839,7 @@ package body Prj.Nmsc is\n \n       Extending := Project.Extends /= No_Project;\n \n-      Check_Naming_Schemes (Project, In_Tree);\n+      Check_Naming_Schemes (Project, In_Tree, Is_Config_File);\n \n       if Get_Mode = Ada_Only then\n          Prepare_Ada_Naming_Exceptions\n@@ -2635,8 +2638,9 @@ package body Prj.Nmsc is\n    --------------------------\n \n    procedure Check_Naming_Schemes\n-     (Project : Project_Id;\n-      In_Tree : Project_Tree_Ref)\n+     (Project        : Project_Id;\n+      In_Tree        : Project_Tree_Ref;\n+      Is_Config_File : Boolean)\n    is\n       Naming_Id : constant Package_Id :=\n                    Util.Value_Of (Name_Naming, Project.Decl.Packages, In_Tree);\n@@ -3316,7 +3320,7 @@ package body Prj.Nmsc is\n    begin\n       --  No Naming package or parsing a configuration file? nothing to do\n \n-      if Naming_Id /= No_Package and not In_Configuration then\n+      if Naming_Id /= No_Package and not Is_Config_File then\n          Naming := In_Tree.Packages.Table (Naming_Id);\n \n          if Current_Verbosity = High then\n@@ -4366,7 +4370,7 @@ package body Prj.Nmsc is\n                      Error_Msg\n                        (Project,\n                         In_Tree,\n-                        \"a standard project cannot have no language declared\",\n+                        \"a standard project must have at least one language\",\n                         Languages.Location);\n                   end if;\n "}, {"sha": "7728d766b4bea3aa1debfa30075f18fb067140b1", "filename": "gcc/ada/prj-nmsc.ads", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906/gcc%2Fada%2Fprj-nmsc.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906/gcc%2Fada%2Fprj-nmsc.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-nmsc.ads?ref=bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906", "patch": "@@ -46,7 +46,8 @@ private package Prj.Nmsc is\n       Report_Error    : Put_Line_Access;\n       When_No_Sources : Error_Warning;\n       Current_Dir     : String;\n-      Proc_Data       : in out Processing_Data);\n+      Proc_Data       : in out Processing_Data;\n+      Is_Config_File  : Boolean);\n    --  Perform consistency and semantic checks on a project, starting from the\n    --  project tree parsed from the .gpr file. This procedure interprets the\n    --  various case statements in the project based on the current environment\n@@ -68,6 +69,8 @@ private package Prj.Nmsc is\n    --\n    --  When_No_Sources indicates what should be done when no sources of a\n    --  language are found in a project where this language is declared.\n+   --\n+   --  Is_Config_File should be True if Project is config file (.cgpr)\n \n private\n    type Processing_Data is record"}, {"sha": "86f47ec67d26fbeb7dbc8f61bc9ce1bd820dcc8e", "filename": "gcc/ada/prj-pars.adb", "status": "modified", "additions": 7, "deletions": 4, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906/gcc%2Fada%2Fprj-pars.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906/gcc%2Fada%2Fprj-pars.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-pars.adb?ref=bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 B o d y                                  --\n --                                                                          --\n---          Copyright (C) 2001-2008, Free Software Foundation, Inc.         --\n+--          Copyright (C) 2001-2009, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -45,7 +45,8 @@ package body Prj.Pars is\n       Project_File_Name : String;\n       Packages_To_Check : String_List_Access := All_Packages;\n       When_No_Sources   : Error_Warning := Error;\n-      Reset_Tree        : Boolean := True)\n+      Reset_Tree        : Boolean := True;\n+      Is_Config_File    : Boolean)\n    is\n       Project_Node_Tree : constant Project_Node_Tree_Ref :=\n                             new Project_Node_Tree_Data;\n@@ -66,7 +67,8 @@ package body Prj.Pars is\n          Project_File_Name      => Project_File_Name,\n          Always_Errout_Finalize => False,\n          Packages_To_Check      => Packages_To_Check,\n-         Current_Directory      => Current_Dir);\n+         Current_Directory      => Current_Dir,\n+         Is_Config_File         => Is_Config_File);\n \n       --  If there were no error, process the tree\n \n@@ -80,7 +82,8 @@ package body Prj.Pars is\n             Report_Error           => null,\n             When_No_Sources        => When_No_Sources,\n             Reset_Tree             => Reset_Tree,\n-            Current_Dir            => Current_Dir);\n+            Current_Dir            => Current_Dir,\n+            Is_Config_File         => Is_Config_File);\n          Prj.Err.Finalize;\n \n          if not Success then"}, {"sha": "02f149131a9c1a4e544b5a1a7a20e029333303e9", "filename": "gcc/ada/prj-pars.ads", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906/gcc%2Fada%2Fprj-pars.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906/gcc%2Fada%2Fprj-pars.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-pars.ads?ref=bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 S p e c                                  --\n --                                                                          --\n---          Copyright (C) 2000-2007, Free Software Foundation, Inc.         --\n+--          Copyright (C) 2000-2009, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -36,7 +36,8 @@ package Prj.Pars is\n       Project_File_Name : String;\n       Packages_To_Check : String_List_Access := All_Packages;\n       When_No_Sources   : Error_Warning := Error;\n-      Reset_Tree        : Boolean := True);\n+      Reset_Tree        : Boolean := True;\n+      Is_Config_File    : Boolean);\n    --  Parse a project files and all its imported project files, in the\n    --  project tree In_Tree.\n    --\n@@ -53,5 +54,8 @@ package Prj.Pars is\n    --\n    --  When Reset_Tree is True, all the project data are removed from the\n    --  project table before processing.\n+   --\n+   --  Is_Config_File should be set to True if the project represents a config\n+   --  file (.cgpr) since some specific checks apply.\n \n end Prj.Pars;"}, {"sha": "1390f476737b32af730a47178f33b65277b25569", "filename": "gcc/ada/prj-part.adb", "status": "modified", "additions": 54, "deletions": 27, "changes": 81, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906/gcc%2Fada%2Fprj-part.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906/gcc%2Fada%2Fprj-part.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-part.adb?ref=bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 B o d y                                  --\n --                                                                          --\n---          Copyright (C) 2001-2008, Free Software Foundation, Inc.         --\n+--          Copyright (C) 2001-2009, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -164,21 +164,28 @@ package body Prj.Part is\n       In_Limited        : Boolean;\n       Packages_To_Check : String_List_Access;\n       Depth             : Natural;\n-      Current_Dir       : String);\n+      Current_Dir       : String;\n+      Is_Config_File    : Boolean);\n    --  Parse a project file. This is a recursive procedure: it calls itself for\n    --  imported and extended projects. When From_Extended is not None, if the\n    --  project has already been parsed and is an extended project A, return the\n    --  ultimate (not extended) project that extends A. When In_Limited is True,\n    --  the importing path includes at least one \"limited with\". When parsing\n    --  configuration projects, do not allow a depth > 1.\n+   --\n+   --  Is_Config_File should be set to True if the project represents a config\n+   --  file (.cgpr) since some specific checks apply.\n \n    procedure Pre_Parse_Context_Clause\n      (In_Tree        : Project_Node_Tree_Ref;\n-      Context_Clause : out With_Id);\n+      Context_Clause : out With_Id;\n+      Is_Config_File : Boolean);\n    --  Parse the context clause of a project. Store the paths and locations of\n    --  the imported projects in table Withs. Does nothing if there is no\n    --  context clause (if the current token is not \"with\" or \"limited\" followed\n    --  by \"with\").\n+   --  Is_Config_File should be set to True if the project represents a config\n+   --  file (.cgpr) since some specific checks apply.\n \n    procedure Post_Parse_Context_Clause\n      (Context_Clause    : With_Id;\n@@ -190,13 +197,16 @@ package body Prj.Part is\n       In_Limited        : Boolean;\n       Packages_To_Check : String_List_Access;\n       Depth             : Natural;\n-      Current_Dir       : String);\n+      Current_Dir       : String;\n+      Is_Config_File    : Boolean);\n    --  Parse the imported projects that have been stored in table Withs, if\n    --  any. From_Extended is used for the call to Parse_Single_Project below.\n    --  When In_Limited is True, the importing path includes at least one\n    --  \"limited with\". When Limited_Withs is False, only non limited withed\n    --  projects are parsed. When Limited_Withs is True, only limited withed\n    --  projects are parsed.\n+   --  Is_Config_File should be set to True if the project represents a config\n+   --  file (.cgpr) since some specific checks apply.\n \n    function Project_Path_Name_Of\n      (Project_File_Name : String;\n@@ -210,7 +220,9 @@ package body Prj.Part is\n    --  This includes the directory separator as the last character.\n    --  Returns \"./\" if Path_Name contains no directory separator.\n \n-   function Project_Name_From (Path_Name : String) return Name_Id;\n+   function Project_Name_From\n+     (Path_Name      : String;\n+      Is_Config_File : Boolean) return Name_Id;\n    --  Returns the name of the project that corresponds to its path name.\n    --  Returns No_Name if the path name is invalid, because the corresponding\n    --  project name does not have the syntax of an ada identifier.\n@@ -475,7 +487,8 @@ package body Prj.Part is\n       Always_Errout_Finalize : Boolean;\n       Packages_To_Check      : String_List_Access := All_Packages;\n       Store_Comments         : Boolean := False;\n-      Current_Directory      : String := \"\")\n+      Current_Directory      : String := \"\";\n+      Is_Config_File         : Boolean)\n    is\n       Dummy : Boolean;\n       pragma Warnings (Off, Dummy);\n@@ -533,7 +546,8 @@ package body Prj.Part is\n             In_Limited        => False,\n             Packages_To_Check => Packages_To_Check,\n             Depth             => 0,\n-            Current_Dir       => Current_Directory);\n+            Current_Dir       => Current_Directory,\n+            Is_Config_File    => Is_Config_File);\n \n          --  If Project is an extending-all project, create the eventual\n          --  virtual extending projects and check that there are no illegally\n@@ -642,7 +656,8 @@ package body Prj.Part is\n \n    procedure Pre_Parse_Context_Clause\n      (In_Tree        : Project_Node_Tree_Ref;\n-      Context_Clause : out With_Id)\n+      Context_Clause : out With_Id;\n+      Is_Config_File : Boolean)\n    is\n       Current_With_Clause : With_Id := No_With;\n       Limited_With        : Boolean := False;\n@@ -663,7 +678,7 @@ package body Prj.Part is\n            Default_Project_Node (Of_Kind => N_With_Clause, In_Tree => In_Tree);\n          Limited_With := Token = Tok_Limited;\n \n-         if In_Configuration then\n+         if Is_Config_File then\n             Error_Msg\n               (\"configuration project cannot import \" &\n                \"other configuration projects\",\n@@ -747,7 +762,8 @@ package body Prj.Part is\n       In_Limited        : Boolean;\n       Packages_To_Check : String_List_Access;\n       Depth             : Natural;\n-      Current_Dir       : String)\n+      Current_Dir       : String;\n+      Is_Config_File    : Boolean)\n    is\n       Current_With_Clause : With_Id := Context_Clause;\n \n@@ -886,7 +902,8 @@ package body Prj.Part is\n                         In_Limited        => Limited_Withs,\n                         Packages_To_Check => Packages_To_Check,\n                         Depth             => Depth,\n-                        Current_Dir       => Current_Dir);\n+                        Current_Dir       => Current_Dir,\n+                        Is_Config_File    => Is_Config_File);\n \n                   else\n                      Extends_All := Is_Extending_All (Withed_Project, In_Tree);\n@@ -947,7 +964,8 @@ package body Prj.Part is\n       In_Limited        : Boolean;\n       Packages_To_Check : String_List_Access;\n       Depth             : Natural;\n-      Current_Dir       : String)\n+      Current_Dir       : String;\n+      Is_Config_File    : Boolean)\n    is\n       Normed_Path_Name    : Path_Name_Type;\n       Canonical_Path_Name : Path_Name_Type;\n@@ -963,7 +981,8 @@ package body Prj.Part is\n                                   Tree_Private_Part.Projects_Htable.Get_First\n                                     (In_Tree.Projects_HT);\n \n-      Name_From_Path  : constant Name_Id := Project_Name_From (Path_Name);\n+      Name_From_Path  : constant Name_Id :=\n+        Project_Name_From (Path_Name, Is_Config_File => Is_Config_File);\n       Name_Of_Project : Name_Id := No_Name;\n \n       Duplicated : Boolean := False;\n@@ -1124,7 +1143,7 @@ package body Prj.Part is\n       Tree.Reset_State;\n       Scan (In_Tree);\n \n-      if not In_Configuration and then Name_From_Path = No_Name then\n+      if not Is_Config_File and then Name_From_Path = No_Name then\n \n          --  The project file name is not correct (no or bad extension, or not\n          --  following Ada identifier's syntax).\n@@ -1147,6 +1166,7 @@ package body Prj.Part is\n \n       Pre_Parse_Context_Clause\n         (In_Tree        => In_Tree,\n+         Is_Config_File => Is_Config_File,\n          Context_Clause => First_With);\n \n       Project := Default_Project_Node\n@@ -1185,7 +1205,7 @@ package body Prj.Part is\n                Scan (In_Tree);\n \n             when Snames.Name_Configuration =>\n-               if not In_Configuration then\n+               if not Is_Config_File then\n                   Error_Msg (\"configuration projects cannot belong to a user\" &\n                              \" project tree\",\n                              Token_Ptr);\n@@ -1199,7 +1219,7 @@ package body Prj.Part is\n       end if;\n \n       if Proj_Qualifier /= Unspecified then\n-         if In_Configuration then\n+         if Is_Config_File then\n             Error_Msg (\"a configuration project cannot be qualified except \" &\n                        \"as configuration project\",\n                        Qualifier_Location);\n@@ -1257,7 +1277,7 @@ package body Prj.Part is\n \n       if Token = Tok_Extends then\n \n-         if In_Configuration then\n+         if Is_Config_File then\n             Error_Msg\n               (\"extending configuration project not allowed\", Token_Ptr);\n          end if;\n@@ -1310,13 +1330,13 @@ package body Prj.Part is\n          begin\n             --  Output a warning if the actual name is not the expected name\n \n-            if not In_Configuration\n+            if not Is_Config_File\n               and then (Name_From_Path /= No_Name)\n               and then Expected_Name /= Name_From_Path\n             then\n                Error_Msg_Name_1 := Expected_Name;\n \n-               if In_Configuration then\n+               if Is_Config_File then\n                   Extension := new String'(Config_Project_File_Extension);\n \n                else\n@@ -1355,11 +1375,12 @@ package body Prj.Part is\n                In_Limited        => In_Limited,\n                Packages_To_Check => Packages_To_Check,\n                Depth             => Depth + 1,\n-               Current_Dir       => Current_Dir);\n+               Current_Dir       => Current_Dir,\n+               Is_Config_File    => Is_Config_File);\n             Set_First_With_Clause_Of (Project, In_Tree, Imported_Projects);\n          end;\n \n-         if not In_Configuration then\n+         if not Is_Config_File then\n             declare\n                Name_And_Node : Tree_Private_Part.Project_Name_And_Node :=\n                                  Tree_Private_Part.Projects_Htable.Get_First\n@@ -1460,7 +1481,8 @@ package body Prj.Part is\n                         In_Limited        => In_Limited,\n                         Packages_To_Check => Packages_To_Check,\n                         Depth             => Depth + 1,\n-                        Current_Dir       => Current_Dir);\n+                        Current_Dir       => Current_Dir,\n+                        Is_Config_File    => Is_Config_File);\n                   end;\n \n                   if Present (Extended_Project) then\n@@ -1596,7 +1618,8 @@ package body Prj.Part is\n             Declarations      => Project_Declaration,\n             Current_Project   => Project,\n             Extends           => Extended_Project,\n-            Packages_To_Check => Packages_To_Check);\n+            Packages_To_Check => Packages_To_Check,\n+            Is_Config_File    => Is_Config_File);\n          Set_Project_Declaration_Of (Project, In_Tree, Project_Declaration);\n \n          if Present (Extended_Project)\n@@ -1717,7 +1740,8 @@ package body Prj.Part is\n             In_Limited        => In_Limited,\n             Packages_To_Check => Packages_To_Check,\n             Depth             => Depth + 1,\n-            Current_Dir       => Current_Dir);\n+            Current_Dir       => Current_Dir,\n+            Is_Config_File    => Is_Config_File);\n          Set_First_With_Clause_Of (Project, In_Tree, Imported_Projects);\n       end;\n \n@@ -1745,7 +1769,10 @@ package body Prj.Part is\n    -- Project_Name_From --\n    -----------------------\n \n-   function Project_Name_From (Path_Name : String) return Name_Id is\n+   function Project_Name_From\n+     (Path_Name      : String;\n+      Is_Config_File : Boolean) return Name_Id\n+   is\n       Canonical : String (1 .. Path_Name'Length) := Path_Name;\n       First     : Natural := Canonical'Last;\n       Last      : Natural := First;\n@@ -1778,11 +1805,11 @@ package body Prj.Part is\n       --  If we have a dot, check that it is followed by the correct extension\n \n       if First > 0 and then Canonical (First) = '.' then\n-         if (not In_Configuration\n+         if (not Is_Config_File\n               and then Canonical (First .. Last) = Project_File_Extension\n               and then First /= 1)\n            or else\n-             (In_Configuration\n+             (Is_Config_File\n                and then\n                  Canonical (First .. Last) = Config_Project_File_Extension\n                and then First /= 1)"}, {"sha": "3906ad7cb613814cb1cacb02c31a8eb70c8800f2", "filename": "gcc/ada/prj-part.ads", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906/gcc%2Fada%2Fprj-part.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906/gcc%2Fada%2Fprj-part.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-part.ads?ref=bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 S p e c                                  --\n --                                                                          --\n---          Copyright (C) 2000-2008, Free Software Foundation, Inc.         --\n+--          Copyright (C) 2000-2009, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -36,7 +36,8 @@ package Prj.Part is\n       Always_Errout_Finalize : Boolean;\n       Packages_To_Check      : String_List_Access := All_Packages;\n       Store_Comments         : Boolean := False;\n-      Current_Directory      : String := \"\");\n+      Current_Directory      : String := \"\";\n+      Is_Config_File         : Boolean);\n    --  Parse project file and all its imported project files and create a tree.\n    --  Return the node for the project (or Empty_Node if parsing failed). If\n    --  Always_Errout_Finalize is True, Errout.Finalize is called in all cases,\n@@ -48,5 +49,8 @@ package Prj.Part is\n    --\n    --  Current_Directory is used for optimization purposes only, avoiding extra\n    --  system calls.\n+   --\n+   --  Is_Config_File should be set to True if the project represents a config\n+   --  file (.cgpr) since some specific checks apply.\n \n end Prj.Part;"}, {"sha": "b302972732bd2faa16df23866a15df596098014e", "filename": "gcc/ada/prj-proc.adb", "status": "modified", "additions": 18, "deletions": 8, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906/gcc%2Fada%2Fprj-proc.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906/gcc%2Fada%2Fprj-proc.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-proc.adb?ref=bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906", "patch": "@@ -82,10 +82,12 @@ package body Prj.Proc is\n      (In_Tree         : Project_Tree_Ref;\n       Project         : Project_Id;\n       Current_Dir     : String;\n-      When_No_Sources : Error_Warning);\n+      When_No_Sources : Error_Warning;\n+      Is_Config_File  : Boolean);\n    --  Set all projects to not checked, then call Recursive_Check for the\n    --  main project Project. Project is set to No_Project if errors occurred.\n    --  Current_Dir is for optimization purposes, avoiding extra system calls.\n+   --  Is_Config_File should be True if Project is a config file (.cgpr)\n \n    procedure Copy_Package_Declarations\n      (From              : Declarations;\n@@ -149,6 +151,7 @@ package body Prj.Proc is\n       Current_Dir     : String_Access;\n       When_No_Sources : Error_Warning;\n       Proc_Data       : Processing_Data;\n+      Is_Config_File  : Boolean;\n    end record;\n    --  Data passed to Recursive_Check\n    --  Current_Dir is for optimization purposes, avoiding extra system calls.\n@@ -279,7 +282,8 @@ package body Prj.Proc is\n      (In_Tree         : Project_Tree_Ref;\n       Project         : Project_Id;\n       Current_Dir     : String;\n-      When_No_Sources : Error_Warning)\n+      When_No_Sources : Error_Warning;\n+      Is_Config_File  : Boolean)\n    is\n       Dir : aliased String := Current_Dir;\n \n@@ -292,6 +296,7 @@ package body Prj.Proc is\n       Data.In_Tree         := In_Tree;\n       Data.Current_Dir     := Dir'Unchecked_Access;\n       Data.When_No_Sources := When_No_Sources;\n+      Data.Is_Config_File  := Is_Config_File;\n       Initialize (Data.Proc_Data);\n \n       Check_All_Projects (Project, Data, Imported_First => True);\n@@ -1231,7 +1236,8 @@ package body Prj.Proc is\n       Report_Error           : Put_Line_Access;\n       When_No_Sources        : Error_Warning := Error;\n       Reset_Tree             : Boolean := True;\n-      Current_Dir            : String := \"\")\n+      Current_Dir            : String := \"\";\n+      Is_Config_File         : Boolean)\n    is\n    begin\n       Process_Project_Tree_Phase_1\n@@ -1243,7 +1249,7 @@ package body Prj.Proc is\n          Report_Error           => Report_Error,\n          Reset_Tree             => Reset_Tree);\n \n-      if not In_Configuration then\n+      if not Is_Config_File then\n          Process_Project_Tree_Phase_2\n            (In_Tree                => In_Tree,\n             Project                => Project,\n@@ -1252,7 +1258,8 @@ package body Prj.Proc is\n             From_Project_Node_Tree => From_Project_Node_Tree,\n             Report_Error           => Report_Error,\n             When_No_Sources        => When_No_Sources,\n-            Current_Dir            => Current_Dir);\n+            Current_Dir            => Current_Dir,\n+            Is_Config_File         => Is_Config_File);\n       end if;\n    end Process;\n \n@@ -2305,7 +2312,8 @@ package body Prj.Proc is\n       From_Project_Node_Tree : Project_Node_Tree_Ref;\n       Report_Error           : Put_Line_Access;\n       When_No_Sources        : Error_Warning := Error;\n-      Current_Dir            : String)\n+      Current_Dir            : String;\n+      Is_Config_File         : Boolean)\n    is\n       Obj_Dir    : Path_Name_Type;\n       Extending  : Project_Id;\n@@ -2319,7 +2327,8 @@ package body Prj.Proc is\n       Success := True;\n \n       if Project /= No_Project then\n-         Check (In_Tree, Project, Current_Dir, When_No_Sources);\n+         Check (In_Tree, Project, Current_Dir, When_No_Sources,\n+                Is_Config_File => Is_Config_File);\n       end if;\n \n       --  If main project is an extending all project, set the object\n@@ -2442,7 +2451,8 @@ package body Prj.Proc is\n \n       Prj.Nmsc.Check\n         (Project, Data.In_Tree, Error_Report, Data.When_No_Sources,\n-         Data.Current_Dir.all, Data.Proc_Data);\n+         Data.Current_Dir.all, Data.Proc_Data,\n+         Is_Config_File => Data.Is_Config_File);\n    end Recursive_Check;\n \n    -----------------------"}, {"sha": "f95f210a50ea7f1069af877bf74a2591a89bce7b", "filename": "gcc/ada/prj-proc.ads", "status": "modified", "additions": 7, "deletions": 3, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906/gcc%2Fada%2Fprj-proc.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906/gcc%2Fada%2Fprj-proc.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-proc.ads?ref=bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906", "patch": "@@ -40,7 +40,8 @@ package Prj.Proc is\n       Report_Error           : Put_Line_Access;\n       When_No_Sources        : Error_Warning := Error;\n       Reset_Tree             : Boolean := True;\n-      Current_Dir            : String := \"\");\n+      Current_Dir            : String := \"\";\n+      Is_Config_File         : Boolean);\n    --  Process a project file tree into project file data structures. If\n    --  Report_Error is null, use the error reporting mechanism. Otherwise,\n    --  report errors using Report_Error.\n@@ -54,10 +55,12 @@ package Prj.Proc is\n    --  project table before processing.\n    --\n    --  Process is a bit of a junk name, how about Process_Project_Tree???\n-\n+   --\n    --  The two procedures that follow are implementing procedure Process in\n    --  two successive phases. They are used by gprbuild/gprclean to add the\n    --  configuration attributes between the two phases.\n+   --\n+   --  Is_Config_File should be true if Project is a config file (.cgpr)\n \n    procedure Process_Project_Tree_Phase_1\n      (In_Tree                : Project_Tree_Ref;\n@@ -77,7 +80,8 @@ package Prj.Proc is\n       From_Project_Node_Tree : Project_Node_Tree_Ref;\n       Report_Error           : Put_Line_Access;\n       When_No_Sources        : Error_Warning := Error;\n-      Current_Dir            : String);\n+      Current_Dir            : String;\n+      Is_Config_File         : Boolean);\n    --  See documentation of parameters in procedure Process above\n \n end Prj.Proc;"}, {"sha": "30f40fb0035056967da7f3347f778f64a27d9dd6", "filename": "gcc/ada/prj.adb", "status": "modified", "additions": 0, "deletions": 20, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906/gcc%2Fada%2Fprj.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906/gcc%2Fada%2Fprj.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj.adb?ref=bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906", "patch": "@@ -49,8 +49,6 @@ package body Prj is\n \n    Current_Mode : Mode := Ada_Only;\n \n-   Configuration_Mode : Boolean := False;\n-\n    The_Empty_String : Name_Id;\n \n    Default_Ada_Spec_Suffix_Id : File_Name_Type;\n@@ -600,15 +598,6 @@ package body Prj is\n       return The_Casing_Images (Casing).all;\n    end Image;\n \n-   ----------------------\n-   -- In_Configuration --\n-   ----------------------\n-\n-   function In_Configuration return Boolean is\n-   begin\n-      return Configuration_Mode;\n-   end In_Configuration;\n-\n    ----------------\n    -- Initialize --\n    ----------------\n@@ -1059,15 +1048,6 @@ package body Prj is\n       In_Tree.Array_Elements.Table (Naming.Body_Suffix) := Element;\n    end Set_Body_Suffix;\n \n-   --------------------------\n-   -- Set_In_Configuration --\n-   --------------------------\n-\n-   procedure Set_In_Configuration (Value : Boolean) is\n-   begin\n-      Configuration_Mode := Value;\n-   end Set_In_Configuration;\n-\n    --------------\n    -- Set_Mode --\n    --------------"}, {"sha": "c08abf5dd213e51b7f3592c05ede0f1aedf829a8", "filename": "gcc/ada/prj.ads", "status": "modified", "additions": 2, "deletions": 7, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906/gcc%2Fada%2Fprj.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906/gcc%2Fada%2Fprj.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj.ads?ref=bd0a4cabe3f07ec4751ac3cecd4e35bfa2ca0906", "patch": "@@ -99,12 +99,6 @@ package Prj is\n    --  can ignore such errors when they don't need to build directly. Calling\n    --  Set_Mode will reset this variable, default is for Ada_Only.\n \n-   function In_Configuration return Boolean;\n-   pragma Inline (In_Configuration);\n-\n-   procedure Set_In_Configuration (Value : Boolean);\n-   pragma Inline (Set_In_Configuration);\n-\n    All_Packages : constant String_List_Access;\n    --  Default value of parameter Packages of procedures Parse, in Prj.Pars and\n    --  Prj.Part, indicating that all packages should be checked.\n@@ -1121,7 +1115,8 @@ package Prj is\n       Config : Project_Configuration;\n \n       Path : Path_Information := No_Path_Information;\n-      --  The path name of the project file\n+      --  The path name of the project file. This include base name of the\n+      --  project file\n \n       Virtual : Boolean := False;\n       --  True for virtual extending projects"}]}