{"sha": "75b41faa236ff0bbedf0cfe7de92d0092fd38757", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzViNDFmYWEyMzZmZjBiYmVkZjBjZmU3ZGU5MmQwMDkyZmQzODc1Nw==", "commit": {"author": {"name": "Paolo Carlini", "email": "paolo.carlini@oracle.com", "date": "2019-07-08T09:51:07Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2019-07-08T09:51:07Z"}, "message": "re PR c++/65143 ([C++11] missing devirtualization for virtual base in  \"final\" classes)\n\n2019-07-08  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/65143\n\t* g++.dg/tree-ssa/final2.C: New.\n\t* g++.dg/tree-ssa/final3.C: Likewise.\n\nFrom-SVN: r273228", "tree": {"sha": "cdb8044b11c020edd8da777353a2d277d2b9d6f5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/cdb8044b11c020edd8da777353a2d277d2b9d6f5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/75b41faa236ff0bbedf0cfe7de92d0092fd38757", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/75b41faa236ff0bbedf0cfe7de92d0092fd38757", "html_url": "https://github.com/Rust-GCC/gccrs/commit/75b41faa236ff0bbedf0cfe7de92d0092fd38757", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/75b41faa236ff0bbedf0cfe7de92d0092fd38757/comments", "author": null, "committer": null, "parents": [{"sha": "9118c5e1a3a58f41bddc14ae078c5857c7a24f03", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9118c5e1a3a58f41bddc14ae078c5857c7a24f03", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9118c5e1a3a58f41bddc14ae078c5857c7a24f03"}], "stats": {"total": 64, "additions": 64, "deletions": 0}, "files": [{"sha": "61150ea17ba7b5b313f39fa05916c1402d3226c3", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/75b41faa236ff0bbedf0cfe7de92d0092fd38757/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/75b41faa236ff0bbedf0cfe7de92d0092fd38757/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=75b41faa236ff0bbedf0cfe7de92d0092fd38757", "patch": "@@ -1,3 +1,9 @@\n+2019-07-08  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/65143\n+\t* g++.dg/tree-ssa/final2.C: New.\n+\t* g++.dg/tree-ssa/final3.C: Likewise.\n+\n 2019-07-08  Javier Miranda  <miranda@adacore.com>\n \n \t* gnat.dg/interface10.adb: New testcase."}, {"sha": "b0fc8603a3d98c82390717fbc01eae0c6b57a905", "filename": "gcc/testsuite/g++.dg/tree-ssa/final2.C", "status": "added", "additions": 35, "deletions": 0, "changes": 35, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/75b41faa236ff0bbedf0cfe7de92d0092fd38757/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftree-ssa%2Ffinal2.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/75b41faa236ff0bbedf0cfe7de92d0092fd38757/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftree-ssa%2Ffinal2.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftree-ssa%2Ffinal2.C?ref=75b41faa236ff0bbedf0cfe7de92d0092fd38757", "patch": "@@ -0,0 +1,35 @@\n+// PR c++/65143\n+// { dg-do compile { target c++11 } }\n+// { dg-additional-options -fdump-tree-gimple }\n+// { dg-final { scan-tree-dump-times \"vptr\" 1 gimple } }\n+\n+struct A\n+{\n+  int i();\n+};\n+\n+struct B : public virtual A\n+{\n+  int get()\n+  {\n+    return A::i() + 1;\n+  }\n+};\n+\n+struct C final : public B\n+{\n+  int get()\n+  {\n+    return A::i() + 2;\n+  }\n+};\n+\n+int foo(C& c)\n+{  \n+  return c.get(); // Need not go via vtable pointer as class C is final\n+}\n+\n+int foo(B& b2)\n+{\n+  return b2.get(); // This has to go via vtable as most derived class can change the location of A\n+}"}, {"sha": "9489fc12c8cb90b02d45bf437dc2a512f9dcfc59", "filename": "gcc/testsuite/g++.dg/tree-ssa/final3.C", "status": "added", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/75b41faa236ff0bbedf0cfe7de92d0092fd38757/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftree-ssa%2Ffinal3.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/75b41faa236ff0bbedf0cfe7de92d0092fd38757/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftree-ssa%2Ffinal3.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftree-ssa%2Ffinal3.C?ref=75b41faa236ff0bbedf0cfe7de92d0092fd38757", "patch": "@@ -0,0 +1,23 @@\n+// PR c++/65143\n+// { dg-do compile { target c++11 } }\n+// { dg-additional-options -fdump-tree-gimple }\n+// { dg-final { scan-tree-dump-not \"vptr\" gimple } }\n+\n+struct A\n+{\n+    int j;\n+};\n+\n+struct B : public virtual A\n+{\n+};\n+\n+struct C final : public B\n+{\n+    int get();\n+};\n+\n+int C::get()\n+{\n+    return A::j;\n+}"}]}