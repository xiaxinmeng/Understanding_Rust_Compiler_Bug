{"sha": "038ec4b7b90f6278e686d61634cb046cd09d3b8f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDM4ZWM0YjdiOTBmNjI3OGU2ODZkNjE2MzRjYjA0NmNkMDlkM2I4Zg==", "commit": {"author": {"name": "Andi Kleen", "email": "ak@linux.intel.com", "date": "2016-07-14T02:14:02Z"}, "committer": {"name": "Andi Kleen", "email": "ak@gcc.gnu.org", "date": "2016-07-14T02:14:02Z"}, "message": "Don't run instrumented value profiler changes with afdo\n\nThe pass to transform gimple based on value profiling runs with autofdo\non, but currently every transformation fails. For indirect calls autofdo\ndoes it on its own, and it doesn't suppport other value profiling. So don't\nrun this pass when autofdo is active. This also avoids bogus\ndump file entries.\n\ngcc/:\n\n2016-07-13  Andi Kleen  <ak@linux.intel.com>\n\n\t* value-prof.c (gimple_value_profile_transformations): Don't run\n\twhen auto_profile is on.\n\nFrom-SVN: r238321", "tree": {"sha": "176c06c787d25806a113c92e1a36e48970b573d5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/176c06c787d25806a113c92e1a36e48970b573d5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/038ec4b7b90f6278e686d61634cb046cd09d3b8f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/038ec4b7b90f6278e686d61634cb046cd09d3b8f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/038ec4b7b90f6278e686d61634cb046cd09d3b8f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/038ec4b7b90f6278e686d61634cb046cd09d3b8f/comments", "author": null, "committer": null, "parents": [{"sha": "0ea221ef245cd19b2308fdfa497d49156e1b801d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0ea221ef245cd19b2308fdfa497d49156e1b801d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0ea221ef245cd19b2308fdfa497d49156e1b801d"}], "stats": {"total": 11, "additions": 11, "deletions": 0}, "files": [{"sha": "134db049278c76744da1fad46dfd01dabc0c73a6", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/038ec4b7b90f6278e686d61634cb046cd09d3b8f/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/038ec4b7b90f6278e686d61634cb046cd09d3b8f/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=038ec4b7b90f6278e686d61634cb046cd09d3b8f", "patch": "@@ -1,3 +1,8 @@\n+2016-07-13  Andi Kleen  <ak@linux.intel.com>\n+\n+\t* value-prof.c (gimple_value_profile_transformations): Don't run\n+\twhen auto_profile is on.\n+\n 2016-07-13  Andi Kleen  <ak@linux.intel.com>\n \n \t* auto-profile.c (update_inlined_ind_target,"}, {"sha": "2976a86c7941b3cbb21452354fc2357f9dbf9084", "filename": "gcc/value-prof.c", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/038ec4b7b90f6278e686d61634cb046cd09d3b8f/gcc%2Fvalue-prof.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/038ec4b7b90f6278e686d61634cb046cd09d3b8f/gcc%2Fvalue-prof.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fvalue-prof.c?ref=038ec4b7b90f6278e686d61634cb046cd09d3b8f", "patch": "@@ -645,6 +645,12 @@ gimple_value_profile_transformations (void)\n   basic_block bb;\n   gimple_stmt_iterator gsi;\n   bool changed = false;\n+\n+  /* Autofdo does its own transformations for indirect calls,\n+     and otherwise does not support value profiling.  */\n+  if (flag_auto_profile)\n+    return false;\n+\n   FOR_EACH_BB_FN (bb, cfun)\n     {\n       for (gsi = gsi_start_bb (bb); !gsi_end_p (gsi); gsi_next (&gsi))"}]}