{"sha": "0b8ca8fefec7479e91654819be9b77362406b1b5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MGI4Y2E4ZmVmZWM3NDc5ZTkxNjU0ODE5YmU5Yjc3MzYyNDA2YjFiNQ==", "commit": {"author": {"name": "Andreas Schwab", "email": "schwab@linux-m68k.org", "date": "2012-12-18T14:28:24Z"}, "committer": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2012-12-18T14:28:24Z"}, "message": "libgo: Link against libatomic.\n\n./:\n\tPR go/55201\n\t* Makefile.def (all-target-libgo): Depend on all-target-libatomic.\n\t* Makefile.in: Regenerate.\ngcc/go:\n\tPR go/55201\n\t* gospec.c (LIBATOMIC): Define.\n\t(LIBATOMIC_PROFILE): Define.\n\t(lang_specific_driver): Add LIBATOMIC[_PROFILE] option.\ngcc/testsuite:\n\t* lib/go.exp (go_link_flags): Add libatomic location to flags and\n\tld_library_path.\n\nFrom-SVN: r194581", "tree": {"sha": "6b6b9c9d00ac2d0024524cb1e632b9a8d05cbcdd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6b6b9c9d00ac2d0024524cb1e632b9a8d05cbcdd"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0b8ca8fefec7479e91654819be9b77362406b1b5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0b8ca8fefec7479e91654819be9b77362406b1b5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0b8ca8fefec7479e91654819be9b77362406b1b5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0b8ca8fefec7479e91654819be9b77362406b1b5/comments", "author": {"login": "andreas-schwab", "id": 2175493, "node_id": "MDQ6VXNlcjIxNzU0OTM=", "avatar_url": "https://avatars.githubusercontent.com/u/2175493?v=4", "gravatar_id": "", "url": "https://api.github.com/users/andreas-schwab", "html_url": "https://github.com/andreas-schwab", "followers_url": "https://api.github.com/users/andreas-schwab/followers", "following_url": "https://api.github.com/users/andreas-schwab/following{/other_user}", "gists_url": "https://api.github.com/users/andreas-schwab/gists{/gist_id}", "starred_url": "https://api.github.com/users/andreas-schwab/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/andreas-schwab/subscriptions", "organizations_url": "https://api.github.com/users/andreas-schwab/orgs", "repos_url": "https://api.github.com/users/andreas-schwab/repos", "events_url": "https://api.github.com/users/andreas-schwab/events{/privacy}", "received_events_url": "https://api.github.com/users/andreas-schwab/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "00f643091dd1dabac75b69e78cc43e9e2711eead", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/00f643091dd1dabac75b69e78cc43e9e2711eead", "html_url": "https://github.com/Rust-GCC/gccrs/commit/00f643091dd1dabac75b69e78cc43e9e2711eead"}], "stats": {"total": 47, "additions": 41, "deletions": 6}, "files": [{"sha": "c2b876652c0029ca4ea7ca2dab2c2bb1e8bf1def", "filename": "ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0b8ca8fefec7479e91654819be9b77362406b1b5/ChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0b8ca8fefec7479e91654819be9b77362406b1b5/ChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/ChangeLog?ref=0b8ca8fefec7479e91654819be9b77362406b1b5", "patch": "@@ -1,3 +1,9 @@\n+2012-12-18  Andreas Schwab  <schwab@linux-m68k.org>\n+\n+\tPR go/55201\n+\t* Makefile.def (all-target-libgo): Depend on all-target-libatomic.\n+\t* Makefile.in: Regenerate.\n+\n 2012-12-16  Thomas Schwinge  <thomas@codesourcery.com>\n \n \t* configure.ac (ENABLE_GOLD): Consider *-*-gnu* targets ELF."}, {"sha": "e25799a6e461c3899de8551d83858fc88b7b96a9", "filename": "Makefile.def", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0b8ca8fefec7479e91654819be9b77362406b1b5/Makefile.def", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0b8ca8fefec7479e91654819be9b77362406b1b5/Makefile.def", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/Makefile.def?ref=0b8ca8fefec7479e91654819be9b77362406b1b5", "patch": "@@ -497,6 +497,7 @@ dependencies = { module=configure-target-libgo; on=configure-target-libffi; };\n dependencies = { module=configure-target-libgo; on=all-target-libstdc++-v3; };\n dependencies = { module=all-target-libgo; on=all-target-libbacktrace; };\n dependencies = { module=all-target-libgo; on=all-target-libffi; };\n+dependencies = { module=all-target-libgo; on=all-target-libatomic; };\n dependencies = { module=configure-target-libjava; on=configure-target-zlib; };\n dependencies = { module=configure-target-libjava; on=configure-target-boehm-gc; };\n dependencies = { module=configure-target-libjava; on=configure-target-libffi; };"}, {"sha": "a0281e9d3ad19cea5992a17fbce4c7ad161758b9", "filename": "Makefile.in", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0b8ca8fefec7479e91654819be9b77362406b1b5/Makefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0b8ca8fefec7479e91654819be9b77362406b1b5/Makefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/Makefile.in?ref=0b8ca8fefec7479e91654819be9b77362406b1b5", "patch": "@@ -46154,6 +46154,7 @@ configure-target-libgo: maybe-configure-target-libffi\n configure-target-libgo: maybe-all-target-libstdc++-v3\n all-target-libgo: maybe-all-target-libbacktrace\n all-target-libgo: maybe-all-target-libffi\n+all-target-libgo: maybe-all-target-libatomic\n configure-target-libjava: maybe-configure-target-zlib\n configure-target-libjava: maybe-configure-target-boehm-gc\n configure-target-libjava: maybe-configure-target-libffi"}, {"sha": "a29a8e010b37aaf99df13d9821ca5cf2c947012e", "filename": "gcc/go/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0b8ca8fefec7479e91654819be9b77362406b1b5/gcc%2Fgo%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0b8ca8fefec7479e91654819be9b77362406b1b5/gcc%2Fgo%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgo%2FChangeLog?ref=0b8ca8fefec7479e91654819be9b77362406b1b5", "patch": "@@ -1,3 +1,10 @@\n+2012-12-18  Andreas Schwab  <schwab@linux-m68k.org>\n+\n+\tPR go/55201\n+\t* gospec.c (LIBATOMIC): Define.\n+\t(LIBATOMIC_PROFILE): Define.\n+\t(lang_specific_driver): Add LIBATOMIC[_PROFILE] option.\n+\n 2012-11-29  Ian Lance Taylor  <iant@google.com>\n \n \t* go-gcc.cc: Include \"output.h\"."}, {"sha": "c22ad6c7c973c678b88025aec6c978d864279ff7", "filename": "gcc/go/gospec.c", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0b8ca8fefec7479e91654819be9b77362406b1b5/gcc%2Fgo%2Fgospec.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0b8ca8fefec7479e91654819be9b77362406b1b5/gcc%2Fgo%2Fgospec.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgo%2Fgospec.c?ref=0b8ca8fefec7479e91654819be9b77362406b1b5", "patch": "@@ -45,6 +45,9 @@ along with GCC; see the file COPYING3.  If not see\n #define THREAD_LIBRARY \"pthread\"\n #define THREAD_LIBRARY_PROFILE THREAD_LIBRARY\n \n+#define LIBATOMIC \"atomic\"\n+#define LIBATOMIC_PROFILE LIBATOMIC\n+\n #define LIBGO \"go\"\n #define LIBGO_PROFILE LIBGO\n #define LIBGOBEGIN \"gobegin\"\n@@ -336,6 +339,11 @@ lang_specific_driver (struct cl_decoded_option **in_decoded_options,\n       added_libraries++;\n       j++;\n \n+      generate_option (OPT_l, saw_profile_flag ? LIBATOMIC_PROFILE : LIBATOMIC,\n+\t\t       1, CL_DRIVER, &new_decoded_options[j]);\n+      added_libraries++;\n+      j++;\n+\n #ifdef HAVE_LD_STATIC_DYNAMIC\n       if (library > 1 && !static_link)\n \t{"}, {"sha": "7bc7788c115e0244901b6be955ac19e740a725c0", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0b8ca8fefec7479e91654819be9b77362406b1b5/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0b8ca8fefec7479e91654819be9b77362406b1b5/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=0b8ca8fefec7479e91654819be9b77362406b1b5", "patch": "@@ -1,3 +1,8 @@\n+2012-12-18  Andreas Schwab  <schwab@linux-m68k.org>\n+\n+\t* lib/go.exp (go_link_flags): Add libatomic location to flags and\n+\tld_library_path.\n+\n 2012-12-18  Richard Biener  <rguenther@suse.de>\n \n \t* gcc.dg/tree-ssa/reassoc-19.c: Adjust."}, {"sha": "8eea9fa8363485ca3fc16bc970aeb051e18f5f77", "filename": "gcc/testsuite/lib/go.exp", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0b8ca8fefec7479e91654819be9b77362406b1b5/gcc%2Ftestsuite%2Flib%2Fgo.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0b8ca8fefec7479e91654819be9b77362406b1b5/gcc%2Ftestsuite%2Flib%2Fgo.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Flib%2Fgo.exp?ref=0b8ca8fefec7479e91654819be9b77362406b1b5", "patch": "@@ -111,6 +111,11 @@ proc go_link_flags { paths } {\n           append flags \"-L${gccpath}/libgo/.libs \"\n           append ld_library_path \":${gccpath}/libgo/.libs\"\n       }\n+      if { [file exists \"${gccpath}/libatomic/.libs/libatomic.a\"] \\\n+\t   || [file exists \"${gccpath}/libatomic/.libs/libatomic.${shlib_ext}\"] } {\n+          append flags \"-L${gccpath}/libatomic/.libs \"\n+          append ld_library_path \":${gccpath}/libatomic/.libs\"\n+      }\n       if [file exists \"${gccpath}/libiberty/libiberty.a\"] {\n           append flags \"-L${gccpath}/libiberty \"\n       }"}, {"sha": "a7ac3791b14940ff34190560dff6115a8cfce6a7", "filename": "libgo/Makefile.am", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0b8ca8fefec7479e91654819be9b77362406b1b5/libgo%2FMakefile.am", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0b8ca8fefec7479e91654819be9b77362406b1b5/libgo%2FMakefile.am", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgo%2FMakefile.am?ref=0b8ca8fefec7479e91654819be9b77362406b1b5", "patch": "@@ -1909,6 +1909,7 @@ libgo_la_LDFLAGS = \\\n \n libgo_la_LIBADD = \\\n \t$(libgo_go_objs) ../libbacktrace/libbacktrace.la \\\n+\t../libatomic/libatomic.la \\\n \t$(LIBFFI) $(PTHREAD_LIBS) $(MATH_LIBS) $(NET_LIBS)\n \n libgobegin_a_SOURCES = \\\n@@ -1948,7 +1949,7 @@ GOTESTFLAGS =\n \n # Check a package.\n CHECK = \\\n-\tGC=\"$(GOC) $(GOCFLAGS) $($(subst /,_,$@)_GOCFLAGS) -L `${PWD_COMMAND}` -L `${PWD_COMMAND}`/.libs\"; \\\n+\tGC=\"$(GOC) $(GOCFLAGS) $($(subst /,_,$@)_GOCFLAGS) -L `${PWD_COMMAND}` -L `${PWD_COMMAND}`/.libs -L `${PWD_COMMAND}`/../libatomic -L `${PWD_COMMAND}`/../libatomic/.libs\"; \\\n \texport GC; \\\n \tGOLIBS=\"$(MATH_LIBS) $(NET_LIBS)\"; \\\n \texport GOLIBS; \\\n@@ -1957,7 +1958,7 @@ CHECK = \\\n \tMAKE=\"$(MAKE)\"; \\\n \texport MAKE; \\\n \tlibgccdir=`${GOC} -print-libgcc-file-name | sed -e 's|/[^/]*$$||'`; \\\n-\tLD_LIBRARY_PATH=\"`${PWD_COMMAND}`/.libs:$${libgccdir}:${LD_LIBRARY_PATH}\"; \\\n+\tLD_LIBRARY_PATH=\"`${PWD_COMMAND}`/.libs:`${PWD_COMMAND}`/../libatomic/.libs:$${libgccdir}:${LD_LIBRARY_PATH}\"; \\\n \tLD_LIBRARY_PATH=`echo $${LD_LIBRARY_PATH} | sed 's,::*,:,g;s,^:*,,;s,:*$$,,'`; \\\n \texport LD_LIBRARY_PATH; \\\n \t$(MKDIR_P) $(@D); \\"}, {"sha": "31e38ba25c7d75a3681d821377f92353e0c6d5cc", "filename": "libgo/Makefile.in", "status": "modified", "additions": 5, "deletions": 4, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0b8ca8fefec7479e91654819be9b77362406b1b5/libgo%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0b8ca8fefec7479e91654819be9b77362406b1b5/libgo%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgo%2FMakefile.in?ref=0b8ca8fefec7479e91654819be9b77362406b1b5", "patch": "@@ -175,9 +175,9 @@ am__DEPENDENCIES_2 = bufio.lo bytes.lo bytes/index.lo crypto.lo \\\n \ttesting/iotest.lo testing/quick.lo unicode/utf16.lo \\\n \tunicode/utf8.lo\n libgo_la_DEPENDENCIES = $(am__DEPENDENCIES_2) \\\n-\t../libbacktrace/libbacktrace.la $(am__DEPENDENCIES_1) \\\n+\t../libbacktrace/libbacktrace.la ../libatomic/libatomic.la \\\n \t$(am__DEPENDENCIES_1) $(am__DEPENDENCIES_1) \\\n-\t$(am__DEPENDENCIES_1)\n+\t$(am__DEPENDENCIES_1) $(am__DEPENDENCIES_1)\n @LIBGO_IS_LINUX_FALSE@am__objects_1 = lock_sema.lo thread-sema.lo\n @LIBGO_IS_LINUX_TRUE@am__objects_1 = lock_futex.lo thread-linux.lo\n @HAVE_SYS_MMAN_H_FALSE@am__objects_2 = mem_posix_memalign.lo\n@@ -2037,6 +2037,7 @@ libgo_la_LDFLAGS = \\\n \n libgo_la_LIBADD = \\\n \t$(libgo_go_objs) ../libbacktrace/libbacktrace.la \\\n+\t../libatomic/libatomic.la \\\n \t$(LIBFFI) $(PTHREAD_LIBS) $(MATH_LIBS) $(NET_LIBS)\n \n libgobegin_a_SOURCES = \\\n@@ -2071,7 +2072,7 @@ GOTESTFLAGS =\n \n # Check a package.\n CHECK = \\\n-\tGC=\"$(GOC) $(GOCFLAGS) $($(subst /,_,$@)_GOCFLAGS) -L `${PWD_COMMAND}` -L `${PWD_COMMAND}`/.libs\"; \\\n+\tGC=\"$(GOC) $(GOCFLAGS) $($(subst /,_,$@)_GOCFLAGS) -L `${PWD_COMMAND}` -L `${PWD_COMMAND}`/.libs -L `${PWD_COMMAND}`/../libatomic -L `${PWD_COMMAND}`/../libatomic/.libs\"; \\\n \texport GC; \\\n \tGOLIBS=\"$(MATH_LIBS) $(NET_LIBS)\"; \\\n \texport GOLIBS; \\\n@@ -2080,7 +2081,7 @@ CHECK = \\\n \tMAKE=\"$(MAKE)\"; \\\n \texport MAKE; \\\n \tlibgccdir=`${GOC} -print-libgcc-file-name | sed -e 's|/[^/]*$$||'`; \\\n-\tLD_LIBRARY_PATH=\"`${PWD_COMMAND}`/.libs:$${libgccdir}:${LD_LIBRARY_PATH}\"; \\\n+\tLD_LIBRARY_PATH=\"`${PWD_COMMAND}`/.libs:`${PWD_COMMAND}`/../libatomic/.libs:$${libgccdir}:${LD_LIBRARY_PATH}\"; \\\n \tLD_LIBRARY_PATH=`echo $${LD_LIBRARY_PATH} | sed 's,::*,:,g;s,^:*,,;s,:*$$,,'`; \\\n \texport LD_LIBRARY_PATH; \\\n \t$(MKDIR_P) $(@D); \\"}]}