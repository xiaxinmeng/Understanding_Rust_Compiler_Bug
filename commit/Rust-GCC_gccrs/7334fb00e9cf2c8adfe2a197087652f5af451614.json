{"sha": "7334fb00e9cf2c8adfe2a197087652f5af451614", "node_id": "C_kwDOANBUbNoAKDczMzRmYjAwZTljZjJjOGFkZmUyYTE5NzA4NzY1MmY1YWY0NTE2MTQ", "commit": {"author": {"name": "Philip Herron", "email": "herron.philip@googlemail.com", "date": "2023-03-15T16:50:03Z"}, "committer": {"name": "Philip Herron", "email": "philip.herron@embecosm.com", "date": "2023-03-17T10:34:36Z"}, "message": "gccrs: remove proxy class to use virtual method to get impl_item name\n\ngcc/rust/ChangeLog:\n\n\t* typecheck/rust-hir-inherent-impl-overlap.h (class ImplItemToName): remove\n\nSigned-off-by: Philip Herron <herron.philip@googlemail.com>", "tree": {"sha": "b194df9ff8d59efabc2a6766e882da0ce3c7dbfc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b194df9ff8d59efabc2a6766e882da0ce3c7dbfc"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7334fb00e9cf2c8adfe2a197087652f5af451614", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7334fb00e9cf2c8adfe2a197087652f5af451614", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7334fb00e9cf2c8adfe2a197087652f5af451614", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7334fb00e9cf2c8adfe2a197087652f5af451614/comments", "author": {"login": "philberty", "id": 84585, "node_id": "MDQ6VXNlcjg0NTg1", "avatar_url": "https://avatars.githubusercontent.com/u/84585?v=4", "gravatar_id": "", "url": "https://api.github.com/users/philberty", "html_url": "https://github.com/philberty", "followers_url": "https://api.github.com/users/philberty/followers", "following_url": "https://api.github.com/users/philberty/following{/other_user}", "gists_url": "https://api.github.com/users/philberty/gists{/gist_id}", "starred_url": "https://api.github.com/users/philberty/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/philberty/subscriptions", "organizations_url": "https://api.github.com/users/philberty/orgs", "repos_url": "https://api.github.com/users/philberty/repos", "events_url": "https://api.github.com/users/philberty/events{/privacy}", "received_events_url": "https://api.github.com/users/philberty/received_events", "type": "User", "site_admin": false}, "committer": {"login": "philberty", "id": 84585, "node_id": "MDQ6VXNlcjg0NTg1", "avatar_url": "https://avatars.githubusercontent.com/u/84585?v=4", "gravatar_id": "", "url": "https://api.github.com/users/philberty", "html_url": "https://github.com/philberty", "followers_url": "https://api.github.com/users/philberty/followers", "following_url": "https://api.github.com/users/philberty/following{/other_user}", "gists_url": "https://api.github.com/users/philberty/gists{/gist_id}", "starred_url": "https://api.github.com/users/philberty/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/philberty/subscriptions", "organizations_url": "https://api.github.com/users/philberty/orgs", "repos_url": "https://api.github.com/users/philberty/repos", "events_url": "https://api.github.com/users/philberty/events{/privacy}", "received_events_url": "https://api.github.com/users/philberty/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "90a53011cb2b0ee9167e4bcedd753e1b7e615882", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/90a53011cb2b0ee9167e4bcedd753e1b7e615882", "html_url": "https://github.com/Rust-GCC/gccrs/commit/90a53011cb2b0ee9167e4bcedd753e1b7e615882"}], "stats": {"total": 42, "additions": 1, "deletions": 41}, "files": [{"sha": "0eeaac666d55b4550a47068c668b5010213e0a8f", "filename": "gcc/rust/typecheck/rust-hir-inherent-impl-overlap.h", "status": "modified", "additions": 1, "deletions": 41, "changes": 42, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7334fb00e9cf2c8adfe2a197087652f5af451614/gcc%2Frust%2Ftypecheck%2Frust-hir-inherent-impl-overlap.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7334fb00e9cf2c8adfe2a197087652f5af451614/gcc%2Frust%2Ftypecheck%2Frust-hir-inherent-impl-overlap.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Frust%2Ftypecheck%2Frust-hir-inherent-impl-overlap.h?ref=7334fb00e9cf2c8adfe2a197087652f5af451614", "patch": "@@ -25,43 +25,6 @@\n namespace Rust {\n namespace Resolver {\n \n-class ImplItemToName : private TypeCheckBase, private HIR::HIRImplVisitor\n-{\n-public:\n-  static bool resolve (HIR::ImplItem *item, std::string &name_result)\n-  {\n-    ImplItemToName resolver (name_result);\n-    item->accept_vis (resolver);\n-    return resolver.ok;\n-  }\n-\n-  void visit (HIR::TypeAlias &alias) override\n-  {\n-    ok = true;\n-    result.assign (alias.get_new_type_name ());\n-  }\n-\n-  void visit (HIR::Function &function) override\n-  {\n-    ok = true;\n-    result.assign (function.get_function_name ());\n-  }\n-\n-  void visit (HIR::ConstantItem &constant) override\n-  {\n-    ok = true;\n-    result.assign (constant.get_identifier ());\n-  }\n-\n-private:\n-  ImplItemToName (std::string &result)\n-    : TypeCheckBase (), ok (false), result (result)\n-  {}\n-\n-  bool ok;\n-  std::string &result;\n-};\n-\n class OverlappingImplItemPass : public TypeCheckBase\n {\n public:\n@@ -97,10 +60,7 @@ class OverlappingImplItemPass : public TypeCheckBase\n     if (!ok)\n       return;\n \n-    std::string impl_item_name;\n-    ok = ImplItemToName::resolve (impl_item, impl_item_name);\n-    rust_assert (ok);\n-\n+    std::string impl_item_name = impl_item->get_impl_item_name ();\n     std::pair<HIR::ImplItem *, std::string> elem (impl_item, impl_item_name);\n     impl_mappings[impl_type].insert (std::move (elem));\n   }"}]}