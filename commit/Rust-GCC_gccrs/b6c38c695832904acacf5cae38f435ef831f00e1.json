{"sha": "b6c38c695832904acacf5cae38f435ef831f00e1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjZjMzhjNjk1ODMyOTA0YWNhY2Y1Y2FlMzhmNDM1ZWY4MzFmMDBlMQ==", "commit": {"author": {"name": "Bernd Schmidt", "email": "bernds@redhat.com", "date": "2016-03-04T14:12:36Z"}, "committer": {"name": "Bernd Schmidt", "email": "bernds@gcc.gnu.org", "date": "2016-03-04T14:12:36Z"}, "message": "Avoid terminating early in LRA, unless -fchecking (PR57676)\n\ngcc/\n\tPR rtl-optimization/57676\n\t* lra-assigns.c (lra_assign): Guard test for maximum iterations\n\twith flag_checking.\n\ngcc/testsuite/\n\tPR rtl-optimization/57676\n\t* gcc.dg/torture/pr57676.c: New test.\n\nFrom-SVN: r233967", "tree": {"sha": "f56de8a9fbedf226e0e591a92daabe830f3e6550", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f56de8a9fbedf226e0e591a92daabe830f3e6550"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b6c38c695832904acacf5cae38f435ef831f00e1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b6c38c695832904acacf5cae38f435ef831f00e1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b6c38c695832904acacf5cae38f435ef831f00e1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b6c38c695832904acacf5cae38f435ef831f00e1/comments", "author": null, "committer": null, "parents": [{"sha": "af3cdd3433e0bc60f4e6ebee1ee699bb19485cce", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/af3cdd3433e0bc60f4e6ebee1ee699bb19485cce", "html_url": "https://github.com/Rust-GCC/gccrs/commit/af3cdd3433e0bc60f4e6ebee1ee699bb19485cce"}], "stats": {"total": 47, "additions": 45, "deletions": 2}, "files": [{"sha": "976e6fa8f51b8cbdcddee339575a7a03e6c1e9d7", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b6c38c695832904acacf5cae38f435ef831f00e1/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b6c38c695832904acacf5cae38f435ef831f00e1/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=b6c38c695832904acacf5cae38f435ef831f00e1", "patch": "@@ -1,9 +1,14 @@\n+2016-03-04  Bernd Schmidt  <bschmidt@redhat.com>\n+\n+\tPR rtl-optimization/57676\n+\t* lra-assigns.c (lra_assign): Guard test for maximum iterations\n+\twith flag_checking.\n+\n 2016-03-04  Ilya Enkovich  <enkovich.gnu@gmail.com>\n \n \t* tree-vect-patterns.c (search_type_for_mask): Handle\n \tcomparison of booleans.\n \n-\n 2016-03-04  Jakub Jelinek  <jakub@redhat.com>\n \n \t* doc/extend.texi (__builtin_alloca, __builtin_alloca_with_align):"}, {"sha": "fb3de849ec1191761946c57ebac007fb17b393f6", "filename": "gcc/lra-assigns.c", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b6c38c695832904acacf5cae38f435ef831f00e1/gcc%2Flra-assigns.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b6c38c695832904acacf5cae38f435ef831f00e1/gcc%2Flra-assigns.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flra-assigns.c?ref=b6c38c695832904acacf5cae38f435ef831f00e1", "patch": "@@ -1620,7 +1620,12 @@ lra_assign (void)\n   timevar_pop (TV_LRA_ASSIGN);\n   if (former_reload_pseudo_spill_p)\n     lra_assignment_iter_after_spill++;\n-  if (lra_assignment_iter_after_spill > LRA_MAX_ASSIGNMENT_ITERATION_NUMBER)\n+  /* This is conditional on flag_checking because valid code can take\n+     more than this maximum number of iteration, but at the same time\n+     the test can uncover errors in machine descriptions.  */\n+  if (flag_checking\n+      && (lra_assignment_iter_after_spill\n+\t  > LRA_MAX_ASSIGNMENT_ITERATION_NUMBER))\n     internal_error\n       (\"Maximum number of LRA assignment passes is achieved (%d)\\n\",\n        LRA_MAX_ASSIGNMENT_ITERATION_NUMBER);"}, {"sha": "e4770e700b2c7ce62e0f6b461297da58ad7ce575", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b6c38c695832904acacf5cae38f435ef831f00e1/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b6c38c695832904acacf5cae38f435ef831f00e1/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=b6c38c695832904acacf5cae38f435ef831f00e1", "patch": "@@ -1,3 +1,8 @@\n+2016-03-04  Bernd Schmidt  <bschmidt@redhat.com>\n+\n+\tPR rtl-optimization/57676\n+\t* gcc.dg/torture/pr57676.c: New test.\n+\n 2016-03-04  Ilya Enkovich  <enkovich.gnu@gmail.com>\n \n \t* gcc.dg/pr70026.c: New test."}, {"sha": "a8cacc630b38c22c08a14ffd5e44dcf4fa91982a", "filename": "gcc/testsuite/gcc.dg/torture/pr57676.c", "status": "added", "additions": 28, "deletions": 0, "changes": 28, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b6c38c695832904acacf5cae38f435ef831f00e1/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr57676.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b6c38c695832904acacf5cae38f435ef831f00e1/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr57676.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr57676.c?ref=b6c38c695832904acacf5cae38f435ef831f00e1", "patch": "@@ -0,0 +1,28 @@\n+/* Verify that LRA does not abort prematurely in a release build of the\n+   compiler.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-fno-checking -w -funroll-loops\" } */\n+\n+int a, b, c;\n+\n+void f(p1)\n+{\n+    for(;;)\n+    {\n+        if(p1 ? : (c /= 0))\n+        {\n+            int d;\n+\n+            for(; d; d++)\n+            {\n+                for(b = 0; b < 4; b++)\n+                    p1 /= p1;\n+lbl:\n+                while(a);\n+            }\n+        }\n+\n+        if((c &= 1))\n+            goto lbl;\n+    }\n+}"}]}