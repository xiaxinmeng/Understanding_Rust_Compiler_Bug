{"sha": "4c75f709287a6fd3bcf95ab1b845528574855266", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NGM3NWY3MDkyODdhNmZkM2JjZjk1YWIxYjg0NTUyODU3NDg1NTI2Ng==", "commit": {"author": {"name": "Anatoly Sokolov", "email": "aesok@post.ru", "date": "2008-05-12T20:39:51Z"}, "committer": {"name": "Anatoly Sokolov", "email": "aesok@gcc.gnu.org", "date": "2008-05-12T20:39:51Z"}, "message": "avr.h (machine_function): Add 'is_leaf' field.\n\n\t* config/avr/avr.h (machine_function): Add 'is_leaf' field.\n\t* config/avr/avr.c (avr_regs_to_save): Compute 'machine->is_leaf'.\n\tUse 'machine->is_leaf' instead of 'leaf_func_p'.\n\nFrom-SVN: r135231", "tree": {"sha": "dbd6968f65f49773f9c7e3f56cc8871ada9af2f8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/dbd6968f65f49773f9c7e3f56cc8871ada9af2f8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4c75f709287a6fd3bcf95ab1b845528574855266", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4c75f709287a6fd3bcf95ab1b845528574855266", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4c75f709287a6fd3bcf95ab1b845528574855266", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4c75f709287a6fd3bcf95ab1b845528574855266/comments", "author": null, "committer": null, "parents": [{"sha": "ea0a7f390a26152d2a7986e78fdf476cabc6630e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ea0a7f390a26152d2a7986e78fdf476cabc6630e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ea0a7f390a26152d2a7986e78fdf476cabc6630e"}], "stats": {"total": 15, "additions": 13, "deletions": 2}, "files": [{"sha": "27204b40bd3bcfc4ce16b9fa89e2557ac1198b2f", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4c75f709287a6fd3bcf95ab1b845528574855266/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4c75f709287a6fd3bcf95ab1b845528574855266/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=4c75f709287a6fd3bcf95ab1b845528574855266", "patch": "@@ -1,3 +1,9 @@\n+2008-05-12  Anatoly Sokolov <aesok@post.ru>\n+\n+\t* config/avr/avr.h (machine_function): Add 'is_leaf' field.\n+\t* config/avr/avr.c (avr_regs_to_save): Compute 'machine->is_leaf'.\n+\tUse 'machine->is_leaf' instead of 'leaf_func_p'.\n+\n 2008-05-12  H.J. Lu  <hongjiu.lu@intel.com>\n \n \t* config/i386/sse.md (*sse_concatv4sf): Renamed to ..."}, {"sha": "e1d77758c3cdcf8ad189384787bc63e4e122402d", "filename": "gcc/config/avr/avr.c", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4c75f709287a6fd3bcf95ab1b845528574855266/gcc%2Fconfig%2Favr%2Favr.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4c75f709287a6fd3bcf95ab1b845528574855266/gcc%2Fconfig%2Favr%2Favr.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Favr%2Favr.c?ref=4c75f709287a6fd3bcf95ab1b845528574855266", "patch": "@@ -471,7 +471,9 @@ avr_regs_to_save (HARD_REG_SET *set)\n   int reg, count;\n   int int_or_sig_p = (interrupt_function_p (current_function_decl)\n \t\t      || signal_function_p (current_function_decl));\n-  int leaf_func_p = leaf_function_p ();\n+\n+  if (!reload_completed)\n+    cfun->machine->is_leaf = leaf_function_p ();\n \n   if (set)\n     CLEAR_HARD_REG_SET (*set);\n@@ -490,7 +492,7 @@ avr_regs_to_save (HARD_REG_SET *set)\n       if (fixed_regs[reg])\n \tcontinue;\n \n-      if ((int_or_sig_p && !leaf_func_p && call_used_regs[reg])\n+      if ((int_or_sig_p && !cfun->machine->is_leaf && call_used_regs[reg])\n \t  || (df_regs_ever_live_p (reg)\n \t      && (int_or_sig_p || !call_used_regs[reg])\n \t      && !(frame_pointer_needed"}, {"sha": "b56c8e044fc9db1dd94dd528cc2c9fb768d807b7", "filename": "gcc/config/avr/avr.h", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4c75f709287a6fd3bcf95ab1b845528574855266/gcc%2Fconfig%2Favr%2Favr.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4c75f709287a6fd3bcf95ab1b845528574855266/gcc%2Fconfig%2Favr%2Favr.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Favr%2Favr.h?ref=4c75f709287a6fd3bcf95ab1b845528574855266", "patch": "@@ -1026,6 +1026,9 @@ mmcu=*:-mmcu=%*}\"\n    This is added to the cfun structure.  */\n struct machine_function GTY(())\n {\n+  /* 'true' - if the current function is a leaf function.  */\n+  int is_leaf;\n+\n   /* 'true' - if current function is a naked function.  */\n   int is_naked;\n "}]}