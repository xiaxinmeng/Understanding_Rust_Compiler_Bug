{"sha": "4304e09a1617bcf1c87f5bc96017ae5017379d75", "node_id": "C_kwDOANBUbNoAKDQzMDRlMDlhMTYxN2JjZjFjODdmNWJjOTYwMTdhZTUwMTczNzlkNzU", "commit": {"author": {"name": "Jason Merrill", "email": "jason@redhat.com", "date": "2022-11-30T19:22:03Z"}, "committer": {"name": "Jason Merrill", "email": "jason@redhat.com", "date": "2022-12-01T03:46:05Z"}, "message": "c++: small contracts fixes\n\nThe first is an actual bug: remove_contract_attributes was only keeping one\nattribute.  The second just helps flow analysis in optimizers and static\nanalyzers.\n\ngcc/cp/ChangeLog:\n\n\t* contracts.cc (remove_contract_attributes): Actually prepend\n\tto the list.\n\t* pt.cc (tsubst_contract): Only look for a postcondition if type is\n\tnonnull.", "tree": {"sha": "ea3d7c8715a87b686240adfa369ba853ed536653", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ea3d7c8715a87b686240adfa369ba853ed536653"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4304e09a1617bcf1c87f5bc96017ae5017379d75", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4304e09a1617bcf1c87f5bc96017ae5017379d75", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4304e09a1617bcf1c87f5bc96017ae5017379d75", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4304e09a1617bcf1c87f5bc96017ae5017379d75/comments", "author": {"login": "jicama", "id": 266146, "node_id": "MDQ6VXNlcjI2NjE0Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/266146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jicama", "html_url": "https://github.com/jicama", "followers_url": "https://api.github.com/users/jicama/followers", "following_url": "https://api.github.com/users/jicama/following{/other_user}", "gists_url": "https://api.github.com/users/jicama/gists{/gist_id}", "starred_url": "https://api.github.com/users/jicama/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jicama/subscriptions", "organizations_url": "https://api.github.com/users/jicama/orgs", "repos_url": "https://api.github.com/users/jicama/repos", "events_url": "https://api.github.com/users/jicama/events{/privacy}", "received_events_url": "https://api.github.com/users/jicama/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jicama", "id": 266146, "node_id": "MDQ6VXNlcjI2NjE0Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/266146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jicama", "html_url": "https://github.com/jicama", "followers_url": "https://api.github.com/users/jicama/followers", "following_url": "https://api.github.com/users/jicama/following{/other_user}", "gists_url": "https://api.github.com/users/jicama/gists{/gist_id}", "starred_url": "https://api.github.com/users/jicama/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jicama/subscriptions", "organizations_url": "https://api.github.com/users/jicama/orgs", "repos_url": "https://api.github.com/users/jicama/repos", "events_url": "https://api.github.com/users/jicama/events{/privacy}", "received_events_url": "https://api.github.com/users/jicama/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "cda29c540037fbcf00a377196050953aab1d3d5b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cda29c540037fbcf00a377196050953aab1d3d5b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cda29c540037fbcf00a377196050953aab1d3d5b"}], "stats": {"total": 4, "additions": 2, "deletions": 2}, "files": [{"sha": "45f52b20392a87f0ad6bfe49fe15e59ac6b0918d", "filename": "gcc/cp/contracts.cc", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4304e09a1617bcf1c87f5bc96017ae5017379d75/gcc%2Fcp%2Fcontracts.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4304e09a1617bcf1c87f5bc96017ae5017379d75/gcc%2Fcp%2Fcontracts.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fcontracts.cc?ref=4304e09a1617bcf1c87f5bc96017ae5017379d75", "patch": "@@ -869,7 +869,7 @@ remove_contract_attributes (tree fndecl)\n   tree list = NULL_TREE;\n   for (tree p = DECL_ATTRIBUTES (fndecl); p; p = TREE_CHAIN (p))\n     if (!cxx_contract_attribute_p (p))\n-      list = tree_cons (TREE_PURPOSE (p), TREE_VALUE (p), NULL_TREE);\n+      list = tree_cons (TREE_PURPOSE (p), TREE_VALUE (p), list);\n   DECL_ATTRIBUTES (fndecl) = nreverse (list);\n }\n "}, {"sha": "08de273a90082916bc74f2f44cec865e4bac77fd", "filename": "gcc/cp/pt.cc", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4304e09a1617bcf1c87f5bc96017ae5017379d75/gcc%2Fcp%2Fpt.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4304e09a1617bcf1c87f5bc96017ae5017379d75/gcc%2Fcp%2Fpt.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fpt.cc?ref=4304e09a1617bcf1c87f5bc96017ae5017379d75", "patch": "@@ -11561,7 +11561,7 @@ tsubst_contract (tree decl, tree t, tree args, tsubst_flags_t complain,\n   tree r = copy_node (t);\n \n   /* Rebuild the result variable.  */\n-  if (POSTCONDITION_P (t) && POSTCONDITION_IDENTIFIER (t))\n+  if (type && POSTCONDITION_P (t) && POSTCONDITION_IDENTIFIER (t))\n     {\n       tree oldvar = POSTCONDITION_IDENTIFIER (t);\n "}]}