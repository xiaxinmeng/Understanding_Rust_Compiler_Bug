{"sha": "30e160475489867a09ed89532cae135b5849cf98", "node_id": "C_kwDOANBUbNoAKDMwZTE2MDQ3NTQ4OTg2N2EwOWVkODk1MzJjYWUxMzViNTg0OWNmOTg", "commit": {"author": {"name": "Jason Merrill", "email": "jason@redhat.com", "date": "2022-08-24T20:31:04Z"}, "committer": {"name": "Jason Merrill", "email": "jason@redhat.com", "date": "2022-08-25T21:03:01Z"}, "message": "dwarf2: use DW_ATE_UTF for char8_t\n\nWhile looking at the Rust changes to dwarf2out I noticed that this was\nmissing from the char8_t support.\n\ngcc/ChangeLog:\n\n\t* dwarf2out.cc (base_type_die): Also use DW_ATE_UTF for char8_t.\n\ngcc/testsuite/ChangeLog:\n\n\t* g++.dg/debug/dwarf2/utf-1.C: New test.", "tree": {"sha": "74171d5abf8ae88cfbcfc22c102b982786fddbbd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/74171d5abf8ae88cfbcfc22c102b982786fddbbd"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/30e160475489867a09ed89532cae135b5849cf98", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/30e160475489867a09ed89532cae135b5849cf98", "html_url": "https://github.com/Rust-GCC/gccrs/commit/30e160475489867a09ed89532cae135b5849cf98", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/30e160475489867a09ed89532cae135b5849cf98/comments", "author": {"login": "jicama", "id": 266146, "node_id": "MDQ6VXNlcjI2NjE0Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/266146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jicama", "html_url": "https://github.com/jicama", "followers_url": "https://api.github.com/users/jicama/followers", "following_url": "https://api.github.com/users/jicama/following{/other_user}", "gists_url": "https://api.github.com/users/jicama/gists{/gist_id}", "starred_url": "https://api.github.com/users/jicama/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jicama/subscriptions", "organizations_url": "https://api.github.com/users/jicama/orgs", "repos_url": "https://api.github.com/users/jicama/repos", "events_url": "https://api.github.com/users/jicama/events{/privacy}", "received_events_url": "https://api.github.com/users/jicama/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jicama", "id": 266146, "node_id": "MDQ6VXNlcjI2NjE0Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/266146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jicama", "html_url": "https://github.com/jicama", "followers_url": "https://api.github.com/users/jicama/followers", "following_url": "https://api.github.com/users/jicama/following{/other_user}", "gists_url": "https://api.github.com/users/jicama/gists{/gist_id}", "starred_url": "https://api.github.com/users/jicama/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jicama/subscriptions", "organizations_url": "https://api.github.com/users/jicama/orgs", "repos_url": "https://api.github.com/users/jicama/repos", "events_url": "https://api.github.com/users/jicama/events{/privacy}", "received_events_url": "https://api.github.com/users/jicama/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "980e0aa0ce3bdfec61ca766a71a31a89c12f882e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/980e0aa0ce3bdfec61ca766a71a31a89c12f882e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/980e0aa0ce3bdfec61ca766a71a31a89c12f882e"}], "stats": {"total": 10, "additions": 10, "deletions": 0}, "files": [{"sha": "28a4ae08fe4c645f3ec2d4cf0af928c2cbb1a1ca", "filename": "gcc/dwarf2out.cc", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/30e160475489867a09ed89532cae135b5849cf98/gcc%2Fdwarf2out.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/30e160475489867a09ed89532cae135b5849cf98/gcc%2Fdwarf2out.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdwarf2out.cc?ref=30e160475489867a09ed89532cae135b5849cf98", "patch": "@@ -13210,6 +13210,7 @@ base_type_die (tree type, bool reverse)\n \t{\n \t  const char *name = IDENTIFIER_POINTER (DECL_NAME (TYPE_NAME (type)));\n \t  if (strcmp (name, \"char16_t\") == 0\n+\t      || strcmp (name, \"char8_t\") == 0\n \t      || strcmp (name, \"char32_t\") == 0)\n \t    {\n \t      encoding = DW_ATE_UTF;"}, {"sha": "43b354f1bb5d1d4f6150f6003c661d080bdaa5ed", "filename": "gcc/testsuite/g++.dg/debug/dwarf2/utf-1.C", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/30e160475489867a09ed89532cae135b5849cf98/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdebug%2Fdwarf2%2Futf-1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/30e160475489867a09ed89532cae135b5849cf98/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdebug%2Fdwarf2%2Futf-1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdebug%2Fdwarf2%2Futf-1.C?ref=30e160475489867a09ed89532cae135b5849cf98", "patch": "@@ -0,0 +1,9 @@\n+// { dg-do compile { target c++20 } }\n+// { dg-options { -gdwarf -dA } }\n+\n+// Test that all three use DW_ATE_UTF.\n+// { dg-final { scan-assembler-times {DW_AT_encoding \\(0x10\\)} 3 } }\n+\n+char8_t c8;\n+char16_t c16;\n+char32_t c32;"}]}