{"sha": "eb2d06144aede2d0cef5e937b2f4c40b30d35ead", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWIyZDA2MTQ0YWVkZTJkMGNlZjVlOTM3YjJmNGM0MGIzMGQzNWVhZA==", "commit": {"author": {"name": "Alexandre Oliva", "email": "aoliva@redhat.com", "date": "2001-06-10T21:50:40Z"}, "committer": {"name": "Alexandre Oliva", "email": "aoliva@gcc.gnu.org", "date": "2001-06-10T21:50:40Z"}, "message": "typeck.c (get_member_function_from_ptrfunc): Don't clobber delta.\n\n* typeck.c (get_member_function_from_ptrfunc) [vbit_in_delta]:\nDon't clobber delta.\n(expand_ptrmemfunc_cst) [ptrmemfunc_vbit_in_delta]: Adjust pfn.\n\nFrom-SVN: r43156", "tree": {"sha": "1396453b3b2771e2974d1322a5e5ef0659e74c95", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1396453b3b2771e2974d1322a5e5ef0659e74c95"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/eb2d06144aede2d0cef5e937b2f4c40b30d35ead", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/eb2d06144aede2d0cef5e937b2f4c40b30d35ead", "html_url": "https://github.com/Rust-GCC/gccrs/commit/eb2d06144aede2d0cef5e937b2f4c40b30d35ead", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/eb2d06144aede2d0cef5e937b2f4c40b30d35ead/comments", "author": null, "committer": null, "parents": [{"sha": "9b8c19b4f52afaace7b003100311a4ebf4180a13", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9b8c19b4f52afaace7b003100311a4ebf4180a13", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9b8c19b4f52afaace7b003100311a4ebf4180a13"}], "stats": {"total": 13, "additions": 8, "deletions": 5}, "files": [{"sha": "02fb550c69a0a74d49ba903112b0256990859b93", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eb2d06144aede2d0cef5e937b2f4c40b30d35ead/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eb2d06144aede2d0cef5e937b2f4c40b30d35ead/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=eb2d06144aede2d0cef5e937b2f4c40b30d35ead", "patch": "@@ -1,3 +1,9 @@\n+2001-06-10  Alexandre Oliva  <aoliva@redhat.com>\n+\n+\t* typeck.c (get_member_function_from_ptrfunc) [vbit_in_delta]:\n+\tDon't clobber delta.\n+\t(expand_ptrmemfunc_cst) [ptrmemfunc_vbit_in_delta]: Adjust pfn.\n+\n 2001-06-10  Mark Mitchell <mark@codesourcery.com>\n \t    Gabriel Dos Reis  <gdr@codesourcery.com>\n "}, {"sha": "38deeeecad0f2efa381753185e74ac8da8e98147", "filename": "gcc/cp/typeck.c", "status": "modified", "additions": 2, "deletions": 5, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eb2d06144aede2d0cef5e937b2f4c40b30d35ead/gcc%2Fcp%2Ftypeck.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eb2d06144aede2d0cef5e937b2f4c40b30d35ead/gcc%2Fcp%2Ftypeck.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ftypeck.c?ref=eb2d06144aede2d0cef5e937b2f4c40b30d35ead", "patch": "@@ -2937,9 +2937,6 @@ get_member_function_from_ptrfunc (instance_ptrptr, function)\n \t  abort ();\n \t}\n \n-      delta = cp_convert (ptrdiff_type_node,\n-\t\t\t  build_component_ref (function, delta_identifier,\n-\t\t\t\t\t       NULL_TREE, 0));\n       /* DELTA2 is the amount by which to adjust the `this' pointer\n \t to find the vtbl.  */\n       delta2 = delta;\n@@ -6175,12 +6172,12 @@ expand_ptrmemfunc_cst (cst, delta, pfn)\n \t ptrmemfunc_vbit_in_delta, in which case delta is shifted\n \t left, and then incremented).  */\n       *pfn = DECL_VINDEX (fn);\n+      *pfn = fold (build (MULT_EXPR, integer_type_node, *pfn,\n+\t\t\t  TYPE_SIZE_UNIT (vtable_entry_type)));\n \n       switch (TARGET_PTRMEMFUNC_VBIT_LOCATION)\n \t{\n \tcase ptrmemfunc_vbit_in_pfn:\n-\t  *pfn = fold (build (MULT_EXPR, integer_type_node, *pfn,\n-\t\t\t      TYPE_SIZE_UNIT (vtable_entry_type)));\n \t  *pfn = fold (build (PLUS_EXPR, integer_type_node, *pfn,\n \t\t\t      integer_one_node));\n \t  break;"}]}