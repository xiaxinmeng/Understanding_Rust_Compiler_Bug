{"sha": "39d67d5bd4adfe3af3e581dc4309f1a5319f8f21", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzlkNjdkNWJkNGFkZmUzYWYzZTU4MWRjNDMwOWYxYTUzMTlmOGYyMQ==", "commit": {"author": {"name": "J\"orn Rennecke", "email": "joern.rennecke@st.com", "date": "2005-08-23T12:27:53Z"}, "committer": {"name": "Joern Rennecke", "email": "amylaar@gcc.gnu.org", "date": "2005-08-23T12:27:53Z"}, "message": "re PR middle-end/23467 (alignment of member doesn't always carry over to alignment of struct.)\n\ngcc:\n        PR middle-end/23467\n        * stor-layout.c (finalize_type_size): Dont override\n        existing alignment with a smaller alignment from the mode.\ntestsuite:\n        PR middle-end/23467\n        * gcc.c-torture/execute/pr23467.c: New test.\n\nFrom-SVN: r103394", "tree": {"sha": "efb0232bd620d3f2ac48704c6333162375b44560", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/efb0232bd620d3f2ac48704c6333162375b44560"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/39d67d5bd4adfe3af3e581dc4309f1a5319f8f21", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/39d67d5bd4adfe3af3e581dc4309f1a5319f8f21", "html_url": "https://github.com/Rust-GCC/gccrs/commit/39d67d5bd4adfe3af3e581dc4309f1a5319f8f21", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/39d67d5bd4adfe3af3e581dc4309f1a5319f8f21/comments", "author": null, "committer": null, "parents": [{"sha": "9191d641185448ad719c02beefd994fc7c5dacbf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9191d641185448ad719c02beefd994fc7c5dacbf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9191d641185448ad719c02beefd994fc7c5dacbf"}], "stats": {"total": 40, "additions": 38, "deletions": 2}, "files": [{"sha": "407f6f5452d8707f34c45be01643a93414e5299e", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/39d67d5bd4adfe3af3e581dc4309f1a5319f8f21/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/39d67d5bd4adfe3af3e581dc4309f1a5319f8f21/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=39d67d5bd4adfe3af3e581dc4309f1a5319f8f21", "patch": "@@ -1,3 +1,9 @@\n+2005-08-23  J\"orn Rennecke <joern.rennecke@st.com>\n+\n+\tPR middle-end/23467\n+\t* stor-layout.c (finalize_type_size): Dont override\n+\texisting alignment with a smaller alignment from the mode.\n+\n 2005-08-23  Sebastian Pop  <pop@cri.ensmp.fr>\n \n \t* lambda-code.c (lambda_vector_lexico_pos): Moved..."}, {"sha": "0ec818d7fbd26f5d23d1d8c98d450bd0710bbdbb", "filename": "gcc/stor-layout.c", "status": "modified", "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/39d67d5bd4adfe3af3e581dc4309f1a5319f8f21/gcc%2Fstor-layout.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/39d67d5bd4adfe3af3e581dc4309f1a5319f8f21/gcc%2Fstor-layout.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fstor-layout.c?ref=39d67d5bd4adfe3af3e581dc4309f1a5319f8f21", "patch": "@@ -1407,8 +1407,15 @@ finalize_type_size (tree type)\n \t      && TREE_CODE (type) != QUAL_UNION_TYPE\n \t      && TREE_CODE (type) != ARRAY_TYPE)))\n     {\n-      TYPE_ALIGN (type) = GET_MODE_ALIGNMENT (TYPE_MODE (type));\n-      TYPE_USER_ALIGN (type) = 0;\n+      unsigned mode_align = GET_MODE_ALIGNMENT (TYPE_MODE (type));\n+\n+      /* Don't override a larger alignment requirement coming from a user\n+\t alignment of one of the fields.  */\n+      if (mode_align >= TYPE_ALIGN (type))\n+\t{\n+\t  TYPE_ALIGN (type) = mode_align;\n+\t  TYPE_USER_ALIGN (type) = 0;\n+\t}\n     }\n \n   /* Do machine-dependent extra alignment.  */"}, {"sha": "fe03c798c453c165e709e620bcb0034ae45766b6", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/39d67d5bd4adfe3af3e581dc4309f1a5319f8f21/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/39d67d5bd4adfe3af3e581dc4309f1a5319f8f21/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=39d67d5bd4adfe3af3e581dc4309f1a5319f8f21", "patch": "@@ -1,3 +1,8 @@\n+2005-08-23  J\"orn Rennecke <joern.rennecke@st.com>\n+\n+\tPR middle-end/23467\n+\t* gcc.c-torture/execute/pr23467.c: New test.\n+\n 2005-08-23  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR tree-optimization/22043"}, {"sha": "71ec3da424b4b75902f52b3fd4237e20932cad7d", "filename": "gcc/testsuite/gcc.c-torture/execute/pr23467.c", "status": "added", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/39d67d5bd4adfe3af3e581dc4309f1a5319f8f21/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fpr23467.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/39d67d5bd4adfe3af3e581dc4309f1a5319f8f21/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fpr23467.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fpr23467.c?ref=39d67d5bd4adfe3af3e581dc4309f1a5319f8f21", "patch": "@@ -0,0 +1,18 @@\n+struct s1\n+{\n+  int __attribute__ ((aligned (8))) a;\n+};\n+\n+struct\n+{\n+  char c;\n+  struct s1 m;\n+} v;\n+\n+int\n+main (void)\n+{\n+  if ((int)&v.m & 7)\n+    abort ();\n+  exit (0);\n+}"}]}