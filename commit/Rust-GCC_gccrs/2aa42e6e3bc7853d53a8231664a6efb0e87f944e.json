{"sha": "2aa42e6e3bc7853d53a8231664a6efb0e87f944e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MmFhNDJlNmUzYmM3ODUzZDUzYTgyMzE2NjRhNmVmYjBlODdmOTQ0ZQ==", "commit": {"author": {"name": "Nathan Froyd", "email": "froydnj@codesourcery.com", "date": "2008-01-28T18:31:19Z"}, "committer": {"name": "Nathan Froyd", "email": "froydnj@gcc.gnu.org", "date": "2008-01-28T18:31:19Z"}, "message": "re PR target/31535 (ICE on attempt to put SPE vector variables in SDA)\n\ngcc/\n\tPR 31535\n\t* config/rs6000/rs6000.c (small_data_operand): Vectors and floats\n\tare not legitimate small data references on SPE targets.\n\ngcc/testsuite/\n\tPR 31535\n\t* gcc.target/powerpc/spe-small-data-1.c: New test.\n\t* gcc.target/powerpc/spe-small-data-2.c: New test.\n\nFrom-SVN: r131914", "tree": {"sha": "ad010312b214348b4d4787268c8ad227aa97e8f4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ad010312b214348b4d4787268c8ad227aa97e8f4"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2aa42e6e3bc7853d53a8231664a6efb0e87f944e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2aa42e6e3bc7853d53a8231664a6efb0e87f944e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2aa42e6e3bc7853d53a8231664a6efb0e87f944e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2aa42e6e3bc7853d53a8231664a6efb0e87f944e/comments", "author": null, "committer": null, "parents": [{"sha": "64a96f5bc3736c2d423823d1ca135eef3760cf6b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/64a96f5bc3736c2d423823d1ca135eef3760cf6b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/64a96f5bc3736c2d423823d1ca135eef3760cf6b"}], "stats": {"total": 45, "additions": 45, "deletions": 0}, "files": [{"sha": "753539e566332ebb50a4e977a976420abbd0f9cb", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2aa42e6e3bc7853d53a8231664a6efb0e87f944e/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2aa42e6e3bc7853d53a8231664a6efb0e87f944e/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=2aa42e6e3bc7853d53a8231664a6efb0e87f944e", "patch": "@@ -1,3 +1,9 @@\n+2008-01-28  Nathan Froyd  <froydnj@codesourcery.com>\n+\n+\tPR 31535\n+\t* config/rs6000/rs6000.c (small_data_operand): Vectors and floats\n+\tare not legitimate small data references on SPE targets.\n+\n 2008-01-28  David Daney  <ddaney@avtrex.com>\n \n \t* doc/install.texi (mips-*-*): Recommend binutils 2.18."}, {"sha": "4ebea38388bf728dabd39e12f451658cb1d3e0dc", "filename": "gcc/config/rs6000/rs6000.c", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2aa42e6e3bc7853d53a8231664a6efb0e87f944e/gcc%2Fconfig%2Frs6000%2Frs6000.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2aa42e6e3bc7853d53a8231664a6efb0e87f944e/gcc%2Fconfig%2Frs6000%2Frs6000.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.c?ref=2aa42e6e3bc7853d53a8231664a6efb0e87f944e", "patch": "@@ -3238,6 +3238,13 @@ small_data_operand (rtx op ATTRIBUTE_UNUSED,\n   if (DEFAULT_ABI != ABI_V4)\n     return 0;\n \n+  /* Vector and float memory instructions have a limited offset on the\n+     SPE, so using a vector or float variable directly as an operand is\n+     not useful.  */\n+  if (TARGET_SPE\n+      && (SPE_VECTOR_MODE (mode) || FLOAT_MODE_P (mode)))\n+    return 0;\n+\n   if (GET_CODE (op) == SYMBOL_REF)\n     sym_ref = op;\n "}, {"sha": "465fc8a7e23056409a5fc45b4c3d00d0969b9424", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2aa42e6e3bc7853d53a8231664a6efb0e87f944e/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2aa42e6e3bc7853d53a8231664a6efb0e87f944e/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=2aa42e6e3bc7853d53a8231664a6efb0e87f944e", "patch": "@@ -1,3 +1,9 @@\n+2008-01-28  Nathan Froyd  <froydnj@codesourcery.com>\n+\n+\tPR 31535\n+\t* gcc.target/powerpc/spe-small-data-1.c: New test.\n+\t* gcc.target/powerpc/spe-small-data-2.c: New test.\n+\n 2008-01-28  Thomas Koenig  <tkoenig@gcc.gnu.org>\n \n \tPR libfortran/34980"}, {"sha": "8bdb154e1af167267de6325a5e304a578c51df9f", "filename": "gcc/testsuite/gcc.target/powerpc/spe-small-data-1.c", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2aa42e6e3bc7853d53a8231664a6efb0e87f944e/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fspe-small-data-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2aa42e6e3bc7853d53a8231664a6efb0e87f944e/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fspe-small-data-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fspe-small-data-1.c?ref=2aa42e6e3bc7853d53a8231664a6efb0e87f944e", "patch": "@@ -0,0 +1,14 @@\n+/* Verify that we don't ICE trying to put SPE data in .sdata2.  */\n+/* { dg-do run { target { powerpc*-*-linux* && powerpc_spe } } } */\n+/* { dg-options \"-msdata=eabi -mcall-eabi -G 8\" } */\n+\n+#include <spe.h>\n+\n+__ev64_fs__ x;\n+\n+int main(void)\n+{\n+  x = __ev_fsabs (x);\n+  return(0);\n+}\n+"}, {"sha": "2a466e344fb0bc8b1947dfc7a9b4ace93a4cbec1", "filename": "gcc/testsuite/gcc.target/powerpc/spe-small-data-2.c", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2aa42e6e3bc7853d53a8231664a6efb0e87f944e/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fspe-small-data-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2aa42e6e3bc7853d53a8231664a6efb0e87f944e/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fspe-small-data-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fspe-small-data-2.c?ref=2aa42e6e3bc7853d53a8231664a6efb0e87f944e", "patch": "@@ -0,0 +1,12 @@\n+/* Verify that we don't ICE trying to put float data in .sdata2.  */\n+/* { dg-do run { target { powerpc*-*-linux* && powerpc_spe } } } */\n+/* { dg-options \"-msdata=eabi -mcall-eabi -G 8\" } */\n+\n+double x;\n+\n+int main(void)\n+{\n+  x = x * 2;\n+  return(0);\n+}\n+"}]}