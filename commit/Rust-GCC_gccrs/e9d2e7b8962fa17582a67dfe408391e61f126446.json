{"sha": "e9d2e7b8962fa17582a67dfe408391e61f126446", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTlkMmU3Yjg5NjJmYTE3NTgyYTY3ZGZlNDA4MzkxZTYxZjEyNjQ0Ng==", "commit": {"author": {"name": "Uros Bizjak", "email": "ubizjak@gmail.com", "date": "2019-05-07T21:36:42Z"}, "committer": {"name": "Uros Bizjak", "email": "uros@gcc.gnu.org", "date": "2019-05-07T21:36:42Z"}, "message": "i386.md (cvt_mnemonic): New mode attribute.\n\n\t* config/i386/i386.md (cvt_mnemonic): New mode attribute.\n\t(ashr<mode>3_cvt): Merge insn pattern from ashrsi3_cvt and\n\tashrdi3_cvt using SWI48 mode iterator.\n\nFrom-SVN: r270981", "tree": {"sha": "dcae14ba358d30c4d536791c746c998fc730bd34", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/dcae14ba358d30c4d536791c746c998fc730bd34"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e9d2e7b8962fa17582a67dfe408391e61f126446", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e9d2e7b8962fa17582a67dfe408391e61f126446", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e9d2e7b8962fa17582a67dfe408391e61f126446", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e9d2e7b8962fa17582a67dfe408391e61f126446/comments", "author": {"login": "ubizjak", "id": 55479990, "node_id": "MDQ6VXNlcjU1NDc5OTkw", "avatar_url": "https://avatars.githubusercontent.com/u/55479990?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ubizjak", "html_url": "https://github.com/ubizjak", "followers_url": "https://api.github.com/users/ubizjak/followers", "following_url": "https://api.github.com/users/ubizjak/following{/other_user}", "gists_url": "https://api.github.com/users/ubizjak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ubizjak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ubizjak/subscriptions", "organizations_url": "https://api.github.com/users/ubizjak/orgs", "repos_url": "https://api.github.com/users/ubizjak/repos", "events_url": "https://api.github.com/users/ubizjak/events{/privacy}", "received_events_url": "https://api.github.com/users/ubizjak/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "61145d937ba07e368d8251fd0ffe0b987b50a7b5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/61145d937ba07e368d8251fd0ffe0b987b50a7b5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/61145d937ba07e368d8251fd0ffe0b987b50a7b5"}], "stats": {"total": 46, "additions": 20, "deletions": 26}, "files": [{"sha": "2ebed19240e6be27d34b9f3e37705b1d63b85633", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e9d2e7b8962fa17582a67dfe408391e61f126446/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e9d2e7b8962fa17582a67dfe408391e61f126446/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=e9d2e7b8962fa17582a67dfe408391e61f126446", "patch": "@@ -1,3 +1,9 @@\n+2019-05-07  Uro\u0161 Bizjak  <ubizjak@gmail.com>\n+\n+\t* config/i386/i386.md (cvt_mnemonic): New mode attribute.\n+\t(ashr<mode>3_cvt): Merge insn pattern from ashrsi3_cvt and\n+\tashrdi3_cvt using SWI48 mode iterator.\n+\n 2019-05-07  Alejandro Martinez  <alejandro.martinezvicente@arm.com>\n \n \t* config/aarch64/aarch64-sve.md (<su>abd<mode>_3): New define_expand."}, {"sha": "44e4f4a554522bba777bc463982e463567ee190f", "filename": "gcc/config/i386/i386.md", "status": "modified", "additions": 14, "deletions": 26, "changes": 40, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e9d2e7b8962fa17582a67dfe408391e61f126446/gcc%2Fconfig%2Fi386%2Fi386.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e9d2e7b8962fa17582a67dfe408391e61f126446/gcc%2Fconfig%2Fi386%2Fi386.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386.md?ref=e9d2e7b8962fa17582a67dfe408391e61f126446", "patch": "@@ -10872,22 +10872,27 @@\n    (set_attr \"amdfam10_decode\" \"vector\")\n    (set_attr \"bdver1_decode\" \"vector\")])\n \n-(define_insn \"ashrdi3_cvt\"\n-  [(set (match_operand:DI 0 \"nonimmediate_operand\" \"=*d,rm\")\n-\t(ashiftrt:DI (match_operand:DI 1 \"nonimmediate_operand\" \"*a,0\")\n-\t\t     (match_operand:QI 2 \"const_int_operand\")))\n+;; Base name for insn mnemonic.\n+(define_mode_attr cvt_mnemonic\n+  [(SI \"{cltd|cdq}\") (DI \"{cqto|cqo}\")])\n+\n+(define_insn \"ashr<mode>3_cvt\"\n+  [(set (match_operand:SWI48 0 \"nonimmediate_operand\" \"=*d,rm\")\n+\t(ashiftrt:SWI48\n+\t  (match_operand:SWI48 1 \"nonimmediate_operand\" \"*a,0\")\n+\t  (match_operand:QI 2 \"const_int_operand\")))\n    (clobber (reg:CC FLAGS_REG))]\n-  \"TARGET_64BIT && INTVAL (operands[2]) == 63\n+  \"INTVAL (operands[2]) == GET_MODE_BITSIZE (<MODE>mode)-1\n    && (TARGET_USE_CLTD || optimize_function_for_size_p (cfun))\n-   && ix86_binary_operator_ok (ASHIFTRT, DImode, operands)\"\n+   && ix86_binary_operator_ok (ASHIFTRT, <MODE>mode, operands)\"\n   \"@\n-   {cqto|cqo}\n-   sar{q}\\t{%2, %0|%0, %2}\"\n+   <cvt_mnemonic>\n+   sar{<imodesuffix>}\\t{%2, %0|%0, %2}\"\n   [(set_attr \"type\" \"imovx,ishift\")\n    (set_attr \"prefix_0f\" \"0,*\")\n    (set_attr \"length_immediate\" \"0,*\")\n    (set_attr \"modrm\" \"0,1\")\n-   (set_attr \"mode\" \"DI\")])\n+   (set_attr \"mode\" \"<MODE>\")])\n \n (define_insn \"*ashrsi3_cvt_zext\"\n   [(set (match_operand:DI 0 \"register_operand\" \"=*d,r\")\n@@ -10907,23 +10912,6 @@\n    (set_attr \"modrm\" \"0,1\")\n    (set_attr \"mode\" \"SI\")])\n \n-(define_insn \"ashrsi3_cvt\"\n-  [(set (match_operand:SI 0 \"nonimmediate_operand\" \"=*d,rm\")\n-\t(ashiftrt:SI (match_operand:SI 1 \"nonimmediate_operand\" \"*a,0\")\n-\t\t     (match_operand:QI 2 \"const_int_operand\")))\n-   (clobber (reg:CC FLAGS_REG))]\n-  \"INTVAL (operands[2]) == 31\n-   && (TARGET_USE_CLTD || optimize_function_for_size_p (cfun))\n-   && ix86_binary_operator_ok (ASHIFTRT, SImode, operands)\"\n-  \"@\n-   {cltd|cdq}\n-   sar{l}\\t{%2, %0|%0, %2}\"\n-  [(set_attr \"type\" \"imovx,ishift\")\n-   (set_attr \"prefix_0f\" \"0,*\")\n-   (set_attr \"length_immediate\" \"0,*\")\n-   (set_attr \"modrm\" \"0,1\")\n-   (set_attr \"mode\" \"SI\")])\n-\n (define_expand \"x86_shift<mode>_adj_3\"\n   [(use (match_operand:SWI48 0 \"register_operand\"))\n    (use (match_operand:SWI48 1 \"register_operand\"))"}]}