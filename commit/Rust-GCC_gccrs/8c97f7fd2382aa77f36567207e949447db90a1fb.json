{"sha": "8c97f7fd2382aa77f36567207e949447db90a1fb", "node_id": "C_kwDOANBUbNoAKDhjOTdmN2ZkMjM4MmFhNzdmMzY1NjcyMDdlOTQ5NDQ3ZGI5MGExZmI", "commit": {"author": {"name": "Harald Anlauf", "email": "anlauf@gmx.de", "date": "2022-05-08T20:04:27Z"}, "committer": {"name": "Harald Anlauf", "email": "anlauf@gmx.de", "date": "2022-05-09T18:14:33Z"}, "message": "Fortran: check for non-optional spaces between adjacent keywords\n\nIn free format, spaces between adjacent keywords are not optional except\nwhen a combination is explicitly listed (e.g. F2018: table 6.2).  The\nfollowing combinations thus require separating blanks: CHANGE TEAM,\nERROR STOP, EVENT POST, EVENT WAIT, FAIL IMAGE, FORM TEAM, SELECT RANK,\nSYNC ALL, SYNC IMAGES, SYNC MEMORY, SYNC TEAM, TYPE IS.\n\ngcc/fortran/ChangeLog:\n\n\tPR fortran/105501\n\t* match.cc (gfc_match_if): Adjust patterns used for matching.\n\t(gfc_match_select_rank): Likewise.\n\t* parse.cc (decode_statement): Likewise.\n\ngcc/testsuite/ChangeLog:\n\n\tPR fortran/105501\n\t* gfortran.dg/pr105501.f90: New test.", "tree": {"sha": "4f9e0d398c2a7059e7a102b47e5f46b0f8b960c3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4f9e0d398c2a7059e7a102b47e5f46b0f8b960c3"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8c97f7fd2382aa77f36567207e949447db90a1fb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8c97f7fd2382aa77f36567207e949447db90a1fb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8c97f7fd2382aa77f36567207e949447db90a1fb", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8c97f7fd2382aa77f36567207e949447db90a1fb/comments", "author": {"login": "harald-anlauf", "id": 90786862, "node_id": "MDQ6VXNlcjkwNzg2ODYy", "avatar_url": "https://avatars.githubusercontent.com/u/90786862?v=4", "gravatar_id": "", "url": "https://api.github.com/users/harald-anlauf", "html_url": "https://github.com/harald-anlauf", "followers_url": "https://api.github.com/users/harald-anlauf/followers", "following_url": "https://api.github.com/users/harald-anlauf/following{/other_user}", "gists_url": "https://api.github.com/users/harald-anlauf/gists{/gist_id}", "starred_url": "https://api.github.com/users/harald-anlauf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/harald-anlauf/subscriptions", "organizations_url": "https://api.github.com/users/harald-anlauf/orgs", "repos_url": "https://api.github.com/users/harald-anlauf/repos", "events_url": "https://api.github.com/users/harald-anlauf/events{/privacy}", "received_events_url": "https://api.github.com/users/harald-anlauf/received_events", "type": "User", "site_admin": false}, "committer": {"login": "harald-anlauf", "id": 90786862, "node_id": "MDQ6VXNlcjkwNzg2ODYy", "avatar_url": "https://avatars.githubusercontent.com/u/90786862?v=4", "gravatar_id": "", "url": "https://api.github.com/users/harald-anlauf", "html_url": "https://github.com/harald-anlauf", "followers_url": "https://api.github.com/users/harald-anlauf/followers", "following_url": "https://api.github.com/users/harald-anlauf/following{/other_user}", "gists_url": "https://api.github.com/users/harald-anlauf/gists{/gist_id}", "starred_url": "https://api.github.com/users/harald-anlauf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/harald-anlauf/subscriptions", "organizations_url": "https://api.github.com/users/harald-anlauf/orgs", "repos_url": "https://api.github.com/users/harald-anlauf/repos", "events_url": "https://api.github.com/users/harald-anlauf/events{/privacy}", "received_events_url": "https://api.github.com/users/harald-anlauf/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8a39c7c128dbf4405821778724c5a1017ab12e06", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8a39c7c128dbf4405821778724c5a1017ab12e06", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8a39c7c128dbf4405821778724c5a1017ab12e06"}], "stats": {"total": 59, "additions": 37, "deletions": 22}, "files": [{"sha": "1aa3053e70eb7fa1919733485549d0e84bd18966", "filename": "gcc/fortran/match.cc", "status": "modified", "additions": 11, "deletions": 11, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8c97f7fd2382aa77f36567207e949447db90a1fb/gcc%2Ffortran%2Fmatch.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8c97f7fd2382aa77f36567207e949447db90a1fb/gcc%2Ffortran%2Fmatch.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fmatch.cc?ref=8c97f7fd2382aa77f36567207e949447db90a1fb", "patch": "@@ -1606,21 +1606,21 @@ gfc_match_if (gfc_statement *if_type)\n   match (\"assign\", gfc_match_assign, ST_LABEL_ASSIGNMENT)\n   match (\"backspace\", gfc_match_backspace, ST_BACKSPACE)\n   match (\"call\", gfc_match_call, ST_CALL)\n-  match (\"change team\", gfc_match_change_team, ST_CHANGE_TEAM)\n+  match (\"change% team\", gfc_match_change_team, ST_CHANGE_TEAM)\n   match (\"close\", gfc_match_close, ST_CLOSE)\n   match (\"continue\", gfc_match_continue, ST_CONTINUE)\n   match (\"cycle\", gfc_match_cycle, ST_CYCLE)\n   match (\"deallocate\", gfc_match_deallocate, ST_DEALLOCATE)\n   match (\"end file\", gfc_match_endfile, ST_END_FILE)\n   match (\"end team\", gfc_match_end_team, ST_END_TEAM)\n-  match (\"error stop\", gfc_match_error_stop, ST_ERROR_STOP)\n-  match (\"event post\", gfc_match_event_post, ST_EVENT_POST)\n-  match (\"event wait\", gfc_match_event_wait, ST_EVENT_WAIT)\n+  match (\"error% stop\", gfc_match_error_stop, ST_ERROR_STOP)\n+  match (\"event% post\", gfc_match_event_post, ST_EVENT_POST)\n+  match (\"event% wait\", gfc_match_event_wait, ST_EVENT_WAIT)\n   match (\"exit\", gfc_match_exit, ST_EXIT)\n-  match (\"fail image\", gfc_match_fail_image, ST_FAIL_IMAGE)\n+  match (\"fail% image\", gfc_match_fail_image, ST_FAIL_IMAGE)\n   match (\"flush\", gfc_match_flush, ST_FLUSH)\n   match (\"forall\", match_simple_forall, ST_FORALL)\n-  match (\"form team\", gfc_match_form_team, ST_FORM_TEAM)\n+  match (\"form% team\", gfc_match_form_team, ST_FORM_TEAM)\n   match (\"go to\", gfc_match_goto, ST_GOTO)\n   match (\"if\", match_arithmetic_if, ST_ARITHMETIC_IF)\n   match (\"inquire\", gfc_match_inquire, ST_INQUIRE)\n@@ -1634,10 +1634,10 @@ gfc_match_if (gfc_statement *if_type)\n   match (\"rewind\", gfc_match_rewind, ST_REWIND)\n   match (\"stop\", gfc_match_stop, ST_STOP)\n   match (\"wait\", gfc_match_wait, ST_WAIT)\n-  match (\"sync all\", gfc_match_sync_all, ST_SYNC_CALL);\n-  match (\"sync images\", gfc_match_sync_images, ST_SYNC_IMAGES);\n-  match (\"sync memory\", gfc_match_sync_memory, ST_SYNC_MEMORY);\n-  match (\"sync team\", gfc_match_sync_team, ST_SYNC_TEAM)\n+  match (\"sync% all\", gfc_match_sync_all, ST_SYNC_CALL);\n+  match (\"sync% images\", gfc_match_sync_images, ST_SYNC_IMAGES);\n+  match (\"sync% memory\", gfc_match_sync_memory, ST_SYNC_MEMORY);\n+  match (\"sync% team\", gfc_match_sync_team, ST_SYNC_TEAM)\n   match (\"unlock\", gfc_match_unlock, ST_UNLOCK)\n   match (\"where\", match_simple_where, ST_WHERE)\n   match (\"write\", gfc_match_write, ST_WRITE)\n@@ -6716,7 +6716,7 @@ gfc_match_select_rank (void)\n   if (m == MATCH_ERROR)\n     return m;\n \n-  m = gfc_match (\" select rank ( \");\n+  m = gfc_match (\" select% rank ( \");\n   if (m != MATCH_YES)\n     return m;\n "}, {"sha": "7356d1b5a3ab206cd4c70ab43776a7e2d1a66148", "filename": "gcc/fortran/parse.cc", "status": "modified", "additions": 11, "deletions": 11, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8c97f7fd2382aa77f36567207e949447db90a1fb/gcc%2Ffortran%2Fparse.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8c97f7fd2382aa77f36567207e949447db90a1fb/gcc%2Ffortran%2Fparse.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fparse.cc?ref=8c97f7fd2382aa77f36567207e949447db90a1fb", "patch": "@@ -454,7 +454,7 @@ decode_statement (void)\n \n     case 'c':\n       match (\"call\", gfc_match_call, ST_CALL);\n-      match (\"change team\", gfc_match_change_team, ST_CHANGE_TEAM);\n+      match (\"change% team\", gfc_match_change_team, ST_CHANGE_TEAM);\n       match (\"close\", gfc_match_close, ST_CLOSE);\n       match (\"continue\", gfc_match_continue, ST_CONTINUE);\n       match (\"contiguous\", gfc_match_contiguous, ST_ATTR_DECL);\n@@ -479,7 +479,7 @@ decode_statement (void)\n       match (\"else\", gfc_match_else, ST_ELSE);\n       match (\"else where\", gfc_match_elsewhere, ST_ELSEWHERE);\n       match (\"else if\", gfc_match_elseif, ST_ELSEIF);\n-      match (\"error stop\", gfc_match_error_stop, ST_ERROR_STOP);\n+      match (\"error% stop\", gfc_match_error_stop, ST_ERROR_STOP);\n       match (\"enum , bind ( c )\", gfc_match_enum, ST_ENUM);\n \n       if (gfc_match_end (&st) == MATCH_YES)\n@@ -488,15 +488,15 @@ decode_statement (void)\n       match (\"entry% \", gfc_match_entry, ST_ENTRY);\n       match (\"equivalence\", gfc_match_equivalence, ST_EQUIVALENCE);\n       match (\"external\", gfc_match_external, ST_ATTR_DECL);\n-      match (\"event post\", gfc_match_event_post, ST_EVENT_POST);\n-      match (\"event wait\", gfc_match_event_wait, ST_EVENT_WAIT);\n+      match (\"event% post\", gfc_match_event_post, ST_EVENT_POST);\n+      match (\"event% wait\", gfc_match_event_wait, ST_EVENT_WAIT);\n       break;\n \n     case 'f':\n-      match (\"fail image\", gfc_match_fail_image, ST_FAIL_IMAGE);\n+      match (\"fail% image\", gfc_match_fail_image, ST_FAIL_IMAGE);\n       match (\"final\", gfc_match_final_decl, ST_FINAL);\n       match (\"flush\", gfc_match_flush, ST_FLUSH);\n-      match (\"form team\", gfc_match_form_team, ST_FORM_TEAM);\n+      match (\"form% team\", gfc_match_form_team, ST_FORM_TEAM);\n       match (\"format\", gfc_match_format, ST_FORMAT);\n       break;\n \n@@ -562,16 +562,16 @@ decode_statement (void)\n       match (\"save\", gfc_match_save, ST_ATTR_DECL);\n       match (\"static\", gfc_match_static, ST_ATTR_DECL);\n       match (\"submodule\", gfc_match_submodule, ST_SUBMODULE);\n-      match (\"sync all\", gfc_match_sync_all, ST_SYNC_ALL);\n-      match (\"sync images\", gfc_match_sync_images, ST_SYNC_IMAGES);\n-      match (\"sync memory\", gfc_match_sync_memory, ST_SYNC_MEMORY);\n-      match (\"sync team\", gfc_match_sync_team, ST_SYNC_TEAM);\n+      match (\"sync% all\", gfc_match_sync_all, ST_SYNC_ALL);\n+      match (\"sync% images\", gfc_match_sync_images, ST_SYNC_IMAGES);\n+      match (\"sync% memory\", gfc_match_sync_memory, ST_SYNC_MEMORY);\n+      match (\"sync% team\", gfc_match_sync_team, ST_SYNC_TEAM);\n       break;\n \n     case 't':\n       match (\"target\", gfc_match_target, ST_ATTR_DECL);\n       match (\"type\", gfc_match_derived_decl, ST_DERIVED_DECL);\n-      match (\"type is\", gfc_match_type_is, ST_TYPE_IS);\n+      match (\"type% is\", gfc_match_type_is, ST_TYPE_IS);\n       break;\n \n     case 'u':"}, {"sha": "85492e2d41c9429287d5416e57c611df99b7c703", "filename": "gcc/testsuite/gfortran.dg/pr105501.f90", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8c97f7fd2382aa77f36567207e949447db90a1fb/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr105501.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8c97f7fd2382aa77f36567207e949447db90a1fb/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr105501.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr105501.f90?ref=8c97f7fd2382aa77f36567207e949447db90a1fb", "patch": "@@ -0,0 +1,15 @@\n+! { dg-do compile }\n+! PR fortran/105501 - check for non-optional spaces between adjacent keywords\n+\n+MODULE M\n+  TYPE T\n+     INTEGER I\n+  END TYPE\n+CONTAINS\n+  SUBROUTINE S(X)\n+    CLASS(T), POINTER :: X\n+    SELECTTYPE (X) ! blank between SELECT and TYPE is optional\n+    TYPEIS (T)     ! { dg-error \"Mangled derived type definition\" }\n+    END SELECT\n+  END SUBROUTINE\n+END MODULE"}]}