{"sha": "ac853c9071ab9a8df483c26fe8672732546c51ab", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWM4NTNjOTA3MWFiOWE4ZGY0ODNjMjZmZTg2NzI3MzI1NDZjNTFhYg==", "commit": {"author": {"name": "Paolo Carlini", "email": "paolo.carlini@oracle.com", "date": "2017-06-01T10:20:27Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2017-06-01T10:20:27Z"}, "message": "re PR c++/80896 ([[nodiscard]] is ignored for functions returning references)\n\n/cp\n2017-06-01  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/80896\n\t* cvt.c (convert_to_void): Possibly call maybe_warn_nodiscard\n\tfor case INDIRECT_REF too in the main switch.\n\n/testsuite\n2017-06-01  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/80896\n\t* g++.dg/cpp1z/nodiscard5.C: New.\n\nFrom-SVN: r248784", "tree": {"sha": "840e9172b123a07168d915101b1f9441c3c29348", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/840e9172b123a07168d915101b1f9441c3c29348"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ac853c9071ab9a8df483c26fe8672732546c51ab", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ac853c9071ab9a8df483c26fe8672732546c51ab", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ac853c9071ab9a8df483c26fe8672732546c51ab", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ac853c9071ab9a8df483c26fe8672732546c51ab/comments", "author": null, "committer": null, "parents": [{"sha": "7841f13c8064c7d8f4eb13acd396bd0455e12c26", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7841f13c8064c7d8f4eb13acd396bd0455e12c26", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7841f13c8064c7d8f4eb13acd396bd0455e12c26"}], "stats": {"total": 20, "additions": 20, "deletions": 0}, "files": [{"sha": "60fe1a5436a2e76a68a47f33dfd2992644208d09", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ac853c9071ab9a8df483c26fe8672732546c51ab/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ac853c9071ab9a8df483c26fe8672732546c51ab/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=ac853c9071ab9a8df483c26fe8672732546c51ab", "patch": "@@ -1,3 +1,9 @@\n+2017-06-01  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/80896\n+\t* cvt.c (convert_to_void): Possibly call maybe_warn_nodiscard\n+\tfor case INDIRECT_REF too in the main switch.\n+\n 2017-05-31  Jason Merrill  <jason@redhat.com>\n \n \tPR c++/80840 - ICE with constexpr and reference"}, {"sha": "6b28ef65074bfc5b30fbdf4c9562ddbae4825250", "filename": "gcc/cp/cvt.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ac853c9071ab9a8df483c26fe8672732546c51ab/gcc%2Fcp%2Fcvt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ac853c9071ab9a8df483c26fe8672732546c51ab/gcc%2Fcp%2Fcvt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fcvt.c?ref=ac853c9071ab9a8df483c26fe8672732546c51ab", "patch": "@@ -1296,6 +1296,8 @@ convert_to_void (tree expr, impl_conv_void implicit, tsubst_flags_t complain)\n                 && !is_reference)\n               warning_at (loc, OPT_Wunused_value, \"value computed is not used\");\n             expr = TREE_OPERAND (expr, 0);\n+\t    if (TREE_CODE (expr) == CALL_EXPR)\n+\t      maybe_warn_nodiscard (expr, implicit);\n           }\n \n \tbreak;"}, {"sha": "a1212f24b6b5b9ca05e637c9e60472dd8ed8a799", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ac853c9071ab9a8df483c26fe8672732546c51ab/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ac853c9071ab9a8df483c26fe8672732546c51ab/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=ac853c9071ab9a8df483c26fe8672732546c51ab", "patch": "@@ -1,3 +1,8 @@\n+2017-06-01  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/80896\n+\t* g++.dg/cpp1z/nodiscard5.C: New.\n+\n 2017-06-01  Claudiu Zissulescu  <claziss@synopsys.com>\n \n \t* gcc.target/arc/pr9001195952.c: New test."}, {"sha": "fa9a974355bbd8ff080b675d0d19bf6ce3abd23d", "filename": "gcc/testsuite/g++.dg/cpp1z/nodiscard5.C", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ac853c9071ab9a8df483c26fe8672732546c51ab/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1z%2Fnodiscard5.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ac853c9071ab9a8df483c26fe8672732546c51ab/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1z%2Fnodiscard5.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1z%2Fnodiscard5.C?ref=ac853c9071ab9a8df483c26fe8672732546c51ab", "patch": "@@ -0,0 +1,7 @@\n+// PR c++/80896\n+// { dg-do compile { target c++11 } }\n+\n+int x = 42;\n+[[nodiscard]] int& func() { return x; }\n+\n+int main() { func(); }  // { dg-warning \"ignoring return value\" }"}]}