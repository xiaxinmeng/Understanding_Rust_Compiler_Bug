{"sha": "a0fac73d2b6a463a96c93d8ea37d1c33e605aa93", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTBmYWM3M2QyYjZhNDYzYTk2YzkzZDhlYTM3ZDFjMzNlNjA1YWE5Mw==", "commit": {"author": {"name": "Roger Sayle", "email": "roger@eyesopen.com", "date": "2004-08-03T21:24:32Z"}, "committer": {"name": "Roger Sayle", "email": "sayle@gcc.gnu.org", "date": "2004-08-03T21:24:32Z"}, "message": "re PR middle-end/16790 (Integer down cast ignored in larger expression)\n\n\n\tPR middle-end/16790\n\t* fold-const.c (extract_muldiv_1) <NOP_EXPR>: Disallow local\n\ttruncations, not just global truncations.\n\n\t* gcc.c-torture/execute/pr16790-1.c: New test case.\n\nFrom-SVN: r85506", "tree": {"sha": "0b16b01e23d9aa185acb22cc027765bf8cef2029", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0b16b01e23d9aa185acb22cc027765bf8cef2029"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a0fac73d2b6a463a96c93d8ea37d1c33e605aa93", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a0fac73d2b6a463a96c93d8ea37d1c33e605aa93", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a0fac73d2b6a463a96c93d8ea37d1c33e605aa93", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a0fac73d2b6a463a96c93d8ea37d1c33e605aa93/comments", "author": null, "committer": null, "parents": [{"sha": "5357b1f9df2a6613d463096a8808f34a4ee6f60e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5357b1f9df2a6613d463096a8808f34a4ee6f60e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5357b1f9df2a6613d463096a8808f34a4ee6f60e"}], "stats": {"total": 58, "additions": 55, "deletions": 3}, "files": [{"sha": "2825c795b1f4be567aa8b3a9454254626c2ce5ec", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a0fac73d2b6a463a96c93d8ea37d1c33e605aa93/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a0fac73d2b6a463a96c93d8ea37d1c33e605aa93/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=a0fac73d2b6a463a96c93d8ea37d1c33e605aa93", "patch": "@@ -1,3 +1,9 @@\n+2004-08-03  Roger Sayle  <roger@eyesopen.com>\n+\n+\tPR middle-end/16790\n+\t* fold-const.c (extract_muldiv_1) <NOP_EXPR>: Disallow local\n+\ttruncations, not just global truncations.\n+\n 2004-08-03  Andrew Pinski  <apinski@apple.com>\n \n \tPR bootstrap/16865"}, {"sha": "503b6f094cfb0c7146f150b653b55610b52d4c6e", "filename": "gcc/fold-const.c", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a0fac73d2b6a463a96c93d8ea37d1c33e605aa93/gcc%2Ffold-const.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a0fac73d2b6a463a96c93d8ea37d1c33e605aa93/gcc%2Ffold-const.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffold-const.c?ref=a0fac73d2b6a463a96c93d8ea37d1c33e605aa93", "patch": "@@ -5102,9 +5102,9 @@ extract_muldiv_1 (tree t, tree c, enum tree_code code, tree wide_type)\n \t\t     && TYPE_IS_SIZETYPE (TREE_TYPE (op0)))\n \t       && (GET_MODE_SIZE (TYPE_MODE (ctype))\n \t           > GET_MODE_SIZE (TYPE_MODE (TREE_TYPE (op0)))))\n-\t      /* ... or its type is larger than ctype,\n-\t\t then we cannot pass through this truncation.  */\n-\t      || (GET_MODE_SIZE (TYPE_MODE (ctype))\n+\t      /* ... or this is a truncation (t is narrower than op0),\n+\t\t then we cannot pass through this narrowing.  */\n+\t      || (GET_MODE_SIZE (TYPE_MODE (type))\n \t\t  < GET_MODE_SIZE (TYPE_MODE (TREE_TYPE (op0))))\n \t      /* ... or signedness changes for division or modulus,\n \t\t then we cannot pass through this conversion.  */"}, {"sha": "db11af67a72182646b7026098b97d34a91b74031", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a0fac73d2b6a463a96c93d8ea37d1c33e605aa93/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a0fac73d2b6a463a96c93d8ea37d1c33e605aa93/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=a0fac73d2b6a463a96c93d8ea37d1c33e605aa93", "patch": "@@ -1,3 +1,8 @@\n+2004-08-03  Roger Sayle  <roger@eyesopen.com>\n+\n+\tPR middle-end/16790\n+\t* gcc.c-torture/execute/pr16790-1.c: New test case.\n+\n 2004-08-03  Mark Mitchell  <mark@codesourcery.com>\n \n \t* gcc.dg/symbian1.c: New test."}, {"sha": "dc6a77404b592df2937b3abaf94d3f8984f53c43", "filename": "gcc/testsuite/gcc.c-torture/execute/pr16790-1.c", "status": "added", "additions": 41, "deletions": 0, "changes": 41, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a0fac73d2b6a463a96c93d8ea37d1c33e605aa93/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fpr16790-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a0fac73d2b6a463a96c93d8ea37d1c33e605aa93/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fpr16790-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fpr16790-1.c?ref=a0fac73d2b6a463a96c93d8ea37d1c33e605aa93", "patch": "@@ -0,0 +1,41 @@\n+/* PR middle-end/16790.  */\n+\n+extern void abort ();\n+\n+static void test1(unsigned int u1)\n+{\n+  unsigned int y_final_1;\n+  signed short y_middle;\n+  unsigned int y_final_2;\n+\n+  y_final_1 = (unsigned int)( (signed short)(u1 * 2) * 3 );\n+  y_middle  =                 (signed short)(u1 * 2);\n+  y_final_2 = (unsigned int)( y_middle * 3 );\n+\n+  if (y_final_1 != y_final_2)\n+    abort ();\n+}\n+\n+\n+static void test2(unsigned int u1)\n+{\n+  unsigned int y_final_1;\n+  signed short y_middle;\n+  unsigned int y_final_2;\n+\n+  y_final_1 = (unsigned int)( (signed short)(u1 << 1) * 3 );\n+  y_middle  =                 (signed short)(u1 << 1);\n+  y_final_2 = (unsigned int)( y_middle * 3 );\n+\n+  if (y_final_1 != y_final_2)\n+    abort ();\n+}\n+\n+\n+int main()\n+{\n+  test1(0x4000U);\n+  test2(0x4000U);\n+  return 0;\n+}\n+"}]}