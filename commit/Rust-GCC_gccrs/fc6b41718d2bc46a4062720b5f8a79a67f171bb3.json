{"sha": "fc6b41718d2bc46a4062720b5f8a79a67f171bb3", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZmM2YjQxNzE4ZDJiYzQ2YTQwNjI3MjBiNWY4YTc5YTY3ZjE3MWJiMw==", "commit": {"author": {"name": "Paolo Carlini", "email": "pcarlini@suse.de", "date": "2004-06-13T09:52:14Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2004-06-13T09:52:14Z"}, "message": "locale_facets.tcc (time_get<>::do_get_time, [...]): Use only once _M_extract_via_format...\n\n2004-06-13  Paolo Carlini  <pcarlini@suse.de>\n\n\t* include/bits/locale_facets.tcc (time_get<>::do_get_time,\n\ttime_get<>::do_get_date): Use only once _M_extract_via_format,\n\tinstead of going through \"%X\"/\"%x\" and calling it two times\n\t(+ using widen).\n\nFrom-SVN: r83059", "tree": {"sha": "2e4ee8c87d1bb9e0d13ac2977c4aea1e11a07707", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2e4ee8c87d1bb9e0d13ac2977c4aea1e11a07707"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/fc6b41718d2bc46a4062720b5f8a79a67f171bb3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fc6b41718d2bc46a4062720b5f8a79a67f171bb3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fc6b41718d2bc46a4062720b5f8a79a67f171bb3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fc6b41718d2bc46a4062720b5f8a79a67f171bb3/comments", "author": null, "committer": null, "parents": [{"sha": "9f680e794f0f38dba5088a50025b23ea9b2ad6ab", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9f680e794f0f38dba5088a50025b23ea9b2ad6ab", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9f680e794f0f38dba5088a50025b23ea9b2ad6ab"}], "stats": {"total": 33, "additions": 19, "deletions": 14}, "files": [{"sha": "1454a0d45762c047154ecba4f0af86ec7853d6d0", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fc6b41718d2bc46a4062720b5f8a79a67f171bb3/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fc6b41718d2bc46a4062720b5f8a79a67f171bb3/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=fc6b41718d2bc46a4062720b5f8a79a67f171bb3", "patch": "@@ -1,3 +1,10 @@\n+2004-06-13  Paolo Carlini  <pcarlini@suse.de>\n+\n+\t* include/bits/locale_facets.tcc (time_get<>::do_get_time,\n+\ttime_get<>::do_get_date): Use only once _M_extract_via_format,\n+\tinstead of going through \"%X\"/\"%x\" and calling it two times\n+\t(+ using widen).\n+\n 2004-06-12  Paolo Carlini  <pcarlini@suse.de>\n \n \t* include/ext/algorithm: Trivial formatting fixes."}, {"sha": "c732e09d8c654d3bae87cd91657ca5944013737f", "filename": "libstdc++-v3/include/bits/locale_facets.tcc", "status": "modified", "additions": 12, "deletions": 14, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fc6b41718d2bc46a4062720b5f8a79a67f171bb3/libstdc%2B%2B-v3%2Finclude%2Fbits%2Flocale_facets.tcc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fc6b41718d2bc46a4062720b5f8a79a67f171bb3/libstdc%2B%2B-v3%2Finclude%2Fbits%2Flocale_facets.tcc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Flocale_facets.tcc?ref=fc6b41718d2bc46a4062720b5f8a79a67f171bb3", "patch": "@@ -1724,10 +1724,8 @@ namespace std\n     time_get<_CharT, _InIter>::do_date_order() const\n     { return time_base::no_order; }\n \n-  // Recursively expand a strftime format string and parse it.  Starts w/ %x\n-  // and %X from do_get_time() and do_get_date(), which translate to a more\n-  // specific string, which may contain yet more strings.  I.e. %x => %r =>\n-  // %H:%M:%S => extracted characters.\n+  // Expand a strftime format string and parse it.  E.g., do_get_date() may\n+  // pass %m/%d/%Y => extracted characters.\n   template<typename _CharT, typename _InIter>\n     _InIter\n     time_get<_CharT, _InIter>::\n@@ -2056,12 +2054,12 @@ namespace std\n     do_get_time(iter_type __beg, iter_type __end, ios_base& __io,\n \t\tios_base::iostate& __err, tm* __tm) const\n     {\n-      _CharT __wcs[3];\n-      const char* __cs = \"%X\";\n       const locale& __loc = __io._M_getloc();\n-      ctype<_CharT> const& __ctype = use_facet<ctype<_CharT> >(__loc);\n-      __ctype.widen(__cs, __cs + 3, __wcs);\n-      __beg = _M_extract_via_format(__beg, __end, __io, __err, __tm, __wcs);\n+      const __timepunct<_CharT>& __tp = use_facet<__timepunct<_CharT> >(__loc);\n+      const char_type*  __times[2];\n+      __tp._M_time_formats(__times);\n+      __beg = _M_extract_via_format(__beg, __end, __io, __err, \n+\t\t\t\t    __tm, __times[0]);\n       if (__beg == __end)\n \t__err |= ios_base::eofbit;\n       return __beg;\n@@ -2073,12 +2071,12 @@ namespace std\n     do_get_date(iter_type __beg, iter_type __end, ios_base& __io,\n \t\tios_base::iostate& __err, tm* __tm) const\n     {\n-      _CharT __wcs[3];\n-      const char* __cs = \"%x\";\n       const locale& __loc = __io._M_getloc();\n-      ctype<_CharT> const& __ctype = use_facet<ctype<_CharT> >(__loc);\n-      __ctype.widen(__cs, __cs + 3, __wcs);\n-      __beg = _M_extract_via_format(__beg, __end, __io, __err, __tm, __wcs);\n+      const __timepunct<_CharT>& __tp = use_facet<__timepunct<_CharT> >(__loc);\n+      const char_type*  __dates[2];\n+      __tp._M_date_formats(__dates);\n+      __beg = _M_extract_via_format(__beg, __end, __io, __err,\n+\t\t\t\t    __tm, __dates[0]);\n       if (__beg == __end)\n \t__err |= ios_base::eofbit;\n       return __beg;"}]}