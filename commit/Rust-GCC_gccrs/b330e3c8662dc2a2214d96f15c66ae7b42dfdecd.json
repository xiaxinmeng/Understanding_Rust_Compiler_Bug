{"sha": "b330e3c8662dc2a2214d96f15c66ae7b42dfdecd", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjMzMGUzYzg2NjJkYzJhMjIxNGQ5NmYxNWM2NmFlN2I0MmRmZGVjZA==", "commit": {"author": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2014-08-01T10:28:52Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2014-08-01T10:28:52Z"}, "message": "[multiple changes]\n\n2014-08-01  Robert Dewar  <dewar@adacore.com>\n\n\t* sem_aggr.adb, sem_ch3.adb, sem_ch5.adb, sem_util.adb,\n\tsem_res.adb: Minor reformatting.\n\n2014-08-01  Vincent Celier  <celier@adacore.com>\n\n\t* make.adb (Initialize): Set Keep_Temporary_Files to True when\n\t-dn is specified.\n\t* makeusg.adb: Add line for new switch --keep-temp-files.\n\t* makeutl.ads (Keep_Temp_Files_Option): New constant String.\n\t* opt.ads (Keep_Temporary_Files): Document that it is also used\n\tby gnatmake and gprbuild.\n\t* switch-m.adb: Recognize new switch --keep-temp-files.\n\nFrom-SVN: r213451", "tree": {"sha": "d53a7b3cb0229c34ad3390076ccda3352e4be6ac", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d53a7b3cb0229c34ad3390076ccda3352e4be6ac"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b330e3c8662dc2a2214d96f15c66ae7b42dfdecd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b330e3c8662dc2a2214d96f15c66ae7b42dfdecd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b330e3c8662dc2a2214d96f15c66ae7b42dfdecd", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b330e3c8662dc2a2214d96f15c66ae7b42dfdecd/comments", "author": null, "committer": null, "parents": [{"sha": "24de083ff5a0b613356e4ad95c501fe9a9f795e1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/24de083ff5a0b613356e4ad95c501fe9a9f795e1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/24de083ff5a0b613356e4ad95c501fe9a9f795e1"}], "stats": {"total": 79, "additions": 51, "deletions": 28}, "files": [{"sha": "a147c918cc6bc4485cd50f3313a2b98ff079ce6a", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b330e3c8662dc2a2214d96f15c66ae7b42dfdecd/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b330e3c8662dc2a2214d96f15c66ae7b42dfdecd/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=b330e3c8662dc2a2214d96f15c66ae7b42dfdecd", "patch": "@@ -1,3 +1,18 @@\n+2014-08-01  Robert Dewar  <dewar@adacore.com>\n+\n+\t* sem_aggr.adb, sem_ch3.adb, sem_ch5.adb, sem_util.adb,\n+\tsem_res.adb: Minor reformatting.\n+\n+2014-08-01  Vincent Celier  <celier@adacore.com>\n+\n+\t* make.adb (Initialize): Set Keep_Temporary_Files to True when\n+\t-dn is specified.\n+\t* makeusg.adb: Add line for new switch --keep-temp-files.\n+\t* makeutl.ads (Keep_Temp_Files_Option): New constant String.\n+\t* opt.ads (Keep_Temporary_Files): Document that it is also used\n+\tby gnatmake and gprbuild.\n+\t* switch-m.adb: Recognize new switch --keep-temp-files.\n+\n 2014-08-01  Tristan Gingold  <gingold@adacore.com>\n \n \t* sem_ch9.adb (Analyze_Task_Type_Declaration): Move code from ..."}, {"sha": "e2ab02e54dc4103f5cd1b7fe8a857047bf498ab1", "filename": "gcc/ada/debug.adb", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b330e3c8662dc2a2214d96f15c66ae7b42dfdecd/gcc%2Fada%2Fdebug.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b330e3c8662dc2a2214d96f15c66ae7b42dfdecd/gcc%2Fada%2Fdebug.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fdebug.adb?ref=b330e3c8662dc2a2214d96f15c66ae7b42dfdecd", "patch": "@@ -789,13 +789,15 @@ package body Debug is\n \n    --  dm  Issue a message indicating the maximum number of simultaneous\n    --      compilations.\n+   --      Equivalent to --keep-temp-files.\n \n    --  dn  Do not delete temporary files created by gnatmake at the end\n    --      of execution, such as temporary config pragma files, mapping\n    --      files or project path files.\n \n    --  dp  Prints the Q used by routine Make.Compile_Sources every time\n    --      we go around the main compile loop of Make.Compile_Sources\n+   --      Equivalent to --keep-temp-files.\n \n    --  dq  Prints source files as they are enqueued and dequeued in the Q\n    --      used by routine Make.Compile_Sources. Useful to figure out the"}, {"sha": "e4dc750533e64988c228ff0a17aba0a8fa108894", "filename": "gcc/ada/make.adb", "status": "modified", "additions": 7, "deletions": 4, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b330e3c8662dc2a2214d96f15c66ae7b42dfdecd/gcc%2Fada%2Fmake.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b330e3c8662dc2a2214d96f15c66ae7b42dfdecd/gcc%2Fada%2Fmake.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fmake.adb?ref=b330e3c8662dc2a2214d96f15c66ae7b42dfdecd", "patch": "@@ -3788,7 +3788,7 @@ package body Make is\n \n       --  Delete any temporary configuration pragma file\n \n-      if not Debug.Debug_Flag_N then\n+      if not Keep_Temporary_Files then\n          Delete_Temp_Config_Files (Project_Tree);\n       end if;\n    end Compile_Sources;\n@@ -3966,7 +3966,7 @@ package body Make is\n                --  created when using a project file.\n \n                if Main_Project = No_Project\n-                 or else Debug.Debug_Flag_N\n+                 or else Opt.Keep_Temporary_Files\n                  or else Args (J)'Length < 8\n                  or else\n                    Args (J) (Args (J)'First .. Args (J)'First + 6) /= \"-gnatem\"\n@@ -3977,7 +3977,7 @@ package body Make is\n                   --  Reset Temporary_Config_File to False so that the eventual\n                   --  other -gnatec switches will be displayed.\n \n-                  if (not Debug.Debug_Flag_N)\n+                  if (not Opt.Keep_Temporary_Files)\n                     and then Temporary_Config_File\n                     and then Args (J)'Length > 7\n                     and then Args (J) (Args (J)'First .. Args (J)'First + 6)\n@@ -3988,7 +3988,7 @@ package body Make is\n                      --  Do not display the -F=mapping_file switch for gnatbind\n                      --  if -dn is not specified.\n \n-                  elsif Debug.Debug_Flag_N\n+                  elsif Opt.Keep_Temporary_Files\n                     or else Args (J)'Length < 4\n                     or else\n                       Args (J) (Args (J)'First .. Args (J)'First + 2) /= \"-F=\"\n@@ -6650,6 +6650,9 @@ package body Make is\n \n       Project_Of_Current_Object_Directory := No_Project;\n \n+      if Debug.Debug_Flag_N then\n+         Opt.Keep_Temporary_Files := True;\n+      end if;\n    end Initialize;\n \n    ----------------------------"}, {"sha": "580a3730a9ee3aca2dc07eb4fd4dea27d433a257", "filename": "gcc/ada/makeusg.adb", "status": "modified", "additions": 3, "deletions": 6, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b330e3c8662dc2a2214d96f15c66ae7b42dfdecd/gcc%2Fada%2Fmakeusg.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b330e3c8662dc2a2214d96f15c66ae7b42dfdecd/gcc%2Fada%2Fmakeusg.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fmakeusg.adb?ref=b330e3c8662dc2a2214d96f15c66ae7b42dfdecd", "patch": "@@ -257,12 +257,6 @@ begin\n    Write_Eol;\n    Write_Eol;\n \n-   --  Line for -dn\n-\n-   Write_Str (\"  -dn      Do not delete temporary files\");\n-   Write_Eol;\n-   Write_Eol;\n-\n    Write_Str (\"  --create-map-file   Create map file mainprog.map\");\n    Write_Eol;\n \n@@ -271,6 +265,9 @@ begin\n    Write_Str (\"                      Create map file mapfile\");\n    Write_Eol;\n \n+   Write_Str (\"  --keep-temp-files   Keep temporary files\");\n+   Write_Eol;\n+\n    Write_Str (\"  --GCC=command       Use this gcc command\");\n    Write_Eol;\n "}, {"sha": "9abd97ff161eb6cb5703e82f0cc6c2070a9881c9", "filename": "gcc/ada/makeutl.ads", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b330e3c8662dc2a2214d96f15c66ae7b42dfdecd/gcc%2Fada%2Fmakeutl.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b330e3c8662dc2a2214d96f15c66ae7b42dfdecd/gcc%2Fada%2Fmakeutl.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fmakeutl.ads?ref=b330e3c8662dc2a2214d96f15c66ae7b42dfdecd", "patch": "@@ -85,6 +85,10 @@ package Makeutl is\n    --  the builder and does not want to pollute its output with error messages\n    --  coming from the builder. This is an internal switch.\n \n+   Keep_Temp_Files_Option : constant String := \"--keep-temp-files\";\n+   --  Switch to suppress deletion of temp files created by the builder.\n+   --  Equivallent of -dn.\n+\n    Load_Standard_Base : Boolean := True;\n    --  False when gprbuild is called with --db-\n "}, {"sha": "883e359d323d35929c0acf24cfb7bf13b41d1c72", "filename": "gcc/ada/opt.ads", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b330e3c8662dc2a2214d96f15c66ae7b42dfdecd/gcc%2Fada%2Fopt.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b330e3c8662dc2a2214d96f15c66ae7b42dfdecd/gcc%2Fada%2Fopt.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fopt.ads?ref=b330e3c8662dc2a2214d96f15c66ae7b42dfdecd", "patch": "@@ -843,9 +843,9 @@ package Opt is\n    --  sources until there is no more work.\n \n    Keep_Temporary_Files : Boolean := False;\n-   --  GNATCMD\n-   --  When True the temporary files created by the GNAT driver are not\n-   --  deleted. Set by switch -dn or qualifier /KEEP_TEMPORARY_FILES.\n+   --  GNATCMD, GNATMAKE, GPRBUILD\n+   --  When True the temporary files are not deleted. Set by switches -dn or\n+   --  --keep-temp-files.\n \n    Leap_Seconds_Support : Boolean := False;\n    --  GNATBIND"}, {"sha": "3c4d11592ef6623e9d25e0ba44a5a62adc2e5d8b", "filename": "gcc/ada/prj.adb", "status": "modified", "additions": 3, "deletions": 4, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b330e3c8662dc2a2214d96f15c66ae7b42dfdecd/gcc%2Fada%2Fprj.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b330e3c8662dc2a2214d96f15c66ae7b42dfdecd/gcc%2Fada%2Fprj.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj.adb?ref=b330e3c8662dc2a2214d96f15c66ae7b42dfdecd", "patch": "@@ -23,7 +23,6 @@\n --                                                                          --\n ------------------------------------------------------------------------------\n \n-with Debug;\n with Opt;\n with Osint;    use Osint;\n with Output;   use Output;\n@@ -187,7 +186,7 @@ package body Prj is\n       pragma Warnings (Off, Dont_Care);\n \n    begin\n-      if not Debug.Debug_Flag_N then\n+      if not Opt.Keep_Temporary_Files  then\n          if Current_Verbosity = High then\n             Write_Line (\"Removing temp file: \" & Get_Name_String (Path));\n          end if;\n@@ -217,7 +216,7 @@ package body Prj is\n       Proj : Project_List;\n \n    begin\n-      if not Debug.Debug_Flag_N then\n+      if not Opt.Keep_Temporary_Files then\n          if Project_Tree /= null then\n             Proj := Project_Tree.Projects;\n             while Proj /= null loop\n@@ -254,7 +253,7 @@ package body Prj is\n       Path : Path_Name_Type;\n \n    begin\n-      if not Debug.Debug_Flag_N then\n+      if not Opt.Keep_Temporary_Files then\n          for Index in\n            1 .. Temp_Files_Table.Last (Shared.Private_Part.Temp_Files)\n          loop"}, {"sha": "e5e236bc3c2c844086a4a179ea547bef4989a10c", "filename": "gcc/ada/sem_aggr.adb", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b330e3c8662dc2a2214d96f15c66ae7b42dfdecd/gcc%2Fada%2Fsem_aggr.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b330e3c8662dc2a2214d96f15c66ae7b42dfdecd/gcc%2Fada%2Fsem_aggr.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_aggr.adb?ref=b330e3c8662dc2a2214d96f15c66ae7b42dfdecd", "patch": "@@ -1728,12 +1728,14 @@ package body Sem_Aggr is\n                         Freeze_Before (N, E);\n \n                         if Has_Dynamic_Predicate_Aspect (E) then\n-                           Error_Msg_NE (\"subtype& has dynamic predicate,\"\n-                             & \"not allowed in aggregate choice\", Choice, E);\n+                           Error_Msg_NE\n+                             (\"subtype& has dynamic predicate, not allowed \"\n+                              & \"in aggregate choice\", Choice, E);\n \n                         elsif not Is_Static_Subtype (E) then\n-                           Error_Msg_NE (\"non-static subtype& has predicate,\"\n-                             & \"not allowed in aggregate choice\", Choice, E);\n+                           Error_Msg_NE\n+                             (\"non-static subtype& has predicate, not allowed \"\n+                              & \"in aggregate choice\", Choice, E);\n                         end if;\n \n                         --  If the subtype has a static predicate, replace the"}, {"sha": "dc09c449a8a4ec76e32e475cda33f66e3bd2d742", "filename": "gcc/ada/sem_ch3.adb", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b330e3c8662dc2a2214d96f15c66ae7b42dfdecd/gcc%2Fada%2Fsem_ch3.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b330e3c8662dc2a2214d96f15c66ae7b42dfdecd/gcc%2Fada%2Fsem_ch3.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch3.adb?ref=b330e3c8662dc2a2214d96f15c66ae7b42dfdecd", "patch": "@@ -2923,7 +2923,7 @@ package body Sem_Ch3 is\n          if Has_Dynamic_Predicate_Aspect (T) then\n             Error_Msg_N\n               (\"subtype has dynamic predicate, \"\n-                 & \"not allowed in number declaration\", N);\n+               & \"not allowed in number declaration\", N);\n          end if;\n \n       else"}, {"sha": "3d8d3f60b142a5ba548f51c8dc87d2a4128634ce", "filename": "gcc/ada/sem_ch5.adb", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b330e3c8662dc2a2214d96f15c66ae7b42dfdecd/gcc%2Fada%2Fsem_ch5.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b330e3c8662dc2a2214d96f15c66ae7b42dfdecd/gcc%2Fada%2Fsem_ch5.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch5.adb?ref=b330e3c8662dc2a2214d96f15c66ae7b42dfdecd", "patch": "@@ -2210,9 +2210,9 @@ package body Sem_Ch5 is\n                       or else Has_Dynamic_Predicate_Aspect (T))\n          then\n             Bad_Predicated_Subtype_Use\n-              (\"cannot use subtype& with non-static predicate for loop \" &\n-               \"iteration\", Discrete_Subtype_Definition (N),\n-                  T, Suggest_Static => True);\n+              (\"cannot use subtype& with non-static predicate for loop \"\n+               & \"iteration\", Discrete_Subtype_Definition (N),\n+               T, Suggest_Static => True);\n \n          elsif Inside_A_Generic and then Is_Generic_Formal (T) then\n             Set_No_Dynamic_Predicate_On_Actual (T);"}, {"sha": "d2d7188e41eeede901bc1a36dc81d79d095da102", "filename": "gcc/ada/sem_res.adb", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b330e3c8662dc2a2214d96f15c66ae7b42dfdecd/gcc%2Fada%2Fsem_res.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b330e3c8662dc2a2214d96f15c66ae7b42dfdecd/gcc%2Fada%2Fsem_res.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_res.adb?ref=b330e3c8662dc2a2214d96f15c66ae7b42dfdecd", "patch": "@@ -9819,10 +9819,9 @@ package body Sem_Res is\n \n       begin\n          if Nkind (Drange) = N_Subtype_Indication\n-            and then Has_Predicates (Entity (Subtype_Mark (Drange)))\n+           and then Has_Predicates (Entity (Subtype_Mark (Drange)))\n          then\n             Subt := Entity (Subtype_Mark (Drange));\n-\n          else\n             Subt := Etype (Drange);\n          end if;"}, {"sha": "6c385e0e7894f916a409db66589e4248f9e5e3dd", "filename": "gcc/ada/sem_util.adb", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b330e3c8662dc2a2214d96f15c66ae7b42dfdecd/gcc%2Fada%2Fsem_util.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b330e3c8662dc2a2214d96f15c66ae7b42dfdecd/gcc%2Fada%2Fsem_util.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_util.adb?ref=b330e3c8662dc2a2214d96f15c66ae7b42dfdecd", "patch": "@@ -784,7 +784,6 @@ package body Sem_Util is\n       Gen            : Entity_Id;\n \n    begin\n-\n       --  Avoid cascaded errors\n \n       if Error_Posted (N) then"}, {"sha": "c52ca42478841356962514284031c3329953da92", "filename": "gcc/ada/switch-m.adb", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b330e3c8662dc2a2214d96f15c66ae7b42dfdecd/gcc%2Fada%2Fswitch-m.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b330e3c8662dc2a2214d96f15c66ae7b42dfdecd/gcc%2Fada%2Fswitch-m.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fswitch-m.adb?ref=b330e3c8662dc2a2214d96f15c66ae7b42dfdecd", "patch": "@@ -793,6 +793,9 @@ package body Switch.M is\n          elsif Switch_Chars = Makeutl.No_Exit_Message_Option then\n             Opt.No_Exit_Message := True;\n \n+         elsif Switch_Chars = Makeutl.Keep_Temp_Files_Option then\n+            Opt.Keep_Temporary_Files := True;\n+\n          elsif Switch_Chars (Ptr) = '-' then\n             Bad_Switch (Switch_Chars);\n "}]}