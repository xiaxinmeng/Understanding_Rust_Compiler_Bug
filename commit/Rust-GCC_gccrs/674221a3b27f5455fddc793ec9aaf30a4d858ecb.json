{"sha": "674221a3b27f5455fddc793ec9aaf30a4d858ecb", "node_id": "C_kwDOANBUbNoAKDY3NDIyMWEzYjI3ZjU0NTVmZGRjNzkzZWM5YWFmMzBhNGQ4NThlY2I", "commit": {"author": {"name": "bors[bot]", "email": "26634292+bors[bot]@users.noreply.github.com", "date": "2021-11-03T15:54:51Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-11-03T15:54:51Z"}, "message": "Merge #791\n\n791: Replace TyTy::TupleType::iterate_fields with a new function get_fields r=philberty a=cls\n\nThis PR replaces TyTy::TupleType::iterate_fields with a new function get_fields.\r\n\r\nIn #735, `@philberty` mentions two possible implementations of get_fields, one that returns `std::vector<TyVar>&` and one that returns a new `std::vector<BaseType *>`. I've included two commits, the first doing the former and second going on to do the latter. I'm happy with one or both being merged.\r\n\r\nThis is my first PR, so please let me know if I've missed anything! Thanks.\r\n\r\nFixes #735\n\nCo-authored-by: Connor Lane Smith <cls@lubutu.com>", "tree": {"sha": "a2e847b9bedd6b3e46550d1b0c370092f28547e0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a2e847b9bedd6b3e46550d1b0c370092f28547e0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/674221a3b27f5455fddc793ec9aaf30a4d858ecb", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJhgrDLCRBK7hj4Ov3rIwAA2icIAI7KVcRl7RAuZRKx7Z84Aykg\nmNK5pPYPKbDYaOGmKvb9eHGX7A47Behc+8C6PAY+qSwaRI6wjug66zW7lV9t7H43\nLLLpYSf4nI9mA/NYoRUbXxLVQEDyFKTNvckla5b0tquRXyp/5uxqT566X6++MPSM\nHwH07XyJSuOPBX56klHmALu60V41ZWOYfB2FQ4eC/xCw94mVmRNVJ0U3BQNsDkmk\n/87qsmc30Rb3/Nt2jKyfItzyXoex54LzfFeCqL37kVTGa9OvnsHcj9UZuMmv1Sae\nzRdkcyIx/1UOyPxvAvGyKWyMeN8dE8vkd5+ThwJRJITCR6PbOXhwNb+tjiXiWh8=\n=I7/8\n-----END PGP SIGNATURE-----\n", "payload": "tree a2e847b9bedd6b3e46550d1b0c370092f28547e0\nparent 5f0df4812c37fc428b5508e019e9fb7f8a7b77b1\nparent c8ee62ed4535cfa314f12535a3cbbe3cc135872d\nauthor bors[bot] <26634292+bors[bot]@users.noreply.github.com> 1635954891 +0000\ncommitter GitHub <noreply@github.com> 1635954891 +0000\n\nMerge #791\n\n791: Replace TyTy::TupleType::iterate_fields with a new function get_fields r=philberty a=cls\n\nThis PR replaces TyTy::TupleType::iterate_fields with a new function get_fields.\r\n\r\nIn #735, `@philberty` mentions two possible implementations of get_fields, one that returns `std::vector<TyVar>&` and one that returns a new `std::vector<BaseType *>`. I've included two commits, the first doing the former and second going on to do the latter. I'm happy with one or both being merged.\r\n\r\nThis is my first PR, so please let me know if I've missed anything! Thanks.\r\n\r\nFixes #735\n\nCo-authored-by: Connor Lane Smith <cls@lubutu.com>\n"}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/674221a3b27f5455fddc793ec9aaf30a4d858ecb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/674221a3b27f5455fddc793ec9aaf30a4d858ecb", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/674221a3b27f5455fddc793ec9aaf30a4d858ecb/comments", "author": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5f0df4812c37fc428b5508e019e9fb7f8a7b77b1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5f0df4812c37fc428b5508e019e9fb7f8a7b77b1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5f0df4812c37fc428b5508e019e9fb7f8a7b77b1"}, {"sha": "c8ee62ed4535cfa314f12535a3cbbe3cc135872d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c8ee62ed4535cfa314f12535a3cbbe3cc135872d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c8ee62ed4535cfa314f12535a3cbbe3cc135872d"}], "stats": {"total": 19, "additions": 6, "deletions": 13}, "files": [{"sha": "b3ceb06665961368548e6bdd9606725f0ffeb94a", "filename": "gcc/rust/typecheck/rust-tyty.cc", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/674221a3b27f5455fddc793ec9aaf30a4d858ecb/gcc%2Frust%2Ftypecheck%2Frust-tyty.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/674221a3b27f5455fddc793ec9aaf30a4d858ecb/gcc%2Frust%2Ftypecheck%2Frust-tyty.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Frust%2Ftypecheck%2Frust-tyty.cc?ref=674221a3b27f5455fddc793ec9aaf30a4d858ecb", "patch": "@@ -788,11 +788,11 @@ std::string\n TupleType::as_string () const\n {\n   std::string fields_buffer;\n-  iterate_fields ([&] (BaseType *field) mutable -> bool {\n-    fields_buffer += field->as_string ();\n-    fields_buffer += \", \";\n-    return true;\n-  });\n+  for (const TyVar &field : get_fields ())\n+    {\n+      fields_buffer += field.get_tyty ()->as_string ();\n+      fields_buffer += \", \";\n+    }\n   return \"(\" + fields_buffer + \")\";\n }\n "}, {"sha": "c26e1934e15d5fe7e91ae3be4c8b2e068ed419e6", "filename": "gcc/rust/typecheck/rust-tyty.h", "status": "modified", "additions": 1, "deletions": 8, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/674221a3b27f5455fddc793ec9aaf30a4d858ecb/gcc%2Frust%2Ftypecheck%2Frust-tyty.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/674221a3b27f5455fddc793ec9aaf30a4d858ecb/gcc%2Frust%2Ftypecheck%2Frust-tyty.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Frust%2Ftypecheck%2Frust-tyty.h?ref=674221a3b27f5455fddc793ec9aaf30a4d858ecb", "patch": "@@ -642,14 +642,7 @@ class TupleType : public BaseType\n     return true;\n   }\n \n-  void iterate_fields (std::function<bool (BaseType *)> cb) const\n-  {\n-    for (size_t i = 0; i < num_fields (); i++)\n-      {\n-\tif (!cb (get_field (i)))\n-\t  return;\n-      }\n-  }\n+  const std::vector<TyVar> &get_fields () const { return fields; }\n \n   std::string get_name () const override final { return as_string (); }\n "}]}