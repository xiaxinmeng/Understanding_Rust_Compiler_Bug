{"sha": "54cb4e20069f00f96ad2b6249cb68295a61a1786", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTRjYjRlMjAwNjlmMDBmOTZhZDJiNjI0OWNiNjgyOTVhNjFhMTc4Ng==", "commit": {"author": {"name": "Tom de Vries", "email": "tom@codesourcery.com", "date": "2017-08-04T07:27:05Z"}, "committer": {"name": "Tom de Vries", "email": "vries@gcc.gnu.org", "date": "2017-08-04T07:27:05Z"}, "message": "Add missing edge probability in simd_clone_adjust\n\nCurrently we generate an if with probability set on only one of the two edges:\n  <bb 5> [0.00%] [count: INV]:\n  _5 = mask.3[iter.6_3];\n  if (_5 == 0)\n    goto <bb 6>; [INV] [count: INV]\n  else\n    goto <bb 2>; [100.00%] [count: INV]\n\nAdd the missing edge probability, and set the split to unlikely/likely:\n  if (_5 == 0)\n    goto <bb 6>; [19.99%] [count: INV]\n  else\n    goto <bb 2>; [80.01%] [count: INV]\n\n2017-08-04  Tom de Vries  <tom@codesourcery.com>\n\n\t* omp-simd-clone.c (simd_clone_adjust): Add missing edge probability.\n\nFrom-SVN: r250865", "tree": {"sha": "6929c721defce86705af92688565a7060d243a40", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6929c721defce86705af92688565a7060d243a40"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/54cb4e20069f00f96ad2b6249cb68295a61a1786", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/54cb4e20069f00f96ad2b6249cb68295a61a1786", "html_url": "https://github.com/Rust-GCC/gccrs/commit/54cb4e20069f00f96ad2b6249cb68295a61a1786", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/54cb4e20069f00f96ad2b6249cb68295a61a1786/comments", "author": null, "committer": null, "parents": [{"sha": "07cf14668f69b343a67de1cab79bb0edbed1fc2a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/07cf14668f69b343a67de1cab79bb0edbed1fc2a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/07cf14668f69b343a67de1cab79bb0edbed1fc2a"}], "stats": {"total": 11, "additions": 9, "deletions": 2}, "files": [{"sha": "921430208447e1457342107be4497ddd233a072e", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/54cb4e20069f00f96ad2b6249cb68295a61a1786/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/54cb4e20069f00f96ad2b6249cb68295a61a1786/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=54cb4e20069f00f96ad2b6249cb68295a61a1786", "patch": "@@ -1,3 +1,7 @@\n+2017-08-04  Tom de Vries  <tom@codesourcery.com>\n+\n+\t* omp-simd-clone.c (simd_clone_adjust): Add missing edge probability.\n+\n 2017-08-03  Bill Schmidt  <wschmidt@linux.vnet.ibm.com>\n \n \t* config/rs6000/rs6000-c.c (altivec_resolve_overloaded_builtin):"}, {"sha": "fbb122cd1e0898a40e001396b8b6e07df3cb42a4", "filename": "gcc/omp-simd-clone.c", "status": "modified", "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/54cb4e20069f00f96ad2b6249cb68295a61a1786/gcc%2Fomp-simd-clone.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/54cb4e20069f00f96ad2b6249cb68295a61a1786/gcc%2Fomp-simd-clone.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fomp-simd-clone.c?ref=54cb4e20069f00f96ad2b6249cb68295a61a1786", "patch": "@@ -1240,8 +1240,11 @@ simd_clone_adjust (struct cgraph_node *node)\n       g = gimple_build_cond (EQ_EXPR, mask, build_zero_cst (TREE_TYPE (mask)),\n \t\t\t     NULL, NULL);\n       gsi_insert_after (&gsi, g, GSI_CONTINUE_LINKING);\n-      make_edge (loop->header, incr_bb, EDGE_TRUE_VALUE);\n-      FALLTHRU_EDGE (loop->header)->flags = EDGE_FALSE_VALUE;\n+      edge e = make_edge (loop->header, incr_bb, EDGE_TRUE_VALUE);\n+      e->probability = profile_probability::unlikely ().guessed ();\n+      edge fallthru = FALLTHRU_EDGE (loop->header);\n+      fallthru->flags = EDGE_FALSE_VALUE;\n+      fallthru->probability = profile_probability::likely ().guessed ();\n     }\n \n   basic_block latch_bb = NULL;"}]}