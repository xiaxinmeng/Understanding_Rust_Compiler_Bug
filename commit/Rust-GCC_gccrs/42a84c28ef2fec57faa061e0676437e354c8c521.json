{"sha": "42a84c28ef2fec57faa061e0676437e354c8c521", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDJhODRjMjhlZjJmZWM1N2ZhYTA2MWUwNjc2NDM3ZTM1NGM4YzUyMQ==", "commit": {"author": {"name": "Iain Buclaw", "email": "ibuclaw@gcc.gnu.org", "date": "2019-03-10T17:25:18Z"}, "committer": {"name": "Iain Buclaw", "email": "ibuclaw@gcc.gnu.org", "date": "2019-03-10T17:25:18Z"}, "message": "re PR d/89016 (ICE in ArrayLiteralExp::toStringExp, at d/dmd/expression.c:3873)\n\n    PR d/89016\nd/dmd: Merge upstream dmd da26db819\n\nBackports supplementary fix for ICE on importing deprecated modules.\n\nUpdates https://gcc.gnu.org/PR89016\n\nReviewed-on: https://github.com/dlang/dmd/pull/9436\n\nFrom-SVN: r269560", "tree": {"sha": "a428ccddf2b1dd60549bf36374d119b51f96e239", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a428ccddf2b1dd60549bf36374d119b51f96e239"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/42a84c28ef2fec57faa061e0676437e354c8c521", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/42a84c28ef2fec57faa061e0676437e354c8c521", "html_url": "https://github.com/Rust-GCC/gccrs/commit/42a84c28ef2fec57faa061e0676437e354c8c521", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/42a84c28ef2fec57faa061e0676437e354c8c521/comments", "author": null, "committer": null, "parents": [{"sha": "055c7e41132ad4788367af718e5d26953ba23162", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/055c7e41132ad4788367af718e5d26953ba23162", "html_url": "https://github.com/Rust-GCC/gccrs/commit/055c7e41132ad4788367af718e5d26953ba23162"}], "stats": {"total": 25, "additions": 12, "deletions": 13}, "files": [{"sha": "313748f70aeee8102d7724ddad192c543a8861d2", "filename": "gcc/d/dmd/MERGE", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/42a84c28ef2fec57faa061e0676437e354c8c521/gcc%2Fd%2Fdmd%2FMERGE", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/42a84c28ef2fec57faa061e0676437e354c8c521/gcc%2Fd%2Fdmd%2FMERGE", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fd%2Fdmd%2FMERGE?ref=42a84c28ef2fec57faa061e0676437e354c8c521", "patch": "@@ -1,4 +1,4 @@\n-0fc786f4908aa6bdd4220af87995333b1f24c3d7\n+da26db81943952c7e35dab98650df589ec122485\n \n The first line of this file holds the git revision number of the last\n merge done from the dlang/dmd repository."}, {"sha": "3d899f09b521c40169c13a8ca204031a5262fe25", "filename": "gcc/d/dmd/dimport.c", "status": "modified", "additions": 2, "deletions": 6, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/42a84c28ef2fec57faa061e0676437e354c8c521/gcc%2Fd%2Fdmd%2Fdimport.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/42a84c28ef2fec57faa061e0676437e354c8c521/gcc%2Fd%2Fdmd%2Fdimport.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fd%2Fdmd%2Fdimport.c?ref=42a84c28ef2fec57faa061e0676437e354c8c521", "patch": "@@ -23,8 +23,6 @@\n #include \"attrib.h\"\n #include \"hdrgen.h\"\n \n-StringExp *semanticString(Scope *sc, Expression *exp, const char *s);\n-\n /********************************* Import ****************************/\n \n Import::Import(Loc loc, Identifiers *packages, Identifier *id, Identifier *aliasId,\n@@ -175,19 +173,17 @@ void Import::importAll(Scope *sc)\n         load(sc);\n         if (mod)                // if successfully loaded module\n         {\n+            mod->importAll(NULL);\n+\n             if (mod->md && mod->md->isdeprecated)\n             {\n                 Expression *msg = mod->md->msg;\n-                if (msg)\n-                    msg = semanticString(sc, msg, \"deprecation message\");\n                 if (StringExp *se = msg ? msg->toStringExp() : NULL)\n                     mod->deprecation(loc, \"is deprecated - %s\", se->string);\n                 else\n                     mod->deprecation(loc, \"is deprecated\");\n             }\n \n-            mod->importAll(NULL);\n-\n             if (sc->explicitProtection)\n                 protection = sc->protection;\n             if (!isstatic && !aliasId && !names.dim)"}, {"sha": "26ef57693b7f8199044e87807d25c219e60a160f", "filename": "gcc/testsuite/gdc.test/fail_compilation/fail19609.d", "status": "modified", "additions": 7, "deletions": 6, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/42a84c28ef2fec57faa061e0676437e354c8c521/gcc%2Ftestsuite%2Fgdc.test%2Ffail_compilation%2Ffail19609.d", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/42a84c28ef2fec57faa061e0676437e354c8c521/gcc%2Ftestsuite%2Fgdc.test%2Ffail_compilation%2Ffail19609.d", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgdc.test%2Ffail_compilation%2Ffail19609.d?ref=42a84c28ef2fec57faa061e0676437e354c8c521", "patch": "@@ -3,16 +3,17 @@\n TEST_OUTPUT\n ---\n fail_compilation/imports/fail19609a.d(1): Error: `string` expected for deprecation message, not `([\"\"])` of type `string[]`\n-fail_compilation/fail19609.d(16): Deprecation: module `imports.fail19609a` is deprecated\n-fail_compilation/imports/fail19609a.d(1): Error: `string` expected for deprecation message, not `([\"\"])` of type `string[]`\n-fail_compilation/imports/fail19609b.d(1): Error: `string` expected for deprecation message, not `([1])` of type `int[]`\n-fail_compilation/fail19609.d(17): Deprecation: module `imports.fail19609b` is deprecated\n+fail_compilation/fail19609.d(15): Deprecation: module `imports.fail19609a` is deprecated\n fail_compilation/imports/fail19609b.d(1): Error: `string` expected for deprecation message, not `([1])` of type `int[]`\n+fail_compilation/fail19609.d(16): Deprecation: module `imports.fail19609b` is deprecated\n fail_compilation/imports/fail19609c.d(1): Error: `string` expected for deprecation message, not `(123.4F)` of type `float`\n-fail_compilation/fail19609.d(18): Deprecation: module `imports.fail19609c` is deprecated\n-fail_compilation/imports/fail19609c.d(1): Error: `string` expected for deprecation message, not `(123.4F)` of type `float`\n+fail_compilation/fail19609.d(17): Deprecation: module `imports.fail19609c` is deprecated\n+fail_compilation/imports/fail19609d.d(1): Error: undefined identifier `msg`\n+fail_compilation/fail19609.d(19): Deprecation: module `imports.fail19609d` is deprecated\n ---\n */\n import imports.fail19609a;\n import imports.fail19609b;\n import imports.fail19609c;\n+enum msg = \"You should not be able to see me\";\n+import imports.fail19609d;"}, {"sha": "0955ca4fac29d68aac2a5f354c0957af94e7ee68", "filename": "gcc/testsuite/gdc.test/fail_compilation/imports/fail19609d.d", "status": "added", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/42a84c28ef2fec57faa061e0676437e354c8c521/gcc%2Ftestsuite%2Fgdc.test%2Ffail_compilation%2Fimports%2Ffail19609d.d", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/42a84c28ef2fec57faa061e0676437e354c8c521/gcc%2Ftestsuite%2Fgdc.test%2Ffail_compilation%2Fimports%2Ffail19609d.d", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgdc.test%2Ffail_compilation%2Fimports%2Ffail19609d.d?ref=42a84c28ef2fec57faa061e0676437e354c8c521", "patch": "@@ -0,0 +1,2 @@\n+deprecated(msg) module imports.fail19609d;\n+enum msg = \"You won't see this either\";"}]}