{"sha": "1ecb5b94a1a90498b4043f06bbb9ae08f34eb879", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWVjYjViOTRhMWE5MDQ5OGI0MDQzZjA2YmJiOWFlMDhmMzRlYjg3OQ==", "commit": {"author": {"name": "Richard Sandiford", "email": "rdsandiford@googlemail.com", "date": "2014-08-28T06:22:07Z"}, "committer": {"name": "Richard Sandiford", "email": "rsandifo@gcc.gnu.org", "date": "2014-08-28T06:22:07Z"}, "message": "combine.c: Include rtl-iter.h.\n\ngcc/\n\t* combine.c: Include rtl-iter.h.\n\t(unmentioned_reg_p_1): Delete.\n\t(unmentioned_reg_p): Use FOR_EACH_SUBRTX rather than for_each_rtx.\n\tDon't handle null rtxes.\n\nFrom-SVN: r214623", "tree": {"sha": "b3e254f1039ff5162672409716cd9ba9cdc2f96f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b3e254f1039ff5162672409716cd9ba9cdc2f96f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1ecb5b94a1a90498b4043f06bbb9ae08f34eb879", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1ecb5b94a1a90498b4043f06bbb9ae08f34eb879", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1ecb5b94a1a90498b4043f06bbb9ae08f34eb879", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1ecb5b94a1a90498b4043f06bbb9ae08f34eb879/comments", "author": {"login": "rsandifo", "id": 4235983, "node_id": "MDQ6VXNlcjQyMzU5ODM=", "avatar_url": "https://avatars.githubusercontent.com/u/4235983?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rsandifo", "html_url": "https://github.com/rsandifo", "followers_url": "https://api.github.com/users/rsandifo/followers", "following_url": "https://api.github.com/users/rsandifo/following{/other_user}", "gists_url": "https://api.github.com/users/rsandifo/gists{/gist_id}", "starred_url": "https://api.github.com/users/rsandifo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rsandifo/subscriptions", "organizations_url": "https://api.github.com/users/rsandifo/orgs", "repos_url": "https://api.github.com/users/rsandifo/repos", "events_url": "https://api.github.com/users/rsandifo/events{/privacy}", "received_events_url": "https://api.github.com/users/rsandifo/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "e9f56944fd8af31ed0d9cdef134d5f0a68bcb719", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e9f56944fd8af31ed0d9cdef134d5f0a68bcb719", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e9f56944fd8af31ed0d9cdef134d5f0a68bcb719"}], "stats": {"total": 36, "additions": 17, "deletions": 19}, "files": [{"sha": "8744af9d1b8be46eba5524c0741a9e152bd8d758", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1ecb5b94a1a90498b4043f06bbb9ae08f34eb879/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1ecb5b94a1a90498b4043f06bbb9ae08f34eb879/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=1ecb5b94a1a90498b4043f06bbb9ae08f34eb879", "patch": "@@ -1,3 +1,10 @@\n+2014-08-28  Richard Sandiford  <rdsandiford@googlemail.com>\n+\n+\t* combine.c: Include rtl-iter.h.\n+\t(unmentioned_reg_p_1): Delete.\n+\t(unmentioned_reg_p): Use FOR_EACH_SUBRTX rather than for_each_rtx.\n+\tDon't handle null rtxes.\n+\n 2014-08-28  Richard Sandiford  <rdsandiford@googlemail.com>\n \n \t* calls.c: Include rtl-iter.h."}, {"sha": "6172cb3524d6d9a5f8137985c749c1730ec6d522", "filename": "gcc/combine.c", "status": "modified", "additions": 10, "deletions": 19, "changes": 29, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1ecb5b94a1a90498b4043f06bbb9ae08f34eb879/gcc%2Fcombine.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1ecb5b94a1a90498b4043f06bbb9ae08f34eb879/gcc%2Fcombine.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcombine.c?ref=1ecb5b94a1a90498b4043f06bbb9ae08f34eb879", "patch": "@@ -106,6 +106,7 @@ along with GCC; see the file COPYING3.  If not see\n #include \"obstack.h\"\n #include \"statistics.h\"\n #include \"params.h\"\n+#include \"rtl-iter.h\"\n \n /* Number of attempts to combine instructions in this function.  */\n \n@@ -469,7 +470,6 @@ static void distribute_notes (rtx, rtx_insn *, rtx_insn *, rtx_insn *, rtx, rtx,\n static void distribute_links (struct insn_link *);\n static void mark_used_regs_combine (rtx);\n static void record_promoted_value (rtx_insn *, rtx);\n-static int unmentioned_reg_p_1 (rtx *, void *);\n static bool unmentioned_reg_p (rtx, rtx);\n static int record_truncated_value (rtx *, void *);\n static void record_truncated_values (rtx *, void *);\n@@ -13845,31 +13845,22 @@ distribute_links (struct insn_link *links)\n     }\n }\n \f\n-/* Subroutine of unmentioned_reg_p and callback from for_each_rtx.\n-   Check whether the expression pointer to by LOC is a register or\n-   memory, and if so return 1 if it isn't mentioned in the rtx EXPR.\n-   Otherwise return zero.  */\n-\n-static int\n-unmentioned_reg_p_1 (rtx *loc, void *expr)\n-{\n-  rtx x = *loc;\n-\n-  if (x != NULL_RTX\n-      && (REG_P (x) || MEM_P (x))\n-      && ! reg_mentioned_p (x, (rtx) expr))\n-    return 1;\n-  return 0;\n-}\n-\n /* Check for any register or memory mentioned in EQUIV that is not\n    mentioned in EXPR.  This is used to restrict EQUIV to \"specializations\"\n    of EXPR where some registers may have been replaced by constants.  */\n \n static bool\n unmentioned_reg_p (rtx equiv, rtx expr)\n {\n-  return for_each_rtx (&equiv, unmentioned_reg_p_1, expr);\n+  subrtx_iterator::array_type array;\n+  FOR_EACH_SUBRTX (iter, array, equiv, NONCONST)\n+    {\n+      const_rtx x = *iter;\n+      if ((REG_P (x) || MEM_P (x))\n+\t  && !reg_mentioned_p (x, expr))\n+\treturn true;\n+    }\n+  return false;\n }\n \f\n DEBUG_FUNCTION void"}]}