{"sha": "7ca0e6d96e806cb6fd026dfda2e58449af177969", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2NhMGU2ZDk2ZTgwNmNiNmZkMDI2ZGZkYTJlNTg0NDlhZjE3Nzk2OQ==", "commit": {"author": {"name": "David Edelsohn", "email": "edelsohn@gnu.org", "date": "2000-11-09T21:41:11Z"}, "committer": {"name": "David Edelsohn", "email": "dje@gcc.gnu.org", "date": "2000-11-09T21:41:11Z"}, "message": "ltcf-c.sh (aix4): Improve shared library configuration; require exporting symbols.\n\n        * ltcf-c.sh (aix4): Improve shared library configuration; require\n        exporting symbols.\n        * ltcf-cxx.sh (aix4): Define.\n        * ltconfig (aix4): Define library and soname specs appropriate for\n        AIX.  Define command to create export symbols list.\n\nFrom-SVN: r37347", "tree": {"sha": "4ab6bf8dba606356735a973fb895568471fd5a29", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4ab6bf8dba606356735a973fb895568471fd5a29"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7ca0e6d96e806cb6fd026dfda2e58449af177969", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7ca0e6d96e806cb6fd026dfda2e58449af177969", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7ca0e6d96e806cb6fd026dfda2e58449af177969", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7ca0e6d96e806cb6fd026dfda2e58449af177969/comments", "author": null, "committer": null, "parents": [{"sha": "b52114d28357b7616e6c5d25cffd25a0799b2682", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b52114d28357b7616e6c5d25cffd25a0799b2682", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b52114d28357b7616e6c5d25cffd25a0799b2682"}], "stats": {"total": 34, "additions": 24, "deletions": 10}, "files": [{"sha": "0f2bb66b86d43f1299dc8c9687c2f4a2a92889a7", "filename": "ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7ca0e6d96e806cb6fd026dfda2e58449af177969/ChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7ca0e6d96e806cb6fd026dfda2e58449af177969/ChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/ChangeLog?ref=7ca0e6d96e806cb6fd026dfda2e58449af177969", "patch": "@@ -1,3 +1,11 @@\n+2000-11-09  David Edelsohn  <edelsohn@gnu.org>\n+\n+\t* ltcf-c.sh (aix4): Improve shared library configuration; require\n+\texporting symbols.\n+\t* ltcf-cxx.sh (aix4): Define.\n+\t* ltconfig (aix4): Define library and soname specs appropriate for\n+\tAIX.  Define command to create export symbols list.\n+\n Mon Nov  6 14:19:35 2000  Christopher Faylor <cgf@cygnus.com>\n \n \t* config.sub: Add support for Sun Chorus"}, {"sha": "6bccb11c5d6805625b001775952f2d541a7bdf99", "filename": "ltcf-c.sh", "status": "modified", "additions": 7, "deletions": 7, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7ca0e6d96e806cb6fd026dfda2e58449af177969/ltcf-c.sh", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7ca0e6d96e806cb6fd026dfda2e58449af177969/ltcf-c.sh", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/ltcf-c.sh?ref=7ca0e6d96e806cb6fd026dfda2e58449af177969", "patch": "@@ -277,13 +277,13 @@ else\n       hardcode_direct=yes\n     fi\n     allow_undefined_flag=' ${wl}-berok'\n-    archive_cmds=\"\\$CC $shared_flag\"' -o $output_objdir/$soname $libobjs $deplibs $compiler_flags ${wl}-bexpall ${wl}-bnoentry${allow_undefined_flag}'\n-    archive_expsym_cmds=\"\\$CC $shared_flag\"' -o $output_objdir/$soname $libobjs $deplibs $compiler_flags ${wl}-bE:$export_symbols ${wl}-bnoentry${allow_undefined_flag}'\n-    case \"$host_os\" in aix4.[01]|aix4.[01].*)\n-      # According to Greg Wooledge, -bexpall is only supported from AIX 4.2 on\n-      always_export_symbols=yes ;;\n-    esac\n-   ;;\n+    archive_expsym_cmds=\"\\$CC $shared_flag\"' -o $output_objdir/$soname $libobjs $deplibs $compiler_flags ${wl}-bE:$export_symbols ${wl}-bnoentry${allow_undefined_flag}~$AR $AR_FLAGS $output_objdir/$libname$release.a $output_objdir/$soname'\n+    # -bexpall does not export symbols beginning with underscore (_)\n+    always_export_symbols=yes\n+    # Exported symbols can be pulled into shared objects from archives\n+    whole_archive_flag_spec=' '\n+    build_libtool_need_lc=yes\n+    ;;\n \n   amigaos*)\n     archive_cmds='$rm $output_objdir/a2ixlibrary.data~$echo \"#define NAME $libname\" > $output_objdir/a2ixlibrary.data~$echo \"#define LIBRARY_ID 1\" >> $output_objdir/a2ixlibrary.data~$echo \"#define VERSION $major\" >> $output_objdir/a2ixlibrary.data~$echo \"#define REVISION $revision\" >> $output_objdir/a2ixlibrary.data~$AR $AR_FLAGS $lib $libobjs~$RANLIB $lib~(cd $output_objdir && a2ixlibrary -32)'"}, {"sha": "cefa0085624a6868760c38c6a04d7032a9e50a2b", "filename": "ltcf-cxx.sh", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7ca0e6d96e806cb6fd026dfda2e58449af177969/ltcf-cxx.sh", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7ca0e6d96e806cb6fd026dfda2e58449af177969/ltcf-cxx.sh", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/ltcf-cxx.sh?ref=7ca0e6d96e806cb6fd026dfda2e58449af177969", "patch": "@@ -135,8 +135,12 @@ case \"$host_os\" in\n     ld_shlibs=no\n     ;;\n   aix4*)\n-    # FIXME: insert proper C++ library support\n-    ld_shlibs=no\n+    archive_expsym_cmds=\"\\$CC $shared_flag\"' -o $output_objdir/$soname $libobjs $deplibs $compiler_flags ${wl}-bE:$export_symbols ${wl}-bnoentry${allow_undefined_flag}~$AR $AR_FLAGS $output_objdir/$libname$release.a $output_objdir/$soname'\n+    # -bexpall does not export symbols beginning with underscore (_)\n+    always_export_symbols=yes\n+    # Exported symbols can be pulled into shared objects from archives\n+    whole_archive_flag_spec=' '\n+    build_libtool_need_lc=yes\n     ;;\n   chorus*)\n     case \"$cc_basename\" in"}, {"sha": "a79434264e437ec94f13544c56488e9c30032f4e", "filename": "ltconfig", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7ca0e6d96e806cb6fd026dfda2e58449af177969/ltconfig", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7ca0e6d96e806cb6fd026dfda2e58449af177969/ltconfig", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/ltconfig?ref=7ca0e6d96e806cb6fd026dfda2e58449af177969", "patch": "@@ -949,8 +949,10 @@ aix4*)\n   # collect2, so additional links can be useful in future.\n   # We preserve .a as extension for shared libraries though AIX4.2\n   # and later linker supports .so\n-  library_names_spec='${libname}${release}.so$versuffix ${libname}${release}.so$major $libname.a'\n+  library_names_spec='${libname}${release}.a $libname.a'\n   shlibpath_var=LIBPATH\n+  soname_spec='${libname}${release}.so$major.o'\n+  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\\''{ if (((\\$2 == \"T\") || (\\$2 == \"D\") || (\\$2 == \"B\")) && (substr(\\$3,1,1) != \".\")) { print \\$3 } }'\\'' | sort -u > $export_symbols'\n   ;;\n \n amigaos*)"}]}