{"sha": "5b0433b4beaee7adf59ad6ff79c83f4285a995b0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NWIwNDMzYjRiZWFlZTdhZGY1OWFkNmZmNzljODNmNDI4NWE5OTViMA==", "commit": {"author": {"name": "CohenArthur", "email": "arthur.cohen@epita.fr", "date": "2021-05-31T18:21:34Z"}, "committer": {"name": "CohenArthur", "email": "arthur.cohen@epita.fr", "date": "2021-05-31T20:32:56Z"}, "message": "stdin: Allow compilation from standard input", "tree": {"sha": "6e488a2a3e61e34c4e1be217e2cb836adb9eed3b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6e488a2a3e61e34c4e1be217e2cb836adb9eed3b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5b0433b4beaee7adf59ad6ff79c83f4285a995b0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5b0433b4beaee7adf59ad6ff79c83f4285a995b0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5b0433b4beaee7adf59ad6ff79c83f4285a995b0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5b0433b4beaee7adf59ad6ff79c83f4285a995b0/comments", "author": {"login": "CohenArthur", "id": 43524065, "node_id": "MDQ6VXNlcjQzNTI0MDY1", "avatar_url": "https://avatars.githubusercontent.com/u/43524065?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CohenArthur", "html_url": "https://github.com/CohenArthur", "followers_url": "https://api.github.com/users/CohenArthur/followers", "following_url": "https://api.github.com/users/CohenArthur/following{/other_user}", "gists_url": "https://api.github.com/users/CohenArthur/gists{/gist_id}", "starred_url": "https://api.github.com/users/CohenArthur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CohenArthur/subscriptions", "organizations_url": "https://api.github.com/users/CohenArthur/orgs", "repos_url": "https://api.github.com/users/CohenArthur/repos", "events_url": "https://api.github.com/users/CohenArthur/events{/privacy}", "received_events_url": "https://api.github.com/users/CohenArthur/received_events", "type": "User", "site_admin": false}, "committer": {"login": "CohenArthur", "id": 43524065, "node_id": "MDQ6VXNlcjQzNTI0MDY1", "avatar_url": "https://avatars.githubusercontent.com/u/43524065?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CohenArthur", "html_url": "https://github.com/CohenArthur", "followers_url": "https://api.github.com/users/CohenArthur/followers", "following_url": "https://api.github.com/users/CohenArthur/following{/other_user}", "gists_url": "https://api.github.com/users/CohenArthur/gists{/gist_id}", "starred_url": "https://api.github.com/users/CohenArthur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CohenArthur/subscriptions", "organizations_url": "https://api.github.com/users/CohenArthur/orgs", "repos_url": "https://api.github.com/users/CohenArthur/repos", "events_url": "https://api.github.com/users/CohenArthur/events{/privacy}", "received_events_url": "https://api.github.com/users/CohenArthur/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "75de60e68b46c555a87822a78d20c7197bddffb5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/75de60e68b46c555a87822a78d20c7197bddffb5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/75de60e68b46c555a87822a78d20c7197bddffb5"}], "stats": {"total": 11, "additions": 9, "deletions": 2}, "files": [{"sha": "8a9640eaf7b25d4250c554c1b82331c64a1f0b4a", "filename": "gcc/rust/lex/rust-lex.h", "status": "modified", "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5b0433b4beaee7adf59ad6ff79c83f4285a995b0/gcc%2Frust%2Flex%2Frust-lex.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5b0433b4beaee7adf59ad6ff79c83f4285a995b0/gcc%2Frust%2Flex%2Frust-lex.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Frust%2Flex%2Frust-lex.h?ref=5b0433b4beaee7adf59ad6ff79c83f4285a995b0", "patch": "@@ -16,7 +16,14 @@ struct RAIIFile\n   FILE *file;\n \n public:\n-  RAIIFile (const char *filename) : file (fopen (filename, \"r\")) {}\n+  RAIIFile (const char *filename)\n+  {\n+    if (strncmp (filename, \"-\", 1) == 0)\n+      file = stdin;\n+    else\n+      file = fopen (filename, \"r\");\n+  }\n+\n   RAIIFile (const RAIIFile &other) = delete;\n   RAIIFile &operator= (const RAIIFile &other) = delete;\n \n@@ -32,7 +39,7 @@ struct RAIIFile\n \n   ~RAIIFile ()\n   {\n-    if (file != nullptr)\n+    if (file != nullptr && file != stdin)\n       fclose (file);\n   }\n "}]}