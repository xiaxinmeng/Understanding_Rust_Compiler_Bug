{"sha": "05575a4695b01941551f84e718997f6803c82dbc", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDU1NzVhNDY5NWIwMTk0MTU1MWY4NGU3MTg5OTdmNjgwM2M4MmRiYw==", "commit": {"author": {"name": "Sebastian Pop", "email": "sebastian.pop@amd.com", "date": "2010-12-15T05:04:50Z"}, "committer": {"name": "Sebastian Pop", "email": "spop@gcc.gnu.org", "date": "2010-12-15T05:04:50Z"}, "message": "Fix PR46845: handle scop parameters before scev analysis.\n\n2010-12-14  Sebastian Pop  <sebastian.pop@amd.com>\n\n\tPR tree-optimization/46845\n\t* sese.c (scalar_evolution_in_region): Handle scop parameters\n\tbefore scev analysis.\n\n\t* gcc.dg/graphite/id-pr46845.c: New.\n\nFrom-SVN: r167844", "tree": {"sha": "97b92d4d577f23044cf2b84c8a604efb5dab883e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/97b92d4d577f23044cf2b84c8a604efb5dab883e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/05575a4695b01941551f84e718997f6803c82dbc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/05575a4695b01941551f84e718997f6803c82dbc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/05575a4695b01941551f84e718997f6803c82dbc", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/05575a4695b01941551f84e718997f6803c82dbc/comments", "author": null, "committer": {"login": "sebpop", "id": 568397, "node_id": "MDQ6VXNlcjU2ODM5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/568397?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sebpop", "html_url": "https://github.com/sebpop", "followers_url": "https://api.github.com/users/sebpop/followers", "following_url": "https://api.github.com/users/sebpop/following{/other_user}", "gists_url": "https://api.github.com/users/sebpop/gists{/gist_id}", "starred_url": "https://api.github.com/users/sebpop/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sebpop/subscriptions", "organizations_url": "https://api.github.com/users/sebpop/orgs", "repos_url": "https://api.github.com/users/sebpop/repos", "events_url": "https://api.github.com/users/sebpop/events{/privacy}", "received_events_url": "https://api.github.com/users/sebpop/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3e6f8b560669aa350629504f80388cc773719f13", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3e6f8b560669aa350629504f80388cc773719f13", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3e6f8b560669aa350629504f80388cc773719f13"}], "stats": {"total": 36, "additions": 33, "deletions": 3}, "files": [{"sha": "549b2901a7b059823983ad4879972d15d09e7075", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/05575a4695b01941551f84e718997f6803c82dbc/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/05575a4695b01941551f84e718997f6803c82dbc/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=05575a4695b01941551f84e718997f6803c82dbc", "patch": "@@ -1,3 +1,9 @@\n+2010-12-14  Sebastian Pop  <sebastian.pop@amd.com>\n+\n+\tPR tree-optimization/46845\n+\t* sese.c (scalar_evolution_in_region): Handle scop parameters\n+\tbefore scev analysis.\n+\n 2010-12-14  Sebastian Pop  <sebastian.pop@amd.com>\n \n \tPR tree-optimization/46928"}, {"sha": "076f07a54ae1909ef88a093617874343faa6f86c", "filename": "gcc/sese.c", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/05575a4695b01941551f84e718997f6803c82dbc/gcc%2Fsese.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/05575a4695b01941551f84e718997f6803c82dbc/gcc%2Fsese.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fsese.c?ref=05575a4695b01941551f84e718997f6803c82dbc", "patch": "@@ -801,14 +801,16 @@ scalar_evolution_in_region (sese region, loop_p loop, tree t)\n   struct loop *def_loop;\n   basic_block before = block_before_sese (region);\n \n+  /* SCOP parameters.  */\n+  if (TREE_CODE (t) == SSA_NAME\n+      && !defined_in_sese_p (t, region))\n+    return t;\n+\n   if (TREE_CODE (t) != SSA_NAME\n       || loop_in_sese_p (loop, region))\n     return instantiate_scev (before, loop,\n \t\t\t     analyze_scalar_evolution (loop, t));\n \n-  if (!defined_in_sese_p (t, region))\n-    return t;\n-\n   def = SSA_NAME_DEF_STMT (t);\n   def_loop = loop_containing_stmt (def);\n "}, {"sha": "ce47905b0ecbf9cff680742fefd451d75aa3d7fe", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/05575a4695b01941551f84e718997f6803c82dbc/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/05575a4695b01941551f84e718997f6803c82dbc/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=05575a4695b01941551f84e718997f6803c82dbc", "patch": "@@ -1,3 +1,8 @@\n+2010-12-14  Sebastian Pop  <sebastian.pop@amd.com>\n+\n+\tPR tree-optimization/46845\n+\t* gcc.dg/graphite/id-pr46845.c: New.\n+\n 2010-12-14  Sebastian Pop  <sebastian.pop@amd.com>\n \n \tPR tree-optimization/46928"}, {"sha": "f4da78eda35e566aa56f30b433d2d15cf33677f0", "filename": "gcc/testsuite/gcc.dg/graphite/id-pr46845.c", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/05575a4695b01941551f84e718997f6803c82dbc/gcc%2Ftestsuite%2Fgcc.dg%2Fgraphite%2Fid-pr46845.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/05575a4695b01941551f84e718997f6803c82dbc/gcc%2Ftestsuite%2Fgcc.dg%2Fgraphite%2Fid-pr46845.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fgraphite%2Fid-pr46845.c?ref=05575a4695b01941551f84e718997f6803c82dbc", "patch": "@@ -0,0 +1,17 @@\n+/* { dg-options \"-O2 -ffast-math -fgraphite-identity -w -Wno-psabi\" { target { i?86-*-* x86_64-*-* } } } */\n+\n+typedef float V2SF __attribute__ ((vector_size (128)));\n+\n+V2SF\n+foo (int x, V2SF a)\n+{\n+  V2SF b;\n+  if (x & 42)\n+    b = a;\n+  else\n+    b = a + (V2SF) {1.0f/0.0f - 1.0f/0.0f, 1.0f/0.0f - 1.0f/0.0f};\n+  while (x--)\n+    a += b;\n+\n+  return a;\n+}"}]}