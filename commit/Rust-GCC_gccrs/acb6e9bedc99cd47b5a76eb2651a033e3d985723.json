{"sha": "acb6e9bedc99cd47b5a76eb2651a033e3d985723", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWNiNmU5YmVkYzk5Y2Q0N2I1YTc2ZWIyNjUxYTAzM2UzZDk4NTcyMw==", "commit": {"author": {"name": "Benjamin Kosnik", "email": "bkoz@redhat.com", "date": "2006-01-16T22:25:13Z"}, "committer": {"name": "Benjamin Kosnik", "email": "bkoz@gcc.gnu.org", "date": "2006-01-16T22:25:13Z"}, "message": "re PR libstdc++/25797 (almost all libstdc++ tests fail)\n\n\n2006-01-16  Benjamin Kosnik  <bkoz@redhat.com>\n\n\tPR libstdc++/25797\n\t* acinclude.m4 (GLIBCXX_CHECK_LINKER_FEATURES): Add -Werror to\n\tCFLAGS for --gc-sections test.  Correct compile test.\n\t* configure: Regenerated.\n\nFrom-SVN: r109775", "tree": {"sha": "2a7557c036e34521a9f10d4b07a0397569007ff6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2a7557c036e34521a9f10d4b07a0397569007ff6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/acb6e9bedc99cd47b5a76eb2651a033e3d985723", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/acb6e9bedc99cd47b5a76eb2651a033e3d985723", "html_url": "https://github.com/Rust-GCC/gccrs/commit/acb6e9bedc99cd47b5a76eb2651a033e3d985723", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/acb6e9bedc99cd47b5a76eb2651a033e3d985723/comments", "author": null, "committer": null, "parents": [{"sha": "d1f37bc642e0f746f2199514ddb017e9de9d07cc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d1f37bc642e0f746f2199514ddb017e9de9d07cc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d1f37bc642e0f746f2199514ddb017e9de9d07cc"}], "stats": {"total": 544, "additions": 278, "deletions": 266}, "files": [{"sha": "43cb2b73640e9897aa28bc1d14bb7b459280f7c0", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/acb6e9bedc99cd47b5a76eb2651a033e3d985723/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/acb6e9bedc99cd47b5a76eb2651a033e3d985723/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=acb6e9bedc99cd47b5a76eb2651a033e3d985723", "patch": "@@ -1,3 +1,10 @@\n+2006-01-16  Benjamin Kosnik  <bkoz@redhat.com>\n+\n+\tPR libstdc++/25797\n+\t* acinclude.m4 (GLIBCXX_CHECK_LINKER_FEATURES): Add -Werror to\n+\tCFLAGS for --gc-sections test.  Correct compile test.\n+\t* configure: Regenerated.\n+\t\n 2006-01-15  Paolo Carlini  <pcarlini@suse.de>\n \t    Gabriel Dos Reis  <gdr@integrable-solutions.net>\n "}, {"sha": "52f15aedc41b72e2a719596f1c7a018dcfe58ca8", "filename": "libstdc++-v3/acinclude.m4", "status": "modified", "additions": 11, "deletions": 16, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/acb6e9bedc99cd47b5a76eb2651a033e3d985723/libstdc%2B%2B-v3%2Facinclude.m4", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/acb6e9bedc99cd47b5a76eb2651a033e3d985723/libstdc%2B%2B-v3%2Facinclude.m4", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Facinclude.m4?ref=acb6e9bedc99cd47b5a76eb2651a033e3d985723", "patch": "@@ -233,33 +233,28 @@ AC_DEFUN([GLIBCXX_CHECK_LINKER_FEATURES], [\n   if test x\"$with_gnu_ld\" = x\"yes\"; then\n     # GNU ld it is!  Joy and bunny rabbits!\n \n-    # All these tests are for C++; save the language and the compiler flags.\n-    # Need to do this so that g++ won't try to link in libstdc++\n+    # All these tests are for C++, but run with the \"C\" compiler driver.\n+    # Need to do this so that g++ won't try to link in libstdc++/libsupc++.\n     ac_test_CFLAGS=\"${CFLAGS+set}\"\n     ac_save_CFLAGS=\"$CFLAGS\"\n-    CFLAGS='-x c++  -Wl,--gc-sections'\n+    CFLAGS='-x c++  -Werror -Wl,--gc-sections'\n \n     # Check for -Wl,--gc-sections\n-    # Note: It's supposed to work now, so ease off until proven wrong...\n     AC_MSG_CHECKING([for ld that supports -Wl,--gc-sections])\n-    AC_TRY_COMPILE([\n-     int main(void)\n-     {\n-       try { throw 1; }\n-       catch (...) { };\n-       return 0;\n-     }\n-    ], [ac_sectionLDflags=yes],[ac_sectionLDflags=no], [ac_sectionLDflags=yes])\n+    AC_TRY_LINK([ int one(void) { return 1; }\n+     int two(void) { return 2; }\n+\t], [ two(); ] , [ac_gcsections=yes], [ac_gcsections=no])\n+    if test \"$ac_gcsections\" = \"yes\"; then\n+      SECTION_LDFLAGS=\"-Wl,--gc-sections $SECTION_LDFLAGS\"\n+    fi\n+    AC_MSG_RESULT($ac_gcsections)\n+\n     if test \"$ac_test_CFLAGS\" = set; then\n       CFLAGS=\"$ac_save_CFLAGS\"\n     else\n       # this is the suspicious part\n       CFLAGS=''\n     fi\n-    if test \"$ac_sectionLDflags\" = \"yes\"; then\n-      SECTION_LDFLAGS=\"-Wl,--gc-sections $SECTION_LDFLAGS\"\n-    fi\n-    AC_MSG_RESULT($ac_sectionLDflags)\n   fi\n \n   # Set -z,relro."}, {"sha": "f7ac1a1fc7f5cc1bafc74e617bf8999e77af58fe", "filename": "libstdc++-v3/configure", "status": "modified", "additions": 260, "deletions": 250, "changes": 510, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/acb6e9bedc99cd47b5a76eb2651a033e3d985723/libstdc%2B%2B-v3%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/acb6e9bedc99cd47b5a76eb2651a033e3d985723/libstdc%2B%2B-v3%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fconfigure?ref=acb6e9bedc99cd47b5a76eb2651a033e3d985723", "patch": "@@ -8211,41 +8211,40 @@ ac_compiler_gnu=$ac_cv_c_compiler_gnu\n   if test x\"$with_gnu_ld\" = x\"yes\"; then\n     # GNU ld it is!  Joy and bunny rabbits!\n \n-    # All these tests are for C++; save the language and the compiler flags.\n-    # Need to do this so that g++ won't try to link in libstdc++\n+    # All these tests are for C++, but run with the \"C\" compiler driver.\n+    # Need to do this so that g++ won't try to link in libstdc++/libsupc++.\n     ac_test_CFLAGS=\"${CFLAGS+set}\"\n     ac_save_CFLAGS=\"$CFLAGS\"\n-    CFLAGS='-x c++  -Wl,--gc-sections'\n+    CFLAGS='-x c++  -Werror -Wl,--gc-sections'\n \n     # Check for -Wl,--gc-sections\n-    # Note: It's supposed to work now, so ease off until proven wrong...\n     echo \"$as_me:$LINENO: checking for ld that supports -Wl,--gc-sections\" >&5\n echo $ECHO_N \"checking for ld that supports -Wl,--gc-sections... $ECHO_C\" >&6\n-    cat >conftest.$ac_ext <<_ACEOF\n+    if test x$gcc_no_link = xyes; then\n+  { { echo \"$as_me:$LINENO: error: Link tests are not allowed after GCC_NO_EXECUTABLES.\" >&5\n+echo \"$as_me: error: Link tests are not allowed after GCC_NO_EXECUTABLES.\" >&2;}\n+   { (exit 1); exit 1; }; }\n+fi\n+cat >conftest.$ac_ext <<_ACEOF\n /* confdefs.h.  */\n _ACEOF\n cat confdefs.h >>conftest.$ac_ext\n cat >>conftest.$ac_ext <<_ACEOF\n /* end confdefs.h.  */\n-\n-     int main(void)\n-     {\n-       try { throw 1; }\n-       catch (...) { };\n-       return 0;\n-     }\n+ int one(void) { return 1; }\n+     int two(void) { return 2; }\n \n int\n main ()\n {\n-ac_sectionLDflags=yes\n+ two();\n   ;\n   return 0;\n }\n _ACEOF\n-rm -f conftest.$ac_objext\n-if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n-  (eval $ac_compile) 2>conftest.er1\n+rm -f conftest.$ac_objext conftest$ac_exeext\n+if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n+  (eval $ac_link) 2>conftest.er1\n   ac_status=$?\n   grep -v '^ *+' conftest.er1 >conftest.err\n   rm -f conftest.er1\n@@ -8259,31 +8258,33 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   ac_status=$?\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); }; } &&\n-\t { ac_try='test -s conftest.$ac_objext'\n+\t { ac_try='test -s conftest$ac_exeext'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); }; }; then\n-  ac_sectionLDflags=no\n+  ac_gcsections=yes\n else\n   echo \"$as_me: failed program was:\" >&5\n sed 's/^/| /' conftest.$ac_ext >&5\n \n-ac_sectionLDflags=yes\n+ac_gcsections=no\n fi\n-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext\n+rm -f conftest.err conftest.$ac_objext \\\n+      conftest$ac_exeext conftest.$ac_ext\n+    if test \"$ac_gcsections\" = \"yes\"; then\n+      SECTION_LDFLAGS=\"-Wl,--gc-sections $SECTION_LDFLAGS\"\n+    fi\n+    echo \"$as_me:$LINENO: result: $ac_gcsections\" >&5\n+echo \"${ECHO_T}$ac_gcsections\" >&6\n+\n     if test \"$ac_test_CFLAGS\" = set; then\n       CFLAGS=\"$ac_save_CFLAGS\"\n     else\n       # this is the suspicious part\n       CFLAGS=''\n     fi\n-    if test \"$ac_sectionLDflags\" = \"yes\"; then\n-      SECTION_LDFLAGS=\"-Wl,--gc-sections $SECTION_LDFLAGS\"\n-    fi\n-    echo \"$as_me:$LINENO: result: $ac_sectionLDflags\" >&5\n-echo \"${ECHO_T}$ac_sectionLDflags\" >&6\n   fi\n \n   # Set -z,relro.\n@@ -53057,41 +53058,40 @@ ac_compiler_gnu=$ac_cv_c_compiler_gnu\n   if test x\"$with_gnu_ld\" = x\"yes\"; then\n     # GNU ld it is!  Joy and bunny rabbits!\n \n-    # All these tests are for C++; save the language and the compiler flags.\n-    # Need to do this so that g++ won't try to link in libstdc++\n+    # All these tests are for C++, but run with the \"C\" compiler driver.\n+    # Need to do this so that g++ won't try to link in libstdc++/libsupc++.\n     ac_test_CFLAGS=\"${CFLAGS+set}\"\n     ac_save_CFLAGS=\"$CFLAGS\"\n-    CFLAGS='-x c++  -Wl,--gc-sections'\n+    CFLAGS='-x c++  -Werror -Wl,--gc-sections'\n \n     # Check for -Wl,--gc-sections\n-    # Note: It's supposed to work now, so ease off until proven wrong...\n     echo \"$as_me:$LINENO: checking for ld that supports -Wl,--gc-sections\" >&5\n echo $ECHO_N \"checking for ld that supports -Wl,--gc-sections... $ECHO_C\" >&6\n-    cat >conftest.$ac_ext <<_ACEOF\n+    if test x$gcc_no_link = xyes; then\n+  { { echo \"$as_me:$LINENO: error: Link tests are not allowed after GCC_NO_EXECUTABLES.\" >&5\n+echo \"$as_me: error: Link tests are not allowed after GCC_NO_EXECUTABLES.\" >&2;}\n+   { (exit 1); exit 1; }; }\n+fi\n+cat >conftest.$ac_ext <<_ACEOF\n /* confdefs.h.  */\n _ACEOF\n cat confdefs.h >>conftest.$ac_ext\n cat >>conftest.$ac_ext <<_ACEOF\n /* end confdefs.h.  */\n-\n-     int main(void)\n-     {\n-       try { throw 1; }\n-       catch (...) { };\n-       return 0;\n-     }\n+ int one(void) { return 1; }\n+     int two(void) { return 2; }\n \n int\n main ()\n {\n-ac_sectionLDflags=yes\n+ two();\n   ;\n   return 0;\n }\n _ACEOF\n-rm -f conftest.$ac_objext\n-if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n-  (eval $ac_compile) 2>conftest.er1\n+rm -f conftest.$ac_objext conftest$ac_exeext\n+if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n+  (eval $ac_link) 2>conftest.er1\n   ac_status=$?\n   grep -v '^ *+' conftest.er1 >conftest.err\n   rm -f conftest.er1\n@@ -53105,31 +53105,33 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   ac_status=$?\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); }; } &&\n-\t { ac_try='test -s conftest.$ac_objext'\n+\t { ac_try='test -s conftest$ac_exeext'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); }; }; then\n-  ac_sectionLDflags=no\n+  ac_gcsections=yes\n else\n   echo \"$as_me: failed program was:\" >&5\n sed 's/^/| /' conftest.$ac_ext >&5\n \n-ac_sectionLDflags=yes\n+ac_gcsections=no\n fi\n-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext\n+rm -f conftest.err conftest.$ac_objext \\\n+      conftest$ac_exeext conftest.$ac_ext\n+    if test \"$ac_gcsections\" = \"yes\"; then\n+      SECTION_LDFLAGS=\"-Wl,--gc-sections $SECTION_LDFLAGS\"\n+    fi\n+    echo \"$as_me:$LINENO: result: $ac_gcsections\" >&5\n+echo \"${ECHO_T}$ac_gcsections\" >&6\n+\n     if test \"$ac_test_CFLAGS\" = set; then\n       CFLAGS=\"$ac_save_CFLAGS\"\n     else\n       # this is the suspicious part\n       CFLAGS=''\n     fi\n-    if test \"$ac_sectionLDflags\" = \"yes\"; then\n-      SECTION_LDFLAGS=\"-Wl,--gc-sections $SECTION_LDFLAGS\"\n-    fi\n-    echo \"$as_me:$LINENO: result: $ac_sectionLDflags\" >&5\n-echo \"${ECHO_T}$ac_sectionLDflags\" >&6\n   fi\n \n   # Set -z,relro.\n@@ -74396,41 +74398,40 @@ done\n   if test x\"$with_gnu_ld\" = x\"yes\"; then\n     # GNU ld it is!  Joy and bunny rabbits!\n \n-    # All these tests are for C++; save the language and the compiler flags.\n-    # Need to do this so that g++ won't try to link in libstdc++\n+    # All these tests are for C++, but run with the \"C\" compiler driver.\n+    # Need to do this so that g++ won't try to link in libstdc++/libsupc++.\n     ac_test_CFLAGS=\"${CFLAGS+set}\"\n     ac_save_CFLAGS=\"$CFLAGS\"\n-    CFLAGS='-x c++  -Wl,--gc-sections'\n+    CFLAGS='-x c++  -Werror -Wl,--gc-sections'\n \n     # Check for -Wl,--gc-sections\n-    # Note: It's supposed to work now, so ease off until proven wrong...\n     echo \"$as_me:$LINENO: checking for ld that supports -Wl,--gc-sections\" >&5\n echo $ECHO_N \"checking for ld that supports -Wl,--gc-sections... $ECHO_C\" >&6\n-    cat >conftest.$ac_ext <<_ACEOF\n+    if test x$gcc_no_link = xyes; then\n+  { { echo \"$as_me:$LINENO: error: Link tests are not allowed after GCC_NO_EXECUTABLES.\" >&5\n+echo \"$as_me: error: Link tests are not allowed after GCC_NO_EXECUTABLES.\" >&2;}\n+   { (exit 1); exit 1; }; }\n+fi\n+cat >conftest.$ac_ext <<_ACEOF\n /* confdefs.h.  */\n _ACEOF\n cat confdefs.h >>conftest.$ac_ext\n cat >>conftest.$ac_ext <<_ACEOF\n /* end confdefs.h.  */\n-\n-     int main(void)\n-     {\n-       try { throw 1; }\n-       catch (...) { };\n-       return 0;\n-     }\n+ int one(void) { return 1; }\n+     int two(void) { return 2; }\n \n int\n main ()\n {\n-ac_sectionLDflags=yes\n+ two();\n   ;\n   return 0;\n }\n _ACEOF\n-rm -f conftest.$ac_objext\n-if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n-  (eval $ac_compile) 2>conftest.er1\n+rm -f conftest.$ac_objext conftest$ac_exeext\n+if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n+  (eval $ac_link) 2>conftest.er1\n   ac_status=$?\n   grep -v '^ *+' conftest.er1 >conftest.err\n   rm -f conftest.er1\n@@ -74444,31 +74445,33 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   ac_status=$?\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); }; } &&\n-\t { ac_try='test -s conftest.$ac_objext'\n+\t { ac_try='test -s conftest$ac_exeext'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); }; }; then\n-  ac_sectionLDflags=no\n+  ac_gcsections=yes\n else\n   echo \"$as_me: failed program was:\" >&5\n sed 's/^/| /' conftest.$ac_ext >&5\n \n-ac_sectionLDflags=yes\n+ac_gcsections=no\n fi\n-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext\n+rm -f conftest.err conftest.$ac_objext \\\n+      conftest$ac_exeext conftest.$ac_ext\n+    if test \"$ac_gcsections\" = \"yes\"; then\n+      SECTION_LDFLAGS=\"-Wl,--gc-sections $SECTION_LDFLAGS\"\n+    fi\n+    echo \"$as_me:$LINENO: result: $ac_gcsections\" >&5\n+echo \"${ECHO_T}$ac_gcsections\" >&6\n+\n     if test \"$ac_test_CFLAGS\" = set; then\n       CFLAGS=\"$ac_save_CFLAGS\"\n     else\n       # this is the suspicious part\n       CFLAGS=''\n     fi\n-    if test \"$ac_sectionLDflags\" = \"yes\"; then\n-      SECTION_LDFLAGS=\"-Wl,--gc-sections $SECTION_LDFLAGS\"\n-    fi\n-    echo \"$as_me:$LINENO: result: $ac_sectionLDflags\" >&5\n-echo \"${ECHO_T}$ac_sectionLDflags\" >&6\n   fi\n \n   # Set -z,relro.\n@@ -75898,41 +75901,40 @@ done\n   if test x\"$with_gnu_ld\" = x\"yes\"; then\n     # GNU ld it is!  Joy and bunny rabbits!\n \n-    # All these tests are for C++; save the language and the compiler flags.\n-    # Need to do this so that g++ won't try to link in libstdc++\n+    # All these tests are for C++, but run with the \"C\" compiler driver.\n+    # Need to do this so that g++ won't try to link in libstdc++/libsupc++.\n     ac_test_CFLAGS=\"${CFLAGS+set}\"\n     ac_save_CFLAGS=\"$CFLAGS\"\n-    CFLAGS='-x c++  -Wl,--gc-sections'\n+    CFLAGS='-x c++  -Werror -Wl,--gc-sections'\n \n     # Check for -Wl,--gc-sections\n-    # Note: It's supposed to work now, so ease off until proven wrong...\n     echo \"$as_me:$LINENO: checking for ld that supports -Wl,--gc-sections\" >&5\n echo $ECHO_N \"checking for ld that supports -Wl,--gc-sections... $ECHO_C\" >&6\n-    cat >conftest.$ac_ext <<_ACEOF\n+    if test x$gcc_no_link = xyes; then\n+  { { echo \"$as_me:$LINENO: error: Link tests are not allowed after GCC_NO_EXECUTABLES.\" >&5\n+echo \"$as_me: error: Link tests are not allowed after GCC_NO_EXECUTABLES.\" >&2;}\n+   { (exit 1); exit 1; }; }\n+fi\n+cat >conftest.$ac_ext <<_ACEOF\n /* confdefs.h.  */\n _ACEOF\n cat confdefs.h >>conftest.$ac_ext\n cat >>conftest.$ac_ext <<_ACEOF\n /* end confdefs.h.  */\n-\n-     int main(void)\n-     {\n-       try { throw 1; }\n-       catch (...) { };\n-       return 0;\n-     }\n+ int one(void) { return 1; }\n+     int two(void) { return 2; }\n \n int\n main ()\n {\n-ac_sectionLDflags=yes\n+ two();\n   ;\n   return 0;\n }\n _ACEOF\n-rm -f conftest.$ac_objext\n-if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n-  (eval $ac_compile) 2>conftest.er1\n+rm -f conftest.$ac_objext conftest$ac_exeext\n+if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n+  (eval $ac_link) 2>conftest.er1\n   ac_status=$?\n   grep -v '^ *+' conftest.er1 >conftest.err\n   rm -f conftest.er1\n@@ -75946,31 +75948,33 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   ac_status=$?\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); }; } &&\n-\t { ac_try='test -s conftest.$ac_objext'\n+\t { ac_try='test -s conftest$ac_exeext'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); }; }; then\n-  ac_sectionLDflags=no\n+  ac_gcsections=yes\n else\n   echo \"$as_me: failed program was:\" >&5\n sed 's/^/| /' conftest.$ac_ext >&5\n \n-ac_sectionLDflags=yes\n+ac_gcsections=no\n fi\n-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext\n+rm -f conftest.err conftest.$ac_objext \\\n+      conftest$ac_exeext conftest.$ac_ext\n+    if test \"$ac_gcsections\" = \"yes\"; then\n+      SECTION_LDFLAGS=\"-Wl,--gc-sections $SECTION_LDFLAGS\"\n+    fi\n+    echo \"$as_me:$LINENO: result: $ac_gcsections\" >&5\n+echo \"${ECHO_T}$ac_gcsections\" >&6\n+\n     if test \"$ac_test_CFLAGS\" = set; then\n       CFLAGS=\"$ac_save_CFLAGS\"\n     else\n       # this is the suspicious part\n       CFLAGS=''\n     fi\n-    if test \"$ac_sectionLDflags\" = \"yes\"; then\n-      SECTION_LDFLAGS=\"-Wl,--gc-sections $SECTION_LDFLAGS\"\n-    fi\n-    echo \"$as_me:$LINENO: result: $ac_sectionLDflags\" >&5\n-echo \"${ECHO_T}$ac_sectionLDflags\" >&6\n   fi\n \n   # Set -z,relro.\n@@ -77276,41 +77280,40 @@ done\n   if test x\"$with_gnu_ld\" = x\"yes\"; then\n     # GNU ld it is!  Joy and bunny rabbits!\n \n-    # All these tests are for C++; save the language and the compiler flags.\n-    # Need to do this so that g++ won't try to link in libstdc++\n+    # All these tests are for C++, but run with the \"C\" compiler driver.\n+    # Need to do this so that g++ won't try to link in libstdc++/libsupc++.\n     ac_test_CFLAGS=\"${CFLAGS+set}\"\n     ac_save_CFLAGS=\"$CFLAGS\"\n-    CFLAGS='-x c++  -Wl,--gc-sections'\n+    CFLAGS='-x c++  -Werror -Wl,--gc-sections'\n \n     # Check for -Wl,--gc-sections\n-    # Note: It's supposed to work now, so ease off until proven wrong...\n     echo \"$as_me:$LINENO: checking for ld that supports -Wl,--gc-sections\" >&5\n echo $ECHO_N \"checking for ld that supports -Wl,--gc-sections... $ECHO_C\" >&6\n-    cat >conftest.$ac_ext <<_ACEOF\n+    if test x$gcc_no_link = xyes; then\n+  { { echo \"$as_me:$LINENO: error: Link tests are not allowed after GCC_NO_EXECUTABLES.\" >&5\n+echo \"$as_me: error: Link tests are not allowed after GCC_NO_EXECUTABLES.\" >&2;}\n+   { (exit 1); exit 1; }; }\n+fi\n+cat >conftest.$ac_ext <<_ACEOF\n /* confdefs.h.  */\n _ACEOF\n cat confdefs.h >>conftest.$ac_ext\n cat >>conftest.$ac_ext <<_ACEOF\n /* end confdefs.h.  */\n-\n-     int main(void)\n-     {\n-       try { throw 1; }\n-       catch (...) { };\n-       return 0;\n-     }\n+ int one(void) { return 1; }\n+     int two(void) { return 2; }\n \n int\n main ()\n {\n-ac_sectionLDflags=yes\n+ two();\n   ;\n   return 0;\n }\n _ACEOF\n-rm -f conftest.$ac_objext\n-if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n-  (eval $ac_compile) 2>conftest.er1\n+rm -f conftest.$ac_objext conftest$ac_exeext\n+if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n+  (eval $ac_link) 2>conftest.er1\n   ac_status=$?\n   grep -v '^ *+' conftest.er1 >conftest.err\n   rm -f conftest.er1\n@@ -77324,31 +77327,33 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   ac_status=$?\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); }; } &&\n-\t { ac_try='test -s conftest.$ac_objext'\n+\t { ac_try='test -s conftest$ac_exeext'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); }; }; then\n-  ac_sectionLDflags=no\n+  ac_gcsections=yes\n else\n   echo \"$as_me: failed program was:\" >&5\n sed 's/^/| /' conftest.$ac_ext >&5\n \n-ac_sectionLDflags=yes\n+ac_gcsections=no\n fi\n-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext\n+rm -f conftest.err conftest.$ac_objext \\\n+      conftest$ac_exeext conftest.$ac_ext\n+    if test \"$ac_gcsections\" = \"yes\"; then\n+      SECTION_LDFLAGS=\"-Wl,--gc-sections $SECTION_LDFLAGS\"\n+    fi\n+    echo \"$as_me:$LINENO: result: $ac_gcsections\" >&5\n+echo \"${ECHO_T}$ac_gcsections\" >&6\n+\n     if test \"$ac_test_CFLAGS\" = set; then\n       CFLAGS=\"$ac_save_CFLAGS\"\n     else\n       # this is the suspicious part\n       CFLAGS=''\n     fi\n-    if test \"$ac_sectionLDflags\" = \"yes\"; then\n-      SECTION_LDFLAGS=\"-Wl,--gc-sections $SECTION_LDFLAGS\"\n-    fi\n-    echo \"$as_me:$LINENO: result: $ac_sectionLDflags\" >&5\n-echo \"${ECHO_T}$ac_sectionLDflags\" >&6\n   fi\n \n   # Set -z,relro.\n@@ -79441,41 +79446,40 @@ done\n   if test x\"$with_gnu_ld\" = x\"yes\"; then\n     # GNU ld it is!  Joy and bunny rabbits!\n \n-    # All these tests are for C++; save the language and the compiler flags.\n-    # Need to do this so that g++ won't try to link in libstdc++\n+    # All these tests are for C++, but run with the \"C\" compiler driver.\n+    # Need to do this so that g++ won't try to link in libstdc++/libsupc++.\n     ac_test_CFLAGS=\"${CFLAGS+set}\"\n     ac_save_CFLAGS=\"$CFLAGS\"\n-    CFLAGS='-x c++  -Wl,--gc-sections'\n+    CFLAGS='-x c++  -Werror -Wl,--gc-sections'\n \n     # Check for -Wl,--gc-sections\n-    # Note: It's supposed to work now, so ease off until proven wrong...\n     echo \"$as_me:$LINENO: checking for ld that supports -Wl,--gc-sections\" >&5\n echo $ECHO_N \"checking for ld that supports -Wl,--gc-sections... $ECHO_C\" >&6\n-    cat >conftest.$ac_ext <<_ACEOF\n+    if test x$gcc_no_link = xyes; then\n+  { { echo \"$as_me:$LINENO: error: Link tests are not allowed after GCC_NO_EXECUTABLES.\" >&5\n+echo \"$as_me: error: Link tests are not allowed after GCC_NO_EXECUTABLES.\" >&2;}\n+   { (exit 1); exit 1; }; }\n+fi\n+cat >conftest.$ac_ext <<_ACEOF\n /* confdefs.h.  */\n _ACEOF\n cat confdefs.h >>conftest.$ac_ext\n cat >>conftest.$ac_ext <<_ACEOF\n /* end confdefs.h.  */\n-\n-     int main(void)\n-     {\n-       try { throw 1; }\n-       catch (...) { };\n-       return 0;\n-     }\n+ int one(void) { return 1; }\n+     int two(void) { return 2; }\n \n int\n main ()\n {\n-ac_sectionLDflags=yes\n+ two();\n   ;\n   return 0;\n }\n _ACEOF\n-rm -f conftest.$ac_objext\n-if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n-  (eval $ac_compile) 2>conftest.er1\n+rm -f conftest.$ac_objext conftest$ac_exeext\n+if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n+  (eval $ac_link) 2>conftest.er1\n   ac_status=$?\n   grep -v '^ *+' conftest.er1 >conftest.err\n   rm -f conftest.er1\n@@ -79489,31 +79493,33 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   ac_status=$?\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); }; } &&\n-\t { ac_try='test -s conftest.$ac_objext'\n+\t { ac_try='test -s conftest$ac_exeext'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); }; }; then\n-  ac_sectionLDflags=no\n+  ac_gcsections=yes\n else\n   echo \"$as_me: failed program was:\" >&5\n sed 's/^/| /' conftest.$ac_ext >&5\n \n-ac_sectionLDflags=yes\n+ac_gcsections=no\n fi\n-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext\n+rm -f conftest.err conftest.$ac_objext \\\n+      conftest$ac_exeext conftest.$ac_ext\n+    if test \"$ac_gcsections\" = \"yes\"; then\n+      SECTION_LDFLAGS=\"-Wl,--gc-sections $SECTION_LDFLAGS\"\n+    fi\n+    echo \"$as_me:$LINENO: result: $ac_gcsections\" >&5\n+echo \"${ECHO_T}$ac_gcsections\" >&6\n+\n     if test \"$ac_test_CFLAGS\" = set; then\n       CFLAGS=\"$ac_save_CFLAGS\"\n     else\n       # this is the suspicious part\n       CFLAGS=''\n     fi\n-    if test \"$ac_sectionLDflags\" = \"yes\"; then\n-      SECTION_LDFLAGS=\"-Wl,--gc-sections $SECTION_LDFLAGS\"\n-    fi\n-    echo \"$as_me:$LINENO: result: $ac_sectionLDflags\" >&5\n-echo \"${ECHO_T}$ac_sectionLDflags\" >&6\n   fi\n \n   # Set -z,relro.\n@@ -80772,41 +80778,40 @@ done\n   if test x\"$with_gnu_ld\" = x\"yes\"; then\n     # GNU ld it is!  Joy and bunny rabbits!\n \n-    # All these tests are for C++; save the language and the compiler flags.\n-    # Need to do this so that g++ won't try to link in libstdc++\n+    # All these tests are for C++, but run with the \"C\" compiler driver.\n+    # Need to do this so that g++ won't try to link in libstdc++/libsupc++.\n     ac_test_CFLAGS=\"${CFLAGS+set}\"\n     ac_save_CFLAGS=\"$CFLAGS\"\n-    CFLAGS='-x c++  -Wl,--gc-sections'\n+    CFLAGS='-x c++  -Werror -Wl,--gc-sections'\n \n     # Check for -Wl,--gc-sections\n-    # Note: It's supposed to work now, so ease off until proven wrong...\n     echo \"$as_me:$LINENO: checking for ld that supports -Wl,--gc-sections\" >&5\n echo $ECHO_N \"checking for ld that supports -Wl,--gc-sections... $ECHO_C\" >&6\n-    cat >conftest.$ac_ext <<_ACEOF\n+    if test x$gcc_no_link = xyes; then\n+  { { echo \"$as_me:$LINENO: error: Link tests are not allowed after GCC_NO_EXECUTABLES.\" >&5\n+echo \"$as_me: error: Link tests are not allowed after GCC_NO_EXECUTABLES.\" >&2;}\n+   { (exit 1); exit 1; }; }\n+fi\n+cat >conftest.$ac_ext <<_ACEOF\n /* confdefs.h.  */\n _ACEOF\n cat confdefs.h >>conftest.$ac_ext\n cat >>conftest.$ac_ext <<_ACEOF\n /* end confdefs.h.  */\n-\n-     int main(void)\n-     {\n-       try { throw 1; }\n-       catch (...) { };\n-       return 0;\n-     }\n+ int one(void) { return 1; }\n+     int two(void) { return 2; }\n \n int\n main ()\n {\n-ac_sectionLDflags=yes\n+ two();\n   ;\n   return 0;\n }\n _ACEOF\n-rm -f conftest.$ac_objext\n-if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n-  (eval $ac_compile) 2>conftest.er1\n+rm -f conftest.$ac_objext conftest$ac_exeext\n+if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n+  (eval $ac_link) 2>conftest.er1\n   ac_status=$?\n   grep -v '^ *+' conftest.er1 >conftest.err\n   rm -f conftest.er1\n@@ -80820,31 +80825,33 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   ac_status=$?\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); }; } &&\n-\t { ac_try='test -s conftest.$ac_objext'\n+\t { ac_try='test -s conftest$ac_exeext'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); }; }; then\n-  ac_sectionLDflags=no\n+  ac_gcsections=yes\n else\n   echo \"$as_me: failed program was:\" >&5\n sed 's/^/| /' conftest.$ac_ext >&5\n \n-ac_sectionLDflags=yes\n+ac_gcsections=no\n fi\n-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext\n+rm -f conftest.err conftest.$ac_objext \\\n+      conftest$ac_exeext conftest.$ac_ext\n+    if test \"$ac_gcsections\" = \"yes\"; then\n+      SECTION_LDFLAGS=\"-Wl,--gc-sections $SECTION_LDFLAGS\"\n+    fi\n+    echo \"$as_me:$LINENO: result: $ac_gcsections\" >&5\n+echo \"${ECHO_T}$ac_gcsections\" >&6\n+\n     if test \"$ac_test_CFLAGS\" = set; then\n       CFLAGS=\"$ac_save_CFLAGS\"\n     else\n       # this is the suspicious part\n       CFLAGS=''\n     fi\n-    if test \"$ac_sectionLDflags\" = \"yes\"; then\n-      SECTION_LDFLAGS=\"-Wl,--gc-sections $SECTION_LDFLAGS\"\n-    fi\n-    echo \"$as_me:$LINENO: result: $ac_sectionLDflags\" >&5\n-echo \"${ECHO_T}$ac_sectionLDflags\" >&6\n   fi\n \n   # Set -z,relro.\n@@ -82152,41 +82159,40 @@ done\n   if test x\"$with_gnu_ld\" = x\"yes\"; then\n     # GNU ld it is!  Joy and bunny rabbits!\n \n-    # All these tests are for C++; save the language and the compiler flags.\n-    # Need to do this so that g++ won't try to link in libstdc++\n+    # All these tests are for C++, but run with the \"C\" compiler driver.\n+    # Need to do this so that g++ won't try to link in libstdc++/libsupc++.\n     ac_test_CFLAGS=\"${CFLAGS+set}\"\n     ac_save_CFLAGS=\"$CFLAGS\"\n-    CFLAGS='-x c++  -Wl,--gc-sections'\n+    CFLAGS='-x c++  -Werror -Wl,--gc-sections'\n \n     # Check for -Wl,--gc-sections\n-    # Note: It's supposed to work now, so ease off until proven wrong...\n     echo \"$as_me:$LINENO: checking for ld that supports -Wl,--gc-sections\" >&5\n echo $ECHO_N \"checking for ld that supports -Wl,--gc-sections... $ECHO_C\" >&6\n-    cat >conftest.$ac_ext <<_ACEOF\n+    if test x$gcc_no_link = xyes; then\n+  { { echo \"$as_me:$LINENO: error: Link tests are not allowed after GCC_NO_EXECUTABLES.\" >&5\n+echo \"$as_me: error: Link tests are not allowed after GCC_NO_EXECUTABLES.\" >&2;}\n+   { (exit 1); exit 1; }; }\n+fi\n+cat >conftest.$ac_ext <<_ACEOF\n /* confdefs.h.  */\n _ACEOF\n cat confdefs.h >>conftest.$ac_ext\n cat >>conftest.$ac_ext <<_ACEOF\n /* end confdefs.h.  */\n-\n-     int main(void)\n-     {\n-       try { throw 1; }\n-       catch (...) { };\n-       return 0;\n-     }\n+ int one(void) { return 1; }\n+     int two(void) { return 2; }\n \n int\n main ()\n {\n-ac_sectionLDflags=yes\n+ two();\n   ;\n   return 0;\n }\n _ACEOF\n-rm -f conftest.$ac_objext\n-if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n-  (eval $ac_compile) 2>conftest.er1\n+rm -f conftest.$ac_objext conftest$ac_exeext\n+if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n+  (eval $ac_link) 2>conftest.er1\n   ac_status=$?\n   grep -v '^ *+' conftest.er1 >conftest.err\n   rm -f conftest.er1\n@@ -82200,31 +82206,33 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   ac_status=$?\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); }; } &&\n-\t { ac_try='test -s conftest.$ac_objext'\n+\t { ac_try='test -s conftest$ac_exeext'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); }; }; then\n-  ac_sectionLDflags=no\n+  ac_gcsections=yes\n else\n   echo \"$as_me: failed program was:\" >&5\n sed 's/^/| /' conftest.$ac_ext >&5\n \n-ac_sectionLDflags=yes\n+ac_gcsections=no\n fi\n-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext\n+rm -f conftest.err conftest.$ac_objext \\\n+      conftest$ac_exeext conftest.$ac_ext\n+    if test \"$ac_gcsections\" = \"yes\"; then\n+      SECTION_LDFLAGS=\"-Wl,--gc-sections $SECTION_LDFLAGS\"\n+    fi\n+    echo \"$as_me:$LINENO: result: $ac_gcsections\" >&5\n+echo \"${ECHO_T}$ac_gcsections\" >&6\n+\n     if test \"$ac_test_CFLAGS\" = set; then\n       CFLAGS=\"$ac_save_CFLAGS\"\n     else\n       # this is the suspicious part\n       CFLAGS=''\n     fi\n-    if test \"$ac_sectionLDflags\" = \"yes\"; then\n-      SECTION_LDFLAGS=\"-Wl,--gc-sections $SECTION_LDFLAGS\"\n-    fi\n-    echo \"$as_me:$LINENO: result: $ac_sectionLDflags\" >&5\n-echo \"${ECHO_T}$ac_sectionLDflags\" >&6\n   fi\n \n   # Set -z,relro.\n@@ -83924,41 +83932,40 @@ echo \"${ECHO_T}$glibcxx_cv_WRITEV\" >&6\n   if test x\"$with_gnu_ld\" = x\"yes\"; then\n     # GNU ld it is!  Joy and bunny rabbits!\n \n-    # All these tests are for C++; save the language and the compiler flags.\n-    # Need to do this so that g++ won't try to link in libstdc++\n+    # All these tests are for C++, but run with the \"C\" compiler driver.\n+    # Need to do this so that g++ won't try to link in libstdc++/libsupc++.\n     ac_test_CFLAGS=\"${CFLAGS+set}\"\n     ac_save_CFLAGS=\"$CFLAGS\"\n-    CFLAGS='-x c++  -Wl,--gc-sections'\n+    CFLAGS='-x c++  -Werror -Wl,--gc-sections'\n \n     # Check for -Wl,--gc-sections\n-    # Note: It's supposed to work now, so ease off until proven wrong...\n     echo \"$as_me:$LINENO: checking for ld that supports -Wl,--gc-sections\" >&5\n echo $ECHO_N \"checking for ld that supports -Wl,--gc-sections... $ECHO_C\" >&6\n-    cat >conftest.$ac_ext <<_ACEOF\n+    if test x$gcc_no_link = xyes; then\n+  { { echo \"$as_me:$LINENO: error: Link tests are not allowed after GCC_NO_EXECUTABLES.\" >&5\n+echo \"$as_me: error: Link tests are not allowed after GCC_NO_EXECUTABLES.\" >&2;}\n+   { (exit 1); exit 1; }; }\n+fi\n+cat >conftest.$ac_ext <<_ACEOF\n /* confdefs.h.  */\n _ACEOF\n cat confdefs.h >>conftest.$ac_ext\n cat >>conftest.$ac_ext <<_ACEOF\n /* end confdefs.h.  */\n-\n-     int main(void)\n-     {\n-       try { throw 1; }\n-       catch (...) { };\n-       return 0;\n-     }\n+ int one(void) { return 1; }\n+     int two(void) { return 2; }\n \n int\n main ()\n {\n-ac_sectionLDflags=yes\n+ two();\n   ;\n   return 0;\n }\n _ACEOF\n-rm -f conftest.$ac_objext\n-if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n-  (eval $ac_compile) 2>conftest.er1\n+rm -f conftest.$ac_objext conftest$ac_exeext\n+if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n+  (eval $ac_link) 2>conftest.er1\n   ac_status=$?\n   grep -v '^ *+' conftest.er1 >conftest.err\n   rm -f conftest.er1\n@@ -83972,31 +83979,33 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   ac_status=$?\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); }; } &&\n-\t { ac_try='test -s conftest.$ac_objext'\n+\t { ac_try='test -s conftest$ac_exeext'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); }; }; then\n-  ac_sectionLDflags=no\n+  ac_gcsections=yes\n else\n   echo \"$as_me: failed program was:\" >&5\n sed 's/^/| /' conftest.$ac_ext >&5\n \n-ac_sectionLDflags=yes\n+ac_gcsections=no\n fi\n-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext\n+rm -f conftest.err conftest.$ac_objext \\\n+      conftest$ac_exeext conftest.$ac_ext\n+    if test \"$ac_gcsections\" = \"yes\"; then\n+      SECTION_LDFLAGS=\"-Wl,--gc-sections $SECTION_LDFLAGS\"\n+    fi\n+    echo \"$as_me:$LINENO: result: $ac_gcsections\" >&5\n+echo \"${ECHO_T}$ac_gcsections\" >&6\n+\n     if test \"$ac_test_CFLAGS\" = set; then\n       CFLAGS=\"$ac_save_CFLAGS\"\n     else\n       # this is the suspicious part\n       CFLAGS=''\n     fi\n-    if test \"$ac_sectionLDflags\" = \"yes\"; then\n-      SECTION_LDFLAGS=\"-Wl,--gc-sections $SECTION_LDFLAGS\"\n-    fi\n-    echo \"$as_me:$LINENO: result: $ac_sectionLDflags\" >&5\n-echo \"${ECHO_T}$ac_sectionLDflags\" >&6\n   fi\n \n   # Set -z,relro.\n@@ -86017,41 +86026,40 @@ done\n   if test x\"$with_gnu_ld\" = x\"yes\"; then\n     # GNU ld it is!  Joy and bunny rabbits!\n \n-    # All these tests are for C++; save the language and the compiler flags.\n-    # Need to do this so that g++ won't try to link in libstdc++\n+    # All these tests are for C++, but run with the \"C\" compiler driver.\n+    # Need to do this so that g++ won't try to link in libstdc++/libsupc++.\n     ac_test_CFLAGS=\"${CFLAGS+set}\"\n     ac_save_CFLAGS=\"$CFLAGS\"\n-    CFLAGS='-x c++  -Wl,--gc-sections'\n+    CFLAGS='-x c++  -Werror -Wl,--gc-sections'\n \n     # Check for -Wl,--gc-sections\n-    # Note: It's supposed to work now, so ease off until proven wrong...\n     echo \"$as_me:$LINENO: checking for ld that supports -Wl,--gc-sections\" >&5\n echo $ECHO_N \"checking for ld that supports -Wl,--gc-sections... $ECHO_C\" >&6\n-    cat >conftest.$ac_ext <<_ACEOF\n+    if test x$gcc_no_link = xyes; then\n+  { { echo \"$as_me:$LINENO: error: Link tests are not allowed after GCC_NO_EXECUTABLES.\" >&5\n+echo \"$as_me: error: Link tests are not allowed after GCC_NO_EXECUTABLES.\" >&2;}\n+   { (exit 1); exit 1; }; }\n+fi\n+cat >conftest.$ac_ext <<_ACEOF\n /* confdefs.h.  */\n _ACEOF\n cat confdefs.h >>conftest.$ac_ext\n cat >>conftest.$ac_ext <<_ACEOF\n /* end confdefs.h.  */\n-\n-     int main(void)\n-     {\n-       try { throw 1; }\n-       catch (...) { };\n-       return 0;\n-     }\n+ int one(void) { return 1; }\n+     int two(void) { return 2; }\n \n int\n main ()\n {\n-ac_sectionLDflags=yes\n+ two();\n   ;\n   return 0;\n }\n _ACEOF\n-rm -f conftest.$ac_objext\n-if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n-  (eval $ac_compile) 2>conftest.er1\n+rm -f conftest.$ac_objext conftest$ac_exeext\n+if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n+  (eval $ac_link) 2>conftest.er1\n   ac_status=$?\n   grep -v '^ *+' conftest.er1 >conftest.err\n   rm -f conftest.er1\n@@ -86065,31 +86073,33 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   ac_status=$?\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); }; } &&\n-\t { ac_try='test -s conftest.$ac_objext'\n+\t { ac_try='test -s conftest$ac_exeext'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); }; }; then\n-  ac_sectionLDflags=no\n+  ac_gcsections=yes\n else\n   echo \"$as_me: failed program was:\" >&5\n sed 's/^/| /' conftest.$ac_ext >&5\n \n-ac_sectionLDflags=yes\n+ac_gcsections=no\n fi\n-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext\n+rm -f conftest.err conftest.$ac_objext \\\n+      conftest$ac_exeext conftest.$ac_ext\n+    if test \"$ac_gcsections\" = \"yes\"; then\n+      SECTION_LDFLAGS=\"-Wl,--gc-sections $SECTION_LDFLAGS\"\n+    fi\n+    echo \"$as_me:$LINENO: result: $ac_gcsections\" >&5\n+echo \"${ECHO_T}$ac_gcsections\" >&6\n+\n     if test \"$ac_test_CFLAGS\" = set; then\n       CFLAGS=\"$ac_save_CFLAGS\"\n     else\n       # this is the suspicious part\n       CFLAGS=''\n     fi\n-    if test \"$ac_sectionLDflags\" = \"yes\"; then\n-      SECTION_LDFLAGS=\"-Wl,--gc-sections $SECTION_LDFLAGS\"\n-    fi\n-    echo \"$as_me:$LINENO: result: $ac_sectionLDflags\" >&5\n-echo \"${ECHO_T}$ac_sectionLDflags\" >&6\n   fi\n \n   # Set -z,relro."}]}