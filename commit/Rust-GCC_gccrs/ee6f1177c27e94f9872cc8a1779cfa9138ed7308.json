{"sha": "ee6f1177c27e94f9872cc8a1779cfa9138ed7308", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWU2ZjExNzdjMjdlOTRmOTg3MmNjOGExNzc5Y2ZhOTEzOGVkNzMwOA==", "commit": {"author": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2011-06-14T12:48:06Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2011-06-14T12:48:06Z"}, "message": "cgraph.c (cgraph_make_decl_local): Handle DECL_ONE_ONLY similarly to DECL_COMDAT.\n\n\t* cgraph.c (cgraph_make_decl_local): Handle DECL_ONE_ONLY\n\tsimilarly to DECL_COMDAT.\n\t* cgraphunit.c (cgraph_analyze_function): Likewise.\n\t* ipa.c (function_and_variable_visibility): Likewise.\n\nFrom-SVN: r175015", "tree": {"sha": "23005cac831f2efc77c204e3d495cd9069c33e7c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/23005cac831f2efc77c204e3d495cd9069c33e7c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ee6f1177c27e94f9872cc8a1779cfa9138ed7308", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ee6f1177c27e94f9872cc8a1779cfa9138ed7308", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ee6f1177c27e94f9872cc8a1779cfa9138ed7308", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ee6f1177c27e94f9872cc8a1779cfa9138ed7308/comments", "author": null, "committer": null, "parents": [{"sha": "618abf9a1a9cf867869751875ea5eac1dc6a7fea", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/618abf9a1a9cf867869751875ea5eac1dc6a7fea", "html_url": "https://github.com/Rust-GCC/gccrs/commit/618abf9a1a9cf867869751875ea5eac1dc6a7fea"}], "stats": {"total": 17, "additions": 12, "deletions": 5}, "files": [{"sha": "c1f7568d541286a2376a59579f560a2c64428e13", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ee6f1177c27e94f9872cc8a1779cfa9138ed7308/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ee6f1177c27e94f9872cc8a1779cfa9138ed7308/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=ee6f1177c27e94f9872cc8a1779cfa9138ed7308", "patch": "@@ -1,3 +1,10 @@\n+2011-06-13  Jan Hubicka  <jh@suse.cz>\n+\n+\t* cgraph.c (cgraph_make_decl_local): Handle DECL_ONE_ONLY\n+\tsimilarly to DECL_COMDAT.\n+\t* cgraphunit.c (cgraph_analyze_function): Likewise.\n+\t* ipa.c (function_and_variable_visibility): Likewise.\n+\n 2011-06-13  Jan Hubicka  <jh@suse.cz>\n \n \t* lto-streamer-out.c (lto_output_ts_binfo_tree_pointers): Do not output"}, {"sha": "86e72072eabfbddeef974997a37fb8a01282e9b3", "filename": "gcc/cgraph.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ee6f1177c27e94f9872cc8a1779cfa9138ed7308/gcc%2Fcgraph.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ee6f1177c27e94f9872cc8a1779cfa9138ed7308/gcc%2Fcgraph.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcgraph.c?ref=ee6f1177c27e94f9872cc8a1779cfa9138ed7308", "patch": "@@ -2487,7 +2487,7 @@ cgraph_make_decl_local (tree decl)\n     DECL_COMMON (decl) = 0;\n   else gcc_assert (TREE_CODE (decl) == FUNCTION_DECL);\n \n-  if (DECL_COMDAT (decl))\n+  if (DECL_ONE_ONLY (decl) || DECL_COMDAT (decl))\n     {\n       /* It is possible that we are linking against library defining same COMDAT\n \t function.  To avoid conflict we need to rename our local name of the"}, {"sha": "0e7842cd896f9d27f8ed7ea4a7bc6ddc85f437b4", "filename": "gcc/cgraphunit.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ee6f1177c27e94f9872cc8a1779cfa9138ed7308/gcc%2Fcgraphunit.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ee6f1177c27e94f9872cc8a1779cfa9138ed7308/gcc%2Fcgraphunit.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcgraphunit.c?ref=ee6f1177c27e94f9872cc8a1779cfa9138ed7308", "patch": "@@ -830,9 +830,9 @@ cgraph_analyze_function (struct cgraph_node *node)\n       if (TREE_PUBLIC (node->decl) && node->same_body_alias)\n \t{\n           DECL_EXTERNAL (node->decl) = DECL_EXTERNAL (node->thunk.alias);\n-\t  if (DECL_COMDAT (node->thunk.alias))\n+\t  if (DECL_ONE_ONLY (node->thunk.alias))\n \t    {\n-\t      DECL_COMDAT (node->decl) = 1;\n+\t      DECL_COMDAT (node->decl) = DECL_COMDAT (node->thunk.alias);\n \t      DECL_COMDAT_GROUP (node->decl) = DECL_COMDAT_GROUP (node->thunk.alias);\n \t      if (DECL_ONE_ONLY (node->thunk.alias) && !node->same_comdat_group)\n \t\t{"}, {"sha": "0edb344c5e577bc352db19201f149b756e0ca01a", "filename": "gcc/ipa.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ee6f1177c27e94f9872cc8a1779cfa9138ed7308/gcc%2Fipa.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ee6f1177c27e94f9872cc8a1779cfa9138ed7308/gcc%2Fipa.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa.c?ref=ee6f1177c27e94f9872cc8a1779cfa9138ed7308", "patch": "@@ -904,9 +904,9 @@ function_and_variable_visibility (bool whole_program)\n \n \t     We also need to arrange the thunk into the same comdat group as\n \t     the function it reffers to.  */\n-\t  if (DECL_COMDAT (decl_node->decl))\n+\t  if (DECL_ONE_ONLY (decl_node->decl))\n \t    {\n-\t      DECL_COMDAT (node->decl) = 1;\n+\t      DECL_COMDAT (node->decl) = DECL_COMDAT (decl_node->decl);\n \t      DECL_COMDAT_GROUP (node->decl) = DECL_COMDAT_GROUP (decl_node->decl);\n \t      if (DECL_ONE_ONLY (decl_node->decl) && !node->same_comdat_group)\n \t\t{"}]}