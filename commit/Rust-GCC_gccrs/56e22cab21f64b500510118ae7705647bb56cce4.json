{"sha": "56e22cab21f64b500510118ae7705647bb56cce4", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTZlMjJjYWIyMWY2NGI1MDA1MTAxMThhZTc3MDU2NDdiYjU2Y2NlNA==", "commit": {"author": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2011-01-12T15:47:29Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2011-01-12T15:47:29Z"}, "message": "re PR driver/47244 (plugin linker is used unconditionally)\n\n\tPR driver/47244\n\t* gcc.c (PLUGIN_COND): Update to disable plugin unless -flto is used.\n\t(PLUGIN_COND_CLOSE): New macro.\n\t(LINK_COMMAND_SPEC): Update to use PLUGIN_COND_CLOSE.\n\nFrom-SVN: r168717", "tree": {"sha": "854151fb4c00fe11201e919c9c91ad15f623500e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/854151fb4c00fe11201e919c9c91ad15f623500e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/56e22cab21f64b500510118ae7705647bb56cce4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/56e22cab21f64b500510118ae7705647bb56cce4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/56e22cab21f64b500510118ae7705647bb56cce4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/56e22cab21f64b500510118ae7705647bb56cce4/comments", "author": null, "committer": null, "parents": [{"sha": "d559a7f87cb243acc9f80c716f3648186e2fe01f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d559a7f87cb243acc9f80c716f3648186e2fe01f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d559a7f87cb243acc9f80c716f3648186e2fe01f"}], "stats": {"total": 24, "additions": 19, "deletions": 5}, "files": [{"sha": "db57dfd81adb5ae699b5b8c8a9a45ed6552ffdf6", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/56e22cab21f64b500510118ae7705647bb56cce4/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/56e22cab21f64b500510118ae7705647bb56cce4/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=56e22cab21f64b500510118ae7705647bb56cce4", "patch": "@@ -1,3 +1,10 @@\n+2011-01-12  Jan Hubicka  <jh@suse.cz>\n+\n+\tPR driver/47244\n+\t* gcc.c (PLUGIN_COND): Update to disable plugin unless -flto is used.\n+\t(PLUGIN_COND_CLOSE): New macro.\n+\t(LINK_COMMAND_SPEC): Update to use PLUGIN_COND_CLOSE.\n+\n 2011-01-12  Richard Guenther  <rguenther@suse.de>\n \n \tPR lto/47259"}, {"sha": "ea3403b5ca96fac0f2d355470ba2d45705aad124", "filename": "gcc/gcc.c", "status": "modified", "additions": 12, "deletions": 5, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/56e22cab21f64b500510118ae7705647bb56cce4/gcc%2Fgcc.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/56e22cab21f64b500510118ae7705647bb56cce4/gcc%2Fgcc.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgcc.c?ref=56e22cab21f64b500510118ae7705647bb56cce4", "patch": "@@ -621,11 +621,18 @@ proper position among the other output files.  */\n # endif\n #endif\n \n-/* Conditional to test whether plugin is used or not.  */\n+/* Conditional to test whether plugin is used or not.\n+   FIXME: For slim LTO we will need to enable plugin unconditionally.  This\n+   still cause problems with PLUGIN_LD != LD and when plugin is built but\n+   not useable.  For GCC 4.6 we don't support slim LTO and thus we can enable\n+   plugin only when LTO is enabled.  We still honor explicit\n+   -fuse-linker-plugin.  */\n #ifdef HAVE_LTO_PLUGIN\n-#define PLUGIN_COND \"!fno-use-linker-plugin\"\n+#define PLUGIN_COND \"!fno-use-linker-plugin:%{flto|flto=*|fuse-linker-plugin\"\n+#define PLUGIN_COND_CLOSE \"}\"\n #else\n #define PLUGIN_COND \"fuse-linker-plugin\"\n+#define PLUGIN_COND_CLOSE \"\"\n #endif\n \n \n@@ -646,9 +653,9 @@ proper position among the other output files.  */\n     -plugin-opt=%(lto_wrapper) \\\n     -plugin-opt=-fresolution=%u.res \\\n     %{!nostdlib:%{!nodefaultlibs:%:pass-through-libs(%(link_gcc_c_sequence))}} \\\n-    } \\\n-    %{flto*:%<fcompare-debug*} \\\n-    %{flto*} %l \" LINK_PIE_SPEC \\\n+    }\"PLUGIN_COND_CLOSE\" \\\n+    %{flto|flto=*:%<fcompare-debug*} \\\n+    %{flto} %{flto=*} %l \" LINK_PIE_SPEC \\\n    \"%X %{o*} %{e*} %{N} %{n} %{r}\\\n     %{s} %{t} %{u*} %{z} %{Z} %{!nostdlib:%{!nostartfiles:%S}}\\\n     %{static:} %{L*} %(mfwrap) %(link_libgcc) %o\\"}]}