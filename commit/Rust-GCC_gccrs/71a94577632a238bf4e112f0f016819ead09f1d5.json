{"sha": "71a94577632a238bf4e112f0f016819ead09f1d5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzFhOTQ1Nzc2MzJhMjM4YmY0ZTExMmYwZjAxNjgxOWVhZDA5ZjFkNQ==", "commit": {"author": {"name": "Zack Weinberg", "email": "zack@codesourcery.com", "date": "2001-10-12T17:24:30Z"}, "committer": {"name": "Zack Weinberg", "email": "zack@gcc.gnu.org", "date": "2001-10-12T17:24:30Z"}, "message": "ABOUT-NLS, aclocal.m4: Update i18n framework from gettext 0.10.40.\n\ntop:\n\t* ABOUT-NLS, aclocal.m4: Update i18n framework from gettext 0.10.40.\n\t* configure.in, Makefile.in: Take out obsolete check-po logic.\n\t* configure, config.in: Regenerate.\nintl:\n\t* Update entire directory from gettext 0.10.40.\n\t* cat-compat.c, linux-msg.sed, po2tbl.sed.in, xopen-msg.sed:\n\tRemoved.\n\t* config.charset, dcigettext.c, dcngettext.c, libgnuintl.h,\n\tlocalcharset.c, locale.alias, ngettext.c, plural.c, plural.y,\n\tref-add.sin, ref-del.sin: New.\npo:\n\t* Makefile.in.in: Upgrade to gettext-0.10.40.\n\t* cat-id-tbl.c: Remove file.\n\t* stamp-cat-id: Remove file.\n\nFrom-SVN: r46233", "tree": {"sha": "50c1ce8af06f53924fc1f0b12edaa4ed6cf37762", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/50c1ce8af06f53924fc1f0b12edaa4ed6cf37762"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/71a94577632a238bf4e112f0f016819ead09f1d5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/71a94577632a238bf4e112f0f016819ead09f1d5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/71a94577632a238bf4e112f0f016819ead09f1d5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/71a94577632a238bf4e112f0f016819ead09f1d5/comments", "author": null, "committer": null, "parents": [{"sha": "7e21622e0e580b065224125cc6085b9f0559293a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7e21622e0e580b065224125cc6085b9f0559293a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7e21622e0e580b065224125cc6085b9f0559293a"}], "stats": {"total": 14516, "additions": 7261, "deletions": 7255}, "files": [{"sha": "5fde45a0b5ab94b62947a0058e7fccee8423d7c1", "filename": "gcc/ABOUT-NLS", "status": "modified", "additions": 203, "deletions": 105, "changes": 308, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2FABOUT-NLS", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2FABOUT-NLS", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FABOUT-NLS?ref=71a94577632a238bf4e112f0f016819ead09f1d5", "patch": "@@ -8,7 +8,7 @@ A few packages already provide translations for their messages.\n \n    If you found this `ABOUT-NLS' file inside a distribution, you may\n assume that the distributed package does use GNU `gettext' internally,\n-itself available at your nearest GNU archive site.  But you do *not*\n+itself available at your nearest GNU archive site.  But you do _not_\n need to install GNU `gettext' prior to configuring, installing or using\n this package with messages translated.\n \n@@ -22,8 +22,8 @@ related to internationalization, you should tell about the version of\n `gettext' which is used.  The information can be found in the\n `intl/VERSION' file, in internationalized packages.\n \n-One advise in advance\n-=====================\n+Quick configuration advice\n+==========================\n \n    If you want to exploit the full power of internationalization, you\n should configure it using\n@@ -34,13 +34,14 @@ to force usage of internationalizing routines provided within this\n package, despite the existence of internationalizing capabilities in the\n operating system where this package is being installed.  So far, only\n the `gettext' implementation in the GNU C library version 2 provides as\n-many features (such as locale alias or message inheritance) as the\n-implementation here.  It is also not possible to offer this additional\n-functionality on top of a `catgets' implementation.  Future versions of\n-GNU `gettext' will very likely convey even more functionality.  So it\n-might be a good idea to change to GNU `gettext' as soon as possible.\n-\n-   So you need not provide this option if you are using GNU libc 2 or\n+many features (such as locale alias, message inheritance, automatic\n+charset conversion or plural form handling) as the implementation here.\n+It is also not possible to offer this additional functionality on top\n+of a `catgets' implementation.  Future versions of GNU `gettext' will\n+very likely convey even more functionality.  So it might be a good idea\n+to change to GNU `gettext' as soon as possible.\n+\n+   So you need _not_ provide this option if you are using GNU libc 2 or\n you have installed a recent copy of the GNU gettext package with the\n included `libintl'.\n \n@@ -53,23 +54,20 @@ Most such packages use GNU `gettext'.  Other packages have their own\n ways to internationalization, predating GNU `gettext'.\n \n    By default, this package will be installed to allow translation of\n-messages.  It will automatically detect whether the system provides\n-usable `catgets' (if using this is selected by the installer) or\n-`gettext' functions.  If neither is available, the GNU `gettext' own\n+messages.  It will automatically detect whether the system already\n+provides the GNU `gettext' functions.  If not, the GNU `gettext' own\n library will be used.  This library is wholly contained within this\n package, usually in the `intl/' subdirectory, so prior installation of\n-the GNU `gettext' package is *not* required.  Installers may use\n+the GNU `gettext' package is _not_ required.  Installers may use\n special options at configuration time for changing the default\n behaviour.  The commands:\n \n      ./configure --with-included-gettext\n-     ./configure --with-catgets\n      ./configure --disable-nls\n \n-will respectively bypass any pre-existing `catgets' or `gettext' to use\n-the internationalizing routines provided within this package, enable\n-the use of the `catgets' functions (if found on the locale system), or\n-else, *totally* disable translation of messages.\n+will respectively bypass any pre-existing `gettext' to use the\n+internationalizing routines provided within this package, or else,\n+_totally_ disable translation of messages.\n \n    When you already have GNU `gettext' installed on your system and run\n configure without an option for your new package, `configure' will\n@@ -83,18 +81,10 @@ package is more recent, you should use\n \n to prevent auto-detection.\n \n-   By default the configuration process will not test for the `catgets'\n-function and therefore they will not be used.  The reasons are already\n-given above: the emulation on top of `catgets' cannot provide all the\n-extensions provided by the GNU `gettext' library.  If you nevertheless\n-want to use the `catgets' functions use\n-\n-     ./configure --with-catgets\n-\n-to enable the test for `catgets' (this causes no harm if `catgets' is\n-not available on your system).  If you really select this option we\n-would like to hear about the reasons because we cannot think of any\n-good one ourself.\n+   The configuration process will not test for the `catgets' function\n+and therefore it will not be used.  The reason is that even an\n+emulation of `gettext' on top of `catgets' could not provide all the\n+extensions of the GNU `gettext' library.\n \n    Internationalized packages have usually many `po/LL.po' files, where\n LL gives an ISO 639 two-letter code identifying the language.  Unless\n@@ -110,56 +100,57 @@ Using This Package\n \n    As a user, if your language has been installed for this package, you\n only have to set the `LANG' environment variable to the appropriate\n-ISO 639 `LL' two-letter code prior to using the programs in the\n-package.  For example, let's suppose that you speak German.  At the\n-shell prompt, merely execute `setenv LANG de' (in `csh'),\n-`export LANG; LANG=de' (in `sh') or `export LANG=de' (in `bash').  This\n-can be done from your `.login' or `.profile' file, once and for all.\n-\n-   An operating system might already offer message localization for\n-many of its programs, while other programs have been installed locally\n-with the full capabilities of GNU `gettext'.  Just using `gettext'\n-extended syntax for `LANG' would break proper localization of already\n-available operating system programs.  In this case, users should set\n-both `LANGUAGE' and `LANG' variables in their environment, as programs\n-using GNU `gettext' give preference to `LANGUAGE'.  For example, some\n-Swedish users would rather read translations in German than English for\n-when Swedish is not available.  This is easily accomplished by setting\n-`LANGUAGE' to `sv:de' while leaving `LANG' to `sv'.\n+`LL_CC' combination.  Here `LL' is an ISO 639 two-letter language code,\n+and `CC' is an ISO 3166 two-letter country code.  For example, let's\n+suppose that you speak German and live in Germany.  At the shell\n+prompt, merely execute `setenv LANG de_DE' (in `csh'),\n+`export LANG; LANG=de_DE' (in `sh') or `export LANG=de_DE' (in `bash').\n+This can be done from your `.login' or `.profile' file, once and for\n+all.\n+\n+   You might think that the country code specification is redundant.\n+But in fact, some languages have dialects in different countries.  For\n+example, `de_AT' is used for Austria, and `pt_BR' for Brazil.  The\n+country code serves to distinguish the dialects.\n+\n+   Not all programs have translations for all languages.  By default, an\n+English message is shown in place of a nonexistent translation.  If you\n+understand other languages, you can set up a priority list of languages.\n+This is done through a different environment variable, called\n+`LANGUAGE'.  GNU `gettext' gives preference to `LANGUAGE' over `LANG'\n+for the purpose of message handling, but you still need to have `LANG'\n+set to the primary language; this is required by other parts of the\n+system libraries.  For example, some Swedish users who would rather\n+read translations in German than English for when Swedish is not\n+available, set `LANGUAGE' to `sv:de' while leaving `LANG' to `sv_SE'.\n+\n+   In the `LANGUAGE' environment variable, but not in the `LANG'\n+environment variable, `LL_CC' combinations can be abbreviated as `LL'\n+to denote the language's main dialect.  For example, `de' is equivalent\n+to `de_DE' (German as spoken in Germany), and `pt' to `pt_PT'\n+(Portuguese as spoken in Portugal) in this context.\n \n Translating Teams\n =================\n \n    For the Free Translation Project to be a success, we need interested\n people who like their own language and write it well, and who are also\n able to synergize with other translators speaking the same language.\n-Each translation team has its own mailing list, courtesy of Linux\n-International.  You may reach your translation team at the address\n-`LL@li.org', replacing LL by the two-letter ISO 639 code for your\n-language.  Language codes are *not* the same as the country codes given\n-in ISO 3166.  The following translation teams exist, as of December\n-1997:\n-\n-     Chinese `zh', Czech `cs', Danish `da', Dutch `nl', English `en',\n-     Esperanto `eo', Finnish `fi', French `fr', German `de', Hungarian\n-     `hu', Irish `ga', Italian `it', Indonesian `id', Japanese `ja',\n-     Korean `ko', Latin `la', Norwegian `no', Persian `fa', Polish\n-     `pl', Portuguese `pt', Russian `ru', Slovenian `sl', Spanish `es',\n-     Swedish `sv', and Turkish `tr'.\n-\n-For example, you may reach the Chinese translation team by writing to\n-`zh@li.org'.\n-\n-   If you'd like to volunteer to *work* at translating messages, you\n+Each translation team has its own mailing list.  The up-to-date list of\n+teams can be found at the Free Translation Project's homepage,\n+`http://www.iro.umontreal.ca/contrib/po/HTML/', in the \"National teams\"\n+area.\n+\n+   If you'd like to volunteer to _work_ at translating messages, you\n should become a member of the translating team for your own language.\n-The subscribing address is *not* the same as the list itself, it has\n+The subscribing address is _not_ the same as the list itself, it has\n `-request' appended.  For example, speakers of Swedish can send a\n message to `sv-request@li.org', having this message body:\n \n      subscribe\n \n    Keep in mind that team members are expected to participate\n-*actively* in translations, or at solving translational difficulties,\n+_actively_ in translations, or at solving translational difficulties,\n rather than merely lurking around.  If your team does not exist yet and\n you want to start one, or if you are unsure about what to do or how to\n get started, please write to `translation@iro.umontreal.ca' to reach the\n@@ -173,42 +164,128 @@ Available Packages\n ==================\n \n    Languages are not equally supported in all packages.  The following\n-matrix shows the current state of internationalization, as of December\n-1997.  The matrix shows, in regard of each package, for which languages\n-PO files have been submitted to translation coordination.\n-\n-     Ready PO files    cs da de en es fi fr it ja ko nl no pl pt ru sl sv\n-                     .----------------------------------------------------.\n-     bash            |       []          []          []                   |  3\n-     bison           |       []          []          []                   |  3\n-     clisp           |       [] [] []    []                               |  4\n-     cpio            |       []    []    []       [] []    []             |  6\n-     diffutils       |       []    []    []                []          [] |  5\n-     enscript        |       []    [] [] []          []             []    |  6\n-     fileutils       | []    []    []    []       [] []    [] []    [] [] | 10\n-     findutils       |       []    []    [] []    [] []    []    []    [] |  9\n-     flex            |             []    []       []                   [] |  4\n-     gcal            |       []          []          []    []          [] |  5\n-     gettext         |    [] []    []    []       [] [] [] [] []    [] [] | 12\n-     grep            |       []    []    []       [] [] [] []    [] [] [] | 10\n-     hello           |    [] []    []    []       [] [] [] [] []    [] [] | 11\n-     id-utils        |       []          []                []             |  3\n-     indent          |    [] []                   []       []    []       |  5\n-     libc            |       []    []    []       [] []    []          [] |  7\n-     m4              |       []          []    []    []          []    [] |  6\n-     make            |       []    []    []       [] []    []             |  6\n-     music           |                   []                []             |  2\n-     ptx             |       []    []    []          [] [] [] []       [] |  8\n-     recode          |    [] []    []    []          []    [] []    [] [] |  9\n-     sh-utils        |       []    []    []          [] [] [] []       [] |  8\n-     sharutils       | []    []    []    []          []                [] |  6\n-     tar             | []    []          [] []    [] [] [] [] []    [] [] | 11\n-     texinfo         | []    []          []                               |  3\n-     textutils       | []    []    []    []       [] [] [] []          [] |  9\n-     wdiff           | []    []    []    []          [] [] []          [] |  8\n-                     `----------------------------------------------------'\n-       17 languages    cs da de en es fi fr it ja ko nl no pl pt ru sl sv\n-       27 packages      6  4 25  1 18  1 26  2  1 12 20  9 19  7  4  7 17  179\n+matrix shows the current state of internationalization, as of September\n+2001.  The matrix shows, in regard of each package, for which languages\n+PO files have been submitted to translation coordination, with a\n+translation percentage of at least 50%.\n+\n+     Ready PO files    bg cs da de el en eo es et fi fr gl he hr id it ja\n+                     +----------------------------------------------------+\n+     a2ps            |          []             []    []                   |\n+     bash            |          []       [] []       []                   |\n+     bfd             |                                                    |\n+     binutils        |                               []                   |\n+     bison           |          []          [] []    []                [] |\n+     clisp           |          []    []    []       []                   |\n+     cpio            |       [] []          []       [] []                |\n+     diffutils       |       [] []       [] []       [] []       []       |\n+     enscript        |          []                   []                   |\n+     error           |                      []       []                   |\n+     fetchmail       |                                                    |\n+     fileutils       |    [] [] [] []       []       [] []             [] |\n+     findutils       |       [] []          [] []    [] []       [] []    |\n+     flex            |       []             []       []                   |\n+     freetype        |                                                    |\n+     gas             |                                                    |\n+     gawk            |                               []    []             |\n+     gcal            |                                                    |\n+     gcc             |                                                    |\n+     gettext         |    [] [] [] []       []       [] []       [] [] [] |\n+     gnupg           |          []       []    []    [] []          [] [] |\n+     gprof           |                                                    |\n+     grep            |    []    []       [] [] []    [] []          []    |\n+     hello           |       [] [] []    [] [] [] [] [] []          [] [] |\n+     id-utils        |       [] []                   []                   |\n+     indent          |       [] []             []    [] []                |\n+     jpilot          |                               []                   |\n+     kbd             |                                                    |\n+     ld              |                               []                   |\n+     libc            |    [] [] [] []       []       [] []             [] |\n+     lilypond        |                                                 [] |\n+     lynx            |    [] [] []                                     [] |\n+     m4              |    [] [] [] []                [] []       []    [] |\n+     make            |       [] []          []       [] []             [] |\n+     mysecretdiary   |          []                                        |\n+     nano            |                      []          []       []       |\n+     opcodes         |                                                    |\n+     parted          |          []                      []             [] |\n+     ptx             |       [] []          [] []    [] []       []       |\n+     python          |                                                    |\n+     recode          |       [] [] []    [] []       [] [] []       []    |\n+     sed             |    [] [] [] []    []    []    [] [] []    [] [] [] |\n+     sh-utils        |    [] [] [] []       [] []    [] []          [] [] |\n+     sharutils       |    [] [] [] []       []       [] []             [] |\n+     sketch          |                                                    |\n+     soundtracker    |          []          []          []                |\n+     sp              |                                                    |\n+     tar             |    [] [] []          [] []    []             [] [] |\n+     texinfo         |    [] [] []       []          []                [] |\n+     textutils       |    [] [] [] []       []       [] []             [] |\n+     util-linux      |    [] []                                           |\n+     wdiff           |       [] []             []                         |\n+     wget            |    [] [] [] []       [] []    [] [] []          [] |\n+                     +----------------------------------------------------+\n+                       bg cs da de el en eo es et fi fr gl he hr id it ja\n+                        0 14 24 32 11  1  8 23 13  1 33 22  4  0  7  9 18\n+     \n+                       ko lv nb nl nn no pl pt pt_BR ru sk sl sv tr uk zh\n+                     +----------------------------------------------------+\n+     a2ps            |          []                   []    []             |  6\n+     bash            |                                                    |  4\n+     bfd             |                                                    |  0\n+     binutils        |                                                    |  1\n+     bison           |                               []                   |  6\n+     clisp           |          []                                        |  5\n+     cpio            | []       []       []     []   []                   | 10\n+     diffutils       |                   []          []       [] []       | 11\n+     enscript        |          []              []   []                   |  5\n+     error           |                                  []       []       |  4\n+     fetchmail       |                                                    |  0\n+     fileutils       | []       []       []     []   [] [] [] [] []       | 17\n+     findutils       | []       []       []     []   []    [] [] []       | 16\n+     flex            | []                            []       []          |  6\n+     freetype        |                                                    |  0\n+     gas             |                                                    |  0\n+     gawk            |                                           []       |  3\n+     gcal            |                                                    |  0\n+     gcc             |                                                    |  0\n+     gettext         | []                []     []   []    [] [] []    [] | 18\n+     gnupg           |                   []                   [] []       | 10\n+     gprof           |                                                    |  0\n+     grep            |                   []                [] [] []       | 12\n+     hello           | [] [] [] []    [] []          [] []    [] [] []    | 22\n+     id-utils        |          []                   []       []          |  6\n+     indent          | []       []       []          [] []    [] []       | 12\n+     jpilot          |                                                    |  1\n+     kbd             |                                           []       |  1\n+     ld              |                                                    |  1\n+     libc            | []    []       [] []     []      []    [] []       | 16\n+     lilypond        |          []                            []          |  3\n+     lynx            |          []              []   []       []          |  8\n+     m4              |          []       []          []       []          | 12\n+     make            | []       []       []     []   []          []       | 12\n+     mysecretdiary   |                                                    |  1\n+     nano            |                                        []          |  4\n+     opcodes         |                                           []       |  1\n+     parted          |          []                   []                   |  5\n+     ptx             |       [] []    [] [] []       []       [] []       | 15\n+     python          |                                                    |  0\n+     recode          |                   []          []    [] []          | 13\n+     sed             |          []              []   [] [] [] [] []       | 19\n+     sh-utils        |       [] []    [] []     []   [] [] [] [] []    [] | 21\n+     sharutils       |          []                   []       []          | 11\n+     sketch          |                                                    |  0\n+     soundtracker    |                                                    |  3\n+     sp              |                                                    |  0\n+     tar             |       []       [] []     []         [] [] []       | 15\n+     texinfo         |                               []                   |  7\n+     textutils       |       [] []    [] []     []   [] [] []             | 16\n+     util-linux      |                          []               []       |  4\n+     wdiff           |                               [] []    [] []       |  7\n+     wget            |          []                   [] [] [] [] [] []    | 17\n+                     +----------------------------------------------------+\n+       33 teams        ko lv nb nl nn no pl pt pt_BR ru sk sl sv tr uk zh\n+       53 domains       9  1  6 20  0  6 17  1  13   25 10 11 23 21  2  2  387\n \n    Some counters in the preceding matrix are higher than the number of\n visible blocks let us expect.  This is because a few extra PO files are\n@@ -221,6 +298,27 @@ distributed as such by its maintainer.  There might be an observable\n lag between the mere existence a PO file and its wide availability in a\n distribution.\n \n-   If December 1997 seems to be old, you may fetch a more recent copy\n-of this `ABOUT-NLS' file on most GNU archive sites.\n+   If September 2001 seems to be old, you may fetch a more recent copy\n+of this `ABOUT-NLS' file on most GNU archive sites.  The most\n+up-to-date matrix with full percentage details can be found at\n+`http://www.iro.umontreal.ca/contrib/po/HTML/matrix.html'.\n+\n+Using `gettext' in new packages\n+===============================\n+\n+   If you are writing a freely available program and want to\n+internationalize it you are welcome to use GNU `gettext' in your\n+package.  Of course you have to respect the GNU Library General Public\n+License which covers the use of the GNU `gettext' library.  This means\n+in particular that even non-free programs can use `libintl' as a shared\n+library, whereas only free software can use `libintl' as a static\n+library or use modified versions of `libintl'.\n+\n+   Once the sources are changed appropriately and the setup can handle\n+to use of `gettext' the only thing missing are the translations.  The\n+Free Translation Project is also available for packages which are not\n+developed inside the GNU project.  Therefore the information given above\n+applies also for every other Free Software Project.  Contact\n+`translation@iro.umontreal.ca' to make the `.pot' files available to\n+the translation teams.\n "}, {"sha": "a41fa48cf841d6ea0a75a296442b131471a80a85", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=71a94577632a238bf4e112f0f016819ead09f1d5", "patch": "@@ -1,3 +1,9 @@\n+2001-10-12  Zack Weinberg  <zack@codesourcery.com>\n+\n+\t* ABOUT-NLS, aclocal.m4: Update i18n framework from gettext 0.10.40.\n+\t* configure.in, Makefile.in: Take out obsolete check-po logic.\n+\t* configure, config.in: Regenerate.\n+\n 2001-10-12  Ziemowit Laski  <zlaski@apple.com>\n \n \t* objc/objc-act.c (finish_objc): Correct precondition for emitting"}, {"sha": "018481681b379caba5497b3fafd2281ebc2b4e61", "filename": "gcc/Makefile.in", "status": "modified", "additions": 1, "deletions": 7, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FMakefile.in?ref=71a94577632a238bf4e112f0f016819ead09f1d5", "patch": "@@ -2862,7 +2862,7 @@ site.exp: ./config.status Makefile\n \t\t-e '1,/^## All variables above are.*##/ d' >> site.exp\n \t-@rm -f ./tmp?\n \n-CHECK_TARGETS = check-gcc @check_languages@ @CHECK_PO@\n+CHECK_TARGETS = check-gcc @check_languages@\n \n check-c++ : check-g++\n check-f77 : check-g77\n@@ -2930,12 +2930,6 @@ check-objc: $(TESTSUITEDIR)/site.exp\n \t    export TCL_LIBRARY ; fi ; \\\n \t$(RUNTEST) --tool objc $(RUNTESTFLAGS))\n \n-check-po:\n-\tif test -f cp/Makefile && test -f f/Makefile && \\\n-\t   test -f java/Makefile && test -f objc/Makefile; then \\\n-\t   $(MAKE) -C po check-po; \\\n-\tfi\n-\n check-consistency: testsuite/site.exp\n \t-rootme=`pwd`; export rootme; \\\n \tsrcdir=`cd ${srcdir}; pwd` ; export srcdir ; \\"}, {"sha": "b94336956fa2a3006035c7cdc863ad8461eb7b59", "filename": "gcc/aclocal.m4", "status": "modified", "additions": 517, "deletions": 408, "changes": 925, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Faclocal.m4", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Faclocal.m4", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Faclocal.m4?ref=71a94577632a238bf4e112f0f016819ead09f1d5", "patch": "@@ -420,414 +420,6 @@ fi\n AC_SUBST($1)dnl\n ])\n \n-\n-\n-# Macro to add for using GNU gettext.\n-# Ulrich Drepper <drepper@cygnus.com>, 1995.\n-#\n-# This file can be copied and used freely without restrictions.  It can\n-# be used in projects which are not available under the GNU Public License\n-# but which still want to provide support for the GNU gettext functionality.\n-# Please note that the actual code is *not* freely available.\n-\n-# serial 5\n-\n-AC_DEFUN(AM_WITH_NLS,\n-  [AC_MSG_CHECKING([whether NLS is requested])\n-    dnl Default is enabled NLS\n-    AC_ARG_ENABLE(nls,\n-      [  --disable-nls           do not use Native Language Support],\n-      USE_NLS=$enableval, USE_NLS=yes)\n-    AC_MSG_RESULT($USE_NLS)\n-    AC_SUBST(USE_NLS)\n-\n-    USE_INCLUDED_LIBINTL=no\n-\n-    dnl If we use NLS figure out what method\n-    if test \"$USE_NLS\" = \"yes\"; then\n-      AC_DEFINE(ENABLE_NLS)\n-      AC_MSG_CHECKING([whether included gettext is requested])\n-      AC_ARG_WITH(included-gettext,\n-        [  --with-included-gettext use the GNU gettext library included here],\n-        nls_cv_force_use_gnu_gettext=$withval,\n-        nls_cv_force_use_gnu_gettext=no)\n-      AC_MSG_RESULT($nls_cv_force_use_gnu_gettext)\n-\n-      nls_cv_use_gnu_gettext=\"$nls_cv_force_use_gnu_gettext\"\n-      if test \"$nls_cv_force_use_gnu_gettext\" != \"yes\"; then\n-        dnl User does not insist on using GNU NLS library.  Figure out what\n-        dnl to use.  If gettext or catgets are available (in this order) we\n-        dnl use this.  Else we have to fall back to GNU NLS library.\n-\tdnl catgets is only used if permitted by option --with-catgets.\n-\tnls_cv_header_intl=\n-\tnls_cv_header_libgt=\n-\tCATOBJEXT=NONE\n-\n-\tAC_CHECK_HEADER(libintl.h,\n-\t  [AC_CACHE_CHECK([for gettext in libc], gt_cv_func_gettext_libc,\n-\t    [AC_TRY_LINK([#include <libintl.h>], [return (int) gettext (\"\")],\n-\t       gt_cv_func_gettext_libc=yes, gt_cv_func_gettext_libc=no)])\n-\n-\t   if test \"$gt_cv_func_gettext_libc\" != \"yes\"; then\n-\t     AC_CHECK_LIB(intl, bindtextdomain,\n-\t       [AC_CACHE_CHECK([for gettext in libintl],\n-\t\t gt_cv_func_gettext_libintl,\n-\t\t [AC_CHECK_LIB(intl, gettext,\n-\t\t  gt_cv_func_gettext_libintl=yes,\n-\t\t  gt_cv_func_gettext_libintl=no)],\n-\t\t gt_cv_func_gettext_libintl=no)])\n-\t   fi\n-\n-\t   if test \"$gt_cv_func_gettext_libintl\" = \"yes\"; then\n-\t     LIBS=\"-lintl $LIBS\"\n-\t   fi\n-\n-\t   if test \"$gt_cv_func_gettext_libc\" = \"yes\" \\\n-\t      || test \"$gt_cv_func_gettext_libintl\" = \"yes\"; then\n-\t      AC_DEFINE(HAVE_GETTEXT)\n-\t      GCC_PATH_PROG_WITH_TEST(MSGFMT, msgfmt,\n-\t\t[test -z \"`$ac_dir/$ac_word -h 2>&1 | grep 'dv '`\"], no)dnl\n-\t      if test \"$MSGFMT\" != \"no\"; then\n-\t\tAC_CHECK_FUNCS(dcgettext)\n-\t\tGCC_PATH_PROG(GMSGFMT, gmsgfmt, $MSGFMT)\n-\t\tGCC_PATH_PROG_WITH_TEST(XGETTEXT, xgettext,\n-\t\t  [test -z \"`$ac_dir/$ac_word -h 2>&1 | grep '(HELP)'`\"], :)\n-\t\tAC_TRY_LINK(, [extern int _nl_msg_cat_cntr;\n-\t\t\t       return _nl_msg_cat_cntr],\n-\t\t  [CATOBJEXT=.gmo\n-\t\t   DATADIRNAME=share],\n-\t\t  [CATOBJEXT=.mo\n-\t\t   DATADIRNAME=lib])\n-\t\tINSTOBJEXT=.mo\n-\t      else\n-\t\tcreate_catalogs=\"no\"\n-\t      fi\n-\t    fi\n-\t])\n-\n-        if test \"$CATOBJEXT\" = \"NONE\"; then\n-\t  AC_MSG_CHECKING([whether catgets can be used])\n-\t  AC_ARG_WITH(catgets,\n-\t    [  --with-catgets          use catgets functions if available],\n-\t    nls_cv_use_catgets=$withval, nls_cv_use_catgets=no)\n-\t  AC_MSG_RESULT($nls_cv_use_catgets)\n-\n-\t  if test \"$nls_cv_use_catgets\" = \"yes\"; then\n-\t    dnl No gettext in C library.  Try catgets next.\n-\t    AC_CHECK_LIB(i, main)\n-\t    AC_CHECK_FUNC(catgets,\n-\t      [AC_DEFINE(HAVE_CATGETS)\n-\t       INTLOBJS=\"\\$(CATOBJS)\"\n-\t       GCC_PATH_PROG(GENCAT, gencat, no)dnl\n-\t       if test \"$GENCAT\" != \"no\"; then\n-\t\t GCC_PATH_PROG(GMSGFMT, gmsgfmt, no)\n-\t\t if test \"$GMSGFMT\" = \"no\"; then\n-\t\t   GCC_PATH_PROG_WITH_TEST(GMSGFMT, msgfmt,\n-\t\t    [test -z \"`$ac_dir/$ac_word -h 2>&1 | grep 'dv '`\"], msgfmt)\n-\t\t   if test \"$GMSGFMT\" = \"msgfmt\"; then\n-\t\t     create_catalogs=\"no\"\n-\t\t   fi\n-\t\t fi\n-\t\t GCC_PATH_PROG_WITH_TEST(XGETTEXT, xgettext,\n-\t\t   [test -z \"`$ac_dir/$ac_word -h 2>&1 | grep '(HELP)'`\"], :)\n-\t\t USE_INCLUDED_LIBINTL=yes\n-\t\t CATOBJEXT=.cat\n-\t\t INSTOBJEXT=.cat\n-\t\t DATADIRNAME=lib\n-\t\t INTLDEPS='$(top_builddir)/intl/libintl.a'\n-\t\t INTLLIBS=$INTLDEPS\n-\t\t LIBS=`echo $LIBS | sed -e 's/-lintl//'`\n-\t\t nls_cv_header_intl=intl/libintl.h\n-\t\t nls_cv_header_libgt=intl/libgettext.h\n-\t       fi])\n-\t  fi\n-        fi\n-\n-        if test \"$CATOBJEXT\" = \"NONE\"; then\n-\t  dnl Neither gettext nor catgets in included in the C library.\n-\t  dnl Fall back on GNU gettext library.\n-\t  nls_cv_use_gnu_gettext=yes\n-        fi\n-      fi\n-\n-      if test \"$nls_cv_use_gnu_gettext\" = \"yes\"; then\n-        dnl Mark actions used to generate GNU NLS library.\n-        INTLOBJS=\"\\$(GETTOBJS)\"\n-        GCC_PATH_PROG_WITH_TEST(MSGFMT, msgfmt,\n-\t  [test -z \"`$ac_dir/$ac_word -h 2>&1 | grep 'dv '`\"], msgfmt)\n-        GCC_PATH_PROG(GMSGFMT, gmsgfmt, $MSGFMT)\n-        dnl If we didn't find either msgfmt or gmsgfmt, don't try to\n-        dnl create a catalog.\n-\tif test \"$MSGFMT\" = \"msgfmt\" && test \"$GMSGFMT\" = \"msgfmt\"; then\n-\t  create_catalogs=\"no\"\n-\tfi\n-        GCC_PATH_PROG_WITH_TEST(XGETTEXT, xgettext,\n-\t  [test -z \"`$ac_dir/$ac_word -h 2>&1 | grep '(HELP)'`\"], :)\n-        AC_SUBST(MSGFMT)\n-\tUSE_INCLUDED_LIBINTL=yes\n-        CATOBJEXT=.gmo\n-        INSTOBJEXT=.mo\n-        DATADIRNAME=share\n-\tINTLDEPS='$(top_builddir)/intl/libintl.a'\n-\tINTLLIBS=$INTLDEPS\n-\tLIBS=`echo $LIBS | sed -e 's/-lintl//'`\n-        nls_cv_header_intl=intl/libintl.h\n-        nls_cv_header_libgt=intl/libgettext.h\n-      fi\n-\n-      dnl Test whether we really found GNU xgettext.\n-      if test \"$XGETTEXT\" != \":\"; then\n-\tdnl If it is no GNU xgettext we define it as : so that the\n-\tdnl Makefiles still can work.\n-\tif $XGETTEXT --omit-header /dev/null 2> /dev/null; then\n-\t  : ;\n-\telse\n-\t  AC_MSG_RESULT(\n-\t    [found xgettext program is not GNU xgettext; ignore it])\n-\t  XGETTEXT=\":\"\n-\tfi\n-      fi\n-\n-\n-\n-      # We need to process the po/ directory.\n-      POSUB=po\n-    else\n-      DATADIRNAME=share\n-      nls_cv_header_intl=intl/libintl.h\n-      nls_cv_header_libgt=intl/libgettext.h\n-    fi\n-    AC_LINK_FILES($nls_cv_header_libgt, $nls_cv_header_intl)\n-    AC_OUTPUT_COMMANDS(\n-     [case \"$CONFIG_FILES\" in *po/Makefile.in*)\n-        sed -e \"/POTFILES =/r po/POTFILES\" po/Makefile.in > po/Makefile\n-      esac])\n-\n-\n-    # If this is used in GNU gettext we have to set USE_NLS to `yes'\n-    # because some of the sources are only built for this goal.\n-    if test \"$PACKAGE\" = gettext; then\n-      USE_NLS=yes\n-      USE_INCLUDED_LIBINTL=yes\n-    fi\n-\n-    dnl These rules are solely for the distribution goal.  While doing this\n-    dnl we only have to keep exactly one list of the available catalogs\n-    dnl in configure.in.\n-    for lang in $ALL_LINGUAS; do\n-      GMOFILES=\"$GMOFILES $lang.gmo\"\n-      POFILES=\"$POFILES $lang.po\"\n-    done\n-\n-    dnl Make all variables we use known to autoconf.\n-    AC_SUBST(USE_INCLUDED_LIBINTL)\n-    AC_SUBST(CATALOGS)\n-    AC_SUBST(CATOBJEXT)\n-    AC_SUBST(DATADIRNAME)\n-    AC_SUBST(GMOFILES)\n-    AC_SUBST(INSTOBJEXT)\n-    AC_SUBST(INTLDEPS)\n-    AC_SUBST(INTLLIBS)\n-    AC_SUBST(INTLOBJS)\n-    AC_SUBST(POFILES)\n-    AC_SUBST(POSUB)\n-  ])\n-\n-AC_DEFUN(AM_GNU_GETTEXT,\n-  [AC_REQUIRE([AC_PROG_MAKE_SET])dnl\n-   AC_REQUIRE([AC_PROG_CC])dnl\n-   AC_REQUIRE([AC_PROG_RANLIB])dnl\n-   AC_REQUIRE([AC_ISC_POSIX])dnl\n-   AC_REQUIRE([AC_HEADER_STDC])dnl\n-   AC_REQUIRE([AC_C_CONST])dnl\n-   AC_REQUIRE([AC_C_INLINE])dnl\n-   AC_REQUIRE([AC_TYPE_OFF_T])dnl\n-   AC_REQUIRE([AC_TYPE_SIZE_T])dnl\n-\n-   AC_CHECK_HEADERS([argz.h limits.h locale.h nl_types.h malloc.h string.h \\\n-unistd.h sys/param.h])\n-   AC_CHECK_FUNCS([getcwd munmap putenv setenv setlocale strchr strcasecmp \\\n-strdup __argz_count __argz_stringify __argz_next])\n-\n-   if test \"${ac_cv_func_stpcpy+set}\" != \"set\"; then\n-     AC_CHECK_FUNCS(stpcpy)\n-   fi\n-   if test \"${ac_cv_func_stpcpy}\" = \"yes\"; then\n-     AC_DEFINE(HAVE_STPCPY)\n-   fi\n-\n-   AM_LC_MESSAGES\n-   AM_WITH_NLS\n-\n-   if test \"x$create_catalogs\" = \"xno\"; then\n-     AC_MSG_WARN([No program for building catalogs found -> building disabled])\n-   fi\n-\n-   if test \"x$CATOBJEXT\" != \"x\" && test \"x$create_catalogs\" != \"xno\" ; then\n-     if test \"x$ALL_LINGUAS\" = \"x\"; then\n-       LINGUAS=\n-     else\n-       AC_MSG_CHECKING(for catalogs to be installed)\n-       if test \"x$LINGUAS\" = \"x\"; then\n-\t LINGUAS=$ALL_LINGUAS\n-       else\n-\t NEW_LINGUAS=\n-\t for lang in $ALL_LINGUAS; do\n-\t   case \" $LINGUAS \" in\n-\t     *\" $lang \"*) NEW_LINGUAS=\"$NEW_LINGUAS $lang\" ;;\n-\t   esac\n-\t done\n-         LINGUAS=$NEW_LINGUAS\n-       fi\n-       AC_MSG_RESULT($LINGUAS)\n-     fi\n-\n-     dnl Construct list of names of catalog files to be constructed.\n-     if test -n \"$LINGUAS\"; then\n-       for lang in $LINGUAS; do CATALOGS=\"$CATALOGS $lang$CATOBJEXT\"; done\n-     fi\n-   fi\n-\n-   dnl The reference to <locale.h> in the installed <libintl.h> file\n-   dnl must be resolved because we cannot expect the users of this\n-   dnl to define HAVE_LOCALE_H.\n-   if test $ac_cv_header_locale_h = yes; then\n-     INCLUDE_LOCALE_H=\"#include <locale.h>\"\n-   else\n-     INCLUDE_LOCALE_H=\"\\\n-/* The system does not provide the header <locale.h>.  Take care yourself.  */\"\n-   fi\n-   AC_SUBST(INCLUDE_LOCALE_H)\n-\n-   dnl Determine which catalog format we have (if any is needed)\n-   dnl For now we know about two different formats:\n-   dnl   Linux libc-5 and the normal X/Open format\n-   test -d intl || mkdir intl\n-   if test \"$CATOBJEXT\" = \".cat\"; then\n-     AC_CHECK_HEADER(linux/version.h, msgformat=linux, msgformat=xopen)\n-\n-     dnl Transform the SED scripts while copying because some dumb SEDs\n-     dnl cannot handle comments.\n-     sed -e '/^#/d' $srcdir/intl/$msgformat-msg.sed > intl/po2msg.sed\n-   fi\n-   dnl po2tbl.sed is always needed.\n-   sed -e '/^#.*[^\\\\]$/d' -e '/^#$/d' \\\n-     $srcdir/intl/po2tbl.sed.in > intl/po2tbl.sed\n-\n-   dnl In the intl/Makefile.in we have a special dependency which makes\n-   dnl only sense for gettext.  We comment this out for non-gettext\n-   dnl packages.\n-   if test \"$PACKAGE\" = \"gettext\"; then\n-     GT_NO=\"#NO#\"\n-     GT_YES=\n-   else\n-     GT_NO=\n-     GT_YES=\"#YES#\"\n-   fi\n-   AC_SUBST(GT_NO)\n-   AC_SUBST(GT_YES)\n-\n-   dnl If the AC_CONFIG_AUX_DIR macro for autoconf is used we possibly\n-   dnl find the mkinstalldirs script in another subdir but ($top_srcdir).\n-   dnl Try to locate is.\n-   MKINSTALLDIRS=\n-   if test -n \"$ac_aux_dir\"; then\n-     MKINSTALLDIRS=\"$ac_aux_dir/mkinstalldirs\"\n-   fi\n-   if test -z \"$MKINSTALLDIRS\"; then\n-     MKINSTALLDIRS=\"\\$(top_srcdir)/mkinstalldirs\"\n-   fi\n-   AC_SUBST(MKINSTALLDIRS)\n-\n-   dnl *** For now the libtool support in intl/Makefile is not for real.\n-   l=\n-   AC_SUBST(l)\n-\n-   dnl Generate list of files to be processed by xgettext which will\n-   dnl be included in po/Makefile.\n-   test -d po || mkdir po\n-   if test \"x$srcdir\" != \"x.\"; then\n-     if test \"x`echo $srcdir | sed 's@/.*@@'`\" = \"x\"; then\n-       posrcprefix=\"$srcdir/\"\n-     else\n-       posrcprefix=\"../$srcdir/\"\n-     fi\n-   else\n-     posrcprefix=\"../\"\n-   fi\n-   rm -f po/POTFILES\n-   sed -e \"/^#/d\" -e \"/^\\$/d\" -e \"s,.*,\t$posrcprefix& \\\\\\\\,\" -e \"\\$s/\\(.*\\) \\\\\\\\/\\1/\" \\\n-\t< $srcdir/po/POTFILES.in > po/POTFILES\n-  ])\n-\n-# Check whether LC_MESSAGES is available in <locale.h>.\n-# Ulrich Drepper <drepper@cygnus.com>, 1995.\n-#\n-# This file can be copied and used freely without restrictions.  It can\n-# be used in projects which are not available under the GNU Public License\n-# but which still want to provide support for the GNU gettext functionality.\n-# Please note that the actual code is *not* freely available.\n-\n-# serial 1\n-\n-AC_DEFUN(AM_LC_MESSAGES,\n-  [if test $ac_cv_header_locale_h = yes; then\n-    AC_CACHE_CHECK([for LC_MESSAGES], am_cv_val_LC_MESSAGES,\n-      [AC_TRY_LINK([#include <locale.h>], [return LC_MESSAGES],\n-       am_cv_val_LC_MESSAGES=yes, am_cv_val_LC_MESSAGES=no)])\n-    if test $am_cv_val_LC_MESSAGES = yes; then\n-      AC_DEFINE(HAVE_LC_MESSAGES)\n-    fi\n-  fi])\n-\n-# Search path for a program which passes the given test.\n-# Ulrich Drepper <drepper@cygnus.com>, 1996.\n-#\n-# This file can be copied and used freely without restrictions.  It can\n-# be used in projects which are not available under the GNU Public License\n-# but which still want to provide support for the GNU gettext functionality.\n-# Please note that the actual code is *not* freely available.\n-\n-# serial 1\n-\n-dnl GCC_PATH_PROG_WITH_TEST(VARIABLE, PROG-TO-CHECK-FOR,\n-dnl   TEST-PERFORMED-ON-FOUND_PROGRAM [, VALUE-IF-NOT-FOUND [, PATH]])\n-AC_DEFUN(GCC_PATH_PROG_WITH_TEST,\n-[# Extract the first word of \"$2\", so it can be a program name with args.\n-set dummy $2; ac_word=[$]2\n-AC_MSG_CHECKING([for $ac_word])\n-AC_CACHE_VAL(gcc_cv_path_$1,\n-[case \"[$]$1\" in\n-  /*)\n-  gcc_cv_path_$1=\"[$]$1\" # Let the user override the test with a path.\n-  ;;\n-  *)\n-  IFS=\"${IFS= \t}\"; ac_save_ifs=\"$IFS\"; IFS=\"${IFS}:\"\n-  for ac_dir in ifelse([$5], , $PATH, [$5]); do\n-    test -z \"$ac_dir\" && ac_dir=.\n-    if test -f $ac_dir/$ac_word; then\n-      if [$3]; then\n-\tgcc_cv_path_$1=\"$ac_dir/$ac_word\"\n-\tbreak\n-      fi\n-    fi\n-  done\n-  IFS=\"$ac_save_ifs\"\n-dnl If no 4th arg is given, leave the cache variable unset,\n-dnl so GCC_PATH_PROGS will keep looking.\n-ifelse([$4], , , [  test -z \"[$]gcc_cv_path_$1\" && gcc_cv_path_$1=\"$4\"\n-])dnl\n-  ;;\n-esac])dnl\n-$1=\"$gcc_cv_path_$1\"\n-if test -n \"[$]$1\"; then\n-  AC_MSG_RESULT([$]$1)\n-else\n-  AC_MSG_RESULT(no)\n-fi\n-AC_SUBST($1)dnl\n-])\n-\n # Check whether mmap can map an arbitrary page from /dev/zero or with\n # MAP_ANONYMOUS, without MAP_FIXED.\n AC_DEFUN([AC_FUNC_MMAP_ANYWHERE],\n@@ -1590,3 +1182,520 @@ size_t iconv();\n   fi\n   AC_SUBST(LIBICONV)\n ])\n+\n+### Gettext macros begin here.\n+### Changes for GCC marked by 'dnl GCC LOCAL'.\n+### Note iconv.m4 appears above, as it's used for other reasons.\n+\n+#serial AM1\n+\n+dnl From Bruno Haible.\n+\n+AC_DEFUN([AM_LANGINFO_CODESET],\n+[\n+  AC_CACHE_CHECK([for nl_langinfo and CODESET], am_cv_langinfo_codeset,\n+    [AC_TRY_LINK([#include <langinfo.h>],\n+      [char* cs = nl_langinfo(CODESET);],\n+      am_cv_langinfo_codeset=yes,\n+      am_cv_langinfo_codeset=no)\n+    ])\n+  if test $am_cv_langinfo_codeset = yes; then\n+    AC_DEFINE(HAVE_LANGINFO_CODESET, 1,\n+      [Define if you have <langinfo.h> and nl_langinfo(CODESET).])\n+  fi\n+])\n+\n+#serial 1\n+# This test replaces the one in autoconf.\n+# Currently this macro should have the same name as the autoconf macro\n+# because gettext's gettext.m4 (distributed in the automake package)\n+# still uses it.  Otherwise, the use in gettext.m4 makes autoheader\n+# give these diagnostics:\n+#   configure.in:556: AC_TRY_COMPILE was called before AC_ISC_POSIX\n+#   configure.in:556: AC_TRY_RUN was called before AC_ISC_POSIX\n+\n+undefine([AC_ISC_POSIX])\n+\n+AC_DEFUN([AC_ISC_POSIX],\n+  [\n+    dnl This test replaces the obsolescent AC_ISC_POSIX kludge.\n+    dnl GCC LOCAL: Use AC_SEARCH_LIBS.\n+    AC_SEARCH_LIBS(strerror, cposix)\n+  ]\n+)\n+\n+#serial 2\n+\n+# Test for the GNU C Library, version 2.1 or newer.\n+# From Bruno Haible.\n+\n+AC_DEFUN([jm_GLIBC21],\n+  [\n+    AC_CACHE_CHECK(whether we are using the GNU C Library 2.1 or newer,\n+      ac_cv_gnu_library_2_1,\n+      [AC_EGREP_CPP([Lucky GNU user],\n+\t[\n+#include <features.h>\n+#ifdef __GNU_LIBRARY__\n+ #if (__GLIBC__ == 2 && __GLIBC_MINOR__ >= 1) || (__GLIBC__ > 2)\n+  Lucky GNU user\n+ #endif\n+#endif\n+\t],\n+\tac_cv_gnu_library_2_1=yes,\n+\tac_cv_gnu_library_2_1=no)\n+      ]\n+    )\n+    AC_SUBST(GLIBC21)\n+    GLIBC21=\"$ac_cv_gnu_library_2_1\"\n+  ]\n+)\n+\n+# Check whether LC_MESSAGES is available in <locale.h>.\n+# Ulrich Drepper <drepper@cygnus.com>, 1995.\n+#\n+# This file can be copied and used freely without restrictions.  It can\n+# be used in projects which are not available under the GNU General Public\n+# License or the GNU Library General Public License but which still want\n+# to provide support for the GNU gettext functionality.\n+# Please note that the actual code of the GNU gettext library is covered\n+# by the GNU Library General Public License, and the rest of the GNU\n+# gettext package package is covered by the GNU General Public License.\n+# They are *not* in the public domain.\n+\n+# serial 2\n+\n+AC_DEFUN([AM_LC_MESSAGES],\n+  [if test $ac_cv_header_locale_h = yes; then\n+    AC_CACHE_CHECK([for LC_MESSAGES], am_cv_val_LC_MESSAGES,\n+      [AC_TRY_LINK([#include <locale.h>], [return LC_MESSAGES],\n+       am_cv_val_LC_MESSAGES=yes, am_cv_val_LC_MESSAGES=no)])\n+    if test $am_cv_val_LC_MESSAGES = yes; then\n+      AC_DEFINE(HAVE_LC_MESSAGES, 1,\n+        [Define if your <locale.h> file defines LC_MESSAGES.])\n+    fi\n+  fi])\n+\n+# Search path for a program which passes the given test.\n+# Ulrich Drepper <drepper@cygnus.com>, 1996.\n+#\n+# This file can be copied and used freely without restrictions.  It can\n+# be used in projects which are not available under the GNU General Public\n+# License or the GNU Library General Public License but which still want\n+# to provide support for the GNU gettext functionality.\n+# Please note that the actual code of the GNU gettext library is covered\n+# by the GNU Library General Public License, and the rest of the GNU\n+# gettext package package is covered by the GNU General Public License.\n+# They are *not* in the public domain.\n+\n+# serial 2\n+\n+dnl AM_PATH_PROG_WITH_TEST(VARIABLE, PROG-TO-CHECK-FOR,\n+dnl   TEST-PERFORMED-ON-FOUND_PROGRAM [, VALUE-IF-NOT-FOUND [, PATH]])\n+AC_DEFUN([AM_PATH_PROG_WITH_TEST],\n+[# Extract the first word of \"$2\", so it can be a program name with args.\n+set dummy $2; ac_word=[$]2\n+AC_MSG_CHECKING([for $ac_word])\n+AC_CACHE_VAL(ac_cv_path_$1,\n+[case \"[$]$1\" in\n+  /*)\n+  ac_cv_path_$1=\"[$]$1\" # Let the user override the test with a path.\n+  ;;\n+  *)\n+  IFS=\"${IFS= \t}\"; ac_save_ifs=\"$IFS\"; IFS=\"${IFS}:\"\n+  for ac_dir in ifelse([$5], , $PATH, [$5]); do\n+    test -z \"$ac_dir\" && ac_dir=.\n+    if test -f $ac_dir/$ac_word; then\n+      if [$3]; then\n+\tac_cv_path_$1=\"$ac_dir/$ac_word\"\n+\tbreak\n+      fi\n+    fi\n+  done\n+  IFS=\"$ac_save_ifs\"\n+dnl If no 4th arg is given, leave the cache variable unset,\n+dnl so AC_PATH_PROGS will keep looking.\n+ifelse([$4], , , [  test -z \"[$]ac_cv_path_$1\" && ac_cv_path_$1=\"$4\"\n+])dnl\n+  ;;\n+esac])dnl\n+$1=\"$ac_cv_path_$1\"\n+if test ifelse([$4], , [-n \"[$]$1\"], [\"[$]$1\" != \"$4\"]); then\n+  AC_MSG_RESULT([$]$1)\n+else\n+  AC_MSG_RESULT(no)\n+fi\n+AC_SUBST($1)dnl\n+])\n+\n+# Macro to add for using GNU gettext.\n+# Ulrich Drepper <drepper@cygnus.com>, 1995.\n+#\n+# This file can be copied and used freely without restrictions.  It can\n+# be used in projects which are not available under the GNU General Public\n+# License or the GNU Library General Public License but which still want\n+# to provide support for the GNU gettext functionality.\n+# Please note that the actual code of the GNU gettext library is covered\n+# by the GNU Library General Public License, and the rest of the GNU\n+# gettext package package is covered by the GNU General Public License.\n+# They are *not* in the public domain.\n+\n+# serial 10\n+\n+dnl Usage: AM_WITH_NLS([TOOLSYMBOL], [NEEDSYMBOL], [LIBDIR]).\n+dnl If TOOLSYMBOL is specified and is 'use-libtool', then a libtool library\n+dnl    $(top_builddir)/intl/libintl.la will be created (shared and/or static,\n+dnl    depending on --{enable,disable}-{shared,static} and on the presence of\n+dnl    AM-DISABLE-SHARED). Otherwise, a static library\n+dnl    $(top_builddir)/intl/libintl.a will be created.\n+dnl If NEEDSYMBOL is specified and is 'need-ngettext', then GNU gettext\n+dnl    implementations (in libc or libintl) without the ngettext() function\n+dnl    will be ignored.\n+dnl LIBDIR is used to find the intl libraries.  If empty,\n+dnl    the value `$(top_builddir)/intl/' is used.\n+dnl\n+dnl The result of the configuration is one of three cases:\n+dnl 1) GNU gettext, as included in the intl subdirectory, will be compiled\n+dnl    and used.\n+dnl    Catalog format: GNU --> install in $(datadir)\n+dnl    Catalog extension: .mo after installation, .gmo in source tree\n+dnl 2) GNU gettext has been found in the system's C library.\n+dnl    Catalog format: GNU --> install in $(datadir)\n+dnl    Catalog extension: .mo after installation, .gmo in source tree\n+dnl 3) No internationalization, always use English msgid.\n+dnl    Catalog format: none\n+dnl    Catalog extension: none\n+dnl The use of .gmo is historical (it was needed to avoid overwriting the\n+dnl GNU format catalogs when building on a platform with an X/Open gettext),\n+dnl but we keep it in order not to force irrelevant filename changes on the\n+dnl maintainers.\n+dnl\n+AC_DEFUN([AM_WITH_NLS],\n+  [AC_MSG_CHECKING([whether NLS is requested])\n+    dnl Default is enabled NLS\n+    AC_ARG_ENABLE(nls,\n+      [  --disable-nls           do not use Native Language Support],\n+      USE_NLS=$enableval, USE_NLS=yes)\n+    AC_MSG_RESULT($USE_NLS)\n+    AC_SUBST(USE_NLS)\n+\n+    BUILD_INCLUDED_LIBINTL=no\n+    USE_INCLUDED_LIBINTL=no\n+    INTLLIBS=\n+\n+    dnl If we use NLS figure out what method\n+    if test \"$USE_NLS\" = \"yes\"; then\n+      AC_DEFINE(ENABLE_NLS, 1,\n+        [Define to 1 if translation of program messages to the user's native language\n+   is requested.])\n+      AC_MSG_CHECKING([whether included gettext is requested])\n+      AC_ARG_WITH(included-gettext,\n+        [  --with-included-gettext use the GNU gettext library included here],\n+        nls_cv_force_use_gnu_gettext=$withval,\n+        nls_cv_force_use_gnu_gettext=no)\n+      AC_MSG_RESULT($nls_cv_force_use_gnu_gettext)\n+\n+      nls_cv_use_gnu_gettext=\"$nls_cv_force_use_gnu_gettext\"\n+      if test \"$nls_cv_force_use_gnu_gettext\" != \"yes\"; then\n+        dnl User does not insist on using GNU NLS library.  Figure out what\n+        dnl to use.  If GNU gettext is available we use this.  Else we have\n+        dnl to fall back to GNU NLS library.\n+\tCATOBJEXT=NONE\n+\n+        dnl Add a version number to the cache macros.\n+        define(gt_cv_func_gnugettext_libc, [gt_cv_func_gnugettext]ifelse([$2], need-ngettext, 2, 1)[_libc])\n+        define(gt_cv_func_gnugettext_libintl, [gt_cv_func_gnugettext]ifelse([$2], need-ngettext, 2, 1)[_libintl])\n+\n+\tAC_CHECK_HEADER(libintl.h,\n+\t  [AC_CACHE_CHECK([for GNU gettext in libc], gt_cv_func_gnugettext_libc,\n+\t    [AC_TRY_LINK([#include <libintl.h>\n+extern int _nl_msg_cat_cntr;],\n+\t       [bindtextdomain (\"\", \"\");\n+return (int) gettext (\"\")]ifelse([$2], need-ngettext, [ + (int) ngettext (\"\", \"\", 0)], [])[ + _nl_msg_cat_cntr],\n+\t       gt_cv_func_gnugettext_libc=yes,\n+\t       gt_cv_func_gnugettext_libc=no)])\n+\n+\t   if test \"$gt_cv_func_gnugettext_libc\" != \"yes\"; then\n+\t     AC_CACHE_CHECK([for GNU gettext in libintl],\n+\t       gt_cv_func_gnugettext_libintl,\n+\t       [gt_save_LIBS=\"$LIBS\"\n+\t\tLIBS=\"$LIBS -lintl $LIBICONV\"\n+\t\tAC_TRY_LINK([#include <libintl.h>\n+extern int _nl_msg_cat_cntr;],\n+\t\t  [bindtextdomain (\"\", \"\");\n+return (int) gettext (\"\")]ifelse([$2], need-ngettext, [ + (int) ngettext (\"\", \"\", 0)], [])[ + _nl_msg_cat_cntr],\n+\t\t  gt_cv_func_gnugettext_libintl=yes,\n+\t\t  gt_cv_func_gnugettext_libintl=no)\n+\t\tLIBS=\"$gt_save_LIBS\"])\n+\t   fi\n+\n+\t   dnl If an already present or preinstalled GNU gettext() is found,\n+\t   dnl use it.  But if this macro is used in GNU gettext, and GNU\n+\t   dnl gettext is already preinstalled in libintl, we update this\n+\t   dnl libintl.  (Cf. the install rule in intl/Makefile.in.)\n+\t   if test \"$gt_cv_func_gnugettext_libc\" = \"yes\" \\\n+\t      || { test \"$gt_cv_func_gnugettext_libintl\" = \"yes\" \\\n+\t\t   && test \"$PACKAGE\" != gettext; }; then\n+\t     AC_DEFINE(HAVE_GETTEXT, 1,\n+               [Define if the GNU gettext() function is already present or preinstalled.])\n+\n+\t     if test \"$gt_cv_func_gnugettext_libintl\" = \"yes\"; then\n+\t       dnl If iconv() is in a separate libiconv library, then anyone\n+\t       dnl linking with libintl{.a,.so} also needs to link with\n+\t       dnl libiconv.\n+\t       INTLLIBS=\"-lintl $LIBICONV\"\n+\t     fi\n+\n+\t     gt_save_LIBS=\"$LIBS\"\n+\t     LIBS=\"$LIBS $INTLLIBS\"\n+\t     AC_CHECK_FUNCS(dcgettext)\n+\t     LIBS=\"$gt_save_LIBS\"\n+\n+\t     dnl Search for GNU msgfmt in the PATH.\n+\t     AM_PATH_PROG_WITH_TEST(MSGFMT, msgfmt,\n+\t       [$ac_dir/$ac_word --statistics /dev/null >/dev/null 2>&1], :)\n+\t     AC_PATH_PROG(GMSGFMT, gmsgfmt, $MSGFMT)\n+\n+\t     dnl Search for GNU xgettext in the PATH.\n+\t     AM_PATH_PROG_WITH_TEST(XGETTEXT, xgettext,\n+\t       [$ac_dir/$ac_word --omit-header /dev/null >/dev/null 2>&1], :)\n+\n+\t     CATOBJEXT=.gmo\n+\t   fi\n+\t])\n+\n+        if test \"$CATOBJEXT\" = \"NONE\"; then\n+\t  dnl GNU gettext is not found in the C library.\n+\t  dnl Fall back on GNU gettext library.\n+\t  nls_cv_use_gnu_gettext=yes\n+        fi\n+      fi\n+\n+      if test \"$nls_cv_use_gnu_gettext\" = \"yes\"; then\n+        dnl Mark actions used to generate GNU NLS library.\n+        INTLOBJS=\"\\$(GETTOBJS)\"\n+        AM_PATH_PROG_WITH_TEST(MSGFMT, msgfmt,\n+\t  [$ac_dir/$ac_word --statistics /dev/null >/dev/null 2>&1], :)\n+        AC_PATH_PROG(GMSGFMT, gmsgfmt, $MSGFMT)\n+        AM_PATH_PROG_WITH_TEST(XGETTEXT, xgettext,\n+\t  [$ac_dir/$ac_word --omit-header /dev/null >/dev/null 2>&1], :)\n+        AC_SUBST(MSGFMT)\n+\tBUILD_INCLUDED_LIBINTL=yes\n+\tUSE_INCLUDED_LIBINTL=yes\n+        CATOBJEXT=.gmo\n+\tINTLLIBS=\"ifelse([$3],[],\\$(top_builddir)/intl,[$3])/libintl.ifelse([$1], use-libtool, [l], [])a $LIBICONV\"\n+\tLIBS=`echo \" $LIBS \" | sed -e 's/ -lintl / /' -e 's/^ //' -e 's/ $//'`\n+      fi\n+\n+      dnl This could go away some day; the PATH_PROG_WITH_TEST already does it.\n+      dnl Test whether we really found GNU msgfmt.\n+      if test \"$GMSGFMT\" != \":\"; then\n+\tdnl If it is no GNU msgfmt we define it as : so that the\n+\tdnl Makefiles still can work.\n+\tif $GMSGFMT --statistics /dev/null >/dev/null 2>&1; then\n+\t  : ;\n+\telse\n+\t  AC_MSG_RESULT(\n+\t    [found msgfmt program is not GNU msgfmt; ignore it])\n+\t  GMSGFMT=\":\"\n+\tfi\n+      fi\n+\n+      dnl This could go away some day; the PATH_PROG_WITH_TEST already does it.\n+      dnl Test whether we really found GNU xgettext.\n+      if test \"$XGETTEXT\" != \":\"; then\n+\tdnl If it is no GNU xgettext we define it as : so that the\n+\tdnl Makefiles still can work.\n+\tif $XGETTEXT --omit-header /dev/null >/dev/null 2>&1; then\n+\t  : ;\n+\telse\n+\t  AC_MSG_RESULT(\n+\t    [found xgettext program is not GNU xgettext; ignore it])\n+\t  XGETTEXT=\":\"\n+\tfi\n+      fi\n+\n+      dnl We need to process the po/ directory.\n+      POSUB=po\n+    fi\n+    AC_OUTPUT_COMMANDS(\n+     [for ac_file in $CONFIG_FILES; do\n+        # Support \"outfile[:infile[:infile...]]\"\n+        case \"$ac_file\" in\n+          *:*) ac_file=`echo \"$ac_file\"|sed 's%:.*%%'` ;;\n+        esac\n+        # PO directories have a Makefile.in generated from Makefile.in.in.\n+        case \"$ac_file\" in */Makefile.in)\n+          # Adjust a relative srcdir.\n+          ac_dir=`echo \"$ac_file\"|sed 's%/[^/][^/]*$%%'`\n+          ac_dir_suffix=\"/`echo \"$ac_dir\"|sed 's%^\\./%%'`\"\n+          ac_dots=`echo \"$ac_dir_suffix\"|sed 's%/[^/]*%../%g'`\n+          # In autoconf-2.13 it is called $ac_given_srcdir.\n+          # In autoconf-2.50 it is called $srcdir.\n+          test -n \"$ac_given_srcdir\" || ac_given_srcdir=\"$srcdir\"\n+          case \"$ac_given_srcdir\" in\n+            .)  top_srcdir=`echo $ac_dots|sed 's%/$%%'` ;;\n+            /*) top_srcdir=\"$ac_given_srcdir\" ;;\n+            *)  top_srcdir=\"$ac_dots$ac_given_srcdir\" ;;\n+          esac\n+          if test -f \"$ac_given_srcdir/$ac_dir/POTFILES.in\"; then\n+            rm -f \"$ac_dir/POTFILES\"\n+            test -n \"$as_me\" && echo \"$as_me: creating $ac_dir/POTFILES\" || echo \"creating $ac_dir/POTFILES\"\n+            sed -e \"/^#/d\" -e \"/^[ \t]*\\$/d\" -e \"s,.*,     $top_srcdir/& \\\\\\\\,\" -e \"\\$s/\\(.*\\) \\\\\\\\/\\1/\" < \"$ac_given_srcdir/$ac_dir/POTFILES.in\" > \"$ac_dir/POTFILES\"\n+            test -n \"$as_me\" && echo \"$as_me: creating $ac_dir/Makefile\" || echo \"creating $ac_dir/Makefile\"\n+            sed -e \"/POTFILES =/r $ac_dir/POTFILES\" \"$ac_dir/Makefile.in\" > \"$ac_dir/Makefile\"\n+          fi\n+          ;;\n+        esac\n+      done])\n+\n+\n+    dnl If this is used in GNU gettext we have to set BUILD_INCLUDED_LIBINTL\n+    dnl to 'yes' because some of the testsuite requires it.\n+    if test \"$PACKAGE\" = gettext; then\n+      BUILD_INCLUDED_LIBINTL=yes\n+    fi\n+\n+    dnl intl/plural.c is generated from intl/plural.y. It requires bison,\n+    dnl because plural.y uses bison specific features. It requires at least\n+    dnl bison-1.26 because earlier versions generate a plural.c that doesn't\n+    dnl compile.\n+    dnl bison is only needed for the maintainer (who touches plural.y). But in\n+    dnl order to avoid separate Makefiles or --enable-maintainer-mode, we put\n+    dnl the rule in general Makefile. Now, some people carelessly touch the\n+    dnl files or have a broken \"make\" program, hence the plural.c rule will\n+    dnl sometimes fire. To avoid an error, defines BISON to \":\" if it is not\n+    dnl present or too old.\n+    AC_CHECK_PROGS([INTLBISON], [bison])\n+    if test -z \"$INTLBISON\"; then\n+      ac_verc_fail=yes\n+    else\n+      dnl Found it, now check the version.\n+      AC_MSG_CHECKING([version of bison])\n+changequote(<<,>>)dnl\n+      ac_prog_version=`$INTLBISON --version 2>&1 | sed -n 's/^.*GNU Bison.* \\([0-9]*\\.[0-9.]*\\).*$/\\1/p'`\n+      case $ac_prog_version in\n+        '') ac_prog_version=\"v. ?.??, bad\"; ac_verc_fail=yes;;\n+        1.2[6-9]* | 1.[3-9][0-9]* | [2-9].*)\n+changequote([,])dnl\n+           ac_prog_version=\"$ac_prog_version, ok\"; ac_verc_fail=no;;\n+        *) ac_prog_version=\"$ac_prog_version, bad\"; ac_verc_fail=yes;;\n+      esac\n+      AC_MSG_RESULT([$ac_prog_version])\n+    fi\n+    if test $ac_verc_fail = yes; then\n+      INTLBISON=:\n+    fi\n+\n+    dnl These rules are solely for the distribution goal.  While doing this\n+    dnl we only have to keep exactly one list of the available catalogs\n+    dnl in configure.in.\n+    for lang in $ALL_LINGUAS; do\n+      GMOFILES=\"$GMOFILES $lang.gmo\"\n+      POFILES=\"$POFILES $lang.po\"\n+    done\n+\n+    dnl Make all variables we use known to autoconf.\n+    AC_SUBST(BUILD_INCLUDED_LIBINTL)\n+    AC_SUBST(USE_INCLUDED_LIBINTL)\n+    AC_SUBST(CATALOGS)\n+    AC_SUBST(CATOBJEXT)\n+    AC_SUBST(GMOFILES)\n+    AC_SUBST(INTLLIBS)\n+    AC_SUBST(INTLOBJS)\n+    AC_SUBST(POFILES)\n+    AC_SUBST(POSUB)\n+\n+    dnl For backward compatibility. Some configure.ins may be using this.\n+    nls_cv_header_intl=\n+    nls_cv_header_libgt=\n+\n+    dnl For backward compatibility. Some Makefiles may be using this.\n+    DATADIRNAME=share\n+    AC_SUBST(DATADIRNAME)\n+\n+    dnl For backward compatibility. Some Makefiles may be using this.\n+    INSTOBJEXT=.mo\n+    AC_SUBST(INSTOBJEXT)\n+\n+    dnl For backward compatibility. Some Makefiles may be using this.\n+    GENCAT=gencat\n+    AC_SUBST(GENCAT)\n+  ])\n+\n+dnl Usage: Just like AM_WITH_NLS, which see.\n+AC_DEFUN([AM_GNU_GETTEXT],\n+  [AC_REQUIRE([AC_PROG_MAKE_SET])dnl\n+   AC_REQUIRE([AC_PROG_CC])dnl\n+   AC_REQUIRE([AC_CANONICAL_HOST])dnl\n+   AC_REQUIRE([AC_PROG_RANLIB])dnl\n+   AC_REQUIRE([AC_ISC_POSIX])dnl\n+   AC_REQUIRE([AC_HEADER_STDC])dnl\n+   AC_REQUIRE([AC_C_CONST])dnl\n+   AC_REQUIRE([AC_C_INLINE])dnl\n+   AC_REQUIRE([AC_TYPE_OFF_T])dnl\n+   AC_REQUIRE([AC_TYPE_SIZE_T])dnl\n+   AC_REQUIRE([AC_FUNC_ALLOCA])dnl\n+dnl GCC LOCAL: Do not refer to AC_FUNC_MMAP, we have special needs.\n+dnl   AC_REQUIRE([AC_FUNC_MMAP])dnl\n+   AC_REQUIRE([jm_GLIBC21])dnl\n+\n+   AC_CHECK_HEADERS([argz.h limits.h locale.h nl_types.h malloc.h stddef.h \\\n+stdlib.h string.h unistd.h sys/param.h])\n+   AC_CHECK_FUNCS([feof_unlocked fgets_unlocked getcwd getegid geteuid \\\n+getgid getuid mempcpy munmap putenv setenv setlocale stpcpy strchr strcasecmp \\\n+strdup strtoul tsearch __argz_count __argz_stringify __argz_next])\n+\n+   AM_ICONV\n+   AM_LANGINFO_CODESET\n+   AM_LC_MESSAGES\n+   AM_WITH_NLS([$1],[$2],[$3])\n+\n+   if test \"x$CATOBJEXT\" != \"x\"; then\n+     if test \"x$ALL_LINGUAS\" = \"x\"; then\n+       LINGUAS=\n+     else\n+       AC_MSG_CHECKING(for catalogs to be installed)\n+       NEW_LINGUAS=\n+       for presentlang in $ALL_LINGUAS; do\n+         useit=no\n+         for desiredlang in ${LINGUAS-$ALL_LINGUAS}; do\n+           # Use the presentlang catalog if desiredlang is\n+           #   a. equal to presentlang, or\n+           #   b. a variant of presentlang (because in this case,\n+           #      presentlang can be used as a fallback for messages\n+           #      which are not translated in the desiredlang catalog).\n+           case \"$desiredlang\" in\n+             \"$presentlang\"*) useit=yes;;\n+           esac\n+         done\n+         if test $useit = yes; then\n+           NEW_LINGUAS=\"$NEW_LINGUAS $presentlang\"\n+         fi\n+       done\n+       LINGUAS=$NEW_LINGUAS\n+       AC_MSG_RESULT($LINGUAS)\n+     fi\n+\n+     dnl Construct list of names of catalog files to be constructed.\n+     if test -n \"$LINGUAS\"; then\n+       for lang in $LINGUAS; do CATALOGS=\"$CATALOGS $lang$CATOBJEXT\"; done\n+     fi\n+   fi\n+\n+   dnl If the AC_CONFIG_AUX_DIR macro for autoconf is used we possibly\n+   dnl find the mkinstalldirs script in another subdir but $(top_srcdir).\n+   dnl Try to locate is.\n+   MKINSTALLDIRS=\n+   if test -n \"$ac_aux_dir\"; then\n+     MKINSTALLDIRS=\"$ac_aux_dir/mkinstalldirs\"\n+   fi\n+   if test -z \"$MKINSTALLDIRS\"; then\n+     MKINSTALLDIRS=\"\\$(top_srcdir)/mkinstalldirs\"\n+   fi\n+   AC_SUBST(MKINSTALLDIRS)\n+\n+   dnl Enable libtool support if the surrounding package wishes it.\n+   INTL_LIBTOOL_SUFFIX_PREFIX=ifelse([$1], use-libtool, [l], [])\n+   AC_SUBST(INTL_LIBTOOL_SUFFIX_PREFIX)\n+  ])"}, {"sha": "1c0238bd3ebf7822af488865f3e87c458f3962cb", "filename": "gcc/config.in", "status": "modified", "additions": 66, "deletions": 19, "changes": 85, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fconfig.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fconfig.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig.in?ref=71a94577632a238bf4e112f0f016819ead09f1d5", "patch": "@@ -1,15 +1,28 @@\n-/* config.in.  Generated automatically from configure.in by autoheader.  */\n+/* config.in.  Generated automatically from configure.in by autoheader 2.13.  */\n+\n+/* Define if using alloca.c.  */\n+#undef C_ALLOCA\n \n /* Define to empty if the keyword does not work.  */\n #undef const\n \n+/* Define to one of _getb67, GETB67, getb67 for Cray-2 and Cray-YMP systems.\n+   This function is required for alloca.c support on those systems.  */\n+#undef CRAY_STACKSEG_END\n+\n /* Define to the type of elements in the array set by `getgroups'.\n    Usually this is either `int' or `gid_t'.  */\n #undef GETGROUPS_T\n \n /* Define to `int' if <sys/types.h> doesn't define.  */\n #undef gid_t\n \n+/* Define if you have alloca, as a function or macro.  */\n+#undef HAVE_ALLOCA\n+\n+/* Define if you have <alloca.h> and it should be used (not on Ultrix).  */\n+#undef HAVE_ALLOCA_H\n+\n /* Define if you don't have vprintf but do have _doprnt.  */\n #undef HAVE_DOPRNT\n \n@@ -40,6 +53,15 @@\n /* Define to `unsigned' if <sys/types.h> doesn't define.  */\n #undef size_t\n \n+/* If using the C implementation of alloca, define if you know the\n+   direction of stack growth for your system; otherwise it will be\n+   automatically deduced at run-time.\n+ STACK_DIRECTION > 0 => grows toward higher addresses\n+ STACK_DIRECTION < 0 => grows toward lower addresses\n+ STACK_DIRECTION = 0 => direction of growth unknown\n+ */\n+#undef STACK_DIRECTION\n+\n /* Define if you have the ANSI C header files.  */\n #undef STDC_HEADERS\n \n@@ -52,21 +74,6 @@\n /* Define vfork as fork if vfork does not work.  */\n #undef vfork\n \n-/* Define to 1 if NLS is requested.  */\n-#undef ENABLE_NLS\n-\n-/* Define as 1 if you have catgets and don't want to use GNU gettext.  */\n-#undef HAVE_CATGETS\n-\n-/* Define as 1 if you have gettext and don't want to use GNU gettext.  */\n-#undef HAVE_GETTEXT\n-\n-/* Define if your locale.h file contains LC_MESSAGES.  */\n-#undef HAVE_LC_MESSAGES\n-\n-/* Define as 1 if you have the stpcpy function.  */\n-#undef HAVE_STPCPY\n-\n /* Define if your assembler supports specifying the maximum number\n    of bytes to skip when using the GAS .p2align command. */\n #undef HAVE_GAS_MAX_SKIP_P2ALIGN\n@@ -107,6 +114,12 @@\n /* Define if you have the dcgettext function.  */\n #undef HAVE_DCGETTEXT\n \n+/* Define if you have the feof_unlocked function.  */\n+#undef HAVE_FEOF_UNLOCKED\n+\n+/* Define if you have the fgets_unlocked function.  */\n+#undef HAVE_FGETS_UNLOCKED\n+\n /* Define if you have the fprintf_unlocked function.  */\n #undef HAVE_FPRINTF_UNLOCKED\n \n@@ -122,6 +135,15 @@\n /* Define if you have the getcwd function.  */\n #undef HAVE_GETCWD\n \n+/* Define if you have the getegid function.  */\n+#undef HAVE_GETEGID\n+\n+/* Define if you have the geteuid function.  */\n+#undef HAVE_GETEUID\n+\n+/* Define if you have the getgid function.  */\n+#undef HAVE_GETGID\n+\n /* Define if you have the getpagesize function.  */\n #undef HAVE_GETPAGESIZE\n \n@@ -134,6 +156,9 @@\n /* Define if you have the gettimeofday function.  */\n #undef HAVE_GETTIMEOFDAY\n \n+/* Define if you have the getuid function.  */\n+#undef HAVE_GETUID\n+\n /* Define if you have the isascii function.  */\n #undef HAVE_ISASCII\n \n@@ -143,6 +168,9 @@\n /* Define if you have the lstat function.  */\n #undef HAVE_LSTAT\n \n+/* Define if you have the mempcpy function.  */\n+#undef HAVE_MEMPCPY\n+\n /* Define if you have the munmap function.  */\n #undef HAVE_MUNMAP\n \n@@ -197,6 +225,9 @@\n /* Define if you have the times function.  */\n #undef HAVE_TIMES\n \n+/* Define if you have the tsearch function.  */\n+#undef HAVE_TSEARCH\n+\n /* Define if you have the <argz.h> header file.  */\n #undef HAVE_ARGZ_H\n \n@@ -257,9 +288,6 @@\n /* Define if you have the <unistd.h> header file.  */\n #undef HAVE_UNISTD_H\n \n-/* Define if you have the i library (-li).  */\n-#undef HAVE_LIBI\n-\n /* Define to enable the use of a default linker. */\n #undef DEFAULT_LINKER\n \n@@ -467,6 +495,25 @@\n /* Define to the version of the distribution. */\n #undef VERSION\n \n+/* Define if you have the iconv() function. */\n+#undef HAVE_ICONV\n+\n+/* Define as const if the declaration of iconv() needs const. */\n+#undef ICONV_CONST\n+\n+/* Define if you have <langinfo.h> and nl_langinfo(CODESET). */\n+#undef HAVE_LANGINFO_CODESET\n+\n+/* Define if your <locale.h> file defines LC_MESSAGES. */\n+#undef HAVE_LC_MESSAGES\n+\n+/* Define to 1 if translation of program messages to the user's native language\n+   is requested. */\n+#undef ENABLE_NLS\n+\n+/* Define if the GNU gettext() function is already present or preinstalled. */\n+#undef HAVE_GETTEXT\n+\n /* Define to 1 if installation paths should be looked up in Windows32\n    Registry. Ignored on non windows32 hosts. */\n #undef ENABLE_WIN32_REGISTRY"}, {"sha": "fe8b0833adddaa5f3f619e2a118c88a4e6f21a6d", "filename": "gcc/configure", "status": "modified", "additions": 766, "deletions": 745, "changes": 1511, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfigure?ref=71a94577632a238bf4e112f0f016819ead09f1d5", "patch": "@@ -58,12 +58,12 @@ ac_help=\"$ac_help\n   --with-libiconv-prefix=DIR  search for libiconv in DIR/include and DIR/lib\"\n ac_help=\"$ac_help\n   --enable-nls            use Native Language Support (default)\"\n+ac_help=\"$ac_help\n+  --with-libiconv-prefix=DIR  search for libiconv in DIR/include and DIR/lib\"\n ac_help=\"$ac_help\n   --disable-nls           do not use Native Language Support\"\n ac_help=\"$ac_help\n   --with-included-gettext use the GNU gettext library included here\"\n-ac_help=\"$ac_help\n-  --with-catgets          use catgets functions if available\"\n ac_help=\"$ac_help\n   --disable-win32-registry\n                           disable lookup of installation paths in the\n@@ -5299,14 +5299,14 @@ fi\n \n \n \n-        echo $ac_n \"checking for strerror in -lcposix\"\"... $ac_c\" 1>&6\n-echo \"configure:5304: checking for strerror in -lcposix\" >&5\n-ac_lib_var=`echo cposix'_'strerror | sed 'y%./+-%__p_%'`\n-if eval \"test \\\"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\\\" = set\"; then\n+            \n+echo $ac_n \"checking for library containing strerror\"\"... $ac_c\" 1>&6\n+echo \"configure:5305: checking for library containing strerror\" >&5\n+if eval \"test \\\"`echo '$''{'ac_cv_search_strerror'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n-  ac_save_LIBS=\"$LIBS\"\n-LIBS=\"-lcposix  $LIBS\"\n+  ac_func_search_save_LIBS=\"$LIBS\"\n+ac_cv_search_strerror=\"no\"\n cat > conftest.$ac_ext <<EOF\n #line 5312 \"configure\"\n #include \"confdefs.h\"\n@@ -5321,33 +5321,55 @@ strerror()\n EOF\n if { (eval echo configure:5323: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n-  eval \"ac_cv_lib_$ac_lib_var=yes\"\n+  ac_cv_search_strerror=\"none required\"\n else\n   echo \"configure: failed program was:\" >&5\n   cat conftest.$ac_ext >&5\n-  rm -rf conftest*\n-  eval \"ac_cv_lib_$ac_lib_var=no\"\n fi\n rm -f conftest*\n-LIBS=\"$ac_save_LIBS\"\n+test \"$ac_cv_search_strerror\" = \"no\" && for i in cposix; do\n+LIBS=\"-l$i  $ac_func_search_save_LIBS\"\n+cat > conftest.$ac_ext <<EOF\n+#line 5334 \"configure\"\n+#include \"confdefs.h\"\n+/* Override any gcc2 internal prototype to avoid an error.  */\n+/* We use char because int might match the return type of a gcc2\n+    builtin and then its argument prototype would still apply.  */\n+char strerror();\n \n-fi\n-if eval \"test \\\"`echo '$ac_cv_lib_'$ac_lib_var`\\\" = yes\"; then\n-  echo \"$ac_t\"\"yes\" 1>&6\n-  LIBS=\"$LIBS -lcposix\"\n+int main() {\n+strerror()\n+; return 0; }\n+EOF\n+if { (eval echo configure:5345: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+  rm -rf conftest*\n+  ac_cv_search_strerror=\"-l$i\"\n+break\n else\n-  echo \"$ac_t\"\"no\" 1>&6\n+  echo \"configure: failed program was:\" >&5\n+  cat conftest.$ac_ext >&5\n+fi\n+rm -f conftest*\n+done\n+LIBS=\"$ac_func_search_save_LIBS\"\n fi\n \n+echo \"$ac_t\"\"$ac_cv_search_strerror\" 1>&6\n+if test \"$ac_cv_search_strerror\" != \"no\"; then\n+  test \"$ac_cv_search_strerror\" = \"none required\" || LIBS=\"$ac_cv_search_strerror $LIBS\"\n+  \n+else :\n+  \n+fi\n   \n \n echo $ac_n \"checking for working const\"\"... $ac_c\" 1>&6\n-echo \"configure:5346: checking for working const\" >&5\n+echo \"configure:5368: checking for working const\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_c_const'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 5351 \"configure\"\n+#line 5373 \"configure\"\n #include \"confdefs.h\"\n \n int main() {\n@@ -5396,7 +5418,7 @@ ccp = (char const *const *) p;\n \n ; return 0; }\n EOF\n-if { (eval echo configure:5400: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; }; then\n+if { (eval echo configure:5422: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; }; then\n   rm -rf conftest*\n   ac_cv_c_const=yes\n else\n@@ -5417,12 +5439,12 @@ EOF\n fi\n \n echo $ac_n \"checking for off_t\"\"... $ac_c\" 1>&6\n-echo \"configure:5421: checking for off_t\" >&5\n+echo \"configure:5443: checking for off_t\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_type_off_t'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 5426 \"configure\"\n+#line 5448 \"configure\"\n #include \"confdefs.h\"\n #include <sys/types.h>\n #if STDC_HEADERS\n@@ -5450,12 +5472,12 @@ EOF\n fi\n \n echo $ac_n \"checking for size_t\"\"... $ac_c\" 1>&6\n-echo \"configure:5454: checking for size_t\" >&5\n+echo \"configure:5476: checking for size_t\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_type_size_t'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 5459 \"configure\"\n+#line 5481 \"configure\"\n #include \"confdefs.h\"\n #include <sys/types.h>\n #if STDC_HEADERS\n@@ -5482,115 +5504,143 @@ EOF\n \n fi\n \n-                        \n-   for ac_hdr in argz.h limits.h locale.h nl_types.h malloc.h string.h \\\n-unistd.h sys/param.h\n-do\n-ac_safe=`echo \"$ac_hdr\" | sed 'y%./+-%__p_%'`\n-echo $ac_n \"checking for $ac_hdr\"\"... $ac_c\" 1>&6\n-echo \"configure:5492: checking for $ac_hdr\" >&5\n-if eval \"test \\\"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\\\" = set\"; then\n+# The Ultrix 4.2 mips builtin alloca declared by alloca.h only works\n+# for constant arguments.  Useless!\n+echo $ac_n \"checking for working alloca.h\"\"... $ac_c\" 1>&6\n+echo \"configure:5511: checking for working alloca.h\" >&5\n+if eval \"test \\\"`echo '$''{'ac_cv_header_alloca_h'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 5497 \"configure\"\n+#line 5516 \"configure\"\n #include \"confdefs.h\"\n-#include <$ac_hdr>\n+#include <alloca.h>\n+int main() {\n+char *p = alloca(2 * sizeof(int));\n+; return 0; }\n EOF\n-ac_try=\"$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out\"\n-{ (eval echo configure:5502: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n-ac_err=`grep -v '^ *+' conftest.out | grep -v \"^conftest.${ac_ext}\\$\"`\n-if test -z \"$ac_err\"; then\n+if { (eval echo configure:5523: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n-  eval \"ac_cv_header_$ac_safe=yes\"\n+  ac_cv_header_alloca_h=yes\n else\n-  echo \"$ac_err\" >&5\n   echo \"configure: failed program was:\" >&5\n   cat conftest.$ac_ext >&5\n   rm -rf conftest*\n-  eval \"ac_cv_header_$ac_safe=no\"\n+  ac_cv_header_alloca_h=no\n fi\n rm -f conftest*\n fi\n-if eval \"test \\\"`echo '$ac_cv_header_'$ac_safe`\\\" = yes\"; then\n-  echo \"$ac_t\"\"yes\" 1>&6\n-    ac_tr_hdr=HAVE_`echo $ac_hdr | sed 'y%abcdefghijklmnopqrstuvwxyz./-%ABCDEFGHIJKLMNOPQRSTUVWXYZ___%'`\n-  cat >> confdefs.h <<EOF\n-#define $ac_tr_hdr 1\n+\n+echo \"$ac_t\"\"$ac_cv_header_alloca_h\" 1>&6\n+if test $ac_cv_header_alloca_h = yes; then\n+  cat >> confdefs.h <<\\EOF\n+#define HAVE_ALLOCA_H 1\n EOF\n- \n-else\n-  echo \"$ac_t\"\"no\" 1>&6\n+\n fi\n-done\n \n-   for ac_func in getcwd munmap putenv setenv setlocale strchr strcasecmp \\\n-strdup __argz_count __argz_stringify __argz_next\n-do\n-echo $ac_n \"checking for $ac_func\"\"... $ac_c\" 1>&6\n-echo \"configure:5532: checking for $ac_func\" >&5\n-if eval \"test \\\"`echo '$''{'ac_cv_func_$ac_func'+set}'`\\\" = set\"; then\n+echo $ac_n \"checking for alloca\"\"... $ac_c\" 1>&6\n+echo \"configure:5544: checking for alloca\" >&5\n+if eval \"test \\\"`echo '$''{'ac_cv_func_alloca_works'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 5537 \"configure\"\n+#line 5549 \"configure\"\n #include \"confdefs.h\"\n-/* System header to define __stub macros and hopefully few prototypes,\n-    which can conflict with char $ac_func(); below.  */\n-#include <assert.h>\n-/* Override any gcc2 internal prototype to avoid an error.  */\n-/* We use char because int might match the return type of a gcc2\n-    builtin and then its argument prototype would still apply.  */\n-char $ac_func();\n-\n-int main() {\n \n-/* The GNU C library defines this for functions which it implements\n-    to always fail with ENOSYS.  Some functions are actually named\n-    something starting with __ and the normal name is an alias.  */\n-#if defined (__stub_$ac_func) || defined (__stub___$ac_func)\n-choke me\n+#ifdef __GNUC__\n+# define alloca __builtin_alloca\n #else\n-$ac_func();\n+# ifdef _MSC_VER\n+#  include <malloc.h>\n+#  define alloca _alloca\n+# else\n+#  if HAVE_ALLOCA_H\n+#   include <alloca.h>\n+#  else\n+#   ifdef _AIX\n+ #pragma alloca\n+#   else\n+#    ifndef alloca /* predefined by HP cc +Olibcalls */\n+char *alloca ();\n+#    endif\n+#   endif\n+#  endif\n+# endif\n #endif\n \n+int main() {\n+char *p = (char *) alloca(1);\n ; return 0; }\n EOF\n-if { (eval echo configure:5560: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo configure:5577: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n-  eval \"ac_cv_func_$ac_func=yes\"\n+  ac_cv_func_alloca_works=yes\n else\n   echo \"configure: failed program was:\" >&5\n   cat conftest.$ac_ext >&5\n   rm -rf conftest*\n-  eval \"ac_cv_func_$ac_func=no\"\n+  ac_cv_func_alloca_works=no\n fi\n rm -f conftest*\n fi\n \n-if eval \"test \\\"`echo '$ac_cv_func_'$ac_func`\\\" = yes\"; then\n-  echo \"$ac_t\"\"yes\" 1>&6\n-    ac_tr_func=HAVE_`echo $ac_func | tr 'abcdefghijklmnopqrstuvwxyz' 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'`\n-  cat >> confdefs.h <<EOF\n-#define $ac_tr_func 1\n+echo \"$ac_t\"\"$ac_cv_func_alloca_works\" 1>&6\n+if test $ac_cv_func_alloca_works = yes; then\n+  cat >> confdefs.h <<\\EOF\n+#define HAVE_ALLOCA 1\n EOF\n- \n+\n+fi\n+\n+if test $ac_cv_func_alloca_works = no; then\n+  # The SVR3 libPW and SVR4 libucb both contain incompatible functions\n+  # that cause trouble.  Some versions do not even contain alloca or\n+  # contain a buggy version.  If you still want to use their alloca,\n+  # use ar to extract alloca.o from them instead of compiling alloca.c.\n+  ALLOCA=alloca.${ac_objext}\n+  cat >> confdefs.h <<\\EOF\n+#define C_ALLOCA 1\n+EOF\n+\n+\n+echo $ac_n \"checking whether alloca needs Cray hooks\"\"... $ac_c\" 1>&6\n+echo \"configure:5609: checking whether alloca needs Cray hooks\" >&5\n+if eval \"test \\\"`echo '$''{'ac_cv_os_cray'+set}'`\\\" = set\"; then\n+  echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n-  echo \"$ac_t\"\"no\" 1>&6\n+  cat > conftest.$ac_ext <<EOF\n+#line 5614 \"configure\"\n+#include \"confdefs.h\"\n+#if defined(CRAY) && ! defined(CRAY2)\n+webecray\n+#else\n+wenotbecray\n+#endif\n+\n+EOF\n+if (eval \"$ac_cpp conftest.$ac_ext\") 2>&5 |\n+  egrep \"webecray\" >/dev/null 2>&1; then\n+  rm -rf conftest*\n+  ac_cv_os_cray=yes\n+else\n+  rm -rf conftest*\n+  ac_cv_os_cray=no\n fi\n-done\n+rm -f conftest*\n \n+fi\n \n-   if test \"${ac_cv_func_stpcpy+set}\" != \"set\"; then\n-     for ac_func in stpcpy\n-do\n-echo $ac_n \"checking for $ac_func\"\"... $ac_c\" 1>&6\n-echo \"configure:5589: checking for $ac_func\" >&5\n+echo \"$ac_t\"\"$ac_cv_os_cray\" 1>&6\n+if test $ac_cv_os_cray = yes; then\n+for ac_func in _getb67 GETB67 getb67; do\n+  echo $ac_n \"checking for $ac_func\"\"... $ac_c\" 1>&6\n+echo \"configure:5639: checking for $ac_func\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_func_$ac_func'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 5594 \"configure\"\n+#line 5644 \"configure\"\n #include \"confdefs.h\"\n /* System header to define __stub macros and hopefully few prototypes,\n     which can conflict with char $ac_func(); below.  */\n@@ -5613,7 +5663,7 @@ $ac_func();\n \n ; return 0; }\n EOF\n-if { (eval echo configure:5617: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo configure:5667: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n   eval \"ac_cv_func_$ac_func=yes\"\n else\n@@ -5627,109 +5677,121 @@ fi\n \n if eval \"test \\\"`echo '$ac_cv_func_'$ac_func`\\\" = yes\"; then\n   echo \"$ac_t\"\"yes\" 1>&6\n-    ac_tr_func=HAVE_`echo $ac_func | tr 'abcdefghijklmnopqrstuvwxyz' 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'`\n   cat >> confdefs.h <<EOF\n-#define $ac_tr_func 1\n+#define CRAY_STACKSEG_END $ac_func\n EOF\n- \n+\n+  break\n else\n   echo \"$ac_t\"\"no\" 1>&6\n fi\n-done\n-\n-   fi\n-   if test \"${ac_cv_func_stpcpy}\" = \"yes\"; then\n-     cat >> confdefs.h <<\\EOF\n-#define HAVE_STPCPY 1\n-EOF\n \n-   fi\n+done\n+fi\n \n-   if test $ac_cv_header_locale_h = yes; then\n-    echo $ac_n \"checking for LC_MESSAGES\"\"... $ac_c\" 1>&6\n-echo \"configure:5651: checking for LC_MESSAGES\" >&5\n-if eval \"test \\\"`echo '$''{'am_cv_val_LC_MESSAGES'+set}'`\\\" = set\"; then\n+echo $ac_n \"checking stack direction for C alloca\"\"... $ac_c\" 1>&6\n+echo \"configure:5694: checking stack direction for C alloca\" >&5\n+if eval \"test \\\"`echo '$''{'ac_cv_c_stack_direction'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n+else\n+  if test \"$cross_compiling\" = yes; then\n+  ac_cv_c_stack_direction=0\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 5656 \"configure\"\n+#line 5702 \"configure\"\n #include \"confdefs.h\"\n-#include <locale.h>\n-int main() {\n-return LC_MESSAGES\n-; return 0; }\n+find_stack_direction ()\n+{\n+  static char *addr = 0;\n+  auto char dummy;\n+  if (addr == 0)\n+    {\n+      addr = &dummy;\n+      return find_stack_direction ();\n+    }\n+  else\n+    return (&dummy > addr) ? 1 : -1;\n+}\n+main ()\n+{\n+  exit (find_stack_direction() < 0);\n+}\n EOF\n-if { (eval echo configure:5663: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n-  rm -rf conftest*\n-  am_cv_val_LC_MESSAGES=yes\n+if { (eval echo configure:5721: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n+then\n+  ac_cv_c_stack_direction=1\n else\n   echo \"configure: failed program was:\" >&5\n   cat conftest.$ac_ext >&5\n-  rm -rf conftest*\n-  am_cv_val_LC_MESSAGES=no\n+  rm -fr conftest*\n+  ac_cv_c_stack_direction=-1\n fi\n-rm -f conftest*\n+rm -fr conftest*\n fi\n \n-echo \"$ac_t\"\"$am_cv_val_LC_MESSAGES\" 1>&6\n-    if test $am_cv_val_LC_MESSAGES = yes; then\n-      cat >> confdefs.h <<\\EOF\n-#define HAVE_LC_MESSAGES 1\n+fi\n+\n+echo \"$ac_t\"\"$ac_cv_c_stack_direction\" 1>&6\n+cat >> confdefs.h <<EOF\n+#define STACK_DIRECTION $ac_cv_c_stack_direction\n EOF\n \n-    fi\n-  fi\n-   echo $ac_n \"checking whether NLS is requested\"\"... $ac_c\" 1>&6\n-echo \"configure:5684: checking whether NLS is requested\" >&5\n-        # Check whether --enable-nls or --disable-nls was given.\n-if test \"${enable_nls+set}\" = set; then\n-  enableval=\"$enable_nls\"\n-  USE_NLS=$enableval\n-else\n-  USE_NLS=yes\n fi\n \n-    echo \"$ac_t\"\"$USE_NLS\" 1>&6\n-    \n \n-    USE_INCLUDED_LIBINTL=no\n+    echo $ac_n \"checking whether we are using the GNU C Library 2.1 or newer\"\"... $ac_c\" 1>&6\n+echo \"configure:5744: checking whether we are using the GNU C Library 2.1 or newer\" >&5\n+if eval \"test \\\"`echo '$''{'ac_cv_gnu_library_2_1'+set}'`\\\" = set\"; then\n+  echo $ac_n \"(cached) $ac_c\" 1>&6\n+else\n+  cat > conftest.$ac_ext <<EOF\n+#line 5749 \"configure\"\n+#include \"confdefs.h\"\n \n-        if test \"$USE_NLS\" = \"yes\"; then\n-      cat >> confdefs.h <<\\EOF\n-#define ENABLE_NLS 1\n+#include <features.h>\n+#ifdef __GNU_LIBRARY__\n+ #if (__GLIBC__ == 2 && __GLIBC_MINOR__ >= 1) || (__GLIBC__ > 2)\n+  Lucky GNU user\n+ #endif\n+#endif\n+\t\n EOF\n-\n-      echo $ac_n \"checking whether included gettext is requested\"\"... $ac_c\" 1>&6\n-echo \"configure:5704: checking whether included gettext is requested\" >&5\n-      # Check whether --with-included-gettext or --without-included-gettext was given.\n-if test \"${with_included_gettext+set}\" = set; then\n-  withval=\"$with_included_gettext\"\n-  nls_cv_force_use_gnu_gettext=$withval\n+if (eval \"$ac_cpp conftest.$ac_ext\") 2>&5 |\n+  egrep \"Lucky GNU user\" >/dev/null 2>&1; then\n+  rm -rf conftest*\n+  ac_cv_gnu_library_2_1=yes\n else\n-  nls_cv_force_use_gnu_gettext=no\n+  rm -rf conftest*\n+  ac_cv_gnu_library_2_1=no\n fi\n+rm -f conftest*\n \n-      echo \"$ac_t\"\"$nls_cv_force_use_gnu_gettext\" 1>&6\n+      \n+    \n+fi\n \n-      nls_cv_use_gnu_gettext=\"$nls_cv_force_use_gnu_gettext\"\n-      if test \"$nls_cv_force_use_gnu_gettext\" != \"yes\"; then\n-                        \t\tnls_cv_header_intl=\n-\tnls_cv_header_libgt=\n-\tCATOBJEXT=NONE\n+echo \"$ac_t\"\"$ac_cv_gnu_library_2_1\" 1>&6\n+    \n+    GLIBC21=\"$ac_cv_gnu_library_2_1\"\n+  \n \n-\tac_safe=`echo \"libintl.h\" | sed 'y%./+-%__p_%'`\n-echo $ac_n \"checking for libintl.h\"\"... $ac_c\" 1>&6\n-echo \"configure:5723: checking for libintl.h\" >&5\n+                                 \n+   for ac_hdr in argz.h limits.h locale.h nl_types.h malloc.h stddef.h \\\n+stdlib.h string.h unistd.h sys/param.h\n+do\n+ac_safe=`echo \"$ac_hdr\" | sed 'y%./+-%__p_%'`\n+echo $ac_n \"checking for $ac_hdr\"\"... $ac_c\" 1>&6\n+echo \"configure:5785: checking for $ac_hdr\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 5728 \"configure\"\n+#line 5790 \"configure\"\n #include \"confdefs.h\"\n-#include <libintl.h>\n+#include <$ac_hdr>\n EOF\n ac_try=\"$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out\"\n-{ (eval echo configure:5733: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n+{ (eval echo configure:5795: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n ac_err=`grep -v '^ *+' conftest.out | grep -v \"^conftest.${ac_ext}\\$\"`\n if test -z \"$ac_err\"; then\n   rm -rf conftest*\n@@ -5745,591 +5807,587 @@ rm -f conftest*\n fi\n if eval \"test \\\"`echo '$ac_cv_header_'$ac_safe`\\\" = yes\"; then\n   echo \"$ac_t\"\"yes\" 1>&6\n-  echo $ac_n \"checking for gettext in libc\"\"... $ac_c\" 1>&6\n-echo \"configure:5750: checking for gettext in libc\" >&5\n-if eval \"test \\\"`echo '$''{'gt_cv_func_gettext_libc'+set}'`\\\" = set\"; then\n-  echo $ac_n \"(cached) $ac_c\" 1>&6\n-else\n-  cat > conftest.$ac_ext <<EOF\n-#line 5755 \"configure\"\n-#include \"confdefs.h\"\n-#include <libintl.h>\n-int main() {\n-return (int) gettext (\"\")\n-; return 0; }\n+    ac_tr_hdr=HAVE_`echo $ac_hdr | sed 'y%abcdefghijklmnopqrstuvwxyz./-%ABCDEFGHIJKLMNOPQRSTUVWXYZ___%'`\n+  cat >> confdefs.h <<EOF\n+#define $ac_tr_hdr 1\n EOF\n-if { (eval echo configure:5762: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n-  rm -rf conftest*\n-  gt_cv_func_gettext_libc=yes\n+ \n else\n-  echo \"configure: failed program was:\" >&5\n-  cat conftest.$ac_ext >&5\n-  rm -rf conftest*\n-  gt_cv_func_gettext_libc=no\n-fi\n-rm -f conftest*\n+  echo \"$ac_t\"\"no\" 1>&6\n fi\n+done\n \n-echo \"$ac_t\"\"$gt_cv_func_gettext_libc\" 1>&6\n-\n-\t   if test \"$gt_cv_func_gettext_libc\" != \"yes\"; then\n-\t     echo $ac_n \"checking for bindtextdomain in -lintl\"\"... $ac_c\" 1>&6\n-echo \"configure:5778: checking for bindtextdomain in -lintl\" >&5\n-ac_lib_var=`echo intl'_'bindtextdomain | sed 'y%./+-%__p_%'`\n-if eval \"test \\\"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\\\" = set\"; then\n+   for ac_func in feof_unlocked fgets_unlocked getcwd getegid geteuid \\\n+getgid getuid mempcpy munmap putenv setenv setlocale stpcpy strchr strcasecmp \\\n+strdup strtoul tsearch __argz_count __argz_stringify __argz_next\n+do\n+echo $ac_n \"checking for $ac_func\"\"... $ac_c\" 1>&6\n+echo \"configure:5826: checking for $ac_func\" >&5\n+if eval \"test \\\"`echo '$''{'ac_cv_func_$ac_func'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n-  ac_save_LIBS=\"$LIBS\"\n-LIBS=\"-lintl  $LIBS\"\n-cat > conftest.$ac_ext <<EOF\n-#line 5786 \"configure\"\n+  cat > conftest.$ac_ext <<EOF\n+#line 5831 \"configure\"\n #include \"confdefs.h\"\n+/* System header to define __stub macros and hopefully few prototypes,\n+    which can conflict with char $ac_func(); below.  */\n+#include <assert.h>\n /* Override any gcc2 internal prototype to avoid an error.  */\n /* We use char because int might match the return type of a gcc2\n     builtin and then its argument prototype would still apply.  */\n-char bindtextdomain();\n+char $ac_func();\n \n int main() {\n-bindtextdomain()\n+\n+/* The GNU C library defines this for functions which it implements\n+    to always fail with ENOSYS.  Some functions are actually named\n+    something starting with __ and the normal name is an alias.  */\n+#if defined (__stub_$ac_func) || defined (__stub___$ac_func)\n+choke me\n+#else\n+$ac_func();\n+#endif\n+\n ; return 0; }\n EOF\n-if { (eval echo configure:5797: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo configure:5854: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n-  eval \"ac_cv_lib_$ac_lib_var=yes\"\n+  eval \"ac_cv_func_$ac_func=yes\"\n else\n   echo \"configure: failed program was:\" >&5\n   cat conftest.$ac_ext >&5\n   rm -rf conftest*\n-  eval \"ac_cv_lib_$ac_lib_var=no\"\n+  eval \"ac_cv_func_$ac_func=no\"\n fi\n rm -f conftest*\n-LIBS=\"$ac_save_LIBS\"\n-\n fi\n-if eval \"test \\\"`echo '$ac_cv_lib_'$ac_lib_var`\\\" = yes\"; then\n+\n+if eval \"test \\\"`echo '$ac_cv_func_'$ac_func`\\\" = yes\"; then\n   echo \"$ac_t\"\"yes\" 1>&6\n-  echo $ac_n \"checking for gettext in libintl\"\"... $ac_c\" 1>&6\n-echo \"configure:5813: checking for gettext in libintl\" >&5\n-if eval \"test \\\"`echo '$''{'gt_cv_func_gettext_libintl'+set}'`\\\" = set\"; then\n-  echo $ac_n \"(cached) $ac_c\" 1>&6\n-else\n-  echo $ac_n \"checking for gettext in -lintl\"\"... $ac_c\" 1>&6\n-echo \"configure:5818: checking for gettext in -lintl\" >&5\n-ac_lib_var=`echo intl'_'gettext | sed 'y%./+-%__p_%'`\n-if eval \"test \\\"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\\\" = set\"; then\n-  echo $ac_n \"(cached) $ac_c\" 1>&6\n+    ac_tr_func=HAVE_`echo $ac_func | tr 'abcdefghijklmnopqrstuvwxyz' 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'`\n+  cat >> confdefs.h <<EOF\n+#define $ac_tr_func 1\n+EOF\n+ \n else\n-  ac_save_LIBS=\"$LIBS\"\n-LIBS=\"-lintl  $LIBS\"\n-cat > conftest.$ac_ext <<EOF\n-#line 5826 \"configure\"\n-#include \"confdefs.h\"\n-/* Override any gcc2 internal prototype to avoid an error.  */\n-/* We use char because int might match the return type of a gcc2\n-    builtin and then its argument prototype would still apply.  */\n-char gettext();\n+  echo \"$ac_t\"\"no\" 1>&6\n+fi\n+done\n+\n+\n+   \n+    \n+  # Check whether --with-libiconv-prefix or --without-libiconv-prefix was given.\n+if test \"${with_libiconv_prefix+set}\" = set; then\n+  withval=\"$with_libiconv_prefix\"\n+  \n+    for dir in `echo \"$withval\" | tr : ' '`; do\n+      if test -d $dir/include; then CPPFLAGS=\"$CPPFLAGS -I$dir/include\"; fi\n+      if test -d $dir/lib; then LDFLAGS=\"$LDFLAGS -L$dir/lib\"; fi\n+    done\n+   \n+fi\n \n+\n+  echo $ac_n \"checking for iconv\"\"... $ac_c\" 1>&6\n+echo \"configure:5894: checking for iconv\" >&5\n+if eval \"test \\\"`echo '$''{'am_cv_func_iconv'+set}'`\\\" = set\"; then\n+  echo $ac_n \"(cached) $ac_c\" 1>&6\n+else\n+  \n+    am_cv_func_iconv=\"no, consider installing GNU libiconv\"\n+    am_cv_lib_iconv=no\n+    cat > conftest.$ac_ext <<EOF\n+#line 5902 \"configure\"\n+#include \"confdefs.h\"\n+#include <stdlib.h>\n+#include <iconv.h>\n int main() {\n-gettext()\n+iconv_t cd = iconv_open(\"\",\"\");\n+       iconv(cd,NULL,NULL,NULL,NULL);\n+       iconv_close(cd);\n ; return 0; }\n EOF\n-if { (eval echo configure:5837: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo configure:5912: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n-  eval \"ac_cv_lib_$ac_lib_var=yes\"\n+  am_cv_func_iconv=yes\n else\n   echo \"configure: failed program was:\" >&5\n   cat conftest.$ac_ext >&5\n-  rm -rf conftest*\n-  eval \"ac_cv_lib_$ac_lib_var=no\"\n fi\n rm -f conftest*\n-LIBS=\"$ac_save_LIBS\"\n-\n-fi\n-if eval \"test \\\"`echo '$ac_cv_lib_'$ac_lib_var`\\\" = yes\"; then\n-  echo \"$ac_t\"\"yes\" 1>&6\n-  gt_cv_func_gettext_libintl=yes\n+    if test \"$am_cv_func_iconv\" != yes; then\n+      am_save_LIBS=\"$LIBS\"\n+      LIBS=\"$LIBS -liconv\"\n+      cat > conftest.$ac_ext <<EOF\n+#line 5924 \"configure\"\n+#include \"confdefs.h\"\n+#include <stdlib.h>\n+#include <iconv.h>\n+int main() {\n+iconv_t cd = iconv_open(\"\",\"\");\n+         iconv(cd,NULL,NULL,NULL,NULL);\n+         iconv_close(cd);\n+; return 0; }\n+EOF\n+if { (eval echo configure:5934: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+  rm -rf conftest*\n+  am_cv_lib_iconv=yes\n+        am_cv_func_iconv=yes\n else\n-  echo \"$ac_t\"\"no\" 1>&6\n-gt_cv_func_gettext_libintl=no\n+  echo \"configure: failed program was:\" >&5\n+  cat conftest.$ac_ext >&5\n fi\n-\n+rm -f conftest*\n+      LIBS=\"$am_save_LIBS\"\n+    fi\n+  \n fi\n \n-echo \"$ac_t\"\"$gt_cv_func_gettext_libintl\" 1>&6\n+echo \"$ac_t\"\"$am_cv_func_iconv\" 1>&6\n+  if test \"$am_cv_func_iconv\" = yes; then\n+    cat >> confdefs.h <<\\EOF\n+#define HAVE_ICONV 1\n+EOF\n+\n+    echo $ac_n \"checking for iconv declaration\"\"... $ac_c\" 1>&6\n+echo \"configure:5955: checking for iconv declaration\" >&5\n+    if eval \"test \\\"`echo '$''{'am_cv_proto_iconv'+set}'`\\\" = set\"; then\n+  echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n-  echo \"$ac_t\"\"no\" 1>&6\n-fi\n+  \n+      cat > conftest.$ac_ext <<EOF\n+#line 5961 \"configure\"\n+#include \"confdefs.h\"\n \n-\t   fi\n+#include <stdlib.h>\n+#include <iconv.h>\n+extern\n+#ifdef __cplusplus\n+\"C\"\n+#endif\n+#if defined(__STDC__) || defined(__cplusplus)\n+size_t iconv (iconv_t cd, char * *inbuf, size_t *inbytesleft, char * *outbuf, size_t *outbytesleft);\n+#else\n+size_t iconv();\n+#endif\n \n-\t   if test \"$gt_cv_func_gettext_libintl\" = \"yes\"; then\n-\t     LIBS=\"-lintl $LIBS\"\n-\t   fi\n+int main() {\n \n-\t   if test \"$gt_cv_func_gettext_libc\" = \"yes\" \\\n-\t      || test \"$gt_cv_func_gettext_libintl\" = \"yes\"; then\n-\t      cat >> confdefs.h <<\\EOF\n-#define HAVE_GETTEXT 1\n+; return 0; }\n EOF\n-\n-\t      # Extract the first word of \"msgfmt\", so it can be a program name with args.\n-set dummy msgfmt; ac_word=$2\n-echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:5880: checking for $ac_word\" >&5\n-if eval \"test \\\"`echo '$''{'gcc_cv_path_MSGFMT'+set}'`\\\" = set\"; then\n-  echo $ac_n \"(cached) $ac_c\" 1>&6\n+if { (eval echo configure:5980: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; }; then\n+  rm -rf conftest*\n+  am_cv_proto_iconv_arg1=\"\"\n else\n-  case \"$MSGFMT\" in\n-  /*)\n-  gcc_cv_path_MSGFMT=\"$MSGFMT\" # Let the user override the test with a path.\n-  ;;\n-  *)\n-  IFS=\"${IFS= \t}\"; ac_save_ifs=\"$IFS\"; IFS=\"${IFS}:\"\n-  for ac_dir in $PATH; do\n-    test -z \"$ac_dir\" && ac_dir=.\n-    if test -f $ac_dir/$ac_word; then\n-      if test -z \"`$ac_dir/$ac_word -h 2>&1 | grep 'dv '`\"; then\n-\tgcc_cv_path_MSGFMT=\"$ac_dir/$ac_word\"\n-\tbreak\n-      fi\n-    fi\n-  done\n-  IFS=\"$ac_save_ifs\"\n-  test -z \"$gcc_cv_path_MSGFMT\" && gcc_cv_path_MSGFMT=\"no\"\n-  ;;\n-esac\n+  echo \"configure: failed program was:\" >&5\n+  cat conftest.$ac_ext >&5\n+  rm -rf conftest*\n+  am_cv_proto_iconv_arg1=\"const\"\n fi\n-MSGFMT=\"$gcc_cv_path_MSGFMT\"\n-if test -n \"$MSGFMT\"; then\n-  echo \"$ac_t\"\"$MSGFMT\" 1>&6\n-else\n-  echo \"$ac_t\"\"no\" 1>&6\n+rm -f conftest*\n+      am_cv_proto_iconv=\"extern size_t iconv (iconv_t cd, $am_cv_proto_iconv_arg1 char * *inbuf, size_t *inbytesleft, char * *outbuf, size_t *outbytesleft);\"\n fi\n-\t      if test \"$MSGFMT\" != \"no\"; then\n-\t\tfor ac_func in dcgettext\n-do\n-echo $ac_n \"checking for $ac_func\"\"... $ac_c\" 1>&6\n-echo \"configure:5914: checking for $ac_func\" >&5\n-if eval \"test \\\"`echo '$''{'ac_cv_func_$ac_func'+set}'`\\\" = set\"; then\n+\n+    am_cv_proto_iconv=`echo \"$am_cv_proto_iconv\" | tr -s ' ' | sed -e 's/( /(/'`\n+    echo \"$ac_t\"\"${ac_t:-\n+         }$am_cv_proto_iconv\" 1>&6\n+    cat >> confdefs.h <<EOF\n+#define ICONV_CONST $am_cv_proto_iconv_arg1\n+EOF\n+\n+  fi\n+  LIBICONV=\n+  if test \"$am_cv_lib_iconv\" = yes; then\n+    LIBICONV=\"-liconv\"\n+  fi\n+  \n+\n+   \n+  echo $ac_n \"checking for nl_langinfo and CODESET\"\"... $ac_c\" 1>&6\n+echo \"configure:6009: checking for nl_langinfo and CODESET\" >&5\n+if eval \"test \\\"`echo '$''{'am_cv_langinfo_codeset'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 5919 \"configure\"\n+#line 6014 \"configure\"\n #include \"confdefs.h\"\n-/* System header to define __stub macros and hopefully few prototypes,\n-    which can conflict with char $ac_func(); below.  */\n-#include <assert.h>\n-/* Override any gcc2 internal prototype to avoid an error.  */\n-/* We use char because int might match the return type of a gcc2\n-    builtin and then its argument prototype would still apply.  */\n-char $ac_func();\n-\n+#include <langinfo.h>\n int main() {\n-\n-/* The GNU C library defines this for functions which it implements\n-    to always fail with ENOSYS.  Some functions are actually named\n-    something starting with __ and the normal name is an alias.  */\n-#if defined (__stub_$ac_func) || defined (__stub___$ac_func)\n-choke me\n-#else\n-$ac_func();\n-#endif\n-\n+char* cs = nl_langinfo(CODESET);\n ; return 0; }\n EOF\n-if { (eval echo configure:5942: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo configure:6021: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n-  eval \"ac_cv_func_$ac_func=yes\"\n+  am_cv_langinfo_codeset=yes\n else\n   echo \"configure: failed program was:\" >&5\n   cat conftest.$ac_ext >&5\n   rm -rf conftest*\n-  eval \"ac_cv_func_$ac_func=no\"\n+  am_cv_langinfo_codeset=no\n fi\n rm -f conftest*\n+    \n fi\n \n-if eval \"test \\\"`echo '$ac_cv_func_'$ac_func`\\\" = yes\"; then\n-  echo \"$ac_t\"\"yes\" 1>&6\n-    ac_tr_func=HAVE_`echo $ac_func | tr 'abcdefghijklmnopqrstuvwxyz' 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'`\n-  cat >> confdefs.h <<EOF\n-#define $ac_tr_func 1\n+echo \"$ac_t\"\"$am_cv_langinfo_codeset\" 1>&6\n+  if test $am_cv_langinfo_codeset = yes; then\n+    cat >> confdefs.h <<\\EOF\n+#define HAVE_LANGINFO_CODESET 1\n EOF\n- \n-else\n-  echo \"$ac_t\"\"no\" 1>&6\n-fi\n-done\n \n-\t\t# Extract the first word of \"gmsgfmt\", so it can be a program name with args.\n-set dummy gmsgfmt; ac_word=$2\n-echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:5969: checking for $ac_word\" >&5\n-if eval \"test \\\"`echo '$''{'gcc_cv_path_GMSGFMT'+set}'`\\\" = set\"; then\n+  fi\n+\n+   if test $ac_cv_header_locale_h = yes; then\n+    echo $ac_n \"checking for LC_MESSAGES\"\"... $ac_c\" 1>&6\n+echo \"configure:6044: checking for LC_MESSAGES\" >&5\n+if eval \"test \\\"`echo '$''{'am_cv_val_LC_MESSAGES'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n-  case \"$GMSGFMT\" in\n-  /*)\n-  gcc_cv_path_GMSGFMT=\"$GMSGFMT\" # Let the user override the test with a path.\n-  ;;\n-  ?:/*)\t\t\t \n-  gcc_cv_path_GMSGFMT=\"$GMSGFMT\" # Let the user override the test with a dos path.\n-  ;;\n-  *)\n-  IFS=\"${IFS= \t}\"; ac_save_ifs=\"$IFS\"; IFS=\":\"\n-  ac_dummy=\"$PATH\"\n-  for ac_dir in $ac_dummy; do \n-    test -z \"$ac_dir\" && ac_dir=.\n-    if test -f $ac_dir/$ac_word; then\n-      gcc_cv_path_GMSGFMT=\"$ac_dir/$ac_word\"\n-      break\n+  cat > conftest.$ac_ext <<EOF\n+#line 6049 \"configure\"\n+#include \"confdefs.h\"\n+#include <locale.h>\n+int main() {\n+return LC_MESSAGES\n+; return 0; }\n+EOF\n+if { (eval echo configure:6056: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+  rm -rf conftest*\n+  am_cv_val_LC_MESSAGES=yes\n+else\n+  echo \"configure: failed program was:\" >&5\n+  cat conftest.$ac_ext >&5\n+  rm -rf conftest*\n+  am_cv_val_LC_MESSAGES=no\n+fi\n+rm -f conftest*\n+fi\n+\n+echo \"$ac_t\"\"$am_cv_val_LC_MESSAGES\" 1>&6\n+    if test $am_cv_val_LC_MESSAGES = yes; then\n+      cat >> confdefs.h <<\\EOF\n+#define HAVE_LC_MESSAGES 1\n+EOF\n+\n     fi\n-  done\n-  IFS=\"$ac_save_ifs\"\n-  test -z \"$gcc_cv_path_GMSGFMT\" && gcc_cv_path_GMSGFMT=\"$MSGFMT\"\n-  ;;\n-esac\n+  fi\n+   echo $ac_n \"checking whether NLS is requested\"\"... $ac_c\" 1>&6\n+echo \"configure:6077: checking whether NLS is requested\" >&5\n+        # Check whether --enable-nls or --disable-nls was given.\n+if test \"${enable_nls+set}\" = set; then\n+  enableval=\"$enable_nls\"\n+  USE_NLS=$enableval\n+else\n+  USE_NLS=yes\n fi\n-GMSGFMT=\"$gcc_cv_path_GMSGFMT\"\n-if test -n \"$GMSGFMT\"; then\n-  echo \"$ac_t\"\"$GMSGFMT\" 1>&6\n+\n+    echo \"$ac_t\"\"$USE_NLS\" 1>&6\n+    \n+\n+    BUILD_INCLUDED_LIBINTL=no\n+    USE_INCLUDED_LIBINTL=no\n+    INTLLIBS=\n+\n+        if test \"$USE_NLS\" = \"yes\"; then\n+      cat >> confdefs.h <<\\EOF\n+#define ENABLE_NLS 1\n+EOF\n+\n+      echo $ac_n \"checking whether included gettext is requested\"\"... $ac_c\" 1>&6\n+echo \"configure:6099: checking whether included gettext is requested\" >&5\n+      # Check whether --with-included-gettext or --without-included-gettext was given.\n+if test \"${with_included_gettext+set}\" = set; then\n+  withval=\"$with_included_gettext\"\n+  nls_cv_force_use_gnu_gettext=$withval\n else\n-  echo \"$ac_t\"\"no\" 1>&6\n+  nls_cv_force_use_gnu_gettext=no\n fi\n \n-\t\t# Extract the first word of \"xgettext\", so it can be a program name with args.\n-set dummy xgettext; ac_word=$2\n-echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:6005: checking for $ac_word\" >&5\n-if eval \"test \\\"`echo '$''{'gcc_cv_path_XGETTEXT'+set}'`\\\" = set\"; then\n+      echo \"$ac_t\"\"$nls_cv_force_use_gnu_gettext\" 1>&6\n+\n+      nls_cv_use_gnu_gettext=\"$nls_cv_force_use_gnu_gettext\"\n+      if test \"$nls_cv_force_use_gnu_gettext\" != \"yes\"; then\n+                        \tCATOBJEXT=NONE\n+\n+                \n+        \n+\n+\tac_safe=`echo \"libintl.h\" | sed 'y%./+-%__p_%'`\n+echo $ac_n \"checking for libintl.h\"\"... $ac_c\" 1>&6\n+echo \"configure:6119: checking for libintl.h\" >&5\n+if eval \"test \\\"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n-  case \"$XGETTEXT\" in\n-  /*)\n-  gcc_cv_path_XGETTEXT=\"$XGETTEXT\" # Let the user override the test with a path.\n-  ;;\n-  *)\n-  IFS=\"${IFS= \t}\"; ac_save_ifs=\"$IFS\"; IFS=\"${IFS}:\"\n-  for ac_dir in $PATH; do\n-    test -z \"$ac_dir\" && ac_dir=.\n-    if test -f $ac_dir/$ac_word; then\n-      if test -z \"`$ac_dir/$ac_word -h 2>&1 | grep '(HELP)'`\"; then\n-\tgcc_cv_path_XGETTEXT=\"$ac_dir/$ac_word\"\n-\tbreak\n-      fi\n-    fi\n-  done\n-  IFS=\"$ac_save_ifs\"\n-  test -z \"$gcc_cv_path_XGETTEXT\" && gcc_cv_path_XGETTEXT=\":\"\n-  ;;\n-esac\n-fi\n-XGETTEXT=\"$gcc_cv_path_XGETTEXT\"\n-if test -n \"$XGETTEXT\"; then\n-  echo \"$ac_t\"\"$XGETTEXT\" 1>&6\n+  cat > conftest.$ac_ext <<EOF\n+#line 6124 \"configure\"\n+#include \"confdefs.h\"\n+#include <libintl.h>\n+EOF\n+ac_try=\"$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out\"\n+{ (eval echo configure:6129: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n+ac_err=`grep -v '^ *+' conftest.out | grep -v \"^conftest.${ac_ext}\\$\"`\n+if test -z \"$ac_err\"; then\n+  rm -rf conftest*\n+  eval \"ac_cv_header_$ac_safe=yes\"\n else\n-  echo \"$ac_t\"\"no\" 1>&6\n+  echo \"$ac_err\" >&5\n+  echo \"configure: failed program was:\" >&5\n+  cat conftest.$ac_ext >&5\n+  rm -rf conftest*\n+  eval \"ac_cv_header_$ac_safe=no\"\n fi\n-\n-\t\tcat > conftest.$ac_ext <<EOF\n-#line 6037 \"configure\"\n+rm -f conftest*\n+fi\n+if eval \"test \\\"`echo '$ac_cv_header_'$ac_safe`\\\" = yes\"; then\n+  echo \"$ac_t\"\"yes\" 1>&6\n+  echo $ac_n \"checking for GNU gettext in libc\"\"... $ac_c\" 1>&6\n+echo \"configure:6146: checking for GNU gettext in libc\" >&5\n+if eval \"test \\\"`echo '$''{'gt_cv_func_gnugettext1_libc'+set}'`\\\" = set\"; then\n+  echo $ac_n \"(cached) $ac_c\" 1>&6\n+else\n+  cat > conftest.$ac_ext <<EOF\n+#line 6151 \"configure\"\n #include \"confdefs.h\"\n-\n-int main() {\n+#include <libintl.h>\n extern int _nl_msg_cat_cntr;\n-\t\t\t       return _nl_msg_cat_cntr\n+int main() {\n+bindtextdomain (\"\", \"\");\n+return (int) gettext (\"\") + _nl_msg_cat_cntr\n ; return 0; }\n EOF\n-if { (eval echo configure:6045: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo configure:6160: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n-  CATOBJEXT=.gmo\n-\t\t   DATADIRNAME=share\n+  gt_cv_func_gnugettext1_libc=yes\n else\n   echo \"configure: failed program was:\" >&5\n   cat conftest.$ac_ext >&5\n   rm -rf conftest*\n-  CATOBJEXT=.mo\n-\t\t   DATADIRNAME=lib\n+  gt_cv_func_gnugettext1_libc=no\n fi\n rm -f conftest*\n-\t\tINSTOBJEXT=.mo\n-\t      else\n-\t\tcreate_catalogs=\"no\"\n-\t      fi\n-\t    fi\n-\t\n-else\n-  echo \"$ac_t\"\"no\" 1>&6\n-fi\n-\n-\n-        if test \"$CATOBJEXT\" = \"NONE\"; then\n-\t  echo $ac_n \"checking whether catgets can be used\"\"... $ac_c\" 1>&6\n-echo \"configure:6070: checking whether catgets can be used\" >&5\n-\t  # Check whether --with-catgets or --without-catgets was given.\n-if test \"${with_catgets+set}\" = set; then\n-  withval=\"$with_catgets\"\n-  nls_cv_use_catgets=$withval\n-else\n-  nls_cv_use_catgets=no\n fi\n \n-\t  echo \"$ac_t\"\"$nls_cv_use_catgets\" 1>&6\n+echo \"$ac_t\"\"$gt_cv_func_gnugettext1_libc\" 1>&6\n \n-\t  if test \"$nls_cv_use_catgets\" = \"yes\"; then\n-\t    \t    echo $ac_n \"checking for main in -li\"\"... $ac_c\" 1>&6\n-echo \"configure:6083: checking for main in -li\" >&5\n-ac_lib_var=`echo i'_'main | sed 'y%./+-%__p_%'`\n-if eval \"test \\\"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\\\" = set\"; then\n+\t   if test \"$gt_cv_func_gnugettext1_libc\" != \"yes\"; then\n+\t     echo $ac_n \"checking for GNU gettext in libintl\"\"... $ac_c\" 1>&6\n+echo \"configure:6176: checking for GNU gettext in libintl\" >&5\n+if eval \"test \\\"`echo '$''{'gt_cv_func_gnugettext1_libintl'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n-  ac_save_LIBS=\"$LIBS\"\n-LIBS=\"-li  $LIBS\"\n-cat > conftest.$ac_ext <<EOF\n-#line 6091 \"configure\"\n+  gt_save_LIBS=\"$LIBS\"\n+\t\tLIBS=\"$LIBS -lintl $LIBICONV\"\n+\t\tcat > conftest.$ac_ext <<EOF\n+#line 6183 \"configure\"\n #include \"confdefs.h\"\n-\n+#include <libintl.h>\n+extern int _nl_msg_cat_cntr;\n int main() {\n-main()\n+bindtextdomain (\"\", \"\");\n+return (int) gettext (\"\") + _nl_msg_cat_cntr\n ; return 0; }\n EOF\n-if { (eval echo configure:6098: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo configure:6192: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n-  eval \"ac_cv_lib_$ac_lib_var=yes\"\n+  gt_cv_func_gnugettext1_libintl=yes\n else\n   echo \"configure: failed program was:\" >&5\n   cat conftest.$ac_ext >&5\n   rm -rf conftest*\n-  eval \"ac_cv_lib_$ac_lib_var=no\"\n+  gt_cv_func_gnugettext1_libintl=no\n fi\n rm -f conftest*\n-LIBS=\"$ac_save_LIBS\"\n-\n+\t\tLIBS=\"$gt_save_LIBS\"\n fi\n-if eval \"test \\\"`echo '$ac_cv_lib_'$ac_lib_var`\\\" = yes\"; then\n-  echo \"$ac_t\"\"yes\" 1>&6\n-    ac_tr_lib=HAVE_LIB`echo i | sed -e 's/[^a-zA-Z0-9_]/_/g' \\\n-    -e 'y/abcdefghijklmnopqrstuvwxyz/ABCDEFGHIJKLMNOPQRSTUVWXYZ/'`\n-  cat >> confdefs.h <<EOF\n-#define $ac_tr_lib 1\n+\n+echo \"$ac_t\"\"$gt_cv_func_gnugettext1_libintl\" 1>&6\n+\t   fi\n+\n+\t   \t   \t   \t   \t   if test \"$gt_cv_func_gnugettext1_libc\" = \"yes\" \\\n+\t      || { test \"$gt_cv_func_gnugettext1_libintl\" = \"yes\" \\\n+\t\t   && test \"$PACKAGE\" != gettext; }; then\n+\t     cat >> confdefs.h <<\\EOF\n+#define HAVE_GETTEXT 1\n EOF\n \n-  LIBS=\"-li $LIBS\"\n \n-else\n-  echo \"$ac_t\"\"no\" 1>&6\n-fi\n+\t     if test \"$gt_cv_func_gnugettext1_libintl\" = \"yes\"; then\n+\t       \t       \t       \t       INTLLIBS=\"-lintl $LIBICONV\"\n+\t     fi\n \n-\t    echo $ac_n \"checking for catgets\"\"... $ac_c\" 1>&6\n-echo \"configure:6126: checking for catgets\" >&5\n-if eval \"test \\\"`echo '$''{'ac_cv_func_catgets'+set}'`\\\" = set\"; then\n+\t     gt_save_LIBS=\"$LIBS\"\n+\t     LIBS=\"$LIBS $INTLLIBS\"\n+\t     for ac_func in dcgettext\n+do\n+echo $ac_n \"checking for $ac_func\"\"... $ac_c\" 1>&6\n+echo \"configure:6225: checking for $ac_func\" >&5\n+if eval \"test \\\"`echo '$''{'ac_cv_func_$ac_func'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 6131 \"configure\"\n+#line 6230 \"configure\"\n #include \"confdefs.h\"\n /* System header to define __stub macros and hopefully few prototypes,\n-    which can conflict with char catgets(); below.  */\n+    which can conflict with char $ac_func(); below.  */\n #include <assert.h>\n /* Override any gcc2 internal prototype to avoid an error.  */\n /* We use char because int might match the return type of a gcc2\n     builtin and then its argument prototype would still apply.  */\n-char catgets();\n+char $ac_func();\n \n int main() {\n \n /* The GNU C library defines this for functions which it implements\n     to always fail with ENOSYS.  Some functions are actually named\n     something starting with __ and the normal name is an alias.  */\n-#if defined (__stub_catgets) || defined (__stub___catgets)\n+#if defined (__stub_$ac_func) || defined (__stub___$ac_func)\n choke me\n #else\n-catgets();\n+$ac_func();\n #endif\n \n ; return 0; }\n EOF\n-if { (eval echo configure:6154: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo configure:6253: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n-  eval \"ac_cv_func_catgets=yes\"\n+  eval \"ac_cv_func_$ac_func=yes\"\n else\n   echo \"configure: failed program was:\" >&5\n   cat conftest.$ac_ext >&5\n   rm -rf conftest*\n-  eval \"ac_cv_func_catgets=no\"\n+  eval \"ac_cv_func_$ac_func=no\"\n fi\n rm -f conftest*\n fi\n \n-if eval \"test \\\"`echo '$ac_cv_func_'catgets`\\\" = yes\"; then\n+if eval \"test \\\"`echo '$ac_cv_func_'$ac_func`\\\" = yes\"; then\n   echo \"$ac_t\"\"yes\" 1>&6\n-  cat >> confdefs.h <<\\EOF\n-#define HAVE_CATGETS 1\n+    ac_tr_func=HAVE_`echo $ac_func | tr 'abcdefghijklmnopqrstuvwxyz' 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'`\n+  cat >> confdefs.h <<EOF\n+#define $ac_tr_func 1\n EOF\n+ \n+else\n+  echo \"$ac_t\"\"no\" 1>&6\n+fi\n+done\n \n-\t       INTLOBJS=\"\\$(CATOBJS)\"\n-\t       # Extract the first word of \"gencat\", so it can be a program name with args.\n-set dummy gencat; ac_word=$2\n+\t     LIBS=\"$gt_save_LIBS\"\n+\n+\t     \t     # Extract the first word of \"msgfmt\", so it can be a program name with args.\n+set dummy msgfmt; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:6176: checking for $ac_word\" >&5\n-if eval \"test \\\"`echo '$''{'gcc_cv_path_GENCAT'+set}'`\\\" = set\"; then\n+echo \"configure:6282: checking for $ac_word\" >&5\n+if eval \"test \\\"`echo '$''{'ac_cv_path_MSGFMT'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n-  case \"$GENCAT\" in\n+  case \"$MSGFMT\" in\n   /*)\n-  gcc_cv_path_GENCAT=\"$GENCAT\" # Let the user override the test with a path.\n-  ;;\n-  ?:/*)\t\t\t \n-  gcc_cv_path_GENCAT=\"$GENCAT\" # Let the user override the test with a dos path.\n+  ac_cv_path_MSGFMT=\"$MSGFMT\" # Let the user override the test with a path.\n   ;;\n   *)\n-  IFS=\"${IFS= \t}\"; ac_save_ifs=\"$IFS\"; IFS=\":\"\n-  ac_dummy=\"$PATH\"\n-  for ac_dir in $ac_dummy; do \n+  IFS=\"${IFS= \t}\"; ac_save_ifs=\"$IFS\"; IFS=\"${IFS}:\"\n+  for ac_dir in $PATH; do\n     test -z \"$ac_dir\" && ac_dir=.\n     if test -f $ac_dir/$ac_word; then\n-      gcc_cv_path_GENCAT=\"$ac_dir/$ac_word\"\n-      break\n+      if $ac_dir/$ac_word --statistics /dev/null >/dev/null 2>&1; then\n+\tac_cv_path_MSGFMT=\"$ac_dir/$ac_word\"\n+\tbreak\n+      fi\n     fi\n   done\n   IFS=\"$ac_save_ifs\"\n-  test -z \"$gcc_cv_path_GENCAT\" && gcc_cv_path_GENCAT=\"no\"\n+  test -z \"$ac_cv_path_MSGFMT\" && ac_cv_path_MSGFMT=\":\"\n   ;;\n esac\n fi\n-GENCAT=\"$gcc_cv_path_GENCAT\"\n-if test -n \"$GENCAT\"; then\n-  echo \"$ac_t\"\"$GENCAT\" 1>&6\n+MSGFMT=\"$ac_cv_path_MSGFMT\"\n+if test \"$MSGFMT\" != \":\"; then\n+  echo \"$ac_t\"\"$MSGFMT\" 1>&6\n else\n   echo \"$ac_t\"\"no\" 1>&6\n fi\n-\t       if test \"$GENCAT\" != \"no\"; then\n-\t\t # Extract the first word of \"gmsgfmt\", so it can be a program name with args.\n+\n+\t     # Extract the first word of \"gmsgfmt\", so it can be a program name with args.\n set dummy gmsgfmt; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:6212: checking for $ac_word\" >&5\n-if eval \"test \\\"`echo '$''{'gcc_cv_path_GMSGFMT'+set}'`\\\" = set\"; then\n+echo \"configure:6316: checking for $ac_word\" >&5\n+if eval \"test \\\"`echo '$''{'ac_cv_path_GMSGFMT'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   case \"$GMSGFMT\" in\n   /*)\n-  gcc_cv_path_GMSGFMT=\"$GMSGFMT\" # Let the user override the test with a path.\n+  ac_cv_path_GMSGFMT=\"$GMSGFMT\" # Let the user override the test with a path.\n   ;;\n   ?:/*)\t\t\t \n-  gcc_cv_path_GMSGFMT=\"$GMSGFMT\" # Let the user override the test with a dos path.\n+  ac_cv_path_GMSGFMT=\"$GMSGFMT\" # Let the user override the test with a dos path.\n   ;;\n   *)\n   IFS=\"${IFS= \t}\"; ac_save_ifs=\"$IFS\"; IFS=\":\"\n   ac_dummy=\"$PATH\"\n   for ac_dir in $ac_dummy; do \n     test -z \"$ac_dir\" && ac_dir=.\n     if test -f $ac_dir/$ac_word; then\n-      gcc_cv_path_GMSGFMT=\"$ac_dir/$ac_word\"\n+      ac_cv_path_GMSGFMT=\"$ac_dir/$ac_word\"\n       break\n     fi\n   done\n   IFS=\"$ac_save_ifs\"\n-  test -z \"$gcc_cv_path_GMSGFMT\" && gcc_cv_path_GMSGFMT=\"no\"\n+  test -z \"$ac_cv_path_GMSGFMT\" && ac_cv_path_GMSGFMT=\"$MSGFMT\"\n   ;;\n esac\n fi\n-GMSGFMT=\"$gcc_cv_path_GMSGFMT\"\n+GMSGFMT=\"$ac_cv_path_GMSGFMT\"\n if test -n \"$GMSGFMT\"; then\n   echo \"$ac_t\"\"$GMSGFMT\" 1>&6\n else\n   echo \"$ac_t\"\"no\" 1>&6\n fi\n \n-\t\t if test \"$GMSGFMT\" = \"no\"; then\n-\t\t   # Extract the first word of \"msgfmt\", so it can be a program name with args.\n-set dummy msgfmt; ac_word=$2\n-echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:6249: checking for $ac_word\" >&5\n-if eval \"test \\\"`echo '$''{'gcc_cv_path_GMSGFMT'+set}'`\\\" = set\"; then\n-  echo $ac_n \"(cached) $ac_c\" 1>&6\n-else\n-  case \"$GMSGFMT\" in\n-  /*)\n-  gcc_cv_path_GMSGFMT=\"$GMSGFMT\" # Let the user override the test with a path.\n-  ;;\n-  *)\n-  IFS=\"${IFS= \t}\"; ac_save_ifs=\"$IFS\"; IFS=\"${IFS}:\"\n-  for ac_dir in $PATH; do\n-    test -z \"$ac_dir\" && ac_dir=.\n-    if test -f $ac_dir/$ac_word; then\n-      if test -z \"`$ac_dir/$ac_word -h 2>&1 | grep 'dv '`\"; then\n-\tgcc_cv_path_GMSGFMT=\"$ac_dir/$ac_word\"\n-\tbreak\n-      fi\n-    fi\n-  done\n-  IFS=\"$ac_save_ifs\"\n-  test -z \"$gcc_cv_path_GMSGFMT\" && gcc_cv_path_GMSGFMT=\"msgfmt\"\n-  ;;\n-esac\n-fi\n-GMSGFMT=\"$gcc_cv_path_GMSGFMT\"\n-if test -n \"$GMSGFMT\"; then\n-  echo \"$ac_t\"\"$GMSGFMT\" 1>&6\n-else\n-  echo \"$ac_t\"\"no\" 1>&6\n-fi\n \n-\t\t   if test \"$GMSGFMT\" = \"msgfmt\"; then\n-\t\t     create_catalogs=\"no\"\n-\t\t   fi\n-\t\t fi\n-\t\t # Extract the first word of \"xgettext\", so it can be a program name with args.\n+\t     \t     # Extract the first word of \"xgettext\", so it can be a program name with args.\n set dummy xgettext; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:6287: checking for $ac_word\" >&5\n-if eval \"test \\\"`echo '$''{'gcc_cv_path_XGETTEXT'+set}'`\\\" = set\"; then\n+echo \"configure:6353: checking for $ac_word\" >&5\n+if eval \"test \\\"`echo '$''{'ac_cv_path_XGETTEXT'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   case \"$XGETTEXT\" in\n   /*)\n-  gcc_cv_path_XGETTEXT=\"$XGETTEXT\" # Let the user override the test with a path.\n+  ac_cv_path_XGETTEXT=\"$XGETTEXT\" # Let the user override the test with a path.\n   ;;\n   *)\n   IFS=\"${IFS= \t}\"; ac_save_ifs=\"$IFS\"; IFS=\"${IFS}:\"\n   for ac_dir in $PATH; do\n     test -z \"$ac_dir\" && ac_dir=.\n     if test -f $ac_dir/$ac_word; then\n-      if test -z \"`$ac_dir/$ac_word -h 2>&1 | grep '(HELP)'`\"; then\n-\tgcc_cv_path_XGETTEXT=\"$ac_dir/$ac_word\"\n+      if $ac_dir/$ac_word --omit-header /dev/null >/dev/null 2>&1; then\n+\tac_cv_path_XGETTEXT=\"$ac_dir/$ac_word\"\n \tbreak\n       fi\n     fi\n   done\n   IFS=\"$ac_save_ifs\"\n-  test -z \"$gcc_cv_path_XGETTEXT\" && gcc_cv_path_XGETTEXT=\":\"\n+  test -z \"$ac_cv_path_XGETTEXT\" && ac_cv_path_XGETTEXT=\":\"\n   ;;\n esac\n fi\n-XGETTEXT=\"$gcc_cv_path_XGETTEXT\"\n-if test -n \"$XGETTEXT\"; then\n+XGETTEXT=\"$ac_cv_path_XGETTEXT\"\n+if test \"$XGETTEXT\" != \":\"; then\n   echo \"$ac_t\"\"$XGETTEXT\" 1>&6\n else\n   echo \"$ac_t\"\"no\" 1>&6\n fi\n \n-\t\t USE_INCLUDED_LIBINTL=yes\n-\t\t CATOBJEXT=.cat\n-\t\t INSTOBJEXT=.cat\n-\t\t DATADIRNAME=lib\n-\t\t INTLDEPS='$(top_builddir)/intl/libintl.a'\n-\t\t INTLLIBS=$INTLDEPS\n-\t\t LIBS=`echo $LIBS | sed -e 's/-lintl//'`\n-\t\t nls_cv_header_intl=intl/libintl.h\n-\t\t nls_cv_header_libgt=intl/libgettext.h\n-\t       fi\n+\n+\t     CATOBJEXT=.gmo\n+\t   fi\n+\t\n else\n   echo \"$ac_t\"\"no\" 1>&6\n fi\n \n-\t  fi\n-        fi\n \n         if test \"$CATOBJEXT\" = \"NONE\"; then\n \t  \t  \t  nls_cv_use_gnu_gettext=yes\n@@ -6341,32 +6399,32 @@ fi\n         # Extract the first word of \"msgfmt\", so it can be a program name with args.\n set dummy msgfmt; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:6345: checking for $ac_word\" >&5\n-if eval \"test \\\"`echo '$''{'gcc_cv_path_MSGFMT'+set}'`\\\" = set\"; then\n+echo \"configure:6403: checking for $ac_word\" >&5\n+if eval \"test \\\"`echo '$''{'ac_cv_path_MSGFMT'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   case \"$MSGFMT\" in\n   /*)\n-  gcc_cv_path_MSGFMT=\"$MSGFMT\" # Let the user override the test with a path.\n+  ac_cv_path_MSGFMT=\"$MSGFMT\" # Let the user override the test with a path.\n   ;;\n   *)\n   IFS=\"${IFS= \t}\"; ac_save_ifs=\"$IFS\"; IFS=\"${IFS}:\"\n   for ac_dir in $PATH; do\n     test -z \"$ac_dir\" && ac_dir=.\n     if test -f $ac_dir/$ac_word; then\n-      if test -z \"`$ac_dir/$ac_word -h 2>&1 | grep 'dv '`\"; then\n-\tgcc_cv_path_MSGFMT=\"$ac_dir/$ac_word\"\n+      if $ac_dir/$ac_word --statistics /dev/null >/dev/null 2>&1; then\n+\tac_cv_path_MSGFMT=\"$ac_dir/$ac_word\"\n \tbreak\n       fi\n     fi\n   done\n   IFS=\"$ac_save_ifs\"\n-  test -z \"$gcc_cv_path_MSGFMT\" && gcc_cv_path_MSGFMT=\"msgfmt\"\n+  test -z \"$ac_cv_path_MSGFMT\" && ac_cv_path_MSGFMT=\":\"\n   ;;\n esac\n fi\n-MSGFMT=\"$gcc_cv_path_MSGFMT\"\n-if test -n \"$MSGFMT\"; then\n+MSGFMT=\"$ac_cv_path_MSGFMT\"\n+if test \"$MSGFMT\" != \":\"; then\n   echo \"$ac_t\"\"$MSGFMT\" 1>&6\n else\n   echo \"$ac_t\"\"no\" 1>&6\n@@ -6375,115 +6433,158 @@ fi\n         # Extract the first word of \"gmsgfmt\", so it can be a program name with args.\n set dummy gmsgfmt; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:6379: checking for $ac_word\" >&5\n-if eval \"test \\\"`echo '$''{'gcc_cv_path_GMSGFMT'+set}'`\\\" = set\"; then\n+echo \"configure:6437: checking for $ac_word\" >&5\n+if eval \"test \\\"`echo '$''{'ac_cv_path_GMSGFMT'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   case \"$GMSGFMT\" in\n   /*)\n-  gcc_cv_path_GMSGFMT=\"$GMSGFMT\" # Let the user override the test with a path.\n+  ac_cv_path_GMSGFMT=\"$GMSGFMT\" # Let the user override the test with a path.\n   ;;\n   ?:/*)\t\t\t \n-  gcc_cv_path_GMSGFMT=\"$GMSGFMT\" # Let the user override the test with a dos path.\n+  ac_cv_path_GMSGFMT=\"$GMSGFMT\" # Let the user override the test with a dos path.\n   ;;\n   *)\n   IFS=\"${IFS= \t}\"; ac_save_ifs=\"$IFS\"; IFS=\":\"\n   ac_dummy=\"$PATH\"\n   for ac_dir in $ac_dummy; do \n     test -z \"$ac_dir\" && ac_dir=.\n     if test -f $ac_dir/$ac_word; then\n-      gcc_cv_path_GMSGFMT=\"$ac_dir/$ac_word\"\n+      ac_cv_path_GMSGFMT=\"$ac_dir/$ac_word\"\n       break\n     fi\n   done\n   IFS=\"$ac_save_ifs\"\n-  test -z \"$gcc_cv_path_GMSGFMT\" && gcc_cv_path_GMSGFMT=\"$MSGFMT\"\n+  test -z \"$ac_cv_path_GMSGFMT\" && ac_cv_path_GMSGFMT=\"$MSGFMT\"\n   ;;\n esac\n fi\n-GMSGFMT=\"$gcc_cv_path_GMSGFMT\"\n+GMSGFMT=\"$ac_cv_path_GMSGFMT\"\n if test -n \"$GMSGFMT\"; then\n   echo \"$ac_t\"\"$GMSGFMT\" 1>&6\n else\n   echo \"$ac_t\"\"no\" 1>&6\n fi\n \n-                \tif test \"$MSGFMT\" = \"msgfmt\" && test \"$GMSGFMT\" = \"msgfmt\"; then\n-\t  create_catalogs=\"no\"\n-\tfi\n         # Extract the first word of \"xgettext\", so it can be a program name with args.\n set dummy xgettext; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:6418: checking for $ac_word\" >&5\n-if eval \"test \\\"`echo '$''{'gcc_cv_path_XGETTEXT'+set}'`\\\" = set\"; then\n+echo \"configure:6473: checking for $ac_word\" >&5\n+if eval \"test \\\"`echo '$''{'ac_cv_path_XGETTEXT'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   case \"$XGETTEXT\" in\n   /*)\n-  gcc_cv_path_XGETTEXT=\"$XGETTEXT\" # Let the user override the test with a path.\n+  ac_cv_path_XGETTEXT=\"$XGETTEXT\" # Let the user override the test with a path.\n   ;;\n   *)\n   IFS=\"${IFS= \t}\"; ac_save_ifs=\"$IFS\"; IFS=\"${IFS}:\"\n   for ac_dir in $PATH; do\n     test -z \"$ac_dir\" && ac_dir=.\n     if test -f $ac_dir/$ac_word; then\n-      if test -z \"`$ac_dir/$ac_word -h 2>&1 | grep '(HELP)'`\"; then\n-\tgcc_cv_path_XGETTEXT=\"$ac_dir/$ac_word\"\n+      if $ac_dir/$ac_word --omit-header /dev/null >/dev/null 2>&1; then\n+\tac_cv_path_XGETTEXT=\"$ac_dir/$ac_word\"\n \tbreak\n       fi\n     fi\n   done\n   IFS=\"$ac_save_ifs\"\n-  test -z \"$gcc_cv_path_XGETTEXT\" && gcc_cv_path_XGETTEXT=\":\"\n+  test -z \"$ac_cv_path_XGETTEXT\" && ac_cv_path_XGETTEXT=\":\"\n   ;;\n esac\n fi\n-XGETTEXT=\"$gcc_cv_path_XGETTEXT\"\n-if test -n \"$XGETTEXT\"; then\n+XGETTEXT=\"$ac_cv_path_XGETTEXT\"\n+if test \"$XGETTEXT\" != \":\"; then\n   echo \"$ac_t\"\"$XGETTEXT\" 1>&6\n else\n   echo \"$ac_t\"\"no\" 1>&6\n fi\n \n         \n+\tBUILD_INCLUDED_LIBINTL=yes\n \tUSE_INCLUDED_LIBINTL=yes\n         CATOBJEXT=.gmo\n-        INSTOBJEXT=.mo\n-        DATADIRNAME=share\n-\tINTLDEPS='$(top_builddir)/intl/libintl.a'\n-\tINTLLIBS=$INTLDEPS\n-\tLIBS=`echo $LIBS | sed -e 's/-lintl//'`\n-        nls_cv_header_intl=intl/libintl.h\n-        nls_cv_header_libgt=intl/libgettext.h\n+\tINTLLIBS=\"\\$(top_builddir)/intl/libintl.a $LIBICONV\"\n+\tLIBS=`echo \" $LIBS \" | sed -e 's/ -lintl / /' -e 's/^ //' -e 's/ $//'`\n+      fi\n+\n+                  if test \"$GMSGFMT\" != \":\"; then\n+\t\t\tif $GMSGFMT --statistics /dev/null >/dev/null 2>&1; then\n+\t  : ;\n+\telse\n+\t  echo \"$ac_t\"\"found msgfmt program is not GNU msgfmt; ignore it\" 1>&6\n+\t  GMSGFMT=\":\"\n+\tfi\n       fi\n \n-            if test \"$XGETTEXT\" != \":\"; then\n-\t\t\tif $XGETTEXT --omit-header /dev/null 2> /dev/null; then\n+                  if test \"$XGETTEXT\" != \":\"; then\n+\t\t\tif $XGETTEXT --omit-header /dev/null >/dev/null 2>&1; then\n \t  : ;\n \telse\n \t  echo \"$ac_t\"\"found xgettext program is not GNU xgettext; ignore it\" 1>&6\n \t  XGETTEXT=\":\"\n \tfi\n       fi\n \n+            POSUB=po\n+    fi\n+    \n \n \n-      # We need to process the po/ directory.\n-      POSUB=po\n-    else\n-      DATADIRNAME=share\n-      nls_cv_header_intl=intl/libintl.h\n-      nls_cv_header_libgt=intl/libgettext.h\n+            if test \"$PACKAGE\" = gettext; then\n+      BUILD_INCLUDED_LIBINTL=yes\n     fi\n-    \n-    \n \n+                                            for ac_prog in bison\n+do\n+# Extract the first word of \"$ac_prog\", so it can be a program name with args.\n+set dummy $ac_prog; ac_word=$2\n+echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n+echo \"configure:6544: checking for $ac_word\" >&5\n+if eval \"test \\\"`echo '$''{'ac_cv_prog_INTLBISON'+set}'`\\\" = set\"; then\n+  echo $ac_n \"(cached) $ac_c\" 1>&6\n+else\n+  if test -n \"$INTLBISON\"; then\n+  ac_cv_prog_INTLBISON=\"$INTLBISON\" # Let the user override the test.\n+else\n+  IFS=\"${IFS= \t}\"; ac_save_ifs=\"$IFS\"; IFS=\":\"\n+  ac_dummy=\"$PATH\"\n+  for ac_dir in $ac_dummy; do\n+    test -z \"$ac_dir\" && ac_dir=.\n+    if test -f $ac_dir/$ac_word; then\n+      ac_cv_prog_INTLBISON=\"$ac_prog\"\n+      break\n+    fi\n+  done\n+  IFS=\"$ac_save_ifs\"\n+fi\n+fi\n+INTLBISON=\"$ac_cv_prog_INTLBISON\"\n+if test -n \"$INTLBISON\"; then\n+  echo \"$ac_t\"\"$INTLBISON\" 1>&6\n+else\n+  echo \"$ac_t\"\"no\" 1>&6\n+fi\n+\n+test -n \"$INTLBISON\" && break\n+done\n \n-    # If this is used in GNU gettext we have to set USE_NLS to `yes'\n-    # because some of the sources are only built for this goal.\n-    if test \"$PACKAGE\" = gettext; then\n-      USE_NLS=yes\n-      USE_INCLUDED_LIBINTL=yes\n+    if test -z \"$INTLBISON\"; then\n+      ac_verc_fail=yes\n+    else\n+            echo $ac_n \"checking version of bison\"\"... $ac_c\" 1>&6\n+echo \"configure:6577: checking version of bison\" >&5\n+      ac_prog_version=`$INTLBISON --version 2>&1 | sed -n 's/^.*GNU Bison.* \\([0-9]*\\.[0-9.]*\\).*$/\\1/p'`\n+      case $ac_prog_version in\n+        '') ac_prog_version=\"v. ?.??, bad\"; ac_verc_fail=yes;;\n+        1.2[6-9]* | 1.[3-9][0-9]* | [2-9].*)\n+           ac_prog_version=\"$ac_prog_version, ok\"; ac_verc_fail=no;;\n+        *) ac_prog_version=\"$ac_prog_version, bad\"; ac_verc_fail=yes;;\n+      esac\n+      echo \"$ac_t\"\"$ac_prog_version\" 1>&6\n+    fi\n+    if test $ac_verc_fail = yes; then\n+      INTLBISON=:\n     fi\n \n                 for lang in $ALL_LINGUAS; do\n@@ -6500,31 +6601,44 @@ fi\n     \n     \n     \n+\n+        nls_cv_header_intl=\n+    nls_cv_header_libgt=\n+\n+        DATADIRNAME=share\n     \n+\n+        INSTOBJEXT=.mo\n     \n-  \n \n-   if test \"x$create_catalogs\" = \"xno\"; then\n-     echo \"configure: warning: No program for building catalogs found -> building disabled\" 1>&2\n-   fi\n+        GENCAT=gencat\n+    \n+  \n \n-   if test \"x$CATOBJEXT\" != \"x\" && test \"x$create_catalogs\" != \"xno\" ; then\n+   if test \"x$CATOBJEXT\" != \"x\"; then\n      if test \"x$ALL_LINGUAS\" = \"x\"; then\n        LINGUAS=\n      else\n        echo $ac_n \"checking for catalogs to be installed\"\"... $ac_c\" 1>&6\n-echo \"configure:6517: checking for catalogs to be installed\" >&5\n-       if test \"x$LINGUAS\" = \"x\"; then\n-\t LINGUAS=$ALL_LINGUAS\n-       else\n-\t NEW_LINGUAS=\n-\t for lang in $ALL_LINGUAS; do\n-\t   case \" $LINGUAS \" in\n-\t     *\" $lang \"*) NEW_LINGUAS=\"$NEW_LINGUAS $lang\" ;;\n-\t   esac\n-\t done\n-         LINGUAS=$NEW_LINGUAS\n-       fi\n+echo \"configure:6624: checking for catalogs to be installed\" >&5\n+       NEW_LINGUAS=\n+       for presentlang in $ALL_LINGUAS; do\n+         useit=no\n+         for desiredlang in ${LINGUAS-$ALL_LINGUAS}; do\n+           # Use the presentlang catalog if desiredlang is\n+           #   a. equal to presentlang, or\n+           #   b. a variant of presentlang (because in this case,\n+           #      presentlang can be used as a fallback for messages\n+           #      which are not translated in the desiredlang catalog).\n+           case \"$desiredlang\" in\n+             \"$presentlang\"*) useit=yes;;\n+           esac\n+         done\n+         if test $useit = yes; then\n+           NEW_LINGUAS=\"$NEW_LINGUAS $presentlang\"\n+         fi\n+       done\n+       LINGUAS=$NEW_LINGUAS\n        echo \"$ac_t\"\"$LINGUAS\" 1>&6\n      fi\n \n@@ -6533,66 +6647,6 @@ echo \"configure:6517: checking for catalogs to be installed\" >&5\n      fi\n    fi\n \n-            if test $ac_cv_header_locale_h = yes; then\n-     INCLUDE_LOCALE_H=\"#include <locale.h>\"\n-   else\n-     INCLUDE_LOCALE_H=\"\\\n-/* The system does not provide the header <locale.h>.  Take care yourself.  */\"\n-   fi\n-   \n-\n-            test -d intl || mkdir intl\n-   if test \"$CATOBJEXT\" = \".cat\"; then\n-     ac_safe=`echo \"linux/version.h\" | sed 'y%./+-%__p_%'`\n-echo $ac_n \"checking for linux/version.h\"\"... $ac_c\" 1>&6\n-echo \"configure:6549: checking for linux/version.h\" >&5\n-if eval \"test \\\"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\\\" = set\"; then\n-  echo $ac_n \"(cached) $ac_c\" 1>&6\n-else\n-  cat > conftest.$ac_ext <<EOF\n-#line 6554 \"configure\"\n-#include \"confdefs.h\"\n-#include <linux/version.h>\n-EOF\n-ac_try=\"$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out\"\n-{ (eval echo configure:6559: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n-ac_err=`grep -v '^ *+' conftest.out | grep -v \"^conftest.${ac_ext}\\$\"`\n-if test -z \"$ac_err\"; then\n-  rm -rf conftest*\n-  eval \"ac_cv_header_$ac_safe=yes\"\n-else\n-  echo \"$ac_err\" >&5\n-  echo \"configure: failed program was:\" >&5\n-  cat conftest.$ac_ext >&5\n-  rm -rf conftest*\n-  eval \"ac_cv_header_$ac_safe=no\"\n-fi\n-rm -f conftest*\n-fi\n-if eval \"test \\\"`echo '$ac_cv_header_'$ac_safe`\\\" = yes\"; then\n-  echo \"$ac_t\"\"yes\" 1>&6\n-  msgformat=linux\n-else\n-  echo \"$ac_t\"\"no\" 1>&6\n-msgformat=xopen\n-fi\n-\n-\n-               sed -e '/^#/d' $srcdir/intl/$msgformat-msg.sed > intl/po2msg.sed\n-   fi\n-      sed -e '/^#.*[^\\\\]$/d' -e '/^#$/d' \\\n-     $srcdir/intl/po2tbl.sed.in > intl/po2tbl.sed\n-\n-            if test \"$PACKAGE\" = \"gettext\"; then\n-     GT_NO=\"#NO#\"\n-     GT_YES=\n-   else\n-     GT_NO=\n-     GT_YES=\"#YES#\"\n-   fi\n-   \n-   \n-\n             MKINSTALLDIRS=\n    if test -n \"$ac_aux_dir\"; then\n      MKINSTALLDIRS=\"$ac_aux_dir/mkinstalldirs\"\n@@ -6602,22 +6656,8 @@ fi\n    fi\n    \n \n-      l=\n+      INTL_LIBTOOL_SUFFIX_PREFIX=\n    \n-\n-         test -d po || mkdir po\n-   if test \"x$srcdir\" != \"x.\"; then\n-     if test \"x`echo $srcdir | sed 's@/.*@@'`\" = \"x\"; then\n-       posrcprefix=\"$srcdir/\"\n-     else\n-       posrcprefix=\"../$srcdir/\"\n-     fi\n-   else\n-     posrcprefix=\"../\"\n-   fi\n-   rm -f po/POTFILES\n-   sed -e \"/^#/d\" -e \"/^\\$/d\" -e \"s,.*,\t$posrcprefix& \\\\\\\\,\" -e \"\\$s/\\(.*\\) \\\\\\\\/\\1/\" \\\n-\t< $srcdir/po/POTFILES.in > po/POTFILES\n   \n XGETTEXT=\"AWK='$AWK' \\$(SHELL) \\$(top_srcdir)/exgettext $XGETTEXT\"\n \n@@ -6631,7 +6671,7 @@ fi\n case $host_os in\n \twin32 | pe | cygwin* | mingw32* | uwin*)\n echo $ac_n \"checking whether windows registry support is requested\"\"... $ac_c\" 1>&6\n-echo \"configure:6635: checking whether windows registry support is requested\" >&5\n+echo \"configure:6675: checking whether windows registry support is requested\" >&5\n if test \"x$enable_win32_registry\" != xno; then\n   cat >> confdefs.h <<\\EOF\n #define ENABLE_WIN32_REGISTRY 1\n@@ -6640,14 +6680,14 @@ EOF\n   echo \"$ac_t\"\"yes\" 1>&6\n   \n echo $ac_n \"checking for library containing RegOpenKeyExA\"\"... $ac_c\" 1>&6\n-echo \"configure:6644: checking for library containing RegOpenKeyExA\" >&5\n+echo \"configure:6684: checking for library containing RegOpenKeyExA\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_search_RegOpenKeyExA'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   ac_func_search_save_LIBS=\"$LIBS\"\n ac_cv_search_RegOpenKeyExA=\"no\"\n cat > conftest.$ac_ext <<EOF\n-#line 6651 \"configure\"\n+#line 6691 \"configure\"\n #include \"confdefs.h\"\n /* Override any gcc2 internal prototype to avoid an error.  */\n /* We use char because int might match the return type of a gcc2\n@@ -6658,7 +6698,7 @@ int main() {\n RegOpenKeyExA()\n ; return 0; }\n EOF\n-if { (eval echo configure:6662: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo configure:6702: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n   ac_cv_search_RegOpenKeyExA=\"none required\"\n else\n@@ -6669,7 +6709,7 @@ rm -f conftest*\n test \"$ac_cv_search_RegOpenKeyExA\" = \"no\" && for i in advapi32; do\n LIBS=\"-l$i  $ac_func_search_save_LIBS\"\n cat > conftest.$ac_ext <<EOF\n-#line 6673 \"configure\"\n+#line 6713 \"configure\"\n #include \"confdefs.h\"\n /* Override any gcc2 internal prototype to avoid an error.  */\n /* We use char because int might match the return type of a gcc2\n@@ -6680,7 +6720,7 @@ int main() {\n RegOpenKeyExA()\n ; return 0; }\n EOF\n-if { (eval echo configure:6684: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo configure:6724: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n   ac_cv_search_RegOpenKeyExA=\"-l$i\"\n break\n@@ -6722,7 +6762,7 @@ esac\n \n if test \"x$enable_win32_registry\" != xno; then\n   echo $ac_n \"checking registry key on windows hosts\"\"... $ac_c\" 1>&6\n-echo \"configure:6726: checking registry key on windows hosts\" >&5\n+echo \"configure:6766: checking registry key on windows hosts\" >&5\n   cat >> confdefs.h <<EOF\n #define WIN32_REGISTRY_KEY \"$gcc_cv_win32_registry_key\"\n EOF\n@@ -6905,7 +6945,7 @@ fi\n \n # Figure out what assembler we will be using.\n echo $ac_n \"checking what assembler to use\"\"... $ac_c\" 1>&6\n-echo \"configure:6909: checking what assembler to use\" >&5\n+echo \"configure:6949: checking what assembler to use\" >&5\n gcc_cv_as=\n gcc_cv_gas_major_version=\n gcc_cv_gas_minor_version=\n@@ -6990,7 +7030,7 @@ fi\n \n # Figure out what nm we will be using.\n echo $ac_n \"checking what nm to use\"\"... $ac_c\" 1>&6\n-echo \"configure:6994: checking what nm to use\" >&5\n+echo \"configure:7034: checking what nm to use\" >&5\n if test -x nm$host_exeext; then\n \tgcc_cv_nm=./nm$host_exeext\n elif test x$host = x$target; then\n@@ -7001,7 +7041,7 @@ echo \"$ac_t\"\"$gcc_cv_nm\" 1>&6\n \n # Figure out what assembler alignment features are present.\n echo $ac_n \"checking assembler alignment features\"\"... $ac_c\" 1>&6\n-echo \"configure:7005: checking assembler alignment features\" >&5\n+echo \"configure:7045: checking assembler alignment features\" >&5\n gcc_cv_as_alignment_features=none\n if test x$gcc_cv_gas_major_version != x -a x$gcc_cv_gas_minor_version != x; then\n \t# Gas version 2.6 and later support for .balign and .p2align.\n@@ -7049,7 +7089,7 @@ fi\n echo \"$ac_t\"\"$gcc_cv_as_alignment_features\" 1>&6\n \n echo $ac_n \"checking assembler subsection support\"\"... $ac_c\" 1>&6\n-echo \"configure:7053: checking assembler subsection support\" >&5\n+echo \"configure:7093: checking assembler subsection support\" >&5\n gcc_cv_as_subsections=no\n if test x$gcc_cv_gas_major_version != x -a x$gcc_cv_gas_minor_version != x; then\n   if test \"$gcc_cv_gas_major_version\" -eq 2 -a \"$gcc_cv_gas_minor_version\" -ge 9 -o \"$gcc_cv_gas_major_version\" -gt 2 && grep 'obj_format = elf' ../gas/Makefile > /dev/null; then\n@@ -7089,7 +7129,7 @@ fi\n echo \"$ac_t\"\"$gcc_cv_as_subsections\" 1>&6\n \n echo $ac_n \"checking assembler weak support\"\"... $ac_c\" 1>&6\n-echo \"configure:7093: checking assembler weak support\" >&5\n+echo \"configure:7133: checking assembler weak support\" >&5\n gcc_cv_as_weak=no\n if test x$gcc_cv_gas_major_version != x -a x$gcc_cv_gas_minor_version != x; then\n   if test \"$gcc_cv_gas_major_version\" -eq 2 -a \"$gcc_cv_gas_minor_version\" -ge 2 -o \"$gcc_cv_gas_major_version\" -gt 2; then\n@@ -7112,7 +7152,7 @@ fi\n echo \"$ac_t\"\"$gcc_cv_as_weak\" 1>&6\n \n echo $ac_n \"checking assembler hidden support\"\"... $ac_c\" 1>&6\n-echo \"configure:7116: checking assembler hidden support\" >&5\n+echo \"configure:7156: checking assembler hidden support\" >&5\n gcc_cv_as_hidden=no\n if test x$gcc_cv_gas_major_version != x -a x$gcc_cv_gas_minor_version != x; then\n   if test \"$gcc_cv_gas_major_version\" -eq 2 -a \"$gcc_cv_gas_minor_version\" -ge 10 -o \"$gcc_cv_gas_major_version\" -gt 2 && grep 'obj_format = elf' ../gas/Makefile > /dev/null; then\n@@ -7136,7 +7176,7 @@ fi\n echo \"$ac_t\"\"$gcc_cv_as_hidden\" 1>&6\n \n echo $ac_n \"checking assembler leb128 support\"\"... $ac_c\" 1>&6\n-echo \"configure:7140: checking assembler leb128 support\" >&5\n+echo \"configure:7180: checking assembler leb128 support\" >&5\n gcc_cv_as_leb128=no\n if test x$gcc_cv_gas_major_version != x -a x$gcc_cv_gas_minor_version != x; then\n   if test \"$gcc_cv_gas_major_version\" -eq 2 -a \"$gcc_cv_gas_minor_version\" -ge 11 -o \"$gcc_cv_gas_major_version\" -gt 2 && grep 'obj_format = elf' ../gas/Makefile > /dev/null; then\n@@ -7181,7 +7221,7 @@ fi\n echo \"$ac_t\"\"$gcc_cv_as_leb128\" 1>&6\n \n echo $ac_n \"checking assembler eh_frame optimization\"\"... $ac_c\" 1>&6\n-echo \"configure:7185: checking assembler eh_frame optimization\" >&5\n+echo \"configure:7225: checking assembler eh_frame optimization\" >&5\n gcc_cv_as_eh_frame=no\n if test x$gcc_cv_gas_major_version != x -a x$gcc_cv_gas_minor_version != x; then\n   if test \"$gcc_cv_gas_major_version\" -eq 2 -a \"$gcc_cv_gas_minor_version\" -ge 12 -o \"$gcc_cv_gas_major_version\" -gt 2 && grep 'obj_format = elf' ../gas/Makefile > /dev/null; then\n@@ -7262,7 +7302,7 @@ fi\n echo \"$ac_t\"\"$gcc_cv_as_eh_frame\" 1>&6\n \n echo $ac_n \"checking assembler section merging support\"\"... $ac_c\" 1>&6\n-echo \"configure:7266: checking assembler section merging support\" >&5\n+echo \"configure:7306: checking assembler section merging support\" >&5\n gcc_cv_as_shf_merge=no\n if test x$gcc_cv_gas_major_version != x -a x$gcc_cv_gas_minor_version != x; then\n   if test \"$gcc_cv_gas_major_version\" -eq 2 -a \"$gcc_cv_gas_minor_version\" -ge 12 -o \"$gcc_cv_gas_major_version\" -gt 2 && grep 'obj_format = elf' ../gas/Makefile > /dev/null; then\n@@ -7287,7 +7327,7 @@ echo \"$ac_t\"\"$gcc_cv_as_shf_merge\" 1>&6\n case \"$target\" in \n   sparc*-*-*)\n     echo $ac_n \"checking assembler .register pseudo-op support\"\"... $ac_c\" 1>&6\n-echo \"configure:7291: checking assembler .register pseudo-op support\" >&5\n+echo \"configure:7331: checking assembler .register pseudo-op support\" >&5\n if eval \"test \\\"`echo '$''{'gcc_cv_as_register_pseudo_op'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -7315,7 +7355,7 @@ EOF\n     fi\n \n     echo $ac_n \"checking assembler supports -relax\"\"... $ac_c\" 1>&6\n-echo \"configure:7319: checking assembler supports -relax\" >&5\n+echo \"configure:7359: checking assembler supports -relax\" >&5\n if eval \"test \\\"`echo '$''{'gcc_cv_as_relax_opt'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -7345,7 +7385,7 @@ EOF\n     case \"$tm_file\" in\n     *64*)\n \techo $ac_n \"checking for 64 bit support in assembler ($gcc_cv_as)\"\"... $ac_c\" 1>&6\n-echo \"configure:7349: checking for 64 bit support in assembler ($gcc_cv_as)\" >&5\n+echo \"configure:7389: checking for 64 bit support in assembler ($gcc_cv_as)\" >&5\n if eval \"test \\\"`echo '$''{'gcc_cv_as_flags64'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -7390,7 +7430,7 @@ EOF\n \n     if test \"x$gcc_cv_as_flags64\" != xno; then\n \techo $ac_n \"checking for assembler offsetable %lo() support\"\"... $ac_c\" 1>&6\n-echo \"configure:7394: checking for assembler offsetable %lo() support\" >&5\n+echo \"configure:7434: checking for assembler offsetable %lo() support\" >&5\n if eval \"test \\\"`echo '$''{'gcc_cv_as_offsetable_lo10'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -7430,7 +7470,7 @@ EOF\n \n   i[34567]86-*-*)\n     echo $ac_n \"checking assembler instructions\"\"... $ac_c\" 1>&6\n-echo \"configure:7434: checking assembler instructions\" >&5\n+echo \"configure:7474: checking assembler instructions\" >&5\n     gcc_cv_as_instructions=\n     if test x$gcc_cv_gas_major_version != x -a x$gcc_cv_gas_minor_version != x; then\n       if test \"$gcc_cv_gas_major_version\" -eq 2 -a \"$gcc_cv_gas_minor_version\" -ge 9 -o \"$gcc_cv_gas_major_version\" -gt 2; then\n@@ -7459,7 +7499,7 @@ EOF\n esac\n \n echo $ac_n \"checking assembler dwarf2 debug_line support\"\"... $ac_c\" 1>&6\n-echo \"configure:7463: checking assembler dwarf2 debug_line support\" >&5\n+echo \"configure:7503: checking assembler dwarf2 debug_line support\" >&5\n gcc_cv_as_dwarf2_debug_line=no\n # ??? Not all targets support dwarf2 debug_line, even within a version\n # of gas.  Moreover, we need to emit a valid instruction to trigger any\n@@ -7651,7 +7691,7 @@ fi\n \n \n echo $ac_n \"checking whether to enable maintainer-specific portions of Makefiles\"\"... $ac_c\" 1>&6\n-echo \"configure:7655: checking whether to enable maintainer-specific portions of Makefiles\" >&5\n+echo \"configure:7695: checking whether to enable maintainer-specific portions of Makefiles\" >&5\n     # Check whether --enable-maintainer-mode or --disable-maintainer-mode was given.\n if test \"${enable_maintainer_mode+set}\" = set; then\n   enableval=\"$enable_maintainer_mode\"\n@@ -8182,27 +8222,27 @@ s%@objext@%$objext%g\n s%@PACKAGE@%$PACKAGE%g\n s%@VERSION@%$VERSION%g\n s%@CHECK_PO@%$CHECK_PO%g\n+s%@ALLOCA@%$ALLOCA%g\n+s%@GLIBC21@%$GLIBC21%g\n s%@USE_NLS@%$USE_NLS%g\n s%@MSGFMT@%$MSGFMT%g\n s%@GMSGFMT@%$GMSGFMT%g\n s%@XGETTEXT@%$XGETTEXT%g\n-s%@GENCAT@%$GENCAT%g\n+s%@INTLBISON@%$INTLBISON%g\n+s%@BUILD_INCLUDED_LIBINTL@%$BUILD_INCLUDED_LIBINTL%g\n s%@USE_INCLUDED_LIBINTL@%$USE_INCLUDED_LIBINTL%g\n s%@CATALOGS@%$CATALOGS%g\n s%@CATOBJEXT@%$CATOBJEXT%g\n-s%@DATADIRNAME@%$DATADIRNAME%g\n s%@GMOFILES@%$GMOFILES%g\n-s%@INSTOBJEXT@%$INSTOBJEXT%g\n-s%@INTLDEPS@%$INTLDEPS%g\n s%@INTLLIBS@%$INTLLIBS%g\n s%@INTLOBJS@%$INTLOBJS%g\n s%@POFILES@%$POFILES%g\n s%@POSUB@%$POSUB%g\n-s%@INCLUDE_LOCALE_H@%$INCLUDE_LOCALE_H%g\n-s%@GT_NO@%$GT_NO%g\n-s%@GT_YES@%$GT_YES%g\n+s%@DATADIRNAME@%$DATADIRNAME%g\n+s%@INSTOBJEXT@%$INSTOBJEXT%g\n+s%@GENCAT@%$GENCAT%g\n s%@MKINSTALLDIRS@%$MKINSTALLDIRS%g\n-s%@l@%$l%g\n+s%@INTL_LIBTOOL_SUFFIX_PREFIX@%$INTL_LIBTOOL_SUFFIX_PREFIX%g\n s%@inhibit_libc@%$inhibit_libc%g\n s%@gthread_flags@%$gthread_flags%g\n s%@GGC@%$GGC%g\n@@ -8490,51 +8530,6 @@ cat >> $CONFIG_STATUS <<\\EOF\n   fi\n fi; done\n \n-EOF\n-\n-cat >> $CONFIG_STATUS <<EOF\n-ac_sources=\"$nls_cv_header_libgt\"\n-ac_dests=\"$nls_cv_header_intl\"\n-EOF\n-\n-cat >> $CONFIG_STATUS <<\\EOF\n-srcdir=$ac_given_srcdir\n-while test -n \"$ac_sources\"; do\n-  set $ac_dests; ac_dest=$1; shift; ac_dests=$*\n-  set $ac_sources; ac_source=$1; shift; ac_sources=$*\n-\n-  echo \"linking $srcdir/$ac_source to $ac_dest\"\n-\n-  if test ! -r $srcdir/$ac_source; then\n-    { echo \"configure: error: $srcdir/$ac_source: File not found\" 1>&2; exit 1; }\n-  fi\n-  rm -f $ac_dest\n-\n-  # Make relative symlinks.\n-  # Remove last slash and all that follows it.  Not all systems have dirname.\n-  ac_dest_dir=`echo $ac_dest|sed 's%/[^/][^/]*$%%'`\n-  if test \"$ac_dest_dir\" != \"$ac_dest\" && test \"$ac_dest_dir\" != .; then\n-    # The dest file is in a subdirectory.\n-    test ! -d \"$ac_dest_dir\" && mkdir \"$ac_dest_dir\"\n-    ac_dest_dir_suffix=\"/`echo $ac_dest_dir|sed 's%^\\./%%'`\"\n-    # A \"../\" for each directory in $ac_dest_dir_suffix.\n-    ac_dots=`echo $ac_dest_dir_suffix|sed 's%/[^/]*%../%g'`\n-  else\n-    ac_dest_dir_suffix= ac_dots=\n-  fi\n-\n-  case \"$srcdir\" in\n-  [/$]*) ac_rel_source=\"$srcdir/$ac_source\" ;;\n-  *) ac_rel_source=\"$ac_dots$srcdir/$ac_source\" ;;\n-  esac\n-\n-  # Make a symlink if possible; otherwise try a hard link.\n-  if ln -s $ac_rel_source $ac_dest 2>/dev/null ||\n-    ln $srcdir/$ac_source $ac_dest; then :\n-  else\n-    { echo \"configure: error: can not link $ac_dest to $srcdir/$ac_source\" 1>&2; exit 1; }\n-  fi\n-done\n EOF\n cat >> $CONFIG_STATUS <<EOF\n \n@@ -8574,9 +8569,35 @@ cpp_install_dir='${cpp_install_dir}'\n \n EOF\n cat >> $CONFIG_STATUS <<\\EOF\n-case \"$CONFIG_FILES\" in *po/Makefile.in*)\n-        sed -e \"/POTFILES =/r po/POTFILES\" po/Makefile.in > po/Makefile\n-      esac\n+for ac_file in $CONFIG_FILES; do\n+        # Support \"outfile[:infile[:infile...]]\"\n+        case \"$ac_file\" in\n+          *:*) ac_file=`echo \"$ac_file\"|sed 's%:.*%%'` ;;\n+        esac\n+        # PO directories have a Makefile.in generated from Makefile.in.in.\n+        case \"$ac_file\" in */Makefile.in)\n+          # Adjust a relative srcdir.\n+          ac_dir=`echo \"$ac_file\"|sed 's%/[^/][^/]*$%%'`\n+          ac_dir_suffix=\"/`echo \"$ac_dir\"|sed 's%^\\./%%'`\"\n+          ac_dots=`echo \"$ac_dir_suffix\"|sed 's%/[^/]*%../%g'`\n+          # In autoconf-2.13 it is called $ac_given_srcdir.\n+          # In autoconf-2.50 it is called $srcdir.\n+          test -n \"$ac_given_srcdir\" || ac_given_srcdir=\"$srcdir\"\n+          case \"$ac_given_srcdir\" in\n+            .)  top_srcdir=`echo $ac_dots|sed 's%/$%%'` ;;\n+            /*) top_srcdir=\"$ac_given_srcdir\" ;;\n+            *)  top_srcdir=\"$ac_dots$ac_given_srcdir\" ;;\n+          esac\n+          if test -f \"$ac_given_srcdir/$ac_dir/POTFILES.in\"; then\n+            rm -f \"$ac_dir/POTFILES\"\n+            test -n \"$as_me\" && echo \"$as_me: creating $ac_dir/POTFILES\" || echo \"creating $ac_dir/POTFILES\"\n+            sed -e \"/^#/d\" -e \"/^[ \t]*\\$/d\" -e \"s,.*,     $top_srcdir/& \\\\\\\\,\" -e \"\\$s/\\(.*\\) \\\\\\\\/\\1/\" < \"$ac_given_srcdir/$ac_dir/POTFILES.in\" > \"$ac_dir/POTFILES\"\n+            test -n \"$as_me\" && echo \"$as_me: creating $ac_dir/Makefile\" || echo \"creating $ac_dir/Makefile\"\n+            sed -e \"/POTFILES =/r $ac_dir/POTFILES\" \"$ac_dir/Makefile.in\" > \"$ac_dir/Makefile\"\n+          fi\n+          ;;\n+        esac\n+      done\n \n case x$CONFIG_HEADERS in\n xauto-host.h:config.in)"}, {"sha": "f1ea4e4cf8b1c73796b583fb574508889e251738", "filename": "gcc/configure.in", "status": "modified", "additions": 0, "deletions": 9, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fconfigure.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fconfigure.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfigure.in?ref=71a94577632a238bf4e112f0f016819ead09f1d5", "patch": "@@ -922,15 +922,6 @@ if test \"${build}\" != \"${host}\" && test \"x$enable_nls\" = \"xyes\"; then\n   enable_nls=no\n fi\n \n-# if NLS is enabled, also enable check in po subdir\n-if test $enable_nls = yes; then\n-  CHECK_PO=check-po\n-else\n-  CHECK_PO=\"\"\n-fi\n-\n-AC_SUBST(CHECK_PO)\n-\n AM_GNU_GETTEXT\n XGETTEXT=\"AWK='$AWK' \\$(SHELL) \\$(top_srcdir)/exgettext $XGETTEXT\"\n "}, {"sha": "b2018b84ec4602b1853d8f43c094d85ce75b621e", "filename": "gcc/intl/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fintl%2FChangeLog?ref=71a94577632a238bf4e112f0f016819ead09f1d5", "patch": "@@ -1,3 +1,12 @@\n+2001-10-12  Zack Weinberg  <zack@codesourcery.com>\n+\n+\t* Update entire directory from gettext 0.10.40.\n+\t* cat-compat.c, linux-msg.sed, po2tbl.sed.in, xopen-msg.sed:\n+\tRemoved.\n+\t* config.charset, dcigettext.c, dcngettext.c, libgnuintl.h,\n+\tlocalcharset.c, locale.alias, ngettext.c, plural.c, plural.y,\n+\tref-add.sin, ref-del.sin: New.\n+\n 2001-07-06  Roman Lechtchinsky  <rl@cs.tu-berlin.de>\n \n \t* gettextP.h (SWAP): Change parameter type to unsigned int."}, {"sha": "acf050d59afe8bbb5e46a3cb388758de40910b32", "filename": "gcc/intl/Makefile.in", "status": "modified", "additions": 172, "deletions": 77, "changes": 249, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fintl%2FMakefile.in?ref=71a94577632a238bf4e112f0f016819ead09f1d5", "patch": "@@ -1,19 +1,20 @@\n # Makefile for directory with message catalog handling in GNU NLS Utilities.\n-# Copyright (C) 1995, 1996, 1997 Free Software Foundation, Inc.\n+# Copyright (C) 1995-1998, 2000, 2001 Free Software Foundation, Inc.\n #\n-# This program is free software; you can redistribute it and/or modify\n-# it under the terms of the GNU General Public License as published by\n-# the Free Software Foundation; either version 2, or (at your option)\n+# This program is free software; you can redistribute it and/or modify it\n+# under the terms of the GNU Library General Public License as published\n+# by the Free Software Foundation; either version 2, or (at your option)\n # any later version.\n #\n # This program is distributed in the hope that it will be useful,\n # but WITHOUT ANY WARRANTY; without even the implied warranty of\n-# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n-# GNU General Public License for more details.\n+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+# Library General Public License for more details.\n #\n-# You should have received a copy of the GNU General Public License\n-# along with this program; if not, write to the Free Software\n-# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.\n+# You should have received a copy of the GNU Library General Public\n+# License along with this program; if not, write to the Free Software\n+# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307,\n+# USA.\n \n PACKAGE = @PACKAGE@\n VERSION = @VERSION@\n@@ -28,113 +29,178 @@ VPATH = @srcdir@\n prefix = @prefix@\n exec_prefix = @exec_prefix@\n transform = @program_transform_name@\n-libdir = $(exec_prefix)/lib\n-includedir = $(prefix)/include\n-datadir = $(prefix)/@DATADIRNAME@\n+libdir = @libdir@\n+includedir = @includedir@\n+datadir = @datadir@\n localedir = $(datadir)/locale\n-gnulocaledir = $(prefix)/share/locale\n-gettextsrcdir = @datadir@/gettext/intl\n-aliaspath = $(localedir):.\n+gettextsrcdir = $(datadir)/gettext/intl\n+aliaspath = $(localedir)\n subdir = intl\n \n INSTALL = @INSTALL@\n INSTALL_DATA = @INSTALL_DATA@\n MKINSTALLDIRS = @MKINSTALLDIRS@\n+mkinstalldirs = $(SHELL) `case \"$(MKINSTALLDIRS)\" in /*) echo \"$(MKINSTALLDIRS)\" ;; *) echo \"$(top_builddir)/$(MKINSTALLDIRS)\" ;; esac`\n \n-l = @l@\n+l = @INTL_LIBTOOL_SUFFIX_PREFIX@\n \n AR = ar\n CC = @CC@\n LIBTOOL = @LIBTOOL@\n RANLIB = @RANLIB@\n+YACC = @INTLBISON@ -y -d\n+YFLAGS = --name-prefix=__gettext\n \n-DEFS = -DIN_GCC -DLOCALEDIR=\\\"$(localedir)\\\" -DGNULOCALEDIR=\\\"$(gnulocaledir)\\\" \\\n--DLOCALE_ALIAS_PATH=\\\"$(aliaspath)\\\" @DEFS@\n+DEFS = -DIN_GCC -DLOCALEDIR=\\\"$(localedir)\\\" -DLOCALE_ALIAS_PATH=\\\"$(aliaspath)\\\" \\\n+-DLIBDIR=\\\"$(libdir)\\\" @DEFS@\n CPPFLAGS = @CPPFLAGS@\n CFLAGS = @CFLAGS@\n LDFLAGS = @LDFLAGS@\n \n COMPILE = $(CC) -c $(DEFS) $(INCLUDES) $(CPPFLAGS) $(CFLAGS) $(XCFLAGS)\n \n-HEADERS = $(COMHDRS) libgettext.h loadinfo.h\n+HEADERS = $(COMHDRS) libgnuintl.h libgettext.h loadinfo.h\n COMHDRS = gettext.h gettextP.h hash-string.h\n-SOURCES = $(COMSRCS) intl-compat.c cat-compat.c\n+SOURCES = $(COMSRCS) intl-compat.c\n COMSRCS = bindtextdom.c dcgettext.c dgettext.c gettext.c \\\n finddomain.c loadmsgcat.c localealias.c textdomain.c l10nflist.c \\\n-explodename.c\n+explodename.c dcigettext.c dcngettext.c dngettext.c ngettext.c plural.y \\\n+localcharset.c\n OBJECTS = @INTLOBJS@ bindtextdom.$lo dcgettext.$lo dgettext.$lo gettext.$lo \\\n finddomain.$lo loadmsgcat.$lo localealias.$lo textdomain.$lo l10nflist.$lo \\\n-explodename.$lo\n-CATOBJS = cat-compat.$lo ../po/cat-id-tbl.$lo\n+explodename.$lo dcigettext.$lo dcngettext.$lo dngettext.$lo ngettext.$lo \\\n+plural.$lo localcharset.$lo\n GETTOBJS = intl-compat.$lo\n-DISTFILES.common = ChangeLog Makefile.in linux-msg.sed po2tbl.sed.in \\\n-xopen-msg.sed $(HEADERS) $(SOURCES)\n+DISTFILES.common = Makefile.in \\\n+config.charset locale.alias ref-add.sin ref-del.sin $(HEADERS) $(SOURCES)\n+DISTFILES.generated = plural.c\n DISTFILES.normal = VERSION\n-DISTFILES.gettext = libintl.glibc intlh.inst.in\n+DISTFILES.gettext = COPYING.LIB-2 COPYING.LIB-2.1 libintl.glibc\n+DISTFILES.obsolete = xopen-msg.sed linux-msg.sed po2tbl.sed.in cat-compat.c\n+\n+# Libtool's library version information for libintl.\n+# Before making a gettext release, the gettext maintainer must change this\n+# according to the libtool documentation, section \"Library interface versions\".\n+# Maintainers of other packages that include the intl directory must *not*\n+# change these values.\n+LTV_CURRENT=1\n+LTV_REVISION=1\n+LTV_AGE=0\n \n .SUFFIXES:\n-.SUFFIXES: .c .o .lo\n+.SUFFIXES: .c .y .o .lo .sin .sed\n .c.o:\n \t$(COMPILE) $<\n .c.lo:\n \t$(LIBTOOL) --mode=compile $(COMPILE) $<\n \n-INCLUDES = -I.. -I. -I$(top_srcdir)/intl -I$(top_srcdir)/lib -I$(srcdir)/.. \\\n--I$(srcdir)/../config -I$(srcdir)/../../include\n+.y.c:\n+\t$(YACC) $(YFLAGS) --output $@ $<\n+\trm -f $*.h\n \n-all: all-@USE_INCLUDED_LIBINTL@\n+.sin.sed:\n+\tsed -e '/^#/d' -e 's/@''PACKAGE''@/@PACKAGE@/g' $< > t-$@\n+\tmv t-$@ $@\n+\n+INCLUDES = -I.. -I. -I$(top_srcdir)/intl -I$(top_srcdir) \\\n+\t   -I$(top_srcdir)/config -I$(top_srcdir)/../include\n \n-all-yes: libintl.$la intlh.inst\n-all-no:\n+all: all-@USE_INCLUDED_LIBINTL@\n+all-yes: libintl.$la libintl.h charset.alias ref-add.sed ref-del.sed\n+all-no: all-no-@BUILD_INCLUDED_LIBINTL@\n+all-no-yes: libgnuintl.$la\n+all-no-no:\n \n-libintl.a: $(OBJECTS)\n+libintl.a libgnuintl.a: $(OBJECTS)\n \trm -f $@\n \t$(AR) cru $@ $(OBJECTS)\n \t$(RANLIB) $@\n \n-libintl.la: $(OBJECTS)\n-\t$(LIBTOOL) --mode=link $(CC) $(LDFLAGS) -o $@ $(OBJECTS) \\\n-\t\t   -version-info 1:0 -rpath $(libdir)\n+libintl.la libgnuintl.la: $(OBJECTS)\n+\t$(LIBTOOL) --mode=link \\\n+\t  $(CC) $(CPPFLAGS) $(CFLAGS) $(XCFLAGS) $(LDFLAGS) -o $@ \\\n+\t  $(OBJECTS) @LIBICONV@ \\\n+\t  -version-info $(LTV_CURRENT):$(LTV_REVISION):$(LTV_AGE) \\\n+\t  -rpath $(libdir) \\\n+\t  -no-undefined\n+\n+libintl.h: libgnuintl.h\n+\tcp $(srcdir)/libgnuintl.h libintl.h\n \n-../po/cat-id-tbl.$lo: ../po/cat-id-tbl.c $(top_srcdir)/po/$(PACKAGE).pot\n-\tcd ../po && $(MAKE) cat-id-tbl.$lo\n+charset.alias: config.charset\n+\t$(SHELL) $(srcdir)/config.charset '@host@' > t-$@\n+\tmv t-$@ $@\n \n check: all\n \n # This installation goal is only used in GNU gettext.  Packages which\n # only use the library should use install instead.\n \n # We must not install the libintl.h/libintl.a files if we are on a\n-# system which has the gettext() function in its C library or in a\n-# separate library or use the catgets interface.  A special case is\n-# where configure found a previously installed GNU gettext library.\n+# system which has the GNU gettext() function in its C library or in a\n+# separate library.\n # If you want to use the one which comes with this version of the\n # package, you have to use `configure --with-included-gettext'.\n install: install-exec install-data\n install-exec: all\n \tif test \"$(PACKAGE)\" = \"gettext\" \\\n \t   && test '@INTLOBJS@' = '$(GETTOBJS)'; then \\\n-\t  if test -r $(MKINSTALLDIRS); then \\\n-\t    $(MKINSTALLDIRS) $(libdir) $(includedir); \\\n+\t  $(mkinstalldirs) $(DESTDIR)$(libdir) $(DESTDIR)$(includedir); \\\n+\t  $(INSTALL_DATA) libintl.h $(DESTDIR)$(includedir)/libintl.h; \\\n+\t  $(LIBTOOL) --mode=install \\\n+\t    $(INSTALL_DATA) libintl.$la $(DESTDIR)$(libdir)/libintl.$la; \\\n+\telse \\\n+\t  : ; \\\n+\tfi\n+\tif test '@USE_INCLUDED_LIBINTL@' = yes; then \\\n+\t  $(mkinstalldirs) $(DESTDIR)$(libdir); \\\n+\t  temp=$(DESTDIR)$(libdir)/t-charset.alias; \\\n+\t  dest=$(DESTDIR)$(libdir)/charset.alias; \\\n+\t  if test -f $(DESTDIR)$(libdir)/charset.alias; then \\\n+\t    orig=$(DESTDIR)$(libdir)/charset.alias; \\\n+\t    sed -f ref-add.sed $$orig > $$temp; \\\n+\t    $(INSTALL_DATA) $$temp $$dest; \\\n+\t    rm -f $$temp; \\\n \t  else \\\n-\t    $(top_srcdir)/mkinstalldirs $(libdir) $(includedir); \\\n+\t    if test @GLIBC21@ = no; then \\\n+\t      orig=charset.alias; \\\n+\t      sed -f ref-add.sed $$orig > $$temp; \\\n+\t      $(INSTALL_DATA) $$temp $$dest; \\\n+\t      rm -f $$temp; \\\n+\t    fi; \\\n \t  fi; \\\n-\t  $(INSTALL_DATA) intlh.inst $(includedir)/libintl.h; \\\n-\t  $(INSTALL_DATA) libintl.a $(libdir)/libintl.a; \\\n+\t  $(mkinstalldirs) $(DESTDIR)$(localedir); \\\n+\t  test -f $(DESTDIR)$(localedir)/locale.alias \\\n+\t    && orig=$(DESTDIR)$(localedir)/locale.alias \\\n+\t    || orig=$(srcdir)/locale.alias; \\\n+\t  temp=$(DESTDIR)$(localedir)/t-locale.alias; \\\n+\t  dest=$(DESTDIR)$(localedir)/locale.alias; \\\n+\t  sed -f ref-add.sed $$orig > $$temp; \\\n+\t  $(INSTALL_DATA) $$temp $$dest; \\\n+\t  rm -f $$temp; \\\n \telse \\\n \t  : ; \\\n \tfi\n install-data: all\n \tif test \"$(PACKAGE)\" = \"gettext\"; then \\\n-\t  if test -r $(MKINSTALLDIRS); then \\\n-\t    $(MKINSTALLDIRS) $(gettextsrcdir); \\\n-\t  else \\\n-\t    $(top_srcdir)/mkinstalldirs $(gettextsrcdir); \\\n-\t  fi; \\\n-\t  $(INSTALL_DATA) VERSION $(gettextsrcdir)/VERSION; \\\n-\t  dists=\"$(DISTFILES.common)\"; \\\n+\t  $(mkinstalldirs) $(DESTDIR)$(gettextsrcdir); \\\n+\t  $(INSTALL_DATA) VERSION $(DESTDIR)$(gettextsrcdir)/VERSION; \\\n+\t  $(INSTALL_DATA) ChangeLog.inst $(DESTDIR)$(gettextsrcdir)/ChangeLog; \\\n+\t  dists=\"COPYING.LIB-2 COPYING.LIB-2.1 $(DISTFILES.common)\"; \\\n+\t  for file in $$dists; do \\\n+\t    $(INSTALL_DATA) $(srcdir)/$$file \\\n+\t\t\t    $(DESTDIR)$(gettextsrcdir)/$$file; \\\n+\t  done; \\\n+\t  chmod a+x $(DESTDIR)$(gettextsrcdir)/config.charset; \\\n+\t  dists=\"$(DISTFILES.generated)\"; \\\n \t  for file in $$dists; do \\\n-\t    $(INSTALL_DATA) $(srcdir)/$$file $(gettextsrcdir)/$$file; \\\n+\t    if test -f $$file; then dir=.; else dir=$(srcdir); fi; \\\n+\t    $(INSTALL_DATA) $$dir/$$file \\\n+\t\t\t    $(DESTDIR)$(gettextsrcdir)/$$file; \\\n+\t  done; \\\n+\t  dists=\"$(DISTFILES.obsolete)\"; \\\n+\t  for file in $$dists; do \\\n+\t    rm -f $(DESTDIR)$(gettextsrcdir)/$$file; \\\n \t  done; \\\n \telse \\\n \t  : ; \\\n@@ -144,18 +210,51 @@ install-data: all\n installcheck:\n \n uninstall:\n+\tif test \"$(PACKAGE)\" = \"gettext\" \\\n+\t   && test '@INTLOBJS@' = '$(GETTOBJS)'; then \\\n+\t  rm -f $(DESTDIR)$(includedir)/libintl.h; \\\n+\t  $(LIBTOOL) --mode=uninstall \\\n+\t    rm -f $(DESTDIR)$(libdir)/libintl.$la; \\\n+\telse \\\n+\t  : ; \\\n+\tfi\n+\tif test '@USE_INCLUDED_LIBINTL@' = yes; then \\\n+\t  if test -f $(DESTDIR)$(libdir)/charset.alias; then \\\n+\t    temp=$(DESTDIR)$(libdir)/t-charset.alias; \\\n+\t    dest=$(DESTDIR)$(libdir)/charset.alias; \\\n+\t    sed -f ref-del.sed $$dest > $$temp; \\\n+\t    if grep '^# Packages using this file: $$' $$temp > /dev/null; then \\\n+\t      rm -f $$dest; \\\n+\t    else \\\n+\t      $(INSTALL_DATA) $$temp $$dest; \\\n+\t    fi; \\\n+\t    rm -f $$temp; \\\n+\t  fi; \\\n+\t  if test -f $(DESTDIR)$(localedir)/locale.alias; then \\\n+\t    temp=$(DESTDIR)$(localedir)/t-locale.alias; \\\n+\t    dest=$(DESTDIR)$(localedir)/locale.alias; \\\n+\t    sed -f ref-del.sed $$dest > $$temp; \\\n+\t    if grep '^# Packages using this file: $$' $$temp > /dev/null; then \\\n+\t      rm -f $$dest; \\\n+\t    else \\\n+\t      $(INSTALL_DATA) $$temp $$dest; \\\n+\t    fi; \\\n+\t    rm -f $$temp; \\\n+\t  fi; \\\n+\telse \\\n+\t  : ; \\\n+\tfi\n \tif test \"$(PACKAGE)\" = \"gettext\"; then \\\n-\t  dists=\"$(DISTFILES.common)\"; \\\n-\t  for file in $$dists; do \\\n-\t    rm -f $(gettextsrcdir)/$$file; \\\n+\t  for file in VERSION ChangeLog COPYING.LIB-2 COPYING.LIB-2.1 $(DISTFILES.common) $(DISTFILES.generated); do \\\n+\t    rm -f $(DESTDIR)$(gettextsrcdir)/$$file; \\\n \t  done; \\\n \telse \\\n \t  : ; \\\n \tfi\n \n info dvi:\n \n-$(OBJECTS): ../config.h libgettext.h\n+$(OBJECTS): ../config.h libgnuintl.h\n bindtextdom.$lo finddomain.$lo loadmsgcat.$lo: gettextP.h gettext.h loadinfo.h\n dcgettext.$lo: gettextP.h gettext.h hash-string.h loadinfo.h\n \n@@ -171,12 +270,19 @@ ID: $(HEADERS) $(SOURCES)\n \n \n mostlyclean:\n-\trm -f *.a *.o *.lo core core.*\n+\trm -f *.a *.la *.o *.lo core core.*\n+\trm -f libintl.h charset.alias ref-add.sed ref-del.sed\n+\trm -f -r .libs _libs\n \n clean: mostlyclean\n \n distclean: clean\n-\trm -f Makefile ID TAGS po2msg.sed po2tbl.sed\n+\trm -f Makefile ID TAGS\n+\tif test \"$(PACKAGE)\" = gettext; then \\\n+\t  rm -f ChangeLog.inst $(DISTFILES.normal); \\\n+\telse \\\n+\t  : ; \\\n+\tfi\n \n maintainer-clean: distclean\n \t@echo \"This command is intended for maintainers to use;\"\n@@ -186,34 +292,23 @@ maintainer-clean: distclean\n # GNU gettext needs not contain the file `VERSION' but contains some\n # other files which should not be distributed in other packages.\n distdir = ../$(PACKAGE)-$(VERSION)/$(subdir)\n-dist distdir: Makefile $(DISTFILES)\n+dist distdir: Makefile\n \tif test \"$(PACKAGE)\" = gettext; then \\\n \t  additional=\"$(DISTFILES.gettext)\"; \\\n \telse \\\n \t  additional=\"$(DISTFILES.normal)\"; \\\n \tfi; \\\n-\tfor file in $(DISTFILES.common) $$additional; do \\\n-\t  ln $(srcdir)/$$file $(distdir) 2> /dev/null \\\n-\t    || cp -p $(srcdir)/$$file $(distdir); \\\n+\t$(MAKE) $(DISTFILES.common) $(DISTFILES.generated) $$additional; \\\n+\tfor file in ChangeLog $(DISTFILES.common) $(DISTFILES.generated) $$additional; do \\\n+\t  if test -f $$file; then dir=.; else dir=$(srcdir); fi; \\\n+\t  ln $$dir/$$file $(distdir) 2> /dev/null \\\n+\t    || cp -p $$dir/$$file $(distdir); \\\n \tdone\n \n-dist-libc:\n-\ttar zcvf intl-glibc.tar.gz $(COMSRCS) $(COMHDRS) libintl.h.glibc\n-\n Makefile: Makefile.in ../config.status\n \tcd .. \\\n \t  && CONFIG_FILES=$(subdir)/$@ CONFIG_HEADERS= $(SHELL) ./config.status\n \n-# The dependency for intlh.inst is different in gettext and all other\n-# packages.  Because we cannot you GNU make features we have to solve\n-# the problem while rewriting Makefile.in.\n-@GT_YES@intlh.inst: intlh.inst.in ../config.status\n-@GT_YES@\tcd .. \\\n-@GT_YES@\t&& CONFIG_FILES=$(subdir)/$@ CONFIG_HEADERS= \\\n-@GT_YES@\t  $(SHELL) ./config.status\n-@GT_NO@.PHONY: intlh.inst\n-@GT_NO@intlh.inst:\n-\n # Tell versions [3.59,3.63) of GNU make not to export all variables.\n # Otherwise a system limit (for SysV at least) may be exceeded.\n .NOEXPORT:"}, {"sha": "cb8a01a78115bcb8969c79fc7aee7f412bcdbc5e", "filename": "gcc/intl/VERSION", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2FVERSION", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2FVERSION", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fintl%2FVERSION?ref=71a94577632a238bf4e112f0f016819ead09f1d5", "patch": "@@ -1 +1 @@\n-GNU gettext library from gettext-0.10.35\n+GNU gettext library from gettext-0.10.40"}, {"sha": "c6a9bd1643e7e0ac2a620c63277f94c8f3da9f97", "filename": "gcc/intl/bindtextdom.c", "status": "modified", "additions": 243, "deletions": 85, "changes": 328, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Fbindtextdom.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Fbindtextdom.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fintl%2Fbindtextdom.c?ref=71a94577632a238bf4e112f0f016819ead09f1d5", "patch": "@@ -1,50 +1,45 @@\n /* Implementation of the bindtextdomain(3) function\n-   Copyright (C) 1995, 1996, 1997, 1998 Free Software Foundation, Inc.\n+   Copyright (C) 1995-1998, 2000, 2001 Free Software Foundation, Inc.\n \n-   This program is free software; you can redistribute it and/or modify\n-   it under the terms of the GNU General Public License as published by\n-   the Free Software Foundation; either version 2, or (at your option)\n+   This program is free software; you can redistribute it and/or modify it\n+   under the terms of the GNU Library General Public License as published\n+   by the Free Software Foundation; either version 2, or (at your option)\n    any later version.\n \n    This program is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n-   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n-   GNU General Public License for more details.\n+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+   Library General Public License for more details.\n \n-   You should have received a copy of the GNU General Public License\n-   along with this program; if not, write to the Free Software Foundation,\n-   Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.  */\n+   You should have received a copy of the GNU Library General Public\n+   License along with this program; if not, write to the Free Software\n+   Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307,\n+   USA.  */\n \n #ifdef HAVE_CONFIG_H\n # include <config.h>\n #endif\n \n-#if defined STDC_HEADERS || defined _LIBC\n-# include <stdlib.h>\n-#else\n-# ifdef HAVE_MALLOC_H\n-#  include <malloc.h>\n-# else\n-void free ();\n-# endif\n-#endif\n+#include <stddef.h>\n+#include <stdlib.h>\n+#include <string.h>\n \n-#if defined HAVE_STRING_H || defined _LIBC\n-# include <string.h>\n+#ifdef _LIBC\n+# include <libintl.h>\n #else\n-# include <strings.h>\n-# ifndef memcpy\n-#  define memcpy(Dst, Src, Num) bcopy (Src, Dst, Num)\n-# endif\n+# include \"libgnuintl.h\"\n #endif\n+#include \"gettextP.h\"\n \n #ifdef _LIBC\n-# include <libintl.h>\n+/* We have to handle multi-threaded applications.  */\n+# include <bits/libc-lock.h>\n #else\n-# include \"libgettext.h\"\n+/* Provide dummy implementation if this is outside glibc.  */\n+# define __libc_rwlock_define(CLASS, NAME)\n+# define __libc_rwlock_wrlock(NAME)\n+# define __libc_rwlock_unlock(NAME)\n #endif\n-#include \"gettext.h\"\n-#include \"gettextP.h\"\n \n /* The internal variables in the standalone libintl.a must have different\n    names than the internal variables in GNU libc, otherwise programs\n@@ -54,6 +49,11 @@ void free ();\n # define _nl_domain_bindings _nl_domain_bindings__\n #endif\n \n+/* Some compilers, like SunOS4 cc, don't have offsetof in <stddef.h>.  */\n+#ifndef offsetof\n+# define offsetof(type,ident) ((size_t)&(((type*)0)->ident))\n+#endif\n+\n /* @@ end of prolog @@ */\n \n /* Contains the default location of the message catalogs.  */\n@@ -62,32 +62,58 @@ extern const char _nl_default_dirname[];\n /* List with bindings of specific domains.  */\n extern struct binding *_nl_domain_bindings;\n \n+/* Lock variable to protect the global data in the gettext implementation.  */\n+__libc_rwlock_define (extern, _nl_state_lock)\n+\n \n /* Names for the libintl functions are a problem.  They must not clash\n    with existing names and they should follow ANSI C.  But this source\n    code is also used in GNU C Library where the names have a __\n    prefix.  So we have to make a difference here.  */\n #ifdef _LIBC\n # define BINDTEXTDOMAIN __bindtextdomain\n+# define BIND_TEXTDOMAIN_CODESET __bind_textdomain_codeset\n # ifndef strdup\n #  define strdup(str) __strdup (str)\n # endif\n #else\n # define BINDTEXTDOMAIN bindtextdomain__\n+# define BIND_TEXTDOMAIN_CODESET bind_textdomain_codeset__\n #endif\n \n-/* Specify that the DOMAINNAME message catalog will be found\n-   in DIRNAME rather than in the system locale data base.  */\n-char *\n-BINDTEXTDOMAIN (domainname, dirname)\n+/* Prototypes for local functions.  */\n+static void set_binding_values PARAMS ((const char *domainname,\n+\t\t\t\t\tconst char **dirnamep,\n+\t\t\t\t\tconst char **codesetp));\n+     \n+/* Specifies the directory name *DIRNAMEP and the output codeset *CODESETP\n+   to be used for the DOMAINNAME message catalog.\n+   If *DIRNAMEP or *CODESETP is NULL, the corresponding attribute is not\n+   modified, only the current value is returned.\n+   If DIRNAMEP or CODESETP is NULL, the corresponding attribute is neither\n+   modified nor returned.  */\n+static void\n+set_binding_values (domainname, dirnamep, codesetp)\n      const char *domainname;\n-     const char *dirname;\n+     const char **dirnamep;\n+     const char **codesetp;\n {\n   struct binding *binding;\n+  int modified;\n \n   /* Some sanity checks.  */\n   if (domainname == NULL || domainname[0] == '\\0')\n-    return NULL;\n+    {\n+      if (dirnamep)\n+\t*dirnamep = NULL;\n+      if (codesetp)\n+\t*codesetp = NULL;\n+      return;\n+    }\n+\n+  __libc_rwlock_wrlock (_nl_state_lock);\n+\n+  modified = 0;\n \n   for (binding = _nl_domain_bindings; binding != NULL; binding = binding->next)\n     {\n@@ -103,83 +129,173 @@ BINDTEXTDOMAIN (domainname, dirname)\n \t}\n     }\n \n-  if (dirname == NULL)\n-    /* The current binding has be to returned.  */\n-    return binding == NULL ? (char *) _nl_default_dirname : binding->dirname;\n-\n   if (binding != NULL)\n     {\n-      /* The domain is already bound.  If the new value and the old\n-\t one are equal we simply do nothing.  Otherwise replace the\n-\t old binding.  */\n-      if (strcmp (dirname, binding->dirname) != 0)\n+      if (dirnamep)\n \t{\n-\t  char *new_dirname;\n+\t  const char *dirname = *dirnamep;\n \n-\t  if (strcmp (dirname, _nl_default_dirname) == 0)\n-\t    new_dirname = (char *) _nl_default_dirname;\n+\t  if (dirname == NULL)\n+\t    /* The current binding has be to returned.  */\n+\t    *dirnamep = binding->dirname;\n \t  else\n \t    {\n+\t      /* The domain is already bound.  If the new value and the old\n+\t\t one are equal we simply do nothing.  Otherwise replace the\n+\t\t old binding.  */\n+\t      char *result = binding->dirname;\n+\t      if (strcmp (dirname, result) != 0)\n+\t\t{\n+\t\t  if (strcmp (dirname, _nl_default_dirname) == 0)\n+\t\t    result = (char *) _nl_default_dirname;\n+\t\t  else\n+\t\t    {\n #if defined _LIBC || defined HAVE_STRDUP\n-\t      new_dirname = strdup (dirname);\n-\t      if (new_dirname == NULL)\n-\t\treturn NULL;\n+\t\t      result = strdup (dirname);\n #else\n-\t      size_t len = strlen (dirname) + 1;\n-\t      new_dirname = (char *) malloc (len);\n-\t      if (new_dirname == NULL)\n-\t\treturn NULL;\n-\n-\t      memcpy (new_dirname, dirname, len);\n+\t\t      size_t len = strlen (dirname) + 1;\n+\t\t      result = (char *) malloc (len);\n+\t\t      if (__builtin_expect (result != NULL, 1))\n+\t\t\tmemcpy (result, dirname, len);\n #endif\n+\t\t    }\n+\n+\t\t  if (__builtin_expect (result != NULL, 1))\n+\t\t    {\n+\t\t      if (binding->dirname != _nl_default_dirname)\n+\t\t\tfree (binding->dirname);\n+\n+\t\t      binding->dirname = result;\n+\t\t      modified = 1;\n+\t\t    }\n+\t\t}\n+\t      *dirnamep = result;\n \t    }\n+\t}\n \n-\t  if (binding->dirname != _nl_default_dirname)\n-\t    free (binding->dirname);\n+      if (codesetp)\n+\t{\n+\t  const char *codeset = *codesetp;\n \n-\t  binding->dirname = new_dirname;\n+\t  if (codeset == NULL)\n+\t    /* The current binding has be to returned.  */\n+\t    *codesetp = binding->codeset;\n+\t  else\n+\t    {\n+\t      /* The domain is already bound.  If the new value and the old\n+\t\t one are equal we simply do nothing.  Otherwise replace the\n+\t\t old binding.  */\n+\t      char *result = binding->codeset;\n+\t      if (result == NULL || strcmp (codeset, result) != 0)\n+\t\t{\n+#if defined _LIBC || defined HAVE_STRDUP\n+\t\t  result = strdup (codeset);\n+#else\n+\t\t  size_t len = strlen (codeset) + 1;\n+\t\t  result = (char *) malloc (len);\n+\t\t  if (__builtin_expect (result != NULL, 1))\n+\t\t    memcpy (result, codeset, len);\n+#endif\n+\n+\t\t  if (__builtin_expect (result != NULL, 1))\n+\t\t    {\n+\t\t      if (binding->codeset != NULL)\n+\t\t\tfree (binding->codeset);\n+\n+\t\t      binding->codeset = result;\n+\t\t      binding->codeset_cntr++;\n+\t\t      modified = 1;\n+\t\t    }\n+\t\t}\n+\t      *codesetp = result;\n+\t    }\n \t}\n     }\n+  else if ((dirnamep == NULL || *dirnamep == NULL)\n+\t   && (codesetp == NULL || *codesetp == NULL))\n+    {\n+      /* Simply return the default values.  */\n+      if (dirnamep)\n+\t*dirnamep = _nl_default_dirname;\n+      if (codesetp)\n+\t*codesetp = NULL;\n+    }\n   else\n     {\n       /* We have to create a new binding.  */\n-#if !defined _LIBC && !defined HAVE_STRDUP\n-      size_t len;\n-#endif\n+      size_t len = strlen (domainname) + 1;\n       struct binding *new_binding =\n-\t(struct binding *) malloc (sizeof (*new_binding));\n+\t(struct binding *) malloc (offsetof (struct binding, domainname) + len);\n \n-      if (new_binding == NULL)\n-\treturn NULL;\n+      if (__builtin_expect (new_binding == NULL, 0))\n+\tgoto failed;\n \n+      memcpy (new_binding->domainname, domainname, len);\n+\n+      if (dirnamep)\n+\t{\n+\t  const char *dirname = *dirnamep;\n+\n+\t  if (dirname == NULL)\n+\t    /* The default value.  */\n+\t    dirname = _nl_default_dirname;\n+\t  else\n+\t    {\n+\t      if (strcmp (dirname, _nl_default_dirname) == 0)\n+\t\tdirname = _nl_default_dirname;\n+\t      else\n+\t\t{\n+\t\t  char *result;\n #if defined _LIBC || defined HAVE_STRDUP\n-      new_binding->domainname = strdup (domainname);\n-      if (new_binding->domainname == NULL)\n-\treturn NULL;\n+\t\t  result = strdup (dirname);\n+\t\t  if (__builtin_expect (result == NULL, 0))\n+\t\t    goto failed_dirname;\n #else\n-      len = strlen (domainname) + 1;\n-      new_binding->domainname = (char *) malloc (len);\n-      if (new_binding->domainname == NULL)\n-\treturn NULL;\n-      memcpy (new_binding->domainname, domainname, len);\n+\t\t  size_t len = strlen (dirname) + 1;\n+\t\t  result = (char *) malloc (len);\n+\t\t  if (__builtin_expect (result == NULL, 0))\n+\t\t    goto failed_dirname;\n+\t\t  memcpy (result, dirname, len);\n #endif\n-\n-      if (strcmp (dirname, _nl_default_dirname) == 0)\n-\tnew_binding->dirname = (char *) _nl_default_dirname;\n+\t\t  dirname = result;\n+\t\t}\n+\t    }\n+\t  *dirnamep = dirname;\n+\t  new_binding->dirname = (char *) dirname;\n+\t}\n       else\n+\t/* The default value.  */\n+\tnew_binding->dirname = (char *) _nl_default_dirname;\n+\n+      new_binding->codeset_cntr = 0;\n+\n+      if (codesetp)\n \t{\n+\t  const char *codeset = *codesetp;\n+\n+\t  if (codeset != NULL)\n+\t    {\n+\t      char *result;\n+\n #if defined _LIBC || defined HAVE_STRDUP\n-\t  new_binding->dirname = strdup (dirname);\n-\t  if (new_binding->dirname == NULL)\n-\t    return NULL;\n+\t      result = strdup (codeset);\n+\t      if (__builtin_expect (result == NULL, 0))\n+\t\tgoto failed_codeset;\n #else\n-\t  len = strlen (dirname) + 1;\n-\t  new_binding->dirname = (char *) malloc (len);\n-\t  if (new_binding->dirname == NULL)\n-\t    return NULL;\n-\t  memcpy (new_binding->dirname, dirname, len);\n+\t      size_t len = strlen (codeset) + 1;\n+\t      result = (char *) malloc (len);\n+\t      if (__builtin_expect (result == NULL, 0))\n+\t\tgoto failed_codeset;\n+\t      memcpy (result, codeset, len);\n #endif\n+\t      codeset = result;\n+\t      new_binding->codeset_cntr++;\n+\t    }\n+\t  *codesetp = codeset;\n+\t  new_binding->codeset = (char *) codeset;\n \t}\n+      else\n+\tnew_binding->codeset = NULL;\n \n       /* Now enqueue it.  */\n       if (_nl_domain_bindings == NULL\n@@ -199,13 +315,55 @@ BINDTEXTDOMAIN (domainname, dirname)\n \t  binding->next = new_binding;\n \t}\n \n-      binding = new_binding;\n+      modified = 1;\n+\n+      /* Here we deal with memory allocation failures.  */\n+      if (0)\n+\t{\n+\tfailed_codeset:\n+\t  if (new_binding->dirname != _nl_default_dirname)\n+\t    free (new_binding->dirname);\n+\tfailed_dirname:\n+\t  free (new_binding);\n+\tfailed:\n+\t  if (dirnamep)\n+\t    *dirnamep = NULL;\n+\t  if (codesetp)\n+\t    *codesetp = NULL;\n+\t}\n     }\n \n-  return binding->dirname;\n+  /* If we modified any binding, we flush the caches.  */\n+  if (modified)\n+    ++_nl_msg_cat_cntr;\n+\n+  __libc_rwlock_unlock (_nl_state_lock);\n+}\n+\n+/* Specify that the DOMAINNAME message catalog will be found\n+   in DIRNAME rather than in the system locale data base.  */\n+char *\n+BINDTEXTDOMAIN (domainname, dirname)\n+     const char *domainname;\n+     const char *dirname;\n+{\n+  set_binding_values (domainname, &dirname, NULL);\n+  return (char *) dirname;\n+}\n+\n+/* Specify the character encoding in which the messages from the\n+   DOMAINNAME message catalog will be returned.  */\n+char *\n+BIND_TEXTDOMAIN_CODESET (domainname, codeset)\n+     const char *domainname;\n+     const char *codeset;\n+{\n+  set_binding_values (domainname, NULL, &codeset);\n+  return (char *) codeset;\n }\n \n #ifdef _LIBC\n-/* Alias for function name in GNU C Library.  */\n+/* Aliases for function names in GNU C Library.  */\n weak_alias (__bindtextdomain, bindtextdomain);\n+weak_alias (__bind_textdomain_codeset, bind_textdomain_codeset);\n #endif"}, {"sha": "867d901b8ffc53d52a2fde6b1812adf88f97d9e7", "filename": "gcc/intl/cat-compat.c", "status": "removed", "additions": 0, "deletions": 262, "changes": 262, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7e21622e0e580b065224125cc6085b9f0559293a/gcc%2Fintl%2Fcat-compat.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7e21622e0e580b065224125cc6085b9f0559293a/gcc%2Fintl%2Fcat-compat.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fintl%2Fcat-compat.c?ref=7e21622e0e580b065224125cc6085b9f0559293a", "patch": "@@ -1,262 +0,0 @@\n-/* Compatibility code for gettext-using-catgets interface.\n-   Copyright (C) 1995, 1997 Free Software Foundation, Inc.\n-\n-   This program is free software; you can redistribute it and/or modify\n-   it under the terms of the GNU General Public License as published by\n-   the Free Software Foundation; either version 2, or (at your option)\n-   any later version.\n-\n-   This program is distributed in the hope that it will be useful,\n-   but WITHOUT ANY WARRANTY; without even the implied warranty of\n-   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n-   GNU General Public License for more details.\n-\n-   You should have received a copy of the GNU General Public License\n-   along with this program; if not, write to the Free Software Foundation,\n-   Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.  */\n-\n-#ifdef HAVE_CONFIG_H\n-# include <config.h>\n-#endif\n-\n-#include <stdio.h>\n-\n-#ifdef STDC_HEADERS\n-# include <stdlib.h>\n-# include <string.h>\n-#else\n-char *getenv ();\n-# ifdef HAVE_MALLOC_H\n-#  include <malloc.h>\n-# endif\n-#endif\n-\n-#ifdef HAVE_NL_TYPES_H\n-# include <nl_types.h>\n-#endif\n-\n-#include \"libgettext.h\"\n-\n-/* @@ end of prolog @@ */\n-\n-/* XPG3 defines the result of `setlocale (category, NULL)' as:\n-   ``Directs `setlocale()' to query `category' and return the current\n-     setting of `local'.''\n-   However it does not specify the exact format.  And even worse: POSIX\n-   defines this not at all.  So we can use this feature only on selected\n-   system (e.g. those using GNU C Library).  */\n-#ifdef _LIBC\n-# define HAVE_LOCALE_NULL\n-#endif\n-\n-/* The catalog descriptor.  */\n-static nl_catd catalog = (nl_catd) -1;\n-\n-/* Name of the default catalog.  */\n-static const char default_catalog_name[] = \"messages\";\n-\n-/* Name of currently used catalog.  */\n-static const char *catalog_name = default_catalog_name;\n-\n-/* Get ID for given string.  If not found return -1.  */\n-static int msg_to_cat_id PARAMS ((const char *msg));\n-\n-/* Substitution for systems lacking this function in their C library.  */\n-#if !_LIBC && !HAVE_STPCPY\n-static char *stpcpy PARAMS ((char *dest, const char *src));\n-#endif\n-\n-\n-/* Set currently used domain/catalog.  */\n-char *\n-textdomain (domainname)\n-     const char *domainname;\n-{\n-  nl_catd new_catalog;\n-  char *new_name;\n-  size_t new_name_len;\n-  char *lang;\n-\n-#if defined HAVE_SETLOCALE && defined HAVE_LC_MESSAGES \\\n-    && defined HAVE_LOCALE_NULL\n-  lang = setlocale (LC_MESSAGES, NULL);\n-#else\n-  lang = getenv (\"LC_ALL\");\n-  if (lang == NULL || lang[0] == '\\0')\n-    {\n-      lang = getenv (\"LC_MESSAGES\");\n-      if (lang == NULL || lang[0] == '\\0')\n-\tlang = getenv (\"LANG\");\n-    }\n-#endif\n-  if (lang == NULL || lang[0] == '\\0')\n-    lang = \"C\";\n-\n-  /* See whether name of currently used domain is asked.  */\n-  if (domainname == NULL)\n-    return (char *) catalog_name;\n-\n-  if (domainname[0] == '\\0')\n-    domainname = default_catalog_name;\n-\n-  /* Compute length of added path element.  */\n-  new_name_len = sizeof (LOCALEDIR) - 1 + 1 + strlen (lang)\n-\t\t + sizeof (\"/LC_MESSAGES/\") - 1 + sizeof (PACKAGE) - 1\n-\t\t + sizeof (\".cat\");\n-\n-  new_name = (char *) malloc (new_name_len);\n-  if (new_name == NULL)\n-    return NULL;\n-\n-  strcpy (new_name, PACKAGE);\n-  new_catalog = catopen (new_name, 0);\n-\n-  if (new_catalog == (nl_catd) -1)\n-    {\n-      /* NLSPATH search didn't work, try absolute path */\n-      sprintf (new_name, \"%s/%s/LC_MESSAGES/%s.cat\", LOCALEDIR, lang,\n-\t       PACKAGE);\n-      new_catalog = catopen (new_name, 0);\n-\n-      if (new_catalog == (nl_catd) -1)\n-\t{\n-\t  free (new_name);\n-\t  return (char *) catalog_name;\n-\t}\n-    }\n-\n-  /* Close old catalog.  */\n-  if (catalog != (nl_catd) -1)\n-    catclose (catalog);\n-  if (catalog_name != default_catalog_name)\n-    free ((char *) catalog_name);\n-\n-  catalog = new_catalog;\n-  catalog_name = new_name;\n-\n-  return (char *) catalog_name;\n-}\n-\n-char *\n-bindtextdomain (domainname, dirname)\n-     const char *domainname;\n-     const char *dirname;\n-{\n-#if HAVE_SETENV || HAVE_PUTENV\n-  char *old_val, *new_val, *cp;\n-  size_t new_val_len;\n-\n-  /* This does not make much sense here but to be compatible do it.  */\n-  if (domainname == NULL)\n-    return NULL;\n-\n-  /* Compute length of added path element.  If we use setenv we don't need\n-     the first byts for NLSPATH=, but why complicate the code for this\n-     peanuts.  */\n-  new_val_len = sizeof (\"NLSPATH=\") - 1 + strlen (dirname)\n-\t\t+ sizeof (\"/%L/LC_MESSAGES/%N.cat\");\n-\n-  old_val = getenv (\"NLSPATH\");\n-  if (old_val == NULL || old_val[0] == '\\0')\n-    {\n-      old_val = NULL;\n-      new_val_len += 1 + sizeof (LOCALEDIR) - 1\n-\t             + sizeof (\"/%L/LC_MESSAGES/%N.cat\");\n-    }\n-  else\n-    new_val_len += strlen (old_val);\n-\n-  new_val = (char *) malloc (new_val_len);\n-  if (new_val == NULL)\n-    return NULL;\n-\n-# if HAVE_SETENV\n-  cp = new_val;\n-# else\n-  cp = stpcpy (new_val, \"NLSPATH=\");\n-# endif\n-\n-  cp = stpcpy (cp, dirname);\n-  cp = stpcpy (cp, \"/%L/LC_MESSAGES/%N.cat:\");\n-\n-  if (old_val == NULL)\n-    {\n-# if __STDC__\n-      stpcpy (cp, LOCALEDIR \"/%L/LC_MESSAGES/%N.cat\");\n-# else\n-\n-      cp = stpcpy (cp, LOCALEDIR);\n-      stpcpy (cp, \"/%L/LC_MESSAGES/%N.cat\");\n-# endif\n-    }\n-  else\n-    stpcpy (cp, old_val);\n-\n-# if HAVE_SETENV\n-  setenv (\"NLSPATH\", new_val, 1);\n-  free (new_val);\n-# else\n-  putenv (new_val);\n-  /* Do *not* free the environment entry we just entered.  It is used\n-     from now on.   */\n-# endif\n-\n-#endif\n-\n-  return (char *) domainname;\n-}\n-\n-#undef gettext\n-char *\n-gettext (msg)\n-     const char *msg;\n-{\n-  int msgid;\n-\n-  if (msg == NULL || catalog == (nl_catd) -1)\n-    return (char *) msg;\n-\n-  /* Get the message from the catalog.  We always use set number 1.\n-     The message ID is computed by the function `msg_to_cat_id'\n-     which works on the table generated by `po-to-tbl'.  */\n-  msgid = msg_to_cat_id (msg);\n-  if (msgid == -1)\n-    return (char *) msg;\n-\n-  return catgets (catalog, 1, msgid, (char *) msg);\n-}\n-\n-/* Look through the table `_msg_tbl' which has `_msg_tbl_length' entries\n-   for the one equal to msg.  If it is found return the ID.  In case when\n-   the string is not found return -1.  */\n-static int\n-msg_to_cat_id (msg)\n-     const char *msg;\n-{\n-  int cnt;\n-\n-  for (cnt = 0; cnt < _msg_tbl_length; ++cnt)\n-    if (strcmp (msg, _msg_tbl[cnt]._msg) == 0)\n-      return _msg_tbl[cnt]._msg_number;\n-\n-  return -1;\n-}\n-\n-\n-/* @@ begin of epilog @@ */\n-\n-/* We don't want libintl.a to depend on any other library.  So we\n-   avoid the non-standard function stpcpy.  In GNU C Library this\n-   function is available, though.  Also allow the symbol HAVE_STPCPY\n-   to be defined.  */\n-#if !_LIBC && !HAVE_STPCPY\n-static char *\n-stpcpy (dest, src)\n-     char *dest;\n-     const char *src;\n-{\n-  while ((*dest++ = *src++) != '\\0')\n-    /* Do nothing. */ ;\n-  return dest - 1;\n-}\n-#endif"}, {"sha": "f4f2611c5ecbd837f86df20638b117e577e3a969", "filename": "gcc/intl/config.charset", "status": "added", "additions": 438, "deletions": 0, "changes": 438, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Fconfig.charset", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Fconfig.charset", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fintl%2Fconfig.charset?ref=71a94577632a238bf4e112f0f016819ead09f1d5", "patch": "@@ -0,0 +1,438 @@\n+#! /bin/sh\n+# Output a system dependent table of character encoding aliases.\n+#\n+#   Copyright (C) 2000-2001 Free Software Foundation, Inc.\n+#\n+#   This program is free software; you can redistribute it and/or modify it\n+#   under the terms of the GNU Library General Public License as published\n+#   by the Free Software Foundation; either version 2, or (at your option)\n+#   any later version.\n+#\n+#   This program is distributed in the hope that it will be useful,\n+#   but WITHOUT ANY WARRANTY; without even the implied warranty of\n+#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+#   Library General Public License for more details.\n+#\n+#   You should have received a copy of the GNU Library General Public\n+#   License along with this program; if not, write to the Free Software\n+#   Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307,\n+#   USA.\n+#\n+# The table consists of lines of the form\n+#    ALIAS  CANONICAL\n+#\n+# ALIAS is the (system dependent) result of \"nl_langinfo (CODESET)\".\n+# ALIAS is compared in a case sensitive way.\n+#\n+# CANONICAL is the GNU canonical name for this character encoding.\n+# It must be an encoding supported by libiconv. Support by GNU libc is\n+# also desirable. CANONICAL is case insensitive. Usually an upper case\n+# MIME charset name is preferred.\n+# The current list of GNU canonical charset names is as follows.\n+#\n+#       name                         used by which systems         a MIME name?\n+#   ASCII, ANSI_X3.4-1968     glibc solaris freebsd\n+#   ISO-8859-1                glibc aix hpux irix osf solaris freebsd   yes\n+#   ISO-8859-2                glibc aix hpux irix osf solaris freebsd   yes\n+#   ISO-8859-3                glibc                                     yes\n+#   ISO-8859-4                osf solaris freebsd                       yes\n+#   ISO-8859-5                glibc aix hpux irix osf solaris freebsd   yes\n+#   ISO-8859-6                glibc aix hpux solaris                    yes\n+#   ISO-8859-7                glibc aix hpux irix osf solaris           yes\n+#   ISO-8859-8                glibc aix hpux osf solaris                yes\n+#   ISO-8859-9                glibc aix hpux irix osf solaris           yes\n+#   ISO-8859-13               glibc\n+#   ISO-8859-15               glibc aix osf solaris freebsd\n+#   KOI8-R                    glibc solaris freebsd                     yes\n+#   KOI8-U                    glibc freebsd                             yes\n+#   CP437                     dos\n+#   CP775                     dos\n+#   CP850                     aix osf dos\n+#   CP852                     dos\n+#   CP855                     dos\n+#   CP856                     aix\n+#   CP857                     dos\n+#   CP861                     dos\n+#   CP862                     dos\n+#   CP864                     dos\n+#   CP865                     dos\n+#   CP866                     freebsd dos\n+#   CP869                     dos\n+#   CP874                     win32 dos\n+#   CP922                     aix\n+#   CP932                     aix win32 dos\n+#   CP943                     aix\n+#   CP949                     osf win32 dos\n+#   CP950                     win32 dos\n+#   CP1046                    aix\n+#   CP1124                    aix\n+#   CP1129                    aix\n+#   CP1250                    win32\n+#   CP1251                    glibc win32\n+#   CP1252                    aix win32\n+#   CP1253                    win32\n+#   CP1254                    win32\n+#   CP1255                    win32\n+#   CP1256                    win32\n+#   CP1257                    win32\n+#   GB2312                    glibc aix hpux irix solaris freebsd       yes\n+#   EUC-JP                    glibc aix hpux irix osf solaris freebsd   yes\n+#   EUC-KR                    glibc aix hpux irix osf solaris freebsd   yes\n+#   EUC-TW                    glibc aix hpux irix osf solaris\n+#   BIG5                      glibc aix hpux osf solaris freebsd        yes\n+#   BIG5-HKSCS                glibc\n+#   GBK                       aix osf win32 dos\n+#   GB18030                   glibc\n+#   SHIFT_JIS                 hpux osf solaris freebsd                  yes\n+#   JOHAB                     glibc win32\n+#   TIS-620                   glibc aix hpux osf solaris\n+#   VISCII                    glibc                                     yes\n+#   HP-ROMAN8                 hpux\n+#   HP-ARABIC8                hpux\n+#   HP-GREEK8                 hpux\n+#   HP-HEBREW8                hpux\n+#   HP-TURKISH8               hpux\n+#   HP-KANA8                  hpux\n+#   DEC-KANJI                 osf\n+#   DEC-HANYU                 osf\n+#   UTF-8                     glibc aix hpux osf solaris                yes\n+#\n+# Note: Names which are not marked as being a MIME name should not be used in\n+# Internet protocols for information interchange (mail, news, etc.).\n+#\n+# Note: ASCII and ANSI_X3.4-1968 are synonymous canonical names. Applications\n+# must understand both names and treat them as equivalent.\n+#\n+# The first argument passed to this file is the canonical host specification,\n+#    CPU_TYPE-MANUFACTURER-OPERATING_SYSTEM\n+# or\n+#    CPU_TYPE-MANUFACTURER-KERNEL-OPERATING_SYSTEM\n+\n+host=\"$1\"\n+os=`echo \"$host\" | sed -e 's/^[^-]*-[^-]*-\\(.*\\)$/\\1/'`\n+echo \"# This file contains a table of character encoding aliases,\"\n+echo \"# suitable for operating system '${os}'.\"\n+echo \"# It was automatically generated from config.charset.\"\n+# List of references, updated during installation:\n+echo \"# Packages using this file: \"\n+case \"$os\" in\n+    linux* | *-gnu*)\n+\t# With glibc-2.1 or newer, we don't need any canonicalization,\n+\t# because glibc has iconv and both glibc and libiconv support all\n+\t# GNU canonical names directly. Therefore, the Makefile does not\n+\t# need to install the alias file at all.\n+\t# The following applies only to glibc-2.0.x and older libcs.\n+\techo \"ISO_646.IRV:1983 ASCII\"\n+\t;;\n+    aix*)\n+\techo \"ISO8859-1 ISO-8859-1\"\n+\techo \"ISO8859-2 ISO-8859-2\"\n+\techo \"ISO8859-5 ISO-8859-5\"\n+\techo \"ISO8859-6 ISO-8859-6\"\n+\techo \"ISO8859-7 ISO-8859-7\"\n+\techo \"ISO8859-8 ISO-8859-8\"\n+\techo \"ISO8859-9 ISO-8859-9\"\n+\techo \"ISO8859-15 ISO-8859-15\"\n+\techo \"IBM-850 CP850\"\n+\techo \"IBM-856 CP856\"\n+\techo \"IBM-921 ISO-8859-13\"\n+\techo \"IBM-922 CP922\"\n+\techo \"IBM-932 CP932\"\n+\techo \"IBM-943 CP943\"\n+\techo \"IBM-1046 CP1046\"\n+\techo \"IBM-1124 CP1124\"\n+\techo \"IBM-1129 CP1129\"\n+\techo \"IBM-1252 CP1252\"\n+\techo \"IBM-eucCN GB2312\"\n+\techo \"IBM-eucJP EUC-JP\"\n+\techo \"IBM-eucKR EUC-KR\"\n+\techo \"IBM-eucTW EUC-TW\"\n+\techo \"big5 BIG5\"\n+\techo \"GBK GBK\"\n+\techo \"TIS-620 TIS-620\"\n+\techo \"UTF-8 UTF-8\"\n+\t;;\n+    hpux*)\n+\techo \"iso88591 ISO-8859-1\"\n+\techo \"iso88592 ISO-8859-2\"\n+\techo \"iso88595 ISO-8859-5\"\n+\techo \"iso88596 ISO-8859-6\"\n+\techo \"iso88597 ISO-8859-7\"\n+\techo \"iso88598 ISO-8859-8\"\n+\techo \"iso88599 ISO-8859-9\"\n+\techo \"iso885915 ISO-8859-15\"\n+\techo \"roman8 HP-ROMAN8\"\n+\techo \"arabic8 HP-ARABIC8\"\n+\techo \"greek8 HP-GREEK8\"\n+\techo \"hebrew8 HP-HEBREW8\"\n+\techo \"turkish8 HP-TURKISH8\"\n+\techo \"kana8 HP-KANA8\"\n+\techo \"tis620 TIS-620\"\n+\techo \"big5 BIG5\"\n+\techo \"eucJP EUC-JP\"\n+\techo \"eucKR EUC-KR\"\n+\techo \"eucTW EUC-TW\"\n+\techo \"hp15CN GB2312\"\n+\t#echo \"ccdc ?\" # what is this?\n+\techo \"SJIS SHIFT_JIS\"\n+\techo \"utf8 UTF-8\"\n+\t;;\n+    irix*)\n+\techo \"ISO8859-1 ISO-8859-1\"\n+\techo \"ISO8859-2 ISO-8859-2\"\n+\techo \"ISO8859-5 ISO-8859-5\"\n+\techo \"ISO8859-7 ISO-8859-7\"\n+\techo \"ISO8859-9 ISO-8859-9\"\n+\techo \"eucCN GB2312\"\n+\techo \"eucJP EUC-JP\"\n+\techo \"eucKR EUC-KR\"\n+\techo \"eucTW EUC-TW\"\n+\t;;\n+    osf*)\n+\techo \"ISO8859-1 ISO-8859-1\"\n+\techo \"ISO8859-2 ISO-8859-2\"\n+\techo \"ISO8859-4 ISO-8859-4\"\n+\techo \"ISO8859-5 ISO-8859-5\"\n+\techo \"ISO8859-7 ISO-8859-7\"\n+\techo \"ISO8859-8 ISO-8859-8\"\n+\techo \"ISO8859-9 ISO-8859-9\"\n+\techo \"ISO8859-15 ISO-8859-15\"\n+\techo \"cp850 CP850\"\n+\techo \"big5 BIG5\"\n+\techo \"dechanyu DEC-HANYU\"\n+\techo \"dechanzi GB2312\"\n+\techo \"deckanji DEC-KANJI\"\n+\techo \"deckorean EUC-KR\"\n+\techo \"eucJP EUC-JP\"\n+\techo \"eucKR EUC-KR\"\n+\techo \"eucTW EUC-TW\"\n+\techo \"GBK GBK\"\n+\techo \"KSC5601 CP949\"\n+\techo \"sdeckanji EUC-JP\"\n+\techo \"SJIS SHIFT_JIS\"\n+\techo \"TACTIS TIS-620\"\n+\techo \"UTF-8 UTF-8\"\n+\t;;\n+    solaris*)\n+\techo \"646 ASCII\"\n+\techo \"ISO8859-1 ISO-8859-1\"\n+\techo \"ISO8859-2 ISO-8859-2\"\n+\techo \"ISO8859-4 ISO-8859-4\"\n+\techo \"ISO8859-5 ISO-8859-5\"\n+\techo \"ISO8859-6 ISO-8859-6\"\n+\techo \"ISO8859-7 ISO-8859-7\"\n+\techo \"ISO8859-8 ISO-8859-8\"\n+\techo \"ISO8859-9 ISO-8859-9\"\n+\techo \"ISO8859-15 ISO-8859-15\"\n+\techo \"koi8-r KOI8-R\"\n+\techo \"BIG5 BIG5\"\n+\techo \"gb2312 GB2312\"\n+\techo \"cns11643 EUC-TW\"\n+\techo \"5601 EUC-KR\"\n+\techo \"eucJP EUC-JP\"\n+\techo \"PCK SHIFT_JIS\"\n+\techo \"TIS620.2533 TIS-620\"\n+\t#echo \"sun_eu_greek ?\" # what is this?\n+\techo \"UTF-8 UTF-8\"\n+\t;;\n+    freebsd*)\n+\t# FreeBSD 4.2 doesn't have nl_langinfo(CODESET); therefore\n+\t# localcharset.c falls back to using the full locale name\n+\t# from the environment variables.\n+\techo \"C ASCII\"\n+\techo \"US-ASCII ASCII\"\n+\tfor l in la_LN lt_LN; do\n+\t  echo \"$l.ASCII ASCII\"\n+\tdone\n+\tfor l in da_DK de_AT de_CH de_DE en_AU en_CA en_GB en_US es_ES \\\n+\t         fi_FI fr_BE fr_CA fr_CH fr_FR is_IS it_CH it_IT la_LN \\\n+\t         lt_LN nl_BE nl_NL no_NO pt_PT sv_SE; do\n+\t  echo \"$l.ISO_8859-1 ISO-8859-1\"\n+\t  echo \"$l.DIS_8859-15 ISO-8859-15\"\n+\tdone\n+\tfor l in cs_CZ hr_HR hu_HU la_LN lt_LN pl_PL sl_SI; do\n+\t  echo \"$l.ISO_8859-2 ISO-8859-2\"\n+\tdone\n+\tfor l in la_LN lt_LT; do\n+\t  echo \"$l.ISO_8859-4 ISO-8859-4\"\n+\tdone\n+\tfor l in ru_RU ru_SU; do\n+\t  echo \"$l.KOI8-R KOI8-R\"\n+\t  echo \"$l.ISO_8859-5 ISO-8859-5\"\n+\t  echo \"$l.CP866 CP866\"\n+\tdone\n+\techo \"uk_UA.KOI8-U KOI8-U\"\n+\techo \"zh_TW.BIG5 BIG5\"\n+\techo \"zh_TW.Big5 BIG5\"\n+\techo \"zh_CN.EUC GB2312\"\n+\techo \"ja_JP.EUC EUC-JP\"\n+\techo \"ja_JP.SJIS SHIFT_JIS\"\n+\techo \"ja_JP.Shift_JIS SHIFT_JIS\"\n+\techo \"ko_KR.EUC EUC-KR\"\n+\t;;\n+    beos*)\n+\t# BeOS has a single locale, and it has UTF-8 encoding.\n+\techo \"* UTF-8\"\n+\t;;\n+    msdosdjgpp*)\n+\t# DJGPP 2.03 doesn't have nl_langinfo(CODESET); therefore\n+\t# localcharset.c falls back to using the full locale name\n+\t# from the environment variables.\n+\techo \"#\"\n+\techo \"# The encodings given here may not all be correct.\"\n+\techo \"# If you find that the encoding given for your language and\"\n+\techo \"# country is not the one your DOS machine actually uses, just\"\n+\techo \"# correct it in this file, and send a mail to\"\n+\techo \"# Juan Manuel Guerrero <st001906@hrz1.hrz.tu-darmstadt.de>\"\n+\techo \"# and Bruno Haible <haible@clisp.cons.org>.\"\n+\techo \"#\"\n+\techo \"C ASCII\"\n+\t# ISO-8859-1 languages\n+\techo \"ca CP850\"\n+\techo \"ca_ES CP850\"\n+\techo \"da CP865\"    # not CP850 ??\n+\techo \"da_DK CP865\" # not CP850 ??\n+\techo \"de CP850\"\n+\techo \"de_AT CP850\"\n+\techo \"de_CH CP850\"\n+\techo \"de_DE CP850\"\n+\techo \"en CP850\"\n+\techo \"en_AU CP850\" # not CP437 ??\n+\techo \"en_CA CP850\"\n+\techo \"en_GB CP850\"\n+\techo \"en_NZ CP437\"\n+\techo \"en_US CP437\"\n+\techo \"en_ZA CP850\" # not CP437 ??\n+\techo \"es CP850\"\n+\techo \"es_AR CP850\"\n+\techo \"es_BO CP850\"\n+\techo \"es_CL CP850\"\n+\techo \"es_CO CP850\"\n+\techo \"es_CR CP850\"\n+\techo \"es_CU CP850\"\n+\techo \"es_DO CP850\"\n+\techo \"es_EC CP850\"\n+\techo \"es_ES CP850\"\n+\techo \"es_GT CP850\"\n+\techo \"es_HN CP850\"\n+\techo \"es_MX CP850\"\n+\techo \"es_NI CP850\"\n+\techo \"es_PA CP850\"\n+\techo \"es_PY CP850\"\n+\techo \"es_PE CP850\"\n+\techo \"es_SV CP850\"\n+\techo \"es_UY CP850\"\n+\techo \"es_VE CP850\"\n+\techo \"et CP850\"\n+\techo \"et_EE CP850\"\n+\techo \"eu CP850\"\n+\techo \"eu_ES CP850\"\n+\techo \"fi CP850\"\n+\techo \"fi_FI CP850\"\n+\techo \"fr CP850\"\n+\techo \"fr_BE CP850\"\n+\techo \"fr_CA CP850\"\n+\techo \"fr_CH CP850\"\n+\techo \"fr_FR CP850\"\n+\techo \"ga CP850\"\n+\techo \"ga_IE CP850\"\n+\techo \"gd CP850\"\n+\techo \"gd_GB CP850\"\n+\techo \"gl CP850\"\n+\techo \"gl_ES CP850\"\n+\techo \"id CP850\"    # not CP437 ??\n+\techo \"id_ID CP850\" # not CP437 ??\n+\techo \"is CP861\"    # not CP850 ??\n+\techo \"is_IS CP861\" # not CP850 ??\n+\techo \"it CP850\"\n+\techo \"it_CH CP850\"\n+\techo \"it_IT CP850\"\n+\techo \"lt CP775\"\n+\techo \"lt_LT CP775\"\n+\techo \"lv CP775\"\n+\techo \"lv_LV CP775\"\n+\techo \"nb CP865\"    # not CP850 ??\n+\techo \"nb_NO CP865\" # not CP850 ??\n+\techo \"nl CP850\"\n+\techo \"nl_BE CP850\"\n+\techo \"nl_NL CP850\"\n+\techo \"nn CP865\"    # not CP850 ??\n+\techo \"nn_NO CP865\" # not CP850 ??\n+\techo \"no CP865\"    # not CP850 ??\n+\techo \"no_NO CP865\" # not CP850 ??\n+\techo \"pt CP850\"\n+\techo \"pt_BR CP850\"\n+\techo \"pt_PT CP850\"\n+\techo \"sv CP850\"\n+\techo \"sv_SE CP850\"\n+\t# ISO-8859-2 languages\n+\techo \"cs CP852\"\n+\techo \"cs_CZ CP852\"\n+\techo \"hr CP852\"\n+\techo \"hr_HR CP852\"\n+\techo \"hu CP852\"\n+\techo \"hu_HU CP852\"\n+\techo \"pl CP852\"\n+\techo \"pl_PL CP852\"\n+\techo \"ro CP852\"\n+\techo \"ro_RO CP852\"\n+\techo \"sk CP852\"\n+\techo \"sk_SK CP852\"\n+\techo \"sl CP852\"\n+\techo \"sl_SI CP852\"\n+\techo \"sq CP852\"\n+\techo \"sq_AL CP852\"\n+\techo \"sr CP852\"    # CP852 or CP866 or CP855 ??\n+\techo \"sr_YU CP852\" # CP852 or CP866 or CP855 ??\n+\t# ISO-8859-3 languages\n+\techo \"mt CP850\"\n+\techo \"mt_MT CP850\"\n+\t# ISO-8859-5 languages\n+\techo \"be CP866\"\n+\techo \"be_BE CP866\"\n+\techo \"bg CP866\"    # not CP855 ??\n+\techo \"bg_BG CP866\" # not CP855 ??\n+\techo \"mk CP866\"    # not CP855 ??\n+\techo \"mk_MK CP866\" # not CP855 ??\n+\techo \"ru KOI8-R\"    # not CP866 ??\n+\techo \"ru_RU KOI8-R\" # not CP866 ??\n+\t# ISO-8859-6 languages\n+\techo \"ar CP864\"\n+\techo \"ar_AE CP864\"\n+\techo \"ar_DZ CP864\"\n+\techo \"ar_EG CP864\"\n+\techo \"ar_IQ CP864\"\n+\techo \"ar_IR CP864\"\n+\techo \"ar_JO CP864\"\n+\techo \"ar_KW CP864\"\n+\techo \"ar_MA CP864\"\n+\techo \"ar_OM CP864\"\n+\techo \"ar_QA CP864\"\n+\techo \"ar_SA CP864\"\n+\techo \"ar_SY CP864\"\n+\t# ISO-8859-7 languages\n+\techo \"el CP869\"\n+\techo \"el_GR CP869\"\n+\t# ISO-8859-8 languages\n+\techo \"he CP862\"\n+\techo \"he_IL CP862\"\n+\t# ISO-8859-9 languages\n+\techo \"tr CP857\"\n+\techo \"tr_TR CP857\"\n+\t# Japanese\n+\techo \"ja CP932\"\n+\techo \"ja_JP CP932\"\n+\t# Chinese\n+\techo \"zh_CN GBK\"\n+\techo \"zh_TW CP950\" # not CP938 ??\n+\t# Korean\n+\techo \"kr CP949\"    # not CP934 ??\n+\techo \"kr_KR CP949\" # not CP934 ??\n+\t# Thai\n+\techo \"th CP874\"\n+\techo \"th_TH CP874\"\n+\t# Other\n+\techo \"eo CP850\"\n+\techo \"eo_EO CP850\"\n+\t;;\n+esac"}, {"sha": "b7c96523dd881e368b1406c064279d14ed26b8bc", "filename": "gcc/intl/dcgettext.c", "status": "modified", "additions": 14, "deletions": 594, "changes": 608, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Fdcgettext.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Fdcgettext.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fintl%2Fdcgettext.c?ref=71a94577632a238bf4e112f0f016819ead09f1d5", "patch": "@@ -1,231 +1,44 @@\n /* Implementation of the dcgettext(3) function.\n-   Copyright (C) 1995, 1996, 1997, 1998 Free Software Foundation, Inc.\n+   Copyright (C) 1995-1999, 2000, 2001 Free Software Foundation, Inc.\n \n-   This program is free software; you can redistribute it and/or modify\n-   it under the terms of the GNU General Public License as published by\n-   the Free Software Foundation; either version 2, or (at your option)\n+   This program is free software; you can redistribute it and/or modify it\n+   under the terms of the GNU Library General Public License as published\n+   by the Free Software Foundation; either version 2, or (at your option)\n    any later version.\n \n    This program is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n-   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n-   GNU General Public License for more details.\n+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+   Library General Public License for more details.\n \n-   You should have received a copy of the GNU General Public License\n-   along with this program; if not, write to the Free Software Foundation,\n-   Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.  */\n+   You should have received a copy of the GNU Library General Public\n+   License along with this program; if not, write to the Free Software\n+   Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307,\n+   USA.  */\n \n #ifdef HAVE_CONFIG_H\n # include <config.h>\n #endif\n \n-# ifndef _GNU_SOURCE\n-#  define _GNU_SOURCE\t1\n-# endif\n-\n-#include <sys/types.h>\n-\n-#ifdef __GNUC__\n-# define alloca __builtin_alloca\n-# define HAVE_ALLOCA 1\n-#else\n-# if defined HAVE_ALLOCA_H || defined _LIBC\n-#  include <alloca.h>\n-# else\n-#  ifdef _AIX\n- #pragma alloca\n-#  else\n-#   ifndef alloca\n-char *alloca ();\n-#   endif\n-#  endif\n-# endif\n-#endif\n-\n-#include <errno.h>\n-#ifndef errno\n-extern int errno;\n-#endif\n-#ifndef __set_errno\n-# define __set_errno(val) errno = (val)\n-#endif\n-\n-#if defined STDC_HEADERS || defined _LIBC\n-# include <stdlib.h>\n-#else\n-char *getenv ();\n-# ifdef HAVE_MALLOC_H\n-#  include <malloc.h>\n-# else\n-void free ();\n-# endif\n-#endif\n-\n-#if defined HAVE_STRING_H || defined _LIBC\n-# include <string.h>\n-#else\n-# include <strings.h>\n-#endif\n-#if !HAVE_STRCHR && !defined _LIBC\n-# ifndef strchr\n-#  define strchr index\n-# endif\n-#endif\n-\n-#if defined HAVE_UNISTD_H || defined _LIBC\n-# include <unistd.h>\n-#endif\n-\n-#include \"gettext.h\"\n #include \"gettextP.h\"\n #ifdef _LIBC\n # include <libintl.h>\n #else\n-# include \"libgettext.h\"\n-#endif\n-#include \"hash-string.h\"\n-\n-/* The internal variables in the standalone libintl.a must have different\n-   names than the internal variables in GNU libc, otherwise programs\n-   using libintl.a cannot be linked statically.  */\n-#if !defined _LIBC\n-# define _nl_default_default_domain _nl_default_default_domain__\n-# define _nl_current_default_domain _nl_current_default_domain__\n-# define _nl_default_dirname _nl_default_dirname__\n-# define _nl_domain_bindings _nl_domain_bindings__\n+# include \"libgnuintl.h\"\n #endif\n \n /* @@ end of prolog @@ */\n \n-#ifdef _LIBC\n-/* Rename the non ANSI C functions.  This is required by the standard\n-   because some ANSI C functions will require linking with this object\n-   file and the name space must not be polluted.  */\n-# define getcwd __getcwd\n-# ifndef stpcpy\n-#  define stpcpy __stpcpy\n-# endif\n-#else\n-# if !defined HAVE_GETCWD\n-char *getwd ();\n-#  define getcwd(buf, max) getwd (buf)\n-# elif !defined (HAVE_DECL_GETCWD)\n-char *getcwd ();\n-# endif\n-# ifndef HAVE_STPCPY\n-static char *stpcpy PARAMS ((char *dest, const char *src));\n-# endif\n-#endif\n-\n-/* Amount to increase buffer size by in each try.  */\n-#define PATH_INCR 32\n-\n-/* The following is from pathmax.h.  */\n-/* Non-POSIX BSD systems might have gcc's limits.h, which doesn't define\n-   PATH_MAX but might cause redefinition warnings when sys/param.h is\n-   later included (as on MORE/BSD 4.3).  */\n-#if defined(_POSIX_VERSION) || (defined(HAVE_LIMITS_H) && !defined(__GNUC__))\n-# include <limits.h>\n-#endif\n-\n-#ifndef _POSIX_PATH_MAX\n-# define _POSIX_PATH_MAX 255\n-#endif\n-\n-#if !defined(PATH_MAX) && defined(_PC_PATH_MAX)\n-# define PATH_MAX (pathconf (\"/\", _PC_PATH_MAX) < 1 ? 1024 : pathconf (\"/\", _PC_PATH_MAX))\n-#endif\n-\n-/* Don't include sys/param.h if it already has been.  */\n-#if defined(HAVE_SYS_PARAM_H) && !defined(PATH_MAX) && !defined(MAXPATHLEN)\n-# include <sys/param.h>\n-#endif\n-\n-#if !defined(PATH_MAX) && defined(MAXPATHLEN)\n-# define PATH_MAX MAXPATHLEN\n-#endif\n-\n-#ifndef PATH_MAX\n-# define PATH_MAX _POSIX_PATH_MAX\n-#endif\n-\n-/* XPG3 defines the result of `setlocale (category, NULL)' as:\n-   ``Directs `setlocale()' to query `category' and return the current\n-     setting of `local'.''\n-   However it does not specify the exact format.  And even worse: POSIX\n-   defines this not at all.  So we can use this feature only on selected\n-   system (e.g. those using GNU C Library).  */\n-#ifdef _LIBC\n-# define HAVE_LOCALE_NULL\n-#endif\n-\n-/* Name of the default domain used for gettext(3) prior any call to\n-   textdomain(3).  The default value for this is \"messages\".  */\n-const char _nl_default_default_domain[] = \"messages\";\n-\n-/* Value used as the default domain for gettext(3).  */\n-const char *_nl_current_default_domain = _nl_default_default_domain;\n-\n-/* Contains the default location of the message catalogs.  */\n-const char _nl_default_dirname[] = GNULOCALEDIR;\n-\n-/* List with bindings of specific domains created by bindtextdomain()\n-   calls.  */\n-struct binding *_nl_domain_bindings;\n-\n-/* Prototypes for local functions.  */\n-static char *find_msg PARAMS ((struct loaded_l10nfile *domain_file,\n-\t\t\t       const char *msgid)) internal_function;\n-static const char *category_to_name PARAMS ((int category)) internal_function;\n-static const char *guess_category_value PARAMS ((int category,\n-\t\t\t\t\t\t const char *categoryname))\n-     internal_function;\n-\n-\n-/* For those loosing systems which don't have `alloca' we have to add\n-   some additional code emulating it.  */\n-#ifdef HAVE_ALLOCA\n-/* Nothing has to be done.  */\n-# define ADD_BLOCK(list, address) /* nothing */\n-# define FREE_BLOCKS(list) /* nothing */\n-#else\n-struct block_list\n-{\n-  void *address;\n-  struct block_list *next;\n-};\n-# define ADD_BLOCK(list, addr)\t\t\t\t\t\t      \\\n-  do {\t\t\t\t\t\t\t\t\t      \\\n-    struct block_list *newp = (struct block_list *) malloc (sizeof (*newp));  \\\n-    /* If we cannot get a free block we cannot add the new element to\t      \\\n-       the list.  */\t\t\t\t\t\t\t      \\\n-    if (newp != NULL) {\t\t\t\t\t\t\t      \\\n-      newp->address = (addr);\t\t\t\t\t\t      \\\n-      newp->next = (list);\t\t\t\t\t\t      \\\n-      (list) = newp;\t\t\t\t\t\t\t      \\\n-    }\t\t\t\t\t\t\t\t\t      \\\n-  } while (0)\n-# define FREE_BLOCKS(list)\t\t\t\t\t\t      \\\n-  do {\t\t\t\t\t\t\t\t\t      \\\n-    while (list != NULL) {\t\t\t\t\t\t      \\\n-      struct block_list *old = list;\t\t\t\t\t      \\\n-      list = list->next;\t\t\t\t\t\t      \\\n-      free (old);\t\t\t\t\t\t\t      \\\n-    }\t\t\t\t\t\t\t\t\t      \\\n-  } while (0)\n-# undef alloca\n-# define alloca(size) (malloc (size))\n-#endif\t/* have alloca */\n-\n-\n /* Names for the libintl functions are a problem.  They must not clash\n    with existing names and they should follow ANSI C.  But this source\n    code is also used in GNU C Library where the names have a __\n    prefix.  So we have to make a difference here.  */\n #ifdef _LIBC\n # define DCGETTEXT __dcgettext\n+# define DCIGETTEXT __dcigettext\n #else\n # define DCGETTEXT dcgettext__\n+# define DCIGETTEXT dcigettext__\n #endif\n \n /* Look up MSGID in the DOMAINNAME message catalog for the current CATEGORY\n@@ -236,403 +49,10 @@ DCGETTEXT (domainname, msgid, category)\n      const char *msgid;\n      int category;\n {\n-#ifndef HAVE_ALLOCA\n-  struct block_list *block_list = NULL;\n-#endif\n-  struct loaded_l10nfile *domain;\n-  struct binding *binding;\n-  const char *categoryname;\n-  const char *categoryvalue;\n-  char *dirname, *xdomainname;\n-  char *single_locale;\n-  char *retval;\n-  int saved_errno = errno;\n-\n-  /* If no real MSGID is given return NULL.  */\n-  if (msgid == NULL)\n-    return NULL;\n-\n-  /* If DOMAINNAME is NULL, we are interested in the default domain.  If\n-     CATEGORY is not LC_MESSAGES this might not make much sense but the\n-     defintion left this undefined.  */\n-  if (domainname == NULL)\n-    domainname = _nl_current_default_domain;\n-\n-  /* First find matching binding.  */\n-  for (binding = _nl_domain_bindings; binding != NULL; binding = binding->next)\n-    {\n-      int compare = strcmp (domainname, binding->domainname);\n-      if (compare == 0)\n-\t/* We found it!  */\n-\tbreak;\n-      if (compare < 0)\n-\t{\n-\t  /* It is not in the list.  */\n-\t  binding = NULL;\n-\t  break;\n-\t}\n-    }\n-\n-  if (binding == NULL)\n-    dirname = (char *) _nl_default_dirname;\n-  else if (binding->dirname[0] == '/')\n-    dirname = binding->dirname;\n-  else\n-    {\n-      /* We have a relative path.  Make it absolute now.  */\n-      size_t dirname_len = strlen (binding->dirname) + 1;\n-      size_t path_max;\n-      char *ret;\n-\n-      path_max = (unsigned) PATH_MAX;\n-      path_max += 2;\t\t/* The getcwd docs say to do this.  */\n-\n-      dirname = (char *) alloca (path_max + dirname_len);\n-      ADD_BLOCK (block_list, dirname);\n-\n-      __set_errno (0);\n-      while ((ret = getcwd (dirname, path_max)) == NULL && errno == ERANGE)\n-\t{\n-\t  path_max += PATH_INCR;\n-\t  dirname = (char *) alloca (path_max + dirname_len);\n-\t  ADD_BLOCK (block_list, dirname);\n-\t  __set_errno (0);\n-\t}\n-\n-      if (ret == NULL)\n-\t{\n-\t  /* We cannot get the current working directory.  Don't signal an\n-\t     error but simply return the default string.  */\n-\t  FREE_BLOCKS (block_list);\n-\t  __set_errno (saved_errno);\n-\t  return (char *) msgid;\n-\t}\n-\n-      stpcpy (stpcpy (strchr (dirname, '\\0'), \"/\"), binding->dirname);\n-    }\n-\n-  /* Now determine the symbolic name of CATEGORY and its value.  */\n-  categoryname = category_to_name (category);\n-  categoryvalue = guess_category_value (category, categoryname);\n-\n-  xdomainname = (char *) alloca (strlen (categoryname)\n-\t\t\t\t + strlen (domainname) + 5);\n-  ADD_BLOCK (block_list, xdomainname);\n-\n-  stpcpy (stpcpy (stpcpy (stpcpy (xdomainname, categoryname), \"/\"),\n-\t\t  domainname),\n-\t  \".mo\");\n-\n-  /* Creating working area.  */\n-  single_locale = (char *) alloca (strlen (categoryvalue) + 1);\n-  ADD_BLOCK (block_list, single_locale);\n-\n-\n-  /* Search for the given string.  This is a loop because we perhaps\n-     got an ordered list of languages to consider for th translation.  */\n-  while (1)\n-    {\n-      /* Make CATEGORYVALUE point to the next element of the list.  */\n-      while (categoryvalue[0] != '\\0' && categoryvalue[0] == ':')\n-\t++categoryvalue;\n-      if (categoryvalue[0] == '\\0')\n-\t{\n-\t  /* The whole contents of CATEGORYVALUE has been searched but\n-\t     no valid entry has been found.  We solve this situation\n-\t     by implicitly appending a \"C\" entry, i.e. no translation\n-\t     will take place.  */\n-\t  single_locale[0] = 'C';\n-\t  single_locale[1] = '\\0';\n-\t}\n-      else\n-\t{\n-\t  char *cp = single_locale;\n-\t  while (categoryvalue[0] != '\\0' && categoryvalue[0] != ':')\n-\t    *cp++ = *categoryvalue++;\n-\t  *cp = '\\0';\n-\t}\n-\n-      /* If the current locale value is C (or POSIX) we don't load a\n-\t domain.  Return the MSGID.  */\n-      if (strcmp (single_locale, \"C\") == 0\n-\t  || strcmp (single_locale, \"POSIX\") == 0)\n-\t{\n-\t  FREE_BLOCKS (block_list);\n-\t  __set_errno (saved_errno);\n-\t  return (char *) msgid;\n-\t}\n-\n-\n-      /* Find structure describing the message catalog matching the\n-\t DOMAINNAME and CATEGORY.  */\n-      domain = _nl_find_domain (dirname, single_locale, xdomainname);\n-\n-      if (domain != NULL)\n-\t{\n-\t  retval = find_msg (domain, msgid);\n-\n-\t  if (retval == NULL)\n-\t    {\n-\t      int cnt;\n-\n-\t      for (cnt = 0; domain->successor[cnt] != NULL; ++cnt)\n-\t\t{\n-\t\t  retval = find_msg (domain->successor[cnt], msgid);\n-\n-\t\t  if (retval != NULL)\n-\t\t    break;\n-\t\t}\n-\t    }\n-\n-\t  if (retval != NULL)\n-\t    {\n-\t      FREE_BLOCKS (block_list);\n-\t      __set_errno (saved_errno);\n-\t      return retval;\n-\t    }\n-\t}\n-    }\n-  /* NOTREACHED */\n+  return DCIGETTEXT (domainname, msgid, NULL, 0, 0, category);\n }\n \n #ifdef _LIBC\n /* Alias for function name in GNU C Library.  */\n weak_alias (__dcgettext, dcgettext);\n #endif\n-\n-\n-static char *\n-internal_function\n-find_msg (domain_file, msgid)\n-     struct loaded_l10nfile *domain_file;\n-     const char *msgid;\n-{\n-  size_t top, act, bottom;\n-  struct loaded_domain *domain;\n-\n-  if (domain_file->decided == 0)\n-    _nl_load_domain (domain_file);\n-\n-  if (domain_file->data == NULL)\n-    return NULL;\n-\n-  domain = (struct loaded_domain *) domain_file->data;\n-\n-  /* Locate the MSGID and its translation.  */\n-  if (domain->hash_size > 2 && domain->hash_tab != NULL)\n-    {\n-      /* Use the hashing table.  */\n-      nls_uint32 len = strlen (msgid);\n-      nls_uint32 hash_val = hash_string (msgid);\n-      nls_uint32 idx = hash_val % domain->hash_size;\n-      nls_uint32 incr = 1 + (hash_val % (domain->hash_size - 2));\n-      nls_uint32 nstr = W (domain->must_swap, domain->hash_tab[idx]);\n-\n-      if (nstr == 0)\n-\t/* Hash table entry is empty.  */\n-\treturn NULL;\n-\n-      if (W (domain->must_swap, domain->orig_tab[nstr - 1].length) == len\n-\t  && strcmp (msgid,\n-\t\t     domain->data + W (domain->must_swap,\n-\t\t\t\t       domain->orig_tab[nstr - 1].offset)) == 0)\n-\treturn (char *) domain->data + W (domain->must_swap,\n-\t\t\t\t\t  domain->trans_tab[nstr - 1].offset);\n-\n-      while (1)\n-\t{\n-\t  if (idx >= domain->hash_size - incr)\n-\t    idx -= domain->hash_size - incr;\n-\t  else\n-\t    idx += incr;\n-\n-\t  nstr = W (domain->must_swap, domain->hash_tab[idx]);\n-\t  if (nstr == 0)\n-\t    /* Hash table entry is empty.  */\n-\t    return NULL;\n-\n-\t  if (W (domain->must_swap, domain->orig_tab[nstr - 1].length) == len\n-\t      && strcmp (msgid,\n-\t\t\t domain->data + W (domain->must_swap,\n-\t\t\t\t\t   domain->orig_tab[nstr - 1].offset))\n-\t         == 0)\n-\t    return (char *) domain->data\n-\t      + W (domain->must_swap, domain->trans_tab[nstr - 1].offset);\n-\t}\n-      /* NOTREACHED */\n-    }\n-\n-  /* Now we try the default method:  binary search in the sorted\n-     array of messages.  */\n-  bottom = 0;\n-  act = 0;\n-  top = domain->nstrings;\n-  while (bottom < top)\n-    {\n-      int cmp_val;\n-\n-      act = (bottom + top) / 2;\n-      cmp_val = strcmp (msgid, domain->data\n-\t\t\t       + W (domain->must_swap,\n-\t\t\t\t    domain->orig_tab[act].offset));\n-      if (cmp_val < 0)\n-\ttop = act;\n-      else if (cmp_val > 0)\n-\tbottom = act + 1;\n-      else\n-\tbreak;\n-    }\n-\n-  /* If an translation is found return this.  */\n-  return bottom >= top ? NULL : (char *) domain->data\n-                                + W (domain->must_swap,\n-\t\t\t\t     domain->trans_tab[act].offset);\n-}\n-\n-\n-/* Return string representation of locale CATEGORY.  */\n-static const char *\n-internal_function\n-category_to_name (category)\n-     int category;\n-{\n-  const char *retval;\n-\n-  switch (category)\n-  {\n-#ifdef LC_COLLATE\n-  case LC_COLLATE:\n-    retval = \"LC_COLLATE\";\n-    break;\n-#endif\n-#ifdef LC_CTYPE\n-  case LC_CTYPE:\n-    retval = \"LC_CTYPE\";\n-    break;\n-#endif\n-#ifdef LC_MONETARY\n-  case LC_MONETARY:\n-    retval = \"LC_MONETARY\";\n-    break;\n-#endif\n-#ifdef LC_NUMERIC\n-  case LC_NUMERIC:\n-    retval = \"LC_NUMERIC\";\n-    break;\n-#endif\n-#ifdef LC_TIME\n-  case LC_TIME:\n-    retval = \"LC_TIME\";\n-    break;\n-#endif\n-#ifdef LC_MESSAGES\n-  case LC_MESSAGES:\n-    retval = \"LC_MESSAGES\";\n-    break;\n-#endif\n-#ifdef LC_RESPONSE\n-  case LC_RESPONSE:\n-    retval = \"LC_RESPONSE\";\n-    break;\n-#endif\n-#ifdef LC_ALL\n-  case LC_ALL:\n-    /* This might not make sense but is perhaps better than any other\n-       value.  */\n-    retval = \"LC_ALL\";\n-    break;\n-#endif\n-  default:\n-    /* If you have a better idea for a default value let me know.  */\n-    retval = \"LC_XXX\";\n-  }\n-\n-  return retval;\n-}\n-\n-/* Guess value of current locale from value of the environment variables.  */\n-static const char *\n-internal_function\n-guess_category_value (category, categoryname)\n-     int category;\n-     const char *categoryname;\n-{\n-  const char *retval;\n-  (void) category;  /* shut up compiler */\n-  (void) categoryname;  /* ditto */\n-\n-  /* The highest priority value is the `LANGUAGE' environment\n-     variable.  This is a GNU extension.  */\n-  retval = getenv (\"LANGUAGE\");\n-  if (retval != NULL && retval[0] != '\\0')\n-    return retval;\n-\n-  /* `LANGUAGE' is not set.  So we have to proceed with the POSIX\n-     methods of looking to `LC_ALL', `LC_xxx', and `LANG'.  On some\n-     systems this can be done by the `setlocale' function itself.  */\n-#if defined HAVE_SETLOCALE && defined HAVE_LC_MESSAGES && defined HAVE_LOCALE_NULL\n-  return setlocale (category, NULL);\n-#else\n-  /* Setting of LC_ALL overwrites all other.  */\n-  retval = getenv (\"LC_ALL\");\n-  if (retval != NULL && retval[0] != '\\0')\n-    return retval;\n-\n-  /* Next comes the name of the desired category.  */\n-  retval = getenv (categoryname);\n-  if (retval != NULL && retval[0] != '\\0')\n-    return retval;\n-\n-  /* Last possibility is the LANG environment variable.  */\n-  retval = getenv (\"LANG\");\n-  if (retval != NULL && retval[0] != '\\0')\n-    return retval;\n-\n-  /* We use C as the default domain.  POSIX says this is implementation\n-     defined.  */\n-  return \"C\";\n-#endif\n-}\n-\n-/* @@ begin of epilog @@ */\n-\n-/* We don't want libintl.a to depend on any other library.  So we\n-   avoid the non-standard function stpcpy.  In GNU C Library this\n-   function is available, though.  Also allow the symbol HAVE_STPCPY\n-   to be defined.  */\n-#if !_LIBC && !HAVE_STPCPY\n-static char *\n-stpcpy (dest, src)\n-     char *dest;\n-     const char *src;\n-{\n-  while ((*dest++ = *src++) != '\\0')\n-    /* Do nothing. */ ;\n-  return dest - 1;\n-}\n-#endif\n-\n-\n-#ifdef _LIBC\n-/* If we want to free all resources we have to do some work at\n-   program's end.  */\n-static void __attribute__ ((unused))\n-free_mem (void)\n-{\n-  struct binding *runp;\n-\n-  for (runp = _nl_domain_bindings; runp != NULL; runp = runp->next)\n-    {\n-      free (runp->domainname);\n-      if (runp->dirname != _nl_default_dirname)\n-\t/* Yes, this is a pointer comparison.  */\n-\tfree (runp->dirname);\n-    }\n-\n-  if (_nl_current_default_domain != _nl_default_default_domain)\n-    /* Yes, again a pointer comparison.  */\n-    free ((char *) _nl_current_default_domain);\n-}\n-\n-text_set_element (__libc_subfreeres, free_mem);\n-#endif"}, {"sha": "5f69d74527b667bfc240e9db098889599bfca8d8", "filename": "gcc/intl/dcigettext.c", "status": "added", "additions": 1262, "deletions": 0, "changes": 1262, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Fdcigettext.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Fdcigettext.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fintl%2Fdcigettext.c?ref=71a94577632a238bf4e112f0f016819ead09f1d5", "patch": "@@ -0,0 +1,1262 @@\n+/* Implementation of the internal dcigettext function.\n+   Copyright (C) 1995-1999, 2000, 2001 Free Software Foundation, Inc.\n+\n+   This program is free software; you can redistribute it and/or modify it\n+   under the terms of the GNU Library General Public License as published\n+   by the Free Software Foundation; either version 2, or (at your option)\n+   any later version.\n+\n+   This program is distributed in the hope that it will be useful,\n+   but WITHOUT ANY WARRANTY; without even the implied warranty of\n+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+   Library General Public License for more details.\n+\n+   You should have received a copy of the GNU Library General Public\n+   License along with this program; if not, write to the Free Software\n+   Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307,\n+   USA.  */\n+\n+/* Tell glibc's <string.h> to provide a prototype for mempcpy().\n+   This must come before <config.h> because <config.h> may include\n+   <features.h>, and once <features.h> has been included, it's too late.  */\n+#ifndef _GNU_SOURCE\n+# define _GNU_SOURCE\t1\n+#endif\n+\n+#ifdef HAVE_CONFIG_H\n+# include <config.h>\n+#endif\n+\n+#include <sys/types.h>\n+\n+#ifdef __GNUC__\n+# define alloca __builtin_alloca\n+# define HAVE_ALLOCA 1\n+#else\n+# if defined HAVE_ALLOCA_H || defined _LIBC\n+#  include <alloca.h>\n+# else\n+#  ifdef _AIX\n+ #pragma alloca\n+#  else\n+#   ifndef alloca\n+char *alloca ();\n+#   endif\n+#  endif\n+# endif\n+#endif\n+\n+#include <errno.h>\n+#ifndef errno\n+extern int errno;\n+#endif\n+#ifndef __set_errno\n+# define __set_errno(val) errno = (val)\n+#endif\n+\n+#include <stddef.h>\n+#include <stdlib.h>\n+\n+#include <string.h>\n+#if !HAVE_STRCHR && !defined _LIBC\n+# ifndef strchr\n+#  define strchr index\n+# endif\n+#endif\n+\n+#if defined HAVE_UNISTD_H || defined _LIBC\n+# include <unistd.h>\n+#endif\n+\n+#include <locale.h>\n+\n+#if defined HAVE_SYS_PARAM_H || defined _LIBC\n+# include <sys/param.h>\n+#endif\n+\n+#include \"gettextP.h\"\n+#ifdef _LIBC\n+# include <libintl.h>\n+#else\n+# include \"libgnuintl.h\"\n+#endif\n+#include \"hash-string.h\"\n+\n+/* Thread safetyness.  */\n+#ifdef _LIBC\n+# include <bits/libc-lock.h>\n+#else\n+/* Provide dummy implementation if this is outside glibc.  */\n+# define __libc_lock_define_initialized(CLASS, NAME)\n+# define __libc_lock_lock(NAME)\n+# define __libc_lock_unlock(NAME)\n+# define __libc_rwlock_define_initialized(CLASS, NAME)\n+# define __libc_rwlock_rdlock(NAME)\n+# define __libc_rwlock_unlock(NAME)\n+#endif\n+\n+/* Alignment of types.  */\n+#if defined __GNUC__ && __GNUC__ >= 2\n+# define alignof(TYPE) __alignof__ (TYPE)\n+#else\n+# define alignof(TYPE) \\\n+    ((int) &((struct { char dummy1; TYPE dummy2; } *) 0)->dummy2)\n+#endif\n+\n+/* The internal variables in the standalone libintl.a must have different\n+   names than the internal variables in GNU libc, otherwise programs\n+   using libintl.a cannot be linked statically.  */\n+#if !defined _LIBC\n+# define _nl_default_default_domain _nl_default_default_domain__\n+# define _nl_current_default_domain _nl_current_default_domain__\n+# define _nl_default_dirname _nl_default_dirname__\n+# define _nl_domain_bindings _nl_domain_bindings__\n+#endif\n+\n+/* Some compilers, like SunOS4 cc, don't have offsetof in <stddef.h>.  */\n+#ifndef offsetof\n+# define offsetof(type,ident) ((size_t)&(((type*)0)->ident))\n+#endif\n+\n+/* @@ end of prolog @@ */\n+\n+#ifdef _LIBC\n+/* Rename the non ANSI C functions.  This is required by the standard\n+   because some ANSI C functions will require linking with this object\n+   file and the name space must not be polluted.  */\n+# define getcwd __getcwd\n+# ifndef stpcpy\n+#  define stpcpy __stpcpy\n+# endif\n+# define tfind __tfind\n+#else\n+# if !defined HAVE_GETCWD\n+char *getwd ();\n+#  define getcwd(buf, max) getwd (buf)\n+# elif !defined HAVE_DECL_GETCWD\n+char *getcwd ();\n+# endif\n+# ifndef HAVE_STPCPY\n+static char *stpcpy PARAMS ((char *dest, const char *src));\n+# endif\n+# ifndef HAVE_MEMPCPY\n+static void *mempcpy PARAMS ((void *dest, const void *src, size_t n));\n+# endif\n+#endif\n+\n+/* Amount to increase buffer size by in each try.  */\n+#define PATH_INCR 32\n+\n+/* The following is from pathmax.h.  */\n+/* Non-POSIX BSD systems might have gcc's limits.h, which doesn't define\n+   PATH_MAX but might cause redefinition warnings when sys/param.h is\n+   later included (as on MORE/BSD 4.3).  */\n+#if defined _POSIX_VERSION || (defined HAVE_LIMITS_H && !defined __GNUC__)\n+# include <limits.h>\n+#endif\n+\n+#ifndef _POSIX_PATH_MAX\n+# define _POSIX_PATH_MAX 255\n+#endif\n+\n+#if !defined PATH_MAX && defined _PC_PATH_MAX\n+# define PATH_MAX (pathconf (\"/\", _PC_PATH_MAX) < 1 ? 1024 : pathconf (\"/\", _PC_PATH_MAX))\n+#endif\n+\n+/* Don't include sys/param.h if it already has been.  */\n+#if defined HAVE_SYS_PARAM_H && !defined PATH_MAX && !defined MAXPATHLEN\n+# include <sys/param.h>\n+#endif\n+\n+#if !defined PATH_MAX && defined MAXPATHLEN\n+# define PATH_MAX MAXPATHLEN\n+#endif\n+\n+#ifndef PATH_MAX\n+# define PATH_MAX _POSIX_PATH_MAX\n+#endif\n+\n+/* Pathname support.\n+   ISSLASH(C)           tests whether C is a directory separator character.\n+   IS_ABSOLUTE_PATH(P)  tests whether P is an absolute path.  If it is not,\n+                        it may be concatenated to a directory pathname.\n+   IS_PATH_WITH_DIR(P)  tests whether P contains a directory specification.\n+ */\n+#if defined _WIN32 || defined __WIN32__ || defined __EMX__ || defined __DJGPP__\n+  /* Win32, OS/2, DOS */\n+# define ISSLASH(C) ((C) == '/' || (C) == '\\\\')\n+# define HAS_DEVICE(P) \\\n+    ((((P)[0] >= 'A' && (P)[0] <= 'Z') || ((P)[0] >= 'a' && (P)[0] <= 'z')) \\\n+     && (P)[1] == ':')\n+# define IS_ABSOLUTE_PATH(P) (ISSLASH ((P)[0]) || HAS_DEVICE (P))\n+# define IS_PATH_WITH_DIR(P) \\\n+    (strchr (P, '/') != NULL || strchr (P, '\\\\') != NULL || HAS_DEVICE (P))\n+#else\n+  /* Unix */\n+# define ISSLASH(C) ((C) == '/')\n+# define IS_ABSOLUTE_PATH(P) ISSLASH ((P)[0])\n+# define IS_PATH_WITH_DIR(P) (strchr (P, '/') != NULL)\n+#endif\n+\n+/* XPG3 defines the result of `setlocale (category, NULL)' as:\n+   ``Directs `setlocale()' to query `category' and return the current\n+     setting of `local'.''\n+   However it does not specify the exact format.  Neither do SUSV2 and\n+   ISO C 99.  So we can use this feature only on selected systems (e.g.\n+   those using GNU C Library).  */\n+#if defined _LIBC || (defined __GNU_LIBRARY__ && __GNU_LIBRARY__ >= 2)\n+# define HAVE_LOCALE_NULL\n+#endif\n+\n+/* This is the type used for the search tree where known translations\n+   are stored.  */\n+struct known_translation_t\n+{\n+  /* Domain in which to search.  */\n+  char *domainname;\n+\n+  /* The category.  */\n+  int category;\n+\n+  /* State of the catalog counter at the point the string was found.  */\n+  int counter;\n+\n+  /* Catalog where the string was found.  */\n+  struct loaded_l10nfile *domain;\n+\n+  /* And finally the translation.  */\n+  const char *translation;\n+  size_t translation_length;\n+\n+  /* Pointer to the string in question.  */\n+  char msgid[ZERO];\n+};\n+\n+/* Root of the search tree with known translations.  We can use this\n+   only if the system provides the `tsearch' function family.  */\n+#if defined HAVE_TSEARCH || defined _LIBC\n+# include <search.h>\n+\n+static void *root;\n+\n+# ifdef _LIBC\n+#  define tsearch __tsearch\n+# endif\n+\n+/* Function to compare two entries in the table of known translations.  */\n+static int transcmp PARAMS ((const void *p1, const void *p2));\n+static int\n+transcmp (p1, p2)\n+     const void *p1;\n+     const void *p2;\n+{\n+  const struct known_translation_t *s1;\n+  const struct known_translation_t *s2;\n+  int result;\n+\n+  s1 = (const struct known_translation_t *) p1;\n+  s2 = (const struct known_translation_t *) p2;\n+\n+  result = strcmp (s1->msgid, s2->msgid);\n+  if (result == 0)\n+    {\n+      result = strcmp (s1->domainname, s2->domainname);\n+      if (result == 0)\n+\t/* We compare the category last (though this is the cheapest\n+\t   operation) since it is hopefully always the same (namely\n+\t   LC_MESSAGES).  */\n+\tresult = s1->category - s2->category;\n+    }\n+\n+  return result;\n+}\n+#endif\n+\n+/* Name of the default domain used for gettext(3) prior any call to\n+   textdomain(3).  The default value for this is \"messages\".  */\n+const char _nl_default_default_domain[] = \"messages\";\n+\n+/* Value used as the default domain for gettext(3).  */\n+const char *_nl_current_default_domain = _nl_default_default_domain;\n+\n+/* Contains the default location of the message catalogs.  */\n+const char _nl_default_dirname[] = LOCALEDIR;\n+\n+/* List with bindings of specific domains created by bindtextdomain()\n+   calls.  */\n+struct binding *_nl_domain_bindings;\n+\n+/* Prototypes for local functions.  */\n+static char *plural_lookup PARAMS ((struct loaded_l10nfile *domain,\n+\t\t\t\t    unsigned long int n,\n+\t\t\t\t    const char *translation,\n+\t\t\t\t    size_t translation_len))\n+     internal_function;\n+static unsigned long int plural_eval PARAMS ((struct expression *pexp,\n+\t\t\t\t\t      unsigned long int n))\n+     internal_function;\n+static const char *category_to_name PARAMS ((int category)) internal_function;\n+static const char *guess_category_value PARAMS ((int category,\n+\t\t\t\t\t\t const char *categoryname))\n+     internal_function;\n+\n+\n+/* For those loosing systems which don't have `alloca' we have to add\n+   some additional code emulating it.  */\n+#ifdef HAVE_ALLOCA\n+/* Nothing has to be done.  */\n+# define ADD_BLOCK(list, address) /* nothing */\n+# define FREE_BLOCKS(list) /* nothing */\n+#else\n+struct block_list\n+{\n+  void *address;\n+  struct block_list *next;\n+};\n+# define ADD_BLOCK(list, addr)\t\t\t\t\t\t      \\\n+  do {\t\t\t\t\t\t\t\t\t      \\\n+    struct block_list *newp = (struct block_list *) malloc (sizeof (*newp));  \\\n+    /* If we cannot get a free block we cannot add the new element to\t      \\\n+       the list.  */\t\t\t\t\t\t\t      \\\n+    if (newp != NULL) {\t\t\t\t\t\t\t      \\\n+      newp->address = (addr);\t\t\t\t\t\t      \\\n+      newp->next = (list);\t\t\t\t\t\t      \\\n+      (list) = newp;\t\t\t\t\t\t\t      \\\n+    }\t\t\t\t\t\t\t\t\t      \\\n+  } while (0)\n+# define FREE_BLOCKS(list)\t\t\t\t\t\t      \\\n+  do {\t\t\t\t\t\t\t\t\t      \\\n+    while (list != NULL) {\t\t\t\t\t\t      \\\n+      struct block_list *old = list;\t\t\t\t\t      \\\n+      list = list->next;\t\t\t\t\t\t      \\\n+      free (old);\t\t\t\t\t\t\t      \\\n+    }\t\t\t\t\t\t\t\t\t      \\\n+  } while (0)\n+# undef alloca\n+# define alloca(size) (malloc (size))\n+#endif\t/* have alloca */\n+\n+\n+#ifdef _LIBC\n+/* List of blocks allocated for translations.  */\n+typedef struct transmem_list\n+{\n+  struct transmem_list *next;\n+  char data[ZERO];\n+} transmem_block_t;\n+static struct transmem_list *transmem_list;\n+#else\n+typedef unsigned char transmem_block_t;\n+#endif\n+\n+\n+/* Names for the libintl functions are a problem.  They must not clash\n+   with existing names and they should follow ANSI C.  But this source\n+   code is also used in GNU C Library where the names have a __\n+   prefix.  So we have to make a difference here.  */\n+#ifdef _LIBC\n+# define DCIGETTEXT __dcigettext\n+#else\n+# define DCIGETTEXT dcigettext__\n+#endif\n+\n+/* Lock variable to protect the global data in the gettext implementation.  */\n+#ifdef _LIBC\n+__libc_rwlock_define_initialized (, _nl_state_lock)\n+#endif\n+\n+/* Checking whether the binaries runs SUID must be done and glibc provides\n+   easier methods therefore we make a difference here.  */\n+#ifdef _LIBC\n+# define ENABLE_SECURE __libc_enable_secure\n+# define DETERMINE_SECURE\n+#else\n+# ifndef HAVE_GETUID\n+#  define getuid() 0\n+# endif\n+# ifndef HAVE_GETGID\n+#  define getgid() 0\n+# endif\n+# ifndef HAVE_GETEUID\n+#  define geteuid() getuid()\n+# endif\n+# ifndef HAVE_GETEGID\n+#  define getegid() getgid()\n+# endif\n+static int enable_secure;\n+# define ENABLE_SECURE (enable_secure == 1)\n+# define DETERMINE_SECURE \\\n+  if (enable_secure == 0)\t\t\t\t\t\t      \\\n+    {\t\t\t\t\t\t\t\t\t      \\\n+      if (getuid () != geteuid () || getgid () != getegid ())\t\t      \\\n+\tenable_secure = 1;\t\t\t\t\t\t      \\\n+      else\t\t\t\t\t\t\t\t      \\\n+\tenable_secure = -1;\t\t\t\t\t\t      \\\n+    }\n+#endif\n+\n+/* Look up MSGID in the DOMAINNAME message catalog for the current\n+   CATEGORY locale and, if PLURAL is nonzero, search over string\n+   depending on the plural form determined by N.  */\n+char *\n+DCIGETTEXT (domainname, msgid1, msgid2, plural, n, category)\n+     const char *domainname;\n+     const char *msgid1;\n+     const char *msgid2;\n+     int plural;\n+     unsigned long int n;\n+     int category;\n+{\n+#ifndef HAVE_ALLOCA\n+  struct block_list *block_list = NULL;\n+#endif\n+  struct loaded_l10nfile *domain;\n+  struct binding *binding;\n+  const char *categoryname;\n+  const char *categoryvalue;\n+  char *dirname, *xdomainname;\n+  char *single_locale;\n+  char *retval;\n+  size_t retlen;\n+  int saved_errno;\n+#if defined HAVE_TSEARCH || defined _LIBC\n+  struct known_translation_t *search;\n+  struct known_translation_t **foundp = NULL;\n+  size_t msgid_len;\n+#endif\n+  size_t domainname_len;\n+\n+  /* If no real MSGID is given return NULL.  */\n+  if (msgid1 == NULL)\n+    return NULL;\n+\n+  __libc_rwlock_rdlock (_nl_state_lock);\n+\n+  /* If DOMAINNAME is NULL, we are interested in the default domain.  If\n+     CATEGORY is not LC_MESSAGES this might not make much sense but the\n+     definition left this undefined.  */\n+  if (domainname == NULL)\n+    domainname = _nl_current_default_domain;\n+\n+#if defined HAVE_TSEARCH || defined _LIBC\n+  msgid_len = strlen (msgid1) + 1;\n+\n+  /* Try to find the translation among those which we found at\n+     some time.  */\n+  search = (struct known_translation_t *)\n+\t   alloca (offsetof (struct known_translation_t, msgid) + msgid_len);\n+  memcpy (search->msgid, msgid1, msgid_len);\n+  search->domainname = (char *) domainname;\n+  search->category = category;\n+\n+  foundp = (struct known_translation_t **) tfind (search, &root, transcmp);\n+  if (foundp != NULL && (*foundp)->counter == _nl_msg_cat_cntr)\n+    {\n+      /* Now deal with plural.  */\n+      if (plural)\n+\tretval = plural_lookup ((*foundp)->domain, n, (*foundp)->translation,\n+\t\t\t\t(*foundp)->translation_length);\n+      else\n+\tretval = (char *) (*foundp)->translation;\n+\n+      __libc_rwlock_unlock (_nl_state_lock);\n+      return retval;\n+    }\n+#endif\n+\n+  /* Preserve the `errno' value.  */\n+  saved_errno = errno;\n+\n+  /* See whether this is a SUID binary or not.  */\n+  DETERMINE_SECURE;\n+\n+  /* First find matching binding.  */\n+  for (binding = _nl_domain_bindings; binding != NULL; binding = binding->next)\n+    {\n+      int compare = strcmp (domainname, binding->domainname);\n+      if (compare == 0)\n+\t/* We found it!  */\n+\tbreak;\n+      if (compare < 0)\n+\t{\n+\t  /* It is not in the list.  */\n+\t  binding = NULL;\n+\t  break;\n+\t}\n+    }\n+\n+  if (binding == NULL)\n+    dirname = (char *) _nl_default_dirname;\n+  else if (IS_ABSOLUTE_PATH (binding->dirname))\n+    dirname = binding->dirname;\n+  else\n+    {\n+      /* We have a relative path.  Make it absolute now.  */\n+      size_t dirname_len = strlen (binding->dirname) + 1;\n+      size_t path_max;\n+      char *ret;\n+\n+      path_max = (unsigned int) PATH_MAX;\n+      path_max += 2;\t\t/* The getcwd docs say to do this.  */\n+\n+      for (;;)\n+\t{\n+\t  dirname = (char *) alloca (path_max + dirname_len);\n+\t  ADD_BLOCK (block_list, dirname);\n+\n+\t  __set_errno (0);\n+\t  ret = getcwd (dirname, path_max);\n+\t  if (ret != NULL || errno != ERANGE)\n+\t    break;\n+\n+\t  path_max += path_max / 2;\n+\t  path_max += PATH_INCR;\n+\t}\n+\n+      if (ret == NULL)\n+\t{\n+\t  /* We cannot get the current working directory.  Don't signal an\n+\t     error but simply return the default string.  */\n+\t  FREE_BLOCKS (block_list);\n+\t  __libc_rwlock_unlock (_nl_state_lock);\n+\t  __set_errno (saved_errno);\n+\t  return (plural == 0\n+\t\t  ? (char *) msgid1\n+\t\t  /* Use the Germanic plural rule.  */\n+\t\t  : n == 1 ? (char *) msgid1 : (char *) msgid2);\n+\t}\n+\n+      stpcpy (stpcpy (strchr (dirname, '\\0'), \"/\"), binding->dirname);\n+    }\n+\n+  /* Now determine the symbolic name of CATEGORY and its value.  */\n+  categoryname = category_to_name (category);\n+  categoryvalue = guess_category_value (category, categoryname);\n+\n+  domainname_len = strlen (domainname);\n+  xdomainname = (char *) alloca (strlen (categoryname)\n+\t\t\t\t + domainname_len + 5);\n+  ADD_BLOCK (block_list, xdomainname);\n+\n+  stpcpy (mempcpy (stpcpy (stpcpy (xdomainname, categoryname), \"/\"),\n+\t\t  domainname, domainname_len),\n+\t  \".mo\");\n+\n+  /* Creating working area.  */\n+  single_locale = (char *) alloca (strlen (categoryvalue) + 1);\n+  ADD_BLOCK (block_list, single_locale);\n+\n+\n+  /* Search for the given string.  This is a loop because we perhaps\n+     got an ordered list of languages to consider for the translation.  */\n+  while (1)\n+    {\n+      /* Make CATEGORYVALUE point to the next element of the list.  */\n+      while (categoryvalue[0] != '\\0' && categoryvalue[0] == ':')\n+\t++categoryvalue;\n+      if (categoryvalue[0] == '\\0')\n+\t{\n+\t  /* The whole contents of CATEGORYVALUE has been searched but\n+\t     no valid entry has been found.  We solve this situation\n+\t     by implicitly appending a \"C\" entry, i.e. no translation\n+\t     will take place.  */\n+\t  single_locale[0] = 'C';\n+\t  single_locale[1] = '\\0';\n+\t}\n+      else\n+\t{\n+\t  char *cp = single_locale;\n+\t  while (categoryvalue[0] != '\\0' && categoryvalue[0] != ':')\n+\t    *cp++ = *categoryvalue++;\n+\t  *cp = '\\0';\n+\n+\t  /* When this is a SUID binary we must not allow accessing files\n+\t     outside the dedicated directories.  */\n+\t  if (ENABLE_SECURE && IS_PATH_WITH_DIR (single_locale))\n+\t    /* Ingore this entry.  */\n+\t    continue;\n+\t}\n+\n+      /* If the current locale value is C (or POSIX) we don't load a\n+\t domain.  Return the MSGID.  */\n+      if (strcmp (single_locale, \"C\") == 0\n+\t  || strcmp (single_locale, \"POSIX\") == 0)\n+\t{\n+\t  FREE_BLOCKS (block_list);\n+\t  __libc_rwlock_unlock (_nl_state_lock);\n+\t  __set_errno (saved_errno);\n+\t  return (plural == 0\n+\t\t  ? (char *) msgid1\n+\t\t  /* Use the Germanic plural rule.  */\n+\t\t  : n == 1 ? (char *) msgid1 : (char *) msgid2);\n+\t}\n+\n+\n+      /* Find structure describing the message catalog matching the\n+\t DOMAINNAME and CATEGORY.  */\n+      domain = _nl_find_domain (dirname, single_locale, xdomainname, binding);\n+\n+      if (domain != NULL)\n+\t{\n+\t  retval = _nl_find_msg (domain, binding, msgid1, &retlen);\n+\n+\t  if (retval == NULL)\n+\t    {\n+\t      int cnt;\n+\n+\t      for (cnt = 0; domain->successor[cnt] != NULL; ++cnt)\n+\t\t{\n+\t\t  retval = _nl_find_msg (domain->successor[cnt], binding,\n+\t\t\t\t\t msgid1, &retlen);\n+\n+\t\t  if (retval != NULL)\n+\t\t    {\n+\t\t      domain = domain->successor[cnt];\n+\t\t      break;\n+\t\t    }\n+\t\t}\n+\t    }\n+\n+\t  if (retval != NULL)\n+\t    {\n+\t      /* Found the translation of MSGID1 in domain DOMAIN:\n+\t\t starting at RETVAL, RETLEN bytes.  */\n+\t      FREE_BLOCKS (block_list);\n+\t      __set_errno (saved_errno);\n+#if defined HAVE_TSEARCH || defined _LIBC\n+\t      if (foundp == NULL)\n+\t\t{\n+\t\t  /* Create a new entry and add it to the search tree.  */\n+\t\t  struct known_translation_t *newp;\n+\n+\t\t  newp = (struct known_translation_t *)\n+\t\t    malloc (offsetof (struct known_translation_t, msgid)\n+\t\t\t    + msgid_len + domainname_len + 1);\n+\t\t  if (newp != NULL)\n+\t\t    {\n+\t\t      newp->domainname =\n+\t\t\tmempcpy (newp->msgid, msgid1, msgid_len);\n+\t\t      memcpy (newp->domainname, domainname, domainname_len + 1);\n+\t\t      newp->category = category;\n+\t\t      newp->counter = _nl_msg_cat_cntr;\n+\t\t      newp->domain = domain;\n+\t\t      newp->translation = retval;\n+\t\t      newp->translation_length = retlen;\n+\n+\t\t      /* Insert the entry in the search tree.  */\n+\t\t      foundp = (struct known_translation_t **)\n+\t\t\ttsearch (newp, &root, transcmp);\n+\t\t      if (foundp == NULL\n+\t\t\t  || __builtin_expect (*foundp != newp, 0))\n+\t\t\t/* The insert failed.  */\n+\t\t\tfree (newp);\n+\t\t    }\n+\t\t}\n+\t      else\n+\t\t{\n+\t\t  /* We can update the existing entry.  */\n+\t\t  (*foundp)->counter = _nl_msg_cat_cntr;\n+\t\t  (*foundp)->domain = domain;\n+\t\t  (*foundp)->translation = retval;\n+\t\t  (*foundp)->translation_length = retlen;\n+\t\t}\n+#endif\n+\t      /* Now deal with plural.  */\n+\t      if (plural)\n+\t\tretval = plural_lookup (domain, n, retval, retlen);\n+\n+\t      __libc_rwlock_unlock (_nl_state_lock);\n+\t      return retval;\n+\t    }\n+\t}\n+    }\n+  /* NOTREACHED */\n+}\n+\n+\n+char *\n+internal_function\n+_nl_find_msg (domain_file, domainbinding, msgid, lengthp)\n+     struct loaded_l10nfile *domain_file;\n+     struct binding *domainbinding;\n+     const char *msgid;\n+     size_t *lengthp;\n+{\n+  struct loaded_domain *domain;\n+  size_t act;\n+  char *result;\n+  size_t resultlen;\n+\n+  if (domain_file->decided == 0)\n+    _nl_load_domain (domain_file, domainbinding);\n+\n+  if (domain_file->data == NULL)\n+    return NULL;\n+\n+  domain = (struct loaded_domain *) domain_file->data;\n+\n+  /* Locate the MSGID and its translation.  */\n+  if (domain->hash_size > 2 && domain->hash_tab != NULL)\n+    {\n+      /* Use the hashing table.  */\n+      nls_uint32 len = strlen (msgid);\n+      nls_uint32 hash_val = hash_string (msgid);\n+      nls_uint32 idx = hash_val % domain->hash_size;\n+      nls_uint32 incr = 1 + (hash_val % (domain->hash_size - 2));\n+\n+      while (1)\n+\t{\n+\t  nls_uint32 nstr = W (domain->must_swap, domain->hash_tab[idx]);\n+\n+\t  if (nstr == 0)\n+\t    /* Hash table entry is empty.  */\n+\t    return NULL;\n+\n+\t  /* Compare msgid with the original string at index nstr-1.\n+\t     We compare the lengths with >=, not ==, because plural entries\n+\t     are represented by strings with an embedded NUL.  */\n+\t  if (W (domain->must_swap, domain->orig_tab[nstr - 1].length) >= len\n+\t      && (strcmp (msgid,\n+\t\t\t  domain->data + W (domain->must_swap,\n+\t\t\t\t\t    domain->orig_tab[nstr - 1].offset))\n+\t\t  == 0))\n+\t    {\n+\t      act = nstr - 1;\n+\t      goto found;\n+\t    }\n+\n+\t  if (idx >= domain->hash_size - incr)\n+\t    idx -= domain->hash_size - incr;\n+\t  else\n+\t    idx += incr;\n+\t}\n+      /* NOTREACHED */\n+    }\n+  else\n+    {\n+      /* Try the default method:  binary search in the sorted array of\n+\t messages.  */\n+      size_t top, bottom;\n+\n+      bottom = 0;\n+      act = 0;\n+      top = domain->nstrings;\n+      while (bottom < top)\n+\t{\n+\t  int cmp_val;\n+\n+\t  act = (bottom + top) / 2;\n+\t  cmp_val = strcmp (msgid, (domain->data\n+\t\t\t\t    + W (domain->must_swap,\n+\t\t\t\t\t domain->orig_tab[act].offset)));\n+\t  if (cmp_val < 0)\n+\t    top = act;\n+\t  else if (cmp_val > 0)\n+\t    bottom = act + 1;\n+\t  else\n+\t    goto found;\n+\t}\n+      /* No translation was found.  */\n+      return NULL;\n+    }\n+\n+ found:\n+  /* The translation was found at index ACT.  If we have to convert the\n+     string to use a different character set, this is the time.  */\n+  result = ((char *) domain->data\n+\t    + W (domain->must_swap, domain->trans_tab[act].offset));\n+  resultlen = W (domain->must_swap, domain->trans_tab[act].length) + 1;\n+\n+#if defined _LIBC || HAVE_ICONV\n+  if (domain->codeset_cntr\n+      != (domainbinding != NULL ? domainbinding->codeset_cntr : 0))\n+    {\n+      /* The domain's codeset has changed through bind_textdomain_codeset()\n+\t since the message catalog was initialized or last accessed.  We\n+\t have to reinitialize the converter.  */\n+      _nl_free_domain_conv (domain);\n+      _nl_init_domain_conv (domain_file, domain, domainbinding);\n+    }\n+\n+  if (\n+# ifdef _LIBC\n+      domain->conv != (__gconv_t) -1\n+# else\n+#  if HAVE_ICONV\n+      domain->conv != (iconv_t) -1\n+#  endif\n+# endif\n+      )\n+    {\n+      /* We are supposed to do a conversion.  First allocate an\n+\t appropriate table with the same structure as the table\n+\t of translations in the file, where we can put the pointers\n+\t to the converted strings in.\n+\t There is a slight complication with plural entries.  They\n+\t are represented by consecutive NUL terminated strings.  We\n+\t handle this case by converting RESULTLEN bytes, including\n+\t NULs.  */\n+\n+      if (domain->conv_tab == NULL\n+\t  && ((domain->conv_tab = (char **) calloc (domain->nstrings,\n+\t\t\t\t\t\t    sizeof (char *)))\n+\t      == NULL))\n+\t/* Mark that we didn't succeed allocating a table.  */\n+\tdomain->conv_tab = (char **) -1;\n+\n+      if (__builtin_expect (domain->conv_tab == (char **) -1, 0))\n+\t/* Nothing we can do, no more memory.  */\n+\tgoto converted;\n+\n+      if (domain->conv_tab[act] == NULL)\n+\t{\n+\t  /* We haven't used this string so far, so it is not\n+\t     translated yet.  Do this now.  */\n+\t  /* We use a bit more efficient memory handling.\n+\t     We allocate always larger blocks which get used over\n+\t     time.  This is faster than many small allocations.   */\n+\t  __libc_lock_define_initialized (static, lock)\n+# define INITIAL_BLOCK_SIZE\t4080\n+\t  static unsigned char *freemem;\n+\t  static size_t freemem_size;\n+\n+\t  const unsigned char *inbuf;\n+\t  unsigned char *outbuf;\n+\t  int malloc_count;\n+# ifndef _LIBC\n+\t  transmem_block_t *transmem_list = NULL;\n+# endif\n+\n+\t  __libc_lock_lock (lock);\n+\n+\t  inbuf = (const unsigned char *) result;\n+\t  outbuf = freemem + sizeof (size_t);\n+\n+\t  malloc_count = 0;\n+\t  while (1)\n+\t    {\n+\t      transmem_block_t *newmem;\n+# ifdef _LIBC\n+\t      size_t non_reversible;\n+\t      int res;\n+\n+\t      if (freemem_size < sizeof (size_t))\n+\t\tgoto resize_freemem;\n+\n+\t      res = __gconv (domain->conv,\n+\t\t\t     &inbuf, inbuf + resultlen,\n+\t\t\t     &outbuf,\n+\t\t\t     outbuf + freemem_size - sizeof (size_t),\n+\t\t\t     &non_reversible);\n+\n+\t      if (res == __GCONV_OK || res == __GCONV_EMPTY_INPUT)\n+\t\tbreak;\n+\n+\t      if (res != __GCONV_FULL_OUTPUT)\n+\t\t{\n+\t\t  __libc_lock_unlock (lock);\n+\t\t  goto converted;\n+\t\t}\n+\n+\t      inbuf = result;\n+# else\n+#  if HAVE_ICONV\n+\t      const char *inptr = (const char *) inbuf;\n+\t      size_t inleft = resultlen;\n+\t      char *outptr = (char *) outbuf;\n+\t      size_t outleft;\n+\n+\t      if (freemem_size < sizeof (size_t))\n+\t\tgoto resize_freemem;\n+\n+\t      outleft = freemem_size - sizeof (size_t);\n+\t      if (iconv (domain->conv,\n+\t\t\t (ICONV_CONST char **) &inptr, &inleft,\n+\t\t\t &outptr, &outleft)\n+\t\t  != (size_t) (-1))\n+\t\t{\n+\t\t  outbuf = (unsigned char *) outptr;\n+\t\t  break;\n+\t\t}\n+\t      if (errno != E2BIG)\n+\t\t{\n+\t\t  __libc_lock_unlock (lock);\n+\t\t  goto converted;\n+\t\t}\n+#  endif\n+# endif\n+\n+\t    resize_freemem:\n+\t      /* We must allocate a new buffer or resize the old one.  */\n+\t      if (malloc_count > 0)\n+\t\t{\n+\t\t  ++malloc_count;\n+\t\t  freemem_size = malloc_count * INITIAL_BLOCK_SIZE;\n+\t\t  newmem = (transmem_block_t *) realloc (transmem_list,\n+\t\t\t\t\t\t\t freemem_size);\n+# ifdef _LIBC\n+\t\t  if (newmem != NULL)\n+\t\t    transmem_list = transmem_list->next;\n+\t\t  else\n+\t\t    {\n+\t\t      struct transmem_list *old = transmem_list;\n+\n+\t\t      transmem_list = transmem_list->next;\n+\t\t      free (old);\n+\t\t    }\n+# endif\n+\t\t}\n+\t      else\n+\t\t{\n+\t\t  malloc_count = 1;\n+\t\t  freemem_size = INITIAL_BLOCK_SIZE;\n+\t\t  newmem = (transmem_block_t *) malloc (freemem_size);\n+\t\t}\n+\t      if (__builtin_expect (newmem == NULL, 0))\n+\t\t{\n+\t\t  freemem = NULL;\n+\t\t  freemem_size = 0;\n+\t\t  __libc_lock_unlock (lock);\n+\t\t  goto converted;\n+\t\t}\n+\n+# ifdef _LIBC\n+\t      /* Add the block to the list of blocks we have to free\n+                 at some point.  */\n+\t      newmem->next = transmem_list;\n+\t      transmem_list = newmem;\n+\n+\t      freemem = newmem->data;\n+\t      freemem_size -= offsetof (struct transmem_list, data);\n+# else\n+\t      transmem_list = newmem;\n+\t      freemem = newmem;\n+# endif\n+\n+\t      outbuf = freemem + sizeof (size_t);\n+\t    }\n+\n+\t  /* We have now in our buffer a converted string.  Put this\n+\t     into the table of conversions.  */\n+\t  *(size_t *) freemem = outbuf - freemem - sizeof (size_t);\n+\t  domain->conv_tab[act] = (char *) freemem;\n+\t  /* Shrink freemem, but keep it aligned.  */\n+\t  freemem_size -= outbuf - freemem;\n+\t  freemem = outbuf;\n+\t  freemem += freemem_size & (alignof (size_t) - 1);\n+\t  freemem_size = freemem_size & ~ (alignof (size_t) - 1);\n+\n+\t  __libc_lock_unlock (lock);\n+\t}\n+\n+      /* Now domain->conv_tab[act] contains the translation of all\n+\t the plural variants.  */\n+      result = domain->conv_tab[act] + sizeof (size_t);\n+      resultlen = *(size_t *) domain->conv_tab[act];\n+    }\n+\n+ converted:\n+  /* The result string is converted.  */\n+\n+#endif /* _LIBC || HAVE_ICONV */\n+\n+  *lengthp = resultlen;\n+  return result;\n+}\n+\n+\n+/* Look up a plural variant.  */\n+static char *\n+internal_function\n+plural_lookup (domain, n, translation, translation_len)\n+     struct loaded_l10nfile *domain;\n+     unsigned long int n;\n+     const char *translation;\n+     size_t translation_len;\n+{\n+  struct loaded_domain *domaindata = (struct loaded_domain *) domain->data;\n+  unsigned long int index;\n+  const char *p;\n+\n+  index = plural_eval (domaindata->plural, n);\n+  if (index >= domaindata->nplurals)\n+    /* This should never happen.  It means the plural expression and the\n+       given maximum value do not match.  */\n+    index = 0;\n+\n+  /* Skip INDEX strings at TRANSLATION.  */\n+  p = translation;\n+  while (index-- > 0)\n+    {\n+#ifdef _LIBC\n+      p = __rawmemchr (p, '\\0');\n+#else\n+      p = strchr (p, '\\0');\n+#endif\n+      /* And skip over the NUL byte.  */\n+      p++;\n+\n+      if (p >= translation + translation_len)\n+\t/* This should never happen.  It means the plural expression\n+\t   evaluated to a value larger than the number of variants\n+\t   available for MSGID1.  */\n+\treturn (char *) translation;\n+    }\n+  return (char *) p;\n+}\n+\n+\n+/* Function to evaluate the plural expression and return an index value.  */\n+static unsigned long int\n+internal_function\n+plural_eval (pexp, n)\n+     struct expression *pexp;\n+     unsigned long int n;\n+{\n+  switch (pexp->nargs)\n+    {\n+    case 0:\n+      switch (pexp->operation)\n+\t{\n+\tcase var:\n+\t  return n;\n+\tcase num:\n+\t  return pexp->val.num;\n+\tdefault:\n+\t  break;\n+\t}\n+      /* NOTREACHED */\n+      break;\n+    case 1:\n+      {\n+\t/* pexp->operation must be lnot.  */\n+\tunsigned long int arg = plural_eval (pexp->val.args[0], n);\n+\treturn ! arg;\n+      }\n+    case 2:\n+      {\n+\tunsigned long int leftarg = plural_eval (pexp->val.args[0], n);\n+\tif (pexp->operation == lor)\n+\t  return leftarg || plural_eval (pexp->val.args[1], n);\n+\telse if (pexp->operation == land)\n+\t  return leftarg && plural_eval (pexp->val.args[1], n);\n+\telse\n+\t  {\n+\t    unsigned long int rightarg = plural_eval (pexp->val.args[1], n);\n+\n+\t    switch (pexp->operation)\n+\t      {\n+\t      case mult:\n+\t\treturn leftarg * rightarg;\n+\t      case divide:\n+\t\treturn leftarg / rightarg;\n+\t      case module:\n+\t\treturn leftarg % rightarg;\n+\t      case plus:\n+\t\treturn leftarg + rightarg;\n+\t      case minus:\n+\t\treturn leftarg - rightarg;\n+\t      case less_than:\n+\t\treturn leftarg < rightarg;\n+\t      case greater_than:\n+\t\treturn leftarg > rightarg;\n+\t      case less_or_equal:\n+\t\treturn leftarg <= rightarg;\n+\t      case greater_or_equal:\n+\t\treturn leftarg >= rightarg;\n+\t      case equal:\n+\t\treturn leftarg == rightarg;\n+\t      case not_equal:\n+\t\treturn leftarg != rightarg;\n+\t      default:\n+\t\tbreak;\n+\t      }\n+\t  }\n+\t/* NOTREACHED */\n+\tbreak;\n+      }\n+    case 3:\n+      {\n+\t/* pexp->operation must be qmop.  */\n+\tunsigned long int boolarg = plural_eval (pexp->val.args[0], n);\n+\treturn plural_eval (pexp->val.args[boolarg ? 1 : 2], n);\n+      }\n+    }\n+  /* NOTREACHED */\n+  return 0;\n+}\n+\n+\n+/* Return string representation of locale CATEGORY.  */\n+static const char *\n+internal_function\n+category_to_name (category)\n+     int category;\n+{\n+  const char *retval;\n+\n+  switch (category)\n+  {\n+#ifdef LC_COLLATE\n+  case LC_COLLATE:\n+    retval = \"LC_COLLATE\";\n+    break;\n+#endif\n+#ifdef LC_CTYPE\n+  case LC_CTYPE:\n+    retval = \"LC_CTYPE\";\n+    break;\n+#endif\n+#ifdef LC_MONETARY\n+  case LC_MONETARY:\n+    retval = \"LC_MONETARY\";\n+    break;\n+#endif\n+#ifdef LC_NUMERIC\n+  case LC_NUMERIC:\n+    retval = \"LC_NUMERIC\";\n+    break;\n+#endif\n+#ifdef LC_TIME\n+  case LC_TIME:\n+    retval = \"LC_TIME\";\n+    break;\n+#endif\n+#ifdef LC_MESSAGES\n+  case LC_MESSAGES:\n+    retval = \"LC_MESSAGES\";\n+    break;\n+#endif\n+#ifdef LC_RESPONSE\n+  case LC_RESPONSE:\n+    retval = \"LC_RESPONSE\";\n+    break;\n+#endif\n+#ifdef LC_ALL\n+  case LC_ALL:\n+    /* This might not make sense but is perhaps better than any other\n+       value.  */\n+    retval = \"LC_ALL\";\n+    break;\n+#endif\n+  default:\n+    /* If you have a better idea for a default value let me know.  */\n+    retval = \"LC_XXX\";\n+  }\n+\n+  return retval;\n+}\n+\n+/* Guess value of current locale from value of the environment variables.  */\n+static const char *\n+internal_function\n+guess_category_value (category, categoryname)\n+     int category;\n+     const char *categoryname;\n+{\n+  const char *language;\n+  const char *retval;\n+  (void) category;  /* shut up compiler */\n+  (void) categoryname;  /* ditto */\n+  \n+  /* The highest priority value is the `LANGUAGE' environment\n+     variable.  But we don't use the value if the currently selected\n+     locale is the C locale.  This is a GNU extension.  */\n+  language = getenv (\"LANGUAGE\");\n+  if (language != NULL && language[0] == '\\0')\n+    language = NULL;\n+\n+  /* We have to proceed with the POSIX methods of looking to `LC_ALL',\n+     `LC_xxx', and `LANG'.  On some systems this can be done by the\n+     `setlocale' function itself.  */\n+#if defined _LIBC || (defined HAVE_SETLOCALE && defined HAVE_LC_MESSAGES && defined HAVE_LOCALE_NULL)\n+  retval = setlocale (category, NULL);\n+#else\n+  /* Setting of LC_ALL overwrites all other.  */\n+  retval = getenv (\"LC_ALL\");\n+  if (retval == NULL || retval[0] == '\\0')\n+    {\n+      /* Next comes the name of the desired category.  */\n+      retval = getenv (categoryname);\n+      if (retval == NULL || retval[0] == '\\0')\n+\t{\n+\t  /* Last possibility is the LANG environment variable.  */\n+\t  retval = getenv (\"LANG\");\n+\t  if (retval == NULL || retval[0] == '\\0')\n+\t    /* We use C as the default domain.  POSIX says this is\n+\t       implementation defined.  */\n+\t    return \"C\";\n+\t}\n+    }\n+#endif\n+\n+  return language != NULL && strcmp (retval, \"C\") != 0 ? language : retval;\n+}\n+\n+/* @@ begin of epilog @@ */\n+\n+/* We don't want libintl.a to depend on any other library.  So we\n+   avoid the non-standard function stpcpy.  In GNU C Library this\n+   function is available, though.  Also allow the symbol HAVE_STPCPY\n+   to be defined.  */\n+#if !_LIBC && !HAVE_STPCPY\n+static char *\n+stpcpy (dest, src)\n+     char *dest;\n+     const char *src;\n+{\n+  while ((*dest++ = *src++) != '\\0')\n+    /* Do nothing. */ ;\n+  return dest - 1;\n+}\n+#endif\n+\n+#if !_LIBC && !HAVE_MEMPCPY\n+static void *\n+mempcpy (dest, src, n)\n+     void *dest;\n+     const void *src;\n+     size_t n;\n+{\n+  return (void *) ((char *) memcpy (dest, src, n) + n);\n+}\n+#endif\n+\n+\n+#ifdef _LIBC\n+/* If we want to free all resources we have to do some work at\n+   program's end.  */\n+static void __attribute__ ((unused))\n+free_mem (void)\n+{\n+  void *old;\n+\n+  while (_nl_domain_bindings != NULL)\n+    {\n+      struct binding *oldp = _nl_domain_bindings;\n+      _nl_domain_bindings = _nl_domain_bindings->next;\n+      if (oldp->dirname != _nl_default_dirname)\n+\t/* Yes, this is a pointer comparison.  */\n+\tfree (oldp->dirname);\n+      free (oldp->codeset);\n+      free (oldp);\n+    }\n+\n+  if (_nl_current_default_domain != _nl_default_default_domain)\n+    /* Yes, again a pointer comparison.  */\n+    free ((char *) _nl_current_default_domain);\n+\n+  /* Remove the search tree with the known translations.  */\n+  __tdestroy (root, free);\n+  root = NULL;\n+\n+  while (transmem_list != NULL)\n+    {\n+      old = transmem_list;\n+      transmem_list = transmem_list->next;\n+      free (old);\n+    }\n+}\n+\n+text_set_element (__libc_subfreeres, free_mem);\n+#endif"}, {"sha": "c16af21269c1be57bcf0563981ab0610274f8251", "filename": "gcc/intl/dcngettext.c", "status": "added", "additions": 60, "deletions": 0, "changes": 60, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Fdcngettext.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Fdcngettext.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fintl%2Fdcngettext.c?ref=71a94577632a238bf4e112f0f016819ead09f1d5", "patch": "@@ -0,0 +1,60 @@\n+/* Implementation of the dcngettext(3) function.\n+   Copyright (C) 1995-1999, 2000, 2001 Free Software Foundation, Inc.\n+\n+   This program is free software; you can redistribute it and/or modify it\n+   under the terms of the GNU Library General Public License as published\n+   by the Free Software Foundation; either version 2, or (at your option)\n+   any later version.\n+\n+   This program is distributed in the hope that it will be useful,\n+   but WITHOUT ANY WARRANTY; without even the implied warranty of\n+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+   Library General Public License for more details.\n+\n+   You should have received a copy of the GNU Library General Public\n+   License along with this program; if not, write to the Free Software\n+   Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307,\n+   USA.  */\n+\n+#ifdef HAVE_CONFIG_H\n+# include <config.h>\n+#endif\n+\n+#include \"gettextP.h\"\n+#ifdef _LIBC\n+# include <libintl.h>\n+#else\n+# include \"libgnuintl.h\"\n+#endif\n+\n+/* @@ end of prolog @@ */\n+\n+/* Names for the libintl functions are a problem.  They must not clash\n+   with existing names and they should follow ANSI C.  But this source\n+   code is also used in GNU C Library where the names have a __\n+   prefix.  So we have to make a difference here.  */\n+#ifdef _LIBC\n+# define DCNGETTEXT __dcngettext\n+# define DCIGETTEXT __dcigettext\n+#else\n+# define DCNGETTEXT dcngettext__\n+# define DCIGETTEXT dcigettext__\n+#endif\n+\n+/* Look up MSGID in the DOMAINNAME message catalog for the current CATEGORY\n+   locale.  */\n+char *\n+DCNGETTEXT (domainname, msgid1, msgid2, n, category)\n+     const char *domainname;\n+     const char *msgid1;\n+     const char *msgid2;\n+     unsigned long int n;\n+     int category;\n+{\n+  return DCIGETTEXT (domainname, msgid1, msgid2, 1, n, category);\n+}\n+\n+#ifdef _LIBC\n+/* Alias for function name in GNU C Library.  */\n+weak_alias (__dcngettext, dcngettext);\n+#endif"}, {"sha": "3651207a0f680f3dcad617ffc91986aaaf21724c", "filename": "gcc/intl/dgettext.c", "status": "modified", "additions": 14, "deletions": 14, "changes": 28, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Fdgettext.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Fdgettext.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fintl%2Fdgettext.c?ref=71a94577632a238bf4e112f0f016819ead09f1d5", "patch": "@@ -1,32 +1,32 @@\n-/* Implementation of the dgettext(3) function\n-   Copyright (C) 1995, 1996, 1997 Free Software Foundation, Inc.\n+/* Implementation of the dgettext(3) function.\n+   Copyright (C) 1995-1997, 2000, 2001 Free Software Foundation, Inc.\n \n-   This program is free software; you can redistribute it and/or modify\n-   it under the terms of the GNU General Public License as published by\n-   the Free Software Foundation; either version 2, or (at your option)\n+   This program is free software; you can redistribute it and/or modify it\n+   under the terms of the GNU Library General Public License as published\n+   by the Free Software Foundation; either version 2, or (at your option)\n    any later version.\n \n    This program is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n-   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n-   GNU General Public License for more details.\n+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+   Library General Public License for more details.\n \n-   You should have received a copy of the GNU General Public License\n-   along with this program; if not, write to the Free Software Foundation,\n-   Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.  */\n+   You should have received a copy of the GNU Library General Public\n+   License along with this program; if not, write to the Free Software\n+   Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307,\n+   USA.  */\n \n #ifdef HAVE_CONFIG_H\n # include <config.h>\n #endif\n \n-#if defined HAVE_LOCALE_H || defined _LIBC\n-# include <locale.h>\n-#endif\n+#include <locale.h>\n \n+#include \"gettextP.h\"\n #ifdef _LIBC\n # include <libintl.h>\n #else\n-# include \"libgettext.h\"\n+# include \"libgnuintl.h\"\n #endif\n \n /* @@ end of prolog @@ */"}, {"sha": "f214e95b471f22d3a635c58232177cf9fa3002ae", "filename": "gcc/intl/dngettext.c", "status": "added", "additions": 61, "deletions": 0, "changes": 61, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Fdngettext.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Fdngettext.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fintl%2Fdngettext.c?ref=71a94577632a238bf4e112f0f016819ead09f1d5", "patch": "@@ -0,0 +1,61 @@\n+/* Implementation of the dngettext(3) function.\n+   Copyright (C) 1995-1997, 2000, 2001 Free Software Foundation, Inc.\n+\n+   This program is free software; you can redistribute it and/or modify it\n+   under the terms of the GNU Library General Public License as published\n+   by the Free Software Foundation; either version 2, or (at your option)\n+   any later version.\n+\n+   This program is distributed in the hope that it will be useful,\n+   but WITHOUT ANY WARRANTY; without even the implied warranty of\n+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+   Library General Public License for more details.\n+\n+   You should have received a copy of the GNU Library General Public\n+   License along with this program; if not, write to the Free Software\n+   Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307,\n+   USA.  */\n+\n+#ifdef HAVE_CONFIG_H\n+# include <config.h>\n+#endif\n+\n+#include <locale.h>\n+\n+#include \"gettextP.h\"\n+#ifdef _LIBC\n+# include <libintl.h>\n+#else\n+# include \"libgnuintl.h\"\n+#endif\n+\n+/* @@ end of prolog @@ */\n+\n+/* Names for the libintl functions are a problem.  They must not clash\n+   with existing names and they should follow ANSI C.  But this source\n+   code is also used in GNU C Library where the names have a __\n+   prefix.  So we have to make a difference here.  */\n+#ifdef _LIBC\n+# define DNGETTEXT __dngettext\n+# define DCNGETTEXT __dcngettext\n+#else\n+# define DNGETTEXT dngettext__\n+# define DCNGETTEXT dcngettext__\n+#endif\n+\n+/* Look up MSGID in the DOMAINNAME message catalog of the current\n+   LC_MESSAGES locale and skip message according to the plural form.  */\n+char *\n+DNGETTEXT (domainname, msgid1, msgid2, n)\n+     const char *domainname;\n+     const char *msgid1;\n+     const char *msgid2;\n+     unsigned long int n;\n+{\n+  return DCNGETTEXT (domainname, msgid1, msgid2, n, LC_MESSAGES);\n+}\n+\n+#ifdef _LIBC\n+/* Alias for function name in GNU C Library.  */\n+weak_alias (__dngettext, dngettext);\n+#endif"}, {"sha": "2985064c924952a07d171e26f27ad159da6d4867", "filename": "gcc/intl/explodename.c", "status": "modified", "additions": 27, "deletions": 24, "changes": 51, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Fexplodename.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Fexplodename.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fintl%2Fexplodename.c?ref=71a94577632a238bf4e112f0f016819ead09f1d5", "patch": "@@ -1,33 +1,27 @@\n-/* Copyright (C) 1995, 1996, 1997, 1998 Free Software Foundation, Inc.\n+/* Copyright (C) 1995-1998, 2000, 2001 Free Software Foundation, Inc.\n    Contributed by Ulrich Drepper <drepper@gnu.ai.mit.edu>, 1995.\n \n-   This program is free software; you can redistribute it and/or modify\n-   it under the terms of the GNU General Public License as published by\n-   the Free Software Foundation; either version 2, or (at your option)\n+   This program is free software; you can redistribute it and/or modify it\n+   under the terms of the GNU Library General Public License as published\n+   by the Free Software Foundation; either version 2, or (at your option)\n    any later version.\n \n    This program is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n-   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n-   GNU General Public License for more details.\n+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+   Library General Public License for more details.\n \n-   You should have received a copy of the GNU General Public License\n-   along with this program; if not, write to the Free Software Foundation,\n-   Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.  */\n+   You should have received a copy of the GNU Library General Public\n+   License along with this program; if not, write to the Free Software\n+   Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307,\n+   USA.  */\n \n #ifdef HAVE_CONFIG_H\n # include <config.h>\n #endif\n \n-#if defined STDC_HEADERS || defined _LIBC\n-# include <stdlib.h>\n-#endif\n-\n-#if defined HAVE_STRING_H || defined _LIBC\n-# include <string.h>\n-#else\n-# include <strings.h>\n-#endif\n+#include <stdlib.h>\n+#include <string.h>\n #include <sys/types.h>\n \n #include \"loadinfo.h\"\n@@ -43,6 +37,18 @@\n \n /* @@ end of prolog @@ */\n \n+char *\n+_nl_find_language (name)\n+     const char *name;\n+{\n+  while (name[0] != '\\0' && name[0] != '_' && name[0] != '@'\n+\t && name[0] != '+' && name[0] != ',')\n+    ++name;\n+\n+  return (char *) name;\n+}\n+\n+\n int\n _nl_explode_name (name, language, modifier, territory, codeset,\n \t\t  normalized_codeset, special, sponsor, revision)\n@@ -74,9 +80,7 @@ _nl_explode_name (name, language, modifier, territory, codeset,\n   mask = 0;\n   syntax = undecided;\n   *language = cp = name;\n-  while (cp[0] != '\\0' && cp[0] != '_' && cp[0] != '@'\n-\t && cp[0] != '+' && cp[0] != ',')\n-    ++cp;\n+  cp = _nl_find_language (*language);\n \n   if (*language == cp)\n     /* This does not make sense: language has to be specified.  Use\n@@ -108,9 +112,8 @@ _nl_explode_name (name, language, modifier, territory, codeset,\n \n \t  if (*codeset != cp && (*codeset)[0] != '\\0')\n \t    {\n-\t      *normalized_codeset = _nl_normalize_codeset (\n-\t      \t\t\t\t*((unsigned char **) codeset),\n-\t      \t\t\t\tcp - *codeset);\n+\t      *normalized_codeset = _nl_normalize_codeset (*codeset,\n+\t\t\t\t\t\t\t   cp - *codeset);\n \t      if (strcmp (*codeset, *normalized_codeset) == 0)\n \t\tfree ((char *) *normalized_codeset);\n \t      else"}, {"sha": "2f103d5563659d399ecd330403a794eb7a9826de", "filename": "gcc/intl/finddomain.c", "status": "modified", "additions": 25, "deletions": 43, "changes": 68, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Ffinddomain.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Ffinddomain.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fintl%2Ffinddomain.c?ref=71a94577632a238bf4e112f0f016819ead09f1d5", "patch": "@@ -1,64 +1,40 @@\n /* Handle list of needed message catalogs\n-   Copyright (C) 1995, 1996, 1997, 1998 Free Software Foundation, Inc.\n-   Written by Ulrich Drepper <drepper@gnu.ai.mit.edu>, 1995.\n+   Copyright (C) 1995-1999, 2000, 2001 Free Software Foundation, Inc.\n+   Written by Ulrich Drepper <drepper@gnu.org>, 1995.\n \n-   This program is free software; you can redistribute it and/or modify\n-   it under the terms of the GNU General Public License as published by\n-   the Free Software Foundation; either version 2, or (at your option)\n+   This program is free software; you can redistribute it and/or modify it\n+   under the terms of the GNU Library General Public License as published\n+   by the Free Software Foundation; either version 2, or (at your option)\n    any later version.\n \n    This program is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n-   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n-   GNU General Public License for more details.\n+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+   Library General Public License for more details.\n \n-   You should have received a copy of the GNU General Public License\n-   along with this program; if not, write to the Free Software Foundation,\n-   Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.  */\n+   You should have received a copy of the GNU Library General Public\n+   License along with this program; if not, write to the Free Software\n+   Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307,\n+   USA.  */\n \n #ifdef HAVE_CONFIG_H\n # include <config.h>\n #endif\n \n-#include <ctype.h>\n-#include <errno.h>\n #include <stdio.h>\n #include <sys/types.h>\n-\n-#if defined STDC_HEADERS || defined _LIBC\n-# include <stdlib.h>\n-#else\n-# ifdef HAVE_MALLOC_H\n-#  include <malloc.h>\n-# else\n-void free ();\n-# endif\n-#endif\n-\n-#if defined HAVE_STRING_H || defined _LIBC\n-# include <string.h>\n-#else\n-# include <strings.h>\n-# ifndef memcpy\n-#  define memcpy(Dst, Src, Num) bcopy (Src, Dst, Num)\n-# endif\n-#endif\n-#if !HAVE_STRCHR && !defined _LIBC\n-# ifndef strchr\n-#  define strchr index\n-# endif\n-#endif\n+#include <stdlib.h>\n+#include <string.h>\n \n #if defined HAVE_UNISTD_H || defined _LIBC\n # include <unistd.h>\n #endif\n \n-#include \"gettext.h\"\n #include \"gettextP.h\"\n #ifdef _LIBC\n # include <libintl.h>\n #else\n-# include \"libgettext.h\"\n+# include \"libgnuintl.h\"\n #endif\n \n /* @@ end of prolog @@ */\n@@ -71,10 +47,11 @@ static struct loaded_l10nfile *_nl_loaded_domains;\n    established bindings.  */\n struct loaded_l10nfile *\n internal_function\n-_nl_find_domain (dirname, locale, domainname)\n+_nl_find_domain (dirname, locale, domainname, domainbinding)\n      const char *dirname;\n      char *locale;\n      const char *domainname;\n+     struct binding *domainbinding;\n {\n   struct loaded_l10nfile *retval;\n   const char *language;\n@@ -120,15 +97,15 @@ _nl_find_domain (dirname, locale, domainname)\n       int cnt;\n \n       if (retval->decided == 0)\n-\t_nl_load_domain (retval);\n+\t_nl_load_domain (retval, domainbinding);\n \n       if (retval->data != NULL)\n \treturn retval;\n \n       for (cnt = 0; retval->successor[cnt] != NULL; ++cnt)\n \t{\n \t  if (retval->successor[cnt]->decided == 0)\n-\t    _nl_load_domain (retval->successor[cnt]);\n+\t    _nl_load_domain (retval->successor[cnt], domainbinding);\n \n \t  if (retval->successor[cnt]->data != NULL)\n \t    break;\n@@ -175,14 +152,14 @@ _nl_find_domain (dirname, locale, domainname)\n     return NULL;\n \n   if (retval->decided == 0)\n-    _nl_load_domain (retval);\n+    _nl_load_domain (retval, domainbinding);\n   if (retval->data == NULL)\n     {\n       int cnt;\n       for (cnt = 0; retval->successor[cnt] != NULL; ++cnt)\n \t{\n \t  if (retval->successor[cnt]->decided == 0)\n-\t    _nl_load_domain (retval->successor[cnt]);\n+\t    _nl_load_domain (retval->successor[cnt], domainbinding);\n \t  if (retval->successor[cnt]->data != NULL)\n \t    break;\n \t}\n@@ -192,6 +169,10 @@ _nl_find_domain (dirname, locale, domainname)\n   if (alias_value != NULL)\n     free (locale);\n \n+  /* The space for normalized_codeset is dynamically allocated.  Free it.  */\n+  if (mask & XPG_NORM_CODESET)\n+    free ((void *) normalized_codeset);\n+\n   return retval;\n }\n \n@@ -208,6 +189,7 @@ free_mem (void)\n       if (runp->data != NULL)\n \t_nl_unload_domain ((struct loaded_domain *) runp->data);\n       runp = runp->next;\n+      free ((char *) here->filename);\n       free (here);\n     }\n }"}, {"sha": "22a6c24536ec3bef8b37aa613f84854e0afa6447", "filename": "gcc/intl/gettext.c", "status": "modified", "additions": 16, "deletions": 22, "changes": 38, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Fgettext.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Fgettext.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fintl%2Fgettext.c?ref=71a94577632a238bf4e112f0f016819ead09f1d5", "patch": "@@ -1,19 +1,20 @@\n /* Implementation of gettext(3) function.\n-   Copyright (C) 1995, 1997 Free Software Foundation, Inc.\n+   Copyright (C) 1995, 1997, 2000, 2001 Free Software Foundation, Inc.\n \n-   This program is free software; you can redistribute it and/or modify\n-   it under the terms of the GNU General Public License as published by\n-   the Free Software Foundation; either version 2, or (at your option)\n+   This program is free software; you can redistribute it and/or modify it\n+   under the terms of the GNU Library General Public License as published\n+   by the Free Software Foundation; either version 2, or (at your option)\n    any later version.\n \n    This program is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n-   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n-   GNU General Public License for more details.\n+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+   Library General Public License for more details.\n \n-   You should have received a copy of the GNU General Public License\n-   along with this program; if not, write to the Free Software Foundation,\n-   Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.  */\n+   You should have received a copy of the GNU Library General Public\n+   License along with this program; if not, write to the Free Software\n+   Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307,\n+   USA.  */\n \n #ifdef HAVE_CONFIG_H\n # include <config.h>\n@@ -23,21 +24,14 @@\n # define __need_NULL\n # include <stddef.h>\n #else\n-# ifdef STDC_HEADERS\n-#  include <stdlib.h>\t\t/* Just for NULL.  */\n-# else\n-#  ifdef HAVE_STRING_H\n-#   include <string.h>\n-#  else\n-#   define NULL ((void *) 0)\n-#  endif\n-# endif\n+# include <stdlib.h>\t\t/* Just for NULL.  */\n #endif\n \n+#include \"gettextP.h\"\n #ifdef _LIBC\n # include <libintl.h>\n #else\n-# include \"libgettext.h\"\n+# include \"libgnuintl.h\"\n #endif\n \n /* @@ end of prolog @@ */\n@@ -48,10 +42,10 @@\n    prefix.  So we have to make a difference here.  */\n #ifdef _LIBC\n # define GETTEXT __gettext\n-# define DGETTEXT __dgettext\n+# define DCGETTEXT __dcgettext\n #else\n # define GETTEXT gettext__\n-# define DGETTEXT dgettext__\n+# define DCGETTEXT dcgettext__\n #endif\n \n /* Look up MSGID in the current default message catalog for the current\n@@ -61,7 +55,7 @@ char *\n GETTEXT (msgid)\n      const char *msgid;\n {\n-  return DGETTEXT (NULL, msgid);\n+  return DCGETTEXT (NULL, msgid, LC_MESSAGES);\n }\n \n #ifdef _LIBC"}, {"sha": "4cf083d8e3969f831852f7687dab79827c516977", "filename": "gcc/intl/gettext.h", "status": "modified", "additions": 15, "deletions": 18, "changes": 33, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Fgettext.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Fgettext.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fintl%2Fgettext.h?ref=71a94577632a238bf4e112f0f016819ead09f1d5", "patch": "@@ -1,26 +1,24 @@\n-/* Internal header for GNU gettext internationalization functions.\n-   Copyright (C) 1995, 1997 Free Software Foundation, Inc.\n+/* Description of GNU message catalog format: general file layout.\n+   Copyright (C) 1995, 1997, 2000, 2001 Free Software Foundation, Inc.\n \n-   This program is free software; you can redistribute it and/or modify\n-   it under the terms of the GNU General Public License as published by\n-   the Free Software Foundation; either version 2, or (at your option)\n+   This program is free software; you can redistribute it and/or modify it\n+   under the terms of the GNU Library General Public License as published\n+   by the Free Software Foundation; either version 2, or (at your option)\n    any later version.\n \n    This program is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n-   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n-   GNU General Public License for more details.\n+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+   Library General Public License for more details.\n \n    You should have received a copy of the GNU Library General Public\n-   License along with the GNU C Library; see the file COPYING.LIB.  If not,\n-   write to the Free Software Foundation, Inc., 59 Temple Place - Suite 330,\n-   Boston, MA 02111-1307, USA.  */\n+   License along with this program; if not, write to the Free Software\n+   Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307,\n+   USA.  */\n \n #ifndef _GETTEXT_H\n #define _GETTEXT_H 1\n \n-#include <stdio.h>\n-\n #if HAVE_LIMITS_H || _LIBC\n # include <limits.h>\n #endif\n@@ -37,10 +35,9 @@\n /* The following contortions are an attempt to use the C preprocessor\n    to determine an unsigned integral type that is 32 bits wide.  An\n    alternative approach is to use autoconf's AC_CHECK_SIZEOF macro, but\n-   doing that would require that the configure script compile and *run*\n-   the resulting executable.  Locally running cross-compiled executables\n-   is usually not possible.  We use the maximum values for signed int's\n-   for the test to avoid using `U' suffixes.  */\n+   as of version autoconf-2.13, the AC_CHECK_SIZEOF macro doesn't work\n+   when cross-compiling.  We use the maximum values for signed ints\n+   for the test to avoid using U suffixes.  */\n \n #define INT_MAX_32_BITS 2147483647\n \n@@ -50,11 +47,11 @@\n    (that certainly have <limits.h>) have 64+-bit integral types.  */\n \n #ifndef INT_MAX\n-# define INT_MAX INT_MAX_32_BITS\n+# define INT_MAX UINT_MAX_32_BITS\n #endif\n \n #if INT_MAX == INT_MAX_32_BITS\n-typedef unsigned nls_uint32;\n+typedef unsigned int nls_uint32;\n #else\n # if SHRT_MAX == INT_MAX_32_BITS\n typedef unsigned short nls_uint32;"}, {"sha": "43de1cd47d15187b8517e260e0252d8e334a14e2", "filename": "gcc/intl/gettextP.h", "status": "modified", "additions": 181, "deletions": 19, "changes": 200, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2FgettextP.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2FgettextP.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fintl%2FgettextP.h?ref=71a94577632a238bf4e112f0f016819ead09f1d5", "patch": "@@ -1,26 +1,39 @@\n-/* Header describing internals of gettext library\n-   Copyright (C) 1995, 1996, 1997, 1998 Free Software Foundation, Inc.\n-   Written by Ulrich Drepper <drepper@gnu.ai.mit.edu>, 1995.\n+/* Header describing internals of libintl library.\n+   Copyright (C) 1995-1999, 2000, 2001 Free Software Foundation, Inc.\n+   Written by Ulrich Drepper <drepper@cygnus.com>, 1995.\n \n-   This program is free software; you can redistribute it and/or modify\n-   it under the terms of the GNU General Public License as published by\n-   the Free Software Foundation; either version 2, or (at your option)\n+   This program is free software; you can redistribute it and/or modify it\n+   under the terms of the GNU Library General Public License as published\n+   by the Free Software Foundation; either version 2, or (at your option)\n    any later version.\n \n    This program is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n-   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n-   GNU General Public License for more details.\n+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+   Library General Public License for more details.\n \n-   You should have received a copy of the GNU General Public License\n-   along with this program; if not, write to the Free Software Foundation,\n-   Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.  */\n+   You should have received a copy of the GNU Library General Public\n+   License along with this program; if not, write to the Free Software\n+   Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307,\n+   USA.  */\n \n #ifndef _GETTEXTP_H\n #define _GETTEXTP_H\n \n+#include <stddef.h>\t\t/* Get size_t.  */\n+\n+#ifdef _LIBC\n+# include \"../iconv/gconv_int.h\"\n+#else\n+# if HAVE_ICONV\n+#  include <iconv.h>\n+# endif\n+#endif\n+\n #include \"loadinfo.h\"\n \n+#include \"gettext.h\"\t\t/* Get nls_uint32.  */\n+\n /* @@ end of prolog @@ */\n \n #ifndef PARAMS\n@@ -35,6 +48,12 @@\n # define internal_function\n #endif\n \n+/* Tell the compiler when a conditional or integer expression is\n+   almost always true or almost always false.  */\n+#ifndef HAVE_BUILTIN_EXPECT\n+# define __builtin_expect(expr, val) (expr)\n+#endif\n+\n #ifndef W\n # define W(flag, data) ((flag) ? SWAP (data) : (data))\n #endif\n@@ -44,18 +63,61 @@\n # include <byteswap.h>\n # define SWAP(i) bswap_32 (i)\n #else\n-static nls_uint32 SWAP PARAMS ((unsigned int i));\n-\n static inline nls_uint32\n SWAP (i)\n-     unsigned int i;\n+     nls_uint32 i;\n {\n-  nls_uint32 x = (nls_uint32) i;\n-  return (x << 24) | ((x & 0xff00) << 8) | ((x >> 8) & 0xff00) | (x >> 24);\n+  return (i << 24) | ((i & 0xff00) << 8) | ((i >> 8) & 0xff00) | (i >> 24);\n }\n #endif\n \n \n+/* This is the representation of the expressions to determine the\n+   plural form.  */\n+struct expression\n+{\n+  int nargs;\t\t\t/* Number of arguments.  */\n+  enum operator\n+  {\n+    /* Without arguments:  */\n+    var,\t\t\t/* The variable \"n\".  */\n+    num,\t\t\t/* Decimal number.  */\n+    /* Unary operators:  */\n+    lnot,\t\t\t/* Logical NOT.  */\n+    /* Binary operators:  */\n+    mult,\t\t\t/* Multiplication.  */\n+    divide,\t\t\t/* Division.  */\n+    module,\t\t\t/* Module operation.  */\n+    plus,\t\t\t/* Addition.  */\n+    minus,\t\t\t/* Subtraction.  */\n+    less_than,\t\t\t/* Comparison.  */\n+    greater_than,\t\t/* Comparison.  */\n+    less_or_equal,\t\t/* Comparison.  */\n+    greater_or_equal,\t\t/* Comparison.  */\n+    equal,\t\t\t/* Comparision for equality.  */\n+    not_equal,\t\t\t/* Comparision for inequality.  */\n+    land,\t\t\t/* Logical AND.  */\n+    lor,\t\t\t/* Logical OR.  */\n+    /* Ternary operators:  */\n+    qmop\t\t\t/* Question mark operator.  */\n+  } operation;\n+  union\n+  {\n+    unsigned long int num;\t/* Number value for `num'.  */\n+    struct expression *args[3];\t/* Up to three arguments.  */\n+  } val;\n+};\n+\n+/* This is the data structure to pass information to the parser and get\n+   the result in a thread-safe way.  */\n+struct parse_args\n+{\n+  const char *cp;\n+  struct expression *res;\n+};\n+\n+\n+/* The representation of an opened message catalog.  */\n struct loaded_domain\n {\n   const char *data;\n@@ -67,23 +129,123 @@ struct loaded_domain\n   struct string_desc *trans_tab;\n   nls_uint32 hash_size;\n   nls_uint32 *hash_tab;\n+  int codeset_cntr;\n+#ifdef _LIBC\n+  __gconv_t conv;\n+#else\n+# if HAVE_ICONV\n+  iconv_t conv;\n+# endif\n+#endif\n+  char **conv_tab;\n+\n+  struct expression *plural;\n+  unsigned long int nplurals;\n };\n \n+/* We want to allocate a string at the end of the struct.  But ISO C\n+   doesn't allow zero sized arrays.  */\n+#ifdef __GNUC__\n+# define ZERO 0\n+#else\n+# define ZERO 1\n+#endif\n+\n+/* A set of settings bound to a message domain.  Used to store settings\n+   from bindtextdomain() and bind_textdomain_codeset().  */\n struct binding\n {\n   struct binding *next;\n-  char *domainname;\n   char *dirname;\n+  int codeset_cntr;\t/* Incremented each time codeset changes.  */\n+  char *codeset;\n+  char domainname[ZERO];\n };\n \n+/* A counter which is incremented each time some previous translations\n+   become invalid.\n+   This variable is part of the external ABI of the GNU libintl.  */\n+extern int _nl_msg_cat_cntr;\n+\n struct loaded_l10nfile *_nl_find_domain PARAMS ((const char *__dirname,\n \t\t\t\t\t\t char *__locale,\n-\t\t\t\t\t\t const char *__domainname))\n+\t\t\t\t\t\t const char *__domainname,\n+\t\t\t\t\t      struct binding *__domainbinding))\n      internal_function;\n-void _nl_load_domain PARAMS ((struct loaded_l10nfile *__domain))\n+void _nl_load_domain PARAMS ((struct loaded_l10nfile *__domain,\n+\t\t\t      struct binding *__domainbinding))\n      internal_function;\n void _nl_unload_domain PARAMS ((struct loaded_domain *__domain))\n      internal_function;\n+const char *_nl_init_domain_conv PARAMS ((struct loaded_l10nfile *__domain_file,\n+\t\t\t\t\t  struct loaded_domain *__domain,\n+\t\t\t\t\t  struct binding *__domainbinding))\n+     internal_function;\n+void _nl_free_domain_conv PARAMS ((struct loaded_domain *__domain))\n+     internal_function;\n+\n+char *_nl_find_msg PARAMS ((struct loaded_l10nfile *domain_file,\n+\t\t\t    struct binding *domainbinding,\n+\t\t\t    const char *msgid, size_t *lengthp))\n+     internal_function;\n+\n+#ifdef _LIBC\n+extern char *__gettext PARAMS ((const char *__msgid));\n+extern char *__dgettext PARAMS ((const char *__domainname,\n+\t\t\t\t const char *__msgid));\n+extern char *__dcgettext PARAMS ((const char *__domainname,\n+\t\t\t\t  const char *__msgid, int __category));\n+extern char *__ngettext PARAMS ((const char *__msgid1, const char *__msgid2,\n+\t\t\t\t unsigned long int __n));\n+extern char *__dngettext PARAMS ((const char *__domainname,\n+\t\t\t\t  const char *__msgid1, const char *__msgid2,\n+\t\t\t\t  unsigned long int n));\n+extern char *__dcngettext PARAMS ((const char *__domainname,\n+\t\t\t\t   const char *__msgid1, const char *__msgid2,\n+\t\t\t\t   unsigned long int __n, int __category));\n+extern char *__dcigettext PARAMS ((const char *__domainname,\n+\t\t\t\t   const char *__msgid1, const char *__msgid2,\n+\t\t\t\t   int __plural, unsigned long int __n,\n+\t\t\t\t   int __category));\n+extern char *__textdomain PARAMS ((const char *__domainname));\n+extern char *__bindtextdomain PARAMS ((const char *__domainname,\n+\t\t\t\t       const char *__dirname));\n+extern char *__bind_textdomain_codeset PARAMS ((const char *__domainname,\n+\t\t\t\t\t\tconst char *__codeset));\n+#else\n+extern char *gettext__ PARAMS ((const char *__msgid));\n+extern char *dgettext__ PARAMS ((const char *__domainname,\n+\t\t\t\t const char *__msgid));\n+extern char *dcgettext__ PARAMS ((const char *__domainname,\n+\t\t\t\t  const char *__msgid, int __category));\n+extern char *ngettext__ PARAMS ((const char *__msgid1, const char *__msgid2,\n+\t\t\t\t unsigned long int __n));\n+extern char *dngettext__ PARAMS ((const char *__domainname,\n+\t\t\t\t  const char *__msgid1, const char *__msgid2,\n+\t\t\t\t  unsigned long int __n));\n+extern char *dcngettext__ PARAMS ((const char *__domainname,\n+\t\t\t\t   const char *__msgid1, const char *__msgid2,\n+\t\t\t\t   unsigned long int __n, int __category));\n+extern char *dcigettext__ PARAMS ((const char *__domainname,\n+\t\t\t\t   const char *__msgid1, const char *__msgid2,\n+\t\t\t\t   int __plural, unsigned long int __n,\n+\t\t\t\t   int __category));\n+extern char *textdomain__ PARAMS ((const char *__domainname));\n+extern char *bindtextdomain__ PARAMS ((const char *__domainname,\n+\t\t\t\t       const char *__dirname));\n+extern char *bind_textdomain_codeset__ PARAMS ((const char *__domainname,\n+\t\t\t\t\t\tconst char *__codeset));\n+#endif\n+\n+#ifdef _LIBC\n+extern void __gettext_free_exp PARAMS ((struct expression *exp))\n+     internal_function;\n+extern int __gettextparse PARAMS ((void *arg));\n+#else\n+extern void gettext_free_exp__ PARAMS ((struct expression *exp))\n+     internal_function;\n+extern int gettextparse__ PARAMS ((void *arg));\n+#endif\n \n /* @@ begin of epilog @@ */\n "}, {"sha": "ccb7acca65895a915d775d682edaa1dc8aaaedb7", "filename": "gcc/intl/hash-string.h", "status": "modified", "additions": 14, "deletions": 14, "changes": 28, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Fhash-string.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Fhash-string.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fintl%2Fhash-string.h?ref=71a94577632a238bf4e112f0f016819ead09f1d5", "patch": "@@ -1,20 +1,20 @@\n-/* Implements a string hashing function.\n-   Copyright (C) 1995, 1997 Free Software Foundation, Inc.\n+/* Description of GNU message catalog format: string hashing function.\n+   Copyright (C) 1995, 1997, 1998, 2000, 2001 Free Software Foundation, Inc.\n \n-   This program is free software; you can redistribute it and/or modify\n-   it under the terms of the GNU General Public License as published by\n-   the Free Software Foundation; either version 2, or (at your option)\n+   This program is free software; you can redistribute it and/or modify it\n+   under the terms of the GNU Library General Public License as published\n+   by the Free Software Foundation; either version 2, or (at your option)\n    any later version.\n \n    This program is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n-   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n-   GNU General Public License for more details.\n+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+   Library General Public License for more details.\n \n    You should have received a copy of the GNU Library General Public\n-   License along with the GNU C Library; see the file COPYING.LIB.  If not,\n-   write to the Free Software Foundation, Inc., 59 Temple Place - Suite 330,\n-   Boston, MA 02111-1307, USA.  */\n+   License along with this program; if not, write to the Free Software\n+   Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307,\n+   USA.  */\n \n /* @@ end of prolog @@ */\n \n@@ -33,9 +33,9 @@\n /* Defines the so called `hashpjw' function by P.J. Weinberger\n    [see Aho/Sethi/Ullman, COMPILERS: Principles, Techniques and Tools,\n    1986, 1987 Bell Telephone Laboratories, Inc.]  */\n-static unsigned long hash_string PARAMS ((const char *__str_param));\n+static unsigned long int hash_string PARAMS ((const char *__str_param));\n \n-static inline unsigned long\n+static inline unsigned long int\n hash_string (str_param)\n      const char *str_param;\n {\n@@ -47,8 +47,8 @@ hash_string (str_param)\n   while (*str != '\\0')\n     {\n       hval <<= 4;\n-      hval += (unsigned long) *str++;\n-      g = hval & ((unsigned long) 0xf << (HASHWORDBITS - 4));\n+      hval += (unsigned long int) *str++;\n+      g = hval & ((unsigned long int) 0xf << (HASHWORDBITS - 4));\n       if (g != 0)\n \t{\n \t  hval ^= g >> (HASHWORDBITS - 8);"}, {"sha": "0a06ce947bd7234174883ac4d48ae13af0b2c412", "filename": "gcc/intl/intl-compat.c", "status": "modified", "additions": 112, "deletions": 22, "changes": 134, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Fintl-compat.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Fintl-compat.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fintl%2Fintl-compat.c?ref=71a94577632a238bf4e112f0f016819ead09f1d5", "patch": "@@ -1,43 +1,99 @@\n /* intl-compat.c - Stub functions to call gettext functions from GNU gettext\n    Library.\n-   Copyright (C) 1995 Software Foundation, Inc.\n+   Copyright (C) 1995, 2000, 2001 Software Foundation, Inc.\n \n-This program is free software; you can redistribute it and/or modify\n-it under the terms of the GNU General Public License as published by\n-the Free Software Foundation; either version 2, or (at your option)\n-any later version.\n+   This program is free software; you can redistribute it and/or modify it\n+   under the terms of the GNU Library General Public License as published\n+   by the Free Software Foundation; either version 2, or (at your option)\n+   any later version.\n \n-This program is distributed in the hope that it will be useful,\n-but WITHOUT ANY WARRANTY; without even the implied warranty of\n-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n-GNU General Public License for more details.\n+   This program is distributed in the hope that it will be useful,\n+   but WITHOUT ANY WARRANTY; without even the implied warranty of\n+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+   Library General Public License for more details.\n \n-You should have received a copy of the GNU General Public License\n-along with this program; if not, write to the Free Software\n-Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.  */\n+   You should have received a copy of the GNU Library General Public\n+   License along with this program; if not, write to the Free Software\n+   Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307,\n+   USA.  */\n \n #ifdef HAVE_CONFIG_H\n # include <config.h>\n #endif\n \n-#include \"libgettext.h\"\n+#include \"libgnuintl.h\"\n+#include \"gettextP.h\"\n \n /* @@ end of prolog @@ */\n \n+/* This file redirects the gettext functions (without prefix or suffix) to\n+   those defined in the included GNU gettext library (with \"__\" suffix).\n+   It is compiled into libintl when the included GNU gettext library is\n+   configured --with-included-gettext.\n+\n+   This redirection works also in the case that the system C library or\n+   the system libintl library contain gettext/textdomain/... functions.\n+   If it didn't, we would need to add preprocessor level redirections to\n+   libgnuintl.h of the following form:\n+\n+#    define gettext gettext__\n+#    define dgettext dgettext__\n+#    define dcgettext dcgettext__\n+#    define ngettext ngettext__\n+#    define dngettext dngettext__\n+#    define dcngettext dcngettext__\n+#    define textdomain textdomain__\n+#    define bindtextdomain bindtextdomain__\n+#    define bind_textdomain_codeset bind_textdomain_codeset__\n+\n+   How does this redirection work? There are two cases.\n+   A. When libintl.a is linked into an executable, it works because\n+      functions defined in the executable always override functions in\n+      the shared libraries.\n+   B. When libintl.so is used, it works because\n+      1. those systems defining gettext/textdomain/... in the C library\n+         (namely, Solaris 2.4 and newer, and GNU libc 2.0 and newer) are\n+         ELF systems and define these symbols as weak, thus explicitly\n+         letting other shared libraries override it.\n+      2. those systems defining gettext/textdomain/... in a standalone\n+         libintl.so library (namely, Solaris 2.3 and newer) have this\n+         shared library in /usr/lib, and the linker will search /usr/lib\n+         *after* the directory where the GNU gettext library is installed.\n+\n+   A third case, namely when libintl.a is linked into a shared library\n+   whose name is not libintl.so, is not supported. In this case, on\n+   Solaris, when -lintl precedes the linker option for the shared library\n+   containing GNU gettext, the system's gettext would indeed override\n+   the GNU gettext. Anyone doing this kind of stuff must be clever enough\n+   to 1. compile libintl.a with -fPIC, 2. remove -lintl from his linker\n+   command line.  */\n+\n \n #undef gettext\n #undef dgettext\n #undef dcgettext\n+#undef ngettext\n+#undef dngettext\n+#undef dcngettext\n #undef textdomain\n #undef bindtextdomain\n+#undef bind_textdomain_codeset\n \n \n char *\n-bindtextdomain (domainname, dirname)\n+gettext (msgid)\n+     const char *msgid;\n+{\n+  return gettext__ (msgid);\n+}\n+\n+\n+char *\n+dgettext (domainname, msgid)\n      const char *domainname;\n-     const char *dirname;\n+     const char *msgid;\n {\n-  return bindtextdomain__ (domainname, dirname);\n+  return dgettext__ (domainname, msgid);\n }\n \n \n@@ -52,19 +108,35 @@ dcgettext (domainname, msgid, category)\n \n \n char *\n-dgettext (domainname, msgid)\n+ngettext (msgid1, msgid2, n)\n+     const char *msgid1;\n+     const char *msgid2;\n+     unsigned long int n;\n+{\n+  return ngettext__ (msgid1, msgid2, n);\n+}\n+\n+\n+char *\n+dngettext (domainname, msgid1, msgid2, n)\n      const char *domainname;\n-     const char *msgid;\n+     const char *msgid1;\n+     const char *msgid2;\n+     unsigned long int n;\n {\n-  return dgettext__ (domainname, msgid);\n+  return dngettext__ (domainname, msgid1, msgid2, n);\n }\n \n \n char *\n-gettext (msgid)\n-     const char *msgid;\n+dcngettext (domainname, msgid1, msgid2, n, category)\n+     const char *domainname;\n+     const char *msgid1;\n+     const char *msgid2;\n+     unsigned long int n;\n+     int category;\n {\n-  return gettext__ (msgid);\n+  return dcngettext__ (domainname, msgid1, msgid2, n, category);\n }\n \n \n@@ -74,3 +146,21 @@ textdomain (domainname)\n {\n   return textdomain__ (domainname);\n }\n+\n+\n+char *\n+bindtextdomain (domainname, dirname)\n+     const char *domainname;\n+     const char *dirname;\n+{\n+  return bindtextdomain__ (domainname, dirname);\n+}\n+\n+\n+char *\n+bind_textdomain_codeset (domainname, codeset)\n+     const char *domainname;\n+     const char *codeset;\n+{\n+  return bind_textdomain_codeset__ (domainname, codeset);\n+}"}, {"sha": "533e94be889cd25dcfb3dcd11a9ddbde751b5128", "filename": "gcc/intl/l10nflist.c", "status": "modified", "additions": 22, "deletions": 28, "changes": 50, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Fl10nflist.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Fl10nflist.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fintl%2Fl10nflist.c?ref=71a94577632a238bf4e112f0f016819ead09f1d5", "patch": "@@ -1,37 +1,33 @@\n-/* Handle list of needed message catalogs\n-   Copyright (C) 1995, 1996, 1997 Free Software Foundation, Inc.\n+/* Copyright (C) 1995-1999, 2000, 2001 Free Software Foundation, Inc.\n    Contributed by Ulrich Drepper <drepper@gnu.ai.mit.edu>, 1995.\n \n-   This program is free software; you can redistribute it and/or modify\n-   it under the terms of the GNU General Public License as published by\n-   the Free Software Foundation; either version 2, or (at your option)\n+   This program is free software; you can redistribute it and/or modify it\n+   under the terms of the GNU Library General Public License as published\n+   by the Free Software Foundation; either version 2, or (at your option)\n    any later version.\n \n    This program is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n-   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n-   GNU General Public License for more details.\n+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+   Library General Public License for more details.\n \n-   You should have received a copy of the GNU General Public License\n-   along with this program; if not, write to the Free Software Foundation,\n-   Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.  */\n-\n-#ifdef HAVE_CONFIG_H\n-# include <config.h>\n-#endif\n+   You should have received a copy of the GNU Library General Public\n+   License along with this program; if not, write to the Free Software\n+   Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307,\n+   USA.  */\n \n+/* Tell glibc's <string.h> to provide a prototype for stpcpy().\n+   This must come before <config.h> because <config.h> may include\n+   <features.h>, and once <features.h> has been included, it's too late.  */\n #ifndef _GNU_SOURCE\n # define _GNU_SOURCE\t1\n #endif\n \n-#if defined HAVE_STRING_H || defined _LIBC\n-# include <string.h>\n-#else\n-# include <strings.h>\n-# ifndef memcpy\n-#  define memcpy(Dst, Src, Num) bcopy (Src, Dst, Num)\n-# endif\n+#ifdef HAVE_CONFIG_H\n+# include <config.h>\n #endif\n+\n+#include <string.h>\n #if !HAVE_STRCHR && !defined _LIBC\n # ifndef strchr\n #  define strchr index\n@@ -43,10 +39,7 @@\n #endif\n #include <ctype.h>\n #include <sys/types.h>\n-\n-#if defined STDC_HEADERS || defined _LIBC\n-# include <stdlib.h>\n-#endif\n+#include <stdlib.h>\n \n #include \"loadinfo.h\"\n \n@@ -224,7 +217,7 @@ _nl_make_l10nflist (l10nfile_list, dirlist, dirlist_len, mask, language,\n \n   /* Construct file name.  */\n   memcpy (abs_filename, dirlist, dirlist_len);\n-  __argz_stringify (abs_filename, dirlist_len, ':');\n+  __argz_stringify (abs_filename, dirlist_len, PATH_SEPARATOR);\n   cp = abs_filename + (dirlist_len - 1);\n   *cp++ = '/';\n   cp = stpcpy (cp, language);\n@@ -349,10 +342,11 @@ _nl_make_l10nflist (l10nfile_list, dirlist, dirlist_len, mask, language,\n \f\n /* Normalize codeset name.  There is no standard for the codeset\n    names.  Normalization allows the user to use any of the common\n-   names.  */\n+   names.  The return value is dynamically allocated and has to be\n+   freed by the caller.  */\n const char *\n _nl_normalize_codeset (codeset, name_len)\n-     const unsigned char *codeset;\n+     const char *codeset;\n      size_t name_len;\n {\n   int len = 0;"}, {"sha": "c5be54a80af5eb239a5f67622d32135392ea8271", "filename": "gcc/intl/libgettext.h", "status": "modified", "additions": 29, "deletions": 162, "changes": 191, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Flibgettext.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Flibgettext.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fintl%2Flibgettext.h?ref=71a94577632a238bf4e112f0f016819ead09f1d5", "patch": "@@ -1,182 +1,49 @@\n-/* Message catalogs for internationalization.\n-   Copyright (C) 1995, 1996, 1997, 1998 Free Software Foundation, Inc.\n+/* Convenience header for conditional use of GNU <libintl.h>.\n+   Copyright (C) 1995-1998, 2000, 2001 Free Software Foundation, Inc.\n \n-   This program is free software; you can redistribute it and/or modify\n-   it under the terms of the GNU General Public License as published by\n-   the Free Software Foundation; either version 2, or (at your option)\n+   This program is free software; you can redistribute it and/or modify it\n+   under the terms of the GNU Library General Public License as published\n+   by the Free Software Foundation; either version 2, or (at your option)\n    any later version.\n \n    This program is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n-   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n-   GNU General Public License for more details.\n+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+   Library General Public License for more details.\n \n-   You should have received a copy of the GNU General Public License\n-   along with this program; if not, write to the Free Software Foundation,\n-   Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.  */\n+   You should have received a copy of the GNU Library General Public\n+   License along with this program; if not, write to the Free Software\n+   Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307,\n+   USA.  */\n \n-/* Because on some systems (e.g. Solaris) we sometimes have to include\n-   the systems libintl.h as well as this file we have more complex\n-   include protection above.  But the systems header might perhaps also\n-   define _LIBINTL_H and therefore we have to protect the definition here.  */\n-\n-#if !defined _LIBINTL_H || !defined _LIBGETTEXT_H\n-#ifndef _LIBINTL_H\n-# define _LIBINTL_H\t1\n-#endif\n-#define _LIBGETTEXT_H\t1\n-\n-/* We define an additional symbol to signal that we use the GNU\n-   implementation of gettext.  */\n-#define __USE_GNU_GETTEXT 1\n-\n-#include <sys/types.h>\n-\n-#if HAVE_LOCALE_H\n-# include <locale.h>\n-#endif\n-\n-\n-#ifdef __cplusplus\n-extern \"C\" {\n-#endif\n-\n-/* @@ end of prolog @@ */\n-\n-#ifndef PARAMS\n-# if __STDC__ || defined __cplusplus\n-#  define PARAMS(args) args\n-# else\n-#  define PARAMS(args) ()\n-# endif\n-#endif\n-\n-#ifndef NULL\n-# if !defined __cplusplus || defined __GNUC__\n-#  define NULL ((void *) 0)\n-# else\n-#  define NULL (0)\n-# endif\n-#endif\n-\n-#if !HAVE_LC_MESSAGES\n-/* This value determines the behaviour of the gettext() and dgettext()\n-   function.  But some system does not have this defined.  Define it\n-   to a default value.  */\n-# define LC_MESSAGES (-1)\n-#endif\n-\n-\n-/* Declarations for gettext-using-catgets interface.  Derived from\n-   Jim Meyering's libintl.h.  */\n-struct _msg_ent\n-{\n-  const char *_msg;\n-  int _msg_number;\n-};\n-\n-\n-#if HAVE_CATGETS\n-/* These two variables are defined in the automatically by po-to-tbl.sed\n-   generated file `cat-id-tbl.c'.  */\n-extern const struct _msg_ent _msg_tbl[];\n-extern int _msg_tbl_length;\n-#endif\n-\n-\n-/* For automatical extraction of messages sometimes no real\n-   translation is needed.  Instead the string itself is the result.  */\n-#define gettext_noop(Str) (Str)\n-\n-/* Look up MSGID in the current default message catalog for the current\n-   LC_MESSAGES locale.  If not found, returns MSGID itself (the default\n-   text).  */\n-extern char *gettext PARAMS ((const char *__msgid));\n-extern char *gettext__ PARAMS ((const char *__msgid));\n-\n-/* Look up MSGID in the DOMAINNAME message catalog for the current\n-   LC_MESSAGES locale.  */\n-extern char *dgettext PARAMS ((const char *__domainname, const char *__msgid));\n-extern char *dgettext__ PARAMS ((const char *__domainname,\n-\t\t\t\t const char *__msgid));\n-\n-/* Look up MSGID in the DOMAINNAME message catalog for the current CATEGORY\n-   locale.  */\n-extern char *dcgettext PARAMS ((const char *__domainname, const char *__msgid,\n-\t\t\t\tint __category));\n-extern char *dcgettext__ PARAMS ((const char *__domainname,\n-\t\t\t\t  const char *__msgid, int __category));\n-\n-\n-/* Set the current default message catalog to DOMAINNAME.\n-   If DOMAINNAME is null, return the current default.\n-   If DOMAINNAME is \"\", reset to the default of \"messages\".  */\n-extern char *textdomain PARAMS ((const char *__domainname));\n-extern char *textdomain__ PARAMS ((const char *__domainname));\n-\n-/* Specify that the DOMAINNAME message catalog will be found\n-   in DIRNAME rather than in the system locale data base.  */\n-extern char *bindtextdomain PARAMS ((const char *__domainname,\n-\t\t\t\t  const char *__dirname));\n-extern char *bindtextdomain__ PARAMS ((const char *__domainname,\n-\t\t\t\t    const char *__dirname));\n+#ifndef _LIBGETTEXT_H\n+#define _LIBGETTEXT_H 1\n \n+/* NLS can be disabled through the configure --disable-nls option.  */\n #if ENABLE_NLS\n \n-/* Solaris 2.3 has the gettext function but dcgettext is missing.\n-   So we omit this optimization for Solaris 2.3.  BTW, Solaris 2.4\n-   has dcgettext.  */\n-# if !HAVE_CATGETS && (!HAVE_GETTEXT || HAVE_DCGETTEXT)\n-\n-#  define gettext(Msgid)\t\t\t\t\t\t      \\\n-     dgettext (NULL, Msgid)\n-\n-#  define dgettext(Domainname, Msgid)\t\t\t\t\t      \\\n-     dcgettext (Domainname, Msgid, LC_MESSAGES)\n-\n-#  if defined __GNUC__ && __GNUC__ == 2 && __GNUC_MINOR__ >= 7\n-/* This global variable is defined in loadmsgcat.c.  We need a sign,\n-   whether a new catalog was loaded, which can be associated with all\n-   translations.  */\n-extern int _nl_msg_cat_cntr;\n-\n-#   define dcgettext(Domainname, Msgid, Category)\t\t\t      \\\n-  (__extension__\t\t\t\t\t\t\t      \\\n-   ({\t\t\t\t\t\t\t\t\t      \\\n-     char *__result;\t\t\t\t\t\t\t      \\\n-     if (__builtin_constant_p (Msgid))\t\t\t\t\t      \\\n-       {\t\t\t\t\t\t\t\t      \\\n-\t static char *__translation__;\t\t\t\t\t      \\\n-\t static int __catalog_counter__;\t\t\t\t      \\\n-\t if (! __translation__ || __catalog_counter__ != _nl_msg_cat_cntr)    \\\n-\t   {\t\t\t\t\t\t\t\t      \\\n-\t     __translation__ =\t\t\t\t\t\t      \\\n-\t       dcgettext__ (Domainname, Msgid, Category);\t\t      \\\n-\t     __catalog_counter__ = _nl_msg_cat_cntr;\t\t\t      \\\n-\t   }\t\t\t\t\t\t\t\t      \\\n-\t __result = __translation__;\t\t\t\t\t      \\\n-       }\t\t\t\t\t\t\t\t      \\\n-     else\t\t\t\t\t\t\t\t      \\\n-       __result = dcgettext__ (Domainname, Msgid, Category);\t\t      \\\n-     __result;\t\t\t\t\t\t\t\t      \\\n-    }))\n-#  endif\n-# endif\n+/* Get declarations of GNU message catalog functions.  */\n+# include <libintl.h>\n \n #else\n \n # define gettext(Msgid) (Msgid)\n # define dgettext(Domainname, Msgid) (Msgid)\n # define dcgettext(Domainname, Msgid, Category) (Msgid)\n-# define textdomain(Domainname) ((char *) Domainname)\n-# define bindtextdomain(Domainname, Dirname) ((char *) Dirname)\n+# define ngettext(Msgid1, Msgid2, N) \\\n+    ((N) == 1 ? (char *) (Msgid1) : (char *) (Msgid2))\n+# define dngettext(Domainname, Msgid1, Msgid2, N) \\\n+    ((N) == 1 ? (char *) (Msgid1) : (char *) (Msgid2))\n+# define dcngettext(Domainname, Msgid1, Msgid2, N, Category) \\\n+    ((N) == 1 ? (char *) (Msgid1) : (char *) (Msgid2))\n+# define textdomain(Domainname) ((char *) (Domainname))\n+# define bindtextdomain(Domainname, Dirname) ((char *) (Dirname))\n+# define bind_textdomain_codeset(Domainname, Codeset) ((char *) (Codeset))\n \n #endif\n \n-/* @@ begin of epilog @@ */\n-\n-#ifdef __cplusplus\n-}\n-#endif\n+/* For automatical extraction of messages sometimes no real\n+   translation is needed.  Instead the string itself is the result.  */\n+#define gettext_noop(Str) (Str)\n \n-#endif\n+#endif /* _LIBGETTEXT_H */"}, {"sha": "f891deb9636692416434e3affe55ad0bd1abfa02", "filename": "gcc/intl/libgnuintl.h", "status": "added", "additions": 128, "deletions": 0, "changes": 128, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Flibgnuintl.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Flibgnuintl.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fintl%2Flibgnuintl.h?ref=71a94577632a238bf4e112f0f016819ead09f1d5", "patch": "@@ -0,0 +1,128 @@\n+/* Message catalogs for internationalization.\n+   Copyright (C) 1995-1997, 2000, 2001 Free Software Foundation, Inc.\n+\n+   This program is free software; you can redistribute it and/or modify it\n+   under the terms of the GNU Library General Public License as published\n+   by the Free Software Foundation; either version 2, or (at your option)\n+   any later version.\n+\n+   This program is distributed in the hope that it will be useful,\n+   but WITHOUT ANY WARRANTY; without even the implied warranty of\n+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+   Library General Public License for more details.\n+\n+   You should have received a copy of the GNU Library General Public\n+   License along with this program; if not, write to the Free Software\n+   Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307,\n+   USA.  */\n+\n+#ifndef _LIBINTL_H\n+#define _LIBINTL_H\t1\n+\n+#include <locale.h>\n+\n+/* The LC_MESSAGES locale category is the category used by the functions\n+   gettext() and dgettext().  It is specified in POSIX, but not in ANSI C.\n+   On systems that don't define it, use an arbitrary value instead.\n+   On Solaris, <locale.h> defines __LOCALE_H then includes <libintl.h> (i.e.\n+   this file!) and then only defines LC_MESSAGES.  To avoid a redefinition\n+   warning, don't define LC_MESSAGES in this case.  */\n+#if !defined LC_MESSAGES && !defined __LOCALE_H\n+# define LC_MESSAGES 1729\n+#endif\n+\n+/* We define an additional symbol to signal that we use the GNU\n+   implementation of gettext.  */\n+#define __USE_GNU_GETTEXT 1\n+\n+/* Resolve a platform specific conflict on DJGPP.  GNU gettext takes\n+   precedence over _conio_gettext.  */\n+#ifdef __DJGPP__\n+# undef gettext\n+# define gettext gettext\n+#endif\n+\n+#ifndef PARAMS\n+# if __STDC__ || defined __cplusplus\n+#  define PARAMS(args) args\n+# else\n+#  define PARAMS(args) ()\n+# endif\n+#endif\n+\n+#ifdef __cplusplus\n+extern \"C\" {\n+#endif\n+\n+/* Look up MSGID in the current default message catalog for the current\n+   LC_MESSAGES locale.  If not found, returns MSGID itself (the default\n+   text).  */\n+extern char *gettext PARAMS ((const char *__msgid));\n+\n+/* Look up MSGID in the DOMAINNAME message catalog for the current\n+   LC_MESSAGES locale.  */\n+extern char *dgettext PARAMS ((const char *__domainname, const char *__msgid));\n+\n+/* Look up MSGID in the DOMAINNAME message catalog for the current CATEGORY\n+   locale.  */\n+extern char *dcgettext PARAMS ((const char *__domainname, const char *__msgid,\n+\t\t\t\tint __category));\n+\n+\n+/* Similar to `gettext' but select the plural form corresponding to the\n+   number N.  */\n+extern char *ngettext PARAMS ((const char *__msgid1, const char *__msgid2,\n+\t\t\t       unsigned long int __n));\n+\n+/* Similar to `dgettext' but select the plural form corresponding to the\n+   number N.  */\n+extern char *dngettext PARAMS ((const char *__domainname, const char *__msgid1,\n+\t\t\t\tconst char *__msgid2, unsigned long int __n));\n+\n+/* Similar to `dcgettext' but select the plural form corresponding to the\n+   number N.  */\n+extern char *dcngettext PARAMS ((const char *__domainname, const char *__msgid1,\n+\t\t\t\t const char *__msgid2, unsigned long int __n,\n+\t\t\t\t int __category));\n+\n+\n+/* Set the current default message catalog to DOMAINNAME.\n+   If DOMAINNAME is null, return the current default.\n+   If DOMAINNAME is \"\", reset to the default of \"messages\".  */\n+extern char *textdomain PARAMS ((const char *__domainname));\n+\n+/* Specify that the DOMAINNAME message catalog will be found\n+   in DIRNAME rather than in the system locale data base.  */\n+extern char *bindtextdomain PARAMS ((const char *__domainname,\n+\t\t\t\t     const char *__dirname));\n+\n+/* Specify the character encoding in which the messages from the\n+   DOMAINNAME message catalog will be returned.  */\n+extern char *bind_textdomain_codeset PARAMS ((const char *__domainname,\n+\t\t\t\t\t      const char *__codeset));\n+\n+\n+/* Optimized version of the functions above.  */\n+#if defined __OPTIMIZED\n+/* These are macros, but could also be inline functions.  */\n+\n+# define gettext(msgid)\t\t\t\t\t\t\t      \\\n+  dgettext (NULL, msgid)\n+\n+# define dgettext(domainname, msgid)\t\t\t\t\t      \\\n+  dcgettext (domainname, msgid, LC_MESSAGES)\n+\n+# define ngettext(msgid1, msgid2, n)\t\t\t\t\t      \\\n+  dngettext (NULL, msgid1, msgid2, n)\n+\n+# define dngettext(domainname, msgid1, msgid2, n)\t\t\t      \\\n+  dcngettext (domainname, msgid1, msgid2, n, LC_MESSAGES)\n+\n+#endif /* Optimizing. */\n+\n+\n+#ifdef __cplusplus\n+}\n+#endif\n+\n+#endif /* libintl.h */"}, {"sha": "5918e720a9adca1c7983a1becf4f6a9d23cea20d", "filename": "gcc/intl/linux-msg.sed", "status": "removed", "additions": 0, "deletions": 100, "changes": 100, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7e21622e0e580b065224125cc6085b9f0559293a/gcc%2Fintl%2Flinux-msg.sed", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7e21622e0e580b065224125cc6085b9f0559293a/gcc%2Fintl%2Flinux-msg.sed", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fintl%2Flinux-msg.sed?ref=7e21622e0e580b065224125cc6085b9f0559293a", "patch": "@@ -1,100 +0,0 @@\n-# po2msg.sed - Convert Uniforum style .po file to Linux style .msg file\n-# Copyright (C) 1995 Free Software Foundation, Inc.\n-# Ulrich Drepper <drepper@gnu.ai.mit.edu>, 1995.\n-#\n-# This program is free software; you can redistribute it and/or modify\n-# it under the terms of the GNU General Public License as published by\n-# the Free Software Foundation; either version 2, or (at your option)\n-# any later version.\n-#\n-# This program is distributed in the hope that it will be useful,\n-# but WITHOUT ANY WARRANTY; without even the implied warranty of\n-# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n-# GNU General Public License for more details.\n-#\n-# You should have received a copy of the GNU General Public License\n-# along with this program; if not, write to the Free Software\n-# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.\n-#\n-#\n-# The first directive in the .msg should be the definition of the\n-# message set number.  We use always set number 1.\n-#\n-1 {\n-  i\\\n-$set 1 # Automatically created by po2msg.sed\n-  h\n-  s/.*/0/\n-  x\n-}\n-#\n-# Mitch's old catalog format does not allow comments.\n-#\n-# We copy the original message as a comment into the .msg file.\n-#\n-/^msgid/ {\n-  s/msgid[ \t]*\"//\n-#\n-# This does not work now with the new format.\n-# /\"$/! {\n-#   s/\\\\$//\n-#   s/$/ ... (more lines following)\"/\n-# }\n-  x\n-# The following nice solution is by\n-# Bruno <Haible@ma2s2.mathematik.uni-karlsruhe.de>\n-  td\n-# Increment a decimal number in pattern space.\n-# First hide trailing `9' digits.\n-  :d\n-  s/9\\(_*\\)$/_\\1/\n-  td\n-# Assure at least one digit is available.\n-  s/^\\(_*\\)$/0\\1/\n-# Increment the last digit.\n-  s/8\\(_*\\)$/9\\1/\n-  s/7\\(_*\\)$/8\\1/\n-  s/6\\(_*\\)$/7\\1/\n-  s/5\\(_*\\)$/6\\1/\n-  s/4\\(_*\\)$/5\\1/\n-  s/3\\(_*\\)$/4\\1/\n-  s/2\\(_*\\)$/3\\1/\n-  s/1\\(_*\\)$/2\\1/\n-  s/0\\(_*\\)$/1\\1/\n-# Convert the hidden `9' digits to `0's.\n-  s/_/0/g\n-  x\n-  G\n-  s/\\(.*\\)\"\\n\\([0-9]*\\)/$ #\\2 Original Message:(\\1)/p\n-}\n-#\n-# The .msg file contains, other then the .po file, only the translations\n-# but each given a unique ID.  Starting from 1 and incrementing by 1 for\n-# each message we assign them to the messages.\n-# It is important that the .po file used to generate the cat-id-tbl.c file\n-# (with po-to-tbl) is the same as the one used here.  (At least the order\n-# of declarations must not be changed.)\n-#\n-/^msgstr/ {\n-  s/msgstr[ \t]*\"\\(.*\\)\"/# \\1/\n-# Clear substitution flag.\n-  tb\n-# Append the next line.\n-  :b\n-  N\n-# Look whether second part is continuation line.\n-  s/\\(.*\\n\\)\"\\(.*\\)\"/\\1\\2/\n-# Yes, then branch.\n-  ta\n-  P\n-  D\n-# Note that D includes a jump to the start!!\n-# We found a continuation line.  But before printing insert '\\'.\n-  :a\n-  s/\\(.*\\)\\(\\n.*\\)/\\1\\\\\\2/\n-  P\n-# We cannot use D here.\n-  s/.*\\n\\(.*\\)/\\1/\n-  tb\n-}\n-d"}, {"sha": "b8612607b62537fe15b30d4f408296ec173dda23", "filename": "gcc/intl/loadinfo.h", "status": "modified", "additions": 43, "deletions": 10, "changes": 53, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Floadinfo.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Floadinfo.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fintl%2Floadinfo.h?ref=71a94577632a238bf4e112f0f016819ead09f1d5", "patch": "@@ -1,20 +1,24 @@\n-/* Copyright (C) 1996, 1997 Free Software Foundation, Inc.\n+/* Copyright (C) 1996-1999, 2000, 2001 Free Software Foundation, Inc.\n    This file is part of the GNU C Library.\n    Contributed by Ulrich Drepper <drepper@cygnus.com>, 1996.\n \n-   This program is free software; you can redistribute it and/or modify\n-   it under the terms of the GNU General Public License as published by\n-   the Free Software Foundation; either version 2, or (at your option)\n+   This program is free software; you can redistribute it and/or modify it\n+   under the terms of the GNU Library General Public License as published\n+   by the Free Software Foundation; either version 2, or (at your option)\n    any later version.\n \n    This program is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n-   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n-   GNU General Public License for more details.\n+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+   Library General Public License for more details.\n \n-   You should have received a copy of the GNU General Public License\n-   along with this program; if not, write to the Free Software Foundation,\n-   Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.  */\n+   You should have received a copy of the GNU Library General Public\n+   License along with this program; if not, write to the Free Software\n+   Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307,\n+   USA.  */\n+\n+#ifndef _LOADINFO_H\n+#define _LOADINFO_H\t1\n \n #ifndef PARAMS\n # if __STDC__\n@@ -24,6 +28,25 @@\n # endif\n #endif\n \n+#ifndef internal_function\n+# define internal_function\n+#endif\n+\n+/* Tell the compiler when a conditional or integer expression is\n+   almost always true or almost always false.  */\n+#ifndef HAVE_BUILTIN_EXPECT\n+# define __builtin_expect(expr, val) (expr)\n+#endif\n+\n+/* Separator in PATH like lists of pathnames.  */\n+#if defined _WIN32 || defined __WIN32__ || defined __EMX__ || defined __DJGPP__\n+  /* Win32, OS/2, DOS */\n+# define PATH_SEPARATOR ';'\n+#else\n+  /* Unix */\n+# define PATH_SEPARATOR ':'\n+#endif\n+\n /* Encoding of locale name parts.  */\n #define CEN_REVISION\t\t1\n #define CEN_SPONSOR\t\t2\n@@ -50,7 +73,11 @@ struct loaded_l10nfile\n };\n \n \n-extern const char *_nl_normalize_codeset PARAMS ((const unsigned char *codeset,\n+/* Normalize codeset name.  There is no standard for the codeset\n+   names.  Normalization allows the user to use any of the common\n+   names.  The return value is dynamically allocated and has to be\n+   freed by the caller.  */\n+extern const char *_nl_normalize_codeset PARAMS ((const char *codeset,\n \t\t\t\t\t\t  size_t name_len));\n \n extern struct loaded_l10nfile *\n@@ -66,6 +93,8 @@ _nl_make_l10nflist PARAMS ((struct loaded_l10nfile **l10nfile_list,\n \n extern const char *_nl_expand_alias PARAMS ((const char *name));\n \n+/* normalized_codeset is dynamically allocated and has to be freed by\n+   the caller.  */\n extern int _nl_explode_name PARAMS ((char *name, const char **language,\n \t\t\t\t     const char **modifier,\n \t\t\t\t     const char **territory,\n@@ -74,3 +103,7 @@ extern int _nl_explode_name PARAMS ((char *name, const char **language,\n \t\t\t\t     const char **special,\n \t\t\t\t     const char **sponsor,\n \t\t\t\t     const char **revision));\n+\n+extern char *_nl_find_language PARAMS ((const char *name));\n+\n+#endif\t/* loadinfo.h */"}, {"sha": "097624eed574a78352bac0899a775bb29fa25979", "filename": "gcc/intl/loadmsgcat.c", "status": "modified", "additions": 388, "deletions": 43, "changes": 431, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Floadmsgcat.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Floadmsgcat.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fintl%2Floadmsgcat.c?ref=71a94577632a238bf4e112f0f016819ead09f1d5", "patch": "@@ -1,43 +1,83 @@\n /* Load needed message catalogs.\n-   Copyright (C) 1995, 1996, 1997, 1998 Free Software Foundation, Inc.\n+   Copyright (C) 1995-1999, 2000, 2001 Free Software Foundation, Inc.\n \n-   This program is free software; you can redistribute it and/or modify\n-   it under the terms of the GNU General Public License as published by\n-   the Free Software Foundation; either version 2, or (at your option)\n+   This program is free software; you can redistribute it and/or modify it\n+   under the terms of the GNU Library General Public License as published\n+   by the Free Software Foundation; either version 2, or (at your option)\n    any later version.\n \n    This program is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n-   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n-   GNU General Public License for more details.\n-\n-   You should have received a copy of the GNU General Public License\n-   along with this program; if not, write to the Free Software Foundation,\n-   Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.  */\n+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+   Library General Public License for more details.\n+\n+   You should have received a copy of the GNU Library General Public\n+   License along with this program; if not, write to the Free Software\n+   Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307,\n+   USA.  */\n+\n+/* Tell glibc's <string.h> to provide a prototype for mempcpy().\n+   This must come before <config.h> because <config.h> may include\n+   <features.h>, and once <features.h> has been included, it's too late.  */\n+#ifndef _GNU_SOURCE\n+# define _GNU_SOURCE    1\n+#endif\n \n #ifdef HAVE_CONFIG_H\n # include <config.h>\n #endif\n \n+#include <ctype.h>\n+#include <errno.h>\n #include <fcntl.h>\n #include <sys/types.h>\n #include <sys/stat.h>\n \n-#if defined STDC_HEADERS || defined _LIBC\n-# include <stdlib.h>\n+#ifdef __GNUC__\n+# define alloca __builtin_alloca\n+# define HAVE_ALLOCA 1\n+#else\n+# if defined HAVE_ALLOCA_H || defined _LIBC\n+#  include <alloca.h>\n+# else\n+#  ifdef _AIX\n+ #pragma alloca\n+#  else\n+#   ifndef alloca\n+char *alloca ();\n+#   endif\n+#  endif\n+# endif\n #endif\n \n+#include <stdlib.h>\n+#include <string.h>\n+\n #if defined HAVE_UNISTD_H || defined _LIBC\n # include <unistd.h>\n #endif\n \n-#if defined HAVE_MMAP_FILE || defined _LIBC\n+#ifdef _LIBC\n+# include <langinfo.h>\n+# include <locale.h>\n+#endif\n+\n+#if (defined HAVE_MMAP_FILE && !defined DISALLOW_MMAP) \\\n+    || (defined _LIBC && defined _POSIX_MAPPED_FILES)\n # include <sys/mman.h>\n+# undef HAVE_MMAP\n+# define HAVE_MMAP\t1\n+#else\n+# undef HAVE_MMAP\n #endif\n \n #include \"gettext.h\"\n #include \"gettextP.h\"\n \n+#ifdef _LIBC\n+# include \"../locale/localeinfo.h\"\n+#endif\n+\n /* @@ end of prolog @@ */\n \n #ifdef _LIBC\n@@ -51,32 +91,275 @@\n # define munmap __munmap\n #endif\n \n+/* Names for the libintl functions are a problem.  They must not clash\n+   with existing names and they should follow ANSI C.  But this source\n+   code is also used in GNU C Library where the names have a __\n+   prefix.  So we have to make a difference here.  */\n+#ifdef _LIBC\n+# define PLURAL_PARSE __gettextparse\n+#else\n+# define PLURAL_PARSE gettextparse__\n+#endif\n+\n+/* For those losing systems which don't have `alloca' we have to add\n+   some additional code emulating it.  */\n+#ifdef HAVE_ALLOCA\n+# define freea(p) /* nothing */\n+#else\n+# define alloca(n) malloc (n)\n+# define freea(p) free (p)\n+#endif\n+\n+/* For systems that distinguish between text and binary I/O.\n+   O_BINARY is usually declared in <fcntl.h>. */\n+#if !defined O_BINARY && defined _O_BINARY\n+  /* For MSC-compatible compilers.  */\n+# define O_BINARY _O_BINARY\n+# define O_TEXT _O_TEXT\n+#endif\n+#ifdef __BEOS__\n+  /* BeOS 5 has O_BINARY and O_TEXT, but they have no effect.  */\n+# undef O_BINARY\n+# undef O_TEXT\n+#endif\n+/* On reasonable systems, binary I/O is the default.  */\n+#ifndef O_BINARY\n+# define O_BINARY 0\n+#endif\n+\n /* We need a sign, whether a new catalog was loaded, which can be associated\n    with all translations.  This is important if the translations are\n    cached by one of GCC's features.  */\n-int _nl_msg_cat_cntr = 0;\n+int _nl_msg_cat_cntr;\n+\n+#if (defined __GNUC__ && !defined __APPLE_CC__) \\\n+    || (defined __STDC_VERSION__ && __STDC_VERSION__ >= 199901L)\n+\n+/* These structs are the constant expression for the germanic plural\n+   form determination.  It represents the expression  \"n != 1\".  */\n+static const struct expression plvar =\n+{\n+  .nargs = 0,\n+  .operation = var,\n+};\n+static const struct expression plone =\n+{\n+  .nargs = 0,\n+  .operation = num,\n+  .val =\n+  {\n+    .num = 1\n+  }\n+};\n+static struct expression germanic_plural =\n+{\n+  .nargs = 2,\n+  .operation = not_equal,\n+  .val =\n+  {\n+    .args =\n+    {\n+      [0] = (struct expression *) &plvar,\n+      [1] = (struct expression *) &plone\n+    }\n+  }\n+};\n+\n+# define INIT_GERMANIC_PLURAL()\n+\n+#else\n+\n+/* For compilers without support for ISO C 99 struct/union initializers:\n+   Initialization at run-time.  */\n+\n+static struct expression plvar;\n+static struct expression plone;\n+static struct expression germanic_plural;\n+\n+static void\n+init_germanic_plural ()\n+{\n+  if (plone.val.num == 0)\n+    {\n+      plvar.nargs = 0;\n+      plvar.operation = var;\n+\n+      plone.nargs = 0;\n+      plone.operation = num;\n+      plone.val.num = 1;\n+\n+      germanic_plural.nargs = 2;\n+      germanic_plural.operation = not_equal;\n+      germanic_plural.val.args[0] = &plvar;\n+      germanic_plural.val.args[1] = &plone;\n+    }\n+}\n+\n+# define INIT_GERMANIC_PLURAL() init_germanic_plural ()\n+\n+#endif\n+\n+\n+/* Initialize the codeset dependent parts of an opened message catalog.\n+   Return the header entry.  */\n+const char *\n+internal_function\n+_nl_init_domain_conv (domain_file, domain, domainbinding)\n+     struct loaded_l10nfile *domain_file;\n+     struct loaded_domain *domain;\n+     struct binding *domainbinding;\n+{\n+  /* Find out about the character set the file is encoded with.\n+     This can be found (in textual form) in the entry \"\".  If this\n+     entry does not exist or if this does not contain the `charset='\n+     information, we will assume the charset matches the one the\n+     current locale and we don't have to perform any conversion.  */\n+  char *nullentry;\n+  size_t nullentrylen;\n+\n+  /* Preinitialize fields, to avoid recursion during _nl_find_msg.  */\n+  domain->codeset_cntr =\n+    (domainbinding != NULL ? domainbinding->codeset_cntr : 0);\n+#ifdef _LIBC\n+  domain->conv = (__gconv_t) -1;\n+#else\n+# if HAVE_ICONV\n+  domain->conv = (iconv_t) -1;\n+# endif\n+#endif\n+  domain->conv_tab = NULL;\n \n+  /* Get the header entry.  */\n+  nullentry = _nl_find_msg (domain_file, domainbinding, \"\", &nullentrylen);\n+\n+  if (nullentry != NULL)\n+    {\n+#if defined _LIBC || HAVE_ICONV\n+      const char *charsetstr;\n+\n+      charsetstr = strstr (nullentry, \"charset=\");\n+      if (charsetstr != NULL)\n+\t{\n+\t  size_t len;\n+\t  char *charset;\n+\t  const char *outcharset;\n+\n+\t  charsetstr += strlen (\"charset=\");\n+\t  len = strcspn (charsetstr, \" \\t\\n\");\n+\n+\t  charset = (char *) alloca (len + 1);\n+# if defined _LIBC || HAVE_MEMPCPY\n+\t  *((char *) mempcpy (charset, charsetstr, len)) = '\\0';\n+# else\n+\t  memcpy (charset, charsetstr, len);\n+\t  charset[len] = '\\0';\n+# endif\n+\n+\t  /* The output charset should normally be determined by the\n+\t     locale.  But sometimes the locale is not used or not correctly\n+\t     set up, so we provide a possibility for the user to override\n+\t     this.  Moreover, the value specified through\n+\t     bind_textdomain_codeset overrides both.  */\n+\t  if (domainbinding != NULL && domainbinding->codeset != NULL)\n+\t    outcharset = domainbinding->codeset;\n+\t  else\n+\t    {\n+\t      outcharset = getenv (\"OUTPUT_CHARSET\");\n+\t      if (outcharset == NULL || outcharset[0] == '\\0')\n+\t\t{\n+# ifdef _LIBC\n+\t\t  outcharset = (*_nl_current[LC_CTYPE])->values[_NL_ITEM_INDEX (CODESET)].string;\n+# else\n+#  if HAVE_ICONV\n+\t\t  extern const char *locale_charset (void);\n+\t\t  outcharset = locale_charset ();\n+#  endif\n+# endif\n+\t\t}\n+\t    }\n+\n+# ifdef _LIBC\n+\t  /* We always want to use transliteration.  */\n+\t  outcharset = norm_add_slashes (outcharset, \"TRANSLIT\");\n+\t  charset = norm_add_slashes (charset, NULL);\n+\t  if (__gconv_open (outcharset, charset, &domain->conv,\n+\t\t\t    GCONV_AVOID_NOCONV)\n+\t      != __GCONV_OK)\n+\t    domain->conv = (__gconv_t) -1;\n+# else\n+#  if HAVE_ICONV\n+\t  /* When using GNU libiconv, we want to use transliteration.  */\n+#   if _LIBICONV_VERSION >= 0x0105\n+\t  len = strlen (outcharset);\n+\t  {\n+\t    char *tmp = (char *) alloca (len + 10 + 1);\n+\t    memcpy (tmp, outcharset, len);\n+\t    memcpy (tmp + len, \"//TRANSLIT\", 10 + 1);\n+\t    outcharset = tmp;\n+\t  }\n+#   endif\n+\t  domain->conv = iconv_open (outcharset, charset);\n+#   if _LIBICONV_VERSION >= 0x0105\n+\t  freea (outcharset);\n+#   endif\n+#  endif\n+# endif\n+\n+\t  freea (charset);\n+\t}\n+#endif /* _LIBC || HAVE_ICONV */\n+    }\n+\n+  return nullentry;\n+}\n+\n+/* Frees the codeset dependent parts of an opened message catalog.  */\n+void\n+internal_function\n+_nl_free_domain_conv (domain)\n+     struct loaded_domain *domain;\n+{\n+  if (domain->conv_tab != NULL && domain->conv_tab != (char **) -1)\n+    free (domain->conv_tab);\n+\n+#ifdef _LIBC\n+  if (domain->conv != (__gconv_t) -1)\n+    __gconv_close (domain->conv);\n+#else\n+# if HAVE_ICONV\n+  if (domain->conv != (iconv_t) -1)\n+    iconv_close (domain->conv);\n+# endif\n+#endif\n+}\n \n /* Load the message catalogs specified by FILENAME.  If it is no valid\n    message catalog do nothing.  */\n void\n internal_function\n-_nl_load_domain (domain_file)\n+_nl_load_domain (domain_file, domainbinding)\n      struct loaded_l10nfile *domain_file;\n+     struct binding *domainbinding;\n {\n   int fd;\n   size_t size;\n+#ifdef _LIBC\n+  struct stat64 st;\n+#else\n   struct stat st;\n+#endif\n   struct mo_file_header *data = (struct mo_file_header *) -1;\n-#if (defined HAVE_MMAP_FILE && !defined DISALLOW_MMAP) \\\n-    || defined _LIBC\n   int use_mmap = 0;\n-#endif\n   struct loaded_domain *domain;\n+  const char *nullentry;\n \n   domain_file->decided = 1;\n   domain_file->data = NULL;\n \n+  /* Note that it would be useless to store domainbinding in domain_file\n+     because domainbinding might be == NULL now but != NULL later (after\n+     a call to bind_textdomain_codeset).  */\n+\n   /* If the record does not represent a valid locale the FILENAME\n      might be NULL.  This can happen when according to the given\n      specification the locale file name is different for XPG and CEN\n@@ -85,28 +368,32 @@ _nl_load_domain (domain_file)\n     return;\n \n   /* Try to open the addressed file.  */\n-  fd = open (domain_file->filename, O_RDONLY);\n+  fd = open (domain_file->filename, O_RDONLY | O_BINARY);\n   if (fd == -1)\n     return;\n \n   /* We must know about the size of the file.  */\n-  if (fstat (fd, &st) != 0\n-      || (size = (size_t) st.st_size) != (size_t) st.st_size\n-      || size < sizeof (struct mo_file_header))\n+  if (\n+#ifdef _LIBC\n+      __builtin_expect (fstat64 (fd, &st) != 0, 0)\n+#else\n+      __builtin_expect (fstat (fd, &st) != 0, 0)\n+#endif\n+      || __builtin_expect ((size = (size_t) st.st_size) != st.st_size, 0)\n+      || __builtin_expect (size < sizeof (struct mo_file_header), 0))\n     {\n       /* Something went wrong.  */\n       close (fd);\n       return;\n     }\n \n-#if (defined HAVE_MMAP_FILE && !defined DISALLOW_MMAP) \\\n-    || defined _LIBC\n+#ifdef HAVE_MMAP\n   /* Now we are ready to load the file.  If mmap() is available we try\n      this first.  If not available or it failed we try to load it.  */\n   data = (struct mo_file_header *) mmap (NULL, size, PROT_READ,\n \t\t\t\t\t MAP_PRIVATE, fd, 0);\n \n-  if (data != (struct mo_file_header *) -1)\n+  if (__builtin_expect (data != (struct mo_file_header *) -1, 1))\n     {\n       /* mmap() call was successful.  */\n       close (fd);\n@@ -130,12 +417,15 @@ _nl_load_domain (domain_file)\n       do\n \t{\n \t  long int nb = (long int) read (fd, read_ptr, to_read);\n-\t  if (nb == -1)\n+\t  if (nb <= 0)\n \t    {\n+#ifdef EINTR\n+\t      if (nb == -1 && errno == EINTR)\n+\t\tcontinue;\n+#endif\n \t      close (fd);\n \t      return;\n \t    }\n-\n \t  read_ptr += nb;\n \t  to_read -= nb;\n \t}\n@@ -146,11 +436,11 @@ _nl_load_domain (domain_file)\n \n   /* Using the magic number we can test whether it really is a message\n      catalog file.  */\n-  if (data->magic != _MAGIC && data->magic != _MAGIC_SWAPPED)\n+  if (__builtin_expect (data->magic != _MAGIC && data->magic != _MAGIC_SWAPPED,\n+\t\t\t0))\n     {\n       /* The magic number is wrong: not a message catalog file.  */\n-#if (defined HAVE_MMAP_FILE && !defined DISALLOW_MMAP) \\\n-    || defined _LIBC\n+#ifdef HAVE_MMAP\n       if (use_mmap)\n \tmunmap ((caddr_t) data, size);\n       else\n@@ -159,17 +449,13 @@ _nl_load_domain (domain_file)\n       return;\n     }\n \n-  domain_file->data\n-    = (struct loaded_domain *) malloc (sizeof (struct loaded_domain));\n-  if (domain_file->data == NULL)\n+  domain = (struct loaded_domain *) malloc (sizeof (struct loaded_domain));\n+  if (domain == NULL)\n     return;\n+  domain_file->data = domain;\n \n-  domain = (struct loaded_domain *) domain_file->data;\n   domain->data = (char *) data;\n-#if (defined HAVE_MMAP_FILE && !defined DISALLOW_MMAP) \\\n-    || defined _LIBC\n   domain->use_mmap = use_mmap;\n-#endif\n   domain->mmap_size = size;\n   domain->must_swap = data->magic != _MAGIC;\n \n@@ -187,9 +473,8 @@ _nl_load_domain (domain_file)\n \t((char *) data + W (domain->must_swap, data->hash_tab_offset));\n       break;\n     default:\n-      /* This is an illegal revision.  */\n-#if (defined HAVE_MMAP_FILE && !defined DISALLOW_MMAP) \\\n-    || defined _LIBC\n+      /* This is an invalid revision.  */\n+#ifdef HAVE_MMAP\n       if (use_mmap)\n \tmunmap ((caddr_t) data, size);\n       else\n@@ -200,9 +485,62 @@ _nl_load_domain (domain_file)\n       return;\n     }\n \n-  /* Show that one domain is changed.  This might make some cached\n-     translations invalid.  */\n-  ++_nl_msg_cat_cntr;\n+  /* Now initialize the character set converter from the character set\n+     the file is encoded with (found in the header entry) to the domain's\n+     specified character set or the locale's character set.  */\n+  nullentry = _nl_init_domain_conv (domain_file, domain, domainbinding);\n+\n+  /* Also look for a plural specification.  */\n+  if (nullentry != NULL)\n+    {\n+      const char *plural;\n+      const char *nplurals;\n+\n+      plural = strstr (nullentry, \"plural=\");\n+      nplurals = strstr (nullentry, \"nplurals=\");\n+      if (plural == NULL || nplurals == NULL)\n+\tgoto no_plural;\n+      else\n+\t{\n+\t  /* First get the number.  */\n+\t  char *endp;\n+\t  unsigned long int n;\n+\t  struct parse_args args;\n+\n+\t  nplurals += 9;\n+\t  while (*nplurals != '\\0' && isspace (*nplurals))\n+\t    ++nplurals;\n+#if defined HAVE_STRTOUL || defined _LIBC\n+\t  n = strtoul (nplurals, &endp, 10);\n+#else\n+\t  for (endp = nplurals, n = 0; *endp >= '0' && *endp <= '9'; endp++)\n+\t    n = n * 10 + (*endp - '0');\n+#endif\n+\t  domain->nplurals = n;\n+\t  if (nplurals == endp)\n+\t    goto no_plural;\n+\n+\t  /* Due to the restrictions bison imposes onto the interface of the\n+\t     scanner function we have to put the input string and the result\n+\t     passed up from the parser into the same structure which address\n+\t     is passed down to the parser.  */\n+\t  plural += 7;\n+\t  args.cp = plural;\n+\t  if (PLURAL_PARSE (&args) != 0)\n+\t    goto no_plural;\n+\t  domain->plural = args.res;\n+\t}\n+    }\n+  else\n+    {\n+      /* By default we are using the Germanic form: singular form only\n+         for `one', the plural form otherwise.  Yes, this is also what\n+         English is using since English is a Germanic language.  */\n+    no_plural:\n+      INIT_GERMANIC_PLURAL ();\n+      domain->plural = &germanic_plural;\n+      domain->nplurals = 2;\n+    }\n }\n \n \n@@ -212,9 +550,16 @@ internal_function\n _nl_unload_domain (domain)\n      struct loaded_domain *domain;\n {\n+  if (domain->plural != &germanic_plural)\n+    __gettext_free_exp (domain->plural);\n+\n+  _nl_free_domain_conv (domain);\n+\n+# ifdef _POSIX_MAPPED_FILES\n   if (domain->use_mmap)\n     munmap ((caddr_t) domain->data, domain->mmap_size);\n   else\n+# endif\t/* _POSIX_MAPPED_FILES */\n     free ((void *) domain->data);\n \n   free (domain);"}, {"sha": "61f8f3e8529ed4b5de04fad2f0f84642c14cf0af", "filename": "gcc/intl/localcharset.c", "status": "added", "additions": 271, "deletions": 0, "changes": 271, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Flocalcharset.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Flocalcharset.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fintl%2Flocalcharset.c?ref=71a94577632a238bf4e112f0f016819ead09f1d5", "patch": "@@ -0,0 +1,271 @@\n+/* Determine a canonical name for the current locale's character encoding.\n+\n+   Copyright (C) 2000-2001 Free Software Foundation, Inc.\n+\n+   This program is free software; you can redistribute it and/or modify it\n+   under the terms of the GNU Library General Public License as published\n+   by the Free Software Foundation; either version 2, or (at your option)\n+   any later version.\n+\n+   This program is distributed in the hope that it will be useful,\n+   but WITHOUT ANY WARRANTY; without even the implied warranty of\n+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+   Library General Public License for more details.\n+\n+   You should have received a copy of the GNU Library General Public\n+   License along with this program; if not, write to the Free Software\n+   Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307,\n+   USA.  */\n+\n+/* Written by Bruno Haible <haible@clisp.cons.org>.  */\n+\n+#ifdef HAVE_CONFIG_H\n+# include <config.h>\n+#endif\n+\n+#if HAVE_STDDEF_H\n+# include <stddef.h>\n+#endif\n+\n+#include <stdio.h>\n+#if HAVE_STRING_H\n+# include <string.h>\n+#else\n+# include <strings.h>\n+#endif\n+#if HAVE_STDLIB_H\n+# include <stdlib.h>\n+#endif\n+\n+#if defined _WIN32 || defined __WIN32__\n+# undef WIN32   /* avoid warning on mingw32 */\n+# define WIN32\n+#endif\n+\n+#ifndef WIN32\n+# if HAVE_LANGINFO_CODESET\n+#  include <langinfo.h>\n+# else\n+#  if HAVE_SETLOCALE\n+#   include <locale.h>\n+#  endif\n+# endif\n+#else /* WIN32 */\n+# define WIN32_LEAN_AND_MEAN\n+# include <windows.h>\n+#endif\n+\n+#ifndef DIRECTORY_SEPARATOR\n+# define DIRECTORY_SEPARATOR '/'\n+#endif\n+\n+#ifndef ISSLASH\n+# define ISSLASH(C) ((C) == DIRECTORY_SEPARATOR)\n+#endif\n+\n+/* The following static variable is declared 'volatile' to avoid a\n+   possible multithread problem in the function get_charset_aliases. If we\n+   are running in a threaded environment, and if two threads initialize\n+   'charset_aliases' simultaneously, both will produce the same value,\n+   and everything will be ok if the two assignments to 'charset_aliases'\n+   are atomic. But I don't know what will happen if the two assignments mix.  */\n+#if __STDC__ != 1\n+# define volatile /* empty */\n+#endif\n+/* Pointer to the contents of the charset.alias file, if it has already been\n+   read, else NULL.  Its format is:\n+   ALIAS_1 '\\0' CANONICAL_1 '\\0' ... ALIAS_n '\\0' CANONICAL_n '\\0' '\\0'  */\n+static const char * volatile charset_aliases;\n+\n+/* Return a pointer to the contents of the charset.alias file.  */\n+static const char *\n+get_charset_aliases ()\n+{\n+  const char *cp;\n+\n+  cp = charset_aliases;\n+  if (cp == NULL)\n+    {\n+#ifndef WIN32\n+      FILE *fp;\n+      const char *dir = LIBDIR;\n+      const char *base = \"charset.alias\";\n+      char *file_name;\n+\n+      /* Concatenate dir and base into freshly allocated file_name.  */\n+      {\n+\tsize_t dir_len = strlen (dir);\n+\tsize_t base_len = strlen (base);\n+\tint add_slash = (dir_len > 0 && !ISSLASH (dir[dir_len - 1]));\n+\tfile_name = (char *) malloc (dir_len + add_slash + base_len + 1);\n+\tif (file_name != NULL)\n+\t  {\n+\t    memcpy (file_name, dir, dir_len);\n+\t    if (add_slash)\n+\t      file_name[dir_len] = DIRECTORY_SEPARATOR;\n+\t    memcpy (file_name + dir_len + add_slash, base, base_len + 1);\n+\t  }\n+      }\n+\n+      if (file_name == NULL || (fp = fopen (file_name, \"r\")) == NULL)\n+\t/* Out of memory or file not found, treat it as empty.  */\n+\tcp = \"\";\n+      else\n+\t{\n+\t  /* Parse the file's contents.  */\n+\t  int c;\n+\t  char buf1[50+1];\n+\t  char buf2[50+1];\n+\t  char *res_ptr = NULL;\n+\t  size_t res_size = 0;\n+\t  size_t l1, l2;\n+\n+\t  for (;;)\n+\t    {\n+\t      c = getc (fp);\n+\t      if (c == EOF)\n+\t\tbreak;\n+\t      if (c == '\\n' || c == ' ' || c == '\\t')\n+\t\tcontinue;\n+\t      if (c == '#')\n+\t\t{\n+\t\t  /* Skip comment, to end of line.  */\n+\t\t  do\n+\t\t    c = getc (fp);\n+\t\t  while (!(c == EOF || c == '\\n'));\n+\t\t  if (c == EOF)\n+\t\t    break;\n+\t\t  continue;\n+\t\t}\n+\t      ungetc (c, fp);\n+\t      if (fscanf(fp, \"%50s %50s\", buf1, buf2) < 2)\n+\t\tbreak;\n+\t      l1 = strlen (buf1);\n+\t      l2 = strlen (buf2);\n+\t      if (res_size == 0)\n+\t\t{\n+\t\t  res_size = l1 + 1 + l2 + 1;\n+\t\t  res_ptr = malloc (res_size + 1);\n+\t\t}\n+\t      else\n+\t\t{\n+\t\t  res_size += l1 + 1 + l2 + 1;\n+\t\t  res_ptr = realloc (res_ptr, res_size + 1);\n+\t\t}\n+\t      if (res_ptr == NULL)\n+\t\t{\n+\t\t  /* Out of memory. */\n+\t\t  res_size = 0;\n+\t\t  break;\n+\t\t}\n+\t      strcpy (res_ptr + res_size - (l2 + 1) - (l1 + 1), buf1);\n+\t      strcpy (res_ptr + res_size - (l2 + 1), buf2);\n+\t    }\n+\t  fclose (fp);\n+\t  if (res_size == 0)\n+\t    cp = \"\";\n+\t  else\n+\t    {\n+\t      *(res_ptr + res_size) = '\\0';\n+\t      cp = res_ptr;\n+\t    }\n+\t}\n+\n+      if (file_name != NULL)\n+\tfree (file_name);\n+\n+#else /* WIN32 */\n+\n+      /* To avoid the troubles of installing a separate file in the same\n+\t directory as the DLL and of retrieving the DLL's directory at\n+\t runtime, simply inline the aliases here.  */\n+\n+      cp = \"CP936\" \"\\0\" \"GBK\" \"\\0\"\n+\t   \"CP1361\" \"\\0\" \"JOHAB\" \"\\0\";\n+#endif\n+\n+      charset_aliases = cp;\n+    }\n+\n+  return cp;\n+}\n+\n+/* Determine the current locale's character encoding, and canonicalize it\n+   into one of the canonical names listed in config.charset.\n+   The result must not be freed; it is statically allocated.\n+   If the canonical name cannot be determined, the result is a non-canonical\n+   name.  */\n+\n+#ifdef STATIC\n+STATIC\n+#endif\n+const char *\n+locale_charset ()\n+{\n+  const char *codeset;\n+  const char *aliases;\n+\n+#ifndef WIN32\n+\n+# if HAVE_LANGINFO_CODESET\n+\n+  /* Most systems support nl_langinfo (CODESET) nowadays.  */\n+  codeset = nl_langinfo (CODESET);\n+\n+# else\n+\n+  /* On old systems which lack it, use setlocale or getenv.  */\n+  const char *locale = NULL;\n+\n+  /* But most old systems don't have a complete set of locales.  Some\n+     (like SunOS 4 or DJGPP) have only the C locale.  Therefore we don't\n+     use setlocale here; it would return \"C\" when it doesn't support the\n+     locale name the user has set.  */\n+#  if HAVE_SETLOCALE && 0\n+  locale = setlocale (LC_CTYPE, NULL);\n+#  endif\n+  if (locale == NULL || locale[0] == '\\0')\n+    {\n+      locale = getenv (\"LC_ALL\");\n+      if (locale == NULL || locale[0] == '\\0')\n+\t{\n+\t  locale = getenv (\"LC_CTYPE\");\n+\t  if (locale == NULL || locale[0] == '\\0')\n+\t    locale = getenv (\"LANG\");\n+\t}\n+    }\n+\n+  /* On some old systems, one used to set locale = \"iso8859_1\". On others,\n+     you set it to \"language_COUNTRY.charset\". In any case, we resolve it\n+     through the charset.alias file.  */\n+  codeset = locale;\n+\n+# endif\n+\n+#else /* WIN32 */\n+\n+  static char buf[2 + 10 + 1];\n+\n+  /* Win32 has a function returning the locale's codepage as a number.  */\n+  sprintf (buf, \"CP%u\", GetACP ());\n+  codeset = buf;\n+\n+#endif\n+\n+  if (codeset == NULL)\n+    /* The canonical name cannot be determined.  */\n+    codeset = \"\";\n+\n+  /* Resolve alias. */\n+  for (aliases = get_charset_aliases ();\n+       *aliases != '\\0';\n+       aliases += strlen (aliases) + 1, aliases += strlen (aliases) + 1)\n+    if (strcmp (codeset, aliases) == 0\n+\t|| (aliases[0] == '*' && aliases[1] == '\\0'))\n+      {\n+\tcodeset = aliases + strlen (aliases) + 1;\n+\tbreak;\n+      }\n+\n+  return codeset;\n+}"}, {"sha": "bd7b9b31eb31edc971d28f1abc295ced77ad7210", "filename": "gcc/intl/locale.alias", "status": "added", "additions": 78, "deletions": 0, "changes": 78, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Flocale.alias", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Flocale.alias", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fintl%2Flocale.alias?ref=71a94577632a238bf4e112f0f016819ead09f1d5", "patch": "@@ -0,0 +1,78 @@\n+# Locale name alias data base.\n+# Copyright (C) 1996,1997,1998,1999,2000,2001 Free Software Foundation, Inc.\n+#\n+# This program is free software; you can redistribute it and/or modify it\n+# under the terms of the GNU Library General Public License as published\n+# by the Free Software Foundation; either version 2, or (at your option)\n+# any later version.\n+#\n+# This program is distributed in the hope that it will be useful,\n+# but WITHOUT ANY WARRANTY; without even the implied warranty of\n+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+# Library General Public License for more details.\n+#\n+# You should have received a copy of the GNU Library General Public\n+# License along with this program; if not, write to the Free Software\n+# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307,\n+# USA.\n+\n+# The format of this file is the same as for the corresponding file of\n+# the X Window System, which normally can be found in\n+#\t/usr/lib/X11/locale/locale.alias\n+# A single line contains two fields: an alias and a substitution value.\n+# All entries are case independent.\n+\n+# Note: This file is far from being complete.  If you have a value for\n+# your own site which you think might be useful for others too, share\n+# it with the rest of us.  Send it using the `glibcbug' script to\n+# bugs@gnu.org.\n+\n+# Packages using this file: \n+\n+bokmal\t\tno_NO.ISO-8859-1\n+bokm\ufffdl\t\tno_NO.ISO-8859-1\n+catalan\t\tca_ES.ISO-8859-1\n+croatian\thr_HR.ISO-8859-2\n+czech\t\tcs_CZ.ISO-8859-2\n+danish          da_DK.ISO-8859-1\n+dansk\t\tda_DK.ISO-8859-1\n+deutsch\t\tde_DE.ISO-8859-1\n+dutch\t\tnl_NL.ISO-8859-1\n+eesti\t\tet_EE.ISO-8859-1\n+estonian\tet_EE.ISO-8859-1\n+finnish         fi_FI.ISO-8859-1\n+fran\ufffdais\tfr_FR.ISO-8859-1\n+french\t\tfr_FR.ISO-8859-1\n+galego\t\tgl_ES.ISO-8859-1\n+galician\tgl_ES.ISO-8859-1\n+german\t\tde_DE.ISO-8859-1\n+greek           el_GR.ISO-8859-7\n+hebrew          he_IL.ISO-8859-8\n+hrvatski\thr_HR.ISO-8859-2\n+hungarian       hu_HU.ISO-8859-2\n+icelandic       is_IS.ISO-8859-1\n+italian         it_IT.ISO-8859-1\n+japanese\tja_JP.eucJP\n+japanese.euc\tja_JP.eucJP\n+ja_JP\t\tja_JP.eucJP\n+ja_JP.ujis\tja_JP.eucJP\n+japanese.sjis\tja_JP.SJIS\n+korean\t\tko_KR.eucKR\n+korean.euc \tko_KR.eucKR\n+ko_KR\t\tko_KR.eucKR\n+lithuanian      lt_LT.ISO-8859-13\n+nb_NO\t\tno_NO.ISO-8859-1\n+nb_NO.ISO-8859-1 no_NO.ISO-8859-1\n+norwegian       no_NO.ISO-8859-1\n+nynorsk\t\tnn_NO.ISO-8859-1\n+polish          pl_PL.ISO-8859-2\n+portuguese      pt_PT.ISO-8859-1\n+romanian        ro_RO.ISO-8859-2\n+russian         ru_RU.ISO-8859-5\n+slovak          sk_SK.ISO-8859-2\n+slovene         sl_SI.ISO-8859-2\n+slovenian       sl_SI.ISO-8859-2\n+spanish         es_ES.ISO-8859-1\n+swedish         sv_SE.ISO-8859-1\n+thai\t\tth_TH.TIS-620\n+turkish         tr_TR.ISO-8859-9"}, {"sha": "a1679bff4f7eb62660924610024ead9d89dd5a9a", "filename": "gcc/intl/localealias.c", "status": "modified", "additions": 80, "deletions": 96, "changes": 176, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Flocalealias.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Flocalealias.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fintl%2Flocalealias.c?ref=71a94577632a238bf4e112f0f016819ead09f1d5", "patch": "@@ -1,29 +1,32 @@\n /* Handle aliases for locale names.\n-   Copyright (C) 1995, 1996, 1997, 1998 Free Software Foundation, Inc.\n-   Written by Ulrich Drepper <drepper@gnu.ai.mit.edu>, 1995.\n+   Copyright (C) 1995-1999, 2000, 2001 Free Software Foundation, Inc.\n \n-   This program is free software; you can redistribute it and/or modify\n-   it under the terms of the GNU General Public License as published by\n-   the Free Software Foundation; either version 2, or (at your option)\n+   This program is free software; you can redistribute it and/or modify it\n+   under the terms of the GNU Library General Public License as published\n+   by the Free Software Foundation; either version 2, or (at your option)\n    any later version.\n \n    This program is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n-   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n-   GNU General Public License for more details.\n-\n-   You should have received a copy of the GNU General Public License\n-   along with this program; if not, write to the Free Software Foundation,\n-   Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.  */\n+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+   Library General Public License for more details.\n+\n+   You should have received a copy of the GNU Library General Public\n+   License along with this program; if not, write to the Free Software\n+   Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307,\n+   USA.  */\n+\n+/* Tell glibc's <string.h> to provide a prototype for mempcpy().\n+   This must come before <config.h> because <config.h> may include\n+   <features.h>, and once <features.h> has been included, it's too late.  */\n+#ifndef _GNU_SOURCE\n+# define _GNU_SOURCE    1\n+#endif\n \n #ifdef HAVE_CONFIG_H\n # include <config.h>\n #endif\n \n-# ifndef _GNU_SOURCE\n-#  define _GNU_SOURCE\t1\n-# endif\n-\n #include <ctype.h>\n #include <stdio.h>\n #include <sys/types.h>\n@@ -45,32 +48,15 @@ char *alloca ();\n # endif\n #endif\n \n-#if defined STDC_HEADERS || defined _LIBC\n-# include <stdlib.h>\n-#else\n-char *getenv ();\n-# ifdef HAVE_MALLOC_H\n-#  include <malloc.h>\n-# else\n-void free ();\n-# endif\n-#endif\n+#include <stdlib.h>\n \n-#if defined HAVE_STRING_H || defined _LIBC\n-# include <string.h>\n-#else\n-# include <strings.h>\n-# ifndef memcpy\n-#  define memcpy(Dst, Src, Num) bcopy (Src, Dst, Num)\n-# endif\n-#endif\n+#include <string.h>\n #if !HAVE_STRCHR && !defined _LIBC\n # ifndef strchr\n #  define strchr index\n # endif\n #endif\n \n-#include \"gettext.h\"\n #include \"gettextP.h\"\n \n /* @@ end of prolog @@ */\n@@ -81,7 +67,9 @@ void free ();\n    file and the name space must not be polluted.  */\n # define strcasecmp __strcasecmp\n \n-# define mempcpy __mempcpy\n+# ifndef mempcpy\n+#  define mempcpy __mempcpy\n+# endif\n # define HAVE_MEMPCPY\t1\n \n /* We need locking here since we can be called from different places.  */\n@@ -90,41 +78,27 @@ void free ();\n __libc_lock_define_initialized (static, lock);\n #endif\n \n+#ifndef internal_function\n+# define internal_function\n+#endif\n \n-/* For those loosing systems which don't have `alloca' we have to add\n+/* For those losing systems which don't have `alloca' we have to add\n    some additional code emulating it.  */\n #ifdef HAVE_ALLOCA\n-/* Nothing has to be done.  */\n-# define ADD_BLOCK(list, address) /* nothing */\n-# define FREE_BLOCKS(list) /* nothing */\n+# define freea(p) /* nothing */\n #else\n-struct block_list\n-{\n-  void *address;\n-  struct block_list *next;\n-};\n-# define ADD_BLOCK(list, addr)\t\t\t\t\t\t      \\\n-  do {\t\t\t\t\t\t\t\t\t      \\\n-    struct block_list *newp = (struct block_list *) malloc (sizeof (*newp));  \\\n-    /* If we cannot get a free block we cannot add the new element to\t      \\\n-       the list.  */\t\t\t\t\t\t\t      \\\n-    if (newp != NULL) {\t\t\t\t\t\t\t      \\\n-      newp->address = (addr);\t\t\t\t\t\t      \\\n-      newp->next = (list);\t\t\t\t\t\t      \\\n-      (list) = newp;\t\t\t\t\t\t\t      \\\n-    }\t\t\t\t\t\t\t\t\t      \\\n-  } while (0)\n-# define FREE_BLOCKS(list)\t\t\t\t\t\t      \\\n-  do {\t\t\t\t\t\t\t\t\t      \\\n-    while (list != NULL) {\t\t\t\t\t\t      \\\n-      struct block_list *old = list;\t\t\t\t\t      \\\n-      list = list->next;\t\t\t\t\t\t      \\\n-      free (old);\t\t\t\t\t\t\t      \\\n-    }\t\t\t\t\t\t\t\t\t      \\\n-  } while (0)\n-# undef alloca\n-# define alloca(size) (malloc (size))\n-#endif\t/* have alloca */\n+# define alloca(n) malloc (n)\n+# define freea(p) free (p)\n+#endif\n+\n+#if defined _LIBC_REENTRANT || defined HAVE_FGETS_UNLOCKED\n+# undef fgets\n+# define fgets(buf, len, s) fgets_unlocked (buf, len, s)\n+#endif\n+#if defined _LIBC_REENTRANT || defined HAVE_FEOF_UNLOCKED\n+# undef feof\n+# define feof(s) feof_unlocked (s)\n+#endif\n \n \n struct alias_map\n@@ -134,18 +108,18 @@ struct alias_map\n };\n \n \n-static char *string_space = NULL;\n-static size_t string_space_act = 0;\n-static size_t string_space_max = 0;\n+static char *string_space;\n+static size_t string_space_act;\n+static size_t string_space_max;\n static struct alias_map *map;\n-static size_t nmap = 0;\n-static size_t maxmap = 0;\n+static size_t nmap;\n+static size_t maxmap;\n \n \n /* Prototypes for local functions.  */\n static size_t read_alias_file PARAMS ((const char *fname, int fname_len))\n      internal_function;\n-static void extend_alias_table PARAMS ((void));\n+static int extend_alias_table PARAMS ((void));\n static int alias_compare PARAMS ((const struct alias_map *map1,\n \t\t\t\t  const struct alias_map *map2));\n \n@@ -191,11 +165,12 @@ _nl_expand_alias (name)\n \t{\n \t  const char *start;\n \n-\t  while (locale_alias_path[0] == ':')\n+\t  while (locale_alias_path[0] == PATH_SEPARATOR)\n \t    ++locale_alias_path;\n \t  start = locale_alias_path;\n \n-\t  while (locale_alias_path[0] != '\\0' && locale_alias_path[0] != ':')\n+\t  while (locale_alias_path[0] != '\\0'\n+\t\t && locale_alias_path[0] != PATH_SEPARATOR)\n \t    ++locale_alias_path;\n \n \t  if (start < locale_alias_path)\n@@ -218,25 +193,24 @@ read_alias_file (fname, fname_len)\n      const char *fname;\n      int fname_len;\n {\n-#ifndef HAVE_ALLOCA\n-  struct block_list *block_list = NULL;\n-#endif\n   FILE *fp;\n   char *full_fname;\n   size_t added;\n   static const char aliasfile[] = \"/locale.alias\";\n \n   full_fname = (char *) alloca (fname_len + sizeof aliasfile);\n-  ADD_BLOCK (block_list, full_fname);\n+#ifdef HAVE_MEMPCPY\n+  mempcpy (mempcpy (full_fname, fname, fname_len),\n+\t   aliasfile, sizeof aliasfile);\n+#else\n   memcpy (full_fname, fname, fname_len);\n   memcpy (&full_fname[fname_len], aliasfile, sizeof aliasfile);\n+#endif\n \n   fp = fopen (full_fname, \"r\");\n+  freea (full_fname);\n   if (fp == NULL)\n-    {\n-      FREE_BLOCKS (block_list);\n-      return 0;\n-    }\n+    return 0;\n \n   added = 0;\n   while (!feof (fp))\n@@ -246,18 +220,18 @@ read_alias_file (fname, fname_len)\n \t b) these fields must be usable as file names and so must not\n \t    be that long\n        */\n-      unsigned char buf[BUFSIZ];\n-      unsigned char *alias;\n-      unsigned char *value;\n-      unsigned char *cp;\n+      char buf[BUFSIZ];\n+      char *alias;\n+      char *value;\n+      char *cp;\n \n-      if (fgets ((char *)buf, sizeof buf, fp) == NULL)\n+      if (fgets (buf, sizeof buf, fp) == NULL)\n \t/* EOF reached.  */\n \tbreak;\n \n       /* Possibly not the whole line fits into the buffer.  Ignore\n \t the rest of the line.  */\n-      if (strchr ((char *)buf, '\\n') == NULL)\n+      if (strchr (buf, '\\n') == NULL)\n \t{\n \t  char altbuf[BUFSIZ];\n \t  do\n@@ -308,10 +282,11 @@ read_alias_file (fname, fname_len)\n \t\t*cp++ = '\\0';\n \n \t      if (nmap >= maxmap)\n-\t\textend_alias_table ();\n+\t\tif (__builtin_expect (extend_alias_table (), 0))\n+\t\t  return added;\n \n-\t      alias_len = strlen ((char *)alias) + 1;\n-\t      value_len = strlen ((char *)value) + 1;\n+\t      alias_len = strlen (alias) + 1;\n+\t      value_len = strlen (value) + 1;\n \n \t      if (string_space_act + alias_len + value_len > string_space_max)\n \t\t{\n@@ -321,10 +296,19 @@ read_alias_file (fname, fname_len)\n \t\t\t\t\t? alias_len + value_len : 1024));\n \t\t  char *new_pool = (char *) realloc (string_space, new_size);\n \t\t  if (new_pool == NULL)\n+\t\t    return added;\n+\n+\t\t  if (__builtin_expect (string_space != new_pool, 0))\n \t\t    {\n-\t\t      FREE_BLOCKS (block_list);\n-\t\t      return added;\n+\t\t      size_t i;\n+\n+\t\t      for (i = 0; i < nmap; i++)\n+\t\t\t{\n+\t\t\t  map[i].alias += new_pool - string_space;\n+\t\t\t  map[i].value += new_pool - string_space;\n+\t\t\t}\n \t\t    }\n+\n \t\t  string_space = new_pool;\n \t\t  string_space_max = new_size;\n \t\t}\n@@ -351,12 +335,11 @@ read_alias_file (fname, fname_len)\n     qsort (map, nmap, sizeof (struct alias_map),\n \t   (int (*) PARAMS ((const void *, const void *))) alias_compare);\n \n-  FREE_BLOCKS (block_list);\n   return added;\n }\n \n \n-static void\n+static int\n extend_alias_table ()\n {\n   size_t new_size;\n@@ -367,10 +350,11 @@ extend_alias_table ()\n \t\t\t\t\t\t* sizeof (struct alias_map)));\n   if (new_map == NULL)\n     /* Simply don't extend: we don't have any more core.  */\n-    return;\n+    return -1;\n \n   map = new_map;\n   maxmap = new_size;\n+  return 0;\n }\n \n "}, {"sha": "fb3ec5a91ea076ca0fa3bbd17eead61739be37ce", "filename": "gcc/intl/ngettext.c", "status": "added", "additions": 68, "deletions": 0, "changes": 68, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Fngettext.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Fngettext.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fintl%2Fngettext.c?ref=71a94577632a238bf4e112f0f016819ead09f1d5", "patch": "@@ -0,0 +1,68 @@\n+/* Implementation of ngettext(3) function.\n+   Copyright (C) 1995, 1997, 2000, 2001 Free Software Foundation, Inc.\n+\n+   This program is free software; you can redistribute it and/or modify it\n+   under the terms of the GNU Library General Public License as published\n+   by the Free Software Foundation; either version 2, or (at your option)\n+   any later version.\n+\n+   This program is distributed in the hope that it will be useful,\n+   but WITHOUT ANY WARRANTY; without even the implied warranty of\n+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+   Library General Public License for more details.\n+\n+   You should have received a copy of the GNU Library General Public\n+   License along with this program; if not, write to the Free Software\n+   Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307,\n+   USA.  */\n+\n+#ifdef HAVE_CONFIG_H\n+# include <config.h>\n+#endif\n+\n+#ifdef _LIBC\n+# define __need_NULL\n+# include <stddef.h>\n+#else\n+# include <stdlib.h>\t\t/* Just for NULL.  */\n+#endif\n+\n+#include \"gettextP.h\"\n+#ifdef _LIBC\n+# include <libintl.h>\n+#else\n+# include \"libgnuintl.h\"\n+#endif\n+\n+#include <locale.h>\n+\n+/* @@ end of prolog @@ */\n+\n+/* Names for the libintl functions are a problem.  They must not clash\n+   with existing names and they should follow ANSI C.  But this source\n+   code is also used in GNU C Library where the names have a __\n+   prefix.  So we have to make a difference here.  */\n+#ifdef _LIBC\n+# define NGETTEXT __ngettext\n+# define DCNGETTEXT __dcngettext\n+#else\n+# define NGETTEXT ngettext__\n+# define DCNGETTEXT dcngettext__\n+#endif\n+\n+/* Look up MSGID in the current default message catalog for the current\n+   LC_MESSAGES locale.  If not found, returns MSGID itself (the default\n+   text).  */\n+char *\n+NGETTEXT (msgid1, msgid2, n)\n+     const char *msgid1;\n+     const char *msgid2;\n+     unsigned long int n;\n+{\n+  return DCNGETTEXT (NULL, msgid1, msgid2, n, LC_MESSAGES);\n+}\n+\n+#ifdef _LIBC\n+/* Alias for function name in GNU C Library.  */\n+weak_alias (__ngettext, ngettext);\n+#endif"}, {"sha": "640d43cc56176190ce583ce96149e852074055d7", "filename": "gcc/intl/plural.c", "status": "added", "additions": 1326, "deletions": 0, "changes": 1326, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Fplural.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Fplural.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fintl%2Fplural.c?ref=71a94577632a238bf4e112f0f016819ead09f1d5", "patch": "@@ -0,0 +1,1326 @@\n+\n+/*  A Bison parser, made from plural.y\n+    by GNU Bison version 1.28  */\n+\n+#define YYBISON 1  /* Identify Bison output.  */\n+\n+#define yyparse __gettextparse\n+#define yylex __gettextlex\n+#define yyerror __gettexterror\n+#define yylval __gettextlval\n+#define yychar __gettextchar\n+#define yydebug __gettextdebug\n+#define yynerrs __gettextnerrs\n+#define\tEQUOP2\t257\n+#define\tCMPOP2\t258\n+#define\tADDOP2\t259\n+#define\tMULOP2\t260\n+#define\tNUMBER\t261\n+\n+#line 1 \"plural.y\"\n+\n+/* Expression parsing for plural form selection.\n+   Copyright (C) 2000, 2001 Free Software Foundation, Inc.\n+   Written by Ulrich Drepper <drepper@cygnus.com>, 2000.\n+\n+   This program is free software; you can redistribute it and/or modify it\n+   under the terms of the GNU Library General Public License as published\n+   by the Free Software Foundation; either version 2, or (at your option)\n+   any later version.\n+\n+   This program is distributed in the hope that it will be useful,\n+   but WITHOUT ANY WARRANTY; without even the implied warranty of\n+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+   Library General Public License for more details.\n+\n+   You should have received a copy of the GNU Library General Public\n+   License along with this program; if not, write to the Free Software\n+   Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307,\n+   USA.  */\n+\n+/* The bison generated parser uses alloca.  AIX 3 forces us to put this\n+   declaration at the beginning of the file.  The declaration in bison's\n+   skeleton file comes too late.  This must come before <config.h>\n+   because <config.h> may include arbitrary system headers.  */\n+#if defined _AIX && !defined __GNUC__\n+ #pragma alloca\n+#endif\n+\n+#ifdef HAVE_CONFIG_H\n+# include <config.h>\n+#endif\n+\n+#include <stdlib.h>\n+#include \"gettextP.h\"\n+\n+/* Names for the libintl functions are a problem.  They must not clash\n+   with existing names and they should follow ANSI C.  But this source\n+   code is also used in GNU C Library where the names have a __\n+   prefix.  So we have to make a difference here.  */\n+#ifdef _LIBC\n+# define FREE_EXPRESSION __gettext_free_exp\n+#else\n+# define FREE_EXPRESSION gettext_free_exp__\n+# define __gettextparse gettextparse__\n+#endif\n+\n+#define YYLEX_PARAM\t&((struct parse_args *) arg)->cp\n+#define YYPARSE_PARAM\targ\n+\n+#line 53 \"plural.y\"\n+typedef union {\n+  unsigned long int num;\n+  enum operator op;\n+  struct expression *exp;\n+} YYSTYPE;\n+#line 59 \"plural.y\"\n+\n+/* Prototypes for local functions.  */\n+static struct expression *new_exp PARAMS ((int nargs, enum operator op,\n+\t\t\t\t\t   struct expression * const *args));\n+static inline struct expression *new_exp_0 PARAMS ((enum operator op));\n+static inline struct expression *new_exp_1 PARAMS ((enum operator op,\n+\t\t\t\t\t\t   struct expression *right));\n+static struct expression *new_exp_2 PARAMS ((enum operator op,\n+\t\t\t\t\t     struct expression *left,\n+\t\t\t\t\t     struct expression *right));\n+static inline struct expression *new_exp_3 PARAMS ((enum operator op,\n+\t\t\t\t\t\t   struct expression *bexp,\n+\t\t\t\t\t\t   struct expression *tbranch,\n+\t\t\t\t\t\t   struct expression *fbranch));\n+static int yylex PARAMS ((YYSTYPE *lval, const char **pexp));\n+static void yyerror PARAMS ((const char *str));\n+\n+/* Allocation of expressions.  */\n+\n+static struct expression *\n+new_exp (nargs, op, args)\n+     int nargs;\n+     enum operator op;\n+     struct expression * const *args;\n+{\n+  int i;\n+  struct expression *newp;\n+\n+  /* If any of the argument could not be malloc'ed, just return NULL.  */\n+  for (i = nargs - 1; i >= 0; i--)\n+    if (args[i] == NULL)\n+      goto fail;\n+\n+  /* Allocate a new expression.  */\n+  newp = (struct expression *) malloc (sizeof (*newp));\n+  if (newp != NULL)\n+    {\n+      newp->nargs = nargs;\n+      newp->operation = op;\n+      for (i = nargs - 1; i >= 0; i--)\n+\tnewp->val.args[i] = args[i];\n+      return newp;\n+    }\n+\n+ fail:\n+  for (i = nargs - 1; i >= 0; i--)\n+    FREE_EXPRESSION (args[i]);\n+\n+  return NULL;\n+}\n+\n+static inline struct expression *\n+new_exp_0 (op)\n+     enum operator op;\n+{\n+  return new_exp (0, op, NULL);\n+}\n+\n+static inline struct expression *\n+new_exp_1 (op, right)\n+     enum operator op;\n+     struct expression *right;\n+{\n+  struct expression *args[1];\n+\n+  args[0] = right;\n+  return new_exp (1, op, args);\n+}\n+\n+static struct expression *\n+new_exp_2 (op, left, right)\n+     enum operator op;\n+     struct expression *left;\n+     struct expression *right;\n+{\n+  struct expression *args[2];\n+\n+  args[0] = left;\n+  args[1] = right;\n+  return new_exp (2, op, args);\n+}\n+\n+static inline struct expression *\n+new_exp_3 (op, bexp, tbranch, fbranch)\n+     enum operator op;\n+     struct expression *bexp;\n+     struct expression *tbranch;\n+     struct expression *fbranch;\n+{\n+  struct expression *args[3];\n+\n+  args[0] = bexp;\n+  args[1] = tbranch;\n+  args[2] = fbranch;\n+  return new_exp (3, op, args);\n+}\n+\n+#include <stdio.h>\n+\n+#ifndef __cplusplus\n+#ifndef __STDC__\n+#define const\n+#endif\n+#endif\n+\n+\n+\n+#define\tYYFINAL\t\t27\n+#define\tYYFLAG\t\t-32768\n+#define\tYYNTBASE\t16\n+\n+#define YYTRANSLATE(x) ((unsigned)(x) <= 261 ? yytranslate[x] : 18)\n+\n+static const char yytranslate[] = {     0,\n+     2,     2,     2,     2,     2,     2,     2,     2,     2,     2,\n+     2,     2,     2,     2,     2,     2,     2,     2,     2,     2,\n+     2,     2,     2,     2,     2,     2,     2,     2,     2,     2,\n+     2,     2,    10,     2,     2,     2,     2,     5,     2,    14,\n+    15,     2,     2,     2,     2,     2,     2,     2,     2,     2,\n+     2,     2,     2,     2,     2,     2,     2,    12,     2,     2,\n+     2,     2,     3,     2,     2,     2,     2,     2,     2,     2,\n+     2,     2,     2,     2,     2,     2,     2,     2,     2,     2,\n+     2,     2,     2,     2,     2,     2,     2,     2,     2,     2,\n+     2,     2,     2,     2,     2,     2,     2,     2,     2,     2,\n+     2,     2,     2,     2,     2,     2,     2,     2,     2,    13,\n+     2,     2,     2,     2,     2,     2,     2,     2,     2,     2,\n+     2,     2,     2,     4,     2,     2,     2,     2,     2,     2,\n+     2,     2,     2,     2,     2,     2,     2,     2,     2,     2,\n+     2,     2,     2,     2,     2,     2,     2,     2,     2,     2,\n+     2,     2,     2,     2,     2,     2,     2,     2,     2,     2,\n+     2,     2,     2,     2,     2,     2,     2,     2,     2,     2,\n+     2,     2,     2,     2,     2,     2,     2,     2,     2,     2,\n+     2,     2,     2,     2,     2,     2,     2,     2,     2,     2,\n+     2,     2,     2,     2,     2,     2,     2,     2,     2,     2,\n+     2,     2,     2,     2,     2,     2,     2,     2,     2,     2,\n+     2,     2,     2,     2,     2,     2,     2,     2,     2,     2,\n+     2,     2,     2,     2,     2,     2,     2,     2,     2,     2,\n+     2,     2,     2,     2,     2,     2,     2,     2,     2,     2,\n+     2,     2,     2,     2,     2,     2,     2,     2,     2,     2,\n+     2,     2,     2,     2,     2,     1,     6,     7,     8,     9,\n+    11\n+};\n+\n+#if YYDEBUG != 0\n+static const short yyprhs[] = {     0,\n+     0,     2,     8,    12,    16,    20,    24,    28,    32,    35,\n+    37,    39\n+};\n+\n+static const short yyrhs[] = {    17,\n+     0,    17,     3,    17,    12,    17,     0,    17,     4,    17,\n+     0,    17,     5,    17,     0,    17,     6,    17,     0,    17,\n+     7,    17,     0,    17,     8,    17,     0,    17,     9,    17,\n+     0,    10,    17,     0,    13,     0,    11,     0,    14,    17,\n+    15,     0\n+};\n+\n+#endif\n+\n+#if YYDEBUG != 0\n+static const short yyrline[] = { 0,\n+   178,   186,   190,   194,   198,   202,   206,   210,   214,   218,\n+   222,   227\n+};\n+#endif\n+\n+\n+#if YYDEBUG != 0 || defined (YYERROR_VERBOSE)\n+\n+static const char * const yytname[] = {   \"$\",\"error\",\"$undefined.\",\"'?'\",\"'|'\",\n+\"'&'\",\"EQUOP2\",\"CMPOP2\",\"ADDOP2\",\"MULOP2\",\"'!'\",\"NUMBER\",\"':'\",\"'n'\",\"'('\",\"')'\",\n+\"start\",\"exp\", NULL\n+};\n+#endif\n+\n+static const short yyr1[] = {     0,\n+    16,    17,    17,    17,    17,    17,    17,    17,    17,    17,\n+    17,    17\n+};\n+\n+static const short yyr2[] = {     0,\n+     1,     5,     3,     3,     3,     3,     3,     3,     2,     1,\n+     1,     3\n+};\n+\n+static const short yydefact[] = {     0,\n+     0,    11,    10,     0,     1,     9,     0,     0,     0,     0,\n+     0,     0,     0,     0,    12,     0,     3,     4,     5,     6,\n+     7,     8,     0,     2,     0,     0,     0\n+};\n+\n+static const short yydefgoto[] = {    25,\n+     5\n+};\n+\n+static const short yypact[] = {    -9,\n+    -9,-32768,-32768,    -9,    34,-32768,    11,    -9,    -9,    -9,\n+    -9,    -9,    -9,    -9,-32768,    24,    39,    43,    16,    26,\n+    -3,-32768,    -9,    34,    21,    53,-32768\n+};\n+\n+static const short yypgoto[] = {-32768,\n+    -1\n+};\n+\n+\n+#define\tYYLAST\t\t53\n+\n+\n+static const short yytable[] = {     6,\n+     1,     2,     7,     3,     4,    14,    16,    17,    18,    19,\n+    20,    21,    22,     8,     9,    10,    11,    12,    13,    14,\n+    26,    24,    12,    13,    14,    15,     8,     9,    10,    11,\n+    12,    13,    14,    13,    14,    23,     8,     9,    10,    11,\n+    12,    13,    14,    10,    11,    12,    13,    14,    11,    12,\n+    13,    14,    27\n+};\n+\n+static const short yycheck[] = {     1,\n+    10,    11,     4,    13,    14,     9,     8,     9,    10,    11,\n+    12,    13,    14,     3,     4,     5,     6,     7,     8,     9,\n+     0,    23,     7,     8,     9,    15,     3,     4,     5,     6,\n+     7,     8,     9,     8,     9,    12,     3,     4,     5,     6,\n+     7,     8,     9,     5,     6,     7,     8,     9,     6,     7,\n+     8,     9,     0\n+};\n+#define YYPURE 1\n+\n+/* -*-C-*-  Note some compilers choke on comments on `#line' lines.  */\n+#line 3 \"/home/haible/gnu/arch/linuxlibc6/share/bison.simple\"\n+/* This file comes from bison-1.28.  */\n+\n+/* Skeleton output parser for bison,\n+   Copyright (C) 1984, 1989, 1990 Free Software Foundation, Inc.\n+\n+   This program is free software; you can redistribute it and/or modify\n+   it under the terms of the GNU General Public License as published by\n+   the Free Software Foundation; either version 2, or (at your option)\n+   any later version.\n+\n+   This program is distributed in the hope that it will be useful,\n+   but WITHOUT ANY WARRANTY; without even the implied warranty of\n+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+   GNU General Public License for more details.\n+\n+   You should have received a copy of the GNU General Public License\n+   along with this program; if not, write to the Free Software\n+   Foundation, Inc., 59 Temple Place - Suite 330,\n+   Boston, MA 02111-1307, USA.  */\n+\n+/* As a special exception, when this file is copied by Bison into a\n+   Bison output file, you may use that output file without restriction.\n+   This special exception was added by the Free Software Foundation\n+   in version 1.24 of Bison.  */\n+\n+/* This is the parser code that is written into each bison parser\n+  when the %semantic_parser declaration is not specified in the grammar.\n+  It was written by Richard Stallman by simplifying the hairy parser\n+  used when %semantic_parser is specified.  */\n+\n+#ifndef YYSTACK_USE_ALLOCA\n+#ifdef alloca\n+#define YYSTACK_USE_ALLOCA\n+#else /* alloca not defined */\n+#ifdef __GNUC__\n+#define YYSTACK_USE_ALLOCA\n+#define alloca __builtin_alloca\n+#else /* not GNU C.  */\n+#if (!defined (__STDC__) && defined (sparc)) || defined (__sparc__) || defined (__sparc) || defined (__sgi) || (defined (__sun) && defined (__i386))\n+#define YYSTACK_USE_ALLOCA\n+#include <alloca.h>\n+#else /* not sparc */\n+/* We think this test detects Watcom and Microsoft C.  */\n+/* This used to test MSDOS, but that is a bad idea\n+   since that symbol is in the user namespace.  */\n+#if (defined (_MSDOS) || defined (_MSDOS_)) && !defined (__TURBOC__)\n+#if 0 /* No need for malloc.h, which pollutes the namespace;\n+\t instead, just don't use alloca.  */\n+#include <malloc.h>\n+#endif\n+#else /* not MSDOS, or __TURBOC__ */\n+#if defined(_AIX)\n+/* I don't know what this was needed for, but it pollutes the namespace.\n+   So I turned it off.   rms, 2 May 1997.  */\n+/* #include <malloc.h>  */\n+ #pragma alloca\n+#define YYSTACK_USE_ALLOCA\n+#else /* not MSDOS, or __TURBOC__, or _AIX */\n+#if 0\n+#ifdef __hpux /* haible@ilog.fr says this works for HPUX 9.05 and up,\n+\t\t and on HPUX 10.  Eventually we can turn this on.  */\n+#define YYSTACK_USE_ALLOCA\n+#define alloca __builtin_alloca\n+#endif /* __hpux */\n+#endif\n+#endif /* not _AIX */\n+#endif /* not MSDOS, or __TURBOC__ */\n+#endif /* not sparc */\n+#endif /* not GNU C */\n+#endif /* alloca not defined */\n+#endif /* YYSTACK_USE_ALLOCA not defined */\n+\n+#ifdef YYSTACK_USE_ALLOCA\n+#define YYSTACK_ALLOC alloca\n+#else\n+#define YYSTACK_ALLOC malloc\n+#endif\n+\n+/* Note: there must be only one dollar sign in this file.\n+   It is replaced by the list of actions, each action\n+   as one case of the switch.  */\n+\n+#define yyerrok\t\t(yyerrstatus = 0)\n+#define yyclearin\t(yychar = YYEMPTY)\n+#define YYEMPTY\t\t-2\n+#define YYEOF\t\t0\n+#define YYACCEPT\tgoto yyacceptlab\n+#define YYABORT \tgoto yyabortlab\n+#define YYERROR\t\tgoto yyerrlab1\n+/* Like YYERROR except do call yyerror.\n+   This remains here temporarily to ease the\n+   transition to the new meaning of YYERROR, for GCC.\n+   Once GCC version 2 has supplanted version 1, this can go.  */\n+#define YYFAIL\t\tgoto yyerrlab\n+#define YYRECOVERING()  (!!yyerrstatus)\n+#define YYBACKUP(token, value) \\\n+do\t\t\t\t\t\t\t\t\\\n+  if (yychar == YYEMPTY && yylen == 1)\t\t\t\t\\\n+    { yychar = (token), yylval = (value);\t\t\t\\\n+      yychar1 = YYTRANSLATE (yychar);\t\t\t\t\\\n+      YYPOPSTACK;\t\t\t\t\t\t\\\n+      goto yybackup;\t\t\t\t\t\t\\\n+    }\t\t\t\t\t\t\t\t\\\n+  else\t\t\t\t\t\t\t\t\\\n+    { yyerror (\"syntax error: cannot back up\"); YYERROR; }\t\\\n+while (0)\n+\n+#define YYTERROR\t1\n+#define YYERRCODE\t256\n+\n+#ifndef YYPURE\n+#define YYLEX\t\tyylex()\n+#endif\n+\n+#ifdef YYPURE\n+#ifdef YYLSP_NEEDED\n+#ifdef YYLEX_PARAM\n+#define YYLEX\t\tyylex(&yylval, &yylloc, YYLEX_PARAM)\n+#else\n+#define YYLEX\t\tyylex(&yylval, &yylloc)\n+#endif\n+#else /* not YYLSP_NEEDED */\n+#ifdef YYLEX_PARAM\n+#define YYLEX\t\tyylex(&yylval, YYLEX_PARAM)\n+#else\n+#define YYLEX\t\tyylex(&yylval)\n+#endif\n+#endif /* not YYLSP_NEEDED */\n+#endif\n+\n+/* If nonreentrant, generate the variables here */\n+\n+#ifndef YYPURE\n+\n+int\tyychar;\t\t\t/*  the lookahead symbol\t\t*/\n+YYSTYPE\tyylval;\t\t\t/*  the semantic value of the\t\t*/\n+\t\t\t\t/*  lookahead symbol\t\t\t*/\n+\n+#ifdef YYLSP_NEEDED\n+YYLTYPE yylloc;\t\t\t/*  location data for the lookahead\t*/\n+\t\t\t\t/*  symbol\t\t\t\t*/\n+#endif\n+\n+int yynerrs;\t\t\t/*  number of parse errors so far       */\n+#endif  /* not YYPURE */\n+\n+#if YYDEBUG != 0\n+int yydebug;\t\t\t/*  nonzero means print parse trace\t*/\n+/* Since this is uninitialized, it does not stop multiple parsers\n+   from coexisting.  */\n+#endif\n+\n+/*  YYINITDEPTH indicates the initial size of the parser's stacks\t*/\n+\n+#ifndef\tYYINITDEPTH\n+#define YYINITDEPTH 200\n+#endif\n+\n+/*  YYMAXDEPTH is the maximum size the stacks can grow to\n+    (effective only if the built-in stack extension method is used).  */\n+\n+#if YYMAXDEPTH == 0\n+#undef YYMAXDEPTH\n+#endif\n+\n+#ifndef YYMAXDEPTH\n+#define YYMAXDEPTH 10000\n+#endif\n+\f\n+/* Define __yy_memcpy.  Note that the size argument\n+   should be passed with type unsigned int, because that is what the non-GCC\n+   definitions require.  With GCC, __builtin_memcpy takes an arg\n+   of type size_t, but it can handle unsigned int.  */\n+\n+#if __GNUC__ > 1\t\t/* GNU C and GNU C++ define this.  */\n+#define __yy_memcpy(TO,FROM,COUNT)\t__builtin_memcpy(TO,FROM,COUNT)\n+#else\t\t\t\t/* not GNU C or C++ */\n+#ifndef __cplusplus\n+\n+/* This is the most reliable way to avoid incompatibilities\n+   in available built-in functions on various systems.  */\n+static void\n+__yy_memcpy (to, from, count)\n+     char *to;\n+     char *from;\n+     unsigned int count;\n+{\n+  register char *f = from;\n+  register char *t = to;\n+  register int i = count;\n+\n+  while (i-- > 0)\n+    *t++ = *f++;\n+}\n+\n+#else /* __cplusplus */\n+\n+/* This is the most reliable way to avoid incompatibilities\n+   in available built-in functions on various systems.  */\n+static void\n+__yy_memcpy (char *to, char *from, unsigned int count)\n+{\n+  register char *t = to;\n+  register char *f = from;\n+  register int i = count;\n+\n+  while (i-- > 0)\n+    *t++ = *f++;\n+}\n+\n+#endif\n+#endif\n+\f\n+#line 217 \"/home/haible/gnu/arch/linuxlibc6/share/bison.simple\"\n+\n+/* The user can define YYPARSE_PARAM as the name of an argument to be passed\n+   into yyparse.  The argument should have type void *.\n+   It should actually point to an object.\n+   Grammar actions can access the variable by casting it\n+   to the proper pointer type.  */\n+\n+#ifdef YYPARSE_PARAM\n+#ifdef __cplusplus\n+#define YYPARSE_PARAM_ARG void *YYPARSE_PARAM\n+#define YYPARSE_PARAM_DECL\n+#else /* not __cplusplus */\n+#define YYPARSE_PARAM_ARG YYPARSE_PARAM\n+#define YYPARSE_PARAM_DECL void *YYPARSE_PARAM;\n+#endif /* not __cplusplus */\n+#else /* not YYPARSE_PARAM */\n+#define YYPARSE_PARAM_ARG\n+#define YYPARSE_PARAM_DECL\n+#endif /* not YYPARSE_PARAM */\n+\n+/* Prevent warning if -Wstrict-prototypes.  */\n+#ifdef __GNUC__\n+#ifdef YYPARSE_PARAM\n+int yyparse (void *);\n+#else\n+int yyparse (void);\n+#endif\n+#endif\n+\n+int\n+yyparse(YYPARSE_PARAM_ARG)\n+     YYPARSE_PARAM_DECL\n+{\n+  register int yystate;\n+  register int yyn;\n+  register short *yyssp;\n+  register YYSTYPE *yyvsp;\n+  int yyerrstatus;\t/*  number of tokens to shift before error messages enabled */\n+  int yychar1 = 0;\t\t/*  lookahead token as an internal (translated) token number */\n+\n+  short\tyyssa[YYINITDEPTH];\t/*  the state stack\t\t\t*/\n+  YYSTYPE yyvsa[YYINITDEPTH];\t/*  the semantic value stack\t\t*/\n+\n+  short *yyss = yyssa;\t\t/*  refer to the stacks thru separate pointers */\n+  YYSTYPE *yyvs = yyvsa;\t/*  to allow yyoverflow to reallocate them elsewhere */\n+\n+#ifdef YYLSP_NEEDED\n+  YYLTYPE yylsa[YYINITDEPTH];\t/*  the location stack\t\t\t*/\n+  YYLTYPE *yyls = yylsa;\n+  YYLTYPE *yylsp;\n+\n+#define YYPOPSTACK   (yyvsp--, yyssp--, yylsp--)\n+#else\n+#define YYPOPSTACK   (yyvsp--, yyssp--)\n+#endif\n+\n+  int yystacksize = YYINITDEPTH;\n+  int yyfree_stacks = 0;\n+\n+#ifdef YYPURE\n+  int yychar;\n+  YYSTYPE yylval;\n+  int yynerrs;\n+#ifdef YYLSP_NEEDED\n+  YYLTYPE yylloc;\n+#endif\n+#endif\n+\n+  YYSTYPE yyval;\t\t/*  the variable used to return\t\t*/\n+\t\t\t\t/*  semantic values from the action\t*/\n+\t\t\t\t/*  routines\t\t\t\t*/\n+\n+  int yylen;\n+\n+#if YYDEBUG != 0\n+  if (yydebug)\n+    fprintf(stderr, \"Starting parse\\n\");\n+#endif\n+\n+  yystate = 0;\n+  yyerrstatus = 0;\n+  yynerrs = 0;\n+  yychar = YYEMPTY;\t\t/* Cause a token to be read.  */\n+\n+  /* Initialize stack pointers.\n+     Waste one element of value and location stack\n+     so that they stay on the same level as the state stack.\n+     The wasted elements are never initialized.  */\n+\n+  yyssp = yyss - 1;\n+  yyvsp = yyvs;\n+#ifdef YYLSP_NEEDED\n+  yylsp = yyls;\n+#endif\n+\n+/* Push a new state, which is found in  yystate  .  */\n+/* In all cases, when you get here, the value and location stacks\n+   have just been pushed. so pushing a state here evens the stacks.  */\n+yynewstate:\n+\n+  *++yyssp = yystate;\n+\n+  if (yyssp >= yyss + yystacksize - 1)\n+    {\n+      /* Give user a chance to reallocate the stack */\n+      /* Use copies of these so that the &'s don't force the real ones into memory. */\n+      YYSTYPE *yyvs1 = yyvs;\n+      short *yyss1 = yyss;\n+#ifdef YYLSP_NEEDED\n+      YYLTYPE *yyls1 = yyls;\n+#endif\n+\n+      /* Get the current used size of the three stacks, in elements.  */\n+      int size = yyssp - yyss + 1;\n+\n+#ifdef yyoverflow\n+      /* Each stack pointer address is followed by the size of\n+\t the data in use in that stack, in bytes.  */\n+#ifdef YYLSP_NEEDED\n+      /* This used to be a conditional around just the two extra args,\n+\t but that might be undefined if yyoverflow is a macro.  */\n+      yyoverflow(\"parser stack overflow\",\n+\t\t &yyss1, size * sizeof (*yyssp),\n+\t\t &yyvs1, size * sizeof (*yyvsp),\n+\t\t &yyls1, size * sizeof (*yylsp),\n+\t\t &yystacksize);\n+#else\n+      yyoverflow(\"parser stack overflow\",\n+\t\t &yyss1, size * sizeof (*yyssp),\n+\t\t &yyvs1, size * sizeof (*yyvsp),\n+\t\t &yystacksize);\n+#endif\n+\n+      yyss = yyss1; yyvs = yyvs1;\n+#ifdef YYLSP_NEEDED\n+      yyls = yyls1;\n+#endif\n+#else /* no yyoverflow */\n+      /* Extend the stack our own way.  */\n+      if (yystacksize >= YYMAXDEPTH)\n+\t{\n+\t  yyerror(\"parser stack overflow\");\n+\t  if (yyfree_stacks)\n+\t    {\n+\t      free (yyss);\n+\t      free (yyvs);\n+#ifdef YYLSP_NEEDED\n+\t      free (yyls);\n+#endif\n+\t    }\n+\t  return 2;\n+\t}\n+      yystacksize *= 2;\n+      if (yystacksize > YYMAXDEPTH)\n+\tyystacksize = YYMAXDEPTH;\n+#ifndef YYSTACK_USE_ALLOCA\n+      yyfree_stacks = 1;\n+#endif\n+      yyss = (short *) YYSTACK_ALLOC (yystacksize * sizeof (*yyssp));\n+      __yy_memcpy ((char *)yyss, (char *)yyss1,\n+\t\t   size * (unsigned int) sizeof (*yyssp));\n+      yyvs = (YYSTYPE *) YYSTACK_ALLOC (yystacksize * sizeof (*yyvsp));\n+      __yy_memcpy ((char *)yyvs, (char *)yyvs1,\n+\t\t   size * (unsigned int) sizeof (*yyvsp));\n+#ifdef YYLSP_NEEDED\n+      yyls = (YYLTYPE *) YYSTACK_ALLOC (yystacksize * sizeof (*yylsp));\n+      __yy_memcpy ((char *)yyls, (char *)yyls1,\n+\t\t   size * (unsigned int) sizeof (*yylsp));\n+#endif\n+#endif /* no yyoverflow */\n+\n+      yyssp = yyss + size - 1;\n+      yyvsp = yyvs + size - 1;\n+#ifdef YYLSP_NEEDED\n+      yylsp = yyls + size - 1;\n+#endif\n+\n+#if YYDEBUG != 0\n+      if (yydebug)\n+\tfprintf(stderr, \"Stack size increased to %d\\n\", yystacksize);\n+#endif\n+\n+      if (yyssp >= yyss + yystacksize - 1)\n+\tYYABORT;\n+    }\n+\n+#if YYDEBUG != 0\n+  if (yydebug)\n+    fprintf(stderr, \"Entering state %d\\n\", yystate);\n+#endif\n+\n+  goto yybackup;\n+ yybackup:\n+\n+/* Do appropriate processing given the current state.  */\n+/* Read a lookahead token if we need one and don't already have one.  */\n+/* yyresume: */\n+\n+  /* First try to decide what to do without reference to lookahead token.  */\n+\n+  yyn = yypact[yystate];\n+  if (yyn == YYFLAG)\n+    goto yydefault;\n+\n+  /* Not known => get a lookahead token if don't already have one.  */\n+\n+  /* yychar is either YYEMPTY or YYEOF\n+     or a valid token in external form.  */\n+\n+  if (yychar == YYEMPTY)\n+    {\n+#if YYDEBUG != 0\n+      if (yydebug)\n+\tfprintf(stderr, \"Reading a token: \");\n+#endif\n+      yychar = YYLEX;\n+    }\n+\n+  /* Convert token to internal form (in yychar1) for indexing tables with */\n+\n+  if (yychar <= 0)\t\t/* This means end of input. */\n+    {\n+      yychar1 = 0;\n+      yychar = YYEOF;\t\t/* Don't call YYLEX any more */\n+\n+#if YYDEBUG != 0\n+      if (yydebug)\n+\tfprintf(stderr, \"Now at end of input.\\n\");\n+#endif\n+    }\n+  else\n+    {\n+      yychar1 = YYTRANSLATE(yychar);\n+\n+#if YYDEBUG != 0\n+      if (yydebug)\n+\t{\n+\t  fprintf (stderr, \"Next token is %d (%s\", yychar, yytname[yychar1]);\n+\t  /* Give the individual parser a way to print the precise meaning\n+\t     of a token, for further debugging info.  */\n+#ifdef YYPRINT\n+\t  YYPRINT (stderr, yychar, yylval);\n+#endif\n+\t  fprintf (stderr, \")\\n\");\n+\t}\n+#endif\n+    }\n+\n+  yyn += yychar1;\n+  if (yyn < 0 || yyn > YYLAST || yycheck[yyn] != yychar1)\n+    goto yydefault;\n+\n+  yyn = yytable[yyn];\n+\n+  /* yyn is what to do for this token type in this state.\n+     Negative => reduce, -yyn is rule number.\n+     Positive => shift, yyn is new state.\n+       New state is final state => don't bother to shift,\n+       just return success.\n+     0, or most negative number => error.  */\n+\n+  if (yyn < 0)\n+    {\n+      if (yyn == YYFLAG)\n+\tgoto yyerrlab;\n+      yyn = -yyn;\n+      goto yyreduce;\n+    }\n+  else if (yyn == 0)\n+    goto yyerrlab;\n+\n+  if (yyn == YYFINAL)\n+    YYACCEPT;\n+\n+  /* Shift the lookahead token.  */\n+\n+#if YYDEBUG != 0\n+  if (yydebug)\n+    fprintf(stderr, \"Shifting token %d (%s), \", yychar, yytname[yychar1]);\n+#endif\n+\n+  /* Discard the token being shifted unless it is eof.  */\n+  if (yychar != YYEOF)\n+    yychar = YYEMPTY;\n+\n+  *++yyvsp = yylval;\n+#ifdef YYLSP_NEEDED\n+  *++yylsp = yylloc;\n+#endif\n+\n+  /* count tokens shifted since error; after three, turn off error status.  */\n+  if (yyerrstatus) yyerrstatus--;\n+\n+  yystate = yyn;\n+  goto yynewstate;\n+\n+/* Do the default action for the current state.  */\n+yydefault:\n+\n+  yyn = yydefact[yystate];\n+  if (yyn == 0)\n+    goto yyerrlab;\n+\n+/* Do a reduction.  yyn is the number of a rule to reduce with.  */\n+yyreduce:\n+  yylen = yyr2[yyn];\n+  if (yylen > 0)\n+    yyval = yyvsp[1-yylen]; /* implement default value of the action */\n+\n+#if YYDEBUG != 0\n+  if (yydebug)\n+    {\n+      int i;\n+\n+      fprintf (stderr, \"Reducing via rule %d (line %d), \",\n+\t       yyn, yyrline[yyn]);\n+\n+      /* Print the symbols being reduced, and their result.  */\n+      for (i = yyprhs[yyn]; yyrhs[i] > 0; i++)\n+\tfprintf (stderr, \"%s \", yytname[yyrhs[i]]);\n+      fprintf (stderr, \" -> %s\\n\", yytname[yyr1[yyn]]);\n+    }\n+#endif\n+\n+\n+  switch (yyn) {\n+\n+case 1:\n+#line 179 \"plural.y\"\n+{\n+\t    if (yyvsp[0].exp == NULL)\n+\t      YYABORT;\n+\t    ((struct parse_args *) arg)->res = yyvsp[0].exp;\n+\t  ;\n+    break;}\n+case 2:\n+#line 187 \"plural.y\"\n+{\n+\t    yyval.exp = new_exp_3 (qmop, yyvsp[-4].exp, yyvsp[-2].exp, yyvsp[0].exp);\n+\t  ;\n+    break;}\n+case 3:\n+#line 191 \"plural.y\"\n+{\n+\t    yyval.exp = new_exp_2 (lor, yyvsp[-2].exp, yyvsp[0].exp);\n+\t  ;\n+    break;}\n+case 4:\n+#line 195 \"plural.y\"\n+{\n+\t    yyval.exp = new_exp_2 (land, yyvsp[-2].exp, yyvsp[0].exp);\n+\t  ;\n+    break;}\n+case 5:\n+#line 199 \"plural.y\"\n+{\n+\t    yyval.exp = new_exp_2 (yyvsp[-1].op, yyvsp[-2].exp, yyvsp[0].exp);\n+\t  ;\n+    break;}\n+case 6:\n+#line 203 \"plural.y\"\n+{\n+\t    yyval.exp = new_exp_2 (yyvsp[-1].op, yyvsp[-2].exp, yyvsp[0].exp);\n+\t  ;\n+    break;}\n+case 7:\n+#line 207 \"plural.y\"\n+{\n+\t    yyval.exp = new_exp_2 (yyvsp[-1].op, yyvsp[-2].exp, yyvsp[0].exp);\n+\t  ;\n+    break;}\n+case 8:\n+#line 211 \"plural.y\"\n+{\n+\t    yyval.exp = new_exp_2 (yyvsp[-1].op, yyvsp[-2].exp, yyvsp[0].exp);\n+\t  ;\n+    break;}\n+case 9:\n+#line 215 \"plural.y\"\n+{\n+\t    yyval.exp = new_exp_1 (lnot, yyvsp[0].exp);\n+\t  ;\n+    break;}\n+case 10:\n+#line 219 \"plural.y\"\n+{\n+\t    yyval.exp = new_exp_0 (var);\n+\t  ;\n+    break;}\n+case 11:\n+#line 223 \"plural.y\"\n+{\n+\t    if ((yyval.exp = new_exp_0 (num)) != NULL)\n+\t      yyval.exp->val.num = yyvsp[0].num;\n+\t  ;\n+    break;}\n+case 12:\n+#line 228 \"plural.y\"\n+{\n+\t    yyval.exp = yyvsp[-1].exp;\n+\t  ;\n+    break;}\n+}\n+   /* the action file gets copied in in place of this dollarsign */\n+#line 543 \"/home/haible/gnu/arch/linuxlibc6/share/bison.simple\"\n+\f\n+  yyvsp -= yylen;\n+  yyssp -= yylen;\n+#ifdef YYLSP_NEEDED\n+  yylsp -= yylen;\n+#endif\n+\n+#if YYDEBUG != 0\n+  if (yydebug)\n+    {\n+      short *ssp1 = yyss - 1;\n+      fprintf (stderr, \"state stack now\");\n+      while (ssp1 != yyssp)\n+\tfprintf (stderr, \" %d\", *++ssp1);\n+      fprintf (stderr, \"\\n\");\n+    }\n+#endif\n+\n+  *++yyvsp = yyval;\n+\n+#ifdef YYLSP_NEEDED\n+  yylsp++;\n+  if (yylen == 0)\n+    {\n+      yylsp->first_line = yylloc.first_line;\n+      yylsp->first_column = yylloc.first_column;\n+      yylsp->last_line = (yylsp-1)->last_line;\n+      yylsp->last_column = (yylsp-1)->last_column;\n+      yylsp->text = 0;\n+    }\n+  else\n+    {\n+      yylsp->last_line = (yylsp+yylen-1)->last_line;\n+      yylsp->last_column = (yylsp+yylen-1)->last_column;\n+    }\n+#endif\n+\n+  /* Now \"shift\" the result of the reduction.\n+     Determine what state that goes to,\n+     based on the state we popped back to\n+     and the rule number reduced by.  */\n+\n+  yyn = yyr1[yyn];\n+\n+  yystate = yypgoto[yyn - YYNTBASE] + *yyssp;\n+  if (yystate >= 0 && yystate <= YYLAST && yycheck[yystate] == *yyssp)\n+    yystate = yytable[yystate];\n+  else\n+    yystate = yydefgoto[yyn - YYNTBASE];\n+\n+  goto yynewstate;\n+\n+yyerrlab:   /* here on detecting error */\n+\n+  if (! yyerrstatus)\n+    /* If not already recovering from an error, report this error.  */\n+    {\n+      ++yynerrs;\n+\n+#ifdef YYERROR_VERBOSE\n+      yyn = yypact[yystate];\n+\n+      if (yyn > YYFLAG && yyn < YYLAST)\n+\t{\n+\t  int size = 0;\n+\t  char *msg;\n+\t  int x, count;\n+\n+\t  count = 0;\n+\t  /* Start X at -yyn if nec to avoid negative indexes in yycheck.  */\n+\t  for (x = (yyn < 0 ? -yyn : 0);\n+\t       x < (sizeof(yytname) / sizeof(char *)); x++)\n+\t    if (yycheck[x + yyn] == x)\n+\t      size += strlen(yytname[x]) + 15, count++;\n+\t  msg = (char *) malloc(size + 15);\n+\t  if (msg != 0)\n+\t    {\n+\t      strcpy(msg, \"parse error\");\n+\n+\t      if (count < 5)\n+\t\t{\n+\t\t  count = 0;\n+\t\t  for (x = (yyn < 0 ? -yyn : 0);\n+\t\t       x < (sizeof(yytname) / sizeof(char *)); x++)\n+\t\t    if (yycheck[x + yyn] == x)\n+\t\t      {\n+\t\t\tstrcat(msg, count == 0 ? \", expecting `\" : \" or `\");\n+\t\t\tstrcat(msg, yytname[x]);\n+\t\t\tstrcat(msg, \"'\");\n+\t\t\tcount++;\n+\t\t      }\n+\t\t}\n+\t      yyerror(msg);\n+\t      free(msg);\n+\t    }\n+\t  else\n+\t    yyerror (\"parse error; also virtual memory exceeded\");\n+\t}\n+      else\n+#endif /* YYERROR_VERBOSE */\n+\tyyerror(\"parse error\");\n+    }\n+\n+  goto yyerrlab1;\n+yyerrlab1:   /* here on error raised explicitly by an action */\n+\n+  if (yyerrstatus == 3)\n+    {\n+      /* if just tried and failed to reuse lookahead token after an error, discard it.  */\n+\n+      /* return failure if at end of input */\n+      if (yychar == YYEOF)\n+\tYYABORT;\n+\n+#if YYDEBUG != 0\n+      if (yydebug)\n+\tfprintf(stderr, \"Discarding token %d (%s).\\n\", yychar, yytname[yychar1]);\n+#endif\n+\n+      yychar = YYEMPTY;\n+    }\n+\n+  /* Else will try to reuse lookahead token\n+     after shifting the error token.  */\n+\n+  yyerrstatus = 3;\t\t/* Each real token shifted decrements this */\n+\n+  goto yyerrhandle;\n+\n+yyerrdefault:  /* current state does not do anything special for the error token. */\n+\n+#if 0\n+  /* This is wrong; only states that explicitly want error tokens\n+     should shift them.  */\n+  yyn = yydefact[yystate];  /* If its default is to accept any token, ok.  Otherwise pop it.*/\n+  if (yyn) goto yydefault;\n+#endif\n+\n+yyerrpop:   /* pop the current state because it cannot handle the error token */\n+\n+  if (yyssp == yyss) YYABORT;\n+  yyvsp--;\n+  yystate = *--yyssp;\n+#ifdef YYLSP_NEEDED\n+  yylsp--;\n+#endif\n+\n+#if YYDEBUG != 0\n+  if (yydebug)\n+    {\n+      short *ssp1 = yyss - 1;\n+      fprintf (stderr, \"Error: state stack now\");\n+      while (ssp1 != yyssp)\n+\tfprintf (stderr, \" %d\", *++ssp1);\n+      fprintf (stderr, \"\\n\");\n+    }\n+#endif\n+\n+yyerrhandle:\n+\n+  yyn = yypact[yystate];\n+  if (yyn == YYFLAG)\n+    goto yyerrdefault;\n+\n+  yyn += YYTERROR;\n+  if (yyn < 0 || yyn > YYLAST || yycheck[yyn] != YYTERROR)\n+    goto yyerrdefault;\n+\n+  yyn = yytable[yyn];\n+  if (yyn < 0)\n+    {\n+      if (yyn == YYFLAG)\n+\tgoto yyerrpop;\n+      yyn = -yyn;\n+      goto yyreduce;\n+    }\n+  else if (yyn == 0)\n+    goto yyerrpop;\n+\n+  if (yyn == YYFINAL)\n+    YYACCEPT;\n+\n+#if YYDEBUG != 0\n+  if (yydebug)\n+    fprintf(stderr, \"Shifting error token, \");\n+#endif\n+\n+  *++yyvsp = yylval;\n+#ifdef YYLSP_NEEDED\n+  *++yylsp = yylloc;\n+#endif\n+\n+  yystate = yyn;\n+  goto yynewstate;\n+\n+ yyacceptlab:\n+  /* YYACCEPT comes here.  */\n+  if (yyfree_stacks)\n+    {\n+      free (yyss);\n+      free (yyvs);\n+#ifdef YYLSP_NEEDED\n+      free (yyls);\n+#endif\n+    }\n+  return 0;\n+\n+ yyabortlab:\n+  /* YYABORT comes here.  */\n+  if (yyfree_stacks)\n+    {\n+      free (yyss);\n+      free (yyvs);\n+#ifdef YYLSP_NEEDED\n+      free (yyls);\n+#endif\n+    }\n+  return 1;\n+}\n+#line 233 \"plural.y\"\n+\n+\n+void\n+internal_function\n+FREE_EXPRESSION (exp)\n+     struct expression *exp;\n+{\n+  if (exp == NULL)\n+    return;\n+\n+  /* Handle the recursive case.  */\n+  switch (exp->nargs)\n+    {\n+    case 3:\n+      FREE_EXPRESSION (exp->val.args[2]);\n+      /* FALLTHROUGH */\n+    case 2:\n+      FREE_EXPRESSION (exp->val.args[1]);\n+      /* FALLTHROUGH */\n+    case 1:\n+      FREE_EXPRESSION (exp->val.args[0]);\n+      /* FALLTHROUGH */\n+    default:\n+      break;\n+    }\n+\n+  free (exp);\n+}\n+\n+\n+static int\n+yylex (lval, pexp)\n+     YYSTYPE *lval;\n+     const char **pexp;\n+{\n+  const char *exp = *pexp;\n+  int result;\n+\n+  while (1)\n+    {\n+      if (exp[0] == '\\0')\n+\t{\n+\t  *pexp = exp;\n+\t  return YYEOF;\n+\t}\n+\n+      if (exp[0] != ' ' && exp[0] != '\\t')\n+\tbreak;\n+\n+      ++exp;\n+    }\n+\n+  result = *exp++;\n+  switch (result)\n+    {\n+    case '0': case '1': case '2': case '3': case '4':\n+    case '5': case '6': case '7': case '8': case '9':\n+      {\n+\tunsigned long int n = result - '0';\n+\twhile (exp[0] >= '0' && exp[0] <= '9')\n+\t  {\n+\t    n *= 10;\n+\t    n += exp[0] - '0';\n+\t    ++exp;\n+\t  }\n+\tlval->num = n;\n+\tresult = NUMBER;\n+      }\n+      break;\n+\n+    case '=':\n+      if (exp[0] == '=')\n+\t{\n+\t  ++exp;\n+\t  lval->op = equal;\n+\t  result = EQUOP2;\n+\t}\n+      else\n+\tresult = YYERRCODE;\n+      break;\n+\n+    case '!':\n+      if (exp[0] == '=')\n+\t{\n+\t  ++exp;\n+\t  lval->op = not_equal;\n+\t  result = EQUOP2;\n+\t}\n+      break;\n+\n+    case '&':\n+    case '|':\n+      if (exp[0] == result)\n+\t++exp;\n+      else\n+\tresult = YYERRCODE;\n+      break;\n+\n+    case '<':\n+      if (exp[0] == '=')\n+\t{\n+\t  ++exp;\n+\t  lval->op = less_or_equal;\n+\t}\n+      else\n+\tlval->op = less_than;\n+      result = CMPOP2;\n+      break;\n+\n+    case '>':\n+      if (exp[0] == '=')\n+\t{\n+\t  ++exp;\n+\t  lval->op = greater_or_equal;\n+\t}\n+      else\n+\tlval->op = greater_than;\n+      result = CMPOP2;\n+      break;\n+\n+    case '*':\n+      lval->op = mult;\n+      result = MULOP2;\n+      break;\n+\n+    case '/':\n+      lval->op = divide;\n+      result = MULOP2;\n+      break;\n+\n+    case '%':\n+      lval->op = module;\n+      result = MULOP2;\n+      break;\n+\n+    case '+':\n+      lval->op = plus;\n+      result = ADDOP2;\n+      break;\n+\n+    case '-':\n+      lval->op = minus;\n+      result = ADDOP2;\n+      break;\n+\n+    case 'n':\n+    case '?':\n+    case ':':\n+    case '(':\n+    case ')':\n+      /* Nothing, just return the character.  */\n+      break;\n+\n+    case ';':\n+    case '\\n':\n+    case '\\0':\n+      /* Be safe and let the user call this function again.  */\n+      --exp;\n+      result = YYEOF;\n+      break;\n+\n+    default:\n+      result = YYERRCODE;\n+#if YYDEBUG != 0\n+      --exp;\n+#endif\n+      break;\n+    }\n+\n+  *pexp = exp;\n+\n+  return result;\n+}\n+\n+\n+static void\n+yyerror (str)\n+     const char *str;\n+{\n+  /* Do nothing.  We don't print error messages here.  */\n+}"}, {"sha": "be049a6d4ec99aad67810bdd965106b5c2e7bea7", "filename": "gcc/intl/plural.y", "status": "added", "additions": 413, "deletions": 0, "changes": 413, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Fplural.y", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Fplural.y", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fintl%2Fplural.y?ref=71a94577632a238bf4e112f0f016819ead09f1d5", "patch": "@@ -0,0 +1,413 @@\n+%{\n+/* Expression parsing for plural form selection.\n+   Copyright (C) 2000, 2001 Free Software Foundation, Inc.\n+   Written by Ulrich Drepper <drepper@cygnus.com>, 2000.\n+\n+   This program is free software; you can redistribute it and/or modify it\n+   under the terms of the GNU Library General Public License as published\n+   by the Free Software Foundation; either version 2, or (at your option)\n+   any later version.\n+\n+   This program is distributed in the hope that it will be useful,\n+   but WITHOUT ANY WARRANTY; without even the implied warranty of\n+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+   Library General Public License for more details.\n+\n+   You should have received a copy of the GNU Library General Public\n+   License along with this program; if not, write to the Free Software\n+   Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307,\n+   USA.  */\n+\n+/* The bison generated parser uses alloca.  AIX 3 forces us to put this\n+   declaration at the beginning of the file.  The declaration in bison's\n+   skeleton file comes too late.  This must come before <config.h>\n+   because <config.h> may include arbitrary system headers.  */\n+#if defined _AIX && !defined __GNUC__\n+ #pragma alloca\n+#endif\n+\n+#ifdef HAVE_CONFIG_H\n+# include <config.h>\n+#endif\n+\n+#include <stdlib.h>\n+#include \"gettextP.h\"\n+\n+/* Names for the libintl functions are a problem.  They must not clash\n+   with existing names and they should follow ANSI C.  But this source\n+   code is also used in GNU C Library where the names have a __\n+   prefix.  So we have to make a difference here.  */\n+#ifdef _LIBC\n+# define FREE_EXPRESSION __gettext_free_exp\n+#else\n+# define FREE_EXPRESSION gettext_free_exp__\n+# define __gettextparse gettextparse__\n+#endif\n+\n+#define YYLEX_PARAM\t&((struct parse_args *) arg)->cp\n+#define YYPARSE_PARAM\targ\n+%}\n+%pure_parser\n+%expect 10\n+\n+%union {\n+  unsigned long int num;\n+  enum operator op;\n+  struct expression *exp;\n+}\n+\n+%{\n+/* Prototypes for local functions.  */\n+static struct expression *new_exp PARAMS ((int nargs, enum operator op,\n+\t\t\t\t\t   struct expression * const *args));\n+static inline struct expression *new_exp_0 PARAMS ((enum operator op));\n+static inline struct expression *new_exp_1 PARAMS ((enum operator op,\n+\t\t\t\t\t\t   struct expression *right));\n+static struct expression *new_exp_2 PARAMS ((enum operator op,\n+\t\t\t\t\t     struct expression *left,\n+\t\t\t\t\t     struct expression *right));\n+static inline struct expression *new_exp_3 PARAMS ((enum operator op,\n+\t\t\t\t\t\t   struct expression *bexp,\n+\t\t\t\t\t\t   struct expression *tbranch,\n+\t\t\t\t\t\t   struct expression *fbranch));\n+static int yylex PARAMS ((YYSTYPE *lval, const char **pexp));\n+static void yyerror PARAMS ((const char *str));\n+\n+/* Allocation of expressions.  */\n+\n+static struct expression *\n+new_exp (nargs, op, args)\n+     int nargs;\n+     enum operator op;\n+     struct expression * const *args;\n+{\n+  int i;\n+  struct expression *newp;\n+\n+  /* If any of the argument could not be malloc'ed, just return NULL.  */\n+  for (i = nargs - 1; i >= 0; i--)\n+    if (args[i] == NULL)\n+      goto fail;\n+\n+  /* Allocate a new expression.  */\n+  newp = (struct expression *) malloc (sizeof (*newp));\n+  if (newp != NULL)\n+    {\n+      newp->nargs = nargs;\n+      newp->operation = op;\n+      for (i = nargs - 1; i >= 0; i--)\n+\tnewp->val.args[i] = args[i];\n+      return newp;\n+    }\n+\n+ fail:\n+  for (i = nargs - 1; i >= 0; i--)\n+    FREE_EXPRESSION (args[i]);\n+\n+  return NULL;\n+}\n+\n+static inline struct expression *\n+new_exp_0 (op)\n+     enum operator op;\n+{\n+  return new_exp (0, op, NULL);\n+}\n+\n+static inline struct expression *\n+new_exp_1 (op, right)\n+     enum operator op;\n+     struct expression *right;\n+{\n+  struct expression *args[1];\n+\n+  args[0] = right;\n+  return new_exp (1, op, args);\n+}\n+\n+static struct expression *\n+new_exp_2 (op, left, right)\n+     enum operator op;\n+     struct expression *left;\n+     struct expression *right;\n+{\n+  struct expression *args[2];\n+\n+  args[0] = left;\n+  args[1] = right;\n+  return new_exp (2, op, args);\n+}\n+\n+static inline struct expression *\n+new_exp_3 (op, bexp, tbranch, fbranch)\n+     enum operator op;\n+     struct expression *bexp;\n+     struct expression *tbranch;\n+     struct expression *fbranch;\n+{\n+  struct expression *args[3];\n+\n+  args[0] = bexp;\n+  args[1] = tbranch;\n+  args[2] = fbranch;\n+  return new_exp (3, op, args);\n+}\n+\n+%}\n+\n+/* This declares that all operators have the same associativity and the\n+   precedence order as in C.  See [Harbison, Steele: C, A Reference Manual].\n+   There is no unary minus and no bitwise operators.\n+   Operators with the same syntactic behaviour have been merged into a single\n+   token, to save space in the array generated by bison.  */\n+%right '?'\t\t/*   ?\t\t*/\n+%left '|'\t\t/*   ||\t\t*/\n+%left '&'\t\t/*   &&\t\t*/\n+%left EQUOP2\t\t/*   == !=\t*/\n+%left CMPOP2\t\t/*   < > <= >=\t*/\n+%left ADDOP2\t\t/*   + -\t*/\n+%left MULOP2\t\t/*   * / %\t*/\n+%right '!'\t\t/*   !\t\t*/\n+\n+%token <op> EQUOP2 CMPOP2 ADDOP2 MULOP2\n+%token <num> NUMBER\n+%type <exp> exp\n+\n+%%\n+\n+start:\t  exp\n+\t  {\n+\t    if ($1 == NULL)\n+\t      YYABORT;\n+\t    ((struct parse_args *) arg)->res = $1;\n+\t  }\n+\t;\n+\n+exp:\t  exp '?' exp ':' exp\n+\t  {\n+\t    $$ = new_exp_3 (qmop, $1, $3, $5);\n+\t  }\n+\t| exp '|' exp\n+\t  {\n+\t    $$ = new_exp_2 (lor, $1, $3);\n+\t  }\n+\t| exp '&' exp\n+\t  {\n+\t    $$ = new_exp_2 (land, $1, $3);\n+\t  }\n+\t| exp EQUOP2 exp\n+\t  {\n+\t    $$ = new_exp_2 ($2, $1, $3);\n+\t  }\n+\t| exp CMPOP2 exp\n+\t  {\n+\t    $$ = new_exp_2 ($2, $1, $3);\n+\t  }\n+\t| exp ADDOP2 exp\n+\t  {\n+\t    $$ = new_exp_2 ($2, $1, $3);\n+\t  }\n+\t| exp MULOP2 exp\n+\t  {\n+\t    $$ = new_exp_2 ($2, $1, $3);\n+\t  }\n+\t| '!' exp\n+\t  {\n+\t    $$ = new_exp_1 (lnot, $2);\n+\t  }\n+\t| 'n'\n+\t  {\n+\t    $$ = new_exp_0 (var);\n+\t  }\n+\t| NUMBER\n+\t  {\n+\t    if (($$ = new_exp_0 (num)) != NULL)\n+\t      $$->val.num = $1;\n+\t  }\n+\t| '(' exp ')'\n+\t  {\n+\t    $$ = $2;\n+\t  }\n+\t;\n+\n+%%\n+\n+void\n+internal_function\n+FREE_EXPRESSION (exp)\n+     struct expression *exp;\n+{\n+  if (exp == NULL)\n+    return;\n+\n+  /* Handle the recursive case.  */\n+  switch (exp->nargs)\n+    {\n+    case 3:\n+      FREE_EXPRESSION (exp->val.args[2]);\n+      /* FALLTHROUGH */\n+    case 2:\n+      FREE_EXPRESSION (exp->val.args[1]);\n+      /* FALLTHROUGH */\n+    case 1:\n+      FREE_EXPRESSION (exp->val.args[0]);\n+      /* FALLTHROUGH */\n+    default:\n+      break;\n+    }\n+\n+  free (exp);\n+}\n+\n+\n+static int\n+yylex (lval, pexp)\n+     YYSTYPE *lval;\n+     const char **pexp;\n+{\n+  const char *exp = *pexp;\n+  int result;\n+\n+  while (1)\n+    {\n+      if (exp[0] == '\\0')\n+\t{\n+\t  *pexp = exp;\n+\t  return YYEOF;\n+\t}\n+\n+      if (exp[0] != ' ' && exp[0] != '\\t')\n+\tbreak;\n+\n+      ++exp;\n+    }\n+\n+  result = *exp++;\n+  switch (result)\n+    {\n+    case '0': case '1': case '2': case '3': case '4':\n+    case '5': case '6': case '7': case '8': case '9':\n+      {\n+\tunsigned long int n = result - '0';\n+\twhile (exp[0] >= '0' && exp[0] <= '9')\n+\t  {\n+\t    n *= 10;\n+\t    n += exp[0] - '0';\n+\t    ++exp;\n+\t  }\n+\tlval->num = n;\n+\tresult = NUMBER;\n+      }\n+      break;\n+\n+    case '=':\n+      if (exp[0] == '=')\n+\t{\n+\t  ++exp;\n+\t  lval->op = equal;\n+\t  result = EQUOP2;\n+\t}\n+      else\n+\tresult = YYERRCODE;\n+      break;\n+\n+    case '!':\n+      if (exp[0] == '=')\n+\t{\n+\t  ++exp;\n+\t  lval->op = not_equal;\n+\t  result = EQUOP2;\n+\t}\n+      break;\n+\n+    case '&':\n+    case '|':\n+      if (exp[0] == result)\n+\t++exp;\n+      else\n+\tresult = YYERRCODE;\n+      break;\n+\n+    case '<':\n+      if (exp[0] == '=')\n+\t{\n+\t  ++exp;\n+\t  lval->op = less_or_equal;\n+\t}\n+      else\n+\tlval->op = less_than;\n+      result = CMPOP2;\n+      break;\n+\n+    case '>':\n+      if (exp[0] == '=')\n+\t{\n+\t  ++exp;\n+\t  lval->op = greater_or_equal;\n+\t}\n+      else\n+\tlval->op = greater_than;\n+      result = CMPOP2;\n+      break;\n+\n+    case '*':\n+      lval->op = mult;\n+      result = MULOP2;\n+      break;\n+\n+    case '/':\n+      lval->op = divide;\n+      result = MULOP2;\n+      break;\n+\n+    case '%':\n+      lval->op = module;\n+      result = MULOP2;\n+      break;\n+\n+    case '+':\n+      lval->op = plus;\n+      result = ADDOP2;\n+      break;\n+\n+    case '-':\n+      lval->op = minus;\n+      result = ADDOP2;\n+      break;\n+\n+    case 'n':\n+    case '?':\n+    case ':':\n+    case '(':\n+    case ')':\n+      /* Nothing, just return the character.  */\n+      break;\n+\n+    case ';':\n+    case '\\n':\n+    case '\\0':\n+      /* Be safe and let the user call this function again.  */\n+      --exp;\n+      result = YYEOF;\n+      break;\n+\n+    default:\n+      result = YYERRCODE;\n+#if YYDEBUG != 0\n+      --exp;\n+#endif\n+      break;\n+    }\n+\n+  *pexp = exp;\n+\n+  return result;\n+}\n+\n+\n+static void\n+yyerror (str)\n+     const char *str;\n+{\n+  /* Do nothing.  We don't print error messages here.  */\n+}"}, {"sha": "0456286357694ebb26d8a1f343c89887291b25c0", "filename": "gcc/intl/po2tbl.sed.in", "status": "removed", "additions": 0, "deletions": 102, "changes": 102, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7e21622e0e580b065224125cc6085b9f0559293a/gcc%2Fintl%2Fpo2tbl.sed.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7e21622e0e580b065224125cc6085b9f0559293a/gcc%2Fintl%2Fpo2tbl.sed.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fintl%2Fpo2tbl.sed.in?ref=7e21622e0e580b065224125cc6085b9f0559293a", "patch": "@@ -1,102 +0,0 @@\n-# po2tbl.sed - Convert Uniforum style .po file to lookup table for catgets\n-# Copyright (C) 1995 Free Software Foundation, Inc.\n-# Ulrich Drepper <drepper@gnu.ai.mit.edu>, 1995.\n-#\n-# This program is free software; you can redistribute it and/or modify\n-# it under the terms of the GNU General Public License as published by\n-# the Free Software Foundation; either version 2, or (at your option)\n-# any later version.\n-#\n-# This program is distributed in the hope that it will be useful,\n-# but WITHOUT ANY WARRANTY; without even the implied warranty of\n-# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n-# GNU General Public License for more details.\n-#\n-# You should have received a copy of the GNU General Public License\n-# along with this program; if not, write to the Free Software\n-# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.\n-#\n-1 {\n-  i\\\n-/* Automatically generated by po2tbl.sed from @PACKAGE@.pot.  */\\\n-\\\n-#if HAVE_CONFIG_H\\\n-# include <config.h>\\\n-#endif\\\n-\\\n-#include \"libgettext.h\"\\\n-\\\n-const struct _msg_ent _msg_tbl[] = {\n-  h\n-  s/.*/0/\n-  x\n-}\n-#\n-# Write msgid entries in C array form.\n-#\n-/^msgid/ {\n-  s/msgid[ \t]*\\(\".*\"\\)/  {\\1/\n-  tb\n-# Append the next line\n-  :b\n-  N\n-# Look whether second part is continuation line.\n-  s/\\(.*\\)\"\\(\\n\\)\"\\(.*\"\\)/\\1\\2\\3/\n-# Yes, then branch.\n-  ta\n-# Because we assume that the input file correctly formed the line\n-# just read cannot be again be a msgid line.  So it's safe to ignore\n-# it.\n-  s/\\(.*\\)\\n.*/\\1/\n-  bc\n-# We found a continuation line.  But before printing insert '\\'.\n-  :a\n-  s/\\(.*\\)\\(\\n.*\\)/\\1\\\\\\2/\n-  P\n-# We cannot use D here.\n-  s/.*\\n\\(.*\\)/\\1/\n-# Some buggy seds do not clear the `successful substitution since last ``t'''\n-# flag on `N', so we do a `t' here to clear it.\n-  tb\n-# Not reached\n-  :c\n-  x\n-# The following nice solution is by\n-# Bruno <Haible@ma2s2.mathematik.uni-karlsruhe.de>\n-  td\n-# Increment a decimal number in pattern space.\n-# First hide trailing `9' digits.\n-  :d\n-  s/9\\(_*\\)$/_\\1/\n-  td\n-# Assure at least one digit is available.\n-  s/^\\(_*\\)$/0\\1/\n-# Increment the last digit.\n-  s/8\\(_*\\)$/9\\1/\n-  s/7\\(_*\\)$/8\\1/\n-  s/6\\(_*\\)$/7\\1/\n-  s/5\\(_*\\)$/6\\1/\n-  s/4\\(_*\\)$/5\\1/\n-  s/3\\(_*\\)$/4\\1/\n-  s/2\\(_*\\)$/3\\1/\n-  s/1\\(_*\\)$/2\\1/\n-  s/0\\(_*\\)$/1\\1/\n-# Convert the hidden `9' digits to `0's.\n-  s/_/0/g\n-  x\n-  G\n-  s/\\(.*\\)\\n\\([0-9]*\\)/\\1, \\2},/\n-  s/\\(.*\\)\"$/\\1/\n-  p\n-}\n-#\n-# Last line.\n-#\n-$ {\n-  i\\\n-};\\\n-\n-  g\n-  s/0*\\(.*\\)/int _msg_tbl_length = \\1;/p\n-}\n-d"}, {"sha": "167374e3c5e052d474f5ba092969cf7af41c9f5b", "filename": "gcc/intl/ref-add.sin", "status": "added", "additions": 31, "deletions": 0, "changes": 31, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Fref-add.sin", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Fref-add.sin", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fintl%2Fref-add.sin?ref=71a94577632a238bf4e112f0f016819ead09f1d5", "patch": "@@ -0,0 +1,31 @@\n+# Add this package to a list of references stored in a text file.\n+#\n+#   Copyright (C) 2000 Free Software Foundation, Inc.\n+#\n+#   This program is free software; you can redistribute it and/or modify it\n+#   under the terms of the GNU Library General Public License as published\n+#   by the Free Software Foundation; either version 2, or (at your option)\n+#   any later version.\n+#\n+#   This program is distributed in the hope that it will be useful,\n+#   but WITHOUT ANY WARRANTY; without even the implied warranty of\n+#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+#   Library General Public License for more details.\n+#\n+#   You should have received a copy of the GNU Library General Public\n+#   License along with this program; if not, write to the Free Software\n+#   Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307,\n+#   USA.\n+#\n+# Written by Bruno Haible <haible@clisp.cons.org>.\n+#\n+/^# Packages using this file: / {\n+  s/# Packages using this file://\n+  ta\n+  :a\n+  s/ @PACKAGE@ / @PACKAGE@ /\n+  tb\n+  s/ $/ @PACKAGE@ /\n+  :b\n+  s/^/# Packages using this file:/\n+}"}, {"sha": "613cf37f3ba38311d4f1bf79c831e21c06b03b50", "filename": "gcc/intl/ref-del.sin", "status": "added", "additions": 26, "deletions": 0, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Fref-del.sin", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Fref-del.sin", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fintl%2Fref-del.sin?ref=71a94577632a238bf4e112f0f016819ead09f1d5", "patch": "@@ -0,0 +1,26 @@\n+# Remove this package from a list of references stored in a text file.\n+#\n+#   Copyright (C) 2000 Free Software Foundation, Inc.\n+#\n+#   This program is free software; you can redistribute it and/or modify it\n+#   under the terms of the GNU Library General Public License as published\n+#   by the Free Software Foundation; either version 2, or (at your option)\n+#   any later version.\n+#\n+#   This program is distributed in the hope that it will be useful,\n+#   but WITHOUT ANY WARRANTY; without even the implied warranty of\n+#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+#   Library General Public License for more details.\n+#\n+#   You should have received a copy of the GNU Library General Public\n+#   License along with this program; if not, write to the Free Software\n+#   Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307,\n+#   USA.\n+#\n+# Written by Bruno Haible <haible@clisp.cons.org>.\n+#\n+/^# Packages using this file: / {\n+  s/# Packages using this file://\n+  s/ @PACKAGE@ / /\n+  s/^/# Packages using this file:/\n+}"}, {"sha": "2e420ad7729c407a3ec055e8f3713c9d978097de", "filename": "gcc/intl/textdomain.c", "status": "modified", "additions": 58, "deletions": 32, "changes": 90, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Ftextdomain.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fintl%2Ftextdomain.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fintl%2Ftextdomain.c?ref=71a94577632a238bf4e112f0f016819ead09f1d5", "patch": "@@ -1,42 +1,43 @@\n /* Implementation of the textdomain(3) function.\n-   Copyright (C) 1995, 1996, 1997, 1998 Free Software Foundation, Inc.\n-   Written by Ulrich Drepper <drepper@gnu.ai.mit.edu>, 1995.\n+   Copyright (C) 1995-1998, 2000, 2001 Free Software Foundation, Inc.\n \n-   This program is free software; you can redistribute it and/or modify\n-   it under the terms of the GNU General Public License as published by\n-   the Free Software Foundation; either version 2, or (at your option)\n+   This program is free software; you can redistribute it and/or modify it\n+   under the terms of the GNU Library General Public License as published\n+   by the Free Software Foundation; either version 2, or (at your option)\n    any later version.\n \n    This program is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n-   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n-   GNU General Public License for more details.\n+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+   Library General Public License for more details.\n \n-   You should have received a copy of the GNU General Public License\n-   along with this program; if not, write to the Free Software Foundation,\n-   Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.  */\n+   You should have received a copy of the GNU Library General Public\n+   License along with this program; if not, write to the Free Software\n+   Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307,\n+   USA.  */\n \n #ifdef HAVE_CONFIG_H\n # include <config.h>\n #endif\n \n-#if defined STDC_HEADERS || defined _LIBC\n-# include <stdlib.h>\n-#endif\n+#include <stdlib.h>\n+#include <string.h>\n \n-#if defined STDC_HEADERS || defined HAVE_STRING_H || defined _LIBC\n-# include <string.h>\n+#ifdef _LIBC\n+# include <libintl.h>\n #else\n-# include <strings.h>\n-# ifndef memcpy\n-#  define memcpy(Dst, Src, Num) bcopy (Src, Dst, Num)\n-# endif\n+# include \"libgnuintl.h\"\n #endif\n+#include \"gettextP.h\"\n \n #ifdef _LIBC\n-# include <libintl.h>\n+/* We have to handle multi-threaded applications.  */\n+# include <bits/libc-lock.h>\n #else\n-# include \"libgettext.h\"\n+/* Provide dummy implementation if this is outside glibc.  */\n+# define __libc_rwlock_define(CLASS, NAME)\n+# define __libc_rwlock_wrlock(NAME)\n+# define __libc_rwlock_unlock(NAME)\n #endif\n \n /* The internal variables in the standalone libintl.a must have different\n@@ -69,45 +70,70 @@ extern const char *_nl_current_default_domain;\n # define TEXTDOMAIN textdomain__\n #endif\n \n+/* Lock variable to protect the global data in the gettext implementation.  */\n+__libc_rwlock_define (extern, _nl_state_lock)\n+\n /* Set the current default message catalog to DOMAINNAME.\n    If DOMAINNAME is null, return the current default.\n    If DOMAINNAME is \"\", reset to the default of \"messages\".  */\n char *\n TEXTDOMAIN (domainname)\n      const char *domainname;\n {\n-  char *old;\n+  char *new_domain;\n+  char *old_domain;\n \n   /* A NULL pointer requests the current setting.  */\n   if (domainname == NULL)\n     return (char *) _nl_current_default_domain;\n \n-  old = (char *) _nl_current_default_domain;\n+  __libc_rwlock_wrlock (_nl_state_lock);\n+\n+  old_domain = (char *) _nl_current_default_domain;\n \n   /* If domain name is the null string set to default domain \"messages\".  */\n   if (domainname[0] == '\\0'\n       || strcmp (domainname, _nl_default_default_domain) == 0)\n-    _nl_current_default_domain = _nl_default_default_domain;\n+    {\n+      _nl_current_default_domain = _nl_default_default_domain;\n+      new_domain = (char *) _nl_current_default_domain;\n+    }\n+  else if (strcmp (domainname, old_domain) == 0)\n+    /* This can happen and people will use it to signal that some\n+       environment variable changed.  */\n+    new_domain = old_domain;\n   else\n     {\n       /* If the following malloc fails `_nl_current_default_domain'\n \t will be NULL.  This value will be returned and so signals we\n \t are out of core.  */\n #if defined _LIBC || defined HAVE_STRDUP\n-      _nl_current_default_domain = strdup (domainname);\n+      new_domain = strdup (domainname);\n #else\n       size_t len = strlen (domainname) + 1;\n-      char *cp = (char *) malloc (len);\n-      if (cp != NULL)\n-\tmemcpy (cp, domainname, len);\n-      _nl_current_default_domain = cp;\n+      new_domain = (char *) malloc (len);\n+      if (new_domain != NULL)\n+\tmemcpy (new_domain, domainname, len);\n #endif\n+\n+      if (new_domain != NULL)\n+\t_nl_current_default_domain = new_domain;\n+    }\n+\n+  /* We use this possibility to signal a change of the loaded catalogs\n+     since this is most likely the case and there is no other easy we\n+     to do it.  Do it only when the call was successful.  */\n+  if (new_domain != NULL)\n+    {\n+      ++_nl_msg_cat_cntr;\n+\n+      if (old_domain != new_domain && old_domain != _nl_default_default_domain)\n+\tfree (old_domain);\n     }\n \n-  if (old != _nl_default_default_domain)\n-    free (old);\n+  __libc_rwlock_unlock (_nl_state_lock);\n \n-  return (char *) _nl_current_default_domain;\n+  return new_domain;\n }\n \n #ifdef _LIBC"}, {"sha": "b19c0bbd0ec11b47bd1758af997c2dc3bfcca995", "filename": "gcc/intl/xopen-msg.sed", "status": "removed", "additions": 0, "deletions": 104, "changes": 104, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7e21622e0e580b065224125cc6085b9f0559293a/gcc%2Fintl%2Fxopen-msg.sed", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7e21622e0e580b065224125cc6085b9f0559293a/gcc%2Fintl%2Fxopen-msg.sed", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fintl%2Fxopen-msg.sed?ref=7e21622e0e580b065224125cc6085b9f0559293a", "patch": "@@ -1,104 +0,0 @@\n-# po2msg.sed - Convert Uniforum style .po file to X/Open style .msg file\n-# Copyright (C) 1995 Free Software Foundation, Inc.\n-# Ulrich Drepper <drepper@gnu.ai.mit.edu>, 1995.\n-#\n-# This program is free software; you can redistribute it and/or modify\n-# it under the terms of the GNU General Public License as published by\n-# the Free Software Foundation; either version 2, or (at your option)\n-# any later version.\n-#\n-# This program is distributed in the hope that it will be useful,\n-# but WITHOUT ANY WARRANTY; without even the implied warranty of\n-# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n-# GNU General Public License for more details.\n-#\n-# You should have received a copy of the GNU General Public License\n-# along with this program; if not, write to the Free Software\n-# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.\n-#\n-#\n-# The first directive in the .msg should be the definition of the\n-# message set number.  We use always set number 1.\n-#\n-1 {\n-  i\\\n-$set 1 # Automatically created by po2msg.sed\n-  h\n-  s/.*/0/\n-  x\n-}\n-#\n-# We copy all comments into the .msg file.  Perhaps they can help.\n-#\n-/^#/ s/^#[ \t]*/$ /p\n-#\n-# We copy the original message as a comment into the .msg file.\n-#\n-/^msgid/ {\n-# Does not work now\n-#  /\"$/! {\n-#    s/\\\\$//\n-#    s/$/ ... (more lines following)\"/\n-#  }\n-  s/^msgid[ \t]*\"\\(.*\\)\"$/$ Original Message: \\1/\n-  p\n-}\n-#\n-# The .msg file contains, other then the .po file, only the translations\n-# but each given a unique ID.  Starting from 1 and incrementing by 1 for\n-# each message we assign them to the messages.\n-# It is important that the .po file used to generate the cat-id-tbl.c file\n-# (with po-to-tbl) is the same as the one used here.  (At least the order\n-# of declarations must not be changed.)\n-#\n-/^msgstr/ {\n-  s/msgstr[ \t]*\"\\(.*\\)\"/\\1/\n-  x\n-# The following nice solution is by\n-# Bruno <Haible@ma2s2.mathematik.uni-karlsruhe.de>\n-  td\n-# Increment a decimal number in pattern space.\n-# First hide trailing `9' digits.\n-  :d\n-  s/9\\(_*\\)$/_\\1/\n-  td\n-# Assure at least one digit is available.\n-  s/^\\(_*\\)$/0\\1/\n-# Increment the last digit.\n-  s/8\\(_*\\)$/9\\1/\n-  s/7\\(_*\\)$/8\\1/\n-  s/6\\(_*\\)$/7\\1/\n-  s/5\\(_*\\)$/6\\1/\n-  s/4\\(_*\\)$/5\\1/\n-  s/3\\(_*\\)$/4\\1/\n-  s/2\\(_*\\)$/3\\1/\n-  s/1\\(_*\\)$/2\\1/\n-  s/0\\(_*\\)$/1\\1/\n-# Convert the hidden `9' digits to `0's.\n-  s/_/0/g\n-  x\n-# Bring the line in the format `<number> <message>'\n-  G\n-  s/^[^\\n]*$/& /\n-  s/\\(.*\\)\\n\\([0-9]*\\)/\\2 \\1/\n-# Clear flag from last substitution.\n-  tb\n-# Append the next line.\n-  :b\n-  N\n-# Look whether second part is a continuation line.\n-  s/\\(.*\\n\\)\"\\(.*\\)\"/\\1\\2/\n-# Yes, then branch.\n-  ta\n-  P\n-  D\n-# Note that `D' includes a jump to the start!!\n-# We found a continuation line.  But before printing insert '\\'.\n-  :a\n-  s/\\(.*\\)\\(\\n.*\\)/\\1\\\\\\2/\n-  P\n-# We cannot use the sed command `D' here\n-  s/.*\\n\\(.*\\)/\\1/\n-  tb\n-}\n-d"}, {"sha": "3fbe7d5f2644a751b764f24b6e46aeccfb4533db", "filename": "gcc/po/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fpo%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fpo%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fpo%2FChangeLog?ref=71a94577632a238bf4e112f0f016819ead09f1d5", "patch": "@@ -1,3 +1,9 @@\n+2001-10-12  Zack Weinberg  <zack@codesourcery.com>\n+\n+\t* Makefile.in.in: Upgrade to gettext-0.10.40.\n+\t* cat-id-tbl.c: Remove file.\n+\t* stamp-cat-id: Remove file.\n+\n 2001-10-08  Alexandre Oliva  <aoliva@redhat.com>\n \n \t* POTFILES.in: Add newly-added files."}, {"sha": "28726a21f2806123cfcbd7288392abd644e8cc12", "filename": "gcc/po/Makefile.in.in", "status": "modified", "additions": 71, "deletions": 130, "changes": 201, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fpo%2FMakefile.in.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71a94577632a238bf4e112f0f016819ead09f1d5/gcc%2Fpo%2FMakefile.in.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fpo%2FMakefile.in.in?ref=71a94577632a238bf4e112f0f016819ead09f1d5", "patch": "@@ -1,16 +1,19 @@\n # Makefile for program source directory in GNU NLS utilities package.\n-# Copyright (C) 1995, 1996, 1997 by Ulrich Drepper <drepper@gnu.ai.mit.edu>\n+# Copyright (C) 1995-1997, 2000, 2001 by Ulrich Drepper <drepper@gnu.ai.mit.edu>\n #\n # This file file be copied and used freely without restrictions.  It can\n-# be used in projects which are not available under the GNU Public License\n+# be used in projects which are not available under the GNU General Public License\n # but which still want to provide support for the GNU gettext functionality.\n # Please note that the actual code is *not* freely available.\n \n PACKAGE = @PACKAGE@\n VERSION = @VERSION@\n \n+# These two variables depend on the location of this directory.\n+subdir = po\n+top_builddir = ..\n+\n SHELL = /bin/sh\n-STAMP = echo timestamp >\n @SET_MAKE@\n \n srcdir = @srcdir@\n@@ -19,22 +22,20 @@ VPATH = @srcdir@\n \n prefix = @prefix@\n exec_prefix = @exec_prefix@\n-datadir = $(prefix)/@DATADIRNAME@\n+datadir = @datadir@\n localedir = $(datadir)/locale\n-gnulocaledir = $(prefix)/share/locale\n-gettextsrcdir = $(prefix)/share/gettext/po\n-subdir = po\n+gettextsrcdir = $(datadir)/gettext/po\n \n INSTALL = @INSTALL@\n INSTALL_DATA = @INSTALL_DATA@\n-MKINSTALLDIRS = $(top_srcdir)/@MKINSTALLDIRS@\n+MKINSTALLDIRS = @MKINSTALLDIRS@\n+mkinstalldirs = $(SHELL) `case \"$(MKINSTALLDIRS)\" in /*) echo \"$(MKINSTALLDIRS)\" ;; *) echo \"$(top_builddir)/$(MKINSTALLDIRS)\" ;; esac`\n \n CC = @CC@\n-GENCAT = @GENCAT@\n-GMSGFMT = PATH=../src:$$PATH @GMSGFMT@\n+GMSGFMT = @GMSGFMT@\n MSGFMT = @MSGFMT@\n-XGETTEXT = PATH=../src:$$PATH @XGETTEXT@\n-MSGMERGE = PATH=../src:$$PATH msgmerge\n+XGETTEXT = @XGETTEXT@\n+MSGMERGE = msgmerge\n \n DEFS = @DEFS@\n CFLAGS = @CFLAGS@\n@@ -44,130 +45,79 @@ INCLUDES = -I.. -I$(top_srcdir)/intl\n \n COMPILE = $(CC) -c $(DEFS) $(INCLUDES) $(CPPFLAGS) $(CFLAGS) $(XCFLAGS)\n \n-SOURCES = cat-id-tbl.c\n POFILES = @POFILES@\n GMOFILES = @GMOFILES@\n DISTFILES = ChangeLog Makefile.in.in POTFILES.in $(PACKAGE).pot \\\n-stamp-cat-id $(POFILES) $(GMOFILES) $(SOURCES)\n+$(POFILES) $(GMOFILES)\n \n POTFILES = \\\n \n CATALOGS = @CATALOGS@\n-CATOBJEXT = @CATOBJEXT@\n-INSTOBJEXT = @INSTOBJEXT@\n \n .SUFFIXES:\n-.SUFFIXES: .c .o .po .pox .gmo .mo .msg .cat\n+.SUFFIXES: .c .o .po .pox .gmo .mo\n \n .c.o:\n \t$(COMPILE) $<\n \n .po.pox:\n-\t$(MAKE) $(srcdir)/$(PACKAGE).pot\n+\t$(MAKE) $(PACKAGE).pot\n \t$(MSGMERGE) $< $(srcdir)/$(PACKAGE).pot -o $*.pox\n \n .po.mo:\n \t$(MSGFMT) -o $@ $<\n \n .po.gmo:\n-\tfile=`echo $* | sed 's,.*/,,'`.gmo \\\n-\t  && rm -f $$file && $(GMSGFMT) -o $$file $<\n-\n-.po.cat:\n-\tsed -f ../intl/po2msg.sed < $< > $*.msg \\\n-\t  && rm -f $@ && $(GENCAT) $@ $*.msg\n+\tfile=$(srcdir)/`echo $* | sed 's,.*/,,'`.gmo \\\n+\t  && rm -f $$file && $(GMSGFMT) --statistics -o $$file $<\n \n \n all: all-@USE_NLS@\n \n-all-yes: $(CATALOGS) @MAINT@ $(srcdir)/cat-id-tbl.c \n+all-yes: $(CATALOGS)\n all-no:\n \n-stamp-check-po: $(POTFILES)\n-\t$(STAMP) stamp-check-po\n-\n-check-po: stamp-check-po\n+# Note: Target 'all' must not depend on target '$(srcdir)/$(PACKAGE).pot',\n+# otherwise packages like GCC can not be built if only parts of the source\n+# have been downloaded.\n \n-$(srcdir)/$(PACKAGE).pot: $(POTFILES)\n+$(srcdir)/$(PACKAGE).pot: $(POTFILES) $(srcdir)/POTFILES.in\n \t$(XGETTEXT) --default-domain=$(PACKAGE) --directory=$(top_srcdir) \\\n \t  --add-comments --keyword=_ --keyword=N_ \\\n \t  --files-from=$(srcdir)/POTFILES.in \\\n \t&& test ! -f $(PACKAGE).po \\\n \t   || ( rm -f $(srcdir)/$(PACKAGE).pot \\\n \t\t&& mv $(PACKAGE).po $(srcdir)/$(PACKAGE).pot )\n \n-$(srcdir)/cat-id-tbl.c: $(srcdir)/stamp-cat-id; @:\n-$(srcdir)/stamp-cat-id: $(srcdir)/$(PACKAGE).pot\n-\trm -f cat-id-tbl.tmp\n-\tsed -f ../intl/po2tbl.sed $(srcdir)/$(PACKAGE).pot \\\n-\t\t| sed -e \"s/@PACKAGE NAME@/$(PACKAGE)/\" > cat-id-tbl.tmp\n-\tif cmp -s cat-id-tbl.tmp $(srcdir)/cat-id-tbl.c; then \\\n-\t  rm cat-id-tbl.tmp; \\\n-\telse \\\n-\t  echo cat-id-tbl.c changed; \\\n-\t  rm -f $(srcdir)/cat-id-tbl.c; \\\n-\t  mv cat-id-tbl.tmp $(srcdir)/cat-id-tbl.c; \\\n-\tfi\n-\tcd $(srcdir) && rm -f stamp-cat-id && echo timestamp > stamp-cat-id\n-\n \n install: install-exec install-data\n install-exec:\n install-data: install-data-@USE_NLS@\n-install-data-no: all\n-install-data-yes: all\n-\tif test -r \"$(MKINSTALLDIRS)\"; then \\\n-\t  $(MKINSTALLDIRS) $(datadir); \\\n+\tif test \"$(PACKAGE)\" = \"gettext\"; then \\\n+\t  $(mkinstalldirs) $(DESTDIR)$(gettextsrcdir); \\\n+\t  $(INSTALL_DATA) $(srcdir)/Makefile.in.in \\\n+\t\t\t  $(DESTDIR)$(gettextsrcdir)/Makefile.in.in; \\\n \telse \\\n-\t  $(SHELL) $(top_srcdir)/mkinstalldirs $(datadir); \\\n+\t  : ; \\\n \tfi\n+install-data-no: all\n+install-data-yes: all\n+\t$(mkinstalldirs) $(DESTDIR)$(datadir)\n \t@catalogs='$(CATALOGS)'; \\\n \tfor cat in $$catalogs; do \\\n \t  cat=`basename $$cat`; \\\n-\t  case \"$$cat\" in \\\n-\t    *.gmo) destdir=$(gnulocaledir);; \\\n-\t    *)     destdir=$(localedir);; \\\n-\t  esac; \\\n-\t  lang=`echo $$cat | sed 's/\\$(CATOBJEXT)$$//'`; \\\n-\t  dir=$$destdir/$$lang/LC_MESSAGES; \\\n-\t  if test -r \"$(MKINSTALLDIRS)\"; then \\\n-\t    $(MKINSTALLDIRS) $$dir; \\\n-\t  else \\\n-\t    $(SHELL) $(top_srcdir)/mkinstalldirs $$dir; \\\n-\t  fi; \\\n+\t  lang=`echo $$cat | sed 's/\\.gmo$$//'`; \\\n+\t  dir=$(localedir)/$$lang/LC_MESSAGES; \\\n+\t  $(mkinstalldirs) $(DESTDIR)$$dir; \\\n \t  if test -r $$cat; then \\\n-\t    $(INSTALL_DATA) $$cat $$dir/$(PACKAGE)$(INSTOBJEXT); \\\n-\t    echo \"installing $$cat as $$dir/$(PACKAGE)$(INSTOBJEXT)\"; \\\n+\t    $(INSTALL_DATA) $$cat $(DESTDIR)$$dir/$(PACKAGE).mo; \\\n+\t    echo \"installing $$cat as $(DESTDIR)$$dir/$(PACKAGE).mo\"; \\\n \t  else \\\n-\t    $(INSTALL_DATA) $(srcdir)/$$cat $$dir/$(PACKAGE)$(INSTOBJEXT); \\\n+\t    $(INSTALL_DATA) $(srcdir)/$$cat $(DESTDIR)$$dir/$(PACKAGE).mo; \\\n \t    echo \"installing $(srcdir)/$$cat as\" \\\n-\t\t \"$$dir/$(PACKAGE)$(INSTOBJEXT)\"; \\\n-\t  fi; \\\n-\t  if test -r $$cat.m; then \\\n-\t    $(INSTALL_DATA) $$cat.m $$dir/$(PACKAGE)$(INSTOBJEXT).m; \\\n-\t    echo \"installing $$cat.m as $$dir/$(PACKAGE)$(INSTOBJEXT).m\"; \\\n-\t  else \\\n-\t    if test -r $(srcdir)/$$cat.m ; then \\\n-\t      $(INSTALL_DATA) $(srcdir)/$$cat.m \\\n-\t\t$$dir/$(PACKAGE)$(INSTOBJEXT).m; \\\n-\t      echo \"installing $(srcdir)/$$cat as\" \\\n-\t\t   \"$$dir/$(PACKAGE)$(INSTOBJEXT).m\"; \\\n-\t    else \\\n-\t      true; \\\n-\t    fi; \\\n+\t\t \"$(DESTDIR)$$dir/$(PACKAGE).mo\"; \\\n \t  fi; \\\n \tdone\n-\tif test \"$(PACKAGE)\" = \"gettext\"; then \\\n-\t  if test -r \"$(MKINSTALLDIRS)\"; then \\\n-\t    $(MKINSTALLDIRS) $(gettextsrcdir); \\\n-\t  else \\\n-\t    $(SHELL) $(top_srcdir)/mkinstalldirs $(gettextsrcdir); \\\n-\t  fi; \\\n-\t  $(INSTALL_DATA) $(srcdir)/Makefile.in.in \\\n-\t\t\t  $(gettextsrcdir)/Makefile.in.in; \\\n-\telse \\\n-\t  : ; \\\n-\tfi\n \n # Define this as empty until I found a useful application.\n installcheck:\n@@ -176,77 +126,68 @@ uninstall:\n \tcatalogs='$(CATALOGS)'; \\\n \tfor cat in $$catalogs; do \\\n \t  cat=`basename $$cat`; \\\n-\t  lang=`echo $$cat | sed 's/\\$(CATOBJEXT)$$//'`; \\\n-\t  rm -f $(localedir)/$$lang/LC_MESSAGES/$(PACKAGE)$(INSTOBJEXT); \\\n-\t  rm -f $(localedir)/$$lang/LC_MESSAGES/$(PACKAGE)$(INSTOBJEXT).m; \\\n-\t  rm -f $(gnulocaledir)/$$lang/LC_MESSAGES/$(PACKAGE)$(INSTOBJEXT); \\\n-\t  rm -f $(gnulocaledir)/$$lang/LC_MESSAGES/$(PACKAGE)$(INSTOBJEXT).m; \\\n+\t  lang=`echo $$cat | sed 's/\\.gmo$$//'`; \\\n+\t  rm -f $(DESTDIR)$(localedir)/$$lang/LC_MESSAGES/$(PACKAGE).mo; \\\n \tdone\n-\trm -f $(gettextsrcdir)/po-Makefile.in.in\n+\tif test \"$(PACKAGE)\" = \"gettext\"; then \\\n+\t  rm -f $(DESTDIR)$(gettextsrcdir)/Makefile.in.in; \\\n+\telse \\\n+\t  : ; \\\n+\tfi\n \n check: all\n \n-cat-id-tbl.o: $(srcdir)/cat-id-tbl.c $(top_srcdir)/intl/libgettext.h\n-\t$(COMPILE) $(srcdir)/cat-id-tbl.c\n-\n dvi info tags TAGS ID:\n \n mostlyclean:\n-\trm -f core core.* *.pox $(PACKAGE).po *.old.po cat-id-tbl.tmp\n-\trm -fr *.o stamp-check-pot\n+\trm -f core core.* *.pox $(PACKAGE).po *.new.po\n+\trm -fr *.o\n \n clean: mostlyclean\n \n distclean: clean\n-\trm -f Makefile Makefile.in POTFILES *.mo *.gmo *.msg *.cat *.cat.m\n+\trm -f Makefile Makefile.in POTFILES *.mo\n \n maintainer-clean: distclean\n \t@echo \"This command is intended for maintainers to use;\"\n \t@echo \"it deletes files that may require special tools to rebuild.\"\n-\trm -f $(GMOFILES) cat-id-tbl.c stamp-cat-id\n-\n-distdir = ../$(PACKAGE)-$(VERSION)/$(subdir)\n-dist distdir: update-po $(DISTFILES)\n+\trm -f $(GMOFILES)\n+\n+distdir = $(top_builddir)/$(PACKAGE)-$(VERSION)/$(subdir)\n+dist distdir:\n+\t$(MAKE) update-po\n+\t@$(MAKE) dist2\n+# This is a separate target because 'update-po' must be executed before.\n+dist2: $(DISTFILES)\n \tdists=\"$(DISTFILES)\"; \\\n \tfor file in $$dists; do \\\n-\t  ln $(srcdir)/$$file $(distdir) 2> /dev/null \\\n-\t    || cp -p $(srcdir)/$$file $(distdir); \\\n+\t  if test -f $$file; then dir=.; else dir=$(srcdir); fi; \\\n+\t  cp -p $$dir/$$file $(distdir); \\\n \tdone\n \n update-po: Makefile\n-\t$(MAKE) $(srcdir)/$(PACKAGE).pot\n-\tPATH=`pwd`/../src:$$PATH; \\\n+\t$(MAKE) $(PACKAGE).pot\n+\tif test \"$(PACKAGE)\" = \"gettext\"; then PATH=`pwd`/../src:$$PATH; fi; \\\n \tcd $(srcdir); \\\n-\tcatalogs='$(CATALOGS)'; \\\n+\tcatalogs='$(GMOFILES)'; \\\n \tfor cat in $$catalogs; do \\\n \t  cat=`basename $$cat`; \\\n-\t  lang=`echo $$cat | sed 's/\\$(CATOBJEXT)$$//'`; \\\n-\t  mv $$lang.po $$lang.old.po; \\\n+\t  lang=`echo $$cat | sed 's/\\.gmo$$//'`; \\\n \t  echo \"$$lang:\"; \\\n-\t  if $(MSGMERGE) $$lang.old.po $(PACKAGE).pot -o $$lang.po; then \\\n-\t    rm -f $$lang.old.po; \\\n+\t  if $(MSGMERGE) $$lang.po $(PACKAGE).pot -o $$lang.new.po; then \\\n+\t    mv -f $$lang.new.po $$lang.po; \\\n \t  else \\\n \t    echo \"msgmerge for $$cat failed!\"; \\\n-\t    rm -f $$lang.po; \\\n-\t    mv $$lang.old.po $$lang.po; \\\n+\t    rm -f $$lang.new.po; \\\n \t  fi; \\\n \tdone\n+\t$(MAKE) update-gmo\n \n-POTFILES: POTFILES.in\n-\t( if test 'x$(srcdir)' != 'x.'; then \\\n-\t    posrcprefix='$(top_srcdir)/'; \\\n-\t  else \\\n-\t    posrcprefix=\"../\"; \\\n-\t  fi; \\\n-\t  rm -f $@-t $@ \\\n-\t    && (sed -e '/^#/d' -e '/^[ \t]*$$/d' \\\n-\t\t    -e \"s@.*@\t$$posrcprefix& \\\\\\\\@\" < $(srcdir)/$@.in \\\n-\t\t| sed -e '$$s/\\\\$$//') > $@-t \\\n-\t    && chmod a-w $@-t \\\n-\t    && mv $@-t $@ )\n-\n-Makefile: Makefile.in.in ../config.status POTFILES\n-\tcd .. \\\n+update-gmo: Makefile $(GMOFILES)\n+\t@:\n+\n+Makefile: Makefile.in.in $(top_builddir)/config.status POTFILES.in\n+\tcd $(top_builddir) \\\n \t  && CONFIG_FILES=$(subdir)/$@.in CONFIG_HEADERS= \\\n \t       $(SHELL) ./config.status\n "}, {"sha": "2a83d27881a82749554fc1de7a41ba3bd94efbf6", "filename": "gcc/po/cat-id-tbl.c", "status": "removed", "additions": 0, "deletions": 3959, "changes": 3959, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7e21622e0e580b065224125cc6085b9f0559293a/gcc%2Fpo%2Fcat-id-tbl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7e21622e0e580b065224125cc6085b9f0559293a/gcc%2Fpo%2Fcat-id-tbl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fpo%2Fcat-id-tbl.c?ref=7e21622e0e580b065224125cc6085b9f0559293a"}, {"sha": "9788f70238c91894045d22366fa941580826c3c1", "filename": "gcc/po/stamp-cat-id", "status": "removed", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7e21622e0e580b065224125cc6085b9f0559293a/gcc%2Fpo%2Fstamp-cat-id", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7e21622e0e580b065224125cc6085b9f0559293a/gcc%2Fpo%2Fstamp-cat-id", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fpo%2Fstamp-cat-id?ref=7e21622e0e580b065224125cc6085b9f0559293a", "patch": "@@ -1 +0,0 @@\n-timestamp"}]}