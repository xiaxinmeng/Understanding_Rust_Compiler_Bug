{"sha": "d2143736bb340bc15421f82fd3cf99d2e06e84a3", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDIxNDM3MzZiYjM0MGJjMTU0MjFmODJmZDNjZjk5ZDJlMDZlODRhMw==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2008-08-02T10:49:51Z"}, "committer": {"name": "Eric Botcazou", "email": "ebotcazou@gcc.gnu.org", "date": "2008-08-02T10:49:51Z"}, "message": "utils2.c (build_binary_op): New case.\n\n\t* gcc-interface/utils2.c (build_binary_op) <PLUS_EXPR, MINUS_EXPR>:\n\tNew case.  Convert BOOLEAN_TYPE operation to the default integer type.\n\nFrom-SVN: r138552", "tree": {"sha": "8df14879b8e45b704c54b737dd398b980efc4aa3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8df14879b8e45b704c54b737dd398b980efc4aa3"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d2143736bb340bc15421f82fd3cf99d2e06e84a3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d2143736bb340bc15421f82fd3cf99d2e06e84a3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d2143736bb340bc15421f82fd3cf99d2e06e84a3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d2143736bb340bc15421f82fd3cf99d2e06e84a3/comments", "author": null, "committer": null, "parents": [{"sha": "c9234c8d54b09ba565fc10cee2f2e230c4f012e2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c9234c8d54b09ba565fc10cee2f2e230c4f012e2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c9234c8d54b09ba565fc10cee2f2e230c4f012e2"}], "stats": {"total": 37, "additions": 36, "deletions": 1}, "files": [{"sha": "ab0d02f1af61dd718d14c86e09ca59fc9af86e14", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d2143736bb340bc15421f82fd3cf99d2e06e84a3/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d2143736bb340bc15421f82fd3cf99d2e06e84a3/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=d2143736bb340bc15421f82fd3cf99d2e06e84a3", "patch": "@@ -1,3 +1,8 @@\n+2008-08-02  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* gcc-interface/utils2.c (build_binary_op) <PLUS_EXPR, MINUS_EXPR>:\n+\tNew case.  Convert BOOLEAN_TYPE operation to the default integer type.\n+\n 2008-08-01  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* gcc-interface/ada-tree.h (DECL_PARM_ALT): Now DECL_PARM_ALT_TYPE."}, {"sha": "d1a6786cd8280a5acbfbf8ff6d0f0ca05e83a7a5", "filename": "gcc/ada/gcc-interface/utils2.c", "status": "modified", "additions": 9, "deletions": 1, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d2143736bb340bc15421f82fd3cf99d2e06e84a3/gcc%2Fada%2Fgcc-interface%2Futils2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d2143736bb340bc15421f82fd3cf99d2e06e84a3/gcc%2Fada%2Fgcc-interface%2Futils2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgcc-interface%2Futils2.c?ref=d2143736bb340bc15421f82fd3cf99d2e06e84a3", "patch": "@@ -986,7 +986,6 @@ build_binary_op (enum tree_code op_code, tree result_type,\n \t outputs.  */\n       if (modulus && integer_pow2p (modulus))\n \tmodulus = NULL_TREE;\n-\n       goto common;\n \n     case COMPLEX_EXPR:\n@@ -1011,6 +1010,15 @@ build_binary_op (enum tree_code op_code, tree result_type,\n       right_operand = convert (sizetype, right_operand);\n       break;\n \n+    case PLUS_EXPR:\n+    case MINUS_EXPR:\n+      /* Avoid doing arithmetics in BOOLEAN_TYPE like the other compilers.\n+\t Contrary to C, Ada doesn't allow arithmetics in Standard.Boolean\n+\t but we can generate addition or subtraction for 'Succ and 'Pred.  */\n+      if (operation_type && TREE_CODE (operation_type) == BOOLEAN_TYPE)\n+\toperation_type = left_base_type = right_base_type = integer_type_node;\n+      goto common;\n+\n     default:\n     common:\n       /* The result type should be the same as the base types of the"}, {"sha": "b9f542a8e7d5bab6fe31d1dec81947ed1a283127", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d2143736bb340bc15421f82fd3cf99d2e06e84a3/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d2143736bb340bc15421f82fd3cf99d2e06e84a3/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=d2143736bb340bc15421f82fd3cf99d2e06e84a3", "patch": "@@ -1,3 +1,7 @@\n+2008-08-02  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* gnat.dg/boolean_expr2.adb: New test.\n+\n 2008-08-01  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR tree-optimization/36991"}, {"sha": "8bdcb84e933a291efa885a187df24d9f195cb321", "filename": "gcc/testsuite/gnat.dg/boolean_expr2.adb", "status": "added", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d2143736bb340bc15421f82fd3cf99d2e06e84a3/gcc%2Ftestsuite%2Fgnat.dg%2Fboolean_expr2.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d2143736bb340bc15421f82fd3cf99d2e06e84a3/gcc%2Ftestsuite%2Fgnat.dg%2Fboolean_expr2.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fboolean_expr2.adb?ref=d2143736bb340bc15421f82fd3cf99d2e06e84a3", "patch": "@@ -0,0 +1,18 @@\n+-- { dg-do run }\n+\n+procedure Boolean_Expr2 is\n+\n+  function Ident_Bool (B : Boolean) return Boolean is\n+  begin\n+    return B;\n+  end;\n+\n+begin\n+  if Boolean'Succ (Ident_Bool(False)) /= True then\n+    raise Program_Error;\n+  end if;\n+\n+  if Boolean'Pred (Ident_Bool(True)) /= False then\n+    raise Program_Error;\n+  end if;\n+end;"}]}