{"sha": "a0c012fda997b1c2c918752f88abec680274ffe8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTBjMDEyZmRhOTk3YjFjMmM5MTg3NTJmODhhYmVjNjgwMjc0ZmZlOA==", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2015-08-03T07:27:40Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2015-08-03T07:27:40Z"}, "message": "gimple-match-head.c (gimple_simplify): For [VEC_]COND_EXPRs on the rhs of assignments first simplify the embedded...\n\n2015-08-03  Richard Biener  <rguenther@suse.de>\n\n\t* gimple-match-head.c (gimple_simplify): For [VEC_]COND_EXPRs\n\ton the rhs of assignments first simplify the embedded\n\tGENERIC condition.\n\nFrom-SVN: r226488", "tree": {"sha": "d17e0b8f222a02d57b025a9a12e6f28e0d14123c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d17e0b8f222a02d57b025a9a12e6f28e0d14123c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a0c012fda997b1c2c918752f88abec680274ffe8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a0c012fda997b1c2c918752f88abec680274ffe8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a0c012fda997b1c2c918752f88abec680274ffe8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a0c012fda997b1c2c918752f88abec680274ffe8/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "52639a61657c667c68a4a3e0656a67ed1a95a9b0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/52639a61657c667c68a4a3e0656a67ed1a95a9b0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/52639a61657c667c68a4a3e0656a67ed1a95a9b0"}], "stats": {"total": 41, "additions": 40, "deletions": 1}, "files": [{"sha": "a1bdecdaa6693b86aa282b46bf819be23fd47132", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a0c012fda997b1c2c918752f88abec680274ffe8/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a0c012fda997b1c2c918752f88abec680274ffe8/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=a0c012fda997b1c2c918752f88abec680274ffe8", "patch": "@@ -1,3 +1,9 @@\n+2015-08-03  Richard Biener  <rguenther@suse.de>\n+\n+\t* gimple-match-head.c (gimple_simplify): For [VEC_]COND_EXPRs\n+\ton the rhs of assignments first simplify the embedded\n+\tGENERIC condition.\n+\n 2015-08-03  Richard Biener  <rguenther@suse.de>\n \n \tPR tree-optimization/66917"}, {"sha": "17bd992614422f4e3d09ba0d9ba3e02a7bf183c2", "filename": "gcc/gimple-match-head.c", "status": "modified", "additions": 34, "deletions": 1, "changes": 35, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a0c012fda997b1c2c918752f88abec680274ffe8/gcc%2Fgimple-match-head.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a0c012fda997b1c2c918752f88abec680274ffe8/gcc%2Fgimple-match-head.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgimple-match-head.c?ref=a0c012fda997b1c2c918752f88abec680274ffe8", "patch": "@@ -660,10 +660,43 @@ gimple_simplify (gimple stmt,\n \t    }\n \t  case GIMPLE_TERNARY_RHS:\n \t    {\n+\t      bool valueized = false;\n \t      tree rhs1 = gimple_assign_rhs1 (stmt);\n+\t      /* If this is a [VEC_]COND_EXPR first try to simplify an\n+\t\t embedded GENERIC condition.  */\n+\t      if (code == COND_EXPR\n+\t\t  || code == VEC_COND_EXPR)\n+\t\t{\n+\t\t  if (COMPARISON_CLASS_P (rhs1))\n+\t\t    {\n+\t\t      tree lhs = TREE_OPERAND (rhs1, 0);\n+\t\t      tree rhs = TREE_OPERAND (rhs1, 1);\n+\t\t      lhs = do_valueize (lhs, top_valueize, valueized);\n+\t\t      rhs = do_valueize (rhs, top_valueize, valueized);\n+\t\t      code_helper rcode2 = TREE_CODE (rhs1);\n+\t\t      tree ops2[3] = {};\n+\t\t      ops2[0] = lhs;\n+\t\t      ops2[1] = rhs;\n+\t\t      if ((gimple_resimplify2 (seq, &rcode2, TREE_TYPE (rhs1),\n+\t\t\t\t\t       ops2, valueize)\n+\t\t\t   || valueized)\n+\t\t\t  && rcode2.is_tree_code ())\n+\t\t\t{\n+\t\t\t  valueized = true;\n+\t\t\t  if (TREE_CODE_CLASS ((enum tree_code)rcode2)\n+\t\t\t      == tcc_comparison)\n+\t\t\t    rhs1 = build2 (rcode2, TREE_TYPE (rhs1),\n+\t\t\t\t\t   ops2[0], ops2[1]);\n+\t\t\t  else if (rcode2 == SSA_NAME\n+\t\t\t\t   || rcode2 == INTEGER_CST)\n+\t\t\t    rhs1 = ops2[0];\n+\t\t\t  else\n+\t\t\t    valueized = false;\n+\t\t\t}\n+\t\t    }\n+\t\t}\n \t      tree rhs2 = gimple_assign_rhs2 (stmt);\n \t      tree rhs3 = gimple_assign_rhs3 (stmt);\n-\t      bool valueized = false;\n \t      rhs1 = do_valueize (rhs1, top_valueize, valueized);\n \t      rhs2 = do_valueize (rhs2, top_valueize, valueized);\n \t      rhs3 = do_valueize (rhs3, top_valueize, valueized);"}]}