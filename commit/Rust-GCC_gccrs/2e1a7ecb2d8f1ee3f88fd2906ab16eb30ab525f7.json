{"sha": "2e1a7ecb2d8f1ee3f88fd2906ab16eb30ab525f7", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MmUxYTdlY2IyZDhmMWVlM2Y4OGZkMjkwNmFiMTZlYjMwYWI1MjVmNw==", "commit": {"author": {"name": "Alexandre Oliva", "email": "aoliva@redhat.com", "date": "2018-03-06T06:24:53Z"}, "committer": {"name": "Alexandre Oliva", "email": "aoliva@gcc.gnu.org", "date": "2018-03-06T06:24:53Z"}, "message": "[PR c++/84593] ice on braced init with uninit ref field\n\nIf an initializer expr is to be NULL in a ctor initializer list, we\nICE in picflag_from_initializer and elsewhere.\n\nIf we're missing an initializer for a reference field, we report the\nerror, but then build a zero initializer to avoid the ICE.\n\nfor  gcc/cp/ChangeLog\n\n\tPR c++/84593\n\t* init.c (build_zero_init_1): Zero-initialize references.\n\nfor  gcc/testsuite/ChangeLog\n\n\tPR c++/84593\n\t* g++.dg/cpp1y/pr84593.C: New.\n\nFrom-SVN: r258270", "tree": {"sha": "5cd37847dde8ab2a0d1d2c4aa83f054104f46fc4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5cd37847dde8ab2a0d1d2c4aa83f054104f46fc4"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2e1a7ecb2d8f1ee3f88fd2906ab16eb30ab525f7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2e1a7ecb2d8f1ee3f88fd2906ab16eb30ab525f7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2e1a7ecb2d8f1ee3f88fd2906ab16eb30ab525f7", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2e1a7ecb2d8f1ee3f88fd2906ab16eb30ab525f7/comments", "author": null, "committer": null, "parents": [{"sha": "1ea71a82f9d42684c542147b231afb63e8a6da8f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1ea71a82f9d42684c542147b231afb63e8a6da8f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1ea71a82f9d42684c542147b231afb63e8a6da8f"}], "stats": {"total": 19, "additions": 18, "deletions": 1}, "files": [{"sha": "3623405ded0cbc350637418d2e6b49a4f55d4896", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2e1a7ecb2d8f1ee3f88fd2906ab16eb30ab525f7/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2e1a7ecb2d8f1ee3f88fd2906ab16eb30ab525f7/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=2e1a7ecb2d8f1ee3f88fd2906ab16eb30ab525f7", "patch": "@@ -1,5 +1,8 @@\n 2018-03-06  Alexandre Oliva <aoliva@redhat.com>\n \n+\tPR c++/84593\n+\t* init.c (build_zero_init_1): Zero-initialize references.\n+\n \tPR c++/84492\n \t* semantics.c (finish_stmt_expr_expr): Reject unresolved\n \toverloads used as stmt expr values."}, {"sha": "15cee17c780c7c60505c4ed6aad8a173f8e3ad6f", "filename": "gcc/cp/init.c", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2e1a7ecb2d8f1ee3f88fd2906ab16eb30ab525f7/gcc%2Fcp%2Finit.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2e1a7ecb2d8f1ee3f88fd2906ab16eb30ab525f7/gcc%2Fcp%2Finit.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Finit.c?ref=2e1a7ecb2d8f1ee3f88fd2906ab16eb30ab525f7", "patch": "@@ -284,7 +284,10 @@ build_zero_init_1 (tree type, tree nelts, bool static_storage_p,\n   else if (VECTOR_TYPE_P (type))\n     init = build_zero_cst (type);\n   else\n-    gcc_assert (TREE_CODE (type) == REFERENCE_TYPE);\n+    {\n+      gcc_assert (TREE_CODE (type) == REFERENCE_TYPE);\n+      init = build_zero_cst (type);\n+    }\n \n   /* In all cases, the initializer is a constant.  */\n   if (init)"}, {"sha": "9c94d3666466bf42470ed0b48e5e84d30449f2cb", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2e1a7ecb2d8f1ee3f88fd2906ab16eb30ab525f7/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2e1a7ecb2d8f1ee3f88fd2906ab16eb30ab525f7/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=2e1a7ecb2d8f1ee3f88fd2906ab16eb30ab525f7", "patch": "@@ -1,5 +1,8 @@\n 2018-03-06  Alexandre Oliva <aoliva@redhat.com>\n \n+\tPR c++/84593\n+\t* g++.dg/cpp1y/pr84593.C: New.\n+\n \tPR c++/84492\n \t* g++.dg/pr84492.C: New.\n "}, {"sha": "8aa869f1919301f8512a477b1348792475f033ba", "filename": "gcc/testsuite/g++.dg/cpp1y/pr84593.C", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2e1a7ecb2d8f1ee3f88fd2906ab16eb30ab525f7/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1y%2Fpr84593.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2e1a7ecb2d8f1ee3f88fd2906ab16eb30ab525f7/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1y%2Fpr84593.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1y%2Fpr84593.C?ref=2e1a7ecb2d8f1ee3f88fd2906ab16eb30ab525f7", "patch": "@@ -0,0 +1,8 @@\n+// PR c++/84593\n+// { dg-do compile { target c++14 } }\n+\n+struct a {\n+  int x;\n+  int c = 0;\n+  int &b;\n+} c = {}; // { dg-error \"uninitialized reference\" }"}]}