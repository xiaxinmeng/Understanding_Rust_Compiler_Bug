{"sha": "8b9cf39ead77e1ce8683f57e4416b196c58f5c10", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OGI5Y2YzOWVhZDc3ZTFjZTg2ODNmNTdlNDQxNmIxOTZjNThmNWMxMA==", "commit": {"author": {"name": "Alexandre Oliva", "email": "aoliva@redhat.com", "date": "2007-03-08T11:06:41Z"}, "committer": {"name": "Alexandre Oliva", "email": "aoliva@gcc.gnu.org", "date": "2007-03-08T11:06:41Z"}, "message": "ffi.c (flush_icache): Fix left-over from previous patch.\n\n* src/powerpc/ffi.c (flush_icache): Fix left-over from previous\npatch.\n(ffi_prep_closure_loc): Remove unneeded casts.  Add needed ones.\n\nFrom-SVN: r122692", "tree": {"sha": "b592b37e724ff1196d0b6c3ec8438f049158ed0a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b592b37e724ff1196d0b6c3ec8438f049158ed0a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8b9cf39ead77e1ce8683f57e4416b196c58f5c10", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8b9cf39ead77e1ce8683f57e4416b196c58f5c10", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8b9cf39ead77e1ce8683f57e4416b196c58f5c10", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8b9cf39ead77e1ce8683f57e4416b196c58f5c10/comments", "author": null, "committer": null, "parents": [{"sha": "068c623d02d839451272da894912b6ac6e42d85c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/068c623d02d839451272da894912b6ac6e42d85c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/068c623d02d839451272da894912b6ac6e42d85c"}], "stats": {"total": 19, "additions": 11, "deletions": 8}, "files": [{"sha": "ecd75cf978a5297cd24c4b5340c26d2e2b58864b", "filename": "libffi/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8b9cf39ead77e1ce8683f57e4416b196c58f5c10/libffi%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8b9cf39ead77e1ce8683f57e4416b196c58f5c10/libffi%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2FChangeLog?ref=8b9cf39ead77e1ce8683f57e4416b196c58f5c10", "patch": "@@ -1,3 +1,9 @@\n+2007-03-08  Alexandre Oliva  <aoliva@redhat.com>\n+\n+\t* src/powerpc/ffi.c (flush_icache): Fix left-over from previous\n+\tpatch.\n+\t(ffi_prep_closure_loc): Remove unneeded casts.  Add needed ones.\n+\n 2007-03-07  Alexandre Oliva  <aoliva@redhat.com>\n \n \t* include/ffi.h.in (ffi_closure_alloc, ffi_closure_free): New."}, {"sha": "fe5550d5889fcc698bddd7bbaac0299ab2387d85", "filename": "libffi/src/powerpc/ffi.c", "status": "modified", "additions": 5, "deletions": 8, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8b9cf39ead77e1ce8683f57e4416b196c58f5c10/libffi%2Fsrc%2Fpowerpc%2Fffi.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8b9cf39ead77e1ce8683f57e4416b196c58f5c10/libffi%2Fsrc%2Fpowerpc%2Fffi.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2Fsrc%2Fpowerpc%2Fffi.c?ref=8b9cf39ead77e1ce8683f57e4416b196c58f5c10", "patch": "@@ -839,11 +839,8 @@ flush_icache (char *wraddr, char *xaddr, int size)\n {\n   int i;\n   for (i = 0; i < size; i += MIN_CACHE_LINE_SIZE)\n-    {\n-      addr = addr1 + i;\n-      __asm__ volatile (\"icbi 0,%0;\" \"dcbf 0,%1;\"\n-\t\t\t: : \"r\" (xaddr + i), \"r\" (wraddr + i) : \"memory\");\n-    }\n+    __asm__ volatile (\"icbi 0,%0;\" \"dcbf 0,%1;\"\n+\t\t      : : \"r\" (xaddr + i), \"r\" (wraddr + i) : \"memory\");\n   __asm__ volatile (\"icbi 0,%0;\" \"dcbf 0,%1;\" \"sync;\" \"isync;\"\n \t\t    : : \"r\"(xaddr + size - 1), \"r\"(wraddr + size - 1)\n \t\t    : \"memory\");\n@@ -863,7 +860,7 @@ ffi_prep_closure_loc (ffi_closure *closure,\n   FFI_ASSERT (cif->abi == FFI_LINUX64);\n   /* Copy function address and TOC from ffi_closure_LINUX64.  */\n   memcpy (tramp, (char *) ffi_closure_LINUX64, 16);\n-  tramp[2] = (void *) codeloc;\n+  tramp[2] = codeloc;\n #else\n   unsigned int *tramp;\n \n@@ -879,10 +876,10 @@ ffi_prep_closure_loc (ffi_closure *closure,\n   tramp[8] = 0x7c0903a6;  /*   mtctr   r0 */\n   tramp[9] = 0x4e800420;  /*   bctr */\n   *(void **) &tramp[2] = (void *) ffi_closure_SYSV; /* function */\n-  *(void **) &tramp[3] = (void *) codeloc;          /* context */\n+  *(void **) &tramp[3] = codeloc;                   /* context */\n \n   /* Flush the icache.  */\n-  flush_icache (tramp, codeloc, FFI_TRAMPOLINE_SIZE);\n+  flush_icache ((char *)tramp, (char *)codeloc, FFI_TRAMPOLINE_SIZE);\n #endif\n \n   closure->cif = cif;"}]}