{"sha": "b7933c21dc753dad1f064de767011aa792fe4879", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Yjc5MzNjMjFkYzc1M2RhZDFmMDY0ZGU3NjcwMTFhYTc5MmZlNDg3OQ==", "commit": {"author": {"name": "Bernd Schmidt", "email": "bernds@redhat.com", "date": "2001-08-08T10:00:56Z"}, "committer": {"name": "Bernd Schmidt", "email": "bernds@gcc.gnu.org", "date": "2001-08-08T10:00:56Z"}, "message": "Make cselib COND_EXEC-safe\n\nFrom-SVN: r44713", "tree": {"sha": "f14bfed275a2a46078d991657d01af4f93a790ef", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f14bfed275a2a46078d991657d01af4f93a790ef"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b7933c21dc753dad1f064de767011aa792fe4879", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b7933c21dc753dad1f064de767011aa792fe4879", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b7933c21dc753dad1f064de767011aa792fe4879", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b7933c21dc753dad1f064de767011aa792fe4879/comments", "author": null, "committer": null, "parents": [{"sha": "674fc07da0975c21f24b71915d5cc6f3015e8feb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/674fc07da0975c21f24b71915d5cc6f3015e8feb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/674fc07da0975c21f24b71915d5cc6f3015e8feb"}], "stats": {"total": 15, "additions": 15, "deletions": 0}, "files": [{"sha": "fdc4d58430c72a6238a8d4448c055bed7f913558", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b7933c21dc753dad1f064de767011aa792fe4879/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b7933c21dc753dad1f064de767011aa792fe4879/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=b7933c21dc753dad1f064de767011aa792fe4879", "patch": "@@ -1,3 +1,8 @@\n+2001-08-08  Bernd Schmidt  <bernds@redhat.com>\n+\n+\t* cselib.c (cselib_record_sets): If insn is predicated, turn\n+\tsources into IF_THEN_ELSEs.\n+\t\t\n 2001-08-08  Graham Stott  <grahams@redhat.com>\n \n \t* final.c (shorten_branches): Update the INSN_ADDRESSES of insns"}, {"sha": "1311766800635d1ad7ff4cb7080f8a4c0936b32e", "filename": "gcc/cselib.c", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b7933c21dc753dad1f064de767011aa792fe4879/gcc%2Fcselib.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b7933c21dc753dad1f064de767011aa792fe4879/gcc%2Fcselib.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcselib.c?ref=b7933c21dc753dad1f064de767011aa792fe4879", "patch": "@@ -1179,8 +1179,15 @@ cselib_record_sets (insn)\n   int i;\n   struct set sets[MAX_SETS];\n   rtx body = PATTERN (insn);\n+  rtx cond = 0;\n \n   body = PATTERN (insn);\n+  if (GET_CODE (body) == COND_EXEC)\n+    {\n+      cond = COND_EXEC_TEST (body);\n+      body = COND_EXEC_CODE (body);\n+    }\n+\n   /* Find all sets.  */\n   if (GET_CODE (body) == SET)\n     {\n@@ -1219,6 +1226,9 @@ cselib_record_sets (insn)\n       /* We don't know how to record anything but REG or MEM.  */\n       if (GET_CODE (dest) == REG || GET_CODE (dest) == MEM)\n         {\n+\t  rtx src = sets[i].src;\n+\t  if (cond)\n+\t    src = gen_rtx_IF_THEN_ELSE (GET_MODE (src), cond, src, dest);\n \t  sets[i].src_elt = cselib_lookup (sets[i].src, GET_MODE (dest), 1);\n \t  if (GET_CODE (dest) == MEM)\n \t    sets[i].dest_addr_elt = cselib_lookup (XEXP (dest, 0), Pmode, 1);"}]}