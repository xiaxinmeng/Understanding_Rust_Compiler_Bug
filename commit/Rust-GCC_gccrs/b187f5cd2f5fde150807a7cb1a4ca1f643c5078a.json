{"sha": "b187f5cd2f5fde150807a7cb1a4ca1f643c5078a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjE4N2Y1Y2QyZjVmZGUxNTA4MDdhN2NiMWE0Y2ExZjY0M2M1MDc4YQ==", "commit": {"author": {"name": "Danny Smith", "email": "dannysmith@users.sourceforge.net", "date": "2007-05-07T17:41:35Z"}, "committer": {"name": "Nathan Froyd", "email": "froydnj@gcc.gnu.org", "date": "2007-05-07T17:41:35Z"}, "message": "re PR c/22133 (In MinGW trailing slash forward not allowed in include path)\n\n\tPR 22133\n\t* c-incpath.c (add_path): Strip trailing path separators.\n\nFrom-SVN: r124504", "tree": {"sha": "3f044510a027e38840560b295eb6e6826efff490", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3f044510a027e38840560b295eb6e6826efff490"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b187f5cd2f5fde150807a7cb1a4ca1f643c5078a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b187f5cd2f5fde150807a7cb1a4ca1f643c5078a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b187f5cd2f5fde150807a7cb1a4ca1f643c5078a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b187f5cd2f5fde150807a7cb1a4ca1f643c5078a/comments", "author": null, "committer": null, "parents": [{"sha": "ce2e63495d2873df275a1e38015d0b838e50a75b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ce2e63495d2873df275a1e38015d0b838e50a75b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ce2e63495d2873df275a1e38015d0b838e50a75b"}], "stats": {"total": 25, "additions": 18, "deletions": 7}, "files": [{"sha": "df4aa2f550861d266ef6fe8c0513bbc92c28aff4", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b187f5cd2f5fde150807a7cb1a4ca1f643c5078a/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b187f5cd2f5fde150807a7cb1a4ca1f643c5078a/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=b187f5cd2f5fde150807a7cb1a4ca1f643c5078a", "patch": "@@ -1,3 +1,9 @@\n+2007-05-07  Danny Smith  <dannysmith@users.sourceforge.net>\n+\t    Nathan Froyd  <froydnj@codesourcery.com\n+\n+\tPR 22133\n+\t* c-incpath.c (add_path): Strip trailing path separators.\n+\n 2007-05-07  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* tree-ssa-dom.c (tree_ssa_dominator_optimize): Reset cfg_altered."}, {"sha": "8b6512c8e0f082ef70e9b70faf760af0939674a3", "filename": "gcc/c-incpath.c", "status": "modified", "additions": 12, "deletions": 7, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b187f5cd2f5fde150807a7cb1a4ca1f643c5078a/gcc%2Fc-incpath.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b187f5cd2f5fde150807a7cb1a4ca1f643c5078a/gcc%2Fc-incpath.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-incpath.c?ref=b187f5cd2f5fde150807a7cb1a4ca1f643c5078a", "patch": "@@ -389,13 +389,18 @@ add_path (char *path, int chain, int cxx_aware, bool user_supplied_p)\n   cpp_dir *p;\n \n #if defined (HAVE_DOS_BASED_FILE_SYSTEM)\n-  /* Convert all backslashes to slashes.  The native CRT stat()\n-     function does not recognize a directory that ends in a backslash\n-     (unless it is a drive root dir, such \"c:\\\").  Forward slashes,\n-     trailing or otherwise, cause no problems for stat().  */\n-  char* c;\n-  for (c = path; *c; c++)\n-    if (*c == '\\\\') *c = '/';\n+  /* Remove unnecessary trailing slashes.  On some versions of MS\n+     Windows, trailing  _forward_ slashes cause no problems for stat().\n+     On newer versions, stat() does not recognise a directory that ends\n+     in a '\\\\' or '/', unless it is a drive root dir, such as \"c:/\",\n+     where it is obligatory.  */\n+  int pathlen = strlen (path);\n+  char* end = path + pathlen - 1;\n+  /* Preserve the lead '/' or lead \"c:/\".  */\n+  char* start = path + (pathlen > 2 && path[1] == ':' ? 3 : 1);\n+  \n+  for (; end > start && IS_DIR_SEPARATOR (*end); end--)\n+    *end = 0;\n #endif\n \n   p = XNEW (cpp_dir);"}]}