{"sha": "6d34654c1db34a15ee8a3cc555ad0a9b78b5d4f7", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NmQzNDY1NGMxZGIzNGExNWVlOGEzY2M1NTVhZDBhOWI3OGI1ZDRmNw==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2005-05-03T13:09:53Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2005-05-03T13:09:53Z"}, "message": "re PR rtl-optimization/21330 (ICE in compare_and_jump_seq, at loop-unswitch.c:120)\n\n\tPR rtl-optimization/21330\n\t* loop-unswitch.c (may_unswitch_on): Set *cinsn only when\n\treturning non-NULL.\n\t(unswitch_single_loop): Clear cinsn when retrying.\n\n\t* gcc.c-torture/execute/20050502-1.c: New test.\n\nFrom-SVN: r99157", "tree": {"sha": "8e03493902a4c01b604c9731181fe877f4a8310e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8e03493902a4c01b604c9731181fe877f4a8310e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6d34654c1db34a15ee8a3cc555ad0a9b78b5d4f7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6d34654c1db34a15ee8a3cc555ad0a9b78b5d4f7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6d34654c1db34a15ee8a3cc555ad0a9b78b5d4f7", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6d34654c1db34a15ee8a3cc555ad0a9b78b5d4f7/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "85b583d30a6f23f17bddcabfd700239ca9e10299", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/85b583d30a6f23f17bddcabfd700239ca9e10299", "html_url": "https://github.com/Rust-GCC/gccrs/commit/85b583d30a6f23f17bddcabfd700239ca9e10299"}], "stats": {"total": 80, "additions": 78, "deletions": 2}, "files": [{"sha": "285cb00644836c9a03f25713b612fac196b7ac3e", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6d34654c1db34a15ee8a3cc555ad0a9b78b5d4f7/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6d34654c1db34a15ee8a3cc555ad0a9b78b5d4f7/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=6d34654c1db34a15ee8a3cc555ad0a9b78b5d4f7", "patch": "@@ -1,5 +1,10 @@\n 2005-05-03  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR rtl-optimization/21330\n+\t* loop-unswitch.c (may_unswitch_on): Set *cinsn only when\n+\treturning non-NULL.\n+\t(unswitch_single_loop): Clear cinsn when retrying.\n+\n \tPR target/21297\n \t* config/i386/i386.c (legitimize_address): When canonicalizing\n \tASHIFT into MULT, multiply by 1 << shift_count instead of"}, {"sha": "ef4e5b8c2d429d93fb515fe2608def3db4276b91", "filename": "gcc/loop-unswitch.c", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6d34654c1db34a15ee8a3cc555ad0a9b78b5d4f7/gcc%2Floop-unswitch.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6d34654c1db34a15ee8a3cc555ad0a9b78b5d4f7/gcc%2Floop-unswitch.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Floop-unswitch.c?ref=6d34654c1db34a15ee8a3cc555ad0a9b78b5d4f7", "patch": "@@ -223,11 +223,11 @@ may_unswitch_on (basic_block bb, struct loop *loop, rtx *cinsn)\n       if (at != BB_END (bb))\n \treturn NULL_RTX;\n \n-      *cinsn = BB_END (bb);\n       if (!rtx_equal_p (op[0], XEXP (test, 0))\n \t  || !rtx_equal_p (op[1], XEXP (test, 1)))\n \treturn NULL_RTX;\n \n+      *cinsn = BB_END (bb);\n       return test;\n     }\n \n@@ -266,7 +266,7 @@ unswitch_single_loop (struct loops *loops, struct loop *loop,\n   basic_block *bbs;\n   struct loop *nloop;\n   unsigned i;\n-  rtx cond, rcond = NULL_RTX, conds, rconds, acond, cinsn = NULL_RTX;\n+  rtx cond, rcond = NULL_RTX, conds, rconds, acond, cinsn;\n   int repeat;\n   edge e;\n \n@@ -321,6 +321,7 @@ unswitch_single_loop (struct loops *loops, struct loop *loop,\n   do\n     {\n       repeat = 0;\n+      cinsn = NULL_RTX;\n \n       /* Find a bb to unswitch on.  */\n       bbs = get_loop_body (loop);"}, {"sha": "41fd4985d13aba04cc22237e63d5dfd4c61f3fbb", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6d34654c1db34a15ee8a3cc555ad0a9b78b5d4f7/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6d34654c1db34a15ee8a3cc555ad0a9b78b5d4f7/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=6d34654c1db34a15ee8a3cc555ad0a9b78b5d4f7", "patch": "@@ -1,5 +1,8 @@\n 2005-05-03  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR rtl-optimization/21330\n+\t* gcc.c-torture/execute/20050502-1.c: New test.\n+\n \tPR target/21297\n \t* gcc.c-torture/execute/20050502-2.c: New test.\n "}, {"sha": "331fe5ff79767358cd94d0bb54919a9b113dae9f", "filename": "gcc/testsuite/gcc.c-torture/execute/20050502-1.c", "status": "added", "additions": 67, "deletions": 0, "changes": 67, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6d34654c1db34a15ee8a3cc555ad0a9b78b5d4f7/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2F20050502-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6d34654c1db34a15ee8a3cc555ad0a9b78b5d4f7/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2F20050502-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2F20050502-1.c?ref=6d34654c1db34a15ee8a3cc555ad0a9b78b5d4f7", "patch": "@@ -0,0 +1,67 @@\n+/* PR rtl-optimization/21330 */\n+\n+extern void abort (void);\n+extern int strcmp (const char *, const char *);\n+\n+int\n+__attribute__((noinline))\n+bar (const char **x)\n+{\n+  return *(*x)++;\n+}\n+\n+int\n+__attribute__((noinline))\n+baz (int c)\n+{\n+  return c != '@';\n+}\n+\n+void\n+__attribute__((noinline))\n+foo (const char **w, char *x, _Bool y, _Bool z)\n+{\n+  char c = bar (w);\n+  int i = 0;\n+\n+  while (1)\n+    {\n+      x[i++] = c;\n+      c = bar (w);\n+      if (y && c == '\\'')\n+        break;\n+      if (z && c == '\\\"')\n+        break;\n+      if (!y && !z && !baz (c))\n+        break;\n+    }\n+   x[i] = 0;\n+}\n+\n+int\n+main (void)\n+{\n+  char buf[64];\n+  const char *p;\n+  p = \"abcde'fgh\";\n+  foo (&p, buf, 1, 0);\n+  if (strcmp (p, \"fgh\") != 0 || strcmp (buf, \"abcde\") != 0)\n+    abort ();\n+  p = \"ABCDEFG\\\"HI\";\n+  foo (&p, buf, 0, 1);\n+  if (strcmp (p, \"HI\") != 0 || strcmp (buf, \"ABCDEFG\") != 0)\n+    abort ();\n+  p = \"abcd\\\"e'fgh\";\n+  foo (&p, buf, 1, 1);\n+  if (strcmp (p, \"e'fgh\") != 0 || strcmp (buf, \"abcd\") != 0)\n+    abort ();\n+  p = \"ABCDEF'G\\\"HI\";\n+  foo (&p, buf, 1, 1);\n+  if (strcmp (p, \"G\\\"HI\") != 0 || strcmp (buf, \"ABCDEF\") != 0)\n+    abort ();\n+  p = \"abcdef@gh\";\n+  foo (&p, buf, 0, 0);\n+  if (strcmp (p, \"gh\") != 0 || strcmp (buf, \"abcdef\") != 0)\n+    abort ();\n+  return 0;\n+}"}]}