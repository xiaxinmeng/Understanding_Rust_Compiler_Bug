{"sha": "a48ebb565014a55e24b4ef316a7942591c650ef0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTQ4ZWJiNTY1MDE0YTU1ZTI0YjRlZjMxNmE3OTQyNTkxYzY1MGVmMA==", "commit": {"author": {"name": "Brendan Kehoe", "email": "brendan@cygnus.com", "date": "1998-06-29T13:39:23Z"}, "committer": {"name": "Brendan Kehoe", "email": "brendan@gcc.gnu.org", "date": "1998-06-29T13:39:23Z"}, "message": "tree.c (build_srcloc): Make sure we allocate this node on the permanent obstack.\n\n\t* tree.c (build_srcloc): Make sure we allocate this node on the\n\tpermanent obstack.\nfixes OSE compilation failures\n\nFrom-SVN: r20793", "tree": {"sha": "2a5be443d807c9fd68297089687a1de4c6e3a7e5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2a5be443d807c9fd68297089687a1de4c6e3a7e5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a48ebb565014a55e24b4ef316a7942591c650ef0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a48ebb565014a55e24b4ef316a7942591c650ef0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a48ebb565014a55e24b4ef316a7942591c650ef0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a48ebb565014a55e24b4ef316a7942591c650ef0/comments", "author": null, "committer": null, "parents": [{"sha": "cb6abb6fd58d5742111273a5fe5de2b0b25d7f7c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cb6abb6fd58d5742111273a5fe5de2b0b25d7f7c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cb6abb6fd58d5742111273a5fe5de2b0b25d7f7c"}], "stats": {"total": 25, "additions": 24, "deletions": 1}, "files": [{"sha": "edc78a5cbed3d29383d7d29d7233e8b86b2f3f84", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a48ebb565014a55e24b4ef316a7942591c650ef0/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a48ebb565014a55e24b4ef316a7942591c650ef0/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=a48ebb565014a55e24b4ef316a7942591c650ef0", "patch": "@@ -1,3 +1,8 @@\n+1998-06-29  Brendan Kehoe  <brendan@cygnus.com>\n+\n+\t* tree.c (build_srcloc): Make sure we allocate this node on the\n+\tpermanent obstack.\n+\n Sat Jun 27 23:34:18 1998  Fred Fish  <fnf@ninemoons.com>\n \n \t* g++spec.c (NEED_MATH_LIBRARY): Define to 1 if not already defined."}, {"sha": "952da29a12ae248531cf8655ca885b7a35e48b22", "filename": "gcc/cp/tree.c", "status": "modified", "additions": 19, "deletions": 1, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a48ebb565014a55e24b4ef316a7942591c650ef0/gcc%2Fcp%2Ftree.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a48ebb565014a55e24b4ef316a7942591c650ef0/gcc%2Fcp%2Ftree.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ftree.c?ref=a48ebb565014a55e24b4ef316a7942591c650ef0", "patch": "@@ -211,6 +211,12 @@ lvalue_p (ref)\n       return (lvalue_p (TREE_OPERAND (ref, 0))\n \t      && lvalue_p (TREE_OPERAND (ref, 1)));\n \n+    case NOP_EXPR:\n+      /* GNU extension:\n+\t A cast is a valid lvalue if its operand is an lvalue. */\n+      if (! pedantic)\n+\treturn lvalue_p (TREE_OPERAND (ref, 0));\n+\n     default:\n       break;\n     }\n@@ -2300,9 +2306,21 @@ build_srcloc (file, line)\n      char *file;\n      int line;\n {\n-  tree t = make_node (SRCLOC);\n+  tree t;\n+\n+  /* Make sure that we put these on the permanent obstack; up in\n+     add_pending_template, we pass this return value into perm_tree_cons,\n+     which also puts it on the permanent_obstack.  However, this wasn't\n+     explicitly doing the same.  */\n+  register struct obstack *ambient_obstack = current_obstack;\n+  current_obstack = &permanent_obstack;\n+\n+  t = make_node (SRCLOC);\n   SRCLOC_FILE (t) = file;\n   SRCLOC_LINE (t) = line;\n+\n+  current_obstack = ambient_obstack;\n+\n   return t;\n }\n "}]}