{"sha": "607adf67a0b885a747fcc6995f8545a26f006661", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjA3YWRmNjdhMGI4ODVhNzQ3ZmNjNjk5NWY4NTQ1YTI2ZjAwNjY2MQ==", "commit": {"author": {"name": "Bryce McKinlay", "email": "bryce@albatross.co.nz", "date": "2001-01-17T10:22:33Z"}, "committer": {"name": "Bryce McKinlay", "email": "bryce@gcc.gnu.org", "date": "2001-01-17T10:22:33Z"}, "message": "Class.h (isInterface): Move implementation from natClass.cc.\n\n\t* java/lang/Class.h (isInterface): Move implementation from\n\tnatClass.cc. Declare inline.\n\t(Class): Add default constructor.\n\t* java/lang/Object.h: Update comments.\n\t* java/lang/natClass.cc (initializeClass): Use _Jv_InitClass to\n\tinitialize superclass, saving a call if super is already initialized.\n\nFrom-SVN: r39091", "tree": {"sha": "611e7282c479126e4aaf4a31ed1c07a8bd3e6df8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/611e7282c479126e4aaf4a31ed1c07a8bd3e6df8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/607adf67a0b885a747fcc6995f8545a26f006661", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/607adf67a0b885a747fcc6995f8545a26f006661", "html_url": "https://github.com/Rust-GCC/gccrs/commit/607adf67a0b885a747fcc6995f8545a26f006661", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/607adf67a0b885a747fcc6995f8545a26f006661/comments", "author": null, "committer": null, "parents": [{"sha": "61a24907052a2cdcf421ff28fa91a47668c9d300", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/61a24907052a2cdcf421ff28fa91a47668c9d300", "html_url": "https://github.com/Rust-GCC/gccrs/commit/61a24907052a2cdcf421ff28fa91a47668c9d300"}], "stats": {"total": 35, "additions": 22, "deletions": 13}, "files": [{"sha": "ef40057f1570c8859999455916dd35522191cec1", "filename": "libjava/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/607adf67a0b885a747fcc6995f8545a26f006661/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/607adf67a0b885a747fcc6995f8545a26f006661/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=607adf67a0b885a747fcc6995f8545a26f006661", "patch": "@@ -1,3 +1,12 @@\n+2001-01-17  Bryce McKinlay  <bryce@albatross.co.nz>\n+\n+\t* java/lang/Class.h (isInterface): Move implementation from \n+\tnatClass.cc. Declare inline.\n+\t(Class): Add default constructor.\n+\t* java/lang/Object.h: Update comments.\n+\t* java/lang/natClass.cc (initializeClass): Use _Jv_InitClass to\n+\tinitialize superclass, saving a call if super is already initialized.\n+\n 2001-01-16  Alexandre Petit-Bianco  <apbianco@cygnus.com>\n \n \t* prims.cc (init_prim_class): Deleted."}, {"sha": "9736b78829b4c806dc0fed9461a4396ea76d6b29", "filename": "libjava/java/lang/Class.h", "status": "modified", "additions": 9, "deletions": 7, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/607adf67a0b885a747fcc6995f8545a26f006661/libjava%2Fjava%2Flang%2FClass.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/607adf67a0b885a747fcc6995f8545a26f006661/libjava%2Fjava%2Flang%2FClass.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjava%2Flang%2FClass.h?ref=607adf67a0b885a747fcc6995f8545a26f006661", "patch": "@@ -174,7 +174,8 @@ class java::lang::Class : public java::lang::Object\n \n   jboolean isAssignableFrom (jclass cls);\n   jboolean isInstance (jobject obj);\n-  jboolean isInterface (void)\n+\n+  inline jboolean isInterface (void)\n   {\n     return (accflags & java::lang::reflect::Modifier::INTERFACE) != 0;\n   }\n@@ -196,16 +197,17 @@ class java::lang::Class : public java::lang::Object\n   // finalization\n   void finalize ();\n \n+  Class () {};\n+\n   // This constructor is used to create Class object for the primitive\n-  // types.\n-  Class (jobject cname, jbyte sig, jint len, jobject array_vtable) {\n-    \n+  // types. See prims.cc.\n+  Class (jobject cname, jbyte sig, jint len, jobject array_vtable)\n+  {    \n     using namespace java::lang::reflect;\n     _Jv_Utf8Const *_Jv_makeUtf8Const (char *s, int len);\n \n-    // C++ ctors are fixing the vtbl in a way that doesn't fit Java.\n-    // We can fix the C++ compiler, or we can hack our runtime. What's\n-    // below fix the vtable so that it starts at -2.\n+    // C++ ctors set the vtbl pointer to point at an offset inside the vtable\n+    // object. That doesn't work for Java, so this hack adjusts it back.\n     void *p =  ((void **)this)[0];\n     ((void **)this)[0] = (void *)((char *)p-2*sizeof (void *));\n "}, {"sha": "352d48b501d0cfb01ef9de257c05bf7b61e20f76", "filename": "libjava/java/lang/Object.h", "status": "modified", "additions": 3, "deletions": 5, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/607adf67a0b885a747fcc6995f8545a26f006661/libjava%2Fjava%2Flang%2FObject.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/607adf67a0b885a747fcc6995f8545a26f006661/libjava%2Fjava%2Flang%2FObject.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjava%2Flang%2FObject.h?ref=607adf67a0b885a747fcc6995f8545a26f006661", "patch": "@@ -16,15 +16,13 @@ details.  */\n #include <gcj/javaprims.h>\n \n // This class is mainly here as a kludge to get G++ to allocate two\n-// extra entries in the vtable. We will use them to store data.  This\n-// allows us to support the new C++ ABI.\n-\n+// extra entries in each vtable.\n struct _JvObjectPrefix\n {\n protected:\n   // New ABI Compatibility Dummy, #1 and 2.\n-  virtual void nacd_1 (void) {};\n-  virtual void nacd_2 (void) {};\n+  virtual void nacd_1 (void) {};  // This slot really contains the Class pointer.\n+  virtual void nacd_2 (void) {};  // Actually the GC bitmap marking descriptor.\n };\n \n class java::lang::Object : public _JvObjectPrefix"}, {"sha": "9a97411d0a89897c887fb022744da99d90ac0f8f", "filename": "libjava/java/lang/natClass.cc", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/607adf67a0b885a747fcc6995f8545a26f006661/libjava%2Fjava%2Flang%2FnatClass.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/607adf67a0b885a747fcc6995f8545a26f006661/libjava%2Fjava%2Flang%2FnatClass.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjava%2Flang%2FnatClass.cc?ref=607adf67a0b885a747fcc6995f8545a26f006661", "patch": "@@ -732,7 +732,7 @@ java::lang::Class::initializeClass (void)\n     {\n       try\n \t{\n-\t  superclass->initializeClass ();\n+\t  _Jv_InitClass (superclass);\n \t}\n       catch (java::lang::Throwable *except)\n \t{"}]}