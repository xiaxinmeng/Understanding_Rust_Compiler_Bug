{"sha": "4bd3809078fee7f16cefac724db4439c75c2b74f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NGJkMzgwOTA3OGZlZTdmMTZjZWZhYzcyNGRiNDQzOWM3NWMyYjc0Zg==", "commit": {"author": {"name": "Arnaud Charlet", "email": "charlet@adacore.com", "date": "2017-09-08T12:35:58Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2017-09-08T12:35:58Z"}, "message": "conf.py, [...]: Improve support for Ada highlighting.\n\n        * doc/share/conf.py, doc/share/latex_elements.py,\n        doc/share/ada_pygments.py, doc/Makefile: Improve support for Ada\n        highlighting.\n\nFrom-SVN: r251890", "tree": {"sha": "ab2f1389361fd5fee0acd3a34d90c929a97f7fe3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ab2f1389361fd5fee0acd3a34d90c929a97f7fe3"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4bd3809078fee7f16cefac724db4439c75c2b74f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4bd3809078fee7f16cefac724db4439c75c2b74f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4bd3809078fee7f16cefac724db4439c75c2b74f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4bd3809078fee7f16cefac724db4439c75c2b74f/comments", "author": {"login": "ArnaudCharlet", "id": 30291825, "node_id": "MDQ6VXNlcjMwMjkxODI1", "avatar_url": "https://avatars.githubusercontent.com/u/30291825?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ArnaudCharlet", "html_url": "https://github.com/ArnaudCharlet", "followers_url": "https://api.github.com/users/ArnaudCharlet/followers", "following_url": "https://api.github.com/users/ArnaudCharlet/following{/other_user}", "gists_url": "https://api.github.com/users/ArnaudCharlet/gists{/gist_id}", "starred_url": "https://api.github.com/users/ArnaudCharlet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ArnaudCharlet/subscriptions", "organizations_url": "https://api.github.com/users/ArnaudCharlet/orgs", "repos_url": "https://api.github.com/users/ArnaudCharlet/repos", "events_url": "https://api.github.com/users/ArnaudCharlet/events{/privacy}", "received_events_url": "https://api.github.com/users/ArnaudCharlet/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "08705a15833a3df17b372fcf2a03ea9b017b2453", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/08705a15833a3df17b372fcf2a03ea9b017b2453", "html_url": "https://github.com/Rust-GCC/gccrs/commit/08705a15833a3df17b372fcf2a03ea9b017b2453"}], "stats": {"total": 51, "additions": 37, "deletions": 14}, "files": [{"sha": "0ee9488bd3aeb2127624b1e0b9821f318d57b55b", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4bd3809078fee7f16cefac724db4439c75c2b74f/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4bd3809078fee7f16cefac724db4439c75c2b74f/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=4bd3809078fee7f16cefac724db4439c75c2b74f", "patch": "@@ -1,3 +1,9 @@\n+2017-09-08  Arnaud Charlet <charlet@adacore.com>\n+\n+\t* doc/share/conf.py, doc/share/latex_elements.py,\n+\tdoc/share/ada_pygments.py, doc/Makefile: Improve support for Ada\n+\thighlighting.\n+\n 2017-09-08  Arnaud Charlet <charlet@adacore.com>\n \n \t* gnat_rm.texi, gnat_ugn.texi,"}, {"sha": "812cc8f288ca6fa71ad9886fedce54f06e9a4abc", "filename": "gcc/ada/doc/Makefile", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4bd3809078fee7f16cefac724db4439c75c2b74f/gcc%2Fada%2Fdoc%2FMakefile", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4bd3809078fee7f16cefac724db4439c75c2b74f/gcc%2Fada%2Fdoc%2FMakefile", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fdoc%2FMakefile?ref=4bd3809078fee7f16cefac724db4439c75c2b74f", "patch": "@@ -47,7 +47,6 @@ clean:\n \n %.pdf:\n \t$(SPHINXBUILD) -b latex $(ALLSPHINXOPTS) $(BUILDDIR)/$*/pdf\n-\tcp $(SOURCEDIR)/share/sphinx.sty $(BUILDDIR)/$*/pdf\n \t$(MAKE) -C $(BUILDDIR)/$*/pdf all-pdf LATEXOPTS=\"-interaction=nonstopmode\"\n \n %.txt:"}, {"sha": "66f6a2045f077d5fdbf566dc54e11bff59c69719", "filename": "gcc/ada/doc/share/ada_pygments.py", "status": "modified", "additions": 12, "deletions": 10, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4bd3809078fee7f16cefac724db4439c75c2b74f/gcc%2Fada%2Fdoc%2Fshare%2Fada_pygments.py", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4bd3809078fee7f16cefac724db4439c75c2b74f/gcc%2Fada%2Fdoc%2Fshare%2Fada_pygments.py", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fdoc%2Fshare%2Fada_pygments.py?ref=4bd3809078fee7f16cefac724db4439c75c2b74f", "patch": "@@ -1,4 +1,4 @@\n-\"\"\"Alternate Ada and Project Files parsers for Sphinx/Rest\"\"\"\n+\"\"\"Alternate Ada and Project Files parsers for Sphinx/Rest.\"\"\"\n \n import re\n from pygments.lexer import RegexLexer, bygroups\n@@ -7,12 +7,12 @@\n \n \n def get_lexer_tokens(tag_highlighting=False, project_support=False):\n-    \"\"\"Return the tokens needed for RegexLexer\n+    \"\"\"Return the tokens needed for RegexLexer.\n \n     :param tag_highlighting: if True we support tag highlighting. See\n         AdaLexerWithTags documentation\n     :type tag_highlighting: bool\n-    :param project_support: if True support additional keywors associated\n+    :param project_support: if True support additional keywords associated\n         with project files.\n     :type project_support:  bool\n \n@@ -21,7 +21,8 @@ def get_lexer_tokens(tag_highlighting=False, project_support=False):\n     \"\"\"\n     if project_support:\n         project_pattern = r'project\\s+|'\n-        project_pattern2 = r'project|'\n+        project_pattern2 = \\\n+            r'aggregate|extends|external|external_as_list|library|project|'\n     else:\n         project_pattern = r''\n         project_pattern2 = r''\n@@ -46,7 +47,7 @@ def get_lexer_tokens(tag_highlighting=False, project_support=False):\n             # Match use and with statements\n             # The first part of the pattern is be sure we don't match\n             # for/use constructs.\n-            (r'(\\n\\s*|;\\s*)(with|use)(\\s+[\\w\\.]+)',\n+            (r'(\\n\\s*|;\\s*)(with|use)(\\s+[\\w\\.]+\\s*;)',\n              bygroups(Punctuation, Keyword.Reserved, Name.Namespace)),\n             # Match procedure, package and function declarations\n             (r'end\\s+(if|loop|record)', Keyword),\n@@ -62,7 +63,7 @@ def get_lexer_tokens(tag_highlighting=False, project_support=False):\n              r'Version|Value_Size|Value|Valid_Scalars|VADS_Size|Valid|Val|'\n              r'Update|Unrestricted_Access|Universal_Literal_String|'\n              r'Unconstrained_Array|Unchecked_Access|Unbiased_Rounding|'\n-             r'Truncation|Type_Class|To_Address|Tick|Terminated|'\n+             r'UET_Address|Truncation|Type_Class|To_Address|Tick|Terminated|'\n              r'Target_Name|Tag|System_Allocator_Alignment|Succ|Stub_Type|'\n              r'Stream_Size|Storage_Unit|Storage_Size|Storage_Pool|Small|Size|'\n              r'Simple_Storage_Pool|Signed_Zeros|Scaling|Scale|'\n@@ -112,7 +113,8 @@ def get_lexer_tokens(tag_highlighting=False, project_support=False):\n             # Builtin values\n             (r'False|True', Keyword.Constant),\n             # Identifiers\n-            (r'[\\w\\.]+', Name)], }\n+            (r'[\\w\\.]+', Name),\n+            (r'.', Text)]}\n \n     # Insert tag highlighting before identifiers\n     if tag_highlighting:\n@@ -122,7 +124,7 @@ def get_lexer_tokens(tag_highlighting=False, project_support=False):\n \n \n class AdaLexer(RegexLexer):\n-    \"\"\"Alternate Pygments lexer for Ada source code and project files\n+    \"\"\"Alternate Pygments lexer for Ada source code and project files.\n \n     The default pygments lexer always fails causing disabling of syntax\n     highlighting in Sphinx. This lexer is simpler but safer.\n@@ -149,7 +151,7 @@ def setup(app):\n \n \n class TaggedAdaLexer(AdaLexer):\n-    \"\"\"Alternate Pygments lexer for Ada source code with tags\n+    \"\"\"Alternate Pygments lexer for Ada source code with tags.\n \n     A tag is a string of the form::\n \n@@ -165,7 +167,7 @@ class TaggedAdaLexer(AdaLexer):\n \n \n class GNATProjectLexer(RegexLexer):\n-    \"\"\"Pygment lexer for project files\n+    \"\"\"Pygment lexer for project files.\n \n     This is the same as the AdaLexer but with support of ``project``\n     keyword."}, {"sha": "173648b26ea1c147a171df740638f1ca1c49ced9", "filename": "gcc/ada/doc/share/conf.py", "status": "modified", "additions": 13, "deletions": 2, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4bd3809078fee7f16cefac724db4439c75c2b74f/gcc%2Fada%2Fdoc%2Fshare%2Fconf.py", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4bd3809078fee7f16cefac724db4439c75c2b74f/gcc%2Fada%2Fdoc%2Fshare%2Fconf.py", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fdoc%2Fshare%2Fconf.py?ref=4bd3809078fee7f16cefac724db4439c75c2b74f", "patch": "@@ -112,14 +112,25 @@ def get_gnat_build_type():\n \n html_static_path = ['_static']\n \n+latex_additional_files = ['gnat.sty']\n+\n+copyright_macros = {\n+    'date': time.strftime(\"%b %d, %Y\"),\n+    'edition': 'GNAT %s Edition' % 'Pro' if get_gnat_build_type() == 'PRO'\n+               else 'GPL',\n+    'name': u'GNU Ada',\n+    'tool': u'GNAT',\n+    'version': version}\n+\n latex_elements = {\n-    'preamble': latex_elements.TOC_DEPTH +\n+    'preamble': '\\\\usepackage{gnat}\\n' +\n+    latex_elements.TOC_DEPTH +\n     latex_elements.PAGE_BLANK +\n     latex_elements.TOC_CMD +\n     latex_elements.LATEX_HYPHEN +\n     latex_elements.doc_settings(DOCS[doc_name]['title'],\n                                 get_gnat_version()),\n-    'tableofcontents': latex_elements.TOC}\n+    'tableofcontents': latex_elements.TOC % copyright_macros}\n \n latex_documents = [\n     (master_doc, '%s.tex' % doc_name, project, u'AdaCore', 'manual')]"}, {"sha": "f23b2aff6be1ec87261880e5253b04247c68b4f2", "filename": "gcc/ada/doc/share/latex_elements.py", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4bd3809078fee7f16cefac724db4439c75c2b74f/gcc%2Fada%2Fdoc%2Fshare%2Flatex_elements.py", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4bd3809078fee7f16cefac724db4439c75c2b74f/gcc%2Fada%2Fdoc%2Fshare%2Flatex_elements.py", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fdoc%2Fshare%2Flatex_elements.py?ref=4bd3809078fee7f16cefac724db4439c75c2b74f", "patch": "@@ -46,11 +46,16 @@\n \\makeatother\n '''\n \n+with open('copyright.tex', 'r') as fd:\n+    copyright = fd.read()\n+\n TOC = r'''\n \\cleardoublepage\n+%s\n+\\cleardoublepage\n \\tableofcontents\n \\cleardoublepage\\pagestyle{plain}\n-'''\n+''' % copyright\n \n LATEX_HYPHEN = r'''\n \\hyphenpenalty=5000"}]}