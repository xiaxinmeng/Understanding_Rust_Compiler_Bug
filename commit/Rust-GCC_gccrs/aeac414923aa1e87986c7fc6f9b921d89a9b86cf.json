{"sha": "aeac414923aa1e87986c7fc6f9b921d89a9b86cf", "node_id": "C_kwDOANBUbNoAKGFlYWM0MTQ5MjNhYTFlODc5ODZjN2ZjNmY5YjkyMWQ4OWE5Yjg2Y2Y", "commit": {"author": {"name": "Thomas Schwinge", "email": "thomas@codesourcery.com", "date": "2022-01-25T17:44:02Z"}, "committer": {"name": "Thomas Schwinge", "email": "thomas@codesourcery.com", "date": "2022-01-25T17:46:21Z"}, "message": "Revert \"Fix PR 67102: Add libstdc++ dependancy to libffi\" [PR67102]\n\nThis reverts commit db1a65d9364fe72c2fff65fb2dec051728b6f3fa.\n\nOn 2021-09-17T01:01:39-0700, Andrew Pinski via Gcc-patches <gcc-patches@gcc.gnu.org> wrote:\n> On Fri, Sep 17, 2021 at 12:46 AM Thomas Schwinge <thomas@codesourcery.com> wrote:\n>> On 2021-09-15T13:56:37-0700, apinski--- via Gcc-patches <gcc-patches@gcc.gnu.org> wrote:\n>> > The error message is obvious -funconfigured-libstdc++-v3 is used\n>> > on the g++ command line.  So we just add the dependancy.\n>>\n>> > --- a/Makefile.def\n>> > +++ b/Makefile.def\n>> > @@ -592,6 +592,7 @@ dependencies = { module=configure-target-fastjar; on=configure-target-zlib; };\n>> >  dependencies = { module=all-target-fastjar; on=all-target-zlib; };\n>> >  dependencies = { module=configure-target-libgo; on=configure-target-libffi; };\n>> >  dependencies = { module=configure-target-libgo; on=all-target-libstdc++-v3; };\n>> > +dependencies = { module=configure-target-libffi; on=all-target-libstdc++-v3; };\n>> >  dependencies = { module=all-target-libgo; on=all-target-libbacktrace; };\n>> >  dependencies = { module=all-target-libgo; on=all-target-libffi; };\n>> >  dependencies = { module=all-target-libgo; on=all-target-libatomic; };\n>>\n>> I'm confused, because given that this 'Makefile.def' change only has the\n>> following effect:\n>>\n>> > --- a/Makefile.in\n>> > +++ b/Makefile.in\n>> > @@ -61261,6 +61261,7 @@ all-bison: maybe-all-intl\n>> >  all-flex: maybe-all-intl\n>> >  all-m4: maybe-all-intl\n>> >  configure-target-libgo: maybe-all-target-libstdc++-v3\n>> > +configure-target-libffi: maybe-all-target-libstdc++-v3\n>> >  configure-target-liboffloadmic: maybe-configure-target-libgomp\n>> >  all-target-liboffloadmic: maybe-all-target-libgomp\n>> >  configure-target-newlib: maybe-all-binutils\n>>\n>> ... isn't that actually a no-op, because we already had such a dependency\n>> listed?  Now twice:\n>>\n>>     $ grep -n -F 'configure-target-libffi: maybe-all-target-libstdc++-v3' -- Makefile.in\n>>     61264:configure-target-libffi: maybe-all-target-libstdc++-v3\n>>     61372:configure-target-libffi: maybe-all-target-libstdc++-v3\n>>\n>> Compared to the existing one, the one you've added is additionally\n>> restricted by '@unless gcc-bootstrap'.\n>>\n>> I noticed this as I remembered that on our og[...] development branches\n>> we have a patch in the opposite direction: get rid of this dependency via\n>> removing 'lang_env_dependencies = { module=libffi; cxx=true; };' from\n>> 'Makefile.def'.  See\n>> <http://mid.mail-archive.com/alpine.DEB.2.21.9999.1812201344250.99920@build7-trusty-cs.sje.mentorg.com>\n>> \"Disable libstdc++ dependency for libffi\".  (Maciej CCed in case you have\n>> any further thoughts on that.)\n>\n> Oh, I see what happened now, the old bug was actually fixed by r6-5415\n> which added cxx=true.\n> So yes my patch is actually not needed and can be reverted.\n> I tried to look to see if there was a dependency was there but for\n> some reason I did not see it.", "tree": {"sha": "7e1e9b2ee4752798f876478dd6e829be4d0584a7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7e1e9b2ee4752798f876478dd6e829be4d0584a7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/aeac414923aa1e87986c7fc6f9b921d89a9b86cf", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/aeac414923aa1e87986c7fc6f9b921d89a9b86cf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/aeac414923aa1e87986c7fc6f9b921d89a9b86cf", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/aeac414923aa1e87986c7fc6f9b921d89a9b86cf/comments", "author": {"login": "tschwinge", "id": 21753, "node_id": "MDQ6VXNlcjIxNzUz", "avatar_url": "https://avatars.githubusercontent.com/u/21753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tschwinge", "html_url": "https://github.com/tschwinge", "followers_url": "https://api.github.com/users/tschwinge/followers", "following_url": "https://api.github.com/users/tschwinge/following{/other_user}", "gists_url": "https://api.github.com/users/tschwinge/gists{/gist_id}", "starred_url": "https://api.github.com/users/tschwinge/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tschwinge/subscriptions", "organizations_url": "https://api.github.com/users/tschwinge/orgs", "repos_url": "https://api.github.com/users/tschwinge/repos", "events_url": "https://api.github.com/users/tschwinge/events{/privacy}", "received_events_url": "https://api.github.com/users/tschwinge/received_events", "type": "User", "site_admin": false}, "committer": {"login": "tschwinge", "id": 21753, "node_id": "MDQ6VXNlcjIxNzUz", "avatar_url": "https://avatars.githubusercontent.com/u/21753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tschwinge", "html_url": "https://github.com/tschwinge", "followers_url": "https://api.github.com/users/tschwinge/followers", "following_url": "https://api.github.com/users/tschwinge/following{/other_user}", "gists_url": "https://api.github.com/users/tschwinge/gists{/gist_id}", "starred_url": "https://api.github.com/users/tschwinge/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tschwinge/subscriptions", "organizations_url": "https://api.github.com/users/tschwinge/orgs", "repos_url": "https://api.github.com/users/tschwinge/repos", "events_url": "https://api.github.com/users/tschwinge/events{/privacy}", "received_events_url": "https://api.github.com/users/tschwinge/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9099e0bc6667ba319f4b794a5a98a364e7f9aef9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9099e0bc6667ba319f4b794a5a98a364e7f9aef9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9099e0bc6667ba319f4b794a5a98a364e7f9aef9"}], "stats": {"total": 2, "additions": 0, "deletions": 2}, "files": [{"sha": "80347fd13dab979235e0af7d2ed7b8e4198d4ebb", "filename": "Makefile.def", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aeac414923aa1e87986c7fc6f9b921d89a9b86cf/Makefile.def", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aeac414923aa1e87986c7fc6f9b921d89a9b86cf/Makefile.def", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/Makefile.def?ref=aeac414923aa1e87986c7fc6f9b921d89a9b86cf", "patch": "@@ -620,7 +620,6 @@ dependencies = { module=configure-target-fastjar; on=configure-target-zlib; };\n dependencies = { module=all-target-fastjar; on=all-target-zlib; };\n dependencies = { module=configure-target-libgo; on=configure-target-libffi; };\n dependencies = { module=configure-target-libgo; on=all-target-libstdc++-v3; };\n-dependencies = { module=configure-target-libffi; on=all-target-libstdc++-v3; };\n dependencies = { module=all-target-libgo; on=all-target-libbacktrace; };\n dependencies = { module=all-target-libgo; on=all-target-libffi; };\n dependencies = { module=all-target-libgo; on=all-target-libatomic; };"}, {"sha": "7d97049c8d65248d03807d8c910b4fa1bf221b48", "filename": "Makefile.in", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aeac414923aa1e87986c7fc6f9b921d89a9b86cf/Makefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aeac414923aa1e87986c7fc6f9b921d89a9b86cf/Makefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/Makefile.in?ref=aeac414923aa1e87986c7fc6f9b921d89a9b86cf", "patch": "@@ -66516,7 +66516,6 @@ all-m4: maybe-all-intl\n configure-target-fastjar: maybe-configure-target-zlib\n all-target-fastjar: maybe-all-target-zlib\n configure-target-libgo: maybe-all-target-libstdc++-v3\n-configure-target-libffi: maybe-all-target-libstdc++-v3\n all-target-libgo: maybe-all-target-libbacktrace\n all-target-libgo: maybe-all-target-libatomic\n configure-target-liboffloadmic: maybe-configure-target-libgomp"}]}