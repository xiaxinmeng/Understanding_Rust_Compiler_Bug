{"sha": "6c6366f6513dbf11dc563d0a6f420c12d4c48df7", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NmM2MzY2ZjY1MTNkYmYxMWRjNTYzZDBhNmY0MjBjMTJkNGM0OGRmNw==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2010-03-01T07:03:22Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2010-03-01T07:03:22Z"}, "message": "cfgexpand.c (expand_used_vars): If an artificial non-ignored var has no rtl yet when processing local_decls...\n\n\t* cfgexpand.c (expand_used_vars): If an artificial non-ignored var\n\thas no rtl yet when processing local_decls, queue it and recheck\n\tif deferred stack allocation hasn't assigned it rtl.\n\nFrom-SVN: r157132", "tree": {"sha": "7d9d41abbe1b5c599c09b9fb6117889098a6c08d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7d9d41abbe1b5c599c09b9fb6117889098a6c08d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6c6366f6513dbf11dc563d0a6f420c12d4c48df7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6c6366f6513dbf11dc563d0a6f420c12d4c48df7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6c6366f6513dbf11dc563d0a6f420c12d4c48df7", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6c6366f6513dbf11dc563d0a6f420c12d4c48df7/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "8026c68cce481c763306f8a3d495890a3aab5e4a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8026c68cce481c763306f8a3d495890a3aab5e4a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8026c68cce481c763306f8a3d495890a3aab5e4a"}], "stats": {"total": 38, "additions": 38, "deletions": 0}, "files": [{"sha": "eff481ff22d9b5271700e2474751aeb7907b3054", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6c6366f6513dbf11dc563d0a6f420c12d4c48df7/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6c6366f6513dbf11dc563d0a6f420c12d4c48df7/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=6c6366f6513dbf11dc563d0a6f420c12d4c48df7", "patch": "@@ -1,3 +1,9 @@\n+2010-03-01  Jakub Jelinek  <jakub@redhat.com>\n+\n+\t* cfgexpand.c (expand_used_vars): If an artificial non-ignored var\n+\thas no rtl yet when processing local_decls, queue it and recheck\n+\tif deferred stack allocation hasn't assigned it rtl.\n+\n 2010-02-28  Kaz Kojima  <kkojima@gcc.gnu.org>\n \n \t* config/sh/sh.c (unspec_bbr_uid): New."}, {"sha": "b51307ff90283b075669ad71c466c9df58ac0b85", "filename": "gcc/cfgexpand.c", "status": "modified", "additions": 32, "deletions": 0, "changes": 32, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6c6366f6513dbf11dc563d0a6f420c12d4c48df7/gcc%2Fcfgexpand.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6c6366f6513dbf11dc563d0a6f420c12d4c48df7/gcc%2Fcfgexpand.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcfgexpand.c?ref=6c6366f6513dbf11dc563d0a6f420c12d4c48df7", "patch": "@@ -1283,6 +1283,7 @@ static void\n expand_used_vars (void)\n {\n   tree t, next, outer_block = DECL_INITIAL (current_function_decl);\n+  tree maybe_local_decls = NULL_TREE;\n   unsigned i;\n \n   /* Compute the phase of the stack frame for this function.  */\n@@ -1367,6 +1368,15 @@ expand_used_vars (void)\n \t      cfun->local_decls = t;\n \t      continue;\n \t    }\n+\t  else if (rtl == NULL_RTX)\n+\t    {\n+\t      /* If rtl isn't set yet, which can happen e.g. with\n+\t\t -fstack-protector, retry before returning from this\n+\t\t function.  */\n+\t      TREE_CHAIN (t) = maybe_local_decls;\n+\t      maybe_local_decls = t;\n+\t      continue;\n+\t    }\n \t}\n \n       ggc_free (t);\n@@ -1425,6 +1435,28 @@ expand_used_vars (void)\n       fini_vars_expansion ();\n     }\n \n+  /* If there were any artificial non-ignored vars without rtl\n+     found earlier, see if deferred stack allocation hasn't assigned\n+     rtl to them.  */\n+  for (t = maybe_local_decls; t; t = next)\n+    {\n+      tree var = TREE_VALUE (t);\n+      rtx rtl = DECL_RTL_IF_SET (var);\n+\n+      next = TREE_CHAIN (t);\n+\n+      /* Keep artificial non-ignored vars in cfun->local_decls\n+\t chain until instantiate_decls.  */\n+      if (rtl && (MEM_P (rtl) || GET_CODE (rtl) == CONCAT))\n+\t{\n+\t  TREE_CHAIN (t) = cfun->local_decls;\n+\t  cfun->local_decls = t;\n+\t  continue;\n+\t}\n+\n+      ggc_free (t);\n+    }\n+\n   /* If the target requires that FRAME_OFFSET be aligned, do it.  */\n   if (STACK_ALIGNMENT_NEEDED)\n     {"}]}