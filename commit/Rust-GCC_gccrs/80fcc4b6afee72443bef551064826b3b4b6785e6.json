{"sha": "80fcc4b6afee72443bef551064826b3b4b6785e6", "node_id": "C_kwDOANBUbNoAKDgwZmNjNGI2YWZlZTcyNDQzYmVmNTUxMDY0ODI2YjNiNGI2Nzg1ZTY", "commit": {"author": {"name": "Segher Boessenkool", "email": "segher@kernel.crashing.org", "date": "2022-03-11T21:15:18Z"}, "committer": {"name": "Segher Boessenkool", "email": "segher@kernel.crashing.org", "date": "2022-03-12T16:02:19Z"}, "message": "rs6000: Do not use rs6000_cpu for .machine ppc and ppc64 (PR104829)\n\nFixes: 77eccbf39ed5\n\nrs6000.h has\n  #define PROCESSOR_POWERPC   PROCESSOR_PPC604\n  #define PROCESSOR_POWERPC64 PROCESSOR_RS64A\nwhich means that if you use things like  -mcpu=powerpc -mvsx  it will no\nlonger work after my latest .machine patch.  This causes GCC build errors\nin some cases, not a good idea (even if the errors are actually\npre-existing: using -mvsx with a machine that does not have VSX cannot\nwork properly).\n\n2022-03-11  Segher Boessenkool  <segher@kernel.crashing.org>\n\n\tPR target/104829\n\t* config/rs6000/rs6000.cc (rs6000_machine_from_flags): Don't output\n\t\"ppc\" and \"ppc64\" based on rs6000_cpu.", "tree": {"sha": "7c2ea4cad4efd8d729f7162b41202c139debe819", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7c2ea4cad4efd8d729f7162b41202c139debe819"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/80fcc4b6afee72443bef551064826b3b4b6785e6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/80fcc4b6afee72443bef551064826b3b4b6785e6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/80fcc4b6afee72443bef551064826b3b4b6785e6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/80fcc4b6afee72443bef551064826b3b4b6785e6/comments", "author": {"login": "segher", "id": 417629, "node_id": "MDQ6VXNlcjQxNzYyOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/417629?v=4", "gravatar_id": "", "url": "https://api.github.com/users/segher", "html_url": "https://github.com/segher", "followers_url": "https://api.github.com/users/segher/followers", "following_url": "https://api.github.com/users/segher/following{/other_user}", "gists_url": "https://api.github.com/users/segher/gists{/gist_id}", "starred_url": "https://api.github.com/users/segher/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/segher/subscriptions", "organizations_url": "https://api.github.com/users/segher/orgs", "repos_url": "https://api.github.com/users/segher/repos", "events_url": "https://api.github.com/users/segher/events{/privacy}", "received_events_url": "https://api.github.com/users/segher/received_events", "type": "User", "site_admin": false}, "committer": {"login": "segher", "id": 417629, "node_id": "MDQ6VXNlcjQxNzYyOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/417629?v=4", "gravatar_id": "", "url": "https://api.github.com/users/segher", "html_url": "https://github.com/segher", "followers_url": "https://api.github.com/users/segher/followers", "following_url": "https://api.github.com/users/segher/following{/other_user}", "gists_url": "https://api.github.com/users/segher/gists{/gist_id}", "starred_url": "https://api.github.com/users/segher/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/segher/subscriptions", "organizations_url": "https://api.github.com/users/segher/orgs", "repos_url": "https://api.github.com/users/segher/repos", "events_url": "https://api.github.com/users/segher/events{/privacy}", "received_events_url": "https://api.github.com/users/segher/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a07b8f4fb756484893b5612cbe9410970dc76db9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a07b8f4fb756484893b5612cbe9410970dc76db9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a07b8f4fb756484893b5612cbe9410970dc76db9"}], "stats": {"total": 12, "additions": 10, "deletions": 2}, "files": [{"sha": "283e8306ff7f0eaf150f8be004c827022dceb821", "filename": "gcc/config/rs6000/rs6000.cc", "status": "modified", "additions": 10, "deletions": 2, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/80fcc4b6afee72443bef551064826b3b4b6785e6/gcc%2Fconfig%2Frs6000%2Frs6000.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/80fcc4b6afee72443bef551064826b3b4b6785e6/gcc%2Fconfig%2Frs6000%2Frs6000.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.cc?ref=80fcc4b6afee72443bef551064826b3b4b6785e6", "patch": "@@ -5804,20 +5804,28 @@ rs6000_machine_from_flags (void)\n   if (rs6000_cpu == PROCESSOR_MPCCORE)\n     return \"\\\"821\\\"\";\n \n+#if 0\n+  /* This (and ppc64 below) are disabled here (for now at least) because\n+     PROCESSOR_POWERPC, PROCESSOR_POWERPC64, and PROCESSOR_COMMON\n+     are #define'd as some of these.  Untangling that is a job for later.  */\n+\n   /* 600 series and 700 series, \"classic\" */\n   if (rs6000_cpu == PROCESSOR_PPC601 || rs6000_cpu == PROCESSOR_PPC603\n       || rs6000_cpu == PROCESSOR_PPC604 || rs6000_cpu == PROCESSOR_PPC604e\n-      || rs6000_cpu == PROCESSOR_PPC750 || rs6000_cpu == PROCESSOR_POWERPC)\n+      || rs6000_cpu == PROCESSOR_PPC750)\n     return \"ppc\";\n+#endif\n \n   /* Classic with AltiVec, \"G4\" */\n   if (rs6000_cpu == PROCESSOR_PPC7400 || rs6000_cpu == PROCESSOR_PPC7450)\n     return \"\\\"7450\\\"\";\n \n+#if 0\n   /* The older 64-bit CPUs */\n   if (rs6000_cpu == PROCESSOR_PPC620 || rs6000_cpu == PROCESSOR_PPC630\n-      || rs6000_cpu == PROCESSOR_RS64A || rs6000_cpu == PROCESSOR_POWERPC64)\n+      || rs6000_cpu == PROCESSOR_RS64A)\n     return \"ppc64\";\n+#endif\n \n   HOST_WIDE_INT flags = rs6000_isa_flags;\n "}]}