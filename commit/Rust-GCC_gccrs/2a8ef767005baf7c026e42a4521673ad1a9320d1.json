{"sha": "2a8ef767005baf7c026e42a4521673ad1a9320d1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MmE4ZWY3NjcwMDViYWY3YzAyNmU0MmE0NTIxNjczYWQxYTkzMjBkMQ==", "commit": {"author": {"name": "Edward Smith-Rowland", "email": "3dw4rd@verizon.net", "date": "2014-10-06T17:11:23Z"}, "committer": {"name": "Edward Smith-Rowland", "email": "emsr@gcc.gnu.org", "date": "2014-10-06T17:11:23Z"}, "message": "c-cppbuiltin.c: Move __cpp_attribute_deprecated to the C++11 section.\n\ngcc/c-family:\n\n2014-10-06  Edward Smith-Rowland  <3dw4rd@verizon.net>\n\n\t* c-family/c-cppbuiltin.c: Move __cpp_attribute_deprecated to the\n\tC++11 section.\n\n\ngcc/cp:\n\n2014-10-06  Edward Smith-Rowland  <3dw4rd@verizon.net>\n\n\t* cp/parser.c: Allow [[deprecated]] for C++11.  Issue a pedwarn.\n\n\ngcc/testsuite:\n\n2014-10-06  Edward Smith-Rowland  <3dw4rd@verizon.net>\n\n\t* g++.dg/cpp1y/attr-deprecated-neg.C: Attribute no longer ignored.\n\t* g++.dg/cpp1y/feat-cxx11-neg.C: Comment out __cpp_attribute_deprecated test.\n\t* g++.dg/cpp1y/feat-cxx11.C: Add __cpp_attribute_deprecated test.\n\nFrom-SVN: r215957", "tree": {"sha": "aa26ada91b44a51b514cae937615798a5857231a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/aa26ada91b44a51b514cae937615798a5857231a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2a8ef767005baf7c026e42a4521673ad1a9320d1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2a8ef767005baf7c026e42a4521673ad1a9320d1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2a8ef767005baf7c026e42a4521673ad1a9320d1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2a8ef767005baf7c026e42a4521673ad1a9320d1/comments", "author": {"login": "emsr", "id": 1936479, "node_id": "MDQ6VXNlcjE5MzY0Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1936479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/emsr", "html_url": "https://github.com/emsr", "followers_url": "https://api.github.com/users/emsr/followers", "following_url": "https://api.github.com/users/emsr/following{/other_user}", "gists_url": "https://api.github.com/users/emsr/gists{/gist_id}", "starred_url": "https://api.github.com/users/emsr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/emsr/subscriptions", "organizations_url": "https://api.github.com/users/emsr/orgs", "repos_url": "https://api.github.com/users/emsr/repos", "events_url": "https://api.github.com/users/emsr/events{/privacy}", "received_events_url": "https://api.github.com/users/emsr/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "fbf833b776811b8ac22c79ee52ff46d578da755b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fbf833b776811b8ac22c79ee52ff46d578da755b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fbf833b776811b8ac22c79ee52ff46d578da755b"}], "stats": {"total": 65, "additions": 47, "deletions": 18}, "files": [{"sha": "e5ca891b8998a7a6e019a263d0886deb51edd891", "filename": "gcc/c-family/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2a8ef767005baf7c026e42a4521673ad1a9320d1/gcc%2Fc-family%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2a8ef767005baf7c026e42a4521673ad1a9320d1/gcc%2Fc-family%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2FChangeLog?ref=2a8ef767005baf7c026e42a4521673ad1a9320d1", "patch": "@@ -1,3 +1,8 @@\n+2014-10-06  Edward Smith-Rowland  <3dw4rd@verizon.net>\n+\n+\t* c-family/c-cppbuiltin.c: Move __cpp_attribute_deprecated to the\n+\tC++11 section.\n+\n 2014-10-03  Marc Glisse  <marc.glisse@inria.fr>\n \n \tPR c++/54427"}, {"sha": "1173109fde7efce84f1f0d68f887b5678fc61ddd", "filename": "gcc/c-family/c-cppbuiltin.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2a8ef767005baf7c026e42a4521673ad1a9320d1/gcc%2Fc-family%2Fc-cppbuiltin.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2a8ef767005baf7c026e42a4521673ad1a9320d1/gcc%2Fc-family%2Fc-cppbuiltin.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2Fc-cppbuiltin.c?ref=2a8ef767005baf7c026e42a4521673ad1a9320d1", "patch": "@@ -828,6 +828,7 @@ c_cpp_builtins (cpp_reader *pfile)\n \t  cpp_define (pfile, \"__cpp_rvalue_reference=200610\");\n \t  cpp_define (pfile, \"__cpp_variadic_templates=200704\");\n \t  cpp_define (pfile, \"__cpp_alias_templates=200704\");\n+\t  cpp_define (pfile, \"__cpp_attribute_deprecated=201309\");\n \t}\n       if (cxx_dialect > cxx11)\n \t{\n@@ -841,7 +842,6 @@ c_cpp_builtins (cpp_reader *pfile)\n \t  //cpp_define (pfile, \"__cpp_aggregate_nsdmi=201304\");\n \t  cpp_define (pfile, \"__cpp_variable_templates=201304\");\n \t  cpp_define (pfile, \"__cpp_digit_separators=201309\");\n-\t  cpp_define (pfile, \"__cpp_attribute_deprecated=201309\");\n \t  //cpp_define (pfile, \"__cpp_sized_deallocation=201309\");\n \t  /* We'll have to see where runtime arrays wind up.\n \t     Let's put it in C++14 for now.  */"}, {"sha": "10084c4903a100176afb872c12d8c3086ba18768", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2a8ef767005baf7c026e42a4521673ad1a9320d1/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2a8ef767005baf7c026e42a4521673ad1a9320d1/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=2a8ef767005baf7c026e42a4521673ad1a9320d1", "patch": "@@ -1,3 +1,7 @@\n+2014-10-06  Edward Smith-Rowland  <3dw4rd@verizon.net>\n+\n+\t* cp/parser.c: Allow [[deprecated]] for C++11.  Issue a pedwarn.\n+\n 2014-10-06  Paolo Carlini  <paolo.carlini@oracle.com>\n \n \tPR c++/55250"}, {"sha": "bc992b20045cfd4ea0d10247e4ee3ce7f00267e6", "filename": "gcc/cp/parser.c", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2a8ef767005baf7c026e42a4521673ad1a9320d1/gcc%2Fcp%2Fparser.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2a8ef767005baf7c026e42a4521673ad1a9320d1/gcc%2Fcp%2Fparser.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fparser.c?ref=2a8ef767005baf7c026e42a4521673ad1a9320d1", "patch": "@@ -22204,8 +22204,14 @@ cp_parser_std_attribute (cp_parser *parser)\n       if (is_attribute_p (\"noreturn\", attr_id))\n \tTREE_PURPOSE (TREE_PURPOSE (attribute)) = get_identifier (\"gnu\");\n       /* C++14 deprecated attribute is equivalent to GNU's.  */\n-      else if (cxx_dialect >= cxx14 && is_attribute_p (\"deprecated\", attr_id))\n-\tTREE_PURPOSE (TREE_PURPOSE (attribute)) = get_identifier (\"gnu\");\n+      else if (cxx_dialect >= cxx11 && is_attribute_p (\"deprecated\", attr_id))\n+\t{\n+\t  if (cxx_dialect == cxx11)\n+\t    pedwarn (token->location, OPT_Wpedantic,\n+\t\t     \"%<deprecated%> is a C++14 feature;\"\n+\t\t     \" use %<gnu::deprecated%>\");\n+\t  TREE_PURPOSE (TREE_PURPOSE (attribute)) = get_identifier (\"gnu\");\n+\t}\n     }\n \n   /* Now parse the optional argument clause of the attribute.  */"}, {"sha": "99c66d9bbe2ec51941034db534286eee712a0fb1", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2a8ef767005baf7c026e42a4521673ad1a9320d1/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2a8ef767005baf7c026e42a4521673ad1a9320d1/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=2a8ef767005baf7c026e42a4521673ad1a9320d1", "patch": "@@ -1,3 +1,9 @@\n+2014-10-06  Edward Smith-Rowland  <3dw4rd@verizon.net>\n+\n+\t* g++.dg/cpp1y/attr-deprecated-neg.C: Attribute no longer ignored.\n+\t* g++.dg/cpp1y/feat-cxx11-neg.C: Comment out __cpp_attribute_deprecated test.\n+\t* g++.dg/cpp1y/feat-cxx11.C: Add __cpp_attribute_deprecated test.\n+\n 2014-10-06  Paolo Carlini  <paolo.carlini@oracle.com>\n \n \tPR c++/55250"}, {"sha": "369f3df9961a27dda9f4255237fff06a0714f170", "filename": "gcc/testsuite/g++.dg/cpp1y/attr-deprecated-neg.C", "status": "modified", "additions": 13, "deletions": 12, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2a8ef767005baf7c026e42a4521673ad1a9320d1/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1y%2Fattr-deprecated-neg.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2a8ef767005baf7c026e42a4521673ad1a9320d1/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1y%2Fattr-deprecated-neg.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1y%2Fattr-deprecated-neg.C?ref=2a8ef767005baf7c026e42a4521673ad1a9320d1", "patch": "@@ -1,23 +1,24 @@\n // { dg-do compile { target c++11_only } }\n+// { dg-options \"-pedantic\" }\n \n-class [[deprecated]] A // { dg-warning \"attribute directive ignored\" }\n+class [[deprecated]] A // { dg-warning \"'deprecated' is a C..14 feature\" }\n {\n };\n \n-[[deprecated]]\n+[[deprecated]] // { dg-warning \"'deprecated' is a C..14 feature\" }\n int\n-foo(int n) // { dg-warning \"attribute directive ignored\" }\n+foo(int n)\n {\n   return 42 + n;\n }\n \n-class [[deprecated(\"B has been superceded by C\")]] B // { dg-warning \"attribute directive ignored\" }\n+class [[deprecated(\"B has been superceded by C\")]] B // { dg-warning \"'deprecated' is a C..14 feature\" }\n {\n };\n \n-[[deprecated(\"bar is unsafe; use foobar instead\")]]\n+[[deprecated(\"bar is unsafe; use foobar instead\")]] // { dg-warning \"'deprecated' is a C..14 feature\" }\n int\n-bar(int n) // { dg-warning \"attribute directive ignored\" }\n+bar(int n)\n {\n   return 42 + n - 1;\n }\n@@ -47,12 +48,12 @@ foobar(int n)\n int\n main()\n {\n-  A aaa;\n-  int n = foo(12);\n+  A aaa; // { dg-warning \"is deprecated\" }\n+  int n = foo(12); // { dg-warning \"is deprecated\" }\n \n-  B bbb;\n-  int m = bar(666);\n+  B bbb; // { dg-warning \"is deprecated\" }\n+  int m = bar(666); // { dg-warning \"is deprecated\" }\n \n-  C ccc;\n-  int l = foobar(8);\n+  C ccc; // { dg-warning \"is deprecated\" \"\" { target { c++14 } } }\n+  int l = foobar(8); // { dg-warning \"is deprecated\" \"\" { target { c++14 } } }\n }"}, {"sha": "6310ce666e36751cfd2c502b74b1061b2b1e6f89", "filename": "gcc/testsuite/g++.dg/cpp1y/feat-cxx11-neg.C", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2a8ef767005baf7c026e42a4521673ad1a9320d1/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1y%2Ffeat-cxx11-neg.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2a8ef767005baf7c026e42a4521673ad1a9320d1/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1y%2Ffeat-cxx11-neg.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1y%2Ffeat-cxx11-neg.C?ref=2a8ef767005baf7c026e42a4521673ad1a9320d1", "patch": "@@ -31,9 +31,10 @@\n #  error \"__cpp_digit_separators\" // { dg-error \"error\" }\n #endif\n \n-#ifndef __cpp_attribute_deprecated\n-#  error \"__cpp_attribute_deprecated\" // { dg-error \"error\" }\n-#endif\n+//  Attribute [[deprecated]] is allowed in C++11 as an extension (with pedwarn).\n+//#ifndef __cpp_attribute_deprecated\n+//#  error \"__cpp_attribute_deprecated\"\n+//#endif\n \n #ifndef __cpp_runtime_arrays\n #  error \"__cpp_runtime_arrays\" // { dg-error \"error\" }"}, {"sha": "6ebc0c84cb0d1ec14ca377b62b2b9bd59d36be32", "filename": "gcc/testsuite/g++.dg/cpp1y/feat-cxx11.C", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2a8ef767005baf7c026e42a4521673ad1a9320d1/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1y%2Ffeat-cxx11.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2a8ef767005baf7c026e42a4521673ad1a9320d1/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1y%2Ffeat-cxx11.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1y%2Ffeat-cxx11.C?ref=2a8ef767005baf7c026e42a4521673ad1a9320d1", "patch": "@@ -79,3 +79,9 @@\n #elif __cpp_binary_literals != 201304\n #  error \"__cpp_binary_literals != 201304\"\n #endif\n+\n+#ifndef __cpp_attribute_deprecated\n+#  error \"__cpp_attribute_deprecated\"\n+#elif __cpp_attribute_deprecated != 201309\n+#  error \"__cpp_attribute_deprecated != 201309\"\n+#endif"}]}