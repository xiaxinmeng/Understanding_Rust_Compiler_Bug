{"sha": "d19184d67aa96de07e25e8f8f6adb4f33042caa6", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDE5MTg0ZDY3YWE5NmRlMDdlMjVlOGY4ZjZhZGI0ZjMzMDQyY2FhNg==", "commit": {"author": {"name": "Richard Stallman", "email": "rms@gnu.org", "date": "1993-06-29T04:37:51Z"}, "committer": {"name": "Richard Stallman", "email": "rms@gnu.org", "date": "1993-06-29T04:37:51Z"}, "message": "(main): For -iwithprefix, if no include_prefix,\n\nmake a default from GCC_INCLUDE_DIR.\nSupport -iwithprefixbefore.\n\nFrom-SVN: r4793", "tree": {"sha": "b5c2b6c6ba722ebeee9bffc2277b59393951b077", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b5c2b6c6ba722ebeee9bffc2277b59393951b077"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d19184d67aa96de07e25e8f8f6adb4f33042caa6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d19184d67aa96de07e25e8f8f6adb4f33042caa6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d19184d67aa96de07e25e8f8f6adb4f33042caa6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d19184d67aa96de07e25e8f8f6adb4f33042caa6/comments", "author": null, "committer": null, "parents": [{"sha": "b9654711e95a6cfe8f482c446cf9eba6e2310956", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b9654711e95a6cfe8f482c446cf9eba6e2310956", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b9654711e95a6cfe8f482c446cf9eba6e2310956"}], "stats": {"total": 43, "additions": 41, "deletions": 2}, "files": [{"sha": "259494a82931efc282b31f23a86aaa4dda2ce592", "filename": "gcc/cccp.c", "status": "modified", "additions": 41, "deletions": 2, "changes": 43, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d19184d67aa96de07e25e8f8f6adb4f33042caa6/gcc%2Fcccp.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d19184d67aa96de07e25e8f8f6adb4f33042caa6/gcc%2Fcccp.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcccp.c?ref=d19184d67aa96de07e25e8f8f6adb4f33042caa6", "patch": "@@ -1101,6 +1101,16 @@ main (argc, argv)\n \t   with the default prefix at the front of its name.  */\n \tif (!strcmp (argv[i], \"-iwithprefix\")) {\n \t  struct file_name_list *dirtmp;\n+\t  char *prefix;\n+\n+\t  if (include_prefix != 0)\n+\t    prefix = include_prefix;\n+\t  else {\n+\t    prefix = savestring (GCC_INCLUDE_DIR);\n+\t    /* Remove the `include' from /usr/local/lib/gcc.../include.  */\n+\t    if (!strcmp (prefix + strlen (prefix) - 8, \"/include\"))\n+\t      prefix[strlen (prefix) - 7] = 0;\n+\t  }\n \n \t  dirtmp = (struct file_name_list *)\n \t    xmalloc (sizeof (struct file_name_list));\n@@ -1110,8 +1120,8 @@ main (argc, argv)\n \t    fatal (\"Directory name missing after `-iwithprefix' option\");\n \n \t  dirtmp->fname = (char *) xmalloc (strlen (argv[i+1])\n-\t\t\t\t\t    + strlen (include_prefix) + 1);\n-\t  strcpy (dirtmp->fname, include_prefix);\n+\t\t\t\t\t    + strlen (prefix) + 1);\n+\t  strcpy (dirtmp->fname, prefix);\n \t  strcat (dirtmp->fname, argv[++i]);\n \n \t  if (after_include == 0)\n@@ -1120,6 +1130,35 @@ main (argc, argv)\n \t    last_after_include->next = dirtmp;\n \t  last_after_include = dirtmp; /* Tail follows the last one */\n \t}\n+\t/* Add directory to main path for includes,\n+\t   with the default prefix at the front of its name.  */\n+\tif (!strcmp (argv[i], \"-iwithprefixbefore\")) {\n+\t  struct file_name_list *dirtmp;\n+\t  char *prefix;\n+\n+\t  if (include_prefix != 0)\n+\t    prefix = include_prefix;\n+\t  else {\n+\t    prefix = savestring (GCC_INCLUDE_DIR);\n+\t    /* Remove the `include' from /usr/local/lib/gcc.../include.  */\n+\t    if (!strcmp (prefix + strlen (prefix) - 8, \"/include\"))\n+\t      prefix[strlen (prefix) - 7] = 0;\n+\t  }\n+\n+\t  dirtmp = (struct file_name_list *)\n+\t    xmalloc (sizeof (struct file_name_list));\n+\t  dirtmp->next = 0;\t/* New one goes on the end */\n+\t  dirtmp->control_macro = 0;\n+\t  if (i + 1 == argc)\n+\t    fatal (\"Directory name missing after `-iwithprefixbefore' option\");\n+\n+\t  dirtmp->fname = (char *) xmalloc (strlen (argv[i+1])\n+\t\t\t\t\t    + strlen (prefix) + 1);\n+\t  strcpy (dirtmp->fname, prefix);\n+\t  strcat (dirtmp->fname, argv[++i]);\n+\n+\t  append_include_chain (dirtmp, dirtmp);\n+\t}\n \t/* Add directory to end of path for includes.  */\n \tif (!strcmp (argv[i], \"-idirafter\")) {\n \t  struct file_name_list *dirtmp;"}]}