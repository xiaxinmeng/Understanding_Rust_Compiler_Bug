{"sha": "f5ea9817c462ab8ab8089599e64c5bfecabc2a8c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjVlYTk4MTdjNDYyYWI4YWI4MDg5NTk5ZTY0YzViZmVjYWJjMmE4Yw==", "commit": {"author": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1995-11-26T19:41:43Z"}, "committer": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1995-11-26T19:41:43Z"}, "message": "(trampoline): Add getpagesize and mprotect for WINNT.\n\nFrom-SVN: r10605", "tree": {"sha": "a32af89a905746b99fb45e8359e4b5bedad60fef", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a32af89a905746b99fb45e8359e4b5bedad60fef"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f5ea9817c462ab8ab8089599e64c5bfecabc2a8c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f5ea9817c462ab8ab8089599e64c5bfecabc2a8c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f5ea9817c462ab8ab8089599e64c5bfecabc2a8c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f5ea9817c462ab8ab8089599e64c5bfecabc2a8c/comments", "author": null, "committer": null, "parents": [{"sha": "67933bafd71fb3b32fcc0629e030f38709d66c36", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/67933bafd71fb3b32fcc0629e030f38709d66c36", "html_url": "https://github.com/Rust-GCC/gccrs/commit/67933bafd71fb3b32fcc0629e030f38709d66c36"}], "stats": {"total": 33, "additions": 33, "deletions": 0}, "files": [{"sha": "1e01e9139866d72748ed72ffe16fa6985dc6591c", "filename": "gcc/libgcc2.c", "status": "modified", "additions": 33, "deletions": 0, "changes": 33, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f5ea9817c462ab8ab8089599e64c5bfecabc2a8c/gcc%2Flibgcc2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f5ea9817c462ab8ab8089599e64c5bfecabc2a8c/gcc%2Flibgcc2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flibgcc2.c?ref=f5ea9817c462ab8ab8089599e64c5bfecabc2a8c", "patch": "@@ -1919,6 +1919,39 @@ __clear_cache (beg, end)\n \n /* Jump to a trampoline, loading the static chain address.  */\n \n+#ifdef WINNT\n+\n+long getpagesize()\n+{\n+#ifdef _ALPHA_\n+  return 8192;\n+#else\n+  return 4096;\n+#endif\n+}\n+\n+int mprotect(addr, len, prot)\n+  char *addr;\n+  int len, prot;\n+{\n+  int np, op;\n+\n+  if (prot == 7) np = 0x40;\n+  else if (prot == 5) np = 0x20;\n+  else if (prot == 4) np = 0x10;\n+  else if (prot == 3) np = 0x04;\n+  else if (prot == 1) np = 0x02;\n+  else if (prot == 0) np = 0x01;\n+\n+  if (VirtualProtect (addr, len, np, &op))\n+    return 0;\n+  else\n+    return -1;\n+    \n+}\n+\n+#endif\n+\n #ifdef TRANSFER_FROM_TRAMPOLINE \n TRANSFER_FROM_TRAMPOLINE \n #endif"}]}