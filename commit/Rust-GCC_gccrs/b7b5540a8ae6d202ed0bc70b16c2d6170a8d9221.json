{"sha": "b7b5540a8ae6d202ed0bc70b16c2d6170a8d9221", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjdiNTU0MGE4YWU2ZDIwMmVkMGJjNzBiMTZjMmQ2MTcwYThkOTIyMQ==", "commit": {"author": {"name": "Andrey Belevantsev", "email": "abel@ispras.ru", "date": "2012-03-06T07:31:43Z"}, "committer": {"name": "Andrey Belevantsev", "email": "abel@gcc.gnu.org", "date": "2012-03-06T07:31:43Z"}, "message": "re PR rtl-optimization/52250 (ICE: in sel_remove_bb, at sel-sched-ir.c:5213 with -fsel-sched-pipelining -fsel-sched-pipelining-outer-loops -fselective-scheduling2 and other flags)\n\n        PR rtl-optimization/52250\n        * sel-sched-ir.c (maybe_tidy_empty_bb): Try harder to find a bb\n        to put note list into.  Unconditionally call move_bb_info.\n        (move_bb_info): Do not assert the blocks being in the same region,\n        just drop the note list if they are not.\n\nFrom-SVN: r184975", "tree": {"sha": "4f08c35eb91869fad11237316386d682a7dc8227", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4f08c35eb91869fad11237316386d682a7dc8227"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b7b5540a8ae6d202ed0bc70b16c2d6170a8d9221", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b7b5540a8ae6d202ed0bc70b16c2d6170a8d9221", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b7b5540a8ae6d202ed0bc70b16c2d6170a8d9221", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b7b5540a8ae6d202ed0bc70b16c2d6170a8d9221/comments", "author": {"login": "abonzo", "id": 20396542, "node_id": "MDQ6VXNlcjIwMzk2NTQy", "avatar_url": "https://avatars.githubusercontent.com/u/20396542?v=4", "gravatar_id": "", "url": "https://api.github.com/users/abonzo", "html_url": "https://github.com/abonzo", "followers_url": "https://api.github.com/users/abonzo/followers", "following_url": "https://api.github.com/users/abonzo/following{/other_user}", "gists_url": "https://api.github.com/users/abonzo/gists{/gist_id}", "starred_url": "https://api.github.com/users/abonzo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/abonzo/subscriptions", "organizations_url": "https://api.github.com/users/abonzo/orgs", "repos_url": "https://api.github.com/users/abonzo/repos", "events_url": "https://api.github.com/users/abonzo/events{/privacy}", "received_events_url": "https://api.github.com/users/abonzo/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "d9b804873742e73c36e1c8294242c7ace25f5d3c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d9b804873742e73c36e1c8294242c7ace25f5d3c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d9b804873742e73c36e1c8294242c7ace25f5d3c"}], "stats": {"total": 34, "additions": 25, "deletions": 9}, "files": [{"sha": "14f0040a9499aa30482714e6dacc3734dbfb2ace", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b7b5540a8ae6d202ed0bc70b16c2d6170a8d9221/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b7b5540a8ae6d202ed0bc70b16c2d6170a8d9221/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=b7b5540a8ae6d202ed0bc70b16c2d6170a8d9221", "patch": "@@ -1,3 +1,11 @@\n+2012-03-06  Andrey Belevantsev  <abel@ispras.ru>\n+\n+\tPR rtl-optimization/52250\n+\t* sel-sched-ir.c (maybe_tidy_empty_bb): Try harder to find a bb\n+\tto put note list into.  Unconditionally call move_bb_info.\n+\t(move_bb_info): Do not assert the blocks being in the same region,\n+\tjust drop the note list if they are not. \n+\n 2012-03-06  Oleg Endo  <olegendo@gcc.gnu.org>\n \n \tPR target/51244"}, {"sha": "c53d2e1a8e9edf27c5e40dc690081d46d78bd477", "filename": "gcc/sel-sched-ir.c", "status": "modified", "additions": 17, "deletions": 9, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b7b5540a8ae6d202ed0bc70b16c2d6170a8d9221/gcc%2Fsel-sched-ir.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b7b5540a8ae6d202ed0bc70b16c2d6170a8d9221/gcc%2Fsel-sched-ir.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fsel-sched-ir.c?ref=b7b5540a8ae6d202ed0bc70b16c2d6170a8d9221", "patch": "@@ -3658,7 +3658,7 @@ sel_recompute_toporder (void)\n static bool\n maybe_tidy_empty_bb (basic_block bb)\n {\n-  basic_block succ_bb, pred_bb;\n+  basic_block succ_bb, pred_bb, note_bb;\n   VEC (basic_block, heap) *dom_bbs;\n   edge e;\n   edge_iterator ei;\n@@ -3697,6 +3697,17 @@ maybe_tidy_empty_bb (basic_block bb)\n   pred_bb = NULL;\n   dom_bbs = NULL;\n \n+  /* Save a pred/succ from the current region to attach the notes to.  */\n+  note_bb = NULL;\n+  FOR_EACH_EDGE (e, ei, bb->preds)\n+    if (in_current_region_p (e->src))\n+      {\n+\tnote_bb = e->src;\n+\tbreak;\n+      }\n+  if (note_bb == NULL)\n+    note_bb = succ_bb;\n+\n   /* Redirect all non-fallthru edges to the next bb.  */\n   while (rescan_p)\n     {\n@@ -3746,10 +3757,8 @@ maybe_tidy_empty_bb (basic_block bb)\n   else\n     {\n       /* This is a block without fallthru predecessor.  Just delete it.  */\n-      gcc_assert (pred_bb != NULL);\n-\n-      if (in_current_region_p (pred_bb))\n-\tmove_bb_info (pred_bb, bb);\n+      gcc_assert (note_bb);\n+      move_bb_info (note_bb, bb);\n       remove_empty_bb (bb, true);\n     }\n \n@@ -5231,10 +5240,9 @@ sel_remove_bb (basic_block bb, bool remove_from_cfg_p)\n static void\n move_bb_info (basic_block merge_bb, basic_block empty_bb)\n {\n-  gcc_assert (in_current_region_p (merge_bb));\n-\n-  concat_note_lists (BB_NOTE_LIST (empty_bb),\n-\t\t     &BB_NOTE_LIST (merge_bb));\n+  if (in_current_region_p (merge_bb))\n+    concat_note_lists (BB_NOTE_LIST (empty_bb),\n+\t\t       &BB_NOTE_LIST (merge_bb));\n   BB_NOTE_LIST (empty_bb) = NULL_RTX;\n \n }"}]}