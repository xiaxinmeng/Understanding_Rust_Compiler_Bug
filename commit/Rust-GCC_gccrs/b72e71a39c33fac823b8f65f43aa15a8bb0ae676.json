{"sha": "b72e71a39c33fac823b8f65f43aa15a8bb0ae676", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjcyZTcxYTM5YzMzZmFjODIzYjhmNjVmNDNhYTE1YThiYjBhZTY3Ng==", "commit": {"author": {"name": "H.J. Lu", "email": "hongjiu.lu@intel.com", "date": "2018-07-27T14:40:47Z"}, "committer": {"name": "H.J. Lu", "email": "hjl@gcc.gnu.org", "date": "2018-07-27T14:40:47Z"}, "message": "i386: Remove _Unwind_Frames_Increment\n\nCET kernel has been changed to place a restore token on shadow stack for\nsignal handler to enhance security.  It is usually transparent to user\nprograms since kernel will pop the restore token when signal handler\nreturns.  But when an exception is thrown from a signal handler, now\nwe need to remove _Unwind_Frames_Increment to pop the the restore token\nfrom shadow stack.  Otherwise, we get\n\nFAIL: g++.dg/torture/pr85334.C   -O0  execution test\nFAIL: g++.dg/torture/pr85334.C   -O1  execution test\nFAIL: g++.dg/torture/pr85334.C   -O2  execution test\nFAIL: g++.dg/torture/pr85334.C   -O3 -g  execution test\nFAIL: g++.dg/torture/pr85334.C   -Os  execution test\nFAIL: g++.dg/torture/pr85334.C   -O2 -flto -fno-use-linker-plugin -flto-partition=none  execution test\n\n\tPR libgcc/85334\n\t* config/i386/shadow-stack-unwind.h (_Unwind_Frames_Increment):\n\tRemoved.\n\nFrom-SVN: r263030", "tree": {"sha": "4ed990f1e47d2033ac266546efb14492e60ea250", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4ed990f1e47d2033ac266546efb14492e60ea250"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b72e71a39c33fac823b8f65f43aa15a8bb0ae676", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b72e71a39c33fac823b8f65f43aa15a8bb0ae676", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b72e71a39c33fac823b8f65f43aa15a8bb0ae676", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b72e71a39c33fac823b8f65f43aa15a8bb0ae676/comments", "author": {"login": "hjl-tools", "id": 1072356, "node_id": "MDQ6VXNlcjEwNzIzNTY=", "avatar_url": "https://avatars.githubusercontent.com/u/1072356?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hjl-tools", "html_url": "https://github.com/hjl-tools", "followers_url": "https://api.github.com/users/hjl-tools/followers", "following_url": "https://api.github.com/users/hjl-tools/following{/other_user}", "gists_url": "https://api.github.com/users/hjl-tools/gists{/gist_id}", "starred_url": "https://api.github.com/users/hjl-tools/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hjl-tools/subscriptions", "organizations_url": "https://api.github.com/users/hjl-tools/orgs", "repos_url": "https://api.github.com/users/hjl-tools/repos", "events_url": "https://api.github.com/users/hjl-tools/events{/privacy}", "received_events_url": "https://api.github.com/users/hjl-tools/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "3d592d2d56ccd3298ea0121de16615d27b9fb659", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3d592d2d56ccd3298ea0121de16615d27b9fb659", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3d592d2d56ccd3298ea0121de16615d27b9fb659"}], "stats": {"total": 11, "additions": 6, "deletions": 5}, "files": [{"sha": "e0db8d16f98996f44bd8613166dbe5d54ed859ef", "filename": "libgcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b72e71a39c33fac823b8f65f43aa15a8bb0ae676/libgcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b72e71a39c33fac823b8f65f43aa15a8bb0ae676/libgcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgcc%2FChangeLog?ref=b72e71a39c33fac823b8f65f43aa15a8bb0ae676", "patch": "@@ -1,3 +1,9 @@\n+2018-07-27  H.J. Lu  <hongjiu.lu@intel.com>\n+\n+\tPR libgcc/85334\n+\t* config/i386/shadow-stack-unwind.h (_Unwind_Frames_Increment):\n+\tRemoved.\n+\n 2018-07-05  James Clarke  <jrtc27@jrtc27.com>\n \n \t* configure: Regenerated."}, {"sha": "40f48df2aecdc1c1836cf55853ef13cbde219f32", "filename": "libgcc/config/i386/shadow-stack-unwind.h", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b72e71a39c33fac823b8f65f43aa15a8bb0ae676/libgcc%2Fconfig%2Fi386%2Fshadow-stack-unwind.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b72e71a39c33fac823b8f65f43aa15a8bb0ae676/libgcc%2Fconfig%2Fi386%2Fshadow-stack-unwind.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgcc%2Fconfig%2Fi386%2Fshadow-stack-unwind.h?ref=b72e71a39c33fac823b8f65f43aa15a8bb0ae676", "patch": "@@ -49,8 +49,3 @@ see the files COPYING3 and COPYING.RUNTIME respectively.  If not, see\n \t}\t\t\t\t\t\\\n     }\t\t\t\t\t\t\\\n     while (0)\n-\n-/* Increment frame count.  Skip signal frames.  */\n-#undef _Unwind_Frames_Increment\n-#define _Unwind_Frames_Increment(context, frames) \\\n-  if (!_Unwind_IsSignalFrame (context)) frames++"}]}