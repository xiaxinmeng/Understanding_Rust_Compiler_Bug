{"sha": "c208436c7bef0b3d4aa15073347404b9178e9280", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzIwODQzNmM3YmVmMGIzZDRhYTE1MDczMzQ3NDA0YjkxNzhlOTI4MA==", "commit": {"author": {"name": "Steve Ellcey", "email": "sje@cup.hp.com", "date": "2009-02-13T21:59:32Z"}, "committer": {"name": "Steve Ellcey", "email": "sje@gcc.gnu.org", "date": "2009-02-13T21:59:32Z"}, "message": "re PR target/38056 (Missed tail calls on ia64)\n\n\tPR target/38056\n\t* config/ia64/ia64.c (ia64_function_ok_for_sibcall): Check\n\tTARGET_CONST_GP.\n\t* gcc.target/ia64/sibcall-opt-1.c: New test.\n\t* gcc.target/ia64/sibcall-opt-2.c: New test.\n\nFrom-SVN: r144168", "tree": {"sha": "2badc0d5087fc55bf5e504f84afe8003555ac6d1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2badc0d5087fc55bf5e504f84afe8003555ac6d1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c208436c7bef0b3d4aa15073347404b9178e9280", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c208436c7bef0b3d4aa15073347404b9178e9280", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c208436c7bef0b3d4aa15073347404b9178e9280", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c208436c7bef0b3d4aa15073347404b9178e9280/comments", "author": null, "committer": null, "parents": [{"sha": "686c82b505d95d57302821df084c751b9528cea7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/686c82b505d95d57302821df084c751b9528cea7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/686c82b505d95d57302821df084c751b9528cea7"}], "stats": {"total": 41, "additions": 39, "deletions": 2}, "files": [{"sha": "f4b29ef60038882fcfb7e888e0da0bcb30d6b0eb", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c208436c7bef0b3d4aa15073347404b9178e9280/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c208436c7bef0b3d4aa15073347404b9178e9280/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=c208436c7bef0b3d4aa15073347404b9178e9280", "patch": "@@ -1,3 +1,9 @@\n+2009-02-13  Steve Ellcey  <sje@cup.hp.com>\n+\n+\tPR target/38056\n+\t* config/ia64/ia64.c (ia64_function_ok_for_sibcall): Check\n+\tTARGET_CONST_GP.\n+\n 2009-02-13  H.J. Lu  <hongjiu.lu@intel.com>\n \n \tPR target/39149"}, {"sha": "495d943d10ccef8adc5f82c8448d4fa9da583311", "filename": "gcc/config/ia64/ia64.c", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c208436c7bef0b3d4aa15073347404b9178e9280/gcc%2Fconfig%2Fia64%2Fia64.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c208436c7bef0b3d4aa15073347404b9178e9280/gcc%2Fconfig%2Fia64%2Fia64.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fia64%2Fia64.c?ref=c208436c7bef0b3d4aa15073347404b9178e9280", "patch": "@@ -4365,8 +4365,9 @@ ia64_function_ok_for_sibcall (tree decl, tree exp ATTRIBUTE_UNUSED)\n     return false;\n \n   /* We must always return with our current GP.  This means we can\n-     only sibcall to functions defined in the current module.  */\n-  return decl && (*targetm.binds_local_p) (decl);\n+     only sibcall to functions defined in the current module unless\n+     TARGET_CONST_GP is set to true.  */\n+  return (decl && (*targetm.binds_local_p) (decl)) || TARGET_CONST_GP;\n }\n \f\n "}, {"sha": "ca7aece73b7af734920db107cbe68f883d69a51b", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c208436c7bef0b3d4aa15073347404b9178e9280/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c208436c7bef0b3d4aa15073347404b9178e9280/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=c208436c7bef0b3d4aa15073347404b9178e9280", "patch": "@@ -1,3 +1,9 @@\n+2009-02-13  Steve Ellcey  <sje@cup.hp.com>\n+\n+\tPR target/38056\n+\t* gcc.target/ia64/sibcall-opt-1.c: New test.\n+\t* gcc.target/ia64/sibcall-opt-2.c: New test.\n+\n 2009-02-13  Paul Thomas  <pault@gcc.gnu.org>\n \n \tPR fortran/36528"}, {"sha": "6e8d1a2faed118696b3af723ed81d77a72cc71b0", "filename": "gcc/testsuite/gcc.target/ia64/sibcall-opt-1.c", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c208436c7bef0b3d4aa15073347404b9178e9280/gcc%2Ftestsuite%2Fgcc.target%2Fia64%2Fsibcall-opt-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c208436c7bef0b3d4aa15073347404b9178e9280/gcc%2Ftestsuite%2Fgcc.target%2Fia64%2Fsibcall-opt-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fia64%2Fsibcall-opt-1.c?ref=c208436c7bef0b3d4aa15073347404b9178e9280", "patch": "@@ -0,0 +1,12 @@\n+/* PR target/38056.  Do not do sibcall optimization across object file\n+   boundery when -mconstant-gp is not used.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-O2\" } */\n+/* { dg-final { scan-assembler \"br.call.*bar\" } } */\n+\n+int bar(int x);\n+\n+int foo(int x)\n+{\n+  return (bar(x + 1));\n+}"}, {"sha": "d802b792deae834fc1f00d0f9f24aea822a6625f", "filename": "gcc/testsuite/gcc.target/ia64/sibcall-opt-2.c", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c208436c7bef0b3d4aa15073347404b9178e9280/gcc%2Ftestsuite%2Fgcc.target%2Fia64%2Fsibcall-opt-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c208436c7bef0b3d4aa15073347404b9178e9280/gcc%2Ftestsuite%2Fgcc.target%2Fia64%2Fsibcall-opt-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fia64%2Fsibcall-opt-2.c?ref=c208436c7bef0b3d4aa15073347404b9178e9280", "patch": "@@ -0,0 +1,12 @@\n+/* PR target/38056.  Do sibcall optimization across object file\n+   boundery when -mconstant-gp is used.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -mconstant-gp\" } */\n+/* { dg-final { scan-assembler-not \"br.call.*bar\" } } */\n+\n+int bar(int x);\n+\n+int foo(int x)\n+{\n+  return (bar(x + 1));\n+}"}]}