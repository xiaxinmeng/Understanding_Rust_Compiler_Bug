{"sha": "4c3a6ca189d0bf3a62b4f529275e0a666543650c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NGMzYTZjYTE4OWQwYmYzYTYyYjRmNTI5Mjc1ZTBhNjY2NTQzNjUwYw==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2005-07-07T15:55:53Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2005-07-07T15:55:53Z"}, "message": "scanner.c (preprocessor_line): Only set current_file->line when errors have not been encountered.\n\n\t* scanner.c (preprocessor_line): Only set current_file->line when errors\n\thave not been encountered.  Warn and don't crash if a file leave\n\tpreprocessor line has no corresponding entering line.  Formatting.\n\n\t* gfortran.dg/badline.f: New test.\n\nFrom-SVN: r101717", "tree": {"sha": "6b2f9b6876ae8fbaeef20fec5fcae091d024b66a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6b2f9b6876ae8fbaeef20fec5fcae091d024b66a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4c3a6ca189d0bf3a62b4f529275e0a666543650c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4c3a6ca189d0bf3a62b4f529275e0a666543650c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4c3a6ca189d0bf3a62b4f529275e0a666543650c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4c3a6ca189d0bf3a62b4f529275e0a666543650c/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "452190fb6ac2ab8706715a14e82d742ae545d6c2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/452190fb6ac2ab8706715a14e82d742ae545d6c2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/452190fb6ac2ab8706715a14e82d742ae545d6c2"}], "stats": {"total": 54, "additions": 38, "deletions": 16}, "files": [{"sha": "45ae28c327f6595ee08a32475792f4cca1f42ea9", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4c3a6ca189d0bf3a62b4f529275e0a666543650c/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4c3a6ca189d0bf3a62b4f529275e0a666543650c/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=4c3a6ca189d0bf3a62b4f529275e0a666543650c", "patch": "@@ -1,3 +1,9 @@\n+2005-07-07  Jakub Jelinek  <jakub@redhat.com>\n+\n+\t* scanner.c (preprocessor_line): Only set current_file->line when errors\n+\thave not been encountered.  Warn and don't crash if a file leave\n+\tpreprocessor line has no corresponding entering line.  Formatting.\n+\n 2005-07-07  Steven Bosscher  <stevenb@suse.de>\n \n \t* primary.c (match_hollerith_constant): Use int, not unsigned int,"}, {"sha": "b2efd81cf8b5cf4f2dca4dcfc696de40638b17ef", "filename": "gcc/fortran/scanner.c", "status": "modified", "additions": 24, "deletions": 16, "changes": 40, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4c3a6ca189d0bf3a62b4f529275e0a666543650c/gcc%2Ffortran%2Fscanner.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4c3a6ca189d0bf3a62b4f529275e0a666543650c/gcc%2Ffortran%2Fscanner.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fscanner.c?ref=4c3a6ca189d0bf3a62b4f529275e0a666543650c", "patch": "@@ -839,15 +839,13 @@ preprocessor_line (char *c)\n \n   line = atoi (c);\n \n-  /* Set new line number.  */\n-  current_file->line = line;\n-\n-  c = strchr (c, ' '); \n+  c = strchr (c, ' ');\n   if (c == NULL)\n-    /* No file name given.  */\n-    return;\n-\n-\n+    {\n+      /* No file name given.  Set new line number.  */\n+      current_file->line = line;\n+      return;\n+    }\n \n   /* Skip spaces.  */\n   while (*c == ' ' || *c == '\\t')\n@@ -880,7 +878,7 @@ preprocessor_line (char *c)\n \n \n   /* Get flags.  */\n-  \n+\n   flag[1] = flag[2] = flag[3] = flag[4] = flag[5] = false;\n \n   for (;;)\n@@ -895,35 +893,45 @@ preprocessor_line (char *c)\n       if (1 <= i && i <= 4)\n \tflag[i] = true;\n     }\n-     \n+\n   /* Interpret flags.  */\n-  \n+\n   if (flag[1] || flag[3]) /* Starting new file.  */\n     {\n       f = get_file (filename, LC_RENAME);\n       f->up = current_file;\n       current_file = f;\n     }\n-  \n+\n   if (flag[2]) /* Ending current file.  */\n     {\n-      current_file = current_file->up;\n+      if (strcmp (current_file->filename, filename) != 0)\n+\t{\n+\t  gfc_warning_now (\"%s:%d: file %s left but not entered\",\n+\t\t\t   current_file->filename, current_file->line,\n+\t\t\t   filename);\n+\t  return;\n+\t}\n+      if (current_file->up)\n+\tcurrent_file = current_file->up;\n     }\n-  \n+\n   /* The name of the file can be a temporary file produced by\n      cpp. Replace the name if it is different.  */\n-  \n+\n   if (strcmp (current_file->filename, filename) != 0)\n     {\n       gfc_free (current_file->filename);\n       current_file->filename = gfc_getmem (strlen (filename) + 1);\n       strcpy (current_file->filename, filename);\n     }\n \n+  /* Set new line number.  */\n+  current_file->line = line;\n   return;\n \n  bad_cpp_line:\n-  gfc_warning_now (\"%s:%d: Illegal preprocessor directive\", \n+  gfc_warning_now (\"%s:%d: Illegal preprocessor directive\",\n \t\t   current_file->filename, current_file->line);\n   current_file->line++;\n }"}, {"sha": "36a93cd17c1a29fc80659c5ab36b36d350d117e1", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4c3a6ca189d0bf3a62b4f529275e0a666543650c/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4c3a6ca189d0bf3a62b4f529275e0a666543650c/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=4c3a6ca189d0bf3a62b4f529275e0a666543650c", "patch": "@@ -1,3 +1,7 @@\n+2005-07-07  Jakub Jelinek  <jakub@redhat.com>\n+\n+\t* gfortran.dg/badline.f: New test.\n+\n 2005-07-07  Feng Wang  <fengwang@nudt.edu.cn>\n \n \tPR fortran/16531"}, {"sha": "9787ecd951955c2c4ed5066416cc546e37ad28d8", "filename": "gcc/testsuite/gfortran.dg/badline.f", "status": "added", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4c3a6ca189d0bf3a62b4f529275e0a666543650c/gcc%2Ftestsuite%2Fgfortran.dg%2Fbadline.f", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4c3a6ca189d0bf3a62b4f529275e0a666543650c/gcc%2Ftestsuite%2Fgfortran.dg%2Fbadline.f", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fbadline.f?ref=4c3a6ca189d0bf3a62b4f529275e0a666543650c", "patch": "@@ -0,0 +1,4 @@\n+\tsubroutine foo \n+# 18 \"src/badline.F\" 2\n+\tend\n+! { dg-warning \"left but not entered\" \"\" { target *-*-* } 2 }"}]}