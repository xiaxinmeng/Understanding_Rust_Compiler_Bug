{"sha": "998c75b661fa518b79a33f523eb716c246cba756", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTk4Yzc1YjY2MWZhNTE4Yjc5YTMzZjUyM2ViNzE2YzI0NmNiYTc1Ng==", "commit": {"author": {"name": "Bernd Schmidt", "email": "bernds@codesourcery.com", "date": "2011-06-20T17:16:10Z"}, "committer": {"name": "Bernd Schmidt", "email": "bernds@gcc.gnu.org", "date": "2011-06-20T17:16:10Z"}, "message": "regrename.c (scan_rtx_reg): Handle the case where we write to an open chain in a smaller mode without...\n\n\t* regrename.c (scan_rtx_reg): Handle the case where we write to an\n\topen chain in a smaller mode without failing the entire block.\n\nFrom-SVN: r175225", "tree": {"sha": "96ea288af6b7d30a2fff457fd710280aa4ed49cd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/96ea288af6b7d30a2fff457fd710280aa4ed49cd"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/998c75b661fa518b79a33f523eb716c246cba756", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/998c75b661fa518b79a33f523eb716c246cba756", "html_url": "https://github.com/Rust-GCC/gccrs/commit/998c75b661fa518b79a33f523eb716c246cba756", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/998c75b661fa518b79a33f523eb716c246cba756/comments", "author": null, "committer": null, "parents": [{"sha": "222d3b39a663cccdaa87d0b5cfb0cc4a591013b2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/222d3b39a663cccdaa87d0b5cfb0cc4a591013b2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/222d3b39a663cccdaa87d0b5cfb0cc4a591013b2"}], "stats": {"total": 22, "additions": 18, "deletions": 4}, "files": [{"sha": "59300e5e82166d86f3f6b4408b2fd280f2f2184f", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/998c75b661fa518b79a33f523eb716c246cba756/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/998c75b661fa518b79a33f523eb716c246cba756/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=998c75b661fa518b79a33f523eb716c246cba756", "patch": "@@ -1,3 +1,8 @@\n+2011-06-20  Bernd Schmidt  <bernds@codesourcery.com>\n+\n+\t* regrename.c (scan_rtx_reg): Handle the case where we write to an\n+\topen chain in a smaller mode without failing the entire block.\n+\n 2011-06-20  H.J. Lu  <hongjiu.lu@intel.com>\n \n \tPR middle-end/47725"}, {"sha": "b83c7258fb7fb956a0e7591be18fcbfafda162b1", "filename": "gcc/regrename.c", "status": "modified", "additions": 13, "deletions": 4, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/998c75b661fa518b79a33f523eb716c246cba756/gcc%2Fregrename.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/998c75b661fa518b79a33f523eb716c246cba756/gcc%2Fregrename.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fregrename.c?ref=998c75b661fa518b79a33f523eb716c246cba756", "patch": "@@ -721,25 +721,34 @@ scan_rtx_reg (rtx insn, rtx *loc, enum reg_class cl, enum scan_actions action,\n \t In either case, we remove this element from open_chains.  */\n \n       if ((action == terminate_dead || action == terminate_write)\n-\t  && superset)\n+\t  && (superset || subset))\n \t{\n \t  unsigned nregs;\n \n \t  head->terminated = 1;\n+\t  if (subset && !superset)\n+\t    head->cannot_rename = 1;\n \t  head->next_chain = closed_chains;\n \t  closed_chains = head;\n \t  bitmap_clear_bit (&open_chains_set, head->id);\n \n \t  nregs = head->nregs;\n \t  while (nregs-- > 0)\n-\t    CLEAR_HARD_REG_BIT (live_in_chains, head->regno + nregs);\n+\t    {\n+\t      CLEAR_HARD_REG_BIT (live_in_chains, head->regno + nregs);\n+\t      if (subset && !superset\n+\t\t  && (head->regno + nregs < this_regno\n+\t\t      || head->regno + nregs >= this_regno + this_nregs))\n+\t\tSET_HARD_REG_BIT (live_hard_regs, head->regno + nregs);\n+\t    }\n \n \t  *p = next;\n \t  if (dump_file)\n \t    fprintf (dump_file,\n-\t\t     \"Closing chain %s (%d) at insn %d (%s)\\n\",\n+\t\t     \"Closing chain %s (%d) at insn %d (%s%s)\\n\",\n \t\t     reg_names[head->regno], head->id, INSN_UID (insn),\n-\t\t     scan_actions_name[(int) action]);\n+\t\t     scan_actions_name[(int) action],\n+\t\t     superset ? \", superset\" : subset ? \", subset\" : \"\");\n \t}\n       else if (action == terminate_dead || action == terminate_write)\n \t{"}]}