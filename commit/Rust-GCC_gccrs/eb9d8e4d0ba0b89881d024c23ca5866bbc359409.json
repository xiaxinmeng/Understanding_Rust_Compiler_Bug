{"sha": "eb9d8e4d0ba0b89881d024c23ca5866bbc359409", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWI5ZDhlNGQwYmEwYjg5ODgxZDAyNGMyM2NhNTg2NmJiYzM1OTQwOQ==", "commit": {"author": {"name": "John Wehle", "email": "john@feith.com", "date": "2001-10-11T03:51:24Z"}, "committer": {"name": "John Wehle", "email": "wehle@gcc.gnu.org", "date": "2001-10-11T03:51:24Z"}, "message": "rtlanal.c (noop_move_p): Insns with a REG_RETVAL note should not be considered as a no-op.\n\n\t* rtlanal.c (noop_move_p): Insns with a REG_RETVAL note\n\tshould not be considered as a no-op.\n\t* flow.c (delete_noop_moves): Handle REG_LIBCALL notes.\n\nFrom-SVN: r46174", "tree": {"sha": "57d914a811598a624f337dd3ee4f78fbb3d988ff", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/57d914a811598a624f337dd3ee4f78fbb3d988ff"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/eb9d8e4d0ba0b89881d024c23ca5866bbc359409", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/eb9d8e4d0ba0b89881d024c23ca5866bbc359409", "html_url": "https://github.com/Rust-GCC/gccrs/commit/eb9d8e4d0ba0b89881d024c23ca5866bbc359409", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/eb9d8e4d0ba0b89881d024c23ca5866bbc359409/comments", "author": {"login": "jlwehle", "id": 46985578, "node_id": "MDQ6VXNlcjQ2OTg1NTc4", "avatar_url": "https://avatars.githubusercontent.com/u/46985578?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jlwehle", "html_url": "https://github.com/jlwehle", "followers_url": "https://api.github.com/users/jlwehle/followers", "following_url": "https://api.github.com/users/jlwehle/following{/other_user}", "gists_url": "https://api.github.com/users/jlwehle/gists{/gist_id}", "starred_url": "https://api.github.com/users/jlwehle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jlwehle/subscriptions", "organizations_url": "https://api.github.com/users/jlwehle/orgs", "repos_url": "https://api.github.com/users/jlwehle/repos", "events_url": "https://api.github.com/users/jlwehle/events{/privacy}", "received_events_url": "https://api.github.com/users/jlwehle/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "b36948478c22c58018d0a888ee8ca393dea60dc9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b36948478c22c58018d0a888ee8ca393dea60dc9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b36948478c22c58018d0a888ee8ca393dea60dc9"}], "stats": {"total": 32, "additions": 30, "deletions": 2}, "files": [{"sha": "1b06df2be1d32ba3469e4af4d0defbf6a464da60", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eb9d8e4d0ba0b89881d024c23ca5866bbc359409/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eb9d8e4d0ba0b89881d024c23ca5866bbc359409/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=eb9d8e4d0ba0b89881d024c23ca5866bbc359409", "patch": "@@ -1,3 +1,9 @@\n+Wed Oct 10 23:49:06 EDT 2001  John Wehle  (john@feith.com)\n+\n+\t* rtlanal.c (noop_move_p): Insns with a REG_RETVAL note\n+\tshould not be considered as a no-op.\n+\t* flow.c (delete_noop_moves): Handle REG_LIBCALL notes.\n+\n 2001-10-10  Stan Shebs  <shebs@apple.com>\n \n \t* alias.c: Remove uses of \"register\" specifier in declarations"}, {"sha": "030a23370521a6a1b8ac860906a884a49029dfb6", "filename": "gcc/flow.c", "status": "modified", "additions": 19, "deletions": 2, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eb9d8e4d0ba0b89881d024c23ca5866bbc359409/gcc%2Fflow.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eb9d8e4d0ba0b89881d024c23ca5866bbc359409/gcc%2Fflow.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fflow.c?ref=eb9d8e4d0ba0b89881d024c23ca5866bbc359409", "patch": "@@ -771,8 +771,25 @@ delete_noop_moves (f)\n \t  next = NEXT_INSN (insn);\n \t  if (INSN_P (insn) && noop_move_p (insn))\n \t    {\n-\t      /* Do not call delete_insn here to not confuse backward\n-\t         pointers of LIBCALL block.  */\n+\t      rtx note;\n+\n+\t      /* If we're about to remove the first insn of a libcall\n+\t\t then move the libcall note to the next real insn and\n+\t\t update the retval note.  */\n+\t      if ((note = find_reg_note (insn, REG_LIBCALL, NULL_RTX))\n+\t\t       && XEXP (note, 0) != insn)\n+\t\t{\n+\t\t  rtx new_libcall_insn = next_real_insn (insn);\n+\t\t  rtx retval_note = find_reg_note (XEXP (note, 0),\n+\t\t\t\t\t\t   REG_RETVAL, NULL_RTX);\n+\t\t  REG_NOTES (new_libcall_insn)\n+\t\t    = gen_rtx_INSN_LIST (REG_LIBCALL, XEXP (note, 0),\n+\t\t\t\t\t REG_NOTES (new_libcall_insn));\n+\t\t  XEXP (retval_note, 0) = new_libcall_insn;\n+\t\t}\n+\n+\t      /* Do not call delete_insn here since that may change\n+\t         the basic block boundaries which upsets some callers.  */\n \t      PUT_CODE (insn, NOTE);\n \t      NOTE_LINE_NUMBER (insn) = NOTE_INSN_DELETED;\n \t      NOTE_SOURCE_FILE (insn) = 0;"}, {"sha": "9cf879c1377868de856a82e33c9287ce3603c36b", "filename": "gcc/rtlanal.c", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eb9d8e4d0ba0b89881d024c23ca5866bbc359409/gcc%2Frtlanal.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eb9d8e4d0ba0b89881d024c23ca5866bbc359409/gcc%2Frtlanal.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Frtlanal.c?ref=eb9d8e4d0ba0b89881d024c23ca5866bbc359409", "patch": "@@ -1037,6 +1037,11 @@ noop_move_p (insn)\n   if (find_reg_note (insn, REG_EQUAL, NULL_RTX))\n     return 0;\n \n+  /* For now treat an insn with a REG_RETVAL note as a\n+     a special insn which should not be considered a no-op.  */\n+  if (find_reg_note (insn, REG_RETVAL, NULL_RTX))\n+    return 0;\n+\n   if (GET_CODE (pat) == SET && set_noop_p (pat))\n     return 1;\n "}]}