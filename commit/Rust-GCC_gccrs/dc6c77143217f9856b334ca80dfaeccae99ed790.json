{"sha": "dc6c77143217f9856b334ca80dfaeccae99ed790", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZGM2Yzc3MTQzMjE3Zjk4NTZiMzM0Y2E4MGRmYWVjY2FlOTllZDc5MA==", "commit": {"author": {"name": "Paul Thomas", "email": "pault@gcc.gnu.org", "date": "2006-09-19T11:04:55Z"}, "committer": {"name": "Paul Thomas", "email": "pault@gcc.gnu.org", "date": "2006-09-19T11:04:55Z"}, "message": "re PR fortran/29101 (Memory leak in gfortran)\n\n2006-09-19 Paul Thomas <pault@gcc.gnu.org>\n\t   Steven Bosscher  <steven@gcc.gnu.org>\n\n\tPR fortran/29101\n\t* trans-stmt.c (gfc_trans_character_select): Store the label\n\tfrom select_string and then clean up any temporaries from the\n\tconversion of the select expression, before branching to the\n\tselected case.\n\n\nCo-Authored-By: Steven Bosscher <steven@gcc.gnu.org>\n\nFrom-SVN: r117053", "tree": {"sha": "ca773d64825ec2842748129d52b40c7e01295e98", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ca773d64825ec2842748129d52b40c7e01295e98"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/dc6c77143217f9856b334ca80dfaeccae99ed790", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dc6c77143217f9856b334ca80dfaeccae99ed790", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dc6c77143217f9856b334ca80dfaeccae99ed790", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dc6c77143217f9856b334ca80dfaeccae99ed790/comments", "author": null, "committer": null, "parents": [{"sha": "95cefe5f0ea9e244b73de42ef1ee54d2d9b3a5f6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/95cefe5f0ea9e244b73de42ef1ee54d2d9b3a5f6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/95cefe5f0ea9e244b73de42ef1ee54d2d9b3a5f6"}], "stats": {"total": 19, "additions": 16, "deletions": 3}, "files": [{"sha": "4a620fdc4139af2e55833b641c9aa316e2be21b4", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dc6c77143217f9856b334ca80dfaeccae99ed790/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dc6c77143217f9856b334ca80dfaeccae99ed790/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=dc6c77143217f9856b334ca80dfaeccae99ed790", "patch": "@@ -1,3 +1,12 @@\n+2006-09-19 Paul Thomas <pault@gcc.gnu.org>\n+\t   Steven Bosscher  <steven@gcc.gnu.org>\n+\n+\tPR fortran/29101\n+\t* trans-stmt.c (gfc_trans_character_select): Store the label\n+\tfrom select_string and then clean up any temporaries from the\n+\tconversion of the select expression, before branching to the\n+\tselected case.\n+\n 2006-09-18 Paul Thomas <pault@gcc.gnu.org>\n \n \tPR fortran/28526"}, {"sha": "e4cb94fff84219d593599c275efa96dabc8b1f6c", "filename": "gcc/fortran/trans-stmt.c", "status": "modified", "additions": 7, "deletions": 3, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dc6c77143217f9856b334ca80dfaeccae99ed790/gcc%2Ffortran%2Ftrans-stmt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dc6c77143217f9856b334ca80dfaeccae99ed790/gcc%2Ffortran%2Ftrans-stmt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-stmt.c?ref=dc6c77143217f9856b334ca80dfaeccae99ed790", "patch": "@@ -1307,6 +1307,7 @@ static tree\n gfc_trans_character_select (gfc_code *code)\n {\n   tree init, node, end_label, tmp, type, args, *labels;\n+  tree case_label;\n   stmtblock_t block, body;\n   gfc_case *cp, *d;\n   gfc_code *c;\n@@ -1464,7 +1465,12 @@ gfc_trans_character_select (gfc_code *code)\n   gfc_add_block_to_block (&block, &se.pre);\n \n   tmp = build_function_call_expr (gfor_fndecl_select_string, args);\n-  tmp = build1 (GOTO_EXPR, void_type_node, tmp);\n+  case_label = gfc_create_var (TREE_TYPE (tmp), \"case_label\");\n+  gfc_add_modify_expr (&block, case_label, tmp);\n+\n+  gfc_add_block_to_block (&block, &se.post);\n+\n+  tmp = build1 (GOTO_EXPR, void_type_node, case_label);\n   gfc_add_expr_to_block (&block, tmp);\n \n   tmp = gfc_finish_block (&body);\n@@ -1475,8 +1481,6 @@ gfc_trans_character_select (gfc_code *code)\n   if (n != 0)\n     gfc_free (labels);\n \n-  gfc_add_block_to_block (&block, &se.post);\n-\n   return gfc_finish_block (&block);\n }\n "}]}