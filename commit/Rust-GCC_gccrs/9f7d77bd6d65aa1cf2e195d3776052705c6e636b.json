{"sha": "9f7d77bd6d65aa1cf2e195d3776052705c6e636b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWY3ZDc3YmQ2ZDY1YWExY2YyZTE5NWQzNzc2MDUyNzA1YzZlNjM2Yg==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2021-04-10T15:01:54Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2021-04-10T15:01:54Z"}, "message": "c: Avoid clobbering TREE_TYPE (error_mark_node) [PR99990]\n\nThe following testcase ICEs during error recovery, because finish_decl\noverwrites TREE_TYPE (error_mark_node), which better should stay always\nto be error_mark_node.\n\n2021-04-10  Jakub Jelinek  <jakub@redhat.com>\n\n\tPR c/99990\n\t* c-decl.c (finish_decl): Don't overwrite TREE_TYPE of\n\terror_mark_node.\n\n\t* gcc.dg/pr99990.c: New test.", "tree": {"sha": "432dd2899823346bfeafa314486c445e3c5ef9a8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/432dd2899823346bfeafa314486c445e3c5ef9a8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9f7d77bd6d65aa1cf2e195d3776052705c6e636b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9f7d77bd6d65aa1cf2e195d3776052705c6e636b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9f7d77bd6d65aa1cf2e195d3776052705c6e636b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9f7d77bd6d65aa1cf2e195d3776052705c6e636b/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0344b5b822b310921a432b9ffcb9ea0b3964820d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0344b5b822b310921a432b9ffcb9ea0b3964820d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0344b5b822b310921a432b9ffcb9ea0b3964820d"}], "stats": {"total": 14, "additions": 13, "deletions": 1}, "files": [{"sha": "3c254511bd88f7d508aed40922df6ebc5136b6e0", "filename": "gcc/c/c-decl.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9f7d77bd6d65aa1cf2e195d3776052705c6e636b/gcc%2Fc%2Fc-decl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9f7d77bd6d65aa1cf2e195d3776052705c6e636b/gcc%2Fc%2Fc-decl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc%2Fc-decl.c?ref=9f7d77bd6d65aa1cf2e195d3776052705c6e636b", "patch": "@@ -5402,7 +5402,7 @@ finish_decl (tree decl, location_t init_loc, tree init,\n \t  gcc_unreachable ();\n \t}\n \n-      if (DECL_INITIAL (decl))\n+      if (DECL_INITIAL (decl) && DECL_INITIAL (decl) != error_mark_node)\n \tTREE_TYPE (DECL_INITIAL (decl)) = type;\n \n       relayout_decl (decl);"}, {"sha": "6878b00ce0d6a6f942d0835e6a9b82e4e1aed37d", "filename": "gcc/testsuite/gcc.dg/pr99990.c", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9f7d77bd6d65aa1cf2e195d3776052705c6e636b/gcc%2Ftestsuite%2Fgcc.dg%2Fpr99990.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9f7d77bd6d65aa1cf2e195d3776052705c6e636b/gcc%2Ftestsuite%2Fgcc.dg%2Fpr99990.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr99990.c?ref=9f7d77bd6d65aa1cf2e195d3776052705c6e636b", "patch": "@@ -0,0 +1,12 @@\n+/* PR c/99990 */\n+/* { dg-do compile } */\n+/* { dg-options \"\" } */\n+\n+#include <stdarg.h>\n+\n+void\n+foo ()\n+{\n+  va_arg (0, long);\t/* { dg-error \"first argument to 'va_arg' not of type 'va_list'\" } */\n+  void *b[] = 0;\t/* { dg-error \"invalid initializer\" } */\n+}"}]}