{"sha": "4853031ec832b9fd29e0894016038cc9f83e31cc", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDg1MzAzMWVjODMyYjlmZDI5ZTA4OTQwMTYwMzhjYzlmODNlMzFjYw==", "commit": {"author": {"name": "Marek Polacek", "email": "polacek@redhat.com", "date": "2015-04-24T11:53:27Z"}, "committer": {"name": "Marek Polacek", "email": "mpolacek@gcc.gnu.org", "date": "2015-04-24T11:53:27Z"}, "message": "re PR c/65830 (-Wno-shift-count-negative -Wno-shift-count-overflow don't work with const ints)\n\n\tPR c/65830\n\t* c-common.c (c_fully_fold_internal): Use OPT_Wshift_count_negative\n\tand OPT_Wshift_count_overflow.\n\n\t* c-c++-common/pr65830.c: New test.\n\nFrom-SVN: r222407", "tree": {"sha": "722f8443b2e54bb8e8d1e525c5679186842f8208", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/722f8443b2e54bb8e8d1e525c5679186842f8208"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4853031ec832b9fd29e0894016038cc9f83e31cc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4853031ec832b9fd29e0894016038cc9f83e31cc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4853031ec832b9fd29e0894016038cc9f83e31cc", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4853031ec832b9fd29e0894016038cc9f83e31cc/comments", "author": {"login": "mpolacek", "id": 10496300, "node_id": "MDQ6VXNlcjEwNDk2MzAw", "avatar_url": "https://avatars.githubusercontent.com/u/10496300?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mpolacek", "html_url": "https://github.com/mpolacek", "followers_url": "https://api.github.com/users/mpolacek/followers", "following_url": "https://api.github.com/users/mpolacek/following{/other_user}", "gists_url": "https://api.github.com/users/mpolacek/gists{/gist_id}", "starred_url": "https://api.github.com/users/mpolacek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mpolacek/subscriptions", "organizations_url": "https://api.github.com/users/mpolacek/orgs", "repos_url": "https://api.github.com/users/mpolacek/repos", "events_url": "https://api.github.com/users/mpolacek/events{/privacy}", "received_events_url": "https://api.github.com/users/mpolacek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "b878781346e97ade9087d5c010e29ff09492b6fb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b878781346e97ade9087d5c010e29ff09492b6fb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b878781346e97ade9087d5c010e29ff09492b6fb"}], "stats": {"total": 41, "additions": 35, "deletions": 6}, "files": [{"sha": "718aa2ad0a00cd58c2b7b82fbc87fa87d5e3a2bd", "filename": "gcc/c-family/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4853031ec832b9fd29e0894016038cc9f83e31cc/gcc%2Fc-family%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4853031ec832b9fd29e0894016038cc9f83e31cc/gcc%2Fc-family%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2FChangeLog?ref=4853031ec832b9fd29e0894016038cc9f83e31cc", "patch": "@@ -1,3 +1,9 @@\n+2015-04-24  Marek Polacek  <polacek@redhat.com>\n+\n+\tPR c/65830\n+\t* c-common.c (c_fully_fold_internal): Use OPT_Wshift_count_negative\n+\tand OPT_Wshift_count_overflow.\n+\n 2015-04-24  Marek Polacek  <polacek@redhat.com>\n \n \tPR c/61534"}, {"sha": "b8e141eb42fed2f088cec09ed9aeb0e624f409cf", "filename": "gcc/c-family/c-common.c", "status": "modified", "additions": 8, "deletions": 6, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4853031ec832b9fd29e0894016038cc9f83e31cc/gcc%2Fc-family%2Fc-common.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4853031ec832b9fd29e0894016038cc9f83e31cc/gcc%2Fc-family%2Fc-common.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2Fc-common.c?ref=4853031ec832b9fd29e0894016038cc9f83e31cc", "patch": "@@ -1370,15 +1370,17 @@ c_fully_fold_internal (tree expr, bool in_init, bool *maybe_const_operands,\n \t  && c_inhibit_evaluation_warnings == 0)\n \t{\n \t  if (tree_int_cst_sgn (op1) < 0)\n-\t    warning_at (loc, 0, (code == LSHIFT_EXPR\n-\t\t\t\t ? G_(\"left shift count is negative\")\n-\t\t\t\t : G_(\"right shift count is negative\")));\n+\t    warning_at (loc, OPT_Wshift_count_negative,\n+\t\t\t(code == LSHIFT_EXPR\n+\t\t\t ? G_(\"left shift count is negative\")\n+\t\t\t : G_(\"right shift count is negative\")));\n \t  else if (compare_tree_int (op1,\n \t\t\t\t     TYPE_PRECISION (TREE_TYPE (orig_op0)))\n \t\t   >= 0)\n-\t    warning_at (loc, 0, (code == LSHIFT_EXPR\n-\t\t\t\t ? G_(\"left shift count >= width of type\")\n-\t\t\t\t : G_(\"right shift count >= width of type\")));\n+\t    warning_at (loc, OPT_Wshift_count_overflow,\n+\t\t\t(code == LSHIFT_EXPR\n+\t\t\t ? G_(\"left shift count >= width of type\")\n+\t\t\t : G_(\"right shift count >= width of type\")));\n \t}\n       if ((code == TRUNC_DIV_EXPR\n \t   || code == CEIL_DIV_EXPR"}, {"sha": "936a164a3a26892e5ba930436c8cb95117e42e29", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4853031ec832b9fd29e0894016038cc9f83e31cc/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4853031ec832b9fd29e0894016038cc9f83e31cc/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=4853031ec832b9fd29e0894016038cc9f83e31cc", "patch": "@@ -1,3 +1,8 @@\n+2015-04-24  Marek Polacek  <polacek@redhat.com>\n+\n+\tPR c/65830\n+\t* c-c++-common/pr65830.c: New test.\n+\n 2015-04-24  Marek Polacek  <polacek@redhat.com>\n \n \tPR c/61534"}, {"sha": "e115f181275bcfdc6a53df7b127f4ffb4137f759", "filename": "gcc/testsuite/c-c++-common/pr65830.c", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4853031ec832b9fd29e0894016038cc9f83e31cc/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fpr65830.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4853031ec832b9fd29e0894016038cc9f83e31cc/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fpr65830.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fpr65830.c?ref=4853031ec832b9fd29e0894016038cc9f83e31cc", "patch": "@@ -0,0 +1,16 @@\n+/* PR c/65830 */\n+/* { dg-do compile } */\n+/* { dg-options \"-O -Wno-shift-count-negative -Wno-shift-count-overflow\" } */\n+\n+int\n+foo (int x)\n+{\n+  const int a = sizeof (int) * __CHAR_BIT__;\n+  const int b = -7;\n+  int c = 0;\n+  c += x << a;\t/* { dg-bogus \"left shift count >= width of type\" } */\n+  c += x << b;\t/* { dg-bogus \"left shift count is negative\" } */\n+  c += x >> a;\t/* { dg-bogus \"right shift count >= width of type\" } */\n+  c += x >> b;  /* { dg-bogus \"right shift count is negative\" } */\n+  return c;\n+}"}]}