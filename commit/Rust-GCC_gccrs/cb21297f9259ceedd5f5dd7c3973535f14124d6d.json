{"sha": "cb21297f9259ceedd5f5dd7c3973535f14124d6d", "node_id": "C_kwDOANBUbNoAKGNiMjEyOTdmOTI1OWNlZWRkNWY1ZGQ3YzM5NzM1MzVmMTQxMjRkNmQ", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2022-10-25T10:20:33Z"}, "committer": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2022-10-25T10:23:55Z"}, "message": "Relax assertion in profiler\n\nThis assertion in branch_prob:\n\n  if (bb == ENTRY_BLOCK_PTR_FOR_FN (cfun)->next_bb)\n    {\n      location_t loc = DECL_SOURCE_LOCATION (current_function_decl);\n      gcc_checking_assert (!RESERVED_LOCATION_P (loc));\n\nhad been correct until the fix for PR debug/101598 was installed.\n\ngcc/\n\t* profile.cc (branch_prob): Be prepared for ignored functions with\n\tDECL_SOURCE_LOCATION set to UNKNOWN_LOCATION.\n\ngcc/testsuite:\n\t* gnat.dg/specs/coverage1.ads: New test.\n\t* gnat.dg/specs/variant_part.ads: Minor tweak.\n\t* gnat.dg/specs/weak1.ads: Add dg directive.", "tree": {"sha": "51a2754875a1ca865c07f5a162bded1a09d24965", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/51a2754875a1ca865c07f5a162bded1a09d24965"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/cb21297f9259ceedd5f5dd7c3973535f14124d6d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cb21297f9259ceedd5f5dd7c3973535f14124d6d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cb21297f9259ceedd5f5dd7c3973535f14124d6d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cb21297f9259ceedd5f5dd7c3973535f14124d6d/comments", "author": null, "committer": null, "parents": [{"sha": "3ee675724cb27eb2e8cfd82f6e234edc4a63f6be", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3ee675724cb27eb2e8cfd82f6e234edc4a63f6be", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3ee675724cb27eb2e8cfd82f6e234edc4a63f6be"}], "stats": {"total": 25, "additions": 20, "deletions": 5}, "files": [{"sha": "1527a04124fee4d555e2d4d93939a9170b49fa2f", "filename": "gcc/profile.cc", "status": "modified", "additions": 7, "deletions": 5, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cb21297f9259ceedd5f5dd7c3973535f14124d6d/gcc%2Fprofile.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cb21297f9259ceedd5f5dd7c3973535f14124d6d/gcc%2Fprofile.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fprofile.cc?ref=cb21297f9259ceedd5f5dd7c3973535f14124d6d", "patch": "@@ -1457,11 +1457,13 @@ branch_prob (bool thunk)\n \t  if (bb == ENTRY_BLOCK_PTR_FOR_FN (cfun)->next_bb)\n \t    {\n \t      location_t loc = DECL_SOURCE_LOCATION (current_function_decl);\n-\t      gcc_checking_assert (!RESERVED_LOCATION_P (loc));\n-\t      seen_locations.add (loc);\n-\t      expanded_location curr_location = expand_location (loc);\n-\t      output_location (&streamed_locations, curr_location.file,\n-\t\t\t       MAX (1, curr_location.line), &offset, bb);\n+\t      if (!RESERVED_LOCATION_P (loc))\n+\t\t{\n+\t\t  seen_locations.add (loc);\n+\t\t  expanded_location curr_location = expand_location (loc);\n+\t\t  output_location (&streamed_locations, curr_location.file,\n+\t\t\t\t   MAX (1, curr_location.line), &offset, bb);\n+\t\t}\n \t    }\n \n \t  for (gsi = gsi_start_bb (bb); !gsi_end_p (gsi); gsi_next (&gsi))"}, {"sha": "af7b61ce4e6cb5abf4fb91395d88e8ad8c83332c", "filename": "gcc/testsuite/gnat.dg/specs/coverage1.ads", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cb21297f9259ceedd5f5dd7c3973535f14124d6d/gcc%2Ftestsuite%2Fgnat.dg%2Fspecs%2Fcoverage1.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cb21297f9259ceedd5f5dd7c3973535f14124d6d/gcc%2Ftestsuite%2Fgnat.dg%2Fspecs%2Fcoverage1.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fspecs%2Fcoverage1.ads?ref=cb21297f9259ceedd5f5dd7c3973535f14124d6d", "patch": "@@ -0,0 +1,10 @@\n+-- { dg-do compile }\n+-- { dg-options \"-ftest-coverage\" }\n+\n+package Coverage1 is\n+\n+  type Rec is record\n+    I : Integer := 0;\n+  end record;\n+\n+end Coverage1;"}, {"sha": "72da4108588a5a1547d136857717a9399f8a2e2b", "filename": "gcc/testsuite/gnat.dg/specs/variant_part.ads", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cb21297f9259ceedd5f5dd7c3973535f14124d6d/gcc%2Ftestsuite%2Fgnat.dg%2Fspecs%2Fvariant_part.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cb21297f9259ceedd5f5dd7c3973535f14124d6d/gcc%2Ftestsuite%2Fgnat.dg%2Fspecs%2Fvariant_part.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fspecs%2Fvariant_part.ads?ref=cb21297f9259ceedd5f5dd7c3973535f14124d6d", "patch": "@@ -1,4 +1,5 @@\n -- { dg-do compile }\n+\n package Variant_Part is\n    type T1(b: boolean) is record\n      case (b) is    -- { dg-error \"discriminant name may not be parenthesized\" }"}, {"sha": "ece05ea68a758e3202887ecad0f470bc71c04ea3", "filename": "gcc/testsuite/gnat.dg/specs/weak1.ads", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cb21297f9259ceedd5f5dd7c3973535f14124d6d/gcc%2Ftestsuite%2Fgnat.dg%2Fspecs%2Fweak1.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cb21297f9259ceedd5f5dd7c3973535f14124d6d/gcc%2Ftestsuite%2Fgnat.dg%2Fspecs%2Fweak1.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fspecs%2Fweak1.ads?ref=cb21297f9259ceedd5f5dd7c3973535f14124d6d", "patch": "@@ -1,3 +1,5 @@\n+-- { dg-do compile }\n+\n package Weak1 is\n \n    Myconst : constant Integer := 1234;"}]}