{"sha": "29844fa7c724106adef78cb758ae1a57461758ae", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Mjk4NDRmYTdjNzI0MTA2YWRlZjc4Y2I3NThhZTFhNTc0NjE3NThhZQ==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2000-09-04T07:51:58Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2000-09-04T07:51:58Z"}, "message": "cpplex.c (ON_REST_ARG): Check VAR_ARGS flag of current context, use posn - 1 to index into tokens array.\n\n\t* cpplex.c (ON_REST_ARG): Check VAR_ARGS flag of current context,\n\tuse posn - 1 to index into tokens array.\n\t(maybe_paste_with_next): Adjust caller.\n\n\t* gcc.dg/cpp/paste8.c: New test.\n\nFrom-SVN: r36128", "tree": {"sha": "c8f56f6b0d1c0f0dd9bb8b652744f962731af294", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c8f56f6b0d1c0f0dd9bb8b652744f962731af294"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/29844fa7c724106adef78cb758ae1a57461758ae", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/29844fa7c724106adef78cb758ae1a57461758ae", "html_url": "https://github.com/Rust-GCC/gccrs/commit/29844fa7c724106adef78cb758ae1a57461758ae", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/29844fa7c724106adef78cb758ae1a57461758ae/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "e4e37381cab92b10ae601218bf461b2c904b4d6d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e4e37381cab92b10ae601218bf461b2c904b4d6d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e4e37381cab92b10ae601218bf461b2c904b4d6d"}], "stats": {"total": 31, "additions": 28, "deletions": 3}, "files": [{"sha": "2e23d6ed45b3ae3716ff3dc494accbc41801ee6b", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/29844fa7c724106adef78cb758ae1a57461758ae/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/29844fa7c724106adef78cb758ae1a57461758ae/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=29844fa7c724106adef78cb758ae1a57461758ae", "patch": "@@ -1,3 +1,9 @@\n+2000-09-04  Jakub Jelinek  <jakub@redhat.com>\n+\n+\t* cpplex.c (ON_REST_ARG): Check VAR_ARGS flag of current context,\n+\tuse posn - 1 to index into tokens array.\n+\t(maybe_paste_with_next): Adjust caller.\n+\n 2000-09-03  Geoff Keating  <geoffk@cygnus.com>\n \n \t* invoke.texi: Document the -mvxworks option for rs6000 ELF."}, {"sha": "ab5a987d9722d7fe70110850269c7dc4a52ac366", "filename": "gcc/cpplex.c", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/29844fa7c724106adef78cb758ae1a57461758ae/gcc%2Fcpplex.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/29844fa7c724106adef78cb758ae1a57461758ae/gcc%2Fcpplex.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcpplex.c?ref=29844fa7c724106adef78cb758ae1a57461758ae", "patch": "@@ -202,8 +202,8 @@ TOKEN_LEN (token)\n #define CURRENT_CONTEXT(pfile) ((pfile)->contexts + (pfile)->cur_context)\n #define ON_REST_ARG(c) \\\n  (((c)->flags & VAR_ARGS) \\\n-  && (c)->u.list->tokens[(c)->posn].val.aux \\\n-      == (unsigned int) ((c)->u.list->paramc - 1))\n+  && ((c)-1)->u.list->tokens[((c)-1)->posn - 1].val.aux \\\n+      == (unsigned int) (((c)-1)->u.list->paramc - 1))\n \n #define ASSIGN_FLAGS_AND_POS(d, s) \\\n   do {(d)->flags = (s)->flags & (PREV_WHITE | BOL | PASTE_LEFT); \\\n@@ -2773,7 +2773,7 @@ maybe_paste_with_next (pfile, token)\n \t\t     the special extended semantics (see above).  */\n \t\t  if (token->type == CPP_COMMA\n \t\t      && IS_ARG_CONTEXT (CURRENT_CONTEXT (pfile))\n-\t\t      && ON_REST_ARG (CURRENT_CONTEXT (pfile) - 1))\n+\t\t      && ON_REST_ARG (CURRENT_CONTEXT (pfile)))\n \t\t    /* no warning */;\n \t\t  else\n \t\t    cpp_warning (pfile,"}, {"sha": "202ad8f48b9c7c48c948fbc8a14347a2558fdfa8", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/29844fa7c724106adef78cb758ae1a57461758ae/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/29844fa7c724106adef78cb758ae1a57461758ae/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=29844fa7c724106adef78cb758ae1a57461758ae", "patch": "@@ -1,3 +1,7 @@\n+2000-09-04  Jakub Jelinek  <jakub@redhat.com>\n+\n+\t* gcc.dg/cpp/paste8.c: New test.\n+\n 2000-09-01  Alexandre Oliva  <aoliva@redhat.com>\n \n \t* gcc.c-torture/compile/20000827-1.c: New test."}, {"sha": "dc5fe8316a0e16859f6693c41b87cbf0a4dcb484", "filename": "gcc/testsuite/gcc.dg/cpp/paste8.c", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/29844fa7c724106adef78cb758ae1a57461758ae/gcc%2Ftestsuite%2Fgcc.dg%2Fcpp%2Fpaste8.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/29844fa7c724106adef78cb758ae1a57461758ae/gcc%2Ftestsuite%2Fgcc.dg%2Fcpp%2Fpaste8.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fcpp%2Fpaste8.c?ref=29844fa7c724106adef78cb758ae1a57461758ae", "patch": "@@ -0,0 +1,15 @@\n+/* { dg-do preprocess } */\n+/* { dg-options \"\" } */\n+\n+int foo(int, ...);\n+\n+#define a(x, y...) foo(x, ##y)\n+a(1)\n+a(1, 2, 3)\n+#define b(x, y, z...) foo(x, ##y)\n+b(1, 2, 3)\t\t\t\t/* { dg-warning \"pasting would not\" } */\n+#define c(x, y, z...) foo(x, ##z)\n+c(1, 2)\n+c(1, 2, 3)\n+#define d(x) foo(##x)\t\t\t/* { dg-warning \"nothing can be pasted\" } */\n+d(1)"}]}