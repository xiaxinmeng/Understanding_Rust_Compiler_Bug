{"sha": "a99670f923dec07fe1b2813419f33e0cd18e091e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTk5NjcwZjkyM2RlYzA3ZmUxYjI4MTM0MTlmMzNlMGNkMThlMDkxZQ==", "commit": {"author": {"name": "Jan Hubicka", "email": "hubicka@ucw.cz", "date": "2018-01-17T20:40:46Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2018-01-17T20:40:46Z"}, "message": "re PR ipa/83051 (ICE on valid code at -O3: in edge_badness, at ipa-inline.c:1024)\n\n\n\tPR ipa/83051\n\t* ipa-inline.c (flatten_function): Do not overwrite final inlining\n\tfailure.\n\t* gcc.c-torture/compile/pr83051-2.c: New testcase.\n\nFrom-SVN: r256818", "tree": {"sha": "7639a782b167f2ec0ee7b30446cf912d8a1e8821", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7639a782b167f2ec0ee7b30446cf912d8a1e8821"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a99670f923dec07fe1b2813419f33e0cd18e091e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a99670f923dec07fe1b2813419f33e0cd18e091e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a99670f923dec07fe1b2813419f33e0cd18e091e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a99670f923dec07fe1b2813419f33e0cd18e091e/comments", "author": null, "committer": null, "parents": [{"sha": "8fca809b59757519517e67a23b6df005e9e452dd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8fca809b59757519517e67a23b6df005e9e452dd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8fca809b59757519517e67a23b6df005e9e452dd"}], "stats": {"total": 26, "additions": 25, "deletions": 1}, "files": [{"sha": "6091649b65df84b8c52e770d79bfec1f448d71fb", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a99670f923dec07fe1b2813419f33e0cd18e091e/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a99670f923dec07fe1b2813419f33e0cd18e091e/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=a99670f923dec07fe1b2813419f33e0cd18e091e", "patch": "@@ -1,3 +1,9 @@\n+2018-01-17  Jan Hubicka  <hubicka@ucw.cz>\n+\n+\tPR ipa/83051\n+\t* ipa-inline.c (flatten_function): Do not overwrite final inlining\n+\tfailure.\n+\n 2018-01-17  Will Schmidt  <will_schmidt@vnet.ibm.com>\n \n \t* config/rs6000/rs6000.c (rs6000_gimple_builtin): Add gimple folding"}, {"sha": "4a7181e76a503a3d642d17a4be287136cc6e1148", "filename": "gcc/ipa-inline.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a99670f923dec07fe1b2813419f33e0cd18e091e/gcc%2Fipa-inline.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a99670f923dec07fe1b2813419f33e0cd18e091e/gcc%2Fipa-inline.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-inline.c?ref=a99670f923dec07fe1b2813419f33e0cd18e091e", "patch": "@@ -2083,7 +2083,8 @@ flatten_function (struct cgraph_node *node, bool early)\n \t\t     \"Not inlining %s into %s to avoid cycle.\\n\",\n \t\t     xstrdup_for_dump (callee->name ()),\n \t\t     xstrdup_for_dump (e->caller->name ()));\n-\t  e->inline_failed = CIF_RECURSIVE_INLINING;\n+\t  if (cgraph_inline_failed_type (e->inline_failed) != CIF_FINAL_ERROR)\n+\t    e->inline_failed = CIF_RECURSIVE_INLINING;\n \t  continue;\n \t}\n "}, {"sha": "fb0e919913f9d4ce823d57238b67a941bba21845", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a99670f923dec07fe1b2813419f33e0cd18e091e/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a99670f923dec07fe1b2813419f33e0cd18e091e/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=a99670f923dec07fe1b2813419f33e0cd18e091e", "patch": "@@ -1,3 +1,8 @@\n+2018-01-17  Jan Hubicka  <hubicka@ucw.cz>\n+\n+\tPR ipa/83051\n+\t* gcc.c-torture/compile/pr83051-2.c: New testcase.\n+\n 2018-01-17  Paolo Carlini  <paolo.carlini@oracle.com>\n \n \tPR c++/81054"}, {"sha": "2bb2eaff54f895b819f7c233bbff2a8eb1a1d5f9", "filename": "gcc/testsuite/gcc.c-torture/compile/pr83051-2.c", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a99670f923dec07fe1b2813419f33e0cd18e091e/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fpr83051-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a99670f923dec07fe1b2813419f33e0cd18e091e/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fpr83051-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fpr83051-2.c?ref=a99670f923dec07fe1b2813419f33e0cd18e091e", "patch": "@@ -0,0 +1,12 @@\n+/* { dg-options \"-fno-early-inlining\" } */\n+void\n+bar ()\n+{\n+  bar (0);\n+}\n+\n+__attribute__ ((flatten))\n+void foo ()\n+{\n+  bar ();\n+}"}]}