{"sha": "331170392082ccfb782a6edb263fc2a32d058c70", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzMxMTcwMzkyMDgyY2NmYjc4MmE2ZWRiMjYzZmMyYTMyZDA1OGM3MA==", "commit": {"author": {"name": "Arnaud Charlet", "email": "charlet@adacore.com", "date": "2021-02-17T11:29:03Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "derodat@adacore.com", "date": "2021-06-16T08:42:57Z"}, "message": "[Ada] Raise expressions and unconstrained components\n\ngcc/ada/\n\n\t* sem_ch3.adb (Analyze_Component_Declaration): Do not special\n\tcase raise expressions.\n\ngcc/testsuite/\n\n\t* gnat.dg/limited4.adb: Disable illegal code.", "tree": {"sha": "9b4bcbd115c878471264245679c5c37aa39158ab", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9b4bcbd115c878471264245679c5c37aa39158ab"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/331170392082ccfb782a6edb263fc2a32d058c70", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/331170392082ccfb782a6edb263fc2a32d058c70", "html_url": "https://github.com/Rust-GCC/gccrs/commit/331170392082ccfb782a6edb263fc2a32d058c70", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/331170392082ccfb782a6edb263fc2a32d058c70/comments", "author": {"login": "ArnaudCharlet", "id": 30291825, "node_id": "MDQ6VXNlcjMwMjkxODI1", "avatar_url": "https://avatars.githubusercontent.com/u/30291825?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ArnaudCharlet", "html_url": "https://github.com/ArnaudCharlet", "followers_url": "https://api.github.com/users/ArnaudCharlet/followers", "following_url": "https://api.github.com/users/ArnaudCharlet/following{/other_user}", "gists_url": "https://api.github.com/users/ArnaudCharlet/gists{/gist_id}", "starred_url": "https://api.github.com/users/ArnaudCharlet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ArnaudCharlet/subscriptions", "organizations_url": "https://api.github.com/users/ArnaudCharlet/orgs", "repos_url": "https://api.github.com/users/ArnaudCharlet/repos", "events_url": "https://api.github.com/users/ArnaudCharlet/events{/privacy}", "received_events_url": "https://api.github.com/users/ArnaudCharlet/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pmderodat", "id": 758452, "node_id": "MDQ6VXNlcjc1ODQ1Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/758452?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pmderodat", "html_url": "https://github.com/pmderodat", "followers_url": "https://api.github.com/users/pmderodat/followers", "following_url": "https://api.github.com/users/pmderodat/following{/other_user}", "gists_url": "https://api.github.com/users/pmderodat/gists{/gist_id}", "starred_url": "https://api.github.com/users/pmderodat/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pmderodat/subscriptions", "organizations_url": "https://api.github.com/users/pmderodat/orgs", "repos_url": "https://api.github.com/users/pmderodat/repos", "events_url": "https://api.github.com/users/pmderodat/events{/privacy}", "received_events_url": "https://api.github.com/users/pmderodat/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a85d1c14073af24e79f19abf50271e219511054d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a85d1c14073af24e79f19abf50271e219511054d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a85d1c14073af24e79f19abf50271e219511054d"}], "stats": {"total": 26, "additions": 8, "deletions": 18}, "files": [{"sha": "c6687b51c3bb2f716c88520c0db04a9fb54fd1f9", "filename": "gcc/ada/sem_ch3.adb", "status": "modified", "additions": 1, "deletions": 12, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/331170392082ccfb782a6edb263fc2a32d058c70/gcc%2Fada%2Fsem_ch3.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/331170392082ccfb782a6edb263fc2a32d058c70/gcc%2Fada%2Fsem_ch3.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch3.adb?ref=331170392082ccfb782a6edb263fc2a32d058c70", "patch": "@@ -2083,21 +2083,10 @@ package body Sem_Ch3 is\n          end if;\n       end if;\n \n-      --  Avoid reporting spurious errors if the component is initialized with\n-      --  a raise expression (which is legal in any expression context)\n-\n-      if Present (E)\n-        and then\n-          (Nkind (E) = N_Raise_Expression\n-             or else (Nkind (E) = N_Qualified_Expression\n-                        and then Nkind (Expression (E)) = N_Raise_Expression))\n-      then\n-         null;\n-\n       --  The parent type may be a private view with unknown discriminants,\n       --  and thus unconstrained. Regular components must be constrained.\n \n-      elsif not Is_Definite_Subtype (T)\n+      if not Is_Definite_Subtype (T)\n         and then Chars (Id) /= Name_uParent\n       then\n          if Is_Class_Wide_Type (T) then"}, {"sha": "2a22a2c1b3fe6bef002882ac610c2adc287860ca", "filename": "gcc/testsuite/gnat.dg/limited4.adb", "status": "modified", "additions": 7, "deletions": 6, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/331170392082ccfb782a6edb263fc2a32d058c70/gcc%2Ftestsuite%2Fgnat.dg%2Flimited4.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/331170392082ccfb782a6edb263fc2a32d058c70/gcc%2Ftestsuite%2Fgnat.dg%2Flimited4.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Flimited4.adb?ref=331170392082ccfb782a6edb263fc2a32d058c70", "patch": "@@ -22,11 +22,12 @@ procedure Limited4 is\n     Obj2 : Lim_Tagged'Class := Lim_Tagged'Class'(raise TBD_Error);\n \n     --  b) initialization expression of a CW component_declaration\n-\n-    type Rec is record\n-       Comp01 : Lim_Tagged'Class := (raise TBD_Error);\n-       Comp02 : Lim_Tagged'Class := Lim_Tagged'Class'((raise TBD_Error));\n-    end record;\n+    --  ... is illegal: cannot have unconstrained components.\n+    --\n+    --  type Rec is record\n+    --     Comp01 : Lim_Tagged'Class := (raise TBD_Error);\n+    --     Comp02 : Lim_Tagged'Class := Lim_Tagged'Class'((raise TBD_Error));\n+    --  end record;\n \n     --  c) the expression of a record_component_association\n \n@@ -55,4 +56,4 @@ procedure Limited4 is\n begin\n     Check := Do_Test1 (raise TBD_Error);\n     Check := Do_Test2;\n-end;\n\\ No newline at end of file\n+end;"}]}