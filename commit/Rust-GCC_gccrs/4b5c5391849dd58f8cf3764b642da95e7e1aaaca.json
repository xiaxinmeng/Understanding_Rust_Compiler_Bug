{"sha": "4b5c5391849dd58f8cf3764b642da95e7e1aaaca", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NGI1YzUzOTE4NDlkZDU4ZjhjZjM3NjRiNjQyZGE5NWU3ZTFhYWFjYQ==", "commit": {"author": {"name": "Iain Sandoe", "email": "iain@sandoe.co.uk", "date": "2019-07-10T19:29:56Z"}, "committer": {"name": "Iain Sandoe", "email": "iains@gcc.gnu.org", "date": "2019-07-10T19:29:56Z"}, "message": "[Darwin, PPC] Collate the system library spec into one expression.\n\nThere's no need to redefine this dependent on the target header (that only\nworks in the case that we have self-hosting which is less and less likely\nfor the older system versions).\n\nActually, what we need is for the correct library set to be used based\non the SDK(s) that can target the chosen system.\n\ngcc/ChangeLog:\n\n2019-07-10  Iain Sandoe  <iain@sandoe.co.uk>\n\n\t* config/rs6000/darwin.h (LIB_SPEC): Collate this spec here.\n\t* config/rs6000/darwin7.h (LIB_SPEC): Remove.\n\t* config/rs6000/darwin8.h (LIB_SPEC): Remove.\n\t(DEF_MIN_OSX_VERSION): New.\n\nFrom-SVN: r273369", "tree": {"sha": "8919b8f05402367612f01a588bf0428c8214aa65", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8919b8f05402367612f01a588bf0428c8214aa65"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4b5c5391849dd58f8cf3764b642da95e7e1aaaca", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4b5c5391849dd58f8cf3764b642da95e7e1aaaca", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4b5c5391849dd58f8cf3764b642da95e7e1aaaca", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4b5c5391849dd58f8cf3764b642da95e7e1aaaca/comments", "author": {"login": "iains", "id": 4039407, "node_id": "MDQ6VXNlcjQwMzk0MDc=", "avatar_url": "https://avatars.githubusercontent.com/u/4039407?v=4", "gravatar_id": "", "url": "https://api.github.com/users/iains", "html_url": "https://github.com/iains", "followers_url": "https://api.github.com/users/iains/followers", "following_url": "https://api.github.com/users/iains/following{/other_user}", "gists_url": "https://api.github.com/users/iains/gists{/gist_id}", "starred_url": "https://api.github.com/users/iains/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/iains/subscriptions", "organizations_url": "https://api.github.com/users/iains/orgs", "repos_url": "https://api.github.com/users/iains/repos", "events_url": "https://api.github.com/users/iains/events{/privacy}", "received_events_url": "https://api.github.com/users/iains/received_events", "type": "User", "site_admin": false}, "committer": {"login": "iains", "id": 4039407, "node_id": "MDQ6VXNlcjQwMzk0MDc=", "avatar_url": "https://avatars.githubusercontent.com/u/4039407?v=4", "gravatar_id": "", "url": "https://api.github.com/users/iains", "html_url": "https://github.com/iains", "followers_url": "https://api.github.com/users/iains/followers", "following_url": "https://api.github.com/users/iains/following{/other_user}", "gists_url": "https://api.github.com/users/iains/gists{/gist_id}", "starred_url": "https://api.github.com/users/iains/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/iains/subscriptions", "organizations_url": "https://api.github.com/users/iains/orgs", "repos_url": "https://api.github.com/users/iains/repos", "events_url": "https://api.github.com/users/iains/events{/privacy}", "received_events_url": "https://api.github.com/users/iains/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2cb7362310288cce61244e39f90fccd75b1c28e1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2cb7362310288cce61244e39f90fccd75b1c28e1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2cb7362310288cce61244e39f90fccd75b1c28e1"}], "stats": {"total": 51, "additions": 28, "deletions": 23}, "files": [{"sha": "5d3c8d42401c68f503e283bc4ab87a94486623a5", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4b5c5391849dd58f8cf3764b642da95e7e1aaaca/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4b5c5391849dd58f8cf3764b642da95e7e1aaaca/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=4b5c5391849dd58f8cf3764b642da95e7e1aaaca", "patch": "@@ -1,3 +1,10 @@\n+2019-07-10  Iain Sandoe  <iain@sandoe.co.uk>\n+\n+\t* config/rs6000/darwin.h (LIB_SPEC): Collate this spec here.\n+\t* config/rs6000/darwin7.h (LIB_SPEC): Remove.\n+\t* config/rs6000/darwin8.h (LIB_SPEC): Remove.\n+\t(DEF_MIN_OSX_VERSION): New.\n+\n 2019-07-10  Richard Sandiford  <richard.sandiford@arm.com>\n \n \t* fold-const.c (fold_relational_const): Fix folding of"}, {"sha": "272cd4541897420b962563c93aeb2de539c3b8ab", "filename": "gcc/config/rs6000/darwin.h", "status": "modified", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4b5c5391849dd58f8cf3764b642da95e7e1aaaca/gcc%2Fconfig%2Frs6000%2Fdarwin.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4b5c5391849dd58f8cf3764b642da95e7e1aaaca/gcc%2Fconfig%2Frs6000%2Fdarwin.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Fdarwin.h?ref=4b5c5391849dd58f8cf3764b642da95e7e1aaaca", "patch": "@@ -86,6 +86,24 @@ extern int darwin_emit_picsym_stub;\n \n #define RS6000_DEFAULT_LONG_DOUBLE_SIZE 128\n \n+/* Machine dependent libraries.\n+   Include libmx when targeting Darwin 7.0 and above, but before libSystem,\n+   since the functions are actually in libSystem but for 7.x compatibility\n+   we want them to be looked for in libmx first.\n+   Include libSystemStubs when compiling against 10.3 - 10.5 SDKs (we assume\n+   this is the case when targetting these) - but not for 64-bit long double.\n+   Don't do either for m64, the library is either a dummy or non-existent.\n+*/\n+\n+#undef LIB_SPEC\n+#define LIB_SPEC \\\n+\"%{!static:\t\t\t\t\t\t\t\t\\\n+  %{!m64:%{!mlong-double-64:\t\t\t\t\t\t\\\n+    %{pg:%:version-compare(>< 10.3 10.5 mmacosx-version-min= -lSystemStubs_profile)} \\\n+    %{!pg:%:version-compare(>< 10.3 10.5 mmacosx-version-min= -lSystemStubs)} \\\n+     %:version-compare(>< 10.3 10.4 mmacosx-version-min= -lmx)}}\t\\\n+  -lSystem\t\t\t\t\t\t\t\t\\\n+}\"\n \n /* We want -fPIC by default, unless we're using -static to compile for\n    the kernel or some such.  The \"-faltivec\" option should have been"}, {"sha": "6a3adc0297c7dcfd15c89d5e0552cf318e547e83", "filename": "gcc/config/rs6000/darwin7.h", "status": "modified", "additions": 1, "deletions": 11, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4b5c5391849dd58f8cf3764b642da95e7e1aaaca/gcc%2Fconfig%2Frs6000%2Fdarwin7.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4b5c5391849dd58f8cf3764b642da95e7e1aaaca/gcc%2Fconfig%2Frs6000%2Fdarwin7.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Fdarwin7.h?ref=4b5c5391849dd58f8cf3764b642da95e7e1aaaca", "patch": "@@ -17,21 +17,11 @@ You should have received a copy of the GNU General Public License\n along with GCC; see the file COPYING3.  If not see\n <http://www.gnu.org/licenses/>.  */\n \n-/* Machine dependent libraries.  Include libmx when compiling for\n-   Darwin 7.0 and above, but before libSystem, since the functions are\n-   actually in libSystem but for 7.x compatibility we want them to be\n-   looked for in libmx first.  Include libmx by default because otherwise\n-   libstdc++ isn't usable.  */\n-\n-#undef\tLIB_SPEC\n-#define LIB_SPEC \"%{!static:\\\n-  %:version-compare(!< 10.3 mmacosx-version-min= -lmx)\\\n-  -lSystem}\"\n-\n /* This generation of tools (specifically the archive tool) did not\n    export weak symbols from the TOC. */\n #undef TARGET_WEAK_NOT_IN_ARCHIVE_TOC\n #define TARGET_WEAK_NOT_IN_ARCHIVE_TOC 1\n \n+/* Default to the last version, with most support for C++.  */\n #undef DEF_MIN_OSX_VERSION\n #define DEF_MIN_OSX_VERSION \"10.3.9\""}, {"sha": "ec5a8af37cdec638ebecb7d6b9a56c8091f1f20f", "filename": "gcc/config/rs6000/darwin8.h", "status": "modified", "additions": 2, "deletions": 12, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4b5c5391849dd58f8cf3764b642da95e7e1aaaca/gcc%2Fconfig%2Frs6000%2Fdarwin8.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4b5c5391849dd58f8cf3764b642da95e7e1aaaca/gcc%2Fconfig%2Frs6000%2Fdarwin8.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Fdarwin8.h?ref=4b5c5391849dd58f8cf3764b642da95e7e1aaaca", "patch": "@@ -17,15 +17,5 @@ You should have received a copy of the GNU General Public License\n along with GCC; see the file COPYING3.  If not see\n <http://www.gnu.org/licenses/>.  */\n \n-/* Machine dependent libraries.  Include libmx when compiling on\n-   Darwin 7.0 and above, but before libSystem, since the functions are\n-   actually in libSystem but for 7.x compatibility we want them to be\n-   looked for in libmx first---but only do this if 7.x compatibility\n-   is a concern, which it's not in 64-bit mode.  Include\n-   libSystemStubs when compiling on (not necessarily for) 8.0 and\n-   above and not 64-bit long double.  */\n-\n-#undef\tLIB_SPEC\n-#define LIB_SPEC \"%{!static:\\\n-  %{!mlong-double-64:%{pg:-lSystemStubs_profile;:-lSystemStubs}} \\\n-  %{!m64:%:version-compare(>< 10.3 10.4 mmacosx-version-min= -lmx)} -lSystem}\"\n+#undef DEF_MIN_OSX_VERSION\n+#define DEF_MIN_OSX_VERSION \"10.4\""}]}