{"sha": "fefedb945e5cbea263e7dc0a9a698037d619a969", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZmVmZWRiOTQ1ZTVjYmVhMjYzZTdkYzBhOWE2OTgwMzdkNjE5YTk2OQ==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2018-05-01T17:04:52Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2018-05-01T17:04:52Z"}, "message": "configure.ac (LD_AS_NEEDED_OPTION, [...]): Use --push-state --as-needed and --pop-state instead of --as-needed and...\n\n\t* configure.ac (LD_AS_NEEDED_OPTION, LD_NO_AS_NEEDED_OPTION): Use\n\t--push-state --as-needed and --pop-state instead of --as-needed and\n\t--no-as-needed if ld supports it.\n\t* configure: Regenerated.\n\nFrom-SVN: r259803", "tree": {"sha": "b838c852001d3c6114890f1ff77ba4e317beba16", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b838c852001d3c6114890f1ff77ba4e317beba16"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/fefedb945e5cbea263e7dc0a9a698037d619a969", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fefedb945e5cbea263e7dc0a9a698037d619a969", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fefedb945e5cbea263e7dc0a9a698037d619a969", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fefedb945e5cbea263e7dc0a9a698037d619a969/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "58b40a6702c7a7e9203aacce83273698b8f3e535", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/58b40a6702c7a7e9203aacce83273698b8f3e535", "html_url": "https://github.com/Rust-GCC/gccrs/commit/58b40a6702c7a7e9203aacce83273698b8f3e535"}], "stats": {"total": 33, "additions": 33, "deletions": 0}, "files": [{"sha": "b1a5488bd5834eb9cecf60c1d67a4a49a5c42da4", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fefedb945e5cbea263e7dc0a9a698037d619a969/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fefedb945e5cbea263e7dc0a9a698037d619a969/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=fefedb945e5cbea263e7dc0a9a698037d619a969", "patch": "@@ -1,5 +1,10 @@\n 2018-05-01  Jakub Jelinek  <jakub@redhat.com>\n \n+\t* configure.ac (LD_AS_NEEDED_OPTION, LD_NO_AS_NEEDED_OPTION): Use\n+\t--push-state --as-needed and --pop-state instead of --as-needed and\n+\t--no-as-needed if ld supports it.\n+\t* configure: Regenerated.\n+\n \tPR web/85578\n \t* doc/install.texi2html: Replace _002d with - and _002a with * in\n \tgenerated html files using sed."}, {"sha": "5c345ce0fd7c99e34f78191ae8793674a30e67d4", "filename": "gcc/configure", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fefedb945e5cbea263e7dc0a9a698037d619a969/gcc%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fefedb945e5cbea263e7dc0a9a698037d619a969/gcc%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfigure?ref=fefedb945e5cbea263e7dc0a9a698037d619a969", "patch": "@@ -28733,11 +28733,25 @@ if test $in_tree_ld = yes ; then\n   if test \"$gcc_cv_gld_major_version\" -eq 2 -a \"$gcc_cv_gld_minor_version\" -ge 16 -o \"$gcc_cv_gld_major_version\" -gt 2 \\\n      && test $in_tree_ld_is_elf = yes; then\n     gcc_cv_ld_as_needed=yes\n+    if test \"$gcc_cv_gld_major_version\" -eq 2 -a \"$gcc_cv_gld_minor_version\" -ge 28; then\n+      gcc_cv_ld_as_needed_option='--push-state --as-needed'\n+      gcc_cv_ld_no_as_needed_option='--pop-state'\n+    fi\n   fi\n elif test x$gcc_cv_ld != x; then\n   # Check if linker supports --as-needed and --no-as-needed options\n   if $gcc_cv_ld --help 2>&1 | grep as-needed > /dev/null; then\n     gcc_cv_ld_as_needed=yes\n+    if $gcc_cv_ld --help 2>&1 | grep push-state > /dev/null \\\n+       && $gcc_cv_ld --help 2>&1 | grep pop-state > /dev/null \\\n+       && echo \"$ld_ver\" | grep GNU > /dev/null \\\n+       && test \"$ld_vers_major\" -eq 2 -a \"$ld_vers_minor\" -ge 28; then\n+      # Use these options only when both ld.bfd and ld.gold support\n+      # --push-state/--pop-state, which unfortunately wasn't added\n+      # at the same time.\n+      gcc_cv_ld_as_needed_option='--push-state --as-needed'\n+      gcc_cv_ld_no_as_needed_option='--pop-state'\n+    fi\n   fi\n   case \"$target:$gnu_ld\" in\n     *-*-solaris2*:no)"}, {"sha": "65dbf1f2f80cd135d9f1badd88c8dfbbcea73323", "filename": "gcc/configure.ac", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fefedb945e5cbea263e7dc0a9a698037d619a969/gcc%2Fconfigure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fefedb945e5cbea263e7dc0a9a698037d619a969/gcc%2Fconfigure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfigure.ac?ref=fefedb945e5cbea263e7dc0a9a698037d619a969", "patch": "@@ -5517,11 +5517,25 @@ if test $in_tree_ld = yes ; then\n   if test \"$gcc_cv_gld_major_version\" -eq 2 -a \"$gcc_cv_gld_minor_version\" -ge 16 -o \"$gcc_cv_gld_major_version\" -gt 2 \\\n      && test $in_tree_ld_is_elf = yes; then\n     gcc_cv_ld_as_needed=yes\n+    if test \"$gcc_cv_gld_major_version\" -eq 2 -a \"$gcc_cv_gld_minor_version\" -ge 28; then\n+      gcc_cv_ld_as_needed_option='--push-state --as-needed'\n+      gcc_cv_ld_no_as_needed_option='--pop-state'\n+    fi\n   fi\n elif test x$gcc_cv_ld != x; then\n   # Check if linker supports --as-needed and --no-as-needed options\n   if $gcc_cv_ld --help 2>&1 | grep as-needed > /dev/null; then\n     gcc_cv_ld_as_needed=yes\n+    if $gcc_cv_ld --help 2>&1 | grep push-state > /dev/null \\\n+       && $gcc_cv_ld --help 2>&1 | grep pop-state > /dev/null \\\n+       && echo \"$ld_ver\" | grep GNU > /dev/null \\\n+       && test \"$ld_vers_major\" -eq 2 -a \"$ld_vers_minor\" -ge 28; then\n+      # Use these options only when both ld.bfd and ld.gold support\n+      # --push-state/--pop-state, which unfortunately wasn't added\n+      # at the same time.\n+      gcc_cv_ld_as_needed_option='--push-state --as-needed'\n+      gcc_cv_ld_no_as_needed_option='--pop-state'\n+    fi\n   fi\n   case \"$target:$gnu_ld\" in\n     *-*-solaris2*:no)"}]}