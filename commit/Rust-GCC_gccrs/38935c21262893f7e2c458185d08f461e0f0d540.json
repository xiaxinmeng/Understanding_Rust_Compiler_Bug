{"sha": "38935c21262893f7e2c458185d08f461e0f0d540", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Mzg5MzVjMjEyNjI4OTNmN2UyYzQ1ODE4NWQwOGY0NjFlMGYwZDU0MA==", "commit": {"author": {"name": "Franz Sirl", "email": "Franz.Sirl-kernel@lauterbach.com", "date": "2001-06-16T16:33:28Z"}, "committer": {"name": "Franz Sirl", "email": "sirl@gcc.gnu.org", "date": "2001-06-16T16:33:28Z"}, "message": "gccspec.c (lang_specific_driver): If compiling ObjC, add -shared-libgcc when necessary.\n\n        2001-06-16  Franz Sirl  <Franz.Sirl-kernel@lauterbach.com>\n\n        * gccspec.c (lang_specific_driver): If compiling ObjC, add\n        -shared-libgcc when necessary.\n        * Makefile.in (gccspec.o): Compile with DRIVER_DEFINES.\n\nFrom-SVN: r43421", "tree": {"sha": "a3d617b311fa2f0caf518b08cb496338fcec6ba4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a3d617b311fa2f0caf518b08cb496338fcec6ba4"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/38935c21262893f7e2c458185d08f461e0f0d540", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/38935c21262893f7e2c458185d08f461e0f0d540", "html_url": "https://github.com/Rust-GCC/gccrs/commit/38935c21262893f7e2c458185d08f461e0f0d540", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/38935c21262893f7e2c458185d08f461e0f0d540/comments", "author": {"login": "jinkama-san", "id": 1462162, "node_id": "MDQ6VXNlcjE0NjIxNjI=", "avatar_url": "https://avatars.githubusercontent.com/u/1462162?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jinkama-san", "html_url": "https://github.com/jinkama-san", "followers_url": "https://api.github.com/users/jinkama-san/followers", "following_url": "https://api.github.com/users/jinkama-san/following{/other_user}", "gists_url": "https://api.github.com/users/jinkama-san/gists{/gist_id}", "starred_url": "https://api.github.com/users/jinkama-san/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jinkama-san/subscriptions", "organizations_url": "https://api.github.com/users/jinkama-san/orgs", "repos_url": "https://api.github.com/users/jinkama-san/repos", "events_url": "https://api.github.com/users/jinkama-san/events{/privacy}", "received_events_url": "https://api.github.com/users/jinkama-san/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "ea1939969e757b057b82adc1a51ee50330b5228f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ea1939969e757b057b82adc1a51ee50330b5228f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ea1939969e757b057b82adc1a51ee50330b5228f"}], "stats": {"total": 76, "additions": 74, "deletions": 2}, "files": [{"sha": "65f241aac1aabcb7c69d8aa8414d4f7bda731225", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/38935c21262893f7e2c458185d08f461e0f0d540/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/38935c21262893f7e2c458185d08f461e0f0d540/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=38935c21262893f7e2c458185d08f461e0f0d540", "patch": "@@ -1,3 +1,9 @@\n+2001-06-16  Franz Sirl  <Franz.Sirl-kernel@lauterbach.com>\n+\n+\t* gccspec.c (lang_specific_driver): If compiling ObjC, add\n+\t-shared-libgcc when necessary.\n+\t* Makefile.in (gccspec.o): Compile with DRIVER_DEFINES.\n+\n 2001-06-16  Daniel Berlin  <dan@cgsoftware.com>\n \n \t* bitmap.h: Add dump_bitmap, bitmap_zero, bitmap_union_of_diffs,"}, {"sha": "6606cabfa758b505cbc849182e770c5cbdf5aefe", "filename": "gcc/Makefile.in", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/38935c21262893f7e2c458185d08f461e0f0d540/gcc%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/38935c21262893f7e2c458185d08f461e0f0d540/gcc%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FMakefile.in?ref=38935c21262893f7e2c458185d08f461e0f0d540", "patch": "@@ -1263,6 +1263,12 @@ gcc.o: gcc.c $(CONFIG_H) $(SYSTEM_H) intl.h multilib.h \\\n   -c $(srcdir)/gcc.c)\n \n gccspec.o: gccspec.c $(CONFIG_H) $(SYSTEM_H) $(GCC_H)\n+\t(SHLIB_LINK='$(SHLIB_LINK)' \\\n+\tSHLIB_MULTILIB='$(SHLIB_MULTILIB)'; \\\n+\t$(CC) $(ALL_CFLAGS) $(ALL_CPPFLAGS) $(INCLUDES) \\\n+  $(DRIVER_DEFINES) \\\n+  -c $(srcdir)/gccspec.c)\n+\n cppspec.o: cppspec.c $(CONFIG_H) $(SYSTEM_H) $(GCC_H)\n \n tree-check.h: s-check ; @true"}, {"sha": "8576ee0d603de55780d7c56d71d89781a55b20b1", "filename": "gcc/gccspec.c", "status": "modified", "additions": 62, "deletions": 2, "changes": 64, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/38935c21262893f7e2c458185d08f461e0f0d540/gcc%2Fgccspec.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/38935c21262893f7e2c458185d08f461e0f0d540/gcc%2Fgccspec.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgccspec.c?ref=38935c21262893f7e2c458185d08f461e0f0d540", "patch": "@@ -1,5 +1,5 @@\n /* Specific flags and argument handling of the C front-end.\n-   Copyright (C) 1999 Free Software Foundation, Inc.\n+   Copyright (C) 1999, 2001 Free Software Foundation, Inc.\n \n This file is part of GNU CC.\n \n@@ -29,7 +29,67 @@ lang_specific_driver (in_argc, in_argv, in_added_libraries)\n      const char *const **in_argv ATTRIBUTE_UNUSED;\n      int *in_added_libraries ATTRIBUTE_UNUSED;\n {\n-  return;  /* Not used for C. */\n+#ifdef ENABLE_SHARED_LIBGCC\n+  int i;\n+\n+  /* The new argument list will be contained in this.  */\n+  const char **arglist;\n+\n+  /* True if we should add -shared-libgcc to the command-line.  */\n+  int shared_libgcc = 0;\n+\n+  /* The total number of arguments with the new stuff.  */\n+  int argc;\n+\n+  /* The argument list.  */\n+  const char *const *argv;\n+\n+  argc = *in_argc;\n+  argv = *in_argv;\n+\n+  for (i = 1; i < argc; i++)\n+    {\n+      if (argv[i][0] == '-')\n+\t{\n+\t  if (strcmp (argv[i], \"-static-libgcc\") == 0\n+\t      || strcmp (argv[i], \"-static\") == 0)\n+\t    return;\n+\t}\n+      else\n+\t{\n+\t  int len; \n+\n+\t  /* If the filename ends in .m or .mi, we are compiling ObjC\n+\t     and want to pass -shared-libgcc.  */\n+\t  len = strlen (argv[i]);\n+\t  if ((len > 2 && argv[i][len - 2] == '.' && argv[i][len - 1] == 'm')\n+\t      ||  (len > 3 && argv[i][len - 3] == '.' && argv[i][len - 2] == 'm'\n+\t\t   && argv[i][len - 1] == 'i'))\n+\t    shared_libgcc = 1;\n+\t}\n+    }\n+\n+  if  (shared_libgcc)\n+    {\n+      /* Make sure to have room for the trailing NULL argument.  */\n+      arglist = (const char **) xmalloc ((argc+2) * sizeof (char *));\n+\n+      i = 0;\n+      do\n+\t{\n+\t  arglist[i] = argv[i];\n+\t  i++;\n+\t}\n+      while (i < argc);\n+\n+      arglist[i++] = \"-shared-libgcc\";\n+\n+      arglist[i] = NULL;\n+\n+      *in_argc = i;\n+      *in_argv = arglist;\n+    }\n+#endif\n }\n \n /* Called before linking.  Returns 0 on success and -1 on failure. */"}]}