{"sha": "85d0d2683b7b00b9ec77ef4dc6a4494df6c7f555", "node_id": "C_kwDOANBUbNoAKDg1ZDBkMjY4M2I3YjAwYjllYzc3ZWY0ZGM2YTQ0OTRkZjZjN2Y1NTU", "commit": {"author": {"name": "Gaius Mulley", "email": "gaiusmod2@gmail.com", "date": "2022-12-15T14:25:05Z"}, "committer": {"name": "Gaius Mulley", "email": "gaiusmod2@gmail.com", "date": "2022-12-15T14:27:38Z"}, "message": "Subject: [committed, pushed] PR-107607 m2: Remove bdepend on realpath, cut and echo\n\nIt can be replaced by a subshell'd cd just fine.\n(cd gcc/m2; autoconf-2.69)\n\ngcc/m2/ChangeLog:\n\n\t* configure.ac: Stop probing for realpath.\n\t* tools-src/calcpath: Break dependency on realpath, cut\n\tand echo.\n\t* configure: Rebuilt.\n\nSigned-off-by: Gaius Mulley <gaiusmod2@gmail.com>", "tree": {"sha": "901d012411dfc62ea5d2b51052075511685ced4d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/901d012411dfc62ea5d2b51052075511685ced4d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/85d0d2683b7b00b9ec77ef4dc6a4494df6c7f555", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/85d0d2683b7b00b9ec77ef4dc6a4494df6c7f555", "html_url": "https://github.com/Rust-GCC/gccrs/commit/85d0d2683b7b00b9ec77ef4dc6a4494df6c7f555", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/85d0d2683b7b00b9ec77ef4dc6a4494df6c7f555/comments", "author": null, "committer": null, "parents": [{"sha": "4a1648084137f515eddd5dc087d5dfbf360a5bfa", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4a1648084137f515eddd5dc087d5dfbf360a5bfa", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4a1648084137f515eddd5dc087d5dfbf360a5bfa"}], "stats": {"total": 86, "additions": 18, "deletions": 68}, "files": [{"sha": "91768ab9c6ffd4be945f23e6c8d9cc014e2604f4", "filename": "gcc/m2/configure", "status": "modified", "additions": 0, "deletions": 47, "changes": 47, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/85d0d2683b7b00b9ec77ef4dc6a4494df6c7f555/gcc%2Fm2%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/85d0d2683b7b00b9ec77ef4dc6a4494df6c7f555/gcc%2Fm2%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fm2%2Fconfigure?ref=85d0d2683b7b00b9ec77ef4dc6a4494df6c7f555", "patch": "@@ -630,7 +630,6 @@ CPPFLAGS\n LDFLAGS\n CFLAGS\n CC\n-regex_realpath\n target_os\n target_vendor\n target_cpu\n@@ -2235,52 +2234,6 @@ test -n \"$target_alias\" &&\n     NONENONEs,x,x, &&\n   program_prefix=${target_alias}-\n \n-for ac_prog in realpath\n-do\n-  # Extract the first word of \"$ac_prog\", so it can be a program name with args.\n-set dummy $ac_prog; ac_word=$2\n-{ $as_echo \"$as_me:${as_lineno-$LINENO}: checking for $ac_word\" >&5\n-$as_echo_n \"checking for $ac_word... \" >&6; }\n-if ${ac_cv_prog_regex_realpath+:} false; then :\n-  $as_echo_n \"(cached) \" >&6\n-else\n-  if test -n \"$regex_realpath\"; then\n-  ac_cv_prog_regex_realpath=\"$regex_realpath\" # Let the user override the test.\n-else\n-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR\n-for as_dir in $PATH\n-do\n-  IFS=$as_save_IFS\n-  test -z \"$as_dir\" && as_dir=.\n-    for ac_exec_ext in '' $ac_executable_extensions; do\n-  if as_fn_executable_p \"$as_dir/$ac_word$ac_exec_ext\"; then\n-    ac_cv_prog_regex_realpath=\"$ac_prog\"\n-    $as_echo \"$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext\" >&5\n-    break 2\n-  fi\n-done\n-  done\n-IFS=$as_save_IFS\n-\n-fi\n-fi\n-regex_realpath=$ac_cv_prog_regex_realpath\n-if test -n \"$regex_realpath\"; then\n-  { $as_echo \"$as_me:${as_lineno-$LINENO}: result: $regex_realpath\" >&5\n-$as_echo \"$regex_realpath\" >&6; }\n-else\n-  { $as_echo \"$as_me:${as_lineno-$LINENO}: result: no\" >&5\n-$as_echo \"no\" >&6; }\n-fi\n-\n-\n-  test -n \"$regex_realpath\" && break\n-done\n-\n-if test x$regex_realpath = \"x\" ; then\n-    as_fn_error $? \"realpath is required to build GNU Modula-2 (hint install coreutils).\" \"$LINENO\" 5\n-fi\n-\n ac_ext=c\n ac_cpp='$CPP $CPPFLAGS'\n ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'"}, {"sha": "5583af7f64c0b3f83a412a1e28dbee70f550a80e", "filename": "gcc/m2/configure.ac", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/85d0d2683b7b00b9ec77ef4dc6a4494df6c7f555/gcc%2Fm2%2Fconfigure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/85d0d2683b7b00b9ec77ef4dc6a4494df6c7f555/gcc%2Fm2%2Fconfigure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fm2%2Fconfigure.ac?ref=85d0d2683b7b00b9ec77ef4dc6a4494df6c7f555", "patch": "@@ -24,11 +24,6 @@ AC_CANONICAL_BUILD\n AC_CANONICAL_HOST\n AC_CANONICAL_TARGET\n \n-AC_CHECK_PROGS(regex_realpath, realpath)\n-if test x$regex_realpath = \"x\" ; then\n-    AC_MSG_ERROR([realpath is required to build GNU Modula-2 (hint install coreutils).])\n-fi\n-\n AC_CHECK_FUNCS([stpcpy])\n \n AC_CHECK_HEADERS(sys/types.h)"}, {"sha": "05324513aa1ecc49f922f73e2eee7ad4edb66bcb", "filename": "gcc/m2/tools-src/calcpath", "status": "modified", "additions": 18, "deletions": 16, "changes": 34, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/85d0d2683b7b00b9ec77ef4dc6a4494df6c7f555/gcc%2Fm2%2Ftools-src%2Fcalcpath", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/85d0d2683b7b00b9ec77ef4dc6a4494df6c7f555/gcc%2Fm2%2Ftools-src%2Fcalcpath", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fm2%2Ftools-src%2Fcalcpath?ref=85d0d2683b7b00b9ec77ef4dc6a4494df6c7f555", "patch": "@@ -23,27 +23,29 @@\n \n \n Usage () {\n-   echo \"Usage: calcpath pathcomponent1 pathcomponent2 subdir\"\n-   echo -n \"  if pathcomponent1 is relative then pathcomponent1/pathcomponet2/subdir is\"\n-   echo \" returned\"\n-   echo \"  otherwise pathcomponet2/subdir is returned\"\n-   echo \"  the path is checked for legality in subdir.\"\n+   cat<<EOF\n+Usage: $0 pathcomponent1 pathcomponent2 subdir\n+  if pathcomponent2 is relative then pathcomponent1/pathcompinent2/subdir is returned\n+  otherwise pathcomponent2/subdir is returned\n+  the path is checked for legality in subdir.\n+EOF\n }\n \n+die () {\n+   printf \"calcpath: error: %s\\n\" \"$1\" >&2\n+   exit 1\n+}\n \n if [ $# -eq 3 ]; then\n-   if [ \"$(echo $2 | cut -b 1)\" = \".\" ] ; then\n-       # relative path\n-       the_path=$1/$2/$3\n-   else\n-       the_path=$2/$3\n-   fi\n-   cd $3\n-   if realpath ${the_path} > /dev/null ; then\n-       echo ${the_path}\n+   case \"$2\" in\n+      /*) the_path=\"$2/$3\" ;;\n+      *) the_path=\"$1/$2/$3\" ;;\n+   esac\n+   cd \"$3\" || die \"could not access $3\"\n+   if ( cd \"$the_path\" ); then\n+      printf '%s\\n' \"${the_path}\"\n    else\n-       echo \"calcpath: error ${the_path} is not a valid path in subdirectory $3\" 1>&2\n-       exit 1\n+      die \"${the_path} is not a valid path in subdirectory $3\"\n    fi\n else\n    Usage"}]}