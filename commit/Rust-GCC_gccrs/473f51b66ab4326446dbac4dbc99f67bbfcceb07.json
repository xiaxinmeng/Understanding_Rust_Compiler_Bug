{"sha": "473f51b66ab4326446dbac4dbc99f67bbfcceb07", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDczZjUxYjY2YWI0MzI2NDQ2ZGJhYzRkYmM5OWY2N2JiZmNjZWIwNw==", "commit": {"author": {"name": "David Edelsohn", "email": "edelsohn@gnu.org", "date": "2003-05-02T14:49:52Z"}, "committer": {"name": "David Edelsohn", "email": "dje@gcc.gnu.org", "date": "2003-05-02T14:49:52Z"}, "message": "{603.md,6xx.md,7450.md,7xx.md,rs64.md}: Decrease number of automata.\n\n        * config/rs6000/{603.md,6xx.md,7450.md,7xx.md,rs64.md}: Decrease\n        number of automata.\n\n        * config/rs6000/rs6000.c (symbol_ref_operand): Check\n        SYMBOL_REF_FUNCTION_P on AIX.\n        (current_file_function_operand): Same.\n        * config/rs6000/rs6000.md (call,call_value): Force non-function\n        symbol_ref into register on AIX.\n\nFrom-SVN: r66385", "tree": {"sha": "46b0835023d8c53bdcd5afb45e2e6d318c18d64a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/46b0835023d8c53bdcd5afb45e2e6d318c18d64a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/473f51b66ab4326446dbac4dbc99f67bbfcceb07", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/473f51b66ab4326446dbac4dbc99f67bbfcceb07", "html_url": "https://github.com/Rust-GCC/gccrs/commit/473f51b66ab4326446dbac4dbc99f67bbfcceb07", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/473f51b66ab4326446dbac4dbc99f67bbfcceb07/comments", "author": null, "committer": null, "parents": [{"sha": "13a564b36ddea6e9e45660f5e0a079e98d0a3f2f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/13a564b36ddea6e9e45660f5e0a079e98d0a3f2f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/13a564b36ddea6e9e45660f5e0a079e98d0a3f2f"}], "stats": {"total": 53, "additions": 30, "deletions": 23}, "files": [{"sha": "48475ffd82440d5392bebefc28de8e97cd6a13a9", "filename": "gcc/ChangeLog", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/473f51b66ab4326446dbac4dbc99f67bbfcceb07/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/473f51b66ab4326446dbac4dbc99f67bbfcceb07/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=473f51b66ab4326446dbac4dbc99f67bbfcceb07", "patch": "@@ -1,3 +1,14 @@\n+2003-05-02  David Edelsohn  <edelsohn@gnu.org>\n+\n+\t* config/rs6000/{603.md,6xx.md,7450.md,7xx.md,rs64.md}: Decrease\n+\tnumber of automata.\n+\n+\t* config/rs6000/rs6000.c (symbol_ref_operand): Check\n+\tSYMBOL_REF_FUNCTION_P on AIX.\n+\t(current_file_function_operand): Same.\n+\t* config/rs6000/rs6000.md (call,call_value): Force non-function\n+\tsymbol_ref into register on AIX.\n+\n 2003-05-02  Alan Modra  <amodra@bigpond.net.au>\n \n \t* calls.c (struct arg_data): Move offset, slot_offset, size and"}, {"sha": "5420cb9177405b42e870f8755bca16c9e03d1285", "filename": "gcc/config/rs6000/603.md", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/473f51b66ab4326446dbac4dbc99f67bbfcceb07/gcc%2Fconfig%2Frs6000%2F603.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/473f51b66ab4326446dbac4dbc99f67bbfcceb07/gcc%2Fconfig%2Frs6000%2F603.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2F603.md?ref=473f51b66ab4326446dbac4dbc99f67bbfcceb07", "patch": "@@ -18,10 +18,10 @@\n ;; Free Software Foundation, 59 Temple Place - Suite 330, Boston,\n ;; MA 02111-1307, USA.\n \n-(define_automaton \"ppc603,ppc603fp,ppc603other\")\n+(define_automaton \"ppc603,ppc603fp\")\n (define_cpu_unit \"iu_603\" \"ppc603\")\n (define_cpu_unit \"fpu_603\" \"ppc603fp\")\n-(define_cpu_unit \"lsu_603,bpu_603,sru_603\" \"ppc603other\")\n+(define_cpu_unit \"lsu_603,bpu_603,sru_603\" \"ppc603\")\n \n ;; PPC603/PPC603e 32-bit IU, LSU, FPU, BPU, SRU\n ;; Max issue 3 insns/clock cycle (includes 1 branch)"}, {"sha": "a4ac520e37f05abf9085e3d9f36aba547a11cd3b", "filename": "gcc/config/rs6000/6xx.md", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/473f51b66ab4326446dbac4dbc99f67bbfcceb07/gcc%2Fconfig%2Frs6000%2F6xx.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/473f51b66ab4326446dbac4dbc99f67bbfcceb07/gcc%2Fconfig%2Frs6000%2F6xx.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2F6xx.md?ref=473f51b66ab4326446dbac4dbc99f67bbfcceb07", "patch": "@@ -19,11 +19,11 @@\n ;; Free Software Foundation, 59 Temple Place - Suite 330, Boston,\n ;; MA 02111-1307, USA.\n \n-(define_automaton \"ppc6xx,ppc6xxfp,ppc6xxfp2,ppc6xxother\")\n+(define_automaton \"ppc6xx,ppc6xxfp,ppc6xxfp2\")\n (define_cpu_unit \"iu1_6xx,iu2_6xx,mciu_6xx\" \"ppc6xx\")\n (define_cpu_unit \"fpu_6xx\" \"ppc6xxfp\")\n (define_cpu_unit \"fpu1_6xx,fpu2_6xx\" \"ppc6xxfp2\")\n-(define_cpu_unit \"lsu_6xx,bpu_6xx,cru_6xx\" \"ppc6xxother\")\n+(define_cpu_unit \"lsu_6xx,bpu_6xx,cru_6xx\" \"ppc6xx\")\n \n ;; PPC604  32-bit 2xSCIU, MCIU, LSU, FPU, BPU\n ;; PPC604e  32-bit 2xSCIU, MCIU, LSU, FPU, BPU, CRU"}, {"sha": "7c136a5b8a8cc32430ff603345b58437f89ef02c", "filename": "gcc/config/rs6000/7450.md", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/473f51b66ab4326446dbac4dbc99f67bbfcceb07/gcc%2Fconfig%2Frs6000%2F7450.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/473f51b66ab4326446dbac4dbc99f67bbfcceb07/gcc%2Fconfig%2Frs6000%2F7450.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2F7450.md?ref=473f51b66ab4326446dbac4dbc99f67bbfcceb07", "patch": "@@ -18,10 +18,10 @@\n ;; Free Software Foundation, 59 Temple Place - Suite 330, Boston,\n ;; MA 02111-1307, USA.\n \n-(define_automaton \"ppc7450,ppc7450fp,ppc7450other,ppc7450vec\")\n+(define_automaton \"ppc7450,ppc7450fp,ppc7450vec\")\n (define_cpu_unit \"iu1_7450,iu2_7450,iu3_7450,mciu_7450\" \"ppc7450\")\n (define_cpu_unit \"fpu_7450\" \"ppc7450fp\")\n-(define_cpu_unit \"lsu_7450,bpu_7450\" \"ppc7450other\")\n+(define_cpu_unit \"lsu_7450,bpu_7450\" \"ppc7450\")\n (define_cpu_unit \"du1_7450,du2_7450,du3_7450\" \"ppc7450\")\n (define_cpu_unit \"vecsmpl_7450,veccmplx_7450,vecflt_7450,vecperm_7450\" \"ppc7450vec\")\n (define_cpu_unit \"vdu1_7450,vdu2_7450\" \"ppc7450vec\")"}, {"sha": "e46366929d04ec3b302e6bfd83ef1399cbf0a1fe", "filename": "gcc/config/rs6000/7xx.md", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/473f51b66ab4326446dbac4dbc99f67bbfcceb07/gcc%2Fconfig%2Frs6000%2F7xx.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/473f51b66ab4326446dbac4dbc99f67bbfcceb07/gcc%2Fconfig%2Frs6000%2F7xx.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2F7xx.md?ref=473f51b66ab4326446dbac4dbc99f67bbfcceb07", "patch": "@@ -18,12 +18,12 @@\n ;; Free Software Foundation, 59 Temple Place - Suite 330, Boston,\n ;; MA 02111-1307, USA.\n \n-(define_automaton \"ppc7xx,ppc7xxfp,ppc7xxother,ppc7xxvec\")\n+(define_automaton \"ppc7xx,ppc7xxfp\")\n (define_cpu_unit \"iu1_7xx,iu2_7xx\" \"ppc7xx\")\n (define_cpu_unit \"fpu_7xx\" \"ppc7xxfp\")\n-(define_cpu_unit \"lsu_7xx,bpu_7xx,sru_7xx\" \"ppc7xxother\")\n+(define_cpu_unit \"lsu_7xx,bpu_7xx,sru_7xx\" \"ppc7xx\")\n (define_cpu_unit \"du1_7xx,du2_7xx\" \"ppc7xx\")\n-(define_cpu_unit \"veccmplx_7xx,vecperm_7xx,vdu_7xx\" \"ppc7xxvec\")\n+(define_cpu_unit \"veccmplx_7xx,vecperm_7xx,vdu_7xx\" \"ppc7xx\")\n \n ;; PPC740/PPC750/PPC7400  32-bit 2xIU, LSU, SRU, FPU, BPU\n ;; IU1 can perform all integer operations"}, {"sha": "3ef0a6818d410492cc75d8518f69b946cf6d6075", "filename": "gcc/config/rs6000/rs6000.c", "status": "modified", "additions": 6, "deletions": 12, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/473f51b66ab4326446dbac4dbc99f67bbfcceb07/gcc%2Fconfig%2Frs6000%2Frs6000.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/473f51b66ab4326446dbac4dbc99f67bbfcceb07/gcc%2Fconfig%2Frs6000%2Frs6000.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.c?ref=473f51b66ab4326446dbac4dbc99f67bbfcceb07", "patch": "@@ -2073,7 +2073,8 @@ symbol_ref_operand (op, mode)\n   if (mode != VOIDmode && GET_MODE (op) != mode)\n     return 0;\n \n-  return (GET_CODE (op) == SYMBOL_REF);\n+  return (GET_CODE (op) == SYMBOL_REF\n+\t  && (DEFAULT_ABI != ABI_AIX || SYMBOL_REF_FUNCTION_P (op)));\n }\n \n /* Return 1 if the operand, used inside a MEM, is a valid first argument\n@@ -2102,17 +2103,10 @@ current_file_function_operand (op, mode)\n      rtx op;\n      enum machine_mode mode ATTRIBUTE_UNUSED;\n {\n-  if (GET_CODE (op) == SYMBOL_REF\n-      && (SYMBOL_REF_LOCAL_P (op)\n-\t  || (op == XEXP (DECL_RTL (current_function_decl), 0))))\n-    {\n-#ifdef ENABLE_CHECKING\n-      if (!SYMBOL_REF_FUNCTION_P (op))\n-\tabort ();\n-#endif\n-      return 1;\n-    }\n-  return 0;\n+  return (GET_CODE (op) == SYMBOL_REF\n+\t  && (DEFAULT_ABI != ABI_AIX || SYMBOL_REF_FUNCTION_P (op))\n+\t  && (SYMBOL_REF_LOCAL_P (op)\n+\t      || (op == XEXP (DECL_RTL (current_function_decl), 0))));\n }\n \n /* Return 1 if this operand is a valid input for a move insn.  */"}, {"sha": "e97be3fcd7f6cb1135716c5e0acee6905faae231", "filename": "gcc/config/rs6000/rs6000.md", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/473f51b66ab4326446dbac4dbc99f67bbfcceb07/gcc%2Fconfig%2Frs6000%2Frs6000.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/473f51b66ab4326446dbac4dbc99f67bbfcceb07/gcc%2Fconfig%2Frs6000%2Frs6000.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.md?ref=473f51b66ab4326446dbac4dbc99f67bbfcceb07", "patch": "@@ -10089,6 +10089,7 @@\n   operands[0] = XEXP (operands[0], 0);\n \n   if (GET_CODE (operands[0]) != SYMBOL_REF\n+      || (DEFAULT_ABI == ABI_AIX && !SYMBOL_REF_FUNCTION_P (operands[0]))\n       || (INTVAL (operands[2]) & CALL_LONG) != 0)\n     {\n       if (INTVAL (operands[2]) & CALL_LONG)\n@@ -10136,6 +10137,7 @@\n   operands[1] = XEXP (operands[1], 0);\n \n   if (GET_CODE (operands[1]) != SYMBOL_REF\n+      || (DEFAULT_ABI == ABI_AIX && !SYMBOL_REF_FUNCTION_P (operands[1]))\n       || (INTVAL (operands[3]) & CALL_LONG) != 0)\n     {\n       if (INTVAL (operands[3]) & CALL_LONG)"}, {"sha": "3de2bddcee04c2319a9ae46edf81c8239cf77086", "filename": "gcc/config/rs6000/rs64.md", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/473f51b66ab4326446dbac4dbc99f67bbfcceb07/gcc%2Fconfig%2Frs6000%2Frs64.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/473f51b66ab4326446dbac4dbc99f67bbfcceb07/gcc%2Fconfig%2Frs6000%2Frs64.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs64.md?ref=473f51b66ab4326446dbac4dbc99f67bbfcceb07", "patch": "@@ -18,11 +18,11 @@\n ;; Free Software Foundation, 59 Temple Place - Suite 330, Boston,\n ;; MA 02111-1307, USA.\n \n-(define_automaton \"rs64,rs64fp,rs64other\")\n+(define_automaton \"rs64,rs64fp\")\n (define_cpu_unit \"iu_rs64\" \"rs64\")\n (define_cpu_unit \"mciu_rs64\" \"rs64\")\n (define_cpu_unit \"fpu_rs64\" \"rs64fp\")\n-(define_cpu_unit \"lsu_rs64,bpu_rs64\" \"rs64other\")\n+(define_cpu_unit \"lsu_rs64,bpu_rs64\" \"rs64\")\n \n ;; RS64a 64-bit IU, LSU, FPU, BPU\n "}]}