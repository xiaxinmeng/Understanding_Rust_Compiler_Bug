{"sha": "ade7d3cc1db7b0c8e398fb9b3a5b065c4e7d3cec", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWRlN2QzY2MxZGI3YjBjOGUzOThmYjliM2E1YjA2NWM0ZTdkM2NlYw==", "commit": {"author": {"name": "Joseph Myers", "email": "jsm28@cam.ac.uk", "date": "2000-10-18T07:33:04Z"}, "committer": {"name": "Joseph Myers", "email": "jsm28@gcc.gnu.org", "date": "2000-10-18T07:33:04Z"}, "message": "c-common.c (CPLUSPLUS_STD_VER, [...]): Define.\n\n\t* c-common.c (CPLUSPLUS_STD_VER, C_STD_VER, C_STD_NAME): Define.\n\t(maybe_read_dollar_number, check_format_info_main): Use them for\n\tpedantic warning messages.\n\nFrom-SVN: r36931", "tree": {"sha": "68b6e159ffb83ef19f2cc09e7a7fc0ca9e546205", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/68b6e159ffb83ef19f2cc09e7a7fc0ca9e546205"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ade7d3cc1db7b0c8e398fb9b3a5b065c4e7d3cec", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ade7d3cc1db7b0c8e398fb9b3a5b065c4e7d3cec", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ade7d3cc1db7b0c8e398fb9b3a5b065c4e7d3cec", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ade7d3cc1db7b0c8e398fb9b3a5b065c4e7d3cec/comments", "author": {"login": "jsm28", "id": 10537793, "node_id": "MDQ6VXNlcjEwNTM3Nzkz", "avatar_url": "https://avatars.githubusercontent.com/u/10537793?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsm28", "html_url": "https://github.com/jsm28", "followers_url": "https://api.github.com/users/jsm28/followers", "following_url": "https://api.github.com/users/jsm28/following{/other_user}", "gists_url": "https://api.github.com/users/jsm28/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsm28/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsm28/subscriptions", "organizations_url": "https://api.github.com/users/jsm28/orgs", "repos_url": "https://api.github.com/users/jsm28/repos", "events_url": "https://api.github.com/users/jsm28/events{/privacy}", "received_events_url": "https://api.github.com/users/jsm28/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jsm28", "id": 10537793, "node_id": "MDQ6VXNlcjEwNTM3Nzkz", "avatar_url": "https://avatars.githubusercontent.com/u/10537793?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsm28", "html_url": "https://github.com/jsm28", "followers_url": "https://api.github.com/users/jsm28/followers", "following_url": "https://api.github.com/users/jsm28/following{/other_user}", "gists_url": "https://api.github.com/users/jsm28/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsm28/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsm28/subscriptions", "organizations_url": "https://api.github.com/users/jsm28/orgs", "repos_url": "https://api.github.com/users/jsm28/repos", "events_url": "https://api.github.com/users/jsm28/events{/privacy}", "received_events_url": "https://api.github.com/users/jsm28/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8682223f1d6bee4de096176ba4b3d389fce23d7d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8682223f1d6bee4de096176ba4b3d389fce23d7d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8682223f1d6bee4de096176ba4b3d389fce23d7d"}], "stats": {"total": 80, "additions": 44, "deletions": 36}, "files": [{"sha": "6539596d27c8622c0d29f07542de9078f355f87c", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ade7d3cc1db7b0c8e398fb9b3a5b065c4e7d3cec/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ade7d3cc1db7b0c8e398fb9b3a5b065c4e7d3cec/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=ade7d3cc1db7b0c8e398fb9b3a5b065c4e7d3cec", "patch": "@@ -1,3 +1,9 @@\n+2000-10-18  Joseph S. Myers  <jsm28@cam.ac.uk>\n+\n+\t* c-common.c (CPLUSPLUS_STD_VER, C_STD_VER, C_STD_NAME): Define.\n+\t(maybe_read_dollar_number, check_format_info_main): Use them for\n+\tpedantic warning messages.\n+\n 2000-10-18  Joseph S. Myers  <jsm28@cam.ac.uk>\n \n \t* c-common.c (check_format_info_main): Minor cleanup: move"}, {"sha": "e9548dc155143454d40f45fea32feab1b64dc72a", "filename": "gcc/c-common.c", "status": "modified", "additions": 38, "deletions": 36, "changes": 74, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ade7d3cc1db7b0c8e398fb9b3a5b065c4e7d3cec/gcc%2Fc-common.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ade7d3cc1db7b0c8e398fb9b3a5b065c4e7d3cec/gcc%2Fc-common.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-common.c?ref=ade7d3cc1db7b0c8e398fb9b3a5b065c4e7d3cec", "patch": "@@ -1265,6 +1265,23 @@ enum format_std_version\n   STD_EXT\n };\n \n+/* The C standard version C++ is treated as equivalent to\n+   or inheriting from, for the purpose of format features supported.  */\n+#define CPLUSPLUS_STD_VER\tSTD_C89\n+/* The C standard version we are checking formats against when pedantic.  */\n+#define C_STD_VER\t\t(c_language == clk_cplusplus\t\t  \\\n+\t\t\t\t ? CPLUSPLUS_STD_VER\t\t\t  \\\n+\t\t\t\t : (flag_isoc99\t\t\t\t  \\\n+\t\t\t\t    ? STD_C99\t\t\t\t  \\\n+\t\t\t\t    : (flag_isoc94 ? STD_C94 : STD_C89)))\n+/* The name to give to the standard version we are warning about when\n+   pedantic.  FEATURE_VER is the version in which the feature warned out\n+   appeared, which is higher than C_STD_VER.  */\n+#define C_STD_NAME(FEATURE_VER) (c_language == clk_cplusplus\t\\\n+\t\t\t\t ? \"ISO C++\"\t\t\t\\\n+\t\t\t\t : ((FEATURE_VER) == STD_EXT\t\\\n+\t\t\t\t    ? \"ISO C\"\t\t\t\\\n+\t\t\t\t    : \"ISO C89\"))\n \n /* Flags that may apply to a particular kind of format checked by GCC.  */\n enum\n@@ -2113,7 +2130,9 @@ maybe_read_dollar_number (status, format, dollar_needed, params, param_ptr,\n   *format = fcp + 1;\n   if (pedantic && !dollar_format_warned)\n     {\n-      status_warning (status, \"ISO C does not support %%n$ operand number formats\");\n+      status_warning (status,\n+\t\t      \"%s does not support %%n$ operand number formats\",\n+\t\t      C_STD_NAME (STD_EXT));\n       dollar_format_warned = 1;\n     }\n   if (overflow_flag || argnum == 0\n@@ -2755,13 +2774,10 @@ check_format_info_main (status, res, info, format_chars, format_length,\n \t  if (pedantic)\n \t    {\n \t      /* Warn if the length modifier is non-standard.  */\n-\t      if (length_chars_std == STD_EXT)\n-\t\tstatus_warning (status, \"ISO C does not support the `%s' %s length modifier\",\n-\t\t\t length_chars, fki->name);\n-\t      else if ((length_chars_std == STD_C99 && !flag_isoc99)\n-\t\t       || (length_chars_std == STD_C94 && !flag_isoc94))\n-\t\tstatus_warning (status, \"ISO C89 does not support the `%s' %s length modifier\",\n-\t\t\t length_chars, fki->name);\n+\t      if (length_chars_std > C_STD_VER)\n+\t\tstatus_warning (status, \"%s does not support the `%s' %s length modifier\",\n+\t\t\t\tC_STD_NAME (length_chars_std), length_chars,\n+\t\t\t\tfki->name);\n \t    }\n \t}\n \n@@ -2828,13 +2844,9 @@ check_format_info_main (status, res, info, format_chars, format_length,\n \t}\n       if (pedantic)\n \t{\n-\t  if (fci->std == STD_EXT)\n-\t    status_warning (status, \"ISO C does not support the `%%%c' %s format\",\n-\t\t     format_char, fki->name);\n-\t  else if ((fci->std == STD_C99 && !flag_isoc99)\n-\t\t   || (fci->std == STD_C94 && !flag_isoc94))\n-\t    status_warning (status, \"ISO C89 does not support the `%%%c' %s format\",\n-\t\t     format_char, fki->name);\n+\t  if (fci->std > C_STD_VER)\n+\t    status_warning (status, \"%s does not support the `%%%c' %s format\",\n+\t\t\t    C_STD_NAME (fci->std), format_char, fki->name);\n \t}\n \n       /* Validate the individual flags used, removing any that are invalid.  */\n@@ -2857,26 +2869,19 @@ check_format_info_main (status, res, info, format_chars, format_length,\n \t    if (pedantic)\n \t      {\n \t\tconst format_flag_spec *t;\n-\t\tif (s->std == STD_EXT)\n-\t\t  status_warning (status, \"ISO C does not support %s\",\n-\t\t\t\t  _(s->long_name));\n-\t\telse if ((s->std == STD_C99 && !flag_isoc99)\n-\t\t\t || (s->std == STD_C94 && !flag_isoc94))\n-\t\t  status_warning (status, \"ISO C89 does not support %s\",\n-\t\t\t\t  _(s->long_name));\n+\t\tif (s->std > C_STD_VER)\n+\t\t  status_warning (status, \"%s does not support %s\",\n+\t\t\t\t  C_STD_NAME (s->std), _(s->long_name));\n \t\tt = get_flag_spec (flag_specs, flag_chars[i], fci->flags2);\n \t\tif (t != NULL && t->std > s->std)\n \t\t  {\n \t\t    const char *long_name = (t->long_name != NULL\n \t\t\t\t\t     ? t->long_name\n \t\t\t\t\t     : s->long_name);\n-\t\t    if (t->std == STD_EXT)\n-\t\t      status_warning (status, \"ISO C does not support %s with the `%%%c' %s format\",\n-\t\t\t\t      _(long_name), format_char, fki->name);\n-\t\t    else if ((t->std == STD_C99 && !flag_isoc99)\n-\t\t\t     || (t->std == STD_C94 && !flag_isoc94))\n-\t\t      status_warning (status, \"ISO C89 does not support %s with the `%%%c' %s format\",\n-\t\t\t\t      _(long_name), format_char, fki->name);\n+\t\t    if (t->std > C_STD_VER)\n+\t\t      status_warning (status, \"%s does not support %s with the `%%%c' %s format\",\n+\t\t\t\t      C_STD_NAME (t->std), _(long_name),\n+\t\t\t\t      format_char, fki->name);\n \t\t  }\n \t      }\n \t  }\n@@ -2991,13 +2996,10 @@ check_format_info_main (status, res, info, format_chars, format_length,\n \t\t   && wanted_type_std > length_chars_std\n \t\t   && wanted_type_std > fci->std)\n \t    {\n-\t      if (wanted_type_std == STD_EXT)\n-\t\tstatus_warning (status, \"ISO C does not support the `%%%s%c' %s format\",\n-\t\t\t\tlength_chars, format_char, fki->name);\n-\t      else if ((wanted_type_std == STD_C99 && !flag_isoc99)\n-\t\t       || (wanted_type_std == STD_C94 && !flag_isoc94))\n-\t\tstatus_warning (status, \"ISO C89 does not support the `%%%s%c' %s format\",\n-\t\t\t\tlength_chars, format_char, fki->name);\n+\t      if (wanted_type_std > C_STD_VER)\n+\t\tstatus_warning (status, \"%s does not support the `%%%s%c' %s format\",\n+\t\t\t\tC_STD_NAME (wanted_type_std), length_chars,\n+\t\t\t\tformat_char, fki->name);\n \t    }\n \t}\n "}]}