{"sha": "781a1758a4ef01a2a06d870e384d0f5be5cf09fa", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzgxYTE3NThhNGVmMDFhMmEwNmQ4NzBlMzg0ZDBmNWJlNWNmMDlmYQ==", "commit": {"author": {"name": "Richard Sandiford", "email": "r.sandiford@uk.ibm.com", "date": "2009-06-02T19:08:28Z"}, "committer": {"name": "Richard Sandiford", "email": "rsandifo@gcc.gnu.org", "date": "2009-06-02T19:08:28Z"}, "message": "collect2.c (target_system_root): New variable.\n\ngcc/\n\t* collect2.c (target_system_root): New variable.\n\t(main): Handle --sysroot=.\n\t(ignore_library): Strip the sysroot from the library path.\n\nFrom-SVN: r148097", "tree": {"sha": "61e3bda30c2e088b20ba314616e6fbb66afd9695", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/61e3bda30c2e088b20ba314616e6fbb66afd9695"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/781a1758a4ef01a2a06d870e384d0f5be5cf09fa", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/781a1758a4ef01a2a06d870e384d0f5be5cf09fa", "html_url": "https://github.com/Rust-GCC/gccrs/commit/781a1758a4ef01a2a06d870e384d0f5be5cf09fa", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/781a1758a4ef01a2a06d870e384d0f5be5cf09fa/comments", "author": null, "committer": null, "parents": [{"sha": "dfb636dcd052f5f68ba6abf5b9041c3c63562438", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dfb636dcd052f5f68ba6abf5b9041c3c63562438", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dfb636dcd052f5f68ba6abf5b9041c3c63562438"}], "stats": {"total": 24, "additions": 24, "deletions": 0}, "files": [{"sha": "9c05763b30cb8f127b54e0d27477e2a25d96f548", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/781a1758a4ef01a2a06d870e384d0f5be5cf09fa/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/781a1758a4ef01a2a06d870e384d0f5be5cf09fa/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=781a1758a4ef01a2a06d870e384d0f5be5cf09fa", "patch": "@@ -1,3 +1,9 @@\n+2009-06-02  Richard Sandiford  <r.sandiford@uk.ibm.com>\n+\n+\t* collect2.c (target_system_root): New variable.\n+\t(main): Handle --sysroot=.\n+\t(ignore_library): Strip the sysroot from the library path.\n+\n 2009-06-02  Richard Sandiford  <r.sandiford@uk.ibm.com>\n \n \t* Makefile.in (COLLECT2_OBJS): Add collect2-aix.o."}, {"sha": "9848b903580b1ec94d361c28c3aeb4a0546894ed", "filename": "gcc/collect2.c", "status": "modified", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/781a1758a4ef01a2a06d870e384d0f5be5cf09fa/gcc%2Fcollect2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/781a1758a4ef01a2a06d870e384d0f5be5cf09fa/gcc%2Fcollect2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcollect2.c?ref=781a1758a4ef01a2a06d870e384d0f5be5cf09fa", "patch": "@@ -217,6 +217,14 @@ static char *response_file;\t\t/* Name of any current response file */\n struct obstack temporary_obstack;\n char * temporary_firstobj;\n \n+/* A string that must be prepended to a target OS path in order to find\n+   it on the host system.  */\n+#ifdef TARGET_SYSTEM_ROOT\n+static const char *target_system_root = TARGET_SYSTEM_ROOT;\n+#else\n+static const char *target_system_root = \"\";\n+#endif\n+\n /* Structure to hold all the directories in which to search for files to\n    execute.  */\n \n@@ -1224,6 +1232,8 @@ main (int argc, char **argv)\n \t\t  ld1--;\n \t\t  ld2--;\n \t\t}\n+\t      else if (strncmp (arg, \"--sysroot=\", 10) == 0)\n+\t\ttarget_system_root = arg + 10;\n \t      break;\n \t    }\n \t}\n@@ -2454,7 +2464,15 @@ static int\n ignore_library (const char *name)\n {\n   const char *const *p;\n+  size_t length;\n \n+  if (target_system_root[0] != '\\0')\n+    {\n+      length = strlen (target_system_root);\n+      if (strncmp (name, target_system_root, length) != 0)\n+\treturn 0;\n+      name += length;\n+    }\n   for (p = &aix_std_libs[0]; *p != NULL; ++p)\n     if (strcmp (name, *p) == 0)\n       return 1;"}]}