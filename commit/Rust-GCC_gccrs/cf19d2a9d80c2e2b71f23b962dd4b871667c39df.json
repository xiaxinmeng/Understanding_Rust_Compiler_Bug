{"sha": "cf19d2a9d80c2e2b71f23b962dd4b871667c39df", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Y2YxOWQyYTlkODBjMmUyYjcxZjIzYjk2MmRkNGI4NzE2NjdjMzlkZg==", "commit": {"author": {"name": "Jeff Law", "email": "law@gcc.gnu.org", "date": "1994-08-13T17:51:15Z"}, "committer": {"name": "Jeff Law", "email": "law@gcc.gnu.org", "date": "1994-08-13T17:51:15Z"}, "message": "reload1.c (emit_reload_insns): Handle a secondary input reload which needs to use secondary memory too.\n\n        * reload1.c (emit_reload_insns): Handle a secondary input reload\n        which needs to use secondary memory too.\n\nFrom-SVN: r7912", "tree": {"sha": "d97a853cd9a5947e97b482afb727aa161d269598", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d97a853cd9a5947e97b482afb727aa161d269598"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/cf19d2a9d80c2e2b71f23b962dd4b871667c39df", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cf19d2a9d80c2e2b71f23b962dd4b871667c39df", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cf19d2a9d80c2e2b71f23b962dd4b871667c39df", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cf19d2a9d80c2e2b71f23b962dd4b871667c39df/comments", "author": null, "committer": null, "parents": [{"sha": "336d6f0a7e2a25d3a50b7afe1d43b3a40e89e22e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/336d6f0a7e2a25d3a50b7afe1d43b3a40e89e22e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/336d6f0a7e2a25d3a50b7afe1d43b3a40e89e22e"}], "stats": {"total": 46, "additions": 44, "deletions": 2}, "files": [{"sha": "2891bd33638d2d862db67e48bb49cc43768ad154", "filename": "gcc/reload1.c", "status": "modified", "additions": 44, "deletions": 2, "changes": 46, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cf19d2a9d80c2e2b71f23b962dd4b871667c39df/gcc%2Freload1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cf19d2a9d80c2e2b71f23b962dd4b871667c39df/gcc%2Freload1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Freload1.c?ref=cf19d2a9d80c2e2b71f23b962dd4b871667c39df", "patch": "@@ -6001,8 +6001,50 @@ emit_reload_insns (insn)\n \t\t    {\n \t\t      if (icode != CODE_FOR_nothing)\n \t\t\t{\n-\t\t\t  emit_insn (GEN_FCN (icode) (reloadreg, real_oldequiv,\n-\t\t\t\t\t\t      second_reload_reg));\n+\t\t\t  rtx pat;\n+#ifdef SECONDARY_MEMORY_NEEDED\n+\t\t\t  /* If we need a memory location to do the move, do\n+\t\t\t     it that way.  */\n+\t\t\t  if (GET_CODE (real_oldequiv) == REG\n+\t\t\t      && REGNO (real_oldequiv) < FIRST_PSEUDO_REGISTER\n+\t\t\t      && SECONDARY_MEMORY_NEEDED\n+\t\t\t      (REGNO_REG_CLASS (REGNO (real_oldequiv)),\n+\t\t\t       REGNO_REG_CLASS (REGNO (second_reload_reg)),\n+\t\t\t       GET_MODE (second_reload_reg)))\n+\t\t\t    {\n+\t\t\t      /* Get the memory to use and rewrite both\n+\t\t\t\t registers to its mode.  */\n+\t\t\t      rtx loc\n+\t\t\t\t= get_secondary_mem (real_oldequiv,\n+\t\t\t\t\t\t     GET_MODE (second_reload_reg),\n+\t\t\t\t\t\t     reload_opnum[j],\n+\t\t\t\t\t\t     reload_when_needed[j]);\n+\t\t\t      rtx tmp_reloadreg;\n+\n+\t\t\t      if (GET_MODE (loc)\n+\t\t\t\t  != GET_MODE (second_reload_reg))\n+\t\t\t\tsecond_reload_reg\n+\t\t\t\t  = gen_rtx (REG,\n+\t\t\t\t\t     GET_MODE (loc),\n+\t\t\t\t\t     REGNO (second_reload_reg));\n+\t\t\t  \n+\t\t\t      if (GET_MODE (loc) != GET_MODE (real_oldequiv))\n+\t\t\t\ttmp_reloadreg = gen_rtx (REG, GET_MODE (loc),\n+\t\t\t\t\t\t\t REGNO (real_oldequiv));\n+\t\t\t      else\n+\t\t\t\ttmp_reloadreg = real_oldequiv;\n+\t\t\t      \n+\t\t\t      emit_move_insn (loc, tmp_reloadreg);\n+\t\t\t      emit_move_insn (second_reload_reg, loc);\n+\t\t\t      pat = gen_move_insn (reloadreg, second_reload_reg);\n+\t\t\t      \n+\t\t\t    }\n+\t\t\t  else\n+#endif\n+\t\t\t    pat = GEN_FCN (icode) (reloadreg,\n+\t\t\t\t\t\t   real_oldequiv,\n+\t\t\t\t\t\t   second_reload_reg);\n+\t\t\t  emit_insn (pat);\n \t\t\t  special = 1;\n \t\t\t}\n \t\t      else"}]}