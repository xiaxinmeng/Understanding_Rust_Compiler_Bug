{"sha": "d2672ffea0a478b265f5ed0239723c8ba54e8d24", "node_id": "C_kwDOANBUbNoAKGQyNjcyZmZlYTBhNDc4YjI2NWY1ZWQwMjM5NzIzYzhiYTU0ZThkMjQ", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2022-06-08T22:24:34Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "derodat@adacore.com", "date": "2022-07-05T08:28:20Z"}, "message": "[Ada] Couple of small cleanups for Cloned_Subtype\n\nNo functional changes.\n\ngcc/ada/\n\n\t* exp_util.adb (Make_Subtype_From_Expr): Do not set field to Empty.\n\t* sem_util.adb (Visit_Itype): Remove ??? comment.", "tree": {"sha": "ecab2b7dfc2956851a398b4ed7639cd73d5e7f27", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ecab2b7dfc2956851a398b4ed7639cd73d5e7f27"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d2672ffea0a478b265f5ed0239723c8ba54e8d24", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d2672ffea0a478b265f5ed0239723c8ba54e8d24", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d2672ffea0a478b265f5ed0239723c8ba54e8d24", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d2672ffea0a478b265f5ed0239723c8ba54e8d24/comments", "author": null, "committer": {"login": "pmderodat", "id": 758452, "node_id": "MDQ6VXNlcjc1ODQ1Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/758452?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pmderodat", "html_url": "https://github.com/pmderodat", "followers_url": "https://api.github.com/users/pmderodat/followers", "following_url": "https://api.github.com/users/pmderodat/following{/other_user}", "gists_url": "https://api.github.com/users/pmderodat/gists{/gist_id}", "starred_url": "https://api.github.com/users/pmderodat/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pmderodat/subscriptions", "organizations_url": "https://api.github.com/users/pmderodat/orgs", "repos_url": "https://api.github.com/users/pmderodat/repos", "events_url": "https://api.github.com/users/pmderodat/events{/privacy}", "received_events_url": "https://api.github.com/users/pmderodat/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a2eaf87ffeaee689e431a3c85b001208d6705421", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a2eaf87ffeaee689e431a3c85b001208d6705421", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a2eaf87ffeaee689e431a3c85b001208d6705421"}], "stats": {"total": 12, "additions": 5, "deletions": 7}, "files": [{"sha": "8557e4bb4bd95608fe292ba8acb3722edb8ba84d", "filename": "gcc/ada/exp_util.adb", "status": "modified", "additions": 4, "deletions": 5, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d2672ffea0a478b265f5ed0239723c8ba54e8d24/gcc%2Fada%2Fexp_util.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d2672ffea0a478b265f5ed0239723c8ba54e8d24/gcc%2Fada%2Fexp_util.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fexp_util.adb?ref=d2672ffea0a478b265f5ed0239723c8ba54e8d24", "patch": "@@ -10213,8 +10213,8 @@ package body Exp_Util is\n \n       elsif Is_Class_Wide_Type (Unc_Typ) then\n          declare\n-            CW_Subtype : Entity_Id;\n-            EQ_Typ     : Entity_Id := Empty;\n+            CW_Subtype : constant Entity_Id :=\n+                           New_Class_Wide_Subtype (Unc_Typ, E);\n \n          begin\n             --  A class-wide equivalent type is not needed on VM targets\n@@ -10237,11 +10237,10 @@ package body Exp_Util is\n                   Set_Etype (Unc_Typ, Base_Type (Full_View (Etype (Unc_Typ))));\n                end if;\n \n-               EQ_Typ := Make_CW_Equivalent_Type (Unc_Typ, E);\n+               Set_Equivalent_Type\n+                 (CW_Subtype, Make_CW_Equivalent_Type (Unc_Typ, E));\n             end if;\n \n-            CW_Subtype := New_Class_Wide_Subtype (Unc_Typ, E);\n-            Set_Equivalent_Type (CW_Subtype, EQ_Typ);\n             Set_Cloned_Subtype (CW_Subtype, Base_Type (Unc_Typ));\n \n             return New_Occurrence_Of (CW_Subtype, Loc);"}, {"sha": "edb948234ab6dc6e6e4b5a5d2664299bf145caa3", "filename": "gcc/ada/sem_util.adb", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d2672ffea0a478b265f5ed0239723c8ba54e8d24/gcc%2Fada%2Fsem_util.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d2672ffea0a478b265f5ed0239723c8ba54e8d24/gcc%2Fada%2Fsem_util.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_util.adb?ref=d2672ffea0a478b265f5ed0239723c8ba54e8d24", "patch": "@@ -25146,8 +25146,7 @@ package body Sem_Util is\n          end if;\n \n          --  If a record subtype is simply copied, the entity list will be\n-         --  shared. Thus cloned_Subtype must be set to indicate the sharing.\n-         --  ??? What does this do?\n+         --  shared, so Cloned_Subtype must be set to indicate this.\n \n          if Ekind (Itype) in E_Class_Wide_Subtype | E_Record_Subtype then\n             Set_Cloned_Subtype (New_Itype, Itype);"}]}