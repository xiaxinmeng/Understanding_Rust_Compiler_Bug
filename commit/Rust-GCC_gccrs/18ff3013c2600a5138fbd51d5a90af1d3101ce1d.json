{"sha": "18ff3013c2600a5138fbd51d5a90af1d3101ce1d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MThmZjMwMTNjMjYwMGE1MTM4ZmJkNTFkNWE5MGFmMWQzMTAxY2UxZA==", "commit": {"author": {"name": "Danny Smith", "email": "dannysmith@users.sourceforge.net", "date": "2007-09-25T00:29:42Z"}, "committer": {"name": "Danny Smith", "email": "dannysmith@gcc.gnu.org", "date": "2007-09-25T00:29:42Z"}, "message": "re PR c++/14688 (Mis-matched calling convention on virtual functions accepted without error)\n\n\tPR c++/14688\n\t* config/i386/i386.c (ix86_comp_type_attributes): Check\n\tMETHOD_TYPE too.\n\ncp\n\t* search.c (check_final_overrider): Fail if\n\ttargetm.comp_type_attributes returns 0.\n\ntestsuite\n\t* g++.dg/inherit/override_attribs.C: New file.\n\nFrom-SVN: r128740", "tree": {"sha": "0cb7e4ad382ef40b1366d5f251d6999479bde0ac", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0cb7e4ad382ef40b1366d5f251d6999479bde0ac"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/18ff3013c2600a5138fbd51d5a90af1d3101ce1d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/18ff3013c2600a5138fbd51d5a90af1d3101ce1d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/18ff3013c2600a5138fbd51d5a90af1d3101ce1d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/18ff3013c2600a5138fbd51d5a90af1d3101ce1d/comments", "author": null, "committer": null, "parents": [{"sha": "2e104885214d399548cd5742e5b818cd63c02dbf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2e104885214d399548cd5742e5b818cd63c02dbf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2e104885214d399548cd5742e5b818cd63c02dbf"}], "stats": {"total": 54, "additions": 53, "deletions": 1}, "files": [{"sha": "07b24d72baa8946ab55f2fdbd97b91819e979cc1", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/18ff3013c2600a5138fbd51d5a90af1d3101ce1d/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/18ff3013c2600a5138fbd51d5a90af1d3101ce1d/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=18ff3013c2600a5138fbd51d5a90af1d3101ce1d", "patch": "@@ -1,3 +1,9 @@\n+2007-09-24  Danny Smith  <dannysmith@user.sourceforge.net>\n+\n+\tPR c++/14688\n+\t* config/i386/i386.c (ix86_comp_type_attributes): Check\n+\tMETHOD_TYPE too.\n+\n 2007-09-24  Roman Zippel <zippel@linux-m68k.org> \n \n \t* config/m68k/m68k.h (ASM_OUTPUT_ALIGN_WITH_NOP): New, use"}, {"sha": "a9ca27b5e02c975c646f0680d97723416519784c", "filename": "gcc/config/i386/i386.c", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/18ff3013c2600a5138fbd51d5a90af1d3101ce1d/gcc%2Fconfig%2Fi386%2Fi386.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/18ff3013c2600a5138fbd51d5a90af1d3101ce1d/gcc%2Fconfig%2Fi386%2Fi386.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386.c?ref=18ff3013c2600a5138fbd51d5a90af1d3101ce1d", "patch": "@@ -3118,7 +3118,8 @@ ix86_comp_type_attributes (const_tree type1, const_tree type2)\n   /* Check for mismatch of non-default calling convention.  */\n   const char *const rtdstr = TARGET_RTD ? \"cdecl\" : \"stdcall\";\n \n-  if (TREE_CODE (type1) != FUNCTION_TYPE)\n+  if (TREE_CODE (type1) != FUNCTION_TYPE\n+      && TREE_CODE (type1) != METHOD_TYPE)\n     return 1;\n \n   /* Check for mismatched fastcall/regparm types.  */\n@@ -7839,6 +7840,7 @@ get_dllimport_decl (tree decl)\n   set_mem_alias_set (rtl, ix86_GOT_alias_set ());\n \n   SET_DECL_RTL (to, rtl);\n+  SET_DECL_ASSEMBLER_NAME (to, get_identifier (name));\n \n   return to;\n }"}, {"sha": "0effc4bc2a5c312402df12195a1bfc35aea590d0", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/18ff3013c2600a5138fbd51d5a90af1d3101ce1d/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/18ff3013c2600a5138fbd51d5a90af1d3101ce1d/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=18ff3013c2600a5138fbd51d5a90af1d3101ce1d", "patch": "@@ -1,3 +1,10 @@\n+2007-09-24  Danny Smith  <dannysmith@user.sourceforge.net>\n+\n+\tPR c++/14688\n+        * search.c (check_final_overrider): Fail if\n+\ttargetm.comp_type_attributes returns 0.\n+\n+\n 2007-09-24  Jason Merrill  <jason@redhat.com>\n \n \tPR c++/33239"}, {"sha": "13e252edd9f488ddadb8200e8872b99e24458968", "filename": "gcc/cp/search.c", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/18ff3013c2600a5138fbd51d5a90af1d3101ce1d/gcc%2Fcp%2Fsearch.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/18ff3013c2600a5138fbd51d5a90af1d3101ce1d/gcc%2Fcp%2Fsearch.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fsearch.c?ref=18ff3013c2600a5138fbd51d5a90af1d3101ce1d", "patch": "@@ -33,6 +33,7 @@ along with GCC; see the file COPYING3.  If not see\n #include \"rtl.h\"\n #include \"output.h\"\n #include \"toplev.h\"\n+#include \"target.h\"\n \n static int is_subobject_of_p (tree, tree);\n static tree dfs_lookup_base (tree, void *);\n@@ -1901,6 +1902,15 @@ check_final_overrider (tree overrider, tree basefn)\n       return 0;\n     }\n \n+  /* Check for conflicting type attributes.  */\n+  if (!targetm.comp_type_attributes (over_type, base_type))\n+    {\n+      error (\"conflicting type attributes specified for %q+#D\", overrider);\n+      error (\"  overriding %q+#D\", basefn);\n+      DECL_INVALID_OVERRIDER_P (overrider) = 1;\n+      return 0;\n+    }\n+\n   return 1;\n }\n "}, {"sha": "6caa3205cb670ef37ce9def9a4a92c22751bc7a8", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/18ff3013c2600a5138fbd51d5a90af1d3101ce1d/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/18ff3013c2600a5138fbd51d5a90af1d3101ce1d/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=18ff3013c2600a5138fbd51d5a90af1d3101ce1d", "patch": "@@ -1,3 +1,8 @@\n+2007-09-24  Danny Smith  <dannysmith@user.sourceforge.net>\n+\n+\tPR c++/14688\n+\t* g++.dg/inherit/override_attribs.C: New file.\n+\n 2007-09-23  Tobias Schl\ufffdter  <tobi@gcc.gnu.org>\n \n \tPR fortran/33269"}, {"sha": "44a1ea49734465b9274872823e73e355d0b80ae7", "filename": "gcc/testsuite/g++.dg/inherit/override-attribs.C", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/18ff3013c2600a5138fbd51d5a90af1d3101ce1d/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Finherit%2Foverride-attribs.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/18ff3013c2600a5138fbd51d5a90af1d3101ce1d/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Finherit%2Foverride-attribs.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Finherit%2Foverride-attribs.C?ref=18ff3013c2600a5138fbd51d5a90af1d3101ce1d", "patch": "@@ -0,0 +1,22 @@\n+// PR c++/14688\n+// { dg-do compile { target i?86-*-* } }\n+class one\n+{\n+public:\n+  virtual void\n+  test(void* value);  // { dg-error \"overriding\" }\n+};\n+\n+class two : public one\n+{\n+public:\n+  void  __attribute__((regparm(2)))\n+  test(void* value);  // { dg-error \"conflicting type attributes\"  }\n+};\n+\n+class three : public one\n+{\n+public:\n+  void __attribute__ ((cdecl))\n+  test(void* value);  // OK\n+};"}]}