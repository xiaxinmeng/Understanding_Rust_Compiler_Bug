{"sha": "f58e97341c3204fb2ab0fc6a03778e5923a9d94c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjU4ZTk3MzQxYzMyMDRmYjJhYjBmYzZhMDM3NzhlNTkyM2E5ZDk0Yw==", "commit": {"author": {"name": "Dorit Nuzman", "email": "dorit@il.ibm.com", "date": "2007-03-18T04:37:32Z"}, "committer": {"name": "Dorit Nuzman", "email": "dorit@gcc.gnu.org", "date": "2007-03-18T04:37:32Z"}, "message": "tree-vect-transform.c (get_initial_def_for_induction): Replace GET_MODE_NUNITS with TYPE_VECTOR_SUBPARTS.\n\n        * tree-vect-transform.c (get_initial_def_for_induction): Replace\n        GET_MODE_NUNITS with TYPE_VECTOR_SUBPARTS.\n        (get_initial_def_for_reduction): Likewise.\n\nFrom-SVN: r123034", "tree": {"sha": "76ae0deab6b7d30ce6eae7e59959836737c46570", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/76ae0deab6b7d30ce6eae7e59959836737c46570"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f58e97341c3204fb2ab0fc6a03778e5923a9d94c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f58e97341c3204fb2ab0fc6a03778e5923a9d94c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f58e97341c3204fb2ab0fc6a03778e5923a9d94c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f58e97341c3204fb2ab0fc6a03778e5923a9d94c/comments", "author": null, "committer": null, "parents": [{"sha": "59111135a832fdf0f24555e234b98452a0522073", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/59111135a832fdf0f24555e234b98452a0522073", "html_url": "https://github.com/Rust-GCC/gccrs/commit/59111135a832fdf0f24555e234b98452a0522073"}], "stats": {"total": 51, "additions": 49, "deletions": 2}, "files": [{"sha": "fa5122280aa34866308f3da43124d67c03db4225", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f58e97341c3204fb2ab0fc6a03778e5923a9d94c/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f58e97341c3204fb2ab0fc6a03778e5923a9d94c/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=f58e97341c3204fb2ab0fc6a03778e5923a9d94c", "patch": "@@ -1,3 +1,9 @@\n+2007-03-18  Dorit Nuzman  <dorit@il.ibm.com>\n+\n+\t* tree-vect-transform.c (get_initial_def_for_induction): Replace\n+\tGET_MODE_NUNITS with TYPE_VECTOR_SUBPARTS.\n+\t(get_initial_def_for_reduction): Likewise.\n+\n 2007-03-16  Daniel Berlin  <dberlin@dberlin.org>\n \n \tFix PR tree-optimization/29922"}, {"sha": "2a61218812a40dbcfc4a3218aca47d2c737fdc85", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f58e97341c3204fb2ab0fc6a03778e5923a9d94c/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f58e97341c3204fb2ab0fc6a03778e5923a9d94c/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=f58e97341c3204fb2ab0fc6a03778e5923a9d94c", "patch": "@@ -1,3 +1,8 @@\n+2007-03-18  Dorit Nuzman  <dorit@il.ibm.com>\n+\n+\t* gcc.dg/vect/no-tree-dom-vect-bug.c: New test.\n+\t* gcc.dg/vect/vect.exp: Compile tests with -fno-tree-dominator-opts.\n+ \n 2007-03-17  Francois-Xavier Coudert  <coudert@clipper.ens.fr>\n \n \tPR fortran/31120"}, {"sha": "3df9afe3bbdc2d41998a995722c7c1bdddd7e5d7", "filename": "gcc/testsuite/gcc.dg/vect/no-tree-dom-vect-bug.c", "status": "added", "additions": 30, "deletions": 0, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f58e97341c3204fb2ab0fc6a03778e5923a9d94c/gcc%2Ftestsuite%2Fgcc.dg%2Fvect%2Fno-tree-dom-vect-bug.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f58e97341c3204fb2ab0fc6a03778e5923a9d94c/gcc%2Ftestsuite%2Fgcc.dg%2Fvect%2Fno-tree-dom-vect-bug.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fvect%2Fno-tree-dom-vect-bug.c?ref=f58e97341c3204fb2ab0fc6a03778e5923a9d94c", "patch": "@@ -0,0 +1,30 @@\n+/* { dg-require-effective-target vect_int } */\n+\n+#include <stdarg.h>\n+#include \"tree-vect.h\"\n+\n+long stack_vars_sorted[32];\n+\n+int\n+main1 (long n)\n+{\n+  long si;\n+\n+  for (si = 0; si < n; ++si)\n+    stack_vars_sorted[si] = si;\n+}\n+\n+int main ()\n+{\n+  long si;\n+\n+  check_vect ();\n+  main1 (32);\n+\n+  for (si = 0; si < 32; ++si)\n+    if (stack_vars_sorted[si] != si)\n+      abort ();\n+\n+  return 0;\n+}\n+/* { dg-final { cleanup-tree-dump \"vect\" } } */"}, {"sha": "158c4187104663c5a5a70b104025314414489d10", "filename": "gcc/testsuite/gcc.dg/vect/vect.exp", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f58e97341c3204fb2ab0fc6a03778e5923a9d94c/gcc%2Ftestsuite%2Fgcc.dg%2Fvect%2Fvect.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f58e97341c3204fb2ab0fc6a03778e5923a9d94c/gcc%2Ftestsuite%2Fgcc.dg%2Fvect%2Fvect.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fvect%2Fvect.exp?ref=f58e97341c3204fb2ab0fc6a03778e5923a9d94c", "patch": "@@ -162,6 +162,12 @@ lappend DEFAULT_VECTCFLAGS \"-fno-tree-scev-cprop\"\n dg-runtest [lsort [glob -nocomplain $srcdir/$subdir/no-tree-scev-cprop-*.\\[cS\\]]]  \\\n \t\"\" $DEFAULT_VECTCFLAGS\n \n+# -fno-tree-dominator-opts\n+set DEFAULT_VECTCFLAGS $SAVED_DEFAULT_VECTCFLAGS\n+lappend DEFAULT_VECTCFLAGS \"-fno-tree-dominator-opts\"\n+dg-runtest [lsort [glob -nocomplain $srcdir/$subdir/no-tree-dom-*.\\[cS\\]]]  \\\n+\t\"\" $DEFAULT_VECTCFLAGS\n+\n # With -Os\n lappend DEFAULT_VECTCFLAGS \"-Os\"\n dg-runtest [lsort [glob -nocomplain $srcdir/$subdir/Os-vect-*.\\[cS\\]]]  \\"}, {"sha": "456138361d43f8b5e78334523c414cd4fa3834c1", "filename": "gcc/tree-vect-transform.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f58e97341c3204fb2ab0fc6a03778e5923a9d94c/gcc%2Ftree-vect-transform.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f58e97341c3204fb2ab0fc6a03778e5923a9d94c/gcc%2Ftree-vect-transform.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-vect-transform.c?ref=f58e97341c3204fb2ab0fc6a03778e5923a9d94c", "patch": "@@ -531,7 +531,7 @@ get_initial_def_for_induction (tree stmt, tree iv_phi)\n   struct loop *loop = LOOP_VINFO_LOOP (loop_vinfo);\n   tree scalar_type = TREE_TYPE (iv_phi);\n   tree vectype = get_vectype_for_scalar_type (scalar_type);\n-  int nunits = GET_MODE_NUNITS (TYPE_MODE (vectype));\n+  int nunits =  TYPE_VECTOR_SUBPARTS (vectype);\n   edge pe = loop_preheader_edge (loop);\n   basic_block new_bb;\n   block_stmt_iterator bsi;\n@@ -1001,7 +1001,7 @@ get_initial_def_for_reduction (tree stmt, tree init_val, tree *scalar_def)\n {\n   stmt_vec_info stmt_vinfo = vinfo_for_stmt (stmt);\n   tree vectype = STMT_VINFO_VECTYPE (stmt_vinfo);\n-  int nunits = GET_MODE_NUNITS (TYPE_MODE (vectype));\n+  int nunits =  TYPE_VECTOR_SUBPARTS (vectype);\n   int nelements;\n   enum tree_code code = TREE_CODE (GIMPLE_STMT_OPERAND (stmt, 1));\n   tree type = TREE_TYPE (init_val);"}]}