{"sha": "aeed4133ae44ea4861779bfa96b22fcd8c951102", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWVlZDQxMzNhZTQ0ZWE0ODYxNzc5YmZhOTZiMjJmY2Q4Yzk1MTEwMg==", "commit": {"author": {"name": "Richard Sandiford", "email": "richard@codesourcery.com", "date": "2007-04-24T06:46:37Z"}, "committer": {"name": "Richard Sandiford", "email": "rsandifo@gcc.gnu.org", "date": "2007-04-24T06:46:37Z"}, "message": "optabs.c (set_conv_libfunc): Prefer libgcc2's __ffsMM2 functions over an external ffs function.\n\ngcc/\n\t* optabs.c (set_conv_libfunc): Prefer libgcc2's __ffsMM2 functions\n\tover an external ffs function.\n\nFrom-SVN: r124096", "tree": {"sha": "a629a926e2e9585780381bf17827c92805eac49d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a629a926e2e9585780381bf17827c92805eac49d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/aeed4133ae44ea4861779bfa96b22fcd8c951102", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/aeed4133ae44ea4861779bfa96b22fcd8c951102", "html_url": "https://github.com/Rust-GCC/gccrs/commit/aeed4133ae44ea4861779bfa96b22fcd8c951102", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/aeed4133ae44ea4861779bfa96b22fcd8c951102/comments", "author": null, "committer": null, "parents": [{"sha": "7f9844caf1ebd513d8720afa3ce857fada9e94c6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7f9844caf1ebd513d8720afa3ce857fada9e94c6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7f9844caf1ebd513d8720afa3ce857fada9e94c6"}], "stats": {"total": 15, "additions": 11, "deletions": 4}, "files": [{"sha": "b77b42da6c97417f3e0758c3c0e1a369a442d4b6", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aeed4133ae44ea4861779bfa96b22fcd8c951102/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aeed4133ae44ea4861779bfa96b22fcd8c951102/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=aeed4133ae44ea4861779bfa96b22fcd8c951102", "patch": "@@ -1,3 +1,8 @@\n+2007-04-24  Richard Sandiford  <richard@codesourcery.com>\n+\n+\t* optabs.c (set_conv_libfunc): Prefer libgcc2's __ffsMM2 functions\n+\tover an external ffs function.\n+\n 2007-04-24  Chao-ying Fu  <fu@mips.com>\n \t    Richard Sandiford  <richard@nildram.co.uk>\n "}, {"sha": "b63acccba50627605f1864b10fc8c294e77e681f", "filename": "gcc/optabs.c", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aeed4133ae44ea4861779bfa96b22fcd8c951102/gcc%2Foptabs.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aeed4133ae44ea4861779bfa96b22fcd8c951102/gcc%2Foptabs.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Foptabs.c?ref=aeed4133ae44ea4861779bfa96b22fcd8c951102", "patch": "@@ -5411,6 +5411,7 @@ void\n init_optabs (void)\n {\n   unsigned int i;\n+  enum machine_mode int_mode;\n \n   /* Start by initializing all tables to contain CODE_FOR_nothing.  */\n \n@@ -5620,6 +5621,11 @@ init_optabs (void)\n   /* Fill in the optabs with the insns we support.  */\n   init_all_optabs ();\n \n+  /* The ffs function operates on `int'.  Fall back on it if we do not\n+     have a libgcc2 function for that width.  */\n+  int_mode = mode_for_size (INT_TYPE_SIZE, MODE_INT, 0);\n+  ffs_optab->handlers[(int) int_mode].libfunc = init_one_libfunc (\"ffs\");\n+\n   /* Initialize the optabs with the names of the library functions.  */\n   init_integral_libfuncs (add_optab, \"add\", '3');\n   init_floating_libfuncs (add_optab, \"add\", '3');\n@@ -5731,10 +5737,6 @@ init_optabs (void)\n     abs_optab->handlers[TYPE_MODE (complex_double_type_node)].libfunc\n       = init_one_libfunc (\"cabs\");\n \n-  /* The ffs function operates on `int'.  */\n-  ffs_optab->handlers[(int) mode_for_size (INT_TYPE_SIZE, MODE_INT, 0)].libfunc\n-    = init_one_libfunc (\"ffs\");\n-\n   abort_libfunc = init_one_libfunc (\"abort\");\n   memcpy_libfunc = init_one_libfunc (\"memcpy\");\n   memmove_libfunc = init_one_libfunc (\"memmove\");"}]}