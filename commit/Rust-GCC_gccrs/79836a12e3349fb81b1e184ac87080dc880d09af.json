{"sha": "79836a12e3349fb81b1e184ac87080dc880d09af", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Nzk4MzZhMTJlMzM0OWZiODFiMWUxODRhYzg3MDgwZGM4ODBkMDlhZg==", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2013-02-20T09:03:18Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2013-02-20T09:03:18Z"}, "message": "tree-ssa-loop-ivopts.c (alloc_use_cost_map): Use bitmap_count_bits and ceil_log2.\n\n2013-02-20  Richard Biener  <rguenther@suse.de>\n\n\t* tree-ssa-loop-ivopts.c (alloc_use_cost_map): Use bitmap_count_bits\n\tand ceil_log2.\n\t(get_use_iv_cost): Terminate hashtable walk when coming across\n\tan empty entry.\n\nFrom-SVN: r196166", "tree": {"sha": "a254810adf6022c9e225c2fbfdb577cf13879091", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a254810adf6022c9e225c2fbfdb577cf13879091"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/79836a12e3349fb81b1e184ac87080dc880d09af", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/79836a12e3349fb81b1e184ac87080dc880d09af", "html_url": "https://github.com/Rust-GCC/gccrs/commit/79836a12e3349fb81b1e184ac87080dc880d09af", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/79836a12e3349fb81b1e184ac87080dc880d09af/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "30b07d033db90fb3722583c3210be1ab63679e3f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/30b07d033db90fb3722583c3210be1ab63679e3f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/30b07d033db90fb3722583c3210be1ab63679e3f"}], "stats": {"total": 25, "additions": 15, "deletions": 10}, "files": [{"sha": "2a92d350a42d19012d487c256f3d2ec9e6386860", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/79836a12e3349fb81b1e184ac87080dc880d09af/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/79836a12e3349fb81b1e184ac87080dc880d09af/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=79836a12e3349fb81b1e184ac87080dc880d09af", "patch": "@@ -1,9 +1,17 @@\n+2013-02-20  Richard Biener  <rguenther@suse.de>\n+\n+\t* tree-ssa-loop-ivopts.c (alloc_use_cost_map): Use bitmap_count_bits\n+\tand ceil_log2.\n+\t(get_use_iv_cost): Terminate hashtable walk when coming across\n+\tan empty entry.\n+\n 2013-02-20  Igor Zamyatin  <igor.zamyatin@intel.com>\n \n \t* config/i386/i386.c (initial_ix86_tune_features): Turn on fp\n \treassociation for avx2 targets.\n \n 2012-02-19  Edgar E. Iglesias <edgar.iglesias@gmail.com>\n+\n \t* config/microblaze/microblaze.c: microblaze_has_clz = 0\n \tAdd version check for v8.10.a to enable microblaze_has_clz\n \t* config/microblaze/microblaze.h: Add TARGET_HAS_CLZ as combined "}, {"sha": "2940bf100447874d98bab4fc8265ae8713ecc603", "filename": "gcc/tree-ssa-loop-ivopts.c", "status": "modified", "additions": 7, "deletions": 10, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/79836a12e3349fb81b1e184ac87080dc880d09af/gcc%2Ftree-ssa-loop-ivopts.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/79836a12e3349fb81b1e184ac87080dc880d09af/gcc%2Ftree-ssa-loop-ivopts.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-loop-ivopts.c?ref=79836a12e3349fb81b1e184ac87080dc880d09af", "patch": "@@ -2574,26 +2574,20 @@ record_important_candidates (struct ivopts_data *data)\n static void\n alloc_use_cost_map (struct ivopts_data *data)\n {\n-  unsigned i, size, s, j;\n+  unsigned i, size, s;\n \n   for (i = 0; i < n_iv_uses (data); i++)\n     {\n       struct iv_use *use = iv_use (data, i);\n-      bitmap_iterator bi;\n \n       if (data->consider_all_candidates)\n \tsize = n_iv_cands (data);\n       else\n \t{\n-\t  s = 0;\n-\t  EXECUTE_IF_SET_IN_BITMAP (use->related_cands, 0, j, bi)\n-\t    {\n-\t      s++;\n-\t    }\n+\t  s = bitmap_count_bits (use->related_cands);\n \n \t  /* Round up to the power of two, so that moduling by it is fast.  */\n-\t  for (size = 1; size < s; size <<= 1)\n-\t    continue;\n+\t  size = s ? (1 << ceil_log2 (s)) : 1;\n \t}\n \n       use->n_map_members = size;\n@@ -2731,10 +2725,13 @@ get_use_iv_cost (struct ivopts_data *data, struct iv_use *use,\n   for (i = s; i < use->n_map_members; i++)\n     if (use->cost_map[i].cand == cand)\n       return use->cost_map + i;\n-\n+    else if (use->cost_map[i].cand == NULL)\n+      return NULL;\n   for (i = 0; i < s; i++)\n     if (use->cost_map[i].cand == cand)\n       return use->cost_map + i;\n+    else if (use->cost_map[i].cand == NULL)\n+      return NULL;\n \n   return NULL;\n }"}]}