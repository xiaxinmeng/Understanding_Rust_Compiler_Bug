{"sha": "9b0f04e708f22d60c2093354798db28641e982a1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWIwZjA0ZTcwOGYyMmQ2MGMyMDkzMzU0Nzk4ZGIyODY0MWU5ODJhMQ==", "commit": {"author": {"name": "Andrey Belevantsev", "email": "abel@ispras.ru", "date": "2011-01-13T09:29:09Z"}, "committer": {"name": "Andrey Belevantsev", "email": "abel@gcc.gnu.org", "date": "2011-01-13T09:29:09Z"}, "message": "re PR rtl-optimization/45352 (ICE: in reset_sched_cycles_in_current_ebb, at sel-sched.c:7058)\n\n        PR rtl-optimization/45352\n        * sel-sched.c: Update copyright years.\n        (reset_sched_cycles_in_current_ebb): Also recheck the DFA state\n        in the advancing loop when we have issued issue_rate insns.\n\n\t* gcc.dg/pr45352-3.c: New.\n\nFrom-SVN: r168742", "tree": {"sha": "cb941e6d58e77747c98467338a3b6ee849918d99", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/cb941e6d58e77747c98467338a3b6ee849918d99"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9b0f04e708f22d60c2093354798db28641e982a1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9b0f04e708f22d60c2093354798db28641e982a1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9b0f04e708f22d60c2093354798db28641e982a1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9b0f04e708f22d60c2093354798db28641e982a1/comments", "author": {"login": "abonzo", "id": 20396542, "node_id": "MDQ6VXNlcjIwMzk2NTQy", "avatar_url": "https://avatars.githubusercontent.com/u/20396542?v=4", "gravatar_id": "", "url": "https://api.github.com/users/abonzo", "html_url": "https://github.com/abonzo", "followers_url": "https://api.github.com/users/abonzo/followers", "following_url": "https://api.github.com/users/abonzo/following{/other_user}", "gists_url": "https://api.github.com/users/abonzo/gists{/gist_id}", "starred_url": "https://api.github.com/users/abonzo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/abonzo/subscriptions", "organizations_url": "https://api.github.com/users/abonzo/orgs", "repos_url": "https://api.github.com/users/abonzo/repos", "events_url": "https://api.github.com/users/abonzo/events{/privacy}", "received_events_url": "https://api.github.com/users/abonzo/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "1ee3ea052a68c68016ddb19efa9c6173fecf9c80", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1ee3ea052a68c68016ddb19efa9c6173fecf9c80", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1ee3ea052a68c68016ddb19efa9c6173fecf9c80"}], "stats": {"total": 42, "additions": 36, "deletions": 6}, "files": [{"sha": "b22f65ebc26ebf5885ac0be816e5a359e4a26708", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9b0f04e708f22d60c2093354798db28641e982a1/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9b0f04e708f22d60c2093354798db28641e982a1/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=9b0f04e708f22d60c2093354798db28641e982a1", "patch": "@@ -1,3 +1,10 @@\n+2011-01-13  Andrey Belevantsev  <abel@ispras.ru>\n+\n+\tPR rtl-optimization/45352\n+\t* sel-sched.c: Update copyright years. \n+\t(reset_sched_cycles_in_current_ebb): Also recheck the DFA state\n+\tin the advancing loop when we have issued issue_rate insns. \n+\n 2011-01-12  Richard Henderson  <rth@redhat.com>\n \n \t* config/mn10300/mn10300.c (mn10300_md_asm_clobbers): New."}, {"sha": "d40885c95cf2731c474d1e816364c6cd5c341d10", "filename": "gcc/sel-sched.c", "status": "modified", "additions": 8, "deletions": 6, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9b0f04e708f22d60c2093354798db28641e982a1/gcc%2Fsel-sched.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9b0f04e708f22d60c2093354798db28641e982a1/gcc%2Fsel-sched.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fsel-sched.c?ref=9b0f04e708f22d60c2093354798db28641e982a1", "patch": "@@ -1,5 +1,6 @@\n /* Instruction scheduling pass.  Selective scheduler and pipeliner.\n-   Copyright (C) 2006, 2007, 2008, 2009, 2010 Free Software Foundation, Inc.\n+   Copyright (C) 2006, 2007, 2008, 2009, 2010, 2011\n+   Free Software Foundation, Inc.\n \n This file is part of GCC.\n \n@@ -6988,7 +6989,7 @@ reset_sched_cycles_in_current_ebb (void)\n     {\n       int cost, haifa_cost;\n       int sort_p;\n-      bool asm_p, real_insn, after_stall;\n+      bool asm_p, real_insn, after_stall, all_issued;\n       int clock;\n \n       if (!INSN_P (insn))\n@@ -7024,8 +7025,8 @@ reset_sched_cycles_in_current_ebb (void)\n           haifa_cost = cost;\n           after_stall = 1;\n         }\n-      if (haifa_cost == 0\n-\t  && issued_insns == issue_rate)\n+      all_issued = issued_insns == issue_rate;\n+      if (haifa_cost == 0 && all_issued)\n \thaifa_cost = 1;\n       if (haifa_cost > 0)\n \t{\n@@ -7053,11 +7054,12 @@ reset_sched_cycles_in_current_ebb (void)\n                 break;\n \n               /* When the data dependency stall is longer than the DFA stall,\n-                 it could be that after the longer stall the insn will again\n+                 and when we have issued exactly issue_rate insns and stalled,\n+                 it could be that after this longer stall the insn will again\n                  become unavailable  to the DFA restrictions.  Looks strange\n                  but happens e.g. on x86-64.  So recheck DFA on the last\n                  iteration.  */\n-              if (after_stall\n+              if ((after_stall || all_issued)\n                   && real_insn\n                   && haifa_cost == 0)\n                 haifa_cost = estimate_insn_cost (insn, curr_state);"}, {"sha": "0e0721c883bb9ffb2fb0f27cfcb0a8ae21e59f27", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9b0f04e708f22d60c2093354798db28641e982a1/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9b0f04e708f22d60c2093354798db28641e982a1/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=9b0f04e708f22d60c2093354798db28641e982a1", "patch": "@@ -1,3 +1,8 @@\n+2011-01-13  Andrey Belevantsev  <abel@ispras.ru>\n+\n+\tPR rtl-optimization/45352\n+\t* gcc.dg/pr45352-3.c: New.\n+\n 2011-01-12  Rodrigo Rivas Costa <rodrigorivascosta@gmail.com>\n \n \t* g++.dg/cpp0x/range-for4.C: Delete useless include and duplicated"}, {"sha": "ce7879f860a43bdcee35d7725c43d4683bc01002", "filename": "gcc/testsuite/gcc.dg/pr45352-3.c", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9b0f04e708f22d60c2093354798db28641e982a1/gcc%2Ftestsuite%2Fgcc.dg%2Fpr45352-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9b0f04e708f22d60c2093354798db28641e982a1/gcc%2Ftestsuite%2Fgcc.dg%2Fpr45352-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr45352-3.c?ref=9b0f04e708f22d60c2093354798db28641e982a1", "patch": "@@ -0,0 +1,16 @@\n+/* { dg-do compile { target powerpc*-*-* ia64-*-* x86_64-*-* } } */\n+/* { dg-options \"-O -fprofile-generate -fgcse -fno-gcse-lm -fgcse-sm -fno-ivopts -fno-tree-loop-im -ftree-pre -funroll-loops -fno-web -fschedule-insns2 -fselective-scheduling2 -fsel-sched-pipelining\" } */\n+\n+extern volatile float f[];\n+\n+void foo (void)\n+{\n+  int i;\n+  for (i = 0; i < 100; i++)\n+    f[i] = 0;\n+  for (i = 0; i < 100; i++)\n+    f[i] = 0;\n+  for (i = 0; i < 100; i++)\n+    if (f[i])\n+      __builtin_abort ();\n+}"}]}