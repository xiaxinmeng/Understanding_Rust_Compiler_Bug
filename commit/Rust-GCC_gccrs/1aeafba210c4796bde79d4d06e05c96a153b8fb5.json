{"sha": "1aeafba210c4796bde79d4d06e05c96a153b8fb5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWFlYWZiYTIxMGM0Nzk2YmRlNzlkNGQwNmUwNWM5NmExNTNiOGZiNQ==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@redhat.com", "date": "2017-08-29T19:39:18Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "2017-08-29T19:39:18Z"}, "message": "Fix default argument conversion failure and SFINAE.\n\n\t* call.c (build_over_call): Check convert_default_arg result for\n\terror_mark_node.\n\t* parser.c (cp_parser_late_parsing_default_args): Remember\n\terror_mark_node.\n\nFrom-SVN: r251421", "tree": {"sha": "8d6bd959531218d3f5f3c7303607ecfb61291bde", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8d6bd959531218d3f5f3c7303607ecfb61291bde"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1aeafba210c4796bde79d4d06e05c96a153b8fb5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1aeafba210c4796bde79d4d06e05c96a153b8fb5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1aeafba210c4796bde79d4d06e05c96a153b8fb5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1aeafba210c4796bde79d4d06e05c96a153b8fb5/comments", "author": {"login": "jicama", "id": 266146, "node_id": "MDQ6VXNlcjI2NjE0Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/266146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jicama", "html_url": "https://github.com/jicama", "followers_url": "https://api.github.com/users/jicama/followers", "following_url": "https://api.github.com/users/jicama/following{/other_user}", "gists_url": "https://api.github.com/users/jicama/gists{/gist_id}", "starred_url": "https://api.github.com/users/jicama/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jicama/subscriptions", "organizations_url": "https://api.github.com/users/jicama/orgs", "repos_url": "https://api.github.com/users/jicama/repos", "events_url": "https://api.github.com/users/jicama/events{/privacy}", "received_events_url": "https://api.github.com/users/jicama/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "a2aa807ef9537ab75e81dd0470e90f5a54d75031", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a2aa807ef9537ab75e81dd0470e90f5a54d75031", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a2aa807ef9537ab75e81dd0470e90f5a54d75031"}], "stats": {"total": 38, "additions": 25, "deletions": 13}, "files": [{"sha": "fc244a138037d685ac80691f7a46fca0dfc55668", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1aeafba210c4796bde79d4d06e05c96a153b8fb5/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1aeafba210c4796bde79d4d06e05c96a153b8fb5/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=1aeafba210c4796bde79d4d06e05c96a153b8fb5", "patch": "@@ -1,3 +1,11 @@\n+2017-08-29  Jason Merrill  <jason@redhat.com>\n+\n+\tFix default argument conversion failure and SFINAE.\n+\t* call.c (build_over_call): Check convert_default_arg result for\n+\terror_mark_node.\n+\t* parser.c (cp_parser_late_parsing_default_args): Remember\n+\terror_mark_node.\n+\n 2017-08-28  Nathan Sidwell  <nathan@acm.org>\n \n \t* cp-tree.h (lang_type): Replace sorted_fields vector with"}, {"sha": "6405be2d4803df586f98e85ef1a4b3404a459d63", "filename": "gcc/cp/call.c", "status": "modified", "additions": 7, "deletions": 4, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1aeafba210c4796bde79d4d06e05c96a153b8fb5/gcc%2Fcp%2Fcall.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1aeafba210c4796bde79d4d06e05c96a153b8fb5/gcc%2Fcp%2Fcall.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fcall.c?ref=1aeafba210c4796bde79d4d06e05c96a153b8fb5", "patch": "@@ -7892,10 +7892,13 @@ build_over_call (struct z_candidate *cand, int flags, tsubst_flags_t complain)\n     {\n       if (TREE_VALUE (parm) == error_mark_node)\n \treturn error_mark_node;\n-      argarray[j++] = convert_default_arg (TREE_VALUE (parm),\n-\t\t\t\t\t   TREE_PURPOSE (parm),\n-\t\t\t\t\t   fn, i - is_method,\n-\t\t\t\t\t   complain);\n+      val = convert_default_arg (TREE_VALUE (parm),\n+\t\t\t\t TREE_PURPOSE (parm),\n+\t\t\t\t fn, i - is_method,\n+\t\t\t\t complain);\n+      if (val == error_mark_node)\n+        return error_mark_node;\n+      argarray[j++] = val;\n     }\n \n   /* Ellipsis */"}, {"sha": "9b7c2c0dd6e98cd223e8956e51e07d15a37542b3", "filename": "gcc/cp/parser.c", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1aeafba210c4796bde79d4d06e05c96a153b8fb5/gcc%2Fcp%2Fparser.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1aeafba210c4796bde79d4d06e05c96a153b8fb5/gcc%2Fcp%2Fparser.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fparser.c?ref=1aeafba210c4796bde79d4d06e05c96a153b8fb5", "patch": "@@ -27645,11 +27645,6 @@ cp_parser_late_parsing_default_args (cp_parser *parser, tree fn)\n \t= cp_parser_late_parse_one_default_arg (parser, parmdecl,\n \t\t\t\t\t\tdefault_arg,\n \t\t\t\t\t\tTREE_VALUE (parm));\n-      if (parsed_arg == error_mark_node)\n-\t{\n-\t  continue;\n-\t}\n-\n       TREE_PURPOSE (parm) = parsed_arg;\n \n       /* Update any instantiations we've already created.  */"}, {"sha": "b80ac28e72558fdc704c6f542a0ed686d46aa2e2", "filename": "gcc/testsuite/g++.dg/ext/is_constructible1.C", "status": "added", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1aeafba210c4796bde79d4d06e05c96a153b8fb5/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fis_constructible1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1aeafba210c4796bde79d4d06e05c96a153b8fb5/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fis_constructible1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fis_constructible1.C?ref=1aeafba210c4796bde79d4d06e05c96a153b8fb5", "patch": "@@ -0,0 +1,6 @@\n+// { dg-do compile { target c++11 } }\n+// { dg-options \"\" }\n+\n+template<class T> struct Foo { Foo(T = nullptr) {} };\n+\n+static_assert (!__is_constructible(Foo<int>));"}, {"sha": "30b651326aa34787f86e6db914a6a328b51bed26", "filename": "gcc/testsuite/g++.dg/other/new1.C", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1aeafba210c4796bde79d4d06e05c96a153b8fb5/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fnew1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1aeafba210c4796bde79d4d06e05c96a153b8fb5/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fnew1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fnew1.C?ref=1aeafba210c4796bde79d4d06e05c96a153b8fb5", "patch": "@@ -10,5 +10,5 @@ struct A\n \n void foo()\n {\n-  new A;\t// { dg-error \"default argument\" }\n+  new A;\n }"}, {"sha": "537cdb78ef1965eca0bfef0fe9a5023aab4b7f34", "filename": "gcc/testsuite/g++.dg/parse/crash40.C", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1aeafba210c4796bde79d4d06e05c96a153b8fb5/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Fcrash40.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1aeafba210c4796bde79d4d06e05c96a153b8fb5/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Fcrash40.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Fcrash40.C?ref=1aeafba210c4796bde79d4d06e05c96a153b8fb5", "patch": "@@ -37,6 +37,6 @@ void bar()\n   int i;\n   i.C::foo<0>(); /* { dg-error \"which is of non-class type\" } */\n \n-  S<false> s; /* { dg-error \"default argument\" } */\n+  S<false> s;\n   SS<false> ss;\n }"}, {"sha": "df805813897c74cd8ac52c74bb51c293fb41c4f7", "filename": "gcc/testsuite/g++.dg/parse/defarg12.C", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1aeafba210c4796bde79d4d06e05c96a153b8fb5/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Fdefarg12.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1aeafba210c4796bde79d4d06e05c96a153b8fb5/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Fdefarg12.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Fdefarg12.C?ref=1aeafba210c4796bde79d4d06e05c96a153b8fb5", "patch": "@@ -9,5 +9,5 @@ struct A\n \n void foo()\n {\n-  A().i; /* { dg-error \"default argument\" } */\n+  A().i;\n }"}, {"sha": "ad18a1b3f9af7cbbbc2d2966b2bce2360595a569", "filename": "gcc/testsuite/g++.dg/template/error15.C", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1aeafba210c4796bde79d4d06e05c96a153b8fb5/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Ferror15.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1aeafba210c4796bde79d4d06e05c96a153b8fb5/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Ferror15.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Ferror15.C?ref=1aeafba210c4796bde79d4d06e05c96a153b8fb5", "patch": "@@ -18,7 +18,7 @@ protected:\n \n template <class T>\n void B<T>::g(void) {\n-  f(); // { dg-error \"default argument\" }\n+  f();\n }\n \n template class B<long>;"}]}