{"sha": "9ee465524042b1244ac20b3c1083d818c32d9bfc", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWVlNDY1NTI0MDQyYjEyNDRhYzIwYjNjMTA4M2Q4MThjMzJkOWJmYw==", "commit": {"author": {"name": "Michael Ploujnikov", "email": "michael.ploujnikov@oracle.com", "date": "2018-12-14T00:19:08Z"}, "committer": {"name": "Jeff Law", "email": "law@gcc.gnu.org", "date": "2018-12-14T00:19:08Z"}, "message": "ipa-cp.c (print_all_lattices): Skip cp clones.\n\n\t* ipa-cp.c (print_all_lattices): Skip cp clones.\n\n\t* gcc.dg/lto/pr88297_0.c: New test.\n\t* gcc.dg/lto/pr88297_1.c: New test.\n\nFrom-SVN: r267118", "tree": {"sha": "0265609b39b4109a2aab16c11d59467d3e14c094", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0265609b39b4109a2aab16c11d59467d3e14c094"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9ee465524042b1244ac20b3c1083d818c32d9bfc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9ee465524042b1244ac20b3c1083d818c32d9bfc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9ee465524042b1244ac20b3c1083d818c32d9bfc", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9ee465524042b1244ac20b3c1083d818c32d9bfc/comments", "author": {"login": "plouj-oracle", "id": 7086511, "node_id": "MDQ6VXNlcjcwODY1MTE=", "avatar_url": "https://avatars.githubusercontent.com/u/7086511?v=4", "gravatar_id": "", "url": "https://api.github.com/users/plouj-oracle", "html_url": "https://github.com/plouj-oracle", "followers_url": "https://api.github.com/users/plouj-oracle/followers", "following_url": "https://api.github.com/users/plouj-oracle/following{/other_user}", "gists_url": "https://api.github.com/users/plouj-oracle/gists{/gist_id}", "starred_url": "https://api.github.com/users/plouj-oracle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/plouj-oracle/subscriptions", "organizations_url": "https://api.github.com/users/plouj-oracle/orgs", "repos_url": "https://api.github.com/users/plouj-oracle/repos", "events_url": "https://api.github.com/users/plouj-oracle/events{/privacy}", "received_events_url": "https://api.github.com/users/plouj-oracle/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "e8e50c1bd77d781acf09ca9868da60b79ad70d33", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e8e50c1bd77d781acf09ca9868da60b79ad70d33", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e8e50c1bd77d781acf09ca9868da60b79ad70d33"}], "stats": {"total": 92, "additions": 92, "deletions": 0}, "files": [{"sha": "e3baaa6026b48c98cd1341b7c6e23998db5a23dc", "filename": "gcc/ChangeLog", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9ee465524042b1244ac20b3c1083d818c32d9bfc/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9ee465524042b1244ac20b3c1083d818c32d9bfc/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=9ee465524042b1244ac20b3c1083d818c32d9bfc", "patch": "@@ -1,5 +1,7 @@\n 2018-12-13  Michael Ploujnikov  <michael.ploujnikov@oracle.com>\n \n+\t* ipa-cp.c (print_all_lattices): Skip cp clones.\n+\n \t* ipa-cp.c: Fix various comment typos.\n \n 2018-12-13  Jakub Jelinek  <jakub@redhat.com>"}, {"sha": "5758915361487049ba10f1a54b66da9bf8aa9fb8", "filename": "gcc/ipa-cp.c", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9ee465524042b1244ac20b3c1083d818c32d9bfc/gcc%2Fipa-cp.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9ee465524042b1244ac20b3c1083d818c32d9bfc/gcc%2Fipa-cp.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-cp.c?ref=9ee465524042b1244ac20b3c1083d818c32d9bfc", "patch": "@@ -542,6 +542,9 @@ print_all_lattices (FILE * f, bool dump_sources, bool dump_benefits)\n       struct ipa_node_params *info;\n \n       info = IPA_NODE_REF (node);\n+      /* Skip constprop clones since we don't make lattices for them.  */\n+      if (info->ipcp_orig_node)\n+\tcontinue;\n       fprintf (f, \"  Node: %s:\\n\", node->dump_name ());\n       count = ipa_get_param_count (info);\n       for (i = 0; i < count; i++)"}, {"sha": "8128ea99969adbf6399a63ab933d9c95468957ab", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9ee465524042b1244ac20b3c1083d818c32d9bfc/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9ee465524042b1244ac20b3c1083d818c32d9bfc/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=9ee465524042b1244ac20b3c1083d818c32d9bfc", "patch": "@@ -1,3 +1,8 @@\n+2018-12-13  Michael Ploujnikov  <michael.ploujnikov@oracle.com>\n+\n+\t* gcc.dg/lto/pr88297_0.c: New test.\n+\t* gcc.dg/lto/pr88297_1.c: New test.\n+\n 2018-12-13  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR tree-optimization/88444"}, {"sha": "1a144491603b80ff34cd9d2cd5bc307433b9d360", "filename": "gcc/testsuite/gcc.dg/lto/pr88297_0.c", "status": "added", "additions": 57, "deletions": 0, "changes": 57, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9ee465524042b1244ac20b3c1083d818c32d9bfc/gcc%2Ftestsuite%2Fgcc.dg%2Flto%2Fpr88297_0.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9ee465524042b1244ac20b3c1083d818c32d9bfc/gcc%2Ftestsuite%2Fgcc.dg%2Flto%2Fpr88297_0.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Flto%2Fpr88297_0.c?ref=9ee465524042b1244ac20b3c1083d818c32d9bfc", "patch": "@@ -0,0 +1,57 @@\n+/* { dg-require-effective-target lto } */\n+/* { dg-lto-options { { -flto -O3 -fipa-cp -fipa-cp-clone } } } */\n+/* { dg-lto-do run } */\n+\n+/* In order to trigger IPA-CP cloning we have to:\n+\n+  1. Put the calls in main into a loop; otherwise everything is\n+  cold and we would not clone.\n+\n+  2. Make different foos and bars actually semantically different;\n+  otherwise IPA-ICF unified them (as it should).\n+\n+*/\n+\n+volatile int g;\n+\n+void __attribute__ ((noipa))\n+use (int v)\n+{\n+  g = v;\n+}\n+\n+static int __attribute__ ((noinline))\n+foo (int arg)\n+{\n+  return 7 * arg;\n+}\n+\n+static int __attribute__ ((noinline))\n+bar (int arg)\n+{\n+  return arg * arg;\n+}\n+\n+extern int __attribute__ ((noinline))\n+entry2 (void);\n+\n+int  __attribute__ ((noipa))\n+get_opaque_number (void)\n+{\n+  return 1;\n+}\n+\n+int main (void)\n+{\n+  int i;\n+  for (i = 0; i < get_opaque_number (); i++)\n+    {\n+      use (bar (3));\n+      use (bar (4));\n+      use (foo (5));\n+      use (foo (6));\n+\n+      entry2 ();\n+    }\n+  return 0;\n+}"}, {"sha": "65c5321cde593b0b343360c8a836f594721621fb", "filename": "gcc/testsuite/gcc.dg/lto/pr88297_1.c", "status": "added", "additions": 25, "deletions": 0, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9ee465524042b1244ac20b3c1083d818c32d9bfc/gcc%2Ftestsuite%2Fgcc.dg%2Flto%2Fpr88297_1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9ee465524042b1244ac20b3c1083d818c32d9bfc/gcc%2Ftestsuite%2Fgcc.dg%2Flto%2Fpr88297_1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Flto%2Fpr88297_1.c?ref=9ee465524042b1244ac20b3c1083d818c32d9bfc", "patch": "@@ -0,0 +1,25 @@\n+extern void __attribute__ ((noipa))\n+use (int v);\n+\n+\n+static int __attribute__ ((noinline))\n+foo (int arg)\n+{\n+  return 8 * arg;\n+}\n+\n+static int __attribute__ ((noinline))\n+bar (int arg)\n+{\n+  return arg * arg + 3;\n+}\n+\n+int __attribute__ ((noinline))\n+entry2 (void)\n+{\n+  use (bar (3));\n+  use (bar (4));\n+  use (foo (5));\n+  use (foo (6));\n+  return 0;\n+}"}]}