{"sha": "050fb2092b4e8fc92243112565f7230e672e4399", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDUwZmIyMDkyYjRlOGZjOTIyNDMxMTI1NjVmNzIzMGU2NzJlNDM5OQ==", "commit": {"author": {"name": "Jan Hubicka", "email": "hubicka@ucw.cz", "date": "2016-05-31T23:33:08Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2016-05-31T23:33:08Z"}, "message": "predict-lop-exit-1.C: Update template for new predictor name.\n\n\n\t* g++.d/predict-lop-exit-1.C: Update template for new predictor name.\n\t* g++.d/predict-lop-exit-2.C: Update template for new predictor name.\n\t* g++.d/predict-lop-exit-2.C: Update template for new predictor name.\n\n\t* predict.def (PRED_LOOP_EXTRA_EXIT): Define.\n\t* predict.c (predict_iv_comparison): Also check PRED_LOOP_EXTRA_EXIT.\n\t(predict_extra_loop_exits): Use PRED_LOOP_EXTRA_EXIT instead of\n\tPRED_LOOP_EXIT.\n\nFrom-SVN: r236968", "tree": {"sha": "9897cd26c87d0ce3445534bb6224cf4f786ec88c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9897cd26c87d0ce3445534bb6224cf4f786ec88c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/050fb2092b4e8fc92243112565f7230e672e4399", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/050fb2092b4e8fc92243112565f7230e672e4399", "html_url": "https://github.com/Rust-GCC/gccrs/commit/050fb2092b4e8fc92243112565f7230e672e4399", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/050fb2092b4e8fc92243112565f7230e672e4399/comments", "author": null, "committer": null, "parents": [{"sha": "226e9d1aabee7a3524fd6f62dc1390ce7881b7a5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/226e9d1aabee7a3524fd6f62dc1390ce7881b7a5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/226e9d1aabee7a3524fd6f62dc1390ce7881b7a5"}], "stats": {"total": 30, "additions": 26, "deletions": 4}, "files": [{"sha": "45f31d4882c5f05d67e6536c30198086b369e219", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/050fb2092b4e8fc92243112565f7230e672e4399/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/050fb2092b4e8fc92243112565f7230e672e4399/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=050fb2092b4e8fc92243112565f7230e672e4399", "patch": "@@ -1,3 +1,10 @@\n+2016-05-31  Jan Hubicka  <hubicka@ucw.cz>\n+\n+\t* predict.def (PRED_LOOP_EXTRA_EXIT): Define.\n+\t* predict.c (predict_iv_comparison): Also check PRED_LOOP_EXTRA_EXIT.\n+\t(predict_extra_loop_exits): Use PRED_LOOP_EXTRA_EXIT instead of\n+\tPRED_LOOP_EXIT.\n+\n 2016-05-31  Jan Hubicka  <hubicka@ucw.cz>\n \n \t* doc/invoke.texi (-frename-registers): Drop -fpeel-loops from list"}, {"sha": "e9dda20a0f7b4e36e30524307bf2fbc749e15acd", "filename": "gcc/predict.c", "status": "modified", "additions": 5, "deletions": 4, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/050fb2092b4e8fc92243112565f7230e672e4399/gcc%2Fpredict.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/050fb2092b4e8fc92243112565f7230e672e4399/gcc%2Fpredict.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fpredict.c?ref=050fb2092b4e8fc92243112565f7230e672e4399", "patch": "@@ -1245,7 +1245,8 @@ predict_iv_comparison (struct loop *loop, basic_block bb,\n \n   if (predicted_by_p (bb, PRED_LOOP_ITERATIONS_GUESSED)\n       || predicted_by_p (bb, PRED_LOOP_ITERATIONS)\n-      || predicted_by_p (bb, PRED_LOOP_EXIT))\n+      || predicted_by_p (bb, PRED_LOOP_EXIT)\n+      || predicted_by_p (bb, PRED_LOOP_EXTRA_EXIT))\n     return;\n \n   stmt = last_stmt (bb);\n@@ -1418,7 +1419,7 @@ predict_iv_comparison (struct loop *loop, basic_block bb,\n    The edge BB7->BB8 is loop exit because BB8 is outside of the loop.\n    From the dataflow, we can infer that BB4->BB6 and BB5->BB6 are also loop\n    exits. This function takes BB7->BB8 as input, and finds out the extra loop\n-   exits to predict them using PRED_LOOP_EXIT.  */\n+   exits to predict them using PRED_LOOP_EXTRA_EXIT.  */\n \n static void\n predict_extra_loop_exits (edge exit_edge)\n@@ -1474,12 +1475,12 @@ predict_extra_loop_exits (edge exit_edge)\n \tcontinue;\n       if (EDGE_COUNT (e->src->succs) != 1)\n \t{\n-\t  predict_paths_leading_to_edge (e, PRED_LOOP_EXIT, NOT_TAKEN);\n+\t  predict_paths_leading_to_edge (e, PRED_LOOP_EXTRA_EXIT, NOT_TAKEN);\n \t  continue;\n \t}\n \n       FOR_EACH_EDGE (e1, ei, e->src->preds)\n-\tpredict_paths_leading_to_edge (e1, PRED_LOOP_EXIT, NOT_TAKEN);\n+\tpredict_paths_leading_to_edge (e1, PRED_LOOP_EXTRA_EXIT, NOT_TAKEN);\n     }\n }\n "}, {"sha": "b83ec601da928a12288f9e0608d25a3b25d43e4f", "filename": "gcc/predict.def", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/050fb2092b4e8fc92243112565f7230e672e4399/gcc%2Fpredict.def", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/050fb2092b4e8fc92243112565f7230e672e4399/gcc%2Fpredict.def", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fpredict.def?ref=050fb2092b4e8fc92243112565f7230e672e4399", "patch": "@@ -92,6 +92,11 @@ DEF_PREDICTOR (PRED_LOOP_BRANCH, \"loop branch\", HITRATE (86),\n DEF_PREDICTOR (PRED_LOOP_EXIT, \"loop exit\", HITRATE (91),\n \t       PRED_FLAG_FIRST_MATCH)\n \n+/* Edge causing loop to terminate by computing value used by later conditional.\n+   */\n+DEF_PREDICTOR (PRED_LOOP_EXTRA_EXIT, \"extra loop exit\", HITRATE (91),\n+\t       PRED_FLAG_FIRST_MATCH)\n+\n /* Pointers are usually not NULL.  */\n DEF_PREDICTOR (PRED_POINTER, \"pointer\", HITRATE (85), 0)\n DEF_PREDICTOR (PRED_TREE_POINTER, \"pointer (on trees)\", HITRATE (85), 0)"}, {"sha": "df648204b599bddba508a6bb81bf844ece975d1c", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/050fb2092b4e8fc92243112565f7230e672e4399/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/050fb2092b4e8fc92243112565f7230e672e4399/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=050fb2092b4e8fc92243112565f7230e672e4399", "patch": "@@ -1,3 +1,9 @@\n+2016-05-31  Jan Hubicka  <hubicka@ucw.cz>\n+\n+\t* g++.d/predict-lop-exit-1.C: Update template for new predictor name.\n+\t* g++.d/predict-lop-exit-2.C: Update template for new predictor name.\n+\t* g++.d/predict-lop-exit-2.C: Update template for new predictor name.\n+\n 2016-05-31  Paolo Carlini  <paolo.carlini@oracle.com>\n \n \tPR c++/71248"}, {"sha": "357397f512b6840476533039cff50227f4a8b315", "filename": "gcc/testsuite/g++.dg/predict-loop-exit-1.C", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/050fb2092b4e8fc92243112565f7230e672e4399/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fpredict-loop-exit-1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/050fb2092b4e8fc92243112565f7230e672e4399/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fpredict-loop-exit-1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fpredict-loop-exit-1.C?ref=050fb2092b4e8fc92243112565f7230e672e4399", "patch": "@@ -9,4 +9,5 @@ void test() {\n   return;\n }\n \n+/* { dg-final { scan-tree-dump-times \"extra loop exit heuristics:\" 2 \"profile_estimate\"} } */\n /* { dg-final { scan-tree-dump-times \"loop exit heuristics:\" 3 \"profile_estimate\"} } */"}, {"sha": "172fab120c8c8f9f15b92016a03a964e93efe3e5", "filename": "gcc/testsuite/g++.dg/predict-loop-exit-2.C", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/050fb2092b4e8fc92243112565f7230e672e4399/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fpredict-loop-exit-2.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/050fb2092b4e8fc92243112565f7230e672e4399/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fpredict-loop-exit-2.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fpredict-loop-exit-2.C?ref=050fb2092b4e8fc92243112565f7230e672e4399", "patch": "@@ -9,4 +9,5 @@ void test() {\n   return;\n }\n \n+/* { dg-final { scan-tree-dump-times \"extra loop exit heuristics:\" 1 \"profile_estimate\"} } */\n /* { dg-final { scan-tree-dump-times \"loop exit heuristics:\" 2 \"profile_estimate\"} } */"}, {"sha": "e6ceec80159c1563dfa7e23df5ae9f7809ea4934", "filename": "gcc/testsuite/g++.dg/predict-loop-exit-3.C", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/050fb2092b4e8fc92243112565f7230e672e4399/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fpredict-loop-exit-3.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/050fb2092b4e8fc92243112565f7230e672e4399/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fpredict-loop-exit-3.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fpredict-loop-exit-3.C?ref=050fb2092b4e8fc92243112565f7230e672e4399", "patch": "@@ -9,4 +9,5 @@ void test() {\n   return;\n }\n \n+/* { dg-final { scan-tree-dump-times \"extra loop exit heuristics:\" 2 \"profile_estimate\"} } */\n /* { dg-final { scan-tree-dump-times \"loop exit heuristics:\" 3 \"profile_estimate\"} } */"}]}