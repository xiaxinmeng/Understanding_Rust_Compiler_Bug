{"sha": "345364cf7fa2a675d954ab4982bec6d664ee96e8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzQ1MzY0Y2Y3ZmEyYTY3NWQ5NTRhYjQ5ODJiZWM2ZDY2NGVlOTZlOA==", "commit": {"author": {"name": "Marek Polacek", "email": "polacek@redhat.com", "date": "2019-01-14T20:09:10Z"}, "committer": {"name": "Marek Polacek", "email": "mpolacek@gcc.gnu.org", "date": "2019-01-14T20:09:10Z"}, "message": "PR c++/88830 - ICE with abstract class.\n\n\t* decl2.c (maybe_emit_vtables): Check CLASSTYPE_LAZY_DESTRUCTOR.\n\tFix formatting.\n\n\t* g++.dg/other/abstract7.C: New test.\n\nFrom-SVN: r267924", "tree": {"sha": "8ad3894565479b8bf2f311a0e079fc53238e22e7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8ad3894565479b8bf2f311a0e079fc53238e22e7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/345364cf7fa2a675d954ab4982bec6d664ee96e8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/345364cf7fa2a675d954ab4982bec6d664ee96e8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/345364cf7fa2a675d954ab4982bec6d664ee96e8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/345364cf7fa2a675d954ab4982bec6d664ee96e8/comments", "author": {"login": "mpolacek", "id": 10496300, "node_id": "MDQ6VXNlcjEwNDk2MzAw", "avatar_url": "https://avatars.githubusercontent.com/u/10496300?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mpolacek", "html_url": "https://github.com/mpolacek", "followers_url": "https://api.github.com/users/mpolacek/followers", "following_url": "https://api.github.com/users/mpolacek/following{/other_user}", "gists_url": "https://api.github.com/users/mpolacek/gists{/gist_id}", "starred_url": "https://api.github.com/users/mpolacek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mpolacek/subscriptions", "organizations_url": "https://api.github.com/users/mpolacek/orgs", "repos_url": "https://api.github.com/users/mpolacek/repos", "events_url": "https://api.github.com/users/mpolacek/events{/privacy}", "received_events_url": "https://api.github.com/users/mpolacek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "2d91f79dc990f81dcea89a5087cad566238b2456", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2d91f79dc990f81dcea89a5087cad566238b2456", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2d91f79dc990f81dcea89a5087cad566238b2456"}], "stats": {"total": 30, "additions": 28, "deletions": 2}, "files": [{"sha": "3c1a02f025e2521282d775bbd685bccc03aa2d27", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/345364cf7fa2a675d954ab4982bec6d664ee96e8/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/345364cf7fa2a675d954ab4982bec6d664ee96e8/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=345364cf7fa2a675d954ab4982bec6d664ee96e8", "patch": "@@ -1,3 +1,9 @@\n+2019-01-14  Marek Polacek  <polacek@redhat.com>\n+\n+\tPR c++/88830 - ICE with abstract class.\n+\t* decl2.c (maybe_emit_vtables): Check CLASSTYPE_LAZY_DESTRUCTOR.\n+\tFix formatting.\n+\n 2019-01-14  Tom Honermann  <tom@honermann.net>\n \n \tImplement P0482R5, char8_t: A type for UTF-8 characters and strings"}, {"sha": "0869fd3082472c64205545cbf9fb76a9f5e8eaf6", "filename": "gcc/cp/decl2.c", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/345364cf7fa2a675d954ab4982bec6d664ee96e8/gcc%2Fcp%2Fdecl2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/345364cf7fa2a675d954ab4982bec6d664ee96e8/gcc%2Fcp%2Fdecl2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl2.c?ref=345364cf7fa2a675d954ab4982bec6d664ee96e8", "patch": "@@ -2229,8 +2229,9 @@ maybe_emit_vtables (tree ctype)\n      never get generated.  */\n   if (CLASSTYPE_PURE_VIRTUALS (ctype)\n       && TYPE_HAS_NONTRIVIAL_DESTRUCTOR (ctype)\n-      && DECL_DEFAULTED_IN_CLASS_P(CLASSTYPE_DESTRUCTOR(ctype)))\n-    note_vague_linkage_fn (CLASSTYPE_DESTRUCTOR(ctype));\n+      && !CLASSTYPE_LAZY_DESTRUCTOR (ctype)\n+      && DECL_DEFAULTED_IN_CLASS_P (CLASSTYPE_DESTRUCTOR (ctype)))\n+    note_vague_linkage_fn (CLASSTYPE_DESTRUCTOR (ctype));\n \n   /* Since we're writing out the vtable here, also write the debug\n      info.  */"}, {"sha": "d207a5193729dff8d09d8405e1fd4e2698512cd7", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/345364cf7fa2a675d954ab4982bec6d664ee96e8/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/345364cf7fa2a675d954ab4982bec6d664ee96e8/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=345364cf7fa2a675d954ab4982bec6d664ee96e8", "patch": "@@ -1,3 +1,8 @@\n+2019-01-14  Marek Polacek  <polacek@redhat.com>\n+\n+\tPR c++/88830 - ICE with abstract class.\n+\t* g++.dg/other/abstract7.C: New test.\n+\n 2019-01-14  Martin Sebor  <msebor@redhat.com>\n \n \tPR target/88638"}, {"sha": "95781602c955cecff1d08ac8f33b015b815140af", "filename": "gcc/testsuite/g++.dg/other/abstract7.C", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/345364cf7fa2a675d954ab4982bec6d664ee96e8/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fabstract7.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/345364cf7fa2a675d954ab4982bec6d664ee96e8/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fabstract7.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fabstract7.C?ref=345364cf7fa2a675d954ab4982bec6d664ee96e8", "patch": "@@ -0,0 +1,14 @@\n+// PR c++/88830\n+\n+struct a {\n+  ~a();\n+};\n+class b {\n+  virtual void c(int &);\n+};\n+class C : b {\n+  void c(int &);\n+  virtual int d() = 0;\n+  a e;\n+};\n+void C::c(int &) {}"}]}