{"sha": "5f34ed87f7203307efbcfc802c812b7c1c0b947d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NWYzNGVkODdmNzIwMzMwN2VmYmNmYzgwMmM4MTJiN2MxYzBiOTQ3ZA==", "commit": {"author": {"name": "Benjamin Kosnik", "email": "bkoz@redhat.com", "date": "2007-02-14T11:07:17Z"}, "committer": {"name": "Benjamin Kosnik", "email": "bkoz@gcc.gnu.org", "date": "2007-02-14T11:07:17Z"}, "message": "configure.ac: Move AM_ICONV to native-only, add HAVE_ICONV for newlib.\n\n2007-02-14  Benjamin Kosnik  <bkoz@redhat.com>\n\n        * configure.ac: Move AM_ICONV to native-only, add HAVE_ICONV for\n        newlib.\n        * configure: Regenerate.\n\nFrom-SVN: r121947", "tree": {"sha": "96e376e29d24c7f98c08a23e067eabe303ecc5ee", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/96e376e29d24c7f98c08a23e067eabe303ecc5ee"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5f34ed87f7203307efbcfc802c812b7c1c0b947d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5f34ed87f7203307efbcfc802c812b7c1c0b947d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5f34ed87f7203307efbcfc802c812b7c1c0b947d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5f34ed87f7203307efbcfc802c812b7c1c0b947d/comments", "author": null, "committer": null, "parents": [{"sha": "8225879cc7662cc31a278720cca63633ed9e6471", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8225879cc7662cc31a278720cca63633ed9e6471", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8225879cc7662cc31a278720cca63633ed9e6471"}], "stats": {"total": 2616, "additions": 1317, "deletions": 1299}, "files": [{"sha": "ec1358bf25254cda19f69ff9f6f31ecc8f3b78cf", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5f34ed87f7203307efbcfc802c812b7c1c0b947d/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5f34ed87f7203307efbcfc802c812b7c1c0b947d/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=5f34ed87f7203307efbcfc802c812b7c1c0b947d", "patch": "@@ -1,3 +1,9 @@\n+2007-02-14  Benjamin Kosnik  <bkoz@redhat.com>\n+\n+        * configure.ac: Move AM_ICONV to native-only, add HAVE_ICONV for\n+        newlib.\n+        * configure: Regenerate.\n+\t\n 2007-02-13  Dirk Mueller  <dmueller@suse.de>\n \n \t* include/bits/locale_facets.tcc (num_get<>::do_get): Avoid"}, {"sha": "5162b6b9167c4d8903c7b9801792ea57e66884bc", "filename": "libstdc++-v3/configure", "status": "modified", "additions": 1306, "deletions": 1298, "changes": 2604, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5f34ed87f7203307efbcfc802c812b7c1c0b947d/libstdc%2B%2B-v3%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5f34ed87f7203307efbcfc802c812b7c1c0b947d/libstdc%2B%2B-v3%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fconfigure?ref=5f34ed87f7203307efbcfc802c812b7c1c0b947d", "patch": "@@ -309,7 +309,7 @@ ac_includes_default=\"\\\n # include <unistd.h>\n #endif\"\n \n-ac_subst_vars='SHELL PATH_SEPARATOR PACKAGE_NAME PACKAGE_TARNAME PACKAGE_VERSION PACKAGE_STRING PACKAGE_BUGREPORT exec_prefix prefix program_transform_name bindir sbindir libexecdir datadir sysconfdir sharedstatedir localstatedir libdir includedir oldincludedir infodir mandir build_alias host_alias target_alias DEFS ECHO_C ECHO_N ECHO_T LIBS libtool_VERSION multi_basedir build build_cpu build_vendor build_os host host_cpu host_vendor host_os target target_cpu target_vendor target_os INSTALL_PROGRAM INSTALL_SCRIPT INSTALL_DATA CYGPATH_W PACKAGE VERSION ACLOCAL AUTOCONF AUTOMAKE AUTOHEADER MAKEINFO install_sh STRIP ac_ct_STRIP INSTALL_STRIP_PROGRAM mkdir_p AWK SET_MAKE am__leading_dot AMTAR am__tar am__untar glibcxx_builddir glibcxx_srcdir toplevel_srcdir CC ac_ct_CC EXEEXT OBJEXT CXX ac_ct_CXX CFLAGS CXXFLAGS LN_S AS ac_ct_AS AR ac_ct_AR RANLIB ac_ct_RANLIB MAINTAINER_MODE_TRUE MAINTAINER_MODE_FALSE MAINT CPP CPPFLAGS EGREP LIBTOOL CXXCPP enable_shared enable_static LIBICONV LTLIBICONV GLIBCXX_HOSTED_TRUE GLIBCXX_HOSTED_FALSE GLIBCXX_BUILD_PCH_TRUE GLIBCXX_BUILD_PCH_FALSE glibcxx_PCHFLAGS CSTDIO_H BASIC_FILE_H BASIC_FILE_CC check_msgfmt glibcxx_MOFILES glibcxx_POFILES glibcxx_localedir USE_NLS CLOCALE_H CMESSAGES_H CCODECVT_CC CCOLLATE_CC CCTYPE_CC CMESSAGES_CC CMONEY_CC CNUMERIC_CC CTIME_H CTIME_CC CLOCALE_CC CLOCALE_INTERNAL_H ALLOCATOR_H ALLOCATOR_NAME C_INCLUDE_DIR GLIBCXX_C_HEADERS_C_TRUE GLIBCXX_C_HEADERS_C_FALSE GLIBCXX_C_HEADERS_C_STD_TRUE GLIBCXX_C_HEADERS_C_STD_FALSE GLIBCXX_C_HEADERS_COMPATIBILITY_TRUE GLIBCXX_C_HEADERS_COMPATIBILITY_FALSE DEBUG_FLAGS GLIBCXX_BUILD_DEBUG_TRUE GLIBCXX_BUILD_DEBUG_FALSE EXTRA_CXX_FLAGS glibcxx_thread_h WERROR SECTION_FLAGS SECTION_LDFLAGS OPT_LDFLAGS LIBMATHOBJS SYMVER_FILE port_specific_symbol_files ENABLE_SYMVERS_TRUE ENABLE_SYMVERS_FALSE ENABLE_SYMVERS_GNU_TRUE ENABLE_SYMVERS_GNU_FALSE ENABLE_SYMVERS_GNU_NAMESPACE_TRUE ENABLE_SYMVERS_GNU_NAMESPACE_FALSE ENABLE_SYMVERS_DARWIN_TRUE ENABLE_SYMVERS_DARWIN_FALSE ENABLE_VISIBILITY_TRUE ENABLE_VISIBILITY_FALSE GLIBCXX_LDBL_COMPAT_TRUE GLIBCXX_LDBL_COMPAT_FALSE baseline_dir ATOMICITY_SRCDIR ATOMIC_WORD_SRCDIR CPU_DEFINES_SRCDIR ABI_TWEAKS_SRCDIR OS_INC_SRCDIR glibcxx_prefixdir gxx_include_dir glibcxx_toolexecdir glibcxx_toolexeclibdir GLIBCXX_INCLUDES TOPLEVEL_INCLUDES OPTIMIZE_CXXFLAGS WARN_FLAGS LIBSUPCXX_PICFLAGS LIBOBJS LTLIBOBJS'\n+ac_subst_vars='SHELL PATH_SEPARATOR PACKAGE_NAME PACKAGE_TARNAME PACKAGE_VERSION PACKAGE_STRING PACKAGE_BUGREPORT exec_prefix prefix program_transform_name bindir sbindir libexecdir datadir sysconfdir sharedstatedir localstatedir libdir includedir oldincludedir infodir mandir build_alias host_alias target_alias DEFS ECHO_C ECHO_N ECHO_T LIBS libtool_VERSION multi_basedir build build_cpu build_vendor build_os host host_cpu host_vendor host_os target target_cpu target_vendor target_os INSTALL_PROGRAM INSTALL_SCRIPT INSTALL_DATA CYGPATH_W PACKAGE VERSION ACLOCAL AUTOCONF AUTOMAKE AUTOHEADER MAKEINFO install_sh STRIP ac_ct_STRIP INSTALL_STRIP_PROGRAM mkdir_p AWK SET_MAKE am__leading_dot AMTAR am__tar am__untar glibcxx_builddir glibcxx_srcdir toplevel_srcdir CC ac_ct_CC EXEEXT OBJEXT CXX ac_ct_CXX CFLAGS CXXFLAGS LN_S AS ac_ct_AS AR ac_ct_AR RANLIB ac_ct_RANLIB MAINTAINER_MODE_TRUE MAINTAINER_MODE_FALSE MAINT CPP CPPFLAGS EGREP LIBTOOL CXXCPP enable_shared enable_static GLIBCXX_HOSTED_TRUE GLIBCXX_HOSTED_FALSE GLIBCXX_BUILD_PCH_TRUE GLIBCXX_BUILD_PCH_FALSE glibcxx_PCHFLAGS CSTDIO_H BASIC_FILE_H BASIC_FILE_CC check_msgfmt glibcxx_MOFILES glibcxx_POFILES glibcxx_localedir USE_NLS CLOCALE_H CMESSAGES_H CCODECVT_CC CCOLLATE_CC CCTYPE_CC CMESSAGES_CC CMONEY_CC CNUMERIC_CC CTIME_H CTIME_CC CLOCALE_CC CLOCALE_INTERNAL_H ALLOCATOR_H ALLOCATOR_NAME C_INCLUDE_DIR GLIBCXX_C_HEADERS_C_TRUE GLIBCXX_C_HEADERS_C_FALSE GLIBCXX_C_HEADERS_C_STD_TRUE GLIBCXX_C_HEADERS_C_STD_FALSE GLIBCXX_C_HEADERS_COMPATIBILITY_TRUE GLIBCXX_C_HEADERS_COMPATIBILITY_FALSE DEBUG_FLAGS GLIBCXX_BUILD_DEBUG_TRUE GLIBCXX_BUILD_DEBUG_FALSE EXTRA_CXX_FLAGS glibcxx_thread_h WERROR SECTION_FLAGS SECTION_LDFLAGS OPT_LDFLAGS LIBMATHOBJS LIBICONV LTLIBICONV SYMVER_FILE port_specific_symbol_files ENABLE_SYMVERS_TRUE ENABLE_SYMVERS_FALSE ENABLE_SYMVERS_GNU_TRUE ENABLE_SYMVERS_GNU_FALSE ENABLE_SYMVERS_GNU_NAMESPACE_TRUE ENABLE_SYMVERS_GNU_NAMESPACE_FALSE ENABLE_SYMVERS_DARWIN_TRUE ENABLE_SYMVERS_DARWIN_FALSE ENABLE_VISIBILITY_TRUE ENABLE_VISIBILITY_FALSE GLIBCXX_LDBL_COMPAT_TRUE GLIBCXX_LDBL_COMPAT_FALSE baseline_dir ATOMICITY_SRCDIR ATOMIC_WORD_SRCDIR CPU_DEFINES_SRCDIR ABI_TWEAKS_SRCDIR OS_INC_SRCDIR glibcxx_prefixdir gxx_include_dir glibcxx_toolexecdir glibcxx_toolexeclibdir GLIBCXX_INCLUDES TOPLEVEL_INCLUDES OPTIMIZE_CXXFLAGS WARN_FLAGS LIBSUPCXX_PICFLAGS LIBOBJS LTLIBOBJS'\n ac_subst_files=''\n \n # Initialize some variables set by options.\n@@ -851,7 +851,6 @@ Optional Features:\n   --enable-static=PKGS  build static libraries default=yes\n   --enable-fast-install=PKGS  optimize for fast installation default=yes\n   --disable-libtool-lock  avoid locking (might break parallel builds)\n-  --disable-rpath         do not hardcode runtime library paths\n   --disable-hosted-libstdcxx\n                           only build freestanding C++ runtime support\n   --enable-sjlj-exceptions\n@@ -889,6 +888,7 @@ Optional Features:\n                           do not put empty strings in per-process static\n                           memory [default=no]\n   --enable-tls            Use thread-local storage [default=yes]\n+  --disable-rpath         do not hardcode runtime library paths\n   --enable-symvers=STYLE  enables symbol versioning of the shared library\n                           [default=yes]\n   --enable-visibility     enables visibility safe usage [default=yes]\n@@ -5290,612 +5290,271 @@ exec 5>>./config.log\n \n \n \n-      if test \"X$prefix\" = \"XNONE\"; then\n-    acl_final_prefix=\"$ac_default_prefix\"\n-  else\n-    acl_final_prefix=\"$prefix\"\n-  fi\n-  if test \"X$exec_prefix\" = \"XNONE\"; then\n-    acl_final_exec_prefix='${prefix}'\n-  else\n-    acl_final_exec_prefix=\"$exec_prefix\"\n-  fi\n-  acl_save_prefix=\"$prefix\"\n-  prefix=\"$acl_final_prefix\"\n-  eval acl_final_exec_prefix=\\\"$acl_final_exec_prefix\\\"\n-  prefix=\"$acl_save_prefix\"\n+# Possibly disable most of the library.\n+## TODO: Consider skipping unncessary tests altogether in this case, rather\n+## than just ignoring the results.  Faster /and/ more correct, win win.\n \n+  # Check whether --enable-hosted-libstdcxx or --disable-hosted-libstdcxx was given.\n+if test \"${enable_hosted_libstdcxx+set}\" = set; then\n+  enableval=\"$enable_hosted_libstdcxx\"\n \n-# Check whether --with-gnu-ld or --without-gnu-ld was given.\n-if test \"${with_gnu_ld+set}\" = set; then\n-  withval=\"$with_gnu_ld\"\n-  test \"$withval\" = no || with_gnu_ld=yes\n else\n-  with_gnu_ld=no\n+  case \"$host\" in\n+\tarm*-*-symbianelf*)\n+\t    enable_hosted_libstdcxx=no\n+\t    ;;\n+        *)\n+\t    enable_hosted_libstdcxx=yes\n+\t    ;;\n+     esac\n fi;\n-# Prepare PATH_SEPARATOR.\n-# The user is always right.\n-if test \"${PATH_SEPARATOR+set}\" != set; then\n-  echo \"#! /bin/sh\" >conf$$.sh\n-  echo  \"exit 0\"   >>conf$$.sh\n-  chmod +x conf$$.sh\n-  if (PATH=\"/nonexistent;.\"; conf$$.sh) >/dev/null 2>&1; then\n-    PATH_SEPARATOR=';'\n+  if test \"$enable_hosted_libstdcxx\" = no; then\n+    { echo \"$as_me:$LINENO: Only freestanding libraries will be built\" >&5\n+echo \"$as_me: Only freestanding libraries will be built\" >&6;}\n+    is_hosted=no\n+    hosted_define=0\n+    enable_abi_check=no\n+    enable_libstdcxx_pch=no\n   else\n-    PATH_SEPARATOR=:\n+    is_hosted=yes\n+    hosted_define=1\n   fi\n-  rm -f conf$$.sh\n-fi\n-ac_prog=ld\n-if test \"$GCC\" = yes; then\n-  # Check if gcc -print-prog-name=ld gives a path.\n-  echo \"$as_me:$LINENO: checking for ld used by GCC\" >&5\n-echo $ECHO_N \"checking for ld used by GCC... $ECHO_C\" >&6\n-  case $host in\n-  *-*-mingw*)\n-    # gcc leaves a trailing carriage return which upsets mingw\n-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\\015'` ;;\n-  *)\n-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;\n-  esac\n-  case $ac_prog in\n-    # Accept absolute paths.\n-    [\\\\/]* | [A-Za-z]:[\\\\/]*)\n-      re_direlt='/[^/][^/]*/\\.\\./'\n-      # Canonicalize the path of ld\n-      ac_prog=`echo $ac_prog| sed 's%\\\\\\\\%/%g'`\n-      while echo $ac_prog | grep \"$re_direlt\" > /dev/null 2>&1; do\n-\tac_prog=`echo $ac_prog| sed \"s%$re_direlt%/%\"`\n-      done\n-      test -z \"$LD\" && LD=\"$ac_prog\"\n-      ;;\n-  \"\")\n-    # If it fails, then pretend we aren't using GCC.\n-    ac_prog=ld\n-    ;;\n-  *)\n-    # If it is relative, then search for the first ld in PATH.\n-    with_gnu_ld=unknown\n-    ;;\n-  esac\n-elif test \"$with_gnu_ld\" = yes; then\n-  echo \"$as_me:$LINENO: checking for GNU ld\" >&5\n-echo $ECHO_N \"checking for GNU ld... $ECHO_C\" >&6\n-else\n-  echo \"$as_me:$LINENO: checking for non-GNU ld\" >&5\n-echo $ECHO_N \"checking for non-GNU ld... $ECHO_C\" >&6\n-fi\n-if test \"${acl_cv_path_LD+set}\" = set; then\n-  echo $ECHO_N \"(cached) $ECHO_C\" >&6\n+\n+\n+cat >>confdefs.h <<_ACEOF\n+#define _GLIBCXX_HOSTED $hosted_define\n+_ACEOF\n+\n+\n+\n+# Check for compiler support that doesn't require linking.\n+\n+  echo \"$as_me:$LINENO: checking for exception model to use\" >&5\n+echo $ECHO_N \"checking for exception model to use... $ECHO_C\" >&6\n+\n+\n+  ac_ext=cc\n+ac_cpp='$CXXCPP $CPPFLAGS'\n+ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'\n+ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'\n+ac_compiler_gnu=$ac_cv_cxx_compiler_gnu\n+\n+   # Check whether --enable-sjlj-exceptions or --disable-sjlj-exceptions was given.\n+if test \"${enable_sjlj_exceptions+set}\" = set; then\n+  enableval=\"$enable_sjlj_exceptions\"\n+\n+      case \"$enableval\" in\n+       yes|no|auto) ;;\n+       *) { { echo \"$as_me:$LINENO: error: Unknown argument to enable/disable sjlj-exceptions\" >&5\n+echo \"$as_me: error: Unknown argument to enable/disable sjlj-exceptions\" >&2;}\n+   { (exit 1); exit 1; }; } ;;\n+                          esac\n+\n else\n-  if test -z \"$LD\"; then\n-  IFS=\"${IFS= \t}\"; ac_save_ifs=\"$IFS\"; IFS=\"${IFS}${PATH_SEPARATOR-:}\"\n-  for ac_dir in $PATH; do\n-    test -z \"$ac_dir\" && ac_dir=.\n-    if test -f \"$ac_dir/$ac_prog\" || test -f \"$ac_dir/$ac_prog$ac_exeext\"; then\n-      acl_cv_path_LD=\"$ac_dir/$ac_prog\"\n-      # Check to see if the program is GNU ld.  I'd rather use --version,\n-      # but apparently some GNU ld's only accept -v.\n-      # Break only if it was the GNU/non-GNU ld that we prefer.\n-      if \"$acl_cv_path_LD\" -v 2>&1 < /dev/null | egrep '(GNU|with BFD)' > /dev/null; then\n-\ttest \"$with_gnu_ld\" != no && break\n-      else\n-\ttest \"$with_gnu_ld\" != yes && break\n+  enable_sjlj_exceptions=auto\n+fi;\n+\n+\n+  if test $enable_sjlj_exceptions = auto; then\n+    # Botheration.  Now we've got to detect the exception model.  Link tests\n+    # against libgcc.a are problematic since we've not been given proper -L\n+    # bits for single-tree newlib and libgloss.\n+    #\n+    # Fake what AC_TRY_COMPILE does.  XXX Look at redoing this new-style.\n+    cat > conftest.$ac_ext << EOF\n+#line 5365 \"configure\"\n+struct S { ~S(); };\n+void bar();\n+void foo()\n+{\n+  S s;\n+  bar();\n+}\n+EOF\n+    old_CXXFLAGS=\"$CXXFLAGS\"\n+    CXXFLAGS=-S\n+    if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n+  (eval $ac_compile) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; then\n+      if grep _Unwind_SjLj_Resume conftest.s >/dev/null 2>&1 ; then\n+        enable_sjlj_exceptions=yes\n+      elif grep _Unwind_Resume conftest.s >/dev/null 2>&1 ; then\n+        enable_sjlj_exceptions=no\n+      elif grep __cxa_end_cleanup conftest.s >/dev/null 2>&1 ; then\n+        enable_sjlj_exceptions=no\n       fi\n     fi\n-  done\n-  IFS=\"$ac_save_ifs\"\n-else\n-  acl_cv_path_LD=\"$LD\" # Let the user override the test with a path.\n-fi\n-fi\n+    CXXFLAGS=\"$old_CXXFLAGS\"\n+    rm -f conftest*\n+  fi\n \n-LD=\"$acl_cv_path_LD\"\n-if test -n \"$LD\"; then\n-  echo \"$as_me:$LINENO: result: $LD\" >&5\n-echo \"${ECHO_T}$LD\" >&6\n-else\n-  echo \"$as_me:$LINENO: result: no\" >&5\n-echo \"${ECHO_T}no\" >&6\n-fi\n-test -z \"$LD\" && { { echo \"$as_me:$LINENO: error: no acceptable ld found in \\$PATH\" >&5\n-echo \"$as_me: error: no acceptable ld found in \\$PATH\" >&2;}\n+  # This is a tad weird, for hysterical raisins.  We have to map\n+  # enable/disable to two different models.\n+  case $enable_sjlj_exceptions in\n+    yes)\n+\n+cat >>confdefs.h <<\\_ACEOF\n+#define _GLIBCXX_SJLJ_EXCEPTIONS 1\n+_ACEOF\n+\n+      ac_exception_model_name=sjlj\n+      ;;\n+    no)\n+      ac_exception_model_name=\"call frame\"\n+      ;;\n+    *)\n+      { { echo \"$as_me:$LINENO: error: unable to detect exception model\" >&5\n+echo \"$as_me: error: unable to detect exception model\" >&2;}\n    { (exit 1); exit 1; }; }\n-echo \"$as_me:$LINENO: checking if the linker ($LD) is GNU ld\" >&5\n-echo $ECHO_N \"checking if the linker ($LD) is GNU ld... $ECHO_C\" >&6\n-if test \"${acl_cv_prog_gnu_ld+set}\" = set; then\n-  echo $ECHO_N \"(cached) $ECHO_C\" >&6\n-else\n-  # I'd rather use --version here, but apparently some GNU ld's only accept -v.\n-if $LD -v 2>&1 </dev/null | egrep '(GNU|with BFD)' 1>&5; then\n-  acl_cv_prog_gnu_ld=yes\n-else\n-  acl_cv_prog_gnu_ld=no\n-fi\n-fi\n-echo \"$as_me:$LINENO: result: $acl_cv_prog_gnu_ld\" >&5\n-echo \"${ECHO_T}$acl_cv_prog_gnu_ld\" >&6\n-with_gnu_ld=$acl_cv_prog_gnu_ld\n+      ;;\n+  esac\n+ ac_ext=c\n+ac_cpp='$CPP $CPPFLAGS'\n+ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'\n+ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'\n+ac_compiler_gnu=$ac_cv_c_compiler_gnu\n \n+ echo \"$as_me:$LINENO: result: $ac_exception_model_name\" >&5\n+echo \"${ECHO_T}$ac_exception_model_name\" >&6\n \n \n-                                                echo \"$as_me:$LINENO: checking for shared library run path origin\" >&5\n-echo $ECHO_N \"checking for shared library run path origin... $ECHO_C\" >&6\n-if test \"${acl_cv_rpath+set}\" = set; then\n-  echo $ECHO_N \"(cached) $ECHO_C\" >&6\n-else\n+   # Check whether --enable-libstdcxx-pch or --disable-libstdcxx-pch was given.\n+if test \"${enable_libstdcxx_pch+set}\" = set; then\n+  enableval=\"$enable_libstdcxx_pch\"\n \n-    CC=\"$CC\" GCC=\"$GCC\" LDFLAGS=\"$LDFLAGS\" LD=\"$LD\" with_gnu_ld=\"$with_gnu_ld\" \\\n-    ${CONFIG_SHELL-/bin/sh} \"$ac_aux_dir/config.rpath\" \"$host\" > conftest.sh\n-    . ./conftest.sh\n-    rm -f ./conftest.sh\n-    acl_cv_rpath=done\n+      case \"$enableval\" in\n+       yes|no) ;;\n+       *) { { echo \"$as_me:$LINENO: error: Argument to enable/disable libstdcxx-pch must be yes or no\" >&5\n+echo \"$as_me: error: Argument to enable/disable libstdcxx-pch must be yes or no\" >&2;}\n+   { (exit 1); exit 1; }; } ;;\n+      esac\n \n-fi\n-echo \"$as_me:$LINENO: result: $acl_cv_rpath\" >&5\n-echo \"${ECHO_T}$acl_cv_rpath\" >&6\n-  wl=\"$acl_cv_wl\"\n-  libext=\"$acl_cv_libext\"\n-  shlibext=\"$acl_cv_shlibext\"\n-  hardcode_libdir_flag_spec=\"$acl_cv_hardcode_libdir_flag_spec\"\n-  hardcode_libdir_separator=\"$acl_cv_hardcode_libdir_separator\"\n-  hardcode_direct=\"$acl_cv_hardcode_direct\"\n-  hardcode_minus_L=\"$acl_cv_hardcode_minus_L\"\n-    # Check whether --enable-rpath or --disable-rpath was given.\n-if test \"${enable_rpath+set}\" = set; then\n-  enableval=\"$enable_rpath\"\n-  :\n else\n-  enable_rpath=yes\n+  enable_libstdcxx_pch=$is_hosted\n fi;\n \n+  if test $enable_libstdcxx_pch = yes; then\n+    echo \"$as_me:$LINENO: checking for compiler with PCH support\" >&5\n+echo $ECHO_N \"checking for compiler with PCH support... $ECHO_C\" >&6\n+if test \"${glibcxx_cv_prog_CXX_pch+set}\" = set; then\n+  echo $ECHO_N \"(cached) $ECHO_C\" >&6\n+else\n+  ac_save_CXXFLAGS=\"$CXXFLAGS\"\n+       CXXFLAGS=\"$CXXFLAGS -Werror -Winvalid-pch -Wno-deprecated\"\n \n \n+       ac_ext=cc\n+ac_cpp='$CXXCPP $CPPFLAGS'\n+ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'\n+ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'\n+ac_compiler_gnu=$ac_cv_cxx_compiler_gnu\n \n+       echo '#include <math.h>' > conftest.h\n+       if $CXX $CXXFLAGS $CPPFLAGS -x c++-header conftest.h \\\n+\t\t          -o conftest.h.gch 1>&5 2>&1 &&\n+\t        echo '#error \"pch failed\"' > conftest.h &&\n+          echo '#include \"conftest.h\"' > conftest.cc &&\n+\t       $CXX -c $CXXFLAGS $CPPFLAGS conftest.cc 1>&5 2>&1 ;\n+       then\n+         glibcxx_cv_prog_CXX_pch=yes\n+       else\n+         glibcxx_cv_prog_CXX_pch=no\n+       fi\n+       rm -f conftest*\n+       CXXFLAGS=$ac_save_CXXFLAGS\n+       ac_ext=c\n+ac_cpp='$CPP $CPPFLAGS'\n+ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'\n+ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'\n+ac_compiler_gnu=$ac_cv_c_compiler_gnu\n \n \n+fi\n+echo \"$as_me:$LINENO: result: $glibcxx_cv_prog_CXX_pch\" >&5\n+echo \"${ECHO_T}$glibcxx_cv_prog_CXX_pch\" >&6\n+    enable_libstdcxx_pch=$glibcxx_cv_prog_CXX_pch\n+  fi\n \n-    use_additional=yes\n+  echo \"$as_me:$LINENO: checking for enabled PCH\" >&5\n+echo $ECHO_N \"checking for enabled PCH... $ECHO_C\" >&6\n+  echo \"$as_me:$LINENO: result: $enable_libstdcxx_pch\" >&5\n+echo \"${ECHO_T}$enable_libstdcxx_pch\" >&6\n \n-  acl_save_prefix=\"$prefix\"\n-  prefix=\"$acl_final_prefix\"\n-  acl_save_exec_prefix=\"$exec_prefix\"\n-  exec_prefix=\"$acl_final_exec_prefix\"\n \n-    eval additional_includedir=\\\"$includedir\\\"\n-    eval additional_libdir=\\\"$libdir\\\"\n+  if test $enable_libstdcxx_pch = yes; then\n+    glibcxx_PCHFLAGS=\"-include bits/stdtr1c++.h\"\n+  else\n+    glibcxx_PCHFLAGS=\"\"\n+  fi\n \n-  exec_prefix=\"$acl_save_exec_prefix\"\n-  prefix=\"$acl_save_prefix\"\n \n \n-# Check whether --with-libiconv-prefix or --without-libiconv-prefix was given.\n-if test \"${with_libiconv_prefix+set}\" = set; then\n-  withval=\"$with_libiconv_prefix\"\n+# Enable all the variable C++ runtime options.\n \n-    if test \"X$withval\" = \"Xno\"; then\n-      use_additional=no\n-    else\n-      if test \"X$withval\" = \"X\"; then\n+  echo \"$as_me:$LINENO: checking for underlying I/O to use\" >&5\n+echo $ECHO_N \"checking for underlying I/O to use... $ECHO_C\" >&6\n+   # Check whether --enable-cstdio or --disable-cstdio was given.\n+if test \"${enable_cstdio+set}\" = set; then\n+  enableval=\"$enable_cstdio\"\n \n-  acl_save_prefix=\"$prefix\"\n-  prefix=\"$acl_final_prefix\"\n-  acl_save_exec_prefix=\"$exec_prefix\"\n-  exec_prefix=\"$acl_final_exec_prefix\"\n+      case \"$enableval\" in\n+       stdio) ;;\n+       *) { { echo \"$as_me:$LINENO: error: Unknown argument to enable/disable cstdio\" >&5\n+echo \"$as_me: error: Unknown argument to enable/disable cstdio\" >&2;}\n+   { (exit 1); exit 1; }; } ;;\n+                          esac\n \n-          eval additional_includedir=\\\"$includedir\\\"\n-          eval additional_libdir=\\\"$libdir\\\"\n+else\n+  enable_cstdio=stdio\n+fi;\n \n-  exec_prefix=\"$acl_save_exec_prefix\"\n-  prefix=\"$acl_save_prefix\"\n \n-      else\n-        additional_includedir=\"$withval/include\"\n-        additional_libdir=\"$withval/lib\"\n-      fi\n-    fi\n+  # Now that libio has been removed, you can have any color you want as long\n+  # as it's black.  This is one big no-op until other packages are added, but\n+  # showing the framework never hurts.\n+  case ${enable_cstdio} in\n+    stdio)\n+      CSTDIO_H=config/io/c_io_stdio.h\n+      BASIC_FILE_H=config/io/basic_file_stdio.h\n+      BASIC_FILE_CC=config/io/basic_file_stdio.cc\n+      echo \"$as_me:$LINENO: result: stdio\" >&5\n+echo \"${ECHO_T}stdio\" >&6\n+      ;;\n+  esac\n \n-fi;\n-      LIBICONV=\n-  LTLIBICONV=\n-  INCICONV=\n-  rpathdirs=\n-  ltrpathdirs=\n-  names_already_handled=\n-  names_next_round='iconv '\n-  while test -n \"$names_next_round\"; do\n-    names_this_round=\"$names_next_round\"\n-    names_next_round=\n-    for name in $names_this_round; do\n-      already_handled=\n-      for n in $names_already_handled; do\n-        if test \"$n\" = \"$name\"; then\n-          already_handled=yes\n-          break\n-        fi\n-      done\n-      if test -z \"$already_handled\"; then\n-        names_already_handled=\"$names_already_handled $name\"\n-                        uppername=`echo \"$name\" | sed -e 'y|abcdefghijklmnopqrstuvwxyz./-|ABCDEFGHIJKLMNOPQRSTUVWXYZ___|'`\n-        eval value=\\\"\\$HAVE_LIB$uppername\\\"\n-        if test -n \"$value\"; then\n-          if test \"$value\" = yes; then\n-            eval value=\\\"\\$LIB$uppername\\\"\n-            test -z \"$value\" || LIBICONV=\"${LIBICONV}${LIBICONV:+ }$value\"\n-            eval value=\\\"\\$LTLIB$uppername\\\"\n-            test -z \"$value\" || LTLIBICONV=\"${LTLIBICONV}${LTLIBICONV:+ }$value\"\n-          else\n-                                    :\n-          fi\n-        else\n-                              found_dir=\n-          found_la=\n-          found_so=\n-          found_a=\n-          if test $use_additional = yes; then\n-            if test -n \"$shlibext\" && test -f \"$additional_libdir/lib$name.$shlibext\"; then\n-              found_dir=\"$additional_libdir\"\n-              found_so=\"$additional_libdir/lib$name.$shlibext\"\n-              if test -f \"$additional_libdir/lib$name.la\"; then\n-                found_la=\"$additional_libdir/lib$name.la\"\n-              fi\n-            else\n-              if test -f \"$additional_libdir/lib$name.$libext\"; then\n-                found_dir=\"$additional_libdir\"\n-                found_a=\"$additional_libdir/lib$name.$libext\"\n-                if test -f \"$additional_libdir/lib$name.la\"; then\n-                  found_la=\"$additional_libdir/lib$name.la\"\n-                fi\n-              fi\n-            fi\n-          fi\n-          if test \"X$found_dir\" = \"X\"; then\n-            for x in $LDFLAGS $LTLIBICONV; do\n \n-  acl_save_prefix=\"$prefix\"\n-  prefix=\"$acl_final_prefix\"\n-  acl_save_exec_prefix=\"$exec_prefix\"\n-  exec_prefix=\"$acl_final_exec_prefix\"\n-  eval x=\\\"$x\\\"\n-  exec_prefix=\"$acl_save_exec_prefix\"\n-  prefix=\"$acl_save_prefix\"\n \n-              case \"$x\" in\n-                -L*)\n-                  dir=`echo \"X$x\" | sed -e 's/^X-L//'`\n-                  if test -n \"$shlibext\" && test -f \"$dir/lib$name.$shlibext\"; then\n-                    found_dir=\"$dir\"\n-                    found_so=\"$dir/lib$name.$shlibext\"\n-                    if test -f \"$dir/lib$name.la\"; then\n-                      found_la=\"$dir/lib$name.la\"\n-                    fi\n-                  else\n-                    if test -f \"$dir/lib$name.$libext\"; then\n-                      found_dir=\"$dir\"\n-                      found_a=\"$dir/lib$name.$libext\"\n-                      if test -f \"$dir/lib$name.la\"; then\n-                        found_la=\"$dir/lib$name.la\"\n-                      fi\n-                    fi\n-                  fi\n-                  ;;\n-              esac\n-              if test \"X$found_dir\" != \"X\"; then\n-                break\n-              fi\n-            done\n-          fi\n-          if test \"X$found_dir\" != \"X\"; then\n-                        LTLIBICONV=\"${LTLIBICONV}${LTLIBICONV:+ }-L$found_dir -l$name\"\n-            if test \"X$found_so\" != \"X\"; then\n-                                                        if test \"$enable_rpath\" = no || test \"X$found_dir\" = \"X/usr/lib\"; then\n-                                LIBICONV=\"${LIBICONV}${LIBICONV:+ }$found_so\"\n-              else\n-                                                                                haveit=\n-                for x in $ltrpathdirs; do\n-                  if test \"X$x\" = \"X$found_dir\"; then\n-                    haveit=yes\n-                    break\n-                  fi\n-                done\n-                if test -z \"$haveit\"; then\n-                  ltrpathdirs=\"$ltrpathdirs $found_dir\"\n-                fi\n-                                if test \"$hardcode_direct\" = yes; then\n-                                                      LIBICONV=\"${LIBICONV}${LIBICONV:+ }$found_so\"\n-                else\n-                  if test -n \"$hardcode_libdir_flag_spec\" && test \"$hardcode_minus_L\" = no; then\n-                                                            LIBICONV=\"${LIBICONV}${LIBICONV:+ }$found_so\"\n-                                                            haveit=\n-                    for x in $rpathdirs; do\n-                      if test \"X$x\" = \"X$found_dir\"; then\n-                        haveit=yes\n-                        break\n-                      fi\n-                    done\n-                    if test -z \"$haveit\"; then\n-                      rpathdirs=\"$rpathdirs $found_dir\"\n-                    fi\n-                  else\n-                                                                                haveit=\n-                    for x in $LDFLAGS $LIBICONV; do\n \n-  acl_save_prefix=\"$prefix\"\n-  prefix=\"$acl_final_prefix\"\n-  acl_save_exec_prefix=\"$exec_prefix\"\n-  exec_prefix=\"$acl_final_exec_prefix\"\n-  eval x=\\\"$x\\\"\n-  exec_prefix=\"$acl_save_exec_prefix\"\n-  prefix=\"$acl_save_prefix\"\n \n-                      if test \"X$x\" = \"X-L$found_dir\"; then\n-                        haveit=yes\n-                        break\n-                      fi\n-                    done\n-                    if test -z \"$haveit\"; then\n-                      LIBICONV=\"${LIBICONV}${LIBICONV:+ }-L$found_dir\"\n-                    fi\n-                    if test \"$hardcode_minus_L\" != no; then\n-                                                                                        LIBICONV=\"${LIBICONV}${LIBICONV:+ }$found_so\"\n-                    else\n-                                                                                                                                                                                LIBICONV=\"${LIBICONV}${LIBICONV:+ }-l$name\"\n-                    fi\n-                  fi\n-                fi\n-              fi\n-            else\n-              if test \"X$found_a\" != \"X\"; then\n-                                LIBICONV=\"${LIBICONV}${LIBICONV:+ }$found_a\"\n-              else\n-                                                LIBICONV=\"${LIBICONV}${LIBICONV:+ }-L$found_dir -l$name\"\n-              fi\n-            fi\n-                        additional_includedir=\n-            case \"$found_dir\" in\n-              */lib | */lib/)\n-                basedir=`echo \"X$found_dir\" | sed -e 's,^X,,' -e 's,/lib/*$,,'`\n-                additional_includedir=\"$basedir/include\"\n-                ;;\n-            esac\n-            if test \"X$additional_includedir\" != \"X\"; then\n-                                                                                                                if test \"X$additional_includedir\" != \"X/usr/include\"; then\n-                haveit=\n-                if test \"X$additional_includedir\" = \"X/usr/local/include\"; then\n-                  if test -n \"$GCC\"; then\n-                    case $host_os in\n-                      linux*) haveit=yes;;\n-                    esac\n-                  fi\n-                fi\n-                if test -z \"$haveit\"; then\n-                  for x in $CPPFLAGS $INCICONV; do\n-\n-  acl_save_prefix=\"$prefix\"\n-  prefix=\"$acl_final_prefix\"\n-  acl_save_exec_prefix=\"$exec_prefix\"\n-  exec_prefix=\"$acl_final_exec_prefix\"\n-  eval x=\\\"$x\\\"\n-  exec_prefix=\"$acl_save_exec_prefix\"\n-  prefix=\"$acl_save_prefix\"\n-\n-                    if test \"X$x\" = \"X-I$additional_includedir\"; then\n-                      haveit=yes\n-                      break\n-                    fi\n-                  done\n-                  if test -z \"$haveit\"; then\n-                    if test -d \"$additional_includedir\"; then\n-                                            INCICONV=\"${INCICONV}${INCICONV:+ }-I$additional_includedir\"\n-                    fi\n-                  fi\n-                fi\n-              fi\n-            fi\n-                        if test -n \"$found_la\"; then\n-                                                        save_libdir=\"$libdir\"\n-              case \"$found_la\" in\n-                */* | *\\\\*) . \"$found_la\" ;;\n-                *) . \"./$found_la\" ;;\n-              esac\n-              libdir=\"$save_libdir\"\n-                            for dep in $dependency_libs; do\n-                case \"$dep\" in\n-                  -L*)\n-                    additional_libdir=`echo \"X$dep\" | sed -e 's/^X-L//'`\n-                                                                                                                                                                if test \"X$additional_libdir\" != \"X/usr/lib\"; then\n-                      haveit=\n-                      if test \"X$additional_libdir\" = \"X/usr/local/lib\"; then\n-                        if test -n \"$GCC\"; then\n-                          case $host_os in\n-                            linux*) haveit=yes;;\n-                          esac\n-                        fi\n-                      fi\n-                      if test -z \"$haveit\"; then\n-                        haveit=\n-                        for x in $LDFLAGS $LIBICONV; do\n-\n-  acl_save_prefix=\"$prefix\"\n-  prefix=\"$acl_final_prefix\"\n-  acl_save_exec_prefix=\"$exec_prefix\"\n-  exec_prefix=\"$acl_final_exec_prefix\"\n-  eval x=\\\"$x\\\"\n-  exec_prefix=\"$acl_save_exec_prefix\"\n-  prefix=\"$acl_save_prefix\"\n-\n-                          if test \"X$x\" = \"X-L$additional_libdir\"; then\n-                            haveit=yes\n-                            break\n-                          fi\n-                        done\n-                        if test -z \"$haveit\"; then\n-                          if test -d \"$additional_libdir\"; then\n-                                                        LIBICONV=\"${LIBICONV}${LIBICONV:+ }-L$additional_libdir\"\n-                          fi\n-                        fi\n-                        haveit=\n-                        for x in $LDFLAGS $LTLIBICONV; do\n-\n-  acl_save_prefix=\"$prefix\"\n-  prefix=\"$acl_final_prefix\"\n-  acl_save_exec_prefix=\"$exec_prefix\"\n-  exec_prefix=\"$acl_final_exec_prefix\"\n-  eval x=\\\"$x\\\"\n-  exec_prefix=\"$acl_save_exec_prefix\"\n-  prefix=\"$acl_save_prefix\"\n-\n-                          if test \"X$x\" = \"X-L$additional_libdir\"; then\n-                            haveit=yes\n-                            break\n-                          fi\n-                        done\n-                        if test -z \"$haveit\"; then\n-                          if test -d \"$additional_libdir\"; then\n-                                                        LTLIBICONV=\"${LTLIBICONV}${LTLIBICONV:+ }-L$additional_libdir\"\n-                          fi\n-                        fi\n-                      fi\n-                    fi\n-                    ;;\n-                  -R*)\n-                    dir=`echo \"X$dep\" | sed -e 's/^X-R//'`\n-                    if test \"$enable_rpath\" != no; then\n-                                                                  haveit=\n-                      for x in $rpathdirs; do\n-                        if test \"X$x\" = \"X$dir\"; then\n-                          haveit=yes\n-                          break\n-                        fi\n-                      done\n-                      if test -z \"$haveit\"; then\n-                        rpathdirs=\"$rpathdirs $dir\"\n-                      fi\n-                                                                  haveit=\n-                      for x in $ltrpathdirs; do\n-                        if test \"X$x\" = \"X$dir\"; then\n-                          haveit=yes\n-                          break\n-                        fi\n-                      done\n-                      if test -z \"$haveit\"; then\n-                        ltrpathdirs=\"$ltrpathdirs $dir\"\n-                      fi\n-                    fi\n-                    ;;\n-                  -l*)\n-                                        names_next_round=\"$names_next_round \"`echo \"X$dep\" | sed -e 's/^X-l//'`\n-                    ;;\n-                  *.la)\n-                                                                                names_next_round=\"$names_next_round \"`echo \"X$dep\" | sed -e 's,^X.*/,,' -e 's,^lib,,' -e 's,\\.la$,,'`\n-                    ;;\n-                  *)\n-                                        LIBICONV=\"${LIBICONV}${LIBICONV:+ }$dep\"\n-                    LTLIBICONV=\"${LTLIBICONV}${LTLIBICONV:+ }$dep\"\n-                    ;;\n-                esac\n-              done\n-            fi\n-          else\n-                                                            LIBICONV=\"${LIBICONV}${LIBICONV:+ }-l$name\"\n-            LTLIBICONV=\"${LTLIBICONV}${LTLIBICONV:+ }-l$name\"\n-          fi\n-        fi\n-      fi\n-    done\n-  done\n-  if test \"X$rpathdirs\" != \"X\"; then\n-    if test -n \"$hardcode_libdir_separator\"; then\n-                        alldirs=\n-      for found_dir in $rpathdirs; do\n-        alldirs=\"${alldirs}${alldirs:+$hardcode_libdir_separator}$found_dir\"\n-      done\n-            acl_save_libdir=\"$libdir\"\n-      libdir=\"$alldirs\"\n-      eval flag=\\\"$hardcode_libdir_flag_spec\\\"\n-      libdir=\"$acl_save_libdir\"\n-      LIBICONV=\"${LIBICONV}${LIBICONV:+ }$flag\"\n-    else\n-            for found_dir in $rpathdirs; do\n-        acl_save_libdir=\"$libdir\"\n-        libdir=\"$found_dir\"\n-        eval flag=\\\"$hardcode_libdir_flag_spec\\\"\n-        libdir=\"$acl_save_libdir\"\n-        LIBICONV=\"${LIBICONV}${LIBICONV:+ }$flag\"\n-      done\n-    fi\n-  fi\n-  if test \"X$ltrpathdirs\" != \"X\"; then\n-            for found_dir in $ltrpathdirs; do\n-      LTLIBICONV=\"${LTLIBICONV}${LTLIBICONV:+ }-R$found_dir\"\n-    done\n-  fi\n-\n-\n-\n-\n-\n-\n-\n-          am_save_CPPFLAGS=\"$CPPFLAGS\"\n-\n-  for element in $INCICONV; do\n-    haveit=\n-    for x in $CPPFLAGS; do\n-\n-  acl_save_prefix=\"$prefix\"\n-  prefix=\"$acl_final_prefix\"\n-  acl_save_exec_prefix=\"$exec_prefix\"\n-  exec_prefix=\"$acl_final_exec_prefix\"\n-  eval x=\\\"$x\\\"\n-  exec_prefix=\"$acl_save_exec_prefix\"\n-  prefix=\"$acl_save_prefix\"\n-\n-      if test \"X$x\" = \"X$element\"; then\n-        haveit=yes\n-        break\n-      fi\n-    done\n-    if test -z \"$haveit\"; then\n-      CPPFLAGS=\"${CPPFLAGS}${CPPFLAGS:+ }$element\"\n-    fi\n-  done\n-\n-\n-  echo \"$as_me:$LINENO: checking for iconv\" >&5\n-echo $ECHO_N \"checking for iconv... $ECHO_C\" >&6\n-if test \"${am_cv_func_iconv+set}\" = set; then\n+echo \"$as_me:$LINENO: checking for ANSI C header files\" >&5\n+echo $ECHO_N \"checking for ANSI C header files... $ECHO_C\" >&6\n+if test \"${ac_cv_header_stdc+set}\" = set; then\n   echo $ECHO_N \"(cached) $ECHO_C\" >&6\n else\n-\n-    am_cv_func_iconv=\"no, consider installing GNU libiconv\"\n-    am_cv_lib_iconv=no\n-    if test x$gcc_no_link = xyes; then\n-  { { echo \"$as_me:$LINENO: error: Link tests are not allowed after GCC_NO_EXECUTABLES.\" >&5\n-echo \"$as_me: error: Link tests are not allowed after GCC_NO_EXECUTABLES.\" >&2;}\n-   { (exit 1); exit 1; }; }\n-fi\n-cat >conftest.$ac_ext <<_ACEOF\n+  cat >conftest.$ac_ext <<_ACEOF\n /* confdefs.h.  */\n _ACEOF\n cat confdefs.h >>conftest.$ac_ext\n cat >>conftest.$ac_ext <<_ACEOF\n /* end confdefs.h.  */\n #include <stdlib.h>\n-#include <iconv.h>\n+#include <stdarg.h>\n+#include <string.h>\n+#include <float.h>\n+\n int\n main ()\n {\n-iconv_t cd = iconv_open(\"\",\"\");\n-       iconv(cd,NULL,NULL,NULL,NULL);\n-       iconv_close(cd);\n+\n   ;\n   return 0;\n }\n _ACEOF\n-rm -f conftest.$ac_objext conftest$ac_exeext\n-if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n-  (eval $ac_link) 2>conftest.er1\n+rm -f conftest.$ac_objext\n+if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n+  (eval $ac_compile) 2>conftest.er1\n   ac_status=$?\n   grep -v '^ *+' conftest.er1 >conftest.err\n   rm -f conftest.er1\n@@ -5909,136 +5568,160 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   ac_status=$?\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); }; } &&\n-\t { ac_try='test -s conftest$ac_exeext'\n+\t { ac_try='test -s conftest.$ac_objext'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); }; }; then\n-  am_cv_func_iconv=yes\n+  ac_cv_header_stdc=yes\n else\n   echo \"$as_me: failed program was:\" >&5\n sed 's/^/| /' conftest.$ac_ext >&5\n \n+ac_cv_header_stdc=no\n fi\n-rm -f conftest.err conftest.$ac_objext \\\n-      conftest$ac_exeext conftest.$ac_ext\n-    if test \"$am_cv_func_iconv\" != yes; then\n-      am_save_LIBS=\"$LIBS\"\n-      LIBS=\"$LIBS $LIBICONV\"\n-      if test x$gcc_no_link = xyes; then\n-  { { echo \"$as_me:$LINENO: error: Link tests are not allowed after GCC_NO_EXECUTABLES.\" >&5\n-echo \"$as_me: error: Link tests are not allowed after GCC_NO_EXECUTABLES.\" >&2;}\n-   { (exit 1); exit 1; }; }\n+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext\n+\n+if test $ac_cv_header_stdc = yes; then\n+  # SunOS 4.x string.h does not declare mem*, contrary to ANSI.\n+  cat >conftest.$ac_ext <<_ACEOF\n+/* confdefs.h.  */\n+_ACEOF\n+cat confdefs.h >>conftest.$ac_ext\n+cat >>conftest.$ac_ext <<_ACEOF\n+/* end confdefs.h.  */\n+#include <string.h>\n+\n+_ACEOF\n+if (eval \"$ac_cpp conftest.$ac_ext\") 2>&5 |\n+  $EGREP \"memchr\" >/dev/null 2>&1; then\n+  :\n+else\n+  ac_cv_header_stdc=no\n fi\n-cat >conftest.$ac_ext <<_ACEOF\n+rm -f conftest*\n+\n+fi\n+\n+if test $ac_cv_header_stdc = yes; then\n+  # ISC 2.0.2 stdlib.h does not declare free, contrary to ANSI.\n+  cat >conftest.$ac_ext <<_ACEOF\n /* confdefs.h.  */\n _ACEOF\n cat confdefs.h >>conftest.$ac_ext\n cat >>conftest.$ac_ext <<_ACEOF\n /* end confdefs.h.  */\n #include <stdlib.h>\n-#include <iconv.h>\n+\n+_ACEOF\n+if (eval \"$ac_cpp conftest.$ac_ext\") 2>&5 |\n+  $EGREP \"free\" >/dev/null 2>&1; then\n+  :\n+else\n+  ac_cv_header_stdc=no\n+fi\n+rm -f conftest*\n+\n+fi\n+\n+if test $ac_cv_header_stdc = yes; then\n+  # /bin/cc in Irix-4.0.5 gets non-ANSI ctype macros unless using -ansi.\n+  if test \"$cross_compiling\" = yes; then\n+  :\n+else\n+  cat >conftest.$ac_ext <<_ACEOF\n+/* confdefs.h.  */\n+_ACEOF\n+cat confdefs.h >>conftest.$ac_ext\n+cat >>conftest.$ac_ext <<_ACEOF\n+/* end confdefs.h.  */\n+#include <ctype.h>\n+#if ((' ' & 0x0FF) == 0x020)\n+# define ISLOWER(c) ('a' <= (c) && (c) <= 'z')\n+# define TOUPPER(c) (ISLOWER(c) ? 'A' + ((c) - 'a') : (c))\n+#else\n+# define ISLOWER(c) \\\n+\t\t   (('a' <= (c) && (c) <= 'i') \\\n+\t\t     || ('j' <= (c) && (c) <= 'r') \\\n+\t\t     || ('s' <= (c) && (c) <= 'z'))\n+# define TOUPPER(c) (ISLOWER(c) ? ((c) | 0x40) : (c))\n+#endif\n+\n+#define XOR(e, f) (((e) && !(f)) || (!(e) && (f)))\n int\n main ()\n {\n-iconv_t cd = iconv_open(\"\",\"\");\n-         iconv(cd,NULL,NULL,NULL,NULL);\n-         iconv_close(cd);\n-  ;\n-  return 0;\n+  int i;\n+  for (i = 0; i < 256; i++)\n+    if (XOR (islower (i), ISLOWER (i))\n+\t|| toupper (i) != TOUPPER (i))\n+      exit(2);\n+  exit (0);\n }\n _ACEOF\n-rm -f conftest.$ac_objext conftest$ac_exeext\n+rm -f conftest$ac_exeext\n if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n-  (eval $ac_link) 2>conftest.er1\n-  ac_status=$?\n-  grep -v '^ *+' conftest.er1 >conftest.err\n-  rm -f conftest.er1\n-  cat conftest.err >&5\n-  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n-  (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\n-\t\t\t || test ! -s conftest.err'\n-  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n-  (eval $ac_try) 2>&5\n+  (eval $ac_link) 2>&5\n   ac_status=$?\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n-  (exit $ac_status); }; } &&\n-\t { ac_try='test -s conftest$ac_exeext'\n+  (exit $ac_status); } && { ac_try='./conftest$ac_exeext'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); }; }; then\n-  am_cv_lib_iconv=yes\n-        am_cv_func_iconv=yes\n+  :\n else\n-  echo \"$as_me: failed program was:\" >&5\n+  echo \"$as_me: program exited with status $ac_status\" >&5\n+echo \"$as_me: failed program was:\" >&5\n sed 's/^/| /' conftest.$ac_ext >&5\n \n+( exit $ac_status )\n+ac_cv_header_stdc=no\n fi\n-rm -f conftest.err conftest.$ac_objext \\\n-      conftest$ac_exeext conftest.$ac_ext\n-      LIBS=\"$am_save_LIBS\"\n-    fi\n-\n+rm -f core *.core gmon.out bb.out conftest$ac_exeext conftest.$ac_objext conftest.$ac_ext\n fi\n-echo \"$as_me:$LINENO: result: $am_cv_func_iconv\" >&5\n-echo \"${ECHO_T}$am_cv_func_iconv\" >&6\n-  if test \"$am_cv_func_iconv\" = yes; then\n+fi\n+fi\n+echo \"$as_me:$LINENO: result: $ac_cv_header_stdc\" >&5\n+echo \"${ECHO_T}$ac_cv_header_stdc\" >&6\n+if test $ac_cv_header_stdc = yes; then\n \n cat >>confdefs.h <<\\_ACEOF\n-#define HAVE_ICONV 1\n+#define STDC_HEADERS 1\n _ACEOF\n \n-  fi\n-  if test \"$am_cv_lib_iconv\" = yes; then\n-    echo \"$as_me:$LINENO: checking how to link with libiconv\" >&5\n-echo $ECHO_N \"checking how to link with libiconv... $ECHO_C\" >&6\n-    echo \"$as_me:$LINENO: result: $LIBICONV\" >&5\n-echo \"${ECHO_T}$LIBICONV\" >&6\n-  else\n-            CPPFLAGS=\"$am_save_CPPFLAGS\"\n-    LIBICONV=\n-    LTLIBICONV=\n-  fi\n+fi\n+\n+# On IRIX 5.3, sys/types and inttypes.h are conflicting.\n \n \n \n-  if test \"$am_cv_func_iconv\" = yes; then\n-    echo \"$as_me:$LINENO: checking for iconv declaration\" >&5\n-echo $ECHO_N \"checking for iconv declaration... $ECHO_C\" >&6\n-    if test \"${am_cv_proto_iconv+set}\" = set; then\n+\n+\n+\n+\n+\n+\n+for ac_header in sys/types.h sys/stat.h stdlib.h string.h memory.h strings.h \\\n+\t\t  inttypes.h stdint.h unistd.h\n+do\n+as_ac_Header=`echo \"ac_cv_header_$ac_header\" | $as_tr_sh`\n+echo \"$as_me:$LINENO: checking for $ac_header\" >&5\n+echo $ECHO_N \"checking for $ac_header... $ECHO_C\" >&6\n+if eval \"test \\\"\\${$as_ac_Header+set}\\\" = set\"; then\n   echo $ECHO_N \"(cached) $ECHO_C\" >&6\n else\n-\n-      cat >conftest.$ac_ext <<_ACEOF\n+  cat >conftest.$ac_ext <<_ACEOF\n /* confdefs.h.  */\n _ACEOF\n cat confdefs.h >>conftest.$ac_ext\n cat >>conftest.$ac_ext <<_ACEOF\n /* end confdefs.h.  */\n+$ac_includes_default\n \n-#include <stdlib.h>\n-#include <iconv.h>\n-extern\n-#ifdef __cplusplus\n-\"C\"\n-#endif\n-#if defined(__STDC__) || defined(__cplusplus)\n-size_t iconv (iconv_t cd, char * *inbuf, size_t *inbytesleft, char * *outbuf, size_t *outbytesleft);\n-#else\n-size_t iconv();\n-#endif\n-\n-int\n-main ()\n-{\n-\n-  ;\n-  return 0;\n-}\n+#include <$ac_header>\n _ACEOF\n rm -f conftest.$ac_objext\n if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n@@ -6062,534 +5745,55 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   ac_status=$?\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); }; }; then\n-  am_cv_proto_iconv_arg1=\"\"\n+  eval \"$as_ac_Header=yes\"\n else\n   echo \"$as_me: failed program was:\" >&5\n sed 's/^/| /' conftest.$ac_ext >&5\n \n-am_cv_proto_iconv_arg1=\"const\"\n+eval \"$as_ac_Header=no\"\n fi\n rm -f conftest.err conftest.$ac_objext conftest.$ac_ext\n-      am_cv_proto_iconv=\"extern size_t iconv (iconv_t cd, $am_cv_proto_iconv_arg1 char * *inbuf, size_t *inbytesleft, char * *outbuf, size_t *outbytesleft);\"\n fi\n+echo \"$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`\" >&5\n+echo \"${ECHO_T}`eval echo '${'$as_ac_Header'}'`\" >&6\n+if test `eval echo '${'$as_ac_Header'}'` = yes; then\n+  cat >>confdefs.h <<_ACEOF\n+#define `echo \"HAVE_$ac_header\" | $as_tr_cpp` 1\n+_ACEOF\n \n-    am_cv_proto_iconv=`echo \"$am_cv_proto_iconv\" | tr -s ' ' | sed -e 's/( /(/'`\n-    echo \"$as_me:$LINENO: result: ${ac_t:-\n-         }$am_cv_proto_iconv\" >&5\n-echo \"${ECHO_T}${ac_t:-\n-         }$am_cv_proto_iconv\" >&6\n+fi\n \n-cat >>confdefs.h <<_ACEOF\n-#define ICONV_CONST $am_cv_proto_iconv_arg1\n-_ACEOF\n+done\n \n-  fi\n \n \n-# Possibly disable most of the library.\n-## TODO: Consider skipping unncessary tests altogether in this case, rather\n-## than just ignoring the results.  Faster /and/ more correct, win win.\n+  echo \"$as_me:$LINENO: checking for C locale to use\" >&5\n+echo $ECHO_N \"checking for C locale to use... $ECHO_C\" >&6\n+   # Check whether --enable-clocale or --disable-clocale was given.\n+if test \"${enable_clocale+set}\" = set; then\n+  enableval=\"$enable_clocale\"\n \n-  # Check whether --enable-hosted-libstdcxx or --disable-hosted-libstdcxx was given.\n-if test \"${enable_hosted_libstdcxx+set}\" = set; then\n-  enableval=\"$enable_hosted_libstdcxx\"\n+      case \"$enableval\" in\n+       generic|gnu|ieee_1003.1-2001|yes|no|auto) ;;\n+       *) { { echo \"$as_me:$LINENO: error: Unknown argument to enable/disable clocale\" >&5\n+echo \"$as_me: error: Unknown argument to enable/disable clocale\" >&2;}\n+   { (exit 1); exit 1; }; } ;;\n+                          esac\n \n else\n-  case \"$host\" in\n-\tarm*-*-symbianelf*)\n-\t    enable_hosted_libstdcxx=no\n-\t    ;;\n-        *)\n-\t    enable_hosted_libstdcxx=yes\n-\t    ;;\n-     esac\n+  enable_clocale=auto\n fi;\n-  if test \"$enable_hosted_libstdcxx\" = no; then\n-    { echo \"$as_me:$LINENO: Only freestanding libraries will be built\" >&5\n-echo \"$as_me: Only freestanding libraries will be built\" >&6;}\n-    is_hosted=no\n-    hosted_define=0\n-    enable_abi_check=no\n-    enable_libstdcxx_pch=no\n-  else\n-    is_hosted=yes\n-    hosted_define=1\n-  fi\n-\n-\n-cat >>confdefs.h <<_ACEOF\n-#define _GLIBCXX_HOSTED $hosted_define\n-_ACEOF\n-\n-\n \n-# Check for compiler support that doesn't require linking.\n \n-  echo \"$as_me:$LINENO: checking for exception model to use\" >&5\n-echo $ECHO_N \"checking for exception model to use... $ECHO_C\" >&6\n+  # If they didn't use this option switch, or if they specified --enable\n+  # with no specific model, we'll have to look for one.  If they\n+  # specified --disable (???), do likewise.\n+  if test $enable_clocale = no || test $enable_clocale = yes; then\n+     enable_clocale=auto\n+  fi\n \n-\n-  ac_ext=cc\n-ac_cpp='$CXXCPP $CPPFLAGS'\n-ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'\n-ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'\n-ac_compiler_gnu=$ac_cv_cxx_compiler_gnu\n-\n-   # Check whether --enable-sjlj-exceptions or --disable-sjlj-exceptions was given.\n-if test \"${enable_sjlj_exceptions+set}\" = set; then\n-  enableval=\"$enable_sjlj_exceptions\"\n-\n-      case \"$enableval\" in\n-       yes|no|auto) ;;\n-       *) { { echo \"$as_me:$LINENO: error: Unknown argument to enable/disable sjlj-exceptions\" >&5\n-echo \"$as_me: error: Unknown argument to enable/disable sjlj-exceptions\" >&2;}\n-   { (exit 1); exit 1; }; } ;;\n-                          esac\n-\n-else\n-  enable_sjlj_exceptions=auto\n-fi;\n-\n-\n-  if test $enable_sjlj_exceptions = auto; then\n-    # Botheration.  Now we've got to detect the exception model.  Link tests\n-    # against libgcc.a are problematic since we've not been given proper -L\n-    # bits for single-tree newlib and libgloss.\n-    #\n-    # Fake what AC_TRY_COMPILE does.  XXX Look at redoing this new-style.\n-    cat > conftest.$ac_ext << EOF\n-#line 6161 \"configure\"\n-struct S { ~S(); };\n-void bar();\n-void foo()\n-{\n-  S s;\n-  bar();\n-}\n-EOF\n-    old_CXXFLAGS=\"$CXXFLAGS\"\n-    CXXFLAGS=-S\n-    if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n-  (eval $ac_compile) 2>&5\n-  ac_status=$?\n-  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n-  (exit $ac_status); }; then\n-      if grep _Unwind_SjLj_Resume conftest.s >/dev/null 2>&1 ; then\n-        enable_sjlj_exceptions=yes\n-      elif grep _Unwind_Resume conftest.s >/dev/null 2>&1 ; then\n-        enable_sjlj_exceptions=no\n-      elif grep __cxa_end_cleanup conftest.s >/dev/null 2>&1 ; then\n-        enable_sjlj_exceptions=no\n-      fi\n-    fi\n-    CXXFLAGS=\"$old_CXXFLAGS\"\n-    rm -f conftest*\n-  fi\n-\n-  # This is a tad weird, for hysterical raisins.  We have to map\n-  # enable/disable to two different models.\n-  case $enable_sjlj_exceptions in\n-    yes)\n-\n-cat >>confdefs.h <<\\_ACEOF\n-#define _GLIBCXX_SJLJ_EXCEPTIONS 1\n-_ACEOF\n-\n-      ac_exception_model_name=sjlj\n-      ;;\n-    no)\n-      ac_exception_model_name=\"call frame\"\n-      ;;\n-    *)\n-      { { echo \"$as_me:$LINENO: error: unable to detect exception model\" >&5\n-echo \"$as_me: error: unable to detect exception model\" >&2;}\n-   { (exit 1); exit 1; }; }\n-      ;;\n-  esac\n- ac_ext=c\n-ac_cpp='$CPP $CPPFLAGS'\n-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'\n-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'\n-ac_compiler_gnu=$ac_cv_c_compiler_gnu\n-\n- echo \"$as_me:$LINENO: result: $ac_exception_model_name\" >&5\n-echo \"${ECHO_T}$ac_exception_model_name\" >&6\n-\n-\n-   # Check whether --enable-libstdcxx-pch or --disable-libstdcxx-pch was given.\n-if test \"${enable_libstdcxx_pch+set}\" = set; then\n-  enableval=\"$enable_libstdcxx_pch\"\n-\n-      case \"$enableval\" in\n-       yes|no) ;;\n-       *) { { echo \"$as_me:$LINENO: error: Argument to enable/disable libstdcxx-pch must be yes or no\" >&5\n-echo \"$as_me: error: Argument to enable/disable libstdcxx-pch must be yes or no\" >&2;}\n-   { (exit 1); exit 1; }; } ;;\n-      esac\n-\n-else\n-  enable_libstdcxx_pch=$is_hosted\n-fi;\n-\n-  if test $enable_libstdcxx_pch = yes; then\n-    echo \"$as_me:$LINENO: checking for compiler with PCH support\" >&5\n-echo $ECHO_N \"checking for compiler with PCH support... $ECHO_C\" >&6\n-if test \"${glibcxx_cv_prog_CXX_pch+set}\" = set; then\n-  echo $ECHO_N \"(cached) $ECHO_C\" >&6\n-else\n-  ac_save_CXXFLAGS=\"$CXXFLAGS\"\n-       CXXFLAGS=\"$CXXFLAGS -Werror -Winvalid-pch -Wno-deprecated\"\n-\n-\n-       ac_ext=cc\n-ac_cpp='$CXXCPP $CPPFLAGS'\n-ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'\n-ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'\n-ac_compiler_gnu=$ac_cv_cxx_compiler_gnu\n-\n-       echo '#include <math.h>' > conftest.h\n-       if $CXX $CXXFLAGS $CPPFLAGS -x c++-header conftest.h \\\n-\t\t          -o conftest.h.gch 1>&5 2>&1 &&\n-\t        echo '#error \"pch failed\"' > conftest.h &&\n-          echo '#include \"conftest.h\"' > conftest.cc &&\n-\t       $CXX -c $CXXFLAGS $CPPFLAGS conftest.cc 1>&5 2>&1 ;\n-       then\n-         glibcxx_cv_prog_CXX_pch=yes\n-       else\n-         glibcxx_cv_prog_CXX_pch=no\n-       fi\n-       rm -f conftest*\n-       CXXFLAGS=$ac_save_CXXFLAGS\n-       ac_ext=c\n-ac_cpp='$CPP $CPPFLAGS'\n-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'\n-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'\n-ac_compiler_gnu=$ac_cv_c_compiler_gnu\n-\n-\n-fi\n-echo \"$as_me:$LINENO: result: $glibcxx_cv_prog_CXX_pch\" >&5\n-echo \"${ECHO_T}$glibcxx_cv_prog_CXX_pch\" >&6\n-    enable_libstdcxx_pch=$glibcxx_cv_prog_CXX_pch\n-  fi\n-\n-  echo \"$as_me:$LINENO: checking for enabled PCH\" >&5\n-echo $ECHO_N \"checking for enabled PCH... $ECHO_C\" >&6\n-  echo \"$as_me:$LINENO: result: $enable_libstdcxx_pch\" >&5\n-echo \"${ECHO_T}$enable_libstdcxx_pch\" >&6\n-\n-\n-  if test $enable_libstdcxx_pch = yes; then\n-    glibcxx_PCHFLAGS=\"-include bits/stdtr1c++.h\"\n-  else\n-    glibcxx_PCHFLAGS=\"\"\n-  fi\n-\n-\n-\n-# Enable all the variable C++ runtime options.\n-\n-  echo \"$as_me:$LINENO: checking for underlying I/O to use\" >&5\n-echo $ECHO_N \"checking for underlying I/O to use... $ECHO_C\" >&6\n-   # Check whether --enable-cstdio or --disable-cstdio was given.\n-if test \"${enable_cstdio+set}\" = set; then\n-  enableval=\"$enable_cstdio\"\n-\n-      case \"$enableval\" in\n-       stdio) ;;\n-       *) { { echo \"$as_me:$LINENO: error: Unknown argument to enable/disable cstdio\" >&5\n-echo \"$as_me: error: Unknown argument to enable/disable cstdio\" >&2;}\n-   { (exit 1); exit 1; }; } ;;\n-                          esac\n-\n-else\n-  enable_cstdio=stdio\n-fi;\n-\n-\n-  # Now that libio has been removed, you can have any color you want as long\n-  # as it's black.  This is one big no-op until other packages are added, but\n-  # showing the framework never hurts.\n-  case ${enable_cstdio} in\n-    stdio)\n-      CSTDIO_H=config/io/c_io_stdio.h\n-      BASIC_FILE_H=config/io/basic_file_stdio.h\n-      BASIC_FILE_CC=config/io/basic_file_stdio.cc\n-      echo \"$as_me:$LINENO: result: stdio\" >&5\n-echo \"${ECHO_T}stdio\" >&6\n-      ;;\n-  esac\n-\n-\n-\n-\n-\n-echo \"$as_me:$LINENO: checking for ANSI C header files\" >&5\n-echo $ECHO_N \"checking for ANSI C header files... $ECHO_C\" >&6\n-if test \"${ac_cv_header_stdc+set}\" = set; then\n-  echo $ECHO_N \"(cached) $ECHO_C\" >&6\n-else\n-  cat >conftest.$ac_ext <<_ACEOF\n-/* confdefs.h.  */\n-_ACEOF\n-cat confdefs.h >>conftest.$ac_ext\n-cat >>conftest.$ac_ext <<_ACEOF\n-/* end confdefs.h.  */\n-#include <stdlib.h>\n-#include <stdarg.h>\n-#include <string.h>\n-#include <float.h>\n-\n-int\n-main ()\n-{\n-\n-  ;\n-  return 0;\n-}\n-_ACEOF\n-rm -f conftest.$ac_objext\n-if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n-  (eval $ac_compile) 2>conftest.er1\n-  ac_status=$?\n-  grep -v '^ *+' conftest.er1 >conftest.err\n-  rm -f conftest.er1\n-  cat conftest.err >&5\n-  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n-  (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\n-\t\t\t || test ! -s conftest.err'\n-  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n-  (eval $ac_try) 2>&5\n-  ac_status=$?\n-  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n-  (exit $ac_status); }; } &&\n-\t { ac_try='test -s conftest.$ac_objext'\n-  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n-  (eval $ac_try) 2>&5\n-  ac_status=$?\n-  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n-  (exit $ac_status); }; }; then\n-  ac_cv_header_stdc=yes\n-else\n-  echo \"$as_me: failed program was:\" >&5\n-sed 's/^/| /' conftest.$ac_ext >&5\n-\n-ac_cv_header_stdc=no\n-fi\n-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext\n-\n-if test $ac_cv_header_stdc = yes; then\n-  # SunOS 4.x string.h does not declare mem*, contrary to ANSI.\n-  cat >conftest.$ac_ext <<_ACEOF\n-/* confdefs.h.  */\n-_ACEOF\n-cat confdefs.h >>conftest.$ac_ext\n-cat >>conftest.$ac_ext <<_ACEOF\n-/* end confdefs.h.  */\n-#include <string.h>\n-\n-_ACEOF\n-if (eval \"$ac_cpp conftest.$ac_ext\") 2>&5 |\n-  $EGREP \"memchr\" >/dev/null 2>&1; then\n-  :\n-else\n-  ac_cv_header_stdc=no\n-fi\n-rm -f conftest*\n-\n-fi\n-\n-if test $ac_cv_header_stdc = yes; then\n-  # ISC 2.0.2 stdlib.h does not declare free, contrary to ANSI.\n-  cat >conftest.$ac_ext <<_ACEOF\n-/* confdefs.h.  */\n-_ACEOF\n-cat confdefs.h >>conftest.$ac_ext\n-cat >>conftest.$ac_ext <<_ACEOF\n-/* end confdefs.h.  */\n-#include <stdlib.h>\n-\n-_ACEOF\n-if (eval \"$ac_cpp conftest.$ac_ext\") 2>&5 |\n-  $EGREP \"free\" >/dev/null 2>&1; then\n-  :\n-else\n-  ac_cv_header_stdc=no\n-fi\n-rm -f conftest*\n-\n-fi\n-\n-if test $ac_cv_header_stdc = yes; then\n-  # /bin/cc in Irix-4.0.5 gets non-ANSI ctype macros unless using -ansi.\n-  if test \"$cross_compiling\" = yes; then\n-  :\n-else\n-  cat >conftest.$ac_ext <<_ACEOF\n-/* confdefs.h.  */\n-_ACEOF\n-cat confdefs.h >>conftest.$ac_ext\n-cat >>conftest.$ac_ext <<_ACEOF\n-/* end confdefs.h.  */\n-#include <ctype.h>\n-#if ((' ' & 0x0FF) == 0x020)\n-# define ISLOWER(c) ('a' <= (c) && (c) <= 'z')\n-# define TOUPPER(c) (ISLOWER(c) ? 'A' + ((c) - 'a') : (c))\n-#else\n-# define ISLOWER(c) \\\n-\t\t   (('a' <= (c) && (c) <= 'i') \\\n-\t\t     || ('j' <= (c) && (c) <= 'r') \\\n-\t\t     || ('s' <= (c) && (c) <= 'z'))\n-# define TOUPPER(c) (ISLOWER(c) ? ((c) | 0x40) : (c))\n-#endif\n-\n-#define XOR(e, f) (((e) && !(f)) || (!(e) && (f)))\n-int\n-main ()\n-{\n-  int i;\n-  for (i = 0; i < 256; i++)\n-    if (XOR (islower (i), ISLOWER (i))\n-\t|| toupper (i) != TOUPPER (i))\n-      exit(2);\n-  exit (0);\n-}\n-_ACEOF\n-rm -f conftest$ac_exeext\n-if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n-  (eval $ac_link) 2>&5\n-  ac_status=$?\n-  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n-  (exit $ac_status); } && { ac_try='./conftest$ac_exeext'\n-  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n-  (eval $ac_try) 2>&5\n-  ac_status=$?\n-  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n-  (exit $ac_status); }; }; then\n-  :\n-else\n-  echo \"$as_me: program exited with status $ac_status\" >&5\n-echo \"$as_me: failed program was:\" >&5\n-sed 's/^/| /' conftest.$ac_ext >&5\n-\n-( exit $ac_status )\n-ac_cv_header_stdc=no\n-fi\n-rm -f core *.core gmon.out bb.out conftest$ac_exeext conftest.$ac_objext conftest.$ac_ext\n-fi\n-fi\n-fi\n-echo \"$as_me:$LINENO: result: $ac_cv_header_stdc\" >&5\n-echo \"${ECHO_T}$ac_cv_header_stdc\" >&6\n-if test $ac_cv_header_stdc = yes; then\n-\n-cat >>confdefs.h <<\\_ACEOF\n-#define STDC_HEADERS 1\n-_ACEOF\n-\n-fi\n-\n-# On IRIX 5.3, sys/types and inttypes.h are conflicting.\n-\n-\n-\n-\n-\n-\n-\n-\n-\n-for ac_header in sys/types.h sys/stat.h stdlib.h string.h memory.h strings.h \\\n-\t\t  inttypes.h stdint.h unistd.h\n-do\n-as_ac_Header=`echo \"ac_cv_header_$ac_header\" | $as_tr_sh`\n-echo \"$as_me:$LINENO: checking for $ac_header\" >&5\n-echo $ECHO_N \"checking for $ac_header... $ECHO_C\" >&6\n-if eval \"test \\\"\\${$as_ac_Header+set}\\\" = set\"; then\n-  echo $ECHO_N \"(cached) $ECHO_C\" >&6\n-else\n-  cat >conftest.$ac_ext <<_ACEOF\n-/* confdefs.h.  */\n-_ACEOF\n-cat confdefs.h >>conftest.$ac_ext\n-cat >>conftest.$ac_ext <<_ACEOF\n-/* end confdefs.h.  */\n-$ac_includes_default\n-\n-#include <$ac_header>\n-_ACEOF\n-rm -f conftest.$ac_objext\n-if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n-  (eval $ac_compile) 2>conftest.er1\n-  ac_status=$?\n-  grep -v '^ *+' conftest.er1 >conftest.err\n-  rm -f conftest.er1\n-  cat conftest.err >&5\n-  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n-  (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\n-\t\t\t || test ! -s conftest.err'\n-  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n-  (eval $ac_try) 2>&5\n-  ac_status=$?\n-  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n-  (exit $ac_status); }; } &&\n-\t { ac_try='test -s conftest.$ac_objext'\n-  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n-  (eval $ac_try) 2>&5\n-  ac_status=$?\n-  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n-  (exit $ac_status); }; }; then\n-  eval \"$as_ac_Header=yes\"\n-else\n-  echo \"$as_me: failed program was:\" >&5\n-sed 's/^/| /' conftest.$ac_ext >&5\n-\n-eval \"$as_ac_Header=no\"\n-fi\n-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext\n-fi\n-echo \"$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`\" >&5\n-echo \"${ECHO_T}`eval echo '${'$as_ac_Header'}'`\" >&6\n-if test `eval echo '${'$as_ac_Header'}'` = yes; then\n-  cat >>confdefs.h <<_ACEOF\n-#define `echo \"HAVE_$ac_header\" | $as_tr_cpp` 1\n-_ACEOF\n-\n-fi\n-\n-done\n-\n-\n-\n-  echo \"$as_me:$LINENO: checking for C locale to use\" >&5\n-echo $ECHO_N \"checking for C locale to use... $ECHO_C\" >&6\n-   # Check whether --enable-clocale or --disable-clocale was given.\n-if test \"${enable_clocale+set}\" = set; then\n-  enableval=\"$enable_clocale\"\n-\n-      case \"$enableval\" in\n-       generic|gnu|ieee_1003.1-2001|yes|no|auto) ;;\n-       *) { { echo \"$as_me:$LINENO: error: Unknown argument to enable/disable clocale\" >&5\n-echo \"$as_me: error: Unknown argument to enable/disable clocale\" >&2;}\n-   { (exit 1); exit 1; }; } ;;\n-                          esac\n-\n-else\n-  enable_clocale=auto\n-fi;\n-\n-\n-  # If they didn't use this option switch, or if they specified --enable\n-  # with no specific model, we'll have to look for one.  If they\n-  # specified --disable (???), do likewise.\n-  if test $enable_clocale = no || test $enable_clocale = yes; then\n-     enable_clocale=auto\n-  fi\n-\n-  # Either a known package, or \"auto\"\n-  enable_clocale_flag=$enable_clocale\n+  # Either a known package, or \"auto\"\n+  enable_clocale_flag=$enable_clocale\n \n   # Probe for locale support if no specific model is specified.\n   # Default to \"generic\".\n@@ -8814,7 +8018,7 @@ ac_compiler_gnu=$ac_cv_cxx_compiler_gnu\n \n   # Fake what AC_TRY_COMPILE does.  XXX Look at redoing this new-style.\n     cat > conftest.$ac_ext << EOF\n-#line 8817 \"configure\"\n+#line 8021 \"configure\"\n int main()\n {\n   // NB: _Atomic_word not necessarily int.\n@@ -31565,7 +30769,7 @@ if test \"${have_tls+set}\" = set; then\n else\n \n     if test \"$cross_compiling\" = yes; then\n-  if test x$gcc_no_link = xyes; then\n+                if test x$gcc_no_link = xyes; then\n   { { echo \"$as_me:$LINENO: error: Link tests are not allowed after GCC_NO_EXECUTABLES.\" >&5\n echo \"$as_me: error: Link tests are not allowed after GCC_NO_EXECUTABLES.\" >&2;}\n    { (exit 1); exit 1; }; }\n@@ -31605,6 +30809,7 @@ fi\n rm -f conftest.err conftest.$ac_objext \\\n       conftest$ac_exeext conftest.$ac_ext\n \n+\n else\n   cat >conftest.$ac_ext <<_ACEOF\n __thread int a; int b; int main() { return a = b; }\n@@ -32439,202 +31644,1000 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   ac_status=$?\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); }; }; then\n-  eval \"$as_ac_var=yes\"\n+  eval \"$as_ac_var=yes\"\n+else\n+  echo \"$as_me: failed program was:\" >&5\n+sed 's/^/| /' conftest.$ac_ext >&5\n+\n+eval \"$as_ac_var=no\"\n+fi\n+rm -f conftest.err conftest.$ac_objext \\\n+      conftest$ac_exeext conftest.$ac_ext\n+fi\n+echo \"$as_me:$LINENO: result: `eval echo '${'$as_ac_var'}'`\" >&5\n+echo \"${ECHO_T}`eval echo '${'$as_ac_var'}'`\" >&6\n+if test `eval echo '${'$as_ac_var'}'` = yes; then\n+  cat >>confdefs.h <<_ACEOF\n+#define `echo \"HAVE_$ac_func\" | $as_tr_cpp` 1\n+_ACEOF\n+\n+fi\n+done\n+\n+echo \"$as_me:$LINENO: checking for working mmap\" >&5\n+echo $ECHO_N \"checking for working mmap... $ECHO_C\" >&6\n+if test \"${ac_cv_func_mmap_fixed_mapped+set}\" = set; then\n+  echo $ECHO_N \"(cached) $ECHO_C\" >&6\n+else\n+  if test \"$cross_compiling\" = yes; then\n+  ac_cv_func_mmap_fixed_mapped=no\n+else\n+  cat >conftest.$ac_ext <<_ACEOF\n+/* confdefs.h.  */\n+_ACEOF\n+cat confdefs.h >>conftest.$ac_ext\n+cat >>conftest.$ac_ext <<_ACEOF\n+/* end confdefs.h.  */\n+$ac_includes_default\n+/* malloc might have been renamed as rpl_malloc. */\n+#undef malloc\n+\n+/* Thanks to Mike Haertel and Jim Avera for this test.\n+   Here is a matrix of mmap possibilities:\n+\tmmap private not fixed\n+\tmmap private fixed at somewhere currently unmapped\n+\tmmap private fixed at somewhere already mapped\n+\tmmap shared not fixed\n+\tmmap shared fixed at somewhere currently unmapped\n+\tmmap shared fixed at somewhere already mapped\n+   For private mappings, we should verify that changes cannot be read()\n+   back from the file, nor mmap's back from the file at a different\n+   address.  (There have been systems where private was not correctly\n+   implemented like the infamous i386 svr4.0, and systems where the\n+   VM page cache was not coherent with the file system buffer cache\n+   like early versions of FreeBSD and possibly contemporary NetBSD.)\n+   For shared mappings, we should conversely verify that changes get\n+   propagated back to all the places they're supposed to be.\n+\n+   Grep wants private fixed already mapped.\n+   The main things grep needs to know about mmap are:\n+   * does it exist and is it safe to write into the mmap'd area\n+   * how to use it (BSD variants)  */\n+\n+#include <fcntl.h>\n+#include <sys/mman.h>\n+\n+#if !STDC_HEADERS && !HAVE_STDLIB_H\n+char *malloc ();\n+#endif\n+\n+/* This mess was copied from the GNU getpagesize.h.  */\n+#if !HAVE_GETPAGESIZE\n+/* Assume that all systems that can run configure have sys/param.h.  */\n+# if !HAVE_SYS_PARAM_H\n+#  define HAVE_SYS_PARAM_H 1\n+# endif\n+\n+# ifdef _SC_PAGESIZE\n+#  define getpagesize() sysconf(_SC_PAGESIZE)\n+# else /* no _SC_PAGESIZE */\n+#  if HAVE_SYS_PARAM_H\n+#   include <sys/param.h>\n+#   ifdef EXEC_PAGESIZE\n+#    define getpagesize() EXEC_PAGESIZE\n+#   else /* no EXEC_PAGESIZE */\n+#    ifdef NBPG\n+#     define getpagesize() NBPG * CLSIZE\n+#     ifndef CLSIZE\n+#      define CLSIZE 1\n+#     endif /* no CLSIZE */\n+#    else /* no NBPG */\n+#     ifdef NBPC\n+#      define getpagesize() NBPC\n+#     else /* no NBPC */\n+#      ifdef PAGESIZE\n+#       define getpagesize() PAGESIZE\n+#      endif /* PAGESIZE */\n+#     endif /* no NBPC */\n+#    endif /* no NBPG */\n+#   endif /* no EXEC_PAGESIZE */\n+#  else /* no HAVE_SYS_PARAM_H */\n+#   define getpagesize() 8192\t/* punt totally */\n+#  endif /* no HAVE_SYS_PARAM_H */\n+# endif /* no _SC_PAGESIZE */\n+\n+#endif /* no HAVE_GETPAGESIZE */\n+\n+int\n+main ()\n+{\n+  char *data, *data2, *data3;\n+  int i, pagesize;\n+  int fd;\n+\n+  pagesize = getpagesize ();\n+\n+  /* First, make a file with some known garbage in it. */\n+  data = (char *) malloc (pagesize);\n+  if (!data)\n+    exit (1);\n+  for (i = 0; i < pagesize; ++i)\n+    *(data + i) = rand ();\n+  umask (0);\n+  fd = creat (\"conftest.mmap\", 0600);\n+  if (fd < 0)\n+    exit (1);\n+  if (write (fd, data, pagesize) != pagesize)\n+    exit (1);\n+  close (fd);\n+\n+  /* Next, try to mmap the file at a fixed address which already has\n+     something else allocated at it.  If we can, also make sure that\n+     we see the same garbage.  */\n+  fd = open (\"conftest.mmap\", O_RDWR);\n+  if (fd < 0)\n+    exit (1);\n+  data2 = (char *) malloc (2 * pagesize);\n+  if (!data2)\n+    exit (1);\n+  data2 += (pagesize - ((long) data2 & (pagesize - 1))) & (pagesize - 1);\n+  if (data2 != mmap (data2, pagesize, PROT_READ | PROT_WRITE,\n+\t\t     MAP_PRIVATE | MAP_FIXED, fd, 0L))\n+    exit (1);\n+  for (i = 0; i < pagesize; ++i)\n+    if (*(data + i) != *(data2 + i))\n+      exit (1);\n+\n+  /* Finally, make sure that changes to the mapped area do not\n+     percolate back to the file as seen by read().  (This is a bug on\n+     some variants of i386 svr4.0.)  */\n+  for (i = 0; i < pagesize; ++i)\n+    *(data2 + i) = *(data2 + i) + 1;\n+  data3 = (char *) malloc (pagesize);\n+  if (!data3)\n+    exit (1);\n+  if (read (fd, data3, pagesize) != pagesize)\n+    exit (1);\n+  for (i = 0; i < pagesize; ++i)\n+    if (*(data + i) != *(data3 + i))\n+      exit (1);\n+  close (fd);\n+  exit (0);\n+}\n+_ACEOF\n+rm -f conftest$ac_exeext\n+if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n+  (eval $ac_link) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); } && { ac_try='./conftest$ac_exeext'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; }; then\n+  ac_cv_func_mmap_fixed_mapped=yes\n+else\n+  echo \"$as_me: program exited with status $ac_status\" >&5\n+echo \"$as_me: failed program was:\" >&5\n+sed 's/^/| /' conftest.$ac_ext >&5\n+\n+( exit $ac_status )\n+ac_cv_func_mmap_fixed_mapped=no\n+fi\n+rm -f core *.core gmon.out bb.out conftest$ac_exeext conftest.$ac_objext conftest.$ac_ext\n+fi\n+fi\n+echo \"$as_me:$LINENO: result: $ac_cv_func_mmap_fixed_mapped\" >&5\n+echo \"${ECHO_T}$ac_cv_func_mmap_fixed_mapped\" >&6\n+if test $ac_cv_func_mmap_fixed_mapped = yes; then\n+\n+cat >>confdefs.h <<\\_ACEOF\n+#define HAVE_MMAP 1\n+_ACEOF\n+\n+fi\n+rm -f conftest.mmap\n+\n+fi\n+\n+  # For iconv support.\n+\n+      if test \"X$prefix\" = \"XNONE\"; then\n+    acl_final_prefix=\"$ac_default_prefix\"\n+  else\n+    acl_final_prefix=\"$prefix\"\n+  fi\n+  if test \"X$exec_prefix\" = \"XNONE\"; then\n+    acl_final_exec_prefix='${prefix}'\n+  else\n+    acl_final_exec_prefix=\"$exec_prefix\"\n+  fi\n+  acl_save_prefix=\"$prefix\"\n+  prefix=\"$acl_final_prefix\"\n+  eval acl_final_exec_prefix=\\\"$acl_final_exec_prefix\\\"\n+  prefix=\"$acl_save_prefix\"\n+\n+\n+# Check whether --with-gnu-ld or --without-gnu-ld was given.\n+if test \"${with_gnu_ld+set}\" = set; then\n+  withval=\"$with_gnu_ld\"\n+  test \"$withval\" = no || with_gnu_ld=yes\n+else\n+  with_gnu_ld=no\n+fi;\n+# Prepare PATH_SEPARATOR.\n+# The user is always right.\n+if test \"${PATH_SEPARATOR+set}\" != set; then\n+  echo \"#! /bin/sh\" >conf$$.sh\n+  echo  \"exit 0\"   >>conf$$.sh\n+  chmod +x conf$$.sh\n+  if (PATH=\"/nonexistent;.\"; conf$$.sh) >/dev/null 2>&1; then\n+    PATH_SEPARATOR=';'\n+  else\n+    PATH_SEPARATOR=:\n+  fi\n+  rm -f conf$$.sh\n+fi\n+ac_prog=ld\n+if test \"$GCC\" = yes; then\n+  # Check if gcc -print-prog-name=ld gives a path.\n+  echo \"$as_me:$LINENO: checking for ld used by GCC\" >&5\n+echo $ECHO_N \"checking for ld used by GCC... $ECHO_C\" >&6\n+  case $host in\n+  *-*-mingw*)\n+    # gcc leaves a trailing carriage return which upsets mingw\n+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\\015'` ;;\n+  *)\n+    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;\n+  esac\n+  case $ac_prog in\n+    # Accept absolute paths.\n+    [\\\\/]* | [A-Za-z]:[\\\\/]*)\n+      re_direlt='/[^/][^/]*/\\.\\./'\n+      # Canonicalize the path of ld\n+      ac_prog=`echo $ac_prog| sed 's%\\\\\\\\%/%g'`\n+      while echo $ac_prog | grep \"$re_direlt\" > /dev/null 2>&1; do\n+\tac_prog=`echo $ac_prog| sed \"s%$re_direlt%/%\"`\n+      done\n+      test -z \"$LD\" && LD=\"$ac_prog\"\n+      ;;\n+  \"\")\n+    # If it fails, then pretend we aren't using GCC.\n+    ac_prog=ld\n+    ;;\n+  *)\n+    # If it is relative, then search for the first ld in PATH.\n+    with_gnu_ld=unknown\n+    ;;\n+  esac\n+elif test \"$with_gnu_ld\" = yes; then\n+  echo \"$as_me:$LINENO: checking for GNU ld\" >&5\n+echo $ECHO_N \"checking for GNU ld... $ECHO_C\" >&6\n+else\n+  echo \"$as_me:$LINENO: checking for non-GNU ld\" >&5\n+echo $ECHO_N \"checking for non-GNU ld... $ECHO_C\" >&6\n+fi\n+if test \"${acl_cv_path_LD+set}\" = set; then\n+  echo $ECHO_N \"(cached) $ECHO_C\" >&6\n+else\n+  if test -z \"$LD\"; then\n+  IFS=\"${IFS= \t}\"; ac_save_ifs=\"$IFS\"; IFS=\"${IFS}${PATH_SEPARATOR-:}\"\n+  for ac_dir in $PATH; do\n+    test -z \"$ac_dir\" && ac_dir=.\n+    if test -f \"$ac_dir/$ac_prog\" || test -f \"$ac_dir/$ac_prog$ac_exeext\"; then\n+      acl_cv_path_LD=\"$ac_dir/$ac_prog\"\n+      # Check to see if the program is GNU ld.  I'd rather use --version,\n+      # but apparently some GNU ld's only accept -v.\n+      # Break only if it was the GNU/non-GNU ld that we prefer.\n+      if \"$acl_cv_path_LD\" -v 2>&1 < /dev/null | egrep '(GNU|with BFD)' > /dev/null; then\n+\ttest \"$with_gnu_ld\" != no && break\n+      else\n+\ttest \"$with_gnu_ld\" != yes && break\n+      fi\n+    fi\n+  done\n+  IFS=\"$ac_save_ifs\"\n+else\n+  acl_cv_path_LD=\"$LD\" # Let the user override the test with a path.\n+fi\n+fi\n+\n+LD=\"$acl_cv_path_LD\"\n+if test -n \"$LD\"; then\n+  echo \"$as_me:$LINENO: result: $LD\" >&5\n+echo \"${ECHO_T}$LD\" >&6\n+else\n+  echo \"$as_me:$LINENO: result: no\" >&5\n+echo \"${ECHO_T}no\" >&6\n+fi\n+test -z \"$LD\" && { { echo \"$as_me:$LINENO: error: no acceptable ld found in \\$PATH\" >&5\n+echo \"$as_me: error: no acceptable ld found in \\$PATH\" >&2;}\n+   { (exit 1); exit 1; }; }\n+echo \"$as_me:$LINENO: checking if the linker ($LD) is GNU ld\" >&5\n+echo $ECHO_N \"checking if the linker ($LD) is GNU ld... $ECHO_C\" >&6\n+if test \"${acl_cv_prog_gnu_ld+set}\" = set; then\n+  echo $ECHO_N \"(cached) $ECHO_C\" >&6\n+else\n+  # I'd rather use --version here, but apparently some GNU ld's only accept -v.\n+if $LD -v 2>&1 </dev/null | egrep '(GNU|with BFD)' 1>&5; then\n+  acl_cv_prog_gnu_ld=yes\n+else\n+  acl_cv_prog_gnu_ld=no\n+fi\n+fi\n+echo \"$as_me:$LINENO: result: $acl_cv_prog_gnu_ld\" >&5\n+echo \"${ECHO_T}$acl_cv_prog_gnu_ld\" >&6\n+with_gnu_ld=$acl_cv_prog_gnu_ld\n+\n+\n+\n+                                                echo \"$as_me:$LINENO: checking for shared library run path origin\" >&5\n+echo $ECHO_N \"checking for shared library run path origin... $ECHO_C\" >&6\n+if test \"${acl_cv_rpath+set}\" = set; then\n+  echo $ECHO_N \"(cached) $ECHO_C\" >&6\n+else\n+\n+    CC=\"$CC\" GCC=\"$GCC\" LDFLAGS=\"$LDFLAGS\" LD=\"$LD\" with_gnu_ld=\"$with_gnu_ld\" \\\n+    ${CONFIG_SHELL-/bin/sh} \"$ac_aux_dir/config.rpath\" \"$host\" > conftest.sh\n+    . ./conftest.sh\n+    rm -f ./conftest.sh\n+    acl_cv_rpath=done\n+\n+fi\n+echo \"$as_me:$LINENO: result: $acl_cv_rpath\" >&5\n+echo \"${ECHO_T}$acl_cv_rpath\" >&6\n+  wl=\"$acl_cv_wl\"\n+  libext=\"$acl_cv_libext\"\n+  shlibext=\"$acl_cv_shlibext\"\n+  hardcode_libdir_flag_spec=\"$acl_cv_hardcode_libdir_flag_spec\"\n+  hardcode_libdir_separator=\"$acl_cv_hardcode_libdir_separator\"\n+  hardcode_direct=\"$acl_cv_hardcode_direct\"\n+  hardcode_minus_L=\"$acl_cv_hardcode_minus_L\"\n+    # Check whether --enable-rpath or --disable-rpath was given.\n+if test \"${enable_rpath+set}\" = set; then\n+  enableval=\"$enable_rpath\"\n+  :\n+else\n+  enable_rpath=yes\n+fi;\n+\n+\n+\n+\n+\n+\n+\n+    use_additional=yes\n+\n+  acl_save_prefix=\"$prefix\"\n+  prefix=\"$acl_final_prefix\"\n+  acl_save_exec_prefix=\"$exec_prefix\"\n+  exec_prefix=\"$acl_final_exec_prefix\"\n+\n+    eval additional_includedir=\\\"$includedir\\\"\n+    eval additional_libdir=\\\"$libdir\\\"\n+\n+  exec_prefix=\"$acl_save_exec_prefix\"\n+  prefix=\"$acl_save_prefix\"\n+\n+\n+# Check whether --with-libiconv-prefix or --without-libiconv-prefix was given.\n+if test \"${with_libiconv_prefix+set}\" = set; then\n+  withval=\"$with_libiconv_prefix\"\n+\n+    if test \"X$withval\" = \"Xno\"; then\n+      use_additional=no\n+    else\n+      if test \"X$withval\" = \"X\"; then\n+\n+  acl_save_prefix=\"$prefix\"\n+  prefix=\"$acl_final_prefix\"\n+  acl_save_exec_prefix=\"$exec_prefix\"\n+  exec_prefix=\"$acl_final_exec_prefix\"\n+\n+          eval additional_includedir=\\\"$includedir\\\"\n+          eval additional_libdir=\\\"$libdir\\\"\n+\n+  exec_prefix=\"$acl_save_exec_prefix\"\n+  prefix=\"$acl_save_prefix\"\n+\n+      else\n+        additional_includedir=\"$withval/include\"\n+        additional_libdir=\"$withval/lib\"\n+      fi\n+    fi\n+\n+fi;\n+      LIBICONV=\n+  LTLIBICONV=\n+  INCICONV=\n+  rpathdirs=\n+  ltrpathdirs=\n+  names_already_handled=\n+  names_next_round='iconv '\n+  while test -n \"$names_next_round\"; do\n+    names_this_round=\"$names_next_round\"\n+    names_next_round=\n+    for name in $names_this_round; do\n+      already_handled=\n+      for n in $names_already_handled; do\n+        if test \"$n\" = \"$name\"; then\n+          already_handled=yes\n+          break\n+        fi\n+      done\n+      if test -z \"$already_handled\"; then\n+        names_already_handled=\"$names_already_handled $name\"\n+                        uppername=`echo \"$name\" | sed -e 'y|abcdefghijklmnopqrstuvwxyz./-|ABCDEFGHIJKLMNOPQRSTUVWXYZ___|'`\n+        eval value=\\\"\\$HAVE_LIB$uppername\\\"\n+        if test -n \"$value\"; then\n+          if test \"$value\" = yes; then\n+            eval value=\\\"\\$LIB$uppername\\\"\n+            test -z \"$value\" || LIBICONV=\"${LIBICONV}${LIBICONV:+ }$value\"\n+            eval value=\\\"\\$LTLIB$uppername\\\"\n+            test -z \"$value\" || LTLIBICONV=\"${LTLIBICONV}${LTLIBICONV:+ }$value\"\n+          else\n+                                    :\n+          fi\n+        else\n+                              found_dir=\n+          found_la=\n+          found_so=\n+          found_a=\n+          if test $use_additional = yes; then\n+            if test -n \"$shlibext\" && test -f \"$additional_libdir/lib$name.$shlibext\"; then\n+              found_dir=\"$additional_libdir\"\n+              found_so=\"$additional_libdir/lib$name.$shlibext\"\n+              if test -f \"$additional_libdir/lib$name.la\"; then\n+                found_la=\"$additional_libdir/lib$name.la\"\n+              fi\n+            else\n+              if test -f \"$additional_libdir/lib$name.$libext\"; then\n+                found_dir=\"$additional_libdir\"\n+                found_a=\"$additional_libdir/lib$name.$libext\"\n+                if test -f \"$additional_libdir/lib$name.la\"; then\n+                  found_la=\"$additional_libdir/lib$name.la\"\n+                fi\n+              fi\n+            fi\n+          fi\n+          if test \"X$found_dir\" = \"X\"; then\n+            for x in $LDFLAGS $LTLIBICONV; do\n+\n+  acl_save_prefix=\"$prefix\"\n+  prefix=\"$acl_final_prefix\"\n+  acl_save_exec_prefix=\"$exec_prefix\"\n+  exec_prefix=\"$acl_final_exec_prefix\"\n+  eval x=\\\"$x\\\"\n+  exec_prefix=\"$acl_save_exec_prefix\"\n+  prefix=\"$acl_save_prefix\"\n+\n+              case \"$x\" in\n+                -L*)\n+                  dir=`echo \"X$x\" | sed -e 's/^X-L//'`\n+                  if test -n \"$shlibext\" && test -f \"$dir/lib$name.$shlibext\"; then\n+                    found_dir=\"$dir\"\n+                    found_so=\"$dir/lib$name.$shlibext\"\n+                    if test -f \"$dir/lib$name.la\"; then\n+                      found_la=\"$dir/lib$name.la\"\n+                    fi\n+                  else\n+                    if test -f \"$dir/lib$name.$libext\"; then\n+                      found_dir=\"$dir\"\n+                      found_a=\"$dir/lib$name.$libext\"\n+                      if test -f \"$dir/lib$name.la\"; then\n+                        found_la=\"$dir/lib$name.la\"\n+                      fi\n+                    fi\n+                  fi\n+                  ;;\n+              esac\n+              if test \"X$found_dir\" != \"X\"; then\n+                break\n+              fi\n+            done\n+          fi\n+          if test \"X$found_dir\" != \"X\"; then\n+                        LTLIBICONV=\"${LTLIBICONV}${LTLIBICONV:+ }-L$found_dir -l$name\"\n+            if test \"X$found_so\" != \"X\"; then\n+                                                        if test \"$enable_rpath\" = no || test \"X$found_dir\" = \"X/usr/lib\"; then\n+                                LIBICONV=\"${LIBICONV}${LIBICONV:+ }$found_so\"\n+              else\n+                                                                                haveit=\n+                for x in $ltrpathdirs; do\n+                  if test \"X$x\" = \"X$found_dir\"; then\n+                    haveit=yes\n+                    break\n+                  fi\n+                done\n+                if test -z \"$haveit\"; then\n+                  ltrpathdirs=\"$ltrpathdirs $found_dir\"\n+                fi\n+                                if test \"$hardcode_direct\" = yes; then\n+                                                      LIBICONV=\"${LIBICONV}${LIBICONV:+ }$found_so\"\n+                else\n+                  if test -n \"$hardcode_libdir_flag_spec\" && test \"$hardcode_minus_L\" = no; then\n+                                                            LIBICONV=\"${LIBICONV}${LIBICONV:+ }$found_so\"\n+                                                            haveit=\n+                    for x in $rpathdirs; do\n+                      if test \"X$x\" = \"X$found_dir\"; then\n+                        haveit=yes\n+                        break\n+                      fi\n+                    done\n+                    if test -z \"$haveit\"; then\n+                      rpathdirs=\"$rpathdirs $found_dir\"\n+                    fi\n+                  else\n+                                                                                haveit=\n+                    for x in $LDFLAGS $LIBICONV; do\n+\n+  acl_save_prefix=\"$prefix\"\n+  prefix=\"$acl_final_prefix\"\n+  acl_save_exec_prefix=\"$exec_prefix\"\n+  exec_prefix=\"$acl_final_exec_prefix\"\n+  eval x=\\\"$x\\\"\n+  exec_prefix=\"$acl_save_exec_prefix\"\n+  prefix=\"$acl_save_prefix\"\n+\n+                      if test \"X$x\" = \"X-L$found_dir\"; then\n+                        haveit=yes\n+                        break\n+                      fi\n+                    done\n+                    if test -z \"$haveit\"; then\n+                      LIBICONV=\"${LIBICONV}${LIBICONV:+ }-L$found_dir\"\n+                    fi\n+                    if test \"$hardcode_minus_L\" != no; then\n+                                                                                        LIBICONV=\"${LIBICONV}${LIBICONV:+ }$found_so\"\n+                    else\n+                                                                                                                                                                                LIBICONV=\"${LIBICONV}${LIBICONV:+ }-l$name\"\n+                    fi\n+                  fi\n+                fi\n+              fi\n+            else\n+              if test \"X$found_a\" != \"X\"; then\n+                                LIBICONV=\"${LIBICONV}${LIBICONV:+ }$found_a\"\n+              else\n+                                                LIBICONV=\"${LIBICONV}${LIBICONV:+ }-L$found_dir -l$name\"\n+              fi\n+            fi\n+                        additional_includedir=\n+            case \"$found_dir\" in\n+              */lib | */lib/)\n+                basedir=`echo \"X$found_dir\" | sed -e 's,^X,,' -e 's,/lib/*$,,'`\n+                additional_includedir=\"$basedir/include\"\n+                ;;\n+            esac\n+            if test \"X$additional_includedir\" != \"X\"; then\n+                                                                                                                if test \"X$additional_includedir\" != \"X/usr/include\"; then\n+                haveit=\n+                if test \"X$additional_includedir\" = \"X/usr/local/include\"; then\n+                  if test -n \"$GCC\"; then\n+                    case $host_os in\n+                      linux*) haveit=yes;;\n+                    esac\n+                  fi\n+                fi\n+                if test -z \"$haveit\"; then\n+                  for x in $CPPFLAGS $INCICONV; do\n+\n+  acl_save_prefix=\"$prefix\"\n+  prefix=\"$acl_final_prefix\"\n+  acl_save_exec_prefix=\"$exec_prefix\"\n+  exec_prefix=\"$acl_final_exec_prefix\"\n+  eval x=\\\"$x\\\"\n+  exec_prefix=\"$acl_save_exec_prefix\"\n+  prefix=\"$acl_save_prefix\"\n+\n+                    if test \"X$x\" = \"X-I$additional_includedir\"; then\n+                      haveit=yes\n+                      break\n+                    fi\n+                  done\n+                  if test -z \"$haveit\"; then\n+                    if test -d \"$additional_includedir\"; then\n+                                            INCICONV=\"${INCICONV}${INCICONV:+ }-I$additional_includedir\"\n+                    fi\n+                  fi\n+                fi\n+              fi\n+            fi\n+                        if test -n \"$found_la\"; then\n+                                                        save_libdir=\"$libdir\"\n+              case \"$found_la\" in\n+                */* | *\\\\*) . \"$found_la\" ;;\n+                *) . \"./$found_la\" ;;\n+              esac\n+              libdir=\"$save_libdir\"\n+                            for dep in $dependency_libs; do\n+                case \"$dep\" in\n+                  -L*)\n+                    additional_libdir=`echo \"X$dep\" | sed -e 's/^X-L//'`\n+                                                                                                                                                                if test \"X$additional_libdir\" != \"X/usr/lib\"; then\n+                      haveit=\n+                      if test \"X$additional_libdir\" = \"X/usr/local/lib\"; then\n+                        if test -n \"$GCC\"; then\n+                          case $host_os in\n+                            linux*) haveit=yes;;\n+                          esac\n+                        fi\n+                      fi\n+                      if test -z \"$haveit\"; then\n+                        haveit=\n+                        for x in $LDFLAGS $LIBICONV; do\n+\n+  acl_save_prefix=\"$prefix\"\n+  prefix=\"$acl_final_prefix\"\n+  acl_save_exec_prefix=\"$exec_prefix\"\n+  exec_prefix=\"$acl_final_exec_prefix\"\n+  eval x=\\\"$x\\\"\n+  exec_prefix=\"$acl_save_exec_prefix\"\n+  prefix=\"$acl_save_prefix\"\n+\n+                          if test \"X$x\" = \"X-L$additional_libdir\"; then\n+                            haveit=yes\n+                            break\n+                          fi\n+                        done\n+                        if test -z \"$haveit\"; then\n+                          if test -d \"$additional_libdir\"; then\n+                                                        LIBICONV=\"${LIBICONV}${LIBICONV:+ }-L$additional_libdir\"\n+                          fi\n+                        fi\n+                        haveit=\n+                        for x in $LDFLAGS $LTLIBICONV; do\n+\n+  acl_save_prefix=\"$prefix\"\n+  prefix=\"$acl_final_prefix\"\n+  acl_save_exec_prefix=\"$exec_prefix\"\n+  exec_prefix=\"$acl_final_exec_prefix\"\n+  eval x=\\\"$x\\\"\n+  exec_prefix=\"$acl_save_exec_prefix\"\n+  prefix=\"$acl_save_prefix\"\n+\n+                          if test \"X$x\" = \"X-L$additional_libdir\"; then\n+                            haveit=yes\n+                            break\n+                          fi\n+                        done\n+                        if test -z \"$haveit\"; then\n+                          if test -d \"$additional_libdir\"; then\n+                                                        LTLIBICONV=\"${LTLIBICONV}${LTLIBICONV:+ }-L$additional_libdir\"\n+                          fi\n+                        fi\n+                      fi\n+                    fi\n+                    ;;\n+                  -R*)\n+                    dir=`echo \"X$dep\" | sed -e 's/^X-R//'`\n+                    if test \"$enable_rpath\" != no; then\n+                                                                  haveit=\n+                      for x in $rpathdirs; do\n+                        if test \"X$x\" = \"X$dir\"; then\n+                          haveit=yes\n+                          break\n+                        fi\n+                      done\n+                      if test -z \"$haveit\"; then\n+                        rpathdirs=\"$rpathdirs $dir\"\n+                      fi\n+                                                                  haveit=\n+                      for x in $ltrpathdirs; do\n+                        if test \"X$x\" = \"X$dir\"; then\n+                          haveit=yes\n+                          break\n+                        fi\n+                      done\n+                      if test -z \"$haveit\"; then\n+                        ltrpathdirs=\"$ltrpathdirs $dir\"\n+                      fi\n+                    fi\n+                    ;;\n+                  -l*)\n+                                        names_next_round=\"$names_next_round \"`echo \"X$dep\" | sed -e 's/^X-l//'`\n+                    ;;\n+                  *.la)\n+                                                                                names_next_round=\"$names_next_round \"`echo \"X$dep\" | sed -e 's,^X.*/,,' -e 's,^lib,,' -e 's,\\.la$,,'`\n+                    ;;\n+                  *)\n+                                        LIBICONV=\"${LIBICONV}${LIBICONV:+ }$dep\"\n+                    LTLIBICONV=\"${LTLIBICONV}${LTLIBICONV:+ }$dep\"\n+                    ;;\n+                esac\n+              done\n+            fi\n+          else\n+                                                            LIBICONV=\"${LIBICONV}${LIBICONV:+ }-l$name\"\n+            LTLIBICONV=\"${LTLIBICONV}${LTLIBICONV:+ }-l$name\"\n+          fi\n+        fi\n+      fi\n+    done\n+  done\n+  if test \"X$rpathdirs\" != \"X\"; then\n+    if test -n \"$hardcode_libdir_separator\"; then\n+                        alldirs=\n+      for found_dir in $rpathdirs; do\n+        alldirs=\"${alldirs}${alldirs:+$hardcode_libdir_separator}$found_dir\"\n+      done\n+            acl_save_libdir=\"$libdir\"\n+      libdir=\"$alldirs\"\n+      eval flag=\\\"$hardcode_libdir_flag_spec\\\"\n+      libdir=\"$acl_save_libdir\"\n+      LIBICONV=\"${LIBICONV}${LIBICONV:+ }$flag\"\n+    else\n+            for found_dir in $rpathdirs; do\n+        acl_save_libdir=\"$libdir\"\n+        libdir=\"$found_dir\"\n+        eval flag=\\\"$hardcode_libdir_flag_spec\\\"\n+        libdir=\"$acl_save_libdir\"\n+        LIBICONV=\"${LIBICONV}${LIBICONV:+ }$flag\"\n+      done\n+    fi\n+  fi\n+  if test \"X$ltrpathdirs\" != \"X\"; then\n+            for found_dir in $ltrpathdirs; do\n+      LTLIBICONV=\"${LTLIBICONV}${LTLIBICONV:+ }-R$found_dir\"\n+    done\n+  fi\n+\n+\n+\n+\n+\n+\n+\n+          am_save_CPPFLAGS=\"$CPPFLAGS\"\n+\n+  for element in $INCICONV; do\n+    haveit=\n+    for x in $CPPFLAGS; do\n+\n+  acl_save_prefix=\"$prefix\"\n+  prefix=\"$acl_final_prefix\"\n+  acl_save_exec_prefix=\"$exec_prefix\"\n+  exec_prefix=\"$acl_final_exec_prefix\"\n+  eval x=\\\"$x\\\"\n+  exec_prefix=\"$acl_save_exec_prefix\"\n+  prefix=\"$acl_save_prefix\"\n+\n+      if test \"X$x\" = \"X$element\"; then\n+        haveit=yes\n+        break\n+      fi\n+    done\n+    if test -z \"$haveit\"; then\n+      CPPFLAGS=\"${CPPFLAGS}${CPPFLAGS:+ }$element\"\n+    fi\n+  done\n+\n+\n+  echo \"$as_me:$LINENO: checking for iconv\" >&5\n+echo $ECHO_N \"checking for iconv... $ECHO_C\" >&6\n+if test \"${am_cv_func_iconv+set}\" = set; then\n+  echo $ECHO_N \"(cached) $ECHO_C\" >&6\n+else\n+\n+    am_cv_func_iconv=\"no, consider installing GNU libiconv\"\n+    am_cv_lib_iconv=no\n+    if test x$gcc_no_link = xyes; then\n+  { { echo \"$as_me:$LINENO: error: Link tests are not allowed after GCC_NO_EXECUTABLES.\" >&5\n+echo \"$as_me: error: Link tests are not allowed after GCC_NO_EXECUTABLES.\" >&2;}\n+   { (exit 1); exit 1; }; }\n+fi\n+cat >conftest.$ac_ext <<_ACEOF\n+/* confdefs.h.  */\n+_ACEOF\n+cat confdefs.h >>conftest.$ac_ext\n+cat >>conftest.$ac_ext <<_ACEOF\n+/* end confdefs.h.  */\n+#include <stdlib.h>\n+#include <iconv.h>\n+int\n+main ()\n+{\n+iconv_t cd = iconv_open(\"\",\"\");\n+       iconv(cd,NULL,NULL,NULL,NULL);\n+       iconv_close(cd);\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+rm -f conftest.$ac_objext conftest$ac_exeext\n+if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n+  (eval $ac_link) 2>conftest.er1\n+  ac_status=$?\n+  grep -v '^ *+' conftest.er1 >conftest.err\n+  rm -f conftest.er1\n+  cat conftest.err >&5\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); } &&\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; } &&\n+\t { ac_try='test -s conftest$ac_exeext'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; }; then\n+  am_cv_func_iconv=yes\n else\n   echo \"$as_me: failed program was:\" >&5\n sed 's/^/| /' conftest.$ac_ext >&5\n \n-eval \"$as_ac_var=no\"\n fi\n rm -f conftest.err conftest.$ac_objext \\\n       conftest$ac_exeext conftest.$ac_ext\n+    if test \"$am_cv_func_iconv\" != yes; then\n+      am_save_LIBS=\"$LIBS\"\n+      LIBS=\"$LIBS $LIBICONV\"\n+      if test x$gcc_no_link = xyes; then\n+  { { echo \"$as_me:$LINENO: error: Link tests are not allowed after GCC_NO_EXECUTABLES.\" >&5\n+echo \"$as_me: error: Link tests are not allowed after GCC_NO_EXECUTABLES.\" >&2;}\n+   { (exit 1); exit 1; }; }\n fi\n-echo \"$as_me:$LINENO: result: `eval echo '${'$as_ac_var'}'`\" >&5\n-echo \"${ECHO_T}`eval echo '${'$as_ac_var'}'`\" >&6\n-if test `eval echo '${'$as_ac_var'}'` = yes; then\n-  cat >>confdefs.h <<_ACEOF\n-#define `echo \"HAVE_$ac_func\" | $as_tr_cpp` 1\n+cat >conftest.$ac_ext <<_ACEOF\n+/* confdefs.h.  */\n+_ACEOF\n+cat confdefs.h >>conftest.$ac_ext\n+cat >>conftest.$ac_ext <<_ACEOF\n+/* end confdefs.h.  */\n+#include <stdlib.h>\n+#include <iconv.h>\n+int\n+main ()\n+{\n+iconv_t cd = iconv_open(\"\",\"\");\n+         iconv(cd,NULL,NULL,NULL,NULL);\n+         iconv_close(cd);\n+  ;\n+  return 0;\n+}\n _ACEOF\n+rm -f conftest.$ac_objext conftest$ac_exeext\n+if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n+  (eval $ac_link) 2>conftest.er1\n+  ac_status=$?\n+  grep -v '^ *+' conftest.er1 >conftest.err\n+  rm -f conftest.er1\n+  cat conftest.err >&5\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); } &&\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; } &&\n+\t { ac_try='test -s conftest$ac_exeext'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; }; then\n+  am_cv_lib_iconv=yes\n+        am_cv_func_iconv=yes\n+else\n+  echo \"$as_me: failed program was:\" >&5\n+sed 's/^/| /' conftest.$ac_ext >&5\n \n fi\n-done\n+rm -f conftest.err conftest.$ac_objext \\\n+      conftest$ac_exeext conftest.$ac_ext\n+      LIBS=\"$am_save_LIBS\"\n+    fi\n \n-echo \"$as_me:$LINENO: checking for working mmap\" >&5\n-echo $ECHO_N \"checking for working mmap... $ECHO_C\" >&6\n-if test \"${ac_cv_func_mmap_fixed_mapped+set}\" = set; then\n+fi\n+echo \"$as_me:$LINENO: result: $am_cv_func_iconv\" >&5\n+echo \"${ECHO_T}$am_cv_func_iconv\" >&6\n+  if test \"$am_cv_func_iconv\" = yes; then\n+\n+cat >>confdefs.h <<\\_ACEOF\n+#define HAVE_ICONV 1\n+_ACEOF\n+\n+  fi\n+  if test \"$am_cv_lib_iconv\" = yes; then\n+    echo \"$as_me:$LINENO: checking how to link with libiconv\" >&5\n+echo $ECHO_N \"checking how to link with libiconv... $ECHO_C\" >&6\n+    echo \"$as_me:$LINENO: result: $LIBICONV\" >&5\n+echo \"${ECHO_T}$LIBICONV\" >&6\n+  else\n+            CPPFLAGS=\"$am_save_CPPFLAGS\"\n+    LIBICONV=\n+    LTLIBICONV=\n+  fi\n+\n+\n+\n+  if test \"$am_cv_func_iconv\" = yes; then\n+    echo \"$as_me:$LINENO: checking for iconv declaration\" >&5\n+echo $ECHO_N \"checking for iconv declaration... $ECHO_C\" >&6\n+    if test \"${am_cv_proto_iconv+set}\" = set; then\n   echo $ECHO_N \"(cached) $ECHO_C\" >&6\n else\n-  if test \"$cross_compiling\" = yes; then\n-  ac_cv_func_mmap_fixed_mapped=no\n-else\n-  cat >conftest.$ac_ext <<_ACEOF\n+\n+      cat >conftest.$ac_ext <<_ACEOF\n /* confdefs.h.  */\n _ACEOF\n cat confdefs.h >>conftest.$ac_ext\n cat >>conftest.$ac_ext <<_ACEOF\n /* end confdefs.h.  */\n-$ac_includes_default\n-/* malloc might have been renamed as rpl_malloc. */\n-#undef malloc\n-\n-/* Thanks to Mike Haertel and Jim Avera for this test.\n-   Here is a matrix of mmap possibilities:\n-\tmmap private not fixed\n-\tmmap private fixed at somewhere currently unmapped\n-\tmmap private fixed at somewhere already mapped\n-\tmmap shared not fixed\n-\tmmap shared fixed at somewhere currently unmapped\n-\tmmap shared fixed at somewhere already mapped\n-   For private mappings, we should verify that changes cannot be read()\n-   back from the file, nor mmap's back from the file at a different\n-   address.  (There have been systems where private was not correctly\n-   implemented like the infamous i386 svr4.0, and systems where the\n-   VM page cache was not coherent with the file system buffer cache\n-   like early versions of FreeBSD and possibly contemporary NetBSD.)\n-   For shared mappings, we should conversely verify that changes get\n-   propagated back to all the places they're supposed to be.\n-\n-   Grep wants private fixed already mapped.\n-   The main things grep needs to know about mmap are:\n-   * does it exist and is it safe to write into the mmap'd area\n-   * how to use it (BSD variants)  */\n-\n-#include <fcntl.h>\n-#include <sys/mman.h>\n \n-#if !STDC_HEADERS && !HAVE_STDLIB_H\n-char *malloc ();\n+#include <stdlib.h>\n+#include <iconv.h>\n+extern\n+#ifdef __cplusplus\n+\"C\"\n+#endif\n+#if defined(__STDC__) || defined(__cplusplus)\n+size_t iconv (iconv_t cd, char * *inbuf, size_t *inbytesleft, char * *outbuf, size_t *outbytesleft);\n+#else\n+size_t iconv();\n #endif\n-\n-/* This mess was copied from the GNU getpagesize.h.  */\n-#if !HAVE_GETPAGESIZE\n-/* Assume that all systems that can run configure have sys/param.h.  */\n-# if !HAVE_SYS_PARAM_H\n-#  define HAVE_SYS_PARAM_H 1\n-# endif\n-\n-# ifdef _SC_PAGESIZE\n-#  define getpagesize() sysconf(_SC_PAGESIZE)\n-# else /* no _SC_PAGESIZE */\n-#  if HAVE_SYS_PARAM_H\n-#   include <sys/param.h>\n-#   ifdef EXEC_PAGESIZE\n-#    define getpagesize() EXEC_PAGESIZE\n-#   else /* no EXEC_PAGESIZE */\n-#    ifdef NBPG\n-#     define getpagesize() NBPG * CLSIZE\n-#     ifndef CLSIZE\n-#      define CLSIZE 1\n-#     endif /* no CLSIZE */\n-#    else /* no NBPG */\n-#     ifdef NBPC\n-#      define getpagesize() NBPC\n-#     else /* no NBPC */\n-#      ifdef PAGESIZE\n-#       define getpagesize() PAGESIZE\n-#      endif /* PAGESIZE */\n-#     endif /* no NBPC */\n-#    endif /* no NBPG */\n-#   endif /* no EXEC_PAGESIZE */\n-#  else /* no HAVE_SYS_PARAM_H */\n-#   define getpagesize() 8192\t/* punt totally */\n-#  endif /* no HAVE_SYS_PARAM_H */\n-# endif /* no _SC_PAGESIZE */\n-\n-#endif /* no HAVE_GETPAGESIZE */\n \n int\n main ()\n {\n-  char *data, *data2, *data3;\n-  int i, pagesize;\n-  int fd;\n \n-  pagesize = getpagesize ();\n-\n-  /* First, make a file with some known garbage in it. */\n-  data = (char *) malloc (pagesize);\n-  if (!data)\n-    exit (1);\n-  for (i = 0; i < pagesize; ++i)\n-    *(data + i) = rand ();\n-  umask (0);\n-  fd = creat (\"conftest.mmap\", 0600);\n-  if (fd < 0)\n-    exit (1);\n-  if (write (fd, data, pagesize) != pagesize)\n-    exit (1);\n-  close (fd);\n-\n-  /* Next, try to mmap the file at a fixed address which already has\n-     something else allocated at it.  If we can, also make sure that\n-     we see the same garbage.  */\n-  fd = open (\"conftest.mmap\", O_RDWR);\n-  if (fd < 0)\n-    exit (1);\n-  data2 = (char *) malloc (2 * pagesize);\n-  if (!data2)\n-    exit (1);\n-  data2 += (pagesize - ((long) data2 & (pagesize - 1))) & (pagesize - 1);\n-  if (data2 != mmap (data2, pagesize, PROT_READ | PROT_WRITE,\n-\t\t     MAP_PRIVATE | MAP_FIXED, fd, 0L))\n-    exit (1);\n-  for (i = 0; i < pagesize; ++i)\n-    if (*(data + i) != *(data2 + i))\n-      exit (1);\n-\n-  /* Finally, make sure that changes to the mapped area do not\n-     percolate back to the file as seen by read().  (This is a bug on\n-     some variants of i386 svr4.0.)  */\n-  for (i = 0; i < pagesize; ++i)\n-    *(data2 + i) = *(data2 + i) + 1;\n-  data3 = (char *) malloc (pagesize);\n-  if (!data3)\n-    exit (1);\n-  if (read (fd, data3, pagesize) != pagesize)\n-    exit (1);\n-  for (i = 0; i < pagesize; ++i)\n-    if (*(data + i) != *(data3 + i))\n-      exit (1);\n-  close (fd);\n-  exit (0);\n+  ;\n+  return 0;\n }\n _ACEOF\n-rm -f conftest$ac_exeext\n-if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n-  (eval $ac_link) 2>&5\n+rm -f conftest.$ac_objext\n+if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n+  (eval $ac_compile) 2>conftest.er1\n   ac_status=$?\n+  grep -v '^ *+' conftest.er1 >conftest.err\n+  rm -f conftest.er1\n+  cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n-  (exit $ac_status); } && { ac_try='./conftest$ac_exeext'\n+  (exit $ac_status); } &&\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; } &&\n+\t { ac_try='test -s conftest.$ac_objext'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); }; }; then\n-  ac_cv_func_mmap_fixed_mapped=yes\n+  am_cv_proto_iconv_arg1=\"\"\n else\n-  echo \"$as_me: program exited with status $ac_status\" >&5\n-echo \"$as_me: failed program was:\" >&5\n+  echo \"$as_me: failed program was:\" >&5\n sed 's/^/| /' conftest.$ac_ext >&5\n \n-( exit $ac_status )\n-ac_cv_func_mmap_fixed_mapped=no\n-fi\n-rm -f core *.core gmon.out bb.out conftest$ac_exeext conftest.$ac_objext conftest.$ac_ext\n+am_cv_proto_iconv_arg1=\"const\"\n fi\n+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext\n+      am_cv_proto_iconv=\"extern size_t iconv (iconv_t cd, $am_cv_proto_iconv_arg1 char * *inbuf, size_t *inbytesleft, char * *outbuf, size_t *outbytesleft);\"\n fi\n-echo \"$as_me:$LINENO: result: $ac_cv_func_mmap_fixed_mapped\" >&5\n-echo \"${ECHO_T}$ac_cv_func_mmap_fixed_mapped\" >&6\n-if test $ac_cv_func_mmap_fixed_mapped = yes; then\n \n-cat >>confdefs.h <<\\_ACEOF\n-#define HAVE_MMAP 1\n+    am_cv_proto_iconv=`echo \"$am_cv_proto_iconv\" | tr -s ' ' | sed -e 's/( /(/'`\n+    echo \"$as_me:$LINENO: result: ${ac_t:-\n+         }$am_cv_proto_iconv\" >&5\n+echo \"${ECHO_T}${ac_t:-\n+         }$am_cv_proto_iconv\" >&6\n+\n+cat >>confdefs.h <<_ACEOF\n+#define ICONV_CONST $am_cv_proto_iconv_arg1\n _ACEOF\n \n-fi\n-rm -f conftest.mmap\n+  fi\n \n-fi\n \n else\n \n@@ -32792,6 +32795,11 @@ _ACEOF\n #define HAVE_S_IFREG 1\n _ACEOF\n \n+\n+    cat >>confdefs.h <<\\_ACEOF\n+#define HAVE_ICONV 1\n+_ACEOF\n+\n   else\n \n # Base decisions on target environment.\n@@ -106265,8 +106273,6 @@ s,@LIBTOOL@,$LIBTOOL,;t t\n s,@CXXCPP@,$CXXCPP,;t t\n s,@enable_shared@,$enable_shared,;t t\n s,@enable_static@,$enable_static,;t t\n-s,@LIBICONV@,$LIBICONV,;t t\n-s,@LTLIBICONV@,$LTLIBICONV,;t t\n s,@GLIBCXX_HOSTED_TRUE@,$GLIBCXX_HOSTED_TRUE,;t t\n s,@GLIBCXX_HOSTED_FALSE@,$GLIBCXX_HOSTED_FALSE,;t t\n s,@GLIBCXX_BUILD_PCH_TRUE@,$GLIBCXX_BUILD_PCH_TRUE,;t t\n@@ -106311,6 +106317,8 @@ s,@SECTION_FLAGS@,$SECTION_FLAGS,;t t\n s,@SECTION_LDFLAGS@,$SECTION_LDFLAGS,;t t\n s,@OPT_LDFLAGS@,$OPT_LDFLAGS,;t t\n s,@LIBMATHOBJS@,$LIBMATHOBJS,;t t\n+s,@LIBICONV@,$LIBICONV,;t t\n+s,@LTLIBICONV@,$LTLIBICONV,;t t\n s,@SYMVER_FILE@,$SYMVER_FILE,;t t\n s,@port_specific_symbol_files@,$port_specific_symbol_files,;t t\n s,@ENABLE_SYMVERS_TRUE@,$ENABLE_SYMVERS_TRUE,;t t"}, {"sha": "7bebae9229da6e073f3a4a3272c106e73b681b2e", "filename": "libstdc++-v3/configure.ac", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5f34ed87f7203307efbcfc802c812b7c1c0b947d/libstdc%2B%2B-v3%2Fconfigure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5f34ed87f7203307efbcfc802c812b7c1c0b947d/libstdc%2B%2B-v3%2Fconfigure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fconfigure.ac?ref=5f34ed87f7203307efbcfc802c812b7c1c0b947d", "patch": "@@ -86,7 +86,6 @@ AC_LIBTOOL_DLOPEN\n AM_PROG_LIBTOOL\n AC_SUBST(enable_shared)\n AC_SUBST(enable_static)\n-AM_ICONV\n \n # Possibly disable most of the library.\n ## TODO: Consider skipping unncessary tests altogether in this case, rather\n@@ -182,6 +181,9 @@ if $GLIBCXX_IS_NATIVE; then\n \n   AC_FUNC_MMAP\n \n+  # For iconv support.\n+  AM_ICONV\n+\n else\n \n   # This lets us hard-code the functionality we know we'll have in the cross\n@@ -251,6 +253,8 @@ else\n \n     AC_DEFINE(HAVE_S_ISREG)\n     AC_DEFINE(HAVE_S_IFREG)\n+\n+    AC_DEFINE(HAVE_ICONV)\n   else\n     GLIBCXX_CROSSCONFIG\n   fi"}]}