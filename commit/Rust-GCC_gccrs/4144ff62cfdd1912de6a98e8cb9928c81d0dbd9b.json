{"sha": "4144ff62cfdd1912de6a98e8cb9928c81d0dbd9b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDE0NGZmNjJjZmRkMTkxMmRlNmE5OGU4Y2I5OTI4YzgxZDBkYmQ5Yg==", "commit": {"author": {"name": "Doug Evans", "email": "dje@gnu.org", "date": "1997-07-01T22:36:13Z"}, "committer": {"name": "Doug Evans", "email": "dje@gnu.org", "date": "1997-07-01T22:36:13Z"}, "message": "mips.c (mips_output_external): Don't output .extern's for variables in user specified sections unless...\n\n* mips/mips.c (mips_output_external): Don't output .extern's for\nvariables in user specified sections unless they're .sbss/.sdata.\n\nFrom-SVN: r14369", "tree": {"sha": "8499988640e0d94201a231fe10b9fa0fec791c19", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8499988640e0d94201a231fe10b9fa0fec791c19"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4144ff62cfdd1912de6a98e8cb9928c81d0dbd9b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4144ff62cfdd1912de6a98e8cb9928c81d0dbd9b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4144ff62cfdd1912de6a98e8cb9928c81d0dbd9b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4144ff62cfdd1912de6a98e8cb9928c81d0dbd9b/comments", "author": null, "committer": null, "parents": [{"sha": "f953dd66a29dc819ef8a60ab35804b7d1aac6859", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f953dd66a29dc819ef8a60ab35804b7d1aac6859", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f953dd66a29dc819ef8a60ab35804b7d1aac6859"}], "stats": {"total": 13, "additions": 10, "deletions": 3}, "files": [{"sha": "584de95a0846f16bc4deba6203a212870d00efb3", "filename": "gcc/config/mips/mips.c", "status": "modified", "additions": 10, "deletions": 3, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4144ff62cfdd1912de6a98e8cb9928c81d0dbd9b/gcc%2Fconfig%2Fmips%2Fmips.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4144ff62cfdd1912de6a98e8cb9928c81d0dbd9b/gcc%2Fconfig%2Fmips%2Fmips.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.c?ref=4144ff62cfdd1912de6a98e8cb9928c81d0dbd9b", "patch": "@@ -4283,8 +4283,11 @@ print_operand_address (file, addr)\n    us are in the permanent obstack, so that they will be valid\n    at the end of the compilation.\n \n-   If we have -G 0, or the extern size is unknown, don't bother\n-   emitting the .externs.  */\n+   If we have -G 0, or the extern size is unknown, or the object is in\n+   a user specified section that is not .sbss/.sdata, don't bother\n+   emitting the .externs.  In the case of user specified sections this\n+   behaviour is required as otherwise GAS will think the object lives in\n+   .sbss/.sdata.  */\n \n int\n mips_output_external (file, decl, name)\n@@ -4294,10 +4297,14 @@ mips_output_external (file, decl, name)\n {\n   register struct extern_list *p;\n   int len;\n+  tree section_name;\n \n   if (TARGET_GP_OPT\n       && ((TREE_CODE (decl)) != FUNCTION_DECL)\n-      && ((len = int_size_in_bytes (TREE_TYPE (decl))) > 0))\n+      && ((len = int_size_in_bytes (TREE_TYPE (decl))) > 0)\n+      && (((section_name = DECL_SECTION_NAME (decl)) == NULL)\n+\t  || strcmp (TREE_STRING_POINTER (section_name), \".sbss\") == 0\n+\t  || strcmp (TREE_STRING_POINTER (section_name), \".sdata\") == 0))\n     {\n       p = (struct extern_list *)permalloc ((long) sizeof (struct extern_list));\n       p->next = extern_head;"}]}