{"sha": "6e4be1fa8c986cb0e12fb2fed62790dd838f38ed", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NmU0YmUxZmE4Yzk4NmNiMGUxMmZiMmZlZDYyNzkwZGQ4MzhmMzhlZA==", "commit": {"author": {"name": "Nathan Sidwell", "email": "nathan@codesourcery.com", "date": "2006-10-22T16:07:41Z"}, "committer": {"name": "Nathan Sidwell", "email": "nathan@gcc.gnu.org", "date": "2006-10-22T16:07:41Z"}, "message": "re PR libstdc++/20647 (Wrong typeid for incomplete types)\n\ncp/\n\tPR c++/20647\n\t* rtti.c (tinfo_base_init): The type info string is always global.\ntestsuite/\n\tPR c++/20647\n\t* g++.dg/abi/rtti3.C: New.\n\nFrom-SVN: r117957", "tree": {"sha": "b15775d98879cdb94a82961c5ce181bce8ba2725", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b15775d98879cdb94a82961c5ce181bce8ba2725"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6e4be1fa8c986cb0e12fb2fed62790dd838f38ed", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6e4be1fa8c986cb0e12fb2fed62790dd838f38ed", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6e4be1fa8c986cb0e12fb2fed62790dd838f38ed", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6e4be1fa8c986cb0e12fb2fed62790dd838f38ed/comments", "author": null, "committer": null, "parents": [{"sha": "59edb6b4b4482c87d343a81614bac450b894f7b9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/59edb6b4b4482c87d343a81614bac450b894f7b9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/59edb6b4b4482c87d343a81614bac450b894f7b9"}], "stats": {"total": 31, "additions": 24, "deletions": 7}, "files": [{"sha": "0e6314c0ef68e11eff3f423278a93b3a3e41dd2b", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6e4be1fa8c986cb0e12fb2fed62790dd838f38ed/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6e4be1fa8c986cb0e12fb2fed62790dd838f38ed/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=6e4be1fa8c986cb0e12fb2fed62790dd838f38ed", "patch": "@@ -1,3 +1,8 @@\n+2006-10-22  Nathan Sidwell  <nathan@codesourcery.com>\n+\n+\tPR c++/20647\n+\t* rtti.c (tinfo_base_init): The type info string is always global.\n+\n 2006-10-20  Lee Millward  <lee.millward@codesourcery.com>\n             Mark Mitchell <mark@codesourcery.com>\n "}, {"sha": "077d3e0b6942bb8e2c073c65e7de3cb8f0716b7d", "filename": "gcc/cp/rtti.c", "status": "modified", "additions": 1, "deletions": 7, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6e4be1fa8c986cb0e12fb2fed62790dd838f38ed/gcc%2Fcp%2Frtti.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6e4be1fa8c986cb0e12fb2fed62790dd838f38ed/gcc%2Fcp%2Frtti.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Frtti.c?ref=6e4be1fa8c986cb0e12fb2fed62790dd838f38ed", "patch": "@@ -824,13 +824,7 @@ tinfo_base_init (tinfo_s *ti, tree target)\n     TREE_STATIC (name_decl) = 1;\n     DECL_EXTERNAL (name_decl) = 0;\n     DECL_TINFO_P (name_decl) = 1;\n-    if (involves_incomplete_p (target))\n-      {\n-\tTREE_PUBLIC (name_decl) = 0;\n-\tDECL_INTERFACE_KNOWN (name_decl) = 1;\n-      }\n-    else\n-      set_linkage_according_to_type (target, name_decl);\n+    set_linkage_according_to_type (target, name_decl);\n     import_export_decl (name_decl);\n     DECL_INITIAL (name_decl) = name_string;\n     mark_used (name_decl);"}, {"sha": "1d6b02b86af28a74afda670badcd49c558d361ad", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6e4be1fa8c986cb0e12fb2fed62790dd838f38ed/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6e4be1fa8c986cb0e12fb2fed62790dd838f38ed/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=6e4be1fa8c986cb0e12fb2fed62790dd838f38ed", "patch": "@@ -1,3 +1,8 @@\n+2006-10-22  Nathan Sidwell  <nathan@codesourcery.com>\n+\n+\tPR c++/20647\n+\t* g++.dg/abi/rtti3.C: New.\n+\n 2006-10-21  Uros Bizjak  <uros@kss-loka.si>\n \n \tPR middle-end/28252"}, {"sha": "4c118d1762ad49b6cfbd0a3b6f30a18f89d03d35", "filename": "gcc/testsuite/g++.dg/abi/rtti3.C", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6e4be1fa8c986cb0e12fb2fed62790dd838f38ed/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fabi%2Frtti3.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6e4be1fa8c986cb0e12fb2fed62790dd838f38ed/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fabi%2Frtti3.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fabi%2Frtti3.C?ref=6e4be1fa8c986cb0e12fb2fed62790dd838f38ed", "patch": "@@ -0,0 +1,13 @@\n+// PR 20647, we must emit the typeinfo's string as weak, but not the\n+// necessarily the type info object\n+\n+// { dg-require-weak \"\" }\n+// { dg-final { scan-assembler \".weak\\[ \\t\\]_?_ZTSPP1A\" } }\n+// { dg-final { scan-assembler-not \".weak\\[ \\t\\]_?_ZTIPP1A\" } }\n+\n+struct A;\n+\n+void Foo ()\n+{\n+  throw (A **)0;\n+}"}]}