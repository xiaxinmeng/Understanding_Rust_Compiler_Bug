{"sha": "f5da9bfb9e7b729db8243f656a1c7341e2d97655", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjVkYTliZmI5ZTdiNzI5ZGI4MjQzZjY1NmExYzczNDFlMmQ5NzY1NQ==", "commit": {"author": {"name": "Janus Weil", "email": "janus@gcc.gnu.org", "date": "2018-09-11T06:33:39Z"}, "committer": {"name": "Janus Weil", "email": "janus@gcc.gnu.org", "date": "2018-09-11T06:33:39Z"}, "message": "re PR fortran/86830 (Contiguous array pointer function result not recognized as contiguous)\n\nfix PR 86830\n\n2018-09-11  Janus Weil  <janus@gcc.gnu.org>\n\n\tPR fortran/86830\n\t* expr.c (gfc_is_simply_contiguous): Handle type-bound procedure calls\n\twith non-polymorphic objects.\n\n2018-09-11  Janus Weil  <janus@gcc.gnu.org>\n\n\tPR fortran/86830\n\t* gfortran.dg/typebound_call_30.f90: New test case.\n\nFrom-SVN: r264201", "tree": {"sha": "5ec7bac40b1c423111fc052dbe818d0d620b71a8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5ec7bac40b1c423111fc052dbe818d0d620b71a8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f5da9bfb9e7b729db8243f656a1c7341e2d97655", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f5da9bfb9e7b729db8243f656a1c7341e2d97655", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f5da9bfb9e7b729db8243f656a1c7341e2d97655", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f5da9bfb9e7b729db8243f656a1c7341e2d97655/comments", "author": {"login": "janusw", "id": 484108, "node_id": "MDQ6VXNlcjQ4NDEwOA==", "avatar_url": "https://avatars.githubusercontent.com/u/484108?v=4", "gravatar_id": "", "url": "https://api.github.com/users/janusw", "html_url": "https://github.com/janusw", "followers_url": "https://api.github.com/users/janusw/followers", "following_url": "https://api.github.com/users/janusw/following{/other_user}", "gists_url": "https://api.github.com/users/janusw/gists{/gist_id}", "starred_url": "https://api.github.com/users/janusw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/janusw/subscriptions", "organizations_url": "https://api.github.com/users/janusw/orgs", "repos_url": "https://api.github.com/users/janusw/repos", "events_url": "https://api.github.com/users/janusw/events{/privacy}", "received_events_url": "https://api.github.com/users/janusw/received_events", "type": "User", "site_admin": false}, "committer": {"login": "janusw", "id": 484108, "node_id": "MDQ6VXNlcjQ4NDEwOA==", "avatar_url": "https://avatars.githubusercontent.com/u/484108?v=4", "gravatar_id": "", "url": "https://api.github.com/users/janusw", "html_url": "https://github.com/janusw", "followers_url": "https://api.github.com/users/janusw/followers", "following_url": "https://api.github.com/users/janusw/following{/other_user}", "gists_url": "https://api.github.com/users/janusw/gists{/gist_id}", "starred_url": "https://api.github.com/users/janusw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/janusw/subscriptions", "organizations_url": "https://api.github.com/users/janusw/orgs", "repos_url": "https://api.github.com/users/janusw/repos", "events_url": "https://api.github.com/users/janusw/events{/privacy}", "received_events_url": "https://api.github.com/users/janusw/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "672ce110a853a23adf8b43c58c48957258d9bf86", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/672ce110a853a23adf8b43c58c48957258d9bf86", "html_url": "https://github.com/Rust-GCC/gccrs/commit/672ce110a853a23adf8b43c58c48957258d9bf86"}], "stats": {"total": 56, "additions": 48, "deletions": 8}, "files": [{"sha": "64acb7a273572781ac57aebaf863f2600691afc8", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f5da9bfb9e7b729db8243f656a1c7341e2d97655/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f5da9bfb9e7b729db8243f656a1c7341e2d97655/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=f5da9bfb9e7b729db8243f656a1c7341e2d97655", "patch": "@@ -1,3 +1,9 @@\n+2018-09-11  Janus Weil  <janus@gcc.gnu.org>\n+\n+\tPR fortran/86830\n+\t* expr.c (gfc_is_simply_contiguous): Handle type-bound procedure calls\n+\twith non-polymorphic objects.\n+\n 2018-09-10  Janus Weil  <janus@gcc.gnu.org>\n \n \tPR fortran/85395"}, {"sha": "97792fe32a7a9c8ab862ac6424f84f49b5dad388", "filename": "gcc/fortran/expr.c", "status": "modified", "additions": 5, "deletions": 8, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f5da9bfb9e7b729db8243f656a1c7341e2d97655/gcc%2Ffortran%2Fexpr.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f5da9bfb9e7b729db8243f656a1c7341e2d97655/gcc%2Ffortran%2Fexpr.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fexpr.c?ref=f5da9bfb9e7b729db8243f656a1c7341e2d97655", "patch": "@@ -5385,16 +5385,13 @@ gfc_is_simply_contiguous (gfc_expr *expr, bool strict, bool permit_element)\n \treturn expr->value.function.esym->result->attr.contiguous;\n       else\n \t{\n-\t  /* We have to jump through some hoops if this is a vtab entry.  */\n-\t  gfc_symbol *s;\n-\t  gfc_ref *r, *rc;\n-\n-\t  s = expr->symtree->n.sym;\n-\t  if (s->ts.type != BT_CLASS)\n+\t  /* Type-bound procedures.  */\n+\t  gfc_symbol *s = expr->symtree->n.sym;\n+\t  if (s->ts.type != BT_CLASS && s->ts.type != BT_DERIVED)\n \t    return false;\n \n-\t  rc = NULL;\n-\t  for (r = expr->ref; r; r = r->next)\n+\t  gfc_ref *rc = NULL;\n+\t  for (gfc_ref *r = expr->ref; r; r = r->next)\n \t    if (r->type == REF_COMPONENT)\n \t      rc = r;\n "}, {"sha": "2af919b99fe263f0e21b58863e6053999d635045", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f5da9bfb9e7b729db8243f656a1c7341e2d97655/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f5da9bfb9e7b729db8243f656a1c7341e2d97655/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=f5da9bfb9e7b729db8243f656a1c7341e2d97655", "patch": "@@ -1,3 +1,8 @@\n+2018-09-11  Janus Weil  <janus@gcc.gnu.org>\n+\n+\tPR fortran/86830\n+\t* gfortran.dg/typebound_call_30.f90: New test case.\n+\n 2018-09-10  Janus Weil  <janus@gcc.gnu.org>\n \n \tPR fortran/85395"}, {"sha": "3ca63bd2a95615d1404eacfdcf61fb6483acbc8e", "filename": "gcc/testsuite/gfortran.dg/typebound_call_30.f90", "status": "added", "additions": 32, "deletions": 0, "changes": 32, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f5da9bfb9e7b729db8243f656a1c7341e2d97655/gcc%2Ftestsuite%2Fgfortran.dg%2Ftypebound_call_30.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f5da9bfb9e7b729db8243f656a1c7341e2d97655/gcc%2Ftestsuite%2Fgfortran.dg%2Ftypebound_call_30.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Ftypebound_call_30.f90?ref=f5da9bfb9e7b729db8243f656a1c7341e2d97655", "patch": "@@ -0,0 +1,32 @@\n+! { dg-do compile }\n+!\n+! PR 86830: [8/9 Regression] Contiguous array pointer function result not recognized as contiguous\n+!\n+! Contributed by <only_for_nouse@gmx.de>\n+\n+module m\n+  implicit none\n+\n+  type :: t1\n+   contains\n+     procedure :: get_ptr\n+  end type\n+\n+  type :: t2\n+     class(t1), allocatable :: c\n+  end type\n+\n+contains\n+\n+  function get_ptr(this)\n+    class(t1) :: this\n+    real, dimension(:), contiguous, pointer :: get_ptr\n+  end function\n+\n+  subroutine test()\n+    real, dimension(:), contiguous, pointer:: ptr\n+    type(t2) :: x\n+    ptr => x%c%get_ptr()\n+  end subroutine\n+\n+end module"}]}