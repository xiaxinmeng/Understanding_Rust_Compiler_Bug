{"sha": "d88513eaf77e9dd8bcc5a662518d18bd350e383c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDg4NTEzZWFmNzdlOWRkOGJjYzVhNjYyNTE4ZDE4YmQzNTBlMzgzYw==", "commit": {"author": {"name": "Patrick Marlier", "email": "patrick.marlier@gmail.com", "date": "2012-08-20T16:22:17Z"}, "committer": {"name": "Patrick Marlier", "email": "pmarlier@gcc.gnu.org", "date": "2012-08-20T16:22:17Z"}, "message": "re PR middle-end/53992 (Combining -fopenmp and -fgnu-tm results in segfault or misbehaving binaries)\n\ngcc/\n2012-08-20  Patrick Marlier  <patrick.marlier@gmail.com>\n\n\tPR middle-end/53992\n\t* omp-low.c (lower_omp_1): Handle GIMPLE_TRANSACTION.\n\ntestsuite/\n2012-08-20  Patrick Marlier  <patrick.marlier@gmail.com>\n\n\tPR middle-end/53992\n\t* gcc.dg/gomp/pr53992.c: New test.\n\nFrom-SVN: r190536", "tree": {"sha": "c3def85f160a15023eb8a51963d1624163e36c6f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c3def85f160a15023eb8a51963d1624163e36c6f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d88513eaf77e9dd8bcc5a662518d18bd350e383c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d88513eaf77e9dd8bcc5a662518d18bd350e383c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d88513eaf77e9dd8bcc5a662518d18bd350e383c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d88513eaf77e9dd8bcc5a662518d18bd350e383c/comments", "author": {"login": "patrickmarlier", "id": 3294919, "node_id": "MDQ6VXNlcjMyOTQ5MTk=", "avatar_url": "https://avatars.githubusercontent.com/u/3294919?v=4", "gravatar_id": "", "url": "https://api.github.com/users/patrickmarlier", "html_url": "https://github.com/patrickmarlier", "followers_url": "https://api.github.com/users/patrickmarlier/followers", "following_url": "https://api.github.com/users/patrickmarlier/following{/other_user}", "gists_url": "https://api.github.com/users/patrickmarlier/gists{/gist_id}", "starred_url": "https://api.github.com/users/patrickmarlier/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/patrickmarlier/subscriptions", "organizations_url": "https://api.github.com/users/patrickmarlier/orgs", "repos_url": "https://api.github.com/users/patrickmarlier/repos", "events_url": "https://api.github.com/users/patrickmarlier/events{/privacy}", "received_events_url": "https://api.github.com/users/patrickmarlier/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "e3b350575018370e7564d9686ede0f804b99637f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e3b350575018370e7564d9686ede0f804b99637f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e3b350575018370e7564d9686ede0f804b99637f"}], "stats": {"total": 34, "additions": 34, "deletions": 0}, "files": [{"sha": "a80dafe88dc02c7dc15e1a94b5359f221e89ad21", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d88513eaf77e9dd8bcc5a662518d18bd350e383c/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d88513eaf77e9dd8bcc5a662518d18bd350e383c/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=d88513eaf77e9dd8bcc5a662518d18bd350e383c", "patch": "@@ -1,3 +1,8 @@\n+2012-08-20  Patrick Marlier  <patrick.marlier@gmail.com>\n+\n+\tPR middle-end/53992\n+\t* omp-low.c (lower_omp_1): Handle GIMPLE_TRANSACTION.\n+\n 2012-08-20  Richard Earnshaw  <rearnsha@arm.com>\n \n \tPR tree-ssa/54295"}, {"sha": "adbd0345f9eec51de1e70f62b8d1c883fb75b52d", "filename": "gcc/omp-low.c", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d88513eaf77e9dd8bcc5a662518d18bd350e383c/gcc%2Fomp-low.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d88513eaf77e9dd8bcc5a662518d18bd350e383c/gcc%2Fomp-low.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fomp-low.c?ref=d88513eaf77e9dd8bcc5a662518d18bd350e383c", "patch": "@@ -6827,6 +6827,9 @@ lower_omp_1 (gimple_stmt_iterator *gsi_p, omp_context *ctx)\n       lower_omp (gimple_try_eval_ptr (stmt), ctx);\n       lower_omp (gimple_try_cleanup_ptr (stmt), ctx);\n       break;\n+    case GIMPLE_TRANSACTION:\n+      lower_omp (gimple_transaction_body_ptr (stmt), ctx);\n+      break;\n     case GIMPLE_BIND:\n       lower_omp (gimple_bind_body_ptr (stmt), ctx);\n       break;"}, {"sha": "3ff68d8de673ebda4687794bb99369543a5f50df", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d88513eaf77e9dd8bcc5a662518d18bd350e383c/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d88513eaf77e9dd8bcc5a662518d18bd350e383c/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=d88513eaf77e9dd8bcc5a662518d18bd350e383c", "patch": "@@ -1,3 +1,8 @@\n+2012-08-20  Patrick Marlier  <patrick.marlier@gmail.com>\n+\n+\tPR middle-end/53992\n+\t* gcc.dg/gomp/pr53992.c: New test.\n+\n 2012-08-20  Richard Earnshaw  <rearnsha@arm.com>\n \n \tPR tree-ssa/54295"}, {"sha": "4d5af3ce785577f13cddb655a0989d21cb30cd8f", "filename": "gcc/testsuite/gcc.dg/gomp/pr53992.c", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d88513eaf77e9dd8bcc5a662518d18bd350e383c/gcc%2Ftestsuite%2Fgcc.dg%2Fgomp%2Fpr53992.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d88513eaf77e9dd8bcc5a662518d18bd350e383c/gcc%2Ftestsuite%2Fgcc.dg%2Fgomp%2Fpr53992.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fgomp%2Fpr53992.c?ref=d88513eaf77e9dd8bcc5a662518d18bd350e383c", "patch": "@@ -0,0 +1,21 @@\n+/* PR middle-end/53992 */\n+/* { dg-do compile } */\n+/* { dg-options \"-fgnu-tm -fopenmp\" } */\n+/* { dg-require-effective-target fgnu_tm } */\n+\n+int main() {\n+    long data[10000];\n+    long i, min=10000;\n+    for (i=0; i<10000; i++) data[i] = -i;\n+            \n+#pragma omp parallel for\n+    for (i=0; i<10000; i++) {\n+        __transaction_atomic\n+        {\n+            if (data[i] < min)\n+                min = data[i];\n+        }\n+    }\n+\n+    return !(min == -9999);\n+}"}]}