{"sha": "b829f3fac7e1c736df642ace45589e8d24ae2731", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjgyOWYzZmFjN2UxYzczNmRmNjQyYWNlNDU1ODllOGQyNGFlMjczMQ==", "commit": {"author": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2004-09-10T08:58:47Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2004-09-10T08:58:47Z"}, "message": "tree-ssa-dce.c (remove_dead_stmt): Update profile.\n\n\t* tree-ssa-dce.c (remove_dead_stmt): Update profile.\n\t* tree-split_edge.c (tree_split_edge): Likewise.\n\t(thread_jumps): Likewise.\n\nFrom-SVN: r87284", "tree": {"sha": "a9f89767bf8754a717564aa16cdeed6f7574c14f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a9f89767bf8754a717564aa16cdeed6f7574c14f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b829f3fac7e1c736df642ace45589e8d24ae2731", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b829f3fac7e1c736df642ace45589e8d24ae2731", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b829f3fac7e1c736df642ace45589e8d24ae2731", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b829f3fac7e1c736df642ace45589e8d24ae2731/comments", "author": null, "committer": null, "parents": [{"sha": "229031d0e2ec3c74d8dcc0abe20b2906026fd978", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/229031d0e2ec3c74d8dcc0abe20b2906026fd978", "html_url": "https://github.com/Rust-GCC/gccrs/commit/229031d0e2ec3c74d8dcc0abe20b2906026fd978"}], "stats": {"total": 26, "additions": 26, "deletions": 0}, "files": [{"sha": "af1e98e1d65b49e71c375975d1d1e5a49495cf75", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b829f3fac7e1c736df642ace45589e8d24ae2731/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b829f3fac7e1c736df642ace45589e8d24ae2731/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=b829f3fac7e1c736df642ace45589e8d24ae2731", "patch": "@@ -1,3 +1,9 @@\n+2004-09-10  Jan Hubicka  <jh@suse.cz>\n+\n+\t* tree-ssa-dce.c (remove_dead_stmt): Update profile.\n+\t* tree-split_edge.c (tree_split_edge): Likewise.\n+\t(thread_jumps): Likewise.\n+\n 2004-09-10  Kazu Hirata  <kazu@cs.umass.edu>\n \n \t* cgraphunit.c, predict.c, tree-ssa-loop-ivopts.c: Fix comment"}, {"sha": "14f7d1da8bd90c1b5946c9176e2bb8d70a78e49b", "filename": "gcc/tree-cfg.c", "status": "modified", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b829f3fac7e1c736df642ace45589e8d24ae2731/gcc%2Ftree-cfg.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b829f3fac7e1c736df642ace45589e8d24ae2731/gcc%2Ftree-cfg.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-cfg.c?ref=b829f3fac7e1c736df642ace45589e8d24ae2731", "patch": "@@ -3018,7 +3018,11 @@ tree_split_edge (edge edge_in)\n     after_bb = edge_in->src;\n \n   new_bb = create_empty_bb (after_bb);\n+  new_bb->frequency = EDGE_FREQUENCY (edge_in);\n+  new_bb->count = edge_in->count;\n   new_edge = make_edge (new_bb, dest, EDGE_FALLTHRU);\n+  new_edge->probability = REG_BR_PROB_BASE;\n+  new_edge->count = edge_in->count;\n \n   /* Find all the PHI arguments on the original edge, and change them to\n      the new edge.  Do it before redirection, so that the argument does not\n@@ -3852,6 +3856,8 @@ thread_jumps (void)\n \t forwardable.  */\n       for (e = bb->succ; e; e = next)\n \t{\n+\t  int freq;\n+\t  gcov_type count;\n \t  next = e->succ_next;\n \n \t  /* If the edge is abnormal or its destination is not\n@@ -3860,6 +3866,9 @@ thread_jumps (void)\n \t      || !tree_forwarder_block_p (e->dest))\n \t    continue;\n \n+\t  count = e->count;\n+\t  freq = EDGE_FREQUENCY (e);\n+\n \t  /* Now walk through as many forwarder block as possible to\n \t     find the ultimate destination we want to thread our jump\n \t     to.  */\n@@ -3879,6 +3888,15 @@ thread_jumps (void)\n \t\tbreak;\n \n \t      bb_ann (dest)->forwardable = 0;\n+\t      dest->frequency -= freq;\n+\t      if (dest->frequency < 0)\n+\t\tdest->frequency = 0;\n+\t      dest->count -= count;\n+\t      if (dest->count < 0)\n+\t\tdest->count = 0;\n+\t      dest->succ->count -= count;\n+\t      if (dest->succ->count < 0)\n+\t\tdest->succ->count = 0;\n \t    }\n \n \t  /* Reset the forwardable marks to 1.  */"}, {"sha": "fec54ab40fb840f93c38d6dd53333d5afc458a54", "filename": "gcc/tree-ssa-dce.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b829f3fac7e1c736df642ace45589e8d24ae2731/gcc%2Ftree-ssa-dce.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b829f3fac7e1c736df642ace45589e8d24ae2731/gcc%2Ftree-ssa-dce.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-dce.c?ref=b829f3fac7e1c736df642ace45589e8d24ae2731", "patch": "@@ -739,6 +739,8 @@ remove_dead_stmt (block_stmt_iterator *i, basic_block bb)\n       /* Redirect the first edge out of BB to reach POST_DOM_BB.  */\n       redirect_edge_and_branch (bb->succ, post_dom_bb);\n       PENDING_STMT (bb->succ) = NULL;\n+      bb->succ->probability = REG_BR_PROB_BASE;\n+      bb->succ->count = bb->count;\n \n       /* The edge is no longer associated with a conditional, so it does\n \t not have TRUE/FALSE flags.  */"}]}