{"sha": "28665ddc7efa48f9b39615e313a2c4a7a66cdb24", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Mjg2NjVkZGM3ZWZhNDhmOWIzOTYxNWUzMTNhMmM0YTdhNjZjZGIyNA==", "commit": {"author": {"name": "Thomas Schwinge", "email": "thomas@codesourcery.com", "date": "2021-07-30T09:48:54Z"}, "committer": {"name": "Thomas Schwinge", "email": "thomas@codesourcery.com", "date": "2021-07-30T10:02:15Z"}, "message": "[libgomp] Restore offloading 'libgomp/fortran.c'\n\nGCN:\n\n    ld: error: undefined symbol: gomp_ialias_omp_display_env\n    >>> referenced by fortran.c:744 ([...]/source-gcc/libgomp/fortran.c:744)\n    >>>               fortran.o:(omp_display_env_) in archive [...]/build-gcc-offload-amdgcn-amdhsa/amdgcn-amdhsa/libgomp/.libs/libgomp.a\n    >>> referenced by fortran.c:744 ([...]/source-gcc/libgomp/fortran.c:744)\n    >>>               fortran.o:(omp_display_env_) in archive [...]/build-gcc-offload-amdgcn-amdhsa/amdgcn-amdhsa/libgomp/.libs/libgomp.a\n    >>> referenced by fortran.c:750 ([...]/source-gcc/libgomp/fortran.c:750)\n    >>>               fortran.o:(omp_display_env_8_) in archive [...]/build-gcc-offload-amdgcn-amdhsa/amdgcn-amdhsa/libgomp/.libs/libgomp.a\n    >>> referenced by fortran.c:750 ([...]/source-gcc/libgomp/fortran.c:750)\n    >>>               fortran.o:(omp_display_env_8_) in archive [...]/build-gcc-offload-amdgcn-amdhsa/amdgcn-amdhsa/libgomp/.libs/libgomp.a\n    collect2: error: ld returned 1 exit status\n    mkoffload: fatal error: build-gcc/gcc/x86_64-pc-linux-gnu-accel-amdgcn-amdhsa-gcc returned 1 exit status\n\nnvptx:\n\n    unresolved symbol omp_display_env\n    collect2: error: ld returned 1 exit status\n    mkoffload: fatal error: [...]/build-gcc/./gcc/x86_64-pc-linux-gnu-accel-nvptx-none-gcc returned 1 exit status\n\nFix-up for commit 7123ae2455b5a1a2f19f13fa82c377cfda157f23\n\"Implement OpenMP 5.1 section 3.15: omp_display_env\".\n\n\tlibgomp/\n\t* fortran.c (omp_display_env_, omp_display_env_8_): Only\n\t'#ifndef LIBGOMP_OFFLOADED_ONLY'.\n\nCo-Authored-By: Ulrich Drepper <drepper@redhat.com>", "tree": {"sha": "5b28470d06cd4436f8f603c91b4a053786b5827e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5b28470d06cd4436f8f603c91b4a053786b5827e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/28665ddc7efa48f9b39615e313a2c4a7a66cdb24", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/28665ddc7efa48f9b39615e313a2c4a7a66cdb24", "html_url": "https://github.com/Rust-GCC/gccrs/commit/28665ddc7efa48f9b39615e313a2c4a7a66cdb24", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/28665ddc7efa48f9b39615e313a2c4a7a66cdb24/comments", "author": {"login": "tschwinge", "id": 21753, "node_id": "MDQ6VXNlcjIxNzUz", "avatar_url": "https://avatars.githubusercontent.com/u/21753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tschwinge", "html_url": "https://github.com/tschwinge", "followers_url": "https://api.github.com/users/tschwinge/followers", "following_url": "https://api.github.com/users/tschwinge/following{/other_user}", "gists_url": "https://api.github.com/users/tschwinge/gists{/gist_id}", "starred_url": "https://api.github.com/users/tschwinge/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tschwinge/subscriptions", "organizations_url": "https://api.github.com/users/tschwinge/orgs", "repos_url": "https://api.github.com/users/tschwinge/repos", "events_url": "https://api.github.com/users/tschwinge/events{/privacy}", "received_events_url": "https://api.github.com/users/tschwinge/received_events", "type": "User", "site_admin": false}, "committer": {"login": "tschwinge", "id": 21753, "node_id": "MDQ6VXNlcjIxNzUz", "avatar_url": "https://avatars.githubusercontent.com/u/21753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tschwinge", "html_url": "https://github.com/tschwinge", "followers_url": "https://api.github.com/users/tschwinge/followers", "following_url": "https://api.github.com/users/tschwinge/following{/other_user}", "gists_url": "https://api.github.com/users/tschwinge/gists{/gist_id}", "starred_url": "https://api.github.com/users/tschwinge/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tschwinge/subscriptions", "organizations_url": "https://api.github.com/users/tschwinge/orgs", "repos_url": "https://api.github.com/users/tschwinge/repos", "events_url": "https://api.github.com/users/tschwinge/events{/privacy}", "received_events_url": "https://api.github.com/users/tschwinge/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5a973aec601cb69024e0ebf6b0961906cec7c446", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5a973aec601cb69024e0ebf6b0961906cec7c446", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5a973aec601cb69024e0ebf6b0961906cec7c446"}], "stats": {"total": 4, "additions": 4, "deletions": 0}, "files": [{"sha": "e042702ac91d2406b5a5f7373308b097575882ea", "filename": "libgomp/fortran.c", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/28665ddc7efa48f9b39615e313a2c4a7a66cdb24/libgomp%2Ffortran.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/28665ddc7efa48f9b39615e313a2c4a7a66cdb24/libgomp%2Ffortran.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Ffortran.c?ref=28665ddc7efa48f9b39615e313a2c4a7a66cdb24", "patch": "@@ -738,6 +738,8 @@ omp_get_default_allocator_ ()\n   return (intptr_t) omp_get_default_allocator ();\n }\n \n+#ifndef LIBGOMP_OFFLOADED_ONLY\n+\n void\n omp_display_env_ (const int32_t *verbose)\n {\n@@ -749,3 +751,5 @@ omp_display_env_8_ (const int64_t *verbose)\n {\n   omp_display_env (!!*verbose);\n }\n+\n+#endif /* LIBGOMP_OFFLOADED_ONLY */"}]}