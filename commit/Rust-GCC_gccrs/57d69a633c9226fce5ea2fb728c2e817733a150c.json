{"sha": "57d69a633c9226fce5ea2fb728c2e817733a150c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTdkNjlhNjMzYzkyMjZmY2U1ZWEyZmI3MjhjMmU4MTc3MzNhMTUwYw==", "commit": {"author": {"name": "Vladimir Makarov", "email": "vmakarov@redhat.com", "date": "2017-10-18T16:44:27Z"}, "committer": {"name": "Vladimir Makarov", "email": "vmakarov@gcc.gnu.org", "date": "2017-10-18T16:44:27Z"}, "message": "re PR middle-end/82556 (internal compiler error in curr_insn_transform, at lra-constraints.c:4307)\n\n2017-10-18  Vladimir Makarov  <vmakarov@redhat.com>\n\n\tPR middle-end/82556\n\t* lra-constraints.c (curr_insn_transform): Use non-input operand\n\tinstead of output one for matched reload.\n\n2017-10-18  Vladimir Makarov  <vmakarov@redhat.com>\n\n\tPR middle-end/82556\n\t* gcc.target/i386/pr82556.c: New.\n\nFrom-SVN: r253862", "tree": {"sha": "a74e0a7ed117796aebfa269cef6ed1a6b516c7d4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a74e0a7ed117796aebfa269cef6ed1a6b516c7d4"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/57d69a633c9226fce5ea2fb728c2e817733a150c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/57d69a633c9226fce5ea2fb728c2e817733a150c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/57d69a633c9226fce5ea2fb728c2e817733a150c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/57d69a633c9226fce5ea2fb728c2e817733a150c/comments", "author": {"login": "vnmakarov", "id": 9855671, "node_id": "MDQ6VXNlcjk4NTU2NzE=", "avatar_url": "https://avatars.githubusercontent.com/u/9855671?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vnmakarov", "html_url": "https://github.com/vnmakarov", "followers_url": "https://api.github.com/users/vnmakarov/followers", "following_url": "https://api.github.com/users/vnmakarov/following{/other_user}", "gists_url": "https://api.github.com/users/vnmakarov/gists{/gist_id}", "starred_url": "https://api.github.com/users/vnmakarov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vnmakarov/subscriptions", "organizations_url": "https://api.github.com/users/vnmakarov/orgs", "repos_url": "https://api.github.com/users/vnmakarov/repos", "events_url": "https://api.github.com/users/vnmakarov/events{/privacy}", "received_events_url": "https://api.github.com/users/vnmakarov/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "957f0d8faf41d64fa4ba548411e6d4dd95a083bf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/957f0d8faf41d64fa4ba548411e6d4dd95a083bf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/957f0d8faf41d64fa4ba548411e6d4dd95a083bf"}], "stats": {"total": 47, "additions": 44, "deletions": 3}, "files": [{"sha": "59e0910f8a7dbb390d12d3f9e7a367826ff29225", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/57d69a633c9226fce5ea2fb728c2e817733a150c/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/57d69a633c9226fce5ea2fb728c2e817733a150c/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=57d69a633c9226fce5ea2fb728c2e817733a150c", "patch": "@@ -1,3 +1,9 @@\n+2017-10-18  Vladimir Makarov  <vmakarov@redhat.com>\n+\n+\tPR middle-end/82556\n+\t* lra-constraints.c (curr_insn_transform): Use non-input operand\n+\tinstead of output one for matched reload.\n+\n 2017-10-18  Bin Cheng  <bin.cheng@arm.com>\n \n \t* tree-loop-distribution.c (INCLUDE_ALGORITHM): New header file."}, {"sha": "6163d7d5056700c603b5feaa6118bc8eece8d893", "filename": "gcc/lra-constraints.c", "status": "modified", "additions": 14, "deletions": 3, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/57d69a633c9226fce5ea2fb728c2e817733a150c/gcc%2Flra-constraints.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/57d69a633c9226fce5ea2fb728c2e817733a150c/gcc%2Flra-constraints.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flra-constraints.c?ref=57d69a633c9226fce5ea2fb728c2e817733a150c", "patch": "@@ -4271,7 +4271,13 @@ curr_insn_transform (bool check_only_p)\n \t}\n       else if (curr_static_id->operand[i].type == OP_IN\n \t       && (curr_static_id->operand[goal_alt_matched[i][0]].type\n-\t\t   == OP_OUT))\n+\t\t   == OP_OUT\n+\t\t   || (curr_static_id->operand[goal_alt_matched[i][0]].type\n+\t\t       == OP_INOUT\n+\t\t       && (operands_match_p\n+\t\t\t   (*curr_id->operand_loc[i],\n+\t\t\t    *curr_id->operand_loc[goal_alt_matched[i][0]],\n+\t\t\t    -1)))))\n \t{\n \t  /* generate reloads for input and matched outputs.  */\n \t  match_inputs[0] = i;\n@@ -4282,9 +4288,14 @@ curr_insn_transform (bool check_only_p)\n \t\t\t[goal_alt_number * n_operands + goal_alt_matched[i][0]]\n \t\t\t.earlyclobber);\n \t}\n-      else if (curr_static_id->operand[i].type == OP_OUT\n+      else if ((curr_static_id->operand[i].type == OP_OUT\n+\t\t|| (curr_static_id->operand[i].type == OP_INOUT\n+\t\t    && (operands_match_p\n+\t\t\t(*curr_id->operand_loc[i],\n+\t\t\t *curr_id->operand_loc[goal_alt_matched[i][0]],\n+\t\t\t -1))))\n \t       && (curr_static_id->operand[goal_alt_matched[i][0]].type\n-\t\t   == OP_IN))\n+\t\t    == OP_IN))\n \t/* Generate reloads for output and matched inputs.  */\n \tmatch_reload (i, goal_alt_matched[i], outputs, goal_alt[i], &before,\n \t\t      &after, curr_static_id->operand_alternative"}, {"sha": "42cdbd6b61a6653b9e8afd51aa670905a41f4213", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/57d69a633c9226fce5ea2fb728c2e817733a150c/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/57d69a633c9226fce5ea2fb728c2e817733a150c/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=57d69a633c9226fce5ea2fb728c2e817733a150c", "patch": "@@ -1,3 +1,8 @@\n+2017-10-18  Vladimir Makarov  <vmakarov@redhat.com>\n+\n+\tPR middle-end/82556\n+\t* gcc.target/i386/pr82556.c: New.\n+\n 2017-10-18  Bin Cheng  <bin.cheng@arm.com>\n \n \t* gcc.dg/tree-ssa/ldist-17.c: Adjust test string."}, {"sha": "409a301af305b9a945060f3d6a43924f228bdaee", "filename": "gcc/testsuite/gcc.target/i386/pr82556.c", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/57d69a633c9226fce5ea2fb728c2e817733a150c/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr82556.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/57d69a633c9226fce5ea2fb728c2e817733a150c/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr82556.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr82556.c?ref=57d69a633c9226fce5ea2fb728c2e817733a150c", "patch": "@@ -0,0 +1,19 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -fno-strict-aliasing -fwrapv -fexcess-precision=standard\" } */\n+extern int foo();\n+typedef struct {\n+  char id;\n+  unsigned char fork_flags;\n+  short data_length;\n+} Header;\n+int a;\n+void X() {\n+  do {\n+    char* b;\n+    Header c;\n+    if (a)\n+      c.fork_flags |= 1;\n+    __builtin_memcpy(b, &c, __builtin_offsetof(Header, data_length));\n+    b += foo();\n+  } while (1);\n+}"}]}