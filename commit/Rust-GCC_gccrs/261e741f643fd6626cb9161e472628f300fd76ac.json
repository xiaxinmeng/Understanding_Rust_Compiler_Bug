{"sha": "261e741f643fd6626cb9161e472628f300fd76ac", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjYxZTc0MWY2NDNmZDY2MjZjYjkxNjFlNDcyNjI4ZjMwMGZkNzZhYw==", "commit": {"author": {"name": "Mark Wielaard", "email": "mjw@redhat.com", "date": "2016-02-23T11:47:19Z"}, "committer": {"name": "Mark Wielaard", "email": "mark@gcc.gnu.org", "date": "2016-02-23T11:47:19Z"}, "message": "PR c/69911 Check main_input_filename and DECL_SOURCE_FILE are not NULL.\n\nDECL_SOURCE_FILE can be NULL (for example when DECL_ARTIFICIAL).\nSo make sure to check before comparing against main_input_filename.\n\ngcc/ChangeLog\n\n\tPR c/69911\n\t* cgraphunit.c (check_global_declaration): Check main_input_filename\n\tand DECL_SOURCE_FILE are not NULL.\n\nCo-Authored-By: Jakub Jelinek <jakub@redhat.com>\n\nFrom-SVN: r233627", "tree": {"sha": "7bef3c40118e7118a920fbe40b6b0f6bfca1a63f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7bef3c40118e7118a920fbe40b6b0f6bfca1a63f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/261e741f643fd6626cb9161e472628f300fd76ac", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/261e741f643fd6626cb9161e472628f300fd76ac", "html_url": "https://github.com/Rust-GCC/gccrs/commit/261e741f643fd6626cb9161e472628f300fd76ac", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/261e741f643fd6626cb9161e472628f300fd76ac/comments", "author": null, "committer": null, "parents": [{"sha": "20c5e09e3f0d681a4f82acd01fd4c91816f7d21e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/20c5e09e3f0d681a4f82acd01fd4c91816f7d21e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/20c5e09e3f0d681a4f82acd01fd4c91816f7d21e"}], "stats": {"total": 14, "additions": 12, "deletions": 2}, "files": [{"sha": "2c77b39666d31ddc1c903fb77f62a5bafb01071c", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/261e741f643fd6626cb9161e472628f300fd76ac/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/261e741f643fd6626cb9161e472628f300fd76ac/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=261e741f643fd6626cb9161e472628f300fd76ac", "patch": "@@ -1,3 +1,10 @@\n+2016-02-23  Mark Wielaard  <mjw@redhat.com>\n+\t    Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR c/69911\n+\t* cgraphunit.c (check_global_declaration): Check main_input_filename\n+\tand DECL_SOURCE_FILE are not NULL.\n+\n 2016-02-23  Martin Jambor  <mjambor@suse.cz>\n \n \tPR tree-optimization/69666"}, {"sha": "8b3fddc435ebb2b18306066ca88e718099f0cf76", "filename": "gcc/cgraphunit.c", "status": "modified", "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/261e741f643fd6626cb9161e472628f300fd76ac/gcc%2Fcgraphunit.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/261e741f643fd6626cb9161e472628f300fd76ac/gcc%2Fcgraphunit.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcgraphunit.c?ref=261e741f643fd6626cb9161e472628f300fd76ac", "patch": "@@ -917,6 +917,7 @@ walk_polymorphic_call_targets (hash_set<void *> *reachable_call_targets,\n static void\n check_global_declaration (symtab_node *snode)\n {\n+  const char *decl_file;\n   tree decl = snode->decl;\n \n   /* Warn about any function declared static but not defined.  We don't\n@@ -944,8 +945,10 @@ check_global_declaration (symtab_node *snode)\n        || (((warn_unused_variable && ! TREE_READONLY (decl))\n \t    || (warn_unused_const_variable > 0 && TREE_READONLY (decl)\n \t\t&& (warn_unused_const_variable == 2\n-\t\t    || filename_cmp (main_input_filename,\n-\t\t\t\t     DECL_SOURCE_FILE (decl)) == 0)))\n+\t\t    || (main_input_filename != NULL\n+\t\t\t&& (decl_file = DECL_SOURCE_FILE (decl)) != NULL\n+\t\t\t&& filename_cmp (main_input_filename,\n+\t\t\t\t\t decl_file) == 0))))\n \t   && TREE_CODE (decl) == VAR_DECL))\n       && ! DECL_IN_SYSTEM_HEADER (decl)\n       && ! snode->referred_to_p (/*include_self=*/false)"}]}