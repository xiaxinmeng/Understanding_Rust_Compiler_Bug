{"sha": "d03ae4be2c6d48255b18bb35dc25e551bd3a3b9d", "node_id": "C_kwDOANBUbNoAKGQwM2FlNGJlMmM2ZDQ4MjU1YjE4YmIzNWRjMjVlNTUxYmQzYTNiOWQ", "commit": {"author": {"name": "David Malcolm", "email": "dmalcolm@redhat.com", "date": "2023-02-01T02:18:22Z"}, "committer": {"name": "David Malcolm", "email": "dmalcolm@redhat.com", "date": "2023-02-01T02:18:22Z"}, "message": "analyzer: fix uses of alloca in testsuite\n\ngcc/testsuite/ChangeLog:\n\t* gcc.dg/analyzer/call-summaries-2.c: Add\n\tdg-require-effective-target alloca.\n\t* gcc.dg/analyzer/imprecise-floating-point-1.c: Likewise.\n\t* gcc.dg/analyzer/infinite-recursion-alloca.c: Likewise.\n\t* gcc.dg/analyzer/malloc-callbacks.c: Likewise.\n\t* gcc.dg/analyzer/out-of-bounds-5.c: Likewise.  Remove includes\n\tof <stdio.h> and <alloca.h>.  Use \"__builtin_free\" rather than\n\t\"free\", to match uses of \"__builtin_malloc\".\n\t* gcc.dg/analyzer/putenv-1.c: Add dg-require-effective-target\n\talloca.\n\t* gcc.dg/analyzer/write-to-string-literal-5.c: Likewise.\n\nSigned-off-by: David Malcolm <dmalcolm@redhat.com>", "tree": {"sha": "87274ef309170a0f6516a03dfc6f289b61da3be0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/87274ef309170a0f6516a03dfc6f289b61da3be0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d03ae4be2c6d48255b18bb35dc25e551bd3a3b9d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d03ae4be2c6d48255b18bb35dc25e551bd3a3b9d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d03ae4be2c6d48255b18bb35dc25e551bd3a3b9d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d03ae4be2c6d48255b18bb35dc25e551bd3a3b9d/comments", "author": {"login": "davidmalcolm", "id": 1553248, "node_id": "MDQ6VXNlcjE1NTMyNDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1553248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidmalcolm", "html_url": "https://github.com/davidmalcolm", "followers_url": "https://api.github.com/users/davidmalcolm/followers", "following_url": "https://api.github.com/users/davidmalcolm/following{/other_user}", "gists_url": "https://api.github.com/users/davidmalcolm/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidmalcolm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidmalcolm/subscriptions", "organizations_url": "https://api.github.com/users/davidmalcolm/orgs", "repos_url": "https://api.github.com/users/davidmalcolm/repos", "events_url": "https://api.github.com/users/davidmalcolm/events{/privacy}", "received_events_url": "https://api.github.com/users/davidmalcolm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "davidmalcolm", "id": 1553248, "node_id": "MDQ6VXNlcjE1NTMyNDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1553248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidmalcolm", "html_url": "https://github.com/davidmalcolm", "followers_url": "https://api.github.com/users/davidmalcolm/followers", "following_url": "https://api.github.com/users/davidmalcolm/following{/other_user}", "gists_url": "https://api.github.com/users/davidmalcolm/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidmalcolm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidmalcolm/subscriptions", "organizations_url": "https://api.github.com/users/davidmalcolm/orgs", "repos_url": "https://api.github.com/users/davidmalcolm/repos", "events_url": "https://api.github.com/users/davidmalcolm/events{/privacy}", "received_events_url": "https://api.github.com/users/davidmalcolm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "70d34f2a30a5f1a2a09f547d92243db32d79f3f7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/70d34f2a30a5f1a2a09f547d92243db32d79f3f7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/70d34f2a30a5f1a2a09f547d92243db32d79f3f7"}], "stats": {"total": 18, "additions": 13, "deletions": 5}, "files": [{"sha": "2d82d02e4e22b3c085f153ca89a4ad727ba5a2b2", "filename": "gcc/testsuite/gcc.dg/analyzer/call-summaries-2.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d03ae4be2c6d48255b18bb35dc25e551bd3a3b9d/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fcall-summaries-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d03ae4be2c6d48255b18bb35dc25e551bd3a3b9d/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fcall-summaries-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fcall-summaries-2.c?ref=d03ae4be2c6d48255b18bb35dc25e551bd3a3b9d", "patch": "@@ -1,4 +1,5 @@\n /* { dg-additional-options \"-fanalyzer-call-summaries --param analyzer-min-snodes-for-call-summary=0\" } */\n+/* { dg-require-effective-target alloca } */\n \n /* There need to be at least two calls to a function for the\n    call-summarization code to be used."}, {"sha": "7fe09fb826b96f41d2dd3c2448636645ac22782a", "filename": "gcc/testsuite/gcc.dg/analyzer/imprecise-floating-point-1.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d03ae4be2c6d48255b18bb35dc25e551bd3a3b9d/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fimprecise-floating-point-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d03ae4be2c6d48255b18bb35dc25e551bd3a3b9d/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fimprecise-floating-point-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fimprecise-floating-point-1.c?ref=d03ae4be2c6d48255b18bb35dc25e551bd3a3b9d", "patch": "@@ -1,3 +1,5 @@\n+/* { dg-require-effective-target alloca } */\n+\n #include <stdlib.h>\n \n /* Tests warn on use of floating-point operands inside the calculation"}, {"sha": "87727e8ca25b60f2fd1c0f2890105d09b8bd33f7", "filename": "gcc/testsuite/gcc.dg/analyzer/infinite-recursion-alloca.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d03ae4be2c6d48255b18bb35dc25e551bd3a3b9d/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Finfinite-recursion-alloca.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d03ae4be2c6d48255b18bb35dc25e551bd3a3b9d/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Finfinite-recursion-alloca.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Finfinite-recursion-alloca.c?ref=d03ae4be2c6d48255b18bb35dc25e551bd3a3b9d", "patch": "@@ -1,3 +1,5 @@\n+/* { dg-require-effective-target alloca } */\n+\n typedef __SIZE_TYPE__ size_t;\n \n int test_alloca_1 (void)"}, {"sha": "cf3927fcaeaf475bd2621237045f84bae3bafbc4", "filename": "gcc/testsuite/gcc.dg/analyzer/malloc-callbacks.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d03ae4be2c6d48255b18bb35dc25e551bd3a3b9d/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fmalloc-callbacks.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d03ae4be2c6d48255b18bb35dc25e551bd3a3b9d/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fmalloc-callbacks.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fmalloc-callbacks.c?ref=d03ae4be2c6d48255b18bb35dc25e551bd3a3b9d", "patch": "@@ -1,3 +1,5 @@\n+/* { dg-require-effective-target alloca } */\n+\n #include <stdlib.h>\n \n typedef void *(*allocator_t) (size_t);"}, {"sha": "2a61d8ca2362f7dd46f186acbc51066757dd7e59", "filename": "gcc/testsuite/gcc.dg/analyzer/out-of-bounds-5.c", "status": "modified", "additions": 4, "deletions": 5, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d03ae4be2c6d48255b18bb35dc25e551bd3a3b9d/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fout-of-bounds-5.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d03ae4be2c6d48255b18bb35dc25e551bd3a3b9d/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fout-of-bounds-5.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fout-of-bounds-5.c?ref=d03ae4be2c6d48255b18bb35dc25e551bd3a3b9d", "patch": "@@ -1,9 +1,8 @@\n /* { dg-additional-options \"-Wno-unused-but-set-variable\" } */\n+/* { dg-require-effective-target alloca } */\n \n #include <string.h>\n-#include <stdio.h>\n #include <stdlib.h>\n-#include <alloca.h>\n #include <stdint.h>\n \n /* Tests with symbolic values.  */\n@@ -14,7 +13,7 @@ void test1 (size_t size)\n   if (!buf) return;\n \n   buf[size] = '\\0'; /* { dg-warning \"heap-based buffer overflow\" } */\n-  free (buf);\n+  __builtin_free (buf);\n }\n \n void test2 (size_t size)\n@@ -23,7 +22,7 @@ void test2 (size_t size)\n   if (!buf) return;\n \n   buf[size + 1] = '\\0'; /* { dg-warning \"heap-based buffer overflow\" } */\n-  free (buf);\n+  __builtin_free (buf);\n }\n \n void test3 (size_t size, size_t op)\n@@ -32,7 +31,7 @@ void test3 (size_t size, size_t op)\n   if (!buf) return;\n \n   buf[size + op] = '\\0'; /* { dg-warning \"heap-based buffer overflow\" } */\n-  free (buf);\n+  __builtin_free (buf);\n }\n \n void test4 (size_t size, unsigned short s)"}, {"sha": "543121258c8fade1779aa32a670ec0ad70f928ac", "filename": "gcc/testsuite/gcc.dg/analyzer/putenv-1.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d03ae4be2c6d48255b18bb35dc25e551bd3a3b9d/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fputenv-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d03ae4be2c6d48255b18bb35dc25e551bd3a3b9d/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fputenv-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fputenv-1.c?ref=d03ae4be2c6d48255b18bb35dc25e551bd3a3b9d", "patch": "@@ -1,4 +1,5 @@\n /* { dg-additional-options \"-Wno-analyzer-null-argument\" } */\n+/* { dg-require-effective-target alloca } */\n \n #include <stdio.h>\n #include <stdlib.h>"}, {"sha": "42efc49fb22ec8e44d0a04f6b109557f5495b131", "filename": "gcc/testsuite/gcc.dg/analyzer/write-to-string-literal-5.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d03ae4be2c6d48255b18bb35dc25e551bd3a3b9d/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fwrite-to-string-literal-5.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d03ae4be2c6d48255b18bb35dc25e551bd3a3b9d/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fwrite-to-string-literal-5.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fwrite-to-string-literal-5.c?ref=d03ae4be2c6d48255b18bb35dc25e551bd3a3b9d", "patch": "@@ -2,6 +2,7 @@\n    notes) works.  */\n \n /* { dg-additional-options \"-fanalyzer-show-duplicate-count\" } */\n+/* { dg-require-effective-target alloca } */\n \n #include \"analyzer-decls.h\"\n "}]}