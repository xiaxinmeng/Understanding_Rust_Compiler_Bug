{"sha": "7e1fe87899932e2c265fd0a13b2ac552b0865e0f", "node_id": "C_kwDOANBUbNoAKDdlMWZlODc4OTk5MzJlMmMyNjVmZDBhMTNiMmFjNTUyYjA4NjVlMGY", "commit": {"author": {"name": "Steve Baird", "email": "baird@adacore.com", "date": "2022-10-08T00:20:31Z"}, "committer": {"name": "Marc Poulhi\u00e8s", "email": "poulhies@adacore.com", "date": "2022-11-04T13:47:30Z"}, "message": "ada: Static intrinsic functions are a core language extension.\n\nGNAT-defined Ada extensions are divided into two categories: those that are\nenabled by either -gnatX or -gnatX0 and those which require -gnatX0.\nMove static intrinsic functions from the second category into the first.\n\ngcc/ada/\n\n\t* doc/gnat_rm/implementation_defined_pragmas.rst: Add the standard\n\t'... \"On\" enables this extension.' sentence to the description of\n\tstatic intrinsic functions.\n\t* sem_ch13.adb\n\t(Analyze_Aspect_Spec): In the call to Error_Msg_GNAT_Extension for\n\ta Static aspect specification for an intrinsic function, specify\n\tIs_Core_Extension => True.\n\t* sem_eval.adb\n\t(Eval_Intrinsic_Call): Test Core_Extensions_Allowed instead of\n\ttesting All_Extensions_Allowed.\n\t* gnat_rm.texi: Regenerate.", "tree": {"sha": "7b815b99c755d9f297217beaf5f84bfca1f6b92e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7b815b99c755d9f297217beaf5f84bfca1f6b92e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7e1fe87899932e2c265fd0a13b2ac552b0865e0f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7e1fe87899932e2c265fd0a13b2ac552b0865e0f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7e1fe87899932e2c265fd0a13b2ac552b0865e0f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7e1fe87899932e2c265fd0a13b2ac552b0865e0f/comments", "author": {"login": "swbaird", "id": 50751052, "node_id": "MDQ6VXNlcjUwNzUxMDUy", "avatar_url": "https://avatars.githubusercontent.com/u/50751052?v=4", "gravatar_id": "", "url": "https://api.github.com/users/swbaird", "html_url": "https://github.com/swbaird", "followers_url": "https://api.github.com/users/swbaird/followers", "following_url": "https://api.github.com/users/swbaird/following{/other_user}", "gists_url": "https://api.github.com/users/swbaird/gists{/gist_id}", "starred_url": "https://api.github.com/users/swbaird/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/swbaird/subscriptions", "organizations_url": "https://api.github.com/users/swbaird/orgs", "repos_url": "https://api.github.com/users/swbaird/repos", "events_url": "https://api.github.com/users/swbaird/events{/privacy}", "received_events_url": "https://api.github.com/users/swbaird/received_events", "type": "User", "site_admin": false}, "committer": {"login": "dkm", "id": 87603, "node_id": "MDQ6VXNlcjg3NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/87603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dkm", "html_url": "https://github.com/dkm", "followers_url": "https://api.github.com/users/dkm/followers", "following_url": "https://api.github.com/users/dkm/following{/other_user}", "gists_url": "https://api.github.com/users/dkm/gists{/gist_id}", "starred_url": "https://api.github.com/users/dkm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dkm/subscriptions", "organizations_url": "https://api.github.com/users/dkm/orgs", "repos_url": "https://api.github.com/users/dkm/repos", "events_url": "https://api.github.com/users/dkm/events{/privacy}", "received_events_url": "https://api.github.com/users/dkm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1207432c21a213cfac2b9499bd59367d410befe3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1207432c21a213cfac2b9499bd59367d410befe3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1207432c21a213cfac2b9499bd59367d410befe3"}], "stats": {"total": 12, "additions": 9, "deletions": 3}, "files": [{"sha": "7e5fb70069113fa31c67bb2503bc4e9047ed61f0", "filename": "gcc/ada/doc/gnat_rm/implementation_defined_pragmas.rst", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7e1fe87899932e2c265fd0a13b2ac552b0865e0f/gcc%2Fada%2Fdoc%2Fgnat_rm%2Fimplementation_defined_pragmas.rst", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7e1fe87899932e2c265fd0a13b2ac552b0865e0f/gcc%2Fada%2Fdoc%2Fgnat_rm%2Fimplementation_defined_pragmas.rst", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fdoc%2Fgnat_rm%2Fimplementation_defined_pragmas.rst?ref=7e1fe87899932e2c265fd0a13b2ac552b0865e0f", "patch": "@@ -2200,6 +2200,8 @@ are identified below.\n   functions and the compiler will evaluate some of these intrinsic statically,\n   in particular the ``Shift_Left`` and ``Shift_Right`` intrinsics.\n \n+  An Extensions_Allowed pragma argument of \"On\" enables this extension.\n+\n * ``[]`` aggregates\n \n   This new aggregate syntax for arrays and containers is provided under -gnatX"}, {"sha": "fbd8bb8d6b291b1bad3d8467a522b2e3177408e3", "filename": "gcc/ada/gnat_rm.texi", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7e1fe87899932e2c265fd0a13b2ac552b0865e0f/gcc%2Fada%2Fgnat_rm.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7e1fe87899932e2c265fd0a13b2ac552b0865e0f/gcc%2Fada%2Fgnat_rm.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgnat_rm.texi?ref=7e1fe87899932e2c265fd0a13b2ac552b0865e0f", "patch": "@@ -3639,6 +3639,8 @@ The Ada 202x @code{Static} aspect can be specified on Intrinsic imported\n functions and the compiler will evaluate some of these intrinsic statically,\n in particular the @code{Shift_Left} and @code{Shift_Right} intrinsics.\n \n+An Extensions_Allowed pragma argument of \u201cOn\u201d enables this extension.\n+\n @item \n @code{[]} aggregates\n "}, {"sha": "2eb1a69e764af78f3bac37731e7fce67d17146bf", "filename": "gcc/ada/sem_ch13.adb", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7e1fe87899932e2c265fd0a13b2ac552b0865e0f/gcc%2Fada%2Fsem_ch13.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7e1fe87899932e2c265fd0a13b2ac552b0865e0f/gcc%2Fada%2Fsem_ch13.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch13.adb?ref=7e1fe87899932e2c265fd0a13b2ac552b0865e0f", "patch": "@@ -2408,7 +2408,8 @@ package body Sem_Ch13 is\n \n                   elsif Is_Imported_Intrinsic then\n                      Error_Msg_GNAT_Extension\n-                       (\"aspect % on intrinsic function\", Sloc (Aspect));\n+                       (\"aspect % on intrinsic function\", Sloc (Aspect),\n+                        Is_Core_Extension => True);\n \n                   else\n                      Error_Msg_N"}, {"sha": "195f27e14d676efbe165136d1989617da7ab4f9a", "filename": "gcc/ada/sem_eval.adb", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7e1fe87899932e2c265fd0a13b2ac552b0865e0f/gcc%2Fada%2Fsem_eval.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7e1fe87899932e2c265fd0a13b2ac552b0865e0f/gcc%2Fada%2Fsem_eval.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_eval.adb?ref=7e1fe87899932e2c265fd0a13b2ac552b0865e0f", "patch": "@@ -2856,10 +2856,11 @@ package body Sem_Eval is\n          return;\n       end if;\n \n-      --  Intrinsic calls as part of a static function is a language extension.\n+      --  Intrinsic calls as part of a static function is a (core)\n+      --  language extension.\n \n       if Checking_Potentially_Static_Expression\n-        and then not All_Extensions_Allowed\n+        and then not Core_Extensions_Allowed\n       then\n          return;\n       end if;"}]}