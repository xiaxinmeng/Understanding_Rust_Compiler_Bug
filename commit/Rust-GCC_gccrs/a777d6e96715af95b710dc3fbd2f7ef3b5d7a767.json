{"sha": "a777d6e96715af95b710dc3fbd2f7ef3b5d7a767", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTc3N2Q2ZTk2NzE1YWY5NWI3MTBkYzNmYmQyZjdlZjNiNWQ3YTc2Nw==", "commit": {"author": {"name": "Francois-Xavier Coudert", "email": "fxcoudert@gcc.gnu.org", "date": "2007-04-19T11:01:15Z"}, "committer": {"name": "Fran\u00e7ois-Xavier Coudert", "email": "fxcoudert@gcc.gnu.org", "date": "2007-04-19T11:01:15Z"}, "message": "main.c (please_free_exe_path_when_done): New variable.\n\n\t* runtime/main.c (please_free_exe_path_when_done): New variable.\n\t(store_exe_path): Initialize character buffer, and mark whether\n\texe_path should be free'd by the library destructor function.\n\t(cleanup): Only free exe_path if needed.\n\nFrom-SVN: r123969", "tree": {"sha": "671c20848c6885bfd24842cb7c56a2b03340bd2f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/671c20848c6885bfd24842cb7c56a2b03340bd2f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a777d6e96715af95b710dc3fbd2f7ef3b5d7a767", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a777d6e96715af95b710dc3fbd2f7ef3b5d7a767", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a777d6e96715af95b710dc3fbd2f7ef3b5d7a767", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a777d6e96715af95b710dc3fbd2f7ef3b5d7a767/comments", "author": {"login": "fxcoudert", "id": 1980544, "node_id": "MDQ6VXNlcjE5ODA1NDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1980544?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fxcoudert", "html_url": "https://github.com/fxcoudert", "followers_url": "https://api.github.com/users/fxcoudert/followers", "following_url": "https://api.github.com/users/fxcoudert/following{/other_user}", "gists_url": "https://api.github.com/users/fxcoudert/gists{/gist_id}", "starred_url": "https://api.github.com/users/fxcoudert/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fxcoudert/subscriptions", "organizations_url": "https://api.github.com/users/fxcoudert/orgs", "repos_url": "https://api.github.com/users/fxcoudert/repos", "events_url": "https://api.github.com/users/fxcoudert/events{/privacy}", "received_events_url": "https://api.github.com/users/fxcoudert/received_events", "type": "User", "site_admin": false}, "committer": {"login": "fxcoudert", "id": 1980544, "node_id": "MDQ6VXNlcjE5ODA1NDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1980544?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fxcoudert", "html_url": "https://github.com/fxcoudert", "followers_url": "https://api.github.com/users/fxcoudert/followers", "following_url": "https://api.github.com/users/fxcoudert/following{/other_user}", "gists_url": "https://api.github.com/users/fxcoudert/gists{/gist_id}", "starred_url": "https://api.github.com/users/fxcoudert/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fxcoudert/subscriptions", "organizations_url": "https://api.github.com/users/fxcoudert/orgs", "repos_url": "https://api.github.com/users/fxcoudert/repos", "events_url": "https://api.github.com/users/fxcoudert/events{/privacy}", "received_events_url": "https://api.github.com/users/fxcoudert/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8d5d5865293148f8208acdc962beb686a3836720", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8d5d5865293148f8208acdc962beb686a3836720", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8d5d5865293148f8208acdc962beb686a3836720"}], "stats": {"total": 14, "additions": 14, "deletions": 0}, "files": [{"sha": "74ba4e0f9e1ef4f5d3dcf19127eb333f75880fe0", "filename": "libgfortran/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a777d6e96715af95b710dc3fbd2f7ef3b5d7a767/libgfortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a777d6e96715af95b710dc3fbd2f7ef3b5d7a767/libgfortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2FChangeLog?ref=a777d6e96715af95b710dc3fbd2f7ef3b5d7a767", "patch": "@@ -1,3 +1,10 @@\n+2007-04-19  Francois-Xavier Coudert  <fxcoudert@gcc.gnu.org>\n+\n+\t* runtime/main.c (please_free_exe_path_when_done): New variable.\n+\t(store_exe_path): Initialize character buffer, and mark whether\n+\texe_path should be free'd by the library destructor function.\n+\t(cleanup): Only free exe_path if needed.\n+\n 2007-04-18  Francois-Xavier Coudert  <fxcoudert@gcc.gnu.org>\n \t    Tobias Burnus  <burnus@net-b.de>\n "}, {"sha": "e88c2abdcdb1a13f70417345aa3df7de5a6a7600", "filename": "libgfortran/runtime/main.c", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a777d6e96715af95b710dc3fbd2f7ef3b5d7a767/libgfortran%2Fruntime%2Fmain.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a777d6e96715af95b710dc3fbd2f7ef3b5d7a767/libgfortran%2Fruntime%2Fmain.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fruntime%2Fmain.c?ref=a777d6e96715af95b710dc3fbd2f7ef3b5d7a767", "patch": "@@ -97,6 +97,7 @@ get_args (int *argc, char ***argv)\n \n \n static const char *exe_path;\n+static int please_free_exe_path_when_done;\n \n /* Save the path under which the program was called, for use in the\n    backtrace routines.  */\n@@ -116,15 +117,18 @@ store_exe_path (const char * argv0)\n   if (argv0[0] == '/')\n     {\n       exe_path = argv0;\n+      please_free_exe_path_when_done = 0;\n       return;\n     }\n \n+  memset (buf, 0, sizeof (buf));\n   cwd = getcwd (buf, sizeof (buf));\n \n   /* exe_path will be cwd + \"/\" + argv[0] + \"\\0\" */\n   path = malloc (strlen (cwd) + 1 + strlen (argv0) + 1);\n   st_sprintf (path, \"%s%c%s\", cwd, DIR_SEPARATOR, argv0);\n   exe_path = path;\n+  please_free_exe_path_when_done = 1;\n }\n \n /* Return the full path of the executable.  */\n@@ -168,4 +172,7 @@ static void __attribute__((destructor))\n cleanup (void)\n {\n   close_units ();\n+  \n+  if (please_free_exe_path_when_done)\n+    free (exe_path);\n }"}]}