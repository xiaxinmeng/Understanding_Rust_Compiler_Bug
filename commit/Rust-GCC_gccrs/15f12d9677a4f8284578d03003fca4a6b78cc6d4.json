{"sha": "15f12d9677a4f8284578d03003fca4a6b78cc6d4", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTVmMTJkOTY3N2E0ZjgyODQ1NzhkMDMwMDNmY2E0YTZiNzhjYzZkNA==", "commit": {"author": {"name": "Nicolas Koenig", "email": "koenigni@student.ethz.ch", "date": "2017-04-04T13:41:41Z"}, "committer": {"name": "Nicolas Koenig", "email": "koenigni@gcc.gnu.org", "date": "2017-04-04T13:41:41Z"}, "message": "[multiple changes]\n\n\n2017-03-18  Nicolas Koenig  <koenigni@student.ethz.ch> \n\t\tPR fortran/69498\n\t\t* symbol.c (gfc_delete_symtree): If there is a period in the name, ignore\n\t\teverything before it.\n\n2017-03-18  Nicolas Koenig  <koenigni@student.ethz.ch>\n\t\tPR fortran/69498\n\t\t* gfortran.dg/submodule_unexp.f90: New test.\n\nFrom-SVN: r246679", "tree": {"sha": "47ead797c2864d6fb28699977ba4feebd71787e9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/47ead797c2864d6fb28699977ba4feebd71787e9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/15f12d9677a4f8284578d03003fca4a6b78cc6d4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/15f12d9677a4f8284578d03003fca4a6b78cc6d4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/15f12d9677a4f8284578d03003fca4a6b78cc6d4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/15f12d9677a4f8284578d03003fca4a6b78cc6d4/comments", "author": null, "committer": null, "parents": [{"sha": "d90175a4bb3409aed1318b74bbe75c3abb889e38", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d90175a4bb3409aed1318b74bbe75c3abb889e38", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d90175a4bb3409aed1318b74bbe75c3abb889e38"}], "stats": {"total": 33, "additions": 31, "deletions": 2}, "files": [{"sha": "e1057d72eb884294682c92cd86ca8a9324ee0575", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/15f12d9677a4f8284578d03003fca4a6b78cc6d4/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/15f12d9677a4f8284578d03003fca4a6b78cc6d4/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=15f12d9677a4f8284578d03003fca4a6b78cc6d4", "patch": "@@ -1,3 +1,9 @@\n+2017-03-18  Nicolas Koenig  <koenigni@student.ethz.ch> \n+\n+\tPR fortran/69498\n+\t* symbol.c (gfc_delete_symtree): If there is a period in the name, ignore\n+\teverything before it.\n+\n 2017-03-28  Janus Weil  <janus@gcc.gnu.org>\n \n \tPR fortran/78661"}, {"sha": "ec43e635bf3688f52b3bc21498f4995b9f1ecb59", "filename": "gcc/fortran/symbol.c", "status": "modified", "additions": 12, "deletions": 2, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/15f12d9677a4f8284578d03003fca4a6b78cc6d4/gcc%2Ffortran%2Fsymbol.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/15f12d9677a4f8284578d03003fca4a6b78cc6d4/gcc%2Ffortran%2Fsymbol.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fsymbol.c?ref=15f12d9677a4f8284578d03003fca4a6b78cc6d4", "patch": "@@ -2782,10 +2782,20 @@ void\n gfc_delete_symtree (gfc_symtree **root, const char *name)\n {\n   gfc_symtree st, *st0;\n+  const char *p;\n \n-  st0 = gfc_find_symtree (*root, name);\n+  /* Submodules are marked as mod.submod.  When freeing a submodule\n+     symbol, the symtree only has \"submod\", so adjust that here.  */\n \n-  st.name = gfc_get_string (\"%s\", name);\n+  p = strrchr(name, '.');\n+  if (p)\n+    p++;\n+  else\n+    p = name;\n+\n+  st0 = gfc_find_symtree (*root, p);\n+\n+  st.name = gfc_get_string (\"%s\", p);\n   gfc_delete_bbt (root, &st, compare_symtree);\n \n   free (st0);"}, {"sha": "2d5f91aa81e31f724943164717bbf30c5a43cf6d", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/15f12d9677a4f8284578d03003fca4a6b78cc6d4/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/15f12d9677a4f8284578d03003fca4a6b78cc6d4/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=15f12d9677a4f8284578d03003fca4a6b78cc6d4", "patch": "@@ -1,3 +1,8 @@\n+2017-04-04  Nicolas Koenig  <koenigni@student.ethz.ch> \n+\n+\tPR fortran/69498\n+\t* gfortran.dg/submodule_unexp.f90: New test.\n+\n 2017-04-04  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR target/80286"}, {"sha": "43a055349d8baf679776444eefdbc920cd93bcb6", "filename": "gcc/testsuite/gfortran.dg/submodule_unexp.f90", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/15f12d9677a4f8284578d03003fca4a6b78cc6d4/gcc%2Ftestsuite%2Fgfortran.dg%2Fsubmodule_unexp.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/15f12d9677a4f8284578d03003fca4a6b78cc6d4/gcc%2Ftestsuite%2Fgfortran.dg%2Fsubmodule_unexp.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fsubmodule_unexp.f90?ref=15f12d9677a4f8284578d03003fca4a6b78cc6d4", "patch": "@@ -0,0 +1,8 @@\n+! { dg-do compile }\n+! PR fortran/69498\n+! This used to ICE\n+program p\n+   type t\n+   submodule (m) sm ! { dg-error \"Unexpected SUBMODULE statement at\" }\n+   end type\n+end"}]}