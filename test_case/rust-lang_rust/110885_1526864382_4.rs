
00000000: 2369 6e63 6c75 6465 2022 6d61 6372 6f5f  #include "macro_
00000010: 612e 5322 0d0a 2369 6e63 6c75 6465 2022  a.S"..#include "
00000020: 6d61 6372 6f5f 622e 5322 0d0a 2369 6e63  macro_b.S"..#inc
00000030: 6c75 6465 2022 6d61 6372 6f5f 632e 5322  lude "macro_c.S"
00000040: 0d0a 0d0a 2e74 6578 740d 0a2e 6172 6368  .....text...arch
00000050: 2061 726d 7638 2d61 2b63 7279 7074 6f0d   armv8-a+crypto.
00000060: 0a0d 0a2e 676c 6f62 6c20 534f 4d45 5f46  ....globl SOME_F
00000070: 554e 435f 410d 0a2e 7479 7065 2053 4f4d  UNC_A...type SOM
00000080: 455f 4655 4e43 5f41 2c25 6675 6e63 7469  E_FUNC_A,%functi
00000090: 6f6e 0d0a 2e61 6c69 676e 2034 0d0a 534f  on...align 4..SO
000000a0: 4d45 5f46 554e 435f 413a 0d0a 2020 2020  ME_FUNC_A:..
000000b0: 494e 5f53 5450 2020 2020 2020 2020 2020  IN_STP
000000c0: 2020 2020 2020 2020 2020 2020 2020 2020
000000d0: 2020 2020 2020 2020 2020 2020 2f2f 20e5              // .
000000e0: af84 e5ad 98e5 99a8 e4bf 9de6 8aa4 0d0a  ................
000000f0: 2020 2020 622e 6571 202e 4c45 6e63 5f31      b.eq .LEnc_1
00000100: 5f70 726f 6365 7373 2020 2020 2020 2020  _process
00000110: 2020 2020 2020 2020 2020 2020 2020 2f2f                //
00000120: 20e8 b7b3 e8bd ac0d 0a20 2020 2062 2e65   ........    b.e
00000130: 7120 2e4c 456e 635f 325f 7072 6f63 6573  q .LEnc_2_proces
00000140: 7320 2020 2020 2020 2020 2020 2020 2020  s
00000150: 2020 2020 2020 202f 2f20 e8b7 b3e8 bdac         // ......
00000160: 0d0a 2020 2020 6220 2e4c 456e 635f 335f  ..    b .LEnc_3_
00000170: 7072 6f63 6573 7320 2020 2020 2020 2020  process
00000180: 2020 2020 2020 2020 2020 2020 2020 2020
00000190: 2f2f 20e8 b7b3 e8bd ac0d 0a0d 0a2e 4c45  // ...........LE
000001a0: 6e63 5f31 5f70 726f 6365 7373 3a0d 0a20  nc_1_process:..
000001b0: 2020 204c 4f41 445f 4841 5348 5f54 4142     LOAD_HASH_TAB
000001c0: 4c45 2020 2020 2020 2020 2020 2020 2020  LE
000001d0: 2020 2020 2020 2020 2020 2020 2020 2f2f                //
000001e0: 20e5 8aa0 e8bd bd67 0d0a 2020 2020 622e   ......g..    b.
000001f0: 6c65 202e 4c45 6e63 5f65 6e64 2020 2020  le .LEnc_end
00000200: 2020 2020 2020 2020 2020 2020 2020 2020
00000210: 2020 2020 2020 2020 2020 2f2f 20e7 acac            // ...
00000220: e4b8 80e6 aca1 3634 e5ad 97e8 8a82 e5a4  ......64........
00000230: 84e7 9086 e5ae 8ce6 af95 efbc 8ce5 88a4  ................
00000240: e696 ade5 89a9 e4bd 99e9 95bf e5ba a60d  ................
00000250: 0a20 2020 2062 202e 4c45 6e63 5f31 5f6c  .    b .LEnc_1_l
00000260: 6f6f 7020 2020 2020 2020 2020 2020 2020  oop
00000270: 2020 2020 2020 2020 2020 2020 2020 202f                 /
00000280: 2f20 e8bf 9be5 85a5 e5be aae7 8eaf e5a4  / ..............
00000290: 84e7 9086 e6b5 81e7 a88b 0d0a 0d0a 2e4c  ...............L
000002a0: 456e 635f 325f 7072 6f63 6573 733a 0d0a  Enc_2_process:..
000002b0: 2020 2020 4c4f 4144 5f48 4153 485f 5441      LOAD_HASH_TA
000002c0: 424c 4520 2020 2020 2020 2020 2020 2020  BLE
000002d0: 2020 2020 2020 2020 2020 2020 2020 2020
000002e0: 2020 2020 2020 2020 2020 2020 2020 2020
000002f0: 2020 202f 2f20 6c6f 6164 2068 6173 6820     // load hash
00000300: 7461 626c 650d 0a20 2020 2062 2e6c 6520  table..    b.le
00000310: 2e4c 456e 635f 656e 640d 0a20 2020 2062  .LEnc_end..    b
00000320: 202e 4c45 6e63 5f32 5f6c 6f6f 700d 0a0d   .LEnc_2_loop...
00000330: 0a2e 4c45 6e63 5f33 5f70 726f 6365 7373  ..LEnc_3_process
00000340: 3a0d 0a20 2020 204c 4f41 445f 4841 5348  :..    LOAD_HASH
00000350: 5f54 4142 4c45 0d0a 2020 2020 622e 6c65  _TABLE..    b.le
00000360: 202e 4c45 6e63 5f65 6e64 0d0a 2020 2020   .LEnc_end..
00000370: 6220 2e4c 456e 635f 335f 6c6f 6f70 0d0a  b .LEnc_3_loop..
00000380: 0d0a 2e4c 456e 635f 315f 6c6f 6f70 3a0d  ...LEnc_1_loop:.
00000390: 0a20 2020 2045 4e43 315f 4c4f 4f50 2020  .    ENC1_LOOP
000003a0: 2020 2020 2020 2020 2020 2020 2020 2020
000003b0: 2020 2020 2020 202f 2f20 e5a4 84e7 9086         // ......
000003c0: 3634 e5ad 97e8 8a82 0d0a 2020 2020 622e  64........    b.
000003d0: 6c65 202e 4c45 6e63 5f65 6e64 2020 2020  le .LEnc_end
000003e0: 2020 2020 2020 2020 2020 2020 2020 2020
000003f0: 2020 2020 2020 2f2f 20e5 89a9 e4bd 99e5        // .......
00000400: 9d97 e695 b0e4 b8ba 302c 20e9 8080 e587  ........0, .....
00000410: bae5 beaa e78e af0d 0a20 2020 2062 202e  .........    b .
00000420: 4c45 6e63 5f31 5f6c 6f6f 7020 2020 2020  LEnc_1_loop
00000430: 2020 2020 2020 2020 2020 2020 2020 2020
00000440: 2020 202f 2f20 e7bb a7e7 bbad e5be aae7     // ..........
00000450: 8eaf 0d0a 0d0a 2e4c 456e 635f 325f 6c6f  .......LEnc_2_lo
00000460: 6f70 3a0d 0a20 2020 2045 4e43 325f 4c4f  op:..    ENC2_LO
00000470: 4f50 0d0a 2020 2020 622e 6c65 202e 4c45  OP..    b.le .LE
00000480: 6e63 5f65 6e64 2020 2020 2020 2020 2020  nc_end
00000490: 2020 2020 2020 2020 2020 2020 2020 2020
000004a0: 2f2f 203c 3d20 300d 0a20 2020 2062 202e  // <= 0..    b .
000004b0: 4c45 6e63 5f32 5f6c 6f6f 700d 0a0d 0a2e  LEnc_2_loop.....
000004c0: 4c45 6e63 5f33 5f6c 6f6f 703a 0d0a 2020  LEnc_3_loop:..
000004d0: 2020 454e 4333 5f4c 4f4f 500d 0a20 2020    ENC3_LOOP..
000004e0: 2062 2e6c 6520 2e4c 456e 635f 656e 6420   b.le .LEnc_end
000004f0: 2020 2020 2020 2020 2020 2020 2020 2020
00000500: 2020 2020 2020 2020 202f 2f20 3c3d 2030           // <= 0
00000510: 0d0a 2020 2020 6220 2e4c 456e 635f 335f  ..    b .LEnc_3_
00000520: 6c6f 6f70 0d0a 0d0a 2e4c 456e 635f 656e  loop.....LEnc_en
00000530: 643a 0d0a 2020 2020 4841 5348 5f42 4c4f  d:..    HASH_BLO
00000540: 434b 0d0a 2020 2020 4f55 545f 5354 500d  CK..    OUT_STP.
00000550: 0a0d 0a2e 4c45 6e63 5f72 6574 3a0d 0a20  ....LEnc_ret:..
00000560: 2020 2072 6574 0d0a 2e73 697a 6520 534f     ret...size SO
00000570: 4d45 5f46 554e 435f 412c 2e2d 534f 4d45  ME_FUNC_A,.-SOME
00000580: 5f46 554e 435f 410d 0a                   _FUNC_A..
