 rust
if n != i + 1 || { self.flush()?; true } {
    return Ok(n)
}
