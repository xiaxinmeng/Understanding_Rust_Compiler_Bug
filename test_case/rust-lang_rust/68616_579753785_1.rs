asm
        addiu   $1, $4, -1
        not     $2, $4
        and     $1, $2, $1
        srl     $2, $1, 1
        lui     $3, 21845
        ori     $3, $3, 21845
        and     $2, $2, $3
        subu    $1, $1, $2
        lui     $2, 13107
        ori     $2, $2, 13107
        and     $3, $1, $2
        srl     $1, $1, 2
        lui     $4, 3855
        and     $1, $1, $2
        ori     $2, $4, 3855
        addu    $1, $3, $1
        srl     $3, $1, 4
        addu    $1, $1, $3
        and     $1, $1, $2
        sll     $2, $1, 8
        addu    $2, $2, $1
        sll     $3, $1, 16
        addu    $2, $3, $2
        sll     $1, $1, 24
        addu    $1, $1, $2
