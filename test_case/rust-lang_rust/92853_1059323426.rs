plain



The actual stderr differed from the expected stderr.
Actual stderr saved to /tmp/compiletest4RJla9/available-concurrency.stage-id.stderr
To only update this specific test, also pass `--test-args available-concurrency.rs`

error: 1 errors occurred comparing output.
status: exit status: 1
status: exit status: 1
command: "/checkout/obj/build/x86_64-unknown-linux-gnu/stage2-tools-bin/miri" "tests/run-pass/available-concurrency.rs" "-L" "/tmp/compiletest4RJla9" "--target=x86_64-unknown-linux-gnu" "--error-format" "json" "-C" "prefer-dynamic" "-o" "/tmp/compiletest4RJla9/available-concurrency.stage-id" "-A" "unused" "--edition" "2018" "-Astable-features" "--sysroot" "/home/user/.cache/miri/HOST" "-L" "/tmp/compiletest4RJla9/available-concurrency.stage-id.aux"
------------------------------------------

------------------------------------------
stderr:
stderr:
------------------------------------------
{"message":"unsupported operation: `open` not available when isolation is enabled","code":null,"level":"error","spans":[{"file_name":"/checkout/library/std/src/sys/unix/fs.rs","byte_start":25298,"byte_end":25346,"line_start":802,"line_end":802,"column_start":36,"column_end":84,"is_primary":true,"text":[{"text":"        let fd = cvt_r(|| unsafe { open64(path.as_ptr(), flags, opts.mode as c_int) })?;","highlight_start":36,"highlight_end":84}],"label":"`open` not available when isolation is enabled","suggested_replacement":null,"suggestion_applicability":null,"expansion":null}],"children":[{"message":"pass the flag `-Zmiri-disable-isolation` to disable isolation;","code":null,"level":"help","spans":[],"children":[],"rendered":null},{"message":"or pass `-Zmiri-isolation-error=warn to configure Miri to return an error code from isolated operations (if supported for that operation) and continue with a warning\n","code":null,"level":"help","spans":[],"children":[],"rendered":null},{"message":"inside closure at /checkout/library/std/src/sys/unix/fs.rs:802:36","code":null,"level":"note","spans":[],"children":[],"rendered":null},{"message":"inside `std::sys::unix::cvt_r::<i32, [closure@std::sys::unix::fs::File::open_c::{closure#0}]>` at /checkout/library/std/src/sys/unix/mod.rs:212:19","code":null,"level":"note","spans":[],"children":[],"rendered":null},{"message":"inside `std::sys::unix::fs::File::open_c` at /checkout/library/std/src/sys/unix/fs.rs:802:18","code":null,"level":"note","spans":[],"children":[],"rendered":null},{"message":"inside `std::sys::unix::fs::File::open` at /checkout/library/std/src/sys/unix/fs.rs:790:9","code":null,"level":"note","spans":[],"children":[],"rendered":null},{"message":"inside `std::fs::OpenOptions::_open` at /checkout/library/std/src/fs.rs:952:9","code":null,"level":"note","spans":[],"children":[],"rendered":null},{"message":"inside `std::fs::OpenOptions::open::<&std::path::Path>` at /checkout/library/std/src/fs.rs:948:9","code":null,"level":"note","spans":[],"children":[],"rendered":null},{"message":"inside `std::fs::File::open::<&str>` at /checkout/library/std/src/fs.rs:328:9","code":null,"level":"note","spans":[],"children":[],"rendered":null},{"message":"inside `std::sys::unix::thread::cgroup2_quota` at /checkout/library/std/src/sys/unix/thread.rs:391:9","code":null,"level":"note","spans":[],"children":[],"rendered":null},{"message":"inside `std::sys::unix::thread::available_parallelism` at /checkout/library/std/src/sys/unix/thread.rs:282:29","code":null,"level":"note","spans":[],"children":[],"rendered":null},{"message":"inside `std::thread::available_parallelism` at /checkout/library/std/src/thread/mod.rs:1562:5","code":null,"level":"note","spans":[],"children":[],"rendered":null},{"message":"inside `main` at tests/run-pass/available-concurrency.rs:2:16","code":null,"level":"note","spans":[{"file_name":"tests/run-pass/available-concurrency.rs","byte_start":27,"byte_end":63,"line_start":2,"line_end":2,"column_start":16,"column_end":52,"is_primary":true,"text":[{"text":"    assert_eq!(std::thread::available_parallelism().unwrap().get(), 1);","highlight_start":16,"highlight_end":52}],"label":null,"suggested_replacement":null,"suggestion_applicability":null,"expansion":null}],"children":[],"rendered":null}],"rendered":"error: unsupported operation: `open` not available when isolation is enabled\n   --> /checkout/library/std/src/sys/unix/fs.rs:802:36\n    |\n802 |         let fd = cvt_r(|| unsafe { open64(path.as_ptr(), flags, opts.mode as c_int) })?;\n    |                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ `open` not available when isolation is enabled\n    |\n    = help: pass the flag `-Zmiri-disable-isolation` to disable isolation;\n    = help: or pass `-Zmiri-isolation-error=warn to configure Miri to return an error code from isolated operations (if supported for that operation) and continue with a warning\n            \n    = note: inside closure at /checkout/library/std/src/sys/unix/fs.rs:802:36\n    = note: inside `std::sys::unix::cvt_r::<i32, [closure@std::sys::unix::fs::File::open_c::{closure#0}]>` at /checkout/library/std/src/sys/unix/mod.rs:212:19\n    = note: inside `std::sys::unix::fs::File::open_c` at /checkout/library/std/src/sys/unix/fs.rs:802:18\n    = note: inside `std::sys::unix::fs::File::open` at /checkout/library/std/src/sys/unix/fs.rs:790:9\n    = note: inside `std::fs::OpenOptions::_open` at /checkout/library/std/src/fs.rs:952:9\n    = note: inside `std::fs::OpenOptions::open::<&std::path::Path>` at /checkout/library/std/src/fs.rs:948:9\n    = note: inside `std::fs::File::open::<&str>` at /checkout/library/std/src/fs.rs:328:9\n    = note: inside `std::sys::unix::thread::cgroup2_quota` at /checkout/library/std/src/sys/unix/thread.rs:391:9\n    = note: inside `std::sys::unix::thread::available_parallelism` at /checkout/library/std/src/sys/unix/thread.rs:282:29\n    = note: inside `std::thread::available_parallelism` at /checkout/library/std/src/thread/mod.rs:1562:5\nnote: inside `main` at tests/run-pass/available-concurrency.rs:2:16\n   --> tests/run-pass/available-concurrency.rs:2:16\n    |\n2   |     assert_eq!(std::thread::available_parallelism().unwrap().get(), 1);\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n"}
{"message":"aborting due to previous error","code":null,"level":"error","spans":[],"children":[],"rendered":"error: aborting due to previous error\n\n"}

------------------------------------------

---
---- compile_test stdout ----

error: failed to compile fixed code
status: exit status: 1
command: "/checkout/obj/build/x86_64-unknown-linux-gnu/stage2-tools/x86_64-unknown-linux-gnu/release/clippy-driver" "tests/ui/bytes_nth.fixed" "-L" "/checkout/obj/build/x86_64-unknown-linux-gnu/stage2-tools/x86_64-unknown-linux-gnu/release/test/ui" "--target=x86_64-unknown-linux-gnu" "--error-format" "json" "-C" "prefer-dynamic" "-o" "/checkout/obj/build/x86_64-unknown-linux-gnu/stage2-tools/x86_64-unknown-linux-gnu/release/test/ui/bytes_nth.stage-id" "--emit=metadata" "-Dwarnings" "-Zui-testing" "-L" "dependency=/checkout/obj/build/x86_64-unknown-linux-gnu/stage2-tools/x86_64-unknown-linux-gnu/release/deps" "-L" "dependency=/checkout/obj/build/x86_64-unknown-linux-gnu/stage2-tools/release/deps" "--extern" "syn=/checkout/obj/build/x86_64-unknown-linux-gnu/stage2-tools/x86_64-unknown-linux-gnu/release/deps/libsyn-c2a1ca34edf818c9.rlib" "--extern" "futures=/checkout/obj/build/x86_64-unknown-linux-gnu/stage2-tools/x86_64-unknown-linux-gnu/release/deps/libfutures-c715357e8026769d.rlib" "--extern" "itertools=/checkout/obj/build/x86_64-unknown-linux-gnu/stage2-tools/x86_64-unknown-linux-gnu/release/deps/libitertools-041fb6ac880e1ce0.rlib" "--extern" "quote=/checkout/obj/build/x86_64-unknown-linux-gnu/stage2-tools/x86_64-unknown-linux-gnu/release/deps/libquote-a2cb7849bbc8a2a2.rlib" "--extern" "regex=/checkout/obj/build/x86_64-unknown-linux-gnu/stage2-tools/x86_64-unknown-linux-gnu/release/deps/libregex-8ccd5459decf8e02.rlib" "--extern" "if_chain=/checkout/obj/build/x86_64-unknown-linux-gnu/stage2-tools/x86_64-unknown-linux-gnu/release/deps/libif_chain-a436811527635382.rlib" "--extern" "derive_new=/checkout/obj/build/x86_64-unknown-linux-gnu/stage2-tools/release/deps/libderive_new-12319133577eb155.so" "--extern" "serde_derive=/checkout/obj/build/x86_64-unknown-linux-gnu/stage2-tools/release/deps/libserde_derive-f91723cecf6d8a5f.so" "--extern" "tokio=/checkout/obj/build/x86_64-unknown-linux-gnu/stage2-tools/x86_64-unknown-linux-gnu/release/deps/libtokio-6688bfb3a0699fc9.rlib" "--extern" "clippy_utils=/checkout/obj/build/x86_64-unknown-linux-gnu/stage2-tools/x86_64-unknown-linux-gnu/release/deps/libclippy_utils-876c59a3e481cb18.rlib" "--extern" "serde=/checkout/obj/build/x86_64-unknown-linux-gnu/stage2-tools/x86_64-unknown-linux-gnu/release/deps/libserde-a8c1b2a71f554c3c.rlib" "--extern" "parking_lot=/checkout/obj/build/x86_64-unknown-linux-gnu/stage2-tools/x86_64-unknown-linux-gnu/release/deps/libparking_lot-e6439823b6d16f2c.rlib" "--edition=2021" "-L" "/checkout/obj/build/x86_64-unknown-linux-gnu/stage2-tools/x86_64-unknown-linux-gnu/release/test/ui/bytes_nth.stage-id.aux"
------------------------------------------

------------------------------------------
stderr:
stderr:
------------------------------------------
{"message":"unused return value of `core::slice::<impl [T]>::get` that must be used","code":{"code":"unused_must_use","explanation":null},"level":"error","spans":[{"file_name":"tests/ui/bytes_nth.fixed","byte_start":138,"byte_end":158,"line_start":8,"line_end":8,"column_start":5,"column_end":25,"is_primary":true,"text":[{"text":"    s.as_bytes().get(3);","highlight_start":5,"highlight_end":25}],"label":null,"suggested_replacement":null,"suggestion_applicability":null,"expansion":null}],"children":[{"message":"`-D unused-must-use` implied by `-D warnings`","code":null,"level":"note","spans":[],"children":[],"rendered":null}],"rendered":"error: unused return value of `core::slice::<impl [T]>::get` that must be used\n  --> tests/ui/bytes_nth.fixed:8:5\n   |\nLL |     s.as_bytes().get(3);\n   |     ^^^^^^^^^^^^^^^^^^^^\n   |\n   = note: `-D unused-must-use` implied by `-D warnings`\n\n"}
{"message":"unused return value of `core::slice::<impl [T]>::get` that must be used","code":{"code":"unused_must_use","explanation":null},"level":"error","spans":[{"file_name":"tests/ui/bytes_nth.fixed","byte_start":197,"byte_end":221,"line_start":10,"line_end":10,"column_start":5,"column_end":29,"is_primary":true,"text":[{"text":"    s[..].as_bytes().get(3);","highlight_start":5,"highlight_end":29}],"label":null,"suggested_replacement":null,"suggestion_applicability":null,"expansion":null}],"children":[],"rendered":"error: unused return value of `core::slice::<impl [T]>::get` that must be used\n  --> tests/ui/bytes_nth.fixed:10:5\n   |\nLL |     s[..].as_bytes().get(3);\n   |     ^^^^^^^^^^^^^^^^^^^^^^^^\n\n"}

------------------------------------------



error: failed to compile fixed code
status: exit status: 1
command: "/checkout/obj/build/x86_64-unknown-linux-gnu/stage2-tools/x86_64-unknown-linux-gnu/release/clippy-driver" "tests/ui/iter_next_slice.fixed" "-L" "/checkout/obj/build/x86_64-unknown-linux-gnu/stage2-tools/x86_64-unknown-linux-gnu/release/test/ui" "--target=x86_64-unknown-linux-gnu" "--error-format" "json" "-C" "prefer-dynamic" "-o" "/checkout/obj/build/x86_64-unknown-linux-gnu/stage2-tools/x86_64-unknown-linux-gnu/release/test/ui/iter_next_slice.stage-id" "--emit=metadata" "-Dwarnings" "-Zui-testing" "-L" "dependency=/checkout/obj/build/x86_64-unknown-linux-gnu/stage2-tools/x86_64-unknown-linux-gnu/release/deps" "-L" "dependency=/checkout/obj/build/x86_64-unknown-linux-gnu/stage2-tools/release/deps" "--extern" "syn=/checkout/obj/build/x86_64-unknown-linux-gnu/stage2-tools/x86_64-unknown-linux-gnu/release/deps/libsyn-c2a1ca34edf818c9.rlib" "--extern" "futures=/checkout/obj/build/x86_64-unknown-linux-gnu/stage2-tools/x86_64-unknown-linux-gnu/release/deps/libfutures-c715357e8026769d.rlib" "--extern" "itertools=/checkout/obj/build/x86_64-unknown-linux-gnu/stage2-tools/x86_64-unknown-linux-gnu/release/deps/libitertools-041fb6ac880e1ce0.rlib" "--extern" "quote=/checkout/obj/build/x86_64-unknown-linux-gnu/stage2-tools/x86_64-unknown-linux-gnu/release/deps/libquote-a2cb7849bbc8a2a2.rlib" "--extern" "regex=/checkout/obj/build/x86_64-unknown-linux-gnu/stage2-tools/x86_64-unknown-linux-gnu/release/deps/libregex-8ccd5459decf8e02.rlib" "--extern" "if_chain=/checkout/obj/build/x86_64-unknown-linux-gnu/stage2-tools/x86_64-unknown-linux-gnu/release/deps/libif_chain-a436811527635382.rlib" "--extern" "derive_new=/checkout/obj/build/x86_64-unknown-linux-gnu/stage2-tools/release/deps/libderive_new-12319133577eb155.so" "--extern" "serde_derive=/checkout/obj/build/x86_64-unknown-linux-gnu/stage2-tools/release/deps/libserde_derive-f91723cecf6d8a5f.so" "--extern" "tokio=/checkout/obj/build/x86_64-unknown-linux-gnu/stage2-tools/x86_64-unknown-linux-gnu/release/deps/libtokio-6688bfb3a0699fc9.rlib" "--extern" "clippy_utils=/checkout/obj/build/x86_64-unknown-linux-gnu/stage2-tools/x86_64-unknown-linux-gnu/release/deps/libclippy_utils-876c59a3e481cb18.rlib" "--extern" "serde=/checkout/obj/build/x86_64-unknown-linux-gnu/stage2-tools/x86_64-unknown-linux-gnu/release/deps/libserde-a8c1b2a71f554c3c.rlib" "--extern" "parking_lot=/checkout/obj/build/x86_64-unknown-linux-gnu/stage2-tools/x86_64-unknown-linux-gnu/release/deps/libparking_lot-e6439823b6d16f2c.rlib" "--edition=2021" "-L" "/checkout/obj/build/x86_64-unknown-linux-gnu/stage2-tools/x86_64-unknown-linux-gnu/release/test/ui/iter_next_slice.stage-id.aux"
------------------------------------------

------------------------------------------
stderr:
stderr:
------------------------------------------
{"message":"unused return value of `core::slice::<impl [T]>::get` that must be used","code":{"code":"unused_must_use","explanation":null},"level":"error","spans":[{"file_name":"tests/ui/iter_next_slice.fixed","byte_start":144,"byte_end":153,"line_start":9,"line_end":9,"column_start":5,"column_end":14,"is_primary":true,"text":[{"text":"    s.get(0);","highlight_start":5,"highlight_end":14}],"label":null,"suggested_replacement":null,"suggestion_applicability":null,"expansion":null}],"children":[{"message":"`-D unused-must-use` implied by `-D warnings`","code":null,"level":"note","spans":[],"children":[],"rendered":null}],"rendered":"error: unused return value of `core::slice::<impl [T]>::get` that must be used\n  --> tests/ui/iter_next_slice.fixed:9:5\n   |\nLL |     s.get(0);\n   |     ^^^^^^^^^\n   |\n   = note: `-D unused-must-use` implied by `-D warnings`\n\n"}
{"message":"unused return value of `core::slice::<impl [T]>::get` that must be used","code":{"code":"unused_must_use","explanation":null},"level":"error","spans":[{"file_name":"tests/ui/iter_next_slice.fixed","byte_start":197,"byte_end":206,"line_start":12,"line_end":12,"column_start":5,"column_end":14,"is_primary":true,"text":[{"text":"    s.get(2);","highlight_start":5,"highlight_end":14}],"label":null,"suggested_replacement":null,"suggestion_applicability":null,"expansion":null}],"children":[],"rendered":"error: unused return value of `core::slice::<impl [T]>::get` that must be used\n  --> tests/ui/iter_next_slice.fixed:12:5\n   |\nLL |     s.get(2);\n   |     ^^^^^^^^^\n\n"}
{"message":"unused return value of `core::slice::<impl [T]>::get` that must be used","code":{"code":"unused_must_use","explanation":null},"level":"error","spans":[{"file_name":"tests/ui/iter_next_slice.fixed","byte_start":250,"byte_end":259,"line_start":15,"line_end":15,"column_start":5,"column_end":14,"is_primary":true,"text":[{"text":"    v.get(5);","highlight_start":5,"highlight_end":14}],"label":null,"suggested_replacement":null,"suggestion_applicability":null,"expansion":null}],"children":[],"rendered":"error: unused return value of `core::slice::<impl [T]>::get` that must be used\n  --> tests/ui/iter_next_slice.fixed:15:5\n   |\nLL |     v.get(5);\n   |     ^^^^^^^^^\n\n"}
{"message":"unused return value of `core::slice::<impl [T]>::get` that must be used","code":{"code":"unused_must_use","explanation":null},"level":"error","spans":[{"file_name":"tests/ui/iter_next_slice.fixed","byte_start":303,"byte_end":312,"line_start":18,"line_end":18,"column_start":5,"column_end":14,"is_primary":true,"text":[{"text":"    v.get(0);","highlight_start":5,"highlight_end":14}],"label":null,"suggested_replacement":null,"suggestion_applicability":null,"expansion":null}],"children":[],"rendered":"error: unused return value of `core::slice::<impl [T]>::get` that must be used\n  --> tests/ui/iter_next_slice.fixed:18:5\n   |\nLL |     v.get(0);\n   |     ^^^^^^^^^\n\n"}

------------------------------------------

thread 'compile_test' panicked at 'Some tests failed', /cargo/registry/src/github.com-1ecc6299db9ec823/compiletest_rs-0.7.1/src/lib.rs:105:22
