{"url": "https://api.github.com/repos/Rust-GCC/gccrs/issues/1207", "repository_url": "https://api.github.com/repos/Rust-GCC/gccrs", "labels_url": "https://api.github.com/repos/Rust-GCC/gccrs/issues/1207/labels{/name}", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/issues/1207/comments", "events_url": "https://api.github.com/repos/Rust-GCC/gccrs/issues/1207/events", "html_url": "https://github.com/Rust-GCC/gccrs/issues/1207", "id": 1224496602, "node_id": "I_kwDOANBUbM5I_FXa", "number": 1207, "title": "Allow `match` on boolean expressions", "user": {"login": "dafaust", "id": 4460334, "node_id": "MDQ6VXNlcjQ0NjAzMzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/4460334?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dafaust", "html_url": "https://github.com/dafaust", "followers_url": "https://api.github.com/users/dafaust/followers", "following_url": "https://api.github.com/users/dafaust/following{/other_user}", "gists_url": "https://api.github.com/users/dafaust/gists{/gist_id}", "starred_url": "https://api.github.com/users/dafaust/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dafaust/subscriptions", "organizations_url": "https://api.github.com/users/dafaust/orgs", "repos_url": "https://api.github.com/users/dafaust/repos", "events_url": "https://api.github.com/users/dafaust/events{/privacy}", "received_events_url": "https://api.github.com/users/dafaust/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 61372775, "node_id": "MDU6TGFiZWw2MTM3Mjc3NQ==", "url": "https://api.github.com/repos/Rust-GCC/gccrs/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 61372777, "node_id": "MDU6TGFiZWw2MTM3Mjc3Nw==", "url": "https://api.github.com/repos/Rust-GCC/gccrs/labels/enhancement", "name": "enhancement", "color": "84b6eb", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "dafaust", "id": 4460334, "node_id": "MDQ6VXNlcjQ0NjAzMzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/4460334?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dafaust", "html_url": "https://github.com/dafaust", "followers_url": "https://api.github.com/users/dafaust/followers", "following_url": "https://api.github.com/users/dafaust/following{/other_user}", "gists_url": "https://api.github.com/users/dafaust/gists{/gist_id}", "starred_url": "https://api.github.com/users/dafaust/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dafaust/subscriptions", "organizations_url": "https://api.github.com/users/dafaust/orgs", "repos_url": "https://api.github.com/users/dafaust/repos", "events_url": "https://api.github.com/users/dafaust/events{/privacy}", "received_events_url": "https://api.github.com/users/dafaust/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "dafaust", "id": 4460334, "node_id": "MDQ6VXNlcjQ0NjAzMzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/4460334?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dafaust", "html_url": "https://github.com/dafaust", "followers_url": "https://api.github.com/users/dafaust/followers", "following_url": "https://api.github.com/users/dafaust/following{/other_user}", "gists_url": "https://api.github.com/users/dafaust/gists{/gist_id}", "starred_url": "https://api.github.com/users/dafaust/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dafaust/subscriptions", "organizations_url": "https://api.github.com/users/dafaust/orgs", "repos_url": "https://api.github.com/users/dafaust/repos", "events_url": "https://api.github.com/users/dafaust/events{/privacy}", "received_events_url": "https://api.github.com/users/dafaust/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/Rust-GCC/gccrs/milestones/6", "html_url": "https://github.com/Rust-GCC/gccrs/milestone/6", "labels_url": "https://api.github.com/repos/Rust-GCC/gccrs/milestones/6/labels", "id": 6262846, "node_id": "MDk6TWlsZXN0b25lNjI2Mjg0Ng==", "number": 6, "title": "Imports and visibility", "description": "Multi file compilation and with use, extern and mod.", "creator": {"login": "philberty", "id": 84585, "node_id": "MDQ6VXNlcjg0NTg1", "avatar_url": "https://avatars.githubusercontent.com/u/84585?v=4", "gravatar_id": "", "url": "https://api.github.com/users/philberty", "html_url": "https://github.com/philberty", "followers_url": "https://api.github.com/users/philberty/followers", "following_url": "https://api.github.com/users/philberty/following{/other_user}", "gists_url": "https://api.github.com/users/philberty/gists{/gist_id}", "starred_url": "https://api.github.com/users/philberty/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/philberty/subscriptions", "organizations_url": "https://api.github.com/users/philberty/orgs", "repos_url": "https://api.github.com/users/philberty/repos", "events_url": "https://api.github.com/users/philberty/events{/privacy}", "received_events_url": "https://api.github.com/users/philberty/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 161, "state": "closed", "created_at": "2021-01-03T14:20:54Z", "updated_at": "2022-08-23T08:04:15Z", "due_on": "2022-05-30T07:00:00Z", "closed_at": "2022-08-03T10:02:38Z"}, "comments": 0, "created_at": "2022-05-03T19:00:55Z", "updated_at": "2022-05-04T11:26:14Z", "closed_at": "2022-05-04T11:26:14Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "...\r\nReplacing the `false` with `inside_loop` causes an ICE later on when compiling the match:\r\n```\r\n#0  fancy_abort (file=0x2580950 \"../../gccrs/gcc/rust/backend/rust-compile-expr.cc\", line=207, \r\n    function=0x258071e \"visit\") at ../../gccrs/gcc/diagnostic.cc:2018\r\n#1  0x00000000010d11a8 in Rust::Compile::CompileExpr::visit (this=0x7fffffffcdc0, expr=...)\r\n    at ../../gccrs/gcc/rust/backend/rust-compile-expr.cc:207\r\n#2  0x0000000000f6d172 in Rust::HIR::MatchExpr::accept_vis (this=0x32c0c80, vis=...)\r\n    at ../../gccrs/gcc/rust/hir/tree/rust-hir-full-test.cc:4898\r\n#3  0x0000000000ed6ea5 in Rust::Compile::CompileExpr::Compile (expr=0x32c0c80, ctx=0x7fffffffd720)\r\n    at ../../gccrs/gcc/rust/backend/rust-compile-expr.h:38\r\n#4  0x0000000000ed3340 in Rust::Compile::CompileBlock::visit (this=0x7fffffffcf20, expr=...)\r\n    at ../../gccrs/gcc/rust/backend/rust-compile.cc:93\r\n#5  0x0000000000f6d98e in Rust::HIR::BlockExpr::accept_vis (this=0x32c0d00, vis=...)\r\n    at ../../gccrs/gcc/rust/hir/tree/rust-hir-full-test.cc:5138\r\n#6  0x0000000000ed5f5d in Rust::Compile::CompileBlock::compile (expr=0x32c0d00, ctx=0x7fffffffd720, result=\r\n    0x0) at ../../gccrs/gcc/rust/backend/rust-compile-block.h:34\r\n#7  0x00000000010d9579 in Rust::Compile::CompileExpr::visit (this=0x7fffffffd0d0, expr=...)\r\n    at ../../gccrs/gcc/rust/backend/rust-compile-expr.h:593\r\n#8  0x0000000000f6d242 in Rust::HIR::LoopExpr::accept_vis (this=0x32cb0e0, vis=...)\r\n    at ../../gccrs/gcc/rust/hir/tree/rust-hir-full-test.cc:4922\r\n#9  0x0000000000ed6ea5 in Rust::Compile::CompileExpr::Compile (expr=0x32cb0e0, ctx=0x7fffffffd720)\r\n    at ../../gccrs/gcc/rust/backend/rust-compile-expr.h:38\r\n#10 0x0000000000ed7272 in Rust::Compile::CompileStmt::visit (this=0x7fffffffd170, stmt=...)\r\n    at ../../gccrs/gcc/rust/backend/rust-compile-stmt.h:41\r\n#11 0x0000000000f6d820 in Rust::HIR::ExprStmtWithBlock::accept_vis (this=0x32cb260, vis=...)\r\n    at ../../gccrs/gcc/rust/hir/tree/rust-hir-full-test.cc:5096\r\n#12 0x0000000000ed7229 in Rust::Compile::CompileStmt::Compile (stmt=0x32cb260, ctx=0x7fffffffd720)\r\n    at ../../gccrs/gcc/rust/backend/rust-compile-stmt.h:35\r\n#13 0x00000000010e1e65 in Rust::Compile::HIRCompileBase::compile_function_body (ctx=0x7fffffffd720, fndecl=\r\n    <function_decl 0x7ffff7453100 bar::bar>, function_body=..., has_return_type=true)\r\n    at ../../gccrs/gcc/rust/backend/rust-compile-base.cc:374\r\n#14 0x00000000010e278e in Rust::Compile::HIRCompileBase::compile_function (ctx=0x7fffffffd720, fn_name=..., \r\n    self_param=..., function_params=..., qualifiers=..., visibility=..., outer_attrs=..., locus=..., \r\n    function_body=0x32c1180, canonical_path=0x32c5af8, fntype=0x3298360, function_has_return=true)\r\n    at ../../gccrs/gcc/rust/backend/rust-compile-base.cc:521\r\n#15 0x00000000010ce87f in Rust::Compile::CompileItem::visit (this=0x7fffffffd610, function=...)\r\n    at ../../gccrs/gcc/rust/backend/rust-compile-item.cc:167\r\n#16 0x0000000000f6d9c0 in Rust::HIR::Function::accept_vis (this=0x32985c0, vis=...)\r\n    at ../../gccrs/gcc/rust/hir/tree/rust-hir-full-test.cc:5144\r\n#17 0x0000000000ed5c6a in Rust::Compile::CompileItem::compile (item=0x32985c0, ctx=0x7fffffffd720, \r\n    concrete=0x0, is_query_mode=false, ref_locus=...) at ../../gccrs/gcc/rust/backend/rust-compile-item.h:37\r\n#18 0x0000000000ed306b in Rust::Compile::CompileCrate::go (this=0x7fffffffd6f0)\r\n    at ../../gccrs/gcc/rust/backend/rust-compile.cc:50\r\n#19 0x0000000000ed2fd3 in Rust::Compile::CompileCrate::Compile (crate=..., ctx=0x7fffffffd720)\r\n    at ../../gccrs/gcc/rust/backend/rust-compile.cc:43\r\n#20 0x0000000000ebd974 in Rust::Session::parse_file (\r\n...\r\n//  rust-compile-expr.cc:207: rust_assert (scrutinee_expr_tyty->get_kind () == TyTy::TypeKind::ADT);\r\n(gdb) p scrutinee_expr_tyty->get_kind ()\r\n$1 = Rust::TyTy::BOOL\r\n```\r\n\r\n_Originally posted by @dafaust in https://github.com/Rust-GCC/gccrs/issues/1196#issuecomment-1112559428_", "closed_by": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/Rust-GCC/gccrs/issues/1207/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/Rust-GCC/gccrs/issues/1207/timeline", "performed_via_github_app": null, "state_reason": "completed"}