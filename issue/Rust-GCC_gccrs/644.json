{"url": "https://api.github.com/repos/Rust-GCC/gccrs/issues/644", "repository_url": "https://api.github.com/repos/Rust-GCC/gccrs", "labels_url": "https://api.github.com/repos/Rust-GCC/gccrs/issues/644/labels{/name}", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/issues/644/comments", "events_url": "https://api.github.com/repos/Rust-GCC/gccrs/issues/644/events", "html_url": "https://github.com/Rust-GCC/gccrs/issues/644", "id": 977119722, "node_id": "MDU6SXNzdWU5NzcxMTk3MjI=", "number": 644, "title": "Closure abi handling", "user": {"login": "bjorn3", "id": 17426603, "node_id": "MDQ6VXNlcjE3NDI2NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/17426603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bjorn3", "html_url": "https://github.com/bjorn3", "followers_url": "https://api.github.com/users/bjorn3/followers", "following_url": "https://api.github.com/users/bjorn3/following{/other_user}", "gists_url": "https://api.github.com/users/bjorn3/gists{/gist_id}", "starred_url": "https://api.github.com/users/bjorn3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bjorn3/subscriptions", "organizations_url": "https://api.github.com/users/bjorn3/orgs", "repos_url": "https://api.github.com/users/bjorn3/repos", "events_url": "https://api.github.com/users/bjorn3/events{/privacy}", "received_events_url": "https://api.github.com/users/bjorn3/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 2029873897, "node_id": "MDU6TGFiZWwyMDI5ODczODk3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/labels/plan", "name": "plan", "color": "42ed5c", "default": false, "description": ""}, {"id": 2553914391, "node_id": "MDU6TGFiZWwyNTUzOTE0Mzkx", "url": "https://api.github.com/repos/Rust-GCC/gccrs/labels/Rust%20Integrations", "name": "Rust Integrations", "color": "a80611", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-08-23T14:51:10Z", "updated_at": "2021-08-23T14:51:40Z", "closed_at": null, "author_association": "NONE", "active_lock_reason": null, "body": "Closures have the \"rust-call\" abi, which is identical to the \"Rust\" abi except that the last argument must be a tuple. This tuple is unpacked at the abi level, so for example `extern \"rust-call\" fn foo(self: Closure, args: (u8, u32))` and `fn foo(self: Closure, arg1: u8, arg2: u32)` have an identical abi. In addition the rust abi always skips zst arguments even if the C abi for the current platform doesn't. This means that `fn foo(a: (), b: u8)` and `fn foo(b: u8)` have an identical abi.\r\n\r\nCombined this allows a zst closure to be casted to a function pointer without having to introduce a shim to go from the abi of the function pointer to the abi of `FnOnce::call_once`. Instead a function pointer to the `FnOnce::call_once` of the respective closure can be returned directly. (for example `(|a: u8, b: u32| a as u32 + b) as fn(u8, u32) -> u32` is valid)", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/Rust-GCC/gccrs/issues/644/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/Rust-GCC/gccrs/issues/644/timeline", "performed_via_github_app": null, "state_reason": null}