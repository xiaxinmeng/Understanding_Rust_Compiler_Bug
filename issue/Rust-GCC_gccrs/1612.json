{"url": "https://api.github.com/repos/Rust-GCC/gccrs/issues/1612", "repository_url": "https://api.github.com/repos/Rust-GCC/gccrs", "labels_url": "https://api.github.com/repos/Rust-GCC/gccrs/issues/1612/labels{/name}", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/issues/1612/comments", "events_url": "https://api.github.com/repos/Rust-GCC/gccrs/issues/1612/events", "html_url": "https://github.com/Rust-GCC/gccrs/issues/1612", "id": 1419296232, "node_id": "I_kwDOANBUbM5UmL3o", "number": 1612, "title": "ARM64 segv on closure parsing", "user": {"login": "philberty", "id": 84585, "node_id": "MDQ6VXNlcjg0NTg1", "avatar_url": "https://avatars.githubusercontent.com/u/84585?v=4", "gravatar_id": "", "url": "https://api.github.com/users/philberty", "html_url": "https://github.com/philberty", "followers_url": "https://api.github.com/users/philberty/followers", "following_url": "https://api.github.com/users/philberty/following{/other_user}", "gists_url": "https://api.github.com/users/philberty/gists{/gist_id}", "starred_url": "https://api.github.com/users/philberty/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/philberty/subscriptions", "organizations_url": "https://api.github.com/users/philberty/orgs", "repos_url": "https://api.github.com/users/philberty/repos", "events_url": "https://api.github.com/users/philberty/events{/privacy}", "received_events_url": "https://api.github.com/users/philberty/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 61372775, "node_id": "MDU6TGFiZWw2MTM3Mjc3NQ==", "url": "https://api.github.com/repos/Rust-GCC/gccrs/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/Rust-GCC/gccrs/milestones/11", "html_url": "https://github.com/Rust-GCC/gccrs/milestone/11", "labels_url": "https://api.github.com/repos/Rust-GCC/gccrs/milestones/11/labels", "id": 8516475, "node_id": "MI_kwDOANBUbM4AgfN7", "number": 11, "title": "Initial upstream patches", "description": "", "creator": {"login": "CohenArthur", "id": 43524065, "node_id": "MDQ6VXNlcjQzNTI0MDY1", "avatar_url": "https://avatars.githubusercontent.com/u/43524065?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CohenArthur", "html_url": "https://github.com/CohenArthur", "followers_url": "https://api.github.com/users/CohenArthur/followers", "following_url": "https://api.github.com/users/CohenArthur/following{/other_user}", "gists_url": "https://api.github.com/users/CohenArthur/gists{/gist_id}", "starred_url": "https://api.github.com/users/CohenArthur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CohenArthur/subscriptions", "organizations_url": "https://api.github.com/users/CohenArthur/orgs", "repos_url": "https://api.github.com/users/CohenArthur/repos", "events_url": "https://api.github.com/users/CohenArthur/events{/privacy}", "received_events_url": "https://api.github.com/users/CohenArthur/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 47, "state": "closed", "created_at": "2022-10-07T08:35:21Z", "updated_at": "2022-11-17T10:54:30Z", "due_on": "2022-11-13T08:00:00Z", "closed_at": "2022-11-17T10:54:30Z"}, "comments": 1, "created_at": "2022-10-22T13:29:35Z", "updated_at": "2022-11-14T09:25:34Z", "closed_at": "2022-11-14T09:25:34Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "<!--\r\nThank you for finding an Internal Compiler Error! \ud83e\uddca  If possible, try to provide\r\na minimal verifiable example. You can read \"Rust Bug Minimization Patterns\" for\r\nhow to create smaller examples.\r\n\r\nhttp://blog.pnkfx.org/blog/2019/11/18/rust-bug-minimization-patterns/\r\n\r\n-->\r\n\r\n### Code\r\n\r\nhttps://builder.sourceware.org/testrun/9059e7ab9dbd0eabd3f528ff04e207e7396be38a?filename=gcc%2Ftestsuite%2Frust%2Frust.log\r\n\r\n```rust\r\nextern \"C\" {\r\n    fn printf(s: *const i8, ...);\r\n}\r\n\r\n#[lang = \"fn_once\"]\r\npub trait FnOnce<Args> {\r\n    #[lang = \"fn_once_output\"]\r\n    type Output;\r\n\r\n    extern \"rust-call\" fn call_once(self, args: Args) -> Self::Output;\r\n}\r\n\r\nfn main() -> i32 {\r\n    let closure_annotated = |i: i32| -> i32 { i + 1 };\r\n\r\n    let i = 1;\r\n    closure_annotated(i) - 2\r\n}\r\n```\r\n\r\n### Meta\r\n\r\n- What version of Rust GCC were you using, git sha if possible. https://github.com/Rust-GCC/gccrs/commit/678bf852435aca6de25704ca417fab257fe03da9\r\n\r\n### Error output\r\n\r\n```\r\nsegv\r\n```\r\n\r\n<!--\r\nInclude a backtrace if available.\r\n-->\r\n<details><summary>Backtrace</summary>\r\n  <p>\r\n  \r\n  ```\r\n \r\n\r\nExecuting on host: /home/builder/worker/gccrust-fedora-arm64/gccrs-build/gcc/testsuite/rust1/../../gccrs -B/home/builder/worker/gccrust-fedora-arm64/gccrs-build/gcc/testsuite/rust1/../../  /home/builder/worker/gccrust-fedora-arm64/gccrs/gcc/testsuite/rust/execute/torture/closure1.rs   -fdiagnostics-plain-output     -O0     -lm  -o ./closure1.exe    (timeout = 10)\r\n--\r\n14451 | spawn -ignore SIGHUP /home/builder/worker/gccrust-fedora-arm64/gccrs-build/gcc/testsuite/rust1/../../gccrs -B/home/builder/worker/gccrust-fedora-arm64/gccrs-build/gcc/testsuite/rust1/../../ /home/builder/worker/gccrust-fedora-arm64/gccrs/gcc/testsuite/rust/execute/torture/closure1.rs -fdiagnostics-plain-output -O0 -lm -o ./closure1.exe\r\n14452 | rust1: internal compiler error: Segmentation fault\r\n14453 | 0xf48963 crash_signal\r\n14454 | ../../gccrs/gcc/toplev.cc:314\r\n14455 | 0x7f7078 Rust::Parser<Rust::Lexer>::parse_closure_param()\r\n14456 | ../../gccrs/gcc/rust/parse/rust-parse-impl.h:8906\r\n14457 | 0x7feafb Rust::Parser<Rust::Lexer>::parse_closure_expr_pratt(std::shared_ptr<Rust::Token const>, std::vector<Rust::AST::Attribute, std::allocator<Rust::AST::Attribute> >)\r\n14458 | ../../gccrs/gcc/rust/parse/rust-parse-impl.h:14742\r\n14459 | 0x7af3bb Rust::Parser<Rust::Lexer>::null_denotation(std::shared_ptr<Rust::Token const>, std::vector<Rust::AST::Attribute, std::allocator<Rust::AST::Attribute> >, Rust::ParseRestrictions)\r\n14460 | ../../gccrs/gcc/rust/parse/rust-parse-impl.h:12829\r\n14461 | 0x7b0adf Rust::Parser<Rust::Lexer>::parse_expr(int, std::vector<Rust::AST::Attribute, std::allocator<Rust::AST::Attribute> >, Rust::ParseRestrictions)\r\n14462 | ../../gccrs/gcc/rust/parse/rust-parse-impl.h:12403\r\n14463 | 0x7b1133 Rust::Parser<Rust::Lexer>::parse_expr(std::vector<Rust::AST::Attribute, std::allocator<Rust::AST::Attribute> >, Rust::ParseRestrictions)\r\n14464 | ../../gccrs/gcc/rust/parse/rust-parse-impl.h:12440\r\n14465 | 0x7ea573 Rust::Parser<Rust::Lexer>::parse_let_stmt(std::vector<Rust::AST::Attribute, std::allocator<Rust::AST::Attribute> >, Rust::ParseRestrictions)\r\n14466 | ../../gccrs/gcc/rust/parse/rust-parse-impl.h:6091\r\n14467 | 0x7ea573 Rust::Parser<Rust::Lexer>::parse_stmt_or_expr_without_block()\r\n14468 | ../../gccrs/gcc/rust/parse/rust-parse-impl.h:11539\r\n14469 | 0x7eaa03 Rust::Parser<Rust::Lexer>::parse_block_expr(std::vector<Rust::AST::Attribute, std::allocator<Rust::AST::Attribute> >, Location)\r\n14470 | ../../gccrs/gcc/rust/parse/rust-parse-impl.h:7341\r\n14471 | 0x802543 Rust::Parser<Rust::Lexer>::parse_function(Rust::AST::Visibility, std::vector<Rust::AST::Attribute, std::allocator<Rust::AST::Attribute> >)\r\n14472 | ../../gccrs/gcc/rust/parse/rust-parse-impl.h:2702\r\n14473 | 0x805d5b Rust::Parser<Rust::Lexer>::parse_vis_item(std::vector<Rust::AST::Attribute, std::allocator<Rust::AST::Attribute> >)\r\n14474 | ../../gccrs/gcc/rust/parse/rust-parse-impl.h:1259\r\n14475 | 0x8064bf Rust::Parser<Rust::Lexer>::parse_item(bool)\r\n14476 | ../../gccrs/gcc/rust/parse/rust-parse-impl.h:1080\r\n14477 | 0x8066a7 Rust::Parser<Rust::Lexer>::parse_items()\r\n14478 | ../../gccrs/gcc/rust/parse/rust-parse-impl.h:405\r\n14479 | 0x81e4ab Rust::Parser<Rust::Lexer>::parse_crate()\r\n14480 | ../../gccrs/gcc/rust/parse/rust-parse-impl.h:434\r\n14481 | 0x81812f Rust::Session::compile_crate(char const*)\r\n14482 | ../../gccrs/gcc/rust/rust-session-manager.cc:446\r\n14483 | Please submit a full bug report, with preprocessed source (by using -freport-bug).\r\n14484 | Please include the complete backtrace with any bug report.\r\n14485 | See <https://gcc.gnu.org/bugs/> for instructions.\r\n14486 | compiler exited with status 1\r\n14487 | FAIL: rust/execute/torture/closure1.rs   -O0  (internal compiler error: Segmentation fault)\r\n14488 | FAIL: rust/execute/torture/closure1.rs   -O0  (test for excess errors)\r\n\r\n\r\n  ```\r\n  \r\n  </p>\r\n</details>\r\n", "closed_by": {"login": "CohenArthur", "id": 43524065, "node_id": "MDQ6VXNlcjQzNTI0MDY1", "avatar_url": "https://avatars.githubusercontent.com/u/43524065?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CohenArthur", "html_url": "https://github.com/CohenArthur", "followers_url": "https://api.github.com/users/CohenArthur/followers", "following_url": "https://api.github.com/users/CohenArthur/following{/other_user}", "gists_url": "https://api.github.com/users/CohenArthur/gists{/gist_id}", "starred_url": "https://api.github.com/users/CohenArthur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CohenArthur/subscriptions", "organizations_url": "https://api.github.com/users/CohenArthur/orgs", "repos_url": "https://api.github.com/users/CohenArthur/repos", "events_url": "https://api.github.com/users/CohenArthur/events{/privacy}", "received_events_url": "https://api.github.com/users/CohenArthur/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/Rust-GCC/gccrs/issues/1612/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/Rust-GCC/gccrs/issues/1612/timeline", "performed_via_github_app": null, "state_reason": "completed"}