{"url": "https://api.github.com/repos/rust-lang/rust/issues/46388", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/46388/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/46388/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/46388/events", "html_url": "https://github.com/rust-lang/rust/issues/46388", "id": 277977381, "node_id": "MDU6SXNzdWUyNzc5NzczODE=", "number": 46388, "title": "Very confusing diagnostics", "user": {"login": "est31", "id": 8872119, "node_id": "MDQ6VXNlcjg4NzIxMTk=", "avatar_url": "https://avatars.githubusercontent.com/u/8872119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/est31", "html_url": "https://github.com/est31", "followers_url": "https://api.github.com/users/est31/followers", "following_url": "https://api.github.com/users/est31/following{/other_user}", "gists_url": "https://api.github.com/users/est31/gists{/gist_id}", "starred_url": "https://api.github.com/users/est31/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/est31/subscriptions", "organizations_url": "https://api.github.com/users/est31/orgs", "repos_url": "https://api.github.com/users/est31/repos", "events_url": "https://api.github.com/users/est31/events{/privacy}", "received_events_url": "https://api.github.com/users/est31/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 234902, "node_id": "MDU6TGFiZWwyMzQ5MDI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-enhancement", "name": "C-enhancement", "color": "f5f1fd", "default": false, "description": "Category: An issue proposing an enhancement or a PR with one."}, {"id": 235791, "node_id": "MDU6TGFiZWwyMzU3OTE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-diagnostics", "name": "A-diagnostics", "color": "f7e101", "default": false, "description": "Area: Messages for errors, warnings, and lints"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2017-11-30T02:31:52Z", "updated_at": "2018-10-19T20:26:35Z", "closed_at": "2018-10-19T18:52:27Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Let's presume you have the following code in your Cargo.toml:\r\n```toml\r\n[dependencies]\r\nflate2 = \"0.2\"\r\nsyntect = \"1.8\"\r\n```\r\nAnd this inside main.rs:\r\n```rust\r\nextern crate syntect;\r\nextern crate flate2;\r\n\r\nuse flate2::FlateReadExt;\r\nuse std::io::Read;\r\n\r\npub fn decompress<T :Read>(r :T) -> String {\r\n\tlet mut decoded = r.gz_decode().unwrap();\r\n\tlet mut s = String::new();\r\n\tdecoded.read_to_string(&mut s).unwrap();\r\n\ts\r\n}\r\n```\r\nThis works fine.\r\n\r\nNow you decide to update flate2 from 0.2 to 1.0 and change the line in Cargo.toml to `flate2=\"1.0\"`, not doing anything else.\r\nYou will get an error message that is super confusing:\r\n\r\n```\r\nerror[E0432]: unresolved import `flate2::FlateReadExt`\r\n --> src/lib.rs:4:5\r\n  |\r\n4 | use flate2::FlateReadExt;\r\n  |     ^^^^^^^^^^^^^^^^^^^^ no `FlateReadExt` in the root\r\n\r\nwarning: unused import: `flate2::FlateReadExt`\r\n --> src/lib.rs:4:5\r\n  |\r\n4 | use flate2::FlateReadExt;\r\n  |     ^^^^^^^^^^^^^^^^^^^^\r\n  |\r\n  = note: #[warn(unused_imports)] on by default\r\n\r\nerror[E0599]: no method named `gz_decode` found for type `T` in the current scope\r\n --> src/lib.rs:8:22\r\n  |\r\n8 |  let mut decoded = r.gz_decode().unwrap();\r\n  |                      ^^^^^^^^^\r\n  |\r\n  = help: items from traits can only be used if the trait is in scope\r\nhelp: the following trait is implemented but not in scope, perhaps add a `use` for it:\r\n  |\r\n4 | use flate2::FlateReadExt;\r\n  |\r\n```\r\n\r\nFirst it says it can't find the trait. That is the only true thing that rustc says. Version 1.0 of flate2 has removed that trait, so you must change your code.\r\n\r\nSecond, it says that the trait is not used anywhere. This is wrong, we want to use it, right below!\r\n\r\nThird, it suggests to add a use for the trait. But we have done precisely that!\r\n\r\nI can even live with the second error, but the suggestion inside the third error is definitely bad.\r\n\r\nThe underlying issue is probably that syntect version 1.8.x depends on flate2 0.2 so rustc has the metadata of flate2 0.2 loaded. It seems to mix up the versions somehow :).", "closed_by": {"login": "est31", "id": 8872119, "node_id": "MDQ6VXNlcjg4NzIxMTk=", "avatar_url": "https://avatars.githubusercontent.com/u/8872119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/est31", "html_url": "https://github.com/est31", "followers_url": "https://api.github.com/users/est31/followers", "following_url": "https://api.github.com/users/est31/following{/other_user}", "gists_url": "https://api.github.com/users/est31/gists{/gist_id}", "starred_url": "https://api.github.com/users/est31/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/est31/subscriptions", "organizations_url": "https://api.github.com/users/est31/orgs", "repos_url": "https://api.github.com/users/est31/repos", "events_url": "https://api.github.com/users/est31/events{/privacy}", "received_events_url": "https://api.github.com/users/est31/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/46388/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/46388/timeline", "performed_via_github_app": null, "state_reason": "completed"}