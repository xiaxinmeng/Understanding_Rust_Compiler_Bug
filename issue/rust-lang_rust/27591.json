{"url": "https://api.github.com/repos/rust-lang/rust/issues/27591", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/27591/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/27591/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/27591/events", "html_url": "https://github.com/rust-lang/rust/issues/27591", "id": 99766582, "node_id": "MDU6SXNzdWU5OTc2NjU4Mg==", "number": 27591, "title": "[Nightly 1.4.0-4f33e43cb 2015-08-05] Compiler panic when mis-using Zero trait", "user": {"login": "lightsfury", "id": 899835, "node_id": "MDQ6VXNlcjg5OTgzNQ==", "avatar_url": "https://avatars.githubusercontent.com/u/899835?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lightsfury", "html_url": "https://github.com/lightsfury", "followers_url": "https://api.github.com/users/lightsfury/followers", "following_url": "https://api.github.com/users/lightsfury/following{/other_user}", "gists_url": "https://api.github.com/users/lightsfury/gists{/gist_id}", "starred_url": "https://api.github.com/users/lightsfury/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lightsfury/subscriptions", "organizations_url": "https://api.github.com/users/lightsfury/orgs", "repos_url": "https://api.github.com/users/lightsfury/repos", "events_url": "https://api.github.com/users/lightsfury/events{/privacy}", "received_events_url": "https://api.github.com/users/lightsfury/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}, {"id": 147085028, "node_id": "MDU6TGFiZWwxNDcwODUwMjg=", "url": "https://api.github.com/repos/rust-lang/rust/labels/regression-from-stable-to-nightly", "name": "regression-from-stable-to-nightly", "color": "e4008a", "default": false, "description": "Performance or correctness regression from stable to nightly."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2015-08-08T03:41:21Z", "updated_at": "2015-09-15T19:47:18Z", "closed_at": "2015-09-14T09:35:35Z", "author_association": "NONE", "active_lock_reason": null, "body": "Attempting to misuse a trait can cause a compiler panic. The offending code is a simplified version of what I was working on.\n\nI tried this code:\n\n```\nfn rem_is_zero<T: Eq + Rem + Zero>(n: T, m: T) -> bool\n  where <T as Rem>::Output: Zero + Eq\n{\n  let z = <T as Rem>::Output::zero(); // Compiler panic\n  //let z = <<T as Rem>::Output as Zero>::zero(); // Compiles correctly\n\n  (n % m) == z\n}\n```\n\nAfter reviewing the documentation, I expect this to throw a syntax error. Specifically, because the let RHS should be written as: `<<T as Rem>::Output as Zero>::zero`. This code _does_ compile and work as expected.\n\nI don't know if this is specific to the Zero trait as I was able to use it like this:\n\n```\nfn eq_zero<T:Eq + Zero>(n: T) -> bool\n{\n  let z = T::zero();\n\n  n == z\n}\n```\n## Meta\n\n`rustc --version --verbose`:\n\n```\nrustc 1.4.0-nightly (4f33e43cb 2015-08-05)\nbinary: rustc\ncommit-hash: 4f33e43cbceb60ec85bb5140bd5470965ea92d16\ncommit-date: 2015-08-05\nhost: x86_64-pc-windows-gnu\nrelease: 1.4.0-nightly\n```\n\nBacktrace:\n\n```\nC:\\Stuff\\Programming\\rust-tut\\rust-nightly-bug\\src>rustc main.rs\nmain.rs:18:11: 18:35 error: internal compiler error: Type parameter `Self/SelfSpace.0` (Self/SelfSpace/0) out of range when substituting (root type=Some(Self)) substs=Substs[types=[[];[];[]], regions=[[];[];[]]]\nmain.rs:18   let z = <T as Rem>::Output::zero();\n                     ^~~~~~~~~~~~~~~~~~~~~~~~\nnote: the compiler unexpectedly panicked. this is a bug.\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports\nthread 'rustc' panicked at 'Box<Any>', ../src/libsyntax\\diagnostic.rs:176\n\nstack backtrace:\n   1:         0x699b9ce8 - sys::backtrace::write::h681b474c6c2394f4tNs\n   2:         0x699c37ff - rt::unwind::register::hb538ab914c4328d5b2w\n   3:         0x699854df - rt::unwind::begin_unwind_inner::hb80fd8ef51b4060akZw\n   4:         0x7105ee5b - diagnostic::SpanHandler::span_bug::hc633dbf01b525dc5X6A\n   5:         0x7105ee13 - diagnostic::SpanHandler::span_bug::hc633dbf01b525dc5X6A\n   6:         0x692b88d8 - middle::subst::SubstFolder<'a, 'tcx>.TypeFolder<'tcx>::fold_ty::hca42f6dc71385de0GnQ\n   7:         0x670f83d1 - check::FnCtxt<'a, 'tcx>.AstConv<'tcx>::ty_infer::hb1193da908738887xBo\n   8:         0x6716d690 - rscope::ShiftedRscope<'r>.RegionScope::anon_regions::h419ad07efdb37e6bUlu\n   9:         0x671752b2 - astconv::PathParamMode...std..cmp..PartialEq::ne::h94fa3bff02dd36c9OIu\n  10:         0x67174689 - astconv::PathParamMode...std..cmp..PartialEq::ne::h94fa3bff02dd36c9OIu\n  11:         0x6717a6cc - astconv::PathParamMode...std..cmp..PartialEq::ne::h94fa3bff02dd36c9OIu\n  12:         0x671630d8 - check::TupleArgumentsFlag...std..clone..Clone::clone::hedb38ea352ace7f6cBq\n  13:         0x67091969 - check::resolve_ty_and_def_ufcs::h0db529947a54cd24X2r\n  14:         0x6715813b - check::may_break::he5881651fb8999a1eut\n  15:         0x670f995e - check::FnCtxt<'a, 'tcx>.AstConv<'tcx>::projected_ty::h759a827f017a8a8atDo\n  16:         0x67141285 - check::may_break::he5881651fb8999a1eut\n  17:         0x67166240 - check::check_decl_initializer::hf0aa92b366271b1awas\n  18:         0x671662da - check::check_decl_local::h37a43869df125d9bKbs\n  19:         0x671664bf - check::check_stmt::h5078de71b85f2dc0Dds\n  20:         0x671182fb - check::GatherLocalsVisitor<'a, 'tcx>.Visitor<'tcx>::visit_item::h6ba246b1c9f3850dKIn\n  21:         0x670f920a - check::FnCtxt<'a, 'tcx>.AstConv<'tcx>::projected_ty::h759a827f017a8a8atDo\n  22:         0x6710fa3c - check::check_item_types::h3739f0f18758ac32ewn\n  23:         0x6710dcf0 - check::check_item_body::hc85a464b96f40859HYn\n  24:         0x6710f684 - check::check_item_types::h3739f0f18758ac32ewn\n  25:         0x671c8634 - check_crate::ha45cf61934d4de29laD\n  26:         0x67be60dc - driver::assign_node_ids_and_map::h4dcd00430a00f2727Da\n  27:         0x67be47f4 - driver::assign_node_ids_and_map::h4dcd00430a00f2727Da\n  28:         0x67bdef86 - driver::assign_node_ids_and_map::h4dcd00430a00f2727Da\n  29:         0x67bc2472 - driver::compile_input::h456239a0987e1d55Tba\n  30:         0x67caa553 - run_compiler::ha97eef431fa5768cC7b\n  31:         0x67ca8407 - run::h1e382076a350f7f7i7b\n  32:         0x67ca7da9 - run::h1e382076a350f7f7i7b\n  33:         0x699c318c - rt::unwind::imp::rust_eh_personality_catch::h8647fb0995b90ac0TMw\n  34:         0x699ad7e2 - rt::unwind::try::inner_try::haade0eef5e14ff2ddVw\n  35:         0x67ca7f77 - run::h1e382076a350f7f7i7b\n  36:         0x699c157e - sys::process::Command::cwd::h322b10c2248cc4393Ev\n  37:     0x7fffae6d2d92 - BaseThreadInitThunk\n```\n", "closed_by": {"login": "arielb1", "id": 1830974, "node_id": "MDQ6VXNlcjE4MzA5NzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1830974?v=4", "gravatar_id": "", "url": "https://api.github.com/users/arielb1", "html_url": "https://github.com/arielb1", "followers_url": "https://api.github.com/users/arielb1/followers", "following_url": "https://api.github.com/users/arielb1/following{/other_user}", "gists_url": "https://api.github.com/users/arielb1/gists{/gist_id}", "starred_url": "https://api.github.com/users/arielb1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/arielb1/subscriptions", "organizations_url": "https://api.github.com/users/arielb1/orgs", "repos_url": "https://api.github.com/users/arielb1/repos", "events_url": "https://api.github.com/users/arielb1/events{/privacy}", "received_events_url": "https://api.github.com/users/arielb1/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/27591/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/27591/timeline", "performed_via_github_app": null, "state_reason": "completed"}