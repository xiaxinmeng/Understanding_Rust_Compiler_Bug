{"url": "https://api.github.com/repos/rust-lang/rust/issues/74798", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/74798/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/74798/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/74798/events", "html_url": "https://github.com/rust-lang/rust/issues/74798", "id": 665881574, "node_id": "MDU6SXNzdWU2NjU4ODE1NzQ=", "number": 74798, "title": "Where clause in GAT must be repeated in function definition", "user": {"login": "Cassy343", "id": 15149738, "node_id": "MDQ6VXNlcjE1MTQ5NzM4", "avatar_url": "https://avatars.githubusercontent.com/u/15149738?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Cassy343", "html_url": "https://github.com/Cassy343", "followers_url": "https://api.github.com/users/Cassy343/followers", "following_url": "https://api.github.com/users/Cassy343/following{/other_user}", "gists_url": "https://api.github.com/users/Cassy343/gists{/gist_id}", "starred_url": "https://api.github.com/users/Cassy343/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Cassy343/subscriptions", "organizations_url": "https://api.github.com/users/Cassy343/orgs", "repos_url": "https://api.github.com/users/Cassy343/repos", "events_url": "https://api.github.com/users/Cassy343/events{/privacy}", "received_events_url": "https://api.github.com/users/Cassy343/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}, {"id": 1472563007, "node_id": "MDU6TGFiZWwxNDcyNTYzMDA3", "url": "https://api.github.com/repos/rust-lang/rust/labels/requires-nightly", "name": "requires-nightly", "color": "76dcde", "default": false, "description": "This issue requires a nightly compiler in some way."}, {"id": 1485960423, "node_id": "MDU6TGFiZWwxNDg1OTYwNDIz", "url": "https://api.github.com/repos/rust-lang/rust/labels/F-generic_associated_types", "name": "F-generic_associated_types", "color": "f9c0cc", "default": false, "description": "`#![feature(generic_associated_types)]` a.k.a. GATs"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-07-26T23:33:09Z", "updated_at": "2021-02-16T10:49:34Z", "closed_at": "2021-02-16T10:49:33Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!--\r\nThank you for filing a bug report! \ud83d\udc1b Please provide a short summary of the bug,\r\nalong with any information you feel relevant to replicating the bug.\r\n-->\r\n\r\nCode:\r\n\r\n```rust\r\n#![allow(incomplete_features)]\r\n#![feature(generic_associated_types)]\r\n\r\n/* Setup traits */\r\n\r\ntrait Gen<T> {\r\n    fn gen(&self) -> T;\r\n}\r\n\r\ntrait ItemHolder {\r\n    type Item;\r\n\r\n    fn item(&self) -> &Self::Item;\r\n}\r\n\r\n/* Trait with the GAT */\r\n\r\ntrait Trait {\r\n    type ItemHolder: ItemHolder where <Self::ItemHolder as ItemHolder>::Item: Gen<u32>;\r\n\r\n    fn item_holder(&self) -> Self::ItemHolder;\r\n}\r\n\r\n/* Usage of `Trait` */\r\n\r\n// This function compiles\r\nfn ok<T: Trait>(trait_impl: &T) -> u32\r\nwhere\r\n    <<T as Trait>::ItemHolder as ItemHolder>::Item: Gen<u32>\r\n{\r\n    let x = trait_impl.item_holder();\r\n    let x = x.item();\r\n    Gen::<u32>::gen(x)\r\n}\r\n\r\n// This function does not\r\nfn error<T: Trait>(trait_impl: &T) -> u32 {\r\n    let x = trait_impl.item_holder();\r\n    let x = x.item();\r\n\r\n    // Error: the trait `Gen<u32>` is not implemented for `<<T as Trait>::ItemHolder as ItemHolder>::Item`\r\n    Gen::<u32>::gen(x)\r\n}\r\n```\r\n\r\nI would expect that the repetition of the bound would not be required as it is stated verbatim in the where clause of the GAT. The following is the error the compiler gives in full:\r\n\r\n```\r\nerror[E0277]: the trait bound `<<T as Trait>::ItemHolder as ItemHolder>::Item: Gen<u32>` is not satisfied\r\n  --> src/main.rs:31:21\r\n   |\r\n17 |     fn gen(&self) -> T;\r\n   |     ------------------- required by `Gen::gen`\r\n...\r\n31 |     Gen::<u32>::gen(x)\r\n   |                     ^ the trait `Gen<u32>` is not implemented for `<<T as Trait>::ItemHolder as ItemHolder>::Item`\r\n   |\r\nhelp: consider further restricting the associated type\r\n   |\r\n26 | fn error<T: Trait>(trait_impl: &T) -> u32 where <<T as Trait>::ItemHolder as ItemHolder>::Item: Gen<u32> {\r\n   |                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n\r\nerror: aborting due to previous error\r\n```\r\n\r\n### Meta\r\n<!--\r\nIf you're using the stable version of the compiler, you should also check if the\r\nbug also exists in the beta or nightly versions.\r\n-->\r\n\r\n`rustc --version --verbose`:\r\n```\r\nrustc 1.46.0-nightly (346aec9b0 2020-07-11)\r\nbinary: rustc\r\ncommit-hash: 346aec9b02f3c74f3fce97fd6bda24709d220e49\r\ncommit-date: 2020-07-11\r\nhost: x86_64-unknown-linux-gnu\r\nrelease: 1.46.0-nightly\r\nLLVM version: 10.0\r\n```\r\n", "closed_by": {"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/74798/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/74798/timeline", "performed_via_github_app": null, "state_reason": "completed"}