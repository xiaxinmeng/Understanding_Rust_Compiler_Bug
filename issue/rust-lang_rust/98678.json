{"url": "https://api.github.com/repos/rust-lang/rust/issues/98678", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/98678/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/98678/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/98678/events", "html_url": "https://github.com/rust-lang/rust/issues/98678", "id": 1288994393, "node_id": "I_kwDOAAsO6M5M1H5Z", "number": 98678, "title": "Missing debug information about type definitions in PDB", "user": {"login": "artemmukhin", "id": 4854600, "node_id": "MDQ6VXNlcjQ4NTQ2MDA=", "avatar_url": "https://avatars.githubusercontent.com/u/4854600?v=4", "gravatar_id": "", "url": "https://api.github.com/users/artemmukhin", "html_url": "https://github.com/artemmukhin", "followers_url": "https://api.github.com/users/artemmukhin/followers", "following_url": "https://api.github.com/users/artemmukhin/following{/other_user}", "gists_url": "https://api.github.com/users/artemmukhin/gists{/gist_id}", "starred_url": "https://api.github.com/users/artemmukhin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/artemmukhin/subscriptions", "organizations_url": "https://api.github.com/users/artemmukhin/orgs", "repos_url": "https://api.github.com/users/artemmukhin/repos", "events_url": "https://api.github.com/users/artemmukhin/events{/privacy}", "received_events_url": "https://api.github.com/users/artemmukhin/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 203130, "node_id": "MDU6TGFiZWwyMDMxMzA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-debuginfo", "name": "A-debuginfo", "color": "f7e101", "default": false, "description": "Area: Debugging information in compiled programs (DWARF, PDB, etc.)"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 266005765, "node_id": "MDU6TGFiZWwyNjYwMDU3NjU=", "url": "https://api.github.com/repos/rust-lang/rust/labels/O-windows-msvc", "name": "O-windows-msvc", "color": "6e6ec0", "default": false, "description": "Toolchain: MSVC, Operating system: Windows"}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "open", "locked": false, "assignee": {"login": "mweber15", "id": 30441572, "node_id": "MDQ6VXNlcjMwNDQxNTcy", "avatar_url": "https://avatars.githubusercontent.com/u/30441572?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mweber15", "html_url": "https://github.com/mweber15", "followers_url": "https://api.github.com/users/mweber15/followers", "following_url": "https://api.github.com/users/mweber15/following{/other_user}", "gists_url": "https://api.github.com/users/mweber15/gists{/gist_id}", "starred_url": "https://api.github.com/users/mweber15/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mweber15/subscriptions", "organizations_url": "https://api.github.com/users/mweber15/orgs", "repos_url": "https://api.github.com/users/mweber15/repos", "events_url": "https://api.github.com/users/mweber15/events{/privacy}", "received_events_url": "https://api.github.com/users/mweber15/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "mweber15", "id": 30441572, "node_id": "MDQ6VXNlcjMwNDQxNTcy", "avatar_url": "https://avatars.githubusercontent.com/u/30441572?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mweber15", "html_url": "https://github.com/mweber15", "followers_url": "https://api.github.com/users/mweber15/followers", "following_url": "https://api.github.com/users/mweber15/following{/other_user}", "gists_url": "https://api.github.com/users/mweber15/gists{/gist_id}", "starred_url": "https://api.github.com/users/mweber15/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mweber15/subscriptions", "organizations_url": "https://api.github.com/users/mweber15/orgs", "repos_url": "https://api.github.com/users/mweber15/repos", "events_url": "https://api.github.com/users/mweber15/events{/privacy}", "received_events_url": "https://api.github.com/users/mweber15/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2022-06-29T16:47:27Z", "updated_at": "2023-04-05T17:43:58Z", "closed_at": null, "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "It seems like rustc does not generate enough information about types in PDB debug information. Particularly, the PDB IPI Stream contains invalid `LF_UDT_MOD_SRC_LINE` entries without source file information. Due to this issue, from the debugger's perspective, it is impossible to check whether a certain type corresponds to Rust source code or not. This affects both user-defined and stdlib types.\n\n\n### Steps to reproduce\n\n1. Create a simple Rust program with a structure definition `rusttest::MyType` located in `main.rs`\n2. Dump PDB data using `llvm-pdbutil.exe dump -all main.pdb > main.pdb.txt` command\n3. Look at  `rusttest::MyType` information in the TPI Stream and IPI Stream sections\n\nIt may look as follows:\n```\n                     Types (TPI Stream)                     \n============================================================\n  0x107A | LF_STRUCTURE [size = 76, hash = 0x2C45E] `rusttest::MyType`\n           unique name: `36f9e7b2e2f4a0c8d5bebaa1feba526d`\n           vtable: <no type>, base list: <no type>, field list: 0x1079\n           options: has unique name, sizeof 8\n\n                     Types (IPI Stream)                     \n============================================================\n   0x1051 | LF_UDT_MOD_SRC_LINE [size = 20, hash = 0x1C61]\n            udt = 0x107A, mod = 4, file = 1, line = 0\n\n                        String Table                        \n============================================================\n     ID | String\n      1 | '\\<unknown>'\n\n```\nNote, in the corresponding entry of IPI Stream (`udt = 0x107A`) we have `file = 1`, which refers to an unknown file.\n\n\nIn comparison, this is an example of correct information generated by `cl.exe` when compiling a similar C++ program:\n```\n                     Types (TPI Stream)                     \n============================================================\n   0x5760 | LF_STRUCTURE [size = 44, hash = 0x1D1EA] `MyType`\n            unique name: `.?AUMyType@@`\n            vtable: <no type>, base list: <no type>, field list: 0x575F\n            options: has unique name, sizeof 4\n\n                     Types (IPI Stream)                     \n============================================================\n   0x287E | LF_UDT_MOD_SRC_LINE [size = 18, hash = 0x5B53]\n            udt = 0x5760, mod = 1, file = 19765, line = 3\n\n                        String Table                        \n============================================================\n   19765 | 'C:\\path\\to\\main.cpp'\n```\n\n\n<!-- TRIAGEBOT_START -->\n\n<!-- TRIAGEBOT_ASSIGN_START -->\n\n<!-- TRIAGEBOT_ASSIGN_DATA_START$${\"user\":\"mweber15\"}$$TRIAGEBOT_ASSIGN_DATA_END -->\n\n<!-- TRIAGEBOT_ASSIGN_END -->\n<!-- TRIAGEBOT_END -->", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/98678/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/98678/timeline", "performed_via_github_app": null, "state_reason": null}