{"url": "https://api.github.com/repos/rust-lang/rust/issues/36920", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/36920/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/36920/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/36920/events", "html_url": "https://github.com/rust-lang/rust/issues/36920", "id": 180557470, "node_id": "MDU6SXNzdWUxODA1NTc0NzA=", "number": 36920, "title": "Missed loop optimization for `&Vec` argument in .zip()", "user": {"login": "bluss", "id": 3209739, "node_id": "MDQ6VXNlcjMyMDk3Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3209739?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bluss", "html_url": "https://github.com/bluss", "followers_url": "https://api.github.com/users/bluss/followers", "following_url": "https://api.github.com/users/bluss/following{/other_user}", "gists_url": "https://api.github.com/users/bluss/gists{/gist_id}", "starred_url": "https://api.github.com/users/bluss/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bluss/subscriptions", "organizations_url": "https://api.github.com/users/bluss/orgs", "repos_url": "https://api.github.com/users/bluss/repos", "events_url": "https://api.github.com/users/bluss/events{/privacy}", "received_events_url": "https://api.github.com/users/bluss/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 113376, "node_id": "MDU6TGFiZWwxMTMzNzY=", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-slow", "name": "I-slow", "color": "e10c02", "default": false, "description": "Problems and improvements with respect to performance of generated code."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 15, "created_at": "2016-10-03T03:34:40Z", "updated_at": "2016-10-21T16:15:17Z", "closed_at": "2016-10-21T01:33:41Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "This is a case where two almost identical functions have very different performance, because the slice version is autovectorized and the vector version is not. Note that specialization is involved, but both cases use exactly the same code path, for the slice iterator.\n\n``` rust\n#![crate_type=\"lib\"]\n\n#[no_mangle]\npub fn dot_s(xs: &[u32], ys: &[u32]) -> u32 {\n    let mut s = 0;\n    for (x, y) in xs.iter().zip(ys) {\n        s += x * y;\n    }\n    s\n}\n\n#[no_mangle]\npub fn dot_v(xs: &Vec<u32>, ys: &Vec<u32>) -> u32 {\n    let mut s = 0;\n    for (x, y) in xs.iter().zip(ys) {\n        s += x * y;\n    }\n    s\n}\n\n```\n\nUsing rustc 1.14.0-nightly (289f3a4ca 2016-09-29)\n\nNote: The Vec vs slice difference is _sometimes_ visible in actual inline use of .zip in code, depending on exact context.\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/36920/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/36920/timeline", "performed_via_github_app": null, "state_reason": "completed"}