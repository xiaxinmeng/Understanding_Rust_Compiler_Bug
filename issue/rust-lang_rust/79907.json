{"url": "https://api.github.com/repos/rust-lang/rust/issues/79907", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/79907/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/79907/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/79907/events", "html_url": "https://github.com/rust-lang/rust/issues/79907", "id": 761483628, "node_id": "MDU6SXNzdWU3NjE0ODM2Mjg=", "number": 79907, "title": "Internal Compiler Error (Nightly, MSVC)", "user": {"login": "nater540", "id": 1707111, "node_id": "MDQ6VXNlcjE3MDcxMTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1707111?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nater540", "html_url": "https://github.com/nater540", "followers_url": "https://api.github.com/users/nater540/followers", "following_url": "https://api.github.com/users/nater540/following{/other_user}", "gists_url": "https://api.github.com/users/nater540/gists{/gist_id}", "starred_url": "https://api.github.com/users/nater540/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nater540/subscriptions", "organizations_url": "https://api.github.com/users/nater540/orgs", "repos_url": "https://api.github.com/users/nater540/repos", "events_url": "https://api.github.com/users/nater540/events{/privacy}", "received_events_url": "https://api.github.com/users/nater540/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 583436937, "node_id": "MDU6TGFiZWw1ODM0MzY5Mzc=", "url": "https://api.github.com/repos/rust-lang/rust/labels/S-waiting-on-author", "name": "S-waiting-on-author", "color": "d3dddd", "default": false, "description": "Status: This is awaiting some action (such as code changes or more information) from the author."}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-12-10T18:15:13Z", "updated_at": "2020-12-16T15:15:27Z", "closed_at": "2020-12-16T15:15:27Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!--\r\nThank you for finding an Internal Compiler Error! \ud83e\uddca  If possible, try to provide\r\na minimal verifiable example. You can read \"Rust Bug Minimization Patterns\" for\r\nhow to create smaller examples.\r\n\r\nhttp://blog.pnkfx.org/blog/2019/11/18/rust-bug-minimization-patterns/\r\n\r\n-->\r\n\r\n### Cargo.toml\r\n\r\n```toml\r\n[package]\r\nname = \"test-sf\"\r\nversion = \"0.1.0\"\r\nedition = \"2018\"\r\n\r\n[dependencies]\r\ntonic = \"0.3.1\"\r\nrustforce = \"0.1.4\"\r\nserde_json = \"1.0.60\"\r\ntokio = { version = \"0.2.22\", features = [\"rt-threaded\", \"macros\"] }\r\nserde = { version = \"1.0.118\", features = [\"derive\"] }\r\n\r\n[build-dependencies]\r\ntonic-build = \"0.3.1\"\r\n\r\n```\r\n\r\n### Code\r\n\r\n```Rust\r\nuse rustforce::{Client, Error};\r\nuse rustforce::response::{QueryResponse, ErrorResponse};\r\nuse serde::Deserialize;\r\n\r\n#[derive(Deserialize, Debug)]\r\n#[serde(rename_all = \"PascalCase\")]\r\nstruct Account {\r\n  #[serde(rename = \"attributes\")]\r\n  attributes: Attribute,\r\n  id: String,\r\n  name: String\r\n}\r\n\r\n#[derive(Deserialize, Debug)]\r\nstruct Attribute {\r\n  url: String,\r\n  #[serde(rename = \"type\")]\r\n  sobject_type: String\r\n}\r\n\r\n#[tokio::main]\r\nasync fn main() -> Result<(), Error> {\r\n  let client_id = \"XXXXXXXXXXXXXXXXXXXXXXX\".to_owned();\r\n  let client_secret = \"XXXXXXXXXXXXXXXXXXXXXXX\".to_owned();\r\n  let username = \"XXXXXXXXXXXXXXXXXXXXXXX\".to_owned();\r\n  let password = \"XXXXXXXXXXXXXXXXXXXXXXX\".to_owned();\r\n\r\n  let mut client = Client::new(client_id, client_secret);\r\n  client.set_login_endpoint(\"XXXXXXXXXXXXXXXXXXXXXXX\");\r\n  client.set_instance_url(\"XXXXXXXXXXXXXXXXXXXXXXX\");\r\n  client.login_with_credential(username, password).await?;\r\n\r\n  let res: QueryResponse<Account> = client.query(\"SELECT Id, Name FROM Account\").await?;\r\n  println!(\"{:?}\", res);\r\n\r\n  Ok(())\r\n}\r\n```\r\n\r\n\r\n### Meta\r\n<!--\r\nIf you're using the stable version of the compiler, you should also check if the\r\nbug also exists in the beta or nightly versions.\r\n-->\r\n\r\n`rustc --version --verbose`:\r\n```\r\nrustc 1.50.0-nightly (f0f68778f 2020-12-09)\r\nbinary: rustc\r\ncommit-hash: f0f68778f798d6d34649745b41770829b17ba5b8\r\ncommit-date: 2020-12-09\r\nhost: x86_64-pc-windows-msvc\r\nrelease: 1.50.0-nightly\r\n```\r\n\r\n### Error output\r\n\r\n```\r\nthread 'rustc' panicked at 'called `Option::unwrap()` on a `None` value', compiler\\rustc_metadata\\src\\rmeta\\decoder.rs:1565:75\r\nnote: run with `RUST_BACKTRACE=1` environment variable to display a backtrace\r\n\r\nerror: internal compiler error: unexpected panic\r\n\r\nnote: the compiler unexpectedly panicked. this is a bug.\r\n\r\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/issues/new?labels=C-bug%2C+I-ICE%2C+T-compiler&template=ice.md\r\n\r\nnote: rustc 1.50.0-nightly (f0f68778f 2020-12-09) running on x86_64-pc-windows-msvc\r\n\r\nnote: compiler flags: -C embed-bitcode=no -C debuginfo=2 -C incremental --crate-type bin\r\n\r\nnote: some of the compiler flags provided by cargo are hidden\r\n\r\nquery stack during panic:\r\nthread 'rustc' panicked at 'already borrowed: BorrowMutError', /rustc/f0f68778f798d6d34649745b41770829b17ba5b8\\compiler\\rustc_data_structures\\src\\sync.rs:481:16\r\n\r\nerror: internal compiler error: unexpected panic\r\n\r\nnote: the compiler unexpectedly panicked. this is a bug.\r\n\r\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/issues/new?labels=C-bug%2C+I-ICE%2C+T-compiler&template=ice.md\r\n\r\nnote: rustc 1.50.0-nightly (f0f68778f 2020-12-09) running on x86_64-pc-windows-msvc\r\n\r\nnote: compiler flags: -C embed-bitcode=no -C debuginfo=2 -C incremental --crate-type bin\r\n\r\nnote: some of the compiler flags provided by cargo are hidden\r\n\r\nquery stack during panic:\r\n#0 [visible_parent_map] calculating the visible parent map\r\nerror[E0391]: cycle detected when calculating the visible parent map\r\n  |\r\n  = note: ...which again requires calculating the visible parent map, completing the cycle\r\nnote: cycle used when simplifying constant for the type system `_::<impl at src\\main.rs:5:10: 5:21>::deserialize::FIELDS`\r\n --> src\\main.rs:5:10\r\n  |\r\n5 | #[derive(Deserialize, Debug)]\r\n  |          ^^^^^^^^^^^\r\n  = note: this error originates in a derive macro (in Nightly builds, run with -Z macro-backtrace for more info)\r\n```\r\n\r\n<!--\r\nInclude a backtrace in the code block by setting `RUST_BACKTRACE=1` in your\r\nenvironment. E.g. `RUST_BACKTRACE=1 cargo build`.\r\n-->\r\n<details><summary><strong>Backtrace</strong></summary>\r\n<p>\r\n\r\n```\r\nstack backtrace:\r\n   0:     0x7ff91f20b865 - <std::sys_common::backtrace::_print::DisplayBacktrace as core::fmt::Display>::fmt::h106ca6f8fb6a294d\r\n   1:     0x7ff91f23727b - core::fmt::write::h6390b994d95aebdb\r\n   2:     0x7ff91f1fcefd - <std::io::IoSlice as core::fmt::Debug>::fmt::hd713332ae62141f3\r\n   3:     0x7ff91f20fbdd - std::panicking::take_hook::h78f8a454f3a4df82\r\n   4:     0x7ff91f20f66a - std::panicking::take_hook::h78f8a454f3a4df82\r\n   5:     0x7ff91f7a0d67 - rustc_driver::report_ice::h4bc3647b6f621de8\r\n   6:     0x7ff91f210730 - std::panicking::rust_panic_with_hook::h931fd6f26be82856\r\n   7:     0x7ff91f210201 - rust_begin_unwind\r\n   8:     0x7ff91f20c20f - <std::sys_common::backtrace::_print::DisplayBacktrace as core::fmt::Display>::fmt::h106ca6f8fb6a294d\r\n   9:     0x7ff91f210159 - rust_begin_unwind\r\n  10:     0x7ff91f2332f0 - core::panicking::panic_fmt::h45da916c710b88f7\r\n  11:     0x7ff91f232f83 - core::result::unwrap_failed::h8a30362b6787a796\r\n  12:     0x7ff923c34f98 - rustc_middle::ty::query::on_disk_cache::OnDiskCache::compute_cnum_map::hbae92ac2867b06ae\r\n  13:     0x7ff923a43344 - rustc_middle::ty::query::force_from_dep_node::h841e1a791cab1f4a\r\n  14:     0x7ff923f1b6f9 - rustc_middle::ty::context::tls::TLV::__getit::h04ab82409bdf58e1\r\n  15:     0x7ff923f1b44a - rustc_middle::ty::context::tls::TLV::__getit::h04ab82409bdf58e1\r\n  16:     0x7ff923b596fe - rustc_middle::ty::context::TyCtxt::_intern_place_elems::hf379b6ef10105517\r\n  17:     0x7ff923d89cd7 - rustc_middle::ty::context::tls::TLV::__getit::h04ab82409bdf58e1\r\n  18:     0x7ff923a21e6c - rustc_middle::ty::print::pretty::RegionHighlightMode::highlighting_bound_region::h7e8b8f69a10c3c2f\r\n  19:     0x7ff923a30d94 - rustc_middle::ty::print::pretty::RegionHighlightMode::highlighting_bound_region::h7e8b8f69a10c3c2f\r\n  20:     0x7ff923a3f082 - rustc_middle::ty::print::pretty::provide::hc119ff75f1135c0c\r\n  21:     0x7ff923a31042 - rustc_middle::ty::print::pretty::RegionHighlightMode::highlighting_bound_region::h7e8b8f69a10c3c2f\r\n  22:     0x7ff923a3a74e - rustc_middle::ty::print::pretty::RegionHighlightMode::highlighting_bound_region::h7e8b8f69a10c3c2f\r\n  23:     0x7ff923a3efb4 - rustc_middle::ty::print::pretty::provide::hc119ff75f1135c0c\r\n  24:     0x7ff923a31042 - rustc_middle::ty::print::pretty::RegionHighlightMode::highlighting_bound_region::h7e8b8f69a10c3c2f\r\n  25:     0x7ff923a3eacf - rustc_middle::ty::print::pretty::provide::hc119ff75f1135c0c\r\n  26:     0x7ff923a31042 - rustc_middle::ty::print::pretty::RegionHighlightMode::highlighting_bound_region::h7e8b8f69a10c3c2f\r\n  27:     0x7ff923a3eacf - rustc_middle::ty::print::pretty::provide::hc119ff75f1135c0c\r\n  28:     0x7ff923a31042 - rustc_middle::ty::print::pretty::RegionHighlightMode::highlighting_bound_region::h7e8b8f69a10c3c2f\r\n  29:     0x7ff923b27418 - rustc_middle::ty::print::pretty::<impl rustc_middle::ty::context::TyCtxt>::def_path_str_with_substs::hacf5a15c06f5d239\r\n  30:     0x7ff923cdf82a - rustc_middle::mir::interpret::GlobalId::display::hfc4516d063ee0e03\r\n  31:     0x7ff923d04d47 - <rustc_middle::ty::relate::GeneratorWitness as core::fmt::Debug>::fmt::ha4f972aa3c4f9a1b\r\n  32:     0x7ff923a4c805 - rustc_middle::ty::query::Query::describe::hd20c71dcf1a485c1\r\n  33:     0x7ff923b27a69 - rustc_middle::ty::query::plumbing::<impl rustc_middle::ty::context::TyCtxt>::try_print_query_stack::h7aa7c45ac33b1814\r\n  34:     0x7ff91f7a19e7 - rustc_driver::report_ice::h4bc3647b6f621de8\r\n  35:     0x7ff91f210730 - std::panicking::rust_panic_with_hook::h931fd6f26be82856\r\n  36:     0x7ff91f2101d3 - rust_begin_unwind\r\n  37:     0x7ff91f20c20f - <std::sys_common::backtrace::_print::DisplayBacktrace as core::fmt::Display>::fmt::h106ca6f8fb6a294d\r\n  38:     0x7ff91f210159 - rust_begin_unwind\r\n  39:     0x7ff91f2332f0 - core::panicking::panic_fmt::h45da916c710b88f7\r\n  40:     0x7ff91f23323c - core::panicking::panic::h3a7a516f2be28c18\r\n  41:     0x7ff922f4a5a6 - rustc_metadata::dynamic_lib::DynamicLibrary::open::h6e15f450696ffdaf\r\n  42:     0x7ff9230e153d - rustc_metadata::rmeta::decoder::cstore_impl::<impl rustc_middle::middle::cstore::CrateStore for rustc_metadata::creader::CStore>::def_path_hash_to_def_id::hb8b08d53ae47c264\r\n  43:     0x7ff923c34d82 - rustc_middle::ty::query::on_disk_cache::OnDiskCache::compute_cnum_map::hbae92ac2867b06ae\r\n  44:     0x7ff923a43344 - rustc_middle::ty::query::force_from_dep_node::h841e1a791cab1f4a\r\n  45:     0x7ff923f1b6f9 - rustc_middle::ty::context::tls::TLV::__getit::h04ab82409bdf58e1\r\n  46:     0x7ff923f1b6d7 - rustc_middle::ty::context::tls::TLV::__getit::h04ab82409bdf58e1\r\n  47:     0x7ff923f1b6d7 - rustc_middle::ty::context::tls::TLV::__getit::h04ab82409bdf58e1\r\n  48:     0x7ff923f1b6d7 - rustc_middle::ty::context::tls::TLV::__getit::h04ab82409bdf58e1\r\n  49:     0x7ff923f1b44a - rustc_middle::ty::context::tls::TLV::__getit::h04ab82409bdf58e1\r\n  50:     0x7ff923b55324 - rustc_middle::ty::context::TyCtxt::_intern_place_elems::hf379b6ef10105517\r\n  51:     0x7ff923d73cd6 - rustc_middle::ty::context::tls::TLV::__getit::h04ab82409bdf58e1\r\n  52:     0x7ff923b1caa6 - rustc_middle::mir::interpret::queries::<impl rustc_middle::ty::context::TyCtxt>::const_eval_poly::h11f85b2cff1cb81c\r\n  53:     0x7ff9234f61bc - <rustc_lint::BuiltinCombinedLateLintPass as rustc_lint::passes::LateLintPass>::check_item::hfaa0eab599bf7de5\r\n  54:     0x7ff91f9a9e98 - <rustc_interface::proc_macro_decls::Finder as rustc_hir::itemlikevisit::ItemLikeVisitor>::visit_item::h0346e58da83a9175\r\n  55:     0x7ff91f9a8d62 - <rustc_interface::proc_macro_decls::Finder as rustc_hir::itemlikevisit::ItemLikeVisitor>::visit_item::h0346e58da83a9175\r\n  56:     0x7ff91f941c0c - <rustc_interface::proc_macro_decls::Finder as rustc_hir::itemlikevisit::ItemLikeVisitor>::visit_item::h0346e58da83a9175\r\n  57:     0x7ff91f9a898d - <rustc_interface::proc_macro_decls::Finder as rustc_hir::itemlikevisit::ItemLikeVisitor>::visit_item::h0346e58da83a9175\r\n  58:     0x7ff91f9a9103 - <rustc_interface::proc_macro_decls::Finder as rustc_hir::itemlikevisit::ItemLikeVisitor>::visit_item::h0346e58da83a9175\r\n  59:     0x7ff91f9a9457 - <rustc_interface::proc_macro_decls::Finder as rustc_hir::itemlikevisit::ItemLikeVisitor>::visit_item::h0346e58da83a9175\r\n  60:     0x7ff91f93e288 - <rustc_interface::proc_macro_decls::Finder as rustc_hir::itemlikevisit::ItemLikeVisitor>::visit_item::h0346e58da83a9175\r\n  61:     0x7ff91f9aa483 - <rustc_interface::proc_macro_decls::Finder as rustc_hir::itemlikevisit::ItemLikeVisitor>::visit_item::h0346e58da83a9175\r\n  62:     0x7ff91f9436e5 - <rustc_interface::proc_macro_decls::Finder as rustc_hir::itemlikevisit::ItemLikeVisitor>::visit_item::h0346e58da83a9175\r\n  63:     0x7ff91f9a9ea3 - <rustc_interface::proc_macro_decls::Finder as rustc_hir::itemlikevisit::ItemLikeVisitor>::visit_item::h0346e58da83a9175\r\n  64:     0x7ff91f9a8d62 - <rustc_interface::proc_macro_decls::Finder as rustc_hir::itemlikevisit::ItemLikeVisitor>::visit_item::h0346e58da83a9175\r\n  65:     0x7ff91f941c0c - <rustc_interface::proc_macro_decls::Finder as rustc_hir::itemlikevisit::ItemLikeVisitor>::visit_item::h0346e58da83a9175\r\n  66:     0x7ff91f9a898d - <rustc_interface::proc_macro_decls::Finder as rustc_hir::itemlikevisit::ItemLikeVisitor>::visit_item::h0346e58da83a9175\r\n  67:     0x7ff91f9a9103 - <rustc_interface::proc_macro_decls::Finder as rustc_hir::itemlikevisit::ItemLikeVisitor>::visit_item::h0346e58da83a9175\r\n  68:     0x7ff91f942c86 - <rustc_interface::proc_macro_decls::Finder as rustc_hir::itemlikevisit::ItemLikeVisitor>::visit_item::h0346e58da83a9175\r\n  69:     0x7ff91f9a9ea3 - <rustc_interface::proc_macro_decls::Finder as rustc_hir::itemlikevisit::ItemLikeVisitor>::visit_item::h0346e58da83a9175\r\n  70:     0x7ff91f93d56e - <rustc_interface::proc_macro_decls::Finder as rustc_hir::itemlikevisit::ItemLikeVisitor>::visit_item::h0346e58da83a9175\r\n  71:     0x7ff91f99b44e - <rustc_interface::proc_macro_decls::Finder as rustc_hir::itemlikevisit::ItemLikeVisitor>::visit_item::h0346e58da83a9175\r\n  72:     0x7ff91f9f28bd - rustc_interface::passes::BoxedResolver::complete::h22e285b7f419ed0b\r\n  73:     0x7ff91f99dc15 - <rustc_interface::proc_macro_decls::Finder as rustc_hir::itemlikevisit::ItemLikeVisitor>::visit_item::h0346e58da83a9175\r\n  74:     0x7ff91f9d048f - rustc_interface::passes::QueryContext::print_stats::h34b3c30905286de8\r\n  75:     0x7ff91f803bab - <rustc_mir::transform::generator::PinArgVisitor as rustc_middle::mir::visit::MutVisitor>::tcx::ha5e97926e421fd2a\r\n  76:     0x7ff91f807206 - <rustc_mir::transform::generator::PinArgVisitor as rustc_middle::mir::visit::MutVisitor>::tcx::ha5e97926e421fd2a\r\n  77:     0x7ff91f7e9fe3 - <rustc_driver::args::Error as core::fmt::Debug>::fmt::hb838ed2d57a61e3c\r\n  78:     0x7ff91f7f8596 - rustc_ast::util::parser::prec_let_scrutinee_needs_par::h0da38a96661182e5\r\n  79:     0x7ff91f783c4c - <rustc_span::symbol::SymbolStr as core::fmt::Display>::fmt::h1e11975ae1f0450a\r\n  80:     0x7ff91f8090eb - <rustc_mir::transform::generator::PinArgVisitor as rustc_middle::mir::visit::MutVisitor>::tcx::ha5e97926e421fd2a\r\n  81:     0x7ff91f748b2e - <rustc_middle::mir::Operand as rustc_mir::dataflow::move_paths::abs_domain::Lift>::lift::h92daab7e8bf52fcf\r\n  82:     0x7ff91f7c66ec - <rustc_driver::Compilation as core::fmt::Debug>::fmt::h717dc5c57c70fe70\r\n  83:     0x7ff91f749bfc - <rustc_middle::mir::Operand as rustc_mir::dataflow::move_paths::abs_domain::Lift>::lift::h92daab7e8bf52fcf\r\n  84:     0x7ff91f7f2364 - <rustc_driver::args::Error as core::fmt::Debug>::fmt::hb838ed2d57a61e3c\r\n  85:     0x7ff91f7f8fe0 - rustc_ast::util::parser::prec_let_scrutinee_needs_par::h0da38a96661182e5\r\n  86:     0x7ff91f752a2d - <rustc_middle::mir::Operand as rustc_mir::dataflow::move_paths::abs_domain::Lift>::lift::h92daab7e8bf52fcf\r\n  87:     0x7ff91f21f4f7 - std::sys::windows::thread::Thread::new::h05d768f6146b61f1\r\n  88:     0x7ff995de7c24 - BaseThreadInitThunk\r\n  89:     0x7ff9965cd4d1 - RtlUserThreadStart\r\n```\r\n\r\n</p>\r\n</details>\r\n\r\n", "closed_by": {"login": "jyn514", "id": 23638587, "node_id": "MDQ6VXNlcjIzNjM4NTg3", "avatar_url": "https://avatars.githubusercontent.com/u/23638587?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jyn514", "html_url": "https://github.com/jyn514", "followers_url": "https://api.github.com/users/jyn514/followers", "following_url": "https://api.github.com/users/jyn514/following{/other_user}", "gists_url": "https://api.github.com/users/jyn514/gists{/gist_id}", "starred_url": "https://api.github.com/users/jyn514/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jyn514/subscriptions", "organizations_url": "https://api.github.com/users/jyn514/orgs", "repos_url": "https://api.github.com/users/jyn514/repos", "events_url": "https://api.github.com/users/jyn514/events{/privacy}", "received_events_url": "https://api.github.com/users/jyn514/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/79907/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/79907/timeline", "performed_via_github_app": null, "state_reason": "completed"}