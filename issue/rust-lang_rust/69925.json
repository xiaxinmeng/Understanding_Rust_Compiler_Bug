{"url": "https://api.github.com/repos/rust-lang/rust/issues/69925", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/69925/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/69925/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/69925/events", "html_url": "https://github.com/rust-lang/rust/issues/69925", "id": 579336716, "node_id": "MDU6SXNzdWU1NzkzMzY3MTY=", "number": 69925, "title": "Support polymorphic InstanceDef's by avoiding double substitution.", "user": {"login": "eddyb", "id": 77424, "node_id": "MDQ6VXNlcjc3NDI0", "avatar_url": "https://avatars.githubusercontent.com/u/77424?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eddyb", "html_url": "https://github.com/eddyb", "followers_url": "https://api.github.com/users/eddyb/followers", "following_url": "https://api.github.com/users/eddyb/following{/other_user}", "gists_url": "https://api.github.com/users/eddyb/gists{/gist_id}", "starred_url": "https://api.github.com/users/eddyb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eddyb/subscriptions", "organizations_url": "https://api.github.com/users/eddyb/orgs", "repos_url": "https://api.github.com/users/eddyb/repos", "events_url": "https://api.github.com/users/eddyb/events{/privacy}", "received_events_url": "https://api.github.com/users/eddyb/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 234956, "node_id": "MDU6TGFiZWwyMzQ5NTY=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-codegen", "name": "A-codegen", "color": "f7e101", "default": false, "description": "Area: Code generation"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 256133398, "node_id": "MDU6TGFiZWwyNTYxMzMzOTg=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-mir", "name": "A-mir", "color": "f7e101", "default": false, "description": "Area: Mid-level IR (MIR) - https://blog.rust-lang.org/2016/04/19/MIR.html"}, {"id": 2263949245, "node_id": "MDU6TGFiZWwyMjYzOTQ5MjQ1", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-polymorphization", "name": "A-polymorphization", "color": "f7e101", "default": false, "description": "Area: Polymorphization"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-03-11T15:11:01Z", "updated_at": "2020-09-20T06:20:13Z", "closed_at": "2020-09-20T06:20:13Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "#69036 papers over a problem in the use of MIR shim bodies, (i.e. applying `Instance`'s `substs`), by preventing `Instance::resolve` from succeeding if any substitution could *later* occur.\r\n\r\nA MIR shim's body already encapsulates the final types (i.e. monomorphic for codegen, modulo \"polymorphization\" work), so we shouldn't substitute it any further (in codegen, miri, or MIR inlining).\r\n\r\nOnce we address this, we could inline (or codegen, given \"polymorphization\") slightly polymorphic variants of these shims, but `Instance::resolve` would still need to enforce the minimum requirements for the shim MIR body being built in the first place, i.e.:\r\n* `Instance::resolve(drop_in_place::<T>)` should return `None`\r\n* `Instance::resolve(drop_in_place::<Vec<T>>)` could succeed\r\n\r\ncc @nikomatsakis @davidtwco ", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/69925/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/69925/timeline", "performed_via_github_app": null, "state_reason": "completed"}