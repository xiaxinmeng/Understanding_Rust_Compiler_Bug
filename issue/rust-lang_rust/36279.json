{"url": "https://api.github.com/repos/rust-lang/rust/issues/36279", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/36279/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/36279/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/36279/events", "html_url": "https://github.com/rust-lang/rust/issues/36279", "id": 175034209, "node_id": "MDU6SXNzdWUxNzUwMzQyMDk=", "number": 36279, "title": "when temporary value is a fn call argument, highlighting can be misleading", "user": {"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 234902, "node_id": "MDU6TGFiZWwyMzQ5MDI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-enhancement", "name": "C-enhancement", "color": "f5f1fd", "default": false, "description": "Category: An issue proposing an enhancement or a PR with one."}, {"id": 235791, "node_id": "MDU6TGFiZWwyMzU3OTE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-diagnostics", "name": "A-diagnostics", "color": "f7e101", "default": false, "description": "Area: Messages for errors, warnings, and lints"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2016-09-05T09:44:26Z", "updated_at": "2018-02-10T00:47:31Z", "closed_at": "2018-02-10T00:47:31Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "In [an example where the temporary value is dropped at the end of the statement](https://is.gd/Z6Glb7), such as when the `&` is an argument to a fn call, the resulting error can be somewhat misleading:\n\n```\nerror: borrowed value does not live long enough\n  --> <anon>:21:22\n   |\n21 |     let r = map.get(&'a');\n   |                      ^^^ - borrowed value only valid until here\n   |                      |\n   |                      does not live long enough\n22 |     assert_eq!(r, Some(&string));\n23 | }\n   | - borrowed value must be valid until here\n   |\n```\n\nIn particular, the `- borrowed value only valid until here` is intended to be \"attached\" to the `;`, but it kind of looks like it is attached to the `^^^`.\n\nOne simple way to improve this would be to change the _text_ -- temporaries are freed at one of two kinds of places:\n- innermost enclosing statement (usually);\n  - note though that the tail expr of a block is contained in the stmt that contains the block (transitively)\n- end of block (if syntactically evident that they are assigned into a let binding)\n\nI imagine we could detect which of these two categories we fall into and say \"only valid until end of this statement\" in the first case or \"end of this block\" in the second. That might help, though I guess people might not know what a \"statement\" is.\n", "closed_by": {"login": "estebank", "id": 1606434, "node_id": "MDQ6VXNlcjE2MDY0MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1606434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/estebank", "html_url": "https://github.com/estebank", "followers_url": "https://api.github.com/users/estebank/followers", "following_url": "https://api.github.com/users/estebank/following{/other_user}", "gists_url": "https://api.github.com/users/estebank/gists{/gist_id}", "starred_url": "https://api.github.com/users/estebank/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/estebank/subscriptions", "organizations_url": "https://api.github.com/users/estebank/orgs", "repos_url": "https://api.github.com/users/estebank/repos", "events_url": "https://api.github.com/users/estebank/events{/privacy}", "received_events_url": "https://api.github.com/users/estebank/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/36279/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/36279/timeline", "performed_via_github_app": null, "state_reason": "completed"}