{"url": "https://api.github.com/repos/rust-lang/rust/issues/60988", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/60988/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/60988/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/60988/events", "html_url": "https://github.com/rust-lang/rust/issues/60988", "id": 446331777, "node_id": "MDU6SXNzdWU0NDYzMzE3Nzc=", "number": 60988, "title": "Tracking issue for stabilizing \"pipelined compilation\"", "user": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 64037154, "node_id": "MDU6TGFiZWw2NDAzNzE1NA==", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-compiletime", "name": "I-compiletime", "color": "e11d21", "default": false, "description": "Problems and improvements with respect to compile times."}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 246778137, "node_id": "MDU6TGFiZWwyNDY3NzgxMzc=", "url": "https://api.github.com/repos/rust-lang/rust/labels/B-unstable", "name": "B-unstable", "color": "d304cb", "default": false, "description": "Implemented in the nightly compiler and unstable."}, {"id": 650846969, "node_id": "MDU6TGFiZWw2NTA4NDY5Njk=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-tracking-issue", "name": "C-tracking-issue", "color": "f5f1fd", "default": false, "description": "Category: A tracking issue for an RFC or an unstable feature."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 12, "created_at": "2019-05-20T22:07:15Z", "updated_at": "2020-01-29T23:52:33Z", "closed_at": "2019-07-30T12:26:57Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "This issue is intended to be an overall tracking issue for stabilizing the recently implemented feature of \"pipelined compilation\". This tracking issue spans both Cargo and rustc, as support currently lives in both. It also builds on top of a number of other tracking issues, since they're unstable features used to implement pipelined compilation!\r\n\r\nFor a bit of background, pipelined compilation has an [initial set of notes about its implementation](https://github.com/rust-lang/compiler-team/blob/master/content/working-groups/pipelining/NOTES.md) and initially had these tracking issues:\r\n\r\n* [x] https://github.com/rust-lang/cargo/issues/6660\r\n* [x] https://github.com/rust-lang/rust/issues/58465\r\n\r\nCurrently today everything is implemented and available in nightly rustc. There is a [thread on internals](https://internals.rust-lang.org/t/evaluating-pipelined-rustc-compilation/10199) which is tasked with gaining user experience about pipelining and see the performance impact. A [collation of these measurements](https://docs.google.com/spreadsheets/d/1CU7o3IocPtNAUevvrPsTI77z_AexsRloUgiusiXJWtg/edit#gid=0) is quite promising and I feel personally is convincing enough to push on stabilizing all the sub-features!\r\n\r\nKnown blockers for stabilization:\r\n\r\n* [ ] [`-Z emit-artifact-notifications`](https://github.com/rust-lang/rust/issues/60419) - this is how Cargo learns the moment metadata is ready.\r\n* [ ] [`--json-rendered`](https://github.com/rust-lang/rust/issues/60987) - this is how Cargo continues to provide pretty error messages.\r\n* [ ] There is no way to combine `--message-format=short` in Cargo with pipelining. The compiler currently has `--error-format=json|short|human`, but for this feature in Cargo we'll need something like `--error-format=short-json` or something like that. Basically some way to request that the `rendered` field in the JSON diagnostic is a \"short message\", not the long one.\r\n* [x] Cargo pipelining is known to break with `sccache`, this should be investigated and fixed one way or another. (fixed in https://github.com/mozilla/sccache/pull/441)\r\n* [x] Pipelining fails with the RLS due to multiple `--error-format` flags (fixed in https://github.com/rust-lang/rust/pull/62176)\r\n\r\nPossible future work:\r\n\r\n* Should we game out what a \"fully pipelined\" story might look like? What if rustc blocked waiting for Cargo to tell it to proceed into the linking phase?", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/60988/reactions", "total_count": 16, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 7, "rocket": 7, "eyes": 1}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/60988/timeline", "performed_via_github_app": null, "state_reason": "completed"}