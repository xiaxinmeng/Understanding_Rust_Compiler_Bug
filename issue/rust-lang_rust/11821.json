{"url": "https://api.github.com/repos/rust-lang/rust/issues/11821", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/11821/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/11821/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/11821/events", "html_url": "https://github.com/rust-lang/rust/issues/11821", "id": 26318328, "node_id": "MDU6SXNzdWUyNjMxODMyOA==", "number": 11821, "title": "Stable or versioned ABI?", "user": {"login": "SimonSapin", "id": 291359, "node_id": "MDQ6VXNlcjI5MTM1OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/291359?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SimonSapin", "html_url": "https://github.com/SimonSapin", "followers_url": "https://api.github.com/users/SimonSapin/followers", "following_url": "https://api.github.com/users/SimonSapin/following{/other_user}", "gists_url": "https://api.github.com/users/SimonSapin/gists{/gist_id}", "starred_url": "https://api.github.com/users/SimonSapin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SimonSapin/subscriptions", "organizations_url": "https://api.github.com/users/SimonSapin/orgs", "repos_url": "https://api.github.com/users/SimonSapin/repos", "events_url": "https://api.github.com/users/SimonSapin/events{/privacy}", "received_events_url": "https://api.github.com/users/SimonSapin/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2014-01-26T17:37:43Z", "updated_at": "2014-08-04T08:57:52Z", "closed_at": "2014-08-04T08:57:52Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "The details of what\u2019s in a compiled crate file is highly dependent on the Rust version. Different Rust versions are often incompatible. Ensuring binary compatibility is probably premature for Rust right now, but we should at least improve error messages.\n\nWould it make sense to store an ABI version number in compiled crates?\n\nScenario:\n- Have a crate A\n- Have a crate B with `extern mod A` and using stuff from A\n- Build them both\n- Work on something else for a few weeks\n- Upgrade the compiler\n- Rebuild B\n\nDesired result:\n\nIt either Just Works, or fails with an error message like \"A has an incompatible ABI and needs to be rebuilt.\"\n\nObtained result (sometimes):\n- Internal compiler error.\n- Time wasted to figure out what\u2019s going on.\n\n```\n% RUST_LOG=rustc=1 make\nrustc -L ../rust-encoding url.rs --out-dir .\ntask 'rustc' failed at 'lookup_item: id not found: 108293', /home/simon/projects/servo/src/compiler/rust/src/librustc/metadata/decoder.rs:92\nerror: internal compiler error: unexpected failure\nThis message reflects a bug in the Rust compiler. \nWe would appreciate a bug report: https://github.com/mozilla/rust/wiki/HOWTO-submit-a-Rust-bug-report\nnote: the compiler hit an unexpected failure path. this is a bug\nnote: try running with RUST_LOG=rustc=1 to get further details and report the results to github.com/mozilla/rust/issues\ntask '<main>' failed at 'explicit failure', /home/simon/projects/servo/src/compiler/rust/src/librustc/lib.rs:440\nMakefile:17: recipe for target 'liburl.dummy' failed\nmake: *** [liburl.dummy] Error 101\n```\n", "closed_by": {"login": "huonw", "id": 1203825, "node_id": "MDQ6VXNlcjEyMDM4MjU=", "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4", "gravatar_id": "", "url": "https://api.github.com/users/huonw", "html_url": "https://github.com/huonw", "followers_url": "https://api.github.com/users/huonw/followers", "following_url": "https://api.github.com/users/huonw/following{/other_user}", "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}", "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/huonw/subscriptions", "organizations_url": "https://api.github.com/users/huonw/orgs", "repos_url": "https://api.github.com/users/huonw/repos", "events_url": "https://api.github.com/users/huonw/events{/privacy}", "received_events_url": "https://api.github.com/users/huonw/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/11821/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/11821/timeline", "performed_via_github_app": null, "state_reason": "completed"}