{"url": "https://api.github.com/repos/rust-lang/rust/issues/45868", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/45868/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/45868/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/45868/events", "html_url": "https://github.com/rust-lang/rust/issues/45868", "id": 272176382, "node_id": "MDU6SXNzdWUyNzIxNzYzODI=", "number": 45868, "title": "rustdoc: very unhelpful span info", "user": {"login": "est31", "id": 8872119, "node_id": "MDQ6VXNlcjg4NzIxMTk=", "avatar_url": "https://avatars.githubusercontent.com/u/8872119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/est31", "html_url": "https://github.com/est31", "followers_url": "https://api.github.com/users/est31/followers", "following_url": "https://api.github.com/users/est31/following{/other_user}", "gists_url": "https://api.github.com/users/est31/gists{/gist_id}", "starred_url": "https://api.github.com/users/est31/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/est31/subscriptions", "organizations_url": "https://api.github.com/users/est31/orgs", "repos_url": "https://api.github.com/users/est31/repos", "events_url": "https://api.github.com/users/est31/events{/privacy}", "received_events_url": "https://api.github.com/users/est31/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 203738, "node_id": "MDU6TGFiZWwyMDM3Mzg=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-rustdoc", "name": "T-rustdoc", "color": "bfd4f2", "default": false, "description": "Relevant to the rustdoc team, which will review and decide on the PR/issue."}], "state": "closed", "locked": false, "assignee": {"login": "Manishearth", "id": 1617736, "node_id": "MDQ6VXNlcjE2MTc3MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/1617736?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Manishearth", "html_url": "https://github.com/Manishearth", "followers_url": "https://api.github.com/users/Manishearth/followers", "following_url": "https://api.github.com/users/Manishearth/following{/other_user}", "gists_url": "https://api.github.com/users/Manishearth/gists{/gist_id}", "starred_url": "https://api.github.com/users/Manishearth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Manishearth/subscriptions", "organizations_url": "https://api.github.com/users/Manishearth/orgs", "repos_url": "https://api.github.com/users/Manishearth/repos", "events_url": "https://api.github.com/users/Manishearth/events{/privacy}", "received_events_url": "https://api.github.com/users/Manishearth/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "Manishearth", "id": 1617736, "node_id": "MDQ6VXNlcjE2MTc3MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/1617736?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Manishearth", "html_url": "https://github.com/Manishearth", "followers_url": "https://api.github.com/users/Manishearth/followers", "following_url": "https://api.github.com/users/Manishearth/following{/other_user}", "gists_url": "https://api.github.com/users/Manishearth/gists{/gist_id}", "starred_url": "https://api.github.com/users/Manishearth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Manishearth/subscriptions", "organizations_url": "https://api.github.com/users/Manishearth/orgs", "repos_url": "https://api.github.com/users/Manishearth/repos", "events_url": "https://api.github.com/users/Manishearth/events{/privacy}", "received_events_url": "https://api.github.com/users/Manishearth/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2017-11-08T12:11:13Z", "updated_at": "2018-01-14T14:12:10Z", "closed_at": "2018-01-14T14:12:10Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Do the following:\r\n\r\n```\r\ngit clone https://github.com/rust-onig/rust-onig\r\ncd rust-onig\r\ngit checkout 2381ea7fdc4b2dfef0905181cf26aa21b5a2ab17\r\ngit submodule update --init\r\ncargo doc\r\n```\r\n\r\nWill yield the following output:\r\n\r\n```\r\n$ cargo doc\r\n   Compiling onig_sys v66.1.1 (file://~/src/rust-onig/onig_sys)\r\n Documenting onig_sys v66.1.1 (file://~/src/rust-onig/onig_sys)\r\nerror: unknown start of token: `\r\n --> <stdin>:1:1\r\n  |\r\n1 | ```c\r\n  | ^\r\n  |\r\nhelp: unicode character '`' (Grave Accent) looks like ''' (Single Quote), but it's not\r\n --> <stdin>:1:1\r\n  |\r\n1 | ```c\r\n  | ^\r\n\r\nerror: Could not document `onig_sys`.\r\n\r\nCaused by:\r\n  process didn't exit successfully: `rustdoc --crate-name onig_sys onig_sys/src/lib.rs -o ~/src/rust-onig/target/doc -L dependency=~/src/rust-onig/target/debug/deps --extern libc=~/src/rust-onig/target/debug/deps/liblibc-db55a80d54675fa5.rlib` (exit code: 101)\r\n```\r\n\r\nThis is very hard to debug! Which \"```\" section does Rust error on? Rustdoc should provide good and clear span info on this, with line numbers relative to the file, not relative to something else.\r\n\r\nI could only debug this through removing each single ``` section and checking whether the error persists. This way I've found out that the following section is causing this:\r\n\r\n```rust\r\n    ///   Iterate function call for all names.\r\n    ///\r\n    ///  `int onig_foreach_name(regex_t* reg,\r\n    ///                         int (*func)(const UChar*, const UChar*, int,int*,regex_t*,void*),\r\n    ///                         void* arg)`\r\n    ///\r\n    /// # Returns\r\n    ///\r\n    ///  * normal return: 0\r\n    ///  * error:         func's return value.\r\n    ///\r\n    /// # Arguments\r\n    ///\r\n    ///   1. reg:     regex object.\r\n    ///   2. func:    callback function.\r\n    ///\r\n    ///     ```c\r\n    ///     func(name, name_end, <number of groups>, <group number's list>,\r\n    ///          reg, arg);\r\n    ///     ```\r\n    ///\r\n    ///     if func does not return 0, then iteration is stopped.\r\n    ///   3. arg:     argument for func.\r\n    pub fn onig_foreach_name(reg: OnigRegex,\r\n```", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/45868/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/45868/timeline", "performed_via_github_app": null, "state_reason": "completed"}