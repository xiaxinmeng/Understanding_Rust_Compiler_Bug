{"url": "https://api.github.com/repos/rust-lang/rust/issues/66785", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/66785/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/66785/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/66785/events", "html_url": "https://github.com/rust-lang/rust/issues/66785", "id": 528863675, "node_id": "MDU6SXNzdWU1Mjg4NjM2NzU=", "number": 66785, "title": "'rustc' panicked at 'already borrowed: BorrowMutError'", "user": {"login": "ggriffiniii", "id": 7447, "node_id": "MDQ6VXNlcjc0NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/7447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ggriffiniii", "html_url": "https://github.com/ggriffiniii", "followers_url": "https://api.github.com/users/ggriffiniii/followers", "following_url": "https://api.github.com/users/ggriffiniii/following{/other_user}", "gists_url": "https://api.github.com/users/ggriffiniii/gists{/gist_id}", "starred_url": "https://api.github.com/users/ggriffiniii/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ggriffiniii/subscriptions", "organizations_url": "https://api.github.com/users/ggriffiniii/orgs", "repos_url": "https://api.github.com/users/ggriffiniii/repos", "events_url": "https://api.github.com/users/ggriffiniii/events{/privacy}", "received_events_url": "https://api.github.com/users/ggriffiniii/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-11-26T17:15:02Z", "updated_at": "2019-11-26T17:39:50Z", "closed_at": "2019-11-26T17:39:50Z", "author_association": "NONE", "active_lock_reason": null, "body": "I was modifying some code, really had no intention of it working and was just running it to see what errors the compiler would tell me about, but the compiler panicked and asked for a bug report so here it is. The in-progress code that causes the panic is here: https://github.com/ggriffiniii/yup-oauth2/commit/90792296e5b042b9097d8afc7729ee92e2a948cf\r\n\r\nThe contents of the panic message are here:\r\n\r\n```\r\n$ RUST_BACKTRACE=full cargo test\r\n   Compiling yup-oauth2 v3.1.1 (/usr/local/google/home/glenng/src/yup-oauth2)\r\nthread 'rustc' panicked at 'already borrowed: BorrowMutError', src/libcore/result.rs:1165:5\r\nstack backtrace:\r\n   0:     0x7fd0db3d7af4 - backtrace::backtrace::libunwind::trace::hda41dbcdfba36aa0\r\n                               at /cargo/registry/src/github.com-1ecc6299db9ec823/backtrace-0.3.37/src/backtrace/libunwind.rs:88\r\n   1:     0x7fd0db3d7af4 - backtrace::backtrace::trace_unsynchronized::h1a8d6e1f8cb3f5d4\r\n                               at /cargo/registry/src/github.com-1ecc6299db9ec823/backtrace-0.3.37/src/backtrace/mod.rs:66\r\n   2:     0x7fd0db3d7af4 - std::sys_common::backtrace::_print_fmt::h610c4127487e10da\r\n                               at src/libstd/sys_common/backtrace.rs:76\r\n   3:     0x7fd0db3d7af4 - <std::sys_common::backtrace::_print::DisplayBacktrace as core::fmt::Display>::fmt::h0722dc552e01bd1d\r\n                               at src/libstd/sys_common/backtrace.rs:60\r\n   4:     0x7fd0db41012c - core::fmt::write::h01edf6dd68a42c9c\r\n                               at src/libcore/fmt/mod.rs:1030\r\n   5:     0x7fd0db3cbd17 - std::io::Write::write_fmt::hf15985f193f03c04\r\n                               at src/libstd/io/mod.rs:1412\r\n   6:     0x7fd0db3dc325 - std::sys_common::backtrace::_print::hd8d5d08a1795e743\r\n                               at src/libstd/sys_common/backtrace.rs:64\r\n   7:     0x7fd0db3dc325 - std::sys_common::backtrace::print::hf89a79e3921a2366\r\n                               at src/libstd/sys_common/backtrace.rs:49\r\n   8:     0x7fd0db3dc325 - std::panicking::default_hook::{{closure}}::h3a8f42beb3bb8ae3\r\n                               at src/libstd/panicking.rs:196\r\n   9:     0x7fd0db3dc016 - std::panicking::default_hook::h8f803b0bc31a5c37\r\n                               at src/libstd/panicking.rs:210\r\n  10:     0x7fd0db913483 - rustc_driver::report_ice::he98718c53edc6d3d\r\n  11:     0x7fd0db3dcb0c - std::panicking::rust_panic_with_hook::h825f041245da8739\r\n                               at src/libstd/panicking.rs:477\r\n  12:     0x7fd0db3dc5c2 - std::panicking::continue_panic_fmt::hbe0378e33481e81b\r\n                               at src/libstd/panicking.rs:380\r\n  13:     0x7fd0db3dc4b6 - rust_begin_unwind\r\n                               at src/libstd/panicking.rs:307\r\n  14:     0x7fd0db409aca - core::panicking::panic_fmt::h527855ce0bc891f6\r\n                               at src/libcore/panicking.rs:85\r\n  15:     0x7fd0db409d07 - core::result::unwrap_failed::ha8b77e6004f0ba38\r\n                               at src/libcore/result.rs:1165\r\n  16:     0x7fd0dbe900fd - rustc_typeck::check::Inherited::register_predicate::h6d6ab2aea880daf6\r\n  17:     0x7fd0dbe902dd - rustc_typeck::check::Inherited::register_predicates::h4e2bca41d54a7f92\r\n  18:     0x7fd0dbe9a7f5 - <rustc_typeck::check::FnCtxt as rustc_typeck::astconv::AstConv>::normalize_ty::h003fa83adb304603\r\n  19:     0x7fd0dbf3965d - <dyn rustc_typeck::astconv::AstConv>::ast_ty_to_ty::hb5ab16737116477a\r\n  20:     0x7fd0dbf2d011 - <dyn rustc_typeck::astconv::AstConv>::create_substs_for_ast_path::hbcf004e45578b8dd\r\n  21:     0x7fd0dbf29ebe - <dyn rustc_typeck::astconv::AstConv>::ast_path_substs_for_ty::h0fc6ccdaa4a94456\r\n  22:     0x7fd0dbf37afc - <dyn rustc_typeck::astconv::AstConv>::res_to_ty::h838cbf426757fa76\r\n  23:     0x7fd0dbf3965d - <dyn rustc_typeck::astconv::AstConv>::ast_ty_to_ty::hb5ab16737116477a\r\n  24:     0x7fd0dbea050c - rustc_typeck::check::FnCtxt::check_argument_types::h648ecc2af68d79cc\r\n  25:     0x7fd0dbe8b042 - rustc_typeck::check::callee::<impl rustc_typeck::check::FnCtxt>::confirm_builtin_call::ha7eae76e9c28b73b\r\n  26:     0x7fd0dbe89561 - rustc_typeck::check::callee::<impl rustc_typeck::check::FnCtxt>::check_call::h45d30abc30b22158\r\n  27:     0x7fd0dbe6fcd8 - rustc_typeck::check::expr::<impl rustc_typeck::check::FnCtxt>::check_expr_kind::h8b25c6ef69e01f12\r\n  28:     0x7fd0dbe6f28b - rustc_typeck::check::expr::<impl rustc_typeck::check::FnCtxt>::check_expr_with_expectation_and_needs::h0000f1a19a63396f\r\n  29:     0x7fd0dbea39d8 - rustc_typeck::check::FnCtxt::check_block_with_expected::h0bf314ef8ed232a6\r\n  30:     0x7fd0dbe6fcf3 - rustc_typeck::check::expr::<impl rustc_typeck::check::FnCtxt>::check_expr_kind::h8b25c6ef69e01f12\r\n  31:     0x7fd0dbe6f28b - rustc_typeck::check::expr::<impl rustc_typeck::check::FnCtxt>::check_expr_with_expectation_and_needs::h0000f1a19a63396f\r\n  32:     0x7fd0dbe78d9b - rustc_typeck::check::expr::<impl rustc_typeck::check::FnCtxt>::check_return_expr::h51bf174a038068dd\r\n  33:     0x7fd0dbe91e3d - rustc_typeck::check::check_fn::hb04722ffaefc34ec\r\n  34:     0x7fd0dc00a518 - rustc::ty::context::GlobalCtxt::enter_local::hee87012a37ec7481\r\n  35:     0x7fd0dbe90ea2 - rustc_typeck::check::typeck_tables_of::h7e98a74ad7491971\r\n  36:     0x7fd0dbee24ca - rustc::ty::query::__query_compute::typeck_tables_of::h8235d6e55b8e3584\r\n  37:     0x7fd0dbf7c15b - rustc::ty::query::<impl rustc::ty::query::config::QueryAccessors for rustc::ty::query::queries::typeck_tables_of>::compute::hef02a238f3e43402\r\n  38:     0x7fd0dbf20cc2 - rustc::dep_graph::graph::DepGraph::with_task_impl::hd911b0f10264fdeb\r\n  39:     0x7fd0dbffb551 - rustc::ty::query::plumbing::<impl rustc::ty::context::TyCtxt>::get_query::hfde020d3574d1a10\r\n  40:     0x7fd0dbf78eaf - rustc::ty::<impl rustc::ty::context::TyCtxt>::par_body_owners::h449b282b3524b717\r\n  41:     0x7fd0dbe9091d - rustc_typeck::check::typeck_item_bodies::h0ba4bbf6daf77150\r\n  42:     0x7fd0dbee2915 - rustc::ty::query::__query_compute::typeck_item_bodies::hd123b7ff5213001d\r\n  43:     0x7fd0dbf1cbf4 - rustc::dep_graph::graph::DepGraph::with_task_impl::hb629a3b21ebb2a85\r\n  44:     0x7fd0dbfc1bed - rustc::ty::query::plumbing::<impl rustc::ty::context::TyCtxt>::get_query::h9919cbc7cbdee737\r\n  45:     0x7fd0dbee750e - rustc::util::common::time::h08d6b8e4f10491a9\r\n  46:     0x7fd0dc0b759f - rustc_typeck::check_crate::h2e77f97476aecad8\r\n  47:     0x7fd0db9c200a - rustc_interface::passes::analysis::h7d37d49a7360493d\r\n  48:     0x7fd0db8d5c01 - rustc::ty::query::__query_compute::analysis::h1c5cc76ea5bb496b\r\n  49:     0x7fd0db8be322 - rustc::ty::query::plumbing::<impl rustc::ty::context::TyCtxt>::get_query::hcf7bc9d073dcb36b\r\n  50:     0x7fd0db8dd42a - rustc_interface::passes::BoxedGlobalCtxt::access::{{closure}}::h7fc0f9f179325408\r\n  51:     0x7fd0dba3e1da - rustc_interface::passes::create_global_ctxt::{{closure}}::h10595b15ffb5db35\r\n  52:     0x7fd0db8df64e - rustc_interface::interface::run_compiler_in_existing_thread_pool::ha009ae4607895a11\r\n  53:     0x7fd0db915362 - std::thread::local::LocalKey<T>::with::h30eaff0b6e71bc49\r\n  54:     0x7fd0db91a3ce - scoped_tls::ScopedKey<T>::set::h6ab0051cc42102a7\r\n  55:     0x7fd0db93b1a2 - syntax::with_globals::h9994c1c3242d3263\r\n  56:     0x7fd0db8a7e10 - std::sys_common::backtrace::__rust_begin_short_backtrace::h229c554686840b66\r\n  57:     0x7fd0db3ed25a - __rust_maybe_catch_panic\r\n                               at src/libpanic_unwind/lib.rs:80\r\n  58:     0x7fd0db8d1879 - core::ops::function::FnOnce::call_once{{vtable.shim}}::hf2e117c529f2753f\r\n  59:     0x7fd0db3be1ff - <alloc::boxed::Box<F> as core::ops::function::FnOnce<A>>::call_once::h483711add4ba2330\r\n                               at /rustc/4560ea788cb760f0a34127156c78e2552949f734/src/liballoc/boxed.rs:922\r\n  60:     0x7fd0db3ebf00 - <alloc::boxed::Box<F> as core::ops::function::FnOnce<A>>::call_once::h7605b45eb29ed0be\r\n                               at /rustc/4560ea788cb760f0a34127156c78e2552949f734/src/liballoc/boxed.rs:922\r\n  61:     0x7fd0db3ebf00 - std::sys_common::thread::start_thread::h557b0c2dc4449562\r\n                               at src/libstd/sys_common/thread.rs:13\r\n  62:     0x7fd0db3ebf00 - std::sys::unix::thread::Thread::new::thread_start::h7c2a7f9b68fe4bba\r\n                               at src/libstd/sys/unix/thread.rs:79\r\n  63:     0x7fd0db158c73 - start_thread\r\n  64:     0x7fd0daa7edef - clone\r\n  65:                0x0 - <unknown>\r\n\r\nerror: internal compiler error: unexpected panic\r\n\r\nnote: the compiler unexpectedly panicked. this is a bug.\r\n\r\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports\r\n\r\nnote: rustc 1.39.0 (4560ea788 2019-11-04) running on x86_64-unknown-linux-gnu\r\n\r\nnote: compiler flags: -C debuginfo=2 -C incremental\r\n\r\nnote: some of the compiler flags provided by cargo are hidden\r\n\r\nquery stack during panic:\r\n#0 [typeck_tables_of] processing `authenticator::tests::ensure_send_sync`\r\n#1 [typeck_item_bodies] type-checking all item bodies\r\n#2 [analysis] running analysis passes on this crate\r\nend of query stack\r\nerror: could not compile `yup-oauth2`.\r\n\r\nTo learn more, run the command again with --verbose.\r\n```", "closed_by": {"login": "jonas-schievink", "id": 1786438, "node_id": "MDQ6VXNlcjE3ODY0Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/1786438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jonas-schievink", "html_url": "https://github.com/jonas-schievink", "followers_url": "https://api.github.com/users/jonas-schievink/followers", "following_url": "https://api.github.com/users/jonas-schievink/following{/other_user}", "gists_url": "https://api.github.com/users/jonas-schievink/gists{/gist_id}", "starred_url": "https://api.github.com/users/jonas-schievink/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jonas-schievink/subscriptions", "organizations_url": "https://api.github.com/users/jonas-schievink/orgs", "repos_url": "https://api.github.com/users/jonas-schievink/repos", "events_url": "https://api.github.com/users/jonas-schievink/events{/privacy}", "received_events_url": "https://api.github.com/users/jonas-schievink/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/66785/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/66785/timeline", "performed_via_github_app": null, "state_reason": "completed"}