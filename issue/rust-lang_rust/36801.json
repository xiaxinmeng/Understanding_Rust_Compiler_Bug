{"url": "https://api.github.com/repos/rust-lang/rust/issues/36801", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/36801/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/36801/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/36801/events", "html_url": "https://github.com/rust-lang/rust/issues/36801", "id": 179808221, "node_id": "MDU6SXNzdWUxNzk4MDgyMjE=", "number": 36801, "title": "Rustc panics if enum has unsized attribute.", "user": {"login": "ghost", "id": 10137, "node_id": "MDQ6VXNlcjEwMTM3", "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ghost", "html_url": "https://github.com/ghost", "followers_url": "https://api.github.com/users/ghost/followers", "following_url": "https://api.github.com/users/ghost/following{/other_user}", "gists_url": "https://api.github.com/users/ghost/gists{/gist_id}", "starred_url": "https://api.github.com/users/ghost/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ghost/subscriptions", "organizations_url": "https://api.github.com/users/ghost/orgs", "repos_url": "https://api.github.com/users/ghost/repos", "events_url": "https://api.github.com/users/ghost/events{/privacy}", "received_events_url": "https://api.github.com/users/ghost/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2016-09-28T15:35:35Z", "updated_at": "2016-09-28T15:56:29Z", "closed_at": "2016-09-28T15:56:11Z", "author_association": "NONE", "active_lock_reason": null, "body": "Consider this code:\n\n``` rust\n#![allow(dead_code)]\n\nfn main() {\n    println!(\"Hello world\");\n}\n\nstruct StructTest {\n    x: EnumTest,\n}\n\nenum EnumTest {\n    A([usize]),\n}\n\nimpl StructTest {\n    fn test(&mut self) {\n    }\n}\n```\n\nWhat I get:\n\n> rustc 1.11.0 (9b21dcd6a 2016-08-15)\n> error: internal compiler error: ../src/librustc_trans/type_of.rs:178: Unexpected tail in unsized_info_ty: EnumTest for ty=StructTest\n> note: the compiler unexpectedly panicked. this is a bug.\n> note: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports\n> note: run with `RUST_BACKTRACE=1` for a backtrace\n> thread 'rustc' panicked at 'Box<Any>', ../src/librustc_errors/lib.rs:619\n> stack backtrace:\n>    1:     0x7fa0c066fe2f - std::sys::backtrace::tracing::imp::write::h46e546df6e4e4fe6\n>    2:     0x7fa0c067e13b - std::panicking::default_hook::_$u7b$$u7b$closure$u7d$$u7d$::h077deeda8b799591\n>    3:     0x7fa0c067dcd8 - std::panicking::default_hook::heb8b6fd640571a4f\n>    4:     0x7fa0c0643ade - std::panicking::rust_panic_with_hook::hd7b83626099d3416\n>    5:     0x7fa0b91f4187 - std::panicking::begin_panic::h3e029d5f110b4661\n>    6:     0x7fa0b91f3ad1 - rustc_errors::Handler::bug::he60f76b829c68950\n>    7:     0x7fa0bcc0ceb4 - rustc::session::opt_span_bug_fmt::_$u7b$$u7b$closure$u7d$$u7d$::h11fa08f71c1e9d84\n>    8:     0x7fa0bcc0ccbd - rustc::session::opt_span_bug_fmt::hdc2517bf24a762d0\n>    9:     0x7fa0bcc27886 - rustc::session::bug_fmt::h4bff3cf11871f37a\n>   10:     0x7fa0bf68c3e3 - rustc_trans::type_of::unsized_info_ty::h367c20592955858c\n>   11:     0x7fa0bf5403d2 - rustc_trans::type_of::in_memory_type_of::h063fab02861e60cf\n>   12:     0x7fa0bf53413a - rustc_trans::abi::FnType::unadjusted::_$u7b$$u7b$closure$u7d$$u7d$::hc2595e37370d1c41\n>   13:     0x7fa0bf531702 - rustc_trans::abi::FnType::unadjusted::hbb725f7f80132831\n>   14:     0x7fa0bf53fe42 - rustc_trans::type_of::in_memory_type_of::h063fab02861e60cf\n>   15:     0x7fa0bf5a6e6a - rustc_trans::callee::get_fn::h95e52f4d5bcb804b\n>   16:     0x7fa0bf54a5e0 - rustc_trans::callee::Callee::def::h91a0eebd5a5325c7\n>   17:     0x7fa0bf575b9c - rustc_trans::base::trans_item::hcfc6f2f68b9918b0\n>   18:     0x7fa0bf58d893 - _<rustc_trans..base..TransItemsWithinModVisitor<'a, 'tcx> as rustc..hir..intravisit..Visitor<'v>>::visit_item::hfffd713d2b3de363\n>   19:     0x7fa0bf57e337 - rustc_trans::base::trans_crate::h75826f6271b49faf\n>   20:     0x7fa0c0bc407f - rustc_driver::driver::phase_4_translate_to_llvm::hbc7e9672529bb439\n>   21:     0x7fa0c0bc106c - rustc_driver::driver::compile_input::_$u7b$$u7b$closure$u7d$$u7d$::h7168080c5b7e33b9\n>   22:     0x7fa0c0bbd77d - rustc_driver::driver::phase_3_run_analysis_passes::_$u7b$$u7b$closure$u7d$$u7d$::hded790081e457a76\n>   23:     0x7fa0c0bb6f49 - rustc::ty::context::TyCtxt::create_and_enter::h7622c0f52ea2e7fe\n>   24:     0x7fa0c0b7480f - rustc_driver::driver::compile_input::hdfe4405d66704c31\n>   25:     0x7fa0c0b60f44 - rustc_driver::run_compiler::h581448fb74257353\n>   26:     0x7fa0c0b5e04e - std::panicking::try::call::hf081e8ea5e252d1a\n>   27:     0x7fa0c068c63b - __rust_try\n>   28:     0x7fa0c068c5de - __rust_maybe_catch_panic\n>   29:     0x7fa0c0b5eb34 - _<F as alloc..boxed..FnBox<A>>::call_box::h2d5dcb354b3ff8db\n>   30:     0x7fa0c067c264 - std::sys::thread::Thread::new::thread_start::hf2eed4b6f7149599\n>   31:     0x7fa0b88e16f9 - start_thread\n>   32:     0x7fa0c02beb5c - clone\n>   33:                0x0 - <unknown>\n\nI expected the compiler to tell me, that \n`enum EnumTest {\n    A([usize]),\n}`\n\nis not possible, as the size of A is not known at compile-time. Instead it panics. Test it [https://play.rust-lang.org/?gist=2f36e717877a374b267eb072a0279614&version=stable&backtrace=1](url) in the Playground.\n", "closed_by": {"login": "apasel422", "id": 8644784, "node_id": "MDQ6VXNlcjg2NDQ3ODQ=", "avatar_url": "https://avatars.githubusercontent.com/u/8644784?v=4", "gravatar_id": "", "url": "https://api.github.com/users/apasel422", "html_url": "https://github.com/apasel422", "followers_url": "https://api.github.com/users/apasel422/followers", "following_url": "https://api.github.com/users/apasel422/following{/other_user}", "gists_url": "https://api.github.com/users/apasel422/gists{/gist_id}", "starred_url": "https://api.github.com/users/apasel422/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/apasel422/subscriptions", "organizations_url": "https://api.github.com/users/apasel422/orgs", "repos_url": "https://api.github.com/users/apasel422/repos", "events_url": "https://api.github.com/users/apasel422/events{/privacy}", "received_events_url": "https://api.github.com/users/apasel422/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/36801/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/36801/timeline", "performed_via_github_app": null, "state_reason": "completed"}