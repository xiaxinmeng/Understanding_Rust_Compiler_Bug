{"url": "https://api.github.com/repos/rust-lang/rust/issues/17299", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/17299/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/17299/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/17299/events", "html_url": "https://github.com/rust-lang/rust/issues/17299", "id": 42880092, "node_id": "MDU6SXNzdWU0Mjg4MDA5Mg==", "number": 17299, "title": "Macro expansion notes appearing without reason", "user": {"login": "Manishearth", "id": 1617736, "node_id": "MDQ6VXNlcjE2MTc3MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/1617736?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Manishearth", "html_url": "https://github.com/Manishearth", "followers_url": "https://api.github.com/users/Manishearth/followers", "following_url": "https://api.github.com/users/Manishearth/following{/other_user}", "gists_url": "https://api.github.com/users/Manishearth/gists{/gist_id}", "starred_url": "https://api.github.com/users/Manishearth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Manishearth/subscriptions", "organizations_url": "https://api.github.com/users/Manishearth/orgs", "repos_url": "https://api.github.com/users/Manishearth/repos", "events_url": "https://api.github.com/users/Manishearth/events{/privacy}", "received_events_url": "https://api.github.com/users/Manishearth/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 235146, "node_id": "MDU6TGFiZWwyMzUxNDY=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-syntaxext", "name": "A-syntaxext", "color": "f7e101", "default": false, "description": "Area: Syntax extensions"}, {"id": 235791, "node_id": "MDU6TGFiZWwyMzU3OTE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-diagnostics", "name": "A-diagnostics", "color": "f7e101", "default": false, "description": "Area: Messages for errors, warnings, and lints"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2014-09-16T13:14:04Z", "updated_at": "2014-09-29T21:55:27Z", "closed_at": "2014-09-29T21:55:27Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "I don't yet have an MWE, however I've been getting macro expansion notes for errors where no macro is nearby.\n\nFor example, compiling [this branch](https://github.com/Manishearth/servo/compare/macro-notes)\n\nwill give\n\n```\n\n--- stderr\ndom/performance.rs:20:13: 20:34 error: unrooted JS<T> is not allowed here, #[deny(unrooted_must_root)] on by default\ndom/performance.rs:20     timing: JS<PerformanceTiming>,\n                                  ^~~~~~~~~~~~~~~~~~~~~\ndom/macros.rs:21:1: 31:2 note: in expansion of make_bool_getter!\ndom/htmltextareaelement.rs:47:5: 50:7 note: expansion site\ndom/macros.rs:21:1: 31:2 note: in expansion of make_bool_getter!\ndom/htmlselectelement.rs:59:5: 62:7 note: expansion site\ndom/macros.rs:21:1: 31:2 note: in expansion of make_bool_getter!\ndom/htmloptionelement.rs:47:5: 50:7 note: expansion site\ndom/macros.rs:21:1: 31:2 note: in expansion of make_bool_getter!\ndom/htmloptgroupelement.rs:47:5: 50:7 note: expansion site\ndom/macros.rs:21:1: 31:2 note: in expansion of make_bool_getter!\ndom/htmlinputelement.rs:47:5: 50:7 note: expansion site\ndom/macros.rs:8:1: 18:2 note: in expansion of make_getter!\ndom/htmlimageelement.rs:183:5: 185:7 note: expansion site\ndom/macros.rs:8:1: 18:2 note: in expansion of make_getter!\ndom/htmlimageelement.rs:176:5: 178:7 note: expansion site\ndom/macros.rs:34:1: 44:2 note: in expansion of make_uint_getter!\ndom/htmlimageelement.rs:169:5: 171:7 note: expansion site\ndom/macros.rs:34:1: 44:2 note: in expansion of make_uint_getter!\ndom/htmlimageelement.rs:162:5: 164:7 note: expansion site\ndom/macros.rs:8:1: 18:2 note: in expansion of make_getter!\ndom/htmlimageelement.rs:155:5: 157:7 note: expansion site\ndom/macros.rs:8:1: 18:2 note: in expansion of make_getter!\ndom/htmlimageelement.rs:148:5: 150:7 note: expansion site\ndom/macros.rs:21:1: 31:2 note: in expansion of make_bool_getter!\ndom/htmlimageelement.rs:119:5: 121:7 note: expansion site\ndom/macros.rs:8:1: 18:2 note: in expansion of make_getter!\ndom/htmlimageelement.rs:112:5: 114:7 note: expansion site\ndom/macros.rs:8:1: 18:2 note: in expansion of make_getter!\ndom/htmlimageelement.rs:105:5: 107:7 note: expansion site\ndom/macros.rs:8:1: 18:2 note: in expansion of make_getter!\ndom/htmlimageelement.rs:98:5: 100:7 note: expansion site\ndom/macros.rs:21:1: 31:2 note: in expansion of make_bool_getter!\ndom/htmlfieldsetelement.rs:72:5: 75:7 note: expansion site\ndom/macros.rs:21:1: 31:2 note: in expansion of make_bool_getter!\ndom/htmlbuttonelement.rs:53:5: 56:7 note: expansion site\nerror: aborting due to previous error \n```\n\nThe macros being expanded are defined in [script/dom/macros.rs](https://github.com/Manishearth/servo/blob/f8a78cf98a93734edc953d9492689f90d483342a/components/script/dom/macros.rs) and just expand into methods. Each occurrence of the macro is getting noted in the error.\n\nHowever, the actual error is in [performance.rs](https://github.com/Manishearth/servo/blob/f8a78cf98a93734edc953d9492689f90d483342a/components/script/dom/performance.rs) due to the commented out `#[unrooted_js_managed]` attribute at the top which is caught by the lint defined in this branch. This has nothing to do with the macro expansions listed.\n\nThis happens for other errors too (sometimes), but interestingly if I trigger the same error by commenting out the attribute in `formdata.rs` instead of `performance.rs`, the error doesn't appear.\n", "closed_by": {"login": "kmcallister", "id": 444997, "node_id": "MDQ6VXNlcjQ0NDk5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/444997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kmcallister", "html_url": "https://github.com/kmcallister", "followers_url": "https://api.github.com/users/kmcallister/followers", "following_url": "https://api.github.com/users/kmcallister/following{/other_user}", "gists_url": "https://api.github.com/users/kmcallister/gists{/gist_id}", "starred_url": "https://api.github.com/users/kmcallister/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kmcallister/subscriptions", "organizations_url": "https://api.github.com/users/kmcallister/orgs", "repos_url": "https://api.github.com/users/kmcallister/repos", "events_url": "https://api.github.com/users/kmcallister/events{/privacy}", "received_events_url": "https://api.github.com/users/kmcallister/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/17299/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/17299/timeline", "performed_via_github_app": null, "state_reason": "completed"}