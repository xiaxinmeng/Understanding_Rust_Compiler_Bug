{"url": "https://api.github.com/repos/rust-lang/rust/issues/110654", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/110654/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/110654/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/110654/events", "html_url": "https://github.com/rust-lang/rust/issues/110654", "id": 1678998535, "node_id": "I_kwDOAAsO6M5kE3wH", "number": 110654, "title": "`RUSTFLAGS=--verbose` causes full recompilation", "user": {"login": "catamorphism", "id": 427212, "node_id": "MDQ6VXNlcjQyNzIxMg==", "avatar_url": "https://avatars.githubusercontent.com/u/427212?v=4", "gravatar_id": "", "url": "https://api.github.com/users/catamorphism", "html_url": "https://github.com/catamorphism", "followers_url": "https://api.github.com/users/catamorphism/followers", "following_url": "https://api.github.com/users/catamorphism/following{/other_user}", "gists_url": "https://api.github.com/users/catamorphism/gists{/gist_id}", "starred_url": "https://api.github.com/users/catamorphism/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/catamorphism/subscriptions", "organizations_url": "https://api.github.com/users/catamorphism/orgs", "repos_url": "https://api.github.com/users/catamorphism/repos", "events_url": "https://api.github.com/users/catamorphism/events{/privacy}", "received_events_url": "https://api.github.com/users/catamorphism/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 235791, "node_id": "MDU6TGFiZWwyMzU3OTE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-diagnostics", "name": "A-diagnostics", "color": "f7e101", "default": false, "description": "Area: Messages for errors, warnings, and lints"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2023-04-21T19:37:12Z", "updated_at": "2023-04-22T03:01:10Z", "closed_at": "2023-04-22T02:57:47Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Doing a full build, then repeating the command prefixed by `RUSTFLAGS=--verbose`, triggers a full recompilation.\r\n\r\n```Shell\r\n$ ./x.py build\r\nBuilding bootstrap\r\n    Finished dev [unoptimized] target(s) in 0.09s\r\nBuilding stage0 library artifacts (x86_64-unknown-linux-gnu) \r\n    Finished release [optimized] target(s) in 0.12s\r\nBuilding compiler artifacts (stage0 -> stage1)\r\n    Finished release [optimized] target(s) in 0.26s\r\nAssembling stage1 compiler\r\nBuilding stage1 library artifacts (x86_64-unknown-linux-gnu) \r\n    Finished release [optimized] target(s) in 0.09s\r\nWarning: no codegen-backends config matched the requested path to build a codegen backend. Help: add backend to codegen-backends in config.toml.\r\nBuild completed successfully in 0:00:00\r\n$ RUSTFLAGS=--verbose ./x.py build\r\nBuilding bootstrap\r\n   Compiling libc v0.2.140\r\n   Compiling memchr v2.5.0\r\n   Compiling cfg-if v1.0.0\r\n   Compiling typenum v1.15.0\r\n   Compiling version_check v0.9.4\r\n   Compiling proc-macro2 v1.0.46\r\n   Compiling io-lifetimes v1.0.9\r\n   Compiling cc v1.0.73\r\n```\r\n(etc.)\r\n\r\nI understand the rationale for triggering a full recompilation if `RUSTFLAGS` changes, but perhaps it might be worthwhile to special-case flags like `--verbose` that don't affect how the compiler generates artifacts. Maybe I should have known, but if I'm on a platform where building Rust takes hours and I'm trying to debug an error that occurs midway through compilation, it's less than ideal to have to recompile hours' worth of unchanged code to get debug output for one particular command.", "closed_by": {"login": "jyn514", "id": 23638587, "node_id": "MDQ6VXNlcjIzNjM4NTg3", "avatar_url": "https://avatars.githubusercontent.com/u/23638587?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jyn514", "html_url": "https://github.com/jyn514", "followers_url": "https://api.github.com/users/jyn514/followers", "following_url": "https://api.github.com/users/jyn514/following{/other_user}", "gists_url": "https://api.github.com/users/jyn514/gists{/gist_id}", "starred_url": "https://api.github.com/users/jyn514/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jyn514/subscriptions", "organizations_url": "https://api.github.com/users/jyn514/orgs", "repos_url": "https://api.github.com/users/jyn514/repos", "events_url": "https://api.github.com/users/jyn514/events{/privacy}", "received_events_url": "https://api.github.com/users/jyn514/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/110654/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/110654/timeline", "performed_via_github_app": null, "state_reason": "not_planned"}