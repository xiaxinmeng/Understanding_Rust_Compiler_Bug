{"url": "https://api.github.com/repos/rust-lang/rust/issues/105303", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/105303/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/105303/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/105303/events", "html_url": "https://github.com/rust-lang/rust/issues/105303", "id": 1476752825, "node_id": "I_kwDOAAsO6M5YBXW5", "number": 105303, "title": "TAIT: \"hidden type captures lifetime\" even if it's static, inside closure", "user": {"login": "Dirbaio", "id": 1247578, "node_id": "MDQ6VXNlcjEyNDc1Nzg=", "avatar_url": "https://avatars.githubusercontent.com/u/1247578?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Dirbaio", "html_url": "https://github.com/Dirbaio", "followers_url": "https://api.github.com/users/Dirbaio/followers", "following_url": "https://api.github.com/users/Dirbaio/following{/other_user}", "gists_url": "https://api.github.com/users/Dirbaio/gists{/gist_id}", "starred_url": "https://api.github.com/users/Dirbaio/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Dirbaio/subscriptions", "organizations_url": "https://api.github.com/users/Dirbaio/orgs", "repos_url": "https://api.github.com/users/Dirbaio/repos", "events_url": "https://api.github.com/users/Dirbaio/events{/privacy}", "received_events_url": "https://api.github.com/users/Dirbaio/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1472502130, "node_id": "MDU6TGFiZWwxNDcyNTAyMTMw", "url": "https://api.github.com/repos/rust-lang/rust/labels/F-type_alias_impl_trait", "name": "F-type_alias_impl_trait", "color": "f9c0cc", "default": false, "description": "`#[feature(type_alias_impl_trait)]`"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2022-12-05T14:57:43Z", "updated_at": "2022-12-05T15:02:11Z", "closed_at": null, "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "```rust\r\n    let x: &'static u32 = &0;\r\n    let _closure = move || {\r\n        type T = impl Sized;\r\n        let x: T = x;\r\n    };\r\n```\r\n\r\nThis code fails to compile [playground](https://play.rust-lang.org/?version=nightly&mode=debug&edition=2021&gist=bef54f38293950f9265140db79317e78) with: \r\n\r\n```\r\nerror[[E0700]](https://doc.rust-lang.org/nightly/error-index.html#E0700): hidden type for `T` captures lifetime that does not appear in bounds\r\n --> src/lib.rs:7:20\r\n  |\r\n7 |         let x: T = x;\r\n  |                    ^\r\n  |\r\n  = note: hidden type `&u32` captures lifetime '_#8r\r\n```\r\n\r\neven though `x` is `'static`, so it shouldn't require adding any lifetime to `T`'s bounds.\r\n\r\nIf you move `x` inside the closure then it works:\r\n\r\n```rust\r\n    let _closure = move || {\r\n        let x: &'static u32 = &0;\r\n        type T = impl Sized;\r\n        let x: T = x;\r\n    };\r\n```\r\n\r\nSeems like `x` having to go through the closure captures makes TAIT not able to use the staticness of it somehow.\r\n\r\nNightly version: 1.67.0-nightly (2022-12-04 53e4b9dd74c29cc9308b)\r\n@rustbot label F-type_alias_impl_trait", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/105303/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/105303/timeline", "performed_via_github_app": null, "state_reason": null}