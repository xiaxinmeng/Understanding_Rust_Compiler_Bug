{"url": "https://api.github.com/repos/rust-lang/rust/issues/28493", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/28493/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/28493/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/28493/events", "html_url": "https://github.com/rust-lang/rust/issues/28493", "id": 107212336, "node_id": "MDU6SXNzdWUxMDcyMTIzMzY=", "number": 28493, "title": "`BTreeSet` causes general protection fault with zero-sized key-value pairs and jemalloc", "user": {"login": "apasel422", "id": 8644784, "node_id": "MDQ6VXNlcjg2NDQ3ODQ=", "avatar_url": "https://avatars.githubusercontent.com/u/8644784?v=4", "gravatar_id": "", "url": "https://api.github.com/users/apasel422", "html_url": "https://github.com/apasel422", "followers_url": "https://api.github.com/users/apasel422/followers", "following_url": "https://api.github.com/users/apasel422/following{/other_user}", "gists_url": "https://api.github.com/users/apasel422/gists{/gist_id}", "starred_url": "https://api.github.com/users/apasel422/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/apasel422/subscriptions", "organizations_url": "https://api.github.com/users/apasel422/orgs", "repos_url": "https://api.github.com/users/apasel422/repos", "events_url": "https://api.github.com/users/apasel422/events{/privacy}", "received_events_url": "https://api.github.com/users/apasel422/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 166999014, "node_id": "MDU6TGFiZWwxNjY5OTkwMTQ=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-collections", "name": "A-collections", "color": "f7e101", "default": false, "description": "Area: std::collections."}, {"id": 211668062, "node_id": "MDU6TGFiZWwyMTE2NjgwNjI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-libs-api", "name": "T-libs-api", "color": "bfd4f2", "default": false, "description": "Relevant to the library API team, which will review and decide on the PR/issue."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2015-09-18T14:23:09Z", "updated_at": "2015-09-19T19:29:05Z", "closed_at": "2015-09-19T19:29:05Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "foo.rs:\n\n``` rust\nuse std::collections::BTreeSet;\n\nfn main() {\n    let _: BTreeSet<()> = BTreeSet::new();\n}\n```\n\nOutput:\n\n``` sh\n> rustc --version\nrustc 1.5.0-nightly (cff041170 2015-09-17)\n> rustc foo.rs\n> valgrind ./foo\n==15717== Memcheck, a memory error detector\n==15717== Copyright (C) 2002-2013, and GNU GPL'd, by Julian Seward et al.\n==15717== Using Valgrind-3.10.1 and LibVEX; rerun with -h for copyright info\n==15717== Command: ./foo\n==15717== \n==15717== Invalid read of size 1\n==15717==    at 0x11D791: je_mallocx (in /home/andrew/foo)\n==15717==    by 0x10D1DF: heap::allocate::hef78f640aa355f8bPda (in /home/andrew/foo)\n==15717==    by 0x10CA6E: btree::node::Node$LT$K$C$$u20$V$GT$::new_leaf::h84712443304502014 (in /home/andrew/foo)\n==15717==    by 0x10CA06: btree::node::Node$LT$K$C$$u20$V$GT$::make_leaf_root::h5239528127300894605 (in /home/andrew/foo)\n==15717==    by 0x10C9B4: btree::map::BTreeMap$LT$K$C$$u20$V$GT$::with_b::h8455151666287840927 (in /home/andrew/foo)\n==15717==    by 0x10C953: btree::map::BTreeMap$LT$K$C$$u20$V$GT$::new::h4727297226639213121 (in /home/andrew/foo)\n==15717==    by 0x10C92C: btree::set::BTreeSet$LT$T$GT$::new::h6672219473307838625 (in /home/andrew/foo)\n==15717==    by 0x10C90D: main::h42b03f129f44e909faa (in /home/andrew/foo)\n==15717==    by 0x114D64: sys_common::unwind::try::try_fn::h14601444602367533931 (in /home/andrew/foo)\n==15717==    by 0x111D78: __rust_try (in /home/andrew/foo)\n==15717==    by 0x1149D8: rt::lang_start::h7135051af8990a95Zkx (in /home/andrew/foo)\n==15717==    by 0x10E799: main (in /home/andrew/foo)\n==15717==  Address 0x200000000013feff is not stack'd, malloc'd or (recently) free'd\n==15717== \n==15717== \n==15717== Process terminating with default action of signal 11 (SIGSEGV)\n==15717==  General Protection Fault\n==15717==    at 0x11D791: je_mallocx (in /home/andrew/foo)\n==15717==    by 0x10D1DF: heap::allocate::hef78f640aa355f8bPda (in /home/andrew/foo)\n==15717==    by 0x10CA6E: btree::node::Node$LT$K$C$$u20$V$GT$::new_leaf::h84712443304502014 (in /home/andrew/foo)\n==15717==    by 0x10CA06: btree::node::Node$LT$K$C$$u20$V$GT$::make_leaf_root::h5239528127300894605 (in /home/andrew/foo)\n==15717==    by 0x10C9B4: btree::map::BTreeMap$LT$K$C$$u20$V$GT$::with_b::h8455151666287840927 (in /home/andrew/foo)\n==15717==    by 0x10C953: btree::map::BTreeMap$LT$K$C$$u20$V$GT$::new::h4727297226639213121 (in /home/andrew/foo)\n==15717==    by 0x10C92C: btree::set::BTreeSet$LT$T$GT$::new::h6672219473307838625 (in /home/andrew/foo)\n==15717==    by 0x10C90D: main::h42b03f129f44e909faa (in /home/andrew/foo)\n==15717==    by 0x114D64: sys_common::unwind::try::try_fn::h14601444602367533931 (in /home/andrew/foo)\n==15717==    by 0x111D78: __rust_try (in /home/andrew/foo)\n==15717==    by 0x1149D8: rt::lang_start::h7135051af8990a95Zkx (in /home/andrew/foo)\n==15717==    by 0x10E799: main (in /home/andrew/foo)\n==15717== \n==15717== HEAP SUMMARY:\n==15717==     in use at exit: 32 bytes in 1 blocks\n==15717==   total heap usage: 5 allocs, 4 frees, 976 bytes allocated\n==15717== \n==15717== LEAK SUMMARY:\n==15717==    definitely lost: 0 bytes in 0 blocks\n==15717==    indirectly lost: 0 bytes in 0 blocks\n==15717==      possibly lost: 0 bytes in 0 blocks\n==15717==    still reachable: 32 bytes in 1 blocks\n==15717==         suppressed: 0 bytes in 0 blocks\n==15717== Rerun with --leak-check=full to see details of leaked memory\n==15717== \n==15717== For counts of detected and suppressed errors, rerun with: -v\n==15717== ERROR SUMMARY: 2 errors from 1 contexts (suppressed: 0 from 0)\n\nSegmentation fault (core dumped)\n```\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/28493/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/28493/timeline", "performed_via_github_app": null, "state_reason": "completed"}