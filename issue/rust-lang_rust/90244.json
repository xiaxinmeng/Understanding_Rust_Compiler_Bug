{"url": "https://api.github.com/repos/rust-lang/rust/issues/90244", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/90244/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/90244/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/90244/events", "html_url": "https://github.com/rust-lang/rust/issues/90244", "id": 1034535170, "node_id": "I_kwDOAAsO6M49qcEC", "number": 90244, "title": "`x.py` panics when trying to build \"stage3\" compiler", "user": {"login": "camelid", "id": 37223377, "node_id": "MDQ6VXNlcjM3MjIzMzc3", "avatar_url": "https://avatars.githubusercontent.com/u/37223377?v=4", "gravatar_id": "", "url": "https://api.github.com/users/camelid", "html_url": "https://github.com/camelid", "followers_url": "https://api.github.com/users/camelid/followers", "following_url": "https://api.github.com/users/camelid/following{/other_user}", "gists_url": "https://api.github.com/users/camelid/gists{/gist_id}", "starred_url": "https://api.github.com/users/camelid/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/camelid/subscriptions", "organizations_url": "https://api.github.com/users/camelid/orgs", "repos_url": "https://api.github.com/users/camelid/repos", "events_url": "https://api.github.com/users/camelid/events{/privacy}", "received_events_url": "https://api.github.com/users/camelid/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 325438536, "node_id": "MDU6TGFiZWwzMjU0Mzg1MzY=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-bootstrap", "name": "T-bootstrap", "color": "bfd4f2", "default": false, "description": "Relevant to the bootstrap subteam: Rust's build system (x.py and src/bootstrap)"}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}, {"id": 808123953, "node_id": "MDU6TGFiZWw4MDgxMjM5NTM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-release", "name": "T-release", "color": "bfd4f2", "default": false, "description": "Relevant to the release subteam, which will review and decide on the PR/issue."}], "state": "closed", "locked": false, "assignee": {"login": "ozkanonur", "id": 39852038, "node_id": "MDQ6VXNlcjM5ODUyMDM4", "avatar_url": "https://avatars.githubusercontent.com/u/39852038?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ozkanonur", "html_url": "https://github.com/ozkanonur", "followers_url": "https://api.github.com/users/ozkanonur/followers", "following_url": "https://api.github.com/users/ozkanonur/following{/other_user}", "gists_url": "https://api.github.com/users/ozkanonur/gists{/gist_id}", "starred_url": "https://api.github.com/users/ozkanonur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ozkanonur/subscriptions", "organizations_url": "https://api.github.com/users/ozkanonur/orgs", "repos_url": "https://api.github.com/users/ozkanonur/repos", "events_url": "https://api.github.com/users/ozkanonur/events{/privacy}", "received_events_url": "https://api.github.com/users/ozkanonur/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ozkanonur", "id": 39852038, "node_id": "MDQ6VXNlcjM5ODUyMDM4", "avatar_url": "https://avatars.githubusercontent.com/u/39852038?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ozkanonur", "html_url": "https://github.com/ozkanonur", "followers_url": "https://api.github.com/users/ozkanonur/followers", "following_url": "https://api.github.com/users/ozkanonur/following{/other_user}", "gists_url": "https://api.github.com/users/ozkanonur/gists{/gist_id}", "starred_url": "https://api.github.com/users/ozkanonur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ozkanonur/subscriptions", "organizations_url": "https://api.github.com/users/ozkanonur/orgs", "repos_url": "https://api.github.com/users/ozkanonur/repos", "events_url": "https://api.github.com/users/ozkanonur/events{/privacy}", "received_events_url": "https://api.github.com/users/ozkanonur/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 21, "created_at": "2021-10-24T22:58:06Z", "updated_at": "2023-04-03T07:27:55Z", "closed_at": "2023-04-03T07:27:55Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "I don't think there even is a stage3, so I think this is a bug in bootstrap. I haven't encountered this before. Rerunning the command produces the same panic. Despite the panic, `rustc +r2stage2 --help` works, presumably because the build has finished and `x.py` is trying to do extra steps by building a non-existent stage.\n\nIn case it helps, my branch's merge-base is 00d5e42e776da900049fe19087bc9b0057ec70cd. My branch only modifies the Miri engine, so I'm pretty sure it's unrelated to this bug.\n\n```console\n$ x build --stage 2 compiler/rustc\n[...]\nCopying stage1 rustc from stage1 (x86_64-apple-darwin -> x86_64-apple-darwin / x86_64-apple-darwin)\nAssembling stage2 compiler (x86_64-apple-darwin)\nUplifting stage1 std (x86_64-apple-darwin -> x86_64-apple-darwin)\nCopying stage2 std from stage1 (x86_64-apple-darwin -> x86_64-apple-darwin / x86_64-apple-darwin)\nUplifting stage1 rustc (x86_64-apple-darwin -> x86_64-apple-darwin)\nCopying stage2 rustc from stage1 (x86_64-apple-darwin -> x86_64-apple-darwin / x86_64-apple-darwin)\nAssembling stage3 compiler (x86_64-apple-darwin)\nthread 'main' panicked at 'fs::read(stamp) failed with No such file or directory (os error 2) (\"/Users/user/rust2/build/x86_64-apple-darwin/stage2-rustc/x86_64-apple-darwin/release/.librustc.stamp\")', src/bootstrap/lib.rs:1296:24\nnote: run with `RUST_BACKTRACE=1` environment variable to display a backtrace\nBuild completed unsuccessfully in 0:29:07\n```\n\n<details><summary>Backtrace</summary>\n\n```\nthread 'main' panicked at 'fs::read(stamp) failed with No such file or directory (os error 2) (\"/Users/user/rust2/build/x86_64-apple-darwin/stage2-rustc/x86_64-apple-darwin/release/.librustc.stamp\")', src/bootstrap/lib.rs:1296:24\nstack backtrace:\n   0: rust_begin_unwind\n             at /rustc/e784c962ea252f0874a4305168077e7048cb39e9/library/std/src/panicking.rs:517:5\n   1: core::panicking::panic_fmt\n             at /rustc/e784c962ea252f0874a4305168077e7048cb39e9/library/core/src/panicking.rs:101:14\n   2: bootstrap::Build::read_stamp_file\n             at ./src/bootstrap/lib.rs:1296:24\n   3: <bootstrap::compile::Assemble as bootstrap::builder::Step>::run\n             at ./src/bootstrap/compile.rs:1107:27\n   4: bootstrap::builder::Builder::ensure\n             at ./src/bootstrap/builder.rs:1592:23\n   5: bootstrap::builder::Builder::compiler\n             at ./src/bootstrap/builder.rs:627:9\n   6: <bootstrap::compile::Assemble as bootstrap::builder::Step>::make_run\n             at ./src/bootstrap/compile.rs:1034:30\n   7: bootstrap::builder::StepDescription::maybe_run\n             at ./src/bootstrap/builder.rs:175:13\n   8: bootstrap::builder::StepDescription::run\n             at ./src/bootstrap/builder.rs:231:21\n   9: bootstrap::builder::Builder::run_step_descriptions\n             at ./src/bootstrap/builder.rs:619:9\n  10: bootstrap::builder::Builder::execute_cli\n             at ./src/bootstrap/builder.rs:599:9\n  11: bootstrap::Build::build\n             at ./src/bootstrap/lib.rs:624:13\n  12: bootstrap::main\n             at ./src/bootstrap/bin/main.rs:33:5\n  13: core::ops::function::FnOnce::call_once\n             at /rustc/e784c962ea252f0874a4305168077e7048cb39e9/library/core/src/ops/function.rs:227:5\nnote: Some details are omitted, run with `RUST_BACKTRACE=full` for a verbose backtrace.\nBuild completed unsuccessfully in 0:00:05\n```\n\n</details>\n\n<!-- TRIAGEBOT_START -->\n\n<!-- TRIAGEBOT_ASSIGN_START -->\n\n<!-- TRIAGEBOT_ASSIGN_DATA_START$${\"user\":\"ozkanonur\"}$$TRIAGEBOT_ASSIGN_DATA_END -->\n\n<!-- TRIAGEBOT_ASSIGN_END -->\n<!-- TRIAGEBOT_END -->", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/90244/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/90244/timeline", "performed_via_github_app": null, "state_reason": "completed"}