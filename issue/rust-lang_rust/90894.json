{"url": "https://api.github.com/repos/rust-lang/rust/issues/90894", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/90894/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/90894/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/90894/events", "html_url": "https://github.com/rust-lang/rust/issues/90894", "id": 1052828299, "node_id": "I_kwDOAAsO6M4-wOKL", "number": 90894, "title": "Bad value for `target-cpu` has spammy and confusing error output", "user": {"login": "lopopolo", "id": 860434, "node_id": "MDQ6VXNlcjg2MDQzNA==", "avatar_url": "https://avatars.githubusercontent.com/u/860434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lopopolo", "html_url": "https://github.com/lopopolo", "followers_url": "https://api.github.com/users/lopopolo/followers", "following_url": "https://api.github.com/users/lopopolo/following{/other_user}", "gists_url": "https://api.github.com/users/lopopolo/gists{/gist_id}", "starred_url": "https://api.github.com/users/lopopolo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lopopolo/subscriptions", "organizations_url": "https://api.github.com/users/lopopolo/orgs", "repos_url": "https://api.github.com/users/lopopolo/repos", "events_url": "https://api.github.com/users/lopopolo/events{/privacy}", "received_events_url": "https://api.github.com/users/lopopolo/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 108333, "node_id": "MDU6TGFiZWwxMDgzMzM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-LLVM", "name": "A-LLVM", "color": "f7e101", "default": false, "description": "Area: Code generation parts specific to LLVM. Both correctness bugs and optimization-related issues."}, {"id": 235791, "node_id": "MDU6TGFiZWwyMzU3OTE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-diagnostics", "name": "A-diagnostics", "color": "f7e101", "default": false, "description": "Area: Messages for errors, warnings, and lints"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 1659943986, "node_id": "MDU6TGFiZWwxNjU5OTQzOTg2", "url": "https://api.github.com/repos/rust-lang/rust/labels/D-verbose", "name": "D-verbose", "color": "c9f7a3", "default": false, "description": "Too much output caused by a single piece of incorrect code"}, {"id": 5223550385, "node_id": "LA_kwDOAAsO6M8AAAABN1kNsQ", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-target-feature", "name": "A-target-feature", "color": "f7e101", "default": false, "description": "Area: Enabling/disabling target features like AVX, Neon, etc."}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-11-14T02:39:08Z", "updated_at": "2023-03-11T03:17:28Z", "closed_at": null, "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!--\r\nThank you for filing a bug report! \ud83d\udc1b Please provide a short summary of the bug,\r\nalong with any information you feel relevant to replicating the bug.\r\n\r\nIf you cannot produce a minimal reproduction case (something that would work in\r\nisolation), please provide the steps or even link to a repository that causes\r\nthe problematic output to occur.\r\n-->\r\n\r\nI accidentally copy-and-pasted the `RUSTFLAGS` example for `-C target-cpu=` from https://rust-lang.github.io/packed_simd/perf-guide/target-feature/rustflags.html#target-cpu in an attempt to compile for `target-cpu=native`.\r\n\r\nIt looks like x86_64 Darwin doesn't like the `cortex-a75` CPU type and I got a lot of unexpected output before the build errored out in LLVM.\r\n\r\nThis same error spam reproduces if using an intentionally bad target, like `RUSTFLAGS='-C target-cpu=xxx-todo'`.\r\n\r\nGiven the following code: <!-- Please provide a link to play.rust-lang.org -->\r\n\r\nhttps://github.com/artichoke/artichoke\r\n\r\non x86_64 macOS.\r\n\r\ncompiling with:\r\n\r\n```console\r\n$ RUSTFLAGS='-C target-cpu=cortex-a75' cargo run --bin artichoke --release -q -- ../string_length.rb\r\n```\r\n\r\nThe current output is:\r\n\r\n```console\r\n$ RUSTFLAGS='-C target-cpu=cortex-a75' cargo run --bin artichoke --release -q -- ../string_length.rb\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\nLLVM ERROR: 64-bit code requested on a subtarget that doesn't support it!\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\nLLVM ERROR: 64-bit code requested on a subtarget that doesn't support it!\r\nerror: could not compile `bitflags`\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\nLLVM ERROR: 64-bit code requested on a subtarget that doesn't support it!\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\nLLVM ERROR: 64-bit code requested on a subtarget that doesn't support it!\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\nLLVM ERROR: 64-bit code requested on a subtarget that doesn't support it!\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\nLLVM ERROR: 64-bit code requested on a subtarget that doesn't support it!\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\nLLVM ERROR: 64-bit code requested on a subtarget that doesn't support it!\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\nlibc++abi: Pure virtual function called!\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\nLLVM ERROR: 64-bit code requested on a subtarget that doesn't support it!\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\nLLVM ERROR: 64-bit code requested on a subtarget that doesn't support it!\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\nLLVM ERROR: 64-bit code requested on a subtarget that doesn't support it!\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\nLLVM ERROR: 64-bit code requested on a subtarget that doesn't support it!\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\nLLVM ERROR: 64-bit code requested on a subtarget that doesn't support it!\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\nLLVM ERROR: 64-bit code requested on a subtarget that doesn't support it!\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\n'cortex-a75' is not a recognized processor for this target (ignoring processor)\r\nLLVM ERROR: 64-bit code requested on a subtarget that doesn't support it!\r\nerror: build failed\r\n```\r\n\r\n<!-- The following is not always necessary. -->\r\nIdeally the output should look like:\r\n\r\nsomething less spammy.\r\n\r\n<!--\r\nIf the problem is not self-explanatory, please provide a rationale for the\r\nchange.\r\n-->\r\n\r\n<!--\r\nIf dramatically different output is caused by small changes, consider also\r\nadding them here.\r\n\r\nIf you're using the stable version of the compiler, you should also check if the\r\nbug also exists in the beta or nightly versions. The output might also be\r\ndifferent depending on the Edition.\r\n-->\r\n\r\n## meta\r\n\r\n```console\r\n$ rustc -Vv\r\nrustc 1.56.1 (59eed8a2a 2021-11-01)\r\nbinary: rustc\r\ncommit-hash: 59eed8a2aac0230a8b53e89d4e99d55912ba6b35\r\ncommit-date: 2021-11-01\r\nhost: x86_64-apple-darwin\r\nrelease: 1.56.1\r\nLLVM version: 13.0.0\r\n```", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/90894/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/90894/timeline", "performed_via_github_app": null, "state_reason": null}