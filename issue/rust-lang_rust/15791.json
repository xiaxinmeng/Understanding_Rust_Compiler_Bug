{"url": "https://api.github.com/repos/rust-lang/rust/issues/15791", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/15791/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/15791/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/15791/events", "html_url": "https://github.com/rust-lang/rust/issues/15791", "id": 38209677, "node_id": "MDU6SXNzdWUzODIwOTY3Nw==", "number": 15791, "title": "Internal Compiler Error while asserting against an enum", "user": {"login": "fmendez", "id": 845590, "node_id": "MDQ6VXNlcjg0NTU5MA==", "avatar_url": "https://avatars.githubusercontent.com/u/845590?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fmendez", "html_url": "https://github.com/fmendez", "followers_url": "https://api.github.com/users/fmendez/followers", "following_url": "https://api.github.com/users/fmendez/following{/other_user}", "gists_url": "https://api.github.com/users/fmendez/gists{/gist_id}", "starred_url": "https://api.github.com/users/fmendez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fmendez/subscriptions", "organizations_url": "https://api.github.com/users/fmendez/orgs", "repos_url": "https://api.github.com/users/fmendez/repos", "events_url": "https://api.github.com/users/fmendez/events{/privacy}", "received_events_url": "https://api.github.com/users/fmendez/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2014-07-18T20:31:55Z", "updated_at": "2014-07-24T14:18:54Z", "closed_at": "2014-07-24T14:18:54Z", "author_association": "NONE", "active_lock_reason": null, "body": "Code to reproduce the error:\n\n``` rust\n#[deriving(PartialEq,Show)]\npub enum SomeObject{\n  SomeString(String),\n  SomeInteger(i64),\n  SomeArray(Vec<SomeObject>),\n}\n\nfn somefunction()-> Option<SomeObject>{\n  if true{\n    Some(SomeString(\"foo\".to_string()))\n  }else{\n    None\n  }\n}\n\n\nfn main(){\n  match somefunction(){\n    Some(s) => assert!(s,SomeString(\"foo\")),\n    None => println!(\"bad luck\")\n  }  \n}\n```\n\nResult:\n\n```\nexperiment $> RUST_BACKTRACE=1 cargo run                                                                                                                                      [ ruby-2.1.1 ]\n   Compiling experiment v0.1.0 (file:/Users/fmendez/Desktop/start/quick_hacking/rust-practice/experiment)\n<std macros>:8:12: 43:25 error: cannot apply unary operator `!` to type `SomeObject`\n<std macros>:8         if !$cond {\n<std macros>:9             fail!($($arg),+)\n<std macros>:10         }\n<std macros>:11     );\n<std macros>:12 )\nerror: internal compiler error: unexpected failure\nnote: the compiler hit an unexpected failure path. this is a bug.\nnote: we would appreciate a bug report: http://doc.rust-lang.org/complement-bugreport.html\nnote: run with `RUST_BACKTRACE=1` for a backtrace\ntask 'rustc' failed at 'index out of bounds: the len is 12 but the index is 12', /Users/rustbuild/src/rust-buildbot/slave/nightly-mac/build/src/libsyntax/lib.rs:1\n\nstack backtrace:\n   1:        0x10ffd4c18 - rt::backtrace::imp::write::h43147c4def9aa280Ffq\n   2:        0x10ffd8405 - failure::on_fail::h9c97bab6285818b6Yvq\n   3:        0x11028c1f9 - unwind::begin_unwind_inner::h81399a9c65ee74ceAXd\n   4:        0x11028bd87 - unwind::begin_unwind_fmt::hd65266271db9adc53Ud\n   5:        0x11028bb41 - rust_begin_unwind\n   6:        0x1102d9cce - failure::begin_unwind::hd86dd9ec804771d4Gsj\n   7:        0x1102e0749 - failure::fail_bounds_check::h4cb06daf33134d12Sqj\n   8:        0x10f674f34 - codemap::FileMap::get_line::h0e953a490dba89faaXB\n   9:        0x10f681096 - diagnostic::emit::h5dbcf8620b336a1exkD\n  10:        0x10f67ce74 - diagnostic::EmitterWriter.Emitter::emit::hc8ebf8e51adc4fa1wgD\n  11:        0x10f67ad3e - diagnostic::Handler::emit::h1876872ac38fe4dejYC\n  12:        0x10f672dd5 - diagnostic::SpanHandler::span_err::hdbe260bbdeb451deANC\n  13:        0x10d0e29c1 - middle::typeck::infer::InferCtxt<'a>::type_error_message_str_with_expected::h8924f9b9e9f50a08OTC\n  14:        0x10d189dd0 - middle::typeck::infer::InferCtxt<'a>::type_error_message::hb1ada444d64c239aw1C\n  15:        0x10d19ad10 - middle::typeck::check::check_expr_with_unifier::check_user_unop::closure.$x22closure$x22$LP$110674$RP$\n  16:        0x10d198686 - middle::typeck::check::check_expr_with_unifier::lookup_op_method::h4e4be668cec4d869Ojl\n  17:        0x10d19aaeb - middle::typeck::check::check_expr_with_unifier::check_user_unop::hfb0dd1641bea4d1bFyl\n  18:        0x10d1928ad - middle::typeck::check::check_expr_with_unifier::h702071da724e08c835k\n  19:        0x10d18f9f7 - middle::typeck::check::check_expr_with_unifier::h702071da724e08c835k\n  20:        0x10d0d8294 - middle::typeck::check::_match::check_match::h8946955578835696wz9\n  21:        0x10d18fbbc - middle::typeck::check::check_expr_with_unifier::h702071da724e08c835k\n  22:        0x10d1662f6 - middle::typeck::check::check_block_with_expected::h2eb3aca62441a33688m\n  23:        0x10d161a7d - middle::typeck::check::check_fn::h0c5443287d13fc5bNmi\n  24:        0x10d161412 - middle::typeck::check::check_bare_fn::hd69ba226c9d1758doci\n  25:        0x10d15a562 - middle::typeck::check::check_item::h5557b190840cc4ff4Ki\n  26:        0x10d16118d - middle::typeck::check::check_item_types::h3a5ec6d1fe53f89eGbi\n  27:        0x10d2cd74e - middle::typeck::check_crate::h815ace21bf7513b5Y3I\n  28:        0x10d6441d9 - driver::driver::phase_3_run_analysis_passes::h3b364399f6023cbd37t\n  29:        0x10d63f601 - driver::driver::compile_input::h7eed16699446a4bc4Tt\n  30:        0x10d6f41b8 - driver::run_compiler::h07bacfcf2975c02fK1w\n  31:        0x10d6f1886 - driver::main_args::closure.$x22closure$x22$LP$134904$RP$\n  32:        0x10d704a0b - task::TaskBuilder<S>::try_future::closure.$x22closure$x22$LP$136053$RP$\n  33:        0x10d704901 - task::TaskBuilder<S>::spawn_internal::closure.$x22closure$x22$LP$136030$RP$\n  34:        0x10ff0363c - task::spawn_opts::closure.$x22closure$x22$LP$8272$RP$\n  35:        0x1102f136c - rust_try\n  36:        0x110288f5b - unwind::try::hbd282dff76a810e4ZLd\n  37:        0x110288cc3 - task::Task::run::hb37a5b83f7232860RXc\n  38:        0x10ff034d1 - task::spawn_opts::closure.$x22closure$x22$LP$8217$RP$\n  39:        0x11028af56 - thread::thread_start::h0e9d7a12ab365fe6pkd\n  40:     0x7fff901b9899 - _pthread_body\n  41:     0x7fff901b972a - _pthread_struct_init\n```\n\nrustc -v :\n\n```\nrustc 0.12.0-pre-nightly (441866417764cb0ad32bce50ebda83deec525997 2014-07-18 11:51:20 +0000)\n```\n\nOS:  OSX\n", "closed_by": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/15791/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/15791/timeline", "performed_via_github_app": null, "state_reason": "completed"}