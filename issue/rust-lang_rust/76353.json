{"url": "https://api.github.com/repos/rust-lang/rust/issues/76353", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/76353/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/76353/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/76353/events", "html_url": "https://github.com/rust-lang/rust/issues/76353", "id": 693865514, "node_id": "MDU6SXNzdWU2OTM4NjU1MTQ=", "number": 76353, "title": "Extremely confusing error around function pointers with inferred arguments", "user": {"login": "jyn514", "id": 23638587, "node_id": "MDQ6VXNlcjIzNjM4NTg3", "avatar_url": "https://avatars.githubusercontent.com/u/23638587?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jyn514", "html_url": "https://github.com/jyn514", "followers_url": "https://api.github.com/users/jyn514/followers", "following_url": "https://api.github.com/users/jyn514/following{/other_user}", "gists_url": "https://api.github.com/users/jyn514/gists{/gist_id}", "starred_url": "https://api.github.com/users/jyn514/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jyn514/subscriptions", "organizations_url": "https://api.github.com/users/jyn514/orgs", "repos_url": "https://api.github.com/users/jyn514/repos", "events_url": "https://api.github.com/users/jyn514/events{/privacy}", "received_events_url": "https://api.github.com/users/jyn514/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 37544, "node_id": "MDU6TGFiZWwzNzU0NA==", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-typesystem", "name": "A-typesystem", "color": "f7e101", "default": false, "description": "Area: The type system"}, {"id": 235791, "node_id": "MDU6TGFiZWwyMzU3OTE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-diagnostics", "name": "A-diagnostics", "color": "f7e101", "default": false, "description": "Area: Messages for errors, warnings, and lints"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 604454086, "node_id": "MDU6TGFiZWw2MDQ0NTQwODY=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-inference", "name": "A-inference", "color": "f7e101", "default": false, "description": "Area: Type inference"}, {"id": 1596121013, "node_id": "MDU6TGFiZWwxNTk2MTIxMDEz", "url": "https://api.github.com/repos/rust-lang/rust/labels/D-confusing", "name": "D-confusing", "color": "c9f7a3", "default": false, "description": "Confusing diagnostic error that should be reworked"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2020-09-05T00:48:01Z", "updated_at": "2023-01-08T01:31:10Z", "closed_at": null, "author_association": "MEMBER", "active_lock_reason": null, "body": "Consider the following code ([playground](https://play.rust-lang.org/?version=stable&mode=debug&edition=2018&gist=f28baa0f92dd6719da86c30648e1894a)):\r\n\r\n```rust\r\nstruct S<'a>(&'a str);\r\n\r\nfn f(inner: fn(&str, &S)) {\r\n}\r\n\r\n#[allow(unreachable_code)]\r\nfn main() {\r\n    let inner: fn(_, _) = unimplemented!();\r\n    f(inner);\r\n}\r\n```\r\n\r\nRustc gives an error:\r\n```rust\r\nerror[E0308]: mismatched types\r\n --> src/main.rs:9:7\r\n  |\r\n9 |     f(inner);\r\n  |       ^^^^^ one type is more general than the other\r\n  |\r\n  = note: expected fn pointer `for<'r, 's, 't0> fn(&'r str, &'s S<'t0>)`\r\n             found fn pointer `fn(&str, &S<'_>)`\r\n```\r\n\r\nHere is the fixed code ([playground](https://play.rust-lang.org/?version=stable&mode=debug&edition=2018&gist=a76ab40d67ba8ed6f37d2a701dff699c)):\r\n\r\n```rust\r\n    let inner: fn(&str, &S<'_>) = unimplemented!();\r\n    f(inner);\r\n```\r\nIn particular, the only thing that changed was `fn(_, _)` -> `fn(&str, &S<'_>)`. But this is exactly the type that was printed in the diagnostic originally! What changed?\r\n\r\nI don't understand why this error was emitted, but it would at least be nice to suggest the transformation that makes the code work.\r\n\r\nReduced from https://github.com/rust-lang/crater/pull/542.", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/76353/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/76353/timeline", "performed_via_github_app": null, "state_reason": null}