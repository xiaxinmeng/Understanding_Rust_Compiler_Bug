{"url": "https://api.github.com/repos/rust-lang/rust/issues/45067", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/45067/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/45067/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/45067/events", "html_url": "https://github.com/rust-lang/rust/issues/45067", "id": 263487050, "node_id": "MDU6SXNzdWUyNjM0ODcwNTA=", "number": 45067, "title": "[Stable] ICE on Windows 7 when compiling dependencies", "user": {"login": "jjpe", "id": 1242003, "node_id": "MDQ6VXNlcjEyNDIwMDM=", "avatar_url": "https://avatars.githubusercontent.com/u/1242003?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jjpe", "html_url": "https://github.com/jjpe", "followers_url": "https://api.github.com/users/jjpe/followers", "following_url": "https://api.github.com/users/jjpe/following{/other_user}", "gists_url": "https://api.github.com/users/jjpe/gists{/gist_id}", "starred_url": "https://api.github.com/users/jjpe/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jjpe/subscriptions", "organizations_url": "https://api.github.com/users/jjpe/orgs", "repos_url": "https://api.github.com/users/jjpe/repos", "events_url": "https://api.github.com/users/jjpe/events{/privacy}", "received_events_url": "https://api.github.com/users/jjpe/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 123109, "node_id": "MDU6TGFiZWwxMjMxMDk=", "url": "https://api.github.com/repos/rust-lang/rust/labels/O-windows", "name": "O-windows", "color": "6e6ec0", "default": false, "description": "Operating system: Windows"}, {"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2017-10-06T15:35:09Z", "updated_at": "2019-08-19T19:44:25Z", "closed_at": null, "author_association": "NONE", "active_lock_reason": null, "body": "UPDATE 2:\r\nI just talked over this issue on [internals](https://internals.rust-lang.org/t/familiarity-with-rustc-code/6015/2) and it strongly looks like this ICE is triggered because the code was effectively on a network drive. I moved the project to an internal disk, and now it compiles fine.\r\nStill, I'd rather not close this issue just yet, as it would be nice to be able to compile from a network drive without ICE. This bug also seems related to [this one](https://github.com/rust-lang/rust/issues/40282#issuecomment-330097638), and is perhaps even a duplicate.\r\n\r\nUPDATE: I just tried this with stable `rustc 1.20.0 (f3d6973f4 2017-08-27) running on i686-pc-windows-msvc`, and get the same result as with nightly.\r\n\r\nI'm trying to compile a project for work on Windows 7 using `rustc 1.22.0-nightly (c6884b12d 2017-09-30)`, but compilation fails when trying to build the project's dependencies. \r\nInteresting to note is that the same `rustc` version on OS X has no issues with the same project.\r\n\r\nThe log output follows:\r\n\r\n````\r\nF:\\quip (master)\r\n\u03bb cargo run --bin sxi\r\nwarning: could not canonicalize path: 'F:\\quip'\r\nwarning: could not canonicalize path: 'F:\\quip'\r\nwarning: could not canonicalize path: 'F:\\'\r\n   Compiling kernel32-sys v0.2.2\r\nerror: internal compiler error: unexpected panic\r\n\r\nnote: the compiler unexpectedly panicked. this is a bug.\r\n\r\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports\r\n\r\nnote: rustc 1.22.0-nightly (c6884b12d 2017-09-30) running on i686-pc-windows-msvc\r\n\r\nnote: run with `RUST_BACKTRACE=1` for a backtrace\r\n\r\nthread 'rustc' panicked at 'called `Result::unwrap()` on an `Err` value: Error { repr: Os { code: 1, message: \"Incorrect function.\" } }', src\\libcore\\result.rs:906:4\r\nstack backtrace:\r\n   0: 0x62d9131d - std::panicking::Location::column::h9895b0760262a28a\r\n   1: 0x62d90fba - std::panicking::Location::column::h9895b0760262a28a\r\n   2: 0x62d91868 - std::panicking::rust_panic_with_hook::h8f20d66610e2b881\r\n   3: 0x62d916de - std::panicking::begin_panic_fmt::hb90e383f78c9754f\r\n   4: 0x62d91667 - std::panicking::begin_panic_fmt::hb90e383f78c9754f\r\n   5: 0x62d915b9 - rust_begin_unwind\r\n   6: 0x62da430a - core::panicking::panic_fmt::hf1b6bd69ee550bb9\r\n   7: 0x5c586a14 - rustc_metadata::cstore::CrateMetadata::needs_panic_runtime::h066b1941f56c69e2\r\n   8: 0x5c66682b - rustc_metadata::locator::Context::report_errs::he94b06f72750cbc6\r\n   9: 0x5c65b93f - rustc_metadata::creader::CrateLoader::new::h948973d8362524be\r\n  10: 0x5c657bef - rustc_metadata::creader::CrateLoader::new::h948973d8362524be\r\n  11: 0x5c660ca2 - <rustc_metadata::creader::CrateLoader<'a> as rustc::middle::cstore::CrateLoader>::process_item::h8732ec1d24fcb8e2\r\n  12: 0x5cb69b45 - rustc_resolve::build_reduced_graph::<impl rustc_resolve::ToNameBinding<'a> for (rustc::hir::def::Def, rustc::ty::Visibility, syntax_pos::span_encoding::Span, syntax_pos::hygiene::Mark)>::to_name_binding::hdcec3f8b36125949\r\n  13: 0x5cb70fa6 - <rustc_resolve::build_reduced_graph::BuildReducedGraphVisitor<'a, 'b> as syntax::visit::Visitor<'a>>::visit_item::hf1aa69c66ee40100\r\n  14: 0x5cb711cc - <rustc_resolve::build_reduced_graph::BuildReducedGraphVisitor<'a, 'b> as syntax::visit::Visitor<'a>>::visit_item::hf1aa69c66ee40100\r\n  15: 0x5cb61b8a - rustc_resolve::macros::<impl syntax::ext::base::Resolver for rustc_resolve::Resolver<'a>>::visit_expansion::h1eebd66536c4d25a\r\n  16: 0x62a49a30 - syntax::ext::expand::MacroExpander::expand_crate::h7773bd6ef2621edf\r\n  17: 0x62a3f949 - syntax::ext::expand::MacroExpander::expand_crate::h7773bd6ef2621edf\r\n  18: 0x62a3f3c7 - syntax::ext::expand::MacroExpander::expand_crate::h7773bd6ef2621edf\r\n  19: 0x63d4b353 - rustc_driver::driver::count_nodes::h39504b0a4a68bcf8\r\n  20: 0x63d468ef - rustc_driver::driver::count_nodes::h39504b0a4a68bcf8\r\n  21: 0x63d3e246 - rustc_driver::driver::compile_input::h9417596b5d9e2ea9\r\n  22: 0x63d5e975 - rustc_driver::run_compiler::hf870ea00b3ee6606\r\n  23: 0x63c756cb - <unknown>\r\n  24: 0x62d9899b - _rust_maybe_catch_panic\r\n  25: 0x63cae93f - <rustc_driver::derive_registrar::Finder as rustc::hir::itemlikevisit::ItemLikeVisitor<'v>>::visit_impl_item::h8a468c2ea6f8f76e\r\n  26: 0x62d8f67c - std::sys::imp::thread::Thread::new::h08d4b413205a3a97\r\n  27: 0x76923c44 - BaseThreadInitThunk\r\n  28: 0x76e037f4 - RtlInitializeExceptionChain\r\n\r\nerror: Could not compile `kernel32-sys`.\r\n\r\nTo learn more, run the command again with --verbose.\r\n\r\n````", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/45067/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/45067/timeline", "performed_via_github_app": null, "state_reason": null}