{"url": "https://api.github.com/repos/rust-lang/rust/issues/95143", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/95143/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/95143/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/95143/events", "html_url": "https://github.com/rust-lang/rust/issues/95143", "id": 1174601852, "node_id": "I_kwDOAAsO6M5GAwB8", "number": 95143, "title": "Unclear doc on iterator.by_ref()", "user": {"login": "Yuri6037", "id": 6407288, "node_id": "MDQ6VXNlcjY0MDcyODg=", "avatar_url": "https://avatars.githubusercontent.com/u/6407288?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Yuri6037", "html_url": "https://github.com/Yuri6037", "followers_url": "https://api.github.com/users/Yuri6037/followers", "following_url": "https://api.github.com/users/Yuri6037/following{/other_user}", "gists_url": "https://api.github.com/users/Yuri6037/gists{/gist_id}", "starred_url": "https://api.github.com/users/Yuri6037/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Yuri6037/subscriptions", "organizations_url": "https://api.github.com/users/Yuri6037/orgs", "repos_url": "https://api.github.com/users/Yuri6037/repos", "events_url": "https://api.github.com/users/Yuri6037/events{/privacy}", "received_events_url": "https://api.github.com/users/Yuri6037/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 431251592, "node_id": "MDU6TGFiZWw0MzEyNTE1OTI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-docs", "name": "A-docs", "color": "f7e101", "default": false, "description": "Area: documentation for any part of the project, including the compiler, standard library, and tools"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-03-20T16:18:22Z", "updated_at": "2022-03-27T11:31:41Z", "closed_at": null, "author_association": "NONE", "active_lock_reason": null, "body": "Today, I just got a huge problem internally in one of my crate. The bug is that the call to `iterator.by_ref` mutates/advances the iterator itself internally and that caused one of my software dependent on that carate to fail with an internal weird panic. \r\n\r\nOn the following documentation link: https://doc.rust-lang.org/stable/std/iter/trait.Iterator.html#method.by_ref the behavior of the function is not very clear.\r\n\r\nThe doc currently reads:\r\n\r\n```\r\nBorrows an iterator, rather than consuming it.\r\n\r\nThis is useful to allow applying iterator adapters while still retaining ownership of the original iterator.\r\n```\r\n\r\nFrom this text it's not clear that using this function still mutates/advances the internal iterator, so calling count for example is still gonna put the iterator to the end and will break all subsequent calls, essentially ending in weird cases where somehow the number of items is 1 but the later call to `last().unwrap()` panics!", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/95143/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/95143/timeline", "performed_via_github_app": null, "state_reason": null}