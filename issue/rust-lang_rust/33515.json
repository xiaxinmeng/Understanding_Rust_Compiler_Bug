{"url": "https://api.github.com/repos/rust-lang/rust/issues/33515", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/33515/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/33515/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/33515/events", "html_url": "https://github.com/rust-lang/rust/issues/33515", "id": 153809005, "node_id": "MDU6SXNzdWUxNTM4MDkwMDU=", "number": 33515, "title": "ICE: When using mismatching versions of the image and the glium_graphics crate", "user": {"login": "Moredread", "id": 100848, "node_id": "MDQ6VXNlcjEwMDg0OA==", "avatar_url": "https://avatars.githubusercontent.com/u/100848?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Moredread", "html_url": "https://github.com/Moredread", "followers_url": "https://api.github.com/users/Moredread/followers", "following_url": "https://api.github.com/users/Moredread/following{/other_user}", "gists_url": "https://api.github.com/users/Moredread/gists{/gist_id}", "starred_url": "https://api.github.com/users/Moredread/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Moredread/subscriptions", "organizations_url": "https://api.github.com/users/Moredread/orgs", "repos_url": "https://api.github.com/users/Moredread/repos", "events_url": "https://api.github.com/users/Moredread/events{/privacy}", "received_events_url": "https://api.github.com/users/Moredread/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2016-05-09T15:54:17Z", "updated_at": "2016-05-28T17:24:10Z", "closed_at": "2016-05-28T17:24:10Z", "author_association": "NONE", "active_lock_reason": null, "body": "When using mismatching versions of the image and the glium_graphics crate (i.e. glium_graphics depends on an older version of image than we do), the following code causes an ICE. The ICE goes away when using a matching version of image.\n\nWhile reducing the example, the len and index changed, but the difference of two stayed the same.\n\nAn example project can be found here: https://github.com/Moredread/rust-ice\n\nI tried this code:\n\n```\nextern crate image;\nextern crate glium_graphics;\n\nuse glium_graphics::{Glium2d, GliumGraphics, GliumWindow, GlyphCache, Texture, TextureSettings};\nuse image::{RgbImage, ConvertBuffer};\n\n\nfn run() {\n    let mut imgbuf = RgbImage::new(100, 100);\n    let texture = Texture::from_image(&mut glium_window,\n                                      &imgbuf.convert(),\n                                      &TextureSettings::new());\n}\n```\n\nThis causes an ICE:\n\n```\n   Compiling somethinggoingwrong v0.1.0 (file:///home/vagrant/rust-ice)\nsrc/main.rs:10:44: 10:56 error: unresolved name `glium_window` [E0425]\nsrc/main.rs:10     let texture = Texture::from_image(&mut glium_window,\n                                                          ^~~~~~~~~~~~\nsrc/main.rs:10:44: 10:56 help: run `rustc --explain E0425` to see a detailed explanation\nerror: main function not found\nsrc/main.rs:11:39: 11:56 error: mismatched types:\n expected `&image::buffer::ImageBuffer<image::color::Rgba<u8>, collections::vec::Vec<u8>>`,\n    found `&image::buffer::ImageBuffer<_, collections::vec::Vec<_>>`\n(expected struct `image::buffer::ImageBuffer`,\n    found a different struct `image::buffer::ImageBuffer`) [E0308]\nsrc/main.rs:11                                       &imgbuf.convert(),\n                                                     ^~~~~~~~~~~~~~~~~\nsrc/main.rs:11:39: 11:56 help: run `rustc --explain E0308` to see a detailed explanation\nsrc/main.rs:11:39: 11:56 note: Perhaps two different versions of crate `image` are being used?\nsrc/main.rs:11                                       &imgbuf.convert(),\n                                                     ^~~~~~~~~~~~~~~~~\nerror: internal compiler error: unexpected panic\nnote: the compiler unexpectedly panicked. this is a bug.\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports\nthread 'rustc' panicked at 'index out of bounds: the len is 38 but the index is 40', ../src/libcollections/vec.rs:1178\n```\n## Meta\n\n`rustc --version --verbose`:\n\n```\nrustc 1.8.0 (db2939409 2016-04-11)\nbinary: rustc\ncommit-hash: db2939409db26ab4904372c82492cd3488e4c44e\ncommit-date: 2016-04-11\nhost: x86_64-unknown-linux-gnu\nrelease: 1.8.0\n```\n\nBacktrace:\n\n```\nstack backtrace:\n   1:     0x7fa99d576330 - sys::backtrace::tracing::imp::write::h3675b4f0ca767761Xcv\n   2:     0x7fa99d57f68b - panicking::default_handler::_$u7b$$u7b$closure$u7d$$u7d$::closure.44519\n   3:     0x7fa99d57f1e3 - panicking::default_handler::h18faf4fbd296d909lSz\n   4:     0x7fa99d5439ac - sys_common::unwind::begin_unwind_inner::hfb5d07d6e405c6bbg1t\n   5:     0x7fa99d544448 - sys_common::unwind::begin_unwind_fmt::h8b491a76ae84af35m0t\n   6:     0x7fa99d573d91 - rust_begin_unwind\n   7:     0x7fa99d5c67af - panicking::panic_fmt::h98b8cbb286f5298alcM\n   8:     0x7fa99d5c6992 - panicking::panic_bounds_check::hdc4cd1d8a44957d1rbM\n   9:     0x7fa99a89f59f - middle::infer::InferCtxt<'a, 'tcx>::shallow_resolve::h52e879fe14a58134plE\n  10:     0x7fa99a96fb2b - middle::traits::fulfill::process_predicate::h5da25caa94a4806cjBU\n  11:     0x7fa99a96e857 - obligation_forest::ObligationForest<O, T>::process_obligations::h1104985789425175896\n  12:     0x7fa99a969edf - middle::traits::fulfill::FulfillmentContext<'tcx>::select_where_possible::h36a34bf1ee9d49d2otU\n  13:     0x7fa99cb02f01 - check::FnCtxt<'a, 'tcx>::select_obligations_where_possible::hbeb814e1d6536f19JAq\n  14:     0x7fa99cb299ac - check::check_argument_types::hd87e5db73000b681J0q\n  15:     0x7fa99cbc133f - check::callee::confirm_builtin_call::h7ffe0a70871d3f9fdbm\n  16:     0x7fa99cb3b1dd - check::callee::check_call::hf63606df5d983743m2l\n  17:     0x7fa99cb608f9 - check::check_expr_with_unifier::h5931808240608847095\n  18:     0x7fa99cb2f33b - check::check_expr_with_unifier::h8776005440523486996\n  19:     0x7fa99cb29dd8 - check::check_argument_types::hd87e5db73000b681J0q\n  20:     0x7fa99cbc133f - check::callee::confirm_builtin_call::h7ffe0a70871d3f9fdbm\n  21:     0x7fa99cb3b1dd - check::callee::check_call::hf63606df5d983743m2l\n  22:     0x7fa99cb52459 - check::check_expr_with_unifier::h1043101995598655204\n  23:     0x7fa99cb7851a - check::check_decl_initializer::h870f9bccbaeb3571AQs\n  24:     0x7fa99cb785c1 - check::check_decl_local::h75884e802bb28f42MRs\n  25:     0x7fa99cb788a4 - check::check_stmt::h9c1495c8bbfab5b3wTs\n  26:     0x7fa99cb09333 - check::check_block_with_expected::hc4a627a63732f3b0jXs\n  27:     0x7fa99cb002b9 - check::check_fn::h6fb1443d16d6d1a1hOo\n  28:     0x7fa99cafd9cf - check::check_bare_fn::h846d602fffbab51bLDo\n  29:     0x7fa99caf8876 - check::check_item_body::h1bc79a321f78eb96h3o\n  30:     0x7fa99caef32b - check::check_item_bodies::h5671f35c802ef7c1yBo\n  31:     0x7fa99cae6bb3 - check_crate::h7bb847abc9f256eeeCC\n  32:     0x7fa99daa2667 - driver::phase_3_run_analysis_passes::_$u7b$$u7b$closure$u7d$$u7d$::closure.28550\n  33:     0x7fa99daa0c04 - middle::ty::context::ctxt<'tcx>::create_and_enter::h16192426302205697189\n  34:     0x7fa99da9d6ef - driver::phase_3_run_analysis_passes::h10920926650053012691\n  35:     0x7fa99da70a15 - driver::compile_input::h7ae6a86e23de0774Hca\n  36:     0x7fa99da5fb47 - run_compiler::hb0408bcf47642fe6mPc\n  37:     0x7fa99da5d2c1 - sys_common::unwind::try::try_fn::h7614151098073783683\n  38:     0x7fa99d573d1b - __rust_try\n  39:     0x7fa99d56c1fd - sys_common::unwind::inner_try::hadd81c754a64f07ciYt\n  40:     0x7fa99da5db10 - boxed::F.FnBox<A>::call_box::h18261575856772421581\n  41:     0x7fa99d57dc59 - sys::thread::Thread::new::thread_start::h9bc812305b5e01feFPy\n  42:     0x7fa996847473 - start_thread\n  43:     0x7fa99d1f5acc - clone\n  44:                0x0 - <unknown>\n```\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/33515/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/33515/timeline", "performed_via_github_app": null, "state_reason": "completed"}