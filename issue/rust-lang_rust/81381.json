{"url": "https://api.github.com/repos/rust-lang/rust/issues/81381", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/81381/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/81381/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/81381/events", "html_url": "https://github.com/rust-lang/rust/issues/81381", "id": 793359515, "node_id": "MDU6SXNzdWU3OTMzNTk1MTU=", "number": 81381, "title": "Unresolved LLVM symbols when linking rustc_driver.", "user": {"login": "MarnixKuijs", "id": 44985093, "node_id": "MDQ6VXNlcjQ0OTg1MDkz", "avatar_url": "https://avatars.githubusercontent.com/u/44985093?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MarnixKuijs", "html_url": "https://github.com/MarnixKuijs", "followers_url": "https://api.github.com/users/MarnixKuijs/followers", "following_url": "https://api.github.com/users/MarnixKuijs/following{/other_user}", "gists_url": "https://api.github.com/users/MarnixKuijs/gists{/gist_id}", "starred_url": "https://api.github.com/users/MarnixKuijs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MarnixKuijs/subscriptions", "organizations_url": "https://api.github.com/users/MarnixKuijs/orgs", "repos_url": "https://api.github.com/users/MarnixKuijs/repos", "events_url": "https://api.github.com/users/MarnixKuijs/events{/privacy}", "received_events_url": "https://api.github.com/users/MarnixKuijs/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 266005765, "node_id": "MDU6TGFiZWwyNjYwMDU3NjU=", "url": "https://api.github.com/repos/rust-lang/rust/labels/O-windows-msvc", "name": "O-windows-msvc", "color": "6e6ec0", "default": false, "description": "Toolchain: MSVC, Operating system: Windows"}, {"id": 325438536, "node_id": "MDU6TGFiZWwzMjU0Mzg1MzY=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-bootstrap", "name": "T-bootstrap", "color": "bfd4f2", "default": false, "description": "Relevant to the bootstrap subteam: Rust's build system (x.py and src/bootstrap)"}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}, {"id": 1359848690, "node_id": "MDU6TGFiZWwxMzU5ODQ4Njkw", "url": "https://api.github.com/repos/rust-lang/rust/labels/E-needs-mcve", "name": "E-needs-mcve", "color": "02e10c", "default": false, "description": "Call for participation: This issue needs a Minimal Complete and Verifiable Example"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 14, "created_at": "2021-01-25T12:57:29Z", "updated_at": "2023-05-28T16:16:48Z", "closed_at": null, "author_association": "NONE", "active_lock_reason": null, "body": "The linking of `rustc_driver` will fail when using a custom llvm through the `llvm-config` setting in the `config.toml`.\r\n\r\n### Meta\r\n\r\n```\r\nBootstrap compiler: beta 2020-12-30\r\nCompiling master branch\r\nLLVM 10.0.0\r\nWindows 10 2004\r\n```\r\n\r\n<details><summary>Backtrace</summary>\r\n<p>\r\n\r\n```\r\nlibrustc_llvm-cb11b760f2056bc3.rlib(MachineBasicBlock.obj) : error LNK2019: unresolved external symbol __imp_rint referenced in function \"public: void __cdecl llvm::MachineBasicBlock::print(class llvm::raw_ostream &,class llvm::ModuleSlotTracker &,class llvm::SlotIndexes const *,bool)const \" (?print@MachineBasicBlock@llvm@@QEBAXAEAVraw_ostream@2@AEAVModuleSlotTracker@2@PEBVSlotIndexes@2@_N@Z)\r\nlibrustc_llvm-cb11b760f2056bc3.rlib(BranchProbability.obj) : error LNK2001: unresolved external symbol __imp_rint\r\nlibrustc_llvm-cb11b760f2056bc3.rlib(SimplifyLibCalls.obj) : error LNK2019: unresolved external symbol __imp_log2 referenced in function \"private: class llvm::Value * __cdecl llvm::LibCallSimplifier::replacePowWithExp(class llvm::CallInst *,class llvm::IRBuilder<class llvm::ConstantFolder,class llvm::IRBuilderDefaultInserter> &)\" (?replacePowWithExp@LibCallSimplifier@llvm@@AEAAPEAVValue@2@PEAVCallInst@2@AEAV?$IRBuilder@VConstantFolder@llvm@@VIRBuilderDefaultInserter@2@@2@@Z)\r\nlibrustc_llvm-cb11b760f2056bc3.rlib(ConstantFolding.obj) : error LNK2001: unresolved external symbol __imp_log2\r\nlibrustc_llvm-cb11b760f2056bc3.rlib(SimplifyLibCalls.obj) : error LNK2019: unresolved external symbol __imp_log2f referenced in function \"private: class llvm::Value * __cdecl llvm::LibCallSimplifier::replacePowWithExp(class llvm::CallInst *,class llvm::IRBuilder<class llvm::ConstantFolder,class llvm::IRBuilderDefaultInserter> &)\" (?replacePowWithExp@LibCallSimplifier@llvm@@AEAAPEAVValue@2@PEAVCallInst@2@AEAV?$IRBuilder@VConstantFolder@llvm@@VIRBuilderDefaultInserter@2@@2@@Z)\r\nlibrustc_llvm-cb11b760f2056bc3.rlib(ConstantFolding.obj) : error LNK2019: unresolved external symbol __imp_feclearexcept referenced in function \"class llvm::Constant * __cdecl `anonymous namespace'::ConstantFoldBinaryFP(double (__cdecl*)(double,double),double,double,class llvm::Type *)\" (?ConstantFoldBinaryFP@?A0x4678a5ee@@YAPEAVConstant@llvm@@P6ANNN@ZNNPEAVType@3@@Z)\r\nlibrustc_llvm-cb11b760f2056bc3.rlib(InstrProf.obj) : error LNK2019: unresolved external symbol __imp_strncpy referenced in function \"public: void __cdecl llvm::OverlapStats::dump(class llvm::raw_fd_ostream &)const \" (?dump@OverlapStats@llvm@@QEBAXAEAVraw_fd_ostream@2@@Z)\r\nlibrustc_llvm-cb11b760f2056bc3.rlib(WindowsResource.obj) : error LNK2001: unresolved external symbol __imp_strncpy\r\nlibrustc_llvm-cb11b760f2056bc3.rlib(XCOFFObjectWriter.obj) : error LNK2001: unresolved external symbol __imp_strncpy\r\nlibrustc_llvm-cb11b760f2056bc3.rlib(WinCOFFObjectWriter.obj) : error LNK2019: unresolved external symbol __imp__time64 referenced in function \"public: virtual unsigned __int64 __cdecl `anonymous namespace'::WinCOFFObjectWriter::writeObject(class llvm::MCAssembler &,class llvm::MCAsmLayout const &)\" (?writeObject@WinCOFFObjectWriter@?A0x86030a0a@@UEAA_KAEAVMCAssembler@llvm@@AEBVMCAsmLayout@4@@Z)\r\nlibrustc_llvm-cb11b760f2056bc3.rlib(Program.obj) : error LNK2019: unresolved external symbol __imp__setmode referenced in function \"class std::error_code __cdecl llvm::sys::ChangeStdinToBinary(void)\" (?ChangeStdinToBinary@sys@llvm@@YA?AVerror_code@std@@XZ)\r\nlibrustc_llvm-cb11b760f2056bc3.rlib(Process.obj) : error LNK2019: unresolved external symbol __imp__heapwalk referenced in function \"public: static unsigned __int64 __cdecl llvm::sys::Process::GetMallocUsage(void)\" (?GetMallocUsage@Process@sys@llvm@@SA_KXZ)\r\nlibrustc_llvm-cb11b760f2056bc3.rlib(Process.obj) : error LNK2019: unresolved external symbol __imp_close referenced in function \"public: static class std::error_code __cdecl llvm::sys::Process::SafelyCloseFileDescriptor(int)\" (?SafelyCloseFileDescriptor@Process@sys@llvm@@SA?AVerror_code@std@@H@Z)\r\nlibrustc_llvm-cb11b760f2056bc3.rlib(Path.obj) : error LNK2001: unresolved external symbol __imp_close\r\nOLDNAMES.lib(close.obi) : error LNK2001: unresolved external symbol __imp_close\r\nlibrustc_llvm-cb11b760f2056bc3.rlib(Path.obj) : error LNK2019: unresolved external symbol __imp__chsize_s referenced in function \"class std::error_code __cdecl llvm::sys::fs::resize_file(int,unsigned __int64)\" (?resize_file@fs@sys@llvm@@YA?AVerror_code@std@@H_K@Z)\r\nlibrustc_llvm-cb11b760f2056bc3.rlib(Path.obj) : error LNK2019: unresolved external symbol __imp_read referenced in function \"class std::error_code __cdecl llvm::sys::fs::copy_file_internal(int,int)\" (?copy_file_internal@fs@sys@llvm@@YA?AVerror_code@std@@HH@Z)\r\nOLDNAMES.lib(read.obi) : error LNK2001: unresolved external symbol __imp_read\r\nlibrustc_llvm-cb11b760f2056bc3.rlib(Path.obj) : error LNK2019: unresolved external symbol __imp_write referenced in function \"class std::error_code __cdecl llvm::sys::fs::copy_file_internal(int,int)\" (?copy_file_internal@fs@sys@llvm@@YA?AVerror_code@std@@HH@Z)\r\nlibrustc_llvm-cb11b760f2056bc3.rlib(raw_ostream.obj) : error LNK2001: unresolved external symbol __imp_write\r\nlibrustc_llvm-cb11b760f2056bc3.rlib(ErrorHandling.obj) : error LNK2001: unresolved external symbol __imp_write\r\nOLDNAMES.lib(write.obi) : error LNK2001: unresolved external symbol __imp_write\r\nlibrustc_llvm-cb11b760f2056bc3.rlib(Errno.obj) : error LNK2019: unresolved external symbol __imp_strerror_s referenced in function \"class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > __cdecl llvm::sys::StrError(int)\" (?StrError@sys@llvm@@YA?AV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@H@Z)\r\nlibrustc_llvm-cb11b760f2056bc3.rlib(raw_ostream.obj) : error LNK2019: unresolved external symbol __imp_lseek referenced in function \"public: __cdecl llvm::raw_fd_ostream::raw_fd_ostream(int,bool,bool)\" (??0raw_fd_ostream@llvm@@QEAA@H_N0@Z)\r\nOLDNAMES.lib(lseek.obi) : error LNK2001: unresolved external symbol __imp_lseek\r\nlibrustc_llvm-cb11b760f2056bc3.rlib(NativeFormatting.obj) : error LNK2019: unresolved external symbol __imp__fpclass referenced in function \"void __cdecl llvm::write_double(class llvm::raw_ostream &,double,enum llvm::FloatStyle,class llvm::Optional<unsigned __int64>)\" (?write_double@llvm@@YAXAEAVraw_ostream@1@NW4FloatStyle@1@V?$Optional@_K@1@@Z)\r\nlibrustc_llvm-cb11b760f2056bc3.rlib(JSON.obj) : error LNK2019: unresolved external symbol __imp_modf referenced in function \"public: class llvm::Optional<__int64> __cdecl llvm::json::Value::getAsInteger(void)const \" (?getAsInteger@Value@json@llvm@@QEBA?AV?$Optional@_J@3@XZ)\r\nlibrustc_llvm-cb11b760f2056bc3.rlib(Chrono.obj) : error LNK2019: unresolved external symbol __imp__localtime64_s referenced in function \"class llvm::raw_ostream & __cdecl llvm::operator<<(class llvm::raw_ostream &,class std::chrono::time_point<struct std::chrono::system_clock,class std::chrono::duration<__int64,struct std::ratio<1,1000000000> > >)\" (??6llvm@@YAAEAVraw_ostream@0@AEAV10@V?$time_point@Usystem_clock@chrono@std@@V?$duration@_JU?$ratio@$00$0DLJKMKAA@@std@@@23@@chrono@std@@@Z)\r\nrustc_driver-53307c04a46b25d9.dll : fatal error LNK1120: 17 unresolved externals\r\n```\r\n\r\n</p>\r\n</details>\r\n", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/81381/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/81381/timeline", "performed_via_github_app": null, "state_reason": null}