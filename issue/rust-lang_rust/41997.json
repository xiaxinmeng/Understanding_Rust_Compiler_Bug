{"url": "https://api.github.com/repos/rust-lang/rust/issues/41997", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/41997/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/41997/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/41997/events", "html_url": "https://github.com/rust-lang/rust/issues/41997", "id": 228565504, "node_id": "MDU6SXNzdWUyMjg1NjU1MDQ=", "number": 41997, "title": "Need help understanding `cargo test --jobs`", "user": {"login": "eminence", "id": 402454, "node_id": "MDQ6VXNlcjQwMjQ1NA==", "avatar_url": "https://avatars.githubusercontent.com/u/402454?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eminence", "html_url": "https://github.com/eminence", "followers_url": "https://api.github.com/users/eminence/followers", "following_url": "https://api.github.com/users/eminence/following{/other_user}", "gists_url": "https://api.github.com/users/eminence/gists{/gist_id}", "starred_url": "https://api.github.com/users/eminence/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eminence/subscriptions", "organizations_url": "https://api.github.com/users/eminence/orgs", "repos_url": "https://api.github.com/users/eminence/repos", "events_url": "https://api.github.com/users/eminence/events{/privacy}", "received_events_url": "https://api.github.com/users/eminence/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2017-05-14T19:54:23Z", "updated_at": "2017-05-14T20:42:15Z", "closed_at": "2017-05-14T20:42:15Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "When I run `cargo test --help`, I see this option:\r\n\r\n```\r\nOptions:\r\n    -j N, --jobs N               Number of parallel jobs, defaults to # of CPUs\r\n```\r\n\r\nAt first, it looks like this controls how many test cases run in parallel, but that doesn't seem to be the case.  Given 5 different tests of this form:\r\n\r\n```rust\r\n#[test]\r\nfn foo1() {\r\n    println!(\"Running foo1\");\r\n    sleep(Duration::from_secs(5));\r\n    println!(\"Done with foo1\");\r\n}\r\n```\r\n\r\nI would expect that running with `--jobs 1` would take about 25 seconds.  But all 5 tests actually are run in parallel:\r\n\r\n```\r\nachin@bigbox ~/tmp/16/foo $ time cargo test --jobs 1\r\n    Finished dev [unoptimized + debuginfo] target(s) in 0.0 secs\r\n     Running target/debug/deps/foo-0213a102e10dc10f\r\n\r\nrunning 1 test\r\ntest tests::it_works ... ok\r\n\r\ntest result: ok. 1 passed; 0 failed; 0 ignored; 0 measured\r\n\r\n     Running target/debug/deps/foo-865370f5d0ccd0fc\r\n\r\nrunning 5 tests\r\ntest foo3 ... ok\r\ntest foo1 ... ok\r\ntest foo5 ... ok\r\ntest foo2 ... ok\r\ntest foo4 ... ok\r\n                                                                                                                                                                                                                    test result: ok. 5 passed; 0 failed; 0 ignored; 0 measured\r\n\r\n   Doc-tests foo\r\n\r\nrunning 0 tests\r\n\r\ntest result: ok. 0 passed; 0 failed; 0 ignored; 0 measured\r\n\r\n\r\nreal    0m5.316s\r\nuser    0m0.155s\r\nsys     0m0.053s\r\n```\r\n\r\n\r\nCan you help me understand this?  What does `--jobs` actually do?  How can I get these 5 test cases to run serially? \r\n\r\nThanks!\r\n\r\n\r\n```\r\ncargo 0.20.0-nightly (cf17c9f71 2017-05-09)\r\nrelease: 0.20.0\r\ncommit-hash: cf17c9f7118f544ec304ed6f50d92b3759487123\r\ncommit-date: 2017-05-09\r\n```", "closed_by": {"login": "eminence", "id": 402454, "node_id": "MDQ6VXNlcjQwMjQ1NA==", "avatar_url": "https://avatars.githubusercontent.com/u/402454?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eminence", "html_url": "https://github.com/eminence", "followers_url": "https://api.github.com/users/eminence/followers", "following_url": "https://api.github.com/users/eminence/following{/other_user}", "gists_url": "https://api.github.com/users/eminence/gists{/gist_id}", "starred_url": "https://api.github.com/users/eminence/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eminence/subscriptions", "organizations_url": "https://api.github.com/users/eminence/orgs", "repos_url": "https://api.github.com/users/eminence/repos", "events_url": "https://api.github.com/users/eminence/events{/privacy}", "received_events_url": "https://api.github.com/users/eminence/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/41997/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/41997/timeline", "performed_via_github_app": null, "state_reason": "completed"}