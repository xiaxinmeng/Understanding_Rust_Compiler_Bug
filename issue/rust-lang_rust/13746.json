{"url": "https://api.github.com/repos/rust-lang/rust/issues/13746", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/13746/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/13746/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/13746/events", "html_url": "https://github.com/rust-lang/rust/issues/13746", "id": 32240461, "node_id": "MDU6SXNzdWUzMjI0MDQ2MQ==", "number": 13746, "title": "most of the run-make tests could be silently passing on cases that should fail", "user": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2014-04-25T15:13:44Z", "updated_at": "2014-05-18T23:16:32Z", "closed_at": "2014-05-18T23:16:32Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Makefiles unfortunately do not error on undefined variable references; they just silently expand into an empty string.  And an empty string is also not an invalid command in a recipe.\n\nSo, a recipe like this (observe highlighted line): [run-make/dylib-chain/Makefile](../blob/6d6ccb75ff2240ed294fcf6aa57e96c72316954c/src/test/run-make/dylib-chain/Makefile#L12)\n\ndoes not actually work because of this: [run-make/tools.mk](../blob/e26ba3605a7e6f9697c5e8878d60e466f93b7e2e/src/test/run-make/tools.mk#L8)\n\nbecause `$(call FAIL,main)` is going to expand into an empty string; what was wanted was `$(call FAILS,main)`\n\nAlthough it looks like most of the tests are using `$(call FAIL,xxx)`, so its probably simpler to just change `tools.mk` to use the name `FAIL` instead of `FAILS`:\n\n```\n% ack FAIL\nbootstrap-from-c-with-green/Makefile\n11: $(call FAIL,main)\n\nbootstrap-from-c-with-native/Makefile\n10: $(call FAIL,main)\n\nc-dynamic-dylib/Makefile\n13: $(call FAIL,bar)\n\nc-dynamic-rlib/Makefile\n13: $(call FAIL,bar)\n\nc-link-to-rust-dylib/Makefile\n9:  $(call FAIL,bar)\n\nc-static-dylib/Makefile\n10: $(call FAIL,bar)\n\ndylib-chain/Makefile\n12: $(call FAIL,m4)\n\nprefer-dylib/Makefile\n8:  $(call FAILS,foo)\n\ntools.mk\n13:FAILS = $(TARGET_RPATH_ENV) ( $(RUN_BINFILE) && exit 1 || exit 0 )\n\n```\n\n(The bigger question is whether attempting to implement this fix is going to actually expose latent bugs...)\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/13746/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/13746/timeline", "performed_via_github_app": null, "state_reason": "completed"}