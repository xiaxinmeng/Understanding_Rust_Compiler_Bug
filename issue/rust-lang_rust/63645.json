{"url": "https://api.github.com/repos/rust-lang/rust/issues/63645", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/63645/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/63645/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/63645/events", "html_url": "https://github.com/rust-lang/rust/issues/63645", "id": 481812278, "node_id": "MDU6SXNzdWU0ODE4MTIyNzg=", "number": 63645, "title": "missing symbol issue in some environments (rustdoc bug?)", "user": {"login": "jnqnfe", "id": 33935229, "node_id": "MDQ6VXNlcjMzOTM1MjI5", "avatar_url": "https://avatars.githubusercontent.com/u/33935229?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jnqnfe", "html_url": "https://github.com/jnqnfe", "followers_url": "https://api.github.com/users/jnqnfe/followers", "following_url": "https://api.github.com/users/jnqnfe/following{/other_user}", "gists_url": "https://api.github.com/users/jnqnfe/gists{/gist_id}", "starred_url": "https://api.github.com/users/jnqnfe/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jnqnfe/subscriptions", "organizations_url": "https://api.github.com/users/jnqnfe/orgs", "repos_url": "https://api.github.com/users/jnqnfe/repos", "events_url": "https://api.github.com/users/jnqnfe/events{/privacy}", "received_events_url": "https://api.github.com/users/jnqnfe/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 37547, "node_id": "MDU6TGFiZWwzNzU0Nw==", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-linkage", "name": "A-linkage", "color": "f7e101", "default": false, "description": "Area: linking into static, shared libraries and binaries"}, {"id": 123110, "node_id": "MDU6TGFiZWwxMjMxMTA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/O-linux", "name": "O-linux", "color": "6e6ec0", "default": false, "description": "Operating system: Linux"}, {"id": 203738, "node_id": "MDU6TGFiZWwyMDM3Mzg=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-rustdoc", "name": "T-rustdoc", "color": "bfd4f2", "default": false, "description": "Relevant to the rustdoc team, which will review and decide on the PR/issue."}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}, {"id": 1359848690, "node_id": "MDU6TGFiZWwxMzU5ODQ4Njkw", "url": "https://api.github.com/repos/rust-lang/rust/labels/E-needs-mcve", "name": "E-needs-mcve", "color": "02e10c", "default": false, "description": "Call for participation: This issue needs a Minimal Complete and Verifiable Example"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-08-16T22:50:58Z", "updated_at": "2023-04-24T11:14:43Z", "closed_at": null, "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I have encountered an issue whereby I get a missing symbol error, specifically in Ubuntu Xenial and Bionic Beaver environments on travis, but not Trusty. I believe it is either a rustdoc bug, or an issue with differences in system libs/utilities it uses.\r\n\r\nIt relates specifically only to a symbol guarded by a cargo feature flag.\r\n\r\nI have [a set of crates](https://github.com/jnqnfe/pulse-binding-rust) for binding to the PulseAudio (PA) system libraries.\r\n\r\nThe crates all have a set of features relating to system library version compatibility. The crates are compatible with PA versions 8-12. PA v12 added a single new function symbol, use of which is controlled via a cargo feature. PA did not add any new functions after v8 until v12.\r\n\r\nThis issue has suddenly cropped up since travis has shifted their default environment over from Trusty to Xenial...\r\n\r\nI want to cut through a lot of the mess that resulted in my arriving here, issues with trying to use workspaces+features which I now know are not supported and such, you can read discussion [here](https://travis-ci.community/t/failure-due-to-system-libs-now-being-older/4712) if you *really* want to, but for simplicity, please just ignore the mess of travis and workspace changes, and look past the fact that in the below tests we're enabling PA v12 features on PA v4/8/11 systems; the point here is investigating the wierdness of the missing symbol error I've noticed. (and apologies if already reported, there we 90 pages of 'symbol' related issues and i gave up trying to look for an existing report).\r\n\r\nThe short version of what is relevant is that I believe that parts of my library that are not directly used in a test get optimised out of the tests, hence no missing symbol linking errors when the system lib is too old a version; hence why tests passed successfully on Trusty which only had PA v4.x. However for some reason this one specific symbol does not get optimised out (i guess) resulting in a missing symbol error on Xenial/Bionic environments only. This is despite this symbol itself not being involved in any tests...\r\n\r\nCompare the following travis tests:\r\nTrusty (PA v4): https://travis-ci.org/jnqnfe/pulse-binding-rust/jobs/572936139\r\nXenial (PA v8): https://travis-ci.org/jnqnfe/pulse-binding-rust/jobs/572946063\r\nBionic (PA v11): https://travis-ci.org/jnqnfe/pulse-binding-rust/jobs/572936129\r\n\r\nThe only difference is the Ubuntu version selected in the travis config. Trusty passes, while the other two complain about the symbol. All three are using the same version of `rustc` and `cargo`...\r\n\r\nOnly `rustdoc` tests are involved in the failure, with the entire set either being 'ignored' or 'failed'. It passes on Trusty though.\r\n\r\nedit: typo fixes", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/63645/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/63645/timeline", "performed_via_github_app": null, "state_reason": null}