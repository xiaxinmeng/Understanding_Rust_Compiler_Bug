{"url": "https://api.github.com/repos/rust-lang/rust/issues/38926", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/38926/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/38926/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/38926/events", "html_url": "https://github.com/rust-lang/rust/issues/38926", "id": 199432467, "node_id": "MDU6SXNzdWUxOTk0MzI0Njc=", "number": 38926, "title": "ICE in astconv.rs:1516", "user": {"login": "martinlindhe", "id": 181531, "node_id": "MDQ6VXNlcjE4MTUzMQ==", "avatar_url": "https://avatars.githubusercontent.com/u/181531?v=4", "gravatar_id": "", "url": "https://api.github.com/users/martinlindhe", "html_url": "https://github.com/martinlindhe", "followers_url": "https://api.github.com/users/martinlindhe/followers", "following_url": "https://api.github.com/users/martinlindhe/following{/other_user}", "gists_url": "https://api.github.com/users/martinlindhe/gists{/gist_id}", "starred_url": "https://api.github.com/users/martinlindhe/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/martinlindhe/subscriptions", "organizations_url": "https://api.github.com/users/martinlindhe/orgs", "repos_url": "https://api.github.com/users/martinlindhe/repos", "events_url": "https://api.github.com/users/martinlindhe/events{/privacy}", "received_events_url": "https://api.github.com/users/martinlindhe/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2017-01-08T16:59:59Z", "updated_at": "2017-01-08T17:13:28Z", "closed_at": "2017-01-08T17:13:28Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "The code below caused an ICE\r\n\r\nOS: Windows 10 x64\r\nrustc 1.16.0-nightly (7e38a89a7 2017-01-06)\r\ncargo 0.17.0-nightly (40a4ce6 2017-01-06)\r\n\r\n```\r\nstruct Bird {\r\n    name: String,\r\n    health: i32,\r\n    hunger: i32,\r\n}\r\n\r\nimpl Bird {\r\n    fn new(name: &str) -> Bird {\r\n        Bird {\r\n            name: name.to_string(),\r\n            health: 100,\r\n            hunger: 0,\r\n        }\r\n    }\r\n}\r\n\r\nenum NPC {\r\n    Bird,\r\n}\r\n\r\nfn main() {\r\n\r\n    let mut spawns: Vec<NPC>;\r\n\r\n    let n1 = NPC::Bird::new(\"Crow\");\r\n    spawns.push(n1);\r\n}\r\n```\r\n\r\n```\r\n error: internal compiler error: C:\\bot\\slave\\nightly-dist-rustc-win-msvc-64\\build\\src\\librustc_typeck\\astconv.rs:1516: unexpected definition: Variant(DefId { krate: CrateNum(0), node: DefIndex(11) => rpg_test/7686b0f37e5974e97c31c655e966887\r\nf-exe::NPC[0]::Bird[0] })\r\n  --> src\\main.rs:25:14                                                                       \r\n   |                                                                       \r\n25 |     let n1 = NPC::Bird::new(\"Crow\");                                                                       \r\n   |              ^^^^^^^^^^^^^^                                                                       \r\n\r\nnote: the compiler unexpectedly panicked. this is a bug.\r\n\r\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports\r\nnote: run with `RUST_BACKTRACE=1` for a backtrace\r\n\r\nthread 'rustc' panicked at 'Box<Any>', C:\\bot\\slave\\nightly-dist-rustc-win-msvc-64\\build\\src\\librustc_errors\\lib.rs:382\r\n\r\nstack backtrace:\r\n   0:     0x7ffec0dffe00 - std::panicking::Location::line::h8c528bbdf4eef8a3\r\n   1:     0x7ffec0dff282 - std::panicking::Location::line::h8c528bbdf4eef8a3\r\n   2:     0x7ffec0e02ccd - std::panicking::rust_panic_with_hook::h7abc6e334345e341\r\n   3:     0x7ffeb09b8521 - <unknown>\r\n   4:     0x7ffeb09f6c59 - <unknown>\r\n   5:     0x7ffeb09f6a8c - <unknown>\r\n   6:     0x7ffeb0ada92d - <rustc_typeck::astconv::AstConv<'gcx, 'tcx> + 'o>::def_to_ty::hdd3051561636de79\r\n   7:     0x7ffeb0adc144 - <rustc_typeck::astconv::AstConv<'gcx, 'tcx> + 'o>::ast_ty_to_ty::h6d011fbb4fe3b62f\r\n   8:     0x7ffeb0ac10f7 - rustc_typeck::check::FnCtxt::resolve_ty_and_def_ufcs::hed2c4470b99f556c\r\n   9:     0x7ffeb0aad975 - rustc_typeck::check::FnCtxt::check_struct_path::h1c31b7459eec0140\r\n  10:     0x7ffeb0aac0b1 - rustc_typeck::check::FnCtxt::check_struct_path::h1c31b7459eec0140\r\n  11:     0x7ffeb0a6a10d - rustc_typeck::check::callee::<impl rustc_typeck::check::FnCtxt<'a, 'gcx, 'tcx>>::check_call::h6bba70eb240c5d33\r\n  12:     0x7ffeb0aad3f1 - rustc_typeck::check::FnCtxt::check_struct_path::h1c31b7459eec0140\r\n  13:     0x7ffeb0aac0b1 - rustc_typeck::check::FnCtxt::check_struct_path::h1c31b7459eec0140\r\n  14:     0x7ffeb0ac152f - rustc_typeck::check::FnCtxt::check_decl_initializer::he0752fd01b5a3086\r\n  15:     0x7ffeb0ac167b - rustc_typeck::check::FnCtxt::check_decl_local::he6b44866425edb5a\r\n  16:     0x7ffeb0ac19f1 - rustc_typeck::check::FnCtxt::check_stmt::ha511a4c602b59572\r\n  17:     0x7ffeb0ac1d7e - rustc_typeck::check::FnCtxt::check_block_no_value::h4f06b402deca3d6e\r\n  18:     0x7ffeb0aac57f - rustc_typeck::check::FnCtxt::check_struct_path::h1c31b7459eec0140\r\n  19:     0x7ffeb0aac0b1 - rustc_typeck::check::FnCtxt::check_struct_path::h1c31b7459eec0140\r\n  20:     0x7ffeb0a8bfd4 - <rustc_typeck::check::GatherLocalsVisitor<'a, 'gcx, 'tcx> as rustc::hir::intravisit::Visitor<'gcx>>::visit_pat::h3c24f4595d84aca5\r\n  21:     0x7ffeb0a8a92b - rustc_typeck::check::check_drop_impls::h2d877a5ed8a5c08b\r\n  22:     0x7ffeb0a8e581 - rustc_typeck::check::check_item_body::hec0a29f30cd03530\r\n  23:     0x7ffeb0a871e3 - rustc_typeck::check::check_item_bodies::h061a021a39e79099\r\n  24:     0x7ffeb0b14540 - rustc_typeck::check_crate::h018ed1843cf62dde\r\n  25:     0x7ffec25a81ce - rustc_driver::driver::count_nodes::h761a1dba824a4f1e\r\n  26:     0x7ffec24eacf4 - <unknown>\r\n  27:     0x7ffec2583b7c - rustc_driver::driver::compile_input::h44e43be0fc34a1a1\r\n  28:     0x7ffec25d58a7 - rustc_driver::run_compiler::h5e34a930c0929e5c\r\n  29:     0x7ffec24ae1ce - <unknown>\r\n  30:     0x7ffec0e05d11 - _rust_maybe_catch_panic\r\n  31:     0x7ffec24dc836 - <unknown>\r\n  32:     0x7ffec0dfd2fe - std::sys::imp::thread::Thread::new::h7a1b2b1b6bab390a\r\n  33:     0x7ffee3ea8363 - BaseThreadInitThunk\r\n```", "closed_by": {"login": "martinlindhe", "id": 181531, "node_id": "MDQ6VXNlcjE4MTUzMQ==", "avatar_url": "https://avatars.githubusercontent.com/u/181531?v=4", "gravatar_id": "", "url": "https://api.github.com/users/martinlindhe", "html_url": "https://github.com/martinlindhe", "followers_url": "https://api.github.com/users/martinlindhe/followers", "following_url": "https://api.github.com/users/martinlindhe/following{/other_user}", "gists_url": "https://api.github.com/users/martinlindhe/gists{/gist_id}", "starred_url": "https://api.github.com/users/martinlindhe/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/martinlindhe/subscriptions", "organizations_url": "https://api.github.com/users/martinlindhe/orgs", "repos_url": "https://api.github.com/users/martinlindhe/repos", "events_url": "https://api.github.com/users/martinlindhe/events{/privacy}", "received_events_url": "https://api.github.com/users/martinlindhe/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/38926/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/38926/timeline", "performed_via_github_app": null, "state_reason": "completed"}