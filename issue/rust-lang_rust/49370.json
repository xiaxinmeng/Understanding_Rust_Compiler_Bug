{"url": "https://api.github.com/repos/rust-lang/rust/issues/49370", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/49370/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/49370/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/49370/events", "html_url": "https://github.com/rust-lang/rust/issues/49370", "id": 308406671, "node_id": "MDU6SXNzdWUzMDg0MDY2NzE=", "number": 49370, "title": "Improve error message: No rules expected the token 'a'", "user": {"login": "sunjay", "id": 530939, "node_id": "MDQ6VXNlcjUzMDkzOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/530939?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sunjay", "html_url": "https://github.com/sunjay", "followers_url": "https://api.github.com/users/sunjay/followers", "following_url": "https://api.github.com/users/sunjay/following{/other_user}", "gists_url": "https://api.github.com/users/sunjay/gists{/gist_id}", "starred_url": "https://api.github.com/users/sunjay/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sunjay/subscriptions", "organizations_url": "https://api.github.com/users/sunjay/orgs", "repos_url": "https://api.github.com/users/sunjay/repos", "events_url": "https://api.github.com/users/sunjay/events{/privacy}", "received_events_url": "https://api.github.com/users/sunjay/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 234902, "node_id": "MDU6TGFiZWwyMzQ5MDI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-enhancement", "name": "C-enhancement", "color": "f5f1fd", "default": false, "description": "Category: An issue proposing an enhancement or a PR with one."}, {"id": 235791, "node_id": "MDU6TGFiZWwyMzU3OTE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-diagnostics", "name": "A-diagnostics", "color": "f7e101", "default": false, "description": "Area: Messages for errors, warnings, and lints"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-03-26T01:26:26Z", "updated_at": "2018-08-08T00:21:12Z", "closed_at": "2018-08-08T00:21:12Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Let's say you are a beginner to Rust and you forget a comma while using `println!`. (This could happen to anyone, but let's specifically imagine that you do not know the language and its features well.)\r\n\r\n```rust\r\nfn main() {\r\n    let a = 1;\r\n    println!(\"{}\" a);\r\n}\r\n```\r\n\r\nHere is the error you would get:\r\n```\r\nerror: no rules expected the token `a`\r\n --> src/main.rs:3:19\r\n  |\r\n3 |     println!(\"{}\" a);\r\n  |                   ^\r\n\r\nerror: aborting due to previous error\r\n\r\nerror: Could not compile `playground`.\r\n```\r\n\r\nSince you're a beginner, it is likely that macros are going to be one of the last features you touch. So \"no rules expected the token\" would not make any sense to you.\r\n\r\nNow let's look at what happens if you forget a comma in a regular function:\r\n\r\n```rust\r\nfn main() {\r\n    let a = 1;\r\n    foo(\"{}\" a);\r\n}\r\n\r\nfn foo(q: &str, x: i32) {\r\n}\r\n```\r\n\r\nHere is the error that you get:\r\n```\r\nerror: expected one of `,`, `.`, `?`, or an operator, found `a`\r\n --> src/main.rs:3:14\r\n  |\r\n3 |     foo(\"{}\" a);\r\n  |              ^ expected one of `,`, `.`, `?`, or an operator here\r\n\r\nerror: aborting due to previous error\r\n\r\nerror: Could not compile `playground`.\r\n\r\nTo learn more, run the command again with --verbose.\r\n```\r\n\r\nThis is much better because it makes it clear that we forgot one of the options presented and it is pretty obvious how to fix it.\r\n\r\nSince we know exactly which tokens a macro expects, wouldn't it be possible to generate a similar looking (or different but informative) message for macros too? I think this would really enhance the experience especially for beginners who may not understand \"no rules expected the token\" errors in macros.\r\n\r\nPlease pardon me if this is a duplicate. I reported this because when I encountered it, I was confused for a second. If I can get confused by this error message after 3 years of programming in Rust, a beginner is certainly likely to be stumped for much longer. It would be awesome if this could improve! :smile: ", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/49370/reactions", "total_count": 4, "+1": 4, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/49370/timeline", "performed_via_github_app": null, "state_reason": "completed"}