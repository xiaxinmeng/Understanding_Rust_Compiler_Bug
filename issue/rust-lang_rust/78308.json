{"url": "https://api.github.com/repos/rust-lang/rust/issues/78308", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/78308/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/78308/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/78308/events", "html_url": "https://github.com/rust-lang/rust/issues/78308", "id": 728535459, "node_id": "MDU6SXNzdWU3Mjg1MzU0NTk=", "number": 78308, "title": "Excessive memory usage building GTK Rust, a problem for entry level devices for newcomers (e.g. Raspberry Pi 3+)", "user": {"login": "ell1e", "id": 64124388, "node_id": "MDQ6VXNlcjY0MTI0Mzg4", "avatar_url": "https://avatars.githubusercontent.com/u/64124388?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ell1e", "html_url": "https://github.com/ell1e", "followers_url": "https://api.github.com/users/ell1e/followers", "following_url": "https://api.github.com/users/ell1e/following{/other_user}", "gists_url": "https://api.github.com/users/ell1e/gists{/gist_id}", "starred_url": "https://api.github.com/users/ell1e/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ell1e/subscriptions", "organizations_url": "https://api.github.com/users/ell1e/orgs", "repos_url": "https://api.github.com/users/ell1e/repos", "events_url": "https://api.github.com/users/ell1e/events{/privacy}", "received_events_url": "https://api.github.com/users/ell1e/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 234902, "node_id": "MDU6TGFiZWwyMzQ5MDI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-enhancement", "name": "C-enhancement", "color": "f5f1fd", "default": false, "description": "Category: An issue proposing an enhancement or a PR with one."}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 630799571, "node_id": "MDU6TGFiZWw2MzA3OTk1NzE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-compilemem", "name": "I-compilemem", "color": "e10c02", "default": false, "description": "Problems and improvements with respect to memory usage during compilation."}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 13, "created_at": "2020-10-23T21:31:53Z", "updated_at": "2020-11-29T09:39:18Z", "closed_at": null, "author_association": "NONE", "active_lock_reason": null, "body": "I tried to build this [Rust project, an on-screen keyboard](https://source.puri.sm/Librem5/squeekboard) directly [on-device on a PinePhone](https://www.pine64.org/pinephone/):\r\n\r\n```bash\r\n$ git clone https://source.puri.sm/Librem5/squeekboard\r\n$ cd squeekboard\r\n$ mkdir _build\r\n$ meson _build/\r\n$ cd _build\r\n$ ninja\r\n```\r\n*(install of some dependencies will likely be required before it runs through, it tells you which as you go)*\r\n\r\nI expected to see this happen: it works\r\n\r\nInstead, this happened: it runs out of memory once it builds GTK for Rust:\r\n\r\n![oom](https://user-images.githubusercontent.com/64124388/97055244-f0c91900-1575-11eb-8539-b7670b0f8717.png)\r\n\r\nThis device has 2GB in total in memory as you can see. Now before you point out that may not be the typical developer device, the Raspberry PI also commonly has around that range in memory and is a common entry level device for tinkerers and new want-to-be programmers that try out their first steps. Please also note that some people from less fortunate backgrounds *may not be able to afford a pricier device.* Also, mobile phones used on the run for quick tasks, which might involve rebuilding an app locally as I tried here, are increasingly becoming more common. For all programming languages other than Rust that I've ever tried, this is not an issue: compilation may take long, maybe hours even for larger projects, but at least for regular desktop level applications outside of giants like browsers, or entire compiler toolchains themselves, it usually works, even if only with lots of patience. For Rust however, this doesn't seem to be currently the case.\r\n\r\nI reported the issue to GTK for Rust which is the component that makes rustc run out of memory when compiled, where it was pointed out this is likely something that needs to be addressed in the compiler: https://github.com/gtk-rs/gtk/issues/1074\r\n\r\nSince this seems like a potentially major accessibility barrier for newcomers and people stuck with less powerful devices to get into the Rust world, I suggest that this situation should be improved.\r\n\r\n**Please note I am not objecting to this memory usage in environments where it is available, if that speeds up compilation (for caching etc).** However, it shouldn't be a required amount to be able to build any basic graphical GTK application *at all*.\r\n\r\n### Meta\r\n`rustc --version --verbose`:\r\n```\r\n$ rustc --version --verbose\r\nrustc 1.44.0\r\nbinary: rustc\r\ncommit-hash: unknown\r\ncommit-date: unknown\r\nhost: aarch64-alpine-linux-musl\r\nrelease: 1.44.0\r\nLLVM version: 10.0\r\n```\r\n(this is the compiler directly on the 2GB device, a PinePhone.)\r\n", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/78308/reactions", "total_count": 6, "+1": 6, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/78308/timeline", "performed_via_github_app": null, "state_reason": null}