{"url": "https://api.github.com/repos/rust-lang/rust/issues/12456", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/12456/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/12456/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/12456/events", "html_url": "https://github.com/rust-lang/rust/issues/12456", "id": 28082614, "node_id": "MDU6SXNzdWUyODA4MjYxNA==", "number": 12456, "title": "Remove vector methods that enforce uneccessary allocations or copies", "user": {"login": "Kimundi", "id": 2903206, "node_id": "MDQ6VXNlcjI5MDMyMDY=", "avatar_url": "https://avatars.githubusercontent.com/u/2903206?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Kimundi", "html_url": "https://github.com/Kimundi", "followers_url": "https://api.github.com/users/Kimundi/followers", "following_url": "https://api.github.com/users/Kimundi/following{/other_user}", "gists_url": "https://api.github.com/users/Kimundi/gists{/gist_id}", "starred_url": "https://api.github.com/users/Kimundi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Kimundi/subscriptions", "organizations_url": "https://api.github.com/users/Kimundi/orgs", "repos_url": "https://api.github.com/users/Kimundi/repos", "events_url": "https://api.github.com/users/Kimundi/events{/privacy}", "received_events_url": "https://api.github.com/users/Kimundi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 113376, "node_id": "MDU6TGFiZWwxMTMzNzY=", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-slow", "name": "I-slow", "color": "e10c02", "default": false, "description": "Problems and improvements with respect to performance of generated code."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2014-02-21T23:57:20Z", "updated_at": "2014-09-29T04:05:26Z", "closed_at": "2014-09-29T04:05:26Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "`~[T]` has a few legacy methods that enforce unnecessary copies or allocations:\n- `map<T, U>(&[T], f: |&T| -> U) -> ~[U]`: requires the user to copy/clone through the &T references, and always allocates a new `~[U]`.\n- `flat_map<T, U>(&[T], f: |&T| -> ~[U]) -> ~[U]`: same as `map`, but also requires allocation of temporary `~[U]` vectors.\n- `push_all_move(&mut ~[T], ~[T])`: Requires a temporary `~[T]` vector just to move all values in at once.\n\nToday, all these functions can be more generally and precisely expressed with iterators:\n- `vec.map(...) => vec.iter().map(...).collect()`, with the options of calling `move_iter()` instead, and the ability to collect into a arbitrary other type.\n- `vec.flat_map(...) => vec.iter().flat_map(...).collect()`, same as above, but depending on iterator used internally no need for allocations and temporary vectors.\n- `vec.push_all_move(v) => vec.extend(&mut v.move_iter())`, instead of passing a owned vector, passing a iterator instead that produces the values.\n\nSo, I'm proposing that these functions get removed and replaced with the alternatives above. The only problem is that its getting more verbose, but there are a few ways how that can get reduced: `Iterable` trait, shorten of names like `move_iter`, etc.\n\n(Everything said here also applies to `Vec<T>` due the currently in-progress transition to it.)\n", "closed_by": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/12456/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/12456/timeline", "performed_via_github_app": null, "state_reason": "completed"}