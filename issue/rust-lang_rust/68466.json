{"url": "https://api.github.com/repos/rust-lang/rust/issues/68466", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/68466/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/68466/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/68466/events", "html_url": "https://github.com/rust-lang/rust/issues/68466", "id": 553743547, "node_id": "MDU6SXNzdWU1NTM3NDM1NDc=", "number": 68466, "title": "Async/await error does not have line information", "user": {"login": "swilcox3", "id": 22034608, "node_id": "MDQ6VXNlcjIyMDM0NjA4", "avatar_url": "https://avatars.githubusercontent.com/u/22034608?v=4", "gravatar_id": "", "url": "https://api.github.com/users/swilcox3", "html_url": "https://github.com/swilcox3", "followers_url": "https://api.github.com/users/swilcox3/followers", "following_url": "https://api.github.com/users/swilcox3/following{/other_user}", "gists_url": "https://api.github.com/users/swilcox3/gists{/gist_id}", "starred_url": "https://api.github.com/users/swilcox3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/swilcox3/subscriptions", "organizations_url": "https://api.github.com/users/swilcox3/orgs", "repos_url": "https://api.github.com/users/swilcox3/repos", "events_url": "https://api.github.com/users/swilcox3/events{/privacy}", "received_events_url": "https://api.github.com/users/swilcox3/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-01-22T19:23:48Z", "updated_at": "2020-01-22T19:25:14Z", "closed_at": "2020-01-22T19:25:14Z", "author_association": "NONE", "active_lock_reason": null, "body": "I was porting over my actix-web server to 2.0.0 and async-await and ran into this error while rewriting a test.\r\n\r\nThe code:\r\n```\r\n#[actix_rt::test]\r\nasync fn test_get_all_files() {\r\n    let test_db = test_setup(\"test_get_all_files\", \"test_files\", \"\");\r\n    let mut app = test::init_service(\r\n        App::new()\r\n            .data(ServerGlobals::new_test(&test_db.db))\r\n            .service(web::resource(\"/get-all-files\").to(get_files_and_folders)),\r\n    )\r\n    .await;\r\n    let resp = call_request!(app, \"/get-all-files\");\r\n    assert_eq!(resp.status(), http::StatusCode::OK);\r\n    let body = test::read_body(resp);\r\n    let paths: Vec<ps_database::DirEntry> = serde_json::from_slice(&body).unwrap();\r\n\r\n    let mut answers = std::collections::HashSet::new();\r\n    answers.insert(PathBuf::from(\"test_files/\"));\r\n    answers.insert(PathBuf::from(\"test_files/write_file\"));\r\n    answers.insert(PathBuf::from(\"test_files/test_original.vwxp\"));\r\n    answers.insert(PathBuf::from(\"test_files/write_file/test_write_file.vwxp\"));\r\n    for dir in paths {\r\n        dir.iterate_paths(&mut |path| {\r\n            assert!(path.is_dir() || path.extension().unwrap() == \"vwxp\");\r\n            answers.remove(path);\r\n        });\r\n    }\r\n    assert_eq!(answers.len(), 0);\r\n}\r\n```\r\nI received this error message:\r\n```\r\nerror[E0308]: mismatched types\r\n  |\r\n  = note: expected type `&[u8]`\r\n             found type `&impl futures::Future`\r\n\r\nerror: aborting due to previous error\r\n\r\nFor more information about this error, try `rustc --explain E0308`.\r\n```\r\nThis bug is not about the error itself, I figured out what the error is.  `test::read_body(resp)` needs a `.await` after it.  The issue is that the error had no line information included, so I had to go commenting out sections of code to find out which test had the error.  My VSCode showed the red squiggly on the very first character of my main.rs.  \r\n\r\n", "closed_by": {"login": "jonas-schievink", "id": 1786438, "node_id": "MDQ6VXNlcjE3ODY0Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/1786438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jonas-schievink", "html_url": "https://github.com/jonas-schievink", "followers_url": "https://api.github.com/users/jonas-schievink/followers", "following_url": "https://api.github.com/users/jonas-schievink/following{/other_user}", "gists_url": "https://api.github.com/users/jonas-schievink/gists{/gist_id}", "starred_url": "https://api.github.com/users/jonas-schievink/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jonas-schievink/subscriptions", "organizations_url": "https://api.github.com/users/jonas-schievink/orgs", "repos_url": "https://api.github.com/users/jonas-schievink/repos", "events_url": "https://api.github.com/users/jonas-schievink/events{/privacy}", "received_events_url": "https://api.github.com/users/jonas-schievink/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/68466/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/68466/timeline", "performed_via_github_app": null, "state_reason": "completed"}