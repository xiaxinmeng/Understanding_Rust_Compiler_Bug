{"url": "https://api.github.com/repos/rust-lang/rust/issues/97966", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/97966/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/97966/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/97966/events", "html_url": "https://github.com/rust-lang/rust/issues/97966", "id": 1267962542, "node_id": "I_kwDOAAsO6M5Lk5Ku", "number": 97966, "title": "Rustdoc: When using #![doc = include_str!(\"../BUGGY.md\")], conversion of MD to html can fail for first line of the includerd", "user": {"login": "DanielJoyce", "id": 947350, "node_id": "MDQ6VXNlcjk0NzM1MA==", "avatar_url": "https://avatars.githubusercontent.com/u/947350?v=4", "gravatar_id": "", "url": "https://api.github.com/users/DanielJoyce", "html_url": "https://github.com/DanielJoyce", "followers_url": "https://api.github.com/users/DanielJoyce/followers", "following_url": "https://api.github.com/users/DanielJoyce/following{/other_user}", "gists_url": "https://api.github.com/users/DanielJoyce/gists{/gist_id}", "starred_url": "https://api.github.com/users/DanielJoyce/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/DanielJoyce/subscriptions", "organizations_url": "https://api.github.com/users/DanielJoyce/orgs", "repos_url": "https://api.github.com/users/DanielJoyce/repos", "events_url": "https://api.github.com/users/DanielJoyce/events{/privacy}", "received_events_url": "https://api.github.com/users/DanielJoyce/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 203738, "node_id": "MDU6TGFiZWwyMDM3Mzg=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-rustdoc", "name": "T-rustdoc", "color": "bfd4f2", "default": false, "description": "Relevant to the rustdoc team, which will review and decide on the PR/issue."}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-06-10T20:09:39Z", "updated_at": "2022-08-11T16:19:19Z", "closed_at": "2022-06-17T13:09:59Z", "author_association": "NONE", "active_lock_reason": null, "body": "BUGGYmd:\r\n```markdown\r\n# BUGGY: This heading might not be turned into a H1 tag\r\n\r\n* Any subsequent Markdown will be fine though \r\n```\r\n\r\nWORKS.md:\r\n```markdown\r\n<!--- Need this and the next new line to work around the bug -->\r\n\r\n# WORKS: This heading will be turned into a H1 tag\r\n```\r\n\r\nsrc/main.rs:\r\n``` rust\r\n//! Here we include a external md file.\r\n\r\n//! Its useful to include collapsible sections for chunks of documentation.\r\n//!\r\n//! The first line of this one is not processed\r\n//! <details>\r\n//! <summary> broken </summary>\r\n#![doc = include_str!(\"../BUGGY.md\")]\r\n//! </details>\r\n//!\r\n//! It works if there is a space before the include\r\n//! <details>\r\n//! <summary> fixed buggy</summary>\r\n//!\r\n#![doc = include_str!(\"../BUGGY.md\")]\r\n//! </details>\r\n//!\r\n//! This one works due the comment in the MD document\r\n//! <details>\r\n//! <summary> works </summary>\r\n#![doc = include_str!(\"../WORKS.md\")]\r\n//! </details> <!--- Fails if no space after explicit html tag -->\r\n#![doc = include_str!(\"../BUGGY.md\")]\r\n//! Works since this line contains no HTML tags\r\n#![doc = include_str!(\"../BUGGY.md\")]\r\n\r\n//!Go check out the docs on main\r\n\r\n/// click me!\r\n#[doc = include_str!(\"../BUGGY.md\")]\r\n/// <p>But not here </p>\r\n#[doc = include_str!(\"../BUGGY.md\")]\r\n///\r\n/// But works again since this isn't a html tag\r\n#[doc = include_str!(\"../BUGGY.md\")]\r\nfn main() {\r\n    println!(\"Hello, world!\");\r\n}\r\n\r\n```\r\n\r\nIts seems Markdown expansion of the first line of an included file will fail if the previous comment line in the including rust source included a html tag\r\n\r\nIncluding an empty comment line fixes it, but some rust format or editor settings will remove the ones right before an include\r\n\r\n\r\nPlease see the attached sample project\r\n\r\n[rustdoc-bug.zip](https://github.com/rust-lang/rust/files/8881970/rustdoc-bug.zip)\r\n\r\n\r\n", "closed_by": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/97966/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/97966/timeline", "performed_via_github_app": null, "state_reason": "completed"}