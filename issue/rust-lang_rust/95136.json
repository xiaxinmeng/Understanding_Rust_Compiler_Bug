{"url": "https://api.github.com/repos/rust-lang/rust/issues/95136", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/95136/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/95136/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/95136/events", "html_url": "https://github.com/rust-lang/rust/issues/95136", "id": 1174560144, "node_id": "I_kwDOAAsO6M5GAl2Q", "number": 95136, "title": "Using `cargo run` with bootstrap uses the host rustfmt, not nightly rustfmt", "user": {"login": "jyn514", "id": 23638587, "node_id": "MDQ6VXNlcjIzNjM4NTg3", "avatar_url": "https://avatars.githubusercontent.com/u/23638587?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jyn514", "html_url": "https://github.com/jyn514", "followers_url": "https://api.github.com/users/jyn514/followers", "following_url": "https://api.github.com/users/jyn514/following{/other_user}", "gists_url": "https://api.github.com/users/jyn514/gists{/gist_id}", "starred_url": "https://api.github.com/users/jyn514/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jyn514/subscriptions", "organizations_url": "https://api.github.com/users/jyn514/orgs", "repos_url": "https://api.github.com/users/jyn514/repos", "events_url": "https://api.github.com/users/jyn514/events{/privacy}", "received_events_url": "https://api.github.com/users/jyn514/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 234902, "node_id": "MDU6TGFiZWwyMzQ5MDI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-enhancement", "name": "C-enhancement", "color": "f5f1fd", "default": false, "description": "Category: An issue proposing an enhancement or a PR with one."}, {"id": 325438536, "node_id": "MDU6TGFiZWwzMjU0Mzg1MzY=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-bootstrap", "name": "T-bootstrap", "color": "bfd4f2", "default": false, "description": "Relevant to the bootstrap subteam: Rust's build system (x.py and src/bootstrap)"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2022-03-20T14:06:21Z", "updated_at": "2022-06-08T20:26:32Z", "closed_at": "2022-06-08T20:26:32Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "https://github.com/rust-lang/rust/blob/c7ce69faf2a7ea16c15d922985ca27ba70da30ee/src/bootstrap/config.rs#L1095-L1106\r\n\r\nThe proper fix is to check if we're going through the `cargo run` entrypoint instead of x.py, and if so, download rustfmt from the nightly toolchain listed in `src/stage0.json`: https://github.com/rust-lang/rust/blob/c7ce69faf2a7ea16c15d922985ca27ba70da30ee/src/stage0.json#L8-L11\r\n\r\nIdeally we would eventually be able to move this into rustup, but that requires not only for rustup to add and release this feature, but also for all contributors to start using it. It shouldn't be too much extra work for bootstrap to do it itself in the meantime.\r\n\r\ncc https://github.com/rust-lang/rust/issues/94829, https://github.com/rust-lang/rust/pull/94806#issuecomment-1073257368, https://github.com/rust-lang/rust/pull/94830#issuecomment-1066807203", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/95136/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/95136/timeline", "performed_via_github_app": null, "state_reason": "completed"}