{"url": "https://api.github.com/repos/rust-lang/cargo/issues/9564", "repository_url": "https://api.github.com/repos/rust-lang/cargo", "labels_url": "https://api.github.com/repos/rust-lang/cargo/issues/9564/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/cargo/issues/9564/comments", "events_url": "https://api.github.com/repos/rust-lang/cargo/issues/9564/events", "html_url": "https://github.com/rust-lang/cargo/issues/9564", "id": 916711260, "node_id": "MDU6SXNzdWU5MTY3MTEyNjA=", "number": 9564, "title": "rustdoc clashing output name hard error build failure regression", "user": {"login": "ijackson", "id": 2090772, "node_id": "MDQ6VXNlcjIwOTA3NzI=", "avatar_url": "https://avatars.githubusercontent.com/u/2090772?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ijackson", "html_url": "https://github.com/ijackson", "followers_url": "https://api.github.com/users/ijackson/followers", "following_url": "https://api.github.com/users/ijackson/following{/other_user}", "gists_url": "https://api.github.com/users/ijackson/gists{/gist_id}", "starred_url": "https://api.github.com/users/ijackson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ijackson/subscriptions", "organizations_url": "https://api.github.com/users/ijackson/orgs", "repos_url": "https://api.github.com/users/ijackson/repos", "events_url": "https://api.github.com/users/ijackson/events{/privacy}", "received_events_url": "https://api.github.com/users/ijackson/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 166015471, "node_id": "MDU6TGFiZWwxNjYwMTU0NzE=", "url": "https://api.github.com/repos/rust-lang/cargo/labels/Command-doc", "name": "Command-doc", "color": "5319e7", "default": false, "description": null}, {"id": 1760867354, "node_id": "MDU6TGFiZWwxNzYwODY3MzU0", "url": "https://api.github.com/repos/rust-lang/cargo/labels/A-layout", "name": "A-layout", "color": "fbca04", "default": false, "description": "Area: target output directory layout, naming, and organization"}], "state": "closed", "locked": false, "assignee": {"login": "ehuss", "id": 43198, "node_id": "MDQ6VXNlcjQzMTk4", "avatar_url": "https://avatars.githubusercontent.com/u/43198?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ehuss", "html_url": "https://github.com/ehuss", "followers_url": "https://api.github.com/users/ehuss/followers", "following_url": "https://api.github.com/users/ehuss/following{/other_user}", "gists_url": "https://api.github.com/users/ehuss/gists{/gist_id}", "starred_url": "https://api.github.com/users/ehuss/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ehuss/subscriptions", "organizations_url": "https://api.github.com/users/ehuss/orgs", "repos_url": "https://api.github.com/users/ehuss/repos", "events_url": "https://api.github.com/users/ehuss/events{/privacy}", "received_events_url": "https://api.github.com/users/ehuss/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ehuss", "id": 43198, "node_id": "MDQ6VXNlcjQzMTk4", "avatar_url": "https://avatars.githubusercontent.com/u/43198?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ehuss", "html_url": "https://github.com/ehuss", "followers_url": "https://api.github.com/users/ehuss/followers", "following_url": "https://api.github.com/users/ehuss/following{/other_user}", "gists_url": "https://api.github.com/users/ehuss/gists{/gist_id}", "starred_url": "https://api.github.com/users/ehuss/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ehuss/subscriptions", "organizations_url": "https://api.github.com/users/ehuss/orgs", "repos_url": "https://api.github.com/users/ehuss/repos", "events_url": "https://api.github.com/users/ehuss/events{/privacy}", "received_events_url": "https://api.github.com/users/ehuss/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2021-06-09T17:46:35Z", "updated_at": "2021-06-18T03:38:10Z", "closed_at": "2021-06-18T03:38:10Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!--\r\nThank you for filing a bug report! \ud83d\udc1b Please provide a short summary of the bug,\r\nalong with any information you feel relevant to replicating the bug.\r\n-->\r\n\r\nI have several crates in my project.  In particular, I have a library crate `otter` and a binary crate `otter-cli` which generates a binary called `otter`.\r\n\r\n```\r\n# ./Cargo.toml\r\n[package]\r\nname=\"otter\"\r\n[workspace]\r\nmembers=[\"cli\", \"wasm\", \"daemon\", \"wdriver\", \"apitest\"]\r\n# library crate\r\n```\r\nand\r\n```\r\n# cli/Cargo.toml\r\n[package]\r\nname=\"otter-cli\"\r\n[dependencies]\r\notter.path=\"..\"\r\n[[bin]]\r\nname=\"otter\"\r\npath=\"otter.rs\"\r\n```\r\n\r\nI recently updated my rust frrom an old nightly to a recent one.\r\n\r\nNow I get this error message:\r\n```\r\nerror: document output filename collision\r\nThe bin `otter` in package `otter-cli v0.7.1 (/home/ian/Rustup/Game/server/cli)` has the same name as the lib `otter` in package `otter v0.7.1 (/home/ian/Rustup/Game/server)`.\r\n```\r\n\r\nIt suggests using `doc = false`.  I thought I could do that for the cli crate since the rustdocs for a command line program are generally not very useful.  But if I do that none of the dependencies specific to the `otter-cli` crate get documented by `cargo doc --workspace`.\r\n\r\nThe correct fix would be to rename the rustdoc output file.  But I don't think there is a way to do that.  I don't think I can change the crate name for the cli to be different to the binary name.  I don't want to change the main `otter` crate's idea of its own crate name.\r\n\r\nI think it was unfortunate to make this a hard error before there was a better workaround.\r\n\r\n<!--\r\nIf you're using the stable version of the compiler, you should also check if the\r\nbug also exists in the beta or nightly versions.\r\n-->\r\n\r\n`rustc --version --verbose`:\r\n```rustc 1.54.0-nightly (e4a603270 2021-06-07)\r\nbinary: rustc\r\ncommit-hash: e4a60327063e82413eed50a10df3b7d19b77bda0\r\ncommit-date: 2021-06-07\r\nhost: x86_64-unknown-linux-gnu\r\nrelease: 1.54.0-nightly\r\nLLVM version: 12.0.1\r\n```\r\n\r\nISTM that this would be a regression from stable to stable for some projects.  (Not mine because unfortunately I'm not able to build on stable at all right now.)\r\n\r\nI think it might bite anyone who has a separate binary cli crate which generates a binary whose name is the same as their library crate.  That doesn't seem to me to be a wholly unreasonable situation.", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/cargo/issues/9564/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/cargo/issues/9564/timeline", "performed_via_github_app": null, "state_reason": "completed"}