{"url": "https://api.github.com/repos/rust-lang/rust/issues/80516", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/80516/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/80516/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/80516/events", "html_url": "https://github.com/rust-lang/rust/issues/80516", "id": 776527501, "node_id": "MDU6SXNzdWU3NzY1Mjc1MDE=", "number": 80516, "title": "ICE after WSL crash", "user": {"login": "panstromek", "id": 25121817, "node_id": "MDQ6VXNlcjI1MTIxODE3", "avatar_url": "https://avatars.githubusercontent.com/u/25121817?v=4", "gravatar_id": "", "url": "https://api.github.com/users/panstromek", "html_url": "https://github.com/panstromek", "followers_url": "https://api.github.com/users/panstromek/followers", "following_url": "https://api.github.com/users/panstromek/following{/other_user}", "gists_url": "https://api.github.com/users/panstromek/gists{/gist_id}", "starred_url": "https://api.github.com/users/panstromek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/panstromek/subscriptions", "organizations_url": "https://api.github.com/users/panstromek/orgs", "repos_url": "https://api.github.com/users/panstromek/repos", "events_url": "https://api.github.com/users/panstromek/events{/privacy}", "received_events_url": "https://api.github.com/users/panstromek/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}, {"id": 1359848690, "node_id": "MDU6TGFiZWwxMzU5ODQ4Njkw", "url": "https://api.github.com/repos/rust-lang/rust/labels/E-needs-mcve", "name": "E-needs-mcve", "color": "02e10c", "default": false, "description": "Call for participation: This issue needs a Minimal Complete and Verifiable Example"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2020-12-30T16:07:39Z", "updated_at": "2021-09-09T07:49:49Z", "closed_at": null, "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Whole WSL crashed during `cargo test` and me doing something in the IDE at the same time. The build folder probably got corrupted somehow, which is understandable in this situation. \r\n\r\nI don't really know if this is actionable or even meaningful to fix, but I reported it anyway, just in case.\r\n\r\n<!--\r\nThank you for finding an Internal Compiler Error! \ud83e\uddca  If possible, try to provide\r\na minimal verifiable example. You can read \"Rust Bug Minimization Patterns\" for\r\nhow to create smaller examples.\r\n\r\nhttp://blog.pnkfx.org/blog/2019/11/18/rust-bug-minimization-patterns/\r\n\r\n-->\r\n\r\n### Code\r\n\r\n```Rust\r\n\r\n```\r\n\r\n\r\n### Meta\r\n<!--\r\nIf you're using the stable version of the compiler, you should also check if the\r\nbug also exists in the beta or nightly versions.\r\n-->\r\n\r\n`rustc --version --verbose`:\r\n```\r\nrustc 1.47.0-nightly (2d8a3b918 2020-08-26)\r\nbinary: rustc\r\ncommit-hash: 2d8a3b9181f41d3af9b9f016c5d73b2553e344bf\r\ncommit-date: 2020-08-26\r\nhost: x86_64-unknown-linux-gnu\r\nrelease: 1.47.0-nightly\r\nLLVM version: 11.0\r\n```\r\n\r\n### Error output\r\n\r\n```\r\n $ cargo build --release\r\n   Compiling booktool v0.1.0 (/home/matyas/zebra-fresh/booktool)\r\n   Compiling legacy-zebra v0.1.0 (/home/matyas/zebra-fresh/legacy-zebra)\r\n   Compiling practice v0.1.0 (/home/matyas/zebra-fresh/practice)\r\n   Compiling enddev v0.1.0 (/home/matyas/zebra-fresh/enddev)\r\n   Compiling scrzebra v0.1.0 (/home/matyas/zebra-fresh/scrzebra)\r\n   Compiling wasm-simple v0.1.0 (/home/matyas/zebra-fresh/wasm-simple)\r\nerror: cannot determine resolution for the import\r\n --> practice/src/practice.rs:6:28\r\n  |\r\n6 | use engine::src::globals::{board_state};\r\n  |                            ^^^^^^^^^^^\r\n  |\r\n  = note: import resolution is stuck, try simplifying other imports\r\n\r\nerror: cannot determine resolution for the import\r\n --> practice/src/practice.rs:7:26\r\n  |\r\n7 | use engine::src::moves::{make_move, moves_state, generate_all, valid_move, unmake_move};\r\n  |                          ^^^^^^^^^\r\n  |\r\n  = note: import resolution is stuck, try simplifying other imports\r\n\r\nerror: cannot determine resolution for the import\r\n --> practice/src/practice.rs:7:37\r\n  |\r\n7 | use engine::src::moves::{make_move, moves_state, generate_all, valid_move, unmake_move};\r\n  |                                     ^^^^^^^^^^^\r\n  |\r\n  = note: import resolution is stuck, try simplifying other imports\r\n\r\nerror: cannot determine resolution for the import\r\n --> practice/src/practice.rs:7:50\r\n  |\r\n7 | use engine::src::moves::{make_move, moves_state, generate_all, valid_move, unmake_move};\r\n  |                                                  ^^^^^^^^^^^^\r\n  |\r\n  = note: import resolution is stuck, try simplifying other imports\r\n\r\nerror: cannot determine resolution for the import\r\n --> practice/src/practice.rs:7:64\r\n  |\r\n7 | use engine::src::moves::{make_move, moves_state, generate_all, valid_move, unmake_move};\r\n  |                                                                ^^^^^^^^^^\r\n  |\r\n  = note: import resolution is stuck, try simplifying other imports\r\n\r\nerror: cannot determine resolution for the import\r\n --> practice/src/practice.rs:7:76\r\n  |\r\n7 | use engine::src::moves::{make_move, moves_state, generate_all, valid_move, unmake_move};\r\n  |                                                                            ^^^^^^^^^^^\r\n  |\r\n  = note: import resolution is stuck, try simplifying other imports\r\n\r\nerror: cannot determine resolution for the import\r\n --> practice/src/practice.rs:8:28\r\n  |\r\n8 | use engine::src::osfbook::{get_hash, find_opening_name, g_book};\r\n  |                            ^^^^^^^^\r\n  |\r\n  = note: import resolution is stuck, try simplifying other imports\r\n\r\nerror: cannot determine resolution for the import\r\n --> practice/src/practice.rs:8:38\r\n  |\r\n8 | use engine::src::osfbook::{get_hash, find_opening_name, g_book};\r\n  |                                      ^^^^^^^^^^^^^^^^^\r\n  |\r\n  = note: import resolution is stuck, try simplifying other imports\r\n\r\nerror: cannot determine resolution for the import\r\n --> practice/src/practice.rs:8:57\r\n  |\r\n8 | use engine::src::osfbook::{get_hash, find_opening_name, g_book};\r\n  |                                                         ^^^^^^\r\n  |\r\n  = note: import resolution is stuck, try simplifying other imports\r\n\r\nerror[E0463]: can't find crate for `engine`\r\n  --> wasm-simple/src/lib.rs:27:1\r\n   |\r\n27 | extern crate engine;\r\n   | ^^^^^^^^^^^^^^^^^^^^ can't find crate\r\n\r\nerror: aborting due to previous error\r\n\r\nFor more information about this error, try `rustc --explain E0463`.\r\nerror: could not compile `wasm-simple`.\r\n\r\nTo learn more, run the command again with --verbose.\r\nwarning: build failed, waiting for other jobs to finish...\r\nerror: cannot determine resolution for the import\r\n --> scrzebra/src/scrzebra.rs:5:25\r\n  |\r\n5 | use engine::src::game::{global_terminate, game_state};\r\n  |                         ^^^^^^^^^^^^^^^^\r\n  |\r\n  = note: import resolution is stuck, try simplifying other imports\r\n\r\nerror: cannot determine resolution for the import\r\n --> scrzebra/src/scrzebra.rs:5:43\r\n  |\r\n5 | use engine::src::game::{global_terminate, game_state};\r\n  |                                           ^^^^^^^^^^\r\n  |\r\n  = note: import resolution is stuck, try simplifying other imports\r\n\r\nerror: cannot determine resolution for the import\r\n --> scrzebra/src/scrzebra.rs:6:29\r\n  |\r\n6 | use engine::src::myrandom::{random_instance};\r\n  |                             ^^^^^^^^^^^^^^^\r\n  |\r\n  = note: import resolution is stuck, try simplifying other imports\r\n\r\nerror: aborting due to 9 previous errors\r\n\r\nerror: aborting due to 3 previous errors\r\n\r\nthread '<unnamed>' panicked at 'wanted an rlib: \"file too small to be an archive\"', src/librustc_codegen_llvm/back/lto.rs:111:50\r\nnote: run with `RUST_BACKTRACE=1` environment variable to display a backtrace\r\n\r\nerror: internal compiler error: unexpected panic\r\n\r\nnote: the compiler unexpectedly panicked. this is a bug.\r\n\r\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/issues/new?labels=C-bug%2C+I-ICE%2C+T-compiler&template=ice.md\r\n\r\nnote: rustc 1.47.0-nightly (2d8a3b918 2020-08-26) running on x86_64-unknown-linux-gnu\r\n\r\nnote: compiler flags: -C opt-level=3 -C lto=thin -C overflow-checks=on -C incremental --crate-type bin\r\n\r\nnote: some of the compiler flags provided by cargo are hidden\r\n\r\nthread 'rustc' panicked at '/rustc/2d8a3b9181f41d3af9b9f016c5d73b2553e344bf/src/librustc_codegen_ssa/back/write.rs:1713:17: panic during codegen/LLVM phase', src/librustc_middle/util/bug.rs:34:26\r\n\r\nerror: internal compiler error: unexpected panic\r\n\r\nnote: the compiler unexpectedly panicked. this is a bug.\r\n\r\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/issues/new?labels=C-bug%2C+I-ICE%2C+T-compiler&template=ice.md\r\n\r\nnote: rustc 1.47.0-nightly (2d8a3b918 2020-08-26) running on x86_64-unknown-linux-gnu\r\n\r\nnote: compiler flags: -C opt-level=3 -C lto=thin -C overflow-checks=on -C incremental --crate-type bin\r\n\r\nnote: some of the compiler flags provided by cargo are hidden\r\n\r\nthread '<unnamed>' panicked at 'wanted an rlib: \"file too small to be an archive\"', src/librustc_codegen_llvm/back/lto.rs:111:50\r\nnote: run with `RUST_BACKTRACE=1` environment variable to display a backtrace\r\n\r\nerror: internal compiler error: unexpected panic\r\n\r\nnote: the compiler unexpectedly panicked. this is a bug.\r\n\r\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/issues/new?labels=C-bug%2C+I-ICE%2C+T-compiler&template=ice.md\r\n\r\nnote: rustc 1.47.0-nightly (2d8a3b918 2020-08-26) running on x86_64-unknown-linux-gnu\r\n\r\nnote: compiler flags: -C opt-level=3 -C lto=thin -C overflow-checks=on -C incremental --crate-type bin\r\n\r\nnote: some of the compiler flags provided by cargo are hidden\r\n\r\nthread 'rustc' panicked at '/rustc/2d8a3b9181f41d3af9b9f016c5d73b2553e344bf/src/librustc_codegen_ssa/back/write.rs:1713:17: panic during codegen/LLVM phase', src/librustc_middle/util/bug.rs:34:26\r\n\r\nerror: internal compiler error: unexpected panic\r\n\r\nnote: the compiler unexpectedly panicked. this is a bug.\r\n\r\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/issues/new?labels=C-bug%2C+I-ICE%2C+T-compiler&template=ice.md\r\n\r\nnote: rustc 1.47.0-nightly (2d8a3b918 2020-08-26) running on x86_64-unknown-linux-gnu\r\n\r\nnote: compiler flags: -C opt-level=3 -C lto=thin -C overflow-checks=on -C incremental --crate-type bin\r\n\r\nnote: some of the compiler flags provided by cargo are hidden\r\n\r\nthread '<unnamed>' panicked at 'wanted an rlib: \"file too small to be an archive\"', src/librustc_codegen_llvm/back/lto.rs:111:50\r\nnote: run with `RUST_BACKTRACE=1` environment variable to display a backtrace\r\n\r\nerror: internal compiler error: unexpected panic\r\n\r\nnote: the compiler unexpectedly panicked. this is a bug.\r\n\r\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/issues/new?labels=C-bug%2C+I-ICE%2C+T-compiler&template=ice.md\r\n\r\nnote: rustc 1.47.0-nightly (2d8a3b918 2020-08-26) running on x86_64-unknown-linux-gnu\r\n\r\nnote: compiler flags: -C opt-level=3 -C lto=thin -C overflow-checks=on -C incremental --crate-type bin\r\n\r\nnote: some of the compiler flags provided by cargo are hidden\r\n\r\nthread 'rustc' panicked at '/rustc/2d8a3b9181f41d3af9b9f016c5d73b2553e344bf/src/librustc_codegen_ssa/back/write.rs:1713:17: panic during codegen/LLVM phase', src/librustc_middle/util/bug.rs:34:26\r\n\r\nerror: internal compiler error: unexpected panic\r\n\r\nnote: the compiler unexpectedly panicked. this is a bug.\r\n\r\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/issues/new?labels=C-bug%2C+I-ICE%2C+T-compiler&template=ice.md\r\n\r\nnote: rustc 1.47.0-nightly (2d8a3b918 2020-08-26) running on x86_64-unknown-linux-gnu\r\n\r\nnote: compiler flags: -C opt-level=3 -C lto=thin -C overflow-checks=on -C incremental --crate-type bin\r\n\r\nnote: some of the compiler flags provided by cargo are hidden\r\n\r\nerror: build failed\r\n\r\n```\r\n\r\n<!--\r\nInclude a backtrace in the code block by setting `RUST_BACKTRACE=1` in your\r\nenvironment. E.g. `RUST_BACKTRACE=1 cargo build`.\r\n-->\r\n<details><summary><strong>Backtrace</strong></summary>\r\n<p>\r\n\r\n```\r\nthread 'rustc' panicked at '/rustc/2d8a3b9181f41d3af9b9f016c5d73b2553e344bf/src/librustc_codegen_ssa/back/write.rs:1713:17: panic during codegen/LLVM phase', src/librustc_middle/util/bug.rs:34:26\r\nstack backtrace:\r\n   0: std::panicking::begin_panic\r\n   1: rustc_middle::util::bug::opt_span_bug_fmt::{{closure}}\r\n   2: rustc_middle::ty::context::tls::with_opt::{{closure}}\r\n   3: rustc_middle::ty::context::tls::with_opt\r\n   4: rustc_middle::util::bug::opt_span_bug_fmt\r\n   5: rustc_middle::util::bug::bug_fmt\r\n   6: rustc_session::utils::<impl rustc_session::session::Session>::time\r\n   7: rustc_codegen_ssa::back::write::OngoingCodegen<B>::join\r\n   8: <rustc_codegen_llvm::LlvmCodegenBackend as rustc_codegen_ssa::traits::backend::CodegenBackend>::join_codegen\r\n   9: rustc_interface::queries::Linker::link\r\n  10: rustc_span::with_source_map\r\n  11: rustc_interface::interface::create_compiler_and_run\r\n  12: scoped_tls::ScopedKey<T>::set\r\n\r\n```\r\n\r\n</p>\r\n</details>\r\n\r\n", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/80516/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/80516/timeline", "performed_via_github_app": null, "state_reason": null}