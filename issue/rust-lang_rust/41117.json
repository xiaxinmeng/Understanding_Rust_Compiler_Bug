{"url": "https://api.github.com/repos/rust-lang/rust/issues/41117", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/41117/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/41117/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/41117/events", "html_url": "https://github.com/rust-lang/rust/issues/41117", "id": 219951429, "node_id": "MDU6SXNzdWUyMTk5NTE0Mjk=", "number": 41117, "title": "Compiler panic when manually indexing vectors", "user": {"login": "urschrei", "id": 131862, "node_id": "MDQ6VXNlcjEzMTg2Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/131862?v=4", "gravatar_id": "", "url": "https://api.github.com/users/urschrei", "html_url": "https://github.com/urschrei", "followers_url": "https://api.github.com/users/urschrei/followers", "following_url": "https://api.github.com/users/urschrei/following{/other_user}", "gists_url": "https://api.github.com/users/urschrei/gists{/gist_id}", "starred_url": "https://api.github.com/users/urschrei/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/urschrei/subscriptions", "organizations_url": "https://api.github.com/users/urschrei/orgs", "repos_url": "https://api.github.com/users/urschrei/repos", "events_url": "https://api.github.com/users/urschrei/events{/privacy}", "received_events_url": "https://api.github.com/users/urschrei/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2017-04-06T16:12:05Z", "updated_at": "2017-04-06T19:56:15Z", "closed_at": "2017-04-06T19:56:15Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I'm manually indexing some vectors using a `usize` field from a struct. This is causing a compiler panic.\r\n\r\nCode: commit [c624f56](https://github.com/urschrei/rust-geo/commit/c624f56a2b888f467637c5f88e070e9e6e993066) at https://github.com/urschrei/rust-geo/tree/polygon_distance.\r\n\r\nRustc version: \r\n`nightly-x86_64-apple-darwin`\r\n`rustc 1.18.0-nightly (91ae22a01 2017-04-05)`\r\n\r\nFull Backtrace (under dropdown):\r\n<details>\r\n<summary>\r\n\r\n    error: internal compiler error: src/librustc_typeck/check/coercion.rs:718: expr already has an adjustment on it!\r\n\r\n</summary>\r\n\r\n    thread 'rustc' panicked at 'Box<Any>', src/librustc_errors/lib.rs:416\r\n    stack backtrace:\r\n     0:        0x10ad96953 - std::sys::imp::backtrace::tracing::imp::unwind_backtrace::hbdeac7eba2f064c6\r\n     1:        0x10ada36ed - std::panicking::default_hook::{{closure}}::h9e0a6ca9bb64b479\r\n     2:        0x10ada3234 - std::panicking::default_hook::h9043ae80af471c9f\r\n     3:        0x10ada5e57 - std::panicking::rust_panic_with_hook::h05996066754c6be9\r\n     4:        0x10833994a - std::panicking::begin_panic::hf47fe75ea38aa60c\r\n     5:        0x108351194 - rustc_errors::Handler::bug::h5c4d3c22f7d6cf5f\r\n     6:        0x10754f46c - rustc::session::opt_span_bug_fmt::{{closure}}::hc30486983bf7baa5\r\n     7:        0x10754f270 - rustc::session::opt_span_bug_fmt::hbb1ce5f815a221d0\r\n     8:        0x10754edfa - rustc::session::bug_fmt::h603b74c583ab5af8\r\n     9:        0x106634f2d - rustc_typeck::check::coercion::<impl rustc_typeck::check::FnCtxt<'a, 'gcx, 'tcx>>::try_coerce::hf1afc4fb1f0fd049\r\n    10:        0x1066463c7 - rustc_typeck::check::demand::<impl rustc_typeck::check::FnCtxt<'a, 'gcx, 'tcx>>::demand_coerce::h5e0424652dca67df\r\n    11:        0x106698e9a - rustc_typeck::check::FnCtxt::check_argument_types::h6c5ac67922ecc7f4\r\n    12:        0x10669816d - rustc_typeck::check::FnCtxt::check_method_argument_types::hdfcaa2508888d95b\r\n    13:        0x1066a34b8 - rustc_typeck::check::FnCtxt::check_expr_kind::h1135e8c4361f6473\r\n    14:        0x10669eb20 - rustc_typeck::check::FnCtxt::check_expr_with_expectation_and_lvalue_pref::h1bb7590703cfb153\r\n    15:        0x10669a2f6 - rustc_typeck::check::FnCtxt::check_expr_has_type::heef4496f4d358bdf\r\n    16:        0x1066a437d - rustc_typeck::check::FnCtxt::check_expr_kind::h1135e8c4361f6473\r\n    17:        0x10669eb20 - rustc_typeck::check::FnCtxt::check_expr_with_expectation_and_lvalue_pref::h1bb7590703cfb153\r\n    18:        0x1066a6fa7 - rustc_typeck::check::FnCtxt::check_decl_initializer::hb2018bec0565c8ca\r\n    19:        0x1066a708c - rustc_typeck::check::FnCtxt::check_decl_local::h42d2a6e470f71fbe\r\n    20:        0x1066a72e1 - rustc_typeck::check::FnCtxt::check_stmt::h10977bf77ab03006\r\n    21:        0x1066a7cee - rustc_typeck::check::FnCtxt::check_block_with_expected::{{closure}}::h4fc16531f0890bf6\r\n    22:        0x1066a7746 - rustc_typeck::check::FnCtxt::check_block_with_expected::ha99b44f2b0900127\r\n    23:        0x10669f9bc - rustc_typeck::check::FnCtxt::check_expr_kind::h1135e8c4361f6473\r\n    24:        0x10669eb20 - rustc_typeck::check::FnCtxt::check_expr_with_expectation_and_lvalue_pref::h1bb7590703cfb153\r\n    25:        0x10669b13d - rustc_typeck::check::FnCtxt::check_return_expr::h31d207f50840039d\r\n    26:        0x10668b93e - rustc_typeck::check::check_fn::ha1265f1a8a15cfc7\r\n    27:        0x10668a12b - rustc_typeck::check::typeck_tables::h8f56b5a1240db926\r\n    28:        0x10762ad01 - rustc::ty::maps::<impl rustc::ty::maps::queries::typeck_tables<'tcx>>::try_get::h48076491a959043c\r\n    29:        0x10762aeb3 - rustc::ty::maps::<impl rustc::ty::maps::queries::typeck_tables<'tcx>>::get::hac6c722e7d137c6c\r\n    30:        0x1075df12c - rustc::ty::<impl rustc::ty::context::TyCtxt<'a, 'gcx, 'tcx>>::item_tables::h0cc43c4a7e140596\r\n    31:        0x106689062 - rustc_typeck::check::typeck_item_bodies::h023401d8604ce9d6\r\n    32:        0x107629fcd - rustc::ty::maps::<impl rustc::ty::maps::queries::typeck_item_bodies<'tcx>>::try_get::ha8f2587920e8897e\r\n    33:        0x10762a1d2 - rustc::ty::maps::<impl rustc::ty::maps::queries::typeck_item_bodies<'tcx>>::get::h355bebb502605440\r\n    34:        0x1066e16ef - rustc_typeck::check_crate::hbd024fa93952a70d\r\n    35:        0x10628e710 - rustc_driver::driver::phase_3_run_analysis_passes::{{closure}}::h268f1787328becc3\r\n    36:        0x1061dc844 - rustc::ty::context::TyCtxt::create_and_enter::h6fdf5bf007c6624c\r\n    37:        0x10628bc34 - rustc_driver::driver::phase_3_run_analysis_passes::he1ec91c87e760611\r\n    38:        0x10625cbad - rustc_driver::driver::compile_input::h2d34c130b0e09b8d\r\n    39:        0x1062b85cb - rustc_driver::run_compiler::hc1973c7a7c291533\r\n    40:        0x10618c928 - std::panicking::try::do_call::hc2d47b7090d8b7b0\r\n    41:        0x10ada8c6a - __rust_maybe_catch_panic\r\n    42:        0x1061d2a6f - <F as alloc::boxed::FnBox<A>>::call_box::h39cb667f07a35289\r\n    43:        0x10ada26d4 - std::sys::imp::thread::Thread::new::thread_start::h4008e1859fbd98b8\r\n    44:     0x7fffd89bbaaa - _pthread_body\r\n    45:     0x7fffd89bb9f6 - _pthread_start\r\n\r\n\r\n</details>", "closed_by": {"login": "eddyb", "id": 77424, "node_id": "MDQ6VXNlcjc3NDI0", "avatar_url": "https://avatars.githubusercontent.com/u/77424?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eddyb", "html_url": "https://github.com/eddyb", "followers_url": "https://api.github.com/users/eddyb/followers", "following_url": "https://api.github.com/users/eddyb/following{/other_user}", "gists_url": "https://api.github.com/users/eddyb/gists{/gist_id}", "starred_url": "https://api.github.com/users/eddyb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eddyb/subscriptions", "organizations_url": "https://api.github.com/users/eddyb/orgs", "repos_url": "https://api.github.com/users/eddyb/repos", "events_url": "https://api.github.com/users/eddyb/events{/privacy}", "received_events_url": "https://api.github.com/users/eddyb/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/41117/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/41117/timeline", "performed_via_github_app": null, "state_reason": "completed"}