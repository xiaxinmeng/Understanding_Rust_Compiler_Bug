{"url": "https://api.github.com/repos/rust-lang/rust/issues/55634", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/55634/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/55634/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/55634/events", "html_url": "https://github.com/rust-lang/rust/issues/55634", "id": 376994586, "node_id": "MDU6SXNzdWUzNzY5OTQ1ODY=", "number": 55634, "title": "Cyclic dependency bug processing RPIT `impl Trait`", "user": {"login": "alexreg", "id": 67036, "node_id": "MDQ6VXNlcjY3MDM2", "avatar_url": "https://avatars.githubusercontent.com/u/67036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexreg", "html_url": "https://github.com/alexreg", "followers_url": "https://api.github.com/users/alexreg/followers", "following_url": "https://api.github.com/users/alexreg/following{/other_user}", "gists_url": "https://api.github.com/users/alexreg/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexreg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexreg/subscriptions", "organizations_url": "https://api.github.com/users/alexreg/orgs", "repos_url": "https://api.github.com/users/alexreg/repos", "events_url": "https://api.github.com/users/alexreg/events{/privacy}", "received_events_url": "https://api.github.com/users/alexreg/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 631673608, "node_id": "MDU6TGFiZWw2MzE2NzM2MDg=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-impl-trait", "name": "A-impl-trait", "color": "f7e101", "default": false, "description": "Area: impl Trait. Universally / existentially quantified anonymous types with static dispatch."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2018-11-02T23:09:05Z", "updated_at": "2020-02-01T00:49:16Z", "closed_at": "2020-01-31T11:49:50Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "```rust\r\ntrait Foo: Fn(i32) + Send {}\r\n\r\nimpl<T: ?Sized + Fn(i32) + Send> Foo for T {}\r\n\r\nfn gives_foo() -> impl Foo {\r\n    let f = |x| println!(\"{}\", x);\r\n    f\r\n}\r\n\r\nfn main() {\r\n    gives_foo()(42);\r\n}\r\n```\r\n\r\nyields\r\n\r\n```\r\nerror[E0391]: cycle detected when processing `gives_foo::{{impl-Trait}}`\r\n --> test.rs:5:19\r\n  |\r\n5 | fn gives_foo() -> impl Foo {\r\n  |                   ^^^^^^^^\r\n  |\r\nnote: ...which requires processing `gives_foo::{{impl-Trait}}`...\r\n --> test.rs:5:19\r\n  |\r\n5 | fn gives_foo() -> impl Foo {\r\n  |                   ^^^^^^^^\r\nnote: ...which requires processing `gives_foo::{{impl-Trait}}`...\r\n --> test.rs:5:19\r\n  |\r\n5 | fn gives_foo() -> impl Foo {\r\n  |                   ^^^^^^^^\r\n  = note: ...which again requires processing `gives_foo::{{impl-Trait}}`, completing the cycle\r\nnote: cycle used when processing `gives_foo`\r\n --> test.rs:5:1\r\n  |\r\n5 | fn gives_foo() -> impl Foo {\r\n  | ^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n```\r\n\r\nI originally thought this was my PR https://github.com/rust-lang/rust/pull/55101 that was at fault, but I've now confirmed this bug occurs on master, so it looks like it isn't... not in the latest nightly though, as of now, so it must have been a recent PR.\r\n\r\nCC @nikomatsakis @oli-obk ", "closed_by": {"login": "oli-obk", "id": 332036, "node_id": "MDQ6VXNlcjMzMjAzNg==", "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oli-obk", "html_url": "https://github.com/oli-obk", "followers_url": "https://api.github.com/users/oli-obk/followers", "following_url": "https://api.github.com/users/oli-obk/following{/other_user}", "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}", "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions", "organizations_url": "https://api.github.com/users/oli-obk/orgs", "repos_url": "https://api.github.com/users/oli-obk/repos", "events_url": "https://api.github.com/users/oli-obk/events{/privacy}", "received_events_url": "https://api.github.com/users/oli-obk/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/55634/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/55634/timeline", "performed_via_github_app": null, "state_reason": "completed"}