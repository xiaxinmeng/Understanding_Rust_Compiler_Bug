{"url": "https://api.github.com/repos/rust-lang/rust/issues/104713", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/104713/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/104713/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/104713/events", "html_url": "https://github.com/rust-lang/rust/issues/104713", "id": 1459921143, "node_id": "I_kwDOAAsO6M5XBKD3", "number": 104713, "title": "Cross compilation with NDK has `-lgcc` linking error when using nightly-2022-11-22", "user": {"login": "bczhc", "id": 49330580, "node_id": "MDQ6VXNlcjQ5MzMwNTgw", "avatar_url": "https://avatars.githubusercontent.com/u/49330580?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bczhc", "html_url": "https://github.com/bczhc", "followers_url": "https://api.github.com/users/bczhc/followers", "following_url": "https://api.github.com/users/bczhc/following{/other_user}", "gists_url": "https://api.github.com/users/bczhc/gists{/gist_id}", "starred_url": "https://api.github.com/users/bczhc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bczhc/subscriptions", "organizations_url": "https://api.github.com/users/bczhc/orgs", "repos_url": "https://api.github.com/users/bczhc/repos", "events_url": "https://api.github.com/users/bczhc/events{/privacy}", "received_events_url": "https://api.github.com/users/bczhc/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-11-22T13:55:22Z", "updated_at": "2022-11-25T04:35:44Z", "closed_at": "2022-11-25T04:35:43Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm cross compiling for target `aarch64-linux-android`. With Rust nightly-2022-11-21 it compiles successfully, but with nightly-2022-11-22 it fails with:\r\n```\r\nld: error: unable to find library -lgcc\r\n```\r\nThe NDK version is r25b 25.1.8937393;\r\n\r\nI referred to https://github.com/rust-lang/rust/issues/103673, and learnt Rust has changed to link against `libunwind` but not `libgcc`. So seems this is a regression failure or something I'm doing wrong?\r\n\r\n<details>\r\n<summary>Full log</summary>\r\n\r\n```\r\n~/code/rust-android master +1 !1 ?5 \u276f cargo build --target aarch64-linux-android                            21:46:35\r\n   Compiling rust-android v0.1.0 (/home/bczhc/code/rust-android)\r\nerror: linking with `/home/bczhc/bin/AndroidSdk/ndk-ln/toolchains/llvm/prebuilt/linux-x86_64/bin/aarch64-linux-android29-clang` failed: exit status: 1\r\n  |\r\n  = note: \"/home/bczhc/bin/AndroidSdk/ndk-ln/toolchains/llvm/prebuilt/linux-x86_64/bin/aarch64-linux-android29-clang\" \"/tmp/rustcbGINIs/symbols.o\" \"/home/bczhc/code/rust-android/target/aarch64-linux-android/debug/deps/rust_android-899902876eb1ed99.209aztrajef46mb9.rcgu.o\" \"/home/bczhc/code/rust-android/target/aarch64-linux-android/debug/deps/rust_android-899902876eb1ed99.23gzzxp4za4h6baf.rcgu.o\" \"/home/bczhc/code/rust-android/target/aarch64-linux-android/debug/deps/rust_android-899902876eb1ed99.2eas1hb3optdpf6h.rcgu.o\" \"/home/bczhc/code/rust-android/target/aarch64-linux-android/debug/deps/rust_android-899902876eb1ed99.2mtgqldpdhwnwao8.rcgu.o\" \"/home/bczhc/code/rust-android/target/aarch64-linux-android/debug/deps/rust_android-899902876eb1ed99.2t9rvjop1zi8hsjb.rcgu.o\" \"/home/bczhc/code/rust-android/target/aarch64-linux-android/debug/deps/rust_android-899902876eb1ed99.587nb6gei7lq2qyg.rcgu.o\" \"/home/bczhc/code/rust-android/target/aarch64-linux-android/debug/deps/rust_android-899902876eb1ed99.2ylje1ipjcfs41od.rcgu.o\" \"-Wl,--as-needed\" \"-L\" \"/home/bczhc/code/rust-android/target/aarch64-linux-android/debug/deps\" \"-L\" \"/home/bczhc/code/rust-android/target/debug/deps\" \"-L\" \"/home/bczhc/.rustup/toolchains/nightly-2022-11-22-x86_64-unknown-linux-gnu/lib/rustlib/aarch64-linux-android/lib\" \"-Wl,-Bstatic\" \"/home/bczhc/.rustup/toolchains/nightly-2022-11-22-x86_64-unknown-linux-gnu/lib/rustlib/aarch64-linux-android/lib/libstd-44e59ce46eff691f.rlib\" \"/home/bczhc/.rustup/toolchains/nightly-2022-11-22-x86_64-unknown-linux-gnu/lib/rustlib/aarch64-linux-android/lib/libpanic_unwind-addcabb4f0b16e08.rlib\" \"/home/bczhc/.rustup/toolchains/nightly-2022-11-22-x86_64-unknown-linux-gnu/lib/rustlib/aarch64-linux-android/lib/libobject-eb29cd6c84a740de.rlib\" \"/home/bczhc/.rustup/toolchains/nightly-2022-11-22-x86_64-unknown-linux-gnu/lib/rustlib/aarch64-linux-android/lib/libmemchr-785629020be38a39.rlib\" \"/home/bczhc/.rustup/toolchains/nightly-2022-11-22-x86_64-unknown-linux-gnu/lib/rustlib/aarch64-linux-android/lib/libaddr2line-b56a3970a24cee61.rlib\" \"/home/bczhc/.rustup/toolchains/nightly-2022-11-22-x86_64-unknown-linux-gnu/lib/rustlib/aarch64-linux-android/lib/libgimli-3ae22f8b3096f1a8.rlib\" \"/home/bczhc/.rustup/toolchains/nightly-2022-11-22-x86_64-unknown-linux-gnu/lib/rustlib/aarch64-linux-android/lib/librustc_demangle-37803426f056567f.rlib\" \"/home/bczhc/.rustup/toolchains/nightly-2022-11-22-x86_64-unknown-linux-gnu/lib/rustlib/aarch64-linux-android/lib/libstd_detect-d7c637bc7d62b82b.rlib\" \"/home/bczhc/.rustup/toolchains/nightly-2022-11-22-x86_64-unknown-linux-gnu/lib/rustlib/aarch64-linux-android/lib/libhashbrown-b39d331284f7919b.rlib\" \"/home/bczhc/.rustup/toolchains/nightly-2022-11-22-x86_64-unknown-linux-gnu/lib/rustlib/aarch64-linux-android/lib/libminiz_oxide-b31bc16d397c82fe.rlib\" \"/home/bczhc/.rustup/toolchains/nightly-2022-11-22-x86_64-unknown-linux-gnu/lib/rustlib/aarch64-linux-android/lib/libadler-299212bdd5b6c2b1.rlib\" \"/home/bczhc/.rustup/toolchains/nightly-2022-11-22-x86_64-unknown-linux-gnu/lib/rustlib/aarch64-linux-android/lib/librustc_std_workspace_alloc-4288b814a1ec58ed.rlib\" \"/home/bczhc/.rustup/toolchains/nightly-2022-11-22-x86_64-unknown-linux-gnu/lib/rustlib/aarch64-linux-android/lib/libunwind-b7a539f600277fb0.rlib\" \"/home/bczhc/.rustup/toolchains/nightly-2022-11-22-x86_64-unknown-linux-gnu/lib/rustlib/aarch64-linux-android/lib/libcfg_if-e3fb8a12c773a31b.rlib\" \"/home/bczhc/.rustup/toolchains/nightly-2022-11-22-x86_64-unknown-linux-gnu/lib/rustlib/aarch64-linux-android/lib/liblibc-f211a911193b255a.rlib\" \"/home/bczhc/.rustup/toolchains/nightly-2022-11-22-x86_64-unknown-linux-gnu/lib/rustlib/aarch64-linux-android/lib/liballoc-662a384e072c51ed.rlib\" \"/home/bczhc/.rustup/toolchains/nightly-2022-11-22-x86_64-unknown-linux-gnu/lib/rustlib/aarch64-linux-android/lib/librustc_std_workspace_core-001d5bd9a65e4337.rlib\" \"/home/bczhc/.rustup/toolchains/nightly-2022-11-22-x86_64-unknown-linux-gnu/lib/rustlib/aarch64-linux-android/lib/libcore-088bc0b43b3ec677.rlib\" \"/home/bczhc/.rustup/toolchains/nightly-2022-11-22-x86_64-unknown-linux-gnu/lib/rustlib/aarch64-linux-android/lib/libcompiler_builtins-5ad7898d2a9789ed.rlib\" \"-Wl,-Bdynamic\" \"-ldl\" \"-llog\" \"-lgcc\" \"-ldl\" \"-lm\" \"-lc\" \"-Wl,--eh-frame-hdr\" \"-Wl,-znoexecstack\" \"-L\" \"/home/bczhc/.rustup/toolchains/nightly-2022-11-22-x86_64-unknown-linux-gnu/lib/rustlib/aarch64-linux-android/lib\" \"-o\" \"/home/bczhc/code/rust-android/target/aarch64-linux-android/debug/deps/rust_android-899902876eb1ed99\" \"-Wl,--gc-sections\" \"-pie\" \"-Wl,-zrelro,-znow\" \"-nodefaultlibs\"\r\n  = note: ld: error: unable to find library -lgcc\r\n          clang-14: error: linker command failed with exit code 1 (use -v to see invocation)\r\n          \r\n\r\nerror: could not compile `rust-android` due to previous error\r\n```\r\n</details>", "closed_by": {"login": "bczhc", "id": 49330580, "node_id": "MDQ6VXNlcjQ5MzMwNTgw", "avatar_url": "https://avatars.githubusercontent.com/u/49330580?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bczhc", "html_url": "https://github.com/bczhc", "followers_url": "https://api.github.com/users/bczhc/followers", "following_url": "https://api.github.com/users/bczhc/following{/other_user}", "gists_url": "https://api.github.com/users/bczhc/gists{/gist_id}", "starred_url": "https://api.github.com/users/bczhc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bczhc/subscriptions", "organizations_url": "https://api.github.com/users/bczhc/orgs", "repos_url": "https://api.github.com/users/bczhc/repos", "events_url": "https://api.github.com/users/bczhc/events{/privacy}", "received_events_url": "https://api.github.com/users/bczhc/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/104713/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/104713/timeline", "performed_via_github_app": null, "state_reason": "completed"}