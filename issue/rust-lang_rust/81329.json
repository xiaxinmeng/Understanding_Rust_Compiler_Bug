{"url": "https://api.github.com/repos/rust-lang/rust/issues/81329", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/81329/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/81329/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/81329/events", "html_url": "https://github.com/rust-lang/rust/issues/81329", "id": 792777313, "node_id": "MDU6SXNzdWU3OTI3NzczMTM=", "number": 81329, "title": "[ER] Smarter error handling in struct destructuring assignment", "user": {"login": "leonardo-m", "id": 22328461, "node_id": "MDQ6VXNlcjIyMzI4NDYx", "avatar_url": "https://avatars.githubusercontent.com/u/22328461?v=4", "gravatar_id": "", "url": "https://api.github.com/users/leonardo-m", "html_url": "https://github.com/leonardo-m", "followers_url": "https://api.github.com/users/leonardo-m/followers", "following_url": "https://api.github.com/users/leonardo-m/following{/other_user}", "gists_url": "https://api.github.com/users/leonardo-m/gists{/gist_id}", "starred_url": "https://api.github.com/users/leonardo-m/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/leonardo-m/subscriptions", "organizations_url": "https://api.github.com/users/leonardo-m/orgs", "repos_url": "https://api.github.com/users/leonardo-m/repos", "events_url": "https://api.github.com/users/leonardo-m/events{/privacy}", "received_events_url": "https://api.github.com/users/leonardo-m/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 234876, "node_id": "MDU6TGFiZWwyMzQ4NzY=", "url": "https://api.github.com/repos/rust-lang/rust/labels/E-hard", "name": "E-hard", "color": "02e10c", "default": false, "description": "Call for participation: Experience needed to fix: Hard / a lot"}, {"id": 235791, "node_id": "MDU6TGFiZWwyMzU3OTE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-diagnostics", "name": "A-diagnostics", "color": "f7e101", "default": false, "description": "Area: Messages for errors, warnings, and lints"}, {"id": 60329014, "node_id": "MDU6TGFiZWw2MDMyOTAxNA==", "url": "https://api.github.com/repos/rust-lang/rust/labels/P-low", "name": "P-low", "color": "eb6420", "default": false, "description": "Low priority"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 630652267, "node_id": "MDU6TGFiZWw2MzA2NTIyNjc=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-feature-request", "name": "C-feature-request", "color": "f5f1fd", "default": false, "description": "Category: A feature request, i.e: not implemented / a PR."}, {"id": 1183099971, "node_id": "MDU6TGFiZWwxMTgzMDk5OTcx", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-suggestion-diagnostics", "name": "A-suggestion-diagnostics", "color": "f7e101", "default": false, "description": "Area: suggestions generated by the compiler applied by cargo fix"}, {"id": 1596122130, "node_id": "MDU6TGFiZWwxNTk2MTIyMTMw", "url": "https://api.github.com/repos/rust-lang/rust/labels/D-papercut", "name": "D-papercut", "color": "c9f7a3", "default": false, "description": "Diagnostic error that needs small tweaks"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-01-24T11:41:13Z", "updated_at": "2021-01-25T06:13:44Z", "closed_at": null, "author_association": "NONE", "active_lock_reason": null, "body": "This is a diagnostic enhancement request. In this code there's a simple bug, the destructuring assignment is done by mistake on Bar (that is not defined) instead of Foo:\r\n\r\n```rust\r\n#![feature(destructuring_assignment)]\r\n#![allow(unused_assignments, unused_variables, unused_mut)]\r\nfn main() {\r\n    struct Foo { x: u64, y: u64 }\r\n    let f = Foo {x: 10, y: 20};\r\n    let mut a;\r\n    let mut b;\r\n    Bar {x: a, y: b} = f;\r\n}\r\n```\r\nrustc `1.51.0-nightly 4d0dd02ee 2021-01-23` gives:\r\n\r\n```rust\r\nerror[E0422]: cannot find struct, variant or union type `Bar` in this scope\r\n --> C:\\lavoro\\bugs\\test.rs:8:5\r\n  |\r\n8 |     Bar {x: a, y: b} = f;\r\n  |     ^^^ not found in this scope\r\n\r\nerror: aborting due to previous error\r\n\r\nFor more information about this error, try `rustc --explain E0422`.\r\n```\r\n\r\nf is of type Foo so the compiler can infer that probably Bar should be replaced by a Foo (also because the fields on the left of the destructuring assignment match correctly with the fields of Foo), so I'd like rustc to suggest to replace Bar with Foo there.", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/81329/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/81329/timeline", "performed_via_github_app": null, "state_reason": null}