{"url": "https://api.github.com/repos/rust-lang/rust/issues/12796", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/12796/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/12796/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/12796/events", "html_url": "https://github.com/rust-lang/rust/issues/12796", "id": 29064324, "node_id": "MDU6SXNzdWUyOTA2NDMyNA==", "number": 12796, "title": "Bad error message with Self in inner function", "user": {"login": "tbu-", "id": 6666593, "node_id": "MDQ6VXNlcjY2NjY1OTM=", "avatar_url": "https://avatars.githubusercontent.com/u/6666593?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tbu-", "html_url": "https://github.com/tbu-", "followers_url": "https://api.github.com/users/tbu-/followers", "following_url": "https://api.github.com/users/tbu-/following{/other_user}", "gists_url": "https://api.github.com/users/tbu-/gists{/gist_id}", "starred_url": "https://api.github.com/users/tbu-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tbu-/subscriptions", "organizations_url": "https://api.github.com/users/tbu-/orgs", "repos_url": "https://api.github.com/users/tbu-/repos", "events_url": "https://api.github.com/users/tbu-/events{/privacy}", "received_events_url": "https://api.github.com/users/tbu-/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2014-03-09T22:22:45Z", "updated_at": "2015-05-01T23:59:19Z", "closed_at": "2014-05-22T08:01:28Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "# Updated example\n\n``` rust\ntrait Trait {\n    fn outer(self) {\n        fn inner(_: Self) {\n        }\n    }\n}\n\nfn main() { }\n```\n\n```\nerror: missing `Self` type param in the substitution of `fn(Self)`\n```\n# Original issue\n\nI have no idea where this came from, so here's a stacktrace.\n\n```\nStarting program: /usr/bin/rustc datafile_raw.rs\nwarning: Could not load shared library symbols for linux-vdso.so.1.\nDo you need \"set solib-search-path\" or \"set sysroot\"?\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/usr/lib/libthread_db.so.1\".\nwarning: File \"/usr/lib/libstdc++.so.6.0.19-gdb.py\" auto-loading has been declined by your `auto-load safe-path' set to \"$debugdir:$datadir/auto-load\".\n[New Thread 0x7ffff1f78480 (LWP 4681)]\ndatafile_raw.rs:348:75: 348:81 error: mismatched types: expected `fn(<generic #1>, &&'a Self) -> <generic #2>` but found `fn(uint, &'a Self) -> DatafileItem<'a>` (expected &-ptr but found self)\ndatafile_raw.rs:348         MapIterator { data: self, iterator: range(0, self.num_items()), map_fn: map_fn }\n                                                    ^~~~~~\ndatafile_raw.rs:348:3: 348:83 error: mismatched types: expected `DatafileItemIterator<'a,Self>` but found `MapIterator<<generic #1>,<generic #2>,&'a Self,std::iter::Range<uint>>` (expected struct DatafileItemIterator but found struct MapIterator)\ndatafile_raw.rs:348         MapIterator { data: self, iterator: range(0, self.num_items()), map_fn: map_fn }\n                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n[Switching to Thread 0x7ffff1f78480 (LWP 4681)]\n\nBreakpoint 1, std::rt::unwind::Unwinder::begin_unwind::rust_fail () at src/libstd/rt/global_heap.rs:71\n71  pub unsafe fn exchange_malloc(size: uint) -> *u8 {\n(gdb) bt\n#0  std::rt::unwind::Unwinder::begin_unwind::rust_fail () at src/libstd/rt/global_heap.rs:71\n#1  0x00007ffff775c961 in std::rt::unwind::Unwinder::begin_unwind (self=0x6066a8, cause=...) at src/libstd/rt/unwind.rs:220\n#2  0x00007ffff76bfa29 in std::rt::unwind::begin_unwind_inner (msg=..., file=..., line=148) at src/libstd/rt/unwind.rs:538\n#3  0x00007ffff371240e in rt::unwind::begin_unwind::h2c1d88c0eb2e464eqik::v0.10.pre () from /usr/lib/librustc-6ccece0c-0.10-pre.so\n#4  0x00007ffff3964b1c in lookup_vtable (vcx=<optimized out>, location_info=<optimized out>, trait_ref=<optimized out>, is_early=<optimized out>)\n    at src/librustc/middle/typeck/check/vtable.rs:272\n#5  push_inherent_candidates_from_self (self=<optimized out>, restrict_to=..., rcvr_ty=...) at src/librustc/middle/typeck/check/method.rs:498\n#6  rustc::middle::typeck::check::method::LookupContext<'a>::push_bound_candidates (self=<optimized out>, restrict_to=..., self_ty=...) at src/librustc/middle/typeck/check/method.rs:364\n#7  0x00007ffff39625b7 in rustc::middle::typeck::check::method::lookup (fcx=0x7fffecc18a60, expr=<optimized out>, self_expr=<optimized out>, m_name=<optimized out>, deref_args=<optimized out>, \n    check_traits=<optimized out>, autoderef_receiver=<optimized out>, self_ty=..., supplied_tps=...) at src/librustc/middle/typeck/check/method.rs:164\n#8  0x00007ffff39a11af in trans_if (fcx=<optimized out>, ast_ty=<optimized out>, expr=<optimized out>, method_name=..., method_name=..., method_name=..., bcx=<optimized out>, \n    if_id=<optimized out>, cond=<optimized out>, thn=<optimized out>, els=..., dest=...) at src/librustc/middle/typeck/check/mod.rs:1921\n#9  rustc::middle::typeck::check::check_expr_with_unifier (fcx=0x7fffecc18a60, expr=0x7fffec25f8c0, expected=..., lvalue_pref=<optimized out>, unifier=<optimized out>)\n    at src/librustc/middle/typeck/check/mod.rs:2976\n#10 0x00007ffff397fae8 in rustc::middle::typeck::check::check_block_with_expected (fcx=0x7fffecc18a60, blk=0x7fffec25f980, expected=...) at src/librustc/middle/typeck/check/mod.rs:1411\n#11 0x00007ffff397be11 in rustc::middle::typeck::check::check_fn (ccx=0x7fffec0848c0, body=0x7fffec25f980, fn_kind=Vanilla, inherited=0x7fffecba4c00, purity=<optimized out>, \n    fn_sig=<optimized out>, decl=<optimized out>, id=<optimized out>) at src/librustc/middle/typeck/check/mod.rs:490\n#12 0x00007ffff397b6bb in rustc::middle::typeck::check::check_bare_fn (ccx=0x7fffec0848c0, decl=0x7fffec1100b0, body=0x7fffec25f980, id=2447, param_env=..., fty=...)\n    at src/librustc/middle/typeck/check/mod.rs:330\n#13 0x00007ffff39766da in rustc::middle::typeck::check::check_item (ccx=0x7fffec0848c0, it=<optimized out>) at src/librustc/middle/typeck/check/mod.rs:575\n#14 0x00007ffff397a460 in visit::walk_decl::h9cf355b08c4aabd1K1n::v0.10.pre () at src/librustc/middle/typeck/check/mod.rs:311\n#15 0x00007ffff397a37e in visit::walk_stmt::h5901a3f261b3e26dy0n::v0.10.pre () at src/librustc/middle/typeck/check/mod.rs:312\n#16 0x00007ffff397a113 in visit::walk_block::h45c060989eb1a99ftWn::v0.10.pre () at src/librustc/middle/typeck/check/mod.rs:312\n#17 0x00007ffff397abbf in visit::walk_fn::he7254c7311eedc6e1ao::v0.10.pre () at src/librustc/middle/typeck/check/mod.rs:312\n#18 0x00007ffff397b238 in visit::walk_method_helper::he88096d2d7de079fQfq::v0.10.pre () at src/librustc/middle/typeck/check/mod.rs:312\n#19 0x00007ffff3978625 in visit::walk_item::h0447c6568c46391bN1p::v0.10.pre () at src/librustc/middle/typeck/check/mod.rs:312\n#20 0x00007ffff397b4b4 in rustc::middle::typeck::check::check_item_types (ccx=0x7fffec0848c0, krate=<optimized out>) at src/librustc/middle/typeck/check/mod.rs:311\n#21 0x00007ffff3a695fc in rustc::util::common::time<(),()> (what=..., do_it=<optimized out>, u=<optimized out>, f=<optimized out>) at src/librustc/util/common.rs:25\n#22 0x00007ffff3a684b7 in rustc::middle::typeck::check_crate (tcx=0x7fffec2b1b90, krate=0x7ffff1f763c0, trait_map=...) at src/librustc/middle/typeck/mod.rs:463\n#23 0x00007ffff3da21fa in rustc::driver::driver::phase_3_run_analysis_passes (sess=0x7fffec00ad00, krate=0x7ffff1f763c0, ast_map=...) at src/librustc/driver/driver.rs:316\n#24 0x00007ffff3daa32f in rustc::driver::driver::compile_input (sess=0x7fffec00ad00, cfg=..., input=<optimized out>, outdir=<optimized out>, output=<optimized out>)\n    at src/librustc/driver/driver.rs:573\n#25 0x00007ffff3dcefe5 in rustc::run_compiler (args=...) at src/librustc/lib.rs:339\n#26 0x00007ffff3ddef5d in fn91262 () at src/librustc/lib.rs:426\n#27 0x00007ffff3ddd622 in fn91110 () at src/librustc/lib.rs:388\n#28 0x00007ffff3dd958b in task::TaskBuilder::try::closure () at src/librustc/lib.rs:374\n#29 0x00007ffff319517c in fn7303 () at src/libnative/task.rs:103\n#30 0x00007ffff7756588 in fn42893 () at src/libstd/unstable/finally.rs:45\n#31 try_finally<(),(),()> (mutate=<optimized out>, drop=<optimized out>, try_fn=<optimized out>, finally_fn=<optimized out>) at src/libstd/unstable/finally.rs:99\n#32 finally (self=0xf000007ffff55187, dtor=<optimized out>) at src/libstd/unstable/finally.rs:44\n#33 fn42888 () at src/libstd/rt/task.rs:128\n#34 0x00007ffff776031c in rust_try () from /usr/lib/libstd-31b43f22-0.10-pre.so\n#35 0x00007ffff77564f1 in std::rt::task::Task::run (self=<optimized out>, f={void (void)} 0x7ffff1f77b98) at src/libstd/rt/local.rs:30\n#36 0x00007ffff3195003 in fn7279 () at src/libnative/task.rs:103\n#37 0x00007ffff7759d24 in rt::thread::thread_start::h9d943e1fec71bd92kSc::v0.10.pre () at src/libstd/rt/thread.rs:48\n#38 0x00007ffff26a30a2 in start_thread () from /usr/lib/libpthread.so.0\n#39 0x00007ffff2ea2d1d in clone () from /usr/lib/libc.so.6\n```\n", "closed_by": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/12796/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/12796/timeline", "performed_via_github_app": null, "state_reason": "completed"}