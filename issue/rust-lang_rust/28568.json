{"url": "https://api.github.com/repos/rust-lang/rust/issues/28568", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/28568/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/28568/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/28568/events", "html_url": "https://github.com/rust-lang/rust/issues/28568", "id": 107552905, "node_id": "MDU6SXNzdWUxMDc1NTI5MDU=", "number": 28568, "title": "rustc crashes on multiple Drop implementations", "user": {"login": "larsluthman", "id": 12979830, "node_id": "MDQ6VXNlcjEyOTc5ODMw", "avatar_url": "https://avatars.githubusercontent.com/u/12979830?v=4", "gravatar_id": "", "url": "https://api.github.com/users/larsluthman", "html_url": "https://github.com/larsluthman", "followers_url": "https://api.github.com/users/larsluthman/followers", "following_url": "https://api.github.com/users/larsluthman/following{/other_user}", "gists_url": "https://api.github.com/users/larsluthman/gists{/gist_id}", "starred_url": "https://api.github.com/users/larsluthman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/larsluthman/subscriptions", "organizations_url": "https://api.github.com/users/larsluthman/orgs", "repos_url": "https://api.github.com/users/larsluthman/repos", "events_url": "https://api.github.com/users/larsluthman/events{/privacy}", "received_events_url": "https://api.github.com/users/larsluthman/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}, {"id": 262252628, "node_id": "MDU6TGFiZWwyNjIyNTI2Mjg=", "url": "https://api.github.com/repos/rust-lang/rust/labels/regression-from-stable-to-beta", "name": "regression-from-stable-to-beta", "color": "e4008a", "default": false, "description": "Performance or correctness regression from stable to beta."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2015-09-21T16:48:29Z", "updated_at": "2015-09-28T15:41:22Z", "closed_at": "2015-09-28T15:41:22Z", "author_association": "NONE", "active_lock_reason": null, "body": "When I run 'RUST_BACKTRACE=1 rustc foo.rs', with foo.rs containing the following:\n\nstruct MyStruct;\n\nimpl Drop for MyStruct {\n    fn drop(&mut self) { }\n}\n\nimpl Drop for MyStruct {\n    fn drop(&mut self) { }\n}\n\nfn main() {\n}\n\n...I expected a compiler error about multiple implementations of drop(). Instead I get a compiler panic and the following output:\n\nerror: internal compiler error: unexpected panic\nnote: the compiler unexpectedly panicked. this is a bug.\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports\nthread 'rustc' panicked at 'assertion failed: self.destructor.get().is_none()', ../src/librustc/middle/ty/mod.rs:1684\n\nstack backtrace:\n   1: 0xb723e449 - sys::backtrace::tracing::imp::write::h085f7b472bdb7297Rnt\n   2: 0xb723b6bf - panicking::on_panic::h89c5c4c01688e08cgnx\n   3: 0xb7202e23 - sys_common::unwind::begin_unwind_inner::hcaa8ef8e2210f86chfs\n   4: 0xb6052601 - sys_common::unwind::begin_unwind::h9342686479312802844\n   5: 0xb633e96d - middle::ty::AdtDefData<'tcx, 'container>::set_destructor::hc39ceba34109a38dZGe\n   6: 0xb6a8a0f3 - coherence::CoherenceChecker<'a, 'tcx>::populate_destructor_table::closure.44055\n   7: 0xb6a90ee3 - coherence::check_coherence::hae12661916868a12n4C\n   8: 0xb6a9d104 - check_crate::hba514200a78ba2f3FCE\n   9: 0xb75620b5 - driver::phase_3_run_analysis_passes::closure.21543\n  10: 0xb7545811 - middle::ty::context::ctxt<'tcx>::create_and_enter::h11415694699603886574\n  11: 0xb7541524 - driver::phase_3_run_analysis_passes::h11116205042524445881\n  12: 0xb7521599 - driver::compile_input::ha7ff5949919f299b0ba\n  13: 0xb7686544 - run_compiler::hc11b6c37dcd9098cqqc\n  14: 0xb76837af - boxed::F.FnBox<A>::call_box::h9540525210634565514\n  15: 0xb76830c8 - sys_common::unwind::try::try_fn::h6749527944362526960\n  16: 0xb723af34 - __rust_try\n  17: 0xb722f1ae - sys_common::unwind::try::inner_try::h102b27a29a2e39d3Fbs\n  18: 0xb7683267 - boxed::F.FnBox<A>::call_box::h14988572331710300946\n  19: 0xb72442f9 - sys::thread::Thread::new::thread_start::ha79ffc4a0b00ec55fGw\n  20: 0xb35e4efa - start_thread\n  21: 0xb70d062d - clone\n  22:        0x0 - <unknown>\n\nReporting the bug as the compiler asked me to do.\n", "closed_by": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/28568/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/28568/timeline", "performed_via_github_app": null, "state_reason": "completed"}