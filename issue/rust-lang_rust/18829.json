{"url": "https://api.github.com/repos/rust-lang/rust/issues/18829", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/18829/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/18829/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/18829/events", "html_url": "https://github.com/rust-lang/rust/issues/18829", "id": 48232800, "node_id": "MDU6SXNzdWU0ODIzMjgwMA==", "number": 18829, "title": "ICE comparing unsized type as raw pointer", "user": {"login": "murarth", "id": 1332722, "node_id": "MDQ6VXNlcjEzMzI3MjI=", "avatar_url": "https://avatars.githubusercontent.com/u/1332722?v=4", "gravatar_id": "", "url": "https://api.github.com/users/murarth", "html_url": "https://github.com/murarth", "followers_url": "https://api.github.com/users/murarth/followers", "following_url": "https://api.github.com/users/murarth/following{/other_user}", "gists_url": "https://api.github.com/users/murarth/gists{/gist_id}", "starred_url": "https://api.github.com/users/murarth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/murarth/subscriptions", "organizations_url": "https://api.github.com/users/murarth/orgs", "repos_url": "https://api.github.com/users/murarth/repos", "events_url": "https://api.github.com/users/murarth/events{/privacy}", "received_events_url": "https://api.github.com/users/murarth/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}, {"id": 125141240, "node_id": "MDU6TGFiZWwxMjUxNDEyNDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-dst", "name": "A-dst", "color": "f7e101", "default": false, "description": "Area: Dynamically Sized Types"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2014-11-10T06:05:45Z", "updated_at": "2015-09-07T01:16:44Z", "closed_at": "2015-09-07T01:16:44Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Attempting to cast `&str` or a slice to a raw pointer results in a proper error message. Attempting to compare two such invalid casts, however, generates an ICE.\n(And I realize now that `.as_ptr()` is the right way to do what I was trying to do.)\n\n``` rust\nfn main() {\n    let a: &[i32] = &[];\n    (a as *const _) == (a as *const _);\n    (\"\" as *const _) == (\"\" as *const _);\n}\n```\n\nResults in:\n\n```\nerror: internal compiler error: unexpected panic\nnote: the compiler unexpectedly panicked. this is a bug.\nnote: we would appreciate a bug report: http://doc.rust-lang.org/complement-bugreport.html\nnote: run with `RUST_BACKTRACE=1` for a backtrace\ntask 'rustc' panicked at 'assertion failed: self.appropriate_rvalue_mode(bcx.ccx()) == ByValue', /home/rustbuild/src/rust-buildbot/slave/nightly-linux/build/src/librustc/middle/trans/datum.rs:644\n\nstack backtrace:\n   1:     0x7f2610acd880 - rt::backtrace::imp::write::h7a90f4ef1aa5a81fsbq\n   2:     0x7f2610ad0900 - failure::on_fail::he9ef851a069b43543wq\n   3:     0x7f2615036d40 - unwind::begin_unwind_inner::ha2afab22d4dc49ed8Rd\n   4:     0x7f261567bb30 - unwind::begin_unwind::h15560861862153460913\n   5:     0x7f2615a1eb20 - middle::trans::datum::Datum<K>::to_llscalarish::h5300527991557390520\n   6:     0x7f2615a3f650 - middle::trans::expr::trans_binary::h6c193beb06d7e93dcG7\n   7:     0x7f2615a34ab0 - middle::trans::expr::trans_unadjusted::h02c4b8f1c6b87a22SZ5\n   8:     0x7f26159fbac0 - middle::trans::expr::trans_into::h4971d03ccde714e0Ue5\n   9:     0x7f26159faf20 - middle::trans::controlflow::trans_stmt_semi::h8fa1003152ba3849Gu1\n  10:     0x7f26159fa4d0 - middle::trans::controlflow::trans_stmt::h98ee011c11c8d6d8tq1\n  11:     0x7f26159fbee0 - middle::trans::controlflow::trans_block::h9afd935ec02d5d88zv1\n  12:     0x7f2615a9e510 - middle::trans::base::trans_closure::h3e4483ae2d8e884bAGh\n  13:     0x7f26159ef140 - middle::trans::base::trans_fn::h7f9774a3926fbf34nSh\n  14:     0x7f26159ec9a0 - middle::trans::base::trans_item::h07f36bd67b211f81Bbi\n  15:     0x7f2615aa8ce0 - middle::trans::base::trans_crate::hda78095df6dfa8bfC9i\n  16:     0x7f2615efa840 - driver::driver::phase_4_translate_to_llvm::h3f7adb4e900158acqyC\n  17:     0x7f2615ef16e0 - driver::driver::compile_input::h1c18718eb06a01d2k5B\n  18:     0x7f2615f744e0 - driver::run_compiler::hcc1eba405fd576deBVF\n  19:     0x7f2615f743d0 - driver::run::closure.146438\n  20:     0x7f26156b0c20 - task::TaskBuilder<S>::try_future::closure.104848\n  21:     0x7f26156b0a10 - task::TaskBuilder<S>::spawn_internal::closure.104819\n  22:     0x7f261537d540 - task::NativeSpawner.Spawner::spawn::closure.8448\n  23:     0x7f261508bc50 - rust_try_inner\n  24:     0x7f261508bc40 - rust_try\n  25:     0x7f26150346c0 - unwind::try::h2eeb8f95c58da3ccQGd\n  26:     0x7f2615034550 - task::Task::run::hcb23459dab25134dGMc\n  27:     0x7f261537d280 - task::NativeSpawner.Spawner::spawn::closure.8386\n  28:     0x7f2615035d60 - thread::thread_start::h033f0420ecdbeed0V7c\n  29:     0x7f260fe7d0c0 - start_thread\n  30:     0x7f2614cfff89 - __clone\n  31:                0x0 - <unknown>\n```\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/18829/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/18829/timeline", "performed_via_github_app": null, "state_reason": "completed"}