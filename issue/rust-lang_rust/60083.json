{"url": "https://api.github.com/repos/rust-lang/rust/issues/60083", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/60083/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/60083/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/60083/events", "html_url": "https://github.com/rust-lang/rust/issues/60083", "id": 434859596, "node_id": "MDU6SXNzdWU0MzQ4NTk1OTY=", "number": 60083, "title": "[mini RFC] add a new human-sorted message-format for cargo test", "user": {"login": "adamchalmers", "id": 5407457, "node_id": "MDQ6VXNlcjU0MDc0NTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5407457?v=4", "gravatar_id": "", "url": "https://api.github.com/users/adamchalmers", "html_url": "https://github.com/adamchalmers", "followers_url": "https://api.github.com/users/adamchalmers/followers", "following_url": "https://api.github.com/users/adamchalmers/following{/other_user}", "gists_url": "https://api.github.com/users/adamchalmers/gists{/gist_id}", "starred_url": "https://api.github.com/users/adamchalmers/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/adamchalmers/subscriptions", "organizations_url": "https://api.github.com/users/adamchalmers/orgs", "repos_url": "https://api.github.com/users/adamchalmers/repos", "events_url": "https://api.github.com/users/adamchalmers/events{/privacy}", "received_events_url": "https://api.github.com/users/adamchalmers/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 630652267, "node_id": "MDU6TGFiZWw2MzA2NTIyNjc=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-feature-request", "name": "C-feature-request", "color": "f5f1fd", "default": false, "description": "Category: A feature request, i.e: not implemented / a PR."}, {"id": 630810559, "node_id": "MDU6TGFiZWw2MzA4MTA1NTk=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-libtest", "name": "A-libtest", "color": "f7e101", "default": false, "description": "Area: #[test] related"}, {"id": 1089771154, "node_id": "MDU6TGFiZWwxMDg5NzcxMTU0", "url": "https://api.github.com/repos/rust-lang/rust/labels/needs-rfc", "name": "needs-rfc", "color": "fceb9f", "default": false, "description": "This change is large or controversial enough that it should have an (e-)RFC accepted before doing it"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-04-18T16:39:41Z", "updated_at": "2019-04-22T16:55:23Z", "closed_at": null, "author_association": "NONE", "active_lock_reason": null, "body": "I run `cargo test` from the command line many times every day, always with the default `--message-format human` value. Usually, I have a quick scan through the list of test cases and look for any red FAILED text. \r\n\r\nI have three very minor annoyances about the `human` message format:\r\n\r\n1. The list of tests isn't ordered by test name. This makes it hard to see at a glance if the failures are in one module or many. \r\n2. The list of tests aren't ordered by pass/fail. This means I have to read through every line to see which tests failed. It also means if you have more tests than terminal rows, you have to scroll to find all the failing tests. \r\n3. The green pass/red fail text is on the very end of the line, meaning it never lines up. Because each line is variable width (due to each test name having a variable length), I can't just glance my eyes down a column of text. My eyes have to dart around from column to column.\r\n\r\nThese are really minor issues, but they slow down my reading comprehension. Given how often I read the `cargo test` output every day, it might be worth improving its glanceability.\r\n\r\n**Suggested solution 0**\r\nDo nothing. If users want to see failures more easily, they can just read through the more detailed failure output that each failed test outputs. This is a reasonable response. However, given that the summarized list of each test and its pass/fail status exists, I feel it should be as readable as possible.\r\n\r\n**Suggested solution 1**\r\n\r\nAdd a new format flag, `--message-format human-sorted` which is identical to `--message-format human` except for these changes:\r\n\r\n1. List of tests is ordered by pass/fail status, then by test name. This way, all failing tests are listed towards the end of the output (so users don't have to scroll their terminal), and tests from the same module will be next to each other (so users can tell which modules are failing).\r\n2. Pass/fail status appears at the start of the line rather than the end. This way, users can just scan their eyes down a single aligned column of text, instead of needing to move their eyes in a diagonal down-left down-right way.\r\n\r\nHere is an example of `--message-format human` output\r\n```\r\nrunning 33 tests\r\ntest config::tests::test_cloudflared_args ... ok\r\ntest config::tests::test_contains_duplicate ... ok\r\ntest monitor::poll::tests::test_event_into_fail ... ok\r\ntest monitor::poll::tests::test_event_into_happened ... ok\r\ntest monitor::poll::tests::test_event_into_wait ... ok\r\ntest monitor::poll::tests::test_event_to_option ... ok\r\ntest monitor::poll::tests::test_poll_always_succeed ... ok\r\ntest monitor::poll::tests::test_poll_always_wait ... ok\r\ntest monitor::poll::tests::test_poll_zero_timeout_wait ... ok\r\ntest monitor::poll::tests::test_trimap ... ok\r\ntest monitor::report::tests::test_fail_report_sentry_message ... ok\r\ntest monitor::report::tests::test_fail_report_sentry_tags ... ok\r\ntest monitor::tunnelchecker::tests::test_cname ... ok\r\ntest monitor::tunnelchecker::tests::test_count_active_conns ... ok\r\ntest monitor::tunnelchecker::tests::test_count_active_conns_malformed ... ok\r\ntest monitor::tunnelchecker::tests::test_count_active_conns_no_conns ... ok\r\ntest monitor::tunnelchecker::tests::test_count_active_conns_one_unregistered ... ok\r\ntest monitor::tunnelchecker::tests::test_is_lb ... ok\r\ntest monitor::tunnelchecker::tests::test_parse_tunnel_alphanumeric ... ok\r\ntest monitor::tunnelchecker::tests::test_parse_tunnel_ids_many_lines ... ok\r\ntest monitor::tunnelchecker::tests::test_parse_tunnel_ids_no_matches ... ok\r\ntest monitor::tunnelchecker::tests::test_parse_tunnel_ids_single_line ... ok\r\ntest monitor::tunnelchecker::tests::test_parse_tunnel_non_alphanumeric ... ok\r\ntest monitor::tunnelchecker::tests::test_parse_tunnel_reg_fail_many_lines ... ok\r\ntest monitor::tunnelchecker::tests::test_parse_tunnel_reg_fail_no_matches ... ok\r\ntest monitor::tunnelchecker::tests::test_parse_tunnel_reg_fail_with_success_line ... ok\r\ntest monitor::tunnelchecker::tests::test_parse_tunnel_reg_success ... ok\r\ntest monitor::tunnelchecker::tests::test_register_tunnel_fail_response ... ok\r\ntest monitor::tunnelchecker::tests::test_register_tunnel_timeout ... ok\r\ntest monitor::tunnelstarter::tests::test_cloudflared_cli_args ... ok\r\ntest monitor::tunnelstarter::tests::test_parse_hostname_fail ... ok\r\ntest monitor::tunnelstarter::tests::test_parse_hostname_success ... ok\r\n```\r\n\r\nAnd here is the same test output but with `--message-format human-sorted` output:\r\n```\r\nrunning 33 tests\r\nok ... test config::tests::test_cloudflared_args \r\nok ... test config::tests::test_contains_duplicate \r\nok ... test monitor::poll::tests::test_event_into_fail \r\nok ... test monitor::poll::tests::test_event_into_happened \r\nok ... test monitor::poll::tests::test_event_into_wait \r\nok ... test monitor::poll::tests::test_event_to_option\r\nok ... test monitor::poll::tests::test_poll_always_wait \r\nok ... test monitor::poll::tests::test_poll_zero_timeout_wait \r\nok ... test monitor::poll::tests::test_trimap \r\nok ... test monitor::report::tests::test_fail_report_sentry_tags \r\nok ... test monitor::tunnelchecker::tests::test_cname \r\nok ... test monitor::tunnelchecker::tests::test_count_active_conns \r\nok ... test monitor::tunnelchecker::tests::test_count_active_conns_malformed \r\nok ... test monitor::tunnelchecker::tests::test_count_active_conns_no_conns \r\nok ... test monitor::tunnelchecker::tests::test_count_active_conns_one_unregistered \r\nok ... test monitor::tunnelchecker::tests::test_is_lb \r\nok ... test monitor::tunnelchecker::tests::test_parse_tunnel_alphanumeric \r\nok ... test monitor::tunnelchecker::tests::test_parse_tunnel_ids_many_lines \r\nok ... test monitor::tunnelchecker::tests::test_parse_tunnel_ids_no_matches \r\nok ... test monitor::tunnelchecker::tests::test_parse_tunnel_ids_single_line \r\nok ... test monitor::tunnelchecker::tests::test_parse_tunnel_non_alphanumeric \r\nok ... test monitor::tunnelchecker::tests::test_parse_tunnel_reg_fail_many_lines \r\nok ... test monitor::tunnelchecker::tests::test_parse_tunnel_reg_fail_no_matches \r\nok ... test monitor::tunnelchecker::tests::test_parse_tunnel_reg_fail_with_success_line \r\nok ... test monitor::tunnelchecker::tests::test_parse_tunnel_reg_success \r\nok ... test monitor::tunnelchecker::tests::test_register_tunnel_fail_response \r\nok ... test monitor::tunnelchecker::tests::test_register_tunnel_timeout \r\nok ... test monitor::tunnelstarter::tests::test_cloudflared_cli_args \r\nok ... test monitor::tunnelstarter::tests::test_parse_hostname_fail \r\nFAILED ... test monitor::poll::tests::test_poll_always_succeed \r\nFAILED ... test monitor::report::tests::test_fail_report_sentry_message \r\nFAILED ... test monitor::tunnelstarter::tests::test_parse_hostname_success \r\n```\r\n\r\nI personally think this format is much more readable. It requires less eye motion and less scrolling (in the event that the list of tests doesn't fit in your terminal height). I would be happy to implement this change if the community thought it was helpful. I'd suggest keeping `human` as the default value for `--message-format` and adding `human-sorted` as an alternative, to avoid breaking anyone's code that relies on the current default format.\r\n", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/60083/reactions", "total_count": 8, "+1": 8, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/60083/timeline", "performed_via_github_app": null, "state_reason": null}