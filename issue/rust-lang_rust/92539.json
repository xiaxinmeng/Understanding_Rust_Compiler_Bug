{"url": "https://api.github.com/repos/rust-lang/rust/issues/92539", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/92539/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/92539/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/92539/events", "html_url": "https://github.com/rust-lang/rust/issues/92539", "id": 1092826074, "node_id": "I_kwDOAAsO6M5BIzPa", "number": 92539, "title": "`rustc_driver.dll` size on `x86_64-pc-windows-gnu` toolchain", "user": {"login": "davidhewitt", "id": 1939362, "node_id": "MDQ6VXNlcjE5MzkzNjI=", "avatar_url": "https://avatars.githubusercontent.com/u/1939362?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidhewitt", "html_url": "https://github.com/davidhewitt", "followers_url": "https://api.github.com/users/davidhewitt/followers", "following_url": "https://api.github.com/users/davidhewitt/following{/other_user}", "gists_url": "https://api.github.com/users/davidhewitt/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidhewitt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidhewitt/subscriptions", "organizations_url": "https://api.github.com/users/davidhewitt/orgs", "repos_url": "https://api.github.com/users/davidhewitt/repos", "events_url": "https://api.github.com/users/davidhewitt/events{/privacy}", "received_events_url": "https://api.github.com/users/davidhewitt/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2022-01-03T21:17:06Z", "updated_at": "2022-01-05T19:11:07Z", "closed_at": "2022-01-05T18:43:01Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I noticed that the size of `rustc_driver.dll` for the windows `x86_64-pc-windows-gnu` toolchain seems suprisingly large compared to the `x86-64-pc-windows-msvc` toolchain. It's also been growing quickly in recent releases.\r\n\r\nSee chart below comparing the size of `rustc_driver.dll` for these two targets for stable releases since 1.40:\r\n\r\n![chart](https://user-images.githubusercontent.com/1939362/147978025-611f5e09-7359-43f5-a375-655a81037149.png)\r\n\r\nSome size difference is obviously expected, however the huge jump around Rust 1.54 (slightly over doubling of the file size) looks suspect.\r\n\r\nBisecting on nightlies around that time, it looks like the jump happened in nightly 2021-06-05:\r\n\r\n| nightly | `x86_64-pc-windows-gnu` rustc_driver size (bytes) | \r\n| ------- | -------------------------- |\r\n| 2021-06-03 | 199015985 |\r\n| 2021-06-04 | 199027556 |\r\n| 2021-06-05 | 442938696 |\r\n| 2021-06-06 | 442876820 |\r\n\r\nI've recently been working in an environment where the file size matters. I don't know much about the compiler packaging process, however I'd be happy to help investigate and (if possible) undo this jump in file size, with the help of someone willing to guide me where to look.\r\n\r\nSo far, I started out by looking at [PRs merged on 2021-06-04](https://github.com/rust-lang/rust/pulls?q=is%3Apr+is%3Aclosed+merged%3A2021-06-04) (i.e. the day before the size bump).\r\n\r\nThe only PR that stands out to me as potentially affecting file size is #84449. I am wildly speculating; this could be a red herring. I'm going to investigate this a little further. Input from others more knowledgeable than myself is very welcome!\r\n", "closed_by": {"login": "davidhewitt", "id": 1939362, "node_id": "MDQ6VXNlcjE5MzkzNjI=", "avatar_url": "https://avatars.githubusercontent.com/u/1939362?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidhewitt", "html_url": "https://github.com/davidhewitt", "followers_url": "https://api.github.com/users/davidhewitt/followers", "following_url": "https://api.github.com/users/davidhewitt/following{/other_user}", "gists_url": "https://api.github.com/users/davidhewitt/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidhewitt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidhewitt/subscriptions", "organizations_url": "https://api.github.com/users/davidhewitt/orgs", "repos_url": "https://api.github.com/users/davidhewitt/repos", "events_url": "https://api.github.com/users/davidhewitt/events{/privacy}", "received_events_url": "https://api.github.com/users/davidhewitt/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/92539/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/92539/timeline", "performed_via_github_app": null, "state_reason": "completed"}