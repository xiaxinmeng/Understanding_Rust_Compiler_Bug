{"url": "https://api.github.com/repos/rust-lang/rust/issues/24188", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/24188/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/24188/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/24188/events", "html_url": "https://github.com/rust-lang/rust/issues/24188", "id": 67062406, "node_id": "MDU6SXNzdWU2NzA2MjQwNg==", "number": 24188, "title": "Collapse cross-crate macros in error backtraces", "user": {"login": "huonw", "id": 1203825, "node_id": "MDQ6VXNlcjEyMDM4MjU=", "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4", "gravatar_id": "", "url": "https://api.github.com/users/huonw", "html_url": "https://github.com/huonw", "followers_url": "https://api.github.com/users/huonw/followers", "following_url": "https://api.github.com/users/huonw/following{/other_user}", "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}", "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/huonw/subscriptions", "organizations_url": "https://api.github.com/users/huonw/orgs", "repos_url": "https://api.github.com/users/huonw/repos", "events_url": "https://api.github.com/users/huonw/events{/privacy}", "received_events_url": "https://api.github.com/users/huonw/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 235791, "node_id": "MDU6TGFiZWwyMzU3OTE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-diagnostics", "name": "A-diagnostics", "color": "f7e101", "default": false, "description": "Area: Messages for errors, warnings, and lints"}, {"id": 132910982, "node_id": "MDU6TGFiZWwxMzI5MTA5ODI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-macros", "name": "A-macros", "color": "f7e101", "default": false, "description": "Area: All kinds of macros (custom derive, macro_rules!, proc macros, ..)"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2015-04-08T06:47:38Z", "updated_at": "2016-12-01T17:39:21Z", "closed_at": "2016-12-01T17:39:21Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Errors inside macros currently get some serious and intimidating compiler-spew, e.g.\n\n``` rust\nfn main() {\n    println!(\"{}\", () + 1);\n}\n```\n\ngives\n\n```\n<anon>:2:20: 2:24 error: binary operation `+` cannot be applied to type `()` [E0369]\n<anon>:2     println!(\"{}\", () + 1);\n                            ^~~~\nnote: in expansion of format_args!\n<std macros>:2:25: 2:58 note: expansion site\n<std macros>:1:1: 2:62 note: in expansion of print!\n<std macros>:3:1: 3:54 note: expansion site\n<std macros>:1:1: 3:58 note: in expansion of println!\n<anon>:2:5: 2:28 note: expansion site\n```\n\nMost of the `<std macros>` lines are useless, as they're talking about implementation details of `println!` that the user has no control over (the macro is defined in another crate) and almost certainly doesn't care about. It would be much nicer if they were just collapsed to only print the outer call:\n\n```\n<anon>:2:20: 2:24 error: binary operation `+` cannot be applied to type `()` [E0369]\n<anon>:2     println!(\"{}\", () + 1);\n                            ^~~~\nnote: in expansion of println!\n<anon>:2:5: 2:28 note: expansion site\n```\n\nThere's a few edge-cases I can think of:\n- someone working on their own macros and testing/using them in another crate may still be interested in the full backtrace. We could print the full trace if `--verbose` is passed.\n- macros that call other macros may result in interleaved cross-crate and intra-crate macros, presumably this is addressed by only collapsing _contiguous_ sequences of cross-crate macros\n", "closed_by": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/24188/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/24188/timeline", "performed_via_github_app": null, "state_reason": "completed"}