{"url": "https://api.github.com/repos/rust-lang/rust/issues/22894", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/22894/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/22894/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/22894/events", "html_url": "https://github.com/rust-lang/rust/issues/22894", "id": 59341575, "node_id": "MDU6SXNzdWU1OTM0MTU3NQ==", "number": 22894, "title": "ICE: const expr(8: &*\"\") of type &'static str has size 8 instead of 16", "user": {"login": "rprichard", "id": 1572855, "node_id": "MDQ6VXNlcjE1NzI4NTU=", "avatar_url": "https://avatars.githubusercontent.com/u/1572855?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rprichard", "html_url": "https://github.com/rprichard", "followers_url": "https://api.github.com/users/rprichard/followers", "following_url": "https://api.github.com/users/rprichard/following{/other_user}", "gists_url": "https://api.github.com/users/rprichard/gists{/gist_id}", "starred_url": "https://api.github.com/users/rprichard/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rprichard/subscriptions", "organizations_url": "https://api.github.com/users/rprichard/orgs", "repos_url": "https://api.github.com/users/rprichard/repos", "events_url": "https://api.github.com/users/rprichard/events{/privacy}", "received_events_url": "https://api.github.com/users/rprichard/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2015-02-28T13:21:27Z", "updated_at": "2016-08-08T18:29:29Z", "closed_at": "2016-08-08T18:29:28Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Test case:\n\n```\n#[allow(dead_code)]\nstatic X: &'static str = &*\"\";\nfn main() {}\n```\n\nOutput:\n\n```\n$ RUST_BACKTRACE=1 rustc test.rs  -O \n@ref8 = internal unnamed_addr constant %str_slice { i8* getelementptr inbounds ([0 x i8]* @str954, i32 0, i32 0), i64 0 }\n{ i8*, i8* } undef\nerror: internal compiler error: const expr(8: &*\"\") of type &'static str has size 8 instead of 16\nnote: the compiler unexpectedly panicked. this is a bug.\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports\nnote: run with `RUST_BACKTRACE=1` for a backtrace\nthread 'rustc' panicked at 'Box<Any>', /home/rustbuild/src/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libsyntax/diagnostic.rs:189\n\nstack backtrace:\n   1:         0x2c97f720 - sys::backtrace::write::h66f3f2784d0f6c5ddgA\n   2:         0x2c9a7b80 - panicking::on_panic::h6fdde9e4e9166fe6jaJ\n   3:         0x2c8e7c30 - rt::unwind::begin_unwind_inner::hba10c536ef2aae75MQI\n   4:         0x29bf70c0 - rt::unwind::begin_unwind::h11287547919384241778\n   5:         0x29bf7880 - diagnostic::Handler::bug::hcd811e06453c2215AHD\n   6:         0x2a92f0e0 - session::Session::bug::h6899b8b34aff4289tjp\n   7:         0x2b684c80 - trans::consts::const_expr::h035f67d1634baae2etn\n   8:         0x2b5bdee0 - trans::base::get_item_val::h6996afac4f0d2cd8zdu\n   9:         0x2b687ae0 - trans::consts::trans_static::h8a306b81be8d489c68n\n  10:         0x2b5bbbf0 - trans::base::trans_item::h84b885e418e4a555QIt\n  11:         0x2b6a49c0 - trans::base::trans_crate::h42b5704fc939dd15qEu\n  12:         0x2d005970 - driver::phase_4_translate_to_llvm::h73df038fa8e4514eqNa\n  13:         0x2cfdfec0 - driver::compile_input::h0de317319ab5c701Hba\n  14:         0x2d0aae20 - run_compiler::hffa0c0711e361de8E5b\n  15:         0x2d0a9720 - thunk::F.Invoke<A, R>::invoke::h12673221910893163557\n  16:         0x2d0a8610 - rt::unwind::try::try_fn::h15130568597725528481\n  17:         0x2ca13740 - rust_try_inner\n  18:         0x2ca13730 - rust_try\n  19:         0x2d0a8910 - thunk::F.Invoke<A, R>::invoke::h3924406537784056782\n  20:         0x2c993990 - sys::thread::thread_start::h3734be2229bd3edegEE\n  21:         0x268bb0c0 - start_thread\n  22:         0x2c560449 - __clone\n  23:                0x0 - <unknown>\n```\n\nCompiler version:\n\n```\nrustc 1.0.0-nightly (b47aebe3f 2015-02-26) (built 2015-02-27)\nbinary: rustc\ncommit-hash: b47aebe3fc2da06c760fd8ea19f84cbc41d34831\ncommit-date: 2015-02-26\nbuild-date: 2015-02-27\nhost: x86_64-unknown-linux-gnu\nrelease: 1.0.0-nightly\n```\n\nThis issue has a similar error to that in #20074, but it's not clear to me that it's the same issue.  The types involved are different, as are the mismatched size values.  I'm also unable to reproduce that issue's failure -- maybe it's fixed already?\n", "closed_by": {"login": "steveklabnik", "id": 27786, "node_id": "MDQ6VXNlcjI3Nzg2", "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/steveklabnik", "html_url": "https://github.com/steveklabnik", "followers_url": "https://api.github.com/users/steveklabnik/followers", "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}", "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}", "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions", "organizations_url": "https://api.github.com/users/steveklabnik/orgs", "repos_url": "https://api.github.com/users/steveklabnik/repos", "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}", "received_events_url": "https://api.github.com/users/steveklabnik/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/22894/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/22894/timeline", "performed_via_github_app": null, "state_reason": "completed"}