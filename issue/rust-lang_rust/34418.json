{"url": "https://api.github.com/repos/rust-lang/rust/issues/34418", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/34418/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/34418/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/34418/events", "html_url": "https://github.com/rust-lang/rust/issues/34418", "id": 161815056, "node_id": "MDU6SXNzdWUxNjE4MTUwNTY=", "number": 34418, "title": "cannot end function with item-generating macro invoked with curly braces", "user": {"login": "durka", "id": 47007, "node_id": "MDQ6VXNlcjQ3MDA3", "avatar_url": "https://avatars.githubusercontent.com/u/47007?v=4", "gravatar_id": "", "url": "https://api.github.com/users/durka", "html_url": "https://github.com/durka", "followers_url": "https://api.github.com/users/durka/followers", "following_url": "https://api.github.com/users/durka/following{/other_user}", "gists_url": "https://api.github.com/users/durka/gists{/gist_id}", "starred_url": "https://api.github.com/users/durka/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/durka/subscriptions", "organizations_url": "https://api.github.com/users/durka/orgs", "repos_url": "https://api.github.com/users/durka/repos", "events_url": "https://api.github.com/users/durka/events{/privacy}", "received_events_url": "https://api.github.com/users/durka/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2016-06-23T00:19:47Z", "updated_at": "2016-06-28T04:45:24Z", "closed_at": "2016-06-28T04:45:24Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Consider the following macro and all the ways to invoke it:\n\n``` rust\nmacro_rules! make_item {\n    ($a:ident) => { struct $a; }\n}\n\nmake_item!(A); // ok (semicolon required)\nmake_item! { B } // ok (semicolon not required)\n\nfn c() { make_item!(C); } // ok\nfn d() { make_item!(D) } // bad (expected: missing semicolon)\nfn e() { make_item! { E } } // bad (BUG: semicolon should not be required)\nfn f() { make_item! { F }; } // ok (workaround)\nfn gh() { make_item! { G } make_item!(H); } // ok (further evidence case E is a bug)\n```\n\nI believe that case E should be accepted, however it gives the error that the macro is invalid in expression position. My theory (before investigating) is that the tail of the function is considered as expression position because the macro expander forgets the possibility that a macro may generate items.\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/34418/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/34418/timeline", "performed_via_github_app": null, "state_reason": "completed"}