{"url": "https://api.github.com/repos/rust-lang/rust/issues/94743", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/94743/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/94743/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/94743/events", "html_url": "https://github.com/rust-lang/rust/issues/94743", "id": 1162958826, "node_id": "I_kwDOAAsO6M5FUVfq", "number": 94743, "title": "Windows: Support running script files using `process::Command`", "user": {"login": "ChrisDenton", "id": 4459874, "node_id": "MDQ6VXNlcjQ0NTk4NzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/4459874?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ChrisDenton", "html_url": "https://github.com/ChrisDenton", "followers_url": "https://api.github.com/users/ChrisDenton/followers", "following_url": "https://api.github.com/users/ChrisDenton/following{/other_user}", "gists_url": "https://api.github.com/users/ChrisDenton/gists{/gist_id}", "starred_url": "https://api.github.com/users/ChrisDenton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ChrisDenton/subscriptions", "organizations_url": "https://api.github.com/users/ChrisDenton/orgs", "repos_url": "https://api.github.com/users/ChrisDenton/repos", "events_url": "https://api.github.com/users/ChrisDenton/events{/privacy}", "received_events_url": "https://api.github.com/users/ChrisDenton/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 123109, "node_id": "MDU6TGFiZWwxMjMxMDk=", "url": "https://api.github.com/repos/rust-lang/rust/labels/O-windows", "name": "O-windows", "color": "6e6ec0", "default": false, "description": "Operating system: Windows"}, {"id": 630652267, "node_id": "MDU6TGFiZWw2MzA2NTIyNjc=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-feature-request", "name": "C-feature-request", "color": "f5f1fd", "default": false, "description": "Category: A feature request, i.e: not implemented / a PR."}, {"id": 2011781731, "node_id": "MDU6TGFiZWwyMDExNzgxNzMx", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-libs", "name": "T-libs", "color": "bfd4f2", "default": false, "description": "Relevant to the library team, which will review and decide on the PR/issue."}, {"id": 3812066157, "node_id": "LA_kwDOAAsO6M7jN4Nt", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-process", "name": "A-process", "color": "f7e101", "default": false, "description": "Area: std::process and std::env"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2022-03-08T18:00:49Z", "updated_at": "2023-03-19T09:51:09Z", "closed_at": null, "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "On Windows, currently only running `.exe` files is supported and script files aren't. Running `.bat` or `.cmd` (batch) files may work due to an undocumented feature of [`CreateProcessW`](https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessw) (the underlying Windows API call) but it would be good to have proper, documented support rather than relying on undocumented features.\r\n\r\nImplementing support for batch files would require finding `cmd.exe` ourselves and making sure the arguments passed to the batch file are interpreted as intended.\r\n\r\nSupporting other types of script file may also be desirable. This can be done by examining the `PATHEXT` environment variable for a list of script file extensions. If the given script file has an extension that matches an entry in this list, then the registry can be used to look up the program to run it.\r\n\r\nFor example,  getting the default value from `HKEY_CLASSES_ROOT\\.js` will give the default id of the `.js` extension (\"JSFile\"). This id can be used to find the command by getting the default value from `HKEY_CLASSES_ROOT\\JSFile\\Shell\\open\\command`. This will return something like `C:\\Windows\\System32\\WScript.exe \"%1\" %*` where `%1` should be replaced with the full path to the script file and `%*` should be replaced with any arguments being passed to the script.\r\n\r\n[MSDN documentation](https://docs.microsoft.com/en-us/windows/win32/shell/fa-intro)", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/94743/reactions", "total_count": 3, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 1, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/94743/timeline", "performed_via_github_app": null, "state_reason": null}