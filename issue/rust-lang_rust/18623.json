{"url": "https://api.github.com/repos/rust-lang/rust/issues/18623", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/18623/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/18623/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/18623/events", "html_url": "https://github.com/rust-lang/rust/issues/18623", "id": 47750336, "node_id": "MDU6SXNzdWU0Nzc1MDMzNg==", "number": 18623, "title": "ICE: DefID [...] was matchable against Obligation [...] but now is not", "user": {"login": "tyler569", "id": 2553055, "node_id": "MDQ6VXNlcjI1NTMwNTU=", "avatar_url": "https://avatars.githubusercontent.com/u/2553055?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tyler569", "html_url": "https://github.com/tyler569", "followers_url": "https://api.github.com/users/tyler569/followers", "following_url": "https://api.github.com/users/tyler569/following{/other_user}", "gists_url": "https://api.github.com/users/tyler569/gists{/gist_id}", "starred_url": "https://api.github.com/users/tyler569/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tyler569/subscriptions", "organizations_url": "https://api.github.com/users/tyler569/orgs", "repos_url": "https://api.github.com/users/tyler569/repos", "events_url": "https://api.github.com/users/tyler569/events{/privacy}", "received_events_url": "https://api.github.com/users/tyler569/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2014-11-04T18:53:49Z", "updated_at": "2015-05-12T20:47:11Z", "closed_at": "2015-05-12T20:47:11Z", "author_association": "NONE", "active_lock_reason": null, "body": "I don't really know what could be causing this bug, but this code\n\n``` rust\nstruct Test;\n\nimpl Add<i32, i32> for Test {\n    fn add(&self, othr: &i32) -> i32 {\n        othr + 1\n    }\n}\n\nimpl Add<f64, f64> for Test {\n    fn add(&self, othr: &f64) -> f64 {\n        othr + 2.0\n    }\n}\n\nfn main() {\n    let f = Test;\n    println!(\"f + 3:   {}\", f + 3);\n    println!(\"f + 3.0: {}\", f + 3.0);\n}\n```\n\nusing this version of rustc,\n\n```\nrustc 0.13.0-nightly (0a5e7f359 2014-11-03 23:16:55 +0000)\nbinary: rustc\ncommit-hash: 0a5e7f35949d18f312dca90af73e56aced6f2b0e\ncommit-date: 2014-11-03 23:16:55 +0000\nhost: x86_64-apple-darwin\nrelease: 0.13.0-nightly\n```\n\non Mac OS X 10.10\ncauses\n\n```\n[tyler@mac ~]$ RUST_BACKTRACE=1 rustc test.rs\nerror: internal compiler error: Impl DefId { krate: 0, node: 7 }:Test.Add<i32, i32> was matchable against Obligation(trait_ref=<_ as core::ops::Add<_, _>>,depth=0) but now is not\nnote: the compiler unexpectedly panicked. this is a bug.\nnote: we would appreciate a bug report: http://doc.rust-lang.org/complement-bugreport.html\nnote: run with `RUST_BACKTRACE=1` for a backtrace\ntask 'rustc' panicked at 'Box<Any>', /Users/rustbuild/src/rust-buildbot/slave/nightly-mac/build/src/libsyntax/diagnostic.rs:175\n\nstack backtrace:\n   1:        0x10a2997ff - rt::backtrace::imp::write::h41ac48e0092ef821Kqq\n   2:        0x10a29c987 - failure::on_fail::h3381510cd10c9a61zHq\n   3:        0x10a4f5495 - unwind::begin_unwind_inner::h8667451db5084e88EKd\n   4:        0x109a88897 - unwind::begin_unwind::h574859237947728247\n   5:        0x109a890d3 - diagnostic::Handler::bug::h6b8e7fd2f9430272TgG\n   6:        0x10733a9c1 - middle::traits::select::SelectionContext<'cx, 'tcx>::rematch_impl::h88c48df6dbcc8ecfbkZ\n   7:        0x1073294ab - middle::traits::select::SelectionContext<'cx, 'tcx>::confirm_candidate::h66ce271d2e7c254er0Y\n   8:        0x107321837 - middle::traits::select::SelectionContext<'cx, 'tcx>::select::h1fe5e22ffd93df8bVuX\n   9:        0x107320746 - middle::traits::fulfill::FulfillmentContext::select::hb3fa38b300468ae1f2W\n  10:        0x10731ffbc - middle::traits::fulfill::FulfillmentContext::select_where_possible::hc2e2275050ef1b1eu1W\n  11:        0x107235782 - middle::traits::fulfill::FulfillmentContext::select_all_or_error::h5af4c7aa23325766hZW\n  12:        0x1074a1638 - middle::typeck::check::vtable::select_all_fcx_obligations_or_error::h2aa8ac2036bfa6468aO\n  13:        0x1074f679b - middle::typeck::check::check_bare_fn::heec9ab1513e561178IV\n  14:        0x1074f25dd - middle::typeck::check::check_item::h88a198c1ca5a907bh3V\n  15:        0x1074f65df - middle::typeck::check::check_item_types::h153b2b615101bfcaiIV\n  16:        0x106ffcbc6 - util::common::time::h7711944396490138833\n  17:        0x1077bd73e - middle::typeck::check_crate::hd52e86e35ee1a30a3uo\n  18:        0x10782696f - driver::driver::phase_3_run_analysis_passes::h340df4cdb996da5a8hB\n  19:        0x107821198 - driver::driver::compile_input::h02967bf5608361a5TYA\n  20:        0x10789fd3c - driver::run_compiler::h3ec9fe79d927cfd96OE\n  21:        0x10789e1ce - driver::run::closure.145814\n  22:        0x10701552b - task::TaskBuilder<S>::try_future::closure.104091\n  23:        0x107015423 - task::TaskBuilder<S>::spawn_internal::closure.104062\n  24:        0x106f93c7d - task::NativeSpawner.Spawner::spawn::closure.8516\n  25:        0x10a55468c - rust_try_inner\n  26:        0x10a554676 - rust_try\n  27:        0x10a4f2c67 - unwind::try::h7be47cb819f03817Yyd\n  28:        0x10a4f2afc - task::Task::run::hd977e1132c48b8d6LKc\n  29:        0x106f93aa3 - task::NativeSpawner.Spawner::spawn::closure.8453\n  30:        0x10a4f4327 - thread::thread_start::ha9ae96309fe3363b05c\n  31:     0x7fff8c73d2fc - _pthread_body\n  32:     0x7fff8c73d279 - _pthread_body\n```\n\nApologies if this is an incorrect format or non-relevant, I've never really submitted a bug report to a large project before.\n\nAddendum:\nAdding \"f64\" to the second println!:\n\n``` rust\nstruct Test;\n\nimpl Add<i32, i32> for Test {\n    fn add(&self, othr: &i32) -> i32 {\n        othr + 1\n    }\n}\n\nimpl Add<f64, f64> for Test {\n    fn add(&self, othr: &f64) -> f64 {\n        othr + 2.0\n    }\n}\n\nfn main() {\n    let f = Test;\n    println!(\"f + 3:   {}\", f + 3);\n    println!(\"f + 3.0: {}\", f + 3.0f64);\n}\n```\n\ncompiles and runs as expected\n\n```\n[tyler@mac ~]$ ./test\nf + 3:   4\nf + 3.0: 5\n```\n", "closed_by": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/18623/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/18623/timeline", "performed_via_github_app": null, "state_reason": "completed"}