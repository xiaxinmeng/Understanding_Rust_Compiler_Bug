{"url": "https://api.github.com/repos/rust-lang/rust/issues/55592", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/55592/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/55592/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/55592/events", "html_url": "https://github.com/rust-lang/rust/issues/55592", "id": 376535539, "node_id": "MDU6SXNzdWUzNzY1MzU1Mzk=", "number": 55592, "title": "Build errors with edition=2018 after clean `cargo fix --edition`", "user": {"login": "SimonSapin", "id": 291359, "node_id": "MDQ6VXNlcjI5MTM1OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/291359?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SimonSapin", "html_url": "https://github.com/SimonSapin", "followers_url": "https://api.github.com/users/SimonSapin/followers", "following_url": "https://api.github.com/users/SimonSapin/following{/other_user}", "gists_url": "https://api.github.com/users/SimonSapin/gists{/gist_id}", "starred_url": "https://api.github.com/users/SimonSapin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SimonSapin/subscriptions", "organizations_url": "https://api.github.com/users/SimonSapin/orgs", "repos_url": "https://api.github.com/users/SimonSapin/repos", "events_url": "https://api.github.com/users/SimonSapin/events{/privacy}", "received_events_url": "https://api.github.com/users/SimonSapin/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}, {"id": 930400927, "node_id": "MDU6TGFiZWw5MzA0MDA5Mjc=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-rust-2018-preview", "name": "A-rust-2018-preview", "color": "f7e101", "default": false, "description": "Area: The 2018 edition preview"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-11-01T19:26:48Z", "updated_at": "2019-11-07T10:10:52Z", "closed_at": null, "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "With `nightly-2018-11-01` in Servo, after finally getting `cargo fix --edition` to complete without warnings. (Which was not easy: https://github.com/rust-lang-nursery/rustfix/issues/149, https://github.com/rust-lang-nursery/rustfix/issues/150), I added `edition = \"2018\"` to (almost) all `Cargo.toml` files.\r\n\r\nAt this point, the theory is that `cargo check` should Just Work, but it doesn\u2019t. I\u2019ve hit multiple issues, let me know if they should be filed separately.\r\n\r\n## Dependencies not known to Cargo\r\n\r\n```rust\r\nerror[E0658]: use of extern prelude names introduced with `extern crate` items is unstable (see issue #54658)          \r\n  --> components/dom_struct/lib.rs:11:5                                                                                \r\n   |                                                                                                                   \r\n11 | use proc_macro::TokenStream;                                                                                      \r\n   |     ^^^^^^^^^^                                                                                                    \r\n   |                                                                                                                   \r\n   = help: add #![feature(extern_crate_item_prelude)] to the crate attributes to enable  \r\n```\r\n\r\nThe \"extern prelude\" is one way to fix this, but another is to is a crate-local path `crate::proc_macro::TokenStream` to the name that is introduced by `extern crate`.\r\n\r\nThis feature is also missing a tracking issue, the error message points to the implementation PR: https://github.com/rust-lang/rust/pull/54658#issuecomment-435156630\r\n\r\n## Ambiguous imports\r\n\r\n```rust\r\nerror: `time` import is ambiguous                                                                                      \r\n  --> components/compositing/compositor.rs:41:5                                                                        \r\n   |                                                                                                                   \r\n23 | use profile_traits::time::{self, ProfilerCategory, profile};                                                      \r\n   |                            ---- may refer to `self::time` in the future                                           \r\n...                                                                                                                    \r\n41 | use time::{now, precise_time_ns, precise_time_s};                                                                 \r\n   |     ^^^^ can refer to external crate `::time`                                                                     \r\n   |                                                                                                                   \r\n   = help: write `::time` or `self::time` explicitly instead                                                           \r\n   = note: in the future, `#![feature(uniform_paths)]` may become the default                                          \r\n                                                                                                                       \r\nerror: aborting due to previous error  \r\n```\r\n\r\n## Migrating generated code\r\n\r\n`cargo fix` did fix similar cases in \"normal\" source files, but generated code needs to be fixed in the code generator.\r\n\r\nThese were the remaining ones after I\u2019d already taken care of the absolute paths.\r\n\r\n```rust\r\nerror: expected expression, found reserved keyword `try`                                                               \r\n   --> /home/simon/servo2/target/debug/build/script-b336041ffdaa5d29/out/Bindings/AnalyserNodeBinding.rs:291:23        \r\n    |                                                                                                                  \r\n291 |                 match try!(crate::dom::bindings::codegen::Bindings::AudioNodeBinding::AudioNodeOptions::new(cx, val)) {\r\n    |                       ^^^ expected expression                                                                    \r\n       \r\n```\r\n\r\n```rust\r\nerror: expected pattern, found reserved keyword `async`                                                                \r\n    --> /home/simon/servo2/target/debug/build/script-b336041ffdaa5d29/out/Bindings/XMLHttpRequestBinding.rs:1766:57    \r\n     |                                                                                                                 \r\n1766 |     fn Open_(&self, method: ByteString, url: USVString, async: bool, username: Option<USVString>, password: Option<USVString>) -> Fallible<()>;\r\n     |                                                         ^^^^^ expected pattern                                  \r\n                                                                                                                       \r\nerror: aborting due to previous error    \r\n```\r\n\r\n## New warnings\r\n\r\nNot as much of an issue than build errors, but slightly unexpected: switching editions uncovered new `unused_mut` warnings that were not present before. Maybe this is because 2018 currently implies NLL / MIR-borrowck?", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/55592/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/55592/timeline", "performed_via_github_app": null, "state_reason": null}