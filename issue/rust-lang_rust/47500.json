{"url": "https://api.github.com/repos/rust-lang/rust/issues/47500", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/47500/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/47500/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/47500/events", "html_url": "https://github.com/rust-lang/rust/issues/47500", "id": 289045640, "node_id": "MDU6SXNzdWUyODkwNDU2NDA=", "number": 47500, "title": "Rust bootstrap hangs forever while compiling stage1 librustc_mir with >1 CGU units", "user": {"login": "petrochenkov", "id": 5751617, "node_id": "MDQ6VXNlcjU3NTE2MTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5751617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petrochenkov", "html_url": "https://github.com/petrochenkov", "followers_url": "https://api.github.com/users/petrochenkov/followers", "following_url": "https://api.github.com/users/petrochenkov/following{/other_user}", "gists_url": "https://api.github.com/users/petrochenkov/gists{/gist_id}", "starred_url": "https://api.github.com/users/petrochenkov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petrochenkov/subscriptions", "organizations_url": "https://api.github.com/users/petrochenkov/orgs", "repos_url": "https://api.github.com/users/petrochenkov/repos", "events_url": "https://api.github.com/users/petrochenkov/events{/privacy}", "received_events_url": "https://api.github.com/users/petrochenkov/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 234956, "node_id": "MDU6TGFiZWwyMzQ5NTY=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-codegen", "name": "A-codegen", "color": "f7e101", "default": false, "description": "Area: Code generation"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2018-01-16T20:29:36Z", "updated_at": "2018-02-22T21:31:18Z", "closed_at": "2018-02-22T21:31:18Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Reproduces on `x86_64-pc-windows-gnu` with default `config.toml`, doesn't happen if `codegen-units = 1` are added.\r\n```\r\nBuilding stage1 compiler artifacts (x86_64-pc-windows-gnu -> x86_64-pc-windows-gnu)\r\n   ...\r\n   Compiling rustc_mir v0.0.0 (file:///C:/msys64/home/we/rust/src/librustc_mir)\r\n```\r\n\r\nStack trace:\r\n```\r\nAttaching to process 1780\r\n[New Thread 1780.0x1b7c]\r\n[New Thread 1780.0xb1c]\r\n[New Thread 1780.0x1d60]\r\n[New Thread 1780.0x19c4]\r\n[New Thread 1780.0x444]\r\n[New Thread 1780.0x1bd8]\r\nReading symbols from C:\\msys64\\home\\we\\rust\\build\\x86_64-pc-windows-gnu\\stage1\\bin\\rustc.exe...done.\r\n0x00007ff8d2642281 in ntdll!DbgBreakPoint ()\r\n   from C:\\Windows\\SYSTEM32\\ntdll.dll\r\n(gdb) info thread\r\n  Id   Target Id         Frame\r\n* 6    Thread 1780.0x1bd8 0x00007ff8d2642281 in ntdll!DbgBreakPoint ()\r\n   from C:\\Windows\\SYSTEM32\\ntdll.dll\r\n  5    Thread 1780.0x444 0x00000000038933e9 in llvm::DominatorTree::dominates(llvm::Instruction const*, llvm::Instruction const*) const ()\r\n   from C:\\msys64\\home\\we\\rust\\build\\x86_64-pc-windows-gnu\\stage1\\bin\\rustc_llvm-893cdac51017c26f.dll\r\n  4    Thread 1780.0x19c4 0x00007ff8d264221a in ntdll!ZwWaitForAlertByThreadId\r\n    () from C:\\Windows\\SYSTEM32\\ntdll.dll\r\n  3    Thread 1780.0x1d60 0x00007ff8d264221a in ntdll!ZwWaitForAlertByThreadId\r\n    () from C:\\Windows\\SYSTEM32\\ntdll.dll\r\n  2    Thread 1780.0xb1c 0x00007ff8d264221a in ntdll!ZwWaitForAlertByThreadId\r\n    () from C:\\Windows\\SYSTEM32\\ntdll.dll\r\n  1    Thread 1780.0x1b7c 0x00007ff8d264079a in ntdll!ZwWaitForSingleObject ()\r\n   from C:\\Windows\\SYSTEM32\\ntdll.dll\r\n(gdb) thread 5\r\n[Switching to thread 5 (Thread 1780.0x444)]\r\n#0  0x00000000038933e9 in llvm::DominatorTree::dominates(llvm::Instruction const*, llvm::Instruction const*) const ()\r\n   from C:\\msys64\\home\\we\\rust\\build\\x86_64-pc-windows-gnu\\stage1\\bin\\rustc_llvm-893cdac51017c26f.dll\r\n(gdb) where\r\n#0  0x00000000038933e9 in llvm::DominatorTree::dominates(llvm::Instruction const*, llvm::Instruction const*) const ()\r\n   from C:\\msys64\\home\\we\\rust\\build\\x86_64-pc-windows-gnu\\stage1\\bin\\rustc_llvm-893cdac51017c26f.dll\r\n#1  0x000000000324db30 in llvm::ScalarEvolution::isLoopBackedgeGuardedByCond(llvm::Loop const*, llvm::CmpInst::Predicate, llvm::SCEV const*, llvm::SCEV const*) ()\r\n   from C:\\msys64\\home\\we\\rust\\build\\x86_64-pc-windows-gnu\\stage1\\bin\\rustc_llvm-893cdac51017c26f.dll\r\n#2  0x000000000324160b in llvm::ScalarEvolution::getZeroExtendExpr(llvm::SCEV const*, llvm::Type*) ()\r\n   from C:\\msys64\\home\\we\\rust\\build\\x86_64-pc-windows-gnu\\stage1\\bin\\rustc_llvm-893cdac51017c26f.dll\r\n#3  0x00000000033bd10f in llvm::simplifyUsersOfIV(llvm::PHINode*, llvm::ScalarEvolution*, llvm::DominatorTree*, llvm::LoopInfo*, llvm::SmallVectorImpl<llvm::WeakVH>&, llvm::IVVisitor*) ()\r\n   from C:\\msys64\\home\\we\\rust\\build\\x86_64-pc-windows-gnu\\stage1\\bin\\rustc_llvm-893cdac51017c26f.dll\r\n#4  0x0000000002bf86ff in (anonymous namespace)::IndVarSimplify::simplifyAndExtend(llvm::Loop*, llvm::SCEVExpander&, llvm::LoopInfo*) [clone .constprop.438]\r\n    ()\r\n   from C:\\msys64\\home\\we\\rust\\build\\x86_64-pc-windows-gnu\\stage1\\bin\\rustc_llvm-893cdac51017c26f.dll\r\n#5  0x0000000002bfe3e9 in (anonymous namespace)::IndVarSimplify::run(llvm::Loop*) [clone .part.422] ()\r\n   from C:\\msys64\\home\\we\\rust\\build\\x86_64-pc-windows-gnu\\stage1\\bin\\rustc_llvm-893cdac51017c26f.dll\r\n#6  0x0000000002e05c56 in (anonymous namespace)::IndVarSimplifyLegacyPass::runOnLoop(llvm::Loop*, llvm::LPPassManager&) [clone .part.423] ()\r\n   from C:\\msys64\\home\\we\\rust\\build\\x86_64-pc-windows-gnu\\stage1\\bin\\rustc_llvm-893cdac51017c26f.dll\r\n#7  0x000000000310563f in llvm::LPPassManager::runOnFunction(llvm::Function&)\r\n    ()\r\n   from C:\\msys64\\home\\we\\rust\\build\\x86_64-pc-windows-gnu\\stage1\\bin\\rustc_llvm-893cdac51017c26f.dll\r\n#8  0x00000000030f830f in llvm::FPPassManager::runOnFunction(llvm::Function&)\r\n    ()\r\n   from C:\\msys64\\home\\we\\rust\\build\\x86_64-pc-windows-gnu\\stage1\\bin\\rustc_llvm-893cdac51017c26f.dll\r\n#9  0x0000000002bb74b2 in (anonymous namespace)::CGPassManager::runOnModule(llvm::Module&) ()\r\n   from C:\\msys64\\home\\we\\rust\\build\\x86_64-pc-windows-gnu\\stage1\\bin\\rustc_llvm-893cdac51017c26f.dll\r\n#10 0x00000000036760a6 in llvm::legacy::PassManagerImpl::run(llvm::Module&) ()\r\n   from C:\\msys64\\home\\we\\rust\\build\\x86_64-pc-windows-gnu\\stage1\\bin\\rustc_llvm-893cdac51017c26f.dll\r\n#11 0x00000000027d3239 in LLVMRunPassManager ()\r\n   from C:\\msys64\\home\\we\\rust\\build\\x86_64-pc-windows-gnu\\stage1\\bin\\rustc_llvm-893cdac51017c26f.dll\r\n#12 0x000000006a2ff765 in rustc_trans::back::lto::run_pass_manager::ha9ac3996c7d0c27d ()\r\n   from C:\\msys64\\home\\we\\rust\\build\\x86_64-pc-windows-gnu\\stage1\\bin\\rustc_trans-9dbf48abd39e3863.dll\r\n#13 0x000000006a2fc473 in rustc_trans::back::lto::LtoModuleTranslation::optimize::h719e586b1cc5ebba ()\r\n   from C:\\msys64\\home\\we\\rust\\build\\x86_64-pc-windows-gnu\\stage1\\bin\\rustc_trans-9dbf48abd39e3863.dll\r\n#14 0x000000006a3e65a9 in rustc_trans::back::write::execute_work_item::h5b3d73b59b481809 ()\r\n   from C:\\msys64\\home\\we\\rust\\build\\x86_64-pc-windows-gnu\\stage1\\bin\\rustc_trans-9dbf48abd39e3863.dll\r\n#15 0x000000006a3af743 in std::sys_common::backtrace::__rust_begin_short_backtrace::h612d8b59f6a133dd ()\r\n   from C:\\msys64\\home\\we\\rust\\build\\x86_64-pc-windows-gnu\\stage1\\bin\\rustc_trans-9dbf48abd39e3863.dll\r\n#16 0x000000006a3cb509 in std::panicking::try::do_call::hc93086c132a5a3ea ()\r\n   from C:\\msys64\\home\\we\\rust\\build\\x86_64-pc-windows-gnu\\stage1\\bin\\rustc_trans-9dbf48abd39e3863.dll\r\n#17 0x000000006ec4c4a9 in __rust_maybe_catch_panic ()\r\n   from C:\\msys64\\home\\we\\rust\\build\\x86_64-pc-windows-gnu\\stage1\\bin\\std-b1b09a5d7798628b.dll\r\n#18 0x000000006a3d7fb9 in _$LT$F$u20$as$u20$alloc..boxed..FnBox$LT$A$GT$$GT$::call_box::h30ec2bcae50c9446 ()\r\n   from C:\\msys64\\home\\we\\rust\\build\\x86_64-pc-windows-gnu\\stage1\\bin\\rustc_trans-9dbf48abd39e3863.dll\r\n#19 0x000000006ec140f0 in std::sys_common::thread::start_thread::h55c7159741396635 ()\r\n   from C:\\msys64\\home\\we\\rust\\build\\x86_64-pc-windows-gnu\\stage1\\bin\\std-b1b09a5d7798628b.dll\r\n#20 0x000000006ec40769 in std::sys::windows::thread::Thread::new::thread_start::hecbc47bdd027efcc ()\r\n   from C:\\msys64\\home\\we\\rust\\build\\x86_64-pc-windows-gnu\\stage1\\bin\\std-b1b09a5d7798628b.dll\r\n#21 0x00007ff8d1b413d2 in KERNEL32!BaseThreadInitThunk ()\r\n   from C:\\Windows\\system32\\kernel32.dll\r\n#22 0x00007ff8d25c54f4 in ntdll!RtlUserThreadStart ()\r\n   from C:\\Windows\\SYSTEM32\\ntdll.dll\r\n#23 0x0000000000000000 in ?? ()\r\nBacktrace stopped: previous frame inner to this frame (corrupt stack?)\r\n```", "closed_by": {"login": "petrochenkov", "id": 5751617, "node_id": "MDQ6VXNlcjU3NTE2MTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5751617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petrochenkov", "html_url": "https://github.com/petrochenkov", "followers_url": "https://api.github.com/users/petrochenkov/followers", "following_url": "https://api.github.com/users/petrochenkov/following{/other_user}", "gists_url": "https://api.github.com/users/petrochenkov/gists{/gist_id}", "starred_url": "https://api.github.com/users/petrochenkov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petrochenkov/subscriptions", "organizations_url": "https://api.github.com/users/petrochenkov/orgs", "repos_url": "https://api.github.com/users/petrochenkov/repos", "events_url": "https://api.github.com/users/petrochenkov/events{/privacy}", "received_events_url": "https://api.github.com/users/petrochenkov/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/47500/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/47500/timeline", "performed_via_github_app": null, "state_reason": "completed"}