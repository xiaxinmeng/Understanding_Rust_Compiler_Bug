{"url": "https://api.github.com/repos/rust-lang/rust/issues/33722", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/33722/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/33722/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/33722/events", "html_url": "https://github.com/rust-lang/rust/issues/33722", "id": 155583006, "node_id": "MDU6SXNzdWUxNTU1ODMwMDY=", "number": 33722, "title": "Stack overflow when passing a default impl DefId to TyCtxt::item_path_str ", "user": {"login": "Kha", "id": 109126, "node_id": "MDQ6VXNlcjEwOTEyNg==", "avatar_url": "https://avatars.githubusercontent.com/u/109126?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Kha", "html_url": "https://github.com/Kha", "followers_url": "https://api.github.com/users/Kha/followers", "following_url": "https://api.github.com/users/Kha/following{/other_user}", "gists_url": "https://api.github.com/users/Kha/gists{/gist_id}", "starred_url": "https://api.github.com/users/Kha/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Kha/subscriptions", "organizations_url": "https://api.github.com/users/Kha/orgs", "repos_url": "https://api.github.com/users/Kha/repos", "events_url": "https://api.github.com/users/Kha/events{/privacy}", "received_events_url": "https://api.github.com/users/Kha/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2016-05-18T19:32:15Z", "updated_at": "2017-05-04T01:10:28Z", "closed_at": "2017-05-04T01:10:28Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Not sure if this observable in the actual compiler. I was dumping every definition from libcore, but got a stack overflow at `unsafe impl Send for .. { }`:\n\n```\n#0  0x00007ffff6cc7ed4 in rustc::ty::item_path::_$LT$impl$u20$ty..context..TyCtxt$LT$$u27$a$C$$u20$$u27$gcx$C$$u20$$u27$tcx$GT$$GT$::push_item_path::h5773af04af31eeed ()\n#1  0x00007ffff6a6e94a in _$LT$hir..def_id..DefId$u20$as$u20$core..fmt..Debug$GT$::fmt::_$u7b$$u7b$closure$u7d$$u7d$::he1528141f0a60e7c ()\n#2  0x00007ffff6a6dbfe in _$LT$hir..def_id..DefId$u20$as$u20$core..fmt..Debug$GT$::fmt::hb04947a24c57397a ()\n#3  0x00007ffff27f1a8e in core::fmt::write::h218cb9026097c841 ()\n#4  0x00007ffff27f1731 in _$LT$fmt..Arguments$LT$$u27$a$GT$$u20$as$u20$fmt..Display$GT$::fmt::h68f84d6d60b17e9f ()\n#5  0x00007ffff27f1a8e in core::fmt::write::h218cb9026097c841 ()\n#6  0x00007ffff2785383 in collections::fmt::format::h5b702bd2eec08568 ()\n#7  0x00007ffff6a02693 in rustc::session::opt_span_bug_fmt::_$u7b$$u7b$closure$u7d$$u7d$::hf0fb5697f8f25f40 ()\n#8  0x00007ffff6a025fe in rustc::session::opt_span_bug_fmt::hc581ba88c4e2ec53 ()\n#9  0x00007ffff6a1a437 in rustc::session::bug_fmt::had96c08cb43bd8a1 ()\n#10 0x00007ffff6b2d652 in rustc::ty::_$LT$impl$u20$ty..context..TyCtxt$LT$$u27$a$C$$u20$$u27$gcx$C$$u20$$u27$tcx$GT$$GT$::lookup_item_type::h31a017c16df658c5 ()\n...\n```\n\nThe problem is [calling lookup_item_type](https://github.com/rust-lang/rust/blob/8f72d8127fd91911b80b8b8b9e0f51f6e001d748/src/librustc/ty/item_path.rs#L192) on such an impl, which will fail and try to format the DefId for an error message, calling the same code all over again.\n", "closed_by": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/33722/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/33722/timeline", "performed_via_github_app": null, "state_reason": "completed"}