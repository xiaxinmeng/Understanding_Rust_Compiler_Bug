{"url": "https://api.github.com/repos/rust-lang/rust/issues/62001", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/62001/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/62001/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/62001/events", "html_url": "https://github.com/rust-lang/rust/issues/62001", "id": 458744964, "node_id": "MDU6SXNzdWU0NTg3NDQ5NjQ=", "number": 62001, "title": "rustc from version 1.34 hangs and never ends on Solaris", "user": {"login": "psumbera", "id": 4249116, "node_id": "MDQ6VXNlcjQyNDkxMTY=", "avatar_url": "https://avatars.githubusercontent.com/u/4249116?v=4", "gravatar_id": "", "url": "https://api.github.com/users/psumbera", "html_url": "https://github.com/psumbera", "followers_url": "https://api.github.com/users/psumbera/followers", "following_url": "https://api.github.com/users/psumbera/following{/other_user}", "gists_url": "https://api.github.com/users/psumbera/gists{/gist_id}", "starred_url": "https://api.github.com/users/psumbera/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/psumbera/subscriptions", "organizations_url": "https://api.github.com/users/psumbera/orgs", "repos_url": "https://api.github.com/users/psumbera/repos", "events_url": "https://api.github.com/users/psumbera/events{/privacy}", "received_events_url": "https://api.github.com/users/psumbera/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 632931028, "node_id": "MDU6TGFiZWw2MzI5MzEwMjg=", "url": "https://api.github.com/repos/rust-lang/rust/labels/O-solaris", "name": "O-solaris", "color": "6e6ec0", "default": false, "description": "Operating system: Solaris"}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2019-06-20T16:05:10Z", "updated_at": "2021-12-20T13:01:01Z", "closed_at": "2021-12-20T13:01:01Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "While working on Firefox trunk version from March which still builds using Rust 1.33 I have no problem. After moving to Rust 1.34 (and 1.35) Firefox build always hangs on both Solaris SPARC/intel at the same place.\r\n\r\nThis is the command which never ends (recent Firefox version):\r\n```\r\n/builds/psumbera/rustc-1.35.0/bin/rustc --edition=2018 --crate-name webrender gfx/wr/webrender/src/lib.rs --color never --crate-type lib --emit=dep-info,link -C opt-level=1 -C panic=abort -C debuginfo=2 -C debug-assertions=on --cfg feature=\"api\" --cfg feature=\"capture\" --cfg feature=\"ron\" --cfg feature=\"serde\" --cfg feature=\"serialize_program\" --cfg feature=\"smallvec\" --cfg feature=\"webrender_build\" -C metadata=99faab832b9691ee -C extra-filename=-99faab832b9691ee --out-dir /builds/psumbera/FIREFOX-2/obj-x86_64-pc-solaris2.11/x86_64-sun-solaris/debug/deps --target x86_64-sun-solaris -C linker=/builds/psumbera/FIREFOX-2/build/cargo-linker -C incremental=/builds/psumbera/FIREFOX-2/obj-x86_64-pc-solaris2.11/x86_64-sun-solaris/debug/incremental -L dependency=/builds/psumbera/FIREFOX-2/obj-x86_64-pc-solaris2.11/x86_64-sun-solaris/debug/deps -L dependency=/builds/psumbera/FIREFOX-2/obj-x86_64-pc-solaris2.11/debug/deps --extern bincode=/builds/psumbera/FIREFOX-2/obj-x86_64-pc-solaris2.11/x86_64-sun-solaris/debug/deps/libbincode-ec0153ab07331163.rlib --extern bitflags=/builds/psumbera/FIREFOX-2/obj-x86_64-pc-solaris2.11/x86_64-sun-solaris/debug/deps/libbitflags-c7eccef4b58dcadd.rlib --extern byteorder=/builds/psumbera/FIREFOX-2/obj-x86_64-pc-solaris2.11/x86_64-sun-solaris/debug/deps/libbyteorder-c058696e0347919f.rlib --extern cfg_if=/builds/psumbera/FIREFOX-2/obj-x86_64-pc-solaris2.11/x86_64-sun-solaris/debug/deps/libcfg_if-9b4004fb3ffa9c4f.rlib --extern cstr=/builds/psumbera/FIREFOX-2/obj-x86_64-pc-solaris2.11/x86_64-sun-solaris/debug/deps/libcstr-5bf60fb8862b7581.rlib --extern euclid=/builds/psumbera/FIREFOX-2/obj-x86_64-pc-solaris2.11/x86_64-sun-solaris/debug/deps/libeuclid-b94b3312d62ea4be.rlib --extern freetype=/builds/psumbera/FIREFOX-2/obj-x86_64-pc-solaris2.11/x86_64-sun-solaris/debug/deps/libfreetype-0eefb0ff048706c3.rlib --extern fxhash=/builds/psumbera/FIREFOX-2/obj-x86_64-pc-solaris2.11/x86_64-sun-solaris/debug/deps/libfxhash-95242b29456f80ea.rlib --extern gleam=/builds/psumbera/FIREFOX-2/obj-x86_64-pc-solaris2.11/x86_64-sun-solaris/debug/deps/libgleam-181d45c46baed8ca.rlib --extern lazy_static=/builds/psumbera/FIREFOX-2/obj-x86_64-pc-solaris2.11/x86_64-sun-solaris/debug/deps/liblazy_static-caf7993f15518cd8.rlib --extern libc=/builds/psumbera/FIREFOX-2/obj-x86_64-pc-solaris2.11/x86_64-sun-solaris/debug/deps/liblibc-607e885dcbd6b7db.rlib --extern log=/builds/psumbera/FIREFOX-2/obj-x86_64-pc-solaris2.11/x86_64-sun-solaris/debug/deps/liblog-74f2d7b3cac778b1.rlib --extern malloc_size_of_derive=/builds/psumbera/FIREFOX-2/obj-x86_64-pc-solaris2.11/debug/deps/libmalloc_size_of_derive-250c8f09d8ea0cfb.so --extern num_traits=/builds/psumbera/FIREFOX-2/obj-x86_64-pc-solaris2.11/x86_64-sun-solaris/debug/deps/libnum_traits-a0e603090074f419.rlib --extern plane_split=/builds/psumbera/FIREFOX-2/obj-x86_64-pc-solaris2.11/x86_64-sun-solaris/debug/deps/libplane_split-30e0bcd01e7ab266.rlib --extern rayon=/builds/psumbera/FIREFOX-2/obj-x86_64-pc-solaris2.11/x86_64-sun-solaris/debug/deps/librayon-43c23d9f4600c651.rlib --extern ron=/builds/psumbera/FIREFOX-2/obj-x86_64-pc-solaris2.11/x86_64-sun-solaris/debug/deps/libron-d1a414d7c26a2e4c.rlib --extern serde=/builds/psumbera/FIREFOX-2/obj-x86_64-pc-solaris2.11/x86_64-sun-solaris/debug/deps/libserde-b08c111a6bfeabb8.rlib --extern sha2=/builds/psumbera/FIREFOX-2/obj-x86_64-pc-solaris2.11/x86_64-sun-solaris/debug/deps/libsha2-ba5dc3a1184e39c8.rlib --extern smallvec=/builds/psumbera/FIREFOX-2/obj-x86_64-pc-solaris2.11/x86_64-sun-solaris/debug/deps/libsmallvec-a209018322d7d77b.rlib --extern svg_fmt=/builds/psumbera/FIREFOX-2/obj-x86_64-pc-solaris2.11/x86_64-sun-solaris/debug/deps/libsvg_fmt-4365ce44a0ac6281.rlib --extern thread_profiler=/builds/psumbera/FIREFOX-2/obj-x86_64-pc-solaris2.11/x86_64-sun-solaris/debug/deps/libthread_profiler-775d340cb2ed2ce5.rlib --extern time=/builds/psumbera/FIREFOX-2/obj-x86_64-pc-solaris2.11/x86_64-sun-solaris/debug/deps/libtime-8fbb5518451591bb.rlib --extern api=/builds/psumbera/FIREFOX-2/obj-x86_64-pc-solaris2.11/x86_64-sun-solaris/debug/deps/libwebrender_api-902b83d5167bfd0c.rlib --extern webrender_build=/builds/psumbera/FIREFOX-2/obj-x86_64-pc-solaris2.11/x86_64-sun-solaris/debug/deps/libwebrender_build-d4ba455eafed6704.rlib --extern malloc_size_of=/builds/psumbera/FIREFOX-2/obj-x86_64-pc-solaris2.11/x86_64-sun-solaris/debug/deps/libwr_malloc_size_of-a6c3c957caf41465.rlib -C opt-level=2 -C debuginfo=2 --cap-lints warn\r\n```\r\nNot sure what it should exactly do. The source file is here (though it includes some generated data - shaders.rs): https://searchfox.org/mozilla-central/source/gfx/wr/webrender/src/lib.rs\r\n\r\nIt seems to do nothing:\r\n```\r\nulx-0 17:54 ~: truss -p 10507\r\n/1:     lwp_wait(2, 0x7FCA03059BCC)     (sleeping...)\r\n/2:     lwp_park(0x00000000, 0)         (sleeping...)\r\n/5:     lwp_park(0x00000000, 0)         (sleeping...)\r\n/4:     lwp_park(0x00000000, 0)         (sleeping...)\r\n```\r\n\r\nFollowing are pfiles output:\r\n```\r\npfiles 10507\r\n10507:  /builds/psumbera/rustc-1.35.0/bin/rustc --edition=2018 --crate-name we\r\n  Current rlimit: 65536 file descriptors\r\n   0: S_IFCHR mode:0666 dev:16381,0 ino:61865992 uid:0 gid:3 rdev:118,2\r\n      O_RDONLY|O_LARGEFILE\r\n      /devices/pseudo/mm@0:null\r\n      offset:0\r\n   1: S_IFIFO mode:0000 dev:16383,0 ino:74229 uid:157622 gid:10 size:0\r\n      O_RDWR\r\n   2: S_IFIFO mode:0000 dev:16383,0 ino:74230 uid:157622 gid:10 size:0\r\n      O_RDWR\r\n   3: S_IFIFO mode:0000 dev:16383,0 ino:62594 uid:157622 gid:10 size:31\r\n      O_RDWR FD_CLOEXEC\r\n   4: S_IFIFO mode:0000 dev:16383,0 ino:62594 uid:157622 gid:10 size:0\r\n      O_RDWR FD_CLOEXEC\r\n   5: S_IFSOCK mode:0666 dev:16377,0 ino:25917 uid:0 gid:0 size:0\r\n      O_RDWR\r\n        sockname: AF_UNIX\r\n        SOCK_STREAM\r\n        SO_SNDBUF(16384),SO_RCVBUF(5120)\r\n        peer: python2.7[3347] zone: global[0]\r\n   6: S_IFREG mode:0700 dev:231,65613 ino:5773182 uid:157622 gid:10 size:0\r\n      O_RDWR|O_CREAT|O_LARGEFILE\r\n      advisory write lock set by process 10507\r\n      /builds/psumbera/FIREFOX-2/obj-x86_64-pc-solaris2.11/x86_64-sun-solaris/debug/incremental/webrender-23pxozt036u8y/s-fdc7qoiobu-1m2opnp.lock\r\n      offset:0\r\n```\r\n\r\nThreads status:\r\n```\r\nTHREAD           STATE    SOBJ                COUNT\r\n4                PARKED   CV                      2\r\n                 libc.so.1`__lwp_park+0x17\r\n                 libc.so.1`cond_wait_queue+0x63\r\n                 libc.so.1`__cond_wait+0x7f\r\n                 libc.so.1`cond_wait+0x1d\r\n                 libc.so.1`pthread_cond_wait+9\r\n                 libstd-2b33068b549d248e.so`std::thread::park::h8201652595634b60+0x106\r\n\r\n27               UNPARKED <NONE>                  1\r\n                 libLLVM-6.0.so`llvm::DbgInfoIntrinsic::getVariableLocationconst+0x37\r\n                 libLLVM-6.0.so`llvm::wouldInstructionBeTriviallyDead+0x76\r\n                 libLLVM-6.0.so`AddReachableCodeToWorklist+0x24b\r\n                 libLLVM-6.0.so`combineInstructionsOverFunction+0x25f\r\n                 libLLVM-6.0.so`llvm::InstructionCombiningPass::runOnFunction+0x248\r\n                 libLLVM-6.0.so`llvm::FPPassManager::runOnFunction+0x2e8\r\n                 libLLVM-6.0.so`+0x41e\r\n                 libLLVM-6.0.so`llvm::legacy::PassManagerImpl::run+0x2b4\r\n                 libLLVM-6.0.so`LLVMRunPassManager+0x1e\r\n                 librustc_codegen_llvm-llvm.so`rustc_codegen_llvm::back::write::optimize::he90c5e525eb485ed+0x818\r\n                 librustc_codegen_llvm-llvm.so`_$LT$$RF$T$u20$as$u20$core..fmt..Display$GT$::fmt::h21db531cae9bdc9f\r\n                 0x10\r\n                 0x6e31306d32696d76\r\n\r\n1                UNPARKED <NONE>                  1\r\n                 libc.so.1`__lwp_wait+0xa\r\n                 libc.so.1`_thrp_join+0x5f\r\n                 libc.so.1`pthread_join+0x1f\r\n                 libstd-2b33068b549d248e.so`std::sys::unix::thread::Thread::join::hb74a783e0da7ec5a+0xc\r\n\r\n2                PARKED   CV                      1\r\n                 libc.so.1`__lwp_park+0x17\r\n                 libc.so.1`cond_wait_queue+0x63\r\n                 libc.so.1`__cond_wait+0x7f\r\n                 libc.so.1`cond_wait+0x1d\r\n                 libc.so.1`pthread_cond_wait+9\r\n                 libstd-2b33068b549d248e.so`std::thread::park::h8201652595634b60+0x106\r\n                 0xd00000000000000\r\n```", "closed_by": {"login": "psumbera", "id": 4249116, "node_id": "MDQ6VXNlcjQyNDkxMTY=", "avatar_url": "https://avatars.githubusercontent.com/u/4249116?v=4", "gravatar_id": "", "url": "https://api.github.com/users/psumbera", "html_url": "https://github.com/psumbera", "followers_url": "https://api.github.com/users/psumbera/followers", "following_url": "https://api.github.com/users/psumbera/following{/other_user}", "gists_url": "https://api.github.com/users/psumbera/gists{/gist_id}", "starred_url": "https://api.github.com/users/psumbera/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/psumbera/subscriptions", "organizations_url": "https://api.github.com/users/psumbera/orgs", "repos_url": "https://api.github.com/users/psumbera/repos", "events_url": "https://api.github.com/users/psumbera/events{/privacy}", "received_events_url": "https://api.github.com/users/psumbera/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/62001/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/62001/timeline", "performed_via_github_app": null, "state_reason": "completed"}