{"url": "https://api.github.com/repos/rust-lang/rust/issues/13364", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/13364/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/13364/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/13364/events", "html_url": "https://github.com/rust-lang/rust/issues/13364", "id": 30948025, "node_id": "MDU6SXNzdWUzMDk0ODAyNQ==", "number": 13364, "title": "ICE when trying to tame std: failed at 'lookup_item: id not found: 148798'", "user": {"login": "dckc", "id": 150986, "node_id": "MDQ6VXNlcjE1MDk4Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/150986?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dckc", "html_url": "https://github.com/dckc", "followers_url": "https://api.github.com/users/dckc/followers", "following_url": "https://api.github.com/users/dckc/following{/other_user}", "gists_url": "https://api.github.com/users/dckc/gists{/gist_id}", "starred_url": "https://api.github.com/users/dckc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dckc/subscriptions", "organizations_url": "https://api.github.com/users/dckc/orgs", "repos_url": "https://api.github.com/users/dckc/repos", "events_url": "https://api.github.com/users/dckc/events{/privacy}", "received_events_url": "https://api.github.com/users/dckc/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2014-04-06T21:10:12Z", "updated_at": "2015-10-21T23:34:13Z", "closed_at": "2015-01-17T16:52:18Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I made a ~150 line usb footpedal library and I'm trying to link it against a [tamed](https://code.google.com/p/joe-e/wiki/Taming) subset of std (cf #3094):\n-  tame.rs links with std but only reexports deterministic items\n- footpedal.rs uses no_std and links with tame\n\nI ran into an ICE:\n\n```\nfpscribe$ RUST_BACKTRACE=1 make\nrustc   -O footpedal.rs -L .\nerror: internal compiler error: unexpected failure\nnote: the compiler hit an unexpected failure path. this is a bug.\nnote: we would appreciate a bug report: http://static.rust-lang.org/doc/master/complement-bugreport.html\nnote: run with `RUST_BACKTRACE=1` for a backtrace\ntask 'rustc' failed at 'lookup_item: id not found: 148798', /build/buildd/rust-nightly-201404060405~0651d27~precise/src/librustc/metadata/decoder.rs:95\nstack backtrace:\n   1:     0x2b692cf2fb00 - rt::backtrace::imp::write::h5f2f567c302aceb38Mb::v0.11.pre\n   2:     0x2b692ce917f0 - rt::unwind::begin_unwind_inner::h020e2bd5484a13f9Bnb::v0.11.pre\n   3:     0x2b692ce91470 - rt::unwind::begin_unwind_fmt::had2edc00130e15ecLmb::v0.11.pre\n   4:     0x2b692aef2c60 - <unknown>\n   5:     0x2b692aef9030 - metadata::decoder::maybe_get_item_ast::hb969df0f249f5979bda::v0.11.pre\n   6:     0x2b692a79fd90 - metadata::csearch::maybe_get_item_ast::h54e9a0b7f74b5af2Z8b::v0.11.pre\n   7:     0x2b692ac599c0 - middle::const_eval::lookup_variant_by_id::hfce98df3ad93b884L4P::v0.11.pre\n   8:     0x2b692a8bd840 - middle::const_eval::lookup_const::h17cb5423bf10a1f4S3P::v0.11.pre\n   9:     0x2b692ac5c430 - <unknown>\n  10:     0x2b692ac5e700 - <unknown>\n  11:     0x2b692ac5e700 - <unknown>\n  12:     0x2b692ac5f470 - <unknown>\n  13:     0x2b692ac5e700 - <unknown>\n  14:     0x2b692ac5f470 - <unknown>\n  15:     0x2b692ac5e700 - <unknown>\n  16:     0x2b692ac5f470 - <unknown>\n  17:     0x2b692ac605a0 - <unknown>\n  18:     0x2b692ac5fcd0 - <unknown>\n  19:     0x2b692ac5ddd0 - middle::const_eval::process_crate::h85e49642fdbc647csfQ::v0.11.pre\n  20:     0x2b692ab6b350 - <unknown>\n  21:     0x2b692af9cc20 - driver::driver::phase_3_run_analysis_passes::h56874d2a6b937793Ere::v0.11.pre\n  22:     0x2b692afa3650 - driver::driver::compile_input::h108fdc2cbeadd60aBQe::v0.11.pre\n  23:     0x2b692afc6530 - run_compiler::h82f4eda38ece6fe2Jim::v0.11.pre\n  24:     0x2b692afdd8e0 - <unknown>\n  25:     0x2b692afdc210 - <unknown>\n  26:     0x2b692afd7b40 - <unknown>\n  27:     0x2b692a25c3f0 - <unknown>\n  28:     0x2b692cf2af90 - <unknown>\n  29:     0x2b692cf365b0 - rust_try\n  30:     0x2b692cf2add0 - rt::task::Task::run::hd22104201ff3b8d47f9::v0.11.pre\n  31:     0x2b692a25c1c0 - <unknown>\n  32:     0x2b692cf2e640 - <unknown>\n  33:     0x2b692ff97dc0 - start_thread\n  34:                0x0 - <unknown>\n\nmake: *** [libfootpedal-77ad9f83-0.0.rlib] Error 101\n```\n\nI haven't made an isolated test case, but it doesn't take much code to trigger the bug:\n\n```\nfpscribe$ wc tame.rs footpedal.rs \n  10   22  245 tame.rs\n 147  393 3598 footpedal.rs\n 157  415 3843 total\n```\n\nThe code is [fpscribe rev 98b0e0cdbb](https://github.com/dckc/fpscribe/tree/98b0e0cdbb996fdb04aadab0a681df11536ac5a5).\n\nI'm using the current nightly on linux (Ubuntu 12.04):\n\n```\n$ apt-cache policy rust-nightly\nrust-nightly:\n  Installed: 201404060405~0651d27~precise\n  Candidate: 201404060405~0651d27~precise\n```\n\nI got it from [the ppa](http://ppa.launchpad.net/hansjorg/rust/ubuntu/).\n", "closed_by": {"login": "dckc", "id": 150986, "node_id": "MDQ6VXNlcjE1MDk4Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/150986?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dckc", "html_url": "https://github.com/dckc", "followers_url": "https://api.github.com/users/dckc/followers", "following_url": "https://api.github.com/users/dckc/following{/other_user}", "gists_url": "https://api.github.com/users/dckc/gists{/gist_id}", "starred_url": "https://api.github.com/users/dckc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dckc/subscriptions", "organizations_url": "https://api.github.com/users/dckc/orgs", "repos_url": "https://api.github.com/users/dckc/repos", "events_url": "https://api.github.com/users/dckc/events{/privacy}", "received_events_url": "https://api.github.com/users/dckc/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/13364/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/13364/timeline", "performed_via_github_app": null, "state_reason": "completed"}