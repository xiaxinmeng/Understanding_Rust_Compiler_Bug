{"url": "https://api.github.com/repos/rust-lang/rust/issues/61427", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/61427/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/61427/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/61427/events", "html_url": "https://github.com/rust-lang/rust/issues/61427", "id": 451079399, "node_id": "MDU6SXNzdWU0NTEwNzkzOTk=", "number": 61427, "title": "`Sized` not detected for fixed size array size", "user": {"login": "aticu", "id": 16419880, "node_id": "MDQ6VXNlcjE2NDE5ODgw", "avatar_url": "https://avatars.githubusercontent.com/u/16419880?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aticu", "html_url": "https://github.com/aticu", "followers_url": "https://api.github.com/users/aticu/followers", "following_url": "https://api.github.com/users/aticu/following{/other_user}", "gists_url": "https://api.github.com/users/aticu/gists{/gist_id}", "starred_url": "https://api.github.com/users/aticu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aticu/subscriptions", "organizations_url": "https://api.github.com/users/aticu/orgs", "repos_url": "https://api.github.com/users/aticu/repos", "events_url": "https://api.github.com/users/aticu/events{/privacy}", "received_events_url": "https://api.github.com/users/aticu/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-06-01T12:14:17Z", "updated_at": "2019-06-01T16:47:41Z", "closed_at": "2019-06-01T16:47:41Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "The `Sized` bound does not seem to work correctly when using `std::mem::size_of` to determine the size of a fixed size array.\r\n\r\nThe following code fails:\r\n\r\n```Rust\r\nfn breaks<T: Sized>() {\r\n    let _: [u8; std::mem::size_of::<T>()];\r\n}\r\n```\r\n\r\nwith the message\r\n\r\n```text\r\nerror[E0277]: the size for values of type `T` cannot be known at compilation time\r\n --> src/main.rs:2:17\r\n  |\r\n2 |     let _: [u8; std::mem::size_of::<T>()];\r\n  |                 ^^^^^^^^^^^^^^^^^^^^^^\r\n  |\r\n  = help: the trait `std::marker::Sized` is not implemented for `T`\r\n  = note: to learn more, visit <https://doc.rust-lang.org/book/ch19-04-advanced-types.html#dynamically-sized-types-and-the-sized-trait>\r\n  = help: consider adding a `where T: std::marker::Sized` bound\r\n  = note: required by `std::mem::size_of`\r\n\r\nerror: aborting due to previous error\r\n\r\nFor more information about this error, try `rustc --explain E0277`.\r\n```\r\n\r\nwhile this code works:\r\n\r\n```Rust\r\nfn works<T: Sized>() {\r\n    let _ = std::mem::size_of::<T>();\r\n}\r\n```\r\n\r\nI'd expect the Sized bound to work the same in both cases. Also even if that was not possible, the error message is not particularly helpful in this case, since it contains false information (`T: Sized` is clearly true).\r\n\r\n## Meta\r\n\r\nTested with the latest nightly and stable.\r\n\r\n### Nightly\r\n\r\n```text\r\nrustc 1.37.0-nightly (7840a0b75 2019-05-31)\r\nbinary: rustc\r\ncommit-hash: 7840a0b753a065a41999f1fb6028f67d33e3fdd5\r\ncommit-date: 2019-05-31\r\nhost: x86_64-unknown-linux-gnu\r\nrelease: 1.37.0-nightly\r\nLLVM version: 8.0\r\n```\r\n\r\n### Stable\r\n\r\n```\r\nrustc 1.35.0 (3c235d560 2019-05-20)\r\nbinary: rustc\r\ncommit-hash: 3c235d5600393dfe6c36eeed34042efad8d4f26e\r\ncommit-date: 2019-05-20\r\nhost: x86_64-unknown-linux-gnu\r\nrelease: 1.35.0\r\nLLVM version: 8.0\r\n```", "closed_by": {"login": "aticu", "id": 16419880, "node_id": "MDQ6VXNlcjE2NDE5ODgw", "avatar_url": "https://avatars.githubusercontent.com/u/16419880?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aticu", "html_url": "https://github.com/aticu", "followers_url": "https://api.github.com/users/aticu/followers", "following_url": "https://api.github.com/users/aticu/following{/other_user}", "gists_url": "https://api.github.com/users/aticu/gists{/gist_id}", "starred_url": "https://api.github.com/users/aticu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aticu/subscriptions", "organizations_url": "https://api.github.com/users/aticu/orgs", "repos_url": "https://api.github.com/users/aticu/repos", "events_url": "https://api.github.com/users/aticu/events{/privacy}", "received_events_url": "https://api.github.com/users/aticu/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/61427/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/61427/timeline", "performed_via_github_app": null, "state_reason": "completed"}