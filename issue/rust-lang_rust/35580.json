{"url": "https://api.github.com/repos/rust-lang/rust/issues/35580", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/35580/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/35580/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/35580/events", "html_url": "https://github.com/rust-lang/rust/issues/35580", "id": 170543471, "node_id": "MDU6SXNzdWUxNzA1NDM0NzE=", "number": 35580, "title": "Box<Error> leads to confusing error message since 'static isn't visible in user code", "user": {"login": "viraptor", "id": 188063, "node_id": "MDQ6VXNlcjE4ODA2Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/188063?v=4", "gravatar_id": "", "url": "https://api.github.com/users/viraptor", "html_url": "https://github.com/viraptor", "followers_url": "https://api.github.com/users/viraptor/followers", "following_url": "https://api.github.com/users/viraptor/following{/other_user}", "gists_url": "https://api.github.com/users/viraptor/gists{/gist_id}", "starred_url": "https://api.github.com/users/viraptor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/viraptor/subscriptions", "organizations_url": "https://api.github.com/users/viraptor/orgs", "repos_url": "https://api.github.com/users/viraptor/repos", "events_url": "https://api.github.com/users/viraptor/events{/privacy}", "received_events_url": "https://api.github.com/users/viraptor/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 234902, "node_id": "MDU6TGFiZWwyMzQ5MDI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-enhancement", "name": "C-enhancement", "color": "f5f1fd", "default": false, "description": "Category: An issue proposing an enhancement or a PR with one."}, {"id": 235791, "node_id": "MDU6TGFiZWwyMzU3OTE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-diagnostics", "name": "A-diagnostics", "color": "f7e101", "default": false, "description": "Area: Messages for errors, warnings, and lints"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2016-08-10T23:39:40Z", "updated_at": "2017-07-28T22:34:07Z", "closed_at": "2017-07-28T22:34:07Z", "author_association": "NONE", "active_lock_reason": null, "body": "I've got the following code (this is the smallest I could get it to):\n\n```\nuse std::error::Error;\n\nstruct SomeStruct;\n\n#[derive(Debug)]\nenum SomeError<'a> {\n    Something(&'a str),\n    Other,\n}\n\nfn do_stuff(doc: &usize) -> Result<SomeStruct, SomeError> {\n    Ok(SomeStruct)\n}\n\nfn get_things() -> Result<SomeStruct, Box<Error>> {\n    let res = try!(Err(SomeError::Other));\n    Ok(try!(do_stuff(&res)))\n}\n\nfn main() {\n    let _ = get_things();\n}\n\nimpl<'a> std::fmt::Display for SomeError<'a> {\n    fn fmt(&self, f: &mut std::fmt::Formatter) -> Result<(), std::fmt::Error> {\n        write!(f, \"blah\")\n    }\n}\nimpl<'a> Error for SomeError<'a> {\n    fn description(&self) -> &str { \"blah\" }\n}\n```\n\nWhich reports about `do_stuff(&res)`: \"reference must be valid for the static lifetime...\" but it never says why. With some extra code, the error actually shows extra information that `expected std::result::Result<SomeStruct, Box<std::error::Error + 'static>>, found std::result::Result<SomeStruct, Box<std::error::Error>>`, which helps (shows that the `Err` needs to be static), but doesn't explain why is that required. The `+ 'static` doesn't exist in the source and it only pops up randomly in the error message.\n\nI would expect at least the type mismatch to be always printed. And possibly some explanation why did the `'static` lifetime appear in it.\n", "closed_by": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/35580/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/35580/timeline", "performed_via_github_app": null, "state_reason": "completed"}