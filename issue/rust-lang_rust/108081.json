{"url": "https://api.github.com/repos/rust-lang/rust/issues/108081", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/108081/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/108081/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/108081/events", "html_url": "https://github.com/rust-lang/rust/issues/108081", "id": 1585962821, "node_id": "I_kwDOAAsO6M5eh99F", "number": 108081, "title": "Tracking Issue for `feature(packed_bundled_libs)`", "user": {"login": "petrochenkov", "id": 5751617, "node_id": "MDQ6VXNlcjU3NTE2MTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5751617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petrochenkov", "html_url": "https://github.com/petrochenkov", "followers_url": "https://api.github.com/users/petrochenkov/followers", "following_url": "https://api.github.com/users/petrochenkov/following{/other_user}", "gists_url": "https://api.github.com/users/petrochenkov/gists{/gist_id}", "starred_url": "https://api.github.com/users/petrochenkov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petrochenkov/subscriptions", "organizations_url": "https://api.github.com/users/petrochenkov/orgs", "repos_url": "https://api.github.com/users/petrochenkov/repos", "events_url": "https://api.github.com/users/petrochenkov/events{/privacy}", "received_events_url": "https://api.github.com/users/petrochenkov/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 37547, "node_id": "MDU6TGFiZWwzNzU0Nw==", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-linkage", "name": "A-linkage", "color": "f7e101", "default": false, "description": "Area: linking into static, shared libraries and binaries"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 650846969, "node_id": "MDU6TGFiZWw2NTA4NDY5Njk=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-tracking-issue", "name": "C-tracking-issue", "color": "f5f1fd", "default": false, "description": "Category: A tracking issue for an RFC or an unstable feature."}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2023-02-15T14:31:23Z", "updated_at": "2023-04-08T15:40:22Z", "closed_at": null, "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "This is a tracking issue for the fix for issue \"Linking modifier `whole-archive` and link time `cfg` are not supported on bundled static libraries\" (https://github.com/rust-lang/rust/issues/99429).\r\nThe feature gate for the issue is `#![feature(packed_bundled_libs)]`.\r\n\r\nCurrently to combine `+bundle` native libraries with `+whole-archive` or `cfg` a new representation of bundled native libraries in a rlib used, in which the library is packed into the archive as a whole (and wrapped into an object file for technical reasons), and then unpacked when you need to link to it.\r\n\r\nOther representations are also possible, e.g. keeping the bundled lib in the old \"unpacked\" format as a set of object files, and adding some description file telling which object files belong to which library, it would be more complex though.\r\n\r\nIt may be quite reasonable to support both packed and unpacked representations, both have their uses\r\n- the packed representation minimizes differences with classic non-bundled (`-bundle`) static libraries\r\n- the unpacked representation is needed when the rlib actually *provides* missing symbols to the native static lib, not just depends on it, as can be seen from the breakage report in https://github.com/rust-lang/rust/pull/102832\r\n\r\nStabilizing the `+bundle,+whole-archive` combination doesn't need specifying any of these details, we just need to promise that it somehow works.\r\n\r\n### About tracking issues\r\n\r\nTracking issues are used to record the overall progress of implementation.\r\nThey are also used as hubs connecting to other relevant issues, e.g., bugs or open design questions.\r\nA tracking issue is however *not* meant for large scale discussion, questions, or bug reports about a feature.\r\nInstead, open a dedicated issue for the specific matter and add the relevant feature gate label.\r\n\r\n### Steps\r\n\r\n- [x] Implement the RFC (cc @rust-lang/XXX -- can anyone write up mentoring\r\n      instructions?)\r\n- [ ] Adjust documentation ([see instructions on rustc-dev-guide][doc-guide])\r\n- [ ] Stabilization PR ([see instructions on rustc-dev-guide][stabilization-guide])\r\n\r\n[stabilization-guide]: https://rustc-dev-guide.rust-lang.org/stabilization_guide.html#stabilization-pr\r\n[doc-guide]: https://rustc-dev-guide.rust-lang.org/stabilization_guide.html#documentation-prs\r\n\r\n### Unresolved Questions\r\n\r\nNone yet.\r\n\r\n### Implementation history\r\n\r\n- Implemented in https://github.com/rust-lang/rust/pull/105601.\r\n", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/108081/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/108081/timeline", "performed_via_github_app": null, "state_reason": null}