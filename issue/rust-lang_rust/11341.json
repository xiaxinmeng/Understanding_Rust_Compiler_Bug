{"url": "https://api.github.com/repos/rust-lang/rust/issues/11341", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/11341/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/11341/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/11341/events", "html_url": "https://github.com/rust-lang/rust/issues/11341", "id": 25105728, "node_id": "MDU6SXNzdWUyNTEwNTcyOA==", "number": 11341, "title": "struct fields in enum declarations generate junk types", "user": {"login": "jorgeadriano", "id": 3189699, "node_id": "MDQ6VXNlcjMxODk2OTk=", "avatar_url": "https://avatars.githubusercontent.com/u/3189699?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jorgeadriano", "html_url": "https://github.com/jorgeadriano", "followers_url": "https://api.github.com/users/jorgeadriano/followers", "following_url": "https://api.github.com/users/jorgeadriano/following{/other_user}", "gists_url": "https://api.github.com/users/jorgeadriano/gists{/gist_id}", "starred_url": "https://api.github.com/users/jorgeadriano/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jorgeadriano/subscriptions", "organizations_url": "https://api.github.com/users/jorgeadriano/orgs", "repos_url": "https://api.github.com/users/jorgeadriano/repos", "events_url": "https://api.github.com/users/jorgeadriano/events{/privacy}", "received_events_url": "https://api.github.com/users/jorgeadriano/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 37544, "node_id": "MDU6TGFiZWwzNzU0NA==", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-typesystem", "name": "A-typesystem", "color": "f7e101", "default": false, "description": "Area: The type system"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2014-01-06T14:53:47Z", "updated_at": "2014-11-10T10:31:24Z", "closed_at": "2014-11-10T10:31:24Z", "author_association": "NONE", "active_lock_reason": null, "body": "A struct inside an enum generates a type identifier (as it does outside when used outside an enum). \n\n```\nenum S { C {a:int, b:int}};  \nenum C {};\n\nt.rs:10:4: 10:13 error: duplicate definition of type `C`\nt.rs:10     enum C {};\n        ^~~~~~~~~\nt.rs:9:13: 9:29 note: first definition of type `C` here\nt.rs:9     enum S { C {a:int, b:int}};  \n                ^~~~~~~~~~~~~~~~\n```\n\nIn particular the following declaration doesn't typecheck. \n\n```\nenum S { S {a:int, b:int}}; \n\nt.rs:6:13: 6:29 error: duplicate definition of type `S`\nt.rs:6     enum S { S {a:int, b:int}};  \n                    ^~~~~~~~~~~~~~~~\nt.rs:6:4: 6:30 note: first definition of type `S` here\nt.rs:6     enum S { S {a:int, b:int}};  \n```\n\nThis is inconsistent with the general case in which such is allowed. E.g., both declarations below type check, despite type and value constructors having the same identifier: \n\n```\nenum S { S(int, int) }\nstruct S {a:int, b:int};\n```\n\nAs a sidenote, we can't create values of these generated types even if wished to do so for some reason, since the value constructor associated with the struct field is set to create values of the enum type. \n\n```\nenum S { C {a:int, b:int} };  \nlet k : C = C{a:0, b:0};\n\nt.rs:10:12: 10:13 error: found value name used as a type: DefVariant(syntax::ast::DefId{crate: 0, node: 7}, syntax::ast::DefId{crate: 0, node: 14}, true)\nt.rs:10     let k : C = C{a:0, b:0};\n```\n## \n\nMy tests were performed on v0.8, but the bug was confirmed to be present in 0.9pre. Using Linux, OpenSUSE 13.1 \n", "closed_by": {"login": "huonw", "id": 1203825, "node_id": "MDQ6VXNlcjEyMDM4MjU=", "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4", "gravatar_id": "", "url": "https://api.github.com/users/huonw", "html_url": "https://github.com/huonw", "followers_url": "https://api.github.com/users/huonw/followers", "following_url": "https://api.github.com/users/huonw/following{/other_user}", "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}", "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/huonw/subscriptions", "organizations_url": "https://api.github.com/users/huonw/orgs", "repos_url": "https://api.github.com/users/huonw/repos", "events_url": "https://api.github.com/users/huonw/events{/privacy}", "received_events_url": "https://api.github.com/users/huonw/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/11341/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/11341/timeline", "performed_via_github_app": null, "state_reason": "completed"}