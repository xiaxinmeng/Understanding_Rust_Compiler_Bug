{"url": "https://api.github.com/repos/rust-lang/rust/issues/83143", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/83143/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/83143/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/83143/events", "html_url": "https://github.com/rust-lang/rust/issues/83143", "id": 831742363, "node_id": "MDU6SXNzdWU4MzE3NDIzNjM=", "number": 83143, "title": "Inclusion of gcc_s for static builds results in unsatisfied link", "user": {"login": "cromefire", "id": 26320625, "node_id": "MDQ6VXNlcjI2MzIwNjI1", "avatar_url": "https://avatars.githubusercontent.com/u/26320625?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cromefire", "html_url": "https://github.com/cromefire", "followers_url": "https://api.github.com/users/cromefire/followers", "following_url": "https://api.github.com/users/cromefire/following{/other_user}", "gists_url": "https://api.github.com/users/cromefire/gists{/gist_id}", "starred_url": "https://api.github.com/users/cromefire/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cromefire/subscriptions", "organizations_url": "https://api.github.com/users/cromefire/orgs", "repos_url": "https://api.github.com/users/cromefire/repos", "events_url": "https://api.github.com/users/cromefire/events{/privacy}", "received_events_url": "https://api.github.com/users/cromefire/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2021-03-15T12:03:44Z", "updated_at": "2021-03-18T14:21:19Z", "closed_at": "2021-03-18T14:21:19Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!--\r\nThank you for filing a bug report! \ud83d\udc1b Please provide a short summary of the bug,\r\nalong with any information you feel relevant to replicating the bug.\r\n-->\r\nRelated to xiph/rav1e#2690\r\n\r\nIf you run on a crate with staticlib the following:\r\n```\r\ncargo rustc --lib -- --print native-static-libs\r\n```\r\n\r\nYou'd get:\r\n```\r\nnote: Link against the following native artifacts when linking against this static library. The order and any duplication can be significant on some platforms.\r\n\r\nnote: native-static-libs: -lutil -lutil -lgcc_s -lutil -lrt -lpthread -lm -ldl -lc\r\n```\r\n\r\nI expected to see this happen: I'd expect it to be possible to just build a static binary from this, e.g. it only includes libraries that have static libs available\r\n\r\nInstead, this happened: It includes `gcc_s`, which only has a shared object available and outside of mingw no static library. This results in a build error, because in a static build the library can't be resolved.\r\n\r\n### Meta\r\n<!--\r\nIf you're using the stable version of the compiler, you should also check if the\r\nbug also exists in the beta or nightly versions.\r\n-->\r\n\r\n`rustc --version --verbose`:\r\n```\r\nrustc 1.50.0 (cb75ad5db 2021-02-10)\r\nbinary: rustc\r\ncommit-hash: cb75ad5db02783e8b0222fee363c5f63f7e2cf5b\r\ncommit-date: 2021-02-10\r\nhost: x86_64-unknown-linux-gnu\r\nrelease: 1.50.0\r\n```\r\n\r\n<!--\r\nInclude a backtrace in the code block by setting `RUST_BACKTRACE=1` in your\r\nenvironment. E.g. `RUST_BACKTRACE=1 cargo build`.\r\n-->\r\n<details><summary>Backtrace</summary>\r\n<p>\r\n\r\nN/A\r\n\r\n</p>\r\n</details>\r\n\r\n### Additional context\r\nInitial Ideas included that this is because of the unwinder, although there seems to be something else.\r\n\r\nIdeas for fixing it would maybe be either providing some alternative dependencies or using either `libgcc` or `libgcc_eh`, which have static counterparts available.\r\n\r\nhttps://github.com/xiph/rav1e/issues/2690#issuecomment-799347663", "closed_by": {"login": "cromefire", "id": 26320625, "node_id": "MDQ6VXNlcjI2MzIwNjI1", "avatar_url": "https://avatars.githubusercontent.com/u/26320625?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cromefire", "html_url": "https://github.com/cromefire", "followers_url": "https://api.github.com/users/cromefire/followers", "following_url": "https://api.github.com/users/cromefire/following{/other_user}", "gists_url": "https://api.github.com/users/cromefire/gists{/gist_id}", "starred_url": "https://api.github.com/users/cromefire/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cromefire/subscriptions", "organizations_url": "https://api.github.com/users/cromefire/orgs", "repos_url": "https://api.github.com/users/cromefire/repos", "events_url": "https://api.github.com/users/cromefire/events{/privacy}", "received_events_url": "https://api.github.com/users/cromefire/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/83143/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/83143/timeline", "performed_via_github_app": null, "state_reason": "completed"}