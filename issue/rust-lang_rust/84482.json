{"url": "https://api.github.com/repos/rust-lang/rust/issues/84482", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/84482/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/84482/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/84482/events", "html_url": "https://github.com/rust-lang/rust/issues/84482", "id": 866213598, "node_id": "MDU6SXNzdWU4NjYyMTM1OTg=", "number": 84482, "title": "Unstable Fingerprints", "user": {"login": "clemmsch", "id": 67063997, "node_id": "MDQ6VXNlcjY3MDYzOTk3", "avatar_url": "https://avatars.githubusercontent.com/u/67063997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/clemmsch", "html_url": "https://github.com/clemmsch", "followers_url": "https://api.github.com/users/clemmsch/followers", "following_url": "https://api.github.com/users/clemmsch/following{/other_user}", "gists_url": "https://api.github.com/users/clemmsch/gists{/gist_id}", "starred_url": "https://api.github.com/users/clemmsch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/clemmsch/subscriptions", "organizations_url": "https://api.github.com/users/clemmsch/orgs", "repos_url": "https://api.github.com/users/clemmsch/repos", "events_url": "https://api.github.com/users/clemmsch/events{/privacy}", "received_events_url": "https://api.github.com/users/clemmsch/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 307747675, "node_id": "MDU6TGFiZWwzMDc3NDc2NzU=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-incr-comp", "name": "A-incr-comp", "color": "f7e101", "default": false, "description": "Area: Incremental compilation"}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-04-23T15:23:10Z", "updated_at": "2021-04-30T11:29:06Z", "closed_at": "2021-04-30T11:29:06Z", "author_association": "NONE", "active_lock_reason": null, "body": "I would also like to note that I commented out all of the code in all of my files so that all of the files are literally comments. The only line of Rust Code after my outcommenting was \r\n```Rust\r\nfn main() {}\r\n```\r\nand it still did not compile and failed with the same error, just not in utils, but rather in my main project.\r\n### Code\r\n\r\n```Rust\r\nfn main() {\r\n    let x = std::fs::read_to_string(\"setup.py\");\r\n    dump!(x);\r\n}\r\n```\r\nDefinition of dump (I think it panics there as it tells me that get_type_of() is \"well formed end of query stack\")\r\n```Rust\r\n#![feature(core_intrinsics)]\r\n\r\npub fn get_type_of<T>(_: T) -> String {\r\n    unsafe { std::intrinsics::type_name::<T>() }.to_owned()\r\n}\r\n\r\n#[macro_export]\r\nmacro_rules! dump {\r\n    ($($a: expr),*) => {\r\n        println!(concat!(\"[\", file!(),\":\", line!(), \"] \", $(stringify!($a), \": {} = {:?}; \"),*), $($crate::get_type_of(&$a), $a),*);\r\n    }\r\n}\r\n```` \r\n\r\n\r\n### Meta\r\n`rustc --version --verbose`:\r\n```\r\nrustc 1.53.0-nightly (7f4afdf02 2021-04-22)\r\nbinary: rustc\r\ncommit-hash: 7f4afdf0255600306bf67432da722c7b5d2cbf82\r\ncommit-date: 2021-04-22\r\nhost: x86_64-pc-windows-msvc\r\nrelease: 1.53.0-nightly\r\nLLVM version: 12.0.0\r\n```\r\n\r\n### Error output\r\n\r\n```\r\n     Running `rustc --crate-name utils --edition=2018 utils\\src\\lib.rs --error-format=json --json=diagnostic-rendered-ansi --crate-type lib --emit=dep-info,metadata,link -C embed-bitcode=no -C debuginfo=2 -C metadata=b3a146c2e75b4b1c -C extra-filename=-b3a146c2e75b4b1c --out-dir D:\\WINDOWS\\dev\\liviia\\target\\debug\\deps -C incremental=D:\\WINDOWS\\dev\\liviia\\target\\debug\\incremental -L dependency=D:\\WINDOWS\\dev\\liviia\\target\\debug\\deps`\r\nthread 'rustc' panicked at 'assertion failed: `(left == right)`\r\n  left: `Some(Fingerprint(10247099565525236000, 6669105383491821076))`,\r\n right: `Some(Fingerprint(8485006540857454277, 14781803188155767199))`: found unstable fingerprints for predicates_of(core[d23b]::marker::Sized): GenericPredicates { parent: None, predicates: [(Binder(TraitPredicate(<Self as std::marker::Sized>), []), C:\\Users\\Clemens\\.rustup\\toolchains\\nightly-x86_64-pc-windows-msvc\\lib/rustlib/src/rust\\library\\core\\src\\marker.rs:92:1: 92:16 (#0))] }', /rustc/7f4afdf0255600306bf67432da722c7b5d2cbf82\\compiler\\rustc_query_system\\src\\query\\plumbing.rs:593:5\r\nnote: run with `RUST_BACKTRACE=1` environment variable to display a backtrace\r\n\r\nerror: internal compiler error: unexpected panic\r\n\r\nnote: the compiler unexpectedly panicked. this is a bug.\r\n\r\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/issues/new?labels=C-bug%2C+I-ICE%2C+T-compiler&template=ice.md\r\n\r\nnote: rustc 1.53.0-nightly (7f4afdf02 2021-04-22) running on x86_64-pc-windows-msvc\r\n\r\nnote: compiler flags: -C embed-bitcode=no -C debuginfo=2 -C incremental --crate-type lib\r\n\r\nnote: some of the compiler flags provided by cargo are hidden\r\n\r\nquery stack during panic:\r\n#0 [predicates_of] computing predicates of `std::marker::Sized`\r\n#1 [check_item_well_formed] checking that `get_type_of` is well-formed\r\nend of query stack\r\nerror: could not compile `utils`\r\n\r\nCaused by:\r\n  process didn't exit successfully: `rustc --crate-name utils --edition=2018 utils\\src\\lib.rs --error-format=json --json=diagnostic-rendered-ansi --crate-type lib --emit=dep-info,metadata,link -C embed-bitcode=no -C debuginfo=2 -C metadata=b3a146c2e75b4b1c -C extra-filename=-b3a146c2e75b4b1c --out-dir D:\\WINDOWS\\dev\\liviia\\target\\debug\\deps -C incremental=D:\\WINDOWS\\dev\\liviia\\target\\debug\\incremental -L dependency=D:\\WINDOWS\\dev\\liviia\\target\\debug\\deps` (exit code: 101)\r\n```\r\n\r\n<details><summary><strong>Backtrace</strong></summary>\r\n<p>\r\n\r\n```\r\n     Running `rustc --crate-name utils --edition=2018 utils\\src\\lib.rs --error-format=json --json=diagnostic-rendered-ansi --crate-type lib --emit=dep-info,metadata,link -C embed-bitcode=no -C debuginfo=2 -C metadata=b3a146c2e75b4b1c -C extra-filename=-b3a146c2e75b4b1c --out-dir D:\\WINDOWS\\dev\\liviia\\target\\debug\\deps -C incremental=D:\\WINDOWS\\dev\\liviia\\target\\debug\\incremental -L dependency=D:\\WINDOWS\\dev\\liviia\\target\\debug\\deps`\r\nthread 'rustc' panicked at 'assertion failed: `(left == right)`\r\n  left: `Some(Fingerprint(10247099565525236000, 6669105383491821076))`,\r\n right: `Some(Fingerprint(8485006540857454277, 14781803188155767199))`: found unstable fingerprints for predicates_of(core[d23b]::marker::Sized): GenericPredicates { parent: None, predicates: [(Binder(TraitPredicate(<Self as std::marker::Sized>), []), C:\\Users\\Clemens\\.rustup\\toolchains\\nightly-x86_64-pc-windows-msvc\\lib/rustlib/src/rust\\library\\core\\src\\marker.rs:92:1: 92:16 (#0))] }', /rustc/7f4afdf0255600306bf67432da722c7b5d2cbf82\\compiler\\rustc_query_system\\src\\query\\plumbing.rs:593:5\r\nstack backtrace:\r\nnote: Some details are omitted, run with `RUST_BACKTRACE=full` for a verbose backtrace.\r\n\r\nerror: internal compiler error: unexpected panic\r\n\r\nnote: the compiler unexpectedly panicked. this is a bug.\r\n\r\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/issues/new?labels=C-bug%2C+I-ICE%2C+T-compiler&template=ice.md\r\n\r\nnote: rustc 1.53.0-nightly (7f4afdf02 2021-04-22) running on x86_64-pc-windows-msvc\r\n\r\nnote: compiler flags: -C embed-bitcode=no -C debuginfo=2 -C incremental --crate-type lib\r\n\r\nnote: some of the compiler flags provided by cargo are hidden\r\n\r\nquery stack during panic:\r\n#0 [predicates_of] computing predicates of `std::marker::Sized`\r\n#1 [check_item_well_formed] checking that `get_type_of` is well-formed\r\n#2 [analysis] running analysis passes on this crate\r\nend of query stack\r\nerror: could not compile `utils`\r\n\r\nCaused by:\r\n  process didn't exit successfully: `rustc --crate-name utils --edition=2018 utils\\src\\lib.rs --error-format=json --json=diagnostic-rendered-ansi --crate-type lib --emit=dep-info,metadata,link -C embed-bitcode=no -C debuginfo=2 -C metadata=b3a146c2e75b4b1c -C extra-filename=-b3a146c2e75b4b1c --out-dir D:\\WINDOWS\\dev\\liviia\\target\\debug\\deps -C incremental=D:\\WINDOWS\\dev\\liviia\\target\\debug\\incremental -L dependency=D:\\WINDOWS\\dev\\liviia\\target\\debug\\deps` (exit code: 101)\r\n```\r\nAs this (I think) is the same as before, here is the backtrace with RUST_BACKTRACE=\"full\"\r\n```\r\n     Running `rustc --crate-name utils --edition=2018 utils\\src\\lib.rs --error-format=json --json=diagnostic-rendered-ansi --crate-type lib --emit=dep-info,metadata,link -C embed-bitcode=no -C debuginfo=2 -C metadata=b3a146c2e75b4b1c -C extra-filename=-b3a146c2e75b4b1c --out-dir D:\\WINDOWS\\dev\\liviia\\target\\debug\\deps -C incremental=D:\\WINDOWS\\dev\\liviia\\target\\debug\\incremental -L dependency=D:\\WINDOWS\\dev\\liviia\\target\\debug\\deps`\r\nthread 'rustc' panicked at 'assertion failed: `(left == right)`\r\n  left: `Some(Fingerprint(10247099565525236000, 6669105383491821076))`,\r\n right: `Some(Fingerprint(8485006540857454277, 14781803188155767199))`: found unstable fingerprints for predicates_of(core[d23b]::marker::Sized): GenericPredicates { parent: None, predicates: [(Binder(TraitPredicate(<Self as std::marker::Sized>), []), C:\\Users\\Clemens\\.rustup\\toolchains\\nightly-x86_64-pc-windows-msvc\\lib/rustlib/src/rust\\library\\core\\src\\marker.rs:92:1: 92:16 (#0))] }', /rustc/7f4afdf0255600306bf67432da722c7b5d2cbf82\\compiler\\rustc_query_system\\src\\query\\plumbing.rs:593:5\r\nstack backtrace:\r\n   0:     0x7ffa05555b8e - <std::sys_common::backtrace::_print::DisplayBacktrace as core::fmt::Display>::fmt::h65f771762210e3e5\r\n   1:     0x7ffa0557edac - core::fmt::write::h3d73561f801c6731\r\n   2:     0x7ffa05549c28 - <std::io::IoSliceMut as core::fmt::Debug>::fmt::hd8fe844d61210e6f\r\n   3:     0x7ffa05559c82 - std::panicking::take_hook::ha49dee799706a2d8\r\n   4:     0x7ffa05559774 - std::panicking::take_hook::ha49dee799706a2d8\r\n   5:     0x7ff9819ab2a7 - rustc_driver::report_ice::hab89c69e12b6dd11\r\n   6:     0x7ffa0555a465 - std::panicking::rust_panic_with_hook::h9e7cc259d68b1de2\r\n   7:     0x7ffa0555a041 - rust_begin_unwind\r\n   8:     0x7ffa055564df - <std::sys_common::backtrace::_print::DisplayBacktrace as core::fmt::Display>::fmt::h65f771762210e3e5\r\n   9:     0x7ffa05559f99 - rust_begin_unwind\r\n  10:     0x7ffa055b2ba0 - core::panicking::panic_fmt::h158e503d917f32a6\r\n  11:     0x7ffa0557b6b8 - core::panicking::assert_failed_inner::h996c70ce1c4b9208\r\n  12:     0x7ff985cf9a30 - <f64 as ryu::buffer::Sealed>::format_nonfinite::h0e70a5fe4e7d35d9\r\n  13:     0x7ff98452246d - <rustc_ast_lowering::item::ItemLowerer as rustc_ast::visit::Visitor>::visit_foreign_item::hbd68f25166d1e477\r\n  14:     0x7ff984556b1f - <rustc_ast_lowering::item::ItemLowerer as rustc_ast::visit::Visitor>::visit_foreign_item::hbd68f25166d1e477\r\n  15:     0x7ff9845b619b - <rustc_ast_lowering::item::ItemLowerer as rustc_ast::visit::Visitor>::visit_foreign_item::hbd68f25166d1e477\r\n  16:     0x7ff9843f3c40 - <rustc_ast_lowering::item::ItemLowerer as rustc_ast::visit::Visitor>::visit_foreign_item::hbd68f25166d1e477\r\n  17:     0x7ff98476db2d - <rustc_query_impl::Queries as rustc_middle::ty::query::QueryEngine>::try_print_query_stack::h3c4346cc01dbde58\r\n  18:     0x7ff98562973d - rustc_trait_selection::traits::wf::predicate_obligations::h123d136a861f1b26\r\n  19:     0x7ff985627b37 - rustc_trait_selection::traits::wf::predicate_obligations::h123d136a861f1b26\r\n  20:     0x7ff98562712c - rustc_trait_selection::traits::wf::predicate_obligations::h123d136a861f1b26\r\n  21:     0x7ff9841ef14a - <rustc_typeck::check::closure::ExpectedSig as core::fmt::Debug>::fmt::h6ccb951e7afc138b\r\n  22:     0x7ff9841f0315 - <rustc_typeck::check::wfcheck::check_where_clauses::{{closure}}::CountParams as rustc_middle::ty::fold::TypeVisitor>::visit_const::h72d346efc21393b0\r\n  23:     0x7ff9840c3b47 - <<dyn rustc_typeck::astconv::AstConv>::create_substs_for_ast_path::SubstsForAstPathCtxt as rustc_typeck::astconv::CreateSubstsForGenericArgsCtxt>::inferred_kind::hc89e7f26a29e19ed\r\n  24:     0x7ff9841ea28a - <rustc_typeck::check::closure::ExpectedSig as core::fmt::Debug>::fmt::h6ccb951e7afc138b\r\n  25:     0x7ff984784da9 - <rustc_query_impl::Queries as rustc_middle::ty::query::QueryEngine>::try_print_query_stack::h3c4346cc01dbde58\r\n  26:     0x7ff9847168bf - rustc_query_impl::<impl rustc_query_system::query::config::QueryAccessors<rustc_query_impl::plumbing::QueryCtxt> for rustc_query_impl::queries::resolve_instance>::hash_result::hc7ba1ed25ba761ff\r\n  27:     0x7ff98459d51a - <rustc_ast_lowering::item::ItemLowerer as rustc_ast::visit::Visitor>::visit_foreign_item::hbd68f25166d1e477\r\n  28:     0x7ff9844c2b2b - <rustc_ast_lowering::item::ItemLowerer as rustc_ast::visit::Visitor>::visit_foreign_item::hbd68f25166d1e477\r\n  29:     0x7ff984450bae - <rustc_ast_lowering::item::ItemLowerer as rustc_ast::visit::Visitor>::visit_foreign_item::hbd68f25166d1e477\r\n  30:     0x7ff984775572 - <rustc_query_impl::Queries as rustc_middle::ty::query::QueryEngine>::try_print_query_stack::h3c4346cc01dbde58\r\n  31:     0x7ff9841f3abc - <rustc_typeck::check::wfcheck::CheckTypeWellFormedVisitor as rustc_hir::intravisit::Visitor>::visit_item::h79b59316ccb35910\r\n  32:     0x7ff9841bba83 - <rustc_typeck::outlives::explicit::ExplicitPredicatesMap as core::fmt::Debug>::fmt::ha36044c869e3f05c\r\n  33:     0x7ff9840e8ed1 - <<dyn rustc_typeck::astconv::AstConv>::create_substs_for_ast_path::SubstsForAstPathCtxt as rustc_typeck::astconv::CreateSubstsForGenericArgsCtxt>::inferred_kind::hc89e7f26a29e19ed\r\n  34:     0x7ff98405375b - <rustc_typeck::check::op::Op as core::fmt::Debug>::fmt::hc2f86cced49ebf11\r\n  35:     0x7ff9840fcc7c - rustc_typeck::check_crate::hb05ec982ff644b15\r\n  36:     0x7ff981ae46f5 - rustc_interface::passes::BoxedResolver::to_resolver_outputs::h51cffbb6bc3edf8f\r\n  37:     0x7ff984786959 - <rustc_query_impl::Queries as rustc_middle::ty::query::QueryEngine>::try_print_query_stack::h3c4346cc01dbde58\r\n  38:     0x7ff984715a72 - rustc_query_impl::<impl rustc_query_system::query::config::QueryAccessors<rustc_query_impl::plumbing::QueryCtxt> for rustc_query_impl::queries::resolve_instance>::hash_result::hc7ba1ed25ba761ff\r\n  39:     0x7ff9845aa627 - <rustc_ast_lowering::item::ItemLowerer as rustc_ast::visit::Visitor>::visit_foreign_item::hbd68f25166d1e477\r\n  40:     0x7ff9844e072a - <rustc_ast_lowering::item::ItemLowerer as rustc_ast::visit::Visitor>::visit_foreign_item::hbd68f25166d1e477\r\n  41:     0x7ff98447822e - <rustc_ast_lowering::item::ItemLowerer as rustc_ast::visit::Visitor>::visit_foreign_item::hbd68f25166d1e477\r\n  42:     0x7ff98476d972 - <rustc_query_impl::Queries as rustc_middle::ty::query::QueryEngine>::try_print_query_stack::h3c4346cc01dbde58\r\n  43:     0x7ff9819e30ba - <rustc_middle::ty::SymbolName as core::fmt::Debug>::fmt::ha51d28018e278c75\r\n  44:     0x7ff9819b5a3b - rustc_driver::pretty::print_after_hir_lowering::h018530f73994254f\r\n  45:     0x7ff9819ad9dc - <rustc_driver::Compilation as core::fmt::Debug>::fmt::h4409e290eea8174b\r\n  46:     0x7ff9819b6d56 - rustc_driver::pretty::print_after_hir_lowering::h018530f73994254f\r\n  47:     0x7ff9819dd0e4 - <rustc_middle::ty::SymbolName as core::fmt::Debug>::fmt::ha51d28018e278c75\r\n  48:     0x7ff9819df7ff - <rustc_middle::ty::SymbolName as core::fmt::Debug>::fmt::ha51d28018e278c75\r\n  49:     0x7ff9819e9ddd - <rustc_middle::ty::SymbolName as core::fmt::Debug>::fmt::ha51d28018e278c75\r\n  50:     0x7ffa0556851a - std::sys::windows::thread::Thread::new::h35832c8baf769397\r\n  51:     0x7ffa4e7d7034 - BaseThreadInitThunk\r\n  52:     0x7ffa4f6c2651 - RtlUserThreadStart\r\n\r\nerror: internal compiler error: unexpected panic\r\n\r\nnote: the compiler unexpectedly panicked. this is a bug.\r\n\r\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/issues/new?labels=C-bug%2C+I-ICE%2C+T-compiler&template=ice.md\r\n\r\nnote: rustc 1.53.0-nightly (7f4afdf02 2021-04-22) running on x86_64-pc-windows-msvc\r\n\r\nnote: compiler flags: -C embed-bitcode=no -C debuginfo=2 -C incremental --crate-type lib\r\n\r\nnote: some of the compiler flags provided by cargo are hidden\r\n\r\nquery stack during panic:\r\n#0 [predicates_of] computing predicates of `std::marker::Sized`\r\n#1 [check_item_well_formed] checking that `get_type_of` is well-formed\r\n#2 [analysis] running analysis passes on this crate\r\nend of query stack\r\nerror: could not compile `utils`\r\n\r\nCaused by:\r\n  process didn't exit successfully: `rustc --crate-name utils --edition=2018 utils\\src\\lib.rs --error-format=json --json=diagnostic-rendered-ansi --crate-type lib --emit=dep-info,metadata,link -C embed-bitcode=no -C debuginfo=2 -C metadata=b3a146c2e75b4b1c -C extra-filename=-b3a146c2e75b4b1c --out-dir D:\\WINDOWS\\dev\\liviia\\target\\debug\\deps -C incremental=D:\\WINDOWS\\dev\\liviia\\target\\debug\\incremental -L dependency=D:\\WINDOWS\\dev\\liviia\\target\\debug\\deps` (exit code: 101)\r\n```\r\n\r\n</p>\r\n</details>\r\n\r\n", "closed_by": {"login": "jonas-schievink", "id": 1786438, "node_id": "MDQ6VXNlcjE3ODY0Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/1786438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jonas-schievink", "html_url": "https://github.com/jonas-schievink", "followers_url": "https://api.github.com/users/jonas-schievink/followers", "following_url": "https://api.github.com/users/jonas-schievink/following{/other_user}", "gists_url": "https://api.github.com/users/jonas-schievink/gists{/gist_id}", "starred_url": "https://api.github.com/users/jonas-schievink/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jonas-schievink/subscriptions", "organizations_url": "https://api.github.com/users/jonas-schievink/orgs", "repos_url": "https://api.github.com/users/jonas-schievink/repos", "events_url": "https://api.github.com/users/jonas-schievink/events{/privacy}", "received_events_url": "https://api.github.com/users/jonas-schievink/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/84482/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/84482/timeline", "performed_via_github_app": null, "state_reason": "completed"}