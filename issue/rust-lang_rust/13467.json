{"url": "https://api.github.com/repos/rust-lang/rust/issues/13467", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/13467/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/13467/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/13467/events", "html_url": "https://github.com/rust-lang/rust/issues/13467", "id": 31362221, "node_id": "MDU6SXNzdWUzMTM2MjIyMQ==", "number": 13467, "title": "Vec<()> does not iterate correctly", "user": {"login": "andrewd18", "id": 761994, "node_id": "MDQ6VXNlcjc2MTk5NA==", "avatar_url": "https://avatars.githubusercontent.com/u/761994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/andrewd18", "html_url": "https://github.com/andrewd18", "followers_url": "https://api.github.com/users/andrewd18/followers", "following_url": "https://api.github.com/users/andrewd18/following{/other_user}", "gists_url": "https://api.github.com/users/andrewd18/gists{/gist_id}", "starred_url": "https://api.github.com/users/andrewd18/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/andrewd18/subscriptions", "organizations_url": "https://api.github.com/users/andrewd18/orgs", "repos_url": "https://api.github.com/users/andrewd18/repos", "events_url": "https://api.github.com/users/andrewd18/events{/privacy}", "received_events_url": "https://api.github.com/users/andrewd18/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2014-04-11T21:04:43Z", "updated_at": "2014-04-13T12:46:56Z", "closed_at": "2014-04-13T12:46:56Z", "author_association": "NONE", "active_lock_reason": null, "body": "# Updated report\n\nIt appears that iterators over vectors of 0-sized values are not currently valid:\n\n``` rust\nfn main() { \n    assert!(vec!(()).iter().len() == 1); \n}\n```\n# Original report\n\n**rust 0.10 for loop ignores trait methods on unit-like structs**\n\nUsing Rust 0.10 on Windows. If I call a for loop on structs that implement a trait method, structs with attributes have their methods called. Unit-like structs do not. As far as I can tell, the for loop never iterates despite there being an object to iterate upon.\n\nCalling the methods in other contexts (directly, or in a vec cast to trait) works as expected.\n\n```\ntrait GetAttribute {\n    fn get_attribute(&self) -> int;\n}\n\nstruct VariableAttribute {\n    attribute: int\n}\nimpl GetAttribute for VariableAttribute {\n    fn get_attribute(&self) -> int {\n        self.attribute\n    }\n}\n\nstruct UnitLike;\nimpl GetAttribute for UnitLike {\n    fn get_attribute(&self) -> int {\n        4\n    }\n}\n\nfn main() {\n    let va = VariableAttribute{attribute: 1};\n    let ul = UnitLike;\n\n    // Calling the method on each object individually works.\n    let mut total = 0;\n    total += va.get_attribute();\n    total += ul.get_attribute();\n\n    assert_eq!(total, 5);\n\n\n    // Placing each object in a vector cast to the trait,\n    // then calling the method on each object works.\n    let cast_vec = vec!(&va as &GetAttribute, &ul as &GetAttribute);\n    let mut cast_vec_total = 0;\n    for object in cast_vec.iter() { cast_vec_total += object.get_attribute() }\n\n    assert_eq!(cast_vec_total, 5);\n\n    // However, placing each object in their own, non-cast vectors,\n    // then calling the method on each object fails\n    let va_vec = vec!(va);\n    let sa_vec = vec!(ul);\n\n    let mut noncast_vec_total = 0;\n    for object in va_vec.iter() { noncast_vec_total += object.get_attribute() }\n    for object in sa_vec.iter() { noncast_vec_total += object.get_attribute() }\n\n    // The sa vector does have a length...\n    assert_eq!(1, sa_vec.len());\n\n    // ... But without a variable in the struct, the for loop doesn't even care.\n    for object in sa_vec.iter() { println!(\"I never even get called. :(\"); }\n\n    // And thus we get 1.\n    assert_eq!(noncast_vec_total, 5);\n}\n```\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/13467/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/13467/timeline", "performed_via_github_app": null, "state_reason": "completed"}