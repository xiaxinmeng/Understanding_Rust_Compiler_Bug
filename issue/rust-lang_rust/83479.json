{"url": "https://api.github.com/repos/rust-lang/rust/issues/83479", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/83479/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/83479/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/83479/events", "html_url": "https://github.com/rust-lang/rust/issues/83479", "id": 841147340, "node_id": "MDU6SXNzdWU4NDExNDczNDA=", "number": 83479, "title": "ICE: panicked at 'already borrowed: BorrowMutError' and thread panicked while panicking. aborting.", "user": {"login": "chengniansun", "id": 4554271, "node_id": "MDQ6VXNlcjQ1NTQyNzE=", "avatar_url": "https://avatars.githubusercontent.com/u/4554271?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chengniansun", "html_url": "https://github.com/chengniansun", "followers_url": "https://api.github.com/users/chengniansun/followers", "following_url": "https://api.github.com/users/chengniansun/following{/other_user}", "gists_url": "https://api.github.com/users/chengniansun/gists{/gist_id}", "starred_url": "https://api.github.com/users/chengniansun/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chengniansun/subscriptions", "organizations_url": "https://api.github.com/users/chengniansun/orgs", "repos_url": "https://api.github.com/users/chengniansun/repos", "events_url": "https://api.github.com/users/chengniansun/events{/privacy}", "received_events_url": "https://api.github.com/users/chengniansun/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}, {"id": 4199206102, "node_id": "LA_kwDOAAsO6M76SszW", "url": "https://api.github.com/repos/rust-lang/rust/labels/requires-debug-assertions", "name": "requires-debug-assertions", "color": "76dcde", "default": false, "description": "This issue requires debug-assertions in some way"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-03-25T17:21:35Z", "updated_at": "2022-12-22T11:24:07Z", "closed_at": null, "author_association": "NONE", "active_lock_reason": null, "body": "<!--\r\nThank you for finding an Internal Compiler Error! \ud83e\uddca  If possible, try to provide\r\na minimal verifiable example. You can read \"Rust Bug Minimization Patterns\" for\r\nhow to create smaller examples.\r\n\r\nhttp://blog.pnkfx.org/blog/2019/11/18/rust-bug-minimization-patterns/\r\n\r\n-->\r\n\r\n### Code\r\n\r\n```Rust\r\ntype PairCoupledTypes: Trait<\r\n    [u32; {\r\n        static FOO: usize;\r\n    }],\r\n> = impl Trait<\r\n    [u32; {\r\n        static FOO: usize;\r\n    }],\r\n>;\r\n```\r\n\r\n\r\n### Meta\r\n<!--\r\nIf you're using the stable version of the compiler, you should also check if the\r\nbug also exists in the beta or nightly versions.\r\n-->\r\n\r\n`rustc --version --verbose`:\r\n```\r\nrustc 1.53.0-nightly (07e0e2ec2 2021-03-24)\r\nbinary: rustc\r\ncommit-hash: 07e0e2ec268c140e607e1ac7f49f145612d0f597\r\ncommit-date: 2021-03-24\r\nhost: x86_64-unknown-linux-gnu\r\nrelease: 1.53.0-nightly\r\nLLVM version: 12.0.0\r\n```\r\n\r\n### Error output\r\n\r\n```\r\nerror: bounds on `type`s in this context have no effect\r\n --> perses_node_priority_with_dfs_delta_reduced_mutant.rs:1:24\r\n  |\r\n1 |   type PairCoupledTypes: Trait<\r\n  |  ________________________^\r\n2 | |     [u32; {\r\n3 | |         static FOO: usize;\r\n4 | |     }],\r\n5 | | > = impl Trait<\r\n  | |_^\r\n\r\nerror: free static item without body\r\n --> perses_node_priority_with_dfs_delta_reduced_mutant.rs:3:9\r\n  |\r\n3 |         static FOO: usize;\r\n  |         ^^^^^^^^^^^^^^^^^-\r\n  |                          |\r\n  |                          help: provide a definition for the static: `= <expr>;`\r\n\r\nerror: free static item without body\r\n --> perses_node_priority_with_dfs_delta_reduced_mutant.rs:7:9\r\n  |\r\n7 |         static FOO: usize;\r\n  |         ^^^^^^^^^^^^^^^^^-\r\n  |                          |\r\n  |                          help: provide a definition for the static: `= <expr>;`\r\n\r\nerror[E0405]: cannot find trait `Trait` in this scope\r\n --> perses_node_priority_with_dfs_delta_reduced_mutant.rs:1:24\r\n  |\r\n1 | type PairCoupledTypes: Trait<\r\n  |                        ^^^^^ not found in this scope\r\n\r\nerror[E0405]: cannot find trait `Trait` in this scope\r\n --> perses_node_priority_with_dfs_delta_reduced_mutant.rs:5:10\r\n  |\r\n5 | > = impl Trait<\r\n  |          ^^^^^ not found in this scope\r\n\r\nerror[E0658]: `impl Trait` in type aliases is unstable\r\n --> perses_node_priority_with_dfs_delta_reduced_mutant.rs:5:5\r\n  |\r\n5 |   > = impl Trait<\r\n  |  _____^\r\n6 | |     [u32; {\r\n7 | |         static FOO: usize;\r\n8 | |     }],\r\n9 | | >;\r\n  | |_^\r\n  |\r\n  = note: see issue #63063 <https://github.com/rust-lang/rust/issues/63063> for more information\r\n  = help: add `#![feature(min_type_alias_impl_trait)]` to the crate attributes to enable\r\n\r\nthread 'rustc' panicked at 'called `Option::unwrap()` on a `None` value', compiler/rustc_middle/src/hir/map/collector.rs:156:78\r\nnote: run with `RUST_BACKTRACE=1` environment variable to display a backtrace\r\n\r\nerror: internal compiler error: unexpected panic\r\n\r\nnote: the compiler unexpectedly panicked. this is a bug.\r\n\r\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/issues/new?labels=C-bug%2C+I-ICE%2C+T-compiler&template=ice.md\r\n\r\nnote: rustc 1.53.0-nightly (07e0e2ec2 2021-03-24) running on x86_64-unknown-linux-gnu\r\n\r\nquery stack during panic:\r\nthread 'rustc' panicked at 'already borrowed: BorrowMutError', /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/compiler/rustc_data_structures/src/sync.rs:481:16\r\nstack backtrace:\r\n   0:     0x7fd27e03ff80 - std::backtrace_rs::backtrace::libunwind::trace::h4dee703919bfd40a\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/std/src/../../backtrace/src/backtrace/libunwind.rs:90:5\r\n   1:     0x7fd27e03ff80 - std::backtrace_rs::backtrace::trace_unsynchronized::h457e839f1a563e20\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/std/src/../../backtrace/src/backtrace/mod.rs:66:5\r\n   2:     0x7fd27e03ff80 - std::sys_common::backtrace::_print_fmt::h86a55fb30f8393c8\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/std/src/sys_common/backtrace.rs:67:5\r\n   3:     0x7fd27e03ff80 - <std::sys_common::backtrace::_print::DisplayBacktrace as core::fmt::Display>::fmt::h7b3d6cac46d277e1\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/std/src/sys_common/backtrace.rs:46:22\r\n   4:     0x7fd27e0ae8df - core::fmt::write::h127419eb46f2ecc9\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/core/src/fmt/mod.rs:1092:17\r\n   5:     0x7fd27e034505 - std::io::Write::write_fmt::h6010cfbb4726588b\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/std/src/io/mod.rs:1578:15\r\n   6:     0x7fd27e043cbb - std::sys_common::backtrace::_print::h79b4f9652330cc9d\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/std/src/sys_common/backtrace.rs:49:5\r\n   7:     0x7fd27e043cbb - std::sys_common::backtrace::print::h330bb326a76af8cf\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/std/src/sys_common/backtrace.rs:36:9\r\n   8:     0x7fd27e043cbb - std::panicking::default_hook::{{closure}}::heb6a42a7d50a472e\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/std/src/panicking.rs:208:50\r\n   9:     0x7fd27e043783 - std::panicking::default_hook::h17e521ba6d68d6e1\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/std/src/panicking.rs:225:9\r\n  10:     0x7fd27e815f2b - rustc_driver::report_ice::ha40982d59fc75b99\r\n  11:     0x7fd27e0443d0 - std::panicking::rust_panic_with_hook::h70db735e3a6e70cb\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/std/src/panicking.rs:595:17\r\n  12:     0x7fd27e043fa7 - std::panicking::begin_panic_handler::{{closure}}::h777c71c8e5a7e25c\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/std/src/panicking.rs:497:13\r\n  13:     0x7fd27e04043c - std::sys_common::backtrace::__rust_end_short_backtrace::h3e9bf30168899554\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/std/src/sys_common/backtrace.rs:141:18\r\n  14:     0x7fd27e043f09 - rust_begin_unwind\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/std/src/panicking.rs:493:5\r\n  15:     0x7fd27e00af31 - core::panicking::panic_fmt::h5322a082d19786c3\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/core/src/panicking.rs:92:14\r\n  16:     0x7fd27e00ae23 - core::option::expect_none_failed::h354eaa93a51d71b8\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/core/src/option.rs:1329:5\r\n  17:     0x7fd27fd7d6b1 - rustc_query_system::query::plumbing::get_query_impl::h9285eb59969e22c8\r\n  18:     0x7fd27fddd43f - <rustc_query_impl::Queries as rustc_middle::ty::query::QueryEngine>::hir_owner::h8cf23765d3e4de6b\r\n  19:     0x7fd2803ebcd9 - rustc_middle::hir::map::Map::find_entry::h29d0e05ce7362da9\r\n  20:     0x7fd2803ee781 - rustc_middle::hir::map::Map::opt_span::h0e633ec6695201db\r\n  21:     0x7fd2803e5bb4 - core::ops::function::FnOnce::call_once::h8e8fc2e78b42ea40\r\n  22:     0x7fd27fdf5fef - rustc_query_system::dep_graph::graph::DepGraph<K>::with_task_impl::heb66790eab05aa9c\r\n  23:     0x7fd27fd9edc6 - rustc_query_system::query::plumbing::force_query_with_job::hd99723bfec38226e\r\n  24:     0x7fd27fd681aa - rustc_query_system::query::plumbing::get_query_impl::h29f54ecbf531e372\r\n  25:     0x7fd27fddf2ca - <rustc_query_impl::Queries as rustc_middle::ty::query::QueryEngine>::def_span::hf8951f7e9bd1bf9c\r\n  26:     0x7fd27ee23f40 - <rustc_span::def_id::DefId as rustc_query_impl::keys::Key>::default_span::h1c3c7dc090c3f014\r\n  27:     0x7fd27ee23e68 - <rustc_span::def_id::LocalDefId as rustc_query_impl::keys::Key>::default_span::heda70f45b0543b34\r\n  28:     0x7fd27ef9f123 - rustc_query_impl::make_query::hir_owner::h3da83ab69db93eaa\r\n  29:     0x7fd27f03f777 - <core::iter::adapters::map::Map<I,F> as core::iter::traits::iterator::Iterator>::fold::hd1991837c2161eb2\r\n  30:     0x7fd27f01bd2e - <hashbrown::map::HashMap<K,V,S,A> as core::iter::traits::collect::Extend<(K,V)>>::extend::hd6666d2b93c8a6ad\r\n  31:     0x7fd27ed91619 - rustc_query_system::query::plumbing::QueryState<D,K>::try_collect_active_jobs::h9e1d046a9d6f2a48\r\n  32:     0x7fd27eed6215 - rustc_query_impl::Queries::try_collect_active_jobs::hde35c82843c1c977\r\n  33:     0x7fd27ef9de10 - <rustc_query_impl::plumbing::QueryCtxt as rustc_query_system::query::QueryContext>::try_collect_active_jobs::h074fbdf881b5d394\r\n  34:     0x7fd27edf4efc - rustc_query_system::query::job::print_query_stack::hc8bd6fa9da6896ed\r\n  35:     0x7fd27e8e8018 - rustc_interface::interface::try_print_query_stack::h52edfe36792d8caa\r\n  36:     0x7fd27e816338 - rustc_driver::report_ice::ha40982d59fc75b99\r\n  37:     0x7fd27e0443d0 - std::panicking::rust_panic_with_hook::h70db735e3a6e70cb\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/std/src/panicking.rs:595:17\r\n  38:     0x7fd27e043f77 - std::panicking::begin_panic_handler::{{closure}}::h777c71c8e5a7e25c\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/std/src/panicking.rs:495:13\r\n  39:     0x7fd27e04043c - std::sys_common::backtrace::__rust_end_short_backtrace::h3e9bf30168899554\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/std/src/sys_common/backtrace.rs:141:18\r\n  40:     0x7fd27e043f09 - rust_begin_unwind\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/std/src/panicking.rs:493:5\r\n  41:     0x7fd27e00af31 - core::panicking::panic_fmt::h5322a082d19786c3\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/core/src/panicking.rs:92:14\r\n  42:     0x7fd27e00ae7d - core::panicking::panic::haebb15b6842d6229\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/core/src/panicking.rs:50:5\r\n  43:     0x7fd2803848f3 - rustc_middle::hir::map::collector::NodeCollector::finalize_and_compute_crate_hash::ha4f7aa4c32ef1fb5\r\n  44:     0x7fd280d97e48 - rustc_middle::hir::map::index_hir::h8d13710fbf6ecbc7\r\n  45:     0x7fd280909f75 - rustc_query_system::dep_graph::graph::DepGraph<K>::with_task_impl::hb443d6bb581e91b6\r\n  46:     0x7fd280966f17 - rustc_data_structures::stack::ensure_sufficient_stack::he0c6c8cfc8bd647a\r\n  47:     0x7fd28083d5c1 - rustc_query_system::query::plumbing::force_query_with_job::h961a1a8f48ff034b\r\n  48:     0x7fd2807f09af - rustc_query_system::query::plumbing::get_query_impl::h5cd26487eff2131e\r\n  49:     0x7fd2808e35cf - <rustc_query_impl::Queries as rustc_middle::ty::query::QueryEngine>::index_hir::hf2b2ac559a14a0d9\r\n  50:     0x7fd2803e6487 - core::ops::function::FnOnce::call_once::hff88764e303a68c4\r\n  51:     0x7fd27fdf30b5 - rustc_query_system::dep_graph::graph::DepGraph<K>::with_task_impl::hc0460b29df8a668f\r\n  52:     0x7fd27fd997ee - rustc_query_system::query::plumbing::force_query_with_job::h8d24115ee3a536a8\r\n  53:     0x7fd27fd7d390 - rustc_query_system::query::plumbing::get_query_impl::h9285eb59969e22c8\r\n  54:     0x7fd27fddd43f - <rustc_query_impl::Queries as rustc_middle::ty::query::QueryEngine>::hir_owner::h8cf23765d3e4de6b\r\n  55:     0x7fd2803ebcd9 - rustc_middle::hir::map::Map::find_entry::h29d0e05ce7362da9\r\n  56:     0x7fd2803ec136 - <rustc_middle::hir::map::Map as rustc_hir::intravisit::Map>::item::h5a1c6a1d862795bc\r\n  57:     0x7fd27fe7c2c0 - rustc_middle::hir::map::Map::visit_item_likes_in_module::hf01ac21b956183d6\r\n  58:     0x7fd2809c6294 - rustc_passes::hir_id_validator::check_crate::hb29522cb7117c68c\r\n  59:     0x7fd28048ff76 - rustc_interface::passes::analysis::h84e230aa18168bec\r\n  60:     0x7fd2809076b5 - rustc_query_system::dep_graph::graph::DepGraph<K>::with_task_impl::ha9ecb0a4a5f74d0a\r\n  61:     0x7fd280969b87 - rustc_data_structures::stack::ensure_sufficient_stack::hfc73cb57dd5c4995\r\n  62:     0x7fd280834161 - rustc_query_system::query::plumbing::force_query_with_job::h3b03867f47f56f3f\r\n  63:     0x7fd28080aeff - rustc_query_system::query::plumbing::get_query_impl::hb5cdf9a8bb6380d7\r\n  64:     0x7fd2808e372f - <rustc_query_impl::Queries as rustc_middle::ty::query::QueryEngine>::analysis::he7fb436d5ea44844\r\n  65:     0x7fd28047da6b - rustc_interface::passes::QueryContext::enter::h6632cc7bc285eb19\r\n  66:     0x7fd280449425 - rustc_interface::queries::<impl rustc_interface::interface::Compiler>::enter::h2731ac3c02105c7c\r\n  67:     0x7fd28047e071 - rustc_span::with_source_map::h94d38a1c3089ae35\r\n  68:     0x7fd28044a3ee - rustc_interface::interface::create_compiler_and_run::h2bc2789fb7dc8d5b\r\n  69:     0x7fd280444b78 - scoped_tls::ScopedKey<T>::set::hc4c30e2561747f9c\r\n  70:     0x7fd28044a7c4 - std::sys_common::backtrace::__rust_begin_short_backtrace::h904e8f4f3fa6a302\r\n  71:     0x7fd28046c0f5 - core::ops::function::FnOnce::call_once{{vtable.shim}}::he1a228660be11f81\r\n  72:     0x7fd27e053cf3 - <alloc::boxed::Box<F,A> as core::ops::function::FnOnce<Args>>::call_once::h7f7bdfc757a1add0\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/alloc/src/boxed.rs:1546:9\r\n  73:     0x7fd27e053cf3 - <alloc::boxed::Box<F,A> as core::ops::function::FnOnce<Args>>::call_once::ha294ad0fb99e9b3a\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/alloc/src/boxed.rs:1546:9\r\n  74:     0x7fd27e053cf3 - std::sys::unix::thread::Thread::new::thread_start::h4614854ae73cd6b0\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/std/src/sys/unix/thread.rs:71:17\r\n  75:     0x7fd27df7e609 - start_thread\r\n  76:     0x7fd27de92293 - clone\r\n  77:                0x0 - <unknown>\r\n\r\nerror: internal compiler error: unexpected panic\r\n\r\nnote: the compiler unexpectedly panicked. this is a bug.\r\n\r\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/issues/new?labels=C-bug%2C+I-ICE%2C+T-compiler&template=ice.md\r\n\r\nnote: rustc 1.53.0-nightly (07e0e2ec2 2021-03-24) running on x86_64-unknown-linux-gnu\r\n\r\nquery stack during panic:\r\nend of query stack\r\nthread panicked while panicking. aborting.\r\nIllegal instruction (core dumped)\r\n```\r\n\r\n<!--\r\nInclude a backtrace in the code block by setting `RUST_BACKTRACE=1` in your\r\nenvironment. E.g. `RUST_BACKTRACE=1 cargo build`.\r\n-->\r\n<details><summary><strong>Backtrace</strong></summary>\r\n<p>\r\n\r\n```\r\nerror: bounds on `type`s in this context have no effect\r\n --> perses_node_priority_with_dfs_delta_reduced_mutant.rs:1:24\r\n  |\r\n1 |   type PairCoupledTypes: Trait<\r\n  |  ________________________^\r\n2 | |     [u32; {\r\n3 | |         static FOO: usize;\r\n4 | |     }],\r\n5 | | > = impl Trait<\r\n  | |_^\r\n\r\nerror: free static item without body\r\n --> perses_node_priority_with_dfs_delta_reduced_mutant.rs:3:9\r\n  |\r\n3 |         static FOO: usize;\r\n  |         ^^^^^^^^^^^^^^^^^-\r\n  |                          |\r\n  |                          help: provide a definition for the static: `= <expr>;`\r\n\r\nerror: free static item without body\r\n --> perses_node_priority_with_dfs_delta_reduced_mutant.rs:7:9\r\n  |\r\n7 |         static FOO: usize;\r\n  |         ^^^^^^^^^^^^^^^^^-\r\n  |                          |\r\n  |                          help: provide a definition for the static: `= <expr>;`\r\n\r\nerror[E0405]: cannot find trait `Trait` in this scope\r\n --> perses_node_priority_with_dfs_delta_reduced_mutant.rs:1:24\r\n  |\r\n1 | type PairCoupledTypes: Trait<\r\n  |                        ^^^^^ not found in this scope\r\n\r\nerror[E0405]: cannot find trait `Trait` in this scope\r\n --> perses_node_priority_with_dfs_delta_reduced_mutant.rs:5:10\r\n  |\r\n5 | > = impl Trait<\r\n  |          ^^^^^ not found in this scope\r\n\r\nerror[E0658]: `impl Trait` in type aliases is unstable\r\n --> perses_node_priority_with_dfs_delta_reduced_mutant.rs:5:5\r\n  |\r\n5 |   > = impl Trait<\r\n  |  _____^\r\n6 | |     [u32; {\r\n7 | |         static FOO: usize;\r\n8 | |     }],\r\n9 | | >;\r\n  | |_^\r\n  |\r\n  = note: see issue #63063 <https://github.com/rust-lang/rust/issues/63063> for more information\r\n  = help: add `#![feature(min_type_alias_impl_trait)]` to the crate attributes to enable\r\n\r\nthread 'rustc' panicked at 'called `Option::unwrap()` on a `None` value', compiler/rustc_middle/src/hir/map/collector.rs:156:78\r\nstack backtrace:\r\n   0: rust_begin_unwind\r\n             at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/std/src/panicking.rs:493:5\r\n   1: core::panicking::panic_fmt\r\n             at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/core/src/panicking.rs:92:14\r\n   2: core::panicking::panic\r\n             at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/core/src/panicking.rs:50:5\r\n   3: rustc_middle::hir::map::collector::NodeCollector::finalize_and_compute_crate_hash\r\n   4: rustc_middle::hir::map::index_hir\r\n   5: rustc_query_system::dep_graph::graph::DepGraph<K>::with_task_impl\r\n   6: rustc_data_structures::stack::ensure_sufficient_stack\r\n   7: rustc_query_system::query::plumbing::force_query_with_job\r\n   8: rustc_query_system::query::plumbing::get_query_impl\r\n   9: <rustc_query_impl::Queries as rustc_middle::ty::query::QueryEngine>::index_hir\r\n  10: core::ops::function::FnOnce::call_once\r\n  11: rustc_query_system::dep_graph::graph::DepGraph<K>::with_task_impl\r\n  12: rustc_query_system::query::plumbing::force_query_with_job\r\n  13: rustc_query_system::query::plumbing::get_query_impl\r\n  14: <rustc_query_impl::Queries as rustc_middle::ty::query::QueryEngine>::hir_owner\r\n  15: rustc_middle::hir::map::Map::find_entry\r\n  16: <rustc_middle::hir::map::Map as rustc_hir::intravisit::Map>::item\r\n  17: rustc_middle::hir::map::Map::visit_item_likes_in_module\r\n  18: rustc_passes::hir_id_validator::check_crate\r\n  19: rustc_interface::passes::analysis\r\n  20: rustc_query_system::dep_graph::graph::DepGraph<K>::with_task_impl\r\n  21: rustc_data_structures::stack::ensure_sufficient_stack\r\n  22: rustc_query_system::query::plumbing::force_query_with_job\r\n  23: rustc_query_system::query::plumbing::get_query_impl\r\n  24: <rustc_query_impl::Queries as rustc_middle::ty::query::QueryEngine>::analysis\r\n  25: rustc_interface::passes::QueryContext::enter\r\n  26: rustc_interface::queries::<impl rustc_interface::interface::Compiler>::enter\r\n  27: rustc_span::with_source_map\r\n  28: rustc_interface::interface::create_compiler_and_run\r\n  29: scoped_tls::ScopedKey<T>::set\r\nnote: Some details are omitted, run with `RUST_BACKTRACE=full` for a verbose backtrace.\r\n\r\nerror: internal compiler error: unexpected panic\r\n\r\nnote: the compiler unexpectedly panicked. this is a bug.\r\n\r\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/issues/new?labels=C-bug%2C+I-ICE%2C+T-compiler&template=ice.md\r\n\r\nnote: rustc 1.53.0-nightly (07e0e2ec2 2021-03-24) running on x86_64-unknown-linux-gnu\r\n\r\nquery stack during panic:\r\nthread 'rustc' panicked at 'already borrowed: BorrowMutError', /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/compiler/rustc_data_structures/src/sync.rs:481:16\r\nstack backtrace:\r\n   0:     0x7f249c32ff80 - std::backtrace_rs::backtrace::libunwind::trace::h4dee703919bfd40a\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/std/src/../../backtrace/src/backtrace/libunwind.rs:90:5\r\n   1:     0x7f249c32ff80 - std::backtrace_rs::backtrace::trace_unsynchronized::h457e839f1a563e20\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/std/src/../../backtrace/src/backtrace/mod.rs:66:5\r\n   2:     0x7f249c32ff80 - std::sys_common::backtrace::_print_fmt::h86a55fb30f8393c8\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/std/src/sys_common/backtrace.rs:67:5\r\n   3:     0x7f249c32ff80 - <std::sys_common::backtrace::_print::DisplayBacktrace as core::fmt::Display>::fmt::h7b3d6cac46d277e1\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/std/src/sys_common/backtrace.rs:46:22\r\n   4:     0x7f249c39e8df - core::fmt::write::h127419eb46f2ecc9\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/core/src/fmt/mod.rs:1092:17\r\n   5:     0x7f249c324505 - std::io::Write::write_fmt::h6010cfbb4726588b\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/std/src/io/mod.rs:1578:15\r\n   6:     0x7f249c333cbb - std::sys_common::backtrace::_print::h79b4f9652330cc9d\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/std/src/sys_common/backtrace.rs:49:5\r\n   7:     0x7f249c333cbb - std::sys_common::backtrace::print::h330bb326a76af8cf\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/std/src/sys_common/backtrace.rs:36:9\r\n   8:     0x7f249c333cbb - std::panicking::default_hook::{{closure}}::heb6a42a7d50a472e\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/std/src/panicking.rs:208:50\r\n   9:     0x7f249c333783 - std::panicking::default_hook::h17e521ba6d68d6e1\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/std/src/panicking.rs:225:9\r\n  10:     0x7f249cb05f2b - rustc_driver::report_ice::ha40982d59fc75b99\r\n  11:     0x7f249c3343d0 - std::panicking::rust_panic_with_hook::h70db735e3a6e70cb\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/std/src/panicking.rs:595:17\r\n  12:     0x7f249c333fa7 - std::panicking::begin_panic_handler::{{closure}}::h777c71c8e5a7e25c\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/std/src/panicking.rs:497:13\r\n  13:     0x7f249c33043c - std::sys_common::backtrace::__rust_end_short_backtrace::h3e9bf30168899554\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/std/src/sys_common/backtrace.rs:141:18\r\n  14:     0x7f249c333f09 - rust_begin_unwind\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/std/src/panicking.rs:493:5\r\n  15:     0x7f249c2faf31 - core::panicking::panic_fmt::h5322a082d19786c3\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/core/src/panicking.rs:92:14\r\n  16:     0x7f249c2fae23 - core::option::expect_none_failed::h354eaa93a51d71b8\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/core/src/option.rs:1329:5\r\n  17:     0x7f249e06d6b1 - rustc_query_system::query::plumbing::get_query_impl::h9285eb59969e22c8\r\n  18:     0x7f249e0cd43f - <rustc_query_impl::Queries as rustc_middle::ty::query::QueryEngine>::hir_owner::h8cf23765d3e4de6b\r\n  19:     0x7f249e6dbcd9 - rustc_middle::hir::map::Map::find_entry::h29d0e05ce7362da9\r\n  20:     0x7f249e6de781 - rustc_middle::hir::map::Map::opt_span::h0e633ec6695201db\r\n  21:     0x7f249e6d5bb4 - core::ops::function::FnOnce::call_once::h8e8fc2e78b42ea40\r\n  22:     0x7f249e0e5fef - rustc_query_system::dep_graph::graph::DepGraph<K>::with_task_impl::heb66790eab05aa9c\r\n  23:     0x7f249e08edc6 - rustc_query_system::query::plumbing::force_query_with_job::hd99723bfec38226e\r\n  24:     0x7f249e0581aa - rustc_query_system::query::plumbing::get_query_impl::h29f54ecbf531e372\r\n  25:     0x7f249e0cf2ca - <rustc_query_impl::Queries as rustc_middle::ty::query::QueryEngine>::def_span::hf8951f7e9bd1bf9c\r\n  26:     0x7f249d113f40 - <rustc_span::def_id::DefId as rustc_query_impl::keys::Key>::default_span::h1c3c7dc090c3f014\r\n  27:     0x7f249d113e68 - <rustc_span::def_id::LocalDefId as rustc_query_impl::keys::Key>::default_span::heda70f45b0543b34\r\n  28:     0x7f249d28f123 - rustc_query_impl::make_query::hir_owner::h3da83ab69db93eaa\r\n  29:     0x7f249d32f777 - <core::iter::adapters::map::Map<I,F> as core::iter::traits::iterator::Iterator>::fold::hd1991837c2161eb2\r\n  30:     0x7f249d30bd2e - <hashbrown::map::HashMap<K,V,S,A> as core::iter::traits::collect::Extend<(K,V)>>::extend::hd6666d2b93c8a6ad\r\n  31:     0x7f249d081619 - rustc_query_system::query::plumbing::QueryState<D,K>::try_collect_active_jobs::h9e1d046a9d6f2a48\r\n  32:     0x7f249d1c6215 - rustc_query_impl::Queries::try_collect_active_jobs::hde35c82843c1c977\r\n  33:     0x7f249d28de10 - <rustc_query_impl::plumbing::QueryCtxt as rustc_query_system::query::QueryContext>::try_collect_active_jobs::h074fbdf881b5d394\r\n  34:     0x7f249d0e4efc - rustc_query_system::query::job::print_query_stack::hc8bd6fa9da6896ed\r\n  35:     0x7f249cbd8018 - rustc_interface::interface::try_print_query_stack::h52edfe36792d8caa\r\n  36:     0x7f249cb06338 - rustc_driver::report_ice::ha40982d59fc75b99\r\n  37:     0x7f249c3343d0 - std::panicking::rust_panic_with_hook::h70db735e3a6e70cb\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/std/src/panicking.rs:595:17\r\n  38:     0x7f249c333f77 - std::panicking::begin_panic_handler::{{closure}}::h777c71c8e5a7e25c\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/std/src/panicking.rs:495:13\r\n  39:     0x7f249c33043c - std::sys_common::backtrace::__rust_end_short_backtrace::h3e9bf30168899554\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/std/src/sys_common/backtrace.rs:141:18\r\n  40:     0x7f249c333f09 - rust_begin_unwind\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/std/src/panicking.rs:493:5\r\n  41:     0x7f249c2faf31 - core::panicking::panic_fmt::h5322a082d19786c3\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/core/src/panicking.rs:92:14\r\n  42:     0x7f249c2fae7d - core::panicking::panic::haebb15b6842d6229\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/core/src/panicking.rs:50:5\r\n  43:     0x7f249e6748f3 - rustc_middle::hir::map::collector::NodeCollector::finalize_and_compute_crate_hash::ha4f7aa4c32ef1fb5\r\n  44:     0x7f249f087e48 - rustc_middle::hir::map::index_hir::h8d13710fbf6ecbc7\r\n  45:     0x7f249ebf9f75 - rustc_query_system::dep_graph::graph::DepGraph<K>::with_task_impl::hb443d6bb581e91b6\r\n  46:     0x7f249ec56f17 - rustc_data_structures::stack::ensure_sufficient_stack::he0c6c8cfc8bd647a\r\n  47:     0x7f249eb2d5c1 - rustc_query_system::query::plumbing::force_query_with_job::h961a1a8f48ff034b\r\n  48:     0x7f249eae09af - rustc_query_system::query::plumbing::get_query_impl::h5cd26487eff2131e\r\n  49:     0x7f249ebd35cf - <rustc_query_impl::Queries as rustc_middle::ty::query::QueryEngine>::index_hir::hf2b2ac559a14a0d9\r\n  50:     0x7f249e6d6487 - core::ops::function::FnOnce::call_once::hff88764e303a68c4\r\n  51:     0x7f249e0e30b5 - rustc_query_system::dep_graph::graph::DepGraph<K>::with_task_impl::hc0460b29df8a668f\r\n  52:     0x7f249e0897ee - rustc_query_system::query::plumbing::force_query_with_job::h8d24115ee3a536a8\r\n  53:     0x7f249e06d390 - rustc_query_system::query::plumbing::get_query_impl::h9285eb59969e22c8\r\n  54:     0x7f249e0cd43f - <rustc_query_impl::Queries as rustc_middle::ty::query::QueryEngine>::hir_owner::h8cf23765d3e4de6b\r\n  55:     0x7f249e6dbcd9 - rustc_middle::hir::map::Map::find_entry::h29d0e05ce7362da9\r\n  56:     0x7f249e6dc136 - <rustc_middle::hir::map::Map as rustc_hir::intravisit::Map>::item::h5a1c6a1d862795bc\r\n  57:     0x7f249e16c2c0 - rustc_middle::hir::map::Map::visit_item_likes_in_module::hf01ac21b956183d6\r\n  58:     0x7f249ecb6294 - rustc_passes::hir_id_validator::check_crate::hb29522cb7117c68c\r\n  59:     0x7f249e77ff76 - rustc_interface::passes::analysis::h84e230aa18168bec\r\n  60:     0x7f249ebf76b5 - rustc_query_system::dep_graph::graph::DepGraph<K>::with_task_impl::ha9ecb0a4a5f74d0a\r\n  61:     0x7f249ec59b87 - rustc_data_structures::stack::ensure_sufficient_stack::hfc73cb57dd5c4995\r\n  62:     0x7f249eb24161 - rustc_query_system::query::plumbing::force_query_with_job::h3b03867f47f56f3f\r\n  63:     0x7f249eafaeff - rustc_query_system::query::plumbing::get_query_impl::hb5cdf9a8bb6380d7\r\n  64:     0x7f249ebd372f - <rustc_query_impl::Queries as rustc_middle::ty::query::QueryEngine>::analysis::he7fb436d5ea44844\r\n  65:     0x7f249e76da6b - rustc_interface::passes::QueryContext::enter::h6632cc7bc285eb19\r\n  66:     0x7f249e739425 - rustc_interface::queries::<impl rustc_interface::interface::Compiler>::enter::h2731ac3c02105c7c\r\n  67:     0x7f249e76e071 - rustc_span::with_source_map::h94d38a1c3089ae35\r\n  68:     0x7f249e73a3ee - rustc_interface::interface::create_compiler_and_run::h2bc2789fb7dc8d5b\r\n  69:     0x7f249e734b78 - scoped_tls::ScopedKey<T>::set::hc4c30e2561747f9c\r\n  70:     0x7f249e73a7c4 - std::sys_common::backtrace::__rust_begin_short_backtrace::h904e8f4f3fa6a302\r\n  71:     0x7f249e75c0f5 - core::ops::function::FnOnce::call_once{{vtable.shim}}::he1a228660be11f81\r\n  72:     0x7f249c343cf3 - <alloc::boxed::Box<F,A> as core::ops::function::FnOnce<Args>>::call_once::h7f7bdfc757a1add0\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/alloc/src/boxed.rs:1546:9\r\n  73:     0x7f249c343cf3 - <alloc::boxed::Box<F,A> as core::ops::function::FnOnce<Args>>::call_once::ha294ad0fb99e9b3a\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/alloc/src/boxed.rs:1546:9\r\n  74:     0x7f249c343cf3 - std::sys::unix::thread::Thread::new::thread_start::h4614854ae73cd6b0\r\n                               at /rustc/07e0e2ec268c140e607e1ac7f49f145612d0f597/library/std/src/sys/unix/thread.rs:71:17\r\n  75:     0x7f249c26e609 - start_thread\r\n  76:     0x7f249c182293 - clone\r\n  77:                0x0 - <unknown>\r\n\r\nerror: internal compiler error: unexpected panic\r\n\r\nnote: the compiler unexpectedly panicked. this is a bug.\r\n\r\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/issues/new?labels=C-bug%2C+I-ICE%2C+T-compiler&template=ice.md\r\n\r\nnote: rustc 1.53.0-nightly (07e0e2ec2 2021-03-24) running on x86_64-unknown-linux-gnu\r\n\r\nquery stack during panic:\r\nend of query stack\r\nthread panicked while panicking. aborting.\r\nIllegal instruction (core dumped)\r\n```\r\n\r\n</p>\r\n</details>\r\n\r\n", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/83479/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/83479/timeline", "performed_via_github_app": null, "state_reason": null}