{"url": "https://api.github.com/repos/rust-lang/rust/issues/107952", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/107952/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/107952/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/107952/events", "html_url": "https://github.com/rust-lang/rust/issues/107952", "id": 1581254744, "node_id": "I_kwDOAAsO6M5eQAhY", "number": 107952, "title": "Unexpected \"trait bound not satisfied\" when bounding associated type", "user": {"login": "whoiscc", "id": 35130945, "node_id": "MDQ6VXNlcjM1MTMwOTQ1", "avatar_url": "https://avatars.githubusercontent.com/u/35130945?v=4", "gravatar_id": "", "url": "https://api.github.com/users/whoiscc", "html_url": "https://github.com/whoiscc", "followers_url": "https://api.github.com/users/whoiscc/followers", "following_url": "https://api.github.com/users/whoiscc/following{/other_user}", "gists_url": "https://api.github.com/users/whoiscc/gists{/gist_id}", "starred_url": "https://api.github.com/users/whoiscc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/whoiscc/subscriptions", "organizations_url": "https://api.github.com/users/whoiscc/orgs", "repos_url": "https://api.github.com/users/whoiscc/repos", "events_url": "https://api.github.com/users/whoiscc/events{/privacy}", "received_events_url": "https://api.github.com/users/whoiscc/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2023-02-12T13:13:26Z", "updated_at": "2023-02-17T01:25:44Z", "closed_at": "2023-02-17T01:25:44Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!--\r\nThank you for filing a bug report! \ud83d\udc1b Please provide a short summary of the bug,\r\nalong with any information you feel relevant to replicating the bug.\r\n-->\r\n\r\nI tried this code (not sure how to further minimize it):\r\n\r\n```rust\r\ntrait Protocol<E> {\r\n    type Effect;\r\n}\r\n\r\ntrait Composite {}\r\n\r\ntrait ReactiveGenerate {\r\n    type Event;\r\n    \r\n    fn update<P>()\r\n    where\r\n        P: Protocol<Self::Event>,\r\n        P::Effect: Composite;\r\n}\r\n\r\nimpl ReactiveGenerate for () {\r\n    type Event = ();\r\n\r\n    fn update<P>()\r\n    where\r\n        P: Protocol<Self::Event>,\r\n        P::Effect: Composite\r\n    {\r\n        todo!()\r\n    }\r\n}\r\n\r\n```\r\n\r\nI expect it to compile, but get error:\r\n\r\n```\r\nerror[[E0277]](https://doc.rust-lang.org/stable/error_codes/E0277.html): the trait bound `P: Protocol<()>` is not satisfied\r\n  --> src/main.rs:21:5\r\n   |\r\n21 | /     fn update<P>()\r\n22 | |     where\r\n23 | |         P: Protocol<Self::Event>,\r\n24 | |         P::Effect: Composite\r\n   | |____________________________^ the trait `Protocol<()>` is not implemented for `P`\r\n   |\r\nhelp: consider further restricting this bound\r\n   |\r\n23 |         P: Protocol<Self::Event> + Protocol<()>,\r\n   |                                  ++++++++++++++\r\n\r\nerror[[E0277]](https://doc.rust-lang.org/stable/error_codes/E0277.html): the trait bound `P: Protocol<()>` is not satisfied\r\n  --> src/main.rs:21:8\r\n   |\r\n21 |     fn update<P>()\r\n   |        ^^^^^^ the trait `Protocol<()>` is not implemented for `P`\r\n   |\r\nhelp: consider further restricting this bound\r\n   |\r\n23 |         P: Protocol<Self::Event> + Protocol<()>,\r\n   |                                  ++++++++++++++\r\n```\r\n\r\nThe code would compile is I remove `P::Effect: Composite` on both sites, and I don't see how this bound prevent type check.\r\n\r\nI'm not sure whether this code should be compiled or not. If not please kindly point out the problem. But anyway, the error message makes no sense. If I blindly follow the hint, it becomes even more nonsense:\r\n\r\n```\r\nerror[[E0277]](https://doc.rust-lang.org/stable/error_codes/E0277.html): the trait bound `P: Protocol<()>` is not satisfied\r\n  --> src/main.rs:19:5\r\n   |\r\n19 | /     fn update<P>()\r\n20 | |     where\r\n21 | |         P: Protocol<Self::Event> + Protocol<()>,\r\n22 | |         <P as Protocol<()>>::Effect: Composite\r\n   | |______________________________________________^ the trait `Protocol<()>` is not implemented for `P`\r\n   |\r\nhelp: consider further restricting this bound\r\n   |\r\n21 |         P: Protocol<Self::Event> + Protocol<()> + Protocol<()>,\r\n   |                                                 ++++++++++++++\r\n\r\nerror[[E0276]](https://doc.rust-lang.org/stable/error_codes/E0276.html): impl has stricter requirements than trait\r\n  --> src/main.rs:21:12\r\n   |\r\n10 | /     fn update<P>()\r\n11 | |     where\r\n12 | |         P: Protocol<Self::Event>,\r\n13 | |         P::Effect: Composite;\r\n   | |_____________________________- definition of `update` from trait\r\n...\r\n21 |           P: Protocol<Self::Event> + Protocol<()>,\r\n   |              ^^^^^^^^^^^^^^^^^^^^^ impl has extra requirement `P: Protocol<()>`\r\n```\r\n\r\n### Meta\r\n<!--\r\nIf you're using the stable version of the compiler, you should also check if the\r\nbug also exists in the beta or nightly versions.\r\n-->\r\n\r\n`rustc --version --verbose`:\r\n```\r\nrustc 1.67.1 (d5a82bbd2 2023-02-07)\r\nbinary: rustc\r\ncommit-hash: d5a82bbd26e1ad8b7401f6a718a9c57c96905483\r\ncommit-date: 2023-02-07\r\nhost: x86_64-unknown-linux-gnu\r\nrelease: 1.67.1\r\nLLVM version: 15.0.6\r\n```\r\n\r\n<!--\r\nInclude a backtrace in the code block by setting `RUST_BACKTRACE=1` in your\r\nenvironment. E.g. `RUST_BACKTRACE=1 cargo build`.\r\n-->\r\n<details><summary>Backtrace</summary>\r\n<p>\r\n\r\n```\r\n<backtrace>\r\n```\r\n\r\n</p>\r\n</details>\r\n", "closed_by": {"login": "whoiscc", "id": 35130945, "node_id": "MDQ6VXNlcjM1MTMwOTQ1", "avatar_url": "https://avatars.githubusercontent.com/u/35130945?v=4", "gravatar_id": "", "url": "https://api.github.com/users/whoiscc", "html_url": "https://github.com/whoiscc", "followers_url": "https://api.github.com/users/whoiscc/followers", "following_url": "https://api.github.com/users/whoiscc/following{/other_user}", "gists_url": "https://api.github.com/users/whoiscc/gists{/gist_id}", "starred_url": "https://api.github.com/users/whoiscc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/whoiscc/subscriptions", "organizations_url": "https://api.github.com/users/whoiscc/orgs", "repos_url": "https://api.github.com/users/whoiscc/repos", "events_url": "https://api.github.com/users/whoiscc/events{/privacy}", "received_events_url": "https://api.github.com/users/whoiscc/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/107952/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/107952/timeline", "performed_via_github_app": null, "state_reason": "completed"}