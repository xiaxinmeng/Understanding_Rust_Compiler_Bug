{"url": "https://api.github.com/repos/rust-lang/rust/issues/86289", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/86289/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/86289/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/86289/events", "html_url": "https://github.com/rust-lang/rust/issues/86289", "id": 920280462, "node_id": "MDU6SXNzdWU5MjAyODA0NjI=", "number": 86289, "title": "Debuginfo type names: Correctly handle generic arguments in paths", "user": {"login": "michaelwoerister", "id": 1825894, "node_id": "MDQ6VXNlcjE4MjU4OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1825894?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michaelwoerister", "html_url": "https://github.com/michaelwoerister", "followers_url": "https://api.github.com/users/michaelwoerister/followers", "following_url": "https://api.github.com/users/michaelwoerister/following{/other_user}", "gists_url": "https://api.github.com/users/michaelwoerister/gists{/gist_id}", "starred_url": "https://api.github.com/users/michaelwoerister/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michaelwoerister/subscriptions", "organizations_url": "https://api.github.com/users/michaelwoerister/orgs", "repos_url": "https://api.github.com/users/michaelwoerister/repos", "events_url": "https://api.github.com/users/michaelwoerister/events{/privacy}", "received_events_url": "https://api.github.com/users/michaelwoerister/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 203130, "node_id": "MDU6TGFiZWwyMDMxMzA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-debuginfo", "name": "A-debuginfo", "color": "f7e101", "default": false, "description": "Area: Debugging information in compiled programs (DWARF, PDB, etc.)"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-06-14T10:39:50Z", "updated_at": "2021-06-23T14:10:42Z", "closed_at": null, "author_association": "MEMBER", "active_lock_reason": null, "body": "Currently paths in stringified type names emitted to debuginfo are generated by [simply concatenating the components of corresponding DefPaths](https://github.com/rust-lang/rust/blob/a50d72158e08e02cfc051b863017bdbd2c45b637/compiler/rustc_codegen_ssa/src/debuginfo/type_names.rs#L289-L298). If the type also includes generic arguments these will then [just be appended at the end](https://github.com/rust-lang/rust/blob/a50d72158e08e02cfc051b863017bdbd2c45b637/compiler/rustc_codegen_ssa/src/debuginfo/type_names.rs#L53). This works OK as long as all arguments actually belong to the item in question but in cases where some of the arguments actually belong to enclosing items (i.e. further up the path) then this leads undesirable outcomes. \r\n\r\nE.g. if we have the following impl\r\n\r\n```rust\r\nimpl<T> Foo<T> {\r\n    fn foo<U>() { \r\n        let some_closure = || { \r\n           // ...\r\n        };\r\n    }\r\n}\r\n``` \r\nthen we want a concrete instance with `T=u32` and `U=bool` of the closure type to be printed as\r\n```rust\r\n<Foo<u32>>::foo::<bool>::{closure#0}\r\n```\r\nbut instead we get something like\r\n```rust\r\n<Foo<T>>::foo::{closure#0}<u32, bool> // with #86167 solved\r\n// or \r\nsome::path::{impl#0}::foo::{closure#0}<u32, bool> // without #86167 solved\r\n```\r\n\r\nConcretely we want generic parameters in paths to be\r\n- replaced with concrete values (if there are concrete values), or \r\n- erased where the parameter does not matter (e.g. in `<Foo<_>>::foo::<_>::SOME_STATIC`).\r\n\r\n\r\n", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/86289/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/86289/timeline", "performed_via_github_app": null, "state_reason": null}