{"url": "https://api.github.com/repos/rust-lang/rust/issues/71848", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/71848/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/71848/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/71848/events", "html_url": "https://github.com/rust-lang/rust/issues/71848", "id": 611439351, "node_id": "MDU6SXNzdWU2MTE0MzkzNTE=", "number": 71848, "title": "error: options `-C bitcode-in-rlib=no` and `-C lto` are incompatible", "user": {"login": "chinedufn", "id": 2099811, "node_id": "MDQ6VXNlcjIwOTk4MTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2099811?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chinedufn", "html_url": "https://github.com/chinedufn", "followers_url": "https://api.github.com/users/chinedufn/followers", "following_url": "https://api.github.com/users/chinedufn/following{/other_user}", "gists_url": "https://api.github.com/users/chinedufn/gists{/gist_id}", "starred_url": "https://api.github.com/users/chinedufn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chinedufn/subscriptions", "organizations_url": "https://api.github.com/users/chinedufn/orgs", "repos_url": "https://api.github.com/users/chinedufn/repos", "events_url": "https://api.github.com/users/chinedufn/events{/privacy}", "received_events_url": "https://api.github.com/users/chinedufn/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 223796632, "node_id": "MDU6TGFiZWwyMjM3OTY2MzI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/relnotes", "name": "relnotes", "color": "fad8c7", "default": false, "description": "Marks issues that should be documented in the release notes of the next release."}, {"id": 609101895, "node_id": "MDU6TGFiZWw2MDkxMDE4OTU=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-cargo", "name": "T-cargo", "color": "bfd4f2", "default": false, "description": "Relevant to the cargo team, which will review and decide on the PR/issue."}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2020-05-03T15:31:34Z", "updated_at": "2020-05-13T19:32:31Z", "closed_at": "2020-05-13T15:43:39Z", "author_association": "NONE", "active_lock_reason": null, "body": "I recently updated to the latest nightly a couple of days ago and started getting an error when trying to build a crate.\r\n\r\n```\r\nerror: options `-C bitcode-in-rlib=no` and `-C lto` are incompatible\r\n```\r\n\r\nThe build command that I'm using is:\r\n\r\n```\r\nRUSTFLAGS=\"-C lto\" cargo build -p my-crate-name --target x86_64-unknown-linux-gnu --release\r\n```\r\n\r\nVersion info (I've tried this on MacOS as well, also fails)\r\n\r\n```\r\n$ rustc -V\r\nrustc 1.45.0-nightly (7f65393b9 2020-05-01)\r\n$ cargo -V\r\ncargo 1.45.0-nightly (258c89644 2020-04-30)\r\n$ lsb_release -a\r\nNo LSB modules are available.\r\nDistributor ID:\tDebian\r\nDescription:\tDebian GNU/Linux 9.8 (stretch)\r\nRelease:\t9.8\r\nCodename:\tstretch\r\n```\r\n\r\nI see that there was some recent work around optimizing bitcode in rlibs (example: #66961 ), so that could be related but I'm not sure.\r\n\r\n---\r\n\r\nAs far as I can tell I'm not setting `-C bitcode-in-rlib=no` anywhere - unless there's some way that it can be set by default in some scenarios?\r\n\r\n## Minimal Reproduction Steps\r\n\r\n```\r\ncargo new rlib-test\r\ncd rlib-test\r\nRUSTFLAGS=\"-C lto\" cargo build --release\r\n# error: options `-C bitcode-in-rlib=no` and `-C lto` are incompatible\r\n```\r\n\r\nWorks fine on `nightly-2020-03-01`. \r\n(I didn't check any other nightly releases in between March and May)", "closed_by": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/71848/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/71848/timeline", "performed_via_github_app": null, "state_reason": "completed"}