{"url": "https://api.github.com/repos/rust-lang/rust/issues/50732", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/50732/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/50732/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/50732/events", "html_url": "https://github.com/rust-lang/rust/issues/50732", "id": 322670045, "node_id": "MDU6SXNzdWUzMjI2NzAwNDU=", "number": 50732, "title": "illegal instruction on armv7 (udiv)", "user": {"login": "dnr", "id": 466723, "node_id": "MDQ6VXNlcjQ2NjcyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/466723?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dnr", "html_url": "https://github.com/dnr", "followers_url": "https://api.github.com/users/dnr/followers", "following_url": "https://api.github.com/users/dnr/following{/other_user}", "gists_url": "https://api.github.com/users/dnr/gists{/gist_id}", "starred_url": "https://api.github.com/users/dnr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dnr/subscriptions", "organizations_url": "https://api.github.com/users/dnr/orgs", "repos_url": "https://api.github.com/users/dnr/repos", "events_url": "https://api.github.com/users/dnr/events{/privacy}", "received_events_url": "https://api.github.com/users/dnr/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 55301954, "node_id": "MDU6TGFiZWw1NTMwMTk1NA==", "url": "https://api.github.com/repos/rust-lang/rust/labels/O-Arm", "name": "O-Arm", "color": "6e6ec0", "default": false, "description": "Target: 32-bit Arm processors (armv6, armv7, thumb...), including 64-bit Arm in AArch32 state"}, {"id": 203429200, "node_id": "MDU6TGFiZWwyMDM0MjkyMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/P-high", "name": "P-high", "color": "eb6420", "default": false, "description": "High priority"}, {"id": 262252840, "node_id": "MDU6TGFiZWwyNjIyNTI4NDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/regression-from-stable-to-stable", "name": "regression-from-stable-to-stable", "color": "e4008a", "default": false, "description": "Performance or correctness regression from one stable version to another."}, {"id": 593503757, "node_id": "MDU6TGFiZWw1OTM1MDM3NTc=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-infra", "name": "T-infra", "color": "bfd4f2", "default": false, "description": "Relevant to the infrastructure team, which will review and decide on the PR/issue."}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 14, "created_at": "2018-05-14T04:37:09Z", "updated_at": "2019-03-19T10:59:23Z", "closed_at": "2019-03-19T10:59:22Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm trying to use rust to build something on an ARM board (cubox-i2):\r\n```\r\n$ cat /proc/cpuinfo \r\nprocessor       : 0\r\nmodel name      : ARMv7 Processor rev 10 (v7l)\r\nBogoMIPS        : 3.00\r\nFeatures        : swp half thumb fastmult vfp edsp neon vfpv3 tls vfpd32 \r\nCPU implementer : 0x41\r\nCPU architecture: 7\r\nCPU variant     : 0x2\r\nCPU part        : 0xc09\r\nCPU revision    : 10\r\n\r\nprocessor       : 1\r\nmodel name      : ARMv7 Processor rev 10 (v7l)\r\nBogoMIPS        : 3.00\r\nFeatures        : swp half thumb fastmult vfp edsp neon vfpv3 tls vfpd32 \r\nCPU implementer : 0x41\r\nCPU architecture: 7\r\nCPU variant     : 0x2\r\nCPU part        : 0xc09\r\nCPU revision    : 10\r\n\r\nHardware        : Freescale i.MX6 Quad/DualLite (Device Tree)\r\nRevision        : 0000\r\nSerial          : 0000000000000000\r\n```\r\n\r\nI installed rust 1.25.0 (from the archlinuxarm repo) and get this:\r\n```\r\n$ usr/bin/rustc -V\r\nrustc 1.25.0\r\n$ usr/bin/rustc -v\r\nIllegal instruction (core dumped)\r\n```\r\n\r\nMore detail with gdb:\r\n```\r\n$ gdb --args usr/bin/rustc -v\r\nGNU gdb (GDB) 8.1\r\nCopyright (C) 2018 Free Software Foundation, Inc.\r\nLicense GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>\r\nThis is free software: you are free to change and redistribute it.\r\nThere is NO WARRANTY, to the extent permitted by law.  Type \"show copying\"\r\nand \"show warranty\" for details.\r\nThis GDB was configured as \"armv7l-unknown-linux-gnueabihf\".\r\nType \"show configuration\" for configuration details.  \r\nFor bug reporting instructions, please see:\r\n<http://www.gnu.org/software/gdb/bugs/>.\r\nFind the GDB manual and other documentation resources online at:\r\n<http://www.gnu.org/software/gdb/documentation/>.\r\nFor help, type \"help\".\r\nType \"apropos word\" to search for commands related to \"word\"...\r\nReading symbols from usr/bin/rustc...(no debugging symbols found)...done.\r\n(gdb) r\r\nStarting program: /tmp/r125/usr/bin/rustc -v\r\n[Thread debugging using libthread_db enabled]\r\nUsing host libthread_db library \"/usr/lib/libthread_db.so.1\".\r\n[New Thread 0x74fff1a0 (LWP 26265)]\r\n\r\nThread 2 \"rustc\" received signal SIGILL, Illegal instruction.\r\n[Switching to Thread 0x74fff1a0 (LWP 26265)]\r\n0x72bf8fa8 in cashew::IString::set(char const*, bool) ()\r\n   from /tmp/r125/usr/lib/rustlib/armv7-unknown-linux-gnueabihf/codegen-backends/librustc_trans-llvm.so\r\n(gdb) bt\r\n#0  0x72bf8fa8 in cashew::IString::set(char const*, bool) ()\r\n   from /tmp/r125/usr/lib/rustlib/armv7-unknown-linux-gnueabihf/codegen-backends/librustc_trans-llvm.so\r\n#1  0x70d9feec in ?? ()\r\n   from /tmp/r125/usr/lib/rustlib/armv7-unknown-linux-gnueabihf/codegen-backends/librustc_trans-llvm.so\r\nBacktrace stopped: previous frame identical to this frame (corrupt stack?)\r\n(gdb) disassemble\r\nDump of assembler code for function _ZN6cashew7IString3setEPKcb:\r\n   0x72bf8ef8 <+0>:     push    {r4, r5, r6, r7, r8, r9, r10, r11, lr}\r\n   0x72bf8efc <+4>:     mov     r7, r0\r\n   0x72bf8f00 <+8>:     ldr     r4, [pc, #908]  ; 0x72bf9294 <_ZN6cashew7IString3setEPKcb+924>\r\n   0x72bf8f04 <+12>:    add     r11, sp, #32\r\n   0x72bf8f08 <+16>:    ldr     r0, [pc, #904]  ; 0x72bf9298 <_ZN6cashew7IString3setEPKcb+928>\r\n   0x72bf8f0c <+20>:    sub     sp, sp, #52     ; 0x34\r\n   0x72bf8f10 <+24>:    add     r4, pc, r4\r\n   0x72bf8f14 <+28>:    mov     r8, r2\r\n   0x72bf8f18 <+32>:    str     r1, [r11, #-64] ; 0xffffffc0\r\n   0x72bf8f1c <+36>:    ldr     r2, [r4, r0]\r\n   0x72bf8f20 <+40>:    ldr     r3, [pc, #884]  ; 0x72bf929c <_ZN6cashew7IString3setEPKcb+932>\r\n   0x72bf8f24 <+44>:    str     r2, [r11, #-72] ; 0xffffffb8\r\n   0x72bf8f28 <+48>:    ldr     r2, [r2]\r\n   0x72bf8f2c <+52>:    str     r2, [r11, #-40] ; 0xffffffd8\r\n   0x72bf8f30 <+56>:    ldr     r3, [r4, r3]\r\n   0x72bf8f34 <+60>:    cmp     r3, #0\r\n   0x72bf8f38 <+64>:    str     r3, [r11, #-68] ; 0xffffffbc\r\n   0x72bf8f3c <+68>:    beq     0x72bf8f54 <_ZN6cashew7IString3setEPKcb+92>\r\n   0x72bf8f40 <+72>:    ldr     r3, [pc, #856]  ; 0x72bf92a0 <_ZN6cashew7IString3setEPKcb+936>\r\n   0x72bf8f44 <+76>:    ldr     r0, [r4, r3]\r\n   0x72bf8f48 <+80>:    bl      0x70cda270 <pthread_mutex_lock@plt>\r\n   0x72bf8f4c <+84>:    cmp     r0, #0\r\n   0x72bf8f50 <+88>:    bne     0x72bf923c <_ZN6cashew7IString3setEPKcb+836>\r\n   0x72bf8f54 <+92>:    ldr     r3, [pc, #840]  ; 0x72bf92a4 <_ZN6cashew7IString3setEPKcb+940>\r\n   0x72bf8f58 <+96>:    ldr     r5, [r4, r3]\r\n   0x72bf8f5c <+100>:   ldrb    r3, [r5]\r\n   0x72bf8f60 <+104>:   dmb     ish\r\n   0x72bf8f64 <+108>:   ands    r6, r3, #1\r\n   0x72bf8f68 <+112>:   beq     0x72bf9120 <_ZN6cashew7IString3setEPKcb+552>\r\n   0x72bf8f6c <+116>:   ldr     r3, [pc, #820]  ; 0x72bf92a8 <_ZN6cashew7IString3setEPKcb+944>\r\n   0x72bf8f70 <+120>:   ldr     r5, [r4, r3]\r\n   0x72bf8f74 <+124>:   ldr     r3, [r11, #-64] ; 0xffffffc0\r\n   0x72bf8f78 <+128>:   add     r1, r3, #1\r\n   0x72bf8f7c <+132>:   ldrb    r2, [r3]\r\n   0x72bf8f80 <+136>:   movw    r3, #5381       ; 0x1505\r\n   0x72bf8f84 <+140>:   cmp     r2, #0\r\n   0x72bf8f88 <+144>:   beq     0x72bf8fa0 <_ZN6cashew7IString3setEPKcb+168>\r\n   0x72bf8f8c <+148>:   add     r3, r3, r3, lsl #5\r\n   0x72bf8f90 <+152>:   eor     r3, r3, r2\r\n   0x72bf8f94 <+156>:   ldrb    r2, [r1], #1\r\n   0x72bf8f98 <+160>:   cmp     r2, #0\r\n   0x72bf8f9c <+164>:   bne     0x72bf8f8c <_ZN6cashew7IString3setEPKcb+148>\r\n   0x72bf8fa0 <+168>:   ldr     r1, [r5, #4]\r\n   0x72bf8fa4 <+172>:   sub     r6, r11, #64    ; 0x40\r\n=> 0x72bf8fa8 <+176>:   udiv    r0, r3, r1\r\n   0x72bf8fac <+180>:   mov     r2, r6\r\n   0x72bf8fb0 <+184>:   mls     r1, r1, r0, r3\r\n   0x72bf8fb4 <+188>:   mov     r0, r5\r\n   0x72bf8fb8 <+192>:   bl      0x70ccda90 <_ZNKSt10_HashtableIPKcS1_SaIS1_ENSt8__detail9_IdentityEN6cashew7IString12CStringEqualENS6_11CStringHashENS3_18_Mod_range_hashingENS3_20_Default_ranged_hashENS3_20_Prime_rehash_policyENS3_17_Hashtable_traitsILb1ELb1ELb1EEEE19_M_find_before_nodeEjRKS1_j@plt>\r\n   0x72bf8fbc <+196>:   cmp     r0, #0\r\n   0x72bf8fc0 <+200>:   beq     0x72bf9010 <_ZN6cashew7IString3setEPKcb+280>\r\n   0x72bf8fc4 <+204>:   ldr     r3, [r0]\r\n   0x72bf8fc8 <+208>:   cmp     r3, #0\r\n   0x72bf8fcc <+212>:   beq     0x72bf9010 <_ZN6cashew7IString3setEPKcb+280>\r\n   0x72bf8fd0 <+216>:   ldr     r3, [r3, #4]\r\n   0x72bf8fd4 <+220>:   str     r3, [r11, #-64] ; 0xffffffc0\r\n   0x72bf8fd8 <+224>:   ldr     r2, [r11, #-68] ; 0xffffffbc\r\n   0x72bf8fdc <+228>:   str     r3, [r7]\r\n   0x72bf8fe0 <+232>:   cmp     r2, #0\r\n   0x72bf8fe4 <+236>:   beq     0x72bf8ff4 <_ZN6cashew7IString3setEPKcb+252>\r\n...\r\n```\r\n\r\nRaw instruction:\r\n```\r\n=> 0x72bf8fa8 <+176>:   13 f1 30 e7     udiv    r0, r3, r1\r\n```\r\n\r\nI tried downgrading version by version to see if I could find one that works, and it turns out 1.22.1 works (and was able to build what I wanted to build) but 1.23.0 does not.", "closed_by": {"login": "sanxiyn", "id": 45249, "node_id": "MDQ6VXNlcjQ1MjQ5", "avatar_url": "https://avatars.githubusercontent.com/u/45249?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanxiyn", "html_url": "https://github.com/sanxiyn", "followers_url": "https://api.github.com/users/sanxiyn/followers", "following_url": "https://api.github.com/users/sanxiyn/following{/other_user}", "gists_url": "https://api.github.com/users/sanxiyn/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanxiyn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanxiyn/subscriptions", "organizations_url": "https://api.github.com/users/sanxiyn/orgs", "repos_url": "https://api.github.com/users/sanxiyn/repos", "events_url": "https://api.github.com/users/sanxiyn/events{/privacy}", "received_events_url": "https://api.github.com/users/sanxiyn/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/50732/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/50732/timeline", "performed_via_github_app": null, "state_reason": "completed"}