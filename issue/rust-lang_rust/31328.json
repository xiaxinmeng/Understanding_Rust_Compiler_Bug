{"url": "https://api.github.com/repos/rust-lang/rust/issues/31328", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/31328/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/31328/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/31328/events", "html_url": "https://github.com/rust-lang/rust/issues/31328", "id": 130174819, "node_id": "MDU6SXNzdWUxMzAxNzQ4MTk=", "number": 31328, "title": "x86_64 to i686 cross compile: down-with-thread-dtors.stage2 SEGVs only under valgrind", "user": {"login": "nodakai", "id": 90726, "node_id": "MDQ6VXNlcjkwNzI2", "avatar_url": "https://avatars.githubusercontent.com/u/90726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nodakai", "html_url": "https://github.com/nodakai", "followers_url": "https://api.github.com/users/nodakai/followers", "following_url": "https://api.github.com/users/nodakai/following{/other_user}", "gists_url": "https://api.github.com/users/nodakai/gists{/gist_id}", "starred_url": "https://api.github.com/users/nodakai/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nodakai/subscriptions", "organizations_url": "https://api.github.com/users/nodakai/orgs", "repos_url": "https://api.github.com/users/nodakai/repos", "events_url": "https://api.github.com/users/nodakai/events{/privacy}", "received_events_url": "https://api.github.com/users/nodakai/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 167285428, "node_id": "MDU6TGFiZWwxNjcyODU0Mjg=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-cross", "name": "A-cross", "color": "f7e101", "default": false, "description": "Area: Cross compilation"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2016-01-31T19:58:25Z", "updated_at": "2016-02-23T14:56:17Z", "closed_at": "2016-02-20T02:52:09Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Not even sure if this is a real bug or not, but it's 100% reproducible in my environment, even after `make clean`.\n\n```\n$ uname -a\nLinux d9 4.2.0-1-amd64 #1 SMP Debian 4.2.5-1 (2015-10-27) x86_64 GNU/Linux\n$ valgrind --version\nvalgrind-3.11.0\n```\n\n```\n$ ./configure --prefix=$HOME/local/rust --enable-local-rust --local-rust-root=$HOME/local/rust0 --target=x86_64-unknown-linux-gnu,i686-unknown-linux-gnu\n...\n$ make check-stage2-rpass-valgrind VERBOSE=1 RUST_BACKTRACE=1\ncfg: version 1.8.0-dev (9a07087bc 2016-01-30)\ncfg: build triple x86_64-unknown-linux-gnu\ncfg: host triples x86_64-unknown-linux-gnu\ncfg: target triples x86_64-unknown-linux-gnu i686-unknown-linux-gnu\ncfg: non-build target triples i686-unknown-linux-gnu\ncfg: host for x86_64-unknown-linux-gnu is x86_64\ncfg: host for i686-unknown-linux-gnu is i386\ncfg: os for x86_64-unknown-linux-gnu is unknown-linux-gnu\ncfg: os for i686-unknown-linux-gnu is unknown-linux-gnu\ncfg: have good valgrind for x86_64-unknown-linux-gnu\ncfg: have good valgrind for i686-unknown-linux-gnu\ncfg: using CC=gcc (CFG_CC)\ncfg: enabling valgrind run-pass tests (CFG_ENABLE_VALGRIND_RPASS)\ncfg: valgrind-rpass command set to \"/usr/bin/valgrind\" --error-exitcode=100 --fair-sched=try --quiet --soname-synonyms=somalloc=NONE --suppressions=/home/nodakai/src/rust-HEAD/src/etc/x86.supp  --tool=memcheck --leak-check=full\ncfg: including test rules\ncfg: lexer tooling not available, skipping lexer test...\ntouch tmp/check-stage2-T-i686-unknown-linux-gnu-H-x86_64-unknown-linux-gnu-rpass-valgrind.ok.start_time\nLD_LIBRARY_PATH=/home/nodakai/src/rust-HEAD/x86_64-unknown-linux-gnu/stage2/lib:/home/nodakai/src/rust-HEAD/x86_64-unknown-linux-gnu/llvm/Release/lib:$LD_LIBRARY_PATH x86_64-unknown-linux-gnu/stage2/bin/compiletest --compile-lib-path x86_64-unknown-linux-gnu/stage2/lib --run-lib-path x86_64-unknown-linux-gnu/stage2/lib/rustlib/i686-unknown-linux-gnu/lib --rustc-path x86_64-unknown-linux-gnu/stage2/bin/rustc --rustdoc-path x86_64-unknown-linux-gnu/stage2/bin/rustdoc --llvm-bin-path /home/nodakai/src/rust-HEAD/x86_64-unknown-linux-gnu/llvm/Release/bin --aux-base /home/nodakai/src/rust-HEAD/src/test/auxiliary/ --stage-id stage2-i686-unknown-linux-gnu --target i686-unknown-linux-gnu --host x86_64-unknown-linux-gnu --python \"/usr/bin/python2.7\" --gdb-version=\"GNU gdb (Debian 7.10-1+b1) 7.10\" --lldb-version=\"\" --android-cross-path=/opt/ndk_standalone --adb-path= --adb-test-dir= --host-rustcflags \"   --cfg rtopt -C rpath -O -L x86_64-unknown-linux-gnu/rt\" --lldb-python-dir= --target-rustcflags \"-C linker=gcc -C ar=ar     --cfg rtopt -C rpath -O -L i686-unknown-linux-gnu/rt\"  --verbose --valgrind-path \"\"/usr/bin/valgrind\" --error-exitcode=100 --fair-sched=try --quiet --soname-synonyms=somalloc=NONE --suppressions=/home/nodakai/src/rust-HEAD/src/etc/x86.supp  --tool=memcheck --leak-check=full\" --force-valgrind --src-base /home/nodakai/src/rust-HEAD/src/test/run-pass-valgrind/ --build-base x86_64-unknown-linux-gnu/test/run-pass-valgrind/ --mode run-pass-valgrind  --logfile tmp/check-stage2-T-i686-unknown-linux-gnu-H-x86_64-unknown-linux-gnu-rpass-valgrind.log && touch -r tmp/check-stage2-T-i686-unknown-linux-gnu-H-x86_64-unknown-linux-gnu-rpass-valgrind.ok.start_time tmp/check-stage2-T-i686-unknown-linux-gnu-H-x86_64-unknown-linux-gnu-rpass-valgrind.ok && rm tmp/check-stage2-T-i686-unknown-linux-gnu-H-x86_64-unknown-linux-gnu-rpass-valgrind.ok.start_time\nconfiguration:\ncompile_lib_path: \"x86_64-unknown-linux-gnu/stage2/lib\"\nrun_lib_path: \"x86_64-unknown-linux-gnu/stage2/lib/rustlib/i686-unknown-linux-gnu/lib\"\nrustc_path: \"x86_64-unknown-linux-gnu/stage2/bin/rustc\"\nrustdoc_path: \"x86_64-unknown-linux-gnu/stage2/bin/rustdoc\"\nsrc_base: \"/home/nodakai/src/rust-HEAD/src/test/run-pass-valgrind/\"\nbuild_base: \"x86_64-unknown-linux-gnu/test/run-pass-valgrind/\"\nstage_id: stage2-i686-unknown-linux-gnu\nmode: run-pass-valgrind\nrun_ignored: false\nfilter: (none)\nruntool: (none)\nhost-rustcflags:    --cfg rtopt -C rpath -O -L x86_64-unknown-linux-gnu/rt\ntarget-rustcflags: -C linker=gcc -C ar=ar     --cfg rtopt -C rpath -O -L i686-unknown-linux-gnu/rt\ntarget: i686-unknown-linux-gnu\nhost: x86_64-unknown-linux-gnu\nandroid-cross-path: \"/opt/ndk_standalone\"\nadb_path: \"\"\nadb_test_dir: \"/i686-unknown-linux-gnu\"\nadb_device_status: false\nverbose: true\n\n\n\nrunning 8 tests\ntest [run-pass-valgrind] run-pass-valgrind/dst-dtor-1.rs ... ok\ntest [run-pass-valgrind] run-pass-valgrind/cleanup-auto-borrow-obj.rs ... ok\ntest [run-pass-valgrind] run-pass-valgrind/dst-dtor-2.rs ... ok\ntest [run-pass-valgrind] run-pass-valgrind/cast-enum-with-dtor.rs ... ok\ntest [run-pass-valgrind] run-pass-valgrind/osx-frameworks.rs ... ok\ntest [run-pass-valgrind] run-pass-valgrind/cleanup-stdin.rs ... ok\ntest [run-pass-valgrind] run-pass-valgrind/exit-flushes.rs ... ok\ntest [run-pass-valgrind] run-pass-valgrind/down-with-thread-dtors.rs ... FAILED\n\nfailures:\n\n---- [run-pass-valgrind] run-pass-valgrind/down-with-thread-dtors.rs stdout ----\n\n\nexecuting x86_64-unknown-linux-gnu/stage2/bin/rustc /home/nodakai/src/rust-HEAD/src/test/run-pass-valgrind/down-with-thread-dtors.rs -L x86_64-unknown-linux-gnu/test/run-pass-valgrind/ --target=i686-unknown-linux-gnu -L x86_64-unknown-linux-gnu/test/run-pass-valgrind/down-with-thread-dtors.stage2-i686-unknown-linux-gnu.run-pass-valgrind.libaux -C prefer-dynamic -o x86_64-unknown-linux-gnu/test/run-pass-valgrind/down-with-thread-dtors.stage2-i686-unknown-linux-gnu -C linker=gcc -C ar=ar --cfg rtopt -C rpath -O -L i686-unknown-linux-gnu/rt\n------stdout------------------------------\n\n------stderr------------------------------\n\n------------------------------------------\nexecuting /usr/bin/valgrind --error-exitcode=100 --fair-sched=try --quiet --soname-synonyms=somalloc=NONE --suppressions=/home/nodakai/src/rust-HEAD/src/etc/x86.supp --tool=memcheck --leak-check=full x86_64-unknown-linux-gnu/test/run-pass-valgrind/down-with-thread-dtors.stage2-i686-unknown-linux-gnu\n------stdout------------------------------\n\n------stderr------------------------------\n--6449-- WARNING: Serious error when reading debug info\n--6449-- When reading debug info from /lib/i386-linux-gnu/ld-2.21.so:\n--6449-- Ignoring non-Dwarf2/3/4 block in .debug_info\n--6449-- WARNING: Serious error when reading debug info\n--6449-- When reading debug info from /lib/i386-linux-gnu/ld-2.21.so:\n--6449-- Last block truncated in .debug_info; ignoring\n--6449-- WARNING: Serious error when reading debug info\n--6449-- When reading debug info from /lib/i386-linux-gnu/ld-2.21.so:\n--6449-- parse_CU_Header: is neither DWARF2 nor DWARF3 nor DWARF4\n--6449-- WARNING: Serious error when reading debug info\n--6449-- When reading debug info from /lib/i386-linux-gnu/libc-2.21.so:\n--6449-- Ignoring non-Dwarf2/3/4 block in .debug_info\n--6449-- WARNING: Serious error when reading debug info\n--6449-- When reading debug info from /lib/i386-linux-gnu/libc-2.21.so:\n--6449-- Last block truncated in .debug_info; ignoring\n--6449-- WARNING: Serious error when reading debug info\n--6449-- When reading debug info from /lib/i386-linux-gnu/libc-2.21.so:\n--6449-- parse_CU_Header: is neither DWARF2 nor DWARF3 nor DWARF4\n--6449-- WARNING: Serious error when reading debug info\n--6449-- When reading debug info from /lib/i386-linux-gnu/libdl-2.21.so:\n--6449-- Ignoring non-Dwarf2/3/4 block in .debug_info\n--6449-- WARNING: Serious error when reading debug info\n--6449-- When reading debug info from /lib/i386-linux-gnu/libdl-2.21.so:\n--6449-- Last block truncated in .debug_info; ignoring\n--6449-- WARNING: Serious error when reading debug info\n--6449-- When reading debug info from /lib/i386-linux-gnu/libdl-2.21.so:\n--6449-- parse_CU_Header: is neither DWARF2 nor DWARF3 nor DWARF4\n--6449-- WARNING: Serious error when reading debug info\n--6449-- When reading debug info from /lib/i386-linux-gnu/libm-2.21.so:\n--6449-- Ignoring non-Dwarf2/3/4 block in .debug_info\n--6449-- WARNING: Serious error when reading debug info\n--6449-- When reading debug info from /lib/i386-linux-gnu/libm-2.21.so:\n--6449-- Last block truncated in .debug_info; ignoring\n--6449-- WARNING: Serious error when reading debug info\n--6449-- When reading debug info from /lib/i386-linux-gnu/libm-2.21.so:\n--6449-- parse_CU_Header: is neither DWARF2 nor DWARF3 nor DWARF4\n==6449== Can't extend stack to 0x4bb9880 during signal delivery for thread 2:\n==6449==   no stack segment                                         \n==6449==                                                            \n==6449== Process terminating with default action of signal 11 (SIGSEGV)\n==6449==  Access not within mapped region at address 0x4BB9880      \n==6449==    at 0x10936F: Bar::drop.4321::h008b747fa83237a8 (in /home/nodakai/src/rust-HEAD/x86_64-unknown-linux-gnu/test/run-pass-valgrind/down-with-thread-dtors.stage2-i686-unknown-linux-gnu)\n==6449==    by 0x4C42A3B: __call_tls_dtors (in /lib/i386-linux-gnu/libc-2.21.so)\n==6449==    by 0x4BDFF78: start_thread (pthread_create.c:343)       \n==6449==    by 0x4CE7C5D: clone (in /lib/i386-linux-gnu/libc-2.21.so)\n==6449==  If you believe this happened as a result of a stack       \n==6449==  overflow in your program's main thread (unlikely but      \n==6449==  possible), you can try to increase the size of the        \n==6449==  main thread stack using the --main-stacksize= flag.       \n==6449==  The main thread stack size used in this run was 8388608.  \n==6449== 152 bytes in 1 blocks are possibly lost in loss record 6 of 7\n==6449==    at 0x482E118: calloc (in /usr/lib/valgrind/vgpreload_memcheck-x86-linux.so)\n==6449==    by 0x4010B06: allocate_dtv (in /lib/i386-linux-gnu/ld-2.21.so)\n==6449==    by 0x40114EB: _dl_allocate_tls (in /lib/i386-linux-gnu/ld-2.21.so)\n==6449==    by 0x4BE07B4: allocate_stack (allocatestack.c:587)      \n==6449==    by 0x4BE07B4: pthread_create@@GLIBC_2.1 (pthread_create.c:537)\n==6449==    by 0x48E1BB6: sys::thread::Thread::new::h2db9ab5f5bc239c37ux (in /home/nodakai/src/rust-HEAD/x86_64-unknown-linux-gnu/stage2/lib/rustlib/i686-unknown-linux-gnu/lib/libstd-db5a760f.so)\n==6449==    by 0x1096D0: main::h225df9f85db6309aGfa (in /home/nodakai/src/rust-HEAD/x86_64-unknown-linux-gnu/test/run-pass-valgrind/down-with-thread-dtors.stage2-i686-unknown-linux-gnu)\n==6449==    by 0x48F2ECA: sys_common::unwind::try::try_fn::h17787564768047935801 (in /home/nodakai/src/rust-HEAD/x86_64-unknown-linux-gnu/stage2/lib/rustlib/i686-unknown-linux-gnu/lib/libstd-db5a760f.so)\n==6449==    by 0x48E9DE7: __rust_try (in /home/nodakai/src/rust-HEAD/x86_64-unknown-linux-gnu/stage2/lib/rustlib/i686-unknown-linux-gnu/lib/libstd-db5a760f.so)\n==6449==    by 0x48F29CF: rt::lang_start::hed30906487dce269Wxy (in /home/nodakai/src/rust-HEAD/x86_64-unknown-linux-gnu/stage2/lib/rustlib/i686-unknown-linux-gnu/lib/libstd-db5a760f.so)\n==6449==    by 0x10A57D: main (in /home/nodakai/src/rust-HEAD/x86_64-unknown-linux-gnu/test/run-pass-valgrind/down-with-thread-dtors.stage2-i686-unknown-linux-gnu)\n==6449==                                                            \n\n------------------------------------------                          \n\nerror: test run failed!                                             \nstatus: signal: 9                                                   \ncommand: /usr/bin/valgrind --error-exitcode=100 --fair-sched=try --quiet --soname-synonyms=somalloc=NONE --suppressions=/home/nodakai/src/rust-HEAD/src/etc/x86.supp --tool=memcheck --leak-check=full x86_64-unknown-linux-gnu/test/run-pass-valgrind/down-with-thread-dtors.stage2-i686-unknown-linux-gnu                                                     \nstdout:                                                             \n------------------------------------------                          \n\n------------------------------------------                          \nstderr:                                                             \n------------------------------------------                          \n--6449-- WARNING: Serious error when reading debug info             \n--6449-- When reading debug info from /lib/i386-linux-gnu/ld-2.21.so:\n--6449-- Ignoring non-Dwarf2/3/4 block in .debug_info               \n--6449-- WARNING: Serious error when reading debug info             \n--6449-- When reading debug info from /lib/i386-linux-gnu/ld-2.21.so:\n--6449-- Last block truncated in .debug_info; ignoring              \n--6449-- WARNING: Serious error when reading debug info             \n--6449-- When reading debug info from /lib/i386-linux-gnu/ld-2.21.so:\n--6449-- parse_CU_Header: is neither DWARF2 nor DWARF3 nor DWARF4   \n--6449-- WARNING: Serious error when reading debug info             \n--6449-- When reading debug info from /lib/i386-linux-gnu/libc-2.21.so:\n--6449-- Ignoring non-Dwarf2/3/4 block in .debug_info               \n--6449-- WARNING: Serious error when reading debug info             \n--6449-- When reading debug info from /lib/i386-linux-gnu/libc-2.21.so:\n--6449-- Last block truncated in .debug_info; ignoring              \n--6449-- WARNING: Serious error when reading debug info             \n--6449-- When reading debug info from /lib/i386-linux-gnu/libc-2.21.so:\n--6449-- parse_CU_Header: is neither DWARF2 nor DWARF3 nor DWARF4   \n--6449-- WARNING: Serious error when reading debug info             \n--6449-- When reading debug info from /lib/i386-linux-gnu/libdl-2.21.so:\n--6449-- Ignoring non-Dwarf2/3/4 block in .debug_info               \n--6449-- WARNING: Serious error when reading debug info             \n--6449-- When reading debug info from /lib/i386-linux-gnu/libdl-2.21.so:\n--6449-- Last block truncated in .debug_info; ignoring              \n--6449-- WARNING: Serious error when reading debug info             \n--6449-- When reading debug info from /lib/i386-linux-gnu/libdl-2.21.so:\n--6449-- parse_CU_Header: is neither DWARF2 nor DWARF3 nor DWARF4   \n--6449-- WARNING: Serious error when reading debug info             \n--6449-- When reading debug info from /lib/i386-linux-gnu/libm-2.21.so:\n--6449-- Ignoring non-Dwarf2/3/4 block in .debug_info               \n--6449-- WARNING: Serious error when reading debug info             \n--6449-- When reading debug info from /lib/i386-linux-gnu/libm-2.21.so:\n--6449-- Last block truncated in .debug_info; ignoring              \n--6449-- WARNING: Serious error when reading debug info             \n--6449-- When reading debug info from /lib/i386-linux-gnu/libm-2.21.so:\n--6449-- parse_CU_Header: is neither DWARF2 nor DWARF3 nor DWARF4   \n==6449== Can't extend stack to 0x4bb9880 during signal delivery for thread 2:\n==6449==   no stack segment                                         \n==6449==                                                            \n==6449== Process terminating with default action of signal 11 (SIGSEGV)\n==6449==  Access not within mapped region at address 0x4BB9880      \n==6449==    at 0x10936F: Bar::drop.4321::h008b747fa83237a8 (in /home/nodakai/src/rust-HEAD/x86_64-unknown-linux-gnu/test/run-pass-valgrind/down-with-thread-dtors.stage2-i686-unknown-linux-gnu)\n==6449==    by 0x4C42A3B: __call_tls_dtors (in /lib/i386-linux-gnu/libc-2.21.so)\n==6449==    by 0x4BDFF78: start_thread (pthread_create.c:343)       \n==6449==    by 0x4CE7C5D: clone (in /lib/i386-linux-gnu/libc-2.21.so)\n==6449==  If you believe this happened as a result of a stack       \n==6449==  overflow in your program's main thread (unlikely but      \n==6449==  possible), you can try to increase the size of the        \n==6449==  main thread stack using the --main-stacksize= flag.       \n==6449==  The main thread stack size used in this run was 8388608.  \n==6449== 152 bytes in 1 blocks are possibly lost in loss record 6 of 7\n==6449==    at 0x482E118: calloc (in /usr/lib/valgrind/vgpreload_memcheck-x86-linux.so)\n==6449==    by 0x4010B06: allocate_dtv (in /lib/i386-linux-gnu/ld-2.21.so)\n==6449==    by 0x40114EB: _dl_allocate_tls (in /lib/i386-linux-gnu/ld-2.21.so)\n==6449==    by 0x4BE07B4: allocate_stack (allocatestack.c:587)      \n==6449==    by 0x4BE07B4: pthread_create@@GLIBC_2.1 (pthread_create.c:537)\n==6449==    by 0x48E1BB6: sys::thread::Thread::new::h2db9ab5f5bc239c37ux (in /home/nodakai/src/rust-HEAD/x86_64-unknown-linux-gnu/stage2/lib/rustlib/i686-unknown-linux-gnu/lib/libstd-db5a760f.so)\n==6449==    by 0x1096D0: main::h225df9f85db6309aGfa (in /home/nodakai/src/rust-HEAD/x86_64-unknown-linux-gnu/test/run-pass-valgrind/down-with-thread-dtors.stage2-i686-unknown-linux-gnu)\n==6449==    by 0x48F2ECA: sys_common::unwind::try::try_fn::h17787564768047935801 (in /home/nodakai/src/rust-HEAD/x86_64-unknown-linux-gnu/stage2/lib/rustlib/i686-unknown-linux-gnu/lib/libstd-db5a760f.so)\n==6449==    by 0x48E9DE7: __rust_try (in /home/nodakai/src/rust-HEAD/x86_64-unknown-linux-gnu/stage2/lib/rustlib/i686-unknown-linux-gnu/lib/libstd-db5a760f.so)\n==6449==    by 0x48F29CF: rt::lang_start::hed30906487dce269Wxy (in /home/nodakai/src/rust-HEAD/x86_64-unknown-linux-gnu/stage2/lib/rustlib/i686-unknown-linux-gnu/lib/libstd-db5a760f.so)\n==6449==    by 0x10A57D: main (in /home/nodakai/src/rust-HEAD/x86_64-unknown-linux-gnu/test/run-pass-valgrind/down-with-thread-dtors.stage2-i686-unknown-linux-gnu)\n==6449==                                                            \n\n------------------------------------------                          \n\nthread '[run-pass-valgrind] run-pass-valgrind/down-with-thread-dtors.rs' panicked at 'explicit panic', /home/nodakai/src/rust-HEAD/src/compiletest/runtest.rs:1516\nstack backtrace:                                                    \n   1:     0x7f1fd1f267d0 - sys::backtrace::tracing::imp::write::h97e6ef5c751bdc2c5nu\n   2:     0x7f1fd1f2d3eb - panicking::default_handler::_$u7b$$u7b$closure$u7d$$u7d$::closure.42840\n   3:     0x7f1fd1f2cf41 - panicking::default_handler::h1a504cc1542efa12IFy\n   4:     0x7f1fd1ef67ec - sys_common::unwind::begin_unwind_inner::hc99232f5c6b52a5bDgt\n   5:     0x5640e608cd2f - sys_common::unwind::begin_unwind::h1666939853081061408\n   6:     0x5640e60a7f06 - runtest::fatal_proc_rec::h394fb6b8ac10e5882Hc\n   7:     0x5640e609643e - runtest::run::h02546a4866f603e34La       \n   8:     0x5640e6097717 - boxed::F.FnBox<A>::call_box::h9005184255364516560\n   9:     0x7f1fd262c66b - sys_common::unwind::try::try_fn::h2545155071472818957\n  10:     0x7f1fd1f2439b - __rust_try                               \n  11:     0x7f1fd1f1be2d - sys_common::unwind::inner_try::h1728cfeb22ee0311Fdt\n  12:     0x7f1fd262c9ea - boxed::F.FnBox<A>::call_box::h4996586291295678521\n  13:     0x7f1fd1f2b993 - sys::thread::Thread::new::thread_start::h43844f68128dea4bsCx\n  14:     0x7f1fd145c283 - start_thread                             \n  15:     0x7f1fd199497c - clone                                    \n  16:                0x0 - <unknown>                                \n\n\n\nfailures:                                                           \n    [run-pass-valgrind] run-pass-valgrind/down-with-thread-dtors.rs \n\ntest result: FAILED. 7 passed; 1 failed; 0 ignored; 0 measured      \n\nthread '<main>' panicked at 'Some tests failed', /home/nodakai/src/rust-HEAD/src/compiletest/compiletest.rs:244\nstack backtrace:                                                    \n   1:     0x7f1fd1f267d0 - sys::backtrace::tracing::imp::write::h97e6ef5c751bdc2c5nu\n   2:     0x7f1fd1f2d3eb - panicking::default_handler::_$u7b$$u7b$closure$u7d$$u7d$::closure.42840\n   3:     0x7f1fd1f2cff6 - panicking::default_handler::h1a504cc1542efa12IFy\n   4:     0x7f1fd1ef67ec - sys_common::unwind::begin_unwind_inner::hc99232f5c6b52a5bDgt\n   5:     0x5640e608cd2f - sys_common::unwind::begin_unwind::h1666939853081061408\n   6:     0x5640e607eeef - main::h2ba9907fd693c4472Ad               \n   7:     0x7f1fd1f2cab4 - sys_common::unwind::try::try_fn::h7253349451187764956\n   8:     0x7f1fd1f2439b - __rust_try\n   9:     0x7f1fd1f2c52e - rt::lang_start::hf226f4e667a8968eOxy\n  10:     0x7f1fd18cc86f - __libc_start_main\n  11:     0x5640e6079e48 - _start\n  12:                0x0 - <unknown>\n/home/nodakai/src/rust-HEAD/mk/tests.mk:743: recipe for target 'tmp/check-stage2-T-i686-unknown-linux-gnu-H-x86_64-unknown-linux-gnu-rpass-valgrind.ok' failed\nmake: *** [tmp/check-stage2-T-i686-unknown-linux-gnu-H-x86_64-unknown-linux-gnu-rpass-valgrind.ok] Error 101\n```\n\n```\n$ valgrind x86_64-unknown-linux-gnu/test/run-pass-valgrind/down-with-thread-dtors.stage2-i686-unknown-linux-gnu                                                                                                                        (git)-heads/master \n==9775== Memcheck, a memory error detector                                                  \n==9775== Copyright (C) 2002-2015, and GNU GPL'd, by Julian Seward et al.\n==9775== Using Valgrind-3.11.0 and LibVEX; rerun with -h for copyright info\n==9775== Command: x86_64-unknown-linux-gnu/test/run-pass-valgrind/down-with-thread-dtors.stage2-i686-unknown-linux-gnu\n==9775== \n--9775-- WARNING: Serious error when reading debug info\n--9775-- When reading debug info from /lib/i386-linux-gnu/ld-2.21.so:\n--9775-- Ignoring non-Dwarf2/3/4 block in .debug_info\n--9775-- WARNING: Serious error when reading debug info\n--9775-- When reading debug info from /lib/i386-linux-gnu/ld-2.21.so:\n--9775-- Last block truncated in .debug_info; ignoring\n--9775-- WARNING: Serious error when reading debug info\n--9775-- When reading debug info from /lib/i386-linux-gnu/ld-2.21.so:\n--9775-- parse_CU_Header: is neither DWARF2 nor DWARF3 nor DWARF4\n--9775-- WARNING: Serious error when reading debug info\n--9775-- When reading debug info from /lib/i386-linux-gnu/libc-2.21.so:\n--9775-- Ignoring non-Dwarf2/3/4 block in .debug_info\n--9775-- WARNING: Serious error when reading debug info\n--9775-- When reading debug info from /lib/i386-linux-gnu/libc-2.21.so:\n--9775-- Last block truncated in .debug_info; ignoring\n--9775-- WARNING: Serious error when reading debug info\n--9775-- When reading debug info from /lib/i386-linux-gnu/libc-2.21.so:\n--9775-- parse_CU_Header: is neither DWARF2 nor DWARF3 nor DWARF4\n--9775-- WARNING: Serious error when reading debug info\n--9775-- When reading debug info from /lib/i386-linux-gnu/libdl-2.21.so:\n--9775-- Ignoring non-Dwarf2/3/4 block in .debug_info\n--9775-- WARNING: Serious error when reading debug info\n--9775-- When reading debug info from /lib/i386-linux-gnu/libdl-2.21.so:\n--9775-- Last block truncated in .debug_info; ignoring\n--9775-- WARNING: Serious error when reading debug info\n--9775-- When reading debug info from /lib/i386-linux-gnu/libdl-2.21.so:\n--9775-- parse_CU_Header: is neither DWARF2 nor DWARF3 nor DWARF4\n--9775-- WARNING: Serious error when reading debug info\n--9775-- When reading debug info from /lib/i386-linux-gnu/libm-2.21.so:\n--9775-- Ignoring non-Dwarf2/3/4 block in .debug_info\n--9775-- WARNING: Serious error when reading debug info\n--9775-- When reading debug info from /lib/i386-linux-gnu/libm-2.21.so:\n--9775-- Last block truncated in .debug_info; ignoring\n--9775-- WARNING: Serious error when reading debug info\n--9775-- When reading debug info from /lib/i386-linux-gnu/libm-2.21.so:\n--9775-- parse_CU_Header: is neither DWARF2 nor DWARF3 nor DWARF4\n==9775== Can't extend stack to 0x4bb9880 during signal delivery for thread 2:\n==9775==   no stack segment\n==9775== \n==9775== Process terminating with default action of signal 11 (SIGSEGV)\n==9775==  Access not within mapped region at address 0x4BB9880\n==9775==    at 0x10936F: Bar::drop.4321::h008b747fa83237a8 (in /home/nodakai/src/rust-HEAD/x86_64-unknown-linux-gnu/test/run-pass-valgrind/down-with-thread-dtors.stage2-i686-unknown-linux-gnu)\n==9775==    by 0x4C41A3B: __call_tls_dtors (in /lib/i386-linux-gnu/libc-2.21.so)\n==9775==    by 0x4BDFF78: start_thread (pthread_create.c:343)\n==9775==    by 0x4CE6C5D: clone (in /lib/i386-linux-gnu/libc-2.21.so)\n==9775==  If you believe this happened as a result of a stack\n==9775==  overflow in your program's main thread (unlikely but\n==9775==  possible), you can try to increase the size of the\n==9775==  main thread stack using the --main-stacksize= flag.\n==9775==  The main thread stack size used in this run was 8388608.\n==9775== \n==9775== HEAP SUMMARY:\n==9775==     in use at exit: 692 bytes in 16 blocks\n==9775==   total heap usage: 30 allocs, 14 frees, 1,668 bytes allocated\n==9775== \n==9775== LEAK SUMMARY:\n==9775==    definitely lost: 0 bytes in 0 blocks\n==9775==    indirectly lost: 0 bytes in 0 blocks\n==9775==      possibly lost: 152 bytes in 1 blocks\n==9775==    still reachable: 540 bytes in 15 blocks\n==9775==         suppressed: 0 bytes in 0 blocks\n==9775== Rerun with --leak-check=full to see details of leaked memory\n==9775== \n==9775== For counts of detected and suppressed errors, rerun with: -v\n==9775== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)\nzsh: killed     valgrind \n```\n\n```\n$ gdb x86_64-unknown-linux-gnu/test/run-pass-valgrind/down-with-thread-dtors.stage2-i686-unknown-linux-gnu -ex r\nGNU gdb (Debian 7.10-1+b1) 7.10\nCopyright (C) 2015 Free Software Foundation, Inc.\nLicense GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.  Type \"show copying\"\nand \"show warranty\" for details.\nThis GDB was configured as \"x86_64-linux-gnu\".\nType \"show configuration\" for configuration details.\nFor bug reporting instructions, please see:\n<http://www.gnu.org/software/gdb/bugs/>.\nFind the GDB manual and other documentation resources online at:\n<http://www.gnu.org/software/gdb/documentation/>.\nFor help, type \"help\".\nType \"apropos word\" to search for commands related to \"word\"...\nReading symbols from x86_64-unknown-linux-gnu/test/run-pass-valgrind/down-with-thread-dtors.stage2-i686-unknown-linux-gnu...(no debugging symbols found)...done.\nStarting program: /home/nodakai/src/rust-HEAD/x86_64-unknown-linux-gnu/test/run-pass-valgrind/down-with-thread-dtors.stage2-i686-unknown-linux-gnu \n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib/x86_64-linux-gnu/libthread_db.so.1\".\n[New Thread 0xf7a2ab40 (LWP 14912)]\n[Thread 0xf7a2ab40 (LWP 14912) exited]\n[Inferior 1 (process 14625) exited normally]\n(gdb) q\n```\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/31328/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/31328/timeline", "performed_via_github_app": null, "state_reason": "completed"}