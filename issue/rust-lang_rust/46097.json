{"url": "https://api.github.com/repos/rust-lang/rust/issues/46097", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/46097/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/46097/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/46097/events", "html_url": "https://github.com/rust-lang/rust/issues/46097", "id": 275148771, "node_id": "MDU6SXNzdWUyNzUxNDg3NzE=", "number": 46097, "title": "Enable MIR-borrowck-only output", "user": {"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 234902, "node_id": "MDU6TGFiZWwyMzQ5MDI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-enhancement", "name": "C-enhancement", "color": "f5f1fd", "default": false, "description": "Category: An issue proposing an enhancement or a PR with one."}, {"id": 67766349, "node_id": "MDU6TGFiZWw2Nzc2NjM0OQ==", "url": "https://api.github.com/repos/rust-lang/rust/labels/E-mentor", "name": "E-mentor", "color": "02E10C", "default": false, "description": "Call for participation: This issue has a mentor. Use RustcContributor::new on Zulip for discussion."}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/rust-lang/rust/milestones/42", "html_url": "https://github.com/rust-lang/rust/milestone/42", "labels_url": "https://api.github.com/repos/rust-lang/rust/milestones/42/labels", "id": 2915417, "node_id": "MDk6TWlsZXN0b25lMjkxNTQxNw==", "number": 42, "title": "NLL prototype", "description": "NLL prototype for All-Hands", "creator": {"login": "arielb1", "id": 1830974, "node_id": "MDQ6VXNlcjE4MzA5NzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1830974?v=4", "gravatar_id": "", "url": "https://api.github.com/users/arielb1", "html_url": "https://github.com/arielb1", "followers_url": "https://api.github.com/users/arielb1/followers", "following_url": "https://api.github.com/users/arielb1/following{/other_user}", "gists_url": "https://api.github.com/users/arielb1/gists{/gist_id}", "starred_url": "https://api.github.com/users/arielb1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/arielb1/subscriptions", "organizations_url": "https://api.github.com/users/arielb1/orgs", "repos_url": "https://api.github.com/users/arielb1/repos", "events_url": "https://api.github.com/users/arielb1/events{/privacy}", "received_events_url": "https://api.github.com/users/arielb1/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 27, "state": "closed", "created_at": "2017-11-15T20:57:55Z", "updated_at": "2018-08-04T03:41:20Z", "due_on": "2017-12-08T08:00:00Z", "closed_at": "2018-01-03T19:04:26Z"}, "comments": 6, "created_at": "2017-11-19T10:36:24Z", "updated_at": "2017-11-26T21:30:34Z", "closed_at": "2017-11-26T21:30:34Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Currently, if you pass `-Zborrowck-mir`, we output *both* the AST output (tagged with `(Ast)`) *and* the MIR output (tagged with `(Mir)`).\r\n\r\nExample:\r\n\r\n```rust\r\n> cd src/test/compile-fail\r\n> rustc -Zborrowck-mir borrowck/borrowck-unary-move.rs\r\nerror[E0505]: cannot move out of `x` because it is borrowed (Ast)\r\n  --> borrowck/borrowck-unary-move.rs:17:10\r\n   |\r\n16 |     let y = &*x;\r\n   |              -- borrow of `*x` occurs here\r\n17 |     free(x); //[ast]~ ERROR cannot move out of `x` because it is borrowed\r\n   |          ^ move out of `x` occurs here\r\n\r\nerror[E0505]: cannot move out of `x` because it is borrowed (Mir)\r\n  --> borrowck/borrowck-unary-move.rs:17:10\r\n   |\r\n16 |     let y = &*x;\r\n   |             --- borrow of `(*x)` occurs here\r\n17 |     free(x); //[ast]~ ERROR cannot move out of `x` because it is borrowed\r\n   |          ^ move out of `x` occurs here\r\n\r\nerror: aborting due to 2 previous errors\r\n```\r\n\r\nI would like to alter the switch to be one where there are three mores:\r\n\r\n```\r\n-Zborrowck=ast -- the default, emits only AST\r\n-Zborrowck=mir -- emits only MIR errors (and doesn't write `(Mir)`)\r\n-Zborrowck=compare -- emits both, like `-Zborrowck-mir` does today.\r\n```\r\n\r\nThis will be useful as we progress towards our yearly goal of having a working \"demo\", since the demo isn't very good if people are seeing the old and new errors. It will also be less annoying for editing the unit tests, since we won't need *three* copies of each error. And if we want the current output when running by hand, it is still available.\r\n\r\n\r\n\r\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/46097/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/46097/timeline", "performed_via_github_app": null, "state_reason": "completed"}