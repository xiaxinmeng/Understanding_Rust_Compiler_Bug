{"url": "https://api.github.com/repos/rust-lang/rust/issues/32159", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/32159/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/32159/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/32159/events", "html_url": "https://github.com/rust-lang/rust/issues/32159", "id": 139691147, "node_id": "MDU6SXNzdWUxMzk2OTExNDc=", "number": 32159, "title": "ucrt.lib linkage (again)", "user": {"login": "tommiv", "id": 789246, "node_id": "MDQ6VXNlcjc4OTI0Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/789246?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tommiv", "html_url": "https://github.com/tommiv", "followers_url": "https://api.github.com/users/tommiv/followers", "following_url": "https://api.github.com/users/tommiv/following{/other_user}", "gists_url": "https://api.github.com/users/tommiv/gists{/gist_id}", "starred_url": "https://api.github.com/users/tommiv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tommiv/subscriptions", "organizations_url": "https://api.github.com/users/tommiv/orgs", "repos_url": "https://api.github.com/users/tommiv/repos", "events_url": "https://api.github.com/users/tommiv/events{/privacy}", "received_events_url": "https://api.github.com/users/tommiv/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 266005765, "node_id": "MDU6TGFiZWwyNjYwMDU3NjU=", "url": "https://api.github.com/repos/rust-lang/rust/labels/O-windows-msvc", "name": "O-windows-msvc", "color": "6e6ec0", "default": false, "description": "Toolchain: MSVC, Operating system: Windows"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2016-03-09T20:24:19Z", "updated_at": "2018-05-28T19:32:37Z", "closed_at": "2016-07-02T07:29:16Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm confused with this actually - fresh installation of Rust on Windows (MSVC ABI) fails to link hello world. I found [this ticket](https://github.com/rust-lang/rust/issues/27402) but it's pretty old and it's closed, so I assume it was fixed. Let's go to the explanation.\n\nThis is the simple hello world (`main.rs`):\n\n```\nfn main() {\n    println!(\"Hello, world!\")\n}\n```\n\nthere is no any other files in project, no cargo setup or something.\n\nUsing `rustc main.rs` I'm getting this error:\n\n```\nerror: linking with `link.exe` failed: exit code: 1104\nnote: LINK : fatal error LNK1104: cannot open file 'ucrt.lib'\n```\n\nBased on the ticket above I provided compiler the path to `ucrt.lib` with\n`rustc -L \"C:\\Program Files (x86)\\Windows Kits\\10\\Lib\\10.0.10240.0\\ucrt\\x64\" main.rs` and it works just fine.\n\nAdditional info:\n- Rust is `rustc 1.8.0-beta.1 (facbfdd71 2016-03-02)`, MSVC ABI. (**but** error is the same with 1.7 stable. I didn't try nightly build).\n- OS is `Windows 10 Pro, x64`\n- Visual Studio is 2015 with all available patches installed.\n- Rust `/bin/` directory have added to the `PATH` environment variable.\n\nSo. Am I missed some installation steps or it's a problem with my environment?\n\n**UPD**: Just tried to run compiler from VS developer command prompt and got the other error: `note: msvcrt.lib(chkstk.obj) : fatal error LNK1112: module machine type 'X86' conflicts with target machine type 'x64'` and I have no clue how I can to change the architecture. I don't see a separate x64 version of VS dev cmd.\n\n**UPD2**: I investigated further and found that linker message contains this command line option among the others: `\"/LIBPATH:C:\\\\Program Files (x86)\\\\Windows Kits\\\\10\\\\Lib\\\\10.0.10586.0\\\\ucrt\\\\x64\"`. The weird part here that while my system has `10.0.10586.0` there is NO `ucrt` folder in it. But it has `10.0.10150.0/ucrt/*` and `10.0.10240.0/ucrt/*` folders.\n\n**UPD3**: Since this `ucrt` folder obviously is the part of the Windows 10 SDK, I installed it manually from [official page](https://dev.windows.com/en-us/downloads/windows-10-sdk) with ALL available checkboxes checked. Now I have `10.0.10586.0/ucrt/*` folders and compilation works without any additional steps. In the end I'm not sure should I close this ticket or such situation can be handled by installer or `rustc` itself. _Minor clarification_: I DON'T installed Win 10 SDK manually before, `10.0.10150.0` version was installed either as dependency for some packages I've used in development or with VS updates. Somehow this installation was not full and didn't include this ucrt libraries.\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/32159/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/32159/timeline", "performed_via_github_app": null, "state_reason": "completed"}