{"url": "https://api.github.com/repos/rust-lang/rust/issues/87732", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/87732/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/87732/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/87732/events", "html_url": "https://github.com/rust-lang/rust/issues/87732", "id": 959291542, "node_id": "MDU6SXNzdWU5NTkyOTE1NDI=", "number": 87732, "title": "auto_traits + negative_impls not working as expected with associated types", "user": {"login": "gbj", "id": 286622, "node_id": "MDQ6VXNlcjI4NjYyMg==", "avatar_url": "https://avatars.githubusercontent.com/u/286622?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbj", "html_url": "https://github.com/gbj", "followers_url": "https://api.github.com/users/gbj/followers", "following_url": "https://api.github.com/users/gbj/following{/other_user}", "gists_url": "https://api.github.com/users/gbj/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbj/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbj/subscriptions", "organizations_url": "https://api.github.com/users/gbj/orgs", "repos_url": "https://api.github.com/users/gbj/repos", "events_url": "https://api.github.com/users/gbj/events{/privacy}", "received_events_url": "https://api.github.com/users/gbj/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}, {"id": 1967303144, "node_id": "MDU6TGFiZWwxOTY3MzAzMTQ0", "url": "https://api.github.com/repos/rust-lang/rust/labels/F-negative_impls", "name": "F-negative_impls", "color": "f9c0cc", "default": false, "description": "#![feature(negative_impls)]"}, {"id": 2543602342, "node_id": "MDU6TGFiZWwyNTQzNjAyMzQy", "url": "https://api.github.com/repos/rust-lang/rust/labels/F-auto_traits", "name": "F-auto_traits", "color": "f9c0cc", "default": false, "description": "`#![feature(auto_traits)]`"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-08-03T16:30:18Z", "updated_at": "2021-08-03T16:31:11Z", "closed_at": null, "author_association": "NONE", "active_lock_reason": null, "body": "It's possible that this is working as designed or that I'm taking the wrong approach here, so apologies up front if that's the case. \r\n\r\nI seem to be able to use the combination of `auto_traits` and `negative_impls` to implement traits in a way that is generic but polymorphic for generic types on concrete types, but not for associated types on traits. \r\n\r\n```rust\r\n#![feature(auto_traits, negative_impls)]\r\n\r\nuse std::future::Future;\r\n\r\ntrait MyTrait {}\r\n\r\nstruct MyStruct {}\r\n\r\nstruct GenericStruct<T> {\r\n    value: T,\r\n}\r\n\r\nauto trait NotString {}\r\nimpl !NotString for String {}\r\n\r\n// Generics on a concrete type work as expected\r\n// I can specify T: NotString and there is no conflict\r\nimpl MyTrait for GenericStruct<String> {}\r\nimpl<T: NotString> MyTrait for GenericStruct<T> {}\r\n\r\n// Associated Types don't work as I'd expect\r\nimpl<S> MyTrait for S where S: Future<Output = String> {}\r\n\r\n// Even though T is NotString there's a conflict between Future<Output = String> and Future<Output = T>\r\nimpl<S, T: NotString> MyTrait for S where S: Future<Output = T> {}\r\n```\r\nI would've expected that the compiler could tell that `Future<Output = String>` and `Future<Output = T>` were mutually exclusive, given that `T: NotString`. \r\n\r\n### Meta\r\n\r\n`rustc --version --verbose`:\r\n```\r\nrustc 1.50.0-nightly (7efc097c4 2020-12-12)\r\nbinary: rustc\r\ncommit-hash: 7efc097c4fe6e97f54a44cee91c56189e9ddb41c\r\ncommit-date: 2020-12-12\r\nhost: x86_64-apple-darwin\r\nrelease: 1.50.0-nightly\r\n```\r\n</p>\r\n</details>\r\n", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/87732/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/87732/timeline", "performed_via_github_app": null, "state_reason": null}