{"url": "https://api.github.com/repos/rust-lang/rust/issues/76604", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/76604/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/76604/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/76604/events", "html_url": "https://github.com/rust-lang/rust/issues/76604", "id": 699474620, "node_id": "MDU6SXNzdWU2OTk0NzQ2MjA=", "number": 76604, "title": "rustdoc: layout-relevant private fields can not be documented", "user": {"login": "HeroicKatora", "id": 5550310, "node_id": "MDQ6VXNlcjU1NTAzMTA=", "avatar_url": "https://avatars.githubusercontent.com/u/5550310?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HeroicKatora", "html_url": "https://github.com/HeroicKatora", "followers_url": "https://api.github.com/users/HeroicKatora/followers", "following_url": "https://api.github.com/users/HeroicKatora/following{/other_user}", "gists_url": "https://api.github.com/users/HeroicKatora/gists{/gist_id}", "starred_url": "https://api.github.com/users/HeroicKatora/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HeroicKatora/subscriptions", "organizations_url": "https://api.github.com/users/HeroicKatora/orgs", "repos_url": "https://api.github.com/users/HeroicKatora/repos", "events_url": "https://api.github.com/users/HeroicKatora/events{/privacy}", "received_events_url": "https://api.github.com/users/HeroicKatora/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 203738, "node_id": "MDU6TGFiZWwyMDM3Mzg=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-rustdoc", "name": "T-rustdoc", "color": "bfd4f2", "default": false, "description": "Relevant to the rustdoc team, which will review and decide on the PR/issue."}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-09-11T15:51:33Z", "updated_at": "2023-03-21T19:53:58Z", "closed_at": null, "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Some structs with, e.g. with `repr(C)`, are intended be layout stable. This makes every field relevant to a user particularly for ffi purposes. The names and types of additional alignment fields introduces to avoid uninitialized padding are not meant to be part of the SemVer relevant interface and should not be `pub`. However, this completely elides the documentation so that it becomes guesswork which alignment was done.\r\n\r\n```rust\r\n#[repr(C)]\r\nstruct Duck {\r\n    pub kind: u32,\r\n    _reserved_flags: u32,\r\n    pub quak: u64,\r\n}\r\n```\r\n\r\nThe generated documentation looks like so:\r\n```\r\npub struct Duck {\r\n    pub kind: u32,\r\n    pub quak: u64,\r\n    // some fields omitted\r\n}\r\n```\r\n\r\nThe order is painfully confusing in that it suggests that there _is_ padding. I'd suggest a `#[doc(pub)]` attribute that explicitly shows the field in right order but marked as not being accessible. A workaround is to conditionally make the field public for rustdoc:\r\n\r\n```rust\r\n#[repr(C)]\r\nstruct Duck {\r\n    pub kind: u32,\r\n    #[cfg(not(rustdoc))] _reserved_flags: u32,\r\n    #[cfg(rustdoc)] pub _reserved_flags: u32,\r\n    pub quak: u64,\r\n}\r\n```\r\n\r\n## Context\r\n\r\n`#[doc(hidden)]` can be applied to fields and functions to _not_ list them in the documentation even if they would otherwise be publicly documented.", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/76604/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/76604/timeline", "performed_via_github_app": null, "state_reason": null}