{"url": "https://api.github.com/repos/rust-lang/rust/issues/75868", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/75868/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/75868/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/75868/events", "html_url": "https://github.com/rust-lang/rust/issues/75868", "id": 684365569, "node_id": "MDU6SXNzdWU2ODQzNjU1Njk=", "number": 75868, "title": "Non-exported public type in return type of pub fn in exported public type", "user": {"login": "caranatar", "id": 51875954, "node_id": "MDQ6VXNlcjUxODc1OTU0", "avatar_url": "https://avatars.githubusercontent.com/u/51875954?v=4", "gravatar_id": "", "url": "https://api.github.com/users/caranatar", "html_url": "https://github.com/caranatar", "followers_url": "https://api.github.com/users/caranatar/followers", "following_url": "https://api.github.com/users/caranatar/following{/other_user}", "gists_url": "https://api.github.com/users/caranatar/gists{/gist_id}", "starred_url": "https://api.github.com/users/caranatar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/caranatar/subscriptions", "organizations_url": "https://api.github.com/users/caranatar/orgs", "repos_url": "https://api.github.com/users/caranatar/repos", "events_url": "https://api.github.com/users/caranatar/events{/privacy}", "received_events_url": "https://api.github.com/users/caranatar/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-08-24T05:11:57Z", "updated_at": "2020-08-24T10:15:41Z", "closed_at": "2020-08-24T10:15:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "I ran into a weird issue and I'm not sure if it's a compiler bug, a rustdoc bug, or neither. I took over a crate which has a public struct (`Rule`), inside a non-public module, which does not get exported. That type gets used in the return type of a public function (`get_rule`) in an exported public type (`Grammar`), [docs.rs here](https://docs.rs/tracery/0.1.3/tracery/struct.Grammar.html#method.get_rule). I created what I think is a minimal reproduction of the issue\r\n\r\n[playground link here](https://play.rust-lang.org/?version=nightly&mode=debug&edition=2018)\r\n```rust\r\npub mod c {\r\n    mod a {\r\n        pub struct Foo;\r\n    }\r\n\r\n    mod b {\r\n        use crate::c::a::Foo;\r\n        pub fn bar() -> Foo {\r\n            Foo {}\r\n        }\r\n    }\r\n\r\n    pub use b::bar;\r\n}\r\n\r\nfn main() {\r\n    let foo = c::bar();\r\n    // fails as expected:\r\n    //let foo = c::a::Foo {};\r\n}\r\n```\r\n\r\nI would expect this to be flagged as leaking a private type in a public function, but it isn't on stable or nightly. And if it shouldn't be flagged, then I'd expect rustdoc to generate documentation for the type, but as you can see in the docs.rs link above, it doesn't. Is one of them doing the wrong thing?", "closed_by": {"login": "jonas-schievink", "id": 1786438, "node_id": "MDQ6VXNlcjE3ODY0Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/1786438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jonas-schievink", "html_url": "https://github.com/jonas-schievink", "followers_url": "https://api.github.com/users/jonas-schievink/followers", "following_url": "https://api.github.com/users/jonas-schievink/following{/other_user}", "gists_url": "https://api.github.com/users/jonas-schievink/gists{/gist_id}", "starred_url": "https://api.github.com/users/jonas-schievink/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jonas-schievink/subscriptions", "organizations_url": "https://api.github.com/users/jonas-schievink/orgs", "repos_url": "https://api.github.com/users/jonas-schievink/repos", "events_url": "https://api.github.com/users/jonas-schievink/events{/privacy}", "received_events_url": "https://api.github.com/users/jonas-schievink/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/75868/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/75868/timeline", "performed_via_github_app": null, "state_reason": "completed"}