{"url": "https://api.github.com/repos/rust-lang/rust/issues/104707", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/104707/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/104707/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/104707/events", "html_url": "https://github.com/rust-lang/rust/issues/104707", "id": 1459553779, "node_id": "I_kwDOAAsO6M5W_wXz", "number": 104707, "title": "Don't leak non-exported symbols from staticlibs", "user": {"login": "bjorn3", "id": 17426603, "node_id": "MDQ6VXNlcjE3NDI2NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/17426603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bjorn3", "html_url": "https://github.com/bjorn3", "followers_url": "https://api.github.com/users/bjorn3/followers", "following_url": "https://api.github.com/users/bjorn3/following{/other_user}", "gists_url": "https://api.github.com/users/bjorn3/gists{/gist_id}", "starred_url": "https://api.github.com/users/bjorn3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bjorn3/subscriptions", "organizations_url": "https://api.github.com/users/bjorn3/orgs", "repos_url": "https://api.github.com/users/bjorn3/repos", "events_url": "https://api.github.com/users/bjorn3/events{/privacy}", "received_events_url": "https://api.github.com/users/bjorn3/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 37547, "node_id": "MDU6TGFiZWwzNzU0Nw==", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-linkage", "name": "A-linkage", "color": "f7e101", "default": false, "description": "Area: linking into static, shared libraries and binaries"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 33, "created_at": "2022-11-22T10:13:02Z", "updated_at": "2023-02-15T20:06:13Z", "closed_at": null, "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "When compiling a cdylib only `#[no_mangle]` symbols are exported. `#[rustc_std_internal_symbol]` and mangled symbols are not exported. This prevents symbol conflicts and avoids overriding symbols in ways that causes UB when using a rust cdylib in a rust program. For staticlibs however all symbols leak out of the staticlib. Causing symbol overrides that are potentially UB and symbols conflicts. For example when statically linking spidermonkey, you will get symbol conflicts if the rust version you compile your program with doesn't match the one the rust parts of spidermonkey were compiled with.\r\n\r\ncc https://github.com/rust-lang/wg-allocators/issues/108#issuecomment-1323397329\r\ncc https://bytecodealliance.zulipchat.com/#narrow/stream/206238-general/topic/.E2.9C.94.20spidermonkey-wasm-rs/near/309604553", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/104707/reactions", "total_count": 4, "+1": 3, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 1, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/104707/timeline", "performed_via_github_app": null, "state_reason": null}