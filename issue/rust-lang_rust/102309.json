{"url": "https://api.github.com/repos/rust-lang/rust/issues/102309", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/102309/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/102309/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/102309/events", "html_url": "https://github.com/rust-lang/rust/issues/102309", "id": 1386000924, "node_id": "I_kwDOAAsO6M5SnLIc", "number": 102309, "title": "Building Rust software for use in an MSYS2 environment?", "user": {"login": "LunarLambda", "id": 38919842, "node_id": "MDQ6VXNlcjM4OTE5ODQy", "avatar_url": "https://avatars.githubusercontent.com/u/38919842?v=4", "gravatar_id": "", "url": "https://api.github.com/users/LunarLambda", "html_url": "https://github.com/LunarLambda", "followers_url": "https://api.github.com/users/LunarLambda/followers", "following_url": "https://api.github.com/users/LunarLambda/following{/other_user}", "gists_url": "https://api.github.com/users/LunarLambda/gists{/gist_id}", "starred_url": "https://api.github.com/users/LunarLambda/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/LunarLambda/subscriptions", "organizations_url": "https://api.github.com/users/LunarLambda/orgs", "repos_url": "https://api.github.com/users/LunarLambda/repos", "events_url": "https://api.github.com/users/LunarLambda/events{/privacy}", "received_events_url": "https://api.github.com/users/LunarLambda/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 123109, "node_id": "MDU6TGFiZWwxMjMxMDk=", "url": "https://api.github.com/repos/rust-lang/rust/labels/O-windows", "name": "O-windows", "color": "6e6ec0", "default": false, "description": "Operating system: Windows"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2022-09-26T12:31:55Z", "updated_at": "2023-03-21T17:55:39Z", "closed_at": null, "author_association": "NONE", "active_lock_reason": null, "body": "tl;dr: Is it possible, and if not, how much work would be necessary, to compile Rust programs for MSYS2's emulated POSIX environment (i.e. programs that link against `msys-2.0.dll`)?\r\n\r\nMSYS2 is not merely useful as a build environment for cross-compiling on Windows, but also as a portable development environment and alternative to WSL.\r\n\r\nSo, it would be quite useful to compile some unix-y Rust tools for that environment. I've gotten some crates like bat, ripgrep, and fd-find to work, by building for `x86_64-pc-windows-gnu`, and letting MSYS2's automatic command line path conversion do its magic, but some, especially those dealing with file metadata, terminals, or IPC, don't interoperate very well, since they only talk to the Windows APIs, not the 'emulated' POSIX APIs.\r\n\r\nFor example, currently, `exa` doesn't build for Windows at all, since it expects some \"POSIX-ly\" libc extensions.\r\n\r\nAs my understanding is, at minimum, a custom target would be needed, similar to `x86_64-pc-windows-gnu`, but with `target_family = \"unix\"`, and which uses the MSYS2-native GCC toolchain, and links against the MSYS2 runtime libraries.\r\n\r\nI don't believe this would require building Rust *itself* for MSYS2, the regular, windows-native rustc and cargo should be fine there, however, it would require building `std` et al. for MSYS2.\r\n\r\nI haven't experimented with writing my own targets before, so I'd appreciate any advice and directions, as well as hearing if the Rust team is interested in or already looking into supporting MSYS2 as a target \"platform\".\r\n\r\nI understand it's a niche use case, but given MSYS2's value as both a build and development environment on Windows platforms, and its relative portability compared to things like WSL or other forms of virtualization, I believe it could be useful for many people besides myself.", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/102309/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/102309/timeline", "performed_via_github_app": null, "state_reason": null}