{"url": "https://api.github.com/repos/rust-lang/rust/issues/11875", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/11875/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/11875/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/11875/events", "html_url": "https://github.com/rust-lang/rust/issues/11875", "id": 26438945, "node_id": "MDU6SXNzdWUyNjQzODk0NQ==", "number": 11875, "title": "port from ~[T] to Vec<T>", "user": {"login": "thestinger", "id": 1505226, "node_id": "MDQ6VXNlcjE1MDUyMjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thestinger", "html_url": "https://github.com/thestinger", "followers_url": "https://api.github.com/users/thestinger/followers", "following_url": "https://api.github.com/users/thestinger/following{/other_user}", "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}", "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions", "organizations_url": "https://api.github.com/users/thestinger/orgs", "repos_url": "https://api.github.com/users/thestinger/repos", "events_url": "https://api.github.com/users/thestinger/events{/privacy}", "received_events_url": "https://api.github.com/users/thestinger/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 113376, "node_id": "MDU6TGFiZWwxMTMzNzY=", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-slow", "name": "I-slow", "color": "e10c02", "default": false, "description": "Problems and improvements with respect to performance of generated code."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2014-01-28T13:34:25Z", "updated_at": "2014-09-08T02:47:26Z", "closed_at": "2014-09-08T02:47:26Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Annoying issues, but not hard blockers:\n- [ ] [split Index into Index, IndexMut and IndexAssign](https://github.com/mozilla/rust/issues/6515)\n- [ ] [make Vec<T> implement the slice methods](https://github.com/mozilla/rust/issues/11876)\n- [x] [Constructing an iterator from a slice doesn't optimise completely](https://github.com/mozilla/rust/issues/11751)\n\nThis is a significant performance improvement for any vectors that are grown, and will reduce heap allocation since zero-length vectors do not allocate and it does not have a header.\n\n```\ntest bench::old_push              ... bench:     43200 ns/iter (+/- 804)\ntest bench::old_push_preallocated ... bench:     42948 ns/iter (+/- 4043)\ntest bench::push                  ... bench:      7190 ns/iter (+/- 245)\ntest bench::push_preallocated     ... bench:      6606 ns/iter (+/- 170)\n```\n\n``` rust\n#[cfg(test)]\nextern mod extra;\n\n#[cfg(test)]\nmod bench {\n    use std;\n    use std::vec_ng::Vec;\n    use extra::test::BenchHarness;\n\n    static size: uint = 10000;\n\n    #[bench]\n    fn push(bh: &mut BenchHarness) {\n        bh.iter(|| {\n            let mut xs = Vec::with_capacity(16);\n            for i in range(0, size) {\n                xs.push(i);\n            }\n        });\n    }\n\n    #[bench]\n    fn old_push(bh: &mut BenchHarness) {\n        bh.iter(|| {\n            let mut xs = std::vec::with_capacity(16);\n            for i in range(0, size) {\n                xs.push(i);\n            }\n        });\n    }\n\n    #[bench]\n    fn push_preallocated(bh: &mut BenchHarness) {\n        bh.iter(|| {\n            let mut xs = Vec::with_capacity(size);\n            for i in range(0, size) {\n                xs.push(i);\n            }\n        });\n    }\n\n    #[bench]\n    fn old_push_preallocated(bh: &mut BenchHarness) {\n        bh.iter(|| {\n            let mut xs = std::vec::with_capacity(size);\n            for i in range(0, size) {\n                xs.push(i);\n            }\n        });\n    }\n}\n```\n\nI moved the priority tag here from the old issue, as this is the same core issue but without the distractions of past issues and discussions that are no longer relevant.\n", "closed_by": {"login": "thestinger", "id": 1505226, "node_id": "MDQ6VXNlcjE1MDUyMjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thestinger", "html_url": "https://github.com/thestinger", "followers_url": "https://api.github.com/users/thestinger/followers", "following_url": "https://api.github.com/users/thestinger/following{/other_user}", "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}", "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions", "organizations_url": "https://api.github.com/users/thestinger/orgs", "repos_url": "https://api.github.com/users/thestinger/repos", "events_url": "https://api.github.com/users/thestinger/events{/privacy}", "received_events_url": "https://api.github.com/users/thestinger/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/11875/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/11875/timeline", "performed_via_github_app": null, "state_reason": "completed"}