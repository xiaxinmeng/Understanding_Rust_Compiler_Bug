{"url": "https://api.github.com/repos/rust-lang/rust/issues/90694", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/90694/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/90694/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/90694/events", "html_url": "https://github.com/rust-lang/rust/issues/90694", "id": 1047497015, "node_id": "I_kwDOAAsO6M4-b4k3", "number": 90694, "title": "Problem while building rust", "user": {"login": "InfRandomness", "id": 43730933, "node_id": "MDQ6VXNlcjQzNzMwOTMz", "avatar_url": "https://avatars.githubusercontent.com/u/43730933?v=4", "gravatar_id": "", "url": "https://api.github.com/users/InfRandomness", "html_url": "https://github.com/InfRandomness", "followers_url": "https://api.github.com/users/InfRandomness/followers", "following_url": "https://api.github.com/users/InfRandomness/following{/other_user}", "gists_url": "https://api.github.com/users/InfRandomness/gists{/gist_id}", "starred_url": "https://api.github.com/users/InfRandomness/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/InfRandomness/subscriptions", "organizations_url": "https://api.github.com/users/InfRandomness/orgs", "repos_url": "https://api.github.com/users/InfRandomness/repos", "events_url": "https://api.github.com/users/InfRandomness/events{/privacy}", "received_events_url": "https://api.github.com/users/InfRandomness/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2021-11-08T14:09:19Z", "updated_at": "2021-11-14T14:59:19Z", "closed_at": "2021-11-14T14:59:19Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I'm having troubles building rust using the user preset from x.py\r\n\r\nIt seems like there's an issue with CMake and configuring LLVM\r\n\r\n```\r\nCopying stage0 std from stage0 (x86_64-unknown-linux-gnu -> x86_64-unknown-linux-gnu / x86_64-unknown-linux-gnu)\r\nBuilding LLVM for x86_64-unknown-linux-gnu\r\nrunning: \"cmake\" \"/home/infrandomness/src/rust/src/llvm-project/llvm\" \"-G\" \"Ninja\" \"-DLLVM_ENABLE_ASSERTIONS=OFF\" \"-DLLVM_ENABLE_PLUGINS=OFF\" \"-DLLVM_TARGETS_TO_BUILD=AArch64;ARM;BPF;Hexagon;MSP430;Mips;NVPTX;PowerPC;RISCV;Sparc;SystemZ;WebAssembly;X86\" \"-DLLVM_EXPERIMENTAL_TARGETS_TO_BUILD=AVR;M68k\" \"-DLLVM_INCLUDE_EXAMPLES=OFF\" \"-DLLVM_INCLUDE_DOCS=OFF\" \"-DLLVM_INCLUDE_BENCHMARKS=OFF\" \"-DLLVM_INCLUDE_TESTS=OFF\" \"-DLLVM_ENABLE_TERMINFO=OFF\" \"-DLLVM_ENABLE_LIBEDIT=OFF\" \"-DLLVM_ENABLE_BINDINGS=OFF\" \"-DLLVM_ENABLE_Z3_SOLVER=OFF\" \"-DLLVM_PARALLEL_COMPILE_JOBS=8\" \"-DLLVM_TARGET_ARCH=x86_64\" \"-DLLVM_DEFAULT_TARGET_TRIPLE=x86_64-unknown-linux-gnu\" \"-DLLVM_INSTALL_UTILS=ON\" \"-DLLVM_ENABLE_ZLIB=ON\" \"-DLLVM_ENABLE_LIBXML2=OFF\" \"-DLLVM_VERSION_SUFFIX=-rust-dev\" \"-DCMAKE_INSTALL_MESSAGE=LAZY\" \"-DCMAKE_C_COMPILER=cc\" \"-DCMAKE_CXX_COMPILER=c++\" \"-DCMAKE_ASM_COMPILER=cc\" \"-DCMAKE_C_FLAGS=-ffunction-sections -fdata-sections -fPIC -m64\" \"-DCMAKE_CXX_FLAGS=-ffunction-sections -fdata-sections -fPIC -m64\" \"-DCMAKE_INSTALL_PREFIX=/home/infrandomness/src/rust/build/x86_64-unknown-linux-gnu/llvm\" \"-DCMAKE_ASM_FLAGS= -ffunction-sections -fdata-sections -fPIC -m64\" \"-DCMAKE_BUILD_TYPE=Release\"\r\n-- The C compiler identification is GNU 10.3.0\r\n-- The CXX compiler identification is Clang 13.0.1\r\n-- The ASM compiler identification is GNU\r\n-- Found assembler: /usr/bin/cc\r\n-- Detecting C compiler ABI info\r\n-- Detecting C compiler ABI info - done\r\n-- Check for working C compiler: /usr/bin/cc - skipped\r\n-- Detecting C compile features\r\n-- Detecting C compile features - done\r\n-- Detecting CXX compiler ABI info\r\n-- Detecting CXX compiler ABI info - done\r\n-- Check for working CXX compiler: /usr/bin/c++ - skipped\r\n-- Detecting CXX compile features\r\n-- Detecting CXX compile features - done\r\n-- Performing Test LLVM_LIBSTDCXX_MIN\r\n-- Performing Test LLVM_LIBSTDCXX_MIN - Success\r\n-- Performing Test LLVM_LIBSTDCXX_SOFT_ERROR\r\n-- Performing Test LLVM_LIBSTDCXX_SOFT_ERROR - Success\r\n-- Looking for dlfcn.h\r\n-- Looking for dlfcn.h - found\r\n-- Looking for errno.h\r\n-- Looking for errno.h - found\r\n-- Looking for fcntl.h\r\n-- Looking for fcntl.h - found\r\n-- Looking for link.h\r\n-- Looking for link.h - found\r\n-- Looking for malloc/malloc.h\r\n-- Looking for malloc/malloc.h - not found\r\n-- Looking for pthread.h\r\n-- Looking for pthread.h - found\r\n-- Looking for signal.h\r\n-- Looking for signal.h - found\r\n-- Looking for sys/ioctl.h\r\n-- Looking for sys/ioctl.h - found\r\n-- Looking for sys/mman.h\r\n-- Looking for sys/mman.h - found\r\n-- Looking for sys/param.h\r\n-- Looking for sys/param.h - found\r\n-- Looking for sys/resource.h\r\n-- Looking for sys/resource.h - found\r\n-- Looking for sys/stat.h\r\n-- Looking for sys/stat.h - found\r\n-- Looking for sys/time.h\r\n-- Looking for sys/time.h - found\r\n-- Looking for sys/types.h\r\n-- Looking for sys/types.h - found\r\n-- Looking for sysexits.h\r\n-- Looking for sysexits.h - found\r\n-- Looking for termios.h\r\n-- Looking for termios.h - found\r\n-- Looking for unistd.h\r\n-- Looking for unistd.h - found\r\n-- Looking for valgrind/valgrind.h\r\n-- Looking for valgrind/valgrind.h - not found\r\n-- Looking for fenv.h\r\n-- Looking for fenv.h - found\r\n-- Looking for FE_ALL_EXCEPT\r\n-- Looking for FE_ALL_EXCEPT - found\r\n-- Looking for FE_INEXACT\r\n-- Looking for FE_INEXACT - found\r\n-- Looking for mach/mach.h\r\n-- Looking for mach/mach.h - not found\r\n-- Looking for histedit.h\r\n-- Looking for histedit.h - not found\r\n-- Looking for CrashReporterClient.h\r\n-- Looking for CrashReporterClient.h - not found\r\n-- Looking for linux/magic.h\r\n-- Looking for linux/magic.h - found\r\n-- Looking for pthread_create in pthread\r\n-- Looking for pthread_create in pthread - found\r\n-- Looking for pthread_getspecific in pthread\r\n-- Looking for pthread_getspecific in pthread - found\r\n-- Looking for pthread_rwlock_init in pthread\r\n-- Looking for pthread_rwlock_init in pthread - found\r\n-- Looking for pthread_mutex_lock in pthread\r\n-- Looking for pthread_mutex_lock in pthread - found\r\n-- Looking for dlopen in dl\r\n-- Looking for dlopen in dl - found\r\n-- Looking for clock_gettime in rt\r\n-- Looking for clock_gettime in rt - found\r\n-- Looking for pfm_initialize in pfm\r\n-- Looking for pfm_initialize in pfm - not found\r\n-- Looking for pthread.h\r\n-- Looking for pthread.h - found\r\n-- Performing Test CMAKE_HAVE_LIBC_PTHREAD\r\n-- Performing Test CMAKE_HAVE_LIBC_PTHREAD - Failed\r\n-- Looking for pthread_create in pthreads\r\n-- Looking for pthread_create in pthreads - not found\r\n-- Looking for pthread_create in pthread\r\n-- Looking for pthread_create in pthread - found\r\n-- Found Threads: TRUE\r\n-- Found ZLIB: /usr/lib/x86_64-linux-gnu/libz.so (found version \"1.2.11\")\r\n-- Looking for compress2\r\n-- Looking for compress2 - found\r\n-- Looking for xar_open in xar\r\n-- Looking for xar_open in xar - not found\r\n-- Looking for arc4random\r\n-- Looking for arc4random - not found\r\n-- Looking for backtrace\r\n-- Looking for backtrace - found\r\n-- backtrace facility detected in default set of libraries\r\n-- Found Backtrace: /usr/include\r\n-- Performing Test C_SUPPORTS_WERROR_UNGUARDED_AVAILABILITY_NEW\r\n-- Performing Test C_SUPPORTS_WERROR_UNGUARDED_AVAILABILITY_NEW - Failed\r\n-- Looking for __register_frame\r\n-- Looking for __register_frame - found\r\n-- Looking for __deregister_frame\r\n-- Looking for __deregister_frame - found\r\n-- Looking for _Unwind_Backtrace\r\n-- Looking for _Unwind_Backtrace - found\r\n-- Looking for getpagesize\r\n-- Looking for getpagesize - found\r\n-- Looking for sysconf\r\n-- Looking for sysconf - found\r\n-- Looking for getrusage\r\n-- Looking for getrusage - found\r\n-- Looking for setrlimit\r\n-- Looking for setrlimit - found\r\n-- Looking for isatty\r\n-- Looking for isatty - found\r\n-- Looking for futimens\r\n-- Looking for futimens - found\r\n-- Looking for futimes\r\n-- Looking for futimes - found\r\n-- Looking for posix_fallocate\r\n-- Looking for posix_fallocate - found\r\n-- Looking for sigaltstack\r\n-- Looking for sigaltstack - found\r\n-- Looking for lseek64\r\n-- Looking for lseek64 - found\r\n-- Looking for mallctl\r\n-- Looking for mallctl - not found\r\n-- Looking for mallinfo\r\n-- Looking for mallinfo - found\r\n-- Looking for mallinfo2\r\n-- Looking for mallinfo2 - found\r\n-- Looking for malloc_zone_statistics\r\n-- Looking for malloc_zone_statistics - not found\r\n-- Looking for getrlimit\r\n-- Looking for getrlimit - found\r\n-- Looking for posix_spawn\r\n-- Looking for posix_spawn - found\r\n-- Looking for pread\r\n-- Looking for pread - found\r\n-- Looking for sbrk\r\n-- Looking for sbrk - found\r\n-- Looking for strerror\r\n-- Looking for strerror - found\r\n-- Looking for strerror_r\r\n-- Looking for strerror_r - found\r\n-- Looking for strerror_s\r\n-- Looking for strerror_s - not found\r\n-- Looking for setenv\r\n-- Looking for setenv - found\r\n-- Looking for dlopen\r\n-- Looking for dlopen - found\r\n-- Looking for dladdr\r\n-- Looking for dladdr - not found\r\n-- Performing Test HAVE_STRUCT_STAT_ST_MTIMESPEC_TV_NSEC\r\n-- Performing Test HAVE_STRUCT_STAT_ST_MTIMESPEC_TV_NSEC - Failed\r\n-- Performing Test HAVE_STRUCT_STAT_ST_MTIM_TV_NSEC\r\n-- Performing Test HAVE_STRUCT_STAT_ST_MTIM_TV_NSEC - Success\r\n-- Looking for __GLIBC__\r\n-- Looking for __GLIBC__ - found\r\n-- Looking for pthread_getname_np\r\n-- Looking for pthread_getname_np - found\r\n-- Looking for pthread_setname_np\r\n-- Looking for pthread_setname_np - found\r\n-- Looking for proc_pid_rusage\r\n-- Looking for proc_pid_rusage - not found\r\n-- Performing Test HAVE_STD_IS_TRIVIALLY_COPYABLE\r\n-- Performing Test HAVE_STD_IS_TRIVIALLY_COPYABLE - Success\r\n-- Performing Test HAVE_CXX_ATOMICS_WITHOUT_LIB\r\n-- Performing Test HAVE_CXX_ATOMICS_WITHOUT_LIB - Success\r\n-- Performing Test HAVE_CXX_ATOMICS64_WITHOUT_LIB\r\n-- Performing Test HAVE_CXX_ATOMICS64_WITHOUT_LIB - Success\r\n-- Performing Test LLVM_HAS_ATOMICS\r\n-- Performing Test LLVM_HAS_ATOMICS - Success\r\n-- Performing Test SUPPORTS_VARIADIC_MACROS_FLAG\r\n-- Performing Test SUPPORTS_VARIADIC_MACROS_FLAG - Success\r\n-- Performing Test SUPPORTS_GNU_ZERO_VARIADIC_MACRO_ARGUMENTS_FLAG\r\n-- Performing Test SUPPORTS_GNU_ZERO_VARIADIC_MACRO_ARGUMENTS_FLAG - Success\r\n: not foundndomness/src/rust/src/llvm-project/llvm/cmake/config.guess: 6:\r\n: not foundndomness/src/rust/src/llvm-project/llvm/cmake/config.guess: 8:\r\n: not foundndomness/src/rust/src/llvm-project/llvm/cmake/config.guess: 28:\r\n: not foundndomness/src/rust/src/llvm-project/llvm/cmake/config.guess: 29:\r\n: not foundndomness/src/rust/src/llvm-project/llvm/cmake/config.guess: 40:\r\n: not foundndomness/src/rust/src/llvm-project/llvm/cmake/config.guess: 42:\r\n: not foundndomness/src/rust/src/llvm-project/llvm/cmake/config.guess: 54:\r\n: not foundndomness/src/rust/src/llvm-project/llvm/cmake/config.guess: 65:\r\n: not foundndomness/src/rust/src/llvm-project/llvm/cmake/config.guess: 68:\r\n/home/infrandomness/src/rust/src/llvm-project/llvm/cmake/config.guess: 71: Syntax error: word unexpected (expecting \"in\")\r\nCMake Error at cmake/modules/GetHostTriple.cmake:36 (message):\r\n  Failed to execute\r\n  /home/infrandomness/src/rust/src/llvm-project/llvm/cmake/config.guess\r\nCall Stack (most recent call first):\r\n  cmake/config-ix.cmake:411 (get_host_triple)\r\n  CMakeLists.txt:684 (include)\r\n\r\n\r\n-- Configuring incomplete, errors occurred!\r\nSee also \"/home/infrandomness/src/rust/build/x86_64-unknown-linux-gnu/llvm/build/CMakeFiles/CMakeOutput.log\".\r\nSee also \"/home/infrandomness/src/rust/build/x86_64-unknown-linux-gnu/llvm/build/CMakeFiles/CMakeError.log\".\r\nthread 'main' panicked at '\r\ncommand did not execute successfully, got: exit status: 1\r\n\r\nbuild script failed, must exit now', /home/infrandomness/.cargo/registry/src/github.com-1ecc6299db9ec823/cmake-0.1.44/src/lib.rs:885:5\r\nnote: run with `RUST_BACKTRACE=1` environment variable to display a backtrace\r\n        finished in 8.460 seconds\r\n```\r\n\r\nThis issue is ocurring on ubuntu 21.04 WSL", "closed_by": {"login": "InfRandomness", "id": 43730933, "node_id": "MDQ6VXNlcjQzNzMwOTMz", "avatar_url": "https://avatars.githubusercontent.com/u/43730933?v=4", "gravatar_id": "", "url": "https://api.github.com/users/InfRandomness", "html_url": "https://github.com/InfRandomness", "followers_url": "https://api.github.com/users/InfRandomness/followers", "following_url": "https://api.github.com/users/InfRandomness/following{/other_user}", "gists_url": "https://api.github.com/users/InfRandomness/gists{/gist_id}", "starred_url": "https://api.github.com/users/InfRandomness/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/InfRandomness/subscriptions", "organizations_url": "https://api.github.com/users/InfRandomness/orgs", "repos_url": "https://api.github.com/users/InfRandomness/repos", "events_url": "https://api.github.com/users/InfRandomness/events{/privacy}", "received_events_url": "https://api.github.com/users/InfRandomness/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/90694/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/90694/timeline", "performed_via_github_app": null, "state_reason": "completed"}