{"url": "https://api.github.com/repos/rust-lang/rust/issues/36936", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/36936/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/36936/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/36936/events", "html_url": "https://github.com/rust-lang/rust/issues/36936", "id": 180706052, "node_id": "MDU6SXNzdWUxODA3MDYwNTI=", "number": 36936, "title": "Corrupted memory after updated to 1.12", "user": {"login": "paulusx", "id": 1738000, "node_id": "MDQ6VXNlcjE3MzgwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/1738000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/paulusx", "html_url": "https://github.com/paulusx", "followers_url": "https://api.github.com/users/paulusx/followers", "following_url": "https://api.github.com/users/paulusx/following{/other_user}", "gists_url": "https://api.github.com/users/paulusx/gists{/gist_id}", "starred_url": "https://api.github.com/users/paulusx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/paulusx/subscriptions", "organizations_url": "https://api.github.com/users/paulusx/orgs", "repos_url": "https://api.github.com/users/paulusx/repos", "events_url": "https://api.github.com/users/paulusx/events{/privacy}", "received_events_url": "https://api.github.com/users/paulusx/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 262252840, "node_id": "MDU6TGFiZWwyNjIyNTI4NDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/regression-from-stable-to-stable", "name": "regression-from-stable-to-stable", "color": "e4008a", "default": false, "description": "Performance or correctness regression from one stable version to another."}], "state": "closed", "locked": false, "assignee": {"login": "arielb1", "id": 1830974, "node_id": "MDQ6VXNlcjE4MzA5NzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1830974?v=4", "gravatar_id": "", "url": "https://api.github.com/users/arielb1", "html_url": "https://github.com/arielb1", "followers_url": "https://api.github.com/users/arielb1/followers", "following_url": "https://api.github.com/users/arielb1/following{/other_user}", "gists_url": "https://api.github.com/users/arielb1/gists{/gist_id}", "starred_url": "https://api.github.com/users/arielb1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/arielb1/subscriptions", "organizations_url": "https://api.github.com/users/arielb1/orgs", "repos_url": "https://api.github.com/users/arielb1/repos", "events_url": "https://api.github.com/users/arielb1/events{/privacy}", "received_events_url": "https://api.github.com/users/arielb1/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "arielb1", "id": 1830974, "node_id": "MDQ6VXNlcjE4MzA5NzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1830974?v=4", "gravatar_id": "", "url": "https://api.github.com/users/arielb1", "html_url": "https://github.com/arielb1", "followers_url": "https://api.github.com/users/arielb1/followers", "following_url": "https://api.github.com/users/arielb1/following{/other_user}", "gists_url": "https://api.github.com/users/arielb1/gists{/gist_id}", "starred_url": "https://api.github.com/users/arielb1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/arielb1/subscriptions", "organizations_url": "https://api.github.com/users/arielb1/orgs", "repos_url": "https://api.github.com/users/arielb1/repos", "events_url": "https://api.github.com/users/arielb1/events{/privacy}", "received_events_url": "https://api.github.com/users/arielb1/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2016-10-03T18:04:52Z", "updated_at": "2016-10-05T06:13:14Z", "closed_at": "2016-10-05T06:13:14Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello! \nI see some garbage in memory:\n\n``` rust\n    use super::yaml_rust::{YamlLoader, Yaml};\n    use std::collections::HashMap;\n\n    #[test]\n    fn test_yaml() {\n        let test_data = r#\"\nProperty1:\n  data: Value1\n\nProperty2:\n  data: Value2\n\nProperty3:\n  data: Value3\n\n\"#;\n        let mut check_data = HashMap::new();\n        check_data.insert(\"Property1\",\"Value1\");\n        check_data.insert(\"Property2\",\"Value2\");\n        check_data.insert(\"Property3\",\"Value3\");\n\n        let scheme = &(YamlLoader::load_from_str(test_data).unwrap() as Vec<Yaml>)[0];\n        for (key, value) in {\n            if let Yaml::Hash(ref x) = *scheme {\n                x // if write here \"x.clone()\", OK\n            } else {\n                panic!(\"Bad format\")\n            }\n        } {\n\n            println!(\"{:?}: {:?};\", key, value);\n            if check_data[key.as_str().unwrap()] != value[\"data\"].as_str().unwrap() {\n                panic!(\"\\nkey: {:?} ,data: {:?} \u2260 {:?}\\n\",\n                       key.as_str().unwrap(),\n                       check_data[key.as_str().unwrap()],\n                       value[\"data\"].as_str().unwrap()\n                );\n\n            }\n        }\n    }\n```\n\nI expect correct return (like with rust 1.11), but I have panic: \n## Rust 1.12\n\n```\n$ rustup run stable cargo test test_yaml\n   Compiling yaml-rust v0.3.3 (https://github.com/chyh1990/yaml-rust.git#f7d2897b)\n   Compiling \u2026\n    Finished debug [unoptimized + debuginfo] target(s) in 6.13 secs\n     Running target/debug/\u2026\n\nrunning 1 test\ntest test_yaml ... FAILED\n\nfailures:\n\n---- test_yaml stdout ----\n        String(\"Property1\"): Hash({String(\"data\"): String(\"Value1\")});\nString(\"Property2\"): Hash({String(\"data\"): String(\"Value2\")});\nString(\"String(\\\"3\"): Hash({String(\"data\"): String(\"datang\")});\nthread 'test_yaml' panicked at 'no entry found for key', ../src/libcore/option.rs:700\nnote: Run with `RUST_BACKTRACE=1` for a backtrace.\n\nfailures:\n    scheme::test::test_yaml\n\ntest result: FAILED. 0 passed; 1 failed; 0 ignored; 0 measured\n\nerror: test failed\n```\n## Rust 1.11\n\n```\n$ rustup run 1.11.0 cargo test test_yaml\n   Compiling yaml-rust v0.3.3 (https://github.com/chyh1990/yaml-rust.git#f7d2897b)\n   Compiling \u2026\n     Running target/debug/\u2026\n\nrunning 1 test\ntest test_yaml ... ok\n\ntest result: ok. 1 passed; 0 failed; 0 ignored; 0 measured\n\n```\n\n_Data corrupted always in last record._ \nThanks!\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/36936/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/36936/timeline", "performed_via_github_app": null, "state_reason": "completed"}