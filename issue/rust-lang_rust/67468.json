{"url": "https://api.github.com/repos/rust-lang/rust/issues/67468", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/67468/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/67468/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/67468/events", "html_url": "https://github.com/rust-lang/rust/issues/67468", "id": 541247861, "node_id": "MDU6SXNzdWU1NDEyNDc4NjE=", "number": 67468, "title": "Importing 'arrayvec' into a module of a project breaks specific rust code from compiling", "user": {"login": "Veykril", "id": 3757771, "node_id": "MDQ6VXNlcjM3NTc3NzE=", "avatar_url": "https://avatars.githubusercontent.com/u/3757771?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Veykril", "html_url": "https://github.com/Veykril", "followers_url": "https://api.github.com/users/Veykril/followers", "following_url": "https://api.github.com/users/Veykril/following{/other_user}", "gists_url": "https://api.github.com/users/Veykril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Veykril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Veykril/subscriptions", "organizations_url": "https://api.github.com/users/Veykril/orgs", "repos_url": "https://api.github.com/users/Veykril/repos", "events_url": "https://api.github.com/users/Veykril/events{/privacy}", "received_events_url": "https://api.github.com/users/Veykril/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 211668062, "node_id": "MDU6TGFiZWwyMTE2NjgwNjI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-libs-api", "name": "T-libs-api", "color": "bfd4f2", "default": false, "description": "Relevant to the library API team, which will review and decide on the PR/issue."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-12-20T23:49:06Z", "updated_at": "2019-12-21T16:17:51Z", "closed_at": "2019-12-21T16:17:50Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "A friend and I just discovered a weird behaviour in a project when just using arrayvec via a use statement. It compiles fine unless we explicitly use an item of `arrayvec` via a use statement. These items don't have to be used for this bug to occur, only the import matters in any single module in the project to prevent the compilation(this import can even be in a different module than the `>` check).\r\n\r\nA short example program: [playground](https://play.rust-lang.org/?version=stable&mode=debug&edition=2018&gist=8f5911f2b7dd953964b17cc9a05b3faa)\r\n```rust\r\n// uncomment this unused import to break compilation\r\n//use arrayvec; // 0.5.1\r\n\r\nfn main() {\r\n    let foo = \"foo\";\r\n    let bar = &std::borrow::Cow::Owned(String::new());\r\n    let _ = foo < bar;\r\n}\r\n```\r\n\r\nThis breaks on both current stable and current nightly with the message\r\n```\r\nerror[E0277]: can't compare `str` with `std::borrow::Cow<'_, str>`\r\n --> src/main.rs:7:17\r\n  |\r\n7 |     let _ = foo < bar;\r\n  |                 ^ no implementation for `str < std::borrow::Cow<'_, str>` and `str > std::borrow::Cow<'_, str>`\r\n  |\r\n  = help: the trait `std::cmp::PartialOrd<std::borrow::Cow<'_, str>>` is not implemented for `str`\r\n  = note: required because of the requirements on the impl of `std::cmp::PartialOrd<&std::borrow::Cow<'_, str>>` for `&str`\r\n```\r\nI assume that something in arrayvec seems to prevent the compiler from being able to deref `&Cow` into a `&str` given that `Cow<'_. str>` does not implement `PartialOrd` for comparing with a `str` slice directly.", "closed_by": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/67468/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/67468/timeline", "performed_via_github_app": null, "state_reason": "completed"}