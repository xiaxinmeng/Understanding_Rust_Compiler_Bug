{"url": "https://api.github.com/repos/rust-lang/rust/issues/15149", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/15149/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/15149/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/15149/events", "html_url": "https://github.com/rust-lang/rust/issues/15149", "id": 36416174, "node_id": "MDU6SXNzdWUzNjQxNjE3NA==", "number": 15149, "title": "Process spawning via PATH is different on unix than it is on windows", "user": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 123109, "node_id": "MDU6TGFiZWwxMjMxMDk=", "url": "https://api.github.com/repos/rust-lang/rust/labels/O-windows", "name": "O-windows", "color": "6e6ec0", "default": false, "description": "Operating system: Windows"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2014-06-24T19:14:47Z", "updated_at": "2014-08-12T05:06:21Z", "closed_at": "2014-08-12T05:06:21Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Due to the separate `fork` + `exec` steps on unix, the following test case passes on unix. On windows, however, the \"atomic\" `fork` + `exec` causes the test to fail.\n\nNotably, on unix the _child's_ `PATH` environment variable is used to lookup the program to execute, whereas on windows it uses the _parent's_ `PATH` variable.\n\n``` rust\nuse std::os;\nuse std::io::{File, TempDir, Command, util, UserRWX, fs};\n\nfn main() {\n    let args = os::args();\n    if args.len() > 1 && args.get(1).as_slice() == \"child\" {\n        return assert_eq!(args.get(0).as_slice(), \"mytest\");\n    }\n\n    let dir = TempDir::new(\"mytest\").unwrap();\n    let me = os::self_exe_name().unwrap();\n    let dest = dir.path().join(\"mytest\");\n    util::copy(&mut File::open(&me), &mut File::create(&dest)).unwrap();\n    fs::chmod(&dest, UserRWX).unwrap();\n\n    Command::new(\"mytest\").env(&[(\"PATH\".to_string(),\n                                  dir.path().as_str().unwrap().to_string())])\n                          .arg(\"child\")\n                          .spawn().unwrap();\n}\n```\n\nThe behavior of the two platforms needs to be consistent, and I believe that the unix behavior is what one would expect.\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/15149/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/15149/timeline", "performed_via_github_app": null, "state_reason": "completed"}