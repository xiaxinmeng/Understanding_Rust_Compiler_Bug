{"url": "https://api.github.com/repos/rust-lang/rust/issues/5679", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/5679/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/5679/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/5679/events", "html_url": "https://github.com/rust-lang/rust/issues/5679", "id": 12724658, "node_id": "MDU6SXNzdWUxMjcyNDY1OA==", "number": 5679, "title": "Rustpkg should operate on a URL-like pkgid", "user": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 234876, "node_id": "MDU6TGFiZWwyMzQ4NzY=", "url": "https://api.github.com/repos/rust-lang/rust/labels/E-hard", "name": "E-hard", "color": "02e10c", "default": false, "description": "Call for participation: Experience needed to fix: Hard / a lot"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/rust-lang/rust/milestones/10", "html_url": "https://github.com/rust-lang/rust/milestone/10", "labels_url": "https://api.github.com/repos/rust-lang/rust/milestones/10/labels", "id": 234060, "node_id": "MDk6TWlsZXN0b25lMjM0MDYw", "number": 10, "title": "0.7", "description": "", "creator": {"login": "catamorphism", "id": 427212, "node_id": "MDQ6VXNlcjQyNzIxMg==", "avatar_url": "https://avatars.githubusercontent.com/u/427212?v=4", "gravatar_id": "", "url": "https://api.github.com/users/catamorphism", "html_url": "https://github.com/catamorphism", "followers_url": "https://api.github.com/users/catamorphism/followers", "following_url": "https://api.github.com/users/catamorphism/following{/other_user}", "gists_url": "https://api.github.com/users/catamorphism/gists{/gist_id}", "starred_url": "https://api.github.com/users/catamorphism/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/catamorphism/subscriptions", "organizations_url": "https://api.github.com/users/catamorphism/orgs", "repos_url": "https://api.github.com/users/catamorphism/repos", "events_url": "https://api.github.com/users/catamorphism/events{/privacy}", "received_events_url": "https://api.github.com/users/catamorphism/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 110, "state": "closed", "created_at": "2012-12-22T22:31:59Z", "updated_at": "2013-07-04T01:21:16Z", "due_on": "2013-06-30T07:00:00Z", "closed_at": "2013-07-04T01:21:16Z"}, "comments": 2, "created_at": "2013-04-02T20:47:19Z", "updated_at": "2014-06-16T21:56:22Z", "closed_at": "2013-05-15T21:34:55Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Sub-bug of #5677 \n\nRustpkg and the rust driver currently have several kinds of identifier for packages and crates: the `name`, `url` and `uuid` fields in `#[link]` and `extern mod` as well as the putative `id` of a rustpkg (which is being sketched-out as a reverse-DNS-dot-path the way java packages were named). These are terribly confusing and lead people to randomly cargo-culting variants of redundant sub-naming schemes, few of which are meaningful.\n\nWe want to consolidate these as much as possible, and will be following the design of the [Go package-naming system](http://golang.org/doc/code.html), though with a slight simplification in that our packages aren't \"self identifying\" -- there's no `package foo;` declaration in each file, for example -- so don't have a separate (default) name aside from their pkgid stem (\"import path\" stem, in Go-ese). Those can vary in Go but there doesn't seem to be much point to allowing it for us. They exist in Go to disambiguate exported symbols at the linkage level, but our linkage model encodes the metadata-hash (likely, eventually, just a hash of the pkgid) in each symbol, so we're solving this a different (and hopefully less confusing, more robust) way. If you absolutely need to vary the module-local name a crate is bound under when you `extern mod` it, you'll be able to; the default will be automatically derived from the pkgid stem. I.e. `extern mod \"github.com/graydon/foo\";` will produce a local binding `foo`, and you'll have to write `extern mod bar = \"github.com/graydon/foo\";` to get a different local name.\n\nAn example structure for holding a path is here:\n\nhttps://github.com/graydon/rust/blob/rustpkg/src/librustpkg/rustpkg.rc#L1046\n\nThe main points to ensure are these:\n- A pkgid must be relative-path-like so that it has a natural mapping to both URL-space and filesystem-space\n- A pkgid must have a stem which is a single-identifier component, the final component of the path\n- The pkgid is _never written down_ anywhere inside a file stored in the package itself. Packages are named _from the outside_, by the user who is operating rustpkg (i.e. from argv or by scanning RUST_PATH) or some version control tool's repo URLs. A file in a directory doesn't repeat the name of the directory holding it. The same notion holds here.\n\nCrate names should be deduced from the directory containing them, rather than a `#[link]` attribute inside the crate file. This should work whether a package has one or many crates within it: the immediate containing dir provides the short identifier-name for the crate, and this just _happens to be_ the stem of the pkgid if there is only a single crate in the package (and the crate root is found in the package root).\n", "closed_by": {"login": "catamorphism", "id": 427212, "node_id": "MDQ6VXNlcjQyNzIxMg==", "avatar_url": "https://avatars.githubusercontent.com/u/427212?v=4", "gravatar_id": "", "url": "https://api.github.com/users/catamorphism", "html_url": "https://github.com/catamorphism", "followers_url": "https://api.github.com/users/catamorphism/followers", "following_url": "https://api.github.com/users/catamorphism/following{/other_user}", "gists_url": "https://api.github.com/users/catamorphism/gists{/gist_id}", "starred_url": "https://api.github.com/users/catamorphism/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/catamorphism/subscriptions", "organizations_url": "https://api.github.com/users/catamorphism/orgs", "repos_url": "https://api.github.com/users/catamorphism/repos", "events_url": "https://api.github.com/users/catamorphism/events{/privacy}", "received_events_url": "https://api.github.com/users/catamorphism/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/5679/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/5679/timeline", "performed_via_github_app": null, "state_reason": "completed"}