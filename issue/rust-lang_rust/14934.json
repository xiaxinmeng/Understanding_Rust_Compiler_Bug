{"url": "https://api.github.com/repos/rust-lang/rust/issues/14934", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/14934/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/14934/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/14934/events", "html_url": "https://github.com/rust-lang/rust/issues/14934", "id": 35808173, "node_id": "MDU6SXNzdWUzNTgwODE3Mw==", "number": 14934, "title": "Cannot build rustc with debug symbols", "user": {"login": "farcaller", "id": 693, "node_id": "MDQ6VXNlcjY5Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/693?v=4", "gravatar_id": "", "url": "https://api.github.com/users/farcaller", "html_url": "https://github.com/farcaller", "followers_url": "https://api.github.com/users/farcaller/followers", "following_url": "https://api.github.com/users/farcaller/following{/other_user}", "gists_url": "https://api.github.com/users/farcaller/gists{/gist_id}", "starred_url": "https://api.github.com/users/farcaller/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/farcaller/subscriptions", "organizations_url": "https://api.github.com/users/farcaller/orgs", "repos_url": "https://api.github.com/users/farcaller/repos", "events_url": "https://api.github.com/users/farcaller/events{/privacy}", "received_events_url": "https://api.github.com/users/farcaller/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2014-06-16T15:38:49Z", "updated_at": "2014-06-16T16:13:06Z", "closed_at": "2014-06-16T16:13:06Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Figured this out while making tests for #14930:\n\nIf rust is being compiled with `RUSTFLAGS=-g`, the compilation fails:\n\n```\nrustc: x86_64-unknown-linux-gnu/stage0/lib/rustlib/x86_64-unknown-linux-gnu/lib/librand\nerror: internal compiler error: Type metadata for unique id '{&{&[]{struct 24dc9d604458b65a/2157e}}}' is already in the TypeMap!\nnote: the compiler hit an unexpected failure path. this is a bug.\nnote: we would appreciate a bug report: http://doc.rust-lang.org/complement-bugreport.html\nnote: run with `RUST_BACKTRACE=1` for a backtrace\ntask 'rustc' failed at 'Box<Any>', /home/rustbuild/src/rust-buildbot/slave/snap3-linux/build/src/libsyntax/diagnostic.rs:162\n\nstack backtrace:\n   1:          0x1ec3d80 - rt::backtrace::imp::write::hcd94f13cdcdb6e12BGp::v0.11.0.pre\n   2:          0x1ecb280 - failure::on_fail::h6615087e8c3d8ecfO1p::v0.11.0.pre\n   3:          0x1edb980 - unwind::begin_unwind_inner::h05200ba535951806QRd::v0.11.0.pre\n   4:          0x1c14900 - unwind::begin_unwind::h5588517338900193510::v0.11.0.pre\n   5:          0x1c15340 - diagnostic::Handler::bug::he43b870130bf2aabW3b::v0.11.0.pre\n   6:           0x483e80 - driver::session::Session::bug::h4ad8b2c3842ec1ccWdw::v0.11.0.pre\n   7:           0x5d0420 - middle::trans::debuginfo::TypeMap::register_unique_id_with_metadata::he9a9c3fc2f027aa84pB::v0.11.0.pre\n   8:           0x5dbf90 - middle::trans::debuginfo::type_metadata::he00882db7499adf27ZD::v0.11.0.pre\n   9:           0x5e55b0 - middle::trans::debuginfo::MemberDescriptionFactory::create_member_descriptions::hdeef9523b9a7011d6UC::v0.11.0\n.pre\n  10:           0x5e8aa0 - middle::trans::debuginfo::RecursiveTypeDescription::finalize::h5c9b0eeeff3c1a8cfXC::v0.11.0.pre\n  11:           0x5dbf90 - middle::trans::debuginfo::type_metadata::he00882db7499adf27ZD::v0.11.0.pre\n  12:           0x5dbf90 - middle::trans::debuginfo::type_metadata::he00882db7499adf27ZD::v0.11.0.pre\n  13:           0x5f1d70 - middle::trans::debuginfo::subroutine_type_metadata::h228aa4c8af7ecd4bNVD::v0.11.0.pre\n  14:           0x5dbf90 - middle::trans::debuginfo::type_metadata::he00882db7499adf27ZD::v0.11.0.pre\n  15:           0x568990 - middle::trans::debuginfo::create_function_debug_context::h6836d73011bb476dYeC::v0.11.0.pre\n  16:           0x4d6200 - middle::trans::base::new_fn_ctxt::hc5011f5fe8eb795116p::v0.11.0.pre\n  17:           0x56d7d0 - middle::trans::base::trans_closure::hc8859eae9acafde13kq::v0.11.0.pre\n  18:           0x4851e0 - middle::trans::base::trans_fn::ha173904712b1670b4sq::v0.11.0.pre\n  19:           0x47d8b0 - middle::trans::base::trans_item::h5e3f5538bc6cfa65tJq::v0.11.0.pre\n  20:           0x4ba410 - visit::Visitor::visit_block::h12755614036315782319::v0.11.0.pre\n  21:           0x4ba410 - visit::Visitor::visit_block::h12755614036315782319::v0.11.0.pre\n  22:           0x4b9480 - visit::walk_expr::h64963664216574027::v0.11.0.pre\n  23:           0x4ba410 - visit::Visitor::visit_block::h12755614036315782319::v0.11.0.pre\n  24:           0x4bae80 - visit::Visitor::visit_fn::h4206062103511899638::v0.11.0.pre\n  25:           0x573fb0 - middle::trans::meth::trans_impl::hd6e6431bef91d8366nw::v0.11.0.pre\n  26:           0x47d8b0 - middle::trans::base::trans_item::h5e3f5538bc6cfa65tJq::v0.11.0.pre\n  27:           0x47d8b0 - middle::trans::base::trans_item::h5e3f5538bc6cfa65tJq::v0.11.0.pre\n  28:           0x47d8b0 - middle::trans::base::trans_item::h5e3f5538bc6cfa65tJq::v0.11.0.pre\n  29:           0x57e400 - middle::trans::base::trans_crate::h17f91ed34adf1105VCr::v0.11.0.pre\n  30:           0xd803d0 - driver::driver::phase_4_translate_to_llvm::h2cf153231c6174c4Hov::v0.11.0.pre\n  31:           0xd74960 - driver::driver::compile_input::h02b28a5a806379c2L3u::v0.11.0.pre\n  32:           0xe3cac0 - driver::run_compiler::habd45a2a1672efebjLx::v0.11.0.pre\n  33:           0xe3c9d0 - driver::main_args::closure.98475\n  34:           0xe58390 - driver::monitor::closure.99566\n  35:           0xe532d0 - task::TaskBuilder::try::closure.99329\n  36:           0x46b930 - task::spawn_opts::closure.7156\n  37:          0x1ed8ec0 - task::Task::run::closure.5303\n  38:          0x1edc6c0 - rust_try\n  39:          0x1edafa0 - unwind::try::h672009d7ba7d4d3cfGd::v0.11.0.pre\n  40:          0x1ed8d40 - task::Task::run::h729e770b60693644VVc::v0.11.0.pre\n  41:           0x46b6d0 - task::spawn_opts::closure.7129\n  42:          0x1eda740 - thread::thread_start::h15b4164760096a99kdd::v0.11.0.pre\n  43:     0x7f59c8946060 - start_thread\n  44:     0x7f59c7d54489 - __clone\n  45:                0x0 - <unknown>\n\n/tmp/rust/mk/target.mk:163: recipe for target 'x86_64-unknown-linux-gnu/stage0/lib/rustlib/x86_64-unknown-linux-gnu/lib/stamp.rand' fail\ned\n```\n", "closed_by": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/14934/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/14934/timeline", "performed_via_github_app": null, "state_reason": "completed"}