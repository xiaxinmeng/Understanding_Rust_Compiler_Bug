{"url": "https://api.github.com/repos/rust-lang/rust/issues/56132", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/56132/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/56132/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/56132/events", "html_url": "https://github.com/rust-lang/rust/issues/56132", "id": 383106179, "node_id": "MDU6SXNzdWUzODMxMDYxNzk=", "number": 56132, "title": "Permit `-> _` return types for improved diagnostics", "user": {"login": "varkor", "id": 3943692, "node_id": "MDQ6VXNlcjM5NDM2OTI=", "avatar_url": "https://avatars.githubusercontent.com/u/3943692?v=4", "gravatar_id": "", "url": "https://api.github.com/users/varkor", "html_url": "https://github.com/varkor", "followers_url": "https://api.github.com/users/varkor/followers", "following_url": "https://api.github.com/users/varkor/following{/other_user}", "gists_url": "https://api.github.com/users/varkor/gists{/gist_id}", "starred_url": "https://api.github.com/users/varkor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/varkor/subscriptions", "organizations_url": "https://api.github.com/users/varkor/orgs", "repos_url": "https://api.github.com/users/varkor/repos", "events_url": "https://api.github.com/users/varkor/events{/privacy}", "received_events_url": "https://api.github.com/users/varkor/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 36996, "node_id": "MDU6TGFiZWwzNjk5Ng==", "url": "https://api.github.com/repos/rust-lang/rust/labels/E-easy", "name": "E-easy", "color": "02e10c", "default": false, "description": "Call for participation: Experience needed to fix: Easy / not much (good first issue)"}, {"id": 235791, "node_id": "MDU6TGFiZWwyMzU3OTE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-diagnostics", "name": "A-diagnostics", "color": "f7e101", "default": false, "description": "Area: Messages for errors, warnings, and lints"}, {"id": 67766349, "node_id": "MDU6TGFiZWw2Nzc2NjM0OQ==", "url": "https://api.github.com/repos/rust-lang/rust/labels/E-mentor", "name": "E-mentor", "color": "02E10C", "default": false, "description": "Call for participation: This issue has a mentor. Use RustcContributor::new on Zulip for discussion."}, {"id": 203429200, "node_id": "MDU6TGFiZWwyMDM0MjkyMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/P-high", "name": "P-high", "color": "eb6420", "default": false, "description": "High priority"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 919710011, "node_id": "MDU6TGFiZWw5MTk3MTAwMTE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/disposition-merge", "name": "disposition-merge", "color": "008800", "default": false, "description": "This issue / PR is in PFCP or FCP with a disposition to merge it."}, {"id": 923282386, "node_id": "MDU6TGFiZWw5MjMyODIzODY=", "url": "https://api.github.com/repos/rust-lang/rust/labels/finished-final-comment-period", "name": "finished-final-comment-period", "color": "f9e189", "default": false, "description": "The final comment period is finished for this PR / Issue."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 31, "created_at": "2018-11-21T12:56:42Z", "updated_at": "2019-07-19T07:49:47Z", "closed_at": "2019-07-19T07:49:47Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Consider (the invalid Rust code containing) a function that returns a value, but has no return type:\r\n```rust\r\nfn foo() {\r\n    0u8\r\n}\r\n\r\nfn main() {\r\n    let _: u8 = foo();\r\n}\r\n```\r\nCurrently, the compiler produces these errors:\r\n```\r\nerror[E0308]: mismatched types\r\n --> src/main.rs:2:5\r\n  |\r\n1 | fn foo() {\r\n  |          - help: try adding a return type: `-> u8`\r\n2 |     0u8\r\n  |     ^^^ expected (), found u8\r\n  |\r\n  = note: expected type `()`\r\n             found type `u8`\r\n\r\nerror[E0308]: mismatched types\r\n --> src/main.rs:6:17\r\n  |\r\n6 |     let _: u8 = foo();\r\n  |                 ^^^^^ expected u8, found ()\r\n  |\r\n  = note: expected type `u8`\r\n             found type `()`\r\n\r\nerror: aborting due to 2 previous errors\r\n```\r\nIn theory, the only problem is the missing return type, which, if provided, would cause the code to compile successfully.\r\n\r\nThe compiler knows what the return type should be here, and could potentially interpret the rest of the program as if the correct return type were given.\r\n\r\nThis issue proposes giving special treatment in the compiler for diagnostics only (note that this is *not* a language change) to the syntax `-> _` for return types. This would report a normal error for a missing return type (no extra code would compile after this change), but would otherwise treat the function as having the missing return type. A machine-applicable suggestion would be provided to replace `_` with the correct return type.\r\n\r\nFor example:\r\n```rust\r\nfn foo() -> _ {\r\n    0u8\r\n}\r\n\r\nfn main() {\r\n    let _: u8 = foo();\r\n}\r\n```\r\n```\r\nerror[E0121]: the type placeholder `_` is not allowed within types on item signatures\r\n --> src/main.rs:1:13\r\n  |\r\n1 | fn foo() -> _ {\r\n  |             ^ not allowed in type signatures\r\n  |             - help: replace `_` with the correct return type: `u8`\r\n```", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/56132/reactions", "total_count": 16, "+1": 14, "-1": 2, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/56132/timeline", "performed_via_github_app": null, "state_reason": "completed"}