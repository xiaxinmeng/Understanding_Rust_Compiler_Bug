{"url": "https://api.github.com/repos/rust-lang/rust/issues/79839", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/79839/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/79839/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/79839/events", "html_url": "https://github.com/rust-lang/rust/issues/79839", "id": 759818155, "node_id": "MDU6SXNzdWU3NTk4MTgxNTU=", "number": 79839, "title": "thread 'rustc' panicked at 'called `Option::unwrap()` on a `None` value'", "user": {"login": "daveriedstra", "id": 3504098, "node_id": "MDQ6VXNlcjM1MDQwOTg=", "avatar_url": "https://avatars.githubusercontent.com/u/3504098?v=4", "gravatar_id": "", "url": "https://api.github.com/users/daveriedstra", "html_url": "https://github.com/daveriedstra", "followers_url": "https://api.github.com/users/daveriedstra/followers", "following_url": "https://api.github.com/users/daveriedstra/following{/other_user}", "gists_url": "https://api.github.com/users/daveriedstra/gists{/gist_id}", "starred_url": "https://api.github.com/users/daveriedstra/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/daveriedstra/subscriptions", "organizations_url": "https://api.github.com/users/daveriedstra/orgs", "repos_url": "https://api.github.com/users/daveriedstra/repos", "events_url": "https://api.github.com/users/daveriedstra/events{/privacy}", "received_events_url": "https://api.github.com/users/daveriedstra/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-12-08T22:05:14Z", "updated_at": "2020-12-08T23:30:30Z", "closed_at": "2020-12-08T23:30:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!--\r\n\r\nThis blog post is way more effort than I'm able to put in to file this bug report, sorry team.\r\n\r\nhttp://blog.pnkfx.org/blog/2019/11/18/rust-bug-minimization-patterns/\r\n\r\n-->\r\n\r\n### Code\r\n\r\nI'm not sure which of my code is triggering this bug (and don't have the time to go through the recommended blog post in the issue template). However, the two most suspicious changes I made today are\r\n\r\n* switch from `nightly-2020-11-27` to `nightly-2020-12-08`\r\n* start using `#![feature(min_const_generics)]` (in a separate library crate, which is used in the problem crate but compiles fine on its own)\r\n\r\nThis also looks similar to #79833 \r\n\r\n\r\n### Meta\r\n<!--\r\nIf you're using the stable version of the compiler, you should also check if the\r\nbug also exists in the beta or nightly versions.\r\n-->\r\n\r\n`rustc --version --verbose`:\r\n```\r\nrustc 1.50.0-nightly (3d6705aa5 2020-12-07)\r\nbinary: rustc\r\ncommit-hash: 3d6705aa5abffe94c83bf09af8c3ba3c599845fc\r\ncommit-date: 2020-12-07\r\nhost: x86_64-unknown-linux-gnu\r\nrelease: 1.50.0-nightly\r\n```\r\n\r\n### Error output\r\n\r\n<!--\r\nInclude a backtrace in the code block by setting `RUST_BACKTRACE=1` in your\r\nenvironment. E.g. `RUST_BACKTRACE=1 cargo build`.\r\n-->\r\n<details><summary><strong>Backtrace</strong></summary>\r\n<p>\r\n\r\n```\r\n$ env RUST_BACKTRACE=1 cargo build --verbose\r\n       Fresh autocfg v1.0.1\r\n       Fresh cfg-if v0.1.10\r\n       Fresh lazy_static v1.4.0\r\n       Fresh scopeguard v1.1.0\r\n       Fresh semver-parser v0.7.0\r\n       Fresh futures v0.1.30\r\n       Fresh slab v0.4.2\r\n       Fresh cfg-if v1.0.0\r\n       Fresh fnv v1.0.7\r\n       Fresh semver v0.9.0\r\n       Fresh lock_api v0.3.4\r\n       Fresh tokio-sync v0.1.8\r\n       Fresh libloading v0.6.6\r\n       Fresh libc v0.2.80\r\n       Fresh maybe-uninit v2.0.0\r\n       Fresh rustc_version v0.2.3\r\n       Fresh log v0.4.11\r\n       Fresh byteorder v1.3.4\r\n       Fresh crossbeam-utils v0.7.2\r\n       Fresh iovec v0.1.4\r\n       Fresh net2 v0.2.35\r\n       Fresh num_cpus v1.13.0\r\n       Fresh memoffset v0.5.6\r\n       Fresh const_fn v0.4.3\r\n       Fresh bitflags v1.2.1\r\n       Fresh jack-sys v0.2.1\r\n       Fresh tokio-executor v0.1.10\r\n       Fresh bytes v0.4.12\r\n       Fresh smallvec v0.6.13\r\n       Fresh crossbeam-queue v0.2.3\r\n       Fresh crossbeam-utils v0.8.1\r\n       Fresh memoffset v0.6.1\r\n       Fresh crossbeam-channel v0.4.4\r\n       Fresh rosc v0.1.6\r\n       Fresh mio v0.6.22\r\n       Fresh crossbeam-epoch v0.8.2\r\n       Fresh tokio-current-thread v0.1.7\r\n       Fresh tokio-timer v0.2.13\r\n       Fresh jack v0.6.5\r\n       Fresh tokio-io v0.1.13\r\n       Fresh crossbeam-epoch v0.9.1\r\n       Fresh crossbeam-channel v0.5.0\r\n       Fresh crossbeam-queue v0.3.1\r\n       Fresh parking_lot_core v0.6.2\r\n       Fresh crossbeam-deque v0.7.3\r\n       Fresh tokio-codec v0.1.2\r\n       Fresh mio-uds v0.6.8\r\n       Fresh parking_lot v0.9.0\r\n       Fresh tokio-threadpool v0.1.18\r\n       Fresh crossbeam v0.7.3\r\n       Fresh crossbeam-deque v0.8.0\r\n       Fresh tokio-reactor v0.1.12\r\n       Fresh tokio-fs v0.1.7\r\n       Fresh crossbeam v0.8.0\r\n       Fresh tokio-uds v0.2.7\r\n       Fresh tokio-tcp v0.1.4\r\n       Fresh tokio-udp v0.1.6\r\n       Fresh tokio v0.1.22\r\n       Fresh monome-rs v1.1.0\r\n       Fresh arc v0.1.0 (/home/dried/Software/darc-rs/arc)\r\n   Compiling darcrs-jack v0.1.0 (/home/dried/Software/darc-rs/darcrs-jack)\r\n     Running `rustc --crate-name darcrs_jack --edition=2018 darcrs-jack/src/main.rs --error-format=json --json=diagnostic-rendered-ansi --crate-type bin --emit=dep-info,link -C embed-bitcode=no -C debuginfo=2 -C metadata=b36605a9ed9522cb -C extra-filename=-b36605a9ed9522cb --out-dir /home/dried/Software/darc-rs/target/debug/deps -C incremental=/home/dried/Software/darc-rs/target/debug/incremental -L dependency=/home/dried/Software/darc-rs/target/debug/deps --extern arc=/home/dried/Software/darc-rs/target/debug/deps/libarc-b4d7007595aad299.rlib --extern crossbeam=/home/dried/Software/darc-rs/target/debug/deps/libcrossbeam-6926fe359fd741df.rlib --extern jack=/home/dried/Software/darc-rs/target/debug/deps/libjack-750ae0e669e82843.rlib --extern monome=/home/dried/Software/darc-rs/target/debug/deps/libmonome-0bef62ceff3920ac.rlib`\r\nthread 'rustc' panicked at 'called `Option::unwrap()` on a `None` value', compiler/rustc_middle/src/ty/query/mod.rs:235:5\r\nstack backtrace:\r\n   0: rust_begin_unwind\r\n             at /rustc/3d6705aa5abffe94c83bf09af8c3ba3c599845fc/library/std/src/panicking.rs:493:5\r\n   1: core::panicking::panic_fmt\r\n             at /rustc/3d6705aa5abffe94c83bf09af8c3ba3c599845fc/library/core/src/panicking.rs:92:14\r\n   2: core::panicking::panic\r\n             at /rustc/3d6705aa5abffe94c83bf09af8c3ba3c599845fc/library/core/src/panicking.rs:50:5\r\n   3: rustc_middle::ty::query::try_load_from_on_disk_cache\r\n   4: rustc_query_system::dep_graph::graph::DepGraph<K>::exec_cache_promotions\r\n   5: rustc_middle::dep_graph::<impl rustc_query_system::dep_graph::DepKind for rustc_middle::dep_graph::dep_node::DepKind>::with_deps\r\n   6: rustc_incremental::persist::save::save_in\r\n   7: rustc_data_structures::sync::join\r\n   8: rustc_middle::dep_graph::<impl rustc_query_system::dep_graph::DepKind for rustc_middle::dep_graph::dep_node::DepKind>::with_deps\r\n   9: rustc_incremental::persist::save::save_dep_graph\r\n  10: rustc_codegen_ssa::base::finalize_tcx\r\n  11: <rustc_codegen_llvm::LlvmCodegenBackend as rustc_codegen_ssa::traits::backend::CodegenBackend>::codegen_crate\r\n  12: rustc_session::utils::<impl rustc_session::session::Session>::time\r\n  13: rustc_interface::passes::QueryContext::enter\r\n  14: rustc_interface::queries::Queries::ongoing_codegen\r\n  15: rustc_interface::queries::<impl rustc_interface::interface::Compiler>::enter\r\n  16: rustc_span::with_source_map\r\n  17: rustc_interface::interface::create_compiler_and_run\r\n  18: scoped_tls::ScopedKey<T>::set\r\nnote: Some details are omitted, run with `RUST_BACKTRACE=full` for a verbose backtrace.\r\n\r\nerror: internal compiler error: unexpected panic\r\n\r\nnote: the compiler unexpectedly panicked. this is a bug.\r\n\r\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/issues/new?labels=C-bug%2C+I-ICE%2C+T-compiler&template=ice.md\r\n\r\nnote: rustc 1.50.0-nightly (3d6705aa5 2020-12-07) running on x86_64-unknown-linux-gnu\r\n\r\nnote: compiler flags: -C embed-bitcode=no -C debuginfo=2 -C incremental --crate-type bin\r\n\r\nnote: some of the compiler flags provided by cargo are hidden\r\n\r\nquery stack during panic:\r\nend of query stack\r\nerror: could not compile `darcrs-jack`\r\n\r\nCaused by:\r\n  process didn't exit successfully: `rustc --crate-name darcrs_jack --edition=2018 darcrs-jack/src/main.rs --error-format=json --json=diagnostic-rendered-ansi --crate-type bin --emit=dep-info,link -C embed-bitcode=no -C debuginfo=2 -C metadata=b36605a9ed9522cb -C extra-filename=-b36605a9ed9522cb --out-dir /home/dried/Software/darc-rs/target/debug/deps -C incremental=/home/dried/Software/darc-rs/target/debug/incremental -L dependency=/home/dried/Software/darc-rs/target/debug/deps --extern arc=/home/dried/Software/darc-rs/target/debug/deps/libarc-b4d7007595aad299.rlib --extern crossbeam=/home/dried/Software/darc-rs/target/debug/deps/libcrossbeam-6926fe359fd741df.rlib --extern jack=/home/dried/Software/darc-rs/target/debug/deps/libjack-750ae0e669e82843.rlib --extern monome=/home/dried/Software/darc-rs/target/debug/deps/libmonome-0bef62ceff3920ac.rlib` (exit code: 101)\r\n```\r\n\r\n</p>\r\n</details>\r\n\r\n", "closed_by": {"login": "camelid", "id": 37223377, "node_id": "MDQ6VXNlcjM3MjIzMzc3", "avatar_url": "https://avatars.githubusercontent.com/u/37223377?v=4", "gravatar_id": "", "url": "https://api.github.com/users/camelid", "html_url": "https://github.com/camelid", "followers_url": "https://api.github.com/users/camelid/followers", "following_url": "https://api.github.com/users/camelid/following{/other_user}", "gists_url": "https://api.github.com/users/camelid/gists{/gist_id}", "starred_url": "https://api.github.com/users/camelid/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/camelid/subscriptions", "organizations_url": "https://api.github.com/users/camelid/orgs", "repos_url": "https://api.github.com/users/camelid/repos", "events_url": "https://api.github.com/users/camelid/events{/privacy}", "received_events_url": "https://api.github.com/users/camelid/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/79839/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/79839/timeline", "performed_via_github_app": null, "state_reason": "completed"}