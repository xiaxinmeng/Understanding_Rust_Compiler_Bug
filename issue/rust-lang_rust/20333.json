{"url": "https://api.github.com/repos/rust-lang/rust/issues/20333", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/20333/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/20333/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/20333/events", "html_url": "https://github.com/rust-lang/rust/issues/20333", "id": 53119479, "node_id": "MDU6SXNzdWU1MzExOTQ3OQ==", "number": 20333, "title": "`Char::to_{lower,upper}case` should return `Option<&'static str>` instead of `char`", "user": {"login": "SimonSapin", "id": 291359, "node_id": "MDQ6VXNlcjI5MTM1OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/291359?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SimonSapin", "html_url": "https://github.com/SimonSapin", "followers_url": "https://api.github.com/users/SimonSapin/followers", "following_url": "https://api.github.com/users/SimonSapin/following{/other_user}", "gists_url": "https://api.github.com/users/SimonSapin/gists{/gist_id}", "starred_url": "https://api.github.com/users/SimonSapin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SimonSapin/subscriptions", "organizations_url": "https://api.github.com/users/SimonSapin/orgs", "repos_url": "https://api.github.com/users/SimonSapin/repos", "events_url": "https://api.github.com/users/SimonSapin/events{/privacy}", "received_events_url": "https://api.github.com/users/SimonSapin/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 166999014, "node_id": "MDU6TGFiZWwxNjY5OTkwMTQ=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-collections", "name": "A-collections", "color": "f7e101", "default": false, "description": "Area: std::collections."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2014-12-30T14:38:48Z", "updated_at": "2015-03-11T01:13:02Z", "closed_at": "2015-03-11T01:13:02Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "These two methods should not be stabilized as-is. They should be changed to return a variable number of code points (between one and three), per Unicode\u2019s [`SpecialCasing.txt`](http://www.unicode.org/Public/UCD/latest/ucd/SpecialCasing.txt).\n\nSuch results could be represented as `&'static str` or `&'static [char]` slices of a static table in libunicode. The former avoid re-encoding to UTF-8 when accumulating results in a `String`. To avoid having an entry in that table for every one of the 1114111 code points, the return type could be an `Option`, where `None` means that the code point is unchanged by the mapping. (This is by large the common case.) Or it could be a new special-purpose type like `enum CaseMappingResult { Unchanged, MappedTo(&'static str) }`.\n\nSince the `Char` methods become less convenient to use, there should be `str::to_{lower,upper}case() -> String` wrappers.\n\n`SpecialCasing.txt` also defines some language-sensitive mappings for Turkish and Lithuanian, but I suggest not including them, for a few reasons:\n- Using the system\u2019s locale is a very bad idea. Programs behaving differently on different systems is a source of countless bugs, and the system\u2019s locale may not even be that of the end users (e.g for server-side software.)\n- Forcing users to specify a language is counter-productive since it might often end up being hard-coded to English or something. There should be a default.\n- Users who _do_ care about language-specific tailoring may want to do more anyway. `SpecialCasing.txt` says:\n  \n  > Note that the preferred mechanism for defining tailored casing operations is the Unicode Common Locale Data Repository (CLDR).\n\nFinally, there are conditional mappings that depend on the context of surrounding code points, but not on the language. They could be special cases in the `str` methods, but I don\u2019t know if it\u2019s worth the bother since there is currently only one such special case. (Greek capital sigma at the end of a word.)\n\nMore background on Unicode case mappings:\n\nhttp://unicode.org/faq/casemap_charprop.html\nhttp://www.unicode.org/reports/tr44/tr44-14.html#Casemapping\n\nCC @huonw, @aturon\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/20333/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/20333/timeline", "performed_via_github_app": null, "state_reason": "completed"}