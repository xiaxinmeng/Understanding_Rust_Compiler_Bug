{"url": "https://api.github.com/repos/rust-lang/rust/issues/53847", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/53847/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/53847/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/53847/events", "html_url": "https://github.com/rust-lang/rust/issues/53847", "id": 355895614, "node_id": "MDU6SXNzdWUzNTU4OTU2MTQ=", "number": 53847, "title": "Nuke the `const_to_allocation` query", "user": {"login": "oli-obk", "id": 332036, "node_id": "MDQ6VXNlcjMzMjAzNg==", "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oli-obk", "html_url": "https://github.com/oli-obk", "followers_url": "https://api.github.com/users/oli-obk/followers", "following_url": "https://api.github.com/users/oli-obk/following{/other_user}", "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}", "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions", "organizations_url": "https://api.github.com/users/oli-obk/orgs", "repos_url": "https://api.github.com/users/oli-obk/repos", "events_url": "https://api.github.com/users/oli-obk/events{/privacy}", "received_events_url": "https://api.github.com/users/oli-obk/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 36996, "node_id": "MDU6TGFiZWwzNjk5Ng==", "url": "https://api.github.com/repos/rust-lang/rust/labels/E-easy", "name": "E-easy", "color": "02e10c", "default": false, "description": "Call for participation: Experience needed to fix: Easy / not much (good first issue)"}, {"id": 37234, "node_id": "MDU6TGFiZWwzNzIzNA==", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-cleanup", "name": "C-cleanup", "color": "f5f1fd", "default": false, "description": "Category: PRs that clean code up or issues documenting cleanup."}, {"id": 900795185, "node_id": "MDU6TGFiZWw5MDA3OTUxODU=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-const-eval", "name": "A-const-eval", "color": "f7e101", "default": false, "description": "Area: constant evaluation (mir interpretation)"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-08-31T08:55:38Z", "updated_at": "2018-09-01T18:12:45Z", "closed_at": "2018-09-01T18:08:58Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "This query is not doing anything anymore and only used in two locations.\r\n\r\nSteps for resolving this issue:\r\n\r\n1. grep for `const_to_allocation` and remember where the two `tcx.const_to_allocation` calls are\r\n2. remove every mention of it\r\n3. grep for `ConstToAllocation`\r\n4. remove every mentioon of it\r\n5. start building (this takes some time before it hits your use sites, let the computer work in parallel to you)\r\n6. go back to the former call sites and replace them by pattern matching on the argument to extract the necessary data from the `ByRef` and panic if it's not `ByRef`.\r\n7. remove all the comments at the call sites talking about the query\r\n8. open a PR\r\n9. ping @RalfJung on the PR and watch his happiness meter go up", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/53847/reactions", "total_count": 3, "+1": 1, "-1": 0, "laugh": 2, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/53847/timeline", "performed_via_github_app": null, "state_reason": "completed"}