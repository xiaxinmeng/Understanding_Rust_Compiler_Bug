{"url": "https://api.github.com/repos/rust-lang/rust/issues/14227", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/14227/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/14227/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/14227/events", "html_url": "https://github.com/rust-lang/rust/issues/14227", "id": 33589935, "node_id": "MDU6SXNzdWUzMzU4OTkzNQ==", "number": 14227, "title": "error: internal compiler error: unexpected failure (expected item, found foreign item)", "user": {"login": "dotnwat", "id": 242417, "node_id": "MDQ6VXNlcjI0MjQxNw==", "avatar_url": "https://avatars.githubusercontent.com/u/242417?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dotnwat", "html_url": "https://github.com/dotnwat", "followers_url": "https://api.github.com/users/dotnwat/followers", "following_url": "https://api.github.com/users/dotnwat/following{/other_user}", "gists_url": "https://api.github.com/users/dotnwat/gists{/gist_id}", "starred_url": "https://api.github.com/users/dotnwat/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dotnwat/subscriptions", "organizations_url": "https://api.github.com/users/dotnwat/orgs", "repos_url": "https://api.github.com/users/dotnwat/repos", "events_url": "https://api.github.com/users/dotnwat/events{/privacy}", "received_events_url": "https://api.github.com/users/dotnwat/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}, {"id": 46741598, "node_id": "MDU6TGFiZWw0Njc0MTU5OA==", "url": "https://api.github.com/repos/rust-lang/rust/labels/E-needs-test", "name": "E-needs-test", "color": "02e10c", "default": false, "description": "Call for participation: writing correctness tests"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2014-05-15T14:24:06Z", "updated_at": "2014-12-30T10:42:46Z", "closed_at": "2014-12-30T10:42:46Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm getting the following error compiling a simple FFI test (backtrace included below). I am creating a reference to a static pointer symbol in a C library. Then, I have a Rust object wrapper and want to create a static instance of that object that points to the pointer defined in the C library. Here is the gist of the library:\n\n```\npub type MPI_Comm = *c_void;\nextern {\n   pub static MPI_COMM_WORLD: MPI_Comm;\n}\n\npub struct Comm {\n  ptr: ffi::MPI_Comm,\n}\n\npub static COMM_WORLD: Comm = Comm { ptr: ffi::MPI_COMM_WORLD };\n```\n# Backtrace\n\n```\nerror: internal compiler error: unexpected failure\nnote: the compiler hit an unexpected failure path. this is a bug.\nnote: we would appreciate a bug report: http://static.rust-lang.org/doc/master/complement-bugreport.html\nnote: run with `RUST_BACKTRACE=1` for a backtrace\ntask 'rustc' failed at 'expected item, found foreign item ffi::MPI_COMM_WORLD::MPI_COMM_WORLD (id=47)', /home/nwatkins/rust/rust/src/libsyntax/ast_map.rs:264\nstack backtrace:\n   1:     0x7f389bbf6320 - rt::backtrace::imp::write::he4a96dd9becae7baQZF::v0.11.pre\n   2:     0x7f389bb5e7f0 - rt::unwind::begin_unwind_inner::h429f42930e247ed3TzF::v0.11.pre\n   3:     0x7f389bb5da40 - rt::unwind::begin_unwind_fmt::h2658199b4e21bf1d3yF::v0.11.pre\n   4:     0x7f389a7d9f70 - ast_map::Map::expect_item::hfd129ba246eef9e7fmw::v0.11.pre\n   5:     0x7f389cb333e0 - middle::check_const::CheckItemRecursionVisitor<'a>.Visitor<(*>::visit_expr::h5cd0b6fa8c9a4f2bGTx::v0.11.pre\n   6:     0x7f389cb333e0 - middle::check_const::CheckItemRecursionVisitor<'a>.Visitor<(*>::visit_expr::h5cd0b6fa8c9a4f2bGTx::v0.11.pre\n   7:     0x7f389cb321e0 - middle::check_const::CheckItemRecursionVisitor<'a>.Visitor<(*>::visit_item::hd092905fe77dd21cLSx::v0.11.pre\n   8:     0x7f389cb2d7d0 - middle::check_const::check_item::h95a2cf717ce35925AHx::v0.11.pre\n   9:     0x7f389cb306a0 - middle::check_const::check_crate::hb33f792abf387b41bHx::v0.11.pre\n  10:     0x7f389cb13c40 - util::common::time::h2370236349741964365::v0.11.pre\n  11:     0x7f389cef3780 - driver::driver::phase_3_run_analysis_passes::h6fe36fe1431dcb23Wci::v0.11.pre\n  12:     0x7f389ceed280 - driver::driver::compile_input::h002d716c1383702at2h::v0.11.pre\n  13:     0x7f389cf90af0 - driver::main_args::closure.92546\n  14:     0x7f389cfa7310 - driver::monitor::closure.93721\n  15:     0x7f389cfa1750 - task::TaskBuilder::try::closure.93488\n  16:     0x7f389c15f1c0 - task::spawn_opts::closure.7382\n  17:     0x7f389bbeccd0 - rt::task::Task::run::closure.28450\n  18:     0x7f389bc0eaf0 - rust_try\n  19:     0x7f389bbecb10 - rt::task::Task::run::h8aff154bc145518aBoD::v0.11.pre\n  20:     0x7f389c15ef70 - task::spawn_opts::closure.7355\n  21:     0x7f389bbf4d20 - rt::thread::thread_start::ha112b5063324e752M6D::v0.11.pre\n  22:     0x7f38998ab0c0 - start_thread\n  23:     0x7f389b8292d9 - __clone\n  24:                0x0 - <unknown>\n```\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/14227/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/14227/timeline", "performed_via_github_app": null, "state_reason": "completed"}