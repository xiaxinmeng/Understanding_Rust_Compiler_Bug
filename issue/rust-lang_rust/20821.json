{"url": "https://api.github.com/repos/rust-lang/rust/issues/20821", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/20821/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/20821/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/20821/events", "html_url": "https://github.com/rust-lang/rust/issues/20821", "id": 53904432, "node_id": "MDU6SXNzdWU1MzkwNDQzMg==", "number": 20821, "title": "Rust 32bit does not compile on Windows 7: LLVM fails to build", "user": {"login": "AnthIste", "id": 144103, "node_id": "MDQ6VXNlcjE0NDEwMw==", "avatar_url": "https://avatars.githubusercontent.com/u/144103?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AnthIste", "html_url": "https://github.com/AnthIste", "followers_url": "https://api.github.com/users/AnthIste/followers", "following_url": "https://api.github.com/users/AnthIste/following{/other_user}", "gists_url": "https://api.github.com/users/AnthIste/gists{/gist_id}", "starred_url": "https://api.github.com/users/AnthIste/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AnthIste/subscriptions", "organizations_url": "https://api.github.com/users/AnthIste/orgs", "repos_url": "https://api.github.com/users/AnthIste/repos", "events_url": "https://api.github.com/users/AnthIste/events{/privacy}", "received_events_url": "https://api.github.com/users/AnthIste/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 123109, "node_id": "MDU6TGFiZWwxMjMxMDk=", "url": "https://api.github.com/repos/rust-lang/rust/labels/O-windows", "name": "O-windows", "color": "6e6ec0", "default": false, "description": "Operating system: Windows"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2015-01-09T19:23:00Z", "updated_at": "2016-01-04T21:29:36Z", "closed_at": "2016-01-04T21:29:36Z", "author_association": "NONE", "active_lock_reason": null, "body": "## Environment\n- Fresh Windows 7 x64 installation in a VirtualBox VM\n- Clean install of build toolchain suggested by the Rust readme\n## Steps to reproduce\n\nCompile Rust according to the steps listed in the Readme (quoted for reference):\n\nTo easily build on windows we can use MSYS2:\n\nGrab the latest MSYS2 installer and go through the installer.\nNow from the MSYS2 terminal we want to install the mingw64 toolchain and the other tools we need.\n\n```\n$ pacman -S mingw-w64-i686-toolchain\n$ pacman -S base-devel\n```\n\nWith that now start mingw32_shell.bat from where you installed MSYS2 (i.e. C:\\msys).\n\nFrom there just navigate to where you have Rust's source code, configure and build it:\n\n```\n$ ./configure\n$ make && make install\n```\n## Expected Results\n\nExpected Rust to compile\n## Actual Results\n\nOriginally the build failed during the `make llvm` stage. The most glaring issues are invalid headers (llvmconfig.h) and missing definitions (Don't have a definition for uint64_t on this platform).\n\nAttempting this a second time there was an issue with sed:\n\n```\nconfigure: WARNING: dlopen() not found - disabling plugin support\nsed: file ./confOAhICq/defines.sed line 55: unknown command: `['\nsed: file ./confOAhICq/defines.sed line 38: unknown command: `['\nsed: file ./confOAhICq/defines.sed line 55: unknown command: `['\nsed: file ./confOAhICq/defines.sed line 38: unknown command: `['\nsed: file ./confOAhICq/defines.sed line 55: unknown command: `['\nsed: file ./confOAhICq/defines.sed line 38: unknown command: `['\nnu/llvm/include/llvm/Config/llvm-config.h:572:2: error: #endif without #if\n #endif\n  ^\n```\n\nA truncated start of the original log is listed here with gists of the full logs:\n\n```\nIn file included from E:/rust/src/llvm/include/llvm/Support/Compiler.h:18:0,\n                 from E:/rust/src/llvm/include/llvm/ADT/STLExtras.h:20,\n                 from E:/rust/src/llvm/include/llvm/ADT/ArrayRef.h:14,\n                 from E:/rust/src/llvm/include/llvm/ADT/APInt.h:19,\n                 from E:/rust/src/llvm/include/llvm/ADT/APFloat.h:20,\n                 from E:/rust/src/llvm/lib/Support/APFloat.cpp:15:\nE:/rust/i686-pc-windows-gnu/llvm/include/llvm/Config/llvm-config.h:572:2: error: #endif without #if\n #endif\n  ^\nIn file included from E:/rust/src/llvm/include/llvm/Support/SwapByteOrder.h:18:0,\n                 from E:/rust/src/llvm/include/llvm/Support/MathExtras.h:18,\n                 from E:/rust/src/llvm/include/llvm/ADT/SmallVector.h:20,\n                 from E:/rust/src/llvm/include/llvm/ADT/ArrayRef.h:15,\n                 from E:/rust/src/llvm/include/llvm/ADT/APInt.h:19,\n                 from E:/rust/src/llvm/include/llvm/ADT/APFloat.h:20,\n                 from E:/rust/src/llvm/lib/Support/APFloat.cpp:15:\nE:/rust/i686-pc-windows-gnu/llvm/include/llvm/Support/DataTypes.h:78:3: error: #error \"Don't have a definition for uint64_t on this platform\"\n # error \"Don't have a definition for uint64_t on this platform\"\n   ^\nE:/rust/i686-pc-windows-gnu/llvm/include/llvm/Support/DataTypes.h:573:2: error: #endif without #if\n #endif\n  ^\nIn file included from E:/rust/src/llvm/include/llvm/Support/Allocator.h:26:0,\n                 from E:/rust/src/llvm/include/llvm/ADT/FoldingSet.h:21,\n                 from E:/rust/src/llvm/lib/Support/APFloat.cpp:17:\nE:/rust/i686-pc-windows-gnu/llvm/include/llvm/Support/DataTypes.h:573:2: error: #endif without #if\n #endif\n  ^\n```\n## Full Logs\n- [configure output](https://gist.github.com/AnthIste/d1c8379a638317d3ecb8)\n- [make output](https://gist.github.com/AnthIste/42ecf4763f318eed6a4b)\n- [error output](https://gist.github.com/AnthIste/e97827864ed4a54f5b97)\n", "closed_by": {"login": "steveklabnik", "id": 27786, "node_id": "MDQ6VXNlcjI3Nzg2", "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/steveklabnik", "html_url": "https://github.com/steveklabnik", "followers_url": "https://api.github.com/users/steveklabnik/followers", "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}", "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}", "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions", "organizations_url": "https://api.github.com/users/steveklabnik/orgs", "repos_url": "https://api.github.com/users/steveklabnik/repos", "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}", "received_events_url": "https://api.github.com/users/steveklabnik/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/20821/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/20821/timeline", "performed_via_github_app": null, "state_reason": "completed"}