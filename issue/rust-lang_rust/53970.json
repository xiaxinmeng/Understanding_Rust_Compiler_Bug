{"url": "https://api.github.com/repos/rust-lang/rust/issues/53970", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/53970/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/53970/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/53970/events", "html_url": "https://github.com/rust-lang/rust/issues/53970", "id": 357305735, "node_id": "MDU6SXNzdWUzNTczMDU3MzU=", "number": 53970, "title": "Don't automatically update submodules when running `x.py`", "user": {"login": "oli-obk", "id": 332036, "node_id": "MDQ6VXNlcjMzMjAzNg==", "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oli-obk", "html_url": "https://github.com/oli-obk", "followers_url": "https://api.github.com/users/oli-obk/followers", "following_url": "https://api.github.com/users/oli-obk/following{/other_user}", "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}", "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions", "organizations_url": "https://api.github.com/users/oli-obk/orgs", "repos_url": "https://api.github.com/users/oli-obk/repos", "events_url": "https://api.github.com/users/oli-obk/events{/privacy}", "received_events_url": "https://api.github.com/users/oli-obk/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 325438536, "node_id": "MDU6TGFiZWwzMjU0Mzg1MzY=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-bootstrap", "name": "T-bootstrap", "color": "bfd4f2", "default": false, "description": "Relevant to the bootstrap subteam: Rust's build system (x.py and src/bootstrap)"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-09-05T16:21:05Z", "updated_at": "2020-09-25T15:11:03Z", "closed_at": "2020-09-25T15:11:03Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "https://github.com/rust-lang/rust/issues/53916#issuecomment-418551687 noted that the `submodules` setting of `config.toml` is not very discoverable.\r\n\r\nI have set it to `false` in all my trees and update my submodules manually, because I've had work destroyed multiple times when I changed submodule contents and `x.py` killed them without asking by force updating the submodule to the commit checked into the rustc repo.\r\n\r\nThere are a few (not mutually exclusive) ways to improve this:\r\n\r\n1. don't update submodules if they are dirty (modified files, new files)\r\n2. don't update submodules if the current commit is newer than the one x.py wants to update to (so only go forward automatically, not backwards)\r\n3. set `submodules = false` by default (might inconvenience developers that never touch submodules, I am biased here due to touching clippy and miri on a very regular basis)\r\n\r\ncc @nnethercote @rkruppe ", "closed_by": {"login": "oli-obk", "id": 332036, "node_id": "MDQ6VXNlcjMzMjAzNg==", "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oli-obk", "html_url": "https://github.com/oli-obk", "followers_url": "https://api.github.com/users/oli-obk/followers", "following_url": "https://api.github.com/users/oli-obk/following{/other_user}", "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}", "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions", "organizations_url": "https://api.github.com/users/oli-obk/orgs", "repos_url": "https://api.github.com/users/oli-obk/repos", "events_url": "https://api.github.com/users/oli-obk/events{/privacy}", "received_events_url": "https://api.github.com/users/oli-obk/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/53970/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/53970/timeline", "performed_via_github_app": null, "state_reason": "completed"}