{"url": "https://api.github.com/repos/rust-lang/rust/issues/91624", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/91624/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/91624/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/91624/events", "html_url": "https://github.com/rust-lang/rust/issues/91624", "id": 1073122329, "node_id": "I_kwDOAAsO6M4_9owZ", "number": 91624, "title": "Static Library with LTO option not working properly", "user": {"login": "sijupunnnoose", "id": 40257036, "node_id": "MDQ6VXNlcjQwMjU3MDM2", "avatar_url": "https://avatars.githubusercontent.com/u/40257036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sijupunnnoose", "html_url": "https://github.com/sijupunnnoose", "followers_url": "https://api.github.com/users/sijupunnnoose/followers", "following_url": "https://api.github.com/users/sijupunnnoose/following{/other_user}", "gists_url": "https://api.github.com/users/sijupunnnoose/gists{/gist_id}", "starred_url": "https://api.github.com/users/sijupunnnoose/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sijupunnnoose/subscriptions", "organizations_url": "https://api.github.com/users/sijupunnnoose/orgs", "repos_url": "https://api.github.com/users/sijupunnnoose/repos", "events_url": "https://api.github.com/users/sijupunnnoose/events{/privacy}", "received_events_url": "https://api.github.com/users/sijupunnnoose/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 2459791492, "node_id": "MDU6TGFiZWwyNDU5NzkxNDky", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-lto", "name": "A-lto", "color": "f7e101", "default": false, "description": "Area: Link Time Optimization"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-12-07T09:31:31Z", "updated_at": "2021-12-07T16:50:42Z", "closed_at": null, "author_association": "NONE", "active_lock_reason": null, "body": "Greatings!!\r\n\r\nWe are facing a strange issue while building rust static library with \"-Clinker-plugin-lto\". On linking the generated library to C base results in linker error as below.\r\n\r\nFatal error: L6120U: Member mylibv7a.mylibv7a.e0989cce-cgu.0.rcgu.o in library libmylibv7a.so cannot be loaded. It is an LLVM bitcode file but the linker only accepts bitcode wrapped in an ELF object file. \r\n\r\nWhen we checked more it is observed that the ELF header is corrupted in generated library. \r\n\r\n>arm-none-eabi-readelf -a liblib.a >test.out\r\nreadelf: Error: Not an ELF file - it has the wrong magic bytes at the start\r\n\r\nAdditional Details:\r\nrustc --version\r\nrustc 1.57.0 (f1edd0429 2021-11-29)\r\n\r\nBuild command:\r\nrustc -Clinker-plugin-lto --crate-type=staticlib src/lib.rs --target=armv7a-none-eabi \r\n\r\nLooks like this issue is there with all targets, kindly please look into this issue on priority and suggest us a fix to resolve it.\r\n\r\nThanks\r\nSiju", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/91624/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/91624/timeline", "performed_via_github_app": null, "state_reason": null}