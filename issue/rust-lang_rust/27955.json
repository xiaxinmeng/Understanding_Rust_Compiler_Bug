{"url": "https://api.github.com/repos/rust-lang/rust/issues/27955", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/27955/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/27955/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/27955/events", "html_url": "https://github.com/rust-lang/rust/issues/27955", "id": 102588992, "node_id": "MDU6SXNzdWUxMDI1ODg5OTI=", "number": 27955, "title": "ICE when creating a trait object with fn with additional bounds on associated items", "user": {"login": "talchas", "id": 3578697, "node_id": "MDQ6VXNlcjM1Nzg2OTc=", "avatar_url": "https://avatars.githubusercontent.com/u/3578697?v=4", "gravatar_id": "", "url": "https://api.github.com/users/talchas", "html_url": "https://github.com/talchas", "followers_url": "https://api.github.com/users/talchas/followers", "following_url": "https://api.github.com/users/talchas/following{/other_user}", "gists_url": "https://api.github.com/users/talchas/gists{/gist_id}", "starred_url": "https://api.github.com/users/talchas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/talchas/subscriptions", "organizations_url": "https://api.github.com/users/talchas/orgs", "repos_url": "https://api.github.com/users/talchas/repos", "events_url": "https://api.github.com/users/talchas/events{/privacy}", "received_events_url": "https://api.github.com/users/talchas/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2015-08-23T05:18:06Z", "updated_at": "2015-08-23T05:21:38Z", "closed_at": "2015-08-23T05:21:38Z", "author_association": "NONE", "active_lock_reason": null, "body": "``` rust\nuse std::marker::PhantomData;\n\npub trait Filterable {\n    type Filter;\n}\n\npub trait ComponentMapper {\n    type Component;\n    fn entities_filtered(&self, <Self::Component as Filterable>::Filter)\n        where Self::Component: Filterable;\n}\n\npub struct VecMapper<T> {\n    _marker: ::std::marker::PhantomData<T>\n}\n\nimpl<T> VecMapper<T> {\n    pub fn new() -> VecMapper<T> {\n        VecMapper { _marker: PhantomData }\n    }\n}\n\nimpl<T> ComponentMapper for VecMapper<T> {\n    type Component = T;\n    fn entities_filtered(&self, _filter: T::Filter) where T: Filterable {}\n}\n\nfn main() { \n    let _m: &ComponentMapper<Component=()> = &VecMapper::<()>::new();\n}\n```\n\ngives\n\n```\nfoo.rs:1:1: 1:1 error: internal compiler error: Encountered errors `[FulfillmentError(Obligation(predicate=Binder(TraitPredicate(<() as Filterable>)),depth=0),Unimplemented)]` fulfilling during trans\nfoo.rs:1 use std::marker::PhantomData;\n```\n\nBasically if a trait has an associated type, and also a fn that puts additional bounds on that type /and/ uses them, then creating a trait object that doesn't fulfil those additional bounds ICEs rather than just removing the fn from the trait object (which is what happens if it doesn't sufficiently use those bounds).\n\nA possibly similar issue: http://is.gd/FxfDaH\n", "closed_by": {"login": "talchas", "id": 3578697, "node_id": "MDQ6VXNlcjM1Nzg2OTc=", "avatar_url": "https://avatars.githubusercontent.com/u/3578697?v=4", "gravatar_id": "", "url": "https://api.github.com/users/talchas", "html_url": "https://github.com/talchas", "followers_url": "https://api.github.com/users/talchas/followers", "following_url": "https://api.github.com/users/talchas/following{/other_user}", "gists_url": "https://api.github.com/users/talchas/gists{/gist_id}", "starred_url": "https://api.github.com/users/talchas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/talchas/subscriptions", "organizations_url": "https://api.github.com/users/talchas/orgs", "repos_url": "https://api.github.com/users/talchas/repos", "events_url": "https://api.github.com/users/talchas/events{/privacy}", "received_events_url": "https://api.github.com/users/talchas/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/27955/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/27955/timeline", "performed_via_github_app": null, "state_reason": "completed"}