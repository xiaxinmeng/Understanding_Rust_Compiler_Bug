{"url": "https://api.github.com/repos/rust-lang/rust/issues/51311", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/51311/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/51311/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/51311/events", "html_url": "https://github.com/rust-lang/rust/issues/51311", "id": 328771896, "node_id": "MDU6SXNzdWUzMjg3NzE4OTY=", "number": 51311, "title": "Misleading error message in case of ambiguous if blocks", "user": {"login": "vandenheuvel", "id": 20440137, "node_id": "MDQ6VXNlcjIwNDQwMTM3", "avatar_url": "https://avatars.githubusercontent.com/u/20440137?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vandenheuvel", "html_url": "https://github.com/vandenheuvel", "followers_url": "https://api.github.com/users/vandenheuvel/followers", "following_url": "https://api.github.com/users/vandenheuvel/following{/other_user}", "gists_url": "https://api.github.com/users/vandenheuvel/gists{/gist_id}", "starred_url": "https://api.github.com/users/vandenheuvel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vandenheuvel/subscriptions", "organizations_url": "https://api.github.com/users/vandenheuvel/orgs", "repos_url": "https://api.github.com/users/vandenheuvel/repos", "events_url": "https://api.github.com/users/vandenheuvel/events{/privacy}", "received_events_url": "https://api.github.com/users/vandenheuvel/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 235791, "node_id": "MDU6TGFiZWwyMzU3OTE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-diagnostics", "name": "A-diagnostics", "color": "f7e101", "default": false, "description": "Area: Messages for errors, warnings, and lints"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-06-02T19:45:51Z", "updated_at": "2019-04-19T23:06:53Z", "closed_at": "2019-04-19T23:06:53Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "For the following code, the compiler generates error [E0423](https://doc.rust-lang.org/nightly/error-index.html#E0423) on both stable and nightly in the playground:\r\n```rust\r\nfn main() {\r\n    let x = MyType { y: 1, };\r\n    \r\n    // Fails\r\n    if x == MyType { y: 1, } {\r\n    }\r\n    // Is ok\r\n    if x == (MyType { y: 1, }) {\r\n    }\r\n}\r\n\r\n#[derive(Eq, PartialEq)]\r\nstruct MyType {\r\n    y: u64,\r\n}\r\n```\r\n```\r\nerror: expected type, found `1`\r\n --> src/main.rs:5:25\r\n  |\r\n5 |     if x == MyType { y: 1, } {\r\n  |                         ^ expecting a type here because of type ascription\r\n\r\nerror[E0423]: expected value, found struct `MyType`\r\n --> src/main.rs:5:13\r\n  |\r\n5 |     if x == MyType { y: 1, } {\r\n  |             ^^^^^^ did you mean `MyType { /* fields */ }`?\r\n\r\nerror: aborting due to 2 previous errors\r\n\r\nFor more information about this error, try `rustc --explain E0423`.\r\n```\r\nI learned that there is a parsing ambiguity in the if-statement which fails to compile. But rather than producing an error message explaining this ambiguity, the compiler seems to assume one of the possibilities (\"the first accolade belongs to the if-statement\") and proceeds, encounting the error E0423 which it then displays.\r\n\r\nIt seems preferable for the compiler to stop at the point of encounting the ambiguity, with an error message explaining the problem. ", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/51311/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/51311/timeline", "performed_via_github_app": null, "state_reason": "completed"}