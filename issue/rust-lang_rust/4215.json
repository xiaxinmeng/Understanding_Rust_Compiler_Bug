{"url": "https://api.github.com/repos/rust-lang/rust/issues/4215", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/4215/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/4215/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/4215/events", "html_url": "https://github.com/rust-lang/rust/issues/4215", "id": 9358833, "node_id": "MDU6SXNzdWU5MzU4ODMz", "number": 4215, "title": "segfault with repr and regions in closure argument types", "user": {"login": "erickt", "id": 84711, "node_id": "MDQ6VXNlcjg0NzEx", "avatar_url": "https://avatars.githubusercontent.com/u/84711?v=4", "gravatar_id": "", "url": "https://api.github.com/users/erickt", "html_url": "https://github.com/erickt", "followers_url": "https://api.github.com/users/erickt/followers", "following_url": "https://api.github.com/users/erickt/following{/other_user}", "gists_url": "https://api.github.com/users/erickt/gists{/gist_id}", "starred_url": "https://api.github.com/users/erickt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/erickt/subscriptions", "organizations_url": "https://api.github.com/users/erickt/orgs", "repos_url": "https://api.github.com/users/erickt/repos", "events_url": "https://api.github.com/users/erickt/events{/privacy}", "received_events_url": "https://api.github.com/users/erickt/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2012-12-18T06:38:11Z", "updated_at": "2012-12-20T02:34:40Z", "closed_at": "2012-12-20T02:34:40Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "This code:\n\n```\nfn find(self: &r/~[int]) {\n    for self.each |i: &r/int| { }\n}\n\nfn main() { }\n```\n\nsegfaults with this message:\n\n```\nfoo.rs:2:13: 2:33 error: mismatched types: expected `&fn(&int)` but found `&fn(&r/int)` (lifetime mismatch)\nfoo.rs:2     for self.each |i: &r/int| { }\n                      ^~~~~~~~~~~~~~~~~~~~\nfoo.rs:1:25: 3:1 note: the lifetime &r as defined on the block at 1:25...\nfoo.rs:1 fn find(self: &r/~[int]) {\nfoo.rs:2     for self.each |i: &r/int| { }\nfoo.rs:3 }\n```\n\nAnd this stack trace:\n\n```\nProgram received signal EXC_BAD_ACCESS, Could not access memory.\nReason: KERN_INVALID_ADDRESS at address: 0x0000000000000028\n[Switching to process 1624 thread 0x20b]\n0x00000001000069f9 in repr::__extensions__::meth_5196::visit_uint::_af4de08865eac4::_05 ()\n(gdb) bt\n#0  0x00000001000069f9 in repr::__extensions__::meth_5196::visit_uint::_af4de08865eac4::_05 ()\n#1  0x00000001000a5fc0 in tydesc_7840 ()\n#2  0x000000010000696d in reflect::__extensions__::visit_uint_5194::_af4de08865eac4::_05 ()\n#3  0x000000010077bf0f in glue_visit_17777 ()\n#4  0x0000000100009a8b in repr::__extensions__::meth_5453::visit_enum_variant_field::_6f461884494ab1ea::_05 ()\n#5  0x0000000100009917 in reflect::__extensions__::visit_enum_variant_field_5451::_6f461884494ab1ea::_05 ()\n#6  0x00000001007ccaec in glue_visit_21338 ()\n#7  0x0000000100007bcf in repr::__extensions__::meth_5320::visit_box::_6f461884494ab1ea::_05 ()\n#8  0x00000001000079bd in reflect::__extensions__::visit_box_5311::_6f461884494ab1ea::_05 ()\n#9  0x00000001007ccd0e in glue_visit_21348 ()\n#10 0x0000000100009a8b in repr::__extensions__::meth_5453::visit_enum_variant_field::_6f461884494ab1ea::_05 ()\n#11 0x0000000100009917 in reflect::__extensions__::visit_enum_variant_field_5451::_6f461884494ab1ea::_05 ()\n#12 0x00000001007ccc55 in glue_visit_21338 ()\n#13 0x0000000100009a8b in repr::__extensions__::meth_5453::visit_enum_variant_field::_6f461884494ab1ea::_05 ()\n#14 0x0000000100759967 in reflect::__extensions__::visit_enum_variant_field_14084::_b3bcdf47e470ebad::_05 ()\n#15 0x00000001007cc6c2 in glue_visit_21334 ()\n#16 0x0000000100a4bf2b in sys::log_str_47148::anon::expr_fn_47151 ()\n#17 0x0000000100029f63 in io::with_bytes_writer::_c7f6b70459782d::_05 ()\n#18 0x000000010000527a in io::with_str_writer::_fa19ff9794566bf::_05 ()\n#19 0x0000000100a4bd1d in extfmt::rt::conv_poly_47145::_cb7cc93cdaf02b76::_05 ()\n#20 0x0000000100dc90a6 in util::ppaux::explain_region_and_span::_8e267ae565a8bd0::_05 ()\n#21 0x000000010097accd in util::ppaux::note_and_explain_region::_11e5b3117b81d3c3::_05 ()\n#22 0x000000010097a3d9 in middle::ty::note_and_explain_type_err::_90d9717cf47273e8::_05 ()\n#23 0x0000000100a9873c in middle::typeck::infer::__extensions__::meth_49392::type_error_message::_651e5c6796b0dd17::_05 ()\n#24 0x0000000100a18ab9 in middle::typeck::infer::__extensions__::meth_45007::report_mismatched_types::_01f592d3052c4bf::_05 ()\n#25 0x0000000100a4c908 in middle::typeck::check::demand::suptype::anon::expr_fn_47176 ()\n#26 0x0000000100a4c828 in middle::typeck::check::demand::suptype_with_fn::_54d7342aeea7ee20::_05 ()\n#27 0x0000000100aa1e6d in middle::typeck::check::check_expr_with_unifier::_df25c9e147a2e723::_05 ()\n#28 0x0000000100aaed7d in middle::typeck::check::check_expr_with_unifier::check_call_inner::anon::anon::expr_fn_49484 ()\n#29 0x0000000100aae166 in middle::typeck::check::check_expr_with_unifier::check_call_inner::_8f78e19e7543ad3::_05 ()\n#30 0x0000000100dea60a in __morestack ()\n```\n", "closed_by": {"login": "erickt", "id": 84711, "node_id": "MDQ6VXNlcjg0NzEx", "avatar_url": "https://avatars.githubusercontent.com/u/84711?v=4", "gravatar_id": "", "url": "https://api.github.com/users/erickt", "html_url": "https://github.com/erickt", "followers_url": "https://api.github.com/users/erickt/followers", "following_url": "https://api.github.com/users/erickt/following{/other_user}", "gists_url": "https://api.github.com/users/erickt/gists{/gist_id}", "starred_url": "https://api.github.com/users/erickt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/erickt/subscriptions", "organizations_url": "https://api.github.com/users/erickt/orgs", "repos_url": "https://api.github.com/users/erickt/repos", "events_url": "https://api.github.com/users/erickt/events{/privacy}", "received_events_url": "https://api.github.com/users/erickt/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/4215/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/4215/timeline", "performed_via_github_app": null, "state_reason": "completed"}