{"url": "https://api.github.com/repos/rust-lang/rust/issues/60222", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/60222/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/60222/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/60222/events", "html_url": "https://github.com/rust-lang/rust/issues/60222", "id": 436462681, "node_id": "MDU6SXNzdWU0MzY0NjI2ODE=", "number": 60222, "title": "Errors upgrading the turtle crate to the 2018 edition", "user": {"login": "sunjay", "id": 530939, "node_id": "MDQ6VXNlcjUzMDkzOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/530939?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sunjay", "html_url": "https://github.com/sunjay", "followers_url": "https://api.github.com/users/sunjay/followers", "following_url": "https://api.github.com/users/sunjay/following{/other_user}", "gists_url": "https://api.github.com/users/sunjay/gists{/gist_id}", "starred_url": "https://api.github.com/users/sunjay/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sunjay/subscriptions", "organizations_url": "https://api.github.com/users/sunjay/orgs", "repos_url": "https://api.github.com/users/sunjay/repos", "events_url": "https://api.github.com/users/sunjay/events{/privacy}", "received_events_url": "https://api.github.com/users/sunjay/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 980999956, "node_id": "MDU6TGFiZWw5ODA5OTk5NTY=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-edition-2018-lints", "name": "A-edition-2018-lints", "color": "f7e101", "default": false, "description": "Area: lints supporting the 2018 edition"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-04-24T02:02:40Z", "updated_at": "2019-04-24T02:45:45Z", "closed_at": "2019-04-24T02:45:45Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Hi,\r\nI was updating the [turtle](https://github.com/sunjay/turtle) crate to the 2018 edition (following the instructions in [the guide](https://doc.rust-lang.org/edition-guide/editions/transitioning-an-existing-project-to-a-new-edition.html)) and I got the error message below. It instructed me to open this issue, and I always do whatever rustc says, so here you go. :smile: \r\n\r\n```\r\n$ cargo fix --edition-idioms --features test --broken-code --allow-dirty\r\n    Checking turtle v1.0.0-rc.3 (/home/sunjay/Documents/projects/turtle)\r\nwarning: failed to automatically apply fixes suggested by rustc to crate `turtle`\r\n\r\nafter fixes were automatically applied the compiler reported errors within these files:\r\n\r\n  * src/color.rs\r\n  * src/lib.rs\r\n  * src/point.rs\r\n  * src/rand.rs\r\n  * src/speed.rs\r\n\r\nThis likely indicates a bug in either rustc or cargo itself,\r\nand we would appreciate a bug report! You're likely to see \r\na number of compiler warnings after this message which cargo\r\nattempted to fix but failed. If you could open an issue at\r\nhttps://github.com/rust-lang/rust/issues\r\nquoting the full output of this command we'd be very appreciative!\r\nNote that you may be able to make some more progress in the near-term\r\nfixing code with the `--broken-code` flag\r\n\r\nThe following errors were reported:\r\nerror[E0433]: failed to resolve: could not find `distributions` in `self`\r\n   --> src/rand.rs:197:11\r\n    |\r\n197 | use self::distributions::range::SampleRange;\r\n    |           ^^^^^^^^^^^^^ could not find `distributions` in `self`\r\n\r\nerror[E0432]: unresolved import `crate::rand_crate::*`\r\n   --> src/rand.rs:195:9\r\n    |\r\n195 | pub use crate::rand_crate::*;\r\n    |         ^^^^^^^^^^^^^^^^^^^^ Cannot glob-import a module into itself.\r\n\r\nerror[E0432]: unresolved import `crate::rand::random`\r\n  --> src/lib.rs:89:23\r\n   |\r\n89 | pub use crate::rand::{random, random_range};\r\n   |                       ^^^^^^ no `random` in `rand`\r\n\r\nerror[E0432]: unresolved imports `crate::rand::distributions`, `crate::rand::Rng`\r\n --> src/point.rs:5:5\r\n  |\r\n5 |     distributions::{Distribution, Standard},\r\n  |     ^^^^^^^^^^^^^ could not find `distributions` in `rand`\r\n6 |     RandomRange, Rng,\r\n  |                  ^^^ no `Rng` in `rand`\r\n\r\nerror[E0432]: unresolved imports `crate::rand::distributions`, `crate::rand::Rng`\r\n --> src/speed.rs:8:5\r\n  |\r\n8 |     distributions::{Distribution, Standard},\r\n  |     ^^^^^^^^^^^^^ could not find `distributions` in `rand`\r\n9 |     Rng,\r\n  |     ^^^ no `Rng` in `rand`\r\n\r\nerror[E0432]: unresolved imports `crate::rand::distributions`, `crate::rand::Rng`\r\n   --> src/color.rs:163:5\r\n    |\r\n163 |     distributions::{Distribution, Standard},\r\n    |     ^^^^^^^^^^^^^ could not find `distributions` in `rand`\r\n164 |     Rng,\r\n    |     ^^^ no `Rng` in `rand`\r\n\r\nerror[E0405]: cannot find trait `Rng` in this scope\r\n   --> src/rand.rs:200:24\r\n    |\r\n200 |     fn random_range<R: Rng>(rng: &mut R, low: Self, high: Self) -> Self;\r\n    |                        ^^^ not found in this scope\r\nhelp: possible candidates are found in other modules, you can import them into scope\r\n    |\r\n195 | use rand::Rng;\r\n    |\r\n195 | use rand::prelude::Rng;\r\n    |\r\n\r\nerror[E0405]: cannot find trait `SampleRange` in this scope\r\n   --> src/rand.rs:205:21\r\n    |\r\n205 |     T: PartialOrd + SampleRange,\r\n    |                     ^^^^^^^^^^^ not found in this scope\r\nhelp: possible candidate is found in another module, you can import it into scope\r\n    |\r\n195 | use rand::distributions::range::SampleRange;\r\n    |\r\n\r\nerror[E0405]: cannot find trait `Rng` in this scope\r\n   --> src/rand.rs:207:24\r\n    |\r\n207 |     fn random_range<R: Rng>(rng: &mut R, low: T, high: T) -> T {\r\n    |                        ^^^ not found in this scope\r\nhelp: possible candidates are found in other modules, you can import them into scope\r\n    |\r\n195 | use rand::Rng;\r\n    |\r\n195 | use rand::prelude::Rng;\r\n    |\r\n\r\nerror[E0425]: cannot find function `thread_rng` in this scope\r\n   --> src/rand.rs:236:19\r\n    |\r\n236 |     let mut rng = thread_rng();\r\n    |                   ^^^^^^^^^^ not found in this scope\r\nhelp: possible candidates are found in other modules, you can import them into scope\r\n    |\r\n195 | use rand::prelude::thread_rng;\r\n    |\r\n195 | use rand::thread_rng;\r\n    |\r\n\r\nerror[E0659]: `rand` is ambiguous (name vs any other name during import resolution)\r\n  --> src/lib.rs:51:5\r\n   |\r\n51 | use rand as rand_crate;\r\n   |     ^^^^ ambiguous name\r\n   |\r\n   = note: `rand` could refer to an extern crate passed with `--extern`\r\n   = help: use `::rand` to refer to this extern crate unambiguously\r\nnote: `rand` could also refer to the module defined here\r\n  --> src/lib.rs:83:1\r\n   |\r\n83 | pub mod rand;\r\n   | ^^^^^^^^^^^^^\r\n   = help: use `crate::rand` to refer to this module unambiguously\r\n\r\nwarning: unused import: `serde_json`\r\n  --> src/lib.rs:47:5\r\n   |\r\n47 | use serde_json;\r\n   |     ^^^^^^^^^^\r\n   |\r\n   = note: #[warn(unused_imports)] on by default\r\n\r\nwarning: unused import: `self::distributions::range::SampleRange`\r\n   --> src/rand.rs:197:5\r\n    |\r\n197 | use self::distributions::range::SampleRange;\r\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n\r\nerror: aborting due to 11 previous errors\r\n\r\nSome errors occurred: E0405, E0425, E0432, E0433, E0659.\r\nFor more information about an error, try `rustc --explain E0405`.\r\nOriginal diagnostics will follow.\r\n\r\nerror[E0432]: unresolved import `crate::rand_crate::*`\r\n   --> src/rand.rs:195:9\r\n    |\r\n195 | pub use crate::rand_crate::*;\r\n    |         ^^^^^^^^^^^^^^^^^^^^ Cannot glob-import a module into itself.\r\n\r\nerror[E0432]: unresolved import `crate::rand::random`\r\n  --> src/lib.rs:89:23\r\n   |\r\n89 | pub use crate::rand::{random, random_range};\r\n   |                       ^^^^^^ no `random` in `rand`\r\n\r\nerror[E0432]: unresolved imports `crate::rand::distributions`, `crate::rand::Rng`\r\n --> src/point.rs:5:5\r\n  |\r\n5 |     distributions::{Distribution, Standard},\r\n  |     ^^^^^^^^^^^^^ could not find `distributions` in `rand`\r\n6 |     RandomRange, Rng,\r\n  |                  ^^^ no `Rng` in `rand`\r\n\r\nerror[E0432]: unresolved imports `crate::rand::distributions`, `crate::rand::Rng`\r\n --> src/speed.rs:8:5\r\n  |\r\n8 |     distributions::{Distribution, Standard},\r\n  |     ^^^^^^^^^^^^^ could not find `distributions` in `rand`\r\n9 |     Rng,\r\n  |     ^^^ no `Rng` in `rand`\r\n\r\nerror[E0432]: unresolved imports `crate::rand::distributions`, `crate::rand::Rng`\r\n   --> src/color.rs:163:5\r\n    |\r\n163 |     distributions::{Distribution, Standard},\r\n    |     ^^^^^^^^^^^^^ could not find `distributions` in `rand`\r\n164 |     Rng,\r\n    |     ^^^ no `Rng` in `rand`\r\n\r\nwarning: failed to automatically apply fixes suggested by rustc to crate `turtle`\r\n\r\nafter fixes were automatically applied the compiler reported errors within these files:\r\n\r\n  * src/color.rs\r\n  * src/lib.rs\r\n  * src/point.rs\r\n  * src/rand.rs\r\n  * src/speed.rs\r\n\r\nThis likely indicates a bug in either rustc or cargo itself,\r\nand we would appreciate a bug report! You're likely to see \r\na number of compiler warnings after this message which cargo\r\nattempted to fix but failed. If you could open an issue at\r\nhttps://github.com/rust-lang/rust/issues\r\nquoting the full output of this command we'd be very appreciative!\r\nNote that you may be able to make some more progress in the near-term\r\nfixing code with the `--broken-code` flag\r\n\r\nThe following errors were reported:\r\nerror[E0432]: unresolved import `crate::rand_crate::*`\r\n   --> src/rand.rs:195:9\r\n    |\r\n195 | pub use crate::rand_crate::*;\r\n    |         ^^^^^^^^^^^^^^^^^^^^ Cannot glob-import a module into itself.\r\n\r\nerror[E0432]: unresolved import `crate::rand::random`\r\n  --> src/lib.rs:89:23\r\n   |\r\n89 | pub use crate::rand::{random, random_range};\r\n   |                       ^^^^^^ no `random` in `rand`\r\n\r\nerror[E0432]: unresolved imports `crate::rand::distributions`, `crate::rand::Rng`\r\n --> src/point.rs:5:5\r\n  |\r\n5 |     distributions::{Distribution, Standard},\r\n  |     ^^^^^^^^^^^^^ could not find `distributions` in `rand`\r\n6 |     RandomRange, Rng,\r\n  |                  ^^^ no `Rng` in `rand`\r\n\r\nerror[E0432]: unresolved imports `crate::rand::distributions`, `crate::rand::Rng`\r\n --> src/speed.rs:8:5\r\n  |\r\n8 |     distributions::{Distribution, Standard},\r\n  |     ^^^^^^^^^^^^^ could not find `distributions` in `rand`\r\n9 |     Rng,\r\n  |     ^^^ no `Rng` in `rand`\r\n\r\nerror[E0432]: unresolved imports `crate::rand::distributions`, `crate::rand::Rng`\r\n   --> src/color.rs:163:5\r\n    |\r\n163 |     distributions::{Distribution, Standard},\r\n    |     ^^^^^^^^^^^^^ could not find `distributions` in `rand`\r\n164 |     Rng,\r\n    |     ^^^ no `Rng` in `rand`\r\n\r\nerror[E0405]: cannot find trait `Rng` in this scope\r\n   --> src/rand.rs:200:24\r\n    |\r\n200 |     fn random_range<R: Rng>(rng: &mut R, low: Self, high: Self) -> Self;\r\n    |                        ^^^ not found in this scope\r\nhelp: possible candidates are found in other modules, you can import them into scope\r\n    |\r\n195 | use rand::Rng;\r\n    |\r\n195 | use rand::prelude::Rng;\r\n    |\r\n\r\nerror[E0405]: cannot find trait `SampleRange` in this scope\r\n   --> src/rand.rs:205:21\r\n    |\r\n205 |     T: PartialOrd + SampleRange,\r\n    |                     ^^^^^^^^^^^ not found in this scope\r\nhelp: possible candidate is found in another module, you can import it into scope\r\n    |\r\n195 | use rand::distributions::range::SampleRange;\r\n    |\r\n\r\nerror[E0405]: cannot find trait `Rng` in this scope\r\n   --> src/rand.rs:207:24\r\n    |\r\n207 |     fn random_range<R: Rng>(rng: &mut R, low: T, high: T) -> T {\r\n    |                        ^^^ not found in this scope\r\nhelp: possible candidates are found in other modules, you can import them into scope\r\n    |\r\n195 | use rand::Rng;\r\n    |\r\n195 | use rand::prelude::Rng;\r\n    |\r\n\r\nerror[E0425]: cannot find function `thread_rng` in this scope\r\n   --> src/rand.rs:236:19\r\n    |\r\n236 |     let mut rng = thread_rng();\r\n    |                   ^^^^^^^^^^ not found in this scope\r\nhelp: possible candidates are found in other modules, you can import them into scope\r\n    |\r\n195 | use rand::prelude::thread_rng;\r\n    |\r\n195 | use rand::thread_rng;\r\n    |\r\n\r\nerror[E0659]: `rand` is ambiguous (name vs any other name during import resolution)\r\n  --> src/lib.rs:51:5\r\n   |\r\n51 | use rand as rand_crate;\r\n   |     ^^^^ ambiguous name\r\n   |\r\n   = note: `rand` could refer to an extern crate passed with `--extern`\r\n   = help: use `::rand` to refer to this extern crate unambiguously\r\nnote: `rand` could also refer to the module defined here\r\n  --> src/lib.rs:83:1\r\n   |\r\n83 | pub mod rand;\r\n   | ^^^^^^^^^^^^^\r\n   = help: use `crate::rand` to refer to this module unambiguously\r\n\r\nerror: aborting due to 10 previous errors\r\n\r\nSome errors occurred: E0405, E0425, E0432, E0659.\r\nFor more information about an error, try `rustc --explain E0405`.\r\nOriginal diagnostics will follow.\r\n\r\nerror[E0405]: cannot find trait `Rng` in this scope\r\n   --> src/rand.rs:200:24\r\n    |\r\n200 |     fn random_range<R: Rng>(rng: &mut R, low: Self, high: Self) -> Self;\r\n    |                        ^^^ not found in this scope\r\nhelp: possible candidates are found in other modules, you can import them into scope\r\n    |\r\n195 | use rand::Rng;\r\n    |\r\n195 | use rand::prelude::Rng;\r\n    |\r\n\r\nerror[E0405]: cannot find trait `SampleRange` in this scope\r\n   --> src/rand.rs:205:21\r\n    |\r\n205 |     T: PartialOrd + SampleRange,\r\n    |                     ^^^^^^^^^^^ not found in this scope\r\nhelp: possible candidate is found in another module, you can import it into scope\r\n    |\r\n195 | use rand::distributions::range::SampleRange;\r\n    |\r\n\r\nerror[E0405]: cannot find trait `Rng` in this scope\r\n   --> src/rand.rs:207:24\r\n    |\r\n207 |     fn random_range<R: Rng>(rng: &mut R, low: T, high: T) -> T {\r\n    |                        ^^^ not found in this scope\r\nhelp: possible candidates are found in other modules, you can import them into scope\r\n    |\r\n195 | use rand::Rng;\r\n    |\r\n195 | use rand::prelude::Rng;\r\n    |\r\n\r\nerror[E0425]: cannot find function `thread_rng` in this scope\r\n   --> src/rand.rs:236:19\r\n    |\r\n236 |     let mut rng = thread_rng();\r\n    |                   ^^^^^^^^^^ not found in this scope\r\nhelp: possible candidates are found in other modules, you can import them into scope\r\n    |\r\n195 | use rand::prelude::thread_rng;\r\n    |\r\n195 | use rand::thread_rng;\r\n    |\r\n\r\nerror[E0659]: `rand` is ambiguous (name vs any other name during import resolution)\r\n  --> src/lib.rs:51:5\r\n   |\r\n51 | use rand as rand_crate;\r\n   |     ^^^^ ambiguous name\r\n   |\r\n   = note: `rand` could refer to an extern crate passed with `--extern`\r\n   = help: use `::rand` to refer to this extern crate unambiguously\r\nnote: `rand` could also refer to the module defined here\r\n  --> src/lib.rs:83:1\r\n   |\r\n83 | pub mod rand;\r\n   | ^^^^^^^^^^^^^\r\n   = help: use `crate::rand` to refer to this module unambiguously\r\n\r\nerror: aborting due to 10 previous errors\r\n\r\nSome errors occurred: E0405, E0425, E0432, E0659.\r\nFor more information about an error, try `rustc --explain E0405`.\r\nerror: Could not compile `turtle`.\r\nwarning: build failed, waiting for other jobs to finish...\r\nerror[E0432]: unresolved import `crate::rand_crate::*`\r\n   --> src/rand.rs:195:9\r\n    |\r\n195 | pub use crate::rand_crate::*;\r\n    |         ^^^^^^^^^^^^^^^^^^^^ Cannot glob-import a module into itself.\r\n\r\nerror[E0432]: unresolved import `crate::rand::random`\r\n  --> src/lib.rs:89:23\r\n   |\r\n89 | pub use crate::rand::{random, random_range};\r\n   |                       ^^^^^^ no `random` in `rand`\r\n\r\nerror[E0432]: unresolved imports `crate::rand::distributions`, `crate::rand::Rng`\r\n --> src/point.rs:5:5\r\n  |\r\n5 |     distributions::{Distribution, Standard},\r\n  |     ^^^^^^^^^^^^^ could not find `distributions` in `rand`\r\n6 |     RandomRange, Rng,\r\n  |                  ^^^ no `Rng` in `rand`\r\n\r\nerror[E0432]: unresolved imports `crate::rand::distributions`, `crate::rand::Rng`\r\n --> src/speed.rs:8:5\r\n  |\r\n8 |     distributions::{Distribution, Standard},\r\n  |     ^^^^^^^^^^^^^ could not find `distributions` in `rand`\r\n9 |     Rng,\r\n  |     ^^^ no `Rng` in `rand`\r\n\r\nerror[E0432]: unresolved imports `crate::rand::distributions`, `crate::rand::Rng`\r\n   --> src/color.rs:163:5\r\n    |\r\n163 |     distributions::{Distribution, Standard},\r\n    |     ^^^^^^^^^^^^^ could not find `distributions` in `rand`\r\n164 |     Rng,\r\n    |     ^^^ no `Rng` in `rand`\r\n\r\nerror[E0405]: cannot find trait `Rng` in this scope\r\n   --> src/rand.rs:200:24\r\n    |\r\n200 |     fn random_range<R: Rng>(rng: &mut R, low: Self, high: Self) -> Self;\r\n    |                        ^^^ not found in this scope\r\nhelp: possible candidates are found in other modules, you can import them into scope\r\n    |\r\n195 | use rand::Rng;\r\n    |\r\n195 | use rand::prelude::Rng;\r\n    |\r\n\r\nerror[E0405]: cannot find trait `SampleRange` in this scope\r\n   --> src/rand.rs:205:21\r\n    |\r\n205 |     T: PartialOrd + SampleRange,\r\n    |                     ^^^^^^^^^^^ not found in this scope\r\nhelp: possible candidate is found in another module, you can import it into scope\r\n    |\r\n195 | use rand::distributions::range::SampleRange;\r\n    |\r\n\r\nerror[E0405]: cannot find trait `Rng` in this scope\r\n   --> src/rand.rs:207:24\r\n    |\r\n207 |     fn random_range<R: Rng>(rng: &mut R, low: T, high: T) -> T {\r\n    |                        ^^^ not found in this scope\r\nhelp: possible candidates are found in other modules, you can import them into scope\r\n    |\r\n195 | use rand::Rng;\r\n    |\r\n195 | use rand::prelude::Rng;\r\n    |\r\n\r\nerror[E0425]: cannot find function `thread_rng` in this scope\r\n   --> src/rand.rs:236:19\r\n    |\r\n236 |     let mut rng = thread_rng();\r\n    |                   ^^^^^^^^^^ not found in this scope\r\nhelp: possible candidates are found in other modules, you can import them into scope\r\n    |\r\n195 | use rand::prelude::thread_rng;\r\n    |\r\n195 | use rand::thread_rng;\r\n    |\r\n\r\nerror[E0659]: `rand` is ambiguous (name vs any other name during import resolution)\r\n  --> src/lib.rs:51:5\r\n   |\r\n51 | use rand as rand_crate;\r\n   |     ^^^^ ambiguous name\r\n   |\r\n   = note: `rand` could refer to an extern crate passed with `--extern`\r\n   = help: use `::rand` to refer to this extern crate unambiguously\r\nnote: `rand` could also refer to the module defined here\r\n  --> src/lib.rs:83:1\r\n   |\r\n83 | pub mod rand;\r\n   | ^^^^^^^^^^^^^\r\n   = help: use `crate::rand` to refer to this module unambiguously\r\n\r\nerror: aborting due to 10 previous errors\r\n\r\nSome errors occurred: E0405, E0425, E0432, E0659.\r\nFor more information about an error, try `rustc --explain E0405`.\r\nerror: Could not compile `turtle`.\r\n\r\nTo learn more, run the command again with --verbose.\r\n```\r\n\r\nI think a lot of these have to do with me renaming the rand crate to `rand_crate` using `extern crate rand as rand_crate`. This caused a lot of issues because `cargo fix --edition` removed that line without adequately replacing it everywhere.\r\n\r\nHere's a link to the source code just *before* I started the upgrade: https://github.com/sunjay/turtle/tree/05a5fa118b154c5504bfc9fb770081c2846dd80d", "closed_by": {"login": "sunjay", "id": 530939, "node_id": "MDQ6VXNlcjUzMDkzOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/530939?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sunjay", "html_url": "https://github.com/sunjay", "followers_url": "https://api.github.com/users/sunjay/followers", "following_url": "https://api.github.com/users/sunjay/following{/other_user}", "gists_url": "https://api.github.com/users/sunjay/gists{/gist_id}", "starred_url": "https://api.github.com/users/sunjay/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sunjay/subscriptions", "organizations_url": "https://api.github.com/users/sunjay/orgs", "repos_url": "https://api.github.com/users/sunjay/repos", "events_url": "https://api.github.com/users/sunjay/events{/privacy}", "received_events_url": "https://api.github.com/users/sunjay/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/60222/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/60222/timeline", "performed_via_github_app": null, "state_reason": "completed"}