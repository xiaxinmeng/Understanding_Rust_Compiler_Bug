{"url": "https://api.github.com/repos/rust-lang/rust/issues/12393", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/12393/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/12393/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/12393/events", "html_url": "https://github.com/rust-lang/rust/issues/12393", "id": 27874086, "node_id": "MDU6SXNzdWUyNzg3NDA4Ng==", "number": 12393, "title": "Separate tests from code under test in libraries", "user": {"login": "milibopp", "id": 3098430, "node_id": "MDQ6VXNlcjMwOTg0MzA=", "avatar_url": "https://avatars.githubusercontent.com/u/3098430?v=4", "gravatar_id": "", "url": "https://api.github.com/users/milibopp", "html_url": "https://github.com/milibopp", "followers_url": "https://api.github.com/users/milibopp/followers", "following_url": "https://api.github.com/users/milibopp/following{/other_user}", "gists_url": "https://api.github.com/users/milibopp/gists{/gist_id}", "starred_url": "https://api.github.com/users/milibopp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/milibopp/subscriptions", "organizations_url": "https://api.github.com/users/milibopp/orgs", "repos_url": "https://api.github.com/users/milibopp/repos", "events_url": "https://api.github.com/users/milibopp/events{/privacy}", "received_events_url": "https://api.github.com/users/milibopp/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2014-02-19T13:22:46Z", "updated_at": "2020-02-12T16:05:19Z", "closed_at": "2015-01-23T02:46:17Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "The bug reported in #12383 made me aware of the convention that tests in non-std libraries often reside in the same file as the code under test. The privacy issue seen in that bug appears to be an immediate consequence of this convention. The convention also leads to pretty large source files that are imho difficult to handle.\n\nThus I would like to discuss whether this convention should be changed. To suggest a concrete alternative:\n- Separate the tests into logically coherent units that focus on testing a certain functionality, each of which resides in a separate file\n- Put all these test files into a dedicated test module that is flagged with one #[cfg(test)] in `lib.rs`; the test module may have substructure depending on the complexity of the library being tested\n", "closed_by": {"login": "steveklabnik", "id": 27786, "node_id": "MDQ6VXNlcjI3Nzg2", "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/steveklabnik", "html_url": "https://github.com/steveklabnik", "followers_url": "https://api.github.com/users/steveklabnik/followers", "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}", "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}", "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions", "organizations_url": "https://api.github.com/users/steveklabnik/orgs", "repos_url": "https://api.github.com/users/steveklabnik/repos", "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}", "received_events_url": "https://api.github.com/users/steveklabnik/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/12393/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/12393/timeline", "performed_via_github_app": null, "state_reason": "completed"}