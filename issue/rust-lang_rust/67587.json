{"url": "https://api.github.com/repos/rust-lang/rust/issues/67587", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/67587/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/67587/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/67587/events", "html_url": "https://github.com/rust-lang/rust/issues/67587", "id": 542148503, "node_id": "MDU6SXNzdWU1NDIxNDg1MDM=", "number": 67587, "title": "Cross-compiling from Fedora to Windows using MinGW64", "user": {"login": "allquixotic", "id": 322644, "node_id": "MDQ6VXNlcjMyMjY0NA==", "avatar_url": "https://avatars.githubusercontent.com/u/322644?v=4", "gravatar_id": "", "url": "https://api.github.com/users/allquixotic", "html_url": "https://github.com/allquixotic", "followers_url": "https://api.github.com/users/allquixotic/followers", "following_url": "https://api.github.com/users/allquixotic/following{/other_user}", "gists_url": "https://api.github.com/users/allquixotic/gists{/gist_id}", "starred_url": "https://api.github.com/users/allquixotic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/allquixotic/subscriptions", "organizations_url": "https://api.github.com/users/allquixotic/orgs", "repos_url": "https://api.github.com/users/allquixotic/repos", "events_url": "https://api.github.com/users/allquixotic/events{/privacy}", "received_events_url": "https://api.github.com/users/allquixotic/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 123109, "node_id": "MDU6TGFiZWwxMjMxMDk=", "url": "https://api.github.com/repos/rust-lang/rust/labels/O-windows", "name": "O-windows", "color": "6e6ec0", "default": false, "description": "Operating system: Windows"}, {"id": 123110, "node_id": "MDU6TGFiZWwxMjMxMTA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/O-linux", "name": "O-linux", "color": "6e6ec0", "default": false, "description": "Operating system: Linux"}, {"id": 167285428, "node_id": "MDU6TGFiZWwxNjcyODU0Mjg=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-cross", "name": "A-cross", "color": "f7e101", "default": false, "description": "Area: Cross compilation"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 266005714, "node_id": "MDU6TGFiZWwyNjYwMDU3MTQ=", "url": "https://api.github.com/repos/rust-lang/rust/labels/O-windows-gnu", "name": "O-windows-gnu", "color": "6e6ec0", "default": false, "description": "Toolchain: GNU, Operating system: Windows"}, {"id": 632453790, "node_id": "MDU6TGFiZWw2MzI0NTM3OTA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-target-specs", "name": "A-target-specs", "color": "f7e101", "default": false, "description": "Area: compile-target specifications"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2019-12-24T14:44:06Z", "updated_at": "2020-04-03T14:20:22Z", "closed_at": "2020-04-03T14:20:22Z", "author_association": "NONE", "active_lock_reason": null, "body": "On Fedora and Red Hat-derived systems (CentOS, etc.) there is a cross-compilation toolchain with the compiler triplet `x86_64-w64-mingw32`. Here are a few facts about it:\r\n\r\n - It has been supported at least since RHEL 7 / CentOS 7 and for about a dozen releases of Fedora\r\n - The packages are regularly updated\r\n - Fedora ships many free and open source software middleware packages as installable binaries via `yum` / `dnf`; installing these packages puts the appropriate headers, link libraries, pkg-config files, etc. into the right place within the \"sys-root\" mingw64, which lives in `/usr/x86_64-w64-mingw32/sys-root`.\r\n - Fedora offers several \"wrapper\" commands that drive well-known build systems. They have `mingw64-configure`, which automatically applies arguments and environment variables so GNU autotools can compile seamlessly with this toolchain. They have `mingw64-cmake`, for cmake. And they have `mingw64-env`, which just exports about 30 environment variables to try to make a \"generic\" build system aware of this toolchain. It exports `PKG_CONFIG_PATH`, `CC`, `CPP`, `CXX`, `DLLTOOL`, `GCC`, `WINDRES`, `STRIP`, `XML2_CONFIG`, `CXXFILT`, `CXX`, `LD`, `RANLIB`, and so on. For many build systems other than rust, this is enough to get them compiling native code even without explicit support in the build system for the compiler triplet.\r\n - The built binaries produce native code for 64-bit Windows operating systems, but there's also a toolchain available for 32-bit Windows with a different compiler triplet (starts with i686).\r\n\r\nI've found this toolchain very convenient for native code in the past, because most build systems can just treat this toolchain \"as if it were Linux\" (with some caveats, like possibly needing to run `windres` and other Windows-only tools) and 95% of C/C++ code that gives even a basic consideration to cross-platform support will just compile and work, especially if it depends on deliberately cross-platform and Windows-friendly lower level libraries for the heavy lifting.\r\n\r\nOn Fedora 31 using rustc 1.40 for the native Linux system from `rustup` , `rustc --print target-list` doesn't list this compiler triplet. Can support be added for it without too much work? I think rustc already supports **a** MinGW toolchain; it's just that the current MinGW toolchain support expects the system compiling the code to be Windows as well. In my case, the system doing the compiling would be a modern 64-bit Linux distro and the target system of the built binaries would be 64-bit Windows.", "closed_by": {"login": "allquixotic", "id": 322644, "node_id": "MDQ6VXNlcjMyMjY0NA==", "avatar_url": "https://avatars.githubusercontent.com/u/322644?v=4", "gravatar_id": "", "url": "https://api.github.com/users/allquixotic", "html_url": "https://github.com/allquixotic", "followers_url": "https://api.github.com/users/allquixotic/followers", "following_url": "https://api.github.com/users/allquixotic/following{/other_user}", "gists_url": "https://api.github.com/users/allquixotic/gists{/gist_id}", "starred_url": "https://api.github.com/users/allquixotic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/allquixotic/subscriptions", "organizations_url": "https://api.github.com/users/allquixotic/orgs", "repos_url": "https://api.github.com/users/allquixotic/repos", "events_url": "https://api.github.com/users/allquixotic/events{/privacy}", "received_events_url": "https://api.github.com/users/allquixotic/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/67587/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/67587/timeline", "performed_via_github_app": null, "state_reason": "completed"}