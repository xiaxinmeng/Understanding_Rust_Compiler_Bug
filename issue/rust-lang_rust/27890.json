{"url": "https://api.github.com/repos/rust-lang/rust/issues/27890", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/27890/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/27890/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/27890/events", "html_url": "https://github.com/rust-lang/rust/issues/27890", "id": 101723374, "node_id": "MDU6SXNzdWUxMDE3MjMzNzQ=", "number": 27890, "title": "ICE when trying to make a static closure", "user": {"login": "steveklabnik", "id": 27786, "node_id": "MDQ6VXNlcjI3Nzg2", "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/steveklabnik", "html_url": "https://github.com/steveklabnik", "followers_url": "https://api.github.com/users/steveklabnik/followers", "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}", "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}", "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions", "organizations_url": "https://api.github.com/users/steveklabnik/orgs", "repos_url": "https://api.github.com/users/steveklabnik/repos", "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}", "received_events_url": "https://api.github.com/users/steveklabnik/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}, {"id": 122406831, "node_id": "MDU6TGFiZWwxMjI0MDY4MzE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-closures", "name": "A-closures", "color": "f7e101", "default": false, "description": "Area: closures (`|args| { .. }`)"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2015-08-18T18:43:18Z", "updated_at": "2015-10-01T14:54:44Z", "closed_at": "2015-10-01T14:54:44Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "After some discussing about static closures on IRC, I was messing around and found an ICE:\n\n```\nstatic plus_one: &'static Fn(i32) -> i32 = (&|x: i32| { x + 1 }) as &'static Fn(i32) -> i32;\n```\n\n```\n error: internal compiler error: coherence failed to report ambiguity: cannot locate the impl of the trait `core::ops::Fn<(i32,)>` for the type `[closure@hello.rs:1:46: 1:64]`\nhello.rs:1 static plus_one: &'static Fn(i32) -> i32 = (&|x: i32| { x + 1 }) as &'static Fn(i32) -> i32;\n                                                      ^~~~~~~~~~~~~~~~~~~~~\n\nthread 'rustc' panicked at 'Box<Any>', ../src/libsyntax/diagnostic.rs:176\n\nstack backtrace:\n   1:     0x7fb188388719 - sys::backtrace::write::h0942de78b6c02817K8r\n   2:     0x7fb1883905a6 - panicking::on_panic::h3f23f9d0b5f4c91bu9w\n   3:     0x7fb18835668e - rt::unwind::begin_unwind_inner::h2844b8c5e81e79558Bw\n   4:     0x7fb185364717 - rt::unwind::begin_unwind::h18145712027808195836\n   5:     0x7fb1853646d6 - diagnostic::SpanHandler::span_bug::h8e44e4841a51abaeu0A\n   6:     0x7fb18634d25a - middle::traits::error_reporting::report_fulfillment_errors::h333f72cab9295933RyR\n   7:     0x7fb1873e70c5 - check::FnCtxt<'a, 'tcx>::select_all_obligations_or_error::hcab104bc898397548ur\n   8:     0x7fb1873e4b83 - check::regionck::Rcx<'a, 'tcx>::visit_region_obligations::hfa6295200248132aJBc\n   9:     0x7fb1873e65f0 - check::regionck::Rcx<'a, 'tcx>::visit_fn_body::hef046c27196f1a04oyc\n  10:     0x7fb1873ec73e - visit::walk_expr::h8219604655069971555\n  11:     0x7fb1873e9ca6 - check::regionck::visit_expr::h7ba995ff7bd03dafSXc\n  12:     0x7fb1873e9ee5 - check::regionck::visit_expr::h7ba995ff7bd03dafSXc\n  13:     0x7fb1873ea018 - check::regionck::visit_expr::h7ba995ff7bd03dafSXc\n  14:     0x7fb1873ec31c - visit::walk_expr::h8219604655069971555\n  15:     0x7fb1873e9a8d - check::regionck::visit_expr::h7ba995ff7bd03dafSXc\n  16:     0x7fb1873e4778 - check::regionck::regionck_expr::h31bdba3ccd579413Aoc\n  17:     0x7fb18748b19b - check::check_const::hea0d071c5597530dvcu\n  18:     0x7fb18747941e - check::check_item_type::haa6e26c4456d14ddoKp\n  19:     0x7fb18753a1e2 - check_crate::hc9d8771979c9f6f1ZzE\n  20:     0x7fb1888d2ffe - driver::phase_3_run_analysis_passes::closure.20596\n  21:     0x7fb1888b1e05 - middle::ty::ctxt<'tcx>::create_and_enter::h9049188843559879450\n  22:     0x7fb1888acf5d - driver::phase_3_run_analysis_passes::h10313786347949334605\n  23:     0x7fb188890676 - driver::compile_input::h68da15dd21986404Tba\n  24:     0x7fb1889fb7eb - run_compiler::h707077bbe9100331Obc\n  25:     0x7fb1889f90b7 - boxed::F.FnBox<A>::call_box::h6790869519760498004\n  26:     0x7fb1889f8b24 - rt::unwind::try::try_fn::h1844525071116418565\n  27:     0x7fb188390148 - __rust_try\n  28:     0x7fb18837ca62 - rt::unwind::try::inner_try::h45702ba1ad1620941xw\n  29:     0x7fb1889f8cb8 - boxed::F.FnBox<A>::call_box::h11351074772415591031\n  30:     0x7fb18838f593 - sys::thread::Thread::new::thread_start::h66ead7b2912d4f30OHv\n  31:     0x7fb181fa30a3 - start_thread\n  32:     0x7fb18801204c - clone\n  33:                0x0 - <unknown>\n\n```\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/27890/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/27890/timeline", "performed_via_github_app": null, "state_reason": "completed"}