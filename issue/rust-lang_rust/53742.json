{"url": "https://api.github.com/repos/rust-lang/rust/issues/53742", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/53742/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/53742/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/53742/events", "html_url": "https://github.com/rust-lang/rust/issues/53742", "id": 354429028, "node_id": "MDU6SXNzdWUzNTQ0MjkwMjg=", "number": 53742, "title": "SIGSEGV compiling bootstrap on aarch64-unknown-linux-gnu since LLVM 7", "user": {"login": "parched", "id": 5975405, "node_id": "MDQ6VXNlcjU5NzU0MDU=", "avatar_url": "https://avatars.githubusercontent.com/u/5975405?v=4", "gravatar_id": "", "url": "https://api.github.com/users/parched", "html_url": "https://github.com/parched", "followers_url": "https://api.github.com/users/parched/followers", "following_url": "https://api.github.com/users/parched/following{/other_user}", "gists_url": "https://api.github.com/users/parched/gists{/gist_id}", "starred_url": "https://api.github.com/users/parched/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/parched/subscriptions", "organizations_url": "https://api.github.com/users/parched/orgs", "repos_url": "https://api.github.com/users/parched/repos", "events_url": "https://api.github.com/users/parched/events{/privacy}", "received_events_url": "https://api.github.com/users/parched/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 262252628, "node_id": "MDU6TGFiZWwyNjIyNTI2Mjg=", "url": "https://api.github.com/repos/rust-lang/rust/labels/regression-from-stable-to-beta", "name": "regression-from-stable-to-beta", "color": "e4008a", "default": false, "description": "Performance or correctness regression from stable to beta."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2018-08-27T18:36:39Z", "updated_at": "2018-09-05T20:55:53Z", "closed_at": "2018-09-05T20:55:52Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Building Rust fails while compiling bootstrap. I managed to narrow it down while compiling beta (5c5be098e92b28c3cacabf73e64e4dfff7e9e9da) and setting `build.rustc`. \r\n> rustc 1.29.0-nightly (64f7de921 2018-07-12)\r\n\r\ndoesn't work\r\n> rustc 1.29.0-nightly (e5f6498d3 2018-07-10)\r\n\r\ndoes work. So I believe it's a bug in LLVM 7\r\n\r\nMaybe it's fixed by https://github.com/llvm-mirror/llvm/commit/57aa5d99a1d5a3a5836691cbc21cd228a5b3d379 in LLVM 7.0 RC2 but I haven't been able to try it yet.\r\n\r\n```\r\nThread 30 \"rustc\" received signal SIGSEGV, Segmentation fault.\r\n[Switching to Thread 0x7fae5bfed0 (LWP 14385)]\r\n0x0000007fbb23f5b0 in llvm::AArch64RegisterBankInfo::getInstrMapping(llvm::MachineInstr const&) const ()\r\n   from /home/jagduley/.rustup/toolchains/nightly-2018-07-13-aarch64-unknown-linux-gnu/lib/rustlib/aarch64-unknown-linux-gnu/codegen-backends/librustc_codegen_llvm-llvm.so\r\n(gdb) bt\r\n#0  0x0000007fbb23f5b0 in llvm::AArch64RegisterBankInfo::getInstrMapping(llvm::MachineInstr const&) const ()\r\n   from /home/jagduley/.rustup/toolchains/nightly-2018-07-13-aarch64-unknown-linux-gnu/lib/rustlib/aarch64-unknown-linux-gnu/codegen-backends/librustc_codegen_llvm-llvm.so\r\n#1  0x0000007fbb2832c4 in llvm::RegBankSelect::assignInstr(llvm::MachineInstr&) ()\r\n   from /home/jagduley/.rustup/toolchains/nightly-2018-07-13-aarch64-unknown-linux-gnu/lib/rustlib/aarch64-unknown-linux-gnu/codegen-backends/librustc_codegen_llvm-llvm.so\r\n#2  0x0000007fbb28353c in llvm::RegBankSelect::runOnMachineFunction(llvm::MachineFunction&) ()\r\n   from /home/jagduley/.rustup/toolchains/nightly-2018-07-13-aarch64-unknown-linux-gnu/lib/rustlib/aarch64-unknown-linux-gnu/codegen-backends/librustc_codegen_llvm-llvm.so\r\nBacktrace stopped: previous frame identical to this frame (corrupt stack?)\r\n```\r\n\r\nIt looks similar to https://github.com/rust-lang/rust/issues/52884 but that has been fixed as I understand (I also get the problem using 'rustc 1.29.0-beta.7 (49720ea9c 2018-08-26)')\r\n\r\nFull log\r\n```\r\n./x.py build --config config.toml -vvv\r\nUpdating only changed submodules\r\nSubmodules updated in 0.52 seconds\r\nrunning: /home/jagduley/.cargo/bin/cargo build --manifest-path /home/jagduley/dev/rust/src/bootstrap/Cargo.toml --verbose --verbose\r\n       Fresh unicode-xid v0.1.0                                                                                                                                       \r\n       Fresh cc v1.0.18\r\n       Fresh dtoa v0.4.3\r\n       Fresh cfg-if v0.1.4\r\n       Fresh ordermap v0.3.5\r\n       Fresh fixedbitset v0.1.9\r\n       Fresh itoa v0.4.2\r\n       Fresh libc v0.2.42\r\n       Fresh getopts v0.2.17\r\n       Fresh build_helper v0.1.0 (file:///home/jagduley/dev/rust/src/build_helper)\r\n       Fresh lazy_static v0.2.11\r\n       Fresh proc-macro2 v0.4.8\r\n       Fresh cmake v0.1.31\r\n       Fresh petgraph v0.4.12\r\n       Fresh num_cpus v1.8.0\r\n       Fresh filetime v0.2.1\r\n       Fresh time v0.1.40\r\n       Fresh quote v0.6.3\r\n       Fresh serde v1.0.70\r\n       Fresh syn v0.14.4\r\n       Fresh toml v0.4.6\r\n       Fresh serde_json v1.0.24\r\n       Fresh serde_derive v1.0.70\r\n   Compiling bootstrap v0.0.0 (file:///home/jagduley/dev/rust/src/bootstrap)\r\n     Running `/home/jagduley/.cargo/bin/rustc --crate-name bootstrap bootstrap/lib.rs --crate-type lib --emit=dep-info,link -C debug-assertions=off -C overflow-checks=on -C metadata=e19c4c4543ff4d18 -C extra-filename=-e19c4c4543ff4d18 --out-dir /home/jagduley/dev/rust/build/bootstrap/debug/deps -C incremental=/home/jagduley/dev/rust/build/bootstrap/debug/incremental -L dependency=/home/jagduley/dev/rust/build/bootstrap/debug/deps --extern build_helper=/home/jagduley/dev/rust/build/bootstrap/debug/deps/libbuild_helper-b44f9ab7b190a804.rlib --extern cc=/home/jagduley/dev/rust/build/bootstrap/debug/deps/libcc-f225328a0f59f427.rlib --extern cmake=/home/jagduley/dev/rust/build/bootstrap/debug/deps/libcmake-6d38298082c5ac11.rlib --extern filetime=/home/jagduley/dev/rust/build/bootstrap/debug/deps/libfiletime-d866b52d4d8fa9de.rlib --extern getopts=/home/jagduley/dev/rust/build/bootstrap/debug/deps/libgetopts-83fd952ad8e839c3.rlib --extern lazy_static=/home/jagduley/dev/rust/build/bootstrap/debug/deps/liblazy_static-c9b1f81e8931854f.rlib --extern libc=/home/jagduley/dev/rust/build/bootstrap/debug/deps/liblibc-27b3233e806059ac.rlib --extern num_cpus=/home/jagduley/dev/rust/build/bootstrap/debug/deps/libnum_cpus-94059903430f7c1c.rlib --extern petgraph=/home/jagduley/dev/rust/build/bootstrap/debug/deps/libpetgraph-8a98459b4b2f5b60.rlib --extern serde=/home/jagduley/dev/rust/build/bootstrap/debug/deps/libserde-4f813b6970c76624.rlib --extern serde_derive=/home/jagduley/dev/rust/build/bootstrap/debug/deps/libserde_derive-343eae4f2fca76fb.so --extern serde_json=/home/jagduley/dev/rust/build/bootstrap/debug/deps/libserde_json-9220186384b1645f.rlib --extern time=/home/jagduley/dev/rust/build/bootstrap/debug/deps/libtime-3ecd8fdba96f8f4b.rlib --extern toml=/home/jagduley/dev/rust/build/bootstrap/debug/deps/libtoml-2aca51dcd5fe933a.rlib -Cdebuginfo=2`\r\nerror: Could not compile `bootstrap`.\r\n\r\nCaused by:\r\n  process didn't exit successfully: `/home/jagduley/.cargo/bin/rustc --crate-name bootstrap bootstrap/lib.rs --crate-type lib --emit=dep-info,link -C debug-assertions=off -C overflow-checks=on -C metadata=e19c4c4543ff4d18 -C extra-filename=-e19c4c4543ff4d18 --out-dir /home/jagduley/dev/rust/build/bootstrap/debug/deps -C incremental=/home/jagduley/dev/rust/build/bootstrap/debug/incremental -L dependency=/home/jagduley/dev/rust/build/bootstrap/debug/deps --extern build_helper=/home/jagduley/dev/rust/build/bootstrap/debug/deps/libbuild_helper-b44f9ab7b190a804.rlib --extern cc=/home/jagduley/dev/rust/build/bootstrap/debug/deps/libcc-f225328a0f59f427.rlib --extern cmake=/home/jagduley/dev/rust/build/bootstrap/debug/deps/libcmake-6d38298082c5ac11.rlib --extern filetime=/home/jagduley/dev/rust/build/bootstrap/debug/deps/libfiletime-d866b52d4d8fa9de.rlib --extern getopts=/home/jagduley/dev/rust/build/bootstrap/debug/deps/libgetopts-83fd952ad8e839c3.rlib --extern lazy_static=/home/jagduley/dev/rust/build/bootstrap/debug/deps/liblazy_static-c9b1f81e8931854f.rlib --extern libc=/home/jagduley/dev/rust/build/bootstrap/debug/deps/liblibc-27b3233e806059ac.rlib --extern num_cpus=/home/jagduley/dev/rust/build/bootstrap/debug/deps/libnum_cpus-94059903430f7c1c.rlib --extern petgraph=/home/jagduley/dev/rust/build/bootstrap/debug/deps/libpetgraph-8a98459b4b2f5b60.rlib --extern serde=/home/jagduley/dev/rust/build/bootstrap/debug/deps/libserde-4f813b6970c76624.rlib --extern serde_derive=/home/jagduley/dev/rust/build/bootstrap/debug/deps/libserde_derive-343eae4f2fca76fb.so --extern serde_json=/home/jagduley/dev/rust/build/bootstrap/debug/deps/libserde_json-9220186384b1645f.rlib --extern time=/home/jagduley/dev/rust/build/bootstrap/debug/deps/libtime-3ecd8fdba96f8f4b.rlib --extern toml=/home/jagduley/dev/rust/build/bootstrap/debug/deps/libtoml-2aca51dcd5fe933a.rlib -Cdebuginfo=2` (signal: 11, SIGSEGV: invalid memory reference)\r\nTraceback (most recent call last):\r\n  File \"./x.py\", line 20, in <module>\r\n    bootstrap.main()\r\n  File \"/home/jagduley/dev/rust/src/bootstrap/bootstrap.py\", line 843, in main\r\n    bootstrap(help_triggered)\r\n  File \"/home/jagduley/dev/rust/src/bootstrap/bootstrap.py\", line 819, in bootstrap\r\n    build.build_bootstrap()\r\n  File \"/home/jagduley/dev/rust/src/bootstrap/bootstrap.py\", line 646, in build_bootstrap\r\n    run(args, env=env, verbose=self.verbose)\r\n  File \"/home/jagduley/dev/rust/src/bootstrap/bootstrap.py\", line 148, in run\r\n    raise RuntimeError(err)\r\nRuntimeError: failed to run: /home/jagduley/.cargo/bin/cargo build --manifest-path /home/jagduley/dev/rust/src/bootstrap/Cargo.toml --verbose --verbose\r\n```", "closed_by": {"login": "parched", "id": 5975405, "node_id": "MDQ6VXNlcjU5NzU0MDU=", "avatar_url": "https://avatars.githubusercontent.com/u/5975405?v=4", "gravatar_id": "", "url": "https://api.github.com/users/parched", "html_url": "https://github.com/parched", "followers_url": "https://api.github.com/users/parched/followers", "following_url": "https://api.github.com/users/parched/following{/other_user}", "gists_url": "https://api.github.com/users/parched/gists{/gist_id}", "starred_url": "https://api.github.com/users/parched/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/parched/subscriptions", "organizations_url": "https://api.github.com/users/parched/orgs", "repos_url": "https://api.github.com/users/parched/repos", "events_url": "https://api.github.com/users/parched/events{/privacy}", "received_events_url": "https://api.github.com/users/parched/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/53742/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/53742/timeline", "performed_via_github_app": null, "state_reason": "completed"}