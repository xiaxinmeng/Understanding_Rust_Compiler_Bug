{"url": "https://api.github.com/repos/rust-lang/rust/issues/31676", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/31676/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/31676/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/31676/events", "html_url": "https://github.com/rust-lang/rust/issues/31676", "id": 133707711, "node_id": "MDU6SXNzdWUxMzM3MDc3MTE=", "number": 31676, "title": "error: internal compiler error: Error constructed but not emitted", "user": {"login": "ferjm", "id": 480202, "node_id": "MDQ6VXNlcjQ4MDIwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/480202?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ferjm", "html_url": "https://github.com/ferjm", "followers_url": "https://api.github.com/users/ferjm/followers", "following_url": "https://api.github.com/users/ferjm/following{/other_user}", "gists_url": "https://api.github.com/users/ferjm/gists{/gist_id}", "starred_url": "https://api.github.com/users/ferjm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ferjm/subscriptions", "organizations_url": "https://api.github.com/users/ferjm/orgs", "repos_url": "https://api.github.com/users/ferjm/repos", "events_url": "https://api.github.com/users/ferjm/events{/privacy}", "received_events_url": "https://api.github.com/users/ferjm/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2016-02-15T13:07:44Z", "updated_at": "2016-05-03T14:09:28Z", "closed_at": "2016-05-03T14:09:28Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am seeing the following panic:\n\n```\n\nCompiling foxbox_users v0.1.0 (file:///Volumes/mozilladev/foxbox/users-ferjm)\nerror: internal compiler error: Error constructed but not emitted\nerror: internal compiler error: Error constructed but not emitted\nerror: internal compiler error: unexpected panic\nnote: the compiler unexpectedly panicked. this is a bug.\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports\nthread 'rustc' panicked at 'explicit panic', ../src/libsyntax/errors/mod.rs:360\nstack backtrace:\n   1:        0x10a9bd488 - sys::backtrace::tracing::imp::write::h268482af15af0a80Y8t\n   2:        0x10a9c3555 - panicking::default_handler::_$u7b$$u7b$closure$u7d$$u7d$::closure.42271\n   3:        0x10a9c3035 - panicking::default_handler::h97bc664f7e2bfeb5Ocy\n   4:        0x10a98bf16 - sys_common::unwind::begin_unwind_inner::h98c0975c9b6b2fa0Zbt\n   5:        0x107ef8084 - sys_common::unwind::begin_unwind::h13146085605143757291\n   6:        0x107eff9f4 - errors::DiagnosticBuilder<'a>.Drop::drop::h74630777c3a3e7973Bd\n   7:        0x10e11fcfc - syntax..errors..DiagnosticBuilder::drop.13872::he841adc067eec1b4\n   8:        0x10e122a16 - core..result..Result<syntax..ptr..P<syntax..ast..Block>, syntax..errors..DiagnosticBuilder>::drop.14045::ha78fca7fe0fa1afa\n   9:        0x10e1229a8 - result::Result<T, E>::ok::h8598607649825527066\n  10:        0x10e11f977 - parse::Test.Parse<bool>::parse::h5bc3db50069b1db6cea\n  11:        0x10e11c26d - parse::DescribeState.Parse<(codemap..Span, &'a mut base..ExtCtxt<'b>, Option<ast..Ident>)>::parse::h157da640af2ff6cfaia\n  12:        0x10e0e8d90 - describe::describe::h47eeebe418369c49Sca\n  13:        0x10e0e905d - fn(&mut syntax..ext..base..ExtCtxt, syntax..codemap..Span, syntax..ast..Ident, collections..vec..Vec<syntax..ast..TokenTree>) .> Box<syntax..ext..base..MacResult> $u7b$describe..describe$u7d$::fn_pointer_shim.12515::h11bf6433a9f5c463\n  14:        0x10e0e8fa5 - ext::base::F.IdentMacroExpander::expand::h2255893400289716387\n  15:        0x108184e48 - ext::expand::expand_item_mac::hc9348d4e1cc575a7O29\n  16:        0x108177c6d - ext::expand::expand_annotatable::h588765912514d47ejxa\n  17:        0x1081748b8 - ext::expand::expand_item::h7a48d46a3d280a782Z9\n  18:        0x108180de9 - fold::noop_fold_mod::h5514942419128523883\n  19:        0x10817abba - ext::expand::expand_item_underscore::hc3669d26e238942aD09\n  20:        0x1081b1c4b - fold::noop_fold_item_simple::h11240569791642338683\n  21:        0x1081b179f - fold::noop_fold_item::h6562330027966964896\n  22:        0x108178f4a - ext::expand::expand_annotatable::h588765912514d47ejxa\n  23:        0x1081748b8 - ext::expand::expand_item::h7a48d46a3d280a782Z9\n  24:        0x108180de9 - fold::noop_fold_mod::h5514942419128523883\n  25:        0x10817abba - ext::expand::expand_item_underscore::hc3669d26e238942aD09\n  26:        0x1081b1c4b - fold::noop_fold_item_simple::h11240569791642338683\n  27:        0x1081b179f - fold::noop_fold_item::h6562330027966964896\n  28:        0x108178f4a - ext::expand::expand_annotatable::h588765912514d47ejxa\n  29:        0x1081748b8 - ext::expand::expand_item::h7a48d46a3d280a782Z9\n  30:        0x1081badd3 - ext::expand::expand_crate::h30ce0ee1f7e97002nVa\n  31:        0x10653ad22 - driver::phase_2_configure_and_expand::_$u7b$$u7b$closure$u7d$$u7d$::closure.32913\n  32:        0x1064d1404 - driver::phase_2_configure_and_expand::h68ab6c933fccd499hza\n  33:        0x1064b1b40 - driver::compile_input::h43265b54b30381a1xca\n  34:        0x1064a5438 - run_compiler::hd56abf18e73f9531dEc\n  35:        0x1064a1f45 - sys_common::unwind::try::try_fn::h3725603775136238299\n  36:        0x10a9baf4b - __rust_try\n  37:        0x10a9b2fb3 - sys_common::unwind::inner_try::h3c719a7bb47af1af18s\n  38:        0x1064a2809 - boxed::F.FnBox<A>::call_box::h11662039638244946638\n  39:        0x10a9c254d - sys::thread::Thread::new::thread_start::hbf136943ebd5e19atrx\n  40:     0x7fff8baea267 - _pthread_body\n  41:     0x7fff8baea1e4 - _pthread_start\n\nerror: internal compiler error: unexpected panic\nnote: the compiler unexpectedly panicked. this is a bug.\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports\nthread 'rustc' panicked at 'explicit panic', ../src/libsyntax/errors/mod.rs:360\nstack backtrace:\n   1:        0x10f493488 - sys::backtrace::tracing::imp::write::h268482af15af0a80Y8t\n   2:        0x10f499555 - panicking::default_handler::_$u7b$$u7b$closure$u7d$$u7d$::closure.42271\n   3:        0x10f499035 - panicking::default_handler::h97bc664f7e2bfeb5Ocy\n   4:        0x10f461f16 - sys_common::unwind::begin_unwind_inner::h98c0975c9b6b2fa0Zbt\n   5:        0x10c9c3084 - sys_common::unwind::begin_unwind::h13146085605143757291\n   6:        0x10c9ca9f4 - errors::DiagnosticBuilder<'a>.Drop::drop::h74630777c3a3e7973Bd\n   7:        0x112c75cfc - syntax..errors..DiagnosticBuilder::drop.13872::he841adc067eec1b4\n   8:        0x112c78a16 - core..result..Result<syntax..ptr..P<syntax..ast..Block>, syntax..errors..DiagnosticBuilder>::drop.14045::ha78fca7fe0fa1afa\n   9:        0x112c789a8 - result::Result<T, E>::ok::h8598607649825527066\n  10:        0x112c75977 - parse::Test.Parse<bool>::parse::h5bc3db50069b1db6cea\n  11:        0x112c7226d - parse::DescribeState.Parse<(codemap..Span, &'a mut base..ExtCtxt<'b>, Option<ast..Ident>)>::parse::h157da640af2ff6cfaia\n  12:        0x112c3ed90 - describe::describe::h47eeebe418369c49Sca\n  13:        0x112c3f05d - fn(&mut syntax..ext..base..ExtCtxt, syntax..codemap..Span, syntax..ast..Ident, collections..vec..Vec<syntax..ast..TokenTree>) .> Box<syntax..ext..base..MacResult> $u7b$describe..describe$u7d$::fn_pointer_shim.12515::h11bf6433a9f5c463\n  14:        0x112c3efa5 - ext::base::F.IdentMacroExpander::expand::h2255893400289716387\n  15:        0x10cc4fe48 - ext::expand::expand_item_mac::hc9348d4e1cc575a7O29\n  16:        0x10cc42c6d - ext::expand::expand_annotatable::h588765912514d47ejxa\n  17:        0x10cc3f8b8 - ext::expand::expand_item::h7a48d46a3d280a782Z9\n  18:        0x10cc4bde9 - fold::noop_fold_mod::h5514942419128523883\n  19:        0x10cc45bba - ext::expand::expand_item_underscore::hc3669d26e238942aD09\n  20:        0x10cc7cc4b - fold::noop_fold_item_simple::h11240569791642338683\n  21:        0x10cc7c79f - fold::noop_fold_item::h6562330027966964896\n  22:        0x10cc43f4a - ext::expand::expand_annotatable::h588765912514d47ejxa\n  23:        0x10cc3f8b8 - ext::expand::expand_item::h7a48d46a3d280a782Z9\n  24:        0x10cc4bde9 - fold::noop_fold_mod::h5514942419128523883\n  25:        0x10cc45bba - ext::expand::expand_item_underscore::hc3669d26e238942aD09\n  26:        0x10cc7cc4b - fold::noop_fold_item_simple::h11240569791642338683\n  27:        0x10cc7c79f - fold::noop_fold_item::h6562330027966964896\n  28:        0x10cc43f4a - ext::expand::expand_annotatable::h588765912514d47ejxa\n  29:        0x10cc3f8b8 - ext::expand::expand_item::h7a48d46a3d280a782Z9\n  30:        0x10cc85dd3 - ext::expand::expand_crate::h30ce0ee1f7e97002nVa\n  31:        0x10afefd22 - driver::phase_2_configure_and_expand::_$u7b$$u7b$closure$u7d$$u7d$::closure.32913\n  32:        0x10af86404 - driver::phase_2_configure_and_expand::h68ab6c933fccd499hza\n  33:        0x10af66b40 - driver::compile_input::h43265b54b30381a1xca\n  34:        0x10af5a438 - run_compiler::hd56abf18e73f9531dEc\n  35:        0x10af56f45 - sys_common::unwind::try::try_fn::h3725603775136238299\n  36:        0x10f490f4b - __rust_try\n  37:        0x10f488fb3 - sys_common::unwind::inner_try::h3c719a7bb47af1af18s\n  38:        0x10af57809 - boxed::F.FnBox<A>::call_box::h11662039638244946638\n  39:        0x10f49854d - sys::thread::Thread::new::thread_start::hbf136943ebd5e19atrx\n  40:     0x7fff8baea267 - _pthread_body\n  41:     0x7fff8baea1e4 - _pthread_start\n\nBuild failed, waiting for other jobs to finish...\nCould not compile `foxbox_users`.\n\nTo learn more, run the command again with --verbose.\n```\n\nCaused by the following code:\n\n```\ndescribe! routes_tests {\n    before_each {\n        use iron::{headers, Headers};\n        use iron_test::request;\n\n        let router = UsersRouter::new();\n\n        use iron::method::Method;\n        use iron::middleware::Handler;\n        use iron::status::Status;\n\n        use super::Endpoint;\n    }\n\n    it \"should respond with 501 not implemented\" {\n        const ENDPOINTS: &'static[Endpoint] = &[\n            (Method::Post,      &[\"invitations\"]),\n            (Method::Get,       &[\"invitations\"]),\n            (Method::Delete,    &[\"invitations\"]),\n            (Method::Post,      &[\"users\"]),\n            (Method::Get,       &[\"users\"]),\n            (Method::Put,       &[\"users\", \"*\"]),\n            (Method::Post,      &[\"users\", \"*\"]),\n            (Method::Post,      &[\"recoveries\", \"*\"]),\n            (Method::Get,       &[\"recoveries\", \"*\", \"*\"]),\n            (Method::Get,       &[\"permissions\"]),\n            (Method::Get,       &[\"permissions\", \"*\"]),\n            (Method::Get,       &[\"permissions\", \"*\", \"*\"]),\n            (Method::Get,       &[\"permissions\", \"_\", \"*\"]),\n            (Method::Put,       &[\"permissions\", \"*\", \"*\"]),\n        ];\n\n        for endpoint in ENDPOINTS {\n            let (ref method, path) = *endpoint;\n            let path = \"http://localhost:3000/\".to_string() +\n                       &(path.join(\"/\").replace(\"*\", \"foo\"));\n\n            let req = match *method {\n                Method::Get => {\n                    request::get(&path, Headers::new(), &router)\n                },\n                Method::Post => {\n                    request::post(&path, Headers::new(), \"\", &router)\n                },\n                Method::Delete => {\n                    request::delete(&path, Headers::new(), &router)\n                },\n                Method::Put => {\n                    request::put(&path, Headers::new(), \"\", &router)\n                },\n                _ => {\n                    assert!(false);\n                    request::get(&path, Headers::new(), \"\", &router)\n                }\n            }\n            assert!(true);\n        }\n    }\n}\n```\n\nI can workaround the panic if I do:\n\n```\n\n            match *method {\n                Method::Get => {\n                    let req = request::get(&path, Headers::new(), &router);\n                },\n                Method::Post => {\n                    let req = request::post(&path, Headers::new(), \"\", &router);\n                },\n                Method::Delete => {\n                    let req = request::delete(&path, Headers::new(), &router);\n                },\n                Method::Put => {\n                    let req = request::put(&path, Headers::new(), \"\", &router);\n                },\n                _ => {}\n            }\n```\n", "closed_by": {"login": "sanxiyn", "id": 45249, "node_id": "MDQ6VXNlcjQ1MjQ5", "avatar_url": "https://avatars.githubusercontent.com/u/45249?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanxiyn", "html_url": "https://github.com/sanxiyn", "followers_url": "https://api.github.com/users/sanxiyn/followers", "following_url": "https://api.github.com/users/sanxiyn/following{/other_user}", "gists_url": "https://api.github.com/users/sanxiyn/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanxiyn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanxiyn/subscriptions", "organizations_url": "https://api.github.com/users/sanxiyn/orgs", "repos_url": "https://api.github.com/users/sanxiyn/repos", "events_url": "https://api.github.com/users/sanxiyn/events{/privacy}", "received_events_url": "https://api.github.com/users/sanxiyn/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/31676/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/31676/timeline", "performed_via_github_app": null, "state_reason": "completed"}