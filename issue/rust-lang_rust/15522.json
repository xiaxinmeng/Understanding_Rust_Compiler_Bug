{"url": "https://api.github.com/repos/rust-lang/rust/issues/15522", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/15522/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/15522/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/15522/events", "html_url": "https://github.com/rust-lang/rust/issues/15522", "id": 37363035, "node_id": "MDU6SXNzdWUzNzM2MzAzNQ==", "number": 15522, "title": "ICE on Windows when linker output is too large", "user": {"login": "tomaka", "id": 1412254, "node_id": "MDQ6VXNlcjE0MTIyNTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1412254?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tomaka", "html_url": "https://github.com/tomaka", "followers_url": "https://api.github.com/users/tomaka/followers", "following_url": "https://api.github.com/users/tomaka/following{/other_user}", "gists_url": "https://api.github.com/users/tomaka/gists{/gist_id}", "starred_url": "https://api.github.com/users/tomaka/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tomaka/subscriptions", "organizations_url": "https://api.github.com/users/tomaka/orgs", "repos_url": "https://api.github.com/users/tomaka/repos", "events_url": "https://api.github.com/users/tomaka/events{/privacy}", "received_events_url": "https://api.github.com/users/tomaka/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 123109, "node_id": "MDU6TGFiZWwxMjMxMDk=", "url": "https://api.github.com/repos/rust-lang/rust/labels/O-windows", "name": "O-windows", "color": "6e6ec0", "default": false, "description": "Operating system: Windows"}, {"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2014-07-08T12:00:45Z", "updated_at": "2015-10-24T22:22:39Z", "closed_at": "2015-10-24T22:22:39Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I'm encountering an internal compiler error [when compiling this file](https://github.com/Tomaka17/gl-rs/blob/master/src/gl_generator/src/gl_generator.rs).\n\nI tried to simplify the code but I didn't manage to.\n- I tried removing `#![feature(globs)]`, but this didn't solve the issue\n- Replacing `macro_handler` by a dummy function didn't solve the issue\n- Removing all modules _did solve the issue_, but the modules don't do anything fancy (they just load a file, parse it, and output a string)\n- Compiling [this other file](https://github.com/Tomaka17/gl-rs/blob/master/src/gl_generator/src/main.rs)  (which is not a plugin_registrar) works, even thought it uses exactly the same modules in the exact same way.\n\nNote that the problematic file compiled without any issue a few days before (I didn't touch it at all). Also note that this code compiles on Linux (with the same rust nightlies) without any issue. I'm on Windows 7 64 bits.\n\nHere is the error message.\nThe message is in french, but refers to window's [ERROR_NOT_ENOUGH_MEMORY](http://msdn.microsoft.com/en-us/library/windows/desktop/ms681382%28v=vs.85%29.aspx#ERROR_NOT_ENOUGH_MEMORY). Rustc's memory consumption seems very normal (and lower than several other programs), so it's definitely not my machine running out of memory.\n\n```\nerror: linking with `gcc` failed: exit code: 1\nnote: gcc '-m32' '-L' 'C:\\Compilation\\Rust\\bin\\rustlib\\i686-pc-mingw32\\lib' '-o'\n 'C:\\Users\\Tomaka17\\Projets\\gl-rs\\src\\gl_generator\\target\\gen.dll' 'C:\\Users\\Tom\naka17\\Projets\\gl-rs\\src\\gl_generator\\target\\gen.o' '-Wl,--whole-archive' '-lmore\nstack' '-Wl,--no-whole-archive' 'C:\\Users\\Tomaka17\\Projets\\gl-rs\\src\\gl_generato\nr\\target\\gen.metadata.o' '-shared-libgcc' '-Wl,--enable-long-section-names' '-L'\n 'C:\\Compilation\\Rust\\bin\\rustlib\\i686-pc-mingw32\\lib' '-lrustc-4e7c5e5c' '-L' '\nC:\\Compilation\\Rust\\bin\\rustlib\\i686-pc-mingw32\\lib' '-ltime-4e7c5e5c' '-L' 'C:\\\nCompilation\\Rust\\bin\\rustlib\\i686-pc-mingw32\\lib' '-lflate-4e7c5e5c' '-L' 'C:\\Co\nmpilation\\Rust\\bin\\rustlib\\i686-pc-mingw32\\lib' '-lgetopts-4e7c5e5c' '-L' 'C:\\Co\nmpilation\\Rust\\bin\\rustlib\\i686-pc-mingw32\\lib' '-lgraphviz-4e7c5e5c' 'C:\\Users\\\nTomaka17\\Projets\\gl-rs\\src\\gl_generator\\target\\deps\\libsax.rlib' '-L' 'C:\\Compil\nation\\Rust\\bin\\rustlib\\i686-pc-mingw32\\lib' '-larena-4e7c5e5c' '-L' 'C:\\Compilat\nion\\Rust\\bin\\rustlib\\i686-pc-mingw32\\lib' '-lsyntax-4e7c5e5c' '-L' 'C:\\Compilati\non\\Rust\\bin\\rustlib\\i686-pc-mingw32\\lib' '-ldebug-4e7c5e5c' '-L' 'C:\\Compilation\n\\Rust\\bin\\rustlib\\i686-pc-mingw32\\lib' '-lterm-4e7c5e5c' '-L' 'C:\\Compilation\\Ru\nst\\bin\\rustlib\\i686-pc-mingw32\\lib' '-lfmt_macros-4e7c5e5c' '-L' 'C:\\Compilation\n\\Rust\\bin\\rustlib\\i686-pc-mingw32\\lib' '-lserialize-4e7c5e5c' '-L' 'C:\\Compilati\non\\Rust\\bin\\rustlib\\i686-pc-mingw32\\lib' '-llog-4e7c5e5c' '-L' 'C:\\Compilation\\R\nust\\bin\\rustlib\\i686-pc-mingw32\\lib' '-lstd-4e7c5e5c' '-L' 'C:\\Compilation\\Rust\\\nbin\\rustlib\\i686-pc-mingw32\\lib' '-lsync-4e7c5e5c' '-L' 'C:\\Compilation\\Rust\\bin\n\\rustlib\\i686-pc-mingw32\\lib' '-lrustrt-4e7c5e5c' '-L' 'C:\\Users\\Tomaka17\\Projet\ns\\gl-rs\\src\\gl_generator\\target\\deps' '-L' 'C:\\Users\\Tomaka17\\Projets\\gl-rs\\src\\\ngl_generator\\target' '-L' 'C:\\Users\\Tomaka17\\Projets\\gl-rs\\src\\gl_generator\\.rus\nt' '-L' 'C:\\Users\\Tomaka17\\Projets\\gl-rs\\src\\gl_generator' '-Wl,-Bdynamic' '-lsh\nell32' '-lpsapi' '-limagehlp' '-lm' '-lstdc++' '-lxml2' '-lkernel32' '-lgcc_s' '\n-shared' '-lcompiler-rt'\nnote: error: internal compiler error: unexpected failure\nnote: the compiler hit an unexpected failure path. this is a bug.\nnote: we would appreciate a bug report: http://doc.rust-lang.org/complement-bugr\neport.html\nnote: run with `RUST_BACKTRACE=1` for a backtrace\ntask 'rustc' failed at 'failed to print diagnostics: OS Error 8: Espace insuffis\nant pour traiter cette commande.\n', C:\\bot\\slave\\nightly-win\\build\\src\\libsyntax\\diagnostic.rs:336\n```\n\nHere is a backtrace from `rust_fail`:\n\n```\n#0  0x61f88110 in rust_fail ()\n   from C:\\Compilation\\Rust\\bin\\rustrt-4e7c5e5c.dll\n#1  0x61f88a81 in unwind::begin_unwind_inner::he6d59374b577b0cbsHd ()\n   from C:\\Compilation\\Rust\\bin\\rustrt-4e7c5e5c.dll\n#2  0x61f884ad in unwind::begin_unwind_fmt::hf1a6d30fc01810aaVEd ()\n   from C:\\Compilation\\Rust\\bin\\rustrt-4e7c5e5c.dll\n#3  0x00533b3e in diagnostic::EmitterWriter.Emitter::emit::h785613d48a5d9493Luc\n() from C:\\Compilation\\Rust\\bin\\syntax-4e7c5e5c.dll\n#4  0x00533152 in diagnostic::Handler::note::hba01478baac507e08fc ()\n   from C:\\Compilation\\Rust\\bin\\syntax-4e7c5e5c.dll\n#5  0x71683407 in _fu7391___ZN3vec12Vec$LT$T$GT$4push15__STATIC_FMTSTR20hc084010\n7d810eb38j0hE () from C:\\Compilation\\Rust\\bin\\rustc-4e7c5e5c.dll\n#6  0x7167ede9 in _fu10751___ZN6option15Option$LT$T$GT$6expect15__STATIC_FMTSTR2\n0h29176549ebbdbdeaAGyE () from C:\\Compilation\\Rust\\bin\\rustc-4e7c5e5c.dll\n#7  0x71714307 in driver::driver::phase_6_link_output::h41fcc24cd2f46b881Mq ()\n   from C:\\Compilation\\Rust\\bin\\rustc-4e7c5e5c.dll\n#8  0x7170c77f in _fu5538___ZN3vec10PTR_MARKER20h0b519807f343ac6fHBhE ()\n   from C:\\Compilation\\Rust\\bin\\rustc-4e7c5e5c.dll\n#9  0x717b1202 in _fu6031___ZN4cell32RefMut$LT$$x27b$C$$x20T$GT$.Drop4drop15__ST\nATIC_FMTSTR20h29176549ebbdbdeaLMvE ()\n   from C:\\Compilation\\Rust\\bin\\rustc-4e7c5e5c.dll\n#10 0x717c0efe in task::TaskBuilder$LT$S$GT$::try_future::closure.127545 ()\n   from C:\\Compilation\\Rust\\bin\\rustc-4e7c5e5c.dll\n#11 0x717c0e1c in task::TaskBuilder$LT$S$GT$::spawn_internal::closure.127522\n    () from C:\\Compilation\\Rust\\bin\\rustc-4e7c5e5c.dll\n#12 0x70c30058 in task::spawn_opts::closure.8059 ()\n   from C:\\Compilation\\Rust\\bin\\native-4e7c5e5c.dll\n#13 0x61f88105 in unwind::try::try_fn::h3d20541cb51b4242eyd ()\n   from C:\\Compilation\\Rust\\bin\\rustrt-4e7c5e5c.dll\n#14 0x61fe7a56 in rust_try () from C:\\Compilation\\Rust\\bin\\rustrt-4e7c5e5c.dll\n#15 0x61f85e47 in unwind::try::h171a75ee7c63bb90Rvd ()\n   from C:\\Compilation\\Rust\\bin\\rustrt-4e7c5e5c.dll\n#16 0x61f85bda in task::Task::run::hcb2f0bccdd286ca2hWc ()\n   from C:\\Compilation\\Rust\\bin\\rustrt-4e7c5e5c.dll\n#17 0x70c2fef7 in task::spawn_opts::closure.8005 ()\n   from C:\\Compilation\\Rust\\bin\\native-4e7c5e5c.dll\n#18 0x61f87c5f in thread::thread_start::h869f9d55708b60ddPid ()\n   from C:\\Compilation\\Rust\\bin\\rustrt-4e7c5e5c.dll\n#19 0x76c7338a in KERNEL32!BaseThreadInitThunk ()\n   from C:\\Windows\\syswow64\\kernel32.dll\n#20 0x77dd9f72 in ntdll!RtlInitializeExceptionChain ()\n   from C:\\Windows\\system32\\ntdll.dll\n#21 0x77dd9f45 in ntdll!RtlInitializeExceptionChain ()\n   from C:\\Windows\\system32\\ntdll.dll\n#22 0x00000000 in ?? ()\n```\n\nRustc's version is today's nightly:\n\n```\nrustc 0.11.0-nightly (a3257804df2bace236f83d9e5a9e887a1df30ef5 2014-07-08 00:31:42 +0000)\n```\n", "closed_by": {"login": "steveklabnik", "id": 27786, "node_id": "MDQ6VXNlcjI3Nzg2", "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/steveklabnik", "html_url": "https://github.com/steveklabnik", "followers_url": "https://api.github.com/users/steveklabnik/followers", "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}", "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}", "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions", "organizations_url": "https://api.github.com/users/steveklabnik/orgs", "repos_url": "https://api.github.com/users/steveklabnik/repos", "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}", "received_events_url": "https://api.github.com/users/steveklabnik/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/15522/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/15522/timeline", "performed_via_github_app": null, "state_reason": "completed"}