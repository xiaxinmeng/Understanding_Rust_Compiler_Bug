{"url": "https://api.github.com/repos/rust-lang/rust/issues/13119", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/13119/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/13119/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/13119/events", "html_url": "https://github.com/rust-lang/rust/issues/13119", "id": 30063784, "node_id": "MDU6SXNzdWUzMDA2Mzc4NA==", "number": 13119, "title": "Reader should handle 0-length reads better", "user": {"login": "lilyball", "id": 714, "node_id": "MDQ6VXNlcjcxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/714?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lilyball", "html_url": "https://github.com/lilyball", "followers_url": "https://api.github.com/users/lilyball/followers", "following_url": "https://api.github.com/users/lilyball/following{/other_user}", "gists_url": "https://api.github.com/users/lilyball/gists{/gist_id}", "starred_url": "https://api.github.com/users/lilyball/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lilyball/subscriptions", "organizations_url": "https://api.github.com/users/lilyball/orgs", "repos_url": "https://api.github.com/users/lilyball/repos", "events_url": "https://api.github.com/users/lilyball/events{/privacy}", "received_events_url": "https://api.github.com/users/lilyball/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2014-03-24T18:47:51Z", "updated_at": "2014-10-07T19:19:20Z", "closed_at": "2014-10-07T19:19:20Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Reader should be vetted to ensure it handles 0-length reads in a sane fashion. This is inspired by comments on #13049.\n\nA few things need to be ensured:\n1. The documentation on Reader discourages returning 0 from `read()`. It should certainly be allowed, but implementors should be encouraged to avoid returning 0 if possible.\n2. The default methods on `Reader` should all behave sanely if a single call to `read()` returns 0.\n3. Less importantly, the default methods should handle a `Reader` that returns 0 forever. Practically speaking, this means that if the method employs a loop, it should also employ a counter to count how many 0-length `read()`s there have been in a row, and if it passes some threshold (TBD, but maybe something like 1000) then it should return an error. There should also be a new `IoErrorKind` defined for this case (Go uses one called `ErrNoProgress`, that seems a sensible name).\n4. Any clients of Reader in `std` and the associated libraries should also be checked to make sure they handle 0-length reads.\n\nThe simplest way to implement this may be to add another default method `read_at_least()` that takes a count of how many bytes it should ensure it has read. This method can then deal with counting 0-length reads and setting the proper error, and then everything that reads in a loop can use `r.read_at_least(but, 1)` so they don't have to deal with it.\n", "closed_by": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/13119/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/13119/timeline", "performed_via_github_app": null, "state_reason": "completed"}