{"url": "https://api.github.com/repos/rust-lang/rust/issues/48453", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/48453/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/48453/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/48453/events", "html_url": "https://github.com/rust-lang/rust/issues/48453", "id": 299567314, "node_id": "MDU6SXNzdWUyOTk1NjczMTQ=", "number": 48453, "title": "Stabilize `main` with non-() return types", "user": {"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 234902, "node_id": "MDU6TGFiZWwyMzQ5MDI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-enhancement", "name": "C-enhancement", "color": "f5f1fd", "default": false, "description": "Category: An issue proposing an enhancement or a PR with one."}, {"id": 67766349, "node_id": "MDU6TGFiZWw2Nzc2NjM0OQ==", "url": "https://api.github.com/repos/rust-lang/rust/labels/E-mentor", "name": "E-mentor", "color": "02E10C", "default": false, "description": "Call for participation: This issue has a mentor. Use RustcContributor::new on Zulip for discussion."}, {"id": 211668019, "node_id": "MDU6TGFiZWwyMTE2NjgwMTk=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-lang", "name": "T-lang", "color": "bfd4f2", "default": false, "description": "Relevant to the language team, which will review and decide on the PR/issue."}, {"id": 919710011, "node_id": "MDU6TGFiZWw5MTk3MTAwMTE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/disposition-merge", "name": "disposition-merge", "color": "008800", "default": false, "description": "This issue / PR is in PFCP or FCP with a disposition to merge it."}, {"id": 923282386, "node_id": "MDU6TGFiZWw5MjMyODIzODY=", "url": "https://api.github.com/repos/rust-lang/rust/labels/finished-final-comment-period", "name": "finished-final-comment-period", "color": "f9e189", "default": false, "description": "The final comment period is finished for this PR / Issue."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/rust-lang/rust/milestones/44", "html_url": "https://github.com/rust-lang/rust/milestone/44", "labels_url": "https://api.github.com/repos/rust-lang/rust/milestones/44/labels", "id": 3036984, "node_id": "MDk6TWlsZXN0b25lMzAzNjk4NA==", "number": 44, "title": "1.25", "description": "", "creator": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 12, "state": "closed", "created_at": "2018-01-15T18:13:50Z", "updated_at": "2018-09-17T05:56:28Z", "due_on": "2018-03-29T07:00:00Z", "closed_at": "2018-04-05T13:55:17Z"}, "comments": 28, "created_at": "2018-02-23T01:17:44Z", "updated_at": "2018-09-17T05:56:28Z", "closed_at": "2018-09-17T05:56:28Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "This is a sub-issue of the [larger tracking issue](https://github.com/rust-lang/rust/issues/43301) devoted to the `?` in main RFC. It is specifically proposing that we **stabilize** the behavior that permits `main` to have a return type other than `()`. This return type must implement the `Termination` trait. The details of the trait itself (including its name and so forth) are **not** stabilized. \r\n\r\nThis commits us to the following (each link is to a test):\r\n\r\n- [`fn main() -> i32`](https://github.com/rust-lang/rust/blob/b1f8e6fb06d7362eeb2065347a7db94e76b1cb2f/src/test/run-pass/rfc-1937-termination-trait/termination-trait-for-i32.rs)\r\n    - [return value is the exit code of the process](https://github.com/rust-lang/rust/blob/b1f8e6fb06d7362eeb2065347a7db94e76b1cb2f/src/libstd/termination.rs#L72-L77)\r\n- `fn main() -> !` (no test, but [here is the impl](https://github.com/rust-lang/rust/blob/b1f8e6fb06d7362eeb2065347a7db94e76b1cb2f/src/libstd/termination.rs#L60-L63) -- a test is being added in #48143)\r\n    - should never return\r\n- `fn main() -> Result<(), E>` where `E: Debug`\r\n    - on `Err`, a `Debug` printout occurs\r\n    - these impls are modified in #48497\r\n- `fn main() -> Result<!, E>` where `E: Debug`\r\n    - these impls are modified in #48497\r\n\r\nThe changes from the RFC are as follows:\r\n\r\n- we modified the `Result` impl to use `Debug`\r\n\r\nThe following unresolved questions will be resolved:\r\n\r\n- [ ] The precise initial implementations\r\n    - as above\r\n- [ ] exit codes ([discussion](https://internals.rust-lang.org/t/mini-pre-rfc-redesigning-process-exitstatus/5426))\r\n    - these are defined as `libc::EXIT_SUCCESS` for \"Ok\" and `libc::EXIT_FAILURE` for \"Err\"\r\n    - except for wasm, where they are [currently defined as 0 or 1 for wasm](https://github.com/rust-lang/rust/blob/b1f8e6fb06d7362eeb2065347a7db94e76b1cb2f/src/libstd/termination.rs#L12-L22) -- this is because [those constants are/were not available for wasm](https://github.com/rust-lang/rust/issues/48453#issuecomment-367942553)\r\n    - (they also appear not to be publicly exported? but that is not part of this stabilization)\r\n\r\nBut the following is **not stabilized** and **free to change**:\r\n\r\n- the name/location of the `Termination` trait and its methods\r\n    - likely changing to `std::process::Termination`\r\n- the usage of `-> Result<...>` in unit tests ([not yet landed](https://github.com/rust-lang/rust/pull/48143))\r\n- the `ErrCode` newtype wrapper for returning a custom error code\r\n\r\n--\r\n\r\nUPDATE 1: Restricted the set of termination impls as proposed by @scottmcm in https://github.com/rust-lang/rust/pull/48497.", "closed_by": {"login": "scottmcm", "id": 18526288, "node_id": "MDQ6VXNlcjE4NTI2Mjg4", "avatar_url": "https://avatars.githubusercontent.com/u/18526288?v=4", "gravatar_id": "", "url": "https://api.github.com/users/scottmcm", "html_url": "https://github.com/scottmcm", "followers_url": "https://api.github.com/users/scottmcm/followers", "following_url": "https://api.github.com/users/scottmcm/following{/other_user}", "gists_url": "https://api.github.com/users/scottmcm/gists{/gist_id}", "starred_url": "https://api.github.com/users/scottmcm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/scottmcm/subscriptions", "organizations_url": "https://api.github.com/users/scottmcm/orgs", "repos_url": "https://api.github.com/users/scottmcm/repos", "events_url": "https://api.github.com/users/scottmcm/events{/privacy}", "received_events_url": "https://api.github.com/users/scottmcm/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/48453/reactions", "total_count": 14, "+1": 11, "-1": 0, "laugh": 0, "hooray": 3, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/48453/timeline", "performed_via_github_app": null, "state_reason": "completed"}