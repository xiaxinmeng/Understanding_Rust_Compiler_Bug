{"url": "https://api.github.com/repos/rust-lang/rust/issues/30138", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/30138/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/30138/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/30138/events", "html_url": "https://github.com/rust-lang/rust/issues/30138", "id": 119750709, "node_id": "MDU6SXNzdWUxMTk3NTA3MDk=", "number": 30138, "title": "Remove panic from to_digit and from_digit", "user": {"login": "alexchandel", "id": 637714, "node_id": "MDQ6VXNlcjYzNzcxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/637714?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexchandel", "html_url": "https://github.com/alexchandel", "followers_url": "https://api.github.com/users/alexchandel/followers", "following_url": "https://api.github.com/users/alexchandel/following{/other_user}", "gists_url": "https://api.github.com/users/alexchandel/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexchandel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexchandel/subscriptions", "organizations_url": "https://api.github.com/users/alexchandel/orgs", "repos_url": "https://api.github.com/users/alexchandel/repos", "events_url": "https://api.github.com/users/alexchandel/events{/privacy}", "received_events_url": "https://api.github.com/users/alexchandel/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2015-12-01T16:11:49Z", "updated_at": "2015-12-01T20:00:59Z", "closed_at": "2015-12-01T17:07:46Z", "author_association": "NONE", "active_lock_reason": null, "body": "The panics in `from_digit` and `to_digit` are rather arbitrary:\n\n``` rust\n\npub fn from_digit(num: u32, radix: u32) -> Option<char> {\n    if radix > 36 {\n        panic!(\"from_digit: radix is too high (maximum 36)\");\n    }\n    if num < radix {\n        let num = num as u8;\n        if num < 10 {\n            Some((b'0' + num) as char)\n        } else {\n            Some((b'a' + num - 10) as char)\n        }\n    } else {\n        None\n    }\n}\n...\n   fn to_digit(self, radix: u32) -> Option<u32> {\n        if radix > 36 {\n            panic!(\"to_digit: radix is too high (maximum 36)\");\n        }\n        let val = match self {\n          '0' ... '9' => self as u32 - '0' as u32,\n          'a' ... 'z' => self as u32 - 'a' as u32 + 10,\n          'A' ... 'Z' => self as u32 - 'A' as u32 + 10,\n          _ => return None,\n        };\n        if val < radix { Some(val) }\n        else { None }\n    }\n```\n\nBoth functions already return a `None` when the number above the radix, and should also return `None` rather than crashing the program when the radix is greater than 36. If a crash is still desired, the `Option<char>` can simply be unwrapped.\n\nThis change is very simple to make. Although both functions are stable, this panic is not encoded in their signatures, and nothing in the standard library relies on this hidden panic; in fact `from_digit` is always `unwrap`d, while `to_digit` is either unwrapped or matched a way compatible with the elimination of this panic (though an error message may need to be tweaked). A cursory search of GitHub suggests this is in fact the case everywhere else, with every invocation I could find either passing 2, 10, 16, or 36 as the radix, unwrapping the result, or manually checking whether the radix was greater than 36 and explicitly panicking if so.\n\nSince libcore is being stabilized right now, I'd offer that panicking in the core library should be minimized, since every possible panic reduces Rust's applicability and usefulness to baremetal systems where safety is a concern.\n", "closed_by": {"login": "steveklabnik", "id": 27786, "node_id": "MDQ6VXNlcjI3Nzg2", "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/steveklabnik", "html_url": "https://github.com/steveklabnik", "followers_url": "https://api.github.com/users/steveklabnik/followers", "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}", "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}", "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions", "organizations_url": "https://api.github.com/users/steveklabnik/orgs", "repos_url": "https://api.github.com/users/steveklabnik/repos", "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}", "received_events_url": "https://api.github.com/users/steveklabnik/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/30138/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/30138/timeline", "performed_via_github_app": null, "state_reason": "completed"}