{"url": "https://api.github.com/repos/rust-lang/rust/issues/75025", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/75025/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/75025/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/75025/events", "html_url": "https://github.com/rust-lang/rust/issues/75025", "id": 671161192, "node_id": "MDU6SXNzdWU2NzExNjExOTI=", "number": 75025, "title": "Confusing error message for misplaced lifetime annotation in reference", "user": {"login": "Storyyeller", "id": 999674, "node_id": "MDQ6VXNlcjk5OTY3NA==", "avatar_url": "https://avatars.githubusercontent.com/u/999674?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Storyyeller", "html_url": "https://github.com/Storyyeller", "followers_url": "https://api.github.com/users/Storyyeller/followers", "following_url": "https://api.github.com/users/Storyyeller/following{/other_user}", "gists_url": "https://api.github.com/users/Storyyeller/gists{/gist_id}", "starred_url": "https://api.github.com/users/Storyyeller/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Storyyeller/subscriptions", "organizations_url": "https://api.github.com/users/Storyyeller/orgs", "repos_url": "https://api.github.com/users/Storyyeller/repos", "events_url": "https://api.github.com/users/Storyyeller/events{/privacy}", "received_events_url": "https://api.github.com/users/Storyyeller/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 234902, "node_id": "MDU6TGFiZWwyMzQ5MDI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-enhancement", "name": "C-enhancement", "color": "f5f1fd", "default": false, "description": "Category: An issue proposing an enhancement or a PR with one."}, {"id": 235791, "node_id": "MDU6TGFiZWwyMzU3OTE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-diagnostics", "name": "A-diagnostics", "color": "f7e101", "default": false, "description": "Area: Messages for errors, warnings, and lints"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-08-01T20:12:12Z", "updated_at": "2020-10-23T07:38:17Z", "closed_at": "2020-10-23T07:38:17Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!--\r\nThank you for filing a bug report! \ud83d\udc1b Please provide a short summary of the bug,\r\nalong with any information you feel relevant to replicating the bug.\r\n-->\r\n\r\nI recently forgot where in a mutable reference the lifetime goes, and got a confusing wall of error messages. Out of the six error messages produced, only the fifth hints at the actual problem, with the rest being misleading.\r\n\r\nI think the error messages in this case could be improved in case a newcomer runs into this issue in order to avoid leading them down a false path of trying to figure out trait objects.\r\n\r\nSpecifically, with the following code\r\n\r\n```rust\r\npub struct SpanMaker<'a> {\r\n    parent: &mut 'a SpanManager,\r\n    source: usize,\r\n}\r\n```\r\nI got the following compiler errors:\r\n```\r\nerror: lifetime in trait object type must be followed by `+`\r\n  --> src/spans.rs:20:18\r\n   |\r\n20 |     parent: &mut 'a SpanManager,\r\n   |                  ^^\r\n\r\nerror: expected `,`, or `}`, found `SpanManager`\r\n  --> src/spans.rs:20:20\r\n   |\r\n20 |     parent: &mut 'a SpanManager,\r\n   |                    ^ help: try adding a comma: `,`\r\n\r\nerror: expected `:`, found `,`\r\n  --> src/spans.rs:20:32\r\n   |\r\n20 |     parent: &mut 'a SpanManager,\r\n   |                                ^ expected `:`\r\n\r\nwarning: trait objects without an explicit `dyn` are deprecated\r\n  --> src/spans.rs:20:18\r\n   |\r\n20 |     parent: &mut 'a SpanManager,\r\n   |                  ^^ help: use `dyn`: `dyn 'a`\r\n   |\r\n   = note: `#[warn(bare_trait_objects)]` on by default\r\n\r\nerror[E0106]: missing lifetime specifier\r\n  --> src/spans.rs:20:13\r\n   |\r\n20 |     parent: &mut 'a SpanManager,\r\n   |             ^ help: consider using the named lifetime: `&'a`\r\n\r\nerror[E0224]: at least one trait is required for an object type\r\n  --> src/spans.rs:20:18\r\n   |\r\n20 |     parent: &mut 'a SpanManager,\r\n   |                  ^^\r\n\r\nerror: aborting due to 5 previous errors; 1 warning emitted\r\n```\r\n\r\nI am using stable Rust.\r\n```\r\nrustc --version --verbose\r\nrustc 1.44.1 (c7087fe00 2020-06-17)\r\nbinary: rustc\r\ncommit-hash: c7087fe00d2ba919df1d813c040a5d47e43b0fe7\r\ncommit-date: 2020-06-17\r\nhost: x86_64-unknown-linux-gnu\r\nrelease: 1.44.1\r\nLLVM version: 9.0\r\n```\r\n\r\n</p>\r\n</details>\r\n", "closed_by": {"login": "JohnTitor", "id": 25030997, "node_id": "MDQ6VXNlcjI1MDMwOTk3", "avatar_url": "https://avatars.githubusercontent.com/u/25030997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JohnTitor", "html_url": "https://github.com/JohnTitor", "followers_url": "https://api.github.com/users/JohnTitor/followers", "following_url": "https://api.github.com/users/JohnTitor/following{/other_user}", "gists_url": "https://api.github.com/users/JohnTitor/gists{/gist_id}", "starred_url": "https://api.github.com/users/JohnTitor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JohnTitor/subscriptions", "organizations_url": "https://api.github.com/users/JohnTitor/orgs", "repos_url": "https://api.github.com/users/JohnTitor/repos", "events_url": "https://api.github.com/users/JohnTitor/events{/privacy}", "received_events_url": "https://api.github.com/users/JohnTitor/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/75025/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/75025/timeline", "performed_via_github_app": null, "state_reason": "completed"}