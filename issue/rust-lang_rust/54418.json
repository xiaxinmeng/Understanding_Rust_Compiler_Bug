{"url": "https://api.github.com/repos/rust-lang/rust/issues/54418", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/54418/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/54418/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/54418/events", "html_url": "https://github.com/rust-lang/rust/issues/54418", "id": 362514366, "node_id": "MDU6SXNzdWUzNjI1MTQzNjY=", "number": 54418, "title": "`use proc_macro` regressed from nightly-2018-09-14 to nightly 2018-09-15 in edition 2018", "user": {"login": "LukasKalbertodt", "id": 7419664, "node_id": "MDQ6VXNlcjc0MTk2NjQ=", "avatar_url": "https://avatars.githubusercontent.com/u/7419664?v=4", "gravatar_id": "", "url": "https://api.github.com/users/LukasKalbertodt", "html_url": "https://github.com/LukasKalbertodt", "followers_url": "https://api.github.com/users/LukasKalbertodt/followers", "following_url": "https://api.github.com/users/LukasKalbertodt/following{/other_user}", "gists_url": "https://api.github.com/users/LukasKalbertodt/gists{/gist_id}", "starred_url": "https://api.github.com/users/LukasKalbertodt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/LukasKalbertodt/subscriptions", "organizations_url": "https://api.github.com/users/LukasKalbertodt/orgs", "repos_url": "https://api.github.com/users/LukasKalbertodt/repos", "events_url": "https://api.github.com/users/LukasKalbertodt/events{/privacy}", "received_events_url": "https://api.github.com/users/LukasKalbertodt/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2018-09-21T08:43:47Z", "updated_at": "2018-09-21T13:23:31Z", "closed_at": "2018-09-21T13:23:31Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Use statements for `proc_macro` that worked in nightly-(2ab3eba30 2018-09-14) don't work in (e4ba1d41e 2018-09-15) (including all newer nightlies up to at least (3bc2ca7e4 2018-09-20) and the RC1 beta) anymore.  \r\n\r\nI tried this code:\r\n\r\n**src/lib.rs**\r\n```rust\r\nuse proc_macro::TokenStream;\r\n\r\n#[proc_macro]\r\npub fn foo(input: TokenStream) -> TokenStream {\r\n    input\r\n}\r\n```\r\n\r\n**Cargo.toml**\r\n```toml\r\n[package]\r\nname = \"proc-fail\"\r\nversion = \"0.1.0\"\r\nauthors = [\"me\"]\r\nedition = \"2018\"\r\n\r\n[lib]\r\nproc-macro = true\r\n\r\n[dependencies]\r\n```\r\n\r\nAs said, compiling with (2ab3eba30 2018-09-14), everything works. But compiling with (e4ba1d41e 2018-09-15) results in:\r\n\r\n**Error (1)**\r\n```\r\nerror[E0432]: unresolved import `proc_macro`\r\n --> src/lib.rs:3:5\r\n  |\r\n3 | use proc_macro::TokenStream;\r\n  |     ^^^^^^^^^^ Could not find `proc_macro` in `{{root}}`\r\n```\r\n\r\n---\r\n\r\nI tried different configurations with the two different nightly versions. The error in `edition = \"2015\"` without the extern crate is expected, of course (or is it? I'm confused now).\r\n\r\n**With nightly-(2ab3eba30 2018-09-14):**\r\n\r\n| | `edition = \"2015\"` | `edition = \"2018\"` |\r\n| - | - | - |\r\n| with `extern crate proc_macro` | works | works |\r\n| without `extern crate proc_macro` | fails (3) | works |\r\n\r\n**With nightly- (e4ba1d41e 2018-09-15):**\r\n\r\n| | `edition = \"2015\"` | `edition = \"2018\"` |\r\n| - | - | - |\r\n| with `extern crate proc_macro` | works | fails (2) |\r\n| without `extern crate proc_macro` | fails (3) | fails (1) (the case described above) |\r\n\r\n\r\n**Error (2)**\r\n```\r\nerror[E0432]: unresolved import `proc_macro`\r\n --> src/lib.rs:3:5\r\n  |\r\n3 | use proc_macro::TokenStream;\r\n  |     ^^^^^^^^^^ Did you mean `self::proc_macro`?\r\n```\r\n\r\n**Error (3)**\r\n```\r\nerror[E0432]: unresolved import `proc_macro`\r\n --> src/lib.rs:3:5\r\n  |\r\n3 | use proc_macro::TokenStream;\r\n  |     ^^^^^^^^^^ Did you mean `registrar::proc_macro`?\r\n```\r\n\r\n---\r\n\r\nI couldn't really find any information about this. So the only way to make it work right now is to either use edition 2015 with extern crate or edition 2018 with extern crate and `use self::proc_macro`.\r\n\r\nIs this intended or an unwanted regression?", "closed_by": {"login": "LukasKalbertodt", "id": 7419664, "node_id": "MDQ6VXNlcjc0MTk2NjQ=", "avatar_url": "https://avatars.githubusercontent.com/u/7419664?v=4", "gravatar_id": "", "url": "https://api.github.com/users/LukasKalbertodt", "html_url": "https://github.com/LukasKalbertodt", "followers_url": "https://api.github.com/users/LukasKalbertodt/followers", "following_url": "https://api.github.com/users/LukasKalbertodt/following{/other_user}", "gists_url": "https://api.github.com/users/LukasKalbertodt/gists{/gist_id}", "starred_url": "https://api.github.com/users/LukasKalbertodt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/LukasKalbertodt/subscriptions", "organizations_url": "https://api.github.com/users/LukasKalbertodt/orgs", "repos_url": "https://api.github.com/users/LukasKalbertodt/repos", "events_url": "https://api.github.com/users/LukasKalbertodt/events{/privacy}", "received_events_url": "https://api.github.com/users/LukasKalbertodt/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/54418/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/54418/timeline", "performed_via_github_app": null, "state_reason": "completed"}