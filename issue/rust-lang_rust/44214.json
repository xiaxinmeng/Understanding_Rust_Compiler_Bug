{"url": "https://api.github.com/repos/rust-lang/rust/issues/44214", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/44214/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/44214/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/44214/events", "html_url": "https://github.com/rust-lang/rust/issues/44214", "id": 254334758, "node_id": "MDU6SXNzdWUyNTQzMzQ3NTg=", "number": 44214, "title": "`./x.py clean` does not clean LLVM, `./x.py clean -h` looks wrong", "user": {"login": "SimonSapin", "id": 291359, "node_id": "MDQ6VXNlcjI5MTM1OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/291359?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SimonSapin", "html_url": "https://github.com/SimonSapin", "followers_url": "https://api.github.com/users/SimonSapin/followers", "following_url": "https://api.github.com/users/SimonSapin/following{/other_user}", "gists_url": "https://api.github.com/users/SimonSapin/gists{/gist_id}", "starred_url": "https://api.github.com/users/SimonSapin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SimonSapin/subscriptions", "organizations_url": "https://api.github.com/users/SimonSapin/orgs", "repos_url": "https://api.github.com/users/SimonSapin/repos", "events_url": "https://api.github.com/users/SimonSapin/events{/privacy}", "received_events_url": "https://api.github.com/users/SimonSapin/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 37234, "node_id": "MDU6TGFiZWwzNzIzNA==", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-cleanup", "name": "C-cleanup", "color": "f5f1fd", "default": false, "description": "Category: PRs that clean code up or issues documenting cleanup."}, {"id": 67766349, "node_id": "MDU6TGFiZWw2Nzc2NjM0OQ==", "url": "https://api.github.com/repos/rust-lang/rust/labels/E-mentor", "name": "E-mentor", "color": "02E10C", "default": false, "description": "Call for participation: This issue has a mentor. Use RustcContributor::new on Zulip for discussion."}, {"id": 325438536, "node_id": "MDU6TGFiZWwzMjU0Mzg1MzY=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-bootstrap", "name": "T-bootstrap", "color": "bfd4f2", "default": false, "description": "Relevant to the bootstrap subteam: Rust's build system (x.py and src/bootstrap)"}, {"id": 593503757, "node_id": "MDU6TGFiZWw1OTM1MDM3NTc=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-infra", "name": "T-infra", "color": "bfd4f2", "default": false, "description": "Relevant to the infrastructure team, which will review and decide on the PR/issue."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2017-08-31T13:29:17Z", "updated_at": "2017-09-30T13:31:52Z", "closed_at": "2017-09-30T13:31:52Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "In a clone of this repository that I hadn\u2019t used for a long time, I ran `git pull` then `./x.py build`. The latter failed in the middle of building LLVM with:\r\n\r\n```\r\n[ 15%] Linking CXX executable ../../bin/llvm-config\r\n/usr/bin/ld: cannot find -lLLVM\r\ncollect2: error: ld returned 1 exit status\r\n[ 15%] Linking CXX executable ../../bin/llvm-cxxfilt\r\ntools/llvm-config/CMakeFiles/llvm-config.dir/build.make:95: recipe for target 'bin/llvm-config' failed\r\nmake[2]: *** [bin/llvm-config] Error 1\r\nCMakeFiles/Makefile2:11680: recipe for target 'tools/llvm-config/CMakeFiles/llvm-config.dir/all' failed\r\nmake[1]: *** [tools/llvm-config/CMakeFiles/llvm-config.dir/all] Error 2\r\n```\r\n\r\nRunning `./x.py clean` and then `./x.py build` again did not help. It turns out that `./x.py clean` does not clean `build/x86_64-unknown-linux-gnu/llvm/build`. Removing everything with `rm -r build/*` \"fixed\" the issue.\r\n\r\nI tried `./x.py clean -h` to see if there\u2019s an option to clean everything, but the output of that is confusing. It looks like the help message for `./x.py` without any subcommand.\r\n\r\n```\r\nUpdating submodules\r\n    Finished dev [unoptimized] target(s) in 0.0 secs\r\nUsage: x.py <subcommand> [options] [<paths>...]\r\n\r\nSubcommands:\r\n    build       Compile either the compiler or libraries\r\n    test        Build and run some test suites\r\n    bench       Build and run some benchmarks\r\n    doc         Build documentation\r\n    clean       Clean out build directories\r\n    dist        Build distribution artifacts\r\n    install     Install distribution artifacts\r\n\r\nTo learn more about a subcommand, run `./x.py <subcommand> -h`\r\n\r\nOptions:\r\n    -v, --verbose       use verbose output (-vv for very verbose)\r\n    -i, --incremental   use incremental compilation\r\n        --config FILE   TOML configuration file for build\r\n        --build BUILD   build target of the stage0 compiler\r\n        --host HOST     host targets to build\r\n        --target TARGET target targets to build\r\n        --on-fail CMD   command to run on failure\r\n        --stage N       stage to build\r\n        --keep-stage N  stage to keep without recompiling\r\n        --src DIR       path to the root of the rust checkout\r\n    -j, --jobs JOBS     number of jobs to run in parallel\r\n    -h, --help          print this help message\r\n\r\nRun `./x.py clean -h -v` to see a list of available paths.\r\n```", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/44214/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/44214/timeline", "performed_via_github_app": null, "state_reason": "completed"}