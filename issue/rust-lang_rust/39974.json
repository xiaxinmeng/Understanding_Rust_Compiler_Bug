{"url": "https://api.github.com/repos/rust-lang/rust/issues/39974", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/39974/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/39974/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/39974/events", "html_url": "https://github.com/rust-lang/rust/issues/39974", "id": 208887231, "node_id": "MDU6SXNzdWUyMDg4ODcyMzE=", "number": 39974, "title": "Rustc crashes rather than failing to compile when wrong sized type is used", "user": {"login": "mcdenhoed", "id": 325687, "node_id": "MDQ6VXNlcjMyNTY4Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/325687?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mcdenhoed", "html_url": "https://github.com/mcdenhoed", "followers_url": "https://api.github.com/users/mcdenhoed/followers", "following_url": "https://api.github.com/users/mcdenhoed/following{/other_user}", "gists_url": "https://api.github.com/users/mcdenhoed/gists{/gist_id}", "starred_url": "https://api.github.com/users/mcdenhoed/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mcdenhoed/subscriptions", "organizations_url": "https://api.github.com/users/mcdenhoed/orgs", "repos_url": "https://api.github.com/users/mcdenhoed/repos", "events_url": "https://api.github.com/users/mcdenhoed/events{/privacy}", "received_events_url": "https://api.github.com/users/mcdenhoed/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}, {"id": 46741598, "node_id": "MDU6TGFiZWw0Njc0MTU5OA==", "url": "https://api.github.com/repos/rust-lang/rust/labels/E-needs-test", "name": "E-needs-test", "color": "02e10c", "default": false, "description": "Call for participation: writing correctness tests"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2017-02-20T13:58:06Z", "updated_at": "2017-05-28T12:01:17Z", "closed_at": "2017-05-28T12:01:17Z", "author_association": "NONE", "active_lock_reason": null, "body": "I was playing around with some code and found a condition that should result in a compilation error but results in a crash instead.\r\n\r\nThis code compiles normally:\r\n\r\n    const LENGTH: usize = 4;\r\n    \r\n    struct Thing {\r\n        f: [[f64; 2]; LENGTH],\r\n    }\r\n    \r\n    fn main() {\r\n        let t = Thing { f: [[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]] };\r\n    }\r\n\r\n\r\nIf you change `const LENGTH: usize = 4;` to `const LENGTH: u32 = 4;` you get a compilation error, as expected.\r\n\r\nHowever, if you change it to `const LENGTH: f64 = 4;` you get a crash.\r\n\r\n## Meta\r\n\r\n    rustc 1.15.1 (021bd294c 2017-02-08)\r\n    binary: rustc\r\n    commit-hash: 021bd294c039bd54aa5c4aa85bcdffb0d24bc892\r\n    commit-date: 2017-02-08\r\n    host: x86_64-pc-windows-msvc\r\n    release: 1.15.1\r\n    LLVM version: 3.9\r\n\r\n## Backtrace:\r\n\r\n    thread 'rustc' panicked at 'Box<Any>', C:\\bot\\slave\\stable-dist-rustc-win-msvc-64\\build\\src\\librustc_errors\\lib.rs:423\r\n    stack backtrace:\r\n       0:     0x7ffa5edfedea - std::panicking::Location::line::h77e1a07e4d6d891a\r\n       1:     0x7ffa5edfe274 - std::panicking::Location::line::h77e1a07e4d6d891a\r\n       2:     0x7ffa5ee01ccd - std::panicking::rust_panic_with_hook::h537b769c8e0e1c2d\r\n       3:     0x7ffa50452a1a - <unknown>\r\n       4:     0x7ffa5046d59e - rustc_errors::Handler::bug::had89a2eafd9d44ba\r\n       5:     0x7ffa27149fc5 - rustc::session::bug_fmt::hc10f935d6ba6cd93\r\n       6:     0x7ffa27149df2 - rustc::session::bug_fmt::hc10f935d6ba6cd93\r\n       7:     0x7ffa2714950c - rustc::session::bug_fmt::hc10f935d6ba6cd93\r\n       8:     0x7ffa4f69453b - rustc_const_eval::eval::eval_const_expr_partial::h8506b167c7a43499\r\n       9:     0x7ffa4f68b0be - rustc_const_eval::eval::eval_const_expr_partial::h8506b167c7a43499\r\n      10:     0x7ffa4f68e053 - rustc_const_eval::eval::eval_const_expr_partial::h8506b167c7a43499\r\n      11:     0x7ffa4f695153 - rustc_const_eval::eval::eval_length::h4e0736539c568f4d\r\n      12:     0x7ffa43472646 - <rustc_typeck::astconv::AstConv<'gcx, 'tcx> + 'o>::ast_ty_to_ty::h39a0321307d078df\r\n      13:     0x7ffa434814f8 - <rustc::hir::Generics as rustc_typeck::collect::GetTypeParameterBounds<'tcx>>::get_type_parameter_bounds::h82c8b3f9d32e8939\r\n      14:     0x7ffa4347875f - <rustc_typeck::collect::CollectItemTypesVisitor<'a, 'tcx> as rustc::hir::intravisit::Visitor<'tcx>>::visit_item::h07d02b3adc3c96ed\r\n      15:     0x7ffa43477ea5 - rustc_typeck::collect::collect_item_types::h287fdae2e3e8d768\r\n      16:     0x7ffa434aa4d4 - rustc_typeck::check_crate::h3d799501ecb83cfd\r\n      17:     0x7ffa5f0bdb4e - rustc_driver::driver::count_nodes::hd8d06c8fe5cb012d\r\n      18:     0x7ffa5f02502f - <unknown>\r\n      19:     0x7ffa5f0a8b52 - rustc_driver::driver::compile_input::h4d6139b5511c2803\r\n      20:     0x7ffa5f0f94e7 - rustc_driver::run_compiler::hc652dda834d2f45c\r\n      21:     0x7ffa5efddd6e - <unknown>\r\n      22:     0x7ffa5ee04681 - _rust_maybe_catch_panic\r\n      23:     0x7ffa5f006904 - <unknown>\r\n      24:     0x7ffa5edfc3ae - std::sys::imp::thread::Thread::new::hcb2a817bb8ef6963\r\n      25:     0x7ffa67e38363 - BaseThreadInitThunk", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/39974/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/39974/timeline", "performed_via_github_app": null, "state_reason": "completed"}