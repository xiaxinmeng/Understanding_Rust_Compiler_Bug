{"url": "https://api.github.com/repos/rust-lang/rust/issues/61628", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/61628/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/61628/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/61628/events", "html_url": "https://github.com/rust-lang/rust/issues/61628", "id": 453626461, "node_id": "MDU6SXNzdWU0NTM2MjY0NjE=", "number": 61628, "title": "x.py can't compile target json spec", "user": {"login": "mtthw-meyer", "id": 8441853, "node_id": "MDQ6VXNlcjg0NDE4NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/8441853?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mtthw-meyer", "html_url": "https://github.com/mtthw-meyer", "followers_url": "https://api.github.com/users/mtthw-meyer/followers", "following_url": "https://api.github.com/users/mtthw-meyer/following{/other_user}", "gists_url": "https://api.github.com/users/mtthw-meyer/gists{/gist_id}", "starred_url": "https://api.github.com/users/mtthw-meyer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mtthw-meyer/subscriptions", "organizations_url": "https://api.github.com/users/mtthw-meyer/orgs", "repos_url": "https://api.github.com/users/mtthw-meyer/repos", "events_url": "https://api.github.com/users/mtthw-meyer/events{/privacy}", "received_events_url": "https://api.github.com/users/mtthw-meyer/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 325438536, "node_id": "MDU6TGFiZWwzMjU0Mzg1MzY=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-bootstrap", "name": "T-bootstrap", "color": "bfd4f2", "default": false, "description": "Relevant to the bootstrap subteam: Rust's build system (x.py and src/bootstrap)"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-06-07T17:50:50Z", "updated_at": "2019-06-21T14:31:12Z", "closed_at": "2019-06-21T14:31:12Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm trying to build Rust for a arm7 platform with neon enabled. I've got the spec dumped from armv7-unknown-linux-gnueabihf and changed the features to enable neon. I can't figure out how to get x.py to actually compile this thing without complaining. I have a sysroot with the appropriate compilers and I've tried building stage 0 and stage 1 with it.\r\n\r\n    \"features\": \"+v7,+vfp3,+d16,+thumb2,+neon\r\n\r\nThe first issue is there seems to be a bug with the bootstrap. It tries to use the .json to reference the config.toml and custom compilers get ignored. I have:\r\n\r\nconfig.toml\r\n```\r\n[target.armv7-custom-linux-gnueabihf]\r\ncc = \"arc-aca-linux-gcc\"\r\nlinker = \"arc-aca-linux-gcc-ld\"\r\nar = \"arc-aca-linux-gcc-gnueabihf-ar\"\r\n```\r\n\r\n```\r\n./x.py build -i --stage 0 --target=armv7-custom-linux-gnueabihf.json --verbose\r\n..snip..\r\nCC_armv7-custom-linux-gnueabihf.json = \"cc\"\r\n```\r\nOpps, that's not the right compiler! At some point the .json should get removed and doesn't. And you can't just name it without the json and use it because cargo rejects it as not being a built-in target then and you can't add .json to the toml either.\r\n\r\nAssuming I can get all that work I'll need to use wrappers for the compiler targets because there doesn't seem to be any support for sysroot built in already.\r\n\r\n[armv7-custom-linux-gnueabihf.json](https://github.com/rust-lang/rust/files/3266972/armv7-custom-linux-gnueabihf.txt)\r\n\r\ngit status\r\nHEAD detached at 37ff5d388f\r\n\r\n", "closed_by": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/61628/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/61628/timeline", "performed_via_github_app": null, "state_reason": "completed"}