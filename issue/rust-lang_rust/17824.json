{"url": "https://api.github.com/repos/rust-lang/rust/issues/17824", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/17824/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/17824/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/17824/events", "html_url": "https://github.com/rust-lang/rust/issues/17824", "id": 45009660, "node_id": "MDU6SXNzdWU0NTAwOTY2MA==", "number": 17824, "title": "Compiler crashes when pretty-printing something", "user": {"login": "tomwhoiscontrary", "id": 539012, "node_id": "MDQ6VXNlcjUzOTAxMg==", "avatar_url": "https://avatars.githubusercontent.com/u/539012?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tomwhoiscontrary", "html_url": "https://github.com/tomwhoiscontrary", "followers_url": "https://api.github.com/users/tomwhoiscontrary/followers", "following_url": "https://api.github.com/users/tomwhoiscontrary/following{/other_user}", "gists_url": "https://api.github.com/users/tomwhoiscontrary/gists{/gist_id}", "starred_url": "https://api.github.com/users/tomwhoiscontrary/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tomwhoiscontrary/subscriptions", "organizations_url": "https://api.github.com/users/tomwhoiscontrary/orgs", "repos_url": "https://api.github.com/users/tomwhoiscontrary/repos", "events_url": "https://api.github.com/users/tomwhoiscontrary/events{/privacy}", "received_events_url": "https://api.github.com/users/tomwhoiscontrary/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 108435, "node_id": "MDU6TGFiZWwxMDg0MzU=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-pretty", "name": "A-pretty", "color": "f7e101", "default": false, "description": "Area: Pretty printing."}, {"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}, {"id": 46741598, "node_id": "MDU6TGFiZWw0Njc0MTU5OA==", "url": "https://api.github.com/repos/rust-lang/rust/labels/E-needs-test", "name": "E-needs-test", "color": "02e10c", "default": false, "description": "Call for participation: writing correctness tests"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2014-10-06T17:20:58Z", "updated_at": "2015-04-22T02:38:08Z", "closed_at": "2015-04-22T02:38:08Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I'm writing my first Rust program! It compiles, but when i try to pretty-print it with --pretty typed (because i'm trying to understand what types are being inferred), the compiler crashes.\n\nI'm running rustc 0.11.0, which i got from Homebrew on a Mac running OS X 10.9.4 (uname -a says \"Darwin hostname 13.3.0 Darwin Kernel Version 13.3.0: Tue Jun  3 21:27:35 PDT 2014; root:xnu-2422.110.17~1/RELEASE_X86_64 x86_64\").\n\nYour [bug report instructions](http://doc.rust-lang.org/complement-bugreport.html) mention that \"It's also helpful to copy/paste the output of re-running the erroneous rustc command with the -v flag\", but since the -v flag causes rustc to print its version and exit, i am skeptical of this claim.\n\nThe program:\n\n```\nuse std::os;\nuse std::io::fs::File;\n\nfn main() {\n    let homedir = os::homedir().expect(\"the user's home directory could not be determined\");\n    let configFile = homedir.join(\".cf\").join(\"config.json\");\n    if (!configFile.is_file()) {\n        fail!(\"the config file was not present at {}\", configFile.display());\n    }\n    let mut reader = File::open(&configFile);\n    let mut reader2 = reader.unwrap();\n}\n```\n\nThe command:\n\n```\nrustc --pretty typed bug.rs\n```\n\nThe error message:\n\n```\nerror: internal compiler error: node_id_to_type: no type for node `expr 2u (id=65)`\nnote: the compiler hit an unexpected failure path. this is a bug.\nnote: we would appreciate a bug report: http://doc.rust-lang.org/complement-bugreport.html\nnote: run with `RUST_BACKTRACE=1` for a backtrace\ntask 'rustc' failed at 'Box<Any>', /private/tmp/rust-GCum/rust-0.11.0/src/libsyntax/diagnostic.rs:162\n```\n\nThe backtrace:\n\n```\n   1:        0x110d94b05 - rt::backtrace::imp::write::hc81110d3d6b7c73cmPp::v0.11.0\n   2:        0x110d9b0a7 - failure::on_fail::hc762f23051f63e3fB5p::v0.11.0\n   3:        0x111044b39 - unwind::begin_unwind_inner::hb6a32d9b8994b2c7VSd::v0.11.0\n   4:        0x1104f7cb5 - unwind::begin_unwind::h5861459936587707106::v0.11.0\n   5:        0x1104f86f1 - diagnostic::Handler::bug::h00cbb2b46927e612Occ::v0.11.0\n   6:        0x10e03d658 - driver::session::Session::bug::hbd4edbf9f8728b2bd7q::v0.11.0\n   7:        0x10e0a8483 - middle::ty::node_id_to_type::hd2dcd1f1b0daab8dZeQ::v0.11.0\n   8:        0x10e9a663c - driver::driver::TypedAnnotation.pprust..PpAnn::post::hb005ba4b7c1e09879Cq::v0.11.0\n   9:        0x1105f158f - print::pprust::State<'a>::print_expr::hd2e0783c67059bc44CO::v0.11.0\n  10:        0x1105d7fc7 - print::pprust::State<'a>::print_type::hc1f48816ea321792DcN::v0.11.0\n  11:        0x1105fe973 - print::pprust::State<'a>::print_item::h68221c863b8724aeMtN::v0.11.0\n  12:        0x110626378 - print::pprust::State<'a>::print_decl::h255a31ea3fc557bfAzP::v0.11.0\n  13:        0x1105f72ad - print::pprust::State<'a>::print_stmt::ha988aa3a01487a9eCkO::v0.11.0\n  14:        0x110628ee2 - print::pprust::State<'a>::print_block_maybe_unclosed::head68fecb2760bf4ypO::v0.11.0\n  15:        0x1105efae9 - print::pprust::State<'a>::print_expr::hd2e0783c67059bc44CO::v0.11.0\n  16:        0x1106292ee - print::pprust::State<'a>::print_block_maybe_unclosed::head68fecb2760bf4ypO::v0.11.0\n  17:        0x1105e8120 - print::pprust::State<'a>::print_expr::hd2e0783c67059bc44CO::v0.11.0\n  18:        0x1105f76b4 - print::pprust::State<'a>::print_stmt::ha988aa3a01487a9eCkO::v0.11.0\n  19:        0x110628ee2 - print::pprust::State<'a>::print_block_maybe_unclosed::head68fecb2760bf4ypO::v0.11.0\n  20:        0x11062b88b - print::pprust::State<'a>::print_if::h645a71dc7a92f1c0cxO::v0.11.0\n  21:        0x1105e4202 - print::pprust::State<'a>::print_expr::hd2e0783c67059bc44CO::v0.11.0\n  22:        0x1105f70bb - print::pprust::State<'a>::print_stmt::ha988aa3a01487a9eCkO::v0.11.0\n  23:        0x110628ee2 - print::pprust::State<'a>::print_block_maybe_unclosed::head68fecb2760bf4ypO::v0.11.0\n  24:        0x1105fcb71 - print::pprust::State<'a>::print_item::h68221c863b8724aeMtN::v0.11.0\n  25:        0x1105d1fa8 - print::pprust::State<'a>::print_mod::h55d21be51d16c410K7M::v0.11.0\n  26:        0x1105d12f4 - print::pprust::print_crate::h18a6d1cb58730c1bGDM::v0.11.0\n  27:        0x10e9a7734 - driver::driver::pretty_print_input::h3ca8fb5bb81001beVEq::v0.11.0\n  28:        0x10e9c5b95 - driver::run_compiler::hd49ac6aa73bb72d3CDs::v0.11.0\n  29:        0x10e9c5056 - driver::main_args::closure.101074\n  30:        0x10e9d96db - task::TaskBuilder<S>::try_future::closure.102210\n  31:        0x10e9d9574 - task::TaskBuilder<S>::spawn_internal::closure.102187\n  32:        0x10dfd2c2c - task::spawn_opts::closure.7374\n  33:        0x1110a73cc - rust_try\n  34:        0x111040fda - unwind::try::h1dab452418dce7c3kHd::v0.11.0\n  35:        0x111040cdc - task::Task::run::hac15d7c21261287acTc::v0.11.0\n  36:        0x10dfd2abb - task::spawn_opts::closure.7319\n  37:        0x111043849 - thread::thread_start::hde3a01c4bf3098cdKfd::v0.11.0\n  38:     0x7fff8f812899 - _pthread_body\n  39:     0x7fff8f81272a - _pthread_struct_init\n```\n", "closed_by": {"login": "steveklabnik", "id": 27786, "node_id": "MDQ6VXNlcjI3Nzg2", "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/steveklabnik", "html_url": "https://github.com/steveklabnik", "followers_url": "https://api.github.com/users/steveklabnik/followers", "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}", "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}", "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions", "organizations_url": "https://api.github.com/users/steveklabnik/orgs", "repos_url": "https://api.github.com/users/steveklabnik/repos", "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}", "received_events_url": "https://api.github.com/users/steveklabnik/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/17824/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/17824/timeline", "performed_via_github_app": null, "state_reason": "completed"}