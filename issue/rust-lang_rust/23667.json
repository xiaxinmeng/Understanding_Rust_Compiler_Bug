{"url": "https://api.github.com/repos/rust-lang/rust/issues/23667", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/23667/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/23667/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/23667/events", "html_url": "https://github.com/rust-lang/rust/issues/23667", "id": 64094715, "node_id": "MDU6SXNzdWU2NDA5NDcxNQ==", "number": 23667, "title": "ICE; wrapping a library search path in quotes causes Rust to panic.", "user": {"login": "dradtke", "id": 929204, "node_id": "MDQ6VXNlcjkyOTIwNA==", "avatar_url": "https://avatars.githubusercontent.com/u/929204?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dradtke", "html_url": "https://github.com/dradtke", "followers_url": "https://api.github.com/users/dradtke/followers", "following_url": "https://api.github.com/users/dradtke/following{/other_user}", "gists_url": "https://api.github.com/users/dradtke/gists{/gist_id}", "starred_url": "https://api.github.com/users/dradtke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dradtke/subscriptions", "organizations_url": "https://api.github.com/users/dradtke/orgs", "repos_url": "https://api.github.com/users/dradtke/repos", "events_url": "https://api.github.com/users/dradtke/events{/privacy}", "received_events_url": "https://api.github.com/users/dradtke/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2015-03-24T20:39:16Z", "updated_at": "2017-05-02T12:23:28Z", "closed_at": "2017-05-02T12:23:28Z", "author_association": "NONE", "active_lock_reason": null, "body": "If I set up a Cargo project with a simple `build.rs` file like this:\n\n``` rust\nfn main() {\n    println!(\"cargo:rustc-link-search=native=\\\".\\\"\");\n}\n```\n\nthen I get this compiler error when trying to build:\n\n```\n   Compiling ice-test v0.0.1 (file:///C:/Users/dradtke/carhole/rust/ice-test)\n     Running `rustc src\\main.rs --crate-name ice-test --crate-type bin -g --out-dir C:\\Users\\dradtke\\carhole\\rust\\ice-test\\target\\debug --emit=dep-info,link -L dependency=C:\\Users\\dradtke\\carhole\\rust\\ice-test\\target\\debug -L dependency=C:\\Users\\dradtke\\carhole\\rust\\ice-test\\target\\debug\\deps -L native=\".\"`\nerror: internal compiler error: unexpected panic\nnote: the compiler unexpectedly panicked. this is a bug.\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports\nnote: run with `RUST_BACKTRACE=1` for a backtrace\nthread 'rustc' panicked at 'called `Result::unwrap()` on an `Err` value: JoinPathsError { inner: JoinPathsError }', C:/bot/slave/nightly-dist-rustc-win-32/build/src/libcore\\result.rs:751\n\nstack backtrace:\n   1: 0x6316dc46 - rt::unwind::register::h27ef7cd182e9296cKUI\n   2: 0x630c37dc - rt::unwind::begin_unwind_inner::hefe36366e50f3af8URI\n   3: 0x630c3b57 - rt::unwind::begin_unwind_fmt::h97d5284c0d9beb8cvQI\n   4: 0x6316d920 - rust_begin_unwind\n   5: 0x6318aaa8 - panicking::panic_fmt::h6bc794081905f967eXA\n   6: 0x6cd602c6 - driver::collect_crate_metadata::h58b83019adfc1339R1a\n   7: 0x6cd10f51 - driver::phase_2_configure_and_expand::hfb9ddf7f7541ae2dXsa\n   8: 0x6cd01842 - driver::compile_input::hb1aac2c29f5a3486Rba\n   9: 0x6cdc3c48 - run_compiler::he240a1462e2271ebv2b\n  10: 0x6cdc1aad - run::h34c87f0e8759e7f3b2b\n  11: 0x6cdc0e9b - run::h34c87f0e8759e7f3b2b\n  12: 0x631623a4 - sys::tcp::TcpListener::bind::hc51fae06b1861148xkH\n  13: 0x762e338a - BaseThreadInitThunk\n  14: 0x770a9f72 - RtlInitializeExceptionChain\n\nCould not compile `ice-test`.\n\nCaused by:\n  Process didn't exit successfully: `rustc src\\main.rs --crate-name ice-test --crate-type bin -g --out-dir C:\\Users\\dradtke\\carhole\\rust\\ice-test\\target\\debug --emit=dep-info,link -L dependency=C:\\Users\\dradtke\\carhole\\rust\\ice-test\\target\\debug -L dependency=C:\\Users\\dradtke\\carhole\\rust\\ice-test\\target\\debug\\deps -L native=\".\"` (exit code: 101)\n```\n\nTaking out the quotes around the search path fixes the issue and it compiles fine. The example above is contrived, but when I ran into this error, I added the quotes to avoid any possible issues with spaces in the file name, as I'm developing on Windows and that's a common problem.\n\nRust version:\n\n```\nrustc 1.0.0-nightly (809a554fc 2015-03-23) (built 2015-03-24)\nbinary: rustc\ncommit-hash: 809a554fca2d0ebc2ba50077016fe282a4064752\ncommit-date: 2015-03-23\nbuild-date: 2015-03-24\nhost: i686-pc-windows-gnu\nrelease: 1.0.0-nightly\n```\n", "closed_by": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/23667/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/23667/timeline", "performed_via_github_app": null, "state_reason": "completed"}