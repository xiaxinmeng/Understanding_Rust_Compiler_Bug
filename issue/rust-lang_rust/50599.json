{"url": "https://api.github.com/repos/rust-lang/rust/issues/50599", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/50599/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/50599/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/50599/events", "html_url": "https://github.com/rust-lang/rust/issues/50599", "id": 321835659, "node_id": "MDU6SXNzdWUzMjE4MzU2NTk=", "number": 50599, "title": "[ICE] using a not found constant", "user": {"login": "leonardo-m", "id": 22328461, "node_id": "MDQ6VXNlcjIyMzI4NDYx", "avatar_url": "https://avatars.githubusercontent.com/u/22328461?v=4", "gravatar_id": "", "url": "https://api.github.com/users/leonardo-m", "html_url": "https://github.com/leonardo-m", "followers_url": "https://api.github.com/users/leonardo-m/followers", "following_url": "https://api.github.com/users/leonardo-m/following{/other_user}", "gists_url": "https://api.github.com/users/leonardo-m/gists{/gist_id}", "starred_url": "https://api.github.com/users/leonardo-m/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/leonardo-m/subscriptions", "organizations_url": "https://api.github.com/users/leonardo-m/orgs", "repos_url": "https://api.github.com/users/leonardo-m/repos", "events_url": "https://api.github.com/users/leonardo-m/events{/privacy}", "received_events_url": "https://api.github.com/users/leonardo-m/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}, {"id": 900795185, "node_id": "MDU6TGFiZWw5MDA3OTUxODU=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-const-eval", "name": "A-const-eval", "color": "f7e101", "default": false, "description": "Area: constant evaluation (mir interpretation)"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-05-10T07:22:53Z", "updated_at": "2018-05-17T04:52:34Z", "closed_at": "2018-05-17T04:52:34Z", "author_association": "NONE", "active_lock_reason": null, "body": "While using the new floating-point logarithm constants ( #50540 ), I've made a mistake, I've missed the consts:: part of the path:\r\n\r\n```\r\nfn main() {\r\n    const N: u32 = 1_000;\r\n    const M: usize = (f64::from(N) * std::f64::LOG10_2) as usize;\r\n    let mut digits = [0u32; M];\r\n}\r\n```\r\n\r\n\r\nIt caused an ICE:\r\n\r\n```\r\nerror[E0425]: cannot find value `LOG10_2` in module `std::f64`\r\n --> ...\\test.rs:3:48\r\n  |\r\n3 |     const M: usize = (f64::from(N) * std::f64::LOG10_2) as usize;\r\n  |                                                ^^^^^^^ not found in `std::f64`\r\nhelp: possible candidates are found in other modules, you can import them into scope\r\n  |\r\n1 | use std::f32::consts::LOG10_2;\r\n  |\r\n1 | use std::f64::consts::LOG10_2;\r\n  |\r\n\r\nerror: internal compiler error: librustc_passes\\rvalue_promotion.rs:278: no kind for cast\r\n --> ...\\test.rs:3:22\r\n  |\r\n3 |     const M: usize = (f64::from(N) * std::f64::LOG10_2) as usize;\r\n  |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n\r\nthread 'main' panicked at 'Box<Any>', librustc_errors\\lib.rs:499:9\r\nstack backtrace:\r\n   0: mingw_set_invalid_parameter_handler\r\n   1: mingw_set_invalid_parameter_handler\r\n   2: mingw_set_invalid_parameter_handler\r\n   3: mingw_set_invalid_parameter_handler\r\n   4: mingw_set_invalid_parameter_handler\r\n   5: mingw_set_invalid_parameter_handler\r\n   6: mingw_set_invalid_parameter_handler\r\n   7: mingw_set_invalid_parameter_handler\r\n   8: mingw_set_invalid_parameter_handler\r\n   9: mingw_set_invalid_parameter_handler\r\n  10: mingw_set_invalid_parameter_handler\r\n  11: mingw_set_invalid_parameter_handler\r\n  12: mingw_set_invalid_parameter_handler\r\n  13: mingw_set_invalid_parameter_handler\r\n  14: mingw_set_invalid_parameter_handler\r\n  15: mingw_set_invalid_parameter_handler\r\n  16: mingw_set_invalid_parameter_handler\r\n  17: mingw_set_invalid_parameter_handler\r\n  18: mingw_set_invalid_parameter_handler\r\n  19: mingw_set_invalid_parameter_handler\r\n  20: mingw_set_invalid_parameter_handler\r\n  21: mingw_set_invalid_parameter_handler\r\n  22: mingw_set_invalid_parameter_handler\r\n  23: mingw_set_invalid_parameter_handler\r\n  24: mingw_set_invalid_parameter_handler\r\n  25: mingw_set_invalid_parameter_handler\r\n  26: mingw_set_invalid_parameter_handler\r\n  27: mingw_set_invalid_parameter_handler\r\n  28: mingw_set_invalid_parameter_handler\r\n  29: mingw_set_invalid_parameter_handler\r\n  30: mingw_set_invalid_parameter_handler\r\n  31: mingw_set_invalid_parameter_handler\r\n  32: mingw_set_invalid_parameter_handler\r\n  33: mingw_set_invalid_parameter_handler\r\n  34: mingw_set_invalid_parameter_handler\r\n  35: mingw_set_invalid_parameter_handler\r\n  36: mingw_set_invalid_parameter_handler\r\n  37: mingw_set_invalid_parameter_handler\r\n  38: mingw_set_invalid_parameter_handler\r\n  39: mingw_set_invalid_parameter_handler\r\n  40: mingw_set_invalid_parameter_handler\r\n  41: mingw_set_invalid_parameter_handler\r\n  42: mingw_set_invalid_parameter_handler\r\n  43: mingw_set_invalid_parameter_handler\r\n  44: mingw_set_invalid_parameter_handler\r\n  45: mingw_set_invalid_parameter_handler\r\n  46: mingw_set_invalid_parameter_handler\r\n  47: mingw_set_invalid_parameter_handler\r\n  48: mingw_set_invalid_parameter_handler\r\n  49: mingw_set_invalid_parameter_handler\r\n  50: mingw_set_invalid_parameter_handler\r\n  51: mingw_set_invalid_parameter_handler\r\n  52: mingw_set_invalid_parameter_handler\r\n  53: mingw_set_invalid_parameter_handler\r\n  54: mingw_set_invalid_parameter_handler\r\n  55: mingw_set_invalid_parameter_handler\r\n  56: mingw_set_invalid_parameter_handler\r\n  57: mingw_set_invalid_parameter_handler\r\n  58: mingw_set_invalid_parameter_handler\r\n  59: mingw_set_invalid_parameter_handler\r\n  60: mingw_set_invalid_parameter_handler\r\n  61: mingw_set_invalid_parameter_handler\r\n  62: mingw_set_invalid_parameter_handler\r\n  63: mingw_set_invalid_parameter_handler\r\n  64: mingw_set_invalid_parameter_handler\r\n  65: mingw_set_invalid_parameter_handler\r\n  66: mingw_set_invalid_parameter_handler\r\n  67: mingw_set_invalid_parameter_handler\r\n  68: mingw_set_invalid_parameter_handler\r\n  69: mingw_set_invalid_parameter_handler\r\n  70: mingw_set_invalid_parameter_handler\r\n  71: mingw_set_invalid_parameter_handler\r\n  72: mingw_set_invalid_parameter_handler\r\n  73: mingw_set_invalid_parameter_handler\r\n  74: mingw_set_invalid_parameter_handler\r\n  75: mingw_set_invalid_parameter_handler\r\n  76: mingw_set_invalid_parameter_handler\r\n  77: mingw_set_invalid_parameter_handler\r\n  78: mingw_set_invalid_parameter_handler\r\n  79: mingw_set_invalid_parameter_handler\r\n  80: mingw_set_invalid_parameter_handler\r\n  81: mingw_set_invalid_parameter_handler\r\n  82: mingw_set_invalid_parameter_handler\r\n  83: mingw_set_invalid_parameter_handler\r\n  84: mingw_set_invalid_parameter_handler\r\n  85: mingw_set_invalid_parameter_handler\r\n  86: mingw_set_invalid_parameter_handler\r\n  87: mingw_set_invalid_parameter_handler\r\n  88: mingw_set_invalid_parameter_handler\r\n  89: mingw_set_invalid_parameter_handler\r\n  90: mingw_set_invalid_parameter_handler\r\n  91: mingw_set_invalid_parameter_handler\r\n  92: mingw_set_invalid_parameter_handler\r\n  93: std::rt::lang_start::{{closure}}\r\n  94: mingw_set_invalid_parameter_handler\r\n  95: mingw_set_invalid_parameter_handler\r\n  96: mingw_set_invalid_parameter_handler\r\n  97: main\r\n  98: _tmainCRTStartup\r\n  99: mainCRTStartup\r\nquery stack during panic:\r\n#0 [rvalue_promotable_map] checking which parts of `main::M` are promotable to static\r\n#1 [const_is_rvalue_promotable_to_static] const checking if rvalue is promotable to static `main::M`\r\n --> ...\\test.rs:4:29\r\n  |\r\n4 |     let mut digits = [0u32; M];\r\n  |                             ^\r\n#2 [rvalue_promotable_map] checking which parts of `main::{{initializer}}` are promotable to static\r\n#3 [borrowck] processing `main::{{initializer}}`\r\n#4 [optimized_mir] processing `main::{{initializer}}`\r\n#5 [const_eval] const-evaluating `main::{{initializer}}`\r\n#6 [typeck_tables_of] processing `main`\r\n#7 [typeck_item_bodies] type-checking all item bodies\r\nend of query stack\r\nerror: aborting due to 2 previous errors\r\n\r\nFor more information about this error, try `rustc --explain E0425`.\r\n\r\nnote: the compiler unexpectedly panicked. this is a bug.\r\n\r\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports\r\n\r\nnote: rustc 1.27.0-nightly (e5f80f2a4 2018-05-09) running on x86_64-pc-windows-gnu\r\n```", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/50599/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/50599/timeline", "performed_via_github_app": null, "state_reason": "completed"}