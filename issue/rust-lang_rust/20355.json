{"url": "https://api.github.com/repos/rust-lang/rust/issues/20355", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/20355/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/20355/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/20355/events", "html_url": "https://github.com/rust-lang/rust/issues/20355", "id": 53157956, "node_id": "MDU6SXNzdWU1MzE1Nzk1Ng==", "number": 20355, "title": "Segfault in `Hasher<SipState>::hash`", "user": {"login": "fitzgen", "id": 74571, "node_id": "MDQ6VXNlcjc0NTcx", "avatar_url": "https://avatars.githubusercontent.com/u/74571?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fitzgen", "html_url": "https://github.com/fitzgen", "followers_url": "https://api.github.com/users/fitzgen/followers", "following_url": "https://api.github.com/users/fitzgen/following{/other_user}", "gists_url": "https://api.github.com/users/fitzgen/gists{/gist_id}", "starred_url": "https://api.github.com/users/fitzgen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fitzgen/subscriptions", "organizations_url": "https://api.github.com/users/fitzgen/orgs", "repos_url": "https://api.github.com/users/fitzgen/repos", "events_url": "https://api.github.com/users/fitzgen/events{/privacy}", "received_events_url": "https://api.github.com/users/fitzgen/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 100522, "node_id": "MDU6TGFiZWwxMDA1MjI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-crash", "name": "I-crash", "color": "e10c02", "default": false, "description": "Issue: The compiler crashes (SIGSEGV, SIGABRT, etc). Use I-ICE instead when the compiler panics."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2014-12-31T00:04:46Z", "updated_at": "2015-01-01T01:04:35Z", "closed_at": "2015-01-01T01:04:35Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Test case is branch `sip-hasher-segault` of this repo: https://github.com/fitzgen/oxischeme/tree/sip-hasher-segfault\n\n```\n$ rustc --version --verbose\nrustc --version --verbose\nrustc 0.13.0-nightly (5ba610265 2014-12-25 18:01:36 +0000)\nbinary: rustc\ncommit-hash: 5ba6102657a892457063d2d6a7cbb9632ce282c6\ncommit-date: 2014-12-25 18:01:36 +0000\nhost: x86_64-apple-darwin\nrelease: 0.13.0-nightly\n$ rustc -g --test src/main.rs -o target/test\n$ lldb ./target/test\nlldb ./target/test\n(lldb) target create \"./target/test\"\nCurrent executable set to './target/test' (x86_64).\n(lldb) run\nProcess 8270 launched: './target/test' (x86_64)\n\nrunning 20 tests\nProcess 8270 stopped\n* thread #2: tid = 0x25693, 0x0000000100008bed test`hash::sip::SipHasher.Hasher$LT$SipState$GT$::hash::h16497116303610205953 + 61, stop reason = EXC_BAD_ACCESS (code=1, address=0x3ffd9)\n    frame #0: 0x0000000100008bed test`hash::sip::SipHasher.Hasher$LT$SipState$GT$::hash::h16497116303610205953 + 61\ntest`hash::sip::SipHasher.Hasher$LT$SipState$GT$::hash::h16497116303610205953 + 61:\n-> 0x100008bed:  movq   (%rsi), %rsi\n   0x100008bf0:  movq   -0x8(%rbp), %rdi\n   0x100008bf4:  movq   0x8(%rdi), %rdx\n   0x100008bf8:  movq   %rax, %rdi\n(lldb) bt\n* thread #2: tid = 0x25693, 0x0000000100008bed test`hash::sip::SipHasher.Hasher$LT$SipState$GT$::hash::h16497116303610205953 + 61, stop reason = EXC_BAD_ACCESS (code=1, address=0x3ffd9)\n  * frame #0: 0x0000000100008bed test`hash::sip::SipHasher.Hasher$LT$SipState$GT$::hash::h16497116303610205953 + 61\n    frame #1: 0x0000000105401810\n    frame #2: 0x0000000100008ba2 test`hash::RandomSipHasher.Hasher$LT$sip..SipState$GT$::hash::h10512232733763305808 + 66\n    frame #3: 0x0000000100008b0e test`collections::hash::table::make_hash::h9604696550138645665 + 62\n    frame #4: 0x0000000100008abe test`collections::hash::map::HashMap$LT$K$C$$u{20}V$C$$u{20}H$GT$::make_hash::h15786379260790357760 + 62\n    frame #5: 0x0000000100008963 test`collections::hash::map::HashMap$LT$K$C$$u{20}V$C$$u{20}H$GT$::insert::h6805880362953821147 + 131\n    frame #6: 0x0000000100006aea test`main::environment::Environment::define(self=0x000000000003ffc1, sym=String at 0x0000000105401a50, val=0x0000000105401c38) + 218 at environment.rs:92\n    frame #7: 0x0000000100018486 test`main::eval::evaluate_definition(heap=0x00000001054034e8, env=0x0000000105402d10, form=0x0000000105402ce0) + 2406 at eval.rs:195\n    frame #8: 0x0000000100013f1b test`main::eval::evaluate(heap=0x00000001054034e8, env=0x0000000105402d90, form=0x0000000105402f30) + 1355 at eval.rs:79\n    frame #9: 0x0000000100013909 test`main::eval::evaluate_in_global_env(heap=0x00000001054034e8, form=0x0000000105402f30) + 105 at eval.rs:38\n    frame #10: 0x000000010001cd7b test`main::eval::evaluate_file(heap=0x00000001054034e8, file_path=(data_ptr = \"./tests/test_eval_closures.scmsrc/heap.rsArenaPtr(, )Rooted(\", length = 30)) + 1035 at <std macros>:286\n    frame #11: 0x000000010002c071 test`main::eval::test_eval_closures + 129 at eval.rs:403\n    frame #12: 0x0000000100087154 test`thunk::F.Invoke$LT$A$C$$u{20}R$GT$::invoke::h5218640484166224076 + 52\n    frame #13: 0x0000000100091e32 test`thunk::F.Invoke$LT$A$C$$u{20}R$GT$::invoke::h13672304839710771993 + 162\n    frame #14: 0x0000000100088912 test`thunk::F.Invoke$LT$A$C$$u{20}R$GT$::invoke::h15490786364890695979 + 1138\n    frame #15: 0x0000000100088db0 test`rt::unwind::try::try_fn::h10439459448986358359 + 160\n    frame #16: 0x000000010010a4f9 test`rust_try_inner + 9\n    frame #17: 0x000000010010a4e6 test`rust_try + 6\n    frame #18: 0x00000001000894ab test`thunk::F.Invoke$LT$A$C$$u{20}R$GT$::invoke::h13206639752781900349 + 1179\n    frame #19: 0x0000000100106eb4 test`sys::thread::thread_start::h2cb22211a4c7d938vFw + 164\n    frame #20: 0x00007fff875d3899 libsystem_pthread.dylib`_pthread_body + 138\n    frame #21: 0x00007fff875d372a libsystem_pthread.dylib`_pthread_start + 137\n    frame #22: 0x00007fff875d7fc9 libsystem_pthread.dylib`thread_start + 13\n```\n", "closed_by": {"login": "fitzgen", "id": 74571, "node_id": "MDQ6VXNlcjc0NTcx", "avatar_url": "https://avatars.githubusercontent.com/u/74571?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fitzgen", "html_url": "https://github.com/fitzgen", "followers_url": "https://api.github.com/users/fitzgen/followers", "following_url": "https://api.github.com/users/fitzgen/following{/other_user}", "gists_url": "https://api.github.com/users/fitzgen/gists{/gist_id}", "starred_url": "https://api.github.com/users/fitzgen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fitzgen/subscriptions", "organizations_url": "https://api.github.com/users/fitzgen/orgs", "repos_url": "https://api.github.com/users/fitzgen/repos", "events_url": "https://api.github.com/users/fitzgen/events{/privacy}", "received_events_url": "https://api.github.com/users/fitzgen/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/20355/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/20355/timeline", "performed_via_github_app": null, "state_reason": "completed"}