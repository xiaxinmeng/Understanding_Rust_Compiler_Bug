{"url": "https://api.github.com/repos/rust-lang/rust/issues/38157", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/38157/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/38157/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/38157/events", "html_url": "https://github.com/rust-lang/rust/issues/38157", "id": 193360445, "node_id": "MDU6SXNzdWUxOTMzNjA0NDU=", "number": 38157, "title": "ICE: unexpected definition: PrimTy(TyStr)", "user": {"login": "mzji", "id": 23279426, "node_id": "MDQ6VXNlcjIzMjc5NDI2", "avatar_url": "https://avatars.githubusercontent.com/u/23279426?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mzji", "html_url": "https://github.com/mzji", "followers_url": "https://api.github.com/users/mzji/followers", "following_url": "https://api.github.com/users/mzji/following{/other_user}", "gists_url": "https://api.github.com/users/mzji/gists{/gist_id}", "starred_url": "https://api.github.com/users/mzji/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mzji/subscriptions", "organizations_url": "https://api.github.com/users/mzji/orgs", "repos_url": "https://api.github.com/users/mzji/repos", "events_url": "https://api.github.com/users/mzji/events{/privacy}", "received_events_url": "https://api.github.com/users/mzji/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2016-12-04T16:39:56Z", "updated_at": "2016-12-04T16:44:52Z", "closed_at": "2016-12-04T16:44:52Z", "author_association": "NONE", "active_lock_reason": null, "body": "Code:\r\n```rust\r\n#![feature(unicode)]\r\n\r\npub trait ToUtf16 {\r\n    fn to_vec_u16(&self) -> Vec<u16>;\r\n}\r\n\r\nimpl ToUtf16 for str {\r\n    fn to_vec_u16(&self) -> Vec<u16> {\r\n        let mut ret_val = vec![];\r\n        str.chars().inspect(|ch| {\r\n            let mut temp = [0u16; 2];\r\n            ret_val.extend_from_slice(ch.encode_utf16(&mut temp));\r\n        }).count();\r\n        ret_val.push(0);\r\n        ret_val\r\n    }\r\n}\r\n\r\nfn main() {\r\n\r\n}\r\n```\r\nConsole output:\r\n```\r\nRunning \"cargo build\":\r\n   Compiling compiler_confirm v0.1.0 (file:///C:/Users/MYUSERNAME/Documents/Rust/compiler_confirm)\r\nerror: internal compiler error: ../src/librustc_typeck\\check/mod.rs:4396: unexpected definition: PrimTy(TyStr)\r\n\r\nnote: the compiler unexpectedly panicked. this is a bug.\r\n\r\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports\r\n\r\nnote: run with `RUST_BACKTRACE=1` for a backtrace\r\n\r\nthread 'rustc' panicked at 'Box<Any>', ../src/librustc_errors/lib.rs:423\r\nstack backtrace:\r\n   0:     0x7ffa9068035a - std::panicking::Location::line::h9363ce800e842170\r\n   1:     0x7ffa9067f7e4 - std::panicking::Location::line::h9363ce800e842170\r\n   2:     0x7ffa9068323d - std::panicking::rust_panic_with_hook::hc790e47d4ecc86cd\r\n   3:     0x7ffa90302670 - <unknown>\r\n   4:     0x7ffa9031b09e - rustc_errors::Handler::bug::h620f7270292f0095\r\n   5:     0x7ffa8e4c5655 - rustc::session::bug_fmt::he2d2f00a4afa9d1e\r\n   6:     0x7ffa8e4c548a - rustc::session::bug_fmt::he2d2f00a4afa9d1e\r\n   7:     0x7ffa8e4c4bfc - rustc::session::bug_fmt::he2d2f00a4afa9d1e\r\n   8:     0x7ffa8eae9f8a - rustc_typeck::check::FnCtxt::instantiate_value_path::h4229ac945aebfa55\r\n   9:     0x7ffa8ead45c6 - rustc_typeck::check::FnCtxt::check_struct_path::h1ff2872963f8985c\r\n  10:     0x7ffa8ead2ff1 - rustc_typeck::check::FnCtxt::check_struct_path::h1ff2872963f8985c\r\n  11:     0x7ffa8ead3a14 - rustc_typeck::check::FnCtxt::check_struct_path::h1ff2872963f8985c\r\n  12:     0x7ffa8ead2ff1 - rustc_typeck::check::FnCtxt::check_struct_path::h1ff2872963f8985c\r\n  13:     0x7ffa8ead3a14 - rustc_typeck::check::FnCtxt::check_struct_path::h1ff2872963f8985c\r\n  14:     0x7ffa8ead2ff1 - rustc_typeck::check::FnCtxt::check_struct_path::h1ff2872963f8985c\r\n  15:     0x7ffa8ead3a14 - rustc_typeck::check::FnCtxt::check_struct_path::h1ff2872963f8985c\r\n  16:     0x7ffa8ead2ff1 - rustc_typeck::check::FnCtxt::check_struct_path::h1ff2872963f8985c\r\n  17:     0x7ffa8eae836b - rustc_typeck::check::FnCtxt::check_stmt::h155d968e61fdfae6\r\n  18:     0x7ffa8eae872e - rustc_typeck::check::FnCtxt::check_block_no_value::h3ac235dc3eaa76c3\r\n  19:     0x7ffa8ead34de - rustc_typeck::check::FnCtxt::check_struct_path::h1ff2872963f8985c\r\n  20:     0x7ffa8ead2ff1 - rustc_typeck::check::FnCtxt::check_struct_path::h1ff2872963f8985c\r\n  21:     0x7ffa8eab2e8d - <rustc_typeck::check::GatherLocalsVisitor<'a, 'gcx, 'tcx> as rustc::hir::intravisit::Visitor<'gcx>>::visit_ty::hdcba5921c886305a\r\n  22:     0x7ffa8eab11c7 - rustc_typeck::check::check_drop_impls::hb6e6926f4342f9e2\r\n  23:     0x7ffa8eab5506 - rustc_typeck::check::check_item_body::h1e039ede2f960fb9\r\n  24:     0x7ffa8eaade2d - rustc_typeck::check::check_item_bodies::hd22adb7703cc56d7\r\n  25:     0x7ffa8eb37c60 - rustc_typeck::check_crate::h92f6bdfe03b6afba\r\n  26:     0x7ffa9094c10e - rustc_driver::driver::count_nodes::h84f03318ea2320a8\r\n  27:     0x7ffa908a577f - <unknown>\r\n  28:     0x7ffa90928172 - rustc_driver::driver::compile_input::h8e119234b60571d5\r\n  29:     0x7ffa90979527 - rustc_driver::run_compiler::h57c4f233cd1a0c04\r\n  30:     0x7ffa9085d7de - <unknown>\r\n  31:     0x7ffa90685c01 - _rust_maybe_catch_panic\r\n  32:     0x7ffa90887344 - <unknown>\r\n  33:     0x7ffa9067d8ae - std::sys::imp::thread::Thread::new::hd990f5dcc0d4bad9\r\n  34:     0x7ffac1388363 - BaseThreadInitThunk\r\n\r\nerror: Could not compile `compiler_confirm`.\r\n\r\nTo learn more, run the command again with --verbose.\r\n\r\n\"cargo build\" completed with code 101\r\nIt took approximately 0.895 seconds\r\n```\r\nrustc info:\r\n```\r\nrustc 1.15.0-nightly (c80c31a50 2016-12-02)\r\nbinary: rustc\r\ncommit-hash: c80c31a502c838f9ec06f1003d7c61cf9de9d551\r\ncommit-date: 2016-12-02\r\nhost: x86_64-pc-windows-msvc\r\nrelease: 1.15.0-nightly\r\nLLVM version: 3.9\r\n```", "closed_by": {"login": "mzji", "id": 23279426, "node_id": "MDQ6VXNlcjIzMjc5NDI2", "avatar_url": "https://avatars.githubusercontent.com/u/23279426?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mzji", "html_url": "https://github.com/mzji", "followers_url": "https://api.github.com/users/mzji/followers", "following_url": "https://api.github.com/users/mzji/following{/other_user}", "gists_url": "https://api.github.com/users/mzji/gists{/gist_id}", "starred_url": "https://api.github.com/users/mzji/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mzji/subscriptions", "organizations_url": "https://api.github.com/users/mzji/orgs", "repos_url": "https://api.github.com/users/mzji/repos", "events_url": "https://api.github.com/users/mzji/events{/privacy}", "received_events_url": "https://api.github.com/users/mzji/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/38157/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/38157/timeline", "performed_via_github_app": null, "state_reason": "completed"}