{"url": "https://api.github.com/repos/rust-lang/rust/issues/374", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/374/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/374/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/374/events", "html_url": "https://github.com/rust-lang/rust/issues/374", "id": 900106, "node_id": "MDU6SXNzdWU5MDAxMDY=", "number": 374, "title": "Conditional jump or move depends on uninitialized value in rustc", "user": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2011-05-14T17:26:18Z", "updated_at": "2011-05-22T06:09:59Z", "closed_at": "2011-05-22T06:09:59Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Running `make stage2/std.o VALGRIND_COMPILE=1` on Linux reports the following:\n\n```\n==15459== Conditional jump or move depends on uninitialised value(s)\n==15459==    at 0x80DA7CD: _rust_fn960_middle_ty_ty_to_str (in /home/brian/Dev/rust/build/stage1/rustc)\n==15459==    by 0x8072DA6: _rust_fn730_middle_trans_make_scalar_cmp_glue (in /home/brian/Dev/rust/build/stage1/rustc)\n==15459==    by 0x80709E0: _rust_fn728_middle_trans_make_cmp_glue (in /home/brian/Dev/rust/build/stage1/rustc)\n==15459==    by 0x806C938: _rust_fn715_middle_trans_make_generic_glue (in /home/brian/Dev/rust/build/stage1/rustc)\n==15459==    by 0x807CA3E: _rust_fn747_middle_trans_lazily_emit_tydesc_glue (in /home/brian/Dev/rust/build/stage1/rustc)\n==15459==    by 0x807E196: _rust_fn751_middle_trans_call_cmp_glue (in /home/brian/Dev/rust/build/stage1/rustc)\n==15459==    by 0x8072603: _rust_fn729_middle_trans_make_cmp_glue_inner (in /home/brian/Dev/rust/build/stage1/rustc)\n==15459==    by 0x83651CE: _rust_thunk3515_middle_trans_make_cmp_glue (in /home/brian/Dev/rust/build/stage1/rustc)\n==15459==    by 0x807584E: _rust_fn738_middle_trans_iter_structural_ty_full (in /home/brian/Dev/rust/build/stage1/rustc)\n==15459==    by 0x807163C: _rust_fn728_middle_trans_make_cmp_glue (in /home/brian/Dev/rust/build/stage1/rustc)\n==15459==    by 0x806C938: _rust_fn715_middle_trans_make_generic_glue (in /home/brian/Dev/rust/build/stage1/rustc)\n==15459==    by 0x807CA3E: _rust_fn747_middle_trans_lazily_emit_tydesc_glue (in /home/brian/Dev/rust/build/stage1/rustc)\n```\n\nI believe this test case reproduces the issue although the error manifests in a different way (it reproduces something!):\n\n```\nuse std;\nimport std::option;\nimport std::option::none;\n\ntag sty {\n    ty_nil;\n}\n\ntype raw_t = rec(sty struct,\n                 option::t[str] cname,\n                 uint hash);\n\nfn mk_raw_ty(sty st, &option::t[str] cname) -> raw_t {\n  ret rec(struct=st,\n          cname=cname,\n          hash=0u);\n}\n\nfn main() {\n  mk_raw_ty(ty_nil, none[str]);\n}\n```\n\nOn the test case valgrind reports:\n\n```\n==15590== Conditional jump or move depends on uninitialised value(s)\n==15590==    at 0x80496C3: _rust_fn1_mk_raw_ty (in /home/brian/Dev/rust/build/test/run-pass/compare.stage1)\n==15590==    by 0x8049743: _rust_fn2_main (in /home/brian/Dev/rust/build/test/run-pass/compare.stage1)\n==15590==    by 0x804945E: rust_exit_task_glue (in /home/brian/Dev/rust/build/test/run-pass/compare.stage1)\n```\n\nIt seems to be related to the alias parameter, but changing just about anything in the test case makes the bug go into hiding.\n", "closed_by": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/374/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/374/timeline", "performed_via_github_app": null, "state_reason": "completed"}