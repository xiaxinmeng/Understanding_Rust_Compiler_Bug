{"url": "https://api.github.com/repos/rust-lang/rust/issues/82872", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/82872/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/82872/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/82872/events", "html_url": "https://github.com/rust-lang/rust/issues/82872", "id": 823991542, "node_id": "MDU6SXNzdWU4MjM5OTE1NDI=", "number": 82872, "title": "Imprecise visibility error message", "user": {"login": "vchekan", "id": 106474, "node_id": "MDQ6VXNlcjEwNjQ3NA==", "avatar_url": "https://avatars.githubusercontent.com/u/106474?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vchekan", "html_url": "https://github.com/vchekan", "followers_url": "https://api.github.com/users/vchekan/followers", "following_url": "https://api.github.com/users/vchekan/following{/other_user}", "gists_url": "https://api.github.com/users/vchekan/gists{/gist_id}", "starred_url": "https://api.github.com/users/vchekan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vchekan/subscriptions", "organizations_url": "https://api.github.com/users/vchekan/orgs", "repos_url": "https://api.github.com/users/vchekan/repos", "events_url": "https://api.github.com/users/vchekan/events{/privacy}", "received_events_url": "https://api.github.com/users/vchekan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 235791, "node_id": "MDU6TGFiZWwyMzU3OTE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-diagnostics", "name": "A-diagnostics", "color": "f7e101", "default": false, "description": "Area: Messages for errors, warnings, and lints"}, {"id": 66893153, "node_id": "MDU6TGFiZWw2Njg5MzE1Mw==", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-visibility", "name": "A-visibility", "color": "f7e101", "default": false, "description": "Area: visibility/privacy modifiers such as `pub`"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 1839565265, "node_id": "MDU6TGFiZWwxODM5NTY1MjY1", "url": "https://api.github.com/repos/rust-lang/rust/labels/D-terse", "name": "D-terse", "color": "c9f7a3", "default": false, "description": "A diagnostic that doesn't give enough information about the problem at hand"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-03-07T19:01:45Z", "updated_at": "2021-03-08T18:33:19Z", "closed_at": null, "author_association": "NONE", "active_lock_reason": null, "body": "When an associated function is declared as `pub(crate)` and attempt is made to call it from outside of the crate, the error message is \r\n\r\n```\r\nerror[E0624]: associated function `new` is private\r\n --> src/bin/tool/main.rs:4:39\r\n  |\r\n4 |     let c = rust_scratchpad::Cluster::new();\r\n  |                                       ^^^ private associated function\r\n```\r\n\r\nNotice that error says that function is `private` when in fact it is `pub(crate)`. Compiler makes conclusion, that from outside of crate it is as good as `private` but does not spell this logical step.\r\nIn big project with complex exporting this skipped explanation can add to confusion.\r\n\r\nIf function is not associated, then error message is still the same, but attempt to reexport is supplemented with useful tip `note: consider marking `f` as `pub` in the imported module`:\r\n\r\n```\r\nerror[E0364]: `f` is private, and cannot be re-exported\r\n  --> src/lib.rs:11:9\r\n   |\r\n11 | pub use self::cluster::f;\r\n   |         ^^^^^^^^^^^^^^^^\r\n   |\r\nnote: consider marking `f` as `pub` in the imported module\r\n  --> src/lib.rs:11:9\r\n   |\r\n11 | pub use self::cluster::f;\r\n   |         ^^^^^^^^^^^^^^^^\r\n\r\n```\r\n\r\n`src/lib.rs`\r\n```rust\r\nmod cluster {\r\n    pub struct Cluster{}\r\n    impl Cluster {\r\n        pub(crate) fn new() -> Self {unimplemented!()}\r\n    }\r\n\r\n    pub(crate) fn f() {}\r\n}\r\n\r\npub use self::cluster::Cluster;\r\n// pub use self::cluster::f;\r\n```\r\n\r\n`bin/tool/main.rs`\r\n```rust\r\nuse rust_scratchpad;\r\n\r\nfn test1() {\r\n    let c = rust_scratchpad::Cluster::new();\r\n}\r\n\r\nfn main() {}\r\n```\r\n\r\nIt would be nice to have more precise error message which quote visibility problem as-is, or even better, explain that crate `pub(crate) of crate B is private from crate A point of view`.", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/82872/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/82872/timeline", "performed_via_github_app": null, "state_reason": null}