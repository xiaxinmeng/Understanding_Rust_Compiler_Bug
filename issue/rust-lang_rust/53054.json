{"url": "https://api.github.com/repos/rust-lang/rust/issues/53054", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/53054/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/53054/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/53054/events", "html_url": "https://github.com/rust-lang/rust/issues/53054", "id": 347578166, "node_id": "MDU6SXNzdWUzNDc1NzgxNjY=", "number": 53054, "title": "Box::into_raw(Box::from(&[1,2,3])) causes unexpected memory deallocation that compiler does not complain", "user": {"login": "hanabi1224", "id": 6546635, "node_id": "MDQ6VXNlcjY1NDY2MzU=", "avatar_url": "https://avatars.githubusercontent.com/u/6546635?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hanabi1224", "html_url": "https://github.com/hanabi1224", "followers_url": "https://api.github.com/users/hanabi1224/followers", "following_url": "https://api.github.com/users/hanabi1224/following{/other_user}", "gists_url": "https://api.github.com/users/hanabi1224/gists{/gist_id}", "starred_url": "https://api.github.com/users/hanabi1224/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hanabi1224/subscriptions", "organizations_url": "https://api.github.com/users/hanabi1224/orgs", "repos_url": "https://api.github.com/users/hanabi1224/repos", "events_url": "https://api.github.com/users/hanabi1224/events{/privacy}", "received_events_url": "https://api.github.com/users/hanabi1224/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2018-08-04T02:25:26Z", "updated_at": "2018-08-06T19:44:08Z", "closed_at": "2018-08-06T19:44:08Z", "author_association": "NONE", "active_lock_reason": null, "body": "I have a test case that when I add '&' by mistake, compiler does not complain but it causes early memory deallocation thus test fails\r\n\r\n**Correct**:\r\n\r\n```rust\r\nlet features1_ptr = Box::into_raw(Box::from([\r\n            Box::into_raw(Box::from([100.0, 40.0, 22.0])) as *const f64,\r\n            Box::into_raw(Box::from([211.0, 20.0, 2.0]))as *const f64,\r\n            Box::into_raw(Box::from([32.0, 190.0, 150.0]))as *const f64,\r\n            Box::into_raw(Box::from([2.0, 100.0, 100.0]))as *const f64,\r\n        ])) as *const *const f64;\r\n```\r\n\r\n**Problematic**:\r\n\r\n```rust\r\nlet features1_ptr = Box::into_raw(Box::from([\r\n            Box::into_raw(Box::from(&[100.0, 40.0, 22.0])) as *const f64,\r\n            Box::into_raw(Box::from(&[211.0, 20.0, 2.0]))as *const f64,\r\n            Box::into_raw(Box::from(&[32.0, 190.0, 150.0]))as *const f64,\r\n            Box::into_raw(Box::from(&[2.0, 100.0, 100.0]))as *const f64,\r\n        ])) as *const *const f64;\r\n```\r\n\r\nCode to repro:\r\nhttps://github.com/hanabi1224/RuFastEMD/blob/401d86343af23813b28989336fe557f8657dca00/tests/test.rs#L55", "closed_by": {"login": "hanabi1224", "id": 6546635, "node_id": "MDQ6VXNlcjY1NDY2MzU=", "avatar_url": "https://avatars.githubusercontent.com/u/6546635?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hanabi1224", "html_url": "https://github.com/hanabi1224", "followers_url": "https://api.github.com/users/hanabi1224/followers", "following_url": "https://api.github.com/users/hanabi1224/following{/other_user}", "gists_url": "https://api.github.com/users/hanabi1224/gists{/gist_id}", "starred_url": "https://api.github.com/users/hanabi1224/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hanabi1224/subscriptions", "organizations_url": "https://api.github.com/users/hanabi1224/orgs", "repos_url": "https://api.github.com/users/hanabi1224/repos", "events_url": "https://api.github.com/users/hanabi1224/events{/privacy}", "received_events_url": "https://api.github.com/users/hanabi1224/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/53054/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/53054/timeline", "performed_via_github_app": null, "state_reason": "completed"}