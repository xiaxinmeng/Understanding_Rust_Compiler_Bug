{"url": "https://api.github.com/repos/rust-lang/rust/issues/79373", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/79373/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/79373/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/79373/events", "html_url": "https://github.com/rust-lang/rust/issues/79373", "id": 749512655, "node_id": "MDU6SXNzdWU3NDk1MTI2NTU=", "number": 79373, "title": "Support of cdylib crate types on iOS in Rust 1.46 breaks usual build workflows", "user": {"login": "vimmerru", "id": 16944801, "node_id": "MDQ6VXNlcjE2OTQ0ODAx", "avatar_url": "https://avatars.githubusercontent.com/u/16944801?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vimmerru", "html_url": "https://github.com/vimmerru", "followers_url": "https://api.github.com/users/vimmerru/followers", "following_url": "https://api.github.com/users/vimmerru/following{/other_user}", "gists_url": "https://api.github.com/users/vimmerru/gists{/gist_id}", "starred_url": "https://api.github.com/users/vimmerru/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vimmerru/subscriptions", "organizations_url": "https://api.github.com/users/vimmerru/orgs", "repos_url": "https://api.github.com/users/vimmerru/repos", "events_url": "https://api.github.com/users/vimmerru/events{/privacy}", "received_events_url": "https://api.github.com/users/vimmerru/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 38105576, "node_id": "MDU6TGFiZWwzODEwNTU3Ng==", "url": "https://api.github.com/repos/rust-lang/rust/labels/O-ios", "name": "O-ios", "color": "6e6ec0", "default": false, "description": "Operating system: iOS"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-11-24T08:59:44Z", "updated_at": "2020-12-06T18:37:53Z", "closed_at": "2020-12-06T18:37:52Z", "author_association": "NONE", "active_lock_reason": null, "body": "PR https://github.com/rust-lang/rust/pull/73516/ added support of `cdylib` crate types on iOS. This new feature in Rust 1.46 added a lot of headache for iOS builds with `cdylib` targets. `cdylib` target is near impossible to build on iOS if you are using any crate with native dependencies (ex. openssl, libsodium, zmq). You can't just find .so files for all architectures to perform correct linking and any vendored build paths don't support iOS properly. Usual workflow is the following:\r\n\r\n1. You build `staticlib` and rely that native dependencies will be linked as frameworks later\r\n2. You setup right cocoapods in ObjectiveC/Swift wrapper.\r\n\r\nAs cargo doesn't support platform-dependent crate types https://github.com/rust-lang/cargo/issues/4881 as a result a lot of projects that require iOS support are now broken on Rust 1.46.\r\n\r\nAlso seems usual iOS tools like `cargo lipo` don't support crate type overrides for the moment.\r\n\r\nIt works on 1.45 well because cargo just skips unsupported crate types on iOS and Android.", "closed_by": {"login": "jonas-schievink", "id": 1786438, "node_id": "MDQ6VXNlcjE3ODY0Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/1786438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jonas-schievink", "html_url": "https://github.com/jonas-schievink", "followers_url": "https://api.github.com/users/jonas-schievink/followers", "following_url": "https://api.github.com/users/jonas-schievink/following{/other_user}", "gists_url": "https://api.github.com/users/jonas-schievink/gists{/gist_id}", "starred_url": "https://api.github.com/users/jonas-schievink/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jonas-schievink/subscriptions", "organizations_url": "https://api.github.com/users/jonas-schievink/orgs", "repos_url": "https://api.github.com/users/jonas-schievink/repos", "events_url": "https://api.github.com/users/jonas-schievink/events{/privacy}", "received_events_url": "https://api.github.com/users/jonas-schievink/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/79373/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/79373/timeline", "performed_via_github_app": null, "state_reason": "completed"}