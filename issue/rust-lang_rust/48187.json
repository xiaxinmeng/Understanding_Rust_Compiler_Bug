{"url": "https://api.github.com/repos/rust-lang/rust/issues/48187", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/48187/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/48187/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/48187/events", "html_url": "https://github.com/rust-lang/rust/issues/48187", "id": 296826501, "node_id": "MDU6SXNzdWUyOTY4MjY1MDE=", "number": 48187, "title": "Span that can point to closing delimiter of a delimited group", "user": {"login": "dtolnay", "id": 1940490, "node_id": "MDQ6VXNlcjE5NDA0OTA=", "avatar_url": "https://avatars.githubusercontent.com/u/1940490?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dtolnay", "html_url": "https://github.com/dtolnay", "followers_url": "https://api.github.com/users/dtolnay/followers", "following_url": "https://api.github.com/users/dtolnay/following{/other_user}", "gists_url": "https://api.github.com/users/dtolnay/gists{/gist_id}", "starred_url": "https://api.github.com/users/dtolnay/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dtolnay/subscriptions", "organizations_url": "https://api.github.com/users/dtolnay/orgs", "repos_url": "https://api.github.com/users/dtolnay/repos", "events_url": "https://api.github.com/users/dtolnay/events{/privacy}", "received_events_url": "https://api.github.com/users/dtolnay/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 234902, "node_id": "MDU6TGFiZWwyMzQ5MDI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-enhancement", "name": "C-enhancement", "color": "f5f1fd", "default": false, "description": "Category: An issue proposing an enhancement or a PR with one."}, {"id": 632573348, "node_id": "MDU6TGFiZWw2MzI1NzMzNDg=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-macros-2.0", "name": "A-macros-2.0", "color": "f7e101", "default": false, "description": "Area: declarative macros 2.0, https://github.com/rust-lang/rust/issues/39412"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-02-13T17:42:32Z", "updated_at": "2018-09-09T16:09:58Z", "closed_at": "2018-09-09T16:09:58Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "The [`proc_macro::TokenTree`](https://doc.rust-lang.org/proc_macro/enum.TokenTree.html) data structure currently look like this.\r\n\r\n```rust\r\nenum TokenTree {\r\n    Group(Group),\r\n    Ident(Ident),\r\n    Punct(Punct),\r\n    Literal(Literal),\r\n}\r\n\r\nimpl Group {\r\n    fn span(&self) -> Span;\r\n}\r\n```\r\n\r\nEvery delimited group like `(`...`)` `[`...`]` `{`...`}` has only a single `Span` that covers the full source location from opening delimiter to closing delimiter. This makes it impossible for a procedural macro to trigger an error pointing to just the opening or closing delimiter. The Rust compiler does not seem to have the same limitation:\r\n\r\n```rust\r\nmod m {\r\n    type T =\r\n}\r\n```\r\n\r\n```\r\nerror: expected type, found `}`\r\n --> src/main.rs:3:1\r\n  |\r\n3 | }\r\n  | ^\r\n```\r\n\r\nThe best things we can do in a proc macro are point to the last token inside the block, point to the entire block, or point to the next token after the block, none of which is really what you want for an error like above.", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/48187/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/48187/timeline", "performed_via_github_app": null, "state_reason": "completed"}