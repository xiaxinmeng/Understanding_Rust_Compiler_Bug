{"url": "https://api.github.com/repos/rust-lang/rust/issues/87213", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/87213/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/87213/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/87213/events", "html_url": "https://github.com/rust-lang/rust/issues/87213", "id": 946798222, "node_id": "MDU6SXNzdWU5NDY3OTgyMjI=", "number": 87213, "title": "Possible regression with llvm 12", "user": {"login": "avl", "id": 27321, "node_id": "MDQ6VXNlcjI3MzIx", "avatar_url": "https://avatars.githubusercontent.com/u/27321?v=4", "gravatar_id": "", "url": "https://api.github.com/users/avl", "html_url": "https://github.com/avl", "followers_url": "https://api.github.com/users/avl/followers", "following_url": "https://api.github.com/users/avl/following{/other_user}", "gists_url": "https://api.github.com/users/avl/gists{/gist_id}", "starred_url": "https://api.github.com/users/avl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/avl/subscriptions", "organizations_url": "https://api.github.com/users/avl/orgs", "repos_url": "https://api.github.com/users/avl/repos", "events_url": "https://api.github.com/users/avl/events{/privacy}", "received_events_url": "https://api.github.com/users/avl/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2021-07-17T10:54:03Z", "updated_at": "2021-07-17T21:02:32Z", "closed_at": "2021-07-17T21:02:09Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm developing a largeish rust-application. I'm using a few nightly features, and recently I upgraded to the latest nightly.\r\n\r\nThis caused my application to crash at start up. The problem manifests as a segfault. It only occurs in release-mode. The crash location is somewhere in glium::uniforms::UniformBuffer::empty_unsized_persistent (of the glium graphics library).\r\n\r\nI used cargo bisect rustc to pin-point the problem to commit 409920873cf8a95739a55dc5fe5adb05e1b4758e, which seems to be the upgrade to LLVM 12.\r\n\r\nI've created a minimal test case\r\n\r\nhttps://github.com/avl/rust-llvm12-regression\r\n\r\nRunning this program crashes with a segfault.\r\n\r\nThere's definitely something funny going on. Changing even inconsequential parts of the regression test case causes the behaviour to change in unpredictable ways. I'm suspicious about the glium implement_buffer_content!-macro. Perhaps there's simply a bug there?\r\n\r\nThe program works with nightlies 2021-03-04 and before, so I suppose it could also be some sort of codegen bug in rust. \r\n\r\nOutput from cargo bisect:\r\n\r\n```\r\n********************************************************************************\r\nRegression in 409920873cf8a95739a55dc5fe5adb05e1b4758e\r\n********************************************************************************\r\n\r\n==================================================================================\r\n= Please file this regression report on the rust-lang/rust GitHub repository     =\r\n=        New issue: https://github.com/rust-lang/rust/issues/new                 =\r\n=     Known issues: https://github.com/rust-lang/rust/issues                     =\r\n= Copy and paste the text below into the issue report thread.  Thanks!           =\r\n==================================================================================\r\n\r\nsearched nightlies: from nightly-2021-03-01 to nightly-2021-04-01\r\nregressed nightly: nightly-2021-03-05\r\nsearched commits: from https://github.com/rust-lang/rust/commit/476acbf1e9965b5e95c90f0d7d658709812b7003 to https://github.com/rust-lang/rust/commit/45b3c28518e4c45dfd12bc2c4400c0d0e9639927\r\nregressed commit: https://github.com/rust-lang/rust/commit/409920873cf8a95739a55dc5fe5adb05e1b4758e\r\n\r\n<details>\r\n<summary>bisected with <a href='https://github.com/rust-lang/cargo-bisect-rustc'>cargo-bisect-rustc</a> v0.6.0</summary>\r\n\r\n\r\nHost triple: x86_64-unknown-linux-gnu\r\nReproduce with:\r\nbash\r\ncargo bisect-rustc 2021-03-01 --end 2021-04-01 --script /home/anders/octosim/test.sh \r\n\r\n</details>\r\n```\r\nI'm running x86_64 linux, ubuntu 20.04.\r\n\r\n\r\n", "closed_by": {"login": "avl", "id": 27321, "node_id": "MDQ6VXNlcjI3MzIx", "avatar_url": "https://avatars.githubusercontent.com/u/27321?v=4", "gravatar_id": "", "url": "https://api.github.com/users/avl", "html_url": "https://github.com/avl", "followers_url": "https://api.github.com/users/avl/followers", "following_url": "https://api.github.com/users/avl/following{/other_user}", "gists_url": "https://api.github.com/users/avl/gists{/gist_id}", "starred_url": "https://api.github.com/users/avl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/avl/subscriptions", "organizations_url": "https://api.github.com/users/avl/orgs", "repos_url": "https://api.github.com/users/avl/repos", "events_url": "https://api.github.com/users/avl/events{/privacy}", "received_events_url": "https://api.github.com/users/avl/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/87213/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/87213/timeline", "performed_via_github_app": null, "state_reason": "completed"}