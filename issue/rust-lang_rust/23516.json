{"url": "https://api.github.com/repos/rust-lang/rust/issues/23516", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/23516/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/23516/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/23516/events", "html_url": "https://github.com/rust-lang/rust/issues/23516", "id": 63010983, "node_id": "MDU6SXNzdWU2MzAxMDk4Mw==", "number": 23516, "title": "overlap check fails to prevent overlap", "user": {"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 37544, "node_id": "MDU6TGFiZWwzNzU0NA==", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-typesystem", "name": "A-typesystem", "color": "f7e101", "default": false, "description": "Area: The type system"}, {"id": 13836860, "node_id": "MDU6TGFiZWwxMzgzNjg2MA==", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-traits", "name": "A-traits", "color": "f7e101", "default": false, "description": "Area: Trait system"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2015-03-19T15:07:21Z", "updated_at": "2015-04-02T01:32:53Z", "closed_at": "2015-04-02T01:32:53Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "While writing a blog post exploring #23086, I found a bug in the overlap checker. I haven't decided yet on the best fix here, but these two files should yield an error somewhere (currently, compiling crate2.rs ICEs due to ambiguity):\n\n``` rust\n// crate1.rs\n#![crate_type=\"rlib\"]\n\npub trait Sugar { fn dummy(&self) { } }\npub trait Sweet { fn dummy(&self) { } }\nimpl<T:Sugar> Sweet for T { }\nimpl<U:Sweet> Sweet for Box<U> { }\n```\n\nI was surprised that this crate passed the overlap check, but it does. In particular, the overlap checker considers `Box<$0>: Sugar` to be unimplemented. I think this was due to me tightening the rules a bit _too_ much on how it treats unbound variables. The problem is that now one can come from another crate and implement both `Sugar` and `Sweet` to cause ambiguity:\n\n``` rust\n// crate2.rs\nextern crate crate1;\nuse crate1::{Sugar, Sweet};\n\nstruct Cube;\nimpl Sugar for Box<Cube> { }\nimpl Sweet for Cube { }\n\nfn foo<T:Sweet>() {\n}\n\nfn main() {\n    foo::<Box<Cube>>();\n}\n```\n\nPossibly the fix is to tighten the overlap checker on crate1, but I'm not sure of the fallout from that. Another option is to widen the overlap search in crate2, potentially.\n\ncc @aturon \ncc @arielb1 (this will interest you I'm sure)\n", "closed_by": {"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/23516/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/23516/timeline", "performed_via_github_app": null, "state_reason": "completed"}