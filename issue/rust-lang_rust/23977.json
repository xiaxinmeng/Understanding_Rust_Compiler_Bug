{"url": "https://api.github.com/repos/rust-lang/rust/issues/23977", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/23977/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/23977/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/23977/events", "html_url": "https://github.com/rust-lang/rust/issues/23977", "id": 65985054, "node_id": "MDU6SXNzdWU2NTk4NTA1NA==", "number": 23977, "title": "Pathological case in typechecking", "user": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 64037154, "node_id": "MDU6TGFiZWw2NDAzNzE1NA==", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-compiletime", "name": "I-compiletime", "color": "e11d21", "default": false, "description": "Problems and improvements with respect to compile times."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2015-04-02T18:29:05Z", "updated_at": "2016-02-29T00:01:59Z", "closed_at": "2016-02-29T00:01:59Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "This simple program takes ~1minute to compile:\n\n``` rust\nmacro_rules! f0( () => (1) );\nmacro_rules! f1( () => ({(f0!()) + (f0!())}) );\nmacro_rules! f2( () => ({(f1!()) + (f1!())}) );\nmacro_rules! f3( () => ({(f2!()) + (f2!())}) );\nmacro_rules! f4( () => ({(f3!()) + (f3!())}) );\nmacro_rules! f5( () => ({(f4!()) + (f4!())}) );\nmacro_rules! f6( () => ({(f5!()) + (f5!())}) );\nmacro_rules! f7( () => ({(f6!()) + (f6!())}) );\nmacro_rules! f8( () => ({(f7!()) + (f7!())}) );\nmacro_rules! f9( () => ({(f8!()) + (f8!())}) );\nmacro_rules! f10( () => ({(f9!()) + (f9!())}) );\nmacro_rules! f11( () => ({(f10!()) + (f10!())}) );\nfn main() {\n    f10!();\n}\n```\n\nThe output of `-Z time-passes` looks like:\n\n```\ntime: 0.000     parsing\ntime: 0.000     recursion limit\ntime: 0.000     gated macro checking\ntime: 0.000     configuration 1\ntime: 0.000     crate injection\ntime: 0.012     macro loading\ntime: 0.000     plugin loading\ntime: 0.000     plugin registration\ntime: 0.032     expansion\ntime: 0.000     complete gated feature checking 1\ntime: 0.002     configuration 2\ntime: 0.001     maybe building test harness\ntime: 0.001     prelude injection\ntime: 0.000     checking that all macro invocations are gone\ntime: 0.000     complete gated feature checking 2\ntime: 0.001     assigning node ids and indexing ast\ntime: 0.000     external crate/lib resolution\ntime: 0.000     language item collection\ntime: 0.001     resolution\ntime: 0.000     lifetime resolution\ntime: 0.000     looking for entry point\ntime: 0.000     looking for plugin registrar\ntime: 0.001     region resolution\ntime: 0.000     loop checking\ntime: 0.000     static item recursion checking\ntime: 0.000     type collecting\ntime: 0.000     variance inference\ntime: 0.169     coherence checking\ntime: 55.344    type checking\ntime: 0.009     const checking\ntime: 0.000     privacy checking\ntime: 0.000     stability index\ntime: 0.000     intrinsic checking\ntime: 0.000     effect checking\ntime: 0.000     match checking\ntime: 0.000     liveness checking\ntime: 0.023     borrow checking\ntime: 0.010     rvalue checking\ntime: 0.000     reachability checking\ntime: 0.000     death checking\ntime: 0.000     stability checking\ntime: 0.000     unused lib feature checking\ntime: 0.004     lint checking\ntime: 0.000     resolving dependency formats\ntime: 0.002     translation\n  time: 0.000   llvm function passes\n  time: 0.000   llvm module passes\n  time: 0.002   codegen passes\n  time: 0.000   codegen passes\ntime: 0.007     LLVM passes\n  time: 0.242   running linker\ntime: 0.243     linking\n```\n\nAnd profiling using OSX looks like:\n\n![https://i.imgur.com/pJ79n02.jpg](https://i.imgur.com/pJ79n02.jpg)\n\ncc @pnkfelix, @nikomatsakis \n\nThis was discovered in updating cargo with a rustc from 3/26 to 4/2, so it looks like it may be a recent regression?\n", "closed_by": {"login": "bluss", "id": 3209739, "node_id": "MDQ6VXNlcjMyMDk3Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3209739?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bluss", "html_url": "https://github.com/bluss", "followers_url": "https://api.github.com/users/bluss/followers", "following_url": "https://api.github.com/users/bluss/following{/other_user}", "gists_url": "https://api.github.com/users/bluss/gists{/gist_id}", "starred_url": "https://api.github.com/users/bluss/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bluss/subscriptions", "organizations_url": "https://api.github.com/users/bluss/orgs", "repos_url": "https://api.github.com/users/bluss/repos", "events_url": "https://api.github.com/users/bluss/events{/privacy}", "received_events_url": "https://api.github.com/users/bluss/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/23977/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/23977/timeline", "performed_via_github_app": null, "state_reason": "completed"}