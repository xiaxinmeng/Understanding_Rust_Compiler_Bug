{"url": "https://api.github.com/repos/rust-lang/rust/issues/34687", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/34687/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/34687/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/34687/events", "html_url": "https://github.com/rust-lang/rust/issues/34687", "id": 164125741, "node_id": "MDU6SXNzdWUxNjQxMjU3NDE=", "number": 34687, "title": "rustbuild: Ensure that it's ready for distros", "user": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 325438536, "node_id": "MDU6TGFiZWwzMjU0Mzg1MzY=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-bootstrap", "name": "T-bootstrap", "color": "bfd4f2", "default": false, "description": "Relevant to the bootstrap subteam: Rust's build system (x.py and src/bootstrap)"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2016-07-06T17:03:21Z", "updated_at": "2016-11-09T23:13:52Z", "closed_at": "2016-11-09T23:13:52Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "## Update description\n\nTo be amenable to packaging in distros, the remaining tasks for rustbuild left to be implemented are:\n- [x] Leverage Cargo workspaces\n- [ ] Vendor Cargo dependencies in source tarballs, and configure the tarballs to use these dependencies\n## Original description\n\nWhen moving to rustbuild we're going to be using Cargo as part of the build system which has historically been difficult to work with the requirements that Linux distributions have. Let's be sure that the transition process from the makefiles to rustbuild is a smooth one though and get ahead of any concerns here!\n\nMy current plan is to do the following:\n- Assume that distros arrange for us to have the correct stage0 rustc binary somewhere, configured via `--enable-local-rust` or `build.rustc` in `config.toml`.\n- Assume that distros arrange for us to have the correct stage0 cargo binary somewhere, configured similar to rustc above.\n- Use the [workspaces feature](https://github.com/rust-lang/cargo/pull/2759) in Cargo to ensure that there's only one `Cargo.lock` for the entire rust repo, so there's one list of what we depend on as part of the build with Cargo.\n- Use a vendoring solution similar to [what was proposed before](https://github.com/rust-lang/cargo/pull/2361) where our source tarballs will contain all our crates.io dependencies (e.g. gcc-rs, cmake-rs, and eventually other crates from crates.io used to build rustc).\n\nGiven all that, we will be able to build deterministically without network access, but perhaps this is not enough! I'm curious what others think about the assumptions here about rustc/cargo, or if there are other gotchas we should take care of as well.\n\ncc @cuviper, @anguslees, @lucab, @jauhien, @fabiand\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/34687/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/34687/timeline", "performed_via_github_app": null, "state_reason": "completed"}