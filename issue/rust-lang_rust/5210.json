{"url": "https://api.github.com/repos/rust-lang/rust/issues/5210", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/5210/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/5210/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/5210/events", "html_url": "https://github.com/rust-lang/rust/issues/5210", "id": 11589863, "node_id": "MDU6SXNzdWUxMTU4OTg2Mw==", "number": 5210, "title": "ty_bare_fn consts have an environment pointer, but their type doesn't.", "user": {"login": "jld", "id": 254973, "node_id": "MDQ6VXNlcjI1NDk3Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/254973?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jld", "html_url": "https://github.com/jld", "followers_url": "https://api.github.com/users/jld/followers", "following_url": "https://api.github.com/users/jld/following{/other_user}", "gists_url": "https://api.github.com/users/jld/gists{/gist_id}", "starred_url": "https://api.github.com/users/jld/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jld/subscriptions", "organizations_url": "https://api.github.com/users/jld/orgs", "repos_url": "https://api.github.com/users/jld/repos", "events_url": "https://api.github.com/users/jld/events{/privacy}", "received_events_url": "https://api.github.com/users/jld/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2013-03-03T11:13:39Z", "updated_at": "2013-03-05T20:01:07Z", "closed_at": "2013-03-05T20:01:07Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "```\nfn f() { }\nconst fs: &[extern fn()] = &[f, f];\nfn main() { for fs.each |&g| { g() } }\n```\n\nThe `type_of` (and `sizing_type_of`) for that `extern fn` is just a pointer, but what's getting generated for the constant also has an environment pointer.  Because we have to defeat LLVM's type checks to support enums (and we don't have sufficient assertions of our own), we don't catch the mismatch and the second call to `f` jumps through the first array element's null environment pointer instead.\n", "closed_by": {"login": "jld", "id": 254973, "node_id": "MDQ6VXNlcjI1NDk3Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/254973?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jld", "html_url": "https://github.com/jld", "followers_url": "https://api.github.com/users/jld/followers", "following_url": "https://api.github.com/users/jld/following{/other_user}", "gists_url": "https://api.github.com/users/jld/gists{/gist_id}", "starred_url": "https://api.github.com/users/jld/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jld/subscriptions", "organizations_url": "https://api.github.com/users/jld/orgs", "repos_url": "https://api.github.com/users/jld/repos", "events_url": "https://api.github.com/users/jld/events{/privacy}", "received_events_url": "https://api.github.com/users/jld/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/5210/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/5210/timeline", "performed_via_github_app": null, "state_reason": "completed"}