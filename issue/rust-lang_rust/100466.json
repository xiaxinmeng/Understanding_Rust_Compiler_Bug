{"url": "https://api.github.com/repos/rust-lang/cargo/issues/10984", "repository_url": "https://api.github.com/repos/rust-lang/cargo", "labels_url": "https://api.github.com/repos/rust-lang/cargo/issues/10984/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/cargo/issues/10984/comments", "events_url": "https://api.github.com/repos/rust-lang/cargo/issues/10984/events", "html_url": "https://github.com/rust-lang/cargo/issues/10984", "id": 1337756663, "node_id": "I_kwDOAQnScc5PvIv3", "number": 10984, "title": "Cargo should skip crates.io check with --locked and all dependencies already resolved", "user": {"login": "mqudsi", "id": 606923, "node_id": "MDQ6VXNlcjYwNjkyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/606923?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mqudsi", "html_url": "https://github.com/mqudsi", "followers_url": "https://api.github.com/users/mqudsi/followers", "following_url": "https://api.github.com/users/mqudsi/following{/other_user}", "gists_url": "https://api.github.com/users/mqudsi/gists{/gist_id}", "starred_url": "https://api.github.com/users/mqudsi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mqudsi/subscriptions", "organizations_url": "https://api.github.com/users/mqudsi/orgs", "repos_url": "https://api.github.com/users/mqudsi/repos", "events_url": "https://api.github.com/users/mqudsi/events{/privacy}", "received_events_url": "https://api.github.com/users/mqudsi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 278183759, "node_id": "MDU6TGFiZWwyNzgxODM3NTk=", "url": "https://api.github.com/repos/rust-lang/cargo/labels/Command-install", "name": "Command-install", "color": "5319e7", "default": false, "description": null}, {"id": 4423642871, "node_id": "LA_kwDOAQnScc8AAAABB6tu9w", "url": "https://api.github.com/repos/rust-lang/cargo/labels/A-yanked", "name": "A-yanked", "color": "fbca04", "default": false, "description": "Area: yanked dependencies"}, {"id": 5409464838, "node_id": "LA_kwDOAQnScc8AAAABQm3iBg", "url": "https://api.github.com/repos/rust-lang/cargo/labels/S-needs-team-input", "name": "S-needs-team-input", "color": "d3dddd", "default": false, "description": "Status: Needs input from team on whether/how to proceed."}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2022-08-12T21:37:51Z", "updated_at": "2023-05-24T13:15:30Z", "closed_at": null, "author_association": "NONE", "active_lock_reason": null, "body": "Last week there was a temporary outage of crates.io and my build requests were all hanging on \"Updating crates.io index\" even though they were subsequent invocations of the same `cargo` command, seconds apart, with `--locked` specified, e.g.\r\n\r\n```\r\n> cargo install --locked --path .\r\n> cargo install --locked --path .\r\n```\r\n\r\nIf all the dependencies in `Cargo.toml` are in `Cargo.lock` and `Cargo.lock` is itself in a fully consistent state with no missing dependencies, `cargo install --locked` should be equivalent to `cargo install --offline --locked` (which is what I ended up using). (Please let me know if I'm missing something that cargo needs internet access for if all dependencies are present and account for.)\r\n\r\nI would also argue that there should be some sort of recency check before `cargo install` forces an update of the crates.io index, regardless of whether or not `--locked` was specified. If all dependencies are present and account for and the lock file is in a consistent state and all integrity checks pass, there's no reason for to back-to-back invocations of `cargo install --path ...` to hit the crates.io server (slowing down the effective/observed compile time, generating unnecessary load on the crates.io server, and raising privacy concerns).\r\n\r\nExperienced with cargo 1.63.0-nightly (8d42b0e87 2022-06-17)\r\n\r\n@rustbot label +T-cargo +A-incr-comp +I-compiletime", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/cargo/issues/10984/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/cargo/issues/10984/timeline", "performed_via_github_app": null, "state_reason": null}