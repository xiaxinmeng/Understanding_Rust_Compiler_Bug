{"url": "https://api.github.com/repos/rust-lang/rust/issues/35869", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/35869/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/35869/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/35869/events", "html_url": "https://github.com/rust-lang/rust/issues/35869", "id": 172305735, "node_id": "MDU6SXNzdWUxNzIzMDU3MzU=", "number": 35869, "title": "compiler panic using nightly on rustc_typeck::check::compare_method::compare_impl_method::_{{closure}}::h08bef90d287aed42", "user": {"login": "seppo0010", "id": 223776, "node_id": "MDQ6VXNlcjIyMzc3Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/223776?v=4", "gravatar_id": "", "url": "https://api.github.com/users/seppo0010", "html_url": "https://github.com/seppo0010", "followers_url": "https://api.github.com/users/seppo0010/followers", "following_url": "https://api.github.com/users/seppo0010/following{/other_user}", "gists_url": "https://api.github.com/users/seppo0010/gists{/gist_id}", "starred_url": "https://api.github.com/users/seppo0010/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/seppo0010/subscriptions", "organizations_url": "https://api.github.com/users/seppo0010/orgs", "repos_url": "https://api.github.com/users/seppo0010/repos", "events_url": "https://api.github.com/users/seppo0010/events{/privacy}", "received_events_url": "https://api.github.com/users/seppo0010/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}, {"id": 147085028, "node_id": "MDU6TGFiZWwxNDcwODUwMjg=", "url": "https://api.github.com/repos/rust-lang/rust/labels/regression-from-stable-to-nightly", "name": "regression-from-stable-to-nightly", "color": "e4008a", "default": false, "description": "Performance or correctness regression from stable to nightly."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2016-08-21T05:30:04Z", "updated_at": "2016-08-27T09:49:27Z", "closed_at": "2016-08-27T09:49:27Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I'm not quite sure if what I'm doing is correct, but since I got a compiler panic I thought I should report it. You can download the full project from here https://github.com/seppo0010/limitd-rs/tree/rustc-crash ; I created a tag to point to the commit that reproduces the crash.\n\nThe relevant code is probably within this function definition\n\n```\n    fn put(&self, key: &[u8], value: &[u8]) -> Box<Future<Item=(), Error=Error>> {\n        let mut opts = Options::new();\n        opts.create_if_missing = true;\n        let db = match LDatabase::open(Path::new(&*self.path), opts) {\n            Ok(db) => Box::new(db),\n            Err(e) => { panic!(\"failed to open database: {:?}\", e) }\n        };\n        let write_opts = WriteOptions::new();\n        match db.put(write_opts, key, value) {\n            Ok(_) => { return finished(()).boxed() },\n            Err(e) => { return failed(Error::LevelDBError(e)).boxed() }\n        }\n    }\n```\n\nThis is my rustc version\n\n```\nrustc --version --verbose\nrustc 1.13.0-nightly (f883b0bba 2016-08-19)\nbinary: rustc\ncommit-hash: f883b0bbab6c433eb7b7042b605b4339022c563a\ncommit-date: 2016-08-19\nhost: x86_64-unknown-linux-gnu\nrelease: 1.13.0-nightly\n```\n\nand the build command with the backtrace\n\n```\nRUST_BACKTRACE=1 cargo build --verbose\n       Fresh slab v0.2.0 (https://github.com/carllerche/slab?rev=5476efcafb#5476efca)\n       Fresh void v1.0.2\n       Fresh semver v0.1.20\n       Fresh winapi-build v0.1.1\n       Fresh slab v0.2.0\n       Fresh libc v0.2.15\n       Fresh scoped-tls v0.1.0\n       Fresh db-key v0.0.5\n       Fresh winapi v0.2.8\n       Fresh utf8-ranges v0.1.3\n       Fresh getopts v0.2.14\n       Fresh bitflags v0.4.0\n       Fresh memchr v0.1.11\n       Fresh protobuf v1.0.23\n       Fresh db-key v0.1.0\n       Fresh cfg-if v0.1.0\n       Fresh regex-syntax v0.3.4\n       Fresh aho-corasick v0.5.2\n       Fresh log v0.3.6\n       Fresh leveldb-sys v2.0.0\n       Fresh net2 v0.2.26\n       Fresh kernel32-sys v0.2.2\n       Fresh futures v0.1.0 (https://github.com/alexcrichton/futures-rs?rev=71801dc#71801dcd)\n       Fresh leveldb v0.8.3\n       Fresh rustc_version v0.1.7\n       Fresh time v0.1.35\n       Fresh futures-io v0.1.0 (https://github.com/alexcrichton/futures-rs?rev=71801dc#71801dcd)\n       Fresh thread-id v2.0.0\n       Fresh thread_local v0.2.6\n       Fresh regex v0.1.73\n       Fresh env_logger v0.3.4\n       Fresh nix v0.6.0\n       Fresh mio v0.6.0-dev (https://github.com/carllerche/mio#00e19dd6)\n       Fresh futures-mio v0.1.0 (https://github.com/alexcrichton/futures-rs?rev=71801dc#71801dcd)\n   Compiling limitd-rs v0.1.0 (file:///home/seppo/Projects/limitd-rs)\n     Running `rustc src/main.rs --crate-name limitd_rs --crate-type bin -g -C metadata=137628deb0353257 --out-dir /home/seppo/Projects/limitd-rs/target/debug --emit=dep-info,link -L dependency=/home/seppo/Projects/limitd-rs/target/debug/deps --extern futures_mio=/home/seppo/Projects/limitd-rs/target/debug/deps/libfutures_mio-3c1106ba38a0682a.rlib --extern leveldb=/home/seppo/Projects/limitd-rs/target/debug/deps/libleveldb-497869f359049725.rlib --extern net2=/home/seppo/Projects/limitd-rs/target/debug/deps/libnet2-755d3e4f87237d0e.rlib --extern time=/home/seppo/Projects/limitd-rs/target/debug/deps/libtime-750bfdd52feafcb7.rlib --extern log=/home/seppo/Projects/limitd-rs/target/debug/deps/liblog-bf16bb9a4912b11d.rlib --extern env_logger=/home/seppo/Projects/limitd-rs/target/debug/deps/libenv_logger-2296687296dd1e8e.rlib --extern futures_io=/home/seppo/Projects/limitd-rs/target/debug/deps/libfutures_io-20978b51499790d1.rlib --extern getopts=/home/seppo/Projects/limitd-rs/target/debug/deps/libgetopts-33691dbdf8852281.rlib --extern futures=/home/seppo/Projects/limitd-rs/target/debug/deps/libfutures-0ff68d58cf5da702.rlib --extern protobuf=/home/seppo/Projects/limitd-rs/target/debug/deps/libprotobuf-6820fc0a7d02519c.rlib --extern db_key=/home/seppo/Projects/limitd-rs/target/debug/deps/libdb_key-3e97f27935b69eb3.rlib -L native=/home/seppo/Projects/limitd-rs/target/debug/build/leveldb-sys-c084cdddf63c7867/out`\nerror: internal compiler error: unexpected panic\n\nnote: the compiler unexpectedly panicked. this is a bug.\n\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports\n\nnote: run with `RUST_BACKTRACE=1` for a backtrace\n\nthread 'rustc' panicked at 'called `Option::unwrap()` on a `None` value', ../src/libcore/option.rs:326\nstack backtrace:\n   1:     0x7f8d0fea7de9 - std::sys::backtrace::tracing::imp::write::h482d45d91246faa2\n   2:     0x7f8d0feb84dc - std::panicking::default_hook::_{{closure}}::h89158f66286b674e\n   3:     0x7f8d0feb67e7 - std::panicking::default_hook::h9e30d428ee3b0c43\n   4:     0x7f8d0feb6ff8 - std::panicking::rust_panic_with_hook::h2224f33fb7bf2f4c\n   5:     0x7f8d0feb6e92 - std::panicking::begin_panic::hcb11a4dc6d779ae5\n   6:     0x7f8d0feb6dc0 - std::panicking::begin_panic_fmt::h310416c62f3935b3\n   7:     0x7f8d0feb6d41 - rust_begin_unwind\n   8:     0x7f8d0ff2240f - core::panicking::panic_fmt::hc5789f4e80194729\n   9:     0x7f8d0ff2233b - core::panicking::panic::h1953378f4b37b561\n  10:     0x7f8d0e59bf3c - rustc_typeck::check::compare_method::compare_impl_method::_{{closure}}::h08bef90d287aed42\n  11:     0x7f8d0e4f8099 - rustc_typeck::check::compare_method::compare_impl_method::he3538453c2efe177\n  12:     0x7f8d0e50cde2 - rustc_typeck::check::check_impl_items_against_trait::hb105ca8bb42a0b3d\n  13:     0x7f8d0e50a5a2 - rustc_typeck::check::check_item_type::hba3733559d49be1e\n  14:     0x7f8d0e502deb - _<rustc_typeck..check..CheckItemTypesVisitor<'a, 'tcx> as rustc..hir..intravisit..Visitor<'tcx>>::visit_item::h369cacffbaa18923\n  15:     0x7f8d0e504ceb - rustc_typeck::check::check_item_types::h81e44a5d40f450fd\n  16:     0x7f8d0e57c323 - rustc_typeck::check_crate::h8ec8b2f490f5dc28\n  17:     0x7f8d10297b03 - rustc_driver::driver::phase_3_run_analysis_passes::_{{closure}}::h45e03cee16dcf298\n  18:     0x7f8d10264546 - rustc_driver::driver::phase_3_run_analysis_passes::hc0de40cea97d81a1\n  19:     0x7f8d10250f02 - rustc_driver::driver::compile_input::hd9ecc57abd3cba85\n  20:     0x7f8d10283756 - rustc_driver::run_compiler::h184264500271cc39\n  21:     0x7f8d101c98c2 - std::panicking::try::do_call::h17a7a17ad7240c5c\n  22:     0x7f8d0fec6846 - __rust_maybe_catch_panic\n  23:     0x7f8d101e326a - _<F as alloc..boxed..FnBox<A>>::call_box::h93f9128277b2964a\n  24:     0x7f8d0feb4bb2 - std::sys::thread::Thread::new::thread_start::he0bf102845911132\n  25:     0x7f8d081cd181 - start_thread\n  26:     0x7f8d0faef47c - __clone\n  27:                0x0 - <unknown>\n\nerror: Could not compile `limitd-rs`.\n\nCaused by:\n  Process didn't exit successfully: `rustc src/main.rs --crate-name limitd_rs --crate-type bin -g -C metadata=137628deb0353257 --out-dir /home/seppo/Projects/limitd-rs/target/debug --emit=dep-info,link -L dependency=/home/seppo/Projects/limitd-rs/target/debug/deps --extern futures_mio=/home/seppo/Projects/limitd-rs/target/debug/deps/libfutures_mio-3c1106ba38a0682a.rlib --extern leveldb=/home/seppo/Projects/limitd-rs/target/debug/deps/libleveldb-497869f359049725.rlib --extern net2=/home/seppo/Projects/limitd-rs/target/debug/deps/libnet2-755d3e4f87237d0e.rlib --extern time=/home/seppo/Projects/limitd-rs/target/debug/deps/libtime-750bfdd52feafcb7.rlib --extern log=/home/seppo/Projects/limitd-rs/target/debug/deps/liblog-bf16bb9a4912b11d.rlib --extern env_logger=/home/seppo/Projects/limitd-rs/target/debug/deps/libenv_logger-2296687296dd1e8e.rlib --extern futures_io=/home/seppo/Projects/limitd-rs/target/debug/deps/libfutures_io-20978b51499790d1.rlib --extern getopts=/home/seppo/Projects/limitd-rs/target/debug/deps/libgetopts-33691dbdf8852281.rlib --extern futures=/home/seppo/Projects/limitd-rs/target/debug/deps/libfutures-0ff68d58cf5da702.rlib --extern protobuf=/home/seppo/Projects/limitd-rs/target/debug/deps/libprotobuf-6820fc0a7d02519c.rlib --extern db_key=/home/seppo/Projects/limitd-rs/target/debug/deps/libdb_key-3e97f27935b69eb3.rlib -L native=/home/seppo/Projects/limitd-rs/target/debug/build/leveldb-sys-c084cdddf63c7867/out` (exit code: 101)\n```\n\nThanks!\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/35869/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/35869/timeline", "performed_via_github_app": null, "state_reason": "completed"}