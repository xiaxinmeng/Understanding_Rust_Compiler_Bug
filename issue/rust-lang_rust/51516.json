{"url": "https://api.github.com/repos/rust-lang/rust/issues/51516", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/51516/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/51516/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/51516/events", "html_url": "https://github.com/rust-lang/rust/issues/51516", "id": 331536342, "node_id": "MDU6SXNzdWUzMzE1MzYzNDI=", "number": 51516, "title": "\"internal compiler error: unexpected panic\" - when trying to run `cargo test` on nightly and stable", "user": {"login": "dignifiedquire", "id": 790842, "node_id": "MDQ6VXNlcjc5MDg0Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/790842?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dignifiedquire", "html_url": "https://github.com/dignifiedquire", "followers_url": "https://api.github.com/users/dignifiedquire/followers", "following_url": "https://api.github.com/users/dignifiedquire/following{/other_user}", "gists_url": "https://api.github.com/users/dignifiedquire/gists{/gist_id}", "starred_url": "https://api.github.com/users/dignifiedquire/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dignifiedquire/subscriptions", "organizations_url": "https://api.github.com/users/dignifiedquire/orgs", "repos_url": "https://api.github.com/users/dignifiedquire/repos", "events_url": "https://api.github.com/users/dignifiedquire/events{/privacy}", "received_events_url": "https://api.github.com/users/dignifiedquire/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-06-12T10:51:29Z", "updated_at": "2018-07-10T05:15:05Z", "closed_at": "2018-07-10T05:15:05Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am working on a private project, and just discovered the following panic on the nightly compiler, when running `cargo test`\r\n\r\n```\r\n> RUST_BACKTRACE=1 cargo test\r\nthread 'main' panicked at 'called `Result::unwrap()` on an `Err` value: (MoveData { move_paths: [MovePath { place: _0 }, MovePath { place: _1 }, MovePath { place: _2 }, MovePath { place: _3 }, MovePath { place: _4 }, MovePath { place: _5 }, MovePath { place: _6 }, MovePath { place: _7 }, MovePath { place: _8 }, MovePath { place: _9 }, MovePath { place: _10 }], moves: [mp7@bb0[7], mp7@bb2[0], mp6@bb2[5], mp8@bb2[5], mp3@bb3[0], mp8@bb4[0], mp6@bb4[1], mp6@bb5[0], mp6@bb6[0], mp5@bb7[0], mp10@bb7[0], mp10@bb7[1], mp5@bb7[2], mp4@bb7[3], mp4@bb7[4], mp9@bb7[5], mp3@bb7[6], mp3@bb8[0], mp0@bb8[1]], loc_map: LocationMap { map: [[[], [], [], [], [], [], [], [mo0]], [[]], [[mo1], [], [], [], [], [mo2, mo3]], [[mo4]], [[mo5], [mo6]], [[mo7]], [[mo8], [], []], [[mo9, mo10], [mo11], [mo12], [mo13], [mo14], [mo15], [mo16]], [[mo17], [mo18]]] }, path_map: [[mo18], [], [], [mo4, mo16, mo17], [mo13, mo14], [mo9, mo12], [mo2, mo6, mo7, mo8], [mo0, mo1], [mo3, mo5], [mo15], [mo10, mo11]], rev_lookup: MovePathLookup { locals: [mp0, mp1, mp2, mp3, mp4, mp5, mp6, mp7, mp8, mp9, mp10], projections: {} }, inits: [mp1@src/circuit/drgporep/mod.rs:268:22: 276:18 (Deep), mp2@src/circuit/drgporep/mod.rs:268:23: 268:38 (Deep), mp3@src/circuit/drgporep/mod.rs:268:27: 268:37 (Deep), mp7@src/circuit/drgporep/mod.rs:270:32: 271:34 (Deep), mp6@src/circuit/drgporep/mod.rs:270:32: 272:56 (NonPanicPathOnly), mp9@src/circuit/drgporep/mod.rs:273:37: 273:80 (Deep), mp8@src/circuit/drgporep/mod.rs:273:37: 273:80 (Deep), mp5@src/circuit/drgporep/mod.rs:270:32: 273:81 (NonPanicPathOnly), mp10@src/circuit/drgporep/mod.rs:274:37: 274:59 (NonPanicPathOnly), mp4@src/circuit/drgporep/mod.rs:269:26: 275:22 (Deep), mp0@src/circuit/drgporep/mod.rs:269:21: 275:23 (Deep)], init_loc_map: LocationMap { map: [[[], [in2], [], [], [], [], [in3], [in4]], [[]], [[], [], [], [in5], [in6], [in7]], [[]], [[], []], [[]], [[], [], [in8]], [[in9], [], [], [in10], [], [], []], [[], []]] }, init_path_map: [[in10], [in0], [in1], [in2], [in9], [in7], [in4], [in3], [in6], [in5], [in8]] }, [IllegalMove { cannot_move_out_of: IllegalMoveOrigin { span: src/circuit/drgporep/mod.rs:268:27: 268:37, kind: BorrowedContent { target_ty: (usize, drgporep::DataProof<'_>) } } }])', libcore/result.rs:945:5\r\nstack backtrace:   0: std::sys::unix::backtrace::tracing::imp::unwind_backtrace\r\n   1: std::sys_common::backtrace::print\r\n   2: std::panicking::default_hook::{{closure}}\r\n   3: std::panicking::default_hook\r\n   4: rustc::util::common::panic_hook\r\n   5: std::panicking::rust_panic_with_hook\r\n   6: std::panicking::continue_panic_fmt\r\n   7: rust_begin_unwind\r\n   8: core::panicking::panic_fmt\r\n   9: core::result::unwrap_failed\r\n  10: <rustc_mir::transform::elaborate_drops::ElaborateDrops as rustc_mir::transform::MirPass>::run_pass\r\n  11: rustc_mir::transform::optimized_mir::{{closure}}\r\n  12: rustc_mir::transform::optimized_mir\r\n  13: rustc::ty::maps::__query_compute::optimized_mir\r\n  14: rustc::ty::maps::<impl rustc::ty::maps::config::QueryConfig<'tcx> for rustc::ty::maps::queries::optimized_mir<'tcx>>::compute\r\n  15: rustc::ty::context::tls::with_context\r\n  16: rustc::dep_graph::graph::DepGraph::with_task_impl\r\n  17: rustc::ty::context::tls::with_related_context\r\n  18: rustc::ty::maps::plumbing::<impl rustc::ty::context::TyCtxt<'a, 'gcx, 'tcx>>::force_query_with_job\r\n  19: rustc::ty::maps::plumbing::<impl rustc::ty::context::TyCtxt<'a, 'gcx, 'tcx>>::get_query\r\n  20: rustc::ty::<impl rustc::ty::context::TyCtxt<'a, 'gcx, 'tcx>>::instance_mir\r\n  21: rustc_mir::monomorphize::collector::collect_items_rec\r\n  22: rustc_mir::monomorphize::collector::collect_items_rec\r\n  23: rustc_mir::monomorphize::collector::collect_items_rec\r\n  24: rustc_mir::monomorphize::collector::collect_items_rec\r\n  25: rustc_mir::monomorphize::collector::collect_items_rec\r\n  26: rustc_mir::monomorphize::collector::collect_items_rec\r\n  27: rustc_mir::monomorphize::collector::collect_items_rec\r\n  28: rustc_mir::monomorphize::collector::collect_items_rec\r\n  29: rustc_mir::monomorphize::collector::collect_items_rec\r\n  30: rustc_mir::monomorphize::collector::collect_items_rec\r\n  31: rustc_mir::monomorphize::collector::collect_items_rec\r\n  32: rustc_mir::monomorphize::collector::collect_items_rec\r\n  33: rustc_mir::monomorphize::collector::collect_items_rec\r\n  34: rustc_mir::monomorphize::collector::collect_crate_mono_items\r\n  35: rustc::util::common::time\r\n  36: rustc_codegen_llvm::base::collect_and_partition_mono_items\r\n  37: rustc::ty::maps::<impl rustc::ty::maps::config::QueryConfig<'tcx> for rustc::ty::maps::queries::collect_and_partition_mono_items<'tcx>>::compute\r\n  38: rustc::ty::context::tls::with_context\r\n  39: rustc::dep_graph::graph::DepGraph::with_task_impl\r\n  40: rustc::ty::context::tls::with_related_context\r\n  41: rustc::ty::maps::plumbing::<impl rustc::ty::context::TyCtxt<'a, 'gcx, 'tcx>>::force_query_with_job\r\n  42: rustc::ty::maps::plumbing::<impl rustc::ty::context::TyCtxt<'a, 'gcx, 'tcx>>::get_query\r\n  43: rustc_codegen_llvm::base::codegen_crate\r\n  44: <rustc_codegen_llvm::LlvmCodegenBackend as rustc_codegen_utils::codegen_backend::CodegenBackend>::codegen_crate\r\n  45: rustc::util::common::time\r\n  46: rustc_driver::driver::phase_4_codegen\r\n  47: rustc_driver::driver::compile_input::{{closure}}\r\n  48: rustc::ty::context::tls::enter_context\r\n  49: <std::thread::local::LocalKey<T>>::with\r\n  50: rustc::ty::context::TyCtxt::create_and_enter\r\n  51: rustc_driver::driver::compile_input\r\n  52: rustc_driver::run_compiler_with_pool\r\n  53: <scoped_tls::ScopedKey<T>>::set\r\n  54: <scoped_tls::ScopedKey<T>>::set\r\n  55: syntax::with_globals\r\n  56: <std::panic::AssertUnwindSafe<F> as core::ops::function::FnOnce<()>>::call_once\r\n  57: __rust_maybe_catch_panic\r\n  58: rustc_driver::run\r\n  59: rustc_driver::main\r\n  60: std::rt::lang_start::{{closure}}\r\n  61: std::panicking::try::do_call\r\n  62: __rust_maybe_catch_panic\r\n  63: std::rt::lang_start_internal\r\n  64: main\r\nquery stack during panic:\r\n#0 [optimized_mir] processing `<mod1>::<mod2>::tests::test_<name>::{{closure}}`\r\n#1 [collect_and_partition_mono_items] collect_and_partition_mono_items\r\nend of query stack\r\n\r\nerror: internal compiler error: unexpected panic\r\n\r\nnote: the compiler unexpectedly panicked. this is a bug.\r\n\r\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports\r\n\r\nnote: rustc 1.28.0-nightly (1d4dbf488 2018-06-11) running on x86_64-apple-darwin\r\n\r\nnote: compiler flags: -C debuginfo=2 -C incremental\r\n\r\nnote: some of the compiler flags provided by cargo are hidden\r\n\r\nerror: Could not compile `proofs`.\r\n\r\nTo learn more, run the command again with --verbose.\r\n```\r\n\r\nVersions:\r\n\r\n```\r\n> cargo --version --verbose\r\ncargo 1.28.0-nightly (e2348c2db 2018-06-07)\r\nrelease: 1.28.0\r\ncommit-hash: e2348c2db296ce33428933c3ab8786d5f3c54a2e\r\ncommit-date: 2018-06-07\r\n> rustc --version --verbose\r\nrustc 1.28.0-nightly (1d4dbf488 2018-06-11)\r\nbinary: rustc\r\ncommit-hash: 1d4dbf488a4364413e7b9611866b7a5c75ce566f\r\ncommit-date: 2018-06-11\r\nhost: x86_64-apple-darwin\r\nrelease: 1.28.0-nightly\r\nLLVM version: 6.0\r\n```\r\n\r\nOperating System: macOS 10.13.3 (17D102)", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/51516/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/51516/timeline", "performed_via_github_app": null, "state_reason": "completed"}