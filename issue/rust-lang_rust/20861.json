{"url": "https://api.github.com/repos/rust-lang/rust/issues/20861", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/20861/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/20861/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/20861/events", "html_url": "https://github.com/rust-lang/rust/issues/20861", "id": 53953833, "node_id": "MDU6SXNzdWU1Mzk1MzgzMw==", "number": 20861, "title": "Replace libc functions with WinAPIs on Windows", "user": {"login": "klutzy", "id": 1589355, "node_id": "MDQ6VXNlcjE1ODkzNTU=", "avatar_url": "https://avatars.githubusercontent.com/u/1589355?v=4", "gravatar_id": "", "url": "https://api.github.com/users/klutzy", "html_url": "https://github.com/klutzy", "followers_url": "https://api.github.com/users/klutzy/followers", "following_url": "https://api.github.com/users/klutzy/following{/other_user}", "gists_url": "https://api.github.com/users/klutzy/gists{/gist_id}", "starred_url": "https://api.github.com/users/klutzy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/klutzy/subscriptions", "organizations_url": "https://api.github.com/users/klutzy/orgs", "repos_url": "https://api.github.com/users/klutzy/repos", "events_url": "https://api.github.com/users/klutzy/events{/privacy}", "received_events_url": "https://api.github.com/users/klutzy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 123109, "node_id": "MDU6TGFiZWwxMjMxMDk=", "url": "https://api.github.com/repos/rust-lang/rust/labels/O-windows", "name": "O-windows", "color": "6e6ec0", "default": false, "description": "Operating system: Windows"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2015-01-10T10:28:29Z", "updated_at": "2015-08-12T17:10:17Z", "closed_at": "2015-08-12T17:10:17Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "We use libc functions on various Windows routines, but they are just convenient wrappers of WinAPI and there's usually no critical reason to use them.\n\nAlso, the wrapper has its own runtime state so it adds additional complexity, so it's better to use WinAPI than libc functions in general.\nFor example, msvcrt has libc `errno` variable, but it's not Windows' native error code value ([GetLastError()](http://msdn.microsoft.com/en-us/library/windows/desktop/ms679360%28v=vs.85%29.aspx)) therefore unrelated to `std::os::errno()`.\nAnother example is that msvcrt manages its own \"C locale\", distinct to Windows locale.\n\nHere's some libc uses (not complete):\n-   `rt/rust_builtin.c`: e.g. `gmtime`, `localtime`. (seems like they are unused now)\n-   `liballoc/heap.rs` uses `malloc`, `realloc`, `free` if jemalloc is disabled. [HeapAlloc is better?](http://msdn.microsoft.com/ko-kr/library/windows/desktop/aa366533%28v=vs.85%29.aspx)\n-   `libstd/sys/windows/`: e.g. `fs.rs` uses `open_osfhandle`.\n\nSee also [Support: Win32 Equivalents for C Run-Time Functions](http://support.microsoft.com/kb/99456/EN-US).\n", "closed_by": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/20861/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/20861/timeline", "performed_via_github_app": null, "state_reason": "completed"}