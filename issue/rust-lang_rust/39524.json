{"url": "https://api.github.com/repos/rust-lang/rust/issues/39524", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/39524/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/39524/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/39524/events", "html_url": "https://github.com/rust-lang/rust/issues/39524", "id": 205327657, "node_id": "MDU6SXNzdWUyMDUzMjc2NTc=", "number": 39524, "title": "#[must_use] does not work for nested structures", "user": {"login": "sunjay", "id": 530939, "node_id": "MDQ6VXNlcjUzMDkzOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/530939?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sunjay", "html_url": "https://github.com/sunjay", "followers_url": "https://api.github.com/users/sunjay/followers", "following_url": "https://api.github.com/users/sunjay/following{/other_user}", "gists_url": "https://api.github.com/users/sunjay/gists{/gist_id}", "starred_url": "https://api.github.com/users/sunjay/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sunjay/subscriptions", "organizations_url": "https://api.github.com/users/sunjay/orgs", "repos_url": "https://api.github.com/users/sunjay/repos", "events_url": "https://api.github.com/users/sunjay/events{/privacy}", "received_events_url": "https://api.github.com/users/sunjay/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 235137, "node_id": "MDU6TGFiZWwyMzUxMzc=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-lint", "name": "A-lint", "color": "f7e101", "default": false, "description": "Area: Lints (warnings about flaws in source code) such as unused_mut."}, {"id": 211668019, "node_id": "MDU6TGFiZWwyMTE2NjgwMTk=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-lang", "name": "T-lang", "color": "bfd4f2", "default": false, "description": "Relevant to the language team, which will review and decide on the PR/issue."}, {"id": 630652267, "node_id": "MDU6TGFiZWw2MzA2NTIyNjc=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-feature-request", "name": "C-feature-request", "color": "f5f1fd", "default": false, "description": "Category: A feature request, i.e: not implemented / a PR."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2017-02-04T06:31:07Z", "updated_at": "2019-12-17T22:27:18Z", "closed_at": "2019-10-25T09:49:00Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "When `#[must_use]` is applied to a structure that is nested, the linter no longer picks up when that value is unused.\r\n\r\nThis is related to: #26291 and #26281\r\n\r\nLooking at those issues, there seem to be a lot of cases where `#[must_use]` does not work. This is unfortunate because it is actually an incredibly useful annotation that definitely has applications past just the Result enum. \r\n\r\nAccidentally relying on it too much can have you make mistakes you otherwise would have corrected had the warning been a bit smarter. I consider this a bug because `#[must_use]` implies that you must use that value no matter what; regardless of what form it is returned in.\r\n\r\nI tried this code: (Rust Playground: https://is.gd/vCLZKq)\r\n\r\n```rust\r\n#[must_use]\r\n#[derive(Debug)]\r\nstruct MustUse;\r\n\r\nstruct Foo {\r\n    must: MustUse,\r\n}\r\n\r\nimpl Foo {\r\n    fn bar(&self) {\r\n        println!(\"{:?}\", self.must);\r\n    }\r\n}\r\n\r\nfn must() -> Foo {\r\n    Foo {must: MustUse}\r\n}\r\n\r\nfn main() {\r\n    must().bar();\r\n    must();\r\n}\r\n```\r\n\r\nI expected to see this happen: A warning about the MustUse structure not being used\r\n\r\nInstead, this happened: The code compiled and ran with no errors\r\n\r\n## Meta\r\n\r\n`rustc --version --verbose`: stable, nightly, etc.\r\n\r\nBacktrace: not applicable", "closed_by": {"login": "varkor", "id": 3943692, "node_id": "MDQ6VXNlcjM5NDM2OTI=", "avatar_url": "https://avatars.githubusercontent.com/u/3943692?v=4", "gravatar_id": "", "url": "https://api.github.com/users/varkor", "html_url": "https://github.com/varkor", "followers_url": "https://api.github.com/users/varkor/followers", "following_url": "https://api.github.com/users/varkor/following{/other_user}", "gists_url": "https://api.github.com/users/varkor/gists{/gist_id}", "starred_url": "https://api.github.com/users/varkor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/varkor/subscriptions", "organizations_url": "https://api.github.com/users/varkor/orgs", "repos_url": "https://api.github.com/users/varkor/repos", "events_url": "https://api.github.com/users/varkor/events{/privacy}", "received_events_url": "https://api.github.com/users/varkor/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/39524/reactions", "total_count": 3, "+1": 3, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/39524/timeline", "performed_via_github_app": null, "state_reason": "completed"}