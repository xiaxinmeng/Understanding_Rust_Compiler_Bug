{"url": "https://api.github.com/repos/rust-lang/rust/issues/21775", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/21775/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/21775/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/21775/events", "html_url": "https://github.com/rust-lang/rust/issues/21775", "id": 56019263, "node_id": "MDU6SXNzdWU1NjAxOTI2Mw==", "number": 21775, "title": "dead_code lint shouldn't warn about unused fields that implement Drop", "user": {"login": "simias", "id": 7925386, "node_id": "MDQ6VXNlcjc5MjUzODY=", "avatar_url": "https://avatars.githubusercontent.com/u/7925386?v=4", "gravatar_id": "", "url": "https://api.github.com/users/simias", "html_url": "https://github.com/simias", "followers_url": "https://api.github.com/users/simias/followers", "following_url": "https://api.github.com/users/simias/following{/other_user}", "gists_url": "https://api.github.com/users/simias/gists{/gist_id}", "starred_url": "https://api.github.com/users/simias/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/simias/subscriptions", "organizations_url": "https://api.github.com/users/simias/orgs", "repos_url": "https://api.github.com/users/simias/repos", "events_url": "https://api.github.com/users/simias/events{/privacy}", "received_events_url": "https://api.github.com/users/simias/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 36996, "node_id": "MDU6TGFiZWwzNjk5Ng==", "url": "https://api.github.com/repos/rust-lang/rust/labels/E-easy", "name": "E-easy", "color": "02e10c", "default": false, "description": "Call for participation: Experience needed to fix: Easy / not much (good first issue)"}, {"id": 235137, "node_id": "MDU6TGFiZWwyMzUxMzc=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-lint", "name": "A-lint", "color": "f7e101", "default": false, "description": "Area: Lints (warnings about flaws in source code) such as unused_mut."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 14, "created_at": "2015-01-30T10:49:51Z", "updated_at": "2016-02-11T20:13:01Z", "closed_at": "2016-02-11T20:13:01Z", "author_association": "NONE", "active_lock_reason": null, "body": "I have a use case similar to this:\n\n``` rust\nstruct S(u32);\n\nimpl Drop for S {\n    fn drop(&mut self) {\n        println!(\"dropping {}\", self.0);\n    }\n}\n\nstruct Container {\n    s: S,\n}\n\nimpl Container {\n    fn new() -> Container {\n        let s = S(4);\n\n        Container { s: s } \n    }\n}\n\nfn main() {\n    Container::new();\n}\n```\n\nThe struct `S` is just a thin wrapper around a foreign object, it's just used to free the object in the Drop. The `dead_code` lint says:\n\n``` rust\nwarning: struct field is never used: `s`, #[warn(dead_code)] on by default\n```\n\nIMHO that's bogus because it seems to imply that the member could be removed without changing the behaviour of the code which is clearly not the case. The whole point is that I want `s` to live as long as the `Container` object.\n\nTherefore I think the lint shouldn't trigger when a seemingly unused field implements `Drop`.\n", "closed_by": {"login": "steveklabnik", "id": 27786, "node_id": "MDQ6VXNlcjI3Nzg2", "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/steveklabnik", "html_url": "https://github.com/steveklabnik", "followers_url": "https://api.github.com/users/steveklabnik/followers", "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}", "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}", "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions", "organizations_url": "https://api.github.com/users/steveklabnik/orgs", "repos_url": "https://api.github.com/users/steveklabnik/repos", "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}", "received_events_url": "https://api.github.com/users/steveklabnik/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/21775/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/21775/timeline", "performed_via_github_app": null, "state_reason": "completed"}