{"url": "https://api.github.com/repos/rust-lang/rust/issues/18775", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/18775/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/18775/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/18775/events", "html_url": "https://github.com/rust-lang/rust/issues/18775", "id": 48170872, "node_id": "MDU6SXNzdWU0ODE3MDg3Mg==", "number": 18775, "title": "Error using quote_tokens: expected identifier, found keyword `self`", "user": {"login": "hannobraun", "id": 85732, "node_id": "MDQ6VXNlcjg1NzMy", "avatar_url": "https://avatars.githubusercontent.com/u/85732?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hannobraun", "html_url": "https://github.com/hannobraun", "followers_url": "https://api.github.com/users/hannobraun/followers", "following_url": "https://api.github.com/users/hannobraun/following{/other_user}", "gists_url": "https://api.github.com/users/hannobraun/gists{/gist_id}", "starred_url": "https://api.github.com/users/hannobraun/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hannobraun/subscriptions", "organizations_url": "https://api.github.com/users/hannobraun/orgs", "repos_url": "https://api.github.com/users/hannobraun/repos", "events_url": "https://api.github.com/users/hannobraun/events{/privacy}", "received_events_url": "https://api.github.com/users/hannobraun/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 235146, "node_id": "MDU6TGFiZWwyMzUxNDY=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-syntaxext", "name": "A-syntaxext", "color": "f7e101", "default": false, "description": "Area: Syntax extensions"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2014-11-08T16:44:05Z", "updated_at": "2015-01-07T08:27:33Z", "closed_at": "2015-01-07T08:27:33Z", "author_association": "NONE", "active_lock_reason": null, "body": "Since upgrading to the latest nightly, I'm getting a compiler error for the following piece of code:\n\n``` Rust\nlet field_set = quote_tokens!(context,\n    $var_name: self.$collection.pop(id),\n);\n```\n\nThis code is available in the Rustecs repository: https://github.com/hannobraun/rustecs/blob/cd844f90b3073626e4252ff46781bed6ab0b337e/rustecs_macros/src/generate/intermediate.rs#L73\n\nThe error:\n\n```\n/home/hanno/Projects/rustecs/rustecs_macros/src/generate/intermediate.rs:73:15: 73:19 error: expected identifier, found keyword `self`\n/home/hanno/Projects/rustecs/rustecs_macros/src/generate/intermediate.rs:73             $var_name: self.$collection.pop(id),\n                                                                                                   ^~~~\nerror: aborting due to previous error\nCould not compile `rustecs_macros`.\n```\n\nI was able to create this reduced example:\n\n``` Rust\n// lib.rs\n#![feature(quote)]\n\nfn quote() {\n    quote_tokens!(context,\n        $var_name: self\n    );\n}\n\n```\n\nWhile there are many reasons this code should not compile, it fails with the same error message. If I\n- change `self` to something else or\n- remove the `:` or\n- Remove the `$` in `$var_name`\n\nthe error goes away and the compile fails with a different error (as expected).\n\nI can reproduce the issue with the latest nightly. I'm not sure about the exact version, since `rustc --version` only produces `rustc 0.13.0-nightly`. I don't know which version broke it, but it must have been recent. The last successful Travis CI build was using `0.13.0-nightly (45cbdec41 2014-11-07 00:02:18 +0000)`. See https://travis-ci.org/hannobraun/rustecs/builds/40199720\n\nMore info about my system:\n\n```\n$ rustc --version=verbose\nrustc 0.13.0-nightly\nbinary: rustc\ncommit-hash: unknown\ncommit-date: unknown\nhost: x86_64-unknown-linux-gnu\nrelease: 0.13.0-nightly\n```\n", "closed_by": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/18775/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/18775/timeline", "performed_via_github_app": null, "state_reason": "completed"}