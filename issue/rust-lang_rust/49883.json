{"url": "https://api.github.com/repos/rust-lang/rust/issues/49883", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/49883/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/49883/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/49883/events", "html_url": "https://github.com/rust-lang/rust/issues/49883", "id": 313406530, "node_id": "MDU6SXNzdWUzMTM0MDY1MzA=", "number": 49883, "title": "`cargo doc` fails with panic in rustc.", "user": {"login": "zakarumych", "id": 4456841, "node_id": "MDQ6VXNlcjQ0NTY4NDE=", "avatar_url": "https://avatars.githubusercontent.com/u/4456841?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zakarumych", "html_url": "https://github.com/zakarumych", "followers_url": "https://api.github.com/users/zakarumych/followers", "following_url": "https://api.github.com/users/zakarumych/following{/other_user}", "gists_url": "https://api.github.com/users/zakarumych/gists{/gist_id}", "starred_url": "https://api.github.com/users/zakarumych/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zakarumych/subscriptions", "organizations_url": "https://api.github.com/users/zakarumych/orgs", "repos_url": "https://api.github.com/users/zakarumych/repos", "events_url": "https://api.github.com/users/zakarumych/events{/privacy}", "received_events_url": "https://api.github.com/users/zakarumych/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 203738, "node_id": "MDU6TGFiZWwyMDM3Mzg=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-rustdoc", "name": "T-rustdoc", "color": "bfd4f2", "default": false, "description": "Relevant to the rustdoc team, which will review and decide on the PR/issue."}, {"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}, {"id": 262252840, "node_id": "MDU6TGFiZWwyNjIyNTI4NDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/regression-from-stable-to-stable", "name": "regression-from-stable-to-stable", "color": "e4008a", "default": false, "description": "Performance or correctness regression from one stable version to another."}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2018-04-11T16:52:04Z", "updated_at": "2018-04-21T08:52:25Z", "closed_at": "2018-04-21T08:52:24Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I try to document crate (with `cargo doc`) and `rustc` panics.\r\nAlthough `cargo build` works well\r\nIt seems that those lines causing the panic:\r\n\r\nIn `lib.rs`:\r\n```\r\nextern crate gfx_mesh;\r\npub use gfx_mesh::{Mesh, MeshBuilder};\r\n```\r\n\r\nIn `Cargo.toml`:\r\n```\r\ngfx-mesh = { git = \"https://github.com/omni-viral/gfx-mesh\", rev = \"3ee315b8\" }\r\n```\r\n\r\n## Meta\r\n\r\n`rustc --version --verbose`:\r\n```\r\nrustc 1.25.0 (84203cac6 2018-03-25)\r\nbinary: rustc\r\ncommit-hash: 84203cac67e65ca8640b8392348411098c856985\r\ncommit-date: 2018-03-25\r\nhost: x86_64-apple-darwin\r\nrelease: 1.25.0\r\nLLVM version: 6.0\r\n```\r\n\r\n`RUST_BACKTRACE=full cargo doc `:\r\n```\r\n Documenting test1 v0.1.0 (file:///Users/zakarum/pet/test1)\r\nerror: internal compiler error: librustc_metadata/decoder.rs:289: Cannot decode Span without Session.\r\n\r\nthread 'rustc' panicked at 'Box<Any>', librustc_errors/lib.rs:535:9\r\nstack backtrace:\r\n   0:        0x106897c33 - std::sys::unix::backtrace::tracing::imp::unwind_backtrace::h0d82ff21dbaafa37\r\n   1:        0x10688f0a2 - std::sys_common::backtrace::_print::h8d6c54c009c3f040\r\n   2:        0x1068949ad - std::panicking::default_hook::{{closure}}::h9fa6009de31be346\r\n   3:        0x106894645 - std::panicking::default_hook::h6cdceadee11175c8\r\n   4:        0x106894e56 - std::panicking::rust_panic_with_hook::hfb431ab23831437f\r\n   5:        0x1065d8a0b - std::panicking::begin_panic::h6fc6d7cefc0d4156\r\n   6:        0x1065fb2f8 - rustc_errors::Handler::bug::hb776eb7b63578a78\r\n   7:        0x1051f5de8 - rustc::session::opt_span_bug_fmt::{{closure}}::hb4e6a7d91782852f\r\n   8:        0x1052b3310 - rustc::ty::context::tls::with_opt::{{closure}}::h67ee5dec967f3ca6\r\n   9:        0x104ed7ae8 - <std::thread::local::LocalKey<T>>::try_with::h83302cce55a9bec1\r\n  10:        0x104ed79a4 - <std::thread::local::LocalKey<T>>::with::hef48b88bcdafcec3\r\n  11:        0x1052b30d4 - rustc::ty::context::tls::with::heca45bdf3c9a1d1a\r\n  12:        0x1052b32cf - rustc::ty::context::tls::with_opt::h4cdf0ab166451878\r\n  13:        0x1051f5a74 - rustc::session::opt_span_bug_fmt::h36de7c1db41875d5\r\n  14:        0x1051f5941 - rustc::session::bug_fmt::h41decc888dfbf2e6\r\n  15:        0x10440d06c - <rustc_metadata::decoder::DecodeContext<'a, 'tcx> as serialize::serialize::SpecializedDecoder<syntax_pos::span_encoding::Span>>::specialized_decode::h4c296349ad36a672\r\n  16:        0x10438799b - <rustc::hir::Expr as serialize::serialize::Decodable>::decode::{{closure}}::hbdd7bf8c83a47d59\r\n  17:        0x104387152 - <rustc::hir::Body as serialize::serialize::Decodable>::decode::h5b6241b50756a11c\r\n  18:        0x104413268 - rustc_metadata::decoder::<impl rustc_metadata::cstore::CrateMetadata>::item_body_nested_bodies::hfbae0d4a4f24ecc8\r\n  19:        0x10443ceff - rustc_metadata::cstore_impl::provide_extern::item_body_nested_bodies::he7c82522188ca22d\r\n  20:        0x105082b6b - rustc::dep_graph::graph::DepGraph::with_task_impl::h7fe2b0833d41da61\r\n  21:        0x1053c6be5 - rustc::ty::maps::<impl rustc::ty::maps::queries::item_body_nested_bodies<'tcx>>::force::h1f37875260b763f4\r\n  22:        0x1053c791c - rustc::ty::maps::<impl rustc::ty::maps::queries::item_body_nested_bodies<'tcx>>::try_get::hd52813c28b9c0cfd\r\n  23:        0x1054940b1 - rustc::ty::maps::TyCtxtAt::item_body_nested_bodies::h7db16ad29a2b4eaa\r\n  24:        0x10548f878 - rustc::ty::maps::<impl rustc::ty::context::TyCtxt<'a, 'tcx, 'lcx>>::item_body_nested_bodies::hf3045fc98bededdb\r\n  25:        0x103602a18 - rustdoc::clean::inline::print_inlined_const::h8e412b9e23a94ec9\r\n  26:        0x10361cea8 - <rustc::ty::AssociatedItem as rustdoc::clean::Clean<rustdoc::clean::Item>>::clean::hee07e803dcc25ca1\r\n  27:        0x103601196 - rustdoc::clean::inline::build_impl::hd3f2c399005c6cea\r\n  28:        0x1036006bf - rustdoc::clean::inline::build_impls::hf99fd01c6864bd24\r\n  29:        0x1035fd34c - rustdoc::clean::inline::try_inline::h19432d1a13e069a3\r\n  30:        0x103629767 - <rustdoc::doctree::Import as rustdoc::clean::Clean<alloc::vec::Vec<rustdoc::clean::Item>>>::clean::h12f42038fa8b0afa\r\n  31:        0x103609c82 - <rustdoc::doctree::Module as rustdoc::clean::Clean<rustdoc::clean::Item>>::clean::hcd3b4c90d503d265\r\n  32:        0x1036070fd - <rustdoc::visit_ast::RustdocVisitor<'a, 'tcx, 'rcx> as rustdoc::clean::Clean<rustdoc::clean::Crate>>::clean::hfca985fa4a441e9f\r\n  33:        0x1036311b2 - rustdoc::core::run_core::{{closure}}::ha95fee8bdba89da6\r\n  34:        0x10358d803 - rustc::ty::context::TyCtxt::create_and_enter::hdb7b2dcd4696caa0\r\n  35:        0x10362fc49 - rustdoc::core::run_core::hc3958f60514f70ba\r\n  36:        0x103521bf6 - std::sys_common::backtrace::__rust_begin_short_backtrace::hf3094eb672591957\r\n  37:        0x10352592d - std::panicking::try::do_call::h524e0ae617f35cca\r\n  38:        0x1068afa4e - __rust_maybe_catch_panic\r\n  39:        0x1035764e5 - <F as alloc::boxed::FnBox<A>>::call_box::h9ea7b93789e882bb\r\n  40:        0x1068a465b - std::sys::unix::thread::Thread::new::thread_start::h2f926488e05dc513\r\n  41:     0x7fffe2c0193a - _pthread_body\r\n  42:     0x7fffe2c01886 - _pthread_start\r\n\r\nnote: the compiler unexpectedly panicked. this is a bug.\r\n\r\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports\r\n\r\nnote: rustc 1.25.0 (84203cac6 2018-03-25) running on x86_64-apple-darwin\r\n\r\nerror: Could not document `test1`.\r\n\r\nCaused by:\r\n  process didn't exit successfully: `rustdoc --crate-name test1 src/lib.rs -o /Users/zakarum/pet/test1/target/doc -L dependency=/Users/zakarum/pet/test1/target/debug/deps --extern gfx_hal=/Users/zakarum/pet/test1/target/debug/deps/libgfx_hal-a2dbed14be3e1c1d.rmeta --extern gfx_mesh=/Users/zakarum/pet/test1/target/debug/deps/libgfx_mesh-e2a3fc73bd9fdd51.rmeta` (exit code: 101)\r\n```", "closed_by": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/49883/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/49883/timeline", "performed_via_github_app": null, "state_reason": "completed"}