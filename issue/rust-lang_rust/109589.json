{"url": "https://api.github.com/repos/rust-lang/rust/issues/109589", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/109589/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/109589/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/109589/events", "html_url": "https://github.com/rust-lang/rust/issues/109589", "id": 1640479714, "node_id": "I_kwDOAAsO6M5hx7vi", "number": 109589, "title": "Suggest a code fix when an attribute macro is incorrectly used as a derive macro", "user": {"login": "LukeMathWalker", "id": 20745048, "node_id": "MDQ6VXNlcjIwNzQ1MDQ4", "avatar_url": "https://avatars.githubusercontent.com/u/20745048?v=4", "gravatar_id": "", "url": "https://api.github.com/users/LukeMathWalker", "html_url": "https://github.com/LukeMathWalker", "followers_url": "https://api.github.com/users/LukeMathWalker/followers", "following_url": "https://api.github.com/users/LukeMathWalker/following{/other_user}", "gists_url": "https://api.github.com/users/LukeMathWalker/gists{/gist_id}", "starred_url": "https://api.github.com/users/LukeMathWalker/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/LukeMathWalker/subscriptions", "organizations_url": "https://api.github.com/users/LukeMathWalker/orgs", "repos_url": "https://api.github.com/users/LukeMathWalker/repos", "events_url": "https://api.github.com/users/LukeMathWalker/events{/privacy}", "received_events_url": "https://api.github.com/users/LukeMathWalker/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 36996, "node_id": "MDU6TGFiZWwzNjk5Ng==", "url": "https://api.github.com/repos/rust-lang/rust/labels/E-easy", "name": "E-easy", "color": "02e10c", "default": false, "description": "Call for participation: Experience needed to fix: Easy / not much (good first issue)"}, {"id": 235791, "node_id": "MDU6TGFiZWwyMzU3OTE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-diagnostics", "name": "A-diagnostics", "color": "f7e101", "default": false, "description": "Area: Messages for errors, warnings, and lints"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 1183099971, "node_id": "MDU6TGFiZWwxMTgzMDk5OTcx", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-suggestion-diagnostics", "name": "A-suggestion-diagnostics", "color": "f7e101", "default": false, "description": "Area: suggestions generated by the compiler applied by cargo fix"}], "state": "closed", "locked": false, "assignee": {"login": "NotStirred", "id": 16853282, "node_id": "MDQ6VXNlcjE2ODUzMjgy", "avatar_url": "https://avatars.githubusercontent.com/u/16853282?v=4", "gravatar_id": "", "url": "https://api.github.com/users/NotStirred", "html_url": "https://github.com/NotStirred", "followers_url": "https://api.github.com/users/NotStirred/followers", "following_url": "https://api.github.com/users/NotStirred/following{/other_user}", "gists_url": "https://api.github.com/users/NotStirred/gists{/gist_id}", "starred_url": "https://api.github.com/users/NotStirred/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/NotStirred/subscriptions", "organizations_url": "https://api.github.com/users/NotStirred/orgs", "repos_url": "https://api.github.com/users/NotStirred/repos", "events_url": "https://api.github.com/users/NotStirred/events{/privacy}", "received_events_url": "https://api.github.com/users/NotStirred/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "NotStirred", "id": 16853282, "node_id": "MDQ6VXNlcjE2ODUzMjgy", "avatar_url": "https://avatars.githubusercontent.com/u/16853282?v=4", "gravatar_id": "", "url": "https://api.github.com/users/NotStirred", "html_url": "https://github.com/NotStirred", "followers_url": "https://api.github.com/users/NotStirred/followers", "following_url": "https://api.github.com/users/NotStirred/following{/other_user}", "gists_url": "https://api.github.com/users/NotStirred/gists{/gist_id}", "starred_url": "https://api.github.com/users/NotStirred/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/NotStirred/subscriptions", "organizations_url": "https://api.github.com/users/NotStirred/orgs", "repos_url": "https://api.github.com/users/NotStirred/repos", "events_url": "https://api.github.com/users/NotStirred/events{/privacy}", "received_events_url": "https://api.github.com/users/NotStirred/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2023-03-25T11:15:57Z", "updated_at": "2023-04-11T00:07:29Z", "closed_at": "2023-04-11T00:07:29Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "### Code\n\n```Rust\n#[proc_macro_attribute]\npub fn attribute_macro(_metadata: TokenStream, input: TokenStream) -> TokenStream {\n    input\n}\n```\n\n\n### Current output\n\n```Shell\nerror: expected derive macro, found attribute macro `my_macro::attribute_macro`\n  |\n1 | #[derive(my_macro::attribute_macro)]\n  |          ^^^^^^^^^^^^^^^^^^^^^^^^^ not a derive macro\n```\n\n\n### Desired output\n\n(The actual desired output should have colours and minuses on the removed derive, but to give the idea)\n\n```Shell\nerror: expected derive macro, found attribute macro `my_macro::attribute_macro`\n  |\n1 | #[derive(my_macro::attribute_macro)]\n  |          ^^^^^^^^^^^^^^^^^^^^^^^^^ not a derive macro\n  = help: remove the \"derive\":\n\n  #[my_macro::attribute_macro]\n```\n\n\n### Rationale and extra context\n\nMany users are not familiar with the terminology being used by the compiler error (i.e. the different flavours of procedural macro, derive vs attribute) and might be confused as to what they need to do in order to fix the error.\nSince the fix is straight-forward (i.e. remove the `derive`), the compiler should show a code snippet that fixes the issue.\n\n### Other cases\n\n_No response_\n\n### Anything else?\n\n_No response_\n\n<!-- TRIAGEBOT_START -->\n\n<!-- TRIAGEBOT_ASSIGN_START -->\n\n<!-- TRIAGEBOT_ASSIGN_DATA_START$${\"user\":\"NotStirred\"}$$TRIAGEBOT_ASSIGN_DATA_END -->\n\n<!-- TRIAGEBOT_ASSIGN_END -->\n<!-- TRIAGEBOT_END -->", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/109589/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/109589/timeline", "performed_via_github_app": null, "state_reason": "completed"}