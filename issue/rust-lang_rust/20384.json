{"url": "https://api.github.com/repos/rust-lang/rust/issues/20384", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/20384/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/20384/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/20384/events", "html_url": "https://github.com/rust-lang/rust/issues/20384", "id": 53211900, "node_id": "MDU6SXNzdWU1MzIxMTkwMA==", "number": 20384, "title": "Referenced variable location is not an alloca!", "user": {"login": "coder543", "id": 726063, "node_id": "MDQ6VXNlcjcyNjA2Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/726063?v=4", "gravatar_id": "", "url": "https://api.github.com/users/coder543", "html_url": "https://github.com/coder543", "followers_url": "https://api.github.com/users/coder543/followers", "following_url": "https://api.github.com/users/coder543/following{/other_user}", "gists_url": "https://api.github.com/users/coder543/gists{/gist_id}", "starred_url": "https://api.github.com/users/coder543/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/coder543/subscriptions", "organizations_url": "https://api.github.com/users/coder543/orgs", "repos_url": "https://api.github.com/users/coder543/repos", "events_url": "https://api.github.com/users/coder543/events{/privacy}", "received_events_url": "https://api.github.com/users/coder543/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 203130, "node_id": "MDU6TGFiZWwyMDMxMzA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-debuginfo", "name": "A-debuginfo", "color": "f7e101", "default": false, "description": "Area: Debugging information in compiled programs (DWARF, PDB, etc.)"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2015-01-01T03:04:38Z", "updated_at": "2015-01-01T07:44:57Z", "closed_at": "2015-01-01T07:44:57Z", "author_association": "NONE", "active_lock_reason": null, "body": "This is the first time I've actually spent much time playing around with rust, so I probably just wrote some code that was very unexpected for the compiler. Here's the backtrace:\n\n```\nsrc/eg05.rs:53:13: 53:19 error: internal compiler error: debuginfo::create_local_var_metadata() - Referenced variable location is not an alloca!\nsrc/eg05.rs:53         let s_rect = Some(surface.get_rect());\n                           ^~~~~~\nnote: the compiler unexpectedly panicked. this is a bug.\nnote: we would appreciate a bug report: http://doc.rust-lang.org/complement-bugreport.html\nnote: run with `RUST_BACKTRACE=1` for a backtrace\nthread 'rustc' panicked at 'Box<Any>', /home/rustbuild/src/rust-buildbot/slave/nightly-linux/build/src/libsyntax/diagnostic.rs:123\n\nstack backtrace:\n   1:     0x7f91ec606110 - sys::backtrace::write::h4bab949887dac0c7zat\n   2:     0x7f91ec625f10 - failure::on_fail::h441e5a1820cd6786srz\n   3:     0x7f91ec59be70 - rt::unwind::begin_unwind_inner::h486e1ba2aedf0a36w5y\n   4:     0x7f91e7698ca0 - rt::unwind::begin_unwind::h10348708083188279757\n   5:     0x7f91e7698c30 - diagnostic::SpanHandler::span_bug::h76fa8d3c461a05c4bJF\n   6:     0x7f91ea56ba00 - session::Session::span_bug::hfc0762eee9d950b53jn\n   7:     0x7f91eb49a3d0 - middle::pat_util::pat_bindings::closure.48467\n   8:     0x7f91e7661f50 - ast_util::walk_pat::hd8c3c64961fdf7a2TkC\n   9:     0x7f91eb387620 - trans::controlflow::trans_block::h12d1b1c29fe0d7cbcYd\n  10:     0x7f91eb3cc5b0 - trans::expr::trans_rvalue_stmt_unadjusted::hd28699d545991297KUi\n  11:     0x7f91eb386ec0 - trans::expr::trans_into::h3c3710e6ca2ca88dLzh\n  12:     0x7f91eb3862a0 - trans::controlflow::trans_stmt_semi::h2c62833a881b1b43jXd\n  13:     0x7f91eb387620 - trans::controlflow::trans_block::h12d1b1c29fe0d7cbcYd\n  14:     0x7f91eb4441a0 - trans::base::trans_closure::h99f933ea6f1e01c5BYt\n  15:     0x7f91eb37bd90 - trans::base::trans_fn::hf71ee8d58ecc6d28q9t\n  16:     0x7f91eb3770e0 - trans::base::trans_item::hc39398da93f34132Swu\n  17:     0x7f91eb44bf10 - trans::base::trans_crate::hbaaa84f58ddebf49vsv\n  18:     0x7f91ecb572d0 - driver::phase_4_translate_to_llvm::h491e2dead8eb9d7fcFa\n  19:     0x7f91ecb371e0 - driver::compile_input::hc83f8f50017addacvba\n  20:     0x7f91ecc7dbb0 - thunk::F.Invoke<A,$u{20}R$GT$::invoke::h10576259651718141556\n  21:     0x7f91ecc7c970 - rt::unwind::try::try_fn::h9568114966234907229\n  22:     0x7f91ec68b440 - rust_try_inner\n  23:     0x7f91ec68b430 - rust_try\n  24:     0x7f91ecc7ccc0 - thunk::F.Invoke<A,$u{20}R$GT$::invoke::h7353494892923989973\n  25:     0x7f91ec615890 - sys::thread::thread_start::hd8a164ae33ed6e55u3v\n  26:     0x7f91e6eb3fe0 - start_thread\n  27:     0x7f91ec243819 - __clone\n  28:                0x0 - <unknown>\n\nCould not compile `sdl2-examples`.\n```\n\nI was playing with [these examples](https://github.com/jdeseno/rs-sdl2-examples), specifically I was modifying example 5. Here is the (very broken, probably terrible code, sorry) diff of eg05.rs that shows the state the file was in when Rust broke.\n\n```\ndiff --git a/src/eg05.rs b/src/eg05.rs\nindex 39c26fd..88632fa 100644\n--- a/src/eg05.rs\n+++ b/src/eg05.rs\n@@ -3,6 +3,8 @@ extern crate sdl2;\n use sdl2::video::{WindowPos, Window, OPENGL};\n use sdl2::event::{Event, poll_event};\n use sdl2::surface::{Surface};\n+use sdl2::rect::Rect;\n+use std::io::timer::sleep;\n\n fn main() {\n     sdl2::init(sdl2::INIT_EVERYTHING);\n@@ -31,12 +33,14 @@ fn main() {\n     };\n\n     let _ = renderer.clear();\n-    // Display the texture.\n-    // Omitting the src & dst Rect arguments will cause our image to stretch across the entire buffer.\n-    // Try passing Some(surface.get_rect()) for src & dst instead of None & see how things change.\n-    let _ = renderer.copy(&texture, None, None);\n+    let s_rect = Some(surface.get_rect());\n+    let z_rect = Some(Rect::new(120,80,128,114));\n+    println!(\"s_rect: {}\", s_rect);\n+    let _ = renderer.copy(&texture, s_rect, z_rect);\n     let _ = renderer.present();\n\n+    let mut x = 120;\n+\n\n     // loop until we receive a QuitEvent\n     'event : loop {\n@@ -44,6 +48,14 @@ fn main() {\n             Event::Quit(_) => break 'event,\n             _            => continue\n         }\n+        sleep(std::time::duration::Duration::milliseconds(200));\n+        let _ = renderer.clear();\n+        let s_rect = Some(surface.get_rect());\n+        let z_rect = Some(Rect::new(x,80,128,114));\n+        println!(\"s_rect: {}\", s_rect);\n+        let _ = renderer.copy(&texture, s_rect, z_rect);\n+        let _ = renderer.present();\n+        x += 30;\n     }\n\n     sdl2::quit();\n```\n\nAnd here is the requested version info for rust:\n\n```\nrustc 0.13.0-nightly (fea5aa656 2014-12-30 00:42:13 +0000)\nbinary: rustc\ncommit-hash: fea5aa656ff4349f4d3e1fea1447d26986762ae1\ncommit-date: 2014-12-30 00:42:13 +0000\nhost: x86_64-unknown-linux-gnu\nrelease: 0.13.0-nightly\n```\n\nI'm using rust on a 64-bit Acer C720P Chromebook, with Ubuntu 14.10 running in a chroot.\n", "closed_by": {"login": "jdm", "id": 27658, "node_id": "MDQ6VXNlcjI3NjU4", "avatar_url": "https://avatars.githubusercontent.com/u/27658?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jdm", "html_url": "https://github.com/jdm", "followers_url": "https://api.github.com/users/jdm/followers", "following_url": "https://api.github.com/users/jdm/following{/other_user}", "gists_url": "https://api.github.com/users/jdm/gists{/gist_id}", "starred_url": "https://api.github.com/users/jdm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jdm/subscriptions", "organizations_url": "https://api.github.com/users/jdm/orgs", "repos_url": "https://api.github.com/users/jdm/repos", "events_url": "https://api.github.com/users/jdm/events{/privacy}", "received_events_url": "https://api.github.com/users/jdm/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/20384/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/20384/timeline", "performed_via_github_app": null, "state_reason": "completed"}