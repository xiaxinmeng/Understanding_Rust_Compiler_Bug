{"url": "https://api.github.com/repos/rust-lang/rust/issues/18353", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/18353/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/18353/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/18353/events", "html_url": "https://github.com/rust-lang/rust/issues/18353", "id": 46852680, "node_id": "MDU6SXNzdWU0Njg1MjY4MA==", "number": 18353, "title": "ICE in translation phase while using DST: \"Invalid operand types for ICmp instruction\"", "user": {"login": "japaric", "id": 5018213, "node_id": "MDQ6VXNlcjUwMTgyMTM=", "avatar_url": "https://avatars.githubusercontent.com/u/5018213?v=4", "gravatar_id": "", "url": "https://api.github.com/users/japaric", "html_url": "https://github.com/japaric", "followers_url": "https://api.github.com/users/japaric/followers", "following_url": "https://api.github.com/users/japaric/following{/other_user}", "gists_url": "https://api.github.com/users/japaric/gists{/gist_id}", "starred_url": "https://api.github.com/users/japaric/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/japaric/subscriptions", "organizations_url": "https://api.github.com/users/japaric/orgs", "repos_url": "https://api.github.com/users/japaric/repos", "events_url": "https://api.github.com/users/japaric/events{/privacy}", "received_events_url": "https://api.github.com/users/japaric/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 108333, "node_id": "MDU6TGFiZWwxMDgzMzM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-LLVM", "name": "A-LLVM", "color": "f7e101", "default": false, "description": "Area: Code generation parts specific to LLVM. Both correctness bugs and optimization-related issues."}, {"id": 125141240, "node_id": "MDU6TGFiZWwxMjUxNDEyNDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-dst", "name": "A-dst", "color": "f7e101", "default": false, "description": "Area: Dynamically Sized Types"}], "state": "closed", "locked": false, "assignee": {"login": "nrc", "id": 762626, "node_id": "MDQ6VXNlcjc2MjYyNg==", "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nrc", "html_url": "https://github.com/nrc", "followers_url": "https://api.github.com/users/nrc/followers", "following_url": "https://api.github.com/users/nrc/following{/other_user}", "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}", "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nrc/subscriptions", "organizations_url": "https://api.github.com/users/nrc/orgs", "repos_url": "https://api.github.com/users/nrc/repos", "events_url": "https://api.github.com/users/nrc/events{/privacy}", "received_events_url": "https://api.github.com/users/nrc/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "nrc", "id": 762626, "node_id": "MDQ6VXNlcjc2MjYyNg==", "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nrc", "html_url": "https://github.com/nrc", "followers_url": "https://api.github.com/users/nrc/followers", "following_url": "https://api.github.com/users/nrc/following{/other_user}", "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}", "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nrc/subscriptions", "organizations_url": "https://api.github.com/users/nrc/orgs", "repos_url": "https://api.github.com/users/nrc/repos", "events_url": "https://api.github.com/users/nrc/events{/privacy}", "received_events_url": "https://api.github.com/users/nrc/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2014-10-26T19:55:53Z", "updated_at": "2014-11-07T02:02:54Z", "closed_at": "2014-11-07T02:02:54Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "I was playing with DST by reimplementing the `str` primitive as a `struct Str([u8])`, but hit an ICE while testing.\n\nThe code is in this [gist](https://gist.github.com/japaric/6c5544455d3e8a44fe19)\n### Output\n\n``` rust\n$ RUST_BACKTRACE=1 rustc dstr.rs\nrustc: /var/tmp/paludis/build/dev-lang-rust-scm/work/rust-scm/src/llvm/include/llvm/IR/Instructions.h:1001: void llvm::ICmpInst::AssertOK(): Assertion `(getOperand(0)->getType()->isIntOrIntVectorTy() || getOperand(0)->getType()->isPtrOrPtrVectorTy()) && \"Invalid operand types for ICmp instruction\"' failed.\n[1]    30465 abort (core dumped)  rustc dstr.rs\n```\n### Backtrace\n\n``` rust\n#0  0x00007ffff62698a7 in raise () from /lib64/libc.so.6\n#1  0x00007ffff626ac3a in abort () from /lib64/libc.so.6\n#2  0x00007ffff62627fd in __assert_fail_base () from /lib64/libc.so.6\n#3  0x00007ffff62628b2 in __assert_fail () from /lib64/libc.so.6\n#4  0x00007ffff3918608 in ?? () from /usr/lib64/librustc_llvm-4e7c5e5c.so\n#5  0x00007ffff457b527 in LLVMBuildICmp () from /usr/lib64/librustc_llvm-4e7c5e5c.so\n#6  0x00007ffff6e54a7f in middle::trans::builder::Builder$LT$$x27a$C$$x20$x27tcx$GT$::icmp::h4aa6ae27f256fabePje () from /usr/lib64/librustc-4e7c5e5c.so\n#7  0x00007ffff6dd7830 in middle::trans::adt::trans_get_discr::ha443b7b22a4caa61VFv () from /usr/lib64/librustc-4e7c5e5c.so\n#8  0x00007ffff6e8a6f8 in ?? () from /usr/lib64/librustc-4e7c5e5c.so\n#9  0x00007ffff6e87858 in ?? () from /usr/lib64/librustc-4e7c5e5c.so\n#10 0x00007ffff6e17603 in middle::trans::_match::trans_match::he701ef37a38be851Agk () from /usr/lib64/librustc-4e7c5e5c.so\n#11 0x00007ffff6e05630 in ?? () from /usr/lib64/librustc-4e7c5e5c.so\n#12 0x00007ffff6dc85fd in middle::trans::expr::trans_into::h8ae2b7a3d17060a8CD4 () from /usr/lib64/librustc-4e7c5e5c.so\n#13 0x00007ffff6dc895f in middle::trans::controlflow::trans_block::h436e3d0d9803e356ST0 () from /usr/lib64/librustc-4e7c5e5c.so\n#14 0x00007ffff6e713f8 in middle::trans::base::trans_closure::h231ca5ccc1f2e69at0g () from /usr/lib64/librustc-4e7c5e5c.so\n#15 0x00007ffff6dbb07a in middle::trans::base::trans_fn::hadaba5b2481570fcRbh () from /usr/lib64/librustc-4e7c5e5c.so\n#16 0x00007ffff6dbd4ce in middle::trans::monomorphize::monomorphic_fn::h4563fac28419b936ik0 () from /usr/lib64/librustc-4e7c5e5c.so\n#17 0x00007ffff6df0b7c in middle::trans::callee::trans_fn_ref_with_substs::h8eabc21193fe07d6Hx3 () from /usr/lib64/librustc-4e7c5e5c.so\n#18 0x00007ffff6dedd70 in middle::trans::callee::trans_fn_ref::h8d74fc054b8b7de4xl3 () from /usr/lib64/librustc-4e7c5e5c.so\n#19 0x00007ffff6dd1ffc in middle::trans::meth::trans_method_callee::hbc28e9cef099c699gom () from /usr/lib64/librustc-4e7c5e5c.so\n#20 0x00007ffff6df6dae in ?? () from /usr/lib64/librustc-4e7c5e5c.so\n#21 0x00007ffff6dd0221 in middle::trans::callee::trans_call_inner::ha74736412897064crT3 () from /usr/lib64/librustc-4e7c5e5c.so\n#22 0x00007ffff6df6bb1 in middle::trans::callee::trans_method_call::h99ff4f13e516b804TO3 () from /usr/lib64/librustc-4e7c5e5c.so\n#23 0x00007ffff6e05136 in ?? () from /usr/lib64/librustc-4e7c5e5c.so\n#24 0x00007ffff6e03e73 in ?? () from /usr/lib64/librustc-4e7c5e5c.so\n#25 0x00007ffff6dc9a0c in middle::trans::expr::trans::h159a4d5c8110b09awH4 () from /usr/lib64/librustc-4e7c5e5c.so\n#26 0x00007ffff6e662f3 in middle::trans::_match::store_local::hd8b63d9160463155Vtk () from /usr/lib64/librustc-4e7c5e5c.so\n#27 0x00007ffff6dc7b58 in middle::trans::base::init_local::h4a9b7e04850a284b38f () from /usr/lib64/librustc-4e7c5e5c.so\n#28 0x00007ffff6dc6f90 in middle::trans::controlflow::trans_stmt::h89e8a60881dc9d7cMO0 () from /usr/lib64/librustc-4e7c5e5c.so\n#29 0x00007ffff6dc8868 in middle::trans::controlflow::trans_block::h436e3d0d9803e356ST0 () from /usr/lib64/librustc-4e7c5e5c.so\n#30 0x00007ffff6e713f8 in middle::trans::base::trans_closure::h231ca5ccc1f2e69at0g () from /usr/lib64/librustc-4e7c5e5c.so\n#31 0x00007ffff6dbb07a in middle::trans::base::trans_fn::hadaba5b2481570fcRbh () from /usr/lib64/librustc-4e7c5e5c.so\n#32 0x00007ffff6db86df in middle::trans::base::trans_item::hfe038ac56abea028avh () from /usr/lib64/librustc-4e7c5e5c.so\n#33 0x00007ffff6e7ab99 in middle::trans::base::trans_crate::h88329c3ddbae368c1si () from /usr/lib64/librustc-4e7c5e5c.so\n#34 0x00007ffff72c8d15 in driver::driver::phase_4_translate_to_llvm::h16ffd3985d271c57d5z () from /usr/lib64/librustc-4e7c5e5c.so\n#35 0x00007ffff72c147a in driver::driver::compile_input::h1a790388d99652637Bz () from /usr/lib64/librustc-4e7c5e5c.so\n#36 0x00007ffff734b7bc in ?? () from /usr/lib64/librustc-4e7c5e5c.so\n#37 0x00007ffff7349735 in ?? () from /usr/lib64/librustc-4e7c5e5c.so\n#38 0x00007ffff6a4e108 in ?? () from /usr/lib64/librustc-4e7c5e5c.so\n#39 0x00007ffff6a4e003 in ?? () from /usr/lib64/librustc-4e7c5e5c.so\n#40 0x00007ffff7bafdc2 in ?? () from /usr/lib64/libnative-4e7c5e5c.so\n#41 0x00007ffff669566c in ?? () from /usr/lib64/librustrt-4e7c5e5c.so\n#42 0x00007ffff6695656 in rust_try () from /usr/lib64/librustrt-4e7c5e5c.so\n#43 0x00007ffff6642d03 in unwind::try::h59906d5b05b381f7uFd () from /usr/lib64/librustrt-4e7c5e5c.so\n#44 0x00007ffff6642bbc in task::Task::run::h4be314de5a9e0a0fkLc () from /usr/lib64/librustrt-4e7c5e5c.so\n#45 0x00007ffff7bafb87 in ?? () from /usr/lib64/libnative-4e7c5e5c.so\n#46 0x00007ffff6644621 in ?? () from /usr/lib64/librustrt-4e7c5e5c.so\n#47 0x00007ffff597d294 in start_thread () from /lib64/libpthread.so.0\n#48 0x00007ffff631e1ed in clone () from /lib64/libc.so.6\n```\n### Version\n\n``` rust\nrustc 0.13.0-dev (80e5fe1a5 2014-10-25 09:17:05 +0000)\n```\n\ncc @bkoropoff This seems similar to #17206\ncc @nick29581\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/18353/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/18353/timeline", "performed_via_github_app": null, "state_reason": "completed"}