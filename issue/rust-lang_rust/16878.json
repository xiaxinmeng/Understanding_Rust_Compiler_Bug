{"url": "https://api.github.com/repos/rust-lang/rust/issues/16878", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/16878/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/16878/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/16878/events", "html_url": "https://github.com/rust-lang/rust/issues/16878", "id": 41562958, "node_id": "MDU6SXNzdWU0MTU2Mjk1OA==", "number": 16878, "title": "find_str returns false positives", "user": {"login": "mfronczyk", "id": 5735184, "node_id": "MDQ6VXNlcjU3MzUxODQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5735184?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mfronczyk", "html_url": "https://github.com/mfronczyk", "followers_url": "https://api.github.com/users/mfronczyk/followers", "following_url": "https://api.github.com/users/mfronczyk/following{/other_user}", "gists_url": "https://api.github.com/users/mfronczyk/gists{/gist_id}", "starred_url": "https://api.github.com/users/mfronczyk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mfronczyk/subscriptions", "organizations_url": "https://api.github.com/users/mfronczyk/orgs", "repos_url": "https://api.github.com/users/mfronczyk/repos", "events_url": "https://api.github.com/users/mfronczyk/events{/privacy}", "received_events_url": "https://api.github.com/users/mfronczyk/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 15, "created_at": "2014-08-30T13:10:11Z", "updated_at": "2014-09-17T20:06:19Z", "closed_at": "2014-09-17T20:06:19Z", "author_association": "NONE", "active_lock_reason": null, "body": "It seems that for UTF-8 strings the find_str method can return the byte index of the first matching substring, but there is no matching substring in fact. Here's the code:\n\n```\nlet m = \"\u015b\u015bd\u00f3ah\u017c\u0142jnckpyzjah\";\nlet n = \"hah\";\nprintln!(\"({})\", m.as_bytes());\nprintln!(\"({})\", n.as_bytes());\nlet pos = m.find_str(n).unwrap();\nlet substring = m.slice(pos, pos + 3).as_bytes();\nprintln!(\"{}\", substring);\n```\n\nCompiled with \"rustc parser.rs\"\n\nAnd it returns:\n\n```\n([197, 155, 197, 155, 100, 195, 179, 97, 104, 197, 188, 197, 130, 106, 110, 99, 107, 112, 121, 122, 106, 97, 104])\n([104, 97, 104])\n[106, 97, 104]\n```\n\nWhich indicates that the string \"hah\" was found at the end of the m string, but it isn't there - the end is \"jah\".\n\nRust version: rustc 0.12.0-pre-nightly (2e92c67dc 2014-08-28 23:56:20 +0000) 64bit\nOS: OS X 10.9.4\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/16878/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/16878/timeline", "performed_via_github_app": null, "state_reason": "completed"}