{"url": "https://api.github.com/repos/rust-lang/rust/issues/83169", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/83169/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/83169/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/83169/events", "html_url": "https://github.com/rust-lang/rust/issues/83169", "id": 832172718, "node_id": "MDU6SXNzdWU4MzIxNzI3MTg=", "number": 83169, "title": "`const` operands in `asm!` should use inline consts rather than const promotion", "user": {"login": "bstrie", "id": 865233, "node_id": "MDQ6VXNlcjg2NTIzMw==", "avatar_url": "https://avatars.githubusercontent.com/u/865233?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bstrie", "html_url": "https://github.com/bstrie", "followers_url": "https://api.github.com/users/bstrie/followers", "following_url": "https://api.github.com/users/bstrie/following{/other_user}", "gists_url": "https://api.github.com/users/bstrie/gists{/gist_id}", "starred_url": "https://api.github.com/users/bstrie/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bstrie/subscriptions", "organizations_url": "https://api.github.com/users/bstrie/orgs", "repos_url": "https://api.github.com/users/bstrie/repos", "events_url": "https://api.github.com/users/bstrie/events{/privacy}", "received_events_url": "https://api.github.com/users/bstrie/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 91598611, "node_id": "MDU6TGFiZWw5MTU5ODYxMQ==", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-inline-assembly", "name": "A-inline-assembly", "color": "f7e101", "default": false, "description": "Area: inline asm!(..)"}, {"id": 2046313052, "node_id": "MDU6TGFiZWwyMDQ2MzEzMDUy", "url": "https://api.github.com/repos/rust-lang/rust/labels/F-asm", "name": "F-asm", "color": "f9c0cc", "default": false, "description": "`#![feature(asm)]` (not `llvm_asm`)"}, {"id": 2306075829, "node_id": "MDU6TGFiZWwyMzA2MDc1ODI5", "url": "https://api.github.com/repos/rust-lang/rust/labels/F-inline_const", "name": "F-inline_const", "color": "f9c0cc", "default": false, "description": "Inline constants (aka: const blocks, const expressions, anonymous constants)"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2021-03-15T20:36:52Z", "updated_at": "2021-04-07T18:02:20Z", "closed_at": "2021-04-07T18:02:20Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Elevating an item from [the `asm!` progress report](https://github.com/rust-lang/rust/issues/72016#issuecomment-761616910) from a comment to an issue so that it can be tracked:\r\n\r\n---\r\n`const` operands should switch to using the new inline consts instead of explicit promotion. In theory this should have no impact on existing code, but it requires inline consts to support references to generic paramters of the surrounding function, which is not supported yet.\r\n\r\n> One aspect of asm! that I think needs further scrutiny before stabilization is const arguments, which currently are one of the few syntactic constructs that trigger promotion. Promotion is about turning a part of a function into an anonymous const (the \"promoted\") and using that instead of the ripped-out part of the function body. This has all sorts of \"interesting\" consequences (see e.g. rust-lang/rfcs#3027).\r\n> \r\n> Similar to the situation for array repeat expressions in #49147, there is an alternative: we could avoid having to deal with promotion here by requiring that the const argument be either a literal (4), a named constant (CONST), or an explicit inline const (const { arbitrary_const_expr }). If that would be acceptable to y'all, I think it would be better to only support this subset upon initial stabilization. This is forward compatible with supporting more expressions by performing promotion later. The only difference this would make is one of convenience -- one could avoid having to type const { ... }.\r\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/83169/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/83169/timeline", "performed_via_github_app": null, "state_reason": "completed"}