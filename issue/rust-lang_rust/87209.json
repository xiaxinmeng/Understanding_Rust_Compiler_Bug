{"url": "https://api.github.com/repos/rust-lang/rust/issues/87209", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/87209/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/87209/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/87209/events", "html_url": "https://github.com/rust-lang/rust/issues/87209", "id": 946709441, "node_id": "MDU6SXNzdWU5NDY3MDk0NDE=", "number": 87209, "title": "expected bits of [u32; 4], got Const", "user": {"login": "wrnrlr", "id": 24570434, "node_id": "MDQ6VXNlcjI0NTcwNDM0", "avatar_url": "https://avatars.githubusercontent.com/u/24570434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wrnrlr", "html_url": "https://github.com/wrnrlr", "followers_url": "https://api.github.com/users/wrnrlr/followers", "following_url": "https://api.github.com/users/wrnrlr/following{/other_user}", "gists_url": "https://api.github.com/users/wrnrlr/gists{/gist_id}", "starred_url": "https://api.github.com/users/wrnrlr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wrnrlr/subscriptions", "organizations_url": "https://api.github.com/users/wrnrlr/orgs", "repos_url": "https://api.github.com/users/wrnrlr/repos", "events_url": "https://api.github.com/users/wrnrlr/events{/privacy}", "received_events_url": "https://api.github.com/users/wrnrlr/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-07-17T04:31:30Z", "updated_at": "2021-07-17T18:43:43Z", "closed_at": "2021-07-17T18:43:43Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Code\r\n\r\nThere is not much info in backtrace on where the problem originates so you'll have to build my entire project.\r\n\r\nIt probably has something todo with my use of `std_simd`, I also used to use the `fn_traits` but I turned it off to rule this out.\r\n\r\nThe project is very much still a WIP, many `todo!()`, but now I am stuck with this cryptic error.\r\n\r\n```\r\ngit clone https://github.com/wrnrlr/g3\r\ncd g3\r\nrustup update -- nightly\r\nRUST_BACKTRACE=full cargo build --verbose\r\n```\r\n\r\n### Meta\r\n\r\nMy project uses the experimental crate `std_simd`\r\n\r\n`rustc --version --verbose`:\r\n```\r\nrustc 1.55.0-nightly (952fdf2a1 2021-07-05)\r\nbinary: rustc\r\ncommit-hash: 952fdf2a1119affa1b37bcacb0c49cf9f0168ac8\r\ncommit-date: 2021-07-05\r\nhost: x86_64-apple-darwin\r\nrelease: 1.55.0-nightly\r\nLLVM version: 12.0.1\r\n```\r\n\r\n### Error output\r\n\r\n<details><summary><strong>Backtrace</strong></summary>\r\n<p>\r\n\r\n```\r\ncargo build --verbose\r\n       Fresh core_simd v0.1.0 (https://github.com/rust-lang/stdsimd#715f9ac4)\r\n   Compiling g3 v0.1.0 (/Users/werner/Development/explore-rs/g3)\r\n     Running `rustc --crate-name g3 --edition=2018 src/lib.rs --error-format=json --json=diagnostic-rendered-ansi --crate-type lib --emit=dep-info,metadata,link -C embed-bitcode=no -C split-debuginfo=unpacked -C debuginfo=2 -C metadata=7c9046b49ab85c5d -C extra-filename=-7c9046b49ab85c5d --out-dir /Users/werner/Development/explore-rs/g3/target/debug/deps -C incremental=/Users/werner/Development/explore-rs/g3/target/debug/incremental -L dependency=/Users/werner/Development/explore-rs/g3/target/debug/deps --extern core_simd=/Users/werner/Development/explore-rs/g3/target/debug/deps/libcore_simd-bed9c2aba59047b0.rmeta`\r\nerror: internal compiler error: /rustc/952fdf2a1119affa1b37bcacb0c49cf9f0168ac8/compiler/rustc_middle/src/ty/consts.rs:195:32: expected bits of [u32; 4], got Const {\r\n    ty: [u32; 4],\r\n    val: Value(\r\n        ByRef {\r\n            alloc: Allocation {\r\n                bytes: [\r\n                    1,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    1,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    3,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    3,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                ],\r\n                relocations: Relocations(\r\n                    SortedMap {\r\n                        data: [],\r\n                    },\r\n                ),\r\n                init_mask: InitMask {\r\n                    blocks: [\r\n                        65535,\r\n                    ],\r\n                    len: Size {\r\n                        raw: 16,\r\n                    },\r\n                },\r\n                align: Align {\r\n                    pow2: 2,\r\n                },\r\n                mutability: Not,\r\n                extra: (),\r\n            },\r\n            offset: Size {\r\n                raw: 0,\r\n            },\r\n        },\r\n    ),\r\n}\r\n\r\nthread 'rustc' panicked at 'Box<dyn Any>', compiler/rustc_errors/src/lib.rs:1006:9\r\nstack backtrace:\r\n   0:        0x10f194ba4 - <std::sys_common::backtrace::_print::DisplayBacktrace as core::fmt::Display>::fmt::h8e4ba4b55e218172\r\n   1:        0x10f1f941c - core::fmt::write::h678ac65252cdb936\r\n   2:        0x10f18694a - std::io::Write::write_fmt::h6e4183435968e8c5\r\n   3:        0x10f19884f - std::panicking::default_hook::{{closure}}::h2d4327b072954705\r\n   4:        0x10f19834d - std::panicking::default_hook::hf452eeb666b7d536\r\n   5:        0x1078413d0 - rustc_driver::DEFAULT_HOOK::{{closure}}::{{closure}}::hb10ccdcf7a10d4d6\r\n   6:        0x10f1990a6 - std::panicking::rust_panic_with_hook::hde5e2d5c940e2374\r\n   7:        0x10ba18e51 - std::panicking::begin_panic::{{closure}}::h09fb2f46972469bd\r\n   8:        0x10ba18e29 - std::sys_common::backtrace::__rust_end_short_backtrace::hf1a0ac76cfe0227a\r\n   9:        0x10bcff681 - std::panicking::begin_panic::h6de7619ec68bd39e\r\n  10:        0x10ba46350 - std::panic::panic_any::h96f9ffd7294f421e\r\n  11:        0x10ba4c90c - rustc_errors::HandlerInner::bug::he733928a9de035b4\r\n  12:        0x10ba4a727 - rustc_errors::Handler::bug::h4784dba70a4dbab9\r\n  13:        0x10b723896 - rustc_middle::util::bug::opt_span_bug_fmt::{{closure}}::h286f16855f9248bd\r\n  14:        0x10b721af6 - rustc_middle::ty::context::tls::with_opt::{{closure}}::h6c998c2ea69cf380\r\n  15:        0x10b721abf - rustc_middle::ty::context::tls::with_opt::he8b3292aa49fb660\r\n  16:        0x10b7237db - rustc_middle::util::bug::opt_span_bug_fmt::hbb96084821d041fb\r\n  17:        0x10bceb57f - rustc_middle::util::bug::bug_fmt::h6e1f261b90636146\r\n  18:        0x10aead1fc - rustc_middle::ty::consts::Const::eval_bits::{{closure}}::h01471149f63020b7\r\n  19:        0x10aeb4c1c - rustc_codegen_ssa::debuginfo::type_names::push_generic_params_internal::h0ec75a29c264ffa5\r\n  20:        0x10aeb4d39 - rustc_codegen_ssa::debuginfo::type_names::push_generic_params::h36bc8aa103af54d4\r\n  21:        0x107ac0734 - rustc_codegen_llvm::debuginfo::<impl rustc_codegen_ssa::traits::debuginfo::DebugInfoMethods for rustc_codegen_llvm::context::CodegenCx>::dbg_scope_fn::get_template_parameters::hd6124ca140aaed20\r\n  22:        0x107aa6b69 - rustc_codegen_llvm::debuginfo::<impl rustc_codegen_ssa::traits::debuginfo::DebugInfoMethods for rustc_codegen_llvm::context::CodegenCx>::dbg_scope_fn::hcca3bb4866a09e04\r\n  23:        0x107aa6549 - rustc_codegen_llvm::debuginfo::<impl rustc_codegen_ssa::traits::debuginfo::DebugInfoMethods for rustc_codegen_llvm::context::CodegenCx>::create_function_debug_context::h4cad27e2b163d2c0\r\n  24:        0x107b17015 - rustc_codegen_ssa::mir::codegen_mir::h8802be8f360ba2ac\r\n  25:        0x107aaf9f9 - rustc_codegen_ssa::base::codegen_instance::hc08e74e094e9d1be\r\n  26:        0x107ada747 - <rustc_middle::mir::mono::MonoItem as rustc_codegen_ssa::mono_item::MonoItemExt>::define::hc24ae48e1c07492d\r\n  27:        0x107ae8207 - rustc_codegen_llvm::base::compile_codegen_unit::module_codegen::h229a27288fe6bc45\r\n  28:        0x107ab1b45 - rustc_query_system::dep_graph::graph::DepGraph<K>::with_task::hbfbc0c25c3f962f5\r\n  29:        0x107ae7aeb - rustc_codegen_llvm::base::compile_codegen_unit::hae3f7bf3b0beff3a\r\n  30:        0x107ac3e49 - <rustc_codegen_llvm::LlvmCodegenBackend as rustc_codegen_ssa::traits::backend::CodegenBackend>::codegen_crate::hf32e2045db3ef8fd\r\n  31:        0x10795f87f - rustc_interface::passes::QueryContext::enter::h11f82127e4008651\r\n  32:        0x107954b70 - rustc_interface::queries::Queries::ongoing_codegen::h29d60078ceabc575\r\n  33:        0x1078801af - rustc_interface::queries::<impl rustc_interface::interface::Compiler>::enter::h3d6cee83f8b47607\r\n  34:        0x10784fc96 - rustc_span::with_source_map::ha566d69d849bf45e\r\n  35:        0x1078814d2 - rustc_interface::interface::create_compiler_and_run::h264b0e3d32b6b828\r\n  36:        0x10785780f - scoped_tls::ScopedKey<T>::set::hb0cfa40314cdb8ba\r\n  37:        0x1078503a9 - std::sys_common::backtrace::__rust_begin_short_backtrace::h959ec48bf0ae4e08\r\n  38:        0x107844c8d - core::ops::function::FnOnce::call_once{{vtable.shim}}::h3b5b99f09ce5294a\r\n  39:        0x10f1a45bb - std::sys::unix::thread::Thread::new::thread_start::hec67ea2955c28c58\r\n  40:     0x7fff20358950 - __pthread_start\r\n\r\nnote: the compiler unexpectedly panicked. this is a bug.\r\n\r\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/issues/new?labels=C-bug%2C+I-ICE%2C+T-compiler&template=ice.md\r\n\r\nnote: rustc 1.55.0-nightly (952fdf2a1 2021-07-05) running on x86_64-apple-darwin\r\n\r\nnote: compiler flags: -C embed-bitcode=no -C split-debuginfo=unpacked -C debuginfo=2 -C incremental --crate-type lib\r\n\r\nnote: some of the compiler flags provided by cargo are hidden\r\n\r\nquery stack during panic:\r\nend of query stack\r\nerror: aborting due to previous error\r\n\r\nerror: could not compile `g3`\r\n\r\nCaused by:\r\n  process didn't exit successfully: `rustc --crate-name g3 --edition=2018 src/lib.rs --error-format=json --json=diagnostic-rendered-ansi --crate-type lib --emit=dep-info,metadata,link -C embed-bitcode=no -C split-debuginfo=unpacked -C debuginfo=2 -C metadata=7c9046b49ab85c5d -C extra-filename=-7c9046b49ab85c5d --out-dir /Users/werner/Development/explore-rs/g3/target/debug/deps -C incremental=/Users/werner/Development/explore-rs/g3/target/debug/incremental -L dependency=/Users/werner/Development/explore-rs/g3/target/debug/deps --extern core_simd=/Users/werner/Development/explore-rs/g3/target/debug/deps/libcore_simd-bed9c2aba59047b0.rmeta` (exit status: 101)\r\n```\r\n\r\n</p>\r\n</details>\r\n\r\n", "closed_by": {"login": "wrnrlr", "id": 24570434, "node_id": "MDQ6VXNlcjI0NTcwNDM0", "avatar_url": "https://avatars.githubusercontent.com/u/24570434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wrnrlr", "html_url": "https://github.com/wrnrlr", "followers_url": "https://api.github.com/users/wrnrlr/followers", "following_url": "https://api.github.com/users/wrnrlr/following{/other_user}", "gists_url": "https://api.github.com/users/wrnrlr/gists{/gist_id}", "starred_url": "https://api.github.com/users/wrnrlr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wrnrlr/subscriptions", "organizations_url": "https://api.github.com/users/wrnrlr/orgs", "repos_url": "https://api.github.com/users/wrnrlr/repos", "events_url": "https://api.github.com/users/wrnrlr/events{/privacy}", "received_events_url": "https://api.github.com/users/wrnrlr/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/87209/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/87209/timeline", "performed_via_github_app": null, "state_reason": "completed"}