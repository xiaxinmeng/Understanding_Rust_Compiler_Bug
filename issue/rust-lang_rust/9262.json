{"url": "https://api.github.com/repos/rust-lang/rust/issues/9262", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/9262/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/9262/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/9262/events", "html_url": "https://github.com/rust-lang/rust/issues/9262", "id": 19647664, "node_id": "MDU6SXNzdWUxOTY0NzY2NA==", "number": 9262, "title": "rustpkg should set the exit code properly, at least for some errors", "user": {"login": "catamorphism", "id": 427212, "node_id": "MDQ6VXNlcjQyNzIxMg==", "avatar_url": "https://avatars.githubusercontent.com/u/427212?v=4", "gravatar_id": "", "url": "https://api.github.com/users/catamorphism", "html_url": "https://github.com/catamorphism", "followers_url": "https://api.github.com/users/catamorphism/followers", "following_url": "https://api.github.com/users/catamorphism/following{/other_user}", "gists_url": "https://api.github.com/users/catamorphism/gists{/gist_id}", "starred_url": "https://api.github.com/users/catamorphism/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/catamorphism/subscriptions", "organizations_url": "https://api.github.com/users/catamorphism/orgs", "repos_url": "https://api.github.com/users/catamorphism/repos", "events_url": "https://api.github.com/users/catamorphism/events{/privacy}", "received_events_url": "https://api.github.com/users/catamorphism/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2013-09-17T21:14:37Z", "updated_at": "2014-04-04T12:06:19Z", "closed_at": "2014-04-04T12:06:19Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Unhandled conditions manifest as task failure (as discussed in #9001), and because of workcache, rustpkg does most of its work that can raise conditions in separate paths. Thus, the main function in rustpkg can't handle these conditions. However, in test cases we sometimes want to check that rustpkg failed with a certain unhandled condition. The solution I came up with is, inside rustpkg, to use task::try to wrap the main work, then check whether the result is `Err(())` and set the exit code, then exit without failing, if so. This isn't a great solution since it uses the same exit code for all possible unhandled conditions (in one of the tests, I specifically want to check that the `copy_failed` condition was raised). But, I can't do any better right now because of the return type of `task::try`.\n", "closed_by": {"login": "thestinger", "id": 1505226, "node_id": "MDQ6VXNlcjE1MDUyMjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thestinger", "html_url": "https://github.com/thestinger", "followers_url": "https://api.github.com/users/thestinger/followers", "following_url": "https://api.github.com/users/thestinger/following{/other_user}", "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}", "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions", "organizations_url": "https://api.github.com/users/thestinger/orgs", "repos_url": "https://api.github.com/users/thestinger/repos", "events_url": "https://api.github.com/users/thestinger/events{/privacy}", "received_events_url": "https://api.github.com/users/thestinger/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/9262/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/9262/timeline", "performed_via_github_app": null, "state_reason": "completed"}