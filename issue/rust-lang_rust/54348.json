{"url": "https://api.github.com/repos/rust-lang/rust/issues/54348", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/54348/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/54348/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/54348/events", "html_url": "https://github.com/rust-lang/rust/issues/54348", "id": 361649440, "node_id": "MDU6SXNzdWUzNjE2NDk0NDA=", "number": 54348, "title": "ICE when casting constant float to usize in Index position", "user": {"login": "oberien", "id": 4820508, "node_id": "MDQ6VXNlcjQ4MjA1MDg=", "avatar_url": "https://avatars.githubusercontent.com/u/4820508?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oberien", "html_url": "https://github.com/oberien", "followers_url": "https://api.github.com/users/oberien/followers", "following_url": "https://api.github.com/users/oberien/following{/other_user}", "gists_url": "https://api.github.com/users/oberien/gists{/gist_id}", "starred_url": "https://api.github.com/users/oberien/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oberien/subscriptions", "organizations_url": "https://api.github.com/users/oberien/orgs", "repos_url": "https://api.github.com/users/oberien/repos", "events_url": "https://api.github.com/users/oberien/events{/privacy}", "received_events_url": "https://api.github.com/users/oberien/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 235791, "node_id": "MDU6TGFiZWwyMzU3OTE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-diagnostics", "name": "A-diagnostics", "color": "f7e101", "default": false, "description": "Area: Messages for errors, warnings, and lints"}, {"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}, {"id": 900795185, "node_id": "MDU6TGFiZWw5MDA3OTUxODU=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-const-eval", "name": "A-const-eval", "color": "f7e101", "default": false, "description": "Area: constant evaluation (mir interpretation)"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-09-19T09:06:12Z", "updated_at": "2018-11-15T15:40:31Z", "closed_at": "2018-11-15T15:40:31Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Not that this should ever be done / occur in actual code, but here it is.\r\n\r\nCode ([playground](https://play.rust-lang.org/?gist=599db4ec05adc2bd391b66cea75b0df2&version=stable&mode=debug&edition=2015)):\r\n\r\n```rust\r\nfn main() {\r\n    [1][1.5 as usize];\r\n}\r\n```\r\n\r\nError (formatted):\r\n\r\n```rust\r\nerror: internal compiler error: librustc_mir/transform/const_prop.rs:619: const index not primitive: (\r\n  ByRef(\r\n    Ptr(\r\n      Pointer {\r\n        alloc_id: AllocId(0),\r\n        offset: Size {\r\n          raw: 0\r\n        }\r\n      }\r\n    ),\r\n    Align {\r\n      abi_pow2: 3,\r\n      pref_pow2: 3\r\n    }\r\n  ),\r\n  TyLayout {\r\n    ty: usize,\r\n    details: LayoutDetails {\r\n      variants: Single {\r\n        index: 0\r\n      },\r\n      fields: Union(0),\r\n      abi: Scalar(\r\n        Scalar {\r\n          value: Int(I64, false),\r\n          valid_range: 0..=18446744073709551615\r\n        }\r\n      ),\r\n      align: Align {\r\n        abi_pow2: 3,\r\n        pref_pow2: 3\r\n      },\r\n      size: Size {\r\n        raw: 8\r\n      }\r\n    }\r\n  }, src/main.rs:2:9: 2:12\r\n)\r\n```\r\n\r\nCompiler version: rustc 1.29.0 (aa3ca1994 2018-09-11) running on x86_64-unknown-linux-gnu\r\nCompiler flags: -C codegen-units=1 -C debuginfo=2 --crate-type bin", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/54348/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/54348/timeline", "performed_via_github_app": null, "state_reason": "completed"}