{"url": "https://api.github.com/repos/rust-lang/rust/issues/55388", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/55388/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/55388/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/55388/events", "html_url": "https://github.com/rust-lang/rust/issues/55388", "id": 374369213, "node_id": "MDU6SXNzdWUzNzQzNjkyMTM=", "number": 55388, "title": "Should there be a warning at compile time when implementing Drop trait with creation of same type inside?", "user": {"login": "tom7980", "id": 8884102, "node_id": "MDQ6VXNlcjg4ODQxMDI=", "avatar_url": "https://avatars.githubusercontent.com/u/8884102?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tom7980", "html_url": "https://github.com/tom7980", "followers_url": "https://api.github.com/users/tom7980/followers", "following_url": "https://api.github.com/users/tom7980/following{/other_user}", "gists_url": "https://api.github.com/users/tom7980/gists{/gist_id}", "starred_url": "https://api.github.com/users/tom7980/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tom7980/subscriptions", "organizations_url": "https://api.github.com/users/tom7980/orgs", "repos_url": "https://api.github.com/users/tom7980/repos", "events_url": "https://api.github.com/users/tom7980/events{/privacy}", "received_events_url": "https://api.github.com/users/tom7980/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 235137, "node_id": "MDU6TGFiZWwyMzUxMzc=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-lint", "name": "A-lint", "color": "f7e101", "default": false, "description": "Area: Lints (warnings about flaws in source code) such as unused_mut."}, {"id": 67766349, "node_id": "MDU6TGFiZWw2Nzc2NjM0OQ==", "url": "https://api.github.com/repos/rust-lang/rust/labels/E-mentor", "name": "E-mentor", "color": "02E10C", "default": false, "description": "Call for participation: This issue has a mentor. Use RustcContributor::new on Zulip for discussion."}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 12, "created_at": "2018-10-26T12:49:57Z", "updated_at": "2019-03-21T13:15:07Z", "closed_at": null, "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I'm fairly new to Rust and have been working through the reference book recently, I've just covered the Drop trait implementation and thought it would be fun to see what happens if I create a new instance of the type I just dropped inside of the function. \r\n\r\nObviously this is completely nonsensical as nobody is going to do this but as you can probably tell this caused my stack to overflow and crash the program, would an error message at compile time be appropriate for something like this? \r\n\r\nI can't see why anyone would want to initialise new variables inside of the drop trait but it's possible.\r\n\r\nExample code of my implementation:\r\n```\r\nstruct CustomSmartPointer {\r\n    data: String,\r\n}\r\n\r\nimpl CustomSmartPointer{\r\n    fn new(s: String) -> CustomSmartPointer {\r\n        CustomSmartPointer{\r\n            data: s,\r\n        }\r\n    }\r\n}\r\n\r\nimpl Drop for CustomSmartPointer {\r\n    fn drop(&mut self){\r\n        println!(\"Dropping & creating new pointer\");\r\n        let c = CustomSmartPointer::new(String::from(\"test\"));\r\n        println!(\"New pointer created in memory\");\r\n    }\r\n}\r\n\r\nfn main() {\r\n    let c = CustomSmartPointer::new(String::from(\"test\"));\r\n}\r\n```", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/55388/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/55388/timeline", "performed_via_github_app": null, "state_reason": null}