{"url": "https://api.github.com/repos/rust-lang/rust/issues/33581", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/33581/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/33581/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/33581/events", "html_url": "https://github.com/rust-lang/rust/issues/33581", "id": 154414905, "node_id": "MDU6SXNzdWUxNTQ0MTQ5MDU=", "number": 33581, "title": "Test headers should have \"only-<platform>\", like \"ignore-<platform>\"", "user": {"login": "ruscur", "id": 5637090, "node_id": "MDQ6VXNlcjU2MzcwOTA=", "avatar_url": "https://avatars.githubusercontent.com/u/5637090?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ruscur", "html_url": "https://github.com/ruscur", "followers_url": "https://api.github.com/users/ruscur/followers", "following_url": "https://api.github.com/users/ruscur/following{/other_user}", "gists_url": "https://api.github.com/users/ruscur/gists{/gist_id}", "starred_url": "https://api.github.com/users/ruscur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ruscur/subscriptions", "organizations_url": "https://api.github.com/users/ruscur/orgs", "repos_url": "https://api.github.com/users/ruscur/repos", "events_url": "https://api.github.com/users/ruscur/events{/privacy}", "received_events_url": "https://api.github.com/users/ruscur/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 120005, "node_id": "MDU6TGFiZWwxMjAwMDU=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-testsuite", "name": "A-testsuite", "color": "f7e101", "default": false, "description": "Area: The testsuite used to check the correctness of rustc"}, {"id": 234902, "node_id": "MDU6TGFiZWwyMzQ5MDI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-enhancement", "name": "C-enhancement", "color": "f5f1fd", "default": false, "description": "Category: An issue proposing an enhancement or a PR with one."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2016-05-12T07:27:14Z", "updated_at": "2018-01-17T22:20:59Z", "closed_at": "2018-01-17T22:20:59Z", "author_association": "NONE", "active_lock_reason": null, "body": "The test system as it stands is very unsuitable for multiple architectures.  For example, anything with an asm macro that is expected to error cannot be adapted to support other architectures, since you could have different asm macros for each target_arch, but the test system checks for an error in each implementation.\n\nThe only way to work around this is to make a separate test file and ignore irrelevant architectures, however if any arch-specific test would have to ignore literally everything else, which is not only ugly but also will cause failures for any new architectures in the future.\n\nThis is especially obvious in tests like compile-fail/asm-in-bad-modifier.rs, where any unsupported architecture will fail the test since it compiles successfully.\n\nI think a fundamental rework of the test directives (i.e. `//~ ERROR`) would have to be a significant undertaking, but adding a `//only-x86_64` (only probably isn't the best keyword, since you might want `//only-x86_64 //only-x86`) would make things a lot easier.  An x86-only test has \"//ignore-android\", but that will still cause failures on non-Android ARM platforms, right?  The current system is very fragile and needs some change.\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/33581/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/33581/timeline", "performed_via_github_app": null, "state_reason": "completed"}