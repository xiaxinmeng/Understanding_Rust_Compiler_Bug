{"url": "https://api.github.com/repos/rust-lang/rust/issues/38416", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/38416/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/38416/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/38416/events", "html_url": "https://github.com/rust-lang/rust/issues/38416", "id": 196174037, "node_id": "MDU6SXNzdWUxOTYxNzQwMzc=", "number": 38416, "title": "Borrow checker initiating borrow too soon", "user": {"login": "Xaeroxe", "id": 6182002, "node_id": "MDQ6VXNlcjYxODIwMDI=", "avatar_url": "https://avatars.githubusercontent.com/u/6182002?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Xaeroxe", "html_url": "https://github.com/Xaeroxe", "followers_url": "https://api.github.com/users/Xaeroxe/followers", "following_url": "https://api.github.com/users/Xaeroxe/following{/other_user}", "gists_url": "https://api.github.com/users/Xaeroxe/gists{/gist_id}", "starred_url": "https://api.github.com/users/Xaeroxe/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Xaeroxe/subscriptions", "organizations_url": "https://api.github.com/users/Xaeroxe/orgs", "repos_url": "https://api.github.com/users/Xaeroxe/repos", "events_url": "https://api.github.com/users/Xaeroxe/events{/privacy}", "received_events_url": "https://api.github.com/users/Xaeroxe/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2016-12-16T23:08:00Z", "updated_at": "2016-12-17T00:24:09Z", "closed_at": "2016-12-17T00:24:09Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Consider the following code:\r\n\r\n```rust\r\nfn main() {\r\n    let mut my_foo = Foo::new();\r\n    my_foo.set_bar(my_foo.get_bar() + 1); // Doesn't compile.\r\n\r\n    let current_bar = my_foo.get_bar(); // This compiles just fine.\r\n    my_foo.set_bar(current_bar + 1);\r\n}\r\n\r\nstruct Foo {\r\n    bar : i32\r\n}\r\n\r\nimpl Foo {\r\n    fn new() -> Foo {\r\n        Foo{bar:0}\r\n    }\r\n\r\n    fn set_bar(&mut self, value : i32) {\r\n        self.bar = value;\r\n    }\r\n\r\n    fn get_bar(&self) -> i32 {\r\n        self.bar\r\n    }\r\n}\r\n```\r\n\r\nThe first line does not compile due to error E0502 \"cannot borrow 'my_foo' as immutable because it is also borrowed as mutable\"\r\n\r\nI expected the first line to compile just fine because execution of set_bar() cannot begin until execution of get_bar() is complete.\r\n\r\nThere may be something I'm missing here and some very good reason that line has to be expanded to the second form, which does compile, but it is not immediately obvious to me why the first form --which is cleaner syntax in my opinion-- does not compile.", "closed_by": {"login": "steveklabnik", "id": 27786, "node_id": "MDQ6VXNlcjI3Nzg2", "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/steveklabnik", "html_url": "https://github.com/steveklabnik", "followers_url": "https://api.github.com/users/steveklabnik/followers", "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}", "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}", "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions", "organizations_url": "https://api.github.com/users/steveklabnik/orgs", "repos_url": "https://api.github.com/users/steveklabnik/repos", "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}", "received_events_url": "https://api.github.com/users/steveklabnik/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/38416/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/38416/timeline", "performed_via_github_app": null, "state_reason": "completed"}