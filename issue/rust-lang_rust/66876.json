{"url": "https://api.github.com/repos/rust-lang/rust/issues/66876", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/66876/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/66876/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/66876/events", "html_url": "https://github.com/rust-lang/rust/issues/66876", "id": 530478153, "node_id": "MDU6SXNzdWU1MzA0NzgxNTM=", "number": 66876, "title": "Documentation for sys::unix::fd::FileDesc::drop is confusing", "user": {"login": "atomashpolskiy", "id": 3748998, "node_id": "MDQ6VXNlcjM3NDg5OTg=", "avatar_url": "https://avatars.githubusercontent.com/u/3748998?v=4", "gravatar_id": "", "url": "https://api.github.com/users/atomashpolskiy", "html_url": "https://github.com/atomashpolskiy", "followers_url": "https://api.github.com/users/atomashpolskiy/followers", "following_url": "https://api.github.com/users/atomashpolskiy/following{/other_user}", "gists_url": "https://api.github.com/users/atomashpolskiy/gists{/gist_id}", "starred_url": "https://api.github.com/users/atomashpolskiy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/atomashpolskiy/subscriptions", "organizations_url": "https://api.github.com/users/atomashpolskiy/orgs", "repos_url": "https://api.github.com/users/atomashpolskiy/repos", "events_url": "https://api.github.com/users/atomashpolskiy/events{/privacy}", "received_events_url": "https://api.github.com/users/atomashpolskiy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 234902, "node_id": "MDU6TGFiZWwyMzQ5MDI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-enhancement", "name": "C-enhancement", "color": "f5f1fd", "default": false, "description": "Category: An issue proposing an enhancement or a PR with one."}, {"id": 211668062, "node_id": "MDU6TGFiZWwyMTE2NjgwNjI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-libs-api", "name": "T-libs-api", "color": "bfd4f2", "default": false, "description": "Relevant to the library API team, which will review and decide on the PR/issue."}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-11-29T20:14:16Z", "updated_at": "2019-11-29T20:17:41Z", "closed_at": null, "author_association": "NONE", "active_lock_reason": null, "body": "```rust\r\nimpl Drop for FileDesc {\r\n    fn drop(&mut self) {\r\n        // Note that errors are ignored when closing a file descriptor. The\r\n        // reason for this is that if an error occurs we don't actually know if\r\n        // the file descriptor was closed or not, and if we retried (for\r\n        // something like EINTR), we might close another valid file descriptor\r\n        // opened after we closed ours.\r\n        let _ = unsafe { libc::close(self.fd) };\r\n    }\r\n}\r\n```\r\n\r\nWhile being strict to the letter of [POSIX close(2)](https://pubs.opengroup.org/onlinepubs/9699919799/functions/close.html), this comment looks to me as a little too abstract and therefore unnecessarily fear-inducing. Maybe it would make sense to expand it by saying that at least some of the major Unix-like systems do make sure to always close the FD, even when `close()` is interrupted, and that this is a pretty rare situation anyway, because it may happen only if a custom signal handler is set by the process. Maybe even provide some illuminating links like [this epic discussion by POSIX workgroup](http://austingroupbugs.net/view.php?id=529). Making so might save time for people, who are not aware of the details of this issue, but nevertheless care enough about their FDs always being closed to start digging the Web for answers :) Thank you for reading.", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/66876/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/66876/timeline", "performed_via_github_app": null, "state_reason": null}