{"url": "https://api.github.com/repos/rust-lang/rust/issues/70941", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/70941/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/70941/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/70941/events", "html_url": "https://github.com/rust-lang/rust/issues/70941", "id": 596964359, "node_id": "MDU6SXNzdWU1OTY5NjQzNTk=", "number": 70941, "title": "Resolving `Ok`-wrapping for `try` blocks", "user": {"login": "joshtriplett", "id": 162737, "node_id": "MDQ6VXNlcjE2MjczNw==", "avatar_url": "https://avatars.githubusercontent.com/u/162737?v=4", "gravatar_id": "", "url": "https://api.github.com/users/joshtriplett", "html_url": "https://github.com/joshtriplett", "followers_url": "https://api.github.com/users/joshtriplett/followers", "following_url": "https://api.github.com/users/joshtriplett/following{/other_user}", "gists_url": "https://api.github.com/users/joshtriplett/gists{/gist_id}", "starred_url": "https://api.github.com/users/joshtriplett/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/joshtriplett/subscriptions", "organizations_url": "https://api.github.com/users/joshtriplett/orgs", "repos_url": "https://api.github.com/users/joshtriplett/repos", "events_url": "https://api.github.com/users/joshtriplett/events{/privacy}", "received_events_url": "https://api.github.com/users/joshtriplett/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 211668019, "node_id": "MDU6TGFiZWwyMTE2NjgwMTk=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-lang", "name": "T-lang", "color": "bfd4f2", "default": false, "description": "Relevant to the language team, which will review and decide on the PR/issue."}, {"id": 919710011, "node_id": "MDU6TGFiZWw5MTk3MTAwMTE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/disposition-merge", "name": "disposition-merge", "color": "008800", "default": false, "description": "This issue / PR is in PFCP or FCP with a disposition to merge it."}, {"id": 923282386, "node_id": "MDU6TGFiZWw5MjMyODIzODY=", "url": "https://api.github.com/repos/rust-lang/rust/labels/finished-final-comment-period", "name": "finished-final-comment-period", "color": "f9e189", "default": false, "description": "The final comment period is finished for this PR / Issue."}, {"id": 1486899747, "node_id": "MDU6TGFiZWwxNDg2ODk5NzQ3", "url": "https://api.github.com/repos/rust-lang/rust/labels/F-try_blocks", "name": "F-try_blocks", "color": "f9c0cc", "default": false, "description": "`#![feature(try_blocks)]`"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 26, "created_at": "2020-04-09T01:48:26Z", "updated_at": "2022-05-25T08:33:46Z", "closed_at": "2020-06-26T13:41:27Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Please read this issue all the way through before commenting; this issue carefully pulls out one particular bit of a previously contentious topic for evaluation in isolation.\r\n\r\nThere's been a long-standing dispute that blocks the stabilization of `try` blocks: whether `try` should wrap its final value in `Ok` or not, referred to by the shorthand of \"`Ok`-wrapping\".\r\n\r\nThere's been extensive discussion on both approaches. Within the language team, that discussion has remained unresolved for several years, and people have been somewhat hesitant to reopen that discussion. When last we left it, there were a couple of proponents of `Ok`-wrapping, several people who didn't seem to have a strong opinion one way or another, and I was the last remaining holdout arguing that `try` should not do `Ok`-wrapping.\r\n\r\nHowever, two days ago, I read [a comment](https://www.reddit.com/r/rust/comments/fw4jsx/from_failure_to_fehler/fmmtt7o/) which got me thinking about `Ok`-wrapping again; in particular, the elegant observation that it makes `try` and `?` symmetric, such that `try { x }? == x` and `try { x? } == x`. I also thought about much of the Rust code I've written recently, including its error handling. This got me to do some introspection, which led to the realization that I don't actually object to `Ok`-wrapping specifically, and in fact I think `Ok`-wrapping is the right answer.\r\n\r\nWhat I realized I actually object to is some of the proposed syntax for function-level `try`, which hides the `Result<T, E>` type behind something like `T throws E`. (I am *not* going to go into any of my objections to such syntax, as it's off-topic for this issue.) I'd so commonly seen that and `Ok`-wrapping presented together as a unit that it hadn't occurred to me to separate the two and evaluate them independently. Once I did, I realized I didn't actually have any objection to `Ok`-wrapping.\r\n\r\nAnd, as it turns out, we can separate those two, because `try` blocks don't depend on any syntax for function-level `try`. We can evaluate and stabilize `try` blocks independently, and the only disagreement about that was over `Ok`-wrapping.\r\n\r\nSo, with that in mind, I'm filing this issue to separate out and gauge language-team consensus on the specific question of `Ok`-wrapping in `try` blocks. I'd to focus *only* on that point within this issue, so that we can determine if the lang team now has a consensus on that topic with my objections now withdrawn.\r\n\r\nIn particular, this issue is *not* about function-level `try` or any syntax for it, nor about the `Try` trait and any issues that may need resolving with that trait before we can stabilize `try` blocks. Finding consensus here does not mean that `try` blocks are completely ready to ship; I'd just like to evaluate this one issue in isolation and confirm that it's no longer an issue.", "closed_by": {"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/70941/reactions", "total_count": 105, "+1": 55, "-1": 0, "laugh": 0, "hooray": 14, "confused": 0, "heart": 33, "rocket": 3, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/70941/timeline", "performed_via_github_app": null, "state_reason": "completed"}