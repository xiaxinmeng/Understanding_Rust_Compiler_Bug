{"url": "https://api.github.com/repos/rust-lang/rust/issues/96464", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/96464/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/96464/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/96464/events", "html_url": "https://github.com/rust-lang/rust/issues/96464", "id": 1216710809, "node_id": "I_kwDOAAsO6M5IhYiZ", "number": 96464, "title": "windows: x.py test failure from codegen test suite ", "user": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 108333, "node_id": "MDU6TGFiZWwxMDgzMzM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-LLVM", "name": "A-LLVM", "color": "f7e101", "default": false, "description": "Area: Code generation parts specific to LLVM. Both correctness bugs and optimization-related issues."}, {"id": 120005, "node_id": "MDU6TGFiZWwxMjAwMDU=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-testsuite", "name": "A-testsuite", "color": "f7e101", "default": false, "description": "Area: The testsuite used to check the correctness of rustc"}, {"id": 234956, "node_id": "MDU6TGFiZWwyMzQ5NTY=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-codegen", "name": "A-codegen", "color": "f7e101", "default": false, "description": "Area: Code generation"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2022-04-27T02:52:04Z", "updated_at": "2023-05-09T22:32:35Z", "closed_at": null, "author_association": "MEMBER", "active_lock_reason": null, "body": "I tried this code (on Windows, in powershell)\r\n\r\n```\r\nPS D:\\pnkfelix\\RustLang\\rust.git\\objdir> python ..\\x.py test > capture-test-failure.txt\r\n```\r\n\r\nI got this output:\r\n\r\n```\r\n[...]\r\nfailures:\r\n\r\n---- [codegen] src/test\\codegen\\vec-shrink-panik.rs stdout ----\r\n\r\nerror: verification with 'FileCheck' failed\r\nstatus: exit code: 1\r\ncommand: PATH=\";D:\\pnkfelix\\RustLang\\rust.git\\objdir\\build\\x86_64-pc-windows-msvc\\stage0-bootstrap-tools\\x86_64-pc-windows-msvc\\release\\deps;D:\\pnkfelix\\RustLang\\rust.git\\objdir\\build\\x86_64-pc-windows-msvc\\stage0\\bin;C:\\Program Files\\Microsoft Visual Studio\\2022\\Community\\Common7\\IDE\\\\Extensions\\Microsoft\\IntelliCode\\CLI;C:\\Program Files\\Microsoft Visual Studio\\2022\\Community\\VC\\Tools\\MSVC\\14.31.31103\\bin\\HostX64\\x64;C:\\Program Files\\Microsoft Visual Studio\\2022\\Community\\Common7\\IDE\\VC\\VCPackages;C:\\Program Files\\Microsoft Visual Studio\\2022\\Community\\Common7\\IDE\\CommonExtensions\\Microsoft\\TestWindow;C:\\Program Files\\Microsoft Visual Studio\\2022\\Community\\Common7\\IDE\\CommonExtensions\\Microsoft\\TeamFoundation\\Team Explorer;C:\\Program Files\\Microsoft Visual Studio\\2022\\Community\\MSBuild\\Current\\bin\\Roslyn;C:\\Program Files\\Microsoft Visual Studio\\2022\\Community\\Team Tools\\Performance Tools\\x64;C:\\Program Files\\Microsoft Visual Studio\\2022\\Community\\Team Tools\\Performance Tools;C:\\Program Files (x86)\\Microsoft SDKs\\Windows\\v10.0A\\bin\\NETFX 4.8 Tools\\x64\\;C:\\Program Files\\Microsoft Visual Studio\\2022\\Community\\Common7\\IDE\\CommonExtensions\\Microsoft\\FSharp\\Tools;C:\\Program Files (x86)\\Windows Kits\\10\\bin\\10.0.19041.0\\\\x64;C:\\Program Files (x86)\\Windows Kits\\10\\bin\\\\x64;C:\\Program Files\\Microsoft Visual Studio\\2022\\Community\\\\MSBuild\\Current\\Bin\\amd64;C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319;C:\\Program Files\\Microsoft Visual Studio\\2022\\Community\\Common7\\IDE\\;C:\\Program Files\\Microsoft Visual Studio\\2022\\Community\\Common7\\Tools\\;C:\\Program Files\\Microsoft Visual Studio\\2022\\Community\\Common7\\IDE\\\\Extensions\\Microsoft\\IntelliCode\\CLI;C:\\Program Files\\Microsoft Visual Studio\\2022\\Community\\VC\\Tools\\MSVC\\14.31.31103\\bin\\HostX86\\x86;C:\\Program Files\\Microsoft Visual Studio\\2022\\Community\\Common7\\IDE\\VC\\VCPackages;C:\\Program Files\\Microsoft Visual Studio\\2022\\Community\\Common7\\IDE\\CommonExtensions\\Microsoft\\TestWindow;C:\\Program Files\\Microsoft Visual Studio\\2022\\Community\\Common7\\IDE\\CommonExtensions\\Microsoft\\TeamFoundation\\Team Explorer;C:\\Program Files\\Microsoft Visual Studio\\2022\\Community\\MSBuild\\Current\\bin\\Roslyn;C:\\Program Files\\Microsoft Visual Studio\\2022\\Community\\Team Tools\\Performance Tools;C:\\Program Files (x86)\\Microsoft SDKs\\Windows\\v10.0A\\bin\\NETFX 4.8 Tools\\;C:\\Program Files\\Microsoft Visual Studio\\2022\\Community\\Common7\\IDE\\CommonExtensions\\Microsoft\\FSharp\\Tools;C:\\Program Files (x86)\\Windows Kits\\10\\bin\\10.0.19041.0\\\\x86;C:\\Program Files (x86)\\Windows Kits\\10\\bin\\\\x86;C:\\Program Files\\Microsoft Visual Studio\\2022\\Community\\\\MSBuild\\Current\\Bin\\amd64;C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319;C:\\Program Files\\Microsoft Visual Studio\\2022\\Community\\Common7\\IDE\\;C:\\Program Files\\Microsoft Visual Studio\\2022\\Community\\Common7\\Tools\\;C:\\Program Files\\Python310\\Scripts\\;C:\\Program Files\\Python310\\;C:\\Windows\\system32;C:\\Windows;C:\\Windows\\System32\\Wbem;C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\;C:\\Windows\\System32\\OpenSSH\\;C:\\Program Files\\Amazon\\cfn-bootstrap\\;C:\\Program Files\\Microsoft SQL Server\\150\\Tools\\Binn\\;C:\\Program Files\\Microsoft SQL Server\\Client SDK\\ODBC\\170\\Tools\\Binn\\;C:\\Program Files\\dotnet\\;C:\\Program Files\\Git\\cmd;C:\\Users\\pnkfelix\\AppData\\Local\\Microsoft\\WindowsApps;;C:\\Program Files\\Microsoft Visual Studio\\2022\\Community\\Common7\\IDE\\CommonExtensions\\Microsoft\\CMake\\CMake\\bin;C:\\Program Files\\Microsoft Visual Studio\\2022\\Community\\Common7\\IDE\\CommonExtensions\\Microsoft\\CMake\\Ninja;C:\\Program Files\\Microsoft Visual Studio\\2022\\Community\\Common7\\IDE\\VC\\Linux\\bin\\ConnectionManagerExe;C:\\Program Files\\Microsoft Visual Studio\\2022\\Community\\Common7\\IDE\\CommonExtensions\\Microsoft\\CMake\\CMake\\bin;C:\\Program Files\\Microsoft Visual Studio\\2022\\Community\\Common7\\IDE\\CommonExtensions\\Microsoft\\CMake\\Ninja;C:\\Program Files\\Microsoft Visual Studio\\2022\\Community\\Common7\\IDE\\VC\\Linux\\bin\\ConnectionManagerExe\" \"D:\\\\pnkfelix\\\\RustLang\\\\rust.git\\\\objdir\\\\build\\\\x86_64-pc-windows-msvc\\\\llvm\\\\build\\\\bin\\\\FileCheck.exe\" \"--input-file\" \"D:\\\\pnkfelix\\\\RustLang\\\\rust.git\\\\objdir\\\\build\\\\x86_64-pc-windows-msvc\\\\test\\\\codegen\\\\vec-shrink-panik\\\\vec-shrink-panik.ll\" \"D:\\\\pnkfelix\\\\RustLang\\\\rust.git\\\\src/test\\\\codegen\\\\vec-shrink-panik.rs\" \"--allow-unused-prefixes\" \"--check-prefixes\" \"CHECK,MSVC\"\r\nstdout: none\r\n--- stderr -------------------------------\r\nD:\\pnkfelix\\RustLang\\rust.git\\src/test\\codegen\\vec-shrink-panik.rs:24:17: error: CHECK-NEXT: expected string not found in input\r\n // CHECK-NEXT: ; call core::panicking::panic_no_unwind\r\n                ^\r\nD:\\pnkfelix\\RustLang\\rust.git\\objdir\\build\\x86_64-pc-windows-msvc\\test\\codegen\\vec-shrink-panik\\vec-shrink-panik.ll:195:10: note: scanning from here\r\n %cleanuppad.i = cleanuppad within none []\r\n         ^\r\nD:\\pnkfelix\\RustLang\\rust.git\\objdir\\build\\x86_64-pc-windows-msvc\\test\\codegen\\vec-shrink-panik\\vec-shrink-panik.ll:196:1: note: possible intended match here\r\n; call core::ptr::drop_in_place<alloc::vec::Vec<u32>>\r\n^\r\nD:\\pnkfelix\\RustLang\\rust.git\\src/test\\codegen\\vec-shrink-panik.rs:39:17: error: CHECK-NEXT: expected string not found in input\r\n // CHECK-NEXT: ; call core::panicking::panic_no_unwind\r\n                ^\r\nD:\\pnkfelix\\RustLang\\rust.git\\objdir\\build\\x86_64-pc-windows-msvc\\test\\codegen\\vec-shrink-panik\\vec-shrink-panik.ll:318:10: note: scanning from here\r\n %cleanuppad.i.i.i = cleanuppad within none []\r\n         ^\r\nD:\\pnkfelix\\RustLang\\rust.git\\objdir\\build\\x86_64-pc-windows-msvc\\test\\codegen\\vec-shrink-panik\\vec-shrink-panik.ll:319:1: note: possible intended match here\r\n; call core::ptr::drop_in_place<alloc::vec::Vec<&str>>\r\n^\r\n\r\nInput file: D:\\pnkfelix\\RustLang\\rust.git\\objdir\\build\\x86_64-pc-windows-msvc\\test\\codegen\\vec-shrink-panik\\vec-shrink-panik.ll\r\nCheck file: D:\\pnkfelix\\RustLang\\rust.git\\src/test\\codegen\\vec-shrink-panik.rs\r\n\r\n-dump-input=help explains the following input dump.\r\n\r\nInput was:\r\n<<<<<<\r\n           .\r\n           .\r\n           .\r\n         190:  \r\n         191: .noexc.i: ; preds = %bb6.i2.i.i.i \r\n         192:  unreachable \r\n         193:  \r\n         194: funclet_bb13.i: ; preds = %bb6.i2.i.i.i \r\n         195:  %cleanuppad.i = cleanuppad within none [] \r\nnext:24'0              X~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ error: no match found\r\n         196: ; call core::ptr::drop_in_place<alloc::vec::Vec<u32>> \r\nnext:24'0     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\nnext:24'1     ?                                                      possible intended match\r\n         197:  call fastcc void @\"_ZN4core3ptr47drop_in_place$LT$alloc..vec..Vec$LT$u32$GT$$GT$17h185632e1510f6779E\"(%\"alloc::vec::Vec<u32>\"* nonnull %_2) #12 [ \"funclet\"(token %cleanuppad.i) ] \r\nnext:24'0     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n         198:  cleanupret from %cleanuppad.i unwind to caller \r\nnext:24'0     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n         199:  \r\nnext:24'0     ~\r\n         200: \"_ZN5alloc3vec16Vec$LT$T$C$A$GT$16into_boxed_slice17h006bd4b550d6b630E.exit\": ; preds = %start.bb8_crit_edge.i, %bb13.i.i.i.i \r\nnext:24'0     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n         201:  %_5.sroa.0.0.copyload12.i = phi [0 x i32]* [ %_5.sroa.0.0.copyload12.pre.i, %start.bb8_crit_edge.i ], [ %16, %bb13.i.i.i.i ] \r\nnext:24'0     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n           .\r\n           .\r\n           .\r\n         313:  \r\n         314: .noexc.i.i.i: ; preds = %bb6.i2.i.i.i.i.i \r\n         315:  unreachable \r\n         316:  \r\n         317: funclet_bb13.i.i.i: ; preds = %bb6.i2.i.i.i.i.i \r\n         318:  %cleanuppad.i.i.i = cleanuppad within none [] \r\nnext:39'0              X~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ error: no match found\r\n         319: ; call core::ptr::drop_in_place<alloc::vec::Vec<&str>> \r\nnext:39'0     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\nnext:39'1     ?                                                       possible intended match\r\n         320:  call fastcc void @\"_ZN4core3ptr51drop_in_place$LT$alloc..vec..Vec$LT$$RF$str$GT$$GT$17h112bc9fce5ca56c3E\"(%\"alloc::vec::Vec<&str>\"* nonnull %_2.i.i) #12 [ \"funclet\"(token %cleanuppad.i.i.i) ] \r\nnext:39'0     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n         321:  cleanupret from %cleanuppad.i.i.i unwind to caller \r\nnext:39'0     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n         322:  \r\nnext:39'0     ~\r\n         323: _ZN4core4iter6traits8iterator8Iterator7collect17h7546795dad841ea0E.exit: ; preds = %_ZN4core4iter6traits8iterator8Iterator7collect17h38b30846c8fa863fE.exit.i.i, %bb13.i.i.i.i.i.i \r\nnext:39'0     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n         324:  %_5.sroa.0.0.copyload1213.i.i.i = phi [0 x { [0 x i8]*, i64 }]* [ %27, %bb13.i.i.i.i.i.i ], [ %10, %_ZN4core4iter6traits8iterator8Iterator7collect17h38b30846c8fa863fE.exit.i.i ] \r\nnext:39'0     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n           .\r\n           .\r\n           .\r\n>>>>>>\r\n------------------------------------------\r\n\r\n\r\n\r\nfailures:\r\n    [codegen] src/test\\codegen\\vec-shrink-panik.rs\r\n```\r\n\r\nHere's a gist with more complete output: https://gist.github.com/pnkfelix/343528a3da2000880b370a22b6010b99\r\n\r\nThis all might be an artifact of weirdnesses in how I work, like putting the build products into their own subdirectory, `objdir`, of the rust.git source repo. Not sure yet.", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/96464/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/96464/timeline", "performed_via_github_app": null, "state_reason": null}