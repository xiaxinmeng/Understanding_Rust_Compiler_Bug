{"url": "https://api.github.com/repos/rust-lang/rust/issues/107974", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/107974/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/107974/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/107974/events", "html_url": "https://github.com/rust-lang/rust/issues/107974", "id": 1581473235, "node_id": "I_kwDOAAsO6M5eQ13T", "number": 107974, "title": "Run Miri on tests (ui? stdlib? vote now on your phones)", "user": {"login": "saethlin", "id": 12105168, "node_id": "MDQ6VXNlcjEyMTA1MTY4", "avatar_url": "https://avatars.githubusercontent.com/u/12105168?v=4", "gravatar_id": "", "url": "https://api.github.com/users/saethlin", "html_url": "https://github.com/saethlin", "followers_url": "https://api.github.com/users/saethlin/followers", "following_url": "https://api.github.com/users/saethlin/following{/other_user}", "gists_url": "https://api.github.com/users/saethlin/gists{/gist_id}", "starred_url": "https://api.github.com/users/saethlin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/saethlin/subscriptions", "organizations_url": "https://api.github.com/users/saethlin/orgs", "repos_url": "https://api.github.com/users/saethlin/repos", "events_url": "https://api.github.com/users/saethlin/events{/privacy}", "received_events_url": "https://api.github.com/users/saethlin/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 120005, "node_id": "MDU6TGFiZWwxMjAwMDU=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-testsuite", "name": "A-testsuite", "color": "f7e101", "default": false, "description": "Area: The testsuite used to check the correctness of rustc"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 325438536, "node_id": "MDU6TGFiZWwzMjU0Mzg1MzY=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-bootstrap", "name": "T-bootstrap", "color": "bfd4f2", "default": false, "description": "Relevant to the bootstrap subteam: Rust's build system (x.py and src/bootstrap)"}, {"id": 1244499056, "node_id": "MDU6TGFiZWwxMjQ0NDk5MDU2", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-miri", "name": "A-miri", "color": "f7e101", "default": false, "description": "Area: The miri tool"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2023-02-13T00:41:33Z", "updated_at": "2023-03-10T03:12:18Z", "closed_at": null, "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Thanks to the work of @matthiaskrgr we recently found UB in a handful of ui tests. That's... pretty bad. This was found by running Miri on the tests, so we should probably do that in CI.\r\n\r\nSome of the tests are supposed to contain UB, such as tests which are checking that our ASan support works or tests that verify that our MIR opts do not exploit things that Miri says are UB. These tests should have an annotation that verifies that Miri emits `error: Undefined Behavior` when run on them.\r\n\r\nAnd some of our tests do not run under Miri, for various reasons. Some of them ICE due to features which are not completely supported yet in Miri, and if we don't already, we should expect that we have tests which use things that Miri does not support at all like FFI. So we should have another annotation that checks that Miri produces a non-UB kind of error.\r\n\r\nI suspect the vast majority of tests will be good as-is, and defaulting to running Miri will reduce the amount of manual work required to start doing this.", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/107974/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/107974/timeline", "performed_via_github_app": null, "state_reason": null}