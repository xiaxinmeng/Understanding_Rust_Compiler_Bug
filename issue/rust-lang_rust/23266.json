{"url": "https://api.github.com/repos/rust-lang/rust/issues/23266", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/23266/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/23266/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/23266/events", "html_url": "https://github.com/rust-lang/rust/issues/23266", "id": 60586635, "node_id": "MDU6SXNzdWU2MDU4NjYzNQ==", "number": 23266, "title": "pub use can reference private items in a an enclosing module", "user": {"login": "nrc", "id": 762626, "node_id": "MDQ6VXNlcjc2MjYyNg==", "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nrc", "html_url": "https://github.com/nrc", "followers_url": "https://api.github.com/users/nrc/followers", "following_url": "https://api.github.com/users/nrc/following{/other_user}", "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}", "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nrc/subscriptions", "organizations_url": "https://api.github.com/users/nrc/orgs", "repos_url": "https://api.github.com/users/nrc/repos", "events_url": "https://api.github.com/users/nrc/events{/privacy}", "received_events_url": "https://api.github.com/users/nrc/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 66893153, "node_id": "MDU6TGFiZWw2Njg5MzE1Mw==", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-visibility", "name": "A-visibility", "color": "f7e101", "default": false, "description": "Area: visibility/privacy modifiers such as `pub`"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 14, "created_at": "2015-03-10T23:27:29Z", "updated_at": "2015-03-17T13:29:53Z", "closed_at": "2015-03-17T13:29:53Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "pub use should not be able to make a private item public, e.g., this is illegal:\n\n```\nmod a {\n    pub use self::b::Bar;  // error: type `Bar` is private\n\n    mod b {\n        struct Bar;\n    }\n}\n```\n\nHowever, if the private item is in an enclosing module then this is allowed. That is wrong (I think). However, it gets more complicated depending on if the enclosing module is itself public, because there is a useful pattern where the submodule `pub use`s an item in the enclosing module and that does not increase its visibility. Here are the possibilities:\n\n```\nmod a {\n    struct Foo;\n\n    mod b {\n        pub use super::Foo; // ok - only already visible in a and sub-mods\n    }\n}\n\nmod c {\n    struct Foo;\n\n    pub mod d {\n        pub use super::Foo; // not ok - increases visibility to a sibling of c\n    }\n}\n\npub mod e {\n    struct Foo;\n\n    mod f {\n        pub use super::Foo; // ok, but only if e does not pub use f\n    }\n}\n\npub mod g {\n    struct Foo;\n\n    pub mod h {\n        pub use super::Foo;  // not ok, increases visibility to the whole world\n    }\n}\n```\n\nI'm not sure if we can check the third case easily (or at all). It might only be worth allowing the first case (this would break some code in the Rust repo and probably others though).\n\nNote also that this interacts with the ban on private types in public items - this hole in visibility makes that work some times (I need to think more about that though)\n", "closed_by": {"login": "nrc", "id": 762626, "node_id": "MDQ6VXNlcjc2MjYyNg==", "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nrc", "html_url": "https://github.com/nrc", "followers_url": "https://api.github.com/users/nrc/followers", "following_url": "https://api.github.com/users/nrc/following{/other_user}", "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}", "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nrc/subscriptions", "organizations_url": "https://api.github.com/users/nrc/orgs", "repos_url": "https://api.github.com/users/nrc/repos", "events_url": "https://api.github.com/users/nrc/events{/privacy}", "received_events_url": "https://api.github.com/users/nrc/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/23266/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/23266/timeline", "performed_via_github_app": null, "state_reason": "completed"}