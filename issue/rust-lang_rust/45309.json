{"url": "https://api.github.com/repos/rust-lang/rust/issues/45309", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/45309/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/45309/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/45309/events", "html_url": "https://github.com/rust-lang/rust/issues/45309", "id": 265579353, "node_id": "MDU6SXNzdWUyNjU1NzkzNTM=", "number": 45309, "title": "Can't build with LLVM-5.0.0", "user": {"login": "tpgxyz", "id": 13415195, "node_id": "MDQ6VXNlcjEzNDE1MTk1", "avatar_url": "https://avatars.githubusercontent.com/u/13415195?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tpgxyz", "html_url": "https://github.com/tpgxyz", "followers_url": "https://api.github.com/users/tpgxyz/followers", "following_url": "https://api.github.com/users/tpgxyz/following{/other_user}", "gists_url": "https://api.github.com/users/tpgxyz/gists{/gist_id}", "starred_url": "https://api.github.com/users/tpgxyz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tpgxyz/subscriptions", "organizations_url": "https://api.github.com/users/tpgxyz/orgs", "repos_url": "https://api.github.com/users/tpgxyz/repos", "events_url": "https://api.github.com/users/tpgxyz/events{/privacy}", "received_events_url": "https://api.github.com/users/tpgxyz/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-10-15T15:14:55Z", "updated_at": "2017-10-16T01:39:25Z", "closed_at": "2017-10-16T01:39:25Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\n\r\ni cant build rust-1.21.0 with system-wide LLVM/clang-5.0.0\r\n\r\nFull logs can be found here http://file-store.openmandriva.org/api/v1/file_stores/c2556f0322987eef8b2b894e1180aceff35a2222.log?show=true\r\n\r\n```\r\n     Running `/builddir/build/BUILD/rustc-1.21.0-src/build/x86_64-unknown-linux-gnu/stage0-std/release/build/rustc_tsan-3ca86eb7b613857d/build-script-build`\r\n     Running `/builddir/build/BUILD/rustc-1.21.0-src/build/x86_64-unknown-linux-gnu/stage0-std/release/build/rustc_lsan-c674ac66d4c31444/build-script-build`\r\nerror: failed to run custom build command for `compiler_builtins v0.0.0 (file:///builddir/build/BUILD/rustc-1.21.0-src/src/rustc/compiler_builtins_shim)`\r\nprocess didn't exit successfully: `/builddir/build/BUILD/rustc-1.21.0-src/build/x86_64-unknown-linux-gnu/stage0-std/release/build/compiler_builtins-44447bd60866f757/build-script-build` (exit code: 101)\r\n\r\n\r\nARGET = Some(\"x86_64-unknown-linux-gnu\")\r\nOPT_LEVEL = Some(\"2\")\r\nTARGET = Some(\"x86_64-unknown-linux-gnu\")\r\nHOST = Some(\"x86_64-unknown-linux-gnu\")\r\nTARGET = Some(\"x86_64-unknown-linux-gnu\")\r\nTARGET = Some(\"x86_64-unknown-linux-gnu\")\r\nHOST = Some(\"x86_64-unknown-linux-gnu\")\r\nCC_x86_64-unknown-linux-gnu = Some(\"/usr/bin/clang\")\r\nTARGET = Some(\"x86_64-unknown-linux-gnu\")\r\nHOST = Some(\"x86_64-unknown-linux-gnu\")\r\nCFLAGS_x86_64-unknown-linux-gnu = Some(\"-ffunction-sections -fdata-sections -fPIC -gdwarf-4 -Wstrict-aliasing=2 -pipe -Wformat -Werror=format-security -D_FORTIFY_SOURCE=2 -fstack-protector --param=ssp-buffer-size=4 -fPIC --target=x86_64-unknown-linux-gnu\")\r\nPROFILE = Some(\"release\")\r\nrunning: \"/usr/bin/clang\" \"-O2\" \"-ffunction-sections\" \"-fdata-sections\" \"-fPIC\" \"-ffunction-sections\" \"-fdata-sections\" \"-fPIC\" \"-gdwarf-4\" \"-Wstrict-aliasing=2\" \"-pipe\" \"-Wformat\" \"-Werror=format-security\" \"-D_FORTIFY_SOURCE=2\" \"-fstack-protector\" \"--param=ssp-buffer-size=4\" \"-fPIC\" \"--target=x86_64-unknown-linux-gnu\" \"--target=x86_64-unknown-linux-gnu\" \"-fno-builtin\" \"-fvisibility=hidden\" \"-fomit-frame-pointer\" \"-ffreestanding\" \"-DVISIBILITY_HIDDEN\" \"-o\" \"/builddir/build/BUILD/rustc-1.21.0-src/build/x86_64-unknown-linux-gnu/stage0-std/x86_64-unknown-linux-gnu/release/build/compiler_builtins-3726c83d777fb924/out/../../libcompiler_builtins/compiler-rt/lib/builtins/int_util.o\" \"-c\" \"../../libcompiler_builtins/compiler-rt/lib/builtins/int_util.c\"\r\ncargo:warning=In file included from ../../libcompiler_builtins/compiler-rt/lib/builtins/int_util.c:51:\r\ncargo:warning=In file included from /usr/include/stdlib.h:905:\r\ncargo:warning=/usr/include/bits/stdlib.h:90:3: error: \"Assumed value of MB_LEN_MAX wrong\"\r\ncargo:warning=# error \"Assumed value of MB_LEN_MAX wrong\"\r\ncargo:warning=  ^\r\ncargo:warning=1 error generated.\r\nexit code: 1\r\ncommand did not execute successfully, got: exit code: 1\r\n--- stderr\r\nthread 'main' panicked at 'explicit panic', src/vendor/gcc/src/lib.rs:1239:4\r\nstack backtrace:\r\n   0: std::sys::imp::backtrace::tracing::imp::unwind_backtrace\r\n             at /checkout/src/libstd/sys/unix/backtrace/tracing/gcc_s.rs:49\r\n   1: std::sys_common::backtrace::_print\r\n             at /checkout/src/libstd/sys_common/backtrace.rs:71\r\n   2: std::panicking::default_hook::{{closure}}\r\n             at /checkout/src/libstd/sys_common/backtrace.rs:60\r\n             at /checkout/src/libstd/panicking.rs:380\r\n   3: std::panicking::default_hook\r\n             at /checkout/src/libstd/panicking.rs:396\r\n   4: std::panicking::rust_panic_with_hook\r\n             at /checkout/src/libstd/panicking.rs:611\r\n   5: std::panicking::begin_panic_new\r\n   6: gcc::fail\r\n   7: gcc::run\r\n   8: gcc::Config::compile\r\n   9: build_script_build::main\r\n  10: __rust_maybe_catch_panic\r\n             at /checkout/src/libpanic_unwind/lib.rs:98\r\n  11: std::rt::lang_start\r\n             at /checkout/src/libstd/panicking.rs:458\r\n             at /checkout/src/libstd/panic.rs:361\r\n             at /checkout/src/libstd/rt.rs:59\r\n  12: __libc_start_main\r\n  13: _start\r\n             at ../sysdeps/x86_64/start.S:120\r\nwarning: build failed, waiting for other jobs to finish...\r\nerror: build failed\r\nthread 'main' panicked at 'command did not execute successfully: \"/builddir/build/BUILD/rustc-1.21.0-src/build/x86_64-unknown-linux-gnu/stage0/bin/cargo\" \"build\" \"-j\" \"12\" \"--target\" \"x86_64-unknown-linux-gnu\" \"-v\" \"--release\" \"--frozen\" \"--features\" \"panic-unwind backtrace\" \"--manifest-path\" \"/builddir/build/BUILD/rustc-1.21.0-src/src/libstd/Cargo.toml\" \"--message-format\" \"json\"\r\nexpected success, got: exit code: 101', src/bootstrap/compile.rs:883:8\r\nstack backtrace:\r\n   0: std::sys::imp::backtrace::tracing::imp::unwind_backtrace\r\n             at /checkout/src/libstd/sys/unix/backtrace/tracing/gcc_s.rs:49\r\n   1: std::sys_common::backtrace::_print\r\n             at /checkout/src/libstd/sys_common/backtrace.rs:71\r\n   2: std::panicking::default_hook::{{closure}}\r\n             at /checkout/src/libstd/sys_common/backtrace.rs:60\r\n             at /checkout/src/libstd/panicking.rs:380\r\n   3: std::panicking::default_hook\r\n             at /checkout/src/libstd/panicking.rs:396\r\n   4: std::panicking::rust_panic_with_hook\r\n             at /checkout/src/libstd/panicking.rs:611\r\n   5: std::panicking::begin_panic_new\r\n             at /checkout/src/libstd/panicking.rs:553\r\n   6: std::panicking::begin_panic_fmt\r\n             at /checkout/src/libstd/panicking.rs:521\r\n   7: bootstrap::compile::run_cargo\r\n   8: <bootstrap::compile::Std as bootstrap::builder::Step>::run\r\n   9: bootstrap::builder::Builder::ensure\r\n  10: <bootstrap::compile::Test as bootstrap::builder::Step>::run\r\n  11: bootstrap::builder::Builder::ensure\r\n  12: <bootstrap::compile::Rustc as bootstrap::builder::Step>::run\r\n  13: bootstrap::builder::Builder::ensure\r\n  14: <bootstrap::compile::Assemble as bootstrap::builder::Step>::run\r\n  15: bootstrap::builder::Builder::ensure\r\n  16: bootstrap::builder::Builder::compiler\r\n  17: <bootstrap::compile::Assemble as bootstrap::builder::Step>::run\r\n  18: bootstrap::builder::Builder::ensure\r\n  19: bootstrap::builder::Builder::compiler\r\n  20: <bootstrap::compile::Std as bootstrap::builder::Step>::make_run\r\n  21: bootstrap::builder::StepDescription::maybe_run\r\n  22: bootstrap::builder::StepDescription::run\r\n  23: bootstrap::builder::Builder::run\r\n  24: bootstrap::Build::build\r\n  25: bootstrap::main\r\n  26: __rust_maybe_catch_panic\r\n             at /checkout/src/libpanic_unwind/lib.rs:98\r\n  27: std::rt::lang_start\r\n             at /checkout/src/libstd/panicking.rs:458\r\n             at /checkout/src/libstd/panic.rs:361\r\n             at /checkout/src/libstd/rt.rs:59\r\n  28: main\r\n  29: __libc_start_main\r\n  30: _start\r\n             at ../sysdeps/x86_64/start.S:120\r\nTraceback (most recent call last):\r\n  File \"./x.py\", line 20, in <module>\r\n    bootstrap.main()\r\n  File \"/builddir/build/BUILD/rustc-1.21.0-src/src/bootstrap/bootstrap.py\", line 799, in main\r\n    bootstrap()\r\n  File \"/builddir/build/BUILD/rustc-1.21.0-src/src/bootstrap/bootstrap.py\", line 790, in bootstrap\r\n    run(args, env=env, verbose=build.verbose)\r\n  File \"/builddir/build/BUILD/rustc-1.21.0-src/src/bootstrap/bootstrap.py\", line 148, in run\r\n    raise RuntimeError(err)\r\nRuntimeError: failed to run: /builddir/build/BUILD/rustc-1.21.0-src/build/bootstrap/debug/bootstrap build --verbose\r\nerror: Bad exit status from /var/tmp/rpm-tmp.18704 (%build)\r\nRPM build errors:\r\n    Bad exit status from /var/tmp/rpm-tmp.18704 (%build)\r\nChild returncode was: 1\r\n```", "closed_by": {"login": "sfackler", "id": 1455697, "node_id": "MDQ6VXNlcjE0NTU2OTc=", "avatar_url": "https://avatars.githubusercontent.com/u/1455697?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sfackler", "html_url": "https://github.com/sfackler", "followers_url": "https://api.github.com/users/sfackler/followers", "following_url": "https://api.github.com/users/sfackler/following{/other_user}", "gists_url": "https://api.github.com/users/sfackler/gists{/gist_id}", "starred_url": "https://api.github.com/users/sfackler/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sfackler/subscriptions", "organizations_url": "https://api.github.com/users/sfackler/orgs", "repos_url": "https://api.github.com/users/sfackler/repos", "events_url": "https://api.github.com/users/sfackler/events{/privacy}", "received_events_url": "https://api.github.com/users/sfackler/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/45309/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/45309/timeline", "performed_via_github_app": null, "state_reason": "completed"}