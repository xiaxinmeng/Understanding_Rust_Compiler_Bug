{"url": "https://api.github.com/repos/rust-lang/rust/issues/51768", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/51768/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/51768/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/51768/events", "html_url": "https://github.com/rust-lang/rust/issues/51768", "id": 335227762, "node_id": "MDU6SXNzdWUzMzUyMjc3NjI=", "number": 51768, "title": "Documentation for core::panic::PanicInfo should not use unwrap()", "user": {"login": "gamozolabs", "id": 13505090, "node_id": "MDQ6VXNlcjEzNTA1MDkw", "avatar_url": "https://avatars.githubusercontent.com/u/13505090?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gamozolabs", "html_url": "https://github.com/gamozolabs", "followers_url": "https://api.github.com/users/gamozolabs/followers", "following_url": "https://api.github.com/users/gamozolabs/following{/other_user}", "gists_url": "https://api.github.com/users/gamozolabs/gists{/gist_id}", "starred_url": "https://api.github.com/users/gamozolabs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gamozolabs/subscriptions", "organizations_url": "https://api.github.com/users/gamozolabs/orgs", "repos_url": "https://api.github.com/users/gamozolabs/repos", "events_url": "https://api.github.com/users/gamozolabs/events{/privacy}", "received_events_url": "https://api.github.com/users/gamozolabs/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 60344715, "node_id": "MDU6TGFiZWw2MDM0NDcxNQ==", "url": "https://api.github.com/repos/rust-lang/rust/labels/P-medium", "name": "P-medium", "color": "eb6420", "default": false, "description": "Medium priority"}, {"id": 431251592, "node_id": "MDU6TGFiZWw0MzEyNTE1OTI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-docs", "name": "A-docs", "color": "f7e101", "default": false, "description": "Area: documentation for any part of the project, including the compiler, standard library, and tools"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-06-25T00:44:28Z", "updated_at": "2018-07-11T12:12:30Z", "closed_at": "2018-07-11T12:12:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "Current documentation for `core::panic::PanicInfo` uses examples with `downcast_ref` and an `unwrap`. I was just porting over some old `no_std` code and copied over the examples for testing. However in a `no_std` codebase this leads to infinite recursion and probably stack exhaustion or other weird behavior depending on the design of the system implementing the panic.\r\n\r\nI think that the example should be changed from:\r\n\r\n`println!(\"panic occurred: {:?}\", panic_info.payload().downcast_ref::<&str>().unwrap());`\r\n\r\nto something like:\r\n\r\n`println!(\"panic occurred: {:?}\", panic_info.payload().downcast_ref::<&str>().unwrap_or(\"Payload unavailable\"));`\r\n\r\nOr switching to `if let` to handle the `None` case.\r\n\r\nNot really that big of an issue, but I think any panic handler examples in the documentation should not be able to recursively panic.", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/51768/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/51768/timeline", "performed_via_github_app": null, "state_reason": "completed"}