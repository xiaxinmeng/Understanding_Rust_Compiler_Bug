{"url": "https://api.github.com/repos/rust-lang/rust/issues/46950", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/46950/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/46950/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/46950/events", "html_url": "https://github.com/rust-lang/rust/issues/46950", "id": 284208088, "node_id": "MDU6SXNzdWUyODQyMDgwODg=", "number": 46950, "title": "test_mul_add failt in debug mode for arm-unknown-linux-gnueabi", "user": {"login": "malbarbo", "id": 1678126, "node_id": "MDQ6VXNlcjE2NzgxMjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1678126?v=4", "gravatar_id": "", "url": "https://api.github.com/users/malbarbo", "html_url": "https://github.com/malbarbo", "followers_url": "https://api.github.com/users/malbarbo/followers", "following_url": "https://api.github.com/users/malbarbo/following{/other_user}", "gists_url": "https://api.github.com/users/malbarbo/gists{/gist_id}", "starred_url": "https://api.github.com/users/malbarbo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/malbarbo/subscriptions", "organizations_url": "https://api.github.com/users/malbarbo/orgs", "repos_url": "https://api.github.com/users/malbarbo/repos", "events_url": "https://api.github.com/users/malbarbo/events{/privacy}", "received_events_url": "https://api.github.com/users/malbarbo/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 55301954, "node_id": "MDU6TGFiZWw1NTMwMTk1NA==", "url": "https://api.github.com/repos/rust-lang/rust/labels/O-Arm", "name": "O-Arm", "color": "6e6ec0", "default": false, "description": "Target: 32-bit Arm processors (armv6, armv7, thumb...), including 64-bit Arm in AArch32 state"}, {"id": 211668062, "node_id": "MDU6TGFiZWwyMTE2NjgwNjI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-libs-api", "name": "T-libs-api", "color": "bfd4f2", "default": false, "description": "Relevant to the library API team, which will review and decide on the PR/issue."}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2017-12-22T16:55:30Z", "updated_at": "2018-01-30T14:10:35Z", "closed_at": null, "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "This following test extract from libstd:\r\n\r\n```rust\r\n#[cfg(test)]\r\nmod tests {\r\n    macro_rules! assert_approx_eq {\r\n        ($a:expr, $b:expr) => ({\r\n            let (a, b) = (&$a, &$b);\r\n            assert!((*a - *b).abs() < 1.0e-6,\r\n                    \"{} is not approximately equal to {}\", *a, *b);\r\n        })\r\n    }\r\n\r\n    #[test]\r\n    fn f64_test_mul_add() {\r\n        assert_approx_eq!((-12.3f64).mul_add(-4.5, -6.7), 48.65);\r\n        assert_approx_eq!(0.0f64.mul_add(8.9, 1.2), 1.2);\r\n    }\r\n\r\n    #[test]\r\n    fn f32_test_mul_add() {\r\n        assert_approx_eq!((-12.3f32).mul_add(-4.5, -6.7), 48.65);\r\n        assert_approx_eq!(0.0f32.mul_add(8.9, 1.2), 1.2);\r\n    }\r\n}\r\n```\r\n\r\nfails to run in raspbarry pi 3 and in qemu when compiled in debug mode for the target `arm-unknown-linux-gnueabi`. It works if compiled in release mode. `rustc 1.24.0-nightly (250b49205 2017-12-21)` was used.\r\n\r\nTo test using [cross](https://github.com/japaric/cross), create a project execute `cross test --target arm-unknown-linux-gnueabi`. cross execute the test using qemu-arm, but I think it is not a problem with qemu because the test also fails running in a raspbarry pi 3. Also the test works if compiled in release mode.\r\n\r\nqemu error:\r\n\r\n```\r\n---- tests::f32_test_mul_add stdout ----\r\n        thread 'tests::f32_test_mul_add' panicked at '38.4 is not approximately equal to 1.2', src/lib.rs:20:8\r\n\r\n---- tests::f64_test_mul_add stdout ----\r\n        thread 'tests::f64_test_mul_add' panicked at '38.4 is not approximately equal to 1.2', src/lib.rs:14:8\r\n```\r\n\r\nraspberry pi error:\r\n\r\n```\r\n---- tests::f32_test_mul_add stdout ----\r\n        thread 'tests::f32_test_mul_add' panicked at '-12.3 is not approximately equal to 48.65', src/lib.rs:19:8\r\n\r\n---- tests::f64_test_mul_add stdout ----\r\n        thread 'tests::f64_test_mul_add' panicked at '0 is not approximately equal to 48.65', src/lib.rs:13:8\r\n```\r\n", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/46950/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 1, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/46950/timeline", "performed_via_github_app": null, "state_reason": null}