{"url": "https://api.github.com/repos/rust-lang/rust/issues/20349", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/20349/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/20349/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/20349/events", "html_url": "https://github.com/rust-lang/rust/issues/20349", "id": 53148040, "node_id": "MDU6SXNzdWU1MzE0ODA0MA==", "number": 20349, "title": "Questions about librustc_back", "user": {"login": "Binero", "id": 6867251, "node_id": "MDQ6VXNlcjY4NjcyNTE=", "avatar_url": "https://avatars.githubusercontent.com/u/6867251?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Binero", "html_url": "https://github.com/Binero", "followers_url": "https://api.github.com/users/Binero/followers", "following_url": "https://api.github.com/users/Binero/following{/other_user}", "gists_url": "https://api.github.com/users/Binero/gists{/gist_id}", "starred_url": "https://api.github.com/users/Binero/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Binero/subscriptions", "organizations_url": "https://api.github.com/users/Binero/orgs", "repos_url": "https://api.github.com/users/Binero/repos", "events_url": "https://api.github.com/users/Binero/events{/privacy}", "received_events_url": "https://api.github.com/users/Binero/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 37234, "node_id": "MDU6TGFiZWwzNzIzNA==", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-cleanup", "name": "C-cleanup", "color": "f5f1fd", "default": false, "description": "Category: PRs that clean code up or issues documenting cleanup."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2014-12-30T21:20:57Z", "updated_at": "2015-07-13T16:56:07Z", "closed_at": "2015-07-13T16:56:07Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "The crate [librustc_back](https://github.com/rust-lang/rust/tree/master/src/librustc_back) seems to be very broad. At the moment it handles some stuff related to target specification, and it has some utility functions. \n\nThe target specification seems to be implemented in a redundant way, the data-layout for different platforms and architectures is defined in too many places, as an example x64: [[1]](https://github.com/rust-lang/rust/blob/master/src/librustc_back/x86_64.rs#L15)[[2]](https://github.com/rust-lang/rust/blob/master/src/librustc_back/target/x86_64_apple_darwin.rs#L19)[[3]](https://github.com/rust-lang/rust/blob/master/src/librustc_back/target/x86_64_pc_windows_gnu.rs#L21)[[4]](https://github.com/rust-lang/rust/blob/master/src/librustc_back/target/x86_64_unknown_dragonfly.rs#L18)[[5]](https://github.com/rust-lang/rust/blob/master/src/librustc_back/target/x86_64_unknown_freebsd.rs#L18)[[6]](https://github.com/rust-lang/rust/blob/master/src/librustc_back/target/x86_64_unknown_linux_gnu.rs).\n\nThere are some utility functions which are questionable. For example, [fs](https://github.com/rust-lang/rust/blob/master/src/librustc_back/fs.rs) seems to contain a single function, to resolve symbolic links. This function doesn't really seem neccesairy, why would you want to resolve out symbolic links? I understand there is probably a reason for this, but even function could be implemented in the standard library, where it'd probably make more sense. \n\nThe [sha2](https://github.com/rust-lang/rust/blob/master/src/librustc_back/sha2.rs) module also contains a few integer based functions which should probably be moved to the standard library: [[1]](https://github.com/rust-lang/rust/blob/master/src/librustc_back/sha2.rs#L24)[[2]](https://github.com/rust-lang/rust/blob/master/src/librustc_back/sha2.rs#L32). \n\nThe name of the crate is very misleading as well. It implies it's a backend, while really it is just a crate of small, unrelated utility functions. I think the target specification stuff should be split out of that crate, into a seperate one, with an appropriate name (or at least be put into a seperate module) and the verious utility functions be iterated over to see if they are really needed, and if they are at the right place. \n\nI know this issue is poorly named, but couldn't really think of something better. :)\n", "closed_by": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/20349/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/20349/timeline", "performed_via_github_app": null, "state_reason": "completed"}