{"url": "https://api.github.com/repos/rust-lang/rust/issues/54552", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/54552/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/54552/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/54552/events", "html_url": "https://github.com/rust-lang/rust/issues/54552", "id": 363470921, "node_id": "MDU6SXNzdWUzNjM0NzA5MjE=", "number": 54552, "title": "panic in Receiver::recv_timeout()", "user": {"login": "rob-solana", "id": 40183961, "node_id": "MDQ6VXNlcjQwMTgzOTYx", "avatar_url": "https://avatars.githubusercontent.com/u/40183961?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rob-solana", "html_url": "https://github.com/rob-solana", "followers_url": "https://api.github.com/users/rob-solana/followers", "following_url": "https://api.github.com/users/rob-solana/following{/other_user}", "gists_url": "https://api.github.com/users/rob-solana/gists{/gist_id}", "starred_url": "https://api.github.com/users/rob-solana/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rob-solana/subscriptions", "organizations_url": "https://api.github.com/users/rob-solana/orgs", "repos_url": "https://api.github.com/users/rob-solana/repos", "events_url": "https://api.github.com/users/rob-solana/events{/privacy}", "received_events_url": "https://api.github.com/users/rob-solana/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 211668062, "node_id": "MDU6TGFiZWwyMTE2NjgwNjI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-libs-api", "name": "T-libs-api", "color": "bfd4f2", "default": false, "description": "Relevant to the library API team, which will review and decide on the PR/issue."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-09-25T08:47:05Z", "updated_at": "2019-01-02T04:39:59Z", "closed_at": "2019-01-02T04:39:59Z", "author_association": "NONE", "active_lock_reason": null, "body": "Receiver::recv_timeout() panics with large values of timeout\r\n\r\nI tried this code:\r\n\r\n```\r\nlet (s, r) = channel();\r\nr.recv_timeout(Duration::new(std::u64::MAX,0)); // never time out\r\n```\r\n\r\nI expected a blocking receive.\r\n\r\nInstead, this happened:\r\n```\r\nthread 'main' panicked at 'overflow when adding duration to time', libcore/option.rs:989:5\r\n```\r\n\r\nhttps://play.rust-lang.org/?gist=4880602aa21f718bd8fa7e4826380218&version=stable&mode=debug&edition=2015\r\n\r\n\r\n## Meta\r\n\r\nrustc --version --verbose\r\n```\r\nrustc 1.29.0 (aa3ca1994 2018-09-11)\r\nbinary: rustc\r\ncommit-hash: aa3ca1994904f2e056679fce1f185db8c7ed2703\r\ncommit-date: 2018-09-11\r\nhost: x86_64-unknown-linux-gnu\r\nrelease: 1.29.0\r\nLLVM version: 7.0\r\n```\r\nBacktrace:\r\n```\r\nstack backtrace:\r\n   0: std::sys::unix::backtrace::tracing::imp::unwind_backtrace\r\n             at libstd/sys/unix/backtrace/tracing/gcc_s.rs:49\r\n   1: std::sys_common::backtrace::print\r\n             at libstd/sys_common/backtrace.rs:71\r\n             at libstd/sys_common/backtrace.rs:59\r\n   2: std::panicking::default_hook::{{closure}}\r\n             at libstd/panicking.rs:211\r\n   3: std::panicking::default_hook\r\n             at libstd/panicking.rs:227\r\n   4: std::panicking::rust_panic_with_hook\r\n             at libstd/panicking.rs:475\r\n   5: std::panicking::continue_panic_fmt\r\n             at libstd/panicking.rs:390\r\n   6: rust_begin_unwind\r\n             at libstd/panicking.rs:325\r\n   7: core::panicking::panic_fmt\r\n             at libcore/panicking.rs:77\r\n   8: core::option::expect_failed\r\n             at libcore/option.rs:989\r\n   9: <std::time::Instant as core::ops::arith::Add<core::time::Duration>>::add\r\n             at /checkout/src/libcore/option.rs:312\r\n             at libstd/sys/unix/time.rs:46\r\n             at libstd/sys/unix/time.rs:297\r\n             at libstd/time.rs:218\r\n  10: <std::sync::mpsc::Receiver<T>>::recv_timeout\r\n             at /checkout/src/libstd/sync/mpsc/mod.rs:1300\r\n  11: playground::main\r\n             at src/main.rs:5\r\n  12: std::rt::lang_start::{{closure}}\r\n             at /checkout/src/libstd/rt.rs:74\r\n  13: std::panicking::try::do_call\r\n             at libstd/rt.rs:59\r\n             at libstd/panicking.rs:310\r\n  14: __rust_maybe_catch_panic\r\n             at libpanic_unwind/lib.rs:105\r\n  15: std::rt::lang_start_internal\r\n             at libstd/panicking.rs:289\r\n             at libstd/panic.rs:392\r\n             at libstd/rt.rs:58\r\n  16: std::rt::lang_start\r\n             at /checkout/src/libstd/rt.rs:74\r\n  17: main\r\n  18: __libc_start_main\r\n  19: _start\r\n```", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/54552/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/54552/timeline", "performed_via_github_app": null, "state_reason": "completed"}