{"url": "https://api.github.com/repos/rust-lang/rust/issues/41032", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/41032/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/41032/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/41032/events", "html_url": "https://github.com/rust-lang/rust/issues/41032", "id": 218913237, "node_id": "MDU6SXNzdWUyMTg5MTMyMzc=", "number": 41032, "title": "panicked at 'Box<Any>' when running Cargo test", "user": {"login": "jmelion", "id": 6462004, "node_id": "MDQ6VXNlcjY0NjIwMDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/6462004?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jmelion", "html_url": "https://github.com/jmelion", "followers_url": "https://api.github.com/users/jmelion/followers", "following_url": "https://api.github.com/users/jmelion/following{/other_user}", "gists_url": "https://api.github.com/users/jmelion/gists{/gist_id}", "starred_url": "https://api.github.com/users/jmelion/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jmelion/subscriptions", "organizations_url": "https://api.github.com/users/jmelion/orgs", "repos_url": "https://api.github.com/users/jmelion/repos", "events_url": "https://api.github.com/users/jmelion/events{/privacy}", "received_events_url": "https://api.github.com/users/jmelion/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-04-03T12:08:43Z", "updated_at": "2017-04-03T18:13:14Z", "closed_at": "2017-04-03T18:13:14Z", "author_association": "NONE", "active_lock_reason": null, "body": "My code snippet throws `panicked at 'Box<Any>'` when running `cargo test` on the following code:\r\n\r\n```\r\nfn main() {\r\n    println!(\"Hello, world!\");\r\n}\r\n\r\nfn to_bab(aba: &str) -> Option<String>\r\n{\r\n    if aba.len() != 3\r\n    {\r\n        return None\r\n    }\r\n    let mut result = String::new();\r\n    result.push(aba.chars().nth(1).unwrap());\r\n    result.push(aba.chars().nth(0).unwrap());\r\n    result.push(aba.chars().nth(1).unwrap());\r\n    Some(result)\r\n}\r\n\r\npub fn contains_matching_babs(abas: &[&str], babs: &[&str]) -> bool\r\n{\r\n    if abas.is_empty() || babs.is_empty()\r\n    {\r\n        return false;\r\n    }\r\n    for aba in abas.iter()\r\n    {\r\n       if babs.contains(&(to_bab(aba).unwrap_or(String::new()).as_str()))\r\n       {\r\n           return true;\r\n       }\r\n    }\r\n    false\r\n}\r\n\r\nmod test\r\n{\r\n    use super::contains_matching_babs;\r\n\r\n    #[test]\r\n    fn test_contains_matching_babs()\r\n    {\r\n        let abas = vec![\"aba\", \"cdc\", \"pop\" ];\r\n        let babs = vec![\"kdk\", \"psp\", \"dcd\" ];\r\n        let cdcs = vec![\"idi\", \"aha\", \"bjb\" ];\r\n\r\n        assert!(contains_matching_babs(&abas, &babs), true);\r\n        assert!(contains_matching_babs(&babs, &abas), true);\r\n        assert!(contains_matching_babs(&abas, &cdcs), false);\r\n        assert!(contains_matching_babs(&cdcs, &abas), false);\r\n    }\r\n}\r\n```\r\nI am new to Rust so I might be missing something, and I realise this code is messy but I don't really see any instance where the code would panic. If I fill it with print statements, the panic seems to come upon returning from the `contains_matching_babs` function.\r\n\r\nIf I comment out the last two `assert` statements the code runs and the tests pass fine.\r\n\r\nThis seems related to [issue 32783](https://github.com/rust-lang/rust/issues/32783) however it seemed to happen with an older nightly version of rustc, whereas this is with a supposedly stable version.\r\n\r\n## Meta\r\n\r\n`rustc --version --verbose`:\r\n\r\n```\r\nrustc 1.15.1 (021bd294c 2017-02-08)\r\nbinary: rustc\r\ncommit-hash: 021bd294c039bd54aa5c4aa85bcdffb0d24bc892\r\ncommit-date: 2017-02-08\r\nhost: x86_64-unknown-linux-gnu\r\nrelease: 1.15.1\r\nLLVM version: 3.9\r\n\r\n```\r\n\r\nBacktrace:\r\n```\r\n---- test::test_contains_matching_babs stdout ----\r\n\tthread 'test::test_contains_matching_babs' panicked at 'Box<Any>', src/main.rs:47\r\nstack backtrace:\r\n   1:     0x7fc377ccb8ba - std::sys::imp::backtrace::tracing::imp::write::h3188f035833a2635\r\n                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libstd/sys/unix/backtrace/tracing/gcc_s.rs:42\r\n   2:     0x7fc377cce95f - std::panicking::default_hook::{{closure}}::h6385b6959a2dd25b\r\n                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libstd/panicking.rs:349\r\n   3:     0x7fc377cce4fd - std::panicking::default_hook::he4f3b61755d7fa95\r\n                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libstd/panicking.rs:359\r\n   4:     0x7fc377ccee07 - std::panicking::rust_panic_with_hook::hf00b8130f73095ec\r\n                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libstd/panicking.rs:553\r\n   5:     0x7fc377c8ab02 - std::panicking::begin_panic::h9099384c43e50561\r\n                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libstd/panicking.rs:515\r\n   6:     0x7fc377c8e8c8 - bug_report::test::test_contains_matching_babs::h43b2441a3a256fde\r\n                        at /path/to/project/src/main.rs:47\r\n   7:     0x7fc377c9ccce - <F as test::FnBox<T>>::call_box::h04563d623b7ebdf9\r\n                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libtest/lib.rs:1349\r\n                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libtest/lib.rs:140\r\n   8:     0x7fc377cd5d1a - __rust_maybe_catch_panic\r\n                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libpanic_unwind/lib.rs:98\r\n   9:     0x7fc377c9125a - std::panicking::try::do_call::h092f707f35bffc28\r\n                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libstd/panicking.rs:434\r\n                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libstd/panic.rs:351\r\n                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libtest/lib.rs:1294\r\n                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libstd/panic.rs:295\r\n                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libstd/panicking.rs:458\r\n  10:     0x7fc377cd5d1a - __rust_maybe_catch_panic\r\n                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libpanic_unwind/lib.rs:98\r\n  11:     0x7fc377c97e32 - <F as alloc::boxed::FnBox<A>>::call_box::h23358fa8847261cf\r\n                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libstd/panicking.rs:434\r\n                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libstd/panic.rs:351\r\n                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libstd/thread/mod.rs:301\r\n                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/liballoc/boxed.rs:605\r\n  12:     0x7fc377ccdc64 - std::sys::imp::thread::Thread::new::thread_start::he018521f53b24939\r\n                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/liballoc/boxed.rs:615\r\n                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libstd/sys_common/thread.rs:21\r\n                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libstd/sys/unix/thread.rs:84\r\n  13:     0x7fc377434183 - start_thread\r\n  14:     0x7fc376f4b37c - clone\r\n  15:                0x0 - <unknown>\r\n\r\n```", "closed_by": {"login": "jmelion", "id": 6462004, "node_id": "MDQ6VXNlcjY0NjIwMDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/6462004?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jmelion", "html_url": "https://github.com/jmelion", "followers_url": "https://api.github.com/users/jmelion/followers", "following_url": "https://api.github.com/users/jmelion/following{/other_user}", "gists_url": "https://api.github.com/users/jmelion/gists{/gist_id}", "starred_url": "https://api.github.com/users/jmelion/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jmelion/subscriptions", "organizations_url": "https://api.github.com/users/jmelion/orgs", "repos_url": "https://api.github.com/users/jmelion/repos", "events_url": "https://api.github.com/users/jmelion/events{/privacy}", "received_events_url": "https://api.github.com/users/jmelion/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/41032/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/41032/timeline", "performed_via_github_app": null, "state_reason": "completed"}