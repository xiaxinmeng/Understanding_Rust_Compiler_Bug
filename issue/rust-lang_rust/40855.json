{"url": "https://api.github.com/repos/rust-lang/rust/issues/40855", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/40855/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/40855/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/40855/events", "html_url": "https://github.com/rust-lang/rust/issues/40855", "id": 217279012, "node_id": "MDU6SXNzdWUyMTcyNzkwMTI=", "number": 40855, "title": "Consider adding a help message when the moved value was a `FnOnce`", "user": {"login": "jorendorff", "id": 283361, "node_id": "MDQ6VXNlcjI4MzM2MQ==", "avatar_url": "https://avatars.githubusercontent.com/u/283361?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jorendorff", "html_url": "https://github.com/jorendorff", "followers_url": "https://api.github.com/users/jorendorff/followers", "following_url": "https://api.github.com/users/jorendorff/following{/other_user}", "gists_url": "https://api.github.com/users/jorendorff/gists{/gist_id}", "starred_url": "https://api.github.com/users/jorendorff/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jorendorff/subscriptions", "organizations_url": "https://api.github.com/users/jorendorff/orgs", "repos_url": "https://api.github.com/users/jorendorff/repos", "events_url": "https://api.github.com/users/jorendorff/events{/privacy}", "received_events_url": "https://api.github.com/users/jorendorff/received_events", "type": "User", "site_admin": true}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2017-03-27T15:12:38Z", "updated_at": "2017-05-20T02:13:29Z", "closed_at": "2017-05-20T02:13:29Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "In _Programming Rust_, a book I'm writing, there's this:\r\n\r\n----\r\n\r\nIt doesn't happen often, but once in a great while you'll write some closure code that unintentionally uses up a value:\r\n\r\n    let dict = produce_glossary();\r\n    let debug_dump_dict = || {\r\n        for (key, value) in dict {  // oops!\r\n            println!(\"{:?} - {:?}\", key, value);\r\n        }\r\n    };\r\n\r\nThen, when you call `debug_dump_dict()` more than once, you'll get an error message like this:\r\n\r\n```console\r\nerror[E0382]: use of moved value: `debug_dump_dict`\r\n  --> debug_dump_dict.rs:18:5\r\n   |\r\n17 |     debug_dump_dict();\r\n   |     --------------- value moved here\r\n18 |     debug_dump_dict();\r\n   |     ^^^^^^^^^^^^^^^ value used here after move\r\n   |\r\n```\r\n\r\nThis isn't a very helpful error message, unless you know what Rust is trying to tell you: a previous call to this closure moved it, because this closure is a `FnOnce`.\r\n\r\n----\r\n\r\nIn reviewing the book, @brson encouraged me to file a bug about the diagnostic here. It's probably not worth doing anything, since closures aren't normally used this way. (I considered removing the passage from the book rather than file this bug.)\r\n\r\nBut what the heck. Conceivably a \"help\" could be added here that says \"closure was moved because it only implements `FnOnce`\".", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/40855/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/40855/timeline", "performed_via_github_app": null, "state_reason": "completed"}