{"url": "https://api.github.com/repos/rust-lang/rust/issues/99989", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/99989/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/99989/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/99989/events", "html_url": "https://github.com/rust-lang/rust/issues/99989", "id": 1323528327, "node_id": "I_kwDOAAsO6M5O43CH", "number": 99989, "title": "Download a pre-compiled bootstrap from CI", "user": {"login": "jyn514", "id": 23638587, "node_id": "MDQ6VXNlcjIzNjM4NTg3", "avatar_url": "https://avatars.githubusercontent.com/u/23638587?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jyn514", "html_url": "https://github.com/jyn514", "followers_url": "https://api.github.com/users/jyn514/followers", "following_url": "https://api.github.com/users/jyn514/following{/other_user}", "gists_url": "https://api.github.com/users/jyn514/gists{/gist_id}", "starred_url": "https://api.github.com/users/jyn514/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jyn514/subscriptions", "organizations_url": "https://api.github.com/users/jyn514/orgs", "repos_url": "https://api.github.com/users/jyn514/repos", "events_url": "https://api.github.com/users/jyn514/events{/privacy}", "received_events_url": "https://api.github.com/users/jyn514/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 67766349, "node_id": "MDU6TGFiZWw2Nzc2NjM0OQ==", "url": "https://api.github.com/repos/rust-lang/rust/labels/E-mentor", "name": "E-mentor", "color": "02E10C", "default": false, "description": "Call for participation: This issue has a mentor. Use RustcContributor::new on Zulip for discussion."}, {"id": 325438536, "node_id": "MDU6TGFiZWwzMjU0Mzg1MzY=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-bootstrap", "name": "T-bootstrap", "color": "bfd4f2", "default": false, "description": "Relevant to the bootstrap subteam: Rust's build system (x.py and src/bootstrap)"}, {"id": 419557634, "node_id": "MDU6TGFiZWw0MTk1NTc2MzQ=", "url": "https://api.github.com/repos/rust-lang/rust/labels/E-medium", "name": "E-medium", "color": "02e10c", "default": false, "description": "Call for participation: Experience needed to fix: Medium / intermediate"}], "state": "open", "locked": false, "assignee": {"login": "dvtkrlbs", "id": 24792168, "node_id": "MDQ6VXNlcjI0NzkyMTY4", "avatar_url": "https://avatars.githubusercontent.com/u/24792168?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dvtkrlbs", "html_url": "https://github.com/dvtkrlbs", "followers_url": "https://api.github.com/users/dvtkrlbs/followers", "following_url": "https://api.github.com/users/dvtkrlbs/following{/other_user}", "gists_url": "https://api.github.com/users/dvtkrlbs/gists{/gist_id}", "starred_url": "https://api.github.com/users/dvtkrlbs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dvtkrlbs/subscriptions", "organizations_url": "https://api.github.com/users/dvtkrlbs/orgs", "repos_url": "https://api.github.com/users/dvtkrlbs/repos", "events_url": "https://api.github.com/users/dvtkrlbs/events{/privacy}", "received_events_url": "https://api.github.com/users/dvtkrlbs/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "dvtkrlbs", "id": 24792168, "node_id": "MDQ6VXNlcjI0NzkyMTY4", "avatar_url": "https://avatars.githubusercontent.com/u/24792168?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dvtkrlbs", "html_url": "https://github.com/dvtkrlbs", "followers_url": "https://api.github.com/users/dvtkrlbs/followers", "following_url": "https://api.github.com/users/dvtkrlbs/following{/other_user}", "gists_url": "https://api.github.com/users/dvtkrlbs/gists{/gist_id}", "starred_url": "https://api.github.com/users/dvtkrlbs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dvtkrlbs/subscriptions", "organizations_url": "https://api.github.com/users/dvtkrlbs/orgs", "repos_url": "https://api.github.com/users/dvtkrlbs/repos", "events_url": "https://api.github.com/users/dvtkrlbs/events{/privacy}", "received_events_url": "https://api.github.com/users/dvtkrlbs/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 18, "created_at": "2022-07-31T17:35:25Z", "updated_at": "2023-06-13T22:39:38Z", "closed_at": null, "author_association": "MEMBER", "active_lock_reason": null, "body": "Currently, we unconditionally recompile bootstrap on all builds, like libstd. In most cases, this is unnecessary: bootstrap is rarely changed and it's confusing that we have to build a whole rust program before processing `x.py --help`. Additionally, it means that when we add the new shell script entrypoints, we'd have to replicate all of bootstrap.py's logic for finding config.toml and the build directory. If we can download bootstrap through rustup, it will greatly simplify all that logic.\n\nMost of this work has already been done in https://github.com/rust-lang/rust/pull/98483. The work left is to actually download the generated artifact in bootstrap.py.\n\ncc @dvtkrlbs\n\nMentoring instructions:\n1. Add a new `download_or_build_bootstrap` function to `src/bootstrap/bootstrap.py`.\n2. If there are changes to src/bootstrap (you can find these with `git diff-index --quiet HEAD -- src/bootstrap`), then always rebuild it from source.\n3. Otherwise, download it from ci-artifacts.rust-lang.org, as configured by `stage0.json` - you may have to modify the `Stage0Toolchain` python object to load this configuration.\n\nHelps with https://github.com/rust-lang/rust/issues/94829.\n\n<!-- TRIAGEBOT_START -->\n\n<!-- TRIAGEBOT_ASSIGN_START -->\n\n<!-- TRIAGEBOT_ASSIGN_DATA_START$${\"user\":\"dvtkrlbs\"}$$TRIAGEBOT_ASSIGN_DATA_END -->\n\n<!-- TRIAGEBOT_ASSIGN_END -->\n<!-- TRIAGEBOT_END -->", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/99989/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 1, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/99989/timeline", "performed_via_github_app": null, "state_reason": null}