{"url": "https://api.github.com/repos/rust-lang/rust/issues/36622", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/36622/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/36622/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/36622/events", "html_url": "https://github.com/rust-lang/rust/issues/36622", "id": 178342259, "node_id": "MDU6SXNzdWUxNzgzNDIyNTk=", "number": 36622, "title": "ICE with RUST_LOG=debug and dependency rand", "user": {"login": "Eroc33", "id": 599099, "node_id": "MDQ6VXNlcjU5OTA5OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/599099?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Eroc33", "html_url": "https://github.com/Eroc33", "followers_url": "https://api.github.com/users/Eroc33/followers", "following_url": "https://api.github.com/users/Eroc33/following{/other_user}", "gists_url": "https://api.github.com/users/Eroc33/gists{/gist_id}", "starred_url": "https://api.github.com/users/Eroc33/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Eroc33/subscriptions", "organizations_url": "https://api.github.com/users/Eroc33/orgs", "repos_url": "https://api.github.com/users/Eroc33/repos", "events_url": "https://api.github.com/users/Eroc33/events{/privacy}", "received_events_url": "https://api.github.com/users/Eroc33/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}, {"id": 60344715, "node_id": "MDU6TGFiZWw2MDM0NDcxNQ==", "url": "https://api.github.com/repos/rust-lang/rust/labels/P-medium", "name": "P-medium", "color": "eb6420", "default": false, "description": "Medium priority"}, {"id": 67766349, "node_id": "MDU6TGFiZWw2Nzc2NjM0OQ==", "url": "https://api.github.com/repos/rust-lang/rust/labels/E-mentor", "name": "E-mentor", "color": "02E10C", "default": false, "description": "Call for participation: This issue has a mentor. Use RustcContributor::new on Zulip for discussion."}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 262252628, "node_id": "MDU6TGFiZWwyNjIyNTI2Mjg=", "url": "https://api.github.com/repos/rust-lang/rust/labels/regression-from-stable-to-beta", "name": "regression-from-stable-to-beta", "color": "e4008a", "default": false, "description": "Performance or correctness regression from stable to beta."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 23, "created_at": "2016-09-21T13:10:29Z", "updated_at": "2016-11-02T02:38:24Z", "closed_at": "2016-11-02T02:38:24Z", "author_association": "NONE", "active_lock_reason": null, "body": "**UPDATE:** Note that @eddyb would like to mentor and wrote out some steps to fix this [in a comment below](https://github.com/rust-lang/rust/issues/36622#issuecomment-250978480).\n\n---\n\n`cargo 0.13.0-nightly (2ef3cde 2016-09-04)`\n`rustc 1.13.0-nightly (cbe4de78e 2016-09-05)`\n\nrepro steps:\n1. Create a new cargo project with `cargo new --bin whatever`\n2. add rand to the dependencies\n3. compile with `RUST_LOG=debug cargo run`\n\n(Edit: `RUST_LOG=debug cargo build` also triggers the ICE)\n\n(Note that using various different crates as dependencies will also cause various different ICEs)\n\n(Also note that most of these ICEs do not occur if not setting `RUST_LOG` while compiling)\n\nfull log: [ice_log.txt](https://github.com/rust-lang/rust/files/485059/ice_log.txt)\n\nRelevant excerpt:\n\n```\nINFO:rustc_trans::base: trans_closure(..., <I as std::iter::IntoIterator><std::iter::Chain<std::iter::Map<std::slice::Iter<u64>, [closure@C:\\Users\\euan\\.cargo\\registry\\src\\github.com-1ecc6299db9ec823\\rand-0.3.14\\src\\isaac.rs:462:41: 462:47]>, std::iter::Repeat<u64>>>::into_iter)\nINFO:rustc_trans::base: trans_closure(..., <I as std::iter::IntoIterator><std::iter::Map<std::ops::Range<usize>, [closure@C:\\Users\\euan\\.cargo\\registry\\src\\github.com-1ecc6299db9ec823\\rand-0.3.14\\src\\isaac.rs:378:47: 378:56]>>::into_iter)\nINFO:rustc_trans::base: trans_closure(..., <I as std::iter::IntoIterator><std::iter::Zip<std::slice::IterMut<std::num::Wrapping<u64>>, std::iter::Chain<std::iter::Map<std::slice::Iter<u64>, [closure@C:\\Users\\euan\\.cargo\\registry\\src\\github.com-1ecc6299db9ec823\\rand-0.3.14\\src\\isaac.rs:462:41: 462:47]>, std::iter::Repeat<u64>>>>::into_iter)\nINFO:rustc_trans::base: trans_closure(..., <&'a T as std::fmt::Display><str>::fmt)\nINFO:rustc_trans::base: trans_closure(..., <std::rc::Rc<T> as std::ops::Drop><std::cell::RefCell<reseeding::ReseedingRng<StdRng, ThreadRngReseeder>>>::drop)\nINFO:rustc_trans::base: trans_closure(..., <std::rc::Rc<T> as std::ops::Deref><std::cell::RefCell<reseeding::ReseedingRng<StdRng, ThreadRngReseeder>>>::deref)\nINFO:rustc_trans::base: trans_closure(..., <std::rc::Rc<std::cell::RefCell<reseeding::ReseedingRng<StdRng, ThreadRngReseeder>>> as std::rc::RcBoxPtr<std::cell::RefCell<reseeding::ReseedingRng<StdRng, ThreadRngReseeder>>>>::dec_strong)\nINFO:rustc_trans::base: trans_closure(..., <std::rc::Rc<std::cell::RefCell<reseeding::ReseedingRng<StdRng, ThreadRngReseeder>>> as std::rc::RcBoxPtr<std::cell::RefCell<reseeding::ReseedingRng<StdRng, ThreadRngReseeder>>>>::inc_strong)\nINFO:rustc_trans::base: trans_closure(..., ERROR:rbml::reader: failed to find block with tag 143\nerror: internal compiler error: unexpected panic\n\nnote: the compiler unexpectedly panicked. this is a bug.\n\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports\n\nnote: run with `RUST_BACKTRACE=1` for a backtrace\n\nthread 'rustc' panicked at 'explicit panic', ../src/librbml/lib.rs:436\nstack backtrace:\n   0:     0x7ffa3ff56fda - <std::rand::OsRng as rand::Rng>::fill_bytes::h076068e3d5c70638\n   1:     0x7ffa3ff54d40 - std::panicking::Location::line::h1d71b2da86bcc037\n   2:     0x7ffa3ff557cd - std::panicking::rust_panic_with_hook::hb1322e5f2588b4db\n   3:     0x7ffa44651273 - <unknown>\n   4:     0x7ffa4465302c - rbml::reader::get_doc::hf109ec97c202ad64\n   5:     0x7ffa3d024707 - rustc_metadata::decoder::get_generics::hf99308a6734a6c62\n   6:     0x7ffa3d04409f - rustc_metadata::csearch::<impl rustc::middle::cstore::CrateStore<'tcx> for rustc_metadata::cstore::CStore>::item_generics::h44e6e64c15136301\n   7:     0x7ffa3780a432 - rustc::ty::<impl rustc::ty::context::TyCtxt<'a, 'gcx, 'tcx>>::lookup_generics::h5d0ec4d9f7a8a996\n   8:     0x7ffa378122b2 - rustc::util::ppaux::parameterized::hfe6ba681ef424d4e\n   9:     0x7ffa3fbc61aa - <rustc_trans::monomorphize::Instance<'tcx> as core::fmt::Display>::fmt::h4bb5172b1516f67e\n  10:     0x7ffa3ff85694 - core::fmt::write::h300d6e605e327781\n  11:     0x7ffa3ff85392 - <core::fmt::Arguments<'a> as core::fmt::Debug>::fmt::h1da25a9952bf0c75\n  12:     0x7ffa3ff85694 - core::fmt::write::h300d6e605e327781\n  13:     0x7ffa3ff337dd - <std::io::stdio::Stderr as std::io::Write>::write_fmt::h559a8ee8db54dc03\n  14:     0x7ffa4ae41fbc - <log::DefaultLogger as log::Logger>::log::h514ee6b9954c2db7\n  15:     0x7ffa4ae42d85 - log::log::h551356a60d785f61\n  16:     0x7ffa3fb2f1a6 - rustc_trans::base::<impl rustc_trans::common::FunctionContext<'blk, 'tcx>>::build_return_block::hc40c124e6ced672c\n  17:     0x7ffa3fb54cf1 - <rustc_trans::cleanup::UnwindKind as core::cmp::PartialEq>::eq::h586cba4e1cacdefe\n  18:     0x7ffa3fbbdec2 - <rustc_trans::mir::operand::OperandRef<'tcx> as core::fmt::Debug>::fmt::hebcdf3c5cd4db77c\n  19:     0x7ffa3fbaa046 - <rustc_trans::mir::analyze::CleanupKind as core::cmp::PartialEq>::ne::ha52631b54e0dcbae\n  20:     0x7ffa3fba725f - <rustc_trans::mir::CachedMir<'mir, 'tcx> as core::ops::Deref>::deref::h6f4e0d0cf4c71518\n  21:     0x7ffa3fb2f409 - rustc_trans::base::<impl rustc_trans::common::FunctionContext<'blk, 'tcx>>::build_return_block::hc40c124e6ced672c\n  22:     0x7ffa3fbcf025 - rustc_trans::trans_item::TransItem::define::h159a1f0a8708f3d3\n  23:     0x7ffa3fb33221 - rustc_trans::base::trans_crate::hf067cf9d0a8bcbf2\n  24:     0x7ffa4024deb4 - rustc_driver::driver::phase_4_translate_to_llvm::he9d5d0022988d46e\n  25:     0x7ffa4029d483 - rustc_driver::main::h5a1049f207c7c577\n  26:     0x7ffa40280641 - rustc_driver::main::h5a1049f207c7c577\n  27:     0x7ffa401be5d2 - <unknown>\n  28:     0x7ffa4023dadf - rustc_driver::driver::compile_input::h7dacd98cd2fd7d2b\n  29:     0x7ffa4026a5e9 - rustc_driver::run_compiler::h37c4294ab73436f7\n  30:     0x7ffa4018b051 - <unknown>\n  31:     0x7ffa3ff5fa31 - _rust_maybe_catch_panic\n  32:     0x7ffa401a84f4 - <unknown>\n  33:     0x7ffa3ff529ce - std::sys::thread::Thread::new::h117e066ad5633902\n  34:     0x7ffa65788363 - BaseThreadInitThunk\n\nINFO:cargo::ops::cargo_rustc::job_queue: end: rand v0.3.14 => Target(lib)/Profile(build) => Host\nDEBUG:cargo: handle_error; err=CliError { error: Some(ChainedError { error: Could not compile `rand`., cause: Process didn't exit successfully: `rustc C:\\Users\\euan\\.cargo\\registry\\src\\github.com-1ecc6299db9ec823\\rand-0.3.14\\src\\lib.rs --crate-name rand --crate-type lib -g -C metadata=49a08859d086fffe -C extra-filename=-49a08859d086fffe --out-dir D:\\dev\\rust\\testing\\target\\debug\\deps --emit=dep-info,link -L dependency=D:\\dev\\rust\\testing\\target\\debug\\deps --extern libc=D:\\dev\\rust\\testing\\target\\debug\\deps\\liblibc-1417726cb94dbc83.rlib --cap-lints allow` (exit code: 101) }), unknown: false, exit_code: 101 }\nerror: Could not compile `rand`.\n```\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/36622/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/36622/timeline", "performed_via_github_app": null, "state_reason": "completed"}