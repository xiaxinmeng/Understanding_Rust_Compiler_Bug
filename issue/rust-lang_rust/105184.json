{"url": "https://api.github.com/repos/rust-lang/rust/issues/105184", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/105184/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/105184/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/105184/events", "html_url": "https://github.com/rust-lang/rust/issues/105184", "id": 1473304532, "node_id": "I_kwDOAAsO6M5X0NfU", "number": 105184, "title": "Confusing error when summing iterator of `()`", "user": {"login": "jvns", "id": 817739, "node_id": "MDQ6VXNlcjgxNzczOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/817739?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvns", "html_url": "https://github.com/jvns", "followers_url": "https://api.github.com/users/jvns/followers", "following_url": "https://api.github.com/users/jvns/following{/other_user}", "gists_url": "https://api.github.com/users/jvns/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvns/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvns/subscriptions", "organizations_url": "https://api.github.com/users/jvns/orgs", "repos_url": "https://api.github.com/users/jvns/repos", "events_url": "https://api.github.com/users/jvns/events{/privacy}", "received_events_url": "https://api.github.com/users/jvns/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 235791, "node_id": "MDU6TGFiZWwyMzU3OTE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-diagnostics", "name": "A-diagnostics", "color": "f7e101", "default": false, "description": "Area: Messages for errors, warnings, and lints"}, {"id": 13836860, "node_id": "MDU6TGFiZWwxMzgzNjg2MA==", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-traits", "name": "A-traits", "color": "f7e101", "default": false, "description": "Area: Trait system"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 1596122130, "node_id": "MDU6TGFiZWwxNTk2MTIyMTMw", "url": "https://api.github.com/repos/rust-lang/rust/labels/D-papercut", "name": "D-papercut", "color": "c9f7a3", "default": false, "description": "Diagnostic error that needs small tweaks"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2022-12-02T18:54:52Z", "updated_at": "2022-12-13T22:34:10Z", "closed_at": null, "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Here's some code ([playground](https://play.rust-lang.org/?version=stable&mode=debug&edition=2021&gist=275f94fe419f49479dabf1704068c5d3)):\r\n\r\n```rust\r\nfn main() {\r\n    vec![(), ()].iter().sum::<i32>();\r\n}\r\n```\r\n\r\nThis has an obvious bug: You can't sum a bunch of `()` and get an `i32` as a result. Here's the error message, though:\r\n\r\n```\r\n2 |     vec![(), ()].iter().sum::<i32>();\r\n  |     ^^^^^^^^^^^^^^^^^^^ --- required by a bound introduced by this call\r\n  |     |\r\n  |     the trait `Sum<&()>` is not implemented for `i32`\r\n```\r\n\r\nThis was very confusing to me -- I'd expect to see an error saying something like `Sum` not implemented for `Iter<()>`. But instead it says that `Sum` is not implemented for **i32** But I'm not trying to sum i32s!\r\n\r\n(my actual bug was actually that I'd accidentally added an extra `;` in my code, so that I was trying to sum `()`s instead of `i32`, and the confusing error message made it harder to figure out that out)\r\n\r\nWhat's actually going on here is:\r\n\r\n* `i32` has a static method called `sum(iter: Iter<i32>)`, that comes from the `Sum` trait.\r\n* `Iter` has a `sum()` method that calls this static method on `i32`\r\n* when I run `my_iter.sum()`, it tries to call `i32::sum(my_iter)`\r\n* `i32::sum` isn't defined for `Iter<()>`\r\n* as a result, we get the error message `the trait `Sum<&()>` is not implemented for `i32``\r\n\r\nI might not have gotten all the types/terms exactly right, but I think that's the gist of it.\r\n\r\nThis all makes sense, but it's was pretty confusing for me to unwind. Maybe the compiler could have helped me unwind it? \r\n\r\nreporting as requested by @estebank ", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/105184/reactions", "total_count": 14, "+1": 14, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/105184/timeline", "performed_via_github_app": null, "state_reason": null}