{"url": "https://api.github.com/repos/rust-lang/rust/issues/52185", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/52185/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/52185/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/52185/events", "html_url": "https://github.com/rust-lang/rust/issues/52185", "id": 339553742, "node_id": "MDU6SXNzdWUzMzk1NTM3NDI=", "number": 52185, "title": "rust-lldb: \"ValueError: Positive integer expected\" trying to print regex::Captures", "user": {"login": "alex", "id": 772, "node_id": "MDQ6VXNlcjc3Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/772?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alex", "html_url": "https://github.com/alex", "followers_url": "https://api.github.com/users/alex/followers", "following_url": "https://api.github.com/users/alex/following{/other_user}", "gists_url": "https://api.github.com/users/alex/gists{/gist_id}", "starred_url": "https://api.github.com/users/alex/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alex/subscriptions", "organizations_url": "https://api.github.com/users/alex/orgs", "repos_url": "https://api.github.com/users/alex/repos", "events_url": "https://api.github.com/users/alex/events{/privacy}", "received_events_url": "https://api.github.com/users/alex/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-07-09T18:11:49Z", "updated_at": "2019-03-09T21:24:31Z", "closed_at": "2019-03-09T21:24:31Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "I'm in a frame of Rust code with a `regex::Captures` local:\r\n\r\n```\r\nframe #9: 0x00000001000095d1 dom-rooting`dom_rooting::parse_callgraph_call::he390b4fd9cb48a86(line=\"D 1 2\") at main.rs:84\r\n   81  \t    let m = RE.captures(line)\r\n   82  \t        .expect(&format!(\"parse failure: {:?}\", line));\r\n   83\r\n-> 84  \t    return (m[1].parse().unwrap(), m[2].parse().unwrap());\r\n   85  \t}\r\n   86\r\n   87  \tfn parse_callgraph(p: &Path) -> Callgraph {\r\n```\r\n\r\nI try to print `m` (the `regex::Captures`) and hilarity ensues:\r\n\r\n```\r\n(lldb) p m\r\nTraceback (most recent call last):\r\n  File \"/Users/agaynor/.rustup/toolchains/stable-x86_64-apple-darwin/lib/rustlib/etc/lldb_rust_formatters.py\", line 99, in print_val\r\n    is_tuple_like = False)\r\n  File \"/Users/agaynor/.rustup/toolchains/stable-x86_64-apple-darwin/lib/rustlib/etc/lldb_rust_formatters.py\", line 220, in print_struct_val\r\n    body = separator.join([render_child(idx) for idx in range(field_start_index, len(fields))])\r\n  File \"/Users/agaynor/.rustup/toolchains/stable-x86_64-apple-darwin/lib/rustlib/etc/lldb_rust_formatters.py\", line 213, in render_child\r\n    return this + print_val(field_val.get_wrapped_value(), internal_dict)\r\n  File \"/Users/agaynor/.rustup/toolchains/stable-x86_64-apple-darwin/lib/rustlib/etc/lldb_rust_formatters.py\", line 132, in print_val\r\n    is_tuple_like = True)\r\n  File \"/Users/agaynor/.rustup/toolchains/stable-x86_64-apple-darwin/lib/rustlib/etc/lldb_rust_formatters.py\", line 220, in print_struct_val\r\n    body = separator.join([render_child(idx) for idx in range(field_start_index, len(fields))])\r\n  File \"/Users/agaynor/.rustup/toolchains/stable-x86_64-apple-darwin/lib/rustlib/etc/lldb_rust_formatters.py\", line 213, in render_child\r\n    return this + print_val(field_val.get_wrapped_value(), internal_dict)\r\n  File \"/Users/agaynor/.rustup/toolchains/stable-x86_64-apple-darwin/lib/rustlib/etc/lldb_rust_formatters.py\", line 115, in print_val\r\n    return print_std_vec_val(val, internal_dict)\r\n  File \"/Users/agaynor/.rustup/toolchains/stable-x86_64-apple-darwin/lib/rustlib/etc/lldb_rust_formatters.py\", line 264, in print_std_vec_val\r\n    internal_dict)\r\n  File \"/Users/agaynor/.rustup/toolchains/stable-x86_64-apple-darwin/lib/rustlib/etc/lldb_rust_formatters.py\", line 299, in print_array_of_values\r\n    return ', '.join([render_element(i) for i in range(length)])\r\n  File \"/Users/agaynor/.rustup/toolchains/stable-x86_64-apple-darwin/lib/rustlib/etc/lldb_rust_formatters.py\", line 297, in render_element\r\n    return print_val(element_val, internal_dict)\r\n  File \"/Users/agaynor/.rustup/toolchains/stable-x86_64-apple-darwin/lib/rustlib/etc/lldb_rust_formatters.py\", line 156, in print_val\r\n    return print_val(lldb_val.GetChildAtIndex(discriminant_val), internal_dict)\r\n  File \"/Users/agaynor/.rustup/toolchains/stable-x86_64-apple-darwin/lib/rustlib/etc/lldb_rust_formatters.py\", line 132, in print_val\r\n    is_tuple_like = True)\r\n  File \"/Users/agaynor/.rustup/toolchains/stable-x86_64-apple-darwin/lib/rustlib/etc/lldb_rust_formatters.py\", line 220, in print_struct_val\r\n    body = separator.join([render_child(idx) for idx in range(field_start_index, len(fields))])\r\n  File \"/Users/agaynor/.rustup/toolchains/stable-x86_64-apple-darwin/lib/rustlib/etc/lldb_rust_formatters.py\", line 213, in render_child\r\n    return this + print_val(field_val.get_wrapped_value(), internal_dict)\r\n  File \"/Users/agaynor/.rustup/toolchains/stable-x86_64-apple-darwin/lib/rustlib/etc/lldb_rust_formatters.py\", line 112, in print_val\r\n    return print_str_slice_val(val, internal_dict)\r\n  File \"/Users/agaynor/.rustup/toolchains/stable-x86_64-apple-darwin/lib/rustlib/etc/lldb_rust_formatters.py\", line 268, in print_str_slice_val\r\n    return read_utf8_string(data_ptr, length)\r\n  File \"/Users/agaynor/.rustup/toolchains/stable-x86_64-apple-darwin/lib/rustlib/etc/lldb_rust_formatters.py\", line 305, in read_utf8_string\r\n    data = process.ReadMemory(ptr_val.as_integer(), byte_count, error)\r\n  File \"/Applications/Xcode.app/Contents/SharedFrameworks/LLDB.framework/Resources/Python/lldb/__init__.py\", line 7184, in ReadMemory\r\n    return _lldb.SBProcess_ReadMemory(self, *args)\r\nValueError: Positive integer expected\r\nTraceback (most recent call last):\r\n  File \"/Users/agaynor/.rustup/toolchains/stable-x86_64-apple-darwin/lib/rustlib/etc/lldb_rust_formatters.py\", line 132, in print_val\r\n    is_tuple_like = True)\r\n  File \"/Users/agaynor/.rustup/toolchains/stable-x86_64-apple-darwin/lib/rustlib/etc/lldb_rust_formatters.py\", line 220, in print_struct_val\r\n    body = separator.join([render_child(idx) for idx in range(field_start_index, len(fields))])\r\n  File \"/Users/agaynor/.rustup/toolchains/stable-x86_64-apple-darwin/lib/rustlib/etc/lldb_rust_formatters.py\", line 213, in render_child\r\n    return this + print_val(field_val.get_wrapped_value(), internal_dict)\r\n  File \"/Users/agaynor/.rustup/toolchains/stable-x86_64-apple-darwin/lib/rustlib/etc/lldb_rust_formatters.py\", line 115, in print_val\r\n    return print_std_vec_val(val, internal_dict)\r\n  File \"/Users/agaynor/.rustup/toolchains/stable-x86_64-apple-darwin/lib/rustlib/etc/lldb_rust_formatters.py\", line 264, in print_std_vec_val\r\n    internal_dict)\r\n  File \"/Users/agaynor/.rustup/toolchains/stable-x86_64-apple-darwin/lib/rustlib/etc/lldb_rust_formatters.py\", line 299, in print_array_of_values\r\n    return ', '.join([render_element(i) for i in range(length)])\r\n  File \"/Users/agaynor/.rustup/toolchains/stable-x86_64-apple-darwin/lib/rustlib/etc/lldb_rust_formatters.py\", line 297, in render_element\r\n    return print_val(element_val, internal_dict)\r\n  File \"/Users/agaynor/.rustup/toolchains/stable-x86_64-apple-darwin/lib/rustlib/etc/lldb_rust_formatters.py\", line 156, in print_val\r\n    return print_val(lldb_val.GetChildAtIndex(discriminant_val), internal_dict)\r\n  File \"/Users/agaynor/.rustup/toolchains/stable-x86_64-apple-darwin/lib/rustlib/etc/lldb_rust_formatters.py\", line 132, in print_val\r\n    is_tuple_like = True)\r\n  File \"/Users/agaynor/.rustup/toolchains/stable-x86_64-apple-darwin/lib/rustlib/etc/lldb_rust_formatters.py\", line 220, in print_struct_val\r\n    body = separator.join([render_child(idx) for idx in range(field_start_index, len(fields))])\r\n  File \"/Users/agaynor/.rustup/toolchains/stable-x86_64-apple-darwin/lib/rustlib/etc/lldb_rust_formatters.py\", line 213, in render_child\r\n    return this + print_val(field_val.get_wrapped_value(), internal_dict)\r\n  File \"/Users/agaynor/.rustup/toolchains/stable-x86_64-apple-darwin/lib/rustlib/etc/lldb_rust_formatters.py\", line 112, in print_val\r\n    return print_str_slice_val(val, internal_dict)\r\n  File \"/Users/agaynor/.rustup/toolchains/stable-x86_64-apple-darwin/lib/rustlib/etc/lldb_rust_formatters.py\", line 268, in print_str_slice_val\r\n    return read_utf8_string(data_ptr, length)\r\n  File \"/Users/agaynor/.rustup/toolchains/stable-x86_64-apple-darwin/lib/rustlib/etc/lldb_rust_formatters.py\", line 305, in read_utf8_string\r\n    data = process.ReadMemory(ptr_val.as_integer(), byte_count, error)\r\n  File \"/Applications/Xcode.app/Contents/SharedFrameworks/LLDB.framework/Resources/Python/lldb/__init__.py\", line 7184, in ReadMemory\r\n    return _lldb.SBProcess_ReadMemory(self, *args)\r\nValueError: Positive integer expected\r\nTraceback (most recent call last):\r\n  File \"/Users/agaynor/.rustup/toolchains/stable-x86_64-apple-darwin/lib/rustlib/etc/lldb_rust_formatters.py\", line 115, in print_val\r\n    return print_std_vec_val(val, internal_dict)\r\n  File \"/Users/agaynor/.rustup/toolchains/stable-x86_64-apple-darwin/lib/rustlib/etc/lldb_rust_formatters.py\", line 264, in print_std_vec_val\r\n    internal_dict)\r\n  File \"/Users/agaynor/.rustup/toolchains/stable-x86_64-apple-darwin/lib/rustlib/etc/lldb_rust_formatters.py\", line 299, in print_array_of_values\r\n    return ', '.join([render_element(i) for i in range(length)])\r\n  File \"/Users/agaynor/.rustup/toolchains/stable-x86_64-apple-darwin/lib/rustlib/etc/lldb_rust_formatters.py\", line 297, in render_element\r\n    return print_val(element_val, internal_dict)\r\n  File \"/Users/agaynor/.rustup/toolchains/stable-x86_64-apple-darwin/lib/rustlib/etc/lldb_rust_formatters.py\", line 156, in print_val\r\n    return print_val(lldb_val.GetChildAtIndex(discriminant_val), internal_dict)\r\n  File \"/Users/agaynor/.rustup/toolchains/stable-x86_64-apple-darwin/lib/rustlib/etc/lldb_rust_formatters.py\", line 132, in print_val\r\n    is_tuple_like = True)\r\n  File \"/Users/agaynor/.rustup/toolchains/stable-x86_64-apple-darwin/lib/rustlib/etc/lldb_rust_formatters.py\", line 220, in print_struct_val\r\n    body = separator.join([render_child(idx) for idx in range(field_start_index, len(fields))])\r\n  File \"/Users/agaynor/.rustup/toolchains/stable-x86_64-apple-darwin/lib/rustlib/etc/lldb_rust_formatters.py\", line 213, in render_child\r\n    return this + print_val(field_val.get_wrapped_value(), internal_dict)\r\n  File \"/Users/agaynor/.rustup/toolchains/stable-x86_64-apple-darwin/lib/rustlib/etc/lldb_rust_formatters.py\", line 112, in print_val\r\n    return print_str_slice_val(val, internal_dict)\r\n  File \"/Users/agaynor/.rustup/toolchains/stable-x86_64-apple-darwin/lib/rustlib/etc/lldb_rust_formatters.py\", line 268, in print_str_slice_val\r\n    return read_utf8_string(data_ptr, length)\r\n  File \"/Users/agaynor/.rustup/toolchains/stable-x86_64-apple-darwin/lib/rustlib/etc/lldb_rust_formatters.py\", line 305, in read_utf8_string\r\n    data = process.ReadMemory(ptr_val.as_integer(), byte_count, error)\r\n  File \"/Applications/Xcode.app/Contents/SharedFrameworks/LLDB.framework/Resources/Python/lldb/__init__.py\", line 7184, in ReadMemory\r\n    return _lldb.SBProcess_ReadMemory(self, *args)\r\nValueError: Positive integer expected\r\n(regex::re_unicode::Captures) $3 = {\r\n  text = \"D 1 2\"\r\n  locs = {\r\n    __0 = {\r\n      buf = RawVec<core::option::Option<usize>, alloc::alloc::Global> {\r\nptr: Unique<core::option::Option<usize>> {\r\npointer: NonZero<*const core::option::Option<usize>>(&0x10288d280),\r\n_marker: PhantomData<core::option::Option<usize>>\r\n},\r\ncap: 8,\r\na: Global\r\n}\r\n      len = 8\r\n    }\r\n  }\r\n  named_groups = Arc<std::collections::hash::map::HashMap<alloc::string::String, usize, std::collections::hash::map::RandomState>> {\r\nptr: NonNull<alloc::arc::ArcInner<std::collections::hash::map::HashMap<alloc::string::String, usize, std::collections::hash::map::RandomState>>> {\r\npointer: NonZero<*const alloc::arc::ArcInner<std::collections::hash::map::HashMap<alloc::string::String, usize, std::collections::hash::map::RandomState>>>(&0x10288c500)\r\n},\r\nphantom: PhantomData<std::collections::hash::map::HashMap<alloc::string::String, usize, std::collections::hash::map::RandomState>>\r\n}\r\n}\r\n(lldb)\r\n```\r\n\r\nSystem info:\r\n\r\n```\r\n~/p/h/dom-rooting \u276f\u276f\u276f rust-lldb --version\r\nlldb-900.0.57\r\n  Swift-4.0\r\n~/p/h/dom-rooting \u276f\u276f\u276f rustc --version\r\nrustc 1.27.0 (3eda71b00 2018-06-19)\r\n~/p/h/dom-rooting \u276f\u276f\u276f sw_vers\r\nProductName:\tMac OS X\r\nProductVersion:\t10.13.5\r\nBuildVersion:\t17F77\r\n```", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/52185/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/52185/timeline", "performed_via_github_app": null, "state_reason": "completed"}