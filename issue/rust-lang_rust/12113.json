{"url": "https://api.github.com/repos/rust-lang/rust/issues/12113", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/12113/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/12113/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/12113/events", "html_url": "https://github.com/rust-lang/rust/issues/12113", "id": 27206338, "node_id": "MDU6SXNzdWUyNzIwNjMzOA==", "number": 12113, "title": "io::IoError should carry info on the invalid byte sequence on non-utf8 InvalidInput", "user": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 234902, "node_id": "MDU6TGFiZWwyMzQ5MDI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-enhancement", "name": "C-enhancement", "color": "f5f1fd", "default": false, "description": "Category: An issue proposing an enhancement or a PR with one."}, {"id": 211668062, "node_id": "MDU6TGFiZWwyMTE2NjgwNjI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-libs-api", "name": "T-libs-api", "color": "bfd4f2", "default": false, "description": "Relevant to the library API team, which will review and decide on the PR/issue."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2014-02-08T19:00:42Z", "updated_at": "2018-07-28T21:59:10Z", "closed_at": "2018-07-28T21:59:10Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "If you feed in a byte stream that is almost utf-8 but has errors, a looped series of calls to  `fn read_char` will eventually return an `IoError` with `kind == InvalidResult`.\n\nUnfortunately, the returned `IoError` does not include any information about what the bytes were that were invalid (nor does it include information like how many bytes were read from the input before the error was encountered).\n\nIt seems like it would not be that bad to change `IoError` so that its `detail` field could be an `Option<Either<~str, ~[u8]>>`, or something along those lines, so that in this scenario, the `InvalidResult` would imply that one could look at the `detail` field to determine what the byte sequence was that caused the problem (and then the client code would have the option of substituting in a different character sequence specific to the byte sequence that failed).\n\n(Alternatively, we could change `IoErrorKind` so that the `InvalidResult` variant carried an `Option<~[u8]>`, but then the `IoErrorKind` would no longer be a C-like enum.)\n\nI believe that this is strictly more expressive than just mapping every replacement to a single replacement character, as is done by `from_utf8_lossy` (#12062).\n", "closed_by": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/12113/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/12113/timeline", "performed_via_github_app": null, "state_reason": "completed"}