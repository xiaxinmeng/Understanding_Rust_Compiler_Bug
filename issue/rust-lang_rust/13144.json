{"url": "https://api.github.com/repos/rust-lang/rust/issues/13144", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/13144/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/13144/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/13144/events", "html_url": "https://github.com/rust-lang/rust/issues/13144", "id": 30174352, "node_id": "MDU6SXNzdWUzMDE3NDM1Mg==", "number": 13144, "title": "debuginfo: Generate debugging information for function level static variables", "user": {"login": "cmacknz", "id": 3466215, "node_id": "MDQ6VXNlcjM0NjYyMTU=", "avatar_url": "https://avatars.githubusercontent.com/u/3466215?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cmacknz", "html_url": "https://github.com/cmacknz", "followers_url": "https://api.github.com/users/cmacknz/followers", "following_url": "https://api.github.com/users/cmacknz/following{/other_user}", "gists_url": "https://api.github.com/users/cmacknz/gists{/gist_id}", "starred_url": "https://api.github.com/users/cmacknz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cmacknz/subscriptions", "organizations_url": "https://api.github.com/users/cmacknz/orgs", "repos_url": "https://api.github.com/users/cmacknz/repos", "events_url": "https://api.github.com/users/cmacknz/events{/privacy}", "received_events_url": "https://api.github.com/users/cmacknz/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 203130, "node_id": "MDU6TGFiZWwyMDMxMzA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-debuginfo", "name": "A-debuginfo", "color": "f7e101", "default": false, "description": "Area: Debugging information in compiled programs (DWARF, PDB, etc.)"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2014-03-25T23:40:55Z", "updated_at": "2017-04-15T16:09:52Z", "closed_at": "2017-04-15T16:09:52Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Support for crate level static variable debug info will be added once the patch for #9227 lands, but it does not include support for handling statics declared at the function level.\n\nFundamentally the new `debuginfo::create_global_var_metadata()` function needs to be updated to do the following:\n\n1) Identify when the variable it was called with was declared within a function.\n2) Emit scope metadata indicating that the variable belongs to the function, rather than the containing crate.\n\nThe \"correct\" way to approach this would be to update `debuginfo::populate_scope_map::walk_decl()` to handle the `DeclItem` case for `ItemStatic` items as is done for function local variables.\n\nHowever, as a consequence of a bug in clang/llvm (see: http://llvm.org/bugs/show_bug.cgi?id=19238), passing the lexical scope metadata from a `debuginfo::FunctionDebugContextData::scope_map` member to `llvm::LLVMDIBuilderCreateStaticVariable()` results in a segfault when generating debug information.\n\nThe suggested work around is to use the function debug info as scope for the variable instead, with the consequence that the generated debug info will be not be entirely correct (similar to the clang case in the bug above).\n", "closed_by": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/13144/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/13144/timeline", "performed_via_github_app": null, "state_reason": "completed"}