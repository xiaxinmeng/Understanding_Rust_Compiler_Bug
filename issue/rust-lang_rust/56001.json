{"url": "https://api.github.com/repos/rust-lang/rust/issues/56001", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/56001/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/56001/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/56001/events", "html_url": "https://github.com/rust-lang/rust/issues/56001", "id": 381562073, "node_id": "MDU6SXNzdWUzODE1NjIwNzM=", "number": 56001, "title": "Compiler panic 'attempt to subtract with overflow'", "user": {"login": "weiznich", "id": 1674512, "node_id": "MDQ6VXNlcjE2NzQ1MTI=", "avatar_url": "https://avatars.githubusercontent.com/u/1674512?v=4", "gravatar_id": "", "url": "https://api.github.com/users/weiznich", "html_url": "https://github.com/weiznich", "followers_url": "https://api.github.com/users/weiznich/followers", "following_url": "https://api.github.com/users/weiznich/following{/other_user}", "gists_url": "https://api.github.com/users/weiznich/gists{/gist_id}", "starred_url": "https://api.github.com/users/weiznich/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/weiznich/subscriptions", "organizations_url": "https://api.github.com/users/weiznich/orgs", "repos_url": "https://api.github.com/users/weiznich/repos", "events_url": "https://api.github.com/users/weiznich/events{/privacy}", "received_events_url": "https://api.github.com/users/weiznich/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 256133398, "node_id": "MDU6TGFiZWwyNTYxMzMzOTg=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-mir", "name": "A-mir", "color": "f7e101", "default": false, "description": "Area: Mid-level IR (MIR) - https://blog.rust-lang.org/2016/04/19/MIR.html"}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}, {"id": 1359848690, "node_id": "MDU6TGFiZWwxMzU5ODQ4Njkw", "url": "https://api.github.com/repos/rust-lang/rust/labels/E-needs-mcve", "name": "E-needs-mcve", "color": "02e10c", "default": false, "description": "Call for participation: This issue needs a Minimal Complete and Verifiable Example"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-11-16T11:33:09Z", "updated_at": "2020-03-10T20:28:25Z", "closed_at": "2020-03-10T20:28:25Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I've trying to do same work on the compiler. Therefore I've checked out the rust repo a6b9b97bd9b704f85f0184f7a213cc4d62bd9654c.\r\nI'm using basically the standard config.toml, just set `debug-assertions = true`\r\nIf I use the resulting compiler to compile the [diesel-oci](https://github.com/GiGainfosystems/diesel-oci) I get an internal compiler error while cargo tries to build diesel.\r\n\r\n(This is only happening for my own build, not on nightly or any other released builds. Also this seems to happen only for `debug-assertions = true`)\r\n\r\nBacktrace:\r\n```\r\n    Checking diesel v1.3.3 (https://github.com/GiGainfosystems/diesel?rev=0d6a5d419#0d6a5d41)\r\nthread 'main' panicked at 'attempt to subtract with overflow', libsyntax/source_map.rs:787:41\r\nstack backtrace:\r\n   0: std::sys::unix::backtrace::tracing::imp::unwind_backtrace\r\n   1: std::sys_common::backtrace::print\r\n   2: std::panicking::default_hook::{{closure}}\r\n   3: std::panicking::default_hook\r\n   4: rustc::util::common::panic_hook\r\n   5: std::panicking::rust_panic_with_hook\r\n   6: std::panicking::continue_panic_fmt\r\n   7: rust_begin_unwind\r\n   8: core::panicking::panic_fmt\r\n   9: core::panicking::panic\r\n  10: syntax::source_map::SourceMap::find_width_of_character_at_span\r\n  11: syntax::source_map::SourceMap::end_point\r\n  12: rustc_mir::build::scope::<impl rustc_mir::build::Builder<'a, 'gcx, 'tcx>>::schedule_drop\r\n  13: rustc_mir::build::expr::as_temp::<impl rustc_mir::build::Builder<'a, 'gcx, 'tcx>>::expr_as_temp\r\n  14: rustc_mir::build::expr::as_operand::<impl rustc_mir::build::Builder<'a, 'gcx, 'tcx>>::expr_as_operand\r\n  15: rustc_mir::build::expr::as_operand::<impl rustc_mir::build::Builder<'a, 'gcx, 'tcx>>::expr_as_operand\r\n  16: rustc_mir::build::expr::as_operand::<impl rustc_mir::build::Builder<'a, 'gcx, 'tcx>>::as_local_operand\r\n  17: <core::iter::Map<I, F> as core::iter::iterator::Iterator>::fold\r\n  18: <alloc::vec::Vec<T> as alloc::vec::SpecExtend<T, I>>::from_iter\r\n  19: rustc_mir::build::expr::into::<impl rustc_mir::build::Builder<'a, 'gcx, 'tcx>>::into_expr\r\n  20: rustc_mir::build::expr::as_temp::<impl rustc_mir::build::Builder<'a, 'gcx, 'tcx>>::expr_as_temp\r\n  21: rustc_mir::build::expr::as_operand::<impl rustc_mir::build::Builder<'a, 'gcx, 'tcx>>::expr_as_operand\r\n  22: rustc_mir::build::expr::as_operand::<impl rustc_mir::build::Builder<'a, 'gcx, 'tcx>>::expr_as_operand\r\n  23: rustc_mir::build::expr::as_operand::<impl rustc_mir::build::Builder<'a, 'gcx, 'tcx>>::as_local_operand\r\n  24: <core::iter::Map<I, F> as core::iter::iterator::Iterator>::fold\r\n  25: <alloc::vec::Vec<T> as alloc::vec::SpecExtend<T, I>>::from_iter\r\n  26: rustc_mir::build::expr::into::<impl rustc_mir::build::Builder<'a, 'gcx, 'tcx>>::into_expr\r\n  27: rustc_mir::build::expr::as_temp::<impl rustc_mir::build::Builder<'a, 'gcx, 'tcx>>::expr_as_temp\r\n  28: rustc_mir::build::expr::as_place::<impl rustc_mir::build::Builder<'a, 'gcx, 'tcx>>::expr_as_place\r\n  29: rustc_mir::build::expr::as_place::<impl rustc_mir::build::Builder<'a, 'gcx, 'tcx>>::expr_as_place\r\n  30: rustc_mir::build::expr::into::<impl rustc_mir::build::Builder<'a, 'gcx, 'tcx>>::into_expr\r\n  31: rustc_mir::build::expr::as_temp::<impl rustc_mir::build::Builder<'a, 'gcx, 'tcx>>::expr_as_temp\r\n  32: rustc_mir::build::expr::as_operand::<impl rustc_mir::build::Builder<'a, 'gcx, 'tcx>>::expr_as_operand\r\n  33: rustc_mir::build::expr::as_operand::<impl rustc_mir::build::Builder<'a, 'gcx, 'tcx>>::expr_as_operand\r\n  34: <core::iter::Map<I, F> as core::iter::iterator::Iterator>::fold\r\n  35: <alloc::vec::Vec<T> as alloc::vec::SpecExtend<T, I>>::from_iter\r\n  36: rustc_mir::build::expr::as_rvalue::<impl rustc_mir::build::Builder<'a, 'gcx, 'tcx>>::expr_as_rvalue\r\n  37: rustc_mir::build::expr::into::<impl rustc_mir::build::Builder<'a, 'gcx, 'tcx>>::into_expr\r\n  38: rustc_mir::build::expr::as_temp::<impl rustc_mir::build::Builder<'a, 'gcx, 'tcx>>::expr_as_temp\r\n  39: rustc_mir::build::expr::as_operand::<impl rustc_mir::build::Builder<'a, 'gcx, 'tcx>>::expr_as_operand\r\n  40: rustc_mir::build::expr::as_operand::<impl rustc_mir::build::Builder<'a, 'gcx, 'tcx>>::expr_as_operand\r\n  41: <std::collections::hash::map::HashMap<K, V, S> as core::iter::traits::FromIterator<(K, V)>>::from_iter\r\n  42: rustc_mir::build::expr::as_rvalue::<impl rustc_mir::build::Builder<'a, 'gcx, 'tcx>>::expr_as_rvalue\r\n  43: rustc_mir::build::expr::into::<impl rustc_mir::build::Builder<'a, 'gcx, 'tcx>>::into_expr\r\n  44: rustc_mir::build::expr::into::<impl rustc_mir::build::Builder<'a, 'gcx, 'tcx>>::into_expr\r\n  45: rustc_mir::build::block::<impl rustc_mir::build::Builder<'a, 'gcx, 'tcx>>::ast_block_stmts\r\n  46: rustc_mir::build::expr::into::<impl rustc_mir::build::Builder<'a, 'gcx, 'tcx>>::into_expr\r\n  47: rustc_mir::build::expr::into::<impl rustc_mir::build::Builder<'a, 'gcx, 'tcx>>::into_expr\r\n  48: rustc_mir::build::expr::into::<impl rustc_mir::build::Builder<'a, 'gcx, 'tcx>>::into_expr\r\n  49: rustc_mir::build::construct_fn\r\n  50: rustc::ty::context::tls::with_related_context\r\n  51: rustc::infer::InferCtxtBuilder::enter\r\n  52: rustc_mir::build::mir_build\r\n  53: rustc_mir::transform::mir_built\r\n  54: rustc::ty::query::__query_compute::mir_built\r\n  55: rustc::ty::query::<impl rustc::ty::query::config::QueryAccessors<'tcx> for rustc::ty::query::queries::mir_built<'tcx>>::compute\r\n  56: rustc::dep_graph::graph::DepGraph::with_task_impl\r\n  57: rustc::ty::context::tls::with_related_context\r\n  58: rustc::ty::query::plumbing::<impl rustc::ty::context::TyCtxt<'a, 'gcx, 'tcx>>::force_query_with_job\r\n  59: rustc::ty::query::plumbing::<impl rustc::ty::context::TyCtxt<'a, 'gcx, 'tcx>>::get_query\r\n  60: rustc::ty::query::<impl rustc::ty::context::TyCtxt<'a, 'tcx, 'lcx>>::mir_built\r\n  61: rustc_mir::transform::check_unsafety::unsafety_check_result\r\n  62: rustc::ty::query::__query_compute::unsafety_check_result\r\n  63: rustc::ty::query::<impl rustc::ty::query::config::QueryAccessors<'tcx> for rustc::ty::query::queries::unsafety_check_result<'tcx>>::compute\r\n  64: rustc::dep_graph::graph::DepGraph::with_task_impl\r\n  65: rustc::ty::context::tls::with_related_context\r\n  66: rustc::ty::query::plumbing::<impl rustc::ty::context::TyCtxt<'a, 'gcx, 'tcx>>::force_query_with_job\r\n  67: rustc::ty::query::plumbing::<impl rustc::ty::context::TyCtxt<'a, 'gcx, 'tcx>>::get_query\r\n  68: rustc::ty::query::<impl rustc::ty::context::TyCtxt<'a, 'tcx, 'lcx>>::unsafety_check_result\r\n  69: rustc_mir::transform::mir_const\r\n  70: rustc::ty::query::__query_compute::mir_const\r\n  71: rustc::ty::query::<impl rustc::ty::query::config::QueryAccessors<'tcx> for rustc::ty::query::queries::mir_const<'tcx>>::compute\r\n  72: rustc::dep_graph::graph::DepGraph::with_task_impl\r\n  73: rustc::ty::context::tls::with_related_context\r\n  74: rustc::ty::query::plumbing::<impl rustc::ty::context::TyCtxt<'a, 'gcx, 'tcx>>::force_query_with_job\r\n  75: rustc::ty::query::plumbing::<impl rustc::ty::context::TyCtxt<'a, 'gcx, 'tcx>>::get_query\r\n  76: rustc::ty::query::<impl rustc::ty::context::TyCtxt<'a, 'tcx, 'lcx>>::mir_const\r\n  77: rustc_mir::transform::mir_validated\r\n  78: rustc::ty::query::__query_compute::mir_validated\r\n  79: rustc::ty::query::<impl rustc::ty::query::config::QueryAccessors<'tcx> for rustc::ty::query::queries::mir_validated<'tcx>>::compute\r\n  80: rustc::dep_graph::graph::DepGraph::with_task_impl\r\n  81: rustc::ty::context::tls::with_related_context\r\n  82: rustc::ty::query::plumbing::<impl rustc::ty::context::TyCtxt<'a, 'gcx, 'tcx>>::force_query_with_job\r\n  83: rustc::ty::query::plumbing::<impl rustc::ty::context::TyCtxt<'a, 'gcx, 'tcx>>::get_query\r\n  84: rustc::ty::query::plumbing::<impl rustc::ty::context::TyCtxt<'a, 'gcx, 'tcx>>::ensure_query\r\n  85: rustc_borrowck::borrowck::borrowck\r\n  86: rustc::ty::query::<impl rustc::ty::query::config::QueryAccessors<'tcx> for rustc::ty::query::queries::borrowck<'tcx>>::compute\r\n  87: rustc::dep_graph::graph::DepGraph::with_task_impl\r\n  88: rustc::ty::context::tls::with_related_context\r\n  89: rustc::ty::query::plumbing::<impl rustc::ty::context::TyCtxt<'a, 'gcx, 'tcx>>::force_query_with_job\r\n  90: rustc::ty::query::plumbing::<impl rustc::ty::context::TyCtxt<'a, 'gcx, 'tcx>>::get_query\r\n  91: rustc::ty::<impl rustc::ty::context::TyCtxt<'a, 'gcx, 'tcx>>::par_body_owners\r\n  92: rustc_borrowck::borrowck::check_crate\r\n  93: rustc::util::common::time\r\n  94: rustc::ty::context::tls::enter_context\r\n  95: <std::thread::local::LocalKey<T>>::with\r\n  96: rustc::ty::context::TyCtxt::create_and_enter\r\n  97: rustc_driver::driver::compile_input\r\n  98: rustc_driver::run_compiler_with_pool\r\n  99: <scoped_tls::ScopedKey<T>>::set\r\nquery stack during panic:\r\n#0 [mir_built] processing `type_impls::tuples::<impl deserialize::QueryableByName<__DB> for (A, B, C, D, E, F, G, H, I, J, K, L)>::build`\r\n#1 [unsafety_check_result] processing `type_impls::tuples::<impl deserialize::QueryableByName<__DB> for (A, B, C, D, E, F, G, H, I, J, K, L)>::build`\r\n#2 [mir_const] processing `type_impls::tuples::<impl deserialize::QueryableByName<__DB> for (A, B, C, D, E, F, G, H, I, J, K, L)>::build`\r\n#3 [mir_validated] processing `type_impls::tuples::<impl deserialize::QueryableByName<__DB> for (A, B, C, D, E, F, G, H, I, J, K, L)>::build`\r\n#4 [borrowck] processing `type_impls::tuples::<impl deserialize::QueryableByName<__DB> for (A, B, C, D, E, F, G, H, I, J, K, L)>::build`\r\nend of query stack\r\n\r\nerror: internal compiler error: unexpected panic\r\n\r\nnote: the compiler unexpectedly panicked. this is a bug.\r\n\r\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports\r\n\r\nnote: rustc 1.32.0-dev running on x86_64-unknown-linux-gnu\r\n\r\nnote: compiler flags: -C debuginfo=2 --crate-type lib\r\n\r\nnote: some of the compiler flags provided by cargo are hidden\r\n\r\nerror: Could not compile `diesel`.\r\n\r\nTo learn more, run the command again with --verbose.\r\n```\r\n", "closed_by": {"login": "weiznich", "id": 1674512, "node_id": "MDQ6VXNlcjE2NzQ1MTI=", "avatar_url": "https://avatars.githubusercontent.com/u/1674512?v=4", "gravatar_id": "", "url": "https://api.github.com/users/weiznich", "html_url": "https://github.com/weiznich", "followers_url": "https://api.github.com/users/weiznich/followers", "following_url": "https://api.github.com/users/weiznich/following{/other_user}", "gists_url": "https://api.github.com/users/weiznich/gists{/gist_id}", "starred_url": "https://api.github.com/users/weiznich/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/weiznich/subscriptions", "organizations_url": "https://api.github.com/users/weiznich/orgs", "repos_url": "https://api.github.com/users/weiznich/repos", "events_url": "https://api.github.com/users/weiznich/events{/privacy}", "received_events_url": "https://api.github.com/users/weiznich/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/56001/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/56001/timeline", "performed_via_github_app": null, "state_reason": "completed"}