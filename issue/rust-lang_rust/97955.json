{"url": "https://api.github.com/repos/rust-lang/rust/issues/97955", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/97955/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/97955/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/97955/events", "html_url": "https://github.com/rust-lang/rust/issues/97955", "id": 1267845601, "node_id": "I_kwDOAAsO6M5Lkcnh", "number": 97955, "title": "Builds not reproducible because full path to the source code is in the panic and debug strings", "user": {"login": "david-a-wheeler", "id": 813150, "node_id": "MDQ6VXNlcjgxMzE1MA==", "avatar_url": "https://avatars.githubusercontent.com/u/813150?v=4", "gravatar_id": "", "url": "https://api.github.com/users/david-a-wheeler", "html_url": "https://github.com/david-a-wheeler", "followers_url": "https://api.github.com/users/david-a-wheeler/followers", "following_url": "https://api.github.com/users/david-a-wheeler/following{/other_user}", "gists_url": "https://api.github.com/users/david-a-wheeler/gists{/gist_id}", "starred_url": "https://api.github.com/users/david-a-wheeler/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/david-a-wheeler/subscriptions", "organizations_url": "https://api.github.com/users/david-a-wheeler/orgs", "repos_url": "https://api.github.com/users/david-a-wheeler/repos", "events_url": "https://api.github.com/users/david-a-wheeler/events{/privacy}", "received_events_url": "https://api.github.com/users/david-a-wheeler/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2022-06-10T17:48:02Z", "updated_at": "2022-06-11T18:56:25Z", "closed_at": "2022-06-10T19:01:27Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi, currently Rust builds are not reproducible, at least in part because the full path to the source code is recorded in the produced executable (such as in the panic and debug strings). Could this be fixed so that builds can be much more easily reproduced on other computers?\r\n\r\nHere's the background. One of Rust's general advantages is countering bugs that can lead to security vulnerabilities. However, for security it's very valuable to be able to have [reproducible builds](https://reproducible-builds.org/). With reproducible builds, others can verify that rebuilding on a different computer with the same tools will produce the same result, countering subverted and malicious builds. This is not an idle concern; the attack on SolarWinds Orion, which got a lot of press, was due to a subverted build environment.\r\n\r\n[Rust: A Critical Retrospective](https://www.bunniestudios.com/blog/?p=6375) has nice things to say about Rust, but it also notes some current problems with its implementation. One of the problems with Rust it reports is that \"builds are not reproducible between different computers... I think this is primarily because Rust pulls in the full path to the source code as part of the panic and debug strings that are built into the binary.\"\r\n\r\nThis problem is easily verified. E.g., I used this code in `src/main.rs``:\r\n\r\n```rust\r\nfn demo() {\r\n}\r\nfn main() {\r\n    println!(\"Hello, cruel world!\");\r\n    demo();\r\n}\r\n```\r\n\r\n... and on MacOS ran:\r\n\r\n~~~~\r\ncargo build --release\r\nstrings target/release/hello_cargo | grep /Users\r\n~~~~\r\n\r\nNote: On MacOS, \"/Users\" is equivalent to \"/home\" on most Linux/Unix systems.\r\n\r\nI expected an empty result (no lines produced), because full paths (such as /User, /usr/, /home, /bin, etc.) shouldn't be in the generated executable.\r\n\r\nInstead of the expected empty list, I received this long list:\r\n\r\n~~~~\r\n/rustc/7eac88abb2e57e752f3302f02be5f3ce3d7adfb4/library/alloc/src/vec.rs/rustc/7eac88abb2e57e752f3302f02be5f3ce3d7adfb4/library/alloc/src/slice.rs/Users/runner/.cargo/registry/src/github.com-1ecc6299db9ec823/gimli-0.22.0/src/read/line.rs\r\n/Users/runner/.cargo/registry/src/github.com-1ecc6299db9ec823/addr2line-0.13.0/src/lib.rsAccessError\r\n right: ``/Users/runner/.cargo/registry/src/github.com-1ecc6299db9ec823/gimli-0.22.0/src/read/abbrev.rs()/rustc/7eac88abb2e57e752f3302f02be5f3ce3d7adfb4/library/core/src/str/pattern.rscalled `Option::unwrap()` on a `None` valuecalled `Result::unwrap()` on an `Err` value_ZN/Users/runner/.cargo/registry/src/github.com-1ecc6299db9ec823/rustc-demangle-0.1.16/src/legacy.rsZN::_$.SP@BP*RF&LT<GT>LP(RP)C,_R/Users/runner/.cargo/registry/src/github.com-1ecc6299db9ec823/rustc-demangle-0.1.16/src/v0.rsR__Rpunycode{-}..._!f64f32usizeu64u32u16u8isizei64i32i16i8str\r\n'?, > ::{closure:#[] + ; const  unsafe \" fn( = : 0x.llvm./Users/runner/.cargo/registry/src/github.com-1ecc6299db9ec823/rustc-demangle-0.1.16/src/lib.rs\r\n~~~~\r\nThis is with `rustc --version --verbose`:\r\n\r\n~~~~\r\nrustc 1.48.0 (7eac88abb 2020-11-16)\r\nbinary: rustc\r\ncommit-hash: 7eac88abb2e57e752f3302f02be5f3ce3d7adfb4\r\ncommit-date: 2020-11-16\r\nhost: x86_64-apple-darwin\r\nrelease: 1.48.0\r\nLLVM version: 11.0\r\n~~~~\r\n\r\nThank you!", "closed_by": {"login": "nagisa", "id": 679122, "node_id": "MDQ6VXNlcjY3OTEyMg==", "avatar_url": "https://avatars.githubusercontent.com/u/679122?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nagisa", "html_url": "https://github.com/nagisa", "followers_url": "https://api.github.com/users/nagisa/followers", "following_url": "https://api.github.com/users/nagisa/following{/other_user}", "gists_url": "https://api.github.com/users/nagisa/gists{/gist_id}", "starred_url": "https://api.github.com/users/nagisa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nagisa/subscriptions", "organizations_url": "https://api.github.com/users/nagisa/orgs", "repos_url": "https://api.github.com/users/nagisa/repos", "events_url": "https://api.github.com/users/nagisa/events{/privacy}", "received_events_url": "https://api.github.com/users/nagisa/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/97955/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/97955/timeline", "performed_via_github_app": null, "state_reason": "completed"}