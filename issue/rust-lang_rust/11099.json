{"url": "https://api.github.com/repos/rust-lang/rust/issues/11099", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/11099/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/11099/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/11099/events", "html_url": "https://github.com/rust-lang/rust/issues/11099", "id": 24660865, "node_id": "MDU6SXNzdWUyNDY2MDg2NQ==", "number": 11099, "title": "rustpkg doesn't install to the correct location", "user": {"login": "eminence", "id": 402454, "node_id": "MDQ6VXNlcjQwMjQ1NA==", "avatar_url": "https://avatars.githubusercontent.com/u/402454?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eminence", "html_url": "https://github.com/eminence", "followers_url": "https://api.github.com/users/eminence/followers", "following_url": "https://api.github.com/users/eminence/following{/other_user}", "gists_url": "https://api.github.com/users/eminence/gists{/gist_id}", "starred_url": "https://api.github.com/users/eminence/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eminence/subscriptions", "organizations_url": "https://api.github.com/users/eminence/orgs", "repos_url": "https://api.github.com/users/eminence/repos", "events_url": "https://api.github.com/users/eminence/events{/privacy}", "received_events_url": "https://api.github.com/users/eminence/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2013-12-21T06:05:36Z", "updated_at": "2014-02-13T19:03:38Z", "closed_at": "2014-02-13T19:03:38Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "The [rustpkg manual](http://static.rust-lang.org/doc/master/rustpkg.html) has the following statement:\n\n> `rustpkg install foo` builds the libraries and/or executables that are targets for `foo`. If `RUST_PATH` is declared as an environment variable, then rustpkg installs the libraries and executables into the `lib` and `bin` subdirectories of the first entry in `RUST_PATH`.\n\nI am finding that this is not the case.  See the following reproduction:\n\n```\n$ mkdir -p ~/devel/MyLib/src/MyLib\n```\n\n```\n$ vim ~/devel/MyLib/src/MyLib/{test,lib}.rs\n$ cat ~/devel/MyLib/src/MyLib/lib.rs\n#[crate_type=\"lib\"];\n#[crate_id=\"MyLib#0.2\"];\n\npub mod MyMod {\n    pub fn hello() -> ~str { ~\"world\" }\n}\n```\n\n```\n$ cat ~/devel/MyLib/src/MyLib/test.rs \nextern mod MyLib;\nuse MyLib::MyMod;\n\n#[test]\nfn test1() {\n    MyMod::hello();\n}\n```\n\n```\n$ mkdir -p ~/devel/MyProject\n$ cd ~/devel/MyProject\n```\n\n```\n$ env RUST_PATH=~/devel/MyProject:~/devel/MyLib ~/devel/rust-git/prefix/bin/rustpkg install MyLib\nWARNING: The Rust package manager is experimental and may be unstable\nnote: Installed package MyLib-0.0 to /Users/achin/devel/MyLib\nnote: Installed package MyLib-0.0 to /Users/achin/devel/MyProject\n```\n\n```\n$ find ~/devel/MyLib/\n/Users/achin/devel/MyLib/\n/Users/achin/devel/MyLib//bin\n/Users/achin/devel/MyLib//build\n/Users/achin/devel/MyLib//build/x86_64-apple-darwin\n/Users/achin/devel/MyLib//build/x86_64-apple-darwin/MyLib\n/Users/achin/devel/MyLib//build/x86_64-apple-darwin/MyLib/libMyLib-e6b6b1b1-0.2.dylib\n/Users/achin/devel/MyLib//build/x86_64-apple-darwin/MyLib/MyLibtest\n/Users/achin/devel/MyLib//lib\n/Users/achin/devel/MyLib//lib/x86_64-apple-darwin\n/Users/achin/devel/MyLib//lib/x86_64-apple-darwin/libMyLib-e6b6b1b1-0.2.dylib\n/Users/achin/devel/MyLib//src\n/Users/achin/devel/MyLib//src/MyLib\n/Users/achin/devel/MyLib//src/MyLib/lib.rs\n/Users/achin/devel/MyLib//src/MyLib/test.rs\n```\n\n```\n$ find ~/devel/MyProject/\n/Users/achin/devel/MyProject/\n/Users/achin/devel/MyProject//bin\n/Users/achin/devel/MyProject//lib\n/Users/achin/devel/MyProject//lib/x86_64-apple-darwin\n/Users/achin/devel/MyProject//rustpkg_db.json\n```\n\n```\n$ ~/devel/rust-git/prefix/bin/rustpkg --version\nWARNING: The Rust package manager is experimental and may be unstable\n/Users/achin/devel/rust-git/prefix/bin/rustpkg 0.9-pre (5c24bfa 2013-12-19 17:11:40 -0800)\nhost: x86_64-apple-darwin\n```\n\n**Note** the test.rs file seems to be affecting the rustpkg behavior:\n\n```\n$ rm ~/devel/MyLib/src/MyLib/test.rs \n$ rm rustpkg_db.json\n$ env RUST_PATH=~/devel/MyProject:~/devel/MyLib ~/devel/rust-git/prefix/bin/rustpkg install MyLib\nWARNING: The Rust package manager is experimental and may be unstable\nnote: Installed package MyLib-0.0 to /Users/achin/devel/MyProject\n\n$ find ~/devel/MyProject/\n/Users/achin/devel/MyProject/\n/Users/achin/devel/MyProject//bin\n/Users/achin/devel/MyProject//lib\n/Users/achin/devel/MyProject//lib/x86_64-apple-darwin\n/Users/achin/devel/MyProject//lib/x86_64-apple-darwin/libMyLib-e6b6b1b1-0.2.dylib\n/Users/achin/devel/MyProject//rustpkg_db.json\n```\n\ncc: @catamorphism\n", "closed_by": {"login": "flaper87", "id": 13816, "node_id": "MDQ6VXNlcjEzODE2", "avatar_url": "https://avatars.githubusercontent.com/u/13816?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flaper87", "html_url": "https://github.com/flaper87", "followers_url": "https://api.github.com/users/flaper87/followers", "following_url": "https://api.github.com/users/flaper87/following{/other_user}", "gists_url": "https://api.github.com/users/flaper87/gists{/gist_id}", "starred_url": "https://api.github.com/users/flaper87/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flaper87/subscriptions", "organizations_url": "https://api.github.com/users/flaper87/orgs", "repos_url": "https://api.github.com/users/flaper87/repos", "events_url": "https://api.github.com/users/flaper87/events{/privacy}", "received_events_url": "https://api.github.com/users/flaper87/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/11099/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/11099/timeline", "performed_via_github_app": null, "state_reason": "completed"}