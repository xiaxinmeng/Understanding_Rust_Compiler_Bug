{"url": "https://api.github.com/repos/rust-lang/rust/issues/100513", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/100513/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/100513/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/100513/events", "html_url": "https://github.com/rust-lang/rust/issues/100513", "id": 1338064886, "node_id": "I_kwDOAAsO6M5PwT_2", "number": 100513, "title": "let_chains desugaring is wrong", "user": {"login": "Nilstrieb", "id": 48135649, "node_id": "MDQ6VXNlcjQ4MTM1NjQ5", "avatar_url": "https://avatars.githubusercontent.com/u/48135649?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Nilstrieb", "html_url": "https://github.com/Nilstrieb", "followers_url": "https://api.github.com/users/Nilstrieb/followers", "following_url": "https://api.github.com/users/Nilstrieb/following{/other_user}", "gists_url": "https://api.github.com/users/Nilstrieb/gists{/gist_id}", "starred_url": "https://api.github.com/users/Nilstrieb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Nilstrieb/subscriptions", "organizations_url": "https://api.github.com/users/Nilstrieb/orgs", "repos_url": "https://api.github.com/users/Nilstrieb/repos", "events_url": "https://api.github.com/users/Nilstrieb/events{/privacy}", "received_events_url": "https://api.github.com/users/Nilstrieb/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "closed", "locked": false, "assignee": {"login": "nathanwhit", "id": 17734409, "node_id": "MDQ6VXNlcjE3NzM0NDA5", "avatar_url": "https://avatars.githubusercontent.com/u/17734409?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nathanwhit", "html_url": "https://github.com/nathanwhit", "followers_url": "https://api.github.com/users/nathanwhit/followers", "following_url": "https://api.github.com/users/nathanwhit/following{/other_user}", "gists_url": "https://api.github.com/users/nathanwhit/gists{/gist_id}", "starred_url": "https://api.github.com/users/nathanwhit/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nathanwhit/subscriptions", "organizations_url": "https://api.github.com/users/nathanwhit/orgs", "repos_url": "https://api.github.com/users/nathanwhit/repos", "events_url": "https://api.github.com/users/nathanwhit/events{/privacy}", "received_events_url": "https://api.github.com/users/nathanwhit/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "nathanwhit", "id": 17734409, "node_id": "MDQ6VXNlcjE3NzM0NDA5", "avatar_url": "https://avatars.githubusercontent.com/u/17734409?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nathanwhit", "html_url": "https://github.com/nathanwhit", "followers_url": "https://api.github.com/users/nathanwhit/followers", "following_url": "https://api.github.com/users/nathanwhit/following{/other_user}", "gists_url": "https://api.github.com/users/nathanwhit/gists{/gist_id}", "starred_url": "https://api.github.com/users/nathanwhit/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nathanwhit/subscriptions", "organizations_url": "https://api.github.com/users/nathanwhit/orgs", "repos_url": "https://api.github.com/users/nathanwhit/repos", "events_url": "https://api.github.com/users/nathanwhit/events{/privacy}", "received_events_url": "https://api.github.com/users/nathanwhit/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 21, "created_at": "2022-08-13T21:54:34Z", "updated_at": "2022-10-21T08:41:48Z", "closed_at": "2022-10-15T13:30:27Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "I tried this code: [playground](https://play.rust-lang.org/?version=beta&mode=debug&edition=2021&gist=c1ff3da556b18b34f63727a9db54540f)\n\n```rust\nstruct LoudDrop(&'static str);\n\nimpl Drop for LoudDrop {\n    fn drop(&mut self) {\n        println!(\"Dropped! {}\", self.0);\n    }\n}\n\nfn get_drop(str: &'static str) -> Option<LoudDrop> {\n    Some(LoudDrop(str))\n}\n\nfn main() {\n    println!(\"1\");\n    if get_drop(\"first\").is_some() && get_drop(\"1.5\").is_some() && let None = get_drop(\"last\") {\n        println!(\"2\");\n    } else {\n        println!(\"2\");\n    }\n    println!(\"3\");\n}\n```\n\nThis prints\n```\n1\nDropped! 1.5\nDropped! last\n2\nDropped! first\n3\n```\n\nAccording to [RFC 2497](https://rust-lang.github.io/rfcs/2497-if-let-chains.html), it should desugar to this: [playground](https://play.rust-lang.org/?version=beta&mode=debug&edition=2021&gist=314b080d0eb54cd4561cdd6bfc7dada7)\n```rust\nfn main() {\n    println!(\"1\");\n    'FRESH_LABEL: {\n        if get_drop(\"first\").is_some() {\n            if get_drop(\"1.5\").is_some() {\n                if let None = get_drop(\"last\") {\n                    break 'FRESH_LABEL { println!(\"2\") }\n                }\n            }\n        }\n        { println!(\"2\") }\n    }\n    println!(\"3\");\n}\n```\nBut this prints\n```\n1\nDropped! first\nDropped! 1.5\nDropped! last\n2\n3\n```\n\n### Meta\nWrong on the current beta\n```\n1.64.0-beta.1\n\n(2022-08-09 56714e5332f5f21c39d7)\n```\n\n\n\n<!-- TRIAGEBOT_START -->\n\n<!-- TRIAGEBOT_ASSIGN_START -->\n\n<!-- TRIAGEBOT_ASSIGN_DATA_START$${\"user\":\"nathanwhit\"}$$TRIAGEBOT_ASSIGN_DATA_END -->\n\n<!-- TRIAGEBOT_ASSIGN_END -->\n<!-- TRIAGEBOT_END -->", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/100513/reactions", "total_count": 76, "+1": 19, "-1": 0, "laugh": 0, "hooray": 0, "confused": 22, "heart": 0, "rocket": 0, "eyes": 35}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/100513/timeline", "performed_via_github_app": null, "state_reason": "completed"}