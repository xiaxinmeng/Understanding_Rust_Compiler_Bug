{"url": "https://api.github.com/repos/rust-lang/rust/issues/51447", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/51447/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/51447/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/51447/events", "html_url": "https://github.com/rust-lang/rust/issues/51447", "id": 330825464, "node_id": "MDU6SXNzdWUzMzA4MjU0NjQ=", "number": 51447, "title": "Issue with E0381 and using a boolean to track initialization", "user": {"login": "mtreinish", "id": 2447371, "node_id": "MDQ6VXNlcjI0NDczNzE=", "avatar_url": "https://avatars.githubusercontent.com/u/2447371?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mtreinish", "html_url": "https://github.com/mtreinish", "followers_url": "https://api.github.com/users/mtreinish/followers", "following_url": "https://api.github.com/users/mtreinish/following{/other_user}", "gists_url": "https://api.github.com/users/mtreinish/gists{/gist_id}", "starred_url": "https://api.github.com/users/mtreinish/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mtreinish/subscriptions", "organizations_url": "https://api.github.com/users/mtreinish/orgs", "repos_url": "https://api.github.com/users/mtreinish/repos", "events_url": "https://api.github.com/users/mtreinish/events{/privacy}", "received_events_url": "https://api.github.com/users/mtreinish/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2018-06-08T22:58:42Z", "updated_at": "2018-06-09T03:04:52Z", "closed_at": "2018-06-09T03:04:52Z", "author_association": "NONE", "active_lock_reason": null, "body": "When declaring a variable outside of a for loop and tracking whether it's set with a boolean and only accessing that inside an if block isn't track properly and will raise an E0381 uninitialized variable even though the variable will also have an assigned variable when it's accessed. I came up with a small reproduce case here:\r\n\r\n```\r\nfn main() {\r\n    let mut time;\r\n    let mut time_found = false;\r\n    for i in 1..10 {\r\n        if i == 1 {\r\n            time_found = true;\r\n            time = i;\r\n        }\r\n    }\r\n    if time_found {\r\n        let a = time + 1;\r\n    }\r\n}\r\n```\r\n\r\nWill not build because of E0381 on the `let a = time + 1;` line. However, because time is only being used inside the if block it will always have a defined value it's never going to be uninitialized there. \r\n\r\nWhile this synthetic case doesn't make much sense in the real world, I'm hitting this in a more complex example where using a boolean to track the the state of having the value defined for a variable like this was the only way I could think to ensure the value was always set. Especially because I can't come up with a sane value to initialize for the type of this variable.\r\n\r\nI'm new to rust so I'm not sure if there is something obvious I'm missing here, but this seems like a bug in that the compiler isn't able to track this case properly.\r\n\r\n## Meta\r\n\r\n`rustc --version --verbose`:\r\nrustc 1.26.2\r\nbinary: rustc\r\ncommit-hash: unknown\r\ncommit-date: unknown\r\nhost: x86_64-unknown-linux-gnu\r\nrelease: 1.26.2\r\nLLVM version: 6.0\r\n", "closed_by": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/51447/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/51447/timeline", "performed_via_github_app": null, "state_reason": "completed"}