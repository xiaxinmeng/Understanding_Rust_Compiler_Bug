{"url": "https://api.github.com/repos/rust-lang/rust/issues/98948", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/98948/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/98948/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/98948/events", "html_url": "https://github.com/rust-lang/rust/issues/98948", "id": 1294587730, "node_id": "I_kwDOAAsO6M5NKddS", "number": 98948, "title": "Non-descriptive error when building something which requires alloc on a platform which doesn't have it", "user": {"login": "JarredAllen", "id": 19656507, "node_id": "MDQ6VXNlcjE5NjU2NTA3", "avatar_url": "https://avatars.githubusercontent.com/u/19656507?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JarredAllen", "html_url": "https://github.com/JarredAllen", "followers_url": "https://api.github.com/users/JarredAllen/followers", "following_url": "https://api.github.com/users/JarredAllen/following{/other_user}", "gists_url": "https://api.github.com/users/JarredAllen/gists{/gist_id}", "starred_url": "https://api.github.com/users/JarredAllen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JarredAllen/subscriptions", "organizations_url": "https://api.github.com/users/JarredAllen/orgs", "repos_url": "https://api.github.com/users/JarredAllen/repos", "events_url": "https://api.github.com/users/JarredAllen/events{/privacy}", "received_events_url": "https://api.github.com/users/JarredAllen/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 235791, "node_id": "MDU6TGFiZWwyMzU3OTE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-diagnostics", "name": "A-diagnostics", "color": "f7e101", "default": false, "description": "Area: Messages for errors, warnings, and lints"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2022-07-05T17:45:12Z", "updated_at": "2022-07-05T17:45:12Z", "closed_at": null, "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!--\r\nThank you for filing a bug report! \ud83d\udc1b Please provide a short summary of the bug,\r\nalong with any information you feel relevant to replicating the bug.\r\n\r\nIf you cannot produce a minimal reproduction case (something that would work in\r\nisolation), please provide the steps or even link to a repository that causes\r\nthe problematic output to occur.\r\n-->\r\n\r\nWhen building a crate which requires alloc for a target which doesn't have alloc, the resulting error message just says that the build requires alloc and alloc isn't found/linked.\r\n\r\nThe current output is:\r\n\r\n```\r\nerror: no global memory allocator found but one is required; link to std or add `#[global_allocator]` to a static item that implements the GlobalAlloc trait\r\n\r\nerror: `#[alloc_error_handler]` function required, but not found\r\n```\r\n\r\n<!-- The following is not always necessary. -->\r\nThis is less than helpful in the case where the dependency on alloc is coming from a dependency, as it does not help pin down where it comes from. In this case, ideally the output should look something like this:\r\n\r\n```\r\nerror: no global memory allocator found but one is required; link to std or add `#[global_allocator]` to a static item that implements the GlobalAlloc trait\r\n\r\nhint: use of the memory allocator is coming from the following dependencies:\r\n...\r\n\r\nerror: `#[alloc_error_handler]` function required, but not found\r\n```\r\n\r\nThis would help the user know which crate(s) are causing the problem, as opposed to having to search through the dependencies manually (which is made easier by using `cargo vendor` to download your dependencies in one place and then `ripgrep` to search for uses of alloc, but that requires knowing those tools and doing extta work).\r\n\r\n<!--\r\nIf dramatically different output is caused by small changes, consider also\r\nadding them here.\r\n\r\nIf you're using the stable version of the compiler, you should also check if the\r\nbug also exists in the beta or nightly versions. The output might also be\r\ndifferent depending on the Edition.\r\n-->\r\n", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/98948/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/98948/timeline", "performed_via_github_app": null, "state_reason": null}