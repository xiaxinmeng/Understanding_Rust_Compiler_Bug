{"url": "https://api.github.com/repos/rust-lang/rust/issues/8372", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/8372/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/8372/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/8372/events", "html_url": "https://github.com/rust-lang/rust/issues/8372", "id": 17751869, "node_id": "MDU6SXNzdWUxNzc1MTg2OQ==", "number": 8372, "title": "Have `for pattern in iter` not borrow the iterator", "user": {"login": "SimonSapin", "id": 291359, "node_id": "MDQ6VXNlcjI5MTM1OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/291359?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SimonSapin", "html_url": "https://github.com/SimonSapin", "followers_url": "https://api.github.com/users/SimonSapin/followers", "following_url": "https://api.github.com/users/SimonSapin/following{/other_user}", "gists_url": "https://api.github.com/users/SimonSapin/gists{/gist_id}", "starred_url": "https://api.github.com/users/SimonSapin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SimonSapin/subscriptions", "organizations_url": "https://api.github.com/users/SimonSapin/orgs", "repos_url": "https://api.github.com/users/SimonSapin/repos", "events_url": "https://api.github.com/users/SimonSapin/events{/privacy}", "received_events_url": "https://api.github.com/users/SimonSapin/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 60329014, "node_id": "MDU6TGFiZWw2MDMyOTAxNA==", "url": "https://api.github.com/repos/rust-lang/rust/labels/P-low", "name": "P-low", "color": "eb6420", "default": false, "description": "Low priority"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 36, "created_at": "2013-08-07T14:44:40Z", "updated_at": "2015-01-31T13:49:00Z", "closed_at": "2015-01-31T13:48:54Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Test case:\n\n```\nlet mut iter = range(1, 10);\nfor i in iter {\n    printfln!(i);\n    // error: cannot borrow `iter` as mutable more than once at a time\n    printfln!(iter.next());\n}\n```\n\nThe above currently fails, but I think it should be valid and equivalent to:\n\n```\nlet mut iter = range(1, 10);\nloop { match iter.next() { None => break, Some(i) => {\n    printfln!(i);\n    printfln!(iter.next());\n}}\n```\n\nIn other words, the for loop should only borrow the iterator long enough to call `next()`, leaving the loop body free to use it.\n\nI understand that this might not be possible when a more complex expression is used as the iterator. The for loop needs to evaluate the expression once and keep the result in an anonymous variable, thus borrowing. Maybe there could be a special case when the iterator expression is \"simple\" enough: a variable, struct field access, etc?\n", "closed_by": {"login": "SimonSapin", "id": 291359, "node_id": "MDQ6VXNlcjI5MTM1OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/291359?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SimonSapin", "html_url": "https://github.com/SimonSapin", "followers_url": "https://api.github.com/users/SimonSapin/followers", "following_url": "https://api.github.com/users/SimonSapin/following{/other_user}", "gists_url": "https://api.github.com/users/SimonSapin/gists{/gist_id}", "starred_url": "https://api.github.com/users/SimonSapin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SimonSapin/subscriptions", "organizations_url": "https://api.github.com/users/SimonSapin/orgs", "repos_url": "https://api.github.com/users/SimonSapin/repos", "events_url": "https://api.github.com/users/SimonSapin/events{/privacy}", "received_events_url": "https://api.github.com/users/SimonSapin/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/8372/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/8372/timeline", "performed_via_github_app": null, "state_reason": "completed"}