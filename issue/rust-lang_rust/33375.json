{"url": "https://api.github.com/repos/rust-lang/rust/issues/33375", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/33375/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/33375/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/33375/events", "html_url": "https://github.com/rust-lang/rust/issues/33375", "id": 152773135, "node_id": "MDU6SXNzdWUxNTI3NzMxMzU=", "number": 33375, "title": "Non trait object safe return diagnostic needs improvement", "user": {"login": "hythloday", "id": 933087, "node_id": "MDQ6VXNlcjkzMzA4Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/933087?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hythloday", "html_url": "https://github.com/hythloday", "followers_url": "https://api.github.com/users/hythloday/followers", "following_url": "https://api.github.com/users/hythloday/following{/other_user}", "gists_url": "https://api.github.com/users/hythloday/gists{/gist_id}", "starred_url": "https://api.github.com/users/hythloday/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hythloday/subscriptions", "organizations_url": "https://api.github.com/users/hythloday/orgs", "repos_url": "https://api.github.com/users/hythloday/repos", "events_url": "https://api.github.com/users/hythloday/events{/privacy}", "received_events_url": "https://api.github.com/users/hythloday/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 234902, "node_id": "MDU6TGFiZWwyMzQ5MDI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-enhancement", "name": "C-enhancement", "color": "f5f1fd", "default": false, "description": "Category: An issue proposing an enhancement or a PR with one."}, {"id": 235791, "node_id": "MDU6TGFiZWwyMzU3OTE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-diagnostics", "name": "A-diagnostics", "color": "f7e101", "default": false, "description": "Area: Messages for errors, warnings, and lints"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 1596122130, "node_id": "MDU6TGFiZWwxNTk2MTIyMTMw", "url": "https://api.github.com/repos/rust-lang/rust/labels/D-papercut", "name": "D-papercut", "color": "c9f7a3", "default": false, "description": "Diagnostic error that needs small tweaks"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2016-05-03T13:27:17Z", "updated_at": "2020-02-04T20:30:51Z", "closed_at": "2020-02-04T20:30:51Z", "author_association": "NONE", "active_lock_reason": null, "body": "Here's some illegal code that generates a very reasonable error message:\n\n```\ntrait Foo {\n  fn apply() -> i64;\n}\n\nstruct Baz{}\nstatic BAZ: Baz = Baz{};\nimpl Foo for Baz {\n    fn apply(&self) -> i64 { 4 }\n}\n\n// <anon>:8:5: 8:33 error: method `apply` has a `&self` declaration in the impl, but not in the trait [E0185]\n\n```\n\nAdding a function that references this broken trait changes the error message and is imho quite misleading:\n\n```\nfn lookup() -> Box<&'static Foo> {\n    Box::new(&BAZ)\n}\n\n<anon>:11:1: 13:2 error: the trait `Foo` cannot be made into an object [E0038]\n<anon>:11 fn lookup() -> Box<&'static Foo> {\n<anon>:12     Box::new(&BAZ)\n<anon>:13 }\n<anon>:11:1: 13:2 help: see the detailed explanation for E0038\n<anon>:11:1: 13:2 note: method `apply` has no receiver\n```\n\nThe error code has changed from something that pinpoints exactly where I went wrong to something unrelated with advice that won't help me see my problem, and highlights the wrong place (the function that's returning this trait rather than the trait itself). Ideally the error message wouldn't change at all.\n\n```\nrustc 1.10.0-nightly (8da2bcac5 2016-04-28)\nbinary: rustc\ncommit-hash: 8da2bcac5db1e091b90cceb19d0496f0f7501c88\ncommit-date: 2016-04-28\nhost: x86_64-apple-darwin\nrelease: 1.10.0-nightly\n```\n\n(happens on stable and beta too)\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/33375/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/33375/timeline", "performed_via_github_app": null, "state_reason": "completed"}