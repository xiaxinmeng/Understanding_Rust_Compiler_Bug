{"url": "https://api.github.com/repos/rust-lang/rust/issues/112214", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/112214/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/112214/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/112214/events", "html_url": "https://github.com/rust-lang/rust/issues/112214", "id": 1738489588, "node_id": "I_kwDOAAsO6M5nnz70", "number": 112214, "title": "`cargo doc` panic on Polkadot v0.9.38", "user": {"login": "mattheworris", "id": 1466844, "node_id": "MDQ6VXNlcjE0NjY4NDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1466844?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mattheworris", "html_url": "https://github.com/mattheworris", "followers_url": "https://api.github.com/users/mattheworris/followers", "following_url": "https://api.github.com/users/mattheworris/following{/other_user}", "gists_url": "https://api.github.com/users/mattheworris/gists{/gist_id}", "starred_url": "https://api.github.com/users/mattheworris/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mattheworris/subscriptions", "organizations_url": "https://api.github.com/users/mattheworris/orgs", "repos_url": "https://api.github.com/users/mattheworris/repos", "events_url": "https://api.github.com/users/mattheworris/events{/privacy}", "received_events_url": "https://api.github.com/users/mattheworris/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2023-06-02T16:31:04Z", "updated_at": "2023-06-04T23:39:11Z", "closed_at": "2023-06-02T17:34:26Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!--\r\nThank you for filing a bug report! \ud83d\udc1b Please provide a short summary of the bug,\r\nalong with any information you feel relevant to replicating the bug.\r\n-->\r\n\r\nUpgrading Frequency.xyz (https://github.com/LibertyDSNP/frequency/tree/polkadot-0938-upgrade) to Polkadot v0.9.38 caused our `cargo doc` to fail because rustc panicked.\r\n\r\nThis is the command that causes the panic:\r\n`RUSTDOCFLAGS=\"--enable-index-page --check -Zunstable-options\" cargo doc --no-deps --features frequency`\r\n\r\nI expected to see this happen: `cargo doc` to successfully complete.\r\n\r\nInstead, this happened: `cargo doc` panicked.\r\n\r\n### Meta\r\n<!--\r\nIf you're using the stable version of the compiler, you should also check if the\r\nbug also exists in the beta or nightly versions.\r\n-->\r\n\r\n`rustc --version --verbose`:\r\n```\r\nrustc 1.67.0-nightly (96ddd32c4 2022-11-14)\r\nbinary: rustc\r\ncommit-hash: 96ddd32c4bfb1d78f0cd03eb068b1710a8cebeef\r\ncommit-date: 2022-11-14\r\nhost: aarch64-apple-darwin\r\nrelease: 1.67.0-nightly\r\nLLVM version: 15.0.4\r\n```\r\n\r\n<!--\r\nInclude a backtrace in the code block by setting `RUST_BACKTRACE=1` in your\r\nenvironment. E.g. `RUST_BACKTRACE=1 cargo build`.\r\n-->\r\n<details><summary>Backtrace</summary>\r\n<p>\r\n\r\n```\r\n\r\nthread 'rustc' panicked at 'no entry found for key', src/librustdoc/passes/collect_intra_doc_links.rs:782:16\r\nstack backtrace:\r\n0: 0x105c6ec54 - <std::sys_common::backtrace::_print::DisplayBacktrace as core::fmt::Display>::fmt::h05fe749630fb84b2\r\n1: 0x105cc0308 - core::fmt::write::h56044356168713ba\r\n2: 0x105c61c7c - std::io::Write::write_fmt::h3d9d452c064ba6ce\r\n3: 0x105c6ea68 - std::sys_common::backtrace::print::h81a1d22b45459df7\r\n4: 0x105c71510 - std::panicking::default_hook::{{closure}}::h7b8c781baeb88c58\r\n5: 0x105c71268 - std::panicking::default_hook::ha6ccbf40949f92a7\r\n6: 0x10dc6ae3c - rustc_driver[430a680fc88a5df1]::DEFAULT_HOOK::{closure#0}::{closure#0}\r\n7: 0x105c71c10 - std::panicking::rust_panic_with_hook::h705114c6359d32c5\r\n8: 0x105c71a08 - std::panicking::begin_panic_handler::{{closure}}::h29fe5f1cfa68c1a6\r\n9: 0x105c6f0bc - std::sys_common::backtrace::__rust_end_short_backtrace::h99c66c40f43a73b4\r\n10: 0x105c7175c - _rust_begin_unwind\r\n11: 0x105cebef8 - core::panicking::panic_fmt::h984f8f19a87290dd\r\n12: 0x105cbd588 - core::panicking::panic_display::hab522972d10c42f6\r\n13: 0x105cbd54c - core::panicking::panic_str::h879d7a8b16cf2918\r\n14: 0x105cebec4 - core::option::expect_failed::h963b8297cebb38d4\r\n15: 0x1049ee214 - rustdoc[2b0e45de692993a]::passes::collect_intra_doc_links::resolve_associated_trait_item\r\n16: 0x1049ed348 - <rustdoc[2b0e45de692993a]::passes::collect_intra_doc_links::LinkCollector>::resolve_associated_item\r\n17: 0x1049ec054 - <rustdoc[2b0e45de692993a]::passes::collect_intra_doc_links::LinkCollector>::resolve\r\n18: 0x1049ef940 - <rustdoc[2b0e45de692993a]::passes::collect_intra_doc_links::LinkCollector as rustdoc[2b0e45de692993a]::visit::DocVisitor>::visit_item\r\n19: 0x1049eac70 - rustdoc[2b0e45de692993a]::passes::collect_intra_doc_links::collect_intra_doc_links\r\n20: 0x104a22e24 - <rustc_session[80e440121b2ed8b]::session::Session>::time::<rustdoc[2b0e45de692993a]::clean::types::Crate, rustdoc[2b0e45de692993a]::core::run_global_ctxt::{closure#7}>\r\n21: 0x1049d3d88 - rustdoc[2b0e45de692993a]::core::run_global_ctxt\r\n22: 0x104a231b0 - <rustc_session[80e440121b2ed8b]::session::Session>::time::<(rustdoc[2b0e45de692993a]::clean::types::Crate, rustdoc[2b0e45de692993a]::config::RenderOptions, rustdoc[2b0e45de692993a]::formats::cache::Cache), rustdoc[2b0e45de692993a]::main_args::{closure#1}::{closure#0}::{closure#1}::{closure#0}>\r\n23: 0x104a79c1c - <rustc_interface[b18b68b4c454af3d]::passes::QueryContext>::enter::<rustdoc[2b0e45de692993a]::main_args::{closure#1}::{closure#0}::{closure#1}, core[5c9e9337aa2c35a6]::result::Result<(), rustc_errors[2faad687c8ae036a]::ErrorGuaranteed>>\r\n24: 0x10491eba4 - <rustc_interface[b18b68b4c454af3d]::interface::Compiler>::enter::<rustdoc[2b0e45de692993a]::main_args::{closure#1}::{closure#0}, core[5c9e9337aa2c35a6]::result::Result<(), rustc_errors[2faad687c8ae036a]::ErrorGuaranteed>>\r\n25: 0x1049b97d0 - std[105242c46289980]::sys_common::backtrace::_rust_begin_short_backtrace::<rustc_interface[b18b68b4c454af3d]::util::run_in_thread_pool_with_globals<rustc_interface[b18b68b4c454af3d]::interface::run_compiler<core[5c9e9337aa2c35a6]::result::Result<(), rustc_errors[2faad687c8ae036a]::ErrorGuaranteed>, rustdoc[2b0e45de692993a]::main_args::{closure#1}>::{closure#0}, core[5c9e9337aa2c35a6]::result::Result<(), rustc_errors[2faad687c8ae036a]::ErrorGuaranteed>>::{closure#0}::{closure#0}, core[5c9e9337aa2c35a6]::result::Result<(), rustc_errors[2faad687c8ae036a]::ErrorGuaranteed>>\r\n26: 0x104ae4630 - <<std[105242c46289980]:\ud83e\uddf5:Builder>::spawn_unchecked<rustc_interface[b18b68b4c454af3d]::util::run_in_thread_pool_with_globals<rustc_interface[b18b68b4c454af3d]::interface::run_compiler<core[5c9e9337aa2c35a6]::result::Result<(), rustc_errors[2faad687c8ae036a]::ErrorGuaranteed>, rustdoc[2b0e45de692993a]::main_args::{closure#1}>::{closure#0}, core[5c9e9337aa2c35a6]::result::Result<(), rustc_errors[2faad687c8ae036a]::ErrorGuaranteed>>::{closure#0}::{closure#0}, core[5c9e9337aa2c35a6]::result::Result<(), rustc_errors[2faad687c8ae036a]::ErrorGuaranteed>>::{closure#1} as core[5c9e9337aa2c35a6]::ops::function::FnOnce<()>>::call_once::{shim:vtable#0}\r\n27: 0x105c79f50 - std::sys::unix:\ud83e\uddf5:Thread:\ud83c\udd95:thread_start::h44a49daaeab56bd1\r\n28: 0x191d1bfa8 - __pthread_joiner_wake\r\n\r\nerror: internal compiler error: unexpected panic\r\n\r\nnote: the compiler unexpectedly panicked. this is a bug.\r\n\r\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/issues/new?labels=C-bug%2C+I-ICE%2C+T-compiler&template=ice.md\r\n\r\nnote: rustc 1.67.0-nightly (96ddd32 2022-11-14) running on aarch64-apple-darwin\r\n\r\nnote: compiler flags: --crate-type lib -Z unstable-options\r\n\r\nnote: some of the compiler flags provided by cargo are hidden\r\n\r\nquery stack during panic:\r\nend of query stack\r\nerror: could not document frequency-runtime\r\n\r\nCaused by:\r\nprocess didn't exit successfully: rustdoc --edition=2021 --crate-type lib --crate-name frequency_runtime runtime/frequency/src/lib.rs -o /Users/mattheworris/projects/frequency-main/target/doc --cfg 'feature=\"default\"' --cfg 'feature=\"frequency\"' --cfg 'feature=\"serde\"' --cfg 'feature=\"std\"' --error-format=json --json=diagnostic-rendered-ansi,artifacts,future-incompat -C metadata=27e22d483cacacb7 -L dependency=/Users/mattheworris/projects/frequency-main/target/debug/deps --extern common_primitives=/Users/mattheworris/projects/frequency-main/target/debug/deps/libcommon_primitives-1679737f1a8d52bf.rmeta --extern common_runtime=/Users/mattheworris/projects/frequency-main/target/debug/deps/libcommon_runtime-93b370dfeb84e588.rmeta --extern cumulus_pallet_aura_ext=/Users/mattheworris/projects/frequency-main/target/debug/deps/libcumulus_pallet_aura_ext-f4dff152c4f06670.rmeta --extern cumulus_pallet_parachain_system=/Users/mattheworris/projects/frequency-main/target/debug/deps/libcumulus_pallet_parachain_system-57f8a9aa9a51d153.rmeta --extern cumulus_pallet_session_benchmarking=/Users/mattheworris/projects/frequency-main/target/debug/deps/libcumulus_pallet_session_benchmarking-a5f40ca571fc69b3.rmeta --extern cumulus_primitives_core=/Users/mattheworris/projects/frequency-main/target/debug/deps/libcumulus_primitives_core-f70e79c583b07b8c.rmeta --extern cumulus_primitives_timestamp=/Users/mattheworris/projects/frequency-main/target/debug/deps/libcumulus_primitives_timestamp-e688e3d2dc0da029.rmeta --extern frame_executive=/Users/mattheworris/projects/frequency-main/target/debug/deps/libframe_executive-0d72be76a13a3a31.rmeta --extern frame_support=/Users/mattheworris/projects/frequency-main/target/debug/deps/libframe_support-c8365936deb7b81e.rmeta --extern frame_system=/Users/mattheworris/projects/frequency-main/target/debug/deps/libframe_system-ad42cb4ea6598e03.rmeta --extern frame_system_rpc_runtime_api=/Users/mattheworris/projects/frequency-main/target/debug/deps/libframe_system_rpc_runtime_api-174fe2d463524b2a.rmeta --extern log=/Users/mattheworris/projects/frequency-main/target/debug/deps/liblog-75c16a66914e162d.rmeta --extern pallet_aura=/Users/mattheworris/projects/frequency-main/target/debug/deps/libpallet_aura-391b061e16e0b1bc.rmeta --extern pallet_authorship=/Users/mattheworris/projects/frequency-main/target/debug/deps/libpallet_authorship-6fb15793c41a14f4.rmeta --extern pallet_balances=/Users/mattheworris/projects/frequency-main/target/debug/deps/libpallet_balances-3d57c86cb5b0e342.rmeta --extern pallet_capacity=/Users/mattheworris/projects/frequency-main/target/debug/deps/libpallet_capacity-9f0928c645d87ef2.rmeta --extern pallet_collator_selection=/Users/mattheworris/projects/frequency-main/target/debug/deps/libpallet_collator_selection-648b3668b59449b9.rmeta --extern pallet_collective=/Users/mattheworris/projects/frequency-main/target/debug/deps/libpallet_collective-b993598556d90522.rmeta --extern pallet_democracy=/Users/mattheworris/projects/frequency-main/target/debug/deps/libpallet_democracy-6e571a8122de6dc0.rmeta --extern pallet_frequency_tx_payment=/Users/mattheworris/projects/frequency-main/target/debug/deps/libpallet_frequency_tx_payment-6f4e8779f57876ff.rmeta --extern pallet_handles=/Users/mattheworris/projects/frequency-main/target/debug/deps/libpallet_handles-292f13640ed416ea.rmeta --extern pallet_handles_runtime_api=/Users/mattheworris/projects/frequency-main/target/debug/deps/libpallet_handles_runtime_api-ad969daf699fbeed.rmeta --extern pallet_messages=/Users/mattheworris/projects/frequency-main/target/debug/deps/libpallet_messages-dbf29d5c303183ce.rmeta --extern pallet_messages_runtime_api=/Users/mattheworris/projects/frequency-main/target/debug/deps/libpallet_messages_runtime_api-e8defeba12911fd1.rmeta --extern pallet_msa=/Users/mattheworris/projects/frequency-main/target/debug/deps/libpallet_msa-ac72344918fde0a6.rmeta --extern pallet_msa_runtime_api=/Users/mattheworris/projects/frequency-main/target/debug/deps/libpallet_msa_runtime_api-4c7e1259c72c4df4.rmeta --extern pallet_multisig=/Users/mattheworris/projects/frequency-main/target/debug/deps/libpallet_multisig-5bbaf95b4f5eab7b.rmeta --extern pallet_preimage=/Users/mattheworris/projects/frequency-main/target/debug/deps/libpallet_preimage-08a7713b96083657.rmeta --extern pallet_scheduler=/Users/mattheworris/projects/frequency-main/target/debug/deps/libpallet_scheduler-d8e7097e984eb2c7.rmeta --extern pallet_schemas=/Users/mattheworris/projects/frequency-main/target/debug/deps/libpallet_schemas-06dbb031709d8e6f.rmeta --extern pallet_schemas_runtime_api=/Users/mattheworris/projects/frequency-main/target/debug/deps/libpallet_schemas_runtime_api-40dc894deff3672e.rmeta --extern pallet_session=/Users/mattheworris/projects/frequency-main/target/debug/deps/libpallet_session-918091a40d160a9a.rmeta --extern pallet_stateful_storage=/Users/mattheworris/projects/frequency-main/target/debug/deps/libpallet_stateful_storage-4fe15977ee30620a.rmeta --extern pallet_stateful_storage_runtime_api=/Users/mattheworris/projects/frequency-main/target/debug/deps/libpallet_stateful_storage_runtime_api-45ca7b7ff73a6571.rmeta --extern pallet_sudo=/Users/mattheworris/projects/frequency-main/target/debug/deps/libpallet_sudo-b80a9d8e00ec7745.rmeta --extern pallet_time_release=/Users/mattheworris/projects/frequency-main/target/debug/deps/libpallet_time_release-e2dffae88a45f2c5.rmeta --extern pallet_timestamp=/Users/mattheworris/projects/frequency-main/target/debug/deps/libpallet_timestamp-1a03d625051d6701.rmeta --extern pallet_transaction_payment=/Users/mattheworris/projects/frequency-main/target/debug/deps/libpallet_transaction_payment-64d695295a82108f.rmeta --extern pallet_transaction_payment_rpc_runtime_api=/Users/mattheworris/projects/frequency-main/target/debug/deps/libpallet_transaction_payment_rpc_runtime_api-67b1b48f87c6a8f6.rmeta --extern pallet_treasury=/Users/mattheworris/projects/frequency-main/target/debug/deps/libpallet_treasury-463e808253fe83b9.rmeta --extern pallet_utility=/Users/mattheworris/projects/frequency-main/target/debug/deps/libpallet_utility-f8d9e0ae7e5424a0.rmeta --extern parachain_info=/Users/mattheworris/projects/frequency-main/target/debug/deps/libparachain_info-b4b3c88740d94bd6.rmeta --extern codec=/Users/mattheworris/projects/frequency-main/target/debug/deps/libparity_scale_codec-ddb8a35687f1a678.rmeta --extern polkadot_parachain=/Users/mattheworris/projects/frequency-main/target/debug/deps/libpolkadot_parachain-c5a875472bd56c6a.rmeta --extern polkadot_runtime_common=/Users/mattheworris/projects/frequency-main/target/debug/deps/libpolkadot_runtime_common-7cbfbe5c441312e6.rmeta --extern scale_info=/Users/mattheworris/projects/frequency-main/target/debug/deps/libscale_info-a8ca02e74d926c7b.rmeta --extern serde=/Users/mattheworris/projects/frequency-main/target/debug/deps/libserde-8dbbd6430b807c78.rmeta --extern smallvec=/Users/mattheworris/projects/frequency-main/target/debug/deps/libsmallvec-6a390beaa141f00e.rmeta --extern sp_api=/Users/mattheworris/projects/frequency-main/target/debug/deps/libsp_api-37c108eb6072cefd.rmeta --extern sp_block_builder=/Users/mattheworris/projects/frequency-main/target/debug/deps/libsp_block_builder-81e4c83ccf21f1a4.rmeta --extern sp_consensus_aura=/Users/mattheworris/projects/frequency-main/target/debug/deps/libsp_consensus_aura-f1ed1634b568f2d4.rmeta --extern sp_core=/Users/mattheworris/projects/frequency-main/target/debug/deps/libsp_core-aea7bf9402cf4131.rmeta --extern sp_inherents=/Users/mattheworris/projects/frequency-main/target/debug/deps/libsp_inherents-1653bffeb7eb1b56.rmeta --extern sp_io=/Users/mattheworris/projects/frequency-main/target/debug/deps/libsp_io-1d2ddf7ff348dd47.rmeta --extern sp_offchain=/Users/mattheworris/projects/frequency-main/target/debug/deps/libsp_offchain-53834d5b0c2ac780.rmeta --extern sp_runtime=/Users/mattheworris/projects/frequency-main/target/debug/deps/libsp_runtime-59b713b1b704bc97.rmeta --extern sp_session=/Users/mattheworris/projects/frequency-main/target/debug/deps/libsp_session-9a760d4b37f5c002.rmeta --extern sp_std=/Users/mattheworris/projects/frequency-main/target/debug/deps/libsp_std-05ae93e1b5f9cd86.rmeta --extern sp_transaction_pool=/Users/mattheworris/projects/frequency-main/target/debug/deps/libsp_transaction_pool-a81cab12015bdb50.rmeta --extern sp_version=/Users/mattheworris/projects/frequency-main/target/debug/deps/libsp_version-909560b2f96a909f.rmeta --extern system_runtime_api=/Users/mattheworris/projects/frequency-main/target/debug/deps/libsystem_runtime_api-aa68b04a0adee94b.rmeta --enable-index-page --check -Zunstable-options --crate-version 0.0.0 (exit status: 101)\r\nwarning: build failed, waiting for other jobs to finish...\r\nmake: *** [Makefile:75: lint] Error 101\r\n```\r\n\r\n</p>\r\n</details>\r\n", "closed_by": {"login": "mattheworris", "id": 1466844, "node_id": "MDQ6VXNlcjE0NjY4NDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1466844?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mattheworris", "html_url": "https://github.com/mattheworris", "followers_url": "https://api.github.com/users/mattheworris/followers", "following_url": "https://api.github.com/users/mattheworris/following{/other_user}", "gists_url": "https://api.github.com/users/mattheworris/gists{/gist_id}", "starred_url": "https://api.github.com/users/mattheworris/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mattheworris/subscriptions", "organizations_url": "https://api.github.com/users/mattheworris/orgs", "repos_url": "https://api.github.com/users/mattheworris/repos", "events_url": "https://api.github.com/users/mattheworris/events{/privacy}", "received_events_url": "https://api.github.com/users/mattheworris/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/112214/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/112214/timeline", "performed_via_github_app": null, "state_reason": "completed"}