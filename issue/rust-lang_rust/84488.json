{"url": "https://api.github.com/repos/rust-lang/rust/issues/84488", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/84488/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/84488/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/84488/events", "html_url": "https://github.com/rust-lang/rust/issues/84488", "id": 866309477, "node_id": "MDU6SXNzdWU4NjYzMDk0Nzc=", "number": 84488, "title": "Clarify Vec's documentation about buffer reuse", "user": {"login": "comex", "id": 47517, "node_id": "MDQ6VXNlcjQ3NTE3", "avatar_url": "https://avatars.githubusercontent.com/u/47517?v=4", "gravatar_id": "", "url": "https://api.github.com/users/comex", "html_url": "https://github.com/comex", "followers_url": "https://api.github.com/users/comex/followers", "following_url": "https://api.github.com/users/comex/following{/other_user}", "gists_url": "https://api.github.com/users/comex/gists{/gist_id}", "starred_url": "https://api.github.com/users/comex/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/comex/subscriptions", "organizations_url": "https://api.github.com/users/comex/orgs", "repos_url": "https://api.github.com/users/comex/repos", "events_url": "https://api.github.com/users/comex/events{/privacy}", "received_events_url": "https://api.github.com/users/comex/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 234902, "node_id": "MDU6TGFiZWwyMzQ5MDI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-enhancement", "name": "C-enhancement", "color": "f5f1fd", "default": false, "description": "Category: An issue proposing an enhancement or a PR with one."}, {"id": 166999014, "node_id": "MDU6TGFiZWwxNjY5OTkwMTQ=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-collections", "name": "A-collections", "color": "f7e101", "default": false, "description": "Area: std::collections."}, {"id": 211668062, "node_id": "MDU6TGFiZWwyMTE2NjgwNjI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-libs-api", "name": "T-libs-api", "color": "bfd4f2", "default": false, "description": "Relevant to the library API team, which will review and decide on the PR/issue."}, {"id": 431251592, "node_id": "MDU6TGFiZWw0MzEyNTE1OTI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-docs", "name": "A-docs", "color": "f7e101", "default": false, "description": "Area: documentation for any part of the project, including the compiler, standard library, and tools"}], "state": "closed", "locked": false, "assignee": {"login": "chrismit3s", "id": 38911273, "node_id": "MDQ6VXNlcjM4OTExMjcz", "avatar_url": "https://avatars.githubusercontent.com/u/38911273?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chrismit3s", "html_url": "https://github.com/chrismit3s", "followers_url": "https://api.github.com/users/chrismit3s/followers", "following_url": "https://api.github.com/users/chrismit3s/following{/other_user}", "gists_url": "https://api.github.com/users/chrismit3s/gists{/gist_id}", "starred_url": "https://api.github.com/users/chrismit3s/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chrismit3s/subscriptions", "organizations_url": "https://api.github.com/users/chrismit3s/orgs", "repos_url": "https://api.github.com/users/chrismit3s/repos", "events_url": "https://api.github.com/users/chrismit3s/events{/privacy}", "received_events_url": "https://api.github.com/users/chrismit3s/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "chrismit3s", "id": 38911273, "node_id": "MDQ6VXNlcjM4OTExMjcz", "avatar_url": "https://avatars.githubusercontent.com/u/38911273?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chrismit3s", "html_url": "https://github.com/chrismit3s", "followers_url": "https://api.github.com/users/chrismit3s/followers", "following_url": "https://api.github.com/users/chrismit3s/following{/other_user}", "gists_url": "https://api.github.com/users/chrismit3s/gists{/gist_id}", "starred_url": "https://api.github.com/users/chrismit3s/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chrismit3s/subscriptions", "organizations_url": "https://api.github.com/users/chrismit3s/orgs", "repos_url": "https://api.github.com/users/chrismit3s/repos", "events_url": "https://api.github.com/users/chrismit3s/events{/privacy}", "received_events_url": "https://api.github.com/users/chrismit3s/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2021-04-23T17:39:51Z", "updated_at": "2021-10-02T01:32:50Z", "closed_at": "2021-10-02T01:32:50Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "The [documentation for `Vec`](https://github.com/rust-lang/rust/blob/41f0e13bc53396852f4f1338ce5d8be0d1125b08/library/alloc/src/vec/mod.rs#L347) states:\r\n\r\n> Do not rely on removed data to be erased for security purposes. Even if you drop a `Vec`, its buffer may simply be reused by another `Vec`.\r\n\r\nHere, \"its buffer may simply be reused\" is simply meant to refer to the behavior of the underlying allocator.  But I have seen people with low-level experience be misled by this into thinking that the implementation of `Vec` itself has its own global allocation cache.  They then thought this cache was responsible for excess memory usage in their programs.\r\n\r\nI'm not sure what the best way to clarify this would be.  Part of the reason the current wording can be misleading is that \"reused by another `Vec`\" suggests a mechanism specific to `Vec`.  On the other hand, it would also help to just explicitly mention the allocator.  Here is a possible version that addresses both points, but it's more wordy than the current version:\r\n\r\n> Even if you drop a `Vec`, the allocator may reuse its buffer for another `Vec` or other allocation.\r\n\n\n<!-- TRIAGEBOT_START -->\n\n<!-- TRIAGEBOT_ASSIGN_START -->\n\n<!-- TRIAGEBOT_ASSIGN_DATA_START$${\"user\":\"chrismit3s\"}$$TRIAGEBOT_ASSIGN_DATA_END -->\n\n<!-- TRIAGEBOT_ASSIGN_END -->\n<!-- TRIAGEBOT_END -->", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/84488/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/84488/timeline", "performed_via_github_app": null, "state_reason": "completed"}