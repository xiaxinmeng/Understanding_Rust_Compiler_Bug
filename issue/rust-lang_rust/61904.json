{"url": "https://api.github.com/repos/rust-lang/rust/issues/61904", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/61904/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/61904/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/61904/events", "html_url": "https://github.com/rust-lang/rust/issues/61904", "id": 456709664, "node_id": "MDU6SXNzdWU0NTY3MDk2NjQ=", "number": 61904, "title": "ICE on extremely long string literal (larger than 4G)", "user": {"login": "oxalica", "id": 14816024, "node_id": "MDQ6VXNlcjE0ODE2MDI0", "avatar_url": "https://avatars.githubusercontent.com/u/14816024?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oxalica", "html_url": "https://github.com/oxalica", "followers_url": "https://api.github.com/users/oxalica/followers", "following_url": "https://api.github.com/users/oxalica/following{/other_user}", "gists_url": "https://api.github.com/users/oxalica/gists{/gist_id}", "starred_url": "https://api.github.com/users/oxalica/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oxalica/subscriptions", "organizations_url": "https://api.github.com/users/oxalica/orgs", "repos_url": "https://api.github.com/users/oxalica/repos", "events_url": "https://api.github.com/users/oxalica/events{/privacy}", "received_events_url": "https://api.github.com/users/oxalica/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 36956, "node_id": "MDU6TGFiZWwzNjk1Ng==", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-frontend", "name": "A-frontend", "color": "f7e101", "default": false, "description": "Area: frontend (errors, parsing and HIR)"}, {"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}, {"id": 27424086, "node_id": "MDU6TGFiZWwyNzQyNDA4Ng==", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-parser", "name": "A-parser", "color": "f7e101", "default": false, "description": "Area: The parsing of Rust source code to an AST."}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-06-17T01:56:37Z", "updated_at": "2019-06-18T02:17:58Z", "closed_at": "2019-06-18T02:17:58Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I know that having huge literal in source is a bad idea, but it should not cause ICE :(\r\nIt looks like something overflowed.\r\n\r\nVersion: `rustc 1.37.0-nightly (4edff843d 2019-06-16) running on x86_64-unknown-linux-gnu`\r\n\r\nCommand, output and backtrace:\r\n```bash\r\n$ RUST_BACKTRACE=full rustc ./huge.rs\r\nthread 'rustc' panicked at 'begin <= end (22 <= 21) when slicing `const HELLO: &str = r\"\r\nhello!!\r\nhello!!\r\nhello!!\r\nhello!!\r\nhello!!\r\nhello!!\r\nhello!!\r\nhello!!\r\nhello!!\r\nhello!!\r\nhello!!\r\nhello!!\r\nhello!!\r\nhello!!\r\nhello!!\r\nhello!!\r\nhello!!\r\nhello!!\r\nhello!!\r\nhello!!\r\nhello!!\r\nhello!!\r\nhello!!\r\nhello!!\r\nhello!!\r\nhello!!\r\nhello!!\r\nhello!!\r\nhello!!\r\nh`[...]', src/libcore/str/mod.rs:2021:5\r\nstack backtrace:\r\n   0:     0x7fc8de00011b - backtrace::backtrace::libunwind::trace::h912e0d04a7708cf2\r\n                               at /cargo/registry/src/github.com-1ecc6299db9ec823/backtrace-0.3.29/src/backtrace/libunwind.rs:88\r\n   1:     0x7fc8de00011b - backtrace::backtrace::trace_unsynchronized::hfb708595cf87b63f\r\n                               at /cargo/registry/src/github.com-1ecc6299db9ec823/backtrace-0.3.29/src/backtrace/mod.rs:66\r\n   2:     0x7fc8de00011b - std::sys_common::backtrace::_print::ha79f66d09fb9689e\r\n                               at src/libstd/sys_common/backtrace.rs:47\r\n   3:     0x7fc8de00011b - std::sys_common::backtrace::print::hbbf6608241e58d95\r\n                               at src/libstd/sys_common/backtrace.rs:36\r\n   4:     0x7fc8de00011b - std::panicking::default_hook::{{closure}}::h5463a2f4723f6cb3\r\n                               at src/libstd/panicking.rs:198\r\n   5:     0x7fc8ddfffe1e - std::panicking::default_hook::h79a408572fcba4ed\r\n                               at src/libstd/panicking.rs:212\r\n   6:     0x7fc8dbd92351 - rustc::util::common::panic_hook::h318156cfb41f5413\r\n   7:     0x7fc8de000979 - std::panicking::rust_panic_with_hook::hb67cd2b0c77d9895\r\n                               at src/libstd/panicking.rs:479\r\n   8:     0x7fc8de000412 - std::panicking::continue_panic_fmt::he44145e3b8e029cd\r\n                               at src/libstd/panicking.rs:382\r\n   9:     0x7fc8de0002f6 - rust_begin_unwind\r\n                               at src/libstd/panicking.rs:309\r\n  10:     0x7fc8de02e11d - core::panicking::panic_fmt::h7327567cfbeab565\r\n                               at src/libcore/panicking.rs:85\r\n  11:     0x7fc8de030740 - core::str::slice_error_fail::hba2c24f2962448b8\r\n                               at src/libcore/str/mod.rs:0\r\n  12:     0x7fc8db0dd012 - core::str::traits::<impl core::slice::SliceIndex<str> for core::ops::range::Range<usize>>::index::{{closure}}::he3b193b38a91659a\r\n  13:     0x7fc8db0ebf50 - syntax::parse::lexer::StringReader::with_str_from_to::h0d0fa368b8b05ffc\r\n  14:     0x7fc8db0e9916 - syntax::parse::lexer::StringReader::advance_token::hc406a5a0c98fe430\r\n  15:     0x7fc8db0e766d - syntax::parse::lexer::StringReader::try_next_token::habfb2fe795d28efa\r\n  16:     0x7fc8db0e7a9f - syntax::parse::lexer::StringReader::real_token::hfbd846ba27af2f28\r\n  17:     0x7fc8db115ef1 - syntax::parse::lexer::tokentrees::TokenTreesReader::parse_token_tree::h8061afbb3e86c76b\r\n  18:     0x7fc8db1155ce - syntax::parse::lexer::tokentrees::TokenTreesReader::parse_all_token_trees::h8018bcf24cc2951d\r\n  19:     0x7fc8db0e72f5 - syntax::parse::lexer::tokentrees::<impl syntax::parse::lexer::StringReader>::into_token_trees::h35e2e07fb40a0abc\r\n  20:     0x7fc8db0035af - syntax::parse::maybe_file_to_stream::h77846087608aa34a\r\n  21:     0x7fc8db002840 - syntax::parse::maybe_source_file_to_parser::h109680085ff17678\r\n  22:     0x7fc8db0022b4 - syntax::parse::source_file_to_parser::h7859d86f2a1b8e8a\r\n  23:     0x7fc8db00164a - syntax::parse::parse_crate_from_file::h72b9587b203687b8\r\n  24:     0x7fc8dda73bfd - rustc_interface::passes::parse::{{closure}}::h73af6c8d58be2c8e\r\n  25:     0x7fc8dda6e476 - rustc::util::common::time::hedf145db853fee22\r\n  26:     0x7fc8dda12c6f - rustc_interface::passes::parse::h6339ba714c071498\r\n  27:     0x7fc8dda02653 - rustc_interface::queries::Query<T>::compute::h59a144469961cc35\r\n  28:     0x7fc8ddaebb84 - rustc_interface::queries::<impl rustc_interface::interface::Compiler>::parse::hc1befc73f5446e68\r\n  29:     0x7fc8de2f3a71 - rustc_interface::interface::run_compiler_in_existing_thread_pool::h14bf4a38c2714175\r\n  30:     0x7fc8de3650a6 - std::thread::local::LocalKey<T>::with::h1ef421860970c1a1\r\n  31:     0x7fc8de2ff0ae - scoped_tls::ScopedKey<T>::set::hae697baf57baa69a\r\n  32:     0x7fc8de331124 - syntax::with_globals::h2ba7ae4c00aa57d8\r\n  33:     0x7fc8de34fdfd - std::sys_common::backtrace::__rust_begin_short_backtrace::hbacd46537732a9e0\r\n  34:     0x7fc8de01181a - __rust_maybe_catch_panic\r\n                               at src/libpanic_unwind/lib.rs:82\r\n  35:     0x7fc8de2dc2d9 - core::ops::function::FnOnce::call_once{{vtable.shim}}::h5f09d41df1db8d36\r\n  36:     0x7fc8ddfe3e1f - <alloc::boxed::Box<F> as core::ops::function::FnOnce<A>>::call_once::h6a25020f908b1369\r\n                               at /rustc/4edff843dd219cf19a5fede6c78c7ce95402e1f5/src/liballoc/boxed.rs:746\r\n  37:     0x7fc8de010500 - <alloc::boxed::Box<F> as core::ops::function::FnOnce<A>>::call_once::he4b68ab6cba491dc\r\n                               at /rustc/4edff843dd219cf19a5fede6c78c7ce95402e1f5/src/liballoc/boxed.rs:746\r\n  38:     0x7fc8de010500 - std::sys_common::thread::start_thread::hf0f92ea133daa112\r\n                               at src/libstd/sys_common/thread.rs:13\r\n  39:     0x7fc8de010500 - std::sys::unix::thread::Thread::new::thread_start::h9d375b1cdab5f2d3\r\n                               at src/libstd/sys/unix/thread.rs:79\r\n  40:     0x7fc8ddf7eef7 - start_thread\r\n  41:     0x7fc8ddea322f - __GI___clone\r\n  42:                0x0 - <unknown>\r\nquery stack during panic:\r\nend of query stack\r\n\r\nerror: internal compiler error: unexpected panic\r\n\r\nnote: the compiler unexpectedly panicked. this is a bug.\r\n\r\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports\r\n\r\nnote: rustc 1.37.0-nightly (4edff843d 2019-06-16) running on x86_64-unknown-linux-gnu\r\n```\r\n\r\nHere is the generator of the source:\r\n```bash\r\nout=\"./huge.rs\"\r\necho 'const HELLO: &str = r\"' >$out\r\nyes \"hello!!\" | head -c 4294967296 >>$out\r\necho '\";fn main() { println!(\"{}\", HELLO); }' >>$out\r\n```\r\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/61904/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/61904/timeline", "performed_via_github_app": null, "state_reason": "completed"}