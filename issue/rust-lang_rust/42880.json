{"url": "https://api.github.com/repos/rust-lang/rust/issues/42880", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/42880/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/42880/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/42880/events", "html_url": "https://github.com/rust-lang/rust/issues/42880", "id": 238316547, "node_id": "MDU6SXNzdWUyMzgzMTY1NDc=", "number": 42880, "title": "rustc panic - tuple struct pattern didn't resolve to variant or struct Err", "user": {"login": "dvec", "id": 23256371, "node_id": "MDQ6VXNlcjIzMjU2Mzcx", "avatar_url": "https://avatars.githubusercontent.com/u/23256371?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dvec", "html_url": "https://github.com/dvec", "followers_url": "https://api.github.com/users/dvec/followers", "following_url": "https://api.github.com/users/dvec/following{/other_user}", "gists_url": "https://api.github.com/users/dvec/gists{/gist_id}", "starred_url": "https://api.github.com/users/dvec/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dvec/subscriptions", "organizations_url": "https://api.github.com/users/dvec/orgs", "repos_url": "https://api.github.com/users/dvec/repos", "events_url": "https://api.github.com/users/dvec/events{/privacy}", "received_events_url": "https://api.github.com/users/dvec/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-06-24T13:10:43Z", "updated_at": "2017-06-30T22:15:06Z", "closed_at": "2017-06-30T22:15:06Z", "author_association": "NONE", "active_lock_reason": null, "body": "I got `rustc` panic with this code ([old version](https://is.gd/TpzlUQ)):\r\n```rust\r\n// I confused \"type\" with \"enum\" and wrote it:\r\ntype Value = String;\r\n// When it was correct to write this:\r\n// enum Value { String(String) }\r\n\r\nfn main() {\r\n    let f = |&Value::String(_)| ();\r\n\r\n    let vec: Vec<Value> = Vec::new();\r\n    vec.last().map(f);\r\n}\r\n```\r\nBacktrace:\r\n```\r\nthread 'rustc' panicked at 'Box<Any>', /checkout/src/librustc_errors/lib.rs:375\r\nstack backtrace:\r\n   0:     0x7f3e2689a5c3 - std::sys::imp::backtrace::tracing::imp::unwind_backtrace::hab274209b3900f9c\r\n                               at /checkout/src/libstd/sys/unix/backtrace/tracing/gcc_s.rs:49\r\n   1:     0x7f3e26895262 - std::sys_common::backtrace::_print::h8f655fc4b25b9b70\r\n                               at /checkout/src/libstd/sys_common/backtrace.rs:71\r\n   2:     0x7f3e268a84c7 - std::panicking::default_hook::{{closure}}::hd0f0fde26cdd4a91\r\n                               at /checkout/src/libstd/sys_common/backtrace.rs:60\r\n                               at /checkout/src/libstd/panicking.rs:355\r\n   3:     0x7f3e268a802c - std::panicking::default_hook::h123df66825ae8c79\r\n                               at /checkout/src/libstd/panicking.rs:365\r\n   4:     0x7f3e268a899b - std::panicking::rust_panic_with_hook::h3635757261b59272\r\n                               at /checkout/src/libstd/panicking.rs:549\r\n   5:     0x7f3e23652a68 - std::panicking::begin_panic::hfd3f08fcd3845370\r\n   6:     0x7f3e23642b17 - rustc_errors::Handler::span_bug::h7c196f95e5041943\r\n   7:     0x7f3e23865754 - rustc::session::opt_span_bug_fmt::{{closure}}::hfbfe9f66fec7d051\r\n   8:     0x7f3e23865259 - rustc::session::opt_span_bug_fmt::h4aac6d7f7dbc3512\r\n   9:     0x7f3e23864fa4 - rustc::session::span_bug_fmt::h20665e95c8d4d339\r\n  10:     0x7f3e23821ba7 - rustc::middle::mem_categorization::MemCategorizationContext::cat_pattern_::hda1146e1a4294a65\r\n  11:     0x7f3e23820e67 - rustc::middle::mem_categorization::MemCategorizationContext::cat_pattern_::hda1146e1a4294a65\r\n  12:     0x7f3e23804968 - rustc::middle::expr_use_visitor::ExprUseVisitor::walk_irrefutable_pat::h55366a16a8c5a817\r\n  13:     0x7f3e2380257b - rustc::middle::expr_use_visitor::ExprUseVisitor::consume_body::he345b3e052bf4252\r\n  14:     0x7f3e2523de68 - <rustc_typeck::check::upvar::AdjustBorrowKind<'a, 'gcx, 'tcx> as rustc::hir::intravisit::Visitor<'gcx>>::visit_fn::h1f91cf1c26d57eb8\r\n  15:     0x7f3e251e13f7 - rustc::hir::intravisit::walk_expr::hdf4b619bf2de5f4b\r\n  16:     0x7f3e251e12c0 - rustc::hir::intravisit::walk_expr::hdf4b619bf2de5f4b\r\n  17:     0x7f3e2523c4b1 - rustc_typeck::check::upvar::<impl rustc_typeck::check::FnCtxt<'a, 'gcx, 'tcx>>::closure_analyze::h429dc7e4810a0ff7\r\n  18:     0x7f3e25262826 - rustc_typeck::check::typeck_tables::{{closure}}::h166a120a5120b562\r\n  19:     0x7f3e25261e1a - rustc_typeck::check::typeck_tables::h7c308feeeae280ae\r\n  20:     0x7f3e2394455d - rustc::ty::maps::<impl rustc::ty::maps::queries::typeck_tables<'tcx>>::try_get::h794ae45d5584fb14\r\n  21:     0x7f3e23944721 - rustc::ty::maps::<impl rustc::ty::maps::queries::typeck_tables<'tcx>>::get::h0e95165ce2218687\r\n  22:     0x7f3e238f3892 - rustc::ty::<impl rustc::ty::context::TyCtxt<'a, 'gcx, 'tcx>>::item_tables::h5092397c1edc0916\r\n  23:     0x7f3e25261164 - rustc_typeck::check::typeck_item_bodies::h9ad82d5ce3097452\r\n  24:     0x7f3e23943893 - rustc::ty::maps::<impl rustc::ty::maps::queries::typeck_item_bodies<'tcx>>::try_get::heb2076eb001e5002\r\n  25:     0x7f3e23943aa0 - rustc::ty::maps::<impl rustc::ty::maps::queries::typeck_item_bodies<'tcx>>::get::hb2ce81d558718fc3\r\n  26:     0x7f3e252ba243 - rustc_typeck::check_crate::h16f92e6a986fd98b\r\n  27:     0x7f3e26c52b33 - rustc_driver::driver::phase_3_run_analysis_passes::{{closure}}::ha83538a03579857c\r\n  28:     0x7f3e26bb0dbb - rustc::ty::context::TyCtxt::create_and_enter::hd9482ac47b3dbb7c\r\n  29:     0x7f3e26c4a95a - rustc_driver::driver::phase_3_run_analysis_passes::hfea44285662197cc\r\n  30:     0x7f3e26c238ea - rustc_driver::driver::compile_input::hc74994fea2a7b3d8\r\n  31:     0x7f3e26c767f5 - rustc_driver::run_compiler::hccc057d367b00a4b\r\n  32:     0x7f3e26b7b32b - std::panicking::try::do_call::hbc2a3c31903904db\r\n  33:     0x7f3e268b1a0a - __rust_maybe_catch_panic\r\n                               at /checkout/src/libpanic_unwind/lib.rs:98\r\n  34:     0x7f3e26ba69e1 - <F as alloc::boxed::FnBox<A>>::call_box::h28281d8d856d67df\r\n  35:     0x7f3e268a7294 - std::sys::imp::thread::Thread::new::thread_start::h1b316ba1f093c5a7\r\n                               at /checkout/src/liballoc/boxed.rs:650\r\n                               at /checkout/src/libstd/sys_common/thread.rs:21\r\n                               at /checkout/src/libstd/sys/unix/thread.rs:84\r\n  36:     0x7f3e1f42a6b9 - start_thread\r\n  37:     0x7f3e265563dc - clone\r\n  38:                0x0 - <unknown>\r\n```\r\nMy rust version:\r\n```\r\nxxx@xxx ~ $ rustc --version\r\nrustc 1.18.0 (03fc9d622 2017-06-06)\r\n```", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/42880/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/42880/timeline", "performed_via_github_app": null, "state_reason": "completed"}