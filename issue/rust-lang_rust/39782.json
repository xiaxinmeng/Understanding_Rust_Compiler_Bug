{"url": "https://api.github.com/repos/rust-lang/rust/issues/39782", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/39782/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/39782/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/39782/events", "html_url": "https://github.com/rust-lang/rust/issues/39782", "id": 207138761, "node_id": "MDU6SXNzdWUyMDcxMzg3NjE=", "number": 39782, "title": "[LLVM 4.0] Symbol lookup error when linking dylibs", "user": {"login": "mattico", "id": 853158, "node_id": "MDQ6VXNlcjg1MzE1OA==", "avatar_url": "https://avatars.githubusercontent.com/u/853158?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mattico", "html_url": "https://github.com/mattico", "followers_url": "https://api.github.com/users/mattico/followers", "following_url": "https://api.github.com/users/mattico/following{/other_user}", "gists_url": "https://api.github.com/users/mattico/gists{/gist_id}", "starred_url": "https://api.github.com/users/mattico/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mattico/subscriptions", "organizations_url": "https://api.github.com/users/mattico/orgs", "repos_url": "https://api.github.com/users/mattico/repos", "events_url": "https://api.github.com/users/mattico/events{/privacy}", "received_events_url": "https://api.github.com/users/mattico/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2017-02-13T07:13:40Z", "updated_at": "2017-04-25T02:31:42Z", "closed_at": "2017-04-25T02:31:42Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "cc https://github.com/rust-lang/rust/issues/37609\r\n\r\nThese two tests fail when testing the compiler with a current LLVM build from the release_40 branch.\r\n```\r\nrun-make/llvm-pass\r\nrun-make/rustc-macro-dep-files\r\n```\r\nThe two failures are similar enough that they're probably related.\r\n\r\n```\r\ntest [run-make] run-make/llvm-pass ... FAILED\r\n\r\nstdout:\r\n------------------------------------------\r\nc++ -ffunction-sections -fdata-sections -fPIC -m64  -I/home/matt/Code/llvm/include -I/home/matt/Code/llvm/build-40/include  -fPIC -fvisibility-inlines-hidden -Wall -W -Wno-unused-parameter -Wwrite-strings -Wcast-qual -Wno-missing-field-initializers -pedantic -Wno-long-long -Wno-maybe-uninitialized -Wdelete-non-virtual-dtor -Wno-comment -Werror=date-time -std=c++11 -g  -fno-exceptions -fno-rtti -D_GNU_SOURCE -D__STDC_CONSTANT_MACROS -D__STDC_FORMAT_MACROS -D__STDC_LIMIT_MACROS -c llvm-function-pass.so.cc -o /home/matt/Code/Rust/rust/build/x86_64-unknown-linux-gnu/test/run-make/llvm-pass.stage1-x86_64-unknown-linux-gnu/libllvm-function-pass.o\r\nar crus /home/matt/Code/Rust/rust/build/x86_64-unknown-linux-gnu/test/run-make/llvm-pass.stage1-x86_64-unknown-linux-gnu/libllvm-function-pass.a /home/matt/Code/Rust/rust/build/x86_64-unknown-linux-gnu/test/run-make/llvm-pass.stage1-x86_64-unknown-linux-gnu/libllvm-function-pass.o\r\nc++ -ffunction-sections -fdata-sections -fPIC -m64  -I/home/matt/Code/llvm/include -I/home/matt/Code/llvm/build-40/include  -fPIC -fvisibility-inlines-hidden -Wall -W -Wno-unused-parameter -Wwrite-strings -Wcast-qual -Wno-missing-field-initializers -pedantic -Wno-long-long -Wno-maybe-uninitialized -Wdelete-non-virtual-dtor -Wno-comment -Werror=date-time -std=c++11 -g  -fno-exceptions -fno-rtti -D_GNU_SOURCE -D__STDC_CONSTANT_MACROS -D__STDC_FORMAT_MACROS -D__STDC_LIMIT_MACROS -c llvm-module-pass.so.cc -o /home/matt/Code/Rust/rust/build/x86_64-unknown-linux-gnu/test/run-make/llvm-pass.stage1-x86_64-unknown-linux-gnu/libllvm-module-pass.o\r\nar crus /home/matt/Code/Rust/rust/build/x86_64-unknown-linux-gnu/test/run-make/llvm-pass.stage1-x86_64-unknown-linux-gnu/libllvm-module-pass.a /home/matt/Code/Rust/rust/build/x86_64-unknown-linux-gnu/test/run-make/llvm-pass.stage1-x86_64-unknown-linux-gnu/libllvm-module-pass.o\r\nLD_LIBRARY_PATH=\"/home/matt/Code/Rust/rust/build/x86_64-unknown-linux-gnu/test/run-make/llvm-pass.stage1-x86_64-unknown-linux-gnu:/home/matt/Code/Rust/rust/build/x86_64-unknown-linux-gnu/stage1/lib:/home/matt/Code/Rust/rust/build/x86_64-unknown-linux-gnu/stage1-tools/x86_64-unknown-linux-gnu/release/deps:/home/matt/Code/Rust/rust/build/x86_64-unknown-linux-gnu/stage1/lib/rustlib/x86_64-unknown-linux-gnu/lib:\" '/home/matt/Code/Rust/rust/build/x86_64-unknown-linux-gnu/stage1/bin/rustc' --out-dir /home/matt/Code/Rust/rust/build/x86_64-unknown-linux-gnu/test/run-make/llvm-pass.stage1-x86_64-unknown-linux-gnu -L /home/matt/Code/Rust/rust/build/x86_64-unknown-linux-gnu/test/run-make/llvm-pass.stage1-x86_64-unknown-linux-gnu  plugin.rs -C prefer-dynamic\r\nLD_LIBRARY_PATH=\"/home/matt/Code/Rust/rust/build/x86_64-unknown-linux-gnu/test/run-make/llvm-pass.stage1-x86_64-unknown-linux-gnu:/home/matt/Code/Rust/rust/build/x86_64-unknown-linux-gnu/stage1/lib:/home/matt/Code/Rust/rust/build/x86_64-unknown-linux-gnu/stage1-tools/x86_64-unknown-linux-gnu/release/deps:/home/matt/Code/Rust/rust/build/x86_64-unknown-linux-gnu/stage1/lib/rustlib/x86_64-unknown-linux-gnu/lib:\" '/home/matt/Code/Rust/rust/build/x86_64-unknown-linux-gnu/stage1/bin/rustc' --out-dir /home/matt/Code/Rust/rust/build/x86_64-unknown-linux-gnu/test/run-make/llvm-pass.stage1-x86_64-unknown-linux-gnu -L /home/matt/Code/Rust/rust/build/x86_64-unknown-linux-gnu/test/run-make/llvm-pass.stage1-x86_64-unknown-linux-gnu  main.rs\r\nMakefile:9: recipe for target 'all' failed\r\n\r\n------------------------------------------\r\nstderr:\r\n------------------------------------------\r\nar: `u' modifier ignored since `D' is the default (see `U')\r\nar: `u' modifier ignored since `D' is the default (see `U')\r\n/home/matt/Code/Rust/rust/build/x86_64-unknown-linux-gnu/stage1/bin/rustc: symbol lookup error: /home/matt/Code/Rust/rust/build/x86_64-unknown-linux-gnu/test/run-make/llvm-pass.stage1-x86_64-unknown-linux-gnu/libsome_plugin.so: undefined symbol: _ZN12rustc_plugin8registry8Registry18register_llvm_pass17h3ddb9f4cf0e74ab9E\r\nmake: *** [all] Error 127\r\n```\r\n\r\n```\r\ntest [run-make] run-make/rustc-macro-dep-files ... FAILED\r\n\r\nstdout:\r\n------------------------------------------\r\nLD_LIBRARY_PATH=\"/home/matt/Code/Rust/rust/build/x86_64-unknown-linux-gnu/test/run-make/rustc-macro-dep-files.stage1-x86_64-unknown-linux-gnu:/home/matt/Code/Rust/rust/build/x86_64-unknown-linux-gnu/stage1/lib:/home/matt/Code/Rust/rust/build/x86_64-unknown-linux-gnu/stage1-tools/x86_64-unknown-linux-gnu/release/deps:/home/matt/Code/Rust/rust/build/x86_64-unknown-linux-gnu/stage1/lib/rustlib/x86_64-unknown-linux-gnu/lib:\" '/home/matt/Code/Rust/rust/build/x86_64-unknown-linux-gnu/stage1/bin/rustc' --out-dir /home/matt/Code/Rust/rust/build/x86_64-unknown-linux-gnu/test/run-make/rustc-macro-dep-files.stage1-x86_64-unknown-linux-gnu -L /home/matt/Code/Rust/rust/build/x86_64-unknown-linux-gnu/test/run-make/rustc-macro-dep-files.stage1-x86_64-unknown-linux-gnu  foo.rs\r\nLD_LIBRARY_PATH=\"/home/matt/Code/Rust/rust/build/x86_64-unknown-linux-gnu/test/run-make/rustc-macro-dep-files.stage1-x86_64-unknown-linux-gnu:/home/matt/Code/Rust/rust/build/x86_64-unknown-linux-gnu/stage1/lib:/home/matt/Code/Rust/rust/build/x86_64-unknown-linux-gnu/stage1-tools/x86_64-unknown-linux-gnu/release/deps:/home/matt/Code/Rust/rust/build/x86_64-unknown-linux-gnu/stage1/lib/rustlib/x86_64-unknown-linux-gnu/lib:\" '/home/matt/Code/Rust/rust/build/x86_64-unknown-linux-gnu/stage1/bin/rustc' --out-dir /home/matt/Code/Rust/rust/build/x86_64-unknown-linux-gnu/test/run-make/rustc-macro-dep-files.stage1-x86_64-unknown-linux-gnu -L /home/matt/Code/Rust/rust/build/x86_64-unknown-linux-gnu/test/run-make/rustc-macro-dep-files.stage1-x86_64-unknown-linux-gnu  bar.rs --emit dep-info\r\nMakefile:4: recipe for target 'all' failed\r\n\r\n------------------------------------------\r\nstderr:\r\n------------------------------------------\r\nerror: /home/matt/Code/Rust/rust/build/x86_64-unknown-linux-gnu/test/run-make/rustc-macro-dep-files.stage1-x86_64-unknown-linux-gnu/libfoo.so: undefined symbol: _ZN40_$LT$alloc..raw_vec..RawVec$LT$T$GT$$GT$6double14_MSG_FILE_LINE17h026b1bdceb71d8dcE\r\n  --> bar.rs:12:1\r\n   |\r\n12 | extern crate foo;\r\n   | ^^^^^^^^^^^^^^^^^\r\n\r\nmake: *** [all] Error 101\r\n```", "closed_by": {"login": "mattico", "id": 853158, "node_id": "MDQ6VXNlcjg1MzE1OA==", "avatar_url": "https://avatars.githubusercontent.com/u/853158?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mattico", "html_url": "https://github.com/mattico", "followers_url": "https://api.github.com/users/mattico/followers", "following_url": "https://api.github.com/users/mattico/following{/other_user}", "gists_url": "https://api.github.com/users/mattico/gists{/gist_id}", "starred_url": "https://api.github.com/users/mattico/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mattico/subscriptions", "organizations_url": "https://api.github.com/users/mattico/orgs", "repos_url": "https://api.github.com/users/mattico/repos", "events_url": "https://api.github.com/users/mattico/events{/privacy}", "received_events_url": "https://api.github.com/users/mattico/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/39782/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/39782/timeline", "performed_via_github_app": null, "state_reason": "completed"}