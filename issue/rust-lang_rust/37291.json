{"url": "https://api.github.com/repos/rust-lang/rust/issues/37291", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/37291/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/37291/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/37291/events", "html_url": "https://github.com/rust-lang/rust/issues/37291", "id": 184087059, "node_id": "MDU6SXNzdWUxODQwODcwNTk=", "number": 37291, "title": "ICE with cross-crate projection", "user": {"login": "ziish", "id": 1108210, "node_id": "MDQ6VXNlcjExMDgyMTA=", "avatar_url": "https://avatars.githubusercontent.com/u/1108210?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ziish", "html_url": "https://github.com/ziish", "followers_url": "https://api.github.com/users/ziish/followers", "following_url": "https://api.github.com/users/ziish/following{/other_user}", "gists_url": "https://api.github.com/users/ziish/gists{/gist_id}", "starred_url": "https://api.github.com/users/ziish/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ziish/subscriptions", "organizations_url": "https://api.github.com/users/ziish/orgs", "repos_url": "https://api.github.com/users/ziish/repos", "events_url": "https://api.github.com/users/ziish/events{/privacy}", "received_events_url": "https://api.github.com/users/ziish/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}, {"id": 203429200, "node_id": "MDU6TGFiZWwyMDM0MjkyMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/P-high", "name": "P-high", "color": "eb6420", "default": false, "description": "High priority"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 262252840, "node_id": "MDU6TGFiZWwyNjIyNTI4NDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/regression-from-stable-to-stable", "name": "regression-from-stable-to-stable", "color": "e4008a", "default": false, "description": "Performance or correctness regression from one stable version to another."}], "state": "closed", "locked": false, "assignee": {"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 9, "created_at": "2016-10-19T22:09:35Z", "updated_at": "2016-11-03T10:11:45Z", "closed_at": "2016-11-03T10:11:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "Running rustdoc all testcases for this [crate](https://github.com/physhh/img) fails with an ICE. The relevant testcase is currently disabled. To enable it go to `image/impl_core.rs:24` and remove the `ignore` marker.\n\n`rustc --version --verbose`:\n\n```\nrustc 1.14.0-nightly (16eeeac78 2016-10-18)\nbinary: rustc\ncommit-hash: 16eeeac783d2ede28e09f2a433c612dea309fe33\ncommit-date: 2016-10-18\nhost: x86_64-pc-windows-msvc\nrelease: 1.14.0-nightly\nLLVM version: 3.9\n```\n\nThis is the result of `cargo test`:\n\n```\n    Finished debug [unoptimized + debuginfo] target(s) in 0.0 secs\n     Running target\\debug\\deps\\img-7ec732e017a2f5eb.exe\n\nrunning 4 tests\ntest px::test_arithmetic ... ok\ntest px::test_raw_buffer_funcs ... ok\ntest scalar::test_arithmetic ... ok\ntest image::test_image_buffer ... ok\n\ntest result: ok. 4 passed; 0 failed; 0 ignored; 0 measured\n\n   Doc-tests img\n\nrunning 8 tests\ntest px::generic::PixelArithmetic_0 ... ok\ntest image::generics::Image_0 ... ok\ntest image::impl_core::ImageVal_0 ... FAILED\ntest px::generic::Pixel::calc_minimum_pitch_0 ... ok\ntest px::generic::Pixel_0 ... ok\ntest scalar::generic::Scalar_0 ... ok\ntest px::impl_core::PixelVal_0 ... ok\ntest scalar::impl_core::ScalarVal_0 ... ok\n\nfailures:\n\n---- image::impl_core::ImageVal_0 stdout ----\n        error: internal compiler error: ../src/librustc\\traits\\specialize/mod.rs:198: specializes: obligation `Obligation(predicate=Binder(ProjectionPredicate(ProjectionTy { trait_\nref: <_ as img::PixelArithmetic>, item_name: ScalarT(4511) }, _)),depth=1)` has inference types/regions\n\nthread 'image::impl_core::ImageVal_0' panicked at 'Box<Any>', ../src/librustc_errors/lib.rs:656\nstack backtrace:\n   0:      0x7fee2c7f804 - <u32 as std::sys::IsZero>::is_zero::hb501b477ff597565\n   1:      0x7fee2c7bca9 - std::panicking::Location::line::h756ee230b7a7fab3\n   2:      0x7fee2c7c6ed - std::panicking::rust_panic_with_hook::hcd9d05f53fa0dafc\n   3:      0x7fef3d128ea - <unknown>\n   4:      0x7fef3d2608d - rustc_errors::Handler::bug::haca77c19c882b432\n   5:      0x7fee197b2d5 - <rustc::util::ppaux::TraitAndProjections<'tcx> as core::fmt::Debug>::fmt::hb5d03a0e1370418a\n   6:      0x7fee189b262 - rustc::session::bug_fmt::hde22f071bf5a80ea\n   7:      0x7fee189af7c - rustc::session::bug_fmt::hde22f071bf5a80ea\n   8:      0x7fee1975d31 - <rustc::util::ppaux::TraitAndProjections<'tcx> as core::fmt::Debug>::fmt::hb5d03a0e1370418a\n   9:      0x7fee16c6dd7 - <unknown>\n  10:      0x7fee19165d5 - rustc::ty::context::TyCtxt::free_region_map::h82e8c7df0d75ed07\n  11:      0x7fee18d5cc6 - rustc::traits::specialize::specializes::hc06f881417f11f03\n  12:      0x7fee18c8ae0 - rustc::traits::select::SelectionContext::evaluate_obligation_conservatively::h7dc149b5b7563089\n  13:      0x7fee18c29da - rustc::traits::select::SelectionContext::evaluate_obligation_conservatively::h7dc149b5b7563089\n  14:      0x7fee18c0da7 - rustc::traits::select::SelectionContext::evaluate_obligation_conservatively::h7dc149b5b7563089\n  15:      0x7fee18c0430 - rustc::traits::select::SelectionContext::evaluate_obligation_conservatively::h7dc149b5b7563089\n  16:      0x7fee18bfc9a - rustc::traits::select::SelectionContext::evaluate_obligation::h918f689b79ed78ea\n  17:      0x7fee1da81e4 - rustc_typeck::check::method::<impl rustc_typeck::check::FnCtxt<'a, 'gcx, 'tcx>>::lookup_method_in_trait_adjusted::h23bf843644a86a1c\n  18:      0x7fee1dce0d8 - rustc_typeck::check::op::<impl rustc_typeck::check::FnCtxt<'a, 'gcx, 'tcx>>::check_user_unop::hccfdc1643ed36810\n  19:      0x7fee1dccd9c - rustc_typeck::check::op::<impl rustc_typeck::check::FnCtxt<'a, 'gcx, 'tcx>>::check_binop::h5fef06b12193950d\n  20:      0x7fee1dcc782 - rustc_typeck::check::op::<impl rustc_typeck::check::FnCtxt<'a, 'gcx, 'tcx>>::check_binop::h5fef06b12193950d\n  21:      0x7fee1dfa4ca - rustc_typeck::check::FnCtxt::check_struct_path::h0a3b8cb3a9a77f78\n  22:      0x7fee1dfa066 - rustc_typeck::check::FnCtxt::check_struct_path::h0a3b8cb3a9a77f78\n  23:      0x7fee1dfadf1 - rustc_typeck::check::FnCtxt::check_struct_path::h0a3b8cb3a9a77f78\n  24:      0x7fee1dfa066 - rustc_typeck::check::FnCtxt::check_struct_path::h0a3b8cb3a9a77f78\n  25:      0x7fee1e0accb - rustc_typeck::check::FnCtxt::check_stmt::he33c1a72110694ef\n  26:      0x7fee1e0b1ca - rustc_typeck::check::FnCtxt::check_block_no_value::h45608011ee74f15e\n  27:      0x7fee1dd5806 - <rustc_typeck::check::GatherLocalsVisitor<'a, 'gcx, 'tcx> as rustc::hir::intravisit::Visitor<'gcx>>::visit_ty::hd4c15b543ae85d6e\n  28:      0x7fee1dd38b0 - rustc_typeck::check::check_drop_impls::hf0fd3120466d7e2f\n  29:      0x7fee1dd7f79 - rustc_typeck::check::check_item_body::h3223fb19b212e96a\n  30:      0x7fee1dd072b - rustc_typeck::check::check_item_bodies::ha98a70a8fce7849f\n  31:      0x7fee1e4f563 - rustc_typeck::check_crate::hd5386d41de8aa25b\n  32:      0x7fee205b815 - <rustc_driver::Compilation as core::fmt::Debug>::fmt::hfc4845a68da21d3e\n  33:      0x7fee1f8a06e - <unknown>\n  34:      0x7fee2012353 - rustc_driver::driver::compile_input::h5b63ccd49eeeb98b\n  35:      0x7fee2144800 - <unknown>\n  36:      0x7fee2c81ce1 - _rust_maybe_catch_panic\n  37:      0x7fee227755e - rustdoc::test::run::hcc44ccd17e8a0827\n  38:      0x7fee2145a4f - <unknown>\n  39:      0x7fee2c81ce1 - _rust_maybe_catch_panic\n  40:      0x7fee5e63b4b - <unknown>\n  41:      0x7fee2c81ce1 - _rust_maybe_catch_panic\n  42:      0x7fee5e6b7fa - <unknown>\n  43:      0x7fee2c79b2e - std::sys::thread::Thread::new::hf599b376c47e7cb9\n  44:         0x76df59cc - BaseThreadInitThunk\nthread 'image::impl_core::ImageVal_0' panicked at 'couldn't compile the test', ../src/librustdoc\\test.rs:283\nstack backtrace:\n   0:      0x7fee2c7f804 - <u32 as std::sys::IsZero>::is_zero::hb501b477ff597565\n   1:      0x7fee2c7bca9 - std::panicking::Location::line::h756ee230b7a7fab3\n   2:      0x7fee2c7c6ed - std::panicking::rust_panic_with_hook::hcd9d05f53fa0dafc\n   3:      0x7fee2142cd3 - <unknown>\n   4:      0x7fee2278e14 - rustdoc::test::run::hcc44ccd17e8a0827\n   5:      0x7fee2145a4f - <unknown>\n   6:      0x7fee2c81ce1 - _rust_maybe_catch_panic\n   7:      0x7fee5e63b4b - <unknown>\n   8:      0x7fee2c81ce1 - _rust_maybe_catch_panic\n   9:      0x7fee5e6b7fa - <unknown>\n  10:      0x7fee2c79b2e - std::sys::thread::Thread::new::hf599b376c47e7cb9\n  11:         0x76df59cc - BaseThreadInitThunk\n\n\nfailures:\n    image::impl_core::ImageVal_0\n\ntest result: FAILED. 7 passed; 1 failed; 0 ignored; 0 measured\n\nerror: test failed\n```\n\nThis fails on stable and nightly. I do not have time to create a reduced test case right now. Hope this helps anyway. \n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/37291/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/37291/timeline", "performed_via_github_app": null, "state_reason": "completed"}