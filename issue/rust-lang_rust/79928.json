{"url": "https://api.github.com/repos/rust-lang/rust/issues/79928", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/79928/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/79928/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/79928/events", "html_url": "https://github.com/rust-lang/rust/issues/79928", "id": 761954269, "node_id": "MDU6SXNzdWU3NjE5NTQyNjk=", "number": 79928, "title": "Cargo/rustc issue", "user": {"login": "GreenBeard", "id": 2000704, "node_id": "MDQ6VXNlcjIwMDA3MDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/2000704?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GreenBeard", "html_url": "https://github.com/GreenBeard", "followers_url": "https://api.github.com/users/GreenBeard/followers", "following_url": "https://api.github.com/users/GreenBeard/following{/other_user}", "gists_url": "https://api.github.com/users/GreenBeard/gists{/gist_id}", "starred_url": "https://api.github.com/users/GreenBeard/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GreenBeard/subscriptions", "organizations_url": "https://api.github.com/users/GreenBeard/orgs", "repos_url": "https://api.github.com/users/GreenBeard/repos", "events_url": "https://api.github.com/users/GreenBeard/events{/privacy}", "received_events_url": "https://api.github.com/users/GreenBeard/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-12-11T06:32:11Z", "updated_at": "2021-10-19T16:20:33Z", "closed_at": "2020-12-11T12:50:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!--\r\nThank you for finding an Internal Compiler Error!   If possible, try to provide\r\na minimal verifiable example. You can read \"Rust Bug Minimization Patterns\" for\r\nhow to create smaller examples.\r\n\r\nhttp://blog.pnkfx.org/blog/2019/11/18/rust-bug-minimization-patterns/\r\n\r\n-->\r\n\r\n### Code\r\nUnknown which part (large library, and small test program). Apologizes for making your life more difficult, although as specified in **Meta** I suspect this is to do with `cargo`.\r\n\r\n\r\n### Meta\r\n<!--\r\nIf you're using the stable version of the compiler, you should also check if the\r\nbug also exists in the beta or nightly versions.\r\n\r\nI suspect the issue is to do with cargo. If I use `cargo build` after trashing the `Cargo.lock` (and the git remote has added a new commit to the master) this occurs. Once I run `cargo clean` everything is all dandy again.\r\n-->\r\n\r\n`rustc --version --verbose`:\r\n```\r\nrustc 1.50.0-nightly (3ff10e74a 2020-12-04)\r\nbinary: rustc\r\ncommit-hash: 3ff10e74a74ed093fcabac1de27fe1cd65bbbb4a\r\ncommit-date: 2020-12-04\r\nhost: x86_64-unknown-linux-gnu\r\nrelease: 1.50.0-nightly\r\n<version>\r\n```\r\n\r\n### Error output\r\n\r\n```\r\nthread 'rustc' panicked at 'called `Option::unwrap()` on a `None` value', compiler/rustc_middle/src/ty/query/mod.rs:235:5\r\n```\r\n\r\n<!--\r\nInclude a backtrace in the code block by setting `RUST_BACKTRACE=1` in your\r\nenvironment. E.g. `RUST_BACKTRACE=1 cargo build`.\r\n-->\r\n<details><summary><strong>Backtrace</strong></summary>\r\n<p>\r\n\r\n```\r\n    Updating git repository `https://github.com/GreenBeard/z3.rs`\r\n    Updating git submodule `https://github.com/Z3Prover/z3.git`\r\n    Updating crates.io index\r\n   Compiling z3-sys v0.6.3 (https://github.com/GreenBeard/z3.rs#11859da6)\r\n   Compiling z3 v0.9.0 (https://github.com/GreenBeard/z3.rs#11859da6)\r\n   Compiling rust_z3 v0.1.0 (/home/alex/workspace/rust_z3)\r\nthread 'rustc' panicked at 'called `Option::unwrap()` on a `None` value', compiler/rustc_middle/src/ty/query/mod.rs:235:5\r\nstack backtrace:\r\n   0: rust_begin_unwind\r\n             at /rustc/3ff10e74a74ed093fcabac1de27fe1cd65bbbb4a/library/std/src/panicking.rs:493:5\r\n   1: core::panicking::panic_fmt\r\n             at /rustc/3ff10e74a74ed093fcabac1de27fe1cd65bbbb4a/library/core/src/panicking.rs:92:14\r\n   2: core::panicking::panic\r\n             at /rustc/3ff10e74a74ed093fcabac1de27fe1cd65bbbb4a/library/core/src/panicking.rs:50:5\r\n   3: rustc_middle::ty::query::try_load_from_on_disk_cache\r\n   4: rustc_query_system::dep_graph::graph::DepGraph<K>::with_ignore\r\n   5: rustc_incremental::persist::save::save_in\r\n   6: rustc_data_structures::sync::join\r\n   7: rustc_query_system::dep_graph::graph::DepGraph<K>::with_ignore\r\n   8: rustc_incremental::persist::save::save_dep_graph\r\n   9: rustc_codegen_ssa::base::finalize_tcx\r\n  10: rustc_codegen_ssa::base::codegen_crate\r\n  11: <rustc_codegen_llvm::LlvmCodegenBackend as rustc_codegen_ssa::traits::backend::CodegenBackend>::codegen_crate\r\n  12: rustc_interface::queries::Queries::ongoing_codegen\r\n  13: rustc_interface::queries::<impl rustc_interface::interface::Compiler>::enter\r\n  14: rustc_span::with_source_map\r\n  15: scoped_tls::ScopedKey<T>::set\r\nnote: Some details are omitted, run with `RUST_BACKTRACE=full` for a verbose backtrace.\r\n\r\nerror: internal compiler error: unexpected panic\r\n\r\nnote: the compiler unexpectedly panicked. this is a bug.\r\n\r\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/issues/new?labels=C-bug%2C+I-ICE%2C+T-compiler&template=ice.md\r\n\r\nnote: rustc 1.50.0-nightly (3ff10e74a 2020-12-04) running on x86_64-unknown-linux-gnu\r\n\r\nnote: compiler flags: -C embed-bitcode=no -C debuginfo=2 -C incremental --crate-type bin\r\n\r\nnote: some of the compiler flags provided by cargo are hidden\r\n\r\nquery stack during panic:\r\nend of query stack\r\nerror: could not compile `rust_z3`\r\n\r\nTo learn more, run the command again with --verbose.\r\n\r\n```\r\n\r\n</p>\r\n</details>\r\n\r\nEdit: Let me know if I can do anything specific to help pinpoint this bug.\r\n\r\n", "closed_by": {"login": "sfackler", "id": 1455697, "node_id": "MDQ6VXNlcjE0NTU2OTc=", "avatar_url": "https://avatars.githubusercontent.com/u/1455697?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sfackler", "html_url": "https://github.com/sfackler", "followers_url": "https://api.github.com/users/sfackler/followers", "following_url": "https://api.github.com/users/sfackler/following{/other_user}", "gists_url": "https://api.github.com/users/sfackler/gists{/gist_id}", "starred_url": "https://api.github.com/users/sfackler/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sfackler/subscriptions", "organizations_url": "https://api.github.com/users/sfackler/orgs", "repos_url": "https://api.github.com/users/sfackler/repos", "events_url": "https://api.github.com/users/sfackler/events{/privacy}", "received_events_url": "https://api.github.com/users/sfackler/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/79928/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/79928/timeline", "performed_via_github_app": null, "state_reason": "completed"}