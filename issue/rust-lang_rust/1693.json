{"url": "https://api.github.com/repos/rust-lang/rust/issues/1693", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/1693/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/1693/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/1693/events", "html_url": "https://github.com/rust-lang/rust/issues/1693", "id": 3005868, "node_id": "MDU6SXNzdWUzMDA1ODY4", "number": 1693, "title": "Stack-allocation only subset/specifier", "user": {"login": "litghost", "id": 537074, "node_id": "MDQ6VXNlcjUzNzA3NA==", "avatar_url": "https://avatars.githubusercontent.com/u/537074?v=4", "gravatar_id": "", "url": "https://api.github.com/users/litghost", "html_url": "https://github.com/litghost", "followers_url": "https://api.github.com/users/litghost/followers", "following_url": "https://api.github.com/users/litghost/following{/other_user}", "gists_url": "https://api.github.com/users/litghost/gists{/gist_id}", "starred_url": "https://api.github.com/users/litghost/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/litghost/subscriptions", "organizations_url": "https://api.github.com/users/litghost/orgs", "repos_url": "https://api.github.com/users/litghost/repos", "events_url": "https://api.github.com/users/litghost/events{/privacy}", "received_events_url": "https://api.github.com/users/litghost/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 235137, "node_id": "MDU6TGFiZWwyMzUxMzc=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-lint", "name": "A-lint", "color": "f7e101", "default": false, "description": "Area: Lints (warnings about flaws in source code) such as unused_mut."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2012-01-28T16:28:55Z", "updated_at": "2013-02-07T20:29:08Z", "closed_at": "2013-02-07T20:29:08Z", "author_association": "NONE", "active_lock_reason": null, "body": "There are platforms and libraries where allowing Rust to allocate freely from the heap using malloc/free is not the right thing to do.  Does it make sense to ensure that the core language of Rust can be used under such conditions?  At this point the biggest change is re-vamping vectors to be declared in stack context and in the same way that the rest of the core types can be.\n\nTwo motivating examples I can think of are libraries that take allocation functions like zlib (which take an allocation interface) and any time targeting micro-controllers like PICs or AVRs.\n\nWriting the equivalent of of zlib in Rust would require that you avoid vectors and rely on wrapping allocations from the allocator functions in something like c_vec.  For fixed size arrays on the size order of 1-32 elements, does it really make sense to require a heap allocation, instead of just grabbing some stack space?\n\nIn the case of micro-controllers, I guess there is the question of intentions for the language.  Rust explicitly has Win32, Mac, and Linux on the list of primary platforms.  However many parts of the language do not require full heap-allocated support.  If you avoid shared boxes (which is probably what you would end up doing on micro-controller anyways), the biggest obstacle is the heap allocation for vectors.   Requiring heap allocation for vectors completely excludes a large set of Rust programs from being practical on micro-controllers, where-as simply having a stack length immutable/mutable array would suddenly allow a good set of micro-controller programs to be possible.\n\nThe title also has the \"specifier\" bit, because I am wondering if it makes sense to be able to say to the compiler \"this function should exist on the stack, warn/error me if you are going to do some heap allocation here\".  This would be in an effort to allow the compiler to be explicit about \"magic\" allocations.\n", "closed_by": {"login": "catamorphism", "id": 427212, "node_id": "MDQ6VXNlcjQyNzIxMg==", "avatar_url": "https://avatars.githubusercontent.com/u/427212?v=4", "gravatar_id": "", "url": "https://api.github.com/users/catamorphism", "html_url": "https://github.com/catamorphism", "followers_url": "https://api.github.com/users/catamorphism/followers", "following_url": "https://api.github.com/users/catamorphism/following{/other_user}", "gists_url": "https://api.github.com/users/catamorphism/gists{/gist_id}", "starred_url": "https://api.github.com/users/catamorphism/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/catamorphism/subscriptions", "organizations_url": "https://api.github.com/users/catamorphism/orgs", "repos_url": "https://api.github.com/users/catamorphism/repos", "events_url": "https://api.github.com/users/catamorphism/events{/privacy}", "received_events_url": "https://api.github.com/users/catamorphism/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/1693/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/1693/timeline", "performed_via_github_app": null, "state_reason": "completed"}