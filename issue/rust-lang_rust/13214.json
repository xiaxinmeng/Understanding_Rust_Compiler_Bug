{"url": "https://api.github.com/repos/rust-lang/rust/issues/13214", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/13214/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/13214/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/13214/events", "html_url": "https://github.com/rust-lang/rust/issues/13214", "id": 30472633, "node_id": "MDU6SXNzdWUzMDQ3MjYzMw==", "number": 13214, "title": "ICE: defining static with struct that contains enum with &'static str variant", "user": {"login": "arjantop", "id": 52403, "node_id": "MDQ6VXNlcjUyNDAz", "avatar_url": "https://avatars.githubusercontent.com/u/52403?v=4", "gravatar_id": "", "url": "https://api.github.com/users/arjantop", "html_url": "https://github.com/arjantop", "followers_url": "https://api.github.com/users/arjantop/followers", "following_url": "https://api.github.com/users/arjantop/following{/other_user}", "gists_url": "https://api.github.com/users/arjantop/gists{/gist_id}", "starred_url": "https://api.github.com/users/arjantop/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/arjantop/subscriptions", "organizations_url": "https://api.github.com/users/arjantop/orgs", "repos_url": "https://api.github.com/users/arjantop/repos", "events_url": "https://api.github.com/users/arjantop/events{/privacy}", "received_events_url": "https://api.github.com/users/arjantop/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 46741598, "node_id": "MDU6TGFiZWw0Njc0MTU5OA==", "url": "https://api.github.com/repos/rust-lang/rust/labels/E-needs-test", "name": "E-needs-test", "color": "02e10c", "default": false, "description": "Call for participation: writing correctness tests"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2014-03-30T19:30:44Z", "updated_at": "2014-06-11T14:37:07Z", "closed_at": "2014-06-11T14:37:07Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "If you change char in Test to int the error is gone, also adding another field or switching field positions in Test has the same effect.\n\nExample:\n\n``` rust\npub enum Foo {\n    Bar,\n    Baz(&'static str),\n}\n\npub static TEST: Test = Test {\n    foo: Bar,\n    c: 'a'\n};\n\npub struct Test {\n    foo: Foo,\n    c: char,\n}\n\nfn main() {\n}\n```\n\nError:\n\n```\n{ { i8, [23 x i8] }, i32 } { { i8, [23 x i8] } { i8 0, [23 x i8] undef }, i32 97 }\n{ { i8, [7 x i8], [2 x i64] }, i32 } undef\nerror: internal compiler error: const expr(17: Test{foo: Bar, c: 'a',}) of type Test has size 28 instead of 32\nnote: the compiler hit an unexpected failure path. this is a bug.\nnote: we would appreciate a bug report: http://static.rust-lang.org/doc/master/complement-bugreport.html\nnote: run with `RUST_BACKTRACE=1` for a backtrace\n```\n\nBacktrace:\n\n```\nstack backtrace:\n   1:     0x7f5a16de0230 - rt::backtrace::imp::write::h76ae436ab8cd2bfapZb::v0.10.pre\n   2:     0x7f5a16d41a10 - rt::unwind::begin_unwind_inner::hf4375e02d9645bfaSzb::v0.10.pre\n   3:     0x7f5a159ae830 - rt::unwind::begin_unwind::h3c590aa38e8709d1ok2::v0.10.pre\n   4:     0x7f5a159af410 - diagnostic::Handler::bug::hf68c63085e9b6510YVb::v0.10.pre\n   5:     0x7f5a177998e0 - driver::session::Session::bug::hfd0e2310310f12b7cih::v0.10.pre\n   6:     0x7f5a1783bd80 - middle::trans::consts::const_expr::h43dc45f3937eaf8bFZi::v0.10.pre\n   7:     0x7f5a177968c0 - middle::trans::base::get_item_val::h1e82e744da42398aqep::v0.10.pre\n   8:     0x7f5a1783db50 - middle::trans::consts::trans_const::hf108c8e66bb317e7rNj::v0.10.pre\n   9:     0x7f5a177956b0 - middle::trans::base::trans_item::h14eeb46ce9c8fca6uUo::v0.10.pre\n  10:     0x7f5a178701d0 - middle::trans::base::trans_mod::hd916ddc9839c24eazZo::v0.10.pre\n  11:     0x7f5a17879a20 - middle::trans::base::trans_crate::h4986f3f48477ce7b2vq::v0.10.pre\n  12:     0x7f5a17f8db00 - driver::driver::phase_4_translate_to_llvm::had71317fbd14c5f8eHf::v0.10.pre\n  13:     0x7f5a17f8fcd0 - driver::driver::compile_input::h396d5b0fd5bd11243Wf::v0.10.pre\n  14:     0x7f5a17fb43f0 - run_compiler::h586972086a406218xAn::v0.10.pre\n  15:     0x7f5a17fcb940 - main_args::closure.92068\n  16:     0x7f5a17fca270 - monitor::closure.91953\n  17:     0x7f5a17fc5ba0 - task::TaskBuilder::try::closure.91728\n  18:     0x7f5a19d3c400 - task::spawn_opts::closure.7828\n  19:     0x7f5a16ddb6c0 - rt::task::Task::run::closure.41627\n  20:     0x7f5a16de6cd0 - rust_try\n  21:     0x7f5a16ddb500 - rt::task::Task::run::hc847d6a2bcfd72f1os9::v0.10.pre\n  22:     0x7f5a19d3c1d0 - task::spawn_opts::closure.7801\n  23:     0x7f5a16dded70 - rt::thread::thread_start::he494c19e89c9f3eb569::v0.10.pre\n  24:     0x7f5a140fafe0 - start_thread\n  25:     0x7f5a16a0cce9 - clone\n  26:                0x0 - <unknown>\n```\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/13214/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/13214/timeline", "performed_via_github_app": null, "state_reason": "completed"}