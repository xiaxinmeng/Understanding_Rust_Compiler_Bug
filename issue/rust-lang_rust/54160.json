{"url": "https://api.github.com/repos/rust-lang/rust/issues/54160", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/54160/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/54160/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/54160/events", "html_url": "https://github.com/rust-lang/rust/issues/54160", "id": 359658348, "node_id": "MDU6SXNzdWUzNTk2NTgzNDg=", "number": 54160, "title": "Don't suggest `42u8.into()`, suggest \"change the literal to `42u16`", "user": {"login": "estebank", "id": 1606434, "node_id": "MDQ6VXNlcjE2MDY0MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1606434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/estebank", "html_url": "https://github.com/estebank", "followers_url": "https://api.github.com/users/estebank/followers", "following_url": "https://api.github.com/users/estebank/following{/other_user}", "gists_url": "https://api.github.com/users/estebank/gists{/gist_id}", "starred_url": "https://api.github.com/users/estebank/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/estebank/subscriptions", "organizations_url": "https://api.github.com/users/estebank/orgs", "repos_url": "https://api.github.com/users/estebank/repos", "events_url": "https://api.github.com/users/estebank/events{/privacy}", "received_events_url": "https://api.github.com/users/estebank/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 235791, "node_id": "MDU6TGFiZWwyMzU3OTE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-diagnostics", "name": "A-diagnostics", "color": "f7e101", "default": false, "description": "Area: Messages for errors, warnings, and lints"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-09-12T21:24:17Z", "updated_at": "2018-09-18T11:40:06Z", "closed_at": "2018-09-18T11:40:06Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "[Given the following code](https://play.rust-lang.org/?gist=e60e99a855bb39eeda0fd3c2eb1383e4&version=nightly&mode=debug&edition=2015)\r\n\r\n```rust\r\nfn foo(_: u16) {}\r\nfn main() {\r\n    foo(8u8);\r\n}\r\n```\r\n\r\nwe currently suggest using `.into()` to turn the `u8` literal into a `u16`\r\n\r\n```rust\r\nerror[E0308]: mismatched types\r\n --> src/main.rs:3:9\r\n  |\r\n3 |     foo(8u8);\r\n  |         ^^^ expected u16, found u8\r\nhelp: you can cast an `u8` to `u16`, which will zero-extend the source value\r\n  |\r\n3 |     foo(8u8.into());\r\n  |         ^^^^^^^^^^\r\n```\r\n\r\nWe should suggest changing the literal directly when appropriate in the following way:\r\n\r\n```rust\r\nerror[E0308]: mismatched types\r\n --> src/main.rs:3:9\r\n  |\r\n3 |     foo(8u8);\r\n  |         ^^^ expected u16, found u8\r\nhelp: change the type of the numeric literal from `u8` to `u16`\r\n  |\r\n3 |     foo(8u16);\r\n  |         ^^^^\r\n```\r\n\r\nThis has the added benefit that we can look at the literal and see if it would also fit when reducing the size (from 16 to 8, for example) if the literal would fit in the smaller type.\r\n\r\nThe current suggestion is implemented in [`check_for_cast`]( https://github.com/estebank/rust/blob/47a8eb7c4e24b61a8a9ab4eaff60ef65291aaa56/src/librustc_typeck/check/demand.rs#L315) and would require evaluating the `expr` to see if it is a literal with an explicit type suffix or not.", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/54160/reactions", "total_count": 2, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 1, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/54160/timeline", "performed_via_github_app": null, "state_reason": "completed"}