{"url": "https://api.github.com/repos/rust-lang/rust/issues/91714", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/91714/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/91714/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/91714/events", "html_url": "https://github.com/rust-lang/rust/issues/91714", "id": 1075769599, "node_id": "I_kwDOAAsO6M5AHvD_", "number": 91714, "title": "Make `rustdoc --passes` and `rustdoc --no-defaults` have no effect", "user": {"login": "jyn514", "id": 23638587, "node_id": "MDQ6VXNlcjIzNjM4NTg3", "avatar_url": "https://avatars.githubusercontent.com/u/23638587?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jyn514", "html_url": "https://github.com/jyn514", "followers_url": "https://api.github.com/users/jyn514/followers", "following_url": "https://api.github.com/users/jyn514/following{/other_user}", "gists_url": "https://api.github.com/users/jyn514/gists{/gist_id}", "starred_url": "https://api.github.com/users/jyn514/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jyn514/subscriptions", "organizations_url": "https://api.github.com/users/jyn514/orgs", "repos_url": "https://api.github.com/users/jyn514/repos", "events_url": "https://api.github.com/users/jyn514/events{/privacy}", "received_events_url": "https://api.github.com/users/jyn514/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 36996, "node_id": "MDU6TGFiZWwzNjk5Ng==", "url": "https://api.github.com/repos/rust-lang/rust/labels/E-easy", "name": "E-easy", "color": "02e10c", "default": false, "description": "Call for participation: Experience needed to fix: Easy / not much (good first issue)"}, {"id": 203738, "node_id": "MDU6TGFiZWwyMDM3Mzg=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-rustdoc", "name": "T-rustdoc", "color": "bfd4f2", "default": false, "description": "Relevant to the rustdoc team, which will review and decide on the PR/issue."}, {"id": 67766349, "node_id": "MDU6TGFiZWw2Nzc2NjM0OQ==", "url": "https://api.github.com/repos/rust-lang/rust/labels/E-mentor", "name": "E-mentor", "color": "02E10C", "default": false, "description": "Call for participation: This issue has a mentor. Use RustcContributor::new on Zulip for discussion."}, {"id": 919710011, "node_id": "MDU6TGFiZWw5MTk3MTAwMTE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/disposition-merge", "name": "disposition-merge", "color": "008800", "default": false, "description": "This issue / PR is in PFCP or FCP with a disposition to merge it."}, {"id": 923282386, "node_id": "MDU6TGFiZWw5MjMyODIzODY=", "url": "https://api.github.com/repos/rust-lang/rust/labels/finished-final-comment-period", "name": "finished-final-comment-period", "color": "f9e189", "default": false, "description": "The final comment period is finished for this PR / Issue."}, {"id": 1206122880, "node_id": "MDU6TGFiZWwxMjA2MTIyODgw", "url": "https://api.github.com/repos/rust-lang/rust/labels/needs-fcp", "name": "needs-fcp", "color": "fceb9f", "default": false, "description": "This change is insta-stable, so needs a completed FCP to proceed."}], "state": "closed", "locked": false, "assignee": {"login": "pitaj", "id": 803701, "node_id": "MDQ6VXNlcjgwMzcwMQ==", "avatar_url": "https://avatars.githubusercontent.com/u/803701?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pitaj", "html_url": "https://github.com/pitaj", "followers_url": "https://api.github.com/users/pitaj/followers", "following_url": "https://api.github.com/users/pitaj/following{/other_user}", "gists_url": "https://api.github.com/users/pitaj/gists{/gist_id}", "starred_url": "https://api.github.com/users/pitaj/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pitaj/subscriptions", "organizations_url": "https://api.github.com/users/pitaj/orgs", "repos_url": "https://api.github.com/users/pitaj/repos", "events_url": "https://api.github.com/users/pitaj/events{/privacy}", "received_events_url": "https://api.github.com/users/pitaj/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "pitaj", "id": 803701, "node_id": "MDQ6VXNlcjgwMzcwMQ==", "avatar_url": "https://avatars.githubusercontent.com/u/803701?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pitaj", "html_url": "https://github.com/pitaj", "followers_url": "https://api.github.com/users/pitaj/followers", "following_url": "https://api.github.com/users/pitaj/following{/other_user}", "gists_url": "https://api.github.com/users/pitaj/gists{/gist_id}", "starred_url": "https://api.github.com/users/pitaj/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pitaj/subscriptions", "organizations_url": "https://api.github.com/users/pitaj/orgs", "repos_url": "https://api.github.com/users/pitaj/repos", "events_url": "https://api.github.com/users/pitaj/events{/privacy}", "received_events_url": "https://api.github.com/users/pitaj/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 11, "created_at": "2021-12-09T16:31:14Z", "updated_at": "2021-12-23T17:03:26Z", "closed_at": "2021-12-20T07:30:12Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Currently, `rustdoc --passes` does one of two things:\r\n1. `--passes list` shows a list of available passes:\r\n```\r\nAvailable passes for running rustdoc:\r\ncheck_doc_test_visibility - run various visibility-related lints on doctests\r\n        strip-hidden - strips all `#[doc(hidden)]` items from the output\r\n   unindent-comments - removes excess indentation on comments in order for markdown to like it\r\n       strip-private - strips all private items from a crate which cannot be seen externally, implies strip-priv-imports\r\n  strip-priv-imports - strips all private import statements (`use`, `extern crate`) from a crate\r\n   propagate-doc-cfg - propagates `#[doc(cfg(...))]` to child items\r\ncollect-intra-doc-links - resolves intra-doc links\r\ncheck-code-block-syntax - validates syntax inside Rust code blocks\r\n collect-trait-impls - retrieves trait impls for items in the crate\r\ncalculate-doc-coverage - counts the number of items with and without documentation\r\ncheck-invalid-html-tags - detects invalid HTML tags in doc comments\r\n     check-bare-urls - detects URLs that are not hyperlinks\r\n\r\nDefault passes for rustdoc:\r\n collect-trait-impls\r\n   unindent-comments\r\ncheck_doc_test_visibility\r\n        strip-hidden  (when not --document-hidden-items)\r\n       strip-private  (when not --document-private-items)\r\n  strip-priv-imports  (when --document-private-items)\r\ncollect-intra-doc-links\r\ncheck-code-block-syntax\r\ncheck-invalid-html-tags\r\n   propagate-doc-cfg\r\n     check-bare-urls\r\n\r\nPasses run with `--show-coverage`:\r\n        strip-hidden  (when not --document-hidden-items)\r\n       strip-private  (when not --document-private-items)\r\ncalculate-doc-coverage\r\n```\r\n2. `rustdoc --passes collect-trait-impls` will add that specific pass to the list of passes rustdoc executes (I think this is intended to be used with `--no-defaults`, which is also deprecated).\r\n\r\nBoth of these are stable, so unfortunately we can't remove them; 2. is deprecated and 1. should be soon (after https://github.com/rust-lang/rust/issues/91713 is fixed). However, this is not a very useful sort of stability, because the names and number of passes is not stable, and rustdoc is very likely to be buggy if you don't run all passes (there's no sort of test for this).\r\n\r\nI propose not just deprecating `--passes` and `--no-defaults` but making them a no-op altogether, which means less complexity both for users and in the rustdoc codebase. I also suggest removing the CLI help at the same time (and just say \"this flag is a no-op\").\r\n\r\nNote that the only other deprecated flag, `--input-format`, is also currently a no-op when used with `--input-format rust`, and a hard error otherwise. We could go further and make everything but `--passes=list` be a hard error, but that seems like more of a breaking change than necessary for the goal of reducing complexity.\n\n<!-- TRIAGEBOT_START -->\n\n<!-- TRIAGEBOT_ASSIGN_START -->\n\n<!-- TRIAGEBOT_ASSIGN_DATA_START$${\"user\":\"pitaj\"}$$TRIAGEBOT_ASSIGN_DATA_END -->\n\n<!-- TRIAGEBOT_ASSIGN_END -->\n<!-- TRIAGEBOT_END -->", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/91714/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/91714/timeline", "performed_via_github_app": null, "state_reason": "completed"}