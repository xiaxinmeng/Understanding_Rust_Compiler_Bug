{"url": "https://api.github.com/repos/rust-lang/rust/issues/37906", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/37906/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/37906/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/37906/events", "html_url": "https://github.com/rust-lang/rust/issues/37906", "id": 190597591, "node_id": "MDU6SXNzdWUxOTA1OTc1OTE=", "number": 37906, "title": "rustbuild: linker error during 32 bit compilation", "user": {"login": "est31", "id": 8872119, "node_id": "MDQ6VXNlcjg4NzIxMTk=", "avatar_url": "https://avatars.githubusercontent.com/u/8872119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/est31", "html_url": "https://github.com/est31", "followers_url": "https://api.github.com/users/est31/followers", "following_url": "https://api.github.com/users/est31/following{/other_user}", "gists_url": "https://api.github.com/users/est31/gists{/gist_id}", "starred_url": "https://api.github.com/users/est31/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/est31/subscriptions", "organizations_url": "https://api.github.com/users/est31/orgs", "repos_url": "https://api.github.com/users/est31/repos", "events_url": "https://api.github.com/users/est31/events{/privacy}", "received_events_url": "https://api.github.com/users/est31/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 325438536, "node_id": "MDU6TGFiZWwzMjU0Mzg1MzY=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-bootstrap", "name": "T-bootstrap", "color": "bfd4f2", "default": false, "description": "Relevant to the bootstrap subteam: Rust's build system (x.py and src/bootstrap)"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2016-11-21T00:59:34Z", "updated_at": "2016-12-04T14:37:46Z", "closed_at": "2016-12-04T14:37:46Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I'm on a 64 bit OS and want to test 32 bit rust so that I can confirm the intrinsics for #37900 work. But unfortunately, rustbuild doesn't even get so far and fails with an error early on. Obviously, I've tested without the PR too, but same result. The results below are all from a test run after a git checkout to current master (commit 4bc929013396eede8a22a3e7932fb3a63d2a11da), `git clean -xfd` to get rid of all artifacts and taking config.toml from config.toml.example and changing two things: setting `build = \"i686-unknown-linux-gnu\"` and `codegen-units = 1`. I've also tested with letting codegen-units as default, but same result (the logs are still from the test run with `codegen-units == 1` but I guess there is no difference).\r\n\r\nThe relevant part of the [full build log](http://paste.ubuntu.com/23509533/):\r\n\r\n```\r\n/usr/bin/ld: ~/src/rust/build/i686-unknown-linux-gnu/stage0-sysroot/lib/rustlib/i686-unknown-linux-gnu/lib/libstd-b0aea2b84e953509.so: __umoddi3: invalid version 21 (max 0)\r\n~/src/rust/build/i686-unknown-linux-gnu/stage0-sysroot/lib/rustlib/i686-unknown-linux-gnu/lib/libstd-b0aea2b84e953509.so: error adding symbols: Ung\u00fcltiger Wert\r\n```\r\n\r\nreadelf on the file in question gives:\r\n\r\n```\r\n$ readelf -s ~/src/rust/build/i686-unknown-linux-gnu/stage0-sysroot/lib/rustlib/i686-unknown-linux-gnu/lib/libstd-b0aea2b84e953509.so | rg __umoddi3\r\n1638:  1634: 000ad4ac    41 FUNC    GLOBAL DEFAULT   12 __umoddi3@GLIBC_2.3.3 (21)\r\n5674:  3055: 000ad4ac    41 FUNC    GLOBAL DEFAULT   12 __umoddi3\r\n```", "closed_by": {"login": "est31", "id": 8872119, "node_id": "MDQ6VXNlcjg4NzIxMTk=", "avatar_url": "https://avatars.githubusercontent.com/u/8872119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/est31", "html_url": "https://github.com/est31", "followers_url": "https://api.github.com/users/est31/followers", "following_url": "https://api.github.com/users/est31/following{/other_user}", "gists_url": "https://api.github.com/users/est31/gists{/gist_id}", "starred_url": "https://api.github.com/users/est31/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/est31/subscriptions", "organizations_url": "https://api.github.com/users/est31/orgs", "repos_url": "https://api.github.com/users/est31/repos", "events_url": "https://api.github.com/users/est31/events{/privacy}", "received_events_url": "https://api.github.com/users/est31/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/37906/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/37906/timeline", "performed_via_github_app": null, "state_reason": "completed"}