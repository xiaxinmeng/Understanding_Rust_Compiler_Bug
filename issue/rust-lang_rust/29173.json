{"url": "https://api.github.com/repos/rust-lang/rust/issues/29173", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/29173/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/29173/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/29173/events", "html_url": "https://github.com/rust-lang/rust/issues/29173", "id": 112244353, "node_id": "MDU6SXNzdWUxMTIyNDQzNTM=", "number": 29173, "title": "Possibly Erroneous E0384 on Some Version of Compilers", "user": {"login": "devonhollowood", "id": 7864326, "node_id": "MDQ6VXNlcjc4NjQzMjY=", "avatar_url": "https://avatars.githubusercontent.com/u/7864326?v=4", "gravatar_id": "", "url": "https://api.github.com/users/devonhollowood", "html_url": "https://github.com/devonhollowood", "followers_url": "https://api.github.com/users/devonhollowood/followers", "following_url": "https://api.github.com/users/devonhollowood/following{/other_user}", "gists_url": "https://api.github.com/users/devonhollowood/gists{/gist_id}", "starred_url": "https://api.github.com/users/devonhollowood/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/devonhollowood/subscriptions", "organizations_url": "https://api.github.com/users/devonhollowood/orgs", "repos_url": "https://api.github.com/users/devonhollowood/repos", "events_url": "https://api.github.com/users/devonhollowood/events{/privacy}", "received_events_url": "https://api.github.com/users/devonhollowood/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2015-10-19T22:16:10Z", "updated_at": "2015-10-20T09:02:12Z", "closed_at": "2015-10-20T09:02:12Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Recently during [this reddit discussion](https://www.reddit.com/r/rust/comments/3p8vsd/start_loop_over_from_inside_a_closure/cw4bxug) it became clear that there exists some code which produces an E0384 error (reassignment of immutable variable) for /u/crossroads1112 and not for me (/u/VikingofRock). The code in question:\n\n```\nuse std::io;\n\nfn main() {\n    let vec: Vec<f64>;\n    loop {\n        let mut buffer = String::new();\n        io::stdin().read_line(&mut buffer)\n            .ok()\n            .expect(\"Could not read input\");\n        let result: Result<Vec<f64>, _> =\n            buffer.trim().split(\",\").map(|s| s.parse()).collect();\n        vec = match result{\n            Ok(v) => v,\n            Err(_) => continue,\n        };\n        for i in &vec {\n            println!(\"{}\", i);\n        }\n        break;\n    }\n}\n```\n\nThis compiles without error for me, but /u/crossroads1112's rustc gives:\n\n```\n./test.rs:12:9: 15:10 error: re-assignment of immutable variable `vec` [E0384]\n./test.rs:12         vec = match result {\n./test.rs:13             Ok(v) => v,\n./test.rs:14             Err(_) => continue,\n./test.rs:15         };  \n./test.rs:12:9: 15:10 note: prior assignment occurs here\n./test.rs:12         vec = match result {\n./test.rs:13             Ok(v) => v,\n./test.rs:14             Err(_) => continue,\n./test.rs:15         }; \n```\n\nIt is not quite clear to me what the expected behavior is here. It seems as though `vec` does not logically need to be mutable, but it is somewhat surprising to me that the compiler can understand the code well enough to determine that.\n## Meta\n\nI tested on the following rustc versions:\n\n```\nrustc 1.3.0 (9a92aaf19 2015-09-15)\nbinary: rustc\ncommit-hash: 9a92aaf19a64603b02b4130fe52958cc12488900\ncommit-date: 2015-09-15\nhost: x86_64-apple-darwin\nrelease: 1.3.0\n\nrustc 1.5.0-nightly (206af38e7 2015-10-17)\nbinary: rustc\ncommit-hash: 206af38e74ce7fa4b0e781ece7f1067c018c580e\ncommit-date: 2015-10-17\nhost: x86_64-apple-darwin\nrelease: 1.5.0-nightly\n```\n\nBoth were installed using multirust. I have directed /u/crossroads1112 to this issue, and asked him to post his output of rustc --version --verbose as well.\n", "closed_by": {"login": "arielb1", "id": 1830974, "node_id": "MDQ6VXNlcjE4MzA5NzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1830974?v=4", "gravatar_id": "", "url": "https://api.github.com/users/arielb1", "html_url": "https://github.com/arielb1", "followers_url": "https://api.github.com/users/arielb1/followers", "following_url": "https://api.github.com/users/arielb1/following{/other_user}", "gists_url": "https://api.github.com/users/arielb1/gists{/gist_id}", "starred_url": "https://api.github.com/users/arielb1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/arielb1/subscriptions", "organizations_url": "https://api.github.com/users/arielb1/orgs", "repos_url": "https://api.github.com/users/arielb1/repos", "events_url": "https://api.github.com/users/arielb1/events{/privacy}", "received_events_url": "https://api.github.com/users/arielb1/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/29173/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/29173/timeline", "performed_via_github_app": null, "state_reason": "completed"}