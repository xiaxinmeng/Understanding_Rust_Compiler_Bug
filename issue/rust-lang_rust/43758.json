{"url": "https://api.github.com/repos/rust-lang/rust/issues/43758", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/43758/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/43758/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/43758/events", "html_url": "https://github.com/rust-lang/rust/issues/43758", "id": 248943430, "node_id": "MDU6SXNzdWUyNDg5NDM0MzA=", "number": 43758, "title": "wasm32-unknown-emscripten target isn't working", "user": {"login": "aleksmelnikov", "id": 22053918, "node_id": "MDQ6VXNlcjIyMDUzOTE4", "avatar_url": "https://avatars.githubusercontent.com/u/22053918?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aleksmelnikov", "html_url": "https://github.com/aleksmelnikov", "followers_url": "https://api.github.com/users/aleksmelnikov/followers", "following_url": "https://api.github.com/users/aleksmelnikov/following{/other_user}", "gists_url": "https://api.github.com/users/aleksmelnikov/gists{/gist_id}", "starred_url": "https://api.github.com/users/aleksmelnikov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aleksmelnikov/subscriptions", "organizations_url": "https://api.github.com/users/aleksmelnikov/orgs", "repos_url": "https://api.github.com/users/aleksmelnikov/repos", "events_url": "https://api.github.com/users/aleksmelnikov/events{/privacy}", "received_events_url": "https://api.github.com/users/aleksmelnikov/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2017-08-09T07:40:09Z", "updated_at": "2017-08-09T10:05:14Z", "closed_at": "2017-08-09T10:05:14Z", "author_association": "NONE", "active_lock_reason": null, "body": "$ uname -a\r\nLinux archlin 4.12.4-1-ARCH #1 SMP PREEMPT Fri Jul 28 18:54:18 UTC 2017 x86_64 GNU/Linux\r\n\r\n$ emcc -v\r\nemcc (Emscripten gcc/clang-like replacement + linker emulating GNU ld) 1.37.18\r\nclang version 4.0.0  (emscripten 1.37.18 : 1.37.18)\r\nTarget: x86_64-unknown-linux-gnu\r\nThread model: posix\r\nInstalledDir: /usr/lib/emscripten-fastcomp\r\nFound candidate GCC installation: /usr/lib/gcc/x86_64-pc-linux-gnu/7.1.1\r\nFound candidate GCC installation: /usr/lib64/gcc/x86_64-pc-linux-gnu/7.1.1\r\nSelected GCC installation: /usr/lib64/gcc/x86_64-pc-linux-gnu/7.1.1\r\nCandidate multilib: .;@m64\r\nSelected multilib: .;@m64\r\nINFO:root:(Emscripten: Running sanity checks)\r\nWARNING:root:java does not seem to exist, required for closure compiler, which is optional (define JAVA in /root/.emscripten if you want it)\r\nWARNING:root:closure compiler will not be available\r\n\r\n$ cat hello.c\r\n#include <stdio.h>\r\nint main() {\r\n    printf(\"Hello World!\\n\");\r\n}\r\n\r\n$ emcc hello.c\r\n\r\n$ node a.out.js\r\nHello World!\r\n\r\n-------------------------\r\nSo, I think emcc is good.\r\n-------------------------\r\n\r\n$ rustc --version\r\nrustc 1.19.0 (0ade33941 2017-07-17)\r\n\r\n$ rustup target list | grep emscripten\r\nasmjs-unknown-emscripten (installed)\r\nwasm32-unknown-emscripten (installed)\r\n\r\n$ cat hello.rs\r\nfn main() {\r\n    println!(\"Hello World!\");\r\n}\r\n\r\n$ rustc --target=wasm32-unknown-emscripten hello.rs\r\nerror: linking with `emcc` failed: exit code: 1\r\n  |\r\n  = note: \"emcc\" \"-s\" \"DISABLE_EXCEPTION_CATCHING=0\" \"-L\" \"/root/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/lib/rustlib/wasm32-unknown-emscripten/lib\" \"hello.0.o\" \"-o\" \"hello.js\" \"-s\" \"EXPORTED_FUNCTIONS=[\\\"_main\\\",\\\"_rust_eh_personality\\\"]\" \"-O0\" \"--memory-init-file\" \"0\" \"-g0\" \"-s\" \"DEFAULT_LIBRARY_FUNCS_TO_INCLUDE=[]\" \"-L\" \"/root/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/lib/rustlib/wasm32-unknown-emscripten/lib\" \"/root/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/lib/rustlib/wasm32-unknown-emscripten/lib/libstd-35ad9950c7e5074b.rlib\" \"/root/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/lib/rustlib/wasm32-unknown-emscripten/lib/librand-20a50a22d4c2b1e9.rlib\" \"/root/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/lib/rustlib/wasm32-unknown-emscripten/lib/libcollections-b479831207997444.rlib\" \"/root/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/lib/rustlib/wasm32-unknown-emscripten/lib/libstd_unicode-f4f0ae88f5ad8ad4.rlib\" \"/root/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/lib/rustlib/wasm32-unknown-emscripten/lib/libpanic_unwind-fb44afc024bbc636.rlib\" \"/root/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/lib/rustlib/wasm32-unknown-emscripten/lib/libunwind-14b8f3202acdad6a.rlib\" \"/root/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/lib/rustlib/wasm32-unknown-emscripten/lib/liballoc-10b591f1a68dd370.rlib\" \"/root/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/lib/rustlib/wasm32-unknown-emscripten/lib/liballoc_system-06d737faf6076d7c.rlib\" \"/root/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/lib/rustlib/wasm32-unknown-emscripten/lib/liblibc-6ecacccb5bdc4911.rlib\" \"/root/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/lib/rustlib/wasm32-unknown-emscripten/lib/libcore-bfaa82017ca17cb2.rlib\" \"/root/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/lib/rustlib/wasm32-unknown-emscripten/lib/libcompiler_builtins-863b57a66ba6c3e1.rlib\" \"-l\" \"c\" \"-s\" \"BINARYEN=1\" \"-s\" \"ERROR_ON_UNDEFINED_SYMBOLS=1\"\r\n  = note: Traceback (most recent call last):\r\n            File \"/usr/lib/emscripten/emcc.py\", line 2582, in <module>\r\n              run()\r\n            File \"/usr/lib/emscripten/emcc.py\", line 1785, in run\r\n              wasm_text_target, misc_temp_files, optimizer)\r\n            File \"/usr/lib/emscripten/emcc.py\", line 2256, in do_binaryen\r\n              subprocess.check_call(cmd)\r\n            File \"/usr/lib/python2.7/subprocess.py\", line 181, in check_call\r\n              retcode = call(*popenargs, **kwargs)\r\n            File \"/usr/lib/python2.7/subprocess.py\", line 168, in call\r\n              return Popen(*popenargs, **kwargs).wait()\r\n            File \"/usr/lib/python2.7/subprocess.py\", line 390, in __init__\r\n              errread, errwrite)\r\n            File \"/usr/lib/python2.7/subprocess.py\", line 1024, in _execute_child\r\n              raise child_exception\r\n          OSError: [Errno 2] No such file or directory\r\nerror: aborting due to previous error(s)", "closed_by": {"login": "aleksmelnikov", "id": 22053918, "node_id": "MDQ6VXNlcjIyMDUzOTE4", "avatar_url": "https://avatars.githubusercontent.com/u/22053918?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aleksmelnikov", "html_url": "https://github.com/aleksmelnikov", "followers_url": "https://api.github.com/users/aleksmelnikov/followers", "following_url": "https://api.github.com/users/aleksmelnikov/following{/other_user}", "gists_url": "https://api.github.com/users/aleksmelnikov/gists{/gist_id}", "starred_url": "https://api.github.com/users/aleksmelnikov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aleksmelnikov/subscriptions", "organizations_url": "https://api.github.com/users/aleksmelnikov/orgs", "repos_url": "https://api.github.com/users/aleksmelnikov/repos", "events_url": "https://api.github.com/users/aleksmelnikov/events{/privacy}", "received_events_url": "https://api.github.com/users/aleksmelnikov/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/43758/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/43758/timeline", "performed_via_github_app": null, "state_reason": "completed"}