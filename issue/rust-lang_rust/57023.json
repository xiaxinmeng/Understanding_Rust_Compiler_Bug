{"url": "https://api.github.com/repos/rust-lang/rust/issues/57023", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/57023/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/57023/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/57023/events", "html_url": "https://github.com/rust-lang/rust/issues/57023", "id": 393282962, "node_id": "MDU6SXNzdWUzOTMyODI5NjI=", "number": 57023, "title": "Nightly Type Alias Compiler panic `unexpected definition: TraitAlias`", "user": {"login": "jgrowl", "id": 90719, "node_id": "MDQ6VXNlcjkwNzE5", "avatar_url": "https://avatars.githubusercontent.com/u/90719?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jgrowl", "html_url": "https://github.com/jgrowl", "followers_url": "https://api.github.com/users/jgrowl/followers", "following_url": "https://api.github.com/users/jgrowl/following{/other_user}", "gists_url": "https://api.github.com/users/jgrowl/gists{/gist_id}", "starred_url": "https://api.github.com/users/jgrowl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jgrowl/subscriptions", "organizations_url": "https://api.github.com/users/jgrowl/orgs", "repos_url": "https://api.github.com/users/jgrowl/repos", "events_url": "https://api.github.com/users/jgrowl/events{/privacy}", "received_events_url": "https://api.github.com/users/jgrowl/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}, {"id": 13836860, "node_id": "MDU6TGFiZWwxMzgzNjg2MA==", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-traits", "name": "A-traits", "color": "f7e101", "default": false, "description": "Area: Trait system"}], "state": "closed", "locked": false, "assignee": {"login": "alexreg", "id": 67036, "node_id": "MDQ6VXNlcjY3MDM2", "avatar_url": "https://avatars.githubusercontent.com/u/67036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexreg", "html_url": "https://github.com/alexreg", "followers_url": "https://api.github.com/users/alexreg/followers", "following_url": "https://api.github.com/users/alexreg/following{/other_user}", "gists_url": "https://api.github.com/users/alexreg/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexreg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexreg/subscriptions", "organizations_url": "https://api.github.com/users/alexreg/orgs", "repos_url": "https://api.github.com/users/alexreg/repos", "events_url": "https://api.github.com/users/alexreg/events{/privacy}", "received_events_url": "https://api.github.com/users/alexreg/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "alexreg", "id": 67036, "node_id": "MDQ6VXNlcjY3MDM2", "avatar_url": "https://avatars.githubusercontent.com/u/67036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexreg", "html_url": "https://github.com/alexreg", "followers_url": "https://api.github.com/users/alexreg/followers", "following_url": "https://api.github.com/users/alexreg/following{/other_user}", "gists_url": "https://api.github.com/users/alexreg/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexreg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexreg/subscriptions", "organizations_url": "https://api.github.com/users/alexreg/orgs", "repos_url": "https://api.github.com/users/alexreg/repos", "events_url": "https://api.github.com/users/alexreg/events{/privacy}", "received_events_url": "https://api.github.com/users/alexreg/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2018-12-21T01:59:36Z", "updated_at": "2018-12-23T00:35:11Z", "closed_at": "2018-12-23T00:35:11Z", "author_association": "NONE", "active_lock_reason": null, "body": "The compiler panics when using generics in trait aliases. I tried to reduce the code as much as I could while preserving the error so I apologize if it does not make any sense. Basically I had created a couple of different libraries that depended on each other. \r\n\r\nThe first library created a multi parameter generic type alias\r\nThe second library used that alias to define a slightly less generic trait alias\r\nThe third used the second to create a trait with all concrete types\r\n\r\nI attempted to collapse some of the code to use less generics and crates, so it probably won't make sense why you'd write code like this, but it should show the error regardless.\r\n\r\nI tried this code:\r\n\r\nhttps://github.com/jgrowl/rust_nightly_790f4c566_2018-12-19_trait_alias_bug\r\n\r\nI expected to not get a compiler panic\r\n\r\n## Meta\r\n\r\n```\r\nrustc 1.33.0-nightly (790f4c566 2018-12-19)\r\nbinary: rustc\r\ncommit-hash: 790f4c566d9802dfcadc26398dde2051cfe6ec9f\r\ncommit-date: 2018-12-19\r\nhost: x86_64-apple-darwin\r\nrelease: 1.33.0-nightly\r\nLLVM version: 8.0\r\n```\r\n\r\nBacktrace:\r\n\r\n```\r\n\u279c  rust_nightly_790f4c566_2018-12-19_trait_alias_bug git:(master) RUST_BACKTRACE=1 cargo test --lib\r\n   Compiling rust_nightly_790f4c566_2018-12-19_trait_alias_bug v0.1.0 (/Users/jonathan/Code/github.com/jgrowl/rust_nightly_790f4c566_2018-12-19_trait_alias_bug)\r\nthread 'main' panicked at 'src/librustc_resolve/build_reduced_graph.rs:693: unexpected definition: TraitAlias(DefId(10/0:9))', src/librustc/util/bug.rs:47:26\r\nstack backtrace:\r\n   0: std::sys::unix::backtrace::tracing::imp::unwind_backtrace\r\n   1: std::sys_common::backtrace::_print\r\n   2: std::panicking::default_hook::{{closure}}\r\n   3: std::panicking::default_hook\r\n   4: rustc::util::common::panic_hook\r\n   5: std::panicking::rust_panic_with_hook\r\n   6: std::panicking::begin_panic\r\n   7: rustc::util::bug::opt_span_bug_fmt::{{closure}}\r\n   8: rustc::ty::context::tls::with_opt::{{closure}}\r\n   9: rustc::ty::context::tls::with_context_opt\r\n  10: rustc::ty::context::tls::with_opt\r\n  11: rustc::util::bug::opt_span_bug_fmt\r\n  12: rustc::util::bug::bug_fmt\r\n  13: rustc_resolve::build_reduced_graph::<impl rustc_resolve::Resolver<'a>>::populate_module_if_necessary\r\n  14: rustc_resolve::Resolver::lookup_import_candidates_from_module\r\n  15: rustc_resolve::Resolver::resolve_path\r\n  16: rustc_resolve::resolve_imports::ImportResolver::resolve_imports\r\n  17: rustc_resolve::macros::<impl syntax::ext::base::Resolver for rustc_resolve::Resolver<'a>>::resolve_imports\r\n  18: syntax::ext::expand::MacroExpander::expand_fragment\r\n  19: syntax::ext::expand::MacroExpander::expand_crate\r\n  20: rustc_driver::driver::phase_2_configure_and_expand_inner::{{closure}}\r\n  21: rustc::util::common::time\r\n  22: rustc_driver::driver::phase_2_configure_and_expand\r\n  23: rustc_driver::driver::compile_input\r\n  24: rustc_driver::run_compiler_with_pool\r\n  25: <scoped_tls::ScopedKey<T>>::set\r\n  26: rustc_driver::run_compiler\r\n  27: <scoped_tls::ScopedKey<T>>::set\r\n  28: syntax::with_globals\r\n  29: __rust_maybe_catch_panic\r\n  30: rustc_driver::run\r\n  31: rustc_driver::main\r\n  32: std::rt::lang_start::{{closure}}\r\n  33: std::panicking::try::do_call\r\n  34: __rust_maybe_catch_panic\r\n  35: std::rt::lang_start_internal\r\n  36: main\r\nquery stack during panic:\r\nend of query stack\r\n\r\nerror: internal compiler error: unexpected panic\r\n\r\nnote: the compiler unexpectedly panicked. this is a bug.\r\n\r\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports\r\n\r\nnote: rustc 1.33.0-nightly (790f4c566 2018-12-19) running on x86_64-apple-darwin\r\n\r\nnote: compiler flags: -C debuginfo=2 -C incremental\r\n\r\nnote: some of the compiler flags provided by cargo are hidden\r\n\r\nerror: Could not compile `rust_nightly_790f4c566_2018-12-19_trait_alias_bug`.\r\n\r\nTo learn more, run the command again with --verbose.\r\n```", "closed_by": {"login": "jgrowl", "id": 90719, "node_id": "MDQ6VXNlcjkwNzE5", "avatar_url": "https://avatars.githubusercontent.com/u/90719?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jgrowl", "html_url": "https://github.com/jgrowl", "followers_url": "https://api.github.com/users/jgrowl/followers", "following_url": "https://api.github.com/users/jgrowl/following{/other_user}", "gists_url": "https://api.github.com/users/jgrowl/gists{/gist_id}", "starred_url": "https://api.github.com/users/jgrowl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jgrowl/subscriptions", "organizations_url": "https://api.github.com/users/jgrowl/orgs", "repos_url": "https://api.github.com/users/jgrowl/repos", "events_url": "https://api.github.com/users/jgrowl/events{/privacy}", "received_events_url": "https://api.github.com/users/jgrowl/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/57023/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/57023/timeline", "performed_via_github_app": null, "state_reason": "completed"}