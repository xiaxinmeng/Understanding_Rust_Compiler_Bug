{"url": "https://api.github.com/repos/rust-lang/rust/issues/74895", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/74895/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/74895/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/74895/events", "html_url": "https://github.com/rust-lang/rust/issues/74895", "id": 667526733, "node_id": "MDU6SXNzdWU2Njc1MjY3MzM=", "number": 74895, "title": "Permissions::readonly() doesn't behave as expected with files", "user": {"login": "Firstyear", "id": 271005, "node_id": "MDQ6VXNlcjI3MTAwNQ==", "avatar_url": "https://avatars.githubusercontent.com/u/271005?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Firstyear", "html_url": "https://github.com/Firstyear", "followers_url": "https://api.github.com/users/Firstyear/followers", "following_url": "https://api.github.com/users/Firstyear/following{/other_user}", "gists_url": "https://api.github.com/users/Firstyear/gists{/gist_id}", "starred_url": "https://api.github.com/users/Firstyear/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Firstyear/subscriptions", "organizations_url": "https://api.github.com/users/Firstyear/orgs", "repos_url": "https://api.github.com/users/Firstyear/repos", "events_url": "https://api.github.com/users/Firstyear/events{/privacy}", "received_events_url": "https://api.github.com/users/Firstyear/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 234902, "node_id": "MDU6TGFiZWwyMzQ5MDI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-enhancement", "name": "C-enhancement", "color": "f5f1fd", "default": false, "description": "Category: An issue proposing an enhancement or a PR with one."}, {"id": 431251592, "node_id": "MDU6TGFiZWw0MzEyNTE1OTI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-docs", "name": "A-docs", "color": "f7e101", "default": false, "description": "Area: documentation for any part of the project, including the compiler, standard library, and tools"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 13, "created_at": "2020-07-29T03:52:04Z", "updated_at": "2022-10-24T04:14:42Z", "closed_at": "2022-10-24T04:14:42Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "When using the Permissions module on MacOS it doesn't behave as expected. Readonly returns if the file lacks *any* write bits, rather than returning if the current calling uid/gid can write to the file. This can be seen in the code:\r\n\r\nhttps://github.com/rust-lang/rust/blob/master/library/std/src/sys/unix/fs.rs#L359\r\n\r\nThis is a bit misleading because the framing of https://doc.rust-lang.org/std/fs/struct.Permissions.html#method.readonly seems to say \"an unwritable file\" without context which to me I interpretted as \"unwritable file - by the current user\" not unwriteable by all permission bits. \r\n\r\nI'd be happy with a disclaimer on the documentation of readonly to indicate this only checks that no write bits exist on unix so that it's clearer what it's checking for, but I'd also be happy if this function was altered to check 'is it readonly in the current calling context' but I understand that's a really challenging problem in-itself given posix acls etc. \r\n\r\nI expected to see this happen: A file as `root:root 640` should be readonly == true when called from \"william:william\"\r\n\r\nInstead, this happened: The file is listed as \"not\" readonly even though the current user can not write the file OR the documentation about what readonly() does clearly explains what it is looking for on each operating system. \r\n\r\nThanks! \r\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/74895/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/74895/timeline", "performed_via_github_app": null, "state_reason": "completed"}