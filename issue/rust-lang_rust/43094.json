{"url": "https://api.github.com/repos/rust-lang/rust/issues/43094", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/43094/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/43094/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/43094/events", "html_url": "https://github.com/rust-lang/rust/issues/43094", "id": 241071312, "node_id": "MDU6SXNzdWUyNDEwNzEzMTI=", "number": 43094, "title": "unix::fs::OpenOptions get_access_mode EINVAL", "user": {"login": "raggi", "id": 348, "node_id": "MDQ6VXNlcjM0OA==", "avatar_url": "https://avatars.githubusercontent.com/u/348?v=4", "gravatar_id": "", "url": "https://api.github.com/users/raggi", "html_url": "https://github.com/raggi", "followers_url": "https://api.github.com/users/raggi/followers", "following_url": "https://api.github.com/users/raggi/following{/other_user}", "gists_url": "https://api.github.com/users/raggi/gists{/gist_id}", "starred_url": "https://api.github.com/users/raggi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/raggi/subscriptions", "organizations_url": "https://api.github.com/users/raggi/orgs", "repos_url": "https://api.github.com/users/raggi/repos", "events_url": "https://api.github.com/users/raggi/events{/privacy}", "received_events_url": "https://api.github.com/users/raggi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 123110, "node_id": "MDU6TGFiZWwxMjMxMTA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/O-linux", "name": "O-linux", "color": "6e6ec0", "default": false, "description": "Operating system: Linux"}, {"id": 211668062, "node_id": "MDU6TGFiZWwyMTE2NjgwNjI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-libs-api", "name": "T-libs-api", "color": "bfd4f2", "default": false, "description": "Relevant to the library API team, which will review and decide on the PR/issue."}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2017-07-06T20:09:02Z", "updated_at": "2017-10-05T22:41:56Z", "closed_at": "2017-10-05T22:41:56Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I am doing some integration work trying to use Rust in Fuchsia and one of the tasks I am doing requires performing an ioctl on a directory in order to mount. The system requires that the directory is opened with and O_ADMIN flag, which can be applied using `std::os::unix::fs::OpenOptionsExt`.\r\n\r\nI was receiving a spurious EINVAL result for the following code:\r\n\r\n```\r\nOpenOptions::new()\r\n        .custom_flags(O_ADMIN | O_DIRECTORY)\r\n        .open(\"/mydir\")\r\n```\r\n\r\nAfter some time, I tracked this down to the `get_access_mode` method here: https://github.com/rust-lang/rust/blob/master/src/libstd/sys/unix/fs.rs#L394\r\n\r\nI believe the behavior of this case in this method is incorrect. It is not necessarily invalid for all use cases of open(2) to not have an access mode set. For the purposes of certain fcntl and ioctl calls on many different unix platforms, no access mode is strictly required. I propose removing this case.", "closed_by": {"login": "raggi", "id": 348, "node_id": "MDQ6VXNlcjM0OA==", "avatar_url": "https://avatars.githubusercontent.com/u/348?v=4", "gravatar_id": "", "url": "https://api.github.com/users/raggi", "html_url": "https://github.com/raggi", "followers_url": "https://api.github.com/users/raggi/followers", "following_url": "https://api.github.com/users/raggi/following{/other_user}", "gists_url": "https://api.github.com/users/raggi/gists{/gist_id}", "starred_url": "https://api.github.com/users/raggi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/raggi/subscriptions", "organizations_url": "https://api.github.com/users/raggi/orgs", "repos_url": "https://api.github.com/users/raggi/repos", "events_url": "https://api.github.com/users/raggi/events{/privacy}", "received_events_url": "https://api.github.com/users/raggi/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/43094/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/43094/timeline", "performed_via_github_app": null, "state_reason": "completed"}