{"url": "https://api.github.com/repos/rust-lang/rust/issues/38620", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/38620/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/38620/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/38620/events", "html_url": "https://github.com/rust-lang/rust/issues/38620", "id": 197614089, "node_id": "MDU6SXNzdWUxOTc2MTQwODk=", "number": 38620, "title": "Spurious failure in incremental\\cache_file_headers.rs on Windows", "user": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 123109, "node_id": "MDU6TGFiZWwxMjMxMDk=", "url": "https://api.github.com/repos/rust-lang/rust/labels/O-windows", "name": "O-windows", "color": "6e6ec0", "default": false, "description": "Operating system: Windows"}, {"id": 371266501, "node_id": "MDU6TGFiZWwzNzEyNjY1MDE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-spurious", "name": "A-spurious", "color": "f7e101", "default": false, "description": "Area: Spurious failures in builds (spuriously == for no apparent reason)"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2016-12-26T19:26:40Z", "updated_at": "2017-04-13T21:54:37Z", "closed_at": "2017-04-13T21:54:37Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "I've seen [this failure](https://ci.appveyor.com/project/rust-lang/rust/build/1.0.1263/job/2ojivhva8umurjyf) a number of times on AppVeyor at this point:\r\n\r\n```\r\nCheck compiletest suite=incremental mode=incremental (x86_64-pc-windows-msvc -> x86_64-pc-windows-msvc)\r\nrunning 69 tests\r\nF....................................................................\r\nfailures:\r\n---- [incremental] incremental\\cache_file_headers.rs stdout ----\r\n\t\r\nerror in revision `rpass2`: compilation failed!\r\nstatus: exit code: 101\r\ncommand: PATH=\"C:\\projects\\rust\\build\\x86_64-pc-windows-msvc\\stage2\\bin;C:\\Program Files (x86)\\Windows Kits\\10\\bin\\x64;C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\bin\\amd64;C:\\projects\\rust\\build\\x86_64-pc-windows-msvc\\stage2-tools\\x86_64-pc-windows-msvc\\release\\deps;C:\\projects\\rust\\build\\x86_64-pc-windows-msvc\\stage2-rustc\\x86_64-pc-windows-msvc\\release\\deps;C:\\projects\\rust\\build\\x86_64-pc-windows-msvc\\stage2-test\\x86_64-pc-windows-msvc\\release\\deps;C:\\projects\\rust\\build\\x86_64-pc-windows-msvc\\stage2-std\\x86_64-pc-windows-msvc\\release\\deps;C:\\msys64\\mingw64\\bin;C:\\msys64\\mingw64\\bin;C:\\msys64\\usr\\bin;C:\\Perl\\site\\bin;C:\\Perl\\bin;C:\\Windows\\system32;C:\\Windows;C:\\Windows\\System32\\Wbem;C:\\Windows\\System32\\WindowsPowerShell\\v1.0;C:\\Program Files\\7-Zip;C:\\Program Files\\Microsoft\\Web Platform Installer;C:\\Tools\\GitVersion;C:\\Tools\\PsTools;C:\\Program Files\\Git LFS;C:\\Program Files\\Mercurial;C:\\Program Files (x86)\\Subversion\\bin;C:\\Program Files\\Microsoft SQL Server\\120\\Tools\\Binn;C:\\Program Files\\Microsoft SQL Server\\Client SDK\\ODBC\\110\\Tools\\Binn;C:\\Program Files (x86)\\Microsoft SQL Server\\120\\Tools\\Binn;C:\\Program Files\\Microsoft SQL Server\\120\\DTS\\Binn;C:\\Program Files (x86)\\Microsoft SQL Server\\120\\Tools\\Binn\\ManagementStudio;C:\\Program Files\\Microsoft Windows Performance Toolkit;C:\\Program Files (x86)\\Windows Kits\\8.1\\Windows Performance Toolkit;C:\\Tools\\WebDriver;C:\\Program Files (x86)\\Microsoft SDKs\\TypeScript\\1.4;C:\\Program Files (x86)\\Microsoft Visual Studio 12.0\\Common7\\IDE\\PrivateAssemblies;C:\\Program Files (x86)\\Microsoft SDKs\\Azure\\CLI\\wbin;C:\\Ruby193\\bin;C:\\Tools\\NUnit\\bin;C:\\Tools\\xUnit;C:\\Tools\\MSpec;C:\\Tools\\Coverity\\bin;C:\\Program Files (x86)\\CMake\\bin;C:\\go\\bin;C:\\Program Files\\Java\\jdk1.8.0\\bin;C:\\Python27;C:\\Program Files\\erl7.3\\bin;C:\\Program Files\\nodejs;C:\\Program Files (x86)\\iojs;C:\\Program Files\\iojs;C:\\Users\\appveyor\\AppData\\Roaming\\npm;C:\\Program Files\\Microsoft SQL Server\\130\\Tools\\Binn;C:\\Program Files (x86)\\Windows Kits\\10\\Windows Performance Toolkit;C:\\Program Files (x86)\\MSBuild\\14.0\\Bin;C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\Common7\\IDE\\Extensions\\Microsoft\\SQLDB\\DAC\\120;C:\\Tools\\NuGet;C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\Common7\\IDE\\CommonExtensions\\Microsoft\\TestWindow;C:\\Program Files\\Amazon\\AWSCLI;C:\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\Modules\\TShell\\TShell;C:\\Program Files\\Microsoft DNX\\Dnvm;C:\\Program Files\\Microsoft SQL Server\\Client SDK\\ODBC\\130\\Tools\\Binn;C:\\Program Files\\Git\\cmd;C:\\Program Files\\Git\\usr\\bin;C:\\Program Files (x86)\\Microsoft SQL Server\\130\\Tools\\Binn;C:\\Program Files (x86)\\Microsoft SQL Server\\130\\DTS\\Binn;C:\\Program Files\\Microsoft SQL Server\\130\\DTS\\Binn;C:\\Program Files (x86)\\Microsoft SQL Server\\110\\DTS\\Binn;C:\\Program Files (x86)\\Microsoft SQL Server\\120\\DTS\\Binn;C:\\Program Files (x86)\\Apache\\Maven\\bin;C:\\Program Files\\LLVM\\bin;C:\\ProgramData\\chocolatey\\bin;C:\\Program Files\\Microsoft Service Fabric\\bin\\Fabric\\Fabric.Code;C:\\Program Files\\Microsoft SDKs\\Service Fabric\\Tools\\ServiceFabricLocalClusterManager;C:\\Python27\\Scripts;C:\\Program Files (x86)\\Yarn\\bin;C:\\Tools\\NUnit3;C:\\Program Files\\dotnet;C:\\Program Files (x86)\\nodejs;C:\\Users\\appveyor\\.dnx\\runtimes\\dnx-clr-win-x86.1.0.0-rc1-update2\\bin;C:\\Users\\appveyor\\AppData\\Local\\Yarn\\.bin;C:\\Users\\appveyor\\AppData\\Roaming\\npm;C:\\Program Files\\AppVeyor\\BuildAgent;C:\\projects\\rust\\sccache2\" C:\\projects\\rust\\build\\x86_64-pc-windows-msvc\\stage2\\bin\\rustc.exe C:\\projects\\rust\\src/test\\incremental\\cache_file_headers.rs -L C:\\projects\\rust\\build\\x86_64-pc-windows-msvc\\test\\incremental --target=x86_64-pc-windows-msvc --cfg rpass2 -Z incremental=C:\\projects\\rust\\build\\x86_64-pc-windows-msvc\\test\\incremental\\cache_file_headers.inc --error-format json -L C:\\projects\\rust\\build\\x86_64-pc-windows-msvc\\test\\incremental\\cache_file_headers.stage2-x86_64-pc-windows-msvc.incremental.libaux -C prefer-dynamic -o C:\\projects\\rust\\build\\x86_64-pc-windows-msvc\\test\\incremental\\cache_file_headers.stage2-x86_64-pc-windows-msvc.exe -Crpath -O -Lnative=C:\\projects\\rust\\build\\x86_64-pc-windows-msvc\\rust-test-helpers -Zincremental-info\r\nstdout:\r\n------------------------------------------\r\nincremental: session directory: 4 files hard-linked\r\nincremental: session directory: 0 files copied\r\nincremental: ignoring cache artifact `dep-graph.bin`: Different compiler version\r\nincremental: re-using 0 out of 1 modules\r\n------------------------------------------\r\nstderr:\r\n------------------------------------------\r\n{\"message\":\"linking with `link.exe` failed: exit code: 1104\",\"code\":null,\"level\":\"error\",\"spans\":[],\"children\":[{\"message\":\"\\\"C:\\\\\\\\Program Files (x86)\\\\\\\\Microsoft Visual Studio 14.0\\\\\\\\VC\\\\\\\\bin\\\\\\\\amd64\\\\\\\\link.exe\\\" \\\"/LIBPATH:C:\\\\\\\\Program Files (x86)\\\\\\\\Microsoft Visual Studio 14.0\\\\\\\\VC\\\\\\\\lib\\\\\\\\amd64\\\" \\\"/LIBPATH:C:\\\\\\\\Program Files (x86)\\\\\\\\Windows Kits\\\\\\\\10\\\\\\\\lib\\\\\\\\10.0.14393.0\\\\\\\\ucrt\\\\\\\\x64\\\" \\\"/LIBPATH:C:\\\\\\\\Program Files (x86)\\\\\\\\Windows Kits\\\\\\\\10\\\\\\\\lib\\\\\\\\10.0.14393.0\\\\\\\\um\\\\\\\\x64\\\" \\\"/NOLOGO\\\" \\\"/NXCOMPAT\\\" \\\"/LIBPATH:C:\\\\\\\\projects\\\\\\\\rust\\\\\\\\build\\\\\\\\x86_64-pc-windows-msvc\\\\\\\\stage2\\\\\\\\lib\\\\\\\\rustlib\\\\\\\\x86_64-pc-windows-msvc\\\\\\\\lib\\\" \\\"C:\\\\\\\\projects\\\\\\\\rust\\\\\\\\build\\\\\\\\x86_64-pc-windows-msvc\\\\\\\\test\\\\\\\\incremental\\\\\\\\cache_file_headers.cache_file_headers.o\\\" \\\"/OUT:C:\\\\\\\\projects\\\\\\\\rust\\\\\\\\build\\\\\\\\x86_64-pc-windows-msvc\\\\\\\\test\\\\\\\\incremental\\\\\\\\cache_file_headers.stage2-x86_64-pc-windows-msvc.exe\\\" \\\"/OPT:REF,ICF\\\" \\\"/DEBUG\\\" \\\"/LIBPATH:C:\\\\\\\\projects\\\\\\\\rust\\\\\\\\build\\\\\\\\x86_64-pc-windows-msvc\\\\\\\\test\\\\\\\\incremental\\\" \\\"/LIBPATH:C:\\\\\\\\projects\\\\\\\\rust\\\\\\\\build\\\\\\\\x86_64-pc-windows-msvc\\\\\\\\test\\\\\\\\incremental\\\\\\\\cache_file_headers.stage2-x86_64-pc-windows-msvc.incremental.libaux\\\" \\\"/LIBPATH:C:\\\\\\\\projects\\\\\\\\rust\\\\\\\\build\\\\\\\\x86_64-pc-windows-msvc\\\\\\\\rust-test-helpers\\\" \\\"/LIBPATH:C:\\\\\\\\projects\\\\\\\\rust\\\\\\\\build\\\\\\\\x86_64-pc-windows-msvc\\\\\\\\stage2\\\\\\\\lib\\\\\\\\rustlib\\\\\\\\x86_64-pc-windows-msvc\\\\\\\\lib\\\" \\\"/LIBPATH:C:\\\\\\\\projects\\\\\\\\rust\\\\\\\\build\\\\\\\\x86_64-pc-windows-msvc\\\\\\\\stage2\\\\\\\\lib\\\\\\\\rustlib\\\\\\\\x86_64-pc-windows-msvc\\\\\\\\lib\\\" \\\"std-5a02bf719865b808.dll.lib\\\" \\\"C:\\\\\\\\projects\\\\\\\\rust\\\\\\\\build\\\\\\\\x86_64-pc-windows-msvc\\\\\\\\stage2\\\\\\\\lib\\\\\\\\rustlib\\\\\\\\x86_64-pc-windows-msvc\\\\\\\\lib\\\\\\\\libcompiler_builtins-b05c732613224206.rlib\\\" \\\"advapi32.lib\\\" \\\"ws2_32.lib\\\" \\\"userenv.lib\\\" \\\"shell32.lib\\\" \\\"msvcrt.lib\\\"\",\"code\":null,\"level\":\"note\",\"spans\":[],\"children\":[],\"rendered\":null},{\"message\":\"LINK : fatal error LNK1104: cannot open file 'C:\\\\projects\\\\rust\\\\build\\\\x86_64-pc-windows-msvc\\\\test\\\\incremental\\\\cache_file_headers.stage2-x86_64-pc-windows-msvc.exe'\\r\\n\",\"code\":null,\"level\":\"note\",\"spans\":[],\"children\":[],\"rendered\":null}],\"rendered\":null}\r\n{\"message\":\"aborting due to previous error\",\"code\":null,\"level\":\"error\",\"spans\":[],\"children\":[],\"rendered\":null}\r\n------------------------------------------\r\nthread '[incremental] incremental\\cache_file_headers.rs' panicked at 'explicit panic', src\\tools\\compiletest\\src\\runtest.rs:2427\r\nnote: Run with `RUST_BACKTRACE=1` for a backtrace.\r\nfailures:\r\n    [incremental] incremental\\cache_file_headers.rs\r\ntest result: FAILED. 68 passed; 1 failed; 0 ignored; 0 measured\r\n```\r\n\r\nwhere the actual error is:\r\n\r\n```\r\nLINK : fatal error LNK1104: cannot open file 'C:\\\\projects\\\\rust\\\\build\\\\x86_64-pc-windows-msvc\\\\test\\\\incremental\\\\cache_file_headers.stage2-x86_64-pc-windows-msvc.exe\r\n```\r\n\r\nSo far I've been unable to isolate what's happening here much less reproduce it, unfortunately\r\n\r\nOther examples are:\r\n\r\n* https://ci.appveyor.com/project/rust-lang/rust/build/1.0.1245/job/ntewu3y9r37b0a3a\r\n* https://ci.appveyor.com/project/rust-lang/rust/build/1.0.1260/job/0y9ep7dnl2rnd13x\r\n* https://ci.appveyor.com/project/rust-lang/rust/build/1.0.1227/job/f59ruuh32pei993k\r\n* https://ci.appveyor.com/project/rust-lang/rust/build/1.0.1279/job/pcc6w2w30v8hosck\r\n* https://ci.appveyor.com/project/rust-lang/rust/build/1.0.1278/job/9eh3n1k3qlbetxif\r\n* https://ci.appveyor.com/project/rust-lang/rust/build/1.0.1291/job/9nm55n3mc6e93rcg\r\n* https://ci.appveyor.com/project/rust-lang/rust/build/1.0.1301/job/8vx1eofjeqh9x65e\r\n* https://ci.appveyor.com/project/rust-lang/rust/build/1.0.1310/job/j5ddadcicguw3puo\r\n\r\nConclusions so far is that:\r\n\r\n* This is not MSVC or GNU specific\r\n* This is not 32 or 64-bit specific\r\n* It's always the `cache_file_headers.rs` test\r\n* This test is always the first failure in the incremental test suite", "closed_by": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/38620/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/38620/timeline", "performed_via_github_app": null, "state_reason": "completed"}