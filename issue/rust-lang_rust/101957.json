{"url": "https://api.github.com/repos/rust-lang/rust-clippy/issues/9514", "repository_url": "https://api.github.com/repos/rust-lang/rust-clippy", "labels_url": "https://api.github.com/repos/rust-lang/rust-clippy/issues/9514/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust-clippy/issues/9514/comments", "events_url": "https://api.github.com/repos/rust-lang/rust-clippy/issues/9514/events", "html_url": "https://github.com/rust-lang/rust-clippy/issues/9514", "id": 1382251447, "node_id": "I_kwDOAZm0i85SY3u3", "number": 9514, "title": "Unable to allow clippy::similar_names", "user": {"login": "schteve", "id": 5225739, "node_id": "MDQ6VXNlcjUyMjU3Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/5225739?v=4", "gravatar_id": "", "url": "https://api.github.com/users/schteve", "html_url": "https://github.com/schteve", "followers_url": "https://api.github.com/users/schteve/followers", "following_url": "https://api.github.com/users/schteve/following{/other_user}", "gists_url": "https://api.github.com/users/schteve/gists{/gist_id}", "starred_url": "https://api.github.com/users/schteve/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/schteve/subscriptions", "organizations_url": "https://api.github.com/users/schteve/orgs", "repos_url": "https://api.github.com/users/schteve/repos", "events_url": "https://api.github.com/users/schteve/events{/privacy}", "received_events_url": "https://api.github.com/users/schteve/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149309557, "node_id": "MDU6TGFiZWwxNDkzMDk1NTc=", "url": "https://api.github.com/repos/rust-lang/rust-clippy/labels/C-bug", "name": "C-bug", "color": "F5F1FD", "default": false, "description": "Category: Clippy is not doing the correct thing"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2022-09-17T23:29:27Z", "updated_at": "2022-09-23T12:12:46Z", "closed_at": null, "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I am unable to disable (allow) the `clippy::similar_names` lint the way I expect. Usually I would place `#[allow(clippy::x)]` before the offending line, and the lint error would go away. In this case the allow seems to have no effect.\r\n\r\nFor example, this code shows the lint error being given despite being allowed on the `testb` line ([playground](https://play.rust-lang.org/?version=stable&mode=debug&edition=2021&gist=9ebbc0e10c059629518ce15a7fb1e7a3)):\r\n```rust\r\n#![deny(clippy::pedantic)]\r\n\r\nfn main() {\r\n    let testa = 0u32;\r\n    #[allow(clippy::similar_names)]\r\n    let testb = 0u32;\r\n    println!(\"{testa}, {testb}\"); // Use variables\r\n}\r\n\r\n```\r\n```\r\nerror: binding's name is too similar to existing binding\r\n --> src/main.rs:6:9\r\n  |\r\n6 |     let testb = 0u32;\r\n  |         ^^^^^\r\n  |\r\nnote: the lint level is defined here\r\n --> src/main.rs:1:9\r\n  |\r\n1 | #![deny(clippy::pedantic)]\r\n  |         ^^^^^^^^^^^^^^^^\r\n  = note: `#[deny(clippy::similar_names)]` implied by `#[deny(clippy::pedantic)]`\r\nnote: existing binding defined here\r\n --> src/main.rs:4:9\r\n  |\r\n4 |     let testa = 0u32;\r\n  |         ^^^^^\r\n  = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#similar_names\r\n```\r\n\r\nI expected that allowing on the `testb` line would hide the error since that's the line referenced by the error message. To cover my bases, I can also put the allow on `testa` with the same result ([playground](https://play.rust-lang.org/?version=stable&mode=debug&edition=2021&gist=e43d9a39219277acfdcdc67b85d3a28c)):\r\n```rust\r\n#![deny(clippy::pedantic)]\r\n\r\nfn main() {\r\n    #[allow(clippy::similar_names)]\r\n    let testa = 0u32;\r\n    #[allow(clippy::similar_names)]\r\n    let testb = 0u32;\r\n    println!(\"{testa}, {testb}\"); // Use variables\r\n}\r\n\r\n```\r\n\r\nWhat *does* work is allowing on the containing function ([playground](https://play.rust-lang.org/?version=stable&mode=debug&edition=2021&gist=5866d0a552f356bee3aeb65b154045cc)). But of course this prevents other instances from being caught so is not an ideal workaround.\r\n```rust\r\n#![deny(clippy::pedantic)]\r\n\r\n#[allow(clippy::similar_names)]\r\nfn main() {\r\n    let testa = 0u32;\r\n    let testb = 0u32;\r\n    println!(\"{testa}, {testb}\"); // Use variables\r\n}\r\n```\r\n\r\nI found this on stable 1.63 but also seems to occur on beta and nightly.\r\n", "closed_by": {"login": "schteve", "id": 5225739, "node_id": "MDQ6VXNlcjUyMjU3Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/5225739?v=4", "gravatar_id": "", "url": "https://api.github.com/users/schteve", "html_url": "https://github.com/schteve", "followers_url": "https://api.github.com/users/schteve/followers", "following_url": "https://api.github.com/users/schteve/following{/other_user}", "gists_url": "https://api.github.com/users/schteve/gists{/gist_id}", "starred_url": "https://api.github.com/users/schteve/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/schteve/subscriptions", "organizations_url": "https://api.github.com/users/schteve/orgs", "repos_url": "https://api.github.com/users/schteve/repos", "events_url": "https://api.github.com/users/schteve/events{/privacy}", "received_events_url": "https://api.github.com/users/schteve/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust-clippy/issues/9514/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust-clippy/issues/9514/timeline", "performed_via_github_app": null, "state_reason": "reopened"}