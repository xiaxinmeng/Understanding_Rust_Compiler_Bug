{"url": "https://api.github.com/repos/rust-lang/rust/issues/47457", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/47457/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/47457/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/47457/events", "html_url": "https://github.com/rust-lang/rust/issues/47457", "id": 288650602, "node_id": "MDU6SXNzdWUyODg2NTA2MDI=", "number": 47457, "title": "Collect multiple missing fields on struct pattern into a single diagnostic", "user": {"login": "estebank", "id": 1606434, "node_id": "MDQ6VXNlcjE2MDY0MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1606434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/estebank", "html_url": "https://github.com/estebank", "followers_url": "https://api.github.com/users/estebank/followers", "following_url": "https://api.github.com/users/estebank/following{/other_user}", "gists_url": "https://api.github.com/users/estebank/gists{/gist_id}", "starred_url": "https://api.github.com/users/estebank/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/estebank/subscriptions", "organizations_url": "https://api.github.com/users/estebank/orgs", "repos_url": "https://api.github.com/users/estebank/repos", "events_url": "https://api.github.com/users/estebank/events{/privacy}", "received_events_url": "https://api.github.com/users/estebank/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 234902, "node_id": "MDU6TGFiZWwyMzQ5MDI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-enhancement", "name": "C-enhancement", "color": "f5f1fd", "default": false, "description": "Category: An issue proposing an enhancement or a PR with one."}, {"id": 235791, "node_id": "MDU6TGFiZWwyMzU3OTE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-diagnostics", "name": "A-diagnostics", "color": "f7e101", "default": false, "description": "Area: Messages for errors, warnings, and lints"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-01-15T16:26:26Z", "updated_at": "2018-03-23T21:41:57Z", "closed_at": "2018-03-23T21:41:57Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "When confusing a Fn-like struct with a regular struct in an `if let` pattern, the output leaves a lot to be desired:\r\n```rust\r\nstruct S(usize, usize, usize, usize);\r\n\r\nfn main() {\r\n    if let S { a, b, c, d } = S(1, 2, 3, 4) {\r\n        println!(\"hi\");\r\n    }\r\n}\r\n```\r\n<details><summary>\r\n<a href=\"https://play.rust-lang.org/?gist=7480b80ff35037ef78d4727e80e7abca&version=nightly\">Current output</a></summary>\r\n\r\n```\r\nerror[E0026]: struct `S` does not have a field named `a`\r\n --> src/main.rs:4:16\r\n  |\r\n4 |     if let S { a, b, c, d } = S(1, 2, 3, 4) {\r\n  |                ^ struct `S` does not have field `a`\r\n \r\nerror[E0026]: struct `S` does not have a field named `b`\r\n --> src/main.rs:4:19\r\n  |\r\n4 |     if let S { a, b, c, d } = S(1, 2, 3, 4) {\r\n  |                   ^ struct `S` does not have field `b`\r\n\r\nerror[E0026]: struct `S` does not have a field named `c`\r\n --> src/main.rs:4:22\r\n  |\r\n4 |     if let S { a, b, c, d } = S(1, 2, 3, 4) {\r\n  |                      ^ struct `S` does not have field `c`\r\n\r\nerror[E0026]: struct `S` does not have a field named `d`\r\n --> src/main.rs:4:25\r\n  |\r\n4 |     if let S { a, b, c, d } = S(1, 2, 3, 4) {\r\n  |                         ^ struct `S` does not have field `d`\r\n\r\nerror[E0027]: pattern does not mention field `0`\r\n --> src/main.rs:4:12\r\n  |\r\n4 |     if let S { a, b, c, d } = S(1, 2, 3, 4) {\r\n  |            ^^^^^^^^^^^^^^^^ missing field `0`\r\n  |\r\n  = note: trying to match a tuple variant with a struct variant pattern\r\n\r\nerror[E0027]: pattern does not mention field `1`\r\n --> src/main.rs:4:12\r\n  |\r\n4 |     if let S { a, b, c, d } = S(1, 2, 3, 4) {\r\n  |            ^^^^^^^^^^^^^^^^ missing field `1`\r\n  |\r\n  = note: trying to match a tuple variant with a struct variant pattern\r\n\r\nerror[E0027]: pattern does not mention field `2`\r\n --> src/main.rs:4:12\r\n  |\r\n4 |     if let S { a, b, c, d } = S(1, 2, 3, 4) {\r\n  |            ^^^^^^^^^^^^^^^^ missing field `2`\r\n  |\r\n  = note: trying to match a tuple variant with a struct variant pattern\r\n\r\nerror[E0027]: pattern does not mention field `3`\r\n --> src/main.rs:4:12\r\n  |\r\n4 |     if let S { a, b, c, d } = S(1, 2, 3, 4) {\r\n  |            ^^^^^^^^^^^^^^^^ missing field `3`\r\n  |\r\n  = note: trying to match a tuple variant with a struct variant pattern\r\n\r\nerror: aborting due to 8 previous errors\r\n```\r\n</details>\r\n\r\nWe should probably collect all these errors into a single diagnostic error:\r\n\r\n```\r\nerror[E0026]: struct `S` does not have a field named `a`, `b`, `c` or `d`\r\n --> src/main.rs:4:16\r\n  |\r\n4 |     if let S { a, b, c, d } = S(1, 2, 3, 4) {\r\n  |                ^  ^  ^  ^ struct `S` does not have these fields\r\n  = note: trying to match a tuple variant with a struct variant pattern\r\n\r\nerror[E0027]: pattern does not mention fields `0`, `1`, `2`, or `3`\r\n --> src/main.rs:4:12\r\n  |\r\n4 |     if let S { a, b, c, d } = S(1, 2, 3, 4) {\r\n  |            ^^^^^^^^^^^^^^^^ missing fields `0`, `1`, `2`, and `3`\r\n  |\r\n  = note: trying to match a tuple variant with a struct variant pattern\r\n  = help: you probably meant to use tuple struct syntax:\r\n  |\r\n4 |     if let S (a, b, c, d) = S(1, 2, 3, 4) {\r\n  |            ^^^^^^^^^^^^^^\r\n```\r\n\r\nEven better if there was only one diagnostic.", "closed_by": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/47457/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/47457/timeline", "performed_via_github_app": null, "state_reason": "completed"}