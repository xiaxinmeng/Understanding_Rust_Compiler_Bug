{"url": "https://api.github.com/repos/rust-lang/rust/issues/23080", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/23080/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/23080/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/23080/events", "html_url": "https://github.com/rust-lang/rust/issues/23080", "id": 60002975, "node_id": "MDU6SXNzdWU2MDAwMjk3NQ==", "number": 23080, "title": "ICE: \"resolved vtable bad vtable\" with `impl Trait for .. {}`", "user": {"login": "japaric", "id": 5018213, "node_id": "MDQ6VXNlcjUwMTgyMTM=", "avatar_url": "https://avatars.githubusercontent.com/u/5018213?v=4", "gravatar_id": "", "url": "https://api.github.com/users/japaric", "html_url": "https://github.com/japaric", "followers_url": "https://api.github.com/users/japaric/followers", "following_url": "https://api.github.com/users/japaric/following{/other_user}", "gists_url": "https://api.github.com/users/japaric/gists{/gist_id}", "starred_url": "https://api.github.com/users/japaric/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/japaric/subscriptions", "organizations_url": "https://api.github.com/users/japaric/orgs", "repos_url": "https://api.github.com/users/japaric/repos", "events_url": "https://api.github.com/users/japaric/events{/privacy}", "received_events_url": "https://api.github.com/users/japaric/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}], "state": "closed", "locked": false, "assignee": {"login": "flaper87", "id": 13816, "node_id": "MDQ6VXNlcjEzODE2", "avatar_url": "https://avatars.githubusercontent.com/u/13816?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flaper87", "html_url": "https://github.com/flaper87", "followers_url": "https://api.github.com/users/flaper87/followers", "following_url": "https://api.github.com/users/flaper87/following{/other_user}", "gists_url": "https://api.github.com/users/flaper87/gists{/gist_id}", "starred_url": "https://api.github.com/users/flaper87/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flaper87/subscriptions", "organizations_url": "https://api.github.com/users/flaper87/orgs", "repos_url": "https://api.github.com/users/flaper87/repos", "events_url": "https://api.github.com/users/flaper87/events{/privacy}", "received_events_url": "https://api.github.com/users/flaper87/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "flaper87", "id": 13816, "node_id": "MDQ6VXNlcjEzODE2", "avatar_url": "https://avatars.githubusercontent.com/u/13816?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flaper87", "html_url": "https://github.com/flaper87", "followers_url": "https://api.github.com/users/flaper87/followers", "following_url": "https://api.github.com/users/flaper87/following{/other_user}", "gists_url": "https://api.github.com/users/flaper87/gists{/gist_id}", "starred_url": "https://api.github.com/users/flaper87/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flaper87/subscriptions", "organizations_url": "https://api.github.com/users/flaper87/orgs", "repos_url": "https://api.github.com/users/flaper87/repos", "events_url": "https://api.github.com/users/flaper87/events{/privacy}", "received_events_url": "https://api.github.com/users/flaper87/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2015-03-05T19:29:29Z", "updated_at": "2015-03-07T05:57:42Z", "closed_at": "2015-03-07T05:57:42Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "### STR\n\n``` rust\n#![crate_type = \"lib\"]\n#![feature(optin_builtin_traits)]\n\nunsafe trait Trait {\n    fn method(&self) {\n        println!(\"Hello\");\n    }\n}\n\nunsafe impl Trait for .. {}\n\nfn call_method<T: Trait>(x: T) {\n    x.method();\n}\n\nfn main() {\n    // ICE\n    call_method(());\n}\n```\n### Backtrace\n\n``` rust\nerror: internal compiler error: resolved vtable bad vtable VtableDefaultImplData(trait_def_id=DefId { krate: 0, node: 4 }:Trait, nested=[()]) in trans\nnote: the compiler unexpectedly panicked. this is a bug.\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports\nnote: run with `RUST_BACKTRACE=1` for a backtrace\nthread 'rustc' panicked at 'Box<Any>', /home/rustbuild/src/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libsyntax/diagnostic.rs:189\n\nstack backtrace:\n   1:     0x7fe3035d6f1f - sys::backtrace::write::hf79a3da4fdecb8a0OBA\n   2:     0x7fe303601c32 - panicking::on_panic::h9f64f4c69e19f194hHJ\n   3:     0x7fe303536eda - rt::unwind::begin_unwind_inner::h37f4496c980fe936knJ\n   4:     0x7fe300989abd - rt::unwind::begin_unwind::h8320268356453106285\n   5:     0x7fe30098a305 - diagnostic::Handler::bug::h9f10e263d26f6508X5D\n   6:     0x7fe3013dac2b - session::Session::bug::hd2a7bf49812ce6f80Sp\n   7:     0x7fe302c93458 - trans::meth::trans_method_callee::h560647f9622b6732N6x\n   8:     0x7fe302c8f8e9 - trans::callee::trans_call_inner::h3649553240631627052\n   9:     0x7fe302c99789 - trans::expr::trans_rvalue_dps_unadjusted::hd47de7ac66e018254zi\n  10:     0x7fe302c4b3f6 - trans::expr::trans_into::h95c6d2681fdd2548znh\n  11:     0x7fe302c4a594 - trans::controlflow::trans_stmt_semi::h3c27cfa3f0150db6o4d\n  12:     0x7fe302c4bed0 - trans::controlflow::trans_block::h3e86dfa8c58560e6b5d\n  13:     0x7fe302d23821 - trans::base::trans_closure::hab3cc3c679d5ff23Kkt\n  14:     0x7fe302c34b08 - trans::base::trans_fn::he0569b8eb832adf9Dvt\n  15:     0x7fe302c36136 - trans::monomorphize::monomorphic_fn::hc1b7393dd1dc77f1usd\n  16:     0x7fe302c7be4e - trans::callee::trans_fn_ref_with_substs::hd01acb4398310d154kg\n  17:     0x7fe302c7a43e - trans::callee::trans_fn_ref::hb48e614c9b6dd9bcE9f\n  18:     0x7fe302c7788d - trans::callee::trans::ha56f4fe94448e6baVYf\n  19:     0x7fe302c8dfbb - trans::callee::trans_call_inner::h9722042290657949952\n  20:     0x7fe302c9a9e0 - trans::expr::trans_rvalue_dps_unadjusted::hd47de7ac66e018254zi\n  21:     0x7fe302c4b3f6 - trans::expr::trans_into::h95c6d2681fdd2548znh\n  22:     0x7fe302c4a594 - trans::controlflow::trans_stmt_semi::h3c27cfa3f0150db6o4d\n  23:     0x7fe302c4bed0 - trans::controlflow::trans_block::h3e86dfa8c58560e6b5d\n  24:     0x7fe302d23821 - trans::base::trans_closure::hab3cc3c679d5ff23Kkt\n  25:     0x7fe302c34b08 - trans::base::trans_fn::he0569b8eb832adf9Dvt\n  26:     0x7fe302c308a1 - trans::base::trans_item::h48fc370b7d259ac7vTt\n  27:     0x7fe302d2c7ec - trans::base::trans_crate::hc92be67ede893c70GPu\n  28:     0x7fe303c0fe83 - driver::phase_4_translate_to_llvm::h9904f5d5fc3fb761rNa\n  29:     0x7fe303beb83f - driver::compile_input::h3913ff7013f0c056Iba\n  30:     0x7fe303cb3cb7 - run_compiler::h28a4446bae1034e7H5b\n  31:     0x7fe303cb1829 - thunk::F.Invoke<A, R>::invoke::h6503055919709693733\n  32:     0x7fe303cb04a0 - rt::unwind::try::try_fn::h1384674024000742916\n  33:     0x7fe303671de8 - rust_try_inner\n  34:     0x7fe303671dd5 - rust_try\n  35:     0x7fe303cb0c3f - thunk::F.Invoke<A, R>::invoke::h5780663349966142752\n  36:     0x7fe3035ec965 - sys::thread::thread_start::h4ab695857833a5dar8E\n  37:     0x7fe2fd469373 - start_thread\n  38:     0x7fe3031b727c - __clone\n  39:                0x0 - <unknown>\n```\n### Version\n\n```\nrustc 1.0.0-nightly (3b3bb0e68 2015-03-04) (built 2015-03-05)\n```\n\nI suppose that traits used in default implementations are not supposed to have any methods, the compiler should raise an error in an early phase (`wf`?) instead of ICEing in trans.\n\ncc @nikomatsakis @FlaPer87 \n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/23080/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/23080/timeline", "performed_via_github_app": null, "state_reason": "completed"}