{"url": "https://api.github.com/repos/rust-lang/rust/issues/18047", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/18047/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/18047/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/18047/events", "html_url": "https://github.com/rust-lang/rust/issues/18047", "id": 45817012, "node_id": "MDU6SXNzdWU0NTgxNzAxMg==", "number": 18047, "title": "ICE when using Iron::listen.", "user": {"login": "reem", "id": 4745181, "node_id": "MDQ6VXNlcjQ3NDUxODE=", "avatar_url": "https://avatars.githubusercontent.com/u/4745181?v=4", "gravatar_id": "", "url": "https://api.github.com/users/reem", "html_url": "https://github.com/reem", "followers_url": "https://api.github.com/users/reem/followers", "following_url": "https://api.github.com/users/reem/following{/other_user}", "gists_url": "https://api.github.com/users/reem/gists{/gist_id}", "starred_url": "https://api.github.com/users/reem/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/reem/subscriptions", "organizations_url": "https://api.github.com/users/reem/orgs", "repos_url": "https://api.github.com/users/reem/repos", "events_url": "https://api.github.com/users/reem/events{/privacy}", "received_events_url": "https://api.github.com/users/reem/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2014-10-15T00:27:54Z", "updated_at": "2014-11-05T02:41:03Z", "closed_at": "2014-11-05T02:41:03Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "This:\n\n``` rust\nextern crate iron;\n\nuse iron::{Request, Response, IronResult, Iron, status};\nuse std::net::ip::Ipv4Addr;\n\nfn main() {\n    Iron::new(hello_world);\n\n    fn hello_world(_: &mut Request) -> IronResult<Response> {\n        Ok(Response::with(status::Ok, \"hello world\"))\n    }\n}\n```\n\ncompiles fine, but:\n\n``` rust\nextern crate iron;\n\nuse iron::{Request, Response, IronResult, Iron, status};\nuse std::net::ip::Ipv4Addr;\n\nfn main() {\n    Iron::new(hello_world).listen(Ipv4Addr(127, 0, 0, 1), 3000);\n\n    fn hello_world(_: &mut Request) -> IronResult<Response> {\n        Ok(Response::with(status::Ok, \"hello world\"))\n    }\n}\n```\n\nICEs with:\n\n```\nerror: internal compiler error: unexpected failure\nnote: the compiler hit an unexpected failure path. this is a bug.\nnote: we would appreciate a bug report: http://doc.rust-lang.org/complement-bugreport.html\nnote: run with `RUST_BACKTRACE=1` for a backtrace\ntask 'rustc' failed at 'no entry found for key', /Users/rustbuild/src/rust-buildbot/slave/nightly-mac/build/src/libstd/collections/hashmap/map.rs:1093\n\nstack backtrace:\n   1:        0x10cebcd59 - rt::backtrace::imp::write::h189e19957ab9c695OLq\n   2:        0x10cec0071 - failure::on_fail::h03dc2437e5a88345n2q\n   3:        0x10d12ce95 - unwind::begin_unwind_inner::h033484cc1a8bac37Jud\n   4:        0x109a37e7e - unwind::begin_unwind::h7267044357685618810\n   5:        0x109f59800 - middle::ty::type_contents::tc_ty::h9dee7b4d0b2b2b26VCF\n   6:        0x109f58f3c - middle::ty::type_contents::tc_ty::h9dee7b4d0b2b2b26VCF\n   7:        0x109cdb5d6 - middle::ty::type_contents::h92aeb2c2b610e0e2QBF\n   8:        0x109ee9fe9 - middle::expr_use_visitor::ExprUseVisitor<'d, 't, TYPER>::consume_expr::h14245152794985074657\n   9:        0x109ee495f - middle::expr_use_visitor::ExprUseVisitor<'d, 't, TYPER>::walk_expr::h5075202552449147342\n  10:        0x109eea03e - middle::expr_use_visitor::ExprUseVisitor<'d, 't, TYPER>::consume_expr::h14245152794985074657\n  11:        0x109ee495f - middle::expr_use_visitor::ExprUseVisitor<'d, 't, TYPER>::walk_expr::h5075202552449147342\n  12:        0x109eea293 - middle::expr_use_visitor::ExprUseVisitor<'d, 't, TYPER>::walk_local::h3960078952215051727\n  13:        0x109eea1c5 - middle::expr_use_visitor::ExprUseVisitor<'d, 't, TYPER>::walk_block::h1681476813087692403\n  14:        0x109ee4ab8 - middle::expr_use_visitor::ExprUseVisitor<'d, 't, TYPER>::walk_expr::h5075202552449147342\n  15:        0x109eedd7a - middle::trans::_match::create_bindings_map::h7c926dcc9743685daOi\n  16:        0x109e6336a - middle::trans::_match::trans_match::hda856724a8df18120Ji\n  17:        0x109e51b37 - middle::trans::expr::trans_rvalue_dps_unadjusted::hc9fadfddd28f4d57KO4\n  18:        0x109e12b9d - middle::trans::expr::trans_into::h61ab769bf22fa7c9iq3\n  19:        0x109e11e9c - middle::trans::controlflow::trans_stmt_semi::h690085bf4cf7dcecUCZ\n  20:        0x109e11520 - middle::trans::controlflow::trans_stmt::hf3294d619d4310c2HyZ\n  21:        0x109e12df8 - middle::trans::controlflow::trans_block::haf894db31e0a118dNDZ\n  22:        0x109e16e78 - middle::trans::controlflow::trans_while::h5f1f833bc693e3166NZ\n  23:        0x109e53a87 - middle::trans::expr::trans_rvalue_stmt_unadjusted::h429c506388a2e3d6LI4\n  24:        0x109e12c64 - middle::trans::expr::trans_into::h61ab769bf22fa7c9iq3\n  25:        0x109e12efd - middle::trans::controlflow::trans_block::haf894db31e0a118dNDZ\n  26:        0x109e51bad - middle::trans::expr::trans_rvalue_dps_unadjusted::hc9fadfddd28f4d57KO4\n  27:        0x109e12b9d - middle::trans::expr::trans_into::h61ab769bf22fa7c9iq3\n  28:        0x109e12efd - middle::trans::controlflow::trans_block::haf894db31e0a118dNDZ\n  29:        0x109ec399e - middle::trans::base::trans_closure::h7f2921f1f179d268ezf\n  30:        0x109e667b5 - middle::trans::closure::trans_expr_fn::hfa0708e282a88c7eLFj\n  31:        0x109e52a73 - middle::trans::expr::trans_rvalue_dps_unadjusted::hc9fadfddd28f4d57KO4\n  32:        0x109e50426 - middle::trans::expr::trans_unadjusted::hc4be1e5aa2eff2b4gb4\n  33:        0x109e14056 - middle::trans::expr::trans::h49becb6a5c7b0a40cu3\n  34:        0x109e497c4 - middle::trans::callee::trans_args::h82b5e82dbe357761802\n  35:        0x109e1b801 - middle::trans::callee::trans_call_inner::hd16d8c5fe60896ffbG2\n  36:        0x109e43814 - middle::trans::callee::trans_method_call::haf484f13878df218EB2\n  37:        0x109e51646 - middle::trans::expr::trans_rvalue_dps_unadjusted::hc9fadfddd28f4d57KO4\n  38:        0x109e12b9d - middle::trans::expr::trans_into::h61ab769bf22fa7c9iq3\n  39:        0x109e11e9c - middle::trans::controlflow::trans_stmt_semi::h690085bf4cf7dcecUCZ\n  40:        0x109e11520 - middle::trans::controlflow::trans_stmt::hf3294d619d4310c2HyZ\n  41:        0x109e12df8 - middle::trans::controlflow::trans_block::haf894db31e0a118dNDZ\n  42:        0x109e18076 - middle::trans::controlflow::trans_for::h5d5ba302e1abeed7cQZ\n  43:        0x109e53ac8 - middle::trans::expr::trans_rvalue_stmt_unadjusted::h429c506388a2e3d6LI4\n  44:        0x109e12c64 - middle::trans::expr::trans_into::h61ab769bf22fa7c9iq3\n  45:        0x109e12efd - middle::trans::controlflow::trans_block::haf894db31e0a118dNDZ\n  46:        0x109ec399e - middle::trans::base::trans_closure::h7f2921f1f179d268ezf\n  47:        0x109e0508a - middle::trans::base::trans_fn::hac9c962286515c42CKf\n  48:        0x109e06f5e - middle::trans::monomorphize::monomorphic_fn::h96fb22308c4a0853u5Y\n  49:        0x109e3dbcf - middle::trans::callee::trans_fn_ref_with_substs::hdc5652548ed88225tk2\n  50:        0x109e3a3ab - middle::trans::callee::trans_fn_ref::hf590bd91aa7c0fd4181\n  51:        0x109e1c24d - middle::trans::meth::trans_method_callee::h321387808d989836SRk\n  52:        0x109e439bb - middle::trans::callee::trans_method_call::closure.123984\n  53:        0x109e1a754 - middle::trans::callee::trans_call_inner::hd16d8c5fe60896ffbG2\n  54:        0x109e43814 - middle::trans::callee::trans_method_call::haf484f13878df218EB2\n  55:        0x109e51646 - middle::trans::expr::trans_rvalue_dps_unadjusted::hc9fadfddd28f4d57KO4\n  56:        0x109e12b9d - middle::trans::expr::trans_into::h61ab769bf22fa7c9iq3\n  57:        0x109e12efd - middle::trans::controlflow::trans_block::haf894db31e0a118dNDZ\n  58:        0x109e51bad - middle::trans::expr::trans_rvalue_dps_unadjusted::hc9fadfddd28f4d57KO4\n  59:        0x109e12b9d - middle::trans::expr::trans_into::h61ab769bf22fa7c9iq3\n  60:        0x109e12efd - middle::trans::controlflow::trans_block::haf894db31e0a118dNDZ\n  61:        0x109ec399e - middle::trans::base::trans_closure::h7f2921f1f179d268ezf\n  62:        0x109e667b5 - middle::trans::closure::trans_expr_fn::hfa0708e282a88c7eLFj\n  63:        0x109e52a73 - middle::trans::expr::trans_rvalue_dps_unadjusted::hc9fadfddd28f4d57KO4\n  64:        0x109e50426 - middle::trans::expr::trans_unadjusted::hc4be1e5aa2eff2b4gb4\n  65:        0x109e14056 - middle::trans::expr::trans::h49becb6a5c7b0a40cu3\n  66:        0x109e497c4 - middle::trans::callee::trans_args::h82b5e82dbe357761802\n  67:        0x109e1b801 - middle::trans::callee::trans_call_inner::hd16d8c5fe60896ffbG2\n  68:        0x109e429a7 - middle::trans::callee::trans_call::hc740554d018cb851wA2\n  69:        0x109e52201 - middle::trans::expr::trans_rvalue_dps_unadjusted::hc9fadfddd28f4d57KO4\n  70:        0x109e12b9d - middle::trans::expr::trans_into::h61ab769bf22fa7c9iq3\n  71:        0x109e11e9c - middle::trans::controlflow::trans_stmt_semi::h690085bf4cf7dcecUCZ\n  72:        0x109e11520 - middle::trans::controlflow::trans_stmt::hf3294d619d4310c2HyZ\n  73:        0x109e12df8 - middle::trans::controlflow::trans_block::haf894db31e0a118dNDZ\n  74:        0x109ec399e - middle::trans::base::trans_closure::h7f2921f1f179d268ezf\n  75:        0x109e0508a - middle::trans::base::trans_fn::hac9c962286515c42CKf\n  76:        0x109e06f5e - middle::trans::monomorphize::monomorphic_fn::h96fb22308c4a0853u5Y\n  77:        0x109e3dbcf - middle::trans::callee::trans_fn_ref_with_substs::hdc5652548ed88225tk2\n  78:        0x109e3a3ab - middle::trans::callee::trans_fn_ref::hf590bd91aa7c0fd4181\n  79:        0x109e1c24d - middle::trans::meth::trans_method_callee::h321387808d989836SRk\n  80:        0x109e439bb - middle::trans::callee::trans_method_call::closure.123984\n  81:        0x109e1a754 - middle::trans::callee::trans_call_inner::hd16d8c5fe60896ffbG2\n  82:        0x109e43814 - middle::trans::callee::trans_method_call::haf484f13878df218EB2\n  83:        0x109e51646 - middle::trans::expr::trans_rvalue_dps_unadjusted::hc9fadfddd28f4d57KO4\n  84:        0x109e12b9d - middle::trans::expr::trans_into::h61ab769bf22fa7c9iq3\n  85:        0x109e11e9c - middle::trans::controlflow::trans_stmt_semi::h690085bf4cf7dcecUCZ\n  86:        0x109e11520 - middle::trans::controlflow::trans_stmt::hf3294d619d4310c2HyZ\n  87:        0x109e12df8 - middle::trans::controlflow::trans_block::haf894db31e0a118dNDZ\n  88:        0x109ec399e - middle::trans::base::trans_closure::h7f2921f1f179d268ezf\n  89:        0x109e0508a - middle::trans::base::trans_fn::hac9c962286515c42CKf\n  90:        0x109e02805 - middle::trans::base::trans_item::h35195f56acc36a8eV3f\n  91:        0x109ecd4d8 - middle::trans::base::trans_crate::h6442820c0a274264r2g\n  92:        0x10a308615 - driver::driver::phase_4_translate_to_llvm::h8e1e0d5a654b87d1kAx\n  93:        0x10a300718 - driver::driver::compile_input::h1f2de5081accd1dcf7w\n  94:        0x10a389084 - driver::run_compiler::h00e7e552333d10b3yVA\n  95:        0x10a3871b6 - driver::run::closure.147372\n  96:        0x109a7034b - task::TaskBuilder<S>::try_future::closure.101547\n  97:        0x109a70233 - task::TaskBuilder<S>::spawn_internal::closure.101518\n  98:        0x10ad2179d - task::spawn_opts::closure.8528\n  99:        0x10d19495c - rust_try_inner\n  100:        0x10d194946 - rust_try\n ... <frames omitted>\n```\n\nI tried to debug this with @eddyb on IRC a few days ago, but haven't been able to make any progress.\n", "closed_by": {"login": "reem", "id": 4745181, "node_id": "MDQ6VXNlcjQ3NDUxODE=", "avatar_url": "https://avatars.githubusercontent.com/u/4745181?v=4", "gravatar_id": "", "url": "https://api.github.com/users/reem", "html_url": "https://github.com/reem", "followers_url": "https://api.github.com/users/reem/followers", "following_url": "https://api.github.com/users/reem/following{/other_user}", "gists_url": "https://api.github.com/users/reem/gists{/gist_id}", "starred_url": "https://api.github.com/users/reem/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/reem/subscriptions", "organizations_url": "https://api.github.com/users/reem/orgs", "repos_url": "https://api.github.com/users/reem/repos", "events_url": "https://api.github.com/users/reem/events{/privacy}", "received_events_url": "https://api.github.com/users/reem/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/18047/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/18047/timeline", "performed_via_github_app": null, "state_reason": "completed"}