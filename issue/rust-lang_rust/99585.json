{"url": "https://api.github.com/repos/rust-lang/rust/issues/99585", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/99585/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/99585/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/99585/events", "html_url": "https://github.com/rust-lang/rust/issues/99585", "id": 1314072679, "node_id": "I_kwDOAAsO6M5OUyhn", "number": 99585, "title": "Expand documentation on cfg!(windows) and cfg!(unix)?", "user": {"login": "kevinushey", "id": 1976582, "node_id": "MDQ6VXNlcjE5NzY1ODI=", "avatar_url": "https://avatars.githubusercontent.com/u/1976582?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kevinushey", "html_url": "https://github.com/kevinushey", "followers_url": "https://api.github.com/users/kevinushey/followers", "following_url": "https://api.github.com/users/kevinushey/following{/other_user}", "gists_url": "https://api.github.com/users/kevinushey/gists{/gist_id}", "starred_url": "https://api.github.com/users/kevinushey/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kevinushey/subscriptions", "organizations_url": "https://api.github.com/users/kevinushey/orgs", "repos_url": "https://api.github.com/users/kevinushey/repos", "events_url": "https://api.github.com/users/kevinushey/events{/privacy}", "received_events_url": "https://api.github.com/users/kevinushey/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-07-22T02:48:32Z", "updated_at": "2022-07-22T02:55:31Z", "closed_at": "2022-07-22T02:55:31Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "https://doc.rust-lang.org/reference/conditional-compilation.html includes an example showing how the `windows` and `unix` configuration shortcuts can be used:\r\n\r\n```\r\n#![allow(unused)]\r\nfn main() {\r\nlet machine_kind = if cfg!(unix) {\r\n  \"unix\"\r\n} else if cfg!(windows) {\r\n  \"windows\"\r\n} else {\r\n  \"unknown\"\r\n};\r\n\r\nprintln!(\"I'm running on a {} machine!\", machine_kind);\r\n}\r\n```\r\n\r\nPerhaps naively, after reading that, I figured I could have macOS-only Rust code with something like:\r\n\r\n```\r\nif cfg!(macos) { ... }\r\n```\r\n\r\nHowever, `macos` is not actually a defined configuration option on macOS. Some options that I think could improve the situation here:\r\n\r\n1. Treat `cfg!(macos)` as an alias for `cfg!(target_os = \"macos\")`,\r\n2. Explicitly call out the fact that `windows` and `unix` are treated specially by Rust in the documentation. (What are they? Where are they defined? Where do they come from?)\r\n3. Maybe provide lint when using `cfg!(macos)`, and suggest the alternative `cfg!(target_os = \"macos\")`? \r\n", "closed_by": {"login": "kevinushey", "id": 1976582, "node_id": "MDQ6VXNlcjE5NzY1ODI=", "avatar_url": "https://avatars.githubusercontent.com/u/1976582?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kevinushey", "html_url": "https://github.com/kevinushey", "followers_url": "https://api.github.com/users/kevinushey/followers", "following_url": "https://api.github.com/users/kevinushey/following{/other_user}", "gists_url": "https://api.github.com/users/kevinushey/gists{/gist_id}", "starred_url": "https://api.github.com/users/kevinushey/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kevinushey/subscriptions", "organizations_url": "https://api.github.com/users/kevinushey/orgs", "repos_url": "https://api.github.com/users/kevinushey/repos", "events_url": "https://api.github.com/users/kevinushey/events{/privacy}", "received_events_url": "https://api.github.com/users/kevinushey/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/99585/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/99585/timeline", "performed_via_github_app": null, "state_reason": "completed"}