{"url": "https://api.github.com/repos/rust-lang/rust/issues/32863", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/32863/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/32863/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/32863/events", "html_url": "https://github.com/rust-lang/rust/issues/32863", "id": 147180830, "node_id": "MDU6SXNzdWUxNDcxODA4MzA=", "number": 32863, "title": "Custom rc: compiler requires generic argument to be sized", "user": {"login": "VFLashM", "id": 3723853, "node_id": "MDQ6VXNlcjM3MjM4NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/3723853?v=4", "gravatar_id": "", "url": "https://api.github.com/users/VFLashM", "html_url": "https://github.com/VFLashM", "followers_url": "https://api.github.com/users/VFLashM/followers", "following_url": "https://api.github.com/users/VFLashM/following{/other_user}", "gists_url": "https://api.github.com/users/VFLashM/gists{/gist_id}", "starred_url": "https://api.github.com/users/VFLashM/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/VFLashM/subscriptions", "organizations_url": "https://api.github.com/users/VFLashM/orgs", "repos_url": "https://api.github.com/users/VFLashM/repos", "events_url": "https://api.github.com/users/VFLashM/events{/privacy}", "received_events_url": "https://api.github.com/users/VFLashM/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2016-04-10T00:54:24Z", "updated_at": "2017-05-02T20:57:21Z", "closed_at": "2017-05-02T20:57:21Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I'm trying to implement custom rc class and hit a problem with dst.\n\nPlease see example below (tested on rust nightly).\nCompiler requires generic argument to be sized, even though it's not really necessary.\n`CustomRc<Trait>` is sized and `Bad` should not care whether or not `Trait` is sized.\n\nWhat's even more puzzling is that standard `Rc` works fine. It makes me think I missed something, but I spent a lot of time on it and couldn't find a reason. It would be great if error mentioned which part of code required the missing trait constraint.\n\n``` rust\nuse std::rc::Rc;\nuse std::marker::Unsize;\nuse std::ops::CoerceUnsized;\n\nstruct CustomRc<T: ?Sized>(Rc<T>);\nimpl<U: ?Sized, T: Unsize<U>> CoerceUnsized<CustomRc<U>> for CustomRc<T> {}\n\nstruct Struct;\ntrait Trait {}\nimpl Trait for Struct {}\n\nstruct Good(Rc<Trait>);\nstruct Bad(CustomRc<Trait>);\n\nfn main() {\n    {\n        let s: Rc<Struct> = Rc::new(Struct);\n        let t: Rc<Trait> = s;\n        let good = Good(t); // as expected, works fine\n    }\n    {\n        let s: CustomRc<Struct> = CustomRc(Rc::new(Struct));\n        let t: CustomRc<Trait> = s;\n        let bad = Bad(t); // error: the trait bound `Trait: std::marker::Sized` is not satisfied\n    }\n}   \n```\n", "closed_by": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/32863/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/32863/timeline", "performed_via_github_app": null, "state_reason": "completed"}