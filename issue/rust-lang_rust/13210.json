{"url": "https://api.github.com/repos/rust-lang/rust/issues/13210", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/13210/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/13210/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/13210/events", "html_url": "https://github.com/rust-lang/rust/issues/13210", "id": 30468751, "node_id": "MDU6SXNzdWUzMDQ2ODc1MQ==", "number": 13210, "title": "sync::Arc is failing to free memory", "user": {"login": "ghost", "id": 10137, "node_id": "MDQ6VXNlcjEwMTM3", "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ghost", "html_url": "https://github.com/ghost", "followers_url": "https://api.github.com/users/ghost/followers", "following_url": "https://api.github.com/users/ghost/following{/other_user}", "gists_url": "https://api.github.com/users/ghost/gists{/gist_id}", "starred_url": "https://api.github.com/users/ghost/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ghost/subscriptions", "organizations_url": "https://api.github.com/users/ghost/orgs", "repos_url": "https://api.github.com/users/ghost/repos", "events_url": "https://api.github.com/users/ghost/events{/privacy}", "received_events_url": "https://api.github.com/users/ghost/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2014-03-30T16:36:41Z", "updated_at": "2014-03-31T00:16:41Z", "closed_at": "2014-03-31T00:16:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "Quick test to reproduce, check against `d79fbba`\n\n``` rust\nextern crate sync;\n\nuse sync::Arc;\n\nfn main()\n{\n    let _ = Arc::new(~\"failed to drop\");\n}\n```\n\nvalgrind results\n\n```\ncolin@Colin-ubuntu:~/Source$ valgrind --leak-check=full ./failed_to_drop\nMemcheck, a memory error detector\nCopyright (C) 2002-2011, and GNU GPL'd, by Julian Seward et al.\nUsing Valgrind-3.7.0 and LibVEX; rerun with -h for copyright info\nCommand: ./failed_to_drop\n\n\nHEAP SUMMARY:\n    in use at exit: 54 bytes in 2 blocks\n  total heap usage: 16 allocs, 14 frees, 950 bytes allocated\n\n54 (24 direct, 30 indirect) bytes in 1 blocks are definitely lost in loss record 2 of 2\n   at 0x4C2B6CD: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n   by 0x40507F: rt::global_heap::malloc_raw::h9abfb11fdd4fbd35cba::v0.0 (in /home/colin/Source/failed_to_drop)\n   by 0x405007: rt::global_heap::exchange_malloc::h1a731dc6869c0c73Vaa::v0.0 (in /home/colin/Source/failed_to_drop)\n   by 0x404E99: arc::Arc$LT$T$GT$::new::haa6209d493a9d577raa::v0.0 (in /home/colin/Source/failed_to_drop)\n   by 0x404DE4: main::hed1e648887e7476fgaa::v0.0 (in /home/colin/Source/failed_to_drop)\n   by 0x438642: start::closure.7865 (in /home/colin/Source/failed_to_drop)\n   by 0x4D3452: rt::task::Task::run::closure.41627 (in /home/colin/Source/failed_to_drop)\n   by 0x4DE5AB: rust_try (in /home/colin/Source/failed_to_drop)\n   by 0x4D32B1: rt::task::Task::run::h19b1ba3b1fab6483os9::v0.10.pre (in /home/colin/Source/failed_to_drop)\n   by 0x438433: start::h7087cc56d053c8b1zvd::v0.10.pre (in /home/colin/Source/failed_to_drop)\n   by 0x438223: lang_start::hcbb6c5fc89f3553bTud::v0.10.pre (in /home/colin/Source/failed_to_drop)\n   by 0x404E4E: main (in /home/colin/Source/failed_to_drop)\n\nLEAK SUMMARY:\n   definitely lost: 24 bytes in 1 blocks\n   indirectly lost: 30 bytes in 1 blocks\n     possibly lost: 0 bytes in 0 blocks\n   still reachable: 0 bytes in 0 blocks\n        suppressed: 0 bytes in 0 blocks\n\nFor counts of detected and suppressed errors, rerun with: -v\nERROR SUMMARY: 1 errors from 1 contexts (suppressed: 2 from 2)\n```\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/13210/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/13210/timeline", "performed_via_github_app": null, "state_reason": "completed"}