{"url": "https://api.github.com/repos/rust-lang/rust/issues/72609", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/72609/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/72609/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/72609/events", "html_url": "https://github.com/rust-lang/rust/issues/72609", "id": 624835739, "node_id": "MDU6SXNzdWU2MjQ4MzU3Mzk=", "number": 72609, "title": "`-Cpanic=abort` IllegalInstruction in build script", "user": {"login": "Speedy37", "id": 5376197, "node_id": "MDQ6VXNlcjUzNzYxOTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5376197?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Speedy37", "html_url": "https://github.com/Speedy37", "followers_url": "https://api.github.com/users/Speedy37/followers", "following_url": "https://api.github.com/users/Speedy37/following{/other_user}", "gists_url": "https://api.github.com/users/Speedy37/gists{/gist_id}", "starred_url": "https://api.github.com/users/Speedy37/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Speedy37/subscriptions", "organizations_url": "https://api.github.com/users/Speedy37/orgs", "repos_url": "https://api.github.com/users/Speedy37/repos", "events_url": "https://api.github.com/users/Speedy37/events{/privacy}", "received_events_url": "https://api.github.com/users/Speedy37/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-05-26T12:12:11Z", "updated_at": "2020-05-26T12:37:49Z", "closed_at": "2020-05-26T12:37:49Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!--\r\nThank you for filing a bug report! \ud83d\udc1b Please provide a short summary of the bug,\r\nalong with any information you feel relevant to replicating the bug.\r\n-->\r\n\r\nI tried this code:\r\n\r\n```rust\r\nRUSTFLAGS=\"-Cpanic=abort\"\r\n```\r\n\r\nOn this repository: https://github.com/Clikengo/foundationdb-rs\r\n\r\n\r\nI expected to see this happen: A correct build or a correct abort call\r\n\r\nInstead, this happened: the processor reach an illegal instruction.\r\n\r\nhttps://github.com/Clikengo/foundationdb-rs/runs/709083830\r\n\r\nI was able to reproduce the crash locally on windows.\r\nBuilding foundationdb-sys alone doesn't crash, but while building foundationdb-sys for foundationdb it does.\r\n\r\n### Meta\r\n<!--\r\nIf you're using the stable version of the compiler, you should also check if the\r\nbug also exists in the beta or nightly versions.\r\n-->\r\n\r\n`rustc --version --verbose`:\r\n```\r\nrustc 1.43.1 (8d69840ab 2020-05-04)\r\nbinary: rustc\r\ncommit-hash: 8d69840ab92ea7f4d323420088dd8c9775f180cd\r\ncommit-date: 2020-05-04\r\nhost: x86_64-pc-windows-msvc\r\nrelease: 1.43.1\r\nLLVM version: 9.0\r\n```\r\n\r\n<!--\r\nInclude a backtrace in the code block by setting `RUST_BACKTRACE=1` in your\r\nenvironment. E.g. `RUST_BACKTRACE=1 cargo build`.\r\n-->\r\n<details><summary>Backtrace</summary>\r\n<p>\r\n\r\n```\r\n>\tbuild-script-build.exe!panic_abort::__rust_start_panic()\tUnknown\tNon-user code. Symbols loaded.\r\n \tbuild-script-build.exe!std::panicking::rust_panic() Line 522\tUnknown\tSymbols loaded.\r\n \tbuild-script-build.exe!std::panicking::rust_panic_with_hook() Line 492\tUnknown\tSymbols loaded.\r\n \tbuild-script-build.exe!std::panicking::begin_panic<str*>() Line 397\tUnknown\tSymbols loaded.\r\n \t[Inline Frame] build-script-build.exe!proc_macro::bridge::scoped_cell::ScopedCell<proc_macro::bridge::client::BridgeStateL>::replace() Line 74\tUnknown\tSymbols loaded.\r\n \t[Inline Frame] build-script-build.exe!proc_macro::bridge::client::{{impl}}::with::{{closure}}() Line 284\tUnknown\tSymbols loaded.\r\n \t[Inline Frame] build-script-build.exe!std::thread::local::LocalKey<proc_macro::bridge::scoped_cell::ScopedCell<proc_macro::bridge::client::BridgeStateL>>::try_with() Line 262\tUnknown\tSymbols loaded.\r\n \t[Inline Frame] build-script-build.exe!std::thread::local::LocalKey<proc_macro::bridge::scoped_cell::ScopedCell<proc_macro::bridge::client::BridgeStateL>>::with() Line 239\tUnknown\tSymbols loaded.\r\n \t[Inline Frame] build-script-build.exe!proc_macro::bridge::client::BridgeState::with() Line 283\tUnknown\tSymbols loaded.\r\n \t[Inline Frame] build-script-build.exe!proc_macro::bridge::Bridge::with() Line 314\tUnknown\tSymbols loaded.\r\n \t[Inline Frame] build-script-build.exe!proc_macro::bridge::client::Span::call_site() Line 230\tUnknown\tSymbols loaded.\r\n \tbuild-script-build.exe!proc_macro::Span::call_site() Line 271\tUnknown\tSymbols loaded.\r\n \tbuild-script-build.exe!core::ops::function::FnOnce::call_once<fn() -> proc_macro::Span,()>(proc_macro::Span(*)()) Line 232\tUnknown\tSymbols loaded.\r\n \tbuild-script-build.exe!std::panicking::try::do_call<fn() -> proc_macro::Span,proc_macro::Span>(unsigned char * data) Line 303\tUnknown\tSymbols loaded.\r\n \tbuild-script-build.exe!panic_abort::__rust_maybe_catch_panic() Line 32\tUnknown\tSymbols loaded.\r\n \tbuild-script-build.exe!std::panicking::try<proc_macro::Span,fn() -> proc_macro::Span>(proc_macro::Span(*)() f) Line 281\tUnknown\tSymbols loaded.\r\n \tbuild-script-build.exe!std::panic::catch_unwind<fn() -> proc_macro::Span,proc_macro::Span>(proc_macro::Span(*)() f) Line 395\tUnknown\tSymbols loaded.\r\n \tbuild-script-build.exe!proc_macro2::detection::initialize() Line 59\tUnknown\tSymbols loaded.\r\n \tbuild-script-build.exe!core::ops::function::FnOnce::call_once<fn(),()>(void(*)()) Line 232\tUnknown\tSymbols loaded.\r\n \tbuild-script-build.exe!std::sync::once::{{impl}}::call_once::{{closure}}<fn()>(std::sync::once::{{impl}}::call_once::closure-0 *, bool) Line 264\tUnknown\tSymbols loaded.\r\n \tbuild-script-build.exe!std::sync::once::Once::call_inner() Line 417\tUnknown\tSymbols loaded.\r\n \tbuild-script-build.exe!std::sync::once::Once::call_once<fn()>(void(*)() self) Line 265\tUnknown\tSymbols loaded.\r\n \tbuild-script-build.exe!proc_macro2::detection::inside_proc_macro() Line 15\tUnknown\tSymbols loaded.\r\n \tbuild-script-build.exe!proc_macro2::imp::Span::call_site() Line 372\tUnknown\tSymbols loaded.\r\n \tbuild-script-build.exe!proc_macro2::Span::call_site() Line 362\tUnknown\tSymbols loaded.\r\n \tbuild-script-build.exe!bindgen::ir::context::BindgenContext::rust_ident_raw<alloc::borrow::Cow<str>>(alloc::borrow::Cow<str> self) Line 894\tUnknown\tSymbols loaded.\r\n \tbuild-script-build.exe!bindgen::ir::context::BindgenContext::rust_ident<alloc::string::String*>(alloc::string::String * self) Line 887\tUnknown\tSymbols loaded.\r\n \tbuild-script-build.exe!bindgen::codegen::{{impl}}::codegen(bindgen::ir::var::Var * self, bindgen::ir::context::BindgenContext * ctx, bindgen::codegen::CodegenResult * result, bindgen::ir::item::Item * item) Line 502\tUnknown\tSymbols loaded.\r\n \tbuild-script-build.exe!00007ff7d1997fc1() Line 370\tUnknown\tSymbols loaded.\r\n \tbuild-script-build.exe!bindgen::codegen::{{impl}}::codegen::{{closure}}(bindgen::codegen::{{impl}}::codegen::closure-0 * result, bindgen::codegen::CodegenResult * found_any, bool *) Line 401\tUnknown\tSymbols loaded.\r\n \tbuild-script-build.exe!bindgen::codegen::{{impl}}::codegen(bindgen::ir::module::Module * self, bindgen::ir::context::BindgenContext * ctx, bindgen::codegen::CodegenResult * result, bindgen::ir::item::Item * item) Line 434\tUnknown\tSymbols loaded.\r\n \tbuild-script-build.exe!00007ff7d1997f57() Line 370\tUnknown\tSymbols loaded.\r\n \tbuild-script-build.exe!bindgen::codegen::codegen::{{closure}}(bindgen::codegen::codegen::closure-0, bindgen::ir::context::BindgenContext * context) Line 3891\tUnknown\tSymbols loaded.\r\n \tbuild-script-build.exe!bindgen::ir::context::BindgenContext::gen<closure-0,alloc::vec::Vec<proc_macro2::TokenStream>>(bindgen::ir::context::BindgenContext self, bindgen::codegen::codegen::closure-0 cb) Line 1208\tUnknown\tSymbols loaded.\r\n \tbuild-script-build.exe!bindgen::codegen::codegen(bindgen::ir::context::BindgenContext context) Line 3893\tUnknown\tSymbols loaded.\r\n \tbuild-script-build.exe!bindgen::Bindings::generate(bindgen::BindgenOptions options) Line 2116\tUnknown\tSymbols loaded.\r\n \tbuild-script-build.exe!bindgen::Builder::generate(bindgen::Builder self) Line 1423\tUnknown\tSymbols loaded.\r\n \tbuild-script-build.exe!build_script_build::main() Line 95\tUnknown\tSymbols loaded.\r\n \tbuild-script-build.exe!std::rt::lang_start::{{closure}}<()>(std::rt::lang_start::closure-0 *) Line 67\tUnknown\tSymbols loaded.\r\n \t[Inline Frame] build-script-build.exe!std::rt::lang_start_internal::{{closure}}() Line 52\tUnknown\tSymbols loaded.\r\n \tbuild-script-build.exe!std::panicking::try::do_call<closure-0,i32>() Line 303\tUnknown\tSymbols loaded.\r\n \tbuild-script-build.exe!panic_abort::__rust_maybe_catch_panic() Line 32\tUnknown\tSymbols loaded.\r\n \t[Inline Frame] build-script-build.exe!std::panicking::try() Line 281\tUnknown\tSymbols loaded.\r\n \t[Inline Frame] build-script-build.exe!std::panic::catch_unwind() Line 394\tUnknown\tSymbols loaded.\r\n \tbuild-script-build.exe!std::rt::lang_start_internal() Line 51\tUnknown\tSymbols loaded.\r\n \tbuild-script-build.exe!std::rt::lang_start<()>(void(*)() main, __int64 argc, unsigned char * * argv) Line 67\tUnknown\tSymbols loaded.\r\n\r\n```\r\n\r\n</p>\r\n</details>\r\n", "closed_by": {"login": "Speedy37", "id": 5376197, "node_id": "MDQ6VXNlcjUzNzYxOTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5376197?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Speedy37", "html_url": "https://github.com/Speedy37", "followers_url": "https://api.github.com/users/Speedy37/followers", "following_url": "https://api.github.com/users/Speedy37/following{/other_user}", "gists_url": "https://api.github.com/users/Speedy37/gists{/gist_id}", "starred_url": "https://api.github.com/users/Speedy37/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Speedy37/subscriptions", "organizations_url": "https://api.github.com/users/Speedy37/orgs", "repos_url": "https://api.github.com/users/Speedy37/repos", "events_url": "https://api.github.com/users/Speedy37/events{/privacy}", "received_events_url": "https://api.github.com/users/Speedy37/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/72609/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/72609/timeline", "performed_via_github_app": null, "state_reason": "completed"}