{"url": "https://api.github.com/repos/rust-lang/rust/issues/1286", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/1286/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/1286/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/1286/events", "html_url": "https://github.com/rust-lang/rust/issues/1286", "id": 2532219, "node_id": "MDU6SXNzdWUyNTMyMjE5", "number": 1286, "title": "crash: Assertion cx.fcx.llobjfields.contains_key(did.node) failed at src/comp/middle/trans.rs:2914", "user": {"login": "elly", "id": 218734, "node_id": "MDQ6VXNlcjIxODczNA==", "avatar_url": "https://avatars.githubusercontent.com/u/218734?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elly", "html_url": "https://github.com/elly", "followers_url": "https://api.github.com/users/elly/followers", "following_url": "https://api.github.com/users/elly/following{/other_user}", "gists_url": "https://api.github.com/users/elly/gists{/gist_id}", "starred_url": "https://api.github.com/users/elly/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elly/subscriptions", "organizations_url": "https://api.github.com/users/elly/orgs", "repos_url": "https://api.github.com/users/elly/repos", "events_url": "https://api.github.com/users/elly/events{/privacy}", "received_events_url": "https://api.github.com/users/elly/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2011-12-13T02:54:30Z", "updated_at": "2012-01-13T20:27:53Z", "closed_at": "2012-01-13T20:27:53Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "The following code crashes rustc f05eaa4a650132174a43113e7bf1bce293515428 (2011-12-09):\n\n```\nuse std;\n\nimport std::option;\nimport std::ptr;\nimport std::str;\nimport std::vec;\n#[link_name = \"pcre\"]\nnative mod _native {\n    type _pcre;\n    type _pcre_extra;\n    fn pcre_exec(re: *_pcre, extra: *_pcre_extra, subject: str::sbuf,\n                 length: int, startoffset: int, options: int,\n                 ovector: *int, ovecsize: int);\n}\n\nobj pcre(_re: *_native::_pcre) {\n    fn match(target: str) -> option::t<[str]> unsafe {\n        let oveclen = 30;\n        let ovec = vec::init_elt_mut::<int>(0, oveclen as uint);\n        let ovecp = vec::unsafe::to_ptr::<int>(ovec);\n        let r = str::as_buf(target, { |_target|\n            _native::pcre_exec(_re, ptr::null(),\n                               _target, str::byte_len(target) as int,\n                               0, 0, ovecp, oveclen)\n        });\n        ret option::none;\n    }\n}\n```\n\nStack:\n(gdb) bt full\n#0  upcall_fail (expr=0x5fd750 \"Assertion cx.fcx.llobjfields.contains_key(did.node) failed\",\n\n```\nfile=0x5fd790 \"src/comp/middle/trans.rs\", line=2914) at ./src/rt/rust_upcall.cpp:65\n```\n\nNo locals.\n#1  0x0000000000445ef1 in middle::trans::trans_local_var::_adf4c1777aa541de ()\n\nNo symbol table info available.\n#2  0x00000000004469ac in middle::trans::trans_var::_d1e14f52b7acf547 ()\n\nNo symbol table info available.\n#3  0x00000000004461b0 in middle::trans::trans_path::_5717eb102c51bae9 ()\n\nNo symbol table info available.\n#4  0x0000000000448af2 in middle::trans::trans_lval::_1f6f126aa370757e ()\n\nNo symbol table info available.\n#5  0x0000000000450c41 in middle::trans::trans_temp_lval::_1f6f126aa370757e ()\n\nNo symbol table info available.\n#6  0x000000000044ca53 in middle::trans::trans_arg_expr::_f2ab945cefa5f446 ()\n\nNo symbol table info available.\n#7  0x000000000044dde0 in middle::trans::trans_args::_5b185ed913f17816 ()\n\nNo symbol table info available.\n#8  0x000000000044e1ea in middle::trans::trans_call::_9bc861feeed3fbef ()\n\nNo symbol table info available.\n#9  0x0000000000451be9 in middle::trans::trans_expr::_e7480723aeaebdfe ()\n\nNo symbol table info available.\n#10 0x000000000045873b in middle::trans::trans_block_dps::_95df69d395a561cc ()\n\nNo symbol table info available.\n#11 0x000000000045a884 in middle::trans::trans_closure::_5f30b7b117e0c7c7 ()\n\nNo symbol table info available.\n#12 0x000000000043e92e in middle::trans::trans_expr_fn::_9276f38be3371c81 ()\n\nNo symbol table info available.\n#13 0x0000000000451ace in middle::trans::trans_expr::_e7480723aeaebdfe ()\n\nNo symbol table info available.\n#14 0x0000000000450b1c in middle::trans::trans_expr_save_in::_58e068603372c187 ()\n\nNo symbol table info available.\n#15 0x0000000000451093 in middle::trans::trans_temp_lval::_1f6f126aa370757e ()\n\nNo symbol table info available.\n#16 0x000000000044ca53 in middle::trans::trans_arg_expr::_f2ab945cefa5f446 ()\n\nNo symbol table info available.\n#17 0x000000000044dde0 in middle::trans::trans_args::_5b185ed913f17816 ()\n\nNo symbol table info available.\n#18 0x000000000044e1ea in middle::trans::trans_call::_9bc861feeed3fbef ()\n\nNo symbol table info available.\n#19 0x0000000000451be9 in middle::trans::trans_expr::_e7480723aeaebdfe ()\n\nNo symbol table info available.\n#20 0x0000000000450eea in middle::trans::trans_temp_lval::_1f6f126aa370757e ()\n\nNo symbol table info available.\n#21 0x000000000045624b in middle::trans::init_local::_6fb0f262f37ff83d ()\n\nNo symbol table info available.\n#22 0x0000000000456dc2 in middle::trans::trans_stmt::_c6405279a5bafb3f ()\n\nNo symbol table info available.\n#23 0x00000000004584df in middle::trans::trans_block_dps::_95df69d395a561cc ()\n\nNo symbol table info available.\n#24 0x000000000045a884 in middle::trans::trans_closure::_5f30b7b117e0c7c7 ()\n\nNo symbol table info available.\n#25 0x000000000045ab8b in middle::trans::trans_fn::_3faad8b8f452ee78 ()\n\nNo symbol table info available.\n#26 0x00000000004848a1 in middle::trans_objects::process_normal_mthd::_58e8157eea4a94d2 ()\n\nNo symbol table info available.\n#27 0x0000000000480b2d in middle::trans_objects::create_vtbl::_2bedb929f9a5e9c4 ()\n\nNo symbol table info available.\n#28 0x000000000047bceb in middle::trans_objects::trans_obj::_fcc8a3a1f08fa3a2 ()\n\nNo symbol table info available.\n#29 0x000000000045f81f in middle::trans::trans_item::_736b03787cae8654 ()\n\nNo symbol table info available.\n#30 0x0000000000469778 in middle::trans::trans_crate::_5e8b9ab58c8b592f ()\n\nNo symbol table info available.\n#31 0x00000000005f3df0 in driver::rustc::compile_input::thunk9162 ()\n\nNo symbol table info available.\n#32 0x00000000005a6998 in driver::rustc::time::_3e691b2a4ba58aee ()\n\nNo symbol table info available.\n#33 0x00000000005a94dd in driver::rustc::compile_input::_7475af45dcc3eb6c ()\n\nNo symbol table info available.\n#34 0x00000000005b10ef in driver::rustc::main::_cd8b8c8185af3dee ()\n\nNo symbol table info available.\n#35 0x00007ffff601e306 in task_start_wrapper (a=0x7ffff511f014) at ./src/rt/rust_task.cpp:176\n\n```\n    task = 0x8c1cc0\n    rval = 42\n    failed = false\n    env = <optimized out>\n```\n#36 0x00000000deadbeef in ?? ()\n\nNo symbol table info available.\n#37 0x008c1cc000000000 in ?? ()\n\nNo symbol table info available.\n#38 0x0000000000000000 in ?? ()\n\nNo symbol table info available.\n\nI have not tried reproducing with HEAD yet as HEAD does not build for me right now.\n", "closed_by": {"login": "marijnh", "id": 144427, "node_id": "MDQ6VXNlcjE0NDQyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/144427?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marijnh", "html_url": "https://github.com/marijnh", "followers_url": "https://api.github.com/users/marijnh/followers", "following_url": "https://api.github.com/users/marijnh/following{/other_user}", "gists_url": "https://api.github.com/users/marijnh/gists{/gist_id}", "starred_url": "https://api.github.com/users/marijnh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marijnh/subscriptions", "organizations_url": "https://api.github.com/users/marijnh/orgs", "repos_url": "https://api.github.com/users/marijnh/repos", "events_url": "https://api.github.com/users/marijnh/events{/privacy}", "received_events_url": "https://api.github.com/users/marijnh/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/1286/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/1286/timeline", "performed_via_github_app": null, "state_reason": "completed"}