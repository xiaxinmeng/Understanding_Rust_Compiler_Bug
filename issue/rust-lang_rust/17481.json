{"url": "https://api.github.com/repos/rust-lang/rust/issues/17481", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/17481/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/17481/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/17481/events", "html_url": "https://github.com/rust-lang/rust/issues/17481", "id": 43653243, "node_id": "MDU6SXNzdWU0MzY1MzI0Mw==", "number": 17481, "title": "Need documentations on pointer casts", "user": {"login": "nodakai", "id": 90726, "node_id": "MDQ6VXNlcjkwNzI2", "avatar_url": "https://avatars.githubusercontent.com/u/90726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nodakai", "html_url": "https://github.com/nodakai", "followers_url": "https://api.github.com/users/nodakai/followers", "following_url": "https://api.github.com/users/nodakai/following{/other_user}", "gists_url": "https://api.github.com/users/nodakai/gists{/gist_id}", "starred_url": "https://api.github.com/users/nodakai/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nodakai/subscriptions", "organizations_url": "https://api.github.com/users/nodakai/orgs", "repos_url": "https://api.github.com/users/nodakai/repos", "events_url": "https://api.github.com/users/nodakai/events{/privacy}", "received_events_url": "https://api.github.com/users/nodakai/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2014-09-23T16:42:24Z", "updated_at": "2015-03-09T18:32:23Z", "closed_at": "2015-03-09T18:32:23Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "This is how the language reference describes the cast experssions:\n- http://doc.rust-lang.org/rust.html#type-cast-expressions\n\n> Executing an as expression casts the value on the left-hand side to the type on the right-hand side.\n> \n> A numeric value can be cast to any numeric type. A raw pointer value can be cast to or from any integral type or raw pointer type. Any other cast is unsupported and will fail to compile.\n\nHowever, grepping for `as .* as` in `src/libnative`, for example, finds many instances of cast expressions which deviate from the above description.  For example\n- https://github.com/rust-lang/rust/blob/master/src/libnative/io/net.rs#L245\n\n``` rs\n          let mut storage = unsafe { mem::zeroed() };\n(...snip...)\n          let addrp = &storage as *const _ as *const libc::sockaddr;\n```\n1. It seems like one can cast a refernce into a raw pointer.   I assume that a reference is not of an \"integral type,\" though the reference doesn't define what is an \"integral type.\"\n2. The use of underscore in the cast expression seems to play the role of `const_cast` in C++ but is not described anywhere.\n\nAs for the above particular instance, the combination of [`ref_slice()`](http://doc.rust-lang.org/std/slice/fn.ref_slice.html) and [`as_ptr()`](http://doc.rust-lang.org/std/slice/trait.ImmutableSlice.html#tymethod.as_ptr) seems \"more standard-compliant\" to me and makes me wonder if the above special casts are really essential to Rust (`ref_slice()` is built on top of the magical intrinsic [`transmute()`](http://doc.rust-lang.org/core/intrinsics/ffi.transmute.html)).\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/17481/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/17481/timeline", "performed_via_github_app": null, "state_reason": "completed"}