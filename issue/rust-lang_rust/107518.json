{"url": "https://api.github.com/repos/rust-lang/rust/issues/107518", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/107518/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/107518/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/107518/events", "html_url": "https://github.com/rust-lang/rust/issues/107518", "id": 1564498931, "node_id": "I_kwDOAAsO6M5dQFvz", "number": 107518, "title": "parser: `[elem; count]` is strong signal that an array literal was intended", "user": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 235791, "node_id": "MDU6TGFiZWwyMzU3OTE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-diagnostics", "name": "A-diagnostics", "color": "f7e101", "default": false, "description": "Area: Messages for errors, warnings, and lints"}, {"id": 27424086, "node_id": "MDU6TGFiZWwyNzQyNDA4Ng==", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-parser", "name": "A-parser", "color": "f7e101", "default": false, "description": "Area: The parsing of Rust source code to an AST."}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}], "state": "open", "locked": false, "assignee": {"login": "obeis", "id": 54103142, "node_id": "MDQ6VXNlcjU0MTAzMTQy", "avatar_url": "https://avatars.githubusercontent.com/u/54103142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/obeis", "html_url": "https://github.com/obeis", "followers_url": "https://api.github.com/users/obeis/followers", "following_url": "https://api.github.com/users/obeis/following{/other_user}", "gists_url": "https://api.github.com/users/obeis/gists{/gist_id}", "starred_url": "https://api.github.com/users/obeis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/obeis/subscriptions", "organizations_url": "https://api.github.com/users/obeis/orgs", "repos_url": "https://api.github.com/users/obeis/repos", "events_url": "https://api.github.com/users/obeis/events{/privacy}", "received_events_url": "https://api.github.com/users/obeis/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "obeis", "id": 54103142, "node_id": "MDQ6VXNlcjU0MTAzMTQy", "avatar_url": "https://avatars.githubusercontent.com/u/54103142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/obeis", "html_url": "https://github.com/obeis", "followers_url": "https://api.github.com/users/obeis/followers", "following_url": "https://api.github.com/users/obeis/following{/other_user}", "gists_url": "https://api.github.com/users/obeis/gists{/gist_id}", "starred_url": "https://api.github.com/users/obeis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/obeis/subscriptions", "organizations_url": "https://api.github.com/users/obeis/orgs", "repos_url": "https://api.github.com/users/obeis/repos", "events_url": "https://api.github.com/users/obeis/events{/privacy}", "received_events_url": "https://api.github.com/users/obeis/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2023-01-31T15:10:03Z", "updated_at": "2023-02-02T11:45:10Z", "closed_at": null, "author_association": "MEMBER", "active_lock_reason": null, "body": "### Code\n\n```Rust\nfn main() {\n    (a_function_that_takes_an_array[0; 10]);\n}\n\nfn a_function_that_takes_an_array(arg: [u8; 10]) {\n    let _ = arg;\n}\n```\n\n\n### Current output\n\n```Shell\nerror: expected one of `.`, `?`, `]`, or an operator, found `;`\n --> src/main.rs:2:38\n  |\n2 |     (a_function_that_takes_an_array[0; 10]);\n  |                                      ^ expected one of `.`, `?`, `]`, or an operator\n```\n\n\n### Desired output\n\n```Shell\nerror: expected one of `.`, `?`, `]`, or an operator, found `;`\n --> src/main.rs:2:38\n  |\n2 |     (a_function_that_takes_an_array[0; 10]);\n  |                                      ^ expected one of `.`, `?`, `]`, or an operator\n\nnote: `[0; 10]` would construct an array literal, but not immediately following the identifier `a_function_that_takes_an_array`\n```\nthat is, In addition to the current parser error, it would be nice if the diagnostic included a note or suggestion that while `[elem; count]` can be used to construct an array literal, the tokens above cannot be an array literal because of the immediately preceding identifier.\n\n(I suppose in an ideal world it would even suggest adding the parentheses to turn it into a function call, but that would require more context than I think we can expect to have at this point in the context of where the parser is.)\n\n\n### Rationale and extra context\n\nI'll be honest, I left out the call parentheses by accident, and then kept staring at the rustc error message trying to understand why it wouldn't accept a semi-colon there.\n\n### Other cases\n\n_No response_\n\n### Anything else?\n\n_No response_\n\n<!-- TRIAGEBOT_START -->\n\n<!-- TRIAGEBOT_ASSIGN_START -->\n\n<!-- TRIAGEBOT_ASSIGN_DATA_START$${\"user\":\"obeis\"}$$TRIAGEBOT_ASSIGN_DATA_END -->\n\n<!-- TRIAGEBOT_ASSIGN_END -->\n<!-- TRIAGEBOT_END -->", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/107518/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/107518/timeline", "performed_via_github_app": null, "state_reason": null}