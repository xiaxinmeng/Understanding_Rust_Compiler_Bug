{"url": "https://api.github.com/repos/rust-lang/rust/issues/99285", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/99285/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/99285/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/99285/events", "html_url": "https://github.com/rust-lang/rust/issues/99285", "id": 1306162864, "node_id": "I_kwDOAAsO6M5N2naw", "number": 99285, "title": "rust fixed lib compiler bug report", "user": {"login": "pakchu", "id": 83414365, "node_id": "MDQ6VXNlcjgzNDE0MzY1", "avatar_url": "https://avatars.githubusercontent.com/u/83414365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pakchu", "html_url": "https://github.com/pakchu", "followers_url": "https://api.github.com/users/pakchu/followers", "following_url": "https://api.github.com/users/pakchu/following{/other_user}", "gists_url": "https://api.github.com/users/pakchu/gists{/gist_id}", "starred_url": "https://api.github.com/users/pakchu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pakchu/subscriptions", "organizations_url": "https://api.github.com/users/pakchu/orgs", "repos_url": "https://api.github.com/users/pakchu/repos", "events_url": "https://api.github.com/users/pakchu/events{/privacy}", "received_events_url": "https://api.github.com/users/pakchu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-07-15T15:21:04Z", "updated_at": "2022-07-18T05:35:50Z", "closed_at": "2022-07-15T16:19:39Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!--\r\nThank you for finding an Internal Compiler Error! \ud83e\uddca  If possible, try to provide\r\na minimal verifiable example. You can read \"Rust Bug Minimization Patterns\" for\r\nhow to create smaller examples.\r\n\r\nhttp://blog.pnkfx.org/blog/2019/11/18/rust-bug-minimization-patterns/\r\n\r\n-->\r\n### Code\r\n\r\n```rust\r\nuse wasm_bindgen::prelude::*;\r\nuse primitive_types::{U128};\r\nuse bn_rs::{BN};\r\nuse fixed::types::{U64F64};\r\nuse fixed_macro::fixed;\r\n```\r\n\r\n```Rust\r\nlet UNIT = fixed!(1: U64F64);\r\nUNIT.checked_div(UNIT).ok_or(\"err\".into())?;\r\nUNIT.checked_mul(UNIT).ok_or(\"err\".into())?;\r\n```\r\n\r\n\r\n### Meta\r\n<!--\r\nIf you're using the stable version of the compiler, you should also check if the\r\nbug also exists in the beta or nightly versions.\r\n-->\r\n\r\n`rustc --version --verbose`: \r\n```\r\nrustc 1.63.0-nightly (7466d5492 2022-06-08) running on aarch64-apple-darwin\r\n```\r\n\r\n### Error output\r\n\r\n```\r\nwasm-pack build --target web --out-dir pkg\r\nerror: internal compiler error: compiler/rustc_infer/src/infer/error_reporting/need_type_info.rs:856:33: unexpected path: def=fixed::FixedU128 substs=[_] path=Path { span: src/processor/------.rs:81:24: 81:30 (#0), res: Def(TyAlias, DefId(48:2684 ~ fixed[c9e8]::types::U64F64)), segments: [PathSegment { ident: U64F64#0, hir_id: Some(HirId { owner: DefId(0:269 ~ wasm_lib[ee1e]::processor::redeem_scoin::redeem_scoin), local_id: 289 }), res: Some(Err), args: None, infer_args: true }] }\r\n```\r\n\r\n<!--\r\nInclude a backtrace in the code block by setting `RUST_BACKTRACE=1` in your\r\nenvironment. E.g. `RUST_BACKTRACE=1 cargo build`.\r\n-->\r\n<details><summary><strong>Backtrace</strong></summary>\r\n<p>\r\n\r\n```\r\n   0:        0x102bd80a0 - <std::sys_common::backtrace::_print::DisplayBacktrace as core::fmt::Display>::fmt::hde752db13242e021\r\n   1:        0x102c29a7c - core::fmt::write::he42b506f88f92bfc\r\n   2:        0x102bcb238 - std::io::Write::write_fmt::h59778b0808657569\r\n   3:        0x102bdace4 - std::panicking::default_hook::{{closure}}::he974fbd0dc8e9aeb\r\n   4:        0x102bdaa4c - std::panicking::default_hook::h9792b3a9b49b23c2\r\n   5:        0x10a0160fc - rustc_driver[d271e0a0d2aa583b]::DEFAULT_HOOK::{closure#0}::{closure#0}\r\n   6:        0x102bdb2b4 - std::panicking::rust_panic_with_hook::h34cc422549cb17b7\r\n   7:        0x10dafa044 - std[7d28c98a4717d82b]::panicking::begin_panic::<rustc_errors[dbfcf3c0a19e4173]::ExplicitBug>::{closure#0}\r\n   8:        0x10daf7fac - std[7d28c98a4717d82b]::sys_common::backtrace::__rust_end_short_backtrace::<std[7d28c98a4717d82b]::panicking::begin_panic<rustc_errors[dbfcf3c0a19e4173]::ExplicitBug>::{closure#0}, !>\r\n   9:        0x10df2cb50 - std[7d28c98a4717d82b]::panicking::begin_panic::<rustc_errors[dbfcf3c0a19e4173]::ExplicitBug>\r\n  10:        0x10d9a42ac - std[7d28c98a4717d82b]::panic::panic_any::<rustc_errors[dbfcf3c0a19e4173]::ExplicitBug>\r\n  11:        0x10d9a32c4 - <rustc_errors[dbfcf3c0a19e4173]::HandlerInner>::bug::<&alloc[8cc36b716931503d]::string::String>\r\n  12:        0x10d9a2ddc - <rustc_errors[dbfcf3c0a19e4173]::Handler>::bug::<&alloc[8cc36b716931503d]::string::String>\r\n  13:        0x10daecda8 - rustc_middle[d59b55b8f0e39838]::ty::context::tls::with_opt::<rustc_middle[d59b55b8f0e39838]::util::bug::opt_span_bug_fmt<rustc_span[1b38c13cc2ce07a6]::span_encoding::Span>::{closure#0}, ()>\r\n  14:        0x10daeee8c - rustc_middle[d59b55b8f0e39838]::util::bug::opt_span_bug_fmt::<rustc_span[1b38c13cc2ce07a6]::span_encoding::Span>\r\n  15:        0x10df31494 - rustc_middle[d59b55b8f0e39838]::util::bug::bug_fmt\r\n  16:        0x10d924ec8 - <rustc_infer[4f7f67cfa43fff7f]::infer::error_reporting::need_type_info::FindInferSourceVisitor>::path_inferred_subst_iter\r\n  17:        0x10d925470 - <rustc_infer[4f7f67cfa43fff7f]::infer::error_reporting::need_type_info::FindInferSourceVisitor as rustc_hir[ae629406fc00d7b7]::intravisit::Visitor>::visit_expr\r\n  18:        0x10d925334 - <rustc_infer[4f7f67cfa43fff7f]::infer::error_reporting::need_type_info::FindInferSourceVisitor as rustc_hir[ae629406fc00d7b7]::intravisit::Visitor>::visit_expr\r\n  19:        0x10d924f24 - <rustc_infer[4f7f67cfa43fff7f]::infer::error_reporting::need_type_info::FindInferSourceVisitor as rustc_hir[ae629406fc00d7b7]::intravisit::Visitor>::visit_local\r\n  20:        0x10d958aa8 - rustc_hir[ae629406fc00d7b7]::intravisit::walk_expr::<rustc_infer[4f7f67cfa43fff7f]::infer::error_reporting::need_type_info::FindInferSourceVisitor>\r\n  21:        0x10d9253a8 - <rustc_infer[4f7f67cfa43fff7f]::infer::error_reporting::need_type_info::FindInferSourceVisitor as rustc_hir[ae629406fc00d7b7]::intravisit::Visitor>::visit_expr\r\n  22:        0x10d8de368 - <rustc_infer[4f7f67cfa43fff7f]::infer::InferCtxt>::emit_inference_failure_err\r\n  23:        0x10d7dbdc8 - <rustc_infer[4f7f67cfa43fff7f]::infer::InferCtxt as rustc_trait_selection[aae2294900684d7]::traits::error_reporting::InferCtxtPrivExt>::maybe_report_ambiguity\r\n  24:        0x10d7cf134 - <rustc_infer[4f7f67cfa43fff7f]::infer::InferCtxt as rustc_trait_selection[aae2294900684d7]::traits::error_reporting::InferCtxtExt>::report_fulfillment_errors\r\n  25:        0x10c428bbc - <rustc_typeck[c24a65d189243149]::check::fn_ctxt::FnCtxt>::select_all_obligations_or_error\r\n  26:        0x10c5421f4 - <rustc_infer[4f7f67cfa43fff7f]::infer::InferCtxtBuilder>::enter::<&rustc_middle[d59b55b8f0e39838]::ty::context::TypeckResults, <rustc_typeck[c24a65d189243149]::check::inherited::InheritedBuilder>::enter<rustc_typeck[c24a65d189243149]::check::typeck_with_fallback<rustc_typeck[c24a65d189243149]::check::typeck::{closure#0}>::{closure#1}, &rustc_middle[d59b55b8f0e39838]::ty::context::TypeckResults>::{closure#0}>\r\n  27:        0x10c4c6c2c - rustc_typeck[c24a65d189243149]::check::typeck\r\n  28:        0x10cdb22b4 - rustc_query_system[6fcf32eb3cba365a]::query::plumbing::try_execute_query::<rustc_query_impl[b8baef6b6c943c86]::plumbing::QueryCtxt, rustc_query_system[6fcf32eb3cba365a]::query::caches::DefaultCache<rustc_span[1b38c13cc2ce07a6]::def_id::LocalDefId, &rustc_middle[d59b55b8f0e39838]::ty::context::TypeckResults>>\r\n  29:        0x10ce8803c - rustc_query_system[6fcf32eb3cba365a]::query::plumbing::get_query::<rustc_query_impl[b8baef6b6c943c86]::queries::typeck, rustc_query_impl[b8baef6b6c943c86]::plumbing::QueryCtxt>\r\n  30:        0x10c5fb9bc - <rustc_middle[d59b55b8f0e39838]::hir::map::Map>::par_body_owners::<rustc_typeck[c24a65d189243149]::check::typeck_item_bodies::{closure#0}>\r\n  31:        0x10c4caa70 - rustc_typeck[c24a65d189243149]::check::typeck_item_bodies\r\n  32:        0x10cdf347c - rustc_query_system[6fcf32eb3cba365a]::query::plumbing::try_execute_query::<rustc_query_impl[b8baef6b6c943c86]::plumbing::QueryCtxt, rustc_query_system[6fcf32eb3cba365a]::query::caches::DefaultCache<(), ()>>\r\n  33:        0x10ce57d74 - rustc_query_system[6fcf32eb3cba365a]::query::plumbing::get_query::<rustc_query_impl[b8baef6b6c943c86]::queries::typeck_item_bodies, rustc_query_impl[b8baef6b6c943c86]::plumbing::QueryCtxt>\r\n  34:        0x10c584684 - <rustc_session[f4ecd01eb52fedb9]::session::Session>::time::<(), rustc_typeck[c24a65d189243149]::check_crate::{closure#7}>\r\n  35:        0x10c5334ec - rustc_typeck[c24a65d189243149]::check_crate\r\n  36:        0x10a11ccf0 - rustc_interface[57ddf632de9ef42d]::passes::analysis\r\n  37:        0x10cde8574 - rustc_query_system[6fcf32eb3cba365a]::query::plumbing::try_execute_query::<rustc_query_impl[b8baef6b6c943c86]::plumbing::QueryCtxt, rustc_query_system[6fcf32eb3cba365a]::query::caches::DefaultCache<(), core[916dbafceb7a8008]::result::Result<(), rustc_errors[dbfcf3c0a19e4173]::ErrorGuaranteed>>>\r\n  38:        0x10ce88490 - rustc_query_system[6fcf32eb3cba365a]::query::plumbing::get_query::<rustc_query_impl[b8baef6b6c943c86]::queries::analysis, rustc_query_impl[b8baef6b6c943c86]::plumbing::QueryCtxt>\r\n  39:        0x109fd8a2c - <rustc_interface[57ddf632de9ef42d]::passes::QueryContext>::enter::<rustc_driver[d271e0a0d2aa583b]::run_compiler::{closure#1}::{closure#2}::{closure#3}, core[916dbafceb7a8008]::result::Result<(), rustc_errors[dbfcf3c0a19e4173]::ErrorGuaranteed>>\r\n  40:        0x109fbbda0 - <rustc_interface[57ddf632de9ef42d]::interface::Compiler>::enter::<rustc_driver[d271e0a0d2aa583b]::run_compiler::{closure#1}::{closure#2}, core[916dbafceb7a8008]::result::Result<core[916dbafceb7a8008]::option::Option<rustc_interface[57ddf632de9ef42d]::queries::Linker>, rustc_errors[dbfcf3c0a19e4173]::ErrorGuaranteed>>\r\n  41:        0x10a017fe4 - rustc_span[1b38c13cc2ce07a6]::with_source_map::<core[916dbafceb7a8008]::result::Result<(), rustc_errors[dbfcf3c0a19e4173]::ErrorGuaranteed>, rustc_interface[57ddf632de9ef42d]::interface::create_compiler_and_run<core[916dbafceb7a8008]::result::Result<(), rustc_errors[dbfcf3c0a19e4173]::ErrorGuaranteed>, rustc_driver[d271e0a0d2aa583b]::run_compiler::{closure#1}>::{closure#1}>\r\n  42:        0x109fbc58c - <scoped_tls[1d5dd8b2c49b60cd]::ScopedKey<rustc_span[1b38c13cc2ce07a6]::SessionGlobals>>::set::<rustc_interface[57ddf632de9ef42d]::interface::run_compiler<core[916dbafceb7a8008]::result::Result<(), rustc_errors[dbfcf3c0a19e4173]::ErrorGuaranteed>, rustc_driver[d271e0a0d2aa583b]::run_compiler::{closure#1}>::{closure#0}, core[916dbafceb7a8008]::result::Result<(), rustc_errors[dbfcf3c0a19e4173]::ErrorGuaranteed>>\r\n  43:        0x10a0050bc - std[7d28c98a4717d82b]::sys_common::backtrace::__rust_begin_short_backtrace::<rustc_interface[57ddf632de9ef42d]::util::run_in_thread_pool_with_globals<rustc_interface[57ddf632de9ef42d]::interface::run_compiler<core[916dbafceb7a8008]::result::Result<(), rustc_errors[dbfcf3c0a19e4173]::ErrorGuaranteed>, rustc_driver[d271e0a0d2aa583b]::run_compiler::{closure#1}>::{closure#0}, core[916dbafceb7a8008]::result::Result<(), rustc_errors[dbfcf3c0a19e4173]::ErrorGuaranteed>>::{closure#0}, core[916dbafceb7a8008]::result::Result<(), rustc_errors[dbfcf3c0a19e4173]::ErrorGuaranteed>>\r\n  44:        0x109fdb098 - <<std[7d28c98a4717d82b]::thread::Builder>::spawn_unchecked_<rustc_interface[57ddf632de9ef42d]::util::run_in_thread_pool_with_globals<rustc_interface[57ddf632de9ef42d]::interface::run_compiler<core[916dbafceb7a8008]::result::Result<(), rustc_errors[dbfcf3c0a19e4173]::ErrorGuaranteed>, rustc_driver[d271e0a0d2aa583b]::run_compiler::{closure#1}>::{closure#0}, core[916dbafceb7a8008]::result::Result<(), rustc_errors[dbfcf3c0a19e4173]::ErrorGuaranteed>>::{closure#0}, core[916dbafceb7a8008]::result::Result<(), rustc_errors[dbfcf3c0a19e4173]::ErrorGuaranteed>>::{closure#1} as core[916dbafceb7a8008]::ops::function::FnOnce<()>>::call_once::{shim:vtable#0}\r\n  45:        0x102be3b10 - std::sys::unix::thread::Thread::new::thread_start::h38629fa1e913d802\r\n  46:        0x1b956826c - __pthread_deallocate\r\n``` \r\n</p>\r\n</details>\r\n\r\nin the `Cargo.toml`:\r\n\r\n```toml\r\n[dependencies]\r\nserde = { version = \"1.0\", features = [\"derive\"] }\r\nwasm-bindgen = { version = \"0.2\", features = [\"serde-serialize\"] }\r\nfixed = \"=1.11.0\"\r\nfixed-macro = \"1.1\"\r\nfixed-sqrt = \"0.2.4\"\r\nprimitive-types = \"0.11.1\"\r\nbn-rs = \"0.2.3\"\r\n```", "closed_by": {"login": "pakchu", "id": 83414365, "node_id": "MDQ6VXNlcjgzNDE0MzY1", "avatar_url": "https://avatars.githubusercontent.com/u/83414365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pakchu", "html_url": "https://github.com/pakchu", "followers_url": "https://api.github.com/users/pakchu/followers", "following_url": "https://api.github.com/users/pakchu/following{/other_user}", "gists_url": "https://api.github.com/users/pakchu/gists{/gist_id}", "starred_url": "https://api.github.com/users/pakchu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pakchu/subscriptions", "organizations_url": "https://api.github.com/users/pakchu/orgs", "repos_url": "https://api.github.com/users/pakchu/repos", "events_url": "https://api.github.com/users/pakchu/events{/privacy}", "received_events_url": "https://api.github.com/users/pakchu/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/99285/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/99285/timeline", "performed_via_github_app": null, "state_reason": "completed"}