{"url": "https://api.github.com/repos/rust-lang/rust/issues/93422", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/93422/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/93422/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/93422/events", "html_url": "https://github.com/rust-lang/rust/issues/93422", "id": 1117425993, "node_id": "I_kwDOAAsO6M5CmpFJ", "number": 93422, "title": "docs.rs fails to build ", "user": {"login": "michidk", "id": 3979930, "node_id": "MDQ6VXNlcjM5Nzk5MzA=", "avatar_url": "https://avatars.githubusercontent.com/u/3979930?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michidk", "html_url": "https://github.com/michidk", "followers_url": "https://api.github.com/users/michidk/followers", "following_url": "https://api.github.com/users/michidk/following{/other_user}", "gists_url": "https://api.github.com/users/michidk/gists{/gist_id}", "starred_url": "https://api.github.com/users/michidk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michidk/subscriptions", "organizations_url": "https://api.github.com/users/michidk/orgs", "repos_url": "https://api.github.com/users/michidk/repos", "events_url": "https://api.github.com/users/michidk/events{/privacy}", "received_events_url": "https://api.github.com/users/michidk/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-01-28T13:47:18Z", "updated_at": "2022-01-28T13:57:40Z", "closed_at": "2022-01-28T13:56:20Z", "author_association": "NONE", "active_lock_reason": null, "body": "When pushing my crate [off-rs](https://github.com/michidk/off-rs) to crates.io the docs build fails on docs.rs with the following error:\r\n```\r\n[INFO] [stderr]  Documenting off-rs v0.1.3 (/opt/rustwide/workdir)\r\n[INFO] [stderr] thread 'rustc' panicked at 'no entry found for key', src/librustdoc/passes/collect_intra_doc_links.rs:929:16\r\n[INFO] [stderr] note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace\r\n[INFO] [stderr] \r\n[INFO] [stderr] error: internal compiler error: unexpected panic\r\n[INFO] [stderr] \r\n[INFO] [stderr] error: Unrecognized option: 'resource-suffix'\r\n[INFO] [stderr] \r\n[INFO] [stderr] error: could not document `off-rs`\r\n```\r\n\r\nI haven't got it to work ever since it first failed (the first version worked). The repo is here: https://github.com/michidk/off-rs/tree/6a0146d4f2cadb1e46ce8849abd0269cd97d3528\r\nBuilding the docs locally on my machine works without any issues, even on nightly.\r\n\r\nI expected to see this happen: Docs build successfully on docs.rs\r\n\r\nInstead, this happened: Rust panics, full log: https://docs.rs/crate/off-rs/0.1.3/builds/500166\r\n\r\nEdit: Can replicated it locally, by using rustc v 1.58.1. With v1.58 it worked, with v1.58.1 it fails using this command `rustdoc +nightly --edition=2021 --crate-type lib --crate-name off_rs src/lib.rs --target x86_64-unknown-linux-gnu -o target/x86_64-unknown-linux-gnu/doc --error-format=json --json=diagnostic-rendered-ansi,artifacts,future-incompat -C metadata=390ff25bd5d00bc9 -L dependency=target/x86_64-unknown-linux-gnu/debug/deps -L dependency=target/debug/deps -Z unstable-options --emit=invocation-specific --resource-suffix -20220126-1.60.0-nightly-6abb6385b --static-root-path / --cap-lints warn --disable-per-crate-search --crate-version 0.1.3`\r\n\r\nSeems like `--resource-suffix` was removed from rust without adjusting docs.rs\r\n\r\n", "closed_by": {"login": "michidk", "id": 3979930, "node_id": "MDQ6VXNlcjM5Nzk5MzA=", "avatar_url": "https://avatars.githubusercontent.com/u/3979930?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michidk", "html_url": "https://github.com/michidk", "followers_url": "https://api.github.com/users/michidk/followers", "following_url": "https://api.github.com/users/michidk/following{/other_user}", "gists_url": "https://api.github.com/users/michidk/gists{/gist_id}", "starred_url": "https://api.github.com/users/michidk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michidk/subscriptions", "organizations_url": "https://api.github.com/users/michidk/orgs", "repos_url": "https://api.github.com/users/michidk/repos", "events_url": "https://api.github.com/users/michidk/events{/privacy}", "received_events_url": "https://api.github.com/users/michidk/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/93422/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/93422/timeline", "performed_via_github_app": null, "state_reason": "completed"}