{"url": "https://api.github.com/repos/rust-lang/rust-clippy/issues/9583", "repository_url": "https://api.github.com/repos/rust-lang/rust-clippy", "labels_url": "https://api.github.com/repos/rust-lang/rust-clippy/issues/9583/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust-clippy/issues/9583/comments", "events_url": "https://api.github.com/repos/rust-lang/rust-clippy/issues/9583/events", "html_url": "https://github.com/rust-lang/rust-clippy/issues/9583", "id": 1394510588, "node_id": "I_kwDOAZm0i85THor8", "number": 9583, "title": "cargo clippy --fix generated broken code", "user": {"login": "rbtcollins", "id": 499678, "node_id": "MDQ6VXNlcjQ5OTY3OA==", "avatar_url": "https://avatars.githubusercontent.com/u/499678?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rbtcollins", "html_url": "https://github.com/rbtcollins", "followers_url": "https://api.github.com/users/rbtcollins/followers", "following_url": "https://api.github.com/users/rbtcollins/following{/other_user}", "gists_url": "https://api.github.com/users/rbtcollins/gists{/gist_id}", "starred_url": "https://api.github.com/users/rbtcollins/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rbtcollins/subscriptions", "organizations_url": "https://api.github.com/users/rbtcollins/orgs", "repos_url": "https://api.github.com/users/rbtcollins/repos", "events_url": "https://api.github.com/users/rbtcollins/events{/privacy}", "received_events_url": "https://api.github.com/users/rbtcollins/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149309557, "node_id": "MDU6TGFiZWwxNDkzMDk1NTc=", "url": "https://api.github.com/repos/rust-lang/rust-clippy/labels/C-bug", "name": "C-bug", "color": "F5F1FD", "default": false, "description": "Category: Clippy is not doing the correct thing"}, {"id": 1179592412, "node_id": "MDU6TGFiZWwxMTc5NTkyNDEy", "url": "https://api.github.com/repos/rust-lang/rust-clippy/labels/I-suggestion-causes-error", "name": "I-suggestion-causes-error", "color": "E10C02", "default": false, "description": "Issue: The suggestions provided by this Lint cause an ICE/error when applied"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-10-03T09:22:55Z", "updated_at": "2022-10-05T14:31:08Z", "closed_at": null, "author_association": "NONE", "active_lock_reason": null, "body": "Output from clippy.\r\n```\r\nafter fixes were automatically applied the compiler reported errors within these files:\r\n\r\n  * examples/threads.rs\r\n\r\nThis likely indicates a bug in either rustc or cargo itself,\r\nand we would appreciate a bug report! You're likely to see \r\na number of compiler warnings after this message which cargo\r\nattempted to fix but failed. If you could open an issue at\r\nhttps://github.com/rust-lang/rust/issues\r\nquoting the full output of this command we'd be very appreciative!\r\nNote that you may be able to make some more progress in the near-term\r\nfixing code with the `--broken-code` flag\r\n\r\nThe following errors were reported:\r\nerror[E0277]: the `?` operator can only be used in an async block that returns `Result` or `Option` (or another type that implements `std::ops::FromResidual`)\r\n  --> examples/threads.rs:61:32\r\n   |\r\n60 |       rt.block_on(async {\r\n   |  _______________________-\r\n61 | |         client.register().await?\r\n   | |                                ^ cannot use the `?` operator in an async block that returns `()`\r\n62 | |     })?;\r\n   | |_____- this function should return `Result` or `Option` to accept `?`\r\n   |\r\n   = help: the trait `std::ops::FromResidual<std::result::Result<std::convert::Infallible, std::boxed::Box<dyn std::error::Error + std::marker::Send + std::marker::Sync>>>` is not implemented for `()`\r\n\r\nerror[E0277]: the `?` operator can only be applied to values that implement `std::ops::Try`\r\n  --> examples/threads.rs:60:5\r\n   |\r\n60 | /     rt.block_on(async {\r\n61 | |         client.register().await?\r\n62 | |     })?;\r\n   | |_______^ the `?` operator cannot be applied to type `()`\r\n   |\r\n   = help: the trait `std::ops::Try` is not implemented for `()`\r\n\r\nerror: aborting due to 2 previous errors\r\n```\r\n\r\nI would be happy if either the lint didn't fire, or if clippy fixed things with code that works.\r\n\r\n### Meta\r\n\r\nThe same error occurs with nightly.\r\n\r\n\r\n`rustc --version --verbose`:\r\n```\r\nrustc 1.64.0 (a55dd71d5 2022-09-19)\r\nrustc 1.66.0-nightly (57f097ea2 2022-10-01)\r\n```\r\n\r\n", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust-clippy/issues/9583/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust-clippy/issues/9583/timeline", "performed_via_github_app": null, "state_reason": null}