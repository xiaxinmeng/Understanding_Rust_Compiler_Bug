{"url": "https://api.github.com/repos/rust-lang/rust/issues/31594", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/31594/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/31594/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/31594/events", "html_url": "https://github.com/rust-lang/rust/issues/31594", "id": 133180226, "node_id": "MDU6SXNzdWUxMzMxODAyMjY=", "number": 31594, "title": "`create_dir_all` can't create directories through a dangling symlink.", "user": {"login": "pitdicker", "id": 6255050, "node_id": "MDQ6VXNlcjYyNTUwNTA=", "avatar_url": "https://avatars.githubusercontent.com/u/6255050?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pitdicker", "html_url": "https://github.com/pitdicker", "followers_url": "https://api.github.com/users/pitdicker/followers", "following_url": "https://api.github.com/users/pitdicker/following{/other_user}", "gists_url": "https://api.github.com/users/pitdicker/gists{/gist_id}", "starred_url": "https://api.github.com/users/pitdicker/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pitdicker/subscriptions", "organizations_url": "https://api.github.com/users/pitdicker/orgs", "repos_url": "https://api.github.com/users/pitdicker/repos", "events_url": "https://api.github.com/users/pitdicker/events{/privacy}", "received_events_url": "https://api.github.com/users/pitdicker/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 211668062, "node_id": "MDU6TGFiZWwyMTE2NjgwNjI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-libs-api", "name": "T-libs-api", "color": "bfd4f2", "default": false, "description": "Relevant to the library API team, which will review and decide on the PR/issue."}, {"id": 657353545, "node_id": "MDU6TGFiZWw2NTczNTM1NDU=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-feature-accepted", "name": "C-feature-accepted", "color": "f5f1fd", "default": false, "description": "Category: A feature request that has been accepted pending implementation."}, {"id": 2238437210, "node_id": "MDU6TGFiZWwyMjM4NDM3MjEw", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-io", "name": "A-io", "color": "f7e101", "default": false, "description": "Area: std::io, std::fs, std::net and std::path"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2016-02-12T07:55:37Z", "updated_at": "2023-01-26T20:24:51Z", "closed_at": null, "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Currently `create_dir_all` first does a stat on the file to see if it is a directory, and if not tries to create the parent dirs. This does not take into account that stat can fail if the path is a dangling symlink.\nThe classic `mkdir -p` just tries to create a directory and see why it fails. This spares a syscall and handles dangling symlinks transparently.\n\nOn Windows this method hit two problems:\n- When we have to recurse all the way op to the disk letter, `create_dir_all` fails.\n  You can't mkdir `c:\\` or `\\\\host\\share`. But we can just stop recursing in time.\n- Windows can't create a directory through a dangling symlink.\n  We would have to read the symlink (and possibly resolve it if relative), and create the directory\n  at the target location ourself.\n\nWould it make sense to go trough this trouble?\n\nI think it is best to only fix this for `create_dir_all` and to document the normal `create_dir` can not\ncreate a directory trough a dangling symlink on Windows.\n", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/31594/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/31594/timeline", "performed_via_github_app": null, "state_reason": null}