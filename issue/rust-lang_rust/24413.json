{"url": "https://api.github.com/repos/rust-lang/rust/issues/24413", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/24413/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/24413/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/24413/events", "html_url": "https://github.com/rust-lang/rust/issues/24413", "id": 68352054, "node_id": "MDU6SXNzdWU2ODM1MjA1NA==", "number": 24413, "title": "Ignored errors in file handling", "user": {"login": "tbu-", "id": 6666593, "node_id": "MDQ6VXNlcjY2NjY1OTM=", "avatar_url": "https://avatars.githubusercontent.com/u/6666593?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tbu-", "html_url": "https://github.com/tbu-", "followers_url": "https://api.github.com/users/tbu-/followers", "following_url": "https://api.github.com/users/tbu-/following{/other_user}", "gists_url": "https://api.github.com/users/tbu-/gists{/gist_id}", "starred_url": "https://api.github.com/users/tbu-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tbu-/subscriptions", "organizations_url": "https://api.github.com/users/tbu-/orgs", "repos_url": "https://api.github.com/users/tbu-/repos", "events_url": "https://api.github.com/users/tbu-/events{/privacy}", "received_events_url": "https://api.github.com/users/tbu-/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2015-04-14T12:10:01Z", "updated_at": "2015-04-14T16:33:04Z", "closed_at": "2015-04-14T16:33:04Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Currently you cannot handle a potential error of the `close` syscall on POSIX systems, and of the `CloseHandle` function on Windows. This means that you cannot reliably write to files, because the errors are also silently ignored.\n\nThe man page of `close(2)` specifically says:\n\n> Not checking the return value of close() is a common  but  nevertheless serious  programming error. It is quite possible that errors on a previous write(2) operation are first reported at the final close(). Not  checking the return value when closing the file may lead to silent loss of data.  This can especially be observed with NFS and with disk quota. Note  that  the  return  value should be used only for diagnostics.  In particular close() should not be retried after an EINTR since this may cause a reused descriptor from another thread to be closed.\n\nI couldn't find specific information for Windows, but it hinted that `CloseHandle` might also fail to indicate an error.\n\nI'd like to nominate this bug for 1.0, because this might need backward-incompatible changes to have \"sound\" support for file writing.\n", "closed_by": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/24413/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/24413/timeline", "performed_via_github_app": null, "state_reason": "completed"}