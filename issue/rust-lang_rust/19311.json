{"url": "https://api.github.com/repos/rust-lang/rust/issues/19311", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/19311/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/19311/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/19311/events", "html_url": "https://github.com/rust-lang/rust/issues/19311", "id": 50051102, "node_id": "MDU6SXNzdWU1MDA1MTEwMg==", "number": 19311, "title": "win api and fs module: filepath too long, ntfs on windows 64", "user": {"login": "viperscape", "id": 3178836, "node_id": "MDQ6VXNlcjMxNzg4MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/3178836?v=4", "gravatar_id": "", "url": "https://api.github.com/users/viperscape", "html_url": "https://github.com/viperscape", "followers_url": "https://api.github.com/users/viperscape/followers", "following_url": "https://api.github.com/users/viperscape/following{/other_user}", "gists_url": "https://api.github.com/users/viperscape/gists{/gist_id}", "starred_url": "https://api.github.com/users/viperscape/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/viperscape/subscriptions", "organizations_url": "https://api.github.com/users/viperscape/orgs", "repos_url": "https://api.github.com/users/viperscape/repos", "events_url": "https://api.github.com/users/viperscape/events{/privacy}", "received_events_url": "https://api.github.com/users/viperscape/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 123109, "node_id": "MDU6TGFiZWwxMjMxMDk=", "url": "https://api.github.com/repos/rust-lang/rust/labels/O-windows", "name": "O-windows", "color": "6e6ec0", "default": false, "description": "Operating system: Windows"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2014-11-25T16:35:28Z", "updated_at": "2015-09-20T07:06:52Z", "closed_at": "2015-09-20T07:06:52Z", "author_association": "NONE", "active_lock_reason": null, "body": "rust is unable to list directory contents on mounted ntfs drive. ntfs can hold extremely long folder structures but the native win API cannot browse them. This is not always a problem, for example: cygwin's LS executable compiled for windows, or java's file modules can browse these just fine since they do not rely on the win api. linux and mac osx can browse these window server shared folders as well. Does Rust for windows rely on the win api? it's unable to list contents in a deeply nested folder.\n\nSee below example, where K is a mounted SMB share that resides on a windows server (this is compile on latest rust 32bit for windows)\n\n``` rust\nuse std::io::fs;\nfn main () {\n    let path = \"K:/IT/testing/\";\n    let sub1 = \"wejhflkjwehfhwelhfkljwehfhkwehfkjlhwekjlfhkjwehfhwejkhfuiweh nweuiyfhuih4389578347589069045uyrt98y78yrf78gyv78yr78f76345yughvuidfu89yg7845y78tyg8y9845y78gy7845hy5678346578y78ghvcx jxbzcvjsbguyfg764wtr763 85474678 69346 35/\";\n\n    let sub2 = \"4375848v 9t489bu89cb n89fg89gf7g89fn89g7df98 g79r 7g9re78976re78er78 t60we6re7er6w7878w46t7834545bytbxcvu8v6r7 fye49th4ui 7878t6r78tg645t6 46uygt78g6xrt645jk6h78t7y8dxzg78e5 ht6455ytr78sr6e4tnovn47654t6/\";\n\n    let fullpath = path.to_string() + sub1.to_string() + sub2.to_string(); // fails!\n    let mostpath = path.to_string() + sub1.to_string(); // works!\n\n    let path1 = fs::readdir(&Path::new(fullpath.to_string())).unwrap(); //fails with fullpath!\n\n    for src in path1.iter() {\n        println!(\"{}\",src.filename_str().unwrap());\n    }\n}\n```\n\n```\ncargo run --verbose\n       Fresh rust_test v0.0.1 (file:///C:/Users/chris/rust_test)\n     Running `..\\target\\rust_test`\ntask '<main>' panicked at 'called `Result::unwrap()` on an `Err` value: couldn't read directory (OS Error 3: The system cannot find the path specified.\n; path=K:\\IT\\testing\\wejhflkjwehfhwelhfkljwehfhkwehfkjlhwekjlfhkjwehfhwejkhfuiweh nweuiyfhuih4389578347589069045uyrt98y78yrf78gyv78yr78f76345yughvuidfu89yg7845y78tyg8y9845y78gy7845hy5678346578y78ghvcx jxbzcvjsbguyfg764wtr763 85474678 69346 35\\4375848v 9t489bu89cb n89fg89gf7g89fn89g7df98 g79r 7g9re78976re78er78 t60we6re7er6w7878w46t7834545bytbxcvu8v6r7 fye49th4ui 7878t6r78tg645t6 46uygt78g6xrt645jk6h78t7y8dxzg78e5 ht6455ytr78sr6e4tnovn47654t6)', C:\\bot\\slave\\nightly-win-32\\build\\src\\libcore\\result.rs:743\nAn unknown error occurred\nProcess didn't exit successfully: `..\\target\\rust_test` (status=101)\n```\n", "closed_by": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/19311/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/19311/timeline", "performed_via_github_app": null, "state_reason": "completed"}