{"url": "https://api.github.com/repos/rust-lang/rust/issues/14039", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/14039/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/14039/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/14039/events", "html_url": "https://github.com/rust-lang/rust/issues/14039", "id": 33079762, "node_id": "MDU6SXNzdWUzMzA3OTc2Mg==", "number": 14039, "title": "ICE on branch to a `proc` with unspecified type & a `proc` with a reference arg", "user": {"login": "huonw", "id": 1203825, "node_id": "MDQ6VXNlcjEyMDM4MjU=", "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4", "gravatar_id": "", "url": "https://api.github.com/users/huonw", "html_url": "https://github.com/huonw", "followers_url": "https://api.github.com/users/huonw/followers", "following_url": "https://api.github.com/users/huonw/following{/other_user}", "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}", "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/huonw/subscriptions", "organizations_url": "https://api.github.com/users/huonw/orgs", "repos_url": "https://api.github.com/users/huonw/repos", "events_url": "https://api.github.com/users/huonw/events{/privacy}", "received_events_url": "https://api.github.com/users/huonw/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1775993, "node_id": "MDU6TGFiZWwxNzc1OTkz", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-lifetimes", "name": "A-lifetimes", "color": "f7e101", "default": false, "description": "Area: lifetime related"}, {"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}, {"id": 46741598, "node_id": "MDU6TGFiZWw0Njc0MTU5OA==", "url": "https://api.github.com/repos/rust-lang/rust/labels/E-needs-test", "name": "E-needs-test", "color": "02e10c", "default": false, "description": "Call for participation: writing correctness tests"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2014-05-08T12:41:45Z", "updated_at": "2014-09-15T20:51:05Z", "closed_at": "2014-09-15T20:51:05Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "``` rust\nfn main() {\n    if true {\n        proc(_) {}\n    } else {\n        proc(_: &mut ()) {}\n    };\n}\n```\n\n```\nice4.rs:2:5: 6:6 error: internal compiler error: Region ReInfer(ReVar(middle::ty::RegionVid{id: 0u})) is not associated with any bound region from A!\nice4.rs:2     if true {\nice4.rs:3         proc(_) {}\nice4.rs:4     } else {\nice4.rs:5         proc(_: &mut ()) {}\nice4.rs:6     };\nnote: the compiler hit an unexpected failure path. this is a bug.\nnote: we would appreciate a bug report: http://static.rust-lang.org/doc/master/complement-bugreport.html\nnote: run with `RUST_BACKTRACE=1` for a backtrace\ntask 'rustc' failed at '~Any', /home/rustbuild/src/rust-buildbot/slave/nightly-linux/build/src/libsyntax/diagnostic.rs:99\nstack backtrace:\n   1:     0x7f3393a36240 - rt::backtrace::imp::write::h47fe109ac3049adffza::v0.11.pre\n   2:     0x7f33939875d0 - rt::unwind::begin_unwind_inner::h6061c949133dceeek99::v0.11.pre\n   3:     0x7f339280b9b0 - rt::unwind::begin_unwind::h11314483157330216575::v0.11.pre\n   4:     0x7f339280b8e0 - diagnostic::SpanHandler::span_bug::hc71aee6f66413044vVb::v0.11.pre\n   5:     0x7f339467b8b0 - driver::session::Session::span_bug::h17bfdebff4803efeFrj::v0.11.pre\n   6:     0x7f339495e2a0 - middle::typeck::infer::lub::Lub<'f>.Combine::fn_sigs::closure.69969\n   7:     0x7f33947ecbe0 - middle::ty_fold::RegionFolder<'a>.TypeFolder::fold_region::he78d5a8045217274d3Q::v0.11.pre\n   8:     0x7f33947ec190 - middle::ty_fold::super_fold_sty::h10671660021486755198::v0.11.pre\n   9:     0x7f33947ae420 - middle::ty_fold::RegionFolder<'a>.TypeFolder::fold_ty::h8fffe33fee97bcfbW0Q::v0.11.pre\n  10:     0x7f33947af510 - iter::Iterator::collect::h14491155447903276746::v0.11.pre\n  11:     0x7f339495d580 - middle::typeck::infer::lub::Lub<'f>.Combine::fn_sigs::h2276d0f53c9cc88doDi::v0.11.pre\n  12:     0x7f3394967050 - middle::typeck::infer::combine::Combine::closure_tys::h7918828032888759876::v0.11.pre\n  13:     0x7f339495fc30 - middle::typeck::infer::lattice::super_lattice_tys::h421177317821972521::v0.11.pre\n  14:     0x7f33949b4cc0 - middle::typeck::infer::common_supertype::closure.71236\n  15:     0x7f33949b4c80 - middle::typeck::infer::InferCtxt<'a>::commit::closure.71230\n  16:     0x7f339494a320 - middle::typeck::infer::InferCtxt<'a>::try::h5526458837193382813::v0.11.pre\n  17:     0x7f33949b4af0 - middle::typeck::infer::InferCtxt<'a>::commit::closure.71228\n  18:     0x7f33949b3fc0 - util::common::indent::h12816111372132265695::v0.11.pre\n  19:     0x7f33949b3d80 - middle::typeck::infer::InferCtxt<'a>::commit::h3309691450176933472::v0.11.pre\n  20:     0x7f339486f5d0 - middle::typeck::infer::common_supertype::h574a799d34a9701eSHp::v0.11.pre\n  21:     0x7f3394918e50 - middle::typeck::check::check_expr_with_unifier::h13eff655c3f9c371Dya::v0.11.pre\n  22:     0x7f3394937b50 - middle::typeck::check::check_stmt::hba22b91edb52e891FTc::v0.11.pre\n  23:     0x7f33948f8730 - middle::typeck::check::check_block_with_expected::h2bcfbea132dff995CXc::v0.11.pre\n  24:     0x7f33948f3800 - middle::typeck::check::check_fn::h015b2d4e9926e649Ll8::v0.11.pre\n  25:     0x7f33948f35a0 - middle::typeck::check::check_bare_fn::h276d49bccf79d6cbib8::v0.11.pre\n  26:     0x7f33948eb3e0 - middle::typeck::check::check_item::hf4303c618e67640ejI8::v0.11.pre\n  27:     0x7f33948f33a0 - middle::typeck::check::check_item_types::h3a12f8481de3c645Aa8::v0.11.pre\n  28:     0x7f3394a3fe70 - util::common::time::h14771813586294062655::v0.11.pre\n  29:     0x7f3394a3ebd0 - middle::typeck::check_crate::ha64d37049d8764a6L7v::v0.11.pre\n  30:     0x7f3394e6a1d0 - driver::driver::phase_3_run_analysis_passes::hfcc0f62a0837a3f1ZDh::v0.11.pre\n  31:     0x7f3394e6fa80 - driver::driver::compile_input::h109dae099456ee6aO3h::v0.11.pre\n  32:     0x7f3394e94da0 - run_compiler::h05fa0a47a6b6f28bzwp::v0.11.pre\n  33:     0x7f3394eb13d0 - main_args::closure.93793\n  34:     0x7f3394eaf8d0 - monitor::closure.93668\n  35:     0x7f3394eaa090 - task::TaskBuilder::try::closure.93434\n  36:     0x7f33940d10b0 - task::spawn_opts::closure.7161\n  37:     0x7f3393a2bc70 - rt::task::Task::run::closure.40355\n  38:     0x7f3393a3c5b0 - rust_try\n  39:     0x7f3393a2bab0 - rt::task::Task::run::hf886fab2982b08c7nZ7::v0.11.pre\n  40:     0x7f33940d0e80 - task::spawn_opts::closure.7134\n  41:     0x7f3393a34d80 - rt::thread::thread_start::h7d20e7f4bce06592AE8::v0.11.pre\n  42:     0x7f3391710fa0 - start_thread\n  43:     0x7f339365ba09 - __clone\n  44:                0x0 - <unknown>\n\n```\n\nSwapping the order of the branches compiles fine.\n\ncc @nikomatsakis @pnkfelix \n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/14039/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/14039/timeline", "performed_via_github_app": null, "state_reason": "completed"}