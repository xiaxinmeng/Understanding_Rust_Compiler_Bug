{"url": "https://api.github.com/repos/rust-lang/rust/issues/40006", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/40006/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/40006/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/40006/events", "html_url": "https://github.com/rust-lang/rust/issues/40006", "id": 209214419, "node_id": "MDU6SXNzdWUyMDkyMTQ0MTk=", "number": 40006, "title": "Poor parser error message when item category missing (assumes input is a macro)", "user": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 235791, "node_id": "MDU6TGFiZWwyMzU3OTE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-diagnostics", "name": "A-diagnostics", "color": "f7e101", "default": false, "description": "Area: Messages for errors, warnings, and lints"}, {"id": 27424086, "node_id": "MDU6TGFiZWwyNzQyNDA4Ng==", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-parser", "name": "A-parser", "color": "f7e101", "default": false, "description": "Area: The parsing of Rust source code to an AST."}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2017-02-21T17:21:36Z", "updated_at": "2017-04-06T03:20:23Z", "closed_at": "2017-04-06T03:20:23Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Consider this code ([playpen](https://is.gd/AkFshR)): \r\n\r\n```rust\r\nstruct S;\r\nimpl S { pub hello_method(&self) { println!(\"Hello\"); } }\r\nfn main() { S.hello_method(); }\r\n```\r\n\r\nIt yields this error today: \r\n\r\n```\r\nrustc 1.17.0-nightly (a17e5e294 2017-02-20)\r\nerror: can't qualify macro invocation with `pub`\r\n --> <anon>:2:10\r\n  |\r\n2 | impl S { pub hello_method(&self) { println!(\"Hello\"); } }\r\n  |          ^^^\r\n  |\r\n  = help: try adjusting the macro to put `pub` inside the invocation\r\n\r\nerror: expected one of `!` or `::`, found `(`\r\n --> <anon>:2:26\r\n  |\r\n2 | impl S { pub hello_method(&self) { println!(\"Hello\"); } }\r\n  |                          ^\r\n\r\nerror: aborting due to previous error\r\n```\r\n\r\nIn this case, the actual error is that the user left out the keyword after the visibility to indicate which kind of item they are trying to define here.\r\n\r\nOur parser should be able to do a better job here. At the very least, if there is no trailing `!`, then instead of assuming that the input was a macro invocation, it should instead assume it was *some* item definition that is missing its keyword.", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/40006/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/40006/timeline", "performed_via_github_app": null, "state_reason": "completed"}