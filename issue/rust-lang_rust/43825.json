{"url": "https://api.github.com/repos/rust-lang/rust/issues/43825", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/43825/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/43825/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/43825/events", "html_url": "https://github.com/rust-lang/rust/issues/43825", "id": 249811346, "node_id": "MDU6SXNzdWUyNDk4MTEzNDY=", "number": 43825, "title": "Strange non-primitive cast error near erroneous code", "user": {"login": "0x7CFE", "id": 3784017, "node_id": "MDQ6VXNlcjM3ODQwMTc=", "avatar_url": "https://avatars.githubusercontent.com/u/3784017?v=4", "gravatar_id": "", "url": "https://api.github.com/users/0x7CFE", "html_url": "https://github.com/0x7CFE", "followers_url": "https://api.github.com/users/0x7CFE/followers", "following_url": "https://api.github.com/users/0x7CFE/following{/other_user}", "gists_url": "https://api.github.com/users/0x7CFE/gists{/gist_id}", "starred_url": "https://api.github.com/users/0x7CFE/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/0x7CFE/subscriptions", "organizations_url": "https://api.github.com/users/0x7CFE/orgs", "repos_url": "https://api.github.com/users/0x7CFE/repos", "events_url": "https://api.github.com/users/0x7CFE/events{/privacy}", "received_events_url": "https://api.github.com/users/0x7CFE/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 37544, "node_id": "MDU6TGFiZWwzNzU0NA==", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-typesystem", "name": "A-typesystem", "color": "f7e101", "default": false, "description": "Area: The type system"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 604454086, "node_id": "MDU6TGFiZWw2MDQ0NTQwODY=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-inference", "name": "A-inference", "color": "f7e101", "default": false, "description": "Area: Type inference"}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2017-08-12T13:10:37Z", "updated_at": "2017-12-26T01:40:51Z", "closed_at": "2017-12-26T01:40:51Z", "author_association": "NONE", "active_lock_reason": null, "body": "tl;dr; If you comment out the `let error` line, all will compile, obviously. \r\n\r\n```Rust\r\nfn main() {\r\n    let error = error; // Comment me\r\n    for value in (1..10).map(|a| a as f32) {\r\n        \r\n    }\r\n}\r\n```\r\n\r\nHowever, in presence of it, compiler complains\r\n\r\n```\r\nerror[E0605]: non-primitive cast: `{integer}` as `f32`\r\n --> src/main.rs:3:34\r\n  |\r\n3 |     for value in (1..10).map(|a| a as f32) {\r\n  |                                  ^^^^^^^^\r\n  |\r\n  = note: an `as` expression can only be used to convert between primitive types. Consider using the `From` trait\r\n```\r\n\u2026which is strange and may mislead user in more complex situation. Looks like broken code affects type inference somehow. By the way, error will also appear, if you put erroneous line *after* the loop.\r\n\r\n```\r\nrustc 1.21.0-nightly (13d94d5fa 2017-08-10)\r\nbinary: rustc\r\ncommit-hash: 13d94d5fa8129a34f5c77a1bcd76983f5aed2434\r\ncommit-date: 2017-08-10\r\nhost: x86_64-unknown-linux-gnu\r\nrelease: 1.21.0-nightly\r\nLLVM version: 4.0\r\n```", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/43825/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/43825/timeline", "performed_via_github_app": null, "state_reason": "completed"}