{"url": "https://api.github.com/repos/rust-lang/rust/issues/25774", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/25774/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/25774/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/25774/events", "html_url": "https://github.com/rust-lang/rust/issues/25774", "id": 80571361, "node_id": "MDU6SXNzdWU4MDU3MTM2MQ==", "number": 25774, "title": "rustc panic on crazy lifetime code", "user": {"login": "ericsink", "id": 3877005, "node_id": "MDQ6VXNlcjM4NzcwMDU=", "avatar_url": "https://avatars.githubusercontent.com/u/3877005?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ericsink", "html_url": "https://github.com/ericsink", "followers_url": "https://api.github.com/users/ericsink/followers", "following_url": "https://api.github.com/users/ericsink/following{/other_user}", "gists_url": "https://api.github.com/users/ericsink/gists{/gist_id}", "starred_url": "https://api.github.com/users/ericsink/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ericsink/subscriptions", "organizations_url": "https://api.github.com/users/ericsink/orgs", "repos_url": "https://api.github.com/users/ericsink/repos", "events_url": "https://api.github.com/users/ericsink/events{/privacy}", "received_events_url": "https://api.github.com/users/ericsink/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2015-05-25T15:30:53Z", "updated_at": "2015-05-25T16:21:26Z", "closed_at": "2015-05-25T16:21:26Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "rustc just asked me to file a bug report.\n\nThe code that causes rustc to panic is in the following gist:\n\nhttps://gist.github.com/ericsink/94835e3ed01784f3225a\n\nSorry for the ~4000 line file.  I have no idea how to trim it down to something smaller that still reproduces the panic.\n\nI was trying to give struct SegmentCursor a reference back to the struct db that created it.  So I had to start adding explicit lifetimes all over the place.\n\nFWIW, if you want to see or diff from the place I started before making the change that caused rustc to panic, the file is here:\n\nhttps://github.com/ericsink/LSM/blob/master/rs/src/lib.rs\n\nand the version you want is in this commit:\n\n0bc3e474c3b9da43807ac73849daf0068ec1735a\n\nBut anyway\n\nHere's the compiler I'm using:\n\nrustc 1.1.0-nightly (c4b23aec4 2015-04-29) (built 2015-04-28)\nbinary: rustc\ncommit-hash: c4b23aec4c5ddf32df1e0ba3cc23212327cd8b1f\ncommit-date: 2015-04-29\nbuild-date: 2015-04-28\nhost: x86_64-apple-darwin\nrelease: 1.1.0-nightly\n\nAnd here's the stack trace:\n\nthread 'rustc' panicked at 'Box<Any>', /Users/rustbuild/src/rust-buildbot/slave/nightly-dist-rustc-mac/build/src/libsyntax/diagnostic.rs:170\n\nstack backtrace:\n   1:        0x10529f24f - sys::backtrace::write::h0714aaf7fe41e02dzVr\n   2:        0x1052a78c0 - panicking::on_panic::hb86b9b356f51f92dEVv\n   3:        0x105263c35 - rt::unwind::begin_unwind_inner::h58f79e41dbedf2efnDv\n   4:        0x104a5598e - rt::unwind::begin_unwind::h17476740655312162035\n   5:        0x104a5591a - diagnostic::SpanHandler::span_bug::h6ece18e7aebef0b3cFB\n   6:        0x1024fd71b - middle::infer::region_inference::RegionVarBindings<'a, 'tcx>::make_subregion::he60a593b72e2fd85yhv\n   7:        0x1024b8758 - middle::infer::region_inference::RegionVarBindings<'a, 'tcx>::make_eqregion::hf65096ae1c1b3b0a0gv\n   8:        0x1024b091b - middle::infer::equate::Equate<'a, 'tcx>.TypeRelation<'a, 'tcx>::regions::hfa4c86be50c0c9c07pq\n   9:        0x1024b46a9 - middle::infer::sub::Sub<'a, 'tcx>.TypeRelation<'a, 'tcx>::relate_with_variance::h9286450150694230498\n  10:        0x1024b3d3b - middle::ty_relate::relate_substs::h10097045333893871943\n  11:        0x1024b332a - middle::ty_relate::relate_item_substs::h4357746226965114642\n  12:        0x102513b27 - middle::ty_relate::super_relate_tys::h16553438660823187938\n  13:        0x1024abc32 - middle::infer::sub::Sub<'a, 'tcx>.TypeRelation<'a, 'tcx>::tys::h0720d2122871d207jpx\n  14:        0x102518617 - middle::infer::InferCtxt<'a, 'tcx>::sub_types::h83d8b857be0b9449iTy\n  15:        0x10208183f - check::method::probe::ProbeContext<'a, 'tcx>::consider_candidates::h959372f449962be611h\n  16:        0x1020815cf - check::method::probe::ProbeContext<'a, 'tcx>::pick_method::hedc4369721a1e898YXh\n  17:        0x1020809c6 - check::method::probe::ProbeContext<'a, 'tcx>::pick_core::h61b45ed4a4578cc9SSh\n  18:        0x1020767bc - check::method::probe::probe::closure.31731\n  19:        0x102074029 - check::method::probe::probe::hee4923d75a19097b8Hg\n  20:        0x10202d9e4 - check::resolve_ty_and_def_ufcs::h244d6b4b01dd80bbiYr\n  21:        0x102110b40 - check::check_expr_with_unifier::h8527598931454308257\n  22:        0x1020af74c - check::callee::check_call::h9d48641f8dbf70e8uVl\n  23:        0x1020db456 - check::check_expr_with_unifier::h2620947197098337973\n  24:        0x1020b550c - check::check_argument_types::h382f9297397ef06cq0p\n  25:        0x1020b28de - check::callee::confirm_builtin_call::hbc010ad4f4bda7d8M4l\n  26:        0x1020b1069 - check::callee::check_call::h9d48641f8dbf70e8uVl\n  27:        0x1020f6e31 - check::check_expr_with_unifier::h17685357569681961405\n  28:        0x1020cbd9b - check::check_block_with_expected::hcfa15fbdb8c43f45tds\n  29:        0x1020f74b8 - check::check_expr_with_unifier::h17685357569681961405\n  30:        0x102035c83 - check::_match::check_match::closure.29464\n  31:        0x1020359c1 - check::_match::check_match::h1ee836cfebb44c84Vqb\n  32:        0x1020f7454 - check::check_expr_with_unifier::h17685357569681961405\n  33:        0x1020cbd9b - check::check_block_with_expected::hcfa15fbdb8c43f45tds\n  34:        0x102102335 - check::check_expr_with_unifier::h16667247497716976070\n  35:        0x1020e06f8 - check::check_expr_with_unifier::check_then_else::h0086fe91e78fdbceRCq\n  36:        0x1020f72c0 - check::check_expr_with_unifier::h17685357569681961405\n  37:        0x1020cbd9b - check::check_block_with_expected::hcfa15fbdb8c43f45tds\n  38:        0x1020aed28 - check::check_fn::hfb888ade54742a88nSn\n  39:        0x1020c71a5 - check::check_bare_fn::h01c9c7a0b174d430WHn\n  40:        0x1020d2c07 - check::check_method_body::h2fc6b3c8015b76ccXjo\n  41:        0x1020c504b - check::CheckItemBodiesVisitor<'a, 'tcx>.Visitor<'tcx>::visit_item::hbef2e2a14382e80aZEn\n  42:        0x10218a74a - check_crate::closure.38872\n  43:        0x102185b77 - check_crate::h782cff8740252e81rCC\n  44:        0x1019da124 - driver::phase_3_run_analysis_passes::h2554ff95bce00587tGa\n  45:        0x1019bc18c - driver::compile_input::h7c6cf9b085c57594Qba\n  46:        0x101a7bac3 - run_compiler::h55b523753cbd518765b\n  47:        0x101a7922a - boxed::F.FnBox<A>::call_box::h11476165885616507686\n  48:        0x101a78767 - rt::unwind::try::try_fn::h13518150216340287792\n  49:        0x105329c58 - rust_try_inner\n  50:        0x105329c45 - rust_try\n  51:        0x101a78a4e - boxed::F.FnBox<A>::call_box::h735039165869315632\n  52:        0x1052a62bd - sys::thread::Thread::new::thread_start::hf4c42a114072ab47mYu\n  53:     0x7fff8aca1898 - _pthread_body\n  54:     0x7fff8aca1729 - _pthread_start\n", "closed_by": {"login": "ericsink", "id": 3877005, "node_id": "MDQ6VXNlcjM4NzcwMDU=", "avatar_url": "https://avatars.githubusercontent.com/u/3877005?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ericsink", "html_url": "https://github.com/ericsink", "followers_url": "https://api.github.com/users/ericsink/followers", "following_url": "https://api.github.com/users/ericsink/following{/other_user}", "gists_url": "https://api.github.com/users/ericsink/gists{/gist_id}", "starred_url": "https://api.github.com/users/ericsink/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ericsink/subscriptions", "organizations_url": "https://api.github.com/users/ericsink/orgs", "repos_url": "https://api.github.com/users/ericsink/repos", "events_url": "https://api.github.com/users/ericsink/events{/privacy}", "received_events_url": "https://api.github.com/users/ericsink/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/25774/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/25774/timeline", "performed_via_github_app": null, "state_reason": "completed"}