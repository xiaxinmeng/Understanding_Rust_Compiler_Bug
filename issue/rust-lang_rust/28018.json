{"url": "https://api.github.com/repos/rust-lang/rust/issues/28018", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/28018/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/28018/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/28018/events", "html_url": "https://github.com/rust-lang/rust/issues/28018", "id": 103286711, "node_id": "MDU6SXNzdWUxMDMyODY3MTE=", "number": 28018, "title": "windows-msvc builds very fragile", "user": {"login": "Diggsey", "id": 451321, "node_id": "MDQ6VXNlcjQ1MTMyMQ==", "avatar_url": "https://avatars.githubusercontent.com/u/451321?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Diggsey", "html_url": "https://github.com/Diggsey", "followers_url": "https://api.github.com/users/Diggsey/followers", "following_url": "https://api.github.com/users/Diggsey/following{/other_user}", "gists_url": "https://api.github.com/users/Diggsey/gists{/gist_id}", "starred_url": "https://api.github.com/users/Diggsey/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Diggsey/subscriptions", "organizations_url": "https://api.github.com/users/Diggsey/orgs", "repos_url": "https://api.github.com/users/Diggsey/repos", "events_url": "https://api.github.com/users/Diggsey/events{/privacy}", "received_events_url": "https://api.github.com/users/Diggsey/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 123109, "node_id": "MDU6TGFiZWwxMjMxMDk=", "url": "https://api.github.com/repos/rust-lang/rust/labels/O-windows", "name": "O-windows", "color": "6e6ec0", "default": false, "description": "Operating system: Windows"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2015-08-26T14:45:14Z", "updated_at": "2015-09-04T19:41:42Z", "closed_at": "2015-09-04T19:41:42Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "`./configure` for -msvc freely interchanges between windows/msys commands, which results in it being quite fragile: it's a good idea to treat msys as a purely unix-like environment, and then have a single escape-hatch to execute windows commands (eg. via cmd).\n\nWays this can currently break (these are just the ones I personally ran into):\n- Having cmake installed in msys. The msys version of cmake does not support visual studio - this is by design: http://www.cmake.org/Bug/view.php?id=14797\n- Having a program/script named `reg` on the path. This will cause `./configure`'s reg invocations to fail, as it expects them to call the windows `reg` utility.\n- Not having msys inherit PATH from windows: this is perfectly valid, and was at one point _required_ to build rust in msys, if rust was installed on PATH in windows.\n- In several places, the escaping is broken and only works by chance. For example, on this line `include_path=$(cmd /c \"\\\"$vcvarsall\\\" $msvc_part && cmd /c echo %INCLUDE%\")`, msys path conversion will convert `/c` into `C:\\`, and the value of `%INCLUDE%` will not include the additions that `vcvarsall` would normally make. As yet, I've been unable to determine the correct escape sequence to use (`//c` will produce the desired `/c`, but that will uncover a host of _new_ escaping issues...)\n\nThe quick way to solve most of these problems is to run all commands intended to run in the windows environment via `cmd`: this eliminates potential for conflicts to a single item, `cmd`, and will ensure those commands find the windows versions of programs. However it does not solve the escaping issue.\n\nMoving to a cargo-based build system and dropping the msys dependency altogether will of course fix this much more effectively!\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/28018/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/28018/timeline", "performed_via_github_app": null, "state_reason": "completed"}