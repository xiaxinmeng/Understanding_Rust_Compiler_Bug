{"url": "https://api.github.com/repos/rust-lang/rust/issues/21695", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/21695/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/21695/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/21695/events", "html_url": "https://github.com/rust-lang/rust/issues/21695", "id": 55650769, "node_id": "MDU6SXNzdWU1NTY1MDc2OQ==", "number": 21695, "title": "Coercing into Box<Trait> in a match arm does not get cleaned up properly.", "user": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 234956, "node_id": "MDU6TGFiZWwyMzQ5NTY=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-codegen", "name": "A-codegen", "color": "f7e101", "default": false, "description": "Area: Code generation"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2015-01-27T17:50:34Z", "updated_at": "2015-01-30T01:56:33Z", "closed_at": "2015-01-30T01:56:33Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Spawned off of #20055 (and PR #21692 ) \n\nI thought I fixed this and wrote a test for it in PR #21692, but I was wrong -- the test for `Box<Trait>` was erroneous/incomplete at best.\n\nTest case:\n\n``` rust\ntrait Boo { }\n\nimpl Boo for [i8; 1] { }\nimpl Boo for [i8; 2] { }\nimpl Boo for [i8; 3] { }\nimpl Boo for [i8; 4] { }\n\npub fn foo(box_1: fn () -> Box<[i8; 1]>,\n           box_2: fn () -> Box<[i8; 2]>,\n           box_3: fn () -> Box<[i8; 3]>,\n           box_4: fn () -> Box<[i8; 4]>,\n            ) {\n    let _b: Box<Boo> = match 3 {\n        1 => box_1(),\n        2 => box_2(),\n        3 => box_3(),\n        _ => box_4(),\n    };\n}\n\npub fn main() {\n    fn box_1() -> Box<[i8; 1]> { Box::new( [1i8; 1] ) }\n    fn box_2() -> Box<[i8; 2]> { Box::new( [1i8; 2] ) }\n    fn box_3() -> Box<[i8; 3]> { Box::new( [1i8; 3] ) }\n    fn box_4() -> Box<[i8; 4]> { Box::new( [1i8; 4] ) }\n\n    println!(\"Hello World 1\");\n    foo(box_1, box_2, box_3, box_4);\n    println!(\"Hello World 2\");\n\n}\n```\n\nIn the playpen, this currently prints:\n\n```\nHello World 1\nplaypen: application terminated abnormally with signal 4 (Illegal instruction)\n```\n", "closed_by": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/21695/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/21695/timeline", "performed_via_github_app": null, "state_reason": "completed"}