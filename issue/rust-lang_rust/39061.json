{"url": "https://api.github.com/repos/rust-lang/rust/issues/39061", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/39061/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/39061/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/39061/events", "html_url": "https://github.com/rust-lang/rust/issues/39061", "id": 200794764, "node_id": "MDU6SXNzdWUyMDA3OTQ3NjQ=", "number": 39061, "title": "Constants seem to be broken in nightly Rust on powerpc-unknown-linux-gnu", "user": {"login": "dusxmt", "id": 19625851, "node_id": "MDQ6VXNlcjE5NjI1ODUx", "avatar_url": "https://avatars.githubusercontent.com/u/19625851?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dusxmt", "html_url": "https://github.com/dusxmt", "followers_url": "https://api.github.com/users/dusxmt/followers", "following_url": "https://api.github.com/users/dusxmt/following{/other_user}", "gists_url": "https://api.github.com/users/dusxmt/gists{/gist_id}", "starred_url": "https://api.github.com/users/dusxmt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dusxmt/subscriptions", "organizations_url": "https://api.github.com/users/dusxmt/orgs", "repos_url": "https://api.github.com/users/dusxmt/repos", "events_url": "https://api.github.com/users/dusxmt/events{/privacy}", "received_events_url": "https://api.github.com/users/dusxmt/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2017-01-14T10:13:23Z", "updated_at": "2017-01-17T16:33:45Z", "closed_at": "2017-01-17T16:33:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "Good day, it appears that something is wrong with constants on the 32-bit powerpc linux flavor of nightly rustc, here's a simple example program:\r\n\r\n```\r\nconst TEST_NUM_CONST: u32 = 512;\r\n\r\n#[derive(Debug)]\r\nstruct Point {\r\n    x: u32,\r\n    y: u32,\r\n}\r\n\r\nconst TEST_STRUCT_CONST: Point = Point { x: 428, y: 314 };\r\n\r\nfn main() {\r\n    println!(\"The numeric constant is: {}\", TEST_NUM_CONST);\r\n    println!(\"The struct constant is: {:?}\", TEST_STRUCT_CONST);\r\n}\r\n```\r\n\r\nWhat I expect it to output, and what it does indeed output on x86_64, is:\r\n\r\n```\r\nThe numeric constant is: 512\r\nThe struct constant is: Point { x: 428, y: 314 }\r\n```\r\n\r\nHowever, on PowerPC, rustc fails with:\r\n```\r\nerror: int literal is too large\r\n --> main.rs:1:29\r\n  |\r\n1 | const TEST_NUM_CONST: u32 = 512;\r\n  |                             ^^^\r\n\r\nerror: aborting due to previous error\r\n```\r\n\r\nIf I comment out the numeric constant and its use, leaving the structure constant in, rustc reliably crashes due to memory corruption:\r\n\r\n```\r\n*** Error in `/home/dusan/.rustup/toolchains/nightly-powerpc-unknown-linux-gnu/bin/rustc': double free or corruption (out): 0xb7cc57d8 ***\r\n======= Backtrace: =========\r\n```\r\n(link to full output: https://gist.github.com/dusxmt/1601ecd375e3092955ff8ec9c8a69456 )\r\n\r\n$ rustc --version --verbose\r\nrustc 1.16.0-nightly (1a2ed98d3 2017-01-13)\r\nbinary: rustc\r\ncommit-hash: 1a2ed98d344b6cbddc57db8841b42f935877e08d\r\ncommit-date: 2017-01-13\r\nhost: powerpc-unknown-linux-gnu\r\nrelease: 1.16.0-nightly\r\nLLVM version: 3.9\r\n\r\n$ uname -a\r\nLinux power-dooshki 4.4.39-gentoo #1 Fri Jan 6 23:47:44 CET 2017 ppc 7450, altivec supported PowerBook3,3 GNU/Linux", "closed_by": {"login": "aturon", "id": 709807, "node_id": "MDQ6VXNlcjcwOTgwNw==", "avatar_url": "https://avatars.githubusercontent.com/u/709807?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aturon", "html_url": "https://github.com/aturon", "followers_url": "https://api.github.com/users/aturon/followers", "following_url": "https://api.github.com/users/aturon/following{/other_user}", "gists_url": "https://api.github.com/users/aturon/gists{/gist_id}", "starred_url": "https://api.github.com/users/aturon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aturon/subscriptions", "organizations_url": "https://api.github.com/users/aturon/orgs", "repos_url": "https://api.github.com/users/aturon/repos", "events_url": "https://api.github.com/users/aturon/events{/privacy}", "received_events_url": "https://api.github.com/users/aturon/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/39061/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/39061/timeline", "performed_via_github_app": null, "state_reason": "completed"}