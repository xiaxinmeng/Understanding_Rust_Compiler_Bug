{"url": "https://api.github.com/repos/rust-lang/rust/issues/65564", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/65564/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/65564/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/65564/events", "html_url": "https://github.com/rust-lang/rust/issues/65564", "id": 509204006, "node_id": "MDU6SXNzdWU1MDkyMDQwMDY=", "number": 65564, "title": "Investigate replacing most of the debugger pretty-printing scripts with traits.", "user": {"login": "eddyb", "id": 77424, "node_id": "MDQ6VXNlcjc3NDI0", "avatar_url": "https://avatars.githubusercontent.com/u/77424?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eddyb", "html_url": "https://github.com/eddyb", "followers_url": "https://api.github.com/users/eddyb/followers", "following_url": "https://api.github.com/users/eddyb/following{/other_user}", "gists_url": "https://api.github.com/users/eddyb/gists{/gist_id}", "starred_url": "https://api.github.com/users/eddyb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eddyb/subscriptions", "organizations_url": "https://api.github.com/users/eddyb/orgs", "repos_url": "https://api.github.com/users/eddyb/repos", "events_url": "https://api.github.com/users/eddyb/events{/privacy}", "received_events_url": "https://api.github.com/users/eddyb/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 203130, "node_id": "MDU6TGFiZWwyMDMxMzA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-debuginfo", "name": "A-debuginfo", "color": "f7e101", "default": false, "description": "Area: Debugging information in compiled programs (DWARF, PDB, etc.)"}, {"id": 60344715, "node_id": "MDU6TGFiZWw2MDM0NDcxNQ==", "url": "https://api.github.com/repos/rust-lang/rust/labels/P-medium", "name": "P-medium", "color": "eb6420", "default": false, "description": "Medium priority"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 25, "created_at": "2019-10-18T17:04:02Z", "updated_at": "2023-05-15T14:27:16Z", "closed_at": null, "author_association": "MEMBER", "active_lock_reason": null, "body": "In the case of `Vec<T>` and `String`, it would be possible to have e.g.:\r\n```rust\r\nimpl<'a, T> DebuggerView<'a> for Vec<T> {\r\n    type View = &'a [T];\r\n    fn debugger_view(&'a self) -> Self::View { &self[..] }\r\n}\r\n```\r\n```rust\r\nimpl<'a> DebuggerView<'a> for String {\r\n    type View = &'a str;\r\n    fn debugger_view(&'a self) -> Self::View { &self[..] }\r\n}\r\n```\r\nWe would then need:\r\n* support for pretty-printing `&[T]` and `&str`\r\n  * already exists in our custom pretty-printing scripts\r\n  * long-term DWARF should allow us to express these directly (see #37504)\r\n* a way to encode `<X as DebuggerView>::debugger_view` in `X`'s debuginfo\r\n  * i.e. a symbol name, or maybe we can make symbol names based on DWARF type IDs?\r\n* support for going through `<X as DebuggerView>::debugger_view` for pretty-printing\r\n  * the method signature above should be relatively simple to call\r\n\r\nI suspect there are better APIs that could accommodate more complex data structures, but I'm not sure what the limitation of the pretty-printer scripts are, around being able to call arbitrary functions.\r\n\r\nThere's also the possibility that we could encode this sort of information as data, instead of compiling it into functions, but that's probably a lot more work.\r\n\r\ncc @michaelwoerister ", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/65564/reactions", "total_count": 4, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 4, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/65564/timeline", "performed_via_github_app": null, "state_reason": null}