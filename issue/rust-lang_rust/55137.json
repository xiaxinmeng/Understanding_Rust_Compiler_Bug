{"url": "https://api.github.com/repos/rust-lang/rust/issues/55137", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/55137/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/55137/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/55137/events", "html_url": "https://github.com/rust-lang/rust/issues/55137", "id": 370880391, "node_id": "MDU6SXNzdWUzNzA4ODAzOTE=", "number": 55137, "title": "Investigate post-link optimization via BOLT for improving compiler speed", "user": {"login": "bstrie", "id": 865233, "node_id": "MDQ6VXNlcjg2NTIzMw==", "avatar_url": "https://avatars.githubusercontent.com/u/865233?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bstrie", "html_url": "https://github.com/bstrie", "followers_url": "https://api.github.com/users/bstrie/followers", "following_url": "https://api.github.com/users/bstrie/following{/other_user}", "gists_url": "https://api.github.com/users/bstrie/gists{/gist_id}", "starred_url": "https://api.github.com/users/bstrie/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bstrie/subscriptions", "organizations_url": "https://api.github.com/users/bstrie/orgs", "repos_url": "https://api.github.com/users/bstrie/repos", "events_url": "https://api.github.com/users/bstrie/events{/privacy}", "received_events_url": "https://api.github.com/users/bstrie/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 64037154, "node_id": "MDU6TGFiZWw2NDAzNzE1NA==", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-compiletime", "name": "I-compiletime", "color": "e11d21", "default": false, "description": "Problems and improvements with respect to compile times."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-10-17T03:10:36Z", "updated_at": "2018-10-17T03:55:22Z", "closed_at": "2018-10-17T03:55:22Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Facebook has written a post-link optimizer called [BOLT](https://github.com/facebookincubator/BOLT). Its purpose is to analyze static binaries and reorder code segments in order to optimize icache utilization.\r\n\r\nThey have [an experience report on using this tool to optimize binaries of the Clang compiler](https://github.com/facebookincubator/BOLT/blob/master/docs/OptimizingClang.md). For a benchmark of building Clang, BOLT'd Clang binaries were 25% faster, or 12% faster when the Clang binary had first been compiled with LTO and PGO.\r\n\r\nThey have a paper with more details here: https://arxiv.org/pdf/1807.06735.pdf\r\n\r\nThe question is whether or not we can apply this tool to rustc. I'm not sure if the compiler binaries we distribute are built with LTO or any form of PGO (how well do we even support that?), and if they aren't then we might hope see a disproportionate benefit from doing so.\r\n\r\nAccording to a developer, there is reason to suspect that it may not take much (any?) work to get it to operate on Rust code: https://github.com/facebookincubator/BOLT/issues/41#issuecomment-430470002 , as long as the code does not \"rely on code layout properties, such as function pointer deltas\" (I don't know if rustc generates any code that would violate that), and as long as binaries are linked with `--emit-relocs`.", "closed_by": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/55137/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/55137/timeline", "performed_via_github_app": null, "state_reason": "completed"}