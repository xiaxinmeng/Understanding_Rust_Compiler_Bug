{"url": "https://api.github.com/repos/rust-lang/rust/issues/1864", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/1864/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/1864/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/1864/events", "html_url": "https://github.com/rust-lang/rust/issues/1864", "id": 3270982, "node_id": "MDU6SXNzdWUzMjcwOTgy", "number": 1864, "title": "RFC: Require explicit syntax to declare boxed, unique closures", "user": {"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 11, "created_at": "2012-02-17T17:39:31Z", "updated_at": "2012-05-07T20:21:09Z", "closed_at": "2012-05-07T20:21:09Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "So, currently, the sugared closure syntax `{||...}` can be used for any kind of closure.  @brson and I wanted this so that task spawning looks nice:\n\n```\ntask::spawn {||...}\n```\n\nbut I've since soured on it (and I think he has too).  The basic reason is that it is not explicit whether the closure is a boxed or unique closure: this depends on the definition of the callee function.  But this distinction is important to the semantics and cost model.  Therefore, I would like to make it so that `{||...}` is always a stack closure (`fn&`).\n\nWith no other changes, this would mean that spawning a task is written `task::spawn(fn~() {...})`.  To make `fn@()` and `fn~()` a little more convenient to use, however, we could make any or all of the following changes:\n1. Do not require variable types (I think this would be relatively straightforward; I also think there's an existing bug for this but can't find it at the moment).\n2. Allow parentheses to be omitted if there are no arguments (e.g., `task::spawn(fn~ {...})`)\n3. Allow paren-less calls, similar to a sugared closure like `{||...}` (e.g., `task::spawn fn~ {...}` or `task::spawn fn~() {...}`)\n\nThis RFC is truly a \"request for comment\" because I'm not really sure what's best.  Should we just leave things as they are?  If not, do we implement the proposals above to lighten the syntax a bit?  I think the first point (omitting variable types) is a clear win, but I'm less sure about #2 and #3.  The fully explicit form is perhaps not so bad.\n\np.s. Another option might be to add some sigil to the sugared form, but `task::spawn {~|| ...}` just looks like a lot of random characters in a row to me.\n", "closed_by": {"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/1864/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/1864/timeline", "performed_via_github_app": null, "state_reason": "completed"}