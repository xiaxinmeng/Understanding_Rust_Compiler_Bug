{"url": "https://api.github.com/repos/rust-lang/rust/issues/25943", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/25943/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/25943/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/25943/events", "html_url": "https://github.com/rust-lang/rust/issues/25943", "id": 83570259, "node_id": "MDU6SXNzdWU4MzU3MDI1OQ==", "number": 25943, "title": "rustdoc does not expand escape sequences in doc fragments of macros properly", "user": {"login": "thelink2012", "id": 5925581, "node_id": "MDQ6VXNlcjU5MjU1ODE=", "avatar_url": "https://avatars.githubusercontent.com/u/5925581?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thelink2012", "html_url": "https://github.com/thelink2012", "followers_url": "https://api.github.com/users/thelink2012/followers", "following_url": "https://api.github.com/users/thelink2012/following{/other_user}", "gists_url": "https://api.github.com/users/thelink2012/gists{/gist_id}", "starred_url": "https://api.github.com/users/thelink2012/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thelink2012/subscriptions", "organizations_url": "https://api.github.com/users/thelink2012/orgs", "repos_url": "https://api.github.com/users/thelink2012/repos", "events_url": "https://api.github.com/users/thelink2012/events{/privacy}", "received_events_url": "https://api.github.com/users/thelink2012/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 203738, "node_id": "MDU6TGFiZWwyMDM3Mzg=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-rustdoc", "name": "T-rustdoc", "color": "bfd4f2", "default": false, "description": "Relevant to the rustdoc team, which will review and decide on the PR/issue."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2015-06-01T15:45:08Z", "updated_at": "2015-07-17T23:58:55Z", "closed_at": "2015-07-17T23:58:55Z", "author_association": "NONE", "active_lock_reason": null, "body": "All of the following I'm going to describe **happens only when expanding doc comments in a macro, using meta fragments, in other contexts it works fine, so it indeed is a thing!** A sample of doc comments expansion in a macro can be found at #25929 so I'll skip samples and go direct to the point.\n\nIf I use a escape sequence of usual strings it seems to expand it right there on rustdoc.\n\nI have found the issue by trying to do something like the following:\n\n```\n /// `\\0`\n```\n\nWhen I run `cargo doc` I get this panic:\n\n```\nPS C:\\Projects\\forks\\iup-rust> cargo doc --verbose\n       Fresh libc v0.1.6\n   Compiling iup v0.0.2 (file:///C:/Projects/forks/iup-rust)\n     Running `rustdoc src\\lib.rs --crate-name iup -o C:\\Projects\\forks\\iup-rust\\target\\doc -L dependency=C:\\Projects\\for\nks\\iup-rust\\target\\debug -L dependency=C:\\Projects\\forks\\iup-rust\\target\\debug\\deps --extern libc=C:\\Projects\\forks\\iup-\nrust\\target\\debug\\deps\\liblibc-d8d1720964a096ed.rlib --extern libc=C:\\Projects\\forks\\iup-rust\\target\\debug\\deps\\liblibc-\nd8d1720964a096ed.rlib --extern iup_sys=C:\\Projects\\forks\\iup-rust\\target\\debug\\deps\\libiup_sys-16fee22cb642ccd4.rlib --e\nxtern iup_sys=C:\\Projects\\forks\\iup-rust\\target\\debug\\deps\\libiup_sys-16fee22cb642ccd4.rlib`\n       Fresh iup-sys v0.0.3\nthread '<unnamed>' panicked at 'called `Result::unwrap()` on an `Err` value: NulError(6, [60, 99, 111, 100, 101, 62, 0,\n60, 47, 99, 111, 100, 101, 62])', C:/bot/slave/stable-dist-rustc-win-32/build/src/libcore\\result.rs:729\nstack backtrace:\n   1: 0x63102bdf - rt::unwind::register::ha3686cf8cb60783c3wv\n   2: 0x630c56fc - rt::unwind::begin_unwind_inner::h6a42beee3bbc278bduv\n   3: 0x630c611f - rt::unwind::begin_unwind_fmt::h2fc1fc2db73eb310Rsv\n   4: 0x63102640 - rust_begin_unwind\n   5: 0x6311cf28 - panicking::panic_fmt::h52b0d659b0d05042wwy\n   6: 0x6c8fcc9f - html::toc::TocBuilder::new::hb7ed7be44c6fc916q6r\n   7: 0x6ca514d4 - hoedown_buffer_printf\n   8: 0x6ca5185d - hoedown_buffer_printf\n   9: 0x76ddb106 - free\nthread '<main>' panicked at 'called `Result::unwrap()` on an `Err` value: Any', C:/bot/slave/stable-dist-rustc-win-32/bu\nild/src/libcore\\result.rs:729\nstack backtrace:\n   1: 0x63102bdf - rt::unwind::register::ha3686cf8cb60783c3wv\n   2: 0x630c56fc - rt::unwind::begin_unwind_inner::h6a42beee3bbc278bduv\n   3: 0x630c611f - rt::unwind::begin_unwind_fmt::h2fc1fc2db73eb310Rsv\n   4: 0x63102640 - rust_begin_unwind\n   5: 0x6311cf28 - panicking::panic_fmt::h52b0d659b0d05042wwy\n   6: 0x6c99b2cc - main::h854d123b237a9daepdu\n   7: 0x6313c59c - rust_try\n   8:   0x401645 - main\n   9:   0x4013de\n  10: 0x765b7c04 - BaseThreadInitThunk\n  11: 0x76fcad1f - RtlInitializeExceptionChain\nCould not document `iup`.\n\nCaused by:\n  Process didn't exit successfully: `rustdoc src\\lib.rs --crate-name iup -o C:\\Projects\\forks\\iup-rust\\target\\doc -L dep\nendency=C:\\Projects\\forks\\iup-rust\\target\\debug -L dependency=C:\\Projects\\forks\\iup-rust\\target\\debug\\deps --extern libc\n=C:\\Projects\\forks\\iup-rust\\target\\debug\\deps\\liblibc-d8d1720964a096ed.rlib --extern libc=C:\\Projects\\forks\\iup-rust\\tar\nget\\debug\\deps\\liblibc-d8d1720964a096ed.rlib --extern iup_sys=C:\\Projects\\forks\\iup-rust\\target\\debug\\deps\\libiup_sys-16\nfee22cb642ccd4.rlib --extern iup_sys=C:\\Projects\\forks\\iup-rust\\target\\debug\\deps\\libiup_sys-16fee22cb642ccd4.rlib` (exi\nt code: 101)\n```\n\nWhen using the `\\0` outside a code block it does not happen, but if I try a hexadecimal literal outside the code block instead it still panics.\n\n```\n/// \\x0\n```\n\nI get\n\n```\nPS C:\\Projects\\forks\\iup-rust> cargo doc --verbose\n   Compiling iup v0.0.2 (file:///C:/Projects/forks/iup-rust)\n     Running `rustdoc src\\lib.rs --crate-name iup -o C:\\Projects\\forks\\iup-rust\\target\\doc -L dependency=C:\\Projects\\for\nks\\iup-rust\\target\\debug -L dependency=C:\\Projects\\forks\\iup-rust\\target\\debug\\deps --extern libc=C:\\Projects\\forks\\iup-\nrust\\target\\debug\\deps\\liblibc-d8d1720964a096ed.rlib --extern libc=C:\\Projects\\forks\\iup-rust\\target\\debug\\deps\\liblibc-\nd8d1720964a096ed.rlib --extern iup_sys=C:\\Projects\\forks\\iup-rust\\target\\debug\\deps\\libiup_sys-16fee22cb642ccd4.rlib --e\nxtern iup_sys=C:\\Projects\\forks\\iup-rust\\target\\debug\\deps\\libiup_sys-16fee22cb642ccd4.rlib`\n       Fresh libc v0.1.6\n       Fresh iup-sys v0.0.3\nthread '<unnamed>' panicked at 'lexer should have rejected a bad character escape \\x0 Action generated when the text is\nedited, but before its value is actually changed.', C:/bot/slave/stable-dist-rustc-win-32/build/src/libcore\\option.rs:33\n0\nstack backtrace:\n   1: 0x63102bdf - rt::unwind::register::ha3686cf8cb60783c3wv\n   2: 0x630c56fc - rt::unwind::begin_unwind_inner::h6a42beee3bbc278bduv\n   3: 0x630c611f - rt::unwind::begin_unwind_fmt::h2fc1fc2db73eb310Rsv\n   4: 0x63102640 - rust_begin_unwind\n   5: 0x6311cf28 - panicking::panic_fmt::h52b0d659b0d05042wwy\n   6: 0x6a1f6a42 - parse::char_lit::h76da3a3875da6b37cXT\n   7: 0x6a1f86d2 - parse::str_lit::h85149c8921a41c28h2T\n   8: 0x6a1f59b7 - parse::parser::Parser<'a>::lit_from_token::h68fc0ae22c986b30yQG\n   9: 0x6a1fa317 - parse::parser::Parser<'a>::parse_lit::h9f70e38391de0fa2yUG\n  10: 0x6a2482b4 - parse::attr::Parser<'a>.ParserAttr::parse_meta_item::h1c98783168c92ce14kT\n  11: 0x6a423862 - ext::tt::macro_parser::parse_nt::h25dc8b6a526655dfPZf\n  12: 0x6a13ad50 - ext::tt::macro_parser::parse::ha0f605ccc4fd9aa7GJf\n  13: 0x6a137b8f - ast::TokenTree::parse::h79e7e0468b7d782bdCl\n  14: 0x6a42563a - ext::tt::macro_rules::MacroRulesMacroExpander.TTMacroExpander::expand::h96b4da2fbcd98be3Xeg\n  15: 0x6a38044b - ext::expand::expand_item_mac::h6351873f0995efe7tib\n  16: 0x6a37030d - ext::expand::expand_item::hf68f0012c3b848a1scb\n  17: 0x6a36ccd8 - ext::expand::expand_item::hf68f0012c3b848a1scb\n  18: 0x6a379e6f - ext::expand::expand_item::hf68f0012c3b848a1scb\n  19: 0x6a379ae6 - ext::expand::expand_item::hf68f0012c3b848a1scb\n  20: 0x6a374757 - ext::expand::expand_item::hf68f0012c3b848a1scb\n  21: 0x6a3cfc65 - ext::expand::PatIdentRenamer<'a>.Folder::fold_mac::h289ea2cd95f4c5b4CMb\n  22: 0x6a3cfacf - ext::expand::PatIdentRenamer<'a>.Folder::fold_mac::h289ea2cd95f4c5b4CMb\n  23: 0x6a37173b - ext::expand::expand_item::hf68f0012c3b848a1scb\n  24: 0x6a36ccd8 - ext::expand::expand_item::hf68f0012c3b848a1scb\n  25: 0x6a379e6f - ext::expand::expand_item::hf68f0012c3b848a1scb\n  26: 0x6a379ae6 - ext::expand::expand_item::hf68f0012c3b848a1scb\n  27: 0x6a374757 - ext::expand::expand_item::hf68f0012c3b848a1scb\n  28: 0x6a3cfc65 - ext::expand::PatIdentRenamer<'a>.Folder::fold_mac::h289ea2cd95f4c5b4CMb\n  29: 0x6a3cfacf - ext::expand::PatIdentRenamer<'a>.Folder::fold_mac::h289ea2cd95f4c5b4CMb\n  30: 0x6a37173b - ext::expand::expand_item::hf68f0012c3b848a1scb\n  31: 0x6a36ccd8 - ext::expand::expand_item::hf68f0012c3b848a1scb\n  32: 0x6a379e6f - ext::expand::expand_item::hf68f0012c3b848a1scb\n  33: 0x6a379ae6 - ext::expand::expand_item::hf68f0012c3b848a1scb\n  34: 0x6a374757 - ext::expand::expand_item::hf68f0012c3b848a1scb\n  35: 0x6a3cfc65 - ext::expand::PatIdentRenamer<'a>.Folder::fold_mac::h289ea2cd95f4c5b4CMb\n  36: 0x6a3cfacf - ext::expand::PatIdentRenamer<'a>.Folder::fold_mac::h289ea2cd95f4c5b4CMb\n  37: 0x6a37173b - ext::expand::expand_item::hf68f0012c3b848a1scb\n  38: 0x6a36ccd8 - ext::expand::expand_item::hf68f0012c3b848a1scb\n  39: 0x6a3d6f01 - ext::expand::expand_crate::ha0bcd83c140e9790Y9b\n  40: 0x6cd67820 - driver::collect_crate_metadata::h5feaa081cce22dd0E1a\n  41: 0x6cd13930 - driver::phase_2_configure_and_expand::he8982b2f8dc553f7Wsa\n  42: 0x6c8cdb2e - core::run_core::h54f67f861d00dcf7wnj\n  43: 0x6c9b22c6 - usage::h7829c7327eb005efpgu\n  44: 0x6c9b16fb - usage::h7829c7327eb005efpgu\n  45: 0x63100e18 - sys::process2::Command::cwd::h292693c1b697cec3Yeu\n  46: 0x765b7c04 - BaseThreadInitThunk\n  47: 0x76fcad1f - RtlInitializeExceptionChain\nthread '<unnamed>' panicked at 'called `Result::unwrap()` on an `Err` value: \"rustc failed\"', C:/bot/slave/stable-dist-r\nustc-win-32/build/src/libcore\\result.rs:729\nstack backtrace:\n   1: 0x63102bdf - rt::unwind::register::ha3686cf8cb60783c3wv\n   2: 0x630c56fc - rt::unwind::begin_unwind_inner::h6a42beee3bbc278bduv\n   3: 0x630c611f - rt::unwind::begin_unwind_fmt::h2fc1fc2db73eb310Rsv\n   4: 0x63102640 - rust_begin_unwind\n   5: 0x6311cf28 - panicking::panic_fmt::h52b0d659b0d05042wwy\n   6: 0x6c9a88c8 - usage::h7829c7327eb005efpgu\n   7: 0x6c99fef1 - main_args::hacd7685d13170c8aChu\n   8: 0x6c99c239 - main::h854d123b237a9daepdu\n   9: 0x6c99b6ab - main::h854d123b237a9daepdu\n  10: 0x63100e18 - sys::process2::Command::cwd::h292693c1b697cec3Yeu\n  11: 0x765b7c04 - BaseThreadInitThunk\n  12: 0x76fcad1f - RtlInitializeExceptionChain\nthread '<main>' panicked at 'called `Result::unwrap()` on an `Err` value: Any', C:/bot/slave/stable-dist-rustc-win-32/bu\nild/src/libcore\\result.rs:729\nstack backtrace:\n   1: 0x63102bdf - rt::unwind::register::ha3686cf8cb60783c3wv\n   2: 0x630c56fc - rt::unwind::begin_unwind_inner::h6a42beee3bbc278bduv\n   3: 0x630c611f - rt::unwind::begin_unwind_fmt::h2fc1fc2db73eb310Rsv\n   4: 0x63102640 - rust_begin_unwind\n   5: 0x6311cf28 - panicking::panic_fmt::h52b0d659b0d05042wwy\n   6: 0x6c99b2cc - main::h854d123b237a9daepdu\n   7: 0x6313c59c - rust_try\n   8:   0x401645 - main\n   9:   0x4013de\n  10: 0x765b7c04 - BaseThreadInitThunk\n  11: 0x76fcad1f - RtlInitializeExceptionChain\nCould not document `iup`.\n\nCaused by:\n  Process didn't exit successfully: `rustdoc src\\lib.rs --crate-name iup -o C:\\Projects\\forks\\iup-rust\\target\\doc -L dep\nendency=C:\\Projects\\forks\\iup-rust\\target\\debug -L dependency=C:\\Projects\\forks\\iup-rust\\target\\debug\\deps --extern libc\n=C:\\Projects\\forks\\iup-rust\\target\\debug\\deps\\liblibc-d8d1720964a096ed.rlib --extern libc=C:\\Projects\\forks\\iup-rust\\tar\nget\\debug\\deps\\liblibc-d8d1720964a096ed.rlib --extern iup_sys=C:\\Projects\\forks\\iup-rust\\target\\debug\\deps\\libiup_sys-16\nfee22cb642ccd4.rlib --extern iup_sys=C:\\Projects\\forks\\iup-rust\\target\\debug\\deps\\libiup_sys-16fee22cb642ccd4.rlib` (exi\nt code: 101)\n```\n\nInteresting but let's try something that is not a null character to see what happens:\n\n```\n/// \\x61\n```\n\nHa! I get a `a` in my html output!\n### Meta\n\n```\nPS C:\\Projects\\forks\\iup-rust> rustc --version --verbose\nrustc 1.0.0 (a59de37e9 2015-05-13) (built 2015-05-14)\nbinary: rustc\ncommit-hash: a59de37e99060162a2674e3ff45409ac73595c0e\ncommit-date: 2015-05-13\nbuild-date: 2015-05-14\nhost: i686-pc-windows-gnu\nrelease: 1.0.0\nPS C:\\Projects\\forks\\iup-rust> cargo --version --verbose\ncargo 0.2.0-nightly (efb482d 2015-04-30) (built 2015-04-30)\nPS C:\\Projects\\forks\\iup-rust> rustdoc --version --verbose\nrustdoc 1.0.0 (a59de37e9 2015-05-13) (built 2015-05-14)\nbinary: rustdoc\ncommit-hash: a59de37e99060162a2674e3ff45409ac73595c0e\ncommit-date: 2015-05-13\nbuild-date: 2015-05-14\nhost: i686-pc-windows-gnu\nrelease: 1.0.0\n```\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/25943/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/25943/timeline", "performed_via_github_app": null, "state_reason": "completed"}