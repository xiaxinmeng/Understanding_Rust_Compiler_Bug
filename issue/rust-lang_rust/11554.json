{"url": "https://api.github.com/repos/rust-lang/rust/issues/11554", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/11554/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/11554/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/11554/events", "html_url": "https://github.com/rust-lang/rust/issues/11554", "id": 25622120, "node_id": "MDU6SXNzdWUyNTYyMjEyMA==", "number": 11554, "title": "ICE on attempt to use do syntax for map", "user": {"login": "vi", "id": 173219, "node_id": "MDQ6VXNlcjE3MzIxOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/173219?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vi", "html_url": "https://github.com/vi", "followers_url": "https://api.github.com/users/vi/followers", "following_url": "https://api.github.com/users/vi/following{/other_user}", "gists_url": "https://api.github.com/users/vi/gists{/gist_id}", "starred_url": "https://api.github.com/users/vi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vi/subscriptions", "organizations_url": "https://api.github.com/users/vi/orgs", "repos_url": "https://api.github.com/users/vi/repos", "events_url": "https://api.github.com/users/vi/events{/privacy}", "received_events_url": "https://api.github.com/users/vi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2014-01-15T02:25:44Z", "updated_at": "2014-01-30T23:56:17Z", "closed_at": "2014-01-30T23:56:17Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "```\n$ rustc --version\nrustc 0.9 (7613b15 2014-01-08 18:04:43 -0800)\nhost: i686-unknown-linux-gnu\n\n$ RUST_LOG=rustc=1 bash -x runrust 'fn main() { do [3,4,5].map |x| { println(format!(\"qq {}\", 0)) }} '\n+ set -e\n+ echo 'fn main() { do [3,4,5].map |x| { println(format!(\"qq {}\", 0)) }} '\n+ rustc /tmp/runrust.rs -o /tmp/runrust\n/tmp/runrust.rs:1:24: 1:64 error: last argument in `do` call has non-procedure type: |&<VI2>| -> <V83>\n/tmp/runrust.rs:1 fn main() { do [3,4,5].map |x| { println(format!(\"qq {}\", 0)) }} \n                                         ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n/tmp/runrust.rs:1:13: 1:64 error: mismatched types: expected `()` but found `~[()]` (expected () but found vector)\n/tmp/runrust.rs:1 fn main() { do [3,4,5].map |x| { println(format!(\"qq {}\", 0)) }} \n                              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\ntask 'rustc' failed at 'assertion failed: !ty::type_needs_infer(ty)', /home/vi/src/git/rust/src/librustc/middle/typeck/mod.rs:242\nerror: internal compiler error: unexpected failure\nThis message reflects a bug in the Rust compiler. \nWe would appreciate a bug report: https://github.com/mozilla/rust/wiki/HOWTO-submit-a-Rust-bug-report\nnote: the compiler hit an unexpected failure path. this is a bug\nnote: try running with RUST_LOG=rustc=1 to get further details and report the results to github.com/mozilla/rust/issues\ntask '<main>' failed at 'explicit failure', /home/vi/src/git/rust/src/librustc/lib.rs:453\n```\n\nGDB output:\n\n```\n#0  0xf7ba53b0 in rust_fail () from /usr/local/bin/../lib/libstd-3e5aeb83-0.9.so\n#1  0xf7b056fa in rt::unwind::Unwinder::begin_unwind::hc8bfa227501f1739HUaB::v0.9 () from /usr/local/bin/../lib/libstd-3e5aeb83-0.9.so\n#2  0xf4f5143e in rt::unwind::begin_unwind::h6f4e127c5f7d59b0aL::v0.9 () from /usr/local/bin/../lib/librustc-8b28e8d8-0.9.so\n#3  0xf51dd36d in middle::typeck::write_ty_to_tcx::hfb704f9d4ed5a9c7ap::v0.9 () from /usr/local/bin/../lib/librustc-8b28e8d8-0.9.so\n#4  0xf51db2e0 in middle::typeck::check::writeback::resolve_type_vars_for_node::h65cc9138eac7694ba7::v0.9 () from /usr/local/bin/../lib/librustc-8b28e8d8-0.9.so\n#5  0xf51ddfa0 in middle::typeck::check::writeback::visit_expr::h5bf07ef518e52d2dar::v0.9 () from /usr/local/bin/../lib/librustc-8b28e8d8-0.9.so\n#6  0xf51de65e in visit::walk_expr::h5d905ff0dc476ee1a3::v0.9 () from /usr/local/bin/../lib/librustc-8b28e8d8-0.9.so\n#7  0xf51de2ff in middle::typeck::check::writeback::visit_expr::h5bf07ef518e52d2dar::v0.9 () from /usr/local/bin/../lib/librustc-8b28e8d8-0.9.so\n#8  0xf51df8f6 in visit::walk_expr_opt::hc58b723767d097d0aa::v0.9 () from /usr/local/bin/../lib/librustc-8b28e8d8-0.9.so\n#9  0xf51e0069 in visit::walk_block::hecf888d857f79fb1as::v0.9 () from /usr/local/bin/../lib/librustc-8b28e8d8-0.9.so\n#10 0xf51e0f6d in middle::typeck::check::writeback::resolve_type_vars_in_fn::h57f64e1a1948db4da6::v0.9 () from /usr/local/bin/../lib/librustc-8b28e8d8-0.9.so\n#11 0xf5216ef6 in middle::typeck::check::check_bare_fn::hdc36bb7691131ffbaS::v0.9 () from /usr/local/bin/../lib/librustc-8b28e8d8-0.9.so\n#12 0xf5211812 in middle::typeck::check::check_item::hf835d20aaddf9e43aH::v0.9 () from /usr/local/bin/../lib/librustc-8b28e8d8-0.9.so\n#13 0xf5216400 in visit::Visitor::visit_mod::h206533d9f8e89071a2::v0.9 () from /usr/local/bin/../lib/librustc-8b28e8d8-0.9.so\n#14 0xf5216c22 in middle::typeck::check::check_item_types::h85a548abacb44bf6as::v0.9 () from /usr/local/bin/../lib/librustc-8b28e8d8-0.9.so\n#15 0xf52eb6a8 in middle::typeck::check_crate::anon::expr_fn::ag () from /usr/local/bin/../lib/librustc-8b28e8d8-0.9.so\n#16 0xf52eb08a in util::common::time::hfa69db670ecb63feaC::v0.9 () from /usr/local/bin/../lib/librustc-8b28e8d8-0.9.so\n#17 0xf52e9b03 in middle::typeck::check_crate::h4fab6be316cb3299am::v0.9 () from /usr/local/bin/../lib/librustc-8b28e8d8-0.9.so\n#18 0xf55babb1 in driver::driver::phase_3_run_analysis_passes::ha7087cb051c062bea6::v0.9 () from /usr/local/bin/../lib/librustc-8b28e8d8-0.9.so\n#19 0xf55c09ae in driver::driver::compile_input::hf4b9fbe65f18acf9aq::v0.9 () from /usr/local/bin/../lib/librustc-8b28e8d8-0.9.so\n#20 0xf55e398a in run_compiler::hd6709e8be9a0e103ar::v0.9 () from /usr/local/bin/../lib/librustc-8b28e8d8-0.9.so\n#21 0xf55f1425 in main_args::anon::expr_fn::a2 () from /usr/local/bin/../lib/librustc-8b28e8d8-0.9.so\n#22 0xf55ef563 in monitor::anon::expr_fn::ac () from /usr/local/bin/../lib/librustc-8b28e8d8-0.9.so\n#23 0xf55e838a in task::TaskBuilder::try::anon::expr_fn::A4a3aH () from /usr/local/bin/../lib/librustc-8b28e8d8-0.9.so\n#24 0xf7a7cf4e in task::__extensions__::build_start_wrapper::anon::anon::expr_fn::aW () from /usr/local/bin/../lib/libgreen-83b1c0e5-0.9.so\n#25 0xf7ba10ad in rt::task::__extensions__::run::anon::expr_fn::af () from /usr/local/bin/../lib/libstd-3e5aeb83-0.9.so\n#26 0xf7ba53a3 in rt::unwind::Unwinder::try::try_fn::h620ec470d26abd6cHUaZ::v0.9 () from /usr/local/bin/../lib/libstd-3e5aeb83-0.9.so\n#27 0xf7ba8453 in rust_try () from /usr/local/bin/../lib/libstd-3e5aeb83-0.9.so\n#28 0xf7ba0ef7 in rt::task::Task::run::h5965995b3900fedaVjac::v0.9 () from /usr/local/bin/../lib/libstd-3e5aeb83-0.9.so\n#29 0xf7a7c9af in task::__extensions__::build_start_wrapper::anon::expr_fn::aF () from /usr/local/bin/../lib/libgreen-83b1c0e5-0.9.so\n#30 0xf7a60715 in context::Context::new::task_start_wrapper::h1f5acced98c5df952Sa2::v0.9 () from /usr/local/bin/../lib/libgreen-83b1c0e5-0.9.so\n#31 0x00000000 in ?? ()\n```\n", "closed_by": {"login": "thestinger", "id": 1505226, "node_id": "MDQ6VXNlcjE1MDUyMjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thestinger", "html_url": "https://github.com/thestinger", "followers_url": "https://api.github.com/users/thestinger/followers", "following_url": "https://api.github.com/users/thestinger/following{/other_user}", "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}", "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions", "organizations_url": "https://api.github.com/users/thestinger/orgs", "repos_url": "https://api.github.com/users/thestinger/repos", "events_url": "https://api.github.com/users/thestinger/events{/privacy}", "received_events_url": "https://api.github.com/users/thestinger/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/11554/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/11554/timeline", "performed_via_github_app": null, "state_reason": "completed"}