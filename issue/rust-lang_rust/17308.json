{"url": "https://api.github.com/repos/rust-lang/rust/issues/17308", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/17308/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/17308/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/17308/events", "html_url": "https://github.com/rust-lang/rust/issues/17308", "id": 42907270, "node_id": "MDU6SXNzdWU0MjkwNzI3MA==", "number": 17308, "title": "Thread crashes if Receiver is used", "user": {"login": "vhbit", "id": 140199, "node_id": "MDQ6VXNlcjE0MDE5OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/140199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vhbit", "html_url": "https://github.com/vhbit", "followers_url": "https://api.github.com/users/vhbit/followers", "following_url": "https://api.github.com/users/vhbit/following{/other_user}", "gists_url": "https://api.github.com/users/vhbit/gists{/gist_id}", "starred_url": "https://api.github.com/users/vhbit/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vhbit/subscriptions", "organizations_url": "https://api.github.com/users/vhbit/orgs", "repos_url": "https://api.github.com/users/vhbit/repos", "events_url": "https://api.github.com/users/vhbit/events{/privacy}", "received_events_url": "https://api.github.com/users/vhbit/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2014-09-16T17:12:30Z", "updated_at": "2015-01-27T17:45:44Z", "closed_at": "2015-01-27T17:45:44Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Here is a test case:\n\n``` rust\nuse std::rt::thread::Thread;\n\nfn write_loop(rx: Receiver<uint>) {\n    loop {\n        match rx.recv_opt() {\n            Ok(v) => println!(\"v {}\", v),\n            _ => break\n        }\n    }\n}\n\nfn main() {\n    let (tx, rx) = channel();\n    Thread::start(proc() {\n        write_loop(rx);\n    });\n\n    tx.send(3u);\n}\n```\n\nOutput: `fatal runtime error:  assertion failed: !ptr.is_null()`\n\nI guess that's because there is no `Task` associated with thread and while it is possible to create a task manually - there is no known for me way to put `Runtime` into it. \n\nConsidering there is no direct way to guess what for this thread is created and whether it should use native runtime or not, it is reasonable. But it is still quite unexpected, so I believe there should be either a way to put runtime into it or documentation of `Receiver` should note that more clearly. \n", "closed_by": {"login": "steveklabnik", "id": 27786, "node_id": "MDQ6VXNlcjI3Nzg2", "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/steveklabnik", "html_url": "https://github.com/steveklabnik", "followers_url": "https://api.github.com/users/steveklabnik/followers", "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}", "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}", "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions", "organizations_url": "https://api.github.com/users/steveklabnik/orgs", "repos_url": "https://api.github.com/users/steveklabnik/repos", "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}", "received_events_url": "https://api.github.com/users/steveklabnik/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/17308/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/17308/timeline", "performed_via_github_app": null, "state_reason": "completed"}