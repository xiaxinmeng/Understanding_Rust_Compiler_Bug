{"url": "https://api.github.com/repos/rust-lang/rust/issues/97181", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/97181/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/97181/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/97181/events", "html_url": "https://github.com/rust-lang/rust/issues/97181", "id": 1241981306, "node_id": "I_kwDOAAsO6M5KByF6", "number": 97181, "title": "\"thread panicked while panicking. aborting.\" when panicking in display trait, which is utilized in panic", "user": {"login": "Elias-Graf", "id": 46671625, "node_id": "MDQ6VXNlcjQ2NjcxNjI1", "avatar_url": "https://avatars.githubusercontent.com/u/46671625?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Elias-Graf", "html_url": "https://github.com/Elias-Graf", "followers_url": "https://api.github.com/users/Elias-Graf/followers", "following_url": "https://api.github.com/users/Elias-Graf/following{/other_user}", "gists_url": "https://api.github.com/users/Elias-Graf/gists{/gist_id}", "starred_url": "https://api.github.com/users/Elias-Graf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Elias-Graf/subscriptions", "organizations_url": "https://api.github.com/users/Elias-Graf/orgs", "repos_url": "https://api.github.com/users/Elias-Graf/repos", "events_url": "https://api.github.com/users/Elias-Graf/events{/privacy}", "received_events_url": "https://api.github.com/users/Elias-Graf/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 630810559, "node_id": "MDU6TGFiZWw2MzA4MTA1NTk=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-libtest", "name": "A-libtest", "color": "f7e101", "default": false, "description": "Area: #[test] related"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-05-19T15:46:51Z", "updated_at": "2022-05-19T20:44:29Z", "closed_at": null, "author_association": "NONE", "active_lock_reason": null, "body": "<!--\r\nThank you for filing a bug report! \ud83d\udc1b Please provide a short summary of the bug,\r\nalong with any information you feel relevant to replicating the bug.\r\n\r\nIf you cannot produce a minimal reproduction case (something that would work in\r\nisolation), please provide the steps or even link to a repository that causes\r\nthe problematic output to occur.\r\n-->\r\n\r\n**The following occurs when running the tests**\r\n\r\nGiven the following code: https://play.rust-lang.org/?version=stable&mode=debug&edition=2021&gist=35f64605807f3e34fd6a5cb1e650677c\r\n\r\n```rust\r\nuse std::fmt::{Display, self};\r\n\r\nstruct MyStruct;\r\n\r\nimpl Display for MyStruct {\r\n    fn fmt(&self, _: &mut fmt::Formatter<'_>) -> fmt::Result {\r\n        todo!()\r\n    }\r\n}\r\n\r\n#[cfg(test)]\r\nmod test {\r\n    use super::*;\r\n\r\n    #[test]\r\n    fn struct_does_stuff() {\r\n        let instance = MyStruct;\r\n\r\n        assert!(false, \"oh no, '{}' was unexpected\", instance);\r\n    }\r\n}\r\n```\r\n\r\nWhen the tests are ran, the current output is:\r\n\r\n```\r\n   Compiling playground v0.0.1 (/playground)\r\n    Finished test [unoptimized + debuginfo] target(s) in 0.84s\r\n     Running unittests src/lib.rs (target/debug/deps/playground-ab40f7b3bfdd8beb)\r\nthread panicked while panicking. aborting.\r\nerror: test failed, to rerun pass '--lib'\r\n```\r\n\r\nAfter figuring out what the actual issue is, the error message makes sense. But my debugging journey would have been more pleasant, if the source location of the panics were included in the message. Much like the location of \"non-nested\" panics are printed.\r\n\r\n<!-- The following is not always necessary. -->\r\nIdeally the output should look like:\r\n\r\nAt least include the source location of the \"inner\" panic, or ideally both.\r\n\r\n*It also suggests to rerun pass with '--lib', which is a bit misleading.*\r\n\r\nIf above is not possible, at least print the name of the test that is failing.\r\n\r\n<!--\r\nIf the problem is not self-explanatory, please provide a rationale for the\r\nchange.\r\n-->\r\n\r\n<!--\r\nIf dramatically different output is caused by small changes, consider also\r\nadding them here.\r\n\r\nIf you're using the stable version of the compiler, you should also check if the\r\nbug also exists in the beta or nightly versions. The output might also be\r\ndifferent depending on the Edition.\r\n-->\r\n", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/97181/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/97181/timeline", "performed_via_github_app": null, "state_reason": null}