{"url": "https://api.github.com/repos/rust-lang/rust/issues/5353", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/5353/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/5353/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/5353/events", "html_url": "https://github.com/rust-lang/rust/issues/5353", "id": 11961118, "node_id": "MDU6SXNzdWUxMTk2MTExOA==", "number": 5353, "title": "Typechecker ICE with constant names in patterns and match on literal", "user": {"login": "jeaye", "id": 1057635, "node_id": "MDQ6VXNlcjEwNTc2MzU=", "avatar_url": "https://avatars.githubusercontent.com/u/1057635?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jeaye", "html_url": "https://github.com/jeaye", "followers_url": "https://api.github.com/users/jeaye/followers", "following_url": "https://api.github.com/users/jeaye/following{/other_user}", "gists_url": "https://api.github.com/users/jeaye/gists{/gist_id}", "starred_url": "https://api.github.com/users/jeaye/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jeaye/subscriptions", "organizations_url": "https://api.github.com/users/jeaye/orgs", "repos_url": "https://api.github.com/users/jeaye/repos", "events_url": "https://api.github.com/users/jeaye/events{/privacy}", "received_events_url": "https://api.github.com/users/jeaye/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 37544, "node_id": "MDU6TGFiZWwzNzU0NA==", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-typesystem", "name": "A-typesystem", "color": "f7e101", "default": false, "description": "Area: The type system"}, {"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/rust-lang/rust/milestones/10", "html_url": "https://github.com/rust-lang/rust/milestone/10", "labels_url": "https://api.github.com/repos/rust-lang/rust/milestones/10/labels", "id": 234060, "node_id": "MDk6TWlsZXN0b25lMjM0MDYw", "number": 10, "title": "0.7", "description": "", "creator": {"login": "catamorphism", "id": 427212, "node_id": "MDQ6VXNlcjQyNzIxMg==", "avatar_url": "https://avatars.githubusercontent.com/u/427212?v=4", "gravatar_id": "", "url": "https://api.github.com/users/catamorphism", "html_url": "https://github.com/catamorphism", "followers_url": "https://api.github.com/users/catamorphism/followers", "following_url": "https://api.github.com/users/catamorphism/following{/other_user}", "gists_url": "https://api.github.com/users/catamorphism/gists{/gist_id}", "starred_url": "https://api.github.com/users/catamorphism/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/catamorphism/subscriptions", "organizations_url": "https://api.github.com/users/catamorphism/orgs", "repos_url": "https://api.github.com/users/catamorphism/repos", "events_url": "https://api.github.com/users/catamorphism/events{/privacy}", "received_events_url": "https://api.github.com/users/catamorphism/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 110, "state": "closed", "created_at": "2012-12-22T22:31:59Z", "updated_at": "2013-07-04T01:21:16Z", "due_on": "2013-06-30T07:00:00Z", "closed_at": "2013-07-04T01:21:16Z"}, "comments": 6, "created_at": "2013-03-13T06:02:36Z", "updated_at": "2014-06-16T21:56:40Z", "closed_at": "2013-05-11T07:04:11Z", "author_association": "NONE", "active_lock_reason": null, "body": "Trace:\n\n```\nrust: task failed at 'option::get none', /home/jeaye/projects/rust_work/rust/src/libcore/option.rs:107\n/usr/local/bin/../lib/librustrt.so(_ZN9rust_task13begin_failureEPKcS1_j+0x5a)[0xb4c732ba]\n/usr/local/bin/../lib/librustrt.so(rust_task_fail+0x36)[0xb4c733b6]\n/usr/local/bin/../lib/librustrt.so(_ZN9rust_task4failEPKcS1_j+0x32)[0xb4c73422]\n/usr/local/bin/../lib/librustrt.so(upcall_s_fail+0x53)[0xb4c74c03]\n/usr/local/bin/../lib/librustrt.so(+0x2914f)[0xb4c8514f]\n/usr/local/bin/../lib/librustrt.so(upcall_fail+0x174)[0xb4c75244]\n/usr/local/bin/../lib/librustrt.so(rust_upcall_fail+0x2b)[0xb4c7538b]\n/usr/local/bin/../lib/libcore-c3ca5d77d81b46c1-0.6.so(_ZN3sys6rustrt16rust_upcall_fail17_2b2e25ba94c412183_06E+0x45)[0xb75d7945]\n/usr/local/bin/../lib/libcore-c3ca5d77d81b46c1-0.6.so(+0xee9eb)[0xb75d79eb]\n/usr/local/bin/../lib/libcore-c3ca5d77d81b46c1-0.6.so(+0xee99d)[0xb75d799d]\n/usr/local/bin/../lib/libcore-c3ca5d77d81b46c1-0.6.so(_ZN3sys12begin_unwind17_7cd364c41f10422f3_06E+0x73)[0xb751fca3]\n/usr/local/bin/../lib/librustc-c84825241471686d-0.6.so(_ZN6middle11check_match11pat_ctor_id16_2d1b278bef21d493_06E+0xa54)[0xb68deaa4]\n/usr/local/bin/../lib/librustc-c84825241471686d-0.6.so(_ZN6middle11check_match9is_useful17_1fac2c1010595d6e3_06E+0x1dc)[0xb68db79c]\n/usr/local/bin/../lib/librustc-c84825241471686d-0.6.so(+0x8cd088)[0xb6bc5088]\n/usr/local/bin/../lib/librustc-c84825241471686d-0.6.so(+0x5e330c)[0xb68db30c]\n/usr/local/bin/../lib/librustc-c84825241471686d-0.6.so(_ZN6middle11check_match10check_arms16_3ae84f572dfd6663_06E+0xd6)[0xb68d94d6]\n/usr/local/bin/../lib/librustc-c84825241471686d-0.6.so(_ZN6middle11check_match10check_expr15_db04d138a15d633_06E+0x155)[0xb68d7cb5]\n/usr/local/bin/../lib/librustc-c84825241471686d-0.6.so(+0x5df970)[0xb68d7970]\n/usr/local/bin/../lib/librustc-c84825241471686d-0.6.so(+0x3d7a70)[0xb66cfa70]\n/usr/local/bin/../lib/librustc-c84825241471686d-0.6.so(+0x3d795b)[0xb66cf95b]\n/usr/local/bin/../lib/librustc-c84825241471686d-0.6.so(+0x3da568)[0xb66d2568]\n/usr/local/bin/../lib/librustc-c84825241471686d-0.6.so(_ZN6middle11check_match8check_fn17_a9ead7a0dab8511d3_06E+0x4f)[0xb68d8eff]\n/usr/local/bin/../lib/librustc-c84825241471686d-0.6.so(+0x5e0e9e)[0xb68d8e9e]\n/usr/local/bin/../lib/librustc-c84825241471686d-0.6.so(+0x3d6aa9)[0xb66ceaa9]\n/usr/local/bin/../lib/librustc-c84825241471686d-0.6.so(+0x3d68db)[0xb66ce8db]\n/usr/local/bin/../lib/librustc-c84825241471686d-0.6.so(+0x3d6610)[0xb66ce610]\n/usr/local/bin/../lib/librustc-c84825241471686d-0.6.so(_ZN6middle11check_match11check_crate16_6c3580155784d873_06E+0x340)[0xb68d7320]\n/usr/local/bin/../lib/librustc-c84825241471686d-0.6.so(+0x88e139)[0xb6b86139]\n/usr/local/bin/../lib/librustc-c84825241471686d-0.6.so(+0x88d4d9)[0xb6b854d9]\n/usr/local/bin/../lib/librustc-c84825241471686d-0.6.so(_ZN6driver6driver12compile_rest16_3ae09542b2d302c3_06E+0x20d9)[0xb6b81739]\n/usr/local/bin/../lib/librustc-c84825241471686d-0.6.so(+0x8cd088)[0xb6bc5088]\n/usr/local/bin/../lib/librustc-c84825241471686d-0.6.so(_ZN6driver6driver12compile_upto17_633c8cc6f3f7f6e93_06E+0x103)[0xb6b86593]\n/usr/local/bin/../lib/librustc-c84825241471686d-0.6.so(_ZN6driver6driver13compile_input17_9baf8b2d9e1187833_06E+0xb6)[0xb6b86a96]\n/usr/local/bin/../lib/librustc-c84825241471686d-0.6.so(_ZN12run_compiler17_2c50e7a55977d4c63_06E+0x2444)[0xb6bb3754]\n/usr/local/bin/../lib/librustc-c84825241471686d-0.6.so(+0x8cce02)[0xb6bc4e02]\n/usr/local/bin/../lib/librustc-c84825241471686d-0.6.so(+0x8ca469)[0xb6bc2469]\n/usr/local/bin/../lib/librustc-c84825241471686d-0.6.so(+0x8c6095)[0xb6bbe095]\n/usr/local/bin/../lib/librustc-c84825241471686d-0.6.so(+0x8cd088)[0xb6bc5088]\n/usr/local/bin/../lib/libcore-c3ca5d77d81b46c1-0.6.so(+0xb644f)[0xb759f44f]\n/usr/local/bin/../lib/libcore-c3ca5d77d81b46c1-0.6.so(+0x12672c)[0xb760f72c]\n/usr/local/bin/../lib/librustrt.so(_Z18task_start_wrapperP10spawn_args+0x31)[0xb4c73c01]\nerror: internal compiler error: unexpected failure\nnote: the compiler hit an unexpected failure path. this is a bug\nnote: try running with RUST_LOG=rustc=1,::rt::backtrace to get further details and report the results to github.com/mozilla/rust/issues\nrust: task failed at 'explicit failure', /home/jeaye/projects/rust_work/rust/src/librustc/rustc.rc:359\n/usr/local/bin/../lib/librustrt.so(_ZN9rust_task13begin_failureEPKcS1_j+0x5a)[0xb4c732ba]\n/usr/local/bin/../lib/librustrt.so(rust_task_fail+0x36)[0xb4c733b6]\n/usr/local/bin/../lib/librustrt.so(_ZN9rust_task4failEPKcS1_j+0x32)[0xb4c73422]\n/usr/local/bin/../lib/librustrt.so(upcall_s_fail+0x53)[0xb4c74c03]\n/usr/local/bin/../lib/librustrt.so(+0x2914f)[0xb4c8514f]\n/usr/local/bin/../lib/librustrt.so(upcall_fail+0x174)[0xb4c75244]\n/usr/local/bin/../lib/librustrt.so(rust_upcall_fail+0x2b)[0xb4c7538b]\n/usr/local/bin/../lib/libcore-c3ca5d77d81b46c1-0.6.so(_ZN3sys6rustrt16rust_upcall_fail17_2b2e25ba94c412183_06E+0x45)[0xb75d7945]\n/usr/local/bin/../lib/libcore-c3ca5d77d81b46c1-0.6.so(+0xee9eb)[0xb75d79eb]\n/usr/local/bin/../lib/libcore-c3ca5d77d81b46c1-0.6.so(+0xee99d)[0xb75d799d]\n/usr/local/bin/../lib/libcore-c3ca5d77d81b46c1-0.6.so(_ZN3sys12begin_unwind17_7cd364c41f10422f3_06E+0x73)[0xb751fca3]\n/usr/local/bin/../lib/libcore-c3ca5d77d81b46c1-0.6.so(+0x12672c)[0xb760f72c]\n/usr/local/bin/../lib/librustc-c84825241471686d-0.6.so(_ZN7monitor16_9db0d8295229e643_06E+0x221d)[0xb6bb6add]\n/usr/local/bin/../lib/librustc-c84825241471686d-0.6.so(+0x8cd088)[0xb6bc5088]\n/usr/local/bin/../lib/librustc-c84825241471686d-0.6.so(_ZN4main16_706f4ee7413ae583_06E+0x7e)[0xb6bc4d1e]\nrustc(_rust_main+0x31)[0x80489c1]\n/usr/local/bin/../lib/librustrt.so(_Z18task_start_wrapperP10spawn_args+0x31)[0xb4c73c01]\nrust: domain main @0x98cf380 root task failed\n```\n\nSource: (troubled function: gl_err_str)\n\n``` rust\nextern mod glfw;\nextern mod opengles;\nextern mod std;\n\nuse opengles::*;\nuse opengles::gl2::{ INVALID_ENUM, INVALID_VALUE, INVALID_OPERATION, INVALID_FRAMEBUFFER_OPERATION, OUT_OF_MEMORY, STACK_UNDERFLOW, STACK_OVERFLOW };\n\nfn gl_err_str(err: u32) -> ~str\n{\n  match err\n  {\n    INVALID_ENUM => { ~\"Invalid enum\" },\n    INVALID_VALUE => { ~\"Invalid value\" },\n    INVALID_OPERATION => { ~\"Invalid operation\" },\n    INVALID_FRAMEBUFFER_OPERATION => { ~\"Invalid frame buffer operation\" },\n    OUT_OF_MEMORY => { ~\"Out of memory\" },\n    STACK_UNDERFLOW => { ~\"Stack underflow\" },\n    STACK_OVERFLOW => { ~\"Stack overflow\" },\n    _ => { ~\"Unknown error\" }\n  }\n}\n\nmacro_rules! check\n(\n  ($func:expr) => \n  ({\n    let ret = $func;\n\n    let err = gl2::get_error();\n    if err != gl2::NO_ERROR\n    { io::println(fmt!(\"GL error: %s\", gl_err_str(err))); }\n\n    ret\n  });\n)\n\nfn main() {\n  glfw::set_error_callback(error_callback);\n\n  do glfw::spawn {\n    let window = glfw::Window::create(300, 300, \"Rusty\", glfw::Windowed).unwrap();\n\n    window.set_key_callback(key_callback);\n    window.make_context_current();\n\n    check!(gl2::clear_color(1.0, 0.0, 0.0, 1.0));\n\n    while !window.should_close() {\n      glfw::poll_events();\n\n      check!(gl2::clear(gl2::COLOR_BUFFER_BIT));\n      check!(gl2::clear(-1));\n      {\n\n      } window.swap_buffers();\n\n      std::timer::sleep(@std::uv::global_loop::get(), 16);\n    }\n  }\n}\n\nfn key_callback(window: &glfw::Window, key: libc::c_int, action: libc::c_int) {\n  if action == glfw::PRESS && key == glfw::KEY_ESCAPE {\n    window.set_should_close(true);\n  }\n}\n\nfn error_callback(_error: libc::c_int, description: ~str) {\n  io::println(fmt!(\"GLFW Error: %s\", description));\n}\n```\n", "closed_by": {"login": "catamorphism", "id": 427212, "node_id": "MDQ6VXNlcjQyNzIxMg==", "avatar_url": "https://avatars.githubusercontent.com/u/427212?v=4", "gravatar_id": "", "url": "https://api.github.com/users/catamorphism", "html_url": "https://github.com/catamorphism", "followers_url": "https://api.github.com/users/catamorphism/followers", "following_url": "https://api.github.com/users/catamorphism/following{/other_user}", "gists_url": "https://api.github.com/users/catamorphism/gists{/gist_id}", "starred_url": "https://api.github.com/users/catamorphism/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/catamorphism/subscriptions", "organizations_url": "https://api.github.com/users/catamorphism/orgs", "repos_url": "https://api.github.com/users/catamorphism/repos", "events_url": "https://api.github.com/users/catamorphism/events{/privacy}", "received_events_url": "https://api.github.com/users/catamorphism/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/5353/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/5353/timeline", "performed_via_github_app": null, "state_reason": "completed"}