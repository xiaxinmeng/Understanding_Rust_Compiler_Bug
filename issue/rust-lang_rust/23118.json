{"url": "https://api.github.com/repos/rust-lang/rust/issues/23118", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/23118/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/23118/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/23118/events", "html_url": "https://github.com/rust-lang/rust/issues/23118", "id": 60106025, "node_id": "MDU6SXNzdWU2MDEwNjAyNQ==", "number": 23118, "title": "Traits can no longer be mutually dependent", "user": {"login": "apasel422", "id": 8644784, "node_id": "MDQ6VXNlcjg2NDQ3ODQ=", "avatar_url": "https://avatars.githubusercontent.com/u/8644784?v=4", "gravatar_id": "", "url": "https://api.github.com/users/apasel422", "html_url": "https://github.com/apasel422", "followers_url": "https://api.github.com/users/apasel422/followers", "following_url": "https://api.github.com/users/apasel422/following{/other_user}", "gists_url": "https://api.github.com/users/apasel422/gists{/gist_id}", "starred_url": "https://api.github.com/users/apasel422/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/apasel422/subscriptions", "organizations_url": "https://api.github.com/users/apasel422/orgs", "repos_url": "https://api.github.com/users/apasel422/repos", "events_url": "https://api.github.com/users/apasel422/events{/privacy}", "received_events_url": "https://api.github.com/users/apasel422/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 13836860, "node_id": "MDU6TGFiZWwxMzgzNjg2MA==", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-traits", "name": "A-traits", "color": "f7e101", "default": false, "description": "Area: Trait system"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2015-03-06T14:10:48Z", "updated_at": "2015-07-08T17:23:27Z", "closed_at": "2015-07-07T12:14:02Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Before #23026, it was possible to use where clauses to have traits that must be implemented together, like:\n\n``` rust\npub trait Map where Self: Lookup<Self::Key> {\n    type Key;\n    type Value;\n    fn insert(&mut self, key: Self::Key, value: Self::Value) -> Option<Self::Value>;\n}\n\npub trait Lookup<Q: ?Sized> where Self: Map {\n    fn get(&self, key: &Q) -> Option<&Self::Value>;\n}\n```\n\nThe new version (using either the newly supported supertrait syntax or where clauses) now causes a cycle error:\n\n```\nsrc/lib.rs:1:1: 5:2 error: unsupported cyclic reference between types/traits detected\nsrc/lib.rs:1 pub trait Map where Self: Lookup<<Self as Map>::Key> {\nsrc/lib.rs:2     type Key;\nsrc/lib.rs:3     type Value;\nsrc/lib.rs:4     fn insert(&mut self, key: Self::Key, value: Self::Value) -> Option<Self::Value>;\nsrc/lib.rs:5 }\nnote: the cycle begins when computing the supertraits of `Map`...\nnote: ...which then requires computing the supertraits of `Lookup`...\nnote: ...which then again requires computing the supertraits of `Map`, completing the cycle.\nsrc/lib.rs:4:31: 4:40 error: unsupported cyclic reference between types/traits detected\nsrc/lib.rs:4     fn insert(&mut self, key: Self::Key, value: Self::Value) -> Option<Self::Value>;\n                                           ^~~~~~~~~\nnote: the cycle begins when computing the supertraits of `Lookup`...\nnote: ...which then requires computing the supertraits of `Map`...\nnote: ...which then again requires computing the supertraits of `Lookup`, completing the cycle.\nsrc/lib.rs:4:49: 4:60 error: unsupported cyclic reference between types/traits detected\nsrc/lib.rs:4     fn insert(&mut self, key: Self::Key, value: Self::Value) -> Option<Self::Value>;\n                                                             ^~~~~~~~~~~\nnote: the cycle begins when computing the supertraits of `Lookup`...\nnote: ...which then requires computing the supertraits of `Map`...\nnote: ...which then again requires computing the supertraits of `Lookup`, completing the cycle.\nsrc/lib.rs:4:72: 4:83 error: unsupported cyclic reference between types/traits detected\nsrc/lib.rs:4     fn insert(&mut self, key: Self::Key, value: Self::Value) -> Option<Self::Value>;\n                                                                                    ^~~~~~~~~~~\nnote: the cycle begins when computing the supertraits of `Lookup`...\nnote: ...which then requires computing the supertraits of `Map`...\nnote: ...which then again requires computing the supertraits of `Lookup`, completing the cycle.\nsrc/lib.rs:7:1: 9:2 error: unsupported cyclic reference between types/traits detected\nsrc/lib.rs:7 pub trait Lookup<Q: ?Sized> where Self: Map {\nsrc/lib.rs:8     fn get(&self, key: &Q) -> Option<&Self::Value>;\nsrc/lib.rs:9 }\nnote: the cycle begins when computing the supertraits of `Lookup`...\nnote: ...which then requires computing the supertraits of `Map`...\nnote: ...which then again requires computing the supertraits of `Lookup`, completing the cycle.\nsrc/lib.rs:8:39: 8:50 error: unsupported cyclic reference between types/traits detected\nsrc/lib.rs:8     fn get(&self, key: &Q) -> Option<&Self::Value>;\n                                                   ^~~~~~~~~~~\nnote: the cycle begins when computing the supertraits of `Map`...\nnote: ...which then requires computing the supertraits of `Lookup`...\nnote: ...which then again requires computing the supertraits of `Map`, completing the cycle.\n```\n\nThis is expected, based on @nikomatsakis's comment in the PR:\n\n> This is technically a [breaking-change] because it affects the definition of a super-trait. Anything in a where clause that looks like where Self : Foo is now considered a supertrait. Because cycles are disallowed in supertraits, that could lead to some errors. This has not been observed in any existing code.\n\nHowever, this seems like a useful pattern.\n", "closed_by": {"login": "arielb1", "id": 1830974, "node_id": "MDQ6VXNlcjE4MzA5NzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1830974?v=4", "gravatar_id": "", "url": "https://api.github.com/users/arielb1", "html_url": "https://github.com/arielb1", "followers_url": "https://api.github.com/users/arielb1/followers", "following_url": "https://api.github.com/users/arielb1/following{/other_user}", "gists_url": "https://api.github.com/users/arielb1/gists{/gist_id}", "starred_url": "https://api.github.com/users/arielb1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/arielb1/subscriptions", "organizations_url": "https://api.github.com/users/arielb1/orgs", "repos_url": "https://api.github.com/users/arielb1/repos", "events_url": "https://api.github.com/users/arielb1/events{/privacy}", "received_events_url": "https://api.github.com/users/arielb1/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/23118/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/23118/timeline", "performed_via_github_app": null, "state_reason": "completed"}