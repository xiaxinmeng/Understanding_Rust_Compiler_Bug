{"url": "https://api.github.com/repos/rust-lang/rust/issues/17022", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/17022/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/17022/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/17022/events", "html_url": "https://github.com/rust-lang/rust/issues/17022", "id": 42048652, "node_id": "MDU6SXNzdWU0MjA0ODY1Mg==", "number": 17022, "title": "A 'top-level' scope in a macro in item position unintuitively ignores everything", "user": {"login": "huonw", "id": 1203825, "node_id": "MDQ6VXNlcjEyMDM4MjU=", "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4", "gravatar_id": "", "url": "https://api.github.com/users/huonw", "html_url": "https://github.com/huonw", "followers_url": "https://api.github.com/users/huonw/followers", "following_url": "https://api.github.com/users/huonw/following{/other_user}", "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}", "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/huonw/subscriptions", "organizations_url": "https://api.github.com/users/huonw/orgs", "repos_url": "https://api.github.com/users/huonw/repos", "events_url": "https://api.github.com/users/huonw/events{/privacy}", "received_events_url": "https://api.github.com/users/huonw/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 234902, "node_id": "MDU6TGFiZWwyMzQ5MDI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-enhancement", "name": "C-enhancement", "color": "f5f1fd", "default": false, "description": "Category: An issue proposing an enhancement or a PR with one."}, {"id": 235791, "node_id": "MDU6TGFiZWwyMzU3OTE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-diagnostics", "name": "A-diagnostics", "color": "f7e101", "default": false, "description": "Area: Messages for errors, warnings, and lints"}, {"id": 132910982, "node_id": "MDU6TGFiZWwxMzI5MTA5ODI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-macros", "name": "A-macros", "color": "f7e101", "default": false, "description": "Area: All kinds of macros (custom derive, macro_rules!, proc macros, ..)"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2014-09-05T13:55:45Z", "updated_at": "2022-08-11T13:56:40Z", "closed_at": null, "author_association": "MEMBER", "active_lock_reason": null, "body": "``` rust\n#![feature(macro_rules)]\n\nmacro_rules! x {\n    () => {{\n        struct Foo;\n    }}\n}\n\nx!()\n```\n\n```\n<anon>:4:12: 4:13 error: macro expansion ignores token `{` and any following\n<anon>:4     () => {{\n                    ^\n```\n\ni.e. the parser is seeing the `{` and bailing on parsing an item, and the macro expander is diligently reporting that those tokens were ignored. It would be better if we could emit a more helpful message for this case specifically, since expression macros require the `{`s to be able to contain multiple things so users used to this can get tripped up (item macros don't need scopes for multiple items, and doing this would restrict those items to that inner scope anyway).\n", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/17022/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/17022/timeline", "performed_via_github_app": null, "state_reason": null}