{"url": "https://api.github.com/repos/rust-lang/rust/issues/39365", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/39365/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/39365/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/39365/events", "html_url": "https://github.com/rust-lang/rust/issues/39365", "id": 203814401, "node_id": "MDU6SXNzdWUyMDM4MTQ0MDE=", "number": 39365, "title": "Add new io::ErrorKind - BufTooSmall and use it in Read::read_to_end", "user": {"login": "Mingun", "id": 450131, "node_id": "MDQ6VXNlcjQ1MDEzMQ==", "avatar_url": "https://avatars.githubusercontent.com/u/450131?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mingun", "html_url": "https://github.com/Mingun", "followers_url": "https://api.github.com/users/Mingun/followers", "following_url": "https://api.github.com/users/Mingun/following{/other_user}", "gists_url": "https://api.github.com/users/Mingun/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mingun/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mingun/subscriptions", "organizations_url": "https://api.github.com/users/Mingun/orgs", "repos_url": "https://api.github.com/users/Mingun/repos", "events_url": "https://api.github.com/users/Mingun/events{/privacy}", "received_events_url": "https://api.github.com/users/Mingun/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2017-01-28T15:59:24Z", "updated_at": "2017-05-20T03:08:06Z", "closed_at": "2017-05-20T03:08:06Z", "author_association": "NONE", "active_lock_reason": null, "body": "I work on binding to Oracle Call Interface for Rust and faced a problem in case of implementation of reading contents of CLOB. Functions of Oracle for reading CLOB accept the buffer in which to read data on an input and return a count of readed bytes and a sign of whether there are still data for reading. At the same time data are read character-by-character -- i.e. if in the encoding utf-8 the character occupies more than one byte, then either `N` bytes, or `0` will be read.\r\n\r\nIt is natural that for the interface of reading CLOB there is a wish to provide standard Rust interface for data reading -- [`io::Read`][read]. However it means that all methods of [`io::Read`][read] shall work, as expected, in particular, [read_to_end][read_to_end] shall read all data of CLOB.\r\n\r\nHowever he isn't always capable to make it as in the course of reading the buffer for reading can be reduced to such nonzero value that Oracle won't begin to read in it the character and will return value tuple `(0 bytes are read, still there are data)`. In this case it is necessary to increase the size of the buffer and to try to read once again. That it became possible, I suggest to introduce the new [`ErrorKind`][error] code -- `BufTooSmall` (this is also counterpart of `WriteZero` for read operations) and in case of its return to process this case also when in the buffer there is no place left -- increase buffer.\r\n\r\n[read]: https://doc.rust-lang.org/std/io/trait.Read.html\r\n[read_to_end]: https://github.com/rust-lang/rust/blob/master/src/libstd/io/mod.rs#L344-L373\r\n[error]: https://doc.rust-lang.org/std/io/enum.ErrorKind.html", "closed_by": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/39365/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/39365/timeline", "performed_via_github_app": null, "state_reason": "completed"}