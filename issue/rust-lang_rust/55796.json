{"url": "https://api.github.com/repos/rust-lang/rust/issues/55796", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/55796/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/55796/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/55796/events", "html_url": "https://github.com/rust-lang/rust/issues/55796", "id": 378928390, "node_id": "MDU6SXNzdWUzNzg5MjgzOTA=", "number": 55796, "title": "ICE in compute_type_of_item", "user": {"login": "jneem", "id": 1448113, "node_id": "MDQ6VXNlcjE0NDgxMTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1448113?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jneem", "html_url": "https://github.com/jneem", "followers_url": "https://api.github.com/users/jneem/followers", "following_url": "https://api.github.com/users/jneem/following{/other_user}", "gists_url": "https://api.github.com/users/jneem/gists{/gist_id}", "starred_url": "https://api.github.com/users/jneem/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jneem/subscriptions", "organizations_url": "https://api.github.com/users/jneem/orgs", "repos_url": "https://api.github.com/users/jneem/repos", "events_url": "https://api.github.com/users/jneem/events{/privacy}", "received_events_url": "https://api.github.com/users/jneem/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 37544, "node_id": "MDU6TGFiZWwzNzU0NA==", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-typesystem", "name": "A-typesystem", "color": "f7e101", "default": false, "description": "Area: The type system"}, {"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}, {"id": 262252840, "node_id": "MDU6TGFiZWwyNjIyNTI4NDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/regression-from-stable-to-stable", "name": "regression-from-stable-to-stable", "color": "e4008a", "default": false, "description": "Performance or correctness regression from one stable version to another."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-11-08T21:40:55Z", "updated_at": "2018-11-11T09:07:52Z", "closed_at": "2018-11-11T09:07:52Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "The following two trait definitions cause an ICE in current nightly, beta, and stable.\r\n\r\n```rust\r\npub trait EdgeTrait<N> {\r\n    fn target(&self) -> N;\r\n}\r\n\r\npub trait Graph<'a> {\r\n    type Node;\r\n    type Edge: EdgeTrait<Self::Node>;\r\n    type NodesIter: Iterator<Item = Self::Node> + 'a;\r\n    type EdgesIter: Iterator<Item = Self::Edge> + 'a;\r\n\r\n    fn nodes(&'a self) -> Self::NodesIter;\r\n    fn out_edges(&'a self, u: &Self::Node) -> Self::EdgesIter;\r\n    fn in_edges(&'a self, u: &Self::Node) -> Self::EdgesIter;\r\n\r\n    fn out_neighbors(&'a self, u: &Self::Node) -> Box<Iterator<Item = Self::Node>> {\r\n        Box::new(self.out_edges(u).map(|e| e.target()))\r\n    }\r\n\r\n    fn in_neighbors(&'a self, u: &Self::Node) -> Box<Iterator<Item = Self::Node>> {\r\n        Box::new(self.in_edges(u).map(|e| e.target()))\r\n    }\r\n}\r\n```\r\n\r\nThe error is:\r\n```\r\nerror: internal compiler error: librustc_typeck/collect.rs:1202: compute_type_of_item: unexpected item type: Trait(No, Normal, Generics { params: [GenericParam { id: NodeId(15), name: Plain('a#0), attrs: [], bounds: [], span: src/lib.rs:5:17: 5:19, pure_wrt_drop: false, kind: Lifetime { kind: Explicit } }], where_clause: WhereClause { id: NodeId(16), predicates: [] }, span: src/lib.rs:5:16: 5:20 }, [], [TraitItemRef { id: TraitItemId { node_id: NodeId(17) }, ident: Node#0, kind: Type, span: src/lib.rs:6:5: 6:15, defaultness: Default { has_value: false } }, TraitItemRef { id: TraitItemId { node_id: NodeId(19) }, ident: Edge#0, kind: Type, span: src/lib.rs:7:5: 7:38, defaultness: Default { has_value: false } }, TraitItemRef { id: TraitItemId { node_id: NodeId(23) }, ident: NodesIter#0, kind: Type, span: src/lib.rs:8:5: 8:54, defaultness: Default { has_value: false } }, TraitItemRef { id: TraitItemId { node_id: NodeId(29) }, ident: EdgesIter#0, kind: Type, span: src/lib.rs:9:5: 9:54, defaultness: Default { has_value: false } }, TraitItemRef { id: TraitItemId { node_id: NodeId(35) }, ident: nodes#0, kind: Method { has_self: true }, span: src/lib.rs:11:5: 11:43, defaultness: Default { has_value: false } }, TraitItemRef { id: TraitItemId { node_id: NodeId(43) }, ident: out_edges#0, kind: Method { has_self: true }, span: src/lib.rs:12:5: 12:63, defaultness: Default { has_value: false } }, TraitItemRef { id: TraitItemId { node_id: NodeId(55) }, ident: in_edges#0, kind: Method { has_self: true }, span: src/lib.rs:13:5: 13:62, defaultness: Default { has_value: false } }, TraitItemRef { id: TraitItemId { node_id: NodeId(67) }, ident: out_neighbors#0, kind: Method { has_self: true }, span: src/lib.rs:15:5: 17:6, defaultness: Default { has_value: true } }, TraitItemRef { id: TraitItemId { node_id: NodeId(95) }, ident: in_neighbors#0, kind: Method { has_self: true }, span: src/lib.rs:19:5: 21:6, defaultness: Default { has_value: true } }])\r\n  --> src/lib.rs:5:1\r\n   |\r\n5  | / pub trait Graph<'a> {\r\n6  | |     type Node;\r\n7  | |     type Edge: EdgeTrait<Self::Node>;\r\n8  | |     type NodesIter: Iterator<Item = Self::Node> + 'a;\r\n...  |\r\n21 | |     }\r\n22 | | }\r\n   | |_^\r\n\r\nthread 'main' panicked at 'Box<Any>', librustc_errors/lib.rs:538:9\r\nnote: Run with `RUST_BACKTRACE=1` for a backtrace.\r\n```\r\n\r\nHere is a playground link demonstrating the issue: https://play.rust-lang.org/?version=beta&mode=debug&edition=2015&gist=ff49511ceb983c9d173452b455b574f8", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/55796/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/55796/timeline", "performed_via_github_app": null, "state_reason": "completed"}