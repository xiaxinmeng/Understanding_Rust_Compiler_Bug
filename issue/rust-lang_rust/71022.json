{"url": "https://api.github.com/repos/rust-lang/rust/issues/71022", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/71022/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/71022/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/71022/events", "html_url": "https://github.com/rust-lang/rust/issues/71022", "id": 598253744, "node_id": "MDU6SXNzdWU1OTgyNTM3NDQ=", "number": 71022, "title": "Please stop using non-declarative opaque build \"scripts\" and stop infecting other emerging programming languages", "user": {"login": "safinaskar", "id": 859494, "node_id": "MDQ6VXNlcjg1OTQ5NA==", "avatar_url": "https://avatars.githubusercontent.com/u/859494?v=4", "gravatar_id": "", "url": "https://api.github.com/users/safinaskar", "html_url": "https://github.com/safinaskar", "followers_url": "https://api.github.com/users/safinaskar/followers", "following_url": "https://api.github.com/users/safinaskar/following{/other_user}", "gists_url": "https://api.github.com/users/safinaskar/gists{/gist_id}", "starred_url": "https://api.github.com/users/safinaskar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/safinaskar/subscriptions", "organizations_url": "https://api.github.com/users/safinaskar/orgs", "repos_url": "https://api.github.com/users/safinaskar/repos", "events_url": "https://api.github.com/users/safinaskar/events{/privacy}", "received_events_url": "https://api.github.com/users/safinaskar/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-04-11T12:12:52Z", "updated_at": "2020-04-11T12:26:14Z", "closed_at": "2020-04-11T12:18:22Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "As well as I understand current recommended practice for building is using so-called build \"scripts\" for all complex cases (code generation etc): https://doc.rust-lang.org/cargo/reference/build-scripts.html .\r\n\r\nBuild \"scripts\" are very big design bug. There is well known IT principle: everything that can be made declarative, should be declarative. I will give some links and quotes to prove my point.\r\n\r\nFirst (emphasis is mine):\r\n> TeX. A crippled everything-is-a-text-transformation VM. A great back-end with a nightmarish front-end, as far as I can tell. You get neither WYSIWYG **nor the ability to mechanically analyze the content** (the document is basically code which transforms itself, and transforms itself, and transforms itself, and you can't make any sense of the document without, um, **running it**). But people do unimaginably hairy things on top of TeX, like LaTeX. You actually have to debug LaTeX documents, and I bet that the best TeX debugger is somewhat worse than the worst C debugger out there\r\n\r\nThe quote is from http://yosefk.com/blog/fun-at-the-turing-tar-pit.html (Yossi Kreinin is author of well-known C++ FQA http://yosefk.com/c++fqa/index.html ) and I think this article doesn't contain other information relevant to the topic.\r\n\r\nNow the next link: https://yosefk.com/blog/code-data-and-interactive-programming.html . Relevant part is from beginning to words \"for many purposes, you can't really \"understand\" what you've parsed without running it, and this is common to all Turing-complete languages\".\r\n\r\nThe next link: https://www.w3.org/DesignIssues/Principles.html from Tim Berners-Lee, creator of World Wide Web, section \"Principle of Least Power\".\r\n\r\nAll this especially applies to build configs/scripts, because build configs are simple, compared to big full-featured programs. They can be made declarative, and thus must be made declarative. Various tools such as IDEs should be able to read and understand build configs.\r\n\r\nCurrently build \"scripts\" are written in Rust, so one should compile and run them to extract info. This means that, say, some online service which wants to draw some pretty diagram to user (which will describe build graph of some Rust package) should compile and run this build \"script\". This means that Rust compiler should be installed on this Web server machine. Also this means that this system is hard to make secure in event of malicious build scripts.\r\n\r\nSo here is my proposal: move as much as possible from build \"scripts\" to your TOML manifest. Write everything in declarative form. As a last measure resort to executable build \"scripts\".\r\n\r\nEven makefiles are better then your build \"scripts\". Because they usually conveys to us graph of dependencies without the need to run untrusted arbitrary commands or code.\r\n\r\nEven worse you infected other hobby programming languages!!! Today I learned that Zig programming language ( https://ziglang.org/ ) uses something very similar to your build \"scripts\": https://ziglang.org/#Zig-Build-System . I think Zig authors get this idea from Rust.\r\n\r\nSo, please stop using non-declarative \"scripts\" or at least avoid them as much as possible. Or at least say clearly in the docs that this is bad design decision and creators of new languages should not take it to their languages", "closed_by": {"login": "jonas-schievink", "id": 1786438, "node_id": "MDQ6VXNlcjE3ODY0Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/1786438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jonas-schievink", "html_url": "https://github.com/jonas-schievink", "followers_url": "https://api.github.com/users/jonas-schievink/followers", "following_url": "https://api.github.com/users/jonas-schievink/following{/other_user}", "gists_url": "https://api.github.com/users/jonas-schievink/gists{/gist_id}", "starred_url": "https://api.github.com/users/jonas-schievink/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jonas-schievink/subscriptions", "organizations_url": "https://api.github.com/users/jonas-schievink/orgs", "repos_url": "https://api.github.com/users/jonas-schievink/repos", "events_url": "https://api.github.com/users/jonas-schievink/events{/privacy}", "received_events_url": "https://api.github.com/users/jonas-schievink/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/71022/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 1, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/71022/timeline", "performed_via_github_app": null, "state_reason": "completed"}