{"url": "https://api.github.com/repos/rust-lang/rust/issues/68934", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/68934/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/68934/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/68934/events", "html_url": "https://github.com/rust-lang/rust/issues/68934", "id": 561748612, "node_id": "MDU6SXNzdWU1NjE3NDg2MTI=", "number": 68934, "title": "Borrow scope for pattern matches - again", "user": {"login": "axos88", "id": 1281218, "node_id": "MDQ6VXNlcjEyODEyMTg=", "avatar_url": "https://avatars.githubusercontent.com/u/1281218?v=4", "gravatar_id": "", "url": "https://api.github.com/users/axos88", "html_url": "https://github.com/axos88", "followers_url": "https://api.github.com/users/axos88/followers", "following_url": "https://api.github.com/users/axos88/following{/other_user}", "gists_url": "https://api.github.com/users/axos88/gists{/gist_id}", "starred_url": "https://api.github.com/users/axos88/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/axos88/subscriptions", "organizations_url": "https://api.github.com/users/axos88/orgs", "repos_url": "https://api.github.com/users/axos88/repos", "events_url": "https://api.github.com/users/axos88/events{/privacy}", "received_events_url": "https://api.github.com/users/axos88/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1146616045, "node_id": "MDU6TGFiZWwxMTQ2NjE2MDQ1", "url": "https://api.github.com/repos/rust-lang/rust/labels/NLL-polonius", "name": "NLL-polonius", "color": "f799ea", "default": false, "description": "Issues related for using Polonius in the borrow checker"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-02-07T16:40:03Z", "updated_at": "2020-02-07T17:08:58Z", "closed_at": null, "author_association": "NONE", "active_lock_reason": null, "body": "This issue seems to be similar to [this one](https://stackoverflow.com/questions/23328702/rust-cannot-move-out-of-self-because-it-is-borrowed-error), but the referenced issue #6379, does not solve it:\r\n\r\n[playground](https://play.rust-lang.org/?version=stable&mode=debug&edition=2018&gist=a80be0555b914552ed2071ebbf642610)\r\n\r\n\r\n```\r\nenum Either<A,B> {\r\n    Left(A),\r\n    Right(B)\r\n}\r\n\r\nenum Tree<'a, A, B> {\r\n    ALeaf(A),\r\n    BLeaf(B),\r\n    ABranch(&'a mut Tree<'a, A, B>, A),\r\n    BBranch(&'a mut Tree<'a, A, B>, B)\r\n}\r\n\r\nimpl<'a, A: PartialOrd, B> Tree<'a, A ,B> {\r\n    fn deep_fetch(&mut self, value: Either<A, B>) -> Result<&mut Self, (&mut Self, Either<A,B>)> {\r\n        match (self, value) {\r\n            (Tree::ABranch(ref mut a, ref v), Either::Left(vv)) if v > &vv => {\r\n                a.deep_fetch(Either::Left(vv))\r\n            }\r\n\r\n            (this, _v) => Err((this, _v))\r\n        }\r\n    }\r\n}\r\n```\r\n\r\n```\r\n Compiling playground v0.0.1 (/playground)\r\nerror[E0505]: cannot move out of `_` because it is borrowed\r\n  --> src/lib.rs:20:14\r\n   |\r\n14 |     fn deep_fetch(&mut self, value: Either<A, B>) -> Result<&mut Self, (&mut Self, Either<A,B>)> {\r\n   |                   - let's call the lifetime of this reference `'1`\r\n15 |         match (&mut *self, value) {\r\n16 |             (Tree::ABranch(ref mut a, ref v), Either::Left(vv)) if v > &vv => {\r\n   |                            --------- borrow of value occurs here\r\n17 |                 a.deep_fetch(Either::Left(vv))\r\n   |                 ------------------------------ returning this value requires that borrow lasts for `'1`\r\n...\r\n20 |             (this, _v) => Err((this, _v))\r\n   |              ^^^^ move out of value occurs here\r\n\r\nerror: aborting due to previous error\r\n\r\nFor more information about this error, try `rustc --explain E0505`.\r\nerror: could not compile `playground`.\r\n\r\nTo learn more, run the command again with --verbose.\r\n\r\n```", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/68934/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/68934/timeline", "performed_via_github_app": null, "state_reason": null}