{"url": "https://api.github.com/repos/rust-lang/rust/issues/102897", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/102897/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/102897/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/102897/events", "html_url": "https://github.com/rust-lang/rust/issues/102897", "id": 1403620416, "node_id": "I_kwDOAAsO6M5TqYxA", "number": 102897, "title": "building rust breaks on older kernels < 3.17, due to syscall_318 (getrandom)", "user": {"login": "bsferrazza", "id": 12578948, "node_id": "MDQ6VXNlcjEyNTc4OTQ4", "avatar_url": "https://avatars.githubusercontent.com/u/12578948?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bsferrazza", "html_url": "https://github.com/bsferrazza", "followers_url": "https://api.github.com/users/bsferrazza/followers", "following_url": "https://api.github.com/users/bsferrazza/following{/other_user}", "gists_url": "https://api.github.com/users/bsferrazza/gists{/gist_id}", "starred_url": "https://api.github.com/users/bsferrazza/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bsferrazza/subscriptions", "organizations_url": "https://api.github.com/users/bsferrazza/orgs", "repos_url": "https://api.github.com/users/bsferrazza/repos", "events_url": "https://api.github.com/users/bsferrazza/events{/privacy}", "received_events_url": "https://api.github.com/users/bsferrazza/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 2413861294, "node_id": "MDU6TGFiZWwyNDEzODYxMjk0", "url": "https://api.github.com/repos/rust-lang/rust/labels/regression-untriaged", "name": "regression-untriaged", "color": "e4008a", "default": false, "description": "Untriaged performance or correctness regression."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 19, "created_at": "2022-10-10T19:31:57Z", "updated_at": "2023-01-06T11:57:08Z", "closed_at": "2022-10-11T02:37:55Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am using a host machine that is on RHEL7 and kernel 3.10. This means it does not support the later versions of rust, which makes use of syscall_318 (sys_getrandom) that is only supported by kernels >= 3.17.\r\n\r\nIt's not clear when this syscall was introduced to rustc, but it seems that it's undocumented that it would break on kernels < 3.17. This results in an infinite loop calling syscall_318 when trying to build core v0.0.0 using the bootstrapped stage0 rustc.\r\n\r\nUPDATE: the text below is from the original post but is not accurate\r\n\r\nThe problem is, when trying to build rust from source, the bootstrapped stage0 rustc that is downloaded is the beta version, containing these unsupported syscalls. This is true even when using an older, supported rust tarball, like 1.63.0.\r\n\r\nHow does one use a different bootstrapped stage0 rustc than the beta?\r\n\r\nIdeally the build process would automatically identify the host's kernel version and download an appropriate stage0 compiler that is supported.", "closed_by": {"login": "bsferrazza", "id": 12578948, "node_id": "MDQ6VXNlcjEyNTc4OTQ4", "avatar_url": "https://avatars.githubusercontent.com/u/12578948?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bsferrazza", "html_url": "https://github.com/bsferrazza", "followers_url": "https://api.github.com/users/bsferrazza/followers", "following_url": "https://api.github.com/users/bsferrazza/following{/other_user}", "gists_url": "https://api.github.com/users/bsferrazza/gists{/gist_id}", "starred_url": "https://api.github.com/users/bsferrazza/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bsferrazza/subscriptions", "organizations_url": "https://api.github.com/users/bsferrazza/orgs", "repos_url": "https://api.github.com/users/bsferrazza/repos", "events_url": "https://api.github.com/users/bsferrazza/events{/privacy}", "received_events_url": "https://api.github.com/users/bsferrazza/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/102897/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/102897/timeline", "performed_via_github_app": null, "state_reason": "completed"}