{"url": "https://api.github.com/repos/rust-lang/rust/issues/40574", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/40574/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/40574/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/40574/events", "html_url": "https://github.com/rust-lang/rust/issues/40574", "id": 214731594, "node_id": "MDU6SXNzdWUyMTQ3MzE1OTQ=", "number": 40574, "title": "Unable to see derive attributes anymore", "user": {"login": "vityafx", "id": 1146369, "node_id": "MDQ6VXNlcjExNDYzNjk=", "avatar_url": "https://avatars.githubusercontent.com/u/1146369?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vityafx", "html_url": "https://github.com/vityafx", "followers_url": "https://api.github.com/users/vityafx/followers", "following_url": "https://api.github.com/users/vityafx/following{/other_user}", "gists_url": "https://api.github.com/users/vityafx/gists{/gist_id}", "starred_url": "https://api.github.com/users/vityafx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vityafx/subscriptions", "organizations_url": "https://api.github.com/users/vityafx/orgs", "repos_url": "https://api.github.com/users/vityafx/repos", "events_url": "https://api.github.com/users/vityafx/events{/privacy}", "received_events_url": "https://api.github.com/users/vityafx/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "jseyfried", "id": 8652869, "node_id": "MDQ6VXNlcjg2NTI4Njk=", "avatar_url": "https://avatars.githubusercontent.com/u/8652869?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jseyfried", "html_url": "https://github.com/jseyfried", "followers_url": "https://api.github.com/users/jseyfried/followers", "following_url": "https://api.github.com/users/jseyfried/following{/other_user}", "gists_url": "https://api.github.com/users/jseyfried/gists{/gist_id}", "starred_url": "https://api.github.com/users/jseyfried/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jseyfried/subscriptions", "organizations_url": "https://api.github.com/users/jseyfried/orgs", "repos_url": "https://api.github.com/users/jseyfried/repos", "events_url": "https://api.github.com/users/jseyfried/events{/privacy}", "received_events_url": "https://api.github.com/users/jseyfried/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jseyfried", "id": 8652869, "node_id": "MDQ6VXNlcjg2NTI4Njk=", "avatar_url": "https://avatars.githubusercontent.com/u/8652869?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jseyfried", "html_url": "https://github.com/jseyfried", "followers_url": "https://api.github.com/users/jseyfried/followers", "following_url": "https://api.github.com/users/jseyfried/following{/other_user}", "gists_url": "https://api.github.com/users/jseyfried/gists{/gist_id}", "starred_url": "https://api.github.com/users/jseyfried/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jseyfried/subscriptions", "organizations_url": "https://api.github.com/users/jseyfried/orgs", "repos_url": "https://api.github.com/users/jseyfried/repos", "events_url": "https://api.github.com/users/jseyfried/events{/privacy}", "received_events_url": "https://api.github.com/users/jseyfried/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 9, "created_at": "2017-03-16T14:54:38Z", "updated_at": "2017-03-17T10:37:34Z", "closed_at": "2017-03-17T10:32:39Z", "author_association": "NONE", "active_lock_reason": null, "body": "I have made a procedural macro which implements a trait with some functions for a enums. This the whole code:\r\n\r\n\r\n```rust\r\n#[proc_macro_derive(StateMachine, attributes(state_transitions))]\r\npub fn fxsm(input: TokenStream) -> TokenStream {\r\n    // Construct a string representation of the type definition\r\n    let s = input.to_string();\r\n\r\n    // Parse the string representation\r\n    let ast = syn::parse_derive_input(&s).unwrap();\r\n\r\n    // Build the impl\r\n    let gen = impl_fsm(&ast);\r\n\r\n    // Return the generated impl\r\n    gen.parse().unwrap()\r\n}\r\n\r\nfn impl_fsm(ast: &syn::DeriveInput) -> Tokens {\r\n    if let syn::Body::Enum(ref variants) = ast.body {\r\n        if let Some(ref a) = ast.attrs.iter().find(|a| a.name() == \"derive\") {\r\n            if let syn::MetaItem::List(_, ref nested) = a.value {\r\n                if derives(nested, \"Copy\") {\r\n                    return gen_for_copyable(&ast.ident,\r\n                                            &variants,\r\n                                            &ast.generics);\r\n                } else if derives(nested, \"Clone\") {\r\n                    return gen_for_clonable(&ast.ident,\r\n                                            &variants,\r\n                                            &ast.generics);\r\n                } else {\r\n                    panic!(\"Unable to produce State Machine code on a enum which does not drive Copy nor Clone traits.\");\r\n                }\r\n            } else {\r\n                panic!(\"Unable to produce State Machine code on a enum which does not drive Copy nor Clone traits.\");\r\n            }\r\n        } else {\r\n            panic!(\"How were you able to call me without derive!?!?\");\r\n        }\r\n    } else {\r\n        panic!(\"State Machine must be derived on a enum.\");\r\n    }\r\n}\r\n```\r\n\r\nThis code worked perfectly like 2 weeks ago but now I have tried to compile it and it can't find any attribute on this struct! As you can see, I try to see what derives does the enum have but now this list is empty! What happened?\r\n\r\nOriginal issue was posted [here](https://github.com/dtolnay/syn/issues/108)\r\n@dtolnay told that is was changed [here](https://github.com/rust-lang/rust/pull/39572)\r\n\r\nSo how do I fix this?", "closed_by": {"login": "vityafx", "id": 1146369, "node_id": "MDQ6VXNlcjExNDYzNjk=", "avatar_url": "https://avatars.githubusercontent.com/u/1146369?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vityafx", "html_url": "https://github.com/vityafx", "followers_url": "https://api.github.com/users/vityafx/followers", "following_url": "https://api.github.com/users/vityafx/following{/other_user}", "gists_url": "https://api.github.com/users/vityafx/gists{/gist_id}", "starred_url": "https://api.github.com/users/vityafx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vityafx/subscriptions", "organizations_url": "https://api.github.com/users/vityafx/orgs", "repos_url": "https://api.github.com/users/vityafx/repos", "events_url": "https://api.github.com/users/vityafx/events{/privacy}", "received_events_url": "https://api.github.com/users/vityafx/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/40574/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/40574/timeline", "performed_via_github_app": null, "state_reason": "completed"}