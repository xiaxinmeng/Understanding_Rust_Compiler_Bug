{"url": "https://api.github.com/repos/rust-lang/rust/issues/70933", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/70933/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/70933/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/70933/events", "html_url": "https://github.com/rust-lang/rust/issues/70933", "id": 596795319, "node_id": "MDU6SXNzdWU1OTY3OTUzMTk=", "number": 70933, "title": "On error due to reference introduced by default binding modes, point out where reference was introduced", "user": {"login": "CAD97", "id": 5992217, "node_id": "MDQ6VXNlcjU5OTIyMTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5992217?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CAD97", "html_url": "https://github.com/CAD97", "followers_url": "https://api.github.com/users/CAD97/followers", "following_url": "https://api.github.com/users/CAD97/following{/other_user}", "gists_url": "https://api.github.com/users/CAD97/gists{/gist_id}", "starred_url": "https://api.github.com/users/CAD97/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CAD97/subscriptions", "organizations_url": "https://api.github.com/users/CAD97/orgs", "repos_url": "https://api.github.com/users/CAD97/repos", "events_url": "https://api.github.com/users/CAD97/events{/privacy}", "received_events_url": "https://api.github.com/users/CAD97/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 234902, "node_id": "MDU6TGFiZWwyMzQ5MDI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-enhancement", "name": "C-enhancement", "color": "f5f1fd", "default": false, "description": "Category: An issue proposing an enhancement or a PR with one."}, {"id": 235791, "node_id": "MDU6TGFiZWwyMzU3OTE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-diagnostics", "name": "A-diagnostics", "color": "f7e101", "default": false, "description": "Area: Messages for errors, warnings, and lints"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-04-08T19:08:37Z", "updated_at": "2020-04-08T19:39:13Z", "closed_at": "2020-04-08T19:39:12Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Simple example:\r\n\r\n```rust\r\nfn example(x: &Option<S>) {\r\n    match x {\r\n        Some(val) => drop::<S>(val),\r\n        None => (),\r\n    }\r\n}\r\n```\r\n\r\n```\r\nerror[E0308]: mismatched types\r\n --> src/lib.rs:6:32\r\n  |\r\n6 |         Some(val) => drop::<S>(val),\r\n  |         ^^^^^^^^^              ^^^\r\n  |         |                      |\r\n  |         |                      expected struct `S`, found `&S`\r\n  |         |                      help: consider dereferencing the borrow: `*val`\r\n  |         note: borrow introduced here because pattern has type `&std::option::Option<crate::S>`\r\n  |         help: consider destructuring the borrow here: `&Some(val)`\r\n```\r\n\r\n(plus if/when `Some(&val)` works to destrucure the borrow, suggest that instead)\r\n\r\n[Initially suggested on irlo](https://internals.rust-lang.org/t/is-ref-more-powerful-than-match-ergonomics/12111/28?u=cad97), cc @joshtriplett @rpjohnst \r\n\r\nThis should help remove some of the pain points people have had around default binding modes (\"match ergonomics\") introducing needless borrows, as the error message now also points at the pattern, like it did before default binding modes were introduced.\r\n\r\n(As a side note: a (clippy) lint for binding a `Copy` value by reference that could be bound by copy would also help here, independently of improving the error message.)\r\n\r\n@rustbot modify labels: +A-diagnostics", "closed_by": {"login": "Centril", "id": 855702, "node_id": "MDQ6VXNlcjg1NTcwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Centril", "html_url": "https://github.com/Centril", "followers_url": "https://api.github.com/users/Centril/followers", "following_url": "https://api.github.com/users/Centril/following{/other_user}", "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Centril/subscriptions", "organizations_url": "https://api.github.com/users/Centril/orgs", "repos_url": "https://api.github.com/users/Centril/repos", "events_url": "https://api.github.com/users/Centril/events{/privacy}", "received_events_url": "https://api.github.com/users/Centril/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/70933/reactions", "total_count": 3, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 1, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/70933/timeline", "performed_via_github_app": null, "state_reason": "completed"}