{"url": "https://api.github.com/repos/rust-lang/rust/issues/43311", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/43311/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/43311/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/43311/events", "html_url": "https://github.com/rust-lang/rust/issues/43311", "id": 243707628, "node_id": "MDU6SXNzdWUyNDM3MDc2Mjg=", "number": 43311, "title": "NulError when using rustc with external llvm", "user": {"login": "johanneskoester", "id": 1858646, "node_id": "MDQ6VXNlcjE4NTg2NDY=", "avatar_url": "https://avatars.githubusercontent.com/u/1858646?v=4", "gravatar_id": "", "url": "https://api.github.com/users/johanneskoester", "html_url": "https://github.com/johanneskoester", "followers_url": "https://api.github.com/users/johanneskoester/followers", "following_url": "https://api.github.com/users/johanneskoester/following{/other_user}", "gists_url": "https://api.github.com/users/johanneskoester/gists{/gist_id}", "starred_url": "https://api.github.com/users/johanneskoester/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/johanneskoester/subscriptions", "organizations_url": "https://api.github.com/users/johanneskoester/orgs", "repos_url": "https://api.github.com/users/johanneskoester/repos", "events_url": "https://api.github.com/users/johanneskoester/events{/privacy}", "received_events_url": "https://api.github.com/users/johanneskoester/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 593503757, "node_id": "MDU6TGFiZWw1OTM1MDM3NTc=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-infra", "name": "T-infra", "color": "bfd4f2", "default": false, "description": "Relevant to the infrastructure team, which will review and decide on the PR/issue."}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2017-07-18T13:01:29Z", "updated_at": "2017-07-28T00:58:23Z", "closed_at": null, "author_association": "NONE", "active_lock_reason": null, "body": "We are trying to package rust for the conda package manager. For that, we use an external llvm build. We can successfully compile rustc and cargo for both osx and linux64 (CentOS 6), however, when trying to use the resulting binaries to build crates, we get the following error:\r\n```\r\nerror: internal compiler error: unexpected panic\r\n\r\nnote: the compiler unexpectedly panicked. this is a bug.\r\n\r\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports\r\n\r\nnote: run with `RUST_BACKTRACE=1` for a backtrace\r\n\r\nthread 'rustc' panicked at 'called `Result::unwrap()` on an `Err` value: NulError(0, [0, 0, 0, 0, 0, 0, 0, 0, 0])', src/libcore/result.rs:859\r\nstack backtrace:\r\n   0: std::sys::imp::backtrace::tracing::imp::unwind_backtrace\r\n             at /feedstock_root/build_artefacts/rust_1500377496458/work/rustc-1.18.0-src/src/libstd/sys/unix/backtrace/tracing/gcc_s.rs:49\r\n   1: std::sys_common::backtrace::_print\r\n             at /feedstock_root/build_artefacts/rust_1500377496458/work/rustc-1.18.0-src/src/libstd/sys_common/backtrace.rs:71\r\n   2: std::panicking::default_hook::{{closure}}\r\n             at /feedstock_root/build_artefacts/rust_1500377496458/work/rustc-1.18.0-src/src/libstd/sys_common/backtrace.rs:60\r\n             at /feedstock_root/build_artefacts/rust_1500377496458/work/rustc-1.18.0-src/src/libstd/panicking.rs:355\r\n   3: std::panicking::default_hook\r\n             at /feedstock_root/build_artefacts/rust_1500377496458/work/rustc-1.18.0-src/src/libstd/panicking.rs:365\r\n   4: std::panicking::rust_panic_with_hook\r\n             at /feedstock_root/build_artefacts/rust_1500377496458/work/rustc-1.18.0-src/src/libstd/panicking.rs:549\r\n   5: std::panicking::begin_panic\r\n             at /feedstock_root/build_artefacts/rust_1500377496458/work/rustc-1.18.0-src/src/libstd/panicking.rs:511\r\n   6: std::panicking::begin_panic_fmt\r\n             at /feedstock_root/build_artefacts/rust_1500377496458/work/rustc-1.18.0-src/src/libstd/panicking.rs:495\r\n   7: rust_begin_unwind\r\n             at /feedstock_root/build_artefacts/rust_1500377496458/work/rustc-1.18.0-src/src/libstd/panicking.rs:471\r\n   8: core::panicking::panic_fmt\r\n             at /feedstock_root/build_artefacts/rust_1500377496458/work/rustc-1.18.0-src/src/libcore/panicking.rs:69\r\n   9: core::result::unwrap_failed\r\n  10: rustc_trans::type_::Type::named_struct\r\n  11: rustc_trans::context::LocalCrateContext::new\r\n  12: rustc_trans::base::trans_crate\r\n  13: rustc_driver::driver::phase_4_translate_to_llvm\r\n  14: rustc_driver::driver::compile_input::{{closure}}\r\n  15: rustc_driver::driver::phase_3_run_analysis_passes::{{closure}}\r\n  16: rustc::ty::context::TyCtxt::create_and_enter\r\n  17: rustc_driver::driver::phase_3_run_analysis_passes\r\n  18: rustc_driver::driver::compile_input\r\n  19: rustc_driver::run_compiler\r\n  20: std::panicking::try::do_call\r\n  21: __rust_maybe_catch_panic\r\n             at /feedstock_root/build_artefacts/rust_1500377496458/work/rustc-1.18.0-src/src/libpanic_unwind/lib.rs:98\r\n  22: <F as alloc::boxed::FnBox<A>>::call_box\r\n  23: std::sys::imp::thread::Thread::new::thread_start\r\n             at /feedstock_root/build_artefacts/rust_1500377496458/work/rustc-1.18.0-src/src/liballoc/boxed.rs:650\r\n             at /feedstock_root/build_artefacts/rust_1500377496458/work/rustc-1.18.0-src/src/libstd/sys_common/thread.rs:21\r\n             at /feedstock_root/build_artefacts/rust_1500377496458/work/rustc-1.18.0-src/src/libstd/sys/unix/thread.rs:84\r\n  24: start_thread\r\n  25: __clone\r\n\r\nerror: Could not compile `void`.\r\n```\r\n\r\nThis happens for any crate.\r\n\r\nxref: conda-forge/rust-feedstock#1\r\n\r\nHas it something to do with our external llvm build?  We are using llvm 3.9. Are we missing an important flag? Any help would be greatly appreciated!", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/43311/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/43311/timeline", "performed_via_github_app": null, "state_reason": null}