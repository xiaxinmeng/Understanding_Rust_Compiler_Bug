{"url": "https://api.github.com/repos/rust-lang/rust/issues/19730", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/19730/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/19730/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/19730/events", "html_url": "https://github.com/rust-lang/rust/issues/19730", "id": 51666864, "node_id": "MDU6SXNzdWU1MTY2Njg2NA==", "number": 19730, "title": "HRTB rules do not permit \"perfect forwarding\" of the `Fn` traits", "user": {"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2014-12-11T09:55:21Z", "updated_at": "2014-12-19T15:32:24Z", "closed_at": "2014-12-19T15:32:24Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "It'd be nice to be able to define an impl like this:\n\n``` rust\nimpl<Sized? F,A,R> FnMut<A,R> for F\n    where F : Fn<A,R>\n{\n    extern \"rust-call\" fn call_mut(&mut self, args: A) -> R {\n        self.call(args)\n    }\n}\n```\n\nHowever, at present impls like this fail to apply for a bound like `FnMut(&int) -> &int`. This is because the bound region is not part of the impl declaration, and so the current higher-ranked code views this impl as as provided insufficient polymorphism. However, this code is just overly conservative. This is a problem because that impl above is crucial to the overall design.\n\nBut wait, you say! I thought there WAS an impl like that which had landed. This is true. Unfortunately, there is _also_ a [bug in the higher-ranked code](https://github.com/rust-lang/rust/pull/19438) that is presently masking the failure I would expect to see. In other words, the bug allows this impl to function correctly (but also other impls which should not).\n\nI have a plan to fix this but it requires rejiggering how we process HRTB bounds. Instead of an impl providing a higher-ranked trait reference, and then relying on subtyping of trait references, we will instead have the trait selector skolemize the trait reference it is looking for and attempt to match impls. We can then do the same taint checking procedure and so forth, but in the trait checker. I won't go into the details here, it's hard to explain concisely.\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/19730/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/19730/timeline", "performed_via_github_app": null, "state_reason": "completed"}