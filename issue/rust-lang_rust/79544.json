{"url": "https://api.github.com/repos/rust-lang/rust/issues/79544", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/79544/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/79544/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/79544/events", "html_url": "https://github.com/rust-lang/rust/issues/79544", "id": 753025593, "node_id": "MDU6SXNzdWU3NTMwMjU1OTM=", "number": 79544, "title": "Overflow/underflow not possible in const_fn", "user": {"login": "HindrikStegenga", "id": 10209433, "node_id": "MDQ6VXNlcjEwMjA5NDMz", "avatar_url": "https://avatars.githubusercontent.com/u/10209433?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HindrikStegenga", "html_url": "https://github.com/HindrikStegenga", "followers_url": "https://api.github.com/users/HindrikStegenga/followers", "following_url": "https://api.github.com/users/HindrikStegenga/following{/other_user}", "gists_url": "https://api.github.com/users/HindrikStegenga/gists{/gist_id}", "starred_url": "https://api.github.com/users/HindrikStegenga/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HindrikStegenga/subscriptions", "organizations_url": "https://api.github.com/users/HindrikStegenga/orgs", "repos_url": "https://api.github.com/users/HindrikStegenga/repos", "events_url": "https://api.github.com/users/HindrikStegenga/events{/privacy}", "received_events_url": "https://api.github.com/users/HindrikStegenga/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-11-29T21:54:42Z", "updated_at": "2020-11-29T22:08:45Z", "closed_at": "2020-11-29T22:08:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!--\r\nIt seems that currently it's impossible to have underflow/overflow behaviour on some numeric types in Rust. Since it requires the use of the Wrapping type, and while those can be constructed in const context, operations on them fail to compile.\r\n\r\n-->\r\n\r\nI tried this code:\r\n\r\n```rust\r\nlet test: Wrapping<u64> = Wrapping(0u64) + Wrapping(1u64);\r\n```\r\n\r\nI expected to see this happen:\r\n\r\nGetting a u64 back and compilation to succeed.\r\n\r\nInstead, this happened: \r\nE0015 calls in constant functions are limited to constant functions, tuple struct and tuple variants.\r\n### Meta\r\n<!--\r\nIf you're using the stable version of the compiler, you should also check if the\r\nbug also exists in the beta or nightly versions.\r\n-->\r\nBug occurs on both Stable and Nightly. \r\n\r\n`rustc --version --verbose`:\r\n```\r\nrustc 1.50.0-nightly (1c389ffef 2020-11-24)\r\nbinary: rustc\r\ncommit-hash: 1c389ffeff814726dec325f0f2b0c99107df2673\r\ncommit-date: 2020-11-24\r\nhost: x86_64-apple-darwin\r\nrelease: 1.50.0-nightly\r\n```\r\n```\r\nrustc 1.48.0 (7eac88abb 2020-11-16)\r\nbinary: rustc\r\ncommit-hash: 7eac88abb2e57e752f3302f02be5f3ce3d7adfb4\r\ncommit-date: 2020-11-16\r\nhost: x86_64-apple-darwin\r\nrelease: 1.48.0\r\nLLVM version: 11.0\r\n```\r\n<!--\r\nInclude a backtrace in the code block by setting `RUST_BACKTRACE=1` in your\r\nenvironment. E.g. `RUST_BACKTRACE=1 cargo build`.\r\n-->\r\n<details><summary>Backtrace</summary>\r\n<p>\r\n\r\n```\r\n   Compiling crate_name v0.1.0 (directory)\r\n   Compiling crate_name v0.1.0 (directory)\r\n\r\nerror[E0015]: calls in constant functions are limited to constant functions, tuple structs and tuple variants\r\n  --> some_file/mod.rs:37:35\r\n   |\r\n37 |         let test: Wrapping<u64> = Wrapping(0u64) + Wrapping(1u64);\r\n   |                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n\r\nerror: aborting due to previous error; 4 warnings emitted\r\n\r\nFor more information about this error, try `rustc --explain E0015`.\r\nerror: could not compile `shard_ecs`\r\n\r\nTo learn more, run the command again with --verbose.\r\nwarning: build failed, waiting for other jobs to finish...\r\nerror: build failed\r\n```\r\n\r\n</p>\r\n</details>\r\n", "closed_by": {"login": "jonas-schievink", "id": 1786438, "node_id": "MDQ6VXNlcjE3ODY0Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/1786438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jonas-schievink", "html_url": "https://github.com/jonas-schievink", "followers_url": "https://api.github.com/users/jonas-schievink/followers", "following_url": "https://api.github.com/users/jonas-schievink/following{/other_user}", "gists_url": "https://api.github.com/users/jonas-schievink/gists{/gist_id}", "starred_url": "https://api.github.com/users/jonas-schievink/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jonas-schievink/subscriptions", "organizations_url": "https://api.github.com/users/jonas-schievink/orgs", "repos_url": "https://api.github.com/users/jonas-schievink/repos", "events_url": "https://api.github.com/users/jonas-schievink/events{/privacy}", "received_events_url": "https://api.github.com/users/jonas-schievink/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/79544/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/79544/timeline", "performed_via_github_app": null, "state_reason": "completed"}