{"url": "https://api.github.com/repos/rust-lang/rust/issues/92439", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/92439/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/92439/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/92439/events", "html_url": "https://github.com/rust-lang/rust/issues/92439", "id": 1091135373, "node_id": "I_kwDOAAsO6M5BCWeN", "number": 92439, "title": "Error could use some improvement: slice indices are of type `usize` or ranges of `usize`", "user": {"login": "dcormier", "id": 216265, "node_id": "MDQ6VXNlcjIxNjI2NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/216265?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dcormier", "html_url": "https://github.com/dcormier", "followers_url": "https://api.github.com/users/dcormier/followers", "following_url": "https://api.github.com/users/dcormier/following{/other_user}", "gists_url": "https://api.github.com/users/dcormier/gists{/gist_id}", "starred_url": "https://api.github.com/users/dcormier/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dcormier/subscriptions", "organizations_url": "https://api.github.com/users/dcormier/orgs", "repos_url": "https://api.github.com/users/dcormier/repos", "events_url": "https://api.github.com/users/dcormier/events{/privacy}", "received_events_url": "https://api.github.com/users/dcormier/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 235791, "node_id": "MDU6TGFiZWwyMzU3OTE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-diagnostics", "name": "A-diagnostics", "color": "f7e101", "default": false, "description": "Area: Messages for errors, warnings, and lints"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-12-30T14:23:05Z", "updated_at": "2021-12-30T14:25:32Z", "closed_at": null, "author_association": "NONE", "active_lock_reason": null, "body": "I had someone new to Rust ask me about an error he was running into. The problem was very simple, but the error was not clear enough for him to know that. And he was far from the only person to trip over this same error:\r\n\r\n- https://www.reddit.com/r/rust/comments/8k4vwc/rust_noob_using_a_value_from_an_array_as_an_index/\r\n- https://users.rust-lang.org/t/solved-need-help-with-slice/24296\r\n- https://stackoverflow.com/questions/56517606/how-do-i-use-a-paremeter-to-index-an-array-in-rust\r\n\r\nA quick search shows plenty more who struggled with this error. Given that users seem to have trouble with it, it seems like the error should be improved.\r\n\r\nGiven [the following code](https://play.rust-lang.org/?version=nightly&mode=debug&edition=2021&gist=d88f600e401f1f1c83da41dd46b254a6):\r\n\r\n```rust\r\nstruct Move {\r\n    x: u8,\r\n    y: u8,\r\n}\r\n\r\n#[derive(Default)]\r\nstruct GameState {\r\n    grid: [[u8; 3]; 3],\r\n}\r\n\r\nimpl GameState {\r\n    fn input_move(&mut self, m: Move) {\r\n        self.grid[m.x][m.y] = 1;\r\n    }\r\n}\r\n\r\nfn main() {\r\n    let mut game = GameState::default();\r\n\r\n    game.input_move(Move { x: 0, y: 0 });\r\n}\r\n```\r\n\r\nThe current output is:\r\n\r\n```text\r\nerror[E0277]: the type `[[u8; 3]]` cannot be indexed by `u8`\r\n  --> src/main.rs:13:9\r\n   |\r\n13 |         self.grid[m.x][m.y] = 1;\r\n   |         ^^^^^^^^^^^^^^ slice indices are of type `usize` or ranges of `usize`\r\n   |\r\n   = help: the trait `SliceIndex<[[u8; 3]]>` is not implemented for `u8`\r\n   = note: required because of the requirements on the impl of `Index<u8>` for `[[u8; 3]]`\r\n\r\nFor more information about this error, try `rustc --explain E0277`.\r\n```\r\n\r\n<!-- The following is not always necessary. -->\r\nIdeally the output should be more clear that the value being used to index is not `usize`. Perhaps something like:\r\n\r\n```text\r\nerror[E0277]: the type `[[u8; 3]]` cannot be indexed by `u8`\r\n  --> src/main.rs:13:9\r\n   |\r\n13 |         self.grid[m.x][m.y] = 1;\r\n   |                   ^^^ slice indices must be of type `usize` or ranges of `usize`\r\n   |\r\n   = help: the trait `SliceIndex<[[u8; 3]]>` is not implemented for `u8`\r\n   = note: required because of the requirements on the impl of `Index<u8>` for `[[u8; 3]]`\r\n\r\nFor more information about this error, try `rustc --explain E0277`.\r\n```\r\n\r\n<!--\r\nIf the problem is not self-explanatory, please provide a rationale for the\r\nchange.\r\n-->\r\n\r\nThe tweak to the language may make it more clear that the value being used to index the slice is not the type it's required to be. Additionally, pointing more specifically at the value being used to index may help the user to know where the problem is.\r\n", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/92439/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/92439/timeline", "performed_via_github_app": null, "state_reason": null}