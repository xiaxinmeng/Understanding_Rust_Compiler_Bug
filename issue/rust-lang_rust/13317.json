{"url": "https://api.github.com/repos/rust-lang/rust/issues/13317", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/13317/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/13317/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/13317/events", "html_url": "https://github.com/rust-lang/rust/issues/13317", "id": 30876977, "node_id": "MDU6SXNzdWUzMDg3Njk3Nw==", "number": 13317, "title": "error: internal compiler error: unexpected failure if -o filename is used", "user": {"login": "farcaller", "id": 693, "node_id": "MDQ6VXNlcjY5Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/693?v=4", "gravatar_id": "", "url": "https://api.github.com/users/farcaller", "html_url": "https://github.com/farcaller", "followers_url": "https://api.github.com/users/farcaller/followers", "following_url": "https://api.github.com/users/farcaller/following{/other_user}", "gists_url": "https://api.github.com/users/farcaller/gists{/gist_id}", "starred_url": "https://api.github.com/users/farcaller/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/farcaller/subscriptions", "organizations_url": "https://api.github.com/users/farcaller/orgs", "repos_url": "https://api.github.com/users/farcaller/repos", "events_url": "https://api.github.com/users/farcaller/events{/privacy}", "received_events_url": "https://api.github.com/users/farcaller/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2014-04-04T16:57:53Z", "updated_at": "2015-04-21T15:19:55Z", "closed_at": "2015-04-21T15:19:55Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Running rustc from https://github.com/mozilla/rust/commit/286b62e0da509888fb6cc05b5b174cb4353e6fd5.\n\nIf I compile rust-core with `--out-dir dir` everything works:\n\n```\nrustc -g --opt-level 0 --target thumbv7m-linux-eabi -Ctarget-cpu=cortex-m3 -Z no-landing-pads   -L ./build --out-dir ./build ./rust-core/core/lib.rs\nrustc -g --opt-level 0 --target thumbv7m-linux-eabi -Ctarget-cpu=cortex-m3 -Z no-landing-pads -Z lto --emit obj -L ./build -o ./build/intermediate/main.o ./src/main.rs\n```\n\nIf I use `-o file`, compilation breaks with internal compiler error:\n\n```\nrustc -g --opt-level 0 --target thumbv7m-linux-eabi -Ctarget-cpu=cortex-m3 -Z no-landing-pads   -L ./build -o ./build/libcore-caef0f5f-0.0.rlib ./rust-core/core/lib.rs\nrustc -g --opt-level 0 --target thumbv7m-linux-eabi -Ctarget-cpu=cortex-m3 -Z no-landing-pads -Z lto --emit obj -L ./build -o ./build/intermediate/main.o ./src/main.rs\nerror: internal compiler error: unexpected failure\n```\n\nBacktrace:\n\n```\ntask 'rustc' failed at 'missing compressed bytecode in archive!', /private/tmp/rust-7IAC/src/libstd/option.rs:245\nstack backtrace:\n   1:        0x110ffcce4 - rt::backtrace::imp::write::hd10102b8c011e5c0a8b::v0.11.pre\n   2:        0x110f60716 - rt::unwind::begin_unwind_inner::h2aba2baaa74b26e6EIb::v0.11.pre\n   3:        0x10e6e9568 - rt::unwind::begin_unwind::h4a49daf87e2d595eSLp::v0.11.pre\n   4:        0x10edb2723 - back::lto::run::hf3251f90d5b27d3d7V1::v0.11.pre\n   5:        0x10edb0ec2 - back::link::write::run_passes::closure.83343\n   6:        0x10ea9e03f - util::common::time::h8a9a37f5ab167269hpg::v0.11.pre\n   7:        0x10edae864 - back::link::write::run_passes::h9411612d2651cf8bKe0::v0.11.pre\n   8:        0x10eeb2281 - driver::driver::phase_5_run_llvm_passes::closure.89780\n   9:        0x10ea9e03f - util::common::time::h8a9a37f5ab167269hpg::v0.11.pre\n  10:        0x10eeb211d - driver::driver::phase_5_run_llvm_passes::h158ab363a68c6900Poe::v0.11.pre\n  11:        0x10eeb4c92 - driver::driver::compile_input::hf4855bb3e4401cfdODe::v0.11.pre\n  12:        0x10eed84ce - run_compiler::hc72c45483cbf8cefC5l::v0.11.pre\n  13:        0x10eeec0fd - main_args::closure.91691\n  14:        0x10eeea912 - monitor::closure.91576\n  15:        0x10eee64bb - task::TaskBuilder::try::closure.91351\n  16:        0x10e6ae78c - task::spawn_opts::closure.7923\n  17:        0x110ff8108 - rt::task::Task::run::closure.41788\n  18:        0x1110029fc - rust_try\n  19:        0x110ff7f87 - rt::task::Task::run::h83564328e5810a07HB9::v0.11.pre\n  20:        0x10e6ae60f - task::spawn_opts::closure.7895\n  21:        0x110ffb6c6 - rt::thread::thread_start::h66f4963f837dbe56oga::v0.11.pre\n  22:     0x7fff8f91f899 - _pthread_body\n  23:     0x7fff8f91f72a - _pthread_struct_init\n```\n\nlibcore-caef0f5f-0.0.rlib contents:\n\n```\n% ar -t libcore-caef0f5f-0.0.rlib\n__.SYMDEF SORTED\nlibcore-caef0f5f-0.o\nrust.metadata.bin\nlibcore-caef0f5f-0.bc.deflate\n```\n", "closed_by": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/13317/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/13317/timeline", "performed_via_github_app": null, "state_reason": "completed"}