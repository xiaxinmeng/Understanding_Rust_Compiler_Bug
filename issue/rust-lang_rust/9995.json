{"url": "https://api.github.com/repos/rust-lang/rust/issues/9995", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/9995/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/9995/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/9995/events", "html_url": "https://github.com/rust-lang/rust/issues/9995", "id": 21331805, "node_id": "MDU6SXNzdWUyMTMzMTgwNQ==", "number": 9995, "title": "The insert_or_update_with method on hashmaps has a superfluous parameter", "user": {"login": "bstrie", "id": 865233, "node_id": "MDQ6VXNlcjg2NTIzMw==", "avatar_url": "https://avatars.githubusercontent.com/u/865233?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bstrie", "html_url": "https://github.com/bstrie", "followers_url": "https://api.github.com/users/bstrie/followers", "following_url": "https://api.github.com/users/bstrie/following{/other_user}", "gists_url": "https://api.github.com/users/bstrie/gists{/gist_id}", "starred_url": "https://api.github.com/users/bstrie/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bstrie/subscriptions", "organizations_url": "https://api.github.com/users/bstrie/orgs", "repos_url": "https://api.github.com/users/bstrie/repos", "events_url": "https://api.github.com/users/bstrie/events{/privacy}", "received_events_url": "https://api.github.com/users/bstrie/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 36996, "node_id": "MDU6TGFiZWwzNjk5Ng==", "url": "https://api.github.com/repos/rust-lang/rust/labels/E-easy", "name": "E-easy", "color": "02e10c", "default": false, "description": "Call for participation: Experience needed to fix: Easy / not much (good first issue)"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2013-10-21T17:48:30Z", "updated_at": "2013-10-24T17:24:19Z", "closed_at": "2013-10-24T17:24:19Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "`insert_or_update_with` attempts to insert a key/value pair into a hashmap, but if the key already exists, it allows you to update the value according to a closure (this is almost universally used to increment a counter... perhaps we need a counter type in libextra). This closure has two parameters, a key and a value. However, the key parameter to the closure is superfluous, as you've already provided the key in question to the method and can simply close over it if you want to reference it. Here's a demonstration:\n\n``` rust\nuse std::hashmap::HashMap;\nfn main() {\n    let mut map = HashMap::<uint,uint>::new();\n    let k = 1;\n    map.insert_or_update_with(k, k, |_, v| *v+=k);\n    map.insert_or_update_with(k, k, |_, v| *v+=k);\n}\n```\n\nWe ignore the key parameter to the closure with `_`, and yet have no trouble referring to it via the closed-over value.\n\nAm I wrong in believing that this is superfluous? Is there perhaps some borrowing-related complication that would warrant leaving this parameter in place?\n", "closed_by": {"login": "catamorphism", "id": 427212, "node_id": "MDQ6VXNlcjQyNzIxMg==", "avatar_url": "https://avatars.githubusercontent.com/u/427212?v=4", "gravatar_id": "", "url": "https://api.github.com/users/catamorphism", "html_url": "https://github.com/catamorphism", "followers_url": "https://api.github.com/users/catamorphism/followers", "following_url": "https://api.github.com/users/catamorphism/following{/other_user}", "gists_url": "https://api.github.com/users/catamorphism/gists{/gist_id}", "starred_url": "https://api.github.com/users/catamorphism/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/catamorphism/subscriptions", "organizations_url": "https://api.github.com/users/catamorphism/orgs", "repos_url": "https://api.github.com/users/catamorphism/repos", "events_url": "https://api.github.com/users/catamorphism/events{/privacy}", "received_events_url": "https://api.github.com/users/catamorphism/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/9995/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/9995/timeline", "performed_via_github_app": null, "state_reason": "completed"}