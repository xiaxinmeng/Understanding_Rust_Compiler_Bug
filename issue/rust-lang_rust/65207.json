{"url": "https://api.github.com/repos/rust-lang/rust/issues/65207", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/65207/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/65207/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/65207/events", "html_url": "https://github.com/rust-lang/rust/issues/65207", "id": 504020225, "node_id": "MDU6SXNzdWU1MDQwMjAyMjU=", "number": 65207, "title": "Change in macro output between 1.37.0 and 1.38.0", "user": {"login": "djc", "id": 158471, "node_id": "MDQ6VXNlcjE1ODQ3MQ==", "avatar_url": "https://avatars.githubusercontent.com/u/158471?v=4", "gravatar_id": "", "url": "https://api.github.com/users/djc", "html_url": "https://github.com/djc", "followers_url": "https://api.github.com/users/djc/followers", "following_url": "https://api.github.com/users/djc/following{/other_user}", "gists_url": "https://api.github.com/users/djc/gists{/gist_id}", "starred_url": "https://api.github.com/users/djc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/djc/subscriptions", "organizations_url": "https://api.github.com/users/djc/orgs", "repos_url": "https://api.github.com/users/djc/repos", "events_url": "https://api.github.com/users/djc/events{/privacy}", "received_events_url": "https://api.github.com/users/djc/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-10-08T12:42:18Z", "updated_at": "2019-10-09T07:35:18Z", "closed_at": "2019-10-09T07:35:18Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "The following code changed output between Rust 1.37.0 and 1.38.0:\r\n\r\n```rust\r\nmacro_rules! call_a_or_b_on_tail {\r\n    ((a: $a:expr, b: $b:expr), call a: $($tail:tt)*) => {\r\n        $a(stringify!($($tail)*))\r\n    };\r\n    ((a: $a:expr, b: $b:expr), call b: $($tail:tt)*) => {\r\n        $b(stringify!($($tail)*))\r\n    };\r\n    ($ab:tt, $_skip:tt $($tail:tt)*) => {\r\n        call_a_or_b_on_tail!($ab, $($tail)*)\r\n    };\r\n}\r\n\r\nfn compute_len(s: &str) -> usize {\r\n    s.len()\r\n}\r\n\r\nfn main() {\r\n    println!(\r\n        \"{expr1}\\n{expr2}\",\r\n        expr1 = call_a_or_b_on_tail!(\r\n            (a: compute_len, b: zero),\r\n                and now, to justify the existence of two paths\r\n                we will also call a: its input should somehow\r\n                be self-referential, so let's make it return\r\n                some ninety one!\r\n        ),\r\n        expr2 = call_a_or_b_on_tail!(\r\n            (a: compute_len, b: zero),\r\n                and now, to justify the existence of two paths\r\n                we will also call a: its input should somehow\r\n                be self-referential, so let's make it return\r\n                some ninety \"(\\\"()\"nine!\r\n        ),\r\n    );\r\n}\r\n```\r\n\r\n```\r\ndjc-ing master regress $ cargo run\r\n   Compiling regress v0.1.0 (/Users/djc/src/regress)\r\n    Finished dev [unoptimized + debuginfo] target(s) in 0.35s\r\n     Running `target/debug/regress`\r\n90\r\n98\r\ndjc-ing master regress $ cargo +1.37.0 run\r\n   Compiling regress v0.1.0 (/Users/djc/src/regress)\r\n    Finished dev [unoptimized + debuginfo] target(s) in 0.30s\r\n     Running `target/debug/regress`\r\n91\r\n99\r\n```\r\n\r\nPlayground: https://play.rust-lang.org/?version=stable&mode=debug&edition=2018&gist=6f67da3ab63067c8186ca702fe1c1910", "closed_by": {"login": "djc", "id": 158471, "node_id": "MDQ6VXNlcjE1ODQ3MQ==", "avatar_url": "https://avatars.githubusercontent.com/u/158471?v=4", "gravatar_id": "", "url": "https://api.github.com/users/djc", "html_url": "https://github.com/djc", "followers_url": "https://api.github.com/users/djc/followers", "following_url": "https://api.github.com/users/djc/following{/other_user}", "gists_url": "https://api.github.com/users/djc/gists{/gist_id}", "starred_url": "https://api.github.com/users/djc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/djc/subscriptions", "organizations_url": "https://api.github.com/users/djc/orgs", "repos_url": "https://api.github.com/users/djc/repos", "events_url": "https://api.github.com/users/djc/events{/privacy}", "received_events_url": "https://api.github.com/users/djc/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/65207/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/65207/timeline", "performed_via_github_app": null, "state_reason": "completed"}