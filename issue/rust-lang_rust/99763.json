{"url": "https://api.github.com/repos/rust-lang/rust/issues/99763", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/99763/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/99763/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/99763/events", "html_url": "https://github.com/rust-lang/rust/issues/99763", "id": 1318250274, "node_id": "I_kwDOAAsO6M5Okuci", "number": 99763, "title": "Sporadic ICE when compiling in gocryptfs mount", "user": {"login": "texel-sensei", "id": 25228901, "node_id": "MDQ6VXNlcjI1MjI4OTAx", "avatar_url": "https://avatars.githubusercontent.com/u/25228901?v=4", "gravatar_id": "", "url": "https://api.github.com/users/texel-sensei", "html_url": "https://github.com/texel-sensei", "followers_url": "https://api.github.com/users/texel-sensei/followers", "following_url": "https://api.github.com/users/texel-sensei/following{/other_user}", "gists_url": "https://api.github.com/users/texel-sensei/gists{/gist_id}", "starred_url": "https://api.github.com/users/texel-sensei/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/texel-sensei/subscriptions", "organizations_url": "https://api.github.com/users/texel-sensei/orgs", "repos_url": "https://api.github.com/users/texel-sensei/repos", "events_url": "https://api.github.com/users/texel-sensei/events{/privacy}", "received_events_url": "https://api.github.com/users/texel-sensei/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-07-26T13:31:22Z", "updated_at": "2022-07-26T17:50:06Z", "closed_at": null, "author_association": "NONE", "active_lock_reason": null, "body": "<!--\r\nThank you for finding an Internal Compiler Error! \ud83e\uddca  If possible, try to provide\r\na minimal verifiable example. You can read \"Rust Bug Minimization Patterns\" for\r\nhow to create smaller examples.\r\n\r\nhttp://blog.pnkfx.org/blog/2019/11/18/rust-bug-minimization-patterns/\r\n\r\n-->\r\n\r\n### Code\r\n\r\nCode is not relevant to the bug, tested example:\r\n\r\n```Rust\r\nfn main() {\r\n    42\r\n}\r\n```\r\n\r\nThe repository is located in a [gocryptfs](https://github.com/rfjakob/gocryptfs) mount, running on Arch Linux. The crash happens sporadically, sometimes compilation works as expected, sometimes the code aborts with SIGBUS and sometimes it panics with the listed error message.\r\n\r\nOther tools have no issues running in such a mount.\r\n\r\nOutput of `uname -srv`: `Linux 5.18.12-zen1-1-zen #1 ZEN SMP PREEMPT_DYNAMIC Fri, 15 Jul 2022 15:33:04 +0000`\r\n\r\n\r\n\r\n\r\n### Meta\r\n<!--\r\nIf you're using the stable version of the compiler, you should also check if the\r\nbug also exists in the beta or nightly versions.\r\n-->\r\n\r\n`rustc --version --verbose`:\r\n```\r\n<version>\r\n```\r\n\r\n### Error output\r\n\r\n```\r\nthread 'rustc' panicked at 'assertion failed: `(left == right)`\r\n  left: `82`,\r\n right: `1002111927320821928687967599834759150`', compiler/rustc_query_impl/src/on_disk_cache.rs:540:5\r\n```\r\n\r\n<!--\r\nInclude a backtrace in the code block by setting `RUST_BACKTRACE=1` in your\r\nenvironment. E.g. `RUST_BACKTRACE=1 cargo build`.\r\n-->\r\n<details><summary><strong>Backtrace</strong></summary>\r\n<p>\r\n\r\n```\r\nstack backtrace:\r\n   0:     0x7fdf4329dfed - std::backtrace_rs::backtrace::libunwind::trace::hb729d9642bb971eb\r\n                               at /rustc/a8314ef7d0ec7b75c336af2c9857bfaf43002bfc/library/std/src/../../backtrace/src/backtrace/libunwind.rs:93:5\r\n   1:     0x7fdf4329dfed - std::backtrace_rs::backtrace::trace_unsynchronized::h373bb774579df5c7\r\n                               at /rustc/a8314ef7d0ec7b75c336af2c9857bfaf43002bfc/library/std/src/../../backtrace/src/backtrace/mod.rs:66:5\r\n   2:     0x7fdf4329dfed - std::sys_common::backtrace::_print_fmt::hfbd4e92d240c89bb\r\n                               at /rustc/a8314ef7d0ec7b75c336af2c9857bfaf43002bfc/library/std/src/sys_common/backtrace.rs:66:5\r\n   3:     0x7fdf4329dfed - <std::sys_common::backtrace::_print::DisplayBacktrace as core::fmt::Display>::fmt::h8f618991fbf64972\r\n                               at /rustc/a8314ef7d0ec7b75c336af2c9857bfaf43002bfc/library/std/src/sys_common/backtrace.rs:45:22\r\n   4:     0x7fdf432f9c7c - core::fmt::write::hc69b5b640d88cce8\r\n                               at /rustc/a8314ef7d0ec7b75c336af2c9857bfaf43002bfc/library/core/src/fmt/mod.rs:1196:17\r\n   5:     0x7fdf4328f6c1 - std::io::Write::write_fmt::h3403cef06a24a303\r\n                               at /rustc/a8314ef7d0ec7b75c336af2c9857bfaf43002bfc/library/std/src/io/mod.rs:1654:15\r\n   6:     0x7fdf432a0d05 - std::sys_common::backtrace::_print::h368f27cdedea0e52\r\n                               at /rustc/a8314ef7d0ec7b75c336af2c9857bfaf43002bfc/library/std/src/sys_common/backtrace.rs:48:5\r\n   7:     0x7fdf432a0d05 - std::sys_common::backtrace::print::ha105c9cf5a64cd17\r\n                               at /rustc/a8314ef7d0ec7b75c336af2c9857bfaf43002bfc/library/std/src/sys_common/backtrace.rs:35:9\r\n   8:     0x7fdf432a0d05 - std::panicking::default_hook::{{closure}}::h48ed2c3707d5e20e\r\n                               at /rustc/a8314ef7d0ec7b75c336af2c9857bfaf43002bfc/library/std/src/panicking.rs:295:22\r\n   9:     0x7fdf432a0979 - std::panicking::default_hook::h8744fc5cea5e3110\r\n                               at /rustc/a8314ef7d0ec7b75c336af2c9857bfaf43002bfc/library/std/src/panicking.rs:314:9\r\n  10:     0x7fdf43ae9961 - rustc_driver[cc15f272104f8c81]::DEFAULT_HOOK::{closure#0}::{closure#0}\r\n  11:     0x7fdf432a14d6 - std::panicking::rust_panic_with_hook::hc82286af2030e925\r\n                               at /rustc/a8314ef7d0ec7b75c336af2c9857bfaf43002bfc/library/std/src/panicking.rs:702:17\r\n  12:     0x7fdf432a12d7 - std::panicking::begin_panic_handler::{{closure}}::h1c15057c2f09081f\r\n                               at /rustc/a8314ef7d0ec7b75c336af2c9857bfaf43002bfc/library/std/src/panicking.rs:588:13\r\n  13:     0x7fdf4329e4a4 - std::sys_common::backtrace::__rust_end_short_backtrace::h65de906a5330f8da\r\n                               at /rustc/a8314ef7d0ec7b75c336af2c9857bfaf43002bfc/library/std/src/sys_common/backtrace.rs:138:18\r\n  14:     0x7fdf432a1009 - rust_begin_unwind\r\n                               at /rustc/a8314ef7d0ec7b75c336af2c9857bfaf43002bfc/library/std/src/panicking.rs:584:5\r\n  15:     0x7fdf43266283 - core::panicking::panic_fmt::h741cfbfc95bc6112\r\n                               at /rustc/a8314ef7d0ec7b75c336af2c9857bfaf43002bfc/library/core/src/panicking.rs:142:14\r\n  16:     0x7fdf432f6a28 - core::panicking::assert_failed_inner::h36469c68b6fc10f1\r\n  17:     0x7fdf443beb0c - core[6724bec812d80be0]::panicking::assert_failed::<u128, u128>\r\n  18:     0x7fdf443b87de - <rustc_query_impl[37d320545ae1f097]::on_disk_cache::OnDiskCache as rustc_middle[2b9dbf3985a9058b]::ty::context::OnDiskCache>::new\r\n  19:     0x7fdf45ba35c3 - rustc_incremental[36fe853e067954a8]::persist::load::load_query_result_cache::<rustc_query_impl[37d320545ae1f097]::on_disk_cache::OnDiskCache>\r\n  20:     0x7fdf45b84102 - rustc_interface[a10bc87377f6ea4]::passes::create_global_ctxt\r\n  21:     0x7fdf45ba7ead - <rustc_interface[a10bc87377f6ea4]::queries::Queries>::global_ctxt\r\n  22:     0x7fdf45b4ff82 - <rustc_interface[a10bc87377f6ea4]::interface::Compiler>::enter::<rustc_driver[cc15f272104f8c81]::run_compiler::{closure#1}::{closure#2}, core[6724bec812d80be0]::result::Result<core[6724bec812d80be0]::option::Option<rustc_interface[a10bc87377f6ea4]::queries::Linker>, rustc_errors[7cc8b2502942d635]::ErrorGuaranteed>>\r\n  23:     0x7fdf45b786ef - rustc_span[aeddd698d19619f]::with_source_map::<core[6724bec812d80be0]::result::Result<(), rustc_errors[7cc8b2502942d635]::ErrorGuaranteed>, rustc_interface[a10bc87377f6ea4]::interface::create_compiler_and_run<core[6724bec812d80be0]::result::Result<(), rustc_errors[7cc8b2502942d635]::ErrorGuaranteed>, rustc_driver[cc15f272104f8c81]::run_compiler::{closure#1}>::{closure#1}>\r\n  24:     0x7fdf45b64024 - rustc_interface[a10bc87377f6ea4]::interface::create_compiler_and_run::<core[6724bec812d80be0]::result::Result<(), rustc_errors[7cc8b2502942d635]::ErrorGuaranteed>, rustc_driver[cc15f272104f8c81]::run_compiler::{closure#1}>\r\n  25:     0x7fdf45b4e4f2 - <scoped_tls[7f4edc8f5e37700f]::ScopedKey<rustc_span[aeddd698d19619f]::SessionGlobals>>::set::<rustc_interface[a10bc87377f6ea4]::interface::run_compiler<core[6724bec812d80be0]::result::Result<(), rustc_errors[7cc8b2502942d635]::ErrorGuaranteed>, rustc_driver[cc15f272104f8c81]::run_compiler::{closure#1}>::{closure#0}, core[6724bec812d80be0]::result::Result<(), rustc_errors[7cc8b2502942d635]::ErrorGuaranteed>>\r\n  26:     0x7fdf45b6561f - std[62a6aef941a414a5]::sys_common::backtrace::__rust_begin_short_backtrace::<rustc_interface[a10bc87377f6ea4]::util::run_in_thread_pool_with_globals<rustc_interface[a10bc87377f6ea4]::interface::run_compiler<core[6724bec812d80be0]::result::Result<(), rustc_errors[7cc8b2502942d635]::ErrorGuaranteed>, rustc_driver[cc15f272104f8c81]::run_compiler::{closure#1}>::{closure#0}, core[6724bec812d80be0]::result::Result<(), rustc_errors[7cc8b2502942d635]::ErrorGuaranteed>>::{closure#0}, core[6724bec812d80be0]::result::Result<(), rustc_errors[7cc8b2502942d635]::ErrorGuaranteed>>\r\n  27:     0x7fdf45b65759 - <<std[62a6aef941a414a5]::thread::Builder>::spawn_unchecked_<rustc_interface[a10bc87377f6ea4]::util::run_in_thread_pool_with_globals<rustc_interface[a10bc87377f6ea4]::interface::run_compiler<core[6724bec812d80be0]::result::Result<(), rustc_errors[7cc8b2502942d635]::ErrorGuaranteed>, rustc_driver[cc15f272104f8c81]::run_compiler::{closure#1}>::{closure#0}, core[6724bec812d80be0]::result::Result<(), rustc_errors[7cc8b2502942d635]::ErrorGuaranteed>>::{closure#0}, core[6724bec812d80be0]::result::Result<(), rustc_errors[7cc8b2502942d635]::ErrorGuaranteed>>::{closure#1} as core[6724bec812d80be0]::ops::function::FnOnce<()>>::call_once::{shim:vtable#0}\r\n  28:     0x7fdf432ab3f3 - <alloc::boxed::Box<F,A> as core::ops::function::FnOnce<Args>>::call_once::hcbca3baf872b7fe4\r\n                               at /rustc/a8314ef7d0ec7b75c336af2c9857bfaf43002bfc/library/alloc/src/boxed.rs:1872:9\r\n  29:     0x7fdf432ab3f3 - <alloc::boxed::Box<F,A> as core::ops::function::FnOnce<Args>>::call_once::h18790338ce1743e2\r\n                               at /rustc/a8314ef7d0ec7b75c336af2c9857bfaf43002bfc/library/alloc/src/boxed.rs:1872:9\r\n  30:     0x7fdf432ab3f3 - std::sys::unix::thread::Thread::new::thread_start::hb1067183bad48893\r\n                               at /rustc/a8314ef7d0ec7b75c336af2c9857bfaf43002bfc/library/std/src/sys/unix/thread.rs:108:17\r\n  31:     0x7fdf42e8c54d - <unknown>\r\n  32:     0x7fdf42f11874 - clone\r\n  33:                0x0 - <unknown>\r\n\r\nerror: internal compiler error: unexpected panic\r\n\r\nnote: the compiler unexpectedly panicked. this is a bug.\r\n\r\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/issues/new?labels=C-bug%2C+I-ICE%2C+T-compiler&template=ice.md\r\n\r\nnote: rustc 1.62.0 (a8314ef7d 2022-06-27) running on x86_64-unknown-linux-gnu\r\n\r\nnote: compiler flags: --crate-type bin -C embed-bitcode=no -C debuginfo=2 -C linker=clang -C incremental -C link-arg=-fuse-ld=/usr/bin/mold\r\n\r\nnote: some of the compiler flags provided by cargo are hidden\r\n\r\nquery stack during panic:\r\nend of query stack\r\n```\r\n\r\n</p>\r\n</details>\r\n\r\n", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/99763/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/99763/timeline", "performed_via_github_app": null, "state_reason": null}