{"url": "https://api.github.com/repos/rust-lang/rust/issues/9567", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/9567/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/9567/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/9567/events", "html_url": "https://github.com/rust-lang/rust/issues/9567", "id": 20180730, "node_id": "MDU6SXNzdWUyMDE4MDczMA==", "number": 9567, "title": "rusti segfault details: dlopen difficulties, signal handler crashing. Where is dl-object.c ?", "user": {"login": "glycerine", "id": 445247, "node_id": "MDQ6VXNlcjQ0NTI0Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/445247?v=4", "gravatar_id": "", "url": "https://api.github.com/users/glycerine", "html_url": "https://github.com/glycerine", "followers_url": "https://api.github.com/users/glycerine/followers", "following_url": "https://api.github.com/users/glycerine/following{/other_user}", "gists_url": "https://api.github.com/users/glycerine/gists{/gist_id}", "starred_url": "https://api.github.com/users/glycerine/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/glycerine/subscriptions", "organizations_url": "https://api.github.com/users/glycerine/orgs", "repos_url": "https://api.github.com/users/glycerine/repos", "events_url": "https://api.github.com/users/glycerine/events{/privacy}", "received_events_url": "https://api.github.com/users/glycerine/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2013-09-27T16:29:41Z", "updated_at": "2013-10-17T09:41:22Z", "closed_at": "2013-10-17T09:41:22Z", "author_association": "NONE", "active_lock_reason": null, "body": "rustc 0.8 (afbc242 2013-09-27 01:36:15 -0700)\n\nWhen I define and run a simple function at rusti, it segfaults:\n\n```\njaten@i7:/usr/cn/rust/debug-build/install/bin$ ./rusti\nWARNING: The Rust REPL is experimental and may be\nunstable. If you encounter problems, please use the\ncompiler instead. Type :help for help.\nrusti> fn five() -> int { 5 }\nrusti> five()\nSegmentation fault (core dumped)\njaten@i7:/usr/cn/rust/debug-build/install/bin$\n```\n\nThis was with a debug build, so we can see the files and line numbers below. Strangely, I'm not finding any dl-object.c code to look at line 77.  \n\nI'd like to get rusti back on its feet. Can anyone advise on where to look for this source code.\n\n```\njaten@i7:/usr/cn/rust/debug-build/install/bin$ gdb rusti core\nGNU gdb (Ubuntu/Linaro 7.4-2012.04-0ubuntu2.1) 7.4-2012.04\nCopyright (C) 2012 Free Software Foundation, Inc.\nLicense GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.  Type \"show copying\"\nand \"show warranty\" for details.\nThis GDB was configured as \"x86_64-linux-gnu\".\nFor bug reporting instructions, please see:\n<http://bugs.launchpad.net/gdb-linaro/>...\nReading symbols from /usr/cn/rust/debug-build/install/bin/rusti...(no debugging symbols found)...done.\n[New LWP 8747]\n[New LWP 8754]\n[New LWP 8753]\n[New LWP 8749]\n[New LWP 8750]\n[New LWP 8752]\n[New LWP 8748]\n[New LWP 8751]\n[New LWP 8746]\n\nwarning: Can't read pathname for load map: Input/output error.\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib/x86_64-linux-gnu/libthread_db.so.1\".\n\nwarning: no loadable sections found in added symbol-file system-supplied DSO at 0x7fffdf7c5000\nCannot find new threads: generic error\nCore was generated by `./rusti'.\nProgram terminated with signal 11, Segmentation fault.\n#0  0x00007fc9e6f45844 in SignalHandler (Sig=11)\n    at ../../../../src/llvm/lib/Support/Unix/Signals.inc:186\n186     CallBacksToRun[i].first(CallBacksToRun[i].second);\n(gdb) bt\n#0  0x00007fc9e6f45844 in SignalHandler (Sig=11)\n    at ../../../../src/llvm/lib/Support/Unix/Signals.inc:186\n#1  <signal handler called>\n#2  0x00007fc9e8b1cede in calloc () from /usr/cn/rust/debug-build/install/bin/../lib/librustrt.so\n#3  0x00007fc9ec35e57e in _dl_new_object (\n    realname=0x7fc9daa0ca20 \"/usr/cn/rust/debug-build/install/lib/rustc/x86_64-unknown-linux-gnu/lib/libstd-6c65cf4b443341b1-0.8.so\", \n    libname=0x7fc9e42474a0 \"/usr/cn/rust/debug-build/install/lib/rustc/x86_64-unknown-linux-gnu/lib/libstd-6c65cf4b443341b1-0.8.so\", type=2, loader=0x0, mode=-1879047935, nsid=0) at dl-object.c:77\n#4  0x00007fc9ec359806 in _dl_map_object_from_fd (\n    name=0x7fc9e42474a0 \"/usr/cn/rust/debug-build/install/lib/rustc/x86_64-unknown-linux-gnu/lib/libstd-6c65cf4b443341b1-0.8.so\", fd=38, fbp=0x7fc9e4246720, \n    realname=0x7fc9daa0ca20 \"/usr/cn/rust/debug-build/install/lib/rustc/x86_64-unknown-linux-gnu/lib/libstd-6c65cf4b443341b1-0.8.so\", loader=0x0, l_type=2, mode=-1879047935, stack_endp=0x7fc9e4246a80, \n    nsid=0) at dl-load.c:1051\n#5  0x00007fc9ec35b69a in _dl_map_object (loader=0x0, \n    name=0x7fc9e42474a0 \"/usr/cn/rust/debug-build/install/lib/rustc/x86_64-unknown-linux-gnu/lib/libstd-6c65cf4b443341b1-0.8.so\", type=2, trace_mode=0, mode=-1879047935, nsid=<optimized out>)\n    at dl-load.c:2568\n#6  0x00007fc9ec36684b in dl_open_worker (a=0x7fc9e4246cb0) at dl-open.c:225\n#7  0x00007fc9ec362176 in _dl_catch_error (objname=0x7fc9e4246cf8, errstring=0x7fc9e4246d00, \n    mallocedp=0x7fc9e4246d0f, operate=0x7fc9ec366700 <dl_open_worker>, args=0x7fc9e4246cb0)\n    at dl-error.c:178\n#8  0x00007fc9ec36631a in _dl_open (\n    file=0x7fc9e42474a0 \"/usr/cn/rust/debug-build/install/lib/rustc/x86_64-unknown-linux-gnu/lib/libstd-6c65cf4b443341b1-0.8.so\", mode=-2147483391, caller_dlopen=0x7fc9e6f2a98b, nsid=-2, argc=1, \n    argv=<optimized out>, env=0x7fffdf632598) at dl-open.c:639\n#9  0x00007fc9e8514f26 in dlopen_doit (a=0x7fc9e4246ed0) at dlopen.c:67\n#10 0x00007fc9ec362176 in _dl_catch_error (objname=0x7fc9df4941f0, errstring=0x7fc9df4941f8, \n    mallocedp=0x7fc9df4941e8, operate=0x7fc9e8514ec0 <dlopen_doit>, args=0x7fc9e4246ed0)\n    at dl-error.c:178\n#11 0x00007fc9e851552f in _dlerror_run (operate=0x7fc9e8514ec0 <dlopen_doit>, args=0x7fc9e4246ed0)\n    at dlerror.c:164\n#12 0x00007fc9e8514fc1 in __dlopen (file=<optimized out>, mode=<optimized out>) at dlopen.c:88\n#13 0x00007fc9e6f2a98b in llvm::sys::DynamicLibrary::getPermanentLibrary (\n    filename=0x7fc9e42474a0 \"/usr/cn/rust/debug-build/install/lib/rustc/x86_64-unknown-linux-gnu/lib/libstd-6c65cf4b443341b1-0.8.so\", errMsg=0x7fc9e4247000)\n    at ../../../../src/llvm/lib/Support/DynamicLibrary.cpp:77\n#14 0x00007fc9e5ebf085 in RustMCJITMemoryManager::loadCrate (this=0x7fc9e405da00, \n    file=0x7fc9e42474a0 \"/usr/cn/rust/debug-build/install/lib/rustc/x86_64-unknown-linux-gnu/lib/libstd-6c65cf4b443341b1-0.8.so\", err=0x7fc9e4247000) at src/rustllvm/RustWrapper.cpp:130\n#15 0x00007fc9e5ebf8d7 in LLVMRustLoadCrate (mem=0x7fc9e405da00, \n    crate=0x7fc9e42474a0 \"/usr/cn/rust/debug-build/install/lib/rustc/x86_64-unknown-linux-gnu/lib/libstd-6c65cf4b443341b1-0.8.so\") at src/rustllvm/RustWrapper.cpp:267\n#16 0x00007fc9ea10d3c9 in back::link::jit::exec::anon::expr_fn::ah ()\n   from /usr/cn/rust/debug-build/install/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8.so\n#17 0x00007fc9e946033f in c_str::with_c_str::anon::expr_fn::ahai ()\n   from /usr/cn/rust/debug-build/install/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8.so\n#18 0x00007fc9e926f42f in vec::MutableVector$__extensions__::as_mut_buf::hd677c12d16be42416laS::v0.8\n    () from /usr/cn/rust/debug-build/install/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8.so\n#19 0x00007fc9e94600d1 in c_str::with_c_str::hd03c7fe5916f8657ah::v0.8 ()\n   from /usr/cn/rust/debug-build/install/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8.so\n#20 0x00007fc9e945fece in c_str::ToCStr$__extensions__::with_c_str::h8e2daefba6fcf7a754ag::v0.8 ()\n   from /usr/cn/rust/debug-build/install/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8.so\n#21 0x00007fc9e945fe43 in c_str::ToCStr$__extensions__::with_c_str::h8e2daefba6fcf7a7mCaf::v0.8 ()\n   from /usr/cn/rust/debug-build/install/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8.so\n#22 0x00007fc9ea10c63f in back::link::jit::exec::hb9ade5b45581040aH::v0.8 ()\n   from /usr/cn/rust/debug-build/install/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8.so\n#23 0x00007fc9ea10f946 in back::link::write::run_passes::h559b16dadcd2b5aa9::v0.8 ()\n   from /usr/cn/rust/debug-build/install/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8.so\n#24 0x00007fc9ea204aed in driver::driver::phase_5_run_llvm_passes::anon::expr_fn::a3 ()\n   from /usr/cn/rust/debug-build/install/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8.so\n#25 0x00007fc9e9b393b9 in util::common::time::hc4d0513e54dc658eam::v0.8 ()\n   from /usr/cn/rust/debug-build/install/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8.so\n#26 0x00007fc9ea20493c in driver::driver::phase_5_run_llvm_passes::h3cbff77e0e5d9b4ac::v0.8 ()\n   from /usr/cn/rust/debug-build/install/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8.so\n#27 0x00007fc9e8e9ee72 in run::h89cbc617ea48a5aah::v0.8 ()\n   from /usr/cn/rust/debug-build/install/bin/../lib/librusti-53e0ef2ae196aaff-0.8.so\n#28 0x00007fc9e8ee516e in run_line::anon::expr_fn::aP ()\n   from /usr/cn/rust/debug-build/install/bin/../lib/librusti-53e0ef2ae196aaff-0.8.so\n#29 0x00007fc9e8edfa66 in task::TaskBuilder::try::anon::expr_fn::_8Nazab ()\n   from /usr/cn/rust/debug-build/install/bin/../lib/librusti-53e0ef2ae196aaff-0.8.so\n#30 0x00007fc9eb9cc95c in task::spawn::spawn_raw::anon::expr_fn::aw ()\n   from /usr/cn/rust/debug-build/install/bin/../lib/libstd-6c65cf4b443341b1-0.8.so\n#31 0x00007fc9eba70174 in rt::task::__extensions__::build_start_wrapper::anon::anon::expr_fn::an ()\n   from /usr/cn/rust/debug-build/install/bin/../lib/libstd-6c65cf4b443341b1-0.8.so\n#32 0x00007fc9eb96c33c in unstable::finally::Finally$__extensions__::finally::h199ab8d6eb2269801oav::v0.8 () from /usr/cn/rust/debug-build/install/bin/../lib/libstd-6c65cf4b443341b1-0.8.so\n#33 0x00007fc9eba6da35 in rt::task::__extensions__::run::anon::expr_fn::aF ()\n   from /usr/cn/rust/debug-build/install/bin/../lib/libstd-6c65cf4b443341b1-0.8.so\n#34 0x00007fc9eba70649 in rt::task::Unwinder::try::try_fn::__rust_abi::jE ()\n   from /usr/cn/rust/debug-build/install/bin/../lib/libstd-6c65cf4b443341b1-0.8.so\n#35 0x00007fc9eba705a7 in rt::task::Unwinder::try::try_fn::hc68c725e5d5aa99fjEaG::v0.8 ()\n   from /usr/cn/rust/debug-build/install/bin/../lib/libstd-6c65cf4b443341b1-0.8.so\n#36 0x00007fc9e8ae664f in rust_try (\n    f=0x7fc9eba70550 <rt::task::Unwinder::try::try_fn::hc68c725e5d5aa99fjEaG::v0.8>, \n    fptr=0x7fc9eba6d9e0, env=0x7fc9e424a348) at src/rt/rust_builtin.cpp:499\n#37 0x00007fc9eba6d902 in rt::task::Unwinder::try::h199ab8d6eb226980jEaE::v0.8 ()\n   from /usr/cn/rust/debug-build/install/bin/../lib/libstd-6c65cf4b443341b1-0.8.so\n#38 0x00007fc9eba6d796 in rt::task::Task::run::h199ab8d6eb226980hnaD::v0.8 ()\n   from /usr/cn/rust/debug-build/install/bin/../lib/libstd-6c65cf4b443341b1-0.8.so\n#39 0x00007fc9eba6fdc7 in rt::task::__extensions__::build_start_wrapper::anon::expr_fn::ae ()\n   from /usr/cn/rust/debug-build/install/bin/../lib/libstd-6c65cf4b443341b1-0.8.so\n#40 0x00007fc9ebb02f35 in rt::context::Context::new::task_start_wrapper::__rust_abi::fF ()\n   from /usr/cn/rust/debug-build/install/bin/../lib/libstd-6c65cf4b443341b1-0.8.so\n#41 0x00007fc9ebb02ee7 in rt::context::Context::new::task_start_wrapper::h1b9fdc38dc3bcfa4fFaM::v0.8\n    () from /usr/cn/rust/debug-build/install/bin/../lib/libstd-6c65cf4b443341b1-0.8.so\n#42 0x0000000000000000 in ?? ()\n(gdb)\n```\n", "closed_by": {"login": "thestinger", "id": 1505226, "node_id": "MDQ6VXNlcjE1MDUyMjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thestinger", "html_url": "https://github.com/thestinger", "followers_url": "https://api.github.com/users/thestinger/followers", "following_url": "https://api.github.com/users/thestinger/following{/other_user}", "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}", "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions", "organizations_url": "https://api.github.com/users/thestinger/orgs", "repos_url": "https://api.github.com/users/thestinger/repos", "events_url": "https://api.github.com/users/thestinger/events{/privacy}", "received_events_url": "https://api.github.com/users/thestinger/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/9567/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/9567/timeline", "performed_via_github_app": null, "state_reason": "completed"}