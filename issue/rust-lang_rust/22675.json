{"url": "https://api.github.com/repos/rust-lang/rust/issues/22675", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/22675/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/22675/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/22675/events", "html_url": "https://github.com/rust-lang/rust/issues/22675", "id": 58508550, "node_id": "MDU6SXNzdWU1ODUwODU1MA==", "number": 22675, "title": "Inconsistent constraint validation on derived trait specializations with associated types", "user": {"login": "knz", "id": 642886, "node_id": "MDQ6VXNlcjY0Mjg4Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/642886?v=4", "gravatar_id": "", "url": "https://api.github.com/users/knz", "html_url": "https://github.com/knz", "followers_url": "https://api.github.com/users/knz/followers", "following_url": "https://api.github.com/users/knz/following{/other_user}", "gists_url": "https://api.github.com/users/knz/gists{/gist_id}", "starred_url": "https://api.github.com/users/knz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/knz/subscriptions", "organizations_url": "https://api.github.com/users/knz/orgs", "repos_url": "https://api.github.com/users/knz/repos", "events_url": "https://api.github.com/users/knz/events{/privacy}", "received_events_url": "https://api.github.com/users/knz/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 37544, "node_id": "MDU6TGFiZWwzNzU0NA==", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-typesystem", "name": "A-typesystem", "color": "f7e101", "default": false, "description": "Area: The type system"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2015-02-22T16:35:04Z", "updated_at": "2016-05-24T20:36:46Z", "closed_at": "2016-05-24T20:36:46Z", "author_association": "NONE", "active_lock_reason": null, "body": "In the code below, rustc should either reject all 3 uses of ApplyT, or none. Currently it only rejects the 3rd one, which is inconsistent:\n\n```\nuse std::marker::PhantomFn;\ntrait TTrans<I> : PhantomFn<(Self,I)> { type O; }\ntype ApplyT<T, A> = <T as TTrans<A>>::O;\n\ntrait Reusable<H> {\n  type E;\n  fn ap<R, F : Fn(Self::E)->R>(self, f : F) -> ApplyT<H, R>;\n}\ntrait Other<H>    {\n  type E;\n  fn ap2<R, F : Fn(Self::E)->R>(self, f : F) -> ApplyT<H, R>;\n}\nimpl<H,T> Reusable<H> for T where T : Other<H>    {\n  type E = <Self as Other<H> >::E;\n  fn ap<R, F : Fn(<Self as Other<H>>::E)->R>(self, f : F) -> ApplyT<H, R> {\n    self.ap2(f)\n  }\n}\nfn main() {}\n```\n\nNote that in all 3 uses of ApplyT, the first parameter H is open. Intuition would dictate that rustc should delay checking whether ApplyT<H,R> is valid until H is known. However, rustc inconsistently does so: the first 2 uses of ApplyT cause no error (suggesting the check is indeed delayed), while the last generates an error:\n\n```\nerror: the trait `TTrans<R>` is not implemented for the type `H` [E0277]\n```\n\nOf course it would be best if the 3rd case would be delayed as well, but if for any reason that proves difficult, at least for the sake of consistency the behavior should be the same in all 3 cases.\n## Meta\n\n```\nrustc 1.0.0-dev (2b01a37ec 2015-02-21) (built 2015-02-21)\ncommit-hash: 2b01a37ec38db9301239f0c0abcf3c695055b0ff\ncommit-date: 2015-02-21\nbuild-date: 2015-02-21\nhost: x86_64-unknown-linux-gnu\nrelease: 1.0.0-dev\n```\n", "closed_by": {"login": "steveklabnik", "id": 27786, "node_id": "MDQ6VXNlcjI3Nzg2", "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/steveklabnik", "html_url": "https://github.com/steveklabnik", "followers_url": "https://api.github.com/users/steveklabnik/followers", "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}", "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}", "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions", "organizations_url": "https://api.github.com/users/steveklabnik/orgs", "repos_url": "https://api.github.com/users/steveklabnik/repos", "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}", "received_events_url": "https://api.github.com/users/steveklabnik/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/22675/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/22675/timeline", "performed_via_github_app": null, "state_reason": "completed"}