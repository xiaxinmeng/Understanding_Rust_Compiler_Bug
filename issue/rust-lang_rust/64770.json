{"url": "https://api.github.com/repos/rust-lang/rust/issues/64770", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/64770/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/64770/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/64770/events", "html_url": "https://github.com/rust-lang/rust/issues/64770", "id": 498407852, "node_id": "MDU6SXNzdWU0OTg0MDc4NTI=", "number": 64770, "title": "Issue with #[used] static being removed", "user": {"login": "axos88", "id": 1281218, "node_id": "MDQ6VXNlcjEyODEyMTg=", "avatar_url": "https://avatars.githubusercontent.com/u/1281218?v=4", "gravatar_id": "", "url": "https://api.github.com/users/axos88", "html_url": "https://github.com/axos88", "followers_url": "https://api.github.com/users/axos88/followers", "following_url": "https://api.github.com/users/axos88/following{/other_user}", "gists_url": "https://api.github.com/users/axos88/gists{/gist_id}", "starred_url": "https://api.github.com/users/axos88/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/axos88/subscriptions", "organizations_url": "https://api.github.com/users/axos88/orgs", "repos_url": "https://api.github.com/users/axos88/repos", "events_url": "https://api.github.com/users/axos88/events{/privacy}", "received_events_url": "https://api.github.com/users/axos88/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1359848690, "node_id": "MDU6TGFiZWwxMzU5ODQ4Njkw", "url": "https://api.github.com/repos/rust-lang/rust/labels/E-needs-mcve", "name": "E-needs-mcve", "color": "02e10c", "default": false, "description": "Call for participation: This issue needs a Minimal Complete and Verifiable Example"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-09-25T16:55:34Z", "updated_at": "2019-09-25T22:10:45Z", "closed_at": "2019-09-25T22:10:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "```\r\n#[derive(Copy, Clone, Eq, PartialEq, Debug)]\r\nenum CRP {\r\n    #[used]\r\n    CRP0 = 0x00000000,  // All functions enabled\r\n    #[used]\r\n    CRP1 = 0x12345678,  // SWD disabled, partial update enabled, except sector 0\r\n    #[used]\r\n    CRP2 = -0x789ABCDF, // 0x87654321,  // SWD disabled, full erase only\r\n    #[used]\r\n    CRP3 = 0x43218765,  // SWD disabled, ISP entry disabled, can only be invoked from user code\r\n    #[used]\r\n    NO_ISP = 0x4E697370 // ISP entry disabled.\r\n}\r\n\r\n#[link_section = \".vector_table.crp\"]\r\n#[used]\r\nstatic crp: CRP = CRP::CRP2;\r\n```\r\n\r\nFor release build it gets removed:\r\n```\r\n$ cargo nm --bin pwmboard --release -- -C | grep crp\r\n    Finished release [optimized + debuginfo] target(s) in 0.03s\r\n  (no output)\r\n```\r\n\r\nFor debug build it's there:\r\n```\r\n$ cargo nm --bin pwmboard -- -C | grep crp\r\n    Finished dev [unoptimized + debuginfo] target(s) in 0.73s\r\n000002fc r pwmboard::crp::hc92a84c06c9e04f7\r\n```\r\n\r\nLinker script:\r\n```\r\nSECTIONS {\r\n  .vector_table.precrp ADDR(.vector_table) + SIZEOF(.vector_table) :\r\n  {\r\n    FILL(0xA5A5A5A5);\r\n    . = 0x000002FC;\r\n  } > FLASH\r\n\r\n  .vector_table.crp . :\r\n  {\r\n    FILL(0xA5A5A5A5);\r\n    KEEP(*(.crp))\r\n    PROVIDE(_stext = .);\r\n  } > FLASH\r\n} INSERT AFTER .vector_table;\r\n```", "closed_by": {"login": "axos88", "id": 1281218, "node_id": "MDQ6VXNlcjEyODEyMTg=", "avatar_url": "https://avatars.githubusercontent.com/u/1281218?v=4", "gravatar_id": "", "url": "https://api.github.com/users/axos88", "html_url": "https://github.com/axos88", "followers_url": "https://api.github.com/users/axos88/followers", "following_url": "https://api.github.com/users/axos88/following{/other_user}", "gists_url": "https://api.github.com/users/axos88/gists{/gist_id}", "starred_url": "https://api.github.com/users/axos88/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/axos88/subscriptions", "organizations_url": "https://api.github.com/users/axos88/orgs", "repos_url": "https://api.github.com/users/axos88/repos", "events_url": "https://api.github.com/users/axos88/events{/privacy}", "received_events_url": "https://api.github.com/users/axos88/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/64770/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/64770/timeline", "performed_via_github_app": null, "state_reason": "completed"}