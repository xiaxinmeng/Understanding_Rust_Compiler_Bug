{"url": "https://api.github.com/repos/rust-lang/rust/issues/65065", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/65065/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/65065/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/65065/events", "html_url": "https://github.com/rust-lang/rust/issues/65065", "id": 502201810, "node_id": "MDU6SXNzdWU1MDIyMDE4MTA=", "number": 65065, "title": "Error while building rustc on Windows MSVC (cl.exe returns 2)", "user": {"login": "mgostIH", "id": 13892786, "node_id": "MDQ6VXNlcjEzODkyNzg2", "avatar_url": "https://avatars.githubusercontent.com/u/13892786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mgostIH", "html_url": "https://github.com/mgostIH", "followers_url": "https://api.github.com/users/mgostIH/followers", "following_url": "https://api.github.com/users/mgostIH/following{/other_user}", "gists_url": "https://api.github.com/users/mgostIH/gists{/gist_id}", "starred_url": "https://api.github.com/users/mgostIH/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mgostIH/subscriptions", "organizations_url": "https://api.github.com/users/mgostIH/orgs", "repos_url": "https://api.github.com/users/mgostIH/repos", "events_url": "https://api.github.com/users/mgostIH/events{/privacy}", "received_events_url": "https://api.github.com/users/mgostIH/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 108333, "node_id": "MDU6TGFiZWwxMDgzMzM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-LLVM", "name": "A-LLVM", "color": "f7e101", "default": false, "description": "Area: Code generation parts specific to LLVM. Both correctness bugs and optimization-related issues."}, {"id": 266005765, "node_id": "MDU6TGFiZWwyNjYwMDU3NjU=", "url": "https://api.github.com/repos/rust-lang/rust/labels/O-windows-msvc", "name": "O-windows-msvc", "color": "6e6ec0", "default": false, "description": "Toolchain: MSVC, Operating system: Windows"}, {"id": 325438536, "node_id": "MDU6TGFiZWwzMjU0Mzg1MzY=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-bootstrap", "name": "T-bootstrap", "color": "bfd4f2", "default": false, "description": "Relevant to the bootstrap subteam: Rust's build system (x.py and src/bootstrap)"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-10-03T17:37:33Z", "updated_at": "2019-11-13T21:39:40Z", "closed_at": "2019-11-13T21:39:40Z", "author_association": "NONE", "active_lock_reason": null, "body": "Building with x.py on Windows, I already have Rust working thru rustup, but I wanted to build a patched rustc.\r\nHowever this error comes before stage1 begins and is related to cl.exe not compiling something I haven't touched; I made sure to update all the submodules with git and solved some errors I had with earlier stages of bootstrapping, but I don't know how to fix this.\r\n\r\nRun with RUST_BACKTRACE=1 on a Git Bash console, OS Windows 7.\r\n\r\nIf you need any more information, sure ask, the error cl gives is quite generic and online I've found the issue could be related to anything.\r\n\r\n```\r\nCompiling rustc_llvm v0.0.0 (C:\\Users\\user\\Desktop\\Coding\\Github\\rust\\src\\librustc_llvm)\r\nerror: failed to run custom build command for `rustc_llvm v0.0.0 (C:\\Users\\user\\Desktop\\Coding\\Github\\rust\\src\\librustc_llvm)`\r\n\r\nCaused by:\r\n  process didn't exit successfully: `C:\\Users\\user\\Desktop\\Coding\\Github\\rust\\build\\x86_64-pc-windows-msvc\\stage0-codegen\\release\\build\\rustc_llvm-53b15cdc99a3c443\\build-script-build` (exit code: 101)\r\n--- stderr\r\nthread 'main' panicked at '\r\n\r\nInternal error occurred: Command \"C:\\\\Program Files (x86)\\\\Microsoft Visual Studio\\\\2017\\\\Community\\\\VC\\\\Tools\\\\MSVC\\\\14.16.27023\\\\bin\\\\HostX64\\\\x64\\\\cl.exe\" \"/nologo\" \"/MT\" \"/O2\" \"-IC:\\\\Users\\\\user\\\\Desktop\\\\Coding\\\\Github\\\\rust\\\\build\\\\x86_64-pc-windows-msvc\\\\llvm\\\\include\" \"/EHs-c-\" \"/GR-\" \"-D_CRT_SECURE_NO_DEPRECATE\" \"-D_CRT_SECURE_NO_WARNINGS\" \"-D_CRT_NONSTDC_NO_DEPRECATE\" \"-D_CRT_NONSTDC_NO_WARNINGS\" \"-D_SCL_SECURE_NO_DEPRECATE\" \"-D_SCL_SECURE_NO_WARNINGS\" \"-DUNICODE\" \"-D_UNICODE\" \"-D__STDC_CONSTANT_MACROS\" \"-D__STDC_FORMAT_MACROS\" \"-D__STDC_LIMIT_MACROS\" \"/DLLVM_COMPONENT_AARCH64\" \"/DLLVM_COMPONENT_ARM\" \"/DLLVM_COMPONENT_ASMPARSER\" \"/DLLVM_COMPONENT_BITREADER\" \"/DLLVM_COMPONENT_BITWRITER\" \"/DLLVM_COMPONENT_HEXAGON\" \"/DLLVM_COMPONENT_INSTRUMENTATION\" \"/DLLVM_COMPONENT_IPO\" \"/DLLVM_COMPONENT_LINKER\" \"/DLLVM_COMPONENT_LTO\" \"/DLLVM_COMPONENT_MIPS\" \"/DLLVM_COMPONENT_MSP430\" \"/DLLVM_COMPONENT_NVPTX\" \"/DLLVM_COMPONENT_POWERPC\" \"/DLLVM_COMPONENT_RISCV\" \"/DLLVM_COMPONENT_SPARC\" \"/DLLVM_COMPONENT_SYSTEMZ\" \"/DLLVM_COMPONENT_WEBASSEMBLY\" \"/DLLVM_COMPONENT_X86\" \"/DLLVM_RUSTLLVM\" \"/DNDEBUG\" \"/FoC:\\\\Users\\\\user\\\\Desktop\\\\Coding\\\\Github\\\\rust\\\\build\\\\x86_64-pc-windows-msvc\\\\stage0-codegen\\\\x86_64-pc-windows-msvc\\\\release\\\\build\\\\rustc_llvm-967e43a15e8972c9\\\\out\\\\../rustllvm\\\\PassWrapper.o\" \"/c\" \"../rustllvm/PassWrapper.cpp\" with args \"cl.exe\" did not execute successfully (status code exit code: 2).\r\n\r\n', C:\\Users\\user\\.cargo\\registry\\src\\github.com-1ecc6299db9ec823\\cc-1.0.35\\src\\lib.rs:2398:5\r\nstack backtrace:\r\n   0: std::sys_common::backtrace::_print::{{impl}}::fmt\r\n             at /rustc/9689670079a48b06b5c440cc41844dab663e9dca\\/src\\libstd\\sys_common\\backtrace.rs:60\r\n   1: core::fmt::write\r\n             at /rustc/9689670079a48b06b5c440cc41844dab663e9dca\\/src\\libcore\\fmt\\mod.rs:1030\r\n   2: std::io::Write::write_fmt<std::sys::windows::stdio::Stderr>\r\n             at /rustc/9689670079a48b06b5c440cc41844dab663e9dca\\/src\\libstd\\io\\mod.rs:1413\r\n   3: std::panicking::default_hook::{{closure}}\r\n             at /rustc/9689670079a48b06b5c440cc41844dab663e9dca\\/src\\libstd\\panicking.rs:196\r\n   4: std::panicking::default_hook\r\n             at /rustc/9689670079a48b06b5c440cc41844dab663e9dca\\/src\\libstd\\panicking.rs:212\r\n   5: std::panicking::rust_panic_with_hook\r\n             at /rustc/9689670079a48b06b5c440cc41844dab663e9dca\\/src\\libstd\\panicking.rs:473\r\n   6: std::panicking::continue_panic_fmt\r\n             at /rustc/9689670079a48b06b5c440cc41844dab663e9dca\\/src\\libstd\\panicking.rs:380\r\n   7: std::panicking::begin_panic_fmt\r\n             at /rustc/9689670079a48b06b5c440cc41844dab663e9dca\\/src\\libstd\\panicking.rs:335\r\n   8: cc::Tool::to_command\r\n   9: cc::Build::compile\r\n  10: alloc::alloc::box_free\r\n  11: alloc::raw_vec::RawVec<T,A>::reserve\r\n  12: std::panicking::try::do_call<closure-0,i32>\r\n             at /rustc/9689670079a48b06b5c440cc41844dab663e9dca\\/src\\libstd\\panicking.rs:292\r\n  13: panic_unwind::__rust_maybe_catch_panic\r\n             at /rustc/9689670079a48b06b5c440cc41844dab663e9dca\\/src\\libpanic_unwind\\lib.rs:80\r\n  14: std::rt::lang_start_internal\r\n             at /rustc/9689670079a48b06b5c440cc41844dab663e9dca\\/src\\libstd\\rt.rs:48\r\n  15: main\r\n  16: __scrt_common_main_seh\r\n             at d:\\agent\\_work\\1\\s\\src\\vctools\\crt\\vcstartup\\src\\startup\\exe_common.inl:288\r\n  17: BaseThreadInitThunk\r\n  18: RtlUserThreadStart\r\nnote: Some details are omitted, run with `RUST_BACKTRACE=full` for a verbose backtrace.\r\n\r\ncommand did not execute successfully: \"C:\\\\Users\\\\user\\\\Desktop\\\\Coding\\\\Github\\\\rust\\\\build\\\\x86_64-pc-windows-msvc\\\\stage0\\\\bin\\\\cargo.exe\" \"build\" \"-Zconfig-profile\" \"--target\" \"x86_64-pc-windows-msvc\" \"-Zbinary-dep-depinfo\" \"-j\" \"4\" \"--release\" \"--manifest-path\" \"C:\\\\Users\\\\user\\\\Desktop\\\\Coding\\\\Github\\\\rust\\\\src/librustc_codegen_llvm/Cargo.toml\" \"--features\" \"\" \"--message-format\" \"json-render-diagnostics\"\r\nexpected success, got: exit code: 101\r\nfailed to run: C:\\Users\\user\\Desktop\\Coding\\Github\\rust\\build\\bootstrap\\debug\\bootstrap build\r\nBuild completed unsuccessfully in 0:11:18\r\n```", "closed_by": {"login": "mgostIH", "id": 13892786, "node_id": "MDQ6VXNlcjEzODkyNzg2", "avatar_url": "https://avatars.githubusercontent.com/u/13892786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mgostIH", "html_url": "https://github.com/mgostIH", "followers_url": "https://api.github.com/users/mgostIH/followers", "following_url": "https://api.github.com/users/mgostIH/following{/other_user}", "gists_url": "https://api.github.com/users/mgostIH/gists{/gist_id}", "starred_url": "https://api.github.com/users/mgostIH/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mgostIH/subscriptions", "organizations_url": "https://api.github.com/users/mgostIH/orgs", "repos_url": "https://api.github.com/users/mgostIH/repos", "events_url": "https://api.github.com/users/mgostIH/events{/privacy}", "received_events_url": "https://api.github.com/users/mgostIH/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/65065/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/65065/timeline", "performed_via_github_app": null, "state_reason": "completed"}