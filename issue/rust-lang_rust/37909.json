{"url": "https://api.github.com/repos/rust-lang/rust/issues/37909", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/37909/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/37909/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/37909/events", "html_url": "https://github.com/rust-lang/rust/issues/37909", "id": 190631182, "node_id": "MDU6SXNzdWUxOTA2MzExODI=", "number": 37909, "title": "panic when compiling with stable after compiling with nightly", "user": {"login": "mbr", "id": 110577, "node_id": "MDQ6VXNlcjExMDU3Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/110577?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mbr", "html_url": "https://github.com/mbr", "followers_url": "https://api.github.com/users/mbr/followers", "following_url": "https://api.github.com/users/mbr/following{/other_user}", "gists_url": "https://api.github.com/users/mbr/gists{/gist_id}", "starred_url": "https://api.github.com/users/mbr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mbr/subscriptions", "organizations_url": "https://api.github.com/users/mbr/orgs", "repos_url": "https://api.github.com/users/mbr/repos", "events_url": "https://api.github.com/users/mbr/events{/privacy}", "received_events_url": "https://api.github.com/users/mbr/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2016-11-21T06:35:48Z", "updated_at": "2016-11-21T15:04:21Z", "closed_at": "2016-11-21T15:04:21Z", "author_association": "NONE", "active_lock_reason": null, "body": "The issue:\r\n\r\n```\r\nerror: internal compiler error: unexpected panic\r\n\r\nnote: the compiler unexpectedly panicked. this is a bug.\r\n\r\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports\r\n\r\nthread 'rustc' panicked at 'index out of bounds: the len is 384143 but the index is 384143', ../src/libserialize/leb128.rs:46\r\nnote: Run with `RUST_BACKTRACE=1` for a backtrace.\r\n```\r\n\r\nWith a backtrace:\r\n\r\n```\r\nerror: internal compiler error: unexpected panic\r\n\r\nnote: the compiler unexpectedly panicked. this is a bug.\r\n\r\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports\r\n\r\nnote: run with `RUST_BACKTRACE=1` for a backtrace\r\n\r\nthread 'rustc' panicked at 'index out of bounds: the len is 384143 but the index is 384143', ../src/libserialize/leb128.rs:46\r\nstack backtrace:\r\n   1:     0x7f999307b85f - std::sys::backtrace::tracing::imp::write::h6f1d53a70916b90d\r\n   2:     0x7f999308adbd - std::panicking::default_hook::{{closure}}::h137e876f7d3b5850\r\n   3:     0x7f999308822e - std::panicking::default_hook::h0ac3811ec7cee78c\r\n   4:     0x7f9993088918 - std::panicking::rust_panic_with_hook::hc303199e04562edf\r\n   5:     0x7f99930887b2 - std::panicking::begin_panic::h6ed03353807cf54d\r\n   6:     0x7f99930886f0 - std::panicking::begin_panic_fmt::hc321cece241bb2f5\r\n   7:     0x7f9993088671 - rust_begin_unwind\r\n   8:     0x7f99930d5fff - core::panicking::panic_fmt::h27224b181f9f037f\r\n   9:     0x7f99930d5fa3 - core::panicking::panic_bounds_check::h19e9bbc59320a57e\r\n  10:     0x7f998c4292ef - <serialize::opaque::Decoder<'a> as serialize::serialize::Decoder>::read_usize::hdb6b9929c2878103\r\n  11:     0x7f9990d02798 - rustc_metadata::decoder::<impl rustc_metadata::cstore::MetadataBlob>::get_root::ha0bece0640a71bb4\r\n  12:     0x7f9990d2b3bf - rustc_metadata::loader::Context::extract_one::h893f537a80fcaa7b\r\n  13:     0x7f9990d28729 - rustc_metadata::loader::Context::find_library_crate::h0ae9ebab39601e07\r\n  14:     0x7f9990d170b9 - rustc_metadata::creader::CrateReader::load::hbbb9048f37b5929d\r\n  15:     0x7f9990d164d8 - rustc_metadata::creader::CrateReader::resolve_crate::h0ea8ce3f005d5018\r\n  16:     0x7f9990d3459a - rustc_metadata::creader::CrateReader::resolve_crate_deps::{{closure}}::hba6352ef73c55dfc\r\n  17:     0x7f9990ca8c16 - <std::collections::hash::map::HashMap<K, V, S> as core::iter::traits::FromIterator<(K, V)>>::from_iter::hfdd794029d934f9e\r\n  18:     0x7f9990d1484f - rustc_metadata::creader::CrateReader::register_crate::h5c79c40329468538\r\n  19:     0x7f9990d1b8bb - rustc_metadata::creader::CrateReader::read_macros::hbcdddd25556965a6\r\n  20:     0x7f9990d2e5db - rustc_metadata::macro_import::load_macros::hf8ed055f967f056a\r\n  21:     0x7f9990d20d0b - <rustc_metadata::creader::CrateLoader<'a> as rustc::middle::cstore::CrateLoader>::load_macros::h1c3dc5592ec08b80\r\n  22:     0x7f9992675104 - <rustc_resolve::macros::ExpansionVisitor<'a, 'b> as syntax::visit::Visitor>::visit_item::he806776e3c2c5c85\r\n  23:     0x7f999266c2ef - syntax::visit::walk_item::h9ee859a018283218\r\n  24:     0x7f9992675eaa - <rustc_resolve::macros::ExpansionVisitor<'a, 'b> as syntax::visit::Visitor>::visit_item::he806776e3c2c5c85\r\n  25:     0x7f9992672b9a - rustc_resolve::macros::<impl syntax::ext::base::Resolver for rustc_resolve::Resolver<'a>>::visit_expansion::h095f31c8c14629f1\r\n  26:     0x7f998cc720e6 - syntax::ext::expand::MacroExpander::collect_invocations::h3001d1fc85715c10\r\n  27:     0x7f998cc6e432 - syntax::ext::expand::MacroExpander::expand::hba1d6fcc6652f3dc\r\n  28:     0x7f998cc6dc92 - syntax::ext::expand::MacroExpander::expand_crate::hee7239fe3665f838\r\n  29:     0x7f998cc79eed - syntax::ext::expand::expand_crate::h9213ee787f1c5e5d\r\n  30:     0x7f9993446b5d - rustc_driver::driver::phase_2_configure_and_expand::{{closure}}::hb36e77d125a4fd93\r\n  31:     0x7f99933fb48f - rustc_driver::driver::phase_2_configure_and_expand::h2f62e5b496da5c2b\r\n  32:     0x7f99933f4efb - rustc_driver::driver::compile_input::hef221f9f618e92f5\r\n  33:     0x7f9993421206 - rustc_driver::run_compiler::h7dddd4089f8330b4\r\n  34:     0x7f999335d2c3 - std::panicking::try::do_call::h1e3ece12e3f812df\r\n  35:     0x7f9993092cb6 - __rust_maybe_catch_panic\r\n  36:     0x7f999337b4f9 - <F as alloc::boxed::FnBox<A>>::call_box::h05b222e46803eb30\r\n  37:     0x7f9993086c80 - std::sys::thread::Thread::new::thread_start::h759e10bc4abc7e72\r\n  38:     0x7f998bfef0a3 - start_thread\r\n  39:     0x7f9992d4a62c - clone\r\n  40:                0x0 - <unknown>\r\n```\r\n\r\n## Steps to reproduce:\r\n\r\n0. `rustup default stable`\r\n1. `cargo clean`\r\n2. `rustup run nightly cargo build`\r\n3. `cargo build`\r\n\r\nA workaround is calling `cargo clean` between steps 2 and 3.\r\n\r\n## Versions\r\n\r\n### Stable\r\n\r\n* `cargo 0.13.0-nightly (eca9e15 2016-11-01)`\r\n* `rustc 1.13.0 (2c6933acc 2016-11-07)`\r\n\r\n### Nightly\r\n\r\n* `cargo 0.16.0-nightly (d1bfc01 2016-11-18)`\r\n* `rustc 1.15.0-nightly (0bd2ce62b 2016-11-19)`\r\n", "closed_by": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/37909/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/37909/timeline", "performed_via_github_app": null, "state_reason": "completed"}