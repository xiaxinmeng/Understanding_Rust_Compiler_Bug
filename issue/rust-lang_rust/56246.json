{"url": "https://api.github.com/repos/rust-lang/rust/issues/56246", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/56246/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/56246/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/56246/events", "html_url": "https://github.com/rust-lang/rust/issues/56246", "id": 384436611, "node_id": "MDU6SXNzdWUzODQ0MzY2MTE=", "number": 56246, "title": "Compiling with GCC fails", "user": {"login": "pkubaj", "id": 4457924, "node_id": "MDQ6VXNlcjQ0NTc5MjQ=", "avatar_url": "https://avatars.githubusercontent.com/u/4457924?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pkubaj", "html_url": "https://github.com/pkubaj", "followers_url": "https://api.github.com/users/pkubaj/followers", "following_url": "https://api.github.com/users/pkubaj/following{/other_user}", "gists_url": "https://api.github.com/users/pkubaj/gists{/gist_id}", "starred_url": "https://api.github.com/users/pkubaj/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pkubaj/subscriptions", "organizations_url": "https://api.github.com/users/pkubaj/orgs", "repos_url": "https://api.github.com/users/pkubaj/repos", "events_url": "https://api.github.com/users/pkubaj/events{/privacy}", "received_events_url": "https://api.github.com/users/pkubaj/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 311417404, "node_id": "MDU6TGFiZWwzMTE0MTc0MDQ=", "url": "https://api.github.com/repos/rust-lang/rust/labels/O-freebsd", "name": "O-freebsd", "color": "6e6ec0", "default": false, "description": "Operating system: FreeBSD"}, {"id": 515028847, "node_id": "MDU6TGFiZWw1MTUwMjg4NDc=", "url": "https://api.github.com/repos/rust-lang/rust/labels/O-PowerPC", "name": "O-PowerPC", "color": "6e6ec0", "default": false, "description": "Target: PowerPC processors"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-11-26T17:33:37Z", "updated_at": "2019-03-21T04:31:22Z", "closed_at": "2019-03-21T04:31:22Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I'm porting Rust to FreeBSD/powerpc64 platform. The system compiler on this platform is currently GCC 4.2. There is work to migrate to LLVM, but support for FreeBSD/powerpc64 only appeared in 8.0, so I can't use it. Since it's not possible to compile Rust GCC 4.2, I use GCC 6 crosscompiler for powerpc64 (I compile on amd64).\r\n\r\nThe problem is that CXXFLAGS are based on what `llvm-config` emits and it emits flags that GCC 6 doesn't support.\r\n\r\n```\r\nBuilding stage1 codegen artifacts (x86_64-unknown-freebsd -> powerpc64-unknown-freebsd, llvm)\r\n   Compiling rustc_llvm v0.0.0 (file:///usr/ports/lang/rust/work/rustc-1.30.1-src/src/librustc_llvm)\r\nerror: failed to run custom build command for `rustc_llvm v0.0.0 (file:///usr/ports/lang/rust/work/rustc-1.30.1-src/src/librustc_llvm)`\r\nprocess didn't exit successfully: `/usr/ports/lang/rust/work/rustc-1.30.1-src/build/x86_64-unknown-freebsd/stage1-codegen/release/build/rustc_llvm-75b3b248c6c55afc/build-script-build` (exit code: 101)\r\n--- stdout\r\ncargo:rerun-if-changed=/usr/ports/lang/rust/work/rustc-1.30.1-src/build/x86_64-unknown-freebsd/llvm/build/bin/llvm-config\r\ncargo:rerun-if-env-changed=LLVM_CONFIG\r\ncargo:rustc-cfg=llvm_component=\"aarch64\"\r\ncargo:rustc-cfg=llvm_component=\"arm\"\r\ncargo:rustc-cfg=llvm_component=\"asmparser\"\r\ncargo:rustc-cfg=llvm_component=\"bitreader\"\r\ncargo:rustc-cfg=llvm_component=\"bitwriter\"\r\ncargo:rustc-cfg=llvm_component=\"hexagon\"\r\ncargo:rustc-cfg=llvm_component=\"instrumentation\"\r\ncargo:rustc-cfg=llvm_component=\"interpreter\"\r\ncargo:rustc-cfg=llvm_component=\"ipo\"\r\ncargo:rustc-cfg=llvm_component=\"linker\"\r\ncargo:rustc-cfg=llvm_component=\"lto\"\r\ncargo:rustc-cfg=llvm_component=\"mcjit\"\r\ncargo:rustc-cfg=llvm_component=\"mips\"\r\ncargo:rustc-cfg=llvm_component=\"msp430\"\r\ncargo:rustc-cfg=llvm_component=\"nvptx\"\r\ncargo:rustc-cfg=llvm_component=\"powerpc\"\r\ncargo:rustc-cfg=llvm_component=\"sparc\"\r\ncargo:rustc-cfg=llvm_component=\"systemz\"\r\ncargo:rustc-cfg=llvm_component=\"x86\"\r\ncargo:rerun-if-changed-env=LLVM_RUSTLLVM\r\ncargo:rerun-if-changed=../rustllvm/RustWrapper.cpp\r\ncargo:rerun-if-changed=../rustllvm/llvm-rebuild-trigger\r\ncargo:rerun-if-changed=../rustllvm/ArchiveWrapper.cpp\r\ncargo:rerun-if-changed=../rustllvm/Linker.cpp\r\ncargo:rerun-if-changed=../rustllvm/PassWrapper.cpp\r\ncargo:rerun-if-changed=../rustllvm/.editorconfig\r\ncargo:rerun-if-changed=../rustllvm/README\r\ncargo:rerun-if-changed=../rustllvm/rustllvm.h\r\nTARGET = Some(\"powerpc64-unknown-freebsd\")\r\nOPT_LEVEL = Some(\"2\")\r\nHOST = Some(\"x86_64-unknown-freebsd\")\r\nCXX_powerpc64-unknown-freebsd = Some(\"powerpc64-unknown-freebsd-g++\")\r\nCXXFLAGS_powerpc64-unknown-freebsd = Some(\"-ffunction-sections -fdata-sections -fPIC -m64\")\r\nDEBUG = Some(\"false\")\r\nrunning: \"powerpc64-unknown-freebsd-g++\" \"-O2\" \"-ffunction-sections\" \"-fdata-sections\" \"-fPIC\" \"-ffunction-sections\" \"-fdata-sections\" \"-fPIC\" \"-m64\" \"-m64\" \"-I/usr/ports/lang/rust/work/rustc-1.30.1-src/src/llvm/include\" \"-I/usr/ports/lang/rust/work/rustc-1.30.1-src/build/x86_64-unknown-freebsd/llvm/build/include\" \"-ffunction-sections\" \"-fdata-sections\" \"-fPIC\" \"-fPIC\" \"-fvisibility-inlines-hidden\" \"-Werror=date-time\" \"-Werror=unguarded-availability-new\" \"-std=c++11\" \"-Wall\" \"-Wextra\" \"-Wno-unused-parameter\" \"-Wwrite-strings\" \"-Wcast-qual\" \"-Wmissing-field-initializers\" \"-pedantic\" \"-Wno-long-long\" \"-Wcovered-switch-default\" \"-Wnon-virtual-dtor\" \"-Wdelete-non-virtual-dtor\" \"-Wstring-conversion\" \"-ffunction-sections\" \"-fdata-sections\" \"-O3\" \"-DNDEBUG\" \"-fno-exceptions\" \"-fno-rtti\" \"-D__STDC_CONSTANT_MACROS\" \"-D__STDC_FORMAT_MACROS\" \"-D__STDC_LIMIT_MACROS\" \"-DLLVM_COMPONENT_AARCH64\"\r\n\"-DLLVM_COMPONENT_ARM\" \"-DLLVM_COMPONENT_ASMPARSER\" \"-DLLVM_COMPONENT_BITREADER\" \"-DLLVM_COMPONENT_BITWRITER\" \"-DLLVM_COMPONENT_HEXAGON\" \"-DLLVM_COMPONENT_INSTRUMENTATION\" \"-DLLVM_COMPONENT_INTERPRETER\" \"-DLLVM_COMPONENT_IPO\" \"-DLLVM_COMPONENT_LINKER\" \"-DLLVM_COMPONENT_LTO\" \"-DLLVM_COMPONENT_MCJIT\" \"-DLLVM_COMPONENT_MIPS\" \"-DLLVM_COMPONENT_MSP430\" \"-DLLVM_COMPONENT_NVPTX\" \"-DLLVM_COMPONENT_POWERPC\" \"-DLLVM_COMPONENT_SPARC\" \"-DLLVM_COMPONENT_SYSTEMZ\" \"-DLLVM_COMPONENT_X86\" \"-DLLVM_RUSTLLVM\" \"-o\" \"/usr/ports/lang/rust/work/rustc-1.30.1-src/build/x86_64-unknown-freebsd/stage1-codegen/powerpc64-unknown-freebsd/release/build/rustc_llvm-497437f0387023af/out/../rustllvm/PassWrapper.o\" \"-c\" \"../rustllvm/PassWrapper.cpp\"\r\ncargo:warning=powerpc64-unknown-freebsd12.0-g++: error: unrecognized command line option '-Wcovered-switch-default'; did you mean '-Wno-switch-default'?\r\ncargo:warning=powerpc64-unknown-freebsd12.0-g++: error: unrecognized command line option '-Wstring-conversion'; did you mean '-Wint-conversion'?\r\nexit code: 1\r\n```\r\n\r\nIs there any way `-Wcovered-switch-default` and `-Wstring-conversion` could be removed?\r\n", "closed_by": {"login": "pkubaj", "id": 4457924, "node_id": "MDQ6VXNlcjQ0NTc5MjQ=", "avatar_url": "https://avatars.githubusercontent.com/u/4457924?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pkubaj", "html_url": "https://github.com/pkubaj", "followers_url": "https://api.github.com/users/pkubaj/followers", "following_url": "https://api.github.com/users/pkubaj/following{/other_user}", "gists_url": "https://api.github.com/users/pkubaj/gists{/gist_id}", "starred_url": "https://api.github.com/users/pkubaj/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pkubaj/subscriptions", "organizations_url": "https://api.github.com/users/pkubaj/orgs", "repos_url": "https://api.github.com/users/pkubaj/repos", "events_url": "https://api.github.com/users/pkubaj/events{/privacy}", "received_events_url": "https://api.github.com/users/pkubaj/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/56246/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/56246/timeline", "performed_via_github_app": null, "state_reason": "completed"}