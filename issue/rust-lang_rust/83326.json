{"url": "https://api.github.com/repos/rust-lang/rust/issues/83326", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/83326/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/83326/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/83326/events", "html_url": "https://github.com/rust-lang/rust/issues/83326", "id": 836903430, "node_id": "MDU6SXNzdWU4MzY5MDM0MzA=", "number": 83326, "title": "Handing Ctrl+C in test harness", "user": {"login": "clarfonthey", "id": 15850505, "node_id": "MDQ6VXNlcjE1ODUwNTA1", "avatar_url": "https://avatars.githubusercontent.com/u/15850505?v=4", "gravatar_id": "", "url": "https://api.github.com/users/clarfonthey", "html_url": "https://github.com/clarfonthey", "followers_url": "https://api.github.com/users/clarfonthey/followers", "following_url": "https://api.github.com/users/clarfonthey/following{/other_user}", "gists_url": "https://api.github.com/users/clarfonthey/gists{/gist_id}", "starred_url": "https://api.github.com/users/clarfonthey/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/clarfonthey/subscriptions", "organizations_url": "https://api.github.com/users/clarfonthey/orgs", "repos_url": "https://api.github.com/users/clarfonthey/repos", "events_url": "https://api.github.com/users/clarfonthey/events{/privacy}", "received_events_url": "https://api.github.com/users/clarfonthey/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 630652267, "node_id": "MDU6TGFiZWw2MzA2NTIyNjc=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-feature-request", "name": "C-feature-request", "color": "f5f1fd", "default": false, "description": "Category: A feature request, i.e: not implemented / a PR."}, {"id": 630810559, "node_id": "MDU6TGFiZWw2MzA4MTA1NTk=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-libtest", "name": "A-libtest", "color": "f7e101", "default": false, "description": "Area: #[test] related"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-03-20T20:24:18Z", "updated_at": "2021-03-22T16:57:57Z", "closed_at": null, "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Right now, sending a Ctrl+C (SIGINT) as the test harness runs simply runs the default signal handler from the OS, which ends the process as soon as possible. It would be more ideal to handle this signal and end the harness more gracefully. Here's sort of what I have in mind:\r\n\r\n1. If the user presses Ctrl+C once, the harness will mark all tests that haven't started as ignored, wait for the currently running tests to finish, and then show the test results.\r\n2. If the user presses Ctrl+C twice, show results after the first thread finishes running a test, without waiting for all tests to finish. This could act as a safeguard in case one test is hanging. The remaining threads will terminate regardless after results are printed when the process exits.\r\n3. If the user presses Ctrl+C thrice, exit immediately.\r\n\r\nNote that the second ctrl+C is only useful if more than one thread is running or if there are fewer hanging tests than running threads, but it seems reasonable to cover the case where one thread is hanging but the rest have finished.\r\n\r\nNote that right now, this would require relying on an external crate like `ctrlc` since there's no built-in Rust way to do this, but I think that adding this option at least on platforms that support it would be extremely helpful.", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/83326/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/83326/timeline", "performed_via_github_app": null, "state_reason": null}