{"url": "https://api.github.com/repos/rust-lang/rust/issues/39982", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/39982/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/39982/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/39982/events", "html_url": "https://github.com/rust-lang/rust/issues/39982", "id": 208962078, "node_id": "MDU6SXNzdWUyMDg5NjIwNzg=", "number": 39982, "title": "error: internal compiler error: unexpected panic, with `fold.rs` `fold_macro`", "user": {"login": "qorost", "id": 16805801, "node_id": "MDQ6VXNlcjE2ODA1ODAx", "avatar_url": "https://avatars.githubusercontent.com/u/16805801?v=4", "gravatar_id": "", "url": "https://api.github.com/users/qorost", "html_url": "https://github.com/qorost", "followers_url": "https://api.github.com/users/qorost/followers", "following_url": "https://api.github.com/users/qorost/following{/other_user}", "gists_url": "https://api.github.com/users/qorost/gists{/gist_id}", "starred_url": "https://api.github.com/users/qorost/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/qorost/subscriptions", "organizations_url": "https://api.github.com/users/qorost/orgs", "repos_url": "https://api.github.com/users/qorost/repos", "events_url": "https://api.github.com/users/qorost/events{/privacy}", "received_events_url": "https://api.github.com/users/qorost/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-02-20T19:13:48Z", "updated_at": "2017-02-20T19:33:21Z", "closed_at": "2017-02-20T19:33:21Z", "author_association": "NONE", "active_lock_reason": null, "body": "<short summary of the bug>\r\nI tried to write a plugin to annotate my code. So I overrides `Folder` to write my plugin. The plugin succeeded in compiling, but when I imported the plugin to my project, it failed with  \r\n\r\n\r\n```\r\nerror: internal compiler error: unexpected panic\r\n\r\nnote: the compiler unexpectedly panicked. this is a bug.\r\n\r\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports\r\n\r\nthread 'rustc' panicked at 'fold_mac disabled by default', /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libsyntax/fold.rs:180\r\nnote: Run with `RUST_BACKTRACE=1` for a backtrace.\r\n\r\n```\r\n\r\n## Meta\r\n\r\n`rustc --version --verbose`:\r\n```\r\nrustc 1.17.0-nightly (ea7a6486a 2017-02-04)\r\nbinary: rustc\r\ncommit-hash: ea7a6486a26af085862cd7a5596bb69e83d85e12\r\ncommit-date: 2017-02-04\r\nhost: x86_64-unknown-linux-gnu\r\nrelease: 1.17.0-nightly\r\nLLVM version: 3.9\r\n```\r\nBacktrace:\r\n```\r\nthread 'rustc' panicked at 'fold_mac disabled by default', /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libsyntax/fold.rs:180\r\nstack backtrace:\r\n   1:     0x7f4b0054746c - std::sys::imp::backtrace::tracing::imp::write::hf7294f5e24536b4a\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libstd/sys/unix/backtrace/tracing/gcc_s.rs:42\r\n   2:     0x7f4b0055591e - std::panicking::default_hook::{{closure}}::h9a07d0b00c43fbee\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libstd/panicking.rs:351\r\n   3:     0x7f4b005554c3 - std::panicking::default_hook::hf25feff2d08bf39b\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libstd/panicking.rs:361\r\n   4:     0x7f4b00555dbb - std::panicking::rust_panic_with_hook::h4cb8c6fbb8386ccf\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libstd/panicking.rs:555\r\n   5:     0x7f4af553a183 - std::panicking::begin_panic::h942f31d05ff9d837\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libstd/panicking.rs:517\r\n   6:     0x7f4af559246d - syntax::fold::Folder::fold_mac::hefcb7e19f28b1461\r\n                        at /home/huang/Desktop/Rust/sfi/fine-unsafe/fine-unsafe/<panic macros>:3\r\n   7:     0x7f4af5589d27 - syntax::fold::noop_fold_stmt_kind::{{closure}}::h2bf26da7bd042844\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libsyntax/fold.rs:1321\r\n   8:     0x7f4af551c58a - <syntax::ptr::P<T>>::map::h2df2a20d3ed8cbfd\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libsyntax/ptr.rs:86\r\n   9:     0x7f4af558988f - syntax::fold::noop_fold_stmt_kind::h3611ee7245deccb6\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libsyntax/fold.rs:1320\r\n  10:     0x7f4af5583350 - syntax::fold::noop_fold_stmt::h370d66b83338fa0b\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libsyntax/fold.rs:1305\r\n  11:     0x7f4af5592ad4 - syntax::fold::Folder::fold_stmt::h2ef5c614340db0c3\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libsyntax/fold.rs:100\r\n  12:     0x7f4af558384e - syntax::fold::noop_fold_block::{{closure}}::{{closure}}::ha98c25f04360420d\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libsyntax/fold.rs:854\r\n  13:     0x7f4af55a96f1 - <collections::vec::Vec<T> as syntax::util::move_map::MoveMap<T>>::move_flat_map::h8ef2372e321353ce\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libsyntax/util/move_map.rs:40\r\n  14:     0x7f4af55836dc - syntax::fold::noop_fold_block::{{closure}}::hedb708829b40ffe5\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libsyntax/fold.rs:854\r\n  15:     0x7f4af551c861 - <syntax::ptr::P<T>>::map::h33479a26b5464bee\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libsyntax/ptr.rs:86\r\n  16:     0x7f4af5583573 - syntax::fold::noop_fold_block::h26da07b7cfc9d89a\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libsyntax/fold.rs:852\r\n  17:     0x7f4af559004c - syntax::fold::Folder::fold_block::hadb106a75830ef3a\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libsyntax/fold.rs:96\r\n  18:     0x7f4af558741e - syntax::fold::noop_fold_item_kind::hc5ba0bc792ec825b\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libsyntax/fold.rs:875\r\n  19:     0x7f4af5590bea - syntax::fold::Folder::fold_item_kind::h7fe0e8b663620147\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libsyntax/fold.rs:80\r\n  20:     0x7f4af558c1c8 - syntax::fold::noop_fold_item_simple::h5c21c96c18447284\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libsyntax/fold.rs:1027\r\n  21:     0x7f4af559134a - syntax::fold::Folder::fold_item_simple::he51a2fd5863a591d\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libsyntax/fold.rs:72\r\n  22:     0x7f4af5582dc9 - syntax::fold::noop_fold_item::{{closure}}::h38fdefde631a2eca\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libsyntax/fold.rs:1016\r\n  23:     0x7f4af551e284 - <syntax::ptr::P<T>>::map::hd8485117d8c4a23a\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libsyntax/ptr.rs:86\r\n  24:     0x7f4af5582c91 - syntax::fold::noop_fold_item::heeb63a42787ce36a\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libsyntax/fold.rs:1016\r\n  25:     0x7f4af559293b - syntax::fold::Folder::fold_item::h3a1fc04ebed254fe\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libsyntax/fold.rs:68\r\n  26:     0x7f4af55c404e - myplugin::plugin_registrar::{{closure}}::hcc2818d567d33c99\r\n                        at /home/huang/Desktop/Rust/sfi/fine-unsafe/fine-unsafe/myplugin/src/lib.rs:165\r\n  27:     0x7f4af5564431 - <F as syntax::ext::base::MultiItemModifier>::expand::h073db6609c74d7e4\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libsyntax/ext/base.rs:135\r\n  28:     0x7f4af91d263a - syntax::ext::expand::MacroExpander::expand_invoc::h8c740b40c25e30d1\r\n  29:     0x7f4af91cfd4d - syntax::ext::expand::MacroExpander::expand::h32c0cdf50a69c606\r\n  30:     0x7f4af91cf285 - syntax::ext::expand::MacroExpander::expand_crate::h1c8ecd75edc55074\r\n  31:     0x7f4b008e231c - rustc_driver::driver::phase_2_configure_and_expand::{{closure}}::h03b336c71cb87528\r\n  32:     0x7f4b008d97f5 - rustc_driver::driver::phase_2_configure_and_expand::h026284537f8f8432\r\n  33:     0x7f4b008d240a - rustc_driver::driver::compile_input::hab977ae496b3a6f1\r\n  34:     0x7f4b0091e594 - rustc_driver::run_compiler::h81290683db66a63c\r\n  35:     0x7f4b0082ae7b - std::panicking::try::do_call::h00942d7a5d04424f\r\n  36:     0x7f4b0055ebfa - __rust_maybe_catch_panic\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libpanic_unwind/lib.rs:98\r\n  37:     0x7f4b008531c2 - <F as alloc::boxed::FnBox<A>>::call_box::hd87f7ab2fccbd670\r\n  38:     0x7f4b00554774 - std::sys::imp::thread::Thread::new::thread_start::hc16926852e47c008\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/liballoc/boxed.rs:623\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libstd/sys_common/thread.rs:21\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libstd/sys/unix/thread.rs:84\r\n  39:     0x7f4af830a6b9 - start_thread\r\n  40:     0x7f4b0020a82c - clone\r\n  41:                0x0 - <unknown>\r\n```", "closed_by": {"login": "qorost", "id": 16805801, "node_id": "MDQ6VXNlcjE2ODA1ODAx", "avatar_url": "https://avatars.githubusercontent.com/u/16805801?v=4", "gravatar_id": "", "url": "https://api.github.com/users/qorost", "html_url": "https://github.com/qorost", "followers_url": "https://api.github.com/users/qorost/followers", "following_url": "https://api.github.com/users/qorost/following{/other_user}", "gists_url": "https://api.github.com/users/qorost/gists{/gist_id}", "starred_url": "https://api.github.com/users/qorost/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/qorost/subscriptions", "organizations_url": "https://api.github.com/users/qorost/orgs", "repos_url": "https://api.github.com/users/qorost/repos", "events_url": "https://api.github.com/users/qorost/events{/privacy}", "received_events_url": "https://api.github.com/users/qorost/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/39982/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/39982/timeline", "performed_via_github_app": null, "state_reason": "completed"}