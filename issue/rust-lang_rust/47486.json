{"url": "https://api.github.com/repos/rust-lang/rust/issues/47486", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/47486/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/47486/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/47486/events", "html_url": "https://github.com/rust-lang/rust/issues/47486", "id": 288830168, "node_id": "MDU6SXNzdWUyODg4MzAxNjg=", "number": 47486, "title": "Trait with associated function with \"where self:Sized\" cannot be made into an object and results in compiler bug.", "user": {"login": "mihaiandrei1294", "id": 14346004, "node_id": "MDQ6VXNlcjE0MzQ2MDA0", "avatar_url": "https://avatars.githubusercontent.com/u/14346004?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mihaiandrei1294", "html_url": "https://github.com/mihaiandrei1294", "followers_url": "https://api.github.com/users/mihaiandrei1294/followers", "following_url": "https://api.github.com/users/mihaiandrei1294/following{/other_user}", "gists_url": "https://api.github.com/users/mihaiandrei1294/gists{/gist_id}", "starred_url": "https://api.github.com/users/mihaiandrei1294/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mihaiandrei1294/subscriptions", "organizations_url": "https://api.github.com/users/mihaiandrei1294/orgs", "repos_url": "https://api.github.com/users/mihaiandrei1294/repos", "events_url": "https://api.github.com/users/mihaiandrei1294/events{/privacy}", "received_events_url": "https://api.github.com/users/mihaiandrei1294/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}, {"id": 46741598, "node_id": "MDU6TGFiZWw0Njc0MTU5OA==", "url": "https://api.github.com/repos/rust-lang/rust/labels/E-needs-test", "name": "E-needs-test", "color": "02e10c", "default": false, "description": "Call for participation: writing correctness tests"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-01-16T09:03:31Z", "updated_at": "2019-10-14T13:51:29Z", "closed_at": "2019-10-14T13:51:29Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello, I have tried to create a Vector of structs which contain a box of the said trait. The compiler complains that the trait cannot be made into an object but adds that it is a compiler bug, thus I thought it is good to report it. The compiler error is Ty::fn_sig() called on non-fn type: [type error]. There is another issue here about this error but it seemed to not have anything to do with my own issue. And it seemed to be fixed, which clearly is not true in my own case.\r\n\r\nA simplified version of my code that results in this error is found bellow and also on rust-playground here: https://play.rust-lang.org/?gist=445a7d67831cf9255d7158b10a14267c&version=stable.\r\n\r\n    pub trait Observable{\r\n        fn get_number_of_phases() -> usize where Self: Sized;\r\n        fn get_elements(&self) -> Box<[f64; Observable::get_number_of_phases()]>;\r\n    }\r\n\r\n    struct Sensor<T: Observable>{\r\n        observed_item: Box<T>,\r\n    }\r\n\r\n    impl<T: Observable> Sensor<T>{\r\n        pub fn new(observed_item:T) -> Sensor<T>{\r\n            Sensor{ observed_item: Box::new(observed_item),}\r\n        }\r\n        pub fn get_elements(&self) -> Box<[f64; <Sensor<T> as Observable>::get_elements()]>{\r\n            return self.observed_item.get_elements(self.sensor_dependencies.clone());\r\n        }\r\n    }\r\n\r\n    pub struct Agent{\r\n        sensor_list: Vec<Box<Sensor<Observable>>>,\r\n    }\r\n\r\n    impl Agent{\r\n        pub fn new(sensor_list: Vec<Sensor<Observable>>) -> Agent {\r\n            Agent{sensor_list,}\r\n        }\r\n    }\r\n\r\nfn main() {}\r\n\r\nI expected it to compile but it doesn't because Observable + 'static is not Sized. It also seems to be a compiler bug.\r\n\r\n##Meta\r\n\r\nerror[E0277]: the trait bound `environment::base::Observable + 'static: std::marker::Sized` is not satisfied\r\n  --> src\\environment\\agent.rs:29:5\r\n   |\r\n29 |     sensor_list: Vec<Box<Sensor<Observable>>>,\r\n   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ `environment::base::Observable + 'static` does not have a constant size known at compile-time\r\n   |\r\n   = help: the trait `std::marker::Sized` is not implemented for `environment::base::Observable + 'static`\r\n   = note: required by `environment::agent::Sensor`\r\n\r\nerror: internal compiler error: src\\librustc\\ty\\sty.rs:1372: Ty::fn_sig() called on non-fn type: [type error]\r\n\r\nnote: the compiler unexpectedly panicked. this is a bug.\r\n\r\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports\r\n\r\nnote: rustc 1.23.0 (766bd11c8 2018-01-01) running on x86_64-pc-windows-msvc\r\n\r\nnote: run with `RUST_BACKTRACE=1` for a backtrace\r\n\r\nthread 'rustc' panicked at 'Box<Any>', src\\librustc_errors\\lib.rs:471:8\r\nstack backtrace:\r\n   0:     0x7fff393d4e79 - _rdl_grow_in_place\r\n   1:     0x7fff393e6087 - std::panicking::Location::column::h28b40ec705c5e546\r\n   2:     0x7fff393e5cec - std::panicking::Location::column::h28b40ec705c5e546\r\n   3:     0x7fff393e66f1 - std::panicking::rust_panic_with_hook::h73a8ba19426dc4bc\r\n   4:     0x7fff3ae1b34a - <rustc_errors::diagnostic::SubDiagnostic as core::fmt::Debug>::fmt::h08690ad2ee761904\r\n   5:     0x7fff3ae357da - rustc_errors::Handler::bug::h1df8c4362c5e9846\r\n   6:     0x7fff3098fe7b - <rustc::ty::wf::Elaborate as core::fmt::Debug>::fmt::h22b02d36e9142746\r\n   7:     0x7fff30c32ed3 - rustc::ty::context::tls::span_debug::h25c529b6124f7a16\r\n   8:     0x7fff307de95e - rustc::session::bug_fmt::h396c28161718f8dd\r\n   9:     0x7fff307de852 - rustc::session::bug_fmt::h396c28161718f8dd\r\n  10:     0x7fff30736157 - rustc::ty::sty::<impl rustc::ty::TyS<'tcx>>::fn_sig::h3050bc278b64335e\r\n  11:     0x7fff3a781d36 - <rustc_mir::transform::check_unsafety::UnsafetyChecker<'a, 'tcx> as rustc::mir::visit::Visitor<'tcx>>::visit_terminator::h07052d3174ac97c7\r\n  12:     0x7fff3a783148 - <rustc_mir::transform::check_unsafety::UnusedUnsafeVisitor<'a> as rustc::hir::intravisit::Visitor<'tcx>>::visit_block::he2f578b5192e2ac0\r\n  13:     0x7fff30880c67 - rustc::ty::maps::<impl rustc::ty::maps::queries::unsafety_check_result<'tcx>>::ensure::h633f3ed20418ac43\r\n  14:     0x7fff30a68524 - rustc::dep_graph::graph::DepGraph::in_ignore::hf1d621baac1d7bf2\r\n  15:     0x7fff3074977e - rustc::util::ppaux::<impl core::fmt::Debug for rustc::ty::Predicate<'tcx>>::fmt::h676d3496cb3708f4\r\n  16:     0x7fff30c140c4 - <rustc::ty::_match::Match<'a, 'gcx, 'tcx> as rustc::ty::relate::TypeRelation<'a, 'gcx, 'tcx>>::tys::haf26cce42371d08b\r\n  17:     0x7fff30880d19 - rustc::ty::maps::<impl rustc::ty::maps::queries::unsafety_check_result<'tcx>>::ensure::h633f3ed20418ac43\r\n  18:     0x7fff3088165e - rustc::ty::maps::<impl rustc::ty::maps::queries::unsafety_check_result<'tcx>>::try_get::h415a98161b8c76f9\r\n  19:     0x7fff30a0476e - rustc::ty::maps::TyCtxtAt::unsafety_check_result::hf9206933e91c0e2d\r\n  20:     0x7fff30c3b70d - rustc::ty::maps::<impl rustc::ty::context::TyCtxt<'a, 'tcx, 'lcx>>::unsafety_check_result::h2a6c52c0475f25cd\r\n  21:     0x7fff3a75faa9 - rustc_mir::transform::mir_const::hea73cb1a351842f2\r\n  22:     0x7fff3087af7f - rustc::ty::maps::<impl rustc::ty::maps::queries::mir_const<'tcx>>::ensure::ha8f1c4f7b5b46573\r\n  23:     0x7fff30a42e0b - rustc::dep_graph::graph::DepGraph::in_ignore::hf1d621baac1d7bf2\r\n  24:     0x7fff30769551 - rustc::util::ppaux::<impl core::fmt::Debug for rustc::ty::Predicate<'tcx>>::fmt::h676d3496cb3708f4\r\n  25:     0x7fff30c13d04 - <rustc::ty::_match::Match<'a, 'gcx, 'tcx> as rustc::ty::relate::TypeRelation<'a, 'gcx, 'tcx>>::tys::haf26cce42371d08b\r\n  26:     0x7fff3087b01c - rustc::ty::maps::<impl rustc::ty::maps::queries::mir_const<'tcx>>::ensure::ha8f1c4f7b5b46573\r\n  27:     0x7fff3087b81a - rustc::ty::maps::<impl rustc::ty::maps::queries::mir_const<'tcx>>::try_get::h6bab209f4409e1ff\r\n  28:     0x7fff30a042eb - rustc::ty::maps::TyCtxtAt::mir_const::h7f7b58900de2e460\r\n  29:     0x7fff30c3b646 - rustc::ty::maps::<impl rustc::ty::context::TyCtxt<'a, 'tcx, 'lcx>>::mir_const::hc69e91e2e3497eda\r\n  30:     0x7fff3a8617b2 - rustc_mir::transform::qualify_consts::provide::h42deea6a65e124be\r\n  31:     0x7fff30877b57 - rustc::ty::maps::<impl rustc::ty::maps::queries::mir_const_qualif<'tcx>>::ensure::h1593aedb0b8d1c20\r\n  32:     0x7fff30a4ad44 - rustc::dep_graph::graph::DepGraph::in_ignore::hf1d621baac1d7bf2\r\n  33:     0x7fff3075be31 - rustc::util::ppaux::<impl core::fmt::Debug for rustc::ty::Predicate<'tcx>>::fmt::h676d3496cb3708f4\r\n  34:     0x7fff30bd2414 - <rustc::ty::_match::Match<'a, 'gcx, 'tcx> as rustc::ty::relate::TypeRelation<'a, 'gcx, 'tcx>>::tys::haf26cce42371d08b\r\n  35:     0x7fff30877c09 - rustc::ty::maps::<impl rustc::ty::maps::queries::mir_const_qualif<'tcx>>::ensure::h1593aedb0b8d1c20\r\n  36:     0x7fff308784d4 - rustc::ty::maps::<impl rustc::ty::maps::queries::mir_const_qualif<'tcx>>::try_get::h24ba1db0ffcee5d0\r\n  37:     0x7fff30a0409e - rustc::ty::maps::TyCtxtAt::mir_const_qualif::hc0b6bdb4d4bc569d\r\n  38:     0x7fff30c3b5dd - rustc::ty::maps::<impl rustc::ty::context::TyCtxt<'a, 'tcx, 'lcx>>::mir_const_qualif::h2bf27dced46fe731\r\n  39:     0x7fff3f6721bd - rustc_const_eval::eval::provide::h0adb0c848c7c6fc2\r\n  40:     0x7fff308951ca - rustc::ty::maps::<impl rustc::ty::maps::queries::const_eval<'tcx>>::ensure::h5d74cf56c26525a0\r\n  41:     0x7fff30a585af - rustc::dep_graph::graph::DepGraph::in_ignore::hf1d621baac1d7bf2\r\n  42:     0x7fff3077c344 - rustc::util::ppaux::<impl core::fmt::Debug for rustc::ty::Predicate<'tcx>>::fmt::h676d3496cb3708f4\r\n  43:     0x7fff30c00977 - <rustc::ty::_match::Match<'a, 'gcx, 'tcx> as rustc::ty::relate::TypeRelation<'a, 'gcx, 'tcx>>::tys::haf26cce42371d08b\r\n  44:     0x7fff30895292 - rustc::ty::maps::<impl rustc::ty::maps::queries::const_eval<'tcx>>::ensure::h5d74cf56c26525a0\r\n  45:     0x7fff30895e82 - rustc::ty::maps::<impl rustc::ty::maps::queries::const_eval<'tcx>>::try_get::h2cca1f57f34949d8\r\n  46:     0x7fff30a0567b - rustc::ty::maps::TyCtxtAt::const_eval::hc4ac4aa5a422e0d9\r\n  47:     0x7fff30ab85ae - <rustc::traits::project::AssociatedTypeNormalizer<'a, 'b, 'gcx, 'tcx> as rustc::ty::fold::TypeFolder<'gcx, 'tcx>>::fold_const::h79c58ccf8a3cae8d\r\n  48:     0x7fff3073427a - rustc::ty::structural_impls::<impl rustc::ty::context::Lift<'tcx> for rustc::ty::ParamEnv<'a>>::lift_to_tcx::h251daf03714e6023\r\n  49:     0x7fff30ab7f41 - <rustc::traits::project::AssociatedTypeNormalizer<'a, 'b, 'gcx, 'tcx> as rustc::ty::fold::TypeFolder<'gcx, 'tcx>>::fold_ty::h90177157f5e40472\r\n  50:     0x7fff3081601d - <rustc::util::common::ProfileQueriesMsg as core::fmt::Debug>::fmt::h6b3ed19705af96ac\r\n  51:     0x7fff30ba3035 - rustc::util::ppaux::<impl core::fmt::Display for rustc::ty::sty::ProjectionTy<'tcx>>::fmt::h4acd576bbff0db49\r\n  52:     0x7fff3070c735 - rustc::ty::error::<impl rustc::ty::TyS<'tcx>>::sort_string::h0db0616a53983bdc\r\n  53:     0x7fff3073424d - rustc::ty::structural_impls::<impl rustc::ty::context::Lift<'tcx> for rustc::ty::ParamEnv<'a>>::lift_to_tcx::h251daf03714e6023\r\n  54:     0x7fff30ab7f41 - <rustc::traits::project::AssociatedTypeNormalizer<'a, 'b, 'gcx, 'tcx> as rustc::ty::fold::TypeFolder<'gcx, 'tcx>>::fold_ty::h90177157f5e40472\r\n  55:     0x7fff3e36f66a - <rustc_typeck::check::wfcheck::CheckTypeWellFormedVisitor<'a, 'tcx> as rustc::hir::intravisit::Visitor<'v>>::visit_impl_item::hcece3901126b1cbd\r\n  56:     0x7fff3e3c1075 - <rustc_typeck::coherence::unsafety::UnsafetyChecker<'cx, 'tcx> as rustc::hir::itemlikevisit::ItemLikeVisitor<'v>>::visit_item::h3da78dca7718447f\r\n  57:     0x7fff3e3d3620 - <rustc_typeck::constrained_type_params::Parameter as core::fmt::Debug>::fmt::h43b8225dff655b08\r\n  58:     0x7fff3e33ea96 - <rustc_typeck::check::FnCtxt<'a, 'gcx, 'tcx> as rustc_typeck::astconv::AstConv<'gcx, 'tcx>>::record_ty::hf70a5a2a9b929b5e\r\n  59:     0x7fff3e39b582 - <rustc_typeck::check::method::probe::ProbeScope as core::fmt::Debug>::fmt::h6e9a17f517124e3c\r\n  60:     0x7fff3e407943 - <rustc_typeck::astconv::Bounds<'tcx> as core::fmt::Debug>::fmt::h01dac006432753d1\r\n  61:     0x7fff3e368504 - <rustc_typeck::check::Diverges as core::fmt::Debug>::fmt::h4031262e322927a9\r\n  62:     0x7fff3e2fef38 - <rustc_typeck::namespace::Namespace as core::fmt::Debug>::fmt::hd83feb2f4b81e514\r\n  63:     0x7fff3e3ac960 - <rustc_typeck::collect::ItemCtxt<'a, 'tcx> as rustc_typeck::astconv::AstConv<'tcx, 'tcx>>::record_ty::h1757e62b382e1508\r\n  64:     0x7fff3e3c5c66 - <rustc_typeck::coherence::unsafety::UnsafetyChecker<'cx, 'tcx> as rustc::hir::itemlikevisit::ItemLikeVisitor<'v>>::visit_item::h3da78dca7718447f\r\n  65:     0x7fff3e3fdd39 - rustc_typeck::check_crate::h0700276c41355c42\r\n  66:     0x7fff3f826edb - <rustc_driver::Compilation as core::fmt::Debug>::fmt::h970bab471a268779\r\n  67:     0x7fff3f826a63 - <rustc_driver::Compilation as core::fmt::Debug>::fmt::h970bab471a268779\r\n  68:     0x7fff3f78731f - <rustc_driver::pretty::UserIdentifiedItem as core::fmt::Debug>::fmt::h75102f2bc4758c9c\r\n  69:     0x7fff3f7d2a2b - rustc_driver::driver::compile_input::hfb39c521f477ee8d\r\n  70:     0x7fff3f816b55 - rustc_driver::run_compiler::h334a80a4b6e644f4\r\n  71:     0x7fff3f770d9d - <rustc_driver::pretty::UserIdentifiedItem as core::fmt::Debug>::fmt::h75102f2bc4758c9c\r\n  72:     0x7fff393e9f51 - _rust_maybe_catch_panic\r\n  73:     0x7fff3f809a11 - <rustc_driver::derive_registrar::Finder as rustc::hir::itemlikevisit::ItemLikeVisitor<'v>>::visit_impl_item::h73b2f332badc5ded\r\n  74:     0x7fff393e415b - std::sys::imp::thread::Thread::new::hc076c74f7dafca1e\r\n  75:     0x7fff777e1fe3 - BaseThreadInitThunk\r\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/47486/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/47486/timeline", "performed_via_github_app": null, "state_reason": "completed"}