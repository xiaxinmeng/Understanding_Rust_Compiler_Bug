{"url": "https://api.github.com/repos/rust-lang/rust/issues/101874", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/101874/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/101874/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/101874/events", "html_url": "https://github.com/rust-lang/rust/issues/101874", "id": 1375136275, "node_id": "I_kwDOAAsO6M5R9uoT", "number": 101874, "title": "Improve styling of <span class=\"stab\"> tags in the documentation's main body", "user": {"login": "FedericoStra", "id": 2906478, "node_id": "MDQ6VXNlcjI5MDY0Nzg=", "avatar_url": "https://avatars.githubusercontent.com/u/2906478?v=4", "gravatar_id": "", "url": "https://api.github.com/users/FedericoStra", "html_url": "https://github.com/FedericoStra", "followers_url": "https://api.github.com/users/FedericoStra/followers", "following_url": "https://api.github.com/users/FedericoStra/following{/other_user}", "gists_url": "https://api.github.com/users/FedericoStra/gists{/gist_id}", "starred_url": "https://api.github.com/users/FedericoStra/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/FedericoStra/subscriptions", "organizations_url": "https://api.github.com/users/FedericoStra/orgs", "repos_url": "https://api.github.com/users/FedericoStra/repos", "events_url": "https://api.github.com/users/FedericoStra/events{/privacy}", "received_events_url": "https://api.github.com/users/FedericoStra/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 203738, "node_id": "MDU6TGFiZWwyMDM3Mzg=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-rustdoc", "name": "T-rustdoc", "color": "bfd4f2", "default": false, "description": "Relevant to the rustdoc team, which will review and decide on the PR/issue."}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}, {"id": 2406929537, "node_id": "MDU6TGFiZWwyNDA2OTI5NTM3", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-rustdoc-ui", "name": "A-rustdoc-ui", "color": "f7e101", "default": false, "description": "Area: rustdoc UI (generated HTML)"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-09-15T22:03:45Z", "updated_at": "2022-09-22T04:22:35Z", "closed_at": "2022-09-22T04:22:35Z", "author_association": "NONE", "active_lock_reason": null, "body": "# The Problem\r\n\r\nIf one tries to put feature labels in the main body of the documentation (what goes inside `<div class=\"docblock\">`) they get styled differently from the one automatically inserted by `rustdoc` running with `#![feature(doc_auto_cfg)]`. In particular the layout is bad and can cause the appearance of scrollbars on the right hand side of each involved paragraph.\r\n\r\nHere is an example picture:\r\n\r\n![screenshot bad](https://user-images.githubusercontent.com/2906478/190515199-fedef9b8-a6d1-4171-a400-250031cb4f0a.png)\r\n\r\nThe desirable look would of course be\r\n\r\n![screenshot good](https://user-images.githubusercontent.com/2906478/190515270-77d3d678-a0b8-434e-9094-29d86bbc59f3.png)\r\n\r\n<details>\r\n<summary>Code to generate the example documentation above.</summary>\r\n\r\n`Cargo.toml`:\r\n\r\n```toml\r\n[package]\r\nname = \"doc-example\"\r\nversion = \"0.1.0\"\r\nedition = \"2021\"\r\n\r\n[features]\r\ndefault = [\"some-feature\"]\r\nsome-feature = []\r\n```\r\n\r\n`src/lib.rs`:\r\n\r\n```rust\r\n/*! Cool library.\r\n\r\n<!-- REMOVE TO PRODUCE THE BAD VERSION -->\r\n<style>\r\n.docblock .stab {\r\n    display: inline-block;\r\n    margin-bottom: 0;\r\n    padding: 2px;\r\n    line-height: 1.2;\r\n    border-radius: 3px;\r\n}\r\n</style>\r\n\r\nEnable the feature <span class=\"stab portability\"><code>some-feature</code></span> to enjoy this crate even more!\r\nEnable the feature <span class=\"stab portability\"><code>some-feature</code></span> to enjoy this crate even more!\r\nEnable the feature <span class=\"stab portability\"><code>some-feature</code></span> to enjoy this crate even more!\r\n\r\nAlso, stop using [`bar`] as it's <span class=\"stab deprecated\" title=\"\">deprecated</span>.\r\nAlso, stop using [`bar`] as it's <span class=\"stab deprecated\" title=\"\">deprecated</span>.\r\nAlso, stop using [`bar`] as it's <span class=\"stab deprecated\" title=\"\">deprecated</span>.\r\n\r\nFinally, you can use [`quz`] only on <span class=\"stab portability\"><code>Unix or x86-64</code></span>.\r\nFinally, you can use [`quz`] only on <span class=\"stab portability\"><code>Unix or x86-64</code></span>.\r\nFinally, you can use [`quz`] only on <span class=\"stab portability\"><code>Unix or x86-64</code></span>.\r\n*/\r\n\r\n#![feature(doc_auto_cfg)]\r\n\r\n/// Does fooish things.\r\n#[cfg(feature = \"some-feature\")]\r\npub fn foo() {}\r\n\r\n/// Does barish things.\r\n#[deprecated(since = \"0.1.0\", note = \"we don't need this anymore\")]\r\npub fn bar() {}\r\n\r\n/// Does quzish things.\r\n#[cfg(any(unix, target_arch = \"x86_64\"))]\r\npub fn quz() {}\r\n```\r\n\r\n</details>\r\n\r\n# The Cause\r\n\r\nThe reason is that `rustdoc.css` has a special rule for `.module-item .stab, .import-item .stab`, whereas it does not address `.stab` tags appearing as descendant of `.docblock` tags.\r\n\r\n# The Fix\r\n\r\nFrom a crate developer's point of view, the fix for this is simple enough: just inject the following CSS\r\n\r\n```css\r\n.docblock .stab {\r\n    display: inline-block;\r\n    margin-bottom: 0;\r\n    padding: 2px;\r\n    line-height: 1.2;\r\n    border-radius: 3px;\r\n}\r\n```\r\n\r\nso that they are rendered the same way as the ones generated by `rustdoc`'s `doc_auto_cfg` labels.\r\n\r\n# The Request\r\n\r\nIs there any chance that this CSS gets included in the official `rustdoc.css` style?\r\n\r\nThe fix would probably consist in adding `.docblock .stab` to https://github.com/rust-lang/rust/blob/4f372b14dea58cbff1dd76bb651f9c035d3f6e7b/src/librustdoc/html/static/css/rustdoc.css#L1064-L1074\r\nexcept that we don't want the left margin, so probably a dedicated rule is more appropriate.", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/101874/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/101874/timeline", "performed_via_github_app": null, "state_reason": "completed"}