{"url": "https://api.github.com/repos/rust-lang/rust/issues/15484", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/15484/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/15484/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/15484/events", "html_url": "https://github.com/rust-lang/rust/issues/15484", "id": 37222633, "node_id": "MDU6SXNzdWUzNzIyMjYzMw==", "number": 15484, "title": "Assertion failed (Calling a function with a bad signature) in dead code", "user": {"login": "gmorenz", "id": 595972, "node_id": "MDQ6VXNlcjU5NTk3Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/595972?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gmorenz", "html_url": "https://github.com/gmorenz", "followers_url": "https://api.github.com/users/gmorenz/followers", "following_url": "https://api.github.com/users/gmorenz/following{/other_user}", "gists_url": "https://api.github.com/users/gmorenz/gists{/gist_id}", "starred_url": "https://api.github.com/users/gmorenz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gmorenz/subscriptions", "organizations_url": "https://api.github.com/users/gmorenz/orgs", "repos_url": "https://api.github.com/users/gmorenz/repos", "events_url": "https://api.github.com/users/gmorenz/events{/privacy}", "received_events_url": "https://api.github.com/users/gmorenz/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}, {"id": 46741598, "node_id": "MDU6TGFiZWw0Njc0MTU5OA==", "url": "https://api.github.com/repos/rust-lang/rust/labels/E-needs-test", "name": "E-needs-test", "color": "02e10c", "default": false, "description": "Call for participation: writing correctness tests"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2014-07-06T16:39:13Z", "updated_at": "2015-04-22T00:21:19Z", "closed_at": "2015-04-22T00:21:19Z", "author_association": "NONE", "active_lock_reason": null, "body": "Sorry about not reducing this more, gl is https://github.com/bjz/gl-rs\n\n```\nextern crate gl;\n\nuse std::mem;\n\nuse gl::types::GLsizeiptr;\nuse gl::types::GLuint;\n\n#[allow(unreachable_code)]\nfn main() {\n\n    return;\n\n    let elements: [GLuint, .. 1 * 6] = [\n        0, 1, 2,\n        2, 3, 0,\n    ];\n\n    unsafe {\n        gl::BufferData(gl::ELEMENT_ARRAY_BUFFER,\n                       (elements.len() * mem::size_of::<GLuint>()) as GLsizeiptr,\n                       mem::transmute(&elements[0]),\n                       gl::STATIC_DRAW);\n    }\n}\n```\n\nCompiler output:\n\n```\n$ RUST_BACKTRACE=1 rustc src/main.rs -L target/deps\nrustc: /home/rustbuild/src/rust-buildbot/slave/nightly-linux/build/src/llvm/lib/IR/Instructions.cpp:281: void llvm::CallInst::init(llvm::Value*, llvm::ArrayRef<llvm::Value*>, const llvm::Twine&): Assertion `(i >= FTy->getNumParams() || FTy->getParamType(i) == Args[i]->getType()) && \"Calling a function with a bad signature!\"' failed.\nAborted (core dumped)\n```\n\nSince that doesn't get a backtrace, gdb output:\n\n```\n$ gdb --args rustc src/main.rs -L target/deps\nGNU gdb (GDB) 7.7.1\nCopyright (C) 2014 Free Software Foundation, Inc.\nLicense GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.  Type \"show copying\"\nand \"show warranty\" for details.\nThis GDB was configured as \"x86_64-unknown-linux-gnu\".\nType \"show configuration\" for configuration details.\nFor bug reporting instructions, please see:\n<http://www.gnu.org/software/gdb/bugs/>.\nFind the GDB manual and other documentation resources online at:\n<http://www.gnu.org/software/gdb/documentation/>.\nFor help, type \"help\".\nType \"apropos word\" to search for commands related to \"word\"...\nReading symbols from rustc...(no debugging symbols found)...done.\n(gdb) run\nStarting program: /usr/local/bin/rustc src/main.rs -L target/deps\nwarning: Could not load shared library symbols for linux-vdso.so.1.\nDo you need \"set solib-search-path\" or \"set sysroot\"?\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/usr/lib/libthread_db.so.1\".\n[New Thread 0x7ffff0bff480 (LWP 18366)]\nrustc: /home/rustbuild/src/rust-buildbot/slave/nightly-linux/build/src/llvm/lib/IR/Instructions.cpp:281: void llvm::CallInst::init(llvm::Value*, llvm::ArrayRef<llvm::Value*>, const llvm::Twine&): Assertion `(i >= FTy->getNumParams() || FTy->getParamType(i) == Args[i]->getType()) && \"Calling a function with a bad signature!\"' failed.\n\nProgram received signal SIGABRT, Aborted.\n[Switching to Thread 0x7ffff0bff480 (LWP 18366)]\n0x00007ffff478bd67 in raise () from /usr/lib/libc.so.6\n(gdb) bt\n#0  0x00007ffff478bd67 in raise () from /usr/lib/libc.so.6\n#1  0x00007ffff478d118 in abort () from /usr/lib/libc.so.6\n#2  0x00007ffff4784bdd in __assert_fail_base () from /usr/lib/libc.so.6\n#3  0x00007ffff4784c92 in __assert_fail () from /usr/lib/libc.so.6\n#4  0x00007ffff688914e in llvm::CallInst::init(llvm::Value*, llvm::ArrayRef<llvm::Value*>, llvm::Twine const&) ()\n   from /usr/local/bin/../lib/librustc-a9826c4a-0.11.0.so\n#5  0x00007ffff5b3ccf9 in llvm::IRBuilder<true, llvm::ConstantFolder, llvm::IRBuilderDefaultInserter<true> >::CreateCall(llvm::Value*, llvm::ArrayRef<llvm::Value*>, llvm::Twine const&) ()\n   from /usr/local/bin/../lib/librustc-a9826c4a-0.11.0.so\n#6  0x00007ffff67ea936 in LLVMBuildCall ()\n   from /usr/local/bin/../lib/librustc-a9826c4a-0.11.0.so\n#7  0x00007ffff52b3d69 in middle::trans::builder::Builder$LT$$x27a$GT$::call::h0398c24efef6defbPvo::v0.11.0 ()\n   from /usr/local/bin/../lib/librustc-a9826c4a-0.11.0.so\n#8  0x00007ffff5227a56 in middle::trans::base::invoke::he436b450ee496508yJp::v0.11.0 () from /usr/local/bin/../lib/librustc-a9826c4a-0.11.0.so\n#9  0x00007ffff523f425 in middle::trans::callee::trans_call_inner::hdfdb8c30fa124095R1e::v0.11.0 () from /usr/local/bin/../lib/librustc-a9826c4a-0.11.0.so\n#10 0x00007ffff5244b08 in middle::trans::callee::trans_call::h9df70b3aef437bdcZVe::v0.11.0 () from /usr/local/bin/../lib/librustc-a9826c4a-0.11.0.so\n#11 0x00007ffff524f6e9 in middle::trans::expr::trans_rvalue_dps_unadjusted::hf749359ec6e2a160hvg::v0.11.0 ()\n   from /usr/local/bin/../lib/librustc-a9826c4a-0.11.0.so\n#12 0x00007ffff520a7b8 in middle::trans::expr::trans_into::hf0a37465b961389bIDf::v0.11.0 () from /usr/local/bin/../lib/librustc-a9826c4a-0.11.0.so\n#13 0x00007ffff5209989 in middle::trans::controlflow::trans_stmt_semi::h60648583663979489hc::v0.11.0 () from /usr/local/bin/../lib/librustc-a9826c4a-0.11.0.so\n#14 0x00007ffff520914b in middle::trans::controlflow::trans_stmt::h136741cd3736231fMdc::v0.11.0 () from /usr/local/bin/../lib/librustc-a9826c4a-0.11.0.so\n#15 0x00007ffff520abb1 in middle::trans::controlflow::trans_block::hecc22008fef2a1bd2ic::v0.11.0 () from /usr/local/bin/../lib/librustc-a9826c4a-0.11.0.so\n#16 0x00007ffff524f2b3 in middle::trans::expr::trans_rvalue_dps_unadjusted::hf749359ec6e2a160hvg::v0.11.0 ()\n   from /usr/local/bin/../lib/librustc-a9826c4a-0.11.0.so\n#17 0x00007ffff520a7b8 in middle::trans::expr::trans_into::hf0a37465b961389bIDf::v0.11.0 () from /usr/local/bin/../lib/librustc-a9826c4a-0.11.0.so\n#18 0x00007ffff520ac89 in middle::trans::controlflow::trans_block::hecc22008fef2a1bd2ic::v0.11.0 () from /usr/local/bin/../lib/librustc-a9826c4a-0.11.0.so\n#19 0x00007ffff52ce43a in middle::trans::base::trans_closure::h639d28c7bc97ae139tq::v0.11.0 () from /usr/local/bin/../lib/librustc-a9826c4a-0.11.0.so\n#20 0x00007ffff51db8a6 in middle::trans::base::trans_fn::he5cf57c39474f14caCq::v0.11.0 () from /usr/local/bin/../lib/librustc-a9826c4a-0.11.0.so\n#21 0x00007ffff51d4ebe in middle::trans::base::trans_item::h17204c67e6746031BSq::v0.11.0 () from /usr/local/bin/../lib/librustc-a9826c4a-0.11.0.so\n#22 0x00007ffff52deab1 in middle::trans::base::trans_crate::hfddcc2510b7c9311IMr::v0.11.0 () from /usr/local/bin/../lib/librustc-a9826c4a-0.11.0.so\n#23 0x00007ffff5a036cf in driver::driver::phase_4_translate_to_llvm::h6b5f55c3e1863d4cTuq::v0.11.0 () from /usr/local/bin/../lib/librustc-a9826c4a-0.11.0.so\n#24 0x00007ffff59fb9ea in driver::driver::compile_input::hc5634315c7a145c8n8p::v0.11.0 () from /usr/local/bin/../lib/librustc-a9826c4a-0.11.0.so\n#25 0x00007ffff5ab0723 in driver::run_compiler::hae575e8dc5c8f87dVTs::v0.11.0\n    () from /usr/local/bin/../lib/librustc-a9826c4a-0.11.0.so\n#26 0x00007ffff5aadeb5 in driver::main_args::closure.117607 ()\n   from /usr/local/bin/../lib/librustc-a9826c4a-0.11.0.so\n#27 0x00007ffff5ac2058 in task::TaskBuilder$LT$S$GT$::try_future::closure.118749---Type <return> to continue, or q <return> to quit---continue\n () from /usr/local/bin/../lib/librustc-a9826c4a-0.11.0.so\n#28 0x00007ffff5ac1f2c in task::TaskBuilder$LT$S$GT$::spawn_internal::closure.118726 () from /usr/local/bin/../lib/librustc-a9826c4a-0.11.0.so\n#29 0x00007ffff7ba7f88 in task::spawn_opts::closure.7519 ()\n   from /usr/local/bin/../lib/libnative-35e04b6f-0.11.0.so\n#30 0x00007ffff4bd01bc in rust_try ()\n   from /usr/local/bin/../lib/librustrt-805dca70-0.11.0.so\n#31 0x00007ffff4b742d6 in unwind::try::hd5f4c2617b203e57BNd::v0.11.0 ()\n   from /usr/local/bin/../lib/librustrt-805dca70-0.11.0.so\n#32 0x00007ffff4b74050 in task::Task::run::headae25e22673ff0XYc::v0.11.0 ()\n   from /usr/local/bin/../lib/librustrt-805dca70-0.11.0.so\n#33 0x00007ffff7ba7e11 in task::spawn_opts::closure.7465 ()\n   from /usr/local/bin/../lib/libnative-35e04b6f-0.11.0.so\n#34 0x00007ffff4b76b14 in thread::thread_start::hf8076cce1f95d94cvld::v0.11.0\n    () from /usr/local/bin/../lib/librustrt-805dca70-0.11.0.so\n#35 0x00007ffff3e38124 in start_thread () from /usr/lib/libpthread.so.0\n#36 0x00007ffff48414bd in clone () from /usr/lib/libc.so.6\n(gdb) quit\n```\n\nIf the `return` is removed from the source code, this compiles fine.\n", "closed_by": {"login": "steveklabnik", "id": 27786, "node_id": "MDQ6VXNlcjI3Nzg2", "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/steveklabnik", "html_url": "https://github.com/steveklabnik", "followers_url": "https://api.github.com/users/steveklabnik/followers", "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}", "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}", "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions", "organizations_url": "https://api.github.com/users/steveklabnik/orgs", "repos_url": "https://api.github.com/users/steveklabnik/repos", "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}", "received_events_url": "https://api.github.com/users/steveklabnik/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/15484/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/15484/timeline", "performed_via_github_app": null, "state_reason": "completed"}