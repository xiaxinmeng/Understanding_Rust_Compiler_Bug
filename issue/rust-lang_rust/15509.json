{"url": "https://api.github.com/repos/rust-lang/rust/issues/15509", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/15509/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/15509/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/15509/events", "html_url": "https://github.com/rust-lang/rust/issues/15509", "id": 37306423, "node_id": "MDU6SXNzdWUzNzMwNjQyMw==", "number": 15509, "title": "Handling of internal plugin errors", "user": {"login": "kmcallister", "id": 444997, "node_id": "MDQ6VXNlcjQ0NDk5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/444997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kmcallister", "html_url": "https://github.com/kmcallister", "followers_url": "https://api.github.com/users/kmcallister/followers", "following_url": "https://api.github.com/users/kmcallister/following{/other_user}", "gists_url": "https://api.github.com/users/kmcallister/gists{/gist_id}", "starred_url": "https://api.github.com/users/kmcallister/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kmcallister/subscriptions", "organizations_url": "https://api.github.com/users/kmcallister/orgs", "repos_url": "https://api.github.com/users/kmcallister/repos", "events_url": "https://api.github.com/users/kmcallister/events{/privacy}", "received_events_url": "https://api.github.com/users/kmcallister/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 235791, "node_id": "MDU6TGFiZWwyMzU3OTE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-diagnostics", "name": "A-diagnostics", "color": "f7e101", "default": false, "description": "Area: Messages for errors, warnings, and lints"}, {"id": 111868330, "node_id": "MDU6TGFiZWwxMTE4NjgzMzA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-plugin", "name": "A-plugin", "color": "f7e101", "default": false, "description": "Area: compiler plugins, doc.rust-lang.org/nightly/unstable-book/language-features/plugin.html"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2014-07-07T20:21:32Z", "updated_at": "2017-01-03T17:31:12Z", "closed_at": "2017-01-03T17:31:12Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Plugins can fail in ways that aren't the fault of the code being compiled. This could be an internal error in the plugin (which is still different from an ICE in Rust itself), or something like failure to load an external configuration file.\n\nIdeally, plugins would call the usual methods like `bug`, `err`, `span_bug`, etc., and the resulting messages would include the name of the plugin crate.  Unfortunately we can't do this by setting session state about which plugin is running, because they can call back into `librustc` and errors there shouldn't be reported as plugin errors.  We could introduce `plugin_bug`, `plugin_err`, `plugin_span_bug`, etc, but this API duplication is ugly, and you have to remember to use different methods when writing plugins.\n\nThe nicer (though harder-to-implement) solution is to have these functions walk the stack and then look at which shared object their caller was defined in.  In glibc this can be done with `backtrace()` and `dladdr()`, but I don't know how hard it is on other platforms.\n\nWhatever we do, we should also make these error methods accessible from the `Registry`, for use handling errors that occur during plugin initialization.\n", "closed_by": {"login": "steveklabnik", "id": 27786, "node_id": "MDQ6VXNlcjI3Nzg2", "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/steveklabnik", "html_url": "https://github.com/steveklabnik", "followers_url": "https://api.github.com/users/steveklabnik/followers", "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}", "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}", "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions", "organizations_url": "https://api.github.com/users/steveklabnik/orgs", "repos_url": "https://api.github.com/users/steveklabnik/repos", "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}", "received_events_url": "https://api.github.com/users/steveklabnik/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/15509/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/15509/timeline", "performed_via_github_app": null, "state_reason": "completed"}