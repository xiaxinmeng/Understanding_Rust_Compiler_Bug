{"url": "https://api.github.com/repos/rust-lang/rust/issues/24086", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/24086/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/24086/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/24086/events", "html_url": "https://github.com/rust-lang/rust/issues/24086", "id": 66402576, "node_id": "MDU6SXNzdWU2NjQwMjU3Ng==", "number": 24086, "title": "\"cannot relate bound region\" ICE caused by `Drop` implementation", "user": {"login": "japaric", "id": 5018213, "node_id": "MDQ6VXNlcjUwMTgyMTM=", "avatar_url": "https://avatars.githubusercontent.com/u/5018213?v=4", "gravatar_id": "", "url": "https://api.github.com/users/japaric", "html_url": "https://github.com/japaric", "followers_url": "https://api.github.com/users/japaric/followers", "following_url": "https://api.github.com/users/japaric/following{/other_user}", "gists_url": "https://api.github.com/users/japaric/gists{/gist_id}", "starred_url": "https://api.github.com/users/japaric/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/japaric/subscriptions", "organizations_url": "https://api.github.com/users/japaric/orgs", "repos_url": "https://api.github.com/users/japaric/repos", "events_url": "https://api.github.com/users/japaric/events{/privacy}", "received_events_url": "https://api.github.com/users/japaric/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1775993, "node_id": "MDU6TGFiZWwxNzc1OTkz", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-lifetimes", "name": "A-lifetimes", "color": "f7e101", "default": false, "description": "Area: lifetime related"}, {"id": 43009118, "node_id": "MDU6TGFiZWw0MzAwOTExOA==", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-destructors", "name": "A-destructors", "color": "f7e101", "default": false, "description": "Area: destructors (Drop, ..)"}], "state": "closed", "locked": false, "assignee": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2015-04-05T05:04:37Z", "updated_at": "2015-07-29T08:23:13Z", "closed_at": "2015-07-29T08:23:13Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "### STR:\n\n``` rust\npub struct Registry<'a> {\n    listener: &'a mut (),\n}\n\npub struct Listener<'a> {\n    pub announce: Option<Box<FnMut(&mut Registry) + 'a>>,\n    pub remove: Option<Box<FnMut(&mut Registry) + 'a>>,\n}\n\n#[cfg(ice)]\nimpl<'a> Drop for Registry<'a> {\n    fn drop(&mut self) {}\n}\n\nfn main() {\n    let mut registry_listener = Listener {\n        announce: None,\n        remove: None,\n    };\n}\n```\n### Backtrace\n\n``` rust\n$ RUST_BACKTRACE=1 rustc --cfg ice ice.rs\nice.rs:16:9: 16:30 error: internal compiler error: cannot relate bound region: ReScope(Misc(44)) <= ReLateBound(DebruijnIndex { depth: 1 }, BrAnon(1))\nice.rs:16     let mut registry_listener = Listener {\n                  ^~~~~~~~~~~~~~~~~~~~~\nnote: the compiler unexpectedly panicked. this is a bug.\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports\nnote: run with `RUST_BACKTRACE=1` for a backtrace\nthread 'rustc' panicked at 'Box<Any>', /home/rustbuild/src/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libsyntax/diagnostic.rs:130\n\nstack backtrace:\n   1:     0x7f60f3bc6708 - sys::backtrace::write::he3059e6bc8c10ccbZGC\n   2:     0x7f60f3bf1ad7 - panicking::on_panic::h4b318d56839ed7af9TI\n   3:     0x7f60f3b297e3 - rt::unwind::begin_unwind_inner::hbbbefb3640cc608bhzI\n   4:     0x7f60f0ef1efd - rt::unwind::begin_unwind::h10258443395685540836\n   5:     0x7f60f0ef1ea3 - diagnostic::SpanHandler::span_bug::he0c1a59febe6c207YmB\n   6:     0x7f60f1a295ee - middle::infer::region_inference::RegionVarBindings<'a, 'tcx>::make_subregion::h87dd23f538f1eeeajjv\n   7:     0x7f60f1a489bf - middle::infer::mk_subr::hb7d1db897203c304KWy\n   8:     0x7f60f280e4dd - check::regionck::type_must_outlive::h1e6fc599a86efdb6l3e\n   9:     0x7f60f280bfd4 - check::dropck::iterate_over_potentially_unsafe_regions_in_type::h7f75223739c50980IDa\n  10:     0x7f60f280c25e - check::dropck::iterate_over_potentially_unsafe_regions_in_type::h7f75223739c50980IDa\n  11:     0x7f60f280a6af - check::dropck::check_safety_of_destructor_if_necessary::had92a0dd251d07deSxa\n  12:     0x7f60f28551a3 - ast_util::walk_pat::walk_pat_::h16792876270867621303\n  13:     0x7f60f2854885 - check::regionck::constrain_bindings_in_pat::hffae1d6859777115nHd\n  14:     0x7f60f28545f6 - check::regionck::visit_local::h0334da4335b8c86bUGd\n  15:     0x7f60f284ebc5 - check::regionck::Rcx<'a, 'tcx>::visit_fn_body::hf9bf452987e31f45amd\n  16:     0x7f60f28e98f1 - check::check_bare_fn::h3bd8f9ddb42906aevPn\n  17:     0x7f60f28e33d4 - check::check_item::h9d147ebfae788c9cg8n\n  18:     0x7f60f29baec6 - check_crate::closure.36252\n  19:     0x7f60f29b5413 - check_crate::hf86b00a9a711df871oC\n  20:     0x7f60f42465ad - driver::phase_3_run_analysis_passes::h7afb182e7d24bba2gGa\n  21:     0x7f60f422a405 - driver::compile_input::hd7743659db68d680Qba\n  22:     0x7f60f42e1875 - run_compiler::h8e4dca3e7b3dd900S4b\n  23:     0x7f60f42df18d - boxed::F.FnBox<A>::call_box::h4911342064246001069\n  24:     0x7f60f42de6c9 - rt::unwind::try::try_fn::h1593779289253196900\n  25:     0x7f60f3c6e288 - rust_try_inner\n  26:     0x7f60f3c6e275 - rust_try\n  27:     0x7f60f42de99b - boxed::F.FnBox<A>::call_box::h13493051407817611035\n  28:     0x7f60f3bdcac1 - sys::thread::create::thread_start::hf5d11b227fd9319cruH\n  29:     0x7f60ed9d1373 - start_thread\n  30:     0x7f60f379c27c - __clone\n  31:                0x0 - <unknown>\n```\n### Version\n\n``` rust\nrustc 1.0.0-nightly (f207ecbe0 2015-04-03) (built 2015-04-04)\n```\n\ncc @nikomatsakis @pnkfelix \n", "closed_by": {"login": "arielb1", "id": 1830974, "node_id": "MDQ6VXNlcjE4MzA5NzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1830974?v=4", "gravatar_id": "", "url": "https://api.github.com/users/arielb1", "html_url": "https://github.com/arielb1", "followers_url": "https://api.github.com/users/arielb1/followers", "following_url": "https://api.github.com/users/arielb1/following{/other_user}", "gists_url": "https://api.github.com/users/arielb1/gists{/gist_id}", "starred_url": "https://api.github.com/users/arielb1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/arielb1/subscriptions", "organizations_url": "https://api.github.com/users/arielb1/orgs", "repos_url": "https://api.github.com/users/arielb1/repos", "events_url": "https://api.github.com/users/arielb1/events{/privacy}", "received_events_url": "https://api.github.com/users/arielb1/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/24086/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/24086/timeline", "performed_via_github_app": null, "state_reason": "completed"}