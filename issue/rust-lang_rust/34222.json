{"url": "https://api.github.com/repos/rust-lang/rust/issues/34222", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/34222/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/34222/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/34222/events", "html_url": "https://github.com/rust-lang/rust/issues/34222", "id": 159780081, "node_id": "MDU6SXNzdWUxNTk3ODAwODE=", "number": 34222, "title": "Internal Compiler Error running cargo doc", "user": {"login": "AdamNiederer", "id": 4571394, "node_id": "MDQ6VXNlcjQ1NzEzOTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/4571394?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AdamNiederer", "html_url": "https://github.com/AdamNiederer", "followers_url": "https://api.github.com/users/AdamNiederer/followers", "following_url": "https://api.github.com/users/AdamNiederer/following{/other_user}", "gists_url": "https://api.github.com/users/AdamNiederer/gists{/gist_id}", "starred_url": "https://api.github.com/users/AdamNiederer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AdamNiederer/subscriptions", "organizations_url": "https://api.github.com/users/AdamNiederer/orgs", "repos_url": "https://api.github.com/users/AdamNiederer/repos", "events_url": "https://api.github.com/users/AdamNiederer/events{/privacy}", "received_events_url": "https://api.github.com/users/AdamNiederer/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}, {"id": 46741598, "node_id": "MDU6TGFiZWw0Njc0MTU5OA==", "url": "https://api.github.com/repos/rust-lang/rust/labels/E-needs-test", "name": "E-needs-test", "color": "02e10c", "default": false, "description": "Call for participation: writing correctness tests"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2016-06-11T16:01:42Z", "updated_at": "2017-06-24T09:32:30Z", "closed_at": "2017-06-24T09:32:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hey, I'm trying to learn Rust. I have this code. It's not valid Rust, but it causes the compiler to throw an ICE.\n\n`````` rust\nstruct Square {\n    xcoord :i32,\n    ycoord :i32,\n    len :i32\n}\n\nimpl Square {\n    fn area() {\n        len * len\n    }\n    fn diag() {\n        len * 2.sqrt()\n    }\n    fn quadr() {\n        match (xcoord, ycoord) {\n            -_ =>\n        }\n    }\n}\n\nfn main() {\n    /// Causes a crash\n    /// Example usage:\n    /// ```\n    /// main() #-> Causes crash\n    /// ```\n    let q = vec!(3, 2, 1);\n    let x = 5_000_000_i32;\n    let y = &x;\n    println!(\"Hello, world! {}\", q.len());\n    assert_eq!(q, [3, 2, 2]) // crashes\n}\n\n``````\n\nI ran `cargo doc` on it, and was told to file a bug report. Running `cargo build` or `rustc main.rs` does not cause the panic.\n\n``````\n[adam@AdamsPC src]$ RUST_BACKTRACE=1 cargo doc\n Documenting kek v0.1.0 (file:///home/adam/kek)\nmain.rs:16:14: 16:15 error: unexpected token: `_`\nmain.rs:16             -_ =>\n                        ^\nmain.rs:22:5: 22:37 error: attributes on non-item statements and expressions are experimental. (see issue #15701)\nmain.rs:22     /// Causes you to crash and shit\n               ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nmain.rs:23:5: 23:23 error: attributes on non-item statements and expressions are experimental. (see issue #15701)\nmain.rs:23     /// Example usage:\n               ^~~~~~~~~~~~~~~~~~\nmain.rs:24:5: 24:12 error: attributes on non-item statements and expressions are experimental. (see issue #15701)\nmain.rs:24     /// ```\n               ^~~~~~~\nmain.rs:25:5: 25:32 error: attributes on non-item statements and expressions are experimental. (see issue #15701)\nmain.rs:25     /// main() #-> Causes crash\n               ^~~~~~~~~~~~~~~~~~~~~~~~~~~\nmain.rs:26:5: 26:12 error: attributes on non-item statements and expressions are experimental. (see issue #15701)\nmain.rs:26     /// ```\n               ^~~~~~~\nerror: internal compiler error: unexpected panic\nnote: the compiler unexpectedly panicked. this is a bug.\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports\nnote: run with `RUST_BACKTRACE=1` for a backtrace\nthread 'rustc' panicked at 'phase_2_configure_and_expand aborted in rustdoc!: 5', src/libcore/result.rs:746\nstack backtrace:\n   1:     0x7efe3d4fa4e0 - std::sys::backtrace::tracing::imp::write::h4c73fcd3363076f5\n   2:     0x7efe3d507bdb - std::panicking::default_hook::_$u7b$$u7b$closure$u7d$$u7d$::h0422dbb3077e6747\n   3:     0x7efe3d50777c - std::panicking::default_hook::haac48fa641db8fa2\n   4:     0x7efe3d4cc70f - std::sys_common::unwind::begin_unwind_inner::h39d40f52add53ef7\n   5:     0x7efe3d4ce7f8 - std::sys_common::unwind::begin_unwind_fmt::h64c0ff793199cc1b\n   6:     0x7efe3d4f7cf1 - rust_begin_unwind\n   7:     0x7efe3d5481af - core::panicking::panic_fmt::h73bf9d7e8e891a73\n   8:     0x7efe3da9b42b - core::result::unwrap_failed::h52d645c697d2a555\n   9:     0x7efe3da3637d - rustdoc::core::run_core::h5d51993c037675df\n  10:     0x7efe3da31c08 - std::sys_common::unwind::try::try_fn::he5d0ca3afe34ca3c\n  11:     0x7efe3d4f7c7b - __rust_try\n  12:     0x7efe3d4f7c0d - std::sys_common::unwind::inner_try::h9eebd8dc83f388a6\n  13:     0x7efe3da338ff - _<F as std..boxed..FnBox<A>>::call_box::h871bc6bfba8a323f\n  14:     0x7efe3d505d74 - std::sys::thread::Thread::new::thread_start::h471ad90789353b5b\n  15:     0x7efe36288473 - start_thread\n  16:     0x7efe3d15d69c - clone\n  17:                0x0 - <unknown>\n\nerror: Could not document `kek`.\n\nTo learn more, run the command again with --verbose.\n``````\n\nHere's the `rustc` version. I pulled it down from the Arch repositories yesterday.\n\n```\nrustc 1.9.0\nbinary: rustc\ncommit-hash: unknown\ncommit-date: unknown\nhost: x86_64-unknown-linux-gnu\nrelease: 1.9.0\n```\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/34222/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/34222/timeline", "performed_via_github_app": null, "state_reason": "completed"}