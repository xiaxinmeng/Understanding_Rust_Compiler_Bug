{"url": "https://api.github.com/repos/rust-lang/rust/issues/23600", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/23600/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/23600/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/23600/events", "html_url": "https://github.com/rust-lang/rust/issues/23600", "id": 63471619, "node_id": "MDU6SXNzdWU2MzQ3MTYxOQ==", "number": 23600, "title": "ICE: capacity overflow or \"Illegal instruction (core dumped)\" with very large static item", "user": {"login": "rprichard", "id": 1572855, "node_id": "MDQ6VXNlcjE1NzI4NTU=", "avatar_url": "https://avatars.githubusercontent.com/u/1572855?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rprichard", "html_url": "https://github.com/rprichard", "followers_url": "https://api.github.com/users/rprichard/followers", "following_url": "https://api.github.com/users/rprichard/following{/other_user}", "gists_url": "https://api.github.com/users/rprichard/gists{/gist_id}", "starred_url": "https://api.github.com/users/rprichard/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rprichard/subscriptions", "organizations_url": "https://api.github.com/users/rprichard/orgs", "repos_url": "https://api.github.com/users/rprichard/repos", "events_url": "https://api.github.com/users/rprichard/events{/privacy}", "received_events_url": "https://api.github.com/users/rprichard/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 46741598, "node_id": "MDU6TGFiZWw0Njc0MTU5OA==", "url": "https://api.github.com/repos/rust-lang/rust/labels/E-needs-test", "name": "E-needs-test", "color": "02e10c", "default": false, "description": "Call for participation: writing correctness tests"}, {"id": 60329014, "node_id": "MDU6TGFiZWw2MDMyOTAxNA==", "url": "https://api.github.com/repos/rust-lang/rust/labels/P-low", "name": "P-low", "color": "eb6420", "default": false, "description": "Low priority"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2015-03-22T00:47:21Z", "updated_at": "2021-09-14T06:56:30Z", "closed_at": null, "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Added by pnkfelix: here is a summary of cases discussed in comment dialogue on issue..\r\n\r\nOutcome Matrix | nonzero elem size | zero-sized elems\r\n---------------- | ------------------ | ------------------\r\narray length = 0xffff_ffff_ffff_ffff | [error: \"too big for the current architecture\"][smallNZ] | [takes too long to know outcome?][smallZ]\r\narray length = 0xffff_ffff |  [LLVM OOM][largeNZ]  | [successful compile after several minutes][largeZ]\r\n\r\n[smallNZ]: https://play.rust-lang.org/?version=nightly&mode=debug&edition=2018&gist=268096ace30d8abc69752eb4e9ed0cc4\r\n[largeNZ]: https://play.rust-lang.org/?version=nightly&mode=debug&edition=2018&gist=4129527cb5d1166eed91ecd0e01183f6\r\n[smallZ]: https://play.rust-lang.org/?version=nightly&mode=debug&edition=2018&gist=c66386c4be2f0866d77f0f33582b9de8\r\n[largeZ]: https://play.rust-lang.org/?version=nightly&mode=debug&edition=2018&gist=f92457a38210b6c03a9b150b2ff961da\r\n\r\nOriginal bug report below\r\n----\r\n\r\nTest case one:\r\n\r\n``` rust\r\nstatic V1: [u8; 0xffff_ffff] = [0u8; 0xffff_ffff];\r\nfn main() { V1[0]; }\r\n```\r\n\r\n```\r\n$ rustc test.rs\r\nIllegal instruction (core dumped)\r\n```\r\n\r\nTest case two:\r\n\r\n``` rust\r\nstatic V1: [u8; 0xffff_ffff_ffff_ffff] = [0u8; 0xffff_ffff_ffff_ffff];\r\nfn main() { V1[0]; }\r\n```\r\n\r\n```\r\n$ RUST_BACKTRACE=1 rustc test.rs\r\nerror: internal compiler error: unexpected panic\r\nnote: the compiler unexpectedly panicked. this is a bug.\r\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports\r\nnote: run with `RUST_BACKTRACE=1` for a backtrace\r\nthread 'rustc' panicked at 'capacity overflow', /home/rustbuild/src/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libcore/option.rs:330\r\n\r\nstack backtrace:\r\n   1:     0x7f4ba1cdfb84 - sys::backtrace::write::h00123aaa25bd3a87l4C\r\n   2:     0x7f4ba1d08528 - panicking::on_panic::h132e5f71ec66ef60YiJ\r\n   3:     0x7f4ba1c3bb0c - rt::unwind::begin_unwind_inner::ha3837a1e391d832bfZI\r\n   4:     0x7f4ba1c3bef1 - rt::unwind::begin_unwind_fmt::h12ca28db54db2d68QXI\r\n   5:     0x7f4ba1d08167 - rust_begin_unwind\r\n   6:     0x7f4ba1d57324 - panicking::panic_fmt::h99de93df94b78c1afXA\r\n   7:     0x7f4ba13e9550 - trans::consts::const_expr_unadjusted::hc13ed55a56b0ff20YAn\r\n   8:     0x7f4ba13ea349 - trans::consts::const_expr::h138812d7f28437d4ron\r\n   9:     0x7f4ba1324a7b - trans::base::get_item_val::h36642395ea7e258dF7t\r\n  10:     0x7f4ba1321799 - trans::base::trans_item::h90869e00e43d4702mCt\r\n  11:     0x7f4ba140a492 - trans::base::trans_crate::h909d471e074343adQyu\r\n  12:     0x7f4ba2338e73 - driver::phase_4_translate_to_llvm::h2d7e84da5a579268mOa\r\n  13:     0x7f4ba2314153 - driver::compile_input::hd802b376244c1b88Rba\r\n  14:     0x7f4ba23cb942 - run_compiler::hc447d2d22477a14av2b\r\n  15:     0x7f4ba23c9713 - thunk::F.Invoke<A, R>::invoke::h3003831543088172262\r\n  16:     0x7f4ba23c8ba9 - rt::unwind::try::try_fn::h6527156377446821573\r\n  17:     0x7f4ba1d7e358 - rust_try_inner\r\n  18:     0x7f4ba1d7e345 - rust_try\r\n  19:     0x7f4ba23c8ecc - thunk::F.Invoke<A, R>::invoke::h1217623451251402195\r\n  20:     0x7f4ba1cf4b18 - sys::thread::create::thread_start::h36340a6690985d3f9TH\r\n  21:     0x7f4b9bbc4181 - start_thread\r\n  22:     0x7f4ba18a347c - __clone\r\n  23:                0x0 - <unknown>\r\n```\r\n\r\nrustc version:\r\n\r\n```\r\nrustc 1.0.0-nightly (e2fa53e59 2015-03-20) (built 2015-03-21)\r\nbinary: rustc\r\ncommit-hash: e2fa53e593a854a609ae9efe5a1bbe15265f0a6f\r\ncommit-date: 2015-03-20\r\nbuild-date: 2015-03-21\r\nhost: x86_64-unknown-linux-gnu\r\nrelease: 1.0.0-nightly\r\n```\r\n\r\nI didn't see any other open issues mentioning `capacity overflow`.\r\n", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/23600/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/23600/timeline", "performed_via_github_app": null, "state_reason": null}