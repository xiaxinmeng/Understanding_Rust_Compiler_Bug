{"url": "https://api.github.com/repos/rust-lang/rust/issues/88704", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/88704/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/88704/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/88704/events", "html_url": "https://github.com/rust-lang/rust/issues/88704", "id": 989418452, "node_id": "MDU6SXNzdWU5ODk0MTg0NTI=", "number": 88704, "title": "Linker  hangs with no output 9/10 times.", "user": {"login": "hydra", "id": 57075, "node_id": "MDQ6VXNlcjU3MDc1", "avatar_url": "https://avatars.githubusercontent.com/u/57075?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hydra", "html_url": "https://github.com/hydra", "followers_url": "https://api.github.com/users/hydra/followers", "following_url": "https://api.github.com/users/hydra/following{/other_user}", "gists_url": "https://api.github.com/users/hydra/gists{/gist_id}", "starred_url": "https://api.github.com/users/hydra/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hydra/subscriptions", "organizations_url": "https://api.github.com/users/hydra/orgs", "repos_url": "https://api.github.com/users/hydra/repos", "events_url": "https://api.github.com/users/hydra/events{/privacy}", "received_events_url": "https://api.github.com/users/hydra/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 266005714, "node_id": "MDU6TGFiZWwyNjYwMDU3MTQ=", "url": "https://api.github.com/repos/rust-lang/rust/labels/O-windows-gnu", "name": "O-windows-gnu", "color": "6e6ec0", "default": false, "description": "Toolchain: GNU, Operating system: Windows"}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}, {"id": 1168029555, "node_id": "MDU6TGFiZWwxMTY4MDI5NTU1", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-hang", "name": "I-hang", "color": "e10c02", "default": false, "description": "Issue: The compiler never terminates, due to infinite loops, deadlock, livelock, etc."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 16, "created_at": "2021-09-06T20:16:43Z", "updated_at": "2023-06-17T22:23:35Z", "closed_at": "2023-06-17T22:23:35Z", "author_association": "NONE", "active_lock_reason": null, "body": "When building various example projects, I find that the rust-lld.exe linker will just stall instead of creating the .elf file.  When it works, it takes about 0.4seconds, most of the time it fails and you have to ctrl+c the command and retry, it's obviously ridiculously frustrating, especially during a pair programming session.\r\n\r\nTo make sure there was nothing odd on my PC that might be affecting it, I did a complete fresh install of the OS, rust and the tools, yet the same thing still happens.\r\n\r\nI was able to record detailed logs using ProcessMonitor of the failure.  Attached to this issue are 3 files:\r\n\r\n\r\n1) `good.CSV`, a log from when it works.\r\n\r\n[good.CSV](https://github.com/rust-lang/rust/files/7117713/good.CSV)\r\n\r\nThe output was this:\r\n```\r\nPS D:\\Users\\Hydra\\Documents\\dev\\playground\\rust\\rtic\\rtic-examples\\rtic_v6\\stm32f4_pwm_monitor> cargo build -j1\r\n   Compiling stm32f4_pwm_input v0.1.0 (D:\\Users\\Hydra\\Documents\\dev\\playground\\rust\\rtic\\rtic-examples\\rtic_v6\\stm32f4_pwm_monitor)\r\n    Finished dev [unoptimized + debuginfo] target(s) in 0.70s\r\n```\r\n\r\n2) `bad.CSV` and 3) `bad-after-killing.CSV`.  A trace was started and saved as `bad.CSV` when rust-lld.exe hanged, then a new trace was started, ctrl+c was pressed and the new trace was saved as `bad-after-killing.CSV` so that you can see what happens before and after ctrl+c was pressed.\r\n\r\n[bad.CSV](https://github.com/rust-lang/rust/files/7117711/bad.CSV)\r\n[bad-after-killing.CSV](https://github.com/rust-lang/rust/files/7117712/bad-after-killing.CSV)\r\n\r\nThe output, when it fails is this:\r\n```\r\n...\r\nCompiling stm32f4_pwm_input v0.1.0 (D:\\Users\\Hydra\\Documents\\dev\\playground\\rust\\rtic\\rtic-examples\\rtic_v6\\stm32f4_pwm_monitor)\r\n    Building [=========================> ] 98/99: stm32f4_pwm_input(bin)\r\n```\r\n\r\nI'm compiling for an STM32F446RE CPU.\r\n\r\nI tried with `stable` and with `nightly`\r\n\r\n### Meta\r\n\r\nProject source: [rtic-examples.zip](https://github.com/rust-lang/rust/files/7117710/rtic-examples.zip)\r\n\r\nNightly:\r\n```\r\n> rustup show\r\nDefault host: x86_64-pc-windows-gnu\r\nrustup home:  D:\\Users\\Hydra\\.rustup\r\n\r\ninstalled toolchains\r\n--------------------\r\n\r\nstable-x86_64-pc-windows-gnu\r\nnightly-x86_64-pc-windows-gnu (default)\r\n\r\ninstalled targets for active toolchain\r\n--------------------------------------\r\n\r\nthumbv7em-none-eabihf\r\nx86_64-pc-windows-gnu\r\n\r\nactive toolchain\r\n----------------\r\n\r\nnightly-x86_64-pc-windows-gnu (default)\r\nrustc 1.57.0-nightly (e30b68353 2021-09-05)\r\n```\r\n\r\nStable:\r\n```\r\n> rustup show\r\nDefault host: x86_64-pc-windows-gnu\r\nrustup home:  D:\\Users\\Hydra\\.rustup\r\n\r\ninstalled toolchains\r\n--------------------\r\n\r\nstable-x86_64-pc-windows-gnu (default)\r\nnightly-x86_64-pc-windows-gnu\r\n\r\ninstalled targets for active toolchain\r\n--------------------------------------\r\n\r\nthumbv7em-none-eabihf\r\nx86_64-pc-windows-gnu\r\n\r\nactive toolchain\r\n----------------\r\n\r\nstable-x86_64-pc-windows-gnu (default)\r\nrustc 1.54.0 (a178d0322 2021-07-26)\r\n```\r\nHardware:\r\n```\r\nProcessor\tAMD Ryzen 9 5950X 16-Core Processor               3.40 GHz\r\nInstalled RAM\t64.0 GB\r\n```\r\n\r\nOS:\r\n```\r\nEdition\tWindows 10 Pro\r\nVersion\t21H1\r\nInstalled on\t\u200e05/\u200e09/\u200e2021\r\nOS build\t19043.928\r\nExperience\tWindows Feature Experience Pack 120.2212.551.0\r\n```\r\n\r\nIf you need more information/logs/etc, just tell me what commands you want me to run and what output/files to provide.", "closed_by": {"login": "hydra", "id": 57075, "node_id": "MDQ6VXNlcjU3MDc1", "avatar_url": "https://avatars.githubusercontent.com/u/57075?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hydra", "html_url": "https://github.com/hydra", "followers_url": "https://api.github.com/users/hydra/followers", "following_url": "https://api.github.com/users/hydra/following{/other_user}", "gists_url": "https://api.github.com/users/hydra/gists{/gist_id}", "starred_url": "https://api.github.com/users/hydra/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hydra/subscriptions", "organizations_url": "https://api.github.com/users/hydra/orgs", "repos_url": "https://api.github.com/users/hydra/repos", "events_url": "https://api.github.com/users/hydra/events{/privacy}", "received_events_url": "https://api.github.com/users/hydra/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/88704/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/88704/timeline", "performed_via_github_app": null, "state_reason": "completed"}