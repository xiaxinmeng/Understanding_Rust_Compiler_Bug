{"url": "https://api.github.com/repos/rust-lang/rust/issues/43617", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/43617/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/43617/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/43617/events", "html_url": "https://github.com/rust-lang/rust/issues/43617", "id": 247533192, "node_id": "MDU6SXNzdWUyNDc1MzMxOTI=", "number": 43617, "title": "Inconsistent current_exe behavior for symlinks on different platforms", "user": {"login": "jeffweiss", "id": 818053, "node_id": "MDQ6VXNlcjgxODA1Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/818053?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jeffweiss", "html_url": "https://github.com/jeffweiss", "followers_url": "https://api.github.com/users/jeffweiss/followers", "following_url": "https://api.github.com/users/jeffweiss/following{/other_user}", "gists_url": "https://api.github.com/users/jeffweiss/gists{/gist_id}", "starred_url": "https://api.github.com/users/jeffweiss/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jeffweiss/subscriptions", "organizations_url": "https://api.github.com/users/jeffweiss/orgs", "repos_url": "https://api.github.com/users/jeffweiss/repos", "events_url": "https://api.github.com/users/jeffweiss/events{/privacy}", "received_events_url": "https://api.github.com/users/jeffweiss/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 234902, "node_id": "MDU6TGFiZWwyMzQ5MDI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-enhancement", "name": "C-enhancement", "color": "f5f1fd", "default": false, "description": "Category: An issue proposing an enhancement or a PR with one."}, {"id": 60344715, "node_id": "MDU6TGFiZWw2MDM0NDcxNQ==", "url": "https://api.github.com/repos/rust-lang/rust/labels/P-medium", "name": "P-medium", "color": "eb6420", "default": false, "description": "Medium priority"}, {"id": 211668062, "node_id": "MDU6TGFiZWwyMTE2NjgwNjI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-libs-api", "name": "T-libs-api", "color": "bfd4f2", "default": false, "description": "Relevant to the library API team, which will review and decide on the PR/issue."}, {"id": 431251592, "node_id": "MDU6TGFiZWw0MzEyNTE1OTI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-docs", "name": "A-docs", "color": "f7e101", "default": false, "description": "Area: documentation for any part of the project, including the compiler, standard library, and tools"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2017-08-02T21:50:51Z", "updated_at": "2018-01-06T05:20:31Z", "closed_at": "2018-01-06T05:20:31Z", "author_association": "NONE", "active_lock_reason": null, "body": "## Background\r\n\r\nI was attempting to use `std::env::current_exe()` to figure out how my program was invoked so I could respond with convenience code paths (analogous to how `gpgv` is basically a shortcut/alias for `gpg --verify`) when I noticed inconsistent behavior between OS X and Linux when the program was invoked via a symbolic link.\r\n\r\n## Steps to Reproduce\r\n\r\n`test.rs`\r\n```rust\r\nfn main() {\r\n    println!(\"{:?}\", std::env::current_exe());\r\n}\r\n```\r\n```bash\r\n$ rustc test.rs\r\n$ ln test one\r\n$ ln -s test two\r\n$ ./test\r\n$ ./one\r\n$ ./two\r\n```\r\nFor convenience I have bundled these in a repo: [jeffweiss/rust-current_exe](https://github.com/jeffweiss/rust-current_exe)\r\n\r\n## Rust Version\r\nrustc 1.19.0 (0ade33941 2017-07-17)\r\n\r\n## Expected Behavior\r\n\r\nOn all platforms, I would expect to get:\r\n```\r\nOk(\"/home/jweiss/devel/jeffweiss/rust-current_exe/test\")\r\nOk(\"/home/jweiss/devel/jeffweiss/rust-current_exe/one\")\r\nOk(\"/home/jweiss/devel/jeffweiss/rust-current_exe/two\")\r\n```\r\n\r\n## Actual Behavior\r\n\r\nOn Mac OS X, I get:\r\n```\r\nOk(\"/home/jweiss/devel/jeffweiss/rust-current_exe/test\")\r\nOk(\"/home/jweiss/devel/jeffweiss/rust-current_exe/one\")\r\nOk(\"/home/jweiss/devel/jeffweiss/rust-current_exe/two\")\r\n```\r\n\r\nOn Linux, I get:\r\n```\r\nOk(\"/home/jweiss/devel/jeffweiss/rust-current_exe/test\")\r\nOk(\"/home/jweiss/devel/jeffweiss/rust-current_exe/one\")\r\nOk(\"/home/jweiss/devel/jeffweiss/rust-current_exe/test\")\r\n```\r\n\r\n\r\n## Related Documentation\r\n\r\nThe [documentation](https://github.com/rust-lang/rust/blob/7acce3724d6ba5cb84d6eef6d6847f8573a1fe5a/src/libstd/env.rs#L602-L614) for `std::env::current_exe` implies that if you run `current_exe` from the symlink, you'll get the name of the symlink, not the dereferenced target of the symlink; however, the documentation's example does not actually include a symbolic link (`ln -s`), but rather a hard link (`ln`).", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/43617/reactions", "total_count": 2, "+1": 1, "-1": 0, "laugh": 0, "hooray": 1, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/43617/timeline", "performed_via_github_app": null, "state_reason": "completed"}