{"url": "https://api.github.com/repos/rust-lang/rust/issues/101640", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/101640/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/101640/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/101640/events", "html_url": "https://github.com/rust-lang/rust/issues/101640", "id": 1368542398, "node_id": "I_kwDOAAsO6M5Rkky-", "number": 101640, "title": "rustc panicked when trying to compile `once_cell`", "user": {"login": "Andy-Python-Programmer", "id": 62820092, "node_id": "MDQ6VXNlcjYyODIwMDky", "avatar_url": "https://avatars.githubusercontent.com/u/62820092?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Andy-Python-Programmer", "html_url": "https://github.com/Andy-Python-Programmer", "followers_url": "https://api.github.com/users/Andy-Python-Programmer/followers", "following_url": "https://api.github.com/users/Andy-Python-Programmer/following{/other_user}", "gists_url": "https://api.github.com/users/Andy-Python-Programmer/gists{/gist_id}", "starred_url": "https://api.github.com/users/Andy-Python-Programmer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Andy-Python-Programmer/subscriptions", "organizations_url": "https://api.github.com/users/Andy-Python-Programmer/orgs", "repos_url": "https://api.github.com/users/Andy-Python-Programmer/repos", "events_url": "https://api.github.com/users/Andy-Python-Programmer/events{/privacy}", "received_events_url": "https://api.github.com/users/Andy-Python-Programmer/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}, {"id": 147085028, "node_id": "MDU6TGFiZWwxNDcwODUwMjg=", "url": "https://api.github.com/repos/rust-lang/rust/labels/regression-from-stable-to-nightly", "name": "regression-from-stable-to-nightly", "color": "e4008a", "default": false, "description": "Performance or correctness regression from stable to nightly."}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}, {"id": 4417099521, "node_id": "LA_kwDOAAsO6M8AAAABB0eXAQ", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-translation", "name": "A-translation", "color": "f7e101", "default": false, "description": "Area: Translation infrastructure, and migrating existing diagnostics to SessionDiagnostic"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-09-10T07:54:34Z", "updated_at": "2022-10-20T15:10:28Z", "closed_at": "2022-09-11T18:49:27Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Compiler panic when it was trying to compile the crate `once_cell`:\r\n\r\n ```\r\n   Compiling compiler_builtins v0.1.79\r\n   Compiling core v0.0.0 (/home/andy/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core)\r\n   Compiling autocfg v1.1.0\r\n   Compiling version_check v0.9.4\r\n   Compiling crossbeam-utils v0.8.11\r\n   Compiling proc-macro2 v1.0.43\r\n   Compiling cfg-if v1.0.0\r\n   Compiling once_cell v1.14.0\r\n   Compiling libc v0.2.132\r\n   Compiling quote v1.0.21\r\n   Compiling unicode-ident v1.0.3\r\n   Compiling scopeguard v1.1.0\r\n   Compiling rayon-core v1.9.3\r\n   Compiling syn v1.0.99\r\n   Compiling either v1.8.0\r\n   Compiling log v0.4.17\r\n   Compiling serde v1.0.144\r\n   Compiling cc v1.0.73\r\n   Compiling serde_json v1.0.85\r\n   Compiling proc-macro-error-attr v1.0.4\r\n   Compiling proc-macro-error v1.0.4\r\n   Compiling ahash v0.7.6\r\n   Compiling memoffset v0.6.5\r\n   Compiling crossbeam-epoch v0.9.10\r\n   Compiling rayon v1.5.3\r\n   Compiling memoffset v0.5.6\r\n   Compiling crossbeam-channel v0.5.6\r\n   Compiling crossbeam-deque v0.8.2\r\n   Compiling num_cpus v1.13.1\r\n   Compiling lai v0.1.0 (https://github.com/aero-os/lai-rs#dd82efe6)\r\n   Compiling vte_generate_state_changes v0.1.1 (https://github.com/Andy-Python-Programmer/vte#a9d8bf89)\r\n   Compiling nasm-rs v0.2.4\r\n   Compiling aero_kernel v0.1.0 (/home/andy/aero/src/aero_kernel)\r\n   Compiling aero_proc v0.1.0 (/home/andy/aero/src/aero_proc)\r\n   Compiling rustc-std-workspace-core v1.99.0 (/home/andy/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/rustc-std-workspace-core)\r\n   Compiling alloc v0.0.0 (/home/andy/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/alloc)\r\n   Compiling bitflags v1.3.2\r\n   Compiling zero v0.1.2\r\n   Compiling utf8parse v0.2.0 (https://github.com/Andy-Python-Programmer/vte#a9d8bf89)\r\n   Compiling ryu v1.0.11\r\n   Compiling arrayvec v0.7.2\r\n   Compiling spin v0.5.2\r\nthread 'rustc' panicked at 'identifier: \"metadata_std_required\", attr: None, args: FluentArgs([(\"add_info\", String(\"\")), (\"crate_name\", String(\"std\")), (\"locator_triple\", String(\"x86_64-aero_os\"))]), errors: [ResolverError(Reference(Variable { id: \"current_crate\" }))]', compiler/rustc_errors/src/translation.rs:91:17\r\nstack backtrace:\r\n   0:     0x7fa8147e9eb0 - std::backtrace_rs::backtrace::libunwind::trace::hd4d72bf9fe10967c\r\n                               at /rustc/1120c5e01df508de64fe6642f22fadeb574afd6d/library/std/src/../../backtrace/src/backtrace/mod.rs:66:5\r\n   1:     0x7fa8147e9eb0 - std::backtrace_rs::backtrace::trace_unsynchronized::h6503f59b8cbe2ed6\r\n                               at /rustc/1120c5e01df508de64fe6642f22fadeb574afd6d/library/std/src/../../backtrace/src/backtrace/mod.rs:66:5\r\n   2:     0x7fa8147e9eb0 - std::sys_common::backtrace::_print_fmt::h589945bf8bc39343\r\n                               at /rustc/1120c5e01df508de64fe6642f22fadeb574afd6d/library/std/src/sys_common/backtrace.rs:66:5\r\n   3:     0x7fa8147e9eb0 - <std::sys_common::backtrace::_print::DisplayBacktrace as core::fmt::Display>::fmt::h2f4d863594a68c91\r\n                               at /rustc/1120c5e01df508de64fe6642f22fadeb574afd6d/library/std/src/sys_common/backtrace.rs:45:22\r\n   4:     0x7fa814844efe - core::fmt::write::h9fd78932fc37b51c\r\n                               at /rustc/1120c5e01df508de64fe6642f22fadeb574afd6d/library/core/src/fmt/mod.rs:1202:17\r\n   5:     0x7fa8147da595 - std::io::Write::write_fmt::h6066f9f8807a65d2\r\n                               at /rustc/1120c5e01df508de64fe6642f22fadeb574afd6d/library/std/src/io/mod.rs:1679:15\r\n   6:     0x7fa8147ecb63 - std::sys_common::backtrace::_print::h355143466bed5429\r\n                               at /rustc/1120c5e01df508de64fe6642f22fadeb574afd6d/library/std/src/sys_common/backtrace.rs:48:5\r\n   7:     0x7fa8147ecb63 - std::sys_common::backtrace::print::hb82c149c248573a7\r\n                               at /rustc/1120c5e01df508de64fe6642f22fadeb574afd6d/library/std/src/sys_common/backtrace.rs:35:9\r\n   8:     0x7fa8147ecb63 - std::panicking::default_hook::{{closure}}::h9412e92c58f99121\r\n                               at /rustc/1120c5e01df508de64fe6642f22fadeb574afd6d/library/std/src/panicking.rs:295:22\r\n   9:     0x7fa8147ec84f - std::panicking::default_hook::h1a8b46d36ee22d51\r\n                               at /rustc/1120c5e01df508de64fe6642f22fadeb574afd6d/library/std/src/panicking.rs:314:9\r\n  10:     0x7fa817050101 - rustc_driver[8f3cca79f91367d]::DEFAULT_HOOK::{closure#0}::{closure#0}\r\n  11:     0x7fa8147ed39d - std::panicking::rust_panic_with_hook::he6adbff8aae13c88\r\n                               at /rustc/1120c5e01df508de64fe6642f22fadeb574afd6d/library/std/src/panicking.rs:702:17\r\n  12:     0x7fa8147ed1f7 - std::panicking::begin_panic_handler::{{closure}}::hc2cade6d6762c671\r\n                               at /rustc/1120c5e01df508de64fe6642f22fadeb574afd6d/library/std/src/panicking.rs:588:13\r\n  13:     0x7fa8147ea35c - std::sys_common::backtrace::__rust_end_short_backtrace::h2a054ca94f99dcb2\r\n                               at /rustc/1120c5e01df508de64fe6642f22fadeb574afd6d/library/std/src/sys_common/backtrace.rs:138:18\r\n  14:     0x7fa8147ecf12 - rust_begin_unwind\r\n                               at /rustc/1120c5e01df508de64fe6642f22fadeb574afd6d/library/std/src/panicking.rs:584:5\r\n  15:     0x7fa814841ad3 - core::panicking::panic_fmt::h5894a80f27bddaf0\r\n                               at /rustc/1120c5e01df508de64fe6642f22fadeb574afd6d/library/core/src/panicking.rs:142:14\r\n  16:     0x7fa816db51c7 - <rustc_errors[724a1349d7209c57]::emitter::EmitterWriter as rustc_errors[724a1349d7209c57]::translation::Translate>::translate_message\r\n  17:     0x7fa816da9a42 - <rustc_errors[724a1349d7209c57]::emitter::EmitterWriter>::msg_to_buffer\r\n  18:     0x7fa816db23e0 - <rustc_errors[724a1349d7209c57]::emitter::EmitterWriter>::emit_message_default\r\n  19:     0x7fa816da0db4 - <rustc_errors[724a1349d7209c57]::emitter::EmitterWriter as rustc_errors[724a1349d7209c57]::emitter::Emitter>::emit_diagnostic\r\n  20:     0x7fa816d9e39d - <rustc_errors[724a1349d7209c57]::json::Diagnostic>::from_errors_diagnostic\r\n  21:     0x7fa816d9c4be - <rustc_errors[724a1349d7209c57]::json::JsonEmitter as rustc_errors[724a1349d7209c57]::emitter::Emitter>::emit_diagnostic\r\n  22:     0x7fa815a8429d - <rustc_errors[724a1349d7209c57]::HandlerInner>::emit_diagnostic\r\n  23:     0x7fa815a83c51 - <rustc_errors[724a1349d7209c57]::Handler>::emit_diagnostic\r\n  24:     0x7fa81643c91d - <rustc_errors[724a1349d7209c57]::ErrorGuaranteed as rustc_errors[724a1349d7209c57]::diagnostic_builder::EmissionGuarantee>::diagnostic_builder_emit_producing_guarantee\r\n  25:     0x7fa817caf159 - <rustc_session[c1d6deef70235337]::session::Session>::emit_err::<rustc_metadata[d349275093e5e780]::errors::CannotFindCrate>\r\n  26:     0x7fa817c74dc3 - <rustc_metadata[d349275093e5e780]::locator::CrateError>::report\r\n  27:     0x7fa815f3a135 - <rustc_metadata[d349275093e5e780]::creader::CrateLoader>::resolve_crate\r\n  28:     0x7fa8165be83c - <rustc_metadata[d349275093e5e780]::creader::CrateLoader>::process_extern_crate\r\n  29:     0x7fa8165b24f0 - <rustc_resolve[579e1b26d270dc87]::build_reduced_graph::BuildReducedGraphVisitor as rustc_ast[67ecbb9fd5a6d181]::visit::Visitor>::visit_item\r\n  30:     0x7fa8165c1941 - <rustc_resolve[579e1b26d270dc87]::build_reduced_graph::BuildReducedGraphVisitor as rustc_ast[67ecbb9fd5a6d181]::visit::Visitor>::visit_crate\r\n  31:     0x7fa8165aaa0c - <rustc_resolve[579e1b26d270dc87]::Resolver as rustc_expand[f693658ddb737e69]::base::ResolverExpand>::visit_ast_fragment_with_placeholders\r\n  32:     0x7fa816774130 - <rustc_expand[f693658ddb737e69]::expand::MacroExpander>::fully_expand_fragment\r\n  33:     0x7fa815e640c3 - <rustc_expand[f693658ddb737e69]::expand::MacroExpander>::expand_crate\r\n  34:     0x7fa815e632d3 - <rustc_session[c1d6deef70235337]::session::Session>::time::<core[3035f67f4d4c8105]::result::Result<rustc_ast[67ecbb9fd5a6d181]::ast::Crate, rustc_errors[724a1349d7209c57]::ErrorGuaranteed>, rustc_interface[a2838c864f6eb7ab]::passes::configure_and_expand::{closure#1}>\r\n  35:     0x7fa815e2b843 - rustc_interface[a2838c864f6eb7ab]::passes::configure_and_expand\r\n  36:     0x7fa815e22165 - <rustc_interface[a2838c864f6eb7ab]::queries::Queries>::expansion\r\n  37:     0x7fa815e1eafc - rustc_interface[a2838c864f6eb7ab]::interface::create_compiler_and_run::<core[3035f67f4d4c8105]::result::Result<(), rustc_errors[724a1349d7209c57]::ErrorGuaranteed>, rustc_driver[8f3cca79f91367d]::run_compiler::{closure#1}>\r\n  38:     0x7fa815e1d531 - <scoped_tls[f2fbc1eb2eeeae22]::ScopedKey<rustc_span[5934fe088b167bef]::SessionGlobals>>::set::<rustc_interface[a2838c864f6eb7ab]::interface::run_compiler<core[3035f67f4d4c8105]::result::Result<(), rustc_errors[724a1349d7209c57]::ErrorGuaranteed>, rustc_driver[8f3cca79f91367d]::run_compiler::{closure#1}>::{closure#0}, core[3035f67f4d4c8105]::result::Result<(), rustc_errors[724a1349d7209c57]::ErrorGuaranteed>>\r\n  39:     0x7fa815e1d21f - std[dce46a4773fb9772]::sys_common::backtrace::__rust_begin_short_backtrace::<rustc_interface[a2838c864f6eb7ab]::util::run_in_thread_pool_with_globals<rustc_interface[a2838c864f6eb7ab]::interface::run_compiler<core[3035f67f4d4c8105]::result::Result<(), rustc_errors[724a1349d7209c57]::ErrorGuaranteed>, rustc_driver[8f3cca79f91367d]::run_compiler::{closure#1}>::{closure#0}, core[3035f67f4d4c8105]::result::Result<(), rustc_errors[724a1349d7209c57]::ErrorGuaranteed>>::{closure#0}, core[3035f67f4d4c8105]::result::Result<(), rustc_errors[724a1349d7209c57]::ErrorGuaranteed>>\r\n  40:     0x7fa816eba610 - <<std[dce46a4773fb9772]::thread::Builder>::spawn_unchecked_<rustc_interface[a2838c864f6eb7ab]::util::run_in_thread_pool_with_globals<rustc_interface[a2838c864f6eb7ab]::interface::run_compiler<core[3035f67f4d4c8105]::result::Result<(), rustc_errors[724a1349d7209c57]::ErrorGuaranteed>, rustc_driver[8f3cca79f91367d]::run_compiler::{closure#1}>::{closure#0}, core[3035f67f4d4c8105]::result::Result<(), rustc_errors[724a1349d7209c57]::ErrorGuaranteed>>::{closure#0}, core[3035f67f4d4c8105]::result::Result<(), rustc_errors[724a1349d7209c57]::ErrorGuaranteed>>::{closure#1} as core[3035f67f4d4c8105]::ops::function::FnOnce<()>>::call_once::{shim:vtable#0}\r\n  41:     0x7fa8147f7173 - <alloc::boxed::Box<F,A> as core::ops::function::FnOnce<Args>>::call_once::h2546ce459201572e\r\n                               at /rustc/1120c5e01df508de64fe6642f22fadeb574afd6d/library/alloc/src/boxed.rs:1940:9\r\n  42:     0x7fa8147f7173 - <alloc::boxed::Box<F,A> as core::ops::function::FnOnce<Args>>::call_once::ha02ec324858dc3c8\r\n                               at /rustc/1120c5e01df508de64fe6642f22fadeb574afd6d/library/alloc/src/boxed.rs:1940:9\r\n  43:     0x7fa8147f7173 - std::sys::unix::thread::Thread::new::thread_start::h9bd74d28238bdb06\r\n                               at /rustc/1120c5e01df508de64fe6642f22fadeb574afd6d/library/std/src/sys/unix/thread.rs:108:17\r\n  44:     0x7fa8146b7609 - start_thread\r\n                               at /build/glibc-SzIz7B/glibc-2.31/nptl/pthread_create.c:477:8\r\n   Compiling itoa v1.0.3\r\n   Compiling static_assertions v1.1.0\r\n  45:     0x7fa8145da133 - clone\r\n                               at /build/glibc-SzIz7B/glibc-2.31/misc/../sysdeps/unix/sysv/linux/x86_64/clone.S:95\r\n  46:                0x0 - <unknown>\r\n\r\nerror: internal compiler error: unexpected panic\r\n\r\nnote: the compiler unexpectedly panicked. this is a bug.\r\n\r\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/issues/new?labels=C-bug%2C+I-ICE%2C+T-compiler&template=ice.md\r\n\r\nnote: rustc 1.65.0-nightly (1120c5e01 2022-09-08) running on x86_64-unknown-linux-gnu\r\n\r\nnote: compiler flags: --crate-type lib -C opt-level=3 -C embed-bitcode=no -C debuginfo=2 -Z unstable-options -C force-frame-pointers=yes\r\n\r\nnote: some of the compiler flags provided by cargo are hidden\r\n\r\nquery stack during panic:\r\nend of query stack\r\nerror: could not compile `once_cell`\r\nwarning: build failed, waiting for other jobs to finish...\r\n```", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/101640/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/101640/timeline", "performed_via_github_app": null, "state_reason": "completed"}