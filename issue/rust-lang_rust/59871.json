{"url": "https://api.github.com/repos/rust-lang/rust/issues/59871", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/59871/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/59871/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/59871/events", "html_url": "https://github.com/rust-lang/rust/issues/59871", "id": 431824257, "node_id": "MDU6SXNzdWU0MzE4MjQyNTc=", "number": 59871, "title": "tests directory can't use 2018 module style, requires mod.rs", "user": {"login": "Clockwork-Muse", "id": 5569508, "node_id": "MDQ6VXNlcjU1Njk1MDg=", "avatar_url": "https://avatars.githubusercontent.com/u/5569508?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Clockwork-Muse", "html_url": "https://github.com/Clockwork-Muse", "followers_url": "https://api.github.com/users/Clockwork-Muse/followers", "following_url": "https://api.github.com/users/Clockwork-Muse/following{/other_user}", "gists_url": "https://api.github.com/users/Clockwork-Muse/gists{/gist_id}", "starred_url": "https://api.github.com/users/Clockwork-Muse/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Clockwork-Muse/subscriptions", "organizations_url": "https://api.github.com/users/Clockwork-Muse/orgs", "repos_url": "https://api.github.com/users/Clockwork-Muse/repos", "events_url": "https://api.github.com/users/Clockwork-Muse/events{/privacy}", "received_events_url": "https://api.github.com/users/Clockwork-Muse/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-04-11T04:23:59Z", "updated_at": "2019-04-11T18:56:12Z", "closed_at": "2019-04-11T18:56:12Z", "author_association": "NONE", "active_lock_reason": null, "body": "```\r\nrustc --version --verbose\r\nrustc 1.33.0 (2aa4c46cf 2019-02-28)\r\nbinary: rustc\r\ncommit-hash: 2aa4c46cfdd726e97360c2734835aa3515e8c858\r\ncommit-date: 2019-02-28\r\nhost: x86_64-pc-windows-msvc\r\nrelease: 1.33.0\r\nLLVM version: 8.0\r\n```\r\n\r\nDue to the fact that I prefer to keep my files small, and tests (mostly) separated from deployed code, I've been using the `tests` directory.  \r\nUnfortunately, I can't convert the directory to the new style module declarations.  For a project that has this structure:\r\n```\r\ntest_mod\r\n    src\r\n        some_module\r\n            sub_module.rs\r\n        lib.rs\r\n        some_module.rs\r\n    tests\r\n        some_module_test\r\n            sub_module_test.rs\r\n        lib.rs\r\n        some_module_test.rs\r\n    Cargo.toml\r\n```\r\n.... it errors out with:\r\n```\r\nerror[E0583]: file not found for module `sub_module_test`\r\n --> tests\\some_module_test.rs:1:9\r\n  |\r\n1 | pub mod sub_module_test;\r\n  |         ^^^^^^^^^^^^^^^\r\n  |\r\n  = help: name the file either sub_module_test.rs or sub_module_test\\mod.rs inside the directory \"tests\"\r\n\r\nerror: aborting due to previous error\r\n```\r\n\r\nMoving `test_mod\\tests\\some_module_test\\sub_module_test.rs` to `test_mod\\tests\\sub_module_test.rs` yields:\r\n\r\n```\r\nerror[E0583]: file not found for module `sub_module_test`\r\n --> tests\\some_module_test.rs:1:9\r\n  |\r\n1 | pub mod sub_module_test;\r\n  |         ^^^^^^^^^^^^^^^\r\n  |\r\n  = help: name the file either some_module_test\\sub_module_test.rs or some_module_test\\sub_module_test\\mod.rs inside the directory \"tests\"\r\n\r\nerror: aborting due to previous error\r\n```\r\n... which suggests that the layout _should_ be valid.\r\n\r\nSo, is the intention that I be able to convert to the new style?  Or is the expectation that the old style still be used here?\r\n\r\nI'm guessing that this might be related to the fact that `test_mod\\tests\\lib.rs` can actually be named anything, and the code still compiles/runs - which means you should be able to remove that file, if the paths otherwise worked the same.\r\n\r\n[example_project.zip](https://github.com/rust-lang/rust/files/3066882/example_project.zip)\r\n", "closed_by": {"login": "Clockwork-Muse", "id": 5569508, "node_id": "MDQ6VXNlcjU1Njk1MDg=", "avatar_url": "https://avatars.githubusercontent.com/u/5569508?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Clockwork-Muse", "html_url": "https://github.com/Clockwork-Muse", "followers_url": "https://api.github.com/users/Clockwork-Muse/followers", "following_url": "https://api.github.com/users/Clockwork-Muse/following{/other_user}", "gists_url": "https://api.github.com/users/Clockwork-Muse/gists{/gist_id}", "starred_url": "https://api.github.com/users/Clockwork-Muse/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Clockwork-Muse/subscriptions", "organizations_url": "https://api.github.com/users/Clockwork-Muse/orgs", "repos_url": "https://api.github.com/users/Clockwork-Muse/repos", "events_url": "https://api.github.com/users/Clockwork-Muse/events{/privacy}", "received_events_url": "https://api.github.com/users/Clockwork-Muse/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/59871/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 1}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/59871/timeline", "performed_via_github_app": null, "state_reason": "completed"}