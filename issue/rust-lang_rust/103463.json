{"url": "https://api.github.com/repos/rust-lang/rust/issues/103463", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/103463/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/103463/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/103463/events", "html_url": "https://github.com/rust-lang/rust/issues/103463", "id": 1420246381, "node_id": "I_kwDOAAsO6M5Upz1t", "number": 103463, "title": "thread 'rustc' panicked at 'no entry found for key', src/librustdoc/passes/collect_intra_doc_links.rs:781:16", "user": {"login": "kpreid", "id": 779501, "node_id": "MDQ6VXNlcjc3OTUwMQ==", "avatar_url": "https://avatars.githubusercontent.com/u/779501?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kpreid", "html_url": "https://github.com/kpreid", "followers_url": "https://api.github.com/users/kpreid/followers", "following_url": "https://api.github.com/users/kpreid/following{/other_user}", "gists_url": "https://api.github.com/users/kpreid/gists{/gist_id}", "starred_url": "https://api.github.com/users/kpreid/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kpreid/subscriptions", "organizations_url": "https://api.github.com/users/kpreid/orgs", "repos_url": "https://api.github.com/users/kpreid/repos", "events_url": "https://api.github.com/users/kpreid/events{/privacy}", "received_events_url": "https://api.github.com/users/kpreid/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 203738, "node_id": "MDU6TGFiZWwyMDM3Mzg=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-rustdoc", "name": "T-rustdoc", "color": "bfd4f2", "default": false, "description": "Relevant to the rustdoc team, which will review and decide on the PR/issue."}, {"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "closed", "locked": false, "assignee": {"login": "petrochenkov", "id": 5751617, "node_id": "MDQ6VXNlcjU3NTE2MTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5751617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petrochenkov", "html_url": "https://github.com/petrochenkov", "followers_url": "https://api.github.com/users/petrochenkov/followers", "following_url": "https://api.github.com/users/petrochenkov/following{/other_user}", "gists_url": "https://api.github.com/users/petrochenkov/gists{/gist_id}", "starred_url": "https://api.github.com/users/petrochenkov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petrochenkov/subscriptions", "organizations_url": "https://api.github.com/users/petrochenkov/orgs", "repos_url": "https://api.github.com/users/petrochenkov/repos", "events_url": "https://api.github.com/users/petrochenkov/events{/privacy}", "received_events_url": "https://api.github.com/users/petrochenkov/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "petrochenkov", "id": 5751617, "node_id": "MDQ6VXNlcjU3NTE2MTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5751617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petrochenkov", "html_url": "https://github.com/petrochenkov", "followers_url": "https://api.github.com/users/petrochenkov/followers", "following_url": "https://api.github.com/users/petrochenkov/following{/other_user}", "gists_url": "https://api.github.com/users/petrochenkov/gists{/gist_id}", "starred_url": "https://api.github.com/users/petrochenkov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petrochenkov/subscriptions", "organizations_url": "https://api.github.com/users/petrochenkov/orgs", "repos_url": "https://api.github.com/users/petrochenkov/repos", "events_url": "https://api.github.com/users/petrochenkov/events{/privacy}", "received_events_url": "https://api.github.com/users/petrochenkov/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2022-10-24T05:32:49Z", "updated_at": "2022-11-02T10:32:04Z", "closed_at": "2022-11-02T10:32:04Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "### Code\r\n\r\n`Cargo.toml`\r\n\r\n```toml\r\n[dependencies]\r\nluminance = \"0.47.0\"\r\n```\r\n\r\n`lib.rs`\r\n\r\n```Rust\r\nuse luminance::context::GraphicsContext;\r\n```\r\n\r\nRun `cargo +nightly doc` on this and get an ICE. Note that documenting `luminance` itself _does not_ panic, and that the `use` is necessary.\r\n\r\n### Meta\r\n<!--\r\nIf you're using the stable version of the compiler, you should also check if the\r\nbug also exists in the beta or nightly versions.\r\n-->\r\n\r\n`rustc --version --verbose`:\r\n```\r\nrustc 1.66.0-nightly (7fcf850d7 2022-10-23)\r\nbinary: rustc\r\ncommit-hash: 7fcf850d7942804990a1d2e3fe036622a0fe4c74\r\ncommit-date: 2022-10-23\r\nhost: x86_64-apple-darwin\r\nrelease: 1.66.0-nightly\r\nLLVM version: 15.0.2\r\n```\r\n\r\nAlso reproduces on Linux (GitHub Actions) with the same nightly version.\r\n\r\n### Error output\r\n\r\n```\r\nthread 'rustc' panicked at 'no entry found for key', src/librustdoc/passes/collect_intra_doc_links.rs:781:16\r\n```\r\n\r\n<!--\r\nInclude a backtrace in the code block by setting `RUST_BACKTRACE=1` in your\r\nenvironment. E.g. `RUST_BACKTRACE=1 cargo build`.\r\n-->\r\n<details><summary><strong>Backtrace</strong></summary>\r\n<p>\r\n\r\n```\r\nstack backtrace:\r\n   0:        0x10acbfad2 - <std::sys_common::backtrace::_print::DisplayBacktrace as core::fmt::Display>::fmt::hc249a3c8297d373c\r\n   1:        0x10ad1782a - core::fmt::write::h1620df6049c84a8a\r\n   2:        0x10acb1a9c - std::io::Write::write_fmt::h5f47dfe6d9626373\r\n   3:        0x10acbf89a - std::sys_common::backtrace::print::h8ac10ae9f1f60af9\r\n   4:        0x10acc2ca6 - std::panicking::default_hook::{{closure}}::h9e29e48aa798ad78\r\n   5:        0x10acc29f7 - std::panicking::default_hook::h7132194e196f4b3d\r\n   6:        0x1151f9d4d - rustc_driver[888de4bb47265800]::DEFAULT_HOOK::{closure#0}::{closure#0}\r\n   7:        0x10acc34a1 - std::panicking::rust_panic_with_hook::h8e7115c018c00df7\r\n   8:        0x10acc3233 - std::panicking::begin_panic_handler::{{closure}}::ha889da438f13c824\r\n   9:        0x10acbff68 - std::sys_common::backtrace::__rust_end_short_backtrace::h731c170607da3cbe\r\n  10:        0x10acc2efd - _rust_begin_unwind\r\n  11:        0x10ad44293 - core::panicking::panic_fmt::h7ba977a8fb3b8591\r\n  12:        0x10ad143ab - core::panicking::panic_display::h1228406ea053a602\r\n  13:        0x10ad1435c - core::panicking::panic_str::h741850756884e007\r\n  14:        0x10ad44259 - core::option::expect_failed::h627b430105f84038\r\n  15:        0x10980dae2 - rustdoc[14cba25f54a62242]::passes::collect_intra_doc_links::resolve_associated_trait_item\r\n  16:        0x10980c8c8 - <rustdoc[14cba25f54a62242]::passes::collect_intra_doc_links::LinkCollector>::resolve_associated_item\r\n  17:        0x10980aa6b - <rustdoc[14cba25f54a62242]::passes::collect_intra_doc_links::LinkCollector>::resolve\r\n  18:        0x10980f335 - <rustdoc[14cba25f54a62242]::passes::collect_intra_doc_links::LinkCollector as rustdoc[14cba25f54a62242]::visit::DocVisitor>::visit_item\r\n  19:        0x10980931f - rustdoc[14cba25f54a62242]::passes::collect_intra_doc_links::collect_intra_doc_links\r\n  20:        0x109882eca - <rustc_session[716ea12a8c5970d3]::session::Session>::time::<rustdoc[14cba25f54a62242]::clean::types::Crate, rustdoc[14cba25f54a62242]::core::run_global_ctxt::{closure#7}>\r\n  21:        0x1097f3b67 - rustdoc[14cba25f54a62242]::core::run_global_ctxt\r\n  22:        0x109883281 - <rustc_session[716ea12a8c5970d3]::session::Session>::time::<(rustdoc[14cba25f54a62242]::clean::types::Crate, rustdoc[14cba25f54a62242]::config::RenderOptions, rustdoc[14cba25f54a62242]::formats::cache::Cache), rustdoc[14cba25f54a62242]::main_args::{closure#1}::{closure#0}::{closure#1}::{closure#0}>\r\n  23:        0x1098c3427 - <rustc_interface[d8b29599c2eaa326]::passes::QueryContext>::enter::<rustdoc[14cba25f54a62242]::main_args::{closure#1}::{closure#0}::{closure#1}, core[e55de32fb73b0f26]::result::Result<(), rustc_errors[5dfd537642e11b91]::ErrorGuaranteed>>\r\n  24:        0x1097708bf - <rustc_interface[d8b29599c2eaa326]::interface::Compiler>::enter::<rustdoc[14cba25f54a62242]::main_args::{closure#1}::{closure#0}, core[e55de32fb73b0f26]::result::Result<(), rustc_errors[5dfd537642e11b91]::ErrorGuaranteed>>\r\n  25:        0x10981e8d0 - rustc_span[d1d6f1e5b2f04214]::with_source_map::<core[e55de32fb73b0f26]::result::Result<(), rustc_errors[5dfd537642e11b91]::ErrorGuaranteed>, rustc_interface[d8b29599c2eaa326]::interface::run_compiler<core[e55de32fb73b0f26]::result::Result<(), rustc_errors[5dfd537642e11b91]::ErrorGuaranteed>, rustdoc[14cba25f54a62242]::main_args::{closure#1}>::{closure#0}::{closure#1}>\r\n  26:        0x1097bf6b6 - <scoped_tls[7fa8ac740b76ff9d]::ScopedKey<rustc_span[d1d6f1e5b2f04214]::SessionGlobals>>::set::<rustc_interface[d8b29599c2eaa326]::interface::run_compiler<core[e55de32fb73b0f26]::result::Result<(), rustc_errors[5dfd537642e11b91]::ErrorGuaranteed>, rustdoc[14cba25f54a62242]::main_args::{closure#1}>::{closure#0}, core[e55de32fb73b0f26]::result::Result<(), rustc_errors[5dfd537642e11b91]::ErrorGuaranteed>>\r\n  27:        0x10982e88a - std[196a9d1e434859e3]::sys_common::backtrace::__rust_begin_short_backtrace::<rustc_interface[d8b29599c2eaa326]::util::run_in_thread_pool_with_globals<rustc_interface[d8b29599c2eaa326]::interface::run_compiler<core[e55de32fb73b0f26]::result::Result<(), rustc_errors[5dfd537642e11b91]::ErrorGuaranteed>, rustdoc[14cba25f54a62242]::main_args::{closure#1}>::{closure#0}, core[e55de32fb73b0f26]::result::Result<(), rustc_errors[5dfd537642e11b91]::ErrorGuaranteed>>::{closure#0}::{closure#0}, core[e55de32fb73b0f26]::result::Result<(), rustc_errors[5dfd537642e11b91]::ErrorGuaranteed>>\r\n  28:        0x109930ba0 - <<std[196a9d1e434859e3]::thread::Builder>::spawn_unchecked_<rustc_interface[d8b29599c2eaa326]::util::run_in_thread_pool_with_globals<rustc_interface[d8b29599c2eaa326]::interface::run_compiler<core[e55de32fb73b0f26]::result::Result<(), rustc_errors[5dfd537642e11b91]::ErrorGuaranteed>, rustdoc[14cba25f54a62242]::main_args::{closure#1}>::{closure#0}, core[e55de32fb73b0f26]::result::Result<(), rustc_errors[5dfd537642e11b91]::ErrorGuaranteed>>::{closure#0}::{closure#0}, core[e55de32fb73b0f26]::result::Result<(), rustc_errors[5dfd537642e11b91]::ErrorGuaranteed>>::{closure#1} as core[e55de32fb73b0f26]::ops::function::FnOnce<()>>::call_once::{shim:vtable#0}\r\n  29:        0x10accc5b7 - std::sys::unix::thread::Thread::new::thread_start::h8e46437cd55f886d\r\n  30:     0x7ff81f3a04e1 - __pthread_start\r\n\r\nerror: internal compiler error: unexpected panic\r\n\r\nnote: the compiler unexpectedly panicked. this is a bug.\r\n\r\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/issues/new?labels=C-bug%2C+I-ICE%2C+T-compiler&template=ice.md\r\n\r\nnote: rustc 1.66.0-nightly (7fcf850d7 2022-10-23) running on x86_64-apple-darwin\r\n\r\nnote: compiler flags: --crate-type bin\r\n\r\nnote: some of the compiler flags provided by cargo are hidden\r\n\r\nquery stack during panic:\r\nend of query stack\r\n```\r\n\r\n</p>\r\n</details>\r\n\r\n@rustbot label +T-rustdoc -T-compiler", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/103463/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/103463/timeline", "performed_via_github_app": null, "state_reason": "completed"}