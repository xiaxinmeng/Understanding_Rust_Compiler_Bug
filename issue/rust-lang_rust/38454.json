{"url": "https://api.github.com/repos/rust-lang/rust/issues/38454", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/38454/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/38454/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/38454/events", "html_url": "https://github.com/rust-lang/rust/issues/38454", "id": 196285446, "node_id": "MDU6SXNzdWUxOTYyODU0NDY=", "number": 38454, "title": "emscripten support broken by cargo file layout changes", "user": {"login": "CryZe", "id": 1451630, "node_id": "MDQ6VXNlcjE0NTE2MzA=", "avatar_url": "https://avatars.githubusercontent.com/u/1451630?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CryZe", "html_url": "https://github.com/CryZe", "followers_url": "https://api.github.com/users/CryZe/followers", "following_url": "https://api.github.com/users/CryZe/following{/other_user}", "gists_url": "https://api.github.com/users/CryZe/gists{/gist_id}", "starred_url": "https://api.github.com/users/CryZe/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CryZe/subscriptions", "organizations_url": "https://api.github.com/users/CryZe/orgs", "repos_url": "https://api.github.com/users/CryZe/repos", "events_url": "https://api.github.com/users/CryZe/events{/privacy}", "received_events_url": "https://api.github.com/users/CryZe/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 474645165, "node_id": "MDU6TGFiZWw0NzQ2NDUxNjU=", "url": "https://api.github.com/repos/rust-lang/rust/labels/O-wasm", "name": "O-wasm", "color": "6e6ec0", "default": false, "description": "Target: WASM (WebAssembly), http://webassembly.org/"}, {"id": 509440702, "node_id": "MDU6TGFiZWw1MDk0NDA3MDI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/O-asmjs", "name": "O-asmjs", "color": "6e6ec0", "default": false, "description": "Target: asm.js - http://asmjs.org/"}, {"id": 609101895, "node_id": "MDU6TGFiZWw2MDkxMDE4OTU=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-cargo", "name": "T-cargo", "color": "bfd4f2", "default": false, "description": "Relevant to the cargo team, which will review and decide on the PR/issue."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2016-12-18T16:46:53Z", "updated_at": "2017-05-22T20:57:56Z", "closed_at": "2017-05-22T20:57:40Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Looks like the compiler uses hashes as postfixes for the deps now. This messes with emscripten though, as the final \"binaries\" don't get copied out of the deps folder correctly anymore. Also the original names get baked into the JS files, so even if copied out correctly, they can't find each other anymore.\r\n\r\n```\r\nUncaught could not load memory initializer aoc-66434e595ec0b4e8.js.mem\r\n```\r\n\r\nTo clarify, the final JS binary is located in the `target/asmjs-unknown-emscripten/release/` folder as `aoc.js` like intended. However there's no `aoc.js.mem` file like there used to be. That's because the deps are called `aoc-66434e595ec0b4e8` now, so the compiler spits out the binaries with that name. However rustc only copies out the `aoc-66434e595ec0b4e8.js` as `aoc.js`, but not the mem file. But even if it copied out the mem file, it wouldn't be able to rename it, because the `aoc.js` looks specifically for the original name.\r\n\r\nPing: @brson ", "closed_by": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/38454/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/38454/timeline", "performed_via_github_app": null, "state_reason": "completed"}