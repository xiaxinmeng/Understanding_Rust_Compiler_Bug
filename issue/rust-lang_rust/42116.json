{"url": "https://api.github.com/repos/rust-lang/rust/issues/42116", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/42116/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/42116/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/42116/events", "html_url": "https://github.com/rust-lang/rust/issues/42116", "id": 230150385, "node_id": "MDU6SXNzdWUyMzAxNTAzODU=", "number": 42116, "title": "rustbuild: --build doesn't actually work when you don't already have the stage0 compiler", "user": {"login": "segevfiner", "id": 24731903, "node_id": "MDQ6VXNlcjI0NzMxOTAz", "avatar_url": "https://avatars.githubusercontent.com/u/24731903?v=4", "gravatar_id": "", "url": "https://api.github.com/users/segevfiner", "html_url": "https://github.com/segevfiner", "followers_url": "https://api.github.com/users/segevfiner/followers", "following_url": "https://api.github.com/users/segevfiner/following{/other_user}", "gists_url": "https://api.github.com/users/segevfiner/gists{/gist_id}", "starred_url": "https://api.github.com/users/segevfiner/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/segevfiner/subscriptions", "organizations_url": "https://api.github.com/users/segevfiner/orgs", "repos_url": "https://api.github.com/users/segevfiner/repos", "events_url": "https://api.github.com/users/segevfiner/events{/privacy}", "received_events_url": "https://api.github.com/users/segevfiner/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 325438536, "node_id": "MDU6TGFiZWwzMjU0Mzg1MzY=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-bootstrap", "name": "T-bootstrap", "color": "bfd4f2", "default": false, "description": "Relevant to the bootstrap subteam: Rust's build system (x.py and src/bootstrap)"}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2017-05-20T12:22:11Z", "updated_at": "2017-07-25T10:39:07Z", "closed_at": "2017-07-25T10:39:07Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I tried to build a different ABI/triplet than the one rustbuild automatically guesses by using the `--build` command line option. As suggested in [README.md#specifying-an-abi](https://github.com/rust-lang/rust/blob/master/README.md#specifying-an-abi), But it didn't work and failed with:\r\n\r\n```sh\r\nSegev@Segev-PC MINGW64 ~/rust\r\n$ ./x.py build --build x86_64-pc-windows-msvc src/libtest\r\n    Finished dev [unoptimized] target(s) in 0.7 secs\r\n\r\n\r\nfailed to execute command: \"C:\\\\Users\\\\Segev\\\\prj\\\\rust\\\\msys64\\\\home\\\\Segev\\\\rust\\\\build\\\\x86_64-pc-windows-msvc\\\\stage0/bin\\\\rustc.exe\" \"--version\" \"--verbose\"\r\nerror: The system cannot find the file specified. (os error 2)\r\n\r\n\r\nBuild completed unsuccessfully in 0:00:00\r\n```\r\n\r\nSetting \"build\" in cargo.toml works correctly.\r\n\r\nThe bootstrap.py script is responsible for downloading the stage0 compiler and building bootstrap (rustbuild), but it only checks which stage0 to download and use in config.toml/config.mk. It doesn't look at the command line at all for deciding this, which I think is the cause for this. See: [bootstrap.py:410-545](https://github.com/rust-lang/rust/blob/0bd9e1f5e6e9832691d033f1cc32409f5e2a9145/src/bootstrap/bootstrap.py#L410-L545).", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/42116/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/42116/timeline", "performed_via_github_app": null, "state_reason": "completed"}