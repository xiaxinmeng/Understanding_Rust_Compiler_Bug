{"url": "https://api.github.com/repos/rust-lang/rust/issues/50925", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/50925/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/50925/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/50925/events", "html_url": "https://github.com/rust-lang/rust/issues/50925", "id": 324743050, "node_id": "MDU6SXNzdWUzMjQ3NDMwNTA=", "number": 50925, "title": "1.26.0 cannot optimize length of vector collected from a slice of known size", "user": {"login": "tspiteri", "id": 18604588, "node_id": "MDQ6VXNlcjE4NjA0NTg4", "avatar_url": "https://avatars.githubusercontent.com/u/18604588?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tspiteri", "html_url": "https://github.com/tspiteri", "followers_url": "https://api.github.com/users/tspiteri/followers", "following_url": "https://api.github.com/users/tspiteri/following{/other_user}", "gists_url": "https://api.github.com/users/tspiteri/gists{/gist_id}", "starred_url": "https://api.github.com/users/tspiteri/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tspiteri/subscriptions", "organizations_url": "https://api.github.com/users/tspiteri/orgs", "repos_url": "https://api.github.com/users/tspiteri/repos", "events_url": "https://api.github.com/users/tspiteri/events{/privacy}", "received_events_url": "https://api.github.com/users/tspiteri/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 234956, "node_id": "MDU6TGFiZWwyMzQ5NTY=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-codegen", "name": "A-codegen", "color": "f7e101", "default": false, "description": "Area: Code generation"}, {"id": 211668062, "node_id": "MDU6TGFiZWwyMTE2NjgwNjI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-libs-api", "name": "T-libs-api", "color": "bfd4f2", "default": false, "description": "Relevant to the library API team, which will review and decide on the PR/issue."}, {"id": 262252840, "node_id": "MDU6TGFiZWwyNjIyNTI4NDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/regression-from-stable-to-stable", "name": "regression-from-stable-to-stable", "color": "e4008a", "default": false, "description": "Performance or correctness regression from one stable version to another."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2018-05-20T21:11:48Z", "updated_at": "2018-05-26T12:03:44Z", "closed_at": "2018-05-26T12:03:44Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "The code:\r\n```rust\r\npub fn foo() {\r\n    let a: Vec<_> = [1, 2, 3].iter().collect();\r\n    assert!(a.len() == 3);\r\n}\r\n```\r\n\r\nWith [rustc 1.25.0](https://godbolt.org/g/ucJD2X):\r\n```asm\r\nexample::foo:\r\n        push    rbp\r\n        mov     rbp, rsp\r\n        pop     rbp\r\n        ret\r\n```\r\n\r\nWith [rustc 1.26.0](https://godbolt.org/g/XgDEaB):\r\n```asm\r\n;...\r\nexample::foo:\r\n        push    rbp\r\n        mov     rbp, rsp\r\n        push    rbx\r\n        sub     rsp, 88\r\n        mov     qword ptr [rbp - 56], 8\r\n        xorps   xmm0, xmm0\r\n        movups  xmmword ptr [rbp - 48], xmm0\r\n        lea     rdx, [rbp - 32]\r\n        mov     edi, 24\r\n        mov     esi, 8\r\n        call    __rust_alloc@PLT\r\n        test    rax, rax\r\n        je      .LBB6_6\r\n        mov     qword ptr [rbp - 56], rax\r\n        mov     qword ptr [rbp - 48], 3\r\n        jmp     .LBB6_2\r\n.LBB6_6:\r\n        movups  xmm0, xmmword ptr [rbp - 24]\r\n        movaps  xmmword ptr [rbp - 96], xmm0\r\n        mov     qword ptr [rbp - 32], 0\r\n        movaps  xmm0, xmmword ptr [rbp - 96]\r\n        movups  xmmword ptr [rbp - 24], xmm0\r\n        lea     rdi, [rbp - 80]\r\n        lea     rsi, [rbp - 32]\r\n        call    <core::heap::CollectionAllocErr as core::convert::From<core::heap::AllocErr>>::from@PLT\r\n        mov     rax, qword ptr [rbp - 80]\r\n        cmp     rax, 3\r\n        jne     .LBB6_9\r\n        mov     eax, 8\r\n.LBB6_2:\r\n        xor     ecx, ecx\r\n        test    cl, cl\r\n        jne     .LBB6_4\r\n        lea     rcx, [rip + .Lbyte_str.c]\r\n        mov     qword ptr [rax], rcx\r\n        lea     rcx, [rip + .Lbyte_str.c+4]\r\n        mov     qword ptr [rax + 8], rcx\r\n        lea     rcx, [rip + .Lbyte_str.c+8]\r\n        mov     qword ptr [rax + 16], rcx\r\n        mov     ecx, 3\r\n.LBB6_4:\r\n        mov     qword ptr [rbp - 40], rcx\r\n        movups  xmm0, xmmword ptr [rbp - 56]\r\n        movaps  xmmword ptr [rbp - 32], xmm0\r\n        mov     qword ptr [rbp - 16], rcx\r\n        cmp     qword ptr [rbp - 16], 3\r\n        jne     .LBB6_5\r\n        mov     rsi, qword ptr [rbp - 24]\r\n        test    rsi, rsi\r\n        je      .LBB6_15\r\n        shl     rsi, 3\r\n        mov     rdi, qword ptr [rbp - 32]\r\n        mov     edx, 8\r\n        call    __rust_dealloc@PLT\r\n.LBB6_15:\r\n        add     rsp, 88\r\n        pop     rbx\r\n        pop     rbp\r\n        ret\r\n.LBB6_5:\r\n        call    std::panicking::begin_panic\r\n        jmp     .LBB6_11\r\n.LBB6_9:\r\n        cmp     rax, 2\r\n        jne     .LBB6_12\r\n        lea     rdi, [rip + .Lbyte_str.6]\r\n        call    core::panicking::panic@PLT\r\n.LBB6_11:\r\n        ud2\r\n.LBB6_12:\r\n        mov     rcx, qword ptr [rbp - 72]\r\n        mov     rdx, qword ptr [rbp - 64]\r\n        mov     qword ptr [rbp - 32], rax\r\n        mov     qword ptr [rbp - 24], rcx\r\n        mov     qword ptr [rbp - 16], rdx\r\n        lea     rdi, [rbp - 32]\r\n        call    <alloc::heap::Heap as core::heap::Alloc>::oom\r\n        ud2\r\n        mov     rbx, rax\r\n        lea     rdi, [rbp - 32]\r\n        jmp     .LBB6_18\r\n        mov     rbx, rax\r\n        lea     rdi, [rbp - 56]\r\n.LBB6_18:\r\n        call    core::ptr::drop_in_place\r\n        mov     rdi, rbx\r\n        call    _Unwind_Resume@PLT\r\n        ud2\r\n;...\r\n```", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/50925/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/50925/timeline", "performed_via_github_app": null, "state_reason": "completed"}