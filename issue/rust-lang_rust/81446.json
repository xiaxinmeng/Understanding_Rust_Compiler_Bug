{"url": "https://api.github.com/repos/rust-lang/rust/issues/81446", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/81446/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/81446/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/81446/events", "html_url": "https://github.com/rust-lang/rust/issues/81446", "id": 795337489, "node_id": "MDU6SXNzdWU3OTUzMzc0ODk=", "number": 81446, "title": "Unhelpful diagnostic: 'expected `X<'_>`, found `X<'_>`'", "user": {"login": "cole-miller", "id": 53574922, "node_id": "MDQ6VXNlcjUzNTc0OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/53574922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cole-miller", "html_url": "https://github.com/cole-miller", "followers_url": "https://api.github.com/users/cole-miller/followers", "following_url": "https://api.github.com/users/cole-miller/following{/other_user}", "gists_url": "https://api.github.com/users/cole-miller/gists{/gist_id}", "starred_url": "https://api.github.com/users/cole-miller/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cole-miller/subscriptions", "organizations_url": "https://api.github.com/users/cole-miller/orgs", "repos_url": "https://api.github.com/users/cole-miller/repos", "events_url": "https://api.github.com/users/cole-miller/events{/privacy}", "received_events_url": "https://api.github.com/users/cole-miller/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-01-27T18:21:35Z", "updated_at": "2021-01-29T21:27:41Z", "closed_at": "2021-01-29T21:27:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "Compiling this code on stable/beta/nightly ([playground](https://play.rust-lang.org/?version=nightly&mode=debug&edition=2018&gist=f948f226c1434f2323433f44e0978197)):\r\n\r\n```rust\r\nstruct X<'x> {\r\n    x: &'x str,\r\n}\r\n\r\ntrait B {\r\n    fn new(x: X) -> Self;\r\n}\r\n\r\nstruct S<'x> {\r\n    x: X<'x>,\r\n}\r\n\r\nimpl<'x> B for S<'x> {\r\n    fn new(x: X) -> S<'x> {\r\n        S { x }\r\n    }\r\n}\r\n\r\n```\r\n\r\ncorrectly results in an error, but part of the diagnostic is less than helpful:\r\n\r\n```text\r\n   = note: expected `X<'_>`\r\n              found `X<'_>`\r\n```\r\n\r\n<details>\r\n<summary>click for full error text</summary>\r\n\r\n```text\r\nerror[E0495]: cannot infer an appropriate lifetime for lifetime parameter `'x` due to conflicting requirements\r\n  --> src/lib.rs:15:9\r\n   |\r\n15 |         S { x }\r\n   |         ^\r\n   |\r\nnote: first, the lifetime cannot outlive the anonymous lifetime #1 defined on the method body at 14:5...\r\n  --> src/lib.rs:14:5\r\n   |\r\n14 |     fn new(x: X) -> S<'x> {\r\n   |     ^^^^^^^^^^^^^^^^^^^^^\r\nnote: ...so that the expression is assignable\r\n  --> src/lib.rs:15:13\r\n   |\r\n15 |         S { x }\r\n   |             ^\r\n   = note: expected `X<'_>`\r\n              found `X<'_>`\r\nnote: but, the lifetime must be valid for the lifetime `'x` as defined on the impl at 13:6...\r\n  --> src/lib.rs:13:6\r\n   |\r\n13 | impl<'x> B for S<'x> {\r\n   |      ^^\r\nnote: ...so that the expression is assignable\r\n  --> src/lib.rs:15:9\r\n   |\r\n15 |         S { x }\r\n   |         ^^^^^^^\r\n   = note: expected `S<'x>`\r\n              found `S<'_>`\r\n```\r\n</details>\r\n\r\nIt seems like either this `note` should have some detail indicating what the difference between the expected and found conditions is, or it should be left out entirely, because currently it's not providing any information at all.\r\n\r\nReported on URLO [here](https://users.rust-lang.org/t/trait-impl-lifetime-nightmare/54735).\r\n\r\n(Sorry if this is a duplicate, I don't know how to search effectively for previous reports of the same thing.)", "closed_by": {"login": "jyn514", "id": 23638587, "node_id": "MDQ6VXNlcjIzNjM4NTg3", "avatar_url": "https://avatars.githubusercontent.com/u/23638587?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jyn514", "html_url": "https://github.com/jyn514", "followers_url": "https://api.github.com/users/jyn514/followers", "following_url": "https://api.github.com/users/jyn514/following{/other_user}", "gists_url": "https://api.github.com/users/jyn514/gists{/gist_id}", "starred_url": "https://api.github.com/users/jyn514/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jyn514/subscriptions", "organizations_url": "https://api.github.com/users/jyn514/orgs", "repos_url": "https://api.github.com/users/jyn514/repos", "events_url": "https://api.github.com/users/jyn514/events{/privacy}", "received_events_url": "https://api.github.com/users/jyn514/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/81446/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/81446/timeline", "performed_via_github_app": null, "state_reason": "completed"}