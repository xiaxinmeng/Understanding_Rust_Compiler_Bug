{"url": "https://api.github.com/repos/rust-lang/rust/issues/46070", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/46070/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/46070/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/46070/events", "html_url": "https://github.com/rust-lang/rust/issues/46070", "id": 275048390, "node_id": "MDU6SXNzdWUyNzUwNDgzOTA=", "number": 46070, "title": "Generic function produces multiple identical methods in ASM.", "user": {"login": "rickvanprim", "id": 13792812, "node_id": "MDQ6VXNlcjEzNzkyODEy", "avatar_url": "https://avatars.githubusercontent.com/u/13792812?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rickvanprim", "html_url": "https://github.com/rickvanprim", "followers_url": "https://api.github.com/users/rickvanprim/followers", "following_url": "https://api.github.com/users/rickvanprim/following{/other_user}", "gists_url": "https://api.github.com/users/rickvanprim/gists{/gist_id}", "starred_url": "https://api.github.com/users/rickvanprim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rickvanprim/subscriptions", "organizations_url": "https://api.github.com/users/rickvanprim/orgs", "repos_url": "https://api.github.com/users/rickvanprim/repos", "events_url": "https://api.github.com/users/rickvanprim/events{/privacy}", "received_events_url": "https://api.github.com/users/rickvanprim/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 234902, "node_id": "MDU6TGFiZWwyMzQ5MDI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-enhancement", "name": "C-enhancement", "color": "f5f1fd", "default": false, "description": "Category: An issue proposing an enhancement or a PR with one."}, {"id": 234956, "node_id": "MDU6TGFiZWwyMzQ5NTY=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-codegen", "name": "A-codegen", "color": "f7e101", "default": false, "description": "Area: Code generation"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2017-11-18T03:07:38Z", "updated_at": "2019-05-21T02:08:40Z", "closed_at": "2019-05-21T02:08:40Z", "author_association": "NONE", "active_lock_reason": null, "body": "Compiled on Stable with Release target.\r\n\r\n```\r\nuse std::any::Any;\r\n\r\n#[inline(never)]\r\nfn cast<T1: ?Sized, T2>(t: Box<T1>) -> Box<T2>\r\n{\r\n    unsafe { Box::from_raw(Box::into_raw(t) as *mut T2) }\r\n}\r\n\r\nfn main()\r\n{\r\n    let t: Box<Any> = Box::new(5);\r\n    let s: Box<u32> = cast(t);\r\n    println!(\"{}\", *s);\r\n\r\n    let t: Box<Any> = Box::new(10.0f32);\r\n    let s: Box<f32> = cast(t);\r\n    println!(\"{}\", *s);\r\n}\r\n```\r\n\r\nIn the ASM, I see the following produced.\r\n\r\n```\r\nplayground::cast:\r\n    mov    rax, rdi\r\n    ret\r\n\r\nplayground::cast:\r\n    mov    rax, rdi\r\n    ret\r\n```\r\n\r\nI observed this earlier today on Rust Playground.  I don't know if `#[inline(never)]` is causing them not to be merged, or if it's expected that they don't get merged despite being identical.  It seems to me like they should be merged, as they are identical aside from the type parameters, which is only a difference at compile time, not runtime.", "closed_by": {"login": "rickvanprim", "id": 13792812, "node_id": "MDQ6VXNlcjEzNzkyODEy", "avatar_url": "https://avatars.githubusercontent.com/u/13792812?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rickvanprim", "html_url": "https://github.com/rickvanprim", "followers_url": "https://api.github.com/users/rickvanprim/followers", "following_url": "https://api.github.com/users/rickvanprim/following{/other_user}", "gists_url": "https://api.github.com/users/rickvanprim/gists{/gist_id}", "starred_url": "https://api.github.com/users/rickvanprim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rickvanprim/subscriptions", "organizations_url": "https://api.github.com/users/rickvanprim/orgs", "repos_url": "https://api.github.com/users/rickvanprim/repos", "events_url": "https://api.github.com/users/rickvanprim/events{/privacy}", "received_events_url": "https://api.github.com/users/rickvanprim/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/46070/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/46070/timeline", "performed_via_github_app": null, "state_reason": "completed"}