{"url": "https://api.github.com/repos/rust-lang/rust/issues/93201", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/93201/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/93201/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/93201/events", "html_url": "https://github.com/rust-lang/rust/issues/93201", "id": 1111580089, "node_id": "I_kwDOAAsO6M5CQV25", "number": 93201, "title": "`--emit=dep-info` + `-Zunpretty=expanded` emits output", "user": {"login": "ojeda", "id": 1054456, "node_id": "MDQ6VXNlcjEwNTQ0NTY=", "avatar_url": "https://avatars.githubusercontent.com/u/1054456?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ojeda", "html_url": "https://github.com/ojeda", "followers_url": "https://api.github.com/users/ojeda/followers", "following_url": "https://api.github.com/users/ojeda/following{/other_user}", "gists_url": "https://api.github.com/users/ojeda/gists{/gist_id}", "starred_url": "https://api.github.com/users/ojeda/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ojeda/subscriptions", "organizations_url": "https://api.github.com/users/ojeda/orgs", "repos_url": "https://api.github.com/users/ojeda/repos", "events_url": "https://api.github.com/users/ojeda/events{/privacy}", "received_events_url": "https://api.github.com/users/ojeda/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2022-01-22T14:24:17Z", "updated_at": "2022-01-22T21:33:34Z", "closed_at": null, "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "In 1.58, running:\r\n\r\n```sh\r\necho 'fn main() {}' | rustc --emit=dep-info,obj,metadata -\r\n```\r\n\r\nwill generate `.d`, `.o` and `.rmeta` files, as expected. However, running with `-Zunpretty=expanded`:\r\n\r\n```sh\r\necho 'fn main() {}' | rustc --emit=dep-info,obj,metadata -Zunpretty=expanded -\r\n```\r\n\r\nwill generate the `.d` only. I would have expected that `rustc` does not generate any file, or that it generates all of them, or that it complains if `--emit` and `-Zunpretty` are supposed to be incompatible with each other. Should users avoid mixing both at the moment?\r\n\r\n(I assume that, eventually, `--emit=dep-info,expanded` would give the dependency information about the expanded output file like it does for the others; which is fine)\r\n\r\nIt also happens with e.g. `-Zunpretty=hir`, but not with `-Zunpretty=normal` or `-Zunpretty=ast-tree`; thus it looks like a consequence of which passes are executed in the compiler.\r\n\r\nPossibly related: https://github.com/rust-lang/rust/issues/60857.", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/93201/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/93201/timeline", "performed_via_github_app": null, "state_reason": null}