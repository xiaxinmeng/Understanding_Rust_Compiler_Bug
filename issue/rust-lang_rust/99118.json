{"url": "https://api.github.com/repos/rust-lang/rust/issues/99118", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/99118/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/99118/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/99118/events", "html_url": "https://github.com/rust-lang/rust/issues/99118", "id": 1299953140, "node_id": "I_kwDOAAsO6M5Ne7X0", "number": 99118, "title": "rustdoc JSON: Support for `&dyn for<'a> Trait<'a>`", "user": {"login": "Enselic", "id": 115040, "node_id": "MDQ6VXNlcjExNTA0MA==", "avatar_url": "https://avatars.githubusercontent.com/u/115040?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Enselic", "html_url": "https://github.com/Enselic", "followers_url": "https://api.github.com/users/Enselic/followers", "following_url": "https://api.github.com/users/Enselic/following{/other_user}", "gists_url": "https://api.github.com/users/Enselic/gists{/gist_id}", "starred_url": "https://api.github.com/users/Enselic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Enselic/subscriptions", "organizations_url": "https://api.github.com/users/Enselic/orgs", "repos_url": "https://api.github.com/users/Enselic/repos", "events_url": "https://api.github.com/users/Enselic/events{/privacy}", "received_events_url": "https://api.github.com/users/Enselic/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 203738, "node_id": "MDU6TGFiZWwyMDM3Mzg=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-rustdoc", "name": "T-rustdoc", "color": "bfd4f2", "default": false, "description": "Relevant to the rustdoc team, which will review and decide on the PR/issue."}, {"id": 234902, "node_id": "MDU6TGFiZWwyMzQ5MDI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-enhancement", "name": "C-enhancement", "color": "f5f1fd", "default": false, "description": "Category: An issue proposing an enhancement or a PR with one."}, {"id": 1472563007, "node_id": "MDU6TGFiZWwxNDcyNTYzMDA3", "url": "https://api.github.com/repos/rust-lang/rust/labels/requires-nightly", "name": "requires-nightly", "color": "76dcde", "default": false, "description": "This issue requires a nightly compiler in some way."}, {"id": 2682491374, "node_id": "MDU6TGFiZWwyNjgyNDkxMzc0", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-rustdoc-json", "name": "A-rustdoc-json", "color": "f7e101", "default": false, "description": "Area: Rustdoc JSON backend"}], "state": "closed", "locked": false, "assignee": {"login": "aDotInTheVoid", "id": 28781354, "node_id": "MDQ6VXNlcjI4NzgxMzU0", "avatar_url": "https://avatars.githubusercontent.com/u/28781354?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aDotInTheVoid", "html_url": "https://github.com/aDotInTheVoid", "followers_url": "https://api.github.com/users/aDotInTheVoid/followers", "following_url": "https://api.github.com/users/aDotInTheVoid/following{/other_user}", "gists_url": "https://api.github.com/users/aDotInTheVoid/gists{/gist_id}", "starred_url": "https://api.github.com/users/aDotInTheVoid/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aDotInTheVoid/subscriptions", "organizations_url": "https://api.github.com/users/aDotInTheVoid/orgs", "repos_url": "https://api.github.com/users/aDotInTheVoid/repos", "events_url": "https://api.github.com/users/aDotInTheVoid/events{/privacy}", "received_events_url": "https://api.github.com/users/aDotInTheVoid/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "aDotInTheVoid", "id": 28781354, "node_id": "MDQ6VXNlcjI4NzgxMzU0", "avatar_url": "https://avatars.githubusercontent.com/u/28781354?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aDotInTheVoid", "html_url": "https://github.com/aDotInTheVoid", "followers_url": "https://api.github.com/users/aDotInTheVoid/followers", "following_url": "https://api.github.com/users/aDotInTheVoid/following{/other_user}", "gists_url": "https://api.github.com/users/aDotInTheVoid/gists{/gist_id}", "starred_url": "https://api.github.com/users/aDotInTheVoid/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aDotInTheVoid/subscriptions", "organizations_url": "https://api.github.com/users/aDotInTheVoid/orgs", "repos_url": "https://api.github.com/users/aDotInTheVoid/repos", "events_url": "https://api.github.com/users/aDotInTheVoid/events{/privacy}", "received_events_url": "https://api.github.com/users/aDotInTheVoid/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2022-07-10T15:49:42Z", "updated_at": "2022-08-09T16:39:44Z", "closed_at": "2022-08-09T16:39:44Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "If we generate rustdoc JSON for this **lib.rs**:\n\n```rust\n#![feature(no_core)]\n#![no_core]\n#![no_std]\npub trait Trait<'a> {}\npub fn f(_: &dyn for<'a> Trait<'a>) {}\n```\n\nwith the command:\n\n```bash\nrustdoc +nightly-2022-07-10 -Z unstable-options --output-format json lib.rs\n```\n\nwe will get this rustdoc JSON in **doc/lib.json** for the function input parameters:\n\n```json\n\"inputs\": [\n    [\n        \"_\",\n        {\n            \"kind\": \"borrowed_ref\",\n            \"inner\": {\n                \"lifetime\": null,\n                \"mutable\": false,\n                \"type\": {\n                    \"kind\": \"resolved_path\",\n                    \"inner\": {\n                        \"name\": \"Trait\",\n                        \"id\": \"0:1:1565\",\n                        \"args\": {\n                            \"angle_bracketed\": {\n                                \"args\": [\n                                    {\n                                        \"lifetime\": \"'a\"\n                                    }\n                                ],\n                                \"bindings\": []\n                            }\n                        },\n                        \"param_names\": []\n                    }\n                }\n            }\n        }\n    ]\n],\n```\n\nas can be seen, the `for<'a>` part is absent. Info about that the `dyn` keywoard is used is not present either, unless one looks up `0:1:1565`, in which case I guess it can be deduced that `dyn` is used. But it would be nice if that was made clearer.\n\nI think the best way to solve this would be to introduce a `DynTrait` object of some kind to rustdoc JSON, as was done for rustdoc HTML in https://github.com/rust-lang/rust/commit/4ea27484c9582389cded2301d1f0dd4f421c8c35.\n\n@rustbot labels +A-rustdoc-json +T-rustdoc +C-enhancement +requires-nightly\n\nFor reference, the full rustdoc JSON output can be seen below.\n<details>\n  <summary>Click to expand!</summary>\n  \n```\n% cat doc/lib.json | python3 -m json.tool \n{\n    \"root\": \"0:0:782\",\n    \"crate_version\": null,\n    \"includes_private\": false,\n    \"index\": {\n        \"0:3:617\": {\n            \"id\": \"0:3:617\",\n            \"crate_id\": 0,\n            \"name\": \"f\",\n            \"span\": {\n                \"filename\": \"lib.rs\",\n                \"begin\": [\n                    5,\n                    0\n                ],\n                \"end\": [\n                    5,\n                    38\n                ]\n            },\n            \"visibility\": \"public\",\n            \"docs\": null,\n            \"links\": {},\n            \"attrs\": [],\n            \"deprecation\": null,\n            \"kind\": \"function\",\n            \"inner\": {\n                \"decl\": {\n                    \"inputs\": [\n                        [\n                            \"_\",\n                            {\n                                \"kind\": \"borrowed_ref\",\n                                \"inner\": {\n                                    \"lifetime\": null,\n                                    \"mutable\": false,\n                                    \"type\": {\n                                        \"kind\": \"resolved_path\",\n                                        \"inner\": {\n                                            \"name\": \"Trait\",\n                                            \"id\": \"0:1:1565\",\n                                            \"args\": {\n                                                \"angle_bracketed\": {\n                                                    \"args\": [\n                                                        {\n                                                            \"lifetime\": \"'a\"\n                                                        }\n                                                    ],\n                                                    \"bindings\": []\n                                                }\n                                            },\n                                            \"param_names\": []\n                                        }\n                                    }\n                                }\n                            }\n                        ]\n                    ],\n                    \"output\": null,\n                    \"c_variadic\": false\n                },\n                \"generics\": {\n                    \"params\": [],\n                    \"where_predicates\": []\n                },\n                \"header\": {\n                    \"const\": false,\n                    \"unsafe\": false,\n                    \"async\": false,\n                    \"abi\": \"Rust\"\n                }\n            }\n        },\n        \"0:0:782\": {\n            \"id\": \"0:0:782\",\n            \"crate_id\": 0,\n            \"name\": \"lib\",\n            \"span\": {\n                \"filename\": \"lib.rs\",\n                \"begin\": [\n                    1,\n                    0\n                ],\n                \"end\": [\n                    5,\n                    38\n                ]\n            },\n            \"visibility\": \"public\",\n            \"docs\": null,\n            \"links\": {},\n            \"attrs\": [\n                \"#![feature(no_core)]\",\n                \"#![no_core]\",\n                \"#![no_std]\"\n            ],\n            \"deprecation\": null,\n            \"kind\": \"module\",\n            \"inner\": {\n                \"is_crate\": true,\n                \"items\": [\n                    \"0:1:1565\",\n                    \"0:3:617\"\n                ]\n            }\n        },\n        \"0:1:1565\": {\n            \"id\": \"0:1:1565\",\n            \"crate_id\": 0,\n            \"name\": \"Trait\",\n            \"span\": {\n                \"filename\": \"lib.rs\",\n                \"begin\": [\n                    4,\n                    0\n                ],\n                \"end\": [\n                    4,\n                    22\n                ]\n            },\n            \"visibility\": \"public\",\n            \"docs\": null,\n            \"links\": {},\n            \"attrs\": [],\n            \"deprecation\": null,\n            \"kind\": \"trait\",\n            \"inner\": {\n                \"is_auto\": false,\n                \"is_unsafe\": false,\n                \"items\": [],\n                \"generics\": {\n                    \"params\": [\n                        {\n                            \"name\": \"'a\",\n                            \"kind\": {\n                                \"lifetime\": {\n                                    \"outlives\": []\n                                }\n                            }\n                        }\n                    ],\n                    \"where_predicates\": []\n                },\n                \"bounds\": [],\n                \"implementations\": []\n            }\n        }\n    },\n    \"paths\": {\n        \"0:3:617\": {\n            \"crate_id\": 0,\n            \"path\": [\n                \"lib\",\n                \"f\"\n            ],\n            \"kind\": \"function\"\n        },\n        \"0:1:1565\": {\n            \"crate_id\": 0,\n            \"path\": [\n                \"lib\",\n                \"Trait\"\n            ],\n            \"kind\": \"trait\"\n        },\n        \"0:0:782\": {\n            \"crate_id\": 0,\n            \"path\": [\n                \"lib\"\n            ],\n            \"kind\": \"module\"\n        }\n    },\n    \"external_crates\": {},\n    \"format_version\": 15\n}\n```\n</details>\n\n\n\n\n<!-- TRIAGEBOT_START -->\n\n<!-- TRIAGEBOT_ASSIGN_START -->\n\n<!-- TRIAGEBOT_ASSIGN_DATA_START$${\"user\":\"aDotInTheVoid\"}$$TRIAGEBOT_ASSIGN_DATA_END -->\n\n<!-- TRIAGEBOT_ASSIGN_END -->\n<!-- TRIAGEBOT_END -->", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/99118/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/99118/timeline", "performed_via_github_app": null, "state_reason": "completed"}