{"url": "https://api.github.com/repos/rust-lang/rust/issues/3866", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/3866/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/3866/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/3866/events", "html_url": "https://github.com/rust-lang/rust/issues/3866", "id": 7881474, "node_id": "MDU6SXNzdWU3ODgxNDc0", "number": 3866, "title": "struct matching problem with rparse", "user": {"login": "dckc", "id": 150986, "node_id": "MDQ6VXNlcjE1MDk4Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/150986?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dckc", "html_url": "https://github.com/dckc", "followers_url": "https://api.github.com/users/dckc/followers", "following_url": "https://api.github.com/users/dckc/following{/other_user}", "gists_url": "https://api.github.com/users/dckc/gists{/gist_id}", "starred_url": "https://api.github.com/users/dckc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dckc/subscriptions", "organizations_url": "https://api.github.com/users/dckc/orgs", "repos_url": "https://api.github.com/users/dckc/repos", "events_url": "https://api.github.com/users/dckc/events{/privacy}", "received_events_url": "https://api.github.com/users/dckc/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 13242248, "node_id": "MDU6TGFiZWwxMzI0MjI0OA==", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-metadata", "name": "A-metadata", "color": "f7e101", "default": false, "description": "Area: crate metadata"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2012-10-26T03:40:16Z", "updated_at": "2012-11-01T19:27:15Z", "closed_at": "2012-11-01T19:27:15Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I get:\n\n```\n$ rustc  structmatch.rs --test\nstructmatch.rs:24:7: 24:18 error: `ParseFailed` does not name a structure\nstructmatch.rs:24     Err(ParseFailed{file: f, line: y, col: x, mesg: txt}) => assert x == 6,\n                         ^~~~~~~~~~~\nerror: aborting due to previous error\n```\n\nwith this:\n\n```\nextern mod std; // else --test goes wonky\n\nextern mod rparse; // https://github.com/jesse99/rparse or: cargo install rparse\n\nuse rparse::{Parser, Combinators, ParseFailed, match0 };\n\npub fn space() -> Parser<@~str> { match0(|ch| ws_char.contains_char(ch)) }\nconst ws_char: &str = &\" \\t\\r\\n\\x0A\";\n\n#[cfg(test)]\nmod test_preliminaries {\n\n    // This shows ParseFailed is correctly imported.\n    fn mk_failed() -> ParseFailed {\nParseFailed{file: @~\"\", line: 1, col: 2, mesg: @~\"hello\"}\n    }\n\n    #[test]\n    fn match_problemr() {\n        let actual = space()\n            .parse(@~\"f\", @\"$( x \\u0000 is not allowed $)\");\n        match actual {\nOk(_) => fail,\nErr(ParseFailed{file: f, line: y, col: x, mesg: txt}) => assert x == 6,\n          // The with the line below in place of the one above, this compiles.\n//Err(_) => ()\n        }\n    }\n}\n```\n\ncurrent revision of rparse is:\n\ncommit 1c6f5e8a15dd9d4972fcbf8692ebe79cc72d4b46\nAuthor: Jesse Jones\nDate:   Wed Oct 17 07:05:59 2012 -0700\n\nMeanwhile, this compiles fine...\n\n```\nextern mod std; // else --test goes wonky\n\nstruct ParseFailed {\n  file: @~str,\n  line: uint,\n  col: uint,\n  mesg: @~str\n}\n\ntype ParseResult = Result<int, ParseFailed>;\n\nfn match_problem() {\n    let actual: ParseResult = Ok(1);\n\n    match actual {\n      Ok(_) => fail,\n      Err(ParseFailed{file: f, line: y, col: x, mesg: txt}) => assert x == 6,\n    }\n}\n```\n", "closed_by": {"login": "catamorphism", "id": 427212, "node_id": "MDQ6VXNlcjQyNzIxMg==", "avatar_url": "https://avatars.githubusercontent.com/u/427212?v=4", "gravatar_id": "", "url": "https://api.github.com/users/catamorphism", "html_url": "https://github.com/catamorphism", "followers_url": "https://api.github.com/users/catamorphism/followers", "following_url": "https://api.github.com/users/catamorphism/following{/other_user}", "gists_url": "https://api.github.com/users/catamorphism/gists{/gist_id}", "starred_url": "https://api.github.com/users/catamorphism/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/catamorphism/subscriptions", "organizations_url": "https://api.github.com/users/catamorphism/orgs", "repos_url": "https://api.github.com/users/catamorphism/repos", "events_url": "https://api.github.com/users/catamorphism/events{/privacy}", "received_events_url": "https://api.github.com/users/catamorphism/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/3866/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/3866/timeline", "performed_via_github_app": null, "state_reason": "completed"}