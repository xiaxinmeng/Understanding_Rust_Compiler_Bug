{"url": "https://api.github.com/repos/rust-lang/rust/issues/59931", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/59931/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/59931/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/59931/events", "html_url": "https://github.com/rust-lang/rust/issues/59931", "id": 432803490, "node_id": "MDU6SXNzdWU0MzI4MDM0OTA=", "number": 59931, "title": "`VecDeque::with_capacity` contradicts `std::collections` module documentation", "user": {"login": "gluyas", "id": 18733113, "node_id": "MDQ6VXNlcjE4NzMzMTEz", "avatar_url": "https://avatars.githubusercontent.com/u/18733113?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gluyas", "html_url": "https://github.com/gluyas", "followers_url": "https://api.github.com/users/gluyas/followers", "following_url": "https://api.github.com/users/gluyas/following{/other_user}", "gists_url": "https://api.github.com/users/gluyas/gists{/gist_id}", "starred_url": "https://api.github.com/users/gluyas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gluyas/subscriptions", "organizations_url": "https://api.github.com/users/gluyas/orgs", "repos_url": "https://api.github.com/users/gluyas/repos", "events_url": "https://api.github.com/users/gluyas/events{/privacy}", "received_events_url": "https://api.github.com/users/gluyas/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 431251592, "node_id": "MDU6TGFiZWw0MzEyNTE1OTI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-docs", "name": "A-docs", "color": "f7e101", "default": false, "description": "Area: documentation for any part of the project, including the compiler, standard library, and tools"}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-04-13T03:44:35Z", "updated_at": "2019-04-18T01:19:39Z", "closed_at": "2019-04-18T01:19:39Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "From [`std::collections` module-level doc](https://doc.rust-lang.org/stable/std/collections/#capacity-management) (emphasis added):\r\n\r\n> Any `with_capacity` constructor will instruct the collection to allocate enough space for the specified number of elements. Ideally this will be for exactly that many elements, but some implementation details may prevent this. **`Vec` and `VecDeque` can be relied on to allocate exactly the requested amount**, though.\r\n\r\nHowever, the implementation actually requires that the capacity is a power of 2, taking advantage of bitmask modulo tricks. It also needs to keep a single empty slot in the buffer.\r\n\r\n[playground example](https://play.rust-lang.org/?version=stable&mode=debug&edition=2018&gist=684158320a4da8c5ceddd35ce4c21e8a)\r\n\r\nThere are some use cases that would want this feature: [rotate](https://github.com/rust-lang/rust/issues/56686) would be an O(1) operation when `len == cap`, which could be useful in sliding-window type applications. But it doesn't seem like something general deque usage would really care about. So probably shouldn't reimplement the whole data structure and just change the doc to not mention `VecDeque` here.", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/59931/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/59931/timeline", "performed_via_github_app": null, "state_reason": "completed"}