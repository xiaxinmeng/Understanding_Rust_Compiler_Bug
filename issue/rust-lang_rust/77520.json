{"url": "https://api.github.com/repos/rust-lang/rust/issues/77520", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/77520/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/77520/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/77520/events", "html_url": "https://github.com/rust-lang/rust/issues/77520", "id": 714260266, "node_id": "MDU6SXNzdWU3MTQyNjAyNjY=", "number": 77520, "title": "Docs enhancement: misleading try_clone docs", "user": {"login": "rbtcollins", "id": 499678, "node_id": "MDQ6VXNlcjQ5OTY3OA==", "avatar_url": "https://avatars.githubusercontent.com/u/499678?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rbtcollins", "html_url": "https://github.com/rbtcollins", "followers_url": "https://api.github.com/users/rbtcollins/followers", "following_url": "https://api.github.com/users/rbtcollins/following{/other_user}", "gists_url": "https://api.github.com/users/rbtcollins/gists{/gist_id}", "starred_url": "https://api.github.com/users/rbtcollins/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rbtcollins/subscriptions", "organizations_url": "https://api.github.com/users/rbtcollins/orgs", "repos_url": "https://api.github.com/users/rbtcollins/repos", "events_url": "https://api.github.com/users/rbtcollins/events{/privacy}", "received_events_url": "https://api.github.com/users/rbtcollins/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 211668062, "node_id": "MDU6TGFiZWwyMTE2NjgwNjI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-libs-api", "name": "T-libs-api", "color": "bfd4f2", "default": false, "description": "Relevant to the library API team, which will review and decide on the PR/issue."}, {"id": 431251592, "node_id": "MDU6TGFiZWw0MzEyNTE1OTI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-docs", "name": "A-docs", "color": "f7e101", "default": false, "description": "Area: documentation for any part of the project, including the compiler, standard library, and tools"}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}, {"id": 2238437210, "node_id": "MDU6TGFiZWwyMjM4NDM3MjEw", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-io", "name": "A-io", "color": "f7e101", "default": false, "description": "Area: std::io, std::fs, std::net and std::path"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-10-04T08:05:56Z", "updated_at": "2020-10-04T14:50:30Z", "closed_at": null, "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "try_clone says it \"Creates a new `File` instance that shares the same underlying file handle as the existing `File` instance.\"\r\n\r\nHowever, #45536 notes that it calls DuplicateHandle and fcntl F_DUPFD_CLOEXEC on Windows and other OSes respectively. Those calls create new handles, which point to the same operating system descriptor (file, socket etc).\r\n\r\nThe distinction is potentially important: file system behaviours that can cause IO latency may be hooked in on syscalls like close() - we've spent considerable time in rustup dealing with virus scanners and NFS for two examples. \r\n\r\nI think the documentation should at a minimum say 'new operating system handle cloned from the existing one', or some such. Ideally it would, like other calls do, just say what calls are used: this is clear and unambiguous, and would also solve the problem raised in bug 45536 about documentation about when it may fail by letting folk go and read the underlying syscall documentation.\r\n\r\n### Meta\r\n\r\nThis is present still in git. https://doc.rust-lang.org/src/std/fs.rs.html#548\r\n", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/77520/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/77520/timeline", "performed_via_github_app": null, "state_reason": null}