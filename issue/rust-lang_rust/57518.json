{"url": "https://api.github.com/repos/rust-lang/rust/issues/57518", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/57518/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/57518/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/57518/events", "html_url": "https://github.com/rust-lang/rust/issues/57518", "id": 398370553, "node_id": "MDU6SXNzdWUzOTgzNzA1NTM=", "number": 57518, "title": "rustc -vV segmentation fault", "user": {"login": "bbigras", "id": 24027, "node_id": "MDQ6VXNlcjI0MDI3", "avatar_url": "https://avatars.githubusercontent.com/u/24027?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bbigras", "html_url": "https://github.com/bbigras", "followers_url": "https://api.github.com/users/bbigras/followers", "following_url": "https://api.github.com/users/bbigras/following{/other_user}", "gists_url": "https://api.github.com/users/bbigras/gists{/gist_id}", "starred_url": "https://api.github.com/users/bbigras/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bbigras/subscriptions", "organizations_url": "https://api.github.com/users/bbigras/orgs", "repos_url": "https://api.github.com/users/bbigras/repos", "events_url": "https://api.github.com/users/bbigras/events{/privacy}", "received_events_url": "https://api.github.com/users/bbigras/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 100522, "node_id": "MDU6TGFiZWwxMDA1MjI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-crash", "name": "I-crash", "color": "e10c02", "default": false, "description": "Issue: The compiler crashes (SIGSEGV, SIGABRT, etc). Use I-ICE instead when the compiler panics."}, {"id": 147085028, "node_id": "MDU6TGFiZWwxNDcwODUwMjg=", "url": "https://api.github.com/repos/rust-lang/rust/labels/regression-from-stable-to-nightly", "name": "regression-from-stable-to-nightly", "color": "e4008a", "default": false, "description": "Performance or correctness regression from stable to nightly."}, {"id": 952737937, "node_id": "MDU6TGFiZWw5NTI3Mzc5Mzc=", "url": "https://api.github.com/repos/rust-lang/rust/labels/O-NixOS", "name": "O-NixOS", "color": "6e6ec0", "default": false, "description": "Operating system: NixOS, https://nixos.org/"}], "state": "closed", "locked": false, "assignee": {"login": "nagisa", "id": 679122, "node_id": "MDQ6VXNlcjY3OTEyMg==", "avatar_url": "https://avatars.githubusercontent.com/u/679122?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nagisa", "html_url": "https://github.com/nagisa", "followers_url": "https://api.github.com/users/nagisa/followers", "following_url": "https://api.github.com/users/nagisa/following{/other_user}", "gists_url": "https://api.github.com/users/nagisa/gists{/gist_id}", "starred_url": "https://api.github.com/users/nagisa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nagisa/subscriptions", "organizations_url": "https://api.github.com/users/nagisa/orgs", "repos_url": "https://api.github.com/users/nagisa/repos", "events_url": "https://api.github.com/users/nagisa/events{/privacy}", "received_events_url": "https://api.github.com/users/nagisa/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "nagisa", "id": 679122, "node_id": "MDQ6VXNlcjY3OTEyMg==", "avatar_url": "https://avatars.githubusercontent.com/u/679122?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nagisa", "html_url": "https://github.com/nagisa", "followers_url": "https://api.github.com/users/nagisa/followers", "following_url": "https://api.github.com/users/nagisa/following{/other_user}", "gists_url": "https://api.github.com/users/nagisa/gists{/gist_id}", "starred_url": "https://api.github.com/users/nagisa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nagisa/subscriptions", "organizations_url": "https://api.github.com/users/nagisa/orgs", "repos_url": "https://api.github.com/users/nagisa/repos", "events_url": "https://api.github.com/users/nagisa/events{/privacy}", "received_events_url": "https://api.github.com/users/nagisa/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 13, "created_at": "2019-01-11T16:53:15Z", "updated_at": "2019-01-22T18:16:18Z", "closed_at": "2019-01-22T18:16:18Z", "author_association": "NONE", "active_lock_reason": null, "body": "I don't know if it's related to #52772. In my case `rustc --version` doesn't segfault, only `rustc -vV` does.\r\n\r\nI'm running it on NixOS with nix-shell.\r\n\r\n```\r\n$ rustup show\r\nDefault host: x86_64-unknown-linux-gnu\r\n\r\nnightly-x86_64-unknown-linux-gnu (default)\r\n(error reading rustc version)\r\n\r\n$ rustc --version\r\nrustc 1.33.0-nightly (c2d381d39 2019-01-10)\r\n```\r\n\r\nshell.nix\r\n```nix\r\nlet\r\n  moz_overlay = import (builtins.fetchTarball https://github.com/mozilla/nixpkgs-mozilla/archive/master.tar.gz);\r\n  nixpkgs = import <nixpkgs> { overlays = [ moz_overlay ]; };\r\nin\r\n  with nixpkgs;\r\n  stdenv.mkDerivation {\r\n    name = \"moz_overlay_shell\";\r\n    buildInputs = [\r\n      (nixpkgs.rustChannelOf { date = \"2019-01-11\"; channel = \"nightly\"; }).rust\r\n      ];\r\n  }\r\n```\r\n\r\n\r\n```\r\n$ gdb -quiet --args rustc -vV\r\nReading symbols from rustc...done.\r\n(gdb) run\r\nStarting program: /nix/store/jknmv24nl8zz0cacn14y317kms1521ra-rust-1.33.0-nightly-2019-01-10-c2d381d39/bin/rustc -vV\r\nwarning: File \"/nix/store/95i38z61425xrci8h178blwff88p0a4h-gcc-7.3.0-lib/lib/libstdc++.so.6.0.24-gdb.py\" auto-loading has been declined by your `auto-load safe-path' set to \"$debugdir:$datadir/auto-load\".\r\nTo enable execution of this file add\r\n        add-auto-load-safe-path /nix/store/95i38z61425xrci8h178blwff88p0a4h-gcc-7.3.0-lib/lib/libstdc++.so.6.0.24-gdb.py\r\nline to your configuration file \"/home/bbigras2/.gdbinit\".\r\nTo completely disable this security protection add\r\n        set auto-load safe-path /\r\nline to your configuration file \"/home/bbigras2/.gdbinit\".\r\nFor more information about this security protection see the\r\n\"Auto-loading safe path\" section in the GDB manual.  E.g., run from the shell:\r\n        info \"(gdb)Auto-loading safe path\"\r\n[Thread debugging using libthread_db enabled]\r\nUsing host libthread_db library \"/nix/store/7gx4kiv5m0i7d7qkixq2cwzbr10lvxwc-glibc-2.27/lib/libthread_db.so.1\".\r\n[New Thread 0x7fffef5ff700 (LWP 11468)]\r\nrustc 1.33.0-nightly (c2d381d39 2019-01-10)\r\nbinary: rustc\r\ncommit-hash: c2d381d39d282c0586d50ea7d7a431ffd5ddb3fb\r\ncommit-date: 2019-01-10\r\nhost: x86_64-unknown-linux-gnu\r\nrelease: 1.33.0-nightly\r\n\r\nThread 2 \"rustc\" received signal SIGSEGV, Segmentation fault.\r\n[Switching to Thread 0x7fffef5ff700 (LWP 11468)]\r\n0x0000000000000000 in ?? ()\r\n(gdb) bt\r\n#0  0x0000000000000000 in ?? ()\r\n#1  0x00007ffff70f7079 in __pthread_once_slow () from /nix/store/7gx4kiv5m0i7d7qkixq2cwzbr10lvxwc-glibc-2.27/lib/libpthread.so.0\r\n#2  0x00007fffe9e43413 in llvm::cl::OptionCategory::registerCategory() ()\r\n   from /nix/store/jknmv24nl8zz0cacn14y317kms1521ra-rust-1.33.0-nightly-2019-01-10-c2d381d39/lib/rustlib/x86_64-unknown-linux-gnu/codegen-backends/../lib/libLLVM-8svn.so\r\n#3  0x00007fffe9e55553 in _GLOBAL__sub_I_CommandLine.cpp ()\r\n   from /nix/store/jknmv24nl8zz0cacn14y317kms1521ra-rust-1.33.0-nightly-2019-01-10-c2d381d39/lib/rustlib/x86_64-unknown-linux-gnu/codegen-backends/../lib/libLLVM-8svn.so\r\n#4  0x00007ffff7de702a in call_init.part () from /nix/store/7gx4kiv5m0i7d7qkixq2cwzbr10lvxwc-glibc-2.27/lib/ld-linux-x86-64.so.2\r\n#5  0x00007ffff7de713b in _dl_init () from /nix/store/7gx4kiv5m0i7d7qkixq2cwzbr10lvxwc-glibc-2.27/lib/ld-linux-x86-64.so.2\r\n#6  0x00007ffff7deb0f4 in dl_open_worker () from /nix/store/7gx4kiv5m0i7d7qkixq2cwzbr10lvxwc-glibc-2.27/lib/ld-linux-x86-64.so.2\r\n#7  0x00007ffff6a529cc in _dl_catch_exception () from /nix/store/7gx4kiv5m0i7d7qkixq2cwzbr10lvxwc-glibc-2.27/lib/libc.so.6\r\n#8  0x00007ffff7deaa77 in _dl_open () from /nix/store/7gx4kiv5m0i7d7qkixq2cwzbr10lvxwc-glibc-2.27/lib/ld-linux-x86-64.so.2\r\n#9  0x00007ffff6ee4fc6 in dlopen_doit () from /nix/store/7gx4kiv5m0i7d7qkixq2cwzbr10lvxwc-glibc-2.27/lib/libdl.so.2\r\n#10 0x00007ffff6a529cc in _dl_catch_exception () from /nix/store/7gx4kiv5m0i7d7qkixq2cwzbr10lvxwc-glibc-2.27/lib/libc.so.6\r\n#11 0x00007ffff6a52a4f in _dl_catch_error () from /nix/store/7gx4kiv5m0i7d7qkixq2cwzbr10lvxwc-glibc-2.27/lib/libc.so.6\r\n#12 0x00007ffff6ee5619 in _dlerror_run () from /nix/store/7gx4kiv5m0i7d7qkixq2cwzbr10lvxwc-glibc-2.27/lib/libdl.so.2\r\n#13 0x00007ffff6ee5056 in dlopen@@GLIBC_2.2.5 () from /nix/store/7gx4kiv5m0i7d7qkixq2cwzbr10lvxwc-glibc-2.27/lib/libdl.so.2\r\n#14 0x00007ffff45febb4 in rustc_metadata::dynamic_lib::dl::open ()\r\n   from /nix/store/jknmv24nl8zz0cacn14y317kms1521ra-rust-1.33.0-nightly-2019-01-10-c2d381d39/bin/../lib/../lib/librustc_metadata-8089fdf4fd6a5a3b.so\r\n#15 0x00007ffff46458c8 in rustc_metadata::dynamic_lib::DynamicLibrary::open ()\r\n   from /nix/store/jknmv24nl8zz0cacn14y317kms1521ra-rust-1.33.0-nightly-2019-01-10-c2d381d39/bin/../lib/../lib/librustc_metadata-8089fdf4fd6a5a3b.so\r\n#16 0x00007ffff7661cae in rustc_driver::load_backend_from_dylib ()\r\n   from /nix/store/jknmv24nl8zz0cacn14y317kms1521ra-rust-1.33.0-nightly-2019-01-10-c2d381d39/bin/../lib/librustc_driver-701dfbab6509fb05.so\r\n#17 0x00007ffff7662d4c in rustc_driver::get_codegen_sysroot ()\r\n   from /nix/store/jknmv24nl8zz0cacn14y317kms1521ra-rust-1.33.0-nightly-2019-01-10-c2d381d39/bin/../lib/librustc_driver-701dfbab6509fb05.so\r\n#18 0x00007ffff766b096 in rustc_driver::version ()\r\n   from /nix/store/jknmv24nl8zz0cacn14y317kms1521ra-rust-1.33.0-nightly-2019-01-10-c2d381d39/bin/../lib/librustc_driver-701dfbab6509fb05.so\r\n#19 0x00007ffff766e39b in rustc_driver::handle_options ()\r\n   from /nix/store/jknmv24nl8zz0cacn14y317kms1521ra-rust-1.33.0-nightly-2019-01-10-c2d381d39/bin/../lib/librustc_driver-701dfbab6509fb05.so\r\n#20 0x00007ffff7663780 in rustc_driver::run_compiler ()\r\n   from /nix/store/jknmv24nl8zz0cacn14y317kms1521ra-rust-1.33.0-nightly-2019-01-10-c2d381d39/bin/../lib/librustc_driver-701dfbab6509fb05.so\r\n#21 0x00007ffff766f9eb in <scoped_tls::ScopedKey<T>>::set ()\r\n   from /nix/store/jknmv24nl8zz0cacn14y317kms1521ra-rust-1.33.0-nightly-2019-01-10-c2d381d39/bin/../lib/librustc_driver-701dfbab6509fb05.so\r\n#22 0x00007ffff7742be3 in std::sys_common::backtrace::__rust_begin_short_backtrace ()\r\n   from /nix/store/jknmv24nl8zz0cacn14y317kms1521ra-rust-1.33.0-nightly-2019-01-10-c2d381d39/bin/../lib/librustc_driver-701dfbab6509fb05.so\r\n#23 0x00007ffff737d56a in __rust_maybe_catch_panic () at src/libpanic_unwind/lib.rs:92\r\n#24 0x00007ffff774e261 in <F as alloc::boxed::FnBox<A>>::call_box ()\r\n   from /nix/store/jknmv24nl8zz0cacn14y317kms1521ra-rust-1.33.0-nightly-2019-01-10-c2d381d39/bin/../lib/librustc_driver-701dfbab6509fb05.so\r\n#25 0x00007ffff737c32e in _$LT$alloc..boxed..Box$LT$$LP$dyn$u20$alloc..boxed..FnBox$LT$A$C$$u20$Output$u3d$R$GT$$u20$$u2b$$u20$$u27$a$RP$$GT$$u20$as$u20$core..ops..function..FnOnce$LT$A$GT$$GT$::call_once::hb8a717666535f7b2 () at /rustc/c2d381d39d282c0586d50ea7d7a431ffd5ddb3fb/src/liballoc/boxed.rs:744\r\n#26 std::sys_common::thread::start_thread () at src/libstd/sys_common/thread.rs:14\r\n#27 std::sys::unix::thread::Thread::new::thread_start () at src/libstd/sys/unix/thread.rs:81\r\n#28 0x00007ffff70ef5a7 in start_thread () from /nix/store/7gx4kiv5m0i7d7qkixq2cwzbr10lvxwc-glibc-2.27/lib/libpthread.so.0\r\n#29 0x00007ffff6a1a22f in clone () from /nix/store/7gx4kiv5m0i7d7qkixq2cwzbr10lvxwc-glibc-2.27/lib/libc.so.6\r\n(gdb)\r\n```", "closed_by": {"login": "nagisa", "id": 679122, "node_id": "MDQ6VXNlcjY3OTEyMg==", "avatar_url": "https://avatars.githubusercontent.com/u/679122?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nagisa", "html_url": "https://github.com/nagisa", "followers_url": "https://api.github.com/users/nagisa/followers", "following_url": "https://api.github.com/users/nagisa/following{/other_user}", "gists_url": "https://api.github.com/users/nagisa/gists{/gist_id}", "starred_url": "https://api.github.com/users/nagisa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nagisa/subscriptions", "organizations_url": "https://api.github.com/users/nagisa/orgs", "repos_url": "https://api.github.com/users/nagisa/repos", "events_url": "https://api.github.com/users/nagisa/events{/privacy}", "received_events_url": "https://api.github.com/users/nagisa/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/57518/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/57518/timeline", "performed_via_github_app": null, "state_reason": "completed"}