{"url": "https://api.github.com/repos/rust-lang/rust/issues/24821", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/24821/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/24821/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/24821/events", "html_url": "https://github.com/rust-lang/rust/issues/24821", "id": 70962784, "node_id": "MDU6SXNzdWU3MDk2Mjc4NA==", "number": 24821, "title": "Don't panic when println!() fails", "user": {"login": "lilyball", "id": 714, "node_id": "MDQ6VXNlcjcxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/714?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lilyball", "html_url": "https://github.com/lilyball", "followers_url": "https://api.github.com/users/lilyball/followers", "following_url": "https://api.github.com/users/lilyball/following{/other_user}", "gists_url": "https://api.github.com/users/lilyball/gists{/gist_id}", "starred_url": "https://api.github.com/users/lilyball/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lilyball/subscriptions", "organizations_url": "https://api.github.com/users/lilyball/orgs", "repos_url": "https://api.github.com/users/lilyball/repos", "events_url": "https://api.github.com/users/lilyball/events{/privacy}", "received_events_url": "https://api.github.com/users/lilyball/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 211668062, "node_id": "MDU6TGFiZWwyMTE2NjgwNjI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-libs-api", "name": "T-libs-api", "color": "bfd4f2", "default": false, "description": "Relevant to the library API team, which will review and decide on the PR/issue."}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2015-04-25T20:22:18Z", "updated_at": "2021-06-23T17:21:56Z", "closed_at": "2017-01-10T08:14:23Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Right now `print!()` and `println!()` explicitly panic when they get an error writing to stdout. This is undocumented. It's also surprising, partially because printing to stdout is not _usually_ considered \"critical\" functionality for a program, and partially because all precedent I'm aware of in other languages for \"print this thing to stdout\" does not abort if the print fails.\n\nAnyone printing information to stdout that is \"critical\", such that the program should not continue if the write failed, should be using `write!()` or `writeln!()` (or one of the `io::Write` methods) in order to handle the error (which could just be calling `.unwrap()` to panic if the write failed). But I fully expect that the vast majority of code using `println!()` is not printing something that is so critical that the program should refuse to continue if the print fails, and as such should simply ignore any errors instead of panicking. Ultimately, `println!()` is the \"convenience\" way to print informative stuff to stdout, and panicking on EPIPE is not very convenient.\n\nThere was some discussion a year ago on #13824 that floated the idea of ignoring the error, but it seemed fairly inconclusive. And another ticket #14505 shows that `rustc` reports an ICE when invoked as `rustc --version | false` (due to `false` terminating without reading stdin).\n\nConceptually, I believe that `println!(...)` should be equivalent to `let _ = writeln!(io::stdout(), ...)`, although in practice it won't be because `std::io` still has the task-local stdout replacement functionality (used by libtest).\n\n/cc @alexcrichton \n", "closed_by": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/24821/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/24821/timeline", "performed_via_github_app": null, "state_reason": "completed"}