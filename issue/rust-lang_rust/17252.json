{"url": "https://api.github.com/repos/rust-lang/rust/issues/17252", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/17252/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/17252/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/17252/events", "html_url": "https://github.com/rust-lang/rust/issues/17252", "id": 42722783, "node_id": "MDU6SXNzdWU0MjcyMjc4Mw==", "number": 17252, "title": "Stack overflow when using recursive statics", "user": {"login": "veddan", "id": 307180, "node_id": "MDQ6VXNlcjMwNzE4MA==", "avatar_url": "https://avatars.githubusercontent.com/u/307180?v=4", "gravatar_id": "", "url": "https://api.github.com/users/veddan", "html_url": "https://github.com/veddan", "followers_url": "https://api.github.com/users/veddan/followers", "following_url": "https://api.github.com/users/veddan/following{/other_user}", "gists_url": "https://api.github.com/users/veddan/gists{/gist_id}", "starred_url": "https://api.github.com/users/veddan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/veddan/subscriptions", "organizations_url": "https://api.github.com/users/veddan/orgs", "repos_url": "https://api.github.com/users/veddan/repos", "events_url": "https://api.github.com/users/veddan/events{/privacy}", "received_events_url": "https://api.github.com/users/veddan/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2014-09-14T15:19:43Z", "updated_at": "2014-09-20T11:20:27Z", "closed_at": "2014-09-20T11:20:27Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Normally when a static variable has a recursive the definition, the compiler issues an error. However, if the static is used (and not just defined) rustc overflows its stack.\n\nThis program causes a stack overflow:\n\n``` rust\nstatic FOO: uint = FOO * 1;                                                                         \n\nfn main() {                                                                                         \n    let x: [u8,..FOO];                                                                              \n} \n```\n\nStack trace:\n\n```\n#0    0x00007ffff64cc000 in rust_stack_exhausted () from /usr/local/lib/librustrt-4e7c5e5c.so\n#1    0x00007ffff7546425 in __morestack () from /usr/local/lib/librustc-4e7c5e5c.so\n#2    0x00007ffff6dd220d in middle::const_eval::eval_const_expr_partial::h11ede327256210699Mo () from /usr/local/lib/librustc-4e7c5e5c.so\n....\n#2586 0x00007ffff6dd220d in middle::const_eval::eval_const_expr_partial::h11ede327256210699Mo () from /usr/local/lib/librustc-4e7c5e5c.so\n#2587 0x00007ffff7154294 in middle::typeck::astconv::ast_ty_to_ty::h12934078733027096147 () from /usr/local/lib/librustc-4e7c5e5c.so\n#2588 0x00007ffff713ba14 in middle::typeck::check::GatherLocalsVisitor$LT$$x27a$C$$x20$x27tcx$GT$.Visitor$LT$$LP$$RP$$GT$::visit_local::hac083927a83885a8TnQ () from /usr/local/lib/librustc-4e7c5e5c.so\n#2589 0x00007ffff713d7ca in visit::walk_block::h15602413499699722333 () from /usr/local/lib/librustc-4e7c5e5c.so\n#2590 0x00007ffff713a453 in middle::typeck::check::check_fn::h1f6850cb24db919djvQ () from /usr/local/lib/librustc-4e7c5e5c.so\n#2591 0x00007ffff71399c9 in middle::typeck::check::check_bare_fn::h83c6b77b92a9500dHkQ () from /usr/local/lib/librustc-4e7c5e5c.so\n#2592 0x00007ffff7144a71 in middle::typeck::check::check_method_body::h87417f0ff66a2979R7Q () from /usr/local/lib/librustc-4e7c5e5c.so\n#2593 0x00007ffff7132900 in middle::typeck::check::check_item::hf5c79816b6c27c066WQ () from /usr/local/lib/librustc-4e7c5e5c.so\n#2594 0x00007ffff7134956 in visit::walk_item::h4472717221064912739 () from /usr/local/lib/librustc-4e7c5e5c.so\n#2595 0x00007ffff71397a4 in middle::typeck::check::check_item_types::h792a27a56b24fe35GjQ () from /usr/local/lib/librustc-4e7c5e5c.so\n#2596 0x00007ffff6b46246 in util::common::time::h7017450272318258908 () from /usr/local/lib/librustc-4e7c5e5c.so\n#2597 0x00007ffff735eaa5 in middle::typeck::check_crate::hc8cbed21e0ad422eqOg () from /usr/local/lib/librustc-4e7c5e5c.so\n#2598 0x00007ffff7422979 in driver::driver::phase_3_run_analysis_passes::ha948f4e333bb56e1bHu () from /usr/local/lib/librustc-4e7c5e5c.so\n#2599 0x00007ffff741d43b in driver::driver::compile_input::h60c9b34042a1c1d73ru () from /usr/local/lib/librustc-4e7c5e5c.so\n#2600 0x00007ffff74b326e in driver::run_compiler::h855c1a698770968a3dy () from /usr/local/lib/librustc-4e7c5e5c.so\n#2601 0x00007ffff74b1475 in driver::main_args::closure.148494 () from /usr/local/lib/librustc-4e7c5e5c.so\n#2602 0x00007ffff6b5ef38 in task::TaskBuilder$LT$S$GT$::try_future::closure.100359 () from /usr/local/lib/librustc-4e7c5e5c.so\n#2603 0x00007ffff6b5ee43 in task::TaskBuilder$LT$S$GT$::spawn_internal::closure.100330 () from /usr/local/lib/librustc-4e7c5e5c.so\n#2604 0x00007ffff68242f2 in task::spawn_opts::closure.8418 () from /usr/local/lib/libnative-4e7c5e5c.so\n#2605 0x00007ffff652752c in rust_try_inner () from /usr/local/lib/librustrt-4e7c5e5c.so\n#2606 0x00007ffff6527516 in rust_try () from /usr/local/lib/librustrt-4e7c5e5c.so\n#2607 0x00007ffff64cc393 in unwind::try::h8584155988c4d0bcuId () from /usr/local/lib/librustrt-4e7c5e5c.so\n#2608 0x00007ffff64cc22c in task::Task::run::h6c02ec598f069801fYc () from /usr/local/lib/librustrt-4e7c5e5c.so\n#2609 0x00007ffff6824122 in task::spawn_opts::closure.8358 () from /usr/local/lib/libnative-4e7c5e5c.so\n#2610 0x00007ffff64cddc3 in thread::thread_start::h964d785f09a9e637rid () from /usr/local/lib/librustrt-4e7c5e5c.so\n#2611 0x00007ffff13dc0db in start_thread () from /lib64/libpthread.so.0\n```\n", "closed_by": {"login": "veddan", "id": 307180, "node_id": "MDQ6VXNlcjMwNzE4MA==", "avatar_url": "https://avatars.githubusercontent.com/u/307180?v=4", "gravatar_id": "", "url": "https://api.github.com/users/veddan", "html_url": "https://github.com/veddan", "followers_url": "https://api.github.com/users/veddan/followers", "following_url": "https://api.github.com/users/veddan/following{/other_user}", "gists_url": "https://api.github.com/users/veddan/gists{/gist_id}", "starred_url": "https://api.github.com/users/veddan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/veddan/subscriptions", "organizations_url": "https://api.github.com/users/veddan/orgs", "repos_url": "https://api.github.com/users/veddan/repos", "events_url": "https://api.github.com/users/veddan/events{/privacy}", "received_events_url": "https://api.github.com/users/veddan/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/17252/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/17252/timeline", "performed_via_github_app": null, "state_reason": "completed"}