{"url": "https://api.github.com/repos/rust-lang/rust/issues/13520", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/13520/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/13520/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/13520/events", "html_url": "https://github.com/rust-lang/rust/issues/13520", "id": 31506178, "node_id": "MDU6SXNzdWUzMTUwNjE3OA==", "number": 13520, "title": "compiler segfault with deref of *() in asm arg", "user": {"login": "kmcallister", "id": 444997, "node_id": "MDQ6VXNlcjQ0NDk5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/444997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kmcallister", "html_url": "https://github.com/kmcallister", "followers_url": "https://api.github.com/users/kmcallister/followers", "following_url": "https://api.github.com/users/kmcallister/following{/other_user}", "gists_url": "https://api.github.com/users/kmcallister/gists{/gist_id}", "starred_url": "https://api.github.com/users/kmcallister/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kmcallister/subscriptions", "organizations_url": "https://api.github.com/users/kmcallister/orgs", "repos_url": "https://api.github.com/users/kmcallister/repos", "events_url": "https://api.github.com/users/kmcallister/events{/privacy}", "received_events_url": "https://api.github.com/users/kmcallister/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 100522, "node_id": "MDU6TGFiZWwxMDA1MjI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-crash", "name": "I-crash", "color": "e10c02", "default": false, "description": "Issue: The compiler crashes (SIGSEGV, SIGABRT, etc). Use I-ICE instead when the compiler panics."}, {"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}, {"id": 60344715, "node_id": "MDU6TGFiZWw2MDM0NDcxNQ==", "url": "https://api.github.com/repos/rust-lang/rust/labels/P-medium", "name": "P-medium", "color": "eb6420", "default": false, "description": "Medium priority"}, {"id": 91598611, "node_id": "MDU6TGFiZWw5MTU5ODYxMQ==", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-inline-assembly", "name": "A-inline-assembly", "color": "f7e101", "default": false, "description": "Area: inline asm!(..)"}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}, {"id": 1472563007, "node_id": "MDU6TGFiZWwxNDcyNTYzMDA3", "url": "https://api.github.com/repos/rust-lang/rust/labels/requires-nightly", "name": "requires-nightly", "color": "76dcde", "default": false, "description": "This issue requires a nightly compiler in some way."}, {"id": 1615551553, "node_id": "MDU6TGFiZWwxNjE1NTUxNTUz", "url": "https://api.github.com/repos/rust-lang/rust/labels/glacier", "name": "glacier", "color": "a5e2ff", "default": false, "description": "ICE tracked in rust-lang/glacier"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2014-04-14T21:22:22Z", "updated_at": "2020-09-30T20:36:36Z", "closed_at": "2020-05-22T19:07:31Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "``` .rs\n#![feature(asm)]\n\nfn main() {\n    let x = ();\n    unsafe {\n        let p: *const () = &x;\n        asm!(\"\" :: \"r\"(*p));\n    }\n}\n```\n\n```\n$ rustc -v\nrustc 0.11-pre (cee9a83 2014-04-11 15:54:46 -0700)\nhost: x86_64-unknown-linux-gnu\n\n$ gdb --args rustc foo.rs\n(gdb) run\nProgram received signal SIGSEGV, Segmentation fault.\n0x00007ffff6119b99 in llvm::X86TargetLowering::isZExtFree(llvm::SDValue, llvm::EVT) const ()\n   from /home/keegan/proj/rust/rust/x86_64-unknown-linux-gnu/stage2/bin/../lib/librustc-4283bb68-0.11-pre.so\n(gdb) bt\n#0  0x00007ffff6119b99 in llvm::X86TargetLowering::isZExtFree(llvm::SDValue, llvm::EVT) const ()\n   from /home/keegan/proj/rust/rust/x86_64-unknown-linux-gnu/stage2/bin/../lib/librustc-4283bb68-0.11-pre.so\n#1  0x00007ffff62650fd in (anonymous namespace)::RegsForValue::getCopyToRegs(llvm::SDValue, llvm::SelectionDAG&, llvm::SDLoc, llvm::SDValue&, llvm::SDValue*, llvm::Value const*) const () from /home/keegan/proj/rust/rust/x86_64-unknown-linux-gnu/stage2/bin/../lib/librustc-4283bb68-0.11-pre.so\n#2  0x00007ffff627d822 in llvm::SelectionDAGBuilder::visitInlineAsm(llvm::ImmutableCallSite) ()\n   from /home/keegan/proj/rust/rust/x86_64-unknown-linux-gnu/stage2/bin/../lib/librustc-4283bb68-0.11-pre.so\n#3  0x00007ffff628d5a3 in llvm::SelectionDAGBuilder::visitCall(llvm::CallInst const&) ()\n   from /home/keegan/proj/rust/rust/x86_64-unknown-linux-gnu/stage2/bin/../lib/librustc-4283bb68-0.11-pre.so\n#4  0x00007ffff629bc1a in llvm::SelectionDAGBuilder::visit(llvm::Instruction const&) ()\n   from /home/keegan/proj/rust/rust/x86_64-unknown-linux-gnu/stage2/bin/../lib/librustc-4283bb68-0.11-pre.so\n#5  0x00007ffff62ad491 in llvm::SelectionDAGISel::SelectBasicBlock(llvm::ilist_iterator<llvm::Instruction const>, llvm::ilist_iterator<llvm::Instruction const>, bool&) () from /home/keegan/proj/rust/rust/x86_64-unknown-linux-gnu/stage2/bin/../lib/librustc-4283bb68-0.11-pre.so\n#6  0x00007ffff62aeee8 in llvm::SelectionDAGISel::SelectAllBasicBlocks(llvm::Function const&) ()\n   from /home/keegan/proj/rust/rust/x86_64-unknown-linux-gnu/stage2/bin/../lib/librustc-4283bb68-0.11-pre.so\n#7  0x00007ffff62b0de5 in llvm::SelectionDAGISel::runOnMachineFunction(llvm::MachineFunction&) ()\n   from /home/keegan/proj/rust/rust/x86_64-unknown-linux-gnu/stage2/bin/../lib/librustc-4283bb68-0.11-pre.so\n#8  0x00007ffff6a3d56f in llvm::FPPassManager::runOnFunction(llvm::Function&) ()\n   from /home/keegan/proj/rust/rust/x86_64-unknown-linux-gnu/stage2/bin/../lib/librustc-4283bb68-0.11-pre.so\n#9  0x00007ffff6a3d5bb in llvm::FPPassManager::runOnModule(llvm::Module&) ()\n   from /home/keegan/proj/rust/rust/x86_64-unknown-linux-gnu/stage2/bin/../lib/librustc-4283bb68-0.11-pre.so\n#10 0x00007ffff6a3d12f in llvm::legacy::PassManagerImpl::run(llvm::Module&) ()\n   from /home/keegan/proj/rust/rust/x86_64-unknown-linux-gnu/stage2/bin/../lib/librustc-4283bb68-0.11-pre.so\n#11 0x00007ffff5d4fa5c in LLVMRustWriteOutputFile (Target=0x660720, PMR=0x69a400, M=0x6b7ca0, path=<optimized out>, \n    FileType=llvm::TargetMachine::CGFT_ObjectFile) at /home/keegan/proj/rust/rust/src/rustllvm/PassWrapper.cpp:181\n#12 0x00007ffff5bfda5c in back::link::WriteOutputFile::hbd128889f580a8157n0::v0.11.pre ()\n   from /home/keegan/proj/rust/rust/x86_64-unknown-linux-gnu/stage2/bin/../lib/librustc-4283bb68-0.11-pre.so\n#13 0x00007ffff5c0396e in back::link::write::run_passes::closure.83721 ()\n   from /home/keegan/proj/rust/rust/x86_64-unknown-linux-gnu/stage2/bin/../lib/librustc-4283bb68-0.11-pre.so\n#14 0x00007ffff58d44d5 in util::common::time::h1b088cb92ee0b019kMg::v0.11.pre ()\n   from /home/keegan/proj/rust/rust/x86_64-unknown-linux-gnu/stage2/bin/../lib/librustc-4283bb68-0.11-pre.so\n#15 0x00007ffff5bff8a0 in back::link::write::run_passes::hae8f9777a11894c2mq0::v0.11.pre ()\n   from /home/keegan/proj/rust/rust/x86_64-unknown-linux-gnu/stage2/bin/../lib/librustc-4283bb68-0.11-pre.so\n#16 0x00007ffff5d10490 in driver::driver::phase_5_run_llvm_passes::closure.90168 ()\n   from /home/keegan/proj/rust/rust/x86_64-unknown-linux-gnu/stage2/bin/../lib/librustc-4283bb68-0.11-pre.so\n#17 0x00007ffff58d44d5 in util::common::time::h1b088cb92ee0b019kMg::v0.11.pre ()\n   from /home/keegan/proj/rust/rust/x86_64-unknown-linux-gnu/stage2/bin/../lib/librustc-4283bb68-0.11-pre.so\n#18 0x00007ffff5d1031b in driver::driver::phase_5_run_llvm_passes::h10b364552bbe780eQIe::v0.11.pre ()\n   from /home/keegan/proj/rust/rust/x86_64-unknown-linux-gnu/stage2/bin/../lib/librustc-4283bb68-0.11-pre.so\n#19 0x00007ffff5d130f2 in driver::driver::compile_input::hef357caacd97acfcPXe::v0.11.pre ()\n   from /home/keegan/proj/rust/rust/x86_64-unknown-linux-gnu/stage2/bin/../lib/librustc-4283bb68-0.11-pre.so\n#20 0x00007ffff5d375f5 in run_compiler::ha4e573becdf712cbfvm::v0.11.pre ()\n   from /home/keegan/proj/rust/rust/x86_64-unknown-linux-gnu/stage2/bin/../lib/librustc-4283bb68-0.11-pre.so\n#21 0x00007ffff5d4c07c in main_args::closure.92079 ()\n   from /home/keegan/proj/rust/rust/x86_64-unknown-linux-gnu/stage2/bin/../lib/librustc-4283bb68-0.11-pre.so\n#22 0x00007ffff5d4aa26 in monitor::closure.91964 () from /home/keegan/proj/rust/rust/x86_64-unknown-linux-gnu/stage2/bin/../lib/librustc-4283bb68-0.11-pre.so\n#23 0x00007ffff5d462d8 in task::TaskBuilder::try::closure.91739 ()\n   from /home/keegan/proj/rust/rust/x86_64-unknown-linux-gnu/stage2/bin/../lib/librustc-4283bb68-0.11-pre.so\n#24 0x00007ffff7bbb348 in task::spawn_opts::closure.7852 ()\n   from /home/keegan/proj/rust/rust/x86_64-unknown-linux-gnu/stage2/bin/../lib/libnative-83574243-0.11-pre.so\n#25 0x00007ffff4b76b03 in rt::task::Task::run::closure.39978 ()\n   from /home/keegan/proj/rust/rust/x86_64-unknown-linux-gnu/stage2/bin/../lib/libstd-aad93cea-0.11-pre.so\n#26 0x00007ffff4b8213c in rust_try () from /home/keegan/proj/rust/rust/x86_64-unknown-linux-gnu/stage2/bin/../lib/libstd-aad93cea-0.11-pre.so\n#27 0x00007ffff4b76962 in rt::task::Task::run::h6d25268f43c2f945vc8::v0.11.pre ()\n   from /home/keegan/proj/rust/rust/x86_64-unknown-linux-gnu/stage2/bin/../lib/libstd-aad93cea-0.11-pre.so\n#28 0x00007ffff7bbb1d0 in task::spawn_opts::closure.7825 ()\n   from /home/keegan/proj/rust/rust/x86_64-unknown-linux-gnu/stage2/bin/../lib/libnative-83574243-0.11-pre.so\n#29 0x00007ffff4b7a24f in rt::thread::thread_start::hceb81ee57b19689fdR8::v0.11.pre ()\n   from /home/keegan/proj/rust/rust/x86_64-unknown-linux-gnu/stage2/bin/../lib/libstd-aad93cea-0.11-pre.so\n#30 0x00007ffff1f29b50 in start_thread (arg=<optimized out>) at pthread_create.c:304\n#31 0x00007ffff47c30ed in clone () at ../sysdeps/unix/sysv/linux/x86_64/clone.S:112\n#32 0x0000000000000000 in ?? ()\n```\n", "closed_by": {"login": "Amanieu", "id": 278509, "node_id": "MDQ6VXNlcjI3ODUwOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/278509?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Amanieu", "html_url": "https://github.com/Amanieu", "followers_url": "https://api.github.com/users/Amanieu/followers", "following_url": "https://api.github.com/users/Amanieu/following{/other_user}", "gists_url": "https://api.github.com/users/Amanieu/gists{/gist_id}", "starred_url": "https://api.github.com/users/Amanieu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Amanieu/subscriptions", "organizations_url": "https://api.github.com/users/Amanieu/orgs", "repos_url": "https://api.github.com/users/Amanieu/repos", "events_url": "https://api.github.com/users/Amanieu/events{/privacy}", "received_events_url": "https://api.github.com/users/Amanieu/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/13520/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/13520/timeline", "performed_via_github_app": null, "state_reason": "completed"}