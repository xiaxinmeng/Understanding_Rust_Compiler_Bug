{"url": "https://api.github.com/repos/rust-lang/rust/issues/28373", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/28373/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/28373/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/28373/events", "html_url": "https://github.com/rust-lang/rust/issues/28373", "id": 106145998, "node_id": "MDU6SXNzdWUxMDYxNDU5OTg=", "number": 28373, "title": "Somehow address redundancies between doc-comment code and crate code", "user": {"login": "Kimundi", "id": 2903206, "node_id": "MDQ6VXNlcjI5MDMyMDY=", "avatar_url": "https://avatars.githubusercontent.com/u/2903206?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Kimundi", "html_url": "https://github.com/Kimundi", "followers_url": "https://api.github.com/users/Kimundi/followers", "following_url": "https://api.github.com/users/Kimundi/following{/other_user}", "gists_url": "https://api.github.com/users/Kimundi/gists{/gist_id}", "starred_url": "https://api.github.com/users/Kimundi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Kimundi/subscriptions", "organizations_url": "https://api.github.com/users/Kimundi/orgs", "repos_url": "https://api.github.com/users/Kimundi/repos", "events_url": "https://api.github.com/users/Kimundi/events{/privacy}", "received_events_url": "https://api.github.com/users/Kimundi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 203738, "node_id": "MDU6TGFiZWwyMDM3Mzg=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-rustdoc", "name": "T-rustdoc", "color": "bfd4f2", "default": false, "description": "Relevant to the rustdoc team, which will review and decide on the PR/issue."}, {"id": 602425123, "node_id": "MDU6TGFiZWw2MDI0MjUxMjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-dev-tools", "name": "T-dev-tools", "color": "bfd4f2", "default": false, "description": "Relevant to the dev-tools subteam, which will review and decide on the PR/issue."}, {"id": 630652267, "node_id": "MDU6TGFiZWw2MzA2NTIyNjc=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-feature-request", "name": "C-feature-request", "color": "f5f1fd", "default": false, "description": "Category: A feature request, i.e: not implemented / a PR."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2015-09-12T10:22:20Z", "updated_at": "2019-08-31T23:01:31Z", "closed_at": "2019-08-31T23:01:31Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "# Issue\n\nI noticed with a few of my crates that I have some redundancies between my docs and the code in the crate, specifically testcases. As a example, here `nice_example()` is duplicated:\n\n``````\n//! docs docs docs\n//! docs docs docs\n//! ```\n//! fn nice_example() { ... }\n//! ```\n\n...\n\n#[test]\nfn nice_example() { ... }\n``````\n\nNow, there are right now two ways to deal with this:\n- Keep both copies\n  - Con: redundant copies, code can start drifting apart unintentionally.\n  - Pro: If docs and tests diverge intentional, no additional work is needed.\n- Remove the separate unit test copy of the code.\n  - Pro: The docs will get tested anyway\n  - Pro: No redundancy\n  - Con: Unit tests get split between two locations\n  - Con: Unit tests start mixing with documentation, a change to either might cause changes to both and/or moving the unit test code back and forth between the docs and the crate.\n\nAs an additional issue, having rust code in doc comments be highlighted as rust code is kinda complicated - or at least not implemented in most highlighters.\n# Proposal\n\nHave a way in doc comments to \"include\" the source code of an item in the documented crate, eg:\n\n``````\n//! docs docs docs\n//! docs docs docs\n//! ```\n//! #rustdoc_include self::nice_example\n//! ```\n\n...\n\n#[test]\nfn nice_example() { ... }\n``````\n- Pro: Only one copy of the actual code\n- Pro: No redundancy\n- Pro: Unit tests can be kept separate from the docs, even if they are nicely documented and used as example code in them.\n- Pro: If the docs don't want to use that particular code example anymore, only the reference needs\n  to be deleted, and a nicely commented unit test remains.\n- The one copy of the code is outside doc comments, and thus will get highlighted correctly.\n- Con: More machinery for rustdoc to support\n- Con: Harder to read and write the documentation directly in the source.\n", "closed_by": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/28373/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/28373/timeline", "performed_via_github_app": null, "state_reason": "completed"}