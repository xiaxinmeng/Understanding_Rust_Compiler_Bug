{"url": "https://api.github.com/repos/rust-lang/rust/issues/111837", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/111837/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/111837/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/111837/events", "html_url": "https://github.com/rust-lang/rust/issues/111837", "id": 1719131876, "node_id": "I_kwDOAAsO6M5md97k", "number": 111837, "title": "`error[E0596]: cannot borrow ... as mutable, as it is not declared as mutable` help note is misleading", "user": {"login": "Veykril", "id": 3757771, "node_id": "MDQ6VXNlcjM3NTc3NzE=", "avatar_url": "https://avatars.githubusercontent.com/u/3757771?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Veykril", "html_url": "https://github.com/Veykril", "followers_url": "https://api.github.com/users/Veykril/followers", "following_url": "https://api.github.com/users/Veykril/following{/other_user}", "gists_url": "https://api.github.com/users/Veykril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Veykril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Veykril/subscriptions", "organizations_url": "https://api.github.com/users/Veykril/orgs", "repos_url": "https://api.github.com/users/Veykril/repos", "events_url": "https://api.github.com/users/Veykril/events{/privacy}", "received_events_url": "https://api.github.com/users/Veykril/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 235791, "node_id": "MDU6TGFiZWwyMzU3OTE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-diagnostics", "name": "A-diagnostics", "color": "f7e101", "default": false, "description": "Area: Messages for errors, warnings, and lints"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2023-05-22T08:05:19Z", "updated_at": "2023-05-22T08:05:19Z", "closed_at": null, "author_association": "MEMBER", "active_lock_reason": null, "body": "### Code\n\n```Rust\nfn once(it: &mut ()) {\r\n    twice(&mut it)\r\n}\r\nfn twice(_: &mut &mut ()) {}\n```\n\n\n### Current output\n\n```Shell\nerror[E0596]: cannot borrow `it` as mutable, as it is not declared as mutable\r\n --> src/lib.rs:2:11\r\n  |\r\n2 |     twice(&mut it)\r\n  |           ^^^^^^^ cannot borrow as mutable\r\n  |\r\nnote: the binding is already a mutable borrow\r\n --> src/lib.rs:1:13\r\n  |\r\n1 | fn once(it: &mut ()) {\r\n  |             ^^^^^^^\r\nhelp: try removing `&mut` here\r\n  |\r\n2 -     twice(&mut it)\r\n2 +     twice(it)\r\n  |\r\n\r\nFor more information about this error, try `rustc --explain E0596`.\n```\n\n\n### Desired output\n\n```Shell\nerror[E0596]: cannot borrow `it` as mutable, as it is not declared as mutable\r\n --> src/lib.rs:2:11\r\n  |\r\n2 |     twice(&mut it)\r\n  |           ^^^^^^^ cannot borrow as mutable\r\n  |\r\nhelp: consider changing this to be mutable\r\n  |\r\n1 | fn once(mut it: &mut ()) {\r\n  |         +++\r\n\r\nFor more information about this error, try `rustc --explain E0596`.\n```\n\n\n### Rationale and extra context\n\nThe borrow itself is correct, as it will produce the expected type so the help label is wrong. Instead, the user should be pointed  to add the missing `mut` modifier for the binding.\n\n### Other cases\n\n```Rust\nstruct S;\r\n\r\nimpl S {\r\n    fn once(self: &mut Self) {\r\n        Self::twice(&mut self)\r\n    }\r\n    fn twice(_: &mut &mut Self) {}\r\n}\r\n\r\nalso suffers from this.\n```\n\n\n### Anything else?\n\n_No response_", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/111837/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/111837/timeline", "performed_via_github_app": null, "state_reason": null}