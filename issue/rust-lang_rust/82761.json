{"url": "https://api.github.com/repos/rust-lang/rust/issues/82761", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/82761/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/82761/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/82761/events", "html_url": "https://github.com/rust-lang/rust/issues/82761", "id": 822194233, "node_id": "MDU6SXNzdWU4MjIxOTQyMzM=", "number": 82761, "title": "lint errors make rustc abort early", "user": {"login": "SNCPlay42", "id": 5455518, "node_id": "MDQ6VXNlcjU0NTU1MTg=", "avatar_url": "https://avatars.githubusercontent.com/u/5455518?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SNCPlay42", "html_url": "https://github.com/SNCPlay42", "followers_url": "https://api.github.com/users/SNCPlay42/followers", "following_url": "https://api.github.com/users/SNCPlay42/following{/other_user}", "gists_url": "https://api.github.com/users/SNCPlay42/gists{/gist_id}", "starred_url": "https://api.github.com/users/SNCPlay42/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SNCPlay42/subscriptions", "organizations_url": "https://api.github.com/users/SNCPlay42/orgs", "repos_url": "https://api.github.com/users/SNCPlay42/repos", "events_url": "https://api.github.com/users/SNCPlay42/events{/privacy}", "received_events_url": "https://api.github.com/users/SNCPlay42/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 235137, "node_id": "MDU6TGFiZWwyMzUxMzc=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-lint", "name": "A-lint", "color": "f7e101", "default": false, "description": "Area: Lints (warnings about flaws in source code) such as unused_mut."}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 630652267, "node_id": "MDU6TGFiZWw2MzA2NTIyNjc=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-feature-request", "name": "C-feature-request", "color": "f5f1fd", "default": false, "description": "Category: A feature request, i.e: not implemented / a PR."}, {"id": 2513492750, "node_id": "MDU6TGFiZWwyNTEzNDkyNzUw", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-clippy", "name": "A-clippy", "color": "f7e101", "default": false, "description": "Area: Clippy"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-03-04T14:39:08Z", "updated_at": "2021-11-09T18:47:54Z", "closed_at": "2021-11-09T11:16:35Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "In general, the compiler tries to keep going after errors to emit as many helpful diagnostics as possible. This isn't always possible because later stages of compilation might need certain conditions to be upheld, so sometimes the compiler aborts early.\r\n\r\nIt should never be necessary to abort early due to a lint ~~from an external tool (e.g. clippy)~~ because the compiler's hard errors should be sufficient to enforce conditions needed by later stages.\r\n\r\nAt present, however, error-level lints ~~emitted by external tools~~ can cause compilation to abort early. It seems unfortunate that, after fixing all the problems reported by one run of clippy, you could run clippy again (perhaps by committing your \"fixed\" code and updating a PR, causing CI to run) and discover there are more problems (when CI fails).\r\n\r\nAs an example, this code:\r\n\r\n```rust\r\nfn main() {\r\n    if true {} {}\r\n    \r\n    let x;\r\n    if true {\r\n        x = 1;\r\n    } else {\r\n        x = 1;\r\n    }\r\n    println!(\"{}\", x);\r\n}\r\n```\r\n\r\nEmits two lints with clippy:\r\n\r\n```\r\nwarning: this looks like an `else {..}` but the `else` is missing\r\n --> src/main.rs:4:15\r\n  |\r\n4 |     if true {} {}\r\n  |               ^\r\n  |\r\n  = note: `#[warn(clippy::suspicious_else_formatting)]` on by default\r\n  = note: to remove this lint, add the missing `else` or add a new line before the next block\r\n  = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#suspicious_else_formatting\r\n\r\nerror: this `if` has identical blocks\r\n  --> src/main.rs:9:12\r\n   |\r\n9  |       } else {\r\n   |  ____________^\r\n10 | |         x = 1;\r\n11 | |     }\r\n   | |_____^\r\n   |\r\n   = note: `#[deny(clippy::if_same_then_else)]` on by default\r\nnote: same as this\r\n  --> src/main.rs:7:13\r\n   |\r\n7  |       if true {\r\n   |  _____________^\r\n8  | |         x = 1;\r\n9  | |     } else {\r\n   | |_____^\r\n   = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#if_same_then_else\r\n\r\nerror: aborting due to previous error; 1 warning emitted\r\n\r\nerror: could not compile `playground`\r\n```\r\n\r\nIf `#![deny(clippy::all)]` is added, only the first lint is emitted, and the compiler aborts after it:\r\n\r\n```\r\nerror: this looks like an `else {..}` but the `else` is missing\r\n --> src/main.rs:4:15\r\n  |\r\n4 |     if true {} {}\r\n  |               ^\r\n  |\r\nnote: the lint level is defined here\r\n --> src/main.rs:1:8\r\n  |\r\n1 | #[deny(clippy::all)]\r\n  |        ^^^^^^^^^^^\r\n  = note: `#[deny(clippy::suspicious_else_formatting)]` implied by `#[deny(clippy::all)]`\r\n  = note: to remove this lint, add the missing `else` or add a new line before the next block\r\n  = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#suspicious_else_formatting\r\n\r\nerror: aborting due to previous error\r\n\r\nerror: could not compile `playground`\r\n```\r\n\r\n@rustbot label A-lint", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/82761/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/82761/timeline", "performed_via_github_app": null, "state_reason": "completed"}