{"url": "https://api.github.com/repos/rust-lang/rust/issues/44232", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/44232/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/44232/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/44232/events", "html_url": "https://github.com/rust-lang/rust/issues/44232", "id": 254494848, "node_id": "MDU6SXNzdWUyNTQ0OTQ4NDg=", "number": 44232, "title": "Re-enable detection of unused library #![feature] directives", "user": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 235137, "node_id": "MDU6TGFiZWwyMzUxMzc=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-lint", "name": "A-lint", "color": "f7e101", "default": false, "description": "Area: Lints (warnings about flaws in source code) such as unused_mut."}, {"id": 60344715, "node_id": "MDU6TGFiZWw2MDM0NDcxNQ==", "url": "https://api.github.com/repos/rust-lang/rust/labels/P-medium", "name": "P-medium", "color": "eb6420", "default": false, "description": "Medium priority"}, {"id": 211668019, "node_id": "MDU6TGFiZWwyMTE2NjgwMTk=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-lang", "name": "T-lang", "color": "bfd4f2", "default": false, "description": "Relevant to the language team, which will review and decide on the PR/issue."}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2017-08-31T23:18:55Z", "updated_at": "2019-08-29T15:56:38Z", "closed_at": null, "author_association": "MEMBER", "active_lock_reason": null, "body": "Currently the compiler will warn users about unused `#![feature]` directives if they're (a) a library feature and (b) not actually ever used. The compiler doesn't currently warn you about unused `#![feature]` directives tied to language features.\r\n\r\nIn the process of making the stability annotations more incremental-friendly (https://github.com/rust-lang/rust/issues/44137) this check in the compiler has proven to be very difficult to make incremental. Namely what's happening here is:\r\n\r\n* There's a function, [`check_stability`](https://github.com/rust-lang/rust/blob/97b01abf3d222523d0db4f79c13ed45e7fef27e3/src/librustc/middle/stability.rs#L492), which is used to verify that an API can actually be used.\r\n* In this function if the API in question is unstable *and* the feature is activated, then [this feature name is stored off in a side table](https://github.com/rust-lang/rust/blob/97b01abf3d222523d0db4f79c13ed45e7fef27e3/src/librustc/middle/stability.rs#L551).\r\n* As we run through the compiler this side table gets bigger and bigger. Right now this table is mostly built up during typeck. (I don't know the precise reason as to why it's in typeck, personally)\r\n* Finally near the end of compilation we go through this table and use it to warn about unused `#![feature]` directives.\r\n\r\nThis \"put things in a table on the side\" behavior isn't very incremental friently and isn't too easy to transition over to the query system. For now this specific warning seems like it probably isn't that important at Rust 1.20.0 (while it was probably very important at Rust 1.0.0). I'm going to comment this out for now so we're not going to get lints/warnings about unused library features.\r\n\r\nThis is a FIXME to track re-enabling this warning!", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/44232/reactions", "total_count": 3, "+1": 3, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/44232/timeline", "performed_via_github_app": null, "state_reason": null}