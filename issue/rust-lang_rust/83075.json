{"url": "https://api.github.com/repos/rust-lang/rust/issues/83075", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/83075/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/83075/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/83075/events", "html_url": "https://github.com/rust-lang/rust/issues/83075", "id": 830791124, "node_id": "MDU6SXNzdWU4MzA3OTExMjQ=", "number": 83075, "title": "rustdoc: \"Show declaration\" causes layout shift during page load", "user": {"login": "jsha", "id": 220205, "node_id": "MDQ6VXNlcjIyMDIwNQ==", "avatar_url": "https://avatars.githubusercontent.com/u/220205?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsha", "html_url": "https://github.com/jsha", "followers_url": "https://api.github.com/users/jsha/followers", "following_url": "https://api.github.com/users/jsha/following{/other_user}", "gists_url": "https://api.github.com/users/jsha/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsha/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsha/subscriptions", "organizations_url": "https://api.github.com/users/jsha/orgs", "repos_url": "https://api.github.com/users/jsha/repos", "events_url": "https://api.github.com/users/jsha/events{/privacy}", "received_events_url": "https://api.github.com/users/jsha/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 203738, "node_id": "MDU6TGFiZWwyMDM3Mzg=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-rustdoc", "name": "T-rustdoc", "color": "bfd4f2", "default": false, "description": "Relevant to the rustdoc team, which will review and decide on the PR/issue."}, {"id": 2406929537, "node_id": "MDU6TGFiZWwyNDA2OTI5NTM3", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-rustdoc-ui", "name": "A-rustdoc-ui", "color": "f7e101", "default": false, "description": "Area: rustdoc UI (generated HTML)"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-03-13T03:20:46Z", "updated_at": "2021-04-22T04:39:59Z", "closed_at": "2021-04-22T04:39:58Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "The top of a rustdoc page for a struct or trait always has `[+] Show declaration` at the top. This text is generated by main.js as part of building all the open/close toggles. Because it's built by JS, it comes in very late in the page load, which generates a noticeable layout shift.\r\n\r\nThis is particularly noticeable on mobile, here the \"Show declaration\" text takes up a significant fraction of the screen.\r\n\r\nOne solution would be to render this text as part of the HTML, so it doesn't have to be generated by JS.\r\n\r\nHowever, I'd like to propose a different fix: For structs and traits, remove \"Show declaration\" text, and the declaration behind it entirely. The same content is provided in more readable form in the \"Fields\", \"Required methods,\" and \"Provided methods\" sections. For the user who wants a link near the top of the document to see the actual declaration as it would be written out in Rust, there's already the `[src]` link.\r\n\r\nThis fix has the added advantage that besides removing a layout shift, it also reclaims some above-the-fold space for the documentation.\r\n\r\n![image](https://user-images.githubusercontent.com/220205/111017175-a0a4f480-8366-11eb-8d4a-8fca38bbce8e.png)\r\n\r\n![image](https://user-images.githubusercontent.com/220205/111017283-55d7ac80-8367-11eb-8ba8-df1937c4d7df.png)\r\n\r\n![Profile-20210312T190703](https://user-images.githubusercontent.com/220205/111017130-66d3ee00-8366-11eb-9f41-fed608fba7d9.gif)\r\n", "closed_by": {"login": "jsha", "id": 220205, "node_id": "MDQ6VXNlcjIyMDIwNQ==", "avatar_url": "https://avatars.githubusercontent.com/u/220205?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsha", "html_url": "https://github.com/jsha", "followers_url": "https://api.github.com/users/jsha/followers", "following_url": "https://api.github.com/users/jsha/following{/other_user}", "gists_url": "https://api.github.com/users/jsha/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsha/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsha/subscriptions", "organizations_url": "https://api.github.com/users/jsha/orgs", "repos_url": "https://api.github.com/users/jsha/repos", "events_url": "https://api.github.com/users/jsha/events{/privacy}", "received_events_url": "https://api.github.com/users/jsha/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/83075/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/83075/timeline", "performed_via_github_app": null, "state_reason": "completed"}