{"url": "https://api.github.com/repos/rust-lang/rust/issues/30498", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/30498/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/30498/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/30498/events", "html_url": "https://github.com/rust-lang/rust/issues/30498", "id": 123168531, "node_id": "MDU6SXNzdWUxMjMxNjg1MzE=", "number": 30498, "title": "Const fn causes ICE in a pattern", "user": {"login": "mitaa", "id": 6785936, "node_id": "MDQ6VXNlcjY3ODU5MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/6785936?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mitaa", "html_url": "https://github.com/mitaa", "followers_url": "https://api.github.com/users/mitaa/followers", "following_url": "https://api.github.com/users/mitaa/following{/other_user}", "gists_url": "https://api.github.com/users/mitaa/gists{/gist_id}", "starred_url": "https://api.github.com/users/mitaa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mitaa/subscriptions", "organizations_url": "https://api.github.com/users/mitaa/orgs", "repos_url": "https://api.github.com/users/mitaa/repos", "events_url": "https://api.github.com/users/mitaa/events{/privacy}", "received_events_url": "https://api.github.com/users/mitaa/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2015-12-20T15:52:27Z", "updated_at": "2017-01-26T16:44:41Z", "closed_at": "2017-01-26T16:44:41Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "``` rust\n#![feature(const_fn)]\n\nenum Cake {\n    BlackForest,\n    Marmor,\n}\nuse Cake::*;\n\nstruct Small { _cake: Cake }\n\nconst fn construct() -> Small {\n    Small { _cake: BlackForest }\n}\n\nconst QUX: Small = construct();\n\nfn main() {\n    let cake = Small { _cake: Marmor };\n    if let QUX = cake {\n        println!(\"hi\")\n    }\n}\n```\n\n```\nerror: internal compiler error: only scalars, byte strings, and strings supported in compare_values\nnote: the compiler unexpectedly panicked. this is a bug.\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports\nthread 'rustc' panicked at 'Box<Any>', ../src/libsyntax/errors/mod.rs:230\n```\n## Meta\n\n```\nrustc 1.7.0-nightly (abf60b20a 2015-12-19)\nbinary: rustc\ncommit-hash: abf60b20aa0edcae6d206905b1a1129e86dc60b3\ncommit-date: 2015-12-19\nhost: x86_64-unknown-linux-gnu\nrelease: 1.7.0-nightly\n```\n\n```\nstack backtrace:\n   1:     0x7fc63edd0120 - sys::backtrace::tracing::imp::write::hf9030d61a11d8d3blbu\n   2:     0x7fc63edd6cb5 - panicking::log_panic::_<closure>::closure.42192\n   3:     0x7fc63edd6777 - panicking::log_panic::hd82e413a56acc32atiy\n   4:     0x7fc63ed9fac3 - sys_common::unwind::begin_unwind_inner::hd2f1a07ef27270d3U3s\n   5:     0x7fc63ae58e17 - sys_common::unwind::begin_unwind::begin_unwind::h6110013839699060047\n   6:     0x7fc63ae591d4 - errors::Handler::bug::hcb3e2a9dc0333ba0e0c\n   7:     0x7fc63c29142c - session::Session::bug::h5a402f4570e18e0eeqr\n   8:     0x7fc63d8430d2 - trans::_match::compile_submatch_continue::h9c2c8168f652dea92WK\n   9:     0x7fc63d83f606 - trans::_match::compile_submatch::hf4cae9fe6ea35a93qRK\n  10:     0x7fc63d846d50 - trans::_match::trans_match_inner::h1788cd4926dfab85ArL\n  11:     0x7fc63d80cc6f - trans::expr::trans_rvalue_dps_unadjusted::h4ee72b142ac5fe95DYC\n  12:     0x7fc63d774cd4 - trans::expr::trans_into::he4d8826b74cc42c9WPB\n  13:     0x7fc63d7713a9 - trans::controlflow::trans_block::h7073c29b127a8c28sBw\n  14:     0x7fc63d76d767 - trans::base::trans_closure::hf17d5d0a75363f13gQi\n  15:     0x7fc63d7719fc - trans::base::trans_fn::haded894acc3f44b42Zi\n  16:     0x7fc63d775f1f - trans::base::trans_item::h3cafb15ccac4f8392nj\n  17:     0x7fc63d781ed4 - trans::base::trans_crate::hab4d0752deffb07dP7j\n  18:     0x7fc63f33e1b1 - driver::phase_4_translate_to_llvm::hccca468990347005uTa\n  19:     0x7fc63f338056 - driver::phase_3_run_analysis_passes::_<closure>::closure.26228\n  20:     0x7fc63f315d85 - middle::ty::context::ctxt<'tcx>::create_and_enter::create_and_enter::h4958027422858376580\n  21:     0x7fc63f3116a1 - driver::phase_3_run_analysis_passes::h17741196452814400998\n  22:     0x7fc63f2e61e9 - driver::compile_input::hd8ca37915eaece70jca\n  23:     0x7fc63f2d83fb - run_compiler::h9f2bf0f8895bda525wc\n  24:     0x7fc63f2d51b6 - sys_common::unwind::try::try_fn::try_fn::h7740908533083128233\n  25:     0x7fc63edcddb8 - __rust_try\n  26:     0x7fc63edc55bb - sys_common::unwind::try::inner_try::h8f6f7923052e318bs0s\n  27:     0x7fc63f2d5510 - boxed::F.FnBox<A>::call_box::call_box::h10636691886234944816\n  28:     0x7fc63edd51c3 - sys::thread::Thread::new::thread_start::h17cd49b420211db4Gkx\n  29:     0x7fc637b06554 - start_thread\n  30:     0x7fc63ea59b9c - __clone\n  31:                0x0 - <unknown>\n```\n", "closed_by": {"login": "steveklabnik", "id": 27786, "node_id": "MDQ6VXNlcjI3Nzg2", "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/steveklabnik", "html_url": "https://github.com/steveklabnik", "followers_url": "https://api.github.com/users/steveklabnik/followers", "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}", "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}", "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions", "organizations_url": "https://api.github.com/users/steveklabnik/orgs", "repos_url": "https://api.github.com/users/steveklabnik/repos", "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}", "received_events_url": "https://api.github.com/users/steveklabnik/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/30498/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/30498/timeline", "performed_via_github_app": null, "state_reason": "completed"}