{"url": "https://api.github.com/repos/rust-lang/rust/issues/76108", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/76108/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/76108/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/76108/events", "html_url": "https://github.com/rust-lang/rust/issues/76108", "id": 688726324, "node_id": "MDU6SXNzdWU2ODg3MjYzMjQ=", "number": 76108, "title": "recursion limit reached while expanding `$crate::format_args_nl!`", "user": {"login": "tanguc", "id": 6960101, "node_id": "MDQ6VXNlcjY5NjAxMDE=", "avatar_url": "https://avatars.githubusercontent.com/u/6960101?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanguc", "html_url": "https://github.com/tanguc", "followers_url": "https://api.github.com/users/tanguc/followers", "following_url": "https://api.github.com/users/tanguc/following{/other_user}", "gists_url": "https://api.github.com/users/tanguc/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanguc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanguc/subscriptions", "organizations_url": "https://api.github.com/users/tanguc/orgs", "repos_url": "https://api.github.com/users/tanguc/repos", "events_url": "https://api.github.com/users/tanguc/events{/privacy}", "received_events_url": "https://api.github.com/users/tanguc/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}, {"id": 1359848690, "node_id": "MDU6TGFiZWwxMzU5ODQ4Njkw", "url": "https://api.github.com/repos/rust-lang/rust/labels/E-needs-mcve", "name": "E-needs-mcve", "color": "02e10c", "default": false, "description": "Call for participation: This issue needs a Minimal Complete and Verifiable Example"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-08-30T14:12:49Z", "updated_at": "2020-09-26T17:58:47Z", "closed_at": "2020-09-26T17:58:47Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!--\r\nThank you for filing a bug report! \ud83d\udc1b Please provide a short summary of the bug,\r\nalong with any information you feel relevant to replicating the bug.\r\n-->\r\nHello,\r\n\r\nThe code (part of a private repository):\r\n\r\nhttps://play.rust-lang.org/?version=stable&mode=debug&edition=2018&gist=2745c1b4ed912d408e7eeb09249754f3\r\n\r\nThe error : \r\n\r\n```rs\r\nerror: recursion limit reached while expanding `$crate::format_args_nl!`\r\n  --> src/upstream_proto.rs:17:9\r\n   |\r\n17 |         debug!(\"Creating the folder to store generated proto files\");\r\n   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n   |\r\n   = help: consider adding a `#![recursion_limit=\"256\"]` attribute to your crate (`persistent_marking_lb`)\r\n   = note: this error originates in a macro (in Nightly builds, run with -Z macro-backtrace for more info)\r\n\r\nerror: aborting due to previous error\r\n\r\nerror: could not compile `persistent_marking_lb`.\r\n\r\nTo learn more, run the command again with --verbose.\r\n```\r\n\r\nI expected to not have recursion types/macro issues when printing/logging the code from lines \r\n```rs\r\n        println!(\"Creating the folder to store generated proto files\");\r\n```\r\n(line 17)\r\n\r\nThese are variants of the same issue which I've also tried and which don't work as well:\r\n\r\n```rs\r\n        println!(\r\n            \"Creating the folder to store generated proto files\",\r\n            \"OUT_DIR\"\r\n        );\r\n```\r\n\r\n```rs\r\n        info!(\r\n            \"Creating the folder {} to store generated proto files\",\r\n            \"OUT_DIR\"\r\n        );\r\n```\r\n\r\n```rs\r\n        info!(\r\n            \"Creating the folder [{}] to store generated proto files\",\r\n            \"OUT_DIR\"\r\n        );\r\n```\r\n\r\n```rs\r\n        info!(\r\n            \"Creating the folder [{}] to store generated proto files\",\r\n            generated_folder.to_str()\r\n        );\r\n``` \r\n\r\n```rs\r\n        info!(\r\n            \"Creating the folder [{}] to store generated proto files\",\r\n            generated_folder.clone().display().to_string()\r\n        );\r\n``` \r\n```rs\r\n        debug!(\r\n            \"Creating the folder [{}] to store generated proto files\",\r\n            generated_folder.clone().display().to_string()\r\n        );\r\n``` \r\n\r\n\r\nAfter some investigations:\r\n\r\nI've tried with \r\n\r\n```rs\r\n#![recursion_limit = \"12256\"]\r\n``` \r\nSame result, only the time is longer before the message.\r\n\r\nI've also tried to get into `https://github.com/rust-lang/rust/blob/668ef72f4429059240ee361a2f0f748558a5326f/src/librustc_expand/expand.rs` but it looks like I dont have enough knowledge and skills to figure out where it's coming from...\r\n\r\n### Meta\r\nI've tried on both compilers\r\n\r\n```\r\n\u279c  PersistentMarkingLB git:(master) \u2717 rustup default stable-x86_64-apple-darwin\r\ninfo: using existing install for 'stable-x86_64-apple-darwin'\r\ninfo: default toolchain set to 'stable-x86_64-apple-darwin'\r\n\r\n  stable-x86_64-apple-darwin unchanged - rustc 1.46.0 (04488afe3 2020-08-24)\r\n\r\n\u279c  PersistentMarkingLB git:(master) \u2717 rustup default nightly-x86_64-apple-darwin\r\ninfo: using existing install for 'nightly-x86_64-apple-darwin'\r\ninfo: default toolchain set to 'nightly-x86_64-apple-darwin'\r\n\r\n  nightly-x86_64-apple-darwin unchanged - rustc 1.48.0-nightly (d006f5734 2020-08-28)\r\n\r\n```\r\n\r\nMy crates deps are:\r\n\r\n```\r\n[dependencies]\r\nasync-stream = \"0.2.1\"\r\nasync-trait = \"0.1.30\"\r\nenclose = \"1.1.8\"\r\nfutures = \"0.3.4\"\r\nfutures-core = \"0.3.4\"\r\nfutures-util = \"0.3.4\"\r\nlog = \"0.4.8\"\r\npretty_env_logger = \"0.4.0\"\r\nprost = \"0.6\"\r\ntokio = {version = \"0.2.13\", features = [\"sync\", \"macros\", \"net\", \"tcp\", \"stream\", \"rt-threaded\", \"time\"]}\r\ntokio-util = {version = \"0.3.0\", features = [\"codec\"]}\r\ntonic = {version = \"0.2.0\"}\r\ntonic-build = \"0.2\"\r\nuuid = {version = \"0.8.1\", features = [\"v4\"]}\r\n```\r\n<!--\r\nInclude a backtrace in the code block by setting `RUST_BACKTRACE=1` in your\r\nenvironment. E.g. `RUST_BACKTRACE=1 cargo build`.\r\n-->\r\n<details><summary>Backtrace</summary>\r\n<p>\r\n\r\n```\r\nerror: recursion limit reached while expanding `$crate::format_args_nl!`\r\n  --> src/upstream_proto.rs:17:9\r\n   |\r\n17 |         println!(\"Creating the folder to store generated proto files\");\r\n   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n   |\r\n   = help: consider adding a `#![recursion_limit=\"256\"]` attribute to your crate (`persistent_marking_lb`)\r\n   = note: this error originates in a macro (in Nightly builds, run with -Z macro-backtrace for more info)\r\n\r\nerror: aborting due to previous error\r\n\r\nerror: could not compile `persistent_marking_lb`.\r\n\r\nCaused by:\r\n  process didn't exit successfully: `rustc --crate-name persistent_marking_lb --edition=2018 src/main.rs --error-format=json --json=diagnostic-rendered-ansi --crate-type bin --emit=dep-info,link -Cembed-bitcode=no -C debuginfo=2 -C metadata=db2fc4915294f8dc --out-dir /Users/sergentanguc/Projects/PersistentMarkingLB/target/debug/deps -C incremental=/Users/sergentanguc/Projects/PersistentMarkingLB/target/debug/incremental -L dependency=/Users/sergentanguc/Projects/PersistentMarkingLB/target/debug/deps --extern async_stream=/Users/sergentanguc/Projects/PersistentMarkingLB/target/debug/deps/libasync_stream-9c373c2e96e01bc3.rlib --extern async_trait=/Users/sergentanguc/Projects/PersistentMarkingLB/target/debug/deps/libasync_trait-747b116bb59c2d9d.dylib --extern enclose=/Users/sergentanguc/Projects/PersistentMarkingLB/target/debug/deps/libenclose-03f0feb960838fc4.rlib --extern futures=/Users/sergentanguc/Projects/PersistentMarkingLB/target/debug/deps/libfutures-330ac0accc3fadb3.rlib --extern futures_core=/Users/sergentanguc/Projects/PersistentMarkingLB/target/debug/deps/libfutures_core-011e2346fee4b7d9.rlib --extern futures_util=/Users/sergentanguc/Projects/PersistentMarkingLB/target/debug/deps/libfutures_util-670031931402736b.rlib --extern log=/Users/sergentanguc/Projects/PersistentMarkingLB/target/debug/deps/liblog-2afe8b2d9db6685d.rlib --extern pretty_env_logger=/Users/sergentanguc/Projects/PersistentMarkingLB/target/debug/deps/libpretty_env_logger-1ea9fae27750f982.rlib --extern prost=/Users/sergentanguc/Projects/PersistentMarkingLB/target/debug/deps/libprost-05e5486092a00f35.rlib --extern tokio=/Users/sergentanguc/Projects/PersistentMarkingLB/target/debug/deps/libtokio-5435c7e979070406.rlib --extern tokio_util=/Users/sergentanguc/Projects/PersistentMarkingLB/target/debug/deps/libtokio_util-331a22ca76fb7796.rlib --extern tonic=/Users/sergentanguc/Projects/PersistentMarkingLB/target/debug/deps/libtonic-24ed0df4631f07d4.rlib --extern tonic_build=/Users/sergentanguc/Projects/PersistentMarkingLB/target/debug/deps/libtonic_build-9bb7f0ba1c3cb196.rlib --extern uuid=/Users/sergentanguc/Projects/PersistentMarkingLB/target/debug/deps/libuuid-2fac909ce1d36b5a.rlib` (exit code: 1)\r\n```\r\n\r\n</p>\r\n</details>\r\n", "closed_by": {"login": "tanguc", "id": 6960101, "node_id": "MDQ6VXNlcjY5NjAxMDE=", "avatar_url": "https://avatars.githubusercontent.com/u/6960101?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanguc", "html_url": "https://github.com/tanguc", "followers_url": "https://api.github.com/users/tanguc/followers", "following_url": "https://api.github.com/users/tanguc/following{/other_user}", "gists_url": "https://api.github.com/users/tanguc/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanguc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanguc/subscriptions", "organizations_url": "https://api.github.com/users/tanguc/orgs", "repos_url": "https://api.github.com/users/tanguc/repos", "events_url": "https://api.github.com/users/tanguc/events{/privacy}", "received_events_url": "https://api.github.com/users/tanguc/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/76108/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/76108/timeline", "performed_via_github_app": null, "state_reason": "completed"}