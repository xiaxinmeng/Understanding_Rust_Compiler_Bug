{"url": "https://api.github.com/repos/rust-lang/rust/issues/34620", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/34620/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/34620/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/34620/events", "html_url": "https://github.com/rust-lang/rust/issues/34620", "id": 163540948, "node_id": "MDU6SXNzdWUxNjM1NDA5NDg=", "number": 34620, "title": "edge-case in type inference for arithmetic expressions", "user": {"login": "swiftcoder", "id": 4706210, "node_id": "MDQ6VXNlcjQ3MDYyMTA=", "avatar_url": "https://avatars.githubusercontent.com/u/4706210?v=4", "gravatar_id": "", "url": "https://api.github.com/users/swiftcoder", "html_url": "https://github.com/swiftcoder", "followers_url": "https://api.github.com/users/swiftcoder/followers", "following_url": "https://api.github.com/users/swiftcoder/following{/other_user}", "gists_url": "https://api.github.com/users/swiftcoder/gists{/gist_id}", "starred_url": "https://api.github.com/users/swiftcoder/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/swiftcoder/subscriptions", "organizations_url": "https://api.github.com/users/swiftcoder/orgs", "repos_url": "https://api.github.com/users/swiftcoder/repos", "events_url": "https://api.github.com/users/swiftcoder/events{/privacy}", "received_events_url": "https://api.github.com/users/swiftcoder/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2016-07-03T00:17:35Z", "updated_at": "2016-07-03T08:50:47Z", "closed_at": "2016-07-03T08:50:47Z", "author_association": "NONE", "active_lock_reason": null, "body": "Arithmetic expressions trailing a conditional expression are not accepted as the result statement for a block.\n\nFor example, the following function compiles fine:\n\n``` rust\nfn edge_case() -> u32 {\n    60 * if 1 > 2 {\n        1\n    } else {\n        2\n    }\n}\n```\n\nbut the next function fails, even though they appear semantically equivalent:\n\n``` rust\nfn edge_case() -> u32 {\n    if 1 > 2 {\n        1\n    } else {\n        2\n    } * 60\n}\n```\n\nThe errors in this case are:\n\n``` bash\nsrc/main.rs:15:9: 15:10 error: mismatched types:\n expected `()`,\n    found `_`\n(expected (),\n    found integral variable) [E0308]\nsrc/main.rs:15         1\n                       ^\nsrc/main.rs:15:9: 15:10 help: run `rustc --explain E0308` to see a detailed explanation\nsrc/main.rs:17:9: 17:10 error: mismatched types:\n expected `()`,\n    found `_`\n(expected (),\n    found integral variable) [E0308]\nsrc/main.rs:17         2\n                       ^\nsrc/main.rs:17:9: 17:10 help: run `rustc --explain E0308` to see a detailed explanation\nsrc/main.rs:18:7: 18:11 error: type `_` cannot be dereferenced\nsrc/main.rs:18     } * 60\n                     ^~~~\nerror: aborting due to 3 previous errors\n```\n\nHowever, if I assign the expression to a variable, inference once again succeeds:\n\n``` rust\nfn edge_case() -> u32 {\n    let n = if 1 > 2 {\n        1\n    } else {\n        2\n    } * 60;\n    n\n}\n```\n\nAny idea what is up with this edge case?\n", "closed_by": {"login": "arielb1", "id": 1830974, "node_id": "MDQ6VXNlcjE4MzA5NzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1830974?v=4", "gravatar_id": "", "url": "https://api.github.com/users/arielb1", "html_url": "https://github.com/arielb1", "followers_url": "https://api.github.com/users/arielb1/followers", "following_url": "https://api.github.com/users/arielb1/following{/other_user}", "gists_url": "https://api.github.com/users/arielb1/gists{/gist_id}", "starred_url": "https://api.github.com/users/arielb1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/arielb1/subscriptions", "organizations_url": "https://api.github.com/users/arielb1/orgs", "repos_url": "https://api.github.com/users/arielb1/repos", "events_url": "https://api.github.com/users/arielb1/events{/privacy}", "received_events_url": "https://api.github.com/users/arielb1/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/34620/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/34620/timeline", "performed_via_github_app": null, "state_reason": "completed"}