{"url": "https://api.github.com/repos/rust-lang/rust/issues/75263", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/75263/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/75263/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/75263/events", "html_url": "https://github.com/rust-lang/rust/issues/75263", "id": 675165870, "node_id": "MDU6SXNzdWU2NzUxNjU4NzA=", "number": 75263, "title": "Source file names are included into a release binary even if abort upon panic is enabled", "user": {"login": "dmitry-zakablukov", "id": 2607265, "node_id": "MDQ6VXNlcjI2MDcyNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/2607265?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dmitry-zakablukov", "html_url": "https://github.com/dmitry-zakablukov", "followers_url": "https://api.github.com/users/dmitry-zakablukov/followers", "following_url": "https://api.github.com/users/dmitry-zakablukov/following{/other_user}", "gists_url": "https://api.github.com/users/dmitry-zakablukov/gists{/gist_id}", "starred_url": "https://api.github.com/users/dmitry-zakablukov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dmitry-zakablukov/subscriptions", "organizations_url": "https://api.github.com/users/dmitry-zakablukov/orgs", "repos_url": "https://api.github.com/users/dmitry-zakablukov/repos", "events_url": "https://api.github.com/users/dmitry-zakablukov/events{/privacy}", "received_events_url": "https://api.github.com/users/dmitry-zakablukov/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 60344715, "node_id": "MDU6TGFiZWw2MDM0NDcxNQ==", "url": "https://api.github.com/repos/rust-lang/rust/labels/P-medium", "name": "P-medium", "color": "eb6420", "default": false, "description": "Medium priority"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 1049491442, "node_id": "MDU6TGFiZWwxMDQ5NDkxNDQy", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-heavy", "name": "I-heavy", "color": "e10c02", "default": false, "description": "Problems and improvements with respect to binary size of generated code."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 32, "created_at": "2020-08-07T17:33:03Z", "updated_at": "2021-05-03T16:31:10Z", "closed_at": "2021-04-12T13:19:38Z", "author_association": "NONE", "active_lock_reason": null, "body": "Good day!\r\n\r\nI have found, that if a library contains code that may panic (slices, unwraps, etc.), then a filename of such source file will be included in a binary. Release build doesn't change this behavior, neither debug symbols stripping do.\r\n\r\nI have tried to turn on \"abort\" for panic in release profile. Even though this resulted in a smaller binary size, it doesn't wipe out source file names from the binary.\r\n\r\nHere is a small reproducible code.\r\n\r\n```\r\n// \"engine\" library, file lib.rs\r\n\r\npub fn print_message() {\r\n    let mut input = String::new();\r\n    std::io::stdin().read_line(&mut input).unwrap();\r\n}\r\n``` \r\n\r\n```\r\n// \"main\" program, file main.rs\r\n\r\nfn main() {\r\n    engine::print_message();\r\n}\r\n```\r\n\r\n```\r\n// main Cargo.toml\r\n\r\n[package]\r\nname = \"symbols_test\"\r\nversion = \"0.1.0\"\r\nauthors = [\"Name Soname <test@mail.com>\"]\r\nedition = \"2018\"\r\n\r\n# See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html\r\n\r\n[profile.release]\r\npanic = \"abort\"\r\n\r\n[dependencies]\r\nengine = { path = \"../engine\" }\r\n```\r\n\r\nIf I build this example with a command `cargo build --release` on Windows, then a `symbols_test.exe` will contain a string `engine\\src\\lib.rs`.\r\n\r\n==============================\r\n\r\nSo what should I do, if I want to distribute my program to the clients and do not want them to find out file names of my source files (which are a business secret)? How to strip source file names from the binary?\r\n\r\nUPD: How to reproduce the problem on Windows:\r\n```\r\ngit clone https://github.com/dmitry-zakablukov/rust-lang-issue-75263.git\r\ncd rust-lang-issue-75263\\symbols_test\r\ncargo build --release\r\nstrings target\\release\\symbols_test.exe | grep \"engine\\src\"\r\n```\r\nOn *nix systems change slashes to '/' and remove '.exe' in the last command.", "closed_by": {"login": "jyn514", "id": 23638587, "node_id": "MDQ6VXNlcjIzNjM4NTg3", "avatar_url": "https://avatars.githubusercontent.com/u/23638587?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jyn514", "html_url": "https://github.com/jyn514", "followers_url": "https://api.github.com/users/jyn514/followers", "following_url": "https://api.github.com/users/jyn514/following{/other_user}", "gists_url": "https://api.github.com/users/jyn514/gists{/gist_id}", "starred_url": "https://api.github.com/users/jyn514/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jyn514/subscriptions", "organizations_url": "https://api.github.com/users/jyn514/orgs", "repos_url": "https://api.github.com/users/jyn514/repos", "events_url": "https://api.github.com/users/jyn514/events{/privacy}", "received_events_url": "https://api.github.com/users/jyn514/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/75263/reactions", "total_count": 12, "+1": 12, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/75263/timeline", "performed_via_github_app": null, "state_reason": "completed"}