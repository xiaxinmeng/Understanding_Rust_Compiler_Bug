{"url": "https://api.github.com/repos/rust-lang/rust/issues/43057", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/43057/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/43057/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/43057/events", "html_url": "https://github.com/rust-lang/rust/issues/43057", "id": 240487969, "node_id": "MDU6SXNzdWUyNDA0ODc5Njk=", "number": 43057, "title": "My code fails to build with \u201eunexpected end of macro invocation\u201c since nightly 2017-07-02", "user": {"login": "vorner", "id": 11783500, "node_id": "MDQ6VXNlcjExNzgzNTAw", "avatar_url": "https://avatars.githubusercontent.com/u/11783500?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vorner", "html_url": "https://github.com/vorner", "followers_url": "https://api.github.com/users/vorner/followers", "following_url": "https://api.github.com/users/vorner/following{/other_user}", "gists_url": "https://api.github.com/users/vorner/gists{/gist_id}", "starred_url": "https://api.github.com/users/vorner/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vorner/subscriptions", "organizations_url": "https://api.github.com/users/vorner/orgs", "repos_url": "https://api.github.com/users/vorner/repos", "events_url": "https://api.github.com/users/vorner/events{/privacy}", "received_events_url": "https://api.github.com/users/vorner/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 235791, "node_id": "MDU6TGFiZWwyMzU3OTE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-diagnostics", "name": "A-diagnostics", "color": "f7e101", "default": false, "description": "Area: Messages for errors, warnings, and lints"}, {"id": 132910982, "node_id": "MDU6TGFiZWwxMzI5MTA5ODI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-macros", "name": "A-macros", "color": "f7e101", "default": false, "description": "Area: All kinds of macros (custom derive, macro_rules!, proc macros, ..)"}, {"id": 211668062, "node_id": "MDU6TGFiZWwyMTE2NjgwNjI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-libs-api", "name": "T-libs-api", "color": "bfd4f2", "default": false, "description": "Relevant to the library API team, which will review and decide on the PR/issue."}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 262252628, "node_id": "MDU6TGFiZWwyNjIyNTI2Mjg=", "url": "https://api.github.com/repos/rust-lang/rust/labels/regression-from-stable-to-beta", "name": "regression-from-stable-to-beta", "color": "e4008a", "default": false, "description": "Performance or correctness regression from stable to beta."}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 37, "created_at": "2017-07-04T19:40:41Z", "updated_at": "2017-08-10T06:28:23Z", "closed_at": "2017-08-10T06:28:23Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Hello\r\n\r\nI have this code: https://gitlab.labs.nic.cz/turris/pakon-aggregator (unfortunately, I don't have a minimal code example yet). It fails with `rustc 1.20.0-nightly (067971139 2017-07-02)` (for some reason this is the version I get if I run `rustup default nightly-2017-07-03`, it seems to be one day off) and newer, but passes with older versions of nighly as well as stable and beta.\r\n\r\nThe error I get is:\r\n\r\n```\r\nerror: unexpected end of macro invocation\r\n   --> src/keeper/column.rs:269:1\r\n    |\r\n269 | / column! {\r\n270 | |     /// Identifier of an address inside an endpoint.\r\n271 | |     ///\r\n272 | |     /// This is usually used to specify aggregation by a value in queries.\r\n...   |\r\n357 | |     name Port u16;\r\n358 | | }\r\n    | |_^ in this macro invocation\r\n    |\r\n    = note: this error originates in a macro outside of the current crate\r\n```\r\n\r\nThis is actually [my own macro](https://gitlab.labs.nic.cz/turris/pakon-aggregator/blob/master/src/keeper/column.rs#L55), so the \u201eoriginates in a macro outside of the current crate\u201c part is wrong. Also, renaming the macro makes it compile again. This leads me to think something (the compiler) brought in a colliding macro with the same name.\r\n\r\nIs my theory about the colliding macro true? Can this killing of my poor innocent macro be prevented somehow? Should local macros have precedence? Or, at least, should I get a better error message, like complaining when I *define* the macro, not when I *use* it? This makes me think that if I had the bad luck of having a same-name macro with the same invocation syntax, it would silently expand the wrong one.\r\n\r\n# Exact version\r\n\r\n```\r\n$ rustc --version --verbose\r\nrustc 1.20.0-nightly (067971139 2017-07-02)\r\nbinary: rustc\r\ncommit-hash: 0679711398bef656699e1ff6b004ecccbdb67284\r\ncommit-date: 2017-07-02\r\nhost: x86_64-unknown-linux-gnu\r\nrelease: 1.20.0-nightly\r\nLLVM version: 4.0\r\n```", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/43057/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/43057/timeline", "performed_via_github_app": null, "state_reason": "completed"}