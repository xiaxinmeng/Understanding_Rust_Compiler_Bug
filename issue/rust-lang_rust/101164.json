{"url": "https://api.github.com/repos/rust-lang/rust/issues/101164", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/101164/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/101164/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/101164/events", "html_url": "https://github.com/rust-lang/rust/issues/101164", "id": 1354690791, "node_id": "I_kwDOAAsO6M5QvvDn", "number": 101164, "title": "dead_code warning on an used module.", "user": {"login": "Aex12", "id": 4013199, "node_id": "MDQ6VXNlcjQwMTMxOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/4013199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Aex12", "html_url": "https://github.com/Aex12", "followers_url": "https://api.github.com/users/Aex12/followers", "following_url": "https://api.github.com/users/Aex12/following{/other_user}", "gists_url": "https://api.github.com/users/Aex12/gists{/gist_id}", "starred_url": "https://api.github.com/users/Aex12/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Aex12/subscriptions", "organizations_url": "https://api.github.com/users/Aex12/orgs", "repos_url": "https://api.github.com/users/Aex12/repos", "events_url": "https://api.github.com/users/Aex12/events{/privacy}", "received_events_url": "https://api.github.com/users/Aex12/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 235137, "node_id": "MDU6TGFiZWwyMzUxMzc=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-lint", "name": "A-lint", "color": "f7e101", "default": false, "description": "Area: Lints (warnings about flaws in source code) such as unused_mut."}, {"id": 235791, "node_id": "MDU6TGFiZWwyMzU3OTE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-diagnostics", "name": "A-diagnostics", "color": "f7e101", "default": false, "description": "Area: Messages for errors, warnings, and lints"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2022-08-29T18:09:09Z", "updated_at": "2023-03-14T11:14:55Z", "closed_at": null, "author_association": "NONE", "active_lock_reason": null, "body": "<!--\r\nThank you for filing a bug report! \ud83d\udc1b Please provide a short summary of the bug,\r\nalong with any information you feel relevant to replicating the bug.\r\n\r\nIf you cannot produce a minimal reproduction case (something that would work in\r\nisolation), please provide the steps or even link to a repository that causes\r\nthe problematic output to occur.\r\n-->\r\nI've got recently a warning about unused_code when the code was in fact being used. This warning was reported both by my IDE and by the cargo run / build commands.\r\n\r\nThe warning was caused because I was using \"mod some_module\" in both main.rs and lib.rs, but I was importing it on my main.rs through lib.rs instead.\r\n\r\nI think the compiler should throw the warning on the \"mod some_module\" statement in main.rs instead of reporting it at some_module.rs\r\n\r\nThis repo contains a minimal reproducible error: https://github.com/Aex12/rust_error_unused_code\r\n\r\n```rust\r\n// main.rs\r\nmod some_module;\r\n\r\nuse my_crate::some_module::some_function;\r\n\r\nfn main() {\r\n    let input = \"lorem ipsum\";\r\n    let output = some_function(input);\r\n    println!(\"{}\", output);\r\n}\r\n\r\n// lib.rs\r\npub mod some_module;\r\n\r\n// some_module.rs\r\npub fn some_function (input: &str) -> &str {\r\n    input\r\n}\r\n```\r\n\r\nThe current output is:\r\n\r\n```\r\nwarning: function `some_function` is never used\r\n --> src/some_module.rs:2:8\r\n  |\r\n2 | pub fn some_function (input: &str) -> &str {\r\n  |        ^^^^^^^^^^^^^\r\n  |\r\n  = note: `#[warn(dead_code)]` on by default\r\n\r\nwarning: `error_unused_code` (bin \"error_unused_code\") generated 1 warning\r\n```\r\n\r\n<!-- The following is not always necessary. -->\r\nIdeally the output should look like:\r\n\r\n```\r\nwarning: mod statement `mod some_module` is never used\r\n --> src/main.rs:1:1\r\n  |\r\n2 | mod some_module\r\n  |     ^^^^^^^^^^^\r\n```\r\n\r\nOr maybe something like this:\r\n```\r\nwarning: mod statement `mod some_module` is already declared on lib.rs:1:1\r\n --> src/main.rs:1:1\r\n  |\r\n2 | mod some_module\r\n  |     ^^^^^^^^^^^\r\n```\r\n\r\n<!--\r\nIf the problem is not self-explanatory, please provide a rationale for the\r\nchange.\r\n-->\r\n\r\n<!--\r\nIf dramatically different output is caused by small changes, consider also\r\nadding them here.\r\n\r\nIf you're using the stable version of the compiler, you should also check if the\r\nbug also exists in the beta or nightly versions. The output might also be\r\ndifferent depending on the Edition.\r\n-->\r\n", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/101164/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/101164/timeline", "performed_via_github_app": null, "state_reason": null}