{"url": "https://api.github.com/repos/rust-lang/rust/issues/82687", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/82687/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/82687/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/82687/events", "html_url": "https://github.com/rust-lang/rust/issues/82687", "id": 819412871, "node_id": "MDU6SXNzdWU4MTk0MTI4NzE=", "number": 82687, "title": "Documentation of Iterator `flatten()` improvement", "user": {"login": "ralpha", "id": 2608639, "node_id": "MDQ6VXNlcjI2MDg2Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/2608639?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ralpha", "html_url": "https://github.com/ralpha", "followers_url": "https://api.github.com/users/ralpha/followers", "following_url": "https://api.github.com/users/ralpha/following{/other_user}", "gists_url": "https://api.github.com/users/ralpha/gists{/gist_id}", "starred_url": "https://api.github.com/users/ralpha/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ralpha/subscriptions", "organizations_url": "https://api.github.com/users/ralpha/orgs", "repos_url": "https://api.github.com/users/ralpha/repos", "events_url": "https://api.github.com/users/ralpha/events{/privacy}", "received_events_url": "https://api.github.com/users/ralpha/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 234902, "node_id": "MDU6TGFiZWwyMzQ5MDI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-enhancement", "name": "C-enhancement", "color": "f5f1fd", "default": false, "description": "Category: An issue proposing an enhancement or a PR with one."}, {"id": 211668062, "node_id": "MDU6TGFiZWwyMTE2NjgwNjI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-libs-api", "name": "T-libs-api", "color": "bfd4f2", "default": false, "description": "Relevant to the library API team, which will review and decide on the PR/issue."}, {"id": 431251592, "node_id": "MDU6TGFiZWw0MzEyNTE1OTI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-docs", "name": "A-docs", "color": "f7e101", "default": false, "description": "Area: documentation for any part of the project, including the compiler, standard library, and tools"}, {"id": 889209675, "node_id": "MDU6TGFiZWw4ODkyMDk2NzU=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-iterators", "name": "A-iterators", "color": "f7e101", "default": false, "description": "Area: Iterators"}], "state": "closed", "locked": false, "assignee": {"login": "HintringerFabian", "id": 79401071, "node_id": "MDQ6VXNlcjc5NDAxMDcx", "avatar_url": "https://avatars.githubusercontent.com/u/79401071?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HintringerFabian", "html_url": "https://github.com/HintringerFabian", "followers_url": "https://api.github.com/users/HintringerFabian/followers", "following_url": "https://api.github.com/users/HintringerFabian/following{/other_user}", "gists_url": "https://api.github.com/users/HintringerFabian/gists{/gist_id}", "starred_url": "https://api.github.com/users/HintringerFabian/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HintringerFabian/subscriptions", "organizations_url": "https://api.github.com/users/HintringerFabian/orgs", "repos_url": "https://api.github.com/users/HintringerFabian/repos", "events_url": "https://api.github.com/users/HintringerFabian/events{/privacy}", "received_events_url": "https://api.github.com/users/HintringerFabian/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "HintringerFabian", "id": 79401071, "node_id": "MDQ6VXNlcjc5NDAxMDcx", "avatar_url": "https://avatars.githubusercontent.com/u/79401071?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HintringerFabian", "html_url": "https://github.com/HintringerFabian", "followers_url": "https://api.github.com/users/HintringerFabian/followers", "following_url": "https://api.github.com/users/HintringerFabian/following{/other_user}", "gists_url": "https://api.github.com/users/HintringerFabian/gists{/gist_id}", "starred_url": "https://api.github.com/users/HintringerFabian/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HintringerFabian/subscriptions", "organizations_url": "https://api.github.com/users/HintringerFabian/orgs", "repos_url": "https://api.github.com/users/HintringerFabian/repos", "events_url": "https://api.github.com/users/HintringerFabian/events{/privacy}", "received_events_url": "https://api.github.com/users/HintringerFabian/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2021-03-01T23:39:38Z", "updated_at": "2023-01-10T06:21:59Z", "closed_at": "2023-01-10T06:21:59Z", "author_association": "NONE", "active_lock_reason": null, "body": "While linting my code I came across [`manual_flatten`](https://rust-lang.github.io/rust-clippy/master/index.html#manual_flatten) which was triggered in my code.\n\nThis suggests the change from:\n```rust\nfor n in x {\n    if let Some(n) = n {\n        // something here\n    }\n}\n```\nInto:\n```rust\nfor n in x.into_iter().flatten() {\n    // something here\n}\n```\nBoth are valid code with same result. \n\nBut the [rust docs on `flatten()`](https://doc.rust-lang.org/std/iter/trait.Iterator.html#method.flatten) does not state that this is expected behavior. Yes, this is stated [here](https://doc.rust-lang.org/std/option/enum.Option.html#method.flatten).\nBut this was not strait forward (in my opinion) to find. It took me writing a whole bug report and looking a bunch of thing up to figure this out. (and I'm not even new to Rust anymore)\n\nI would suggest adding some example code to make his explicit. Here is a suggestion:\n(after the [\"Mapping and then flattening: `<code>...</code>`\"](https://doc.rust-lang.org/std/iter/trait.Iterator.html#examples-22) section)\n> Flattening also works on other types like `Option` and `Result`:\n> ```rust\n> let students_in_seats = vec![Some(\"Hasan\"), Some(\"Sarah\"), None, Some(\"Tim\")];\n> let students_present: Vec<_> = students_in_seats.into_iter().flatten().collect();\n> assert_eq!(students_present, vec![\"Hasan\", \"Sarah\", \"Tim\"]);\n> ```\n(or something similar)\n\nThis makes both this behavior cleared, easier to find and exposes people to code like this so they are less surprised if clippy starts warning them.\n\nIt looks like this behavior might be more common in the future too.\nhttps://github.com/rust-lang/rust-clippy/issues/6061\nhttps://github.com/rust-lang/rust-clippy/issues/6676\n\n<!-- TRIAGEBOT_START -->\n\n<!-- TRIAGEBOT_ASSIGN_START -->\n\n<!-- TRIAGEBOT_ASSIGN_DATA_START$${\"user\":\"HintringerFabian\"}$$TRIAGEBOT_ASSIGN_DATA_END -->\n\n<!-- TRIAGEBOT_ASSIGN_END -->\n<!-- TRIAGEBOT_END -->", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/82687/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/82687/timeline", "performed_via_github_app": null, "state_reason": "completed"}