{"url": "https://api.github.com/repos/rust-lang/rust/issues/87323", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/87323/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/87323/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/87323/events", "html_url": "https://github.com/rust-lang/rust/issues/87323", "id": 949137702, "node_id": "MDU6SXNzdWU5NDkxMzc3MDI=", "number": 87323, "title": "`cargo test` does not report failures when a test exits the process", "user": {"login": "EverlastingBugstopper", "id": 9408157, "node_id": "MDQ6VXNlcjk0MDgxNTc=", "avatar_url": "https://avatars.githubusercontent.com/u/9408157?v=4", "gravatar_id": "", "url": "https://api.github.com/users/EverlastingBugstopper", "html_url": "https://github.com/EverlastingBugstopper", "followers_url": "https://api.github.com/users/EverlastingBugstopper/followers", "following_url": "https://api.github.com/users/EverlastingBugstopper/following{/other_user}", "gists_url": "https://api.github.com/users/EverlastingBugstopper/gists{/gist_id}", "starred_url": "https://api.github.com/users/EverlastingBugstopper/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/EverlastingBugstopper/subscriptions", "organizations_url": "https://api.github.com/users/EverlastingBugstopper/orgs", "repos_url": "https://api.github.com/users/EverlastingBugstopper/repos", "events_url": "https://api.github.com/users/EverlastingBugstopper/events{/privacy}", "received_events_url": "https://api.github.com/users/EverlastingBugstopper/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 630810559, "node_id": "MDU6TGFiZWw2MzA4MTA1NTk=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-libtest", "name": "A-libtest", "color": "f7e101", "default": false, "description": "Area: #[test] related"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2021-07-20T20:55:43Z", "updated_at": "2021-07-21T13:08:42Z", "closed_at": null, "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Thanks for filing a \ud83d\udc1b bug report \ud83d\ude04! -->\r\n\r\n**Problem**\r\nI'm running `cargo test` with tests that fail, and it exits with code 0 and does not gather and report errors.\r\n\r\n**Steps**\r\n<!-- The steps to reproduce the bug. -->\r\n1. `git clone https://github.com/apollographql/rover`\r\n2. `git checkout avery/repro-tests`\r\n3. Notice there is a test at the root crate that has a single call to `panic!(\"It fails\")`\r\n4. Run `cargo test`, you should notice the FAILED test only if you scroll up to look for it, the message at the end makes you think the tests pass.\r\n5. Run `echo $?` and see output 0\r\n\r\n**Possible Solution(s)**\r\nNo idea why this is happening and... it's quite alarming!\r\n\r\nIf I run the same tests through my IDE, it makes a call to `cargo test --package rover --lib -- test command::supergraph::config::tests::it_can_fail_a_test --exact --nocapture <` which _does_ fail properly! \r\n\r\n**Notes**\r\n\r\n```console\r\n$ cargo version\r\ncargo 1.53.0 (4369396ce 2021-04-27)\r\n$ rustc -V      \r\nrustc 1.53.0 (53cb7b09b 2021-06-17)\r\n$ rustup version\r\nrustup 1.24.3 (ce5817a94 2021-05-31)\r\ninfo: This is the version for the rustup toolchain manager, not the rustc compiler.\r\ninfo: The currently active `rustc` version is `rustc 1.53.0 (53cb7b09b 2021-06-17)`\r\n```\r\n\r\nThis seems to be a cross-platform bug, as our CI runner does not detect issues with any of the following targets:\r\n\r\n```\r\nx86_64-unknown-linux-musl,\r\nx86_64-unknown-linux-gnu,\r\nx86_64-pc-windows-msvc,\r\nx86_64-apple-darwin,\r\n```\r\n\r\nThis is a workspace using the 2018 edition, and seems to happen on test runs with both v1 and v2 of the resolver.  It also happens whether you're testing a single package with `-p`, the whole workspace with `--workspace`, or just `cargo test` by itself.\r\n\r\n\r\n", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/87323/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/87323/timeline", "performed_via_github_app": null, "state_reason": null}