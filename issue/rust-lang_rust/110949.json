{"url": "https://api.github.com/repos/rust-lang/rust/issues/110949", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/110949/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/110949/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/110949/events", "html_url": "https://github.com/rust-lang/rust/issues/110949", "id": 1688650848, "node_id": "I_kwDOAAsO6M5kpsRg", "number": 110949, "title": "Make `String` a diagnostic item", "user": {"login": "bluthej", "id": 29771403, "node_id": "MDQ6VXNlcjI5NzcxNDAz", "avatar_url": "https://avatars.githubusercontent.com/u/29771403?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bluthej", "html_url": "https://github.com/bluthej", "followers_url": "https://api.github.com/users/bluthej/followers", "following_url": "https://api.github.com/users/bluthej/following{/other_user}", "gists_url": "https://api.github.com/users/bluthej/gists{/gist_id}", "starred_url": "https://api.github.com/users/bluthej/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bluthej/subscriptions", "organizations_url": "https://api.github.com/users/bluthej/orgs", "repos_url": "https://api.github.com/users/bluthej/repos", "events_url": "https://api.github.com/users/bluthej/events{/privacy}", "received_events_url": "https://api.github.com/users/bluthej/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2023-04-28T14:23:20Z", "updated_at": "2023-04-28T16:15:07Z", "closed_at": "2023-04-28T16:15:07Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "## Proposal\r\n\r\nIt would be nice if `String` was a diagnostic item.\r\n\r\n## Background\r\n\r\nI [implemented](https://github.com/rust-lang/rust-clippy/pull/10528) the `clear_with_drain` Clippy lint for `Vec`s first, and then proposed to [extend](https://github.com/rust-lang/rust-clippy/pull/10614) that to 5 other container types including `String`s. However, in the process I realized that all my container types were diagnostic items except for `String`s.\r\n\r\nThis led me to find a false negative in `collection_is_never_read`, which was also trying to check for `String`s using [`is_type_diagnostic_item`](https://github.com/rust-lang/rust-clippy/blob/990bbdc2bee264291843497cebe59f307c2ed86f/clippy_utils/src/ty.rs#L378). The current workaround is to use the lang item for `String`, which means that this type gets a special treatment. I find this a little unfortunate and would like to be able to handle all these container types in the same way \ud83d\ude42 \r\n\r\n@llogiq suggested to add a `String` diagnostic item [here](https://github.com/rust-lang/rust-clippy/issues/10572#issuecomment-1500885352) so I thought I would open the issue!\r\n\r\nIronically, the `String` type was the one mentioned as an example in @Manishearth's original proposal #39131, and it was again suggested in [this comment](https://github.com/rust-lang/rust/pull/39116#issuecomment-273246162). But apparently nobody needed this diagnostic item that bad!\r\n\r\n## Pros and cons\r\n\r\nWhen working on Clippy lints, one expects the ability to check for such a prominent type using `is_type_diagnostic_item`, which can lead to false negatives (like I mentioned, even though this was also due to insufficient testing).\r\n\r\nThe only downside that I can think of is that there would be two different ways to check for the `String` type, so one can wonder which one one is supposed to use.", "closed_by": {"login": "bluthej", "id": 29771403, "node_id": "MDQ6VXNlcjI5NzcxNDAz", "avatar_url": "https://avatars.githubusercontent.com/u/29771403?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bluthej", "html_url": "https://github.com/bluthej", "followers_url": "https://api.github.com/users/bluthej/followers", "following_url": "https://api.github.com/users/bluthej/following{/other_user}", "gists_url": "https://api.github.com/users/bluthej/gists{/gist_id}", "starred_url": "https://api.github.com/users/bluthej/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bluthej/subscriptions", "organizations_url": "https://api.github.com/users/bluthej/orgs", "repos_url": "https://api.github.com/users/bluthej/repos", "events_url": "https://api.github.com/users/bluthej/events{/privacy}", "received_events_url": "https://api.github.com/users/bluthej/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/110949/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/110949/timeline", "performed_via_github_app": null, "state_reason": "not_planned"}