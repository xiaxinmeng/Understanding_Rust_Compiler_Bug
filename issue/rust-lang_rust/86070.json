{"url": "https://api.github.com/repos/rust-lang/rust/issues/86070", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/86070/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/86070/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/86070/events", "html_url": "https://github.com/rust-lang/rust/issues/86070", "id": 912919827, "node_id": "MDU6SXNzdWU5MTI5MTk4Mjc=", "number": 86070, "title": "Inconsistent (and wrong?) error span for \"temporary value dropped while borrowed\"", "user": {"login": "moxian", "id": 7831163, "node_id": "MDQ6VXNlcjc4MzExNjM=", "avatar_url": "https://avatars.githubusercontent.com/u/7831163?v=4", "gravatar_id": "", "url": "https://api.github.com/users/moxian", "html_url": "https://github.com/moxian", "followers_url": "https://api.github.com/users/moxian/followers", "following_url": "https://api.github.com/users/moxian/following{/other_user}", "gists_url": "https://api.github.com/users/moxian/gists{/gist_id}", "starred_url": "https://api.github.com/users/moxian/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/moxian/subscriptions", "organizations_url": "https://api.github.com/users/moxian/orgs", "repos_url": "https://api.github.com/users/moxian/repos", "events_url": "https://api.github.com/users/moxian/events{/privacy}", "received_events_url": "https://api.github.com/users/moxian/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 235791, "node_id": "MDU6TGFiZWwyMzU3OTE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-diagnostics", "name": "A-diagnostics", "color": "f7e101", "default": false, "description": "Area: Messages for errors, warnings, and lints"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-06-06T18:53:53Z", "updated_at": "2021-06-06T18:55:23Z", "closed_at": "2021-06-06T18:55:23Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Given the following code: https://play.rust-lang.org/?version=stable&mode=debug&edition=2018&gist=b1857f7e51c33ec306df96c329e17b26\r\n\r\n```rust\r\nstruct Foo{\r\n    a: String,\r\n    b: String,\r\n}\r\nfn use_the_strings(_: Vec<&&str>){}\r\n\r\nfn stuff(foo: Option<&Foo>){\r\n    let mut v: Vec<&&str> = vec![];\r\n    \r\n    if let Some(f) = foo{\r\n        v.push(&f.a.as_str());\r\n        v.push(&f.b.as_str());\r\n    }\r\n    \r\n    use_the_strings(v);\r\n}\r\n```\r\n\r\nThe current output is:\r\n\r\n```rust\r\n  Compiling playground v0.0.1 (/playground)\r\nerror[E0716]: temporary value dropped while borrowed\r\n  --> src/lib.rs:11:17\r\n   |\r\n11 |         v.push(&f.a.as_str());\r\n   |                 ^^^^^^^^^^^^ - temporary value is freed at the end of this statement\r\n   |                 |\r\n   |                 creates a temporary which is freed while still in use\r\n12 |         v.push(&f.b.as_str());\r\n   |         - borrow later used here\r\n   |\r\n   = note: consider using a `let` binding to create a longer lived value\r\n\r\nerror[E0716]: temporary value dropped while borrowed\r\n  --> src/lib.rs:12:17\r\n   |\r\n12 |         v.push(&f.b.as_str());\r\n   |                 ^^^^^^^^^^^^ - temporary value is freed at the end of this statement\r\n   |                 |\r\n   |                 creates a temporary which is freed while still in use\r\n...\r\n15 |     use_the_strings(v);\r\n   |                     - borrow later used here\r\n   |\r\n   = note: consider using a `let` binding to create a longer lived value\r\n\r\nerror: aborting due to 2 previous errors\r\n```\r\n\r\nIdeally the output should either point to line 15 in both cases (not to 12 in one and 15 in other), given that it's (seemingly) exactly the same problem in both cases. So:\r\n\r\n```rust\r\n  Compiling playground v0.0.1 (/playground)\r\nerror[E0716]: temporary value dropped while borrowed\r\n  --> src/lib.rs:11:17\r\n   |\r\n11 |         v.push(&f.a.as_str());\r\n   |                 ^^^^^^^^^^^^ - temporary value is freed at the end of this statement\r\n   |                 |\r\n   |                 creates a temporary which is freed while still in use\r\n...\r\n15 |     use_the_strings(v);\r\n   |                     - borrow later used here\r\n   |\r\n   = note: consider using a `let` binding to create a longer lived value\r\n\r\nerror[E0716]: temporary value dropped while borrowed\r\n  --> src/lib.rs:12:17\r\n   |\r\n12 |         v.push(&f.b.as_str());\r\n   |                 ^^^^^^^^^^^^ - temporary value is freed at the end of this statement\r\n   |                 |\r\n   |                 creates a temporary which is freed while still in use\r\n...\r\n15 |     use_the_strings(v);\r\n   |                     - borrow later used here\r\n   |\r\n   = note: consider using a `let` binding to create a longer lived value\r\n\r\nerror: aborting due to 2 previous errors\r\n```\r\n", "closed_by": {"login": "moxian", "id": 7831163, "node_id": "MDQ6VXNlcjc4MzExNjM=", "avatar_url": "https://avatars.githubusercontent.com/u/7831163?v=4", "gravatar_id": "", "url": "https://api.github.com/users/moxian", "html_url": "https://github.com/moxian", "followers_url": "https://api.github.com/users/moxian/followers", "following_url": "https://api.github.com/users/moxian/following{/other_user}", "gists_url": "https://api.github.com/users/moxian/gists{/gist_id}", "starred_url": "https://api.github.com/users/moxian/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/moxian/subscriptions", "organizations_url": "https://api.github.com/users/moxian/orgs", "repos_url": "https://api.github.com/users/moxian/repos", "events_url": "https://api.github.com/users/moxian/events{/privacy}", "received_events_url": "https://api.github.com/users/moxian/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/86070/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/86070/timeline", "performed_via_github_app": null, "state_reason": "completed"}