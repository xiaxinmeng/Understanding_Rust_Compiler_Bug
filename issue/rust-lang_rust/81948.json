{"url": "https://api.github.com/repos/rust-lang/rust/issues/81948", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/81948/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/81948/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/81948/events", "html_url": "https://github.com/rust-lang/rust/issues/81948", "id": 805096438, "node_id": "MDU6SXNzdWU4MDUwOTY0Mzg=", "number": 81948, "title": "[LLVM 11] link failure when using ASAN and cdylib together with LLD", "user": {"login": "kamulos", "id": 5168812, "node_id": "MDQ6VXNlcjUxNjg4MTI=", "avatar_url": "https://avatars.githubusercontent.com/u/5168812?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kamulos", "html_url": "https://github.com/kamulos", "followers_url": "https://api.github.com/users/kamulos/followers", "following_url": "https://api.github.com/users/kamulos/following{/other_user}", "gists_url": "https://api.github.com/users/kamulos/gists{/gist_id}", "starred_url": "https://api.github.com/users/kamulos/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kamulos/subscriptions", "organizations_url": "https://api.github.com/users/kamulos/orgs", "repos_url": "https://api.github.com/users/kamulos/repos", "events_url": "https://api.github.com/users/kamulos/events{/privacy}", "received_events_url": "https://api.github.com/users/kamulos/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2021-02-10T01:44:22Z", "updated_at": "2021-02-13T13:33:21Z", "closed_at": "2021-02-12T19:46:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "System: Arch Linux\r\nRust: rustc 1.52.0-nightly (0fc6756b4 2021-02-08)\r\nLinker: LLD 11.0.1 (compatible with GNU linkers)\r\n\r\n## Reproduction\r\nCreate a new library\r\n\r\nlib.rs:\r\n```\r\n#[derive(Debug)]\r\nenum A {\r\n    B,\r\n}\r\n```\r\n\r\nCargo.toml:\r\n```\r\n[lib]\r\ncrate-type = [\"lib\", \"cdylib\"]\r\n```\r\n\r\nCompile using:\r\n```\r\nRUSTFLAGS=\"-Zsanitizer=address -Clink-arg=-fuse-ld=lld\" cargo +nightly build --target=x86_64-unknown-linux-gnu\r\n```\r\n\r\n## Result\r\n\r\n```\r\n  = note: ld.lld: error: undefined hidden symbol: __start_asan_globals\r\n          >>> referenced by 2icvwuxjky13p126\r\n          >>>               /xxx/bug/target/x86_64-unknown-linux-gnu/debug/deps/bug.2icvwuxjky13p126.rcgu.o:(asan.module_ctor)\r\n          >>> referenced by 2icvwuxjky13p126\r\n          >>>               /xxx/bug/target/x86_64-unknown-linux-gnu/debug/deps/bug.2icvwuxjky13p126.rcgu.o:(asan.module_dtor)\r\n\r\n          ld.lld: error: undefined hidden symbol: __stop_asan_globals\r\n          >>> referenced by 2icvwuxjky13p126\r\n          >>>               /xxx/bug/target/x86_64-unknown-linux-gnu/debug/deps/bug.2icvwuxjky13p126.rcgu.o:(asan.module_ctor)\r\n          >>> referenced by 2icvwuxjky13p126\r\n          >>>               /xxx/bug/target/x86_64-unknown-linux-gnu/debug/deps/bug.2icvwuxjky13p126.rcgu.o:(asan.module_dtor)\r\n          collect2: error: ld returned 1 exit status\r\n```", "closed_by": {"login": "kamulos", "id": 5168812, "node_id": "MDQ6VXNlcjUxNjg4MTI=", "avatar_url": "https://avatars.githubusercontent.com/u/5168812?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kamulos", "html_url": "https://github.com/kamulos", "followers_url": "https://api.github.com/users/kamulos/followers", "following_url": "https://api.github.com/users/kamulos/following{/other_user}", "gists_url": "https://api.github.com/users/kamulos/gists{/gist_id}", "starred_url": "https://api.github.com/users/kamulos/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kamulos/subscriptions", "organizations_url": "https://api.github.com/users/kamulos/orgs", "repos_url": "https://api.github.com/users/kamulos/repos", "events_url": "https://api.github.com/users/kamulos/events{/privacy}", "received_events_url": "https://api.github.com/users/kamulos/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/81948/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/81948/timeline", "performed_via_github_app": null, "state_reason": "completed"}