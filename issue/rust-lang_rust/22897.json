{"url": "https://api.github.com/repos/rust-lang/rust/issues/22897", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/22897/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/22897/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/22897/events", "html_url": "https://github.com/rust-lang/rust/issues/22897", "id": 59342507, "node_id": "MDU6SXNzdWU1OTM0MjUwNw==", "number": 22897, "title": "ICE: cat_expr Errd from array of unconstrained type -- { []; }", "user": {"login": "rprichard", "id": 1572855, "node_id": "MDQ6VXNlcjE1NzI4NTU=", "avatar_url": "https://avatars.githubusercontent.com/u/1572855?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rprichard", "html_url": "https://github.com/rprichard", "followers_url": "https://api.github.com/users/rprichard/followers", "following_url": "https://api.github.com/users/rprichard/following{/other_user}", "gists_url": "https://api.github.com/users/rprichard/gists{/gist_id}", "starred_url": "https://api.github.com/users/rprichard/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rprichard/subscriptions", "organizations_url": "https://api.github.com/users/rprichard/orgs", "repos_url": "https://api.github.com/users/rprichard/repos", "events_url": "https://api.github.com/users/rprichard/events{/privacy}", "received_events_url": "https://api.github.com/users/rprichard/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2015-02-28T13:55:23Z", "updated_at": "2015-04-26T07:27:50Z", "closed_at": "2015-04-26T07:27:50Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Test case:\n\n```\nfn main() { []; }\n```\n\nOutput:\n\n```\n$ RUST_BACKTRACE=1 rustc test.rs \ntest.rs:1:13: 1:15 error: internal compiler error: cat_expr Errd\ntest.rs:1 fn main() { []; }\n                      ^~\nnote: the compiler unexpectedly panicked. this is a bug.\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports\nnote: run with `RUST_BACKTRACE=1` for a backtrace\nthread 'rustc' panicked at 'Box<Any>', /home/rustbuild/src/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libsyntax/diagnostic.rs:129\n\nstack backtrace:\n   1:         0xcc029720 - sys::backtrace::write::h66f3f2784d0f6c5ddgA\n   2:         0xcc051b80 - panicking::on_panic::h6fdde9e4e9166fe6jaJ\n   3:         0xcbf91c30 - rt::unwind::begin_unwind_inner::hba10c536ef2aae75MQI\n   4:         0xc92a10c0 - rt::unwind::begin_unwind::h11287547919384241778\n   5:         0xc92a1050 - diagnostic::SpanHandler::span_bug::h551f703868554ecfUBD\n   6:         0xc9e32fe0 - session::Session::span_bug::h10f6b5fdbea6485fbjp\n   7:         0xcb6c5920 - check::regionck::visit_expr::hc78138689559ecf8Yrd\n   8:         0xcb6c35c0 - check::regionck::Rcx<'a, 'tcx>::visit_fn_body::h75e2fac33dc50b43a4c\n   9:         0xcb75ee50 - check::check_bare_fn::hf42e5aabaa5cb880Oan\n  10:         0xcb756f40 - check::check_item::hdbe569c101f96905stn\n  11:         0xcb822f10 - check_crate::closure.36015\n  12:         0xcb81d9c0 - check_crate::h9d44bf3fde687089EXB\n  13:         0xcc6a38c0 - driver::phase_3_run_analysis_passes::h36c633d41f11ca74wFa\n  14:         0xcc689ec0 - driver::compile_input::h0de317319ab5c701Hba\n  15:         0xcc754e20 - run_compiler::hffa0c0711e361de8E5b\n  16:         0xcc753720 - thunk::F.Invoke<A, R>::invoke::h12673221910893163557\n  17:         0xcc752610 - rt::unwind::try::try_fn::h15130568597725528481\n  18:         0xcc0bd740 - rust_try_inner\n  19:         0xcc0bd730 - rust_try\n  20:         0xcc752910 - thunk::F.Invoke<A, R>::invoke::h3924406537784056782\n  21:         0xcc03d990 - sys::thread::thread_start::h3734be2229bd3edegEE\n  22:         0xc5f650c0 - start_thread\n  23:         0xcbc0a449 - __clone\n  24:                0x0 - <unknown>\n```\n\nCompiler version:\n\n```\nrustc 1.0.0-nightly (b47aebe3f 2015-02-26) (built 2015-02-27)\nbinary: rustc\ncommit-hash: b47aebe3fc2da06c760fd8ea19f84cbc41d34831\ncommit-date: 2015-02-26\nbuild-date: 2015-02-27\nhost: x86_64-unknown-linux-gnu\nrelease: 1.0.0-nightly\n```\n\nI modified the test case in #22894 by moving the `&*\"\"` into `fn main()`, and I saw the same ICE.  I then changed the `\"\"` to the similar `&[]`, and I saw an ICE with a different error message and a different stack trace (e.g. phase 3 instead of phase 4).  The `&` and `*` are unnecessary.\n\nI also see the `cat_expr Errd` message in #22037, but there are differences -- this issue happens in phase 3 rather than 4, and there is no \"fictitious type\" message.\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/22897/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/22897/timeline", "performed_via_github_app": null, "state_reason": "completed"}