{"url": "https://api.github.com/repos/rust-lang/rust/issues/14154", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/14154/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/14154/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/14154/events", "html_url": "https://github.com/rust-lang/rust/issues/14154", "id": 33343194, "node_id": "MDU6SXNzdWUzMzM0MzE5NA==", "number": 14154, "title": "I/O timeouts implemented as deadlines is probably the wrong paradigm", "user": {"login": "bill-myers", "id": 4647491, "node_id": "MDQ6VXNlcjQ2NDc0OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/4647491?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bill-myers", "html_url": "https://github.com/bill-myers", "followers_url": "https://api.github.com/users/bill-myers/followers", "following_url": "https://api.github.com/users/bill-myers/following{/other_user}", "gists_url": "https://api.github.com/users/bill-myers/gists{/gist_id}", "starred_url": "https://api.github.com/users/bill-myers/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bill-myers/subscriptions", "organizations_url": "https://api.github.com/users/bill-myers/orgs", "repos_url": "https://api.github.com/users/bill-myers/repos", "events_url": "https://api.github.com/users/bill-myers/events{/privacy}", "received_events_url": "https://api.github.com/users/bill-myers/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2014-05-12T20:22:13Z", "updated_at": "2015-01-23T22:09:04Z", "closed_at": "2015-01-23T21:50:20Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "The I/O library recently added timeout support, but implemented it in a very \"peculiar\" way.\n\nIn almost all libraries, specifying a timeout of T means that every operation will fail if more T is elapsed from the start of THAT operation.\n\nIn Rust instead, setting a timeout of T means that operations will fail if they terminate more than T time after the time the timeout was originally set.\n\nSo if you set a 1 second timeout, then after 1 second of time passes, all operations will instantly fail.\n\nThis is potentially useful if one wants to bound the time that a set of operations will take, but it seems unintuitive and inflexible in general.\n\nAlso, even if you reset the timeout before each operation, Rust's notion of timeouts includes userspace code and can thus cause timeouts due to preemption in the race window before the kernel is entered\n\nIt's probably a good idea to either implement timeouts normally (relative to the start of each operation), or perhaps add support for both normal relative timeouts, and absolute deadlines as implement in #13814 (taking the earliest of both, of course).\n\nBTW, relative timeouts should probably be implemented with setsockopt(SO_RCVTIMEO/SO_SNDTIMEO) or similar facilities where possible in the libnative case, so that the number of system calls is reduced, and the kernel gets more information about what is being done.\n", "closed_by": {"login": "steveklabnik", "id": 27786, "node_id": "MDQ6VXNlcjI3Nzg2", "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/steveklabnik", "html_url": "https://github.com/steveklabnik", "followers_url": "https://api.github.com/users/steveklabnik/followers", "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}", "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}", "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions", "organizations_url": "https://api.github.com/users/steveklabnik/orgs", "repos_url": "https://api.github.com/users/steveklabnik/repos", "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}", "received_events_url": "https://api.github.com/users/steveklabnik/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/14154/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/14154/timeline", "performed_via_github_app": null, "state_reason": "completed"}