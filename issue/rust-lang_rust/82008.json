{"url": "https://api.github.com/repos/rust-lang/rust/issues/82008", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/82008/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/82008/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/82008/events", "html_url": "https://github.com/rust-lang/rust/issues/82008", "id": 806804230, "node_id": "MDU6SXNzdWU4MDY4MDQyMzA=", "number": 82008, "title": "Update Rust String Documentation Regarding Unicode Scalar Value equivalence to Unicode Code Point (in UTF-8)", "user": {"login": "logannc", "id": 2867206, "node_id": "MDQ6VXNlcjI4NjcyMDY=", "avatar_url": "https://avatars.githubusercontent.com/u/2867206?v=4", "gravatar_id": "", "url": "https://api.github.com/users/logannc", "html_url": "https://github.com/logannc", "followers_url": "https://api.github.com/users/logannc/followers", "following_url": "https://api.github.com/users/logannc/following{/other_user}", "gists_url": "https://api.github.com/users/logannc/gists{/gist_id}", "starred_url": "https://api.github.com/users/logannc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/logannc/subscriptions", "organizations_url": "https://api.github.com/users/logannc/orgs", "repos_url": "https://api.github.com/users/logannc/repos", "events_url": "https://api.github.com/users/logannc/events{/privacy}", "received_events_url": "https://api.github.com/users/logannc/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 431251592, "node_id": "MDU6TGFiZWw0MzEyNTE1OTI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-docs", "name": "A-docs", "color": "f7e101", "default": false, "description": "Area: documentation for any part of the project, including the compiler, standard library, and tools"}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-02-11T22:49:27Z", "updated_at": "2023-04-20T17:25:02Z", "closed_at": null, "author_association": "NONE", "active_lock_reason": null, "body": "Apologies if this is the wrong place to file this bug.\r\n\r\nIt is well documented that [Rust Strings are _valid_ UTF-8 built off of Unicode Scalar Values](https://github.com/rust-lang/reference/blob/master/src/types/textual.md).\r\n\r\nSomething that is not obvious but true (I think - see *not obvious*), is that UTF-8 [does not allow surrogate code points](https://www.unicode.org/versions/Unicode13.0.0/ch03.pdf#G31703), therefore the Unicode Scalar Values produced from Rust Strings are a strict subset of *Unicode* code points but equivalent to the set of *UTF-8*-encodeable code points.\r\n\r\n> Because surrogate code points are not Unicode scalar values, any UTF-8 bytesequence  that  would  otherwise  map  to  code  points  U+D800..U+DFFF  is  ill-formed.\r\n\r\nI propose updating the documentation where the distinction about USVs are made. The current text is technically correct but is misleading as it can be easily incorrectly inferred that USVs are meaningfully different from code points (in the context of UTF-8 strings). While `char` documentation cannot claim this because it is absent the context of being UTF-8 encoded, we can make it more clear that USVs produced from strings are not different from UTF-8 code point sequences.\r\n\r\nUnicode strings are hard enough, I think this will remove a source of confusion for developers who haven't gone reading Unicode glossaries/specs. Developers are already often familiar with the concept of code points as opposed to raw bytes (but not necessarily the details), so if we can speak to what is already well known without losing technical accuracy, I think that is a win for productivity and developer accessibility.\r\n\r\n--- \r\n\r\nI do plan to take a look at making the documentation changes myself, though I think they're spread out across a few different repos.", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/82008/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/82008/timeline", "performed_via_github_app": null, "state_reason": null}