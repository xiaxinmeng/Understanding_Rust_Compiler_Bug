{"url": "https://api.github.com/repos/rust-lang/rust/issues/58613", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/58613/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/58613/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/58613/events", "html_url": "https://github.com/rust-lang/rust/issues/58613", "id": 412715253, "node_id": "MDU6SXNzdWU0MTI3MTUyNTM=", "number": 58613, "title": "Panic compiling `unreachable v1.0.0`/`memchr v2.0.1` only inside a Docker container and only on Windows.", "user": {"login": "nevdelap", "id": 583807, "node_id": "MDQ6VXNlcjU4MzgwNw==", "avatar_url": "https://avatars.githubusercontent.com/u/583807?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nevdelap", "html_url": "https://github.com/nevdelap", "followers_url": "https://api.github.com/users/nevdelap/followers", "following_url": "https://api.github.com/users/nevdelap/following{/other_user}", "gists_url": "https://api.github.com/users/nevdelap/gists{/gist_id}", "starred_url": "https://api.github.com/users/nevdelap/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nevdelap/subscriptions", "organizations_url": "https://api.github.com/users/nevdelap/orgs", "repos_url": "https://api.github.com/users/nevdelap/repos", "events_url": "https://api.github.com/users/nevdelap/events{/privacy}", "received_events_url": "https://api.github.com/users/nevdelap/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 123109, "node_id": "MDU6TGFiZWwxMjMxMDk=", "url": "https://api.github.com/repos/rust-lang/rust/labels/O-windows", "name": "O-windows", "color": "6e6ec0", "default": false, "description": "Operating system: Windows"}, {"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-02-21T02:10:29Z", "updated_at": "2019-08-06T09:50:00Z", "closed_at": null, "author_association": "NONE", "active_lock_reason": null, "body": "Hi there.\r\n\r\nUsing the Windows `Dockerfile` in this repository: https://github.com/nevdelap/ned-win/tree/rust-panic\r\n...to build this: https://github.com/nevdelap/ned\r\n...I get this panic: (Note: it's always worked in Windows without being in the Docker container.)\r\n```\r\n   Compiling unreachable v1.0.0\r\n   Compiling memchr v2.0.1\r\nthread 'main' panicked at 'called `Result::unwrap()` on an `Err` value: Os { code: 2, kind: NotFound, message: \"The system cannot find the file specified.\" }', src\\libcore\\result.rs:1009:5\r\nnote: Run with `RUST_BACKTRACE=1` for a backtrace.\r\n\r\nerror: internal compiler error: unexpected panic\r\n\r\nnote: the compiler unexpectedly panicked. this is a bug.\r\n\r\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports\r\n\r\nnote: rustc 1.32.0 (9fda7c223 2019-01-16) running on x86_64-pc-windows-msvc\r\n\r\nnote: compiler flags: -C debuginfo=2 --crate-type lib\r\n\r\nnote: some of the compiler flags provided by cargo are hidden\r\n\r\nerror: Could not compile `unreachable`.\r\nwarning: build failed, waiting for other jobs to finish...\r\nerror[E0658]: use of unstable library feature 'libc': use `libc` from crates.io (see issue #27783)\r\n  --> C:\\Users\\ContainerAdministrator\\.cargo\\registry\\src\\github.com-1ecc6299db9ec823\\memchr-2.0.1\\src\\lib.rs:17:1\r\n   |\r\n17 | extern crate libc;\r\n   | ^^^^^^^^^^^^^^^^^^\r\n\r\nerror[E0658]: use of unstable library feature 'libc': use `libc` from crates.io (see issue #27783)\r\n  --> C:\\Users\\ContainerAdministrator\\.cargo\\registry\\src\\github.com-1ecc6299db9ec823\\memchr-2.0.1\\src\\lib.rs:24:5\r\n   |\r\n24 | use libc::c_void;\r\n   |     ^^^^^^^^^^^^\r\n\r\nerror[E0658]: use of unstable library feature 'libc': use `libc` from crates.io (see issue #27783)\r\n  --> C:\\Users\\ContainerAdministrator\\.cargo\\registry\\src\\github.com-1ecc6299db9ec823\\memchr-2.0.1\\src\\lib.rs:26:12\r\n   |\r\n26 | use libc::{c_int, size_t};\r\n   |            ^^^^^\r\n\r\nerror[E0658]: use of unstable library feature 'libc': use `libc` from crates.io (see issue #27783)\r\n  --> C:\\Users\\ContainerAdministrator\\.cargo\\registry\\src\\github.com-1ecc6299db9ec823\\memchr-2.0.1\\src\\lib.rs:26:19\r\n   |\r\n26 | use libc::{c_int, size_t};\r\n   |                   ^^^^^^\r\n\r\nerror: aborting due to 4 previous errors\r\n\r\nFor more information about this error, try `rustc --explain E0658`.\r\nerror: Could not compile `memchr`.\r\n\r\nTo learn more, run the command again with --verbose.\r\n```\r\nThe attached file [rust-panic.txt](https://github.com/rust-lang/rust/files/2887331/rust-panic.txt) contains the full output for:\r\n\r\n- Building and running the container.\r\n- Doing `rustc -V` and `cargo -V`.\r\n- Doing `cargo test` with 1.32.0 - with the panic.\r\n- Rustup'ing to nightly.\r\n- Doing a `cargo clean` and `cargo test` with nightly - with the panic.\r\n\r\n(I haven't looked at why it is complaining: `warning: could not canonicalize path: 'C:\\Users\\administrator\\development\\ned'`)\r\n\r\nAt that point I exited the container, committed it, and pushed it to: https://hub.docker.com/r/nevdelap/rust-panic\r\n\r\nTo reproduce it:\r\n1. Install Docker on Windows. (2.0.3 on Windows 10 1803 is what I've got.)\r\n1. Clone: https://github.com/nevdelap/ned\r\n1. Run: `docker pull nevdelap/rust-panic:latest`\r\n1. Run: `docker run -it -v <yourpath>\\ned:C:\\Users\\Administrator\\Development\\ned nevdelap/rust-panic:latest`\r\n1. Run `cargo test`.\r\n\r\nThis has always built fine in Windows not in Docker, in Arch, Ubuntu, and CentOS, and in OS X High Sierra, up to an including Rust 1.32.0.\r\n\r\nUpdate: verbose version info and backtrace: [rust-panic-backtrace.txt](https://github.com/rust-lang/rust/files/2888264/rust-panic-backtrace.txt)\r\n\r\nCheers,\r\n\r\nNev", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/58613/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/58613/timeline", "performed_via_github_app": null, "state_reason": null}