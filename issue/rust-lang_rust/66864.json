{"url": "https://api.github.com/repos/rust-lang/rust/issues/66864", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/66864/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/66864/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/66864/events", "html_url": "https://github.com/rust-lang/rust/issues/66864", "id": 530234344, "node_id": "MDU6SXNzdWU1MzAyMzQzNDQ=", "number": 66864, "title": "Can't use different Error type in one async block with only ? operator", "user": {"login": "CGQAQ", "id": 15936231, "node_id": "MDQ6VXNlcjE1OTM2MjMx", "avatar_url": "https://avatars.githubusercontent.com/u/15936231?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CGQAQ", "html_url": "https://github.com/CGQAQ", "followers_url": "https://api.github.com/users/CGQAQ/followers", "following_url": "https://api.github.com/users/CGQAQ/following{/other_user}", "gists_url": "https://api.github.com/users/CGQAQ/gists{/gist_id}", "starred_url": "https://api.github.com/users/CGQAQ/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CGQAQ/subscriptions", "organizations_url": "https://api.github.com/users/CGQAQ/orgs", "repos_url": "https://api.github.com/users/CGQAQ/repos", "events_url": "https://api.github.com/users/CGQAQ/events{/privacy}", "received_events_url": "https://api.github.com/users/CGQAQ/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2019-11-29T09:12:26Z", "updated_at": "2019-11-29T10:12:56Z", "closed_at": "2019-11-29T09:55:07Z", "author_association": "NONE", "active_lock_reason": null, "body": "@Nemo157\r\n```rust\r\nasync fn a() -> Result<(), reqwest::Error> {Ok(())}\r\nasync fn b() -> Result<(), std::io::Error> {Ok(())}\r\n\r\nfn c() {\r\n    async {\r\n        a().await?;\r\n        b().await?;\r\n        Ok(())\r\n    };\r\n}\r\n```\r\n```\r\nerror[E0282]: type annotations needed\r\n --> src/x.rs:6:9\r\n  |\r\n6 |         a().await?;\r\n  |         ^^^^^^^^^^ cannot infer type\r\n\r\nerror: aborting due to previous error\r\n```\r\n```rust\r\nasync fn a() -> Result<(), reqwest::Error> {Ok(())}\r\nasync fn b() -> Result<(), std::io::Error> {Ok(())}\r\n\r\nfn c() {\r\n    async {\r\n        a().await?;\r\n        b().await?;\r\n        Ok::<(), impl std::error::Error>(())\r\n    };\r\n}\r\n```\r\n```\r\nerror[E0562]: `impl Trait` not allowed outside of function and inherent method return types\r\n --> src/x.rs:8:18\r\n  |\r\n8 |         Ok::<(), impl std::error::Error>(())\r\n  |                  ^^^^^^^^^^^^^^^^^^^^^^\r\n\r\nerror: aborting due to previous error\r\n```\r\n\r\n_Originally posted by @CGQAQ in https://github.com/rust-lang/rust/issues/62290#issuecomment-559711471_\r\n\r\n\r\n### Currently my solution is unwrap() other Result, use ? only one type of Result, like this: \r\n```rust\r\nasync fn a() -> Result<(), reqwest::Error> {Ok(())}\r\nasync fn b() -> Result<(), std::io::Error> {Ok(())}\r\nasync fn c() -> Result<(), std::io::Error> {Ok(())}\r\n\r\nfn d() {\r\n    async {\r\n        a().await.unwrap();\r\n        b().await?;\r\n        c().await?;\r\n        Ok::<(), std::io::Error>(())\r\n    };\r\n}", "closed_by": {"login": "jonas-schievink", "id": 1786438, "node_id": "MDQ6VXNlcjE3ODY0Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/1786438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jonas-schievink", "html_url": "https://github.com/jonas-schievink", "followers_url": "https://api.github.com/users/jonas-schievink/followers", "following_url": "https://api.github.com/users/jonas-schievink/following{/other_user}", "gists_url": "https://api.github.com/users/jonas-schievink/gists{/gist_id}", "starred_url": "https://api.github.com/users/jonas-schievink/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jonas-schievink/subscriptions", "organizations_url": "https://api.github.com/users/jonas-schievink/orgs", "repos_url": "https://api.github.com/users/jonas-schievink/repos", "events_url": "https://api.github.com/users/jonas-schievink/events{/privacy}", "received_events_url": "https://api.github.com/users/jonas-schievink/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/66864/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/66864/timeline", "performed_via_github_app": null, "state_reason": "completed"}