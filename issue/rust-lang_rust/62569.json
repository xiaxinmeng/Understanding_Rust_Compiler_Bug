{"url": "https://api.github.com/repos/rust-lang/rust/issues/62569", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/62569/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/62569/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/62569/events", "html_url": "https://github.com/rust-lang/rust/issues/62569", "id": 466489868, "node_id": "MDU6SXNzdWU0NjY0ODk4Njg=", "number": 62569, "title": "Should Rust still ignore SIGPIPE by default?", "user": {"login": "joshtriplett", "id": 162737, "node_id": "MDQ6VXNlcjE2MjczNw==", "avatar_url": "https://avatars.githubusercontent.com/u/162737?v=4", "gravatar_id": "", "url": "https://api.github.com/users/joshtriplett", "html_url": "https://github.com/joshtriplett", "followers_url": "https://api.github.com/users/joshtriplett/followers", "following_url": "https://api.github.com/users/joshtriplett/following{/other_user}", "gists_url": "https://api.github.com/users/joshtriplett/gists{/gist_id}", "starred_url": "https://api.github.com/users/joshtriplett/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/joshtriplett/subscriptions", "organizations_url": "https://api.github.com/users/joshtriplett/orgs", "repos_url": "https://api.github.com/users/joshtriplett/repos", "events_url": "https://api.github.com/users/joshtriplett/events{/privacy}", "received_events_url": "https://api.github.com/users/joshtriplett/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 36953, "node_id": "MDU6TGFiZWwzNjk1Mw==", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-runtime", "name": "A-runtime", "color": "f7e101", "default": false, "description": "Area: std's runtime and \"pre-main\" init for handling backtraces, unwinds, stack overflows"}, {"id": 211668019, "node_id": "MDU6TGFiZWwyMTE2NjgwMTk=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-lang", "name": "T-lang", "color": "bfd4f2", "default": false, "description": "Relevant to the language team, which will review and decide on the PR/issue."}, {"id": 211668062, "node_id": "MDU6TGFiZWwyMTE2NjgwNjI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-libs-api", "name": "T-libs-api", "color": "bfd4f2", "default": false, "description": "Relevant to the library API team, which will review and decide on the PR/issue."}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 27, "created_at": "2019-07-10T19:56:27Z", "updated_at": "2022-10-03T17:41:28Z", "closed_at": null, "author_association": "MEMBER", "active_lock_reason": null, "body": "Back in 2014, the Rust startup code (which runs before main) started ignoring SIGPIPE by default: https://github.com/rust-lang/rust/pull/13158\r\n\r\nThis dates back to when Rust had a runtime and a green-threads implementation, and more magic handling of I/O. The pull request mentions that it \"brings the behavior inline with libgreen\".\r\n\r\nThis doesn't seem to be documented anywhere, as far as I can tell; at a minimum, this needs documentation.\r\n\r\nBut I'd like to question whether we should still do this by default. See https://github.com/rust-lang/rust/issues/46016 for some recent discussion of this. This changes the default behavior of pipes from what people might expect when writing UNIX applications. Rust currently resets the signal mask in a child process, but that's only if you use *Rust* to launch the child process rather than calling a library to do so. And in addition to that, signal handlers are process-wide, and people might not expect Rust to change process-wide state like this. This also means that Rust *libraries* will not have the same behavior as Rust *applications*.\r\n\r\nEither way, this is something we need to document far better. Some people will want one behavior, and some people will want the other, so whichever we use as the default needs careful documentation and a documented procedure to change it.\r\n\r\nEDIT (based on a suggestion from @Centril): Perhaps we could control this with an attribute on `main` or on the top-level module?", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/62569/reactions", "total_count": 18, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 18, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/62569/timeline", "performed_via_github_app": null, "state_reason": null}