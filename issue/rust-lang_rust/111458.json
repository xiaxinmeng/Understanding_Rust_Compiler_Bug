{"url": "https://api.github.com/repos/rust-lang/rust/issues/111458", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/111458/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/111458/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/111458/events", "html_url": "https://github.com/rust-lang/rust/issues/111458", "id": 1705237131, "node_id": "I_kwDOAAsO6M5lo9qL", "number": 111458, "title": "New `#[must_use]` behaviour for async methods does not apply to `Pin<Box<dyn Future<Output = ()>>>`", "user": {"login": "tropicbliss", "id": 48951297, "node_id": "MDQ6VXNlcjQ4OTUxMjk3", "avatar_url": "https://avatars.githubusercontent.com/u/48951297?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tropicbliss", "html_url": "https://github.com/tropicbliss", "followers_url": "https://api.github.com/users/tropicbliss/followers", "following_url": "https://api.github.com/users/tropicbliss/following{/other_user}", "gists_url": "https://api.github.com/users/tropicbliss/gists{/gist_id}", "starred_url": "https://api.github.com/users/tropicbliss/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tropicbliss/subscriptions", "organizations_url": "https://api.github.com/users/tropicbliss/orgs", "repos_url": "https://api.github.com/users/tropicbliss/repos", "events_url": "https://api.github.com/users/tropicbliss/events{/privacy}", "received_events_url": "https://api.github.com/users/tropicbliss/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2023-05-11T07:31:38Z", "updated_at": "2023-05-11T08:12:10Z", "closed_at": null, "author_association": "NONE", "active_lock_reason": null, "body": "<!--\r\nThank you for filing a bug report! \ud83d\udc1b Please provide a short summary of the bug,\r\nalong with any information you feel relevant to replicating the bug.\r\n-->\r\n\r\nDefining traits that contain methods that return such a type:\r\n\r\n```rust\r\npub trait Hello {\r\n    fn hi(&self) -> Pin<Box<dyn Future<Output = i32>>> {\r\n        Box::pin(async { 42 })\r\n    }\r\n}\r\n\r\nstruct Number(i32);\r\n\r\nimpl Hello for Number {}\r\n\r\nasync fn say_hello() {\r\n  let number = Number(42);\r\n  number.hi().await;\r\n}\r\n```\r\n\r\nThe compiler should probably have warned me about not using the `Output` of the `Future`, consistent with the behaviour of async functions in Rust 1.67.0. This will also work without the need for traits but async traits is one of the most common use cases for such a type.\r\n\r\n### Meta\r\n<!--\r\nIf you're using the stable version of the compiler, you should also check if the\r\nbug also exists in the beta or nightly versions.\r\n-->\r\n\r\n`rustc --version --verbose`: \r\n```\r\nrustc 1.69.0 (84c898d65 2023-04-16)\r\nbinary: rustc\r\ncommit-hash: 84c898d65adf2f39a5a98507f1fe0ce10a2b8dbc\r\ncommit-date: 2023-04-16\r\nhost: x86_64-unknown-linux-gnu\r\nrelease: 1.69.0\r\nLLVM version: 15.0.7\r\n\r\nAlso tested on:\r\nrustc 1.71.0-nightly (f9a6b7158 2023-05-05)\r\nbinary: rustc\r\ncommit-hash: f9a6b71580cd53dd4491d9bb6400f7ee841d9c22\r\ncommit-date: 2023-05-05\r\nhost: x86_64-unknown-linux-gnu\r\nrelease: 1.71.0-nightly\r\nLLVM version: 16.0.2\r\n```\r\n\r\n<!--\r\nInclude a backtrace in the code block by setting `RUST_BACKTRACE=1` in your\r\nenvironment. E.g. `RUST_BACKTRACE=1 cargo build`.\r\n-->\r\n<details><summary>Backtrace</summary>\r\n<p>\r\n\r\n</p>\r\n</details>\r\n", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/111458/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/111458/timeline", "performed_via_github_app": null, "state_reason": null}