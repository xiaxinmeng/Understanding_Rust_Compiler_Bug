{"url": "https://api.github.com/repos/rust-lang/rust/issues/37109", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/37109/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/37109/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/37109/events", "html_url": "https://github.com/rust-lang/rust/issues/37109", "id": 182481625, "node_id": "MDU6SXNzdWUxODI0ODE2MjU=", "number": 37109, "title": "ICE: fictitious type <i32 as ToRef>::Ref in sizing_type_of()", "user": {"login": "jp-beaumont", "id": 1054620, "node_id": "MDQ6VXNlcjEwNTQ2MjA=", "avatar_url": "https://avatars.githubusercontent.com/u/1054620?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jp-beaumont", "html_url": "https://github.com/jp-beaumont", "followers_url": "https://api.github.com/users/jp-beaumont/followers", "following_url": "https://api.github.com/users/jp-beaumont/following{/other_user}", "gists_url": "https://api.github.com/users/jp-beaumont/gists{/gist_id}", "starred_url": "https://api.github.com/users/jp-beaumont/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jp-beaumont/subscriptions", "organizations_url": "https://api.github.com/users/jp-beaumont/orgs", "repos_url": "https://api.github.com/users/jp-beaumont/repos", "events_url": "https://api.github.com/users/jp-beaumont/events{/privacy}", "received_events_url": "https://api.github.com/users/jp-beaumont/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 262252840, "node_id": "MDU6TGFiZWwyNjIyNTI4NDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/regression-from-stable-to-stable", "name": "regression-from-stable-to-stable", "color": "e4008a", "default": false, "description": "Performance or correctness regression from one stable version to another."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2016-10-12T09:47:21Z", "updated_at": "2016-10-17T03:00:21Z", "closed_at": "2016-10-17T03:00:21Z", "author_association": "NONE", "active_lock_reason": null, "body": "This example causes an internal compiler error:\n\n``` rust\npub trait ToRef<'a> {\n    type Ref: 'a;\n}\n\nimpl<'a, U: 'a> ToRef<'a> for U {\n    type Ref = &'a U;\n}\n\nfn example<'a, T>(value: &'a T) -> (<T as ToRef<'a>>::Ref, u32) {\n    (value, 0)\n}\n\nfn main() {\n    example(&0);\n}\n```\n\nSmall changes to `example` or `main` such as eliminating the tuple or printing the result produce working code.\n\nVersion:\n\n```\nrustc 1.14.0-nightly (a3bc191b5 2016-10-10)\nbinary: rustc\ncommit-hash: a3bc191b5f41df5143cc65084b13999896411817\ncommit-date: 2016-10-10\nhost: x86_64-unknown-linux-gnu\nrelease: 1.14.0-nightly\n```\n\nErrror message and backtrace:\n\n```\nerror: internal compiler error: ../src/librustc_trans/type_of.rs:98: fictitious type <i32 as ToRef>::Ref in sizing_type_of()\nnote: the compiler unexpectedly panicked. this is a bug.\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports\nnote: run with `RUST_BACKTRACE=1` for a backtrace\n\nthread 'rustc' panicked at 'Box<Any>', ../src/librustc_errors/lib.rs:656\nstack backtrace:\n   1:     0x7f3497eb9aef - std::sys::backtrace::tracing::imp::write::h22f199c1dbb72ba2\n   2:     0x7f3497ec901d - std::panicking::default_hook::{{closure}}::h9a389c462b6a22dd\n   3:     0x7f3497ec6496 - std::panicking::default_hook::h852b4223c1c00c59\n   4:     0x7f3497ec6b78 - std::panicking::rust_panic_with_hook::hcd9d05f53fa0dafc\n   5:     0x7f3494325607 - std::panicking::begin_panic::h2f463d37998ebeba\n   6:     0x7f3494335768 - rustc_errors::Handler::bug::haca77c19c882b432\n   7:     0x7f349538aa9a - rustc::session::opt_span_bug_fmt::{{closure}}::hfeb850fbe828b399\n   8:     0x7f34952c9ba5 - rustc::session::opt_span_bug_fmt::h46e45438a860a75e\n   9:     0x7f34952c99e2 - rustc::session::bug_fmt::hde22f071bf5a80ea\n  10:     0x7f3496b20147 - rustc_trans::type_of::sizing_type_of::hf7867aeeebdabbb0\n  11:     0x7f3496abc480 - rustc_trans::common::type_is_immediate::h93795cb753d0e711\n  12:     0x7f3496abc6f0 - rustc_trans::common::type_is_imm_pair::h7e59f57fc9ab4576\n  13:     0x7f3496b097b9 - rustc_trans::mir::operand::<impl rustc_trans::mir::MirContext<'bcx, 'tcx>>::trans_load::h2c9d8b0a9e8182b8\n  14:     0x7f3496aff4cb - rustc_trans::mir::block::<impl rustc_trans::mir::MirContext<'bcx, 'tcx>>::store_return::h4d500d9c42a44cf7\n  15:     0x7f3496afc4f9 - rustc_trans::mir::block::<impl rustc_trans::mir::MirContext<'bcx, 'tcx>>::trans_block::he67d3259f79e4177\n  16:     0x7f3496af6b58 - rustc_trans::mir::trans_mir::h2fb44ecb31cfdffa\n  17:     0x7f3496a98cdc - rustc_trans::base::trans_closure::h941de14309416d66\n  18:     0x7f3496b16a34 - rustc_trans::trans_item::TransItem::define::ha4a18b94a3d46bf3\n  19:     0x7f3496a9c254 - rustc_trans::base::trans_crate::h9b06de31ed8799d1\n  20:     0x7f349824ed4d - rustc_driver::driver::phase_4_translate_to_llvm::hc3883ea2c4750179\n  21:     0x7f3498289cf7 - rustc_driver::driver::compile_input::{{closure}}::h9162a2fa292aeb3f\n  22:     0x7f3498280ef3 - rustc_driver::driver::phase_3_run_analysis_passes::{{closure}}::h1928c4704cfe9c61\n  23:     0x7f349824c6ed - rustc_driver::driver::phase_3_run_analysis_passes::he578df6b8805151c\n  24:     0x7f3498238f69 - rustc_driver::driver::compile_input::h5b63ccd49eeeb98b\n  25:     0x7f34982622ba - rustc_driver::run_compiler::h98c7274e7cb1d11d\n  26:     0x7f349819bf0b - std::panicking::try::do_call::h99ed0da044e497c3\n  27:     0x7f3497ed0f16 - __rust_maybe_catch_panic\n  28:     0x7f34981ba461 - <F as alloc::boxed::FnBox<A>>::call_box::hbdd5a14cd8e33b97\n  29:     0x7f3497ec4ef0 - std::sys::thread::Thread::new::thread_start::h50b05608a499d2b2\n  30:     0x7f34901c0483 - start_thread\n  31:     0x7f3497b916dc - clone\n  32:                0x0 - <unknown>\n```\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/37109/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/37109/timeline", "performed_via_github_app": null, "state_reason": "completed"}