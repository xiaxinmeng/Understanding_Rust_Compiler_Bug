{"url": "https://api.github.com/repos/rust-lang/rust/issues/27932", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/27932/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/27932/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/27932/events", "html_url": "https://github.com/rust-lang/rust/issues/27932", "id": 102367357, "node_id": "MDU6SXNzdWUxMDIzNjczNTc=", "number": 27932, "title": "dining philosophers does not actually exhibit deadlock", "user": {"login": "mjhoy", "id": 106337, "node_id": "MDQ6VXNlcjEwNjMzNw==", "avatar_url": "https://avatars.githubusercontent.com/u/106337?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mjhoy", "html_url": "https://github.com/mjhoy", "followers_url": "https://api.github.com/users/mjhoy/followers", "following_url": "https://api.github.com/users/mjhoy/following{/other_user}", "gists_url": "https://api.github.com/users/mjhoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/mjhoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mjhoy/subscriptions", "organizations_url": "https://api.github.com/users/mjhoy/orgs", "repos_url": "https://api.github.com/users/mjhoy/repos", "events_url": "https://api.github.com/users/mjhoy/events{/privacy}", "received_events_url": "https://api.github.com/users/mjhoy/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2015-08-21T12:18:28Z", "updated_at": "2015-11-04T09:23:40Z", "closed_at": "2015-11-04T09:23:40Z", "author_association": "NONE", "active_lock_reason": null, "body": "In the Dining Philosophers doc page, the `eat` function is implemented:\n\n```\nfn eat(&self, table: &Table) {\n    let _left = table.forks[self.left].lock().unwrap();\n    let _right = table.forks[self.right].lock().unwrap();\n\n    println!(\"{} is eating.\", self.name);\n\n    thread::sleep_ms(1000);\n\n    println!(\"{} is done eating.\", self.name);\n}\n```\n\nThe problem is this will not deadlock even when Foucault is right-handed: the implementation given solves the problem in another way, which is that philosophers take both left and right forks at the same time. In fact the left fork should be taken first, and then only after some time is given to the philosopher to grab food, the right fork should be taken. Something like:\n\n```\nfn eat(&self, table: &Table) {\n    let _left = table.forks[self.left].lock().unwrap();\n\n    println!(\"{} is grabbing food.\", self.name);\n\n    thread::sleep_ms(400);\n\n    let _right = table.forks[self.right].lock().unwrap();\n\n    println!(\"{} is eating.\", self.name);\n\n    thread::sleep_ms(1000);\n\n    println!(\"{} is done eating.\", self.name);\n}\n```\n\nNow the problem will deadlock if Foucault is right-handed (and Foucault being left-handed is now a real solution).\n", "closed_by": {"login": "steveklabnik", "id": 27786, "node_id": "MDQ6VXNlcjI3Nzg2", "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/steveklabnik", "html_url": "https://github.com/steveklabnik", "followers_url": "https://api.github.com/users/steveklabnik/followers", "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}", "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}", "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions", "organizations_url": "https://api.github.com/users/steveklabnik/orgs", "repos_url": "https://api.github.com/users/steveklabnik/repos", "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}", "received_events_url": "https://api.github.com/users/steveklabnik/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/27932/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/27932/timeline", "performed_via_github_app": null, "state_reason": "completed"}