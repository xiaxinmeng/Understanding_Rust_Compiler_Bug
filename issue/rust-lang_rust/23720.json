{"url": "https://api.github.com/repos/rust-lang/rust/issues/23720", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/23720/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/23720/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/23720/events", "html_url": "https://github.com/rust-lang/rust/issues/23720", "id": 64391147, "node_id": "MDU6SXNzdWU2NDM5MTE0Nw==", "number": 23720, "title": "This warning about a trivial numeric cast feels wrong", "user": {"login": "ghost", "id": 10137, "node_id": "MDQ6VXNlcjEwMTM3", "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ghost", "html_url": "https://github.com/ghost", "followers_url": "https://api.github.com/users/ghost/followers", "following_url": "https://api.github.com/users/ghost/following{/other_user}", "gists_url": "https://api.github.com/users/ghost/gists{/gist_id}", "starred_url": "https://api.github.com/users/ghost/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ghost/subscriptions", "organizations_url": "https://api.github.com/users/ghost/orgs", "repos_url": "https://api.github.com/users/ghost/repos", "events_url": "https://api.github.com/users/ghost/events{/privacy}", "received_events_url": "https://api.github.com/users/ghost/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2015-03-25T22:53:50Z", "updated_at": "2015-03-26T06:48:24Z", "closed_at": "2015-03-26T06:48:24Z", "author_association": "NONE", "active_lock_reason": null, "body": "Intuitively it feels wrong for the compiler to warn about a trivial numeric cast in a context where the act of removing the cast would result in an error.\n\n``` rust\nmacro_rules! make_foo {\n    ($Int:ident) => (\n        #[repr($Int)]\n        enum Foo { A, B, C }\n\n        impl Foo {\n            fn min() -> Foo {\n                unsafe {\n                    ::std::mem::transmute(0 as $Int) // WARNING: [1]\n                }\n            }\n        }\n    )\n}\n\nmake_foo!{ u8 }\n\n// [1] warning: trivial numeric cast: `u8` as `u8`, #[warn(trivial_numeric_casts)] on by default\n```\n\nAfter removing the cast:\n\n``` rust\nmacro_rules! make_foo {\n    ($Int:ident) => (\n        #[repr($Int)]\n        enum Foo { A, B, C }\n\n        impl Foo {\n            fn min() -> Foo {\n                unsafe {\n                    ::std::mem::transmute(0) // ERROR: [2]\n                }\n            }\n        }\n    )\n}\n\nmake_foo!{ u8 }\n\n// [2] error: transmute called on types with different sizes: i32 (32 bits) to Foo (8 bits)\n```\n", "closed_by": {"login": "eddyb", "id": 77424, "node_id": "MDQ6VXNlcjc3NDI0", "avatar_url": "https://avatars.githubusercontent.com/u/77424?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eddyb", "html_url": "https://github.com/eddyb", "followers_url": "https://api.github.com/users/eddyb/followers", "following_url": "https://api.github.com/users/eddyb/following{/other_user}", "gists_url": "https://api.github.com/users/eddyb/gists{/gist_id}", "starred_url": "https://api.github.com/users/eddyb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eddyb/subscriptions", "organizations_url": "https://api.github.com/users/eddyb/orgs", "repos_url": "https://api.github.com/users/eddyb/repos", "events_url": "https://api.github.com/users/eddyb/events{/privacy}", "received_events_url": "https://api.github.com/users/eddyb/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/23720/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/23720/timeline", "performed_via_github_app": null, "state_reason": "completed"}