{"url": "https://api.github.com/repos/rust-lang/rust/issues/68085", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/68085/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/68085/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/68085/events", "html_url": "https://github.com/rust-lang/rust/issues/68085", "id": 547889940, "node_id": "MDU6SXNzdWU1NDc4ODk5NDA=", "number": 68085, "title": "Method in a struct with a generic field should satisfy static", "user": {"login": "nrxus", "id": 2774084, "node_id": "MDQ6VXNlcjI3NzQwODQ=", "avatar_url": "https://avatars.githubusercontent.com/u/2774084?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nrxus", "html_url": "https://github.com/nrxus", "followers_url": "https://api.github.com/users/nrxus/followers", "following_url": "https://api.github.com/users/nrxus/following{/other_user}", "gists_url": "https://api.github.com/users/nrxus/gists{/gist_id}", "starred_url": "https://api.github.com/users/nrxus/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nrxus/subscriptions", "organizations_url": "https://api.github.com/users/nrxus/orgs", "repos_url": "https://api.github.com/users/nrxus/repos", "events_url": "https://api.github.com/users/nrxus/events{/privacy}", "received_events_url": "https://api.github.com/users/nrxus/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-01-10T06:24:25Z", "updated_at": "2020-01-10T17:48:07Z", "closed_at": "2020-01-10T10:12:37Z", "author_association": "NONE", "active_lock_reason": null, "body": "Since methods never capture from the environment (unlike closures), they should satisfy the `'static` lifetime. However this does not hold for implementations of a struct with a generic parameter. \r\n\r\nIf we had a struct like this:\r\n```rust\r\nstruct Foo<T>(T);\r\n```\r\n\r\nThe following two implementations work:\r\n```rust\r\nimpl<'a> Foo<&'a i32> {\r\n    fn a(&self) -> std::any::TypeId {\r\n        Self::a.type_id()\r\n    }\r\n}\r\n```\r\n\r\n```rust\r\nimpl<'a> Foo<&'a mut i32> {\r\n    fn b(&self) -> std::any::TypeId {\r\n        Self::b.type_id()\r\n    }\r\n}\r\n```\r\n\r\nThese makes sense because even though the field inside is not static, the method is still static. \r\n\r\nHowever, the following fails to compile:\r\n```rust\r\nimpl<T> Foo<T> {\r\n    fn c(&self) -> std::any::TypeId {\r\n        Self::c.type_id()\r\n    }\r\n}\r\n```\r\n\r\nWith the error:\r\n```\r\n   |\r\n17 | impl<T> Foo<T> {\r\n   |      - help: consider adding an explicit lifetime bound `T: 'static`...\r\n18 |     fn c(&self) -> std::any::TypeId {\r\n19 |         Self::c.type_id()\r\n   |                 ^^^^^^^\r\n   |\r\nnote: ...so that the type `for<'r> fn(&'r Foo<T>) -> std::any::TypeId {Foo::<T>::c}` will meet its required lifetime bounds\r\n  --> src/main.rs:19:17\r\n   |\r\n19 |         Self::c.type_id()\r\n   |                 ^^^^^^^\r\n```\r\n\r\nIt is unclear to me why the latter fails to compile when the earlier two iterations worked even though the T was non-static type (a reference with a non-static lifetime). The method should be static even if it's struct is not, or is my understanding of static for function pointers incorrect? \r\n\r\n[Link to playgrund](https://play.rust-lang.org/?version=stable&mode=debug&edition=2018&gist=5ac2a6d6544ad1a9f8bc0d0dd355ce38)\r\n\r\nI apologize if this is not a bug and it works as intended, an explanation as to why would be greatly appreciated. I've tried to look for answers elsewhere (discord, discourse, google) to no avail. ", "closed_by": {"login": "jonas-schievink", "id": 1786438, "node_id": "MDQ6VXNlcjE3ODY0Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/1786438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jonas-schievink", "html_url": "https://github.com/jonas-schievink", "followers_url": "https://api.github.com/users/jonas-schievink/followers", "following_url": "https://api.github.com/users/jonas-schievink/following{/other_user}", "gists_url": "https://api.github.com/users/jonas-schievink/gists{/gist_id}", "starred_url": "https://api.github.com/users/jonas-schievink/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jonas-schievink/subscriptions", "organizations_url": "https://api.github.com/users/jonas-schievink/orgs", "repos_url": "https://api.github.com/users/jonas-schievink/repos", "events_url": "https://api.github.com/users/jonas-schievink/events{/privacy}", "received_events_url": "https://api.github.com/users/jonas-schievink/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/68085/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/68085/timeline", "performed_via_github_app": null, "state_reason": "completed"}