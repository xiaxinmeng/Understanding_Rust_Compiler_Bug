{"url": "https://api.github.com/repos/rust-lang/rust/issues/70780", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/70780/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/70780/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/70780/events", "html_url": "https://github.com/rust-lang/rust/issues/70780", "id": 593966839, "node_id": "MDU6SXNzdWU1OTM5NjY4Mzk=", "number": 70780, "title": "Switching from `impl` to `dyn` changes lifetime inference (maybe?)", "user": {"login": "Ekleog", "id": 411447, "node_id": "MDQ6VXNlcjQxMTQ0Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/411447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Ekleog", "html_url": "https://github.com/Ekleog", "followers_url": "https://api.github.com/users/Ekleog/followers", "following_url": "https://api.github.com/users/Ekleog/following{/other_user}", "gists_url": "https://api.github.com/users/Ekleog/gists{/gist_id}", "starred_url": "https://api.github.com/users/Ekleog/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Ekleog/subscriptions", "organizations_url": "https://api.github.com/users/Ekleog/orgs", "repos_url": "https://api.github.com/users/Ekleog/repos", "events_url": "https://api.github.com/users/Ekleog/events{/privacy}", "received_events_url": "https://api.github.com/users/Ekleog/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 234902, "node_id": "MDU6TGFiZWwyMzQ5MDI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-enhancement", "name": "C-enhancement", "color": "f5f1fd", "default": false, "description": "Category: An issue proposing an enhancement or a PR with one."}, {"id": 235791, "node_id": "MDU6TGFiZWwyMzU3OTE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-diagnostics", "name": "A-diagnostics", "color": "f7e101", "default": false, "description": "Area: Messages for errors, warnings, and lints"}, {"id": 1775993, "node_id": "MDU6TGFiZWwxNzc1OTkz", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-lifetimes", "name": "A-lifetimes", "color": "f7e101", "default": false, "description": "Area: lifetime related"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-04-04T17:44:48Z", "updated_at": "2021-08-25T04:28:49Z", "closed_at": null, "author_association": "NONE", "active_lock_reason": null, "body": "I'm not really sure how to report this bug, as I'm not even sure it actually is a bug in Rust, due to my not understanding enough how lifetimes are at work in this example.\r\n\r\nSo I'll just give the code and try to explain (it's quite long, so I've just put it on the playground). The interesting code is at the bottom of the playground links.\r\n\r\n#### Failing code\r\n\r\nhttps://play.rust-lang.org/?version=stable&mode=debug&edition=2018&gist=5bb42243a4f952045f4991f280c101e0\r\n\r\nThis code doesn't compile. It is basically an extraction of the commented code, which compiles.\r\n\r\nI originally assumed that this was a mistake on my part of providing the correct lifetimes.\r\n\r\nHowever\u2026\r\n\r\n#### Working code\r\n\r\nhttps://play.rust-lang.org/?version=stable&mode=debug&edition=2018&gist=b7f082cd3912f0ad1d7176c0adb51928\r\n\r\nHere, the code does compile. The only change is to replace `Pin<Box<dyn 'static + Send + Future<...>>>` with `Pin<Box<RetFut>>` with `RetFut: 'static + Send + Future<...>`\r\n\r\nIt appears quite weird that this code compiles but not the previous one, and I'm thus reporting this bug.\r\n\r\nAs usual, thank you for all your work on Rust!", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/70780/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/70780/timeline", "performed_via_github_app": null, "state_reason": null}