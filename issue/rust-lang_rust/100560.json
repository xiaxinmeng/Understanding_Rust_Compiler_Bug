{"url": "https://api.github.com/repos/rust-lang/rust/issues/100560", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/100560/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/100560/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/100560/events", "html_url": "https://github.com/rust-lang/rust/issues/100560", "id": 1338533816, "node_id": "I_kwDOAAsO6M5PyGe4", "number": 100560, "title": "E0277 focuses on the wrong part of the line.", "user": {"login": "Lokathor", "id": 5456384, "node_id": "MDQ6VXNlcjU0NTYzODQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5456384?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Lokathor", "html_url": "https://github.com/Lokathor", "followers_url": "https://api.github.com/users/Lokathor/followers", "following_url": "https://api.github.com/users/Lokathor/following{/other_user}", "gists_url": "https://api.github.com/users/Lokathor/gists{/gist_id}", "starred_url": "https://api.github.com/users/Lokathor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Lokathor/subscriptions", "organizations_url": "https://api.github.com/users/Lokathor/orgs", "repos_url": "https://api.github.com/users/Lokathor/repos", "events_url": "https://api.github.com/users/Lokathor/events{/privacy}", "received_events_url": "https://api.github.com/users/Lokathor/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 235791, "node_id": "MDU6TGFiZWwyMzU3OTE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-diagnostics", "name": "A-diagnostics", "color": "f7e101", "default": false, "description": "Area: Messages for errors, warnings, and lints"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}], "state": "closed", "locked": false, "assignee": {"login": "compiler-errors", "id": 3674314, "node_id": "MDQ6VXNlcjM2NzQzMTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3674314?v=4", "gravatar_id": "", "url": "https://api.github.com/users/compiler-errors", "html_url": "https://github.com/compiler-errors", "followers_url": "https://api.github.com/users/compiler-errors/followers", "following_url": "https://api.github.com/users/compiler-errors/following{/other_user}", "gists_url": "https://api.github.com/users/compiler-errors/gists{/gist_id}", "starred_url": "https://api.github.com/users/compiler-errors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/compiler-errors/subscriptions", "organizations_url": "https://api.github.com/users/compiler-errors/orgs", "repos_url": "https://api.github.com/users/compiler-errors/repos", "events_url": "https://api.github.com/users/compiler-errors/events{/privacy}", "received_events_url": "https://api.github.com/users/compiler-errors/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "compiler-errors", "id": 3674314, "node_id": "MDQ6VXNlcjM2NzQzMTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3674314?v=4", "gravatar_id": "", "url": "https://api.github.com/users/compiler-errors", "html_url": "https://github.com/compiler-errors", "followers_url": "https://api.github.com/users/compiler-errors/followers", "following_url": "https://api.github.com/users/compiler-errors/following{/other_user}", "gists_url": "https://api.github.com/users/compiler-errors/gists{/gist_id}", "starred_url": "https://api.github.com/users/compiler-errors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/compiler-errors/subscriptions", "organizations_url": "https://api.github.com/users/compiler-errors/orgs", "repos_url": "https://api.github.com/users/compiler-errors/repos", "events_url": "https://api.github.com/users/compiler-errors/events{/privacy}", "received_events_url": "https://api.github.com/users/compiler-errors/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2022-08-15T04:44:01Z", "updated_at": "2022-08-22T00:34:09Z", "closed_at": "2022-08-22T00:34:09Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "So i've got some code like this:\n```rust\n#[derive(Debug, Clone, Default, PartialEq, Eq)]\nstruct ProgramAttr(Vec<DmgToken>);\nimpl ProgramAttr {\n  fn parser() -> impl Parser<DmgToken, ProgramAttr, Error = Simple<DmgToken>> {\n    just(Punctuation('#')).ignore_then(just(Punctuation('!'))).ignore_then(\n      filter(|t: &DmgToken| *t != Punctuation(']'))\n        .repeated()\n        .collect::<Vec<_>>()\n        .delimited_by(Punctuation('['), Punctuation(']'))\n        .map(ProgramAttr),\n    )\n  }\n}\n```\n\n**What is wrong:** The `delimited_by` takes a parser for what occurs immediately before and immediately after the parser you call the method on. So it has a `: Parser<I, O>` trait bound. Except that `Punctuation('[')` is a *token*, not a *parser for a token*. What I should have written is `just(Punctuation('['))`.\n\n**What Rustc Tells You:**\n```\nD:\\dev\\dmgrs>cargo build\n   Compiling dmgrs v0.1.0 (D:\\dev\\dmgrs)\nerror[E0277]: the trait bound `DmgToken: Parser<DmgToken, _>` is not satisfied\n   --> src\\parser.rs:19:10\n    |\n19  |         .delimited_by(Punctuation('['), Punctuation(']'))\n    |          ^^^^^^^^^^^^ the trait `Parser<DmgToken, _>` is not implemented for `DmgToken`\n    |\n    = help: the following other types implement trait `Parser<I, O>`:\n              <&'a T as Parser<I, O>>\n              <Arc<T> as Parser<I, O>>\n              <Box<T> as Parser<I, O>>\n              <BoxedParser<'a, I, O, E> as Parser<I, O>>\n              <Choice<(A_, B_, C_, D_, E_, F_, G_, H_, I_, J_, K_, L_, M_, N_, O_, P_, Q_, S_, T_, U_, V_, W_, X_, Y_, Z_), E> as Parser<I, O>>\n              <Choice<(B_, C_, D_, E_, F_, G_, H_, I_, J_, K_, L_, M_, N_, O_, P_, Q_, S_, T_, U_, V_, W_, X_, Y_, Z_), E> as Parser<I, O>>\n              <Choice<(C_, D_, E_, F_, G_, H_, I_, J_, K_, L_, M_, N_, O_, P_, Q_, S_, T_, U_, V_, W_, X_, Y_, Z_), E> as Parser<I, O>>\n              <Choice<(D_, E_, F_, G_, H_, I_, J_, K_, L_, M_, N_, O_, P_, Q_, S_, T_, U_, V_, W_, X_, Y_, Z_), E> as Parser<I, O>>\n            and 60 others\nnote: required by a bound in `delimited_by`\n   --> C:\\Users\\Daniel\\.cargo\\git\\checkouts\\chumsky-651fb76526ac39e3\\a0a67e4\\src\\lib.rs:871:12\n    |\n871 |         L: Parser<I, U, Error = Self::Error>,\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ required by this bound in `delimited_by`\n```\n\n**The Problem:** The part that's \"wrong\" in the line is the argument, not the method call. The way the error describes things, it makes it sound like the method doesn't exist because the *thing i'm calling it on* doesn't satisfy some trait bound or something like that. Which, if this were nearly any other language, would sound like a silly thing to worry about, but with rust that's a genuine concern.\n\n**How I Think Rustc Should Show The Error:**\nInstead of focusing on `delimited_by` as having the error, it should focus on *the argument to* `delimited_by` as having the error.\n```\nerror[E0277]: the trait bound `DmgToken: Parser<DmgToken, _>` is not satisfied\n   --> src\\parser.rs:19:10\n    |\n19  |         .delimited_by(Punctuation('['), Punctuation(']'))\n    |                       ^^^^^^^^^^^^^^^^ the trait `Parser<DmgToken, _>` is not implemented for `DmgToken`\n    |\n\n```\n\n<!-- TRIAGEBOT_START -->\n\n<!-- TRIAGEBOT_ASSIGN_START -->\n\n<!-- TRIAGEBOT_ASSIGN_DATA_START$${\"user\":\"compiler-errors\"}$$TRIAGEBOT_ASSIGN_DATA_END -->\n\n<!-- TRIAGEBOT_ASSIGN_END -->\n<!-- TRIAGEBOT_END -->", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/100560/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/100560/timeline", "performed_via_github_app": null, "state_reason": "completed"}