{"url": "https://api.github.com/repos/rust-lang/rust/issues/34427", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/34427/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/34427/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/34427/events", "html_url": "https://github.com/rust-lang/rust/issues/34427", "id": 161932531, "node_id": "MDU6SXNzdWUxNjE5MzI1MzE=", "number": 34427, "title": "[MIR] Stage1 `libcore` crashes with SIGILL on ARM", "user": {"login": "MagaTailor", "id": 12054457, "node_id": "MDQ6VXNlcjEyMDU0NDU3", "avatar_url": "https://avatars.githubusercontent.com/u/12054457?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MagaTailor", "html_url": "https://github.com/MagaTailor", "followers_url": "https://api.github.com/users/MagaTailor/followers", "following_url": "https://api.github.com/users/MagaTailor/following{/other_user}", "gists_url": "https://api.github.com/users/MagaTailor/gists{/gist_id}", "starred_url": "https://api.github.com/users/MagaTailor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MagaTailor/subscriptions", "organizations_url": "https://api.github.com/users/MagaTailor/orgs", "repos_url": "https://api.github.com/users/MagaTailor/repos", "events_url": "https://api.github.com/users/MagaTailor/events{/privacy}", "received_events_url": "https://api.github.com/users/MagaTailor/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 100522, "node_id": "MDU6TGFiZWwxMDA1MjI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-crash", "name": "I-crash", "color": "e10c02", "default": false, "description": "Issue: The compiler crashes (SIGSEGV, SIGABRT, etc). Use I-ICE instead when the compiler panics."}, {"id": 108333, "node_id": "MDU6TGFiZWwxMDgzMzM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-LLVM", "name": "A-LLVM", "color": "f7e101", "default": false, "description": "Area: Code generation parts specific to LLVM. Both correctness bugs and optimization-related issues."}, {"id": 234956, "node_id": "MDU6TGFiZWwyMzQ5NTY=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-codegen", "name": "A-codegen", "color": "f7e101", "default": false, "description": "Area: Code generation"}, {"id": 55301954, "node_id": "MDU6TGFiZWw1NTMwMTk1NA==", "url": "https://api.github.com/repos/rust-lang/rust/labels/O-Arm", "name": "O-Arm", "color": "6e6ec0", "default": false, "description": "Target: 32-bit Arm processors (armv6, armv7, thumb...), including 64-bit Arm in AArch32 state"}, {"id": 203429200, "node_id": "MDU6TGFiZWwyMDM0MjkyMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/P-high", "name": "P-high", "color": "eb6420", "default": false, "description": "High priority"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 262252840, "node_id": "MDU6TGFiZWwyNjIyNTI4NDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/regression-from-stable-to-stable", "name": "regression-from-stable-to-stable", "color": "e4008a", "default": false, "description": "Performance or correctness regression from one stable version to another."}], "state": "closed", "locked": false, "assignee": {"login": "eddyb", "id": 77424, "node_id": "MDQ6VXNlcjc3NDI0", "avatar_url": "https://avatars.githubusercontent.com/u/77424?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eddyb", "html_url": "https://github.com/eddyb", "followers_url": "https://api.github.com/users/eddyb/followers", "following_url": "https://api.github.com/users/eddyb/following{/other_user}", "gists_url": "https://api.github.com/users/eddyb/gists{/gist_id}", "starred_url": "https://api.github.com/users/eddyb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eddyb/subscriptions", "organizations_url": "https://api.github.com/users/eddyb/orgs", "repos_url": "https://api.github.com/users/eddyb/repos", "events_url": "https://api.github.com/users/eddyb/events{/privacy}", "received_events_url": "https://api.github.com/users/eddyb/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "eddyb", "id": 77424, "node_id": "MDQ6VXNlcjc3NDI0", "avatar_url": "https://avatars.githubusercontent.com/u/77424?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eddyb", "html_url": "https://github.com/eddyb", "followers_url": "https://api.github.com/users/eddyb/followers", "following_url": "https://api.github.com/users/eddyb/following{/other_user}", "gists_url": "https://api.github.com/users/eddyb/gists{/gist_id}", "starred_url": "https://api.github.com/users/eddyb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eddyb/subscriptions", "organizations_url": "https://api.github.com/users/eddyb/orgs", "repos_url": "https://api.github.com/users/eddyb/repos", "events_url": "https://api.github.com/users/eddyb/events{/privacy}", "received_events_url": "https://api.github.com/users/eddyb/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 55, "created_at": "2016-06-23T14:10:27Z", "updated_at": "2018-11-21T09:46:31Z", "closed_at": "2016-09-22T16:12:59Z", "author_association": "NONE", "active_lock_reason": null, "body": "Since a few days ago, I'm unable to bootstrap rustc on ARM. Stage0 passes ok, but then during `libcore` compilation I'm getting a consistent crash:\n\n``` shell\n(gdb) run\nStarting program: ../arm-unknown-linux-gnueabihf/stage1/bin/rustc --cfg stage1 -C codegen-units=1 -C target-cpu=cortex-a5 -C target-feature=-neon,-slowfpvmlx -Z orbit -C link-args=-s -O --cfg rtopt -C rpath -C prefer-dynamic --target=arm-unknown-linux-gnueabihf -C target-feature=+v7,+vfp3 -L arm-unknown-linux-gnueabihf/rt -L native=../arm-unknown-linux-gnueabihf/llvm/Release/lib --out-dir arm-unknown-linux-gnueabihf/stage1/lib/rustlib/arm-unknown-linux-gnueabihf/lib -C extra-filename=-fe3cdf61 -C metadata=fe3cdf61 src/libcore/lib.rs\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib/arm-linux-gnueabihf/libthread_db.so.1\".\n[New Thread 0xb23c8280 (LWP 10171)]\n\nProgram received signal SIGILL, Illegal instruction.\n[Switching to Thread 0xb23c8280 (LWP 10171)]\n0xb5ccd4c8 in rustc_trans::mir::constant::MirConstContext::new::hfbf8e74461aa3c9a ()\n   from ../arm-unknown-linux-gnueabihf/stage1/lib/librustc_trans-fe3cdf61.so\n(gdb) bt\n#0  0xb5ccd4c8 in rustc_trans::mir::constant::MirConstContext::new::hfbf8e74461aa3c9a ()\n   from ../arm-unknown-linux-gnueabihf/stage1/lib/librustc_trans-fe3cdf61.so\n#1  0xb5cca2bc in rustc_trans::mir::constant::_$LT$impl$u20$mir..MirContext$LT$$u27$bcx$C$$u20$$u27$tcx$GT$$GT$::trans_constant::h0fc06663a5c5fd5c () from ../arm-unknown-linux-gnueabihf/stage1/lib/librustc_trans-fe3cdf61.so\n#2  0xb5cc97e8 in rustc_trans::mir::operand::_$LT$impl$u20$mir..MirContext$LT$$u27$bcx$C$$u20$$u27$tcx$GT$$GT$::trans_operand::hf76be65ffae28ad3 () from ../arm-unknown-linux-gnueabihf/stage1/lib/librustc_trans-fe3cdf61.so\n#3  0xb5cda61c in rustc_trans::mir::rvalue::_$LT$impl$u20$mir..MirContext$LT$$u27$bcx$C$$u20$$u27$tcx$GT$$GT$::trans_rvalue_operand::hd939e0a331e9c597 () from ../arm-unknown-linux-gnueabihf/stage1/lib/librustc_trans-fe3cdf61.so\n#4  0xb5cbff28 in rustc_trans::mir::block::_$LT$impl$u20$mir..MirContext$LT$$u27$bcx$C$$u20$$u27$tcx$GT$$GT$::trans_block::hb1d87007c9e87f30 () from ../arm-unknown-linux-gnueabihf/stage1/lib/librustc_trans-fe3cdf61.so\n#5  0xb5ba9aa8 in rustc_trans::mir::trans_mir::hf51ccc32c7a8ddd3 ()\n   from ../arm-unknown-linux-gnueabihf/stage1/lib/librustc_trans-fe3cdf61.so\n#6  0xb5ba1ff0 in rustc_trans::base::trans_closure::hcb1c30ddf81aba40 ()\n   from ../arm-unknown-linux-gnueabihf/stage1/lib/librustc_trans-fe3cdf61.so\n#7  0xb5bab570 in rustc_trans::base::trans_fn::h1508ebeec7351f87 ()\n   from ../arm-unknown-linux-gnueabihf/stage1/lib/librustc_trans-fe3cdf61.so\n#8  0xb5bb8950 in rustc_trans::base::trans_item::hd6a260625a685bf2 ()\n   from ../arm-unknown-linux-gnueabihf/stage1/lib/librustc_trans-fe3cdf61.so\n#9  0xb5bd3e10 in _$LT$base..TransItemsWithinModVisitor$LT$$u27$a$C$$u20$$u27$tcx$GT$$u20$as$u20$rustc..hir..intravisit..Visitor$LT$$u27$v$GT$$GT$::visit_item::heb661116fa8a1e87 () from ../arm-unknown-linux-gnueabihf/stage1/lib/librustc_trans-fe3cdf61.so\n#10 0xb5bd2524 in rustc::hir::intravisit::walk_item::hf7ed747a4fa46491 ()\n   from ../arm-unknown-linux-gnueabihf/stage1/lib/librustc_trans-fe3cdf61.so\n#11 0xb5bcbbe4 in _$LT$base..TransModVisitor$LT$$u27$a$C$$u20$$u27$tcx$GT$$u20$as$u20$rustc..hir..intravisit..Visitor$LT$$u27$v$GT$$GT$::visit_item::h65d871e71b3668c9 () from ../arm-unknown-linux-gnueabihf/stage1/lib/librustc_trans-fe3cdf61.so\n#12 0xb5bbf8ec in rustc_trans::base::trans_crate::hca67d2711539a441 ()\n   from ../arm-unknown-linux-gnueabihf/stage1/lib/librustc_trans-fe3cdf61.so\n#13 0xb6e06194 in rustc_driver::driver::phase_4_translate_to_llvm::h5f028163cc963293 ()\n   from ../arm-unknown-linux-gnueabihf/stage1/lib/librustc_driver-fe3cdf61.so\n#14 0xb6e04640 in rustc_driver::driver::compile_input::_$u7b$$u7b$closure$u7d$$u7d$::h540343a1efd859c9 ()\n   from ../arm-unknown-linux-gnueabihf/stage1/lib/librustc_driver-fe3cdf61.so\n#15 0xb6e10f78 in rustc_driver::driver::phase_3_run_analysis_passes::_$u7b$$u7b$closure$u7d$$u7d$::h0c96940e550f2879 ()\n   from ../arm-unknown-linux-gnueabihf/stage1/lib/librustc_driver-fe3cdf61.so\n#16 0xb6e16264 in rustc::ty::context::TyCtxt::create_and_enter::h167e75cbc44e6d50 ()\n   from ../arm-unknown-linux-gnueabihf/stage1/lib/librustc_driver-fe3cdf61.so\n#17 0xb6e0a56c in rustc_driver::driver::phase_3_run_analysis_passes::h75db68819aee0b65 ()\n   from ../arm-unknown-linux-gnueabihf/stage1/lib/librustc_driver-fe3cdf61.so\n#18 0xb6dd47b8 in rustc_driver::driver::compile_input::h5e5e4501615d7d4b ()\n   from ../arm-unknown-linux-gnueabihf/stage1/lib/librustc_driver-fe3cdf61.so\nBacktrace stopped: Cannot access memory at address 0x1d1cfff8\n```\n\n``` asm\n(gdb) disass 0xb5ccd4c8,+1\nDump of assembler code from 0xb5ccd4c8 to 0xb5ccd4c9:\n=> 0xb5ccd4c8 <_ZN11rustc_trans3mir8constant15MirConstContext3new17hfbf8e74461aa3c9aE+404>:     str     r0, [r0, r8]!\n```\n\nBefore getting that trace I had no idea it was related to MIR in any way. I'll have to give old trans a shot.\n\n**EDIT:**\nYeah, old trans chugs along without a hitch.\n", "closed_by": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/34427/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/34427/timeline", "performed_via_github_app": null, "state_reason": "completed"}