{"url": "https://api.github.com/repos/rust-lang/rust/issues/68131", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/68131/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/68131/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/68131/events", "html_url": "https://github.com/rust-lang/rust/issues/68131", "id": 548442598, "node_id": "MDU6SXNzdWU1NDg0NDI1OTg=", "number": 68131, "title": "Error message does not list the relevant trait bounds that were not satisfied", "user": {"login": "sunjay", "id": 530939, "node_id": "MDQ6VXNlcjUzMDkzOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/530939?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sunjay", "html_url": "https://github.com/sunjay", "followers_url": "https://api.github.com/users/sunjay/followers", "following_url": "https://api.github.com/users/sunjay/following{/other_user}", "gists_url": "https://api.github.com/users/sunjay/gists{/gist_id}", "starred_url": "https://api.github.com/users/sunjay/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sunjay/subscriptions", "organizations_url": "https://api.github.com/users/sunjay/orgs", "repos_url": "https://api.github.com/users/sunjay/repos", "events_url": "https://api.github.com/users/sunjay/events{/privacy}", "received_events_url": "https://api.github.com/users/sunjay/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 235791, "node_id": "MDU6TGFiZWwyMzU3OTE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-diagnostics", "name": "A-diagnostics", "color": "f7e101", "default": false, "description": "Area: Messages for errors, warnings, and lints"}, {"id": 13836860, "node_id": "MDU6TGFiZWwxMzgzNjg2MA==", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-traits", "name": "A-traits", "color": "f7e101", "default": false, "description": "Area: Trait system"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-01-11T15:27:14Z", "updated_at": "2023-04-12T03:44:37Z", "closed_at": "2020-02-29T07:27:28Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "I don't know for sure, but this feels like an interaction between method dispatch, deref, and possibly `Send`.\r\n\r\nHere's a fairly minimal reproduction of the issue: ([Playground](https://play.rust-lang.org/?version=stable&mode=debug&edition=2018&gist=10a9b2029c6060bf127ffe9e9cbb9f8b))\r\n\r\n```rust\r\nuse std::rc::Rc;\r\n\r\nuse rayon::prelude::*;\r\n\r\nfn main() {\r\n    let x = vec![Rc::new(12)];\r\n    \r\n    let y: Vec<_> = x.into_par_iter().collect();\r\n}\r\n```\r\n\r\nThe error message in question:\r\n\r\n```\r\nerror[E0599]: no method named `into_par_iter` found for type `std::vec::Vec<std::rc::Rc<{integer}>>` in the current scope\r\n --> src/main.rs:8:23\r\n  |\r\n8 |     let y: Vec<_> = x.into_par_iter().collect();\r\n  |                       ^^^^^^^^^^^^^ method not found in `std::vec::Vec<std::rc::Rc<{integer}>>`\r\n  |\r\n  = note: the method `into_par_iter` exists but the following trait bounds were not satisfied:\r\n          `[std::rc::Rc<{integer}>] : rayon::iter::IntoParallelIterator`\r\n```\r\n\r\nThe type of `x` is `Vec<Rc<i32>>`. Rayon has an impl with the following signature:\r\n\r\n```rust\r\nimpl<T: Send> IntoParallelIterator for Vec<T> { ... }\r\n```\r\n\r\nThe problem here is that `Vec<Rc<i32>>: IntoParallelIterator` is not satisfied because `Rc<i32>: Send` is not satisfied.\r\n\r\nBecause `Vec<Rc<i32>>` derefs to `[Rc<i32>]`, the error message lists that as the trait bound to be satisfied. This is very unhelpful because there is no way you could ever satisfy that constraint.\r\n\r\nWhile fixing the message to also list `Vec<Rc<i32>>` in addition to `[Rc<i32>]` would be helpful, it doesn't help solve the actual problem which is that `Rc<i32>` is not `Send`. The code I initially ran into this with had an `Rc` about ~15 structs down, so it was not obvious at all what the problem was until I looked at the relevant impl in the rayon docs and added the following to my code:\r\n\r\n```rust\r\nfn foo<T: Send>() {}\r\nfoo::<MyType>();\r\n```\r\n\r\nOnce I did that, I got a full error message that nicely lists the entire stack of obligations that led to `Send` not being fulfilled. \r\n\r\nIt would be very helpful if the compiler could tell me that `Rc<i32>: Send` is not satisfied so I could skip all of those steps. (`Rc<i32>: Send` in my minimal example, `MyType: Send` in actual code)", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/68131/reactions", "total_count": 2, "+1": 1, "-1": 0, "laugh": 0, "hooray": 1, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/68131/timeline", "performed_via_github_app": null, "state_reason": "completed"}