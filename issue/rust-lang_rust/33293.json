{"url": "https://api.github.com/repos/rust-lang/rust/issues/33293", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/33293/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/33293/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/33293/events", "html_url": "https://github.com/rust-lang/rust/issues/33293", "id": 152042793, "node_id": "MDU6SXNzdWUxNTIwNDI3OTM=", "number": 33293, "title": "ICE: \"enum pattern didn't resolve to enum or struct None\"", "user": {"login": "mboecker", "id": 14249822, "node_id": "MDQ6VXNlcjE0MjQ5ODIy", "avatar_url": "https://avatars.githubusercontent.com/u/14249822?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mboecker", "html_url": "https://github.com/mboecker", "followers_url": "https://api.github.com/users/mboecker/followers", "following_url": "https://api.github.com/users/mboecker/following{/other_user}", "gists_url": "https://api.github.com/users/mboecker/gists{/gist_id}", "starred_url": "https://api.github.com/users/mboecker/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mboecker/subscriptions", "organizations_url": "https://api.github.com/users/mboecker/orgs", "repos_url": "https://api.github.com/users/mboecker/repos", "events_url": "https://api.github.com/users/mboecker/events{/privacy}", "received_events_url": "https://api.github.com/users/mboecker/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 37544, "node_id": "MDU6TGFiZWwzNzU0NA==", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-typesystem", "name": "A-typesystem", "color": "f7e101", "default": false, "description": "Area: The type system"}, {"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}, {"id": 46741598, "node_id": "MDU6TGFiZWw0Njc0MTU5OA==", "url": "https://api.github.com/repos/rust-lang/rust/labels/E-needs-test", "name": "E-needs-test", "color": "02e10c", "default": false, "description": "Call for participation: writing correctness tests"}, {"id": 147085028, "node_id": "MDU6TGFiZWwxNDcwODUwMjg=", "url": "https://api.github.com/repos/rust-lang/rust/labels/regression-from-stable-to-nightly", "name": "regression-from-stable-to-nightly", "color": "e4008a", "default": false, "description": "Performance or correctness regression from stable to nightly."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2016-04-30T17:34:15Z", "updated_at": "2016-06-14T04:07:40Z", "closed_at": "2016-06-14T04:07:40Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi everyone,\n\nThis code caused a ICE for me.\n\n``` rust\nenum EnumA {\n    JustA(i32),\n    Same(i32)\n}\n\n/*enum EnumB {\n    JustB(i32),\n    Same(i32)\n}*/\n\nfn test() -> EnumA {\n    EnumA::JustA(2)\n}\n\nfn main() {\n    loop {\n        let p = match test() {\n            EnumA (r) => r,\n            EnumB::Same(x) => x\n        };\n    }\n}\n```\n\nThe compiler said this.\n\n```\nsrc/main.rs:58:6: 58:45 error: internal compiler error: ../src/librustc/middle/mem_categorization.rs:1265: enum pattern didn't resolve to enum or struct None\nsrc/main.rs:58                              EnumA (r) => r, => {\n                                ^~~~~~~~~~~~~~~~~~~~~~~~\nnote: the compiler unexpectedly panicked. this is a bug.\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports\nnote: run with `RUST_BACKTRACE=1` for a backtrace\nthread 'rustc' panicked at 'Box<Any>', ../src/libsyntax/errors/mod.rs:537\nstack backtrace:\n   1:     0x7f8277138610 - std::sys::backtrace::tracing::imp::write::h9fb600083204ae7f\n   2:     0x7f8277145d5b - std::panicking::default_hook::_$u7b$$u7b$closure$u7d$$u7d$::hca543c34f11229ac\n   3:     0x7f82771458fc - std::panicking::default_hook::hc2c969e7453d080c\n   4:     0x7f827710b28f - std::sys_common::unwind::begin_unwind_inner::h30e12d15ce2b2e25\n   5:     0x7f82746c7478 - std::sys_common::unwind::begin_unwind::h24c4c0fa2cfe995a\n   6:     0x7f82746c741b - syntax::errors::Handler::span_bug::h1878d6587b8bfd95\n   7:     0x7f82746c8b22 - rustc::session::opt_span_bug_fmt::_$u7b$$u7b$closure$u7d$$u7d$::hf0fb5697f8f25f40\n   8:     0x7f82746c8a12 - rustc::session::span_bug_fmt::h4591bcbadfc38558\n   9:     0x7f827475cc43 - rustc::middle::mem_categorization::MemCategorizationContext::cat_pattern_::hff665d681985439e\n  10:     0x7f827475b434 - rustc_typeck::check::regionck::link_pattern::h882c0c8cd92b31b1\n  11:     0x7f8274758049 - rustc_typeck::check::regionck::visit_expr::h30460da2fc8589c6\n  12:     0x7f8274758f7a - rustc_typeck::check::regionck::visit_local::hb6a6ae3ac5eae28f\n  13:     0x7f827475a285 - rustc::hir::intravisit::walk_expr::hf0b626b32adf4c13\n  14:     0x7f8274757f49 - rustc_typeck::check::regionck::visit_expr::h30460da2fc8589c6\n  15:     0x7f8274755956 - rustc_typeck::check::regionck::Rcx::visit_fn_body::ha2fc797207b15bdd\n  16:     0x7f82746e5d78 - rustc_typeck::check::regionck::regionck_fn::hefb39d001a6577cc\n  17:     0x7f82746e0877 - rustc_typeck::check::check_bare_fn::h7e4c2ad58d1814dd\n  18:     0x7f82746ef99f - rustc_typeck::check::check_method_body::h7863cacbf117e455\n  19:     0x7f82746daf5e - rustc_typeck::check::check_item_body::h7ffec660fc242796\n  20:     0x7f82746d2be1 - rustc_typeck::check::check_item_bodies::ha729008a2e67410e\n  21:     0x7f82746ca21f - rustc_typeck::check_crate::hb08ba31a6a5f65b5\n  22:     0x7f8277693f00 - rustc_driver::driver::phase_3_run_analysis_passes::_$u7b$$u7b$closure$u7d$$u7d$::h06c776ef4d1c70b6\n  23:     0x7f8277691f5e - rustc::ty::context::TyCtxt::create_and_enter::hb0e0e916c7274a64\n  24:     0x7f827766490d - rustc_driver::driver::compile_input::h0629572e6f316b31\n  25:     0x7f827764553c - rustc_driver::run_compiler::h8902aebf8b1849a8\n  26:     0x7f8277642c41 - std::sys_common::unwind::try::try_fn::h4c74456035d0fcc7\n  27:     0x7f8277135deb - __rust_try\n  28:     0x7f8277135d7d - std::sys_common::unwind::inner_try::h47a4d9cd4a369dcd\n  29:     0x7f827764348a - _<F as std..boxed..FnBox<A>>::call_box::h27f542a39f1d61ef\n  30:     0x7f8277143ef4 - std::sys::thread::Thread::new::thread_start::h6f266e069bf4ec2b\n  31:     0x7f826eecb423 - start_thread\n  32:     0x7f8276da2cbc - clone\n  33:                0x0 - <unknown>\n```\n\nThe bug doesn't appear in rust stable or beta, only in nightly.\n\n```\nrustc 1.10.0-nightly (8da2bcac5 2016-04-28)\nbinary: rustc\ncommit-hash: 8da2bcac5db1e091b90cceb19d0496f0f7501c88\ncommit-date: 2016-04-28\nhost: x86_64-unknown-linux-gnu\nrelease: 1.10.0-nightly\n```\n\nedit: used minimal example instead of my code.\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/33293/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/33293/timeline", "performed_via_github_app": null, "state_reason": "completed"}