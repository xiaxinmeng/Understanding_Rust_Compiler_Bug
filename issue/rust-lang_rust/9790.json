{"url": "https://api.github.com/repos/rust-lang/rust/issues/9790", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/9790/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/9790/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/9790/events", "html_url": "https://github.com/rust-lang/rust/issues/9790", "id": 20784399, "node_id": "MDU6SXNzdWUyMDc4NDM5OQ==", "number": 9790, "title": "Reexported private functions cause linker errors", "user": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 234956, "node_id": "MDU6TGFiZWwyMzQ5NTY=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-codegen", "name": "A-codegen", "color": "f7e101", "default": false, "description": "Area: Code generation"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2013-10-10T02:40:29Z", "updated_at": "2013-10-24T15:02:31Z", "closed_at": "2013-10-10T14:11:25Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "If you have a library with this code:\n\n``` rust\npub use foo::bar;\n\nmod foo {\n  pub fn bar() {}\n}\n```\n\nNo one can use the `bar` function at the top-level. The reason for this is that we mark the function with an `inline` linkage, and LLVM then internalizes the symbol so no one else can use it.\n\nAfter some digging, it looks like this is because it is not flagged as \"reachable\" in the reachability pass of the compiler. After taking a look at the code, the reachability pass is doing a lot of approximations about privacy, and it's not taking public re-exports into account.\n\nI believe that the best solution is to instead use the output of the privacy pass of the compiler to initially seed the work list of the reachability pass. Reachability should know nothing about privacy, it should only have to perform the iterations necessary to create a set of reachable items from public items.\n", "closed_by": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/9790/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/9790/timeline", "performed_via_github_app": null, "state_reason": "completed"}