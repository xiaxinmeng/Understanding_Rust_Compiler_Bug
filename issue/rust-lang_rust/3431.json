{"url": "https://api.github.com/repos/rust-lang/rust/issues/3431", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/3431/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/3431/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/3431/events", "html_url": "https://github.com/rust-lang/rust/issues/3431", "id": 6738142, "node_id": "MDU6SXNzdWU2NzM4MTQy", "number": 3431, "title": "Parallelize some phases of compilation between a crate and its dependency", "user": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 234876, "node_id": "MDU6TGFiZWwyMzQ4NzY=", "url": "https://api.github.com/repos/rust-lang/rust/labels/E-hard", "name": "E-hard", "color": "02e10c", "default": false, "description": "Call for participation: Experience needed to fix: Hard / a lot"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2012-09-08T22:00:25Z", "updated_at": "2015-01-21T01:30:55Z", "closed_at": "2015-01-21T01:30:55Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "With a single driver building multiple crates we can start running more parts of the compilation process in parallel.\n\nThe basic idea is to output the metadata about a crate before code generation so that the next compile can proceed based on that metadata.\n\nrustc gets modified in a few ways:\n- Just before trans we serialize the bulk of the metadata and insert a hook to give the multi-crate driver an opportunity to copy it to another task to begin the next compilation phase.  There will still be some metadata that needs to be serialized after trans.\n- Insert another hook into crate resulotion for reading the metadata binary. The multi-crate driver will use this to receive the metadata output from previous crates and feed them to the next crates.\n\nThe end result is that parsing and analysis will be largely done in parallel with code generation for multi-crate builds.\n\nBeyond that we can also parse all crates in parallel.\n\nThis would require that we make sure we are using LLVM in a threadsafe way, unless we can get all the trans passes onto a single thread.\n\nRelated to #2237\n", "closed_by": {"login": "steveklabnik", "id": 27786, "node_id": "MDQ6VXNlcjI3Nzg2", "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/steveklabnik", "html_url": "https://github.com/steveklabnik", "followers_url": "https://api.github.com/users/steveklabnik/followers", "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}", "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}", "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions", "organizations_url": "https://api.github.com/users/steveklabnik/orgs", "repos_url": "https://api.github.com/users/steveklabnik/repos", "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}", "received_events_url": "https://api.github.com/users/steveklabnik/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/3431/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/3431/timeline", "performed_via_github_app": null, "state_reason": "completed"}