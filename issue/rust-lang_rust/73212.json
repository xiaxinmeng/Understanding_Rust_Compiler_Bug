{"url": "https://api.github.com/repos/rust-lang/rust/issues/73212", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/73212/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/73212/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/73212/events", "html_url": "https://github.com/rust-lang/rust/issues/73212", "id": 636217502, "node_id": "MDU6SXNzdWU2MzYyMTc1MDI=", "number": 73212, "title": "possible infinite loop in sys::windows::fill_utf16_buf", "user": {"login": "rkuhn", "id": 470469, "node_id": "MDQ6VXNlcjQ3MDQ2OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/470469?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rkuhn", "html_url": "https://github.com/rkuhn", "followers_url": "https://api.github.com/users/rkuhn/followers", "following_url": "https://api.github.com/users/rkuhn/following{/other_user}", "gists_url": "https://api.github.com/users/rkuhn/gists{/gist_id}", "starred_url": "https://api.github.com/users/rkuhn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rkuhn/subscriptions", "organizations_url": "https://api.github.com/users/rkuhn/orgs", "repos_url": "https://api.github.com/users/rkuhn/repos", "events_url": "https://api.github.com/users/rkuhn/events{/privacy}", "received_events_url": "https://api.github.com/users/rkuhn/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 123109, "node_id": "MDU6TGFiZWwxMjMxMDk=", "url": "https://api.github.com/repos/rust-lang/rust/labels/O-windows", "name": "O-windows", "color": "6e6ec0", "default": false, "description": "Operating system: Windows"}, {"id": 2011781731, "node_id": "MDU6TGFiZWwyMDExNzgxNzMx", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-libs", "name": "T-libs", "color": "bfd4f2", "default": false, "description": "Relevant to the library team, which will review and decide on the PR/issue."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2020-06-10T12:47:27Z", "updated_at": "2022-03-09T08:58:49Z", "closed_at": "2022-03-09T08:58:49Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Looking at [the code](https://github.com/rust-lang/rust/blob/master/src/libstd/sys/windows/mod.rs#L157) without prior knowledge of Windows system call semantics, I see an infinite loop if the syscall were to fill up the buffer exactly: when k == n on line 195, the loop will be rerun with no changes, which should result in the exact same outcome if the syscall is idempotent.\r\n\r\nEven if Windows guarantees in some way that this cannot happen, would it not be clearer to handle this case in an obvious fashion?", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/73212/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/73212/timeline", "performed_via_github_app": null, "state_reason": "completed"}