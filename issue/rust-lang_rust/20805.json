{"url": "https://api.github.com/repos/rust-lang/rust/issues/20805", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/20805/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/20805/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/20805/events", "html_url": "https://github.com/rust-lang/rust/issues/20805", "id": 53874263, "node_id": "MDU6SXNzdWU1Mzg3NDI2Mw==", "number": 20805, "title": "ICE When trying to build the rust opencl binding", "user": {"login": "caryhaynie", "id": 24828, "node_id": "MDQ6VXNlcjI0ODI4", "avatar_url": "https://avatars.githubusercontent.com/u/24828?v=4", "gravatar_id": "", "url": "https://api.github.com/users/caryhaynie", "html_url": "https://github.com/caryhaynie", "followers_url": "https://api.github.com/users/caryhaynie/followers", "following_url": "https://api.github.com/users/caryhaynie/following{/other_user}", "gists_url": "https://api.github.com/users/caryhaynie/gists{/gist_id}", "starred_url": "https://api.github.com/users/caryhaynie/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/caryhaynie/subscriptions", "organizations_url": "https://api.github.com/users/caryhaynie/orgs", "repos_url": "https://api.github.com/users/caryhaynie/repos", "events_url": "https://api.github.com/users/caryhaynie/events{/privacy}", "received_events_url": "https://api.github.com/users/caryhaynie/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2015-01-09T14:43:20Z", "updated_at": "2015-02-05T20:33:49Z", "closed_at": "2015-02-05T20:33:49Z", "author_association": "NONE", "active_lock_reason": null, "body": "While trying to update rust-opencl to build against the latest rust nightly, I ran in to the following:\n\n/Users/cary/rust-opencl/src/hl.rs:456:29: 469:18 error: internal compiler error: aliasability violation with closure\n/Users/cary/rust-opencl/src/hl.rs:456                 write.write(|&: offset, p, len| {\n/Users/cary/rust-opencl/src/hl.rs:457                     let mut e: cl_event = ptr::null_mut();\n/Users/cary/rust-opencl/src/hl.rs:458                     let err = clEnqueueWriteBuffer(self.cqueue,\n/Users/cary/rust-opencl/src/hl.rs:459                                                    mem.id(),\n/Users/cary/rust-opencl/src/hl.rs:460                                                    CL_FALSE,\n/Users/cary/rust-opencl/src/hl.rs:461                                                    offset as libc::size_t,\n                                      ...\nnote: the compiler unexpectedly panicked. this is a bug.\nnote: we would appreciate a bug report: http://doc.rust-lang.org/complement-bugreport.html\nnote: run with `RUST_BACKTRACE=1` for a backtrace\nthread 'rustc' panicked at 'Box<Any>', /Users/rustbuild/src/rust-buildbot/slave/nightly-dist-rustc-mac/build/src/libsyntax/diagnostic.rs:123\n\nstack backtrace:\n   1:        0x11314b4b5 - sys::backtrace::write::h64ca2fb259c4ae97lCt\n   2:        0x11316d94f - failure::on_fail::h64ff5ae6887860cc0Hz\n   3:        0x1130d95ca - rt::unwind::begin_unwind_inner::h1d4bc098fd350446Qpz\n   4:        0x110de30b7 - rt::unwind::begin_unwind::h1123425023578864118\n   5:        0x110de304c - diagnostic::SpanHandler::span_bug::he8deb1e61e0360e4nQF\n   6:        0x11020d9cd - session::Session::span_bug::h67200d92e3673ccdYQq\n   7:        0x10fe07031 - borrowck::BorrowckCtxt<'a, 'tcx>::report_aliasability_violation::h5042d69593442126B4f\n   8:        0x10fe0e963 - borrowck::gather_loans::check_aliasability::h21b570198b22ae04Fvc\n   9:        0x10fe0cde3 - borrowck::gather_loans::GatherLoanCtxt<'a, 'tcx>.euv..Delegate<'tcx>::borrow::h841515cb9f354927pqc\n  10:        0x10fdfeacd - middle::expr_use_visitor::ExprUseVisitor<'d, 't, 'tcx, TYPER>::walk_captures::unboxed_closure.13810\n  11:        0x10fdfa65d - middle::expr_use_visitor::ExprUseVisitor<'d, 't, 'tcx, TYPER>::walk_expr::h13689288423279767843\n  12:        0x10fdfe361 - middle::expr_use_visitor::ExprUseVisitor<'d, 't, 'tcx, TYPER>::consume_expr::h15590379015244547509\n  13:        0x10fdf97ff - middle::expr_use_visitor::ExprUseVisitor<'d, 't, 'tcx, TYPER>::walk_expr::h13689288423279767843\n  14:        0x10fdfe361 - middle::expr_use_visitor::ExprUseVisitor<'d, 't, 'tcx, TYPER>::consume_expr::h15590379015244547509\n  15:        0x10fdf908b - middle::expr_use_visitor::ExprUseVisitor<'d, 't, 'tcx, TYPER>::walk_block::h12567878441358035813\n  16:        0x10fdf949f - middle::expr_use_visitor::ExprUseVisitor<'d, 't, 'tcx, TYPER>::walk_expr::h13689288423279767843\n  17:        0x10fdfe361 - middle::expr_use_visitor::ExprUseVisitor<'d, 't, 'tcx, TYPER>::consume_expr::h15590379015244547509\n  18:        0x10fdf908b - middle::expr_use_visitor::ExprUseVisitor<'d, 't, 'tcx, TYPER>::walk_block::h12567878441358035813\n  19:        0x10fe24318 - borrowck::build_borrowck_dataflow_data::hfa09ea6d1940ae40QRe\n  20:        0x10fe20d6b - borrowck::borrowck_fn::h53d8931196ae5f75cPe\n  21:        0x10fe22f87 - visit::walk_expr::h4659549509342750598\n  22:        0x10fe22e02 - visit::walk_expr::h4659549509342750598\n  23:        0x10fe231f2 - visit::walk_block::h10475317576522808201\n  24:        0x10fe215fc - borrowck::borrowck_fn::h53d8931196ae5f75cPe\n  25:        0x10fe23cae - visit::walk_method_helper::h2285262828809068003\n  26:        0x10fe21f2c - borrowck::borrowck_item::hb33a72754e4746199Ne\n  27:        0x10fe225cf - visit::walk_mod::h12679472845435306486\n  28:        0x10fe2208f - borrowck::check_crate::h0953eedb9233150cZIe\n  29:        0x10f97aeaa - driver::phase_3_run_analysis_passes::h4c5cf0d8fe5d55degwa\n  30:        0x10f95f420 - driver::compile_input::h31580cbd7ea87613xba\n  31:        0x10fa2afda - monitor::unboxed_closure.22557\n  32:        0x10fa29735 - thunk::F.Invoke<A, R>::invoke::h6367419564961841226\n  33:        0x10fa28510 - rt::unwind::try::try_fn::h7763956589852599824\n  34:        0x1131d42a9 - rust_try_inner\n  35:        0x1131d4296 - rust_try\n  36:        0x10fa28c0c - thunk::F.Invoke<A, R>::invoke::h16724184168577887652\n  37:        0x11315b154 - sys::thread::thread_start::hbd8f2f8bdd3a3baadrw\n  38:     0x7fff91bd4899 - _pthread_body\n  39:     0x7fff91bd472a - _pthread_struct_init\n\nCould not compile `opencl`.\n\nrustc info:\n\nrustc 1.0.0-nightly (44a287e6e 2015-01-08 17:03:40 -0800)\nbinary: rustc\ncommit-hash: 44a287e6eb22ec3c2a687fc156813577464017f7\ncommit-date: 2015-01-08 17:03:40 -0800\nhost: x86_64-apple-darwin\nrelease: 1.0.0-nightly\n", "closed_by": {"login": "caryhaynie", "id": 24828, "node_id": "MDQ6VXNlcjI0ODI4", "avatar_url": "https://avatars.githubusercontent.com/u/24828?v=4", "gravatar_id": "", "url": "https://api.github.com/users/caryhaynie", "html_url": "https://github.com/caryhaynie", "followers_url": "https://api.github.com/users/caryhaynie/followers", "following_url": "https://api.github.com/users/caryhaynie/following{/other_user}", "gists_url": "https://api.github.com/users/caryhaynie/gists{/gist_id}", "starred_url": "https://api.github.com/users/caryhaynie/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/caryhaynie/subscriptions", "organizations_url": "https://api.github.com/users/caryhaynie/orgs", "repos_url": "https://api.github.com/users/caryhaynie/repos", "events_url": "https://api.github.com/users/caryhaynie/events{/privacy}", "received_events_url": "https://api.github.com/users/caryhaynie/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/20805/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/20805/timeline", "performed_via_github_app": null, "state_reason": "completed"}