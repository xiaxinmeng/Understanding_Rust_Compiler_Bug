{"url": "https://api.github.com/repos/rust-lang/rust/issues/91632", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/91632/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/91632/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/91632/events", "html_url": "https://github.com/rust-lang/rust/issues/91632", "id": 1073506199, "node_id": "I_kwDOAAsO6M4__GeX", "number": 91632, "title": "Tracking Issue for `deprecated_cfg_attr_crate_type_name` lint", "user": {"login": "bjorn3", "id": 17426603, "node_id": "MDQ6VXNlcjE3NDI2NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/17426603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bjorn3", "html_url": "https://github.com/bjorn3", "followers_url": "https://api.github.com/users/bjorn3/followers", "following_url": "https://api.github.com/users/bjorn3/following{/other_user}", "gists_url": "https://api.github.com/users/bjorn3/gists{/gist_id}", "starred_url": "https://api.github.com/users/bjorn3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bjorn3/subscriptions", "organizations_url": "https://api.github.com/users/bjorn3/orgs", "repos_url": "https://api.github.com/users/bjorn3/repos", "events_url": "https://api.github.com/users/bjorn3/events{/privacy}", "received_events_url": "https://api.github.com/users/bjorn3/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 630636017, "node_id": "MDU6TGFiZWw2MzA2MzYwMTc=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-future-compatibility", "name": "C-future-compatibility", "color": "f5f1fd", "default": false, "description": "Category: future compatibility lints"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2021-12-07T15:47:01Z", "updated_at": "2023-06-15T15:45:29Z", "closed_at": null, "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "### What is this lint about\r\n\r\nThe `deprecated_cfg_attr_crate_type_name` lint detects uses of the `#![cfg_attr(..., crate_type = \"...\")]` and `#![cfg_attr(..., crate_name = \"...\")]` attributes to conditionally specify the crate type and name in the source code. For example:\r\n\r\n```rust\r\n#![cfg_attr(debug_assertions, crate_type = \"lib\")]\r\n```\r\n\r\n### Explanation\r\n\r\nThe `#![crate_type]` and `#![crate_name]` attributes require a hack in the compiler to be able to change the used crate type and crate name after macros have been expanded. Neither attribute works in combination with Cargo as it explicitly passes `--crate-type` and `--crate-name` on the commandline. These values must match the value used in the source code to prevent an error.\r\n\r\n### How to fix this warning/error\r\n\r\nTo fix the warning use `--crate-type` on the commandline when running rustc instead of `#![cfg_attr(..., crate_type = \"...\")]` and `--crate-name` instead of `#![cfg_attr(..., crate_name = \"...\")]`.\r\n\r\nWe are interested to hear about any/all use cases for conditional `#![crate_type]` and `#![crate_name]` attributes.\r\n\r\n### Current status\r\n* [x] https://github.com/rust-lang/rust/pull/83744 introduces the `deprecated_cfg_attr_crate_type_name` lint as warn-by-default\r\n* [ ] PR ? makes the `deprecated_cfg_attr_crate_type_name` lint deny-by-default\r\n* [ ] PR ? makes the `deprecated_cfg_attr_crate_type_name` lint a hard error", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/91632/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/91632/timeline", "performed_via_github_app": null, "state_reason": null}