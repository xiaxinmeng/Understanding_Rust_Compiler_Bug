{"url": "https://api.github.com/repos/rust-lang/rust/issues/8647", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/8647/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/8647/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/8647/events", "html_url": "https://github.com/rust-lang/rust/issues/8647", "id": 18311337, "node_id": "MDU6SXNzdWUxODMxMTMzNw==", "number": 8647, "title": "Rust fails to recognize libraries compiled with --link-args=-Wl,--gc-sections", "user": {"login": "mstewartgallus", "id": 4070335, "node_id": "MDQ6VXNlcjQwNzAzMzU=", "avatar_url": "https://avatars.githubusercontent.com/u/4070335?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mstewartgallus", "html_url": "https://github.com/mstewartgallus", "followers_url": "https://api.github.com/users/mstewartgallus/followers", "following_url": "https://api.github.com/users/mstewartgallus/following{/other_user}", "gists_url": "https://api.github.com/users/mstewartgallus/gists{/gist_id}", "starred_url": "https://api.github.com/users/mstewartgallus/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mstewartgallus/subscriptions", "organizations_url": "https://api.github.com/users/mstewartgallus/orgs", "repos_url": "https://api.github.com/users/mstewartgallus/repos", "events_url": "https://api.github.com/users/mstewartgallus/events{/privacy}", "received_events_url": "https://api.github.com/users/mstewartgallus/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2013-08-20T18:07:04Z", "updated_at": "2013-12-18T23:25:38Z", "closed_at": "2013-12-18T23:25:38Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Rust fails to recognize libraries compiled with `--link-args=-Wl,--gc-sections`, and errors out saying that the requested library is not found when someone attempts to use such a library. The `--gc-sections` option is useful for shaving a few bytes of a library. Unfortunately, the `-Z print-link-args` option does not work so I can't really debug the problem further.\n\nMy thoughts on this bug. Does `rustc` use the -r option? Is this problem the result of Rust's meta-data being garbage collected? Would tools other than `ld` not recognize the meta-data, and also strip it?\n\nGNU `ld`'s documentation on this option:\n\n```\n   --gc-sections\n   --no-gc-sections\n       Enable garbage collection of unused input sections.  It is ignored on\n       targets that do not support this option.  The default behaviour (of not\n       performing this garbage collection) can be restored by specifying\n       --no-gc-sections on the command line.\n\n       --gc-sections decides which input sections are used by examining\n       symbols and relocations.  The section containing the entry symbol and\n       all sections containing symbols undefined on the command-line will be\n       kept, as will sections containing symbols referenced by dynamic\n       objects.  Note that when building shared libraries, the linker must\n       assume that any visible symbol is referenced.  Once this initial set of\n       sections has been determined, the linker recursively marks as used any\n       section referenced by their relocations.  See --entry and --undefined.\n\n       This option can be set when doing a partial link (enabled with option\n       -r).  In this case the root of symbols kept must be explicitly\n       specified either by an --entry or --undefined option or by a \"ENTRY\"\n       command in the linker script.\n```\n", "closed_by": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/8647/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/8647/timeline", "performed_via_github_app": null, "state_reason": "completed"}