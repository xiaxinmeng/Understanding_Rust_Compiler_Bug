{"url": "https://api.github.com/repos/rust-lang/rust/issues/88959", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/88959/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/88959/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/88959/events", "html_url": "https://github.com/rust-lang/rust/issues/88959", "id": 996820096, "node_id": "I_kwDOAAsO6M47akSA", "number": 88959, "title": "Unstable code formatting involving some macros (every rustfmt run indents some lines further)", "user": {"login": "chris-morgan", "id": 392868, "node_id": "MDQ6VXNlcjM5Mjg2OA==", "avatar_url": "https://avatars.githubusercontent.com/u/392868?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chris-morgan", "html_url": "https://github.com/chris-morgan", "followers_url": "https://api.github.com/users/chris-morgan/followers", "following_url": "https://api.github.com/users/chris-morgan/following{/other_user}", "gists_url": "https://api.github.com/users/chris-morgan/gists{/gist_id}", "starred_url": "https://api.github.com/users/chris-morgan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chris-morgan/subscriptions", "organizations_url": "https://api.github.com/users/chris-morgan/orgs", "repos_url": "https://api.github.com/users/chris-morgan/repos", "events_url": "https://api.github.com/users/chris-morgan/events{/privacy}", "received_events_url": "https://api.github.com/users/chris-morgan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-09-15T08:48:28Z", "updated_at": "2021-09-15T08:53:26Z", "closed_at": "2021-09-15T08:53:25Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Sample code, minimised as far as I was able:\r\n\r\n```rust\r\nmacro_rules! alpha {\r\n    () => {\r\n        macro_rules! beta {\r\n            () => {\r\n                gamma!(\r\n                    *\r\n                )\r\n            };\r\n        }\r\n    };\r\n}\r\n```\r\n\r\nEvery time you run rustfmt over it, it indents lines 4\u20139 by another two levels.\r\n\r\nClosely related, if you remove the first and last two lines (the outer macro_rules layer), formatting leaves lines 4\u20139 at whatever level it finds them rather than correcting their indentation. (But this is probably better than indenting them by two levels.)\r\n\r\nReproduced on rustc 1.57.0-nightly (c3c0f80d6 2021-09-14).", "closed_by": {"login": "chris-morgan", "id": 392868, "node_id": "MDQ6VXNlcjM5Mjg2OA==", "avatar_url": "https://avatars.githubusercontent.com/u/392868?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chris-morgan", "html_url": "https://github.com/chris-morgan", "followers_url": "https://api.github.com/users/chris-morgan/followers", "following_url": "https://api.github.com/users/chris-morgan/following{/other_user}", "gists_url": "https://api.github.com/users/chris-morgan/gists{/gist_id}", "starred_url": "https://api.github.com/users/chris-morgan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chris-morgan/subscriptions", "organizations_url": "https://api.github.com/users/chris-morgan/orgs", "repos_url": "https://api.github.com/users/chris-morgan/repos", "events_url": "https://api.github.com/users/chris-morgan/events{/privacy}", "received_events_url": "https://api.github.com/users/chris-morgan/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/88959/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/88959/timeline", "performed_via_github_app": null, "state_reason": "completed"}