{"url": "https://api.github.com/repos/rust-lang/rust/issues/23896", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/23896/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/23896/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/23896/events", "html_url": "https://github.com/rust-lang/rust/issues/23896", "id": 65494064, "node_id": "MDU6SXNzdWU2NTQ5NDA2NA==", "number": 23896, "title": "Panic at diverging closure", "user": {"login": "etzih", "id": 3044205, "node_id": "MDQ6VXNlcjMwNDQyMDU=", "avatar_url": "https://avatars.githubusercontent.com/u/3044205?v=4", "gravatar_id": "", "url": "https://api.github.com/users/etzih", "html_url": "https://github.com/etzih", "followers_url": "https://api.github.com/users/etzih/followers", "following_url": "https://api.github.com/users/etzih/following{/other_user}", "gists_url": "https://api.github.com/users/etzih/gists{/gist_id}", "starred_url": "https://api.github.com/users/etzih/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/etzih/subscriptions", "organizations_url": "https://api.github.com/users/etzih/orgs", "repos_url": "https://api.github.com/users/etzih/repos", "events_url": "https://api.github.com/users/etzih/events{/privacy}", "received_events_url": "https://api.github.com/users/etzih/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2015-03-31T16:34:59Z", "updated_at": "2015-04-12T06:48:31Z", "closed_at": "2015-04-12T06:48:31Z", "author_association": "NONE", "active_lock_reason": null, "body": "Compiler panics, when closure marked as diverging.\n\nI tried this code:\n\n``` rust\nfn main() {\n    let func = || -> ! {\n        panic!(\"test\");\n    };\n\n    func();\n}\n```\n\nI expected to see this happen:\n`thread '<main>' panicked at 'test', main.rs:3`\n\nInstead, this happened:\n\n```\nerror: internal compiler error: unexpected panic\nnote: the compiler unexpectedly panicked. this is a bug.\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports\nnote: run with `RUST_BACKTRACE=1` for a backtrace\nthread 'rustc' panicked at 'internal error: entered unreachable code', C:\\bot\\slave\\beta-dist-rustc-win-32\\build\\src\\librustc\\middle\\ty.rs:1088\n```\n## Meta\n\n`rustc --version --verbose`:\n\n```\nrustc 1.0.0-alpha.2 (522d09dfe 2015-02-19) (built 2015-02-19)\nbinary: rustc\ncommit-hash: 522d09dfecbeca1595f25ac58c6d0178bbd21d7d\ncommit-date: 2015-02-19\nbuild-date: 2015-02-19\nhost: i686-pc-windows-gnu\nrelease: 1.0.0-alpha.2\n```\n\nBacktrace:\n\n```\nstack backtrace:\n   1: 0x62f706a7 - rt::unwind::register::h61bf8db6d89830a2xGL\n   2: 0x62ec3a91 - rt::unwind::begin_unwind_inner::hb93ad32a7f9eec98PDL\n   3:   0xca9420 - middle::astencode::encode_inlined_item::hbb0898a0ea507db5fla\n   4:  0x100ae99 - middle::traits::select::SelectionContext<'cx, 'tcx>::closure_typer::h5815704569a77a945gS\n   5:  0x1021601 - middle::ty::Substs<'tcx>.RegionEscape::has_regions_escaping_depth::hb5bbdeee412b4240Sjc\n   6:  0x101fc88 - middle::ty::TraitPredicate<'tcx>.RegionEscape::has_regions_escaping_depth::h63d69ae8c3d430935oc\n   7:  0x102ef1e - middle::traits::util::upcast::hbfb8155945f6c7edBuV\n   8:  0x1022f3a - middle::traits::select::Option<&'o TraitObligationStack<'o, 'tcx>>.Iterator::next::h1dff8928a58b2b972bV\n   9:  0x10229b9 - middle::ty::Substs<'tcx>.RegionEscape::has_regions_escaping_depth::hb5bbdeee412b4240Sjc\n  10:  0x1021e94 - middle::ty::Substs<'tcx>.RegionEscape::has_regions_escaping_depth::hb5bbdeee412b4240Sjc\n  11:   0xfdf089 - middle::traits::select::SelectionContext<'cx, 'tcx>::evaluate_obligation::h60ef277e877d3b76cmS\n  12:  0x1a887a0 - check::method::CandidateSource...std..cmp..PartialOrd::ge::h57d5bd3c854b368aBPj\n  13:  0x1abc6e6 - check::callee::CallResolution<'tcx>.DeferredCallResolution<'tcx>::resolve::hfdb248d104b05eefZGm\n  14:  0x1abbb48 - check::callee::CallResolution<'tcx>.DeferredCallResolution<'tcx>::resolve::hfdb248d104b05eefZGm\n  15:  0x1a98185 - check::upvar::AdjustBorrowKind<'a, 'tcx>.Visitor<'v>::visit_fn::h7731bf4220fc54b6QQk\n  16:  0x1a96890 - check::upvar::SeedBorrowKind<'a, 'tcx>.Visitor<'v>::visit_fn::h7bc74301e5fbc5eePnk\n  17:  0x1a95f29 - check::upvar::SeedBorrowKind<'a, 'tcx>.Visitor<'v>::visit_fn::h7bc74301e5fbc5eePnk\n  18:  0x48ad2e0\n  19:  0x488f770\n```\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/23896/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/23896/timeline", "performed_via_github_app": null, "state_reason": "completed"}