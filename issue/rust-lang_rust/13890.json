{"url": "https://api.github.com/repos/rust-lang/rust/issues/13890", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/13890/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/13890/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/13890/events", "html_url": "https://github.com/rust-lang/rust/issues/13890", "id": 32668114, "node_id": "MDU6SXNzdWUzMjY2ODExNA==", "number": 13890, "title": "rustc doesn't handle relative symlinks to libraries", "user": {"login": "yuriks", "id": 341401, "node_id": "MDQ6VXNlcjM0MTQwMQ==", "avatar_url": "https://avatars.githubusercontent.com/u/341401?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yuriks", "html_url": "https://github.com/yuriks", "followers_url": "https://api.github.com/users/yuriks/followers", "following_url": "https://api.github.com/users/yuriks/following{/other_user}", "gists_url": "https://api.github.com/users/yuriks/gists{/gist_id}", "starred_url": "https://api.github.com/users/yuriks/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yuriks/subscriptions", "organizations_url": "https://api.github.com/users/yuriks/orgs", "repos_url": "https://api.github.com/users/yuriks/repos", "events_url": "https://api.github.com/users/yuriks/events{/privacy}", "received_events_url": "https://api.github.com/users/yuriks/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2014-05-02T04:59:53Z", "updated_at": "2014-05-09T14:02:24Z", "closed_at": "2014-05-03T15:01:50Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "When rustc searches for libraries and encounters a symlink, instead of directly opening the link, it uses `readlink` and then uses the resulting path relative to cwd instead of relative to the link, causing it to fail to find the file.\n\nThe problem can be seen in the following excerpt from the output of `strace` on `rustc`:\n\n```\n...\n[pid  2359] openat(AT_FDCWD, \"/home/yuriks/projects/distrocast/.rust/lib/x86_64-unknown-linux-gnu\", O_RDONLY|O_NONBLOCK|O_DIRECTORY|O_CLOEXEC) = 3\n[pid  2359] getdents(3, /* 3 entries */, 32768) = 104\n[pid  2359] getdents(3, /* 0 entries */, 32768) = 0\n[pid  2359] close(3)                    = 0\n[pid  2359] readlink(\"/home/yuriks/projects/distrocast/.rust/lib/x86_64-unknown-linux-gnu/librust-crypto-c53dba27-0.1.rlib\", \"../../../rust-crypto/librust-cry\"..., 4096) = 53\n[pid  2359] stat(\"../../../rust-crypto/librust-crypto-c53dba27-0.1.rlib\", 0x7fd1ba017980) = -1 ENOENT (No such file or directory)\n[pid  2359] write(2, \"client.rs:5:1: 5:37 error: can't\"..., 57client.rs:5:1: 5:37 error: can't find crate for `crypto`\n...\n```\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/13890/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/13890/timeline", "performed_via_github_app": null, "state_reason": "completed"}