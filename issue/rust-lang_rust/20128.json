{"url": "https://api.github.com/repos/rust-lang/rust/issues/20128", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/20128/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/20128/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/20128/events", "html_url": "https://github.com/rust-lang/rust/issues/20128", "id": 52637825, "node_id": "MDU6SXNzdWU1MjYzNzgyNQ==", "number": 20128, "title": "`box try!(MyStruct::new()) as Box<MyTrait>` no longer works without being put on separate lines", "user": {"login": "daboross", "id": 1152146, "node_id": "MDQ6VXNlcjExNTIxNDY=", "avatar_url": "https://avatars.githubusercontent.com/u/1152146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/daboross", "html_url": "https://github.com/daboross", "followers_url": "https://api.github.com/users/daboross/followers", "following_url": "https://api.github.com/users/daboross/following{/other_user}", "gists_url": "https://api.github.com/users/daboross/gists{/gist_id}", "starred_url": "https://api.github.com/users/daboross/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/daboross/subscriptions", "organizations_url": "https://api.github.com/users/daboross/orgs", "repos_url": "https://api.github.com/users/daboross/repos", "events_url": "https://api.github.com/users/daboross/events{/privacy}", "received_events_url": "https://api.github.com/users/daboross/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2014-12-22T10:39:16Z", "updated_at": "2014-12-25T08:50:50Z", "closed_at": "2014-12-25T08:50:50Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "This code worked on the nightly from the 18th, and is broken by the nightly on the 21st.\n\nLast nightly working version: `rustc 0.13.0-nightly (2a231594c 2014-12-18 12:21:57 +0000)`\nFirst nightly broken version: `rustc 0.13.0-nightly (cc19e3380 2014-12-20 20:00:36 +0000)`\n\nHere's the full error:\n\n```\n<std macros>:4:24: 4:27 error: mismatched types: expected `MyTrait + 'static`, found `MyStruct` (expected trait MyTrait, found struct MyStruct)\n<std macros>:4             Ok(val) => val,\n                                      ^~~\n<std macros>:1:1: 8:2 note: in expansion of try!\nsrc/main.rs:16:21: 16:45 note: expansion site\nsrc/main.rs:16:17: 16:68 error: the trait `core::kinds::Sized` is not implemented for the type `MyTrait + 'static`\nsrc/main.rs:16     let boxed = box try!(MyStruct::new()) as Box<MyTrait + 'static>;\n                               ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nsrc/main.rs:16:17: 16:68 note: only sized types can be made into objects\nsrc/main.rs:16     let boxed = box try!(MyStruct::new()) as Box<MyTrait + 'static>;\n                               ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nsrc/main.rs:16:17: 16:68 error: the trait `MyTrait` is not implemented for the type `MyTrait + 'static`\nsrc/main.rs:16     let boxed = box try!(MyStruct::new()) as Box<MyTrait + 'static>;\n                               ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nsrc/main.rs:16:17: 16:68 note: required for the cast to the object type `MyTrait + 'static`\nsrc/main.rs:16     let boxed = box try!(MyStruct::new()) as Box<MyTrait + 'static>;\n                               ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nerror: aborting due to 3 previous errors\n```\n\nHere's the code producing the above error:\n\n```\ntrait MyTrait {}\n\nstruct MyStruct;\n\nimpl MyStruct {\n    fn new() -> Result<MyStruct, String> {\n        return Ok(MyStruct);\n    }\n}\n\nimpl MyTrait for MyStruct {}\n\n/// This used to work, and doesn't work anymore\nfn get1() -> Result<Box<MyTrait + 'static>, String> {\n    let boxed = box try!(MyStruct::new()) as Box<MyTrait + 'static>;\n\n    return Ok(boxed);\n}\n\n/// This works fine\nfn get2() -> Result<Box<MyTrait + 'static>, String> {\n    let thing = box try!(MyStruct::new());\n    let boxed = thing as Box<MyTrait + 'static>;\n\n    return Ok(boxed);\n}\n\nfn main() {}\n```\n\nRust playpen: http://is.gd/JNqrmN\n", "closed_by": {"login": "daboross", "id": 1152146, "node_id": "MDQ6VXNlcjExNTIxNDY=", "avatar_url": "https://avatars.githubusercontent.com/u/1152146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/daboross", "html_url": "https://github.com/daboross", "followers_url": "https://api.github.com/users/daboross/followers", "following_url": "https://api.github.com/users/daboross/following{/other_user}", "gists_url": "https://api.github.com/users/daboross/gists{/gist_id}", "starred_url": "https://api.github.com/users/daboross/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/daboross/subscriptions", "organizations_url": "https://api.github.com/users/daboross/orgs", "repos_url": "https://api.github.com/users/daboross/repos", "events_url": "https://api.github.com/users/daboross/events{/privacy}", "received_events_url": "https://api.github.com/users/daboross/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/20128/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/20128/timeline", "performed_via_github_app": null, "state_reason": "completed"}