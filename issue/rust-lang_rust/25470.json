{"url": "https://api.github.com/repos/rust-lang/rust/issues/25470", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/25470/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/25470/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/25470/events", "html_url": "https://github.com/rust-lang/rust/issues/25470", "id": 76910208, "node_id": "MDU6SXNzdWU3NjkxMDIwOA==", "number": 25470, "title": "ICE: &[str] in function signature", "user": {"login": "coventry", "id": 70152, "node_id": "MDQ6VXNlcjcwMTUy", "avatar_url": "https://avatars.githubusercontent.com/u/70152?v=4", "gravatar_id": "", "url": "https://api.github.com/users/coventry", "html_url": "https://github.com/coventry", "followers_url": "https://api.github.com/users/coventry/followers", "following_url": "https://api.github.com/users/coventry/following{/other_user}", "gists_url": "https://api.github.com/users/coventry/gists{/gist_id}", "starred_url": "https://api.github.com/users/coventry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/coventry/subscriptions", "organizations_url": "https://api.github.com/users/coventry/orgs", "repos_url": "https://api.github.com/users/coventry/repos", "events_url": "https://api.github.com/users/coventry/events{/privacy}", "received_events_url": "https://api.github.com/users/coventry/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2015-05-16T01:12:35Z", "updated_at": "2015-05-16T16:59:24Z", "closed_at": "2015-05-16T16:59:24Z", "author_association": "NONE", "active_lock_reason": null, "body": "In lib.rs, I have:\n\n``` rust\nfn testfn(s: &[str]) -> u32 {\n    return 1;\n}\n```\n\n``` bash\ncoventry@uppekha:/tmp/test$ RUST_BACKTRACE=1 cargo test --verbose\n   Compiling test v0.1.0 (file:///tmp/test)\n     Running `rustc src/lib.rs --crate-name test --crate-type lib -g --test -C metadata=3649b7b644aa8a1f -C extra-filename=-3649b7b644aa8a1f --out-dir /tmp/test/target/debug --emit=dep-info,link -L dependency=/tmp/test/target/debug -L dependency=/tmp/test/target/debug/deps`\n     Running `rustc src/lib.rs --crate-name test --crate-type lib -g --out-dir /tmp/test/target/debug --emit=dep-info,link -L dependency=/tmp/test/target/debug -L dependency=/tmp/test/target/debug/deps`\nsrc/lib.rs:1:1: 3:2 warning: function is never used: `testfn`, #[warn(dead_code)] on by default\nsrc/lib.rs:1 fn testfn(s: &[str]) -> u32 {\nsrc/lib.rs:2     return 1;\nsrc/lib.rs:3 }\nsrc/lib.rs:1:11: 1:12 warning: unused variable: `s`, #[warn(unused_variables)] on by default\nsrc/lib.rs:1 fn testfn(s: &[str]) -> u32 {\n                       ^\nsrc/lib.rs:1:1: 3:2 warning: function is never used: `testfn`, #[warn(dead_code)] on by default\nsrc/lib.rs:1 fn testfn(s: &[str]) -> u32 {\nsrc/lib.rs:2     return 1;\nsrc/lib.rs:3 }\nsrc/lib.rs:1:11: 1:12 warning: unused variable: `s`, #[warn(unused_variables)] on by default\nsrc/lib.rs:1 fn testfn(s: &[str]) -> u32 {\n                       ^\nerror: internal compiler error: error: internal compiler error: unexpected panicunexpected panic\nnote: the compiler unexpectedly panicked. this is a bug.\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports\nnote: run with `RUST_BACKTRACE=1` for a backtrace\nthread 'rustc' panicked at 'assertion failed: slice_layout_is_correct(cx, &member_llvm_types[..], element_type)', /home/rustbuild/src/rust-buildbot/slave/stable-dist-rustc-linux/build/src/librustc_trans/trans/debuginfo.rs:2810\n\nstack backtrace:\n   1:     0x7f865b62f449 - sys::backtrace::write::hbc46dc0cfb3b9537d4r\n   2:     0x7f865b637156 - panicking::on_panic::h74d3c14d86c58ac8jrw\n   3:     0x7f865b5fa462 - rt::unwind::begin_unwind_inner::h382cea404b11eb00t6v\n   4:     0x7f865acf137e - rt::unwind::begin_unwind::h11527883117899559464\n   5:     0x7f865adf2f33 - trans::debuginfo::vec_slice_metadata::hf94e0b5f0c2f2a50cgy\n   6:     0x7f865adde7fc - trans::debuginfo::type_metadata::h61fa8cb587a59ac0Ioy\n   7:     0x7f865adf34c0 - trans::debuginfo::subroutine_type_metadata::h0a8adba26e117853iky\n   8:     0x7f865adde1d4 - trans::debuginfo::type_metadata::h61fa8cb587a59ac0Ioy\n   9:     0x7f865ad4a8b6 - trans::debuginfo::create_function_debug_context::hce33e3e89c0b549eG0w\n  10:     0x7f865ad48d16 - trans::base::new_fn_ctxt::hc47263521fb5ebc7Djh\n  11:     0x7f865ad51f10 - trans::base::trans_closure::h8e5687f4ccb96c5eLCh\n  12:     0x7f865ad560ea - trans::base::trans_fn::h0bc8fb6dbe17d6adtNh\n  13:     0x7f865ad59177 - trans::base::trans_item::h4f9c99b1e4474396Fbi\n  14:     0x7f865ad6756d - trans::base::trans_crate::haa02506df24d5efcF0i\n  15:     0x7f865bb7d0fa - driver::phase_4_translate_to_llvm::h86d6fb84c5c936d5hOa\n  16:     0x7f865bb54faa - driver::compile_input::hb78754f2f33c01efQba\n  17:     0x7f865bc164d1 - run_compiler::h258d36d5501c1cdfz4b\n  18:     0x7f865bc14122 - boxed::F.FnBox<A>::call_box::h7239693171334256553\n  19:     0x7f865bc13659 - rt::unwind::try::try_fn::h14329119008520845439\n  20:     0x7f865b6a9ac8 - rust_try_inner\n  21:     0x7f865b6a9ab5 - rust_try\n  22:     0x7f865bc13908 - boxed::F.FnBox<A>::call_box::h17332056298259451807\n  23:     0x7f865b636041 - sys::thread::create::thread_start::h490278b5c3c0b49faqv\n  24:     0x7f8655eb8181 - start_thread\n  25:     0x7f865b28047c - __clone\n  26:                0x0 - <unknown>\n\n\nnote: the compiler unexpectedly panicked. this is a bug.\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports\nnote: run with `RUST_BACKTRACE=1` for a backtrace\nthread 'rustc' panicked at 'assertion failed: slice_layout_is_correct(cx, &member_llvm_types[..], element_type)', /home/rustbuild/src/rust-buildbot/slave/stable-dist-rustc-linux/build/src/librustc_trans/trans/debuginfo.rs:2810\n\nstack backtrace:\n   1:     0x7fc298dfd449 - sys::backtrace::write::hbc46dc0cfb3b9537d4r\n   2:     0x7fc298e05156 - panicking::on_panic::h74d3c14d86c58ac8jrw\n   3:     0x7fc298dc8462 - rt::unwind::begin_unwind_inner::h382cea404b11eb00t6v\n   4:     0x7fc2984bf37e - rt::unwind::begin_unwind::h11527883117899559464\n   5:     0x7fc2985c0f33 - trans::debuginfo::vec_slice_metadata::hf94e0b5f0c2f2a50cgy\n   6:     0x7fc2985ac7fc - trans::debuginfo::type_metadata::h61fa8cb587a59ac0Ioy\n   7:     0x7fc2985c14c0 - trans::debuginfo::subroutine_type_metadata::h0a8adba26e117853iky\n   8:     0x7fc2985ac1d4 - trans::debuginfo::type_metadata::h61fa8cb587a59ac0Ioy\n   9:     0x7fc2985188b6 - trans::debuginfo::create_function_debug_context::hce33e3e89c0b549eG0w\n  10:     0x7fc298516d16 - trans::base::new_fn_ctxt::hc47263521fb5ebc7Djh\n  11:     0x7fc29851ff10 - trans::base::trans_closure::h8e5687f4ccb96c5eLCh\n  12:     0x7fc2985240ea - trans::base::trans_fn::h0bc8fb6dbe17d6adtNh\n  13:     0x7fc298527177 - trans::base::trans_item::h4f9c99b1e4474396Fbi\n  14:     0x7fc29853556d - trans::base::trans_crate::haa02506df24d5efcF0i\n  15:     0x7fc29934b0fa - driver::phase_4_translate_to_llvm::h86d6fb84c5c936d5hOa\n  16:     0x7fc299322faa - driver::compile_input::hb78754f2f33c01efQba\n  17:     0x7fc2993e44d1 - run_compiler::h258d36d5501c1cdfz4b\n  18:     0x7fc2993e2122 - boxed::F.FnBox<A>::call_box::h7239693171334256553\n  19:     0x7fc2993e1659 - rt::unwind::try::try_fn::h14329119008520845439\n  20:     0x7fc298e77ac8 - rust_try_inner\n  21:     0x7fc298e77ab5 - rust_try\n  22:     0x7fc2993e1908 - boxed::F.FnBox<A>::call_box::h17332056298259451807\n  23:     0x7fc298e04041 - sys::thread::create::thread_start::h490278b5c3c0b49faqv\n  24:     0x7fc293686181 - start_thread\n  25:     0x7fc298a4e47c - __clone\n  26:                0x0 - <unknown>\n\nBuild failed, waiting for other jobs to finish...\nCould not compile `test`.\n\nCaused by:\n  Process didn't exit successfully: `rustc src/lib.rs --crate-name test --crate-type lib -g --out-dir /tmp/test/target/debug --emit=dep-info,link -L dependency=/tmp/test/target/debug -L dependency=/tmp/test/target/debug/deps` (exit code: 101)\ncoventry@uppekha:/tmp/test$ \n```\n\nChanging the signature of s to `&[&str]` results in compilation without error.\n", "closed_by": {"login": "coventry", "id": 70152, "node_id": "MDQ6VXNlcjcwMTUy", "avatar_url": "https://avatars.githubusercontent.com/u/70152?v=4", "gravatar_id": "", "url": "https://api.github.com/users/coventry", "html_url": "https://github.com/coventry", "followers_url": "https://api.github.com/users/coventry/followers", "following_url": "https://api.github.com/users/coventry/following{/other_user}", "gists_url": "https://api.github.com/users/coventry/gists{/gist_id}", "starred_url": "https://api.github.com/users/coventry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/coventry/subscriptions", "organizations_url": "https://api.github.com/users/coventry/orgs", "repos_url": "https://api.github.com/users/coventry/repos", "events_url": "https://api.github.com/users/coventry/events{/privacy}", "received_events_url": "https://api.github.com/users/coventry/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/25470/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/25470/timeline", "performed_via_github_app": null, "state_reason": "completed"}