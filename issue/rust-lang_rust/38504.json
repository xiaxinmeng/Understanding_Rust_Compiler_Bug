{"url": "https://api.github.com/repos/rust-lang/rust/issues/38504", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/38504/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/38504/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/38504/events", "html_url": "https://github.com/rust-lang/rust/issues/38504", "id": 196809202, "node_id": "MDU6SXNzdWUxOTY4MDkyMDI=", "number": 38504, "title": "ICE: assertion failed (left == right) in astconv.rs", "user": {"login": "Nashenas88", "id": 1673130, "node_id": "MDQ6VXNlcjE2NzMxMzA=", "avatar_url": "https://avatars.githubusercontent.com/u/1673130?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Nashenas88", "html_url": "https://github.com/Nashenas88", "followers_url": "https://api.github.com/users/Nashenas88/followers", "following_url": "https://api.github.com/users/Nashenas88/following{/other_user}", "gists_url": "https://api.github.com/users/Nashenas88/gists{/gist_id}", "starred_url": "https://api.github.com/users/Nashenas88/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Nashenas88/subscriptions", "organizations_url": "https://api.github.com/users/Nashenas88/orgs", "repos_url": "https://api.github.com/users/Nashenas88/repos", "events_url": "https://api.github.com/users/Nashenas88/events{/privacy}", "received_events_url": "https://api.github.com/users/Nashenas88/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2016-12-20T23:38:23Z", "updated_at": "2016-12-26T16:14:36Z", "closed_at": "2016-12-26T16:14:36Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "The following code:\r\n```rust\r\nstruct NotTrait { } // <--- Struct instead of trait\r\n\r\nfn do_something() {\r\n    let x: <NotImportant as NotTrait>::test = test;\r\n    //                      ^ This and ^ this together are the problem\r\n}\r\n```\r\n\r\nProduces the following error only on nightly. Stable and beta fail compilation without an ICE.\r\n\r\n```\r\n$ RUST_BACKTRACE=1 cargo build --verbose\r\n   Compiling compiler_error v0.1.0 (file:///home/pfaria/compiler_error)\r\n     Running `rustc --crate-name compiler_error src/lib.rs --crate-type lib -g -C metadata=8b5a0bdfc8a3f707 -C extra-filename=-8b5a0bdfc8a3f707 --out-dir /home/pfaria/compiler_error/target/debug/deps --emit=dep-info,link -L dependency=/home/pfaria/compiler_error/target/debug/deps`\r\nerror[E0404]: `NotTrait` is not a trait\r\n --> src/lib.rs:4:29\r\n  |\r\n4 |     let x: <NotImportant as NotTrait>::test = test;\r\n  |                             ^^^^^^^^^^^^^^^ expected trait, found struct\r\n\r\nerror[E0412]: type name `NotImportant` is undefined or not in scope\r\n --> src/lib.rs:4:13\r\n  |\r\n4 |     let x: <NotImportant as NotTrait>::test = test;\r\n  |             ^^^^^^^^^^^^ undefined or not in scope\r\n  |\r\n  = help: no candidates by the name of `NotImportant` found in your project; maybe you misspelled the name or forgot to import an external crate?\r\n\r\nerror[E0425]: unresolved name `test`\r\n --> src/lib.rs:4:47\r\n  |\r\n4 |     let x: <NotImportant as NotTrait>::test = test;\r\n  |                                               ^^^^ unresolved name\r\n\r\nerror: internal compiler error: unexpected panic\r\n\r\nnote: the compiler unexpectedly panicked. this is a bug.\r\n\r\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports\r\n\r\nnote: run with `RUST_BACKTRACE=1` for a backtrace\r\n\r\nthread 'rustc' panicked at 'assertion failed: `(left == right)` (left: `Some([type error])`, right: `None`)', /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/librustc_typeck/astconv.rs:1451\r\nstack backtrace:\r\n   1:     0x7f27b5bc038a - std::sys::imp::backtrace::tracing::imp::write::h0d1aacfb8fc693ac\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libstd/sys/unix/backtrace/tracing/gcc_s.rs:42\r\n   2:     0x7f27b5bce6ff - std::panicking::default_hook::{{closure}}::hff87359baf5754d0\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libstd/panicking.rs:349\r\n   3:     0x7f27b5bce29d - std::panicking::default_hook::h936f17ca3b2b98dc\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libstd/panicking.rs:359\r\n   4:     0x7f27b5bceba7 - std::panicking::rust_panic_with_hook::he9c830ab830c7944\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libstd/panicking.rs:553\r\n   5:     0x7f27b5bcea34 - std::panicking::begin_panic::hbd10b7f500042f98\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libstd/panicking.rs:515\r\n   6:     0x7f27b5bce959 - std::panicking::begin_panic_fmt::h49583ddd44614a0d\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libstd/panicking.rs:499\r\n   7:     0x7f27b362edc2 - <rustc_typeck::astconv::AstConv<'gcx, 'tcx> + 'o>::def_to_ty::h103f6798e7cce8d2\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/librustc_typeck/astconv.rs:1451\r\n   8:     0x7f27b3630446 - <rustc_typeck::astconv::AstConv<'gcx, 'tcx> + 'o>::ast_ty_to_ty::h6713e7bc915e3b01\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/librustc_typeck/astconv.rs:1661\r\n   9:     0x7f27b362fcfe - <rustc_typeck::astconv::AstConv<'gcx, 'tcx> + 'o>::ast_ty_to_ty::h6713e7bc915e3b01\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/librustc_typeck/astconv.rs:1665\r\n  10:     0x7f27b35f0032 - <rustc_typeck::check::GatherLocalsVisitor<'a, 'gcx, 'tcx> as rustc::hir::intravisit::Visitor<'gcx>>::visit_local::h32caf495969107a5\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/librustc_typeck/check/mod.rs:1871\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/librustc_typeck/check/mod.rs:711\r\n  11:     0x7f27b3568d85 - rustc::hir::intravisit::walk_expr::h46c69156dee86d5f\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/librustc/hir/intravisit.rs:894\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/librustc/hir/intravisit.rs:251\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/librustc/hir/intravisit.rs:882\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/librustc/hir/intravisit.rs:242\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/obj/<walk_list macros>:2\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/librustc_typeck/check/mod.rs:743\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/librustc/hir/intravisit.rs:969\r\n  12:     0x7f27b35f0c27 - rustc_typeck::check::check_fn::h21a5f04436a5bbc5\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/librustc/hir/intravisit.rs:254\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/librustc_typeck/check/mod.rs:821\r\n  13:     0x7f27b35efa1b - rustc_typeck::check::check_bare_fn::h38d017b7cdf453a4\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/librustc_typeck/check/mod.rs:661\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/librustc_typeck/check/mod.rs:502\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/librustc/infer/mod.rs:442\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/librustc/ty/context.rs:1033\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libstd/thread/local.rs:245\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/librustc/ty/context.rs:1030\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/librustc/ty/context.rs:846\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/librustc/infer/mod.rs:442\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/librustc_typeck/check/mod.rs:502\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/librustc_typeck/check/mod.rs:651\r\n  14:     0x7f27b35f2783 - rustc_typeck::check::check_item_body::h93dbfca77b60ad10\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/librustc_typeck/check/mod.rs:928\r\n  15:     0x7f27b35ed2b0 - rustc_typeck::check::check_item_bodies::ha9191bbc667904b7\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/librustc_typeck/check/mod.rs:565\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/librustc/dep_graph/visit.rs:45\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/librustc/hir/mod.rs:456\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/librustc/dep_graph/visit.rs:67\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/librustc/ty/mod.rs:2681\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/librustc_typeck/check/mod.rs:591\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/librustc/session/mod.rs:232\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/librustc_typeck/check/mod.rs:589\r\n  16:     0x7f27b3658f2f - rustc_typeck::check_crate::hd31dd2bc6ea91ceb\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/librustc_typeck/lib.rs:347\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/librustc/util/common.rs:34\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/librustc_typeck/lib.rs:347\r\n  17:     0x7f27b5f64d01 - rustc_driver::driver::phase_3_run_analysis_passes::{{closure}}::hd352d0090529a6be\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/librustc_driver/driver.rs:895\r\n  18:     0x7f27b5f51b88 - rustc_driver::driver::phase_3_run_analysis_passes::hf45ad5d717ac6301\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/librustc/ty/context.rs:1033\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libstd/thread/local.rs:245\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/librustc/ty/context.rs:1030\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/librustc/ty/context.rs:1017\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libstd/thread/local.rs:245\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/librustc/ty/context.rs:1014\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/librustc/ty/context.rs:782\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/librustc_driver/driver.rs:865\r\n  19:     0x7f27b5f381d2 - rustc_driver::driver::compile_input::hc9da7de451d406ba\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/librustc_driver/driver.rs:171\r\n  20:     0x7f27b5f7db47 - rustc_driver::run_compiler::h408af14fa24a33a5\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/librustc_driver/lib.rs:221\r\n  21:     0x7f27b5e9b9e8 - std::panicking::try::do_call::h2c149962956958c1\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/librustc_driver/lib.rs:1117\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/librustc_driver/lib.rs:137\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/librustc_driver/lib.rs:1051\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libstd/panic.rs:295\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libstd/panicking.rs:458\r\n  22:     0x7f27b5bd73ca - __rust_maybe_catch_panic\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libpanic_unwind/lib.rs:98\r\n  23:     0x7f27b5ebd328 - <F as alloc::boxed::FnBox<A>>::call_box::hf839c55097f480b2\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libstd/panicking.rs:434\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libstd/panic.rs:351\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libstd/thread/mod.rs:287\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/liballoc/boxed.rs:605\r\n  24:     0x7f27b5bcd564 - std::sys::imp::thread::Thread::new::thread_start::h1fa04983ba2271d0\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/liballoc/boxed.rs:615\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libstd/sys_common/thread.rs:21\r\n                        at /buildslave/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libstd/sys/unix/thread.rs:84\r\n  25:     0x7f27addd1709 - start_thread\r\n  26:     0x7f27b588a82c - clone\r\n  27:                0x0 - <unknown>\r\n\r\nerror: Could not compile `compiler_error`.\r\n\r\nCaused by:\r\n  process didn't exit successfully: `rustc --crate-name compiler_error src/lib.rs --crate-type lib -g -C metadata=8b5a0bdfc8a3f707 -C extra-filename=-8b5a0bdfc8a3f707 --out-dir /home/pfaria/compiler_error/target/debug/deps --emit=dep-info,link -L dependency=/home/pfaria/compiler_error/target/debug/deps` (exit code: 101)\r\n```", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/38504/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/38504/timeline", "performed_via_github_app": null, "state_reason": "completed"}