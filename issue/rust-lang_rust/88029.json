{"url": "https://api.github.com/repos/rust-lang/rust/issues/88029", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/88029/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/88029/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/88029/events", "html_url": "https://github.com/rust-lang/rust/issues/88029", "id": 970916891, "node_id": "MDU6SXNzdWU5NzA5MTY4OTE=", "number": 88029, "title": "x.py tidy forces `use path::{...}` to come after `use path::m::{...}`; makes commits noisy.", "user": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 2255065215, "node_id": "MDU6TGFiZWwyMjU1MDY1MjE1", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-rustfmt", "name": "A-rustfmt", "color": "f7e101", "default": false, "description": "Area: Rustfmt"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-08-14T13:54:56Z", "updated_at": "2021-08-17T19:07:25Z", "closed_at": null, "author_association": "MEMBER", "active_lock_reason": null, "body": "(This may be a rustfmt bug, rather than a rustc bootstrap issue. But I just wanted to file it somewhere before I forgot about it.)\r\n\r\n\r\nToday, if you have:\r\n\r\n```rust\r\nuse rustc_middle::middle::cstore::CrateDepKind;\r\nuse rustc_middle::middle::cstore::LinkagePreference::{self, RequireDynamic, RequireStatic};\r\n```\r\n\r\nand you want to import `rustc_middle::middle::cstore::CStore`, you could write \r\n\r\n```rust\r\nuse rustc_middle::middle::cstore::CrateDepKind;\r\nuse rustc_middle::middle::cstore::CStore; // <--- new line\r\nuse rustc_middle::middle::cstore::LinkagePreference::{self, RequireDynamic, RequireStatic};\r\n```\r\n\r\nBut one might rightly think that's overly verbose; why not use a `{...}` block on the first `use`?\r\n\r\nBut if you try that, and write:\r\n\r\n```rust\r\nuse rustc_middle::middle::cstore::{CrateDepKind, CStore}; // <--- changed line\r\nuse rustc_middle::middle::cstore::LinkagePreference::{self, RequireDynamic, RequireStatic};\r\n```\r\n\r\nthen x.py tidy complains, and says it wants you to rewrite it as:\r\n\r\n```rust\r\nuse rustc_middle::middle::cstore::LinkagePreference::{self, RequireDynamic, RequireStatic};\r\nuse rustc_middle::middle::cstore::{CrateDepKind, CStore}; // <--- changed and *moved* line\r\n```\r\n\r\nThis seems wrong to me.\r\n\r\nif I had to guess, I'd infer that the `rustfmt` algorithm is using a naive alphabetical ordering on the lines, rather than considering the higher level module tree structure. Looking at it from the view point of putting nodes closer to the tree's root first, everything for `use path::{...}` should come before `use path::m::{...}`, right?\r\n", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/88029/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/88029/timeline", "performed_via_github_app": null, "state_reason": null}