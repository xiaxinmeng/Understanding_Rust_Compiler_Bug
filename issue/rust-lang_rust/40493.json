{"url": "https://api.github.com/repos/rust-lang/rust/issues/40493", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/40493/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/40493/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/40493/events", "html_url": "https://github.com/rust-lang/rust/issues/40493", "id": 213915517, "node_id": "MDU6SXNzdWUyMTM5MTU1MTc=", "number": 40493, "title": "Regression in rust nightly 2017-03-04", "user": {"login": "Drakulix", "id": 4404502, "node_id": "MDQ6VXNlcjQ0MDQ1MDI=", "avatar_url": "https://avatars.githubusercontent.com/u/4404502?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Drakulix", "html_url": "https://github.com/Drakulix", "followers_url": "https://api.github.com/users/Drakulix/followers", "following_url": "https://api.github.com/users/Drakulix/following{/other_user}", "gists_url": "https://api.github.com/users/Drakulix/gists{/gist_id}", "starred_url": "https://api.github.com/users/Drakulix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Drakulix/subscriptions", "organizations_url": "https://api.github.com/users/Drakulix/orgs", "repos_url": "https://api.github.com/users/Drakulix/repos", "events_url": "https://api.github.com/users/Drakulix/events{/privacy}", "received_events_url": "https://api.github.com/users/Drakulix/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 203429200, "node_id": "MDU6TGFiZWwyMDM0MjkyMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/P-high", "name": "P-high", "color": "eb6420", "default": false, "description": "High priority"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 262252628, "node_id": "MDU6TGFiZWwyNjIyNTI2Mjg=", "url": "https://api.github.com/repos/rust-lang/rust/labels/regression-from-stable-to-beta", "name": "regression-from-stable-to-beta", "color": "e4008a", "default": false, "description": "Performance or correctness regression from stable to beta."}], "state": "closed", "locked": false, "assignee": {"login": "arielb1", "id": 1830974, "node_id": "MDQ6VXNlcjE4MzA5NzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1830974?v=4", "gravatar_id": "", "url": "https://api.github.com/users/arielb1", "html_url": "https://github.com/arielb1", "followers_url": "https://api.github.com/users/arielb1/followers", "following_url": "https://api.github.com/users/arielb1/following{/other_user}", "gists_url": "https://api.github.com/users/arielb1/gists{/gist_id}", "starred_url": "https://api.github.com/users/arielb1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/arielb1/subscriptions", "organizations_url": "https://api.github.com/users/arielb1/orgs", "repos_url": "https://api.github.com/users/arielb1/repos", "events_url": "https://api.github.com/users/arielb1/events{/privacy}", "received_events_url": "https://api.github.com/users/arielb1/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "arielb1", "id": 1830974, "node_id": "MDQ6VXNlcjE4MzA5NzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1830974?v=4", "gravatar_id": "", "url": "https://api.github.com/users/arielb1", "html_url": "https://github.com/arielb1", "followers_url": "https://api.github.com/users/arielb1/followers", "following_url": "https://api.github.com/users/arielb1/following{/other_user}", "gists_url": "https://api.github.com/users/arielb1/gists{/gist_id}", "starred_url": "https://api.github.com/users/arielb1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/arielb1/subscriptions", "organizations_url": "https://api.github.com/users/arielb1/orgs", "repos_url": "https://api.github.com/users/arielb1/repos", "events_url": "https://api.github.com/users/arielb1/events{/privacy}", "received_events_url": "https://api.github.com/users/arielb1/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2017-03-13T22:25:17Z", "updated_at": "2017-04-06T03:20:28Z", "closed_at": "2017-04-06T03:20:28Z", "author_association": "NONE", "active_lock_reason": null, "body": "I cannot compile my library `wlc` (on crates.io) on nightlies later then 2017-03-03 anymore.\r\nThe code is not using any unstable features, if compiled with the feature \"unsafe-stable\" and results do **not** differ between \"default\" features (which uses `optin_builtin_traits`) and the \"unsafe-stable\" feature (which does disable `optin_builtin_traits`).\r\n\r\nSo code, that still works on stable and beta, does not compile anymore without any helpful error messages (see below).\r\n\r\n## Overview:\r\n\r\n### Working:\r\n\r\n`rustup run stable cargo build --features \"unsafe-stable\"`\r\n`rustup run beta cargo build --features \"unsafe-stable\"`\r\n`rustup run nightly-2017-03-03 cargo build --features \"unsafe-stable\"`\r\n\r\n### Broken:\r\n\r\n`rustup run nightly-2017-03-04 cargo build --features \"unsafe-stable\"`\r\n`rustup run nightly-2017-03-04 cargo build`\r\n\r\nBoth abort with a **stack overflow**:\r\n\r\n```\r\n Compiling wlc v2.0.1 (file:///home/drakulix/Projects/tavern/wlc)\r\n     Running `rustc --crate-name wlc src/lib.rs --crate-type lib --emit=dep-info,link -C debuginfo=2 --cfg 'feature=\"default\"' --cfg 'feature=\"unsafe-stable\"' -C metadata=16cc333f6e306687 -C extra-filename=-16cc333f6e306687 --out-dir /home/drakulix/Projects/tavern/wlc/target/debug/deps -L dependency=/home/drakulix/Projects/tavern/wlc/target/debug/deps --extern libc=/home/drakulix/Projects/tavern/wlc/target/debug/deps/liblibc-2a4507ee5e52ea3e.rlib --extern wlc_sys=/home/drakulix/Projects/tavern/wlc/target/debug/deps/libwlc_sys-03e3fe15a0f6e02b.rlib --extern uinput_sys=/home/drakulix/Projects/tavern/wlc/target/debug/deps/libuinput_sys-1e8aa47014f4e364.rlib --extern lazy_static=/home/drakulix/Projects/tavern/wlc/target/debug/deps/liblazy_static-2a16fcec40d2bdf3.rlib --extern num_traits=/home/drakulix/Projects/tavern/wlc/target/debug/deps/libnum_traits-51f88ce8f32c0283.rlib --extern bitflags=/home/drakulix/Projects/tavern/wlc/target/debug/deps/libbitflags-88857433f6b67df9.rlib --extern log=/home/drakulix/Projects/tavern/wlc/target/debug/deps/liblog-2f7366be74992849.rlib --extern xkbcommon=/home/drakulix/Projects/tavern/wlc/target/debug/deps/libxkbcommon-ff825cd69a6d510f.rlib`\r\n\r\nthread 'rustc' has overflowed its stack\r\nfatal runtime error: stack overflow\r\nerror: Could not compile `wlc`.\r\n\r\nCaused by:\r\n  process didn't exit successfully: `rustc --crate-name wlc src/lib.rs --crate-type lib --emit=dep-info,link -C debuginfo=2 --cfg feature=\"default\" --cfg feature=\"unsafe-stable\" -C metadata=16cc333f6e306687 -C extra-filename=-16cc333f6e306687 --out-dir /home/drakulix/Projects/tavern/wlc/target/debug/deps -L dependency=/home/drakulix/Projects/tavern/wlc/target/debug/deps --extern libc=/home/drakulix/Projects/tavern/wlc/target/debug/deps/liblibc-2a4507ee5e52ea3e.rlib --extern wlc_sys=/home/drakulix/Projects/tavern/wlc/target/debug/deps/libwlc_sys-03e3fe15a0f6e02b.rlib --extern uinput_sys=/home/drakulix/Projects/tavern/wlc/target/debug/deps/libuinput_sys-1e8aa47014f4e364.rlib --extern lazy_static=/home/drakulix/Projects/tavern/wlc/target/debug/deps/liblazy_static-2a16fcec40d2bdf3.rlib --extern num_traits=/home/drakulix/Projects/tavern/wlc/target/debug/deps/libnum_traits-51f88ce8f32c0283.rlib --extern bitflags=/home/drakulix/Projects/tavern/wlc/target/debug/deps/libbitflags-88857433f6b67df9.rlib --extern log=/home/drakulix/Projects/tavern/wlc/target/debug/deps/liblog-2f7366be74992849.rlib --extern xkbcommon=/home/drakulix/Projects/tavern/wlc/target/debug/deps/libxkbcommon-ff825cd69a6d510f.rlib` (exit code: 1)\r\n```\r\n\r\n`rustup run nightly-2017-03-12 cargo build --features \"unsafe-stable\"`\r\n`rustup run nightly-2017-03-12 cargo build`\r\n\r\nBoth fail **without any specific error**:\r\n\r\n```\r\nCompiling wlc v2.0.1 (file:///home/drakulix/Projects/tavern/wlc)\r\n     Running `rustc --crate-name wlc src/lib.rs --crate-type lib --emit=dep-info,link -C debuginfo=2 --cfg 'feature=\"unsafe-stable\"' --cfg 'feature=\"default\"' -C metadata=16cc333f6e306687 -C extra-filename=-16cc333f6e306687 --out-dir /home/drakulix/Projects/tavern/wlc/target/debug/deps -L dependency=/home/drakulix/Projects/tavern/wlc/target/debug/deps --extern wlc_sys=/home/drakulix/Projects/tavern/wlc/target/debug/deps/libwlc_sys-03e3fe15a0f6e02b.rlib --extern uinput_sys=/home/drakulix/Projects/tavern/wlc/target/debug/deps/libuinput_sys-1e8aa47014f4e364.rlib --extern xkbcommon=/home/drakulix/Projects/tavern/wlc/target/debug/deps/libxkbcommon-ff825cd69a6d510f.rlib --extern libc=/home/drakulix/Projects/tavern/wlc/target/debug/deps/liblibc-2a4507ee5e52ea3e.rlib --extern bitflags=/home/drakulix/Projects/tavern/wlc/target/debug/deps/libbitflags-88857433f6b67df9.rlib --extern num_traits=/home/drakulix/Projects/tavern/wlc/target/debug/deps/libnum_traits-51f88ce8f32c0283.rlib --extern lazy_static=/home/drakulix/Projects/tavern/wlc/target/debug/deps/liblazy_static-2a16fcec40d2bdf3.rlib --extern log=/home/drakulix/Projects/tavern/wlc/target/debug/deps/liblog-2f7366be74992849.rlib`\r\nerror: Could not compile `wlc`.\r\n\r\nCaused by:\r\n  process didn't exit successfully: `rustc --crate-name wlc src/lib.rs --crate-type lib --emit=dep-info,link -C debuginfo=2 --cfg feature=\"unsafe-stable\" --cfg feature=\"default\" -C metadata=16cc333f6e306687 -C extra-filename=-16cc333f6e306687 --out-dir /home/drakulix/Projects/tavern/wlc/target/debug/deps -L dependency=/home/drakulix/Projects/tavern/wlc/target/debug/deps --extern wlc_sys=/home/drakulix/Projects/tavern/wlc/target/debug/deps/libwlc_sys-03e3fe15a0f6e02b.rlib --extern uinput_sys=/home/drakulix/Projects/tavern/wlc/target/debug/deps/libuinput_sys-1e8aa47014f4e364.rlib --extern xkbcommon=/home/drakulix/Projects/tavern/wlc/target/debug/deps/libxkbcommon-ff825cd69a6d510f.rlib --extern libc=/home/drakulix/Projects/tavern/wlc/target/debug/deps/liblibc-2a4507ee5e52ea3e.rlib --extern bitflags=/home/drakulix/Projects/tavern/wlc/target/debug/deps/libbitflags-88857433f6b67df9.rlib --extern num_traits=/home/drakulix/Projects/tavern/wlc/target/debug/deps/libnum_traits-51f88ce8f32c0283.rlib --extern lazy_static=/home/drakulix/Projects/tavern/wlc/target/debug/deps/liblazy_static-2a16fcec40d2bdf3.rlib --extern log=/home/drakulix/Projects/tavern/wlc/target/debug/deps/liblog-2f7366be74992849.rlib` (exit code: 1)\r\n```\r\n\r\nI have no idea, where I should start to debug this. Reproducing this error is also quite annoying to setup, as the library depends on a bunch of native libraries not available in most repositories. So I am thankful for any hints about how I could provide more information.\r\n\r\nAll tests where done after running `cargo clean`.\r\n\r\n## Meta\r\n\r\n`rustc --version --verbose`: \r\n\r\n```\r\nrustc 1.17.0-nightly (824c9ebbd 2017-03-12)\r\nbinary: rustc\r\ncommit-hash: 824c9ebbd5f0611e326648d90ee3e50caf04bb7f\r\ncommit-date: 2017-03-12\r\nhost: x86_64-unknown-linux-gnu\r\nrelease: 1.17.0-nightly\r\nLLVM version: 3.9\r\n```", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/40493/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/40493/timeline", "performed_via_github_app": null, "state_reason": "completed"}