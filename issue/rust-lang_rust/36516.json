{"url": "https://api.github.com/repos/rust-lang/rust/issues/36516", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/36516/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/36516/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/36516/events", "html_url": "https://github.com/rust-lang/rust/issues/36516", "id": 177326755, "node_id": "MDU6SXNzdWUxNzczMjY3NTU=", "number": 36516, "title": "compiletest failures are close to unreadable because of JSON", "user": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 120005, "node_id": "MDU6TGFiZWwxMjAwMDU=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-testsuite", "name": "A-testsuite", "color": "f7e101", "default": false, "description": "Area: The testsuite used to check the correctness of rustc"}, {"id": 234902, "node_id": "MDU6TGFiZWwyMzQ5MDI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-enhancement", "name": "C-enhancement", "color": "f5f1fd", "default": false, "description": "Category: An issue proposing an enhancement or a PR with one."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 13, "created_at": "2016-09-16T01:17:29Z", "updated_at": "2018-11-05T11:24:55Z", "closed_at": "2018-11-05T11:24:55Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Here's one I hit recently:\n\n```\n---- [run-pass] run-pass/hello.rs stdout ----                                                                                                                                             [124/9070]\n\nerror: compilation failed!\nstatus: exit code: 101\ncommand: /mnt2/dev/rust/build/x86_64-unknown-linux-gnu/stage2/bin/rustc /mnt2/dev/rust/src/test/run-pass/hello.rs -L /mnt2/dev/rust/build/x86_64-unknown-linux-gnu/test/run-pass --target=asmjs-unkn\nown-emscripten --error-format json -L /mnt2/dev/rust/build/x86_64-unknown-linux-gnu/test/run-pass/hello.stage2-asmjs-unknown-emscripten.run-pass.libaux -C prefer-dynamic -o /mnt2/dev/rust/build/x8\n6_64-unknown-linux-gnu/test/run-pass/hello.stage2-asmjs-unknown-emscripten.js -Crpath -O -Lnative=/mnt2/dev/rust/build/asmjs-unknown-emscripten/rust-test-helpers\nstdout:\n------------------------------------------\n\n------------------------------------------\nstderr:\n------------------------------------------\n{\"message\":\"linking with `emcc` failed: exit code: 1\",\"code\":null,\"level\":\"error\",\"spans\":[],\"children\":[{\"message\":\"\\\"emcc\\\" \\\"-L\\\" \\\"/mnt2/dev/rust/build/x86_64-unknown-linux-gnu/stage2/lib/rust\nlib/asmjs-unknown-emscripten/lib\\\" \\\"/mnt2/dev/rust/build/x86_64-unknown-linux-gnu/test/run-pass/hello.0.o\\\" \\\"-o\\\" \\\"/mnt2/dev/rust/build/x86_64-unknown-linux-gnu/test/run-pass/hello.stage2-asmjs\n-unknown-emscripten.js\\\" \\\"-Wl,--gc-sections\\\" \\\"-Wl,-O1\\\" \\\"-nodefaultlibs\\\" \\\"-L\\\" \\\"/mnt2/dev/rust/build/x86_64-unknown-linux-gnu/test/run-pass\\\" \\\"-L\\\" \\\"/mnt2/dev/rust/build/x86_64-unknown-li\nnux-gnu/test/run-pass/hello.stage2-asmjs-unknown-emscripten.run-pass.libaux\\\" \\\"-L\\\" \\\"/mnt2/dev/rust/build/asmjs-unknown-emscripten/rust-test-helpers\\\" \\\"-L\\\" \\\"/mnt2/dev/rust/build/x86_64-unknow\nn-linux-gnu/stage2/lib/rustlib/asmjs-unknown-emscripten/lib\\\" \\\"-Wl,-Bstatic\\\" \\\"-Wl,-Bdynamic\\\" \\\"/mnt2/dev/rust/build/x86_64-unknown-linux-gnu/stage2/lib/rustlib/asmjs-unknown-emscripten/lib/lib\nstd-c5ae712d21ff1b88.rlib\\\" \\\"/mnt2/dev/rust/build/x86_64-unknown-linux-gnu/stage2/lib/rustlib/asmjs-unknown-emscripten/lib/libpanic_unwind-0aed89c908dbae00.rlib\\\" \\\"/mnt2/dev/rust/build/x86_64-un\nknown-linux-gnu/stage2/lib/rustlib/asmjs-unknown-emscripten/lib/libunwind-4406c7bac693a305.rlib\\\" \\\"/mnt2/dev/rust/build/x86_64-unknown-linux-gnu/stage2/lib/rustlib/asmjs-unknown-emscripten/lib/li\nbrand-4bf39e147f01f701.rlib\\\" \\\"/mnt2/dev/rust/build/x86_64-unknown-linux-gnu/stage2/lib/rustlib/asmjs-unknown-emscripten/lib/libcollections-94042b4fb30df9b8.rlib\\\" \\\"/mnt2/dev/rust/build/x86_64-u\nnknown-linux-gnu/stage2/lib/rustlib/asmjs-unknown-emscripten/lib/librustc_unicode-e09cf12a6737fbe8.rlib\\\" \\\"/mnt2/dev/rust/build/x86_64-unknown-linux-gnu/stage2/lib/rustlib/asmjs-unknown-emscripte\nn/lib/liballoc-e2faee10ccc53a4e.rlib\\\" \\\"/mnt2/dev/rust/build/x86_64-unknown-linux-gnu/stage2/lib/rustlib/asmjs-unknown-emscripten/lib/liballoc_system-57a84a70354893c6.rlib\\\" \\\"/mnt2/dev/rust/buil\nd/x86_64-unknown-linux-gnu/stage2/lib/rustlib/asmjs-unknown-emscripten/lib/liblibc-5f7c0b0b6e65da09.rlib\\\" \\\"/mnt2/dev/rust/build/x86_64-unknown-linux-gnu/stage2/lib/rustlib/asmjs-unknown-emscript\nen/lib/libcore-380af50841193d3f.rlib\\\" \\\"/mnt2/dev/rust/build/x86_64-unknown-linux-gnu/stage2/lib/rustlib/asmjs-unknown-emscripten/lib/libcompiler_builtins-3720833c50b88cf0.rlib\\\" \\\"-l\\\" \\\"c\\\" \\\"-\ns\\\" \\\"ERROR_ON_UNDEFINED_SYMBOLS=1\\\"\",\"code\":null,\"level\":\"note\",\"spans\":[],\"children\":[],\"rendered\":null},{\"message\":\"/mnt2/dev/emsdk_portable/clang/fastcomp/build_incoming_64/bin/llvm-nm: /mnt2/\ndev/rust/build/x86_64-unknown-linux-gnu/stage2/lib/rustlib/asmjs-unknown-emscripten/lib/libstd-c5ae712d21ff1b88.rlib(rust.metadata.bin) The end of the file was unexpectedly encountered\\n\\n/mnt2/de\nv/emsdk_portable/clang/fastcomp/build_incoming_64/bin/llvm-nm: /mnt2/dev/rust/build/x86_64-unknown-linux-gnu/stage2/lib/rustlib/asmjs-unknown-emscripten/lib/libpanic_unwind-0aed89c908dbae00.rlib(r\nust.metadata.bin) The end of the file was unexpectedly encountered\\n\\n/mnt2/dev/emsdk_portable/clang/fastcomp/build_incoming_64/bin/llvm-nm: /mnt2/dev/rust/build/x86_64-unknown-linux-gnu/stage2/li\nb/rustlib/asmjs-unknown-emscripten/lib/libunwind-4406c7bac693a305.rlib(rust.metadata.bin) The end of the file was unexpectedly encountered\\n\\n/mnt2/dev/emsdk_portable/clang/fastcomp/build_incoming\n_64/bin/llvm-nm: /mnt2/dev/rust/build/x86_64-unknown-linux-gnu/stage2/lib/rustlib/asmjs-unknown-emscripten/lib/librand-4bf39e147f01f701.rlib(rust.metadata.bin) The end of the file was unexpectedly\n encountered\\n\\n/mnt2/dev/emsdk_portable/clang/fastcomp/build_incoming_64/bin/llvm-nm: /mnt2/dev/rust/build/x86_64-unknown-linux-gnu/stage2/lib/rustlib/asmjs-unknown-emscripten/lib/libcollections-\n94042b4fb30df9b8.rlib(rust.metadata.bin) The end of the file was unexpectedly encountered\\n\\n/mnt2/dev/emsdk_portable/clang/fastcomp/build_incoming_64/bin/llvm-nm: /mnt2/dev/rust/build/x86_64-unkn\nown-linux-gnu/stage2/lib/rustlib/asmjs-unknown-emscripten/lib/librustc_unicode-e09cf12a6737fbe8.rlib(rust.metadata.bin) The end of the file was unexpectedly encountered\\n\\n/mnt2/dev/emsdk_portable\n/clang/fastcomp/build_incoming_64/bin/llvm-nm: /mnt2/dev/rust/build/x86_64-unknown-linux-gnu/stage2/lib/rustlib/asmjs-unknown-emscripten/lib/liballoc-e2faee10ccc53a4e.rlib(rust.metadata.bin) The e\nnd of the file was unexpectedly encountered\\n\\n/mnt2/dev/emsdk_portable/clang/fastcomp/build_incoming_64/bin/llvm-nm: /mnt2/dev/rust/build/x86_64-unknown-linux-gnu/stage2/lib/rustlib/asmjs-unknown\n-emscripten/lib/liballoc_system-57a84a70354893c6.rlib(rust.metadata.bin) The end of the file was unexpectedly encountered\\n\\n/mnt2/dev/emsdk_portable/clang/fastcomp/build_incoming_64/bin/llvm-nm:\n/mnt2/dev/rust/build/x86_64-unknown-linux-gnu/stage2/lib/rustlib/asmjs-unknown-emscripten/lib/liblibc-5f7c0b0b6e65da09.rlib(rust.metadata.bin) The end of the file was unexpectedly encountered\\n\\n/\nmnt2/dev/emsdk_portable/clang/fastcomp/build_incoming_64/bin/llvm-nm: /mnt2/dev/rust/build/x86_64-unknown-linux-gnu/stage2/lib/rustlib/asmjs-unknown-emscripten/lib/libcore-380af50841193d3f.rlib(ru\nst.metadata.bin) The end of the file was unexpectedly encountered\\n\\n/mnt2/dev/emsdk_portable/clang/fastcomp/build_incoming_64/bin/llvm-nm: /mnt2/dev/rust/build/x86_64-unknown-linux-gnu/stage2/lib\n/rustlib/asmjs-unknown-emscripten/lib/libcompiler_builtins-3720833c50b88cf0.rlib(rust.metadata.bin) The end of the file was unexpectedly encountered\\n\\nerror: unresolved symbol: _Unwind_GetRegionS\ntart\\nerror: unresolved symbol: _Unwind_SetGR\\nerror: unresolved symbol: _Unwind_GetLanguageSpecificData\\nerror: unresolved symbol: _Unwind_SetIP\\nerror: unresolved symbol: _Unwind_GetTextRelBase\\\nnerror: unresolved symbol: _Unwind_GetDataRelBase\\nAborting compilation due to previous errors | undefined\\nTraceback (most recent call last):\\n  File \\\"/mnt2/dev/emsdk_portable/emscripten/incomin\ng/emcc\\\", line 13, in <module>\\n    emcc.run()\\n  File \\\"/mnt2/dev/emsdk_portable/emscripten/incoming/emcc.py\\\", line 1510, in run\\n    final = shared.Building.emscripten(final, append_ext=False,\nextra_args=extra_args)\\n  File \\\"/mnt2/dev/emsdk_portable/emscripten/incoming/tools/shared.py\\\", line 1707, in emscripten\\n    call_emscripten(cmdline)\\n  File \\\"/mnt2/dev/emsdk_portable/emscripte\nn/incoming/emscripten.py\\\", line 1756, in _main\\n    temp_files.run_and_clean(lambda: main(\\n  File \\\"/mnt2/dev/emsdk_portable/emscripten/incoming/tools/tempfiles.py\\\", line 78, in run_and_clean\\n\n    return func()\\n  File \\\"/mnt2/dev/emsdk_portable/emscripten/incoming/emscripten.py\\\", line 1761, in <lambda>\\n    DEBUG=DEBUG,\\n  File \\\"/mnt2/dev/emsdk_portable/emscripten/incoming/emscripten\n.py\\\", line 1662, in main\\n    temp_files=temp_files, DEBUG=DEBUG)\\n  File \\\"/mnt2/dev/emsdk_portable/emscripten/incoming/emscripten.py\\\", line 91, in emscript\\n    glue, forwarded_data = compiler\n_glue(metadata, settings, libraries, compiler_engine, temp_files, DEBUG)\\n  File \\\"/mnt2/dev/emsdk_portable/emscripten/incoming/emscripten.py\\\", line 286, in compiler_glue\\n    cwd=path_from_root(\n'src'), error_limit=300)\\n  File \\\"/mnt2/dev/emsdk_portable/emscripten/incoming/tools/jsrun.py\\\", line 76, in run_js\\n    raise Exception('Expected the command ' + str(command) + ' to finish with\nreturn code ' + str(assert_returncode) + ', but it returned with code ' + str(proc.returncode) + ' instead! Output: ' + str(ret)[:error_limit])\\nException: Expected the command ['/mnt2/dev/emsdk_p\nortable/node/4.1.1_64bit/bin/node', '/mnt2/dev/emsdk_portable/emscripten/incoming/src/compiler.js', '/tmp/tmpnGlx_B.txt', '/mnt2/dev/emsdk_portable/emscripten/incoming/src/library_pthread_stub.js'\n] to finish with return code 0, but it returned with code 1 instead! Output: // The Module object: Our interface to the outside world. We import\\n// and export values on it, and do the work to get\n that through\\n// closure compiler if necessary. There are various ways Module can be used:\\n// 1. Not defined. We create it here\\n// 2. A function parameter, function(Module) { ..gener\\n\",\"code\":\nnull,\"level\":\"note\",\"spans\":[],\"children\":[],\"rendered\":null}],\"rendered\":null}\n{\"message\":\"aborting due to previous error\",\"code\":null,\"level\":\"error\",\"spans\":[],\"children\":[],\"rendered\":null}\n\n------------------------------------------\n\nthread '[run-pass] run-pass/hello.rs' panicked at 'explicit panic', src/tools/compiletest/src/runtest.rs:2359\nnote: Run with `RUST_BACKTRACE=1` for a backtrace.\n\n```\n\ncompiletest uses the --error-format=json switch to capture more precise error information then dumps that out for humans to read.\n\nInstead we might either: have the compiler output the json to a side file; reformat the JSON into something that makes more sense.\n", "closed_by": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/36516/reactions", "total_count": 5, "+1": 5, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/36516/timeline", "performed_via_github_app": null, "state_reason": "completed"}