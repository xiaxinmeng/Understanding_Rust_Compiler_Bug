{"url": "https://api.github.com/repos/rust-lang/rust/issues/54525", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/54525/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/54525/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/54525/events", "html_url": "https://github.com/rust-lang/rust/issues/54525", "id": 363053596, "node_id": "MDU6SXNzdWUzNjMwNTM1OTY=", "number": 54525, "title": "Strange behaviour while resoving modules placed in constants", "user": {"login": "weiznich", "id": 1674512, "node_id": "MDQ6VXNlcjE2NzQ1MTI=", "avatar_url": "https://avatars.githubusercontent.com/u/1674512?v=4", "gravatar_id": "", "url": "https://api.github.com/users/weiznich", "html_url": "https://github.com/weiznich", "followers_url": "https://api.github.com/users/weiznich/followers", "following_url": "https://api.github.com/users/weiznich/following{/other_user}", "gists_url": "https://api.github.com/users/weiznich/gists{/gist_id}", "starred_url": "https://api.github.com/users/weiznich/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/weiznich/subscriptions", "organizations_url": "https://api.github.com/users/weiznich/orgs", "repos_url": "https://api.github.com/users/weiznich/repos", "events_url": "https://api.github.com/users/weiznich/events{/privacy}", "received_events_url": "https://api.github.com/users/weiznich/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-09-24T08:32:29Z", "updated_at": "2018-11-18T10:30:57Z", "closed_at": "2018-11-18T10:30:57Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "There is a strange/inconsistent behaviour in the name resolution of models placed in constants. \r\nIn detail placing a module inside of a constant works. \r\nReferring directly to types inside the module also works. \r\n```rust\r\nconst _DUMMY: () = {\r\n    mod some_mod {\r\n        pub struct Bar;\r\n    }\r\n    \r\n    fn foo(_: some_mod::Bar) {}\r\n};\r\n```\r\ncompiles successfully.\r\n\r\nTrying to use `use` statements or starting the path otherwise with `self::` results in compiler errors that `some_mod` is not found:\r\n\r\n```rust\r\nconst _DUMMY: () = {\r\n    mod some_mod {\r\n        pub struct Bar;\r\n    }\r\n    // This fails\r\n    use self::some_mod::Bar;    \r\n\r\n    // This also fails\r\n    fn foo(_: self::some_mod::Bar) {}\r\n};\r\n```\r\n\r\nThis behaviour  seems inconsistent for me. Either it should not be allowed to place modules inside of constants, or it should be possible to use relative paths to reference items inside of such modules (in scope of the constant block).\r\n\r\nI would guess that the scope of self is not associated with the inner scope of the constant, but with the current module. From there the module inside of the constant is not visible.\r\n\r\n\r\nThis happens on all channels. \r\n\r\n\r\nPlayground links:\r\n* [Working](https://play.rust-lang.org/?gist=71ac1b7d208d2552ef2354f7f8f6d46a&version=stable&mode=debug&edition=2015)\r\n* [Not working](https://play.rust-lang.org/?gist=b00b6071c02b2c6a8821ffdf50fc4d4d&version=stable&mode=debug&edition=2015)", "closed_by": {"login": "petrochenkov", "id": 5751617, "node_id": "MDQ6VXNlcjU3NTE2MTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5751617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petrochenkov", "html_url": "https://github.com/petrochenkov", "followers_url": "https://api.github.com/users/petrochenkov/followers", "following_url": "https://api.github.com/users/petrochenkov/following{/other_user}", "gists_url": "https://api.github.com/users/petrochenkov/gists{/gist_id}", "starred_url": "https://api.github.com/users/petrochenkov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petrochenkov/subscriptions", "organizations_url": "https://api.github.com/users/petrochenkov/orgs", "repos_url": "https://api.github.com/users/petrochenkov/repos", "events_url": "https://api.github.com/users/petrochenkov/events{/privacy}", "received_events_url": "https://api.github.com/users/petrochenkov/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/54525/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/54525/timeline", "performed_via_github_app": null, "state_reason": "completed"}