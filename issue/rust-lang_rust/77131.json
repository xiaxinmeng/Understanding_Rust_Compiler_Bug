{"url": "https://api.github.com/repos/rust-lang/rust/issues/77131", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/77131/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/77131/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/77131/events", "html_url": "https://github.com/rust-lang/rust/issues/77131", "id": 707770310, "node_id": "MDU6SXNzdWU3MDc3NzAzMTA=", "number": 77131, "title": "[AVR] result of `i32 as f32` is incorrect", "user": {"login": "jsen-", "id": 1452008, "node_id": "MDQ6VXNlcjE0NTIwMDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1452008?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsen-", "html_url": "https://github.com/jsen-", "followers_url": "https://api.github.com/users/jsen-/followers", "following_url": "https://api.github.com/users/jsen-/following{/other_user}", "gists_url": "https://api.github.com/users/jsen-/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsen-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsen-/subscriptions", "organizations_url": "https://api.github.com/users/jsen-/orgs", "repos_url": "https://api.github.com/users/jsen-/repos", "events_url": "https://api.github.com/users/jsen-/events{/privacy}", "received_events_url": "https://api.github.com/users/jsen-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}, {"id": 1359848690, "node_id": "MDU6TGFiZWwxMzU5ODQ4Njkw", "url": "https://api.github.com/repos/rust-lang/rust/labels/E-needs-mcve", "name": "E-needs-mcve", "color": "02e10c", "default": false, "description": "Call for participation: This issue needs a Minimal Complete and Verifiable Example"}, {"id": 1472563007, "node_id": "MDU6TGFiZWwxNDcyNTYzMDA3", "url": "https://api.github.com/repos/rust-lang/rust/labels/requires-nightly", "name": "requires-nightly", "color": "76dcde", "default": false, "description": "This issue requires a nightly compiler in some way."}, {"id": 1884641928, "node_id": "MDU6TGFiZWwxODg0NjQxOTI4", "url": "https://api.github.com/repos/rust-lang/rust/labels/O-AVR", "name": "O-AVR", "color": "6e6ec0", "default": false, "description": "Target: AVR processors (ATtiny, ATmega, etc.)"}, {"id": 2139259423, "node_id": "MDU6TGFiZWwyMTM5MjU5NDIz", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-floating-point", "name": "A-floating-point", "color": "f7e101", "default": false, "description": "Area: Floating point numbers and arithmetic"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-09-24T00:46:31Z", "updated_at": "2023-02-02T19:13:47Z", "closed_at": "2023-02-02T19:13:47Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I tried this code: https://github.com/jsen-/rust-i32-as-f32-issue-repro\r\n\r\nI expected to see this happen:\r\nEvery `i32` value converted to `f32` should have equal decimal part and zeros-only after decimal point.\r\n\r\nInstead, this happened:\r\n```\r\ni32   manual   using \"as\"\r\n      conv.\r\n----------------------------\r\n0     0.0000   0.0000\r\n1     1.0000   1.0078\r\n2     2.0000   2.0313\r\n3     3.0000   2.0469\r\n4     4.0000   4.1250\r\n5     5.0000   4.1563\r\n6     6.0000   4.1875\r\n7     7.0000   4.2188\r\n8     8.0000   8.5000\r\n9     9.0000   8.5625\r\n10   10.0000   8.6250\r\n11   11.0000   8.6875\r\n12   12.0000   8.7500\r\n13   13.0000   8.8125\r\n14   14.0000   8.8750\r\n15   15.0000   8.9375\r\n16   16.0000  18.0000\r\n...\r\n```\r\n[full output](https://github.com/jsen-/rust-i32-as-f32-issue-repro/blob/master/output.txt)\r\n\r\n### Meta\r\n`rustc --version --verbose`:\r\n```\r\nrustc 1.48.0-nightly (0da580074 2020-09-22)\r\nbinary: rustc\r\ncommit-hash: 0da58007451a154da2480160429e1604a1f5f0ec\r\ncommit-date: 2020-09-22\r\nhost: x86_64-unknown-linux-gnu\r\nrelease: 1.48.0-nightly\r\nLLVM version: **11.0**\r\n```\r\ntested on `arduino nano`\r\n\r\n***Note***: I updated [compiler-builtins](https://github.com/rust-lang/rust/blob/8b4085359ae798dedb05c95ad42520557bd25320/library/std/Cargo.toml#L20) to `0.1.36`, because without [this commit](https://github.com/rust-lang/compiler-builtins/commit/b8fb0b19d86b8f35adaae56123e2a0a97b2b716b) I was getting undefined symbols `__ashlsi3` and `__lshrsi3`\r\n\r\n***Note2:***: Debug builds don't link due to missing references `core::panicking::panic::hc30e67a739c4d8d1`, but that's a separate issue. Release builds fine.", "closed_by": {"login": "workingjubilee", "id": 46493976, "node_id": "MDQ6VXNlcjQ2NDkzOTc2", "avatar_url": "https://avatars.githubusercontent.com/u/46493976?v=4", "gravatar_id": "", "url": "https://api.github.com/users/workingjubilee", "html_url": "https://github.com/workingjubilee", "followers_url": "https://api.github.com/users/workingjubilee/followers", "following_url": "https://api.github.com/users/workingjubilee/following{/other_user}", "gists_url": "https://api.github.com/users/workingjubilee/gists{/gist_id}", "starred_url": "https://api.github.com/users/workingjubilee/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/workingjubilee/subscriptions", "organizations_url": "https://api.github.com/users/workingjubilee/orgs", "repos_url": "https://api.github.com/users/workingjubilee/repos", "events_url": "https://api.github.com/users/workingjubilee/events{/privacy}", "received_events_url": "https://api.github.com/users/workingjubilee/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/77131/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/77131/timeline", "performed_via_github_app": null, "state_reason": "completed"}