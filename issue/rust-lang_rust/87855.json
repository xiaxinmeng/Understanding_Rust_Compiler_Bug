{"url": "https://api.github.com/repos/rust-lang/rust/issues/87855", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/87855/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/87855/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/87855/events", "html_url": "https://github.com/rust-lang/rust/issues/87855", "id": 963301470, "node_id": "MDU6SXNzdWU5NjMzMDE0NzA=", "number": 87855, "title": "Invalid diagnostic when executing Type associated function inside of module but module is not found (misspelled / not imported)", "user": {"login": "pheki", "id": 19574371, "node_id": "MDQ6VXNlcjE5NTc0Mzcx", "avatar_url": "https://avatars.githubusercontent.com/u/19574371?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pheki", "html_url": "https://github.com/pheki", "followers_url": "https://api.github.com/users/pheki/followers", "following_url": "https://api.github.com/users/pheki/following{/other_user}", "gists_url": "https://api.github.com/users/pheki/gists{/gist_id}", "starred_url": "https://api.github.com/users/pheki/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pheki/subscriptions", "organizations_url": "https://api.github.com/users/pheki/orgs", "repos_url": "https://api.github.com/users/pheki/repos", "events_url": "https://api.github.com/users/pheki/events{/privacy}", "received_events_url": "https://api.github.com/users/pheki/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 235791, "node_id": "MDU6TGFiZWwyMzU3OTE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-diagnostics", "name": "A-diagnostics", "color": "f7e101", "default": false, "description": "Area: Messages for errors, warnings, and lints"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-08-07T20:46:58Z", "updated_at": "2021-08-07T20:46:58Z", "closed_at": null, "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "When trying to execute an associated function in a type by using the path starting from the module, but the module is incorrect / doesn't exist and a type with that exact name exists, the error says \"use of undeclared crate or module\" (correct) but the detailed diagnostic shows \"Struct not found in module\" (incorrect), as if the module existed. A little confusing, better shown by code:\r\n\r\nGiven the following code: [playground](https://play.rust-lang.org/?version=stable&mode=debug&edition=2018&code=fn%20function()%20%7B%0A%20%20%20%20wrong_module_name%3A%3AStruct%3A%3Amethod()%3B%0A%7D%0A%0Amod%20mod_1%20%7B%0A%20%20%20%20pub%20struct%20Struct%3B%0A%0A%20%20%20%20impl%20Struct%20%7B%0A%20%20%20%20%20%20%20%20fn%20method()%20%7B%7D%0A%20%20%20%20%7D%0A%7D%0A)\r\n\r\n```rust\r\nfn function() {\r\n    wrong_module_name::Struct::method();\r\n}\r\n\r\nmod mod_1 {\r\n    pub struct Struct;\r\n\r\n    impl Struct {\r\n        fn method() {}\r\n    }\r\n}\r\n```\r\n\r\nThe current output is:\r\n\r\n```\r\nerror[E0433]: failed to resolve: use of undeclared crate or module `wrong_module_name`\r\n --> src/lib.rs:2:24\r\n  |\r\n2 |     wrong_module_name::Struct::method();\r\n  |                        ^^^^^^ not found in `wrong_module_name`\r\n  |\r\nhelp: consider importing one of these items\r\n  |\r\n1 | use crate::mod_1::Struct;\r\n  |\r\n```\r\n\r\nAlso, the suggestion would not work.\r\n\r\nIdeally the output should look like:\r\n\r\n```\r\nerror[E0433]: failed to resolve: use of undeclared crate or module `wrong_module_name`\r\n --> src/lib.rs:2:5\r\n  |\r\n2 |     wrong_module_name::Struct::method();\r\n  |     ^^^^^^^^^^^^^^^^^ use of undeclared crate or module `wrong_module_name`\r\n```\r\n\r\nReproduced at least on 1.52.0, beta and nightly-2021-08-06.\r\n\r\nDoes reproduce the error:\r\n- [Same code as above](https://play.rust-lang.org/?version=stable&mode=debug&edition=2018&code=fn%20function()%20%7B%0A%20%20%20%20wrong_module_name%3A%3AStruct%3A%3Amethod()%3B%0A%7D%0A%0Amod%20mod_1%20%7B%0A%20%20%20%20pub%20struct%20Struct%3B%0A%0A%20%20%20%20impl%20Struct%20%7B%0A%20%20%20%20%20%20%20%20fn%20method()%20%7B%7D%0A%20%20%20%20%7D%0A%7D%0A)\r\n- [Method does not exist](https://play.rust-lang.org/?version=stable&mode=debug&edition=2018&code=fn%20function()%20%7B%0A%20%20%20%20wrong_module_name%3A%3AStruct%3A%3Amethod()%3B%0A%7D%0A%0Amod%20mod_1%20%7B%0A%20%20%20%20pub%20struct%20Struct%3B%0A%7D%0A)\r\n- [Struct defined in outside module (in syn as the playground includes it in their dependencies)](https://play.rust-lang.org/?version=stable&mode=debug&edition=2018&code=fn%20function()%20%7B%0A%20%20%20%20wrong_module_name%3A%3AStruct%3A%3Amethod()%3B%0A%7D%0A)\r\n- [Correct module name but not imported](https://play.rust-lang.org/?version=stable&mode=debug&edition=2018&code=mod%20mod_0%20%7B%0A%20%20%20%20fn%20function()%20%7B%0A%20%20%20%20%20%20%20%20mod_1%3A%3AStruct%3A%3Amethod()%3B%0A%20%20%20%20%7D%0A%7D%0A%0Amod%20mod_1%20%7B%0A%20%20%20%20pub%20struct%20Struct%3B%0A%0A%20%20%20%20impl%20Struct%20%7B%0A%20%20%20%20%20%20%20%20fn%20method()%20%7B%7D%0A%20%20%20%20%7D%0A%7D%0A)\r\n- [Enum instead of Struct](https://play.rust-lang.org/?version=stable&mode=debug&edition=2018&code=fn%20function()%20%7B%0A%20%20%20%20wrong_module_name%3A%3AMyEnum%3A%3Amethod()%3B%0A%7D%0A%0Amod%20mod_1%20%7B%0A%20%20%20%20pub%20enum%20MyEnum%20%7B%7D%0A%0A%20%20%20%20impl%20MyEnum%20%7B%0A%20%20%20%20%20%20%20%20fn%20method()%20%7B%7D%0A%20%20%20%20%7D%0A%7D%0A)\r\n- [Type alias with that name exists](https://play.rust-lang.org/?version=stable&mode=debug&edition=2018&code=fn%20function()%20%7B%0A%20%20%20%20wrong_module_name%3A%3AMyStruct%3A%3Amethod()%3B%0A%7D%0A%0Amod%20mod_1%20%7B%0A%20%20%20%20type%20MyStruct%20%3D%20Struct%3B%0A%20%20%20%20struct%20Struct%3B%0A%0A%20%20%20%20impl%20Struct%20%7B%0A%20%20%20%20%20%20%20%20fn%20method()%20%7B%7D%0A%20%20%20%20%7D%0A%7D%0A)\r\n\r\nDoes **not** reproduce the error:\r\n- [No method call](https://play.rust-lang.org/?version=stable&mode=debug&edition=2018&code=fn%20function()%20%7B%0A%20%20%20%20wrong_module_name%3A%3AStruct%3B%0A%7D%0A%0Amod%20mod_1%20%7B%0A%20%20%20%20pub%20struct%20Struct%3B%0A%7D%0A)\r\n- [Using module instead of struct for namespacing](https://play.rust-lang.org/?version=stable&mode=debug&edition=2018&code=fn%20function()%20%7B%0A%20%20%20%20wrong_module_name%3A%3Amod_2%3A%3Amethod()%3B%0A%7D%0A%0Amod%20mod_1%20%7B%0A%20%20%20%20mod%20mod_2%20%7B%0A%20%20%20%20%20%20%20%20fn%20method()%20%7B%7D%0A%20%20%20%20%7D%0A%7D%0A)\r\n- [No struct with that name exists](https://play.rust-lang.org/?version=stable&mode=debug&edition=2018&code=fn%20function()%20%7B%0A%20%20%20%20wrong_module_name%3A%3AStruct42%3A%3Amethod()%3B%0A%7D%0A)", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/87855/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/87855/timeline", "performed_via_github_app": null, "state_reason": null}