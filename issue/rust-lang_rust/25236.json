{"url": "https://api.github.com/repos/rust-lang/rust/issues/25236", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/25236/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/25236/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/25236/events", "html_url": "https://github.com/rust-lang/rust/issues/25236", "id": 74570194, "node_id": "MDU6SXNzdWU3NDU3MDE5NA==", "number": 25236, "title": "Cannot expand ty into a generic function constraint during macro expansion", "user": {"login": "thelink2012", "id": 5925581, "node_id": "MDQ6VXNlcjU5MjU1ODE=", "avatar_url": "https://avatars.githubusercontent.com/u/5925581?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thelink2012", "html_url": "https://github.com/thelink2012", "followers_url": "https://api.github.com/users/thelink2012/followers", "following_url": "https://api.github.com/users/thelink2012/following{/other_user}", "gists_url": "https://api.github.com/users/thelink2012/gists{/gist_id}", "starred_url": "https://api.github.com/users/thelink2012/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thelink2012/subscriptions", "organizations_url": "https://api.github.com/users/thelink2012/orgs", "repos_url": "https://api.github.com/users/thelink2012/repos", "events_url": "https://api.github.com/users/thelink2012/events{/privacy}", "received_events_url": "https://api.github.com/users/thelink2012/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 132910982, "node_id": "MDU6TGFiZWwxMzI5MTA5ODI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-macros", "name": "A-macros", "color": "f7e101", "default": false, "description": "Area: All kinds of macros (custom derive, macro_rules!, proc macros, ..)"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2015-05-09T03:17:40Z", "updated_at": "2015-05-10T19:11:04Z", "closed_at": "2015-05-10T18:50:14Z", "author_association": "NONE", "active_lock_reason": null, "body": "In a macro, whenever a `ty` is expanded into a generic function constrait an error gets issued during the macro expansion.\n\nThis (http://is.gd/nJgJwq)\n\n```\nuse std::ops::Add;\n\nmacro_rules! test {\n    (\n        fn fun<F: $f_type:ty>();\n    ) => {\n        fn fun<F: $f_type>(_f: F)  {}\n    }\n}\n\ntest! {\n    fn fun<F: Add>();\n}\n```\n\nGives\n\n```\n<anon>:7:19: 7:26 error: expected one of `,`, `=`, `>`, or `?`, found `Add`\n<anon>:7         fn fun<F: $f_type>(_f: F)  {}\n```\n\nAnd moving the F into a `where` in the expansion block doesn't fix it but gives another message (http://is.gd/93BKLN):\n\n```\n<anon>:7:32: 7:42 error: each predicate in a `where` clause must have at least one bound in it\n<anon>:7         fn fun<F>(_f: F) where F: $f_type  {}\n                                        ^~~~~~~~~~\n<anon>:7:35: 7:42 error: expected one of `,`, `?`, or `{`, found `Add`\n<anon>:7         fn fun<F>(_f: F) where F: $f_type  {}\n                                           ^~~~~~~\n```\n\nFor the sake of testing purposes I tried other types instead of `ty` in the macro and `ident` worked, however only for simple names like `Add`, when names such as `ops::Add` or `Fn(i32)` are used errors are issued (http://is.gd/PJDQbY):\n\n```\n`<anon>:15:15: 15:17 error: no rules expected the token `::`\n<anon>:15     fn fun<ops::Add>();\n                        ^~\n```\n## Meta\n\nAll the tests were conducted on the playpen using the nightly and beta option (no difference) so I'm not sure about the version but the issue also happens on my local installation `rustc 1.0.0-beta.3 (5241bf9c3 2015-04-25) (built 2015-04-25)` _(yep a bit outdated but cba to update eh)_.\n", "closed_by": {"login": "thelink2012", "id": 5925581, "node_id": "MDQ6VXNlcjU5MjU1ODE=", "avatar_url": "https://avatars.githubusercontent.com/u/5925581?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thelink2012", "html_url": "https://github.com/thelink2012", "followers_url": "https://api.github.com/users/thelink2012/followers", "following_url": "https://api.github.com/users/thelink2012/following{/other_user}", "gists_url": "https://api.github.com/users/thelink2012/gists{/gist_id}", "starred_url": "https://api.github.com/users/thelink2012/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thelink2012/subscriptions", "organizations_url": "https://api.github.com/users/thelink2012/orgs", "repos_url": "https://api.github.com/users/thelink2012/repos", "events_url": "https://api.github.com/users/thelink2012/events{/privacy}", "received_events_url": "https://api.github.com/users/thelink2012/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/25236/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/25236/timeline", "performed_via_github_app": null, "state_reason": "completed"}