{"url": "https://api.github.com/repos/rust-lang/rust/issues/44873", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/44873/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/44873/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/44873/events", "html_url": "https://github.com/rust-lang/rust/issues/44873", "id": 260765012, "node_id": "MDU6SXNzdWUyNjA3NjUwMTI=", "number": 44873, "title": "Application fails to run on Windows XP", "user": {"login": "gstar4", "id": 32311661, "node_id": "MDQ6VXNlcjMyMzExNjYx", "avatar_url": "https://avatars.githubusercontent.com/u/32311661?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gstar4", "html_url": "https://github.com/gstar4", "followers_url": "https://api.github.com/users/gstar4/followers", "following_url": "https://api.github.com/users/gstar4/following{/other_user}", "gists_url": "https://api.github.com/users/gstar4/gists{/gist_id}", "starred_url": "https://api.github.com/users/gstar4/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gstar4/subscriptions", "organizations_url": "https://api.github.com/users/gstar4/orgs", "repos_url": "https://api.github.com/users/gstar4/repos", "events_url": "https://api.github.com/users/gstar4/events{/privacy}", "received_events_url": "https://api.github.com/users/gstar4/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2017-09-26T20:48:39Z", "updated_at": "2017-09-26T21:49:24Z", "closed_at": "2017-09-26T21:49:24Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am trying to create a simple HTTP client that runs on all versions of Windows XP and newer.\r\n\r\nWindows XP is currently officially [supported as a tier 3 platform in Rust](https://forge.rust-lang.org/platform-support.html).\r\n\r\nSupport for XP was added to `std` in #24776\r\n\r\nThe sample code I am trying to compile is:\r\n\r\n```rust\r\nextern crate reqwest; // version 0.7.3 specified in Cargo.toml\r\n\r\nfn main() {\r\n    reqwest::get(\"https://www.rust-lang.org\")\r\n}\r\n```\r\n\r\nI am following the following steps to build a portable Windows XP and newer compatible Rust binary. I am building from a Windows 10 x64 host.\r\n\r\nSet `RUSTFLAGS` environment variable to \r\n\r\n```\r\n-C target-feature=+crt-static -C link-arg=/SUBSYSTEM:CONSOLE,5.01\r\n```\r\n\r\nBuild with 32-bit toolchain\r\n\r\n```bash\r\n$ rustup toolchain install stable-i686-pc-windows-msvc\r\n\r\n$ cargo +stable-i686-pc-windows-msvc build --release\r\n```\r\n\r\nThe resulting binary is linked to\r\n\r\n```\r\nsecur32.dll\r\ncrypt32.dll\r\nadvapi32.dll\r\nws2_32.dll\r\nkernel32.dll\r\n```\r\n\r\nand is properly listed with NT 5.1 as the operating system in the PE header.\r\n\r\nWhen run on Windows XP SP3 32-bit an error is shown:\r\n\r\n```\r\nThe procedure entry point SetFileCompletionNotificationModes could not be located in the dynamic link \r\nlibrary KERNEL32.dll.\r\n```\r\n\r\nFollowing these same steps, a \"Hello, World!\" executable does execute properly on Windows XP SP3.\r\n\r\nIs this a problem with `std`? One of the dependancies? Is there a way to instruct Cargo/rustc/MSVC linker to avoid this call to KERNEL32.dll?\r\n\r\ncc Windows Bunny Master @retep998 ", "closed_by": {"login": "sfackler", "id": 1455697, "node_id": "MDQ6VXNlcjE0NTU2OTc=", "avatar_url": "https://avatars.githubusercontent.com/u/1455697?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sfackler", "html_url": "https://github.com/sfackler", "followers_url": "https://api.github.com/users/sfackler/followers", "following_url": "https://api.github.com/users/sfackler/following{/other_user}", "gists_url": "https://api.github.com/users/sfackler/gists{/gist_id}", "starred_url": "https://api.github.com/users/sfackler/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sfackler/subscriptions", "organizations_url": "https://api.github.com/users/sfackler/orgs", "repos_url": "https://api.github.com/users/sfackler/repos", "events_url": "https://api.github.com/users/sfackler/events{/privacy}", "received_events_url": "https://api.github.com/users/sfackler/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/44873/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/44873/timeline", "performed_via_github_app": null, "state_reason": "completed"}