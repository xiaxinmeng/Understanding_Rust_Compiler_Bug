{"url": "https://api.github.com/repos/rust-lang/rust/issues/26162", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/26162/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/26162/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/26162/events", "html_url": "https://github.com/rust-lang/rust/issues/26162", "id": 86800847, "node_id": "MDU6SXNzdWU4NjgwMDg0Nw==", "number": 26162, "title": "ICE: assertion failed: self.appropriate_rvalue_mode(bcx.ccx()) == ByValue", "user": {"login": "mattgodbolt", "id": 633973, "node_id": "MDQ6VXNlcjYzMzk3Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/633973?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mattgodbolt", "html_url": "https://github.com/mattgodbolt", "followers_url": "https://api.github.com/users/mattgodbolt/followers", "following_url": "https://api.github.com/users/mattgodbolt/following{/other_user}", "gists_url": "https://api.github.com/users/mattgodbolt/gists{/gist_id}", "starred_url": "https://api.github.com/users/mattgodbolt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mattgodbolt/subscriptions", "organizations_url": "https://api.github.com/users/mattgodbolt/orgs", "repos_url": "https://api.github.com/users/mattgodbolt/repos", "events_url": "https://api.github.com/users/mattgodbolt/events{/privacy}", "received_events_url": "https://api.github.com/users/mattgodbolt/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2015-06-10T02:00:20Z", "updated_at": "2015-06-10T12:06:13Z", "closed_at": "2015-06-10T12:06:13Z", "author_association": "NONE", "active_lock_reason": null, "body": "While refactoring some code I tripped over this one. As most of the program has changed, I'm not sure what the actual cause is. Posting here in case someone can help me fathom what it is.\n\nLooks superficially similar to #23888 but it's not clear that my changes have introduced an == on \"fat raw pointers\".\n\nsrc/geometry.rs:72:26: 72:29 warning: unused variable: `rng`, #[warn(unused_variables)] on by default\nsrc/geometry.rs:72     fn random_pos(&self, rng: &mut F64Rng) -> Vec3d {\n                                            ^~~\nerror: internal compiler error: unexpected panic\nnote: the compiler unexpectedly panicked. this is a bug.\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports\nnote: run with `RUST_BACKTRACE=1` for a backtrace\nthread 'rustc' panicked at 'assertion failed: self.appropriate_rvalue_mode(bcx.ccx()) == ByValue', /home/rustbuild/src/rust-buildbot/slave/stable-dist-rustc-linux/build/src/librustc_trans/trans/datum.rs:646\n\nstack backtrace:\n   1:     0x7f7444b3f449 - sys::backtrace::write::hbc46dc0cfb3b9537d4r\n   2:     0x7f7444b47156 - panicking::on_panic::h74d3c14d86c58ac8jrw\n   3:     0x7f7444b0a462 - rt::unwind::begin_unwind_inner::h382cea404b11eb00t6v\n   4:     0x7f744420137e - rt::unwind::begin_unwind::h11527883117899559464\n   5:     0x7f7444291db2 - trans::datum::Datum<'tcx, K>::to_llscalarish::h13658016800508616489\n   6:     0x7f7444314d08 - trans::expr::trans_binary::h675be97e90ac8015O6B\n   7:     0x7f744430b72c - trans::expr::trans_unadjusted::h36bc1189b1eec85e9zA\n   8:     0x7f7444244ad4 - trans::expr::trans::h7f89da2569c8dc1bgdA\n   9:     0x7f744430d086 - trans::expr::trans_rvalue_dps_unadjusted::h7c0140fcbfb13319C5A\n  10:     0x7f74442e0fd7 - trans::expr::trans_into::h10885d95ed8d401aX6z\n  11:     0x7f7444265b0e - trans::controlflow::trans_block::hfa898015a1217b0b02u\n  12:     0x7f744430c6e9 - trans::expr::trans_rvalue_dps_unadjusted::h7c0140fcbfb13319C5A\n  13:     0x7f74442e0fd7 - trans::expr::trans_into::h10885d95ed8d401aX6z\n  14:     0x7f744434b753 - trans::_match::trans_match_inner::h6119af2a2800890b61H\n  15:     0x7f744430c6b3 - trans::expr::trans_rvalue_dps_unadjusted::h7c0140fcbfb13319C5A\n  16:     0x7f74442e0fd7 - trans::expr::trans_into::h10885d95ed8d401aX6z\n  17:     0x7f7444265b0e - trans::controlflow::trans_block::hfa898015a1217b0b02u\n  18:     0x7f74442645b1 - trans::base::trans_closure::h8e5687f4ccb96c5eLCh\n  19:     0x7f74442660ea - trans::base::trans_fn::h0bc8fb6dbe17d6adtNh\n  20:     0x7f7444269c44 - trans::base::trans_item::h4f9c99b1e4474396Fbi\n  21:     0x7f7444269ab8 - trans::base::trans_item::h4f9c99b1e4474396Fbi\n  22:     0x7f744427756d - trans::base::trans_crate::haa02506df24d5efcF0i\n  23:     0x7f744508d0fa - driver::phase_4_translate_to_llvm::h86d6fb84c5c936d5hOa\n  24:     0x7f7445064faa - driver::compile_input::hb78754f2f33c01efQba\n  25:     0x7f74451264d1 - run_compiler::h258d36d5501c1cdfz4b\n  26:     0x7f7445124122 - boxed::F.FnBox<A>::call_box::h7239693171334256553\n  27:     0x7f7445123659 - rt::unwind::try::try_fn::h14329119008520845439\n  28:     0x7f7444bb9ac8 - rust_try_inner\n  29:     0x7f7444bb9ab5 - rust_try\n  30:     0x7f7445123908 - boxed::F.FnBox<A>::call_box::h17332056298259451807\n  31:     0x7f7444b46041 - sys::thread::create::thread_start::h490278b5c3c0b49faqv\n  32:     0x7f743f3c8181 - start_thread\n  33:     0x7f744479047c - __clone\n  34:                0x0 - <unknown>\n\nCould not compile `path_tracer`.\n\nCaused by:\n  Process didn't exit successfully: `rustc src/lib.rs --crate-name path_tracer --crate-type lib -g --out-dir /home/mgodbolt/dev/path-tracer/target/debug --emit=dep-info,link -L dependency=/home/mgodbolt/dev/path-tracer/target/debug -L dependency=/home/mgodbolt/dev/path-tracer/target/debug/deps --extern image=/home/mgodbolt/dev/path-tracer/target/debug/deps/libimage-0d2eddca90a3c251.rlib --extern threadpool=/home/mgodbolt/dev/path-tracer/target/debug/deps/libthreadpool-213781c0d8fba90b.rlib --extern rand=/home/mgodbolt/dev/path-tracer/target/debug/deps/librand-b924d9fc5b3eb5b8.rlib --extern num_cpus=/home/mgodbolt/dev/path-tracer/target/debug/deps/libnum_cpus-d64cdaf0c78cf4e8.rlib --extern argparse=/home/mgodbolt/dev/path-tracer/target/debug/deps/libargparse-e91dcf4972ac931d.rlib` (exit code: 101)\n\nI've checked in the code at https://github.com/mattgodbolt/path-tracer/tree/ice and will leave that 'ice' branch pointing at the broken build while I try and find a workaround and/or fix.\n", "closed_by": {"login": "mattgodbolt", "id": 633973, "node_id": "MDQ6VXNlcjYzMzk3Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/633973?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mattgodbolt", "html_url": "https://github.com/mattgodbolt", "followers_url": "https://api.github.com/users/mattgodbolt/followers", "following_url": "https://api.github.com/users/mattgodbolt/following{/other_user}", "gists_url": "https://api.github.com/users/mattgodbolt/gists{/gist_id}", "starred_url": "https://api.github.com/users/mattgodbolt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mattgodbolt/subscriptions", "organizations_url": "https://api.github.com/users/mattgodbolt/orgs", "repos_url": "https://api.github.com/users/mattgodbolt/repos", "events_url": "https://api.github.com/users/mattgodbolt/events{/privacy}", "received_events_url": "https://api.github.com/users/mattgodbolt/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/26162/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/26162/timeline", "performed_via_github_app": null, "state_reason": "completed"}