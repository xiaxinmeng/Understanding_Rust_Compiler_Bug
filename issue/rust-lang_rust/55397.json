{"url": "https://api.github.com/repos/rust-lang/rust/issues/55397", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/55397/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/55397/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/55397/events", "html_url": "https://github.com/rust-lang/rust/issues/55397", "id": 374500308, "node_id": "MDU6SXNzdWUzNzQ1MDAzMDg=", "number": 55397, "title": "Trivial proc macro crate can't be found for doc tests", "user": {"login": "jrobsonchase", "id": 1553581, "node_id": "MDQ6VXNlcjE1NTM1ODE=", "avatar_url": "https://avatars.githubusercontent.com/u/1553581?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jrobsonchase", "html_url": "https://github.com/jrobsonchase", "followers_url": "https://api.github.com/users/jrobsonchase/followers", "following_url": "https://api.github.com/users/jrobsonchase/following{/other_user}", "gists_url": "https://api.github.com/users/jrobsonchase/gists{/gist_id}", "starred_url": "https://api.github.com/users/jrobsonchase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jrobsonchase/subscriptions", "organizations_url": "https://api.github.com/users/jrobsonchase/orgs", "repos_url": "https://api.github.com/users/jrobsonchase/repos", "events_url": "https://api.github.com/users/jrobsonchase/events{/privacy}", "received_events_url": "https://api.github.com/users/jrobsonchase/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 203738, "node_id": "MDU6TGFiZWwyMDM3Mzg=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-rustdoc", "name": "T-rustdoc", "color": "bfd4f2", "default": false, "description": "Relevant to the rustdoc team, which will review and decide on the PR/issue."}, {"id": 132910982, "node_id": "MDU6TGFiZWwxMzI5MTA5ODI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-macros", "name": "A-macros", "color": "f7e101", "default": false, "description": "Area: All kinds of macros (custom derive, macro_rules!, proc macros, ..)"}, {"id": 1118559391, "node_id": "MDU6TGFiZWwxMTE4NTU5Mzkx", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-doctests", "name": "A-doctests", "color": "f7e101", "default": false, "description": "Area: Documentation tests, run by rustdoc"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2018-10-26T18:36:45Z", "updated_at": "2020-10-13T18:56:44Z", "closed_at": null, "author_association": "NONE", "active_lock_reason": null, "body": "I tried making a trivial proc macro crate to try out the newly stabilized things in 1.30 and ran into a problem when running the tests from a crate that imports it.\r\n\r\nThe normal compilation/tests run perfectly fine, but then it tries to run doc tests, even though I have no doc comments or any other comments for that matter. When running these nonexistant doc tests, it fails to locate my proc macro crate, even though it was definitely there and working correctly for the normal tests.\r\n\r\nFull error:\r\n```\r\n$ cargo +stable test\r\n   Compiling foo v0.1.0 (/tmp/new_rust_testing/foo)                                                                                                                                            \r\n   Compiling baz v0.1.0 (/tmp/new_rust_testing/baz)                                                                                                                                            \r\n    Finished dev [unoptimized + debuginfo] target(s) in 0.87s                                                                                                                                  \r\n     Running target/debug/deps/baz-a6614c8413dbf748\r\n\r\nrunning 1 test\r\ntest tests::it_works ... ok\r\n\r\ntest result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out\r\n\r\n   Doc-tests baz\r\nerror[E0463]: can't find crate for `foo`\r\n --> /tmp/new_rust_testing/baz/src/lib.rs:1:1\r\n  |\r\n1 | extern crate foo;\r\n  | ^^^^^^^^^^^^^^^^^ can't find crate\r\n\r\nerror: test failed, to rerun pass '--doc'\r\n```\r\n\r\nFull code can be found at https://github.com/jrobsonchase/proc_macro_problem\r\n\r\nMy current rustc version:\r\n```\r\n$ rustup run stable rustc --version\r\nrustc 1.30.0 (da5f414c2 2018-10-24)\r\n```", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/55397/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/55397/timeline", "performed_via_github_app": null, "state_reason": null}