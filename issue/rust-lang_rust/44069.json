{"url": "https://api.github.com/repos/rust-lang/rust/issues/44069", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/44069/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/44069/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/44069/events", "html_url": "https://github.com/rust-lang/rust/issues/44069", "id": 252568227, "node_id": "MDU6SXNzdWUyNTI1NjgyMjc=", "number": 44069, "title": "The newest nightly breaks static musl builds.", "user": {"login": "golddranks", "id": 2675542, "node_id": "MDQ6VXNlcjI2NzU1NDI=", "avatar_url": "https://avatars.githubusercontent.com/u/2675542?v=4", "gravatar_id": "", "url": "https://api.github.com/users/golddranks", "html_url": "https://github.com/golddranks", "followers_url": "https://api.github.com/users/golddranks/followers", "following_url": "https://api.github.com/users/golddranks/following{/other_user}", "gists_url": "https://api.github.com/users/golddranks/gists{/gist_id}", "starred_url": "https://api.github.com/users/golddranks/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/golddranks/subscriptions", "organizations_url": "https://api.github.com/users/golddranks/orgs", "repos_url": "https://api.github.com/users/golddranks/repos", "events_url": "https://api.github.com/users/golddranks/events{/privacy}", "received_events_url": "https://api.github.com/users/golddranks/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 147085028, "node_id": "MDU6TGFiZWwxNDcwODUwMjg=", "url": "https://api.github.com/repos/rust-lang/rust/labels/regression-from-stable-to-nightly", "name": "regression-from-stable-to-nightly", "color": "e4008a", "default": false, "description": "Performance or correctness regression from stable to nightly."}, {"id": 203429200, "node_id": "MDU6TGFiZWwyMDM0MjkyMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/P-high", "name": "P-high", "color": "eb6420", "default": false, "description": "High priority"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2017-08-24T11:12:49Z", "updated_at": "2017-08-26T16:52:06Z", "closed_at": "2017-08-25T06:04:43Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "The newest nightly breaks static musl builds.\r\n\r\nThis is most likely to be caused by the landing of https://github.com/rust-lang/rust/pull/40113\r\n\r\nHere's a very simple demo: https://github.com/golddranks/rustc_broken_static_demo (Try running `build_old.sh` and `build_new.sh`)\r\n\r\nThe scripts build the hello world program in two environments: one with nightly `2017-08-23` and one with `2017-08-24`. The latter contains the PR #40113. The Dockerfile for the image is here: https://github.com/golddranks/rust_musl_docker\r\n\r\nThe former succeeds, whereas the latter fails with:\r\n```\r\n     Running `rustc --crate-name rustc_broken_static_demo src/main.rs --crate-type bin --emit=dep-info,link -C debuginfo=2 -C metadata=5a6a9f373ff62f0b -C extra-filename=-5a6a9f373ff62f0b --out-dir /workdir/target/x86_64-unknown-linux-musl/debug/deps --target x86_64-unknown-linux-musl -L dependency=/workdir/target/x86_64-unknown-linux-musl/debug/deps -L dependency=/workdir/target/debug/deps`\r\nerror: linking with `cc` failed: exit code: 1\r\n  |\r\n  = note: \"cc\" \"-Wl,--as-needed\" \"-Wl,-z,noexecstack\" \"-nostdlib\" \"-Wl,--eh-frame-hdr\" \"-Wl,-(\" \"-m64\" \"/root/.rustup/toolchains/nightly-2017-08-24-x86_64-unknown-linux-gnu/lib/rustlib/x86_64-unknown-linux-musl/lib/crt1.o\" \"/root/.rustup/toolchains/nightly-2017-08-24-x86_64-unknown-linux-gnu/lib/rustlib/x86_64-unknown-linux-musl/lib/crti.o\" \"-L\" \"/root/.rustup/toolchains/nightly-2017-08-24-x86_64-unknown-linux-gnu/lib/rustlib/x86_64-unknown-linux-musl/lib\" \"/workdir/target/x86_64-unknown-linux-musl/debug/deps/rustc_broken_static_demo-5a6a9f373ff62f0b.0.o\" \"-o\" \"/workdir/target/x86_64-unknown-linux-musl/debug/deps/rustc_broken_static_demo-5a6a9f373ff62f0b\" \"/workdir/target/x86_64-unknown-linux-musl/debug/deps/rustc_broken_static_demo-5a6a9f373ff62f0b.crate.allocator.o\" \"-Wl,--gc-sections\" \"-Wl,-z,relro,-z,now\" \"-nodefaultlibs\" \"-L\" \"/workdir/target/x86_64-unknown-linux-musl/debug/deps\" \"-L\" \"/workdir/target/debug/deps\" \"-L\" \"/root/.rustup/toolchains/nightly-2017-08-24-x86_64-unknown-linux-gnu/lib/rustlib/x86_64-unknown-linux-musl/lib\" \"-Wl,-Bstatic\" \"/root/.rustup/toolchains/nightly-2017-08-24-x86_64-unknown-linux-gnu/lib/rustlib/x86_64-unknown-linux-musl/lib/libstd-1873b4d191d228e8.rlib\" \"/root/.rustup/toolchains/nightly-2017-08-24-x86_64-unknown-linux-gnu/lib/rustlib/x86_64-unknown-linux-musl/lib/librand-655f47aee8a3420b.rlib\" \"/root/.rustup/toolchains/nightly-2017-08-24-x86_64-unknown-linux-gnu/lib/rustlib/x86_64-unknown-linux-musl/lib/liballoc_jemalloc-ab5831f4fba53ade.rlib\" \"/root/.rustup/toolchains/nightly-2017-08-24-x86_64-unknown-linux-gnu/lib/rustlib/x86_64-unknown-linux-musl/lib/liballoc_system-1c88582d9022c1cc.rlib\" \"/root/.rustup/toolchains/nightly-2017-08-24-x86_64-unknown-linux-gnu/lib/rustlib/x86_64-unknown-linux-musl/lib/libpanic_unwind-fa52c59d2108c1f8.rlib\" \"/root/.rustup/toolchains/nightly-2017-08-24-x86_64-unknown-linux-gnu/lib/rustlib/x86_64-unknown-linux-musl/lib/libunwind-45a286e82269a40e.rlib\" \"/root/.rustup/toolchains/nightly-2017-08-24-x86_64-unknown-linux-gnu/lib/rustlib/x86_64-unknown-linux-musl/lib/liblibc-d9d4ae8ab67a6001.rlib\" \"/root/.rustup/toolchains/nightly-2017-08-24-x86_64-unknown-linux-gnu/lib/rustlib/x86_64-unknown-linux-musl/lib/liballoc-d1d3fb714ff1a835.rlib\" \"/root/.rustup/toolchains/nightly-2017-08-24-x86_64-unknown-linux-gnu/lib/rustlib/x86_64-unknown-linux-musl/lib/libstd_unicode-10859fb08aa219d9.rlib\" \"/root/.rustup/toolchains/nightly-2017-08-24-x86_64-unknown-linux-gnu/lib/rustlib/x86_64-unknown-linux-musl/lib/libcore-da02dfafc4660314.rlib\" \"/root/.rustup/toolchains/nightly-2017-08-24-x86_64-unknown-linux-gnu/lib/rustlib/x86_64-unknown-linux-musl/lib/libcompiler_builtins-126bb39b1b53af10.rlib\" \"-l\" \"unwind\" \"-static\" \"-Wl,-Bdynamic\" \"/root/.rustup/toolchains/nightly-2017-08-24-x86_64-unknown-linux-gnu/lib/rustlib/x86_64-unknown-linux-musl/lib/crtn.o\" \"-Wl,-)\"\r\n  = note: /usr/bin/ld: cannot find -lunwind\r\n```", "closed_by": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/44069/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/44069/timeline", "performed_via_github_app": null, "state_reason": "completed"}