{"url": "https://api.github.com/repos/rust-lang/rust/issues/62206", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/62206/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/62206/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/62206/events", "html_url": "https://github.com/rust-lang/rust/issues/62206", "id": 462038455, "node_id": "MDU6SXNzdWU0NjIwMzg0NTU=", "number": 62206, "title": "Float equality checking does not issue warning", "user": {"login": "Recognition2", "id": 9716052, "node_id": "MDQ6VXNlcjk3MTYwNTI=", "avatar_url": "https://avatars.githubusercontent.com/u/9716052?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Recognition2", "html_url": "https://github.com/Recognition2", "followers_url": "https://api.github.com/users/Recognition2/followers", "following_url": "https://api.github.com/users/Recognition2/following{/other_user}", "gists_url": "https://api.github.com/users/Recognition2/gists{/gist_id}", "starred_url": "https://api.github.com/users/Recognition2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Recognition2/subscriptions", "organizations_url": "https://api.github.com/users/Recognition2/orgs", "repos_url": "https://api.github.com/users/Recognition2/repos", "events_url": "https://api.github.com/users/Recognition2/events{/privacy}", "received_events_url": "https://api.github.com/users/Recognition2/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-06-28T13:35:40Z", "updated_at": "2019-06-28T13:45:20Z", "closed_at": "2019-06-28T13:45:20Z", "author_association": "NONE", "active_lock_reason": null, "body": "When checking  two floats for equality, the Rust compiler does not issue a warning. This is unexpected behaviour, because it is rarely necessary (nor intended behaviour) to bitwise equality-check 2 floating point numbers.\r\n\r\nFor instance, when running the following code\r\n```rust\r\nfn main() {\r\n    let a: f64 = (std::f64::consts::PI * 2.).sin();\r\n    let b: f64 = (std::f64::consts::PI * 4.).sin();\r\n\r\n    println!(\"Is a equal to b? >{}\", a == b);\r\n}\r\n```\r\nThis will print: `Is a equal to b? >false`.\r\nMathematically, we expect this to be true, since zero is equal to zero. \r\nHowever logically the zeroes are slightly different because of rounding errors.\r\n\r\nThis is why equality checking on floating point numbers is generally frowned upon. Instead, one should use `(a - b).abs() < epsilon` with epsilon in the region of 1e-15 (or on 32-bit representations 1e-7). This way, these miniscule differences do not cause logical errors in programs.\r\n\r\nHowever, uninformed people who do not know how floats work exactly may be fooled by this. \r\nThis is why I think the compiler should issue a warning when comparing floats, or even an error. It is very rarely necessary to bitwise compare floats. \r\n\r\nIt is noteworthy that `gcc` does warn on this, see `-Wfloat-equal` at [the gnu gcc docs](https://gcc.gnu.org/onlinedocs/gcc/Warning-Options.html)", "closed_by": {"login": "jonas-schievink", "id": 1786438, "node_id": "MDQ6VXNlcjE3ODY0Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/1786438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jonas-schievink", "html_url": "https://github.com/jonas-schievink", "followers_url": "https://api.github.com/users/jonas-schievink/followers", "following_url": "https://api.github.com/users/jonas-schievink/following{/other_user}", "gists_url": "https://api.github.com/users/jonas-schievink/gists{/gist_id}", "starred_url": "https://api.github.com/users/jonas-schievink/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jonas-schievink/subscriptions", "organizations_url": "https://api.github.com/users/jonas-schievink/orgs", "repos_url": "https://api.github.com/users/jonas-schievink/repos", "events_url": "https://api.github.com/users/jonas-schievink/events{/privacy}", "received_events_url": "https://api.github.com/users/jonas-schievink/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/62206/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/62206/timeline", "performed_via_github_app": null, "state_reason": "completed"}