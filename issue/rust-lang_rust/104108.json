{"url": "https://api.github.com/repos/rust-lang/rust/issues/104108", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/104108/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/104108/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/104108/events", "html_url": "https://github.com/rust-lang/rust/issues/104108", "id": 1438567728, "node_id": "I_kwDOAAsO6M5Vvs0w", "number": 104108, "title": "Provide structural pinning guarantees for slices, vecs, arrays", "user": {"login": "yoshuawuyts", "id": 2467194, "node_id": "MDQ6VXNlcjI0NjcxOTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/2467194?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yoshuawuyts", "html_url": "https://github.com/yoshuawuyts", "followers_url": "https://api.github.com/users/yoshuawuyts/followers", "following_url": "https://api.github.com/users/yoshuawuyts/following{/other_user}", "gists_url": "https://api.github.com/users/yoshuawuyts/gists{/gist_id}", "starred_url": "https://api.github.com/users/yoshuawuyts/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yoshuawuyts/subscriptions", "organizations_url": "https://api.github.com/users/yoshuawuyts/orgs", "repos_url": "https://api.github.com/users/yoshuawuyts/repos", "events_url": "https://api.github.com/users/yoshuawuyts/events{/privacy}", "received_events_url": "https://api.github.com/users/yoshuawuyts/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 431251592, "node_id": "MDU6TGFiZWw0MzEyNTE1OTI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-docs", "name": "A-docs", "color": "f7e101", "default": false, "description": "Area: documentation for any part of the project, including the compiler, standard library, and tools"}, {"id": 3425147156, "node_id": "LA_kwDOAAsO6M7MJ5kU", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-array", "name": "A-array", "color": "f7e101", "default": false, "description": "Area: [T; N]"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2022-11-07T15:40:37Z", "updated_at": "2023-03-29T12:00:56Z", "closed_at": null, "author_association": "MEMBER", "active_lock_reason": null, "body": "_Link to [Zulip Discussion](https://rust-lang.zulipchat.com/#narrow/stream/187312-wg-async/topic/Projecting.20Pin.3CVec.3E.20to.20Vec.3CPin.3E)._\r\n\r\nRight now `Vec` provides no guarantees wrt [structural pinning](https://doc.rust-lang.org/std/pin/index.html#pinning-is-structural-for-field), meaning if we have a `Vec` of futures and we pin project through it, it works fine today - but we're not _guaranteed_ it will continue to work fine tomorrow. For example, [`futures::join_all!`](https://docs.rs/futures-util/0.3.25/src/futures_util/future/join_all.rs.html#18-23) notes internally that:\r\n\r\n> Safety: `std` _could_ make this unsound if it were to decide Pin's invariants aren't required to transmit through slices. Otherwise this has the same safety as a normal field pin projection.\r\n\r\nThose are pretty shaky grounds to build on, and it'd be better if we could actually guarantee that this will continue to work fine in the future. Especially as the Async WG is looking to fold facilities akin to `join_all!` into the stdlib. I'm not sure what exactly we'd need to document in order to make these guarantees, hence this issue.\r\n\r\n---\r\n\r\nTagging in: @rust-lang/wg-async, @rust-lang/wg-unsafe-code-guidelines, and also @RalfJung specifically since they've been working on the intersection of soundness and pinning recently.", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/104108/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/104108/timeline", "performed_via_github_app": null, "state_reason": null}