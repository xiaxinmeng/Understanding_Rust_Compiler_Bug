{"url": "https://api.github.com/repos/rust-lang/rust/issues/100297", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/100297/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/100297/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/100297/events", "html_url": "https://github.com/rust-lang/rust/issues/100297", "id": 1332592886, "node_id": "I_kwDOAAsO6M5PbcD2", "number": 100297, "title": "seg fault: could not compile `typenum`", "user": {"login": "letto4135", "id": 35670693, "node_id": "MDQ6VXNlcjM1NjcwNjkz", "avatar_url": "https://avatars.githubusercontent.com/u/35670693?v=4", "gravatar_id": "", "url": "https://api.github.com/users/letto4135", "html_url": "https://github.com/letto4135", "followers_url": "https://api.github.com/users/letto4135/followers", "following_url": "https://api.github.com/users/letto4135/following{/other_user}", "gists_url": "https://api.github.com/users/letto4135/gists{/gist_id}", "starred_url": "https://api.github.com/users/letto4135/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/letto4135/subscriptions", "organizations_url": "https://api.github.com/users/letto4135/orgs", "repos_url": "https://api.github.com/users/letto4135/repos", "events_url": "https://api.github.com/users/letto4135/events{/privacy}", "received_events_url": "https://api.github.com/users/letto4135/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2022-08-09T01:38:53Z", "updated_at": "2022-08-12T08:18:15Z", "closed_at": "2022-08-09T12:33:59Z", "author_association": "NONE", "active_lock_reason": null, "body": "I tried this code:\r\n\r\n```\r\nFROM rust:latest as builder\r\nRUN apt-get update && apt-get -y install ca-certificates cmake musl-tools libssl-dev && rm -rf /var/lib/apt/lists/*\r\nCOPY . .\r\nRUN rustup target add x86_64-unknown-linux-musl\r\nENV PKG_CONFIG_ALLOW_CROSS=1\r\nRUN cargo build --target x86_64-unknown-linux-musl --release\r\n\r\nFROM scratch\r\nCOPY --from=builder /target/x86_64-unknown-linux-musl/release/rusty_portfolio .\r\nCOPY --from=builder /templates templates\r\nEXPOSE 8000\r\n```\r\n\r\n```\r\n[package]\r\nname = \"rusty_nonsense\"\r\nversion = \"0.1.0\"\r\nedition = \"2021\"\r\n\r\n# See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html\r\n\r\n[dependencies]\r\nrocket = \"0.5.0-rc.2\"\r\n\r\n[dependencies.rocket_dyn_templates]\r\nversion = \"0.1.0-rc.2\"\r\nfeatures = [\"tera\"]\r\n```\r\n\r\nI expected to see this happen:\r\nDocker build success\r\n\r\nInstead, this happened:\r\n\r\n```\r\n[builder 6/6] RUN cargo build --target x86_64-unknown-linux-musl --release:\r\n#10 2.395     Updating crates.io index\r\n#10 107.8  Downloading crates ...\r\n#10 110.6   Downloaded devise v0.3.1\r\n#10 110.6   Downloaded digest v0.10.3\r\n#10 110.6   Downloaded cookie v0.16.0\r\n#10 110.8   Downloaded time v0.3.12\r\n#10 110.9   Downloaded unic-common v0.9.0\r\n#10 110.9   Downloaded unic-ucd-version v0.9.0\r\n#10 110.9   Downloaded unicode-xid v0.2.3\r\n#10 110.9   Downloaded unic-ucd-segment v0.9.0\r\n#10 110.9   Downloaded atomic v0.5.1\r\n#10 110.9   Downloaded unic-segment v0.9.0\r\n#10 110.9   Downloaded unic-char-range v0.9.0\r\n#10 110.9   Downloaded globset v0.4.9\r\n#10 110.9   Downloaded fnv v1.0.7\r\n#10 110.9   Downloaded lazy_static v1.4.0\r\n#10 110.9   Downloaded ghash v0.4.4\r\n#10 111.0   Downloaded yansi v0.5.1\r\n#10 111.0   Downloaded siphasher v0.3.10\r\n#10 111.0   Downloaded crossbeam-utils v0.8.11\r\n#10 111.0   Downloaded try-lock v0.2.3\r\n#10 111.0   Downloaded mime v0.3.16\r\n#10 111.0   Downloaded tower-service v0.3.2\r\n#10 111.0   Downloaded scopeguard v1.1.0\r\n#10 111.0   Downloaded want v0.3.0\r\n#10 111.0   Downloaded pest_generator v2.2.1\r\n#10 111.0   Downloaded async-stream v0.3.3\r\n#10 111.0   Downloaded serde_derive v1.0.142\r\n#10 111.0   Downloaded toml v0.5.9\r\n#10 111.1   Downloaded walkdir v2.3.2\r\n#10 111.1   Downloaded time-macros v0.2.4\r\n#10 111.1   Downloaded same-file v1.0.6\r\n#10 111.1   Downloaded ucd-trie v0.1.4\r\n#10 111.1   Downloaded iovec v0.1.4\r\n#10 111.1   Downloaded globwalk v0.8.1\r\n#10 111.1   Downloaded typenum v1.15.0\r\n#10 111.1   Downloaded futures-io v0.3.21\r\n#10 111.1   Downloaded async-stream-impl v0.3.3\r\n#10 111.1   Downloaded lazycell v1.3.0\r\n#10 111.1   Downloaded glob v0.3.0\r\n#10 111.1   Downloaded httparse v1.7.1\r\n#10 111.2   Downloaded http v0.2.8\r\n#10 111.2   Downloaded universal-hash v0.4.1\r\n#10 111.2   Downloaded futures-task v0.3.21\r\n#10 111.2   Downloaded futures-channel v0.3.21\r\n#10 111.2   Downloaded tracing-core v0.1.29\r\n#10 111.2   Downloaded num-integer v0.1.45\r\n#10 111.2   Downloaded tracing v0.1.36\r\n#10 111.3   Downloaded version_check v0.9.4\r\n#10 111.3   Downloaded slab v0.4.7\r\n#10 111.3   Downloaded thread_local v1.1.4\r\n#10 111.3   Downloaded subtle v2.4.1\r\n#10 111.3   Downloaded tempfile v3.3.0\r\n#10 111.3   Downloaded parse-zoneinfo v0.3.0\r\n#10 111.3   Downloaded unicode-ident v1.0.3\r\n#10 111.3   Downloaded thiserror v1.0.32\r\n#10 111.3   Downloaded spin v0.9.4\r\n#10 111.4   Downloaded stable-pattern v0.1.0\r\n#10 111.4   Downloaded serde_json v1.0.83\r\n#10 111.4   Downloaded tera v1.16.0\r\n#10 111.4   Downloaded thiserror-impl v1.0.32\r\n#10 111.4   Downloaded rocket_codegen v0.5.0-rc.2\r\n#10 111.5   Downloaded proc-macro2-diagnostics v0.9.1\r\n#10 111.5   Downloaded polyval v0.5.3\r\n#10 111.5   Downloaded notify v4.0.17\r\n#10 111.5   Downloaded tokio v1.20.1\r\n#10 111.7   Downloaded sha-1 v0.10.0\r\n#10 111.7   Downloaded state v0.5.3\r\n#10 111.7   Downloaded rocket_dyn_templates v0.1.0-rc.2\r\n#10 111.7   Downloaded rocket v0.5.0-rc.2\r\n#10 111.8   Downloaded regex-syntax v0.6.27\r\n#10 111.8   Downloaded encoding_rs v0.8.31\r\n#10 111.9   Downloaded regex v1.6.0\r\n#10 112.0   Downloaded sha2 v0.10.2\r\n#10 112.0   Downloaded libc v0.2.127\r\n#10 112.1   Downloaded chrono-tz v0.6.3\r\n#10 112.1   Downloaded bstr v0.2.17\r\n#10 112.2   Downloaded hkdf v0.12.3\r\n#10 112.2   Downloaded phf_shared v0.11.1\r\n#10 112.2   Downloaded parking_lot_core v0.9.3\r\n#10 112.2   Downloaded mio v0.8.4\r\n#10 112.2   Downloaded cipher v0.3.0\r\n#10 112.2   Downloaded bitflags v1.3.2\r\n#10 112.3   Downloaded cfg-if v1.0.0\r\n#10 112.3   Downloaded pest v2.2.1\r\n#10 112.3   Downloaded itoa v1.0.3\r\n#10 112.3   Downloaded rocket_http v0.5.0-rc.2\r\n#10 112.3   Downloaded syn v1.0.99\r\n#10 112.3   Downloaded smallvec v1.9.0\r\n#10 112.3   Downloaded h2 v0.3.13\r\n#10 112.4   Downloaded chrono v0.4.20\r\n#10 112.4   Downloaded serde v1.0.142\r\n#10 112.4   Downloaded proc-macro2 v1.0.43\r\n#10 112.4   Downloaded num-traits v0.2.15\r\n#10 112.4   Downloaded memchr v2.5.0\r\n#10 112.4   Downloaded hashbrown v0.12.3\r\n#10 112.5   Downloaded futures-util v0.3.21\r\n#10 112.5   Downloaded phf_generator v0.11.1\r\n#10 112.5   Downloaded ryu v1.0.11\r\n#10 112.5   Downloaded ref-cast v1.0.9\r\n#10 112.5   Downloaded once_cell v1.13.0\r\n#10 112.5   Downloaded normpath v0.3.2\r\n#10 112.5   Downloaded tracing-attributes v0.1.22\r\n#10 112.5   Downloaded ref-cast-impl v1.0.9\r\n#10 112.5   Downloaded inotify-sys v0.1.5\r\n#10 112.5   Downloaded hyper v0.14.20\r\n#10 112.6   Downloaded bytes v1.2.1\r\n#10 112.6   Downloaded mio-extras v2.0.6\r\n#10 112.6   Downloaded getrandom v0.2.7\r\n#10 112.6   Downloaded socket2 v0.4.4\r\n#10 112.6   Downloaded phf v0.11.1\r\n#10 112.6   Downloaded httpdate v1.0.2\r\n#10 112.6   Downloaded pin-project-lite v0.2.9\r\n#10 112.6   Downloaded num_threads v0.1.6\r\n#10 112.6   Downloaded phf_codegen v0.11.1\r\n#10 112.6   Downloaded http-body v0.4.5\r\n#10 112.7   Downloaded generic-array v0.14.6\r\n#10 112.7   Downloaded signal-hook-registry v1.4.0\r\n#10 112.7   Downloaded net2 v0.2.37\r\n#10 112.7   Downloaded mio v0.6.23\r\n#10 112.7   Downloaded humansize v1.1.1\r\n#10 112.7   Downloaded cfg-if v0.1.10\r\n#10 112.7   Downloaded inotify v0.7.1\r\n#10 112.7   Downloaded block-buffer v0.10.2\r\n#10 112.7   Downloaded quote v1.0.21\r\n#10 112.7   Downloaded log v0.4.17\r\n#10 112.7   Downloaded aho-corasick v0.7.18\r\n#10 112.8   Downloaded lock_api v0.4.7\r\n#10 112.8   Downloaded autocfg v1.1.0\r\n#10 112.8   Downloaded tokio-util v0.7.3\r\n#10 112.8   Downloaded percent-encoding v2.1.0\r\n#10 112.8   Downloaded opaque-debug v0.3.0\r\n#10 112.8   Downloaded futures v0.3.21\r\n#10 112.8   Downloaded aead v0.4.3\r\n#10 112.8   Downloaded aes v0.7.5\r\n#10 112.8   Downloaded inlinable_string v0.1.15\r\n#10 112.8   Downloaded figment v0.10.6\r\n#10 112.8   Downloaded futures-core v0.3.21\r\n#10 112.8   Downloaded fastrand v1.8.0\r\n#10 112.8   Downloaded base64 v0.13.0\r\n#10 112.9   Downloaded either v1.7.0\r\n#10 112.9   Downloaded deunicode v0.4.3\r\n#10 112.9   Downloaded hmac v0.12.1\r\n#10 112.9   Downloaded filetime v0.2.17\r\n#10 112.9   Downloaded ctr v0.8.0\r\n#10 112.9   Downloaded futures-sink v0.3.21\r\n#10 112.9   Downloaded aes-gcm v0.9.4\r\n#10 112.9   Downloaded pin-utils v0.1.0\r\n#10 112.9   Downloaded async-trait v0.1.57\r\n#10 112.9   Downloaded pest_derive v2.2.1\r\n#10 112.9   Downloaded atty v0.2.14\r\n#10 112.9   Downloaded tokio-stream v0.1.9\r\n#10 112.9   Downloaded pest_meta v2.2.1\r\n#10 113.0   Downloaded pear_codegen v0.2.3\r\n#10 113.0   Downloaded pear v0.2.3\r\n#10 113.0   Downloaded multer v2.0.3\r\n#10 113.0   Downloaded indexmap v1.9.1\r\n#10 113.0   Downloaded remove_dir_all v0.5.3\r\n#10 113.0   Downloaded rand_core v0.6.3\r\n#10 113.0   Downloaded rand_chacha v0.3.1\r\n#10 113.0   Downloaded rand v0.8.5\r\n#10 113.0   Downloaded ppv-lite86 v0.2.16\r\n#10 113.0   Downloaded parking_lot v0.12.1\r\n#10 113.0   Downloaded num_cpus v1.13.1\r\n#10 113.0   Downloaded tokio-macros v1.8.0\r\n#10 113.0   Downloaded slug v0.1.4\r\n#10 113.0   Downloaded chrono-tz-build v0.0.3\r\n#10 113.0   Downloaded crypto-common v0.1.6\r\n#10 113.0   Downloaded cpufeatures v0.2.2\r\n#10 113.0   Downloaded binascii v0.1.4\r\n#10 113.0   Downloaded devise_core v0.3.1\r\n#10 113.0   Downloaded devise_codegen v0.3.1\r\n#10 113.0   Downloaded ignore v0.4.18\r\n#10 113.1   Downloaded unic-char-property v0.9.0\r\n#10 113.1   Downloaded uncased v0.9.7\r\n#10 113.1   Downloaded ubyte v0.10.2\r\n#10 113.7    Compiling version_check v0.9.4\r\n#10 113.7    Compiling libc v0.2.127\r\n#10 113.7    Compiling proc-macro2 v1.0.43\r\n#10 113.7    Compiling quote v1.0.21\r\n#10 117.9    Compiling unicode-ident v1.0.3\r\n#10 118.0    Compiling autocfg v1.1.0\r\n#10 118.1    Compiling syn v1.0.99\r\n#10 118.7    Compiling typenum v1.15.0\r\n#10 119.9    Compiling cfg-if v1.0.0\r\n#10 121.9    Compiling memchr v2.5.0\r\n#10 122.1    Compiling log v0.4.17\r\n#10 122.6 /usr/local/rustup/toolchains/stable-x86_64-unknown-linux-gnu/bin/../lib/librustc_driver-1bde28880ea8bde8.so(+0x4e54e3)[0x40021864e3]\r\n#10 122.6 /lib/x86_64-linux-gnu/libpthread.so.0(+0x14140)[0x4005fbe140]\r\n#10 122.6 /usr/local/rustup/toolchains/stable-x86_64-unknown-linux-gnu/bin/rustc(+0x48941)[0x4000048941]\r\n#10 122.6 /usr/local/rustup/toolchains/stable-x86_64-unknown-linux-gnu/bin/rustc(+0x9841)[0x4000009841]\r\n#10 122.6 /usr/local/rustup/toolchains/stable-x86_64-unknown-linux-gnu/bin/../lib/../lib/libLLVM-14-rust-1.62.1-stable.so(_ZN4llvm9MCContext5resetEv+0x55c)[0x400935b49c]\r\n#10 122.6 /usr/local/rustup/toolchains/stable-x86_64-unknown-linux-gnu/bin/../lib/../lib/libLLVM-14-rust-1.62.1-stable.so(_ZN4llvm28MachineModuleInfoWrapperPass14doFinalizationERNS_6ModuleE+0x35)[0x400935af05]\r\n#10 122.6 /usr/local/rustup/toolchains/stable-x86_64-unknown-linux-gnu/bin/../lib/../lib/libLLVM-14-rust-1.62.1-stable.so(_ZN4llvm6legacy15PassManagerImpl3runERNS_6ModuleE+0xb0)[0x4009441660]\r\n#10 122.6 /usr/local/rustup/toolchains/stable-x86_64-unknown-linux-gnu/bin/../lib/librustc_driver-1bde28880ea8bde8.so(+0x2634c75)[0x40042d5c75]\r\n#10 122.6 /usr/local/rustup/toolchains/stable-x86_64-unknown-linux-gnu/bin/../lib/librustc_driver-1bde28880ea8bde8.so(+0x262ddb7)[0x40042cedb7]\r\n#10 122.6 /usr/local/rustup/toolchains/stable-x86_64-unknown-linux-gnu/bin/../lib/librustc_driver-1bde28880ea8bde8.so(+0x26310c6)[0x40042d20c6]\r\n#10 122.6 /usr/local/rustup/toolchains/stable-x86_64-unknown-linux-gnu/bin/../lib/librustc_driver-1bde28880ea8bde8.so(+0x262be78)[0x40042cce78]\r\n#10 122.6 /usr/local/rustup/toolchains/stable-x86_64-unknown-linux-gnu/bin/../lib/librustc_driver-1bde28880ea8bde8.so(+0x2625d43)[0x40042c6d43]\r\n#10 122.6 /usr/local/rustup/toolchains/stable-x86_64-unknown-linux-gnu/bin/../lib/librustc_driver-1bde28880ea8bde8.so(+0x25f553f)[0x400429653f]\r\n#10 122.6 /usr/local/rustup/toolchains/stable-x86_64-unknown-linux-gnu/bin/../lib/librustc_driver-1bde28880ea8bde8.so(+0x2617e93)[0x40042b8e93]\r\n#10 122.7 /usr/local/rustup/toolchains/stable-x86_64-unknown-linux-gnu/bin/../lib/libstd-69edc9ac8de4d39c.so(rust_metadata_std_8996aeeb2a45fe64+0xab3c3)[0x4005ccb3c3]\r\n#10 122.7 /lib/x86_64-linux-gnu/libpthread.so.0(+0x8ea7)[0x4005fb2ea7]\r\n#10 122.7 /lib/x86_64-linux-gnu/libc.so.6(clone+0x3f)[0x40060d4def]\r\n#10 122.7 qemu: uncaught target signal 11 (Segmentation fault) - core dumped\r\n#10 122.7 error: could not compile `typenum`\r\n#10 122.7\r\n#10 122.7 Caused by:\r\n#10 122.7   process didn't exit successfully: `rustc --crate-name build_script_main --edition=2018 /usr/local/cargo/registry/src/github.com-1ecc6299db9ec823/typenum-1.15.0/build/main.rs --error-format=json --json=diagnostic-rendered-ansi,artifacts,future-incompat --crate-type bin --emit=dep-info,link -C embed-bitcode=no -C debug-assertions=off -C metadata=ee6956477f56ac1c -C extra-filename=-ee6956477f56ac1c --out-dir /target/release/build/typenum-ee6956477f56ac1c -L dependency=/target/release/deps --cap-lints allow` (signal: 11, SIGSEGV: invalid memory reference)\r\n#10 122.7 warning: build failed, waiting for other jobs to finish...\r\n------\r\nError failed to fetch an image or build from source: error building: executor failed running [/bin/sh -c cargo build --target x86_64-unknown-linux-musl --release]: exit code: 101\r\n```\r\n\r\n### Meta\r\n`rustc --version --verbose`:\r\ndocker rust:latest\r\n\r\nI'm not sure what happened, but this worked yesterday and today it doesn't. There was code change, but no dependency changes. May be relevant info that I'm deploying to fly.io.", "closed_by": {"login": "letto4135", "id": 35670693, "node_id": "MDQ6VXNlcjM1NjcwNjkz", "avatar_url": "https://avatars.githubusercontent.com/u/35670693?v=4", "gravatar_id": "", "url": "https://api.github.com/users/letto4135", "html_url": "https://github.com/letto4135", "followers_url": "https://api.github.com/users/letto4135/followers", "following_url": "https://api.github.com/users/letto4135/following{/other_user}", "gists_url": "https://api.github.com/users/letto4135/gists{/gist_id}", "starred_url": "https://api.github.com/users/letto4135/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/letto4135/subscriptions", "organizations_url": "https://api.github.com/users/letto4135/orgs", "repos_url": "https://api.github.com/users/letto4135/repos", "events_url": "https://api.github.com/users/letto4135/events{/privacy}", "received_events_url": "https://api.github.com/users/letto4135/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/100297/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/100297/timeline", "performed_via_github_app": null, "state_reason": "completed"}