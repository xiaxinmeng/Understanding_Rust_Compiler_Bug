{"url": "https://api.github.com/repos/rust-lang/rust/issues/52098", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/52098/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/52098/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/52098/events", "html_url": "https://github.com/rust-lang/rust/issues/52098", "id": 338801625, "node_id": "MDU6SXNzdWUzMzg4MDE2MjU=", "number": 52098, "title": "ICE on edition 2018 with anonymous impl lifetime in the wrong place", "user": {"login": "zackmdavis", "id": 1076988, "node_id": "MDQ6VXNlcjEwNzY5ODg=", "avatar_url": "https://avatars.githubusercontent.com/u/1076988?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zackmdavis", "html_url": "https://github.com/zackmdavis", "followers_url": "https://api.github.com/users/zackmdavis/followers", "following_url": "https://api.github.com/users/zackmdavis/following{/other_user}", "gists_url": "https://api.github.com/users/zackmdavis/gists{/gist_id}", "starred_url": "https://api.github.com/users/zackmdavis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zackmdavis/subscriptions", "organizations_url": "https://api.github.com/users/zackmdavis/orgs", "repos_url": "https://api.github.com/users/zackmdavis/repos", "events_url": "https://api.github.com/users/zackmdavis/events{/privacy}", "received_events_url": "https://api.github.com/users/zackmdavis/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1775993, "node_id": "MDU6TGFiZWwxNzc1OTkz", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-lifetimes", "name": "A-lifetimes", "color": "f7e101", "default": false, "description": "Area: lifetime related"}, {"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}, {"id": 203429200, "node_id": "MDU6TGFiZWwyMDM0MjkyMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/P-high", "name": "P-high", "color": "eb6420", "default": false, "description": "High priority"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 930400927, "node_id": "MDU6TGFiZWw5MzA0MDA5Mjc=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-rust-2018-preview", "name": "A-rust-2018-preview", "color": "f7e101", "default": false, "description": "Area: The 2018 edition preview"}], "state": "closed", "locked": false, "assignee": {"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/rust-lang/rust/milestones/56", "html_url": "https://github.com/rust-lang/rust/milestone/56", "labels_url": "https://api.github.com/repos/rust-lang/rust/milestones/56/labels", "id": 3537666, "node_id": "MDk6TWlsZXN0b25lMzUzNzY2Ng==", "number": 56, "title": "Edition 2018 RC 2", "description": "", "creator": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 45, "state": "closed", "created_at": "2018-07-31T22:51:05Z", "updated_at": "2018-11-16T11:06:48Z", "due_on": "2018-10-25T07:00:00Z", "closed_at": "2018-11-16T11:06:48Z"}, "comments": 2, "created_at": "2018-07-06T04:31:18Z", "updated_at": "2018-10-20T01:31:29Z", "closed_at": "2018-10-20T01:31:29Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Reduced:\r\n```rust\r\nstruct IceCube<'a> {\r\n    v: Vec<&'a char>\r\n}\r\n\r\nimpl<'_> IceCube {}\r\n\r\nfn main() {}\r\n```\r\n\r\n(Correct) errors on edition 2015:\r\n```\r\nzmd@ReflectiveCoherence:~/Code/Misc$ rustc +nightly icy.rs \r\nerror[E0262]: invalid lifetime parameter name: `'_`\r\n --> icy.rs:5:6\r\n  |\r\n5 | impl<'_> IceCube {}\r\n  |      ^^ '_ is a reserved lifetime name\r\n\r\nerror[E0106]: missing lifetime specifier\r\n --> icy.rs:5:10\r\n  |\r\n5 | impl<'_> IceCube {}\r\n  |          ^^^^^^^ expected lifetime parameter\r\n\r\nerror: aborting due to 2 previous errors\r\n\r\nSome errors occurred: E0106, E0262.\r\nFor more information about an error, try `rustc --explain E0106`.\r\n```\r\n\r\nStacktrace on edition 2018:\r\n```\r\nzmd@ReflectiveCoherence:~/Code/Misc$ RUST_BACKTRACE=full rustc +nightly icy.rs --edition 2018\r\nthread 'main' panicked at 'assertion failed: self.is_collecting_in_band_lifetimes', librustc/hir/lowering.rs:735:9\r\nstack backtrace:\r\n   0:     0x7f7b651c10fe - std::sys::unix::backtrace::tracing::imp::unwind_backtrace::h50a634a60cb4e5f7\r\n                               at libstd/sys/unix/backtrace/tracing/gcc_s.rs:49\r\n   1:     0x7f7b651984b6 - std::sys_common::backtrace::print::hfdd27bb0425df770\r\n                               at libstd/sys_common/backtrace.rs:71\r\n                               at libstd/sys_common/backtrace.rs:59\r\n   2:     0x7f7b651c834d - std::panicking::default_hook::{{closure}}::h027136eae47935d0\r\n                               at libstd/panicking.rs:211\r\n   3:     0x7f7b651c80c0 - std::panicking::default_hook::hed5917d304f00a1b\r\n                               at libstd/panicking.rs:227\r\n   4:     0x7f7b6185a3e5 - rustc::util::common::panic_hook::h9e9cb098ca9688d6\r\n   5:     0x7f7b651c8ad3 - std::panicking::rust_panic_with_hook::hc482345e1eead25b\r\n                               at libstd/panicking.rs:515\r\n   6:     0x7f7b612a4336 - std::panicking::begin_panic::hc99c40d451548ee4\r\n   7:     0x7f7b6180c531 - rustc::hir::lowering::LoweringContext::lower_lifetime::hde6e623ecce2735f\r\n   8:     0x7f7b617a4e2b - core::ops::function::impls::<impl core::ops::function::FnOnce<A> for &'a mut F>::call_once::h7b1ed582bf44fa1a\r\n   9:     0x7f7b613ac666 - <alloc::vec::Vec<T> as alloc::vec::SpecExtend<T, I>>::from_iter::h942b3350b2cd31a5\r\n  10:     0x7f7b6180c96f - rustc::hir::lowering::LoweringContext::lower_generics::hcf6e7430f81e15a4\r\n  11:     0x7f7b61810dff - rustc::hir::lowering::LoweringContext::lower_item::hf3bbbc3afed70764\r\n  12:     0x7f7b617fe81b - <rustc::hir::lowering::LoweringContext::lower_crate::ItemLowerer<'lcx, 'interner> as syntax::visit::Visitor<'lcx>>::visit_item::h8578ba219875c385\r\n  13:     0x7f7b617fd84a - rustc::hir::lowering::lower_crate::hba78ac42c9a968fe\r\n  14:     0x7f7b6556f1e6 - rustc::util::common::time::h116d0a6c5fad3bc0\r\n  15:     0x7f7b65563e50 - rustc_driver::driver::phase_2_configure_and_expand::h805364562785bbc9\r\n  16:     0x7f7b6555e81b - rustc_driver::driver::compile_input::h95eb8b7dd032d269\r\n  17:     0x7f7b655eb295 - rustc_driver::run_compiler_with_pool::h94fbd18de41dc2e2\r\n  18:     0x7f7b6554f97b - <scoped_tls::ScopedKey<T>>::set::h4c03440eebe30a1f\r\n  19:     0x7f7b65524f2a - syntax::with_globals::h57af6031309babcc\r\n  20:     0x7f7b65505722 - <std::panic::AssertUnwindSafe<F> as core::ops::function::FnOnce<()>>::call_once::hb1f190602052e50b\r\n  21:     0x7f7b651d6c59 - __rust_maybe_catch_panic\r\n                               at libpanic_unwind/lib.rs:105\r\n  22:     0x7f7b655e8423 - rustc_driver::run::h7fa1696458a8f761\r\n  23:     0x7f7b655f826a - rustc_driver::main::he4d005c782d5073a\r\n  24:     0x55c2d9ebbb52 - std::rt::lang_start::{{closure}}::h99d53d66d7fac3dd\r\n  25:     0x7f7b651c8512 - std::panicking::try::do_call::h7e0ed4dd1b773c21\r\n                               at libstd/rt.rs:59\r\n                               at libstd/panicking.rs:310\r\n  26:     0x7f7b651d6c59 - __rust_maybe_catch_panic\r\n                               at libpanic_unwind/lib.rs:105\r\n  27:     0x7f7b6518cd55 - std::rt::lang_start_internal::h7c38f1310577c409\r\n                               at libstd/panicking.rs:289\r\n                               at libstd/panic.rs:392\r\n                               at libstd/rt.rs:58\r\n  28:     0x55c2d9ebbbb3 - main\r\n  29:     0x7f7b64d9082f - __libc_start_main\r\n  30:     0x55c2d9ebba38 - <unknown>\r\nquery stack during panic:\r\nend of query stack\r\n\r\nerror: internal compiler error: unexpected panic\r\n\r\nnote: the compiler unexpectedly panicked. this is a bug.\r\n\r\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports\r\n\r\nnote: rustc 1.28.0-nightly (e3bf634e0 2018-06-28) running on x86_64-unknown-linux-gnu\r\n```\r\n\r\nThe [failing assertion](https://github.com/rust-lang/rust/blob/e3bf634e060bc2f8665878288bcea02008ca346e/src/librustc/hir/lowering.rs#L735) is during HIR lowering.\r\n\r\n```\r\nzmd@ReflectiveCoherence:~/Code/Misc$ rustc +nightly --version --verbose\r\nrustc 1.28.0-nightly (e3bf634e0 2018-06-28)\r\nbinary: rustc\r\ncommit-hash: e3bf634e060bc2f8665878288bcea02008ca346e\r\ncommit-date: 2018-06-28\r\nhost: x86_64-unknown-linux-gnu\r\nrelease: 1.28.0-nightly\r\nLLVM version: 6.0\r\n```\r\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/52098/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/52098/timeline", "performed_via_github_app": null, "state_reason": "completed"}