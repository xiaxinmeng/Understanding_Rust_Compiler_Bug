{"url": "https://api.github.com/repos/rust-lang/rust/issues/28799", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/28799/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/28799/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/28799/events", "html_url": "https://github.com/rust-lang/rust/issues/28799", "id": 109390905, "node_id": "MDU6SXNzdWUxMDkzOTA5MDU=", "number": 28799, "title": "Linker Error on nightly msvc 32bit, maybe related to FnBox", "user": {"login": "kosta", "id": 104116, "node_id": "MDQ6VXNlcjEwNDExNg==", "avatar_url": "https://avatars.githubusercontent.com/u/104116?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kosta", "html_url": "https://github.com/kosta", "followers_url": "https://api.github.com/users/kosta/followers", "following_url": "https://api.github.com/users/kosta/following{/other_user}", "gists_url": "https://api.github.com/users/kosta/gists{/gist_id}", "starred_url": "https://api.github.com/users/kosta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kosta/subscriptions", "organizations_url": "https://api.github.com/users/kosta/orgs", "repos_url": "https://api.github.com/users/kosta/repos", "events_url": "https://api.github.com/users/kosta/events{/privacy}", "received_events_url": "https://api.github.com/users/kosta/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2015-10-01T21:40:26Z", "updated_at": "2015-10-02T12:24:03Z", "closed_at": "2015-10-01T22:55:13Z", "author_association": "NONE", "active_lock_reason": null, "body": "On rustc says rustc 1.5.0-nightly (f5a015892 2015-10-01)\n\nDemo project: https://github.com/kosta/fnbox-test\n\nWhen I do `cd fnbox_main; cargo run` on Mac OS (same nightly as be), it says:\n\n```\n     Running `target/debug/test-fnbox`\n3 + 2 = Ok(5)\n```\n\nWhen I do the same on Windows 7 64bit using rust-nightly-i686-pc-windows-msvc.msi I get:\n\n```\nE:\\test-fnbox\\fnbox_main>cargo run --verbose\n       Fresh libc v0.1.10\n       Fresh log v0.3.2\n       Fresh fnbox_lib v0.0.1 (file:///E:/test-fnbox/fnbox_main)\n   Compiling test-fnbox v0.0.1 (file:///E:/test-fnbox/fnbox_main)\n     Running `rustc src\\main.rs --crate-name test_fnbox --crate-type bin -g --ou\nt-dir E:\\test-fnbox\\fnbox_main\\target\\debug --emit=dep-info,link -L dependency=E\n:\\test-fnbox\\fnbox_main\\target\\debug -L dependency=E:\\test-fnbox\\fnbox_main\\targ\net\\debug\\deps --extern fnbox_lib=E:\\test-fnbox\\fnbox_main\\target\\debug\\deps\\libf\nnbox_lib-dbcb88237aaacf1e.rlib --extern log=E:\\test-fnbox\\fnbox_main\\target\\debu\ng\\deps\\liblog-6e27e2da5513596d.rlib`\nerror: linking with `link.exe` failed: exit code: 1120\nnote: \"C:\\\\Program Files (x86)\\\\Microsoft Visual Studio 12.0\\\\VC/bin\\\\link.exe\"\n\"/LIBPATH:C:\\\\Program Files (x86)\\\\Microsoft Visual Studio 12.0\\\\VC/lib\\\\\" \"/LIB\nPATH:C:\\\\Program Files (x86)\\\\Windows Kits\\\\8.1\\\\Lib\\\\winv6.3\\\\um\\\\x86\" \"/NOLOGO\n\" \"/NXCOMPAT\" \"/LIBPATH:C:\\\\Program Files (x86)\\\\Rust nightly 1.5\\\\bin\\\\rustlib\\\n\\i686-pc-windows-msvc\\\\lib\" \"E:\\\\test-fnbox\\\\fnbox_main\\\\target\\\\debug\\\\test_fnb\nox.0.o\" \"/OUT:E:\\\\test-fnbox\\\\fnbox_main\\\\target\\\\debug\\\\test_fnbox.exe\" \"/OPT:R\nEF,ICF\" \"/DEBUG\" \"\\\\\\\\vboxsrv\\\\VirtualBox_Shared\\\\test-fnbox\\\\fnbox_main\\\\target\n\\\\debug\\\\deps\\\\libfnbox_lib-dbcb88237aaacf1e.rlib\" \"\\\\\\\\vboxsrv\\\\VirtualBox_Shar\ned\\\\test-fnbox\\\\fnbox_main\\\\target\\\\debug\\\\deps\\\\liblog-6e27e2da5513596d.rlib\" \"\n\\\\\\\\vboxsrv\\\\VirtualBox_Shared\\\\test-fnbox\\\\fnbox_main\\\\target\\\\debug\\\\deps\\\\lib\nlibc-165b5479aec0459c.rlib\" \"C:\\\\Program Files (x86)\\\\Rust nightly 1.5\\\\bin\\\\rus\ntlib\\\\i686-pc-windows-msvc\\\\lib\\\\libstd-10cbabc2.rlib\" \"C:\\\\Program Files (x86)\\\n\\Rust nightly 1.5\\\\bin\\\\rustlib\\\\i686-pc-windows-msvc\\\\lib\\\\libcollections-10cba\nbc2.rlib\" \"C:\\\\Program Files (x86)\\\\Rust nightly 1.5\\\\bin\\\\rustlib\\\\i686-pc-wind\nows-msvc\\\\lib\\\\librustc_unicode-10cbabc2.rlib\" \"C:\\\\Program Files (x86)\\\\Rust ni\nghtly 1.5\\\\bin\\\\rustlib\\\\i686-pc-windows-msvc\\\\lib\\\\librand-10cbabc2.rlib\" \"C:\\\\\nProgram Files (x86)\\\\Rust nightly 1.5\\\\bin\\\\rustlib\\\\i686-pc-windows-msvc\\\\lib\\\\\nliballoc-10cbabc2.rlib\" \"C:\\\\Program Files (x86)\\\\Rust nightly 1.5\\\\bin\\\\rustlib\n\\\\i686-pc-windows-msvc\\\\lib\\\\liballoc_system-10cbabc2.rlib\" \"C:\\\\Program Files (\nx86)\\\\Rust nightly 1.5\\\\bin\\\\rustlib\\\\i686-pc-windows-msvc\\\\lib\\\\liblibc-10cbabc\n2.rlib\" \"C:\\\\Program Files (x86)\\\\Rust nightly 1.5\\\\bin\\\\rustlib\\\\i686-pc-window\ns-msvc\\\\lib\\\\libcore-10cbabc2.rlib\" \"/LIBPATH:E:\\\\test-fnbox\\\\fnbox_main\\\\target\n\\\\debug\" \"/LIBPATH:E:\\\\test-fnbox\\\\fnbox_main\\\\target\\\\debug\\\\deps\" \"/LIBPATH:C:\n\\\\Program Files (x86)\\\\Rust nightly 1.5\\\\bin\\\\rustlib\\\\i686-pc-windows-msvc\\\\lib\n\" \"/LIBPATH:E:\\\\test-fnbox\\\\fnbox_main\\\\.rust\\\\bin\\\\i686-pc-windows-msvc\" \"/LIBP\nATH:E:\\\\test-fnbox\\\\fnbox_main\\\\bin\\\\i686-pc-windows-msvc\" \"kernel32.lib\" \"shell\n32.lib\" \"msvcrt.lib\" \"ws2_32.lib\" \"userenv.lib\" \"advapi32.lib\" \"kernel32.lib\" \"s\nhell32.lib\" \"msvcrt.lib\" \"compiler-rt.lib\"\nnote: test_fnbox.0.o : warning LNK4217: locally defined symbol __ZN20MAX_LOG_LEV\nEL_FILTER20h260f52825033eb8bEaaE imported in function __ZN5named12closure.3355E\ntest_fnbox.0.o : warning LNK4217: locally defined symbol __ZN4sync6atomic11atomi\nc_load14_MSG_FILE_LINE20h649e8e0920f21525RbKE imported in function __ZN4sync6ato\nmic11atomic_load21h15357964103575483697E\nliblog-6e27e2da5513596d.rlib(log-6e27e2da5513596d.0.o) : warning LNK4049: locall\ny defined symbol __ZN4sync6atomic11atomic_load14_MSG_FILE_LINE20h649e8e0920f2152\n5RbKE imported\ntest_fnbox.0.o : warning LNK4217: locally defined symbol __ZN4sync6atomic11atomi\nc_load14_MSG_FILE_LINE20h649e8e0920f21525ccKE imported in function __ZN4sync6ato\nmic11atomic_load21h15357964103575483697E\nliblog-6e27e2da5513596d.rlib(log-6e27e2da5513596d.0.o) : warning LNK4049: locall\ny defined symbol __ZN4sync6atomic11atomic_load14_MSG_FILE_LINE20h649e8e0920f2152\n5ccKE imported\nliblog-6e27e2da5513596d.rlib(log-6e27e2da5513596d.0.o) : warning LNK4217: locall\ny defined symbol __ZN5ascii19ASCII_LOWERCASE_MAP20h891504ddc52018ber8aE imported\n in function __ZN5ascii11u8.AsciiExt18to_ascii_lowercase20h6b854fda98ac1200A2aE\nliblog-6e27e2da5513596d.rlib(log-6e27e2da5513596d.0.o) : warning LNK4217: locall\ny defined symbol __ZN6option15Option$LT$T$GT$6unwrap14_MSG_FILE_LINE20h649e8e092\n0f21525buNE imported in function __ZN6option15Option$LT$T$GT$6unwrap20h189088203\n9800293355E\nlibstd-10cbabc2.rlib(std-10cbabc2.0.o) : warning LNK4049: locally defined symbol\n __ZN6option15Option$LT$T$GT$6unwrap14_MSG_FILE_LINE20h649e8e0920f21525buNE impo\nrted\nliblog-6e27e2da5513596d.rlib(log-6e27e2da5513596d.0.o) : warning LNK4217: locall\ny defined symbol __ZN4sync6atomic12atomic_store14_MSG_FILE_LINE20h649e8e0920f215\n25LaKE imported in function __ZN4sync6atomic12atomic_store21h1401020282882518775\n0E\nliblog-6e27e2da5513596d.rlib(log-6e27e2da5513596d.0.o) : warning LNK4217: locall\ny defined symbol __ZN4sync6atomic12atomic_store14_MSG_FILE_LINE20h649e8e0920f215\n256aKE imported in function __ZN4sync6atomic12atomic_store21h1401020282882518775\n0E\nlibstd-10cbabc2.rlib(std-10cbabc2.0.o) : warning LNK4217: locally defined symbol\n __ZN7raw_vec11alloc_guard14_MSG_FILE_LINE20h5233ee83c6958b93TsbE imported in fu\nnction __ZN5error101Box$LT$Error$u2b$$u20$Send$u20$$u2b$$u20$Sync$u20$$u2b$$u20$\n$u27$a$GT$.From$LT$$RF$$u27$b$u20$str$GT$4from20hee95f0407a8b5abd8daE\nlibcollections-10cbabc2.rlib(collections-10cbabc2.0.o) : warning LNK4049: locall\ny defined symbol __ZN7raw_vec11alloc_guard14_MSG_FILE_LINE20h5233ee83c6958b93Tsb\nE imported\nlibstd-10cbabc2.rlib(std-10cbabc2.0.o) : warning LNK4217: locally defined symbol\n __ZN6option15Option$LT$T$GT$6expect15__STATIC_FMTSTR20hc832075917061a0ewtNE imp\norted in function __ZN3vec12Vec$LT$T$GT$7reserve19h756097315311652105E\nlibcollections-10cbabc2.rlib(collections-10cbabc2.0.o) : warning LNK4049: locall\ny defined symbol __ZN6option15Option$LT$T$GT$6expect15__STATIC_FMTSTR20hc8320759\n17061a0ewtNE imported\nlibstd-10cbabc2.rlib(std-10cbabc2.0.o) : warning LNK4217: locally defined symbol\n __ZN6option15Option$LT$T$GT$6expect10_FILE_LINE20h8741aaade7bbdf1cgtNE imported\n in function __ZN3vec12Vec$LT$T$GT$7reserve19h756097315311652105E\nlibcollections-10cbabc2.rlib(collections-10cbabc2.0.o) : warning LNK4049: locall\ny defined symbol __ZN6option15Option$LT$T$GT$6expect10_FILE_LINE20h8741aaade7bbd\nf1cgtNE imported\nlibstd-10cbabc2.rlib(std-10cbabc2.0.o) : warning LNK4217: locally defined symbol\n __ZN6result24Result$LT$T$C$$u20$E$GT$6unwrap15__STATIC_FMTSTR20hc832075917061a0\neKbOE imported in function __ZN6thread4park20hdb88efbb1ac3ef70FAbE\nlibstd-10cbabc2.rlib(std-10cbabc2.0.o) : warning LNK4217: locally defined symbol\n __ZN6result24Result$LT$T$C$$u20$E$GT$6unwrap10_FILE_LINE20h8741aaade7bbdf1cubOE\n imported in function __ZN6thread4park20hdb88efbb1ac3ef70FAbE\nlibstd-10cbabc2.rlib(std-10cbabc2.0.o) : warning LNK4217: locally defined symbol\n __ZN4cell16RefCell$LT$T$GT$10borrow_mut14_MSG_FILE_LINE20h649e8e0920f215259tKE\nimported in function __ZN4rand13ThreadRng.Rng8next_u6420hfacae7071f7f815amwxE\nlibstd-10cbabc2.rlib(std-10cbabc2.0.o) : warning LNK4217: locally defined symbol\n __ZN5slice54_$u5b$T$u5d$.ops..Index$LT$ops..Range$LT$usize$GT$$GT$5index14_MSG_\nFILE_LINE20h649e8e0920f21525yOPE imported in function __ZN3sys2os12error_string2\n0h86086a62b4ab7f42LHvE\nlibcollections-10cbabc2.rlib(collections-10cbabc2.0.o) : warning LNK4049: locall\ny defined symbol __ZN5slice54_$u5b$T$u5d$.ops..Index$LT$ops..Range$LT$usize$GT$$\nGT$5index14_MSG_FILE_LINE20h649e8e0920f21525yOPE imported\nlibstd-10cbabc2.rlib(std-10cbabc2.0.o) : warning LNK4217: locally defined symbol\n __ZN6string6String8truncate14_MSG_FILE_LINE20h089424dc74c14514dOfE imported in\nfunction __ZN3sys2os12error_string20h86086a62b4ab7f42LHvE\nlibstd-10cbabc2.rlib(std-10cbabc2.0.o) : warning LNK4217: locally defined symbol\n __ZN5slice54_$u5b$T$u5d$.ops..Index$LT$ops..Range$LT$usize$GT$$GT$5index14_MSG_\nFILE_LINE20h649e8e0920f215255NPE imported in function __ZN3sys2os12Env.Iterator4\nnext20h9897d642738158f97KvE\nlibcollections-10cbabc2.rlib(collections-10cbabc2.0.o) : warning LNK4049: locall\ny defined symbol __ZN5slice54_$u5b$T$u5d$.ops..Index$LT$ops..Range$LT$usize$GT$$\nGT$5index14_MSG_FILE_LINE20h649e8e0920f215255NPE imported\nlibstd-10cbabc2.rlib(std-10cbabc2.0.o) : warning LNK4217: locally defined symbol\n __ZN7raw_vec15RawVec$LT$T$GT$13shrink_to_fit14_MSG_FILE_LINE20h5233ee83c6958b93\nBpbE imported in function __ZN3ffi5c_str7CString18from_vec_unchecked20h5adfa5eff\n5855f28vDeE\nlibcollections-10cbabc2.rlib(collections-10cbabc2.0.o) : warning LNK4049: locall\ny defined symbol __ZN7raw_vec15RawVec$LT$T$GT$13shrink_to_fit14_MSG_FILE_LINE20h\n5233ee83c6958b93BpbE imported\nlibstd-10cbabc2.rlib(std-10cbabc2.0.o) : warning LNK4217: locally defined symbol\n __ZN5slice57_$u5b$T$u5d$.ops..IndexMut$LT$ops..Range$LT$usize$GT$$GT$9index_mut\n14_MSG_FILE_LINE20h649e8e0920f21525YQPE imported in function __ZN2io4Read14read_\nto_string20h6802931272054495440E\nlibstd-10cbabc2.rlib(std-10cbabc2.0.o) : warning LNK4217: locally defined symbol\n __ZN3vec12Vec$LT$T$GT$5drain14_MSG_FILE_LINE20h089424dc74c14514FzgE imported in\n function __ZN2io8buffered18BufWriter$LT$W$GT$9flush_buf21h18326229385129381480E\n\nlibstd-10cbabc2.rlib(std-10cbabc2.0.o) : warning LNK4217: locally defined symbol\n __ZN5slice39_$u5b$T$u5d$.ops..IndexMut$LT$usize$GT$9index_mut14_MSG_FILE_LINE20\nh649e8e0920f21525aNPE imported in function __ZN3net6parser20Parser$LT$$u27$a$GT$\n19read_ipv6_addr_impl11read_groups20h3432b5cc5b5e92375vjE\nlibrand-10cbabc2.rlib(rand-10cbabc2.0.o) : warning LNK4049: locally defined symb\nol __ZN5slice39_$u5b$T$u5d$.ops..IndexMut$LT$usize$GT$9index_mut14_MSG_FILE_LINE\n20h649e8e0920f21525aNPE imported\nlibstd-10cbabc2.rlib(std-10cbabc2.0.o) : warning LNK4217: locally defined symbol\n __ZN4cell16RefCell$LT$T$GT$6borrow14_MSG_FILE_LINE20h649e8e0920f21525ptKE impor\nted in function __ZN10sys_common11thread_info3set20h2f7bc31798cacf9e92rE\nlibstd-10cbabc2.rlib(std-10cbabc2.0.o) : warning LNK4217: locally defined symbol\n __ZN5slice36_$u5b$T$u5d$.ops..Index$LT$usize$GT$5index14_MSG_FILE_LINE20h649e8e\n0920f21525lMPE imported in function __ZN4hash3sip16SipHasher.Hasher5write20hf76c\n90f409814f864GTE\nlibcollections-10cbabc2.rlib(collections-10cbabc2.0.o) : warning LNK4049: locall\ny defined symbol __ZN5slice36_$u5b$T$u5d$.ops..Index$LT$usize$GT$5index14_MSG_FI\nLE_LINE20h649e8e0920f21525lMPE imported\nlibrand-10cbabc2.rlib(rand-10cbabc2.0.o) : warning LNK4049: locally defined symb\nol __ZN5slice36_$u5b$T$u5d$.ops..Index$LT$usize$GT$5index14_MSG_FILE_LINE20h649e\n8e0920f21525lMPE imported\nlibstd-10cbabc2.rlib(std-10cbabc2.0.o) : warning LNK4217: locally defined symbol\n __ZN5isaac5EMPTY20hd2819167b16a6d39FhbE imported in function __ZN4rand6StdRng3n\new20h1b6a51360bdc78a2UqxE\nlibcollections-10cbabc2.rlib(collections-10cbabc2.0.o) : warning LNK4217: locall\ny defined symbol __ZN5u_str15UTF8_CHAR_WIDTH20h64eb18501991a9e979gE imported in\nfunction __ZN6string6String15from_utf8_lossy20h083d40e2249662cfWAfE\nlibrustc_unicode-10cbabc2.rlib(rustc_unicode-10cbabc2.0.o) : warning LNK4217: lo\ncally defined symbol __ZN4char12char.CharExt8to_digit14_MSG_FILE_LINE20h649e8e09\n20f21525CJKE imported in function __ZN4char4char8is_digit20h4aa08611ee5bc40dMthE\n\ntest_fnbox.0.o : error LNK2019: unresolved external symbol __imp___ZN5named15__S\nTATIC_FMTSTR20hdba419b76b5b14574baE referenced in function __ZN5named12closure.3\n355E\ntest_fnbox.0.o : error LNK2019: unresolved external symbol __imp___ZN5named4_LOC\n20h49b461bc6448562c4aaE referenced in function __ZN5named12closure.3355E\ntest_fnbox.0.o : error LNK2019: unresolved external symbol __imp___ZN5named15__S\nTATIC_FMTSTR20hdba419b76b5b1457HdaE referenced in function __ZN5named12closure.3\n355E\ntest_fnbox.0.o : error LNK2019: unresolved external symbol __imp___ZN5named4_LOC\n20h49b461bc6448562cHcaE referenced in function __ZN5named12closure.3355E\ntest_fnbox.0.o : error LNK2019: unresolved external symbol __imp___ZN5named15__S\nTATIC_FMTSTR20hdba419b76b5b1457afaE referenced in function __ZN5named12closure.3\n355E\ntest_fnbox.0.o : error LNK2019: unresolved external symbol __imp___ZN5named4_LOC\n20h49b461bc6448562caeaE referenced in function __ZN5named12closure.3355E\nE:\\test-fnbox\\fnbox_main\\target\\debug\\test_fnbox.exe : fatal error LNK1120: 6 un\nresolved externals\n\nerror: aborting due to previous error\nCould not compile `test-fnbox`.\n\nCaused by:\n  Process didn't exit successfully: `rustc src\\main.rs --crate-name test_fnbox -\n-crate-type bin -g --out-dir E:\\test-fnbox\\fnbox_main\\target\\debug --emit=dep-in\nfo,link -L dependency=E:\\test-fnbox\\fnbox_main\\target\\debug -L dependency=E:\\tes\nt-fnbox\\fnbox_main\\target\\debug\\deps --extern fnbox_lib=E:\\test-fnbox\\fnbox_main\n\\target\\debug\\deps\\libfnbox_lib-dbcb88237aaacf1e.rlib --extern log=E:\\test-fnbox\n\\fnbox_main\\target\\debug\\deps\\liblog-6e27e2da5513596d.rlib` (exit code: 11128881\n48)\n```\n", "closed_by": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/28799/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/28799/timeline", "performed_via_github_app": null, "state_reason": "completed"}