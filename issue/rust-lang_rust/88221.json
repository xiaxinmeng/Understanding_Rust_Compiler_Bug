{"url": "https://api.github.com/repos/rust-lang/rust/issues/88221", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/88221/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/88221/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/88221/events", "html_url": "https://github.com/rust-lang/rust/issues/88221", "id": 976268828, "node_id": "MDU6SXNzdWU5NzYyNjg4Mjg=", "number": 88221, "title": "Unable to build rust compiler on Alpine Linux", "user": {"login": "zdiff", "id": 19849963, "node_id": "MDQ6VXNlcjE5ODQ5OTYz", "avatar_url": "https://avatars.githubusercontent.com/u/19849963?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zdiff", "html_url": "https://github.com/zdiff", "followers_url": "https://api.github.com/users/zdiff/followers", "following_url": "https://api.github.com/users/zdiff/following{/other_user}", "gists_url": "https://api.github.com/users/zdiff/gists{/gist_id}", "starred_url": "https://api.github.com/users/zdiff/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zdiff/subscriptions", "organizations_url": "https://api.github.com/users/zdiff/orgs", "repos_url": "https://api.github.com/users/zdiff/repos", "events_url": "https://api.github.com/users/zdiff/events{/privacy}", "received_events_url": "https://api.github.com/users/zdiff/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 108333, "node_id": "MDU6TGFiZWwxMDgzMzM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-LLVM", "name": "A-LLVM", "color": "f7e101", "default": false, "description": "Area: Code generation parts specific to LLVM. Both correctness bugs and optimization-related issues."}, {"id": 325438536, "node_id": "MDU6TGFiZWwzMjU0Mzg1MzY=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-bootstrap", "name": "T-bootstrap", "color": "bfd4f2", "default": false, "description": "Relevant to the bootstrap subteam: Rust's build system (x.py and src/bootstrap)"}, {"id": 630662867, "node_id": "MDU6TGFiZWw2MzA2NjI4Njc=", "url": "https://api.github.com/repos/rust-lang/rust/labels/O-musl", "name": "O-musl", "color": "6e6ec0", "default": false, "description": "Target: The musl libc"}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2021-08-22T02:47:55Z", "updated_at": "2022-07-11T00:48:00Z", "closed_at": "2022-07-11T00:48:00Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am unable to successfully run `python3 ./x.py build` on Alpine Linux. \r\n\r\nI am able to replicate this issue with Docker:\r\n### Code\r\n\r\n```Dockerfile\r\nFROM alpine:3.14.1\r\n\r\nRUN apk add --no-cache \\\r\n    curl \\\r\n    cmake \\\r\n    g++ \\\r\n    gcc \\\r\n    git \\\r\n    musl-dev \\\r\n    ninja \\\r\n    python3\r\n\r\nRUN git clone --branch 1.54.0 --single-branch https://github.com/rust-lang/rust.git \\\r\n    && cd rust \\\r\n    && export RUST_BACKTRACE=full \\\r\n    && cp config.toml.example config.toml \\\r\n    && python3 ./x.py build \\\r\n    --build x86_64-unknown-linux-musl \\\r\n    --host x86_64-unknown-linux-musl \\\r\n    --target x86_64-unknown-linux-musl \\\r\n    --jobs \"$(nproc)\" \\\r\n    && python3 ./x.py install\r\n```\r\n\r\n### Error output\r\n<details><summary><strong>Backtrace</strong></summary>\r\n<p>\r\n\r\n```\r\n#10 6075.2 [21/2758] Linking CXX static library lib/libDynamicLibraryLib.a\r\n#10 6075.3 [22/2758] Building CXX object unittests/Support/DynamicLibrary/CMakeFiles/PipSqueak.dir/PipSqueak.cpp.o\r\n#10 6075.5 [23/2758] Building CXX object unittests/Support/DynamicLibrary/CMakeFiles/SecondLib.dir/PipSqueak.cpp.o\r\n#10 6076.0 [24/2758] Linking CXX shared library unittests/Support/DynamicLibrary/PipSqueak.so\r\n#10 6076.0 ninja: job failed: : && /usr/bin/c++ -fPIC -ffunction-sections -fdata-sections -fPIC -m64 -static -static -fPIC -fvisibility-inlines-hidden -Werror=date-time -Wall -Wextra -Wno-unused-parameter -Wwrite-strings -Wcast-qual -Wno-missing-field-initializers -pedantic -Wno-long-long -Wimplicit-fallthrough -Wno-maybe-uninitialized -Wno-class-memaccess -Wno-redundant-move -Wno-noexcept-type -Wdelete-non-virtual-dtor -Wsuggest-override -Wno-comment -fdiagnostics-color -ffunction-sections -fdata-sections -O3 -DNDEBUG  -static -Wl,-z,defs -shared -Wl,-soname,PipSqueak.so -o unittests/Support/DynamicLibrary/PipSqueak.so unittests/Support/DynamicLibrary/CMakeFiles/PipSqueak.dir/PipSqueak.cpp.o   && :\r\n#10 6076.0 /usr/lib/gcc/x86_64-alpine-linux-musl/10.3.1/../../../../x86_64-alpine-linux-musl/bin/ld: /usr/lib/gcc/x86_64-alpine-linux-musl/10.3.1/crtbeginT.o: relocation R_X86_64_32 against hidden symbol `__TMC_END__' can not be used when making a shared object\r\n#10 6076.0 /usr/lib/gcc/x86_64-alpine-linux-musl/10.3.1/../../../../x86_64-alpine-linux-musl/bin/ld: /usr/lib/gcc/x86_64-alpine-linux-musl/10.3.1/crtend.o: relocation R_X86_64_32 against `.ctors' can not be used when making a shared object; recompile with -fPIC\r\n#10 6076.0 collect2: error: ld returned 1 exit status\r\n#10 6079.8 ninja: subcommand failed\r\n#10 6079.8 thread 'main' panicked at '\r\n#10 6079.8 command did not execute successfully, got: exit status: 1\r\n#10 6079.8\r\n#10 6079.8 build script failed, must exit now', /root/.cargo/registry/src/github.com-1ecc6299db9ec823/cmake-0.1.44/src/lib.rs:885:5\r\n#10 6079.8 stack backtrace:\r\n#10 6079.8    0:     0x7f34cbe09910 - std::backtrace_rs::backtrace::libunwind::trace::h0a4d1a6a1f3ee78c\r\n#10 6079.8                                at /rustc/53cb7b09b00cbea8754ffb78e7e3cb521cb8af4b/library/std/src/../../backtrace/src/backtrace/libunwind.rs:90:5\r\n#10 6079.8    1:     0x7f34cbe09910 - std::backtrace_rs::backtrace::trace_unsynchronized::hcdb6d770f7c6c0ff\r\n#10 6079.8                                at /rustc/53cb7b09b00cbea8754ffb78e7e3cb521cb8af4b/library/std/src/../../backtrace/src/backtrace/mod.rs:66:5\r\n#10 6079.8    2:     0x7f34cbe09910 - std::sys_common::backtrace::_print_fmt::hb2af22fcd043cfe5\r\n#10 6079.8                                at /rustc/53cb7b09b00cbea8754ffb78e7e3cb521cb8af4b/library/std/src/sys_common/backtrace.rs:67:5\r\n#10 6079.8    3:     0x7f34cbe09910 - <std::sys_common::backtrace::_print::DisplayBacktrace as core::fmt::Display>::fmt::h57b30a04a298ca27\r\n#10 6079.8                                at /rustc/53cb7b09b00cbea8754ffb78e7e3cb521cb8af4b/library/std/src/sys_common/backtrace.rs:46:22\r\n#10 6079.8    4:     0x7f34cbe4919f - core::fmt::write::he63f052d36578df1\r\n#10 6079.8                                at /rustc/53cb7b09b00cbea8754ffb78e7e3cb521cb8af4b/library/core/src/fmt/mod.rs:1094:17\r\n#10 6079.8    5:     0x7f34cbe05265 - std::io::Write::write_fmt::h47207eae3917b098\r\n#10 6079.8                                at /rustc/53cb7b09b00cbea8754ffb78e7e3cb521cb8af4b/library/std/src/io/mod.rs:1584:15\r\n#10 6079.8    6:     0x7f34cbe0c72b - std::sys_common::backtrace::_print::hdf7108607dc68362\r\n#10 6079.8                                at /rustc/53cb7b09b00cbea8754ffb78e7e3cb521cb8af4b/library/std/src/sys_common/backtrace.rs:49:5\r\n#10 6079.8    7:     0x7f34cbe0c72b - std::sys_common::backtrace::print::hfe981af40ce65146\r\n#10 6079.8                                at /rustc/53cb7b09b00cbea8754ffb78e7e3cb521cb8af4b/library/std/src/sys_common/backtrace.rs:36:9\r\n#10 6079.8    8:     0x7f34cbe0c72b - std::panicking::default_hook::{{closure}}::h6efb08a9f2e165c0\r\n#10 6079.8                                at /rustc/53cb7b09b00cbea8754ffb78e7e3cb521cb8af4b/library/std/src/panicking.rs:208:50\r\n#10 6079.8    9:     0x7f34cbe0c1fd - std::panicking::default_hook::h75e6490e71569f7b\r\n#10 6079.8                                at /rustc/53cb7b09b00cbea8754ffb78e7e3cb521cb8af4b/library/std/src/panicking.rs:225:9\r\n#10 6079.8   10:     0x7f34cbe0cd3d - std::panicking::rust_panic_with_hook::h44acaf836583bf77\r\n#10 6079.8                                at /rustc/53cb7b09b00cbea8754ffb78e7e3cb521cb8af4b/library/std/src/panicking.rs:591:17\r\n#10 6079.8   11:     0x7f34cbe0c8d7 - std::panicking::begin_panic_handler::{{closure}}::hfcb95b1a4c3fd433\r\n#10 6079.8                                at /rustc/53cb7b09b00cbea8754ffb78e7e3cb521cb8af4b/library/std/src/panicking.rs:497:13\r\n#10 6079.8   12:     0x7f34cbe09dcc - std::sys_common::backtrace::__rust_end_short_backtrace::hca28f1118834420f\r\n#10 6079.8                                at /rustc/53cb7b09b00cbea8754ffb78e7e3cb521cb8af4b/library/std/src/sys_common/backtrace.rs:141:18\r\n#10 6079.8   13:     0x7f34cbe0c839 - rust_begin_unwind\r\n#10 6079.8                                at /rustc/53cb7b09b00cbea8754ffb78e7e3cb521cb8af4b/library/std/src/panicking.rs:493:5\r\n#10 6079.8   14:     0x7f34cb36fa1b - std::panicking::begin_panic_fmt::hf5bc7901981ac7fe\r\n#10 6079.8                                at /rustc/53cb7b09b00cbea8754ffb78e7e3cb521cb8af4b/library/std/src/panicking.rs:435:5\r\n#10 6079.8   15:     0x7f34cba2b733 - cmake::fail::hf296fa405cb394b4\r\n#10 6079.8                                at /root/.cargo/registry/src/github.com-1ecc6299db9ec823/cmake-0.1.44/src/lib.rs:885:5\r\n#10 6079.8   16:     0x7f34cba2b092 - cmake::run::h88059d955c2375e9\r\n#10 6079.8                                at /root/.cargo/registry/src/github.com-1ecc6299db9ec823/cmake-0.1.44/src/lib.rs:863:9\r\n#10 6079.8   17:     0x7f34cba276e4 - cmake::Config::build::h99d8218a8f001753\r\n#10 6079.8                                at /root/.cargo/registry/src/github.com-1ecc6299db9ec823/cmake-0.1.44/src/lib.rs:769:9\r\n#10 6079.8   18:     0x7f34cb99a776 - <bootstrap::native::Llvm as bootstrap::builder::Step>::run::h47b4dfec8e3a16a1\r\n#10 6079.8                                at /rust/src/bootstrap/native.rs:329:9\r\n#10 6079.8   19:     0x7f34cb8bdbfb - bootstrap::builder::Builder::ensure::haf220c2c89358adf\r\n#10 6079.8                                at /rust/src/bootstrap/builder.rs:1543:23\r\n#10 6079.8   20:     0x7f34cb94713b - bootstrap::compile::rustc_cargo_env::hfe54cfc2f4d956e9\r\n#10 6079.8                                at /rust/src/bootstrap/compile.rs:678:27\r\n#10 6079.8   21:     0x7f34cb946ac6 - bootstrap::compile::rustc_cargo::hc580c94ea34cdde6\r\n#10 6079.8                                at /rust/src/bootstrap/compile.rs:630:5\r\n#10 6079.8   22:     0x7f34cb945c41 - <bootstrap::compile::Rustc as bootstrap::builder::Step>::run::h7c720f3640642d78\r\n#10 6079.8                                at /rust/src/bootstrap/compile.rs:566:9\r\n#10 6079.8   23:     0x7f34cb8d6cb0 - bootstrap::builder::Builder::ensure::hc6f3a702b2ac2754\r\n#10 6079.8                                at /rust/src/bootstrap/builder.rs:1543:23\r\n#10 6079.8   24:     0x7f34cb94c10c - <bootstrap::compile::Assemble as bootstrap::builder::Step>::run::h7b1f8359d408ed22\r\n#10 6079.8                                at /rust/src/bootstrap/compile.rs:1049:9\r\n#10 6079.8   25:     0x7f34cb8cb2cd - bootstrap::builder::Builder::ensure::hbce1b308644fbfaa\r\n#10 6079.8                                at /rust/src/bootstrap/builder.rs:1543:23\r\n#10 6079.8   26:     0x7f34cb8031a4 - bootstrap::builder::Builder::compiler::h0a8359c18511b15a\r\n#10 6079.8                                at /rust/src/bootstrap/builder.rs:598:9\r\n#10 6079.8   27:     0x7f34cb93f5c5 - <bootstrap::compile::Std as bootstrap::builder::Step>::make_run::hea8b94428a77b12b\r\n#10 6079.8                                at /rust/src/bootstrap/compile.rs:52:23\r\n#10 6079.8   28:     0x7f34cb7fe8f5 - bootstrap::builder::StepDescription::maybe_run::h7643e880946d6c33\r\n#10 6079.8                                at /rust/src/bootstrap/builder.rs:179:13\r\n#10 6079.8   29:     0x7f34cb7feef9 - bootstrap::builder::StepDescription::run::h13ccca526d9cfe61\r\n#10 6079.8                                at /rust/src/bootstrap/builder.rs:200:25\r\n#10 6079.8   30:     0x7f34cb80311a - bootstrap::builder::Builder::run_step_descriptions::h4ab99147b4a87324\r\n#10 6079.8                                at /rust/src/bootstrap/builder.rs:590:9\r\n#10 6079.8   31:     0x7f34cb802e36 - bootstrap::builder::Builder::execute_cli::h9bddc754ffc19093\r\n#10 6079.8                                at /rust/src/bootstrap/builder.rs:570:9\r\n#10 6079.8   32:     0x7f34cb635c95 - bootstrap::Build::build::h0b49d6da1a9a676c\r\n#10 6079.8                                at /rust/src/bootstrap/lib.rs:515:13\r\n#10 6079.8   33:     0x7f34cb37160c - bootstrap::main::h29b3520c5b355070\r\n#10 6079.8                                at /rust/src/bootstrap/bin/main.rs:33:5\r\n#10 6079.8   34:     0x7f34cb37103b - core::ops::function::FnOnce::call_once::h8dd0e42e8704b2f9\r\n#10 6079.8                                at /rustc/53cb7b09b00cbea8754ffb78e7e3cb521cb8af4b/library/core/src/ops/function.rs:227:5\r\n#10 6079.8   35:     0x7f34cb37119e - std::sys_common::backtrace::__rust_begin_short_backtrace::h17549f5dfca6758a\r\n#10 6079.8                                at /rustc/53cb7b09b00cbea8754ffb78e7e3cb521cb8af4b/library/std/src/sys_common/backtrace.rs:125:18\r\n#10 6079.8   36:     0x7f34cb372c81 - std::rt::lang_start::{{closure}}::h08807f1189aa3a49\r\n#10 6079.8                                at /rustc/53cb7b09b00cbea8754ffb78e7e3cb521cb8af4b/library/std/src/rt.rs:49:18\r\n#10 6079.8   37:     0x7f34cbe0d1a9 - core::ops::function::impls::<impl core::ops::function::FnOnce<A> for &F>::call_once::h71b3f349d044965d\r\n#10 6079.8                                at /rustc/53cb7b09b00cbea8754ffb78e7e3cb521cb8af4b/library/core/src/ops/function.rs:259:13\r\n#10 6079.8   38:     0x7f34cbe0d1a9 - std::panicking::try::do_call::hc02ebce4ba4c6173\r\n#10 6079.8                                at /rustc/53cb7b09b00cbea8754ffb78e7e3cb521cb8af4b/library/std/src/panicking.rs:379:40\r\n#10 6079.8   39:     0x7f34cbe0d1a9 - std::panicking::try::h294110da45001535\r\n#10 6079.8                                at /rustc/53cb7b09b00cbea8754ffb78e7e3cb521cb8af4b/library/std/src/panicking.rs:343:19\r\n#10 6079.8   40:     0x7f34cbe0d1a9 - std::panic::catch_unwind::h852663fafb9931f9\r\n#10 6079.8                                at /rustc/53cb7b09b00cbea8754ffb78e7e3cb521cb8af4b/library/std/src/panic.rs:431:14\r\n#10 6079.8   41:     0x7f34cbe0d1a9 - std::rt::lang_start_internal::ha79cb227b2786b9a\r\n#10 6079.8                                at /rustc/53cb7b09b00cbea8754ffb78e7e3cb521cb8af4b/library/std/src/rt.rs:34:21\r\n#10 6079.8   42:     0x7f34cb372c60 - std::rt::lang_start::hed27703ec1706012\r\n#10 6079.8                                at /rustc/53cb7b09b00cbea8754ffb78e7e3cb521cb8af4b/library/std/src/rt.rs:48:5\r\n#10 6079.8   43:     0x7f34cb371c6c - main\r\n#10 6079.8      finished in 17.596 seconds\r\n#10 6079.8 failed to run: /rust/build/bootstrap/debug/bootstrap build --build x86_64-unknown-linux-musl --host x86_64-unknown-linux-musl --target x86_64-unknown-linux-musl --jobs 12\r\n#10 6079.8 Build completed unsuccessfully in 1:22:15\r\n#10 ERROR: executor failed running [/bin/sh -c git clone --branch \"${rust_version}\" --single-branch https://github.com/rust-lang/rust.git     && cd rust     && export RUST_BACKTRACE=full     && cp config.toml.example config.toml     && python3 ./x.py build     --build x86_64-unknown-linux-musl     --host x86_64-unknown-linux-musl     --target x86_64-unknown-linux-musl     --jobs \"$(nproc)\"     && python3 ./x.py install]: exit code: 1\r\n------\r\n > [6/6] RUN git clone --branch \"1.54.0\" --single-branch https://github.com/rust-lang/rust.git     && cd rust     && export RUST_BACKTRACE=full     && cp config.toml.example config.toml     && python3 ./x.py build     --build x86_64-unknown-linux-musl     --host x86_64-unknown-linux-musl     --target x86_64-unknown-linux-musl     --jobs \"$(nproc)\"     && python3 ./x.py install:\r\n------\r\nexecutor failed running [/bin/sh -c git clone --branch \"${rust_version}\" --single-branch https://github.com/rust-lang/rust.git     && cd rust     && export RUST_BACKTRACE=full     && cp config.toml.example config.toml     && python3 ./x.py build     --build x86_64-unknown-linux-musl     --host x86_64-unknown-linux-musl     --target x86_64-unknown-linux-musl     --jobs \"$(nproc)\"     && python3 ./x.py install]: exit code: 1\r\nmake: *** [Makefile:9: build-rust] Error 1\r\n\r\n```\r\n\r\n</p>\r\n</details>\r\n\r\n", "closed_by": {"login": "jyn514", "id": 23638587, "node_id": "MDQ6VXNlcjIzNjM4NTg3", "avatar_url": "https://avatars.githubusercontent.com/u/23638587?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jyn514", "html_url": "https://github.com/jyn514", "followers_url": "https://api.github.com/users/jyn514/followers", "following_url": "https://api.github.com/users/jyn514/following{/other_user}", "gists_url": "https://api.github.com/users/jyn514/gists{/gist_id}", "starred_url": "https://api.github.com/users/jyn514/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jyn514/subscriptions", "organizations_url": "https://api.github.com/users/jyn514/orgs", "repos_url": "https://api.github.com/users/jyn514/repos", "events_url": "https://api.github.com/users/jyn514/events{/privacy}", "received_events_url": "https://api.github.com/users/jyn514/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/88221/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/88221/timeline", "performed_via_github_app": null, "state_reason": "not_planned"}