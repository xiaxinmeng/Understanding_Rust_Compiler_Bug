{"url": "https://api.github.com/repos/rust-lang/rust/issues/18208", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/18208/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/18208/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/18208/events", "html_url": "https://github.com/rust-lang/rust/issues/18208", "id": 46397523, "node_id": "MDU6SXNzdWU0NjM5NzUyMw==", "number": 18208, "title": "Typechecking pass takes an extreme amount of time on trivial programs", "user": {"login": "bstrie", "id": 865233, "node_id": "MDQ6VXNlcjg2NTIzMw==", "avatar_url": "https://avatars.githubusercontent.com/u/865233?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bstrie", "html_url": "https://github.com/bstrie", "followers_url": "https://api.github.com/users/bstrie/followers", "following_url": "https://api.github.com/users/bstrie/following{/other_user}", "gists_url": "https://api.github.com/users/bstrie/gists{/gist_id}", "starred_url": "https://api.github.com/users/bstrie/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bstrie/subscriptions", "organizations_url": "https://api.github.com/users/bstrie/orgs", "repos_url": "https://api.github.com/users/bstrie/repos", "events_url": "https://api.github.com/users/bstrie/events{/privacy}", "received_events_url": "https://api.github.com/users/bstrie/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 64037154, "node_id": "MDU6TGFiZWw2NDAzNzE1NA==", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-compiletime", "name": "I-compiletime", "color": "e11d21", "default": false, "description": "Problems and improvements with respect to compile times."}], "state": "closed", "locked": false, "assignee": {"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 9, "created_at": "2014-10-21T14:09:15Z", "updated_at": "2014-11-06T22:14:16Z", "closed_at": "2014-11-06T22:14:16Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "``` rust\nfn main() {\n    println!(\"Hello, world\");\n}\n```\n\nTake this simple program and modify it by adding more consecutive `println!(\"Hello world\");` lines. Compile it with `-Z time-passes` and observe how long typechecking takes. I've compiled a table below.\n\n| Calls to `println!` | Typechecking time (seconds) |\n| --- | --- |\n| 1 | 0.001 |\n| 2 | 0.001 |\n| 4 | 0.003 |\n| 8 | 0.003 |\n| 16 | 0.007 |\n| 32 | 0.014 |\n| 64 | 0.048 |\n| 128 | 0.119 |\n| 256 | 0.386 |\n| 512 | 1.316 |\n| 1024 | 4.893 |\n| 2048 | 19.227 |\n| 4096 | 82.713 |\n| 8192 | Sits at typechecking for minutes, then fails with \"Illegal instruction\" |\n\nHere's the full output of `time-passes` for the 4096 case, to see the enormous disparity between typechecking and the other passes (though liveness is another offender):\n\n```\ntime: 0.022 s   parsing\ntime: 0.002 s   gated feature checking\ntime: 0.000 s   crate injection\ntime: 0.003 s   configuration 1\ntime: 0.003 s   plugin loading\ntime: 0.000 s   plugin registration\ntime: 0.474 s   expansion\ntime: 0.036 s   configuration 2\ntime: 0.036 s   maybe building test harness\ntime: 0.032 s   prelude injection\ntime: 0.005 s   checking that all macro invocations are gone\ntime: 0.045 s   assigning node ids and indexing ast\ntime: 0.005 s   external crate/lib resolution\ntime: 0.008 s   language item collection\ntime: 0.120 s   resolution\ntime: 0.009 s   lifetime resolution\ntime: 0.006 s   looking for entry point\ntime: 0.004 s   looking for plugin registrar\ntime: 0.030 s   region resolution\ntime: 0.004 s   loop checking\ntime: 0.004 s   stability index\ntime: 0.004 s   static item recursion checking\ntime: 0.024 s   type collecting\ntime: 0.009 s   variance inference\ntime: 0.080 s   coherence checking\ntime: 82.713 s  type checking\ntime: 0.057 s   check static items\ntime: 0.065 s   const marking\ntime: 0.005 s   const checking\ntime: 0.025 s   privacy checking\ntime: 0.020 s   intrinsic checking\ntime: 0.015 s   effect checking\ntime: 0.226 s   match checking\ntime: 55.143 s  liveness checking\ntime: 2.312 s   borrow checking\ntime: 0.104 s   rvalue checking\ntime: 0.002 s   reachability checking\ntime: 0.115 s   death checking\ntime: 0.190 s   lint checking\ntime: 0.001 s   resolving dependency formats\ntime: 1.998 s   translation\n  time: 0.108 s llvm function passes\n  time: 0.025 s llvm module passes\n  time: 0.902 s codegen passes\n  time: 0.002 s codegen passes\ntime: 1.179 s   LLVM passes\n  time: 0.359 s running linker\ntime: 0.363 s   linking\n```\n\nThis seems to contradict our usual excuse for compiler slowness of \"it's not our fault, it's LLVM\".\n", "closed_by": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/18208/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/18208/timeline", "performed_via_github_app": null, "state_reason": "completed"}