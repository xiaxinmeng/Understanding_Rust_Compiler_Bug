{"url": "https://api.github.com/repos/rust-lang/rust/issues/45246", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/45246/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/45246/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/45246/events", "html_url": "https://github.com/rust-lang/rust/issues/45246", "id": 265110071, "node_id": "MDU6SXNzdWUyNjUxMTAwNzE=", "number": 45246, "title": "Consider emitting DWARF aranges", "user": {"login": "cuviper", "id": 36186, "node_id": "MDQ6VXNlcjM2MTg2", "avatar_url": "https://avatars.githubusercontent.com/u/36186?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cuviper", "html_url": "https://github.com/cuviper", "followers_url": "https://api.github.com/users/cuviper/followers", "following_url": "https://api.github.com/users/cuviper/following{/other_user}", "gists_url": "https://api.github.com/users/cuviper/gists{/gist_id}", "starred_url": "https://api.github.com/users/cuviper/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cuviper/subscriptions", "organizations_url": "https://api.github.com/users/cuviper/orgs", "repos_url": "https://api.github.com/users/cuviper/repos", "events_url": "https://api.github.com/users/cuviper/events{/privacy}", "received_events_url": "https://api.github.com/users/cuviper/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 203130, "node_id": "MDU6TGFiZWwyMDMxMzA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-debuginfo", "name": "A-debuginfo", "color": "f7e101", "default": false, "description": "Area: Debugging information in compiled programs (DWARF, PDB, etc.)"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 630652267, "node_id": "MDU6TGFiZWw2MzA2NTIyNjc=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-feature-request", "name": "C-feature-request", "color": "f5f1fd", "default": false, "description": "Category: A feature request, i.e: not implemented / a PR."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2017-10-12T22:32:05Z", "updated_at": "2021-11-09T20:39:28Z", "closed_at": "2019-11-20T17:21:47Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "I recently discovered that the elfutils `eu-addr2line` [doesn't resolve locations for Rust functions](https://sourceware.org/bugzilla/show_bug.cgi?id=22288).  It turns out that they are expecting `.debug_aranges` to be valid and complete, and even treat its absence as if there are no addresses covered at all.  But `rustc` doesn't emit aranges with its debuginfo, or at least not by default.\r\n\r\nIf you see a `.debug_aranges` section in your rust binaries today, that's probably only from objects compiled by GCC, like jemalloc.  Try `eu-readelf -waranges` to see what CUs and symbols are covered.  Thus even when `.debug_aranges` does exist, it's not necessarily complete.\r\n\r\nClang doesn't emit aranges by default either, but it does have the `-gdwarf-aranges` option to do so.  This turns into the LLVM option `-generate-arange-section`.  So it turns out that Rust can have aranges too, using `rustc -Cllvm-args=-generate-arange-section`.  Great!\r\n\r\nIt would be nice if this were the default though.  The data is usually not very big, but it can let tools map an address to the right CU very quickly, reducing the slower DIE traversals.", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/45246/reactions", "total_count": 3, "+1": 3, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/45246/timeline", "performed_via_github_app": null, "state_reason": "completed"}