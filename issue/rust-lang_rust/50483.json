{"url": "https://api.github.com/repos/rust-lang/rust/issues/50483", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/50483/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/50483/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/50483/events", "html_url": "https://github.com/rust-lang/rust/issues/50483", "id": 320609370, "node_id": "MDU6SXNzdWUzMjA2MDkzNzA=", "number": 50483, "title": "Spurious SIGILL (signal 4) when executing `git` from bootstrap test on `x86_64-apple`", "user": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 325438536, "node_id": "MDU6TGFiZWwzMjU0Mzg1MzY=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-bootstrap", "name": "T-bootstrap", "color": "bfd4f2", "default": false, "description": "Relevant to the bootstrap subteam: Rust's build system (x.py and src/bootstrap)"}, {"id": 371266501, "node_id": "MDU6TGFiZWwzNzEyNjY1MDE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-spurious", "name": "A-spurious", "color": "f7e101", "default": false, "description": "Area: Spurious failures in builds (spuriously == for no apparent reason)"}, {"id": 593503757, "node_id": "MDU6TGFiZWw1OTM1MDM3NTc=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-infra", "name": "T-infra", "color": "bfd4f2", "default": false, "description": "Relevant to the infrastructure team, which will review and decide on the PR/issue."}, {"id": 650846969, "node_id": "MDU6TGFiZWw2NTA4NDY5Njk=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-tracking-issue", "name": "C-tracking-issue", "color": "f5f1fd", "default": false, "description": "Category: A tracking issue for an RFC or an unstable feature."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-05-06T17:05:40Z", "updated_at": "2019-08-19T23:08:41Z", "closed_at": "2019-08-19T23:08:40Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Symptom: on `x86_64-apple` (macOS), when `bootstrap` tries to spawn a Command of `git`, it will crash with signal 4 (SIGILL), which itself will then abort `bootstrap`.\r\n\r\n<details><summary>Sample crash log</summary>\r\n\r\n```\r\n[00:53:34] failures:\r\n[00:53:34] \r\n[00:53:34] ---- builder::__test::dist_with_same_targets_and_hosts stdout ----\r\n[00:53:34]  thread 'builder::__test::dist_with_same_targets_and_hosts' panicked at 'command did not execute successfully: \"git\" \"log\" \"-1\" \"--date=short\" \"--pretty=format:%cd\"\r\n[00:53:34] expected success, got: signal: 4', build_helper/lib.rs:122:9\r\n[00:53:34] \r\n[00:53:34] \r\n[00:53:34] failures:\r\n[00:53:34]     builder::__test::dist_with_same_targets_and_hosts\r\n\r\n...\r\n\r\n/Users/travis/Library/Logs/DiagnosticReports/bootstrap-dbf53a170429e672_2018-05-06-124321_Traviss-Mac-1044.crash\r\nProcess:               bootstrap-dbf53a170429e672 [31299]\r\nPath:                  /Users/USER/*/bootstrap-dbf53a170429e672\r\nIdentifier:            bootstrap-dbf53a170429e672\r\nVersion:               0\r\nCode Type:             X86-64 (Native)\r\nParent Process:        bootstrap-dbf53a170429e672 [31128]\r\nResponsible:           bootstrap-dbf53a170429e672 [31299]\r\nUser ID:               501\r\nDate/Time:             2018-05-06 12:43:17.691 +0000\r\nOS Version:            Mac OS X 10.13.3 (17D47)\r\nReport Version:        12\r\nAnonymous UUID:        A91A3A70-3ADA-D7A9-5891-C1A67A5778E7\r\nTime Awake Since Boot: 3300 seconds\r\nSystem Integrity Protection: enabled\r\nCrashed Thread:        0\r\nException Type:        EXC_BAD_INSTRUCTION (SIGILL)\r\nException Codes:       0x0000000000000001, 0x0000000000000000\r\nException Note:        EXC_CORPSE_NOTIFY\r\nTermination Signal:    Illegal instruction: 4\r\nTermination Reason:    Namespace SIGNAL, Code 0x4\r\nTerminating Process:   exc handler [0]\r\nApplication Specific Information:\r\ncrashed on child side of fork pre-exec\r\nBUG IN CLIENT OF LIBPLATFORM: os_once_t is corrupt\r\nThread 0 Crashed:\r\n0   libsystem_platform.dylib       0x00007fff6f9b5ad4 _os_once_gate_corruption_abort + 23\r\n1   libsystem_platform.dylib       0x00007fff6f9b5b6e _os_once_gate_wait_slow + 129\r\n2   libsystem_platform.dylib       0x00007fff6f9b1ed4 _os_alloc_once + 42\r\n3   libsystem_notify.dylib         0x00007fff6f9ac22f _notify_fork_child + 179\r\n4   libSystem.B.dylib              0x00007fff6d4aeb13 libSystem_atfork_child + 49\r\n5   libsystem_c.dylib              0x00007fff6f79083e fork + 47\r\n6   bootstrap-dbf53a170429e672     0x000000010abfd3c0 std::sys::unix::process::process_inner::_$LT$impl$u20$std..sys..unix..process..process_common..Command$GT$::spawn::h6f398f162ba4d9eb + 912 (process_unix.rs:45)\r\n7   bootstrap-dbf53a170429e672     0x000000010ac1bb2c std::process::Command::output::h4459d64179fe8aba + 28 (result.rs:468)\r\n8   bootstrap-dbf53a170429e672     0x000000010abf43e3 build_helper::output::h8dce802bd45620c3 + 131 (lib.rs:114)\r\n9   bootstrap-dbf53a170429e672     0x000000010a821fc7 bootstrap::channel::GitInfo::new::hb7b5bdb1aa6f99de + 887 (channel.rs:57)\r\n10  bootstrap-dbf53a170429e672     0x000000010a73d672 bootstrap::Build::new::h1206ee0cf8c7def9 + 818 (lib.rs:341)\r\n\r\n...\r\n```\r\n\r\n</details>\r\n\r\nFirst seen on the following PRs:\r\n\r\n* https://github.com/rust-lang/rust/pull/49982#issuecomment-385401447 (2018-04-30T13:42:15Z)\r\n* https://github.com/rust-lang/rust/pull/50309#issuecomment-386876850 (2018-05-06T12:44:09Z)", "closed_by": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/50483/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/50483/timeline", "performed_via_github_app": null, "state_reason": "completed"}