{"url": "https://api.github.com/repos/rust-lang/rust/issues/46313", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/46313/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/46313/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/46313/events", "html_url": "https://github.com/rust-lang/rust/issues/46313", "id": 277138633, "node_id": "MDU6SXNzdWUyNzcxMzg2MzM=", "number": 46313, "title": "Spurious failure in run-make/sanitizer-memory", "user": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 371266501, "node_id": "MDU6TGFiZWwzNzEyNjY1MDE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-spurious", "name": "A-spurious", "color": "f7e101", "default": false, "description": "Area: Spurious failures in builds (spuriously == for no apparent reason)"}, {"id": 650846969, "node_id": "MDU6TGFiZWw2NTA4NDY5Njk=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-tracking-issue", "name": "C-tracking-issue", "color": "f5f1fd", "default": false, "description": "Category: A tracking issue for an RFC or an unstable feature."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2017-11-27T19:28:11Z", "updated_at": "2020-12-08T11:59:24Z", "closed_at": "2020-12-08T11:59:24Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Symptom: on `x86_64-gnu`, the `run-make/sanitizer-memory` fails with exit code 2.\r\n\r\n<details><summary>Example log</summary>\r\n\r\n```\r\n[01:11:45] failures:\r\n[01:11:45] \r\n[01:11:45] ---- [run-make] run-make/sanitizer-memory stdout ----\r\n[01:11:45] \t\r\n[01:11:45] error: make failed\r\n[01:11:45] status: exit code: 2\r\n[01:11:45] command: \"make\"\r\n[01:11:45] stdout:\r\n[01:11:45] ------------------------------------------\r\n[01:11:45] LD_LIBRARY_PATH=\"/checkout/obj/build/x86_64-unknown-linux-gnu/test/run-make/sanitizer-memory.stage2-x86_64-unknown-linux-gnu:/checkout/obj/build/x86_64-unknown-linux-gnu/stage2/lib:/checkout/obj/build/x86_64-unknown-linux-gnu/stage0-tools/x86_64-unknown-linux-gnu/release/deps:/checkout/obj/build/x86_64-unknown-linux-gnu/stage0-sysroot/lib/rustlib/x86_64-unknown-linux-gnu/lib:\" '/checkout/obj/build/x86_64-unknown-linux-gnu/stage2/bin/rustc' --out-dir /checkout/obj/build/x86_64-unknown-linux-gnu/test/run-make/sanitizer-memory.stage2-x86_64-unknown-linux-gnu -L /checkout/obj/build/x86_64-unknown-linux-gnu/test/run-make/sanitizer-memory.stage2-x86_64-unknown-linux-gnu  -g -Z sanitizer=memory -Z print-link-args uninit.rs | \"/checkout/src/etc/cat-and-grep.sh\" librustc_msan\r\n[01:11:45] [[[ begin stdout ]]]\r\n[01:11:45] \u001b[90m\"cc\" \"-Wl,--as-needed\" \"-Wl,-z,noexecstack\" \"-m64\" \"-L\" \"/checkout/obj/build/x86_64-unknown-linux-gnu/stage2/lib/rustlib/x86_64-unknown-linux-gnu/lib\" \"/checkout/obj/build/x86_64-unknown-linux-gnu/test/run-make/sanitizer-memory.stage2-x86_64-unknown-linux-gnu/uninit.uninit0.rcgu.o\" \"/checkout/obj/build/x86_64-unknown-linux-gnu/test/run-make/sanitizer-memory.stage2-x86_64-unknown-linux-gnu/uninit.uninit1.rcgu.o\" \"-o\" \"/checkout/obj/build/x86_64-unknown-linux-gnu/test/run-make/sanitizer-memory.stage2-x86_64-unknown-linux-gnu/uninit\" \"/checkout/obj/build/x86_64-unknown-linux-gnu/test/run-make/sanitizer-memory.stage2-x86_64-unknown-linux-gnu/uninit.crate.allocator.rcgu.o\" \"-Wl,--gc-sections\" \"-pie\" \"-Wl,-z,relro,-z,now\" \"-nodefaultlibs\" \"-L\" \"/checkout/obj/build/x86_64-unknown-linux-gnu/test/run-make/sanitizer-memory.stage2-x86_64-unknown-linux-gnu\" \"-L\" \"/checkout/obj/build/x86_64-unknown-linux-gnu/stage2/lib/rustlib/x86_64-unknown-linux-gnu/lib\" \"-Wl,-Bstatic\" \"/checkout/obj/build/x86_64-unknown-linux-gnu/stage2/lib/rustlib/x86_64-unknown-linux-gnu/lib/libstd-a99e131203633592.rlib\" \"/checkout/obj/build/x86_64-unknown-linux-gnu/stage2/lib/rustlib/x86_64-unknown-linux-gnu/lib/libpanic_unwind-d795c34fd7eb72c9.rlib\" \"/checkout/obj/build/x86_64-unknown-linux-gnu/stage2/lib/rustlib/x86_64-unknown-linux-gnu/lib/libunwind-0f4b95d88e53e455.rlib\" \"-Wl,--whole-archive\" \"/checkout/obj/build/x86_64-unknown-linux-gnu/test/run-make/sanitizer-memory.stage2-x86_64-unknown-linux-gnu/rustc.C7xlHMKdVa9A/librustc_msan-92d1518a2bbae70e.rlib\" \"-Wl,--no-whole-archive\" \"/checkout/obj/build/x86_64-unknown-linux-gnu/stage2/lib/rustlib/x86_64-unknown-linux-gnu/lib/liballoc_system-6d9370e956155877.rlib\" \"/checkout/obj/build/x86_64-unknown-linux-gnu/stage2/lib/rustlib/x86_64-unknown-linux-gnu/lib/liblibc-f874e85b0fc1f5b8.rlib\" \"/checkout/obj/build/x86_64-unknown-linux-gnu/stage2/lib/rustlib/x86_64-unknown-linux-gnu/lib/liballoc-c7758873e5bedec1.rlib\" \"/checkout/obj/build/x86_64-unknown-linux-gnu/stage2/lib/rustlib/x86_64-unknown-linux-gnu/lib/libstd_unicode-c9b8ae6d904bd621.rlib\" \"/checkout/obj/build/x86_64-unknown-linux-gnu/stage2/lib/rustlib/x86_64-unknown-linux-gnu/lib/libcore-c80c8268f013635d.rlib\" \"/checkout/obj/build/x86_64-unknown-linux-gnu/stage2/lib/rustlib/x86_64-unknown-linux-gnu/lib/libcompiler_builtins-6389cf691b0a8db6.rlib\" \"-Wl,-Bdynamic\" \"-l\" \"dl\" \"-l\" \"rt\" \"-l\" \"pthread\" \"-l\" \"pthread\" \"-l\" \"gcc_s\" \"-l\" \"c\" \"-l\" \"m\" \"-l\" \"rt\" \"-l\" \"pthread\" \"-l\" \"util\" \"-l\" \"util\"\r\n[01:11:45] \u001b[0m\r\n[01:11:45] [[[ end stdout ]]]\r\n[01:11:45] /checkout/obj/build/x86_64-unknown-linux-gnu/test/run-make/sanitizer-memory.stage2-x86_64-unknown-linux-gnu/uninit 2>&1 | \"/checkout/src/etc/cat-and-grep.sh\" use-of-uninitialized-value\r\n[01:11:45] [[[ begin stdout ]]]\r\n[01:11:45] \u001b[90mFATAL: Code 0x0100d5be8c70 is out of application range. Non-PIE build?\r\n[01:11:45] FATAL: MemorySanitizer can not mmap the shadow memory.\r\n[01:11:45] FATAL: Make sure to compile with -fPIE and to link with -pie.\r\n[01:11:45] FATAL: Disabling ASLR is known to cause this error.\r\n[01:11:45] FATAL: If running under GDB, try 'set disable-randomization off'.\r\n[01:11:45] ==21730==Process memory map follows:\r\n[01:11:45] \t0x0100d5bc4000-0x0100d5c93000\t/checkout/obj/build/x86_64-unknown-linux-gnu/test/run-make/sanitizer-memory.stage2-x86_64-unknown-linux-gnu/uninit\r\n[01:11:45] \t0x0100d5e93000-0x0100d5e98000\t/checkout/obj/build/x86_64-unknown-linux-gnu/test/run-make/sanitizer-memory.stage2-x86_64-unknown-linux-gnu/uninit\r\n[01:11:45] \t0x0100d5e98000-0x0100d5e9b000\t/checkout/obj/build/x86_64-unknown-linux-gnu/test/run-make/sanitizer-memory.stage2-x86_64-unknown-linux-gnu/uninit\r\n[01:11:45] \t0x0100d5e9b000-0x0100d8301000\t\r\n[01:11:45] \t0x7f2f79ec0000-0x7f2f7a212000\t\r\n[01:11:45] \t0x7f2f7a212000-0x7f2f7a31a000\t/lib/x86_64-linux-gnu/libm-2.23.so\r\n[01:11:45] \t0x7f2f7a31a000-0x7f2f7a519000\t/lib/x86_64-linux-gnu/libm-2.23.so\r\n[01:11:45] \t0x7f2f7a519000-0x7f2f7a51a000\t/lib/x86_64-linux-gnu/libm-2.23.so\r\n[01:11:45] \t0x7f2f7a51a000-0x7f2f7a51b000\t/lib/x86_64-linux-gnu/libm-2.23.so\r\n[01:11:45] \t0x7f2f7a51b000-0x7f2f7a6db000\t/lib/x86_64-linux-gnu/libc-2.23.so\r\n[01:11:45] \t0x7f2f7a6db000-0x7f2f7a8db000\t/lib/x86_64-linux-gnu/libc-2.23.so\r\n[01:11:45] \t0x7f2f7a8db000-0x7f2f7a8df000\t/lib/x86_64-linux-gnu/libc-2.23.so\r\n[01:11:45] \t0x7f2f7a8df000-0x7f2f7a8e1000\t/lib/x86_64-linux-gnu/libc-2.23.so\r\n[01:11:45] \t0x7f2f7a8e1000-0x7f2f7a8e5000\t\r\n[01:11:45] \t0x7f2f7a8e5000-0x7f2f7a8fb000\t/lib/x86_64-linux-gnu/libgcc_s.so.1\r\n[01:11:45] \t0x7f2f7a8fb000-0x7f2f7aafa000\t/lib/x86_64-linux-gnu/libgcc_s.so.1\r\n[01:11:45] \t0x7f2f7aafa000-0x7f2f7aafb000\t/lib/x86_64-linux-gnu/libgcc_s.so.1\r\n[01:11:45] \t0x7f2f7aafb000-0x7f2f7ab13000\t/lib/x86_64-linux-gnu/libpthread-2.23.so\r\n[01:11:45] \t0x7f2f7ab13000-0x7f2f7ad12000\t/lib/x86_64-linux-gnu/libpthread-2.23.so\r\n[01:11:45] \t0x7f2f7ad12000-0x7f2f7ad13000\t/lib/x86_64-linux-gnu/libpthread-2.23.so\r\n[01:11:45] \t0x7f2f7ad13000-0x7f2f7ad14000\t/lib/x86_64-linux-gnu/libpthread-2.23.so\r\n[01:11:45] \t0x7f2f7ad14000-0x7f2f7ad18000\t\r\n[01:11:45] \t0x7f2f7ad18000-0x7f2f7ad1f000\t/lib/x86_64-linux-gnu/librt-2.23.so\r\n[01:11:45] \t0x7f2f7ad1f000-0x7f2f7af1e000\t/lib/x86_64-linux-gnu/librt-2.23.so\r\n[01:11:45] \t0x7f2f7af1e000-0x7f2f7af1f000\t/lib/x86_64-linux-gnu/librt-2.23.so\r\n[01:11:45] \t0x7f2f7af1f000-0x7f2f7af20000\t/lib/x86_64-linux-gnu/librt-2.23.so\r\n[01:11:45] \t0x7f2f7af20000-0x7f2f7af23000\t/lib/x86_64-linux-gnu/libdl-2.23.so\r\n[01:11:45] \t0x7f2f7af23000-0x7f2f7b122000\t/lib/x86_64-linux-gnu/libdl-2.23.so\r\n[01:11:45] \t0x7f2f7b122000-0x7f2f7b123000\t/lib/x86_64-linux-gnu/libdl-2.23.so\r\n[01:11:45] \t0x7f2f7b123000-0x7f2f7b124000\t/lib/x86_64-linux-gnu/libdl-2.23.so\r\n[01:11:45] \t0x7f2f7b124000-0x7f2f7b14a000\t/lib/x86_64-linux-gnu/ld-2.23.so\r\n[01:11:45] \t0x7f2f7b336000-0x7f2f7b347000\t\r\n[01:11:45] \t0x7f2f7b347000-0x7f2f7b349000\t\r\n[01:11:45] \t0x7f2f7b349000-0x7f2f7b34a000\t/lib/x86_64-linux-gnu/ld-2.23.so\r\n[01:11:45] \t0x7f2f7b34a000-0x7f2f7b34b000\t/lib/x86_64-linux-gnu/ld-2.23.so\r\n[01:11:45] \t0x7f2f7b34b000-0x7f2f7b34c000\t\r\n[01:11:45] \t0x7ffcca182000-0x7ffcca1a4000\t[stack]\r\n[01:11:45] \t0x7ffcca1b5000-0x7ffcca1b7000\t[vvar]\r\n[01:11:45] \t0x7ffcca1b7000-0x7ffcca1b9000\t[vdso]\r\n[01:11:45] \t0xffffffffff600000-0xffffffffff601000\t[vsyscall]\r\n[01:11:45] ==21730==End of process memory map.\r\n[01:11:45] \u001b[0m\r\n[01:11:45] [[[ end stdout ]]]\r\n[01:11:45] \u001b[1;31mError: cannot match: use-of-uninitialized-value\u001b[0m\r\n[01:11:45] Makefile:6: recipe for target 'all' failed\r\n[01:11:45] \r\n[01:11:45] ------------------------------------------\r\n[01:11:45] stderr:\r\n[01:11:45] ------------------------------------------\r\n[01:11:45] warning: unused variable: `y`\r\n[01:11:45]   --> uninit.rs:15:9\r\n[01:11:45]    |\r\n[01:11:45] 15 |     let y = xs[0] + xs[1];\r\n[01:11:45]    |         ^\r\n[01:11:45]    |\r\n[01:11:45]    = note: #[warn(unused_variables)] on by default\r\n[01:11:45]    = note: to avoid this warning, consider using `_y` instead\r\n[01:11:45] \r\n[01:11:45] make: *** [all] Error 1\r\n[01:11:45] \r\n[01:11:45] ------------------------------------------\r\n[01:11:45] \r\n[01:11:45] thread '[run-make] run-make/sanitizer-memory' panicked at 'explicit panic', /checkout/src/tools/compiletest/src/runtest.rs:2570:8\r\n[01:11:45] note: Run with `RUST_BACKTRACE=1` for a backtrace.\r\n[01:11:45] \r\n[01:11:45] \r\n[01:11:45] failures:\r\n[01:11:45]     [run-make] run-make/sanitizer-memory\r\n[01:11:45] \r\n[01:11:45] test result: \u001b[31mFAILED\u001b(B\u001b[m. 167 passed; 1 failed; 0 ignored; 0 measured; 0 filtered out\r\n```\r\n\r\n</details>\r\n\r\nAffected PRs:\r\n\r\n* https://github.com/rust-lang/rust/pull/45810#issuecomment-343664878\r\n* https://github.com/rust-lang/rust/pull/46207#issuecomment-347158294\r\n\r\nPotentially relevant: golang/go#12898", "closed_by": {"login": "Dylan-DPC-zz", "id": 12371125, "node_id": "MDQ6VXNlcjEyMzcxMTI1", "avatar_url": "https://avatars.githubusercontent.com/u/12371125?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Dylan-DPC-zz", "html_url": "https://github.com/Dylan-DPC-zz", "followers_url": "https://api.github.com/users/Dylan-DPC-zz/followers", "following_url": "https://api.github.com/users/Dylan-DPC-zz/following{/other_user}", "gists_url": "https://api.github.com/users/Dylan-DPC-zz/gists{/gist_id}", "starred_url": "https://api.github.com/users/Dylan-DPC-zz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Dylan-DPC-zz/subscriptions", "organizations_url": "https://api.github.com/users/Dylan-DPC-zz/orgs", "repos_url": "https://api.github.com/users/Dylan-DPC-zz/repos", "events_url": "https://api.github.com/users/Dylan-DPC-zz/events{/privacy}", "received_events_url": "https://api.github.com/users/Dylan-DPC-zz/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/46313/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/46313/timeline", "performed_via_github_app": null, "state_reason": "completed"}