{"url": "https://api.github.com/repos/rust-lang/rust/issues/92666", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/92666/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/92666/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/92666/events", "html_url": "https://github.com/rust-lang/rust/issues/92666", "id": 1096885096, "node_id": "I_kwDOAAsO6M5BYSNo", "number": 92666, "title": "Module declarations imported via `include!()` have unexpected relative paths", "user": {"login": "kotauskas", "id": 28248600, "node_id": "MDQ6VXNlcjI4MjQ4NjAw", "avatar_url": "https://avatars.githubusercontent.com/u/28248600?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kotauskas", "html_url": "https://github.com/kotauskas", "followers_url": "https://api.github.com/users/kotauskas/followers", "following_url": "https://api.github.com/users/kotauskas/following{/other_user}", "gists_url": "https://api.github.com/users/kotauskas/gists{/gist_id}", "starred_url": "https://api.github.com/users/kotauskas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kotauskas/subscriptions", "organizations_url": "https://api.github.com/users/kotauskas/orgs", "repos_url": "https://api.github.com/users/kotauskas/repos", "events_url": "https://api.github.com/users/kotauskas/events{/privacy}", "received_events_url": "https://api.github.com/users/kotauskas/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2022-01-08T09:43:16Z", "updated_at": "2022-07-27T19:34:29Z", "closed_at": "2022-07-27T19:34:28Z", "author_association": "NONE", "active_lock_reason": null, "body": "Consider this directory structure:\r\n```\r\n\u2517\u2501 proj\r\n   \u2523\u2501 template.rs\r\n   \u2523\u2501 examples\r\n   \u2503  \u2517\u2501 example1\r\n   \u2503     \u2523\u2501 client.rs\r\n   \u2503     \u2523\u2501 server.rs\r\n   \u2503     \u2517\u2501 main.rs\r\n   \u2517\u2501 ...\r\n```\r\nthe only line in `main.rs` being:\r\n```rust\r\ninclude!(\"../../template.rs\");\r\n```\r\nthen, in `template.rs`:\r\n```rust\r\nmod client;\r\nmod server;\r\n// some more code\r\n```\r\n\r\nThe typical user expectation for `include!()` is to unhygienically copypaste tokens from the given file, as its documentation suggests (although very vaguely, as it only mentions this behavior with expressions). The above code, however, produces the following `E0583`:\r\n```rust\r\nerror[E0583]: file not found for module `client`\r\n --> examples\\example1\\../../template.rs:5:1\r\n  |\r\n5 | mod client;\r\n  | ^^^^^^^^^^^\r\n  |\r\n  = help: to create the module `client`, create file \"examples\\example1\\../..\\client.rs\" or \"examples\\example1\\../..\\client\\mod.rs\"\r\n```\r\n\r\nThis can be very easily worked around with a macro, but the behavior is very counter-intuitive and, at the very least, requires documentation to be adjusted, although I'm not sure if that's the correct solution, so I'm not sending a PR right away. Not sure whether this is a bug at all, but we definitely need a Crater run to determine whether disabling this behavior affects any public crates.", "closed_by": {"login": "ehuss", "id": 43198, "node_id": "MDQ6VXNlcjQzMTk4", "avatar_url": "https://avatars.githubusercontent.com/u/43198?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ehuss", "html_url": "https://github.com/ehuss", "followers_url": "https://api.github.com/users/ehuss/followers", "following_url": "https://api.github.com/users/ehuss/following{/other_user}", "gists_url": "https://api.github.com/users/ehuss/gists{/gist_id}", "starred_url": "https://api.github.com/users/ehuss/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ehuss/subscriptions", "organizations_url": "https://api.github.com/users/ehuss/orgs", "repos_url": "https://api.github.com/users/ehuss/repos", "events_url": "https://api.github.com/users/ehuss/events{/privacy}", "received_events_url": "https://api.github.com/users/ehuss/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/92666/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/92666/timeline", "performed_via_github_app": null, "state_reason": "not_planned"}