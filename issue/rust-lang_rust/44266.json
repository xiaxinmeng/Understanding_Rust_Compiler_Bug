{"url": "https://api.github.com/repos/rust-lang/rust/issues/44266", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/44266/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/44266/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/44266/events", "html_url": "https://github.com/rust-lang/rust/issues/44266", "id": 254795606, "node_id": "MDU6SXNzdWUyNTQ3OTU2MDY=", "number": 44266, "title": "C-style enum doesn't work in match arm", "user": {"login": "ctz", "id": 579363, "node_id": "MDQ6VXNlcjU3OTM2Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/579363?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ctz", "html_url": "https://github.com/ctz", "followers_url": "https://api.github.com/users/ctz/followers", "following_url": "https://api.github.com/users/ctz/following{/other_user}", "gists_url": "https://api.github.com/users/ctz/gists{/gist_id}", "starred_url": "https://api.github.com/users/ctz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ctz/subscriptions", "organizations_url": "https://api.github.com/users/ctz/orgs", "repos_url": "https://api.github.com/users/ctz/repos", "events_url": "https://api.github.com/users/ctz/events{/privacy}", "received_events_url": "https://api.github.com/users/ctz/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 211668019, "node_id": "MDU6TGFiZWwyMTE2NjgwMTk=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-lang", "name": "T-lang", "color": "bfd4f2", "default": false, "description": "Relevant to the language team, which will review and decide on the PR/issue."}, {"id": 630652267, "node_id": "MDU6TGFiZWw2MzA2NTIyNjc=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-feature-request", "name": "C-feature-request", "color": "f5f1fd", "default": false, "description": "Category: A feature request, i.e: not implemented / a PR."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2017-09-02T07:24:17Z", "updated_at": "2017-09-11T19:38:39Z", "closed_at": "2017-09-11T19:38:39Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I expected this to work, but it doesn't:\r\n\r\n```\r\nenum Thing {\r\n    Foo = 0,\r\n    Bar = 1,\r\n}\r\n\r\nfn main() {\r\n    // works\r\n    println!(\"Foo is {}\", Thing::Foo as u8);\r\n    \r\n    // doesn't\r\n    match 0u8 {\r\n        Thing::Foo as u8 => println!(\"0 is Foo\"),\r\n        _ => println!(\"eh\")\r\n    };\r\n}\r\n```\r\nwith:\r\n```\r\nerror: expected one of `::`, `=>`, `if`, or `|`, found `as`\r\n  --> src/main.rs:11:20\r\n   |\r\n11 |         Thing::Foo as u8 => println!(\"0 is Foo\"),\r\n   |                   -^^ unexpected token\r\n   |                   |\r\n   |                   expected one of `::`, `=>`, `if`, or `|` here\r\n```\r\n\r\nPutting the cast inside extra parens doesn't help.\r\n\r\nMy use case is having an enum whose ordinals match an external protocol definition, then matching against the value read off the wire to convert into a member of the enum. I would expect this to be super common.\r\n\r\nPrevious history:\r\n\r\n- #3580 which is precisely this issue, but is closed as duplicating:\r\n- #2132 which is not the same thing (in fact, the opposite). Continued to:\r\n- #3868 which introduced a bunch of traits to make this work; but now deprecated and removed", "closed_by": {"login": "steveklabnik", "id": 27786, "node_id": "MDQ6VXNlcjI3Nzg2", "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/steveklabnik", "html_url": "https://github.com/steveklabnik", "followers_url": "https://api.github.com/users/steveklabnik/followers", "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}", "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}", "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions", "organizations_url": "https://api.github.com/users/steveklabnik/orgs", "repos_url": "https://api.github.com/users/steveklabnik/repos", "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}", "received_events_url": "https://api.github.com/users/steveklabnik/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/44266/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/44266/timeline", "performed_via_github_app": null, "state_reason": "completed"}