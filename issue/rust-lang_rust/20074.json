{"url": "https://api.github.com/repos/rust-lang/rust/issues/20074", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/20074/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/20074/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/20074/events", "html_url": "https://github.com/rust-lang/rust/issues/20074", "id": 52564675, "node_id": "MDU6SXNzdWU1MjU2NDY3NQ==", "number": 20074, "title": "compiler bug: const expr(...) of type X has size 20 instead of 24", "user": {"login": "conradkleinespel", "id": 1234006, "node_id": "MDQ6VXNlcjEyMzQwMDY=", "avatar_url": "https://avatars.githubusercontent.com/u/1234006?v=4", "gravatar_id": "", "url": "https://api.github.com/users/conradkleinespel", "html_url": "https://github.com/conradkleinespel", "followers_url": "https://api.github.com/users/conradkleinespel/followers", "following_url": "https://api.github.com/users/conradkleinespel/following{/other_user}", "gists_url": "https://api.github.com/users/conradkleinespel/gists{/gist_id}", "starred_url": "https://api.github.com/users/conradkleinespel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/conradkleinespel/subscriptions", "organizations_url": "https://api.github.com/users/conradkleinespel/orgs", "repos_url": "https://api.github.com/users/conradkleinespel/repos", "events_url": "https://api.github.com/users/conradkleinespel/events{/privacy}", "received_events_url": "https://api.github.com/users/conradkleinespel/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2014-12-20T13:49:46Z", "updated_at": "2015-03-04T19:00:25Z", "closed_at": "2015-03-04T19:00:25Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Hello every (reading this) :smiley: \n\nI seem to have encountered a compiler bug. As explained in the bug report docs, I am reporting this here.\n\nHere's my rustc version (on 64bits Linux Ubuntu 14.04):\n\n```\nrustc 0.13.0-nightly (193390d0e 2014-12-11 22:56:54 +0000)\n```\n\nI am compiling this through Cargo:\n\n```\ncargo 0.0.1-pre-nightly (0f6667c 2014-12-08 21:19:01 +0000)\n```\n\nHere's a backtrace of the error:\n\n```\nerror: internal compiler error: const expr(81: Check::Chars('<', '\\x00', '\\x00', '\\x00')) of type Check has size 20 instead of 24\nnote: the compiler unexpectedly panicked. this is a bug.\nnote: we would appreciate a bug report: http://doc.rust-lang.org/complement-bugreport.html\nnote: run with `RUST_BACKTRACE=1` for a backtrace\ntask 'rustc' panicked at 'Box<Any>', /home/rustbuild/src/rust-buildbot/slave/nightly-linux/build/src/libsyntax/diagnostic.rs:188\n\nstack backtrace:\n   1:     0x7fcec950a500 - rt::backtrace::imp::write::heed5901f9756dd23BOx\n   2:     0x7fcec950d740 - failure::on_fail::ha44d264deefff4481fy\n   3:     0x7fcec915ef30 - unwind::begin_unwind_inner::h8d953f2c1d079705CJc\n   4:     0x7fcec6bad040 - unwind::begin_unwind::h6666496483973781562\n   5:     0x7fcec6bad8f0 - diagnostic::Handler::bug::h3a50c284fdf4e0a0baF\n   6:     0x7fcec7763c90 - session::Session::bug::h961d19b73812d5bclMz\n   7:     0x7fcec81efd40 - trans::consts::const_expr::hfa0dfd22263a486eY9n\n   8:     0x7fcec81f8d20 - trans::consts::const_expr_unadjusted::closure.43393\n   9:     0x7fcec81f7b60 - trans::expr::with_field_tys::h14927854885479319893\n  10:     0x7fcec81f2800 - trans::consts::const_expr_unadjusted::h8c6ef2cbf874918a5lo\n  11:     0x7fcec81efd40 - trans::consts::const_expr::hfa0dfd22263a486eY9n\n  12:     0x7fcec81f2800 - trans::consts::const_expr_unadjusted::h8c6ef2cbf874918a5lo\n  13:     0x7fcec81efd40 - trans::consts::const_expr::hfa0dfd22263a486eY9n\n  14:     0x7fcec81f2800 - trans::consts::const_expr_unadjusted::h8c6ef2cbf874918a5lo\n  15:     0x7fcec81efd40 - trans::consts::const_expr::hfa0dfd22263a486eY9n\n  16:     0x7fcec814f120 - trans::base::get_item_val::h5e961c6ea5c9b50aGhv\n  17:     0x7fcec814c020 - trans::base::trans_item::h567773db3b83315aeMu\n  18:     0x7fcec82135a0 - trans::base::trans_mod::hc21a44b9f586bc03JRu\n  19:     0x7fcec8217430 - trans::base::trans_crate::h03fccece3ec7cb85oIv\n  20:     0x7fcec9946540 - driver::phase_4_translate_to_llvm::hb8e7de445fc1ade7VCa\n  21:     0x7fcec992b260 - driver::compile_input::hf96889ff0bafd855pba\n  22:     0x7fcec99c8070 - run_compiler::h9db34658886d7891EYb\n  23:     0x7fcec99c7f60 - run::closure.21438\n  24:     0x7fcec99d9970 - task::TaskBuilder::try_future::closure.22892\n  25:     0x7fcec94e2980 - task::TaskBuilder::spawn_internal::closure.30605\n  26:     0x7fcec915cbd0 - task::Task::spawn::closure.5728\n  27:     0x7fcec91ba250 - rust_try_inner\n  28:     0x7fcec91ba240 - rust_try\n  29:     0x7fcec915ccb0 - unwind::try::hf2f7fcf7ecc46c43Tyc\n  30:     0x7fcec915ca70 - task::Task::run::h911f3b3bbb0c433efKb\n  31:     0x7fcec915c660 - task::Task::spawn::closure.5704\n  32:     0x7fcec915e0b0 - thread::thread_start::h051da3e5b33a422fw1b\n  33:     0x7fcec40480c0 - start_thread\n  34:     0x7fcec8e22ec9 - __clone\n  35:                0x0 - <unknown>\n\nCould not compile `parser`.\n```\n\nJust in case it could help, here's the code I am trying to compile (the start of a HTML lexer with a state transition table):\n\n``` rust\n// Lookahead of 3 symbols, which allows to see \"!--\" for a comment.\n\nenum State {\n    General,\n    TagName,\n    TagAttributeName,\n    TagAttributeValue,\n    Text,\n    Doctype,\n    Comment\n}\n\nenum Check {\n    Function(fn(c1: char, c2: char, c3: char, c4: char) -> bool),\n    Chars(char, char, char, char)\n}\n\nstruct Transition {\n    from: State,\n    to: State,\n    lookahead: u8,\n    through: Check,\n    save_char: bool,\n    save_previous_token: bool\n}\n\nstatic transition_table: &'static [Transition] = &[\n    Transition {\n        from: State::General,\n        to: State::TagName,\n        lookahead: 1,\n        through: Check::Chars('<', '\\0', '\\0', '\\0'),\n        save_char: false,\n        save_previous_token: false,\n    }\n];\n\nfn main() {\n    let mut stdin = std::io::stdio::stdin();\n\n    for line_result in stdin.lock().lines() {\n        match line_result {\n            Ok(line) => {\n                let slice = line.as_slice().slice_to(line.len() - 1);\n                println!(\"{}\", slice);\n            },\n            Err(err) => {\n                println!(\"{}\", err);\n                return;\n            }\n        }\n    }\n}\n```\n\nHopefully, this can help. Please feel free to ask for more information if you need :-)\n", "closed_by": {"login": "dotdash", "id": 230962, "node_id": "MDQ6VXNlcjIzMDk2Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/230962?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dotdash", "html_url": "https://github.com/dotdash", "followers_url": "https://api.github.com/users/dotdash/followers", "following_url": "https://api.github.com/users/dotdash/following{/other_user}", "gists_url": "https://api.github.com/users/dotdash/gists{/gist_id}", "starred_url": "https://api.github.com/users/dotdash/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dotdash/subscriptions", "organizations_url": "https://api.github.com/users/dotdash/orgs", "repos_url": "https://api.github.com/users/dotdash/repos", "events_url": "https://api.github.com/users/dotdash/events{/privacy}", "received_events_url": "https://api.github.com/users/dotdash/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/20074/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/20074/timeline", "performed_via_github_app": null, "state_reason": "completed"}