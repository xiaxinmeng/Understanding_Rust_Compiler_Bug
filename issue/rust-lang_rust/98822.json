{"url": "https://api.github.com/repos/rust-lang/rust/issues/98822", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/98822/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/98822/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/98822/events", "html_url": "https://github.com/rust-lang/rust/issues/98822", "id": 1292141403, "node_id": "I_kwDOAAsO6M5NBINb", "number": 98822, "title": "Better error message when asking for derive when there are already derive macros", "user": {"login": "FauconFan", "id": 22058263, "node_id": "MDQ6VXNlcjIyMDU4MjYz", "avatar_url": "https://avatars.githubusercontent.com/u/22058263?v=4", "gravatar_id": "", "url": "https://api.github.com/users/FauconFan", "html_url": "https://github.com/FauconFan", "followers_url": "https://api.github.com/users/FauconFan/followers", "following_url": "https://api.github.com/users/FauconFan/following{/other_user}", "gists_url": "https://api.github.com/users/FauconFan/gists{/gist_id}", "starred_url": "https://api.github.com/users/FauconFan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/FauconFan/subscriptions", "organizations_url": "https://api.github.com/users/FauconFan/orgs", "repos_url": "https://api.github.com/users/FauconFan/repos", "events_url": "https://api.github.com/users/FauconFan/events{/privacy}", "received_events_url": "https://api.github.com/users/FauconFan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 235791, "node_id": "MDU6TGFiZWwyMzU3OTE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-diagnostics", "name": "A-diagnostics", "color": "f7e101", "default": false, "description": "Area: Messages for errors, warnings, and lints"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-07-02T21:02:41Z", "updated_at": "2023-04-05T17:28:37Z", "closed_at": null, "author_association": "NONE", "active_lock_reason": null, "body": "Hi !\r\n\r\nI just notice something that looks like a subtlety than anything else, but I still created this issue.\r\nConsider the following program:\r\n\r\n```rust\r\n#[derive(Copy, Clone)]\r\nstruct Single;\r\n\r\nfn main() {\r\n\tlet a = Single;\r\n\tprintln!(\"coucou {:?}\", a);\r\n}\r\n```\r\nA snippet on the playgroud: [Link to Playground](https://play.rust-lang.org/?version=stable&mode=debug&edition=2021&gist=acf2c1194991f9854a9b384f1d8935e5)\r\n\r\nThis code obviously doesn't compile, but the error message could be better (in my opinion). The current error message is:\r\n\r\n```console\r\nerror[E0277]: `Single` doesn't implement `Debug`\r\n --> main.rs:7:26\r\n  |\r\n6 |     println!(\"coucou {:?}\", a);\r\n  |                             ^ `Single` cannot be formatted using `{:?}`\r\n  |\r\n  = help: the trait `Debug` is not implemented for `Single`\r\n  = note: add `#[derive(Debug)]` to `Single` or manually `impl Debug for Single`\r\n  = note: this error originates in the macro `$crate::format_args_nl` (in Nightly builds, run with -Z macro-backtrace for more info)\r\nhelp: consider annotating `Single` with `#[derive(Debug)]`\r\n  |\r\n2 | #[derive(Debug)]\r\n  |\r\n\r\nerror: aborting due to previous error\r\n\r\nFor more information about this error, try `rustc --explain E0277`.\r\n```\r\n\r\nMaybe it could look like that:\r\n```console\r\nerror[E0277]: `Single` doesn't implement `Debug`\r\n --> main.rs:7:26\r\n  |\r\n6 |     println!(\"coucou {:?}\", a);\r\n  |                             ^ `Single` cannot be formatted using `{:?}`\r\n  |\r\n  = help: the trait `Debug` is not implemented for `Single`\r\n  = note: add `#[derive(Debug)]` to `Single` or manually `impl Debug for Single`\r\n  = note: this error originates in the macro `$crate::format_args_nl` (in Nightly builds, run with -Z macro-backtrace for more info)\r\nhelp: consider annotating `Single` with `#[derive(Debug)]`\r\n  |\r\n1 | #[derive(Copy, Clone, Debug)]\r\n  |                       ^\r\n  |                       ++++++\r\n  |\r\n\r\nerror: aborting due to previous error\r\n\r\nFor more information about this error, try `rustc --explain E0277`.\r\n```\r\n\r\nMy point is, maybe this error message could take into account the fact that deriving traits is already present, instead of stacking them... Another way to look at this is that it depends of the developer style, then this error message couldn't display both versions...", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/98822/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/98822/timeline", "performed_via_github_app": null, "state_reason": null}