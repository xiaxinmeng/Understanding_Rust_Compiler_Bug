{"url": "https://api.github.com/repos/rust-lang/rust/issues/93667", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/93667/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/93667/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/93667/events", "html_url": "https://github.com/rust-lang/rust/issues/93667", "id": 1124743991, "node_id": "I_kwDOAAsO6M5DCjs3", "number": 93667, "title": "rustdoc-json: Inconsistant Enum Representation", "user": {"login": "aDotInTheVoid", "id": 28781354, "node_id": "MDQ6VXNlcjI4NzgxMzU0", "avatar_url": "https://avatars.githubusercontent.com/u/28781354?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aDotInTheVoid", "html_url": "https://github.com/aDotInTheVoid", "followers_url": "https://api.github.com/users/aDotInTheVoid/followers", "following_url": "https://api.github.com/users/aDotInTheVoid/following{/other_user}", "gists_url": "https://api.github.com/users/aDotInTheVoid/gists{/gist_id}", "starred_url": "https://api.github.com/users/aDotInTheVoid/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aDotInTheVoid/subscriptions", "organizations_url": "https://api.github.com/users/aDotInTheVoid/orgs", "repos_url": "https://api.github.com/users/aDotInTheVoid/repos", "events_url": "https://api.github.com/users/aDotInTheVoid/events{/privacy}", "received_events_url": "https://api.github.com/users/aDotInTheVoid/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 203738, "node_id": "MDU6TGFiZWwyMDM3Mzg=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-rustdoc", "name": "T-rustdoc", "color": "bfd4f2", "default": false, "description": "Relevant to the rustdoc team, which will review and decide on the PR/issue."}, {"id": 2352122097, "node_id": "MDU6TGFiZWwyMzUyMTIyMDk3", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-discussion", "name": "C-discussion", "color": "f5f1fd", "default": false, "description": "Category: Discussion or questions that doesn't represent real issues."}, {"id": 2682491374, "node_id": "MDU6TGFiZWwyNjgyNDkxMzc0", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-rustdoc-json", "name": "A-rustdoc-json", "color": "f7e101", "default": false, "description": "Area: Rustdoc JSON backend"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-02-05T00:39:33Z", "updated_at": "2023-05-23T21:38:07Z", "closed_at": "2023-05-23T21:38:06Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Currently we use 3 different ways to serialse enums to json:\r\n\r\n1. For some of the enums, we use [Adjacently tagged](https://serde.rs/enum-representations.html#adjacently-tagged)\r\n\r\nhttps://github.com/rust-lang/rust/blob/71226d717a1fb57122e47e63b97295e703319cb0/src/rustdoc-json-types/lib.rs#L372-L423\r\n\r\nWhich ends up looking like\r\n\r\n```json\r\n              \"output\": {\r\n                \"inner\": {\r\n                  \"lifetime\": \"'a\",\r\n                  \"mutable\": false,\r\n                  \"type\": {\"inner\": \"i32\", \"kind\": \"primitive\"}\r\n                },\r\n                \"kind\": \"borrowed_ref\"\r\n              }\r\n```\r\n\r\n2. For others we use serdes default which is [Externally tagged](https://serde.rs/enum-representations.html#externally-tagged)\r\n\r\nhttps://github.com/rust-lang/rust/blob/71226d717a1fb57122e47e63b97295e703319cb0/src/rustdoc-json-types/lib.rs#L322-L334\r\n\r\nWhich gives output that looks like\r\n\r\n```json\r\n          \"params\": [\r\n            {\r\n              \"kind\": {\"lifetime\": {\"outlives\": []}},\r\n              \"name\": \"'a\"\r\n            },\r\n            {\r\n              \"kind\": {\"type\": {\"bounds\": [], \"default\": null}},\r\n              \"name\": \"T\"\r\n            }\r\n```\r\n\r\n3. Finaly we have the `Item` / `ItemEnum`, which are their own special weird, because of #82613.\r\nIts basicly Ajacenctly tagged, but the tag/content are inlined to the Item\r\n\r\nI'm not sure how much it matters which one we pick as almost all users will be going through the rust types, but it would be good to be consistant. I have no prefernce between 1 and 2, but 3 seems weird, so I dont think we should do that.\r\n\r\ncc @CraftSpider \r\n\r\n@rustbot modify labels: +C-discussion +A-rustdoc-json +T-rustdoc \r\nbut I think 3 is bad \r\n\r\n\r\n\r\n\r\n", "closed_by": {"login": "aDotInTheVoid", "id": 28781354, "node_id": "MDQ6VXNlcjI4NzgxMzU0", "avatar_url": "https://avatars.githubusercontent.com/u/28781354?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aDotInTheVoid", "html_url": "https://github.com/aDotInTheVoid", "followers_url": "https://api.github.com/users/aDotInTheVoid/followers", "following_url": "https://api.github.com/users/aDotInTheVoid/following{/other_user}", "gists_url": "https://api.github.com/users/aDotInTheVoid/gists{/gist_id}", "starred_url": "https://api.github.com/users/aDotInTheVoid/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aDotInTheVoid/subscriptions", "organizations_url": "https://api.github.com/users/aDotInTheVoid/orgs", "repos_url": "https://api.github.com/users/aDotInTheVoid/repos", "events_url": "https://api.github.com/users/aDotInTheVoid/events{/privacy}", "received_events_url": "https://api.github.com/users/aDotInTheVoid/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/93667/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/93667/timeline", "performed_via_github_app": null, "state_reason": "completed"}