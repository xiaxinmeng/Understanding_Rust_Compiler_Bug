{"url": "https://api.github.com/repos/rust-lang/rust/issues/76343", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/76343/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/76343/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/76343/events", "html_url": "https://github.com/rust-lang/rust/issues/76343", "id": 693614049, "node_id": "MDU6SXNzdWU2OTM2MTQwNDk=", "number": 76343, "title": "SGX is_enclave_range/is_user_range overflow checking", "user": {"login": "okready", "id": 423952, "node_id": "MDQ6VXNlcjQyMzk1Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/423952?v=4", "gravatar_id": "", "url": "https://api.github.com/users/okready", "html_url": "https://github.com/okready", "followers_url": "https://api.github.com/users/okready/followers", "following_url": "https://api.github.com/users/okready/following{/other_user}", "gists_url": "https://api.github.com/users/okready/gists{/gist_id}", "starred_url": "https://api.github.com/users/okready/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/okready/subscriptions", "organizations_url": "https://api.github.com/users/okready/orgs", "repos_url": "https://api.github.com/users/okready/repos", "events_url": "https://api.github.com/users/okready/events{/privacy}", "received_events_url": "https://api.github.com/users/okready/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 2227894826, "node_id": "MDU6TGFiZWwyMjI3ODk0ODI2", "url": "https://api.github.com/repos/rust-lang/rust/labels/O-SGX", "name": "O-SGX", "color": "6e6ec0", "default": false, "description": "Target: SGX"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-09-04T20:51:49Z", "updated_at": "2021-03-03T08:36:42Z", "closed_at": "2021-03-03T08:36:42Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Currently, the `is_enclave_range` and `is_user_range` functions in `sgx::os::fortanix_sgx::mem` do not perform overflow checks for input memory ranges. While debug builds will panic if an overflow occurs, release builds perform no such checking, which can lead to false positive results from either function for overflowing memory ranges.\r\n\r\nOne of the typical uses for these functions is to validate memory ranges passed into the enclave from untrusted code. Compromised untrusted code can intentionally pass overflowing ranges to enclave code, and without proper overflow checking, these false positives can potentially result in security vulnerabilities such as leakage of secret data or overwriting of enclave data (including code) with data from the untrusted application layer.\r\n\r\nWhile applications can be left responsible for overflow checking, it is another step that application authors have to consider that is easy to overlook. Additionally, the corresponding `sgx_is_within_enclave` and `sgx_is_outside_enclave` functions from the Intel SGX SDK handle overflow checks, so developers migrating from the Intel SGX SDK to `x86_64-fortanix-unknown-sgx` or referring to existing Intel SGX SDK-based code may not expect overflow handling to be omitted from `x86_64-fortanix-unknown-sgx`.\r\n\r\nAdding overflow checks to `is_enclave_range` and `is_user_range` should be relatively low-impact. Breakage of existing code is not expected; ranges that do not trigger overflow with the current implementations should have the same results, while overflowing ranges are more than likely already yielding unexpected behavior and exposing possible security vulnerabilities as described and would benefit from the fix (unless the application is already checking for overflow manually, in which case such checks will simply become redundant). Bringing feature parity with the Intel SGX SDK versions of these functions will also avoid unintentional mistakes from switching over.", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/76343/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/76343/timeline", "performed_via_github_app": null, "state_reason": "completed"}