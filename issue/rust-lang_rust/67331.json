{"url": "https://api.github.com/repos/rust-lang/rust/issues/67331", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/67331/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/67331/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/67331/events", "html_url": "https://github.com/rust-lang/rust/issues/67331", "id": 538094936, "node_id": "MDU6SXNzdWU1MzgwOTQ5MzY=", "number": 67331, "title": "Performance regression in nightly-2019-12-14", "user": {"login": "jbg", "id": 39903, "node_id": "MDQ6VXNlcjM5OTAz", "avatar_url": "https://avatars.githubusercontent.com/u/39903?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jbg", "html_url": "https://github.com/jbg", "followers_url": "https://api.github.com/users/jbg/followers", "following_url": "https://api.github.com/users/jbg/following{/other_user}", "gists_url": "https://api.github.com/users/jbg/gists{/gist_id}", "starred_url": "https://api.github.com/users/jbg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jbg/subscriptions", "organizations_url": "https://api.github.com/users/jbg/orgs", "repos_url": "https://api.github.com/users/jbg/repos", "events_url": "https://api.github.com/users/jbg/events{/privacy}", "received_events_url": "https://api.github.com/users/jbg/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 64037154, "node_id": "MDU6TGFiZWw2NDAzNzE1NA==", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-compiletime", "name": "I-compiletime", "color": "e11d21", "default": false, "description": "Problems and improvements with respect to compile times."}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 262252628, "node_id": "MDU6TGFiZWwyNjIyNTI2Mjg=", "url": "https://api.github.com/repos/rust-lang/rust/labels/regression-from-stable-to-beta", "name": "regression-from-stable-to-beta", "color": "e4008a", "default": false, "description": "Performance or correctness regression from stable to beta."}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}, {"id": 1359848690, "node_id": "MDU6TGFiZWwxMzU5ODQ4Njkw", "url": "https://api.github.com/repos/rust-lang/rust/labels/E-needs-mcve", "name": "E-needs-mcve", "color": "02e10c", "default": false, "description": "Call for participation: This issue needs a Minimal Complete and Verifiable Example"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2019-12-15T19:32:25Z", "updated_at": "2019-12-20T20:10:08Z", "closed_at": "2019-12-20T20:10:08Z", "author_association": "NONE", "active_lock_reason": null, "body": "nightly-2019-12-14 times out building a crate here after 60m.\r\n\r\nnightly-2019-12-13 builds it in 2m.\r\n\r\n`cargo-bisect-rustc` gives:\r\n\r\n```\r\nbisecting ci builds\r\nstarting at 3eeb8d4f2, ending at ff15e9670\r\nfetching commits from 3eeb8d4f2 to ff15e9670\r\nopening existing repository at \"rust.git\"\r\nrefreshing repository\r\nlooking up first commit\r\nlooking up second commit\r\nchecking that commits are by bors and thus have ci artifacts...\r\nfinding bors merge commits\r\nfound 6 bors merge commits in the specified range\r\nopening existing repository at \"rust.git\"\r\nrefreshing repository\r\nvalidated commits found, specifying toolchains\r\ntesting commits\r\nverifying the start of the range does not reproduce the regression\r\ninstalling 3eeb8d4f2fbae0bb1c587d00b5abeaf938da47f4\r\ntesting 3eeb8d4f2fbae0bb1c587d00b5abeaf938da47f4\r\ntested 3eeb8d4f2fbae0bb1c587d00b5abeaf938da47f4, got No\r\nuninstalling 3eeb8d4f2fbae0bb1c587d00b5abeaf938da47f4\r\nconfirmed the start of the range does not reproduce the regression\r\nverifying the end of the range reproduces the regression\r\ninstalling ff15e9670843f8bd6b54ab1b042d2095b4c0aa6d\r\ntesting ff15e9670843f8bd6b54ab1b042d2095b4c0aa6d\r\ntested ff15e9670843f8bd6b54ab1b042d2095b4c0aa6d, got Yes\r\nuninstalling ff15e9670843f8bd6b54ab1b042d2095b4c0aa6d\r\nconfirmed the end of the range reproduces the regression\r\ninstalling 9409c208a9a70eb6194c7502979843f42d6fed1a\r\ntesting 9409c208a9a70eb6194c7502979843f42d6fed1a\r\ntested 9409c208a9a70eb6194c7502979843f42d6fed1a, got Yes\r\nuninstalling 9409c208a9a70eb6194c7502979843f42d6fed1a\r\ninstalling cf7e019b42cd523d91cb350ab49acbda1b11e571\r\ntesting cf7e019b42cd523d91cb350ab49acbda1b11e571\r\ntested cf7e019b42cd523d91cb350ab49acbda1b11e571, got No\r\nuninstalling cf7e019b42cd523d91cb350ab49acbda1b11e571\r\nsearched toolchains 3eeb8d4f2fbae0bb1c587d00b5abeaf938da47f4 through ff15e9670843f8bd6b54ab1b042d2095b4c0aa6d\r\nregression in 9409c208a9a70eb6194c7502979843f42d6fed1a\r\n```\r\n\r\nWhich relates to PR #66405 \r\n\r\nI'm working on a minimal repro but it may be difficult - the crate is a complex web API backend using a lot of async/await. Commenting out the entire route dispatcher brings us back to 2m compile time, bringing back routes one at a time indicates that routes which use database transactions (passing a `&mut Transaction<'_>` from `deadpool-postgres` to various async fns) trigger the regression, but they could also have something else in common.", "closed_by": {"login": "jbg", "id": 39903, "node_id": "MDQ6VXNlcjM5OTAz", "avatar_url": "https://avatars.githubusercontent.com/u/39903?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jbg", "html_url": "https://github.com/jbg", "followers_url": "https://api.github.com/users/jbg/followers", "following_url": "https://api.github.com/users/jbg/following{/other_user}", "gists_url": "https://api.github.com/users/jbg/gists{/gist_id}", "starred_url": "https://api.github.com/users/jbg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jbg/subscriptions", "organizations_url": "https://api.github.com/users/jbg/orgs", "repos_url": "https://api.github.com/users/jbg/repos", "events_url": "https://api.github.com/users/jbg/events{/privacy}", "received_events_url": "https://api.github.com/users/jbg/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/67331/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/67331/timeline", "performed_via_github_app": null, "state_reason": "completed"}