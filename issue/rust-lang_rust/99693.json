{"url": "https://api.github.com/repos/rust-lang/rust/issues/99693", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/99693/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/99693/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/99693/events", "html_url": "https://github.com/rust-lang/rust/issues/99693", "id": 1316002385, "node_id": "I_kwDOAAsO6M5OcJpR", "number": 99693, "title": "Chaining too many iterators in nightly debug causes stack overflow", "user": {"login": "Jardynq", "id": 30781235, "node_id": "MDQ6VXNlcjMwNzgxMjM1", "avatar_url": "https://avatars.githubusercontent.com/u/30781235?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Jardynq", "html_url": "https://github.com/Jardynq", "followers_url": "https://api.github.com/users/Jardynq/followers", "following_url": "https://api.github.com/users/Jardynq/following{/other_user}", "gists_url": "https://api.github.com/users/Jardynq/gists{/gist_id}", "starred_url": "https://api.github.com/users/Jardynq/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Jardynq/subscriptions", "organizations_url": "https://api.github.com/users/Jardynq/orgs", "repos_url": "https://api.github.com/users/Jardynq/repos", "events_url": "https://api.github.com/users/Jardynq/events{/privacy}", "received_events_url": "https://api.github.com/users/Jardynq/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 100522, "node_id": "MDU6TGFiZWwxMDA1MjI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-crash", "name": "I-crash", "color": "e10c02", "default": false, "description": "Issue: The compiler crashes (SIGSEGV, SIGABRT, etc). Use I-ICE instead when the compiler panics."}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-07-24T20:33:31Z", "updated_at": "2023-03-27T04:45:06Z", "closed_at": null, "author_association": "NONE", "active_lock_reason": null, "body": "<!--\r\nThank you for filing a bug report! \ud83d\udc1b Please provide a short summary of the bug,\r\nalong with any information you feel relevant to replicating the bug.\r\n-->\r\n\r\nI tried this code:\r\n\r\n```rust\r\n    const COUNT: usize = 1 << 12;\r\n    let mut iter: Box<dyn Iterator<Item = ()>> = Box::new(std::iter::empty());\r\n    for _ in 0..COUNT {\r\n        iter = Box::new(iter.chain(std::iter::empty()));\r\n    }\r\n    iter.next(); // Causes stack overflow\r\n```\r\n\r\nI expected to see this happen: \r\nThat iter.next() would run and the result is ignored, then the program continues on.\r\n\r\nInstead, this happened: \r\nThe program crashes with exit code: 0xc00000fd, STATUS_STACK_OVERFLOW\r\n\r\nThough I would like to note that I'm not expecting iter being able to chain infinitely many iterators together, but code similar to this has  worked in previous nightly debug builds. It even works on the nightly-x86_64-uknown-linux-gnu toolchain.\r\n\r\n### Meta\r\n<!--\r\nIf you're using the stable version of the compiler, you should also check if the\r\nbug also exists in the beta or nightly versions.\r\n-->\r\n\r\n`rustc --version --verbose`:\r\n```\r\nrustc 1.64.0-nightly (93ffde6f0 2022-07-23)\r\nbinary: rustc\r\ncommit-hash: 93ffde6f04d3d24327a4e17a2a2bf4f63c246235\r\ncommit-date: 2022-07-23\r\nhost: x86_64-pc-windows-msvc\r\nrelease: 1.64.0-nightly\r\nLLVM version: 14.0.6\r\n```\r\n\r\n<!--\r\nInclude a backtrace in the code block by setting `RUST_BACKTRACE=1` in your\r\nenvironment. E.g. `RUST_BACKTRACE=1 cargo build`.\r\n-->\r\n\r\n<p>\r\n\r\nThis type of hard error is unrecoverable, so I doubt I can generate a backtrace. I have tried without success. \r\n\r\n</p>\r\n\r\n", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/99693/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/99693/timeline", "performed_via_github_app": null, "state_reason": null}