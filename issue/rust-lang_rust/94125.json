{"url": "https://api.github.com/repos/rust-lang/rust/issues/94125", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/94125/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/94125/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/94125/events", "html_url": "https://github.com/rust-lang/rust/issues/94125", "id": 1143533293, "node_id": "I_kwDOAAsO6M5EKO7t", "number": 94125, "title": "Attribute `#[link_section]` can cause type confusion; use should be marked unsafe", "user": {"login": "reinerp", "id": 777239, "node_id": "MDQ6VXNlcjc3NzIzOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/777239?v=4", "gravatar_id": "", "url": "https://api.github.com/users/reinerp", "html_url": "https://github.com/reinerp", "followers_url": "https://api.github.com/users/reinerp/followers", "following_url": "https://api.github.com/users/reinerp/following{/other_user}", "gists_url": "https://api.github.com/users/reinerp/gists{/gist_id}", "starred_url": "https://api.github.com/users/reinerp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/reinerp/subscriptions", "organizations_url": "https://api.github.com/users/reinerp/orgs", "repos_url": "https://api.github.com/users/reinerp/repos", "events_url": "https://api.github.com/users/reinerp/events{/privacy}", "received_events_url": "https://api.github.com/users/reinerp/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-02-18T18:17:37Z", "updated_at": "2022-02-18T21:30:17Z", "closed_at": "2022-02-18T21:30:17Z", "author_association": "NONE", "active_lock_reason": null, "body": "Attribute `#[link_section]` allows code to be placed into named linker sections. Some of these sections have special meanings to the operating system or other parts of the runtime environment. For example, in ELF binaries, objects in section `.init_array.65534` (or any other `.init_array.<N>`) are assumed to be function pointers with a specific signature. These function pointers are executed by the system during program startup.\r\n\r\nIn Rust you can place data of arbitrary type in any link section, in safe code. For example, by placing `0usize` in section `.init_array.65534`, you can create a program that segfaults (execution jumps to a null pointer), entirely in safe code. [Playground link](https://play.rust-lang.org/?version=stable&mode=debug&edition=2021&gist=20c715dda511a535557b0c0bd2fafa7b).\r\n\r\nOne natural response to this is to make use of `#[link_section]` unsafe. For use to be sound, the user of `#[link_section]` must prove that the type of data they are placing in this section is consistent with the environment's type expectations of that section name.\r\n\r\n---\r\n\r\nOther uses of link sections, such as [the linkme crate](https://docs.rs/linkme/latest/linkme/), are subject to the same unsafety: if you define a `#[link_section]` that happens to use the same name as the `linkme` crate uses, you can cause `linkme` to interpret your data as its own type. One variant of this issue is discussed in https://github.com/dtolnay/linkme/issues/3.", "closed_by": {"login": "nagisa", "id": 679122, "node_id": "MDQ6VXNlcjY3OTEyMg==", "avatar_url": "https://avatars.githubusercontent.com/u/679122?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nagisa", "html_url": "https://github.com/nagisa", "followers_url": "https://api.github.com/users/nagisa/followers", "following_url": "https://api.github.com/users/nagisa/following{/other_user}", "gists_url": "https://api.github.com/users/nagisa/gists{/gist_id}", "starred_url": "https://api.github.com/users/nagisa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nagisa/subscriptions", "organizations_url": "https://api.github.com/users/nagisa/orgs", "repos_url": "https://api.github.com/users/nagisa/repos", "events_url": "https://api.github.com/users/nagisa/events{/privacy}", "received_events_url": "https://api.github.com/users/nagisa/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/94125/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/94125/timeline", "performed_via_github_app": null, "state_reason": "completed"}