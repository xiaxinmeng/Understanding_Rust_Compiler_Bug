{"url": "https://api.github.com/repos/rust-lang/rust/issues/71990", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/71990/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/71990/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/71990/events", "html_url": "https://github.com/rust-lang/rust/issues/71990", "id": 614260704, "node_id": "MDU6SXNzdWU2MTQyNjA3MDQ=", "number": 71990, "title": "lint checker wrongly marks private method used in test as dead_code", "user": {"login": "ananthp", "id": 494398, "node_id": "MDQ6VXNlcjQ5NDM5OA==", "avatar_url": "https://avatars.githubusercontent.com/u/494398?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ananthp", "html_url": "https://github.com/ananthp", "followers_url": "https://api.github.com/users/ananthp/followers", "following_url": "https://api.github.com/users/ananthp/following{/other_user}", "gists_url": "https://api.github.com/users/ananthp/gists{/gist_id}", "starred_url": "https://api.github.com/users/ananthp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ananthp/subscriptions", "organizations_url": "https://api.github.com/users/ananthp/orgs", "repos_url": "https://api.github.com/users/ananthp/repos", "events_url": "https://api.github.com/users/ananthp/events{/privacy}", "received_events_url": "https://api.github.com/users/ananthp/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-05-07T18:34:17Z", "updated_at": "2020-05-07T18:38:49Z", "closed_at": "2020-05-07T18:38:49Z", "author_association": "NONE", "active_lock_reason": null, "body": "Consider this code:\r\n\r\n```rust\r\nstruct Foo {\r\n    data: Vec<usize>,\r\n}\r\n\r\nimpl Foo {\r\n    pub fn new() -> Foo {\r\n        Foo {\r\n            data: vec![1, 2, 3],\r\n        }\r\n    }\r\n\r\n    // Warning: dead_code\r\n    fn valuable_insight_only_used_in_test(&self) -> usize {\r\n        self.data.len()\r\n    }\r\n}\r\n\r\n#[cfg(test)]\r\nmod test {\r\n    use super::*;\r\n\r\n    #[test]\r\n    fn makes_exactly_three_numbers_by_default() {\r\n        let foo = Foo::new();\r\n        assert_eq!(3, foo.valuable_insight_only_used_in_test());\r\n    }\r\n}\r\n```\r\n\r\nstruct `Foo` has a private method `valuable_insight_only_used_in_test` that's not referred to in the rest of the struct's implementation, but is used in test. Compiler wrongly issues a `dead_code` lint warning.\r\n\r\n```\r\n...\r\n  = note: `#[warn(dead_code)]` on by default\r\n...\r\nwarning: associated function is never used: `valuable_insight_only_used_in_test`\r\n  --> src/lib.rs:13:5\r\n   |\r\n13 |     fn valuable_insight_only_used_in_test(&self) -> usize {\r\n   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n```\r\n\r\nNote: When this code is run on [Rust Playground](https://play.rust-lang.org/?version=nightly&mode=debug&edition=2018&gist=0b8cb094dbafc172a3bbeb6096c503da), the struct itself gets flagged as dead_code. However, in a real lib only the method triggers the warning.", "closed_by": {"login": "jonas-schievink", "id": 1786438, "node_id": "MDQ6VXNlcjE3ODY0Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/1786438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jonas-schievink", "html_url": "https://github.com/jonas-schievink", "followers_url": "https://api.github.com/users/jonas-schievink/followers", "following_url": "https://api.github.com/users/jonas-schievink/following{/other_user}", "gists_url": "https://api.github.com/users/jonas-schievink/gists{/gist_id}", "starred_url": "https://api.github.com/users/jonas-schievink/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jonas-schievink/subscriptions", "organizations_url": "https://api.github.com/users/jonas-schievink/orgs", "repos_url": "https://api.github.com/users/jonas-schievink/repos", "events_url": "https://api.github.com/users/jonas-schievink/events{/privacy}", "received_events_url": "https://api.github.com/users/jonas-schievink/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/71990/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/71990/timeline", "performed_via_github_app": null, "state_reason": "completed"}