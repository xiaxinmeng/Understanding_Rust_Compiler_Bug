{"url": "https://api.github.com/repos/rust-lang/rust/issues/97625", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/97625/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/97625/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/97625/events", "html_url": "https://github.com/rust-lang/rust/issues/97625", "id": 1256375171, "node_id": "I_kwDOAAsO6M5K4sOD", "number": 97625, "title": "ICE with adt_const_params and instrument-coverage", "user": {"login": "mikialex", "id": 13088597, "node_id": "MDQ6VXNlcjEzMDg4NTk3", "avatar_url": "https://avatars.githubusercontent.com/u/13088597?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mikialex", "html_url": "https://github.com/mikialex", "followers_url": "https://api.github.com/users/mikialex/followers", "following_url": "https://api.github.com/users/mikialex/following{/other_user}", "gists_url": "https://api.github.com/users/mikialex/gists{/gist_id}", "starred_url": "https://api.github.com/users/mikialex/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mikialex/subscriptions", "organizations_url": "https://api.github.com/users/mikialex/orgs", "repos_url": "https://api.github.com/users/mikialex/repos", "events_url": "https://api.github.com/users/mikialex/events{/privacy}", "received_events_url": "https://api.github.com/users/mikialex/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}, {"id": 1615551553, "node_id": "MDU6TGFiZWwxNjE1NTUxNTUz", "url": "https://api.github.com/repos/rust-lang/rust/labels/glacier", "name": "glacier", "color": "a5e2ff", "default": false, "description": "ICE tracked in rust-lang/glacier"}], "state": "closed", "locked": false, "assignee": {"login": "b-naber", "id": 71934879, "node_id": "MDQ6VXNlcjcxOTM0ODc5", "avatar_url": "https://avatars.githubusercontent.com/u/71934879?v=4", "gravatar_id": "", "url": "https://api.github.com/users/b-naber", "html_url": "https://github.com/b-naber", "followers_url": "https://api.github.com/users/b-naber/followers", "following_url": "https://api.github.com/users/b-naber/following{/other_user}", "gists_url": "https://api.github.com/users/b-naber/gists{/gist_id}", "starred_url": "https://api.github.com/users/b-naber/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/b-naber/subscriptions", "organizations_url": "https://api.github.com/users/b-naber/orgs", "repos_url": "https://api.github.com/users/b-naber/repos", "events_url": "https://api.github.com/users/b-naber/events{/privacy}", "received_events_url": "https://api.github.com/users/b-naber/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "b-naber", "id": 71934879, "node_id": "MDQ6VXNlcjcxOTM0ODc5", "avatar_url": "https://avatars.githubusercontent.com/u/71934879?v=4", "gravatar_id": "", "url": "https://api.github.com/users/b-naber", "html_url": "https://github.com/b-naber", "followers_url": "https://api.github.com/users/b-naber/followers", "following_url": "https://api.github.com/users/b-naber/following{/other_user}", "gists_url": "https://api.github.com/users/b-naber/gists{/gist_id}", "starred_url": "https://api.github.com/users/b-naber/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/b-naber/subscriptions", "organizations_url": "https://api.github.com/users/b-naber/orgs", "repos_url": "https://api.github.com/users/b-naber/repos", "events_url": "https://api.github.com/users/b-naber/events{/privacy}", "received_events_url": "https://api.github.com/users/b-naber/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2022-06-01T16:04:28Z", "updated_at": "2022-07-11T16:34:13Z", "closed_at": "2022-07-11T16:34:13Z", "author_association": "NONE", "active_lock_reason": null, "body": "Run the following code with `rustc -Cinstrument-coverage ./test.rs` cause ICE. \n\n### Code\n\n```Rust\n#![feature(adt_const_params)]\n#![allow(incomplete_features)]\n\nfn eval<const N: f32>() -> f32 {\n  N\n}\n\nfn main() {\n  println!(\"{}\", eval::<0.5>());\n}\n\n```\n\n\n### Meta\n`rustc --version --verbose`:\n```\nrustc 1.63.0-nightly (e09449220 2022-05-31)\nbinary: rustc\ncommit-hash: e0944922007e1bb4fe59809293acf4364410cccc\ncommit-date: 2022-05-31\nhost: x86_64-pc-windows-msvc\nrelease: 1.63.0-nightly\nLLVM version: 14.0.4\n```\n\n### Error output\n\n```\nerror: internal compiler error: compiler\\rustc_symbol_mangling\\src\\v0.rs:728:17: symbol_names: unsupported constant of type `f32` (Const { ty: f32, val: Value(Scalar(0x3f000000)) \n})\n\nthread 'rustc' panicked at 'Box<dyn Any>', /rustc/e0944922007e1bb4fe59809293acf4364410cccc\\compiler\\rustc_errors\\src\\lib.rs:1335:9\nstack backtrace:\nnote: Some details are omitted, run with `RUST_BACKTRACE=full` for a verbose backtrace.\n\nnote: the compiler unexpectedly panicked. this is a bug.\n\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/issues/new?labels=C-bug%2C+I-ICE%2C+T-compiler&template=ice.md\n\nnote: rustc 1.63.0-nightly (e09449220 2022-05-31) running on x86_64-pc-windows-msvc\n\nnote: compiler flags: -C instrument-coverage\n\nquery stack during panic:\n#0 [symbol_name] computing the symbol for `eval::<0.5f32>`\n#1 [collect_and_partition_mono_items] collect_and_partition_mono_items\nend of query stack\nerror: aborting due to previous error\n\n```\n\n\n<details><summary><strong>Backtrace</strong></summary>\n<p>\n\n```\n\nthread 'rustc' panicked at 'Box<dyn Any>', /rustc/e0944922007e1bb4fe59809293acf4364410cccc\\compiler\\rustc_errors\\src\\lib.rs:1335:9\nstack backtrace:\n   0:     0x7ffc1e6d9baf - <std::sys_common::backtrace::_print::DisplayBacktrace as core::fmt::Display>::fmt::h29008f0d8360991f\n   1:     0x7ffc1e714baa - core::fmt::write::h8a73e3be4bf01465\n   2:     0x7ffc1e6cbfa9 - <std::io::IoSlice as core::fmt::Debug>::fmt::h5b68e796365090b2\n   3:     0x7ffc1e6dd49b - std::panicking::default_hook::h9a42856a3bf2d779\n   4:     0x7ffc1e6dd11b - std::panicking::default_hook::h9a42856a3bf2d779\n   5:     0x7ffbf6a9dd96 - <rustc_metadata[f47eeeeabaa7db06]::rmeta::encoder::EncodeContext as rustc_serialize[ec78526cf068bb80]::serialize::Encoder>::emit_raw_bytes\n   6:     0x7ffc1e6ddc42 - std::panicking::rust_panic_with_hook::h7fa68a9e3338055f\n   7:     0x7ffbfaf50d25 - <rustc_middle[608b18733af6f849]::ty::closure::BorrowKind as core[1b81ed6b3b69d0c3]::fmt::Debug>::fmt\n   8:     0x7ffbfaf4fb89 - <rustc_middle[608b18733af6f849]::ty::closure::BorrowKind as core[1b81ed6b3b69d0c3]::fmt::Debug>::fmt\n   9:     0x7ffbfb5665c9 - rustc_middle[608b18733af6f849]::util::bug::bug_fmt\n  10:     0x7ffbfb05b9d9 - <rustc_middle[608b18733af6f849]::ty::sty::TypeAndMut as rustc_middle[608b18733af6f849]::ty::context::Lift>::lift_to_tcx\n  11:     0x7ffbfb042383 - <rustc_middle[608b18733af6f849]::ty::sty::TypeAndMut as rustc_middle[608b18733af6f849]::ty::context::Lift>::lift_to_tcx\n  12:     0x7ffbfb0400b2 - <rustc_middle[608b18733af6f849]::ty::sty::TypeAndMut as rustc_middle[608b18733af6f849]::ty::context::Lift>::lift_to_tcx\n  13:     0x7ffbfb0167a9 - <rustc_middle[608b18733af6f849]::ty::consts::valtree::ValTree>::zst\n  14:     0x7ffbfb01682c - <rustc_middle[608b18733af6f849]::ty::consts::valtree::ValTree>::zst\n  15:     0x7ffbfb565ae8 - rustc_middle[608b18733af6f849]::util::bug::bug_fmt\n  16:     0x7ffbfa4dd74d - <&mut rustc_symbol_mangling[7008d1b4a8560b2c]::v0::SymbolMangler as rustc_middle[608b18733af6f849]::ty::print::Printer>::print_const\n  17:     0x7ffbfa4de006 - <&mut rustc_symbol_mangling[7008d1b4a8560b2c]::v0::SymbolMangler as rustc_middle[608b18733af6f849]::ty::print::Printer>::path_qualified\n  18:     0x7ffbfa4d8c31 - <&mut rustc_symbol_mangling[7008d1b4a8560b2c]::v0::SymbolMangler as rustc_middle[608b18733af6f849]::ty::print::Printer>::print_def_path\n  19:     0x7ffbfa4d6fa9 - rustc_symbol_mangling[7008d1b4a8560b2c]::typeid_for_fnabi\n  20:     0x7ffbfa4d5d3d - rustc_symbol_mangling[7008d1b4a8560b2c]::provide\n  21:     0x7ffbfa2ade22 - <&[rustc_middle[608b18733af6f849]::thir::abstract_const::Node] as rustc_serialize[ec78526cf068bb80]::serialize::Decodable<rustc_query_impl[300e2971295ed741]::on_disk_cache::CacheDecoder>>::decode\n  22:     0x7ffbf9f5d375 - <rustc_query_impl[300e2971295ed741]::Queries as rustc_middle[608b18733af6f849]::ty::query::QueryEngine>::try_mark_green\n  23:     0x7ffbfb020c4e - <rustc_middle[608b18733af6f849]::mir::mono::MonoItem>::symbol_name\n  24:     0x7ffbf8ff606e - <rustc_monomorphize[b3a1078a39399015]::partitioning::MonoItemPlacement as core[1b81ed6b3b69d0c3]::fmt::Debug>::fmt\n  25:     0x7ffbf8fe606f - <rustc_monomorphize[b3a1078a39399015]::collector::MirNeighborCollector as rustc_middle[608b18733af6f849]::mir::visit::Visitor>::visit_operand\n  26:     0x7ffbf8fcd54b - <tracing_subscriber[86062e48cce79c6b]::util::TryInitError as core[1b81ed6b3b69d0c3]::fmt::Debug>::fmt\n  27:     0x7ffbf8fed13c - <rustc_monomorphize[b3a1078a39399015]::partitioning::MonoItemPlacement as core[1b81ed6b3b69d0c3]::fmt::Debug>::fmt\n  28:     0x7ffbf8fe65c0 - <rustc_monomorphize[b3a1078a39399015]::collector::MirNeighborCollector as rustc_middle[608b18733af6f849]::mir::visit::Visitor>::visit_operand\n  29:     0x7ffbfa24e489 - <&[rustc_middle[608b18733af6f849]::thir::abstract_const::Node] as rustc_serialize[ec78526cf068bb80]::serialize::Decodable<rustc_query_impl[300e2971295ed741]::on_disk_cache::CacheDecoder>>::decode\n  30:     0x7ffbfa2f3427 - <&[rustc_middle[608b18733af6f849]::thir::abstract_const::Node] as rustc_serialize[ec78526cf068bb80]::serialize::Decodable<rustc_query_impl[300e2971295ed741]::on_disk_cache::CacheDecoder>>::decode\n  31:     0x7ffbf9f5dfd1 - <rustc_query_impl[300e2971295ed741]::Queries as rustc_middle[608b18733af6f849]::ty::query::QueryEngine>::try_mark_green\n  32:     0x7ffbf6cbcff5 - <rustc_codegen_llvm[dab98a06ece5d8b2]::back::lto::ThinData as core[1b81ed6b3b69d0c3]::ops::drop::Drop>::drop\n  33:     0x7ffbf6c582c5 - <rustc_codegen_llvm[dab98a06ece5d8b2]::LlvmCodegenBackend as rustc_codegen_ssa[cc51a84129a2d87c]::traits::backend::CodegenBackend>::codegen_crate       \n  34:     0x7ffbf6b9a272 - <rustc_interface[713bcfa795747777]::queries::Linker>::link\n  35:     0x7ffbf6b9497e - <rustc_interface[713bcfa795747777]::queries::Queries>::ongoing_codegen\n  36:     0x7ffbf6a34ee4 - <&mut core[1b81ed6b3b69d0c3]::fmt::Formatter as serde[9162d223e4f5d80a]::ser::Serializer>::serialize_struct_variant\n  37:     0x7ffbf6ab0ca5 - rustc_driver[5ae0ad532d132115]::pretty::print_after_hir_lowering\n  38:     0x7ffbf6a549a0 - <&mut core[1b81ed6b3b69d0c3]::fmt::Formatter as serde[9162d223e4f5d80a]::ser::Serializer>::serialize_struct_variant\n  39:     0x7ffbf6a2dd27 - <&mut core[1b81ed6b3b69d0c3]::fmt::Formatter as serde[9162d223e4f5d80a]::ser::Serializer>::serialize_struct_variant\n  40:     0x7ffbf6a9aae6 - <rustc_metadata[f47eeeeabaa7db06]::rmeta::encoder::EncodeContext as rustc_serialize[ec78526cf068bb80]::serialize::Encoder>::emit_raw_bytes\n  41:     0x7ffbf6a5d778 - <rustc_driver[5ae0ad532d132115]::args::Error as core[1b81ed6b3b69d0c3]::fmt::Debug>::fmt\n  42:     0x7ffc1e6eedec - std::sys::windows::thread::Thread::new::h87bd3fa2cc7c7644\n  43:     0x7ffc96367034 - BaseThreadInitThunk\n  44:     0x7ffc97ba2651 - RtlUserThreadStart\n```\n\n</p>\n</details>\n\n\n\n<!-- TRIAGEBOT_START -->\n\n<!-- TRIAGEBOT_ASSIGN_START -->\n\n<!-- TRIAGEBOT_ASSIGN_DATA_START$${\"user\":\"b-naber\"}$$TRIAGEBOT_ASSIGN_DATA_END -->\n\n<!-- TRIAGEBOT_ASSIGN_END -->\n<!-- TRIAGEBOT_END -->", "closed_by": {"login": "tmiasko", "id": 51362316, "node_id": "MDQ6VXNlcjUxMzYyMzE2", "avatar_url": "https://avatars.githubusercontent.com/u/51362316?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tmiasko", "html_url": "https://github.com/tmiasko", "followers_url": "https://api.github.com/users/tmiasko/followers", "following_url": "https://api.github.com/users/tmiasko/following{/other_user}", "gists_url": "https://api.github.com/users/tmiasko/gists{/gist_id}", "starred_url": "https://api.github.com/users/tmiasko/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tmiasko/subscriptions", "organizations_url": "https://api.github.com/users/tmiasko/orgs", "repos_url": "https://api.github.com/users/tmiasko/repos", "events_url": "https://api.github.com/users/tmiasko/events{/privacy}", "received_events_url": "https://api.github.com/users/tmiasko/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/97625/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/97625/timeline", "performed_via_github_app": null, "state_reason": "not_planned"}