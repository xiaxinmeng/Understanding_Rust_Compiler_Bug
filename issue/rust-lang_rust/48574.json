{"url": "https://api.github.com/repos/rust-lang/rust/issues/48574", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/48574/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/48574/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/48574/events", "html_url": "https://github.com/rust-lang/rust/issues/48574", "id": 300513466, "node_id": "MDU6SXNzdWUzMDA1MTM0NjY=", "number": 48574, "title": "Rust errors (rust-terminfo) lack color on FreeBSD", "user": {"login": "bdrewery", "id": 33693, "node_id": "MDQ6VXNlcjMzNjkz", "avatar_url": "https://avatars.githubusercontent.com/u/33693?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bdrewery", "html_url": "https://github.com/bdrewery", "followers_url": "https://api.github.com/users/bdrewery/followers", "following_url": "https://api.github.com/users/bdrewery/following{/other_user}", "gists_url": "https://api.github.com/users/bdrewery/gists{/gist_id}", "starred_url": "https://api.github.com/users/bdrewery/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bdrewery/subscriptions", "organizations_url": "https://api.github.com/users/bdrewery/orgs", "repos_url": "https://api.github.com/users/bdrewery/repos", "events_url": "https://api.github.com/users/bdrewery/events{/privacy}", "received_events_url": "https://api.github.com/users/bdrewery/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 234902, "node_id": "MDU6TGFiZWwyMzQ5MDI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-enhancement", "name": "C-enhancement", "color": "f5f1fd", "default": false, "description": "Category: An issue proposing an enhancement or a PR with one."}, {"id": 311417404, "node_id": "MDU6TGFiZWwzMTE0MTc0MDQ=", "url": "https://api.github.com/repos/rust-lang/rust/labels/O-freebsd", "name": "O-freebsd", "color": "6e6ec0", "default": false, "description": "Operating system: FreeBSD"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-02-27T06:55:02Z", "updated_at": "2018-03-19T22:26:11Z", "closed_at": "2018-03-19T22:26:11Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "FreeBSD only provides a /etc/termcap file, not any of the terminfo directory structures searched for in https://github.com/rust-lang/rust/blob/master/src/libterm/terminfo/searcher.rs. The parser would need to learn to read the plaintext hashed file format of /etc/termcap rather than the terminfo binary read it does at https://github.com/rust-lang/rust/blob/master/src/libterm/terminfo/parser/compiled.rs#L188.\r\n\r\nInstalling the _devel/ncurses_ port does not fix this directly since it is compiled to generate a _/usr/local/share/misc/terminfo.db_ file rather than the directory structure expected at _/usr/share/misc/terminfo_.  rust-terminfo lacks support for both the `terminfo.db` format and the _/usr/local_ path.  Not that those should be fixed.\r\n\r\nA workaround is to modify its Makefile and change `--with-hashed-db` to `--without-hashed-db`, remove the _terminfo.db_ staging, install, and then symlink the _/usr/local/share_terminfo_ path to _/usr/share/terminfo_.  This is simply a workaround though.  The port should not be a requirement for rust on FreeBSD just for colors.\r\n\r\nI'm exploring installing _/usr/share/terminfo_ on FreeBSD but it may not happen as it's not as trivial as it sounds. There's a `cap_mkdb` tool that is ran when `/etc/termcap` is modified that will need to be expanded to run `tic` (which isn't installed now). But worse is that it's entirely possible to not run `cap_mdb` at all when modifying _/etc/termcap_ so the _/usr/share/terminfo_ directory entries could be wrong. It seems more reliable to just add support for reading _/etc/termcap_ in rust-terminfo.\r\n\r\nFor reference, there was a discussion in FreeBSD a few years ago about why termcap was still being used.  No one really objected and Thomas Dickey of terminfo happened to chime in as well (https://lists.freebsd.org/pipermail/freebsd-arch/2014-February/015081.html).", "closed_by": {"login": "bdrewery", "id": 33693, "node_id": "MDQ6VXNlcjMzNjkz", "avatar_url": "https://avatars.githubusercontent.com/u/33693?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bdrewery", "html_url": "https://github.com/bdrewery", "followers_url": "https://api.github.com/users/bdrewery/followers", "following_url": "https://api.github.com/users/bdrewery/following{/other_user}", "gists_url": "https://api.github.com/users/bdrewery/gists{/gist_id}", "starred_url": "https://api.github.com/users/bdrewery/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bdrewery/subscriptions", "organizations_url": "https://api.github.com/users/bdrewery/orgs", "repos_url": "https://api.github.com/users/bdrewery/repos", "events_url": "https://api.github.com/users/bdrewery/events{/privacy}", "received_events_url": "https://api.github.com/users/bdrewery/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/48574/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/48574/timeline", "performed_via_github_app": null, "state_reason": "completed"}