{"url": "https://api.github.com/repos/rust-lang/rust/issues/52909", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/52909/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/52909/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/52909/events", "html_url": "https://github.com/rust-lang/rust/issues/52909", "id": 346252713, "node_id": "MDU6SXNzdWUzNDYyNTI3MTM=", "number": 52909, "title": "rust-lld errors with duplicate symbol: __rustc_debug_gdb_scripts_section__ for embeded target.", "user": {"login": "jparris", "id": 125183, "node_id": "MDQ6VXNlcjEyNTE4Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/125183?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jparris", "html_url": "https://github.com/jparris", "followers_url": "https://api.github.com/users/jparris/followers", "following_url": "https://api.github.com/users/jparris/following{/other_user}", "gists_url": "https://api.github.com/users/jparris/gists{/gist_id}", "starred_url": "https://api.github.com/users/jparris/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jparris/subscriptions", "organizations_url": "https://api.github.com/users/jparris/orgs", "repos_url": "https://api.github.com/users/jparris/repos", "events_url": "https://api.github.com/users/jparris/events{/privacy}", "received_events_url": "https://api.github.com/users/jparris/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 37547, "node_id": "MDU6TGFiZWwzNzU0Nw==", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-linkage", "name": "A-linkage", "color": "f7e101", "default": false, "description": "Area: linking into static, shared libraries and binaries"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}, {"id": 880020421, "node_id": "MDU6TGFiZWw4ODAwMjA0MjE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/WG-embedded", "name": "WG-embedded", "color": "c2e0c6", "default": false, "description": "Of interest to the embedded Working Group"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2018-07-31T15:58:28Z", "updated_at": "2019-11-09T15:14:37Z", "closed_at": null, "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\n\r\nI'm using `cargo xbuild` to compile & link my code to a embedded target. @phil-opp the maintainer of cargo xbuild believes that this is a rust-ldd [issue](https://github.com/japaric/xargo/issues/218) beginning with the second comment.\r\n\r\nIn short beginning with at least nightly-2018-03-06 I started getting linking error with the signature `\r\nnote: rust-lld: error: duplicate symbol: __rustc_debug_gdb_scripts_section_`\r\n\r\nMy code is currently a private gitlab repo (I'd be happy to add anyone who needs access) but this issue has also been seen with https://github.com/toothbrush7777777/uefi-app-x64. \r\n\r\nI've been working around this by adding the `--release` flag; but I'm at a point where I'd like to add gdb support.\r\n\r\n```\r\nymir:munin$ just build\r\nRUST_TARGET_PATH=`pwd`/arch/x86_64 cargo xbuild --target=x86_64-uefi\r\n   Compiling bootloader v0.1.0 (file:///home/parrisj/src/munin) \r\nerror: linking with `rust-lld` failed: exit code: 1\r\n  |\r\n  = note: \"rust-lld\" \"-flavor\" \"link\" \"/Subsystem:EFI_Application\" \"/Entry:efi_main\" \"/LIBPATH:/home/parrisj/src/munin/target/sysroot/lib/rustlib/x86_64-uefi/lib\" \"/home/parrisj/src/munin/target/x86_64-uefi/debug/deps/bootloader-49ecc39b692d6c5e.16i0u6jlhoj1fwbo.rcgu.o\" \"/home/parrisj/src/munin/target/x86_64-uefi/debug/deps/bootloader-49ecc39b692d6c5e.16u6js6g0l3k1ic6.rcgu.o\" \"/home/parrisj/src/munin/target/x86_64-uefi/debug/deps/bootloader-49ecc39b692d6c5e.170lmw1sqqfe80qo.rcgu.o\" \"/home/parrisj/src/munin/target/x86_64-uefi/debug/deps/bootloader-49ecc39b692d6c5e.1im38lueib99jsk0.rcgu.o\" \"/home/parrisj/src/munin/target/x86_64-uefi/debug/deps/bootloader-49ecc39b692d6c5e.1y16o1qfye96o7m0.rcgu.o\" \"/home/parrisj/src/munin/target/x86_64-uefi/debug/deps/bootloader-49ecc39b692d6c5e.2670nmqs1be3ww7y.rcgu.o\" \"/home/parrisj/src/munin/target/x86_64-uefi/debug/deps/bootloader-49ecc39b692d6c5e.2c1y7jr7pp6yeu55.rcgu.o\" \"/home/parrisj/src/munin/target/x86_64-uefi/debug/deps/bootloader-49ecc39b692d6c5e.2xj8e5u0nv6enw9x.rcgu.o\" \"/home/parrisj/src/munin/target/x86_64-uefi/debug/deps/bootloader-49ecc39b692d6c5e.49a7n47po4ttqjl7.rcgu.o\" \"/home/parrisj/src/munin/target/x86_64-uefi/debug/deps/bootloader-49ecc39b692d6c5e.4xq48u46a1pwiqn7.rcgu.o\" \"/home/parrisj/src/munin/target/x86_64-uefi/debug/deps/bootloader-49ecc39b692d6c5e.81jpvh8cn5k8ng8.rcgu.o\" \"/home/parrisj/src/munin/target/x86_64-uefi/debug/deps/bootloader-49ecc39b692d6c5e.8xzrsc1ux72v29j.rcgu.o\" \"/home/parrisj/src/munin/target/x86_64-uefi/debug/deps/bootloader-49ecc39b692d6c5e.98g0d9x8aw3akpe.rcgu.o\" \"/home/parrisj/src/munin/target/x86_64-uefi/debug/deps/bootloader-49ecc39b692d6c5e.9fcb3syd3ne5k0n.rcgu.o\" \"/home/parrisj/src/munin/target/x86_64-uefi/debug/deps/bootloader-49ecc39b692d6c5e.c6lbtaiefvx3wya.rcgu.o\" \"/OUT:/home/parrisj/src/munin/target/x86_64-uefi/debug/deps/bootloader-49ecc39b692d6c5e.efi\" \"/home/parrisj/src/munin/target/x86_64-uefi/debug/deps/bootloader-49ecc39b692d6c5e.crate.allocator.rcgu.o\" \"/OPT:REF,NOICF\" \"/DEBUG\" \"/LIBPATH:/home/parrisj/src/munin/target/x86_64-uefi/debug/deps\" \"/LIBPATH:/home/parrisj/src/munin/target/debug/deps\" \"/LIBPATH:/home/parrisj/src/munin/target/sysroot/lib/rustlib/x86_64-uefi/lib\" \"/home/parrisj/src/munin/target/x86_64-uefi/debug/deps/liblibuefi-73eea763ee59199f.rlib\" \"/home/parrisj/src/munin/target/x86_64-uefi/debug/deps/libcty-5c786bc06dad6f6a.rlib\" \"/home/parrisj/src/munin/target/x86_64-uefi/debug/deps/libbitflags-5e29547bdbbce63f.rlib\" \"/home/parrisj/src/munin/target/sysroot/lib/rustlib/x86_64-uefi/lib/liballoc-326639068cfe9737.rlib\" \"/home/parrisj/src/munin/target/sysroot/lib/rustlib/x86_64-uefi/lib/libcore-27ea11fcee464c1f.rlib\" \"/home/parrisj/src/munin/target/sysroot/lib/rustlib/x86_64-uefi/lib/libcompiler_builtins-e9fbcd04a1fe51f6.rlib\"\r\n  = note: rust-lld: error: duplicate symbol: __rustc_debug_gdb_scripts_section__ in /home/parrisj/src/munin/target/x86_64-uefi/debug/deps/bootloader-49ecc39b692d6c5e.16i0u6jlhoj1fwbo.rcgu.o and in /home/parrisj/src/munin/target/x86_64-uefi/debug/deps/bootloader-49ecc39b692d6c5e.16u6js6g0l3k1ic6.rcgu.o\r\n          rust-lld: error: duplicate symbol: __rustc_debug_gdb_scripts_section__ in /home/parrisj/src/munin/target/x86_64-uefi/debug/deps/bootloader-49ecc39b692d6c5e.16i0u6jlhoj1fwbo.rcgu.o and in /home/parrisj/src/munin/target/x86_64-uefi/debug/deps/bootloader-49ecc39b692d6c5e.170lmw1sqqfe80qo.rcgu.o\r\n          rust-lld: error: duplicate symbol: __rustc_debug_gdb_scripts_section__ in /home/parrisj/src/munin/target/x86_64-uefi/debug/deps/bootloader-49ecc39b692d6c5e.16i0u6jlhoj1fwbo.rcgu.o and in /home/parrisj/src/munin/target/x86_64-uefi/debug/deps/bootloader-49ecc39b692d6c5e.1im38lueib99jsk0.rcgu.o\r\n          rust-lld: error: duplicate symbol: __rustc_debug_gdb_scripts_section__ in /home/parrisj/src/munin/target/x86_64-uefi/debug/deps/bootloader-49ecc39b692d6c5e.16i0u6jlhoj1fwbo.rcgu.o and in /home/parrisj/src/munin/target/x86_64-uefi/debug/deps/bootloader-49ecc39b692d6c5e.1y16o1qfye96o7m0.rcgu.o\r\n...\r\n```\r\n\r\n# Target Triple\r\n```\r\n{\r\n  \"llvm-target\": \"x86_64-pc-windows-msvc\",\r\n  \"target-endian\": \"little\",\r\n  \"target-pointer-width\": \"64\",\r\n  \"target-c-int-width\": \"32\",\r\n  \"os\": \"uefi\",\r\n  \"arch\": \"x86_64\",\r\n  \"data-layout\": \"e-m:e-i64:64-f80:128-n8:16:32:64-S128\",\r\n  \"linker\": \"rust-lld\",\r\n  \"linker-flavor\": \"lld-link\",\r\n  \"pre-link-args\": {\r\n    \"lld-link\": [\r\n      \"/Subsystem:EFI_Application\",\r\n      \"/Entry:efi_main\"\r\n    ]\r\n  },\r\n  \"panic-strategy\": \"abort\",\r\n  \"default-hidden-visibility\": true,\r\n  \"executables\": true,\r\n  \"exe-suffix\": \".efi\",\r\n  \"is-like-windows\": true\r\n}\r\n```\r\n\r\n# Version Info\r\n```\r\n$ rustc --version\r\nrustc 1.29.0-nightly (54628c8ea 2018-07-30)\r\n$ cargo --version\r\ncargo 1.29.0-nightly (2cd36b4ed 2018-07-25)\r\n```", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/52909/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/52909/timeline", "performed_via_github_app": null, "state_reason": null}