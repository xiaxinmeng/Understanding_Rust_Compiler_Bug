{"url": "https://api.github.com/repos/rust-lang/rust/issues/60909", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/60909/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/60909/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/60909/events", "html_url": "https://github.com/rust-lang/rust/issues/60909", "id": 445352672, "node_id": "MDU6SXNzdWU0NDUzNTI2NzI=", "number": 60909, "title": "Android fails to link in libc-test ", "user": {"login": "gnzlbg", "id": 904614, "node_id": "MDQ6VXNlcjkwNDYxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/904614?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gnzlbg", "html_url": "https://github.com/gnzlbg", "followers_url": "https://api.github.com/users/gnzlbg/followers", "following_url": "https://api.github.com/users/gnzlbg/following{/other_user}", "gists_url": "https://api.github.com/users/gnzlbg/gists{/gist_id}", "starred_url": "https://api.github.com/users/gnzlbg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gnzlbg/subscriptions", "organizations_url": "https://api.github.com/users/gnzlbg/orgs", "repos_url": "https://api.github.com/users/gnzlbg/repos", "events_url": "https://api.github.com/users/gnzlbg/events{/privacy}", "received_events_url": "https://api.github.com/users/gnzlbg/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 37547, "node_id": "MDU6TGFiZWwzNzU0Nw==", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-linkage", "name": "A-linkage", "color": "f7e101", "default": false, "description": "Area: linking into static, shared libraries and binaries"}, {"id": 25141820, "node_id": "MDU6TGFiZWwyNTE0MTgyMA==", "url": "https://api.github.com/repos/rust-lang/rust/labels/O-android", "name": "O-android", "color": "6e6ec0", "default": false, "description": "Operating system: Android"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-05-17T09:35:25Z", "updated_at": "2019-05-17T16:29:15Z", "closed_at": null, "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I was trying to fix and upgrade the Android build jobs in libc, and I've managed to get the x86_64 and i686 ones running, but the arm and aarch64 ones fail to link and I have no idea why (https://github.com/rust-lang/libc/pull/1344). These are the two errors that I get:\r\n\r\n```\r\n= note: /android/ndk-arm/bin/../lib/gcc/arm-linux-androideabi/4.9.x/../../../../arm-linux-androideabi/bin/ld: error: cannot open crtbegin_dynamic.o: No such file or directory\r\n          /android/ndk-arm/bin/../lib/gcc/arm-linux-androideabi/4.9.x/../../../../arm-linux-androideabi/bin/ld: error: cannot open crtend_android.o: No such file or directory\r\n          /android/ndk-arm/bin/../lib/gcc/arm-linux-androideabi/4.9.x/../../../../arm-linux-androideabi/bin/ld: error: cannot find -llog\r\n          external/jemalloc/src/jemalloc.c:1422: error: undefined reference to 'pthread_atfork'\r\n          external/jemalloc/src/jemalloc.c:1422: error: undefined reference to 'pthread_atfork'\r\n          external/jemalloc/src/jemalloc.c:1422: error: undefined reference to 'pthread_atfork'\r\n          external/jemalloc/src/jemalloc.c:1422: error: undefined reference to 'pthread_atfork'\r\n          external/jemalloc/src/jemalloc.c:1358: error: undefined reference to 'atexit'\r\n          clang80: error: linker command failed with exit code 1 (use -v to see invocation)\r\n```\r\n\r\nand\r\n\r\n```\r\ncannot find crtbegin_dynamic.o: No such file or directory\r\n          clang80: error: linker command failed with exit code 1 (use -v to see invocation)\r\n```          \r\n\r\nI initially suspected that this might have something to do with the different API or NDK versions used by rust-lang/rust vs the ones in the PR which are newer, but the part of the test script that fails is the one that has `--no-default-features` in it, which means that `use_std` is disabled, so only `libcore` should be linked, so this shouldn't be an issue.\r\n\r\nThe Android build jobs have been failing for a couple of months already, and we have been adding linux APIs that might have been breaking Android because they are not properly scoped, so getting these up and running again is kind of important for Android support. ", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/60909/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/60909/timeline", "performed_via_github_app": null, "state_reason": null}