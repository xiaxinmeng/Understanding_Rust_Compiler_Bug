{"url": "https://api.github.com/repos/rust-lang/rust/issues/11124", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/11124/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/11124/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/11124/events", "html_url": "https://github.com/rust-lang/rust/issues/11124", "id": 24692509, "node_id": "MDU6SXNzdWUyNDY5MjUwOQ==", "number": 11124, "title": "Linker library order is important", "user": {"login": "vadimcn", "id": 3203809, "node_id": "MDQ6VXNlcjMyMDM4MDk=", "avatar_url": "https://avatars.githubusercontent.com/u/3203809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vadimcn", "html_url": "https://github.com/vadimcn", "followers_url": "https://api.github.com/users/vadimcn/followers", "following_url": "https://api.github.com/users/vadimcn/following{/other_user}", "gists_url": "https://api.github.com/users/vadimcn/gists{/gist_id}", "starred_url": "https://api.github.com/users/vadimcn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vadimcn/subscriptions", "organizations_url": "https://api.github.com/users/vadimcn/orgs", "repos_url": "https://api.github.com/users/vadimcn/repos", "events_url": "https://api.github.com/users/vadimcn/events{/privacy}", "received_events_url": "https://api.github.com/users/vadimcn/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2013-12-23T02:38:06Z", "updated_at": "2014-03-13T06:37:28Z", "closed_at": "2014-03-13T06:37:28Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Let's say I have 3 modules `main.rs`, `a.rs` and `b.rs`, and two external libraries `libfoo.a` and `libbar.a`, and that `libbar` depends on symbols defined in `libfoo`.\n\n**main.rs**\n\n```\nmod a;\nmod b;\nfn main() {}\n```\n\n**a.rs**\n\n```\n#[link(name = \"foo\")]\nextern {}\n```\n\n**b.rs**\n\n```\n#[link(name = \"bar\")]\n#[link(name = \"foo\")]\nextern {}\n```\n\nBecause rustc de-dupes the list of external libraries, it will pass to linker only  `-lfoo -lbar`.   However gnu linker does not look for unresolved symbols in libraries it had already processed, so it will fail to resolve libbar's references to libfoo.  The correct command line would have been `-lfoo -lbar -lfoo`.\n\nRustc should not de-duplicate the list of libraries.  Furthermore, I think it should guarantee that libs will appear in the same order on the linker command line as they did in the source file.\n", "closed_by": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/11124/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/11124/timeline", "performed_via_github_app": null, "state_reason": "completed"}