{"url": "https://api.github.com/repos/rust-lang/rust/issues/23701", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/23701/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/23701/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/23701/events", "html_url": "https://github.com/rust-lang/rust/issues/23701", "id": 64274175, "node_id": "MDU6SXNzdWU2NDI3NDE3NQ==", "number": 23701, "title": "Panic with macro_rules", "user": {"login": "agbaroni", "id": 1510959, "node_id": "MDQ6VXNlcjE1MTA5NTk=", "avatar_url": "https://avatars.githubusercontent.com/u/1510959?v=4", "gravatar_id": "", "url": "https://api.github.com/users/agbaroni", "html_url": "https://github.com/agbaroni", "followers_url": "https://api.github.com/users/agbaroni/followers", "following_url": "https://api.github.com/users/agbaroni/following{/other_user}", "gists_url": "https://api.github.com/users/agbaroni/gists{/gist_id}", "starred_url": "https://api.github.com/users/agbaroni/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/agbaroni/subscriptions", "organizations_url": "https://api.github.com/users/agbaroni/orgs", "repos_url": "https://api.github.com/users/agbaroni/repos", "events_url": "https://api.github.com/users/agbaroni/events{/privacy}", "received_events_url": "https://api.github.com/users/agbaroni/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2015-03-25T13:52:03Z", "updated_at": "2015-03-26T18:04:53Z", "closed_at": "2015-03-26T18:04:53Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "The following snippet:\n\n```\nmacro_rules! getarg {\n    (x => $e:expr) => (println! (\"x = {}\", $e));\n    $b:block => $b;\n}\n\nfn main() {\n    getarg! (x => 1 + 2);\n    getarg! {\n    }\n}\n```\n\ngives the following error:\n\n```\nsrc/main.rs:3:1: 4:2 error: internal compiler error: wrong-structured lhs for follow check (didn't find a TtDelimited or TtSequence)\n```\n\nThis is the backtrace:\n\n```\nstack backtrace:\n   1:        0x104fe5da3 - sys::backtrace::write::h36da3fb1e07e78da0nC\n   2:        0x105013da5 - panicking::on_panic::haade6d6d86433bf5HOL\n   3:        0x104f3d5d8 - rt::unwind::begin_unwind_inner::h00317caea0131299UvL\n   4:        0x1045efb5f - rt::unwind::begin_unwind::h15168281961459128075\n   5:        0x1045efb0c - diagnostic::SpanHandler::span_bug::hbfe227f81d0cd8devYE\n   6:        0x104741719 - ext::base::ExtCtxt<'a>::span_bug::hdb7ec5648176a7f89y7\n   7:        0x104740ed5 - ext::tt::macro_rules::compile::ha9fc6d551176d0ddx5i\n   8:        0x104740265 - ext::base::ExtCtxt<'a>::insert_macro::h91b42296cf30a29dSw7\n   9:        0x1047b49f0 - ext::expand::expand_item_mac::hb9eabd9a17097c78v5d\n  10:        0x1047a0227 - ext::expand::expand_annotatable::hb2c7b6cf1688383b0ze\n  11:        0x10479c230 - ext::expand::expand_item::h82a19f3ce454f84daZd\n  12:        0x1047ab7a2 - ext::expand::MacroExpander<'a, 'b>.Folder::fold_item::h7f85720548281771dSe\n  13:        0x1047ab578 - fold::noop_fold_mod::closure.58932\n  14:        0x1047ab316 - iter::FlatMap<I, U, F>.Iterator::next::h10055531995118448306\n  15:        0x1047aaf60 - vec::Vec<T>.FromIterator<T>::from_iter::h8228182012818297599\n  16:        0x1047aab9f - fold::noop_fold_mod::h3115526397988167409\n  17:        0x1047a6a7c - ext::expand::expand_item_underscore::h52c4b03ceb86d01b02d\n  18:        0x10480f552 - fold::Folder::fold_item_simple::h4379758381320372925\n  19:        0x10480ecd3 - ptr::P<T>::map::h1390305908052494351\n  20:        0x1047a1b95 - ext::expand::expand_annotatable::hb2c7b6cf1688383b0ze\n  21:        0x10479c230 - ext::expand::expand_item::h82a19f3ce454f84daZd\n  22:        0x1047ab7a2 - ext::expand::MacroExpander<'a, 'b>.Folder::fold_item::h7f85720548281771dSe\n  23:        0x10481be94 - ext::expand::expand_crate::h8ce8d9aec4e20430IYe\n  24:        0x1016c70d4 - driver::phase_2_configure_and_expand::closure.20378\n  25:        0x10167a90b - driver::phase_2_configure_and_expand::h7df30fbfe33501e73ta\n  26:        0x10166a436 - driver::compile_input::h1408964d65bdd4c4Gba\n  27:        0x101743bf7 - run_compiler::hc234a0e393bd73edZbc\n  28:        0x101741071 - thunk::F.Invoke<A, R>::invoke::h15756873051927943851\n  29:        0x10173fcd0 - rt::unwind::try::try_fn::h4998921728403241693\n  30:        0x10508ae09 - rust_try_inner\n  31:        0x10508adf6 - rust_try\n  32:        0x101740435 - thunk::F.Invoke<A, R>::invoke::h14944404643238507248\n  33:        0x104ffcc83 - sys::thread::thread_start::h384864084e567330e4G\n  34:     0x7fff8e031268 - _pthread_body\n  35:     0x7fff8e0311e5 - _pthread_body\n```\n", "closed_by": {"login": "jdm", "id": 27658, "node_id": "MDQ6VXNlcjI3NjU4", "avatar_url": "https://avatars.githubusercontent.com/u/27658?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jdm", "html_url": "https://github.com/jdm", "followers_url": "https://api.github.com/users/jdm/followers", "following_url": "https://api.github.com/users/jdm/following{/other_user}", "gists_url": "https://api.github.com/users/jdm/gists{/gist_id}", "starred_url": "https://api.github.com/users/jdm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jdm/subscriptions", "organizations_url": "https://api.github.com/users/jdm/orgs", "repos_url": "https://api.github.com/users/jdm/repos", "events_url": "https://api.github.com/users/jdm/events{/privacy}", "received_events_url": "https://api.github.com/users/jdm/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/23701/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/23701/timeline", "performed_via_github_app": null, "state_reason": "completed"}