{"url": "https://api.github.com/repos/rust-lang/rust/issues/30318", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/30318/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/30318/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/30318/events", "html_url": "https://github.com/rust-lang/rust/issues/30318", "id": 121638089, "node_id": "MDU6SXNzdWUxMjE2MzgwODk=", "number": 30318, "title": "Non helpful error message when documenting with inner comment", "user": {"login": "est31", "id": 8872119, "node_id": "MDQ6VXNlcjg4NzIxMTk=", "avatar_url": "https://avatars.githubusercontent.com/u/8872119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/est31", "html_url": "https://github.com/est31", "followers_url": "https://api.github.com/users/est31/followers", "following_url": "https://api.github.com/users/est31/following{/other_user}", "gists_url": "https://api.github.com/users/est31/gists{/gist_id}", "starred_url": "https://api.github.com/users/est31/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/est31/subscriptions", "organizations_url": "https://api.github.com/users/est31/orgs", "repos_url": "https://api.github.com/users/est31/repos", "events_url": "https://api.github.com/users/est31/events{/privacy}", "received_events_url": "https://api.github.com/users/est31/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 235791, "node_id": "MDU6TGFiZWwyMzU3OTE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-diagnostics", "name": "A-diagnostics", "color": "f7e101", "default": false, "description": "Area: Messages for errors, warnings, and lints"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2015-12-11T05:02:13Z", "updated_at": "2016-05-07T12:11:01Z", "closed_at": "2016-05-07T12:11:01Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "This piece of code fails compilation ([playbot](https://play.rust-lang.org/?gist=4f531198754a2de8034b&version=stable)):\n\n``` rust\nuse std::io;\n\n//! This is a crate to say hello to the world\n\n/// Main entry function\nfn main() {\n    println!(\"Hello, world!\");\n}\n```\n\nThis is because the compiler expects inner comments only before the first item (something like [this](https://play.rust-lang.org/?gist=c1d3c967e2aa23c1df16&version=stable)). It doesn't point this out however, instead, it gives the rather cryptic error message:\n\n```\n<anon>:3:1: 3:46 error: expected outer comment\n<anon>:3 //! This is a crate to say hello to the world\n         ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n```\n\nIt should say something like \"Please place the inner comment to the top\".\n\nFrom reading the code, an error message like [this](https://github.com/rust-lang/rust/blob/b7fbfb658e0e3e3be37c5b6704fd6b4d5991ae8c/src/libsyntax/parse/attr.rs#L67-L71) would be sufficient.\n\nCan that be achieved by changing the if near line 38: \n\n``` rust\n                if attr.node.style != ast::AttrStyle::Outer {\n                  return Err(self.fatal(\"expected outer comment\"));\n                }\n```\n\nto something like\n\n``` rust\n                match attr.node.style {\n                  ast::AttrStyle::Inner => return Err(self.fatal(\"Expected outer comment. Inner comments are only allowed at the top, before any item.\")),\n                  ast::AttrStyle::Outer => (),\n                  _ => return Err(self.fatal(\"expected outer comment\")),\n                }\n```\n\n? I haven't tested because I haven't set up a development setup of rustc (and don't know whether there is a better way to do it).\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/30318/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/30318/timeline", "performed_via_github_app": null, "state_reason": "completed"}