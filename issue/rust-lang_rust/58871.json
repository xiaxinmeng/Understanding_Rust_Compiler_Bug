{"url": "https://api.github.com/repos/rust-lang/rust/issues/58871", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/58871/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/58871/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/58871/events", "html_url": "https://github.com/rust-lang/rust/issues/58871", "id": 416390347, "node_id": "MDU6SXNzdWU0MTYzOTAzNDc=", "number": 58871, "title": "rustc segmentation fault", "user": {"login": "WolfBookyr", "id": 23342899, "node_id": "MDQ6VXNlcjIzMzQyODk5", "avatar_url": "https://avatars.githubusercontent.com/u/23342899?v=4", "gravatar_id": "", "url": "https://api.github.com/users/WolfBookyr", "html_url": "https://github.com/WolfBookyr", "followers_url": "https://api.github.com/users/WolfBookyr/followers", "following_url": "https://api.github.com/users/WolfBookyr/following{/other_user}", "gists_url": "https://api.github.com/users/WolfBookyr/gists{/gist_id}", "starred_url": "https://api.github.com/users/WolfBookyr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/WolfBookyr/subscriptions", "organizations_url": "https://api.github.com/users/WolfBookyr/orgs", "repos_url": "https://api.github.com/users/WolfBookyr/repos", "events_url": "https://api.github.com/users/WolfBookyr/events{/privacy}", "received_events_url": "https://api.github.com/users/WolfBookyr/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 100522, "node_id": "MDU6TGFiZWwxMDA1MjI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-crash", "name": "I-crash", "color": "e10c02", "default": false, "description": "Issue: The compiler crashes (SIGSEGV, SIGABRT, etc). Use I-ICE instead when the compiler panics."}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-03-02T12:02:25Z", "updated_at": "2019-03-02T14:26:30Z", "closed_at": "2019-03-02T14:26:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "I installed rust with `curl https://sh.rustup.rs -sSf | sh`. Everything installed correctly except for rustc: `stable installed - (error reading rustc version)`. Cargo and rustup work perfectly fine (except where they use rustc).\r\n\r\nCalling `cargo run` gets stuck with no output and doesn't exit.\r\n\r\nCalling `rustc --version` outputs:\r\n`Segmentation fault (core dumped)`\r\n\r\nSystem info:\r\n```\r\n$ rustup which rustc\r\n/home/user/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/bin/rustc\r\n\r\n$ cat /etc/*-release\r\nDISTRIB_ID=LinuxMint\r\nDISTRIB_RELEASE=19.1\r\nDISTRIB_CODENAME=tessa\r\nDISTRIB_DESCRIPTION=\"Linux Mint 19.1 Tessa\"\r\nNAME=\"Linux Mint\"\r\nVERSION=\"19.1 (Tessa)\"\r\nID=linuxmint\r\nID_LIKE=ubuntu\r\nPRETTY_NAME=\"Linux Mint 19.1\"\r\nVERSION_ID=\"19.1\"\r\nHOME_URL=\"https://www.linuxmint.com/\"\r\nSUPPORT_URL=\"https://forums.ubuntu.com/\"\r\nBUG_REPORT_URL=\"http://linuxmint-troubleshooting-guide.readthedocs.io/en/latest/\"\r\nPRIVACY_POLICY_URL=\"https://www.linuxmint.com/\"\r\nVERSION_CODENAME=tessa\r\nUBUNTU_CODENAME=bionic\r\ncat: /etc/upstream-release: Is a directory\r\n\r\n$ uname --all\r\nLinux XXXX 4.15.0-45-generic #48-Ubuntu SMP Tue Jan 29 16:28:13 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux\r\n\r\n$ lscpu\r\nArchitecture:        x86_64\r\nCPU op-mode(s):      32-bit, 64-bit\r\nByte Order:          Little Endian\r\nCPU(s):              12\r\nOn-line CPU(s) list: 0-11\r\nThread(s) per core:  2\r\nCore(s) per socket:  6\r\nSocket(s):           1\r\nNUMA node(s):        1\r\nVendor ID:           GenuineIntel\r\nCPU family:          6\r\nModel:               158\r\nModel name:          Intel(R) Core(TM) i7-8700K CPU @ 3.70GHz\r\nStepping:            10\r\nCPU MHz:             880.326\r\nCPU max MHz:         4800.0000\r\nCPU min MHz:         800.0000\r\nBogoMIPS:            7392.00\r\nVirtualisation:      VT-x\r\nL1d cache:           32K\r\nL1i cache:           32K\r\nL2 cache:            256K\r\nL3 cache:            12288K\r\nNUMA node0 CPU(s):   0-11\r\nFlags:               fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf tsc_known_freq pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault invpcid_single pti ssbd ibrs ibpb stibp tpr_shadow vnmi flexpriority ept vpid fsgsbase tsc_adjust bmi1 hle avx2 smep bmi2 erms invpcid rtm mpx rdseed adx smap clflushopt intel_pt xsaveopt xsavec xgetbv1 xsaves dtherm ida arat pln pts hwp hwp_notify hwp_act_window hwp_epp flush_l1d\r\n```\r\n\r\nUsing gdb:\r\n```\r\ngdb -quiet --args rustc --version\r\nReading symbols from rustc...done.\r\n(gdb) run\r\nStarting program: /home/user/.cargo/bin/rustc --version\r\n[Thread debugging using libthread_db enabled]\r\nUsing host libthread_db library \"/lib/x86_64-linux-gnu/libthread_db.so.1\".\r\nprocess 9374 is executing new program: /home/user/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/bin/rustc\r\n[Thread debugging using libthread_db enabled]\r\nUsing host libthread_db library \"/lib/x86_64-linux-gnu/libthread_db.so.1\".\r\n\r\nProgram received signal SIGSEGV, Segmentation fault.\r\n0x0000000000000000 in ?? ()\r\n\r\n(gdb) bt\r\n#0  0x0000000000000000 in ?? ()\r\n#1  0x00007ffff7e8957c in ?? () from /usr/lib/x86_64-linux-gnu/libesets_pac.so\r\n#2  0x00007ffff7e896a0 in fcntl ()\r\n   from /usr/lib/x86_64-linux-gnu/libesets_pac.so\r\n#3  0x0000555555585656 in os_overcommits_proc ()\r\n    at /rustc/2aa4c46cfdd726e97360c2734835aa3515e8c858/obj/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/release/build/jemalloc-sys-539c8a7040e7c5bc/out/jemalloc/src/pages.c:447\r\n#4  _rjem_je_pages_boot ()\r\n    at /rustc/2aa4c46cfdd726e97360c2734835aa3515e8c858/obj/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/release/build/jemalloc-sys-539c8a7040e7c5bc/out/jemalloc/src/pages.c:579\r\n#5  0x0000555555561911 in malloc_init_hard_a0_locked ()\r\n    at /rustc/2aa4c46cfdd726e97360c2734835aa3515e8c858/obj/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/release/build/jemalloc-sys-539c8a7040e7c5bc/out/jemalloc/src/jemalloc.c:1291\r\n#6  0x000055555555c258 in malloc_init_hard ()\r\n    at /rustc/2aa4c46cfdd726e97360c2734835aa3515e8c858/obj/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/release/build/jemalloc-sys-539c8a7040e7c5bc/out/jemalloc/src/jemalloc.c:1517\r\n#7  malloc_init ()\r\n    at /rustc/2aa4c46cfdd726e97360c2734835aa3515e8c858/obj/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/release/build/jemalloc-sys-539c8a7040e7c5bc/out/jemalloc/src/jemalloc.c:217\r\n#8  imalloc (sopts=<optimised out>, dopts=<optimised out>)\r\n    at /rustc/2aa4c46cfdd726e97360c2734835aa3515e8c858/obj/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/release/build/jemalloc-sys-539c8a7040e7c5bc/out/jemalloc/src/jemalloc.c:1986\r\n#9  calloc (num=num@entry=1, size=size@entry=32)\r\n    at /rustc/2aa4c46cfdd726e97360c2734835aa3515e8c858/obj/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/release/build/jemalloc-sys-539c8a7040e7c5bc/out/jemalloc/src/jemalloc.c:2138\r\n#10 0x00007ffff72677e5 in _dlerror_run (\r\n    operate=operate@entry=0x7ffff72670d0 <dlsym_doit>, \r\n    args=args@entry=0x7fffffffdcf0) at dlerror.c:140\r\n#11 0x00007ffff7267166 in __dlsym (handle=<optimised out>, \r\n    name=0x7ffff7eb3297 \"open\") at dlsym.c:70\r\n#12 0x00007ffff7e867c9 in ?? () from /usr/lib/x86_64-linux-gnu/libesets_pac.so\r\n#13 0x00007ffff7e87aa7 in ?? () from /usr/lib/x86_64-linux-gnu/libesets_pac.so\r\n#14 0x00007ffff7eb3256 in ?? () from /usr/lib/x86_64-linux-gnu/libesets_pac.so\r\n#15 0x0000000000000002 in ?? ()\r\n#16 0x0000000000000001 in ?? ()\r\n#17 0x0000000000000002 in ?? ()\r\n#18 0x00007ffff7e8589b in ?? () from /usr/lib/x86_64-linux-gnu/libesets_pac.so\r\n#19 0x0000000000000002 in ?? ()\r\n#20 0x00007ffff7de56ec in call_init (env=0x7fffffffde30, argv=0x7fffffffde18,env=0x7fffffffde30) at dl-init.c:119\r\n#22 0x00007ffff7dd60ca in _dl_start_user () from /lib64/ld-linux-x86-64.so.2\r\n#23 0x0000000000000002 in ?? ()\r\n#24 0x00007fffffffe16b in ?? ()\r\n#25 0x00007fffffffe1b4 in ?? ()\r\n#26 0x0000000000000000 in ?? ()\r\n```\r\n\r\nUnlike this issue https://github.com/rust-lang/rust/issues/52772 `strace` does not fix it. \r\n\r\nIs there a way to fix this? Is there any more info you would need to help identify the cause of this?", "closed_by": {"login": "WolfBookyr", "id": 23342899, "node_id": "MDQ6VXNlcjIzMzQyODk5", "avatar_url": "https://avatars.githubusercontent.com/u/23342899?v=4", "gravatar_id": "", "url": "https://api.github.com/users/WolfBookyr", "html_url": "https://github.com/WolfBookyr", "followers_url": "https://api.github.com/users/WolfBookyr/followers", "following_url": "https://api.github.com/users/WolfBookyr/following{/other_user}", "gists_url": "https://api.github.com/users/WolfBookyr/gists{/gist_id}", "starred_url": "https://api.github.com/users/WolfBookyr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/WolfBookyr/subscriptions", "organizations_url": "https://api.github.com/users/WolfBookyr/orgs", "repos_url": "https://api.github.com/users/WolfBookyr/repos", "events_url": "https://api.github.com/users/WolfBookyr/events{/privacy}", "received_events_url": "https://api.github.com/users/WolfBookyr/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/58871/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/58871/timeline", "performed_via_github_app": null, "state_reason": "completed"}