{"url": "https://api.github.com/repos/rust-lang/rust/issues/38651", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/38651/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/38651/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/38651/events", "html_url": "https://github.com/rust-lang/rust/issues/38651", "id": 197860258, "node_id": "MDU6SXNzdWUxOTc4NjAyNTg=", "number": 38651, "title": "Compiler error: No def'n found for DefId", "user": {"login": "thirtythreeforty", "id": 3952613, "node_id": "MDQ6VXNlcjM5NTI2MTM=", "avatar_url": "https://avatars.githubusercontent.com/u/3952613?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thirtythreeforty", "html_url": "https://github.com/thirtythreeforty", "followers_url": "https://api.github.com/users/thirtythreeforty/followers", "following_url": "https://api.github.com/users/thirtythreeforty/following{/other_user}", "gists_url": "https://api.github.com/users/thirtythreeforty/gists{/gist_id}", "starred_url": "https://api.github.com/users/thirtythreeforty/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thirtythreeforty/subscriptions", "organizations_url": "https://api.github.com/users/thirtythreeforty/orgs", "repos_url": "https://api.github.com/users/thirtythreeforty/repos", "events_url": "https://api.github.com/users/thirtythreeforty/events{/privacy}", "received_events_url": "https://api.github.com/users/thirtythreeforty/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2016-12-28T14:19:05Z", "updated_at": "2017-02-24T19:20:37Z", "closed_at": "2017-02-24T19:20:37Z", "author_association": "NONE", "active_lock_reason": null, "body": "The following code ([Playground link](https://is.gd/VeDxzS)) produces an ICE on Rust 1.14.0 on Arch Linux x86_64.\r\n\r\n```rust\r\npub trait AnyFilter {\r\n    type Item;\r\n    fn any_filter<F>(self, filters: &[F]) -> AnyFilterImpl<F, Self>\r\n        where F: FnMut(&Self::Item) -> bool,\r\n        Self: Iterator;\r\n}\r\n\r\nimpl<I: Iterator> AnyFilter for I {\r\n    type Item = I::Item;\r\n\r\n    fn any_filter<F>(self, filters: &[F]) -> AnyFilterImpl<F, Self>\r\n        where F: FnMut(&Self::Item) -> bool\r\n    {\r\n        AnyFilterImpl { filters: filters, source: self }\r\n    }\r\n}\r\n\r\n#[derive(Clone)]\r\npub struct AnyFilterImpl<F, I>\r\n    where F: FnMut(&I::Item) -> bool,\r\n    I: Iterator\r\n{\r\n    filters: Vec<F>,\r\n    source: I\r\n}\r\n\r\nimpl<F, I> Iterator for AnyFilterImpl<F, I>\r\n    where F: FnMut(&I::Item) -> bool,\r\n    I: Iterator\r\n{\r\n    type Item = I::Item;\r\n\r\n    fn next(&mut self) -> Option<Self::Item> where Self: Sized {\r\n        self.source.by_ref().next().and_then(|val| {\r\n            for filter in self.filters {\r\n                if filter(val) {\r\n                    return Some(val);\r\n                }\r\n            }\r\n            None\r\n        })\r\n    }\r\n}\r\n\r\nfn main() {\r\n}\r\n```\r\n\r\nThe error is:\r\n\r\n```\r\nerror: internal compiler error: src/librustc/ty/mod.rs:2083: No def'n found for DefId { krate: CrateNum(0), node: DefIndex(52) => typo/f4c2e3f433cba122302729faf5a796d0-exe::any_filter[0]::AnyFilter[0] } in tcx.impl_or_trait_items\r\n```\r\n\r\nBacktrace:\r\n```\r\nthread 'rustc' panicked at 'Box<Any>', src/librustc_errors/lib.rs:424\r\nstack backtrace:\r\n   1:     0x7f7b9331efba - std::sys::imp::backtrace::tracing::imp::write::h917062bce4ff48c3\r\n                        at /build/rust/src/rustc-1.14.0/src/libstd/sys/unix/backtrace/tracing/gcc_s.rs:42\r\n   2:     0x7f7b9333124f - std::panicking::default_hook::{{closure}}::h0bacac31b5ed1870\r\n                        at /build/rust/src/rustc-1.14.0/src/libstd/panicking.rs:247\r\n   3:     0x7f7b9332da95 - std::panicking::default_hook::h5897799da33ece67\r\n                        at /build/rust/src/rustc-1.14.0/src/libstd/panicking.rs:257\r\n   4:     0x7f7b9332e1b7 - std::panicking::rust_panic_with_hook::h109e116a3a861224\r\n                        at /build/rust/src/rustc-1.14.0/src/libstd/panicking.rs:451\r\n   5:     0x7f7b8f78af9a - std::panicking::begin_panic::h7ee1a5d23402297a\r\n                        at /build/rust/src/rustc-1.14.0/src/libstd/panicking.rs:413\r\n   6:     0x7f7b8f79c27d - rustc_errors::Handler::bug::hcb152875f06770ca\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc_errors/lib.rs:424\r\n   7:     0x7f7b907e6851 - rustc::session::opt_span_bug_fmt::{{closure}}::hac6e8f2df662620f\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc/session/mod.rs:770\r\n   8:     0x7f7b9071f21e - rustc::session::opt_span_bug_fmt::he7e61f6adc55e29d\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc/ty/context.rs:1057\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc/session/mod.rs:766\r\n   9:     0x7f7b9071ee82 - rustc::session::bug_fmt::h995c6792d8929834\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc/session/mod.rs:750\r\n  10:     0x7f7b907a13e5 - rustc::ty::<impl rustc::ty::context::TyCtxt<'a, 'gcx, 'tcx>>::impl_or_trait_items::hccd3536ffe440893\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc/ty/mod.rs:2083\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc/dep_graph/dep_tracking_map.rs:145\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc/ty/mod.rs:2081\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc/ty/mod.rs:2254\r\n  11:     0x7f7b92c05727 - <core::iter::Map<I, F> as core::iter_private::TrustedRandomAccess>::get_unchecked::h29aea1fc2836b633\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc_typeck/astconv.rs:1263\r\n                        at /build/rust/src/rustc-1.14.0/src/libcore/iter/mod.rs:1027\r\n  12:     0x7f7b92c9a8d0 - <rustc_typeck::astconv::AstConv<'gcx, 'tcx> + 'o>::one_bound_for_assoc_type::hc8dd689db5184164\r\n                        at /build/rust/src/rustc-1.14.0/src/libcore/iter/mod.rs:828\r\n                        at /build/rust/src/rustc-1.14.0/src/libcore/iter/mod.rs:712\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc_typeck/astconv.rs:1281\r\n  13:     0x7f7b92c9a30f - <rustc_typeck::astconv::AstConv<'gcx, 'tcx> + 'o>::find_bound_for_assoc_item::he8bb900cda55902b\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc_typeck/astconv.rs:1235\r\n  14:     0x7f7b92c9bc51 - <rustc_typeck::astconv::AstConv<'gcx, 'tcx> + 'o>::finish_resolving_def_to_ty::hb33ba6ff972bf66a\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc_typeck/astconv.rs:1352\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc_typeck/astconv.rs:1641\r\n  15:     0x7f7b92c9d82d - <rustc_typeck::astconv::AstConv<'gcx, 'tcx> + 'o>::ast_ty_to_ty::h4c84cc5def66e1b0\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc_typeck/astconv.rs:1782\r\n  16:     0x7f7b92c9d477 - <rustc_typeck::astconv::AstConv<'gcx, 'tcx> + 'o>::ast_ty_to_ty::h4c84cc5def66e1b0\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc_typeck/astconv.rs:1685\r\n  17:     0x7f7b92ba1af0 - <rustc_data_structures::accumulate_vec::AccumulateVec<A> as core::iter::traits::FromIterator<<A as rustc_data_structures::array_vec::Array>::Element>>::from_iter::hfdecda85b6ee2dc0\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc_typeck/astconv.rs:1471\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc_typeck/astconv.rs:637\r\n                        at /build/rust/src/rustc-1.14.0/src/libcore/ops.rs:2645\r\n                        at /build/rust/src/rustc-1.14.0/src/libcore/option.rs:383\r\n                        at /build/rust/src/rustc-1.14.0/src/libcore/iter/mod.rs:982\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc_data_structures/array_vec.rs:83\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc_data_structures/accumulate_vec.rs:45\r\n  18:     0x7f7b92bfd5cd - <T as rustc::ty::context::InternIteratorElement<T, R>>::intern_with::hbed1effdf5d4565d\r\n                        at /build/rust/src/rustc-1.14.0/src/libcore/iter/iterator.rs:1196\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc/ty/context.rs:1585\r\n  19:     0x7f7b92c94769 - <rustc_typeck::astconv::AstConv<'gcx, 'tcx> + 'o>::convert_parenthesized_parameters::h1b374d401abe269f\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc/ty/context.rs:1573\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc/ty/context.rs:1526\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc_typeck/astconv.rs:636\r\n  20:     0x7f7b92cc502b - <rustc_typeck::astconv::AstConv<'gcx, 'tcx> + 'o>::create_substs_for_ast_path::{{closure}}::h3b953e74f9262ad4\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc_typeck/astconv.rs:494\r\n  21:     0x7f7b92bd8a11 - rustc::ty::subst::<impl rustc::ty::Slice<rustc::ty::subst::Kind<'tcx>>>::fill_item::hc2473b62b2e76567\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc/ty/subst.rs:215\r\n  22:     0x7f7b92c93f77 - <rustc_typeck::astconv::AstConv<'gcx, 'tcx> + 'o>::create_substs_for_ast_path::hcb4d8d3715bef93a\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc/ty/subst.rs:182\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc_typeck/astconv.rs:473\r\n  23:     0x7f7b92c96b8c - <rustc_typeck::astconv::AstConv<'gcx, 'tcx> + 'o>::create_substs_for_ast_trait_ref::he7e542db1af8aef7\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc_typeck/astconv.rs:826\r\n  24:     0x7f7b92c95771 - <rustc_typeck::astconv::AstConv<'gcx, 'tcx> + 'o>::ast_path_to_poly_trait_ref::h614bbc13174ca471\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc_typeck/astconv.rs:738\r\n  25:     0x7f7b92caeced - rustc_typeck::collect::ty_generic_predicates::h881ada9eb3a9f029\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc_typeck/astconv.rs:673\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc_typeck/collect.rs:1840\r\n  26:     0x7f7b92ca4fe5 - rustc_typeck::collect::convert_method::h8688aa375c36d11a\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc_typeck/collect.rs:574\r\n  27:     0x7f7b92ca84bd - rustc_typeck::collect::convert_item::h7034bc47a5dd94fa\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc_typeck/collect.rs:927\r\n  28:     0x7f7b92ca1442 - rustc_typeck::collect::collect_item_types::h129f81a692b66ae1\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc_typeck/collect.rs:135\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc/dep_graph/visit.rs:46\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc/hir/mod.rs:445\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc/dep_graph/visit.rs:57\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc/ty/mod.rs:2844\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc_typeck/collect.rs:97\r\n  29:     0x7f7b92cc0585 - rustc_typeck::check_crate::h49660caa41b9699c\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc_typeck/lib.rs:350\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc/util/common.rs:38\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc_typeck/lib.rs:349\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc/session/mod.rs:222\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc_typeck/lib.rs:348\r\n  30:     0x7f7b936e15ae - rustc_driver::driver::phase_3_run_analysis_passes::{{closure}}::h5a9a7c8e1b6dbe3a\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc_driver/driver.rs:891\r\n  31:     0x7f7b936ba86a - rustc_driver::driver::phase_3_run_analysis_passes::h823704ee01fd0a1e\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc/ty/context.rs:1028\r\n                        at /build/rust/src/rustc-1.14.0/src/libstd/thread/local.rs:245\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc/ty/context.rs:1025\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc/ty/context.rs:1012\r\n                        at /build/rust/src/rustc-1.14.0/src/libstd/thread/local.rs:245\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc/ty/context.rs:1009\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc/ty/context.rs:797\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc_driver/driver.rs:869\r\n  32:     0x7f7b936acd47 - rustc_driver::driver::compile_input::h66a0adaf05fab85d\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc_driver/driver.rs:173\r\n  33:     0x7f7b936d2490 - rustc_driver::run_compiler::hafe7bbfedf95a825\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc_driver/lib.rs:222\r\n  34:     0x7f7b936073d8 - std::panicking::try::do_call::h5ff5e568cb9cce51\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc_driver/lib.rs:1138\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc_driver/lib.rs:138\r\n                        at /build/rust/src/rustc-1.14.0/src/librustc_driver/lib.rs:1072\r\n                        at /build/rust/src/rustc-1.14.0/src/libstd/panic.rs:295\r\n                        at /build/rust/src/rustc-1.14.0/src/libstd/panicking.rs:356\r\n  35:     0x7f7b93338ffa - __rust_maybe_catch_panic\r\n                        at /build/rust/src/rustc-1.14.0/src/libpanic_unwind/lib.rs:97\r\n  36:     0x7f7b93627038 - <F as alloc::boxed::FnBox<A>>::call_box::h92e2f4ed0df1d5b6\r\n                        at /build/rust/src/rustc-1.14.0/src/libstd/panicking.rs:332\r\n                        at /build/rust/src/rustc-1.14.0/src/libstd/panic.rs:351\r\n                        at /build/rust/src/rustc-1.14.0/src/libstd/thread/mod.rs:287\r\n                        at /build/rust/src/rustc-1.14.0/src/liballoc/boxed.rs:595\r\n  37:     0x7f7b9332cd64 - std::sys::imp::thread::Thread::new::thread_start::ha102a6120fc52763\r\n                        at /build/rust/src/rustc-1.14.0/src/liballoc/boxed.rs:605\r\n                        at /build/rust/src/rustc-1.14.0/src/libstd/sys_common/thread.rs:21\r\n                        at /build/rust/src/rustc-1.14.0/src/libstd/sys/unix/thread.rs:84\r\n  38:     0x7f7b8e6fe453 - start_thread\r\n  39:     0x7f7b92ff47de - __GI___clone\r\n  40:                0x0 - <unknown>\r\n```\r\nVersion info:\r\n```\r\nrustc 1.14.0\r\nbinary: rustc\r\ncommit-hash: unknown\r\ncommit-date: unknown\r\nhost: x86_64-unknown-linux-gnu\r\nrelease: 1.14.0\r\nLLVM version: 3.9\r\n```", "closed_by": {"login": "thirtythreeforty", "id": 3952613, "node_id": "MDQ6VXNlcjM5NTI2MTM=", "avatar_url": "https://avatars.githubusercontent.com/u/3952613?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thirtythreeforty", "html_url": "https://github.com/thirtythreeforty", "followers_url": "https://api.github.com/users/thirtythreeforty/followers", "following_url": "https://api.github.com/users/thirtythreeforty/following{/other_user}", "gists_url": "https://api.github.com/users/thirtythreeforty/gists{/gist_id}", "starred_url": "https://api.github.com/users/thirtythreeforty/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thirtythreeforty/subscriptions", "organizations_url": "https://api.github.com/users/thirtythreeforty/orgs", "repos_url": "https://api.github.com/users/thirtythreeforty/repos", "events_url": "https://api.github.com/users/thirtythreeforty/events{/privacy}", "received_events_url": "https://api.github.com/users/thirtythreeforty/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/38651/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/38651/timeline", "performed_via_github_app": null, "state_reason": "completed"}