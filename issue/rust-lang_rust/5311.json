{"url": "https://api.github.com/repos/rust-lang/rust/issues/5311", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/5311/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/5311/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/5311/events", "html_url": "https://github.com/rust-lang/rust/issues/5311", "id": 11863932, "node_id": "MDU6SXNzdWUxMTg2MzkzMg==", "number": 5311, "title": "foldl and foldr need lifetime specifiers", "user": {"login": "doy", "id": 78547, "node_id": "MDQ6VXNlcjc4NTQ3", "avatar_url": "https://avatars.githubusercontent.com/u/78547?v=4", "gravatar_id": "", "url": "https://api.github.com/users/doy", "html_url": "https://github.com/doy", "followers_url": "https://api.github.com/users/doy/followers", "following_url": "https://api.github.com/users/doy/following{/other_user}", "gists_url": "https://api.github.com/users/doy/gists{/gist_id}", "starred_url": "https://api.github.com/users/doy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/doy/subscriptions", "organizations_url": "https://api.github.com/users/doy/orgs", "repos_url": "https://api.github.com/users/doy/repos", "events_url": "https://api.github.com/users/doy/events{/privacy}", "received_events_url": "https://api.github.com/users/doy/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2013-03-11T04:53:27Z", "updated_at": "2013-05-07T18:21:25Z", "closed_at": "2013-05-07T18:21:25Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "The second parameter to the `foldl` callback and the first parameter to the `foldr` callback need to have their lifetimes specified to be the same as the iterable they are being called on (since those variables are just pointers to values inside that structure).\n\nTest case:\n\n```\npure fn foldl<A,B>(self: &r/[A], b0: B, blk: fn(&B, &r/A) -> B) ->\u2000 B {\n    let mut b = b0;\n    for vec::each(self) |a| {\n        b = blk(&b, a);\n    }\n    b\n}\n\nfn main() {\n    let values = ~[4, 7, 3, 10, 6];\n    let first = &values[0];\n    let rest = values.view(1, values.len());\n    /* using this line works, because the correct lifetimes are specified */\n    /*let smallest: &int = do foldl(rest, first) |found, next| {*/\n    let smallest: &int = do rest.foldl(first) |found, next| {\n        if *next < **found {\n            next\n        }\n        else {\n            *found\n        }\n    };\n    io::println(fmt!(\"%d\", *smallest));\n}\n```\n\nUsing the commented out version (which uses the provided implementation of `foldl` with the correct signature) makes this code compile and work.\n\n(As a side note, I tried fixing this myself, but couldn't figure out how lifetimes for trait methods work. Is there any documentation on this?)\n", "closed_by": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/5311/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/5311/timeline", "performed_via_github_app": null, "state_reason": "completed"}