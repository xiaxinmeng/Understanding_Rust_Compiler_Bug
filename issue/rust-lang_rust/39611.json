{"url": "https://api.github.com/repos/rust-lang/rust/issues/39611", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/39611/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/39611/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/39611/events", "html_url": "https://github.com/rust-lang/rust/issues/39611", "id": 205777915, "node_id": "MDU6SXNzdWUyMDU3Nzc5MTU=", "number": 39611, "title": "Incremental compilation breaks sanitizers", "user": {"login": "japaric", "id": 5018213, "node_id": "MDQ6VXNlcjUwMTgyMTM=", "avatar_url": "https://avatars.githubusercontent.com/u/5018213?v=4", "gravatar_id": "", "url": "https://api.github.com/users/japaric", "html_url": "https://github.com/japaric", "followers_url": "https://api.github.com/users/japaric/followers", "following_url": "https://api.github.com/users/japaric/following{/other_user}", "gists_url": "https://api.github.com/users/japaric/gists{/gist_id}", "starred_url": "https://api.github.com/users/japaric/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/japaric/subscriptions", "organizations_url": "https://api.github.com/users/japaric/orgs", "repos_url": "https://api.github.com/users/japaric/repos", "events_url": "https://api.github.com/users/japaric/events{/privacy}", "received_events_url": "https://api.github.com/users/japaric/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 307747675, "node_id": "MDU6TGFiZWwzMDc3NDc2NzU=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-incr-comp", "name": "A-incr-comp", "color": "f7e101", "default": false, "description": "Area: Incremental compilation"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2017-02-07T03:45:29Z", "updated_at": "2017-02-25T15:00:38Z", "closed_at": "2017-02-25T15:00:38Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "### STR\r\n\r\n`examples/uninitialized-read.rs`\r\n\r\n``` rust\r\nuse std::mem;\r\n\r\nfn main() {\r\n    let xs: [u8; 4] = unsafe { mem::uninitialized() };\r\n    let y = xs[0] + xs[1];\r\n}\r\n```\r\n\r\n```\r\n$ export CARGO_INCREMENTAL=1\r\n\r\n$ cargo run --target x86_64-unknown-linux-gnu --example uninitialized-read\r\n   Compiling msan v0.1.0 (file:///home/japaric/rust/san/msan)\r\n    Finished dev [unoptimized + debuginfo] target(s) in 0.38 secs\r\n     Running `target/x86_64-unknown-linux-gnu/debug/examples/uninitialized-read`\r\n\r\n# sanitizer doesn't kick in\r\n$ RUSTFLAGS=\"-Z sanitizer=memory\" cargo run --target x86_64-unknown-linux-gnu --example uninitialized-read\r\n   Compiling msan v0.1.0 (file:///home/japaric/rust/san/msan)\r\n    Finished dev [unoptimized + debuginfo] target(s) in 0.38 secs\r\n     Running `target/x86_64-unknown-linux-gnu/debug/examples/uninitialized-read`\r\n```\r\n\r\n```\r\n$ unset CARGO_INCREMENTAL\r\n\r\n$ cargo clean\r\n\r\n$ cargo run --target x86_64-unknown-linux-gnu --example uninitialized-read\r\n   Compiling msan v0.1.0 (file:///home/japaric/rust/san/msan)\r\n    Finished dev [unoptimized + debuginfo] target(s) in 0.37 secs\r\n     Running `target/x86_64-unknown-linux-gnu/debug/examples/uninitialized-read`\r\n\r\n# sanitizer works this time\r\n$ RUSTFLAGS=\"-Z sanitizer=memory\" cargo run --target x86_64-unknown-linux-gnu --example uninitialized-read\r\n   Compiling msan v0.1.0 (file://PWD)\r\n    Finished dev [unoptimized + debuginfo] target(s) in 0.37 secs\r\n     Running `target/x86_64-unknown-linux-gnu/debug/examples/uninitialized-read`\r\n==2346==WARNING: MemorySanitizer: use-of-uninitialized-value\r\n    #0 0x564db789c7da in uninitialized_read::main::h0c073cea3836efc1 $PWD/examples/uninitialized-read.rs:5\r\n    #1 0x564db7919446 in __rust_maybe_catch_panic ($PWD/target/x86_64-unknown-linux-gnu/debug/examples/uninitialized-read+0x87446)\r\n    #2 0x564db7911df9 in std::rt::lang_start::h6954771f55df116b ($PWD/target/x86_64-unknown-linux-gnu/debug/examples/uninitialized-read+0x7fdf9)\r\n    #3 0x564db789c8a9 in main ($PWD/target/x86_64-unknown-linux-gnu/debug/examples/uninitialized-read+0xa8a9)\r\n    #4 0x7f80c46ab290 in __libc_start_main (/usr/lib/libc.so.6+0x20290)\r\n    #5 0x564db789c4f9 in _start ($PWD/target/x86_64-unknown-linux-gnu/debug/examples/uninitialized-read+0xa4f9)\r\n\r\nSUMMARY: MemorySanitizer: use-of-uninitialized-value $PWD/examples/uninitialized-read.rs:5 in uninitialized_read::main::h0c073cea3836efc1\r\nExiting\r\n```\r\n\r\n### Meta\r\n\r\n**TODO** Sanitizers are not yet in tree. (cf. #38699)\r\n\r\n---\r\n\r\ncc @michaelwoerister ", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/39611/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/39611/timeline", "performed_via_github_app": null, "state_reason": "completed"}