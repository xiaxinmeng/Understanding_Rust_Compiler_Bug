{"url": "https://api.github.com/repos/rust-lang/rust/issues/104676", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/104676/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/104676/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/104676/events", "html_url": "https://github.com/rust-lang/rust/issues/104676", "id": 1458124663, "node_id": "I_kwDOAAsO6M5W6Td3", "number": 104676, "title": "Tracking issue: convert library-testing ui tests to unit tests", "user": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 650846969, "node_id": "MDU6TGFiZWw2NTA4NDY5Njk=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-tracking-issue", "name": "C-tracking-issue", "color": "f5f1fd", "default": false, "description": "Category: A tracking issue for an RFC or an unstable feature."}, {"id": 2011781731, "node_id": "MDU6TGFiZWwyMDExNzgxNzMx", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-libs", "name": "T-libs", "color": "bfd4f2", "default": false, "description": "Relevant to the library team, which will review and decide on the PR/issue."}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2022-11-21T15:22:43Z", "updated_at": "2022-11-21T18:06:25Z", "closed_at": null, "author_association": "MEMBER", "active_lock_reason": null, "body": "We generally prefer library features to be tested as unit tests, not ui tests: this clearly separates things testing the compiler from things testing the library, and also ui tests are easier and faster to run and they are formatted, checked, and linted together with the rest of the library more easily. Also our unit tests are actually run by Miri, but ui tests are not (and it's much harder to do so).\r\n\r\nAFAIK some existing tests have already been converted, but I don't know if this was ever done systematically.\r\n- Identify which parts of the ui test suite are really just testing the library\r\n- Convert them to regular unit tests if possible\r\n  - it might not be possible for deliberately failing tests -- some of them might become `compile_fail` doc tests, but this does not always make sense\r\n- Properly document this policy and find some way to reduce the chance of new such tests being added\r\n\r\nCc @rust-lang/libs -- AFAIK this has already been policy for a while? @thomcc said there is no tracking issue though so here we go. :D", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/104676/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/104676/timeline", "performed_via_github_app": null, "state_reason": null}