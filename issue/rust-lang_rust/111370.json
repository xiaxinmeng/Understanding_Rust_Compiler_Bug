{"url": "https://api.github.com/repos/rust-lang/rust/issues/111370", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/111370/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/111370/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/111370/events", "html_url": "https://github.com/rust-lang/rust/issues/111370", "id": 1700984437, "node_id": "I_kwDOAAsO6M5lYvZ1", "number": 111370, "title": "\"Unreachable definition\" warning after infallible expression in `if`-block", "user": {"login": "fnetz", "id": 11715763, "node_id": "MDQ6VXNlcjExNzE1NzYz", "avatar_url": "https://avatars.githubusercontent.com/u/11715763?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fnetz", "html_url": "https://github.com/fnetz", "followers_url": "https://api.github.com/users/fnetz/followers", "following_url": "https://api.github.com/users/fnetz/following{/other_user}", "gists_url": "https://api.github.com/users/fnetz/gists{/gist_id}", "starred_url": "https://api.github.com/users/fnetz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fnetz/subscriptions", "organizations_url": "https://api.github.com/users/fnetz/orgs", "repos_url": "https://api.github.com/users/fnetz/repos", "events_url": "https://api.github.com/users/fnetz/events{/privacy}", "received_events_url": "https://api.github.com/users/fnetz/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2023-05-08T21:44:34Z", "updated_at": "2023-05-08T21:44:34Z", "closed_at": null, "author_association": "NONE", "active_lock_reason": null, "body": "The following snippet generates an \"unreachable definition\" warning at `let _x = 1` ([godbolt][1] at 1.69):\r\n```rust\r\nfn infallible() -> std::convert::Infallible {\r\n    loop {}\r\n}\r\n\r\nfn main() {\r\n    if false {\r\n        infallible();\r\n    }\r\n\r\n    let _x = 1;\r\n}\r\n```\r\n\r\nFull output:\r\n```\r\nwarning: unreachable definition\r\n  --> <source>:10:9\r\n   |\r\n7  |         infallible();\r\n   |         ------------ any code following this expression is unreachable\r\n...\r\n10 |     let _x = 123;\r\n   |         ^^ unreachable definition\r\n   |\r\nnote: this expression has type `Infallible`, which is uninhabited\r\n  --> <source>:7:9\r\n   |\r\n7  |         infallible();\r\n   |         ^^^^^^^^^^^^\r\n   = note: `#[warn(unreachable_code)]` on by default\r\n```\r\n\r\nRuntime behaviour is as expected (it exits), so this warning seems wrong.\r\n\r\nThis occurs in rustc 1.71.0-nightly (c4190f2d3 2023-05-07) all the way back to rustc 1.56.\r\n\r\nA similar issue (with an expression instead of a definition) has been brought up in #89779. However, that specific case disappeared in rustc 1.60.\r\n\r\n[1]: https://rust.godbolt.org/#g:!((g:!((g:!((h:codeEditor,i:(filename:'1',fontScale:14,fontUsePx:'0',j:1,lang:rust,selection:(endColumn:1,endLineNumber:12,positionColumn:1,positionLineNumber:12,selectionStartColumn:1,selectionStartLineNumber:12,startColumn:1,startLineNumber:12),source:'fn+infallible()+-%3E+std::convert::Infallible+%7B%0A++++loop+%7B%7D%0A%7D%0A%0Apub+fn+main()+%7B%0A++++if+false+%7B%0A++++++++infallible()%3B%0A++++%7D%0A%0A++++let+_x+%3D+123%3B%0A%7D%0A'),l:'5',n:'0',o:'Rust+source+%231',t:'0')),k:50,l:'4',n:'0',o:'',s:0,t:'0'),(g:!((g:!((h:output,i:(compilerName:'rustc+1.62.0',editorid:1,fontScale:14,fontUsePx:'0',j:1,wrap:'1'),l:'5',n:'0',o:'Output+of+rustc+1.69.0+(Compiler+%231)',t:'0')),k:50,l:'4',m:57.44920993227991,n:'0',o:'',s:0,t:'0'),(g:!((h:compiler,i:(compiler:r1690,deviceViewOpen:'1',filters:(b:'0',binary:'1',binaryObject:'1',commentOnly:'0',demangle:'0',directives:'0',execute:'1',intel:'0',libraryCode:'0',trim:'1'),flagsViewOpen:'1',fontScale:14,fontUsePx:'0',j:1,lang:rust,libs:!(),options:'',selection:(endColumn:12,endLineNumber:2,positionColumn:12,positionLineNumber:2,selectionStartColumn:12,selectionStartLineNumber:2,startColumn:12,startLineNumber:2),source:1),l:'5',n:'0',o:'+rustc+1.69.0+(Editor+%231)',t:'0')),header:(),l:'4',m:42.55079006772009,n:'0',o:'',s:0,t:'0')),k:50,l:'3',n:'0',o:'',t:'0')),l:'2',n:'0',o:'',t:'0')),version:4", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/111370/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/111370/timeline", "performed_via_github_app": null, "state_reason": null}