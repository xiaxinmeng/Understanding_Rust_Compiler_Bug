{"url": "https://api.github.com/repos/rust-lang/rust/issues/48655", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/48655/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/48655/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/48655/events", "html_url": "https://github.com/rust-lang/rust/issues/48655", "id": 301646235, "node_id": "MDU6SXNzdWUzMDE2NDYyMzU=", "number": 48655, "title": "Atomic[IU]size: Supply a generic CAS loop", "user": {"login": "llogiq", "id": 4200835, "node_id": "MDQ6VXNlcjQyMDA4MzU=", "avatar_url": "https://avatars.githubusercontent.com/u/4200835?v=4", "gravatar_id": "", "url": "https://api.github.com/users/llogiq", "html_url": "https://github.com/llogiq", "followers_url": "https://api.github.com/users/llogiq/followers", "following_url": "https://api.github.com/users/llogiq/following{/other_user}", "gists_url": "https://api.github.com/users/llogiq/gists{/gist_id}", "starred_url": "https://api.github.com/users/llogiq/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/llogiq/subscriptions", "organizations_url": "https://api.github.com/users/llogiq/orgs", "repos_url": "https://api.github.com/users/llogiq/repos", "events_url": "https://api.github.com/users/llogiq/events{/privacy}", "received_events_url": "https://api.github.com/users/llogiq/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 211668019, "node_id": "MDU6TGFiZWwyMTE2NjgwMTk=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-lang", "name": "T-lang", "color": "bfd4f2", "default": false, "description": "Relevant to the language team, which will review and decide on the PR/issue."}, {"id": 211668062, "node_id": "MDU6TGFiZWwyMTE2NjgwNjI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-libs-api", "name": "T-libs-api", "color": "bfd4f2", "default": false, "description": "Relevant to the library API team, which will review and decide on the PR/issue."}, {"id": 246778137, "node_id": "MDU6TGFiZWwyNDY3NzgxMzc=", "url": "https://api.github.com/repos/rust-lang/rust/labels/B-unstable", "name": "B-unstable", "color": "d304cb", "default": false, "description": "Implemented in the nightly compiler and unstable."}, {"id": 650846969, "node_id": "MDU6TGFiZWw2NTA4NDY5Njk=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-tracking-issue", "name": "C-tracking-issue", "color": "f5f1fd", "default": false, "description": "Category: A tracking issue for an RFC or an unstable feature."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2018-03-02T04:02:20Z", "updated_at": "2020-06-19T16:34:57Z", "closed_at": "2020-06-19T16:34:57Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Rationale: Writing an optimal CAS loop is time-consuming and risks errors (e.g.\r\nmis-setting Orderings). On the other hand, there are two general operations:\r\n`fetch_and_update` which is useful for things like random number generators,\r\nand `update_and_fetch` which is the usual operation when you want to e.g. keep\r\na maximum stat over a series of concurrently produced values.\r\n\r\nAdding those two operations as methods has little cost. Conversely, requiring\r\nan extra crate means that the methods would have to either be implemented as\r\nfunctions instead of methods, or that an extension trait would have to be\r\nimported to use them. Both of those options are suboptimal.\r\n\r\nPrior art: Java has an `getAndUpdate` / `updateAndGet` method on its\r\n`AtomicInteger` class since version 1.8. Due to the fact that Java lambdas are\r\nmore restricted w.r.t. mutability of their arguments than Rust's, there's also\r\n`accumulateAndGet` / `getAndAccumulate`.", "closed_by": {"login": "sfackler", "id": 1455697, "node_id": "MDQ6VXNlcjE0NTU2OTc=", "avatar_url": "https://avatars.githubusercontent.com/u/1455697?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sfackler", "html_url": "https://github.com/sfackler", "followers_url": "https://api.github.com/users/sfackler/followers", "following_url": "https://api.github.com/users/sfackler/following{/other_user}", "gists_url": "https://api.github.com/users/sfackler/gists{/gist_id}", "starred_url": "https://api.github.com/users/sfackler/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sfackler/subscriptions", "organizations_url": "https://api.github.com/users/sfackler/orgs", "repos_url": "https://api.github.com/users/sfackler/repos", "events_url": "https://api.github.com/users/sfackler/events{/privacy}", "received_events_url": "https://api.github.com/users/sfackler/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/48655/reactions", "total_count": 5, "+1": 5, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/48655/timeline", "performed_via_github_app": null, "state_reason": "completed"}