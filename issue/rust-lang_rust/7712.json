{"url": "https://api.github.com/repos/rust-lang/rust/issues/7712", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/7712/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/7712/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/7712/events", "html_url": "https://github.com/rust-lang/rust/issues/7712", "id": 16632779, "node_id": "MDU6SXNzdWUxNjYzMjc3OQ==", "number": 7712, "title": "ICE while generating debug symbols for default trait method", "user": {"login": "chris-morgan", "id": 392868, "node_id": "MDQ6VXNlcjM5Mjg2OA==", "avatar_url": "https://avatars.githubusercontent.com/u/392868?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chris-morgan", "html_url": "https://github.com/chris-morgan", "followers_url": "https://api.github.com/users/chris-morgan/followers", "following_url": "https://api.github.com/users/chris-morgan/following{/other_user}", "gists_url": "https://api.github.com/users/chris-morgan/gists{/gist_id}", "starred_url": "https://api.github.com/users/chris-morgan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chris-morgan/subscriptions", "organizations_url": "https://api.github.com/users/chris-morgan/orgs", "repos_url": "https://api.github.com/users/chris-morgan/repos", "events_url": "https://api.github.com/users/chris-morgan/events{/privacy}", "received_events_url": "https://api.github.com/users/chris-morgan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 203130, "node_id": "MDU6TGFiZWwyMDMxMzA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-debuginfo", "name": "A-debuginfo", "color": "f7e101", "default": false, "description": "Area: Debugging information in compiled programs (DWARF, PDB, etc.)"}, {"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2013-07-11T14:13:39Z", "updated_at": "2013-07-20T17:49:37Z", "closed_at": "2013-07-20T17:49:37Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Here is a minimal test case where compilation fails with `rustc -Z debug-info`:\n\n``` rust\n#[allow(default_methods)];\n\npub trait TraitWithDefaultMethod {\n    pub fn method(self) {\n        ()\n    }\n}\n\nstruct MyStruct;\n\nimpl TraitWithDefaultMethod for MyStruct { }\n\nfn main() {\n    MyStruct.method();\n}\n```\n\n(To the best of my knowledge, nothing can be removed from this example without the ICE melting, including that `method` cannot be empty, hence the `()`.)\n\nI believe this to be what is causing #7603.\n\n```\n$ RUST_LOG=::rt::backtrace rustc -Z debug-info debug-info.rs\nerror: internal compiler error: create_function: unexpected sort of node\nrust: task failed at 'explicit failure', /home/chris/vc/rust/src/libsyntax/diagnostic.rs:95\n/home/chris/opt/rust/bin/../lib/librustrt.so(_ZN9rust_task13begin_failureEPKcS1_m+0x4b)[0x7f20cc97319b]\n/home/chris/opt/rust/bin/../lib/librustrt.so(+0x2b899)[0x7f20cc984899]\n/home/chris/opt/rust/bin/../lib/librustrt.so(upcall_fail+0x1a8)[0x7f20cc9751e8]\n/home/chris/opt/rust/bin/../lib/libstd-6c65cf4b443341b1-0.8-pre.so(_ZN3sys13begin_unwind_16_89e154cd091567114_0$x2e8$x2dpreE+0x3ce)[0x7f20ce49291e]\n/home/chris/opt/rust/bin/../lib/libstd-6c65cf4b443341b1-0.8-pre.so(+0x10ba22)[0x7f20ce492a22]\n/home/chris/opt/rust/bin/../lib/libstd-6c65cf4b443341b1-0.8-pre.so(+0x10b471)[0x7f20ce492471]\n/home/chris/opt/rust/bin/../lib/libstd-6c65cf4b443341b1-0.8-pre.so(+0x10b9dc)[0x7f20ce4929dc]\n/home/chris/opt/rust/bin/../lib/libstd-6c65cf4b443341b1-0.8-pre.so(+0x10b471)[0x7f20ce492471]\n/home/chris/opt/rust/bin/../lib/libstd-6c65cf4b443341b1-0.8-pre.so(+0x81c24)[0x7f20ce408c24]\n/home/chris/opt/rust/bin/../lib/libsyntax-64629f7f0c6a9bc-0.8-pre.so(_ZN10diagnostic14__extensions__10meth_100605fatal17_e0de3d9f29108f6414_0$x2e8$x2dpreE+0x104)[0x7f20cd9289b4]\n/home/chris/opt/rust/bin/../lib/libsyntax-64629f7f0c6a9bc-0.8-pre.so(_ZN10diagnostic14__extensions__10meth_101113bug17_e0de3d9f29108f6414_0$x2e8$x2dpreE+0xbc)[0x7f20cd92939c]\n/home/chris/opt/rust/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8-pre.so(_ZN6driver7session14__extensions__10meth_225843bug16_e3e78dc632d928214_0$x2e8$x2dpreE+0x7e)[0x7f20cccd85ee]\n/home/chris/opt/rust/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8-pre.so(_ZN6middle5trans9debuginfo15create_function17_fd8a269c7ed18de514_0$x2e8$x2dpreE+0x3d3)[0x7f20cce22443]\n/home/chris/opt/rust/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8-pre.so(_ZN6middle5trans9debuginfo12create_block16_32d3b40cf56155214_0$x2e8$x2dpreE+0x5b9)[0x7f20cce87949]\n/home/chris/opt/rust/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8-pre.so(_ZN6middle5trans9debuginfo17update_source_pos17_bf3a8dc7724bb7e414_0$x2e8$x2dpreE+0x4f7)[0x7f20ccd1a3c7]\n/home/chris/opt/rust/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8-pre.so(_ZN6middle5trans11controlflow11trans_block17_ee7f10de21ab6c9114_0$x2e8$x2dpreE+0x1e3)[0x7f20ccd19133]\n/home/chris/opt/rust/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8-pre.so(_ZN6middle5trans4base13trans_closure15_eb8c317d92aa4114_0$x2e8$x2dpreE+0x6f7)[0x7f20cce21597]\n/home/chris/opt/rust/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8-pre.so(_ZN6middle5trans4base8trans_fn16_e7ca69dba5ead9314_0$x2e8$x2dpreE+0x46c)[0x7f20cccde86c]\n/home/chris/opt/rust/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8-pre.so(_ZN6middle5trans4meth12trans_method15_4b2179042862d714_0$x2e8$x2dpreE+0x23a)[0x7f20ccd12aca]\n/home/chris/opt/rust/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8-pre.so(_ZN6middle5trans12monomorphize14monomorphic_fn17_6e46edc17bf7cc1d14_0$x2e8$x2dpreE+0x2853)[0x7f20ccce1633]\n/home/chris/opt/rust/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8-pre.so(_ZN6middle5trans6callee25trans_fn_ref_with_vtables17_966bf88471d939ae14_0$x2e8$x2dpreE+0x1c1b)[0x7f20ccd5cf5b]\n/home/chris/opt/rust/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8-pre.so(_ZN6middle5trans6callee12trans_fn_ref15_6201f3a45fe54c14_0$x2e8$x2dpreE+0x63e)[0x7f20ccd56dfe]\n/home/chris/opt/rust/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8-pre.so(_ZN6middle5trans4meth19trans_method_callee16_8c271f56084e55e14_0$x2e8$x2dpreE+0xa4f)[0x7f20ccd6569f]\n/home/chris/opt/rust/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8-pre.so(+0x1ba0f5)[0x7f20ccd640f5]\n/home/chris/opt/rust/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8-pre.so(+0x1cf877)[0x7f20ccd79877]\n/home/chris/opt/rust/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8-pre.so(_ZN6middle5trans4base17with_scope_result17_b34fe6984565501914_0$x2e8$x2dpreE+0x19b)[0x7f20ccd262db]\n/home/chris/opt/rust/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8-pre.so(_ZN6middle5trans6callee16trans_call_inner17_4e2d672a1713c67c14_0$x2e8$x2dpreE+0x100)[0x7f20ccd62bf0]\n/home/chris/opt/rust/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8-pre.so(_ZN6middle5trans6callee17trans_method_call16_244e1becaccf29b14_0$x2e8$x2dpreE+0x6bb)[0x7f20ccd633bb]\n/home/chris/opt/rust/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8-pre.so(_ZN6middle5trans4expr27trans_rvalue_dps_unadjusted17_a9cdd97d7831daaa14_0$x2e8$x2dpreE+0x6cd)[0x7f20ccd8983d]\n/home/chris/opt/rust/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8-pre.so(_ZN6middle5trans4expr10trans_into17_a9cdd97d7831daaa14_0$x2e8$x2dpreE+0xad0)[0x7f20ccd1be50]\n/home/chris/opt/rust/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8-pre.so(_ZN6middle5trans4base10trans_stmt17_a1207e2fc3dfb78f14_0$x2e8$x2dpreE+0x517)[0x7f20ccd1abd7]\n/home/chris/opt/rust/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8-pre.so(_ZN6middle5trans11controlflow11trans_block17_ee7f10de21ab6c9114_0$x2e8$x2dpreE+0x110)[0x7f20ccd19060]\n/home/chris/opt/rust/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8-pre.so(_ZN6middle5trans4base13trans_closure15_eb8c317d92aa4114_0$x2e8$x2dpreE+0x6f7)[0x7f20cce21597]\n/home/chris/opt/rust/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8-pre.so(_ZN6middle5trans4base8trans_fn16_e7ca69dba5ead9314_0$x2e8$x2dpreE+0x46c)[0x7f20cccde86c]\n/home/chris/opt/rust/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8-pre.so(_ZN6middle5trans4base10trans_item16_b0be10e6c143dbd14_0$x2e8$x2dpreE+0xc7b)[0x7f20cccd785b]\n/home/chris/opt/rust/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8-pre.so(_ZN6middle5trans4base9trans_mod17_9439df66548551c914_0$x2e8$x2dpreE+0x8d)[0x7f20cce26dcd]\n/home/chris/opt/rust/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8-pre.so(_ZN6middle5trans4base11trans_crate17_52eafc89c87e94d314_0$x2e8$x2dpreE+0x46e)[0x7f20cce3638e]\n/home/chris/opt/rust/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8-pre.so(+0x8187ac)[0x7f20cd3c27ac]\n/home/chris/opt/rust/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8-pre.so(_ZN6driver6driver12compile_rest17_c3b419a0238ad86d14_0$x2e8$x2dpreE+0x2832)[0x7f20cd3c0042]\n/home/chris/opt/rust/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8-pre.so(+0x84bf34)[0x7f20cd3f5f34]\n/home/chris/opt/rust/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8-pre.so(_ZN6driver6driver12compile_upto17_2aa9cc5bfaa1e08e14_0$x2e8$x2dpreE+0x13c)[0x7f20cd3c2adc]\n/home/chris/opt/rust/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8-pre.so(_ZN6driver6driver13compile_input15_7651cceb76d69d14_0$x2e8$x2dpreE+0xd5)[0x7f20cd3c2e75]\n/home/chris/opt/rust/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8-pre.so(_ZN12run_compiler16_5ecbadc50d5136214_0$x2e8$x2dpreE+0x192a)[0x7f20cd3e2c6a]\n/home/chris/opt/rust/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8-pre.so(+0x84bc5e)[0x7f20cd3f5c5e]\n/home/chris/opt/rust/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8-pre.so(+0x849707)[0x7f20cd3f3707]\n/home/chris/opt/rust/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8-pre.so(+0x8402fb)[0x7f20cd3ea2fb]\n/home/chris/opt/rust/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8-pre.so(+0x84bf34)[0x7f20cd3f5f34]\n/home/chris/opt/rust/bin/../lib/libstd-6c65cf4b443341b1-0.8-pre.so(+0xdaa49)[0x7f20ce461a49]\n/home/chris/opt/rust/bin/../lib/libstd-6c65cf4b443341b1-0.8-pre.so(+0x1599fc)[0x7f20ce4e09fc]\n/home/chris/opt/rust/bin/../lib/librustrt.so(_Z18task_start_wrapperP10spawn_args+0x2b)[0x7f20cc973b2b]\nrust: task failed at 'explicit failure', /home/chris/vc/rust/src/librustc/rustc.rs:355\n/home/chris/opt/rust/bin/../lib/librustrt.so(_ZN9rust_task13begin_failureEPKcS1_m+0x4b)[0x7f20cc97319b]\n/home/chris/opt/rust/bin/../lib/librustrt.so(+0x2b899)[0x7f20cc984899]\n/home/chris/opt/rust/bin/../lib/librustrt.so(upcall_fail+0x1a8)[0x7f20cc9751e8]\n/home/chris/opt/rust/bin/../lib/libstd-6c65cf4b443341b1-0.8-pre.so(_ZN3sys13begin_unwind_16_89e154cd091567114_0$x2e8$x2dpreE+0x3ce)[0x7f20ce49291e]\n/home/chris/opt/rust/bin/../lib/libstd-6c65cf4b443341b1-0.8-pre.so(+0x10ba22)[0x7f20ce492a22]\n/home/chris/opt/rust/bin/../lib/libstd-6c65cf4b443341b1-0.8-pre.so(+0x10b471)[0x7f20ce492471]\n/home/chris/opt/rust/bin/../lib/libstd-6c65cf4b443341b1-0.8-pre.so(+0x10b9dc)[0x7f20ce4929dc]\n/home/chris/opt/rust/bin/../lib/libstd-6c65cf4b443341b1-0.8-pre.so(+0x10b471)[0x7f20ce492471]\n/home/chris/opt/rust/bin/../lib/libstd-6c65cf4b443341b1-0.8-pre.so(+0x81c24)[0x7f20ce408c24]\n/home/chris/opt/rust/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8-pre.so(_ZN7monitor16_a04770b32d08dc114_0$x2e8$x2dpreE+0x29b5)[0x7f20cd3e61a5]\n/home/chris/opt/rust/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8-pre.so(+0x84bf34)[0x7f20cd3f5f34]\n/home/chris/opt/rust/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8-pre.so(_ZN4main15_f3d16eaf7d573814_0$x2e8$x2dpreE+0x69)[0x7f20cd3f5b89]\n/home/chris/opt/rust/bin/../lib/librustrt.so(_Z18task_start_wrapperP10spawn_args+0x2b)[0x7f20cc973b2b]\nrust: domain main @0x181ad90 root task failed\nleaked memory in rust main loop (1 objects)\nrustc: /home/chris/vc/rust/src/rt/memory_region.cpp:192: memory_region::~memory_region(): Assertion `false' failed.\n[1]    29254 abort (core dumped)  RUST_LOG=::rt::backtrace rustc -Z debug-info debug-info.rs\n```\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/7712/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/7712/timeline", "performed_via_github_app": null, "state_reason": "completed"}