{"url": "https://api.github.com/repos/rust-lang/rust/issues/103235", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/103235/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/103235/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/103235/events", "html_url": "https://github.com/rust-lang/rust/issues/103235", "id": 1414631871, "node_id": "I_kwDOAAsO6M5UUZG_", "number": 103235, "title": "str::match_indices documentation is misleading re overlaps", "user": {"login": "jruderman", "id": 692547, "node_id": "MDQ6VXNlcjY5MjU0Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/692547?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jruderman", "html_url": "https://github.com/jruderman", "followers_url": "https://api.github.com/users/jruderman/followers", "following_url": "https://api.github.com/users/jruderman/following{/other_user}", "gists_url": "https://api.github.com/users/jruderman/gists{/gist_id}", "starred_url": "https://api.github.com/users/jruderman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jruderman/subscriptions", "organizations_url": "https://api.github.com/users/jruderman/orgs", "repos_url": "https://api.github.com/users/jruderman/repos", "events_url": "https://api.github.com/users/jruderman/events{/privacy}", "received_events_url": "https://api.github.com/users/jruderman/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 431251592, "node_id": "MDU6TGFiZWw0MzEyNTE1OTI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-docs", "name": "A-docs", "color": "f7e101", "default": false, "description": "Area: documentation for any part of the project, including the compiler, standard library, and tools"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2022-10-19T09:34:40Z", "updated_at": "2022-10-19T09:34:40Z", "closed_at": null, "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "### Location\r\n\r\nhttps://doc.rust-lang.org/std/primitive.str.html#method.match_indices\r\n\r\n### Summary\r\n\r\n\"An iterator over the disjoint matches of a pattern\"\r\n\r\nIt's weird to say \"_the_ disjoint matches\" as if this uniquely identifies a set of matches. It's certainly _a_ set of disjoint matches, and even _a maximal_ set of disjoint matches, but it isn't always the only such set.\r\n\r\n\"For matches of pat within self that overlap, only the indices corresponding to the first match are returned.\"\r\n\r\nThis also isn't quite right. It's more like matches are skipped if they overlap _an index that was returned earlier_.\r\n\r\n### Clarifying the text\r\n\r\nFor the first quoted sentence, perhaps: \"An iterator over matches of the pattern, skipping overlaps as necessary for e.g. doing a search-and-replace\"\r\n\r\nFor the second quoted sentence, describing the algorithm would be clearer: \"When a match is found, it skips to after the match (so matches that overlap the found-match are omitted)\".\r\n\r\n### Clarifying the examples\r\n\r\nFor `match_indices`, I suggest replacing the last example with:\r\n\r\n```rust\r\nfn main() {\r\n    let v: Vec<_> = \"ababababa\".match_indices(\"aba\").collect();\r\n    // This example demonstrates what happens when matches overlap.\r\n    // The \"aba\" starting at index 2 is skipped due to the \"aba\" starting at index 0 being included.\r\n    // The \"aba\" starting at index 6 is skipped due to the \"aba\" starting at index 4 being included.\r\n    assert_eq!(v, [(0, \"aba\"), (4, \"aba\")]);\r\n}\r\n```\r\n\r\nand for `rmatch_indices`, I suggest:\r\n\r\n```rust\r\nfn main() {\r\n    let v: Vec<_> = \"ababababa\".rmatch_indices(\"aba\").collect();\r\n    // The \"aba\" starting at index 4 is skipped due to the \"aba\" starting at index 6 being included.\r\n    // The \"aba\" starting at index 0 is skipped due to the \"aba\" starting at index 2 being included.\r\n    assert_eq!(v, [(6, \"aba\"), (2, \"aba\")]);\r\n}\r\n```\r\n\r\n(I chose \"ababababa\" instead of \"abababa\" because I wanted to ensure it remains clear that `rmatch_indices` does not just return the reversed output from `match_indices`.)", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/103235/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/103235/timeline", "performed_via_github_app": null, "state_reason": null}