{"url": "https://api.github.com/repos/rust-lang/rust/issues/104343", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/104343/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/104343/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/104343/events", "html_url": "https://github.com/rust-lang/rust/issues/104343", "id": 1446677158, "node_id": "I_kwDOAAsO6M5WOoqm", "number": 104343, "title": "\"computing type of ...::{opaque#0}\" query cycle in `async fn` w/ auto trait obligations.", "user": {"login": "inanna-malick", "id": 2675660, "node_id": "MDQ6VXNlcjI2NzU2NjA=", "avatar_url": "https://avatars.githubusercontent.com/u/2675660?v=4", "gravatar_id": "", "url": "https://api.github.com/users/inanna-malick", "html_url": "https://github.com/inanna-malick", "followers_url": "https://api.github.com/users/inanna-malick/followers", "following_url": "https://api.github.com/users/inanna-malick/following{/other_user}", "gists_url": "https://api.github.com/users/inanna-malick/gists{/gist_id}", "starred_url": "https://api.github.com/users/inanna-malick/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/inanna-malick/subscriptions", "organizations_url": "https://api.github.com/users/inanna-malick/orgs", "repos_url": "https://api.github.com/users/inanna-malick/repos", "events_url": "https://api.github.com/users/inanna-malick/events{/privacy}", "received_events_url": "https://api.github.com/users/inanna-malick/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 631673608, "node_id": "MDU6TGFiZWw2MzE2NzM2MDg=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-impl-trait", "name": "A-impl-trait", "color": "f7e101", "default": false, "description": "Area: impl Trait. Universally / existentially quantified anonymous types with static dispatch."}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}, {"id": 3771326768, "node_id": "LA_kwDOAAsO6M7gyeEw", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-auto-traits", "name": "A-auto-traits", "color": "f7e101", "default": false, "description": "Area: auto traits (`auto trait Send`)"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2022-11-13T01:17:22Z", "updated_at": "2022-11-13T17:57:23Z", "closed_at": null, "author_association": "NONE", "active_lock_reason": null, "body": "I tried this code using GATs and the async feature\r\n\r\nhttps://play.rust-lang.org/?version=nightly&mode=debug&edition=2021&gist=8856ef117840a1d3b4be93441c2b36b1\r\n\r\nI expected it to compile. For reference, the same code implemented using manual `.then` future chaining compiles as shown here:\r\n\r\nhttps://play.rust-lang.org/?version=nightly&mode=debug&edition=2021&gist=8cd834a4ff4d4b969d6ba1de9db91fee\r\n\r\nNote that the above are built with nightly 1.67, but the same error occurs on stable 1.65.\r\n\r\nTagging @jackh726 as suggested by @jyn514 \r\n\r\nNote that GATs are an amazing feature that I'm incredibly grateful to you for implementing, and also that I'm not surprised that my extremely galaxy brained Haskell shenanigans hit some edge case.\r\n\r\n---\r\n\r\n**EDIT**(@eddyb): changed title as per https://github.com/rust-lang/rust/issues/104343#issuecomment-1312653689 - this does not seem to involve GATs at all, just the unfortunate interaction of `async fn`'s `-> impl Future` desugaring + the \"leaky\" auto trait semantics of `-> impl Trait`.", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/104343/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 1, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/104343/timeline", "performed_via_github_app": null, "state_reason": null}