{"url": "https://api.github.com/repos/rust-lang/rust/issues/73908", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/73908/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/73908/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/73908/events", "html_url": "https://github.com/rust-lang/rust/issues/73908", "id": 648613557, "node_id": "MDU6SXNzdWU2NDg2MTM1NTc=", "number": 73908, "title": "Tracking issue for supporting macOS on Apple Silicon (a.k.a arm64, M1, M2, aarch64)", "user": {"login": "shepmaster", "id": 174509, "node_id": "MDQ6VXNlcjE3NDUwOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/174509?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shepmaster", "html_url": "https://github.com/shepmaster", "followers_url": "https://api.github.com/users/shepmaster/followers", "following_url": "https://api.github.com/users/shepmaster/following{/other_user}", "gists_url": "https://api.github.com/users/shepmaster/gists{/gist_id}", "starred_url": "https://api.github.com/users/shepmaster/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shepmaster/subscriptions", "organizations_url": "https://api.github.com/users/shepmaster/orgs", "repos_url": "https://api.github.com/users/shepmaster/repos", "events_url": "https://api.github.com/users/shepmaster/events{/privacy}", "received_events_url": "https://api.github.com/users/shepmaster/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 123111, "node_id": "MDU6TGFiZWwxMjMxMTE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/O-macos", "name": "O-macos", "color": "6e6ec0", "default": false, "description": "Operating system: macOS"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 593503757, "node_id": "MDU6TGFiZWw1OTM1MDM3NTc=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-infra", "name": "T-infra", "color": "bfd4f2", "default": false, "description": "Relevant to the infrastructure team, which will review and decide on the PR/issue."}, {"id": 650846969, "node_id": "MDU6TGFiZWw2NTA4NDY5Njk=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-tracking-issue", "name": "C-tracking-issue", "color": "f5f1fd", "default": false, "description": "Category: A tracking issue for an RFC or an unstable feature."}, {"id": 3537211959, "node_id": "LA_kwDOAAsO6M7S1ZI3", "url": "https://api.github.com/repos/rust-lang/rust/labels/S-tracking-impl-incomplete", "name": "S-tracking-impl-incomplete", "color": "4682b4", "default": false, "description": ""}, {"id": 3940166907, "node_id": "LA_kwDOAAsO6M7q2iz7", "url": "https://api.github.com/repos/rust-lang/rust/labels/O-AArch64", "name": "O-AArch64", "color": "6e6ec0", "default": false, "description": "Armv8-A or later processors in AArch64 mode"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 66, "created_at": "2020-07-01T02:00:26Z", "updated_at": "2023-06-01T13:13:04Z", "closed_at": null, "author_association": "MEMBER", "active_lock_reason": null, "body": "<!-- \r\n==================================\r\n\r\nThanks for maintaining this tracking issue! Please give `@Jake Goulding` and `@Pietro Albini` a ping in Zulip to let us know you've edited this. \r\n\r\n==================================\r\n-->\r\n\r\nOn 2020-06-22, [Apple announced][announce] that future computers will utilize Arm processors instead of x86_64 processors. This is the tracking issue for supporting that platform, commonly referred to as **Apple Silicon**.\r\n\r\n> :warning: **Don't rely on this thread to decide whether to purchase Apple Silicon hardware.** :warning:\r\n> The Rust project does not make any guarantee on the level of support the compiler has.\r\n\r\n[announce]: https://www.apple.com/newsroom/2020/06/apple-announces-mac-transition-to-apple-silicon/\r\n\r\n### Current status summary (2022-07-05)\r\n\r\n- There is no timeline for any level of support.\r\n\r\n- `aarch64-apple-darwin` is a tier 2 target and is available for download via rustup. This compiler can be used to cross-compile from `x86_64-apple-darwin` as well as running natively on Arm.\r\n\r\n- Compiler tests are **not** being run at this point, as CI has no way of executing them. This is a blocker for Tier 1 support.\r\n\r\n- The x86_64 version of `rustc` works under [Rosetta][], producing x86_64 binaries that themselves run under Rosetta. \r\n\r\n[Rosetta]: https://developer.apple.com/documentation/apple_silicon/about_the_rosetta_translation_environment\r\n\r\n### About tracking issues\r\n\r\nTracking issues are used to record the overall progress of implementation. They are also used as hubs connecting to other relevant issues, e.g., bugs or open design questions.\r\n\r\nA tracking issue is *not* meant for large scale discussion, questions, or bug reports about a feature. Instead, join the discussion and/or contribute in the [**#t-compiler/arm** Zulip stream][stream] or open a new issue for bug reports. You are encouraged to comment here to link to related issues.\r\n\r\nThis tracking issue will be closely moderated in an attempt to maintain a high signal-to-noise ratio. \r\n\r\n[stream]: https://rust-lang.zulipchat.com/#narrow/stream/242906-t-compiler.2Farm\r\n\r\n### Steps\r\n\r\nThis is not yet intended to be an exhaustive or even accurate list of steps.\r\n\r\n- [ ] ~~Find out if there is anyone inside the compiler team with the time to drive the effort forward. This will allow us to efficiently allocate the [Developer Transition Kits][dtk] (DTK), if we end up receiving any~~. There are no members of the compiler team actively working on this\r\n- [x] Reach out to our contacts at Apple to see if DTKs are available, and to establish a line of communication if there are problems down the line. **Please coordinate with the leads of the compiler and infra teams on Zulip on this**.\r\n- [x] Achieve Tier 3 support:\r\n  - ~~Wait for proper support to be upstreamed into LLVM, and update the Rust compiler to pull the latest version of LLVM~~.\r\n    - Our current LLVM supports targeting the appropriate hardware well enough.\r\n  - Update the [libc crate][libc]'s conditional compilation to account for the new target.\r\n    - [x] https://github.com/rust-lang/libc/pull/1817 (in libc 0.2.73)\r\n  - Update the [cc crate][cc] to account for the new target.\r\n    - [x] https://github.com/alexcrichton/cc-rs/pull/527 (in cc 1.0.58) \r\n  - Submit an initial target specification for `aarch64-apple-darwin`.\r\n    - [x] https://github.com/rust-lang/rust/pull/74541\r\n  - Get the target specification into the bootstrap compiler.\r\n    - [x] https://github.com/rust-lang/rust/pull/74541\r\n    - [x] https://github.com/rust-lang/rust/pull/75261\r\n- [x] Achieve Tier 2 support:\r\n  - [x] Get Xcode 12 on our CI\r\n  - Update the [openssl-src crate][openssl-src] to account for the new target.\r\n    - [x] https://github.com/alexcrichton/openssl-src-rs/pull/74\r\n  - Setup a cross-compiling builder to reach Tier 2\r\n    - [x] Add to CI (https://github.com/rust-lang/rust/pull/75991)\r\n    - [x] Build Cargo (https://github.com/rust-lang/rust/pull/77239)\r\n    - [x] Distribute binaries (https://github.com/rust-lang/rust/pull/77895)\r\n- [ ] Achieve Tier 1 support:\r\n  - [ ] Entire test suite passes\r\n    - [x] #78092\r\n    - [x] #78881\r\n  - [ ] Increase the quality and reliability of the target\r\n  - [ ] Hook up target hardware to our CI, and start running the test suite as part of our standard QA process.\r\n  - [ ] Propose the promotion to Tier 1.\r\n- Miscellaneous\r\n  - Rustup\r\n    - [x] Add support to rustup (https://github.com/rust-lang/rustup/pull/2521)\r\n    - [x] Release it (https://github.com/rust-lang/rustup/issues/2413)\r\n\r\n[dtk]: https://developer.apple.com/programs/universal/\r\n[libc]: https://github.com/rust-lang/libc\r\n[cc]: https://github.com/alexcrichton/cc-rs\r\n[openssl-src]: https://github.com/alexcrichton/openssl-src-rs\r\n\r\n### Resolved Questions\r\n\r\n- The infra team does **not** want to maintain our own hardware / VMs. This means solutions like MacStadium, AWS, or \"putting our own hardware under someone's desk\" are non-starters.\r\n\r\n### Unresolved Questions\r\n\r\nThis is not yet intended to be an exhaustive or even accurate list of questions.\r\n\r\n- [ ] When will our CI providers have access to native hardware?\r\n  - [ ] https://github.com/actions/virtual-environments/issues/2187\r\n  - [ ] https://github.com/github/roadmap/issues/528\r\n- [ ] Should we use an alternative / additional CI provider to GitHub?\r\n  - [ ] [Cirrus CI](https://cirrus-ci.org/guide/macOS)\r\n- [ ] What is an accurate target name for the new platform?\r\n  - [ ] What is the accurate name of the chip (\"silicon\", \"aarch64\", \"arm64\", etc.)?\r\n- [ ] How can we leave room to support Apple's `arm64e`?\r\n\r\n### Implementation history\r\n\r\n", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/73908/reactions", "total_count": 423, "+1": 225, "-1": 0, "laugh": 2, "hooray": 67, "confused": 0, "heart": 10, "rocket": 70, "eyes": 49}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/73908/timeline", "performed_via_github_app": null, "state_reason": null}