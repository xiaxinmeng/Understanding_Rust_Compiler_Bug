{"url": "https://api.github.com/repos/rust-lang/rust/issues/14456", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/14456/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/14456/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/14456/events", "html_url": "https://github.com/rust-lang/rust/issues/14456", "id": 34363266, "node_id": "MDU6SXNzdWUzNDM2MzI2Ng==", "number": 14456, "title": "std::io::process::StdioContainer::Ignored doesn't attach streams to /dev/null with libnative", "user": {"login": "glandium", "id": 1038527, "node_id": "MDQ6VXNlcjEwMzg1Mjc=", "avatar_url": "https://avatars.githubusercontent.com/u/1038527?v=4", "gravatar_id": "", "url": "https://api.github.com/users/glandium", "html_url": "https://github.com/glandium", "followers_url": "https://api.github.com/users/glandium/followers", "following_url": "https://api.github.com/users/glandium/following{/other_user}", "gists_url": "https://api.github.com/users/glandium/gists{/gist_id}", "starred_url": "https://api.github.com/users/glandium/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/glandium/subscriptions", "organizations_url": "https://api.github.com/users/glandium/orgs", "repos_url": "https://api.github.com/users/glandium/repos", "events_url": "https://api.github.com/users/glandium/events{/privacy}", "received_events_url": "https://api.github.com/users/glandium/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2014-05-27T11:31:45Z", "updated_at": "2014-05-29T07:11:43Z", "closed_at": "2014-05-29T07:11:43Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Consider the following program:\n\n``` rust\nuse std::io::process;\nuse std::io::process::Command;\n\nfn main() {\n    Command::new(\"ls\")\n        .args([\"-l\", \"/proc/self/fd\"])\n        .stdin(process::Ignored)\n        .stdout(process::InheritFd(1))\n        .stderr(process::Ignored)\n        .status()\n        .ok();\n}\n```\n\nThe output with libnative is:\n\n```\ntotal 0\nlr-x------ 1 glandium glandium 64 May 27 20:24 0 -> /proc/31431/fd\nlrwx------ 1 glandium glandium 64 May 27 20:24 1 -> /dev/pts/6\n```\n\nIOW, stdin and stderr weren't attached to /dev/null in the subprocess, and whatever open the subprocess did took fd 0, which, in the case of ls, ends up being assigned by opendir() to the directory being listed. Fun failures could follow with processes that use stdin/stdout/stderr.\n\nWith rustuv, it looks like the expected result:\n\n```\ntotal 0\nlr-x------ 1 glandium glandium 64 May 27 20:28 0 -> /dev/null\nlrwx------ 1 glandium glandium 64 May 27 20:28 1 -> /dev/pts/6\nlrwx------ 1 glandium glandium 64 May 27 20:28 2 -> /dev/null\nlr-x------ 1 glandium glandium 64 May 27 20:28 3 -> /proc/31466/fd\n```\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/14456/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/14456/timeline", "performed_via_github_app": null, "state_reason": "completed"}