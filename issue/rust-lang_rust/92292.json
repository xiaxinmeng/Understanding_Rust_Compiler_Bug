{"url": "https://api.github.com/repos/rust-lang/rust/issues/92292", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/92292/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/92292/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/92292/events", "html_url": "https://github.com/rust-lang/rust/issues/92292", "id": 1088780816, "node_id": "I_kwDOAAsO6M5A5XoQ", "number": 92292, "title": "rustc fails to see that trait bound is satisfied", "user": {"login": "Freax13", "id": 14952658, "node_id": "MDQ6VXNlcjE0OTUyNjU4", "avatar_url": "https://avatars.githubusercontent.com/u/14952658?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Freax13", "html_url": "https://github.com/Freax13", "followers_url": "https://api.github.com/users/Freax13/followers", "following_url": "https://api.github.com/users/Freax13/following{/other_user}", "gists_url": "https://api.github.com/users/Freax13/gists{/gist_id}", "starred_url": "https://api.github.com/users/Freax13/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Freax13/subscriptions", "organizations_url": "https://api.github.com/users/Freax13/orgs", "repos_url": "https://api.github.com/users/Freax13/repos", "events_url": "https://api.github.com/users/Freax13/events{/privacy}", "received_events_url": "https://api.github.com/users/Freax13/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 36996, "node_id": "MDU6TGFiZWwzNjk5Ng==", "url": "https://api.github.com/repos/rust-lang/rust/labels/E-easy", "name": "E-easy", "color": "02e10c", "default": false, "description": "Call for participation: Experience needed to fix: Easy / not much (good first issue)"}, {"id": 46741598, "node_id": "MDU6TGFiZWw0Njc0MTU5OA==", "url": "https://api.github.com/repos/rust-lang/rust/labels/E-needs-test", "name": "E-needs-test", "color": "02e10c", "default": false, "description": "Call for participation: writing correctness tests"}, {"id": 147085028, "node_id": "MDU6TGFiZWwxNDcwODUwMjg=", "url": "https://api.github.com/repos/rust-lang/rust/labels/regression-from-stable-to-nightly", "name": "regression-from-stable-to-nightly", "color": "e4008a", "default": false, "description": "Performance or correctness regression from stable to nightly."}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}], "state": "closed", "locked": false, "assignee": {"login": "weirane", "id": 37568244, "node_id": "MDQ6VXNlcjM3NTY4MjQ0", "avatar_url": "https://avatars.githubusercontent.com/u/37568244?v=4", "gravatar_id": "", "url": "https://api.github.com/users/weirane", "html_url": "https://github.com/weirane", "followers_url": "https://api.github.com/users/weirane/followers", "following_url": "https://api.github.com/users/weirane/following{/other_user}", "gists_url": "https://api.github.com/users/weirane/gists{/gist_id}", "starred_url": "https://api.github.com/users/weirane/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/weirane/subscriptions", "organizations_url": "https://api.github.com/users/weirane/orgs", "repos_url": "https://api.github.com/users/weirane/repos", "events_url": "https://api.github.com/users/weirane/events{/privacy}", "received_events_url": "https://api.github.com/users/weirane/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "weirane", "id": 37568244, "node_id": "MDQ6VXNlcjM3NTY4MjQ0", "avatar_url": "https://avatars.githubusercontent.com/u/37568244?v=4", "gravatar_id": "", "url": "https://api.github.com/users/weirane", "html_url": "https://github.com/weirane", "followers_url": "https://api.github.com/users/weirane/followers", "following_url": "https://api.github.com/users/weirane/following{/other_user}", "gists_url": "https://api.github.com/users/weirane/gists{/gist_id}", "starred_url": "https://api.github.com/users/weirane/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/weirane/subscriptions", "organizations_url": "https://api.github.com/users/weirane/orgs", "repos_url": "https://api.github.com/users/weirane/repos", "events_url": "https://api.github.com/users/weirane/events{/privacy}", "received_events_url": "https://api.github.com/users/weirane/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2021-12-26T14:17:58Z", "updated_at": "2021-12-30T18:06:54Z", "closed_at": "2021-12-30T18:06:54Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "### Code\r\n\r\nI tried this code:\r\n```rust\r\nuse std::marker::PhantomData;\r\n\r\npub struct MyGenericType<T> {\r\n    _marker: PhantomData<*const T>,\r\n}\r\n\r\npub struct MyNonGenericType;\r\n\r\nimpl<T> From<MyGenericType<T>> for MyNonGenericType {\r\n    fn from(_: MyGenericType<T>) -> Self {\r\n        todo!()\r\n    }\r\n}\r\n\r\npub trait MyTrait {\r\n    const MY_CONSTANT: i32;\r\n}\r\n\r\nimpl<T> MyTrait for MyGenericType<T>\r\nwhere\r\n    Self: Into<MyNonGenericType>,\r\n{\r\n    const MY_CONSTANT: i32 = 1;\r\n}\r\n\r\nimpl<T> MyGenericType<T> {\r\n    const MY_OTHER_CONSTANT: i32 = <MyGenericType<T> as MyTrait>::MY_CONSTANT;\r\n}\r\n\r\n```\r\n\r\nI expected to see this happen:\r\nIt should compile successfully.\r\n\r\nInstead, this happened: \r\nThe compiler doesn't realize that `Into<MyNonGenericType>` is implemented for all `MyGenericType<T>` and reports an error.\r\n\r\n```\r\nerror[E0277]: the trait bound `MyNonGenericType: From<MyGenericType<T>>` is not satisfied\r\n  --> src/lib.rs:27:36\r\n   |\r\n27 |     const MY_OTHER_CONSTANT: i32 = <MyGenericType<T> as MyTrait>::MY_CONSTANT;\r\n   |                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ the trait `From<MyGenericType<T>>` is not implemented for `MyNonGenericType`\r\n   |\r\n   = note: required because of the requirements on the impl of `Into<MyNonGenericType>` for `MyGenericType<T>`\r\nnote: required because of the requirements on the impl of `MyTrait` for `MyGenericType<T>`\r\n  --> src/lib.rs:19:9\r\n   |\r\n19 | impl<T> MyTrait for MyGenericType<T>\r\n   |         ^^^^^^^     ^^^^^^^^^^^^^^^^\r\nhelp: consider introducing a `where` bound, but there might be an alternative better way to express this requirement\r\n   |\r\n26 | impl<T> MyGenericType<T> where MyNonGenericType: From<MyGenericType<T>> {\r\n   |                          ++++++++++++++++++++++++++++++++++++++++++++++\r\n\r\nFor more information about this error, try `rustc --explain E0277`.\r\nerror: could not compile `regression` due to previous error\r\n```\r\n\r\nInterestingly enough, removing the `where Self: Into<MyNonGenericType>,` bound makes this compile again.\r\n\r\n### cargo-bisect-rustc report\r\nsearched nightlies: from nightly-2021-12-01 to nightly-2021-12-25\r\nregressed nightly: nightly-2021-12-14\r\nsearched commit range: https://github.com/rust-lang/rust/compare/6bda5b331cfe7e04e1fe348c58a928fc2b650f4f...8f117a77d0880ed59afcc1a19c72ec5c1e44b97c\r\nregressed commit: https://github.com/rust-lang/rust/commit/22f8bde876f2fa9c5c4e95be1bce29cc271f2b51\r\n\r\n<details>\r\n<summary>bisected with <a href='https://github.com/rust-lang/cargo-bisect-rustc'>cargo-bisect-rustc</a> v0.6.1</summary>\r\n\r\n\r\nHost triple: x86_64-unknown-linux-gnu\r\nReproduce with:\r\n```bash\r\ncargo bisect-rustc --test-dir=. --start=2021-12-01 --end=2021-12-25 \r\n```\r\n</details>\r\n\r\n@rustbot modify labels: +regression-from-stable-to-nightly\n\n<!-- TRIAGEBOT_START -->\n\n<!-- TRIAGEBOT_ASSIGN_START -->\n\n<!-- TRIAGEBOT_ASSIGN_DATA_START$${\"user\":\"weirane\"}$$TRIAGEBOT_ASSIGN_DATA_END -->\n\n<!-- TRIAGEBOT_ASSIGN_END -->\n<!-- TRIAGEBOT_END -->", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/92292/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/92292/timeline", "performed_via_github_app": null, "state_reason": "completed"}