{"url": "https://api.github.com/repos/rust-lang/rust/issues/86232", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/86232/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/86232/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/86232/events", "html_url": "https://github.com/rust-lang/rust/issues/86232", "id": 919178282, "node_id": "MDU6SXNzdWU5MTkxNzgyODI=", "number": 86232, "title": "The `check_abi` function in typeck is not called for ABIs in trait declarations or type aliases", "user": {"login": "nagisa", "id": 679122, "node_id": "MDQ6VXNlcjY3OTEyMg==", "avatar_url": "https://avatars.githubusercontent.com/u/679122?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nagisa", "html_url": "https://github.com/nagisa", "followers_url": "https://api.github.com/users/nagisa/followers", "following_url": "https://api.github.com/users/nagisa/following{/other_user}", "gists_url": "https://api.github.com/users/nagisa/gists{/gist_id}", "starred_url": "https://api.github.com/users/nagisa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nagisa/subscriptions", "organizations_url": "https://api.github.com/users/nagisa/orgs", "repos_url": "https://api.github.com/users/nagisa/repos", "events_url": "https://api.github.com/users/nagisa/events{/privacy}", "received_events_url": "https://api.github.com/users/nagisa/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-06-11T20:21:46Z", "updated_at": "2021-11-21T13:36:00Z", "closed_at": null, "author_association": "MEMBER", "active_lock_reason": null, "body": "Consider the following code:\r\n\r\n```\r\ntrait T {\r\n    extern \"amdgpu-kernel\" fn mu();\r\n}\r\n\r\ntype TAU = extern \"amdgpu-kernel\" fn();\r\n```\r\n\r\nThe `check_abi` function\u2026 \r\n\r\nhttps://github.com/rust-lang/rust/blob/0a8629bff642c3c3b84bb644c0099194f063b627/compiler/rustc_typeck/src/check/check.rs#L37-L59\r\n\r\n\u2026 is not called for the following two ABI lines, meaning that the checks present therein do not activate, potentially allowing circumvention of the checks this function implements. In particular one thing that is allowed is taking the `TAU` function pointer as an argument and calling it on architectures where this ABI is unsupported.\r\n\r\nThis becomes especially relevant after #86231 lands.", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/86232/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/86232/timeline", "performed_via_github_app": null, "state_reason": null}