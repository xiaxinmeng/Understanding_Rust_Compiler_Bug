{"url": "https://api.github.com/repos/rust-lang/rust/issues/14377", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/14377/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/14377/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/14377/events", "html_url": "https://github.com/rust-lang/rust/issues/14377", "id": 34177758, "node_id": "MDU6SXNzdWUzNDE3Nzc1OA==", "number": 14377, "title": "task 'rustc' failed at 'OwnedSlice: index out of bounds'", "user": {"login": "jbalintbiro", "id": 339825, "node_id": "MDQ6VXNlcjMzOTgyNQ==", "avatar_url": "https://avatars.githubusercontent.com/u/339825?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jbalintbiro", "html_url": "https://github.com/jbalintbiro", "followers_url": "https://api.github.com/users/jbalintbiro/followers", "following_url": "https://api.github.com/users/jbalintbiro/following{/other_user}", "gists_url": "https://api.github.com/users/jbalintbiro/gists{/gist_id}", "starred_url": "https://api.github.com/users/jbalintbiro/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jbalintbiro/subscriptions", "organizations_url": "https://api.github.com/users/jbalintbiro/orgs", "repos_url": "https://api.github.com/users/jbalintbiro/repos", "events_url": "https://api.github.com/users/jbalintbiro/events{/privacy}", "received_events_url": "https://api.github.com/users/jbalintbiro/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2014-05-23T14:07:49Z", "updated_at": "2014-06-22T13:50:49Z", "closed_at": "2014-06-22T13:50:49Z", "author_association": "NONE", "active_lock_reason": null, "body": "# Reduced test case\n\n``` rust\nfn drop_test() {                        \n    struct DropCounter<'a> {            \n        count: &'a int,                 \n    }                                   \n    impl <'a> Drop for DropCounter<'a> {\n        fn drop(&mut self) { }          \n    }                                   \n}                                       \n```\n# Original issue\n\ncode that triggered it:\n\n``` rust\n//! probabilistic container\n\n#![crate_id = \"skiplist#0\"]\n#![crate_type = \"lib\"]\n\npub struct SkipList<K, V> {\n    roots: Vec<Link<K, V>>\n}\n\nstruct Node<K, V> {\n    key: K,\n    value: V,\n    links: Link<K, V>\n}\n\nstruct Link<K, V> {\n    p: *mut Node<K, V>\n}\n\nimpl<K, V> Node<K, V> {\n}\n\nimpl<K, V> SkipList<K, V> {\n    pub fn new() -> SkipList<K, V> {\n        SkipList { roots: Vec::new() }\n    }\n\n    pub fn insert(&self, k: K, v: V) -> bool {\n        false\n    }\n\n    pub fn find(&self, k: K) -> Option<V> {\n        None\n    }\n\n    pub fn remove(&self, k: K) -> bool { false }\n}\n\n/*impl<K: TotalOrd, V> Map<K, V> for SkipList<K, V> {\n    fn find() {}\n\n}*/\n\n\n#[cfg(test)]\nmod tests {\n    use super::SkipList;\n\n    #[test]\n    fn test_insert_remove() {\n        let mut sl = SkipList::new();\n        assert!(sl.insert(1, 1));\n        assert!(sl.insert(2, 1));\n        assert!(sl.insert(3, 1));\n\n        assert!(sl.remove(2));\n\n        assert_eq!(sl.find(1), Some(1));\n        assert_eq!(sl.find(2), None);\n        assert_eq!(sl.find(4), None);\n    }\n\n    #[test]\n    fn drop_test() {\n        struct DropCounter<'a> {\n            count: &'a mut int\n        }\n\n        impl<'a> Drop for DropCounter<'a> {\n            fn drop(&mut self) {\n                *self.count += 1;\n            }\n        }\n\n        let mut drop_count = 0;\n        {\n            let mut sl = SkipList::new();\n            sl.insert(1, DropCounter {count: &mut drop_count});\n            sl.insert(1, DropCounter {count: &mut drop_count});\n            sl.insert(2, DropCounter {count: &mut drop_count});\n        }\n        assert_eq!(drop_count, 3);\n    }\n}\n\n#[cfg(test)]\nmod bench {\n    extern crate test;\n    use self::test::Bencher;\n\n    #[bench]\n    fn bench(b: &mut Bencher) {}\n\n}\n```\n\ntrace:\ntask 'rustc' failed at 'OwnedSlice: index out of bounds', /home/bjb/src/rust/src/libstd/option.rs:167\nstack backtrace:\n   1:     0x7fe1642131b0 - rt::backtrace::imp::write::h96d85ea18992593cPUy::v0.11.0.pre\n   2:     0x7fe16418ff60 - rt::unwind::begin_unwind_inner::h8ea9fe72e3892daeXuy::v0.11.0.pre\n   3:     0x7fe164cce9b0 - rt::unwind::begin_unwind::h5064124597624340269::v0.11.0.pre\n   4:     0x7fe164ebfda0 - middle::ty_fold::super_fold_sty::h1584947460896464705::v0.11.0.pre\n   5:     0x7fe164d4b640 - middle::subst::SubstFolder<'a>.TypeFolder::fold_ty::ha6ec74b373bc1d03qsR::v0.11.0.pre\n   6:     0x7fe164dd1bc0 - middle::subst::T.Subst::subst_spanned::h13474638946470633177::v0.11.0.pre\n   7:     0x7fe164e569d0 - middle::ty::lookup_field_type::heb8a718cf718b4ba9WP::v0.11.0.pre\n   8:     0x7fe164d34360 - middle::ty::struct_fields::hea2fe481f733123du5P::v0.11.0.pre\n   9:     0x7fe164e83c60 - middle::ty::type_contents::tc_ty::h93c5eab2ab237a69UgN::v0.11.0.pre\n  10:     0x7fe164e2d160 - middle::ty::type_contents::hd87553be01fd1d64QfN::v0.11.0.pre\n  11:     0x7fe16520a3c0 - middle::kind::check_item::hfb296b4505eee5adOJQ::v0.11.0.pre\n  12:     0x7fe16520f9f0 - visit::walk_decl::h17157218454155748735::v0.11.0.pre\n  13:     0x7fe16520f8f0 - visit::walk_stmt::h2013433038502380431::v0.11.0.pre\n  14:     0x7fe16520f830 - visit::walk_block::h11844577003690490754::v0.11.0.pre\n  15:     0x7fe165209490 - middle::kind::check_fn::h978ba03dee808a05fPQ::v0.11.0.pre\n  16:     0x7fe16520a3c0 - middle::kind::check_item::hfb296b4505eee5adOJQ::v0.11.0.pre\n  17:     0x7fe16520a3c0 - middle::kind::check_item::hfb296b4505eee5adOJQ::v0.11.0.pre\n  18:     0x7fe16520d230 - middle::kind::check_crate::hec9303143bcae49c1zQ::v0.11.0.pre\n  19:     0x7fe16512c200 - util::common::time::h3579776483427610692::v0.11.0.pre\n  20:     0x7fe16559c590 - driver::driver::phase_3_run_analysis_passes::hdc1852929b3d1f8fITj::v0.11.0.pre\n  21:     0x7fe165595790 - driver::driver::compile_input::hf2673e6ef850e8e5iJj::v0.11.0.pre\n  22:     0x7fe165660fb0 - driver::run_compiler::h06f7bdbcca33196abmm::v0.11.0.pre\n  23:     0x7fe165660ed0 - driver::main_args::closure.93524\n  24:     0x7fe1656761a0 - driver::monitor::closure.94596\n  25:     0x7fe165671490 - task::TaskBuilder::try::closure.94359\n  26:     0x7fe164731ef0 - task::spawn_opts::closure.7814\n  27:     0x7fe16420d330 - rt::task::Task::run::closure.25292\n  28:     0x7fe1642728c0 - rust_try\n  29:     0x7fe16420d280 - rt::task::Task::run::h31ac7cd46a833d08Ajw::v0.11.0.pre\n  30:     0x7fe164731ca0 - task::spawn_opts::closure.7787\n  31:     0x7fe1642115b0 - rt::thread::thread_start::hcee82097ba2d401982w::v0.11.0.pre\n  32:     0x7fe161cb6fa0 - start_thread\n  33:     0x7fe163e57bc9 - __clone\n  34:                0x0 - <unknown>\n\nuname -a:\nLinux b 3.14-1-amd64 #1 SMP Debian 3.14.2-1 (2014-04-28) x86_64 GNU/Linux\n\nrustc compiled from 9e244d708461d5028066a59e70866f52517e7b85 (Fri May 23)\n", "closed_by": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/14377/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/14377/timeline", "performed_via_github_app": null, "state_reason": "completed"}