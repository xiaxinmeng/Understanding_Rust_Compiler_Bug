{"url": "https://api.github.com/repos/rust-lang/rust/issues/66401", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/66401/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/66401/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/66401/events", "html_url": "https://github.com/rust-lang/rust/issues/66401", "id": 522608603, "node_id": "MDU6SXNzdWU1MjI2MDg2MDM=", "number": 66401, "title": "Rustdoc: maybe don't display #[repr(C)] sometimes", "user": {"login": "CAD97", "id": 5992217, "node_id": "MDQ6VXNlcjU5OTIyMTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5992217?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CAD97", "html_url": "https://github.com/CAD97", "followers_url": "https://api.github.com/users/CAD97/followers", "following_url": "https://api.github.com/users/CAD97/following{/other_user}", "gists_url": "https://api.github.com/users/CAD97/gists{/gist_id}", "starred_url": "https://api.github.com/users/CAD97/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CAD97/subscriptions", "organizations_url": "https://api.github.com/users/CAD97/orgs", "repos_url": "https://api.github.com/users/CAD97/repos", "events_url": "https://api.github.com/users/CAD97/events{/privacy}", "received_events_url": "https://api.github.com/users/CAD97/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 203738, "node_id": "MDU6TGFiZWwyMDM3Mzg=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-rustdoc", "name": "T-rustdoc", "color": "bfd4f2", "default": false, "description": "Relevant to the rustdoc team, which will review and decide on the PR/issue."}, {"id": 234948, "node_id": "MDU6TGFiZWwyMzQ5NDg=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-attributes", "name": "A-attributes", "color": "f7e101", "default": false, "description": "Area: #[attributes(..)]"}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-11-14T03:55:27Z", "updated_at": "2023-02-05T04:01:52Z", "closed_at": null, "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "If a struct has some public fields and some non-public fields, `// some fields omitted` is displayed at the end of the declaration shown by rustdoc. Rustdoc also shows attributes on the declaration, such as `#[repr(C)]`.\r\n\r\nThis is actively misleading for `#[repr(C)]` types. If a private type is before any public types, then the struct as displayed suggests that the public fields are at the front of the struct, and thus have defined offsets smaller than where they actually are.\r\n\r\nExample:\r\n\r\n```rust\r\n#[repr(C)]\r\n#[derive(Debug, Eq, PartialEq, Hash)]\r\npub struct ThinData<Head, SliceItem> {\r\n    length: usize,\r\n    pub head: Head,\r\n    pub slice: [SliceItem],\r\n}\r\n```\r\n![image](https://user-images.githubusercontent.com/5992217/68825587-97b7ec00-0668-11ea-802f-09fa71986c99.png)\r\n\r\n\r\nThere are two solutions:\r\n\r\n- Put `// some fields omitted` in the correct place among public fields for `#[repr(C)]` types, or\r\n- Don't display `#[repr(C)]` for types with nonpublic visibility on any of their fields.", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/66401/reactions", "total_count": 4, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 2, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/66401/timeline", "performed_via_github_app": null, "state_reason": null}