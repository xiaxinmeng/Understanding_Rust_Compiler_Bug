{"url": "https://api.github.com/repos/rust-lang/rust-clippy/issues/10092", "repository_url": "https://api.github.com/repos/rust-lang/rust-clippy", "labels_url": "https://api.github.com/repos/rust-lang/rust-clippy/issues/10092/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust-clippy/issues/10092/comments", "events_url": "https://api.github.com/repos/rust-lang/rust-clippy/issues/10092/events", "html_url": "https://github.com/rust-lang/rust-clippy/issues/10092", "id": 1500176329, "node_id": "I_kwDOAZm0i85Zat_J", "number": 10092, "title": "Compiler error created by running clippy fix on floating point expression upgrading to 1.66", "user": {"login": "MathiasKindberg", "id": 10866610, "node_id": "MDQ6VXNlcjEwODY2NjEw", "avatar_url": "https://avatars.githubusercontent.com/u/10866610?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MathiasKindberg", "html_url": "https://github.com/MathiasKindberg", "followers_url": "https://api.github.com/users/MathiasKindberg/followers", "following_url": "https://api.github.com/users/MathiasKindberg/following{/other_user}", "gists_url": "https://api.github.com/users/MathiasKindberg/gists{/gist_id}", "starred_url": "https://api.github.com/users/MathiasKindberg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MathiasKindberg/subscriptions", "organizations_url": "https://api.github.com/users/MathiasKindberg/orgs", "repos_url": "https://api.github.com/users/MathiasKindberg/repos", "events_url": "https://api.github.com/users/MathiasKindberg/events{/privacy}", "received_events_url": "https://api.github.com/users/MathiasKindberg/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149309557, "node_id": "MDU6TGFiZWwxNDkzMDk1NTc=", "url": "https://api.github.com/repos/rust-lang/rust-clippy/labels/C-bug", "name": "C-bug", "color": "F5F1FD", "default": false, "description": "Category: Clippy is not doing the correct thing"}, {"id": 1179592412, "node_id": "MDU6TGFiZWwxMTc5NTkyNDEy", "url": "https://api.github.com/repos/rust-lang/rust-clippy/labels/I-suggestion-causes-error", "name": "I-suggestion-causes-error", "color": "E10C02", "default": false, "description": "Issue: The suggestions provided by this Lint cause an ICE/error when applied"}, {"id": 2593589230, "node_id": "MDU6TGFiZWwyNTkzNTg5MjMw", "url": "https://api.github.com/repos/rust-lang/rust-clippy/labels/I-false-positive", "name": "I-false-positive", "color": "E10C02", "default": false, "description": "Issue: The lint was triggered on code it shouldn't have"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-12-16T13:04:23Z", "updated_at": "2022-12-26T21:55:00Z", "closed_at": null, "author_association": "NONE", "active_lock_reason": null, "body": "I got linked here after running `clippy fix` upgrading our codebase to 1.66.\r\n\r\n`cargo clippy --all-features --tests --fix`\r\n\r\nI tried this code:\r\n\r\n```bash\r\nwarning: failed to automatically apply fixes suggested by rustc to crate `foo`\r\n\r\nafter fixes were automatically applied the compiler reported errors within these files:\r\n\r\n  * crates/foo/src/bar.rs\r\n\r\nThis likely indicates a bug in either rustc or cargo itself,\r\nand we would appreciate a bug report! You're likely to see\r\na number of compiler warnings after this message which cargo\r\nattempted to fix but failed. If you could open an issue at\r\nhttps://github.com/rust-lang/rust/issues\r\nquoting the full output of this command we'd be very appreciative!\r\nNote that you may be able to make some more progress in the near-term\r\nfixing code with the `--broken-code` flag\r\n\r\nThe following errors were reported:\r\nerror[E0689]: can't call method `ln` on ambiguous numeric type `{float}`\r\n   --> crates/foo/src/bar.rs:163:51\r\n    |\r\n163 |         let foo = 1.0 * (1.0 / (1.0 / 7.0)).ln();\r\n    |                                                   ^^\r\n\r\nerror: aborting due to previous error\r\n\r\nFor more information about this error, try `rustc --explain E0689`.\r\nOriginal diagnostics will follow.\r\n\r\nwarning: casting to the same type is unnecessary (`f64` -> `f64`)\r\n   --> crates/algo/src/categorical_relative_entropy.rs:163:30\r\n    |\r\n163 |         let foo = 1.0 * ((1.0 / (1.0 / 7.0)) as f64).ln();\r\n    |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: try: `(1.0 / (1.0 / 7.0))`\r\n    |\r\n    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unnecessary_cast\r\n    = note: `#[warn(clippy::unnecessary_cast)]` on by default\r\n```\r\n\r\nLike the output says afterward, there are a bunch of fixes that do not get applied.\r\n\r\nFor example formatting strings.\r\n\r\n```bash\r\n    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#uninlined_format_args\r\nhelp: change this to\r\n435 -         println!(\"foo={:?}\", foo);\r\n435 +         println!(\"foo={foo:?}\");\r\n```\r\n\r\nAnd some warnings for elided lifetimes.\r\n```bash\r\nwarning: the following explicit lifetimes could be elided: 'a\r\n   --> crates/foo/src/bar/mod.rs:258:5\r\n    |\r\n258 | /     fn baz<'a, 'b>(\r\n259 | |         &'a mut self,\r\n260 | |         batch: &'b Foo,\r\n261 | |     ) -> anyhow::Result<Bar<'b>> {\r\n    | |_________________________________________^\r\n    |\r\n    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#needless_lifetimes`\r\n```\r\n", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust-clippy/issues/10092/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust-clippy/issues/10092/timeline", "performed_via_github_app": null, "state_reason": null}