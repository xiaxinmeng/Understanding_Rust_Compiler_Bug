{"url": "https://api.github.com/repos/rust-lang/rust/issues/5218", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/5218/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/5218/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/5218/events", "html_url": "https://github.com/rust-lang/rust/issues/5218", "id": 11606111, "node_id": "MDU6SXNzdWUxMTYwNjExMQ==", "number": 5218, "title": "ICE with namespace qualified macro", "user": {"login": "huonw", "id": 1203825, "node_id": "MDQ6VXNlcjEyMDM4MjU=", "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4", "gravatar_id": "", "url": "https://api.github.com/users/huonw", "html_url": "https://github.com/huonw", "followers_url": "https://api.github.com/users/huonw/followers", "following_url": "https://api.github.com/users/huonw/following{/other_user}", "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}", "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/huonw/subscriptions", "organizations_url": "https://api.github.com/users/huonw/orgs", "repos_url": "https://api.github.com/users/huonw/repos", "events_url": "https://api.github.com/users/huonw/events{/privacy}", "received_events_url": "https://api.github.com/users/huonw/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2013-03-04T05:47:37Z", "updated_at": "2014-06-16T21:56:41Z", "closed_at": "2013-03-05T20:08:06Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "The compiler crashes when attempting use a macro with a namespace.\n\n``` rust\nmod m {\n    macro_rules! test {\n        { } => { ~\"test\" }\n    }\n}\n\nfn main() {\n    io::println(self::m::test!());\n}\n```\n\n```\nrust: task failed at 'Assertion (vec::len(pth.idents) == 1u) failed', /home/huon/Sources/rust/src/libsyntax/ext/expand.rs:40\n/usr/local/bin/../lib/librustrt.so(_ZN9rust_task13begin_failureEPKcS1_j+0x5a)[0xb60fb4aa]\n/usr/local/bin/../lib/librustrt.so(rust_task_fail+0x36)[0xb60fb5a6]\n/usr/local/bin/../lib/librustrt.so(_ZN9rust_task4failEPKcS1_j+0x32)[0xb60fb612]\n/usr/local/bin/../lib/librustrt.so(upcall_s_fail+0x53)[0xb60fce03]\n/usr/local/bin/../lib/librustrt.so(+0x2b42f)[0xb610d42f]\n/usr/local/bin/../lib/librustrt.so(upcall_fail+0x164)[0xb60fd434]\n/usr/local/bin/../lib/librustrt.so(rust_upcall_fail+0x2b)[0xb60fd57b]\n/usr/local/bin/../lib/libcore-c3ca5d77d81b46c1-0.6.so(_ZN3sys6rustrt16rust_upcall_fail17_2b2e25ba94c412183_06E+0x45)[0xb7565af5]\n/usr/local/bin/../lib/libcore-c3ca5d77d81b46c1-0.6.so(+0xf4b9b)[0xb7565b9b]\n/usr/local/bin/../lib/libcore-c3ca5d77d81b46c1-0.6.so(+0x39f96)[0xb74aaf96]\n/usr/local/bin/../lib/libsyntax-84efebcb12c867a2-0.6.so(_ZN3ext6expand11expand_expr16_39a5755c2f74f6c3_06E+0xe56)[0xb6f96b56]\n/usr/local/bin/../lib/libsyntax-84efebcb12c867a2-0.6.so(+0x214067)[0xb6f9e067]\n/usr/local/bin/../lib/libsyntax-84efebcb12c867a2-0.6.so(_ZN4fold14__extensions__10meth_159409fold_expr17_7c97bef3a8f034133_06E+0x9f)[0xb6e865ff]\n/usr/local/bin/../lib/libsyntax-84efebcb12c867a2-0.6.so(+0xeb1ec)[0xb6e751ec]\n/usr/local/bin/../lib/libsyntax-84efebcb12c867a2-0.6.so(+0xf16a8)[0xb6e7b6a8]\n/usr/local/bin/../lib/libsyntax-84efebcb12c867a2-0.6.so(+0x4712b)[0xb6dd112b]\n/usr/local/bin/../lib/libsyntax-84efebcb12c867a2-0.6.so(+0xf1650)[0xb6e7b650]\n/usr/local/bin/../lib/libsyntax-84efebcb12c867a2-0.6.so(_ZN4fold14__extensions__10meth_159649map_exprs17_5daf994ebdcb413d3_06E+0x55)[0xb6e87505]\n/usr/local/bin/../lib/libsyntax-84efebcb12c867a2-0.6.so(_ZN4fold14noop_fold_expr17_c51684df4b5ae6b13_06E+0x918)[0xb6e6da58]\n/usr/local/bin/../lib/libsyntax-84efebcb12c867a2-0.6.so(+0xf9afe)[0xb6e83afe]\n/usr/local/bin/../lib/libsyntax-84efebcb12c867a2-0.6.so(_ZN3ext6expand11expand_expr16_39a5755c2f74f6c3_06E+0x335)[0xb6f96035]\n/usr/local/bin/../lib/libsyntax-84efebcb12c867a2-0.6.so(+0x214067)[0xb6f9e067]\n/usr/local/bin/../lib/libsyntax-84efebcb12c867a2-0.6.so(_ZN4fold14__extensions__10meth_159409fold_expr17_7c97bef3a8f034133_06E+0x9f)[0xb6e865ff]\n/usr/local/bin/../lib/libsyntax-84efebcb12c867a2-0.6.so(+0xdfb54)[0xb6e69b54]\n/usr/local/bin/../lib/libsyntax-84efebcb12c867a2-0.6.so(+0xf8e0e)[0xb6e82e0e]\n/usr/local/bin/../lib/libsyntax-84efebcb12c867a2-0.6.so(_ZN3ext6expand11expand_stmt17_e1fe805c82b96b4f3_06E+0x50b)[0xb6f9ba5b]\n/usr/local/bin/../lib/libsyntax-84efebcb12c867a2-0.6.so(+0x214d27)[0xb6f9ed27]\n/usr/local/bin/../lib/libsyntax-84efebcb12c867a2-0.6.so(_ZN4fold14__extensions__10meth_159289fold_stmt16_63ac43579b8d6733_06E+0x9c)[0xb6e85c0c]\n/usr/local/bin/../lib/libsyntax-84efebcb12c867a2-0.6.so(+0xdf90e)[0xb6e6990e]\n/usr/local/bin/../lib/libsyntax-84efebcb12c867a2-0.6.so(+0x4712b)[0xb6dd112b]\n/usr/local/bin/../lib/libsyntax-84efebcb12c867a2-0.6.so(_ZN4fold15noop_fold_block17_41c080e19b5be4953_06E+0xbb)[0xb6e6951b]\n/usr/local/bin/../lib/libsyntax-84efebcb12c867a2-0.6.so(+0xf89be)[0xb6e829be]\n/usr/local/bin/../lib/libsyntax-84efebcb12c867a2-0.6.so(_ZN4fold14__extensions__10meth_1592510fold_block17_2c3472e1fca98da63_06E+0x91)[0xb6e859b1]\n/usr/local/bin/../lib/libsyntax-84efebcb12c867a2-0.6.so(_ZN4fold25noop_fold_item_underscore16_6e7fa1b51487e7e3_06E+0x727)[0xb6e63527]\n/usr/local/bin/../lib/libsyntax-84efebcb12c867a2-0.6.so(+0x2d1dac)[0xb705bdac]\n/usr/local/bin/../lib/libsyntax-84efebcb12c867a2-0.6.so(_ZN4fold14__extensions__10meth_1591920fold_item_underscore17_737a249096d8daa93_06E+0x8a)[0xb6e8576a]\n/usr/local/bin/../lib/libsyntax-84efebcb12c867a2-0.6.so(_ZN4fold14noop_fold_item17_e821c0956d4c24933_06E+0x121)[0xb6e62861]\n/usr/local/bin/../lib/libsyntax-84efebcb12c867a2-0.6.so(_ZN3ext6expand11expand_item17_17a6ea85a6805abe3_06E+0xea)[0xb6f9929a]\n/usr/local/bin/../lib/libsyntax-84efebcb12c867a2-0.6.so(+0x214cb0)[0xb6f9ecb0]\n/usr/local/bin/../lib/libsyntax-84efebcb12c867a2-0.6.so(_ZN4fold14__extensions__10meth_159139fold_item16_f3fa40ab23692db3_06E+0x8a)[0xb6e8543a]\n/usr/local/bin/../lib/libsyntax-84efebcb12c867a2-0.6.so(+0xee3be)[0xb6e783be]\n/usr/local/bin/../lib/libsyntax-84efebcb12c867a2-0.6.so(+0x47a1b)[0xb6dd1a1b]\n/usr/local/bin/../lib/libsyntax-84efebcb12c867a2-0.6.so(_ZN4fold13noop_fold_mod17_6635a094696388e53_06E+0xba)[0xb6e7828a]\n/usr/local/bin/../lib/libsyntax-84efebcb12c867a2-0.6.so(_ZN3ext6expand16expand_mod_items17_d6b9d64a243b9e983_06E+0x54)[0xb6f97c04]\n/usr/local/bin/../lib/libsyntax-84efebcb12c867a2-0.6.so(+0x214c42)[0xb6f9ec42]\n/usr/local/bin/../lib/libsyntax-84efebcb12c867a2-0.6.so(_ZN4fold14__extensions__10meth_159468fold_mod17_deed1713ce864fd03_06E+0x90)[0xb6e86ba0]\n/usr/local/bin/../lib/libsyntax-84efebcb12c867a2-0.6.so(_ZN4fold15noop_fold_crate17_2d683b3c2d6941c13_06E+0x82)[0xb6e614b2]\n/usr/local/bin/../lib/libsyntax-84efebcb12c867a2-0.6.so(+0xf856e)[0xb6e8256e]\n/usr/local/bin/../lib/libsyntax-84efebcb12c867a2-0.6.so(_ZN4fold14__extensions__10meth_1589610fold_crate17_30a142fa7e4985b53_06E+0x91)[0xb6e84c81]\n/usr/local/bin/../lib/libsyntax-84efebcb12c867a2-0.6.so(_ZN3ext6expand12expand_crate16_0617e35abd36c2b3_06E+0x519)[0xb6f9d809]\n/usr/local/bin/../lib/librustc-c84825241471686d-0.6.so(+0x9b0fa3)[0xb6aecfa3]\n/usr/local/bin/../lib/librustc-c84825241471686d-0.6.so(+0x9b0cd6)[0xb6aeccd6]\n/usr/local/bin/../lib/librustc-c84825241471686d-0.6.so(_ZN6driver6driver12compile_rest17_e2303c892cd986993_06E+0x427)[0xb6ae7a47]\n/usr/local/bin/../lib/librustc-c84825241471686d-0.6.so(+0x9f4948)[0xb6b30948]\n/usr/local/bin/../lib/librustc-c84825241471686d-0.6.so(_ZN6driver6driver12compile_upto17_53d5fe10f23736583_06E+0x103)[0xb6aee483]\n/usr/local/bin/../lib/librustc-c84825241471686d-0.6.so(_ZN6driver6driver13compile_input16_cb193093b7edf943_06E+0xb6)[0xb6aee986]\n/usr/local/bin/../lib/librustc-c84825241471686d-0.6.so(_ZN12run_compiler16_eaa16032bd226ca3_06E+0x22f6)[0xb6b1c5c6]\n/usr/local/bin/../lib/librustc-c84825241471686d-0.6.so(+0x9f46c2)[0xb6b306c2]\n/usr/local/bin/../lib/librustc-c84825241471686d-0.6.so(+0x9f1da9)[0xb6b2dda9]\n/usr/local/bin/../lib/librustc-c84825241471686d-0.6.so(+0x9edf95)[0xb6b29f95]\n/usr/local/bin/../lib/librustc-c84825241471686d-0.6.so(+0x9f4948)[0xb6b30948]\n/usr/local/bin/../lib/libcore-c3ca5d77d81b46c1-0.6.so(+0xbecfb)[0xb752fcfb]\n/usr/local/bin/../lib/libcore-c3ca5d77d81b46c1-0.6.so(+0x128dfc)[0xb7599dfc]\n/usr/local/bin/../lib/librustrt.so(_Z18task_start_wrapperP10spawn_args+0x31)[0xb60fbe01]\nerror: internal compiler error: unexpected failure\nnote: the compiler hit an unexpected failure path. this is a bug\nnote: try running with RUST_LOG=rustc=1,::rt::backtrace to get further details and report the results to github.com/mozilla/rust/issues\nrust: task failed at 'explicit failure', /home/huon/Sources/rust/src/librustc/rustc.rc:364\n/usr/local/bin/../lib/librustrt.so(_ZN9rust_task13begin_failureEPKcS1_j+0x5a)[0xb60fb4aa]\n/usr/local/bin/../lib/librustrt.so(rust_task_fail+0x36)[0xb60fb5a6]\n/usr/local/bin/../lib/librustrt.so(_ZN9rust_task4failEPKcS1_j+0x32)[0xb60fb612]\n/usr/local/bin/../lib/librustrt.so(upcall_s_fail+0x53)[0xb60fce03]\n/usr/local/bin/../lib/librustrt.so(+0x2b42f)[0xb610d42f]\n/usr/local/bin/../lib/librustrt.so(upcall_fail+0x164)[0xb60fd434]\n/usr/local/bin/../lib/librustrt.so(rust_upcall_fail+0x2b)[0xb60fd57b]\n/usr/local/bin/../lib/libcore-c3ca5d77d81b46c1-0.6.so(_ZN3sys6rustrt16rust_upcall_fail17_2b2e25ba94c412183_06E+0x45)[0xb7565af5]\n/usr/local/bin/../lib/libcore-c3ca5d77d81b46c1-0.6.so(+0xf4b9b)[0xb7565b9b]\n/usr/local/bin/../lib/libcore-c3ca5d77d81b46c1-0.6.so(+0xf4b4d)[0xb7565b4d]\n/usr/local/bin/../lib/libcore-c3ca5d77d81b46c1-0.6.so(_ZN3sys12begin_unwind17_7cd364c41f10422f3_06E+0x73)[0xb74ab3a3]\n/usr/local/bin/../lib/libcore-c3ca5d77d81b46c1-0.6.so(+0x128dfc)[0xb7599dfc]\n/usr/local/bin/../lib/librustc-c84825241471686d-0.6.so(_ZN7monitor17_7080afcd4921ea1e3_06E+0x2a3d)[0xb6b2016d]\n/usr/local/bin/../lib/librustc-c84825241471686d-0.6.so(+0x9f4948)[0xb6b30948]\n/usr/local/bin/../lib/librustc-c84825241471686d-0.6.so(_ZN4main16_706f4ee7413ae583_06E+0x7e)[0xb6b305de]\nrustc(_rust_main+0x31)[0x8048a91]\n/usr/local/bin/../lib/librustrt.so(_Z18task_start_wrapperP10spawn_args+0x31)[0xb60fbe01]\nrust: domain main @0x9d6d380 root task failed\n```\n", "closed_by": {"login": "jbclements", "id": 226617, "node_id": "MDQ6VXNlcjIyNjYxNw==", "avatar_url": "https://avatars.githubusercontent.com/u/226617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jbclements", "html_url": "https://github.com/jbclements", "followers_url": "https://api.github.com/users/jbclements/followers", "following_url": "https://api.github.com/users/jbclements/following{/other_user}", "gists_url": "https://api.github.com/users/jbclements/gists{/gist_id}", "starred_url": "https://api.github.com/users/jbclements/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jbclements/subscriptions", "organizations_url": "https://api.github.com/users/jbclements/orgs", "repos_url": "https://api.github.com/users/jbclements/repos", "events_url": "https://api.github.com/users/jbclements/events{/privacy}", "received_events_url": "https://api.github.com/users/jbclements/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/5218/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/5218/timeline", "performed_via_github_app": null, "state_reason": "completed"}