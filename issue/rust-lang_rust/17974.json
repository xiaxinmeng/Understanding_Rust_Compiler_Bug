{"url": "https://api.github.com/repos/rust-lang/rust/issues/17974", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/17974/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/17974/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/17974/events", "html_url": "https://github.com/rust-lang/rust/issues/17974", "id": 45582367, "node_id": "MDU6SXNzdWU0NTU4MjM2Nw==", "number": 17974, "title": "Calling function with bad signature, Rust 0.13.0-nightly", "user": {"login": "alexispurslane", "id": 1920151, "node_id": "MDQ6VXNlcjE5MjAxNTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1920151?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexispurslane", "html_url": "https://github.com/alexispurslane", "followers_url": "https://api.github.com/users/alexispurslane/followers", "following_url": "https://api.github.com/users/alexispurslane/following{/other_user}", "gists_url": "https://api.github.com/users/alexispurslane/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexispurslane/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexispurslane/subscriptions", "organizations_url": "https://api.github.com/users/alexispurslane/orgs", "repos_url": "https://api.github.com/users/alexispurslane/repos", "events_url": "https://api.github.com/users/alexispurslane/events{/privacy}", "received_events_url": "https://api.github.com/users/alexispurslane/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2014-10-12T15:01:27Z", "updated_at": "2014-10-14T14:02:16Z", "closed_at": "2014-10-14T14:02:16Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "So, i am compileing a version of rustboot that uses some changes that someone else had made so that it could display text on the screen, but when I compile I get this:\n\n```\nrustc: /home/rustbuild/src/rust-buildbot/slave/nightly-linux/build/src/llvm/lib/IR/Instructions.cpp:276: void llvm::CallInst::init(llvm::Value*, llvm::ArrayRef<llvm::Value*>, const llvm::Twine&): Assertion `(Args.size() == FTy->getNumParams() || (FTy->isVarArg() && Args.size() > FTy->getNumParams())) && \"Calling a function with bad signature!\"' failed.\nmake: *** [main.o] Aborted (core dumped)\n```\n\ni have checked all the other issues about this, but none of them have helped. My code looks like this:\n\n``` rust\n#![no_std]\n#![allow(ctypes)]\n#![feature(lang_items)]\n\n#[allow(dead_code)]\nenum Color {\n    Black      = 0,\n    Blue       = 1,\n    Green      = 2,\n    Cyan       = 3,\n    Red        = 4,\n    Pink       = 5,\n    Brown      = 6,\n    LightGray  = 7,\n    DarkGray   = 8,\n    LightBlue  = 9,\n    LightGreen = 10,\n    LightCyan  = 11,\n    LightRed   = 12,\n    LightPink  = 13,\n    Yellow     = 14,\n    White      = 15,\n}\n\nenum DisplayInfo {\n    VGAWIDTH = 80,\n    VGAHEIGHT = 25,\n    VGAADDRESS = 0xb8000,\n}\n\n#[lang=\"sized\"]\nfn clear_screen(background: Color) {\n    let limit = 80u * 25u;\n    let mut i = 0u;\n    while i < limit {\n        unsafe {\n            *((VGAADDRESS as u16 + i as u16 * 2) as *mut u16) = (background as u16) << 12;\n        }\n        i += 1;\n    }\n}\n\nfn make_vgaentry(c: u8, fg: Color, bg: Color) -> u16 {\n    let color = fg as u16 | (bg as u16 << 4);\n    c as u16 | (color << 8)\n}\npub fn putc(x: u16, y: u16, c: u8) {\n    let idx: uint = (y * VGAWIDTH as u16 * 2 + x * 2) as uint;\n    unsafe {\n        *((VGAADDRESS as u16 + idx as u16) as *mut u16) = make_vgaentry(c, Green, Black)\n    }\n}\n\n#[lang=\"fail_bounds_check\"]\npub fn write_x_y(s: &[u8], x: u16, y: u16, len: uint) {\n    let mut i = 0u;\n    while i < len {\n        putc(x + i as u16, y, s[i]);\n        i += 1;\n    }\n}\n\n\n#[no_mangle]\n#[no_split_stack]\npub fn main() {\n    clear_screen(Black);\n    let prompt = b\"==> \";\n    write_x_y(prompt, 2, 3, 4);\n}\n```\n\nI am fairly new to rust, and pretty much copy-and-pasteing stuff in. You will notice I cannot program very rust-idiomaticly becouse I have  to do without the standard library, and cannot compile libcore for i386-intel-linux, which is what the loader assembly code is written for.\n", "closed_by": {"login": "thestinger", "id": 1505226, "node_id": "MDQ6VXNlcjE1MDUyMjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thestinger", "html_url": "https://github.com/thestinger", "followers_url": "https://api.github.com/users/thestinger/followers", "following_url": "https://api.github.com/users/thestinger/following{/other_user}", "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}", "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions", "organizations_url": "https://api.github.com/users/thestinger/orgs", "repos_url": "https://api.github.com/users/thestinger/repos", "events_url": "https://api.github.com/users/thestinger/events{/privacy}", "received_events_url": "https://api.github.com/users/thestinger/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/17974/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/17974/timeline", "performed_via_github_app": null, "state_reason": "completed"}