{"url": "https://api.github.com/repos/rust-lang/rust/issues/94815", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/94815/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/94815/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/94815/events", "html_url": "https://github.com/rust-lang/rust/issues/94815", "id": 1165594836, "node_id": "I_kwDOAAsO6M5FeZDU", "number": 94815, "title": "Please default \"force-unwind-tables\" to \"yes\" on Linux, so that unwind tables are present even if panic = \"abort\"", "user": {"login": "mstange", "id": 961291, "node_id": "MDQ6VXNlcjk2MTI5MQ==", "avatar_url": "https://avatars.githubusercontent.com/u/961291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mstange", "html_url": "https://github.com/mstange", "followers_url": "https://api.github.com/users/mstange/followers", "following_url": "https://api.github.com/users/mstange/following{/other_user}", "gists_url": "https://api.github.com/users/mstange/gists{/gist_id}", "starred_url": "https://api.github.com/users/mstange/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mstange/subscriptions", "organizations_url": "https://api.github.com/users/mstange/orgs", "repos_url": "https://api.github.com/users/mstange/repos", "events_url": "https://api.github.com/users/mstange/events{/privacy}", "received_events_url": "https://api.github.com/users/mstange/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 36953, "node_id": "MDU6TGFiZWwzNjk1Mw==", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-runtime", "name": "A-runtime", "color": "f7e101", "default": false, "description": "Area: std's runtime and \"pre-main\" init for handling backtraces, unwinds, stack overflows"}, {"id": 234902, "node_id": "MDU6TGFiZWwyMzQ5MDI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-enhancement", "name": "C-enhancement", "color": "f5f1fd", "default": false, "description": "Category: An issue proposing an enhancement or a PR with one."}, {"id": 234956, "node_id": "MDU6TGFiZWwyMzQ5NTY=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-codegen", "name": "A-codegen", "color": "f7e101", "default": false, "description": "Area: Code generation"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-03-10T18:46:57Z", "updated_at": "2023-05-23T13:36:02Z", "closed_at": null, "author_association": "NONE", "active_lock_reason": null, "body": "On Linux, binaries need to contain unwind tables if one wants to get useful and accurate stack traces in profilers, debuggers and crash reports,. This requirement is mostly due to the fact that the Rust compiler, by default, does not use frame pointers on Linux.\r\n\r\nWhen `panic` is set to `\"unwind\"` (the default), the Rust compiler emits unwind tables for all functions. This is good.\r\n\r\nHowever, when building with `panic = \"abort\"`, the Rust compiler currently does not emit unwind tables for many functions. For example, a Linux x86_64 build of [dump_syms](https://github.com/mozilla/dump_syms/) with `panic = \"abort\"` has unwind tables for 5017 functions with the default settings, and for 9204 functions with `-C force-unwind-tables=yes`. The generated code for both builds is identical.\r\n\r\nI think `force-unwind-tables=yes` would be a better default. It does not make the generated code any less efficient; it only generates extra information on the side. People who are concerned about binary size and who do not need useful stack traces can still make the trade-off and set `-C force-unwind-tables=no`.\r\n\r\nThis problem was also encountered in https://github.com/rust-lang/backtrace-rs/issues/397 and in https://github.com/rust-lang/rust/issues/81902.", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/94815/reactions", "total_count": 6, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 4, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/94815/timeline", "performed_via_github_app": null, "state_reason": null}