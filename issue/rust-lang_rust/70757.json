{"url": "https://api.github.com/repos/rust-lang/rust/issues/70757", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/70757/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/70757/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/70757/events", "html_url": "https://github.com/rust-lang/rust/issues/70757", "id": 593755467, "node_id": "MDU6SXNzdWU1OTM3NTU0Njc=", "number": 70757, "title": "rustdoc's treatment of cross-crate (\"imported\") files is suboptimal.", "user": {"login": "eddyb", "id": 77424, "node_id": "MDQ6VXNlcjc3NDI0", "avatar_url": "https://avatars.githubusercontent.com/u/77424?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eddyb", "html_url": "https://github.com/eddyb", "followers_url": "https://api.github.com/users/eddyb/followers", "following_url": "https://api.github.com/users/eddyb/following{/other_user}", "gists_url": "https://api.github.com/users/eddyb/gists{/gist_id}", "starred_url": "https://api.github.com/users/eddyb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eddyb/subscriptions", "organizations_url": "https://api.github.com/users/eddyb/orgs", "repos_url": "https://api.github.com/users/eddyb/repos", "events_url": "https://api.github.com/users/eddyb/events{/privacy}", "received_events_url": "https://api.github.com/users/eddyb/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 203738, "node_id": "MDU6TGFiZWwyMDM3Mzg=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-rustdoc", "name": "T-rustdoc", "color": "bfd4f2", "default": false, "description": "Relevant to the rustdoc team, which will review and decide on the PR/issue."}, {"id": 234902, "node_id": "MDU6TGFiZWwyMzQ5MDI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-enhancement", "name": "C-enhancement", "color": "f5f1fd", "default": false, "description": "Category: An issue proposing an enhancement or a PR with one."}], "state": "open", "locked": false, "assignee": {"login": "ollie27", "id": 7189418, "node_id": "MDQ6VXNlcjcxODk0MTg=", "avatar_url": "https://avatars.githubusercontent.com/u/7189418?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ollie27", "html_url": "https://github.com/ollie27", "followers_url": "https://api.github.com/users/ollie27/followers", "following_url": "https://api.github.com/users/ollie27/following{/other_user}", "gists_url": "https://api.github.com/users/ollie27/gists{/gist_id}", "starred_url": "https://api.github.com/users/ollie27/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ollie27/subscriptions", "organizations_url": "https://api.github.com/users/ollie27/orgs", "repos_url": "https://api.github.com/users/ollie27/repos", "events_url": "https://api.github.com/users/ollie27/events{/privacy}", "received_events_url": "https://api.github.com/users/ollie27/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ollie27", "id": 7189418, "node_id": "MDQ6VXNlcjcxODk0MTg=", "avatar_url": "https://avatars.githubusercontent.com/u/7189418?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ollie27", "html_url": "https://github.com/ollie27", "followers_url": "https://api.github.com/users/ollie27/followers", "following_url": "https://api.github.com/users/ollie27/following{/other_user}", "gists_url": "https://api.github.com/users/ollie27/gists{/gist_id}", "starred_url": "https://api.github.com/users/ollie27/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ollie27/subscriptions", "organizations_url": "https://api.github.com/users/ollie27/orgs", "repos_url": "https://api.github.com/users/ollie27/repos", "events_url": "https://api.github.com/users/ollie27/events{/privacy}", "received_events_url": "https://api.github.com/users/ollie27/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2020-04-04T06:17:23Z", "updated_at": "2020-08-27T02:42:10Z", "closed_at": null, "author_association": "MEMBER", "active_lock_reason": null, "body": "@bjorn3 noted in https://github.com/rust-lang/rust/issues/70025#issuecomment-606566181 that single files missing disables `[src]` links for *the entire crate*.\r\nThat's not ideal UX, we should render as many source files as we can possible load.\r\n\r\n<hr/>\r\n\r\nAnd there's also the paths `rustdoc` uses (see https://github.com/rust-lang/rust/issues/70025#issuecomment-607699347), e.g.:\r\n* https://doc.rust-lang.org/nightly/nightly-rustc/rustc_span/def_id/struct.CrateId.html\r\n  * links to https://doc.rust-lang.org/nightly/nightly-rustc/src/rustc_span/checkout/src/librustc_index/vec.rs.html#110-112\r\n  * but it should use https://doc.rust-lang.org/nightly/nightly-rustc/src/rustc_index/vec.rs.html#110-112\r\n\r\nIf we use the `CrateNum` of the original source file and reuse the existing `rustdoc` logic to get the relative path of that file in that crate, *I believe* we can even support linking to the source correctly even when the *absolute* paths are not usable (e.g. `/rustc/$hash/src/libstd/thread/local.rs` when using `thread_local!` and the `rust-src` `rustup` component isn't installed)\r\n\r\nBecause the downstream crate uses an exported macro from the original crate, the rendered source file should always have been generated, so we should never really need to re-generate it.\r\n\r\ncc @rust-lang/rustdoc @Aaron1011 ", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/70757/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/70757/timeline", "performed_via_github_app": null, "state_reason": null}