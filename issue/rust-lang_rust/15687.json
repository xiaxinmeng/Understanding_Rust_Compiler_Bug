{"url": "https://api.github.com/repos/rust-lang/rust/issues/15687", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/15687/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/15687/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/15687/events", "html_url": "https://github.com/rust-lang/rust/issues/15687", "id": 37902389, "node_id": "MDU6SXNzdWUzNzkwMjM4OQ==", "number": 15687, "title": "covariant method return types on trait impls?", "user": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 37544, "node_id": "MDU6TGFiZWwzNzU0NA==", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-typesystem", "name": "A-typesystem", "color": "f7e101", "default": false, "description": "Area: The type system"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2014-07-15T16:41:37Z", "updated_at": "2016-03-07T20:25:51Z", "closed_at": "2016-03-07T20:25:51Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Do trait method signatures have to match exactly, or is there some subtyping relationship that is supposed to hold between an impl's methods and the methods of the trait definition itself?\n\nIf there is a subtyping relationship, then I would expect the following to compile:\n\n``` rust\n#![crate_type=\"lib\"]\n\n// illustrating subtype relationship: typeof(g) <: typeof(f) ...\nfn foo<'a,'b>(ignored: Option<&'a &'b ()>, f: || -> &'a int) { unimplemented!() }\nfn bar<'a,'b>(ignored: Option<&'a &'b ()>, g: || -> &'b int) { foo(ignored, g) }\n\n// ... but does that subtype relationship apply to the return types here?\ntrait T       { fn m<'a,'b>(self, ignored: Option<&'a &'b ()>) -> &'a int; }\nimpl T for () { fn m<'a,'b>(self, ignored: Option<&'a &'b ()>) -> &'b int { unimplemented!() } }\n```\n\n(it currently does not compile; it complains of the mismatch between the lifetime parameters.)\n\nIf there is _not_ a subtyping relationship, then I would not expect the following to compile:\n\n``` rust\n#![crate_type=\"lib\"]\n\ntrait T<'a>                       { fn m(&'a self) -> &'a int; }\nimpl<'ignored> T<'ignored> for () { fn m<'a>(&'a self) -> &'a int { unimplemented!() } }\n```\n\n(it currently does compile.)\n\nNote that the latter case seems sound to me, but the fact that this works in the latter case but does not for the former case just makes me worry about what the rules actually are that we are enforcing with respect to how much an `impl` needs to conform with its corresponding `trait`.\n", "closed_by": {"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/15687/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/15687/timeline", "performed_via_github_app": null, "state_reason": "completed"}