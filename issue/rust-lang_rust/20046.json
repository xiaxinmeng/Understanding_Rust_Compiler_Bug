{"url": "https://api.github.com/repos/rust-lang/rust/issues/20046", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/20046/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/20046/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/20046/events", "html_url": "https://github.com/rust-lang/rust/issues/20046", "id": 52527350, "node_id": "MDU6SXNzdWU1MjUyNzM1MA==", "number": 20046, "title": "error: internal compiler error: adt::represent_type called on non-ADT type: &std ::io::IoError", "user": {"login": "evmar", "id": 3847, "node_id": "MDQ6VXNlcjM4NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/3847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/evmar", "html_url": "https://github.com/evmar", "followers_url": "https://api.github.com/users/evmar/followers", "following_url": "https://api.github.com/users/evmar/following{/other_user}", "gists_url": "https://api.github.com/users/evmar/gists{/gist_id}", "starred_url": "https://api.github.com/users/evmar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/evmar/subscriptions", "organizations_url": "https://api.github.com/users/evmar/orgs", "repos_url": "https://api.github.com/users/evmar/repos", "events_url": "https://api.github.com/users/evmar/events{/privacy}", "received_events_url": "https://api.github.com/users/evmar/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2014-12-19T20:53:04Z", "updated_at": "2016-08-04T18:05:57Z", "closed_at": "2016-08-04T18:05:57Z", "author_association": "NONE", "active_lock_reason": null, "body": "```\n   Compiling sha1sum v0.0.1 (file:///home/evanm/projects/rust/sha1sum)\nerror: internal compiler error: adt::represent_type called on non-ADT type: &std::io::IoError\nnote: the compiler unexpectedly panicked. this is a bug.\nnote: we would appreciate a bug report: http://doc.rust-lang.org/complement-bugreport.html\nnote: run with `RUST_BACKTRACE=1` for a backtrace\ntask 'rustc' panicked at 'Box<Any>', /home/rustbuild/src/rust-buildbot/slave/nightly-linux/build/src/libsyntax/diagnostic.rs:188\n\nstack backtrace:\n   1:     0x7f5eb2c9af10 - rt::backtrace::imp::write::h28b8bbd9f503cf471Xx\n   2:     0x7f5eb2c9e570 - failure::on_fail::hd0a2ddc03e0fa8a6opy\n   3:     0x7f5eb28de6a0 - unwind::begin_unwind_inner::hedcb21b2885493daaNc\n   4:     0x7f5eaff927e0 - unwind::begin_unwind::h14053085834319754591\n   5:     0x7f5eaff93090 - diagnostic::Handler::bug::h88688dedb903e5ddeRF\n   6:     0x7f5eb0ce1250 - session::Session::bug::hc1287fe1a705e6adSLu\n   7:     0x7f5eb18261f0 - trans::adt::represent_type_uncached::he6675fb263092d5deMH\n   8:     0x7f5eb1710530 - trans::adt::represent_type::hd46d360c5fae4210nIH\n   9:     0x7f5eb17c2fc0 - trans::_match::compile_submatch_continue::hba348eef0dad30a0a2w\n  10:     0x7f5eb17c0ab0 - trans::_match::compile_submatch::h908579cfdcf3da5fxWw\n  11:     0x7f5eb17c2fc0 - trans::_match::compile_submatch_continue::hba348eef0dad30a0a2w\n  12:     0x7f5eb17c0ab0 - trans::_match::compile_submatch::h908579cfdcf3da5fxWw\n  13:     0x7f5eb17c7b10 - trans::_match::trans_match_inner::h4dfb82c4024d7437svx\n  14:     0x7f5eb173b930 - trans::expr::trans_rvalue_dps_unadjusted::h1c34ba6d0fbc42abX8i\n  15:     0x7f5eb16f7500 - trans::expr::trans_into::hea40bf13dbc784e8sFh\n  16:     0x7f5eb16f6910 - trans::controlflow::trans_stmt_semi::h5ed64e36e117a6c8PYd\n  17:     0x7f5eb16f7c60 - trans::controlflow::trans_block::h61d649e79c6d3e91IZd\n  18:     0x7f5eb17408e0 - trans::expr::trans_rvalue_stmt_unadjusted::hdd4f67405c596af0e3i\n  19:     0x7f5eb16f7500 - trans::expr::trans_into::hea40bf13dbc784e8sFh\n  20:     0x7f5eb16f7c60 - trans::controlflow::trans_block::h61d649e79c6d3e91IZd\n  21:     0x7f5eb17a6660 - trans::base::trans_closure::h4a257820d48920f5P8t\n  22:     0x7f5eb16ec1d0 - trans::base::trans_fn::he64630405a744a1c6ju\n  23:     0x7f5eb16e7850 - trans::base::trans_item::hedeca6906d42d5ef8Eu\n  24:     0x7f5eb17ae5d0 - trans::base::trans_crate::h409f313f53dd00d1jBv\n  25:     0x7f5eb30ff090 - driver::phase_4_translate_to_llvm::ha3e95ae8dd99774cXCa\n  26:     0x7f5eb30d5ee0 - driver::compile_input::h3c93a433de329ec1rba\n  27:     0x7f5eb328a020 - run_compiler::h6520470d7d92765aAYb\n  28:     0x7f5eb3280c60 - thunk::F.Invoke<A,$u{20}R$GT$::invoke::h1449879172494822488\n  29:     0x7f5eb2c732c0 - thunk::F.Invoke<A,$u{20}R$GT$::invoke::h14525951389403266713\n  30:     0x7f5eb28dce10 - task::Task::spawn_thunk::closure.5804\n  31:     0x7f5eb293b9b0 - rust_try_inner\n  32:     0x7f5eb293b9a0 - rust_try\n  33:     0x7f5eb28dcf20 - unwind::try::h870bc6c90527a031rCc\n  34:     0x7f5eb28dccb0 - task::Task::run::h3063eac886af1b39tNb\n  35:     0x7f5eb28dc420 - thunk::F.Invoke<A,$u{20}R$GT$::invoke::h6184366571468466973\n  36:     0x7f5eb28ddd70 - thread::thread_start::h6cf2d96de299983bM4b\n  37:     0x7f5ead3f30c0 - start_thread\n  38:     0x7f5eb25a0ec9 - __clone\n  39:                0x0 - <unknown>\n\nCould not compile `sha1sum`.\n\nTo learn more, run the command again with --verbose.\n```\n\nReduced code, with the line causing the ICE marked in a comment:\n\n``` rust\nuse std::io;\n\nfn main() {\n    let mut stdinx = io::stdio::stdin();\n    let mut stdin = stdinx.lock();\n    loop {\n        match stdin.fill_buf() {\n            Ok(_) => true,\n            Err(ref e) if e.kind == io::EndOfFile => break,\n            // *** I added the following line, seeing whether I could pattern\n            // match instead of use a guard, and that produced the error.\n            Err(io::IoError { kind: io::EndOfFile, ..}) => break,\n            Err(err) => panic!(err)\n        };\n    }\n}\n```\n", "closed_by": {"login": "steveklabnik", "id": 27786, "node_id": "MDQ6VXNlcjI3Nzg2", "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/steveklabnik", "html_url": "https://github.com/steveklabnik", "followers_url": "https://api.github.com/users/steveklabnik/followers", "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}", "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}", "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions", "organizations_url": "https://api.github.com/users/steveklabnik/orgs", "repos_url": "https://api.github.com/users/steveklabnik/repos", "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}", "received_events_url": "https://api.github.com/users/steveklabnik/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/20046/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/20046/timeline", "performed_via_github_app": null, "state_reason": "completed"}