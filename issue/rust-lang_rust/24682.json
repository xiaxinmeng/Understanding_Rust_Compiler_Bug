{"url": "https://api.github.com/repos/rust-lang/rust/issues/24682", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/24682/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/24682/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/24682/events", "html_url": "https://github.com/rust-lang/rust/issues/24682", "id": 70029998, "node_id": "MDU6SXNzdWU3MDAyOTk5OA==", "number": 24682, "title": "Internal compile error when adding sized constain with assoicated type", "user": {"login": "magast-io", "id": 7028529, "node_id": "MDQ6VXNlcjcwMjg1Mjk=", "avatar_url": "https://avatars.githubusercontent.com/u/7028529?v=4", "gravatar_id": "", "url": "https://api.github.com/users/magast-io", "html_url": "https://github.com/magast-io", "followers_url": "https://api.github.com/users/magast-io/followers", "following_url": "https://api.github.com/users/magast-io/following{/other_user}", "gists_url": "https://api.github.com/users/magast-io/gists{/gist_id}", "starred_url": "https://api.github.com/users/magast-io/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/magast-io/subscriptions", "organizations_url": "https://api.github.com/users/magast-io/orgs", "repos_url": "https://api.github.com/users/magast-io/repos", "events_url": "https://api.github.com/users/magast-io/events{/privacy}", "received_events_url": "https://api.github.com/users/magast-io/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}, {"id": 149689562, "node_id": "MDU6TGFiZWwxNDk2ODk1NjI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-associated-items", "name": "A-associated-items", "color": "f7e101", "default": false, "description": "Area: Associated items such as associated types and consts."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2015-04-22T05:35:38Z", "updated_at": "2015-09-14T08:33:25Z", "closed_at": "2015-09-14T08:33:25Z", "author_association": "NONE", "active_lock_reason": null, "body": "Adding a sized constraint to a trait caused an internal compile error. \n\nI tried this code:\n\n```\ntrait A: Sized {\n    type N:One;\n    fn new(x:Self::N) -> Self;\n\n    fn x() -> Self<N=Self::N> {\n        Self::new(Self::N::one())\n    }\n}\n\ntrait One {\n    fn one() -> Self;\n}\n\nimpl One for i32 {\n    fn one() -> i32 {\n        1i32\n    }\n}\n\nimpl A for B {\n    type N = i32;\n     fn new(x:i32) -> B {\n        B { x: x }\n    }\n}\n\nstruct B {\n    x:i32\n}\n\nfn main() {\n    let b = B::new(5i32);\n    println!(\"b.x: {}\", b.x )\n}\n```\n\nRemoving the sized constraint from `A` no longer as a internal compile error, and fails to compile with the error  \n\n```\nsized_trait.rs:5:15: 5:30 error: the trait `core::marker::Sized` is not implemented for the type `Self` [E0277]\nsized_trait.rs:5     fn x() -> Self<N=Self::N> {\n^\nsized_trait.rs:5:15: 5:30 note: `Self` does not have a constant size known at compile-time\nsized_trait.rs:5     fn x() -> Self<N=Self::N> {\n^\nerror: aborting due to previous error\n```\n\nRemoving `fn x() -> Self<N=Self::N>` from `trait A` causes a successful compile. \n## Meta\n\n`rustc --version --verbose`:\nrustc 1.0.0-beta.2 (e9080ec39 2015-04-16) (built 2015-04-16)\nbinary: rustc\ncommit-hash: e9080ec39d9a44eb0773d648b348575b19f655e5\ncommit-date: 2015-04-16\nbuild-date: 2015-04-16\nhost: x86_64-unknown-linux-gnu\nrelease: 1.0.0-beta.2\n\nBacktrace:\n\n```\nerror: internal compiler error: unexpected panic\nnote: the compiler unexpectedly panicked. this is a bug.\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports\nnote: run with `RUST_BACKTRACE=1` for a backtrace\nthread 'rustc' panicked at 'path not fully resolved: PathResolution { base_def: DefSelfTy(Some(DefId { krate: 0, node: 4 }), None), last_private: LastMod(AllPublic), depth: 1 }', /home/rustbuild/src/rust-buildbot/slave/beta-dist-rustc-linux/build/src/librustc/middle/def.rs:80\n```\n\nstack backtrace:\n   1:     0x7f4ce4435439 - sys::backtrace::write::he2e34ba2c33dc0e30Us\n   2:     0x7f4ce443d0f6 - panicking::on_panic::hc9625174f6ab8ee8fix\n   3:     0x7f4ce43fb182 - rt::unwind::begin_unwind_inner::h3ab4e1f5d89ab81bpXw\n   4:     0x7f4ce43fb44c - rt::unwind::begin_unwind_fmt::haff11c8aa28ec8b23Vw\n   5:     0x7f4ce2271db6 - middle::def::PathResolution::full_def::h74a01ccebde3cb12mZl\n   6:     0x7f4ce3897e4e - PrivacyVisitor<'a, 'tcx>::check_path::h7dab5d16c75af8c4X4a\n   7:     0x7f4ce3898ed7 - PrivacyVisitor<'a, 'tcx>.Visitor<'v>::visit_path::hb9a2f24773dbb8d9ctb\n   8:     0x7f4ce3899022 - visit::walk_path::h7066235731909768411\n   9:     0x7f4ce389aa99 - visit::Visitor::visit_fn::h17785043978168098476\n  10:     0x7f4ce389b5da - visit::walk_trait_item::h1977003431506782162\n  11:     0x7f4ce3898d7f - PrivacyVisitor<'a, 'tcx>.Visitor<'v>::visit_item::hf1bd234520341cbexdb\n  12:     0x7f4ce389f7fb - check_crate::hb8e3f1bb5ec19bf6EVb\n  13:     0x7f4ce499bfc3 - driver::phase_3_run_analysis_passes::h5a432074c589df71nGa\n  14:     0x7f4ce497ccf5 - driver::compile_input::h534dde66bedcbe27Qba\n  15:     0x7f4ce4a3d561 - run_compiler::hcc529c6d73620eadz4b\n  16:     0x7f4ce4a3b1b2 - boxed::F.FnBox<A>::call_box::h8768627190356120502\n  17:     0x7f4ce4a3a6e9 - rt::unwind::try::try_fn::h4698797487832078877\n  18:     0x7f4ce44b4018 - rust_try_inner\n  19:     0x7f4ce44b4005 - rust_try\n  20:     0x7f4ce4a3a998 - boxed::F.FnBox<A>::call_box::h562643224173615142\n  21:     0x7f4ce443bfe1 - sys::thread::create::thread_start::he373f01c0b872a8fwgw\n  22:     0x7f4cdeccc181 - start_thread\n  23:     0x7f4ce407547c - __clone\n  24:                0x0 - <unknown>\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/24682/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/24682/timeline", "performed_via_github_app": null, "state_reason": "completed"}