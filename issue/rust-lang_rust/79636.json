{"url": "https://api.github.com/repos/rust-lang/rust/issues/79636", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/79636/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/79636/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/79636/events", "html_url": "https://github.com/rust-lang/rust/issues/79636", "id": 755332307, "node_id": "MDU6SXNzdWU3NTUzMzIzMDc=", "number": 79636, "title": "Compiler panic during GAT type bound usage", "user": {"login": "snoyberg", "id": 49415, "node_id": "MDQ6VXNlcjQ5NDE1", "avatar_url": "https://avatars.githubusercontent.com/u/49415?v=4", "gravatar_id": "", "url": "https://api.github.com/users/snoyberg", "html_url": "https://github.com/snoyberg", "followers_url": "https://api.github.com/users/snoyberg/followers", "following_url": "https://api.github.com/users/snoyberg/following{/other_user}", "gists_url": "https://api.github.com/users/snoyberg/gists{/gist_id}", "starred_url": "https://api.github.com/users/snoyberg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/snoyberg/subscriptions", "organizations_url": "https://api.github.com/users/snoyberg/orgs", "repos_url": "https://api.github.com/users/snoyberg/repos", "events_url": "https://api.github.com/users/snoyberg/events{/privacy}", "received_events_url": "https://api.github.com/users/snoyberg/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}, {"id": 46741598, "node_id": "MDU6TGFiZWw0Njc0MTU5OA==", "url": "https://api.github.com/repos/rust-lang/rust/labels/E-needs-test", "name": "E-needs-test", "color": "02e10c", "default": false, "description": "Call for participation: writing correctness tests"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}, {"id": 1485960423, "node_id": "MDU6TGFiZWwxNDg1OTYwNDIz", "url": "https://api.github.com/repos/rust-lang/rust/labels/F-generic_associated_types", "name": "F-generic_associated_types", "color": "f9c0cc", "default": false, "description": "`#![feature(generic_associated_types)]` a.k.a. GATs"}, {"id": 1615551553, "node_id": "MDU6TGFiZWwxNjE1NTUxNTUz", "url": "https://api.github.com/repos/rust-lang/rust/labels/glacier", "name": "glacier", "color": "a5e2ff", "default": false, "description": "ICE tracked in rust-lang/glacier"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2020-12-02T14:41:18Z", "updated_at": "2021-04-22T07:47:06Z", "closed_at": "2021-04-22T07:47:06Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "### Code\r\n\r\n```Rust\r\n#![feature(generic_associated_types)]\r\n\r\ntrait Monad {\r\n    type Unwrapped;\r\n    type Wrapped<B>;\r\n\r\n    fn bind<B, F>(self, f: F) -> Self::Wrapped<B> {\r\n        todo!()\r\n    }\r\n}\r\n\r\nfn join<MOuter, MInner, A>(outer: MOuter) -> MOuter::Wrapped<A>\r\nwhere\r\n    MOuter: Monad<Unwrapped = MInner>,\r\n    MInner: Monad<Unwrapped = A, Wrapped = MOuter::Wrapped<A>>,\r\n{\r\n    outer.bind(|inner| inner)\r\n}\r\n\r\nfn main() {\r\n    assert_eq!(join(Some(Some(true))), Some(true));\r\n}\r\n```\r\n\r\n\r\n### Meta\r\n<!--\r\nIf you're using the stable version of the compiler, you should also check if the\r\nbug also exists in the beta or nightly versions.\r\n-->\r\n\r\n\r\n`rustc --version --verbose`:\r\n```\r\nrustc 1.50.0-nightly (b7ebc6b0c 2020-11-30)\r\nbinary: rustc\r\ncommit-hash: b7ebc6b0c1ba3c27ebb17c0b496ece778ef11e18\r\ncommit-date: 2020-11-30\r\nhost: x86_64-pc-windows-msvc\r\nrelease: 1.50.0-nightly\r\n```\r\n\r\n### Error output\r\n\r\n```\r\nwarning: the feature `generic_associated_types` is incomplete and may not be safe to use and/or cause compiler crashes\r\n --> join.rs:1:12\r\n  |\r\n1 | #![feature(generic_associated_types)]\r\n  |            ^^^^^^^^^^^^^^^^^^^^^^^^\r\n  |\r\n  = note: `#[warn(incomplete_features)]` on by default\r\n  = note: see issue #44265 <https://github.com/rust-lang/rust/issues/44265> for more information\r\n\r\nerror: internal compiler error: compiler\\rustc_middle\\src\\ty\\subst.rs:529:17: type parameter `B/#1` (B/1) out of range when substituting, substs=[MInner]\r\n\r\nthread 'rustc' panicked at 'Box<Any>', /rustc/b7ebc6b0c1ba3c27ebb17c0b496ece778ef11e18\\compiler\\rustc_errors\\src\\lib.rs:904:9\r\nstack backtrace:\r\nnote: Some details are omitted, run with `RUST_BACKTRACE=full` for a verbose backtrace.\r\n\r\nnote: the compiler unexpectedly panicked. this is a bug.\r\n\r\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/issues/new?labels=C-bug%2C+I-ICE%2C+T-compiler&template=ice.md\r\n\r\nnote: rustc 1.50.0-nightly (b7ebc6b0c 2020-11-30) running on x86_64-pc-windows-msvc\r\n\r\nquery stack during panic:\r\n#0 [check_item_well_formed] checking that `join` is well-formed\r\n#1 [analysis] running analysis passes on this crate\r\nend of query stack\r\nerror: aborting due to previous error; 1 warning emitted\r\n```\r\n\r\n## Notes\r\n\r\nI recognize this is an unstable compiler feature, and have no problem if it would be better to just close this. Also, if it would be better to include this report elsewhere, please let me know.", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/79636/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/79636/timeline", "performed_via_github_app": null, "state_reason": "completed"}