{"url": "https://api.github.com/repos/rust-lang/rust/issues/21921", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/21921/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/21921/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/21921/events", "html_url": "https://github.com/rust-lang/rust/issues/21921", "id": 56469530, "node_id": "MDU6SXNzdWU1NjQ2OTUzMA==", "number": 21921, "title": "Warn/error about functions with huge stack frames", "user": {"login": "shadowmint", "id": 355760, "node_id": "MDQ6VXNlcjM1NTc2MA==", "avatar_url": "https://avatars.githubusercontent.com/u/355760?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shadowmint", "html_url": "https://github.com/shadowmint", "followers_url": "https://api.github.com/users/shadowmint/followers", "following_url": "https://api.github.com/users/shadowmint/following{/other_user}", "gists_url": "https://api.github.com/users/shadowmint/gists{/gist_id}", "starred_url": "https://api.github.com/users/shadowmint/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shadowmint/subscriptions", "organizations_url": "https://api.github.com/users/shadowmint/orgs", "repos_url": "https://api.github.com/users/shadowmint/repos", "events_url": "https://api.github.com/users/shadowmint/events{/privacy}", "received_events_url": "https://api.github.com/users/shadowmint/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 235137, "node_id": "MDU6TGFiZWwyMzUxMzc=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-lint", "name": "A-lint", "color": "f7e101", "default": false, "description": "Area: Lints (warnings about flaws in source code) such as unused_mut."}, {"id": 235791, "node_id": "MDU6TGFiZWwyMzU3OTE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-diagnostics", "name": "A-diagnostics", "color": "f7e101", "default": false, "description": "Area: Messages for errors, warnings, and lints"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2015-02-04T02:03:25Z", "updated_at": "2016-02-11T20:12:38Z", "closed_at": "2016-02-11T20:12:37Z", "author_association": "NONE", "active_lock_reason": null, "body": "I appreciate the issue here is that when you attempt to box a large fixed size array, it is first allocated on the stack, which overflows, before it can be moved onto the heap.\n\n```\nfn crashes() -> Box<[f32; 655360]> {\n  return Box::new([0f32; 655360]);\n}\nfn main() {\n  crashes();\n}\n```\n\nHowever, this causes a runtime failure; notice that the code above compiles and runs perfectly fine if you happen not to run `crashes`. This sort of 'only fails if you run certain functions' thing shouldn't exist in rust (I have python for that thanks).\n\nThe compiler should refuse to compile functions that will overflow the stack in this way, or at the very least lint that the stack size is smaller than the total size of allocated local top level elements in a function.  \n\nIn IRC a few people mentioned filing bugs about this before, but I can't find them, and certainly no open ones.\n", "closed_by": {"login": "steveklabnik", "id": 27786, "node_id": "MDQ6VXNlcjI3Nzg2", "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/steveklabnik", "html_url": "https://github.com/steveklabnik", "followers_url": "https://api.github.com/users/steveklabnik/followers", "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}", "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}", "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions", "organizations_url": "https://api.github.com/users/steveklabnik/orgs", "repos_url": "https://api.github.com/users/steveklabnik/repos", "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}", "received_events_url": "https://api.github.com/users/steveklabnik/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/21921/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/21921/timeline", "performed_via_github_app": null, "state_reason": "completed"}