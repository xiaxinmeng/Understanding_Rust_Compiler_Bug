{"url": "https://api.github.com/repos/rust-lang/rust/issues/79923", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/79923/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/79923/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/79923/events", "html_url": "https://github.com/rust-lang/rust/issues/79923", "id": 761799648, "node_id": "MDU6SXNzdWU3NjE3OTk2NDg=", "number": 79923, "title": "Long argsfile doesn't work properly on Windows", "user": {"login": "KapJI", "id": 3767331, "node_id": "MDQ6VXNlcjM3NjczMzE=", "avatar_url": "https://avatars.githubusercontent.com/u/3767331?v=4", "gravatar_id": "", "url": "https://api.github.com/users/KapJI", "html_url": "https://github.com/KapJI", "followers_url": "https://api.github.com/users/KapJI/followers", "following_url": "https://api.github.com/users/KapJI/following{/other_user}", "gists_url": "https://api.github.com/users/KapJI/gists{/gist_id}", "starred_url": "https://api.github.com/users/KapJI/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/KapJI/subscriptions", "organizations_url": "https://api.github.com/users/KapJI/orgs", "repos_url": "https://api.github.com/users/KapJI/repos", "events_url": "https://api.github.com/users/KapJI/events{/privacy}", "received_events_url": "https://api.github.com/users/KapJI/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 123109, "node_id": "MDU6TGFiZWwxMjMxMDk=", "url": "https://api.github.com/repos/rust-lang/rust/labels/O-windows", "name": "O-windows", "color": "6e6ec0", "default": false, "description": "Operating system: Windows"}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2020-12-11T02:18:08Z", "updated_at": "2021-11-01T03:09:36Z", "closed_at": null, "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Example: https://github.com/KapJI/rust_example\r\nCommands to repro: https://github.com/KapJI/rust_example/blob/main/test.sh\r\nExample CI job: https://github.com/KapJI/rust_example/runs/1534666156\r\n\r\nWith shorter argsfile it compiled correctly but longer one failed with\r\n```\r\nerror: cannot determine resolution for the import\r\n --> b/lib.rs:1:5\r\n  |\r\n1 | use a::A;\r\n  |     ^^^^\r\n  |\r\n  = note: import resolution is stuck, try simplifying other imports\r\n```\r\nwhich is very obscure and not really relevant.\r\n\r\nNote that I added many duplicated lines in argsfiles to demonstrate that it starts to fail after some threshold, actual content is not important. In the real project we have different lines for different dependencies.\r\n\r\nIf you comment\r\n```rust\r\npub trait SerdeWith<SerdeType> {\r\n    fn deserialize<'a, D: ::serde::Deserializer<'a>>(\r\n        deserializer: D,\r\n    ) -> Result<Self, D::Error>\r\n    where\r\n        Self: Sized;\r\n}\r\n```\r\nin `a/lib.rs` it will work in both cases. But this trait is actually not used in this example.\r\n\r\nAt some point I also got internal compiler error, not sure if it's relevant:\r\n```\r\nthread 'rustc' panicked at 'index out of bounds: the len is 236 but the index is 236', compiler\\rustc_codegen_ssa\\src\\back\\symbol_export.rs:292:13\r\n```", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/79923/reactions", "total_count": 4, "+1": 3, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 1}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/79923/timeline", "performed_via_github_app": null, "state_reason": null}