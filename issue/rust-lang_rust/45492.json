{"url": "https://api.github.com/repos/rust-lang/rust/issues/45492", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/45492/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/45492/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/45492/events", "html_url": "https://github.com/rust-lang/rust/issues/45492", "id": 268076205, "node_id": "MDU6SXNzdWUyNjgwNzYyMDU=", "number": 45492, "title": "binaries built in debug mode want to import __CxxFrameHandler3 ", "user": {"login": "Trolldemorted", "id": 10261186, "node_id": "MDQ6VXNlcjEwMjYxMTg2", "avatar_url": "https://avatars.githubusercontent.com/u/10261186?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Trolldemorted", "html_url": "https://github.com/Trolldemorted", "followers_url": "https://api.github.com/users/Trolldemorted/followers", "following_url": "https://api.github.com/users/Trolldemorted/following{/other_user}", "gists_url": "https://api.github.com/users/Trolldemorted/gists{/gist_id}", "starred_url": "https://api.github.com/users/Trolldemorted/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Trolldemorted/subscriptions", "organizations_url": "https://api.github.com/users/Trolldemorted/orgs", "repos_url": "https://api.github.com/users/Trolldemorted/repos", "events_url": "https://api.github.com/users/Trolldemorted/events{/privacy}", "received_events_url": "https://api.github.com/users/Trolldemorted/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 123109, "node_id": "MDU6TGFiZWwxMjMxMDk=", "url": "https://api.github.com/repos/rust-lang/rust/labels/O-windows", "name": "O-windows", "color": "6e6ec0", "default": false, "description": "Operating system: Windows"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2017-10-24T15:23:54Z", "updated_at": "2019-03-07T15:45:18Z", "closed_at": "2017-10-25T14:47:43Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am building windows kernel drivers with rust (`no_std` and no libc), and debug builds fail because the linker can't find `__CxxFrameHandler3` in the kernel libraries (which makes sense).\r\n\r\nHowever, when building with --release the function apparently is optimized out, and linking is successfull.\r\n\r\nMy target.json:\r\n```\r\n{\r\n  \"_\": \"Inspired by https://github.com/ryanbreen/breenix/blob/master/x86_64-unknown-none-gnu.json\",\r\n  \"_note\": \"`is_like_mcvc` works since #32823, nightly 2016-04-12\",\r\n  \"_note\": \"`data-layout` became mandatory since rust-lang/rust#32939, nightly 2016-04-20\",\r\n\r\n  \"llvm-target\": \"x86_64-pc-windows-msvc\",\r\n  \"target-endian\": \"little\",\r\n  \"target-pointer-width\": \"64\",\r\n  \"target-c-int-width\": \"32\",\r\n  \"linker-flavor\": \"msvc\",\r\n  \"data-layout\": \"e-m:w-i64:64-f80:128-n8:16:32:64-S128\",\r\n\r\n  \"cpu\": \"x86-64\",\r\n  \"features\": \"-mmx,-sse,-sse2,-sse3,-ssse3,-sse4.1,-sse4.2,-3dnow,-3dnowa,-avx,-avx2,+soft-float\",\r\n\r\n  \"arch\": \"x86_64\",\r\n  \"vendor\": \"pc\",\r\n  \"os\": \"windows\",\r\n  \"env\": \"msvc\",\r\n\r\n  \"executables\": true,\r\n  \"dynamic-linking\": true,\r\n\r\n  \"is-like-windows\": true,\r\n  \"is-like-msvc\": true,\r\n\r\n  \"dll-prefix\": \"\",\r\n  \"dll-suffix\": \".sys\",\r\n  \"exe-prefix\": \"\",\r\n  \"exe-suffix\": \".exe\",\r\n  \"staticlib-prefix\": \"lib\",\r\n  \"staticlib-suffix\": \".lib\",\r\n\r\n  \"no-default-libraries\":     true,\r\n  \"no-compiler-rt\":           true,\r\n  \"has-rpath\":                false,\r\n\r\n  \"function-sections\": true,\r\n  \"has-elf-tls\":              false,\r\n  \"disable-redzone\":          true,\r\n  \"custom-unwind-resume\":     false,\r\n  \"eliminate-frame-pointer\":  false,\r\n  \"position-independent-executables\": false,\r\n\r\n  \"code-model\":              \"kernel\",\r\n  \"relocation-model\":        \"dynamic-no-pic\",\r\n\r\n  \"pre-link-args\": [\"/NOLOGO\", \"/NODEFAULTLIB\", \"/SUBSYSTEM:NATIVE\", \"/DRIVER\", \"/RELEASE\", \"/NXCOMPAT\", \"/DYNAMICBASE\",\r\n    \"/INCREMENTAL:NO\", \"/MANIFEST:NO\"],\r\n\r\n  \"post-link-args\": [\"/OPT:REF,ICF\", \"ntoskrnl.lib\", \"hal.lib\",\r\n    \"/noimplib\", \"/ENTRY:DriverEntry\", \"/DEF:exports.def\", \"/MERGE:.edata=.rdata\", \"/MERGE:.rustc=.data\"],\r\n\r\n  \"_end\" : false\r\n}\r\n```\r\n\r\n\r\nMaybe related: #38641", "closed_by": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/45492/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/45492/timeline", "performed_via_github_app": null, "state_reason": "completed"}