{"url": "https://api.github.com/repos/rust-lang/rust/issues/110330", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/110330/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/110330/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/110330/events", "html_url": "https://github.com/rust-lang/rust/issues/110330", "id": 1668786536, "node_id": "I_kwDOAAsO6M5jd6lo", "number": 110330, "title": "Rustdoc --show-coverage is wrong for reexported items", "user": {"login": "aDotInTheVoid", "id": 28781354, "node_id": "MDQ6VXNlcjI4NzgxMzU0", "avatar_url": "https://avatars.githubusercontent.com/u/28781354?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aDotInTheVoid", "html_url": "https://github.com/aDotInTheVoid", "followers_url": "https://api.github.com/users/aDotInTheVoid/followers", "following_url": "https://api.github.com/users/aDotInTheVoid/following{/other_user}", "gists_url": "https://api.github.com/users/aDotInTheVoid/gists{/gist_id}", "starred_url": "https://api.github.com/users/aDotInTheVoid/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aDotInTheVoid/subscriptions", "organizations_url": "https://api.github.com/users/aDotInTheVoid/orgs", "repos_url": "https://api.github.com/users/aDotInTheVoid/repos", "events_url": "https://api.github.com/users/aDotInTheVoid/events{/privacy}", "received_events_url": "https://api.github.com/users/aDotInTheVoid/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 203738, "node_id": "MDU6TGFiZWwyMDM3Mzg=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-rustdoc", "name": "T-rustdoc", "color": "bfd4f2", "default": false, "description": "Relevant to the rustdoc team, which will review and decide on the PR/issue."}, {"id": 2312141528, "node_id": "MDU6TGFiZWwyMzEyMTQxNTI4", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-doc-coverage", "name": "A-doc-coverage", "color": "f7e101", "default": false, "description": "Area: Calculating how much of a crate has documentation"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2023-04-14T18:42:23Z", "updated_at": "2023-04-14T18:42:23Z", "closed_at": null, "author_association": "MEMBER", "active_lock_reason": null, "body": "**a/src/lib.rs**\r\n```rust\r\npub use b::*;\r\n```\r\n\r\n**b/src/lib.rs**\r\n\r\n```\r\n/// Documented with example\r\n///\r\n/// ```\r\n/// // The example\r\n/// ```\r\npub struct B1;\r\n/// Documented, no example\r\npub struct B2;\r\n// Undocumented\r\npub struct B3;\r\n```\r\n\r\nIn `b` \r\n\r\n```\r\nb$ cargo +nightly rustdoc -- -Z unstable-options --show-coverage\r\n Documenting b v0.1.0 (/home/gh-aDotInTheVoid/tmp/b)\r\n+-------------------------------------+------------+------------+------------+------------+\r\n| File                                | Documented | Percentage |   Examples | Percentage |\r\n+-------------------------------------+------------+------------+------------+------------+\r\n| src/lib.rs                          |          2 |      50.0% |          1 |      25.0% |\r\n+-------------------------------------+------------+------------+------------+------------+\r\n| Total                               |          2 |      50.0% |          1 |      25.0% |\r\n+-------------------------------------+------------+------------+------------+------------+\r\n    Finished dev [unoptimized + debuginfo] target(s) in 0.32s\r\n```\r\n\r\nBut In `a`:\r\n\r\n```\r\na$ cargo +nightly rustdoc -- -Z unstable-options --show-coverage\r\n Documenting a v0.1.0 (/home/gh-aDotInTheVoid/tmp/a)\r\n+-------------------------------------+------------+------------+------------+------------+\r\n| File                                | Documented | Percentage |   Examples | Percentage |\r\n+-------------------------------------+------------+------------+------------+------------+\r\n| src/lib.rs                          |          0 |       0.0% |          0 |       0.0% |\r\n+-------------------------------------+------------+------------+------------+------------+\r\n| Total                               |          0 |       0.0% |          0 |       0.0% |\r\n+-------------------------------------+------------+------------+------------+------------+\r\n    Finished dev [unoptimized + debuginfo] target(s) in 0.11s\r\n```\r\n\r\nThese outputs should be the same.\r\n\r\nWhen writing tests for this, also add one with `--output-format json`, as that flag is overloaded between this and the json backend, and the json backend interacts in funny ways with inlining.\r\n\r\nrustdoc 1.70.0-nightly (a41fc00ea 2023-04-13)\r\nbinary: rustdoc\r\ncommit-hash: unknown\r\ncommit-date: unknown\r\nhost: aarch64-unknown-linux-gnu\r\nrelease: 1.70.0-nightly\r\nLLVM version: 16.0.2", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/110330/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/110330/timeline", "performed_via_github_app": null, "state_reason": null}