{"url": "https://api.github.com/repos/rust-lang/rust/issues/15913", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/15913/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/15913/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/15913/events", "html_url": "https://github.com/rust-lang/rust/issues/15913", "id": 38521201, "node_id": "MDU6SXNzdWUzODUyMTIwMQ==", "number": 15913, "title": "ICE: adt::represent_type called on non-ADT type", "user": {"login": "csoren", "id": 195392, "node_id": "MDQ6VXNlcjE5NTM5Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/195392?v=4", "gravatar_id": "", "url": "https://api.github.com/users/csoren", "html_url": "https://github.com/csoren", "followers_url": "https://api.github.com/users/csoren/followers", "following_url": "https://api.github.com/users/csoren/following{/other_user}", "gists_url": "https://api.github.com/users/csoren/gists{/gist_id}", "starred_url": "https://api.github.com/users/csoren/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/csoren/subscriptions", "organizations_url": "https://api.github.com/users/csoren/orgs", "repos_url": "https://api.github.com/users/csoren/repos", "events_url": "https://api.github.com/users/csoren/events{/privacy}", "received_events_url": "https://api.github.com/users/csoren/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2014-07-23T11:42:42Z", "updated_at": "2014-09-08T09:51:28Z", "closed_at": "2014-09-08T09:51:28Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm exploring Rust for the first time and having a play with the FFI on Win32 in particular. I've hit an internal compiler error however. I have tried to isolate the offending lines in order to provide a minimal example, but when I do that, the problem goes away.\n\nIt seems to be related to my definition of DefWindowProc in src/win32/user32/native.rs, if I delete the uMsg:u32 parameter, compilation completes (obviously the code now has zero chance of working, but you get the idea).\n\nI'm using the latest nightly (rustc 0.12.0-pre-nightly (aa0e35bc6 2014-07-22 00:26:21 +0000)) as of submitting this report on Windows 8.1\n\nThe problem can be recreated with:\n\n```\nhg clone ssh://hg@bitbucket.org/csoren/rust-win32 rust-ice\ncd rust-ice\nhg update rust-ice\ncargo build\n```\n\nThis will produce:\n\n```\nerror: internal compiler error: adt::represent_type called on non-ADT type\nnote: the compiler hit an unexpected failure path. this is a bug.\nnote: we would appreciate a bug report: http://doc.rust-lang.org/complement-bugreport.html\nnote: run with `RUST_BACKTRACE=1` for a backtrace\ntask 'rustc' failed at 'Box<Any>', C:\\bot\\slave\\nightly-win\\build\\src\\libsyntax\\ast_util.rs:784\n```\n\nRunning with RUST_BACKTRACE doesn't seem very helpful:\n\n```\nstack backtrace:\n   1: 0x6a17dd74\n   2: 0x61f8889c\n   3:   0x66910e\n   4:   0x669aac\n   5: 0x70f18f76\n   6: 0x712e7899\n   7: 0x71309679\n   8: 0x712fda17\n   9: 0x71300afc\n  10: 0x71312910\n  11: 0x71310f8d\n  12: 0x712d4711\n  13: 0x7131ce69\n  14: 0x71311294\n  15: 0x712d329e\n  16: 0x713b02c3\n  17: 0x713b00be\n  18: 0x7137e662\n  19: 0x712d26c4\n  20: 0x712d1d67\n  21: 0x712d357b\n  22: 0x7138556f\n  23: 0x712c6f90\n  24: 0x712c2534\n  25: 0x712bd37b\n  26: 0x71300ef5\n  27: 0x712fd67a\n  28: 0x71300afc\n  29: 0x71312910\n  30: 0x712d31f9\n  31: 0x712d3664\n  32: 0x7138556f\n  33: 0x712c6f90\n  34: 0x712c2534\n  35: 0x712bd37b\n  36: 0x71300ef5\n  37: 0x712fd67a\n  38: 0x71300afc\n  39: 0x71312910\n  40: 0x712d31f9\n  41: 0x712d3664\n  42: 0x71312487\n  43: 0x712d31f9\n  44: 0x712d3e18\n  45: 0x7131231f\n  46: 0x712d31f9\n  47: 0x712d3664\n  48: 0x7138556f\n  49: 0x712c6f90\n  50: 0x712c2534\n  51: 0x712bd37b\n  52: 0x712f777c\n  53: 0x71303958\n  54: 0x712fd67a\n  55: 0x712db22d\n  56: 0x7132bc76\n  57: 0x7131b7ff\n  58: 0x7131c60d\n  59: 0x71311273\n  60: 0x712d4711\n  61: 0x7130a75e\n  62: 0x712fe79d\n  63: 0x71300afc\n  64: 0x71312910\n  65: 0x712d31f9\n  66: 0x712d3664\n  67: 0x7138556f\n  68: 0x712c6f90\n  69: 0x712c88db\n  70: 0x712f828d\n  71: 0x712f3db6\n  72: 0x713015cf\n  73: 0x712fd67a\n  74: 0x71300afc\n  75: 0x71312910\n  76: 0x712d31f9\n  77: 0x71324e52\n  78: 0x713123af\n  79: 0x712d31f9\n  80: 0x712d3664\n  81: 0x7138556f\n  82: 0x712c6f90\n  83: 0x712c2534\n```\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/15913/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/15913/timeline", "performed_via_github_app": null, "state_reason": "completed"}