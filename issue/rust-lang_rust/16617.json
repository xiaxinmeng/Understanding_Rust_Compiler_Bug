{"url": "https://api.github.com/repos/rust-lang/rust/issues/16617", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/16617/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/16617/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/16617/events", "html_url": "https://github.com/rust-lang/rust/issues/16617", "id": 40642038, "node_id": "MDU6SXNzdWU0MDY0MjAzOA==", "number": 16617, "title": "Syntactic context discarded when quoting a macro invocation", "user": {"login": "kmcallister", "id": 444997, "node_id": "MDQ6VXNlcjQ0NDk5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/444997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kmcallister", "html_url": "https://github.com/kmcallister", "followers_url": "https://api.github.com/users/kmcallister/followers", "following_url": "https://api.github.com/users/kmcallister/following{/other_user}", "gists_url": "https://api.github.com/users/kmcallister/gists{/gist_id}", "starred_url": "https://api.github.com/users/kmcallister/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kmcallister/subscriptions", "organizations_url": "https://api.github.com/users/kmcallister/orgs", "repos_url": "https://api.github.com/users/kmcallister/repos", "events_url": "https://api.github.com/users/kmcallister/events{/privacy}", "received_events_url": "https://api.github.com/users/kmcallister/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 235146, "node_id": "MDU6TGFiZWwyMzUxNDY=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-syntaxext", "name": "A-syntaxext", "color": "f7e101", "default": false, "description": "Area: Syntax extensions"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2014-08-19T22:02:15Z", "updated_at": "2015-04-26T12:43:51Z", "closed_at": "2015-04-26T12:43:51Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "#15750 is fixed now, but a variant of the same issue occurs when quoting a macro invocation.\n\nUsing `plugin.rs` from #15750 and this `test.rs`:\n\n``` rust\n#![feature(phase)]\n\n#[phase(plugin)]\nextern crate plugin;\n\nfn main() {\n    let x = true;\n    println!(\"{}\", mymacro!(assert!(x)));\n}\n```\n\nI get this result:\n\n```\n$ rustc -v\nrustc 0.12.0-pre (3f5d0b5b6 2014-08-19 16:35:51 +0000)\n\n$ rustc plugin.rs\n\n$ rustc -L. test.rs\n<quote expansion>:1:20: 1:21 error: unresolved name `x`.\n<quote expansion>:1 name_64,ctxt_11!(x)\n                                       ^\n<std macros>:1:1: 12:2 note: in expansion of assert!\n<quote expansion>:1:1: 1:22 note: expansion site\ntest.rs:1:1: 9:1 note: in expansion of mymacro!\ntest.rs:8:20: 8:40 note: expansion site\nnote: in expansion of format_args!\n<std macros>:2:23: 2:77 note: expansion site\n<std macros>:1:1: 3:2 note: in expansion of println!\ntest.rs:8:5: 8:42 note: expansion site\nerror: aborting due to previous error\n```\n\nAlso the NULL characters used to delimit the magic identifier string appear in the error output, which causes the error caret to appear in the wrong place.\n\nSee also #15962.\n\nCC @pnkfelix. This is still a huge improvement from before and I think I can work around the remaining issues in `html5ever`. Thank you for fixing #15750 :)\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/16617/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/16617/timeline", "performed_via_github_app": null, "state_reason": "completed"}