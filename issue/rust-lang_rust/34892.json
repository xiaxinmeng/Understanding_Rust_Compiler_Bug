{"url": "https://api.github.com/repos/rust-lang/rust/issues/34892", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/34892/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/34892/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/34892/events", "html_url": "https://github.com/rust-lang/rust/issues/34892", "id": 165998623, "node_id": "MDU6SXNzdWUxNjU5OTg2MjM=", "number": 34892, "title": "Inference failure with mutable reference to closure", "user": {"login": "eefriedman", "id": 12769964, "node_id": "MDQ6VXNlcjEyNzY5OTY0", "avatar_url": "https://avatars.githubusercontent.com/u/12769964?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eefriedman", "html_url": "https://github.com/eefriedman", "followers_url": "https://api.github.com/users/eefriedman/followers", "following_url": "https://api.github.com/users/eefriedman/following{/other_user}", "gists_url": "https://api.github.com/users/eefriedman/gists{/gist_id}", "starred_url": "https://api.github.com/users/eefriedman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eefriedman/subscriptions", "organizations_url": "https://api.github.com/users/eefriedman/orgs", "repos_url": "https://api.github.com/users/eefriedman/repos", "events_url": "https://api.github.com/users/eefriedman/events{/privacy}", "received_events_url": "https://api.github.com/users/eefriedman/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2016-07-17T22:05:41Z", "updated_at": "2017-04-29T00:34:12Z", "closed_at": "2017-04-29T00:34:12Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "``` rust\nfn foo<'a, X:'static>(mut cb: &mut (FnMut(&u64) -> X + 'a)) -> X {\n    let mut cb = move |expr1| {\n        cb(expr1)\n    };\n    let cb = &mut cb;\n    foo(cb)\n}\n\n// Alternate version which works\nfn id<X, T: FnMut(&u64) -> X>(t: T) -> T { t }\nfn foo2<'a, X:'static>(mut cb: &mut (FnMut(&u64) -> X + 'a)) -> X {\n    let mut cb = id(move |expr1| {\n        cb(expr1)\n    });\n    let cb = &mut cb;\n    foo2(cb)\n}\n```\n\nGives:\n\n```\nerror: type mismatch: the type `[closure@<anon>:2:18: 4:6 cb:_]` implements the trait `std::ops::FnMut<(&u64,)>`, but the trait `for<'r> std::ops::FnMut<(&'r u64,)>` is required (expected concrete lifetime, found bound lifetime parameter ) [--explain E0281]\n --> <anon>:6:9\n  |>\n6 |>     foo(cb)\n  |>         ^^\nnote: required for the cast to the object type `for<'r> std::ops::FnMut(&'r u64) -> X`\n\nerror: type mismatch resolving `for<'r> <[closure@<anon>:2:18: 4:6 cb:_] as std::ops::FnOnce<(&'r u64,)>>::Output == X`:\n expected bound lifetime parameter ,\n    found concrete lifetime [--explain E0271]\n --> <anon>:6:9\n  |>\n6 |>     foo(cb)\n  |>         ^^\nnote: required for the cast to the object type `for<'r> std::ops::FnMut(&'r u64) -> X`\n\nerror: aborting due to 2 previous errors\n```\n", "closed_by": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/34892/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/34892/timeline", "performed_via_github_app": null, "state_reason": "completed"}