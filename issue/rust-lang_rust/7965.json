{"url": "https://api.github.com/repos/rust-lang/rust/issues/7965", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/7965/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/7965/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/7965/events", "html_url": "https://github.com/rust-lang/rust/issues/7965", "id": 17041322, "node_id": "MDU6SXNzdWUxNzA0MTMyMg==", "number": 7965, "title": "Parse error on macro invocation expression at the start of a statement", "user": {"login": "Deewiant", "id": 445326, "node_id": "MDQ6VXNlcjQ0NTMyNg==", "avatar_url": "https://avatars.githubusercontent.com/u/445326?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Deewiant", "html_url": "https://github.com/Deewiant", "followers_url": "https://api.github.com/users/Deewiant/followers", "following_url": "https://api.github.com/users/Deewiant/following{/other_user}", "gists_url": "https://api.github.com/users/Deewiant/gists{/gist_id}", "starred_url": "https://api.github.com/users/Deewiant/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Deewiant/subscriptions", "organizations_url": "https://api.github.com/users/Deewiant/orgs", "repos_url": "https://api.github.com/users/Deewiant/repos", "events_url": "https://api.github.com/users/Deewiant/events{/privacy}", "received_events_url": "https://api.github.com/users/Deewiant/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 27424086, "node_id": "MDU6TGFiZWwyNzQyNDA4Ng==", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-parser", "name": "A-parser", "color": "f7e101", "default": false, "description": "Area: The parsing of Rust source code to an AST."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2013-07-22T11:13:07Z", "updated_at": "2013-08-01T13:19:05Z", "closed_at": "2013-08-01T13:19:05Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "The following results in a parse error:\n\n```\n$ rustc --no-trans - <<<'macro_rules! x(() => { \"foo\" }) fn main() { x!().len(); }' \n<anon>:1:48: 1:49 error: unexpected token: `.`\n<anon>:1 macro_rules! x(() => { \"foo\" }) fn main() { x!().len(); }\n                                                         ^\n```\n\nWhile e.g. the following, where the method call expression is wrapped in parentheses, does not:\n\n```\n$ rustc --no-trans - <<<'macro_rules! x(() => { \"foo\" }) fn main() { (x!().len()); }'\n```\n\nIt seems as though the macro is assumed to expand to a statement if it is placed where a statement is allowed, causing an error even though it actually expands to an expression.\n\nThe Macros Tutorial says that macros are parsed as (paraphrased) \"appropriate placeholders\". Shouldn't this placeholder permit being treated as an expression even in a context where it isn't yet known whether it is an expression or not?\n", "closed_by": {"login": "huonw", "id": 1203825, "node_id": "MDQ6VXNlcjEyMDM4MjU=", "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4", "gravatar_id": "", "url": "https://api.github.com/users/huonw", "html_url": "https://github.com/huonw", "followers_url": "https://api.github.com/users/huonw/followers", "following_url": "https://api.github.com/users/huonw/following{/other_user}", "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}", "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/huonw/subscriptions", "organizations_url": "https://api.github.com/users/huonw/orgs", "repos_url": "https://api.github.com/users/huonw/repos", "events_url": "https://api.github.com/users/huonw/events{/privacy}", "received_events_url": "https://api.github.com/users/huonw/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/7965/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/7965/timeline", "performed_via_github_app": null, "state_reason": "completed"}