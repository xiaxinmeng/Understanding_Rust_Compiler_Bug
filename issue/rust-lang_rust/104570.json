{"url": "https://api.github.com/repos/rust-lang/rust/issues/104570", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/104570/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/104570/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/104570/events", "html_url": "https://github.com/rust-lang/rust/issues/104570", "id": 1454865233, "node_id": "I_kwDOAAsO6M5Wt3tR", "number": 104570, "title": "`rustup`-installed nightly compiler no longer works on MacOS Mojave ", "user": {"login": "mooli", "id": 85358, "node_id": "MDQ6VXNlcjg1MzU4", "avatar_url": "https://avatars.githubusercontent.com/u/85358?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mooli", "html_url": "https://github.com/mooli", "followers_url": "https://api.github.com/users/mooli/followers", "following_url": "https://api.github.com/users/mooli/following{/other_user}", "gists_url": "https://api.github.com/users/mooli/gists{/gist_id}", "starred_url": "https://api.github.com/users/mooli/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mooli/subscriptions", "organizations_url": "https://api.github.com/users/mooli/orgs", "repos_url": "https://api.github.com/users/mooli/repos", "events_url": "https://api.github.com/users/mooli/events{/privacy}", "received_events_url": "https://api.github.com/users/mooli/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 147085028, "node_id": "MDU6TGFiZWwxNDcwODUwMjg=", "url": "https://api.github.com/repos/rust-lang/rust/labels/regression-from-stable-to-nightly", "name": "regression-from-stable-to-nightly", "color": "e4008a", "default": false, "description": "Performance or correctness regression from stable to nightly."}, {"id": 593503757, "node_id": "MDU6TGFiZWw1OTM1MDM3NTc=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-infra", "name": "T-infra", "color": "bfd4f2", "default": false, "description": "Relevant to the infrastructure team, which will review and decide on the PR/issue."}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "closed", "locked": false, "assignee": {"login": "BlackHoleFox", "id": 20936452, "node_id": "MDQ6VXNlcjIwOTM2NDUy", "avatar_url": "https://avatars.githubusercontent.com/u/20936452?v=4", "gravatar_id": "", "url": "https://api.github.com/users/BlackHoleFox", "html_url": "https://github.com/BlackHoleFox", "followers_url": "https://api.github.com/users/BlackHoleFox/followers", "following_url": "https://api.github.com/users/BlackHoleFox/following{/other_user}", "gists_url": "https://api.github.com/users/BlackHoleFox/gists{/gist_id}", "starred_url": "https://api.github.com/users/BlackHoleFox/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/BlackHoleFox/subscriptions", "organizations_url": "https://api.github.com/users/BlackHoleFox/orgs", "repos_url": "https://api.github.com/users/BlackHoleFox/repos", "events_url": "https://api.github.com/users/BlackHoleFox/events{/privacy}", "received_events_url": "https://api.github.com/users/BlackHoleFox/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "BlackHoleFox", "id": 20936452, "node_id": "MDQ6VXNlcjIwOTM2NDUy", "avatar_url": "https://avatars.githubusercontent.com/u/20936452?v=4", "gravatar_id": "", "url": "https://api.github.com/users/BlackHoleFox", "html_url": "https://github.com/BlackHoleFox", "followers_url": "https://api.github.com/users/BlackHoleFox/followers", "following_url": "https://api.github.com/users/BlackHoleFox/following{/other_user}", "gists_url": "https://api.github.com/users/BlackHoleFox/gists{/gist_id}", "starred_url": "https://api.github.com/users/BlackHoleFox/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/BlackHoleFox/subscriptions", "organizations_url": "https://api.github.com/users/BlackHoleFox/orgs", "repos_url": "https://api.github.com/users/BlackHoleFox/repos", "events_url": "https://api.github.com/users/BlackHoleFox/events{/privacy}", "received_events_url": "https://api.github.com/users/BlackHoleFox/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 27, "created_at": "2022-11-18T10:37:39Z", "updated_at": "2022-12-05T12:23:01Z", "closed_at": "2022-12-04T14:03:10Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Code\n\nI tried this on the latest nightly compiler installed by `rustup`:\n\n```sh\ncargo build\n```\n\nI expected to see this happen: My project builds.\n\nInstead, this happened: `rustc` crashed due to a dynamic library linkage problem.\n\n\n### Version it worked on\n\n<!--\nProvide the most recent version this worked on, for example:\n\nIt most recently worked on: Rust 1.47\n-->\n\nIt most recently worked on: `rustc 1.67.0-nightly (96ddd32c4 2022-11-14)`.\n\n### Version with regression\n\n<!--\nProvide the version you are using that has the regression.\n-->\n\n`rustc --version --verbose`:\n\nIt crashes without giving the version, but so far it affects the `rustup` toolchains `nightly-2022-11-16`, `nightly-2022-11-17`, and `nightly` (which I assume is the same as `nightly-2022-11-17` for now.)\n\n<!--\nDid the compiler crash? If so, please provide a backtrace.\n-->\n\n### Backtrace\n\nThe `rustc` binary segfaults with the following output:\n\n```\ndyld: Library not loaded: @rpath/librustc_driver-dae4a1cad6347bf8.dylib\n  Referenced from: /Users/abuse/.rustup/toolchains/nightly-x86_64-apple-darwin/bin/rustc\n  Reason: no suitable image found.  Did find:\n\t/Users/abuse/.rustup/toolchains/nightly-x86_64-apple-darwin/bin/../lib/librustc_driver-dae4a1cad6347bf8.dylib: cannot load 'librustc_driver-dae4a1cad6347bf8.dylib' (load command 0x80000034 is unknown)\n\t/Users/abuse/.rustup/toolchains/nightly-x86_64-apple-darwin/bin/../lib/librustc_driver-dae4a1cad6347bf8.dylib: stat() failed with errno=1\n\t/Users/abuse/.rustup/toolchains/nightly-x86_64-apple-darwin/lib/librustc_driver-dae4a1cad6347bf8.dylib: cannot load 'librustc_driver-dae4a1cad6347bf8.dylib' (load command 0x80000034 is unknown)\n\t/Users/abuse/.rustup/toolchains/nightly-x86_64-apple-darwin/lib/librustc_driver-dae4a1cad6347bf8.dylib: stat() failed with errno=1\nAbort trap: 6\n```\n\nSetting `RUST_BACKTRACE=1` does not get further diagnostics, probably because the compiler isn't even being run due to the linkage problem.\n\n</p>\n</details>\n\n<!--\nIf you know when this regression occurred, please add a line like below, replacing `{channel}` with one of stable, beta, or nightly.\n\n@rustbot modify labels: +regression-from-stable-to-nightly -regression-untriaged\n-->\n\n### Likely cause\n\nI am running MacOS Mojave. Yes, this is quite an old OS release, and no, I'm not intending to upgrade any time soon. It seems likely that whoever is building binaries for the `x86_64-apple-darwin` target has upgraded their build environment and/or changed some settings, inadvertently causing it to produce binaries which require a newer version of MacOS. (Xcode is unhelpful like that.) I haven't seen any announcement of dropping of support for older MacOS versions.\n\n<!-- TRIAGEBOT_START -->\n\n<!-- TRIAGEBOT_ASSIGN_START -->\n\n<!-- TRIAGEBOT_ASSIGN_DATA_START$${\"user\":\"BlackHoleFox\"}$$TRIAGEBOT_ASSIGN_DATA_END -->\n\n<!-- TRIAGEBOT_ASSIGN_END -->\n<!-- TRIAGEBOT_END -->", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/104570/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/104570/timeline", "performed_via_github_app": null, "state_reason": "completed"}