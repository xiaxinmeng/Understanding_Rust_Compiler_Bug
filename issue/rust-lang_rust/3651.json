{"url": "https://api.github.com/repos/rust-lang/rust/issues/3651", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/3651/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/3651/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/3651/events", "html_url": "https://github.com/rust-lang/rust/issues/3651", "id": 7339283, "node_id": "MDU6SXNzdWU3MzM5Mjgz", "number": 3651, "title": "Type errors with `for` and `do` expressions could be cleverer", "user": {"login": "ben0x539", "id": 24142, "node_id": "MDQ6VXNlcjI0MTQy", "avatar_url": "https://avatars.githubusercontent.com/u/24142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ben0x539", "html_url": "https://github.com/ben0x539", "followers_url": "https://api.github.com/users/ben0x539/followers", "following_url": "https://api.github.com/users/ben0x539/following{/other_user}", "gists_url": "https://api.github.com/users/ben0x539/gists{/gist_id}", "starred_url": "https://api.github.com/users/ben0x539/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ben0x539/subscriptions", "organizations_url": "https://api.github.com/users/ben0x539/orgs", "repos_url": "https://api.github.com/users/ben0x539/repos", "events_url": "https://api.github.com/users/ben0x539/events{/privacy}", "received_events_url": "https://api.github.com/users/ben0x539/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 37544, "node_id": "MDU6TGFiZWwzNzU0NA==", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-typesystem", "name": "A-typesystem", "color": "f7e101", "default": false, "description": "Area: The type system"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/rust-lang/rust/milestones/9", "html_url": "https://github.com/rust-lang/rust/milestone/9", "labels_url": "https://api.github.com/repos/rust-lang/rust/milestones/9/labels", "id": 194126, "node_id": "MDk6TWlsZXN0b25lMTk0MTI2", "number": 9, "title": "0.6", "description": "", "creator": {"login": "catamorphism", "id": 427212, "node_id": "MDQ6VXNlcjQyNzIxMg==", "avatar_url": "https://avatars.githubusercontent.com/u/427212?v=4", "gravatar_id": "", "url": "https://api.github.com/users/catamorphism", "html_url": "https://github.com/catamorphism", "followers_url": "https://api.github.com/users/catamorphism/followers", "following_url": "https://api.github.com/users/catamorphism/following{/other_user}", "gists_url": "https://api.github.com/users/catamorphism/gists{/gist_id}", "starred_url": "https://api.github.com/users/catamorphism/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/catamorphism/subscriptions", "organizations_url": "https://api.github.com/users/catamorphism/orgs", "repos_url": "https://api.github.com/users/catamorphism/repos", "events_url": "https://api.github.com/users/catamorphism/events{/privacy}", "received_events_url": "https://api.github.com/users/catamorphism/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 203, "state": "closed", "created_at": "2012-10-11T18:15:24Z", "updated_at": "2015-01-21T01:43:22Z", "due_on": "2013-03-25T07:00:00Z", "closed_at": "2013-04-02T18:27:52Z"}, "comments": 5, "created_at": "2012-10-04T00:54:26Z", "updated_at": "2014-06-16T21:56:22Z", "closed_at": "2013-01-24T19:07:05Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Calling functions meant to be used in `for`/`do` expressions in the respective other kind of expression gives type errors. While that's correct, it's not immediately clear where the error is (not even the squiggly lines under the code excerpts are very clear), and I think it should be yelling at me directly for using the wrong syntax sugar instead of outlining how it noticed that I screwed up. Here is some examples that I found a bit misleading:\n\n```\nfoo.rs:2:14: 2:36 error: a `loop` function's last argument should return `bool`, not `()`\nfoo.rs:2     for task::spawn { return true; }\n                       ^~~~~~~~~~~~~~~~~~~~~~\n```\n\nI'm returning a `bool`, what's the matter! I expect rustc is pointing at the type of `task::spawn` here even though my closure is underlined and the mismatch is really between `for` and the function type.\n\nSimilarly, in the inverse case,\n\n```\nfoo.rs:2:15: 2:17 error: mismatched types: expected `bool` but found `()` (expected bool but found ())\nfoo.rs:2     do 5.times {}\n                        ^~\n```\n\nWell, okay then, let me just return `true`...\n\n```\nfoo.rs:2:24: 2:28 error: mismatched types: expected `()` but found `bool` (expected () but found bool)\nfoo.rs:2     do 5.times { return true; }\n                                 ^~~~\n```\n\nArgh! Which is it! ;-)\n", "closed_by": {"login": "catamorphism", "id": 427212, "node_id": "MDQ6VXNlcjQyNzIxMg==", "avatar_url": "https://avatars.githubusercontent.com/u/427212?v=4", "gravatar_id": "", "url": "https://api.github.com/users/catamorphism", "html_url": "https://github.com/catamorphism", "followers_url": "https://api.github.com/users/catamorphism/followers", "following_url": "https://api.github.com/users/catamorphism/following{/other_user}", "gists_url": "https://api.github.com/users/catamorphism/gists{/gist_id}", "starred_url": "https://api.github.com/users/catamorphism/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/catamorphism/subscriptions", "organizations_url": "https://api.github.com/users/catamorphism/orgs", "repos_url": "https://api.github.com/users/catamorphism/repos", "events_url": "https://api.github.com/users/catamorphism/events{/privacy}", "received_events_url": "https://api.github.com/users/catamorphism/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/3651/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/3651/timeline", "performed_via_github_app": null, "state_reason": "completed"}