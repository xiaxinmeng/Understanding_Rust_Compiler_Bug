{"url": "https://api.github.com/repos/rust-lang/rust/issues/64002", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/64002/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/64002/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/64002/events", "html_url": "https://github.com/rust-lang/rust/issues/64002", "id": 487068929, "node_id": "MDU6SXNzdWU0ODcwNjg5Mjk=", "number": 64002, "title": "Misleading error messages about lifetimes and borrowing", "user": {"login": "qiujiangkun", "id": 33482468, "node_id": "MDQ6VXNlcjMzNDgyNDY4", "avatar_url": "https://avatars.githubusercontent.com/u/33482468?v=4", "gravatar_id": "", "url": "https://api.github.com/users/qiujiangkun", "html_url": "https://github.com/qiujiangkun", "followers_url": "https://api.github.com/users/qiujiangkun/followers", "following_url": "https://api.github.com/users/qiujiangkun/following{/other_user}", "gists_url": "https://api.github.com/users/qiujiangkun/gists{/gist_id}", "starred_url": "https://api.github.com/users/qiujiangkun/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/qiujiangkun/subscriptions", "organizations_url": "https://api.github.com/users/qiujiangkun/orgs", "repos_url": "https://api.github.com/users/qiujiangkun/repos", "events_url": "https://api.github.com/users/qiujiangkun/events{/privacy}", "received_events_url": "https://api.github.com/users/qiujiangkun/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 235791, "node_id": "MDU6TGFiZWwyMzU3OTE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-diagnostics", "name": "A-diagnostics", "color": "f7e101", "default": false, "description": "Area: Messages for errors, warnings, and lints"}, {"id": 1775993, "node_id": "MDU6TGFiZWwxNzc1OTkz", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-lifetimes", "name": "A-lifetimes", "color": "f7e101", "default": false, "description": "Area: lifetime related"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-08-29T16:47:09Z", "updated_at": "2019-08-31T09:37:58Z", "closed_at": "2019-08-31T09:37:58Z", "author_association": "NONE", "active_lock_reason": null, "body": "The error message is misleading that it led me to another approach through which I can't fix my program.\r\n```log\r\nerror[E0597]: `line` does not live long enough\r\n  --> src/main.rs:24:30\r\n   |\r\n24 |         let spt: Vec<&str> = line.split(char::is_whitespace).collect();\r\n   |                              ^^^^ borrowed value does not live long enough\r\n...\r\n27 |             \"#mem\" => { rule.mem.push((spt[1], spt[2])) }\r\n   |                         -------- borrow later used here\r\n...\r\n30 |     }\r\n   |     - `line` dropped here while still borrowed\r\n\r\n```\r\nIn fact the problem has nothing to do with borrowing but lifetime. As soon as I changed all my `&'a str` references to `String` and adjusted relevant codes properly, it worked.\r\n\r\n[Here's the code](https://play.rust-lang.org/?version=nightly&mode=debug&edition=2018&gist=5b1c1fc2337c6ce54d9bffc2dc8c4879):\r\n```rust\r\nstruct Rule<'a> {\r\n    name: &'a str,\r\n    mem: Vec<(&'a str, &'a str)>\r\n}\r\nimpl<'a> Rule<'a> {\r\n    fn new() -> Rule<'a> {\r\n        Rule{\r\n            name: \"\",\r\n            mem: vec![]\r\n        }\r\n    }\r\n}\r\nuse std::fs::File;\r\nuse std::io::{BufReader, BufRead};\r\n\r\nfn read_rules(filename: &str) -> Vec<Rule> {\r\n    let file = File::open(filename).unwrap();\r\n    let reader = BufReader::new(file);\r\n    let rules = vec![];\r\n    let mut rule = Rule::new();\r\n    for (index, line) in reader.lines().enumerate() {\r\n        let line = line.unwrap();\r\n        let spt: Vec<&str> = line.split(char::is_whitespace).collect();\r\n        match spt[0] {\r\n            \"#def\" => { rule.name = spt[1]; }\r\n            \"#mem\" => { rule.mem.push((spt[1], spt[2])) }\r\n            _ => { println!(\"{}\", line) }\r\n        }\r\n    }\r\n    return rules;\r\n}\r\nfn main() {\r\n    read_rules(\"foo\");\r\n}\r\n```", "closed_by": {"login": "csmoe", "id": 35686186, "node_id": "MDQ6VXNlcjM1Njg2MTg2", "avatar_url": "https://avatars.githubusercontent.com/u/35686186?v=4", "gravatar_id": "", "url": "https://api.github.com/users/csmoe", "html_url": "https://github.com/csmoe", "followers_url": "https://api.github.com/users/csmoe/followers", "following_url": "https://api.github.com/users/csmoe/following{/other_user}", "gists_url": "https://api.github.com/users/csmoe/gists{/gist_id}", "starred_url": "https://api.github.com/users/csmoe/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/csmoe/subscriptions", "organizations_url": "https://api.github.com/users/csmoe/orgs", "repos_url": "https://api.github.com/users/csmoe/repos", "events_url": "https://api.github.com/users/csmoe/events{/privacy}", "received_events_url": "https://api.github.com/users/csmoe/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/64002/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/64002/timeline", "performed_via_github_app": null, "state_reason": "completed"}