{"url": "https://api.github.com/repos/rust-lang/rust/issues/56605", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/56605/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/56605/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/56605/events", "html_url": "https://github.com/rust-lang/rust/issues/56605", "id": 388742882, "node_id": "MDU6SXNzdWUzODg3NDI4ODI=", "number": 56605, "title": "Error using associated constant in return type of generic function", "user": {"login": "richardmatheson", "id": 43337943, "node_id": "MDQ6VXNlcjQzMzM3OTQz", "avatar_url": "https://avatars.githubusercontent.com/u/43337943?v=4", "gravatar_id": "", "url": "https://api.github.com/users/richardmatheson", "html_url": "https://github.com/richardmatheson", "followers_url": "https://api.github.com/users/richardmatheson/followers", "following_url": "https://api.github.com/users/richardmatheson/following{/other_user}", "gists_url": "https://api.github.com/users/richardmatheson/gists{/gist_id}", "starred_url": "https://api.github.com/users/richardmatheson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/richardmatheson/subscriptions", "organizations_url": "https://api.github.com/users/richardmatheson/orgs", "repos_url": "https://api.github.com/users/richardmatheson/repos", "events_url": "https://api.github.com/users/richardmatheson/events{/privacy}", "received_events_url": "https://api.github.com/users/richardmatheson/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 149689562, "node_id": "MDU6TGFiZWwxNDk2ODk1NjI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-associated-items", "name": "A-associated-items", "color": "f7e101", "default": false, "description": "Area: Associated items such as associated types and consts."}, {"id": 211668019, "node_id": "MDU6TGFiZWwyMTE2NjgwMTk=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-lang", "name": "T-lang", "color": "bfd4f2", "default": false, "description": "Relevant to the language team, which will review and decide on the PR/issue."}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2018-12-07T17:18:41Z", "updated_at": "2019-11-13T19:47:24Z", "closed_at": null, "author_association": "NONE", "active_lock_reason": null, "body": "Consider the following code:\r\n\r\n```rust\r\ntrait ArrayGenerator {\r\n  const LEN: usize;\r\n}\r\n\r\nfn generate<T>(obj: T) -> [u8; T::LEN] where T: ArrayGenerator {\r\n  [0; T::LEN]\r\n}\r\n\r\nstruct Foo { }\r\n\r\nimpl ArrayGenerator for Foo {\r\n  const LEN: usize = 8;\r\n}\r\n\r\nfn main() {\r\n  println!(\"{:?}\", generate(Foo{}));\r\n}\r\n```\r\n\r\nThe compiler will error with:\r\n\r\n```\r\nerror[E0599]: no associated item named `LEN` found for type `T` in the current scope\r\n --> src/main.rs:5:32\r\n  |\r\n5 | fn generate<T>(obj: T) -> [u8; T::LEN] where T: ArrayGenerator {\r\n  |                                ^^^^^^ associated item not found in `T`\r\n  |\r\n  = help: items from traits can only be used if the trait is implemented and in scope\r\n  = note: the following trait defines an item `LEN`, perhaps you need to implement it:\r\n          candidate #1: `ArrayGenerator`\r\n```\r\n\r\nNow there is a clear constraint on T, meaning that LEN should be valid. I'm guessing the return type is being evaluated before the constraint, whereas it should check after, at which point it would know this this ought to be valid.\r\n\r\nTested in 1.31 stable and 1.32 nightly (Dec 7 2018)", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/56605/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/56605/timeline", "performed_via_github_app": null, "state_reason": null}