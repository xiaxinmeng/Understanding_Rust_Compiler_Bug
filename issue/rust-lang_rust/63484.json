{"url": "https://api.github.com/repos/rust-lang/rust/issues/63484", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/63484/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/63484/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/63484/events", "html_url": "https://github.com/rust-lang/rust/issues/63484", "id": 479505318, "node_id": "MDU6SXNzdWU0Nzk1MDUzMTg=", "number": 63484, "title": "Using profile-overrides results in both optimized and unoptimized versions of the same crate in linked executable ", "user": {"login": "aclysma", "id": 316070, "node_id": "MDQ6VXNlcjMxNjA3MA==", "avatar_url": "https://avatars.githubusercontent.com/u/316070?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aclysma", "html_url": "https://github.com/aclysma", "followers_url": "https://api.github.com/users/aclysma/followers", "following_url": "https://api.github.com/users/aclysma/following{/other_user}", "gists_url": "https://api.github.com/users/aclysma/gists{/gist_id}", "starred_url": "https://api.github.com/users/aclysma/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aclysma/subscriptions", "organizations_url": "https://api.github.com/users/aclysma/orgs", "repos_url": "https://api.github.com/users/aclysma/repos", "events_url": "https://api.github.com/users/aclysma/events{/privacy}", "received_events_url": "https://api.github.com/users/aclysma/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-08-12T07:37:30Z", "updated_at": "2019-09-09T23:08:51Z", "closed_at": null, "author_association": "NONE", "active_lock_reason": null, "body": "I'm trying to use the \"profile-overrides\" feature in cargo. The tracking issue for this feature is here: https://github.com/rust-lang/rust/issues/48683\r\n\r\nThe documentation for this is here: https://doc.rust-lang.org/cargo/reference/unstable.html#profile-overrides\r\n\r\nI'm trying to build my crate without optimizations, and upstream crates with optimizations. (The application runs too slowly to properly test if the upstream crates are not optimized.)\r\n\r\nMy .toml looks like this:\r\n```toml\r\n[profile.dev]\r\nopt-level = 0\r\n\r\n[profile.dev.overrides.\"*\"]\r\nopt-level = 3\r\n```\r\n\r\nI have a minimum reproducible example here: https://github.com/aclysma/mre-optimize-dependencies-only\r\n\r\nThe \"slow\" crate is nphysics. The minimum reproducible example contains a \"main\" root crate and a shim crate. Both have nearly the same code, but behave differently:\r\n * If I call nphysics code from the root crate (that should have optimizations disabled,) it appears in the debugger that the nphysics code is unoptimized.\r\n * If I call the code from the shim crate (that should have optimizations enabled,) the nphysics code is optimized.\r\n\r\n**Expected Behavior:** the linked binary would have a single implementation for any functions in nphysics, and all call sites would jump to that one address\r\n**Observed Behavior:** My linked executable appears to have both an unoptimized and optimized version of nphysics, and depending on if the caller is optimized or not, the jump goes to a different address.", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/63484/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/63484/timeline", "performed_via_github_app": null, "state_reason": null}