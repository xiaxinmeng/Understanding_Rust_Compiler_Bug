{"url": "https://api.github.com/repos/rust-lang/rust/issues/93055", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/93055/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/93055/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/93055/events", "html_url": "https://github.com/rust-lang/rust/issues/93055", "id": 1107497265, "node_id": "I_kwDOAAsO6M5CAxEx", "number": 93055, "title": "Insufficient test coverage for `Stdin::Read` on Windows \"console mode\"", "user": {"login": "Patrick-Poitras", "id": 42386710, "node_id": "MDQ6VXNlcjQyMzg2NzEw", "avatar_url": "https://avatars.githubusercontent.com/u/42386710?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Patrick-Poitras", "html_url": "https://github.com/Patrick-Poitras", "followers_url": "https://api.github.com/users/Patrick-Poitras/followers", "following_url": "https://api.github.com/users/Patrick-Poitras/following{/other_user}", "gists_url": "https://api.github.com/users/Patrick-Poitras/gists{/gist_id}", "starred_url": "https://api.github.com/users/Patrick-Poitras/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Patrick-Poitras/subscriptions", "organizations_url": "https://api.github.com/users/Patrick-Poitras/orgs", "repos_url": "https://api.github.com/users/Patrick-Poitras/repos", "events_url": "https://api.github.com/users/Patrick-Poitras/events{/privacy}", "received_events_url": "https://api.github.com/users/Patrick-Poitras/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 123109, "node_id": "MDU6TGFiZWwxMjMxMDk=", "url": "https://api.github.com/repos/rust-lang/rust/labels/O-windows", "name": "O-windows", "color": "6e6ec0", "default": false, "description": "Operating system: Windows"}, {"id": 234876, "node_id": "MDU6TGFiZWwyMzQ4NzY=", "url": "https://api.github.com/repos/rust-lang/rust/labels/E-hard", "name": "E-hard", "color": "02e10c", "default": false, "description": "Call for participation: Experience needed to fix: Hard / a lot"}, {"id": 46741598, "node_id": "MDU6TGFiZWw0Njc0MTU5OA==", "url": "https://api.github.com/repos/rust-lang/rust/labels/E-needs-test", "name": "E-needs-test", "color": "02e10c", "default": false, "description": "Call for participation: writing correctness tests"}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}, {"id": 2011781731, "node_id": "MDU6TGFiZWwyMDExNzgxNzMx", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-libs", "name": "T-libs", "color": "bfd4f2", "default": false, "description": "Relevant to the library team, which will review and decide on the PR/issue."}, {"id": 2238437210, "node_id": "MDU6TGFiZWwyMjM4NDM3MjEw", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-io", "name": "A-io", "color": "f7e101", "default": false, "description": "Area: std::io, std::fs, std::net and std::path"}, {"id": 2483744621, "node_id": "MDU6TGFiZWwyNDgzNzQ0NjIx", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-code-coverage", "name": "A-code-coverage", "color": "f7e101", "default": false, "description": "Area: Source-based code coverage (-Cinstrument-coverage)"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-01-19T00:23:33Z", "updated_at": "2022-01-19T00:40:02Z", "closed_at": null, "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "While implementing #91754, we came across a lack of test coverage for `Stdin::Read`. The function has two code paths, one of which is triggered when input is piped in, and the other is triggered when the user is calling the executable from the console. This \"console mode\" code path is, as far as I'm able to tell, entirely ignored by automated tests and the CI.\r\n\r\n\r\n\r\nI was unable to get anything near automated to actually use the console mode. However, manually feeding it inputs is easy, and has been the main method of testing that code path since the path's creation. This is sub-optimal, and should be remedied.\r\n\r\nWe have a couple approaches that could be attempted, but I seek larger input from the community, since this is not a trivial problem. \r\n\r\n- Finding a way to mock the console mode in Windows\r\n- Have a toggleable flag that would allow for the console mode path to be diverted during testing. (This one I could implement, but I'd need to make sure it respects policy)\r\n- Not doing anything. As of now, this approach seems to not have caused very many issues. \r\n", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/93055/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/93055/timeline", "performed_via_github_app": null, "state_reason": null}