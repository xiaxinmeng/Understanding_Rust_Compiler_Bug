{"url": "https://api.github.com/repos/rust-lang/rust/issues/36708", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/36708/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/36708/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/36708/events", "html_url": "https://github.com/rust-lang/rust/issues/36708", "id": 179062272, "node_id": "MDU6SXNzdWUxNzkwNjIyNzI=", "number": 36708, "title": "Extra type parameters make compiler panic calling `Option::unwrap()` on `None`", "user": {"login": "raviqqe", "id": 9584358, "node_id": "MDQ6VXNlcjk1ODQzNTg=", "avatar_url": "https://avatars.githubusercontent.com/u/9584358?v=4", "gravatar_id": "", "url": "https://api.github.com/users/raviqqe", "html_url": "https://github.com/raviqqe", "followers_url": "https://api.github.com/users/raviqqe/followers", "following_url": "https://api.github.com/users/raviqqe/following{/other_user}", "gists_url": "https://api.github.com/users/raviqqe/gists{/gist_id}", "starred_url": "https://api.github.com/users/raviqqe/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/raviqqe/subscriptions", "organizations_url": "https://api.github.com/users/raviqqe/orgs", "repos_url": "https://api.github.com/users/raviqqe/repos", "events_url": "https://api.github.com/users/raviqqe/events{/privacy}", "received_events_url": "https://api.github.com/users/raviqqe/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}, {"id": 147085028, "node_id": "MDU6TGFiZWwxNDcwODUwMjg=", "url": "https://api.github.com/repos/rust-lang/rust/labels/regression-from-stable-to-nightly", "name": "regression-from-stable-to-nightly", "color": "e4008a", "default": false, "description": "Performance or correctness regression from stable to nightly."}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}], "state": "closed", "locked": false, "assignee": {"login": "TimNN", "id": 1178249, "node_id": "MDQ6VXNlcjExNzgyNDk=", "avatar_url": "https://avatars.githubusercontent.com/u/1178249?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TimNN", "html_url": "https://github.com/TimNN", "followers_url": "https://api.github.com/users/TimNN/followers", "following_url": "https://api.github.com/users/TimNN/following{/other_user}", "gists_url": "https://api.github.com/users/TimNN/gists{/gist_id}", "starred_url": "https://api.github.com/users/TimNN/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TimNN/subscriptions", "organizations_url": "https://api.github.com/users/TimNN/orgs", "repos_url": "https://api.github.com/users/TimNN/repos", "events_url": "https://api.github.com/users/TimNN/events{/privacy}", "received_events_url": "https://api.github.com/users/TimNN/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "TimNN", "id": 1178249, "node_id": "MDQ6VXNlcjExNzgyNDk=", "avatar_url": "https://avatars.githubusercontent.com/u/1178249?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TimNN", "html_url": "https://github.com/TimNN", "followers_url": "https://api.github.com/users/TimNN/followers", "following_url": "https://api.github.com/users/TimNN/following{/other_user}", "gists_url": "https://api.github.com/users/TimNN/gists{/gist_id}", "starred_url": "https://api.github.com/users/TimNN/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TimNN/subscriptions", "organizations_url": "https://api.github.com/users/TimNN/orgs", "repos_url": "https://api.github.com/users/TimNN/repos", "events_url": "https://api.github.com/users/TimNN/events{/privacy}", "received_events_url": "https://api.github.com/users/TimNN/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2016-09-25T01:40:59Z", "updated_at": "2017-03-24T19:20:53Z", "closed_at": "2016-09-25T15:08:27Z", "author_association": "NONE", "active_lock_reason": null, "body": "This works.\n\n```\nuse std::ops::Div;\n\nstruct Foo(u64);\n\nimpl Div for Foo {\n  type Output = Self;\n\n  fn div(self, rhs: Self) -> Self::Output {\n    Foo(0)\n  }\n}\n\nfn main() {}\n```\n\nHowever, the code below doesn't because `div` has an extra parametric type `T`. But, the compiler doesn't emit proper error messages and says `the compiler unexpectedly panicked. this is a bug.`.\n\n```\nuse std::ops::Div;\n\nstruct Foo(u64);\n\nimpl Div for Foo {\n  type Output = Self;\n\n  fn div<T>(self, rhs: Self) -> Self::Output {\n    Foo(0)\n  }\n}\n\nfn main() {}\n```\n## Error message\n\n```\n$ rustc main.rs\nerror: internal compiler error: unexpected panic\n\nnote: the compiler unexpectedly panicked. this is a bug.\n\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports                                                         \n\nthread 'rustc' panicked at 'called `Option::unwrap()` on a `None` value', ../src/libcore/option.rs:325\nnote: Run with `RUST_BACKTRACE=1` for a backtrace.\n```\n## Meta\n\n```\n$ rustc --version --verbose\nrustc 1.13.0-nightly (4f9812a59 2016-09-21)\nbinary: rustc\ncommit-hash: 4f9812a59ab7247f0f52b01ca89b0793a2d289c3\ncommit-date: 2016-09-21\nhost: x86_64-unknown-linux-gnu\nrelease: 1.13.0-nightly\n```\n## Backtrace\n\n```\n$ RUST_BACKTRACE=1 rustc main.rs\nerror: internal compiler error: unexpected panic\n\nnote: the compiler unexpectedly panicked. this is a bug.\n\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports                                                                       \n\nnote: run with `RUST_BACKTRACE=1` for a backtrace\n\nthread 'rustc' panicked at 'called `Option::unwrap()` on a `None` value', ../src/libcore/option.rs:325\nstack backtrace:\n   1:     0x7fad5818a612 - std::sys::backtrace::tracing::imp::write::h4b09e6e8c01db097\n   2:     0x7fad5819b42d - std::panicking::default_hook::{{closure}}::h1d3243f546573ff4\n   3:     0x7fad5819887e - std::panicking::default_hook::h96c288d728df3ebf\n   4:     0x7fad58198f68 - std::panicking::rust_panic_with_hook::hb1322e5f2588b4db\n   5:     0x7fad58198e02 - std::panicking::begin_panic::hfbeda5aad583dc32\n   6:     0x7fad58198d40 - std::panicking::begin_panic_fmt::h4fe9fb9d5109c4bf\n   7:     0x7fad58198cc1 - rust_begin_unwind\n   8:     0x7fad581e655c - core::panicking::panic_fmt::h4395919ece15c671\n   9:     0x7fad581e648b - core::panicking::panic::hc74ff52ed78364e1\n  10:     0x7fad5653534c - rustc_typeck::check::compare_method::compare_impl_method::h8b4c10d2a59ffd1f\n  11:     0x7fad5654759f - rustc_typeck::check::check_impl_items_against_trait::h7d9aa9ff182ea156\n  12:     0x7fad565452a8 - rustc_typeck::check::check_item_type::hb34d7fe10dce9af2\n  13:     0x7fad5653eedb - <rustc_typeck::check::CheckItemTypesVisitor<'a, 'tcx> as rustc::hir::intravisit::Visitor<'tcx>>::visit_item::hf0cba92c71ce3aaf\n  14:     0x7fad56540b28 - rustc_typeck::check::check_item_types::hb459f0bcef68d00b\n  15:     0x7fad565acdfe - rustc_typeck::check_crate::h56444fcd0efce52e\n  16:     0x7fad58548941 - rustc_driver::driver::phase_3_run_analysis_passes::{{closure}}::hcac3a2328cd9259a\n  17:     0x7fad5851599e - rustc_driver::driver::phase_3_run_analysis_passes::h9865057b323cad0e\n  18:     0x7fad5850740a - rustc_driver::driver::compile_input::hc0edbed7edb3eb18\n  19:     0x7fad58534d41 - rustc_driver::run_compiler::h22d678d32fb7c300\n  20:     0x7fad5846e763 - std::panicking::try::do_call::h4d040997e2efdaf3\n  21:     0x7fad581a3326 - __rust_maybe_catch_panic\n  22:     0x7fad5848d7b9 - <F as alloc::boxed::FnBox<A>>::call_box::hba0b436c79e56b23\n  23:     0x7fad581972d0 - std::sys::thread::Thread::new::thread_start::h022e3887023c6290\n  24:     0x7fad503ad6f9 - start_thread\n  25:     0x7fad57e58b5c - clone\n  26:                0x0 - <unknown>\n```\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/36708/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/36708/timeline", "performed_via_github_app": null, "state_reason": "completed"}