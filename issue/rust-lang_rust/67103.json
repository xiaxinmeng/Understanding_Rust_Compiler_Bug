{"url": "https://api.github.com/repos/rust-lang/rust/issues/67103", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/67103/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/67103/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/67103/events", "html_url": "https://github.com/rust-lang/rust/issues/67103", "id": 534273050, "node_id": "MDU6SXNzdWU1MzQyNzMwNTA=", "number": 67103, "title": "Make it easier to run build in CI Docker image", "user": {"login": "Aaron1011", "id": 1408859, "node_id": "MDQ6VXNlcjE0MDg4NTk=", "avatar_url": "https://avatars.githubusercontent.com/u/1408859?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Aaron1011", "html_url": "https://github.com/Aaron1011", "followers_url": "https://api.github.com/users/Aaron1011/followers", "following_url": "https://api.github.com/users/Aaron1011/following{/other_user}", "gists_url": "https://api.github.com/users/Aaron1011/gists{/gist_id}", "starred_url": "https://api.github.com/users/Aaron1011/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Aaron1011/subscriptions", "organizations_url": "https://api.github.com/users/Aaron1011/orgs", "repos_url": "https://api.github.com/users/Aaron1011/repos", "events_url": "https://api.github.com/users/Aaron1011/events{/privacy}", "received_events_url": "https://api.github.com/users/Aaron1011/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 234902, "node_id": "MDU6TGFiZWwyMzQ5MDI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-enhancement", "name": "C-enhancement", "color": "f5f1fd", "default": false, "description": "Category: An issue proposing an enhancement or a PR with one."}, {"id": 325438536, "node_id": "MDU6TGFiZWwzMjU0Mzg1MzY=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-bootstrap", "name": "T-bootstrap", "color": "bfd4f2", "default": false, "description": "Relevant to the bootstrap subteam: Rust's build system (x.py and src/bootstrap)"}, {"id": 593503757, "node_id": "MDU6TGFiZWw1OTM1MDM3NTc=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-infra", "name": "T-infra", "color": "bfd4f2", "default": false, "description": "Relevant to the infrastructure team, which will review and decide on the PR/issue."}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-12-06T21:48:13Z", "updated_at": "2019-12-06T23:00:40Z", "closed_at": null, "author_association": "MEMBER", "active_lock_reason": null, "body": "The `isCiBranch` function now requires either the Azure Pipelines or Github Actions check to pass:\r\n\r\nhttps://github.com/rust-lang/rust/blob/9630dbbc3caca60f2482e6eae8904aa6bda54f93/src/ci/shared.sh#L60-L67\r\n\r\nThis means that a plain `./src/ci/docker/run.sh $image_name` will no longer work. Setting `TF_BUILD=True` appears to work, as it makes the script think it's running on Azure pipelines. However, discovering this required digging around in several shell scripts, and I'm not totally sure that it does the right thing.\r\n\r\nAdditionally, the `./src/ci/docker/run.sh` is not very discoverable - I don't think it's mentioned outside of the CI scripts and the README in `./src/ci/docker`.\r\n\r\nIt would be nice if there was a simple way to do a local build of the compiler in a given Docker image (perhaps a top-level script adjacent to `x.py`). This would simplify debugging PRs where the PR builder tests pass, but the full merge-commit test suite fails.", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/67103/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/67103/timeline", "performed_via_github_app": null, "state_reason": null}