{"url": "https://api.github.com/repos/rust-lang/rust/issues/99158", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/99158/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/99158/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/99158/events", "html_url": "https://github.com/rust-lang/rust/issues/99158", "id": 1300907770, "node_id": "I_kwDOAAsO6M5Nikb6", "number": 99158, "title": "Implied bounds of function are not enforced if you don't call it directly. (But you can call it indirectly...) (Somehow, variance is involved even though it didn\u2019t look like it initially\u2026)", "user": {"login": "steffahn", "id": 3986214, "node_id": "MDQ6VXNlcjM5ODYyMTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3986214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/steffahn", "html_url": "https://github.com/steffahn", "followers_url": "https://api.github.com/users/steffahn/followers", "following_url": "https://api.github.com/users/steffahn/following{/other_user}", "gists_url": "https://api.github.com/users/steffahn/gists{/gist_id}", "starred_url": "https://api.github.com/users/steffahn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/steffahn/subscriptions", "organizations_url": "https://api.github.com/users/steffahn/orgs", "repos_url": "https://api.github.com/users/steffahn/repos", "events_url": "https://api.github.com/users/steffahn/events{/privacy}", "received_events_url": "https://api.github.com/users/steffahn/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 37544, "node_id": "MDU6TGFiZWwzNzU0NA==", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-typesystem", "name": "A-typesystem", "color": "f7e101", "default": false, "description": "Area: The type system"}, {"id": 1775993, "node_id": "MDU6TGFiZWwxNzc1OTkz", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-lifetimes", "name": "A-lifetimes", "color": "f7e101", "default": false, "description": "Area: lifetime related"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 267612997, "node_id": "MDU6TGFiZWwyNjc2MTI5OTc=", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-unsound", "name": "I-unsound", "color": "e11d21", "default": false, "description": "Issue: A soundness hole (worst kind of bug), see: https://en.wikipedia.org/wiki/Soundness"}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2022-07-11T15:53:19Z", "updated_at": "2022-07-11T22:45:16Z", "closed_at": "2022-07-11T16:24:44Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "I would be surprised if this wasn\u2019t a known issue, presumably I might have even looked at it myself in the past\u2026 I\u2019m not able to find it though at the moment using keywords from this title on `I-unsound` issues, so let me file this anyway\u2026 _(and in case it\u2019s indeed a duplicate, I at least gain an appropriately named closed issue so I can better find this in the future)_.\r\n\r\n---\r\n\r\nHere\u2019s the code\r\n```rs\r\nfn extend_with_proof<'a>(\r\n    _proof: std::marker::PhantomData<&'static &'a ()>,\r\n    x: &'a str,\r\n) -> &'static str {\r\n    x\r\n}\r\n\r\nfn call_with_fake_proof<'a, T: Default>(\r\n    extend_with_proof_ptr: fn(_proof: T, &'a str) -> &'static str,\r\n    s: &'a str,\r\n) -> &'static str {\r\n    extend_with_proof_ptr(Default::default(), s)\r\n}\r\n\r\nfn main() {\r\n    let r = {\r\n        let s = String::from(\"Hello World!\");\r\n        call_with_fake_proof(extend_with_proof, &s)\r\n    };\r\n    println!(\"{r}\");\r\n}\r\n```\r\n```\r\n(prints garbage due to use-after-free on the deallocated `String` data)\r\n```\r\n([playground](https://play.rust-lang.org/?version=stable&mode=debug&edition=2021&gist=b3815c3db18c96c7ddd3f34983e74e6a))\r\n\r\n@rustbot label I-unsound, A-lifetimes, A-typesystem, T-compiler", "closed_by": {"login": "steffahn", "id": 3986214, "node_id": "MDQ6VXNlcjM5ODYyMTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3986214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/steffahn", "html_url": "https://github.com/steffahn", "followers_url": "https://api.github.com/users/steffahn/followers", "following_url": "https://api.github.com/users/steffahn/following{/other_user}", "gists_url": "https://api.github.com/users/steffahn/gists{/gist_id}", "starred_url": "https://api.github.com/users/steffahn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/steffahn/subscriptions", "organizations_url": "https://api.github.com/users/steffahn/orgs", "repos_url": "https://api.github.com/users/steffahn/repos", "events_url": "https://api.github.com/users/steffahn/events{/privacy}", "received_events_url": "https://api.github.com/users/steffahn/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/99158/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/99158/timeline", "performed_via_github_app": null, "state_reason": "completed"}