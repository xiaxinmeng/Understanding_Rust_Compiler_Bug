{"url": "https://api.github.com/repos/rust-lang/rust/issues/56105", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/56105/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/56105/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/56105/events", "html_url": "https://github.com/rust-lang/rust/issues/56105", "id": 382740720, "node_id": "MDU6SXNzdWUzODI3NDA3MjA=", "number": 56105, "title": "tracking issue for \"universe transition\"", "user": {"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1775993, "node_id": "MDU6TGFiZWwxNzc1OTkz", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-lifetimes", "name": "A-lifetimes", "color": "f7e101", "default": false, "description": "Area: lifetime related"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 650846969, "node_id": "MDU6TGFiZWw2NTA4NDY5Njk=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-tracking-issue", "name": "C-tracking-issue", "color": "f5f1fd", "default": false, "description": "Category: A tracking issue for an RFC or an unstable feature."}, {"id": 3537211959, "node_id": "LA_kwDOAAsO6M7S1ZI3", "url": "https://api.github.com/repos/rust-lang/rust/labels/S-tracking-impl-incomplete", "name": "S-tracking-impl-incomplete", "color": "4682b4", "default": false, "description": ""}, {"id": 4172483496, "node_id": "LA_kwDOAAsO6M74swuo", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-types", "name": "T-types", "color": "bfd4f2", "default": false, "description": "Relevant to the types team, which will review and decide on the PR/issue."}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 21, "created_at": "2018-11-20T16:19:25Z", "updated_at": "2022-11-06T20:40:33Z", "closed_at": null, "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "This is the **tracking issue** for the \"universe transition\". The goal of this page is describe why this change was made and how you can fix code that is affected by it. It also provides a place to ask questions or register a complaint if you feel the change should not be made. For more information on the policy around bug fixes that affect existing code, see our [breaking change policy guidelines][guidelines].\r\n\r\n[guidelines]: https://forge.rust-lang.org/rustc-bug-fix-procedure.html\r\n\r\n#### What was the change and what code is affected?\r\n\r\nThis change (introduced in https://github.com/rust-lang/rust/pull/55517) fixed a number of bugs (e.g., https://github.com/rust-lang/rust/issues/32330) in how the Rust compiler handled higher-ranked types (e.g., `fn(&u8)` or -- more explicitly -- `for<'a> fn(&'a u8)`) and trait bounds (e.g., `for<'a> T: Trait<'a>`). One of these changes could however affect existing code. In particular, the compiler in the past would accept trait implementations for identical functions that differed only in where the lifetime binder appeared:\r\n\r\n```rust\r\ntrait SomeTrait { }\r\nimpl SomeTrait for for<'a> fn(&'a u8) { }\r\nimpl<'a> SomeTrait for fn(&'a u8) { }\r\n```\r\n\r\nWe no longer accept both of these impls. Code relying on this pattern would now have to introduce \"newtypes\", like `struct Foo(for<'a> fn(&'a u8))`. \r\n\r\n#### History of this change\r\n\r\nThis change was first made in #55517 without a \"warning period\". This was done because (a) it would be challenging to issue precise warnings for affected code and (b) a crater run found zero regressions.\r\n\r\nHowever, the change was subsequently backed out in https://github.com/rust-lang/rust/pull/58592, [owing to concerns about unintended side-effects](https://github.com/rust-lang/rust/issues/56105#issuecomment-465634661).\r\n\r\nThe change was re-added in https://github.com/rust-lang/rust/pull/65232, but this time with a warning period. We are currently completing the implementation and trying to figure out how to draw the line in terms of what should become a hard error.\r\n\r\n#### Affected crates and patterns\r\n\r\nThis section is for collecting patterns and examples to look into or other related issues.\r\n\r\n* wasm-bindgen was reported to get warnings in #65232\r\n* @quark-zju commented that their crate was affected [here](https://github.com/rust-lang/rust/issues/56105#issuecomment-606379619)\r\n* https://github.com/rust-lang/rust/issues/73154 -- order dependent coercion", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/56105/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/56105/timeline", "performed_via_github_app": null, "state_reason": null}