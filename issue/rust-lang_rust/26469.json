{"url": "https://api.github.com/repos/rust-lang/rust/issues/26469", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/26469/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/26469/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/26469/events", "html_url": "https://github.com/rust-lang/rust/issues/26469", "id": 89911748, "node_id": "MDU6SXNzdWU4OTkxMTc0OA==", "number": 26469, "title": "LLVM Silent abort (stack overflow) when compiling kernel", "user": {"login": "thepowersgang", "id": 955596, "node_id": "MDQ6VXNlcjk1NTU5Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/955596?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thepowersgang", "html_url": "https://github.com/thepowersgang", "followers_url": "https://api.github.com/users/thepowersgang/followers", "following_url": "https://api.github.com/users/thepowersgang/following{/other_user}", "gists_url": "https://api.github.com/users/thepowersgang/gists{/gist_id}", "starred_url": "https://api.github.com/users/thepowersgang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thepowersgang/subscriptions", "organizations_url": "https://api.github.com/users/thepowersgang/orgs", "repos_url": "https://api.github.com/users/thepowersgang/repos", "events_url": "https://api.github.com/users/thepowersgang/events{/privacy}", "received_events_url": "https://api.github.com/users/thepowersgang/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2015-06-21T13:25:33Z", "updated_at": "2015-08-14T12:44:08Z", "closed_at": "2015-08-14T12:44:08Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "(sorry for the lack of details, hard to trace)\nWhen compiling my kernel [Link](https://github.com/thepowersgang/rust_os) with latest nightly rustc (`rustc 1.2.0-nightly (a9515698f 2015-06-20)`) the compiler terminates with just \"Undefined instruction\". Inspecting the core file shows that the instruction was 'ud2', and that the cause was a stack overflow.\n\n```\n(gdb) bt\n#0  0x00007fc9de0800e0 in sys::stack_overflow::imp::signal_handler::h4c97e241e314baeenDv () from ../.prefix/lib/libstd-11582ce5.so\n#1  <signal handler called>\n#2  0x00007fc9d942402b in (anonymous namespace)::MachineCSE::ProcessBlock(llvm::MachineBasicBlock*) () from ../.prefix/lib/librustc_llvm-11582ce5.so\n#3  0x00007fc9d9426010 in (anonymous namespace)::MachineCSE::PerformCSE(llvm::DomTreeNodeBase<llvm::MachineBasicBlock>*) () from ../.prefix/lib/librustc_llvm-11582ce5.so\n#4  0x00007fc9d9c147bf in llvm::FPPassManager::runOnFunction(llvm::Function&) () from ../.prefix/lib/librustc_llvm-11582ce5.so\n#5  0x00007fc9d9c147fb in llvm::FPPassManager::runOnModule(llvm::Module&) () from ../.prefix/lib/librustc_llvm-11582ce5.so\n#6  0x00007fc9d9c143bf in llvm::legacy::PassManagerImpl::run(llvm::Module&) () from ../.prefix/lib/librustc_llvm-11582ce5.so\n#7  0x00007fc9d892183f in LLVMRustWriteOutputFile (Target=0x7fc9c08373d0, PMR=0x7fc9d10470f0, M=0x7fc9d00040c0, path=0x7fc9d4c2a500 \".obj/amd64/kernel.0.o\", FileType=llvm::TargetMachine::CGFT_ObjectFile)\n    at /home/rustbuild/src/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/rustllvm/PassWrapper.cpp:249\n#8  0x00007fc9dcdd329b in back::write::write_output_file::h7cc516fb9f1810cdjoc () from ../.prefix/lib/librustc_trans-11582ce5.so\n#9  0x00007fc9dcdd5b35 in back::write::optimize_and_codegen::closure.40845 () from ../.prefix/lib/librustc_trans-11582ce5.so\n#10 0x00007fc9dcddf75a in back::write::execute_work_item::he4deaa7da8a0365b9id () from ../.prefix/lib/librustc_trans-11582ce5.so\n#11 0x00007fc9dcdd7527 in back::write::run_passes::h3a37d779c403e7faVYc () from ../.prefix/lib/librustc_trans-11582ce5.so\n#12 0x00007fc9de5f31e6 in driver::phase_5_run_llvm_passes::h196d0b9e670acdfaDPa () from ../.prefix/lib/librustc_driver-11582ce5.so\n#13 0x00007fc9de5c4108 in driver::compile_input::hba3e26f2cba2be27Tba () from ../.prefix/lib/librustc_driver-11582ce5.so\n#14 0x00007fc9de6ab7db in run_compiler::h3b9f1d0853ded84547b () from ../.prefix/lib/librustc_driver-11582ce5.so\n#15 0x00007fc9de6a8db7 in boxed::F.FnBox$LT$A$GT$::call_box::h14102988289798375631 () from ../.prefix/lib/librustc_driver-11582ce5.so\n#16 0x00007fc9de6a85ba in rt::unwind::try::try_fn::h11631987993001963535 () from ../.prefix/lib/librustc_driver-11582ce5.so\n#17 0x00007fc9de0fded9 in rust_try_inner () from ../.prefix/lib/libstd-11582ce5.so\n#18 0x00007fc9de0fdec6 in rust_try () from ../.prefix/lib/libstd-11582ce5.so\n#19 0x00007fc9de06c148 in rt::unwind::try::inner_try::h18f1f3c9b9ec8956DLw () from ../.prefix/lib/libstd-11582ce5.so\n#20 0x00007fc9de6a87da in boxed::F.FnBox$LT$A$GT$::call_box::h12282811619045320965 () from ../.prefix/lib/librustc_driver-11582ce5.so\n#21 0x00007fc9de080182 in sys::thread::Thread::new::thread_start::h6ee35face9d3fb15AVv () from ../.prefix/lib/libstd-11582ce5.so\n#22 0x00007fc9d7c256aa in start_thread (arg=0x7fc9d5bff700) at pthread_create.c:333\n#23 0x00007fc9ddccbeed in clone () at ../sysdeps/unix/sysv/linux/x86_64/clone.S:109\n```\n\nCurrently, the only way I have of reproducing this particular failure is to compile my kernel. Revision [0fcca1e2ed4](https://github.com/thepowersgang/rust_os/tree/0fcca1e2ed4adbe3dca040a96cb59dc6beff36ae) should exhibit it. Run the following commands to build (it will download rustc nightly into a local directory):\n\n```\nmake -C Kernel/ UPDATE\nmake -C Kernel/ .obj/amd64/libkernel.rlib\n```\n", "closed_by": {"login": "thepowersgang", "id": 955596, "node_id": "MDQ6VXNlcjk1NTU5Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/955596?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thepowersgang", "html_url": "https://github.com/thepowersgang", "followers_url": "https://api.github.com/users/thepowersgang/followers", "following_url": "https://api.github.com/users/thepowersgang/following{/other_user}", "gists_url": "https://api.github.com/users/thepowersgang/gists{/gist_id}", "starred_url": "https://api.github.com/users/thepowersgang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thepowersgang/subscriptions", "organizations_url": "https://api.github.com/users/thepowersgang/orgs", "repos_url": "https://api.github.com/users/thepowersgang/repos", "events_url": "https://api.github.com/users/thepowersgang/events{/privacy}", "received_events_url": "https://api.github.com/users/thepowersgang/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/26469/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/26469/timeline", "performed_via_github_app": null, "state_reason": "completed"}