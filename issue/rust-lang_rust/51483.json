{"url": "https://api.github.com/repos/rust-lang/rust/issues/51483", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/51483/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/51483/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/51483/events", "html_url": "https://github.com/rust-lang/rust/issues/51483", "id": 331013526, "node_id": "MDU6SXNzdWUzMzEwMTM1MjY=", "number": 51483, "title": "\"internal compiler error: unexpected panic\" when building Firefox", "user": {"login": "h-h-h-h", "id": 13482553, "node_id": "MDQ6VXNlcjEzNDgyNTUz", "avatar_url": "https://avatars.githubusercontent.com/u/13482553?v=4", "gravatar_id": "", "url": "https://api.github.com/users/h-h-h-h", "html_url": "https://github.com/h-h-h-h", "followers_url": "https://api.github.com/users/h-h-h-h/followers", "following_url": "https://api.github.com/users/h-h-h-h/following{/other_user}", "gists_url": "https://api.github.com/users/h-h-h-h/gists{/gist_id}", "starred_url": "https://api.github.com/users/h-h-h-h/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/h-h-h-h/subscriptions", "organizations_url": "https://api.github.com/users/h-h-h-h/orgs", "repos_url": "https://api.github.com/users/h-h-h-h/repos", "events_url": "https://api.github.com/users/h-h-h-h/events{/privacy}", "received_events_url": "https://api.github.com/users/h-h-h-h/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2018-06-10T23:53:44Z", "updated_at": "2019-01-11T00:50:04Z", "closed_at": "2019-01-11T00:50:03Z", "author_association": "NONE", "active_lock_reason": null, "body": "I wanted to build Firefox for a second time, when this happened.\r\n\r\n### System and build environment:\r\n\r\n- Windows 10 (64-bit)\r\n- Visual Studio 2017 15.6 (reinstall)\r\n- Windows SDK 10.0.17134.12 installed with dedicated installer\r\n- Output of `rustup show`:\r\n\r\n```\r\nDefault host: x86_64-pc-windows-msvc\r\n\r\ninstalled toolchains\r\n--------------------\r\n\r\nstable-x86_64-pc-windows-msvc (default)\r\nnightly-x86_64-pc-windows-msvc\r\n\r\ninstalled targets for active toolchain\r\n--------------------------------------\r\n\r\ni686-pc-windows-msvc\r\nx86_64-pc-windows-msvc\r\n\r\nactive toolchain\r\n----------------\r\n\r\nstable-x86_64-pc-windows-msvc (default)\r\nrustc 1.26.0 (a77568041 2018-05-07)\r\n```\r\n\r\n---\r\n\r\n### My actions were these:\r\n\r\n(Rudimentarily simplified; e.g., there may have been multiple `...run` calls.)\r\n\r\n- I cloned the `mozilla-central` repo with TortoiseHg\r\n- I changed C++ files\r\n- I ran in the Mozilla building console:\r\n\t- `./mach build && ./mach run`\r\n\t\t- Successful\r\n\t- `./mach gtest`\r\n\t\t- 8 failed tests\r\n- I shelved my changes in the Mercurial repo to get back to the last official state\r\n- I ran:\r\n\t- `./mach build && ./mach gtest`\r\n\t\t- Error--output below\r\n\r\n```\r\n 0:07.68 Clobber not needed.\r\n 0:07.73 Adding make options from c:\\mozilla-source\\mozilla-central\\mozconfig\r\n    MOZ_OBJDIR=c:/mozilla-source/mozilla-central/obj-i686-pc-mingw32\r\n    OBJDIR=c:/mozilla-source/mozilla-central/obj-i686-pc-mingw32\r\n    FOUND_MOZCONFIG=c:/mozilla-source/mozilla-central/mozconfig\r\n    export FOUND_MOZCONFIG\r\n 0:08.35 c:\\mozilla-build\\bin\\mozmake.EXE -f client.mk -s\r\n 0:17.83 Elapsed: 0.02s; From dist/public: Kept 0 existing; Added/updated 0; Removed 0 files and 0 directories.\r\n 0:18.69 Elapsed: 0.01s; From dist/private: Kept 0 existing; Added/updated 0; Removed 0 files and 0 directories.\r\n 0:19.64 Elapsed: 0.04s; From dist/xpi-stage: Kept 7 existing; Added/updated 0; Removed 0 files and 0 directories.\r\n 0:25.31 Elapsed: 4.71s; From _tests: Kept 0 existing; Added/updated 1031; Removed 0 files and 0 directories.\r\n 0:25.61 Elapsed: 7.80s; From dist/include: Kept 0 existing; Added/updated 5427; Removed 0 files and 0 directories.\r\n 0:30.18 Elapsed: 3.95s; From dist/bin: Kept 0 existing; Added/updated 2371; Removed 0 files and 0 directories.\r\n 0:46.79 force-cargo-library-build\r\n 0:50.94 xpcom/base\r\n 1:00.36 \u001b[0m\u001b[0m\u001b[1m\u001b[32m   Compiling\u001b[0m style v0.0.1 (file:///C:/mozilla-source/mozilla-central/servo/components/style)\r\n 1:25.96 Unified_cpp_xpcom_base0.cpp\r\n 1:27.63 xpcom/threads\r\n 2:04.89 Unified_cpp_xpcom_threads0.cpp\r\n 2:31.21 Unified_cpp_xpcom_threads1.cpp\r\n 2:43.25 Unified_cpp_xpcom_threads2.cpp\r\n 2:43.58 xpcom/reflect/xptinfo\r\n 3:01.16 xptdata.cpp\r\n 3:01.72 xpcom/build\r\n 3:36.04 Unified_cpp_xpcom_build0.cpp\r\n 3:36.38 xpcom/tests/gtest\r\n 3:47.75 thread 'rustc' panicked at 'internal error: entered unreachable code', librustc\\ty\\sty.rs:82:61\r\n 3:48.17 stack backtrace:\r\n 3:48.19    0:     0x7ffabef7544a - std::rt::lang_start_internal::h0b236706d34ac613\r\n 3:48.19    1:     0x7ffabef76a9f - std::sys::windows::c::TryAcquireSRWLockShared::h1370a338b486c9b7\r\n 3:48.19    2:     0x7ffabef8ab6e - std::panicking::take_hook::hd0e743b59a088c6a\r\n 3:48.21    3:     0x7ffabef8a81a - std::panicking::take_hook::hd0e743b59a088c6a\r\n 3:48.25    4:     0x7ffabc4060dd - rustc::ty::maps::on_disk_cache::__ty_decoder_impl::<impl serialize::serialize::Decoder for rustc::ty::maps::on_disk_cache::CacheDecoder<'a, 'tcx, 'x>>::read_str::ha986e467fbe52885\r\n 3:48.25    5:     0x7ffabef8b145 - std::panicking::rust_panic_with_hook::ha2a965a4111f8c00\r\n 3:48.25    6:     0x7ffabc734d54 - <alloc::vec::Vec<(alloc::string::String, u64)> as rustc::session::config::dep_tracking::DepTrackingHash>::hash::h956158630023dd90\r\n 3:48.25    7:     0x7ffabc3dd46a - <rustc::util::fs::RenameOrCopyRemove as core::fmt::Debug>::fmt::h01127f38976e897e\r\n 3:48.25    8:     0x7ffabc3fdfc8 - rustc::ty::maps::on_disk_cache::__ty_decoder_impl::<impl serialize::serialize::SpecializedDecoder<&'tcx rustc::ty::TyS<'tcx>> for rustc::ty::maps::on_disk_cache::CacheDecoder<'a, 'tcx, 'x>>::specialized_decode::hb1664b85ec944159\r\n 3:48.29    9:     0x7ffabc3fe194 - rustc::ty::maps::on_disk_cache::__ty_decoder_impl::<impl serialize::serialize::SpecializedDecoder<&'tcx rustc::ty::TyS<'tcx>> for rustc::ty::maps::on_disk_cache::CacheDecoder<'a, 'tcx, 'x>>::specialized_decode::hb1664b85ec944159\r\n 3:48.35   10:     0x7ffabc3fe194 - rustc::ty::maps::on_disk_cache::__ty_decoder_impl::<impl serialize::serialize::SpecializedDecoder<&'tcx rustc::ty::TyS<'tcx>> for rustc::ty::maps::on_disk_cache::CacheDecoder<'a, 'tcx, 'x>>::specialized_decode::hb1664b85ec944159\r\n 3:48.40   11:     0x7ffabc3d7e5b - <rustc::util::fs::RenameOrCopyRemove as core::fmt::Debug>::fmt::h01127f38976e897e\r\n 3:48.44   12:     0x7ffabc3cfa42 - <rustc::util::fs::RenameOrCopyRemove as core::fmt::Debug>::fmt::h01127f38976e897e\r\n 3:48.45   13:     0x7ffabc40014f - rustc::ty::maps::on_disk_cache::__ty_decoder_impl::<impl serialize::serialize::Decoder for rustc::ty::maps::on_disk_cache::CacheDecoder<'a, 'tcx, 'x>>::read_str::ha986e467fbe52885\r\n 3:48.48   14:     0x7ffabc3f76ac - rustc::ty::maps::on_disk_cache::OnDiskCache::store_diagnostics::hbfd2a44592fae82d\r\n 3:48.48   15:     0x7ffabc0a7f31 - <rustc::ty::maps::queries::typeck_tables_of<'tcx> as rustc::ty::maps::config::QueryDescription<'tcx>>::try_load_from_disk::hb08f967e89590112\r\n 3:48.54   16:     0x7ffabc0de78a - rustc::ty::maps::<impl rustc::ty::maps::queries::typeck_tables_of<'tcx>>::try_get::hf934b09f8319ced7\r\n 3:48.57   17:     0x7ffabc4ed03f - rustc::ty::maps::TyCtxtAt::typeck_tables_of::ha950b560364d4285\r\n 3:48.59   18:     0x7ffabc4e9265 - rustc::ty::maps::<impl rustc::ty::context::TyCtxt<'a, 'tcx, 'lcx>>::typeck_tables_of::h10abdd00309e9eef\r\n 3:48.60   19:     0x7ffae8e83770 - <rustc_privacy::NamePrivacyVisitor<'a, 'tcx> as rustc::hir::intravisit::Visitor<'tcx>>::visit_impl_item::h09aac928c5d6fc4b\r\n 3:48.63   20:     0x7ffae8e747e5 - <unknown>\r\n 3:48.68   21:     0x7ffae8e7bb2e - <unknown>\r\n 3:48.68   22:     0x7ffae8e834d6 - <rustc_privacy::NamePrivacyVisitor<'a, 'tcx> as rustc::hir::intravisit::Visitor<'tcx>>::visit_item::h6f4ee6175a2d579b\r\n 3:48.69   23:     0x7ffae8e7b6f3 - <unknown>\r\n 3:48.76   24:     0x7ffae8e834d6 - <rustc_privacy::NamePrivacyVisitor<'a, 'tcx> as rustc::hir::intravisit::Visitor<'tcx>>::visit_item::h6f4ee6175a2d579b\r\n 3:48.85   25:     0x7ffae8e88866 - rustc_privacy::check_crate::hdccd2485f5228ed5\r\n 3:48.95   26:     0x7ffabc1f41c5 - rustc::ty::maps::<impl rustc::ty::maps::queries::wasm_import_module_map<'tcx>>::try_get::h6dec423537c382bd\r\n 3:49.03   27:     0x7ffabc476bfd - <rustc::ty::context::TyCtxt<'a, 'gcx, 'tcx> as rustc::ty::layout::HasTyCtxt<'gcx>>::tcx::he1280f084132a836\r\n 3:49.08   28:     0x7ffabc0ef203 - rustc::ty::maps::<impl rustc::ty::maps::queries::privacy_access_levels<'tcx>>::try_get::ha9f349bc3338225a\r\n 3:49.16   29:     0x7ffabc4edb76 - rustc::ty::maps::TyCtxtAt::privacy_access_levels::hfa32703d8c6d344c\r\n 3:49.22   30:     0x7ffabc4e9492 - rustc::ty::maps::<impl rustc::ty::context::TyCtxt<'a, 'tcx, 'lcx>>::privacy_access_levels::h97bbf633bd62ba93\r\n 3:49.31   31:     0x7ffabf66110d - <rustc_driver::pretty::UserIdentifiedItem as core::fmt::Debug>::fmt::h319f88e6d85a3159\r\n 3:49.36   32:     0x7ffabf65efa0 - <rustc_driver::pretty::UserIdentifiedItem as core::fmt::Debug>::fmt::h319f88e6d85a3159\r\n 3:49.38   33:     0x7ffabf6b94de - <rustc_driver::profile::trace::Query as core::fmt::Debug>::fmt::h668ffccc298b268a\r\n 3:49.45   34:     0x7ffabf5d7535 - rustc_driver::driver::compile_input::hee425f13030e414b\r\n 3:49.54   35:     0x7ffabf67257e - rustc_driver::run_compiler::he421fe060c4ca3b3\r\n 3:49.58   36:     0x7ffabf5c355e - rustc_driver::target_features::add_configuration::ha85befb247cf606f\r\n 3:49.60   37:     0x7ffabf5a3700 - <unknown>\r\n 3:49.60   38:     0x7ffabf665a0e - <rustc_driver::pretty::UserIdentifiedItem as core::fmt::Debug>::fmt::h319f88e6d85a3159\r\n 3:49.61   39:     0x7ffabefab301 - _rust_maybe_catch_panic\r\n 3:49.62   40:     0x7ffabf5fa7eb - <humantime::date::Error as std::error::Error>::cause::h10a157213ec59748\r\n 3:49.66   41:     0x7ffabefa8fbe - std::sync::mpsc::blocking::WaitToken::wait_max_until::h7e5946bbb17a8c5c\r\n 3:49.66   42:     0x7ffabef7fb0e - std::sys::windows::thread::Thread::new::hfeaab1780e6e9e8f\r\n 3:49.66   43:     0x7ffb0c203033 - BaseThreadInitThunk\r\n 3:49.68   44:     0x7ffb0edd1550 - RtlUserThreadStart\r\n 3:49.69 error: internal compiler error: unexpected panic\r\n 3:49.71 note: the compiler unexpectedly panicked. this is a bug.\r\n 3:49.72 note: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports\r\n 3:49.74 note: rustc 1.26.0 (a77568041 2018-05-07) running on x86_64-pc-windows-msvc\r\n 3:49.75 note: compiler flags: -C opt-level=1 -C panic=abort -C debuginfo=2 -C debug-assertions=on -C incremental -C opt-level=1 -C debuginfo=2 --crate-type lib\r\n 3:49.75 note: some of the compiler flags provided by cargo are hidden\r\n 3:49.75 \u001b[0m\u001b[0m\u001b[1m\u001b[31merror:\u001b[0m Could not compile `style`.\r\n 3:49.77 To learn more, run the command again with --verbose.\r\n 3:49.81 mozmake.EXE[4]: *** [c:/mozilla-source/mozilla-central/config/rules.mk:951: force-cargo-library-build] Error 101\r\n 3:49.82 mozmake.EXE[3]: *** [c:/mozilla-source/mozilla-central/config/recurse.mk:74: toolkit/library/rust/target] Error 2\r\n 3:49.82 mozmake.EXE[3]: *** Waiting for unfinished jobs....\r\n 4:00.72 Unified_cpp_xpcom_tests_gtest3.cpp\r\n 4:00.76 mozmake.EXE[2]: *** [c:/mozilla-source/mozilla-central/config/recurse.mk:34: compile] Error 2\r\n 4:00.77 mozmake.EXE[1]: *** [c:/mozilla-source/mozilla-central/config/rules.mk:418: default] Error 2\r\n 4:00.78 mozmake.EXE: *** [client.mk:150: build] Error 2\r\n 4:00.80 78 compiler warnings present.\r\n```", "closed_by": {"login": "estebank", "id": 1606434, "node_id": "MDQ6VXNlcjE2MDY0MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1606434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/estebank", "html_url": "https://github.com/estebank", "followers_url": "https://api.github.com/users/estebank/followers", "following_url": "https://api.github.com/users/estebank/following{/other_user}", "gists_url": "https://api.github.com/users/estebank/gists{/gist_id}", "starred_url": "https://api.github.com/users/estebank/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/estebank/subscriptions", "organizations_url": "https://api.github.com/users/estebank/orgs", "repos_url": "https://api.github.com/users/estebank/repos", "events_url": "https://api.github.com/users/estebank/events{/privacy}", "received_events_url": "https://api.github.com/users/estebank/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/51483/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/51483/timeline", "performed_via_github_app": null, "state_reason": "completed"}