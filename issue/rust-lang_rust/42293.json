{"url": "https://api.github.com/repos/rust-lang/rust/issues/42293", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/42293/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/42293/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/42293/events", "html_url": "https://github.com/rust-lang/rust/issues/42293", "id": 232021387, "node_id": "MDU6SXNzdWUyMzIwMjEzODc=", "number": 42293, "title": "Tracking issue for \"Red/Green\" Dependency Tracking", "user": {"login": "michaelwoerister", "id": 1825894, "node_id": "MDQ6VXNlcjE4MjU4OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1825894?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michaelwoerister", "html_url": "https://github.com/michaelwoerister", "followers_url": "https://api.github.com/users/michaelwoerister/followers", "following_url": "https://api.github.com/users/michaelwoerister/following{/other_user}", "gists_url": "https://api.github.com/users/michaelwoerister/gists{/gist_id}", "starred_url": "https://api.github.com/users/michaelwoerister/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michaelwoerister/subscriptions", "organizations_url": "https://api.github.com/users/michaelwoerister/orgs", "repos_url": "https://api.github.com/users/michaelwoerister/repos", "events_url": "https://api.github.com/users/michaelwoerister/events{/privacy}", "received_events_url": "https://api.github.com/users/michaelwoerister/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 37977651, "node_id": "MDU6TGFiZWwzNzk3NzY1MQ==", "url": "https://api.github.com/repos/rust-lang/rust/labels/metabug", "name": "metabug", "color": "5319e7", "default": false, "description": "Issues about issues themselves (\"bugs about bugs\")"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 307747675, "node_id": "MDU6TGFiZWwzMDc3NDc2NzU=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-incr-comp", "name": "A-incr-comp", "color": "f7e101", "default": false, "description": "Area: Incremental compilation"}, {"id": 650846969, "node_id": "MDU6TGFiZWw2NTA4NDY5Njk=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-tracking-issue", "name": "C-tracking-issue", "color": "f5f1fd", "default": false, "description": "Category: A tracking issue for an RFC or an unstable feature."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2017-05-29T13:19:53Z", "updated_at": "2018-09-07T19:31:30Z", "closed_at": "2017-12-14T23:17:03Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "\"Red/Green dependency tracking\" is what we call the improved tracking algorithm for incremental compilation. The main difference to the algorithm used at the moment is improved accuracy because it can recover from \"false positives\", that is, it can stop cache invalidation short if a potentially changed value turns out to not have changed after all. A (work-in-progress) description of the system can be found at https://github.com/nikomatsakis/rustc-on-demand-incremental-design-doc/blob/master/0000-rustc-on-demand-and-incremental.md. Implementing this new tracking and caching system will happen in a few phases:\r\n\r\n## Phase 1 - Red/Green without additional caching\r\n\r\nIn the first phase the core infrastructure for red/green tracking will be implemented. We do not cache any additional intermediate results but at the end of this phase, we will already have reached peak tracking accuracy. \r\n\r\n- [x] Implement direct metadata hashing as a proof of concept for general result hashing (#38114)\r\n- [x] Remove `DepTrackingMap::write()` (#42192)\r\n- [x] Refactor `DepNode` to use a stable hash that does not need \"re-tracing\" (#42294)\r\n- [x] Clarify how checking for query cycles fits into the red/green algorithm (#42633)\r\n- [x] Remove all occurrences of DepNode re-opening (#42298)\r\n- [x] Fingerprint all query results (#44364)\r\n- [x] Switch to new, append-only dependency graph implementation (#44772)\r\n- [x] Make Metadata fingerprints available in DepGraph (#44772)\r\n- [x] Implementing minimal `CachingPolicy` support for queries and use for CGUs\r\n- [x] Implement red/green marking in `ty::queries::{}::try_get()`\r\n- [x] Transition the testing framework to work properly again (#44716)\r\n\r\n## Phase 2 - Caching `ty::TypeckTables`\r\n\r\nIn the second phase, support for caching `ty::TypeckTables` will be added, which allows the compiler to skip type checking.\r\n\r\n- [x] Add infrastructure for caching and loading query results (#46004)\r\n- [x] Move all uses of `NodeId` referenced by `ty::TypeckTables` over to `HirId` (#40303)\r\n- [x] Refactor error messages, warnings, and lints to be cacheable (#41184)\r\n- [x] Store and load `ty::TypeckTables` (#46004)\r\n\r\n## Phase 3 - Caching MIR \r\n\r\nThe third phase will support for caching MIR, which should be straight forward at that point. It remains to be verified though if it actually is a performance gain to do so.\r\n\r\n- [x] Use new infrastructure to load and store optimized MIR (https://github.com/rust-lang/rust/pull/46556)\r\n- [x] Verify that this even makes sense\r\n\r\ncc @nikomatsakis, @eddyb, and @rust-lang/compiler in general", "closed_by": {"login": "michaelwoerister", "id": 1825894, "node_id": "MDQ6VXNlcjE4MjU4OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1825894?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michaelwoerister", "html_url": "https://github.com/michaelwoerister", "followers_url": "https://api.github.com/users/michaelwoerister/followers", "following_url": "https://api.github.com/users/michaelwoerister/following{/other_user}", "gists_url": "https://api.github.com/users/michaelwoerister/gists{/gist_id}", "starred_url": "https://api.github.com/users/michaelwoerister/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michaelwoerister/subscriptions", "organizations_url": "https://api.github.com/users/michaelwoerister/orgs", "repos_url": "https://api.github.com/users/michaelwoerister/repos", "events_url": "https://api.github.com/users/michaelwoerister/events{/privacy}", "received_events_url": "https://api.github.com/users/michaelwoerister/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/42293/reactions", "total_count": 19, "+1": 0, "-1": 0, "laugh": 0, "hooray": 1, "confused": 0, "heart": 18, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/42293/timeline", "performed_via_github_app": null, "state_reason": "completed"}