{"url": "https://api.github.com/repos/rust-lang/rust/issues/105089", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/105089/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/105089/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/105089/events", "html_url": "https://github.com/rust-lang/rust/issues/105089", "id": 1469944896, "node_id": "I_kwDOAAsO6M5XnZRA", "number": 105089, "title": "Improve mechanism to separate unit and integration tests", "user": {"login": "martynp", "id": 12006448, "node_id": "MDQ6VXNlcjEyMDA2NDQ4", "avatar_url": "https://avatars.githubusercontent.com/u/12006448?v=4", "gravatar_id": "", "url": "https://api.github.com/users/martynp", "html_url": "https://github.com/martynp", "followers_url": "https://api.github.com/users/martynp/followers", "following_url": "https://api.github.com/users/martynp/following{/other_user}", "gists_url": "https://api.github.com/users/martynp/gists{/gist_id}", "starred_url": "https://api.github.com/users/martynp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/martynp/subscriptions", "organizations_url": "https://api.github.com/users/martynp/orgs", "repos_url": "https://api.github.com/users/martynp/repos", "events_url": "https://api.github.com/users/martynp/events{/privacy}", "received_events_url": "https://api.github.com/users/martynp/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 630810559, "node_id": "MDU6TGFiZWw2MzA4MTA1NTk=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-libtest", "name": "A-libtest", "color": "f7e101", "default": false, "description": "Area: #[test] related"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-11-30T16:54:01Z", "updated_at": "2023-03-27T15:54:04Z", "closed_at": null, "author_association": "NONE", "active_lock_reason": null, "body": "# Proposal\r\n\r\n## Problem statement\r\n\r\nThere is no simple way to run unit tests only, without understanding of the crate content (i.e. `cargo test --bins`, `cargo test --lib`, `cargo test --bins --lib`).\r\n\r\n## Motivation, use-cases\r\n\r\nFor complex systems integration tests can be time consuming and do not always add value during all aspects of the development cycle, it is favorable to be able to select between only running integration tests and not running integrations tests as part of the normal test suite.\r\n\r\nIt is currently possible to select integration tests using:\r\n\r\n`cargo test --test '*'`\r\n\r\nAnd for a bin only crate the following works to select unit tests:\r\n\r\n`cargo test --bins`\r\n\r\nAnd for a lib only crate the following works:\r\n\r\n`cargo test --lib`\r\n\r\nIf you use `cargo test --lib` on a bin only crate, you get a warning. But if you use `cargo test --bins` on a lib crate you get an error.\r\n\r\nSo there isn't a consistent mechanism to select unit tests only.\r\n\r\n## Solution sketches\r\n\r\nThe simplest solution would be to make `cargo test --bins` emit a warning when there are no bins to test. However...\r\n\r\nI would like to add `--exclude-integration` and `--integration` to the test lib, this would keep consistency with the `ignored` and `include-ignored` commands. i.e.\r\n\r\n```\r\ncargo test -- --exclude-integration\r\ncargo test -- --integration\r\n```\r\n\r\n## Links and related work\r\n\r\nI have a first pass at the code here:\r\n\r\nhttps://github.com/rust-lang/rust/commit/da004f7ee5bd24ec01bc88423a9b4f7f204d85a9\r\n", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/105089/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/105089/timeline", "performed_via_github_app": null, "state_reason": null}