{"url": "https://api.github.com/repos/rust-lang/rust/issues/110039", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/110039/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/110039/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/110039/events", "html_url": "https://github.com/rust-lang/rust/issues/110039", "id": 1658399072, "node_id": "I_kwDOAAsO6M5i2Slg", "number": 110039, "title": "Comments and whitespace changing program behavior", "user": {"login": "dangeloj", "id": 13398856, "node_id": "MDQ6VXNlcjEzMzk4ODU2", "avatar_url": "https://avatars.githubusercontent.com/u/13398856?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dangeloj", "html_url": "https://github.com/dangeloj", "followers_url": "https://api.github.com/users/dangeloj/followers", "following_url": "https://api.github.com/users/dangeloj/following{/other_user}", "gists_url": "https://api.github.com/users/dangeloj/gists{/gist_id}", "starred_url": "https://api.github.com/users/dangeloj/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dangeloj/subscriptions", "organizations_url": "https://api.github.com/users/dangeloj/orgs", "repos_url": "https://api.github.com/users/dangeloj/repos", "events_url": "https://api.github.com/users/dangeloj/events{/privacy}", "received_events_url": "https://api.github.com/users/dangeloj/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 123109, "node_id": "MDU6TGFiZWwxMjMxMDk=", "url": "https://api.github.com/repos/rust-lang/rust/labels/O-windows", "name": "O-windows", "color": "6e6ec0", "default": false, "description": "Operating system: Windows"}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}, {"id": 1359848690, "node_id": "MDU6TGFiZWwxMzU5ODQ4Njkw", "url": "https://api.github.com/repos/rust-lang/rust/labels/E-needs-mcve", "name": "E-needs-mcve", "color": "02e10c", "default": false, "description": "Call for participation: This issue needs a Minimal Complete and Verifiable Example"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2023-04-07T05:55:23Z", "updated_at": "2023-04-08T18:06:10Z", "closed_at": "2023-04-08T18:06:10Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!--\r\nThank you for filing a bug report! \ud83d\udc1b Please provide a short summary of the bug,\r\nalong with any information you feel relevant to replicating the bug.\r\n-->\r\n\r\nHello! I've run into a weird situation where changing non-code portions of my app (add a comment, change white space, etc.) change the application's behavior. It's a d3d11 app on Windows 10 (an older Dell XPS15) using nightly or stable. I've distilled everything down to a [single file 1](https://gitlab.com/jjv.dangelo/wtf-rust/-/blob/main/src/main.rs) that reproduces the issue on my machine. There are three outcomes when running cargo run (or even cargo clean && cargo run):\r\n\r\n1. The expected scene running at approximately the target FPS;\r\n2. The expected scene running at approximately 4 FPS;\r\n3. A white window running at approximately the target FPS.\r\n\r\nIf I update the file in a way that causes a recompilation without actually changing the code, the behavior randomly changes. I cannot see a clear pattern as if I have it running with a stable FPS, add a comment which changes the behavior, deleting the comment doesn't reset it back to the stable state. I can reproduce it using the stable compiler as well as building in release.\r\n\r\nI have a repo that distills down to as simple enough of an example that makes it easy to repro.\r\n\r\nhttps://gitlab.com/jjv.dangelo/wtf-rust/-/blob/main/src/main.rs\r\n\r\nI have tried:\r\n\r\n - `cargo clean && cargo build`;\r\n - Deleting Cargo.lock and letting the dependencies update;\r\n - Comment out different parts of the d3d11 calls;\r\n - Copying to another folder and running it from there;\r\n - Turning incremental builds on and off;\r\n - Distilling the issue down to a single file away from the rest of my code;\r\n\r\nI pulled the sample app together quickly, opting to write most of it by hand to see if I could reproduce the issue. Please let me know if there's anything else that I can help provide!\r\n\r\n### Meta\r\n<!--\r\nIf you're using the stable version of the compiler, you should also check if the\r\nbug also exists in the beta or nightly versions.\r\n-->\r\n\r\n`rustc --version --verbose`:\r\n```\r\nrustc 1.70.0-nightly (2eaeb1eee 2023-04-05)\r\nbinary: rustc\r\ncommit-hash: 2eaeb1eee1b21772de8b935236d16ff8e03fdcf5\r\ncommit-date: 2023-04-05\r\nhost: x86_64-pc-windows-msvc\r\nrelease: 1.70.0-nightly\r\nLLVM version: 16.0.0\r\n```\r\nLaptop specs:\r\n```\r\nIntel(R) Core(TM) i7-6700HQ CPU @ 2.60GHz\r\n16.0 GB (15.8 GB usable) RAM\r\nWindows 10 Home, version 22H2, build 19045.2728\r\n```\r\n", "closed_by": {"login": "dangeloj", "id": 13398856, "node_id": "MDQ6VXNlcjEzMzk4ODU2", "avatar_url": "https://avatars.githubusercontent.com/u/13398856?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dangeloj", "html_url": "https://github.com/dangeloj", "followers_url": "https://api.github.com/users/dangeloj/followers", "following_url": "https://api.github.com/users/dangeloj/following{/other_user}", "gists_url": "https://api.github.com/users/dangeloj/gists{/gist_id}", "starred_url": "https://api.github.com/users/dangeloj/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dangeloj/subscriptions", "organizations_url": "https://api.github.com/users/dangeloj/orgs", "repos_url": "https://api.github.com/users/dangeloj/repos", "events_url": "https://api.github.com/users/dangeloj/events{/privacy}", "received_events_url": "https://api.github.com/users/dangeloj/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/110039/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/110039/timeline", "performed_via_github_app": null, "state_reason": "completed"}