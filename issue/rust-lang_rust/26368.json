{"url": "https://api.github.com/repos/rust-lang/rust/issues/26368", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/26368/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/26368/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/26368/events", "html_url": "https://github.com/rust-lang/rust/issues/26368", "id": 88908576, "node_id": "MDU6SXNzdWU4ODkwODU3Ng==", "number": 26368, "title": "TRPL Dining Philosophers, the last example code logic is incorrect", "user": {"login": "oakfire", "id": 2775180, "node_id": "MDQ6VXNlcjI3NzUxODA=", "avatar_url": "https://avatars.githubusercontent.com/u/2775180?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oakfire", "html_url": "https://github.com/oakfire", "followers_url": "https://api.github.com/users/oakfire/followers", "following_url": "https://api.github.com/users/oakfire/following{/other_user}", "gists_url": "https://api.github.com/users/oakfire/gists{/gist_id}", "starred_url": "https://api.github.com/users/oakfire/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oakfire/subscriptions", "organizations_url": "https://api.github.com/users/oakfire/orgs", "repos_url": "https://api.github.com/users/oakfire/repos", "events_url": "https://api.github.com/users/oakfire/events{/privacy}", "received_events_url": "https://api.github.com/users/oakfire/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2015-06-17T04:27:34Z", "updated_at": "2015-06-23T22:49:48Z", "closed_at": "2015-06-23T22:49:48Z", "author_association": "NONE", "active_lock_reason": null, "body": "[dining-philosophers](https://doc.rust-lang.org/stable/book/dining-philosophers.html)\nI ran the last example code and I got:\n\n```\nMichel Foucault is eating. \nMichel Foucault is done eating.\nFriedrich Nietzsche is eating.\nFriedrich Nietzsche is done eating.\nKarl Marx is eating. \nKarl Marx is done eating.\nGilles Deleuze is eating. \nGilles Deleuze is done eating.\nBaruch Spinoza is eating. \nBaruch Spinoza is done eating.\n```\n\nIt is different from the book:\n\n```\nGilles Deleuze is eating.\nFriedrich Nietzsche is eating.\nFriedrich Nietzsche is done eating.\nGilles Deleuze is done eating.\nBaruch Spinoza is eating.\nKarl Marx is eating.\nBaruch Spinoza is done eating.\nMichel Foucault is eating.\nKarl Marx is done eating.\nMichel Foucault is done eating.\n```\n\nSo I add some code to find why:\n\n``` rust\n    fn eat(&self, table: &Table) {     \n        println!(\"{} want to eat. {} {}\", self.name, self.left, self.right);\n        let _left = table.forks[self.left].lock().unwrap();\n        println!(\"{} got the left fork {}\", self.name, self.left);\n        let _right = table.forks[self.right].lock().unwrap();\n        println!(\"{} got the right fork {}\", self.name, self.right);\n\n        println!(\"{} is eating. \", self.name);\n\n        thread::sleep_ms(1000);\n\n        println!(\"{} is done eating.\", self.name);\n    }\n```\n\nand the result is\n\n```\nMichel Foucault want to eat. 0 4\nMichel Foucault got the left fork 0\nMichel Foucault got the right fork 4\nMichel Foucault is eating. \nFriedrich Nietzsche want to eat. 3 4\nFriedrich Nietzsche got the left fork 3\nKarl Marx want to eat. 2 3\nKarl Marx got the left fork 2\nGilles Deleuze want to eat. 1 2\nGilles Deleuze got the left fork 1\nBaruch Spinoza want to eat. 0 1\nMichel Foucault is done eating.\nFriedrich Nietzsche got the right fork 4\nFriedrich Nietzsche is eating. \nBaruch Spinoza got the left fork 0\nFriedrich Nietzsche is done eating.\nKarl Marx got the right fork 3\nKarl Marx is eating. \nKarl Marx is done eating.\nGilles Deleuze got the right fork 2\nGilles Deleuze is eating. \nGilles Deleuze is done eating.\nBaruch Spinoza got the right fork 1\nBaruch Spinoza is eating. \nBaruch Spinoza is done eating.\n\n```\n\nThe book said:\" Only two philosophers can eat at any one time,\", that is  not exactly correct.\n", "closed_by": {"login": "steveklabnik", "id": 27786, "node_id": "MDQ6VXNlcjI3Nzg2", "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/steveklabnik", "html_url": "https://github.com/steveklabnik", "followers_url": "https://api.github.com/users/steveklabnik/followers", "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}", "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}", "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions", "organizations_url": "https://api.github.com/users/steveklabnik/orgs", "repos_url": "https://api.github.com/users/steveklabnik/repos", "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}", "received_events_url": "https://api.github.com/users/steveklabnik/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/26368/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/26368/timeline", "performed_via_github_app": null, "state_reason": "completed"}