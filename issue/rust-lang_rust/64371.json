{"url": "https://api.github.com/repos/rust-lang/rust/issues/64371", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/64371/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/64371/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/64371/events", "html_url": "https://github.com/rust-lang/rust/issues/64371", "id": 492005261, "node_id": "MDU6SXNzdWU0OTIwMDUyNjE=", "number": 64371, "title": "Rustdoc generates illegal \"<div>\" inside \"<pre>\" with traits", "user": {"login": "kentfredric", "id": 44790, "node_id": "MDQ6VXNlcjQ0Nzkw", "avatar_url": "https://avatars.githubusercontent.com/u/44790?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kentfredric", "html_url": "https://github.com/kentfredric", "followers_url": "https://api.github.com/users/kentfredric/followers", "following_url": "https://api.github.com/users/kentfredric/following{/other_user}", "gists_url": "https://api.github.com/users/kentfredric/gists{/gist_id}", "starred_url": "https://api.github.com/users/kentfredric/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kentfredric/subscriptions", "organizations_url": "https://api.github.com/users/kentfredric/orgs", "repos_url": "https://api.github.com/users/kentfredric/repos", "events_url": "https://api.github.com/users/kentfredric/events{/privacy}", "received_events_url": "https://api.github.com/users/kentfredric/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 203738, "node_id": "MDU6TGFiZWwyMDM3Mzg=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-rustdoc", "name": "T-rustdoc", "color": "bfd4f2", "default": false, "description": "Relevant to the rustdoc team, which will review and decide on the PR/issue."}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2019-09-11T04:05:30Z", "updated_at": "2022-04-02T18:34:29Z", "closed_at": "2022-04-02T18:34:29Z", "author_association": "NONE", "active_lock_reason": null, "body": "Similar to the previous bugs I've filed in this regard with illegal html:\r\n\r\nIn:  1.39.0-nightly (34e82a7b7 2019-09-10)\r\n\r\nThe following trait definition: \r\n```rust\r\n\r\n\r\n#[cfg_attr(\r\n    feature = \"external_doc\",\r\n    doc(include = \"CacheFieldCollection.md\")\r\n)]\r\n#[cfg_attr(\r\n    not(feature = \"external_doc\"),\r\n    doc = \"An abstact representation of 'a thing' that can expose data \\\r\n           about its unit.\"\r\n)]\r\npub trait CacheFieldCollection {\r\n    /// Returns a struct containing data recorded for this thing\r\n    fn fields(&self) -> &CacheFieldData;\r\n    /// Returns a timestamp indicating time of last modification/update\r\n    fn mtime(&self) -> &chrono::DateTime<Utc>;\r\n}\r\n```\r\nEmits invalid html ( hand formatted ):\r\n```html\r\n<div class=\"docblock type-decl hidden-by-usual-hider\">\r\n<pre class='rust trait'>pub trait CacheFieldCollection {\r\n    fn <a href='#tymethod.fields' class='fnname'>fields</a>(&amp;self) -&gt; &amp;<a class=\"struct\" href=\"../ccache_stats_reader/struct.CacheFieldData.html\" title=\"struct ccache_stats_reader::CacheFieldData\">CacheFieldData</a>;\r\n<div class='item-spacer'></div>    fn <a href='#tymethod.mtime' class='fnname'>mtime</a>(&amp;self) -&gt; &amp;<a class=\"struct\" href=\"https://docs.rs/chrono/latest/chrono/datetime/struct.DateTime.html\" title=\"struct chrono::datetime::DateTime\">DateTime</a>&lt;<a class=\"struct\" href=\"https://docs.rs/chrono/latest/chrono/offset/utc/struct.Utc.html\" title=\"struct chrono::offset::utc::Utc\">Utc</a>&gt;;\r\n}</pre></div>\r\n```\r\n\r\n\"pre\", like headers, only permits child nodes that are \"phrasing content\", of which, div is excluded.\r\n\r\nSo the error is from `<div class='item-spacer'></div>`\r\n\r\n`htmltidy` handles this by prematurely ending the `<pre>` before the `<div>`, and then reinserting a `<pre>` afterwards, breaking layout:\r\n\r\n![snapshot_20190911_160411](https://user-images.githubusercontent.com/44790/64667407-dcc77280-d4ad-11e9-8237-42cbf2f97321.png)\r\n\r\n\r\n\r\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/64371/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/64371/timeline", "performed_via_github_app": null, "state_reason": "completed"}