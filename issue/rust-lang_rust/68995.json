{"url": "https://api.github.com/repos/rust-lang/rust/issues/68995", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/68995/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/68995/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/68995/events", "html_url": "https://github.com/rust-lang/rust/issues/68995", "id": 562179915, "node_id": "MDU6SXNzdWU1NjIxNzk5MTU=", "number": 68995, "title": "Add `with_exact_size` and `with_size_hint` to `Iterator`", "user": {"login": "LukasKalbertodt", "id": 7419664, "node_id": "MDQ6VXNlcjc0MTk2NjQ=", "avatar_url": "https://avatars.githubusercontent.com/u/7419664?v=4", "gravatar_id": "", "url": "https://api.github.com/users/LukasKalbertodt", "html_url": "https://github.com/LukasKalbertodt", "followers_url": "https://api.github.com/users/LukasKalbertodt/followers", "following_url": "https://api.github.com/users/LukasKalbertodt/following{/other_user}", "gists_url": "https://api.github.com/users/LukasKalbertodt/gists{/gist_id}", "starred_url": "https://api.github.com/users/LukasKalbertodt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/LukasKalbertodt/subscriptions", "organizations_url": "https://api.github.com/users/LukasKalbertodt/orgs", "repos_url": "https://api.github.com/users/LukasKalbertodt/repos", "events_url": "https://api.github.com/users/LukasKalbertodt/events{/privacy}", "received_events_url": "https://api.github.com/users/LukasKalbertodt/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 211668062, "node_id": "MDU6TGFiZWwyMTE2NjgwNjI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-libs-api", "name": "T-libs-api", "color": "bfd4f2", "default": false, "description": "Relevant to the library API team, which will review and decide on the PR/issue."}, {"id": 630652267, "node_id": "MDU6TGFiZWw2MzA2NTIyNjc=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-feature-request", "name": "C-feature-request", "color": "f5f1fd", "default": false, "description": "Category: A feature request, i.e: not implemented / a PR."}, {"id": 889209675, "node_id": "MDU6TGFiZWw4ODkyMDk2NzU=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-iterators", "name": "A-iterators", "color": "f7e101", "default": false, "description": "Area: Iterators"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-02-09T13:51:35Z", "updated_at": "2020-02-20T01:57:49Z", "closed_at": null, "author_association": "MEMBER", "active_lock_reason": null, "body": "Usually iterator adaptors do a fine job at keeping information about the length of an iterator. But once you throw something like `filter` in your iterator chain, the lower bound is 0, meaning that collecting into a collection can't properly pre-allocate. Also, some iterator adaptors (like `chain`) cannot implemented `ExactSizeIterator` although in many real world cases, the size is perfectly known. \r\n\r\nCurrently, working around those limitations is often tedious and requires quite a bit of additional code. I think it would be a lot nicer to just add a `.with_exact_size(27)` somewhere into your chain. So I'd like to propose adding the following to `Iterator`:\r\n\r\n- **`fn with_size_hint(self, lower: usize, upper: Option<usize>) -> SizeHint`**\r\n  - `SizeHint` would implement `Iterator::size_hint` with the given values, forwarding all other methods to the inner iterator (and implementing the same traits)\r\n- **`fn with_exact_size(self, size: usize) -> ExactSize`**\r\n  - `ExactSize` would implement `ExactSizeIterator` with the given value and override `Iterator::size_hint`. All other methods are forwarded to the inner iterator (and implementing the same traits, plus `ExactSizeIterator`)\r\n\r\nI would have created this as a PR, but I'm short on time and wanted to hear some opinions first. ", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/68995/reactions", "total_count": 4, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 2, "rocket": 2, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/68995/timeline", "performed_via_github_app": null, "state_reason": null}