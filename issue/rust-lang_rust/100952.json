{"url": "https://api.github.com/repos/rust-lang/rust/issues/100952", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/100952/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/100952/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/100952/events", "html_url": "https://github.com/rust-lang/rust/issues/100952", "id": 1349160025, "node_id": "I_kwDOAAsO6M5QaoxZ", "number": 100952, "title": "rustdoc produces gigantic on-disk content in modules with large number of numerical constants", "user": {"login": "elinorbgr", "id": 3009227, "node_id": "MDQ6VXNlcjMwMDkyMjc=", "avatar_url": "https://avatars.githubusercontent.com/u/3009227?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elinorbgr", "html_url": "https://github.com/elinorbgr", "followers_url": "https://api.github.com/users/elinorbgr/followers", "following_url": "https://api.github.com/users/elinorbgr/following{/other_user}", "gists_url": "https://api.github.com/users/elinorbgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/elinorbgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elinorbgr/subscriptions", "organizations_url": "https://api.github.com/users/elinorbgr/orgs", "repos_url": "https://api.github.com/users/elinorbgr/repos", "events_url": "https://api.github.com/users/elinorbgr/events{/privacy}", "received_events_url": "https://api.github.com/users/elinorbgr/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 203738, "node_id": "MDU6TGFiZWwyMDM3Mzg=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-rustdoc", "name": "T-rustdoc", "color": "bfd4f2", "default": false, "description": "Relevant to the rustdoc team, which will review and decide on the PR/issue."}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-08-24T09:44:02Z", "updated_at": "2022-08-26T08:11:35Z", "closed_at": null, "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "We have in Smithay some modules that define a large number of numerical constants (`const u32`), and this triggers a pathological edge-case in terms of documentation generation: rustdoc generates one 4.6 KB file for each of these constants.\r\n\r\nFor example see this module: https://smithay.github.io/smithay/smithay/wayland/seat/keysyms/index.html\r\n\r\nIt contains something like ~2400 numerical constants, as a result the documentation folder for this module alone is 20 MB. We have a few other instances of this in Smithay, and we realized that because of this our `gh-pages` branches is more than 99% of the size of the github repo (the total size of the `target/doc` folder for smithay and its public dependencies is around 220MB), and it significantly impacts clone and pull times for our contributors.\r\n\r\nWe're going to take steps to mitigate this on our side, but I suppose maybe something can be done on rustdoc side as well?\r\n\r\ncc @GuillaumeGomez who asked me to make this issue.\r\n\r\n**edit:**\r\n\r\nGiving more details on this, more generally the issues lies with modules that contain a large number of un-documented items (like functions or constants), like the ones generated by [`gl_generator`](https://crates.io/crates/gl_generator) for example.\r\n\r\nFor such modules, rustdoc will create one file per item, with a constant 4.6KB overhead per file, while as a documentation reader this really does not bring anything useful given those pages do not contain any additional documentation beyond the symbol prototype.", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/100952/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/100952/timeline", "performed_via_github_app": null, "state_reason": null}