{"url": "https://api.github.com/repos/rust-lang/rust/issues/32323", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/32323/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/32323/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/32323/events", "html_url": "https://github.com/rust-lang/rust/issues/32323", "id": 141724652, "node_id": "MDU6SXNzdWUxNDE3MjQ2NTI=", "number": 32323, "title": "ICE in region inference", "user": {"login": "bobtwinkles", "id": 1514748, "node_id": "MDQ6VXNlcjE1MTQ3NDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1514748?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bobtwinkles", "html_url": "https://github.com/bobtwinkles", "followers_url": "https://api.github.com/users/bobtwinkles/followers", "following_url": "https://api.github.com/users/bobtwinkles/following{/other_user}", "gists_url": "https://api.github.com/users/bobtwinkles/gists{/gist_id}", "starred_url": "https://api.github.com/users/bobtwinkles/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bobtwinkles/subscriptions", "organizations_url": "https://api.github.com/users/bobtwinkles/orgs", "repos_url": "https://api.github.com/users/bobtwinkles/repos", "events_url": "https://api.github.com/users/bobtwinkles/events{/privacy}", "received_events_url": "https://api.github.com/users/bobtwinkles/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2016-03-17T22:40:19Z", "updated_at": "2016-03-19T14:45:18Z", "closed_at": "2016-03-19T14:45:18Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Hello, I have a found an ICE. The code is malformed (no return from a function that should return a  value) but I don't think the compiler should be crashing in this case =P                                                        \n\n```\nuse std::path::Path;\n\npub trait AnalysisStage<'input_lifetime>: PartialEq {\n    type Input: ?Sized; \n    type Output;\n\n    fn stage_name() -> String; \n\n    fn analyze(&self, input: &'input_lifetime Self::Input) -> Self::Output;\n}\n\npub fn run_cached_stage<'a, T: AnalysisStage<'a>>(\n        cache_dir: &Path,\n        stage: &T,\n        input: &'a <T as AnalysisStage<'a>>::Input) -> <T as AnalysisStage<'a>>::Output {\n    assert!(cache_dir.is_dir());\n}\n\npub fn main() {\n}\n```\n\nReturning a value `run_cached_stage` allows the code to compile successfully.\nStack trace:\n\n```\nerror: internal compiler error: cannot relate bound region: ReFree(CodeExtent(13/CallSiteScope { fn_id: 27, body_id: 51 }), BrNamed(DefId { krate: 0, node: DefIndex(19) => run_cached_stage::'a }, 'a(77))) <= ReEarlyBound(FnSpace, 0, 'a)\nnote: the compiler unexpectedly panicked. this is a bug.\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports\nthread 'rustc' panicked at 'Box<Any>', ../src/libsyntax/errors/mod.rs:530\nstack backtrace:\n   1:     0x7f3978902240 - sys::backtrace::tracing::imp::write::h3bbb320d569781f92cv\n   2:     0x7f397890c43f - panicking::default_handler::_$u7b$$u7b$closure$u7d$$u7d$::closure.44520\n   3:     0x7f397890bfb3 - panicking::default_handler::hf1209fec3f963ae7H0z\n   4:     0x7f39788d442c - sys_common::unwind::begin_unwind_inner::h2ff9ae045f111c6dg2t\n   5:     0x7f3975b04138 - sys_common::unwind::begin_unwind::h14144787524125971391\n   6:     0x7f3975b040db - errors::Handler::span_bug::h15395824936343975365\n   7:     0x7f3975bc06f9 - middle::infer::region_inference::RegionVarBindings<'a, 'tcx>::make_subregion::h7f3bb27940126b6cQrz\n   8:     0x7f3975bed867 - middle::infer::region_inference::RegionVarBindings<'a, 'tcx>::make_eqregion::h564a0fc4f5b6b7821qz\n   9:     0x7f3975bc7f1f - middle::infer::equate::Equate<'a, 'tcx>.TypeRelation<'a, 'tcx>::regions::h056e51c9a2b47ea92hu\n  10:     0x7f3975bcdcad - middle::infer::sub::Sub<'a, 'tcx>.TypeRelation<'a, 'tcx>::relate_with_variance::h16084476242674243829\n  11:     0x7f3975bcda7f - iter::_&'a mut I.Iterator::next::h492841943347951705\n  12:     0x7f3975bcc6dd - middle::ty::relate::relate_substs::h2175710387140620551\n  13:     0x7f3975bcbddb - middle::ty::relate::relate_item_substs::h5133697730217601403\n  14:     0x7f3975bcbb63 - middle::ty::relate::ty..TraitRef<'tcx>.Relate<'a, 'tcx>::relate::h15531786425531683161\n  15:     0x7f3975bc9303 - middle::infer::higher_ranked::CombineFields<'a, 'tcx>.HigherRankedRelations<'a, 'tcx>::higher_ranked_sub::_$u7b$$u7b$closure$u7d$$u7d$::closure.87339\n  16:     0x7f3975bc12a0 - middle::infer::InferCtxt<'a, 'tcx>::sub_poly_trait_refs::h38716118db114552sqD\n  17:     0x7f3975ccb3ab - vec::Vec<T>::extend_desugared::h6748634469442663400\n  18:     0x7f3975cc9823 - middle::traits::select::SelectionContext<'cx, 'tcx>::assemble_candidates::hc79fe626cc8f2447GJX\n  19:     0x7f3975cbe361 - middle::traits::select::SelectionContext<'cx, 'tcx>::candidate_from_obligation::he1a867beeb5c08d8ynX\n  20:     0x7f3975b8e5b7 - middle::traits::select::SelectionContext<'cx, 'tcx>::select::hec21f8105af275d4lTW\n  21:     0x7f3975cb4e0a - middle::traits::project::assemble_candidates_from_impls::h50fbb432cce6c3cfCtV\n  22:     0x7f3975cb11fb - middle::traits::project::opt_normalize_projection_type::hac249e56767be130BSU\n  23:     0x7f3975c9e356 - middle::traits::project::normalize_projection_type::h5c927accb52af237qRU\n  24:     0x7f3975bdb6fb - middle::traits::project::AssociatedTypeNormalizer<'a, 'b, 'tcx>.TypeFolder<'tcx>::fold_ty::h023fb72f91feb19c7OU\n  25:     0x7f3975c4ac2b - middle::traits::project::normalize_with_depth::h10247183156909553401\n  26:     0x7f3975c40d39 - middle::liveness::visit_fn::h36d110105e9b0ae90sG\n  27:     0x7f3975c430dd - middle::liveness::check_crate::h0720a363ef7389bcYbG\n  28:     0x7f3978e32fe1 - driver::phase_3_run_analysis_passes::_$u7b$$u7b$closure$u7d$$u7d$::closure.30392\n  29:     0x7f3978e2fc64 - middle::ty::context::TyCtxt<'tcx>::create_and_enter::h9147142471428683876\n  30:     0x7f3978e2c842 - driver::phase_3_run_analysis_passes::h401012091542974636\n  31:     0x7f3978dff03f - driver::compile_input::h5061645098a52196Pca\n  32:     0x7f3978dec90c - run_compiler::hf1a385ebc338137cJPc\n  33:     0x7f3978de9f91 - sys_common::unwind::try::try_fn::h13370330027690439195\n  34:     0x7f39788ffacb - __rust_try\n  35:     0x7f39788ffa5d - sys_common::unwind::inner_try::h87a6865a03ff0831iZt\n  36:     0x7f3978dea7da - boxed::F.FnBox<A>::call_box::h11886714385289713998\n  37:     0x7f397890a549 - sys::thread::Thread::new::thread_start::haca995caeb3b74699Xy\n  38:     0x7f3971010423 - start_thread\n  39:     0x7f3978587cbc - clone\n  40:                0x0 - <unknown>\n```\n\nRustc version:\n\n```\nrustc 1.9.0-nightly (6e0f2f2f0 2016-03-16)\nbinary: rustc\ncommit-hash: 6e0f2f2f050443f2aec4e9c7d25618a6a6639b83\ncommit-date: 2016-03-16\nhost: x86_64-unknown-linux-gnu\nrelease: 1.9.0-nightly\n```\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/32323/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/32323/timeline", "performed_via_github_app": null, "state_reason": "completed"}