{"url": "https://api.github.com/repos/rust-lang/rust/issues/15612", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/15612/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/15612/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/15612/events", "html_url": "https://github.com/rust-lang/rust/issues/15612", "id": 37687088, "node_id": "MDU6SXNzdWUzNzY4NzA4OA==", "number": 15612, "title": "Bring back rpaths, it's okay to use them if you're careful.", "user": {"login": "o11c", "id": 964689, "node_id": "MDQ6VXNlcjk2NDY4OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/964689?v=4", "gravatar_id": "", "url": "https://api.github.com/users/o11c", "html_url": "https://github.com/o11c", "followers_url": "https://api.github.com/users/o11c/followers", "following_url": "https://api.github.com/users/o11c/following{/other_user}", "gists_url": "https://api.github.com/users/o11c/gists{/gist_id}", "starred_url": "https://api.github.com/users/o11c/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/o11c/subscriptions", "organizations_url": "https://api.github.com/users/o11c/orgs", "repos_url": "https://api.github.com/users/o11c/repos", "events_url": "https://api.github.com/users/o11c/events{/privacy}", "received_events_url": "https://api.github.com/users/o11c/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2014-07-11T18:52:50Z", "updated_at": "2014-07-11T19:56:03Z", "closed_at": "2014-07-11T19:13:07Z", "author_association": "NONE", "active_lock_reason": null, "body": "Let me start off by saying, _any time that `LD_LIBRARY_PATH` must be used is a bug_. Not just a user experience bug, but an absolute bug. The _sole_ purpose of `LD_LIBRARY_PATH` is for _local administrators_ to override the default for debugging or something, it must never be used by upstream or by distro, in any package. Never, ever, ever.\n\nNow, looking at distro policies:\n- All setuid/setgid/setcap executables must have no relative rpaths, because the executable may be hard-linked to load arbitrary code.\n- There must not be absolute rpaths to the build directory after installation (relative rpaths are okay, subject to the previous rule), because unprivileged users can write to the build directory to load.\n- The standard directories, (`/lib/`, `/lib64/`, `/usr/lib/`, and `/usr/lib64/`), must never be specified in an rpath. (Note, however, that if you install a _library_ to the standard paths, you _must_ run ldconfig afterward)\n- It is possible to extend the list of standard directories by adding a file to `/etc/ld.so.conf.d/`, but this is the job of the distro, not upstream.\n- If a library is installed _outside_ the standard directories (either because it is private, or because it is being installed as an unprivileged user), you _must_ emit an rpath.\n- Rust can avoid the problem of .so version changes in basic library packages such as libc, simply by including the SONAME of all the system libraries in the hash (this doesn't strictly _need_ to be done now, only if such a change happens, and _could_ be pushed to the distros problem (there probably should be a way to specify that anyway), but it shouldn't be hard so it might as well be done now so that an answer can be given to distros who ask).\n\nFinally, a brief mention of Windows. Prior discussion has claimed that Windows does not support rpaths, but this is missing one criticial thing: Windows binaries have a _hard-coded_ rpath of `.`, because each binaries bundling its own libraries has been the _normal_ route, not the exception.\n\nThe result of misunderstanding the implications of rpath has been much breakage, and telling users to use environment variables that are only intended for debugging.\n", "closed_by": {"login": "emberian", "id": 704250, "node_id": "MDQ6VXNlcjcwNDI1MA==", "avatar_url": "https://avatars.githubusercontent.com/u/704250?v=4", "gravatar_id": "", "url": "https://api.github.com/users/emberian", "html_url": "https://github.com/emberian", "followers_url": "https://api.github.com/users/emberian/followers", "following_url": "https://api.github.com/users/emberian/following{/other_user}", "gists_url": "https://api.github.com/users/emberian/gists{/gist_id}", "starred_url": "https://api.github.com/users/emberian/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/emberian/subscriptions", "organizations_url": "https://api.github.com/users/emberian/orgs", "repos_url": "https://api.github.com/users/emberian/repos", "events_url": "https://api.github.com/users/emberian/events{/privacy}", "received_events_url": "https://api.github.com/users/emberian/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/15612/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/15612/timeline", "performed_via_github_app": null, "state_reason": "completed"}