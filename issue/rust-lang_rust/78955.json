{"url": "https://api.github.com/repos/rust-lang/cargo/issues/8850", "repository_url": "https://api.github.com/repos/rust-lang/cargo", "labels_url": "https://api.github.com/repos/rust-lang/cargo/issues/8850/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/cargo/issues/8850/comments", "events_url": "https://api.github.com/repos/rust-lang/cargo/issues/8850/events", "html_url": "https://github.com/rust-lang/cargo/issues/8850", "id": 741150904, "node_id": "MDU6SXNzdWU3NDExNTA5MDQ=", "number": 8850, "title": "Cargo timings graph is broken in Firefox", "user": {"login": "Lucretiel", "id": 1823405, "node_id": "MDQ6VXNlcjE4MjM0MDU=", "avatar_url": "https://avatars.githubusercontent.com/u/1823405?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Lucretiel", "html_url": "https://github.com/Lucretiel", "followers_url": "https://api.github.com/users/Lucretiel/followers", "following_url": "https://api.github.com/users/Lucretiel/following{/other_user}", "gists_url": "https://api.github.com/users/Lucretiel/gists{/gist_id}", "starred_url": "https://api.github.com/users/Lucretiel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Lucretiel/subscriptions", "organizations_url": "https://api.github.com/users/Lucretiel/orgs", "repos_url": "https://api.github.com/users/Lucretiel/repos", "events_url": "https://api.github.com/users/Lucretiel/events{/privacy}", "received_events_url": "https://api.github.com/users/Lucretiel/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 84096804, "node_id": "MDU6TGFiZWw4NDA5NjgwNA==", "url": "https://api.github.com/repos/rust-lang/cargo/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: bug"}, {"id": 813047080, "node_id": "MDU6TGFiZWw4MTMwNDcwODA=", "url": "https://api.github.com/repos/rust-lang/cargo/labels/S-needs-design", "name": "S-needs-design", "color": "b60205", "default": false, "description": "Status: Needs someone to work further on the design for the feature or fix. NOT YET accepted."}, {"id": 1568797293, "node_id": "MDU6TGFiZWwxNTY4Nzk3Mjkz", "url": "https://api.github.com/repos/rust-lang/cargo/labels/A-timings", "name": "A-timings", "color": "fbca04", "default": false, "description": "Area: timings"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-11-11T19:21:38Z", "updated_at": "2023-04-18T20:51:40Z", "closed_at": null, "author_association": "NONE", "active_lock_reason": null, "body": "<!--\r\nThank you for filing a bug report! \ud83d\udc1b Please provide a short summary of the bug,\r\nalong with any information you feel relevant to replicating the bug.\r\n-->\r\n\r\nWhen I run `cargo +nightly -Z timings`, it produces a timings report in HTML as expected. This renders correctly in Chrome and Safari. However, in Firefox, I only see the summary table and timings breakdown table. I can see the controls for the graph, but the graph itself doesn't render: \r\n<img width=\"1247\" alt=\"image\" src=\"https://user-images.githubusercontent.com/1823405/98853598-5f87ec80-2427-11eb-94ea-af7366d7416e.png\">\r\n\r\nIn the error console, I see the following uncaught exception:\r\n\r\n```\r\nUncaught \r\n    Exception\r\n        columnNumber: 0\r\n        data: null\r\n        filename: \"http://localhost:8080/cargo-timing.html\"\r\n        lineNumber: 24173\r\n        message: \"\"\r\n        name: \"NS_ERROR_FAILURE\"\r\n        result: 2147500037\r\n        stack: \"setup_canvas@http://localhost:8080/cargo-timing.html:24173:7\\ndraw_graph_axes@http://localhost:8080/cargo-timing.html:24187:25\\nrender_pipeline_graph@http://localhost:8080/cargo-timing.html:23930:86\\n@http://localhost:8080/cargo-timing.html:24331:1\\n\"\r\n        <prototype>: ExceptionPrototype { toString: toString(), name: Getter, message: Getter, \u2026 }\r\n```\r\n\r\nThis exception is being thrown from the following function, specifically at `ctx.scale(dpr, dpr)` near the end:\r\n\r\n```js\r\nfunction setup_canvas(id, width, height) {\r\n  let g = document.getElementById(id);\r\n  let dpr = window.devicePixelRatio || 1;\r\n  g.width = width * dpr;\r\n  g.height = height * dpr;\r\n  g.style.width = width;\r\n  g.style.height = height;\r\n  let ctx = g.getContext('2d');\r\n  ctx.scale(dpr, dpr);  // Exception thrown here\r\n  return ctx;\r\n}\r\n```\r\n\r\nDigging into the debugger, there don't seem to be any obvious issue with that line of code. `ctx` is of prototype `CanvasRenderingContext2DPrototype`, and the `scale` method has been supported in firefox pretty much forever. `dpr == 2`.\r\n\r\n### Meta\r\n<!--\r\nIf you're using the stable version of the compiler, you should also check if the\r\nbug also exists in the beta or nightly versions.\r\n-->\r\n\r\n`rustc --version --verbose`:\r\n```\r\ncargo 1.49.0-nightly (79b397d72 2020-10-15)\r\nrelease: 1.49.0\r\ncommit-hash: 79b397d72c557eb6444a2ba0dc00a211a226a35a\r\ncommit-date: 2020-10-15\r\n```\r\n\r\n- macOS Catalina, version 10.15.7 (19H2)\r\n- Firefox 81.0.2 (64-bit)\r\n\r\n</p>\r\n</details>\r\n", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/cargo/issues/8850/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/cargo/issues/8850/timeline", "performed_via_github_app": null, "state_reason": null}