{"url": "https://api.github.com/repos/rust-lang/rust/issues/91618", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/91618/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/91618/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/91618/events", "html_url": "https://github.com/rust-lang/rust/issues/91618", "id": 1072889685, "node_id": "I_kwDOAAsO6M4_8v9V", "number": 91618, "title": "rustc panic (debug mode only)", "user": {"login": "luketpeterson", "id": 36806965, "node_id": "MDQ6VXNlcjM2ODA2OTY1", "avatar_url": "https://avatars.githubusercontent.com/u/36806965?v=4", "gravatar_id": "", "url": "https://api.github.com/users/luketpeterson", "html_url": "https://github.com/luketpeterson", "followers_url": "https://api.github.com/users/luketpeterson/followers", "following_url": "https://api.github.com/users/luketpeterson/following{/other_user}", "gists_url": "https://api.github.com/users/luketpeterson/gists{/gist_id}", "starred_url": "https://api.github.com/users/luketpeterson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/luketpeterson/subscriptions", "organizations_url": "https://api.github.com/users/luketpeterson/orgs", "repos_url": "https://api.github.com/users/luketpeterson/repos", "events_url": "https://api.github.com/users/luketpeterson/events{/privacy}", "received_events_url": "https://api.github.com/users/luketpeterson/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 307747675, "node_id": "MDU6TGFiZWwzMDc3NDc2NzU=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-incr-comp", "name": "A-incr-comp", "color": "f7e101", "default": false, "description": "Area: Incremental compilation"}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-12-07T04:07:27Z", "updated_at": "2021-12-12T00:38:46Z", "closed_at": "2021-12-12T00:38:46Z", "author_association": "NONE", "active_lock_reason": null, "body": "`cargo test` in the attached project results in a panic in rustc.\r\n`cargo test --release` works without any problem\r\n\r\nDeleting Cargo.lock and the entire target directory did not fix the issue.\r\n\r\nCargo project is here:\r\n[cluster_set.strip_down_to_repro_compiler_panic.zip](https://github.com/rust-lang/rust/files/7665395/cluster_set.strip_down_to_repro_compiler_panic.zip)\r\n\r\nUnfortunately, it was a bit of a Heisenbug in that further simplification of the code make the panic disappear, but it didn't seem to follow any predictable logic.  i.e. removing some functions that shouldn't have any effect made the bug go away, but then putting them back didn't make the bug return.\r\n\r\n### Meta\r\nPanic occurs on both stable and nightly.\r\n\r\n`rustc --version --verbose`:\r\n```\r\nrustc 1.57.0 (f1edd0429 2021-11-29)\r\nbinary: rustc\r\ncommit-hash: f1edd0429582dd29cccacaf50fd134b05593bd9c\r\ncommit-date: 2021-11-29\r\nhost: x86_64-apple-darwin\r\nrelease: 1.57.0\r\nLLVM version: 13.0.0\r\n\r\nand\r\n\r\nrustc 1.59.0-nightly (efec54529 2021-12-04)\r\nbinary: rustc\r\ncommit-hash: efec545293b9263be9edfb283a7aa66350b3acbf\r\ncommit-date: 2021-12-04\r\nhost: x86_64-apple-darwin\r\nrelease: 1.59.0-nightly\r\nLLVM version: 13.0.0\r\n```\r\n\r\n### Error output\r\n\r\nBacktrace is here: (stable toolchain)\r\n[rustc_panic.txt](https://github.com/rust-lang/rust/files/7665319/rustc_panic.txt)\r\n\r\nAlso occurs on nightly:\r\n[rustc_panic.nightly.txt](https://github.com/rust-lang/rust/files/7665402/rustc_panic.nightly.txt)\r\n\r\n</p>\r\n</details>\r\n\r\n", "closed_by": {"login": "dtolnay", "id": 1940490, "node_id": "MDQ6VXNlcjE5NDA0OTA=", "avatar_url": "https://avatars.githubusercontent.com/u/1940490?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dtolnay", "html_url": "https://github.com/dtolnay", "followers_url": "https://api.github.com/users/dtolnay/followers", "following_url": "https://api.github.com/users/dtolnay/following{/other_user}", "gists_url": "https://api.github.com/users/dtolnay/gists{/gist_id}", "starred_url": "https://api.github.com/users/dtolnay/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dtolnay/subscriptions", "organizations_url": "https://api.github.com/users/dtolnay/orgs", "repos_url": "https://api.github.com/users/dtolnay/repos", "events_url": "https://api.github.com/users/dtolnay/events{/privacy}", "received_events_url": "https://api.github.com/users/dtolnay/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/91618/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/91618/timeline", "performed_via_github_app": null, "state_reason": "completed"}