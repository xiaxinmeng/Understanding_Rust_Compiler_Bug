{"url": "https://api.github.com/repos/rust-lang/rust/issues/52079", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/52079/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/52079/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/52079/events", "html_url": "https://github.com/rust-lang/rust/issues/52079", "id": 338654873, "node_id": "MDU6SXNzdWUzMzg2NTQ4NzM=", "number": 52079, "title": "Derivable traits do not work for `PhantomData<T>` if `T` does not impl them as well", "user": {"login": "Evrey", "id": 6483505, "node_id": "MDQ6VXNlcjY0ODM1MDU=", "avatar_url": "https://avatars.githubusercontent.com/u/6483505?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Evrey", "html_url": "https://github.com/Evrey", "followers_url": "https://api.github.com/users/Evrey/followers", "following_url": "https://api.github.com/users/Evrey/following{/other_user}", "gists_url": "https://api.github.com/users/Evrey/gists{/gist_id}", "starred_url": "https://api.github.com/users/Evrey/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Evrey/subscriptions", "organizations_url": "https://api.github.com/users/Evrey/orgs", "repos_url": "https://api.github.com/users/Evrey/repos", "events_url": "https://api.github.com/users/Evrey/events{/privacy}", "received_events_url": "https://api.github.com/users/Evrey/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2018-07-05T17:00:42Z", "updated_at": "2018-07-05T20:50:12Z", "closed_at": "2018-07-05T20:50:12Z", "author_association": "NONE", "active_lock_reason": null, "body": "```\r\nMy laptop:\r\nrustc 1.28.0-nightly (e3bf634e0 2018-06-28)\r\nnightly-i686-pc-windows-msvc (default)\r\n----\r\nPlaypen:\r\nrustc 1.27.0-stable\r\n```\r\n\r\nMinimal not working example:\r\n```Rust\r\nuse std::marker::PhantomData;\r\n\r\n#[derive(Copy, Clone, Eq, PartialEq, Debug)]\r\nstruct X<T> {\r\n    data:   u8,\r\n    marker: PhantomData<T>,\r\n}\r\n\r\nstruct NonDerive(u8);\r\n\r\nfn main() {\r\n    let x: X<NonDerive> = X { data: 0, marker: PhantomData };\r\n\r\n    let  x2 = x.clone(); // No clone?\r\n    let _x3 = x;         // No copy?\r\n    \r\n    assert_eq!(x, x2);   // No eq? No debug?\r\n    \r\n    drop(x);             // Moved?! (Comment out the `x2` lines.)\r\n}\r\n```\r\n[Playpen Link](https://play.rust-lang.org/?gist=3c28efed757d867734bc2ef23f3265c0&version=stable&mode=debug&edition=2015)\r\n\r\n`u8` and friends all implement the standard derivable traits, and [the docs](https://doc.rust-lang.org/nightly/core/marker/struct.PhantomData.html#implementations) state the same thing for `PhantomData<T>`, no matter what `T` is. So... myeah, this should work. Perhaps it is the trait bound resolution of `rustc` who's to blame?\r\n\r\nDoesn't quite look like a bug in `#[derive(...)]` itself, as code like this, makes the compiler punch you in the face right away, not needing any usage code to break.\r\n```Rust\r\nstruct NonClone(u8);\r\n\r\n#[derive(Clone)]\r\nstruct What(NonClone); // `rustc`: Wtf R U Doing?! `NonClone` is not `Clone`!\r\n```\r\nMake the `fn main()` above empty and it compiles.\r\n\r\nOnly caused by `PhantomData`, our little special snowflake. =)", "closed_by": {"login": "dtolnay", "id": 1940490, "node_id": "MDQ6VXNlcjE5NDA0OTA=", "avatar_url": "https://avatars.githubusercontent.com/u/1940490?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dtolnay", "html_url": "https://github.com/dtolnay", "followers_url": "https://api.github.com/users/dtolnay/followers", "following_url": "https://api.github.com/users/dtolnay/following{/other_user}", "gists_url": "https://api.github.com/users/dtolnay/gists{/gist_id}", "starred_url": "https://api.github.com/users/dtolnay/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dtolnay/subscriptions", "organizations_url": "https://api.github.com/users/dtolnay/orgs", "repos_url": "https://api.github.com/users/dtolnay/repos", "events_url": "https://api.github.com/users/dtolnay/events{/privacy}", "received_events_url": "https://api.github.com/users/dtolnay/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/52079/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/52079/timeline", "performed_via_github_app": null, "state_reason": "completed"}