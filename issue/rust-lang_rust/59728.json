{"url": "https://api.github.com/repos/rust-lang/rust/issues/59728", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/59728/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/59728/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/59728/events", "html_url": "https://github.com/rust-lang/rust/issues/59728", "id": 429842773, "node_id": "MDU6SXNzdWU0Mjk4NDI3NzM=", "number": 59728, "title": "Mutable references can be used after immutable ones are assigned", "user": {"login": "rlavande", "id": 49317566, "node_id": "MDQ6VXNlcjQ5MzE3NTY2", "avatar_url": "https://avatars.githubusercontent.com/u/49317566?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rlavande", "html_url": "https://github.com/rlavande", "followers_url": "https://api.github.com/users/rlavande/followers", "following_url": "https://api.github.com/users/rlavande/following{/other_user}", "gists_url": "https://api.github.com/users/rlavande/gists{/gist_id}", "starred_url": "https://api.github.com/users/rlavande/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rlavande/subscriptions", "organizations_url": "https://api.github.com/users/rlavande/orgs", "repos_url": "https://api.github.com/users/rlavande/repos", "events_url": "https://api.github.com/users/rlavande/events{/privacy}", "received_events_url": "https://api.github.com/users/rlavande/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-04-05T16:39:50Z", "updated_at": "2019-04-05T17:16:49Z", "closed_at": "2019-04-05T16:43:22Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello, I'm new to the community. I was learning Rust from the Book and came across an odd problem.\r\n\r\nThis example is as given in the Rust book \r\n\r\n```\r\nfn main() {\r\n\u00a0\u00a0\u00a0\u00a0let mut s = String::from(\"hello world\");\r\n\r\n\u00a0\u00a0\u00a0\u00a0let word = first_word(&s);\r\n\r\n\u00a0\u00a0\u00a0\u00a0s.clear();\r\n}\r\n\r\nfn first_word(s: &String) -> &str {\r\n\u00a0\u00a0\u00a0\u00a0let bytes = s.as_bytes();\r\n\r\n\u00a0\u00a0\u00a0\u00a0for (i, &item) in bytes.iter().enumerate() {\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0if item == b' ' {\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0return &s[0..i];\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0}\r\n\u00a0\u00a0\u00a0\u00a0}\r\n\r\n\u00a0\u00a0\u00a0\u00a0&s[..]\r\n}\r\n```\r\n\r\nThe compiler should give an error because 'word' lives on even after the last statement in main where then it goes out of scope but 'clear()' requires a mutable reference to 's' . So this should give a 'immutable after mutable' kind of error.\r\n\r\nHowever this piece of code is not giving any errors.\r\n\r\nI thought it might be because of the way the local variables are popped from the stack (that they would be in order of definition rather than the usual reverse order) but that should make no difference; that will happen only after the last statement. The last statement in 'main' however should be where the error lies. \r\n\r\nI don't know if it is because of compiler optimization of code or if it is a real issue.\r\nPlease respond.", "closed_by": {"login": "jonas-schievink", "id": 1786438, "node_id": "MDQ6VXNlcjE3ODY0Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/1786438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jonas-schievink", "html_url": "https://github.com/jonas-schievink", "followers_url": "https://api.github.com/users/jonas-schievink/followers", "following_url": "https://api.github.com/users/jonas-schievink/following{/other_user}", "gists_url": "https://api.github.com/users/jonas-schievink/gists{/gist_id}", "starred_url": "https://api.github.com/users/jonas-schievink/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jonas-schievink/subscriptions", "organizations_url": "https://api.github.com/users/jonas-schievink/orgs", "repos_url": "https://api.github.com/users/jonas-schievink/repos", "events_url": "https://api.github.com/users/jonas-schievink/events{/privacy}", "received_events_url": "https://api.github.com/users/jonas-schievink/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/59728/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/59728/timeline", "performed_via_github_app": null, "state_reason": "completed"}