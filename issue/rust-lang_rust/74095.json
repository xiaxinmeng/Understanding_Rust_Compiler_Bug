{"url": "https://api.github.com/repos/rust-lang/rust/issues/74095", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/74095/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/74095/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/74095/events", "html_url": "https://github.com/rust-lang/rust/issues/74095", "id": 651502112, "node_id": "MDU6SXNzdWU2NTE1MDIxMTI=", "number": 74095, "title": "c++ convert to rust ,compling is ok but result is error!Anyone knows which step is error.", "user": {"login": "kematy", "id": 45848649, "node_id": "MDQ6VXNlcjQ1ODQ4NjQ5", "avatar_url": "https://avatars.githubusercontent.com/u/45848649?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kematy", "html_url": "https://github.com/kematy", "followers_url": "https://api.github.com/users/kematy/followers", "following_url": "https://api.github.com/users/kematy/following{/other_user}", "gists_url": "https://api.github.com/users/kematy/gists{/gist_id}", "starred_url": "https://api.github.com/users/kematy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kematy/subscriptions", "organizations_url": "https://api.github.com/users/kematy/orgs", "repos_url": "https://api.github.com/users/kematy/repos", "events_url": "https://api.github.com/users/kematy/events{/privacy}", "received_events_url": "https://api.github.com/users/kematy/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-07-06T12:34:23Z", "updated_at": "2020-07-06T13:17:31Z", "closed_at": "2020-07-06T13:17:31Z", "author_association": "NONE", "active_lock_reason": null, "body": "C++ code:\r\n  #include <iostream>\r\n  #include <cmath>\r\n  using namespace std;\r\n//x[n]       \u5b58\u653e\u7ed9\u5b9a\u6570\u636e\u70b9\u7684X\u5750\u6807\u3002\r\n//y[n]       \u5b58\u653e\u7ed9\u5b9a\u6570\u636e\u70b9\u7684Y\u5750\u6807\u3002\r\n//z[n][m]    \u5b58\u653e\u7ed9\u5b9an*m\u4e2a\u7f51\u70b9\u4e0a\u51fd\u6570\u503c\u3002\r\n//n          X\u5750\u6807\u4e2a\u6570\u3002\r\n//m          Y\u5750\u6807\u4e2a\u6570\u3002\r\n//a[p][q]    \u8fd4\u56de\u4e8c\u5143\u62df\u5408\u591a\u9879\u5f0f\u7684\u7cfb\u6570\u3002\r\n//p          \u62df\u5408\u591a\u9879\u5f0f\u4e2dx\u7684\u6700\u9ad8\u6b21\u4e3ap-1\u3002\u8981\u6c42p<=min(n,20)\u3002\r\n//q          \u62df\u5408\u591a\u9879\u5f0f\u4e2dy\u7684\u6700\u9ad8\u6b21\u4e3aq-1\u3002\u8981\u6c42q<=min(n,20)\u3002\r\n//dt[3]      \u5206\u522b\u8fd4\u56de\u8bef\u5dee\u5e73\u65b9\u548c\uff0c\u8bef\u5dee\u7edd\u5bf9\u503c\u4e4b\u548c\u4e0e\u8bef\u5dee\u7edd\u5bf9\u503c\u7684\u6700\u5927\u503c\u3002\r\n  void pir2(double x[], double y[], double z[], int n, int m, \r\n\t        double a[], int p, int q, double dt[])\r\n  { \r\n\t  int i,j,k,l,kk;\r\n      double apx[20],apy[20],bx[20],by[20],u[20][20];\r\n      double t[20],t1[20],t2[20],d1,d2,g,g1,g2;\r\n      double x2,dd,y1,x1,*v;\r\n      v = new double[20*m];\r\n      for (i=0; i<=p-1; i++)\r\n      { \r\n\t\t  l=i*q;\r\n          for (j=0; j<=q-1; j++) a[l+j]=0.0;\r\n      }\r\n      if (p>n) p=n;\r\n      if (p>20) p=20;\r\n      if (q>m) q=m;\r\n      if (q>20) q=20;\r\n      d1=1.0*n; apx[0]=0.0;\r\n      for (i=0; i<=n-1; i++)  apx[0]=apx[0]+x[i];\r\n      apx[0]=apx[0]/d1;\r\n      for (j=0; j<=m-1; j++)\r\n      { \r\n\t\t  v[j]=0.0;\r\n          for (i=0; i<=n-1; i++)  v[j]=v[j]+z[i*m+j];\r\n          v[j]=v[j]/d1;\r\n      }\r\n      if (p>1)\r\n      { \r\n\t\t  d2=0.0; apx[1]=0.0;\r\n          for (i=0; i<=n-1; i++)\r\n          { \r\n\t\t\t  g=x[i]-apx[0];\r\n              d2=d2+g*g;\r\n              apx[1]=apx[1]+x[i]*g*g;\r\n          }\r\n          apx[1]=apx[1]/d2;\r\n          bx[1]=d2/d1;\r\n          for (j=0; j<=m-1; j++)\r\n          { \r\n\t\t\t  v[m+j]=0.0;\r\n              for (i=0; i<=n-1; i++)\r\n              { \r\n\t\t\t\t  g=x[i]-apx[0];\r\n                  v[m+j]=v[m+j]+z[i*m+j]*g;\r\n              }\r\n              v[m+j]=v[m+j]/d2;\r\n          }\r\n          d1=d2;\r\n      }\r\n      for (k=2; k<=p-1; k++)\r\n      { \r\n\t\t  d2=0.0; apx[k]=0.0;\r\n          for (j=0; j<=m-1; j++) v[k*m+j]=0.0;\r\n          for (i=0; i<=n-1; i++)\r\n          { \r\n\t\t\t  g1=1.0; g2=x[i]-apx[0];\r\n              for (j=2; j<=k; j++)\r\n              { \r\n\t\t\t\t  g=(x[i]-apx[j-1])*g2-bx[j-1]*g1;\r\n                  g1=g2; g2=g;\r\n              }\r\n              d2=d2+g*g;\r\n              apx[k]=apx[k]+x[i]*g*g;\r\n              for (j=0; j<=m-1; j++) v[k*m+j]=v[k*m+j]+z[i*m+j]*g;\r\n          }\r\n          for (j=0; j<=m-1; j++) v[k*m+j]=v[k*m+j]/d2;\r\n          apx[k]=apx[k]/d2;\r\n          bx[k]=d2/d1;\r\n          d1=d2;\r\n      }\r\n      d1=m; apy[0]=0.0;\r\n      for (i=0; i<=m-1; i++) apy[0]=apy[0]+y[i];\r\n      apy[0]=apy[0]/d1;\r\n      for (j=0; j<=p-1; j++)\r\n      { \r\n\t\t  u[j][0]=0.0;\r\n          for (i=0; i<=m-1; i++)  u[j][0]=u[j][0]+v[j*m+i];\r\n\t      u[j][0]=u[j][0]/d1;\r\n      }\r\n      if (q>1)\r\n      { \r\n\t\t  d2=0.0; apy[1]=0.0;\r\n          for (i=0; i<=m-1; i++)\r\n          { \r\n\t\t\t  g=y[i]-apy[0];\r\n              d2=d2+g*g;\r\n              apy[1]=apy[1]+y[i]*g*g;\r\n          }\r\n          apy[1]=apy[1]/d2;\r\n          by[1]=d2/d1;\r\n          for (j=0; j<=p-1; j++)\r\n\t\t  { \r\n\t\t\t  u[j][1]=0.0;\r\n              for (i=0; i<=m-1; i++)\r\n              { \r\n\t\t\t\t  g=y[i]-apy[0];\r\n\t\t          u[j][1]=u[j][1]+v[j*m+i]*g;\r\n              }\r\n\t          u[j][1]=u[j][1]/d2;\r\n          }\r\n          d1=d2;\r\n      }\r\n      for (k=2; k<=q-1; k++)\r\n      { \r\n\t\t  d2=0.0; apy[k]=0.0;\r\n\t      for (j=0; j<=p-1; j++) u[j][k]=0.0;\r\n          for (i=0; i<=m-1; i++)\r\n          { \r\n\t\t\t  g1=1.0;\r\n              g2=y[i]-apy[0];\r\n              for (j=2; j<=k; j++)\r\n              { \r\n\t\t\t\t  g=(y[i]-apy[j-1])*g2-by[j-1]*g1;\r\n                  g1=g2; g2=g;\r\n              }\r\n              d2=d2+g*g;\r\n              apy[k]=apy[k]+y[i]*g*g;\r\n              for (j=0; j<=p-1; j++) u[j][k]=u[j][k]+v[j*m+i]*g;\r\n          }\r\n          for (j=0; j<=p-1; j++) u[j][k]=u[j][k]/d2;\r\n          apy[k]=apy[k]/d2;\r\n          by[k]=d2/d1;\r\n          d1=d2;\r\n      }\r\n      v[0]=1.0; v[m]=-apy[0]; v[m+1]=1.0;\r\n      for (i=0; i<=p-1; i++)\r\n      for (j=0; j<=q-1; j++) a[i*q+j]=0.0;\r\n      for (i=2; i<=q-1; i++)\r\n      { \r\n\t\t  v[i*m+i]=v[(i-1)*m+(i-1)];\r\n          v[i*m+i-1]=-apy[i-1]*v[(i-1)*m+i-1]+v[(i-1)*m+i-2];\r\n          if (i>=3)\r\n          for (k=i-2; k>=1; k--)\r\n            v[i*m+k]=-apy[i-1]*v[(i-1)*m+k]+\r\n                     v[(i-1)*m+k-1]-by[i-1]*v[(i-2)*m+k];\r\n          v[i*m]=-apy[i-1]*v[(i-1)*m]-by[i-1]*v[(i-2)*m];\r\n      }\r\n      for (i=0; i<=p-1; i++)\r\n      { \r\n\t\t  if (i==0) { t[0]=1.0; t1[0]=1.0;}\r\n          else\r\n          { \r\n\t\t\t  if (i==1)\r\n              { \r\n\t\t\t\t  t[0]=-apx[0]; t[1]=1.0;\r\n                  t2[0]=t[0]; t2[1]=t[1];\r\n              }\r\n              else\r\n              { \r\n\t\t\t\t  t[i]=t2[i-1];\r\n                  t[i-1]=-apx[i-1]*t2[i-1]+t2[i-2];\r\n                  if (i>=3)\r\n                  for (k=i-2; k>=1; k--)\r\n                    t[k]=-apx[i-1]*t2[k]+t2[k-1]\r\n                         -bx[i-1]*t1[k];\r\n                  t[0]=-apx[i-1]*t2[0]-bx[i-1]*t1[0];\r\n                  t2[i]=t[i];\r\n                  for (k=i-1; k>=0; k--)\r\n                  { t1[k]=t2[k]; t2[k]=t[k];}\r\n              }\r\n          }\r\n          for (j=0; j<=q-1; j++)\r\n          for (k=i; k>=0; k--)\r\n          for (l=j; l>=0; l--)\r\n\t         a[k*q+l]=a[k*q+l]+u[i][j]*t[k]*v[j*m+l];\r\n      }\r\n      dt[0]=0.0; dt[1]=0.0; dt[2]=0.0;\r\n      for (i=0; i<=n-1; i++)\r\n      { \r\n\t\t  x1=x[i];\r\n          for (j=0; j<=m-1; j++)\r\n          { \r\n\t\t\t  y1=y[j];\r\n              x2=1.0; dd=0.0;\r\n              for (k=0; k<=p-1; k++)\r\n              { \r\n\t\t\t\t  g=a[k*q+q-1];\r\n                  for (kk=q-2; kk>=0; kk--) g=g*y1+a[k*q+kk];\r\n                  g=g*x2; dd=dd+g; x2=x2*x1;\r\n              }\r\n              dd=dd-z[i*m+j];\r\n              if (fabs(dd)>dt[2]) dt[2]=fabs(dd);\r\n              dt[0]=dt[0]+dd*dd;\r\n              dt[1]=dt[1]+fabs(dd);\r\n          }\r\n      }\r\n      delete[] v;\r\n      return;\r\n  }\r\n\r\n//\u6700\u5c0f\u4e8c\u4e58\u66f2\u9762\u62df\u5408\u4f8b\r\n  #include <iostream>\r\n  #include <iomanip>\r\n  #include <cmath>\r\n//  #include \"\u6700\u5c0f\u4e8c\u4e58\u66f2\u9762\u62df\u5408.cpp\"\r\n  using namespace std;\r\n  int main()\r\n  { \r\n\t  int i,j;\r\n      double x[11],y[21],z[11][21],a[6][5],dt[3];\r\n      for (i=0; i<=10; i++) x[i]=0.2*i;\r\n      for (i=0; i<=20; i++) y[i]=0.1*i;\r\n      for (i=0; i<=10; i++)\r\n      for (j=0; j<=20; j++)\r\n          z[i][j]=exp(x[i]*x[i]-y[j]*y[j]);\r\n      pir2(x,y,&z[0][0],11,21,&a[0][0],6,5,dt);\r\n      cout <<\"\u4e8c\u5143\u62df\u5408\u591a\u9879\u5f0f\u7cfb\u6570\u77e9\u9635 : \" <<endl;\r\n      for (i=0; i<=5; i++)\r\n      { \r\n\t\t  for (j=0; j<=4; j++)\r\n              cout <<setw(14) <<a[i][j];\r\n          cout <<endl;\r\n      }\r\n      cout <<\"\u8bef\u5dee\u5e73\u65b9\u548c = \" <<dt[0] <<endl;\r\n\t  cout <<\"\u8bef\u5dee\u7edd\u5bf9\u503c\u548c = \" <<dt[1] <<endl;\r\n\t  cout <<\"\u8bef\u5dee\u7edd\u5bf9\u503c\u6700\u5927\u503c = \" <<dt[2] <<endl;\r\n      return 0;\r\n  }\r\n/////////////////////////////////////////////////////////////////\r\nand rust code is here:\r\n#[no_mangle]\r\nextern \"C\" fn fit_surface_least_squares_m( n:usize, m:usize,mut p:usize,mut q:usize,x:&[f64;100],y:&[f64;100],z:&[[f64;100];100],a:&mut [[f64;20];20],dt:&mut [f64;3])->bool\r\n{\r\n\t\r\n\t//let mut l:usize;\r\n\t//let mut kk:usize;\r\n    let mut apx=[0.0;20];\r\n    let mut apy=[0.0;20];\r\n    let mut bx=[0.0;20];\r\n    let mut by=[0.0;20];\r\n    let mut t=[0.0;20];\r\n    let mut t1=[0.0;20];\r\n    let mut t2=[0.0;20];\r\n    //let mut d2:f64;\r\n    let mut d=[0.0;2];\r\n    let mut g=[0.0;3];\r\n    //let mut g1:f64;\r\n    //let mut g2:f64;\r\n    let mut x2:f64;\r\n    let mut dd:f64;\r\n    let mut y1:f64;\r\n    let mut x1:f64;\r\n    let mut v=[[0.0;100];20];\r\n    let mut u=[[0.0;20];20];\r\n\t//matrix<_Ty> v(20,m), u(20,20);\r\n\r\n\t//int p = a.GetRowNum();\t\t//\u62df\u5408\u591a\u9879\u5f0f\u4e2d\u53d8\u91cfx\u7684\u6700\u9ad8\u6b21\u6570\u52a01\r\n\t//\u5e76\u8981\u6c42p<=n\u4e14p<=20; \u5426\u5219\u5728\u672c\u51fd\u6570\u4e2d\u81ea\u52a8\u53d6p=min{n,20}\u5904\u7406\r\n\r\n\t//int q = a.GetColNum();\t\t//\u62df\u5408\u591a\u9879\u5f0f\u4e2d\u53d8\u91cfy\u7684\u6700\u9ad8\u6b21\u6570\u52a01\r\n\t//\u5e76\u8981\u6c42q<=m\u4e14q<=20; \u5426\u5219\u5728\u672c\u51fd\u6570\u4e2d\u81ea\u52a8\u53d6q=min{m,20}\u5904\u7406\r\n\r\n    for i in 0..p\r\n    {\r\n    \tfor j in 0..q\r\n    \t{\r\n    \t\ta[i][j]=0.0;\r\n    \t} \r\n    }    \r\n\r\n    if p>n {p=n;}\r\n    if p>20 {p=20;} \r\n    if q>m {q=m;}\r\n    if q>20 {q=20;}\r\n\r\n    let mut xx:f64=0.0;\r\n    \r\n    \r\n    for i in 0..n \r\n    {\r\n    \txx+=  x[i] / (n as f64);\r\n    }\r\n    let mut yy:f64=0.0;\r\n    for i in 0..m \r\n    { \r\n    \tyy+= y[i] / (m as f64);\r\n    } \r\n    d[0]=n as f64; \r\n    apx[0]=0.0;\r\n    for i in 0..n \r\n    {\r\n    \tapx[0]+=x[i] - xx;\r\n    }\t\r\n    apx[0] = apx[0] / d[0];\r\n    for j in 0..m\r\n    { \r\n\t\tv[0][j]=0.0;\r\n        for i in 0..n \r\n        {\r\n        \tv[0][j]=v[0][j]+z[i][j];\r\n        }\t\r\n        v[0][j]=v[0][j]/d[0];\r\n    }\r\n    if p>1\r\n    { \r\n\t\td[1]=0.0;\r\n\t\tapx[1]=0.0;\r\n        for i in 0..n\r\n        {\r\n\t\t\tg[0]=x[i]-xx-apx[0];\r\n            d[1]+=g[0]*g[0];\r\n            apx[1]+=(x[i]-xx)*g[0]*g[0];\r\n        }\r\n        apx[1]=apx[1]/d[1];\r\n        bx[1]=d[1]/d[0];\r\n        for j in 0..m\r\n        { \r\n\t\t\tv[1][j]=0.0;\r\n            for i in 0..n\r\n            {\r\n\t\t\t\tg[0]=x[i]-xx-apx[0];\r\n                v[1][j]=v[1][j]+z[i][j]*g[0];\r\n            }\r\n            v[1][j]/=d[1];\r\n        }\r\n        d[0]=d[1];\r\n    }\r\n    for k in 2..p\r\n    { \r\n\t\td[1]=0.0; \r\n\t\tapx[k]=0.0;\r\n        for j in 0..m \r\n        {\r\n        \tv[k][j]=0.0;\r\n        } \r\n        for i in 0..n\r\n        {\r\n\t\t\tg[1]=1.0; \r\n\t\t\tg[2]=x[i]-xx-apx[0];\r\n\r\n            for j in 2..=k\r\n            {\r\n\t\t\t\tg[0]=(x[i]-xx-apx[j-1])*g[2]-bx[j-1]*g[1];\r\n                g[1]=g[2]; \r\n                g[2]=g[0];\r\n            }\r\n            d[1]+=g[0]*g[0];\r\n            apx[k]=apx[k]+(x[i]-xx)*g[0]*g[0];\r\n            for j in 0..m\t\r\n            {\r\n            \tv[k][j]+=z[i][j]*g[0];\r\n            }\r\n        }\r\n        for j in 0..m \r\n        {\r\n        \tv[k][j]/=d[1];\r\n        }\t\r\n        apx[k]=apx[k]/d[1];\r\n        bx[k]=d[1]/d[0];\r\n        d[0]=d[1];\r\n    }\r\n    d[0]=m as f64; \r\n\tapy[0]=0.0;\r\n    for i in 0..m \r\n    {\r\n    \tapy[0]+=y[i]-yy;\r\n    }\t\r\n    apy[0]=apy[0]/d[0];\r\n    for j in 0..p\r\n    { \r\n\t\tu[j][0]=0.0;\r\n        for i in 0..m \r\n        {\r\n        \tu[j][0]+=v[j][i];\r\n        }\t\r\n\t\tu[j][0]/=d[0];\r\n    }\r\n    if q>1\r\n    { \r\n\t\td[1]=0.0; \r\n\t\tapy[1]=0.0;\r\n        for i in 0..m\r\n        {\r\n\t\t\tg[0]=y[i]-yy-apy[0];\r\n            d[1]+=g[0]*g[0];\r\n            apy[1]+=(y[i]-yy)*g[0]*g[0];\r\n        }\r\n        apy[1]=apy[1]/d[1];\r\n        by[1]=d[1]/d[0];\r\n        for j in 0..p\r\n\t\t{\r\n\t\t\tu[j][1]=0.0;\r\n            for i in 0..m\r\n            {\r\n\t\t\t\tg[0]=y[i]-yy-apy[0];\r\n\t\t\t\tu[j][1]+=v[j][i]*g[0];\r\n            }\r\n\t\t\tu[j][1]/=d[1];\r\n        }\r\n        d[0]=d[1];\r\n    }\r\n    for k in 2..q\r\n    { \r\n\t\td[1]=0.0;\r\n\t\tapy[k]=0.0;\r\n\t\tfor j in 0..p \r\n\t\t{\r\n\t\t\tu[j][k]=0.0;\r\n\t\t} \r\n        for i in 0..m\r\n        {\r\n\t\t\tg[1]=1.0;\r\n            g[2]=y[i]-yy-apy[0];\r\n            for j in 2..=k\r\n            {\r\n\t\t\t\tg[0]=(y[i]-yy-apy[j-1])*g[2]-by[j-1]*g[1];\r\n                g[1]=g[2];\r\n\t\t\t\tg[2]=g[0];\r\n            }\r\n            d[1]+=g[0]*g[0];\r\n            apy[k]=apy[k]+(y[i]-yy)*g[0]*g[0];\r\n            for j in 0..p \r\n            {\r\n            \tu[j][k]+=v[j][i]*g[0];\r\n            }\t\r\n        }\r\n        for j in 0..p \r\n        {\r\n        \tu[j][k]/=d[1];\r\n        }\t\r\n        apy[k]/=d[1];\r\n        by[k]=d[1]/d[0];\r\n        d[0]=d[1];\r\n    }\r\n    v[0][0]=1.0;\r\n\tv[1][0]=-apy[0]; \r\n\tv[1][1]=1.0;\r\n    for i in 0..p\r\n    {\r\n      for j in 0..q \r\n      {\r\n      \ta[i][j]=0.0;\r\n      }\t\r\n    }\r\n\r\n    for i in 2..q\r\n    {\r\n\t\tv[i][i]=v[i-1][i-1];\r\n        v[i][i-1]=-apy[i-1]*v[i-1][i-1]+v[i-1][i-2];\r\n        if i>=3\r\n        {\r\n        \tfor k in (1..=(i-2)).rev()\r\n        \t{\r\n        \t\tv[i][k]=-apy[i-1]*v[i-1][k]+v[i-1][k-1]-by[i-1]*v[i-2][k];\r\n        \t}\r\n            \r\n        }\r\n          \r\n        v[i][0]=-apy[i-1]*v[i-1][0]-by[i-1]*v[i-2][0];\r\n    }\r\n    for i in 0..p\r\n    { \r\n\t\tif i==0\r\n\t\t{\r\n\t\t\tt[0]=1.0;\r\n\t\t\tt1[0]=1.0;\r\n\t\t}\r\n        else\r\n        {\r\n\t\t\tif i==1\r\n            {\r\n\t\t\t\tt[0]=-apx[0];\r\n\t\t\t\tt[1]=1.0;\r\n                t2[0]=t[0];\r\n\t\t\t\tt2[1]=t[1];\r\n            }\r\n            else\r\n            { \r\n\t\t\t\tt[i]=t2[i-1];\r\n                t[i-1]=-apx[i-1]*t2[i-1]+t2[i-2];\r\n                if i>=3\r\n                {\r\n                \tfor k in (1..=(i-2)).rev()\r\n                \t{\r\n                \t\tt[k]=-apx[i-1]*t2[k]+t2[k-1]-bx[i-1]*t1[k];\r\n                         \r\n                \t}\r\n                    \r\n                }\r\n                  \r\n                t[0]=-apx[i-1]*t2[0]-bx[i-1]*t1[0];\r\n                t2[i]=t[i];\r\n                for k in (0..=(i-1)).rev()\r\n                { \r\n\t\t\t\t\tt1[k]=t2[k];\r\n\t\t\t\t\tt2[k]=t[k];\r\n\t\t\t\t}\r\n            }\r\n        }\r\n        for j in 0..q\r\n        {\r\n        \tfor k in (0..=i).rev()\r\n        \t{\r\n        \t\tfor l in (0..=j).rev()\r\n\t\t\t\t{\r\n\t\t\t\t\ta[k][l]+=u[i][j]*t[k]*v[j][l];\r\n\t\t\t\t}\r\n        \t}\r\n            \r\n        }\r\n          \r\n    }\r\n    for i in 0..3\r\n    {\r\n    \tdt[i]=0.0; \r\n    }\r\n\t//\u8ba1\u7b97dt \r\n    //dt[0]\u5b58\u653e\u62df\u5408\u591a\u9879\u5f0f\u4e0e\u6570\u636e\u70b9\u8bef\u5dee\u7684\u5e73\u65b9\u548c \r\n    //dt[1]\u5b58\u653e\u62df\u5408\u591a\u9879\u5f0f\u4e0e\u6570\u636e\u70b9\u8bef\u5dee\u7684\u7edd\u5bf9\u503c\u4e4b\u548c \r\n    //dt[2]\u5b58\u653e\u62df\u5408\u591a\u9879\u5f0f\u4e0e\u6570\u636e\u70b9\u8bef\u5dee\u7edd\u5bf9\u503c\u7684\u6700\u5927\u503c\r\n    for i in 0..n\r\n    {\r\n\t\tx1=x[i]-xx;\r\n        for j in 0..m\r\n        {\r\n\t\t\ty1=y[j]-yy;\r\n            x2=1.0; \r\n\t\t\tdd=0.0;\r\n            for k in 0..p\r\n            {\r\n\t\t\t\tg[0]=a[k][q-1];\r\n                for kk in (0..=(q-2)).rev() \r\n                {\r\n                \tg[0]=g[0]*y1+a[k][kk];\r\n                }\t\r\n                g[0]=g[0]*x2;\r\n\t\t\t\tdd+=g[0];\r\n\t\t\t\tx2*=x1;\r\n            }\r\n            dd-=z[i][j];\r\n            if dd.abs()>dt[2] \r\n            {\r\n            \tdt[2]=dd.abs();\r\n            } \r\n            dt[0]=dt[0]+dd*dd;\r\n            dt[1]=dt[1]+dd.abs();\r\n        }\r\n    }\r\n  true\r\n}\r\n\r\nc++ result:\r\n\u4e8c\u5143\u62df\u5408\u591a\u9879\u5f0f\u7cfb\u6570\u77e9\u9635 :\r\n      0.888696      0.096095      -1.38677      0.903053     -0.171411\r\n       8.59716      0.929614      -13.4154       8.73604      -1.65821\r\n      -45.7529      -4.94728       71.3951       -46.492       8.82477\r\n       85.1474       9.20702      -132.868       86.5229      -16.4231\r\n      -62.8532      -6.79634       98.0792      -63.8686       12.1231\r\n         16.99       1.83714      -26.5121       17.2645      -3.27702\r\n\u8bef\u5dee\u5e73\u65b9\u548c = 5.80139\r\n\u8bef\u5dee\u7edd\u5bf9\u503c\u548c = 25.3761\r\n\u8bef\u5dee\u7edd\u5bf9\u503c\u6700\u5927\u503c = 0.555972\r\n\r\nruby ffi call rust dll result:\r\n\u7cfb\u6570\u77e9\u9635a=[[12.610828495549994, -6.4031174330927225, -48.421984673330485, 7.374037165505316, 38.79011866159077], [-6.304552141689332, 3.2011209842825186, 24.207682095178615, -3.68651447611775, -19.39240754646785], [-1.5801195738843747, 0.8023018625207973, 6.06720849590951, -0.9239567779291769, -4.860348849570485], [1.3068055530349345, -0.6635273345643454, -5.01776060806868, 0.7641395424233058, 4.019652038542775], [0.043835634614448844, -0.022257436637848578, -0.16831633450534478, 0.025632384020965664, 0.13483566673677283], [-0.12004056416126747, 0.06095030388610434, 0.46092152946540504, -0.07019234159007005, -0.3692372574619461]]\r\n\r\n\u8bef\u5dee\u5e73\u65b9\u548c = 14546.87281940942\r\n\u8bef\u5dee\u7edd\u5bf9\u503c\u548c =1105.0604796924251\r\n\u8bef\u5dee\u7edd\u5bf9\u503c\u6700\u5927\u503c =38.4058183240485,\r\n\r\nThe result is not same\r\n\r\n\r\n \r\n\r\n", "closed_by": {"login": "jonas-schievink", "id": 1786438, "node_id": "MDQ6VXNlcjE3ODY0Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/1786438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jonas-schievink", "html_url": "https://github.com/jonas-schievink", "followers_url": "https://api.github.com/users/jonas-schievink/followers", "following_url": "https://api.github.com/users/jonas-schievink/following{/other_user}", "gists_url": "https://api.github.com/users/jonas-schievink/gists{/gist_id}", "starred_url": "https://api.github.com/users/jonas-schievink/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jonas-schievink/subscriptions", "organizations_url": "https://api.github.com/users/jonas-schievink/orgs", "repos_url": "https://api.github.com/users/jonas-schievink/repos", "events_url": "https://api.github.com/users/jonas-schievink/events{/privacy}", "received_events_url": "https://api.github.com/users/jonas-schievink/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/74095/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 1, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/74095/timeline", "performed_via_github_app": null, "state_reason": "completed"}