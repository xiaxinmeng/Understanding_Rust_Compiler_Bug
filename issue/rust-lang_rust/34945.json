{"url": "https://api.github.com/repos/rust-lang/rust/issues/34945", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/34945/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/34945/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/34945/events", "html_url": "https://github.com/rust-lang/rust/issues/34945", "id": 166702023, "node_id": "MDU6SXNzdWUxNjY3MDIwMjM=", "number": 34945, "title": "Bad error when passing around self and &mut self", "user": {"login": "jntrnr", "id": 547158, "node_id": "MDQ6VXNlcjU0NzE1OA==", "avatar_url": "https://avatars.githubusercontent.com/u/547158?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jntrnr", "html_url": "https://github.com/jntrnr", "followers_url": "https://api.github.com/users/jntrnr/followers", "following_url": "https://api.github.com/users/jntrnr/following{/other_user}", "gists_url": "https://api.github.com/users/jntrnr/gists{/gist_id}", "starred_url": "https://api.github.com/users/jntrnr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jntrnr/subscriptions", "organizations_url": "https://api.github.com/users/jntrnr/orgs", "repos_url": "https://api.github.com/users/jntrnr/repos", "events_url": "https://api.github.com/users/jntrnr/events{/privacy}", "received_events_url": "https://api.github.com/users/jntrnr/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 235791, "node_id": "MDU6TGFiZWwyMzU3OTE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-diagnostics", "name": "A-diagnostics", "color": "f7e101", "default": false, "description": "Area: Messages for errors, warnings, and lints"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2016-07-20T22:59:51Z", "updated_at": "2016-10-09T22:33:52Z", "closed_at": "2016-10-09T22:33:52Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "In this example:\n\n``` Rust\nstruct DB { }\n\nimpl DB {\n    fn make() -> DB { DB { } }\n    fn do_thing(&mut self) -> &mut DB { self }\n    fn done(&mut self) { }\n}\n\nfn main() {\n    let mut err = DB::make().do_thing();\n    err.done();\n}\n```\n\nI'm getting this fairly confusing error message:\n\n``` term\nerror: borrowed value does not live long enough\n  --> bad_error.rs:10:19\n   |\n10 |     let mut err = DB::make().do_thing();\n   |                   ^^^^^^^^^^ does not live long enough\n   |\nnote: reference must be valid for the block suffix following statement 0 at 10:40...\n  --> bad_error.rs:10:41\n   |\n10 |     let mut err = DB::make().do_thing();\n   |                                         ^\nnote: ...but borrowed value is only valid for the statement at 10:4\n  --> bad_error.rs:10:5\n   |\n10 |     let mut err = DB::make().do_thing();\n   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nhelp: consider using a `let` binding to increase its lifetime\n  --> bad_error.rs:10:5\n   |\n10 |     let mut err = DB::make().do_thing();\n   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\nerror: aborting due to previous error\n```\n\nNotice that I'm both told to put in let where let already exists, but also the primary span of the error is squiggle something that seemingly is okay.  We may want to lay out why it's not okay more clearly as well as not give hints for things that are already there.\n", "closed_by": {"login": "jntrnr", "id": 547158, "node_id": "MDQ6VXNlcjU0NzE1OA==", "avatar_url": "https://avatars.githubusercontent.com/u/547158?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jntrnr", "html_url": "https://github.com/jntrnr", "followers_url": "https://api.github.com/users/jntrnr/followers", "following_url": "https://api.github.com/users/jntrnr/following{/other_user}", "gists_url": "https://api.github.com/users/jntrnr/gists{/gist_id}", "starred_url": "https://api.github.com/users/jntrnr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jntrnr/subscriptions", "organizations_url": "https://api.github.com/users/jntrnr/orgs", "repos_url": "https://api.github.com/users/jntrnr/repos", "events_url": "https://api.github.com/users/jntrnr/events{/privacy}", "received_events_url": "https://api.github.com/users/jntrnr/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/34945/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/34945/timeline", "performed_via_github_app": null, "state_reason": "completed"}