{"url": "https://api.github.com/repos/rust-lang/rust/issues/102852", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/102852/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/102852/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/102852/events", "html_url": "https://github.com/rust-lang/rust/issues/102852", "id": 1402316075, "node_id": "I_kwDOAAsO6M5TlaUr", "number": 102852, "title": "Poor diagnostic message when passing in type constructor to generic function", "user": {"login": "alice-i-cecile", "id": 3579909, "node_id": "MDQ6VXNlcjM1Nzk5MDk=", "avatar_url": "https://avatars.githubusercontent.com/u/3579909?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alice-i-cecile", "html_url": "https://github.com/alice-i-cecile", "followers_url": "https://api.github.com/users/alice-i-cecile/followers", "following_url": "https://api.github.com/users/alice-i-cecile/following{/other_user}", "gists_url": "https://api.github.com/users/alice-i-cecile/gists{/gist_id}", "starred_url": "https://api.github.com/users/alice-i-cecile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alice-i-cecile/subscriptions", "organizations_url": "https://api.github.com/users/alice-i-cecile/orgs", "repos_url": "https://api.github.com/users/alice-i-cecile/repos", "events_url": "https://api.github.com/users/alice-i-cecile/events{/privacy}", "received_events_url": "https://api.github.com/users/alice-i-cecile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 235791, "node_id": "MDU6TGFiZWwyMzU3OTE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-diagnostics", "name": "A-diagnostics", "color": "f7e101", "default": false, "description": "Area: Messages for errors, warnings, and lints"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}], "state": "closed", "locked": false, "assignee": {"login": "compiler-errors", "id": 3674314, "node_id": "MDQ6VXNlcjM2NzQzMTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3674314?v=4", "gravatar_id": "", "url": "https://api.github.com/users/compiler-errors", "html_url": "https://github.com/compiler-errors", "followers_url": "https://api.github.com/users/compiler-errors/followers", "following_url": "https://api.github.com/users/compiler-errors/following{/other_user}", "gists_url": "https://api.github.com/users/compiler-errors/gists{/gist_id}", "starred_url": "https://api.github.com/users/compiler-errors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/compiler-errors/subscriptions", "organizations_url": "https://api.github.com/users/compiler-errors/orgs", "repos_url": "https://api.github.com/users/compiler-errors/repos", "events_url": "https://api.github.com/users/compiler-errors/events{/privacy}", "received_events_url": "https://api.github.com/users/compiler-errors/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "compiler-errors", "id": 3674314, "node_id": "MDQ6VXNlcjM2NzQzMTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3674314?v=4", "gravatar_id": "", "url": "https://api.github.com/users/compiler-errors", "html_url": "https://github.com/compiler-errors", "followers_url": "https://api.github.com/users/compiler-errors/followers", "following_url": "https://api.github.com/users/compiler-errors/following{/other_user}", "gists_url": "https://api.github.com/users/compiler-errors/gists{/gist_id}", "starred_url": "https://api.github.com/users/compiler-errors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/compiler-errors/subscriptions", "organizations_url": "https://api.github.com/users/compiler-errors/orgs", "repos_url": "https://api.github.com/users/compiler-errors/repos", "events_url": "https://api.github.com/users/compiler-errors/events{/privacy}", "received_events_url": "https://api.github.com/users/compiler-errors/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2022-10-09T15:53:49Z", "updated_at": "2022-10-19T13:53:01Z", "closed_at": "2022-10-19T13:53:01Z", "author_association": "NONE", "active_lock_reason": null, "body": "When passing arguments to a generic function, users can accidentally provide the type, rather than an instance to a type.\r\nThe error message provided is not very helpful (especially for beginners), as it uses the anonymous type, rather than pointing out the obvious error.\r\n\r\nGiven the following code: \r\n\r\n```rust\r\nfn main() {\r\n    insert_resource(Marker);\r\n    insert_resource(Time);\r\n}\r\n\r\ntrait Resource {}\r\n\r\nfn insert_resource<R: Resource>(resource: R) {}\r\n\r\nstruct Marker;\r\nimpl Resource for Marker {}\r\n\r\nstruct Time(u32);\r\n\r\nimpl Resource for Time {}\r\n```\r\n\r\nThe current output is:\r\n\r\n```\r\nerror[[E0277]](https://doc.rust-lang.org/stable/error-index.html#E0277): the trait bound `fn(u32) -> Time {Time}: Resource` is not satisfied\r\n --> src/main.rs:3:21\r\n  |\r\n3 |     insert_resource(Time);\r\n  |     --------------- ^^^^ the trait `Resource` is not implemented for `fn(u32) -> Time {Time}`\r\n  |     |\r\n  |     required by a bound introduced by this call\r\n  |\r\n  = help: the following other types implement trait `Resource`:\r\n            Marker\r\n            Time\r\nnote: required by a bound in `insert_resource`\r\n --> src/main.rs:8:23\r\n  |\r\n8 | fn insert_resource<R: Resource>(resource: R) {}\r\n  |                       ^^^^^^^^ required by this bound in `insert_resource`\r\n\r\nFor more information about this error, try `rustc --explain E0277`.```\r\n```\r\n\r\nIdeally the output should look like:\r\n```\r\nerror[[E0277]](https://doc.rust-lang.org/stable/error-index.html#E0277): the trait bound `fn(u32) -> Time {Time}: Resource` is not satisfied\r\n --> src/main.rs:3:21\r\n  |\r\n3 |     insert_resource(Time);\r\n  |     --------------- ^^^^ the trait `Resource` is not implemented for `fn(u32) -> Time {Time}`\r\n  |     |\r\n  |     required by a bound introduced by this call\r\n  |\r\n  = help: you've passed in a constructor, but the type itself implements the required trait. Did you mean to supply a concrete value for `Time`?\r\nnote: required by a bound in `insert_resource`\r\n --> src/main.rs:8:23\r\n  |\r\n8 | fn insert_resource<R: Resource>(resource: R) {}\r\n  |                       ^^^^^^^^ required by this bound in `insert_resource`\r\n\r\nFor more information about this error, try `rustc --explain E0277`.```\r\n\r\nNote that this particular diagnostic error is frustrating, since as shown with the `Marker` struct above, equivalent code compiles just fine when using unit structs.\r\n\r\nThis error is commonly encountered when writing or refactoring Bevy code, as both components and resources have trait bounds and unit structs are widely used.\r\n\r\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/102852/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/102852/timeline", "performed_via_github_app": null, "state_reason": "completed"}