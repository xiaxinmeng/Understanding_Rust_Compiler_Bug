{"url": "https://api.github.com/repos/rust-lang/rust/issues/66954", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/66954/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/66954/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/66954/events", "html_url": "https://github.com/rust-lang/rust/issues/66954", "id": 531071376, "node_id": "MDU6SXNzdWU1MzEwNzEzNzY=", "number": 66954, "title": "The lint non_uppercase_globals is triggered even in local scope. It should trigger only for global scope, or be renamed to non_uppercase_const instead.", "user": {"login": "kingparra", "id": 12241870, "node_id": "MDQ6VXNlcjEyMjQxODcw", "avatar_url": "https://avatars.githubusercontent.com/u/12241870?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kingparra", "html_url": "https://github.com/kingparra", "followers_url": "https://api.github.com/users/kingparra/followers", "following_url": "https://api.github.com/users/kingparra/following{/other_user}", "gists_url": "https://api.github.com/users/kingparra/gists{/gist_id}", "starred_url": "https://api.github.com/users/kingparra/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kingparra/subscriptions", "organizations_url": "https://api.github.com/users/kingparra/orgs", "repos_url": "https://api.github.com/users/kingparra/repos", "events_url": "https://api.github.com/users/kingparra/events{/privacy}", "received_events_url": "https://api.github.com/users/kingparra/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 234902, "node_id": "MDU6TGFiZWwyMzQ5MDI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-enhancement", "name": "C-enhancement", "color": "f5f1fd", "default": false, "description": "Category: An issue proposing an enhancement or a PR with one."}, {"id": 235137, "node_id": "MDU6TGFiZWwyMzUxMzc=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-lint", "name": "A-lint", "color": "f7e101", "default": false, "description": "Area: Lints (warnings about flaws in source code) such as unused_mut."}, {"id": 211668019, "node_id": "MDU6TGFiZWwyMTE2NjgwMTk=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-lang", "name": "T-lang", "color": "bfd4f2", "default": false, "description": "Relevant to the language team, which will review and decide on the PR/issue."}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2019-12-02T11:37:06Z", "updated_at": "2020-11-03T19:34:21Z", "closed_at": null, "author_association": "NONE", "active_lock_reason": null, "body": "The warning \"non_uppercase_globals\" occurs for all uses of const, even ones in local scope. This should be renamed to \"non_uppercase_const\", instead. \r\n\r\nI have some code like:\r\n\r\n```\r\nfn main() {\r\n  fn shadow1(f: u32) {\r\n\r\n    println!(\"f is {}\", f)\r\n    const s: u32 = 1;\r\n    println!(\"s is {}\", s);\r\n\r\n    fn shadow2(f: u32) {\r\n      println!(\"f is {}\", f);\r\n      const s: u32 = 2;\r\n      println!(\"s is {}\", s);\r\n    }\r\n    shadow2(s);\r\n\r\n  }\r\n  shadow1(8)\r\n}\r\n```\r\n\r\nIf I compile I get:\r\n\r\n```\r\n\u0192 cargo run\r\n   Compiling tp v0.1.0 (/home/chris/Downloads/tp)\r\nwarning: constant `s` should have an upper case name\r\n --> src/main.rs:5:11\r\n  |\r\n5 |     const s: u32 = 1;\r\n  |           ^ help: convert the identifier to upper case: `S`\r\n  |\r\n  = note: `#[warn(non_upper_case_globals)]` on by default\r\n\r\nwarning: constant `s` should have an upper case name\r\n  --> src/main.rs:10:13\r\n   |\r\n10 |       const s: u32 = 2;\r\n   |             ^ help: convert the identifier to upper case: `S`\r\n\r\n    Finished dev [unoptimized + debuginfo] target(s) in 0.19s\r\n     Running `target/debug/tp`\r\nf is 8\r\ns is 1\r\nf is 1\r\ns is 2\r\n```\r\n\r\nYou'll notice that const was never used directly within main(), or in any global context.\r\n\r\nUsing const within local scope is useful for decoupling implicit sequential control flow from variable assignment within that scope. This is useful for writing concurrent code, and communicating intent to the compiler so it can catch errors.\r\n\r\nIt would be great if the error non_uppercase_globals was renamed to non_uppercase_const, and non_uppercase_globals would only warn on usage of const in the global scope!", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/66954/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/66954/timeline", "performed_via_github_app": null, "state_reason": null}