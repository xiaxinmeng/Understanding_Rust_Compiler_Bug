{"url": "https://api.github.com/repos/rust-lang/rust/issues/89573", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/89573/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/89573/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/89573/events", "html_url": "https://github.com/rust-lang/rust/issues/89573", "id": 1016786860, "node_id": "I_kwDOAAsO6M48mu-s", "number": 89573, "title": "Closure vs. method reference for Fn accepting a GAT type", "user": {"login": "audunhalland", "id": 5767935, "node_id": "MDQ6VXNlcjU3Njc5MzU=", "avatar_url": "https://avatars.githubusercontent.com/u/5767935?v=4", "gravatar_id": "", "url": "https://api.github.com/users/audunhalland", "html_url": "https://github.com/audunhalland", "followers_url": "https://api.github.com/users/audunhalland/followers", "following_url": "https://api.github.com/users/audunhalland/following{/other_user}", "gists_url": "https://api.github.com/users/audunhalland/gists{/gist_id}", "starred_url": "https://api.github.com/users/audunhalland/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/audunhalland/subscriptions", "organizations_url": "https://api.github.com/users/audunhalland/orgs", "repos_url": "https://api.github.com/users/audunhalland/repos", "events_url": "https://api.github.com/users/audunhalland/events{/privacy}", "received_events_url": "https://api.github.com/users/audunhalland/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 2352122097, "node_id": "MDU6TGFiZWwyMzUyMTIyMDk3", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-discussion", "name": "C-discussion", "color": "f5f1fd", "default": false, "description": "Category: Discussion or questions that doesn't represent real issues."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2021-10-05T20:26:19Z", "updated_at": "2023-04-26T16:09:28Z", "closed_at": "2023-04-26T16:09:27Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!--\r\nThank you for filing a bug report! \ud83d\udc1b Please provide a short summary of the bug,\r\nalong with any information you feel relevant to replicating the bug.\r\n-->\r\n\r\nI tried this code:\r\n\r\n```rust\r\n#![feature(generic_associated_types)]\r\n\r\nstruct Foo(usize);\r\nstruct Bar<'s>(&'s usize);\r\n\r\nimpl<'s> Bar<'s> {\r\n    fn hello(&self) {\r\n        println!(\"Hello {}\", self.0);\r\n    }\r\n}\r\n\r\ntrait HardToGAT: 'static {\r\n    type Gat<'s>\r\n    where\r\n        Self: 's;\r\n\r\n    fn hard_to_gat(&self, func: &dyn for<'s> Fn(&Self::Gat<'s>));\r\n}\r\n\r\nimpl HardToGAT for Foo {\r\n    type Gat<'s> = Bar<'s>;\r\n\r\n    fn hard_to_gat(&self, func: &dyn for<'s> Fn(&Self::Gat<'s>)) {\r\n        let bar = Bar(&self.0);\r\n        func(&bar);\r\n    }\r\n}\r\n\r\n#[test]\r\nfn test() {\r\n    let foo = Foo(42);\r\n\r\n    // works:\r\n    foo.hard_to_gat(&|bar| {\r\n        bar.hello();\r\n    });\r\n\r\n    // doesn't:\r\n    foo.hard_to_gat(&Bar::hello);\r\n}\r\n```\r\n\r\nI expected to see this happen: It compiles!\r\n\r\nInstead, this happened: It doesn't compile, with,\r\n\r\n```\r\n  --> tests/closure2.rs:37:21\r\n   |\r\n37 |     foo.hard_to_gat(&Bar::hello);\r\n   |                     ^^^^^^^^^^^ one type is more general than the other\r\n   |\r\n   = note: expected type `for<'s> FnOnce<(&Bar<'s>,)>`\r\n              found type `for<'r> FnOnce<(&'r Bar<'_>,)>`\r\n```\r\n\r\nI think the elegancy of being able to pass a method reference would be a big plus. So I'm filing this bug report to see if this is something which can be improved upon.", "closed_by": {"login": "jyn514", "id": 23638587, "node_id": "MDQ6VXNlcjIzNjM4NTg3", "avatar_url": "https://avatars.githubusercontent.com/u/23638587?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jyn514", "html_url": "https://github.com/jyn514", "followers_url": "https://api.github.com/users/jyn514/followers", "following_url": "https://api.github.com/users/jyn514/following{/other_user}", "gists_url": "https://api.github.com/users/jyn514/gists{/gist_id}", "starred_url": "https://api.github.com/users/jyn514/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jyn514/subscriptions", "organizations_url": "https://api.github.com/users/jyn514/orgs", "repos_url": "https://api.github.com/users/jyn514/repos", "events_url": "https://api.github.com/users/jyn514/events{/privacy}", "received_events_url": "https://api.github.com/users/jyn514/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/89573/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/89573/timeline", "performed_via_github_app": null, "state_reason": "completed"}