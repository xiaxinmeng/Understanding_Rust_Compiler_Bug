{"url": "https://api.github.com/repos/rust-lang/rust/issues/42873", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/42873/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/42873/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/42873/events", "html_url": "https://github.com/rust-lang/rust/issues/42873", "id": 238292434, "node_id": "MDU6SXNzdWUyMzgyOTI0MzQ=", "number": 42873, "title": "profusion of redundant \"overruled by outer forbid\" messages", "user": {"login": "zackmdavis", "id": 1076988, "node_id": "MDQ6VXNlcjEwNzY5ODg=", "avatar_url": "https://avatars.githubusercontent.com/u/1076988?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zackmdavis", "html_url": "https://github.com/zackmdavis", "followers_url": "https://api.github.com/users/zackmdavis/followers", "following_url": "https://api.github.com/users/zackmdavis/following{/other_user}", "gists_url": "https://api.github.com/users/zackmdavis/gists{/gist_id}", "starred_url": "https://api.github.com/users/zackmdavis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zackmdavis/subscriptions", "organizations_url": "https://api.github.com/users/zackmdavis/orgs", "repos_url": "https://api.github.com/users/zackmdavis/repos", "events_url": "https://api.github.com/users/zackmdavis/events{/privacy}", "received_events_url": "https://api.github.com/users/zackmdavis/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 235137, "node_id": "MDU6TGFiZWwyMzUxMzc=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-lint", "name": "A-lint", "color": "f7e101", "default": false, "description": "Area: Lints (warnings about flaws in source code) such as unused_mut."}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2017-06-24T03:59:29Z", "updated_at": "2017-06-27T07:29:58Z", "closed_at": "2017-06-27T07:29:58Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Consider this (erroneous) program:\r\n\r\n```rust\r\n#![forbid(unused)]\r\n\r\n#[allow(unused)]\r\nfn main() {\r\n    println!(\"hello forbidden world\");\r\n}\r\n```\r\n\r\nAs we expect, this fails to compile, because the outer \"forbid\" attribute contradicts the \"allow\" attribute. (\"Forbid\" is like \"deny\" except that it prevents itself from being subsequently overridden.) However, the error messages leave something to be desired:\r\n\r\n```\r\n$ rustc --version\r\nrustc 1.18.0 (03fc9d622 2017-06-06)\r\n$ rustc scratch.rs \r\nerror[E0453]: allow(unused_imports) overruled by outer forbid(unused_imports)\r\n --> /home/ubuntu/rust/scratch.rs:3:9\r\n  |\r\n1 | #![forbid(unused)]\r\n  |           ------ `forbid` level set here\r\n2 | \r\n3 | #[allow(unused)]\r\n  |         ^^^^^^ overruled by previous forbid\r\n\r\nerror[E0453]: allow(unused_variables) overruled by outer forbid(unused_variables)\r\n --> /home/ubuntu/rust/scratch.rs:3:9\r\n  |\r\n1 | #![forbid(unused)]\r\n  |           ------ `forbid` level set here\r\n2 | \r\n3 | #[allow(unused)]\r\n  |         ^^^^^^ overruled by previous forbid\r\n\r\nerror[E0453]: allow(unused_assignments) overruled by outer forbid(unused_assignments)\r\n --> /home/ubuntu/rust/scratch.rs:3:9\r\n  |\r\n1 | #![forbid(unused)]\r\n  |           ------ `forbid` level set here\r\n2 | \r\n3 | #[allow(unused)]\r\n  |         ^^^^^^ overruled by previous forbid\r\n\r\nerror[E0453]: allow(dead_code) overruled by outer forbid(dead_code)\r\n --> /home/ubuntu/rust/scratch.rs:3:9\r\n  |\r\n1 | #![forbid(unused)]\r\n  |           ------ `forbid` level set here\r\n2 | \r\n3 | #[allow(unused)]\r\n  |         ^^^^^^ overruled by previous forbid\r\n\r\nerror[E0453]: allow(unused_mut) overruled by outer forbid(unused_mut)\r\n --> /home/ubuntu/rust/scratch.rs:3:9\r\n  |\r\n1 | #![forbid(unused)]\r\n  |           ------ `forbid` level set here\r\n2 | \r\n3 | #[allow(unused)]\r\n  |         ^^^^^^ overruled by previous forbid\r\n\r\nerror[E0453]: allow(unreachable_code) overruled by outer forbid(unreachable_code)\r\n --> /home/ubuntu/rust/scratch.rs:3:9\r\n  |\r\n1 | #![forbid(unused)]\r\n  |           ------ `forbid` level set here\r\n2 | \r\n3 | #[allow(unused)]\r\n  |         ^^^^^^ overruled by previous forbid\r\n\r\nerror[E0453]: allow(unreachable_patterns) overruled by outer forbid(unreachable_patterns)\r\n --> /home/ubuntu/rust/scratch.rs:3:9\r\n  |\r\n1 | #![forbid(unused)]\r\n  |           ------ `forbid` level set here\r\n2 | \r\n3 | #[allow(unused)]\r\n  |         ^^^^^^ overruled by previous forbid\r\n\r\nerror[E0453]: allow(unused_must_use) overruled by outer forbid(unused_must_use)\r\n --> /home/ubuntu/rust/scratch.rs:3:9\r\n  |\r\n1 | #![forbid(unused)]\r\n  |           ------ `forbid` level set here\r\n2 | \r\n3 | #[allow(unused)]\r\n  |         ^^^^^^ overruled by previous forbid\r\n\r\nerror[E0453]: allow(unused_unsafe) overruled by outer forbid(unused_unsafe)\r\n --> /home/ubuntu/rust/scratch.rs:3:9\r\n  |\r\n1 | #![forbid(unused)]\r\n  |           ------ `forbid` level set here\r\n2 | \r\n3 | #[allow(unused)]\r\n  |         ^^^^^^ overruled by previous forbid\r\n\r\nerror[E0453]: allow(path_statements) overruled by outer forbid(path_statements)\r\n --> /home/ubuntu/rust/scratch.rs:3:9\r\n  |\r\n1 | #![forbid(unused)]\r\n  |           ------ `forbid` level set here\r\n2 | \r\n3 | #[allow(unused)]\r\n  |         ^^^^^^ overruled by previous forbid\r\n\r\nerror[E0453]: allow(unused_attributes) overruled by outer forbid(unused_attributes)\r\n --> /home/ubuntu/rust/scratch.rs:3:9\r\n  |\r\n1 | #![forbid(unused)]\r\n  |           ------ `forbid` level set here\r\n2 | \r\n3 | #[allow(unused)]\r\n  |         ^^^^^^ overruled by previous forbid\r\n\r\nerror: aborting due to 11 previous errors\r\n```\r\n\r\nWe get a separate error for each lint in the \"unused\" lint group! This is kind of terrible! We would prefer to get a single error for the contradicting attributes, whose message names the offending attributes (it's weird to say \"overruled by outer forbid(path_statements)\", when the outer forbid is for _unused_, not _path_statements_).\r\n\r\nA fix by the present author is forthcoming.", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/42873/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/42873/timeline", "performed_via_github_app": null, "state_reason": "completed"}