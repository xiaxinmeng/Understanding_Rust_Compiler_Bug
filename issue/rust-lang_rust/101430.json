{"url": "https://api.github.com/repos/rust-lang/rust/issues/101430", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/101430/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/101430/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/101430/events", "html_url": "https://github.com/rust-lang/rust/issues/101430", "id": 1361404972, "node_id": "I_kwDOAAsO6M5RJWQs", "number": 101430, "title": "rustc nightly(289279de1 2022-09-04) ICE for tokio+warp ", "user": {"login": "kurikomoe", "id": 31176859, "node_id": "MDQ6VXNlcjMxMTc2ODU5", "avatar_url": "https://avatars.githubusercontent.com/u/31176859?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kurikomoe", "html_url": "https://github.com/kurikomoe", "followers_url": "https://api.github.com/users/kurikomoe/followers", "following_url": "https://api.github.com/users/kurikomoe/following{/other_user}", "gists_url": "https://api.github.com/users/kurikomoe/gists{/gist_id}", "starred_url": "https://api.github.com/users/kurikomoe/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kurikomoe/subscriptions", "organizations_url": "https://api.github.com/users/kurikomoe/orgs", "repos_url": "https://api.github.com/users/kurikomoe/repos", "events_url": "https://api.github.com/users/kurikomoe/events{/privacy}", "received_events_url": "https://api.github.com/users/kurikomoe/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}, {"id": 2504090242, "node_id": "MDU6TGFiZWwyNTA0MDkwMjQy", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-mir-validate", "name": "A-mir-validate", "color": "f7e101", "default": false, "description": "Area: MIR validator (-Z validate-mir)"}], "state": "closed", "locked": false, "assignee": {"login": "compiler-errors", "id": 3674314, "node_id": "MDQ6VXNlcjM2NzQzMTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3674314?v=4", "gravatar_id": "", "url": "https://api.github.com/users/compiler-errors", "html_url": "https://github.com/compiler-errors", "followers_url": "https://api.github.com/users/compiler-errors/followers", "following_url": "https://api.github.com/users/compiler-errors/following{/other_user}", "gists_url": "https://api.github.com/users/compiler-errors/gists{/gist_id}", "starred_url": "https://api.github.com/users/compiler-errors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/compiler-errors/subscriptions", "organizations_url": "https://api.github.com/users/compiler-errors/orgs", "repos_url": "https://api.github.com/users/compiler-errors/repos", "events_url": "https://api.github.com/users/compiler-errors/events{/privacy}", "received_events_url": "https://api.github.com/users/compiler-errors/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "compiler-errors", "id": 3674314, "node_id": "MDQ6VXNlcjM2NzQzMTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3674314?v=4", "gravatar_id": "", "url": "https://api.github.com/users/compiler-errors", "html_url": "https://github.com/compiler-errors", "followers_url": "https://api.github.com/users/compiler-errors/followers", "following_url": "https://api.github.com/users/compiler-errors/following{/other_user}", "gists_url": "https://api.github.com/users/compiler-errors/gists{/gist_id}", "starred_url": "https://api.github.com/users/compiler-errors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/compiler-errors/subscriptions", "organizations_url": "https://api.github.com/users/compiler-errors/orgs", "repos_url": "https://api.github.com/users/compiler-errors/repos", "events_url": "https://api.github.com/users/compiler-errors/events{/privacy}", "received_events_url": "https://api.github.com/users/compiler-errors/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2022-09-05T04:51:33Z", "updated_at": "2022-09-10T15:12:28Z", "closed_at": "2022-09-10T15:12:28Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!--\r\nThank you for finding an Internal Compiler Error! \ud83e\uddca  If possible, try to provide\r\na minimal verifiable example. You can read \"Rust Bug Minimization Patterns\" for\r\nhow to create smaller examples.\r\n\r\nhttp://blog.pnkfx.org/blog/2019/11/18/rust-bug-minimization-patterns/\r\n\r\n-->\r\n\r\n### Code\r\n\r\n```Rust\r\nuse std::{net::SocketAddr, str::FromStr};\r\nuse warp::Filter;\r\n\r\n#[tokio::main(flavor=\"current_thread\")]\r\nasync fn main() {\r\n    let routes = warp::any().and(warp::method()).map(|_| \"Bad!\");\r\n\r\n    warp::serve(routes)\r\n        .run(SocketAddr::from_str(\"0.0.0.0:1235\").unwrap())\r\n        .await;\r\n}\r\n```\r\n\r\n\r\n### Meta\r\n<!--\r\nIf you're using the stable version of the compiler, you should also check if the\r\nbug also exists in the beta or nightly versions.\r\n-->\r\n\r\n`rustc --version --verbose`:\r\n```\r\nrustc 1.65.0-nightly (289279de1 2022-09-04)\r\nbinary: rustc\r\ncommit-hash: 289279de116707f28cf9c18e4bbb8c6ec84ad75b\r\ncommit-date: 2022-09-04\r\nhost: x86_64-unknown-linux-gnu\r\nrelease: 1.65.0-nightly\r\nLLVM version: 15.0.0\r\n```\r\n\r\n### Error output\r\n\r\n```\r\nwarning: Error finalizing incremental compilation session directory `/tmp/tt/target/debug/incremental/tt-1sm7b9is0mgyd/s-gd96hsttt7-8esluo-working`: No such file or directory (os error 2)\r\n\r\nerror: internal compiler error: no errors encountered even though `delay_span_bug` issued\r\n\r\n[Too long omitted]\r\n```\r\n> More output in details.\r\n\r\n<!--\r\nInclude a backtrace in the code block by setting `RUST_BACKTRACE=1` in your\r\nenvironment. E.g. `RUST_BACKTRACE=1 cargo build`.\r\n-->\r\n<details><summary><strong>Backtrace</strong></summary>\r\n<p>\r\n\r\n```\r\n \u279c  tt (master) \u2717 rm target -rf                                                                                                  \r\n \u279c  tt (master) \u2717 cargo clean                                                                                                   \r\n \u279c  tt (master) \u2717 RUST_BACKTRACE=full cargo build                                                           \r\n   Compiling cfg-if v1.0.0\r\n   Compiling version_check v0.9.4\r\n   Compiling libc v0.2.132\r\n   Compiling proc-macro2 v1.0.43\r\n   Compiling autocfg v1.1.0\r\n   Compiling unicode-ident v1.0.3\r\n   Compiling quote v1.0.21\r\n   Compiling syn v1.0.99\r\n   Compiling log v0.4.17\r\n   Compiling typenum v1.15.0\r\n   Compiling bytes v1.2.1\r\n   Compiling memchr v2.5.0\r\n   Compiling futures-core v0.3.24\r\n   Compiling pin-project-lite v0.2.9\r\n   Compiling itoa v1.0.3\r\n   Compiling once_cell v1.14.0\r\n   Compiling fnv v1.0.7\r\n   Compiling futures-sink v0.3.24\r\n   Compiling tinyvec_macros v0.1.0\r\n   Compiling futures-task v0.3.24\r\n   Compiling matches v0.1.9\r\n   Compiling httparse v1.8.0\r\n   Compiling futures-util v0.3.24\r\n   Compiling ppv-lite86 v0.2.16\r\n   Compiling cpufeatures v0.2.5\r\n   Compiling percent-encoding v2.1.0\r\n   Compiling pin-utils v0.1.0\r\n   Compiling serde v1.0.144\r\n   Compiling unicode-bidi v0.3.8\r\n   Compiling mime v0.3.16\r\n   Compiling futures-channel v0.3.24\r\n   Compiling base64 v0.13.0\r\n   Compiling hashbrown v0.12.3\r\n   Compiling opaque-debug v0.3.0\r\n   Compiling fastrand v1.8.0\r\n   Compiling httpdate v1.0.2\r\n   Compiling remove_dir_all v0.5.3\r\n   Compiling try-lock v0.2.3\r\n   Compiling safemem v0.3.3\r\n   Compiling ryu v1.0.11\r\n   Compiling byteorder v1.4.3\r\n   Compiling serde_json v1.0.85\r\n   Compiling utf-8 v0.7.6\r\n   Compiling bitflags v1.3.2\r\n   Compiling quick-error v1.2.3\r\n   Compiling tower-service v0.3.2\r\n   Compiling scoped-tls v1.0.0\r\n   Compiling tinyvec v1.6.0\r\n   Compiling form_urlencoded v1.0.1\r\n   Compiling tracing-core v0.1.29\r\n   Compiling http v0.2.8\r\n   Compiling generic-array v0.14.6\r\n   Compiling unicase v2.6.0\r\n   Compiling tokio v1.21.0\r\n   Compiling slab v0.4.7\r\n   Compiling indexmap v1.9.1\r\n   Compiling want v0.3.0\r\n   Compiling tracing v0.1.36\r\n   Compiling twoway v0.1.8\r\n   Compiling buf_redux v0.8.4\r\n   Compiling mime_guess v2.0.4\r\n   Compiling mio v0.8.4\r\n   Compiling socket2 v0.4.7\r\n   Compiling getrandom v0.2.7\r\n   Compiling tempfile v3.3.0\r\n   Compiling unicode-normalization v0.1.21\r\n   Compiling headers-core v0.2.0\r\n   Compiling http-body v0.4.5\r\n   Compiling rand_core v0.6.3\r\n   Compiling rand_chacha v0.3.1\r\n   Compiling rand v0.8.5\r\n   Compiling idna v0.2.3\r\n   Compiling block-buffer v0.9.0\r\n   Compiling block-buffer v0.10.3\r\n   Compiling crypto-common v0.1.6\r\n   Compiling digest v0.9.0\r\n   Compiling digest v0.10.3\r\n   Compiling sha-1 v0.9.8\r\n   Compiling url v2.2.2\r\n   Compiling sha1 v0.10.4\r\n   Compiling headers v0.3.8\r\n   Compiling multipart v0.18.0\r\n   Compiling serde_urlencoded v0.7.1\r\n   Compiling tokio-macros v1.8.0\r\n   Compiling thiserror-impl v1.0.34\r\n   Compiling pin-project-internal v1.0.12\r\n   Compiling pin-project v1.0.12\r\n   Compiling thiserror v1.0.34\r\n   Compiling tungstenite v0.14.0\r\n   Compiling tokio-util v0.7.3\r\n   Compiling tokio-stream v0.1.9\r\n   Compiling tokio-util v0.6.10\r\n   Compiling tokio-tungstenite v0.15.0\r\n   Compiling h2 v0.3.14\r\n   Compiling hyper v0.14.20\r\n   Compiling warp v0.3.2\r\n   Compiling tt v0.1.0 (/tmp/tt)\r\nwarning: Error finalizing incremental compilation session directory `/tmp/tt/target/debug/incremental/tt-1sm7b9is0mgyd/s-gd96hsttt7-8esluo-working`: No such file or directory (os error 2)\r\n\r\nerror: internal compiler error: no errors encountered even though `delay_span_bug` issued\r\n\r\nerror: internal compiler error: broken MIR in DropGlue(DefId(2:2776 ~ core[78f6]::ptr::drop_in_place), Some(warp::hyper::server::server::new_svc::State<warp::hyper::server::conn::AddrStream, futures_util::future::ready::Ready<std::result::Result<warp::hyper::service::util::ServiceFn<[closure@warp::Server<warp::filter::map::Map<warp::filter::and::And<warp::filters::any::Any, warp::filter::FilterFn<[closure@warp::filter::filter_fn_one<[closure@warp::method::{closure#0}], futures_util::future::ready::Ready<std::result::Result<warp::http::Method, std::convert::Infallible>>>::{closure#0}]>>, [closure@src/main.rs:6:54: 6:57]>>::bind_ephemeral<std::net::SocketAddr>::{closure#1}::{closure#0}::{closure#0}], warp::hyper::Body>, std::convert::Infallible>>, warp::hyper::service::util::ServiceFn<[closure@warp::Server<warp::filter::map::Map<warp::filter::and::And<warp::filters::any::Any, warp::filter::FilterFn<[closure@warp::filter::filter_fn_one<[closure@warp::method::{closure#0}], futures_util::future::ready::Ready<std::result::Result<warp::http::Method, std::convert::Infallible>>>::{closure#0}]>>, [closure@src/main.rs:6:54: 6:57]>>::bind_ephemeral<std::net::SocketAddr>::{closure#1}::{closure#0}::{closure#0}], warp::hyper::Body>, warp::hyper::common::exec::Exec, warp::hyper::server::server::NoopWatcher>)) (after pass PhaseChange-Runtime(Optimized)) at bb3[0]:\r\n                                Field projection `((*_1) as Connected).field[0]` specified type `warp::hyper::server::conn::upgrades::UpgradeableConnection<warp::hyper::server::conn::AddrStream, warp::hyper::service::util::ServiceFn<[closure@warp::Server<warp::filter::map::Map<warp::filter::and::And<warp::filters::any::Any, warp::filter::FilterFn<[closure@warp::filter::filter_fn_one<[closure@warp::method::{closure#0}], futures_util::future::ready::Ready<std::result::Result<warp::http::Method, std::convert::Infallible>>>::{closure#0}]>>, [closure@src/main.rs:6:54: 6:57]>>::bind_ephemeral<std::net::SocketAddr>::{closure#1}::{closure#0}::{closure#0}], warp::hyper::Body>, warp::hyper::common::exec::Exec>`, but actual type is <warp::hyper::server::server::NoopWatcher as warp::hyper::server::server::Watcher<warp::hyper::server::conn::AddrStream, warp::hyper::service::util::ServiceFn<[closure@warp::Server<warp::filter::map::Map<warp::filter::and::And<warp::filters::any::Any, warp::filter::FilterFn<[closure@warp::filter::filter_fn_one<[closure@warp::method::{closure#0}], futures_util::future::ready::Ready<std::result::Result<warp::http::Method, std::convert::Infallible>>>::{closure#0}]>>, [closure@src/main.rs:6:54: 6:57]>>::bind_ephemeral<std::net::SocketAddr>::{closure#1}::{closure#0}::{closure#0}], warp::hyper::Body>, warp::hyper::common::exec::Exec>>::Future\r\n   --> /home/kuriko/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:487:1\r\n    |\r\n487 | pub unsafe fn drop_in_place<T: ?Sized>(to_drop: *mut T) {\r\n    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n    |\r\n    = note: delayed at compiler/rustc_const_eval/src/transform/validate.rs:127:36\r\n\r\nerror: internal compiler error: broken MIR in DropGlue(DefId(2:2776 ~ core[78f6]::ptr::drop_in_place), Some(tokio::runtime::task::core::Stage<std::pin::Pin<std::boxed::Box<warp::hyper::server::server::new_svc::NewSvcTask<warp::hyper::server::conn::AddrStream, futures_util::future::ready::Ready<std::result::Result<warp::hyper::service::util::ServiceFn<[closure@warp::Server<warp::filter::map::Map<warp::filter::and::And<warp::filters::any::Any, warp::filter::FilterFn<[closure@warp::filter::filter_fn_one<[closure@warp::method::{closure#0}], futures_util::future::ready::Ready<std::result::Result<warp::http::Method, std::convert::Infallible>>>::{closure#0}]>>, [closure@src/main.rs:6:54: 6:57]>>::bind_ephemeral<std::net::SocketAddr>::{closure#1}::{closure#0}::{closure#0}], warp::hyper::Body>, std::convert::Infallible>>, warp::hyper::service::util::ServiceFn<[closure@warp::Server<warp::filter::map::Map<warp::filter::and::And<warp::filters::any::Any, warp::filter::FilterFn<[closure@warp::filter::filter_fn_one<[closure@warp::method::{closure#0}], futures_util::future::ready::Ready<std::result::Result<warp::http::Method, std::convert::Infallible>>>::{closure#0}]>>, [closure@src/main.rs:6:54: 6:57]>>::bind_ephemeral<std::net::SocketAddr>::{closure#1}::{closure#0}::{closure#0}], warp::hyper::Body>, warp::hyper::common::exec::Exec, warp::hyper::server::server::NoopWatcher>>>>)) (after pass PhaseChange-Runtime(Optimized)) at bb3[0]:\r\n                                Field projection `((*_1) as Finished).field[0]` specified type `std::result::Result<(), tokio::task::JoinError>`, but actual type is std::result::Result<<std::pin::Pin<std::boxed::Box<warp::hyper::server::server::new_svc::NewSvcTask<warp::hyper::server::conn::AddrStream, futures_util::future::ready::Ready<std::result::Result<warp::hyper::service::util::ServiceFn<[closure@warp::Server<warp::filter::map::Map<warp::filter::and::And<warp::filters::any::Any, warp::filter::FilterFn<[closure@warp::filter::filter_fn_one<[closure@warp::method::{closure#0}], futures_util::future::ready::Ready<std::result::Result<warp::http::Method, std::convert::Infallible>>>::{closure#0}]>>, [closure@src/main.rs:6:54: 6:57]>>::bind_ephemeral<std::net::SocketAddr>::{closure#1}::{closure#0}::{closure#0}], warp::hyper::Body>, std::convert::Infallible>>, warp::hyper::service::util::ServiceFn<[closure@warp::Server<warp::filter::map::Map<warp::filter::and::And<warp::filters::any::Any, warp::filter::FilterFn<[closure@warp::filter::filter_fn_one<[closure@warp::method::{closure#0}], futures_util::future::ready::Ready<std::result::Result<warp::http::Method, std::convert::Infallible>>>::{closure#0}]>>, [closure@src/main.rs:6:54: 6:57]>>::bind_ephemeral<std::net::SocketAddr>::{closure#1}::{closure#0}::{closure#0}], warp::hyper::Body>, warp::hyper::common::exec::Exec, warp::hyper::server::server::NoopWatcher>>> as warp::Future>::Output, tokio::task::JoinError>\r\n   --> /home/kuriko/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:487:1\r\n    |\r\n487 | pub unsafe fn drop_in_place<T: ?Sized>(to_drop: *mut T) {\r\n    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n    |\r\n    = note: delayed at compiler/rustc_const_eval/src/transform/validate.rs:127:36\r\n\r\nerror: internal compiler error: broken MIR in DropGlue(DefId(2:2776 ~ core[78f6]::ptr::drop_in_place), Some(tokio::runtime::task::core::Stage<warp::hyper::server::server::new_svc::NewSvcTask<warp::hyper::server::conn::AddrStream, futures_util::future::ready::Ready<std::result::Result<warp::hyper::service::util::ServiceFn<[closure@warp::Server<warp::filter::map::Map<warp::filter::and::And<warp::filters::any::Any, warp::filter::FilterFn<[closure@warp::filter::filter_fn_one<[closure@warp::method::{closure#0}], futures_util::future::ready::Ready<std::result::Result<warp::http::Method, std::convert::Infallible>>>::{closure#0}]>>, [closure@src/main.rs:6:54: 6:57]>>::bind_ephemeral<std::net::SocketAddr>::{closure#1}::{closure#0}::{closure#0}], warp::hyper::Body>, std::convert::Infallible>>, warp::hyper::service::util::ServiceFn<[closure@warp::Server<warp::filter::map::Map<warp::filter::and::And<warp::filters::any::Any, warp::filter::FilterFn<[closure@warp::filter::filter_fn_one<[closure@warp::method::{closure#0}], futures_util::future::ready::Ready<std::result::Result<warp::http::Method, std::convert::Infallible>>>::{closure#0}]>>, [closure@src/main.rs:6:54: 6:57]>>::bind_ephemeral<std::net::SocketAddr>::{closure#1}::{closure#0}::{closure#0}], warp::hyper::Body>, warp::hyper::common::exec::Exec, warp::hyper::server::server::NoopWatcher>>)) (after pass PhaseChange-Runtime(Optimized)) at bb3[0]:\r\n                                Field projection `((*_1) as Finished).field[0]` specified type `std::result::Result<(), tokio::task::JoinError>`, but actual type is std::result::Result<<warp::hyper::server::server::new_svc::NewSvcTask<warp::hyper::server::conn::AddrStream, futures_util::future::ready::Ready<std::result::Result<warp::hyper::service::util::ServiceFn<[closure@warp::Server<warp::filter::map::Map<warp::filter::and::And<warp::filters::any::Any, warp::filter::FilterFn<[closure@warp::filter::filter_fn_one<[closure@warp::method::{closure#0}], futures_util::future::ready::Ready<std::result::Result<warp::http::Method, std::convert::Infallible>>>::{closure#0}]>>, [closure@src/main.rs:6:54: 6:57]>>::bind_ephemeral<std::net::SocketAddr>::{closure#1}::{closure#0}::{closure#0}], warp::hyper::Body>, std::convert::Infallible>>, warp::hyper::service::util::ServiceFn<[closure@warp::Server<warp::filter::map::Map<warp::filter::and::And<warp::filters::any::Any, warp::filter::FilterFn<[closure@warp::filter::filter_fn_one<[closure@warp::method::{closure#0}], futures_util::future::ready::Ready<std::result::Result<warp::http::Method, std::convert::Infallible>>>::{closure#0}]>>, [closure@src/main.rs:6:54: 6:57]>>::bind_ephemeral<std::net::SocketAddr>::{closure#1}::{closure#0}::{closure#0}], warp::hyper::Body>, warp::hyper::common::exec::Exec, warp::hyper::server::server::NoopWatcher> as warp::Future>::Output, tokio::task::JoinError>\r\n   --> /home/kuriko/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:487:1\r\n    |\r\n487 | pub unsafe fn drop_in_place<T: ?Sized>(to_drop: *mut T) {\r\n    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n    |\r\n    = note: delayed at compiler/rustc_const_eval/src/transform/validate.rs:127:36\r\n\r\nthread 'rustc' panicked at 'Box<dyn Any>', compiler/rustc_errors/src/lib.rs:1499:13\r\nstack backtrace:\r\n   0:     0x7f9dca36e550 - std::backtrace_rs::backtrace::libunwind::trace::h45c0d8f2a3efd3fc\r\n                               at /rustc/289279de116707f28cf9c18e4bbb8c6ec84ad75b/library/std/src/../../backtrace/src/backtrace/mod.rs:66:5\r\n   1:     0x7f9dca36e550 - std::backtrace_rs::backtrace::trace_unsynchronized::h1af898a7be122d7c\r\n                               at /rustc/289279de116707f28cf9c18e4bbb8c6ec84ad75b/library/std/src/../../backtrace/src/backtrace/mod.rs:66:5\r\n   2:     0x7f9dca36e550 - std::sys_common::backtrace::_print_fmt::h12b8e189b53007a3\r\n                               at /rustc/289279de116707f28cf9c18e4bbb8c6ec84ad75b/library/std/src/sys_common/backtrace.rs:66:5\r\n   3:     0x7f9dca36e550 - <std::sys_common::backtrace::_print::DisplayBacktrace as core::fmt::Display>::fmt::h19fdde6125f880f1\r\n                               at /rustc/289279de116707f28cf9c18e4bbb8c6ec84ad75b/library/std/src/sys_common/backtrace.rs:45:22\r\n   4:     0x7f9dca3c93ae - core::fmt::write::h87d76462b828a5e9\r\n                               at /rustc/289279de116707f28cf9c18e4bbb8c6ec84ad75b/library/core/src/fmt/mod.rs:1202:17\r\n   5:     0x7f9dca35f025 - std::io::Write::write_fmt::h79f438822fd229a7\r\n                               at /rustc/289279de116707f28cf9c18e4bbb8c6ec84ad75b/library/std/src/io/mod.rs:1679:15\r\n   6:     0x7f9dca3711e3 - std::sys_common::backtrace::_print::hcf51bd38c78b3489\r\n                               at /rustc/289279de116707f28cf9c18e4bbb8c6ec84ad75b/library/std/src/sys_common/backtrace.rs:48:5\r\n   7:     0x7f9dca3711e3 - std::sys_common::backtrace::print::h7a7876706a338e2d\r\n                               at /rustc/289279de116707f28cf9c18e4bbb8c6ec84ad75b/library/std/src/sys_common/backtrace.rs:35:9\r\n   8:     0x7f9dca3711e3 - std::panicking::default_hook::{{closure}}::hf0aac8164135f1e4\r\n                               at /rustc/289279de116707f28cf9c18e4bbb8c6ec84ad75b/library/std/src/panicking.rs:295:22\r\n   9:     0x7f9dca370ecf - std::panicking::default_hook::h091bc9fde9243abc\r\n                               at /rustc/289279de116707f28cf9c18e4bbb8c6ec84ad75b/library/std/src/panicking.rs:314:9\r\n  10:     0x7f9dccc114f1 - rustc_driver[ba0efae8ac9b0cb4]::DEFAULT_HOOK::{closure#0}::{closure#0}\r\n  11:     0x7f9dca371a1d - std::panicking::rust_panic_with_hook::h41b91ebde4ccdd6b\r\n                               at /rustc/289279de116707f28cf9c18e4bbb8c6ec84ad75b/library/std/src/panicking.rs:702:17\r\n  12:     0x7f9dcdd07621 - std[d0f8dfc92007bd40]::panicking::begin_panic::<rustc_errors[7a3a423a600a9a62]::ExplicitBug>::{closure#0}\r\n  13:     0x7f9dcdd06226 - std[d0f8dfc92007bd40]::sys_common::backtrace::__rust_end_short_backtrace::<std[d0f8dfc92007bd40]::panicking::begin_panic<rustc_errors[7a3a423a600a9a62]::ExplicitBug>::{closure#0}, !>\r\n  14:     0x7f9dcdd00dc6 - std[d0f8dfc92007bd40]::panicking::begin_panic::<rustc_errors[7a3a423a600a9a62]::ExplicitBug>\r\n  15:     0x7f9dcdd03806 - std[d0f8dfc92007bd40]::panic::panic_any::<rustc_errors[7a3a423a600a9a62]::ExplicitBug>\r\n  16:     0x7f9dcc713788 - <rustc_errors[7a3a423a600a9a62]::HandlerInner as core[78f6cf7786ffa570]::ops::drop::Drop>::drop\r\n  17:     0x7f9dcba58128 - core[78f6cf7786ffa570]::ptr::drop_in_place::<rustc_session[8778dd42c9811aa]::parse::ParseSess>\r\n  18:     0x7f9dcba12228 - <alloc[aee8757f0a292e1e]::rc::Rc<rustc_session[8778dd42c9811aa]::session::Session> as core[78f6cf7786ffa570]::ops::drop::Drop>::drop\r\n  19:     0x7f9dcba115dd - core[78f6cf7786ffa570]::ptr::drop_in_place::<rustc_interface[474016745a1528b5]::interface::Compiler>\r\n  20:     0x7f9dcba10d59 - rustc_span[34c928a1a80ed6f2]::with_source_map::<core[78f6cf7786ffa570]::result::Result<(), rustc_errors[7a3a423a600a9a62]::ErrorGuaranteed>, rustc_interface[474016745a1528b5]::interface::create_compiler_and_run<core[78f6cf7786ffa570]::result::Result<(), rustc_errors[7a3a423a600a9a62]::ErrorGuaranteed>, rustc_driver[ba0efae8ac9b0cb4]::run_compiler::{closure#1}>::{closure#1}>\r\n  21:     0x7f9dcba10592 - rustc_interface[474016745a1528b5]::interface::create_compiler_and_run::<core[78f6cf7786ffa570]::result::Result<(), rustc_errors[7a3a423a600a9a62]::ErrorGuaranteed>, rustc_driver[ba0efae8ac9b0cb4]::run_compiler::{closure#1}>\r\n  22:     0x7f9dcba0f1e1 - <scoped_tls[77b2f8af8fdae259]::ScopedKey<rustc_span[34c928a1a80ed6f2]::SessionGlobals>>::set::<rustc_interface[474016745a1528b5]::interface::run_compiler<core[78f6cf7786ffa570]::result::Result<(), rustc_errors[7a3a423a600a9a62]::ErrorGuaranteed>, rustc_driver[ba0efae8ac9b0cb4]::run_compiler::{closure#1}>::{closure#0}, core[78f6cf7786ffa570]::result::Result<(), rustc_errors[7a3a423a600a9a62]::ErrorGuaranteed>>\r\n  23:     0x7f9dcba0eecf - std[d0f8dfc92007bd40]::sys_common::backtrace::__rust_begin_short_backtrace::<rustc_interface[474016745a1528b5]::util::run_in_thread_pool_with_globals<rustc_interface[474016745a1528b5]::interface::run_compiler<core[78f6cf7786ffa570]::result::Result<(), rustc_errors[7a3a423a600a9a62]::ErrorGuaranteed>, rustc_driver[ba0efae8ac9b0cb4]::run_compiler::{closure#1}>::{closure#0}, core[78f6cf7786ffa570]::result::Result<(), rustc_errors[7a3a423a600a9a62]::ErrorGuaranteed>>::{closure#0}, core[78f6cf7786ffa570]::result::Result<(), rustc_errors[7a3a423a600a9a62]::ErrorGuaranteed>>\r\n  24:     0x7f9dcca28609 - <<std[d0f8dfc92007bd40]::thread::Builder>::spawn_unchecked_<rustc_interface[474016745a1528b5]::util::run_in_thread_pool_with_globals<rustc_interface[474016745a1528b5]::interface::run_compiler<core[78f6cf7786ffa570]::result::Result<(), rustc_errors[7a3a423a600a9a62]::ErrorGuaranteed>, rustc_driver[ba0efae8ac9b0cb4]::run_compiler::{closure#1}>::{closure#0}, core[78f6cf7786ffa570]::result::Result<(), rustc_errors[7a3a423a600a9a62]::ErrorGuaranteed>>::{closure#0}, core[78f6cf7786ffa570]::result::Result<(), rustc_errors[7a3a423a600a9a62]::ErrorGuaranteed>>::{closure#1} as core[78f6cf7786ffa570]::ops::function::FnOnce<()>>::call_once::{shim:vtable#0}\r\n  25:     0x7f9dca37b873 - <alloc::boxed::Box<F,A> as core::ops::function::FnOnce<Args>>::call_once::heb3010a7b6c46c17\r\n                               at /rustc/289279de116707f28cf9c18e4bbb8c6ec84ad75b/library/alloc/src/boxed.rs:1940:9\r\n  26:     0x7f9dca37b873 - <alloc::boxed::Box<F,A> as core::ops::function::FnOnce<Args>>::call_once::h3026e81a22e09adb\r\n                               at /rustc/289279de116707f28cf9c18e4bbb8c6ec84ad75b/library/alloc/src/boxed.rs:1940:9\r\n  27:     0x7f9dca37b873 - std::sys::unix::thread::Thread::new::thread_start::h411b8aa6ee1c0765\r\n                               at /rustc/289279de116707f28cf9c18e4bbb8c6ec84ad75b/library/std/src/sys/unix/thread.rs:108:17\r\n  28:     0x7f9dca11d78d - <unknown>\r\n  29:     0x7f9dca19e8e4 - clone\r\n  30:                0x0 - <unknown>\r\n\r\nnote: the compiler unexpectedly panicked. this is a bug.\r\n\r\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/issues/new?labels=C-bug%2C+I-ICE%2C+T-compiler&template=ice.md\r\n\r\nnote: rustc 1.65.0-nightly (289279de1 2022-09-04) running on x86_64-unknown-linux-gnu\r\n\r\nnote: compiler flags: --crate-type bin -C embed-bitcode=no -C debuginfo=2 -C incremental\r\n\r\nnote: some of the compiler flags provided by cargo are hidden\r\n\r\nquery stack during panic:\r\nend of query stack\r\nwarning: `tt` (bin \"tt\") generated 1 warning\r\nerror: could not compile `tt`; 1 warning emitted\r\n```\r\n\r\n</p>\r\n</details>\r\n\r\n\r\n### Cargo.toml\r\n\r\n```toml\r\n[package]\r\nname = \"tt\"\r\nversion = \"0.1.0\"\r\nedition = \"2021\"\r\n\r\n# See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html\r\n\r\n[dependencies]\r\ntokio = { version = \"1.21.0\", features = [\"macros\"] }\r\nwarp = \"0.3.2\"\r\n```\r\n\r\nI reproduced this on my Manjaro `Amd 5900x` PC as well as centos 7 `Intel(R) Xeon(R) Gold 6230 CPU` server\r\n\r\nstable rustc is ok\r\n```\r\nrustc 1.63.0 (4b91a6ea7 2022-08-08)\r\nbinary: rustc\r\ncommit-hash: 4b91a6ea7258a947e59c6522cd5898e7c0a6a88f\r\ncommit-date: 2022-08-08\r\nhost: x86_64-unknown-linux-gnu\r\nrelease: 1.63.0\r\nLLVM version: 14.0.5\r\n```", "closed_by": {"login": "kurikomoe", "id": 31176859, "node_id": "MDQ6VXNlcjMxMTc2ODU5", "avatar_url": "https://avatars.githubusercontent.com/u/31176859?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kurikomoe", "html_url": "https://github.com/kurikomoe", "followers_url": "https://api.github.com/users/kurikomoe/followers", "following_url": "https://api.github.com/users/kurikomoe/following{/other_user}", "gists_url": "https://api.github.com/users/kurikomoe/gists{/gist_id}", "starred_url": "https://api.github.com/users/kurikomoe/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kurikomoe/subscriptions", "organizations_url": "https://api.github.com/users/kurikomoe/orgs", "repos_url": "https://api.github.com/users/kurikomoe/repos", "events_url": "https://api.github.com/users/kurikomoe/events{/privacy}", "received_events_url": "https://api.github.com/users/kurikomoe/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/101430/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/101430/timeline", "performed_via_github_app": null, "state_reason": "completed"}