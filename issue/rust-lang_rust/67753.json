{"url": "https://api.github.com/repos/rust-lang/rust/issues/67753", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/67753/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/67753/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/67753/events", "html_url": "https://github.com/rust-lang/rust/issues/67753", "id": 544184840, "node_id": "MDU6SXNzdWU1NDQxODQ4NDA=", "number": 67753, "title": "Fn traits with array args no longer work with const_generics enabled", "user": {"login": "Manishearth", "id": 1617736, "node_id": "MDQ6VXNlcjE2MTc3MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/1617736?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Manishearth", "html_url": "https://github.com/Manishearth", "followers_url": "https://api.github.com/users/Manishearth/followers", "following_url": "https://api.github.com/users/Manishearth/following{/other_user}", "gists_url": "https://api.github.com/users/Manishearth/gists{/gist_id}", "starred_url": "https://api.github.com/users/Manishearth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Manishearth/subscriptions", "organizations_url": "https://api.github.com/users/Manishearth/orgs", "repos_url": "https://api.github.com/users/Manishearth/repos", "events_url": "https://api.github.com/users/Manishearth/events{/privacy}", "received_events_url": "https://api.github.com/users/Manishearth/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 46741598, "node_id": "MDU6TGFiZWw0Njc0MTU5OA==", "url": "https://api.github.com/repos/rust-lang/rust/labels/E-needs-test", "name": "E-needs-test", "color": "02e10c", "default": false, "description": "Call for participation: writing correctness tests"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 1282665911, "node_id": "MDU6TGFiZWwxMjgyNjY1OTEx", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-const-generics", "name": "A-const-generics", "color": "f7e101", "default": false, "description": "Area: const generics (parameters and arguments)"}, {"id": 1405345617, "node_id": "MDU6TGFiZWwxNDA1MzQ1NjE3", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-lazy-normalization", "name": "A-lazy-normalization", "color": "f7e101", "default": false, "description": "Area: lazy normalization (tracking issue: #60471)"}, {"id": 1486687397, "node_id": "MDU6TGFiZWwxNDg2Njg3Mzk3", "url": "https://api.github.com/repos/rust-lang/rust/labels/F-const_generics", "name": "F-const_generics", "color": "f9c0cc", "default": false, "description": "`#![feature(const_generics)]`"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2019-12-31T13:04:21Z", "updated_at": "2020-01-18T04:45:04Z", "closed_at": "2020-01-18T04:45:04Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```rust\r\n#![feature(const_generics)]\r\n\r\nfn main() {\r\n    takes_closure_of_array_3(|[x, y, z]| {\r\n        println!(\"args: x={}, y={}, z={}\", x, y, z);\r\n    });\r\n}\r\n\r\nfn takes_closure_of_array_3<F>(f: F)\r\nwhere\r\n    F: Fn([i32; 3]),\r\n{\r\n    f([1, 2, 3]);\r\n}\r\n```\r\n\r\n([playpen](https://play.rust-lang.org/?version=nightly&mode=debug&edition=2018&gist=dd61053708a51e96786e54286e048ced))\r\n\r\nGives the error:\r\n```\r\n   Compiling playground v0.0.1 (/playground)\r\nwarning: the feature `const_generics` is incomplete and may cause the compiler to crash\r\n --> src/main.rs:1:12\r\n  |\r\n1 | #![feature(const_generics)]\r\n  |            ^^^^^^^^^^^^^^\r\n  |\r\n  = note: `#[warn(incomplete_features)]` on by default\r\n\r\nerror[E0391]: cycle detected when const-evaluating + checking `takes_closure_of_array_3::{{constant}}#0`\r\n  --> src/main.rs:11:17\r\n   |\r\n11 |     F: Fn([i32; 3]),\r\n   |                 ^\r\n   |\r\nnote: ...which requires const-evaluating + checking `takes_closure_of_array_3::{{constant}}#0`...\r\n  --> src/main.rs:11:17\r\n   |\r\n11 |     F: Fn([i32; 3]),\r\n   |                 ^\r\n......................\r\n9  | / fn takes_closure_of_array_3<F>(f: F)\r\n10 | | where\r\n11 | |     F: Fn([i32; 3]),\r\n12 | | {\r\n13 | |     f([1, 2, 3]);\r\n14 | | }\r\n   | |_^\r\n\r\n```\r\n\r\nThis compiles fine with const_generics not enabled, and is a regression\r\n\r\ncc @centril @oli-obk ", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/67753/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/67753/timeline", "performed_via_github_app": null, "state_reason": "completed"}