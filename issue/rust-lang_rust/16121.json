{"url": "https://api.github.com/repos/rust-lang/rust/issues/16121", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/16121/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/16121/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/16121/events", "html_url": "https://github.com/rust-lang/rust/issues/16121", "id": 39136801, "node_id": "MDU6SXNzdWUzOTEzNjgwMQ==", "number": 16121, "title": "Segfault in safe code while decoding JSON", "user": {"login": "japaric", "id": 5018213, "node_id": "MDQ6VXNlcjUwMTgyMTM=", "avatar_url": "https://avatars.githubusercontent.com/u/5018213?v=4", "gravatar_id": "", "url": "https://api.github.com/users/japaric", "html_url": "https://github.com/japaric", "followers_url": "https://api.github.com/users/japaric/followers", "following_url": "https://api.github.com/users/japaric/following{/other_user}", "gists_url": "https://api.github.com/users/japaric/gists{/gist_id}", "starred_url": "https://api.github.com/users/japaric/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/japaric/subscriptions", "organizations_url": "https://api.github.com/users/japaric/orgs", "repos_url": "https://api.github.com/users/japaric/repos", "events_url": "https://api.github.com/users/japaric/events{/privacy}", "received_events_url": "https://api.github.com/users/japaric/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2014-07-30T21:02:59Z", "updated_at": "2014-07-31T00:13:28Z", "closed_at": "2014-07-31T00:13:28Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "STR\n\n``` rust\nextern crate serialize;\n\nuse serialize::json;\n\n#[deriving(Decodable)]\nstruct Interpreter {\n    command: String,\n    flags: Vec<String>,\n    version: String,\n}\n\nstatic GOOD_INPUT: &'static str =\nr#\"{\n    \"command\": \"python3\",\n    \"flags\": [\"-O\"],\n    \"version\": \"--version\"\n}\"#;\n\nstatic BAD_INPUT: &'static str =\nr#\"{\n    \"command\": \"python3\",\n    \"flags\": [\"-O\"],\n    \"--version\": \"--version\"\n}\"#;\n\nfn main() {\n    println!(\"Decoding GOOD_INPUT... \");\n    let good = match json::decode::<Interpreter>(GOOD_INPUT) {\n        Err(err) => fail!(\"{}\", err),\n        Ok(interpreter) => interpreter,\n    };\n    println!(\"> OK\");\n\n    println!(\"Decoding BAD_INPUT... \");\n    let bad = match json::decode::<Interpreter>(BAD_INPUT) {\n        Err(err) => fail!(\"{}\", err),\n        Ok(interpreter) => interpreter,\n    };\n    println!(\"> OK\");\n}\n```\n\nGDB backtrace:\n\n```\nDecoding GOOD_INPUT...\n> OK\nDecoding BAD_INPUT...\n\nProgram received signal SIGSEGV, Segmentation fault.\n0x0000000000404696 in json::decode::h14338055721627637230 ()\n(gdb) backtrace\n#0  0x0000000000404696 in json::decode::h14338055721627637230 ()\n#1  0x0000000000403a38 in main::ha45ff07edb6cb131oca ()\n#2  0x00000000004416a3 in start::closure.$x22closure$x22$LP$8257$RP$ ()\n#3  0x000000000046b76c in rust_try ()\n#4  0x0000000000468ca7 in unwind::try::h7df958a05de7d0830Ld ()\n#5  0x0000000000468a97 in task::Task::run::h7e40d178364b7983WTc ()\n#6  0x00000000004414c0 in start::h00c9cf36f68b5235Ype ()\n#7  0x00000000004412f9 in lang_start::h69b9bfc9bbd58be9ipe ()\n#8  0x00007ffff7415fd0 in __libc_start_main () from /lib64/libc.so.6\n#9  0x00000000004037a1 in _start ()\n```\n\nVersion:\n\n```\nrustc 0.12.0-pre (3ab170ffc 2014-07-30 13:01:10 +0000)\n```\n\n(It also segfaults in the [playpen](http://is.gd/e571XB))\n\ncc @erickt \n", "closed_by": {"login": "luqmana", "id": 287063, "node_id": "MDQ6VXNlcjI4NzA2Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/287063?v=4", "gravatar_id": "", "url": "https://api.github.com/users/luqmana", "html_url": "https://github.com/luqmana", "followers_url": "https://api.github.com/users/luqmana/followers", "following_url": "https://api.github.com/users/luqmana/following{/other_user}", "gists_url": "https://api.github.com/users/luqmana/gists{/gist_id}", "starred_url": "https://api.github.com/users/luqmana/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/luqmana/subscriptions", "organizations_url": "https://api.github.com/users/luqmana/orgs", "repos_url": "https://api.github.com/users/luqmana/repos", "events_url": "https://api.github.com/users/luqmana/events{/privacy}", "received_events_url": "https://api.github.com/users/luqmana/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/16121/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/16121/timeline", "performed_via_github_app": null, "state_reason": "completed"}