{"url": "https://api.github.com/repos/rust-lang/rust/issues/34489", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/34489/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/34489/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/34489/events", "html_url": "https://github.com/rust-lang/rust/issues/34489", "id": 162342254, "node_id": "MDU6SXNzdWUxNjIzNDIyNTQ=", "number": 34489, "title": "./configure fails on Windows/MSYS2", "user": {"login": "petrochenkov", "id": 5751617, "node_id": "MDQ6VXNlcjU3NTE2MTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5751617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petrochenkov", "html_url": "https://github.com/petrochenkov", "followers_url": "https://api.github.com/users/petrochenkov/followers", "following_url": "https://api.github.com/users/petrochenkov/following{/other_user}", "gists_url": "https://api.github.com/users/petrochenkov/gists{/gist_id}", "starred_url": "https://api.github.com/users/petrochenkov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petrochenkov/subscriptions", "organizations_url": "https://api.github.com/users/petrochenkov/orgs", "repos_url": "https://api.github.com/users/petrochenkov/repos", "events_url": "https://api.github.com/users/petrochenkov/events{/privacy}", "received_events_url": "https://api.github.com/users/petrochenkov/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 123109, "node_id": "MDU6TGFiZWwxMjMxMDk=", "url": "https://api.github.com/repos/rust-lang/rust/labels/O-windows", "name": "O-windows", "color": "6e6ec0", "default": false, "description": "Operating system: Windows"}, {"id": 266005714, "node_id": "MDU6TGFiZWwyNjYwMDU3MTQ=", "url": "https://api.github.com/repos/rust-lang/rust/labels/O-windows-gnu", "name": "O-windows-gnu", "color": "6e6ec0", "default": false, "description": "Toolchain: GNU, Operating system: Windows"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 19, "created_at": "2016-06-26T19:08:54Z", "updated_at": "2016-07-02T10:19:07Z", "closed_at": "2016-07-02T10:19:07Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "The PR causing this is https://github.com/rust-lang/rust/pull/34055\ncc @brson @alexcrichton \n\nHow to reproduce: simply run `./configure` on fresh or not so fresh clone of Rust repo using relatively recent MSYS2 (`msys2-x86_64-20160205`).\ncmake package used: `mingw64/mingw-w64-x86_64-cmake 3.4.1-1`\nErrors:\n\n```\n-- Constructing LLVMBuild project information\nCMake Error: File /home/we/rust/src/llvm/LLVMBuild.txt does not exist.\nCMake Error at C:/msys64/home/we/rust/x86_64-pc-windows-gnu/llvm/LLVMBuild.cmake:28 (configure_file):\n  configure_file Problem configuring file\nCall Stack (most recent call first):\n  CMakeLists.txt:489 (include)\n\n\nCMake Error: File /home/we/rust/src/llvm/bindings/LLVMBuild.txt does not exist.\nCMake Error at C:/msys64/home/we/rust/x86_64-pc-windows-gnu/llvm/LLVMBuild.cmake:30 (configure_file):\n  configure_file Problem configuring file\nCall Stack (most recent call first):\n  CMakeLists.txt:489 (include)\n\n\n// ...\n// Lots of \"File does not exist\" errors are skipped\n// ...\n\nCMake Error: File /home/we/rust/src/llvm/utils/llvm-build/llvmbuild/componentinfo.py does not exist.\nCMake Error at C:/msys64/home/we/rust/x86_64-pc-windows-gnu/llvm/LLVMBuild.cmake:362 (configure_file):\n  configure_file Problem configuring file\nCall Stack (most recent call first):\n  CMakeLists.txt:489 (include)\n\n\nCMake Error: File /home/we/rust/src/llvm/utils/llvm-build/llvmbuild/util.py does not exist.\nCMake Error at C:/msys64/home/we/rust/x86_64-pc-windows-gnu/llvm/LLVMBuild.cmake:364 (configure_file):\n  configure_file Problem configuring file\nCall Stack (most recent call first):\n  CMakeLists.txt:489 (include)\n\n\n-- LLVMHello ignored -- Loadable modules not supported on this platform.\n-- Targeting X86\n-- Targeting ARM\n-- Targeting AArch64\n-- Targeting Mips\n-- Targeting PowerPC\n-- BugpointPasses ignored -- Loadable modules not supported on this platform.\n-- Configuring incomplete, errors occurred!\nSee also \"C:/msys64/home/we/rust/x86_64-pc-windows-gnu/llvm/CMakeFiles/CMakeOutput.log\".\nSee also \"C:/msys64/home/we/rust/x86_64-pc-windows-gnu/llvm/CMakeFiles/CMakeError.log\".\nconfigure: error: LLVM cmake configure failed\n```\n\nAll the files reported by CMake as missing actually exist, so there is probably some mis-translation between Linux-style msys file paths and Windows paths or something like that.\n\nNon-mingw cmake package (`msys/cmake 3.2.3-1`) gives other errors (EDIT: irrelevant):\n\n```\nconfigure:  -DLLVM_INCLUDE_TESTS=OFF -DLLVM_INCLUDE_EXAMPLES=OFF -DLLVM_INCLUDE_DOCS=OFF -DLLVM_ENABLE_ZLIB=OFF -DWITH_POLY=OFF -DLLVM_ENABLE_TERMINFO=OFF -DLLVM_ENABLE_LIBEDIT=OFF -DCMAKE_C_COMPILER=gcc -DCMAKE_CXX_COMPILER=g++ '-DCMAKE_C_FLAGS=' '-DCMAKE_CXX_FLAGS=' -DCMAKE_BUILD_TYPE=Release -DLLVM_ENABLE_ASSERTIONS=OFF -DLLVM_TARGETS_TO_BUILD='X86;ARM;AArch64;Mips;PowerPC' -G 'Unix Makefiles' /home/we/rust/src/llvm/\n-- The C compiler identification is GNU 4.9.3\n-- The CXX compiler identification is GNU 4.9.3\n-- The ASM compiler identification is GNU\n-- Found assembler: /c/mingw-w64/x86_64-4.9.3-win32-seh-rt_v4-rev1/mingw64/bin/gcc.exe\nSystem is unknown to cmake, create:\nPlatform/MINGW64_NT-6.3 to use this system, please send your config file to cmake@www.cmake.org so it can be added to cmake\n-- Check for working C compiler: /c/mingw-w64/x86_64-4.9.3-win32-seh-rt_v4-rev1/mingw64/bin/gcc.exe\nSystem is unknown to cmake, create:\nPlatform/MINGW64_NT-6.3 to use this system, please send your config file to cmake@www.cmake.org so it can be added to cmake\n-- Check for working C compiler: /c/mingw-w64/x86_64-4.9.3-win32-seh-rt_v4-rev1/mingw64/bin/gcc.exe -- works\n-- Detecting C compiler ABI info\nSystem is unknown to cmake, create:\nPlatform/MINGW64_NT-6.3 to use this system, please send your config file to cmake@www.cmake.org so it can be added to cmake\n-- Detecting C compiler ABI info - done\n-- Detecting C compile features\n-- Detecting C compile features - done\n-- Check for working CXX compiler: /c/mingw-w64/x86_64-4.9.3-win32-seh-rt_v4-rev1/mingw64/bin/g++.exe\nSystem is unknown to cmake, create:\nPlatform/MINGW64_NT-6.3 to use this system, please send your config file to cmake@www.cmake.org so it can be added to cmake\n-- Check for working CXX compiler: /c/mingw-w64/x86_64-4.9.3-win32-seh-rt_v4-rev1/mingw64/bin/g++.exe -- works\n-- Detecting CXX compiler ABI info\nSystem is unknown to cmake, create:\nPlatform/MINGW64_NT-6.3 to use this system, please send your config file to cmake@www.cmake.org so it can be added to cmake\n-- Detecting CXX compiler ABI info - done\n-- Detecting CXX compile features\n-- Detecting CXX compile features - done\n-- Looking for dirent.h\nSystem is unknown to cmake, create:\nPlatform/MINGW64_NT-6.3 to use this system, please send your config file to cmake@www.cmake.org so it can be added to cmake\n-- Looking for dirent.h - found\n-- Looking for dlfcn.h\nSystem is unknown to cmake, create:\nPlatform/MINGW64_NT-6.3 to use this system, please send your config file to cmake@www.cmake.org so it can be added to cmake\n-- Looking for dlfcn.h - not found\n\n// ...\n// etc\n// ...\n```\n", "closed_by": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/34489/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/34489/timeline", "performed_via_github_app": null, "state_reason": "completed"}