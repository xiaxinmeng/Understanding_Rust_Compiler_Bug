{"url": "https://api.github.com/repos/rust-lang/rust/issues/9547", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/9547/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/9547/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/9547/events", "html_url": "https://github.com/rust-lang/rust/issues/9547", "id": 20140877, "node_id": "MDU6SXNzdWUyMDE0MDg3Nw==", "number": 9547, "title": "makefile: define as many make variables as possible before use", "user": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2013-09-26T22:21:27Z", "updated_at": "2017-02-11T00:12:31Z", "closed_at": "2017-02-11T00:12:31Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "A bug (#9531) went undetected because I was careless and failed to put a variable definition before all of its uses (SHA: b1a22518f0c687db008c4abf5e8e0411fb58c2f5).\n\nFurther investigation revealed that make _does_ offer an `--warn-undefined-variables` option that will list all variables that are expanded without being provided a definition.\n\nIt might be good if we tried to minimize the number of warnings emitted by that flag, by putting explicit (even if empty) definitions up before their first use.\n\n(Here's the list of warnings emitted, with obvious duplicate entries removed.)\n\n```\n% make -j1 --warn-undefined-variables\nMakefile:76: warning: undefined variable `MAKE_RESTARTS'\ncfg: build triple x86_64-apple-darwin\ncfg: host triples x86_64-apple-darwin\ncfg: target triples x86_64-apple-darwin\nMakefile:91: warning: undefined variable `RUSTFLAGS'\ncfg: enabling more debugging (CFG_ENABLE_DEBUG)\ncfg: host for x86_64-apple-darwin is x86_64\ncfg: os for x86_64-apple-darwin is apple-darwin\ncfg: using ccache clang\n/Users/pnkfelix/Dev/Mozilla/rust.git/mk/platform.mk:370: warning: undefined variable `CFG_LDPATH_i686-pc-mingw32'\n/Users/pnkfelix/Dev/Mozilla/rust.git/mk/platform.mk:422: warning: undefined variable `CFG_LDPATH_x86_64-w64-mingw32'\nMakefile:497: warning: undefined variable `RUSTFLAGS_STAGE0'\nMakefile:497: warning: undefined variable `RUSTC_FLAGS_x86_64-apple-darwin'\nMakefile:497: warning: undefined variable `CFG_PERF_TOOL'\nMakefile:497: warning: undefined variable `RUSTFLAGS_STAGE0'\nMakefile:497: warning: undefined variable `RUSTFLAGS_STAGE3'\nMakefile:497: warning: undefined variable `RUSTFLAGS_STAGE3'\nMakefile:518: warning: undefined variable `HLIBSYNTAX_DEFAULT1_H_x86_64-apple-darwin'\nMakefile:518: warning: undefined variable `HLIBSYNTAX_DEFAULT2_H_x86_64-apple-darwin'\nMakefile:518: warning: undefined variable `HLIBSYNTAX_DEFAULT3_H_x86_64-apple-darwin'\nMakefile:548: warning: undefined variable `CFG_IN_TRANSITION'\nMakefile:570: warning: undefined variable `HLIBSYNTAX_DEFAULT2_H_x86_64-apple-darwin'\n/Users/pnkfelix/Dev/Mozilla/rust.git/mk/target.mk:134: warning: undefined variable `BORROWCK'\n/Users/pnkfelix/Dev/Mozilla/rust.git/mk/target.mk:134: warning: undefined variable `CFG_PAXCTL'\n/Users/pnkfelix/Dev/Mozilla/rust.git/mk/target.mk:134: warning: undefined variable `HLIBSYNTAX_DEFAULT0_H_x86_64-apple-darwin'\n/Users/pnkfelix/Dev/Mozilla/rust.git/mk/target.mk:134: warning: undefined variable `HLIBSYNTAX_DEFAULT1_H_x86_64-apple-darwin'\n/Users/pnkfelix/Dev/Mozilla/rust.git/mk/target.mk:134: warning: undefined variable `HLIBSYNTAX_DEFAULT2_H_x86_64-apple-darwin'\n/Users/pnkfelix/Dev/Mozilla/rust.git/mk/target.mk:134: warning: undefined variable `HLIBSYNTAX_DEFAULT3_H_x86_64-apple-darwin'\n/Users/pnkfelix/Dev/Mozilla/rust.git/mk/host.mk:148: warning: undefined variable `STDLIB_DSYM_GLOB'\n/Users/pnkfelix/Dev/Mozilla/rust.git/mk/rt.mk:29: warning: undefined variable `1'\n/Users/pnkfelix/Dev/Mozilla/rust.git/mk/rt.mk:29: warning: undefined variable `OSTYPE_'\n/Users/pnkfelix/Dev/Mozilla/rust.git/mk/rt.mk:40: warning: undefined variable `MAKECMDGOALS'\n/Users/pnkfelix/Dev/Mozilla/rust.git/mk/rt.mk:287: warning: undefined variable `,'\n/Users/pnkfelix/Dev/Mozilla/rust.git/mk/rt.mk:287: warning: undefined variable `MORESTACK_OBJS_x86_64-apple-darwin_0'\n/Users/pnkfelix/Dev/Mozilla/rust.git/mk/rt.mk:287: warning: undefined variable `,'\n/Users/pnkfelix/Dev/Mozilla/rust.git/mk/rt.mk:287: warning: undefined variable `MORESTACK_OBJS_x86_64-apple-darwin_1'\n/Users/pnkfelix/Dev/Mozilla/rust.git/mk/rt.mk:287: warning: undefined variable `,'\n/Users/pnkfelix/Dev/Mozilla/rust.git/mk/rt.mk:287: warning: undefined variable `MORESTACK_OBJS_x86_64-apple-darwin_2'\n/Users/pnkfelix/Dev/Mozilla/rust.git/mk/rt.mk:287: warning: undefined variable `,'\n/Users/pnkfelix/Dev/Mozilla/rust.git/mk/rt.mk:287: warning: undefined variable `MORESTACK_OBJS_x86_64-apple-darwin_3'\n/Users/pnkfelix/Dev/Mozilla/rust.git/mk/tools.mk:219: warning: undefined variable `HLIBSYNTAX_DEFAULT0_H_x86_64-apple-darwin'\n/Users/pnkfelix/Dev/Mozilla/rust.git/mk/tools.mk:219: warning: undefined variable `HLIBSYNTAX_DEFAULT1_H_x86_64-apple-darwin'\n/Users/pnkfelix/Dev/Mozilla/rust.git/mk/tools.mk:219: warning: undefined variable `HLIBSYNTAX_DEFAULT2_H_x86_64-apple-darwin'\n/Users/pnkfelix/Dev/Mozilla/rust.git/mk/tools.mk:219: warning: undefined variable `HLIBSYNTAX_DEFAULT3_H_x86_64-apple-darwin'\n/Users/pnkfelix/Dev/Mozilla/rust.git/mk/tools.mk:226: warning: undefined variable `LIBRUST_DSYM_GLOB'\n/Users/pnkfelix/Dev/Mozilla/rust.git/mk/tools.mk:226: warning: undefined variable `HLIBSYNTAX_DEFAULT1_H_x86_64-apple-darwin'\n/Users/pnkfelix/Dev/Mozilla/rust.git/mk/tools.mk:226: warning: undefined variable `HLIBSYNTAX_DEFAULT2_H_x86_64-apple-darwin'\n/Users/pnkfelix/Dev/Mozilla/rust.git/mk/tools.mk:226: warning: undefined variable `HLIBSYNTAX_DEFAULT3_H_x86_64-apple-darwin'\n/Users/pnkfelix/Dev/Mozilla/rust.git/mk/docs.mk:41: warning: undefined variable `NO_DOCS'\nMakefile:628: warning: undefined variable `MAKECMDGOALS'\nmake: Nothing to be done for `all'.\n```\n", "closed_by": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/9547/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/9547/timeline", "performed_via_github_app": null, "state_reason": "completed"}