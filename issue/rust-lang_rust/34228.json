{"url": "https://api.github.com/repos/rust-lang/rust/issues/34228", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/34228/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/34228/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/34228/events", "html_url": "https://github.com/rust-lang/rust/issues/34228", "id": 159790139, "node_id": "MDU6SXNzdWUxNTk3OTAxMzk=", "number": 34228, "title": "Shallow clones of submodules", "user": {"login": "srawlins", "id": 103167, "node_id": "MDQ6VXNlcjEwMzE2Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/103167?v=4", "gravatar_id": "", "url": "https://api.github.com/users/srawlins", "html_url": "https://github.com/srawlins", "followers_url": "https://api.github.com/users/srawlins/followers", "following_url": "https://api.github.com/users/srawlins/following{/other_user}", "gists_url": "https://api.github.com/users/srawlins/gists{/gist_id}", "starred_url": "https://api.github.com/users/srawlins/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/srawlins/subscriptions", "organizations_url": "https://api.github.com/users/srawlins/orgs", "repos_url": "https://api.github.com/users/srawlins/repos", "events_url": "https://api.github.com/users/srawlins/events{/privacy}", "received_events_url": "https://api.github.com/users/srawlins/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2016-06-11T19:34:08Z", "updated_at": "2017-06-22T17:48:08Z", "closed_at": "2017-06-22T17:48:08Z", "author_association": "NONE", "active_lock_reason": null, "body": "(This is a new issue for [this comment](https://github.com/rust-lang/rust/issues/30107#issuecomment-160513248) on #30107.)\n\nRight now `configure` performs deep clones of submodules (and recursively). This means downloading tons and tons of history (especially in the case of LLVM). Bad for slow connections, etc.\n\nBut we should be able to perform \"shallow\" clones, passing `--depth 1` to `git submodule update`.\n\nI've tried this locally, and git wasn't happy about it:\n\n```\nrust$ ./configure\n...\nconfigure: git: submodule init\nconfigure: git: submodule update --depth 1\nerror: no such remote ref 80ad955b60b3ac02d0462a4a65fcea597d0ebfb1\nFetched in submodule path 'src/llvm', but it did not contain 80ad955b60b3ac02d0462a4a65fcea597d0ebfb1. Direct fetching of that commit failed.\nconfigure: error: git failed\n```\n\nI am pretty sure this is [this issue](http://www.spinics.net/lists/git/msg271258.html). The solution requires the `uploadpack.allowReachableSHA1InWant` repository configuration flag, which, if https://github.com/isaacs/github/issues/436 is up-to-date, is not set on GitHub.\n\nSo I think this issue is blocked on https://github.com/isaacs/github/issues/436, for a start.\n", "closed_by": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/34228/reactions", "total_count": 3, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 1, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/34228/timeline", "performed_via_github_app": null, "state_reason": "completed"}