{"url": "https://api.github.com/repos/rust-lang/rust/issues/55741", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/55741/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/55741/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/55741/events", "html_url": "https://github.com/rust-lang/rust/issues/55741", "id": 378149115, "node_id": "MDU6SXNzdWUzNzgxNDkxMTU=", "number": 55741, "title": "Providing the compiler crates as rlib?", "user": {"login": "swiftcoder", "id": 4706210, "node_id": "MDQ6VXNlcjQ3MDYyMTA=", "avatar_url": "https://avatars.githubusercontent.com/u/4706210?v=4", "gravatar_id": "", "url": "https://api.github.com/users/swiftcoder", "html_url": "https://github.com/swiftcoder", "followers_url": "https://api.github.com/users/swiftcoder/followers", "following_url": "https://api.github.com/users/swiftcoder/following{/other_user}", "gists_url": "https://api.github.com/users/swiftcoder/gists{/gist_id}", "starred_url": "https://api.github.com/users/swiftcoder/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/swiftcoder/subscriptions", "organizations_url": "https://api.github.com/users/swiftcoder/orgs", "repos_url": "https://api.github.com/users/swiftcoder/repos", "events_url": "https://api.github.com/users/swiftcoder/events{/privacy}", "received_events_url": "https://api.github.com/users/swiftcoder/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 325438536, "node_id": "MDU6TGFiZWwzMjU0Mzg1MzY=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-bootstrap", "name": "T-bootstrap", "color": "bfd4f2", "default": false, "description": "Relevant to the bootstrap subteam: Rust's build system (x.py and src/bootstrap)"}, {"id": 630652267, "node_id": "MDU6TGFiZWw2MzA2NTIyNjc=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-feature-request", "name": "C-feature-request", "color": "f5f1fd", "default": false, "description": "Category: A feature request, i.e: not implemented / a PR."}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2018-11-07T05:36:40Z", "updated_at": "2023-02-03T07:27:54Z", "closed_at": null, "author_association": "NONE", "active_lock_reason": null, "body": "I'd like to embed `rustc_driver` in a static library (for complicated embedded deployment reasons that aren't entirely relevant). Dependencies of a static library seem to have to be in rlib format so the compile can read metadata.\r\n\r\nUnfortunately, most of the compiler crates are only building dylibs, causing cargo to refuse to build a staticlib:\r\n\r\n```\r\nerror: crate `rustc_driver` required to be available in rlib format, but was not found in this form\r\nerror: crate `arena` required to be available in rlib format, but was not found in this form\r\nerror: crate `rustc_data_structures` required to be available in rlib format, but was not found in this form\r\nerror: crate `graphviz` required to be available in rlib format, but was not found in this form\r\nerror: crate `rustc_cratesio_shim` required to be available in rlib format, but was not found in this for\r\nerror: crate `rustc` required to be available in rlib format, but was not found in this form\r\nerror: crate `fmt_macros` required to be available in rlib format, but was not found in this form\r\nerror: crate `rustc_target` required to be available in rlib format, but was not found in this form\r\nerror: crate `rustc_errors` required to be available in rlib format, but was not found in this form\r\nerror: crate `syntax_pos` required to be available in rlib format, but was not found in this form\r\nerror: crate `syntax` required to be available in rlib format, but was not found in this form\r\nerror: crate `proc_macro` required to be available in rlib format, but was not found in this form\r\nerror: crate `rustc_fs_util` required to be available in rlib format, but was not found in this form\r\nerror: crate `rustc_allocator` required to be available in rlib format, but was not found in this form\r\nerror: crate `rustc_borrowck` required to be available in rlib format, but was not found in this form\r\nerror: crate `rustc_mir` required to be available in rlib format, but was not found in this form\r\nerror: crate `rustc_passes` required to be available in rlib format, but was not found in this form\r\nerror: crate `rustc_lint` required to be available in rlib format, but was not found in this form\r\nerror: crate `rustc_plugin` required to be available in rlib format, but was not found in this form\r\nerror: crate `rustc_metadata` required to be available in rlib format, but was not found in this form\r\nerror: crate `syntax_ext` required to be available in rlib format, but was not found in this form\r\nerror: crate `rustc_privacy` required to be available in rlib format, but was not found in this form\r\nerror: crate `rustc_typeck` required to be available in rlib format, but was not found in this form\r\nerror: crate `rustc_platform_intrinsics` required to be available in rlib format, but was not found in this form\r\nerror: crate `rustc_incremental` required to be available in rlib format, but was not found in this form\r\nerror: crate `rustc_resolve` required to be available in rlib format, but was not found in this form\r\nerror: crate `rustc_save_analysis` required to be available in rlib format, but was not found in this form\r\nerror: crate `rustc_codegen_utils` required to be available in rlib format, but was not found in this form\r\nerror: crate `rustc_traits` required to be available in rlib format, but was not found in this form\r\n\r\nerror: aborting due to 29 previous errors\r\n```\r\n\r\nIs there a technical reason why these are all only built as dylib, or is this just because no one has thus far needed to embed them in a staticlib? Would it be a reasonable ask to configure these projects to build both flavours?", "closed_by": {"login": "jyn514", "id": 23638587, "node_id": "MDQ6VXNlcjIzNjM4NTg3", "avatar_url": "https://avatars.githubusercontent.com/u/23638587?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jyn514", "html_url": "https://github.com/jyn514", "followers_url": "https://api.github.com/users/jyn514/followers", "following_url": "https://api.github.com/users/jyn514/following{/other_user}", "gists_url": "https://api.github.com/users/jyn514/gists{/gist_id}", "starred_url": "https://api.github.com/users/jyn514/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jyn514/subscriptions", "organizations_url": "https://api.github.com/users/jyn514/orgs", "repos_url": "https://api.github.com/users/jyn514/repos", "events_url": "https://api.github.com/users/jyn514/events{/privacy}", "received_events_url": "https://api.github.com/users/jyn514/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/55741/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/55741/timeline", "performed_via_github_app": null, "state_reason": "reopened"}