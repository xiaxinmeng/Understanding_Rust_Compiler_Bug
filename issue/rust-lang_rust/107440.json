{"url": "https://api.github.com/repos/rust-lang/rust/issues/107440", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/107440/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/107440/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/107440/events", "html_url": "https://github.com/rust-lang/rust/issues/107440", "id": 1561210630, "node_id": "I_kwDOAAsO6M5dDi8G", "number": 107440, "title": "error: internal compiler error: no errors encountered even though `delay_span_bug` issued", "user": {"login": "Kofituo", "id": 58628654, "node_id": "MDQ6VXNlcjU4NjI4NjU0", "avatar_url": "https://avatars.githubusercontent.com/u/58628654?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Kofituo", "html_url": "https://github.com/Kofituo", "followers_url": "https://api.github.com/users/Kofituo/followers", "following_url": "https://api.github.com/users/Kofituo/following{/other_user}", "gists_url": "https://api.github.com/users/Kofituo/gists{/gist_id}", "starred_url": "https://api.github.com/users/Kofituo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Kofituo/subscriptions", "organizations_url": "https://api.github.com/users/Kofituo/orgs", "repos_url": "https://api.github.com/users/Kofituo/repos", "events_url": "https://api.github.com/users/Kofituo/events{/privacy}", "received_events_url": "https://api.github.com/users/Kofituo/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}, {"id": 1359848690, "node_id": "MDU6TGFiZWwxMzU5ODQ4Njkw", "url": "https://api.github.com/repos/rust-lang/rust/labels/E-needs-mcve", "name": "E-needs-mcve", "color": "02e10c", "default": false, "description": "Call for participation: This issue needs a Minimal Complete and Verifiable Example"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2023-01-29T09:44:19Z", "updated_at": "2023-03-21T18:31:03Z", "closed_at": null, "author_association": "NONE", "active_lock_reason": null, "body": "As I was compiling Substrate, I faced this error:\r\n\r\n```\r\nerror: internal compiler error: no errors encountered even though `delay_span_bug` issued\r\n\r\nerror: internal compiler error: broken MIR in DropGlue(DefId(2:2801 ~ core[b4b4]::ptr::drop_in_place), Some(hyper::proto::h1::dispatch::Server<hyper::service::util::ServiceFn<fn(http::request::Request<jsonrpsee::jsonrpsee_server::logger::Body>) -> impl futures::Future<Output = sc_service::Result<http::response::Response<jsonrpsee::jsonrpsee_server::logger::Body>, std::convert::Infallible>> {jsonrpsee::jsonrpsee_server::transport::http::reject_connection::{closure#0}::reject}, jsonrpsee::jsonrpsee_server::logger::Body>, jsonrpsee::jsonrpsee_server::logger::Body>)) (after phase change to runtime-optimized) at bb0[0]:\r\n                                Field projection `(*_1).field[0]` specified type `std::pin::Pin<std::boxed::Box<std::option::Option<std::future::from_generator::GenFuture<[static generator@jsonrpsee::jsonrpsee_server::transport::http::reject_connection::{closure#0}::reject::{closure#0}]>>>>`, but actual type is `std::pin::Pin<std::boxed::Box<std::option::Option<<hyper::service::util::ServiceFn<fn(http::request::Request<jsonrpsee::jsonrpsee_server::logger::Body>) -> impl futures::Future<Output = sc_service::Result<http::response::Response<jsonrpsee::jsonrpsee_server::logger::Body>, std::convert::Infallible>> {jsonrpsee::jsonrpsee_server::transport::http::reject_connection::{closure#0}::reject}, jsonrpsee::jsonrpsee_server::logger::Body> as hyper::service::http::HttpService<jsonrpsee::jsonrpsee_server::logger::Body>>::Future>>>`\r\n   --> /Users/kofiotuo/.rustup/toolchains/nightly-aarch64-apple-darwin/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:490:1\r\n    |\r\n490 | pub unsafe fn drop_in_place<T: ?Sized>(to_drop: *mut T) {\r\n    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n    |\r\n    = note: delayed at compiler/rustc_const_eval/src/transform/validate.rs:88:36\r\n\r\nthread 'rustc' panicked at 'Box<dyn Any>', compiler/rustc_errors/src/lib.rs:1594:13\r\nstack backtrace:\r\n   0:        0x100fd3c44 - <std::sys_common::backtrace::_print::DisplayBacktrace as core::fmt::Display>::fmt::h5ceaa9f104581d16\r\n   1:        0x101024ff0 - core::fmt::write::h70c33f48cfd4e8aa\r\n   2:        0x100fc71f4 - std::io::Write::write_fmt::h24e387c05c0fa515\r\n   3:        0x100fd3a58 - std::sys_common::backtrace::print::ha3dd569c0e03b1e6\r\n   4:        0x100fd64ec - std::panicking::default_hook::{{closure}}::h85ce766fb3b3c496\r\n   5:        0x100fd6244 - std::panicking::default_hook::h7c44756c2f138c7c\r\n   6:        0x1090ce784 - rustc_driver[34fe2e47ceb1eef]::DEFAULT_HOOK::{closure#0}::{closure#0}\r\n   7:        0x100fd6be4 - std::panicking::rust_panic_with_hook::h243fdb33bd154152\r\n   8:        0x10cffe950 - std[f91ad3a11560037b]::panicking::begin_panic::<rustc_errors[159eca52afa358bf]::ExplicitBug>::{closure#0}\r\n   9:        0x10cffcfd8 - std[f91ad3a11560037b]::sys_common::backtrace::__rust_end_short_backtrace::<std[f91ad3a11560037b]::panicking::begin_panic<rustc_errors[159eca52afa358bf]::ExplicitBug>::{closure#0}, !>\r\n  10:        0x10d3698ec - std[f91ad3a11560037b]::panicking::begin_panic::<rustc_errors[159eca52afa358bf]::ExplicitBug>\r\n  11:        0x10cff0bec - std[f91ad3a11560037b]::panic::panic_any::<rustc_errors[159eca52afa358bf]::ExplicitBug>\r\n  12:        0x10cff66d0 - <rustc_errors[159eca52afa358bf]::HandlerInner>::flush_delayed::<alloc[81ea9162d64fa727]::vec::Vec<rustc_errors[159eca52afa358bf]::diagnostic::Diagnostic>, &str>\r\n  13:        0x10cff31bc - <rustc_errors[159eca52afa358bf]::HandlerInner as core[b4b423dc40156325]::ops::drop::Drop>::drop\r\n  14:        0x10906201c - core[b4b423dc40156325]::ptr::drop_in_place::<rustc_session[ee64fa510201ce22]::parse::ParseSess>\r\n  15:        0x109063400 - core[b4b423dc40156325]::ptr::drop_in_place::<rustc_session[ee64fa510201ce22]::session::Session>\r\n  16:        0x1090be188 - core[b4b423dc40156325]::ptr::drop_in_place::<rustc_interface[d6308f9366e490e8]::interface::Compiler>\r\n  17:        0x1090aa118 - rustc_span[668ea99b1ecd1622]::with_source_map::<core[b4b423dc40156325]::result::Result<(), rustc_errors[159eca52afa358bf]::ErrorGuaranteed>, rustc_interface[d6308f9366e490e8]::interface::run_compiler<core[b4b423dc40156325]::result::Result<(), rustc_errors[159eca52afa358bf]::ErrorGuaranteed>, rustc_driver[34fe2e47ceb1eef]::run_compiler::{closure#1}>::{closure#0}::{closure#1}>\r\n  18:        0x1090a1f8c - <scoped_tls[44143ff9a1fdbbff]::ScopedKey<rustc_span[668ea99b1ecd1622]::SessionGlobals>>::set::<rustc_interface[d6308f9366e490e8]::interface::run_compiler<core[b4b423dc40156325]::result::Result<(), rustc_errors[159eca52afa358bf]::ErrorGuaranteed>, rustc_driver[34fe2e47ceb1eef]::run_compiler::{closure#1}>::{closure#0}, core[b4b423dc40156325]::result::Result<(), rustc_errors[159eca52afa358bf]::ErrorGuaranteed>>\r\n  19:        0x109070f74 - std[f91ad3a11560037b]::sys_common::backtrace::__rust_begin_short_backtrace::<rustc_interface[d6308f9366e490e8]::util::run_in_thread_pool_with_globals<rustc_interface[d6308f9366e490e8]::interface::run_compiler<core[b4b423dc40156325]::result::Result<(), rustc_errors[159eca52afa358bf]::ErrorGuaranteed>, rustc_driver[34fe2e47ceb1eef]::run_compiler::{closure#1}>::{closure#0}, core[b4b423dc40156325]::result::Result<(), rustc_errors[159eca52afa358bf]::ErrorGuaranteed>>::{closure#0}::{closure#0}, core[b4b423dc40156325]::result::Result<(), rustc_errors[159eca52afa358bf]::ErrorGuaranteed>>\r\n  20:        0x109056d40 - <<std[f91ad3a11560037b]::thread::Builder>::spawn_unchecked_<rustc_interface[d6308f9366e490e8]::util::run_in_thread_pool_with_globals<rustc_interface[d6308f9366e490e8]::interface::run_compiler<core[b4b423dc40156325]::result::Result<(), rustc_errors[159eca52afa358bf]::ErrorGuaranteed>, rustc_driver[34fe2e47ceb1eef]::run_compiler::{closure#1}>::{closure#0}, core[b4b423dc40156325]::result::Result<(), rustc_errors[159eca52afa358bf]::ErrorGuaranteed>>::{closure#0}::{closure#0}, core[b4b423dc40156325]::result::Result<(), rustc_errors[159eca52afa358bf]::ErrorGuaranteed>>::{closure#1} as core[b4b423dc40156325]::ops::function::FnOnce<()>>::call_once::{shim:vtable#0}\r\n  21:        0x100fdee60 - std::sys::unix::thread::Thread::new::thread_start::h94b0d6958f791f7f\r\n  22:        0x1ab33206c - __pthread_deallocate\r\n\r\nnote: the compiler unexpectedly panicked. this is a bug.\r\n\r\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/issues/new?labels=C-bug%2C+I-ICE%2C+T-compiler&template=ice.md\r\n\r\nnote: rustc 1.67.0-nightly (70f8737b2 2022-11-23) running on aarch64-apple-darwin\r\n\r\nnote: compiler flags: --crate-type bin -C opt-level=3 -C embed-bitcode=no\r\n\r\nnote: some of the compiler flags provided by cargo are hidden\r\n\r\nquery stack during panic:\r\nend of query stack\r\nerror: could not compile `node-template`\r\n", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/107440/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/107440/timeline", "performed_via_github_app": null, "state_reason": null}