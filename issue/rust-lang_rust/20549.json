{"url": "https://api.github.com/repos/rust-lang/rust/issues/20549", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/20549/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/20549/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/20549/events", "html_url": "https://github.com/rust-lang/rust/issues/20549", "id": 53356128, "node_id": "MDU6SXNzdWU1MzM1NjEyOA==", "number": 20549, "title": "no_std: Using boxed type without specifying owned_box crashes rustc", "user": {"login": "jonasschneider", "id": 8098, "node_id": "MDQ6VXNlcjgwOTg=", "avatar_url": "https://avatars.githubusercontent.com/u/8098?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jonasschneider", "html_url": "https://github.com/jonasschneider", "followers_url": "https://api.github.com/users/jonasschneider/followers", "following_url": "https://api.github.com/users/jonasschneider/following{/other_user}", "gists_url": "https://api.github.com/users/jonasschneider/gists{/gist_id}", "starred_url": "https://api.github.com/users/jonasschneider/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jonasschneider/subscriptions", "organizations_url": "https://api.github.com/users/jonasschneider/orgs", "repos_url": "https://api.github.com/users/jonasschneider/repos", "events_url": "https://api.github.com/users/jonasschneider/events{/privacy}", "received_events_url": "https://api.github.com/users/jonasschneider/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2015-01-05T01:20:47Z", "updated_at": "2015-07-13T07:03:09Z", "closed_at": "2015-07-13T07:03:09Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi, first time contributor here. This might be a bug. I think every factor mentioned in the title is required to trigger this. (I'm trying to do horrible things to the runtime, but I don't think this is significant here.)\n\nSource:\n\n```\n#![crate_type=\"staticlib\"]\n#![no_std]\n#![feature(globs,lang_items)]\n\nextern crate core;\n\npub unsafe fn cmod_main() {\n  let x = box 1i;\n}\n\n#[lang = \"stack_exhausted\"] extern fn stack_exhausted() {}\n#[lang = \"eh_personality\"] extern fn eh_personality() {}\n#[lang = \"panic_fmt\"] fn panic_fmt() -> ! { loop {} }\n```\n\nBacktrace (rustc 0.13.0-nightly (c6c786671 2015-01-04 00:50:59 +0000) installed via rustup on Ubuntu LTS):\n\n```\n+ rustc mod_hello.rs\nerror: internal compiler error: unexpected panic\nnote: the compiler unexpectedly panicked. this is a bug.\nnote: we would appreciate a bug report: http://doc.rust-lang.org/complement-bugreport.html\nnote: run with `RUST_BACKTRACE=1` for a backtrace\nthread 'rustc' panicked at 'called `Option::unwrap()` on a `None` value', /home/rustbuild/src/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libcore/option.rs:361\n\nstack backtrace:\n   1:     0x7feab66792d0 - sys::backtrace::write::h8532e701ef86014f4it\n   2:     0x7feab669eb00 - failure::on_fail::h7532e1f79d134d5dzvz\n   3:     0x7feab66041c0 - rt::unwind::begin_unwind_inner::h97b151606151d62deaz\n   4:     0x7feab6604b90 - rt::unwind::begin_unwind_fmt::h17761f13c23bc1bdL8y\n   5:     0x7feab669e950 - rust_begin_unwind\n   6:     0x7feab66e8480 - panicking::panic_fmt::h9b3a47cbcd5a9e3ahyl\n   7:     0x7feab66e63a0 - panicking::panic::hdb0bdef709ef82c5kwl\n   8:     0x7feab489bcb0 - middle::fast_reject::simplify_type::hb1556905b8041e186ho\n   9:     0x7feab49d5d10 - middle::traits::select::SelectionContext<'cx, 'tcx>::match_impl::hb52ab063e7e4913dPzT\n  10:     0x7feab49dfaa0 - middle::traits::select::SelectionContext<'cx, 'tcx>::assemble_candidates_from_impls::h3156cc6e5773eeeafmS\n  11:     0x7feab49da0e0 - middle::traits::select::SelectionContext<'cx, 'tcx>::candidate_from_obligation_no_cache::hee5fb56560ec1364MER\n  12:     0x7feab49cae40 - middle::traits::select::SelectionContext<'cx, 'tcx>::candidate_from_obligation::hb1931a349a9a6aa5exR\n  13:     0x7feab49a7a20 - middle::traits::select::SelectionContext<'cx, 'tcx>::select::h645cb0d6a6e6eb40dcR\n  14:     0x7feab49a49f0 - middle::traits::fulfill::FulfillmentContext<'tcx>::select::h92c64aaa4b6d37e4snP\n  15:     0x7feab486ac70 - middle::traits::fulfill::FulfillmentContext<'tcx>::select_all_or_error::heeffb7db5cefcef8zkP\n  16:     0x7feab49ed410 - middle::traits::evaluate_builtin_bound::h13d0188fd963a1f7OWU\n  17:     0x7feab49ee280 - middle::traits::type_known_to_meet_builtin_bound::hcdbcd9e16ec5cfc5b2U\n  18:     0x7feab5c95390 - check::FnCtxt<'a, 'tcx>.mc..Typer<'tcx>::type_moves_by_default::he4321b01369a1e798ij\n  19:     0x7feab484e270 - middle::expr_use_visitor::copy_or_move::ha8d1ab8f04cfb662dZn\n  20:     0x7feab5c93170 - middle::mem_categorization::MemCategorizationContext<'t, TYPER>::cat_pattern_::h330257830955943732\n  21:     0x7feab5c92f00 - middle::expr_use_visitor::ExprUseVisitor<'d, 't, 'tcx, TYPER>::determine_pat_move_mode::h14073037536057859665\n  22:     0x7feab5c92e50 - middle::expr_use_visitor::ExprUseVisitor<'d, 't, 'tcx, TYPER>::walk_irrefutable_pat::h17433343186145814648\n  23:     0x7feab5c99200 - middle::expr_use_visitor::ExprUseVisitor<'d, 't, 'tcx, TYPER>::walk_block::h5221501447364338274\n  24:     0x7feab5c90b00 - check::upvar::AdjustBorrowKind<'a, 'tcx>::analyze_fn::h19f586a28eb33d19TUh\n  25:     0x7feab5cfcb40 - check::check_bare_fn::h592fda8aa741d710Qtj\n  26:     0x7feab5cf4170 - check::check_item::h9827005a9cde6421CMj\n  27:     0x7feab5e94fe0 - check_crate::unboxed_closure.40162\n  28:     0x7feab5e8fc30 - check_crate::h19fb6dea5733566ajsx\n  29:     0x7feab6bca640 - driver::phase_3_run_analysis_passes::h46b1604d9f9f5633Tva\n  30:     0x7feab6bb8ae0 - driver::compile_input::h68b8602933aad8d7wba\n  31:     0x7feab6c83eb0 - thunk::F.Invoke<A, R>::invoke::h18029802347644288836\n  32:     0x7feab6c82c60 - rt::unwind::try::try_fn::h6518866316425934196\n  33:     0x7feab6705400 - rust_try_inner\n  34:     0x7feab67053f0 - rust_try\n  35:     0x7feab6c82fb0 - thunk::F.Invoke<A, R>::invoke::h15513809553472565307\n  36:     0x7feab668ae40 - sys::thread::thread_start::h5ea7ba97235331d5a9v\n  37:     0x7feab0cd90c0 - start_thread\n  38:     0x7feab62aaec9 - __clone\n  39:                0x0 - <unknown>\n```\n", "closed_by": {"login": "nrc", "id": 762626, "node_id": "MDQ6VXNlcjc2MjYyNg==", "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nrc", "html_url": "https://github.com/nrc", "followers_url": "https://api.github.com/users/nrc/followers", "following_url": "https://api.github.com/users/nrc/following{/other_user}", "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}", "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nrc/subscriptions", "organizations_url": "https://api.github.com/users/nrc/orgs", "repos_url": "https://api.github.com/users/nrc/repos", "events_url": "https://api.github.com/users/nrc/events{/privacy}", "received_events_url": "https://api.github.com/users/nrc/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/20549/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/20549/timeline", "performed_via_github_app": null, "state_reason": "completed"}