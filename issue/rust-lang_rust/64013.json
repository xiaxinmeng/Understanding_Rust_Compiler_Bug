{"url": "https://api.github.com/repos/rust-lang/rust/issues/64013", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/64013/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/64013/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/64013/events", "html_url": "https://github.com/rust-lang/rust/issues/64013", "id": 487258606, "node_id": "MDU6SXNzdWU0ODcyNTg2MDY=", "number": 64013, "title": "Segfaults on FreeBSD in some cases since 1.37.0", "user": {"login": "andoriyu", "id": 148123, "node_id": "MDQ6VXNlcjE0ODEyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/148123?v=4", "gravatar_id": "", "url": "https://api.github.com/users/andoriyu", "html_url": "https://github.com/andoriyu", "followers_url": "https://api.github.com/users/andoriyu/followers", "following_url": "https://api.github.com/users/andoriyu/following{/other_user}", "gists_url": "https://api.github.com/users/andoriyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/andoriyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/andoriyu/subscriptions", "organizations_url": "https://api.github.com/users/andoriyu/orgs", "repos_url": "https://api.github.com/users/andoriyu/repos", "events_url": "https://api.github.com/users/andoriyu/events{/privacy}", "received_events_url": "https://api.github.com/users/andoriyu/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-08-30T02:46:42Z", "updated_at": "2019-08-31T06:37:01Z", "closed_at": "2019-08-30T09:39:24Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I have a crate that links to library in base for FreeBSD, up until 1.37 it was working fine. Since 1.37 and after it started segfaulting on certain calls. \r\n\r\nI can't reproduce it outside of FreeBSD, but here is is the \"minimal\" [example](https://github.com/Inner-Heaven/libnv-rs/blob/faulty/examples/libvn_sigsegv.rs). \r\n\r\nHere is backtrace: \r\n```\r\nGNU gdb (GDB) 8.3 [GDB v8.3 for FreeBSD]\r\nCopyright (C) 2019 Free Software Foundation, Inc.\r\nLicense GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>\r\nThis is free software: you are free to change and redistribute it.\r\nThere is NO WARRANTY, to the extent permitted by law.\r\nType \"show copying\" and \"show warranty\" for details.\r\nThis GDB was configured as \"x86_64-portbld-freebsd12.0\".\r\nType \"show configuration\" for configuration details.\r\nFor bug reporting instructions, please see:\r\n<http://www.gnu.org/software/gdb/bugs/>.\r\nFind the GDB manual and other documentation resources online at:\r\n    <http://www.gnu.org/software/gdb/documentation/>.\r\n\r\nFor help, type \"help\".\r\nType \"apropos word\" to search for commands related to \"word\"...\r\nReading symbols from target/debug/examples/libvn_sigsegv...\r\nwarning: Unsupported auto-load script at offset 0 in section .debug_gdb_scripts\r\nof file /usr/home/andoriyu/dev/github.com/Inner-Heaven/libnv-rs/target/debug/examples/libvn_sigsegv.\r\nUse `info auto-load python-scripts [REGEXP]' to list them.\r\n(gdb) run\r\nStarting program: /usr/home/andoriyu/dev/github.com/Inner-Heaven/libnv-rs/target/debug/examples/libvn_sigsegv\r\n\r\nProgram received signal SIGSEGV, Segmentation fault.\r\n0x00000008010addc3 in nvlist_exists () from /lib/libnvpair.so.2\r\n(gdb) bt\r\n#0  0x00000008010addc3 in nvlist_exists () from /lib/libnvpair.so.2\r\nwarning: (Internal error: pc 0x1033179 in read in psymtab, but not in symtab.)\r\n\r\nwarning: (Internal error: pc 0x1032f90 in read in psymtab, but not in symtab.)\r\n\r\nwarning: (Internal error: pc 0x1033179 in read in psymtab, but not in symtab.)\r\n\r\nwarning: (Internal error: pc 0x1033179 in read in psymtab, but not in symtab.)\r\n\r\nwarning: (Internal error: pc 0x1033179 in read in psymtab, but not in symtab.)\r\n\r\n#1  0x000000000103317a in libnv::libnv::NvList::contains_key (warning: (Internal error: pc 0x1033179 in read in psymtab, but not in symtab.)\r\n\r\nwarning: (Internal error: pc 0x1033179 in read in psymtab, but not in symtab.)\r\n\r\nself=0x7fffffffe668, warning: (Internal error: pc 0x1033179 in read in psymtab, but not in symtab.)\r\n\r\nname=...) at src/libnv.rs:450\r\n#2  0x0000000001032442 in libvn_sigsegv::main () at examples/libvn_sigsegv.rs:10\r\n```\r\n\r\n\r\nOS: FreeBSD 3558 12.0-RELEASE-p10 FreeBSD 12.0-RELEASE-p10 GENERIC  amd64\r\nRust: rustc 1.37.0 (eae3437df 2019-08-13)\r\n\r\nI comfirmed that it was working between 1.30.0 and 1.36.0 (inclusive).", "closed_by": {"login": "jonas-schievink", "id": 1786438, "node_id": "MDQ6VXNlcjE3ODY0Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/1786438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jonas-schievink", "html_url": "https://github.com/jonas-schievink", "followers_url": "https://api.github.com/users/jonas-schievink/followers", "following_url": "https://api.github.com/users/jonas-schievink/following{/other_user}", "gists_url": "https://api.github.com/users/jonas-schievink/gists{/gist_id}", "starred_url": "https://api.github.com/users/jonas-schievink/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jonas-schievink/subscriptions", "organizations_url": "https://api.github.com/users/jonas-schievink/orgs", "repos_url": "https://api.github.com/users/jonas-schievink/repos", "events_url": "https://api.github.com/users/jonas-schievink/events{/privacy}", "received_events_url": "https://api.github.com/users/jonas-schievink/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/64013/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/64013/timeline", "performed_via_github_app": null, "state_reason": "completed"}