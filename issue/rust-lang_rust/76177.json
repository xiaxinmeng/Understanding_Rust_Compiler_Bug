{"url": "https://api.github.com/repos/rust-lang/rust/issues/76177", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/76177/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/76177/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/76177/events", "html_url": "https://github.com/rust-lang/rust/issues/76177", "id": 689447551, "node_id": "MDU6SXNzdWU2ODk0NDc1NTE=", "number": 76177, "title": "Accessing uninitialized memory.", "user": {"login": "ckaran", "id": 12038467, "node_id": "MDQ6VXNlcjEyMDM4NDY3", "avatar_url": "https://avatars.githubusercontent.com/u/12038467?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ckaran", "html_url": "https://github.com/ckaran", "followers_url": "https://api.github.com/users/ckaran/followers", "following_url": "https://api.github.com/users/ckaran/following{/other_user}", "gists_url": "https://api.github.com/users/ckaran/gists{/gist_id}", "starred_url": "https://api.github.com/users/ckaran/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ckaran/subscriptions", "organizations_url": "https://api.github.com/users/ckaran/orgs", "repos_url": "https://api.github.com/users/ckaran/repos", "events_url": "https://api.github.com/users/ckaran/events{/privacy}", "received_events_url": "https://api.github.com/users/ckaran/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2020-08-31T19:26:10Z", "updated_at": "2020-09-01T18:10:06Z", "closed_at": "2020-09-01T18:10:06Z", "author_association": "NONE", "active_lock_reason": null, "body": "I need some help figuring out how to gather more data for this bug report.  I've copied in what I have below, but I doubt that this is enough to figure out what is going on.\r\n\r\nThe issue is that I'm using [bolero](https://crates.io/crates/bolero) to test my code.  On a fairly regular basis, my tests fail, always with something like that below.  Since the failure ends with `SUMMARY: ThreadSanitizer: data race /rustc/d006f5734f49625c34d6fc33bf6b9967243abca8//library/std/src/sys/unix/condvar.rs:160 in std::sys::unix::condvar::Condvar::destroy`, my guess is that it may have something to do with the standard library, but I don't know how to do a debug build of the standard library, so I can't get better symbols than what is below.  If anyone can guide me on how to generate better debug information, I'll run it on my code.\r\n\r\nAlso, I tried this on both `beta` and `nightly`, and got the same results.\r\n\r\n```bash\r\n$ RUST_BACKTRACE=1 time cargo bolero fuzz --release nodes::behaviors::databases::database::tests::insert_movement_edge_different_source_and_target -t 100sec -s thread\r\n    Finished release [optimized + debuginfo] target(s) in 0.07s\r\n    Finished release [optimized + debuginfo] target(s) in 0.07s\r\n     Running target/fuzz/build_aed2a440592b8cfb/x86_64-unknown-linux-gnu/release/deps/bit_network_library-4f9b998d20e451bb\r\n==================\r\nWARNING: ThreadSanitizer: data race (pid=18314)\r\n  Write of size 8 at 0x7b0c00000030 by main thread:\r\n    #0 pthread_cond_destroy /rustc/llvm/src/llvm-project/compiler-rt/lib/tsan/rtl/tsan_interceptors_posix.cpp:1212 (bit_network_library-4f9b998d20e451bb+0x1352d75)\r\n    #1 std::sys::unix::condvar::Condvar::destroy /rustc/d006f5734f49625c34d6fc33bf6b9967243abca8//library/std/src/sys/unix/condvar.rs:160 (bit_network_library-4f9b998d20e451bb+0x4c4d9aa)\r\n    #2 std::sys_common::condvar::Condvar::destroy /rustc/d006f5734f49625c34d6fc33bf6b9967243abca8//library/std/src/sys_common/condvar.rs:70 (bit_network_library-4f9b998d20e451bb+0x4c4d9aa)\r\n    #3 <std::sync::condvar::Condvar as core::ops::drop::Drop>::drop /rustc/d006f5734f49625c34d6fc33bf6b9967243abca8//library/std/src/sync/condvar.rs:598 (bit_network_library-4f9b998d20e451bb+0x4c4d9aa)\r\n    #4 core::ptr::drop_in_place /rustc/d006f5734f49625c34d6fc33bf6b9967243abca8/library/core/src/ptr/mod.rs:184 (bit_network_library-4f9b998d20e451bb+0x4c4d9aa)\r\n    #5 core::ptr::drop_in_place /rustc/d006f5734f49625c34d6fc33bf6b9967243abca8/library/core/src/ptr/mod.rs:184 (bit_network_library-4f9b998d20e451bb+0x4c4d9aa)\r\n    #6 alloc::sync::Arc<T>::drop_slow /rustc/d006f5734f49625c34d6fc33bf6b9967243abca8/library/alloc/src/sync.rs:934 (bit_network_library-4f9b998d20e451bb+0x4c4d9aa)\r\n\r\n  Previous read of size 8 at 0x7b0c00000030 by thread T1:\r\n    #0 pthread_cond_signal /rustc/llvm/src/llvm-project/compiler-rt/lib/tsan/rtl/tsan_interceptors_posix.cpp:1198 (bit_network_library-4f9b998d20e451bb+0x1352a52)\r\n    #1 std::sync::mpsc::blocking::SignalToken::signal /rustc/d006f5734f49625c34d6fc33bf6b9967243abca8//library/std/src/sync/mpsc/blocking.rs:41 (bit_network_library-4f9b998d20e451bb+0x4c7435e)\r\n\r\n  Location is heap block of size 48 at 0x7b0c00000030 allocated by main thread:\r\n    #0 malloc /rustc/llvm/src/llvm-project/compiler-rt/lib/tsan/rtl/tsan_interceptors_posix.cpp:652 (bit_network_library-4f9b998d20e451bb+0x1350184)\r\n    #1 alloc::alloc::alloc /rustc/d006f5734f49625c34d6fc33bf6b9967243abca8/library/alloc/src/alloc.rs:74 (bit_network_library-4f9b998d20e451bb+0x4c588a2)\r\n    #2 alloc::alloc::Global::alloc_impl /rustc/d006f5734f49625c34d6fc33bf6b9967243abca8/library/alloc/src/alloc.rs:153 (bit_network_library-4f9b998d20e451bb+0x4c588a2)\r\n    #3 <alloc::alloc::Global as core::alloc::AllocRef>::alloc /rustc/d006f5734f49625c34d6fc33bf6b9967243abca8/library/alloc/src/alloc.rs:212 (bit_network_library-4f9b998d20e451bb+0x4c588a2)\r\n    #4 alloc::alloc::exchange_malloc /rustc/d006f5734f49625c34d6fc33bf6b9967243abca8/library/alloc/src/alloc.rs:302 (bit_network_library-4f9b998d20e451bb+0x4c588a2)\r\n    #5 std::sync::condvar::Condvar::new /rustc/d006f5734f49625c34d6fc33bf6b9967243abca8//library/std/src/sync/condvar.rs:130 (bit_network_library-4f9b998d20e451bb+0x4c588a2)\r\n    #6 std::thread::Thread::new /rustc/d006f5734f49625c34d6fc33bf6b9967243abca8//library/std/src/thread/mod.rs:1108 (bit_network_library-4f9b998d20e451bb+0x4c588a2)\r\n    #7 main ??:? (bit_network_library-4f9b998d20e451bb+0x261b579)\r\n\r\n  Thread T1 'nodes::behavior' (tid=18316, finished) created by main thread at:\r\n    #0 pthread_create /rustc/llvm/src/llvm-project/compiler-rt/lib/tsan/rtl/tsan_interceptors_posix.cpp:966 (bit_network_library-4f9b998d20e451bb+0x1351a5b)\r\n    #1 std::sys::unix::thread::Thread::new /rustc/d006f5734f49625c34d6fc33bf6b9967243abca8//library/std/src/sys/unix/thread.rs:66 (bit_network_library-4f9b998d20e451bb+0x4c8a84c)\r\n    #2 core::ops::function::FnOnce::call_once /rustc/d006f5734f49625c34d6fc33bf6b9967243abca8/library/core/src/ops/function.rs:227 (bit_network_library-4f9b998d20e451bb+0x2032cea)\r\n    #3 std::sys_common::backtrace::__rust_begin_short_backtrace /rustc/d006f5734f49625c34d6fc33bf6b9967243abca8/library/std/src/sys_common/backtrace.rs:137 (bit_network_library-4f9b998d20e451bb+0x2648fc7)\r\n    #4 std::rt::lang_start::{{closure}} /rustc/d006f5734f49625c34d6fc33bf6b9967243abca8/library/std/src/rt.rs:66 (bit_network_library-4f9b998d20e451bb+0x1fe2aaf)\r\n    #5 core::ops::function::impls::<impl core::ops::function::FnOnce<A> for &F>::call_once /rustc/d006f5734f49625c34d6fc33bf6b9967243abca8/library/core/src/ops/function.rs:259 (bit_network_library-4f9b998d20e451bb+0x4c7ba20)\r\n    #6 std::panicking::try::do_call /rustc/d006f5734f49625c34d6fc33bf6b9967243abca8//library/std/src/panicking.rs:381 (bit_network_library-4f9b998d20e451bb+0x4c7ba20)\r\n    #7 std::panicking::try /rustc/d006f5734f49625c34d6fc33bf6b9967243abca8//library/std/src/panicking.rs:345 (bit_network_library-4f9b998d20e451bb+0x4c7ba20)\r\n    #8 std::panic::catch_unwind /rustc/d006f5734f49625c34d6fc33bf6b9967243abca8//library/std/src/panic.rs:382 (bit_network_library-4f9b998d20e451bb+0x4c7ba20)\r\n    #9 std::rt::lang_start_internal /rustc/d006f5734f49625c34d6fc33bf6b9967243abca8//library/std/src/rt.rs:51 (bit_network_library-4f9b998d20e451bb+0x4c7ba20)\r\n    #10 main ??:? (bit_network_library-4f9b998d20e451bb+0x261b579)\r\n\r\nSUMMARY: ThreadSanitizer: data race /rustc/d006f5734f49625c34d6fc33bf6b9967243abca8//library/std/src/sys/unix/condvar.rs:160 in std::sys::unix::condvar::Condvar::destroy\r\n==================\r\nThreadSanitizer: reported 1 warnings\r\nerror: test failed, to rerun pass '--lib'\r\nerror: process exited with status 66\r\nCommand exited with non-zero status 1\r\n0.14user 0.08system 0:02.64elapsed 8%CPU (0avgtext+0avgdata 71044maxresident)k\r\n0inputs+1024outputs (0major+20503minor)pagefaults 0swaps\r\n```\r\n\r\n### Meta\r\n\r\n```\r\nlsb_release -a:\r\nDistributor ID:\tUbuntu\r\nDescription:\tUbuntu 18.04.5 LTS\r\nRelease:\t18.04\r\nCodename:\tbionic\r\n\r\nuname -a:\r\nLinux Hammer 5.4.0-42-generic #46~18.04.1-Ubuntu SMP Fri Jul 10 07:21:24 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux\r\n\r\nrustc -vV:\r\nrustc 1.46.0 (04488afe3 2020-08-24)\r\nbinary: rustc\r\ncommit-hash: 04488afe34512aa4c33566eb16d8c912a3ae04f9\r\ncommit-date: 2020-08-24\r\nhost: x86_64-unknown-linux-gnu\r\nrelease: 1.46.0\r\nLLVM version: 10.0\r\n\r\ncargo -vV:\r\ncargo 1.46.0 (149022b1d 2020-07-17)\r\nrelease: 1.46.0\r\ncommit-hash: 149022b1d8f382e69c1616f6a46b69ebf59e2dea\r\ncommit-date: 2020-07-17\r\n\r\nrustc +beta -vV:\r\nrustc 1.47.0-beta.2 (84b047bf6 2020-08-28)\r\nbinary: rustc\r\ncommit-hash: 84b047bf64dfcfa12867781e9c23dfa4f2e6082c\r\ncommit-date: 2020-08-28\r\nhost: x86_64-unknown-linux-gnu\r\nrelease: 1.47.0-beta.2\r\nLLVM version: 11.0\r\n\r\ncargo +beta -vV:\r\ncargo 1.47.0-beta (51b66125b 2020-08-19)\r\nrelease: 1.47.0\r\ncommit-hash: 51b66125ba97d2906f461b3f4e0408f206299bb6\r\ncommit-date: 2020-08-19\r\n\r\nrustc +nightly -vV:\r\nrustc 1.48.0-nightly (d006f5734 2020-08-28)\r\nbinary: rustc\r\ncommit-hash: d006f5734f49625c34d6fc33bf6b9967243abca8\r\ncommit-date: 2020-08-28\r\nhost: x86_64-unknown-linux-gnu\r\nrelease: 1.48.0-nightly\r\nLLVM version: 11.0\r\n\r\ncargo +nightly -vV:\r\ncargo 1.47.0-nightly (51b66125b 2020-08-19)\r\nrelease: 1.47.0\r\ncommit-hash: 51b66125ba97d2906f461b3f4e0408f206299bb6\r\ncommit-date: 2020-08-19\r\n```\r\n\r\n\r\n", "closed_by": {"login": "ckaran", "id": 12038467, "node_id": "MDQ6VXNlcjEyMDM4NDY3", "avatar_url": "https://avatars.githubusercontent.com/u/12038467?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ckaran", "html_url": "https://github.com/ckaran", "followers_url": "https://api.github.com/users/ckaran/followers", "following_url": "https://api.github.com/users/ckaran/following{/other_user}", "gists_url": "https://api.github.com/users/ckaran/gists{/gist_id}", "starred_url": "https://api.github.com/users/ckaran/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ckaran/subscriptions", "organizations_url": "https://api.github.com/users/ckaran/orgs", "repos_url": "https://api.github.com/users/ckaran/repos", "events_url": "https://api.github.com/users/ckaran/events{/privacy}", "received_events_url": "https://api.github.com/users/ckaran/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/76177/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/76177/timeline", "performed_via_github_app": null, "state_reason": "completed"}