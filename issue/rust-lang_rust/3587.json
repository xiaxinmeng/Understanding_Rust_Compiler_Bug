{"url": "https://api.github.com/repos/rust-lang/rust/issues/3587", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/3587/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/3587/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/3587/events", "html_url": "https://github.com/rust-lang/rust/issues/3587", "id": 7128810, "node_id": "MDU6SXNzdWU3MTI4ODEw", "number": 3587, "title": "task thrashing", "user": {"login": "jesse99", "id": 425055, "node_id": "MDQ6VXNlcjQyNTA1NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/425055?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jesse99", "html_url": "https://github.com/jesse99", "followers_url": "https://api.github.com/users/jesse99/followers", "following_url": "https://api.github.com/users/jesse99/following{/other_user}", "gists_url": "https://api.github.com/users/jesse99/gists{/gist_id}", "starred_url": "https://api.github.com/users/jesse99/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jesse99/subscriptions", "organizations_url": "https://api.github.com/users/jesse99/orgs", "repos_url": "https://api.github.com/users/jesse99/repos", "events_url": "https://api.github.com/users/jesse99/events{/privacy}", "received_events_url": "https://api.github.com/users/jesse99/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2012-09-25T17:45:42Z", "updated_at": "2012-10-03T02:22:42Z", "closed_at": "2012-10-03T02:22:42Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I don't have a good repro for this, but I have observed CPU usage going through the roof on my web server. It starts out fine: 27 threads (as reported by top) and 0% CPU. Then I click on a thingy which opens up two server-sent events causing 2 tasks to spawn. Threads goes to 29 and CPU to 200%. Then I start up two more SSEs and threads goes to 35 and CPU to 400%. This can go on even further but my Mac starts sounding like a turbine engine at that point.\n\nIt's a fairly complex exe with lots of tasks, and tasks that block, but there's nothing special about the SSEs: several are spawned when a client first connects to the server. Haven't been able to glean as much about the state of the world using Apple's Instruments as I'd like, but memory is fine and there don't seem to be any functions or threads sucking up CPU.\n\nThis leads me to think that the problem might be lock contention. Or possibly #3095, but I very much doubt that my tasks are doing much of anything at all (and Instruments backs that up).\n\nThis was on an 8-core Mac with rust from Sep 22, 2012.\n", "closed_by": {"login": "jesse99", "id": 425055, "node_id": "MDQ6VXNlcjQyNTA1NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/425055?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jesse99", "html_url": "https://github.com/jesse99", "followers_url": "https://api.github.com/users/jesse99/followers", "following_url": "https://api.github.com/users/jesse99/following{/other_user}", "gists_url": "https://api.github.com/users/jesse99/gists{/gist_id}", "starred_url": "https://api.github.com/users/jesse99/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jesse99/subscriptions", "organizations_url": "https://api.github.com/users/jesse99/orgs", "repos_url": "https://api.github.com/users/jesse99/repos", "events_url": "https://api.github.com/users/jesse99/events{/privacy}", "received_events_url": "https://api.github.com/users/jesse99/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/3587/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/3587/timeline", "performed_via_github_app": null, "state_reason": "completed"}