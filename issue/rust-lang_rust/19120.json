{"url": "https://api.github.com/repos/rust-lang/rust/issues/19120", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/19120/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/19120/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/19120/events", "html_url": "https://github.com/rust-lang/rust/issues/19120", "id": 49464795, "node_id": "MDU6SXNzdWU0OTQ2NDc5NQ==", "number": 19120, "title": "Spurious test failures", "user": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 37977651, "node_id": "MDU6TGFiZWwzNzk3NzY1MQ==", "url": "https://api.github.com/repos/rust-lang/rust/labels/metabug", "name": "metabug", "color": "5319e7", "default": false, "description": "Issues about issues themselves (\"bugs about bugs\")"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 14, "created_at": "2014-11-19T22:49:48Z", "updated_at": "2015-09-08T18:12:37Z", "closed_at": "2015-09-08T18:12:37Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Our builders are susceptible to _a lot_ of spurious test failures, and I've been keeping some of this knowledge in my head for far too long, so I'd like to write it down. I'm writing this to be a metabug, but I expect other bugs to be spawned off from it as well. Sometimes it's just a lot easier to add a bullet than a whole new bug!\n\nIf you add to this, please don't link directly to buildbot logs as they disappear over time. Instead please link to a gist with the relevant information pasted in. I also typically peruse http://buildbot.rust-lang.org/grid?branch=auto&width=10 for build failures\n## Spurious test failures\n- [x] stdtest deadlocks on windows once a TCP test fails [(logs)](https://gist.github.com/alexcrichton/c012d72c5057db4cbaa7#file-gistfile1-txt-L5634-L5636) [(test)](https://github.com/rust-lang/rust/blob/f0f7ca27de6b4e03f30012656dad270cda55a363/src/libstd/net/tcp.rs#L377)\n- [ ] stdtest spuriously segfaults on freebsd [(logs)](https://gist.github.com/alexcrichton/f3edae4628f2254446f2). The segfaults decreased in frequency when freebsd was upgraded, it may just need to be upgraded again.\n- [ ] stdtest deadlocks [(logs)](https://gist.github.com/alexcrichton/d6adb945645f5de5a83e)\n  - [ ] `thread_local::dtors_in_dtors_in_dtors` deadlocks on OSX [(logs)](https://gist.github.com/alexcrichton/2443712cf90cda1fdf11)\n- [ ] `io::process::tests::test_kill` spuriously fails [(logs)](https://gist.github.com/alexcrichton/572c88320680659585ba)\n- [x] run-pass-fulldeps/issue-13560.rs [(logs)](https://gist.github.com/aturon/8d2bf1ee254ea6348e91)\n- [x] wait-forked-but-child-failed [(logs)](https://gist.github.com/alexcrichton/8a61005a025c25533ac9)\n- [x] src/test/run-pass/issue-12684 [(logs)](https://gist.github.com/alexcrichton/e0d234326cade54e7200)\n## Spurious failure behvaior\n- [x] windows git failures lead to corruption of all future builds. I think @brson fixed this as I haven't seen it recently.\n- [x] windows thinks failed processes exit with a 0 exit status https://github.com/rust-lang/rust/issues/18981\n- [x] windows will sometimes leave a test process running after the build finishes, preventing any future builds from overwriting the executable. This is not specific to any particular test. [(logs)](https://gist.github.com/alexcrichton/b240e4abcacc924b744a)\n- [x] windows `make clean` randomly fails due to some arbitrary object file not being able to be overwritten. [(logs)](https://gist.github.com/alexcrichton/331bfc0714b106ae6721)\n- [x] windows bots fail to upload stability metrics randomly sometimes https://github.com/rust-lang/rust/issues/19079\n", "closed_by": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/19120/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/19120/timeline", "performed_via_github_app": null, "state_reason": "completed"}