{"url": "https://api.github.com/repos/rust-lang/rust/issues/109733", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/109733/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/109733/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/109733/events", "html_url": "https://github.com/rust-lang/rust/issues/109733", "id": 1646361428, "node_id": "I_kwDOAAsO6M5iIXtU", "number": 109733, "title": "`rustdoc` causes a `rustc` panic", "user": {"login": "CGMossa", "id": 1063624, "node_id": "MDQ6VXNlcjEwNjM2MjQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1063624?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CGMossa", "html_url": "https://github.com/CGMossa", "followers_url": "https://api.github.com/users/CGMossa/followers", "following_url": "https://api.github.com/users/CGMossa/following{/other_user}", "gists_url": "https://api.github.com/users/CGMossa/gists{/gist_id}", "starred_url": "https://api.github.com/users/CGMossa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CGMossa/subscriptions", "organizations_url": "https://api.github.com/users/CGMossa/orgs", "repos_url": "https://api.github.com/users/CGMossa/repos", "events_url": "https://api.github.com/users/CGMossa/events{/privacy}", "received_events_url": "https://api.github.com/users/CGMossa/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 203738, "node_id": "MDU6TGFiZWwyMDM3Mzg=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-rustdoc", "name": "T-rustdoc", "color": "bfd4f2", "default": false, "description": "Relevant to the rustdoc team, which will review and decide on the PR/issue."}, {"id": 239393, "node_id": "MDU6TGFiZWwyMzkzOTM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-resolve", "name": "A-resolve", "color": "f7e101", "default": false, "description": "Area: Path resolution"}, {"id": 9618520, "node_id": "MDU6TGFiZWw5NjE4NTIw", "url": "https://api.github.com/repos/rust-lang/rust/labels/I-ICE", "name": "I-ICE", "color": "e10c02", "default": false, "description": "Issue: The compiler panicked, giving an Internal Compilation Error (ICE) \u2744\ufe0f"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 650731663, "node_id": "MDU6TGFiZWw2NTA3MzE2NjM=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-bug", "name": "C-bug", "color": "f5f1fd", "default": false, "description": "Category: This is a bug."}], "state": "closed", "locked": false, "assignee": {"login": "bvanjoi", "id": 30187863, "node_id": "MDQ6VXNlcjMwMTg3ODYz", "avatar_url": "https://avatars.githubusercontent.com/u/30187863?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bvanjoi", "html_url": "https://github.com/bvanjoi", "followers_url": "https://api.github.com/users/bvanjoi/followers", "following_url": "https://api.github.com/users/bvanjoi/following{/other_user}", "gists_url": "https://api.github.com/users/bvanjoi/gists{/gist_id}", "starred_url": "https://api.github.com/users/bvanjoi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bvanjoi/subscriptions", "organizations_url": "https://api.github.com/users/bvanjoi/orgs", "repos_url": "https://api.github.com/users/bvanjoi/repos", "events_url": "https://api.github.com/users/bvanjoi/events{/privacy}", "received_events_url": "https://api.github.com/users/bvanjoi/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "bvanjoi", "id": 30187863, "node_id": "MDQ6VXNlcjMwMTg3ODYz", "avatar_url": "https://avatars.githubusercontent.com/u/30187863?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bvanjoi", "html_url": "https://github.com/bvanjoi", "followers_url": "https://api.github.com/users/bvanjoi/followers", "following_url": "https://api.github.com/users/bvanjoi/following{/other_user}", "gists_url": "https://api.github.com/users/bvanjoi/gists{/gist_id}", "starred_url": "https://api.github.com/users/bvanjoi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bvanjoi/subscriptions", "organizations_url": "https://api.github.com/users/bvanjoi/orgs", "repos_url": "https://api.github.com/users/bvanjoi/repos", "events_url": "https://api.github.com/users/bvanjoi/events{/privacy}", "received_events_url": "https://api.github.com/users/bvanjoi/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2023-03-29T19:05:07Z", "updated_at": "2023-05-27T05:13:34Z", "closed_at": "2023-05-27T05:13:34Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!--\nThank you for finding an Internal Compiler Error! \ud83e\uddca  If possible, try to provide\na minimal verifiable example. You can read \"Rust Bug Minimization Patterns\" for\nhow to create smaller examples.\nhttp://blog.pnkfx.org/blog/2019/11/18/rust-bug-minimization-patterns/\n-->\n\n### Code\n\nThis happened when I ran\n```\nrustdoc src/lib.rs\n```\nin `bevy/crates/bevy_ecs`, that can be found here: https://github.com/bevyengine/bevy/blob/aefe1f0739bb395d2454e05a1a812acab767892c/crates/bevy_ecs/src/lib.rs\n\nIn order to attempt to narrow it down, I ran `rustdoc` on every source file in `bevy_ecs`.\nOnly other file that caused the ICE is: `src/system/mod.rs`, which can be found here: https://github.com/bevyengine/bevy/blob/daa1b0209ae4c46cdda61b2263e2cfab88625937/crates/bevy_ecs/src/system/mod.rs\n\n### Meta\n<!--\nIf you're using the stable version of the compiler, you should also check if the\nbug also exists in the beta or nightly versions.\n-->\n\n`rustc --version --verbose`:\n\n```\nrustc 1.68.0 (2c8cc3432 2023-03-06)\nbinary: rustc\ncommit-hash: 2c8cc343237b8f7d5a3c3703e3a87f2eb2c54a74\ncommit-date: 2023-03-06\nhost: x86_64-pc-windows-msvc\nrelease: 1.68.0\nLLVM version: 15.0.6\n```\n\nNote that this happens on `nightly` as well, but the location of the panic is different.\n\n### Error output\n\n```\nthread 'rustc' panicked at 'internal error: entered unreachable code', compiler\\rustc_resolve\\src\\lib.rs:1958:67\nerror: internal compiler error: unexpected panic\n\nnote: the compiler unexpectedly panicked. this is a bug.\n\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/issues/new?labels=C-bug%2C+I-ICE%2C+T-compiler&template=ice.md\n\nnote: rustc 1.68.0 (2c8cc3432 2023-03-06) running on x86_64-pc-windows-msvc\n\nquery stack during panic:\nend of query stack\nerror: aborting due to 55 previous errors\n\nSome errors have detailed explanations: E0412, E0432, E0433, E0603.\nFor more information about an error, try `rustc --explain E0412`.\n```\n\n\n<!--\nInclude a backtrace in the code block by setting `RUST_BACKTRACE=1` in your\nenvironment. E.g. `RUST_BACKTRACE=1 cargo build`.\n-->\nHere's a backtrace with `RUST_BACKTRACE=full`.\n<details><summary><strong>Backtrace</strong></summary>\n<p>\n\n```\nstack backtrace:\n   0:     0x7ffc60899d02 - <std::sys_common::backtrace::_print::DisplayBacktrace as core::fmt::Display>::fmt::h792a027c2747e99d\n   1:     0x7ffc608d570b - core::fmt::write::h5d1fd4698cef7a98\n   2:     0x7ffc6088cdfa - <std::io::IoSlice as core::fmt::Debug>::fmt::hba64fac32bc54252\n   3:     0x7ffc60899a4b - std::sys::common::alloc::realloc_fallback::hfe62d187ace61bcd\n   4:     0x7ffc6089d3f9 - std::panicking::default_hook::hc7b7ee9dc8a166a2\n   5:     0x7ffc6089d07b - std::panicking::default_hook::hc7b7ee9dc8a166a2\n   6:     0x7ffc4f37ec34 - rustc_driver[6fce53b951639747]::describe_lints\n   7:     0x7ffc6089dd5f - std::panicking::rust_panic_with_hook::h80ad08272951bba3\n   8:     0x7ffc6089da7b - <std::panicking::begin_panic_handler::StrPanicPayload as core::panic::BoxMeUp>::get::h87fe0efc42413a8e\n   9:     0x7ffc6089a9ff - <std::sys_common::backtrace::_print::DisplayBacktrace as core::fmt::Display>::fmt::h792a027c2747e99d\n  10:     0x7ffc6089d770 - rust_begin_unwind\n  11:     0x7ffc6090b3d5 - core::panicking::panic_fmt::hce24276b766fe029\n  12:     0x7ffc6090b48c - core::panicking::panic::h2f164b064a86475f\n  13:     0x7ffc4fdf4066 - <rustc_resolve[a6df4b0daa4644d]::Resolver>::resolve_rustdoc_path\n  14:     0x7ff7070c044a - <unknown>\n  15:     0x7ff70717730e - <unknown>\n  16:     0x7ff707176aac - <unknown>\n  17:     0x7ff7070c17a4 - <unknown>\n  18:     0x7ff707173bac - <unknown>\n  19:     0x7ff7070be423 - <unknown>\n  20:     0x7ff707171d87 - <unknown>\n  21:     0x7ff706f50aa8 - <unknown>\n  22:     0x7ff706e03182 - <unknown>\n  23:     0x7ff706f65c06 - <unknown>\n  24:     0x7ff706ebb4fb - <unknown>\n  25:     0x7ffc608b021c - std::sys::windows::thread::Thread::new::he1a8155b1a8cc29c\n  26:     0x7ffcf77b26bd - BaseThreadInitThunk\n  27:     0x7ffcf8aaa9f8 - RtlUserThreadStart\n```\n\n</p>\n</details>\n\n## Recreate steps\n\n```\ngh repo clone bevyengine/bevy\ncd bevy/crates/bevy_ecs\nrustdoc src/lib.rs\n```\n\n\n<!-- TRIAGEBOT_START -->\n\n<!-- TRIAGEBOT_ASSIGN_START -->\n\n<!-- TRIAGEBOT_ASSIGN_DATA_START$${\"user\":\"bvanjoi\"}$$TRIAGEBOT_ASSIGN_DATA_END -->\n\n<!-- TRIAGEBOT_ASSIGN_END -->\n<!-- TRIAGEBOT_END -->", "closed_by": {"login": "CGMossa", "id": 1063624, "node_id": "MDQ6VXNlcjEwNjM2MjQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1063624?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CGMossa", "html_url": "https://github.com/CGMossa", "followers_url": "https://api.github.com/users/CGMossa/followers", "following_url": "https://api.github.com/users/CGMossa/following{/other_user}", "gists_url": "https://api.github.com/users/CGMossa/gists{/gist_id}", "starred_url": "https://api.github.com/users/CGMossa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CGMossa/subscriptions", "organizations_url": "https://api.github.com/users/CGMossa/orgs", "repos_url": "https://api.github.com/users/CGMossa/repos", "events_url": "https://api.github.com/users/CGMossa/events{/privacy}", "received_events_url": "https://api.github.com/users/CGMossa/received_events", "type": "User", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/109733/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/109733/timeline", "performed_via_github_app": null, "state_reason": "completed"}