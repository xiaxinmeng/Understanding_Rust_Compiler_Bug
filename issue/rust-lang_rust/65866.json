{"url": "https://api.github.com/repos/rust-lang/rust/issues/65866", "repository_url": "https://api.github.com/repos/rust-lang/rust", "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/65866/labels{/name}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/65866/comments", "events_url": "https://api.github.com/repos/rust-lang/rust/issues/65866/events", "html_url": "https://github.com/rust-lang/rust/issues/65866", "id": 512965404, "node_id": "MDU6SXNzdWU1MTI5NjU0MDQ=", "number": 65866, "title": "Confusing \"cannot infer an appropriate lifetime\" error message", "user": {"login": "DustinByfuglien", "id": 18250092, "node_id": "MDQ6VXNlcjE4MjUwMDky", "avatar_url": "https://avatars.githubusercontent.com/u/18250092?v=4", "gravatar_id": "", "url": "https://api.github.com/users/DustinByfuglien", "html_url": "https://github.com/DustinByfuglien", "followers_url": "https://api.github.com/users/DustinByfuglien/followers", "following_url": "https://api.github.com/users/DustinByfuglien/following{/other_user}", "gists_url": "https://api.github.com/users/DustinByfuglien/gists{/gist_id}", "starred_url": "https://api.github.com/users/DustinByfuglien/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/DustinByfuglien/subscriptions", "organizations_url": "https://api.github.com/users/DustinByfuglien/orgs", "repos_url": "https://api.github.com/users/DustinByfuglien/repos", "events_url": "https://api.github.com/users/DustinByfuglien/events{/privacy}", "received_events_url": "https://api.github.com/users/DustinByfuglien/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 234902, "node_id": "MDU6TGFiZWwyMzQ5MDI=", "url": "https://api.github.com/repos/rust-lang/rust/labels/C-enhancement", "name": "C-enhancement", "color": "f5f1fd", "default": false, "description": "Category: An issue proposing an enhancement or a PR with one."}, {"id": 235791, "node_id": "MDU6TGFiZWwyMzU3OTE=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-diagnostics", "name": "A-diagnostics", "color": "f7e101", "default": false, "description": "Area: Messages for errors, warnings, and lints"}, {"id": 1775993, "node_id": "MDU6TGFiZWwxNzc1OTkz", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-lifetimes", "name": "A-lifetimes", "color": "f7e101", "default": false, "description": "Area: lifetime related"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 604454086, "node_id": "MDU6TGFiZWw2MDQ0NTQwODY=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-inference", "name": "A-inference", "color": "f7e101", "default": false, "description": "Area: Type inference"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-10-27T13:19:24Z", "updated_at": "2021-08-28T21:13:48Z", "closed_at": null, "author_association": "NONE", "active_lock_reason": null, "body": "Consider example:\r\n\r\n```rust\r\ntrait Bar {\r\n    fn bar(&self, r: &mut Re);\r\n}\r\n\r\nstruct Re<'a> {\r\n    data: &'a u16,\r\n}\r\n\r\nstruct Foo;\r\n\r\nimpl Bar for Foo {\r\n    fn bar<'a, 'b>(&'a self, r: &'b mut Re<'a>){}\r\n}\r\n```\r\n\r\n([Playground](https://play.rust-lang.org/?version=nightly&mode=debug&edition=2018&gist=5bd6ac9f31500a89c9f1fcf98b5ffa30))\r\n\r\nErrors:\r\n\r\n```\r\n   Compiling playground v0.0.1 (/playground)\r\nerror[E0495]: cannot infer an appropriate lifetime for lifetime parameter 'a in generic type due to conflicting requirements\r\n  --> src/lib.rs:12:5\r\n   |\r\n12 |     fn bar<'a, 'b>(&'a self, r: &'b mut Re<'a>){}\r\n   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n   |\r\nnote: first, the lifetime cannot outlive the anonymous lifetime #1 defined on the method body at 12:5...\r\n  --> src/lib.rs:12:5\r\n   |\r\n12 |     fn bar<'a, 'b>(&'a self, r: &'b mut Re<'a>){}\r\n   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\nnote: ...but the lifetime must also be valid for the anonymous lifetime #3 defined on the method body at 12:5...\r\n  --> src/lib.rs:12:5\r\n   |\r\n12 |     fn bar<'a, 'b>(&'a self, r: &'b mut Re<'a>){}\r\n   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n   = note: ...so that the method type is compatible with trait:\r\n           expected fn(&Foo, &mut Re<'_>)\r\n              found fn(&Foo, &mut Re<'_>)\r\n\r\nerror: aborting due to previous error\r\n\r\nFor more information about this error, try `rustc --explain E0495`.\r\nerror: could not compile `playground`.\r\n\r\nTo learn more, run the command again with --verbose.\r\n\r\n```\r\n\r\nAll 3 notes of this error message is confusing:\r\n\r\nnote1, note2: Message not point where are the anonymous lifetime #1 and the anonymous lifetime #3. Also it's not obviously why there are two different anonymous lifetimes at one place (at 12:5).\r\n\r\n=note3: Expected result looks totally equal to founded. So it's not obviously why it considered as different.\r\n\r\nIt is difficult to figure out what was going on.\r\nMay be some change of this message needed.", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/rust-lang/rust/issues/65866/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/65866/timeline", "performed_via_github_app": null, "state_reason": null}